This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W1/deepLOB_L1/h300
Epoch 1/50
10622/10622 - 176s - loss: 3.2392 - accuracy300: 0.4027 - val_loss: 3.3151 - val_accuracy300: 0.3528 - 176s/epoch - 17ms/step
Epoch 2/50
10622/10622 - 156s - loss: 3.2175 - accuracy300: 0.4145 - val_loss: 3.3839 - val_accuracy300: 0.3296 - 156s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 156s - loss: 3.2064 - accuracy300: 0.4204 - val_loss: 3.3636 - val_accuracy300: 0.3356 - 156s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 153s - loss: 3.1983 - accuracy300: 0.4237 - val_loss: 3.6010 - val_accuracy300: 0.3426 - 153s/epoch - 14ms/step
Epoch 5/50
10622/10622 - 155s - loss: 3.1939 - accuracy300: 0.4257 - val_loss: 3.3720 - val_accuracy300: 0.3334 - 155s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 156s - loss: 3.1885 - accuracy300: 0.4277 - val_loss: 3.5458 - val_accuracy300: 0.3489 - 156s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 158s - loss: 3.1841 - accuracy300: 0.4297 - val_loss: 3.4143 - val_accuracy300: 0.3420 - 158s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 157s - loss: 3.1803 - accuracy300: 0.4310 - val_loss: 3.5336 - val_accuracy300: 0.3472 - 157s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 157s - loss: 3.1776 - accuracy300: 0.4323 - val_loss: 3.4887 - val_accuracy300: 0.3341 - 157s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 156s - loss: 3.1752 - accuracy300: 0.4332 - val_loss: 3.6505 - val_accuracy300: 0.3423 - 156s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 158s - loss: 3.1719 - accuracy300: 0.4344 - val_loss: 3.6561 - val_accuracy300: 0.3503 - 158s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 198s - 198s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1080666
{'0': {'precision': 0.3453254428094952, 'recall': 0.48322540895841337, 'f1-score': 0.40279972670188424, 'support': 3114681}, '1': {'precision': 0.30692491242909753, 'recall': 0.4711322274427761, 'f1-score': 0.37170076653807727, 'support': 2809621}, '2': {'precision': 0.33035340986863304, 'recall': 0.03972868992873931, 'f1-score': 0.07092754929113618, 'support': 3122479}, 'accuracy': 0.32639764353751904, 'macro avg': {'precision': 0.3275345883690753, 'recall': 0.3313621087766429, 'f1-score': 0.2818093475103659, 'support': 9046781}, 'weighted avg': {'precision': 0.3282319821616632, 'recall': 0.32639764353751904, 'f1-score': 0.27859641104698657, 'support': 9046781}}
[[1505093 1489699  119889]
 [1354346 1323703  131572]
 [1499038 1499389  124052]]
Evaluating performance on  train set...
10622/10622 - 59s - 59s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074862
{'0': {'precision': 0.34036790725397226, 'recall': 0.5561342554512214, 'f1-score': 0.42228621537062494, 'support': 911814}, '1': {'precision': 0.34356305984818986, 'recall': 0.40812975714215316, 'f1-score': 0.37307342842590485, 'support': 892868}, '2': {'precision': 0.3500342231348392, 'recall': 0.0643564681473181, 'f1-score': 0.10872332224427297, 'support': 913832}, 'accuracy': 0.34221195844494456, 'macro avg': {'precision': 0.34465506341233376, 'recall': 0.3428734935802309, 'f1-score': 0.30136098868026756, 'support': 2718514}, 'weighted avg': {'precision': 0.34466666690006503, 'recall': 0.34221195844494456, 'f1-score': 0.3007182085826522, 'support': 2718514}}
[[507091 345610  59113]
 [478371 364406  50091]
 [504370 350651  58811]]
Evaluating performance on  val set...
3064/3064 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1049734
{'0': {'precision': 0.33636408927859707, 'recall': 0.5214681279977755, 'f1-score': 0.40894512569997366, 'support': 258942}, '1': {'precision': 0.3714243452975789, 'recall': 0.3861436270961402, 'f1-score': 0.3786409909379781, 'support': 266621}, '2': {'precision': 0.3638862207682286, 'recall': 0.14818271595375945, 'f1-score': 0.2106030833925023, 'support': 258215}, 'accuracy': 0.3524556698452878, 'macro avg': {'precision': 0.3572248851148015, 'recall': 0.35193149034922505, 'f1-score': 0.3327297333434847, 'support': 783778}, 'weighted avg': {'precision': 0.3573578243702074, 'recall': 0.3524556698452878, 'f1-score': 0.3332928247055572, 'support': 783778}}
[[135030  86734  37178]
 [133957 102954  29710]
 [132453  87499  38263]]
testing model out of sample: results/universal/W1/deepLOB_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 122s - 122s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071092
{'0': {'precision': 0.3454952166622592, 'recall': 0.5780486999725564, 'f1-score': 0.43249282950412293, 'support': 2029611}, '1': {'precision': 0.37357504500095096, 'recall': 0.40323285234909123, 'f1-score': 0.3878377948423296, 'support': 2055646}, '2': {'precision': 0.3616820192815637, 'recall': 0.08703044133908723, 'f1-score': 0.14030074279171054, 'support': 2013939}, 'accuracy': 0.3569965615140094, 'macro avg': {'precision': 0.3602507603149246, 'recall': 0.3561039978869116, 'f1-score': 0.32021045571272105, 'support': 6099196}, 'weighted avg': {'precision': 0.36030395864815995, 'recall': 0.3569965615140094, 'f1-score': 0.3209614108869993, 'support': 6099196}}
[[1173214  690636  165761]
 [1083169  828904  143573]
 [1139363  699302  175274]]
Evaluating performance on  train set...
6711/6711 - 47s - 47s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1123164
{'0': {'precision': 0.3398266872966997, 'recall': 0.5722326744422012, 'f1-score': 0.426419468460635, 'support': 581482}, '1': {'precision': 0.3303716926655442, 'recall': 0.26215097687129335, 'f1-score': 0.2923340031212449, 'support': 559132}, '2': {'precision': 0.3412565800645271, 'recall': 0.1742487826533302, 'f1-score': 0.23070000022959106, 'support': 576664}, 'accuracy': 0.337629085098627, 'macro avg': {'precision': 0.337151653342257, 'recall': 0.33621081132227487, 'f1-score': 0.31648449060382366, 'support': 1717278}, 'weighted avg': {'precision': 0.33722837626316826, 'recall': 0.337629085098627, 'f1-score': 0.31703948115856123, 'support': 1717278}}
[[332743 148356 100383]
 [318971 146577  93584]
 [327441 148740 100483]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1128227
{'0': {'precision': 0.3556462365467449, 'recall': 0.597595619947832, 'f1-score': 0.4459154447808795, 'support': 154884}, '1': {'precision': 0.31707495370219957, 'recall': 0.28699033979797384, 'f1-score': 0.3012834860190323, 'support': 136022}, '2': {'precision': 0.36162453084059204, 'recall': 0.13713602825166, 'f1-score': 0.19885995784472646, 'support': 148947}, 'accuracy': 0.3456177404723851, 'macro avg': {'precision': 0.3447819070298455, 'recall': 0.3405739959991552, 'f1-score': 0.3153529628815461, 'support': 439853}, 'weighted avg': {'precision': 0.34574271415427493, 'recall': 0.3456177404723851, 'f1-score': 0.31752868395991624, 'support': 439853}}
[[92558 42837 19489]
 [80416 39037 16569]
 [87279 41242 20426]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983633
{'0': {'precision': 0.349875902653774, 'recall': 0.5335502654564138, 'f1-score': 0.42261908799251185, 'support': 58390}, '1': {'precision': 0.3676694390373385, 'recall': 0.3500699230004549, 'f1-score': 0.35865390424733085, 'support': 59351}, '2': {'precision': 0.3543401698777709, 'recall': 0.16462933374400832, 'f1-score': 0.22481007334192057, 'support': 51947}, 'accuracy': 0.3564365187874216, 'macro avg': {'precision': 0.35729517052296117, 'recall': 0.34941650740029234, 'f1-score': 0.33536102186058775, 'support': 169688}, 'weighted avg': {'precision': 0.35746612392685106, 'recall': 0.3564365187874216, 'f1-score': 0.33969052200956373, 'support': 169688}}
[[31154 18583  8653]
 [31644 20777  6930]
 [26245 17150  8552]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091784
{'0': {'precision': 0.3271431841593224, 'recall': 0.5248106495294927, 'f1-score': 0.40304584633282214, 'support': 21785}, '1': {'precision': 0.33153851204937945, 'recall': 0.4609275150629907, 'f1-score': 0.3856700912806019, 'support': 21908}, '2': {'precision': 0.3321396598030439, 'recall': 0.01625054752518616, 'f1-score': 0.030985092078339663, 'support': 22830}, 'accuracy': 0.3292395111465207, 'macro avg': {'precision': 0.3302737853372486, 'recall': 0.3339962373725565, 'f1-score': 0.2732336765639212, 'support': 66523}, 'weighted avg': {'precision': 0.3303054345443251, 'recall': 0.3292395111465207, 'f1-score': 0.2696361224581641, 'support': 66523}}
[[11433  9981   371]
 [11435 10098   375]
 [12080 10379   371]]
Evaluating performance on  val set...
51/51 - 0s - 429ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974271
{'0': {'precision': 0.3144354454502144, 'recall': 0.5057471264367817, 'f1-score': 0.3877790834312574, 'support': 3915}, '1': {'precision': 0.435448136958711, 'recall': 0.38884892086330936, 'f1-score': 0.4108313539192399, 'support': 5560}, '2': {'precision': 0.27129337539432175, 'recall': 0.12752075919335706, 'f1-score': 0.17349203147064757, 'support': 3372}, 'accuracy': 0.3558807503697361, 'macro avg': {'precision': 0.340392319267749, 'recall': 0.3407056021644827, 'f1-score': 0.32403415627371496, 'support': 12847}, 'weighted avg': {'precision': 0.35548436773236364, 'recall': 0.3558807503697361, 'f1-score': 0.341511058577362, 'support': 12847}}
[[1980 1591  344]
 [2587 2162  811]
 [1730 1212  430]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1106639
{'0': {'precision': 0.33273226678967566, 'recall': 0.7054038435893256, 'f1-score': 0.4521769689601459, 'support': 134978}, '1': {'precision': 0.373022231123573, 'recall': 0.13736263736263737, 'f1-score': 0.20078697714532126, 'support': 162708}, '2': {'precision': 0.2807862709512117, 'recall': 0.17061561415458468, 'f1-score': 0.21225663270452944, 'support': 123324}, 'accuracy': 0.3292202085461153, 'macro avg': {'precision': 0.3288469229548201, 'recall': 0.3377940317021826, 'f1-score': 0.2884068596033322, 'support': 421010}, 'weighted avg': {'precision': 0.33308691757245285, 'recall': 0.3292202085461153, 'f1-score': 0.28474365778797867, 'support': 421010}}
[[ 95214  20093  19671]
 [106134  22350  34224]
 [ 84810  17473  21041]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1092067
{'0': {'precision': 0.3324342794660349, 'recall': 0.6439843253547977, 'f1-score': 0.43850550190207754, 'support': 56652}, '1': {'precision': 0.35205417846088727, 'recall': 0.2360620842572062, 'f1-score': 0.2826197757390418, 'support': 56375}, '2': {'precision': 0.33496799504439395, 'recall': 0.12040971590803659, 'f1-score': 0.17714262315220508, 'support': 53891}, 'accuracy': 0.337171545309673, 'macro avg': {'precision': 0.33981881765710537, 'recall': 0.3334853751733468, 'f1-score': 0.2994226335977748, 'support': 166918}, 'weighted avg': {'precision': 0.33987875083561847, 'recall': 0.337171545309673, 'f1-score': 0.3014731584091618, 'support': 166918}}
[[36483 12391  7778]
 [37962 13308  5105]
 [35300 12102  6489]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1176413
{'0': {'precision': 0.35440895039010745, 'recall': 0.8913915458191916, 'f1-score': 0.5071713217351614, 'support': 16205}, '1': {'precision': 0.34857038790748496, 'recall': 0.1259459103770481, 'f1-score': 0.18503480278422274, 'support': 15197}, '2': {'precision': 0.3170731707317073, 'recall': 0.0008731864588930683, 'f1-score': 0.0017415767968383684, 'support': 14888}, 'accuracy': 0.35368330092892636, 'macro avg': {'precision': 0.3400175030097666, 'recall': 0.3394035475517109, 'f1-score': 0.23131590043874087, 'support': 46290}, 'weighted avg': {'precision': 0.3404840482167941, 'recall': 0.35368330092892636, 'f1-score': 0.23885534158525498, 'support': 46290}}
[[14445  1748    12]
 [13267  1914    16]
 [13046  1829    13]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11298
{'0': {'precision': 0.35824357520786093, 'recall': 0.6315311714052533, 'f1-score': 0.45715853121853883, 'support': 120078}, '1': {'precision': 0.28902634510365066, 'recall': 0.3243523421381602, 'f1-score': 0.3056720878110453, 'support': 98393}, '2': {'precision': 0.36919384441620784, 'recall': 0.04439954496833455, 'f1-score': 0.07926644437708397, 'support': 117794}, 'accuracy': 0.3359760902859352, 'macro avg': {'precision': 0.33882125490923976, 'recall': 0.3334276861705827, 'f1-score': 0.28069902113555606, 'support': 336265}, 'weighted avg': {'precision': 0.3418261219774755, 'recall': 0.3359760902859352, 'f1-score': 0.2804567451165186, 'support': 336265}}
[[75833 40046  4199]
 [61742 31914  4737]
 [74105 38459  5230]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1109962
{'0': {'precision': 0.3580286129674653, 'recall': 0.6186274302843512, 'f1-score': 0.4535605392270666, 'support': 47371}, '1': {'precision': 0.3086943909707022, 'recall': 0.2820179242555652, 'f1-score': 0.29475380528522327, 'support': 41508}, '2': {'precision': 0.3436754176610978, 'recall': 0.1084649637785507, 'f1-score': 0.1648901237686284, 'support': 45139}, 'accuracy': 0.34254353892760675, 'macro avg': {'precision': 0.3367994738664218, 'recall': 0.3363701061061557, 'f1-score': 0.30440148942697276, 'support': 134018}, 'weighted avg': {'precision': 0.3379144956878778, 'recall': 0.34254353892760675, 'f1-score': 0.30714704405599647, 'support': 134018}}
[[29305 12906  5160]
 [25612 11706  4190]
 [26934 13309  4896]]
Evaluating performance on  val set...
107/107 - 1s - 693ms/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103265
{'0': {'precision': 0.35159010600706714, 'recall': 0.5305578342904019, 'f1-score': 0.42291973189471965, 'support': 9752}, '1': {'precision': 0.2882074295686861, 'recall': 0.4252605763335377, 'f1-score': 0.3435704378838914, 'support': 8155}, '2': {'precision': 0.35629453681710216, 'recall': 0.016193457843031417, 'f1-score': 0.03097893432465923, 'support': 9263}, 'accuracy': 0.3235921972764078, 'macro avg': {'precision': 0.3320306907976185, 'recall': 0.32400395615565697, 'f1-score': 0.2658230347010901, 'support': 27170}, 'weighted avg': {'precision': 0.334169841606565, 'recall': 0.3235921972764078, 'f1-score': 0.2654798680540949, 'support': 27170}}
[[5174 4420  158]
 [4574 3468  113]
 [4968 4145  150]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068283
{'0': {'precision': 0.32940556413055755, 'recall': 0.4729175862286399, 'f1-score': 0.3883265345370223, 'support': 111013}, '1': {'precision': 0.3152354801131636, 'recall': 0.48881618358600987, 'f1-score': 0.38328931156212853, 'support': 108505}, '2': {'precision': 0.35362461135657014, 'recall': 0.018919131873615647, 'f1-score': 0.03591669852244586, 'support': 114223}, 'accuracy': 0.3227053313797226, 'macro avg': {'precision': 0.33275521853343043, 'recall': 0.32688430056275514, 'f1-score': 0.2691775148738656, 'support': 333741}, 'weighted avg': {'precision': 0.33308760279224287, 'recall': 0.3227053313797226, 'f1-score': 0.2660764286825309, 'support': 333741}}
[[52500 56378  2135]
 [53651 53039  1815]
 [53227 58835  2161]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093811
{'0': {'precision': 0.33155643958229736, 'recall': 0.5150475837350142, 'f1-score': 0.40341727271627204, 'support': 32364}, '1': {'precision': 0.3301176984795979, 'recall': 0.3253138075313807, 'f1-score': 0.3276981482916247, 'support': 32504}, '2': {'precision': 0.3397741530740276, 'recall': 0.16226256815866738, 'f1-score': 0.21963583275883045, 'support': 33378}, 'accuracy': 0.33242065834741363, 'macro avg': {'precision': 0.3338160970453076, 'recall': 0.33420798647502076, 'f1-score': 0.31691708458890905, 'support': 98246}, 'weighted avg': {'precision': 0.33387232012832296, 'recall': 0.33242065834741363, 'f1-score': 0.31592840473998574, 'support': 98246}}
[[16669 10575  5120]
 [16526 10574  5404]
 [17080 10882  5416]]
Evaluating performance on  val set...
93/93 - 1s - 637ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114711
{'0': {'precision': 0.28842235804765703, 'recall': 0.4670109007458405, 'f1-score': 0.3566069766168337, 'support': 6972}, '1': {'precision': 0.3701844818231145, 'recall': 0.32441749881122206, 'f1-score': 0.3457932083122149, 'support': 8412}, '2': {'precision': 0.37507586485939715, 'recall': 0.22554744525547446, 'f1-score': 0.28169870090404925, 'support': 8220}, 'accuracy': 0.3321047280122013, 'macro avg': {'precision': 0.34456090157672287, 'recall': 0.33899194827084567, 'f1-score': 0.328032961944366, 'support': 23604}, 'weighted avg': {'precision': 0.34773750849637974, 'recall': 0.3321047280122013, 'f1-score': 0.32666665102212344, 'support': 23604}}
[[3256 2003 1713]
 [4307 2729 1376]
 [3726 2640 1854]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086442
{'0': {'precision': 0.34956937867665516, 'recall': 0.6298267827764714, 'f1-score': 0.44959979586284077, 'support': 232194}, '1': {'precision': 0.34460192565633785, 'recall': 0.19658357092380047, 'f1-score': 0.25035067466080757, 'support': 205185}, '2': {'precision': 0.38502183273697616, 'recall': 0.2208860842071386, 'f1-score': 0.28072240876618443, 'support': 229933}, 'accuracy': 0.35570617642122426, 'macro avg': {'precision': 0.35973104568998976, 'recall': 0.34909881263580345, 'f1-score': 0.3268909597632776, 'support': 667312}, 'weighted avg': {'precision': 0.3602576957929036, 'recall': 0.35570617642122426, 'f1-score': 0.3301453050382569, 'support': 667312}}
[[146242  38974  46978]
 [130704  40336  34145]
 [141403  37741  50789]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070219
{'0': {'precision': 0.33767859455259636, 'recall': 0.5070897275924096, 'f1-score': 0.4053971770406213, 'support': 61709}, '1': {'precision': 0.3429033118401029, 'recall': 0.35805320752244285, 'f1-score': 0.35031454101053816, 'support': 61044}, '2': {'precision': 0.3394290969544763, 'recall': 0.15495664249842556, 'f1-score': 0.21277633650413535, 'support': 61927}, 'accuracy': 0.3397498375568551, 'macro avg': {'precision': 0.3400036677823919, 'recall': 0.3400331925377593, 'f1-score': 0.32282935151843156, 'support': 184680}, 'weighted avg': {'precision': 0.33999254844224214, 'recall': 0.3397498375568551, 'f1-score': 0.3226004734142224, 'support': 184680}}
[[31292 20971  9446]
 [29958 21857  9229]
 [31418 20913  9596]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1201441
{'0': {'precision': 0.36031369511545724, 'recall': 0.7224109482674949, 'f1-score': 0.4808139534883721, 'support': 20606}, '1': {'precision': 0.32283519069703054, 'recall': 0.279114302812687, 'f1-score': 0.2993869756395032, 'support': 16710}, '2': {'precision': 0.48487430762675754, 'recall': 0.054732589457483646, 'f1-score': 0.09836207269112754, 'support': 20792}, 'accuracy': 0.35602670888690024, 'macro avg': {'precision': 0.3893410644797484, 'recall': 0.35208594684588856, 'f1-score': 0.2928543339396676, 'support': 58108}, 'weighted avg': {'precision': 0.39410591729662076, 'recall': 0.35602670888690024, 'f1-score': 0.29179377889294794, 'support': 58108}}
[[14886  4958   762]
 [11599  4664   447]
 [14829  4825  1138]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/EXC
Evaluating performance on  test set...
5343/5343 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1103332
{'0': {'precision': 0.3274374604443556, 'recall': 0.595639918489726, 'f1-score': 0.42257523952060055, 'support': 445588}, '1': {'precision': 0.33551383040375676, 'recall': 0.2864025002600899, 'f1-score': 0.30901905983689176, 'support': 470991}, '2': {'precision': 0.33323451889181754, 'recall': 0.1146007402318211, 'f1-score': 0.17054897647196574, 'support': 451210}, 'accuracy': 0.33046910013167236, 'macro avg': {'precision': 0.3320619365799766, 'recall': 0.33221438632721234, 'f1-score': 0.300714425276486, 'support': 1367789}, 'weighted avg': {'precision': 0.33213086586407137, 'recall': 0.33046910013167236, 'f1-score': 0.30033364467257634, 'support': 1367789}}
[[265410 131086  49092]
 [281726 134893  54372]
 [263431 136070  51709]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070104
{'0': {'precision': 0.33360396247795054, 'recall': 0.5251422844585835, 'f1-score': 0.4080123728868045, 'support': 108761}, '1': {'precision': 0.3383352613177015, 'recall': 0.47757127655670933, 'f1-score': 0.39607282244014513, 'support': 109012}, '2': {'precision': 0.3368648224445752, 'recall': 0.01527525710828796, 'f1-score': 0.02922528318907924, 'support': 112404}, 'accuracy': 0.3358592512500871, 'macro avg': {'precision': 0.33626801541340906, 'recall': 0.3393296060411936, 'f1-score': 0.27777015950534295, 'support': 330177}, 'weighted avg': {'precision': 0.33627617178631364, 'recall': 0.3358592512500871, 'f1-score': 0.27511777906690077, 'support': 330177}}
[[57115 50022  1624]
 [55195 52061  1756]
 [58896 51791  1717]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1051619
{'0': {'precision': 0.33157369933720454, 'recall': 0.5607578613232814, 'f1-score': 0.41673424253593805, 'support': 30243}, '1': {'precision': 0.38174390759261867, 'recall': 0.40750654115665697, 'f1-score': 0.3942047537311262, 'support': 33251}, '2': {'precision': 0.3526281844566269, 'recall': 0.07451448040885861, 'f1-score': 0.12303105310531054, 'support': 29350}, 'accuracy': 0.3521606135022188, 'macro avg': {'precision': 0.35531526379548345, 'recall': 0.3475929609629323, 'f1-score': 0.3113233497907916, 'support': 92844}, 'weighted avg': {'precision': 0.356197355501909, 'recall': 0.3521606135022188, 'f1-score': 0.3158196261682922, 'support': 92844}}
[[16959 11171  2113]
 [17799 13550  1902]
 [16389 10774  2187]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/AAL
Evaluating performance on  test set...
7177/7177 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1182996
{'0': {'precision': 0.37723945442098056, 'recall': 0.7350480222344704, 'f1-score': 0.4985925324174934, 'support': 682184}, '1': {'precision': 0.2811553599356895, 'recall': 0.14131410980851816, 'f1-score': 0.18809036984973854, 'support': 499943}, '2': {'precision': 0.36138328305622464, 'recall': 0.14157004528506997, 'f1-score': 0.20344252583539946, 'support': 654962}, 'accuracy': 0.3618823040146667, 'macro avg': {'precision': 0.3399260324709649, 'recall': 0.3393107257760195, 'f1-score': 0.29670847603421047, 'support': 1837089}, 'weighted avg': {'precision': 0.3454381861325834, 'recall': 0.3618823040146667, 'f1-score': 0.30886551251174443, 'support': 1837089}}
[[501438  92121  88625]
 [354064  70649  75230]
 [473728  88511  92723]]
Evaluating performance on  train set...
2257/2257 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133528
{'0': {'precision': 0.34329970725030734, 'recall': 0.5511276359826252, 'f1-score': 0.42306836328709146, 'support': 196606}, '1': {'precision': 0.3497817208843825, 'recall': 0.1977526777847369, 'f1-score': 0.25266091815663394, 'support': 188402}, '2': {'precision': 0.33899711771063873, 'recall': 0.27362424506795036, 'f1-score': 0.30282270926065885, 'support': 192567}, 'accuracy': 0.34333722893130764, 'macro avg': {'precision': 0.34402618194844287, 'recall': 0.3408348529451041, 'f1-score': 0.32618399690146144, 'support': 577575}, 'weighted avg': {'precision': 0.34397959743392276, 'recall': 0.34333722893130764, 'f1-score': 0.3273917007993167, 'support': 577575}}
[[108355  34894  53357]
 [101761  37257  49384]
 [105512  34364  52691]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146276
{'0': {'precision': 0.3723723066827081, 'recall': 0.5729334948842219, 'f1-score': 0.4513768279263393, 'support': 59424}, '1': {'precision': 0.28701603925287594, 'recall': 0.14683795300172975, 'f1-score': 0.19428124869172053, 'support': 47406}, '2': {'precision': 0.36026865358379684, 'recall': 0.30381606428546143, 'f1-score': 0.32964289486571346, 'support': 56498}, 'accuracy': 0.35616673197492166, 'macro avg': {'precision': 0.3398856665064603, 'recall': 0.34119583739047105, 'f1-score': 0.3251003238279244, 'support': 163328}, 'weighted avg': {'precision': 0.34341076055123704, 'recall': 0.35616673197492166, 'f1-score': 0.3346448727241965, 'support': 163328}}
[[34046  8745 16633]
 [26598  6961 13847]
 [30786  8547 17165]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/WBA
Evaluating performance on  test set...
5696/5696 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077942
{'0': {'precision': 0.35887979191374525, 'recall': 0.5305773257783389, 'f1-score': 0.42815662831178736, 'support': 519568}, '1': {'precision': 0.2948322979130607, 'recall': 0.4657780937148273, 'f1-score': 0.36109531817885393, 'support': 422025}, '2': {'precision': 0.35336528083581575, 'recall': 0.015849164748049593, 'f1-score': 0.030337624213760715, 'support': 516431}, 'accuracy': 0.3295048641174631, 'macro avg': {'precision': 0.33569245688754057, 'recall': 0.3374015280804053, 'f1-score': 0.273196523568134, 'support': 1458024}, 'weighted avg': {'precision': 0.33838801117068124, 'recall': 0.3295048641174631, 'f1-score': 0.2678385433459711, 'support': 1458024}}
[[275671 235763   8134]
 [218611 196570   6844]
 [273861 234385   8185]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1117747
{'0': {'precision': 0.3468527170915995, 'recall': 0.6501319044117269, 'f1-score': 0.4523640839577206, 'support': 194459}, '1': {'precision': 0.32650228916662266, 'recall': 0.23629981822251092, 'f1-score': 0.2741725042118997, 'support': 183191}, '2': {'precision': 0.3411927490251436, 'recall': 0.12783226596986946, 'f1-score': 0.1859834373262024, 'support': 190969}, 'accuracy': 0.3413955566029274, 'macro avg': {'precision': 0.33818258509445526, 'recall': 0.33808799620136903, 'f1-score': 0.3041733418319409, 'support': 568619}, 'weighted avg': {'precision': 0.3383955714744332, 'recall': 0.3413955566029274, 'f1-score': 0.30549326291271317, 'support': 568619}}
[[126424  43956  24079]
 [116845  43288  23058]
 [121220  45337  24412]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139495
{'0': {'precision': 0.35811700927847756, 'recall': 0.6444933394736393, 'f1-score': 0.46040623362698163, 'support': 58629}, '1': {'precision': 0.32149833784571097, 'recall': 0.18866899963798722, 'f1-score': 0.2377916629700511, 'support': 49722}, '2': {'precision': 0.3427199451209055, 'recall': 0.18004901254144443, 'f1-score': 0.23607517926545463, 'support': 55496}, 'accuracy': 0.34885594487540206, 'macro avg': {'precision': 0.3407784307483647, 'recall': 0.33773711721769034, 'f1-score': 0.3114243586208291, 'support': 163847}, 'weighted avg': {'precision': 0.3417894045407122, 'recall': 0.34885594487540206, 'f1-score': 0.3168679456201753, 'support': 163847}}
[[37786 10087 10756]
 [31934  9381  8407]
 [35793  9711  9992]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000307
{'0': {'precision': 0.31073423288830104, 'recall': 0.4473907543514115, 'f1-score': 0.36674591972193465, 'support': 936765}, '1': {'precision': 0.3952937160947584, 'recall': 0.5573302234958173, 'f1-score': 0.46253117517132647, 'support': 1192774}, '2': {'precision': 0.3102651048088779, 'recall': 0.018885586722860243, 'f1-score': 0.0356039874422101, 'support': 959303}, 'accuracy': 0.35676347317214674, 'macro avg': {'precision': 0.3387643512639791, 'recall': 0.34120218819002973, 'f1-score': 0.2882936941118237, 'support': 3088842}, 'weighted avg': {'precision': 0.34324166352027385, 'recall': 0.35676347317214674, 'f1-score': 0.30089105023416424, 'support': 3088842}}
[[419100 499862  17803]
 [505533 664769  22472]
 [424108 517078  18117]]
Evaluating performance on  train set...
2948/2948 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1132101
{'0': {'precision': 0.3348303634660133, 'recall': 0.5993441228923156, 'f1-score': 0.4296383886302736, 'support': 254011}, '1': {'precision': 0.31822355952404213, 'recall': 0.2645389206967962, 'f1-score': 0.2889084998913511, 'support': 246270}, '2': {'precision': 0.34436264198569627, 'recall': 0.12880358456497024, 'f1-score': 0.18748228503697595, 'support': 254201}, 'accuracy': 0.33152547045522623, 'macro avg': {'precision': 0.33247218832525055, 'recall': 0.33089554271802735, 'f1-score': 0.3020097245195335, 'support': 754482}, 'weighted avg': {'precision': 0.3326213738879885, 'recall': 0.33152547045522623, 'f1-score': 0.30211530207651316, 'support': 754482}}
[[152240  69553  32218]
 [151002  65148  30120]
 [151436  70023  32742]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109736
{'0': {'precision': 0.344057829881269, 'recall': 0.6005197182408027, 'f1-score': 0.43747283951352217, 'support': 61187}, '1': {'precision': 0.32946992666497393, 'recall': 0.3790792390575862, 'f1-score': 0.35253787636642586, 'support': 58191}, '2': {'precision': 0.3640077402709095, 'recall': 0.0286842194435973, 'f1-score': 0.053177956119548314, 'support': 59022}, 'accuracy': 0.3391031390134529, 'macro avg': {'precision': 0.3458451656057175, 'recall': 0.33609439224732873, 'f1-score': 0.2810628906664988, 'support': 178400}, 'weighted avg': {'precision': 0.34589975216242336, 'recall': 0.3391031390134529, 'f1-score': 0.2826280914856533, 'support': 178400}}
[[36744 22918  1525]
 [34699 22059  1433]
 [35353 21976  1693]]
testing model on single stock: results/universal/W1/deepLOB_L1/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 129s - 129s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074786
{'0': {'precision': 0.34995563518836825, 'recall': 0.4288980391209193, 'f1-score': 0.3854261478440511, 'support': 1903534}, '1': {'precision': 0.30420075954509473, 'recall': 0.557943031204722, 'f1-score': 0.3937317549494977, 'support': 1645392}, '2': {'precision': 0.3505821810999064, 'recall': 0.021106342229739773, 'f1-score': 0.039815636101202374, 'support': 1917291}, 'accuracy': 0.3247079287192587, 'macro avg': {'precision': 0.33491285861112313, 'recall': 0.3359824708517937, 'f1-score': 0.27299117963158376, 'support': 5466217}, 'weighted avg': {'precision': 0.33640267241591365, 'recall': 0.3247079287192587, 'f1-score': 0.26670236790931506, 'support': 5466217}}
[[ 816422 1046542   40570]
 [ 692966  918035   34391]
 [ 823542 1053282   40467]]
Evaluating performance on  train set...
6073/6073 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055886
{'0': {'precision': 0.34085285727617354, 'recall': 0.520195235364084, 'f1-score': 0.411846989339721, 'support': 519578}, '1': {'precision': 0.3490898472825825, 'recall': 0.4812128506836842, 'f1-score': 0.40463922607272657, 'support': 511786}, '2': {'precision': 0.36775975761896273, 'recall': 0.03944073854622604, 'f1-score': 0.07124115311582944, 'support': 523190}, 'accuracy': 0.3455621355063896, 'macro avg': {'precision': 0.3525674873925729, 'recall': 0.3469496081979981, 'f1-score': 0.295909122842759, 'support': 1554554}, 'weighted avg': {'precision': 0.352620217790999, 'recall': 0.3455621355063896, 'f1-score': 0.294842112194675, 'support': 1554554}}
[[270282 228731  20565]
 [250598 246278  14910]
 [272078 230477  20635]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999691
{'0': {'precision': 0.32330744889036933, 'recall': 0.42288604630581444, 'f1-score': 0.36645242737346956, 'support': 146893}, '1': {'precision': 0.3786499042361142, 'recall': 0.4731284249464193, 'f1-score': 0.42064942640482206, 'support': 160039}, '2': {'precision': 0.37514980180069446, 'recall': 0.16249725477668855, 'f1-score': 0.22676888928102087, 'support': 150261}, 'accuracy': 0.3548938850769806, 'macro avg': {'precision': 0.35903571830905934, 'recall': 0.3528372420096408, 'f1-score': 0.3379569143531042, 'support': 457193}, 'weighted avg': {'precision': 0.35971840662973986, 'recall': 0.3548938850769806, 'f1-score': 0.33951554384872, 'support': 457193}}
[[62119 62011 22763]
 [66414 75719 17906]
 [63603 62241 24417]]
training model: results/universal/W1/deepLOB_L1/h500
Epoch 1/50
10622/10622 - 160s - loss: 3.2121 - accuracy500: 0.4193 - val_loss: 3.5388 - val_accuracy500: 0.3225 - 160s/epoch - 15ms/step
Epoch 2/50
10622/10622 - 157s - loss: 3.1903 - accuracy500: 0.4295 - val_loss: 3.4604 - val_accuracy500: 0.3368 - 157s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 159s - loss: 3.1753 - accuracy500: 0.4355 - val_loss: 3.6846 - val_accuracy500: 0.3402 - 159s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 155s - loss: 3.1694 - accuracy500: 0.4381 - val_loss: 3.4955 - val_accuracy500: 0.3301 - 155s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 155s - loss: 3.1592 - accuracy500: 0.4422 - val_loss: 3.8994 - val_accuracy500: 0.3438 - 155s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 157s - loss: 3.1509 - accuracy500: 0.4454 - val_loss: 3.6052 - val_accuracy500: 0.3331 - 157s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 157s - loss: 3.1481 - accuracy500: 0.4459 - val_loss: 3.7186 - val_accuracy500: 0.3407 - 157s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 154s - loss: 3.1425 - accuracy500: 0.4483 - val_loss: 3.6513 - val_accuracy500: 0.3338 - 154s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 154s - loss: 3.1398 - accuracy500: 0.4493 - val_loss: 3.7404 - val_accuracy500: 0.3449 - 154s/epoch - 14ms/step
Epoch 10/50
10622/10622 - 159s - loss: 3.1414 - accuracy500: 0.4487 - val_loss: 3.6427 - val_accuracy500: 0.3416 - 159s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 161s - loss: 3.1353 - accuracy500: 0.4505 - val_loss: 3.5828 - val_accuracy500: 0.3248 - 161s/epoch - 15ms/step
Epoch 12/50
10622/10622 - 156s - loss: 3.1340 - accuracy500: 0.4510 - val_loss: 3.8138 - val_accuracy500: 0.3417 - 156s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 177s - 177s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1710925
{'0': {'precision': 0.3702465130365553, 'recall': 0.3656090813390874, 'f1-score': 0.36791318442078325, 'support': 3350431}, '1': {'precision': 0.25130202313109057, 'recall': 0.5648000869252895, 'f1-score': 0.3478373668195405, 'support': 2319233}, '2': {'precision': 0.35083578967386136, 'recall': 0.054628548551915734, 'f1-score': 0.09453679726218542, 'support': 3377117}, 'accuracy': 0.30058625272348255, 'macro avg': {'precision': 0.32412810861383573, 'recall': 0.3283459056054309, 'f1-score': 0.27009578283416974, 'support': 9046781}, 'weighted avg': {'precision': 0.3325079770857711, 'recall': 0.30058625272348255, 'f1-score': 0.26071654252631654, 'support': 9046781}}
[[1224948 1937963  187520]
 [ 855487 1309903  153843]
 [1228031 1964599  184487]]
Evaluating performance on  train set...
10622/10622 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1400418
{'0': {'precision': 0.33673787847667724, 'recall': 0.41785090119512064, 'f1-score': 0.3729348481677971, 'support': 906352}, '1': {'precision': 0.34729029265242733, 'recall': 0.5160436354917983, 'f1-score': 0.4151741043621532, 'support': 900918}, '2': {'precision': 0.3581131395157434, 'recall': 0.10027391126855156, 'f1-score': 0.156677223383442, 'support': 911244}, 'accuracy': 0.3439404763043339, 'macro avg': {'precision': 0.347380436881616, 'recall': 0.3447228159851568, 'f1-score': 0.3149287253044641, 'support': 2718514}, 'weighted avg': {'precision': 0.347399930702515, 'recall': 0.3439404763043339, 'f1-score': 0.3144435706437939, 'support': 2718514}}
[[378720 433044  94588]
 [366813 464913  69192]
 [379140 440730  91374]]
Evaluating performance on  val set...
3064/3064 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1545938
{'0': {'precision': 0.3554843574727348, 'recall': 0.34279863826954593, 'f1-score': 0.34902626703157863, 'support': 276413}, '1': {'precision': 0.3109862721537076, 'recall': 0.43213904428406713, 'f1-score': 0.36168680426115196, 'support': 234170}, '2': {'precision': 0.35579569623420493, 'recall': 0.2498325371987042, 'f1-score': 0.2935442458179848, 'support': 273195}, 'accuracy': 0.33708652194881716, 'macro avg': {'precision': 0.3407554419535492, 'recall': 0.3415900732507724, 'f1-score': 0.33475243903690516, 'support': 783778}, 'weighted avg': {'precision': 0.3422981485638132, 'recall': 0.33708652194881716, 'f1-score': 0.33346995799713447, 'support': 783778}}
[[ 94754 112849  68810]
 [ 78207 101194  54769]
 [ 93588 111354  68253]]
testing model out of sample: results/universal/W1/deepLOB_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 128s - 128s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.119057
{'0': {'precision': 0.32071357224872343, 'recall': 0.46215141371589874, 'f1-score': 0.3786559201648126, 'support': 1858471}, '1': {'precision': 0.4373759615191426, 'recall': 0.49330433297425597, 'f1-score': 0.4636596653711677, 'support': 2382959}, '2': {'precision': 0.35091424465571475, 'recall': 0.13854112950716074, 'f1-score': 0.19865368072790618, 'support': 1857766}, 'accuracy': 0.3757537878763037, 'macro avg': {'precision': 0.36966792614119354, 'recall': 0.3646656253991052, 'f1-score': 0.3469897554212955, 'support': 6099196}, 'weighted avg': {'precision': 0.3754925091525867, 'recall': 0.3757537878763037, 'f1-score': 0.3570396939152294, 'support': 6099196}}
[[ 858895  753803  245773]
 [ 977138 1175524  230297]
 [ 842042  758347  257377]]
Evaluating performance on  train set...
6711/6711 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1423652
{'0': {'precision': 0.3386942393880762, 'recall': 0.42623470618645526, 'f1-score': 0.3774552929336244, 'support': 580300}, '1': {'precision': 0.34985233651666786, 'recall': 0.3582384799786913, 'f1-score': 0.3539957483731781, 'support': 563150}, '2': {'precision': 0.348684755642854, 'recall': 0.24934300870644166, 'f1-score': 0.29076277472387896, 'support': 573828}, 'accuracy': 0.3448282689232611, 'macro avg': {'precision': 0.3457437771825327, 'recall': 0.34460539829052944, 'f1-score': 0.34073793867689384, 'support': 1717278}, 'weighted avg': {'precision': 0.3456916622627727, 'recall': 0.3448282689232611, 'f1-score': 0.34079388059475024, 'support': 1717278}}
[[247344 187994 144962]
 [239108 201742 122300]
 [243835 186913 143080]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1365896
{'0': {'precision': 0.353404787389783, 'recall': 0.4807888206869531, 'f1-score': 0.40737082928745516, 'support': 153140}, '1': {'precision': 0.35428440249279236, 'recall': 0.3728240326270765, 'f1-score': 0.36331785811964035, 'support': 140742}, '2': {'precision': 0.36555684774659203, 'recall': 0.2088771057264799, 'f1-score': 0.2658493839862585, 'support': 145971}, 'accuracy': 0.3560053017712736, 'macro avg': {'precision': 0.3577486792097225, 'recall': 0.35416331968016984, 'f1-score': 0.3455126904644514, 'support': 439853}, 'weighted avg': {'precision': 0.35771906327552555, 'recall': 0.3560053017712736, 'f1-score': 0.34630922425085986, 'support': 439853}}
[[73628 49712 29800]
 [65153 52472 23117]
 [69558 45923 30490]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1289878
{'0': {'precision': 0.31914121444807364, 'recall': 0.29833050620480317, 'f1-score': 0.3083851676848964, 'support': 56005}, '1': {'precision': 0.4070258357452006, 'recall': 0.4775017521999844, 'f1-score': 0.4394561626065206, 'support': 64205}, '2': {'precision': 0.3288981981767548, 'recall': 0.27927563765714053, 'f1-score': 0.3020624979506181, 'support': 49478}, 'accuracy': 0.36056763000330017, 'macro avg': {'precision': 0.35168841612334295, 'recall': 0.3517026320206427, 'f1-score': 0.349967942747345, 'support': 169688}, 'weighted avg': {'precision': 0.3552391598025461, 'recall': 0.36056763000330017, 'f1-score': 0.3561350390713837, 'support': 169688}}
[[16708 23456 15841]
 [21193 30658 12354]
 [14452 21208 13818]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1447389
{'0': {'precision': 0.3298622109597719, 'recall': 0.3798039662639617, 'f1-score': 0.35307579835138053, 'support': 21935}, '1': {'precision': 0.3340471092077088, 'recall': 0.6052307270984527, 'f1-score': 0.43049152652425166, 'support': 21909}, '2': {'precision': 0.34923664122137404, 'recall': 0.024207416552758057, 'f1-score': 0.04527648344398169, 'support': 22679}, 'accuracy': 0.33281722111149525, 'macro avg': {'precision': 0.33771532046295155, 'recall': 0.3364140366383908, 'f1-score': 0.2762812694398713, 'support': 66523}, 'weighted avg': {'precision': 0.3378456097784801, 'recall': 0.33281722111149525, 'f1-score': 0.2736374165248624, 'support': 66523}}
[[ 8331 13102   502]
 [ 8128 13260   521]
 [ 8797 13333   549]]
Evaluating performance on  val set...
51/51 - 0s - 425ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996277
{'0': {'precision': 0.344889689329131, 'recall': 0.3787391841779975, 'f1-score': 0.36102274066218915, 'support': 4045}, '1': {'precision': 0.4500752634219769, 'recall': 0.4895397489539749, 'f1-score': 0.46897873823631925, 'support': 5497}, '2': {'precision': 0.31863149216817804, 'recall': 0.23388804841149774, 'f1-score': 0.2697609492235212, 'support': 3305}, 'accuracy': 0.38888456448976416, 'macro avg': {'precision': 0.3711988149730953, 'recall': 0.3673889938478234, 'f1-score': 0.3665874760406765, 'support': 12847}, 'weighted avg': {'precision': 0.3831415581834491, 'recall': 0.38888456448976416, 'f1-score': 0.38373729643086635, 'support': 12847}}
[[1532 1917  596]
 [1749 2691 1057]
 [1161 1371  773]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.138342
{'0': {'precision': 0.37910070957532216, 'recall': 0.5253987651144841, 'f1-score': 0.4404182649928159, 'support': 155480}, '1': {'precision': 0.3019600190798318, 'recall': 0.21837197086701216, 'f1-score': 0.25345204893606377, 'support': 127553}, '2': {'precision': 0.3396566182636713, 'recall': 0.27887256571747465, 'f1-score': 0.3062779091147885, 'support': 137977}, 'accuracy': 0.3515854730291442, 'macro avg': {'precision': 0.34023911563960846, 'recall': 0.34088110056632365, 'f1-score': 0.33338274101455606, 'support': 421010}, 'weighted avg': {'precision': 0.34280251266389744, 'recall': 0.3515854730291442, 'f1-score': 0.3398116626801167, 'support': 421010}}
[[81689 35424 38367]
 [63259 27854 36440]
 [70533 28966 38478]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1435479
{'0': {'precision': 0.33020692967593024, 'recall': 0.4263712789415656, 'f1-score': 0.372177652799603, 'support': 58048}, '1': {'precision': 0.3839794990493511, 'recall': 0.4143030432766064, 'f1-score': 0.3985653363994406, 'support': 56058}, '2': {'precision': 0.33160736975857685, 'recall': 0.19766340983109898, 'f1-score': 0.2476866132017273, 'support': 52812}, 'accuracy': 0.349956265950946, 'macro avg': {'precision': 0.3485979328279527, 'recall': 0.34611257734975703, 'f1-score': 0.3394765341335903, 'support': 166918}, 'weighted avg': {'precision': 0.3487090848394234, 'recall': 0.349956265950946, 'f1-score': 0.34165140628332963, 'support': 166918}}
[[24750 19468 13830]
 [25622 23225  7211]
 [24581 17792 10439]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.129374
{'0': {'precision': 0.3912339150900144, 'recall': 0.7105584545353614, 'f1-score': 0.5046224202164357, 'support': 18014}, '1': {'precision': 0.27686746987951805, 'recall': 0.2867481906663339, 'f1-score': 0.281721221037146, 'support': 12021}, '2': {'precision': 0.3748886910062333, 'recall': 0.02589972316210397, 'f1-score': 0.04845206583036023, 'support': 16255}, 'accuracy': 0.36007777057679846, 'macro avg': {'precision': 0.3476633586585886, 'recall': 0.3410687894545997, 'f1-score': 0.2782652356946473, 'support': 46290}, 'weighted avg': {'precision': 0.35579449717346134, 'recall': 0.36007777057679846, 'f1-score': 0.28655060285026807, 'support': 46290}}
[[12800  4802   412]
 [ 8284  3447   290]
 [11633  4201   421]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1569595
{'0': {'precision': 0.3751138779228667, 'recall': 0.4655282063361206, 'f1-score': 0.41545883564739394, 'support': 127365}, '1': {'precision': 0.2475360961128237, 'recall': 0.471798955204073, 'f1-score': 0.3247089692279589, 'support': 82887}, '2': {'precision': 0.43288822947576655, 'recall': 0.06946108734813075, 'f1-score': 0.11971306066346174, 'support': 126013}, 'accuracy': 0.3186504691240539, 'macro avg': {'precision': 0.3518460678371523, 'recall': 0.3355960829627748, 'f1-score': 0.28662695517960485, 'support': 336265}, 'weighted avg': {'precision': 0.36531737742875203, 'recall': 0.3186504691240539, 'f1-score': 0.28226092173735884, 'support': 336265}}
[[59292 61080  6993]
 [39307 39106  4474]
 [59465 57795  8753]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1587394
{'0': {'precision': 0.3284062661617257, 'recall': 0.42826063309039486, 'f1-score': 0.371744754782543, 'support': 45965}, '1': {'precision': 0.29343416440190634, 'recall': 0.33773828682820684, 'f1-score': 0.31403129775014493, 'support': 44117}, '2': {'precision': 0.3263659384522941, 'recall': 0.17306991988346687, 'f1-score': 0.22619171562430285, 'support': 43936}, 'accuracy': 0.314800996881016, 'macro avg': {'precision': 0.3160687896719754, 'recall': 0.3130229466006895, 'f1-score': 0.30398925605233024, 'support': 134018}, 'weighted avg': {'precision': 0.3162250065430212, 'recall': 0.314800996881016, 'f1-score': 0.30502862029049904, 'support': 134018}}
[[19685 17905  8375]
 [21897 14900  7320]
 [18359 17973  7604]]
Evaluating performance on  val set...
107/107 - 1s - 677ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1514238
{'0': {'precision': 0.37716800414185864, 'recall': 0.41529691211401426, 'f1-score': 0.39531518495070994, 'support': 10525}, '1': {'precision': 0.26693386773547095, 'recall': 0.5490519373454246, 'f1-score': 0.3592233009708738, 'support': 7278}, '2': {'precision': 0.36824877250409166, 'recall': 0.024020497491192484, 'f1-score': 0.04509921828021647, 'support': 9367}, 'accuracy': 0.31623113728376884, 'macro avg': {'precision': 0.33745021479380705, 'recall': 0.32945644898354376, 'f1-score': 0.2665459014006001, 'support': 27170}, 'weighted avg': {'precision': 0.3445647473322652, 'recall': 0.31623113728376884, 'f1-score': 0.26490849774394665, 'support': 27170}}
[[4371 5914  240]
 [3136 3996  146]
 [4082 5060  225]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1534247
{'0': {'precision': 0.3404512933406714, 'recall': 0.3502190556653979, 'f1-score': 0.34526610451836715, 'support': 114811}, '1': {'precision': 0.3069471859804535, 'recall': 0.6169358350347871, 'f1-score': 0.4099365702950944, 'support': 103343}, '2': {'precision': 0.3396416855917234, 'recall': 0.023289816328825905, 'f1-score': 0.043590553221118426, 'support': 115587}, 'accuracy': 0.3195801534723034, 'macro avg': {'precision': 0.3290133883042828, 'recall': 0.33014823567633694, 'f1-score': 0.26626440934485995, 'support': 333741}, 'weighted avg': {'precision': 0.3297963390563472, 'recall': 0.3195801534723034, 'f1-score': 0.260809798571448, 'support': 333741}}
[[40209 71893  2709]
 [37062 63756  2525]
 [40834 72061  2692]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1486033
{'0': {'precision': 0.331702028805947, 'recall': 0.33338521885312244, 'f1-score': 0.3325414939369944, 'support': 32122}, '1': {'precision': 0.330609982406671, 'recall': 0.4227557089586736, 'f1-score': 0.3710475778312731, 'support': 32449}, '2': {'precision': 0.3362759522641818, 'recall': 0.24433556050482555, 'f1-score': 0.2830263316306348, 'support': 33675}, 'accuracy': 0.3323799442216477, 'macro avg': {'precision': 0.3328626544922666, 'recall': 0.3334921627722072, 'f1-score': 0.32887180113296743, 'support': 98246}, 'weighted avg': {'precision': 0.3329091116270893, 'recall': 0.3323799442216477, 'f1-score': 0.32828748690992754, 'support': 98246}}
[[10709 13566  7847]
 [10338 13718  8393]
 [11238 14209  8228]]
Evaluating performance on  val set...
93/93 - 1s - 616ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.140241
{'0': {'precision': 0.2938382998931497, 'recall': 0.35221289312651205, 'f1-score': 0.32038834951456313, 'support': 7027}, '1': {'precision': 0.3917065390749601, 'recall': 0.4382583868665239, 'f1-score': 0.4136769412161023, 'support': 8406}, '2': {'precision': 0.3845221606648199, 'recall': 0.27181495532982497, 'f1-score': 0.31849143184914314, 'support': 8171}, 'accuracy': 0.35502457210642263, 'macro avg': {'precision': 0.35668899987764324, 'recall': 0.354095411774287, 'f1-score': 0.3508522408599362, 'support': 23604}, 'weighted avg': {'precision': 0.3600837771397018, 'recall': 0.35502457210642263, 'f1-score': 0.3529541937612583, 'support': 23604}}
[[2475 2574 1978]
 [3145 3684 1577]
 [2803 3147 2221]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1450741
{'0': {'precision': 0.347123212697544, 'recall': 0.44230677028623233, 'f1-score': 0.3889767310821456, 'support': 229429}, '1': {'precision': 0.3212087468337392, 'recall': 0.25077742482504956, 'f1-score': 0.2816568174319383, 'support': 209345}, '2': {'precision': 0.3563560724247152, 'recall': 0.32983573847675224, 'f1-score': 0.34258341892616595, 'support': 228538}, 'accuracy': 0.34370279569376844, 'macro avg': {'precision': 0.34156267731866613, 'recall': 0.3409733111960114, 'f1-score': 0.33773898914675, 'support': 667312}, 'weighted avg': {'precision': 0.3421555145894177, 'recall': 0.34370279569376844, 'f1-score': 0.3394204184478667, 'support': 667312}}
[[101478  57613  70338]
 [ 91034  52499  65812]
 [ 99828  53330  75380]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.150714
{'0': {'precision': 0.34396521039354966, 'recall': 0.35588932300006404, 'f1-score': 0.3498256852576159, 'support': 62452}, '1': {'precision': 0.3197061514592975, 'recall': 0.3985585109020878, 'f1-score': 0.35480405574441154, 'support': 60493}, '2': {'precision': 0.3258678611422172, 'recall': 0.23568478172835505, 'f1-score': 0.27353480283874604, 'support': 61735}, 'accuracy': 0.3296837773445961, 'macro avg': {'precision': 0.32984640766502143, 'recall': 0.330044205210169, 'f1-score': 0.3260548479469245, 'support': 184680}, 'weighted avg': {'precision': 0.32996941708544525, 'recall': 0.3296837773445961, 'f1-score': 0.3259537930101002, 'support': 184680}}
[[22226 25736 14490]
 [20773 24110 15610]
 [21618 25567 14550]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1376467
{'0': {'precision': 0.3409902715260636, 'recall': 0.5948629616495263, 'f1-score': 0.43349208107210097, 'support': 19739}, '1': {'precision': 0.3196476633227306, 'recall': 0.35813366960907944, 'f1-score': 0.33779800382686037, 'support': 18239}, '2': {'precision': 0.4305126621371217, 'recall': 0.06924987580725285, 'f1-score': 0.11930845600821635, 'support': 20130}, 'accuracy': 0.3384731878570937, 'macro avg': {'precision': 0.363716865661972, 'recall': 0.3407488356886195, 'f1-score': 0.2968661803023926, 'support': 58108}, 'weighted avg': {'precision': 0.36530392699484604, 'recall': 0.3384731878570937, 'f1-score': 0.2946148069031063, 'support': 58108}}
[[11742  7006   991]
 [10854  6532   853]
 [11839  6897  1394]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/EXC
Evaluating performance on  test set...
5343/5343 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1516136
{'0': {'precision': 0.3378415286727293, 'recall': 0.4332395023933376, 'f1-score': 0.3796392074841144, 'support': 462534}, '1': {'precision': 0.32378819869709285, 'recall': 0.3931420021576646, 'f1-score': 0.3551105548602419, 'support': 438437}, '2': {'precision': 0.33530472680448536, 'recall': 0.17403784772652298, 'f1-score': 0.22914131236453225, 'support': 466818}, 'accuracy': 0.3319225406842722, 'macro avg': {'precision': 0.3323114847247692, 'recall': 0.3334731174258417, 'f1-score': 0.32129702490296286, 'support': 1367789}, 'weighted avg': {'precision': 0.33247101859474354, 'recall': 0.3319225406842722, 'f1-score': 0.320412678191668, 'support': 1367789}}
[[200388 176906  85240]
 [190254 172368  75815]
 [202500 183074  81244]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1473773
{'0': {'precision': 0.3276305257973156, 'recall': 0.39167717064284335, 'f1-score': 0.35680251440544786, 'support': 108689}, '1': {'precision': 0.3281903929039915, 'recall': 0.5848066042111122, 'f1-score': 0.4204349188778266, 'support': 107810}, '2': {'precision': 0.34599778679454074, 'recall': 0.02475413008673622, 'f1-score': 0.04620272389193095, 'support': 113678}, 'accuracy': 0.3284087019992307, 'macro avg': {'precision': 0.33393956849861595, 'recall': 0.33374596831356396, 'f1-score': 0.2744800523917351, 'support': 330177}, 'weighted avg': {'precision': 0.33413707461329395, 'recall': 0.3284087019992307, 'f1-score': 0.2706422020280611, 'support': 330177}}
[[42571 63456  2662]
 [42105 63048  2657]
 [45260 65604  2814]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1379257
{'0': {'precision': 0.3303146225310329, 'recall': 0.4138302034428795, 'f1-score': 0.36738592454304697, 'support': 30672}, '1': {'precision': 0.3447499275313845, 'recall': 0.48728292729049133, 'f1-score': 0.40380798161303805, 'support': 31729}, '2': {'precision': 0.35893416927899685, 'recall': 0.11283382058272838, 'f1-score': 0.1716941993851998, 'support': 30443}, 'accuracy': 0.34023738744560766, 'macro avg': {'precision': 0.3446662397804714, 'recall': 0.3379823171053664, 'f1-score': 0.3142960351804283, 'support': 92844}, 'weighted avg': {'precision': 0.3446320006492142, 'recall': 0.34023738744560766, 'f1-score': 0.3156668286380171, 'support': 92844}}
[[12693 14942  3037]
 [13170 15461  3098]
 [12564 14444  3435]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/AAL
Evaluating performance on  test set...
7177/7177 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1378034
{'0': {'precision': 0.3712001467535671, 'recall': 0.621696676654253, 'f1-score': 0.4648497047622765, 'support': 670499}, '1': {'precision': 0.30940971232175324, 'recall': 0.1904619908315231, 'f1-score': 0.23578365976575366, 'support': 529859}, '2': {'precision': 0.3624930726501785, 'recall': 0.2208640697563021, 'f1-score': 0.2744860376739801, 'support': 636731}, 'accuracy': 0.3583909108377438, 'macro avg': {'precision': 0.3477009772418329, 'recall': 0.34434091241402603, 'f1-score': 0.3250398007340034, 'support': 1837089}, 'weighted avg': {'precision': 0.35036050218624826, 'recall': 0.3583909108377438, 'f1-score': 0.3328021264225169, 'support': 1837089}}
[[416847 119068 134584]
 [316201 100918 112740]
 [389923 106177 140631]]
Evaluating performance on  train set...
2257/2257 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1436518
{'0': {'precision': 0.3469331720229438, 'recall': 0.40802559147489037, 'f1-score': 0.37500753567271533, 'support': 198191}, '1': {'precision': 0.35998521621288654, 'recall': 0.2659990896677287, 'f1-score': 0.3059365511464768, 'support': 186745}, '2': {'precision': 0.3474127702849948, 'recall': 0.3724012271658387, 'f1-score': 0.3594732596070492, 'support': 192639}, 'accuracy': 0.3502229147729732, 'macro avg': {'precision': 0.3514437195069417, 'recall': 0.3488086361028193, 'f1-score': 0.3468057821420804, 'support': 577575}, 'weighted avg': {'precision': 0.3513131976851593, 'recall': 0.3502229147729732, 'f1-score': 0.34749393412769297, 'support': 577575}}
[[80867 45444 71880]
 [74195 49674 62876]
 [78029 42871 71739]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.154268
{'0': {'precision': 0.36630265210608426, 'recall': 0.4329706804351835, 'f1-score': 0.39685624947181614, 'support': 59653}, '1': {'precision': 0.29296614316857233, 'recall': 0.1406270020928544, 'f1-score': 0.19003506341716808, 'support': 46826}, '2': {'precision': 0.3635148775251987, 'recall': 0.4497880349698324, 'f1-score': 0.40207563487695575, 'support': 56849}, 'accuracy': 0.3550095513322884, 'macro avg': {'precision': 0.34092789093328507, 'recall': 0.3411285724992901, 'f1-score': 0.3296556492553133, 'support': 163328}, 'weighted avg': {'precision': 0.3443068059274945, 'recall': 0.3550095513322884, 'f1-score': 0.3393774827123005, 'support': 163328}}
[[25828  7949 25876]
 [21346  6585 18895]
 [23336  7943 25570]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/WBA
Evaluating performance on  test set...
5696/5696 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.173112
{'0': {'precision': 0.38316214034084123, 'recall': 0.37880965377766246, 'f1-score': 0.38097346606152405, 'support': 558745}, '1': {'precision': 0.23433206194568265, 'recall': 0.5980338404613702, 'f1-score': 0.33672331493482105, 'support': 341071}, '2': {'precision': 0.3819132609560621, 'recall': 0.02407346365512497, 'f1-score': 0.04529199823388844, 'support': 558208}, 'accuracy': 0.2942804782362979, 'macro avg': {'precision': 0.333135821080862, 'recall': 0.33363898596471925, 'f1-score': 0.25432959307674446, 'support': 1458024}, 'weighted avg': {'precision': 0.3478686485108481, 'recall': 0.2942804782362979, 'f1-score': 0.2421057079943972, 'support': 1458024}}
[[211658 333657  13430]
 [128781 203972   8318]
 [211959 332811  13438]]
Evaluating performance on  train set...
2222/2222 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1286877
{'0': {'precision': 0.34647664394514266, 'recall': 0.5545472078731045, 'f1-score': 0.42648739010691644, 'support': 191843}, '1': {'precision': 0.39161857807160066, 'recall': 0.32929931638069115, 'f1-score': 0.3577653739304999, 'support': 191042}, '2': {'precision': 0.359041683593092, 'recall': 0.19510159690740522, 'f1-score': 0.2528212766996557, 'support': 185734}, 'accuracy': 0.3614599582497243, 'macro avg': {'precision': 0.36571230186994513, 'recall': 0.3596493737204003, 'f1-score': 0.3456913469123573, 'support': 568619}, 'weighted avg': {'precision': 0.3657474745951192, 'recall': 0.3614599582497243, 'f1-score': 0.34667209494098083, 'support': 568619}}
[[106386  47996  37461]
 [100903  62910  27229]
 [ 99762  49735  36237]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1721479
{'0': {'precision': 0.37796219964432926, 'recall': 0.42697626611848255, 'f1-score': 0.4009769581209644, 'support': 64212}, '1': {'precision': 0.2573088455772114, 'recall': 0.24146421124035877, 'f1-score': 0.2491348584019182, 'support': 39803}, '2': {'precision': 0.34937727036844834, 'recall': 0.31506551678031824, 'f1-score': 0.33133546595423063, 'support': 59832}, 'accuracy': 0.3410437786471525, 'macro avg': {'precision': 0.328216105196663, 'recall': 0.3278353313797198, 'f1-score': 0.32714909415903776, 'support': 163847}, 'weighted avg': {'precision': 0.33821378227710247, 'recall': 0.3410437786471525, 'f1-score': 0.3386593029033698, 'support': 163847}}
[[27417 13997 22798]
 [17885  9611 12307]
 [27237 13744 18851]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 63s - 63s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974742
{'0': {'precision': 0.2510330765357167, 'recall': 0.34019631746719764, 'f1-score': 0.28889134764328395, 'support': 775173}, '1': {'precision': 0.4844839487985317, 'recall': 0.6363489977369655, 'f1-score': 0.5501281456626579, 'support': 1496663}, '2': {'precision': 0.26508216609683466, 'recall': 0.023534710883396204, 'f1-score': 0.04323123584945961, 'support': 817006}, 'accuracy': 0.39993596305670537, 'macro avg': {'precision': 0.3335330638103611, 'recall': 0.3333600086958531, 'f1-score': 0.2940835763851338, 'support': 3088842}, 'weighted avg': {'precision': 0.36786503922576436, 'recall': 0.39993596305670537, 'f1-score': 0.35049296551103015, 'support': 3088842}}
[[263711 493330  18132]
 [509087 952400  35176]
 [277705 520073  19228]]
Evaluating performance on  train set...
2948/2948 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1364155
{'0': {'precision': 0.3348377614340867, 'recall': 0.46059493877032215, 'f1-score': 0.38777530314278646, 'support': 251757}, '1': {'precision': 0.3660243267104946, 'recall': 0.4014950817572813, 'f1-score': 0.3829400673297862, 'support': 249886}, '2': {'precision': 0.3631935794255197, 'recall': 0.19258500468677697, 'f1-score': 0.251703247283592, 'support': 252839}, 'accuracy': 0.35120652315098305, 'macro avg': {'precision': 0.354685222523367, 'recall': 0.3515583417381268, 'f1-score': 0.34080620591872157, 'support': 754482}, 'weighted avg': {'precision': 0.35466930508363226, 'recall': 0.35120652315098305, 'f1-score': 0.34057393814302467, 'support': 754482}}
[[115958  86388  49411]
 [113593 100328  35965]
 [116760  87386  48693]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198231
{'0': {'precision': 0.3435163377769648, 'recall': 0.5077224644293488, 'f1-score': 0.40978151168817, 'support': 59178}, '1': {'precision': 0.38539640366276035, 'recall': 0.5165495532733458, 'f1-score': 0.44143740235038387, 'support': 62902}, '2': {'precision': 0.3720193178388168, 'recall': 0.043767755681818184, 'f1-score': 0.07832110062593335, 'support': 56320}, 'accuracy': 0.3643665919282511, 'macro avg': {'precision': 0.3669773530928473, 'recall': 0.3560132577948376, 'f1-score': 0.3098466715548291, 'support': 178400}, 'weighted avg': {'precision': 0.36728106726929555, 'recall': 0.3643665919282511, 'f1-score': 0.31630263547409715, 'support': 178400}}
[[30046 27011  2121]
 [28370 32492  2040]
 [29050 24805  2465]]
testing model on single stock: results/universal/W1/deepLOB_L1/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 126s - 126s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1790946
{'0': {'precision': 0.37728847443417657, 'recall': 0.33530675455992415, 'f1-score': 0.3550609623754188, 'support': 2058861}, '1': {'precision': 0.23991714084631452, 'recall': 0.6433277380009154, 'f1-score': 0.34949617082354534, 'support': 1308829}, '2': {'precision': 0.3824243379571248, 'recall': 0.023121932669915614, 'f1-score': 0.04360730419199724, 'support': 2098527}, 'accuracy': 0.2892087891863788, 'macro avg': {'precision': 0.33320998441253863, 'recall': 0.33391880841025173, 'f1-score': 0.24938814579698712, 'support': 5466217}, 'weighted avg': {'precision': 0.3463680340460167, 'recall': 0.2892087891863788, 'f1-score': 0.2341588336255488, 'support': 5466217}}
[[ 690350 1320676   47835]
 [ 436300  842006   30523]
 [ 703117 1346888   48522]]
Evaluating performance on  train set...
6073/6073 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1415374
{'0': {'precision': 0.33534897863473245, 'recall': 0.3785726752642296, 'f1-score': 0.355652358478105, 'support': 515650}, '1': {'precision': 0.34157653674353217, 'recall': 0.5866726121049383, 'f1-score': 0.43176683607775473, 'support': 513559}, '2': {'precision': 0.3695688253062037, 'recall': 0.06358107529337864, 'f1-score': 0.10849631167110045, 'support': 525345}, 'accuracy': 0.34087204432911306, 'macro avg': {'precision': 0.34883144689482276, 'recall': 0.3429421208875156, 'f1-score': 0.2986385020756534, 'support': 1554554}, 'weighted avg': {'precision': 0.34897053431206576, 'recall': 0.34087204432911306, 'f1-score': 0.2972736090694468, 'support': 1554554}}
[[195211 287759  32680]
 [187969 301291  24299]
 [198933 293010  33402]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1548121
{'0': {'precision': 0.34518973459091906, 'recall': 0.2514122488625326, 'f1-score': 0.29093073729123764, 'support': 156488}, '1': {'precision': 0.3123530606258884, 'recall': 0.486734500144152, 'f1-score': 0.38051652483673065, 'support': 142211}, '2': {'precision': 0.35665594961065017, 'recall': 0.27366335634156497, 'f1-score': 0.30969593762383657, 'support': 158494}, 'accuracy': 0.33232354826080013, 'macro avg': {'precision': 0.3380662482758192, 'recall': 0.33727003511608317, 'f1-score': 0.32704773325060166, 'support': 457193}, 'weighted avg': {'precision': 0.33895077214419805, 'recall': 0.33232354826080013, 'f1-score': 0.32530190241001034, 'support': 457193}}
[[39343 76450 40695]
 [35448 69219 37544]
 [39184 75936 43374]]
training model: results/universal/W1/deepLOB_L1/h1000
Epoch 1/50
10622/10622 - 160s - loss: 3.1696 - accuracy1000: 0.4377 - val_loss: 3.3745 - val_accuracy1000: 0.3309 - 160s/epoch - 15ms/step
Epoch 2/50
10622/10622 - 157s - loss: 3.1291 - accuracy1000: 0.4541 - val_loss: 3.7084 - val_accuracy1000: 0.3418 - 157s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 156s - loss: 3.1104 - accuracy1000: 0.4610 - val_loss: 3.5380 - val_accuracy1000: 0.3430 - 156s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 156s - loss: 3.1026 - accuracy1000: 0.4628 - val_loss: 3.7213 - val_accuracy1000: 0.3433 - 156s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 157s - loss: 3.0887 - accuracy1000: 0.4677 - val_loss: 3.7433 - val_accuracy1000: 0.3444 - 157s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 158s - loss: 3.0813 - accuracy1000: 0.4703 - val_loss: 3.7010 - val_accuracy1000: 0.3415 - 158s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 154s - loss: 3.0724 - accuracy1000: 0.4724 - val_loss: 3.7325 - val_accuracy1000: 0.3432 - 154s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 157s - loss: 3.0653 - accuracy1000: 0.4747 - val_loss: 3.6846 - val_accuracy1000: 0.3417 - 157s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 157s - loss: 3.0608 - accuracy1000: 0.4759 - val_loss: 3.6840 - val_accuracy1000: 0.3376 - 157s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 154s - loss: 3.0565 - accuracy1000: 0.4769 - val_loss: 3.6598 - val_accuracy1000: 0.3422 - 154s/epoch - 14ms/step
Epoch 11/50
10622/10622 - 155s - loss: 3.0512 - accuracy1000: 0.4784 - val_loss: 3.6389 - val_accuracy1000: 0.3445 - 155s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 175s - 175s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1278615
{'0': {'precision': 0.3524674455475867, 'recall': 0.6421867765584645, 'f1-score': 0.4551329048173831, 'support': 3190047}, '1': {'precision': 0.29029997095756643, 'recall': 0.306717600562354, 'f1-score': 0.29828304821495477, 'support': 2633217}, '2': {'precision': 0.35088184590903065, 'recall': 0.0492505545961135, 'f1-score': 0.08637703663543052, 'support': 3223517}, 'accuracy': 0.3332699221966355, 'macro avg': {'precision': 0.3312164208047279, 'recall': 0.33271831057231066, 'f1-score': 0.2799309965559228, 'support': 9046781}, 'weighted avg': {'precision': 0.33380758649632986, 'recall': 0.3332699221966355, 'f1-score': 0.27808534295119447, 'support': 9046781}}
[[2048606  982218  159223]
 [1691086  807654  134477]
 [2072493  992264  158760]]
Evaluating performance on  train set...
10622/10622 - 74s - 74s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1275306
{'0': {'precision': 0.32891600975723495, 'recall': 0.6523829164197722, 'f1-score': 0.43733704374577764, 'support': 899507}, '1': {'precision': 0.33146747372121593, 'recall': 0.28207446462063934, 'f1-score': 0.30478278450452734, 'support': 905853}, '2': {'precision': 0.34484171390483875, 'recall': 0.06175628645332551, 'f1-score': 0.10475282045757031, 'support': 913154}, 'accuracy': 0.330597524971363, 'macro avg': {'precision': 0.33507506579442986, 'recall': 0.3320712224979124, 'f1-score': 0.2822908829026251, 'support': 2718514}, 'weighted avg': {'precision': 0.33511567315104684, 'recall': 0.330597524971363, 'f1-score': 0.28145214220435316, 'support': 2718514}}
[[586823 256670  56014]
 [599209 255518  51126]
 [598080 258681  56393]]
Evaluating performance on  val set...
3064/3064 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1251652
{'0': {'precision': 0.34512500884985997, 'recall': 0.5203169742430823, 'f1-score': 0.41498888163157466, 'support': 271694}, '1': {'precision': 0.3083872427217765, 'recall': 0.34446079170555366, 'f1-score': 0.32542738333590016, 'support': 245369}, '2': {'precision': 0.3392742966751918, 'recall': 0.12732692199538834, 'f1-score': 0.18516347655877277, 'support': 266715}, 'accuracy': 0.3315313775074064, 'macro avg': {'precision': 0.33092884941560946, 'recall': 0.3307015626480081, 'f1-score': 0.3085265805087492, 'support': 783778}, 'weighted avg': {'precision': 0.33163294651237624, 'recall': 0.3315313775074064, 'f1-score': 0.3087425999174876, 'support': 783778}}
[[141367  95665  34662]
 [129375  84520  31474]
 [138869  93886  33960]]
testing model out of sample: results/universal/W1/deepLOB_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 120s - 120s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.130897
{'0': {'precision': 0.34784682857313415, 'recall': 0.6472814901580405, 'f1-score': 0.45251413171046617, 'support': 2115534}, '1': {'precision': 0.3136815067040183, 'recall': 0.28007909720091373, 'f1-score': 0.29592947941810743, 'support': 1847853}, '2': {'precision': 0.36557528942466183, 'recall': 0.08774848312747066, 'f1-score': 0.14152656030061198, 'support': 2135809}, 'accuracy': 0.3400948256130808, 'macro avg': {'precision': 0.3423678749006047, 'recall': 0.33836969016214163, 'f1-score': 0.2966567238097285, 'support': 6099196}, 'weighted avg': {'precision': 0.34370400609801266, 'recall': 0.3400948256130808, 'f1-score': 0.2961729560214571, 'support': 6099196}}
[[1369346  562392  183796]
 [1188863  517545  141445]
 [1378426  569969  187414]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1273922
{'0': {'precision': 0.3331104633987829, 'recall': 0.581849985982088, 'f1-score': 0.42366928229569195, 'support': 581399}, '1': {'precision': 0.3207339653613496, 'recall': 0.27658482349012836, 'f1-score': 0.29702781446848286, 'support': 563028}, '2': {'precision': 0.35397366461465885, 'recall': 0.13360018573765256, 'f1-score': 0.19398475658440023, 'support': 572851}, 'accuracy': 0.3322379952459648, 'macro avg': {'precision': 0.3359393644582638, 'recall': 0.330678331736623, 'f1-score': 0.30489395111619166, 'support': 1717278}, 'weighted avg': {'precision': 0.3360122595801209, 'recall': 0.3322379952459648, 'f1-score': 0.3055301676118394, 'support': 1717278}}
[[338287 165738  77374]
 [344999 155725  62304]
 [332254 164064  76533]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1323715
{'0': {'precision': 0.3610662891209222, 'recall': 0.6512916168526737, 'f1-score': 0.46457768709062414, 'support': 159761}, '1': {'precision': 0.29206366104221004, 'recall': 0.2534528153725345, 'f1-score': 0.27139182906321097, 'support': 129894}, '2': {'precision': 0.3454330749088669, 'recall': 0.08958840996551219, 'f1-score': 0.14227711047200134, 'support': 150198}, 'accuracy': 0.3419983494485658, 'macro avg': {'precision': 0.33285434169066636, 'recall': 0.3314442807302401, 'f1-score': 0.29274887554194545, 'support': 439853}, 'weighted avg': {'precision': 0.33535064121155583, 'recall': 0.3419983494485658, 'f1-score': 0.2974705266311599, 'support': 439853}}
[[104051  40574  15136]
 [ 86610  32922  10362]
 [ 97516  39226  13456]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.119788
{'0': {'precision': 0.31813694696221845, 'recall': 0.4982781643123199, 'f1-score': 0.38833356155004795, 'support': 56916}, '1': {'precision': 0.3612069496642228, 'recall': 0.36411203925100144, 'f1-score': 0.3626536766411505, 'support': 64406}, '2': {'precision': 0.19801536491677338, 'recall': 0.0639498821486168, 'f1-score': 0.09667739818085207, 'support': 48366}, 'accuracy': 0.3235585309509217, 'macro avg': {'precision': 0.29245308718107155, 'recall': 0.30878002857064607, 'f1-score': 0.2825548787906835, 'support': 169688}, 'weighted avg': {'precision': 0.30024626616460925, 'recall': 0.3235585309509217, 'f1-score': 0.2954561591117083, 'support': 169688}}
[[28360 21269  7287]
 [35715 23451  5240]
 [25069 20204  3093]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1310117
{'0': {'precision': 0.3162794881597589, 'recall': 0.6591985001171784, 'f1-score': 0.42746421081426095, 'support': 21335}, '1': {'precision': 0.33307028619528617, 'recall': 0.2857465246434374, 'f1-score': 0.307598872801477, 'support': 22156}, '2': {'precision': 0.35236220472440943, 'recall': 0.046630774574505034, 'f1-score': 0.08236196319018403, 'support': 23032}, 'accuracy': 0.32273048419343686, 'macro avg': {'precision': 0.3339039930264849, 'recall': 0.33052526644504027, 'f1-score': 0.272475015601974, 'support': 66523}, 'weighted avg': {'precision': 0.33436457225386434, 'recall': 0.32273048419343686, 'f1-score': 0.26805872103946154, 'support': 66523}}
[[14064  6283   988]
 [14839  6331   986]
 [15564  6394  1074]]
Evaluating performance on  val set...
51/51 - 0s - 425ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0923249
{'0': {'precision': 0.35520665593129364, 'recall': 0.6241452487620844, 'f1-score': 0.4527495082528008, 'support': 4241}, '1': {'precision': 0.41830761043108033, 'recall': 0.2984054669703872, 'f1-score': 0.34832705517394186, 'support': 5268}, '2': {'precision': 0.39645693341478316, 'recall': 0.19442780107849011, 'f1-score': 0.26090452261306535, 'support': 3338}, 'accuracy': 0.3789211489063595, 'macro avg': {'precision': 0.38999039992571904, 'recall': 0.3723261722703206, 'f1-score': 0.3539936953466027, 'support': 12847}, 'weighted avg': {'precision': 0.3917995768112473, 'recall': 0.3789211489063595, 'f1-score': 0.3600838240553332, 'support': 12847}}
[[2647 1221  373]
 [3081 1572  615]
 [1724  965  649]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1310225
{'0': {'precision': 0.4221808265478568, 'recall': 0.6263155195696891, 'f1-score': 0.5043763952269187, 'support': 175501}, '1': {'precision': 0.20572678685165185, 'recall': 0.2612717169585707, 'f1-score': 0.23019598729568516, 'support': 85302}, '2': {'precision': 0.39411663512816103, 'recall': 0.1287022414750916, 'f1-score': 0.19403926144811878, 'support': 160207}, 'accuracy': 0.3629961283579963, 'macro avg': {'precision': 0.3406747495092233, 'recall': 0.33876315933445045, 'f1-score': 0.30953721465690753, 'support': 421010}, 'weighted avg': {'precision': 0.36764520409484885, 'recall': 0.3629961283579963, 'f1-score': 0.3307313075837504, 'support': 421010}}
[[109919  45252  20330]
 [ 51647  22287  11368]
 [ 98794  40794  20619]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1328537
{'0': {'precision': 0.3285422802062498, 'recall': 0.5466784854161092, 'f1-score': 0.41042672476033226, 'support': 59792}, '1': {'precision': 0.2667937627021097, 'recall': 0.27678471470687016, 'f1-score': 0.2716974220431339, 'support': 53594}, '2': {'precision': 0.31337730424488414, 'recall': 0.06922961966674139, 'f1-score': 0.11340616297928333, 'support': 53532}, 'accuracy': 0.3068991960124133, 'macro avg': {'precision': 0.3029044490510812, 'recall': 0.29756427326324025, 'f1-score': 0.26517676992758316, 'support': 166918}, 'weighted avg': {'precision': 0.3038525430881397, 'recall': 0.3068991960124133, 'f1-score': 0.27062656562178133, 'support': 166918}}
[[32687 22353  4752]
 [35392 14834  3368]
 [31412 18414  3706]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1256994
{'0': {'precision': 0.428635574447704, 'recall': 0.7181763466746915, 'f1-score': 0.5368551289742052, 'support': 19938}, '1': {'precision': 0.1945884793061186, 'recall': 0.22953736654804271, 'f1-score': 0.210622990968927, 'support': 8992}, '2': {'precision': 0.3689064558629776, 'recall': 0.04838709677419355, 'f1-score': 0.08555278301166165, 'support': 17360}, 'accuracy': 0.3720674011665587, 'macro avg': {'precision': 0.33071016987226676, 'recall': 0.33203360333230925, 'f1-score': 0.27767696765159794, 'support': 46290}, 'weighted avg': {'precision': 0.36077104694405343, 'recall': 0.3720674011665587, 'f1-score': 0.3042327891415585, 'support': 46290}}
[[14319  4633   986]
 [ 6477  2064   451]
 [12610  3910   840]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250528
{'0': {'precision': 0.35588121535089606, 'recall': 0.6954090073143491, 'f1-score': 0.47081766262710684, 'support': 119081}, '1': {'precision': 0.2917042977734427, 'recall': 0.24456088277755902, 'f1-score': 0.26606038639384055, 'support': 99051}, '2': {'precision': 0.4230469511007208, 'recall': 0.07352729550591283, 'f1-score': 0.12528035192730683, 'support': 118133}, 'accuracy': 0.3441333472112768, 'macro avg': {'precision': 0.35687748807501984, 'recall': 0.33783239519927366, 'f1-score': 0.28738613364941806, 'support': 336265}, 'weighted avg': {'precision': 0.3605730566022, 'recall': 0.3441333472112768, 'f1-score': 0.28911343502958486, 'support': 336265}}
[[82810 30280  5991]
 [68972 24224  5855]
 [80908 28539  8686]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1289912
{'0': {'precision': 0.3356618371772127, 'recall': 0.5858887789772483, 'f1-score': 0.42680347771598653, 'support': 46502}, '1': {'precision': 0.31436414384904615, 'recall': 0.30719293104614204, 'f1-score': 0.3107371685249789, 'support': 44363}, '2': {'precision': 0.31750710601115906, 'recall': 0.06989085347484532, 'f1-score': 0.11456354934285498, 'support': 43153}, 'accuracy': 0.32748586010834363, 'macro avg': {'precision': 0.32251102901247264, 'recall': 0.3209908544994119, 'f1-score': 0.2840347318612735, 'support': 134018}, 'weighted avg': {'precision': 0.32276610165566966, 'recall': 0.32748586010834363, 'f1-score': 0.287843492462316, 'support': 134018}}
[[27245 15437  3820]
 [28072 13628  2663]
 [25851 14286  3016]]
Evaluating performance on  val set...
107/107 - 1s - 718ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11991
{'0': {'precision': 0.3831719128329298, 'recall': 0.6613163643270966, 'f1-score': 0.485209574579283, 'support': 10529}, '1': {'precision': 0.2916452442159383, 'recall': 0.28845664886854816, 'f1-score': 0.2900421833056372, 'support': 7866}, '2': {'precision': 0.31773399014778325, 'recall': 0.0441025641025641, 'f1-score': 0.0774542179525668, 'support': 8775}, 'accuracy': 0.35403018034596984, 'macro avg': {'precision': 0.3308503823988838, 'recall': 0.33129185909940295, 'f1-score': 0.28423532527916234, 'support': 27170}, 'weighted avg': {'precision': 0.33553972487181766, 'recall': 0.35403018034596984, 'f1-score': 0.29701524428270837, 'support': 27170}}
[[6963 3068  498]
 [5264 2269  333]
 [5945 2443  387]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1283
{'0': {'precision': 0.33930459324194945, 'recall': 0.6592930887033495, 'f1-score': 0.4480306280181659, 'support': 113423}, '1': {'precision': 0.30234779957312735, 'recall': 0.2904624277456647, 'f1-score': 0.2962859675507704, 'support': 102416}, '2': {'precision': 0.35757251704317605, 'recall': 0.04537666875879968, 'f1-score': 0.08053347784200385, 'support': 117902}, 'accuracy': 0.32922835372339626, 'macro avg': {'precision': 0.33307496995275093, 'recall': 0.33171072840260457, 'f1-score': 0.2749500244703134, 'support': 333741}, 'weighted avg': {'precision': 0.33441714390736405, 'recall': 0.32922835372339626, 'f1-score': 0.27163716678176214, 'support': 333741}}
[[74779 33645  4999]
 [68055 29748  4613]
 [77555 34997  5350]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.123286
{'0': {'precision': 0.3312830370014416, 'recall': 0.5345677863589839, 'f1-score': 0.4090617805520614, 'support': 32241}, '1': {'precision': 0.3344216682755096, 'recall': 0.36264277577660786, 'f1-score': 0.34796094707767755, 'support': 32481}, '2': {'precision': 0.3415765069551777, 'recall': 0.11206896551724138, 'f1-score': 0.16876670484917908, 'support': 33524}, 'accuracy': 0.3335606538688598, 'macro avg': {'precision': 0.33576040407737634, 'recall': 0.3364265092176111, 'f1-score': 0.3085964774929727, 'support': 98246}, 'weighted avg': {'precision': 0.3358330865621571, 'recall': 0.3335606538688598, 'f1-score': 0.30686659408192635, 'support': 98246}}
[[17235 11436  3570]
 [17030 11779  3672]
 [17760 12007  3757]]
Evaluating performance on  val set...
93/93 - 1s - 618ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1203508
{'0': {'precision': 0.2828393706549579, 'recall': 0.5921556611000459, 'f1-score': 0.3828248811410459, 'support': 6527}, '1': {'precision': 0.3608191862031797, 'recall': 0.29938513135830075, 'f1-score': 0.3272438443208896, 'support': 8945}, '2': {'precision': 0.4640444974175606, 'recall': 0.14363010329562223, 'f1-score': 0.21936332049957744, 'support': 8132}, 'accuracy': 0.326681918318929, 'macro avg': {'precision': 0.36923435142523275, 'recall': 0.34505696525132296, 'f1-score': 0.309810681987171, 'support': 23604}, 'weighted avg': {'precision': 0.3748191004004387, 'recall': 0.326681918318929, 'f1-score': 0.30544639505848703, 'support': 23604}}
[[3865 2080  582]
 [5500 2678  767]
 [4300 2664 1168]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1306398
{'0': {'precision': 0.3531065939821109, 'recall': 0.5815459396988341, 'f1-score': 0.43940972417302465, 'support': 235352}, '1': {'precision': 0.28727091231297247, 'recall': 0.2566382765531062, 'f1-score': 0.2710919886959006, 'support': 199600}, '2': {'precision': 0.3418947576071411, 'recall': 0.14917799965570666, 'f1-score': 0.20772146399196992, 'support': 232360}, 'accuracy': 0.33381087107679763, 'macro avg': {'precision': 0.3274240879674082, 'recall': 0.3291207386358823, 'f1-score': 0.30607439228696504, 'support': 667312}, 'weighted avg': {'precision': 0.32951045849938615, 'recall': 0.33381087107679763, 'f1-score': 0.30838959545227057, 'support': 667312}}
[[136868  61570  36914]
 [118567  51225  29808]
 [132176  65521  34663]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1287029
{'0': {'precision': 0.3386625131889665, 'recall': 0.5356070117445131, 'f1-score': 0.41495216636501314, 'support': 62923}, '1': {'precision': 0.3141150980288538, 'recall': 0.2971306695104476, 'f1-score': 0.3053869141912779, 'support': 60014}, '2': {'precision': 0.30838850542329904, 'recall': 0.1418298430591322, 'f1-score': 0.1942999145763765, 'support': 61743}, 'accuracy': 0.32646198830409356, 'macro avg': {'precision': 0.3203887055470398, 'recall': 0.324855841438031, 'f1-score': 0.30487966504422254, 'support': 184680}, 'weighted avg': {'precision': 0.3205641991598642, 'recall': 0.32646198830409356, 'f1-score': 0.30557821668913954, 'support': 184680}}
[[33702 19098 10123]
 [32666 17832  9516]
 [33147 19839  8757]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1354896
{'0': {'precision': 0.340333568240545, 'recall': 0.7394477619558005, 'f1-score': 0.4661293695606712, 'support': 19593}, '1': {'precision': 0.3346492559975706, 'recall': 0.23541978209784234, 'f1-score': 0.27639829445698516, 'support': 18724}, '2': {'precision': 0.33474218089602703, 'recall': 0.04001819008640291, 'f1-score': 0.07148982262941733, 'support': 19791}, 'accuracy': 0.33881737454395267, 'macro avg': {'precision': 0.3365750017113809, 'recall': 0.33829524471334854, 'f1-score': 0.27133916221569127, 'support': 58108}, 'weighted avg': {'precision': 0.33659755582619916, 'recall': 0.33881737454395267, 'f1-score': 0.270582527068108, 'support': 58108}}
[[14488  4334   771]
 [13513  4408   803]
 [14569  4430   792]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204624
{'0': {'precision': 0.2500876513138471, 'recall': 0.6183070720204388, 'f1-score': 0.3561305919469723, 'support': 350706}, '1': {'precision': 0.47275423738982064, 'recall': 0.29593265353947473, 'f1-score': 0.3640062490819005, 'support': 665692}, '2': {'precision': 0.23172241399833354, 'recall': 0.05539982526587192, 'f1-score': 0.08942101648824878, 'support': 351391}, 'accuracy': 0.316796669661768, 'macro avg': {'precision': 0.31818810090066707, 'recall': 0.32321318360859513, 'f1-score': 0.26985261917237385, 'support': 1367789}, 'weighted avg': {'precision': 0.3537395931795525, 'recall': 0.316796669661768, 'f1-score': 0.29144475043153995, 'support': 1367789}}
[[216844 110568  23294]
 [427443 197000  41249]
 [222785 109139  19467]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127108
{'0': {'precision': 0.32535485291408495, 'recall': 0.681717615824209, 'f1-score': 0.4404849531897292, 'support': 106217}, '1': {'precision': 0.3512811951358745, 'recall': 0.2978692312610169, 'f1-score': 0.32237785048484185, 'support': 109491}, '2': {'precision': 0.34729647425052446, 'recall': 0.044833098917610885, 'f1-score': 0.07941444996363524, 'support': 114469}, 'accuracy': 0.33362711515338744, 'macro avg': {'precision': 0.341310840766828, 'recall': 0.3414733153342789, 'f1-score': 0.28075908454606874, 'support': 330177}, 'weighted avg': {'precision': 0.3415593026152054, 'recall': 0.33362711515338744, 'f1-score': 0.2761396347210031, 'support': 330177}}
[[72410 29036  4771]
 [72003 32614  4874]
 [78144 31193  5132]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.120173
{'0': {'precision': 0.316928803782823, 'recall': 0.6519159797192425, 'f1-score': 0.42650991188184717, 'support': 28993}, '1': {'precision': 0.4070668900229849, 'recall': 0.2970153496304719, 'f1-score': 0.343440319479367, 'support': 35180}, '2': {'precision': 0.3636725487594534, 'recall': 0.09560182763070699, 'f1-score': 0.15140300486080427, 'support': 28671}, 'accuracy': 0.3456443065787773, 'macro avg': {'precision': 0.3625560808550871, 'recall': 0.3481777189934738, 'f1-score': 0.30711774540733944, 'support': 92844}, 'weighted avg': {'precision': 0.36551834953864853, 'recall': 0.3456443065787773, 'f1-score': 0.3100782804148749, 'support': 92844}}
[[18901  7721  2371]
 [22306 10449  2425]
 [18431  7499  2741]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1382753
{'0': {'precision': 0.4048830736045363, 'recall': 0.6766047001052262, 'f1-score': 0.50660913096443, 'support': 741260}, '1': {'precision': 0.22470047788921046, 'recall': 0.19824079572446557, 'f1-score': 0.21064296305644065, 'support': 404160}, '2': {'precision': 0.3966822860876866, 'recall': 0.13867182134807257, 'f1-score': 0.20550381268867934, 'support': 691669}, 'accuracy': 0.36883134132314765, 'macro avg': {'precision': 0.34208861252714445, 'recall': 0.3378391057259215, 'f1-score': 0.30758530223651664, 'support': 1837089}, 'weighted avg': {'precision': 0.36215524257114706, 'recall': 0.36883134132314765, 'f1-score': 0.3281295359049837, 'support': 1837089}}
[[501540 147826  91894]
 [270055  80121  53984]
 [467133 128621  95915]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1231735
{'0': {'precision': 0.3348753583750425, 'recall': 0.5213017035311205, 'f1-score': 0.40779203872349734, 'support': 198294}, '1': {'precision': 0.3093411472207423, 'recall': 0.2791670450720929, 'f1-score': 0.29348055004085705, 'support': 187189}, '2': {'precision': 0.38375350140056025, 'recall': 0.19969597901005767, 'f1-score': 0.2626929450919699, 'support': 192092}, 'accuracy': 0.33586633770505997, 'macro avg': {'precision': 0.3426566689987817, 'recall': 0.333388242537757, 'f1-score': 0.3213218446187747, 'support': 577575}, 'weighted avg': {'precision': 0.34285592678312016, 'recall': 0.33586633770505997, 'f1-score': 0.32248670461297985, 'support': 577575}}
[[103371  59050  35873]
 [109205  52257  25727]
 [ 96109  57623  38360]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1395382
{'0': {'precision': 0.40985609410645363, 'recall': 0.5689072981855837, 'f1-score': 0.4764586108946482, 'support': 66633}, '1': {'precision': 0.204849647541715, 'recall': 0.2647771178132749, 'f1-score': 0.2309898126021884, 'support': 34682}, '2': {'precision': 0.3642969741243416, 'recall': 0.1527905439182107, 'f1-score': 0.21528708731907933, 'support': 62013}, 'accuracy': 0.3463337578369906, 'macro avg': {'precision': 0.3263342385908367, 'recall': 0.3288249866390231, 'f1-score': 0.3075785036053053, 'support': 163328}, 'weighted avg': {'precision': 0.3490257938076134, 'recall': 0.3463337578369906, 'f1-score': 0.32517176140239434, 'support': 163328}}
[[37908 17881 10844]
 [19809  9183  5690]
 [34774 17764  9475]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250672
{'0': {'precision': 0.34839923331406797, 'recall': 0.6782423336418069, 'f1-score': 0.46033419383672, 'support': 505716}, '1': {'precision': 0.30847266071275015, 'recall': 0.2840199340808991, 'f1-score': 0.2957417038837696, 'support': 442057}, '2': {'precision': 0.3524627134953091, 'recall': 0.04594405498470361, 'f1-score': 0.08129162238215698, 'support': 510251}, 'accuracy': 0.3374388898948166, 'macro avg': {'precision': 0.3364448691740424, 'recall': 0.3360687742358032, 'f1-score': 0.2791225067008822, 'support': 1458024}, 'weighted avg': {'precision': 0.33771598936303404, 'recall': 0.3374388898948166, 'f1-score': 0.2777815654448735, 'support': 1458024}}
[[342998 139534  23184]
 [296619 125553  19885]
 [344880 141928  23443]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1291332
{'0': {'precision': 0.3316983291830669, 'recall': 0.6959356615807575, 'f1-score': 0.4492663696218714, 'support': 189871}, '1': {'precision': 0.32873334547543326, 'recall': 0.2381865984509344, 'f1-score': 0.27622904501789414, 'support': 197022}, '2': {'precision': 0.30272393352002036, 'recall': 0.04580522324818683, 'f1-score': 0.0795706017024897, 'support': 181726}, 'accuracy': 0.32955282887135323, 'macro avg': {'precision': 0.3210518693928402, 'recall': 0.32664249442662624, 'f1-score': 0.26835533878075174, 'support': 568619}, 'weighted avg': {'precision': 0.32141100490036056, 'recall': 0.32955282887135323, 'f1-score': 0.27115854542140966, 'support': 568619}}
[[132138  48987   8746]
 [139667  46928  10427]
 [126563  46839   8324]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1375132
{'0': {'precision': 0.3280320433527714, 'recall': 0.4771492708672481, 'f1-score': 0.3887826196227364, 'support': 58357}, '1': {'precision': 0.29843219492710205, 'recall': 0.34540481189682737, 'f1-score': 0.3202050054912185, 'support': 51913}, '2': {'precision': 0.30299819896175445, 'recall': 0.10676223006140695, 'f1-score': 0.15789110482368368, 'support': 53577}, 'accuracy': 0.3142932125702637, 'macro avg': {'precision': 0.309820812413876, 'recall': 0.30977210427516083, 'f1-score': 0.2889595766458795, 'support': 163847}, 'weighted avg': {'precision': 0.31046775952542466, 'recall': 0.3142932125702637, 'f1-score': 0.291554447176501, 'support': 163847}}
[[27845 22509  8003]
 [28827 17931  5155]
 [28213 19644  5720]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1277488
{'0': {'precision': 0.3121485238757291, 'recall': 0.6444582911441701, 'f1-score': 0.4205838827856206, 'support': 962925}, '1': {'precision': 0.350521084982427, 'recall': 0.3135125981366529, 'f1-score': 0.3309855474148059, 'support': 1080636}, '2': {'precision': 0.3387160446010264, 'recall': 0.043505047924912055, 'f1-score': 0.07710646032599204, 'support': 1045281}, 'accuracy': 0.3253105856498973, 'macro avg': {'precision': 0.3337952178197275, 'recall': 0.33382531240191166, 'f1-score': 0.27622529684213953, 'support': 3088842}, 'weighted avg': {'precision': 0.33456381594160917, 'recall': 0.3253105856498973, 'f1-score': 0.2730031355775087, 'support': 3088842}}
[[620565 300616  41744]
 [694805 338793  47038]
 [672674 327132  45475]]
Evaluating performance on  train set...
2948/2948 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1293023
{'0': {'precision': 0.3321635797785091, 'recall': 0.6331609502863144, 'f1-score': 0.43573534344753856, 'support': 252345}, '1': {'precision': 0.3300295880281513, 'recall': 0.2635235413507898, 'f1-score': 0.293050652024096, 'support': 249306}, '2': {'precision': 0.3368995457111368, 'recall': 0.09914132365097635, 'f1-score': 0.15319970785342554, 'support': 252831}, 'accuracy': 0.33206756423612493, 'macro avg': {'precision': 0.33303090450593237, 'recall': 0.3319419384293602, 'f1-score': 0.2939952344416867, 'support': 754482}, 'weighted avg': {'precision': 0.33304548558328306, 'recall': 0.33206756423612493, 'f1-score': 0.2939083456359169, 'support': 754482}}
[[159775  66384  26186]
 [160458  65698  23150]
 [160780  66985  25066]]
Evaluating performance on  val set...
697/697 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1282628
{'0': {'precision': 0.33037867635543583, 'recall': 0.717978388496554, 'f1-score': 0.45252663924535996, 'support': 58765}, '1': {'precision': 0.3632298424467099, 'recall': 0.24745083183382266, 'f1-score': 0.2943650599921137, 'support': 63354}, '2': {'precision': 0.3090812533191715, 'recall': 0.041363870577992574, 'f1-score': 0.07296318931879084, 'support': 56281}, 'accuracy': 0.33742713004484304, 'macro avg': {'precision': 0.3342299240404391, 'recall': 0.33559769696945646, 'f1-score': 0.2732849628520882, 'support': 178400}, 'weighted avg': {'precision': 0.33532605589939646, 'recall': 0.33742713004484304, 'f1-score': 0.27661644183881623, 'support': 178400}}
[[42192 14141  2432]
 [44905 15677  2772]
 [40611 13342  2328]]
testing model on single stock: results/universal/W1/deepLOB_L1/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 104s - 104s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.13021
{'0': {'precision': 0.3745292344744419, 'recall': 0.6370393519639301, 'f1-score': 0.4717225584499326, 'support': 2044701}, '1': {'precision': 0.2466564047207994, 'recall': 0.32317548121846384, 'f1-score': 0.2797783144755677, 'support': 1337750}, '2': {'precision': 0.38400454975659654, 'recall': 0.043420422446666274, 'f1-score': 0.07801902488722215, 'support': 2083766}, 'accuracy': 0.3339349681873222, 'macro avg': {'precision': 0.33506339631727927, 'recall': 0.33454508520968673, 'f1-score': 0.27650663260424085, 'support': 5466217}, 'weighted avg': {'precision': 0.3468469199635652, 'recall': 0.3339349681873222, 'f1-score': 0.27466498651406884, 'support': 5466217}}
[[1302555  654464   87682]
 [ 847965  432328   57457]
 [1327326  665962   90478]]
Evaluating performance on  train set...
6073/6073 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1267924
{'0': {'precision': 0.3284234338448883, 'recall': 0.6495602147888287, 'f1-score': 0.4362665910171446, 'support': 511386}, '1': {'precision': 0.3340436399802884, 'recall': 0.2892307092827292, 'f1-score': 0.31002616756850454, 'support': 513265}, '2': {'precision': 0.3557369908528247, 'recall': 0.06627250647760062, 'f1-score': 0.11173010171454388, 'support': 529903}, 'accuracy': 0.3317646090132604, 'macro avg': {'precision': 0.33940135489266715, 'recall': 0.3350211435163862, 'f1-score': 0.28600762010006436, 'support': 1554554}, 'weighted avg': {'precision': 0.33958946017865516, 'recall': 0.3317646090132604, 'f1-score': 0.283960752665899, 'support': 1554554}}
[[332176 144960  34250]
 [335462 148452  29351]
 [343788 150997  35118]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1227944
{'0': {'precision': 0.35052328157619445, 'recall': 0.48601777310471944, 'f1-score': 0.40729751105402007, 'support': 157879}, '1': {'precision': 0.3018182247236086, 'recall': 0.36454584969253023, 'f1-score': 0.3302296309445045, 'support': 140339}, '2': {'precision': 0.3396336144227973, 'recall': 0.14694134297845574, 'f1-score': 0.2051327083927905, 'support': 158975}, 'accuracy': 0.3308274623627221, 'macro avg': {'precision': 0.33065837357420014, 'recall': 0.3325016552585685, 'f1-score': 0.31421995013043835, 'support': 457193}, 'weighted avg': {'precision': 0.33178632845279504, 'recall': 0.3308274623627221, 'f1-score': 0.31334423808230294, 'support': 457193}}
[[76732 58317 22830]
 [66589 51160 22590]
 [75586 60029 23360]]
training model: results/universal/W1/deepOF_L1/h300
Epoch 1/50
10622/10622 - 146s - loss: 3.2688 - accuracy300: 0.3796 - val_loss: 3.2901 - val_accuracy300: 0.3561 - 146s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 139s - loss: 3.2679 - accuracy300: 0.3800 - val_loss: 3.2902 - val_accuracy300: 0.3570 - 139s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 142s - loss: 3.2677 - accuracy300: 0.3812 - val_loss: 3.2907 - val_accuracy300: 0.3572 - 142s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 143s - loss: 3.2663 - accuracy300: 0.3822 - val_loss: 3.2902 - val_accuracy300: 0.3581 - 143s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 138s - loss: 3.2651 - accuracy300: 0.3831 - val_loss: 3.2906 - val_accuracy300: 0.3582 - 138s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 138s - loss: 3.2641 - accuracy300: 0.3841 - val_loss: 3.2907 - val_accuracy300: 0.3587 - 138s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 140s - loss: 3.2628 - accuracy300: 0.3847 - val_loss: 3.2925 - val_accuracy300: 0.3566 - 140s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 143s - loss: 3.2616 - accuracy300: 0.3858 - val_loss: 3.2924 - val_accuracy300: 0.3569 - 143s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 140s - loss: 3.2606 - accuracy300: 0.3866 - val_loss: 3.2934 - val_accuracy300: 0.3564 - 140s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 141s - loss: 3.2599 - accuracy300: 0.3869 - val_loss: 3.2941 - val_accuracy300: 0.3557 - 141s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 144s - loss: 3.2590 - accuracy300: 0.3878 - val_loss: 3.2950 - val_accuracy300: 0.3559 - 144s/epoch - 14ms/step
testing model in sample: results/universal/W1/deepOF_L1/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 221s - 221s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09539
{'0': {'precision': 0.37369410232739486, 'recall': 0.5071241874342427, 'f1-score': 0.43030286767326975, 'support': 3114671}, '1': {'precision': 0.3339925757567913, 'recall': 0.022960780775458007, 'f1-score': 0.042967688479429646, 'support': 2809617}, '2': {'precision': 0.37047353700242003, 'recall': 0.5489612703797124, 'f1-score': 0.4423927001284118, 'support': 3122468}, 'accuracy': 0.37119935587961034, 'macro avg': {'precision': 0.3593867383622021, 'recall': 0.35968207952980435, 'f1-score': 0.3052210854270371, 'support': 9046756}, 'weighted avg': {'precision': 0.3602525774152757, 'recall': 0.37119935587961034, 'f1-score': 0.3141824164093563, 'support': 9046756}}
[[1579525   59601 1475545]
 [1307946   64511 1437160]
 [1339315   69039 1714114]]
Evaluating performance on  train set...
10622/10622 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952579
{'0': {'precision': 0.3665930888988729, 'recall': 0.5145653215820766, 'f1-score': 0.4281547754303449, 'support': 911789}, '1': {'precision': 0.34735187323492994, 'recall': 0.027968017348952767, 'f1-score': 0.051767803735168955, 'support': 892734}, '2': {'precision': 0.36402486089822617, 'recall': 0.5443736679256183, 'f1-score': 0.43629649863008174, 'support': 913988}, 'accuracy': 0.36479307974107883, 'macro avg': {'precision': 0.3593232743440096, 'recall': 0.3623023356188826, 'f1-score': 0.30540635926519855, 'support': 2718511}, 'weighted avg': {'precision': 0.3594109892132768, 'recall': 0.36479307974107883, 'f1-score': 0.3072900779965511, 'support': 2718511}}
[[469175  22063 420551]
 [419063  24968 448703]
 [391587  24850 497551]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962912
{'0': {'precision': 0.35804564612844353, 'recall': 0.5092214578980097, 'f1-score': 0.4204576077406474, 'support': 258907}, '1': {'precision': 0.3510600391947265, 'recall': 0.029558349802556824, 'f1-score': 0.05452577037885102, 'support': 266659}, '2': {'precision': 0.3538081912999237, 'recall': 0.5386390922117656, 'f1-score': 0.4270838771092107, 'support': 258210}, 'accuracy': 0.3557202568080676, 'macro avg': {'precision': 0.3543046255410312, 'recall': 0.35913963330411064, 'f1-score': 0.3006890850762364, 'support': 783776}, 'weighted avg': {'precision': 0.35427297616839093, 'recall': 0.3557202568080676, 'f1-score': 0.2981419859234413, 'support': 783776}}
[[131841   6641 120425]
 [125184   7882 133593]
 [111199   7929 139082]]
testing model out of sample: results/universal/W1/deepOF_L1/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 150s - 150s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958732
{'0': {'precision': 0.35924499309437, 'recall': 0.5464667456969396, 'f1-score': 0.4335053502700248, 'support': 2029602}, '1': {'precision': 0.3974439034467863, 'recall': 0.0411783964223325, 'f1-score': 0.07462503669628523, 'support': 2055641}, '2': {'precision': 0.36118068323678193, 'recall': 0.5019504172939648, 'f1-score': 0.4200863450702733, 'support': 2013928}, 'accuracy': 0.36146715676605884, 'macro avg': {'precision': 0.37262319325931276, 'recall': 0.3631985198044123, 'f1-score': 0.3094055773455278, 'support': 6099171}, 'weighted avg': {'precision': 0.3727585651606195, 'recall': 0.36146715676605884, 'f1-score': 0.3081188023311392, 'support': 6099171}}
[[1109110   57228  863264]
 [1046295   84648  924698]
 [ 931931   71105 1010892]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939882
{'0': {'precision': 0.3729161546272229, 'recall': 0.5167439260374113, 'f1-score': 0.4332040113138141, 'support': 581375}, '1': {'precision': 0.36131067110565973, 'recall': 0.025810350962836598, 'f1-score': 0.04817901739371343, 'support': 559233}, '2': {'precision': 0.37010954167780363, 'recall': 0.5594798375489451, 'f1-score': 0.4455060070188327, 'support': 576666}, 'accuracy': 0.37122148241922953, 'macro avg': {'precision': 0.3681121224702288, 'recall': 0.367344704849731, 'f1-score': 0.3089630119087867, 'support': 1717274}, 'weighted avg': {'precision': 0.36819434108476884, 'recall': 0.37122148241922953, 'f1-score': 0.31195106055016814, 'support': 1717274}}
[[300422  11690 269263]
 [264972  14434 279827]
 [240208  13825 322633]]
Evaluating performance on  val set...
1720/1720 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933437
{'0': {'precision': 0.38751113786875374, 'recall': 0.5193655834850304, 'f1-score': 0.44385293720123903, 'support': 154914}, '1': {'precision': 0.34484585231486387, 'recall': 0.023941217140587535, 'f1-score': 0.04477396369938857, 'support': 135958}, '2': {'precision': 0.37186640154048484, 'recall': 0.5560985105283295, 'f1-score': 0.4456943346083289, 'support': 148979}, 'accuracy': 0.37867141372873997, 'macro avg': {'precision': 0.36807446390803417, 'recall': 0.3664684370513158, 'f1-score': 0.3114404118363188, 'support': 439851}, 'weighted avg': {'precision': 0.36902436833364993, 'recall': 0.37867141372873997, 'f1-score': 0.32112126321378937, 'support': 439851}}
[[80457  2763 71694]
 [64457  3255 68246]
 [62711  3421 82847]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1011517
{'0': {'precision': 0.35585660252256596, 'recall': 0.4044356910429868, 'f1-score': 0.3785941595658552, 'support': 58390}, '1': {'precision': 0.3753700414446418, 'recall': 0.01068257257915045, 'f1-score': 0.020773944100396475, 'support': 59349}, '2': {'precision': 0.301831098166934, 'recall': 0.5905590636069613, 'f1-score': 0.39948690233563616, 'support': 51944}, 'accuracy': 0.32369182534490787, 'macro avg': {'precision': 0.34435258071138053, 'recall': 0.33522577574303286, 'f1-score': 0.26628500200062927, 'support': 169683}, 'weighted avg': {'precision': 0.3461432092441428, 'recall': 0.32369182534490787, 'f1-score': 0.25983730509471775, 'support': 169683}}
[[23615   515 34260]
 [22018   634 36697]
 [20728   540 30676]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965289
{'0': {'precision': 0.3555732617629791, 'recall': 0.3898390804597701, 'f1-score': 0.37191858934994293, 'support': 21750}, '1': {'precision': 0.2857142857142857, 'recall': 0.011855364552459988, 'f1-score': 0.02276607854297097, 'support': 21931}, '2': {'precision': 0.3602365503866689, 'recall': 0.6586988880133088, 'f1-score': 0.46575554489312637, 'support': 22842}, 'accuracy': 0.35754551057528977, 'macro avg': {'precision': 0.3338413659546446, 'recall': 0.35346444434184626, 'f1-score': 0.2868134042620134, 'support': 66523}, 'weighted avg': {'precision': 0.33414370559471285, 'recall': 0.35754551057528977, 'f1-score': 0.2890323699071892, 'support': 66523}}
[[ 8479   298 12973]
 [ 7923   260 13748]
 [ 7444   352 15046]]
Evaluating performance on  val set...
51/51 - 0s - 418ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021909
{'0': {'precision': 0.3095538720538721, 'recall': 0.376600102406554, 'f1-score': 0.33980133980133975, 'support': 3906}, '1': {'precision': 0.4791666666666667, 'recall': 0.020642613534374438, 'f1-score': 0.03958010669420065, 'support': 5571}, '2': {'precision': 0.26887332908975176, 'recall': 0.626706231454006, 'f1-score': 0.37630289532293987, 'support': 3370}, 'accuracy': 0.287849303339301, 'macro avg': {'precision': 0.35253128927009686, 'recall': 0.34131631579831145, 'f1-score': 0.25189478060616005, 'support': 12847}, 'weighted avg': {'precision': 0.37243387898146546, 'recall': 0.287849303339301, 'f1-score': 0.21918779208342273, 'support': 12847}}
[[1471   75 2360]
 [2073  115 3383]
 [1208   50 2112]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913752
{'0': {'precision': 0.3701205804210096, 'recall': 0.5366919799962956, 'f1-score': 0.43810762182675883, 'support': 134975}, '1': {'precision': 0.4284931506849315, 'recall': 0.024030926757914534, 'f1-score': 0.045509567484519765, 'support': 162707}, '2': {'precision': 0.33745373797187267, 'recall': 0.5914873948898421, 'f1-score': 0.4297358041492505, 'support': 123323}, 'accuracy': 0.3546133656369877, 'macro avg': {'precision': 0.3786891563592713, 'recall': 0.3840701005480174, 'f1-score': 0.30445099782017637, 'support': 421005}, 'weighted avg': {'precision': 0.383111050317037, 'recall': 0.3546133656369877, 'f1-score': 0.28392681803747827, 'support': 421005}}
[[72440  2147 60388]
 [75969  3910 82828]
 [47311  3068 72944]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0893133
{'0': {'precision': 0.39333439600435693, 'recall': 0.5226269900102368, 'f1-score': 0.4488555403971502, 'support': 56658}, '1': {'precision': 0.35192357345726827, 'recall': 0.02419412098835558, 'f1-score': 0.04527562324569416, 'support': 56336}, '2': {'precision': 0.37001925640645833, 'recall': 0.6022179363548699, 'f1-score': 0.45839067804385725, 'support': 53924}, 'accuracy': 0.38011478690135275, 'macro avg': {'precision': 0.3717590752893612, 'recall': 0.3830130157844874, 'f1-score': 0.3175072805622339, 'support': 166918}, 'weighted avg': {'precision': 0.3718258367915107, 'recall': 0.38011478690135275, 'f1-score': 0.3157248687488954, 'support': 166918}}
[[29611  1119 25928]
 [25612  1363 29361]
 [20059  1391 32474]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.08879
{'0': {'precision': 0.40875039017792114, 'recall': 0.48541949833189174, 'f1-score': 0.4437980117487573, 'support': 16186}, '1': {'precision': 0.3805084745762712, 'recall': 0.029572548244747414, 'f1-score': 0.05487991199657764, 'support': 15183}, '2': {'precision': 0.361557478368356, 'recall': 0.6273038000134039, 'f1-score': 0.4587223406601485, 'support': 14921}, 'accuracy': 0.3816375027003672, 'macro avg': {'precision': 0.3836054477075161, 'recall': 0.380765282196681, 'f1-score': 0.3191334214684945, 'support': 46290}, 'weighted avg': {'precision': 0.3842750727942449, 'recall': 0.3816375027003672, 'f1-score': 0.32104455318642255, 'support': 46290}}
[[7857  264 8065]
 [6271  449 8463]
 [5094  467 9360]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949723
{'0': {'precision': 0.387254719439997, 'recall': 0.5196958592891169, 'f1-score': 0.4438051618317462, 'support': 120076}, '1': {'precision': 0.31775814066093694, 'recall': 0.026678727145223746, 'f1-score': 0.049224595420706216, 'support': 98393}, '2': {'precision': 0.37838987875845786, 'recall': 0.5360086933636695, 'f1-score': 0.44361456957364886, 'support': 117791}, 'accuracy': 0.3811485160292631, 'macro avg': {'precision': 0.36113424628646396, 'recall': 0.36079442659933675, 'f1-score': 0.3122147756087004, 'support': 336260}, 'weighted avg': {'precision': 0.36381400295713484, 'recall': 0.3811485160292631, 'f1-score': 0.32828022361859266, 'support': 336260}}
[[62403  2599 55074]
 [47122  2625 48646]
 [51617  3037 63137]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945241
{'0': {'precision': 0.38070008603903455, 'recall': 0.5320886075949367, 'f1-score': 0.44384024496475993, 'support': 47400}, '1': {'precision': 0.3610503282275711, 'recall': 0.023885926605061888, 'f1-score': 0.04480753128606667, 'support': 41447}, '2': {'precision': 0.36923124240700017, 'recall': 0.5315357198202386, 'f1-score': 0.43576108459318685, 'support': 45171}, 'accuracy': 0.37473324478801356, 'macro avg': {'precision': 0.3703272188912019, 'recall': 0.36250341800674574, 'f1-score': 0.3081362869480045, 'support': 134018}, 'weighted avg': {'precision': 0.37075752125136163, 'recall': 0.37473324478801356, 'f1-score': 0.3177105262927522, 'support': 134018}}
[[25221   829 21350]
 [20790   990 19667]
 [20238   923 24010]]
Evaluating performance on  val set...
107/107 - 1s - 713ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962629
{'0': {'precision': 0.3765583989501312, 'recall': 0.47154889071487266, 'f1-score': 0.4187340386720175, 'support': 9736}, '1': {'precision': 0.33471933471933474, 'recall': 0.019742489270386267, 'f1-score': 0.037285780453913855, 'support': 8155}, '2': {'precision': 0.36724839621990757, 'recall': 0.5737687250781334, 'f1-score': 0.4478465679676985, 'support': 9279}, 'accuracy': 0.3708502024291498, 'macro avg': {'precision': 0.3595087099631245, 'recall': 0.3550200350211308, 'f1-score': 0.30128879569787664, 'support': 27170}, 'weighted avg': {'precision': 0.36082100166872194, 'recall': 0.3708502024291498, 'f1-score': 0.31418580950624597, 'support': 27170}}
[[4591  162 4983]
 [3804  161 4190]
 [3797  158 5324]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963992
{'0': {'precision': 0.3674450349975313, 'recall': 0.45586062767989044, 'f1-score': 0.40690531326386203, 'support': 111012}, '1': {'precision': 0.3206774407792783, 'recall': 0.02669972258831553, 'f1-score': 0.049295115580625666, 'support': 108503}, '2': {'precision': 0.3589780615901336, 'recall': 0.5876415020005078, 'f1-score': 0.44569205077042096, 'support': 114221}, 'accuracy': 0.36143538605364717, 'macro avg': {'precision': 0.3490335124556478, 'recall': 0.3567339507562379, 'f1-score': 0.30063082653830286, 'support': 333736}, 'weighted avg': {'precision': 0.3493423117521233, 'recall': 0.36143538605364717, 'f1-score': 0.30391516735665536, 'support': 333736}}
[[50606  2795 57611]
 [43360  2897 62246]
 [43758  3342 67121]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0970312
{'0': {'precision': 0.3578440997447477, 'recall': 0.4503892252563944, 'f1-score': 0.3988183161004431, 'support': 32372}, '1': {'precision': 0.34112444725205304, 'recall': 0.03322463545191657, 'f1-score': 0.06055169320475443, 'support': 32506}, '2': {'precision': 0.35730192325388793, 'recall': 0.5818323493271795, 'f1-score': 0.44272650566691757, 'support': 33367}, 'accuracy': 0.3570054455697491, 'macro avg': {'precision': 0.35209015675022953, 'recall': 0.35514873667849683, 'f1-score': 0.3006988383240384, 'support': 98245}, 'weighted avg': {'precision': 0.35212798363809544, 'recall': 0.3570054455697491, 'f1-score': 0.3018097122775239, 'support': 98245}}
[[14580  1019 16773]
 [13278  1080 18148]
 [12886  1067 19414]]
Evaluating performance on  val set...
93/93 - 1s - 615ms/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980499
{'0': {'precision': 0.31730091613812544, 'recall': 0.5177519045565617, 'f1-score': 0.39346769348407884, 'support': 6957}, '1': {'precision': 0.3902728351126928, 'recall': 0.03901339973912012, 'f1-score': 0.0709357481673135, 'support': 8433}, '2': {'precision': 0.36909457445876065, 'recall': 0.5126613099586073, 'f1-score': 0.4291902359476125, 'support': 8214}, 'accuracy': 0.34494153533299443, 'macro avg': {'precision': 0.35888944190319294, 'recall': 0.35647553808476307, 'f1-score': 0.2978645591996683, 'support': 23604}, 'weighted avg': {'precision': 0.36139536208619455, 'recall': 0.34494153533299443, 'f1-score': 0.2906678743406787, 'support': 23604}}
[[3602  225 3130]
 [4036  329 4068]
 [3714  289 4211]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989993
{'0': {'precision': 0.3653831644832342, 'recall': 0.5214393384728024, 'f1-score': 0.4296804714408153, 'support': 232190}, '1': {'precision': 0.3162548307764375, 'recall': 0.02632258693374272, 'f1-score': 0.04860008188497411, 'support': 205185}, '2': {'precision': 0.3634051494339386, 'recall': 0.5039707391750604, 'f1-score': 0.4222980236952489, 'support': 229932}, 'accuracy': 0.3631806649712951, 'macro avg': {'precision': 0.34834771489787014, 'recall': 0.3505775548605352, 'f1-score': 0.30019285900701276, 'support': 667307}, 'weighted avg': {'precision': 0.3495955193544648, 'recall': 0.3631806649712951, 'f1-score': 0.3099613006452911, 'support': 667307}}
[[121073   5559 105558]
 [102351   5401  97433]
 [107935   6118 115879]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977571
{'0': {'precision': 0.35268388310349125, 'recall': 0.5042201953764155, 'f1-score': 0.41505307515869205, 'support': 61727}, '1': {'precision': 0.3735802900576621, 'recall': 0.03502219601290809, 'f1-score': 0.0640407368578703, 'support': 61047}, '2': {'precision': 0.3561577386530257, 'recall': 0.5218641466763589, 'f1-score': 0.42337430870442694, 'support': 61905}, 'accuracy': 0.3550376599396791, 'macro avg': {'precision': 0.36080730393805965, 'recall': 0.3537021793552275, 'f1-score': 0.3008227069069964, 'support': 184679}, 'weighted avg': {'precision': 0.36075579156696136, 'recall': 0.3550376599396791, 'f1-score': 0.3018126728736377, 'support': 184679}}
[[31124  1662 28941]
 [29449  2138 29460]
 [27676  1923 32306]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987108
{'0': {'precision': 0.3685840099078024, 'recall': 0.5198951863354038, 'f1-score': 0.43135518157661645, 'support': 20608}, '1': {'precision': 0.32011019283746556, 'recall': 0.03479875419262099, 'f1-score': 0.06277348603533034, 'support': 16696}, '2': {'precision': 0.3780855127828387, 'recall': 0.49478440609527474, 'f1-score': 0.42863389343494285, 'support': 20803}, 'accuracy': 0.3715215034333213, 'macro avg': {'precision': 0.3555932385093689, 'recall': 0.3498261155410998, 'f1-score': 0.30758752034896325, 'support': 58107}, 'weighted avg': {'precision': 0.3580575830487843, 'recall': 0.3715215034333213, 'f1-score': 0.3244756155007814, 'support': 58107}}
[[10714   560  9334]
 [ 8518   581  7597]
 [ 9836   674 10293]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/EXC
Evaluating performance on  test set...
5343/5343 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941272
{'0': {'precision': 0.36225284816805653, 'recall': 0.5431207443680905, 'f1-score': 0.434620665255687, 'support': 445586}, '1': {'precision': 0.35114611165799464, 'recall': 0.026507937518975948, 'f1-score': 0.04929463464325056, 'support': 470991}, '2': {'precision': 0.3652991411811469, 'recall': 0.5377132890225551, 'f1-score': 0.4350465090216295, 'support': 451207}, 'accuracy': 0.3634433507044972, 'macro avg': {'precision': 0.35956603366906603, 'recall': 0.3691139903032072, 'f1-score': 0.30632060297352237, 'support': 1367784}, 'weighted avg': {'precision': 0.3594332039815088, 'recall': 0.3634433507044972, 'f1-score': 0.30207565171840156, 'support': 1367784}}
[[242007  10338 193241]
 [230199  12485 228307]
 [195855  12732 242620]]
Evaluating performance on  train set...
1290/1290 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913048
{'0': {'precision': 0.37634744571160755, 'recall': 0.5534673847115261, 'f1-score': 0.44803767310546455, 'support': 108814}, '1': {'precision': 0.3464558793139078, 'recall': 0.030772760646108663, 'f1-score': 0.05652489084441747, 'support': 108960}, '2': {'precision': 0.38500940962398894, 'recall': 0.5496650445272813, 'f1-score': 0.4528340607673054, 'support': 112403}, 'accuracy': 0.37968120129506294, 'macro avg': {'precision': 0.36927091154983477, 'recall': 0.3779683966283054, 'f1-score': 0.31913220823906246, 'support': 330177}, 'weighted avg': {'precision': 0.36943189936813126, 'recall': 0.37968120129506294, 'f1-score': 0.3204694161014643, 'support': 330177}}
[[60225  2692 45897]
 [52814  3353 52793]
 [46986  3633 61784]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934232
{'0': {'precision': 0.36380185223109657, 'recall': 0.529316338354577, 'f1-score': 0.4312223540835042, 'support': 30205}, '1': {'precision': 0.38816067653276953, 'recall': 0.02761317491352083, 'f1-score': 0.05155855096882898, 'support': 33245}, '2': {'precision': 0.35107023123871745, 'recall': 0.555759678846023, 'f1-score': 0.4303137265231936, 'support': 29394}, 'accuracy': 0.35804144586618414, 'macro avg': {'precision': 0.36767758666752787, 'recall': 0.37089639737137353, 'f1-score': 0.3043648771918423, 'support': 92844}, 'weighted avg': {'precision': 0.3684933330640974, 'recall': 0.35804144586618414, 'f1-score': 0.2949870418064034, 'support': 92844}}
[[15988   581 13636]
 [15767   918 16560]
 [12192   866 16336]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/AAL
Evaluating performance on  test set...
7177/7177 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0932131
{'0': {'precision': 0.4105850727036424, 'recall': 0.5418208897026164, 'f1-score': 0.46716122782105557, 'support': 682183}, '1': {'precision': 0.27753497463378207, 'recall': 0.0252769321241264, 'f1-score': 0.04633392914432375, 'support': 499942}, '2': {'precision': 0.39240632723788627, 'recall': 0.5340181599153535, 'f1-score': 0.45238895930879275, 'support': 654959}, 'accuracy': 0.39846735369749015, 'macro avg': {'precision': 0.3601754581917702, 'recall': 0.3670386605806988, 'f1-score': 0.3219613720913907, 'support': 1837084}, 'weighted avg': {'precision': 0.36789586247659334, 'recall': 0.39846735369749015, 'f1-score': 0.3473711302710438, 'support': 1837084}}
[[369621  15154 297408]
 [243152  12637 244153]
 [287457  17742 349760]]
Evaluating performance on  train set...
2257/2257 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0918213
{'0': {'precision': 0.3843154154274371, 'recall': 0.5535053848775748, 'f1-score': 0.4536488247250743, 'support': 196569}, '1': {'precision': 0.3534650709713332, 'recall': 0.02022411074956606, 'f1-score': 0.038259158097686374, 'support': 188389}, '2': {'precision': 0.3789607633711564, 'recall': 0.558141587407069, 'f1-score': 0.4514208332895938, 'support': 192616}, 'accuracy': 0.38110960673437516, 'macro avg': {'precision': 0.37224708325664224, 'recall': 0.37729036101140334, 'f1-score': 0.31444293870411816, 'support': 577574}, 'weighted avg': {'precision': 0.3724671376271665, 'recall': 0.38110960673437516, 'f1-score': 0.31741694672398096, 'support': 577574}}
[[108802   3216  84551]
 [ 92948   3810  91631]
 [ 81356   3753 107507]]
Evaluating performance on  val set...
638/638 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0900933
{'0': {'precision': 0.41258493950034103, 'recall': 0.5494701429772918, 'f1-score': 0.47128924284395196, 'support': 59450}, '1': {'precision': 0.30298594847775173, 'recall': 0.021835443037974682, 'f1-score': 0.04073520151133501, 'support': 47400}, '2': {'precision': 0.39101031745048737, 'recall': 0.5589709085114294, 'f1-score': 0.4601425510516419, 'support': 56477}, 'accuracy': 0.3996277406674953, 'macro avg': {'precision': 0.36886040180952673, 'recall': 0.3767588315088986, 'f1-score': 0.32405566513564293, 'support': 163327}, 'weighted avg': {'precision': 0.37331732236428683, 'recall': 0.3996277406674953, 'f1-score': 0.34248143230729644, 'support': 163327}}
[[32666  1024 25760]
 [22957  1035 23408]
 [23551  1357 31569]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/WBA
Evaluating performance on  test set...
5696/5696 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969406
{'0': {'precision': 0.37917845086119706, 'recall': 0.49569834939796137, 'f1-score': 0.4296790866176675, 'support': 519568}, '1': {'precision': 0.30488041370394314, 'recall': 0.022351756412534802, 'f1-score': 0.0416500171094897, 'support': 422025}, '2': {'precision': 0.3730306879721869, 'recall': 0.5401954975156169, 'f1-score': 0.4413134473801606, 'support': 516426}, 'accuracy': 0.3744484811240457, 'macro avg': {'precision': 0.35236318417910906, 'recall': 0.35274853444203763, 'f1-score': 0.30421418370243924, 'support': 1458019}, 'weighted avg': {'precision': 0.3554952932829967, 'recall': 0.3744484811240457, 'f1-score': 0.32148455577269397, 'support': 1458019}}
[[257549   9867 252152]
 [195865   9433 216727]
 [225815  11640 278971]]
Evaluating performance on  train set...
2222/2222 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957584
{'0': {'precision': 0.3700905838244766, 'recall': 0.5114112260122446, 'f1-score': 0.4294227807525903, 'support': 194370}, '1': {'precision': 0.3423009120870698, 'recall': 0.024376531720603247, 'f1-score': 0.045511984346975384, 'support': 183209}, '2': {'precision': 0.36184751550630706, 'recall': 0.5435696376132623, 'f1-score': 0.43447226993069316, 'support': 191039}, 'accuracy': 0.365292692106124, 'macro avg': {'precision': 0.35807967047261785, 'recall': 0.3597857984487034, 'f1-score': 0.30313567834341965, 'support': 568618}, 'weighted avg': {'precision': 0.35836730827257124, 'recall': 0.365292692106124, 'f1-score': 0.30742301335940064, 'support': 568618}}
[[ 99403   4026  90941]
 [ 86547   4466  92196]
 [ 82641   4555 103843]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947744
{'0': {'precision': 0.38980710604382834, 'recall': 0.48613905275002556, 'f1-score': 0.43267603924038145, 'support': 58654}, '1': {'precision': 0.3466453674121406, 'recall': 0.021812114267334096, 'f1-score': 0.041041741531594574, 'support': 49743}, '2': {'precision': 0.3645094613267555, 'recall': 0.5756460891990839, 'f1-score': 0.4463696369636963, 'support': 55449}, 'accuracy': 0.3754623243777694, 'macro avg': {'precision': 0.36698731159424147, 'recall': 0.3611990854054812, 'f1-score': 0.3066958059118908, 'support': 163846}, 'weighted avg': {'precision': 0.3681421067965289, 'recall': 0.3754623243777694, 'f1-score': 0.3184116167291935, 'support': 163846}}
[[28514  1020 29120]
 [22130  1085 26528]
 [22505  1025 31919]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 59s - 59s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0966021
{'0': {'precision': 0.32699927483861935, 'recall': 0.5685023853418634, 'f1-score': 0.4151859812595941, 'support': 936763}, '1': {'precision': 0.4524444444444444, 'recall': 0.05291539372151593, 'f1-score': 0.09474942053874885, 'support': 1192772}, '2': {'precision': 0.34208402297510326, 'recall': 0.4709695174199574, 'f1-score': 0.3963112863130231, 'support': 959302}, 'accuracy': 0.33911468944460327, 'macro avg': {'precision': 0.37384258075272236, 'recall': 0.36412909882777883, 'f1-score': 0.3020822293704553, 'support': 3088837}, 'weighted avg': {'precision': 0.3801255210270406, 'recall': 0.33911468944460327, 'f1-score': 0.28558565271659897, 'support': 3088837}}
[[532552  33055 371156]
 [631880  63116 497776]
 [464171  43329 451802]]
Evaluating performance on  train set...
2948/2948 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094382
{'0': {'precision': 0.3681738057977928, 'recall': 0.49845823045024396, 'f1-score': 0.42352291644010936, 'support': 253929}, '1': {'precision': 0.3641163628979032, 'recall': 0.02910489856707478, 'f1-score': 0.053901306197297424, 'support': 246419}, '2': {'precision': 0.3678928482827234, 'recall': 0.5660247430469205, 'f1-score': 0.4459418193880604, 'support': 254132}, 'accuracy': 0.3679222775951649, 'macro avg': {'precision': 0.36672767232613984, 'recall': 0.36452929068807977, 'f1-score': 0.30778868067515575, 'support': 754480}, 'weighted avg': {'precision': 0.36675397847676705, 'recall': 0.3679222775951649, 'f1-score': 0.3103530154083328, 'support': 754480}}
[[126573   5771 121585]
 [113680   7172 125567]
 [103533   6754 143845]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937613
{'0': {'precision': 0.3758989097876572, 'recall': 0.5063710915803574, 'f1-score': 0.43148773273012003, 'support': 61214}, '1': {'precision': 0.3718056725638865, 'recall': 0.022774184670427963, 'f1-score': 0.042919428821498615, 'support': 58136}, '2': {'precision': 0.3635389378423434, 'recall': 0.5687214225232854, 'f1-score': 0.44355073038011467, 'support': 59050}, 'accuracy': 0.3694170403587444, 'macro avg': {'precision': 0.3704145067312958, 'recall': 0.3659555662580236, 'f1-score': 0.3059859639772444, 'support': 178400}, 'weighted avg': {'precision': 0.3704739054008192, 'recall': 0.3694170403587444, 'f1-score': 0.30885607967631157, 'support': 178400}}
[[30997   997 29220]
 [27237  1324 29575]
 [24227  1240 33583]]
testing model on single stock: results/universal/W1/deepOF_L1/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 111s - 111s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955378
{'0': {'precision': 0.37580834248734546, 'recall': 0.5025174281466539, 'f1-score': 0.4300232284121198, 'support': 1903530}, '1': {'precision': 0.32948445254735137, 'recall': 0.021747414444347878, 'f1-score': 0.04080173592384011, 'support': 1645391}, '2': {'precision': 0.37429172161917196, 'recall': 0.5490100355136492, 'f1-score': 0.4451197234081421, 'support': 1917291}, 'accuracy': 0.3741077001770147, 'macro avg': {'precision': 0.35986150555128954, 'recall': 0.35775829270155035, 'f1-score': 0.3053148959147007, 'support': 5466212}, 'weighted avg': {'precision': 0.361332373547023, 'recall': 0.3741077001770147, 'f1-score': 0.31815834524268466, 'support': 5466212}}
[[ 956557   34496  912477]
 [ 762420   35783  847188]
 [ 826355   38324 1052612]]
Evaluating performance on  train set...
6073/6073 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096415
{'0': {'precision': 0.3603979033096046, 'recall': 0.5100014434874657, 'f1-score': 0.42234280527466295, 'support': 519575}, '1': {'precision': 0.3480932758497487, 'recall': 0.02855841930106718, 'f1-score': 0.05278613560264834, 'support': 511723}, '2': {'precision': 0.3604287059574227, 'recall': 0.5354310995594882, 'f1-score': 0.43083691701568, 'support': 523255}, 'accuracy': 0.36008100077642896, 'macro avg': {'precision': 0.3563066283722587, 'recall': 0.35799698744934033, 'f1-score': 0.30198861929766374, 'support': 1554553}, 'weighted avg': {'precision': 0.3563578717132835, 'recall': 0.36008100077642896, 'f1-score': 0.3035523483166007, 'support': 1554553}}
[[264984  13151 241440]
 [241400  14614 255709]
 [228870  14218 280167]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980618
{'0': {'precision': 0.34430739478020855, 'recall': 0.5162724209523161, 'f1-score': 0.41310848571008385, 'support': 146905}, '1': {'precision': 0.3502731880718847, 'recall': 0.033244822092405736, 'f1-score': 0.06072606507423849, 'support': 160055}, '2': {'precision': 0.3497862207068247, 'recall': 0.516241546408222, 'f1-score': 0.4170170665347514, 'support': 150232}, 'accuracy': 0.3471626800118987, 'macro avg': {'precision': 0.3481222678529727, 'recall': 0.3552529298176479, 'f1-score': 0.2969505391063579, 'support': 457192}, 'weighted avg': {'precision': 0.3481962424020099, 'recall': 0.3471626800118987, 'f1-score': 0.29102985261847514, 'support': 457192}}
[[75843  4725 66337]
 [76903  5321 77831]
 [67531  5145 77556]]
training model: results/universal/W1/deepOF_L1/h500
Epoch 1/50
10622/10622 - 146s - loss: 3.2748 - accuracy500: 0.3772 - val_loss: 3.3043 - val_accuracy500: 0.3700 - 146s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 145s - loss: 3.2772 - accuracy500: 0.3725 - val_loss: 3.2984 - val_accuracy500: 0.3712 - 145s/epoch - 14ms/step
Epoch 3/50
10622/10622 - 141s - loss: 3.2761 - accuracy500: 0.3733 - val_loss: 3.2986 - val_accuracy500: 0.3702 - 141s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 143s - loss: 3.2732 - accuracy500: 0.3755 - val_loss: 3.3041 - val_accuracy500: 0.3715 - 143s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 143s - loss: 3.2722 - accuracy500: 0.3761 - val_loss: 3.3053 - val_accuracy500: 0.3700 - 143s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 142s - loss: 3.2708 - accuracy500: 0.3774 - val_loss: 3.3100 - val_accuracy500: 0.3706 - 142s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 145s - loss: 3.2692 - accuracy500: 0.3784 - val_loss: 3.3114 - val_accuracy500: 0.3712 - 145s/epoch - 14ms/step
Epoch 8/50
10622/10622 - 141s - loss: 3.2677 - accuracy500: 0.3800 - val_loss: 3.3100 - val_accuracy500: 0.3698 - 141s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 144s - loss: 3.2655 - accuracy500: 0.3819 - val_loss: 3.3115 - val_accuracy500: 0.3691 - 144s/epoch - 14ms/step
Epoch 10/50
10622/10622 - 143s - loss: 3.2639 - accuracy500: 0.3834 - val_loss: 3.3102 - val_accuracy500: 0.3672 - 143s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 144s - loss: 3.2628 - accuracy500: 0.3843 - val_loss: 3.3119 - val_accuracy500: 0.3688 - 144s/epoch - 14ms/step
Epoch 12/50
10622/10622 - 140s - loss: 3.2618 - accuracy500: 0.3850 - val_loss: 3.3103 - val_accuracy500: 0.3676 - 140s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 172s - 172s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0838944
{'0': {'precision': 0.389127459798212, 'recall': 0.5967153371816071, 'f1-score': 0.4710656183551049, 'support': 3350420}, '1': {'precision': 0.3181818181818182, 'recall': 3.018245726595229e-06, 'f1-score': 6.036434192087959e-06, 'support': 2319228}, '2': {'precision': 0.3971363263677214, 'recall': 0.4596808867231963, 'f1-score': 0.4261258430981957, 'support': 3377108}, 'accuracy': 0.392587796111667, 'macro avg': {'precision': 0.36814853478258386, 'recall': 0.3521330807168433, 'f1-score': 0.29906583262916425, 'support': 9046756}, 'weighted avg': {'precision': 0.3739294914710146, 'recall': 0.392587796111667, 'f1-score': 0.33352890944004354, 'support': 9046756}}
[[1999247       9 1351164]
 [1313812       7 1005409]
 [1824710       6 1552392]]
Evaluating performance on  train set...
10622/10622 - 70s - 70s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110673
{'0': {'precision': 0.3512992728310189, 'recall': 0.607297920254923, 'f1-score': 0.4451156738536737, 'support': 906313}, '1': {'precision': 0.16666666666666666, 'recall': 1.1098717543187885e-06, 'f1-score': 2.2197287269522792e-06, 'support': 901005}, '2': {'precision': 0.35978741803734166, 'recall': 0.4547697359395869, 'f1-score': 0.40174081903616066, 'support': 911193}, 'accuracy': 0.354895014219181, 'macro avg': {'precision': 0.2925844525116757, 'recall': 0.35402292202208807, 'f1-score': 0.2822862375395204, 'support': 2718511}, 'weighted avg': {'precision': 0.2929509480230165, 'recall': 0.354895014219181, 'f1-score': 0.28305184118219223, 'support': 2718511}}
[[550402      4 355907]
 [519550      1 381454]
 [496809      1 414383]]
Evaluating performance on  val set...
3064/3064 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0991391
{'0': {'precision': 0.36898841136900157, 'recall': 0.6092181975441784, 'f1-score': 0.4596052671095057, 'support': 276323}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 234182}, '2': {'precision': 0.37445466507505704, 'recall': 0.44883284358750103, 'f1-score': 0.4082839842748768, 'support': 273271}, 'accuracy': 0.3712718940105336, 'macro avg': {'precision': 0.2478143588146862, 'recall': 0.35268368037722647, 'f1-score': 0.28929641712812754, 'support': 783776}, 'weighted avg': {'precision': 0.2606453700731364, 'recall': 0.3712718940105336, 'f1-score': 0.3043875787090697, 'support': 783776}}
[[168341      0 107982]
 [137266      0  96916]
 [150616      2 122653]]
testing model out of sample: results/universal/W1/deepOF_L1/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 162s - 162s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1325147
{'0': {'precision': 0.31832916354780644, 'recall': 0.6228796960924636, 'f1-score': 0.4213321424190773, 'support': 1858460}, '1': {'precision': 0.5714285714285714, 'recall': 1.5107280576191681e-05, 'f1-score': 3.021376236875897e-05, 'support': 2382957}, '2': {'precision': 0.332862833637209, 'recall': 0.4412414130180853, 'f1-score': 0.37946534382128994, 'support': 1857754}, 'accuracy': 0.3241999609455121, 'macro avg': {'precision': 0.4075401895378623, 'recall': 0.354712072130375, 'f1-score': 0.26694256666757865, 'support': 6099171}, 'weighted avg': {'precision': 0.4216423825817689, 'recall': 0.3241999609455121, 'f1-score': 0.24397646693986247, 'support': 6099171}}
[[1157597      14  700849]
 [1440858      36  942063]
 [1038023      13  819718]]
Evaluating performance on  train set...
6711/6711 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087645
{'0': {'precision': 0.35829337016687474, 'recall': 0.6043713455079367, 'f1-score': 0.449880924663443, 'support': 580279}, '1': {'precision': 0.6666666666666666, 'recall': 7.103029442057037e-06, 'f1-score': 1.4205907526644954e-05, 'support': 563140}, '2': {'precision': 0.3638526643645474, 'recall': 0.46821409589530455, 'f1-score': 0.4094886478372025, 'support': 573855}, 'accuracy': 0.3606850159031116, 'macro avg': {'precision': 0.4629375670660296, 'recall': 0.3575308481442278, 'f1-score': 0.2864612594693907, 'support': 1717274}, 'weighted avg': {'precision': 0.4612749368607734, 'recall': 0.3606850159031116, 'f1-score': 0.28885987967101373, 'support': 1717274}}
[[350704      0 229575]
 [322948      4 240188]
 [305166      2 268687]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054822
{'0': {'precision': 0.36960944588561173, 'recall': 0.6039448762327738, 'f1-score': 0.45857478309814453, 'support': 153110}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 140734}, '2': {'precision': 0.36083240626993623, 'recall': 0.4687309512557617, 'f1-score': 0.4077646764420241, 'support': 146007}, 'accuracy': 0.3658238812688842, 'macro avg': {'precision': 0.24348061738518267, 'recall': 0.35755860916284515, 'f1-score': 0.28877981984672285, 'support': 439851}, 'weighted avg': {'precision': 0.24843631002726058, 'recall': 0.3658238812688842, 'f1-score': 0.2949837152886489, 'support': 439851}}
[[92470     1 60639]
 [80144     0 60590]
 [77569     0 68438]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1292412
{'0': {'precision': 0.33422893165922657, 'recall': 0.5708622752352552, 'f1-score': 0.4216120694202669, 'support': 56003}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 64205}, '2': {'precision': 0.28786978252059975, 'recall': 0.43074279939363314, 'f1-score': 0.3451034371078094, 'support': 49475}, 'accuracy': 0.3140031706181527, 'macro avg': {'precision': 0.20736623805994212, 'recall': 0.3338683582096295, 'f1-score': 0.25557183550935875, 'support': 169683}, 'weighted avg': {'precision': 0.19424562478220173, 'recall': 0.3140031706181527, 'f1-score': 0.23977377388808585, 'support': 169683}}
[[31970     0 24033]
 [35519     0 28686]
 [28164     0 21311]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1105211
{'0': {'precision': 0.3415993899071712, 'recall': 0.5927176492060595, 'f1-score': 0.43341174115409636, 'support': 21916}, '1': {'precision': 1.0, 'recall': 4.5662100456621006e-05, 'f1-score': 9.132003104881056e-05, 'support': 21900}, '2': {'precision': 0.3565888752412704, 'recall': 0.447483154974237, 'f1-score': 0.39689855865005275, 'support': 22707}, 'accuracy': 0.3480300046600424, 'macro avg': {'precision': 0.5660627550494806, 'recall': 0.3467488220935844, 'f1-score': 0.276800539945066, 'support': 66523}, 'weighted avg': {'precision': 0.563467609989163, 'recall': 0.3480300046600424, 'f1-score': 0.27829513399996836, 'support': 66523}}
[[12990     0  8926]
 [12491     1  9408]
 [12546     0 10161]]
Evaluating performance on  val set...
51/51 - 0s - 424ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1457766
{'0': {'precision': 0.3143631436314363, 'recall': 0.5752541532358046, 'f1-score': 0.40655392972925614, 'support': 4033}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5509}, '2': {'precision': 0.26797146515456377, 'recall': 0.443267776096823, 'f1-score': 0.3340173278613771, 'support': 3305}, 'accuracy': 0.29462131236864636, 'macro avg': {'precision': 0.19411153626200003, 'recall': 0.3395073097775425, 'f1-score': 0.2468570858635444, 'support': 12847}, 'weighted avg': {'precision': 0.1676245232818102, 'recall': 0.29462131236864636, 'f1-score': 0.21355641528605443, 'support': 12847}}
[[2320    0 1713]
 [3220    0 2289]
 [1840    0 1465]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095984
{'0': {'precision': 0.40337969736193036, 'recall': 0.6153499829558976, 'f1-score': 0.4873121784750166, 'support': 155479}, '1': {'precision': 0.3333333333333333, 'recall': 7.8400012544002e-06, 'f1-score': 1.567963372375621e-05, 'support': 127551}, '2': {'precision': 0.3718182362189304, 'recall': 0.4953651023736184, 'f1-score': 0.42479086129100424, 'support': 137975}, 'accuracy': 0.3895986983527512, 'macro avg': {'precision': 0.36951042230473136, 'recall': 0.37024097511025683, 'f1-score': 0.3040395731332482, 'support': 421005}, 'weighted avg': {'precision': 0.37181433262892954, 'recall': 0.3895986983527512, 'f1-score': 0.3191870149682415, 'support': 421005}}
[[95674     0 59805]
 [71882     1 55668]
 [69625     2 68348]]
Evaluating performance on  train set...
653/653 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1088396
{'0': {'precision': 0.378095217132921, 'recall': 0.5918448207548795, 'f1-score': 0.46141758721418263, 'support': 58049}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56048}, '2': {'precision': 0.352465483234714, 'recall': 0.5074686204350543, 'f1-score': 0.41599739274157876, 'support': 52821}, 'accuracy': 0.36641344851963237, 'macro avg': {'precision': 0.24352023345587834, 'recall': 0.36643781372997797, 'f1-score': 0.29247165998525376, 'support': 166918}, 'weighted avg': {'precision': 0.24302728614822702, 'recall': 0.36641344851963237, 'f1-score': 0.2921088666422975, 'support': 166918}}
[[34356     2 23691]
 [30494     0 25554]
 [26016     0 26805]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0798267
{'0': {'precision': 0.42470132929496884, 'recall': 0.560515212080835, 'f1-score': 0.4832471759525177, 'support': 18012}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 12003}, '2': {'precision': 0.39275246469491076, 'recall': 0.5434101382488479, 'f1-score': 0.45595854922279794, 'support': 16275}, 'accuracy': 0.4091596457118168, 'macro avg': {'precision': 0.27248459799662655, 'recall': 0.367975116776561, 'f1-score': 0.31306857505843855, 'support': 46290}, 'weighted avg': {'precision': 0.303343415557802, 'recall': 0.4091596457118168, 'f1-score': 0.34834680323736844, 'support': 46290}}
[[10096     0  7916]
 [ 6245     0  5758]
 [ 7431     0  8844]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.080511
{'0': {'precision': 0.3977578689665061, 'recall': 0.5880704123614208, 'f1-score': 0.47454437746105865, 'support': 127364}, '1': {'precision': 1.0, 'recall': 2.4129236189028437e-05, 'f1-score': 4.825730796607511e-05, 'support': 82887}, '2': {'precision': 0.39718833429083167, 'recall': 0.46636351371727414, 'f1-score': 0.42900527076550204, 'support': 126009}, 'accuracy': 0.39751085469577113, 'macro avg': {'precision': 0.5983154010857793, 'recall': 0.35148601843829463, 'f1-score': 0.3011993018448423, 'support': 336260}, 'weighted avg': {'precision': 0.5459951764667326, 'recall': 0.39751085469577113, 'f1-score': 0.34051744233130854, 'support': 336260}}
[[74899     0 52465]
 [46161     2 36724]
 [67243     0 58766]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098819
{'0': {'precision': 0.3592941732531576, 'recall': 0.5957029974531444, 'f1-score': 0.44823717292494164, 'support': 45939}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 44154}, '2': {'precision': 0.3546636244209362, 'recall': 0.4671143995446784, 'f1-score': 0.40319522092417737, 'support': 43925}, 'accuracy': 0.35729528869256366, 'macro avg': {'precision': 0.23798593255803127, 'recall': 0.3542724656659409, 'f1-score': 0.2838107979497064, 'support': 134018}, 'weighted avg': {'precision': 0.23940227975172312, 'recall': 0.35729528869256366, 'f1-score': 0.28579681510016103, 'support': 134018}}
[[27366     0 18573]
 [25393     0 18761]
 [23407     0 20518]]
Evaluating performance on  val set...
107/107 - 1s - 692ms/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0884261
{'0': {'precision': 0.3979513084964569, 'recall': 0.5381404174573055, 'f1-score': 0.4575485015931916, 'support': 10540}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7257}, '2': {'precision': 0.37260973910350703, 'recall': 0.5134962125253387, 'f1-score': 0.43185284881112607, 'support': 9373}, 'accuracy': 0.38590357011409643, 'macro avg': {'precision': 0.2568536825333213, 'recall': 0.350545543327548, 'f1-score': 0.2964671168014392, 'support': 27170}, 'weighted avg': {'precision': 0.2829178460128755, 'recall': 0.38590357011409643, 'f1-score': 0.3264747132388268, 'support': 27170}}
[[5672    0 4868]
 [4021    0 3236]
 [4560    0 4813]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10243
{'0': {'precision': 0.3685016157378536, 'recall': 0.5661577054063706, 'f1-score': 0.4464301044989852, 'support': 114809}, '1': {'precision': 0.3333333333333333, 'recall': 9.676607768380716e-06, 'f1-score': 1.9352653732643086e-05, 'support': 103342}, '2': {'precision': 0.3618209898120666, 'recall': 0.492537959077735, 'f1-score': 0.4171796224645328, 'support': 115585}, 'accuracy': 0.36535165520051777, 'macro avg': {'precision': 0.3545519796277512, 'recall': 0.35290178036395803, 'f1-score': 0.28787635987241683, 'support': 333736}, 'weighted avg': {'precision': 0.35529794341038506, 'recall': 0.36535165520051777, 'f1-score': 0.29806763571184725, 'support': 333736}}
[[65000     0 49809]
 [52737     1 50604]
 [58653     2 56930]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1116081
{'0': {'precision': 0.33995238814993956, 'recall': 0.560250342508407, 'f1-score': 0.42314566577301166, 'support': 32116}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 32457}, '2': {'precision': 0.3602621532758126, 'recall': 0.48485388453314326, 'f1-score': 0.4133740141032296, 'support': 33672}, 'accuracy': 0.3493205761107436, 'macro avg': {'precision': 0.23340484714191737, 'recall': 0.34836807568051675, 'f1-score': 0.2788398932920804, 'support': 98245}, 'weighted avg': {'precision': 0.2346038793111774, 'recall': 0.3493205761107436, 'f1-score': 0.2800028093526387, 'support': 98245}}
[[17993     0 14123]
 [17589     0 14868]
 [17346     0 16326]]
Evaluating performance on  val set...
93/93 - 1s - 669ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1237777
{'0': {'precision': 0.3093144613624991, 'recall': 0.6162939752172055, 'f1-score': 0.4118990956687292, 'support': 7021}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8430}, '2': {'precision': 0.3669266770670827, 'recall': 0.4327241506194039, 'f1-score': 0.3971184151283206, 'support': 8153}, 'accuracy': 0.33278257922386034, 'macro avg': {'precision': 0.22541371280986064, 'recall': 0.3496727086122031, 'f1-score': 0.26967250359901657, 'support': 23604}, 'weighted avg': {'precision': 0.2187447056157444, 'recall': 0.33278257922386034, 'f1-score': 0.2596869170153934, 'support': 23604}}
[[4327    0 2694]
 [5037    0 3393]
 [4625    0 3528]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1068838
{'0': {'precision': 0.35490288791221286, 'recall': 0.5987011005775308, 'f1-score': 0.4456372921168234, 'support': 229425}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 209345}, '2': {'precision': 0.3584678124297575, 'recall': 0.4396268437933464, 'f1-score': 0.39492075720889275, 'support': 228537}, 'accuracy': 0.3563996781091761, 'macro avg': {'precision': 0.23779023344732345, 'recall': 0.34610931479029244, 'f1-score': 0.2801860164419054, 'support': 667307}, 'weighted avg': {'precision': 0.24478501425658492, 'recall': 0.3563996781091761, 'f1-score': 0.2884644411554965, 'support': 667307}}
[[137357      0  92068]
 [121605      0  87740]
 [128065      1 100471]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1112374
{'0': {'precision': 0.3482646800223119, 'recall': 0.5900906673501426, 'f1-score': 0.43801687287082564, 'support': 62426}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 60487}, '2': {'precision': 0.3527995336222847, 'recall': 0.4507010329307386, 'f1-score': 0.3957859417652412, 'support': 61766}, 'accuracy': 0.3502022428104982, 'macro avg': {'precision': 0.23368807121486554, 'recall': 0.34693056676029377, 'f1-score': 0.2779342715453556, 'support': 184679}, 'weighted avg': {'precision': 0.23571595529966527, 'recall': 0.3502022428104982, 'f1-score': 0.280431211913136, 'support': 184679}}
[[36837     0 25589]
 [35008     0 25479]
 [33928     0 27838]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107944
{'0': {'precision': 0.3466802562609202, 'recall': 0.6032735380561467, 'f1-score': 0.4403225209897548, 'support': 19734}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18252}, '2': {'precision': 0.3598838677101742, 'recall': 0.4250782764276129, 'f1-score': 0.389773737097546, 'support': 20121}, 'accuracy': 0.35207462095788805, 'macro avg': {'precision': 0.2355213746570315, 'recall': 0.3427839381612532, 'f1-score': 0.27669875269576694, 'support': 58107}, 'weighted avg': {'precision': 0.24235654016296515, 'recall': 0.35207462095788805, 'f1-score': 0.28450895749826255, 'support': 58107}}
[[11905     0  7829]
 [10868     0  7384]
 [11567     1  8553]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/EXC
Evaluating performance on  test set...
5343/5343 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076666
{'0': {'precision': 0.3604855446129069, 'recall': 0.6019985687445815, 'f1-score': 0.4509410158533761, 'support': 462531}, '1': {'precision': 0.5, 'recall': 2.280834602997929e-06, 'f1-score': 4.5616483972648365e-06, 'support': 438436}, '2': {'precision': 0.3688657996442554, 'recall': 0.47044559216995097, 'f1-score': 0.4135087197369957, 'support': 466817}, 'accuracy': 0.3641335181578378, 'macro avg': {'precision': 0.40978378141905414, 'recall': 0.3574821472497118, 'f1-score': 0.288151432412923, 'support': 1367784}, 'weighted avg': {'precision': 0.40806630683491313, 'recall': 0.3641335181578378, 'f1-score': 0.29362026388378554, 'support': 1367784}}
[[278443      1 184087]
 [246763      1 191672]
 [247205      0 219612]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.107472
{'0': {'precision': 0.3589381941117254, 'recall': 0.6135978797025694, 'f1-score': 0.4529265716333303, 'support': 108664}, '1': {'precision': 0.5, 'recall': 9.276179698153112e-06, 'f1-score': 1.8552015212652476e-05, 'support': 107803}, '2': {'precision': 0.3807542100598272, 'recall': 0.48357224518512004, 'f1-score': 0.4260477441249622, 'support': 113710}, 'accuracy': 0.36848114799032033, 'macro avg': {'precision': 0.4132308013905175, 'recall': 0.36572646702246253, 'f1-score': 0.2929976225911684, 'support': 330177}, 'weighted avg': {'precision': 0.41250820363277724, 'recall': 0.36848114799032033, 'f1-score': 0.2957949885283034, 'support': 330177}}
[[66676     0 41988]
 [60361     1 47441]
 [58722     1 54987]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142111
{'0': {'precision': 0.3520464496478203, 'recall': 0.6038136284977308, 'f1-score': 0.4447731399641642, 'support': 30627}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 31763}, '2': {'precision': 0.35736964826115, 'recall': 0.4730741446115453, 'f1-score': 0.40716142889441553, 'support': 30454}, 'accuracy': 0.3543578475722718, 'macro avg': {'precision': 0.23647203263632344, 'recall': 0.35896259103642536, 'f1-score': 0.2839781896195266, 'support': 92844}, 'weighted avg': {'precision': 0.23335338720336107, 'recall': 0.3543578475722718, 'f1-score': 0.2802740200038019, 'support': 92844}}
[[18493     0 12134]
 [17990     0 13773]
 [16047     0 14407]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0940924
{'0': {'precision': 0.38968908696597604, 'recall': 0.6040495273662263, 'f1-score': 0.47374934496182064, 'support': 670498}, '1': {'precision': 0.25, 'recall': 3.7745962125701604e-06, 'f1-score': 7.549078446248674e-06, 'support': 529858}, '2': {'precision': 0.37590598558445626, 'recall': 0.47096876531266096, 'f1-score': 0.4181019158188553, 'support': 636728}, 'accuracy': 0.38370319484574467, 'macro avg': {'precision': 0.3385316908501441, 'recall': 0.35834068909169997, 'f1-score': 0.29728626995304075, 'support': 1837084}, 'weighted avg': {'precision': 0.3446223035102002, 'recall': 0.38370319484574467, 'f1-score': 0.317823890956171, 'support': 1837084}}
[[405014      2 265482]
 [297467      2 232389]
 [336845      4 299879]]
Evaluating performance on  train set...
2257/2257 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055707
{'0': {'precision': 0.37095460201788705, 'recall': 0.6270106680789892, 'f1-score': 0.46613344132833856, 'support': 198255}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 186691}, '2': {'precision': 0.37334669586627567, 'recall': 0.46994725585065517, 'f1-score': 0.4161141078885857, 'support': 192628}, 'accuracy': 0.3719575327144227, 'macro avg': {'precision': 0.24810043262805426, 'recall': 0.36565264130988145, 'f1-score': 0.2940825164056414, 'support': 577574}, 'weighted avg': {'precision': 0.2518476107899337, 'recall': 0.3719575327144227, 'f1-score': 0.29878165184878863, 'support': 577574}}
[[124308      1  73946]
 [108693      0  77998]
 [102102      1  90525]]
Evaluating performance on  val set...
638/638 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0911887
{'0': {'precision': 0.397312653727592, 'recall': 0.6199470402896025, 'f1-score': 0.48426730204030866, 'support': 59668}, '1': {'precision': 0.4, 'recall': 4.276062601556487e-05, 'f1-score': 8.551211065267118e-05, 'support': 46772}, '2': {'precision': 0.38761588743787295, 'recall': 0.47845729252729097, 'f1-score': 0.4282724655012352, 'support': 56887}, 'accuracy': 0.3931438157806119, 'macro avg': {'precision': 0.39497618038848836, 'recall': 0.36614903114763636, 'f1-score': 0.30420842655073216, 'support': 163327}, 'weighted avg': {'precision': 0.39470483393006817, 'recall': 0.3931438157806119, 'f1-score': 0.3261089513402521, 'support': 163327}}
[[36991     1 22676]
 [26445     2 20325]
 [29667     2 27218]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/WBA
Evaluating performance on  test set...
5696/5696 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0769923
{'0': {'precision': 0.39778309764787295, 'recall': 0.5822799309166078, 'f1-score': 0.4726657528495042, 'support': 558745}, '1': {'precision': 0.4, 'recall': 5.863898906382854e-06, 'f1-score': 1.172762588873415e-05, 'support': 341070}, '2': {'precision': 0.40011341694317903, 'recall': 0.4588268804953028, 'f1-score': 0.4274634488283597, 'support': 558204}, 'accuracy': 0.39880618839672183, 'macro avg': {'precision': 0.39929883819701734, 'recall': 0.34703755843693895, 'f1-score': 0.30004697643458417, 'support': 1458019}, 'weighted avg': {'precision': 0.39919385596937423, 'recall': 0.39880618839672183, 'f1-score': 0.34479347183201575, 'support': 1458019}}
[[325346      0 233399]
 [190470      2 150598]
 [302082      3 256119]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122379
{'0': {'precision': 0.3549276700523238, 'recall': 0.6012774721693563, 'f1-score': 0.446368677240485, 'support': 191785}, '1': {'precision': 0.5, 'recall': 5.234451063117011e-06, 'f1-score': 1.0468792529469652e-05, 'support': 191042}, '2': {'precision': 0.352258366295196, 'recall': 0.46208373925539986, 'f1-score': 0.3997653123231984, 'support': 185791}, 'accuracy': 0.3537840870320672, 'macro avg': {'precision': 0.40239534544917327, 'recall': 0.3544554819586065, 'f1-score': 0.2820481527854043, 'support': 568618}, 'weighted avg': {'precision': 0.40279631902847896, 'recall': 0.3537840870320672, 'f1-score': 0.28117578740994514, 'support': 568618}}
[[115316      1  76468]
 [109644      1  81397]
 [ 99940      0  85851]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0776316
{'0': {'precision': 0.4138517965386981, 'recall': 0.5868512434014855, 'f1-score': 0.4853976288453984, 'support': 64219}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 39766}, '2': {'precision': 0.39176433409818495, 'recall': 0.4763201416615159, 'f1-score': 0.4299241567527631, 'support': 59861}, 'accuracy': 0.4040379380637916, 'macro avg': {'precision': 0.2685387102122943, 'recall': 0.35439046168766714, 'f1-score': 0.3051072618660538, 'support': 163846}, 'weighted avg': {'precision': 0.3053388750739725, 'recall': 0.4040379380637916, 'f1-score': 0.34732273155401894, 'support': 163846}}
[[37687     0 26532]
 [22030     0 17736]
 [31347     1 28513]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 60s - 60s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1667595
{'0': {'precision': 0.2637481476171851, 'recall': 0.6550485699910987, 'f1-score': 0.37607414920717097, 'support': 775170}, '1': {'precision': 0.6122448979591837, 'recall': 2.004460592972896e-05, 'f1-score': 4.008789940075272e-05, 'support': 1496662}, '2': {'precision': 0.2916287444190913, 'recall': 0.4153328315004192, 'f1-score': 0.3426579217094069, 'support': 817005}, 'accuracy': 0.274256297758671, 'macro avg': {'precision': 0.38920726333182004, 'recall': 0.3568004820324826, 'f1-score': 0.23959071960532619, 'support': 3088837}, 'weighted avg': {'precision': 0.4399829021058479, 'recall': 0.274256297758671, 'f1-score': 0.18503230555798494, 'support': 3088837}}
[[507774      5 267391]
 [939787     30 556845]
 [477662     14 339329]]
Evaluating performance on  train set...
2948/2948 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.11029
{'0': {'precision': 0.3522760542097559, 'recall': 0.5926798361821382, 'f1-score': 0.441897693263417, 'support': 251743}, '1': {'precision': 0.5, 'recall': 4.001472541895417e-06, 'f1-score': 8.002881037173381e-06, 'support': 249908}, '2': {'precision': 0.36183212565495654, 'recall': 0.4736165550629081, 'f1-score': 0.41024586864279755, 'support': 252829}, 'accuracy': 0.35646803096172197, 'macro avg': {'precision': 0.4047027266215708, 'recall': 0.3554334642391961, 'f1-score': 0.28405052159575056, 'support': 754480}, 'weighted avg': {'precision': 0.4044092424082064, 'recall': 0.35646803096172197, 'f1-score': 0.28492299822698613, 'support': 754480}}
[[149203      0 102540]
 [141253      1 108654]
 [133084      1 119744]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174921
{'0': {'precision': 0.3512516077965766, 'recall': 0.6003382091823793, 'f1-score': 0.44319465684591614, 'support': 59135}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 62944}, '2': {'precision': 0.3419630156472262, 'recall': 0.4695229133005451, 'f1-score': 0.39571720376203695, 'support': 56321}, 'accuracy': 0.34722533632286995, 'macro avg': {'precision': 0.23107154114793427, 'recall': 0.3566203741609748, 'f1-score': 0.2796372868693177, 'support': 178400}, 'weighted avg': {'precision': 0.22438880510828468, 'recall': 0.34722533632286995, 'f1-score': 0.27183578848466894, 'support': 178400}}
[[35501     0 23634]
 [35692     0 27252]
 [29877     0 26444]]
testing model on single stock: results/universal/W1/deepOF_L1/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 109s - 109s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.077728
{'0': {'precision': 0.39399871722461016, 'recall': 0.5997141130802737, 'f1-score': 0.47556312860049693, 'support': 2058856}, '1': {'precision': 0.2777777777777778, 'recall': 3.820208751487016e-06, 'f1-score': 7.640312427655791e-06, 'support': 1308829}, '2': {'precision': 0.4080023529774941, 'recall': 0.4534656928407402, 'f1-score': 0.42953437581741466, 'support': 2098527}, 'accuracy': 0.3999735099919286, 'macro avg': {'precision': 0.3599262826599607, 'recall': 0.3510612087099218, 'f1-score': 0.3017017149101131, 'support': 5466212}, 'weighted avg': {'precision': 0.37154691180073235, 'recall': 0.3999735099919286, 'f1-score': 0.3440253480182201, 'support': 5466212}}
[[1234725       8  824123]
 [ 752193       5  556631]
 [1146912       5  951610]]
Evaluating performance on  train set...
6073/6073 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.110913
{'0': {'precision': 0.3465341107782232, 'recall': 0.6129835427255046, 'f1-score': 0.4427635200340636, 'support': 515699}, '1': {'precision': 0.5, 'recall': 1.9468320175993615e-06, 'f1-score': 3.893648874638134e-06, 'support': 513655}, '2': {'precision': 0.35877552418375547, 'recall': 0.4387917722615618, 'f1-score': 0.3947698176750767, 'support': 525199}, 'accuracy': 0.35159238700771217, 'macro avg': {'precision': 0.4017698783206596, 'recall': 0.3505924206063613, 'f1-score': 0.2791790771193383, 'support': 1554553}, 'weighted avg': {'precision': 0.4013779786987019, 'recall': 0.35159238700771217, 'f1-score': 0.2802525343191206, 'support': 1554553}}
[[316115      1 199583]
 [301358      1 212296]
 [294746      0 230453]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044112
{'0': {'precision': 0.3556813883797387, 'recall': 0.6251502134949247, 'f1-score': 0.45339953455165827, 'support': 156444}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 142220}, '2': {'precision': 0.3686018625734685, 'recall': 0.4236917137666532, 'f1-score': 0.3942315311270172, 'support': 158528}, 'accuracy': 0.36082871091357677, 'macro avg': {'precision': 0.24142775031773575, 'recall': 0.3496139757538593, 'f1-score': 0.28254368855955847, 'support': 457192}, 'weighted avg': {'precision': 0.24951865998032918, 'recall': 0.36082871091357677, 'f1-score': 0.29184319268470005, 'support': 457192}}
[[97801     0 58643]
 [85809     0 56411]
 [91358     3 67167]]
training model: results/universal/W1/deepOF_L1/h1000
Epoch 1/50
10622/10622 - 155s - loss: 3.2829 - accuracy1000: 0.3696 - val_loss: 3.2969 - val_accuracy1000: 0.3473 - 155s/epoch - 15ms/step
Epoch 2/50
10622/10622 - 142s - loss: 3.2817 - accuracy1000: 0.3674 - val_loss: 3.3001 - val_accuracy1000: 0.3323 - 142s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 141s - loss: 3.2788 - accuracy1000: 0.3713 - val_loss: 3.3003 - val_accuracy1000: 0.3310 - 141s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 144s - loss: 3.2766 - accuracy1000: 0.3735 - val_loss: 3.3006 - val_accuracy1000: 0.3314 - 144s/epoch - 14ms/step
Epoch 5/50
10622/10622 - 143s - loss: 3.2752 - accuracy1000: 0.3748 - val_loss: 3.3006 - val_accuracy1000: 0.3306 - 143s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 142s - loss: 3.2735 - accuracy1000: 0.3765 - val_loss: 3.3007 - val_accuracy1000: 0.3313 - 142s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 141s - loss: 3.2723 - accuracy1000: 0.3775 - val_loss: 3.3011 - val_accuracy1000: 0.3329 - 141s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 140s - loss: 3.2713 - accuracy1000: 0.3787 - val_loss: 3.3004 - val_accuracy1000: 0.3351 - 140s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 149s - loss: 3.2700 - accuracy1000: 0.3795 - val_loss: 3.3002 - val_accuracy1000: 0.3365 - 149s/epoch - 14ms/step
Epoch 10/50
10622/10622 - 144s - loss: 3.2692 - accuracy1000: 0.3802 - val_loss: 3.2999 - val_accuracy1000: 0.3366 - 144s/epoch - 14ms/step
Epoch 11/50
10622/10622 - 141s - loss: 3.2687 - accuracy1000: 0.3807 - val_loss: 3.2999 - val_accuracy1000: 0.3360 - 141s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 184s - 184s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999837
{'0': {'precision': 0.3534099864455231, 'recall': 0.9778610510107416, 'f1-score': 0.5191818210717507, 'support': 3190034}, '1': {'precision': 0.29529942193905945, 'recall': 0.009874613448113087, 'f1-score': 0.01911019487224715, 'support': 2633217}, '2': {'precision': 0.36526393083974895, 'recall': 0.014968489268668731, 'f1-score': 0.028758458983837186, 'support': 3223505}, 'accuracy': 0.3530174794147206, 'macro avg': {'precision': 0.3379911130747772, 'recall': 0.3342347179091745, 'f1-score': 0.18901682497594505, 'support': 9046756}, 'weighted avg': {'precision': 0.3407196389537252, 'recall': 0.3530174794147206, 'f1-score': 0.1988814540525255, 'support': 9046756}}
[[3119410   29004   41620]
 [2564987   26002   42228]
 [3142207   33047   48251]]
Evaluating performance on  train set...
10622/10622 - 67s - 67s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099556
{'0': {'precision': 0.3314675128202905, 'recall': 0.9774834216216517, 'f1-score': 0.49505904318122057, 'support': 899515}, '1': {'precision': 0.3358109994416527, 'recall': 0.010623628991036761, 'f1-score': 0.020595697868410548, 'support': 905811}, '2': {'precision': 0.355174081237911, 'recall': 0.014477898782831518, 'f1-score': 0.02782170623384248, 'support': 913185}, 'accuracy': 0.33183790685415654, 'macro avg': {'precision': 0.3408175311666181, 'recall': 0.33419498313184, 'f1-score': 0.1811588157611579, 'support': 2718511}, 'weighted avg': {'precision': 0.340878127910841, 'recall': 0.33183790685415654, 'f1-score': 0.18001590198317752, 'support': 2718511}}
[[879261   9136  11118]
 [883303   9623  12885]
 [890067   9897  13221]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991868
{'0': {'precision': 0.34719816043548235, 'recall': 0.9762618377837018, 'f1-score': 0.5122275167182325, 'support': 271588}, '1': {'precision': 0.320490964882373, 'recall': 0.011487089244907187, 'f1-score': 0.022179227030343068, 'support': 245493}, '2': {'precision': 0.3681745891500265, 'recall': 0.015624589887324472, 'f1-score': 0.029977015463305674, 'support': 266695}, 'accuracy': 0.3472012411709468, 'macro avg': {'precision': 0.34528790482262733, 'recall': 0.33445783897197784, 'f1-score': 0.18812791973729373, 'support': 783776}, 'weighted avg': {'precision': 0.3459706146801975, 'recall': 0.3472012411709468, 'f1-score': 0.19464032061560654, 'support': 783776}}
[[265141   2904   3543]
 [239065   2820   3608]
 [259453   3075   4167]]
testing model out of sample: results/universal/W1/deepOF_L1/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 147s - 147s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998324
{'0': {'precision': 0.347942016291673, 'recall': 0.9719440668127612, 'f1-score': 0.5124384333747121, 'support': 2115524}, '1': {'precision': 0.33155352796503257, 'recall': 0.014080162437603093, 'f1-score': 0.027013150975356653, 'support': 1847848}, '2': {'precision': 0.37979420018709076, 'recall': 0.019769650608507636, 'f1-score': 0.037582972663247255, 'support': 2135799}, 'accuracy': 0.348311762369017, 'macro avg': {'precision': 0.35309658148126544, 'recall': 0.335264626619624, 'f1-score': 0.192344852337772, 'support': 6099171}, 'weighted avg': {'precision': 0.35413079623147853, 'recall': 0.348311762369017, 'f1-score': 0.19908634743333248, 'support': 6099171}}
[[2056171   23991   35362]
 [1788240   26018   33590]
 [2065111   28464   42224]]
Evaluating performance on  train set...
6711/6711 - 49s - 49s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988891
{'0': {'precision': 0.33928332704693787, 'recall': 0.9777850780256996, 'f1-score': 0.5037645320952224, 'support': 581411}, '1': {'precision': 0.3348558378532686, 'recall': 0.010421682786365277, 'f1-score': 0.02021423992389933, 'support': 562769}, '2': {'precision': 0.3672000992432701, 'recall': 0.01549484028798068, 'f1-score': 0.029734947101596073, 'support': 573094}, 'accuracy': 0.3396312993733091, 'macro avg': {'precision': 0.3471130880478255, 'recall': 0.3345672003666818, 'f1-score': 0.18457123970690595, 'support': 1717274}, 'weighted avg': {'precision': 0.3471488633440301, 'recall': 0.3396312993733091, 'f1-score': 0.1871053237468164, 'support': 1717274}}
[[568495   5617   7299]
 [548900   5865   8004]
 [558181   6033   8880]]
Evaluating performance on  val set...
1720/1720 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982419
{'0': {'precision': 0.3643939482310124, 'recall': 0.9774768291080224, 'f1-score': 0.5308806884807945, 'support': 159791}, '1': {'precision': 0.304287045666356, 'recall': 0.010061633281972265, 'f1-score': 0.019479163559347312, 'support': 129800}, '2': {'precision': 0.38431542461005197, 'recall': 0.017709303873286304, 'f1-score': 0.03385840798045603, 'support': 150260}, 'accuracy': 0.3641210318948917, 'macro avg': {'precision': 0.3509988061691401, 'recall': 0.33508258875442704, 'f1-score': 0.19473942000686595, 'support': 439851}, 'weighted avg': {'precision': 0.3534618941668454, 'recall': 0.3641210318948917, 'f1-score': 0.21017552740855708, 'support': 439851}}
[[156192   1397   2202]
 [126433   1306   2061]
 [146010   1589   2661]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964636
{'0': {'precision': 0.33598123590006806, 'recall': 0.989141320963576, 'f1-score': 0.5015882067297197, 'support': 56913}, '1': {'precision': 0.41117216117216115, 'recall': 0.006971400180107444, 'f1-score': 0.013710342300528262, 'support': 64406}, '2': {'precision': 0.3423336547733848, 'recall': 0.007340170374658837, 'f1-score': 0.014372178700836015, 'support': 48364}, 'accuracy': 0.33650395148600626, 'macro avg': {'precision': 0.3631623506152047, 'recall': 0.3344842971727808, 'f1-score': 0.1765569092436947, 'support': 169683}, 'weighted avg': {'precision': 0.3663318020703003, 'recall': 0.33650395148600626, 'f1-score': 0.17753701883219647, 'support': 169683}}
[[56295   330   288]
 [63563   449   394]
 [47696   313   355]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008753
{'0': {'precision': 0.32097430194829923, 'recall': 0.9870707827797817, 'f1-score': 0.48442421316412626, 'support': 21347}, '1': {'precision': 0.328042328042328, 'recall': 0.008403741020196087, 'f1-score': 0.016387665198237884, 'support': 22133}, '2': {'precision': 0.39805825242718446, 'recall': 0.0053378466345527925, 'f1-score': 0.0105344295991778, 'support': 23043}, 'accuracy': 0.3213926010552741, 'macro avg': {'precision': 0.34902496080593726, 'recall': 0.33360412347817686, 'f1-score': 0.170448769320514, 'support': 66523}, 'weighted avg': {'precision': 0.3500271422054147, 'recall': 0.3213926010552741, 'f1-score': 0.1645514593975175, 'support': 66523}}
[[21071   192    84]
 [21845   186   102]
 [22731   189   123]]
Evaluating performance on  val set...
51/51 - 0s - 490ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0948411
{'0': {'precision': 0.3289961359514234, 'recall': 0.9865216363206432, 'f1-score': 0.4934358367829687, 'support': 4229}, '1': {'precision': 0.36607142857142855, 'recall': 0.007773985589685248, 'f1-score': 0.015224656516895656, 'support': 5274}, '2': {'precision': 0.2962962962962963, 'recall': 0.004784688995215311, 'f1-score': 0.009417304296645085, 'support': 3344}, 'accuracy': 0.3291819101735814, 'macro avg': {'precision': 0.3304546202730494, 'recall': 0.3330267703018479, 'f1-score': 0.1726925991988365, 'support': 12847}, 'weighted avg': {'precision': 0.33570484845015164, 'recall': 0.3291819101735814, 'f1-score': 0.17113150601644458, 'support': 12847}}
[[4172   39   18]
 [5213   41   20]
 [3296   32   16]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0973651
{'0': {'precision': 0.41834853447960935, 'recall': 0.9787917811029185, 'f1-score': 0.5861631829217732, 'support': 175498}, '1': {'precision': 0.21009389671361503, 'recall': 0.010492133830390847, 'f1-score': 0.019986154842455507, 'support': 85302}, '2': {'precision': 0.4201954397394137, 'recall': 0.01610436628070285, 'f1-score': 0.0310198683459076, 'support': 160205}, 'accuracy': 0.41626821534186054, 'macro avg': {'precision': 0.34954595697754604, 'recall': 0.3351294270713374, 'f1-score': 0.21238973537004543, 'support': 421005}, 'weighted avg': {'precision': 0.37685578818546106, 'recall': 0.41626821534186054, 'f1-score': 0.26019848520832917, 'support': 421005}}
[[171776   1628   2094]
 [ 82941    895   1466]
 [155888   1737   2580]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096632
{'0': {'precision': 0.3587554286979737, 'recall': 0.9757729888903761, 'f1-score': 0.5246255566050465, 'support': 59768}, '1': {'precision': 0.3170212765957447, 'recall': 0.011114219114219115, 'f1-score': 0.021475542743896948, 'support': 53625}, '2': {'precision': 0.34006462035541196, 'recall': 0.015730966837926203, 'f1-score': 0.030070891591221588, 'support': 53525}, 'accuracy': 0.35800812374938595, 'macro avg': {'precision': 0.33861377521637676, 'recall': 0.33420605828084043, 'f1-score': 0.19205733031338834, 'support': 166918}, 'weighted avg': {'precision': 0.3393541692591016, 'recall': 0.35800812374938595, 'f1-score': 0.20439371858776184, 'support': 166918}}
[[58320   680   768]
 [52163   596   866]
 [52079   604   842]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097029
{'0': {'precision': 0.4328923337342421, 'recall': 0.9755558901771821, 'f1-score': 0.5996822017556039, 'support': 19923}, '1': {'precision': 0.23861566484517305, 'recall': 0.014532948746394497, 'f1-score': 0.0273972602739726, 'support': 9014}, '2': {'precision': 0.43534994068801897, 'recall': 0.021149080850573387, 'f1-score': 0.04033853594196527, 'support': 17353}, 'accuracy': 0.43063296608338736, 'macro avg': {'precision': 0.368952646422478, 'recall': 0.33707930659138335, 'f1-score': 0.22247266599051393, 'support': 46290}, 'weighted avg': {'precision': 0.39598235231499, 'recall': 0.43063296608338736, 'f1-score': 0.2785573995223031, 'support': 46290}}
[[19436   191   296]
 [ 8703   131   180]
 [16759   227   367]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996423
{'0': {'precision': 0.3549472513233011, 'recall': 0.9753359086328519, 'f1-score': 0.5204798652003622, 'support': 119080}, '1': {'precision': 0.28975699784681636, 'recall': 0.009510348308934881, 'f1-score': 0.018416242265471502, 'support': 99050}, '2': {'precision': 0.38295670174228047, 'recall': 0.01879285532887497, 'f1-score': 0.035827543634559054, 'support': 118130}, 'accuracy': 0.35479985725331586, 'macro avg': {'precision': 0.34255365030413265, 'recall': 0.33454637075688726, 'f1-score': 0.19157455036679757, 'support': 336260}, 'weighted avg': {'precision': 0.34558444210171135, 'recall': 0.35479985725331586, 'f1-score': 0.2023290872360808, 'support': 336260}}
[[116143   1098   1839]
 [ 96370    942   1738]
 [114699   1211   2220]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097726
{'0': {'precision': 0.3479013745651807, 'recall': 0.9764941181530785, 'f1-score': 0.5130244671295328, 'support': 46499}, '1': {'precision': 0.3569277108433735, 'recall': 0.01069470454186503, 'f1-score': 0.020767158097658216, 'support': 44321}, '2': {'precision': 0.3391544117647059, 'recall': 0.017084124265012268, 'f1-score': 0.03252964252655705, 'support': 43198}, 'accuracy': 0.34784879643033023, 'macro avg': {'precision': 0.3479944990577533, 'recall': 0.33475764898665195, 'f1-score': 0.188773755917916, 'support': 134018}, 'weighted avg': {'precision': 0.3480670608993363, 'recall': 0.34784879643033023, 'f1-score': 0.19535257509412665, 'support': 134018}}
[[45406   418   675]
 [43084   474   763]
 [42024   436   738]]
Evaluating performance on  val set...
107/107 - 1s - 669ms/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0957942
{'0': {'precision': 0.38829666591063733, 'recall': 0.9759619952494062, 'f1-score': 0.5555585602639336, 'support': 10525}, '1': {'precision': 0.33076923076923076, 'recall': 0.010931740180500827, 'f1-score': 0.021164021164021166, 'support': 7867}, '2': {'precision': 0.3442982456140351, 'recall': 0.017885623148781043, 'f1-score': 0.034004764998917046, 'support': 8778}, 'accuracy': 0.38700772911299225, 'macro avg': {'precision': 0.35445471409796775, 'recall': 0.33492645285956263, 'f1-score': 0.20357578214229058, 'support': 27170}, 'weighted avg': {'precision': 0.3574248784383878, 'recall': 0.38700772911299225, 'f1-score': 0.23232407171276223, 'support': 27170}}
[[10272    97   156]
 [ 7638    86   143]
 [ 8544    77   157]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010077
{'0': {'precision': 0.34018147734281023, 'recall': 0.9823665811445852, 'f1-score': 0.5053622251703689, 'support': 113421}, '1': {'precision': 0.31296992481203006, 'recall': 0.009754335260115607, 'f1-score': 0.018919021286266192, 'support': 102416}, '2': {'precision': 0.3767441860465116, 'recall': 0.009618402191706461, 'f1-score': 0.018757908840532963, 'support': 117899}, 'accuracy': 0.34025097682000144, 'macro avg': {'precision': 0.34329852940045064, 'recall': 0.3339131061988024, 'f1-score': 0.1810130517657227, 'support': 333736}, 'weighted avg': {'precision': 0.3447473870123254, 'recall': 0.34025097682000144, 'f1-score': 0.18418102368187023, 'support': 333736}}
[[111421   1044    956]
 [100497    999    920]
 [115616   1149   1134]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003885
{'0': {'precision': 0.3286758917843974, 'recall': 0.9835725134054489, 'f1-score': 0.492706368244948, 'support': 32263}, '1': {'precision': 0.3157894736842105, 'recall': 0.00887409872434831, 'f1-score': 0.017263082179464127, 'support': 32454}, '2': {'precision': 0.36942675159235666, 'recall': 0.008649486995943688, 'f1-score': 0.0169032145251071, 'support': 33528}, 'accuracy': 0.3288818769403023, 'macro avg': {'precision': 0.3379640390203215, 'recall': 0.3336986997085803, 'f1-score': 0.17562422164983973, 'support': 98245}, 'weighted avg': {'precision': 0.3383260420680535, 'recall': 0.3288818769403023, 'f1-score': 0.173272661248276, 'support': 98245}}
[[31733   286   244]
 [31915   288   251]
 [32900   338   290]]
Evaluating performance on  val set...
93/93 - 1s - 620ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043183
{'0': {'precision': 0.2762163795708673, 'recall': 0.980386147716825, 'f1-score': 0.43100138098285556, 'support': 6526}, '1': {'precision': 0.39759036144578314, 'recall': 0.011075064324868553, 'f1-score': 0.02154984762734001, 'support': 8939}, '2': {'precision': 0.3697916666666667, 'recall': 0.00872343039685465, 'f1-score': 0.01704477253631017, 'support': 8139}, 'accuracy': 0.27825792238603625, 'macro avg': {'precision': 0.34786613589443904, 'recall': 0.33339488081284946, 'f1-score': 0.15653200038216858, 'support': 23604}, 'weighted avg': {'precision': 0.3544476660330171, 'recall': 0.27825792238603625, 'f1-score': 0.13320100423266973, 'support': 23604}}
[[6398   69   59]
 [8778   99   62]
 [7987   81   71]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996815
{'0': {'precision': 0.3532777115613826, 'recall': 0.9760356915232632, 'f1-score': 0.5187815825875843, 'support': 235350}, '1': {'precision': 0.30936967632027257, 'recall': 0.009098287557991563, 'f1-score': 0.017676718515778612, 'support': 199598}, '2': {'precision': 0.365947199429183, 'recall': 0.017658020563008105, 'f1-score': 0.03369038185990944, 'support': 232359}, 'accuracy': 0.3531043432782812, 'macro avg': {'precision': 0.3428648624369461, 'recall': 0.33426399988142097, 'f1-score': 0.19004956098775747, 'support': 667307}, 'weighted avg': {'precision': 0.34455595907477476, 'recall': 0.3531043432782812, 'f1-score': 0.19998553373917408, 'support': 667307}}
[[229710   1917   3723]
 [194396   1816   3386]
 [226119   2137   4103]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994467
{'0': {'precision': 0.34122018098591156, 'recall': 0.9751092744178653, 'f1-score': 0.505537518334789, 'support': 62915}, '1': {'precision': 0.33438818565400846, 'recall': 0.010568075743432458, 'f1-score': 0.020488624612202692, 'support': 59992}, '2': {'precision': 0.35986622073578595, 'recall': 0.017418895292365472, 'f1-score': 0.03322936289799574, 'support': 61772}, 'accuracy': 0.34145192469095026, 'macro avg': {'precision': 0.34515819579190193, 'recall': 0.33436541515122103, 'f1-score': 0.18641850194832912, 'support': 184679}, 'weighted avg': {'precision': 0.3452376280344536, 'recall': 0.34145192469095026, 'f1-score': 0.18999285646285452, 'support': 184679}}
[[61349   622   944]
 [58388   634   970]
 [60056   640  1076]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005005
{'0': {'precision': 0.3381092377444035, 'recall': 0.9743288761865877, 'f1-score': 0.5020116227089853, 'support': 19594}, '1': {'precision': 0.3510436432637571, 'recall': 0.009872985377308144, 'f1-score': 0.019205813651699974, 'support': 18738}, '2': {'precision': 0.3539426523297491, 'recall': 0.019974715549936788, 'f1-score': 0.03781532717438131, 'support': 19775}, 'accuracy': 0.33853064174712166, 'macro avg': {'precision': 0.34769851111263655, 'recall': 0.3347255257046109, 'f1-score': 0.18634425451168882, 'support': 58107}, 'weighted avg': {'precision': 0.34766868263136813, 'recall': 0.33853064174712166, 'f1-score': 0.1883437858853288, 'support': 58107}}
[[19091   165   338]
 [18170   185   383]
 [19203   177   395]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975256
{'0': {'precision': 0.25659825716296003, 'recall': 0.9639780669113182, 'f1-score': 0.4053086841584692, 'support': 350703}, '1': {'precision': 0.47663809787116396, 'recall': 0.010359145070092475, 'f1-score': 0.020277581745471653, 'support': 665692}, '2': {'precision': 0.2743723644893742, 'recall': 0.027960465467046492, 'f1-score': 0.050749229076596465, 'support': 351389}, 'accuracy': 0.2593911026887286, 'macro avg': {'precision': 0.3358695731744994, 'recall': 0.33409922581615237, 'f1-score': 0.1587784983268458, 'support': 1367784}, 'weighted avg': {'precision': 0.36825652150882676, 'recall': 0.2593911026887286, 'f1-score': 0.12682873630904462, 'support': 1367784}}
[[338070   3486   9147]
 [641959   6896  16837]
 [337478   4086   9825]]
Evaluating performance on  train set...
1290/1290 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003127
{'0': {'precision': 0.32300141659040477, 'recall': 0.9701413859969501, 'f1-score': 0.48464414192001126, 'support': 106234}, '1': {'precision': 0.3387856944829498, 'recall': 0.011163181598107192, 'f1-score': 0.02161416417567257, 'support': 109467}, '2': {'precision': 0.36389111289031223, 'recall': 0.02382158705754918, 'f1-score': 0.04471591374928261, 'support': 114476}, 'accuracy': 0.3241019210908089, 'macro avg': {'precision': 0.34189274132122227, 'recall': 0.3350420515508688, 'f1-score': 0.18365807328165548, 'support': 330177}, 'weighted avg': {'precision': 0.34241144945668994, 'recall': 0.3241019210908089, 'f1-score': 0.17860305964652806, 'support': 330177}}
[[103062   1011   2161]
 [105639   1222   2606]
 [110375   1374   2727]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982404
{'0': {'precision': 0.31319268260114835, 'recall': 0.9713556046383214, 'f1-score': 0.4736629531150079, 'support': 28976}, '1': {'precision': 0.4398854961832061, 'recall': 0.013093986991223336, 'f1-score': 0.025430975037925803, 'support': 35207}, '2': {'precision': 0.3112033195020747, 'recall': 0.020934370747705943, 'f1-score': 0.039229788486057085, 'support': 28661}, 'accuracy': 0.31458144845116537, 'macro avg': {'precision': 0.3547604994288098, 'recall': 0.33512798745908357, 'f1-score': 0.1794412388796636, 'support': 92844}, 'weighted avg': {'precision': 0.3606212375104689, 'recall': 0.31458144845116537, 'f1-score': 0.16958092106565428, 'support': 92844}}
[[28146   268   562]
 [33980   461   766]
 [27742   319   600]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988207
{'0': {'precision': 0.4045288962059098, 'recall': 0.9709170478874456, 'f1-score': 0.5711078699618468, 'support': 741259}, '1': {'precision': 0.23139583771284422, 'recall': 0.010894200316706255, 'f1-score': 0.02080871858370275, 'support': 404160}, '2': {'precision': 0.39258479472103114, 'recall': 0.02210607736404184, 'f1-score': 0.04185532129228646, 'support': 691665}, 'accuracy': 0.40248241234478116, 'macro avg': {'precision': 0.34283650954659506, 'recall': 0.3346391085227312, 'f1-score': 0.21125730327927864, 'support': 1837084}, 'weighted avg': {'precision': 0.361942507192617, 'recall': 0.40248241234478116, 'f1-score': 0.2507771887863958, 'support': 1837084}}
[[719701   7058  14500]
 [390600   4403   9157]
 [668808   7567  15290]]
Evaluating performance on  train set...
2257/2257 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982181
{'0': {'precision': 0.3440404878688897, 'recall': 0.9786377599661029, 'f1-score': 0.5091049360443681, 'support': 198247}, '1': {'precision': 0.33502824858757063, 'recall': 0.009505947228367157, 'f1-score': 0.018487342561416636, 'support': 187146}, '2': {'precision': 0.37700791177175735, 'recall': 0.016364781117800407, 'f1-score': 0.03136797275125547, 'support': 192181}, 'accuracy': 0.3444337868394353, 'macro avg': {'precision': 0.35202554940940584, 'recall': 0.33483616277075684, 'f1-score': 0.18632008378568007, 'support': 577574}, 'weighted avg': {'precision': 0.3520898598290806, 'recall': 0.3444337868394353, 'f1-score': 0.1911732294706752, 'support': 577574}}
[[194012   1605   2630]
 [182800   1779   2567]
 [187110   1926   3145]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981739
{'0': {'precision': 0.40976908742949236, 'recall': 0.9764479980798367, 'f1-score': 0.5772807293722202, 'support': 66661}, '1': {'precision': 0.22521957340025095, 'recall': 0.010368530499075785, 'f1-score': 0.019824396708818817, 'support': 34624}, '2': {'precision': 0.42357019064124785, 'recall': 0.019696334740981914, 'f1-score': 0.03764227517057618, 'support': 62042}, 'accuracy': 0.4082117469861076, 'macro avg': {'precision': 0.3528529504903304, 'recall': 0.33550428777329816, 'f1-score': 0.21158246708387174, 'support': 163327}, 'weighted avg': {'precision': 0.375888624748584, 'recall': 0.4082117469861076, 'f1-score': 0.2541154410995157, 'support': 163327}}
[[65091   575   995]
 [33597   359   668]
 [60160   660  1222]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100251
{'0': {'precision': 0.34749676495788273, 'recall': 0.9744085107224425, 'f1-score': 0.512296624354136, 'support': 505715}, '1': {'precision': 0.30700937925109184, 'recall': 0.009700106547345703, 'f1-score': 0.01880602775292528, 'support': 442057}, '2': {'precision': 0.3682995343825759, 'recall': 0.018757582112192722, 'f1-score': 0.03569710238440681, 'support': 510247}, 'accuracy': 0.3474796967666402, 'macro avg': {'precision': 0.34093522619718347, 'recall': 0.334288733127327, 'f1-score': 0.18893325149715604, 'support': 1458019}, 'weighted avg': {'precision': 0.3425015066157449, 'recall': 0.3474796967666402, 'f1-score': 0.1958848019099636, 'support': 1458019}}
[[492773   4493   8449]
 [429802   4288   7967]
 [495490   5186   9571]]
Evaluating performance on  train set...
2222/2222 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981835
{'0': {'precision': 0.3343152171561664, 'recall': 0.9772716493731655, 'f1-score': 0.49820075515897694, 'support': 189763}, '1': {'precision': 0.34273676497527017, 'recall': 0.009493606657195048, 'f1-score': 0.018475454110072627, 'support': 197080}, '2': {'precision': 0.356626791424849, 'recall': 0.016564434053087607, 'f1-score': 0.031658412978792745, 'support': 181775}, 'accuracy': 0.3347273565029598, 'macro avg': {'precision': 0.3445595911854285, 'recall': 0.334443230027816, 'f1-score': 0.18277820741594744, 'support': 568618}, 'weighted avg': {'precision': 0.34436661380009737, 'recall': 0.3347273565029598, 'f1-score': 0.18278689808705686, 'support': 568618}}
[[185450   1747   2566]
 [192343   1871   2866]
 [176923   1841   3011]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097384
{'0': {'precision': 0.35699601976993395, 'recall': 0.9791602399314482, 'f1-score': 0.5232266897445408, 'support': 58350}, '1': {'precision': 0.30538922155688625, 'recall': 0.008841715947835803, 'f1-score': 0.017185861914033252, 'support': 51913}, '2': {'precision': 0.3788010425716768, 'recall': 0.016273818188604596, 'f1-score': 0.031206942829023893, 'support': 53583}, 'accuracy': 0.356828973548332, 'macro avg': {'precision': 0.3470620946328323, 'recall': 0.3347585913559628, 'f1-score': 0.19053983149586598, 'support': 163846}, 'weighted avg': {'precision': 0.34777586682846356, 'recall': 0.356828973548332, 'f1-score': 0.2019860638266711, 'support': 163846}}
[[57134   505   711]
 [50735   459   719]
 [52172   539   872]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 74s - 74s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006835
{'0': {'precision': 0.3130231363208383, 'recall': 0.9705085147083564, 'f1-score': 0.4733683331556242, 'support': 962922}, '1': {'precision': 0.37436188315371527, 'recall': 0.017101072148386964, 'f1-score': 0.0327080224920752, 'support': 1080634}, '2': {'precision': 0.3711338296847798, 'recall': 0.019170921503404346, 'f1-score': 0.0364585749698665, 'support': 1045281}, 'accuracy': 0.3150192127328182, 'macro avg': {'precision': 0.35283961638644445, 'recall': 0.3355935027867159, 'f1-score': 0.18084497687252196, 'support': 3088837}, 'weighted avg': {'precision': 0.35414759158188097, 'recall': 0.3150192127328182, 'f1-score': 0.17134981191291682, 'support': 3088837}}
[[ 934524   13543   14855]
 [1043054   18480   19100]
 [1007901   17341   20039]]
Evaluating performance on  train set...
2948/2948 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992554
{'0': {'precision': 0.3353385400735469, 'recall': 0.9772863238551047, 'f1-score': 0.4993380486402669, 'support': 252403}, '1': {'precision': 0.3313973748402834, 'recall': 0.01144969238733912, 'f1-score': 0.022134638808934542, 'support': 249177}, '2': {'precision': 0.3698230604705425, 'recall': 0.015041518386714116, 'f1-score': 0.028907312699003745, 'support': 252900}, 'accuracy': 0.33576370480330825, 'macro avg': {'precision': 0.34551965846145755, 'recall': 0.33459251154305264, 'f1-score': 0.1834600000494017, 'support': 754480}, 'weighted avg': {'precision': 0.34559605184201164, 'recall': 0.33576370480330825, 'f1-score': 0.18404798505861147, 'support': 754480}}
[[246670   2678   3055]
 [242897   2853   3427]
 [246018   3078   3804]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981153
{'0': {'precision': 0.33063909234525346, 'recall': 0.9791432751522575, 'f1-score': 0.49434631554988684, 'support': 58782}, '1': {'precision': 0.36764705882352944, 'recall': 0.010664012512441349, 'f1-score': 0.02072682050573442, 'support': 63297}, '2': {'precision': 0.34431498593812776, 'recall': 0.015216349141528028, 'f1-score': 0.029144703281754804, 'support': 56321}, 'accuracy': 0.33121076233183855, 'macro avg': {'precision': 0.3475337123689702, 'recall': 0.33500787893540895, 'f1-score': 0.181405946445792, 'support': 178400}, 'weighted avg': {'precision': 0.3480871487198034, 'recall': 0.33121076233183855, 'f1-score': 0.17943985152318742, 'support': 178400}}
[[57556   529   697]
 [61687   675   935]
 [54832   632   857]]
testing model on single stock: results/universal/W1/deepOF_L1/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 108s - 108s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006635
{'0': {'precision': 0.3746558275385802, 'recall': 0.980656791690896, 'f1-score': 0.542175696749819, 'support': 2044697}, '1': {'precision': 0.2527628760449643, 'recall': 0.009967482713511493, 'f1-score': 0.01917867131534416, 'support': 1337750}, '2': {'precision': 0.4087427428404157, 'recall': 0.01206182079073216, 'f1-score': 0.02343216846847183, 'support': 2083765}, 'accuracy': 0.3738629237212168, 'macro avg': {'precision': 0.3453871488079867, 'recall': 0.33422869839837993, 'f1-score': 0.19492884551121167, 'support': 5466212}, 'weighted avg': {'precision': 0.3578190903617829, 'recall': 0.3738629237212168, 'f1-score': 0.21643295589305206, 'support': 5466212}}
[[2005146   18462   21089]
 [1309148   13334   15268]
 [2037674   20957   25134]]
Evaluating performance on  train set...
6073/6073 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001072
{'0': {'precision': 0.32956471429953643, 'recall': 0.9789261506157537, 'f1-score': 0.49311695755539225, 'support': 511487}, '1': {'precision': 0.3340434345227528, 'recall': 0.010999931798474234, 'f1-score': 0.02129851117936025, 'support': 513185}, '2': {'precision': 0.35863346591837847, 'recall': 0.012421656938067226, 'f1-score': 0.024011644662680534, 'support': 529881}, 'accuracy': 0.32995658559084184, 'macro avg': {'precision': 0.34074720491355587, 'recall': 0.3341159131174318, 'f1-score': 0.17947570446581104, 'support': 1554553}, 'weighted avg': {'precision': 0.34095151887570396, 'recall': 0.32995658559084184, 'f1-score': 0.17746342775976162, 'support': 1554553}}
[[500708   5305   5474]
 [501243   5645   6297]
 [517350   5949   6582]]
Evaluating performance on  val set...
1786/1786 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000034
{'0': {'precision': 0.34566478662542705, 'recall': 0.975147801511916, 'f1-score': 0.51040436737997, 'support': 157813}, '1': {'precision': 0.3043177892918826, 'recall': 0.012548070075487822, 'f1-score': 0.02410231858286027, 'support': 140420}, '2': {'precision': 0.36941442168091626, 'recall': 0.014406230537434181, 'f1-score': 0.02773102120393805, 'support': 158959}, 'accuracy': 0.34546317520866504, 'macro avg': {'precision': 0.33979899919940865, 'recall': 0.33403403404161275, 'f1-score': 0.18741256905558942, 'support': 457192}, 'weighted avg': {'precision': 0.34122304852241825, 'recall': 0.34546317520866504, 'f1-score': 0.19322513824453888, 'support': 457192}}
[[153891   1933   1989]
 [136738   1762   1920]
 [154574   2095   2290]]
training model: results/universal/W1/deepLOB_L2/h300
Epoch 1/50
10622/10622 - 422s - loss: 3.2435 - accuracy300: 0.4010 - val_loss: 3.4237 - val_accuracy300: 0.3319 - 422s/epoch - 40ms/step
Epoch 2/50
10622/10622 - 425s - loss: 3.2165 - accuracy300: 0.4154 - val_loss: 3.4701 - val_accuracy300: 0.3234 - 425s/epoch - 40ms/step
Epoch 3/50
10622/10622 - 427s - loss: 3.2029 - accuracy300: 0.4222 - val_loss: 3.5727 - val_accuracy300: 0.3192 - 427s/epoch - 40ms/step
Epoch 4/50
10622/10622 - 431s - loss: 3.1927 - accuracy300: 0.4273 - val_loss: 3.6480 - val_accuracy300: 0.3292 - 431s/epoch - 41ms/step
Epoch 5/50
10622/10622 - 433s - loss: 3.1871 - accuracy300: 0.4295 - val_loss: 3.6966 - val_accuracy300: 0.3289 - 433s/epoch - 41ms/step
Epoch 6/50
10622/10622 - 429s - loss: 3.1801 - accuracy300: 0.4325 - val_loss: 4.0085 - val_accuracy300: 0.3302 - 429s/epoch - 40ms/step
Epoch 7/50
10622/10622 - 433s - loss: 3.1748 - accuracy300: 0.4349 - val_loss: 4.2058 - val_accuracy300: 0.3307 - 433s/epoch - 41ms/step
Epoch 8/50
10622/10622 - 431s - loss: 3.1702 - accuracy300: 0.4364 - val_loss: 4.2827 - val_accuracy300: 0.3313 - 431s/epoch - 41ms/step
Epoch 9/50
10622/10622 - 430s - loss: 3.1667 - accuracy300: 0.4378 - val_loss: 4.3924 - val_accuracy300: 0.3309 - 430s/epoch - 41ms/step
Epoch 10/50
10622/10622 - 430s - loss: 3.1631 - accuracy300: 0.4389 - val_loss: 3.8397 - val_accuracy300: 0.3287 - 430s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 428s - loss: 3.1605 - accuracy300: 0.4399 - val_loss: 4.6773 - val_accuracy300: 0.3311 - 428s/epoch - 40ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 498s - 498s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1685956
{'0': {'precision': 0.3453868781159817, 'recall': 0.7964035482285344, 'f1-score': 0.4818175540738808, 'support': 3114681}, '1': {'precision': 0.30946713237888374, 'recall': 0.1776346347069587, 'f1-score': 0.2257108667160522, 'support': 2809621}, '2': {'precision': 0.30729232770656173, 'recall': 0.02481265686654738, 'f1-score': 0.04591764315074318, 'support': 3122479}, 'accuracy': 0.3379219636244096, 'macro avg': {'precision': 0.3207154460671424, 'recall': 0.33295027993401355, 'f1-score': 0.25114868798022544, 'support': 9046781}, 'weighted avg': {'precision': 0.3210831721231577, 'recall': 0.3379219636244096, 'f1-score': 0.251829556685599, 'support': 9046781}}
[[2480543  556733   77405]
 [2213289  499086   97246]
 [2488094  556908   77477]]
Evaluating performance on  train set...
10622/10622 - 155s - 155s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1557829
{'0': {'precision': 0.33321640932353946, 'recall': 0.7730348514060982, 'f1-score': 0.4656951031135577, 'support': 911814}, '1': {'precision': 0.32952826870658575, 'recall': 0.16789603838417325, 'f1-score': 0.22245189896333845, 'support': 892868}, '2': {'precision': 0.3550856603264535, 'recall': 0.05760905724465766, 'f1-score': 0.09913453825092365, 'support': 913832}, 'accuracy': 0.3337919172018242, 'macro avg': {'precision': 0.3392767794521929, 'recall': 0.332846649011643, 'f1-score': 0.2624271801092733, 'support': 2718514}, 'weighted avg': {'precision': 0.3393564544533849, 'recall': 0.3337919172018242, 'f1-score': 0.26258456282840614, 'support': 2718514}}
[[704864 153087  53863]
 [701207 149909  41752]
 [709263 151924  52645]]
Evaluating performance on  val set...
3064/3064 - 43s - 43s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1420723
{'0': {'precision': 0.321931045907601, 'recall': 0.6304075816205946, 'f1-score': 0.4262092626148167, 'support': 258942}, '1': {'precision': 0.3348588760180628, 'recall': 0.18551051867632332, 'f1-score': 0.23875287212063873, 'support': 266621}, '2': {'precision': 0.36312195273197995, 'recall': 0.18142245802916174, 'f1-score': 0.24195814309030428, 'support': 258215}, 'accuracy': 0.3311473401907173, 'macro avg': {'precision': 0.3399706248858813, 'recall': 0.3324468527753599, 'f1-score': 0.30230675927525325, 'support': 783778}, 'weighted avg': {'precision': 0.3398990687374564, 'recall': 0.3311473401907173, 'f1-score': 0.3017400722088979, 'support': 783778}}
[[163239  49278  46425]
 [181422  49461  35738]
 [162401  48968  46846]]
testing model out of sample: results/universal/W1/deepLOB_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 337s - 337s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1451533
{'0': {'precision': 0.33272989359177696, 'recall': 0.7689227147468161, 'f1-score': 0.46447232298364394, 'support': 2029611}, '1': {'precision': 0.3542999374993147, 'recall': 0.15718562437306813, 'f1-score': 0.21776120791094328, 'support': 2055646}, '2': {'precision': 0.3664638650117837, 'recall': 0.09041286751982061, 'f1-score': 0.1450415244152091, 'support': 2013939}, 'accuracy': 0.33870333073408365, 'macro avg': {'precision': 0.35116456536762514, 'recall': 0.33884040221323497, 'f1-score': 0.27575835176993213, 'support': 6099196}, 'weighted avg': {'precision': 0.3511386371615838, 'recall': 0.33870333073408365, 'f1-score': 0.27584666479970427, 'support': 6099196}}
[[1560614  293825  175172]
 [1592913  323118  139615]
 [1536806  295047  182086]]
Evaluating performance on  train set...
6711/6711 - 98s - 98s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1439371
{'0': {'precision': 0.33710151231206537, 'recall': 0.682420092109472, 'f1-score': 0.4512799808941101, 'support': 581482}, '1': {'precision': 0.3239150407552737, 'recall': 0.12800197448902942, 'f1-score': 0.18349282449989424, 'support': 559132}, '2': {'precision': 0.3360819832887931, 'recall': 0.1860234035764327, 'f1-score': 0.23948848636659442, 'support': 576664}, 'accuracy': 0.3352153815515019, 'macro avg': {'precision': 0.3323661787853774, 'recall': 0.3321484900583114, 'f1-score': 0.29142043058686623, 'support': 1717278}, 'weighted avg': {'precision': 0.3324657434387855, 'recall': 0.3352153815515019, 'f1-score': 0.2929707853362412, 'support': 1717278}}
[[396815  74784 109883]
 [385531  71570 102031]
 [394792  74599 107273]]
Evaluating performance on  val set...
1720/1720 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1413535
{'0': {'precision': 0.3531965943297606, 'recall': 0.7242258722656956, 'f1-score': 0.4748260214361909, 'support': 154884}, '1': {'precision': 0.32037796683213354, 'recall': 0.14756436458808134, 'f1-score': 0.20206067256245186, 'support': 136022}, '2': {'precision': 0.3520314020196598, 'recall': 0.14089575486582476, 'f1-score': 0.20124567872229226, 'support': 148947}, 'accuracy': 0.3483641125557857, 'macro avg': {'precision': 0.34186865439385133, 'recall': 0.3375619972398672, 'f1-score': 0.2927107909069783, 'support': 439853}, 'weighted avg': {'precision': 0.34265305535538776, 'recall': 0.3483641125557857, 'f1-score': 0.2978326632217175, 'support': 439853}}
[[112171  21879  20834]
 [ 98156  20072  17794]
 [107261  20700  20986]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1339049
{'0': {'precision': 0.3335615171137835, 'recall': 0.617537249529029, 'f1-score': 0.4331551444531203, 'support': 58390}, '1': {'precision': 0.33996347801657534, 'recall': 0.20388872976023992, 'f1-score': 0.2549027868472605, 'support': 59351}, '2': {'precision': 0.3261262647635902, 'recall': 0.16318555450747876, 'f1-score': 0.21752630228380807, 'support': 51947}, 'accuracy': 0.3337654990335203, 'macro avg': {'precision': 0.33321708663131633, 'recall': 0.3282038445989159, 'f1-score': 0.3018614111947296, 'support': 169688}, 'weighted avg': {'precision': 0.33352452998273185, 'recall': 0.3337654990335203, 'f1-score': 0.3047976463363728, 'support': 169688}}
[[36058 12300 10032]
 [39766 12101  7484]
 [32276 11194  8477]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1688141
{'0': {'precision': 0.3277709404184464, 'recall': 0.8313059444571953, 'f1-score': 0.470163687578696, 'support': 21785}, '1': {'precision': 0.3344276841171251, 'recall': 0.1720376118312945, 'f1-score': 0.22719874615709204, 'support': 21908}, '2': {'precision': 1.0, 'recall': 4.3802014892685065e-05, 'f1-score': 8.760019272042399e-05, 'support': 22830}, 'accuracy': 0.32890879846068277, 'macro avg': {'precision': 0.5540662081785238, 'recall': 0.3344624527677942, 'f1-score': 0.23248334464283615, 'support': 66523}, 'weighted avg': {'precision': 0.5606652081333348, 'recall': 0.32890879846068277, 'f1-score': 0.2288229030126614, 'support': 66523}}
[[18110  3675     0]
 [18139  3769     0]
 [19003  3826     1]]
Evaluating performance on  val set...
51/51 - 1s - 910ms/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.10895
{'0': {'precision': 0.3257339857651246, 'recall': 0.7481481481481481, 'f1-score': 0.45386224529325175, 'support': 3915}, '1': {'precision': 0.46975425330812853, 'recall': 0.1787769784172662, 'f1-score': 0.2589890568004169, 'support': 5560}, '2': {'precision': 0.2645198389879241, 'recall': 0.13641755634638197, 'f1-score': 0.18000391312854627, 'support': 3372}, 'accuracy': 0.34116914454736513, 'macro avg': {'precision': 0.35333602602039244, 'recall': 0.3544475609705988, 'f1-score': 0.2976184050740716, 'support': 12847}, 'weighted avg': {'precision': 0.3719968163564208, 'recall': 0.34116914454736513, 'f1-score': 0.2976432662258003, 'support': 12847}}
[[2929  583  403]
 [3690  994  876]
 [2373  539  460]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1220523
{'0': {'precision': 0.33744302163883744, 'recall': 0.7245032523818696, 'f1-score': 0.4604349064576806, 'support': 134978}, '1': {'precision': 0.40482030500159966, 'recall': 0.11665068712048578, 'f1-score': 0.18111291884748057, 'support': 162708}, '2': {'precision': 0.278005739901805, 'recall': 0.19008465505497713, 'f1-score': 0.22578812016605185, 'support': 123324}, 'accuracy': 0.33304197049951306, 'macro avg': {'precision': 0.34008968884741403, 'recall': 0.3437461981857775, 'f1-score': 0.2891119818237377, 'support': 421010}, 'weighted avg': {'precision': 0.3460717470573561, 'recall': 0.33304197049951306, 'f1-score': 0.2837514494549746, 'support': 421010}}
[[ 97792  14368  22818]
 [105666  18980  38062]
 [ 86345  13537  23442]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1435536
{'0': {'precision': 0.31800608495402666, 'recall': 0.6678846289627903, 'f1-score': 0.4308619060090871, 'support': 56652}, '1': {'precision': 0.30071459822079627, 'recall': 0.1463059866962306, 'f1-score': 0.19684259513382574, 'support': 56375}, '2': {'precision': 0.32426370196996296, 'recall': 0.12339722773747008, 'f1-score': 0.1787658436269305, 'support': 53891}, 'accuracy': 0.31593357217316287, 'macro avg': {'precision': 0.3143281283815953, 'recall': 0.31252928113216366, 'f1-score': 0.2688234482566144, 'support': 166918}, 'weighted avg': {'precision': 0.31418637512057523, 'recall': 0.31593357217316287, 'f1-score': 0.27043254819010015, 'support': 166918}}
[[37837 10491  8324]
 [42593  8248  5534]
 [38552  8689  6650]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.130719
{'0': {'precision': 0.3508819538670285, 'recall': 0.9574822585621722, 'f1-score': 0.5135622672734795, 'support': 16205}, '1': {'precision': 0.3328502415458937, 'recall': 0.045337895637296836, 'f1-score': 0.0798054091619853, 'support': 15197}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 14888}, 'accuracy': 0.3500756102829985, 'macro avg': {'precision': 0.2279107318043074, 'recall': 0.3342733847331563, 'f1-score': 0.1977892254784883, 'support': 46290}, 'weighted avg': {'precision': 0.23210989810300592, 'recall': 0.3500756102829985, 'f1-score': 0.20598572789374434, 'support': 46290}}
[[15516   689     0]
 [14508   689     0]
 [14196   692     0]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.157993
{'0': {'precision': 0.3600779973045049, 'recall': 0.8365895501257516, 'f1-score': 0.5034606151425092, 'support': 120078}, '1': {'precision': 0.2909983850629383, 'recall': 0.13368837214029453, 'f1-score': 0.18320844591771357, 'support': 98393}, '2': {'precision': 0.3787050836231164, 'recall': 0.03883050070461993, 'f1-score': 0.07043858568436615, 'support': 117794}, 'accuracy': 0.35146090137242947, 'macro avg': {'precision': 0.34326048866351994, 'recall': 0.3363694743235554, 'f1-score': 0.25236921558152964, 'support': 336265}, 'weighted avg': {'precision': 0.3463900093144674, 'recall': 0.35146090137242947, 'f1-score': 0.25806496402054346, 'support': 336265}}
[[100456  16259   3363]
 [ 81098  13154   4141]
 [ 97430  15790   4574]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1464628
{'0': {'precision': 0.3529707490740456, 'recall': 0.7262460154947119, 'f1-score': 0.4750548889103689, 'support': 47371}, '1': {'precision': 0.31094252873563216, 'recall': 0.1629324467572516, 'f1-score': 0.2138227575958772, 'support': 41508}, '2': {'precision': 0.33240997229916897, 'recall': 0.10899665477746516, 'f1-score': 0.16416416416416416, 'support': 45139}, 'accuracy': 0.3438791804086018, 'macro avg': {'precision': 0.3321077500362822, 'recall': 0.33272503900980954, 'f1-score': 0.28434727022347006, 'support': 134018}, 'weighted avg': {'precision': 0.33302864970942275, 'recall': 0.3438791804086018, 'f1-score': 0.2894341534052811, 'support': 134018}}
[[34403  7524  5444]
 [30308  6763  4437]
 [32756  7463  4920]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1610183
{'0': {'precision': 0.3550671126362886, 'recall': 0.8381870385561936, 'f1-score': 0.49882525249443144, 'support': 9752}, '1': {'precision': 0.28344179320318147, 'recall': 0.14420600858369098, 'f1-score': 0.19115734720416125, 'support': 8155}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 9263}, 'accuracy': 0.3441295546558704, 'macro avg': {'precision': 0.21283630194649003, 'recall': 0.3274643490466282, 'f1-score': 0.22999419989953088, 'support': 27170}, 'weighted avg': {'precision': 0.21251683128454293, 'recall': 0.3441295546558704, 'f1-score': 0.23641634261227934, 'support': 27170}}
[[8174 1578    0]
 [6979 1176    0]
 [7868 1395    0]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1718103
{'0': {'precision': 0.3322370238327619, 'recall': 0.8125895165431075, 'f1-score': 0.4716388257130159, 'support': 111013}, '1': {'precision': 0.322372756054835, 'recall': 0.18486705681765817, 'f1-score': 0.23498195960826576, 'support': 108505}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 114223}, 'accuracy': 0.3303969245612616, 'macro avg': {'precision': 0.21820325996253231, 'recall': 0.33248552445358853, 'f1-score': 0.23554026177376056, 'support': 333741}, 'weighted avg': {'precision': 0.21532171540948297, 'recall': 0.3303969245612616, 'f1-score': 0.2332789752717644, 'support': 333741}}
[[90208 20805     0]
 [88445 20059     1]
 [92864 21359     0]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.14938
{'0': {'precision': 0.3309544336941597, 'recall': 0.6404956124088493, 'f1-score': 0.4364091875618434, 'support': 32364}, '1': {'precision': 0.3329941626948, 'recall': 0.19129953236524735, 'f1-score': 0.24299978505969483, 'support': 32504}, '2': {'precision': 0.3363834937127339, 'recall': 0.170711246929115, 'f1-score': 0.22648409086392274, 'support': 33378}, 'accuracy': 0.3322781589072329, 'macro avg': {'precision': 0.3334440300338979, 'recall': 0.33416879723440385, 'f1-score': 0.30196435449515363, 'support': 98246}, 'weighted avg': {'precision': 0.3334737272708629, 'recall': 0.3322781589072329, 'f1-score': 0.30110129618190906, 'support': 98246}}
[[20729  6058  5577]
 [20622  6218  5664]
 [21283  6397  5698]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1552521
{'0': {'precision': 0.281344, 'recall': 0.6305220883534136, 'f1-score': 0.38907819622073725, 'support': 6972}, '1': {'precision': 0.3675379154565989, 'recall': 0.13540180694246315, 'f1-score': 0.19789766310485624, 'support': 8412}, '2': {'precision': 0.382172131147541, 'recall': 0.22688564476885645, 'f1-score': 0.28473282442748094, 'support': 8220}, 'accuracy': 0.3135061853923064, 'macro avg': {'precision': 0.34368468220137993, 'recall': 0.3309365133549111, 'f1-score': 0.2905695612510248, 'support': 23604}, 'weighted avg': {'precision': 0.3471748106614852, 'recall': 0.3135061853923064, 'f1-score': 0.28460736073898174, 'support': 23604}}
[[4396  909 1667]
 [5925 1139 1348]
 [5304 1051 1865]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1306658
{'0': {'precision': 0.34230752726111063, 'recall': 0.6183837652997063, 'f1-score': 0.44067728985845295, 'support': 232194}, '1': {'precision': 0.2987419312343565, 'recall': 0.1326266539951751, 'f1-score': 0.18369971344383804, 'support': 205185}, '2': {'precision': 0.38301713469169035, 'recall': 0.2611238926121957, 'f1-score': 0.3105373541147841, 'support': 229933}, 'accuracy': 0.34592364591075836, 'macro avg': {'precision': 0.34135553106238586, 'recall': 0.33737810396902573, 'f1-score': 0.311638119139025, 'support': 667312}, 'weighted avg': {'precision': 0.34293912888761513, 'recall': 0.34592364591075836, 'f1-score': 0.31682006885541125, 'support': 667312}}
[[143585  31843  56766]
 [138021  27213  39951]
 [137856  32036  60041]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1461196
{'0': {'precision': 0.3369266225559438, 'recall': 0.6609732778038859, 'f1-score': 0.44633633896524555, 'support': 61709}, '1': {'precision': 0.3330468414267297, 'recall': 0.17774064609134396, 'f1-score': 0.2317831278972891, 'support': 61044}, '2': {'precision': 0.3289630512514899, 'recall': 0.16490383839036285, 'f1-score': 0.2196837689577283, 'support': 61927}, 'accuracy': 0.33490361706735977, 'macro avg': {'precision': 0.3329788384113878, 'recall': 0.33453925409519764, 'f1-score': 0.299267745273421, 'support': 184680}, 'weighted avg': {'precision': 0.3329738532283357, 'recall': 0.33490361706735977, 'f1-score': 0.2994168029067235, 'support': 184680}}
[[40788 10592 10329]
 [39692 10850 10502]
 [40579 11136 10212]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.146579
{'0': {'precision': 0.3567243413291388, 'recall': 0.8804717072697272, 'f1-score': 0.5077379453166541, 'support': 20606}, '1': {'precision': 0.3049431009957326, 'recall': 0.10263315380011968, 'f1-score': 0.1535775051491, 'support': 16710}, '2': {'precision': 0.5135467980295566, 'recall': 0.04011158137745287, 'f1-score': 0.07441113490364025, 'support': 20792}, 'accuracy': 0.35609554622427203, 'macro avg': {'precision': 0.39173808011814265, 'recall': 0.34107214748243325, 'f1-score': 0.24524219512313147, 'support': 58108}, 'weighted avg': {'precision': 0.3979473741945596, 'recall': 0.35609554622427203, 'f1-score': 0.2508412702063902, 'support': 58108}}
[[18143  1932   531]
 [14736  1715   259]
 [17981  1977   834]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/EXC
Evaluating performance on  test set...
5343/5343 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1493707
{'0': {'precision': 0.32504880399828273, 'recall': 0.7204547698771062, 'f1-score': 0.44798117794157455, 'support': 445588}, '1': {'precision': 0.34115752144037903, 'recall': 0.15380124036340398, 'f1-score': 0.21201948124169503, 'support': 470991}, '2': {'precision': 0.3210651127317794, 'recall': 0.11942332838367944, 'f1-score': 0.17409158021588197, 'support': 451210}, 'accuracy': 0.3270606796808572, 'macro avg': {'precision': 0.3290904793901471, 'recall': 0.3312264462080632, 'f1-score': 0.27803074646638387, 'support': 1367789}, 'weighted avg': {'precision': 0.32928160569533643, 'recall': 0.3270606796808572, 'f1-score': 0.276377545451342, 'support': 1367789}}
[[321026  69933  54629]
 [339234  72439  59318]
 [327364  69961  53885]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1661865
{'0': {'precision': 0.32911378551807413, 'recall': 0.8294977059791653, 'f1-score': 0.4712522395933995, 'support': 108761}, '1': {'precision': 0.33468672306784236, 'recall': 0.17165082743184237, 'f1-score': 0.22692076812534484, 'support': 109012}, '2': {'precision': 0.564625850340136, 'recall': 0.0007384078858403615, 'f1-score': 0.0014748869401426908, 'support': 112404}, 'accuracy': 0.3301623068838835, 'macro avg': {'precision': 0.4094754529753508, 'recall': 0.333962313765616, 'f1-score': 0.23321596488629567, 'support': 330177}, 'weighted avg': {'precision': 0.41113044689192624, 'recall': 0.3301623068838835, 'f1-score': 0.23065426967026056, 'support': 330177}}
[[90217 18516    28]
 [90264 18712    36]
 [93640 18681    83]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1414716
{'0': {'precision': 0.32589285714285715, 'recall': 0.7796514896008994, 'f1-score': 0.45965202982601494, 'support': 30243}, '1': {'precision': 0.36364278649145115, 'recall': 0.15479233707256926, 'f1-score': 0.21715008965299018, 'support': 33251}, '2': {'precision': 0.3679394130640581, 'recall': 0.07945485519591142, 'f1-score': 0.13068818650526787, 'support': 29350}, 'accuracy': 0.3345181164103227, 'macro avg': {'precision': 0.35249168556612215, 'recall': 0.33796622728979336, 'f1-score': 0.269163435328091, 'support': 92844}, 'weighted avg': {'precision': 0.3527043831117657, 'recall': 0.3345181164103227, 'f1-score': 0.26881017882695013, 'support': 92844}}
[[23579  4494  2170]
 [26268  5147  1836]
 [22505  4513  2332]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/AAL
Evaluating performance on  test set...
7177/7177 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1340322
{'0': {'precision': 0.377965193702187, 'recall': 0.7642937975678116, 'f1-score': 0.5057985193391498, 'support': 682184}, '1': {'precision': 0.28183336449984203, 'recall': 0.08742396633216187, 'f1-score': 0.13345159872004692, 'support': 499943}, '2': {'precision': 0.3605678494108314, 'recall': 0.16655622768954534, 'f1-score': 0.2278583864138852, 'support': 654962}, 'accuracy': 0.3669849419380335, 'macro avg': {'precision': 0.34012213587095347, 'recall': 0.3394246638631729, 'f1-score': 0.289036168157694, 'support': 1837089}, 'weighted avg': {'precision': 0.3456014734367765, 'recall': 0.3669849419380335, 'f1-score': 0.3053768403262804, 'support': 1837089}}
[[521389  55554 105241]
 [368020  43707  88216]
 [490054  55820 109088]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1336908
{'0': {'precision': 0.3401923715532459, 'recall': 0.5940103557368545, 'f1-score': 0.4326208557140211, 'support': 196606}, '1': {'precision': 0.336876268996493, 'recall': 0.11624611203702721, 'f1-score': 0.17284759326635465, 'support': 188402}, '2': {'precision': 0.3364998907065086, 'recall': 0.29578795951538944, 'f1-score': 0.31483323936811153, 'support': 192567}, 'accuracy': 0.3387369605678916, 'macro avg': {'precision': 0.3378561770854158, 'recall': 0.335348142429757, 'f1-score': 0.3067672294494958, 'support': 577575}, 'weighted avg': {'precision': 0.3378795804644505, 'recall': 0.3387369605678916, 'f1-score': 0.30861304701636616, 'support': 577575}}
[[116786  21695  58125]
 [112316  21901  54185]
 [114192  21416  56959]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1287936
{'0': {'precision': 0.3709340993337227, 'recall': 0.5237109585352719, 'f1-score': 0.43427782002888576, 'support': 59424}, '1': {'precision': 0.3033870463078849, 'recall': 0.16362907648820824, 'f1-score': 0.21259626716364732, 'support': 47406}, '2': {'precision': 0.3483039676203561, 'recall': 0.33204715211157915, 'f1-score': 0.3399813336474597, 'support': 56498}, 'accuracy': 0.352897237460815, 'macro avg': {'precision': 0.3408750377539879, 'recall': 0.33979572904501976, 'f1-score': 0.3289518069466643, 'support': 163328}, 'weighted avg': {'precision': 0.34350039061700144, 'recall': 0.352897237460815, 'f1-score': 0.3373158870920513, 'support': 163328}}
[[31121  9100 19203]
 [23751  7757 15898]
 [29027  8711 18760]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/WBA
Evaluating performance on  test set...
5696/5696 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1736338
{'0': {'precision': 0.3566381498855312, 'recall': 0.8260189234132972, 'f1-score': 0.49818306129070267, 'support': 519568}, '1': {'precision': 0.2916763210085024, 'recall': 0.17598720454949351, 'f1-score': 0.2195223598262052, 'support': 422025}, '2': {'precision': 0.25, 'recall': 1.9363671042210865e-06, 'f1-score': 3.872704212534007e-06, 'support': 516431}, 'accuracy': 0.34529267007950487, 'macro avg': {'precision': 0.29943815696467785, 'recall': 0.334002688109965, 'f1-score': 0.23923643127370678, 'support': 1458024}, 'weighted avg': {'precision': 0.30006379842398956, 'recall': 0.34529267007950487, 'f1-score': 0.24107003772149926, 'support': 1458024}}
[[429173  90394      1]
 [347752  74271      2]
 [426460  89970      1]]
Evaluating performance on  train set...
2222/2222 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1420745
{'0': {'precision': 0.340773137831584, 'recall': 0.737651638648764, 'f1-score': 0.4661833982511988, 'support': 194459}, '1': {'precision': 0.3084853486395605, 'recall': 0.13671523164347593, 'f1-score': 0.1894635710989568, 'support': 183191}, '2': {'precision': 0.33542362176306056, 'recall': 0.11679906162780347, 'f1-score': 0.17326492327172027, 'support': 190969}, 'accuracy': 0.3355375040229046, 'macro avg': {'precision': 0.32822736941140174, 'recall': 0.33038864397334783, 'f1-score': 0.276303964207292, 'support': 568619}, 'weighted avg': {'precision': 0.32857441755673245, 'recall': 0.3355375040229046, 'f1-score': 0.27865725138624636, 'support': 568619}}
[[143443  28276  22740]
 [136693  25045  21453]
 [140798  27866  22305]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1395868
{'0': {'precision': 0.34704654057744044, 'recall': 0.5896399392791963, 'f1-score': 0.4369284825045342, 'support': 58629}, '1': {'precision': 0.3006308610400682, 'recall': 0.17730582036120832, 'f1-score': 0.22305716851999444, 'support': 49722}, '2': {'precision': 0.3295903752506445, 'recall': 0.20733025803661526, 'f1-score': 0.25454062783443576, 'support': 55496}, 'accuracy': 0.3350198660945882, 'macro avg': {'precision': 0.3257559256227177, 'recall': 0.32475867255900664, 'f1-score': 0.30484209295298814, 'support': 163847}, 'weighted avg': {'precision': 0.3270484462032188, 'recall': 0.3350198660945882, 'f1-score': 0.31024989909006173, 'support': 163847}}
[[34570 10744 13315]
 [30817  8816 10089]
 [34225  9765 11506]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 166s - 166s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1541835
{'0': {'precision': 0.3034406731138944, 'recall': 0.8112803104300438, 'f1-score': 0.44168082796521313, 'support': 936765}, '1': {'precision': 0.3875006203994174, 'recall': 0.18982388952140136, 'f1-score': 0.25481985847530353, 'support': 1192774}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 959303}, 'accuracy': 0.31934168209315983, 'macro avg': {'precision': 0.23031376450443727, 'recall': 0.33370139998381504, 'f1-score': 0.23216689548017222, 'support': 3088842}, 'weighted avg': {'precision': 0.24166120091148466, 'recall': 0.31934168209315983, 'f1-score': 0.2323503897842151, 'support': 3088842}}
[[759979 176784      2]
 [966357 226417      0]
 [778203 181100      0]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1482623
{'0': {'precision': 0.33410898742370504, 'recall': 0.737660967438418, 'f1-score': 0.45991055781097356, 'support': 254011}, '1': {'precision': 0.316510211634871, 'recall': 0.11459373857960775, 'f1-score': 0.1682660918872025, 'support': 246270}, '2': {'precision': 0.33747679470249375, 'recall': 0.1387366690138906, 'f1-score': 0.1966362143611846, 'support': 254201}, 'accuracy': 0.3324956725276415, 'macro avg': {'precision': 0.32936533125368994, 'recall': 0.3303304583439721, 'f1-score': 0.2749376213531202, 'support': 754482}, 'weighted avg': {'precision': 0.32949926772801874, 'recall': 0.3324956725276415, 'f1-score': 0.27601235480238373, 'support': 754482}}
[[187374  30475  36162]
 [184976  28221  33073]
 [188467  30467  35267]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1513574
{'0': {'precision': 0.34305198198257786, 'recall': 0.8476473760766176, 'f1-score': 0.48843078719617283, 'support': 61187}, '1': {'precision': 0.32468521934397304, 'recall': 0.13914522864360468, 'f1-score': 0.1948056634868698, 'support': 58191}, '2': {'precision': 0.3863736263736264, 'recall': 0.01489275185524042, 'f1-score': 0.028680033280584695, 'support': 59022}, 'accuracy': 0.34103699551569505, 'macro avg': {'precision': 0.35137027590005915, 'recall': 0.33389511885848755, 'f1-score': 0.23730549465454243, 'support': 178400}, 'weighted avg': {'precision': 0.3513936289026755, 'recall': 0.34103699551569505, 'f1-score': 0.24055103063017566, 'support': 178400}}
[[51865  8623   699]
 [49397  8097   697]
 [49925  8218   879]]
testing model on single stock: results/universal/W1/deepLOB_L2/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 292s - 292s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1755179
{'0': {'precision': 0.34823223941928855, 'recall': 0.8102497775190777, 'f1-score': 0.48711173827303356, 'support': 1903534}, '1': {'precision': 0.3018367465000579, 'recall': 0.1902604364187987, 'f1-score': 0.2333993898347544, 'support': 1645392}, '2': {'precision': 0.14285714285714285, 'recall': 5.215692349257364e-07, 'f1-score': 1.043134661382842e-06, 'support': 1917291}, 'accuracy': 0.33942889570611634, 'macro avg': {'precision': 0.26430870959216307, 'recall': 0.3335035785023704, 'f1-score': 0.24017072374748313, 'support': 5466217}, 'weighted avg': {'precision': 0.2622307877483996, 'recall': 0.33942889570611634, 'f1-score': 0.239886057292183, 'support': 5466217}}
[[1542338  361193       3]
 [1332336  313053       3]
 [1554376  362914       1]]
Evaluating performance on  train set...
6073/6073 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1606032
{'0': {'precision': 0.33262914453972603, 'recall': 0.793357301502373, 'f1-score': 0.46873345845446035, 'support': 519578}, '1': {'precision': 0.3363351966011637, 'recall': 0.17834993532453017, 'f1-score': 0.23309536973312409, 'support': 511786}, '2': {'precision': 0.4028827762091265, 'recall': 0.033817542384219884, 'f1-score': 0.06239750593363499, 'support': 523190}, 'accuracy': 0.33526078862490466, 'macro avg': {'precision': 0.3572823724500054, 'recall': 0.33517492640370766, 'f1-score': 0.2547421113737398, 'support': 1554554}, 'weighted avg': {'precision': 0.35749331980377513, 'recall': 0.33526078862490466, 'f1-score': 0.25440370093319803, 'support': 1554554}}
[[412211  90112  17255]
 [411541  91277   8968]
 [415499  89998  17693]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1435046
{'0': {'precision': 0.31095382053185133, 'recall': 0.5846908974559714, 'f1-score': 0.4059910469914772, 'support': 146893}, '1': {'precision': 0.3401630988786952, 'recall': 0.2085116752791507, 'f1-score': 0.2585428780618194, 'support': 160039}, '2': {'precision': 0.3767976064086478, 'recall': 0.20785167142505373, 'f1-score': 0.26791450960544544, 'support': 150261}, 'accuracy': 0.3291585829179362, 'macro avg': {'precision': 0.3426381752730648, 'recall': 0.33368474805339193, 'f1-score': 0.31081614488624737, 'support': 457193}, 'weighted avg': {'precision': 0.3428186496236875, 'recall': 0.3291585829179362, 'f1-score': 0.3089970508202847, 'support': 457193}}
[[ 85887  31695  29311]
 [104324  33370  22345]
 [ 85994  33035  31232]]
training model: results/universal/W1/deepLOB_L2/h500
Epoch 1/50
10622/10622 - 434s - loss: 3.2138 - accuracy500: 0.4182 - val_loss: 3.3509 - val_accuracy500: 0.3386 - 434s/epoch - 41ms/step
Epoch 2/50
10622/10622 - 433s - loss: 3.1857 - accuracy500: 0.4321 - val_loss: 3.4641 - val_accuracy500: 0.3123 - 433s/epoch - 41ms/step
Epoch 3/50
10622/10622 - 426s - loss: 3.1715 - accuracy500: 0.4382 - val_loss: 3.6471 - val_accuracy500: 0.3381 - 426s/epoch - 40ms/step
Epoch 4/50
10622/10622 - 425s - loss: 3.1603 - accuracy500: 0.4415 - val_loss: 3.6487 - val_accuracy500: 0.3293 - 425s/epoch - 40ms/step
Epoch 5/50
10622/10622 - 420s - loss: 3.1543 - accuracy500: 0.4437 - val_loss: 3.5883 - val_accuracy500: 0.3198 - 420s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 421s - loss: 3.1465 - accuracy500: 0.4464 - val_loss: 3.5423 - val_accuracy500: 0.3228 - 421s/epoch - 40ms/step
Epoch 7/50
10622/10622 - 420s - loss: 3.1435 - accuracy500: 0.4476 - val_loss: 3.5410 - val_accuracy500: 0.3349 - 420s/epoch - 40ms/step
Epoch 8/50
10622/10622 - 426s - loss: 3.1368 - accuracy500: 0.4507 - val_loss: 3.4977 - val_accuracy500: 0.3271 - 426s/epoch - 40ms/step
Epoch 9/50
10622/10622 - 422s - loss: 3.1326 - accuracy500: 0.4515 - val_loss: 3.8528 - val_accuracy500: 0.3383 - 422s/epoch - 40ms/step
Epoch 10/50
10622/10622 - 430s - loss: 3.1318 - accuracy500: 0.4520 - val_loss: 3.7189 - val_accuracy500: 0.3282 - 430s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 430s - loss: 3.1287 - accuracy500: 0.4531 - val_loss: 4.4135 - val_accuracy500: 0.3478 - 430s/epoch - 40ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 483s - 483s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039157
{'0': {'precision': 0.37053351828483194, 'recall': 0.7241641448518116, 'f1-score': 0.4902304945802648, 'support': 3350431}, '1': {'precision': 0.25020540113931866, 'recall': 0.21324334381237245, 'f1-score': 0.23025042989133943, 'support': 2319233}, '2': {'precision': 0.3599450719924618, 'recall': 0.05565131441996235, 'f1-score': 0.09639841456893689, 'support': 3377117}, 'accuracy': 0.3436320609507404, 'macro avg': {'precision': 0.32689466380553744, 'recall': 0.3310196010280488, 'f1-score': 0.2722931130135137, 'support': 9046781}, 'weighted avg': {'precision': 0.3357335864539088, 'recall': 0.3436320609507404, 'f1-score': 0.2765665009542108, 'support': 9046781}}
[[2426262  738464  185705]
 [1676180  494561  148492]
 [2445581  743595  187941]]
Evaluating performance on  train set...
10622/10622 - 148s - 148s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1122872
{'0': {'precision': 0.32955266214839046, 'recall': 0.7142865023743534, 'f1-score': 0.45101779353480437, 'support': 906352}, '1': {'precision': 0.33520978773704047, 'recall': 0.18414217498151886, 'f1-score': 0.23770492390510833, 'support': 900918}, '2': {'precision': 0.35865140096394654, 'recall': 0.1019946359043242, 'f1-score': 0.15882268001951488, 'support': 911244}, 'accuracy': 0.3333563851427655, 'macro avg': {'precision': 0.3411379502831258, 'recall': 0.33347443775339886, 'f1-score': 0.28251513248647586, 'support': 2718514}, 'weighted avg': {'precision': 0.3411813156790759, 'recall': 0.3333563851427655, 'f1-score': 0.28238211687425635, 'support': 2718514}}
[[647395 165303  93654]
 [662474 165897  72547]
 [654597 163705  92942]]
Evaluating performance on  val set...
3064/3064 - 41s - 41s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1170733
{'0': {'precision': 0.35184952136450964, 'recall': 0.6068889668720356, 'f1-score': 0.445447001732642, 'support': 276413}, '1': {'precision': 0.28899476988123945, 'recall': 0.19089550326685742, 'f1-score': 0.2299184006213177, 'support': 234170}, '2': {'precision': 0.34717872968980795, 'recall': 0.19357601713062098, 'f1-score': 0.24856175972927239, 'support': 273195}, 'accuracy': 0.33853718782614467, 'macro avg': {'precision': 0.329341006978519, 'recall': 0.3304534957565047, 'f1-score': 0.3079757206944107, 'support': 783778}, 'weighted avg': {'precision': 0.3314422962492251, 'recall': 0.33853718782614467, 'f1-score': 0.3124266870372188, 'support': 783778}}
[[167752  55234  53427]
 [143454  44702  46014]
 [165566  54745  52884]]
testing model out of sample: results/universal/W1/deepLOB_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 331s - 331s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200651
{'0': {'precision': 0.3042852505239654, 'recall': 0.7121424009306575, 'f1-score': 0.4263843640337983, 'support': 1858471}, '1': {'precision': 0.42762507100616637, 'recall': 0.17469708878751167, 'f1-score': 0.24805613999963058, 'support': 2382959}, '2': {'precision': 0.3454188220288212, 'recall': 0.14431419242251178, 'f1-score': 0.2035755682286286, 'support': 1857766}, 'accuracy': 0.32920634129481985, 'macro avg': {'precision': 0.35910971451965096, 'recall': 0.3437178940468937, 'f1-score': 0.29267202408735254, 'support': 6099196}, 'weighted avg': {'precision': 0.3650031362709942, 'recall': 0.32920634129481985, 'f1-score': 0.2888456701200393, 'support': 6099196}}
[[1323496  275515  259460]
 [1718060  416296  248603]
 [1307968  281696  268102]]
Evaluating performance on  train set...
6711/6711 - 99s - 99s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1198184
{'0': {'precision': 0.3334056728661646, 'recall': 0.6353816991211443, 'f1-score': 0.4373299426638422, 'support': 580300}, '1': {'precision': 0.34788919299991705, 'recall': 0.11917251176418361, 'f1-score': 0.1775304141723827, 'support': 563150}, '2': {'precision': 0.34694721246445387, 'recall': 0.253014840683968, 'f1-score': 0.29262781946552346, 'support': 573828}, 'accuracy': 0.33833252391284346, 'macro avg': {'precision': 0.3427473594435118, 'recall': 0.33585635052309865, 'f1-score': 0.30249605876724944, 'support': 1717278}, 'weighted avg': {'precision': 0.34268018109833775, 'recall': 0.33833252391284346, 'f1-score': 0.30378124849748694, 'support': 1717278}}
[[368712  62377 149211]
 [371966  67112 124072]
 [365218  63423 145187]]
Evaluating performance on  val set...
1720/1720 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1209431
{'0': {'precision': 0.3457315880690823, 'recall': 0.6695507378869009, 'f1-score': 0.45600092503235395, 'support': 153140}, '1': {'precision': 0.3422444863274146, 'recall': 0.14708473661025137, 'f1-score': 0.20574671516886317, 'support': 140742}, '2': {'precision': 0.35850856956505983, 'recall': 0.20334175966459092, 'f1-score': 0.25949887220017137, 'support': 145971}, 'accuracy': 0.3476570581535195, 'macro avg': {'precision': 0.3488282146538522, 'recall': 0.33999241138724773, 'f1-score': 0.3070821708004628, 'support': 439853}, 'weighted avg': {'precision': 0.34885601166656494, 'recall': 0.3476570581535195, 'f1-score': 0.3107140242755694, 'support': 439853}}
[[102535  20413  30192]
 [ 97122  20701  22919]
 [ 96917  19372  29682]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200709
{'0': {'precision': 0.31070034102703503, 'recall': 0.5612356039639318, 'f1-score': 0.3999745498504803, 'support': 56005}, '1': {'precision': 0.34733314318311465, 'recall': 0.2275990966435636, 'f1-score': 0.27499835335961686, 'support': 64205}, '2': {'precision': 0.2645268609882424, 'recall': 0.14141638708112697, 'f1-score': 0.1843037574576249, 'support': 49478}, 'accuracy': 0.31258545094526424, 'macro avg': {'precision': 0.3075201150661307, 'recall': 0.31008369589620743, 'f1-score': 0.2864255535559073, 'support': 169688}, 'weighted avg': {'precision': 0.31109776227704505, 'recall': 0.31258545094526424, 'f1-score': 0.2898014311755617, 'support': 169688}}
[[31432 13380 11193]
 [41331 14613  8261]
 [28402 14079  6997]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1073313
{'0': {'precision': 0.32895884545238285, 'recall': 0.756507864144062, 'f1-score': 0.45853078931734337, 'support': 21935}, '1': {'precision': 0.3283749649172046, 'recall': 0.21361084485827742, 'f1-score': 0.2588423992699317, 'support': 21909}, '2': {'precision': 0.34099616858237547, 'recall': 0.027470347017064245, 'f1-score': 0.0508446910960581, 'support': 22679}, 'accuracy': 0.3291643491724667, 'macro avg': {'precision': 0.3327766596506543, 'recall': 0.3325296853398012, 'f1-score': 0.25607262656111107, 'support': 66523}, 'weighted avg': {'precision': 0.33287030784313315, 'recall': 0.3291643491724667, 'f1-score': 0.2537762539068948, 'support': 66523}}
[[16594  4742   599]
 [16624  4680   605]
 [17226  4830   623]]
Evaluating performance on  val set...
51/51 - 1s - 955ms/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128404
{'0': {'precision': 0.3327617881200245, 'recall': 0.6716934487021013, 'f1-score': 0.4450450450450451, 'support': 4045}, '1': {'precision': 0.4481346678798908, 'recall': 0.17918864835364745, 'f1-score': 0.25601039636127354, 'support': 5497}, '2': {'precision': 0.3075684380032206, 'recall': 0.23116490166414524, 'f1-score': 0.26394886854378996, 'support': 3305}, 'accuracy': 0.3476297968397291, 'macro avg': {'precision': 0.3628216313343786, 'recall': 0.3606823329066313, 'f1-score': 0.32166810331670287, 'support': 12847}, 'weighted avg': {'precision': 0.3756465626124312, 'recall': 0.3476297968397291, 'f1-score': 0.3175719908571927, 'support': 12847}}
[[2717  683  645]
 [3437  985 1075]
 [2011  530  764]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188148
{'0': {'precision': 0.38101184542413286, 'recall': 0.6907640854129149, 'f1-score': 0.4911274667837324, 'support': 155480}, '1': {'precision': 0.336135561929252, 'recall': 0.07993539940260128, 'f1-score': 0.1291564799918929, 'support': 127553}, '2': {'precision': 0.33905658296260893, 'recall': 0.26734890597708316, 'f1-score': 0.29896301459235813, 'support': 137977}, 'accuracy': 0.36693665233604905, 'macro avg': {'precision': 0.3520679967719979, 'recall': 0.3460161302641998, 'f1-score': 0.30641565378932784, 'support': 421010}, 'weighted avg': {'precision': 0.35366578277175825, 'recall': 0.36693665233604905, 'f1-score': 0.3184836818421187, 'support': 421010}}
[[107400  10211  37869]
 [ 83318  10196  34039]
 [ 91163   9926  36888]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1358991
{'0': {'precision': 0.3210691878551939, 'recall': 0.6365077177508269, 'f1-score': 0.42683363561798926, 'support': 58048}, '1': {'precision': 0.29692054239006466, 'recall': 0.1671839880124157, 'f1-score': 0.2139188788203876, 'support': 56058}, '2': {'precision': 0.3369500887749063, 'recall': 0.12936453836249337, 'f1-score': 0.18695271453590193, 'support': 52812}, 'accuracy': 0.31843180483830386, 'macro avg': {'precision': 0.31831327300672163, 'recall': 0.31101874804191204, 'f1-score': 0.2759017429914263, 'support': 166918}, 'weighted avg': {'precision': 0.3179837049946733, 'recall': 0.31843180483830386, 'f1-score': 0.2794309190700607, 'support': 166918}}
[[36948 12691  8409]
 [41651  9372  5035]
 [36479  9501  6832]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969297
{'0': {'precision': 0.38892738524766435, 'recall': 0.9035749972243811, 'f1-score': 0.5437901946045268, 'support': 18014}, '1': {'precision': 0.29316960859554875, 'recall': 0.0317777223192746, 'f1-score': 0.057340138096667666, 'support': 12021}, '2': {'precision': 0.3596938775510204, 'recall': 0.0693940326053522, 'f1-score': 0.11634263318034138, 'support': 16255}, 'accuracy': 0.38425145819831497, 'macro avg': {'precision': 0.3472636237980778, 'recall': 0.3349155840496693, 'f1-score': 0.23915765529384533, 'support': 46290}, 'weighted avg': {'precision': 0.3537946373378776, 'recall': 0.38425145819831497, 'f1-score': 0.26736383383046963, 'support': 46290}}
[[16277   474  1263]
 [10894   382   745]
 [14680   447  1128]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021727
{'0': {'precision': 0.3782165782338762, 'recall': 0.789683193970086, 'f1-score': 0.5114673067339279, 'support': 127365}, '1': {'precision': 0.23837606307033335, 'recall': 0.13898440044880378, 'f1-score': 0.17559101925099457, 'support': 82887}, '2': {'precision': 0.4207896051974013, 'recall': 0.07350035313816829, 'f1-score': 0.12514186888612658, 'support': 126013}, 'accuracy': 0.3609058331970321, 'macro avg': {'precision': 0.3457940821672036, 'recall': 0.3340559825190194, 'f1-score': 0.2707333982903497, 'support': 336265}, 'weighted avg': {'precision': 0.3597008066441898, 'recall': 0.3609058331970321, 'f1-score': 0.28390331630937327, 'support': 336265}}
[[100578  18945   7842]
 [ 66460  11520   4907]
 [ 98889  17862   9262]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1269754
{'0': {'precision': 0.3397656636778701, 'recall': 0.6718807788534755, 'f1-score': 0.45130790588922987, 'support': 45965}, '1': {'precision': 0.30451317474484846, 'recall': 0.17786794206315026, 'f1-score': 0.22456572131757432, 'support': 44117}, '2': {'precision': 0.32171257347009335, 'recall': 0.12707119446467588, 'f1-score': 0.18218306412139007, 'support': 43936}, 'accuracy': 0.3306496142309242, 'macro avg': {'precision': 0.321997137297604, 'recall': 0.32560663846043386, 'f1-score': 0.2860188971093981, 'support': 134018}, 'weighted avg': {'precision': 0.32224253525014396, 'recall': 0.3306496142309242, 'f1-score': 0.28843833609517583, 'support': 134018}}
[[30883  8900  6182]
 [30681  7847  5589]
 [29331  9022  5583]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018908
{'0': {'precision': 0.3804680038204393, 'recall': 0.7569596199524941, 'f1-score': 0.5064039408866995, 'support': 10525}, '1': {'precision': 0.2620310351600864, 'recall': 0.183292113217917, 'f1-score': 0.21570054167677258, 'support': 7278}, '2': {'precision': 0.3476733977172959, 'recall': 0.04227607558449877, 'f1-score': 0.07538549400342662, 'support': 9367}, 'accuracy': 0.356900993743099, 'macro avg': {'precision': 0.3300574788992739, 'recall': 0.3275092695849699, 'f1-score': 0.26582999218896625, 'support': 27170}, 'weighted avg': {'precision': 0.3374363021907672, 'recall': 0.356900993743099, 'f1-score': 0.2799376497050482, 'support': 27170}}
[[7967 2081  477]
 [5678 1334  266]
 [7295 1676  396]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050583
{'0': {'precision': 0.3419894611809536, 'recall': 0.7473064427624531, 'f1-score': 0.46924059251886135, 'support': 114811}, '1': {'precision': 0.2964929170678036, 'recall': 0.208606291669489, 'f1-score': 0.2449035233708031, 'support': 103343}, '2': {'precision': 0.3522514533451572, 'recall': 0.0309290837204876, 'f1-score': 0.05686517783291978, 'support': 115587}, 'accuracy': 0.332389487656596, 'macro avg': {'precision': 0.33024461053130477, 'recall': 0.32894727271747654, 'f1-score': 0.25700309790752807, 'support': 333741}, 'weighted avg': {'precision': 0.3314555547385283, 'recall': 0.332389487656596, 'f1-score': 0.2569535112364546, 'support': 333741}}
[[85799 25542  3470]
 [78681 21558  3104]
 [86402 25610  3575]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1142826
{'0': {'precision': 0.3295325754713741, 'recall': 0.5974098748521263, 'f1-score': 0.42476426579308507, 'support': 32122}, '1': {'precision': 0.3460908542367037, 'recall': 0.24746525316650744, 'f1-score': 0.2885842123232287, 'support': 32449}, '2': {'precision': 0.3309339678762641, 'recall': 0.16519673348181144, 'f1-score': 0.22038229176983262, 'support': 33675}, 'accuracy': 0.3336827962461576, 'macro avg': {'precision': 0.335519132528114, 'recall': 0.33669062050014836, 'f1-score': 0.31124358996204876, 'support': 98246}, 'weighted avg': {'precision': 0.3354818403461869, 'recall': 0.3336827962461576, 'f1-score': 0.3097319028441976, 'support': 98246}}
[[19190  7252  5680]
 [18852  8030  5567]
 [20192  7920  5563]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1195154
{'0': {'precision': 0.28353413654618476, 'recall': 0.6028177031450122, 'f1-score': 0.38566941321072523, 'support': 7027}, '1': {'precision': 0.3940266282835552, 'recall': 0.1302640970735189, 'f1-score': 0.19579794367456416, 'support': 8406}, '2': {'precision': 0.3860662701784197, 'recall': 0.2780565414269979, 'f1-score': 0.32327831531018786, 'support': 8171}, 'accuracy': 0.3221064226402305, 'macro avg': {'precision': 0.35454234500271986, 'recall': 0.337046113881843, 'f1-score': 0.30158189073182573, 'support': 23604}, 'weighted avg': {'precision': 0.35837695765503613, 'recall': 0.3221064226402305, 'f1-score': 0.29645329586340013, 'support': 23604}}
[[4236  762 2029]
 [5727 1095 1584]
 [4977  922 2272]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1262065
{'0': {'precision': 0.34817926129675747, 'recall': 0.6124160415640568, 'f1-score': 0.44395504396705077, 'support': 229429}, '1': {'precision': 0.2990491769757693, 'recall': 0.09780505863526714, 'f1-score': 0.14740184009330048, 'support': 209345}, '2': {'precision': 0.35033282130056326, 'recall': 0.29938128451286, 'f1-score': 0.32285920563989073, 'support': 228538}, 'accuracy': 0.3437687318675522, 'macro avg': {'precision': 0.3325204198576967, 'recall': 0.33653412823739465, 'f1-score': 0.30473869656674735, 'support': 667312}, 'weighted avg': {'precision': 0.3335040161250425, 'recall': 0.3437687318675522, 'f1-score': 0.30944984824966104, 'support': 667312}}
[[140506  23893  65030]
 [127020  20475  61850]
 [136019  24099  68420]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204238
{'0': {'precision': 0.34193202626055114, 'recall': 0.6129667584705053, 'f1-score': 0.4389846737802956, 'support': 62452}, '1': {'precision': 0.30818374558303885, 'recall': 0.180219198915577, 'f1-score': 0.22743772687445235, 'support': 60493}, '2': {'precision': 0.31344042838018743, 'recall': 0.18963310925730947, 'f1-score': 0.23630216480799318, 'support': 61735}, 'accuracy': 0.32970543643058264, 'macro avg': {'precision': 0.32118540007459245, 'recall': 0.32760635554779727, 'f1-score': 0.30090818848758033, 'support': 184680}, 'weighted avg': {'precision': 0.3213533846200432, 'recall': 0.32970543643058264, 'f1-score': 0.30193835500955557, 'support': 184680}}
[[38281 11794 12377]
 [36325 10902 13266]
 [37349 12679 11707]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179812
{'0': {'precision': 0.342825141084737, 'recall': 0.8063225087390445, 'f1-score': 0.48110027960402024, 'support': 19739}, '1': {'precision': 0.32938055858948356, 'recall': 0.11574099457207083, 'f1-score': 0.17129178838039597, 'support': 18239}, '2': {'precision': 0.4139958278020102, 'recall': 0.10844510680576254, 'f1-score': 0.1718694642365075, 'support': 20130}, 'accuracy': 0.3478006470709713, 'macro avg': {'precision': 0.3620671758254102, 'recall': 0.3435028700389593, 'f1-score': 0.27475384407364123, 'support': 58108}, 'weighted avg': {'precision': 0.36326036830797276, 'recall': 0.3478006470709713, 'f1-score': 0.27673232020469973, 'support': 58108}}
[[15916  2129  1694]
 [14732  2111  1396]
 [15778  2169  2183]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/EXC
Evaluating performance on  test set...
5343/5343 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1228324
{'0': {'precision': 0.33600983988882205, 'recall': 0.6821660677917731, 'f1-score': 0.45024540354417086, 'support': 462534}, '1': {'precision': 0.30644942070948156, 'recall': 0.16970511156677015, 'f1-score': 0.2184418276245754, 'support': 438437}, '2': {'precision': 0.345305635173723, 'recall': 0.13755253653458094, 'f1-score': 0.19673547547010842, 'support': 466818}, 'accuracy': 0.3320263578666008, 'macro avg': {'precision': 0.3292549652573422, 'recall': 0.3298079052977081, 'f1-score': 0.2884742355462849, 'support': 1367789}, 'weighted avg': {'precision': 0.32970701325370094, 'recall': 0.3320263578666008, 'f1-score': 0.2894206988425412, 'support': 1367789}}
[[315525  84597  62412]
 [304699  74405  59333]
 [318811  83795  64212]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1063398
{'0': {'precision': 0.32942859382348333, 'recall': 0.7733717303498974, 'f1-score': 0.4620433201685314, 'support': 108689}, '1': {'precision': 0.3270650615780631, 'recall': 0.19681847695019014, 'f1-score': 0.24575098299235032, 'support': 107810}, '2': {'precision': 0.3492110453648915, 'recall': 0.03114938686465279, 'f1-score': 0.05719685344618714, 'support': 113678}, 'accuracy': 0.32957171456521805, 'macro avg': {'precision': 0.3352349002554793, 'recall': 0.3337798647215801, 'f1-score': 0.2549970522023563, 'support': 330177}, 'weighted avg': {'precision': 0.3354678307023254, 'recall': 0.32957171456521805, 'f1-score': 0.25203289086840835, 'support': 330177}}
[[84057 21405  3227]
 [83219 21219  3372]
 [87884 22253  3541]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1133506
{'0': {'precision': 0.331119278513336, 'recall': 0.7313836724047992, 'f1-score': 0.45585799778502556, 'support': 30672}, '1': {'precision': 0.3436666666666667, 'recall': 0.16246966497525922, 'f1-score': 0.22063386761967943, 'support': 31729}, '2': {'precision': 0.35780089153046063, 'recall': 0.11864796504943666, 'f1-score': 0.17820316739849032, 'support': 30443}, 'accuracy': 0.3360475636551635, 'macro avg': {'precision': 0.3441956122368211, 'recall': 0.33750043414316505, 'f1-score': 0.28489834426773175, 'support': 92844}, 'weighted avg': {'precision': 0.3441560328948508, 'recall': 0.3360475636551635, 'f1-score': 0.28442987720132, 'support': 92844}}
[[22433  5044  3195]
 [23286  5155  3288]
 [22030  4801  3612]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/AAL
Evaluating performance on  test set...
7177/7177 - 103s - 103s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1255565
{'0': {'precision': 0.37161296573403235, 'recall': 0.7207661756393373, 'f1-score': 0.4903902793188948, 'support': 670499}, '1': {'precision': 0.3141678869198817, 'recall': 0.059523382635757814, 'f1-score': 0.10008441121590232, 'support': 529859}, '2': {'precision': 0.3627798434756296, 'recall': 0.2485413777560697, 'f1-score': 0.2949866583656195, 'support': 636731}, 'accuracy': 0.3663763704425861, 'macro avg': {'precision': 0.34952023204318117, 'recall': 0.3429436453437216, 'f1-score': 0.29515378296680556, 'support': 1837089}, 'weighted avg': {'precision': 0.35198293431797023, 'recall': 0.3663763704425861, 'f1-score': 0.31009056605493024, 'support': 1837089}}
[[483273  35241 151985]
 [372333  31539 125987]
 [444868  33609 158254]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1241415
{'0': {'precision': 0.3403354916096498, 'recall': 0.5611909723448593, 'f1-score': 0.42371070200668576, 'support': 198191}, '1': {'precision': 0.3735838488759897, 'recall': 0.07857773969851937, 'f1-score': 0.12984461827062613, 'support': 186745}, '2': {'precision': 0.3450532407845214, 'recall': 0.3788225644859037, 'f1-score': 0.3611502210916757, 'support': 192639}, 'accuracy': 0.3443241137514608, 'macro avg': {'precision': 0.35299086042338695, 'recall': 0.3395304255097608, 'f1-score': 0.3049018471229959, 'support': 577575}, 'weighted avg': {'precision': 0.3526590633726256, 'recall': 0.3443241137514608, 'f1-score': 0.30783032233257057, 'support': 577575}}
[[111223  12540  74428]
 [107983  14674  64088]
 [107598  12065  72976]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1403807
{'0': {'precision': 0.3584734326325215, 'recall': 0.4764722645969188, 'f1-score': 0.40913474687279583, 'support': 59653}, '1': {'precision': 0.28464511079587146, 'recall': 0.12426856874386025, 'f1-score': 0.17300688281377752, 'support': 46826}, '2': {'precision': 0.35396880306937545, 'recall': 0.39597882108744215, 'f1-score': 0.3737971688322471, 'support': 56849}, 'accuracy': 0.3474786931818182, 'macro avg': {'precision': 0.33236244883258953, 'recall': 0.3322398848094071, 'f1-score': 0.3186462661729402, 'support': 163328}, 'weighted avg': {'precision': 0.33573900446124494, 'recall': 0.3474786931818182, 'f1-score': 0.3291372612215006, 'support': 163328}}
[[28423  7170 24060]
 [23982  5819 17025]
 [26884  7454 22511]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/WBA
Evaluating performance on  test set...
5696/5696 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967573
{'0': {'precision': 0.38329103214890015, 'recall': 0.762184896509141, 'f1-score': 0.510073810129804, 'support': 558745}, '1': {'precision': 0.2354369324371943, 'recall': 0.21352445678465773, 'f1-score': 0.2239459530933367, 'support': 341071}, '2': {'precision': 0.38230055559986176, 'recall': 0.025762798096766796, 'f1-score': 0.0482725632526329, 'support': 558208}, 'accuracy': 0.35189749962963573, 'macro avg': {'precision': 0.3336761733953188, 'recall': 0.33382405046352187, 'f1-score': 0.26076410882525786, 'support': 1458024}, 'weighted avg': {'precision': 0.34832477811175344, 'recall': 0.35189749962963573, 'f1-score': 0.2663390946902112, 'support': 1458024}}
[[425867 118716  14162]
 [259170  72827   9074]
 [426043 117784  14381]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.126728
{'0': {'precision': 0.3277857722194605, 'recall': 0.6530496291238148, 'f1-score': 0.4364858297056195, 'support': 191843}, '1': {'precision': 0.3179697082822249, 'recall': 0.1248364234042776, 'f1-score': 0.1792847853378739, 'support': 191042}, '2': {'precision': 0.3589066918001885, 'recall': 0.21527560920456137, 'f1-score': 0.2691265703929811, 'support': 185734}, 'accuracy': 0.3325882532943852, 'macro avg': {'precision': 0.3348873907672913, 'recall': 0.3310538872442179, 'f1-score': 0.2949657284788248, 'support': 568619}, 'weighted avg': {'precision': 0.3346531691771942, 'recall': 0.3325882532943852, 'f1-score': 0.29540629035277266, 'support': 568619}}
[[125283  26325  40235]
 [136007  23849  31186]
 [120920  24830  39984]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1390272
{'0': {'precision': 0.3773686019939736, 'recall': 0.581215349155921, 'f1-score': 0.4576175587027159, 'support': 64212}, '1': {'precision': 0.2337337196545613, 'recall': 0.208753109062131, 'f1-score': 0.2205382737020915, 'support': 39803}, '2': {'precision': 0.34125850340136055, 'recall': 0.1676861879930472, 'f1-score': 0.22487448448986908, 'support': 59832}, 'accuracy': 0.3397254755961354, 'macro avg': {'precision': 0.31745360834996517, 'recall': 0.3192182154036997, 'f1-score': 0.30101010563155883, 'support': 163847}, 'weighted avg': {'precision': 0.32928936562865196, 'recall': 0.3397254755961354, 'f1-score': 0.31503362126606527, 'support': 163847}}
[[37321 14377 12514]
 [24641  8309  6853]
 [36936 12863 10033]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 169s - 169s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1174649
{'0': {'precision': 0.2492065827176216, 'recall': 0.7320778716492964, 'f1-score': 0.37183636990277646, 'support': 775173}, '1': {'precision': 0.4729950488125542, 'recall': 0.22595734644338772, 'f1-score': 0.30581970055745883, 'support': 1496663}, '2': {'precision': 0.2567977080683029, 'recall': 0.030390229692315602, 'f1-score': 0.05434867072419292, 'support': 817006}, 'accuracy': 0.301244932566962, 'macro avg': {'precision': 0.3263331131994929, 'recall': 0.3294751492616666, 'f1-score': 0.24400158039480938, 'support': 3088842}, 'weighted avg': {'precision': 0.3596485904309649, 'recall': 0.301244932566962, 'f1-score': 0.2558725033315925, 'support': 3088842}}
[[ 567487  183928   23758]
 [1110381  338182   48100]
 [ 599307  192870   24829]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1161486
{'0': {'precision': 0.3267515014229016, 'recall': 0.6818241399444702, 'f1-score': 0.44178552861179887, 'support': 251757}, '1': {'precision': 0.37248620751023315, 'recall': 0.11726147123088128, 'f1-score': 0.1783705471280041, 'support': 249886}, '2': {'precision': 0.3607697981805012, 'recall': 0.2147176661828278, 'f1-score': 0.2692105524149559, 'support': 252839}, 'accuracy': 0.33830495624812784, 'macro avg': {'precision': 0.3533358357045453, 'recall': 0.33793442578605976, 'f1-score': 0.296455542718253, 'support': 754482}, 'weighted avg': {'precision': 0.35329900673016357, 'recall': 0.33830495624812784, 'f1-score': 0.29670930350676905, 'support': 754482}}
[[171654  24280  55823]
 [180215  29302  40369]
 [173466  25084  54289]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1072986
{'0': {'precision': 0.3357945267188468, 'recall': 0.8061610733718612, 'f1-score': 0.47410683229813666, 'support': 59178}, '1': {'precision': 0.3962380274647075, 'recall': 0.16376267845219547, 'f1-score': 0.23174613887670276, 'support': 62902}, '2': {'precision': 0.3776981899138515, 'recall': 0.06928267045454546, 'f1-score': 0.11708751556615807, 'support': 56320}, 'accuracy': 0.3470291479820628, 'macro avg': {'precision': 0.3699102480324686, 'recall': 0.34640214075953407, 'f1-score': 0.27431349558033247, 'support': 178400}, 'weighted avg': {'precision': 0.37033506144451267, 'recall': 0.3470291479820628, 'f1-score': 0.2759437142715668, 'support': 178400}}
[[47707  8222  3249]
 [49421 10301  3180]
 [44944  7474  3902]]
testing model on single stock: results/universal/W1/deepLOB_L2/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 294s - 294s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998634
{'0': {'precision': 0.3762227225244683, 'recall': 0.7247293527829222, 'f1-score': 0.49531611105099027, 'support': 2058861}, '1': {'precision': 0.2390413833118466, 'recall': 0.2411170596006048, 'f1-score': 0.24007473498710358, 'support': 1308829}, '2': {'precision': 0.38076743565808774, 'recall': 0.03265576282792645, 'f1-score': 0.06015265286023324, 'support': 2098527}, 'accuracy': 0.3432404897207703, 'macro avg': {'precision': 0.3320105138314675, 'recall': 0.3328340584038178, 'f1-score': 0.26518116629944233, 'support': 5466217}, 'weighted avg': {'precision': 0.3451208266791037, 'recall': 0.3432404897207703, 'f1-score': 0.267138272260654, 'support': 5466217}}
[[1492117  498552   68192]
 [ 949993  315581   43255]
 [1523937  506061   68529]]
Evaluating performance on  train set...
6073/6073 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1056992
{'0': {'precision': 0.3311064439835031, 'recall': 0.7417220983225056, 'f1-score': 0.4578345126270818, 'support': 515650}, '1': {'precision': 0.34543124962364763, 'recall': 0.20106161122675292, 'f1-score': 0.2541770207549469, 'support': 513559}, '2': {'precision': 0.3671150555179687, 'recall': 0.07023574984058095, 'f1-score': 0.11791267278418414, 'support': 525345}, 'accuracy': 0.3361890291363311, 'macro avg': {'precision': 0.34788424970837317, 'recall': 0.33767315312994645, 'f1-score': 0.2766414020554043, 'support': 1554554}, 'weighted avg': {'precision': 0.34800748240759183, 'recall': 0.3361890291363311, 'f1-score': 0.27568170428422023, 'support': 1554554}}
[[382469  97186  35995]
 [382687 103257  27615]
 [389968  98479  36898]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121142
{'0': {'precision': 0.344254222866507, 'recall': 0.5584517662696181, 'f1-score': 0.4259401867701246, 'support': 156488}, '1': {'precision': 0.2947297514678678, 'recall': 0.20613735927600538, 'f1-score': 0.24259853108513502, 'support': 142211}, '2': {'precision': 0.346182357301705, 'recall': 0.22687925094956277, 'f1-score': 0.2741122168565407, 'support': 158494}, 'accuracy': 0.3339180608626991, 'macro avg': {'precision': 0.3283887772120266, 'recall': 0.33048945883172876, 'f1-score': 0.31421697823726674, 'support': 457193}, 'weighted avg': {'precision': 0.32951793674029856, 'recall': 0.3339180608626991, 'f1-score': 0.31627747876693635, 'support': 457193}}
[[87391 34637 34460]
 [79442 29315 33454]
 [87023 35512 35959]]
training model: results/universal/W1/deepLOB_L2/h1000
Epoch 1/50
10622/10622 - 431s - loss: 3.1725 - accuracy1000: 0.4366 - val_loss: 3.3958 - val_accuracy1000: 0.3281 - 431s/epoch - 41ms/step
Epoch 2/50
10622/10622 - 429s - loss: 3.1226 - accuracy1000: 0.4567 - val_loss: 3.5096 - val_accuracy1000: 0.3312 - 429s/epoch - 40ms/step
Epoch 3/50
10622/10622 - 427s - loss: 3.1006 - accuracy1000: 0.4641 - val_loss: 3.5641 - val_accuracy1000: 0.3388 - 427s/epoch - 40ms/step
Epoch 4/50
10622/10622 - 427s - loss: 3.0883 - accuracy1000: 0.4684 - val_loss: 3.5212 - val_accuracy1000: 0.3438 - 427s/epoch - 40ms/step
Epoch 5/50
10622/10622 - 430s - loss: 3.0755 - accuracy1000: 0.4722 - val_loss: 3.6788 - val_accuracy1000: 0.3404 - 430s/epoch - 40ms/step
Epoch 6/50
10622/10622 - 425s - loss: 3.0689 - accuracy1000: 0.4743 - val_loss: 3.6235 - val_accuracy1000: 0.3409 - 425s/epoch - 40ms/step
Epoch 7/50
10622/10622 - 425s - loss: 3.0629 - accuracy1000: 0.4766 - val_loss: 3.6470 - val_accuracy1000: 0.3408 - 425s/epoch - 40ms/step
Epoch 8/50
10622/10622 - 422s - loss: 3.0558 - accuracy1000: 0.4781 - val_loss: 3.6976 - val_accuracy1000: 0.3418 - 422s/epoch - 40ms/step
Epoch 9/50
10622/10622 - 424s - loss: 3.0520 - accuracy1000: 0.4798 - val_loss: 3.8538 - val_accuracy1000: 0.3443 - 424s/epoch - 40ms/step
Epoch 10/50
10622/10622 - 425s - loss: 3.0464 - accuracy1000: 0.4816 - val_loss: 3.9176 - val_accuracy1000: 0.3442 - 425s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 424s - loss: 3.0408 - accuracy1000: 0.4829 - val_loss: 3.8259 - val_accuracy1000: 0.3416 - 424s/epoch - 40ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 476s - 476s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1196281
{'0': {'precision': 0.3493017675706863, 'recall': 0.2749931270605104, 'f1-score': 0.30772503884969815, 'support': 3190047}, '1': {'precision': 0.284433768229675, 'recall': 0.6745961308923647, 'f1-score': 0.40015002601802563, 'support': 2633217}, '2': {'precision': 0.29745454545454547, 'recall': 0.02677169067202065, 'f1-score': 0.04912224979095763, 'support': 3223517}, 'accuracy': 0.30285888428160246, 'macro avg': {'precision': 0.3103966937516356, 'recall': 0.3254536495416319, 'f1-score': 0.2523324382195605, 'support': 9046781}, 'weighted avg': {'precision': 0.3119468320953061, 'recall': 0.30285888428160246, 'f1-score': 0.24248244710995753, 'support': 9046781}}
[[ 877241 2224648   88158]
 [ 741191 1776358  115668]
 [ 892981 2244237   86299]]
Evaluating performance on  train set...
10622/10622 - 150s - 150s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1194036
{'0': {'precision': 0.3329807888245891, 'recall': 0.2961077568045607, 'f1-score': 0.3134636455326155, 'support': 899507}, '1': {'precision': 0.33793651021139376, 'recall': 0.6507545926325795, 'f1-score': 0.4448583291701695, 'support': 905853}, '2': {'precision': 0.3435204315886134, 'recall': 0.06554754181660487, 'f1-score': 0.11008889142298008, 'support': 913154}, 'accuracy': 0.33683622743896113, 'macro avg': {'precision': 0.33814591020819873, 'recall': 0.3374699637512484, 'f1-score': 0.2894702887085883, 'support': 2718514}, 'weighted avg': {'precision': 0.33817240160787476, 'recall': 0.33683622743896113, 'f1-score': 0.28893252233181504, 'support': 2718514}}
[[266351 566709  66447]
 [268427 589488  47938]
 [265121 588178  59855]]
Evaluating performance on  val set...
3064/3064 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1319342
{'0': {'precision': 0.34070751774734903, 'recall': 0.2110940985078802, 'f1-score': 0.26067827347742983, 'support': 271694}, '1': {'precision': 0.3172082154769345, 'recall': 0.6019301541759554, 'f1-score': 0.4154699582828161, 'support': 245369}, '2': {'precision': 0.3500206895631165, 'recall': 0.19663311024876742, 'f1-score': 0.25180711032795666, 'support': 266715}, 'accuracy': 0.32852797603403006, 'macro avg': {'precision': 0.33597880759580007, 'recall': 0.3365524543108677, 'f1-score': 0.3093184473627342, 'support': 783778}, 'weighted avg': {'precision': 0.3365200594645867, 'recall': 0.32852797603403006, 'f1-score': 0.30611844739096283, 'support': 783778}}
[[ 57353 160925  53416]
 [ 53701 147695  43973]
 [ 57281 156989  52445]]
testing model out of sample: results/universal/W1/deepLOB_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 329s - 329s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1276078
{'0': {'precision': 0.3472737380983254, 'recall': 0.29497044245093673, 'f1-score': 0.31899234366233903, 'support': 2115534}, '1': {'precision': 0.3120836824160798, 'recall': 0.6378234632300297, 'f1-score': 0.4191026376600455, 'support': 1847853}, '2': {'precision': 0.3793000469830956, 'recall': 0.09336321740380343, 'f1-score': 0.14984313533944763, 'support': 2135809}, 'accuracy': 0.3282449030987035, 'macro avg': {'precision': 0.3462191558325003, 'recall': 0.34205237436159, 'f1-score': 0.2959793722206107, 'support': 6099196}, 'weighted avg': {'precision': 0.3478272583967824, 'recall': 0.3282449030987035, 'f1-score': 0.2900899613836973, 'support': 6099196}}
[[ 624020 1299055  192459]
 [ 535393 1178604  133856]
 [ 637498 1298905  199406]]
Evaluating performance on  train set...
6711/6711 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1328455
{'0': {'precision': 0.33779770189507724, 'recall': 0.2400279326245831, 'f1-score': 0.2806413533335612, 'support': 581399}, '1': {'precision': 0.34504421114920225, 'recall': 0.5965333873270956, 'f1-score': 0.43720324779927433, 'support': 563028}, '2': {'precision': 0.3596950035977966, 'recall': 0.20768402254687518, 'f1-score': 0.26332628382408757, 'support': 572851}, 'accuracy': 0.34612275939015114, 'macro avg': {'precision': 0.34751230554735874, 'recall': 0.3480817808328513, 'f1-score': 0.32705696165230774, 'support': 1717278}, 'weighted avg': {'precision': 0.34747806744453164, 'recall': 0.34612275939015114, 'f1-score': 0.3261958735880978, 'support': 1717278}}
[[139552 319561 122286]
 [137663 335865  89500]
 [135908 317971 118972]]
Evaluating performance on  val set...
1720/1720 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1362147
{'0': {'precision': 0.36918549392059813, 'recall': 0.3282277902617034, 'f1-score': 0.34750395960211794, 'support': 159761}, '1': {'precision': 0.32614198107598485, 'recall': 0.5912205336659122, 'f1-score': 0.4203830721312014, 'support': 129894}, '2': {'precision': 0.40201770706357864, 'recall': 0.16687971877122199, 'f1-score': 0.23585482671986302, 'support': 150198}, 'accuracy': 0.3507967434574733, 'macro avg': {'precision': 0.3657817273533872, 'recall': 0.36210934756627927, 'f1-score': 0.3345806194843941, 'support': 439853}, 'weighted avg': {'precision': 0.3676855352803506, 'recall': 0.3507967434574733, 'f1-score': 0.330900873985341, 'support': 439853}}
[[52438 82696 24627]
 [40442 76796 12656]
 [49157 75976 25065]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1245586
{'0': {'precision': 0.3187018701870187, 'recall': 0.2035982851922131, 'f1-score': 0.24846691539088298, 'support': 56916}, '1': {'precision': 0.3949747759220258, 'recall': 0.6260441573766419, 'f1-score': 0.48436251809407116, 'support': 64406}, '2': {'precision': 0.2938258169830042, 'recall': 0.1898027540007443, 'f1-score': 0.230627190393046, 'support': 48366}, 'accuracy': 0.3600077789826034, 'macro avg': {'precision': 0.3358341543640162, 'recall': 0.3398150655231998, 'f1-score': 0.32115220795933336, 'support': 169688}, 'weighted avg': {'precision': 0.34056126847978835, 'recall': 0.3600077789826034, 'f1-score': 0.3329175309232491, 'support': 169688}}
[[11588 32751 12577]
 [14599 40321  9486]
 [10173 29013  9180]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098207
{'0': {'precision': 0.32129102251152697, 'recall': 0.2776189360206234, 'f1-score': 0.2978627105858687, 'support': 21335}, '1': {'precision': 0.3322358824755157, 'recall': 0.7196244809532406, 'f1-score': 0.45459470247768935, 'support': 22156}, '2': {'precision': 0.45918367346938777, 'recall': 0.001953803403959708, 'f1-score': 0.003891050583657587, 'support': 23032}, 'accuracy': 0.32938983509462894, 'macro avg': {'precision': 0.37090352615214345, 'recall': 0.3330657401259412, 'f1-score': 0.2521161545490719, 'support': 66523}, 'weighted avg': {'precision': 0.3726783299724591, 'recall': 0.32938983509462894, 'f1-score': 0.24828284706775097, 'support': 66523}}
[[ 5923 15379    33]
 [ 6192 15944    20]
 [ 6320 16667    45]]
Evaluating performance on  val set...
51/51 - 1s - 937ms/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0860335
{'0': {'precision': 0.3648068669527897, 'recall': 0.2605517566611648, 'f1-score': 0.3039889958734525, 'support': 4241}, '1': {'precision': 0.424223127865512, 'recall': 0.6323082763857252, 'f1-score': 0.5077743902439026, 'support': 5268}, '2': {'precision': 0.38555442522889116, 'recall': 0.22708208508088676, 'f1-score': 0.28582202111613875, 'support': 3338}, 'accuracy': 0.40429672297034325, 'macro avg': {'precision': 0.39152814001573094, 'recall': 0.37331403937592555, 'f1-score': 0.3658618024111646, 'support': 12847}, 'weighted avg': {'precision': 0.39456169002540176, 'recall': 0.40429672297034325, 'f1-score': 0.3828323130528421, 'support': 12847}}
[[1105 2624  512]
 [1241 3331  696]
 [ 683 1897  758]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1590403
{'0': {'precision': 0.4136068125629521, 'recall': 0.25737745084073593, 'f1-score': 0.31730421374657114, 'support': 175501}, '1': {'precision': 0.2042317266349853, 'recall': 0.5290028369792033, 'f1-score': 0.29469195303214346, 'support': 85302}, '2': {'precision': 0.40503026967528893, 'recall': 0.22968409620054056, 'f1-score': 0.29313661837749994, 'support': 160207}, 'accuracy': 0.3018740647490558, 'macro avg': {'precision': 0.3409562696244088, 'recall': 0.33868812800682657, 'f1-score': 0.30171092838540486, 'support': 421010}, 'weighted avg': {'precision': 0.3679211143937132, 'recall': 0.3018740647490558, 'f1-score': 0.3035261823108454, 'support': 421010}}
[[45170 95002 35329]
 [21453 45125 18724]
 [42587 80823 36797]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.144262
{'0': {'precision': 0.33053344360591336, 'recall': 0.2138914905004014, 'f1-score': 0.2597173144876325, 'support': 59792}, '1': {'precision': 0.35504577081648747, 'recall': 0.6636190618352801, 'f1-score': 0.4625960056449043, 'support': 53594}, '2': {'precision': 0.34645135992585463, 'recall': 0.18155495778226108, 'f1-score': 0.238254581111724, 'support': 53532}, 'accuracy': 0.34791933763884064, 'macro avg': {'precision': 0.34401019144941847, 'recall': 0.3530218367059808, 'f1-score': 0.32018930041475363, 'support': 166918}, 'weighted avg': {'precision': 0.3435088660346664, 'recall': 0.34791933763884064, 'f1-score': 0.3179742881561625, 'support': 166918}}
[[12789 33335 13668]
 [13362 35566  4666]
 [12541 31272  9719]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1310693
{'0': {'precision': 0.41718388706340515, 'recall': 0.17193299227605577, 'f1-score': 0.24350914580003552, 'support': 19938}, '1': {'precision': 0.1941977190308509, 'recall': 0.8218416370106761, 'f1-score': 0.3141606087658887, 'support': 8992}, '2': {'precision': 0.15789473684210525, 'recall': 0.0001728110599078341, 'f1-score': 0.00034524426031417227, 'support': 17360}, 'accuracy': 0.2337653920933247, 'macro avg': {'precision': 0.2564254476454538, 'recall': 0.3313158134488799, 'f1-score': 0.18600499960874609, 'support': 46290}, 'weighted avg': {'precision': 0.27662758395710796, 'recall': 0.2337653920933247, 'f1-score': 0.16604041873715777, 'support': 46290}}
[[ 3428 16495    15]
 [ 1601  7390     1]
 [ 3188 14169     3]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1155509
{'0': {'precision': 0.3577729649780783, 'recall': 0.28438625809323065, 'f1-score': 0.3168862521989744, 'support': 119081}, '1': {'precision': 0.29602042060878503, 'recall': 0.6860910036243956, 'f1-score': 0.4135924752680123, 'support': 99051}, '2': {'precision': 0.4776540953646785, 'recall': 0.04867395224027156, 'f1-score': 0.08834533037312457, 'support': 118133}, 'accuracy': 0.31990543172795266, 'macro avg': {'precision': 0.3771491603171806, 'recall': 0.33971707131929924, 'f1-score': 0.27294135261337044, 'support': 336265}, 'weighted avg': {'precision': 0.38169834021379234, 'recall': 0.31990543172795266, 'f1-score': 0.26508372557014936, 'support': 336265}}
[[33865 82038  3178]
 [27983 67958  3110]
 [32807 79576  5750]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1307641
{'0': {'precision': 0.33049192949652156, 'recall': 0.2584620016343383, 'f1-score': 0.29007228275953617, 'support': 46502}, '1': {'precision': 0.33627463286054976, 'recall': 0.6039041543628699, 'f1-score': 0.43199793603315245, 'support': 44363}, '2': {'precision': 0.3286246593626606, 'recall': 0.13693138368131996, 'f1-score': 0.19331305002126478, 'support': 43153}, 'accuracy': 0.3336790580369801, 'macro avg': {'precision': 0.3317970739065773, 'recall': 0.3330991798928427, 'f1-score': 0.3051277562713178, 'support': 134018}, 'weighted avg': {'precision': 0.3318048856759294, 'recall': 0.3336790580369801, 'f1-score': 0.3058969972443279, 'support': 134018}}
[[12019 27388  7095]
 [12595 26791  4977]
 [11753 25491  5909]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126652
{'0': {'precision': 0.37316938380768166, 'recall': 0.2565295849558363, 'f1-score': 0.30404682838971125, 'support': 10529}, '1': {'precision': 0.2871356783919598, 'recall': 0.726417493007882, 'f1-score': 0.41158251098465753, 'support': 7866}, '2': {'precision': 0.28125, 'recall': 0.0010256410256410256, 'f1-score': 0.002043828772567276, 'support': 8775}, 'accuracy': 0.31004784688995213, 'macro avg': {'precision': 0.3138516873998805, 'recall': 0.3279909063297865, 'f1-score': 0.23922438938231202, 'support': 27170}, 'weighted avg': {'precision': 0.3185748413081427, 'recall': 0.31004784688995213, 'f1-score': 0.2376426825542828, 'support': 27170}}
[[2701 7810   18]
 [2147 5714    5]
 [2390 6376    9]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125633
{'0': {'precision': 0.33928995103854365, 'recall': 0.2773776041896264, 'f1-score': 0.30522583180126994, 'support': 113423}, '1': {'precision': 0.30721516619203026, 'recall': 0.7215278862677706, 'f1-score': 0.43094202961939165, 'support': 102416}, '2': {'precision': 0.3458333333333333, 'recall': 0.0014079489745721023, 'f1-score': 0.002804480410873275, 'support': 117902}, 'accuracy': 0.31618230903604894, 'macro avg': {'precision': 0.33077948352130243, 'recall': 0.33343781314398974, 'f1-score': 0.24632411394384493, 'support': 333741}, 'weighted avg': {'precision': 0.3317586818641832, 'recall': 0.31618230903604894, 'f1-score': 0.23696711604297296, 'support': 333741}}
[[31461 81781   181]
 [28387 73896   133]
 [32878 84858   166]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1282016
{'0': {'precision': 0.3351920396096717, 'recall': 0.2162774107502869, 'f1-score': 0.26291380740517306, 'support': 32241}, '1': {'precision': 0.3314534377719756, 'recall': 0.586250423324405, 'f1-score': 0.42348022372707966, 'support': 32481}, '2': {'precision': 0.33296653828840095, 'recall': 0.19857415582866006, 'f1-score': 0.24878076125343346, 'support': 33524}, 'accuracy': 0.3325529792561529, 'macro avg': {'precision': 0.3332040052233494, 'recall': 0.3337006633011173, 'f1-score': 0.3117249307952287, 'support': 98246}, 'weighted avg': {'precision': 0.33319662775998327, 'recall': 0.3325529792561529, 'f1-score': 0.31117594051350245, 'support': 98246}}
[[ 6973 18726  6542]
 [ 6645 19042  6794]
 [ 7185 19682  6657]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1207019
{'0': {'precision': 0.2749208860759494, 'recall': 0.21296154435422093, 'f1-score': 0.24000690667357336, 'support': 6527}, '1': {'precision': 0.42293801135107245, 'recall': 0.6414756847400782, 'f1-score': 0.509772565742715, 'support': 8945}, '2': {'precision': 0.3946998594659707, 'recall': 0.24176094441711757, 'f1-score': 0.29985510562037676, 'support': 8132}, 'accuracy': 0.38527368242670734, 'macro avg': {'precision': 0.3641862522976642, 'recall': 0.36539939117047227, 'f1-score': 0.34987819267888837, 'support': 23604}, 'weighted avg': {'precision': 0.3722796302376859, 'recall': 0.38527368242670734, 'f1-score': 0.36285639719250556, 'support': 23604}}
[[1390 3292 1845]
 [2037 5738 1170]
 [1629 4537 1966]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.14156
{'0': {'precision': 0.3493289816040535, 'recall': 0.26012950814099733, 'f1-score': 0.2982016911506839, 'support': 235352}, '1': {'precision': 0.2958403185247276, 'recall': 0.4809569138276553, 'f1-score': 0.3663412809866895, 'support': 199600}, '2': {'precision': 0.3780794939126283, 'recall': 0.2726415906352212, 'f1-score': 0.3168183636727345, 'support': 232360}, 'accuracy': 0.3305380391780756, 'macro avg': {'precision': 0.3410829313471364, 'recall': 0.33790933753462465, 'f1-score': 0.327120445270036, 'support': 667312}, 'weighted avg': {'precision': 0.34334097582772544, 'recall': 0.3305380391780756, 'f1-score': 0.32506533538080473, 'support': 667312}}
[[ 61222 117745  56385]
 [ 55777  95999  47824]
 [ 58257 110752  63351]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.131042
{'0': {'precision': 0.3346690552517443, 'recall': 0.22564086264164138, 'f1-score': 0.2695473055711126, 'support': 62923}, '1': {'precision': 0.3252347439750602, 'recall': 0.5806145232779019, 'f1-score': 0.41692591174499855, 'support': 60014}, '2': {'precision': 0.33415912067885417, 'recall': 0.1900620313233889, 'f1-score': 0.2423059848649095, 'support': 61743}, 'accuracy': 0.3290989820229586, 'macro avg': {'precision': 0.33135430663521953, 'recall': 0.33210580574764403, 'f1-score': 0.3095930673936736, 'support': 184680}, 'weighted avg': {'precision': 0.33143277819254524, 'recall': 0.3290989820229586, 'f1-score': 0.308332332680472, 'support': 184680}}
[[14198 36403 12322]
 [14108 34845 11061]
 [14118 35890 11735]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173359
{'0': {'precision': 0.3457484188334505, 'recall': 0.3013321084060634, 'f1-score': 0.3220158717172543, 'support': 19593}, '1': {'precision': 0.3337133591750906, 'recall': 0.7034821619312113, 'f1-score': 0.4526849385686056, 'support': 18724}, '2': {'precision': 0.5285073670723895, 'recall': 0.04168561467333636, 'f1-score': 0.07727613338328963, 'support': 19791}, 'accuracy': 0.3424829627590005, 'macro avg': {'precision': 0.40265638169364354, 'recall': 0.34883329500353705, 'f1-score': 0.2839923145563832, 'support': 58108}, 'weighted avg': {'precision': 0.4041162492105709, 'recall': 0.3424829627590005, 'f1-score': 0.2807651566067223, 'support': 58108}}
[[ 5904 13272   417]
 [ 5233 13172   319]
 [ 5939 13027   825]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016332
{'0': {'precision': 0.24470912105648585, 'recall': 0.28489389973368007, 'f1-score': 0.2632769567445716, 'support': 350706}, '1': {'precision': 0.4773342363311303, 'recall': 0.5526775145262374, 'f1-score': 0.5122502711530724, 'support': 665692}, '2': {'precision': 0.24212880048324026, 'recall': 0.130043171282133, 'f1-score': 0.1692077827581802, 'support': 351391}, 'accuracy': 0.3754402177528844, 'macro avg': {'precision': 0.32139071929028545, 'recall': 0.32253819518068344, 'f1-score': 0.31491167021860805, 'support': 1367789}, 'weighted avg': {'precision': 0.3572630140990935, 'recall': 0.3754402177528844, 'f1-score': 0.3602834997851807, 'support': 1367789}}
[[ 99914 202052  48740]
 [203489 367913  94290]
 [104894 200801  45696]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1098291
{'0': {'precision': 0.3223311789614442, 'recall': 0.27232928815538004, 'f1-score': 0.2952280347219033, 'support': 106217}, '1': {'precision': 0.3319243659646841, 'recall': 0.727237855166178, 'f1-score': 0.4558092408617477, 'support': 109491}, '2': {'precision': 0.48073394495412847, 'recall': 0.0022888292900261208, 'f1-score': 0.0045559670996574335, 'support': 114469}, 'accuracy': 0.32956262852954626, 'macro avg': {'precision': 0.37832982996008563, 'recall': 0.333951990870528, 'f1-score': 0.25186441422776945, 'support': 330177}, 'weighted avg': {'precision': 0.38042902907998155, 'recall': 0.32956262852954626, 'f1-score': 0.24770581461816146, 'support': 330177}}
[[28926 77169   122]
 [29704 79626   161]
 [31110 83097   262]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065601
{'0': {'precision': 0.31418571134445133, 'recall': 0.2631669713379092, 'f1-score': 0.2864221629941064, 'support': 28993}, '1': {'precision': 0.3934776278753761, 'recall': 0.6914155770324047, 'f1-score': 0.5015361141466834, 'support': 35180}, '2': {'precision': 0.39623201305444294, 'recall': 0.09316033622824457, 'f1-score': 0.1508528182536993, 'support': 28671}, 'accuracy': 0.372937400370514, 'macro avg': {'precision': 0.36796511742475685, 'recall': 0.34924762819951943, 'f1-score': 0.31293703179816307, 'support': 92844}, 'weighted avg': {'precision': 0.36956720223115486, 'recall': 0.372937400370514, 'f1-score': 0.32606716017750487, 'support': 92844}}
[[ 7630 19018  2345]
 [ 9131 24324  1725]
 [ 7524 18476  2671]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 97s - 97s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1612612
{'0': {'precision': 0.3937392845386911, 'recall': 0.3404905161481801, 'f1-score': 0.3651840121307441, 'support': 741260}, '1': {'precision': 0.21722624474231414, 'recall': 0.4761208432304038, 'f1-score': 0.29833814726443136, 'support': 404160}, '2': {'precision': 0.38591690036424586, 'recall': 0.1730929100480143, 'f1-score': 0.23899215389974438, 'support': 691669}, 'accuracy': 0.3073035655866428, 'macro avg': {'precision': 0.3322941432150837, 'recall': 0.32990142314219945, 'f1-score': 0.30083810443163994, 'support': 1837089}, 'weighted avg': {'precision': 0.3519612265329777, 'recall': 0.3073035655866428, 'f1-score': 0.30296632908155796, 'support': 1837089}}
[[252392 369939 118929]
 [140153 192429  71578]
 [248468 323478 119723]]
Evaluating performance on  train set...
2257/2257 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1436607
{'0': {'precision': 0.3371566117137711, 'recall': 0.2105005698609136, 'f1-score': 0.25918279276118683, 'support': 198294}, '1': {'precision': 0.36013611398834633, 'recall': 0.5405071879223672, 'f1-score': 0.43226026958323543, 'support': 187189}, '2': {'precision': 0.3784621971752753, 'recall': 0.3405139204131354, 'f1-score': 0.35848658484118573, 'support': 192092}, 'accuracy': 0.3606942821278622, 'macro avg': {'precision': 0.3585849742924642, 'recall': 0.3638405593988054, 'f1-score': 0.34997654906186937, 'support': 577575}, 'weighted avg': {'precision': 0.35834170901498175, 'recall': 0.3606942821278622, 'f1-score': 0.34830310412693777, 'support': 577575}}
[[ 41741  90939  65614]
 [ 44205 101177  41807]
 [ 37857  88825  65410]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1782233
{'0': {'precision': 0.4073867206590798, 'recall': 0.35027688982936384, 'f1-score': 0.37667944321162, 'support': 66633}, '1': {'precision': 0.21400109225510225, 'recall': 0.3050573784672164, 'f1-score': 0.25154242103636426, 'support': 34682}, '2': {'precision': 0.39367811014718096, 'recall': 0.35929563156112426, 'f1-score': 0.37570188011128913, 'support': 62013}, 'accuracy': 0.34409899098746083, 'macro avg': {'precision': 0.338355307687121, 'recall': 0.33820996661923486, 'f1-score': 0.33464124811975776, 'support': 163328}, 'weighted avg': {'precision': 0.36111717454340386, 'recall': 0.34409899098746083, 'f1-score': 0.34973596858618505, 'support': 163328}}
[[23340 20262 23031]
 [12817 10580 11285]
 [21135 18597 22281]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125306
{'0': {'precision': 0.3479223828945742, 'recall': 0.2783222203766541, 'f1-score': 0.30925465742980623, 'support': 505716}, '1': {'precision': 0.3036107550521283, 'recall': 0.7222778962893925, 'f1-score': 0.42751489094479256, 'support': 442057}, '2': {'precision': 0.32861806311207836, 'recall': 0.0011837311440839901, 'f1-score': 0.002358964945546575, 'support': 510251}, 'accuracy': 0.3159371862191569, 'macro avg': {'precision': 0.32671706701959363, 'recall': 0.33392794927004354, 'f1-score': 0.24637617110671514, 'support': 1458024}, 'weighted avg': {'precision': 0.3277318279088632, 'recall': 0.3159371862191569, 'f1-score': 0.23770846207304142, 'support': 1458024}}
[[140752 364292    672]
 [122207 319288    562]
 [141591 368056    604]]
Evaluating performance on  train set...
2222/2222 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1346321
{'0': {'precision': 0.3455488377631074, 'recall': 0.4126854548614586, 'f1-score': 0.3761448952552852, 'support': 189871}, '1': {'precision': 0.3536222358211887, 'recall': 0.4751398320999685, 'f1-score': 0.4054722489323181, 'support': 197022}, '2': {'precision': 0.3121920862936265, 'recall': 0.1325071811408384, 'f1-score': 0.1860479490686013, 'support': 181726}, 'accuracy': 0.3447827103913165, 'macro avg': {'precision': 0.3371210532926409, 'recall': 0.3401108227007552, 'f1-score': 0.32255503108540157, 'support': 568619}, 'weighted avg': {'precision': 0.33768566051200677, 'recall': 0.3447827103913165, 'f1-score': 0.32555315673341917, 'support': 568619}}
[[78357 83836 27678]
 [78035 93613 25374]
 [70369 87277 24080]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1556473
{'0': {'precision': 0.3247511250511387, 'recall': 0.20403721918535908, 'f1-score': 0.2506156469028225, 'support': 58357}, '1': {'precision': 0.32868172787513233, 'recall': 0.532198100668426, 'f1-score': 0.4063837611237772, 'support': 51913}, '2': {'precision': 0.319536231884058, 'recall': 0.25719991787520763, 'f1-score': 0.2849992761266572, 'support': 53577}, 'accuracy': 0.3253950331711902, 'macro avg': {'precision': 0.32432302827010967, 'recall': 0.3311450792429976, 'f1-score': 0.313999561384419, 'support': 163847}, 'weighted avg': {'precision': 0.3242912512248819, 'recall': 0.3253950331711902, 'f1-score': 0.3112121901198348, 'support': 163847}}
[[11907 28880 17570]
 [12510 27628 11775]
 [12248 27549 13780]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 166s - 166s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106115
{'0': {'precision': 0.3108926742557124, 'recall': 0.2742622738011787, 'f1-score': 0.2914309518620389, 'support': 962925}, '1': {'precision': 0.34954618398053167, 'recall': 0.7228132322076999, 'f1-score': 0.4712162792339141, 'support': 1080636}, '2': {'precision': 0.3310952580780529, 'recall': 0.00150964190490404, 'f1-score': 0.003005579750239751, 'support': 1045281}, 'accuracy': 0.3388875183644874, 'macro avg': {'precision': 0.33051137210476567, 'recall': 0.33286171597126085, 'f1-score': 0.2552176036153976, 'support': 3088842}, 'weighted avg': {'precision': 0.3312523272115417, 'recall': 0.3388875183644874, 'f1-score': 0.2567243969924276, 'support': 3088842}}
[[264094 697338   1493]
 [297843 781098   1695]
 [287533 756170   1578]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1272268
{'0': {'precision': 0.3415092359361881, 'recall': 0.25789296399770156, 'f1-score': 0.29386888836206415, 'support': 252345}, '1': {'precision': 0.3422832096689163, 'recall': 0.63023352827449, 'f1-score': 0.4436290841737912, 'support': 249306}, '2': {'precision': 0.34268334541016743, 'recall': 0.14215820053711767, 'f1-score': 0.20095327285688325, 'support': 252831}, 'accuracy': 0.34214335133243734, 'macro avg': {'precision': 0.3421585970050906, 'recall': 0.34342823093643643, 'f1-score': 0.31281708179757955, 'support': 754482}, 'weighted avg': {'precision': 0.34215843309109334, 'recall': 0.34214335133243734, 'f1-score': 0.3122181231923822, 'support': 754482}}
[[ 65078 149973  37294]
 [ 60537 157121  31648]
 [ 64945 151944  35942]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1110901
{'0': {'precision': 0.3357377279348532, 'recall': 0.32553390623670553, 'f1-score': 0.330557091512303, 'support': 58765}, '1': {'precision': 0.37058660694063467, 'recall': 0.6973198219528365, 'f1-score': 0.48397009284364473, 'support': 63354}, '2': {'precision': 0.48868778280542985, 'recall': 0.01918942449494501, 'f1-score': 0.036928758270503154, 'support': 56281}, 'accuracy': 0.36091928251121075, 'macro avg': {'precision': 0.3983373725603059, 'recall': 0.3473477175614957, 'f1-score': 0.2838186475421503, 'support': 178400}, 'weighted avg': {'precision': 0.39636551895897426, 'recall': 0.36091928251121075, 'f1-score': 0.29240479926546487, 'support': 178400}}
[[19130 38877   758]
 [18804 44178   372]
 [19045 36156  1080]]
testing model on single stock: results/universal/W1/deepLOB_L2/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 291s - 291s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1234316
{'0': {'precision': 0.3739765870916369, 'recall': 0.2737930875956925, 'f1-score': 0.316137690507794, 'support': 2044701}, '1': {'precision': 0.24476220846838262, 'recall': 0.7246518407774247, 'f1-score': 0.36592699488387026, 'support': 1337750}, '2': {'precision': 0.3801014526170164, 'recall': 0.0015822314021823947, 'f1-score': 0.003151344841429145, 'support': 2083766}, 'accuracy': 0.28036300059071934, 'macro avg': {'precision': 0.3329467493923453, 'recall': 0.33334238659176657, 'f1-score': 0.22840534341103114, 'support': 5466217}, 'weighted avg': {'precision': 0.3446887361945905, 'recall': 0.28036300059071934, 'f1-score': 0.20900973279321325, 'support': 5466217}}
[[ 559825 1481628    3248]
 [ 366218  969403    2129]
 [ 570909 1509560    3297]]
Evaluating performance on  train set...
6073/6073 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125677
{'0': {'precision': 0.32845222262760837, 'recall': 0.27286237792978296, 'f1-score': 0.2980877378311318, 'support': 511386}, '1': {'precision': 0.3340810657868944, 'recall': 0.7039365629840336, 'f1-score': 0.4531173087812124, 'support': 513265}, '2': {'precision': 0.39482032886142615, 'recall': 0.03593299150976688, 'f1-score': 0.06587099787245083, 'support': 529903}, 'accuracy': 0.3344271089971786, 'macro avg': {'precision': 0.352451205758643, 'recall': 0.3375773108078612, 'f1-score': 0.2723586814949317, 'support': 1554554}, 'weighted avg': {'precision': 0.35293367954822336, 'recall': 0.3344271089971786, 'f1-score': 0.27011759692857595, 'support': 1554554}}
[[139538 353491  18357]
 [141130 361306  10829]
 [144167 366695  19041]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1289597
{'0': {'precision': 0.35082380881698083, 'recall': 0.20958455526067432, 'f1-score': 0.26240597628044743, 'support': 157879}, '1': {'precision': 0.3053268050747127, 'recall': 0.5825465480016246, 'f1-score': 0.40065866532058475, 'support': 140339}, '2': {'precision': 0.35644896757643296, 'recall': 0.2132662368296902, 'f1-score': 0.2668650207996348, 'support': 158975}, 'accuracy': 0.32534837585002396, 'macro avg': {'precision': 0.3375331938227088, 'recall': 0.3351324466973297, 'f1-score': 0.3099765541335557, 'support': 457193}, 'weighted avg': {'precision': 0.33881412276666456, 'recall': 0.32534837585002396, 'f1-score': 0.30639422791518733, 'support': 457193}}
[[33089 93242 31548]
 [28921 81754 29664]
 [32308 92763 33904]]
training model: results/universal/W1/deepOF_L2/h300
Epoch 1/50
10622/10622 - 230s - loss: 3.2532 - accuracy300: 0.3911 - val_loss: 3.2833 - val_accuracy300: 0.3613 - 230s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 230s - loss: 3.2399 - accuracy300: 0.3976 - val_loss: 3.2810 - val_accuracy300: 0.3635 - 230s/epoch - 22ms/step
Epoch 3/50
10622/10622 - 229s - loss: 3.2351 - accuracy300: 0.4006 - val_loss: 3.2816 - val_accuracy300: 0.3645 - 229s/epoch - 22ms/step
Epoch 4/50
10622/10622 - 229s - loss: 3.2325 - accuracy300: 0.4021 - val_loss: 3.2816 - val_accuracy300: 0.3669 - 229s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 227s - loss: 3.2300 - accuracy300: 0.4040 - val_loss: 3.2816 - val_accuracy300: 0.3684 - 227s/epoch - 21ms/step
Epoch 6/50
10622/10622 - 228s - loss: 3.2277 - accuracy300: 0.4052 - val_loss: 3.2834 - val_accuracy300: 0.3688 - 228s/epoch - 22ms/step
Epoch 7/50
10622/10622 - 227s - loss: 3.2259 - accuracy300: 0.4063 - val_loss: 3.2851 - val_accuracy300: 0.3689 - 227s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 228s - loss: 3.2242 - accuracy300: 0.4076 - val_loss: 3.2865 - val_accuracy300: 0.3678 - 228s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 229s - loss: 3.2227 - accuracy300: 0.4081 - val_loss: 3.2875 - val_accuracy300: 0.3673 - 229s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 227s - loss: 3.2216 - accuracy300: 0.4091 - val_loss: 3.2887 - val_accuracy300: 0.3677 - 227s/epoch - 21ms/step
Epoch 11/50
10622/10622 - 228s - loss: 3.2204 - accuracy300: 0.4098 - val_loss: 3.2896 - val_accuracy300: 0.3681 - 228s/epoch - 21ms/step
Epoch 12/50
10622/10622 - 228s - loss: 3.2191 - accuracy300: 0.4107 - val_loss: 3.2942 - val_accuracy300: 0.3669 - 228s/epoch - 21ms/step
testing model in sample: results/universal/W1/deepOF_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 265s - 265s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939499
{'0': {'precision': 0.37773826155449913, 'recall': 0.49316155703122416, 'f1-score': 0.4278011896270669, 'support': 3114671}, '1': {'precision': 0.33023587015982453, 'recall': 0.22646431880217124, 'f1-score': 0.26867834020042836, 'support': 2809617}, '2': {'precision': 0.38852180120938623, 'recall': 0.37995457439435726, 'f1-score': 0.38419043267391323, 'support': 3122468}, 'accuracy': 0.3712612565211221, 'macro avg': {'precision': 0.3654986443079033, 'recall': 0.3665268167425842, 'f1-score': 0.3602233208338028, 'support': 9046756}, 'weighted avg': {'precision': 0.3667075375133052, 'recall': 0.3712612565211221, 'f1-score': 0.36333084734310084, 'support': 9046756}}
[[1536036  642285  936350]
 [1242470  636278  930869]
 [1287897  648175 1186396]]
Evaluating performance on  train set...
10622/10622 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927098
{'0': {'precision': 0.3758649609310029, 'recall': 0.4684241639238903, 'f1-score': 0.4170709414328904, 'support': 911789}, '1': {'precision': 0.3437658768386981, 'recall': 0.25542098766261845, 'f1-score': 0.2930805896752211, 'support': 892734}, '2': {'precision': 0.3851170828803357, 'recall': 0.3871779498199101, 'f1-score': 0.3861447666415512, 'support': 913988}, 'accuracy': 0.37116016819501557, 'macro avg': {'precision': 0.3682493068833455, 'recall': 0.3703410338021396, 'f1-score': 0.36543209924988757, 'support': 2718511}, 'weighted avg': {'precision': 0.3684345641800489, 'recall': 0.37116016819501557, 'f1-score': 0.36595599088414604, 'support': 2718511}}
[[427104 216276 268409]
 [368117 228023 296594]
 [341102 219010 353876]]
Evaluating performance on  val set...
3064/3064 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934751
{'0': {'precision': 0.36614840225168666, 'recall': 0.47079839479040736, 'f1-score': 0.4119307957074278, 'support': 258907}, '1': {'precision': 0.3483637278593482, 'recall': 0.24922091510130917, 'f1-score': 0.29056813312696206, 'support': 266659}, '2': {'precision': 0.3717555872526442, 'recall': 0.37447813794973084, 'f1-score': 0.37311189613957646, 'support': 258210}, 'accuracy': 0.36368043930919036, 'macro avg': {'precision': 0.3620892391212263, 'recall': 0.3648324826138158, 'f1-score': 0.35853694165798883, 'support': 783776}, 'weighted avg': {'precision': 0.3619448897051308, 'recall': 0.36368043930919036, 'f1-score': 0.35785172936901055, 'support': 783776}}
[[121893  61729  75285]
 [112080  66457  88122]
 [ 98933  62583  96694]]
testing model out of sample: results/universal/W1/deepOF_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 179s - 179s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0947714
{'0': {'precision': 0.36992537211969945, 'recall': 0.5094185953699296, 'f1-score': 0.42860784954242226, 'support': 2029602}, '1': {'precision': 0.3377019018890529, 'recall': 0.2303690187148437, 'f1-score': 0.2738955751285957, 'support': 2055641}, '2': {'precision': 0.3809979983669366, 'recall': 0.359813260454197, 'f1-score': 0.3701027228907971, 'support': 2013928}, 'accuracy': 0.36596957193034924, 'macro avg': {'precision': 0.36287509079189634, 'recall': 0.3665336248463234, 'f1-score': 0.35753538252060507, 'support': 6099171}, 'weighted avg': {'precision': 0.36272104639485087, 'recall': 0.36596957193034924, 'f1-score': 0.3571460054335152, 'support': 6099171}}
[[1033917  456585  539100]
 [ 943876  473556  638209]
 [ 817141  472149  724638]]
Evaluating performance on  train set...
6711/6711 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0887568
{'0': {'precision': 0.3860591230559301, 'recall': 0.48956181466351323, 'f1-score': 0.4316932058361147, 'support': 581375}, '1': {'precision': 0.3440887012821811, 'recall': 0.23701033379646766, 'f1-score': 0.28068392140917964, 'support': 559233}, '2': {'precision': 0.3932844565412917, 'recall': 0.40567156725036674, 'f1-score': 0.39938198626541294, 'support': 576666}, 'accuracy': 0.3791474161956683, 'macro avg': {'precision': 0.37447742695980096, 'recall': 0.3774145719034492, 'f1-score': 0.37058637117023574, 'support': 1717274}, 'weighted avg': {'precision': 0.3748176783475554, 'recall': 0.3791474161956683, 'f1-score': 0.3716665840489762, 'support': 1717274}}
[[284619 124655 172101]
 [237898 132544 188791]
 [214725 128004 233937]]
Evaluating performance on  val set...
1720/1720 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901239
{'0': {'precision': 0.40340339804004566, 'recall': 0.48601159352931306, 'f1-score': 0.44087120225090837, 'support': 154914}, '1': {'precision': 0.3202665422532354, 'recall': 0.23225554950793628, 'f1-score': 0.2692514303742422, 'support': 135958}, '2': {'precision': 0.39574952463490665, 'recall': 0.4107290289235396, 'f1-score': 0.40310016238632135, 'support': 148979}, 'accuracy': 0.3820771124767251, 'macro avg': {'precision': 0.37313982164272924, 'recall': 0.37633205732026304, 'f1-score': 0.37107426500382396, 'support': 439851}, 'weighted avg': {'precision': 0.37511339291311097, 'recall': 0.3820771124767251, 'f1-score': 0.37503033183616774, 'support': 439851}}
[[75290 33324 46300]
 [57253 31577 47128]
 [54094 33695 61190]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997617
{'0': {'precision': 0.35033407801673994, 'recall': 0.5827881486555917, 'f1-score': 0.4376072992419128, 'support': 58390}, '1': {'precision': 0.39413845376452755, 'recall': 0.1314259717939645, 'f1-score': 0.19712152036290578, 'support': 59349}, '2': {'precision': 0.30015163002274453, 'recall': 0.3048667796088095, 'f1-score': 0.30249083129584353, 'support': 51944}, 'accuracy': 0.33983958322283314, 'macro avg': {'precision': 0.34820805393467064, 'recall': 0.3396936333527886, 'f1-score': 0.3124065503002207, 'support': 169683}, 'weighted avg': {'precision': 0.3502932301867001, 'recall': 0.33983958322283314, 'f1-score': 0.3121316752743921, 'support': 169683}}
[[34029  6162 18199]
 [32824  7800 18725]
 [30280  5828 15836]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0998325
{'0': {'precision': 0.3343329272483054, 'recall': 0.4920919540229885, 'f1-score': 0.398154864869892, 'support': 21750}, '1': {'precision': 0.33188335749959724, 'recall': 0.1878619306005198, 'f1-score': 0.2399184743048479, 'support': 21931}, '2': {'precision': 0.35069695872556117, 'recall': 0.3392434988179669, 'f1-score': 0.34487516133339263, 'support': 22842}, 'accuracy': 0.33931121566976835, 'macro avg': {'precision': 0.33897108115782126, 'recall': 0.3397324611471584, 'f1-score': 0.3276495001693775, 'support': 66523}, 'weighted avg': {'precision': 0.33914428110854256, 'recall': 0.33931121566976835, 'f1-score': 0.32769356171665626, 'support': 66523}}
[[10703  4035  7012]
 [10476  4120  7335]
 [10834  4259  7749]]
Evaluating performance on  val set...
51/51 - 1s - 592ms/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0951619
{'0': {'precision': 0.31811240073304825, 'recall': 0.5332821300563236, 'f1-score': 0.39850774823034246, 'support': 3906}, '1': {'precision': 0.4789373814041746, 'recall': 0.22653024591635254, 'f1-score': 0.3075798196441628, 'support': 5571}, '2': {'precision': 0.2827510917030568, 'recall': 0.3074183976261128, 'f1-score': 0.29456923514358835, 'support': 3370}, 'accuracy': 0.34101346617887446, 'macro avg': {'precision': 0.3599336246134266, 'recall': 0.3557435911995963, 'f1-score': 0.33355226767269786, 'support': 12847}, 'weighted avg': {'precision': 0.3785769726866385, 'recall': 0.34101346617887446, 'f1-score': 0.3318126225779747, 'support': 12847}}
[[2083  744 1079]
 [2760 1262 1549]
 [1705  629 1036]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0759643
{'0': {'precision': 0.3937894353543735, 'recall': 0.48874235969624, 'f1-score': 0.43615783349201315, 'support': 134975}, '1': {'precision': 0.4300552623024411, 'recall': 0.17074864633973952, 'f1-score': 0.24444366234360426, 'support': 162707}, '2': {'precision': 0.35344101904353487, 'recall': 0.5413345442455989, 'f1-score': 0.4276599424738794, 'support': 123323}, 'accuracy': 0.38125200413296756, 'macro avg': {'precision': 0.3924285722334498, 'recall': 0.40027518342719287, 'f1-score': 0.36942047943649897, 'support': 421005}, 'weighted avg': {'precision': 0.395986122235854, 'recall': 0.38125200413296756, 'f1-score': 0.35957626543682747, 'support': 421005}}
[[65968 17865 51142]
 [63943 27782 70982]
 [37610 18954 66759]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0801141
{'0': {'precision': 0.40456964580657, 'recall': 0.4669067033781637, 'f1-score': 0.43350867705619195, 'support': 56658}, '1': {'precision': 0.36420465474129643, 'recall': 0.20166500994035785, 'f1-score': 0.2595909973723295, 'support': 56336}, '2': {'precision': 0.38599010464058237, 'recall': 0.5034678436317781, 'f1-score': 0.436970867535812, 'support': 53924}, 'accuracy': 0.3891970907870931, 'macro avg': {'precision': 0.38492146839614955, 'recall': 0.39067985231676655, 'f1-score': 0.3766901806547778, 'support': 166918}, 'weighted avg': {'precision': 0.38494392949983275, 'recall': 0.3891970907870931, 'f1-score': 0.3759287201716915, 'support': 166918}}
[[26454 10070 20134]
 [21922 11361 23053]
 [17012  9763 27149]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0805653
{'0': {'precision': 0.43039664378337145, 'recall': 0.41832447794390215, 'f1-score': 0.4242747039288176, 'support': 16186}, '1': {'precision': 0.3751059450296646, 'recall': 0.2040439965751169, 'f1-score': 0.2643119187782612, 'support': 15183}, '2': {'precision': 0.37669850665949145, 'recall': 0.5629649487299779, 'f1-score': 0.45137023105857066, 'support': 14921}, 'accuracy': 0.3946640743141067, 'macro avg': {'precision': 0.39406703182417585, 'recall': 0.395111141082999, 'f1-score': 0.3799856179218832, 'support': 46290}, 'weighted avg': {'precision': 0.39495251798507924, 'recall': 0.3946640743141067, 'f1-score': 0.3805412278726964, 'support': 46290}}
[[6771 2620 6795]
 [4981 3098 7104]
 [3980 2541 8400]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010149
{'0': {'precision': 0.3775995150796056, 'recall': 0.48766614477497583, 'f1-score': 0.4256322845834863, 'support': 120076}, '1': {'precision': 0.29377510946598656, 'recall': 0.26457166668360554, 'f1-score': 0.2784096681906901, 'support': 98393}, '2': {'precision': 0.3801298462801525, 'recall': 0.29874099039824775, 'f1-score': 0.33455662144303633, 'support': 117791}, 'accuracy': 0.3562065068696842, 'macro avg': {'precision': 0.3505014902752482, 'recall': 0.3503262672856097, 'f1-score': 0.34619952473907095, 'support': 336260}, 'weighted avg': {'precision': 0.35395803378805385, 'recall': 0.3562065068696842, 'f1-score': 0.3506499247080532, 'support': 336260}}
[[58557 31267 30252]
 [45231 26032 27130]
 [51289 31313 35189]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948806
{'0': {'precision': 0.3800685641393606, 'recall': 0.5028691983122363, 'f1-score': 0.4329292103709758, 'support': 47400}, '1': {'precision': 0.3151537560855365, 'recall': 0.24677298718845755, 'f1-score': 0.27680274962449763, 'support': 41447}, '2': {'precision': 0.37208164946330663, 'recall': 0.3200061986672865, 'f1-score': 0.34408474172815995, 'support': 45171}, 'accuracy': 0.36203345819218313, 'macro avg': {'precision': 0.3557679898960679, 'recall': 0.3565494613893268, 'f1-score': 0.35127223390787776, 'support': 134018}, 'weighted avg': {'precision': 0.35730071972861815, 'recall': 0.36203345819218313, 'f1-score': 0.3546996672377854, 'support': 134018}}
[[23836 11098 12466]
 [19291 10228 11928]
 [19588 11128 14455]]
Evaluating performance on  val set...
107/107 - 1s - 988ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989648
{'0': {'precision': 0.37259615384615385, 'recall': 0.4776088742810189, 'f1-score': 0.4186172128195895, 'support': 9736}, '1': {'precision': 0.3022116669140567, 'recall': 0.24966278356836297, 'f1-score': 0.27343540155788343, 'support': 8155}, '2': {'precision': 0.3695460832390293, 'recall': 0.3167367173186766, 'f1-score': 0.3411095636025998, 'support': 9279}, 'accuracy': 0.354251012145749, 'macro avg': {'precision': 0.34811796799974665, 'recall': 0.34800279172268617, 'f1-score': 0.34438739266002427, 'support': 27170}, 'weighted avg': {'precision': 0.3504287966104247, 'recall': 0.354251012145749, 'f1-score': 0.34857116394496085, 'support': 27170}}
[[4650 2360 2726]
 [3831 2036 2288]
 [3999 2341 2939]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005633
{'0': {'precision': 0.3369627079426391, 'recall': 0.6506683962094189, 'f1-score': 0.44399368111772913, 'support': 111012}, '1': {'precision': 0.3503176980047756, 'recall': 0.0797765960388192, 'f1-score': 0.12995826201843677, 'support': 108503}, '2': {'precision': 0.338615116463318, 'recall': 0.2806401624920111, 'f1-score': 0.3069138190209013, 'support': 114221}, 'accuracy': 0.33842018841239785, 'macro avg': {'precision': 0.3419651741369109, 'recall': 0.3370283849134164, 'f1-score': 0.29362192071902243, 'support': 333736}, 'weighted avg': {'precision': 0.3418701684514019, 'recall': 0.33842018841239785, 'f1-score': 0.2949801374571942, 'support': 333736}}
[[72232  8015 30765]
 [68002  8656 31845]
 [74128  8038 32055]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002225
{'0': {'precision': 0.3338182386985766, 'recall': 0.6592425552946991, 'f1-score': 0.4432099021827169, 'support': 32372}, '1': {'precision': 0.357489539748954, 'recall': 0.06571094567156832, 'f1-score': 0.11101582599204803, 'support': 32506}, '2': {'precision': 0.3514820042342978, 'recall': 0.2985284862289088, 'f1-score': 0.32284829922050984, 'support': 33367}, 'accuracy': 0.3403531986360629, 'macro avg': {'precision': 0.3475965942272761, 'recall': 0.34116066239839204, 'f1-score': 0.29235800913175825, 'support': 98245}, 'weighted avg': {'precision': 0.3476494380122717, 'recall': 0.3403531986360629, 'f1-score': 0.2924194675886526, 'support': 98245}}
[[21341  1859  9172]
 [21163  2136  9207]
 [21426  1980  9961]]
Evaluating performance on  val set...
93/93 - 1s - 953ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034627
{'0': {'precision': 0.2970059880239521, 'recall': 0.677303435388817, 'f1-score': 0.4129348873893611, 'support': 6957}, '1': {'precision': 0.3907637655417407, 'recall': 0.07826396300249022, 'f1-score': 0.13040901007705988, 'support': 8433}, '2': {'precision': 0.3852892561983471, 'recall': 0.28378378378378377, 'f1-score': 0.32683679192372406, 'support': 8214}, 'accuracy': 0.32634299271309947, 'macro avg': {'precision': 0.35768633658801335, 'recall': 0.34645039405836364, 'f1-score': 0.29006022979671503, 'support': 23604}, 'weighted avg': {'precision': 0.3612246841174952, 'recall': 0.32634299271309947, 'f1-score': 0.28203544324729285, 'support': 23604}}
[[4712  470 1775]
 [5829  660 1944]
 [5324  559 2331]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988405
{'0': {'precision': 0.3672365847567255, 'recall': 0.563637538223007, 'f1-score': 0.44471818362537524, 'support': 232190}, '1': {'precision': 0.31458820648636804, 'recall': 0.23793162268196993, 'f1-score': 0.2709422485653713, 'support': 205185}, '2': {'precision': 0.37974870467984567, 'recall': 0.25723692222048256, 'f1-score': 0.3067114354978804, 'support': 229932}, 'accuracy': 0.35791322434801376, 'macro avg': {'precision': 0.3538578319743131, 'recall': 0.35293536104181983, 'f1-score': 0.3407906225628756, 'support': 667307}, 'weighted avg': {'precision': 0.35535941167560925, 'recall': 0.35791322434801376, 'f1-score': 0.34373260600407346, 'support': 667307}}
[[130871  52387  48932]
 [108691  48820  47674]
 [116805  53980  59147]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0981967
{'0': {'precision': 0.3535661331185131, 'recall': 0.49061188782866494, 'f1-score': 0.41096485276156874, 'support': 61727}, '1': {'precision': 0.3344916513681266, 'recall': 0.250708470522712, 'f1-score': 0.2866024362611537, 'support': 61047}, '2': {'precision': 0.3601276515862587, 'recall': 0.3098941927146434, 'f1-score': 0.33312784892554814, 'support': 61905}, 'accuracy': 0.3507328932905203, 'macro avg': {'precision': 0.3493951453576328, 'recall': 0.35040485035534014, 'f1-score': 0.3435650459827569, 'support': 184679}, 'weighted avg': {'precision': 0.3494603653448623, 'recall': 0.3507328932905203, 'f1-score': 0.3437647262579073, 'support': 184679}}
[[30284 14898 16545]
 [28201 15305 17541]
 [27168 15553 19184]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009002
{'0': {'precision': 0.3767502917152859, 'recall': 0.501358695652174, 'f1-score': 0.4302131912058627, 'support': 20608}, '1': {'precision': 0.2988468930172966, 'recall': 0.27940824149496885, 'f1-score': 0.28880084194886396, 'support': 16696}, '2': {'precision': 0.3933523518874809, 'recall': 0.28500697014853626, 'f1-score': 0.3305273720593154, 'support': 20803}, 'accuracy': 0.36012872803620904, 'macro avg': {'precision': 0.3563165122066878, 'recall': 0.3552579690985597, 'f1-score': 0.3498471350713474, 'support': 58107}, 'weighted avg': {'precision': 0.36030988889119486, 'recall': 0.36012872803620904, 'f1-score': 0.3538921854939782, 'support': 58107}}
[[10332  5375  4901]
 [ 7788  4665  4243]
 [ 9304  5570  5929]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/EXC
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0828991
{'0': {'precision': 0.38034572904549263, 'recall': 0.5459327716759503, 'f1-score': 0.4483385890770227, 'support': 445586}, '1': {'precision': 0.40055310297821667, 'recall': 0.21710818253427347, 'f1-score': 0.28158914355109205, 'support': 470991}, '2': {'precision': 0.4016231040702358, 'recall': 0.42095091609837615, 'f1-score': 0.4110599397486062, 'support': 451207}, 'accuracy': 0.3914740924005545, 'macro avg': {'precision': 0.3941739786979817, 'recall': 0.3946639567695333, 'f1-score': 0.38032922412557363, 'support': 1367784}, 'weighted avg': {'precision': 0.3943230762061093, 'recall': 0.3914740924005545, 'f1-score': 0.3786215316869447, 'support': 1367784}}
[[243260  76438 125888]
 [211638 102256 157097]
 [184678  76593 189936]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0848241
{'0': {'precision': 0.39244168196115087, 'recall': 0.5285992611244876, 'f1-score': 0.4504563769426856, 'support': 108814}, '1': {'precision': 0.33810256769047786, 'recall': 0.17740455212922174, 'f1-score': 0.23270652252425778, 'support': 108960}, '2': {'precision': 0.4137126496781031, 'recall': 0.46537014136633365, 'f1-score': 0.43802362240988774, 'support': 112403}, 'accuracy': 0.3911780650984169, 'macro avg': {'precision': 0.38141896644324397, 'recall': 0.39045798487334765, 'f1-score': 0.37372884062561035, 'support': 330177}, 'weighted avg': {'precision': 0.3817508424821928, 'recall': 0.3911780650984169, 'f1-score': 0.3743653619865197, 'support': 330177}}
[[57519 18432 32863]
 [48364 19330 41266]
 [40684 19410 52309]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0824842
{'0': {'precision': 0.3852900139525613, 'recall': 0.5119682171825857, 'f1-score': 0.43968666922562943, 'support': 30205}, '1': {'precision': 0.37910200966675145, 'recall': 0.17930515867047675, 'f1-score': 0.24346014825706055, 'support': 33245}, '2': {'precision': 0.38165152498377675, 'recall': 0.4802000408246581, 'f1-score': 0.42529151224803396, 'support': 29394}, 'accuracy': 0.38279264142001634, 'macro avg': {'precision': 0.3820145162010298, 'recall': 0.39049113889257353, 'f1-score': 0.3694794432435747, 'support': 92844}, 'weighted avg': {'precision': 0.3819223224783659, 'recall': 0.38279264142001634, 'f1-score': 0.364865658349326, 'support': 92844}}
[[15464  4930  9811]
 [14226  5961 13058]
 [10446  4833 14115]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/AAL
Evaluating performance on  test set...
7177/7177 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1028309
{'0': {'precision': 0.4217880779582508, 'recall': 0.48747476850053434, 'f1-score': 0.4522587642500876, 'support': 682183}, '1': {'precision': 0.2176562047065644, 'recall': 0.1652071640310276, 'f1-score': 0.18783914706644897, 'support': 499942}, '2': {'precision': 0.40815939222226205, 'recall': 0.41702915755031994, 'f1-score': 0.41254660533428594, 'support': 654959}, 'accuracy': 0.374657881729959, 'macro avg': {'precision': 0.3492012249623591, 'recall': 0.35657036336062725, 'f1-score': 0.35088150555027414, 'support': 1837084}, 'weighted avg': {'precision': 0.3613769441406616, 'recall': 0.374657881729959, 'f1-score': 0.36614168514790324, 'support': 1837084}}
[[332547 148428 201208]
 [222501  82594 194847]
 [233374 148448 273137]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0851169
{'0': {'precision': 0.40079157139227645, 'recall': 0.5136160839196414, 'f1-score': 0.4502433814298743, 'support': 196569}, '1': {'precision': 0.32822888875879197, 'recall': 0.20832426521718359, 'f1-score': 0.25487891205943664, 'support': 188389}, '2': {'precision': 0.4079989907860709, 'recall': 0.43656290235494455, 'f1-score': 0.4217979168181943, 'support': 192616}, 'accuracy': 0.3883415804728052, 'macro avg': {'precision': 0.37900648364571304, 'recall': 0.38616775049725655, 'f1-score': 0.3756400701025017, 'support': 577574}, 'weighted avg': {'precision': 0.3795272019354026, 'recall': 0.3883415804728052, 'f1-score': 0.3770344616518532, 'support': 577574}}
[[100961  39582  56026]
 [ 83157  39246  65986]
 [ 67786  40741  84089]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090462
{'0': {'precision': 0.42896295767611164, 'recall': 0.5054835996635828, 'f1-score': 0.4640901895679703, 'support': 59450}, '1': {'precision': 0.261636530026192, 'recall': 0.17491561181434598, 'f1-score': 0.20966253208410776, 'support': 47400}, '2': {'precision': 0.4078560641735544, 'recall': 0.44472971298050534, 'f1-score': 0.4254955107572421, 'support': 56477}, 'accuracy': 0.3885395556154218, 'macro avg': {'precision': 0.36615185062528605, 'recall': 0.37504297481947807, 'f1-score': 0.3664160774697734, 'support': 163327}, 'weighted avg': {'precision': 0.3731036894905079, 'recall': 0.3885395556154218, 'f1-score': 0.376905690740902, 'support': 163327}}
[[30051 11391 18008]
 [20651  8291 18458]
 [19353 12007 25117]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/WBA
Evaluating performance on  test set...
5696/5696 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960535
{'0': {'precision': 0.3962528442125511, 'recall': 0.45517429864810766, 'f1-score': 0.42367479581581413, 'support': 519568}, '1': {'precision': 0.31328106113954785, 'recall': 0.2825093300159943, 'f1-score': 0.29710053738052844, 'support': 422025}, '2': {'precision': 0.39863634755867927, 'recall': 0.37099797454039884, 'f1-score': 0.38432089961656773, 'support': 516426}, 'accuracy': 0.37538125360506275, 'macro avg': {'precision': 0.3693900843035927, 'recall': 0.3695605344015003, 'f1-score': 0.3683654109376368, 'support': 1458019}, 'weighted avg': {'precision': 0.37308081171341584, 'recall': 0.37538125360506275, 'f1-score': 0.37309872196852994, 'support': 1458019}}
[[236494 129339 153735]
 [167506 119226 135293]
 [192826 132007 191593]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0890747
{'0': {'precision': 0.3896523573032179, 'recall': 0.4714719349693883, 'f1-score': 0.4266751095322125, 'support': 194370}, '1': {'precision': 0.36432333233091985, 'recall': 0.2578912608005065, 'f1-score': 0.3020044998977296, 'support': 183209}, '2': {'precision': 0.38984623086474895, 'recall': 0.41577897706750977, 'f1-score': 0.40239522171505576, 'support': 191039}, 'accuracy': 0.3839449331537165, 'macro avg': {'precision': 0.3812739734996289, 'recall': 0.3817140576124682, 'f1-score': 0.3770249437149993, 'support': 568618}, 'weighted avg': {'precision': 0.3815564688072005, 'recall': 0.3839449331537165, 'f1-score': 0.3783488461898178, 'support': 568618}}
[[91640 40933 61797]
 [73441 47248 62520]
 [70103 41506 79430]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0898211
{'0': {'precision': 0.413149828157414, 'recall': 0.45499028199270297, 'f1-score': 0.43306179410619244, 'support': 58654}, '1': {'precision': 0.3384127690339803, 'recall': 0.2446575397543373, 'f1-score': 0.28399743305524766, 'support': 49743}, '2': {'precision': 0.38848159266866805, 'recall': 0.4434164727948205, 'f1-score': 0.41413520410311694, 'support': 55449}, 'accuracy': 0.38721726499273706, 'macro avg': {'precision': 0.3800147299533541, 'recall': 0.38102143151395357, 'f1-score': 0.377064810421519, 'support': 163846}, 'weighted avg': {'precision': 0.3821116916048437, 'recall': 0.38721726499273706, 'f1-score': 0.38140127751843517, 'support': 163846}}
[[26687 11986 19981]
 [18851 12170 18722]
 [19056 11806 24587]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 91s - 91s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0880837
{'0': {'precision': 0.34199885782824196, 'recall': 0.5101482445399743, 'f1-score': 0.4094835656211963, 'support': 936763}, '1': {'precision': 0.4056862946326368, 'recall': 0.25850455912781317, 'f1-score': 0.3157880182915901, 'support': 1192772}, '2': {'precision': 0.36700409356913494, 'recall': 0.35635284821672425, 'f1-score': 0.3616000524655919, 'support': 959302}, 'accuracy': 0.36521027169772957, 'macro avg': {'precision': 0.3715630820100046, 'recall': 0.3750018839615039, 'f1-score': 0.36229054545945943, 'support': 3088837}, 'weighted avg': {'precision': 0.37435801566944943, 'recall': 0.36521027169772957, 'f1-score': 0.3584312843526714, 'support': 3088837}}
[[477888 219114 239761]
 [534585 308337 349850]
 [384865 232587 341850]]
Evaluating performance on  train set...
2948/2948 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871615
{'0': {'precision': 0.3894100800519043, 'recall': 0.4680008978887799, 'f1-score': 0.42510364760886127, 'support': 253929}, '1': {'precision': 0.3629556065431549, 'recall': 0.25806451612903225, 'f1-score': 0.3016519418914912, 'support': 246419}, '2': {'precision': 0.394947773963232, 'recall': 0.4259754773110037, 'f1-score': 0.40987526243352784, 'support': 254132}, 'accuracy': 0.38527860248117907, 'macro avg': {'precision': 0.382437820186097, 'recall': 0.3840136304429387, 'f1-score': 0.3788769506446268, 'support': 754480}, 'weighted avg': {'precision': 0.38263510963720937, 'recall': 0.38527860248117907, 'f1-score': 0.37965397915834376, 'support': 754480}}
[[118839  54863  80227]
 [ 97211  63592  85616]
 [ 89127  56751 108254]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0849466
{'0': {'precision': 0.40133097345132746, 'recall': 0.4630313327016696, 'f1-score': 0.4299789895251026, 'support': 61214}, '1': {'precision': 0.36720026920488413, 'recall': 0.2627803770469245, 'f1-score': 0.3063364748345699, 'support': 58136}, '2': {'precision': 0.3955660334587659, 'recall': 0.443268416596105, 'f1-score': 0.41806086838469586, 'support': 59050}, 'accuracy': 0.39123318385650224, 'macro avg': {'precision': 0.38803242537165916, 'recall': 0.389693375448233, 'f1-score': 0.38479211091478943, 'support': 178400}, 'weighted avg': {'precision': 0.38830046712491495, 'recall': 0.39123318385650224, 'f1-score': 0.38574218298143764, 'support': 178400}}
[[28344 13322 19548]
 [22411 15277 20448]
 [19870 13005 26175]]
testing model on single stock: results/universal/W1/deepOF_L2/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 160s - 160s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971295
{'0': {'precision': 0.3749675242444791, 'recall': 0.4822161983262675, 'f1-score': 0.4218825189417007, 'support': 1903530}, '1': {'precision': 0.31453349451360746, 'recall': 0.2299265037915, 'f1-score': 0.26565619859665013, 'support': 1645391}, '2': {'precision': 0.38868140911449467, 'recall': 0.36803333453294257, 'f1-score': 0.3780756652840321, 'support': 1917291}, 'accuracy': 0.3662241786451019, 'macro avg': {'precision': 0.3593941426241938, 'recall': 0.36005867888357, 'f1-score': 0.35520479427412766, 'support': 5466212}, 'weighted avg': {'precision': 0.36158639292783945, 'recall': 0.3662241786451019, 'f1-score': 0.35949125645224217, 'support': 5466212}}
[[917913 411264 574353]
 [731614 378319 535458]
 [798453 413211 705627]]
Evaluating performance on  train set...
6073/6073 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965816
{'0': {'precision': 0.36754634455151775, 'recall': 0.44250012029062213, 'f1-score': 0.401555487827775, 'support': 519575}, '1': {'precision': 0.3374709643266234, 'recall': 0.28901964539409014, 'f1-score': 0.31137174900023895, 'support': 511723}, '2': {'precision': 0.37837711174549227, 'recall': 0.3548843298200686, 'f1-score': 0.36625438106865527, 'support': 523255}, 'accuracy': 0.3624868370521944, 'macro avg': {'precision': 0.36113147354121117, 'recall': 0.36213469850159363, 'f1-score': 0.35972720596555635, 'support': 1554553}, 'weighted avg': {'precision': 0.3612918066189156, 'recall': 0.3624868370521944, 'f1-score': 0.35998689930021344, 'support': 1554553}}
[[229912 144789 144874]
 [203627 147898 160198]
 [191993 145567 185695]]
Evaluating performance on  val set...
1786/1786 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978816
{'0': {'precision': 0.3467895432440845, 'recall': 0.4626118920390729, 'f1-score': 0.3964138429860532, 'support': 146905}, '1': {'precision': 0.34493453588760387, 'recall': 0.27932898066289713, 'f1-score': 0.30868442492784837, 'support': 160055}, '2': {'precision': 0.35966871818250895, 'recall': 0.31508600031950584, 'f1-score': 0.33590451387656917, 'support': 150232}, 'accuracy': 0.3499711281037288, 'macro avg': {'precision': 0.35046426577139905, 'recall': 0.3523422910071587, 'f1-score': 0.34700092726349024, 'support': 457192}, 'weighted avg': {'precision': 0.3503721978113295, 'recall': 0.3499711281037288, 'f1-score': 0.3458180986640135, 'support': 457192}}
[[67960 41976 36969]
 [68042 44708 47305]
 [59967 42929 47336]]
training model: results/universal/W1/deepOF_L2/h500
Epoch 1/50
10622/10622 - 231s - loss: 3.2550 - accuracy500: 0.3898 - val_loss: 3.3025 - val_accuracy500: 0.3707 - 231s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 228s - loss: 3.2423 - accuracy500: 0.3969 - val_loss: 3.3033 - val_accuracy500: 0.3715 - 228s/epoch - 21ms/step
Epoch 3/50
10622/10622 - 228s - loss: 3.2394 - accuracy500: 0.3986 - val_loss: 3.3046 - val_accuracy500: 0.3719 - 228s/epoch - 21ms/step
Epoch 4/50
10622/10622 - 229s - loss: 3.2381 - accuracy500: 0.3992 - val_loss: 3.3029 - val_accuracy500: 0.3741 - 229s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 226s - loss: 3.2368 - accuracy500: 0.4000 - val_loss: 3.3041 - val_accuracy500: 0.3739 - 226s/epoch - 21ms/step
Epoch 6/50
10622/10622 - 227s - loss: 3.2357 - accuracy500: 0.4008 - val_loss: 3.3021 - val_accuracy500: 0.3753 - 227s/epoch - 21ms/step
Epoch 7/50
10622/10622 - 227s - loss: 3.2343 - accuracy500: 0.4019 - val_loss: 3.2996 - val_accuracy500: 0.3760 - 227s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 228s - loss: 3.2329 - accuracy500: 0.4029 - val_loss: 3.2996 - val_accuracy500: 0.3765 - 228s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 228s - loss: 3.2317 - accuracy500: 0.4036 - val_loss: 3.2994 - val_accuracy500: 0.3770 - 228s/epoch - 21ms/step
Epoch 10/50
10622/10622 - 225s - loss: 3.2308 - accuracy500: 0.4043 - val_loss: 3.3014 - val_accuracy500: 0.3771 - 225s/epoch - 21ms/step
Epoch 11/50
10622/10622 - 226s - loss: 3.2296 - accuracy500: 0.4052 - val_loss: 3.3006 - val_accuracy500: 0.3767 - 226s/epoch - 21ms/step
Epoch 12/50
10622/10622 - 228s - loss: 3.2284 - accuracy500: 0.4059 - val_loss: 3.2998 - val_accuracy500: 0.3754 - 228s/epoch - 21ms/step
Epoch 13/50
10622/10622 - 226s - loss: 3.2274 - accuracy500: 0.4069 - val_loss: 3.3014 - val_accuracy500: 0.3751 - 226s/epoch - 21ms/step
Epoch 14/50
10622/10622 - 227s - loss: 3.2264 - accuracy500: 0.4072 - val_loss: 3.3031 - val_accuracy500: 0.3749 - 227s/epoch - 21ms/step
Epoch 15/50
10622/10622 - 226s - loss: 3.2254 - accuracy500: 0.4079 - val_loss: 3.3042 - val_accuracy500: 0.3747 - 226s/epoch - 21ms/step
Epoch 16/50
10622/10622 - 226s - loss: 3.2244 - accuracy500: 0.4084 - val_loss: 3.3055 - val_accuracy500: 0.3743 - 226s/epoch - 21ms/step
Epoch 17/50
10622/10622 - 226s - loss: 3.2231 - accuracy500: 0.4093 - val_loss: 3.3067 - val_accuracy500: 0.3737 - 226s/epoch - 21ms/step
Epoch 18/50
10622/10622 - 227s - loss: 3.2219 - accuracy500: 0.4098 - val_loss: 3.3073 - val_accuracy500: 0.3732 - 227s/epoch - 21ms/step
Epoch 19/50
10622/10622 - 228s - loss: 3.2207 - accuracy500: 0.4107 - val_loss: 3.3088 - val_accuracy500: 0.3721 - 228s/epoch - 21ms/step
testing model in sample: results/universal/W1/deepOF_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 264s - 264s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0821975
{'0': {'precision': 0.394919513912762, 'recall': 0.5297452259716692, 'f1-score': 0.45250287615484386, 'support': 3350420}, '1': {'precision': 0.3575382462970285, 'recall': 0.02027485007942298, 'f1-score': 0.03837365306209053, 'support': 2319228}, '2': {'precision': 0.3974066865189545, 'recall': 0.5202466133745205, 'f1-score': 0.45060478247694663, 'support': 3377108}, 'accuracy': 0.3955915247410232, 'macro avg': {'precision': 0.3832881489095817, 'recall': 0.3567555631418709, 'f1-score': 0.3138271038979603, 'support': 9046756}, 'weighted avg': {'precision': 0.38626489428732397, 'recall': 0.3955915247410232, 'f1-score': 0.34562808510716486, 'support': 9046756}}
[[1774869   42271 1533280]
 [1141430   47022 1130776]
 [1577956   42223 1756929]]
Evaluating performance on  train set...
10622/10622 - 83s - 83s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128744
{'0': {'precision': 0.35939922480620157, 'recall': 0.49927342981949946, 'f1-score': 0.41794386411822926, 'support': 906313}, '1': {'precision': 0.3827616325234239, 'recall': 0.032100820750162316, 'f1-score': 0.05923390973909678, 'support': 901005}, '2': {'precision': 0.3640938300044728, 'recall': 0.5529805430902125, 'f1-score': 0.4390850071892292, 'support': 911193}, 'accuracy': 0.3624384819483901, 'macro avg': {'precision': 0.3687515624446995, 'recall': 0.3614515978866248, 'f1-score': 0.30542092701551843, 'support': 2718511}, 'weighted avg': {'precision': 0.3687158461329809, 'recall': 0.3624384819483901, 'f1-score': 0.3061415573160583, 'support': 2718511}}
[[452498  23153 430662]
 [422709  28923 449373]
 [383833  23488 503872]]
Evaluating performance on  val set...
3064/3064 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993947
{'0': {'precision': 0.3776623575852708, 'recall': 0.4989197424752916, 'f1-score': 0.42990429801392654, 'support': 276323}, '1': {'precision': 0.3773764258555133, 'recall': 0.025428939884363445, 'f1-score': 0.047647242380841885, 'support': 234182}, '2': {'precision': 0.37730206748677886, 'recall': 0.5563524852618829, 'f1-score': 0.4496586929774749, 'support': 273271}, 'accuracy': 0.37747136937084064, 'macro avg': {'precision': 0.3774469503091877, 'recall': 0.3602337225405126, 'f1-score': 0.3090700777907478, 'support': 783776}, 'weighted avg': {'precision': 0.377451306341238, 'recall': 0.37747136937084064, 'f1-score': 0.3225784567835454, 'support': 783776}}
[[137863   5118 133342]
 [110651   5955 117576]
 [116529   4707 152035]]
testing model out of sample: results/universal/W1/deepOF_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 178s - 178s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1372918
{'0': {'precision': 0.32585617091944163, 'recall': 0.5604226079657351, 'f1-score': 0.4120986973378972, 'support': 1858460}, '1': {'precision': 0.4246949691764459, 'recall': 0.030586787759913418, 'f1-score': 0.05706380581692717, 'support': 2382957}, '2': {'precision': 0.3389352183570871, 'recall': 0.49830494241971757, 'f1-score': 0.4034519660660831, 'support': 1857754}, 'accuracy': 0.3344943107842033, 'macro avg': {'precision': 0.36316211948432486, 'recall': 0.3631047793817887, 'f1-score': 0.29087148974030247, 'support': 6099171}, 'weighted avg': {'precision': 0.3684564290318297, 'recall': 0.3344943107842033, 'f1-score': 0.2707522127744583, 'support': 6099171}}
[[1041523   49056  767881]
 [1272396   72887 1037674]
 [ 882347   49679  925728]]
Evaluating performance on  train set...
6711/6711 - 58s - 58s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089213
{'0': {'precision': 0.3690564509101529, 'recall': 0.5400884746820064, 'f1-score': 0.4384848444570986, 'support': 580279}, '1': {'precision': 0.40528035994736616, 'recall': 0.033909862556380295, 'f1-score': 0.06258336637946574, 'support': 563140}, '2': {'precision': 0.37157077463158894, 'recall': 0.5315698216448406, 'f1-score': 0.4373977013406098, 'support': 573855}, 'accuracy': 0.37125234528677425, 'macro avg': {'precision': 0.381969195163036, 'recall': 0.36852271962774247, 'f1-score': 0.3128219707257247, 'support': 1717274}, 'weighted avg': {'precision': 0.381775440060621, 'recall': 0.37125234528677425, 'f1-score': 0.314853425779735, 'support': 1717274}}
[[313402  13821 253056]
 [281186  19096 262858]
 [254610  14201 305044]]
Evaluating performance on  val set...
1720/1720 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043456
{'0': {'precision': 0.3823931904644607, 'recall': 0.5475083273463522, 'f1-score': 0.45029167517162094, 'support': 153110}, '1': {'precision': 0.3829537237888648, 'recall': 0.030106441940113974, 'f1-score': 0.05582418740694871, 'support': 140734}, '2': {'precision': 0.36903108820652303, 'recall': 0.5296732348449047, 'f1-score': 0.4349948814867312, 'support': 146007}, 'accuracy': 0.3760409775128396, 'macro avg': {'precision': 0.37812600081994946, 'recall': 0.3690960013771236, 'f1-score': 0.3137035813551003, 'support': 439851}, 'weighted avg': {'precision': 0.37813703470376436, 'recall': 0.3760409775128396, 'f1-score': 0.3190007917164894, 'support': 439851}}
[[83829  3559 65722]
 [69990  4237 66507]
 [65403  3268 77336]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1425979
{'0': {'precision': 0.33796563948731934, 'recall': 0.5532382193811046, 'f1-score': 0.4196021072874768, 'support': 56003}, '1': {'precision': 0.6747967479674797, 'recall': 0.0012927342107312515, 'f1-score': 0.0025805248103469717, 'support': 64205}, '2': {'precision': 0.294202991590165, 'recall': 0.46314300151591714, 'f1-score': 0.35983040201005023, 'support': 49475}, 'accuracy': 0.318122616879711, 'macro avg': {'precision': 0.4356551263483213, 'recall': 0.33922465170258437, 'f1-score': 0.26067101136929133, 'support': 169683}, 'weighted avg': {'precision': 0.4526564707152973, 'recall': 0.318122616879711, 'f1-score': 0.24438080744279703, 'support': 169683}}
[[30983    14 25006]
 [34157    83 29965]
 [26535    26 22914]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118296
{'0': {'precision': 0.3339343560907035, 'recall': 0.4985855083044351, 'f1-score': 0.399978037263443, 'support': 21916}, '1': {'precision': 0.3686868686868687, 'recall': 0.0033333333333333335, 'f1-score': 0.006606932754095393, 'support': 21900}, '2': {'precision': 0.346367883819897, 'recall': 0.5125732153080548, 'f1-score': 0.4133901616053987, 'support': 22707}, 'accuracy': 0.3403183861220931, 'macro avg': {'precision': 0.3496630361991564, 'recall': 0.3381640189819411, 'f1-score': 0.2733250438743124, 'support': 66523}, 'weighted avg': {'precision': 0.3496192792000463, 'recall': 0.3403183861220931, 'f1-score': 0.2750546561573305, 'support': 66523}}
[[10927    50 10939]
 [10802    73 11025]
 [10993    75 11639]]
Evaluating performance on  val set...
51/51 - 1s - 558ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1552792
{'0': {'precision': 0.3203375036368926, 'recall': 0.5459955368212249, 'f1-score': 0.4037773906665444, 'support': 4033}, '1': {'precision': 0.5935483870967742, 'recall': 0.016699945543655836, 'f1-score': 0.03248587570621469, 'support': 5509}, '2': {'precision': 0.2586799587487109, 'recall': 0.45537065052950076, 'f1-score': 0.32993532829113226, 'support': 3305}, 'accuracy': 0.29571106094808125, 'macro avg': {'precision': 0.39085528316079254, 'recall': 0.33935537763146045, 'f1-score': 0.25539953155463047, 'support': 12847}, 'weighted avg': {'precision': 0.42163279211864296, 'recall': 0.29571106094808125, 'f1-score': 0.2255651253853742, 'support': 12847}}
[[2202   40 1791]
 [2895   92 2522]
 [1777   23 1505]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923578
{'0': {'precision': 0.4245323280460915, 'recall': 0.5374294920857479, 'f1-score': 0.47435602673819555, 'support': 155479}, '1': {'precision': 0.455317024463305, 'recall': 0.035750405720064916, 'f1-score': 0.06629545091083552, 'support': 127551}, '2': {'precision': 0.3770381576735586, 'recall': 0.5852364558796883, 'f1-score': 0.4586143539908956, 'support': 137975}, 'accuracy': 0.40110449994655645, 'macro avg': {'precision': 0.41896250339431834, 'recall': 0.38613878456183376, 'f1-score': 0.33308861054664224, 'support': 421005}, 'weighted avg': {'precision': 0.4182939476362668, 'recall': 0.40110449994655645, 'f1-score': 0.345567789532784, 'support': 421005}}
[[83559  2670 69250]
 [58825  4560 64166]
 [54442  2785 80748]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1128005
{'0': {'precision': 0.3880567651225014, 'recall': 0.5096900894072249, 'f1-score': 0.44063354009516503, 'support': 58049}, '1': {'precision': 0.379635079458505, 'recall': 0.03452397944618898, 'f1-score': 0.06329217433968436, 'support': 56048}, '2': {'precision': 0.35878799210068124, 'recall': 0.5812839590314458, 'f1-score': 0.44370583389933377, 'support': 52821}, 'accuracy': 0.3727938269090212, 'macro avg': {'precision': 0.3754932788938959, 'recall': 0.3751660092949532, 'f1-score': 0.31587718277806104, 'support': 166918}, 'weighted avg': {'precision': 0.3759668497276295, 'recall': 0.3727938269090212, 'f1-score': 0.31490146064996927, 'support': 166918}}
[[29587  1621 26841]
 [26081  1935 28032]
 [20576  1541 30704]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0780027
{'0': {'precision': 0.43812407053324837, 'recall': 0.4579724628025761, 'f1-score': 0.44782844733984806, 'support': 18012}, '1': {'precision': 0.35428122545168894, 'recall': 0.03757393984837124, 'f1-score': 0.06794215125037661, 'support': 12003}, '2': {'precision': 0.3908511206995303, 'recall': 0.6289400921658986, 'f1-score': 0.4821024868123587, 'support': 16275}, 'accuracy': 0.40907323395981854, 'macro avg': {'precision': 0.39441880556148917, 'recall': 0.37482883160561536, 'f1-score': 0.33262436180086113, 'support': 46290}, 'weighted avg': {'precision': 0.39976302218462617, 'recall': 0.40907323395981854, 'f1-score': 0.3613742408255509, 'support': 46290}}
[[ 8249   410  9353]
 [ 4952   451  6600]
 [ 5627   412 10236]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0842447
{'0': {'precision': 0.39314744801512286, 'recall': 0.45721711001538895, 'f1-score': 0.4227686544409113, 'support': 127364}, '1': {'precision': 0.22131529850746268, 'recall': 0.011449322571693994, 'f1-score': 0.021772297103527388, 'support': 82887}, '2': {'precision': 0.38655549028566455, 'recall': 0.5639993968684777, 'f1-score': 0.4587153594676322, 'support': 126009}, 'accuracy': 0.3873520490096949, 'macro avg': {'precision': 0.33367274560275, 'recall': 0.34422194315185356, 'f1-score': 0.3010854370040236, 'support': 336260}, 'weighted avg': {'precision': 0.3483211309456744, 'recall': 0.3873520490096949, 'f1-score': 0.3373949058032153, 'support': 336260}}
[[58233  1732 67399]
 [36554   949 45384]
 [53333  1607 71069]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167411
{'0': {'precision': 0.3603028979175768, 'recall': 0.5385837741352664, 'f1-score': 0.4317636485790819, 'support': 45939}, '1': {'precision': 0.3686200378071834, 'recall': 0.017665443674412286, 'f1-score': 0.03371515020531662, 'support': 44154}, '2': {'precision': 0.3551524544534413, 'recall': 0.5112578258394992, 'f1-score': 0.4191420065884636, 'support': 43925}, 'accuracy': 0.35800414869644376, 'macro avg': {'precision': 0.3613584633927338, 'recall': 0.3558356812163926, 'f1-score': 0.29487360179095407, 'support': 134018}, 'weighted avg': {'precision': 0.36135500857079905, 'recall': 0.35800414869644376, 'f1-score': 0.29648451427150274, 'support': 134018}}
[[24742   703 20494]
 [23093   780 20281]
 [20835   633 22457]]
Evaluating performance on  val set...
107/107 - 1s - 978ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0907786
{'0': {'precision': 0.3937086602061221, 'recall': 0.48567362428842503, 'f1-score': 0.4348823379491971, 'support': 10540}, '1': {'precision': 0.28, 'recall': 0.010610445087501722, 'f1-score': 0.020446096654275093, 'support': 7257}, '2': {'precision': 0.36262866191607285, 'recall': 0.5375013336178385, 'f1-score': 0.43307831169947564, 'support': 9373}, 'accuracy': 0.37666543982333456, 'macro avg': {'precision': 0.3454457740407317, 'recall': 0.34459513433125505, 'f1-score': 0.2961355821009826, 'support': 27170}, 'weighted avg': {'precision': 0.352615668999333, 'recall': 0.37666543982333456, 'f1-score': 0.3235657041208611, 'support': 27170}}
[[5119   99 5322]
 [3647   77 3533]
 [4236   99 5038]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1112082
{'0': {'precision': 0.35045919126648456, 'recall': 0.6358473638826224, 'f1-score': 0.45186469004363833, 'support': 114809}, '1': {'precision': 0.22625, 'recall': 0.0017514660060769097, 'f1-score': 0.003476023122275355, 'support': 103342}, '2': {'precision': 0.3358847835680186, 'recall': 0.36218367435220833, 'f1-score': 0.3485388393972192, 'support': 115585}, 'accuracy': 0.3447185799554139, 'macro avg': {'precision': 0.304197991611501, 'recall': 0.3332608347469692, 'f1-score': 0.2679598508543776, 'support': 333736}, 'weighted avg': {'precision': 0.30694992298949847, 'recall': 0.3447185799554139, 'f1-score': 0.27723474282801325, 'support': 333736}}
[[73001   291 41517]
 [61906   181 41255]
 [73394   328 41863]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173812
{'0': {'precision': 0.3282734868295172, 'recall': 0.6410511894382862, 'f1-score': 0.43419942635397335, 'support': 32116}, '1': {'precision': 0.3924050632911392, 'recall': 0.0019102196752626551, 'f1-score': 0.0038019316265521996, 'support': 32457}, '2': {'precision': 0.347148794209946, 'recall': 0.3646650035637919, 'f1-score': 0.3556913807337456, 'support': 33672}, 'accuracy': 0.3351722733981373, 'macro avg': {'precision': 0.35594244811020076, 'recall': 0.3358754708924469, 'f1-score': 0.2645642462380904, 'support': 98245}, 'weighted avg': {'precision': 0.3559297332270811, 'recall': 0.3351722733981373, 'f1-score': 0.26510243008452233, 'support': 98245}}
[[20588    46 11482]
 [20785    62 11610]
 [21343    50 12279]]
Evaluating performance on  val set...
93/93 - 1s - 872ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1306909
{'0': {'precision': 0.29660792367828276, 'recall': 0.6376584532117932, 'f1-score': 0.4048835631924034, 'support': 7021}, '1': {'precision': 0.22916666666666666, 'recall': 0.0013048635824436537, 'f1-score': 0.0025949516395376267, 'support': 8430}, '2': {'precision': 0.3554715197352872, 'recall': 0.3689439470133693, 'f1-score': 0.36208245561239844, 'support': 8153}, 'accuracy': 0.31757329266226064, 'macro avg': {'precision': 0.2937487033600789, 'recall': 0.3359690879358687, 'f1-score': 0.25652032348144643, 'support': 23604}, 'weighted avg': {'precision': 0.29285369143141077, 'recall': 0.31757329266226064, 'f1-score': 0.24642523301571984, 'support': 23604}}
[[4477   16 2528]
 [5493   11 2926]
 [5124   21 3008]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1090277
{'0': {'precision': 0.35454446641187065, 'recall': 0.5260455486542444, 'f1-score': 0.42359448816134, 'support': 229425}, '1': {'precision': 0.34176966843241124, 'recall': 0.008321192290238602, 'f1-score': 0.016246817321233713, 'support': 209345}, '2': {'precision': 0.3548773022339477, 'recall': 0.4997090186709373, 'f1-score': 0.41502042358960944, 'support': 228537}, 'accuracy': 0.3546073995926912, 'macro avg': {'precision': 0.3503971456927432, 'recall': 0.3446919198718068, 'f1-score': 0.2849539096907277, 'support': 667307}, 'weighted avg': {'precision': 0.35065079411000677, 'recall': 0.3546073995926912, 'f1-score': 0.292866518655473, 'support': 667307}}
[[120688   1628 107109]
 [107107   1742 100496]
 [112608   1727 114202]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153687
{'0': {'precision': 0.3508511635171014, 'recall': 0.5038125140165957, 'f1-score': 0.4136438961517216, 'support': 62426}, '1': {'precision': 0.3672119735468152, 'recall': 0.01744176434605783, 'f1-score': 0.03330176767676767, 'support': 60487}, '2': {'precision': 0.35482400937459313, 'recall': 0.5294498591458083, 'f1-score': 0.42489443253426884, 'support': 61766}, 'accuracy': 0.3530883316457204, 'macro avg': {'precision': 0.3576290488128366, 'recall': 0.3502347125028206, 'f1-score': 0.2906133654542527, 'support': 184679}, 'weighted avg': {'precision': 0.35753845938453155, 'recall': 0.3530883316457204, 'f1-score': 0.2928350673468216, 'support': 184679}}
[[31451   869 30106]
 [30076  1055 29356]
 [28115   949 32702]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1099919
{'0': {'precision': 0.35197709787081766, 'recall': 0.4984291071247593, 'f1-score': 0.4125925459846054, 'support': 19734}, '1': {'precision': 0.3071625344352617, 'recall': 0.012217839140916065, 'f1-score': 0.02350089577405417, 'support': 18252}, '2': {'precision': 0.35908411468949586, 'recall': 0.5253218030912976, 'f1-score': 0.42657949431967224, 'support': 20121}, 'accuracy': 0.35501746777496684, 'macro avg': {'precision': 0.33940791566519174, 'recall': 0.3453229164523243, 'f1-score': 0.28755764535944395, 'support': 58107}, 'weighted avg': {'precision': 0.340361369534866, 'recall': 0.35501746777496684, 'f1-score': 0.29521822942733866, 'support': 58107}}
[[ 9836   255  9643]
 [ 8806   223  9223]
 [ 9303   248 10570]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/EXC
Evaluating performance on  test set...
5343/5343 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018442
{'0': {'precision': 0.3734769105894274, 'recall': 0.6008570236373346, 'f1-score': 0.46063514163061675, 'support': 462531}, '1': {'precision': 0.44187384898710863, 'recall': 0.04378062020454525, 'f1-score': 0.07966779835476345, 'support': 438436}, '2': {'precision': 0.3825961066156511, 'recall': 0.47553538110223065, 'f1-score': 0.42403288533683786, 'support': 466817}, 'accuracy': 0.37951752615910117, 'macro avg': {'precision': 0.39931562206406235, 'recall': 0.37339100831470345, 'f1-score': 0.321445275107406, 'support': 1367784}, 'weighted avg': {'precision': 0.39851352149780145, 'recall': 0.37951752615910117, 'f1-score': 0.3260259097688718, 'support': 1367784}}
[[277915  12935 171681]
 [232695  19195 186546]
 [233519  11310 221988]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998918
{'0': {'precision': 0.37651632690959846, 'recall': 0.578416034749319, 'f1-score': 0.45612252673287446, 'support': 108664}, '1': {'precision': 0.4692902638762511, 'recall': 0.05741027615186962, 'f1-score': 0.10230513013364631, 'support': 107803}, '2': {'precision': 0.3973383270245775, 'recall': 0.524342625978366, 'f1-score': 0.4520901101734113, 'support': 113710}, 'accuracy': 0.3896849265696884, 'macro avg': {'precision': 0.41438163927014243, 'recall': 0.3867229789598516, 'f1-score': 0.33683925567997736, 'support': 330177}, 'weighted avg': {'precision': 0.41397798644339495, 'recall': 0.3896849265696884, 'f1-score': 0.3392121941156323, 'support': 330177}}
[[62853  3422 42389]
 [53570  6189 48044]
 [50510  3577 59623]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1074084
{'0': {'precision': 0.37430610626486915, 'recall': 0.5548045841904202, 'f1-score': 0.4470226115780751, 'support': 30627}, '1': {'precision': 0.4947033898305085, 'recall': 0.05881056575260523, 'f1-score': 0.1051239483384451, 'support': 31763}, '2': {'precision': 0.3756869389998168, 'recall': 0.5387469626321666, 'f1-score': 0.4426786822437472, 'support': 30454}, 'accuracy': 0.3798522252380337, 'macro avg': {'precision': 0.4148988116983981, 'recall': 0.38412070419173067, 'f1-score': 0.33160841405342245, 'support': 92844}, 'weighted avg': {'precision': 0.4159483319122507, 'recall': 0.3798522252380337, 'f1-score': 0.32863028397017374, 'support': 92844}}
[[16992   981 12654]
 [15284  1868 14611]
 [13120   927 16407]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/AAL
Evaluating performance on  test set...
7177/7177 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.088057
{'0': {'precision': 0.40599948715146267, 'recall': 0.576180689577001, 'f1-score': 0.476346540110453, 'support': 670498}, '1': {'precision': 0.41352546090055514, 'recall': 0.04554993979519041, 'f1-score': 0.08206085457531341, 'support': 529858}, '2': {'precision': 0.39092353222788007, 'recall': 0.5078479350680354, 'f1-score': 0.44178017624154653, 'support': 636728}, 'accuracy': 0.3994504334042428, 'macro avg': {'precision': 0.40348282675996594, 'recall': 0.37652618814674227, 'f1-score': 0.33339585697577095, 'support': 1837084}, 'weighted avg': {'precision': 0.402944871669625, 'recall': 0.3994504334042428, 'f1-score': 0.350644723263864, 'support': 1837084}}
[[386328  17013 267157]
 [269069  24135 236654]
 [296151  17216 323361]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021186
{'0': {'precision': 0.3848418525125874, 'recall': 0.5756021285717888, 'f1-score': 0.46127789612394954, 'support': 198255}, '1': {'precision': 0.44079812474987135, 'recall': 0.04129818791478968, 'f1-score': 0.0755208588416217, 'support': 186691}, '2': {'precision': 0.38521225090682815, 'recall': 0.5270521419523642, 'f1-score': 0.44510548375217024, 'support': 192628}, 'accuracy': 0.38670542649080464, 'macro avg': {'precision': 0.40361740938976226, 'recall': 0.3813174861463142, 'f1-score': 0.3273014129059138, 'support': 577574}, 'weighted avg': {'precision': 0.4030523009090467, 'recall': 0.38670542649080464, 'f1-score': 0.33119477864008395, 'support': 577574}}
[[114116   4809  79330]
 [ 96280   7710  82701]
 [ 86131   4972 101525]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.08625
{'0': {'precision': 0.4139078794554663, 'recall': 0.5793725279882014, 'f1-score': 0.4828583201223558, 'support': 59668}, '1': {'precision': 0.4035517452541335, 'recall': 0.02817925254425725, 'f1-score': 0.05267996322794677, 'support': 46772}, '2': {'precision': 0.4003919519205644, 'recall': 0.5387171058414049, 'f1-score': 0.4593672944756309, 'support': 56887}, 'accuracy': 0.4073668162643041, 'macro avg': {'precision': 0.405950525543388, 'recall': 0.3820896287912878, 'f1-score': 0.3316351926086445, 'support': 163327}, 'weighted avg': {'precision': 0.4062345757240398, 'recall': 0.4073668162643041, 'f1-score': 0.35148606639437124, 'support': 163327}}
[[34570   945 24153]
 [23713  1318 21741]
 [25238  1003 30646]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/WBA
Evaluating performance on  test set...
5696/5696 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0737579
{'0': {'precision': 0.4115598328728517, 'recall': 0.4788087589150686, 'f1-score': 0.4426446633779758, 'support': 558745}, '1': {'precision': 0.32437027707808563, 'recall': 0.03020494326677808, 'f1-score': 0.05526379314969289, 'support': 341070}, '2': {'precision': 0.4049354882345742, 'recall': 0.5630862552041905, 'f1-score': 0.4710919134095063, 'support': 558204}, 'accuracy': 0.40613393926965285, 'macro avg': {'precision': 0.3802885327285039, 'recall': 0.35736665246201244, 'f1-score': 0.32300012331239164, 'support': 1458019}, 'weighted avg': {'precision': 0.388627705466154, 'recall': 0.40613393926965285, 'f1-score': 0.36291687886202645, 'support': 1458019}}
[[267532  10770 280443]
 [149313  10302 181455]
 [233199  10688 314317]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1161994
{'0': {'precision': 0.3649309540129851, 'recall': 0.49412623510702086, 'f1-score': 0.4198136297891097, 'support': 191785}, '1': {'precision': 0.38567572224455804, 'recall': 0.035149338888830726, 'f1-score': 0.06442699313514318, 'support': 191042}, '2': {'precision': 0.36015436068947776, 'recall': 0.5651188701282625, 'f1-score': 0.43993496970560386, 'support': 185791}, 'accuracy': 0.36311724215554203, 'macro avg': {'precision': 0.3702536789823403, 'recall': 0.36479814804137134, 'f1-score': 0.3080585308766189, 'support': 568618}, 'weighted avg': {'precision': 0.3703399877796411, 'recall': 0.36311724215554203, 'f1-score': 0.3069867231923757, 'support': 568618}}
[[ 94766   5373  91646]
 [ 89442   6715  94885]
 [ 75474   5323 104994]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0751499
{'0': {'precision': 0.42671109685874825, 'recall': 0.47657235397623754, 'f1-score': 0.4502655544276235, 'support': 64219}, '1': {'precision': 0.34766192274179497, 'recall': 0.03010109138459991, 'f1-score': 0.05540512393251405, 'support': 39766}, '2': {'precision': 0.39612088407758234, 'recall': 0.5868261472411086, 'f1-score': 0.47297379174773296, 'support': 59861}, 'accuracy': 0.40849334130830167, 'macro avg': {'precision': 0.39016463455937517, 'recall': 0.3644998642006487, 'f1-score': 0.32621482336929014, 'support': 163846}, 'weighted avg': {'precision': 0.3963494756703876, 'recall': 0.40849334130830167, 'f1-score': 0.3627279759402058, 'support': 163846}}
[[30605  1148 32466]
 [17483  1197 21086]
 [23635  1098 35128]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 90s - 90s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.178177
{'0': {'precision': 0.26729866707699407, 'recall': 0.5736909323116219, 'f1-score': 0.36468185012641036, 'support': 775170}, '1': {'precision': 0.44227818481721587, 'recall': 0.030814572695772327, 'f1-score': 0.05761497322194864, 'support': 1496662}, '2': {'precision': 0.2981938132216476, 'recall': 0.48208884890545345, 'f1-score': 0.3684713736298176, 'support': 817005}, 'accuracy': 0.2864171854973247, 'macro avg': {'precision': 0.3359235550386192, 'recall': 0.36219811797094925, 'f1-score': 0.26358939899272554, 'support': 3088837}, 'weighted avg': {'precision': 0.3602549104320266, 'recall': 0.2864171854973247, 'f1-score': 0.2168983100847428, 'support': 3088837}}
[[444708  29020 301442]
 [825005  46119 625538]
 [393999  29137 393869]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1104653
{'0': {'precision': 0.3652221773546706, 'recall': 0.5245389146868036, 'f1-score': 0.43061726623631785, 'support': 251743}, '1': {'precision': 0.38528280265204223, 'recall': 0.03766986250940346, 'f1-score': 0.06862966662049559, 'support': 249908}, '2': {'precision': 0.37047882156271034, 'recall': 0.5399578371152044, 'f1-score': 0.4394439553400278, 'support': 252829}, 'accuracy': 0.36843918990563035, 'macro avg': {'precision': 0.3736612671898077, 'recall': 0.36738887143713717, 'f1-score': 0.3128969627322804, 'support': 754480}, 'weighted avg': {'precision': 0.3736284211852427, 'recall': 0.36843918990563035, 'f1-score': 0.31367320666497195, 'support': 754480}}
[[132049   7367 112327]
 [120850   9414 119644]
 [108659   7653 136517]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176587
{'0': {'precision': 0.3643383603583173, 'recall': 0.543349961951467, 'f1-score': 0.43619209231291367, 'support': 59135}, '1': {'precision': 0.38052179069077974, 'recall': 0.04078228266395526, 'f1-score': 0.07366910604103888, 'support': 62944}, '2': {'precision': 0.35509920444742643, 'recall': 0.5262335540917242, 'f1-score': 0.42405122151876096, 'support': 56321}, 'accuracy': 0.360627802690583, 'macro avg': {'precision': 0.36665311849884114, 'recall': 0.37012193290238216, 'f1-score': 0.31130413995757117, 'support': 178400}, 'weighted avg': {'precision': 0.3671314732439072, 'recall': 0.360627802690583, 'f1-score': 0.30445199796373, 'support': 178400}}
[[32131  2296 24708]
 [31259  2567 29118]
 [24800  1883 29638]]
testing model on single stock: results/universal/W1/deepOF_L2/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 161s - 161s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0769844
{'0': {'precision': 0.39816780588036177, 'recall': 0.5210495537327525, 'f1-score': 0.45139521223148116, 'support': 2058856}, '1': {'precision': 0.2800185647667249, 'recall': 0.009680408976268099, 'f1-score': 0.01871386835007784, 'support': 1308829}, '2': {'precision': 0.40273164463094524, 'recall': 0.5232870484868672, 'f1-score': 0.45516198585934453, 'support': 2098527}, 'accuracy': 0.3994663946440423, 'macro avg': {'precision': 0.36030600509267724, 'recall': 0.3513390037319626, 'f1-score': 0.3084236888136345, 'support': 5466212}, 'weighted avg': {'precision': 0.3716302668577672, 'recall': 0.3994663946440423, 'f1-score': 0.349240152297839, 'support': 5466212}}
[[1072766   15530  970560]
 [ 638142   12670  658017]
 [ 983348   17047 1098132]]
Evaluating performance on  train set...
6073/6073 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1140903
{'0': {'precision': 0.3523716797565215, 'recall': 0.47371431784820217, 'f1-score': 0.4041310720406557, 'support': 515699}, '1': {'precision': 0.35349919903884663, 'recall': 0.027495108584555783, 'f1-score': 0.05102175369892361, 'support': 513655}, '2': {'precision': 0.36049462082803696, 'recall': 0.5637482173423788, 'f1-score': 0.4397723010883651, 'support': 525199}, 'accuracy': 0.35669224529494975, 'macro avg': {'precision': 0.355455166541135, 'recall': 0.354985881258379, 'f1-score': 0.2983083756093148, 'support': 1554553}, 'weighted avg': {'precision': 0.35548853485556386, 'recall': 0.35669224529494975, 'f1-score': 0.299498017356644, 'support': 1554553}}
[[244294  12845 258560]
 [232856  14123 266676]
 [216135  12984 296080]]
Evaluating performance on  val set...
1786/1786 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1066844
{'0': {'precision': 0.3623539423297221, 'recall': 0.4953657538799826, 'f1-score': 0.41854637268271605, 'support': 156444}, '1': {'precision': 0.34539382131923185, 'recall': 0.017451835184924765, 'f1-score': 0.03322490395298717, 'support': 142220}, '2': {'precision': 0.36860270607914963, 'recall': 0.5490512716996366, 'f1-score': 0.44108517900081845, 'support': 158528}, 'accuracy': 0.3653147911599503, 'macro avg': {'precision': 0.35878348990936787, 'recall': 0.3539562869215147, 'f1-score': 0.29761881854550726, 'support': 457192}, 'weighted avg': {'precision': 0.3592448232059346, 'recall': 0.3653147911599503, 'f1-score': 0.30649850790217326, 'support': 457192}}
[[77497  2357 76590]
 [67233  2482 72505]
 [69141  2347 87040]]
training model: results/universal/W1/deepOF_L2/h1000
Epoch 1/50
10622/10622 - 227s - loss: 3.2675 - accuracy1000: 0.3828 - val_loss: 3.2987 - val_accuracy1000: 0.3366 - 227s/epoch - 21ms/step
Epoch 2/50
10622/10622 - 226s - loss: 3.2562 - accuracy1000: 0.3886 - val_loss: 3.2979 - val_accuracy1000: 0.3397 - 226s/epoch - 21ms/step
Epoch 3/50
10622/10622 - 226s - loss: 3.2537 - accuracy1000: 0.3899 - val_loss: 3.2999 - val_accuracy1000: 0.3391 - 226s/epoch - 21ms/step
Epoch 4/50
10622/10622 - 226s - loss: 3.2524 - accuracy1000: 0.3906 - val_loss: 3.2995 - val_accuracy1000: 0.3390 - 226s/epoch - 21ms/step
Epoch 5/50
10622/10622 - 227s - loss: 3.2510 - accuracy1000: 0.3917 - val_loss: 3.2997 - val_accuracy1000: 0.3403 - 227s/epoch - 21ms/step
Epoch 6/50
10622/10622 - 227s - loss: 3.2503 - accuracy1000: 0.3923 - val_loss: 3.2983 - val_accuracy1000: 0.3420 - 227s/epoch - 21ms/step
Epoch 7/50
10622/10622 - 227s - loss: 3.2497 - accuracy1000: 0.3924 - val_loss: 3.2985 - val_accuracy1000: 0.3427 - 227s/epoch - 21ms/step
Epoch 8/50
10622/10622 - 228s - loss: 3.2488 - accuracy1000: 0.3930 - val_loss: 3.2972 - val_accuracy1000: 0.3426 - 228s/epoch - 21ms/step
Epoch 9/50
10622/10622 - 229s - loss: 3.2478 - accuracy1000: 0.3937 - val_loss: 3.2967 - val_accuracy1000: 0.3414 - 229s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 228s - loss: 3.2467 - accuracy1000: 0.3947 - val_loss: 3.2962 - val_accuracy1000: 0.3426 - 228s/epoch - 21ms/step
Epoch 11/50
10622/10622 - 230s - loss: 3.2458 - accuracy1000: 0.3955 - val_loss: 3.2954 - val_accuracy1000: 0.3418 - 230s/epoch - 22ms/step
Epoch 12/50
10622/10622 - 227s - loss: 3.2448 - accuracy1000: 0.3965 - val_loss: 3.2961 - val_accuracy1000: 0.3418 - 227s/epoch - 21ms/step
Epoch 13/50
10622/10622 - 229s - loss: 3.2438 - accuracy1000: 0.3972 - val_loss: 3.2955 - val_accuracy1000: 0.3421 - 229s/epoch - 22ms/step
Epoch 14/50
10622/10622 - 229s - loss: 3.2427 - accuracy1000: 0.3980 - val_loss: 3.2931 - val_accuracy1000: 0.3435 - 229s/epoch - 22ms/step
Epoch 15/50
10622/10622 - 229s - loss: 3.2417 - accuracy1000: 0.3986 - val_loss: 3.2942 - val_accuracy1000: 0.3416 - 229s/epoch - 22ms/step
Epoch 16/50
10622/10622 - 227s - loss: 3.2412 - accuracy1000: 0.3989 - val_loss: 3.2932 - val_accuracy1000: 0.3432 - 227s/epoch - 21ms/step
Epoch 17/50
10622/10622 - 230s - loss: 3.2401 - accuracy1000: 0.3997 - val_loss: 3.2935 - val_accuracy1000: 0.3438 - 230s/epoch - 22ms/step
Epoch 18/50
10622/10622 - 227s - loss: 3.2390 - accuracy1000: 0.4005 - val_loss: 3.2928 - val_accuracy1000: 0.3441 - 227s/epoch - 21ms/step
Epoch 19/50
10622/10622 - 229s - loss: 3.2374 - accuracy1000: 0.4020 - val_loss: 3.2934 - val_accuracy1000: 0.3441 - 229s/epoch - 22ms/step
Epoch 20/50
10622/10622 - 226s - loss: 3.2362 - accuracy1000: 0.4024 - val_loss: 3.2945 - val_accuracy1000: 0.3447 - 226s/epoch - 21ms/step
Epoch 21/50
10622/10622 - 227s - loss: 3.2348 - accuracy1000: 0.4036 - val_loss: 3.2963 - val_accuracy1000: 0.3422 - 227s/epoch - 21ms/step
Epoch 22/50
10622/10622 - 227s - loss: 3.2333 - accuracy1000: 0.4045 - val_loss: 3.2973 - val_accuracy1000: 0.3448 - 227s/epoch - 21ms/step
Epoch 23/50
10622/10622 - 227s - loss: 3.2322 - accuracy1000: 0.4054 - val_loss: 3.2950 - val_accuracy1000: 0.3475 - 227s/epoch - 21ms/step
Epoch 24/50
10622/10622 - 227s - loss: 3.2309 - accuracy1000: 0.4062 - val_loss: 3.2958 - val_accuracy1000: 0.3475 - 227s/epoch - 21ms/step
Epoch 25/50
10622/10622 - 227s - loss: 3.2293 - accuracy1000: 0.4072 - val_loss: 3.2965 - val_accuracy1000: 0.3470 - 227s/epoch - 21ms/step
Epoch 26/50
10622/10622 - 227s - loss: 3.2282 - accuracy1000: 0.4079 - val_loss: 3.2971 - val_accuracy1000: 0.3482 - 227s/epoch - 21ms/step
Epoch 27/50
10622/10622 - 226s - loss: 3.2268 - accuracy1000: 0.4087 - val_loss: 3.2995 - val_accuracy1000: 0.3494 - 226s/epoch - 21ms/step
Epoch 28/50
10622/10622 - 227s - loss: 3.2257 - accuracy1000: 0.4096 - val_loss: 3.2971 - val_accuracy1000: 0.3493 - 227s/epoch - 21ms/step
testing model in sample: results/universal/W1/deepOF_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 267s - 267s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0956126
{'0': {'precision': 0.3772868390624589, 'recall': 0.37344837076971593, 'f1-score': 0.3753577919762909, 'support': 3190034}, '1': {'precision': 0.3199287740087705, 'recall': 0.543672625537508, 'f1-score': 0.4028166620427609, 'support': 2633217}, '2': {'precision': 0.3941308224088416, 'recall': 0.17293629139709726, 'f1-score': 0.2403931425161026, 'support': 3223505}, 'accuracy': 0.3515494393791542, 'macro avg': {'precision': 0.36378214516002366, 'recall': 0.3633524292347737, 'f1-score': 0.3395225321783848, 'support': 9046756}, 'weighted avg': {'precision': 0.36659355105408364, 'recall': 0.3515494393791542, 'f1-score': 0.3352600974105986, 'support': 9046756}}
[[1191313 1488766  509955]
 [ 854619 1431608  346990]
 [1111647 1554397  557461]]
Evaluating performance on  train set...
10622/10622 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096502
{'0': {'precision': 0.36090213548504474, 'recall': 0.3263881091477074, 'f1-score': 0.3427785175425436, 'support': 899515}, '1': {'precision': 0.3466912106181473, 'recall': 0.6139923229017974, 'f1-score': 0.44315476285334554, 'support': 905811}, '2': {'precision': 0.3735099161630466, 'recall': 0.12304188088941452, 'f1-score': 0.18510601668688895, 'support': 913185}, 'accuracy': 0.3539113875205949, 'macro avg': {'precision': 0.3603677540887462, 'recall': 0.3544741043129731, 'f1-score': 0.3236797656942594, 'support': 2718511}, 'weighted avg': {'precision': 0.3604021647782247, 'recall': 0.3539113875205949, 'f1-score': 0.323259650209416, 'support': 2718511}}
[[293591 506853  99071]
 [260259 556161  89391]
 [259642 541183 112360]]
Evaluating performance on  val set...
3064/3064 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.097795
{'0': {'precision': 0.36266064341467125, 'recall': 0.33343152127487224, 'f1-score': 0.3474324124714409, 'support': 271588}, '1': {'precision': 0.3253167956072244, 'recall': 0.5724440208071105, 'f1-score': 0.4148669692608583, 'support': 245493}, '2': {'precision': 0.3737891179783535, 'recall': 0.14309229644350288, 'f1-score': 0.20695788931370154, 'support': 266695}, 'accuracy': 0.3435279977952885, 'macro avg': {'precision': 0.35392218566674966, 'recall': 0.3496559461751619, 'f1-score': 0.32308575701533354, 'support': 783776}, 'weighted avg': {'precision': 0.35475054575152215, 'recall': 0.3435279977952885, 'f1-score': 0.32075496725284675, 'support': 783776}}
[[ 90556 146080  34952]
 [ 75981 140531  28981]
 [ 83162 145371  38162]]
testing model out of sample: results/universal/W1/deepOF_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 181s - 181s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028817
{'0': {'precision': 0.3692867131643295, 'recall': 0.3191800234835436, 'f1-score': 0.34240998295386693, 'support': 2115524}, '1': {'precision': 0.3070480897167839, 'recall': 0.6119366960918864, 'f1-score': 0.40891644010683936, 'support': 1847848}, '2': {'precision': 0.3787602552415679, 'recall': 0.1042738572309473, 'f1-score': 0.1635279652513721, 'support': 2135799}, 'accuracy': 0.33262012165259836, 'macro avg': {'precision': 0.3516983527075604, 'recall': 0.34513019226879244, 'f1-score': 0.3049514627706928, 'support': 6099171}, 'weighted avg': {'precision': 0.35374789089401165, 'recall': 0.33262012165259836, 'f1-score': 0.2999185999954673, 'support': 6099171}}
[[ 675233 1239250  201041]
 [ 552839 1130766  164243]
 [ 600407 1312684  222708]]
Evaluating performance on  train set...
6711/6711 - 53s - 53s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963502
{'0': {'precision': 0.37057688604918915, 'recall': 0.32440734695421997, 'f1-score': 0.3459585375807628, 'support': 581411}, '1': {'precision': 0.34293856479484625, 'recall': 0.6400050464755521, 'f1-score': 0.4465818986627651, 'support': 562769}, '2': {'precision': 0.3814881136934554, 'recall': 0.10520089200026522, 'f1-score': 0.16492211403397194, 'support': 573094}, 'accuracy': 0.3546778207787458, 'macro avg': {'precision': 0.36500118817916355, 'recall': 0.35653776181001245, 'f1-score': 0.3191541834258333, 'support': 1717274}, 'weighted avg': {'precision': 0.3651608421805798, 'recall': 0.3546778207787458, 'f1-score': 0.31851784970953945, 'support': 1717274}}
[[188614 339072  53725]
 [158570 360175  44024]
 [161790 351014  60290]]
Evaluating performance on  val set...
1720/1720 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101012
{'0': {'precision': 0.39734916682627847, 'recall': 0.3245739747545231, 'f1-score': 0.35729343198445823, 'support': 159791}, '1': {'precision': 0.29897853781705497, 'recall': 0.6221494607087827, 'f1-score': 0.403872939187753, 'support': 129800}, '2': {'precision': 0.36687657751829283, 'recall': 0.09576733661653135, 'f1-score': 0.15188697666809162, 'support': 150260}, 'accuracy': 0.33422454422065656, 'macro avg': {'precision': 0.35440142738720876, 'recall': 0.34749692402661236, 'f1-score': 0.3043511159467676, 'support': 439851}, 'weighted avg': {'precision': 0.357910086513138, 'recall': 0.33422454422065656, 'f1-score': 0.30086897474587154, 'support': 439851}}
[[51864 94222 13705]
 [37917 80755 11128]
 [40744 95126 14390]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1047142
{'0': {'precision': 0.3365568897406813, 'recall': 0.6047651678878287, 'f1-score': 0.43245110911478124, 'support': 56913}, '1': {'precision': 0.42953086419753084, 'recall': 0.1350495295469366, 'f1-score': 0.20549045549045547, 'support': 64406}, '2': {'precision': 0.2928018657903106, 'recall': 0.2855429658423621, 'f1-score': 0.2891268620000209, 'support': 48364}, 'accuracy': 0.33549029661191754, 'macro avg': {'precision': 0.35296320657617425, 'recall': 0.3417858877590425, 'f1-score': 0.3090228088684192, 'support': 169683}, 'weighted avg': {'precision': 0.3593754032071578, 'recall': 0.33549029661191754, 'f1-score': 0.3054533441955696, 'support': 169683}}
[[34419  6538 15956]
 [38309  8698 17399]
 [29540  5014 13810]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011914
{'0': {'precision': 0.32576322563572063, 'recall': 0.6343280086194781, 'f1-score': 0.4304606287948628, 'support': 21347}, '1': {'precision': 0.37437252311756936, 'recall': 0.12804409704965436, 'f1-score': 0.1908224758441908, 'support': 22133}, '2': {'precision': 0.35482572184516276, 'recall': 0.2677168771427332, 'f1-score': 0.30517697692250617, 'support': 23043}, 'accuracy': 0.33889030861506547, 'macro avg': {'precision': 0.35165382353281754, 'recall': 0.34336299427062195, 'f1-score': 0.3088200271871866, 'support': 66523}, 'weighted avg': {'precision': 0.35200312283398183, 'recall': 0.33889030861506547, 'f1-score': 0.30733295221154666, 'support': 66523}}
[[13541  2286  5520]
 [13602  2834  5697]
 [14424  2450  6169]]
Evaluating performance on  val set...
51/51 - 1s - 622ms/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1040281
{'0': {'precision': 0.3344805608667941, 'recall': 0.6204776542917948, 'f1-score': 0.43465297333112474, 'support': 4229}, '1': {'precision': 0.4263959390862944, 'recall': 0.1751990898748578, 'f1-score': 0.24835371589840075, 'support': 5274}, '2': {'precision': 0.2747795414462081, 'recall': 0.23295454545454544, 'f1-score': 0.25214435992879103, 'support': 3344}, 'accuracy': 0.33681015022962557, 'macro avg': {'precision': 0.3452186804664323, 'recall': 0.34287709654039933, 'f1-score': 0.3117170163861055, 'support': 12847}, 'weighted avg': {'precision': 0.3566741855096839, 'recall': 0.33681015022962557, 'f1-score': 0.31066674410114187, 'support': 12847}}
[[2624  703  902]
 [3196  924 1154]
 [2025  540  779]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066505
{'0': {'precision': 0.45173984773494374, 'recall': 0.3401292322419629, 'f1-score': 0.3880690166300433, 'support': 175498}, '1': {'precision': 0.20183176687148766, 'recall': 0.6311223652434879, 'f1-score': 0.305852476572198, 'support': 85302}, '2': {'precision': 0.449344780840488, 'recall': 0.06207047220748416, 'f1-score': 0.10907395727644172, 'support': 160205}, 'accuracy': 0.29327917720692154, 'macro avg': {'precision': 0.36763879848230646, 'recall': 0.3444406898976449, 'f1-score': 0.267665150159561, 'support': 421005}, 'weighted avg': {'precision': 0.40019328461659404, 'recall': 0.29327917720692154, 'f1-score': 0.2652447300211953, 'support': 421005}}
[[ 59692 108514   7292]
 [ 26572  53836   4894]
 [ 45874 104387   9944]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0935688
{'0': {'precision': 0.41114961146535994, 'recall': 0.33551398741801636, 'f1-score': 0.3695009259173953, 'support': 59768}, '1': {'precision': 0.32989287012950685, 'recall': 0.6598041958041958, 'f1-score': 0.43986126132846004, 'support': 53625}, '2': {'precision': 0.3786265148733015, 'recall': 0.07704810836057917, 'f1-score': 0.12804073458869553, 'support': 53525}, 'accuracy': 0.3568159215902419, 'macro avg': {'precision': 0.37322299882272275, 'recall': 0.35745543052759715, 'f1-score': 0.312467640611517, 'support': 166918}, 'weighted avg': {'precision': 0.37461555582591394, 'recall': 0.3568159215902419, 'f1-score': 0.3146770977236097, 'support': 166918}}
[[20053 36066  3649]
 [15124 35382  3119]
 [13596 35805  4124]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.111553
{'0': {'precision': 0.4583333333333333, 'recall': 0.2777192189931235, 'f1-score': 0.3458665416471324, 'support': 19923}, '1': {'precision': 0.1898896587118296, 'recall': 0.6567561570889727, 'f1-score': 0.29460064692709625, 'support': 9014}, '2': {'precision': 0.39612097304405, 'recall': 0.06944044257477093, 'f1-score': 0.1181662172101005, 'support': 17353}, 'accuracy': 0.273449989198531, 'macro avg': {'precision': 0.34811465502973765, 'recall': 0.33463860621895575, 'f1-score': 0.25287780192810966, 'support': 46290}, 'weighted avg': {'precision': 0.3827376891091344, 'recall': 0.273449989198531, 'f1-score': 0.2505242537887997, 'support': 46290}}
[[ 5533 13226  1164]
 [ 2421  5920   673]
 [ 4118 12030  1205]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982624
{'0': {'precision': 0.3634941308496957, 'recall': 0.37264863957003697, 'f1-score': 0.36801446348674527, 'support': 119080}, '1': {'precision': 0.313520463142562, 'recall': 0.42591620393740537, 'f1-score': 0.3611761533160109, 'support': 99050}, '2': {'precision': 0.3699982416919947, 'recall': 0.24938626936425973, 'f1-score': 0.29794894615477974, 'support': 118130}, 'accuracy': 0.3450365788378041, 'macro avg': {'precision': 0.3490042785614174, 'recall': 0.3493170376239007, 'f1-score': 0.34237985431917867, 'support': 336260}, 'weighted avg': {'precision': 0.3510586310204243, 'recall': 0.3450365788378041, 'f1-score': 0.3413857411146632, 'support': 336260}}
[[44375 46938 27767]
 [34468 42187 22395]
 [43236 45434 29460]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.089758
{'0': {'precision': 0.3711703369700874, 'recall': 0.39654616228305983, 'f1-score': 0.3834388679206047, 'support': 46499}, '1': {'precision': 0.37747890042917087, 'recall': 0.5338327203808578, 'f1-score': 0.44224299065420564, 'support': 44321}, '2': {'precision': 0.37237431328193527, 'recall': 0.18672160748182787, 'f1-score': 0.24872415547572427, 'support': 43198}, 'accuracy': 0.3743153904699369, 'macro avg': {'precision': 0.3736745168937312, 'recall': 0.37236683004858184, 'f1-score': 0.3581353380168449, 'support': 134018}, 'weighted avg': {'precision': 0.3736447151117493, 'recall': 0.3743153904699369, 'f1-score': 0.35946336743172996, 'support': 134018}}
[[18439 20521  7539]
 [14605 23660  6056]
 [16634 18498  8066]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0915569
{'0': {'precision': 0.4167829565540981, 'recall': 0.42565320665083134, 'f1-score': 0.42117138290871486, 'support': 10525}, '1': {'precision': 0.3376413570274637, 'recall': 0.4516334053641795, 'f1-score': 0.38640565524741705, 'support': 7867}, '2': {'precision': 0.3567310952865378, 'recall': 0.23969013442697654, 'f1-score': 0.2867266285091306, 'support': 8778}, 'accuracy': 0.3730953257269047, 'macro avg': {'precision': 0.3703851362893665, 'recall': 0.3723255821473292, 'f1-score': 0.3647678888884209, 'support': 27170}, 'weighted avg': {'precision': 0.37446634994082323, 'recall': 0.3730953257269047, 'f1-score': 0.36766906293701884, 'support': 27170}}
[[4480 3751 2294]
 [2814 3553 1500]
 [3455 3219 2104]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974954
{'0': {'precision': 0.3449958527156224, 'recall': 0.6270796413362605, 'f1-score': 0.44510920583265534, 'support': 113421}, '1': {'precision': 0.4024345930232558, 'recall': 0.06488244024371193, 'f1-score': 0.11174828467644289, 'support': 102416}, '2': {'precision': 0.3609327871066493, 'recall': 0.34001136566043816, 'f1-score': 0.3501598504568404, 'support': 117899}, 'accuracy': 0.3531414051825395, 'macro avg': {'precision': 0.36945441094850917, 'recall': 0.34399114908013684, 'f1-score': 0.3023391136553129, 'support': 333736}, 'weighted avg': {'precision': 0.36825254259958534, 'recall': 0.3531414051825395, 'f1-score': 0.3092655265454707, 'support': 333736}}
[[71124  4880 37417]
 [62210  6645 33561]
 [72825  4987 40087]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10365
{'0': {'precision': 0.33027872627650284, 'recall': 0.6445773796609119, 'f1-score': 0.4367622968034612, 'support': 32263}, '1': {'precision': 0.329608938547486, 'recall': 0.02181549269735626, 'f1-score': 0.040922490029478065, 'support': 32454}, '2': {'precision': 0.34419896172884223, 'recall': 0.3401336196611787, 'f1-score': 0.3421542154215422, 'support': 33528}, 'accuracy': 0.33495852206219145, 'macro avg': {'precision': 0.334695542184277, 'recall': 0.335508830673149, 'f1-score': 0.2732796674181605, 'support': 98245}, 'weighted avg': {'precision': 0.33480801899662627, 'recall': 0.33495852206219145, 'f1-score': 0.2737147641899355, 'support': 98245}}
[[20796   687 10780]
 [20798   708 10948]
 [21371   753 11404]]
Evaluating performance on  val set...
93/93 - 1s - 899ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1116359
{'0': {'precision': 0.27689571954782166, 'recall': 0.6680968433956481, 'f1-score': 0.39152298850574707, 'support': 6526}, '1': {'precision': 0.42718446601941745, 'recall': 0.024611254055263453, 'f1-score': 0.04654114660461181, 'support': 8939}, '2': {'precision': 0.3653819964592129, 'recall': 0.3296473768276201, 'f1-score': 0.3465960470223486, 'support': 8139}, 'accuracy': 0.30770208439247587, 'macro avg': {'precision': 0.35648739400881735, 'recall': 0.3407851580928439, 'f1-score': 0.26155339404423583, 'support': 23604}, 'weighted avg': {'precision': 0.3643224655438989, 'recall': 0.30770208439247587, 'f1-score': 0.24538449242509852, 'support': 23604}}
[[4360  117 2049]
 [6108  220 2611]
 [5278  178 2683]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988705
{'0': {'precision': 0.3622485873653228, 'recall': 0.42357765030805183, 'f1-score': 0.3905199345797138, 'support': 235350}, '1': {'precision': 0.30830862518670443, 'recall': 0.3464413471076864, 'f1-score': 0.3262645588523248, 'support': 199598}, '2': {'precision': 0.36169388715760875, 'recall': 0.2612423017830168, 'f1-score': 0.3033689334459476, 'support': 232359}, 'accuracy': 0.34397960758691276, 'macro avg': {'precision': 0.34408369990321197, 'recall': 0.34375376639958505, 'f1-score': 0.34005114229266215, 'support': 667307}, 'weighted avg': {'precision': 0.34592147232458126, 'recall': 0.34397960758691276, 'f1-score': 0.34095419653579073, 'support': 667307}}
[[99689 77243 58418]
 [81742 69149 48707]
 [93764 77893 60702]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0946937
{'0': {'precision': 0.3587330529659148, 'recall': 0.3877612651990781, 'f1-score': 0.3726827628875428, 'support': 62915}, '1': {'precision': 0.35618672026089265, 'recall': 0.46971262835044675, 'f1-score': 0.4051471909708494, 'support': 59992}, '2': {'precision': 0.36381789137380194, 'recall': 0.22121673250016188, 'f1-score': 0.27513792131438003, 'support': 61772}, 'accuracy': 0.358676406088402, 'macro avg': {'precision': 0.3595792215335365, 'recall': 0.3595635420165622, 'f1-score': 0.3509892917242574, 'support': 184679}, 'weighted avg': {'precision': 0.35960668259620476, 'recall': 0.358676406088402, 'f1-score': 0.35060156262068143, 'support': 184679}}
[[24396 25721 12798]
 [20716 28179 11097]
 [22894 25213 13665]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987257
{'0': {'precision': 0.35792361082249285, 'recall': 0.4395223027457385, 'f1-score': 0.39454816172259766, 'support': 19594}, '1': {'precision': 0.34416565164433616, 'recall': 0.37698793894759314, 'f1-score': 0.35982986526755467, 'support': 18738}, '2': {'precision': 0.3493824421270616, 'recall': 0.2388874841972187, 'f1-score': 0.28375780874579526, 'support': 19775}, 'accuracy': 0.3510764623883525, 'macro avg': {'precision': 0.35049056819796354, 'recall': 0.35179924196351675, 'f1-score': 0.3460452785786492, 'support': 58107}, 'weighted avg': {'precision': 0.35058029160049803, 'recall': 0.3510764623883525, 'f1-score': 0.3456481897899413, 'support': 58107}}
[[8612 6361 4621]
 [7498 7064 4176]
 [7951 7100 4724]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0746094
{'0': {'precision': 0.2935649049580998, 'recall': 0.31125482245660857, 'f1-score': 0.3021511641586129, 'support': 350703}, '1': {'precision': 0.5006101110272717, 'recall': 0.6976439554628867, 'f1-score': 0.5829274905359133, 'support': 665692}, '2': {'precision': 0.3556294689954284, 'recall': 0.06907159871253796, 'f1-score': 0.11567616773544755, 'support': 351389}, 'accuracy': 0.437090213074579, 'macro avg': {'precision': 0.38326816166026667, 'recall': 0.3593234588773444, 'f1-score': 0.3335849408099913, 'support': 1367784}, 'weighted avg': {'precision': 0.41027715075941934, 'recall': 0.437090213074579, 'f1-score': 0.3908971150840647, 'support': 1367784}}
[[109158 223589  17956]
 [175255 464416  26021]
 [ 87423 239695  24271]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986882
{'0': {'precision': 0.3728582348444758, 'recall': 0.29845435547941335, 'f1-score': 0.33153307645253544, 'support': 106234}, '1': {'precision': 0.3338185159423277, 'recall': 0.7102323074533878, 'f1-score': 0.4541707923322497, 'support': 109467}, '2': {'precision': 0.40669934640522876, 'recall': 0.0434850973129739, 'f1-score': 0.07856939928659365, 'support': 114476}, 'accuracy': 0.3465747159856683, 'macro avg': {'precision': 0.37112536573067745, 'recall': 0.350723920081925, 'f1-score': 0.2880910893571263, 'support': 330177}, 'weighted avg': {'precision': 0.371648078407072, 'recall': 0.3465747159856683, 'f1-score': 0.28448713726523994, 'support': 330177}}
[[31706 71236  3292]
 [27750 77747  3970]
 [25579 83919  4978]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0901943
{'0': {'precision': 0.351989486087193, 'recall': 0.2680494202098288, 'f1-score': 0.30433760432584933, 'support': 28976}, '1': {'precision': 0.377496346809547, 'recall': 0.7264180418666742, 'f1-score': 0.49681417304479586, 'support': 35207}, '2': {'precision': 0.3512710465500165, 'recall': 0.03712361745926521, 'f1-score': 0.06715052066898076, 'support': 28661}, 'accuracy': 0.37057860497178063, 'macro avg': {'precision': 0.36025229314891877, 'recall': 0.34386369317858945, 'f1-score': 0.28943409934654196, 'support': 92844}, 'weighted avg': {'precision': 0.3614400574744329, 'recall': 0.37057860497178063, 'f1-score': 0.3041060713263926, 'support': 92844}}
[[ 7767 20288   921]
 [ 8588 25575  1044]
 [ 5711 21886  1064]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 55s - 55s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166688
{'0': {'precision': 0.438750653305156, 'recall': 0.26047710719195316, 'f1-score': 0.3268877679291713, 'support': 741259}, '1': {'precision': 0.21447335388114733, 'recall': 0.7017740498812352, 'f1-score': 0.3285397230633081, 'support': 404160}, '2': {'precision': 0.39278530240042914, 'recall': 0.04234708999298793, 'f1-score': 0.07645174130651824, 'support': 691665}, 'accuracy': 0.2754365069860714, 'macro avg': {'precision': 0.3486697698622441, 'recall': 0.3348660823553921, 'f1-score': 0.24395974409966584, 'support': 1837084}, 'weighted avg': {'precision': 0.37210343533976886, 'recall': 0.2754365069860714, 'f1-score': 0.23296164361098848, 'support': 1837084}}
[[193081 521912  26266]
 [101517 283629  19014]
 [145472 516903  29290]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980006
{'0': {'precision': 0.38320961958020916, 'recall': 0.3083274904538278, 'f1-score': 0.34171430168690864, 'support': 198247}, '1': {'precision': 0.3285436498354155, 'recall': 0.6906586301604095, 'f1-score': 0.4452727620353416, 'support': 187146}, '2': {'precision': 0.3996186767271105, 'recall': 0.05125896940904668, 'f1-score': 0.0908629722550177, 'support': 192181}, 'accuracy': 0.34667419239785724, 'macro avg': {'precision': 0.3704573153809117, 'recall': 0.350081696674428, 'f1-score': 0.2926166786590893, 'support': 577574}, 'weighted avg': {'precision': 0.37095662937928164, 'recall': 0.34667419239785724, 'f1-score': 0.2918015498643155, 'support': 577574}}
[[ 61125 128683   8439]
 [ 51531 129254   6361]
 [ 46852 135478   9851]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1114794
{'0': {'precision': 0.45347832827622864, 'recall': 0.30715110784416677, 'f1-score': 0.36623975959646554, 'support': 66661}, '1': {'precision': 0.20777818115810492, 'recall': 0.6611887707948244, 'f1-score': 0.31619292284743516, 'support': 34624}, '2': {'precision': 0.43346673336668334, 'recall': 0.055865381515747395, 'f1-score': 0.09897484222850453, 'support': 62042}, 'accuracy': 0.2867498943836598, 'macro avg': {'precision': 0.364907747600339, 'recall': 0.3414017533849129, 'f1-score': 0.26046917489080174, 'support': 163327}, 'weighted avg': {'precision': 0.3937902101745313, 'recall': 0.2867498943836598, 'f1-score': 0.2541059931099602, 'support': 163327}}
[[20475 43479  2707]
 [ 9908 22893  1823]
 [14768 43808  3466]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983711
{'0': {'precision': 0.3765040985719441, 'recall': 0.2888207785017253, 'f1-score': 0.32688453597864947, 'support': 505715}, '1': {'precision': 0.3238423925442022, 'recall': 0.6518729485111648, 'f1-score': 0.43271656475619574, 'support': 442057}, '2': {'precision': 0.385818427943722, 'recall': 0.13629281504839813, 'f1-score': 0.2014294093367801, 'support': 510247}, 'accuracy': 0.3455160735216756, 'macro avg': {'precision': 0.3620549730199561, 'recall': 0.35899551402042945, 'f1-score': 0.32034350335720846, 'support': 1458019}, 'weighted avg': {'precision': 0.363797222212621, 'recall': 0.3455160735216756, 'f1-score': 0.31506760296315506, 'support': 1458019}}
[[146061 295653  64001]
 [107188 288165  46704]
 [134691 306013  69543]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0916715
{'0': {'precision': 0.3835548236375474, 'recall': 0.26388178938992324, 'f1-score': 0.3126580460667212, 'support': 189763}, '1': {'precision': 0.36832775876205476, 'recall': 0.7180129896488735, 'f1-score': 0.48688980069331544, 'support': 197080}, '2': {'precision': 0.3825309031515646, 'recall': 0.11338192820794939, 'f1-score': 0.17491820600628888, 'support': 181775}, 'accuracy': 0.3731696850961454, 'macro avg': {'precision': 0.3781378285170556, 'recall': 0.3650922357489154, 'f1-score': 0.3248220175887752, 'support': 568618}, 'weighted avg': {'precision': 0.3779498778004448, 'recall': 0.3731696850961454, 'f1-score': 0.32901337561102706, 'support': 568618}}
[[ 50075 120927  18761]
 [ 41067 141506  14507]
 [ 39413 121752  20610]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093894
{'0': {'precision': 0.4010177324298362, 'recall': 0.2647129391602399, 'f1-score': 0.3189114972075113, 'support': 58350}, '1': {'precision': 0.34169834059516085, 'recall': 0.7100148325082349, 'f1-score': 0.46136322387237694, 'support': 51913}, '2': {'precision': 0.37659659774328424, 'recall': 0.12270682865834313, 'f1-score': 0.1851017707834802, 'support': 53583}, 'accuracy': 0.35936183977637537, 'macro avg': {'precision': 0.3731042235894271, 'recall': 0.36581153344227263, 'f1-score': 0.32179216395445615, 'support': 163846}, 'weighted avg': {'precision': 0.3742364545944114, 'recall': 0.35936183977637537, 'f1-score': 0.3202857749767233, 'support': 163846}}
[[15446 36334  6570]
 [10740 36859  4314]
 [12331 34677  6575]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959401
{'0': {'precision': 0.34208286134450944, 'recall': 0.31549699767997824, 'f1-score': 0.32825249809833346, 'support': 962922}, '1': {'precision': 0.3672790692745335, 'recall': 0.6734916724811546, 'f1-score': 0.4753388709135962, 'support': 1080634}, '2': {'precision': 0.41182348727168194, 'recall': 0.08634424618834553, 'f1-score': 0.1427574938431145, 'support': 1045281}, 'accuracy': 0.36319527381988753, 'macro avg': {'precision': 0.3737284726302416, 'recall': 0.3584443054498261, 'f1-score': 0.3154496209516814, 'support': 3088837}, 'weighted avg': {'precision': 0.3744984372295543, 'recall': 0.36319527381988753, 'f1-score': 0.3169382500036457, 'support': 3088837}}
[[303799 586624  72499]
 [296432 727798  56404]
 [287855 667172  90254]]
Evaluating performance on  train set...
2948/2948 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0961058
{'0': {'precision': 0.3736099488976954, 'recall': 0.28125656192675996, 'f1-score': 0.3209211281740632, 'support': 252403}, '1': {'precision': 0.34769053935963345, 'recall': 0.708957889371812, 'f1-score': 0.4665656887123462, 'support': 249177}, '2': {'precision': 0.3957258136029086, 'recall': 0.08822854883353104, 'f1-score': 0.1442876311492636, 'support': 252900}, 'accuracy': 0.3578080267203902, 'macro avg': {'precision': 0.3723421006200791, 'recall': 0.3594810000440343, 'f1-score': 0.3105914826785577, 'support': 754480}, 'weighted avg': {'precision': 0.3724629091795886, 'recall': 0.3578080267203902, 'f1-score': 0.30981501968036684, 'support': 754480}}
[[ 70990 162016  19397]
 [ 57846 176656  14675]
 [ 61175 169412  22313]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0933986
{'0': {'precision': 0.3681369812023078, 'recall': 0.26919805382600115, 'f1-score': 0.31098795275435803, 'support': 58782}, '1': {'precision': 0.36599842146803474, 'recall': 0.7326097603361929, 'f1-score': 0.4881340231687868, 'support': 63297}, '2': {'precision': 0.3767783386874713, 'recall': 0.05830862378153797, 'f1-score': 0.10098866798899088, 'support': 56321}, 'accuracy': 0.3670403587443946, 'macro avg': {'precision': 0.3703045804526046, 'recall': 0.353372145981244, 'f1-score': 0.3000368813040452, 'support': 178400}, 'weighted avg': {'precision': 0.37010629442776527, 'recall': 0.3670403587443946, 'f1-score': 0.30754313830229446, 'support': 178400}}
[[15824 39968  2990]
 [14483 46372  2442]
 [12677 40360  3284]]
testing model on single stock: results/universal/W1/deepOF_L2/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 165s - 165s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991933
{'0': {'precision': 0.39072975707469615, 'recall': 0.3934211279226213, 'f1-score': 0.39207082382310815, 'support': 2044697}, '1': {'precision': 0.26050183775844005, 'recall': 0.4624152494860774, 'f1-score': 0.3332609629073732, 'support': 1337750}, '2': {'precision': 0.4001233541085923, 'recall': 0.19831746862050184, 'f1-score': 0.2651939764432882, 'support': 2083765}, 'accuracy': 0.33593098840659674, 'macro avg': {'precision': 0.3504516496472428, 'recall': 0.35138461534306686, 'f1-score': 0.33017525439125656, 'support': 5466212}, 'weighted avg': {'precision': 0.3624399010753341, 'recall': 0.33593098840659674, 'f1-score': 0.3293117458143454, 'support': 5466212}}
[[804427 856407 383863]
 [483465 618596 235689]
 [770889 899629 413247]]
Evaluating performance on  train set...
6073/6073 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977097
{'0': {'precision': 0.3523733831880382, 'recall': 0.3345930590611296, 'f1-score': 0.34325312260257834, 'support': 511487}, '1': {'precision': 0.3428167907196592, 'recall': 0.5865097382035718, 'f1-score': 0.4327120337557595, 'support': 513185}, '2': {'precision': 0.3736130755932736, 'recall': 0.1345943711890028, 'f1-score': 0.197896419251052, 'support': 529881}, 'accuracy': 0.34958409266200635, 'macro avg': {'precision': 0.356267749833657, 'recall': 0.35189905615123473, 'f1-score': 0.32462052520312995, 'support': 1554553}, 'weighted avg': {'precision': 0.35645829347767993, 'recall': 0.34958409266200635, 'f1-score': 0.3232391481620383, 'support': 1554553}}
[[171140 277679  62668]
 [155294 300988  56903]
 [159244 299318  71319]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984417
{'0': {'precision': 0.357566591561468, 'recall': 0.36704200541146803, 'f1-score': 0.36224234540724437, 'support': 157813}, '1': {'precision': 0.32148258524463635, 'recall': 0.5131747614299957, 'f1-score': 0.3953161129991853, 'support': 140420}, '2': {'precision': 0.3761400743159554, 'recall': 0.1681188230927472, 'f1-score': 0.23237553639671837, 'support': 158959}, 'accuracy': 0.34276190309541726, 'macro avg': {'precision': 0.35172975037401993, 'recall': 0.349445196644737, 'f1-score': 0.329977998267716, 'support': 457192}, 'weighted avg': {'precision': 0.35294163329045947, 'recall': 0.34276190309541726, 'f1-score': 0.32724768310290864, 'support': 457192}}
[[57924 75730 24159]
 [48195 72060 20165]
 [55876 76359 26724]]
training model: results/universal/W1/deepVOL_L2/h300
Epoch 1/50
10622/10622 - 332s - loss: 3.2643 - accuracy300: 0.3812 - val_loss: 3.2866 - val_accuracy300: 0.3547 - 332s/epoch - 31ms/step
Epoch 2/50
10622/10622 - 330s - loss: 3.2559 - accuracy300: 0.3885 - val_loss: 3.2929 - val_accuracy300: 0.3556 - 330s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 330s - loss: 3.2507 - accuracy300: 0.3919 - val_loss: 3.3159 - val_accuracy300: 0.3557 - 330s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 324s - loss: 3.2449 - accuracy300: 0.3955 - val_loss: 3.3155 - val_accuracy300: 0.3554 - 324s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 330s - loss: 3.2419 - accuracy300: 0.3975 - val_loss: 3.3137 - val_accuracy300: 0.3570 - 330s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 331s - loss: 3.2398 - accuracy300: 0.3985 - val_loss: 3.3197 - val_accuracy300: 0.3567 - 331s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 325s - loss: 3.2371 - accuracy300: 0.3998 - val_loss: 3.3175 - val_accuracy300: 0.3563 - 325s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 329s - loss: 3.2351 - accuracy300: 0.4008 - val_loss: 3.3171 - val_accuracy300: 0.3576 - 329s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 331s - loss: 3.2328 - accuracy300: 0.4023 - val_loss: 3.3188 - val_accuracy300: 0.3569 - 331s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 327s - loss: 3.2311 - accuracy300: 0.4032 - val_loss: 3.3278 - val_accuracy300: 0.3566 - 327s/epoch - 31ms/step
Epoch 11/50
10622/10622 - 327s - loss: 3.2302 - accuracy300: 0.4039 - val_loss: 3.3230 - val_accuracy300: 0.3564 - 327s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 546s - 546s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001158
{'0': {'precision': 0.36309506644670686, 'recall': 0.3112777841454711, 'f1-score': 0.33519566399636563, 'support': 3114681}, '1': {'precision': 0.300184665920182, 'recall': 0.5100072216145879, 'f1-score': 0.37792614266502406, 'support': 2809621}, '2': {'precision': 0.379241362575642, 'recall': 0.19470619338032377, 'f1-score': 0.2573079763585076, 'support': 3122479}, 'accuracy': 0.33276189619269, 'macro avg': {'precision': 0.34750703164751034, 'recall': 0.33866373304679426, 'f1-score': 0.3234765943399658, 'support': 9046781}, 'weighted avg': {'precision': 0.3491301089831235, 'recall': 0.33276189619269, 'f1-score': 0.3215835052848574, 'support': 9046781}}
[[ 969531 1666789  478361]
 [ 859910 1432927  516784]
 [ 840744 1673769  607966]]
Evaluating performance on  train set...
10622/10622 - 166s - 166s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096265
{'0': {'precision': 0.36820700259574607, 'recall': 0.3343181833137021, 'f1-score': 0.35044521864888745, 'support': 911814}, '1': {'precision': 0.3242833651906704, 'recall': 0.4678048714927627, 'f1-score': 0.38304151218165694, 'support': 892868}, '2': {'precision': 0.3856123680066115, 'recall': 0.2542754029186984, 'f1-score': 0.3064654294096816, 'support': 913832}, 'accuracy': 0.3512540306947104, 'macro avg': {'precision': 0.359367578597676, 'recall': 0.3521328192417211, 'f1-score': 0.3466507200800753, 'support': 2718514}, 'weighted avg': {'precision': 0.35963157116576144, 'recall': 0.3512540306947104, 'f1-score': 0.34636727336480017, 'support': 2718514}}
[[304836 435156 171822]
 [276780 417688 198400]
 [246277 435190 232365]]
Evaluating performance on  val set...
3064/3064 - 50s - 50s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0956112
{'0': {'precision': 0.3641818362334293, 'recall': 0.3258104131427115, 'f1-score': 0.3439291807395419, 'support': 258942}, '1': {'precision': 0.33915682187868473, 'recall': 0.5059691472164608, 'f1-score': 0.4061001417867539, 'support': 266621}, '2': {'precision': 0.37754758295435403, 'recall': 0.2256995139709157, 'f1-score': 0.2825121128904423, 'support': 258215}, 'accuracy': 0.3541143027745101, 'macro avg': {'precision': 0.36029541368882273, 'recall': 0.352493024776696, 'f1-score': 0.344180478472246, 'support': 783778}, 'weighted avg': {'precision': 0.36007230768997345, 'recall': 0.3541143027745101, 'f1-score': 0.3448443322629496, 'support': 783778}}
[[ 84366 130753  43823]
 [ 79459 134902  52260]
 [ 67834 132102  58279]]
testing model out of sample: results/universal/W1/deepVOL_L2/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 376s - 376s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958418
{'0': {'precision': 0.3653417545280152, 'recall': 0.42328850208241875, 'f1-score': 0.39218623106599243, 'support': 2029611}, '1': {'precision': 0.31955696216241974, 'recall': 0.3588103204540081, 'f1-score': 0.33804795406573307, 'support': 2055646}, '2': {'precision': 0.372347889634974, 'recall': 0.266145101713607, 'f1-score': 0.31041395380218, 'support': 2013939}, 'accuracy': 0.34966871043330955, 'macro avg': {'precision': 0.35241553544180304, 'recall': 0.34941464141667794, 'f1-score': 0.3468827129779685, 'support': 6099196}, 'weighted avg': {'precision': 0.3522240589242023, 'recall': 0.34966871043330955, 'f1-score': 0.3469387081362685, 'support': 6099196}}
[[859111 778949 391551]
 [806096 737587 511963]
 [686320 791619 536000]]
Evaluating performance on  train set...
6711/6711 - 108s - 108s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940536
{'0': {'precision': 0.37739147180600097, 'recall': 0.43812190231167947, 'f1-score': 0.4054954211455771, 'support': 581482}, '1': {'precision': 0.3141781204116178, 'recall': 0.3604980577037265, 'f1-score': 0.3357480398901306, 'support': 559132}, '2': {'precision': 0.39124238438364983, 'recall': 0.271829002677469, 'f1-score': 0.3207830385308409, 'support': 576664}, 'accuracy': 0.35700684455283305, 'macro avg': {'precision': 0.36093732553375624, 'recall': 0.356816320897625, 'f1-score': 0.3540088331888495, 'support': 1717278}, 'weighted avg': {'precision': 0.3614608624689181, 'recall': 0.35700684455283305, 'f1-score': 0.35433971182870205, 'support': 1717278}}
[[254760 216970 109752]
 [223415 201566 134151]
 [196880 223030 156754]]
Evaluating performance on  val set...
1720/1720 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940299
{'0': {'precision': 0.3928090681512252, 'recall': 0.41638258309444487, 'f1-score': 0.40425245171016383, 'support': 154884}, '1': {'precision': 0.2959687952275054, 'recall': 0.3698445839643587, 'f1-score': 0.3288082197152904, 'support': 136022}, '2': {'precision': 0.40314096499526964, 'recall': 0.2860883401478378, 'f1-score': 0.3346750599849988, 'support': 148947}, 'accuracy': 0.35786956096695943, 'macro avg': {'precision': 0.3639729427913334, 'recall': 0.35743850240221375, 'f1-score': 0.35591191047015097, 'support': 439853}, 'weighted avg': {'precision': 0.3663604533540081, 'recall': 0.35786956096695943, 'f1-score': 0.35736083317011785, 'support': 439853}}
[[64491 60788 29605]
 [52232 50307 33483]
 [47456 58879 42612]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986806
{'0': {'precision': 0.3455688258907671, 'recall': 0.5941428326768282, 'f1-score': 0.43697923555085305, 'support': 58390}, '1': {'precision': 0.3448864065212469, 'recall': 0.3849471786490539, 'f1-score': 0.3638173190228988, 'support': 59351}, '2': {'precision': 0.3351900393184797, 'recall': 0.019693148786262923, 'f1-score': 0.037200676375934105, 'support': 51947}, 'accuracy': 0.3451157418320683, 'macro avg': {'precision': 0.34188175724349784, 'recall': 0.3329277200373817, 'f1-score': 0.279332410316562, 'support': 169688}, 'weighted avg': {'precision': 0.34215285600444034, 'recall': 0.3451157418320683, 'f1-score': 0.289004542459355, 'support': 169688}}
[[34692 22783   915]
 [35390 22847  1114]
 [30309 20615  1023]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102655
{'0': {'precision': 0.33920629490249743, 'recall': 0.45512967638283225, 'f1-score': 0.3887092031755366, 'support': 21785}, '1': {'precision': 0.3392252604166667, 'recall': 0.47567098776702577, 'f1-score': 0.39602492969521924, 'support': 21908}, '2': {'precision': 0.34717784877529284, 'recall': 0.09995619798510731, 'f1-score': 0.15522225623235722, 'support': 22830}, 'accuracy': 0.34000270583106595, 'macro avg': {'precision': 0.341869801364819, 'recall': 0.34358562071165516, 'f1-score': 0.3133187963677043, 'support': 66523}, 'weighted avg': {'precision': 0.3419482949836775, 'recall': 0.34000270583106595, 'f1-score': 0.3109882034894193, 'support': 66523}}
[[ 9915  9757  2113]
 [ 9309 10421  2178]
 [10006 10542  2282]]
Evaluating performance on  val set...
51/51 - 1s - 509ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1010371
{'0': {'precision': 0.28923868624186466, 'recall': 0.48812260536398466, 'f1-score': 0.36323892796046375, 'support': 3915}, '1': {'precision': 0.41417981372362667, 'recall': 0.3919064748201439, 'f1-score': 0.40273542186489236, 'support': 5560}, '2': {'precision': 0.23186925434116445, 'recall': 0.0673190984578885, 'f1-score': 0.10434382900482647, 'support': 3372}, 'accuracy': 0.3360317583871721, 'macro avg': {'precision': 0.31176258476888524, 'recall': 0.3157827262140057, 'f1-score': 0.29010605961006086, 'support': 12847}, 'weighted avg': {'precision': 0.3282534713613039, 'recall': 0.3360317583871721, 'f1-score': 0.3123792901018364, 'support': 12847}}
[[1911 1688  316]
 [2945 2179  436]
 [1751 1394  227]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0918239
{'0': {'precision': 0.34286121892066884, 'recall': 0.6944020507045593, 'f1-score': 0.4590609549137874, 'support': 134978}, '1': {'precision': 0.38183739343147044, 'recall': 0.16213093394301448, 'f1-score': 0.22761491835458056, 'support': 162708}, '2': {'precision': 0.36851686823679186, 'recall': 0.2347231682397587, 'f1-score': 0.2867828447447418, 'support': 123324}, 'accuracy': 0.35404384693950264, 'macro avg': {'precision': 0.36440516019631036, 'recall': 0.3637520509624442, 'f1-score': 0.32448623933770326, 'support': 421010}, 'weighted avg': {'precision': 0.3654395251332649, 'recall': 0.35404384693950264, 'f1-score': 0.31914943885725, 'support': 421010}}
[[ 93729  19979  21270]
 [107995  26380  28333]
 [ 71649  22728  28947]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0878665
{'0': {'precision': 0.3804491562779027, 'recall': 0.5941714326060863, 'f1-score': 0.46387696463146577, 'support': 56652}, '1': {'precision': 0.3404791238877481, 'recall': 0.22059423503325942, 'f1-score': 0.26772874058127016, 'support': 56375}, '2': {'precision': 0.4058593377230652, 'recall': 0.3156742313187731, 'f1-score': 0.3551306271984302, 'support': 53891}, 'accuracy': 0.37808384955487123, 'macro avg': {'precision': 0.375595872629572, 'recall': 0.37681329965270627, 'f1-score': 0.36224544413705534, 'support': 166918}, 'weighted avg': {'precision': 0.3751535591120266, 'recall': 0.37808384955487123, 'f1-score': 0.36251998095425003, 'support': 166918}}
[[33661 11808 11183]
 [30218 12436 13721]
 [24598 12281 17012]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0879612
{'0': {'precision': 0.38677797327144087, 'recall': 0.6375809935205183, 'f1-score': 0.48147630364881866, 'support': 16205}, '1': {'precision': 0.32632826813234184, 'recall': 0.19924985194446274, 'f1-score': 0.24742605000817128, 'support': 15197}, '2': {'precision': 0.40425325305884635, 'recall': 0.2796211714132187, 'f1-score': 0.3305804812197252, 'support': 14888}, 'accuracy': 0.37854828256642903, 'macro avg': {'precision': 0.37245316482087637, 'recall': 0.37215067229273324, 'f1-score': 0.35316094495890504, 'support': 46290}, 'weighted avg': {'precision': 0.3725528230548931, 'recall': 0.37854828256642903, 'f1-score': 0.35610584115365207, 'support': 46290}}
[[10332  3151  2722]
 [ 8756  3028  3413]
 [ 7625  3100  4163]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103396
{'0': {'precision': 0.36931995695490677, 'recall': 0.35440297140192206, 'f1-score': 0.36170773375944515, 'support': 120078}, '1': {'precision': 0.2838135426406181, 'recall': 0.46892563495370604, 'f1-score': 0.3536083935913795, 'support': 98393}, '2': {'precision': 0.3578135422189536, 'recall': 0.17760666927008167, 'f1-score': 0.23738390927194022, 'support': 117794}, 'accuracy': 0.32598099713023954, 'macro avg': {'precision': 0.33698234727149284, 'recall': 0.33364509187523655, 'f1-score': 0.31756667887425494, 'support': 336265}, 'weighted avg': {'precision': 0.3402695971463252, 'recall': 0.32598099713023954, 'f1-score': 0.31578704930272905, 'support': 336265}}
[[42556 57799 19723]
 [34429 46139 17825]
 [38243 58630 20921]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995104
{'0': {'precision': 0.3714226028828076, 'recall': 0.450402144772118, 'f1-score': 0.40711730191289414, 'support': 47371}, '1': {'precision': 0.2820284517473744, 'recall': 0.3357665992097909, 'f1-score': 0.3065603519384108, 'support': 41508}, '2': {'precision': 0.3556725706079464, 'recall': 0.2139834732714504, 'f1-score': 0.26720703773376125, 'support': 45139}, 'accuracy': 0.33526839678252174, 'macro avg': {'precision': 0.3363745417460428, 'recall': 0.3333840724177864, 'f1-score': 0.32696156386168873, 'support': 134018}, 'weighted avg': {'precision': 0.33843066797716415, 'recall': 0.33526839678252174, 'f1-score': 0.3288492536333889, 'support': 134018}}
[[21336 17801  8234]
 [18307 13937  9264]
 [17801 17679  9659]]
Evaluating performance on  val set...
107/107 - 1s - 894ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032894
{'0': {'precision': 0.3617886178861789, 'recall': 0.37417965545529125, 'f1-score': 0.367879826595423, 'support': 9752}, '1': {'precision': 0.2724814063556457, 'recall': 0.395340282035561, 'f1-score': 0.32260969630259667, 'support': 8155}, '2': {'precision': 0.3427265803503427, 'recall': 0.19432149411637697, 'f1-score': 0.2480192903892525, 'support': 9263}, 'accuracy': 0.3192123665807876, 'macro avg': {'precision': 0.3256655348640558, 'recall': 0.32128047720240976, 'f1-score': 0.3128362710957574, 'support': 27170}, 'weighted avg': {'precision': 0.32848453383296033, 'recall': 0.3192123665807876, 'f1-score': 0.3134283705992597, 'support': 27170}}
[[3649 4441 1662]
 [3141 3224 1790]
 [3296 4167 1800]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048077
{'0': {'precision': 0.3337157780855711, 'recall': 0.8724834028447119, 'f1-score': 0.4827751208096678, 'support': 111013}, '1': {'precision': 0.3704259295691521, 'recall': 0.1388230957098751, 'f1-score': 0.2019588520403033, 'support': 108505}, '2': {'precision': 0.35364564987671715, 'recall': 0.00878982341559931, 'f1-score': 0.01715330337769729, 'support': 114223}, 'accuracy': 0.3383581879361541, 'macro avg': {'precision': 0.3525957858438134, 'recall': 0.34003210732339545, 'f1-score': 0.23396242540922277, 'support': 333741}, 'weighted avg': {'precision': 0.35247189355333214, 'recall': 0.3383581879361541, 'f1-score': 0.23211760466585604, 'support': 333741}}
[[ 96857  13137   1019]
 [ 92626  15063    816]
 [100755  12464   1004]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050576
{'0': {'precision': 0.331205546590162, 'recall': 0.8561055493758497, 'f1-score': 0.4776286642705074, 'support': 32364}, '1': {'precision': 0.3572910491997629, 'recall': 0.1483509721880384, 'f1-score': 0.2096521739130435, 'support': 32504}, '2': {'precision': 0.3378995433789954, 'recall': 0.011085145904487986, 'f1-score': 0.02146607489919647, 'support': 33378}, 'accuracy': 0.3348635058933697, 'macro avg': {'precision': 0.3421320463896402, 'recall': 0.3385138891561254, 'f1-score': 0.23624897102758247, 'support': 98246}, 'weighted avg': {'precision': 0.3421099640895019, 'recall': 0.3348635058933697, 'f1-score': 0.23399428983679382, 'support': 98246}}
[[27707  4296   361]
 [27318  4822   364]
 [28630  4378   370]]
Evaluating performance on  val set...
93/93 - 1s - 815ms/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1081511
{'0': {'precision': 0.3004921058027476, 'recall': 0.8407917383820999, 'f1-score': 0.442749244712991, 'support': 6972}, '1': {'precision': 0.42010309278350516, 'recall': 0.19377080361388493, 'f1-score': 0.2652131467621217, 'support': 8412}, '2': {'precision': 0.3055555555555556, 'recall': 0.008029197080291971, 'f1-score': 0.015647226173541962, 'support': 8220}, 'accuracy': 0.3201999661074394, 'macro avg': {'precision': 0.3420502513806028, 'recall': 0.3475305796920922, 'f1-score': 0.2412032058828849, 'support': 23604}, 'weighted avg': {'precision': 0.3448824286060951, 'recall': 0.3201999661074394, 'f1-score': 0.23074228621625384, 'support': 23604}}
[[5862 1039   71]
 [6703 1630   79]
 [6943 1211   66]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001617
{'0': {'precision': 0.3656228611160402, 'recall': 0.43481743714307863, 'f1-score': 0.3972293643315084, 'support': 232194}, '1': {'precision': 0.2996646703281539, 'recall': 0.42333503911104614, 'f1-score': 0.35092283794129475, 'support': 205185}, '2': {'precision': 0.37785630385644203, 'recall': 0.16648762900497102, 'f1-score': 0.2311347526294816, 'support': 229933}, 'accuracy': 0.33882951303138564, 'macro avg': {'precision': 0.34771461176687873, 'recall': 0.341546701753032, 'f1-score': 0.3264289849674282, 'support': 667312}, 'weighted avg': {'precision': 0.34955727382376367, 'recall': 0.33882951303138564, 'f1-score': 0.3257604907463516, 'support': 667312}}
[[100962 100714  30518]
 [ 85811  86862  32512]
 [ 89364 102288  38281]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006509
{'0': {'precision': 0.34525958901277615, 'recall': 0.40595375066846, 'f1-score': 0.37315478229782667, 'support': 61709}, '1': {'precision': 0.30203614085667213, 'recall': 0.38442762597470675, 'f1-score': 0.3382874441401182, 'support': 61044}, '2': {'precision': 0.3547796787405234, 'recall': 0.19723222503915902, 'f1-score': 0.25352346555410255, 'support': 61927}, 'accuracy': 0.32884990253411306, 'macro avg': {'precision': 0.3340251362033239, 'recall': 0.3292045338941086, 'f1-score': 0.3216552306640158, 'support': 184680}, 'weighted avg': {'precision': 0.3341648219959307, 'recall': 0.32884990253411306, 'f1-score': 0.32151491689557543, 'support': 184680}}
[[25051 26730  9928]
 [25292 23467 12285]
 [22214 27499 12214]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020288
{'0': {'precision': 0.3694459282280387, 'recall': 0.36921285062603126, 'f1-score': 0.3693293526541907, 'support': 20606}, '1': {'precision': 0.2767008318478907, 'recall': 0.44590065828845005, 'f1-score': 0.34149136074063896, 'support': 16710}, '2': {'precision': 0.38622839331255315, 'recall': 0.19666217776067718, 'f1-score': 0.2606201599796042, 'support': 20792}, 'accuracy': 0.3295243339987609, 'macro avg': {'precision': 0.3441250511294942, 'recall': 0.33725856222505285, 'f1-score': 0.3238136244581446, 'support': 58108}, 'weighted avg': {'precision': 0.34878045107385947, 'recall': 0.3295243339987609, 'f1-score': 0.3224260970101236, 'support': 58108}}
[[7608 9707 3291]
 [6052 7451 3207]
 [6933 9770 4089]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/EXC
Evaluating performance on  test set...
5343/5343 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0889341
{'0': {'precision': 0.3770149969241806, 'recall': 0.5047779563183927, 'f1-score': 0.4316406905928647, 'support': 445588}, '1': {'precision': 0.3530438438999646, 'recall': 0.22461363380616614, 'f1-score': 0.2745518364486891, 'support': 470991}, '2': {'precision': 0.3904984879523949, 'recall': 0.40809822477338714, 'f1-score': 0.39910442197070517, 'support': 451210}, 'accuracy': 0.37641185884664957, 'macro avg': {'precision': 0.3735191095921801, 'recall': 0.3791632716326487, 'f1-score': 0.3684323163374197, 'support': 1367789}, 'weighted avg': {'precision': 0.3732086266819956, 'recall': 0.37641185884664957, 'f1-score': 0.3668148100899333, 'support': 1367789}}
[[224923  96339 124326]
 [202118 105791 163082]
 [169548  97524 184138]]
Evaluating performance on  train set...
1290/1290 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0881798
{'0': {'precision': 0.37784830781241, 'recall': 0.5429243938544147, 'f1-score': 0.44558893441695147, 'support': 108761}, '1': {'precision': 0.31986110720611804, 'recall': 0.20872014090191907, 'f1-score': 0.2526062193998202, 'support': 109012}, '2': {'precision': 0.417920323842516, 'recall': 0.38208604675990177, 'f1-score': 0.3992006320583724, 'support': 112404}, 'accuracy': 0.37782765001802066, 'macro avg': {'precision': 0.37187657962034804, 'recall': 0.3779101938387452, 'f1-score': 0.3657985952917147, 'support': 330177}, 'weighted avg': {'precision': 0.3723450600918084, 'recall': 0.37782765001802066, 'f1-score': 0.3660810872084505, 'support': 330177}}
[[59049 24019 25693]
 [52134 22753 34125]
 [45094 24362 42948]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0870613
{'0': {'precision': 0.37138799981968174, 'recall': 0.5448202889924941, 'f1-score': 0.4416893404280985, 'support': 30243}, '1': {'precision': 0.35445153448799754, 'recall': 0.2104899100778924, 'f1-score': 0.26412815819763386, 'support': 33251}, '2': {'precision': 0.398858415703745, 'recall': 0.3904599659284497, 'f1-score': 0.3946145105196102, 'support': 29350}, 'accuracy': 0.37628710525182024, 'macro avg': {'precision': 0.37489931667047477, 'recall': 0.3819233883329454, 'f1-score': 0.36681066971511417, 'support': 92844}, 'weighted avg': {'precision': 0.37400639516513673, 'recall': 0.37628710525182024, 'f1-score': 0.36321649212169954, 'support': 92844}}
[[16477  6639  7127]
 [16107  6999 10145]
 [11782  6108 11460]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/AAL
Evaluating performance on  test set...
7177/7177 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943552
{'0': {'precision': 0.4168642174585143, 'recall': 0.483061754599932, 'f1-score': 0.4475282780312053, 'support': 682184}, '1': {'precision': 0.25468728137680147, 'recall': 0.3204005256599252, 'f1-score': 0.2837894938252904, 'support': 499943}, '2': {'precision': 0.42452213514542464, 'recall': 0.2706981473734354, 'f1-score': 0.3305926434899837, 'support': 654962}, 'accuracy': 0.36308311682232053, 'macro avg': {'precision': 0.36535787799358016, 'recall': 0.3580534758777642, 'f1-score': 0.35397013844882647, 'support': 1837089}, 'weighted avg': {'precision': 0.3754598114273173, 'recall': 0.36308311682232053, 'f1-score': 0.3612785339727273, 'support': 1837089}}
[[329537 229777 122870]
 [222289 160182 117472]
 [238688 238977 177297]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0906434
{'0': {'precision': 0.38949627387901975, 'recall': 0.4883472528813973, 'f1-score': 0.43335612682206864, 'support': 196606}, '1': {'precision': 0.3093587977326028, 'recall': 0.3122684472563986, 'f1-score': 0.31080681289886314, 'support': 188402}, '2': {'precision': 0.40568354412411817, 'recall': 0.2968317520655149, 'f1-score': 0.34282458428920576, 'support': 192567}, 'accuracy': 0.36705882352941177, 'macro avg': {'precision': 0.3681795385785802, 'recall': 0.3658158174011035, 'f1-score': 0.36232917467004583, 'support': 577575}, 'weighted avg': {'precision': 0.36875277439990556, 'recall': 0.36705882352941177, 'f1-score': 0.36319740562969444, 'support': 577575}}
[[96012 63925 36669]
 [82501 58832 47069]
 [67990 67417 57160]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0905561
{'0': {'precision': 0.41503359856046335, 'recall': 0.49681946688206785, 'f1-score': 0.45225876621884525, 'support': 59424}, '1': {'precision': 0.26496537860174224, 'recall': 0.3002784457663587, 'f1-score': 0.28151883714031445, 'support': 47406}, '2': {'precision': 0.4314790746035872, 'recall': 0.293798010549046, 'f1-score': 0.3495703816022239, 'support': 56498}, 'accuracy': 0.3695447198275862, 'macro avg': {'precision': 0.3704926839219309, 'recall': 0.36363197439915745, 'f1-score': 0.3611159949871279, 'support': 163328}, 'weighted avg': {'precision': 0.37716503022019887, 'recall': 0.3695447198275862, 'f1-score': 0.36717975078997384, 'support': 163328}}
[[29523 19586 10315]
 [21615 14235 11556]
 [19996 19903 16599]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/WBA
Evaluating performance on  test set...
5696/5696 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009476
{'0': {'precision': 0.38293459230481397, 'recall': 0.31909201490469, 'f1-score': 0.34811036898145326, 'support': 519568}, '1': {'precision': 0.28796415344988874, 'recall': 0.4792251643859961, 'f1-score': 0.3597538849043716, 'support': 422025}, '2': {'precision': 0.38402049877459715, 'recall': 0.23999914799847413, 'f1-score': 0.29539003458129465, 'support': 516431}, 'accuracy': 0.33742791613855466, 'macro avg': {'precision': 0.3516397481764333, 'recall': 0.3461054424297201, 'f1-score': 0.33441809615570656, 'support': 1458024}, 'weighted avg': {'precision': 0.35583002907838335, 'recall': 0.33742791613855466, 'f1-score': 0.33280708165062833, 'support': 1458024}}
[[165790 250470 103308]
 [124280 202245  95500]
 [142876 249612 123943]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946662
{'0': {'precision': 0.38146710581561344, 'recall': 0.4204948086743221, 'f1-score': 0.4000313101589235, 'support': 194459}, '1': {'precision': 0.32670956317994626, 'recall': 0.3988460131775033, 'f1-score': 0.35919180001474826, 'support': 183191}, '2': {'precision': 0.38723531303109643, 'recall': 0.2648754509894276, 'f1-score': 0.31457578631508576, 'support': 190969}, 'accuracy': 0.3612559552178172, 'macro avg': {'precision': 0.3651373273422187, 'recall': 0.36140542428041766, 'f1-score': 0.3579329654962525, 'support': 568619}, 'weighted avg': {'precision': 0.3657631982268116, 'recall': 0.3612559552178172, 'f1-score': 0.3581741322669511, 'support': 568619}}
[[81769 75276 37414]
 [67497 73065 42629]
 [65088 75298 50583]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0960362
{'0': {'precision': 0.39175558276485334, 'recall': 0.4584079551075406, 'f1-score': 0.42246901354208416, 'support': 58629}, '1': {'precision': 0.30331927648882556, 'recall': 0.41516833594787017, 'f1-score': 0.35053787177680235, 'support': 49722}, '2': {'precision': 0.3929228279261385, 'recall': 0.19248234106962664, 'f1-score': 0.2583875571466583, 'support': 55496}, 'accuracy': 0.35521553644558646, 'macro avg': {'precision': 0.3626658957266058, 'recall': 0.3553528773750125, 'f1-score': 0.34379814748851495, 'support': 163847}, 'weighted avg': {'precision': 0.3653135204555894, 'recall': 0.35521553644558646, 'f1-score': 0.34506494306795954, 'support': 163847}}
[[26876 23784  7969]
 [20544 20643  8535]
 [21184 23630 10682]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 85s - 85s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948408
{'0': {'precision': 0.3280577935924414, 'recall': 0.374285973536586, 'f1-score': 0.3496505170194073, 'support': 936765}, '1': {'precision': 0.3628989020120298, 'recall': 0.3529646018441046, 'f1-score': 0.35786282096616256, 'support': 1192774}, '2': {'precision': 0.3470895434739886, 'recall': 0.3111425691361332, 'f1-score': 0.32813449908588904, 'support': 959303}, 'accuracy': 0.3464421294452743, 'macro avg': {'precision': 0.3460154130261533, 'recall': 0.3461310481722746, 'f1-score': 0.34521594569048625, 'support': 3088842}, 'weighted avg': {'precision': 0.3474225856441825, 'recall': 0.3464421294452743, 'f1-score': 0.3461395061215075, 'support': 3088842}}
[[350618 368120 218027]
 [428323 421007 343444]
 [289828 370995 298480]]
Evaluating performance on  train set...
2948/2948 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933392
{'0': {'precision': 0.38198601502090346, 'recall': 0.4064666490821264, 'f1-score': 0.393846282955783, 'support': 254011}, '1': {'precision': 0.32381489841986455, 'recall': 0.3844439030332562, 'f1-score': 0.35153439153439153, 'support': 246270}, '2': {'precision': 0.3932652805872417, 'recall': 0.29674548880610224, 'f1-score': 0.33825471454867906, 'support': 254201}, 'accuracy': 0.362310830477069, 'macro avg': {'precision': 0.3663553980093366, 'recall': 0.36255201364049494, 'f1-score': 0.3612117963462846, 'support': 754482}, 'weighted avg': {'precision': 0.3667986410356936, 'recall': 0.362310830477069, 'f1-score': 0.3613053054626151, 'support': 754482}}
[[103247  98029  52735]
 [ 87949  94677  63644]
 [ 79094  99674  75433]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925272
{'0': {'precision': 0.3904130399814123, 'recall': 0.3570039387451583, 'f1-score': 0.3729618057334085, 'support': 61187}, '1': {'precision': 0.32178795796964477, 'recall': 0.39786221236961045, 'f1-score': 0.35580417860902575, 'support': 58191}, '2': {'precision': 0.39506148393101126, 'recall': 0.33802649859374473, 'f1-score': 0.36432530153483744, 'support': 59022}, 'accuracy': 0.36405269058295964, 'macro avg': {'precision': 0.36908749396068946, 'recall': 0.3642975499028378, 'f1-score': 0.36436376195909054, 'support': 178400}, 'weighted avg': {'precision': 0.36956661796037227, 'recall': 0.36405269058295964, 'f1-score': 0.3645079759643333, 'support': 178400}}
[[21844 25369 13974]
 [18463 23152 16576]
 [15644 23427 19951]]
testing model on single stock: results/universal/W1/deepVOL_L2/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 178s - 178s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1030623
{'0': {'precision': 0.36057214981550295, 'recall': 0.20395327848097275, 'f1-score': 0.2605369692760159, 'support': 1903534}, '1': {'precision': 0.29586489332742477, 'recall': 0.6585640382352655, 'f1-score': 0.40829855943853843, 'support': 1645392}, '2': {'precision': 0.37076654970792405, 'recall': 0.14059472453581642, 'f1-score': 0.2038786413788305, 'support': 1917291}, 'accuracy': 0.318572972862219, 'macro avg': {'precision': 0.3424011976169506, 'recall': 0.3343706804173516, 'f1-score': 0.2909047233644616, 'support': 5466217}, 'weighted avg': {'precision': 0.3446702617266671, 'recall': 0.318572972862219, 'f1-score': 0.2851417802830379, 'support': 5466217}}
[[ 388232 1286591  228711]
 [ 333031 1083596  228765]
 [ 355448 1292282  269561]]
Evaluating performance on  train set...
6073/6073 - 44s - 44s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09884
{'0': {'precision': 0.36013465215446966, 'recall': 0.19684243751660002, 'f1-score': 0.25455188042346083, 'support': 519578}, '1': {'precision': 0.32353103220296964, 'recall': 0.5966497715842168, 'f1-score': 0.4195582339249745, 'support': 511786}, '2': {'precision': 0.3729605156440807, 'recall': 0.23291729581987422, 'f1-score': 0.2867540388762799, 'support': 523190}, 'accuracy': 0.34060701654622483, 'macro avg': {'precision': 0.35220873333384, 'recall': 0.3421365016402304, 'f1-score': 0.3202880510749051, 'support': 1554554}, 'weighted avg': {'precision': 0.35240069326891865, 'recall': 0.34060701654622483, 'f1-score': 0.31971255603463683, 'support': 1554554}}
[[102275 319958  97345]
 [ 98897 305357 107532]
 [ 82819 318511 121860]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973071
{'0': {'precision': 0.34518865972270124, 'recall': 0.1703348695989598, 'f1-score': 0.2281085614783616, 'support': 146893}, '1': {'precision': 0.3457137946490256, 'recall': 0.6409937577715432, 'f1-score': 0.4491713553867373, 'support': 160039}, '2': {'precision': 0.36170817372722414, 'recall': 0.21177817264626217, 'f1-score': 0.2671446200857966, 'support': 150261}, 'accuracy': 0.3487083135568567, 'macro avg': {'precision': 0.35087020936631697, 'recall': 0.34103560000558836, 'f1-score': 0.31480817898363184, 'support': 457193}, 'weighted avg': {'precision': 0.35080178320076766, 'recall': 0.3487083135568567, 'f1-score': 0.31832049752443914, 'support': 457193}}
[[ 25021  95914  25958]
 [ 27258 102584  30197]
 [ 20206  98233  31822]]
training model: results/universal/W1/deepVOL_L2/h500
Epoch 1/50
10622/10622 - 330s - loss: 3.2671 - accuracy500: 0.3823 - val_loss: 3.3035 - val_accuracy500: 0.3605 - 330s/epoch - 31ms/step
Epoch 2/50
10622/10622 - 326s - loss: 3.2706 - accuracy500: 0.3792 - val_loss: 3.3030 - val_accuracy500: 0.3694 - 326s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 326s - loss: 3.2674 - accuracy500: 0.3824 - val_loss: 3.3021 - val_accuracy500: 0.3676 - 326s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 327s - loss: 3.2614 - accuracy500: 0.3859 - val_loss: 3.3036 - val_accuracy500: 0.3657 - 327s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 328s - loss: 3.2547 - accuracy500: 0.3893 - val_loss: 3.2992 - val_accuracy500: 0.3642 - 328s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 325s - loss: 3.2528 - accuracy500: 0.3916 - val_loss: 3.2952 - val_accuracy500: 0.3624 - 325s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 326s - loss: 3.2455 - accuracy500: 0.3960 - val_loss: 3.3093 - val_accuracy500: 0.3636 - 326s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 322s - loss: 3.2411 - accuracy500: 0.3985 - val_loss: 3.3097 - val_accuracy500: 0.3564 - 322s/epoch - 30ms/step
Epoch 9/50
10622/10622 - 325s - loss: 3.2379 - accuracy500: 0.4005 - val_loss: 3.3133 - val_accuracy500: 0.3621 - 325s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 324s - loss: 3.2335 - accuracy500: 0.4029 - val_loss: 3.3151 - val_accuracy500: 0.3616 - 324s/epoch - 31ms/step
Epoch 11/50
10622/10622 - 328s - loss: 3.2300 - accuracy500: 0.4055 - val_loss: 3.3180 - val_accuracy500: 0.3630 - 328s/epoch - 31ms/step
Epoch 12/50
10622/10622 - 327s - loss: 3.2276 - accuracy500: 0.4067 - val_loss: 3.3110 - val_accuracy500: 0.3649 - 327s/epoch - 31ms/step
Epoch 13/50
10622/10622 - 329s - loss: 3.2239 - accuracy500: 0.4084 - val_loss: 3.3244 - val_accuracy500: 0.3628 - 329s/epoch - 31ms/step
Epoch 14/50
10622/10622 - 326s - loss: 3.2210 - accuracy500: 0.4104 - val_loss: 3.3200 - val_accuracy500: 0.3632 - 326s/epoch - 31ms/step
Epoch 15/50
10622/10622 - 328s - loss: 3.2181 - accuracy500: 0.4117 - val_loss: 3.3308 - val_accuracy500: 0.3576 - 328s/epoch - 31ms/step
Epoch 16/50
10622/10622 - 327s - loss: 3.2154 - accuracy500: 0.4130 - val_loss: 3.3335 - val_accuracy500: 0.3574 - 327s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 535s - 535s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0879346
{'0': {'precision': 0.37916635636527424, 'recall': 0.6944649807741153, 'f1-score': 0.4905180154018083, 'support': 3350431}, '1': {'precision': 0.22820093935062283, 'recall': 0.015418890641863064, 'f1-score': 0.028886033853042302, 'support': 2319233}, '2': {'precision': 0.37924548858391105, 'recall': 0.3092220376137398, 'f1-score': 0.3406727500523188, 'support': 3377117}, 'accuracy': 0.376575491326694, 'macro avg': {'precision': 0.32887092809993607, 'recall': 0.3397019696765728, 'f1-score': 0.28669226643572315, 'support': 9046781}, 'weighted avg': {'precision': 0.3404943979926403, 'recall': 0.376575491326694, 'f1-score': 0.3162375593540095, 'support': 9046781}}
[[2326757   61865  961809]
 [1535991   35760  747482]
 [2273759   59079 1044279]]
Evaluating performance on  train set...
10622/10622 - 167s - 167s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067369
{'0': {'precision': 0.3461715090294248, 'recall': 0.6678442812505516, 'f1-score': 0.4559863166890967, 'support': 906352}, '1': {'precision': 0.3194173910515452, 'recall': 0.012195338532474653, 'f1-score': 0.023493689291842854, 'support': 900918}, '2': {'precision': 0.35241610336527157, 'recall': 0.3618185689014139, 'f1-score': 0.35705544726012567, 'support': 911244}, 'accuracy': 0.34798202253142707, 'macro avg': {'precision': 0.3393350011487472, 'recall': 0.3472860628948134, 'f1-score': 0.27884515108035507, 'support': 2718514}, 'weighted avg': {'precision': 0.3393983537911509, 'recall': 0.34798202253142707, 'f1-score': 0.27949630999006464, 'support': 2718514}}
[[605302  12247 288803]
 [572883  10987 317048]
 [570376  11163 329705]]
Evaluating performance on  val set...
3064/3064 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981796
{'0': {'precision': 0.3626383096067009, 'recall': 0.6850944058347472, 'f1-score': 0.47424590946030043, 'support': 276413}, '1': {'precision': 0.28832086101067855, 'recall': 0.014643207925865823, 'f1-score': 0.027870911108130843, 'support': 234170}, '2': {'precision': 0.3674921001093369, 'recall': 0.3358699829791907, 'f1-score': 0.35097019977738764, 'support': 273195}, 'accuracy': 0.3630568860059864, 'macro avg': {'precision': 0.3394837569089055, 'recall': 0.34520253224660125, 'f1-score': 0.284362340115273, 'support': 783778}, 'weighted avg': {'precision': 0.34212626966508114, 'recall': 0.3630568860059864, 'f1-score': 0.2979128905812927, 'support': 783778}}
[[189369   4387  82657]
 [155469   3429  75272]
 [177360   4077  91758]]
testing model out of sample: results/universal/W1/deepVOL_L2/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 373s - 373s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1256648
{'0': {'precision': 0.3236690040763582, 'recall': 0.655259619332236, 'f1-score': 0.4333047851072907, 'support': 1858471}, '1': {'precision': 0.3275936432102452, 'recall': 0.00828717573403487, 'f1-score': 0.016165413072226607, 'support': 2382959}, '2': {'precision': 0.3098036580046361, 'recall': 0.37963015794238886, 'f1-score': 0.3411808614518753, 'support': 1857766}, 'accuracy': 0.31853263938394505, 'macro avg': {'precision': 0.32035543509707987, 'recall': 0.3477256510028866, 'f1-score': 0.2635503532104642, 'support': 6099196}, 'weighted avg': {'precision': 0.320979089804964, 'recall': 0.31853263938394505, 'f1-score': 0.2422680133755853, 'support': 6099196}}
[[1217781   21154  619536]
 [1411524   19748  951687]
 [1133122   19380  705264]]
Evaluating performance on  train set...
6711/6711 - 109s - 109s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049203
{'0': {'precision': 0.35558742637029933, 'recall': 0.6541288988454248, 'f1-score': 0.46072348410369196, 'support': 580300}, '1': {'precision': 0.30802299684052414, 'recall': 0.010560241498712599, 'f1-score': 0.020420391548217294, 'support': 563150}, '2': {'precision': 0.3523388218574485, 'recall': 0.38711599991635126, 'f1-score': 0.3689096110172342, 'support': 573828}, 'accuracy': 0.35386000402963297, 'macro avg': {'precision': 0.3386497483560907, 'recall': 0.3506017134201629, 'f1-score': 0.2833511622230478, 'support': 1717278}, 'weighted avg': {'precision': 0.3389040188380925, 'recall': 0.35386000402963297, 'f1-score': 0.2856545332768186, 'support': 1717278}}
[[379591   7094 193615]
 [342489   5947 214714]
 [345424   6266 222138]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1021154
{'0': {'precision': 0.36741390356903453, 'recall': 0.6478255191328196, 'f1-score': 0.46889452378195323, 'support': 153140}, '1': {'precision': 0.28691238137276537, 'recall': 0.009236759460573247, 'f1-score': 0.017897338115134952, 'support': 140742}, '2': {'precision': 0.355028583527419, 'recall': 0.4020524624754232, 'f1-score': 0.37708014752181346, 'support': 145971}, 'accuracy': 0.36193000843463613, 'macro avg': {'precision': 0.33645162282307295, 'recall': 0.3530382470229387, 'f1-score': 0.28795733647296723, 'support': 439853}, 'weighted avg': {'precision': 0.3375451910929528, 'recall': 0.36193000843463613, 'f1-score': 0.29411685437379137, 'support': 439853}}
[[99208  1795 52137]
 [84962  1300 54480]
 [85847  1436 58688]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1200901
{'0': {'precision': 0.3339803303292469, 'recall': 0.8264619230425855, 'f1-score': 0.4757186758070649, 'support': 56005}, '1': {'precision': 0.38102105566772426, 'recall': 0.020574721594891363, 'f1-score': 0.039041257831895014, 'support': 64205}, '2': {'precision': 0.28007382744643894, 'recall': 0.15641295121063908, 'f1-score': 0.20072623524834654, 'support': 49478}, 'accuracy': 0.3261633114893216, 'macro avg': {'precision': 0.33169173781447003, 'recall': 0.33448319861603865, 'f1-score': 0.23849538962910213, 'support': 169688}, 'weighted avg': {'precision': 0.33606099496505715, 'recall': 0.3261633114893216, 'f1-score': 0.23030975122159006, 'support': 169688}}
[[46286  1156  8563]
 [51554  1321 11330]
 [40749   990  7739]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1060008
{'0': {'precision': 0.3327892965806283, 'recall': 0.7529519033508092, 'f1-score': 0.46157285786149466, 'support': 21935}, '1': {'precision': 0.3336457357075914, 'recall': 0.032498060157925966, 'f1-score': 0.059227217901260246, 'support': 21909}, '2': {'precision': 0.3509485094850949, 'recall': 0.22840513250143304, 'f1-score': 0.2767167926493763, 'support': 22679}, 'accuracy': 0.3368459029207943, 'macro avg': {'precision': 0.3391278472577715, 'recall': 0.3379516986700561, 'f1-score': 0.26583895613737707, 'support': 66523}, 'weighted avg': {'precision': 0.33926219338764285, 'recall': 0.3368459029207943, 'f1-score': 0.2660413675673947, 'support': 66523}}
[[16516   745  4674]
 [16291   712  4906]
 [16822   677  5180]]
Evaluating performance on  val set...
51/51 - 1s - 556ms/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1304277
{'0': {'precision': 0.30953092321481923, 'recall': 0.7683559950556242, 'f1-score': 0.4412892233423257, 'support': 4045}, '1': {'precision': 0.35523613963039014, 'recall': 0.03147171184282336, 'f1-score': 0.057820855614973264, 'support': 5497}, '2': {'precision': 0.23803363518758086, 'recall': 0.1670196671709531, 'f1-score': 0.19630156472261734, 'support': 3305}, 'accuracy': 0.2983575932124231, 'macro avg': {'precision': 0.3009335660109301, 'recall': 0.32228245802313354, 'f1-score': 0.23180388122663875, 'support': 12847}, 'weighted avg': {'precision': 0.3106940770800306, 'recall': 0.2983575932124231, 'f1-score': 0.21418485429621437, 'support': 12847}}
[[3108  206  731]
 [4288  173 1036]
 [2645  108  552]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981693
{'0': {'precision': 0.39026286926659115, 'recall': 0.5584062258811423, 'f1-score': 0.4594335728724587, 'support': 155480}, '1': {'precision': 0.34930313588850176, 'recall': 0.012575164833441784, 'f1-score': 0.024276363086004008, 'support': 127553}, '2': {'precision': 0.34999226604795053, 'recall': 0.4919732998978091, 'f1-score': 0.409011620024885, 'support': 137977}, 'accuracy': 0.3712643405144771, 'macro avg': {'precision': 0.36318609040101446, 'recall': 0.35431823020413106, 'f1-score': 0.29757385199444925, 'support': 421010}, 'weighted avg': {'precision': 0.36465551102836924, 'recall': 0.3712643405144771, 'f1-score': 0.3110696922806881, 'support': 421010}}
[[86821  1902 66757]
 [66637  1604 59312]
 [69010  1086 67881]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064246
{'0': {'precision': 0.36837854210136634, 'recall': 0.5657042447629548, 'f1-score': 0.4461987906787146, 'support': 58048}, '1': {'precision': 0.3312710911136108, 'recall': 0.010506974918834065, 'f1-score': 0.020367936925098553, 'support': 56058}, '2': {'precision': 0.34482486381220556, 'recall': 0.49621298189805346, 'f1-score': 0.4068938746991693, 'support': 52812}, 'accuracy': 0.35725925304640604, 'macro avg': {'precision': 0.34815816567572755, 'recall': 0.3574747338599474, 'f1-score': 0.29115353410099415, 'support': 166918}, 'weighted avg': {'precision': 0.3484640550761278, 'recall': 0.35725925304640604, 'f1-score': 0.29075122227727224, 'support': 166918}}
[[32838   675 24535]
 [30212   589 25257]
 [26092   514 26206]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0838876
{'0': {'precision': 0.42015963893184005, 'recall': 0.5581214610858222, 'f1-score': 0.4794125360608445, 'support': 18014}, '1': {'precision': 0.2668918918918919, 'recall': 0.0065718326262374175, 'f1-score': 0.012827798977023627, 'support': 12021}, '2': {'precision': 0.38635848629050534, 'recall': 0.5244540141494924, 'f1-score': 0.4449373695198329, 'support': 16255}, 'accuracy': 0.40306761719593864, 'macro avg': {'precision': 0.3578033390380791, 'recall': 0.3630491026205173, 'f1-score': 0.31239256818590033, 'support': 46290}, 'weighted avg': {'precision': 0.3684882342363958, 'recall': 0.40306761719593864, 'f1-score': 0.34613949746484635, 'support': 46290}}
[[10054   115  7845]
 [ 6247    79  5695]
 [ 7628   102  8525]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.085902
{'0': {'precision': 0.3826182198730001, 'recall': 0.6774624111804656, 'f1-score': 0.4890372566078266, 'support': 127365}, '1': {'precision': 0.23827956989247312, 'recall': 0.013367596848721753, 'f1-score': 0.025315009653060994, 'support': 82887}, '2': {'precision': 0.3756538457913537, 'recall': 0.3163006991342163, 'f1-score': 0.3434317324096573, 'support': 126013}, 'accuracy': 0.37842475428605415, 'macro avg': {'precision': 0.3321838785189423, 'recall': 0.33571023572113456, 'f1-score': 0.2859279995568483, 'support': 336265}, 'weighted avg': {'precision': 0.3444298881938588, 'recall': 0.37842475428605415, 'f1-score': 0.32016825506403357, 'support': 336265}}
[[86285  1778 39302]
 [54836  1108 26943]
 [84391  1764 39858]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071787
{'0': {'precision': 0.3629610841365316, 'recall': 0.6537800500380725, 'f1-score': 0.4667790212722995, 'support': 45965}, '1': {'precision': 0.2632398753894081, 'recall': 0.007661445701203618, 'f1-score': 0.014889539877976254, 'support': 44117}, '2': {'precision': 0.3149179014817781, 'recall': 0.3579524763292061, 'f1-score': 0.3350590140184925, 'support': 43936}, 'accuracy': 0.3441030309361429, 'macro avg': {'precision': 0.3137062870025726, 'recall': 0.33979799068949407, 'f1-score': 0.27224252505625607, 'support': 134018}, 'weighted avg': {'precision': 0.3143838345177036, 'recall': 0.3441030309361429, 'f1-score': 0.2748401885082184, 'support': 134018}}
[[30051   490 15424]
 [24990   338 18789]
 [27753   456 15727]]
Evaluating performance on  val set...
107/107 - 1s - 977ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919224
{'0': {'precision': 0.39931510694436645, 'recall': 0.6758194774346793, 'f1-score': 0.5020114334109675, 'support': 10525}, '1': {'precision': 0.2222222222222222, 'recall': 0.00741962077493817, 'f1-score': 0.014359792580773835, 'support': 7278}, '2': {'precision': 0.33936800526662275, 'recall': 0.330201772178926, 'f1-score': 0.3347221470699637, 'support': 9367}, 'accuracy': 0.3776223776223776, 'macro avg': {'precision': 0.3203017781444038, 'recall': 0.3378136234628479, 'f1-score': 0.28369779102056836, 'support': 27170}, 'weighted avg': {'precision': 0.33121034005356076, 'recall': 0.3776223776223776, 'f1-score': 0.3137108302781618, 'support': 27170}}
[[7113  104 3308]
 [4511   54 2713]
 [6189   85 3093]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1048472
{'0': {'precision': 0.34375675936494415, 'recall': 0.8997569919258608, 'f1-score': 0.4974573822594626, 'support': 114811}, '1': {'precision': 0.32224334600760457, 'recall': 0.003280338290934074, 'f1-score': 0.006494563915896356, 'support': 103343}, '2': {'precision': 0.32532628962088256, 'recall': 0.09057246922231739, 'f1-score': 0.14169604850880102, 'support': 115587}, 'accuracy': 0.34191184181745726, 'macro avg': {'precision': 0.33044213166447706, 'recall': 0.3312032664797041, 'f1-score': 0.21521599822805335, 'support': 333741}, 'weighted avg': {'precision': 0.33071196300221256, 'recall': 0.34191184181745726, 'f1-score': 0.22221713362259485, 'support': 333741}}
[[103302    351  11158]
 [ 92451    339  10553]
 [104756    362  10469]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111447
{'0': {'precision': 0.3277891156462585, 'recall': 0.9000373575742482, 'f1-score': 0.4805604960023936, 'support': 32122}, '1': {'precision': 0.2992125984251969, 'recall': 0.004684273783475608, 'f1-score': 0.009224140546773068, 'support': 32449}, '2': {'precision': 0.3457747955546236, 'recall': 0.09793615441722346, 'f1-score': 0.1526392520769213, 'support': 33675}, 'accuracy': 0.3293874559778515, 'macro avg': {'precision': 0.3242588365420263, 'recall': 0.3342192619249824, 'f1-score': 0.214141296208696, 'support': 98246}, 'weighted avg': {'precision': 0.3245155814932952, 'recall': 0.3293874559778515, 'f1-score': 0.21248707533010452, 'support': 98246}}
[[28911   164  3047]
 [29104   152  3193]
 [30185   192  3298]]
Evaluating performance on  val set...
93/93 - 1s - 783ms/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1193936
{'0': {'precision': 0.3002193819152995, 'recall': 0.8958303685783406, 'f1-score': 0.44972316485086633, 'support': 7027}, '1': {'precision': 0.3983050847457627, 'recall': 0.005591244349274328, 'f1-score': 0.011027686532144532, 'support': 8406}, '2': {'precision': 0.33359809372517873, 'recall': 0.10280259454167176, 'f1-score': 0.15717092337917485, 'support': 8171}, 'accuracy': 0.304270462633452, 'macro avg': {'precision': 0.3440408534620803, 'recall': 0.3347414024897623, 'f1-score': 0.20597392492072855, 'support': 23604}, 'weighted avg': {'precision': 0.34670497216235074, 'recall': 0.304270462633452, 'f1-score': 0.19221941312182184, 'support': 23604}}
[[6295   29  703]
 [7384   47  975]
 [7289   42  840]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102147
{'0': {'precision': 0.3545043216965573, 'recall': 0.7157857114837269, 'f1-score': 0.4741689079839982, 'support': 229429}, '1': {'precision': 0.3105815831987076, 'recall': 0.011020086460149514, 'f1-score': 0.021284938622429916, 'support': 209345}, '2': {'precision': 0.35374288039056145, 'recall': 0.30436951404142853, 'f1-score': 0.32720413567964474, 'support': 228538}, 'accuracy': 0.3537910302826864, 'macro avg': {'precision': 0.3396095950952754, 'recall': 0.34372510399510164, 'f1-score': 0.274219327428691, 'support': 667312}, 'weighted avg': {'precision': 0.3404643764175544, 'recall': 0.3537910302826864, 'f1-score': 0.28176111418006566, 'support': 667312}}
[[164222   2692  62515]
 [142473   2307  64565]
 [156549   2429  69560]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1069719
{'0': {'precision': 0.3501838694111187, 'recall': 0.6739575994363671, 'f1-score': 0.46089156072402343, 'support': 62452}, '1': {'precision': 0.3114228456913828, 'recall': 0.012844461342634684, 'f1-score': 0.024671365974471327, 'support': 60493}, '2': {'precision': 0.32875740026778083, 'recall': 0.3301206770875516, 'f1-score': 0.3294376283077122, 'support': 61735}, 'accuracy': 0.34246805284816983, 'macro avg': {'precision': 0.3301213717900941, 'recall': 0.33897424595551784, 'f1-score': 0.27166685166873566, 'support': 184680}, 'weighted avg': {'precision': 0.330325012575284, 'recall': 0.34246805284816983, 'f1-score': 0.2740625767587558, 'support': 184680}}
[[42090   928 19434]
 [37539   777 22177]
 [40565   790 20380]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103206
{'0': {'precision': 0.3505460022593197, 'recall': 0.7074319874360403, 'f1-score': 0.46879511196159396, 'support': 19739}, '1': {'precision': 0.2920203735144312, 'recall': 0.009430341575744284, 'f1-score': 0.018270660718079455, 'support': 18239}, '2': {'precision': 0.353879212847772, 'recall': 0.31087928464977643, 'f1-score': 0.3309885227693447, 'support': 20130}, 'accuracy': 0.35096716459007365, 'macro avg': {'precision': 0.33214852954050766, 'recall': 0.34258053788718695, 'f1-score': 0.2726847651496727, 'support': 58108}, 'weighted avg': {'precision': 0.3333306203233991, 'recall': 0.35096716459007365, 'f1-score': 0.2796445284503659, 'support': 58108}}
[[13964   229  5546]
 [12187   172  5880]
 [13684   188  6258]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/EXC
Evaluating performance on  test set...
5343/5343 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010516
{'0': {'precision': 0.36732505811136745, 'recall': 0.4540574314536877, 'f1-score': 0.406112072057787, 'support': 462534}, '1': {'precision': 0.3387859676783603, 'recall': 0.003920745739980886, 'f1-score': 0.007751780677367639, 'support': 438437}, '2': {'precision': 0.3609564483013219, 'recall': 0.6115980960459965, 'f1-score': 0.4539802478323021, 'support': 466818}, 'accuracy': 0.36353633491715465, 'macro avg': {'precision': 0.3556891580303499, 'recall': 0.3565254244132217, 'f1-score': 0.2892813668558189, 'support': 1367789}, 'weighted avg': {'precision': 0.3560034471856456, 'recall': 0.36353633491715465, 'f1-score': 0.2947570567789324, 'support': 1367789}}
[[210017   1720 250797]
 [182052   1719 254666]
 [179678   1635 285505]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101988
{'0': {'precision': 0.36233898556689903, 'recall': 0.494061036535436, 'f1-score': 0.4180699910467515, 'support': 108689}, '1': {'precision': 0.38748495788206977, 'recall': 0.005973471848622577, 'f1-score': 0.011765565624086526, 'support': 107810}, '2': {'precision': 0.3732156127643999, 'recall': 0.5919878956350393, 'f1-score': 0.45780837573811534, 'support': 113678}, 'accuracy': 0.3684054310263889, 'macro avg': {'precision': 0.3743465187377896, 'recall': 0.3640074680063659, 'f1-score': 0.29588131080298447, 'support': 330177}, 'weighted avg': {'precision': 0.3742944533973538, 'recall': 0.3684054310263889, 'f1-score': 0.29908441661281865, 'support': 330177}}
[[53699   547 54443]
 [48591   644 58575]
 [45911   471 67296]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064048
{'0': {'precision': 0.36441743024929735, 'recall': 0.5199530516431925, 'f1-score': 0.42850809431047227, 'support': 30672}, '1': {'precision': 0.37627811860940696, 'recall': 0.0057991112231712315, 'f1-score': 0.011422186355453473, 'support': 31729}, '2': {'precision': 0.36287866315442874, 'recall': 0.5792136123246724, 'f1-score': 0.4462073764787753, 'support': 30443}, 'accuracy': 0.3636745508595063, 'macro avg': {'precision': 0.36785807067104437, 'recall': 0.3683219250636787, 'f1-score': 0.29537921904823367, 'support': 92844}, 'weighted avg': {'precision': 0.3679662120155809, 'recall': 0.3636745508595063, 'f1-score': 0.29177443864661523, 'support': 92844}}
[[15948   154 14570]
 [15156   184 16389]
 [12659   151 17633]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/AAL
Evaluating performance on  test set...
7177/7177 - 73s - 73s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0925504
{'0': {'precision': 0.38202017583185244, 'recall': 0.6329032556349823, 'f1-score': 0.4764533077195561, 'support': 670499}, '1': {'precision': 0.3230297424913596, 'recall': 0.012524086596622875, 'f1-score': 0.024113284472076776, 'support': 529859}, '2': {'precision': 0.37277529643820706, 'recall': 0.4131603455776458, 'f1-score': 0.3919302346542832, 'support': 636731}, 'accuracy': 0.37780913172960046, 'macro avg': {'precision': 0.3592750715871397, 'recall': 0.3528625626030837, 'f1-score': 0.297498942281972, 'support': 1837089}, 'weighted avg': {'precision': 0.3618017142763396, 'recall': 0.37780913172960046, 'f1-score': 0.3166924615037166, 'support': 1837089}}
[[424361   7602 238536]
 [319119   6636 204104]
 [367354   6305 263072]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015142
{'0': {'precision': 0.36620023736611523, 'recall': 0.6305230812700879, 'f1-score': 0.463313534877168, 'support': 198191}, '1': {'precision': 0.30858113848768054, 'recall': 0.009724490615545263, 'f1-score': 0.018854799356278876, 'support': 186745}, '2': {'precision': 0.3616871704745167, 'recall': 0.4326693971625683, 'f1-score': 0.39400686388518597, 'support': 192639}, 'accuracy': 0.36381249188417086, 'macro avg': {'precision': 0.34548951544277084, 'recall': 0.35763898968273383, 'f1-score': 0.2920583993728776, 'support': 577575}, 'weighted avg': {'precision': 0.3460652396377095, 'recall': 0.36381249188417086, 'f1-score': 0.2964925776714841, 'support': 577575}}
[[124964   2185  71042]
 [108875   1816  76054]
 [107406   1884  83349]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917075
{'0': {'precision': 0.3900810927924396, 'recall': 0.6338155666940473, 'f1-score': 0.48293832506274786, 'support': 59653}, '1': {'precision': 0.26258205689277897, 'recall': 0.010250715414513304, 'f1-score': 0.01973116290541374, 'support': 46826}, '2': {'precision': 0.38148480812711, 'recall': 0.43332336540660343, 'f1-score': 0.40575508758637163, 'support': 56849}, 'accuracy': 0.3852554369122257, 'macro avg': {'precision': 0.34471598593744285, 'recall': 0.3591298825050546, 'f1-score': 0.3028081918515111, 'support': 163328}, 'weighted avg': {'precision': 0.3505351481780634, 'recall': 0.3852554369122257, 'f1-score': 0.3232723250965826, 'support': 163328}}
[[37809   816 21028]
 [27434   480 18912]
 [31683   532 24634]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/WBA
Evaluating performance on  test set...
5696/5696 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0803512
{'0': {'precision': 0.39326550190604187, 'recall': 0.6404925323716544, 'f1-score': 0.48731639098932017, 'support': 558745}, '1': {'precision': 0.22325654780687915, 'recall': 0.008297392624995969, 'f1-score': 0.016000135690196666, 'support': 341071}, '2': {'precision': 0.3989655307678945, 'recall': 0.3826261895207521, 'f1-score': 0.39062507144130837, 'support': 558208}, 'accuracy': 0.39388034764859836, 'macro avg': {'precision': 0.33849586016027183, 'recall': 0.34380537150580076, 'f1-score': 0.29798053270694175, 'support': 1458024}, 'weighted avg': {'precision': 0.35567810809589984, 'recall': 0.39388034764859836, 'f1-score': 0.3400443470357337, 'support': 1458024}}
[[357872   5153 195720]
 [212199   2830 126042]
 [339930   4693 213585]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1057084
{'0': {'precision': 0.3556070477851691, 'recall': 0.6503703549256423, 'f1-score': 0.45980412931518966, 'support': 191843}, '1': {'precision': 0.36094771241830065, 'recall': 0.011562902398425477, 'f1-score': 0.02240796908126312, 'support': 191042}, '2': {'precision': 0.34211409158133976, 'recall': 0.3898263107454747, 'f1-score': 0.364415118365457, 'support': 185734}, 'accuracy': 0.3506425216181661, 'macro avg': {'precision': 0.3528896172616032, 'recall': 0.3505865226898475, 'f1-score': 0.2822090722539699, 'support': 568619}, 'weighted avg': {'precision': 0.352994033667246, 'recall': 0.3506425216181661, 'f1-score': 0.28169186116525546, 'support': 568619}}
[[124769   2101  64973]
 [114573   2209  74260]
 [111520   1810  72404]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0808017
{'0': {'precision': 0.40412936232413665, 'recall': 0.6889055005294961, 'f1-score': 0.5094200561978902, 'support': 64212}, '1': {'precision': 0.2734946539110861, 'recall': 0.012210134914453684, 'f1-score': 0.023376623376623377, 'support': 39803}, '2': {'precision': 0.3887854020148261, 'recall': 0.34185720016044924, 'f1-score': 0.3638142331157396, 'support': 59832}, 'accuracy': 0.3977857391346805, 'macro avg': {'precision': 0.3554698060833496, 'recall': 0.347657611868133, 'f1-score': 0.2988703042300844, 'support': 163847}, 'weighted avg': {'precision': 0.36679139988239945, 'recall': 0.3977857391346805, 'f1-score': 0.3381756979659048, 'support': 163847}}
[[44236   666 19310]
 [26471   486 12846]
 [38753   625 20454]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 102s - 102s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.155077
{'0': {'precision': 0.2722472959814732, 'recall': 0.6405873269579823, 'f1-score': 0.38210243832058866, 'support': 775173}, '1': {'precision': 0.3471220003356268, 'recall': 0.005528298621667002, 'f1-score': 0.010883269242531565, 'support': 1496663}, '2': {'precision': 0.26234636043234216, 'recall': 0.398511149244926, 'f1-score': 0.31640088238438135, 'support': 817006}, 'accuracy': 0.26884703069953075, 'macro avg': {'precision': 0.29390521891648075, 'recall': 0.34820892494152506, 'f1-score': 0.2364621966491672, 'support': 3088842}, 'weighted avg': {'precision': 0.3059081552593344, 'recall': 0.26884703069953075, 'f1-score': 0.18485422664155518, 'support': 3088842}}
[[496566   8031 270576]
 [843497   8274 644892]
 [483889   7531 325586]]
Evaluating performance on  train set...
2948/2948 - 21s - 21s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1062372
{'0': {'precision': 0.3508546801096658, 'recall': 0.6603033877906076, 'f1-score': 0.45822812723964934, 'support': 251757}, '1': {'precision': 0.2986869384934347, 'recall': 0.008647943462218772, 'f1-score': 0.016809206560335407, 'support': 249886}, '2': {'precision': 0.3567458053568555, 'recall': 0.385818643484589, 'f1-score': 0.3707130954258451, 'support': 252839}, 'accuracy': 0.35248952261286554, 'macro avg': {'precision': 0.3354291413199853, 'recall': 0.35158999157913845, 'f1-score': 0.2819168097419433, 'support': 754482}, 'weighted avg': {'precision': 0.33555082651854057, 'recall': 0.35248952261286554, 'f1-score': 0.2827015785060261, 'support': 754482}}
[[166236   2830  82691]
 [154522   2161  93203]
 [153045   2244  97550]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1111711
{'0': {'precision': 0.35465204523032556, 'recall': 0.6317550441042279, 'f1-score': 0.4542814440380573, 'support': 59178}, '1': {'precision': 0.30845771144278605, 'recall': 0.006899621633652348, 'f1-score': 0.013497333188200717, 'support': 62902}, '2': {'precision': 0.33918716906268775, 'recall': 0.4310724431818182, 'f1-score': 0.37964924900505875, 'support': 56320}, 'accuracy': 0.34808295964125563, 'macro avg': {'precision': 0.3340989752452665, 'recall': 0.3565757029732328, 'f1-score': 0.28247600874377227, 'support': 178400}, 'weighted avg': {'precision': 0.33348221445865983, 'recall': 0.34808295964125563, 'f1-score': 0.2753044969251865, 'support': 178400}}
[[37386   542 21250]
 [36419   434 26049]
 [31611   431 24278]]
testing model on single stock: results/universal/W1/deepVOL_L2/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 185s - 185s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0848432
{'0': {'precision': 0.3798773603058368, 'recall': 0.7623180972392016, 'f1-score': 0.5070715079098925, 'support': 2058861}, '1': {'precision': 0.219469531467009, 'recall': 0.022335996528194287, 'f1-score': 0.04054556348264116, 'support': 1308829}, '2': {'precision': 0.38909721083503485, 'recall': 0.22275672412125266, 'f1-score': 0.2833160501174875, 'support': 2098527}, 'accuracy': 0.3779948728709453, 'macro avg': {'precision': 0.32948136753596025, 'recall': 0.33580360596288283, 'f1-score': 0.2769777071700071, 'support': 5466217}, 'weighted avg': {'precision': 0.3450089471162749, 'recall': 0.3779948728709453, 'f1-score': 0.30946509109667464, 'support': 5466217}}
[[1569507   52793  436561]
 [ 982218   29234  297377]
 [1579890   51176  467461]]
Evaluating performance on  train set...
6073/6073 - 59s - 59s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1079376
{'0': {'precision': 0.34065163478273863, 'recall': 0.7075089692620964, 'f1-score': 0.45988007195178676, 'support': 515650}, '1': {'precision': 0.2988925348646431, 'recall': 0.014189216818320777, 'f1-score': 0.027092291133381293, 'support': 513559}, '2': {'precision': 0.35042225058034954, 'recall': 0.30630538027391524, 'f1-score': 0.32688200001828244, 'support': 525345}, 'accuracy': 0.34288291046821145, 'macro avg': {'precision': 0.32998880674257713, 'recall': 0.3426678554514441, 'f1-score': 0.27128478770115017, 'support': 1554554}, 'weighted avg': {'precision': 0.33015806721375013, 'recall': 0.34288291046821145, 'f1-score': 0.2719599790960697, 'support': 1554554}}
[[364827   8838 141985]
 [349967   7287 156305]
 [356174   8255 160916]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.103154
{'0': {'precision': 0.3473190744893182, 'recall': 0.7205792137416287, 'f1-score': 0.4687167464751264, 'support': 156488}, '1': {'precision': 0.2827488255216869, 'recall': 0.018198310960474223, 'f1-score': 0.03419571364393118, 'support': 142211}, '2': {'precision': 0.35801938788743354, 'recall': 0.2786919378651558, 'f1-score': 0.31341398517046865, 'support': 158494}, 'accuracy': 0.34891391600483823, 'macro avg': {'precision': 0.3293624292994795, 'recall': 0.33915648752241956, 'f1-score': 0.27210881509650875, 'support': 457193}, 'weighted avg': {'precision': 0.3309437927063187, 'recall': 0.34891391600483823, 'f1-score': 0.2797194817528373, 'support': 457193}}
[[112762   3390  40336]
 [100754   2588  38869]
 [111148   3175  44171]]
training model: results/universal/W1/deepVOL_L2/h1000
Epoch 1/50
10622/10622 - 337s - loss: 3.2801 - accuracy1000: 0.3721 - val_loss: 3.3004 - val_accuracy1000: 0.3465 - 337s/epoch - 32ms/step
Epoch 2/50
10622/10622 - 332s - loss: 3.2822 - accuracy1000: 0.3677 - val_loss: 3.3001 - val_accuracy1000: 0.3460 - 332s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 338s - loss: 3.2770 - accuracy1000: 0.3745 - val_loss: 3.3013 - val_accuracy1000: 0.3393 - 338s/epoch - 32ms/step
Epoch 4/50
10622/10622 - 332s - loss: 3.2733 - accuracy1000: 0.3783 - val_loss: 3.3085 - val_accuracy1000: 0.3369 - 332s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 327s - loss: 3.2621 - accuracy1000: 0.3876 - val_loss: 3.3128 - val_accuracy1000: 0.3313 - 327s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 327s - loss: 3.2551 - accuracy1000: 0.3914 - val_loss: 3.3163 - val_accuracy1000: 0.3303 - 327s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 326s - loss: 3.2495 - accuracy1000: 0.3939 - val_loss: 3.3231 - val_accuracy1000: 0.3296 - 326s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 326s - loss: 3.2446 - accuracy1000: 0.3972 - val_loss: 3.3212 - val_accuracy1000: 0.3293 - 326s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 326s - loss: 3.2390 - accuracy1000: 0.4002 - val_loss: 3.3159 - val_accuracy1000: 0.3321 - 326s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 325s - loss: 3.2347 - accuracy1000: 0.4027 - val_loss: 3.3164 - val_accuracy1000: 0.3262 - 325s/epoch - 31ms/step
Epoch 11/50
10622/10622 - 326s - loss: 3.2331 - accuracy1000: 0.4042 - val_loss: 3.3195 - val_accuracy1000: 0.3256 - 326s/epoch - 31ms/step
Epoch 12/50
10622/10622 - 325s - loss: 3.2296 - accuracy1000: 0.4061 - val_loss: 3.3243 - val_accuracy1000: 0.3249 - 325s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 546s - 546s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013018
{'0': {'precision': 0.35264565761490396, 'recall': 0.9828215697135497, 'f1-score': 0.5190509383941696, 'support': 3190047}, '1': {'precision': 0.2982148927845235, 'recall': 0.017655969864997834, 'f1-score': 0.033338137719522806, 'support': 2633217}, '2': {'precision': 0.3813559322033898, 'recall': 2.7919815530676588e-05, 'f1-score': 5.583554323175504e-05, 'support': 3223517}, 'accuracy': 0.3517084142967537, 'macro avg': {'precision': 0.3440721608676058, 'recall': 0.333501819798026, 'f1-score': 0.18414830388564138, 'support': 9046781}, 'weighted avg': {'precision': 0.3470326161293515, 'recall': 0.3517084142967537, 'f1-score': 0.1927496008453953, 'support': 9046781}}
[[3135247   54710      90]
 [2586669   46492      56]
 [3168728   54699      90]]
Evaluating performance on  train set...
10622/10622 - 168s - 168s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012888
{'0': {'precision': 0.3309313354581536, 'recall': 0.9826582783680394, 'f1-score': 0.4951202612087233, 'support': 899507}, '1': {'precision': 0.33655730450723814, 'recall': 0.01763199989402254, 'f1-score': 0.03350851244610882, 'support': 905853}, '2': {'precision': 0.3023255813953488, 'recall': 2.847274391833141e-05, 'f1-score': 5.694012526827559e-05, 'support': 913154}, 'accuracy': 0.3310286428541475, 'macro avg': {'precision': 0.3232714071202469, 'recall': 0.3334395836686601, 'f1-score': 0.17622857126003347, 'support': 2718514}, 'weighted avg': {'precision': 0.3231972727296019, 'recall': 0.3310286428541475, 'f1-score': 0.17501102529803755, 'support': 2718514}}
[[883908  15571     28]
 [889849  15972     32]
 [897214  15914     26]]
Evaluating performance on  val set...
3064/3064 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100403
{'0': {'precision': 0.34658863206982515, 'recall': 0.9804044255669981, 'f1-score': 0.5121308310950721, 'support': 271694}, '1': {'precision': 0.30673070596749785, 'recall': 0.018999955169560948, 'f1-score': 0.035783365570599614, 'support': 245369}, '2': {'precision': 0.41935483870967744, 'recall': 4.874116566372345e-05, 'f1-score': 9.74710023767929e-05, 'support': 266715}, 'accuracy': 0.34581858638543056, 'macro avg': {'precision': 0.35755805891566683, 'recall': 0.33315104063407425, 'f1-score': 0.18267055588934947, 'support': 783778}, 'weighted avg': {'precision': 0.3588726453161095, 'recall': 0.34581858638543056, 'f1-score': 0.18876390971504164, 'support': 783778}}
[[266370   5313     11]
 [240700   4662      7]
 [261478   5224     13]]
testing model out of sample: results/universal/W1/deepVOL_L2/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 371s - 371s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014261
{'0': {'precision': 0.3467631751893763, 'recall': 0.9856773750740948, 'f1-score': 0.5130384484702714, 'support': 2115534}, '1': {'precision': 0.29786563663309723, 'recall': 0.013813328224701858, 'f1-score': 0.026402268164295032, 'support': 1847853}, '2': {'precision': 0.3924050632911392, 'recall': 1.4514406484849534e-05, 'f1-score': 2.902773928220955e-05, 'support': 2135809}, 'accuracy': 0.34607676159283945, 'macro avg': {'precision': 0.34567795837120424, 'recall': 0.3331684059017605, 'f1-score': 0.17982324812461623, 'support': 6099196}, 'weighted avg': {'precision': 0.3479316721635517, 'recall': 0.34607676159283945, 'f1-score': 0.18595890166295895, 'support': 6099196}}
[[2085234   30276      24]
 [1822304   25525      24]
 [2105886   29892      31]]
Evaluating performance on  train set...
6711/6711 - 109s - 109s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005815
{'0': {'precision': 0.3385214329404374, 'recall': 0.9861902067255017, 'f1-score': 0.5040289704357565, 'support': 581399}, '1': {'precision': 0.3393441925743206, 'recall': 0.014171586493034094, 'f1-score': 0.027206964219040102, 'support': 563028}, '2': {'precision': 0.4117647058823529, 'recall': 1.22195824044996e-05, 'f1-score': 2.4438439570721353e-05, 'support': 572851}, 'accuracy': 0.33853342324306257, 'macro avg': {'precision': 0.36321011046570356, 'recall': 0.33345800426698013, 'f1-score': 0.17708679103145575, 'support': 1717278}, 'weighted avg': {'precision': 0.3632237344077568, 'recall': 0.33853342324306257, 'f1-score': 0.1795715205209888, 'support': 1717278}}
[[573370   8023      6]
 [555045   7979      4]
 [565333   7511      7]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099339
{'0': {'precision': 0.3633831052122218, 'recall': 0.9871057391979269, 'f1-score': 0.5312114204678471, 'support': 159761}, '1': {'precision': 0.2960817717206133, 'recall': 0.013380140730133801, 'f1-score': 0.025603252703220294, 'support': 129894}, '2': {'precision': 0.6666666666666666, 'recall': 1.3315756534707519e-05, 'f1-score': 2.663098115192309e-05, 'support': 150198}, 'accuracy': 0.36248701270651784, 'macro avg': {'precision': 0.4420438478665005, 'recall': 0.33349973189486515, 'f1-score': 0.18561376805073979, 'support': 439853}, 'weighted avg': {'precision': 0.4470713941423319, 'recall': 0.36248701270651784, 'f1-score': 0.20051375475921018, 'support': 439853}}
[[157701   2059      1]
 [128156   1738      0]
 [148123   2073      2]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.096955
{'0': {'precision': 0.335735291485973, 'recall': 0.9888783470377398, 'f1-score': 0.5012802985433542, 'support': 56916}, '1': {'precision': 0.4054714215925745, 'recall': 0.012886998105766543, 'f1-score': 0.02498006109581208, 'support': 64406}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 48366}, 'accuracy': 0.3365765404742822, 'macro avg': {'precision': 0.2470689043595158, 'recall': 0.3339217817145021, 'f1-score': 0.1754201198797221, 'support': 169688}, 'weighted avg': {'precision': 0.26650972507959897, 'recall': 0.3365765404742822, 'f1-score': 0.17761854277751177, 'support': 169688}}
[[56283   633     0]
 [63576   830     0]
 [47782   584     0]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036166
{'0': {'precision': 0.320865453329076, 'recall': 0.9891258495430044, 'f1-score': 0.4845472079353417, 'support': 21335}, '1': {'precision': 0.33067729083665337, 'recall': 0.011238490702292832, 'f1-score': 0.02173818150072024, 'support': 22156}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 23032}, 'accuracy': 0.32097169400057124, 'macro avg': {'precision': 0.21718091472190978, 'recall': 0.33345478008176577, 'f1-score': 0.1687617964786873, 'support': 66523}, 'weighted avg': {'precision': 0.2130413616726956, 'recall': 0.32097169400057124, 'f1-score': 0.16264218136028852, 'support': 66523}}
[[21103   232     0]
 [21906   249     1]
 [22760   272     0]]
Evaluating performance on  val set...
51/51 - 1s - 568ms/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0946192
{'0': {'precision': 0.3305317728379546, 'recall': 0.9922188163169063, 'f1-score': 0.4958755597454631, 'support': 4241}, '1': {'precision': 0.45689655172413796, 'recall': 0.010060744115413819, 'f1-score': 0.019687964338781578, 'support': 5268}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 3338}, 'accuracy': 0.3316727640694326, 'macro avg': {'precision': 0.26247610818736417, 'recall': 0.33409318681077343, 'f1-score': 0.17185450802808155, 'support': 12847}, 'weighted avg': {'precision': 0.29646736849758887, 'recall': 0.3316727640694326, 'f1-score': 0.17176963065441042, 'support': 12847}}
[[4208   33    0]
 [5215   53    0]
 [3308   30    0]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979209
{'0': {'precision': 0.41730234512820263, 'recall': 0.9731625460823585, 'f1-score': 0.5841255183617631, 'support': 175501}, '1': {'precision': 0.2204039887496804, 'recall': 0.030315819089822043, 'f1-score': 0.05330035554181481, 'support': 85302}, '2': {'precision': 0.3333333333333333, 'recall': 6.241924510164974e-06, 'f1-score': 1.248361525497784e-05, 'support': 160207}, 'accuracy': 0.41181444621267904, 'macro avg': {'precision': 0.3236798890704054, 'recall': 0.33449486903223025, 'f1-score': 0.21247945250627762, 'support': 421010}, 'weighted avg': {'precision': 0.34545548384599717, 'recall': 0.41181444621267904, 'f1-score': 0.25430094175669177, 'support': 421010}}
[[170791   4709      1]
 [ 82715   2586      1]
 [155768   4438      1]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0975468
{'0': {'precision': 0.35839288452691304, 'recall': 0.9771708589777897, 'f1-score': 0.5244393381115444, 'support': 59792}, '1': {'precision': 0.3327338129496403, 'recall': 0.024163152591708027, 'f1-score': 0.04505444803952267, 'support': 53594}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 53532}, 'accuracy': 0.3577924489869277, 'macro avg': {'precision': 0.23037556582551777, 'recall': 0.33377800385649925, 'f1-score': 0.1898312620503557, 'support': 166918}, 'weighted avg': {'precision': 0.23521467620541947, 'recall': 0.3577924489869277, 'f1-score': 0.20232644168151812, 'support': 166918}}
[[58427  1365     0]
 [52298  1295     1]
 [52300  1232     0]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0970931
{'0': {'precision': 0.4310314337503868, 'recall': 0.9779817434045541, 'f1-score': 0.5983490855529643, 'support': 19938}, '1': {'precision': 0.18631178707224336, 'recall': 0.02179715302491103, 'f1-score': 0.039028275587415374, 'support': 8992}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 17360}, 'accuracy': 0.4254698639014906, 'macro avg': {'precision': 0.20578107360754339, 'recall': 0.33325963214315507, 'f1-score': 0.21245912038012657, 'support': 46290}, 'weighted avg': {'precision': 0.22184532977897656, 'recall': 0.4254698639014906, 'f1-score': 0.2653019296141076, 'support': 46290}}
[[19499   439     0]
 [ 8796   196     0]
 [16943   417     0]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011276
{'0': {'precision': 0.3544609408354831, 'recall': 0.9900235973832937, 'f1-score': 0.5220211699016337, 'support': 119081}, '1': {'precision': 0.3034934497816594, 'recall': 0.011226539863302742, 'f1-score': 0.02165214428272404, 'support': 99051}, '2': {'precision': 0.3333333333333333, 'recall': 8.465035172221141e-06, 'f1-score': 1.69296404144376e-05, 'support': 118133}, 'accuracy': 0.3539054019895023, 'macro avg': {'precision': 0.3304292413168253, 'recall': 0.33375286742725624, 'f1-score': 0.18123008127492404, 'support': 336265}, 'weighted avg': {'precision': 0.3320255145692236, 'recall': 0.3539054019895023, 'f1-score': 0.19124639622207373, 'support': 336265}}
[[117893   1186      2]
 [ 97939   1112      0]
 [116766   1366      1]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988624
{'0': {'precision': 0.3467213611962027, 'recall': 0.9833340501483807, 'f1-score': 0.5126747614723128, 'support': 46502}, '1': {'precision': 0.35660731021555764, 'recall': 0.017153934585127244, 'f1-score': 0.03273329462115835, 'support': 44363}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 43153}, 'accuracy': 0.3468787774776523, 'macro avg': {'precision': 0.23444289047058678, 'recall': 0.3334959949111693, 'f1-score': 0.1818026853644904, 'support': 134018}, 'weighted avg': {'precision': 0.23835161576384217, 'recall': 0.3468787774776523, 'f1-score': 0.18872501385831708, 'support': 134018}}
[[45727   775     0]
 [43602   761     0]
 [42555   598     0]]
Evaluating performance on  val set...
107/107 - 1s - 996ms/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0941727
{'0': {'precision': 0.3879579982126899, 'recall': 0.989552664070662, 'f1-score': 0.5573893272702956, 'support': 10529}, '1': {'precision': 0.33121019108280253, 'recall': 0.013221459445715738, 'f1-score': 0.0254278728606357, 'support': 7866}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8775}, 'accuracy': 0.3873021715126978, 'macro avg': {'precision': 0.23972272976516415, 'recall': 0.33425804117212593, 'f1-score': 0.19427240004364377, 'support': 27170}, 'weighted avg': {'precision': 0.2462314731777231, 'recall': 0.3873021715126978, 'f1-score': 0.2233628220371992, 'support': 27170}}
[[10419   110     0]
 [ 7762   104     0]
 [ 8675   100     0]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046793
{'0': {'precision': 0.3398033940334151, 'recall': 0.9810267758743817, 'f1-score': 0.5047677372527672, 'support': 113423}, '1': {'precision': 0.29469829644960993, 'recall': 0.018073347914388378, 'f1-score': 0.034057977681076754, 'support': 102416}, '2': {'precision': 0.3333333333333333, 'recall': 8.481620328747603e-06, 'f1-score': 1.696280904117722e-05, 'support': 117902}, 'accuracy': 0.33895445869701357, 'macro avg': {'precision': 0.32261167460545276, 'recall': 0.33303620180303295, 'f1-score': 0.17961422591429507, 'support': 333741}, 'weighted avg': {'precision': 0.32367616731927434, 'recall': 0.33895445869701357, 'f1-score': 0.18200446709789134, 'support': 333741}}
[[111271   2151      1]
 [100564   1851      1]
 [115622   2279      1]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.104771
{'0': {'precision': 0.3281092798688974, 'recall': 0.9811730405384448, 'f1-score': 0.491768619708676, 'support': 32241}, '1': {'precision': 0.3080283997815401, 'recall': 0.017363997413872727, 'f1-score': 0.032874795989741204, 'support': 32481}, '2': {'precision': 1.0, 'recall': 5.965875193890944e-05, 'f1-score': 0.00011931038596909862, 'support': 33524}, 'accuracy': 0.32774871241577264, 'macro avg': {'precision': 0.5453792265501458, 'recall': 0.3328655655680855, 'f1-score': 0.17492090869479546, 'support': 98246}, 'weighted avg': {'precision': 0.550736332731687, 'recall': 0.32774871241577264, 'f1-score': 0.1722911678638259, 'support': 98246}}
[[31634   607     0]
 [31917   564     0]
 [32862   660     2]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1115136
{'0': {'precision': 0.2763617544313624, 'recall': 0.9817680404473724, 'f1-score': 0.4313118395369186, 'support': 6527}, '1': {'precision': 0.33093525179856115, 'recall': 0.015427613191727222, 'f1-score': 0.02948088015381329, 'support': 8945}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8132}, 'accuracy': 0.2773258769700051, 'macro avg': {'precision': 0.20243233540997452, 'recall': 0.33239855121303324, 'f1-score': 0.15359757323024395, 'support': 23604}, 'weighted avg': {'precision': 0.2018314268137448, 'recall': 0.2773258769700051, 'f1-score': 0.13043885992345905, 'support': 23604}}
[[6408  119    0]
 [8807  138    0]
 [7972  160    0]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 22s - 22s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1008775
{'0': {'precision': 0.35256863930308213, 'recall': 0.9863778510486421, 'f1-score': 0.5194619789347434, 'support': 235352}, '1': {'precision': 0.33923337091319056, 'recall': 0.015075150300601203, 'f1-score': 0.028867462944308534, 'support': 199600}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 232360}, 'accuracy': 0.3523913851391853, 'macro avg': {'precision': 0.23060067007209092, 'recall': 0.3338176671164144, 'f1-score': 0.18277648062635066, 'support': 667312}, 'weighted avg': {'precision': 0.225814484426373, 'recall': 0.3523913851391853, 'f1-score': 0.191841839004744, 'support': 667312}}
[[232146   3206      0]
 [196591   3009      0]
 [229705   2655      0]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005077
{'0': {'precision': 0.34094114418987514, 'recall': 0.9873655102267851, 'f1-score': 0.506861161420856, 'support': 62923}, '1': {'precision': 0.3691931540342298, 'recall': 0.015096477488585997, 'f1-score': 0.02900685150797208, 'support': 60014}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61743}, 'accuracy': 0.3413147065193849, 'macro avg': {'precision': 0.23671143274136833, 'recall': 0.3341539959051237, 'f1-score': 0.17862267097627604, 'support': 184680}, 'weighted avg': {'precision': 0.23613708881345996, 'recall': 0.3413147065193849, 'f1-score': 0.18212065219018822, 'support': 184680}}
[[62128   795     0]
 [59107   906     1]
 [60990   753     0]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015891
{'0': {'precision': 0.3373785562558763, 'recall': 0.9889756545705098, 'f1-score': 0.5031222817972919, 'support': 19593}, '1': {'precision': 0.3427299703264095, 'recall': 0.012337107455671865, 'f1-score': 0.02381688833900402, 'support': 18724}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19791}, 'accuracy': 0.33744062779651685, 'macro avg': {'precision': 0.22670284219409528, 'recall': 0.3337709206753939, 'f1-score': 0.17564639004543195, 'support': 58108}, 'weighted avg': {'precision': 0.2241951885646224, 'recall': 0.33744062779651685, 'f1-score': 0.17731848083764457, 'support': 58108}}
[[19377   216     0]
 [18493   231     0]
 [19564   227     0]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099745
{'0': {'precision': 0.25643349457529074, 'recall': 0.9826806498890809, 'f1-score': 0.40672965316121507, 'support': 350706}, '1': {'precision': 0.4877424229703635, 'recall': 0.017454017773985565, 'f1-score': 0.033701998799154184, 'support': 665692}, '2': {'precision': 0.25, 'recall': 1.7074996229271667e-05, 'f1-score': 3.4147660173868504e-05, 'support': 351391}, 'accuracy': 0.26046195721708537, 'macro avg': {'precision': 0.33139197251521807, 'recall': 0.33338391421976526, 'f1-score': 0.1468219332068477, 'support': 1367789}, 'weighted avg': {'precision': 0.36735691263821335, 'recall': 0.26046195721708537, 'f1-score': 0.12069820703823453, 'support': 1367789}}
[[344632   6066      8]
 [654063  11619     10]
 [345248   6137      6]]
Evaluating performance on  train set...
1290/1290 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027862
{'0': {'precision': 0.32189572287573615, 'recall': 0.9802762269693175, 'f1-score': 0.4846467852970336, 'support': 106217}, '1': {'precision': 0.3539585507678545, 'recall': 0.021682147391109772, 'f1-score': 0.04086128849033546, 'support': 109491}, '2': {'precision': 0.4, 'recall': 1.7471979313176494e-05, 'f1-score': 3.494243234271538e-05, 'support': 114469}, 'accuracy': 0.32254820899093517, 'macro avg': {'precision': 0.3586180912145302, 'recall': 0.33399194877991345, 'f1-score': 0.17518100540657058, 'support': 330177}, 'weighted avg': {'precision': 0.3596061314955773, 'recall': 0.32254820899093517, 'f1-score': 0.1694717401795951, 'support': 330177}}
[[104122   2094      1]
 [107115   2374      2]
 [112228   2239      2]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100055
{'0': {'precision': 0.3120804266643304, 'recall': 0.9828924223088331, 'f1-score': 0.4737419580070819, 'support': 28993}, '1': {'precision': 0.4022236756049706, 'recall': 0.01748152359295054, 'f1-score': 0.03350676945708137, 'support': 35180}, '2': {'precision': 0.5, 'recall': 3.487844860660598e-05, 'f1-score': 6.975203152791825e-05, 'support': 28671}, 'accuracy': 0.31356899745810174, 'macro avg': {'precision': 0.40476803408976697, 'recall': 0.33346960811679677, 'f1-score': 0.16910615983189706, 'support': 92844}, 'weighted avg': {'precision': 0.40426819953967724, 'recall': 0.31356899745810174, 'f1-score': 0.16065624702183648, 'support': 92844}}
[[28497   496     0]
 [34564   615     1]
 [28252   418     1]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 68s - 68s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999309
{'0': {'precision': 0.40326056612014943, 'recall': 0.9802012789034886, 'f1-score': 0.5714310431677451, 'support': 741260}, '1': {'precision': 0.22429668243760092, 'recall': 0.01958877672209026, 'f1-score': 0.03603082895482379, 'support': 404160}, '2': {'precision': 0.3684210526315789, 'recall': 1.0120447786441202e-05, 'f1-score': 2.0240339575068527e-05, 'support': 691669}, 'accuracy': 0.39982167439900845, 'macro avg': {'precision': 0.33199276706310976, 'recall': 0.33326672535778845, 'f1-score': 0.2024940374873813, 'support': 1837089}, 'weighted avg': {'precision': 0.3507712993049516, 'recall': 0.39982167439900845, 'f1-score': 0.23850515380819212, 'support': 1837089}}
[[726584  14668      8]
 [396239   7917      4]
 [678950  12712      7]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000903
{'0': {'precision': 0.34334771509662326, 'recall': 0.9828335703551293, 'f1-score': 0.5089103041998353, 'support': 198294}, '1': {'precision': 0.335275796242339, 'recall': 0.01782690222181859, 'f1-score': 0.03385377037871179, 'support': 187189}, '2': {'precision': 0.2, 'recall': 5.205838868875331e-06, 'f1-score': 1.04114067372213e-05, 'support': 192092}, 'accuracy': 0.34320737566549797, 'macro avg': {'precision': 0.29287450377965407, 'recall': 0.3335552261386056, 'f1-score': 0.18092482866176143, 'support': 577575}, 'weighted avg': {'precision': 0.2930565430293503, 'recall': 0.34320737566549797, 'f1-score': 0.18569521401093503, 'support': 577575}}
[[194890   3401      3]
 [183851   3337      1]
 [188876   3215      1]]
Evaluating performance on  val set...
638/638 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992923
{'0': {'precision': 0.4080717767608436, 'recall': 0.9849624060150376, 'f1-score': 0.5770646033455696, 'support': 66633}, '1': {'precision': 0.19318637274549097, 'recall': 0.01389769909463122, 'f1-score': 0.02593001049035694, 'support': 34682}, '2': {'precision': 1.0, 'recall': 1.6125651073162078e-05, 'f1-score': 3.225078208146547e-05, 'support': 62013}, 'accuracy': 0.4047928095611285, 'macro avg': {'precision': 0.5337527165021115, 'recall': 0.33295874358691396, 'f1-score': 0.20100895487266934, 'support': 163328}, 'weighted avg': {'precision': 0.5871873559981412, 'recall': 0.4047928095611285, 'f1-score': 0.24094368575076605, 'support': 163328}}
[[65631  1002     0]
 [34200   482     0]
 [61001  1011     1]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012579
{'0': {'precision': 0.34677038239917657, 'recall': 0.9779520521399363, 'f1-score': 0.5119937554414723, 'support': 505716}, '1': {'precision': 0.3233517866129844, 'recall': 0.023254919614438863, 'f1-score': 0.04338934977176273, 'support': 442057}, '2': {'precision': 0.3076923076923077, 'recall': 1.5678558199787948e-05, 'f1-score': 3.135551866927179e-05, 'support': 510251}, 'accuracy': 0.3462590464903184, 'macro avg': {'precision': 0.3259381589014896, 'recall': 0.333740883437525, 'f1-score': 0.18513815357730143, 'support': 1458024}, 'weighted avg': {'precision': 0.3259943314598838, 'recall': 0.3462590464903184, 'f1-score': 0.19075131753911612, 'support': 1458024}}
[[494566  11136     14]
 [431773  10280      4]
 [499867  10376      8]]
Evaluating performance on  train set...
2222/2222 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991746
{'0': {'precision': 0.33417699783032145, 'recall': 0.9839733292603926, 'f1-score': 0.4989131305578551, 'support': 189871}, '1': {'precision': 0.378117795011528, 'recall': 0.018312675741795334, 'f1-score': 0.034933483085145524, 'support': 197022}, '2': {'precision': 0.625, 'recall': 2.7513949572433223e-05, 'f1-score': 5.502547679575643e-05, 'support': 181726}, 'accuracy': 0.3349184603398761, 'macro avg': {'precision': 0.44576493094728314, 'recall': 0.33410450631725347, 'f1-score': 0.17796721303993213, 'support': 568619}, 'weighted avg': {'precision': 0.4423467998146426, 'recall': 0.3349184603398761, 'f1-score': 0.1787168548295928, 'support': 568619}}
[[186828   3041      2]
 [193413   3608      1]
 [178828   2893      5]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983436
{'0': {'precision': 0.3566358062994862, 'recall': 0.9848689960073341, 'f1-score': 0.5236500799497069, 'support': 58357}, '1': {'precision': 0.3721189591078067, 'recall': 0.019282260705410975, 'f1-score': 0.0366646521253411, 'support': 51913}, '2': {'precision': 1.0, 'recall': 1.8664725535211005e-05, 'f1-score': 3.732875433946769e-05, 'support': 53577}, 'accuracy': 0.3568939315336869, 'macro avg': {'precision': 0.5762515884690976, 'recall': 0.3347233071460934, 'f1-score': 0.1867840202764625, 'support': 163847}, 'weighted avg': {'precision': 0.5719177480965943, 'recall': 0.3568939315336869, 'f1-score': 0.1981361865891907, 'support': 163847}}
[[57474   883     0]
 [50912  1001     0]
 [52770   806     1]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 104s - 104s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1027262
{'0': {'precision': 0.31197397601319155, 'recall': 0.9888890619726355, 'f1-score': 0.47431227345383253, 'support': 962925}, '1': {'precision': 0.3555993755648673, 'recall': 0.012015146635869988, 'f1-score': 0.023244884970581362, 'support': 1080636}, '2': {'precision': 0.3088235294117647, 'recall': 2.0090291510129813e-05, 'f1-score': 4.017796927150646e-05, 'support': 1045281}, 'accuracy': 0.31248959966226825, 'macro avg': {'precision': 0.32546562699660786, 'recall': 0.33364143296667187, 'f1-score': 0.16586577879789513, 'support': 3088842}, 'weighted avg': {'precision': 0.3261702590525761, 'recall': 0.31248959966226825, 'f1-score': 0.15600940504515898, 'support': 3088842}}
[[ 952226   10677      22]
 [1067627   12984      25]
 [1032408   12852      21]]
Evaluating performance on  train set...
2948/2948 - 28s - 28s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1009985
{'0': {'precision': 0.3344527184844615, 'recall': 0.9890546672214627, 'f1-score': 0.4998718190084399, 'support': 252345}, '1': {'precision': 0.33430515063168126, 'recall': 0.01103864327372787, 'f1-score': 0.02137160341386514, 'support': 249306}, '2': {'precision': 0.14285714285714285, 'recall': 3.95521118850141e-06, 'f1-score': 7.910203371328676e-06, 'support': 252831}, 'accuracy': 0.3344493307991443, 'macro avg': {'precision': 0.27053833732442856, 'recall': 0.3333657552354597, 'f1-score': 0.17375044420855879, 'support': 754482}, 'weighted avg': {'precision': 0.2701992432093246, 'recall': 0.3344493307991443, 'f1-score': 0.17425229902504022, 'support': 754482}}
[[249583   2760      2]
 [246550   2752      4]
 [250110   2720      1]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997614
{'0': {'precision': 0.32927916418249437, 'recall': 0.9868288947502766, 'f1-score': 0.4937925749318801, 'support': 58765}, '1': {'precision': 0.3559842174484875, 'recall': 0.0128168702844335, 'f1-score': 0.024742896320560676, 'support': 63354}, '2': {'precision': 0.5, 'recall': 3.55359712869352e-05, 'f1-score': 7.106689171182377e-05, 'support': 56281}, 'accuracy': 0.3296244394618834, 'macro avg': {'precision': 0.39508779387699394, 'recall': 0.3332271003353323, 'f1-score': 0.17286884604805086, 'support': 178400}, 'weighted avg': {'precision': 0.39262115580389995, 'recall': 0.3296244394618834, 'f1-score': 0.17146458427745048, 'support': 178400}}
[[57991   772     2]
 [62542   812     0]
 [55582   697     2]]
testing model on single stock: results/universal/W1/deepVOL_L2/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 191s - 191s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017487
{'0': {'precision': 0.37406454975875436, 'recall': 0.9848031570386085, 'f1-score': 0.5421866274338956, 'support': 2044701}, '1': {'precision': 0.24580715947865298, 'recall': 0.01523976826761353, 'f1-score': 0.028700158866578118, 'support': 1337750}, '2': {'precision': 0.37142857142857144, 'recall': 3.119352172940724e-05, 'f1-score': 6.238180447527066e-05, 'support': 2083766}, 'accuracy': 0.37211841388660566, 'macro avg': {'precision': 0.33043342688865956, 'recall': 0.33335803960931715, 'f1-score': 0.1903163893683163, 'support': 5466217}, 'weighted avg': {'precision': 0.34167119876877766, 'recall': 0.37211841388660566, 'f1-score': 0.20985869494527254, 'support': 5466217}}
[[2013628   31000      73]
 [1317326   20387      37]
 [2052149   31552      65]]
Evaluating performance on  train set...
6073/6073 - 51s - 51s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019334
{'0': {'precision': 0.3289192451497041, 'recall': 0.983128204526522, 'f1-score': 0.49292392130794577, 'support': 511386}, '1': {'precision': 0.3212814292865119, 'recall': 0.01625670949704344, 'f1-score': 0.030947488669154137, 'support': 513265}, '2': {'precision': 0.39705882352941174, 'recall': 5.095272153582825e-05, 'f1-score': 0.0001018923676955909, 'support': 529903}, 'accuracy': 0.32879462533948645, 'macro avg': {'precision': 0.3490864993218759, 'recall': 0.33314528891503375, 'f1-score': 0.1746577674482652, 'support': 1554554}, 'weighted avg': {'precision': 0.34962431132503213, 'recall': 0.32879462533948645, 'f1-score': 0.17240484940701806, 'support': 1554554}}
[[502758   8608     20]
 [504900   8344     21]
 [520857   9019     27]]
Evaluating performance on  val set...
1786/1786 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010715
{'0': {'precision': 0.34514545003874353, 'recall': 0.978990239360523, 'f1-score': 0.510361633558749, 'support': 157879}, '1': {'precision': 0.2970286447199658, 'recall': 0.019802050748544596, 'f1-score': 0.03712882861819032, 'support': 140339}, '2': {'precision': 0.5, 'recall': 6.290297216543481e-05, 'f1-score': 0.00012579011918613793, 'support': 158975}, 'accuracy': 0.34416756162058476, 'macro avg': {'precision': 0.3807246982529031, 'recall': 0.33295173102707765, 'f1-score': 0.18253875076537515, 'support': 457193}, 'weighted avg': {'precision': 0.3842215901775007, 'recall': 0.34416756162058476, 'f1-score': 0.1876800487064928, 'support': 457193}}
[[154562   3313      4]
 [137554   2779      6]
 [155701   3264     10]]
training model: results/universal/W1/deepVOL_L3/h300
Epoch 1/50
10622/10622 - 576s - loss: 3.2705 - accuracy300: 0.3753 - val_loss: 3.2923 - val_accuracy300: 0.3453 - 576s/epoch - 54ms/step
Epoch 2/50
10622/10622 - 590s - loss: 3.2591 - accuracy300: 0.3861 - val_loss: 3.2951 - val_accuracy300: 0.3448 - 590s/epoch - 56ms/step
Epoch 3/50
10622/10622 - 546s - loss: 3.2475 - accuracy300: 0.3943 - val_loss: 3.3037 - val_accuracy300: 0.3438 - 546s/epoch - 51ms/step
Epoch 4/50
10622/10622 - 554s - loss: 3.2366 - accuracy300: 0.4010 - val_loss: 3.3081 - val_accuracy300: 0.3408 - 554s/epoch - 52ms/step
Epoch 5/50
10622/10622 - 566s - loss: 3.2284 - accuracy300: 0.4055 - val_loss: 3.3080 - val_accuracy300: 0.3450 - 566s/epoch - 53ms/step
Epoch 6/50
10622/10622 - 576s - loss: 3.2230 - accuracy300: 0.4084 - val_loss: 3.3034 - val_accuracy300: 0.3519 - 576s/epoch - 54ms/step
Epoch 7/50
10622/10622 - 569s - loss: 3.2191 - accuracy300: 0.4107 - val_loss: 3.3102 - val_accuracy300: 0.3536 - 569s/epoch - 54ms/step
Epoch 8/50
10622/10622 - 574s - loss: 3.2149 - accuracy300: 0.4131 - val_loss: 3.3196 - val_accuracy300: 0.3566 - 574s/epoch - 54ms/step
Epoch 9/50
10622/10622 - 558s - loss: 3.2120 - accuracy300: 0.4148 - val_loss: 3.3101 - val_accuracy300: 0.3607 - 558s/epoch - 53ms/step
Epoch 10/50
10622/10622 - 555s - loss: 3.2091 - accuracy300: 0.4161 - val_loss: 3.3232 - val_accuracy300: 0.3564 - 555s/epoch - 52ms/step
Epoch 11/50
10622/10622 - 560s - loss: 3.2062 - accuracy300: 0.4180 - val_loss: 3.3304 - val_accuracy300: 0.3584 - 560s/epoch - 53ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h300/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1018s - 1018s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976084
{'0': {'precision': 0.35326255074705826, 'recall': 0.6856352223550342, 'f1-score': 0.4662811949397911, 'support': 3114681}, '1': {'precision': 0.31029241427541143, 'recall': 0.10106736816104378, 'f1-score': 0.15247206465059102, 'support': 2809621}, '2': {'precision': 0.3688821704482658, 'recall': 0.2464897281935283, 'f1-score': 0.29551452099101894, 'support': 3122479}, 'accuracy': 0.35251820509416554, 'macro avg': {'precision': 0.3441457118235785, 'recall': 0.34439743956986874, 'f1-score': 0.304755926860467, 'support': 9046781}, 'weighted avg': {'precision': 0.3453085764772492, 'recall': 0.35251820509416554, 'f1-score': 0.30988301576897215, 'support': 9046781}}
[[2135535  305655  673491]
 [1882347  283961  643313]
 [2027296  325524  769659]]
Evaluating performance on  train set...
10622/10622 - 315s - 315s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0969646
{'0': {'precision': 0.34818358335074323, 'recall': 0.6963843503170603, 'f1-score': 0.4642485963194122, 'support': 911814}, '1': {'precision': 0.328334069592964, 'recall': 0.10072373519937998, 'f1-score': 0.15415654260675796, 'support': 892868}, '2': {'precision': 0.36585208733939517, 'recall': 0.24859055056071575, 'f1-score': 0.2960320987042976, 'support': 913832}, 'accuracy': 0.35021927420642307, 'macro avg': {'precision': 0.3474565800943675, 'recall': 0.34856621202571864, 'f1-score': 0.30481241254348923, 'support': 2718514}, 'weighted avg': {'precision': 0.347603504928148, 'recall': 0.35021927420642307, 'f1-score': 0.3058558529813512, 'support': 2718514}}
[[634973  86853 189988]
 [599159  89933 203776]
 [589541  97121 227170]]
Evaluating performance on  val set...
3064/3064 - 96s - 96s/epoch - 31ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971334
{'0': {'precision': 0.3417151684720809, 'recall': 0.7056058885773648, 'f1-score': 0.460443783627131, 'support': 258942}, '1': {'precision': 0.34102325099684117, 'recall': 0.09879941940057235, 'f1-score': 0.15321128931412037, 'support': 266621}, '2': {'precision': 0.35844884373217883, 'recall': 0.23855314369808106, 'f1-score': 0.2864616879930986, 'support': 258215}, 'accuracy': 0.3453158930207278, 'macro avg': {'precision': 0.34706242106703367, 'recall': 0.3476528172253394, 'f1-score': 0.30003892031144996, 'support': 783778}, 'weighted avg': {'precision': 0.34699269122485055, 'recall': 0.3453158930207278, 'f1-score': 0.2986129824431594, 'support': 783778}}
[[182711  24214  52017]
 [182048  26342  58231]
 [169929  26688  61598]]
testing model out of sample: results/universal/W1/deepVOL_L3/h300/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 697s - 697s/epoch - 29ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968044
{'0': {'precision': 0.348808965531303, 'recall': 0.7164594594727758, 'f1-score': 0.4691915709467472, 'support': 2029611}, '1': {'precision': 0.3331328621393685, 'recall': 0.09350296695053525, 'f1-score': 0.14602107406310064, 'support': 2055646}, '2': {'precision': 0.3636042551650809, 'recall': 0.24434205802658374, 'f1-score': 0.2922751897213975, 'support': 2013939}, 'accuracy': 0.35060899830075964, 'macro avg': {'precision': 0.34851536094525076, 'recall': 0.3514348281499649, 'f1-score': 0.30249594491041515, 'support': 6099196}, 'weighted avg': {'precision': 0.3484109280812103, 'recall': 0.35060899830075964, 'f1-score': 0.3018542794208674, 'support': 6099196}}
[[1454134  178927  396550]
 [1398710  192209  464727]
 [1316011  205838  492090]]
Evaluating performance on  train set...
6711/6711 - 201s - 201s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0959522
{'0': {'precision': 0.3554265314200642, 'recall': 0.730406100274815, 'f1-score': 0.47816891696009145, 'support': 581482}, '1': {'precision': 0.3237294138480609, 'recall': 0.09808596181223754, 'f1-score': 0.15055549302579674, 'support': 559132}, '2': {'precision': 0.37674227505206637, 'recall': 0.23056407197258716, 'f1-score': 0.2860606790816057, 'support': 576664}, 'accuracy': 0.3566801647723898, 'macro avg': {'precision': 0.3519660734400638, 'recall': 0.3530187113532132, 'f1-score': 0.304928363022498, 'support': 1717278}, 'weighted avg': {'precision': 0.35226405524761895, 'recall': 0.3566801647723898, 'f1-score': 0.30699042760706347, 'support': 1717278}}
[[424718  51789 104975]
 [389307  54843 114982]
 [380928  62778 132958]]
Evaluating performance on  val set...
1720/1720 - 48s - 48s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950091
{'0': {'precision': 0.37184560449809473, 'recall': 0.7207587613956251, 'f1-score': 0.4905910788837618, 'support': 154884}, '1': {'precision': 0.3100688718595402, 'recall': 0.09399950008086927, 'f1-score': 0.14426429272585722, 'support': 136022}, '2': {'precision': 0.381987987926952, 'recall': 0.2523582213807596, 'f1-score': 0.3039280689554797, 'support': 148947}, 'accuracy': 0.3683230533837441, 'macro avg': {'precision': 0.354634154761529, 'recall': 0.3557054942857513, 'f1-score': 0.31292781352169957, 'support': 439853}, 'weighted avg': {'precision': 0.35617601228800755, 'recall': 0.3683230533837441, 'f1-score': 0.320282004155254, 'support': 439853}}
[[111634  12961  30289]
 [ 92712  12786  30524]
 [ 95870  15489  37588]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984975
{'0': {'precision': 0.3386597892460539, 'recall': 0.6544271279328652, 'f1-score': 0.4463419050010804, 'support': 58390}, '1': {'precision': 0.34488295444942113, 'recall': 0.06876042526663409, 'f1-score': 0.11466059788716565, 'support': 59351}, '2': {'precision': 0.31382435253875884, 'recall': 0.2719887577723449, 'f1-score': 0.2914127195289216, 'support': 51947}, 'accuracy': 0.3325043609447928, 'macro avg': {'precision': 0.3324556987447446, 'recall': 0.3317254369906147, 'f1-score': 0.2841384074723892, 'support': 169688}, 'weighted avg': {'precision': 0.33323350481433917, 'recall': 0.3325043609447928, 'f1-score': 0.2829023945098248, 'support': 169688}}
[[38212  4000 16178]
 [40555  4081 14715]
 [34066  3752 14129]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000069
{'0': {'precision': 0.329476260797443, 'recall': 0.7476245122790911, 'f1-score': 0.4573843691201663, 'support': 21785}, '1': {'precision': 0.32710964671425957, 'recall': 0.08156837684863977, 'f1-score': 0.13057615724672098, 'support': 21908}, '2': {'precision': 0.34557495484647804, 'recall': 0.17599649583880858, 'f1-score': 0.23321821400586237, 'support': 22830}, 'accuracy': 0.33209566616057606, 'macro avg': {'precision': 0.33405362078606027, 'recall': 0.3350631283221798, 'f1-score': 0.27372624679091656, 'support': 66523}, 'weighted avg': {'precision': 0.3342217684234534, 'recall': 0.33209566616057606, 'f1-score': 0.27282522977012197, 'support': 66523}}
[[16287  1848  3650]
 [16162  1787  3959]
 [16984  1828  4018]]
Evaluating performance on  val set...
51/51 - 1s - 847ms/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980884
{'0': {'precision': 0.3150036799495321, 'recall': 0.7652618135376756, 'f1-score': 0.44629822732012514, 'support': 3915}, '1': {'precision': 0.45369406867845996, 'recall': 0.07841726618705036, 'f1-score': 0.1337218218064714, 'support': 5560}, '2': {'precision': 0.2576842105263158, 'recall': 0.18149466192170818, 'f1-score': 0.21298068557508265, 'support': 3372}, 'accuracy': 0.3147816610881918, 'macro avg': {'precision': 0.34212731971810256, 'recall': 0.3417245805488114, 'f1-score': 0.2643335782338931, 'support': 12847}, 'weighted avg': {'precision': 0.35998206482053335, 'recall': 0.3147816610881918, 'f1-score': 0.2497798521803884, 'support': 12847}}
[[2996  274  645]
 [4006  436 1118]
 [2509  251  612]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923789
{'0': {'precision': 0.3450754360504915, 'recall': 0.746936537806161, 'f1-score': 0.4720634162558001, 'support': 134978}, '1': {'precision': 0.38905272243400707, 'recall': 0.06648720407109669, 'f1-score': 0.11356645705827394, 'support': 162708}, '2': {'precision': 0.3676709291737599, 'recall': 0.3012227952385586, 'f1-score': 0.33114637190229984, 'support': 123324}, 'accuracy': 0.3534025320063656, 'macro avg': {'precision': 0.3672663625527528, 'recall': 0.3715488457052721, 'f1-score': 0.3055920817387913, 'support': 421010}, 'weighted avg': {'precision': 0.3686901314421045, 'recall': 0.3534025320063656, 'f1-score': 0.29223686388183717, 'support': 421010}}
[[100820   7613  26545]
 [114547  10818  37343]
 [ 76801   9375  37148]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0923222
{'0': {'precision': 0.3690749454837599, 'recall': 0.6811586528277908, 'f1-score': 0.47874795295518835, 'support': 56652}, '1': {'precision': 0.33790554414784396, 'recall': 0.07297560975609756, 'f1-score': 0.12002917578409919, 'support': 56375}, '2': {'precision': 0.38601629904158447, 'recall': 0.3594848861590989, 'f1-score': 0.3722784834451084, 'support': 53891}, 'accuracy': 0.3718951820654453, 'macro avg': {'precision': 0.3643322628910628, 'recall': 0.37120638291432906, 'f1-score': 0.32368520406146534, 'support': 166918}, 'weighted avg': {'precision': 0.3640174411059963, 'recall': 0.3718951820654453, 'f1-score': 0.3232193865669746, 'support': 166918}}
[[38589  3646 14417]
 [35864  4114 16397]
 [30103  4415 19373]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0898093
{'0': {'precision': 0.3971886009278315, 'recall': 0.702684356680037, 'f1-score': 0.5075099166555244, 'support': 16205}, '1': {'precision': 0.357774607703281, 'recall': 0.08251628610910049, 'f1-score': 0.1341033044594161, 'support': 15197}, '2': {'precision': 0.39720884103145365, 'recall': 0.3766120365394949, 'f1-score': 0.38663632602399667, 'support': 14888}, 'accuracy': 0.3942104126161158, 'macro avg': {'precision': 0.384057349887522, 'recall': 0.3872708931095441, 'f1-score': 0.34274984904631234, 'support': 46290}, 'weighted avg': {'precision': 0.38425550262645397, 'recall': 0.3942104126161158, 'f1-score': 0.34604466923996074, 'support': 46290}}
[[11387  1047  3771]
 [ 9205  1254  4738]
 [ 8077  1204  5607]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/XRAY
Evaluating performance on  test set...
1314/1314 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980412
{'0': {'precision': 0.36577969223846596, 'recall': 0.6498942354136478, 'f1-score': 0.46809927270000745, 'support': 120078}, '1': {'precision': 0.28735570034334534, 'recall': 0.10802597745774598, 'f1-score': 0.1570223515681553, 'support': 98393}, '2': {'precision': 0.3677338267639563, 'recall': 0.26825644769682666, 'f1-score': 0.31021534141947643, 'support': 117794}, 'accuracy': 0.35765244673100083, 'macro avg': {'precision': 0.3402897397819225, 'recall': 0.3420588868560735, 'f1-score': 0.3117789885625464, 'support': 336265}, 'weighted avg': {'precision': 0.3435169336634106, 'recall': 0.35765244673100083, 'f1-score': 0.3217695288902586, 'support': 336265}}
[[78038 13238 28802]
 [62236 10629 25528]
 [73073 13122 31599]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0967888
{'0': {'precision': 0.3627915390094174, 'recall': 0.6774186738722003, 'f1-score': 0.4725232654022853, 'support': 47371}, '1': {'precision': 0.31024004861744153, 'recall': 0.09839067167774887, 'f1-score': 0.14940005853087504, 'support': 41508}, '2': {'precision': 0.35724206043023365, 'recall': 0.2564301380181218, 'f1-score': 0.29855558421459893, 'support': 45139}, 'accuracy': 0.35628796131862883, 'macro avg': {'precision': 0.3434245493523642, 'recall': 0.3440798278560237, 'f1-score': 0.30682630271591976, 'support': 134018}, 'weighted avg': {'precision': 0.34464617661947045, 'recall': 0.35628796131862883, 'f1-score': 0.31385110769250396, 'support': 134018}}
[[32090  4564 10717]
 [27315  4084 10109]
 [29048  4516 11575]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099282
{'0': {'precision': 0.3579901521933751, 'recall': 0.656070549630845, 'f1-score': 0.4632203880683464, 'support': 9752}, '1': {'precision': 0.2893401015228426, 'recall': 0.10484365419987737, 'f1-score': 0.1539153915391539, 'support': 8155}, '2': {'precision': 0.3370644805297178, 'recall': 0.23081075245600777, 'f1-score': 0.273997180571575, 'support': 9263}, 'accuracy': 0.34563857195436143, 'macro avg': {'precision': 0.3281315780819785, 'recall': 0.33057498542891006, 'f1-score': 0.2970443200596918, 'support': 27170}, 'weighted avg': {'precision': 0.33025089345805486, 'recall': 0.34563857195436143, 'f1-score': 0.3058719590017966, 'support': 27170}}
[[6398 1068 2286]
 [5381  855 1919]
 [6093 1032 2138]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099295
{'0': {'precision': 0.32916927852899913, 'recall': 0.5960112779584373, 'f1-score': 0.4241087882468696, 'support': 111013}, '1': {'precision': 0.3219386405712774, 'recall': 0.08974701626653149, 'f1-score': 0.14036453265875332, 'support': 108505}, '2': {'precision': 0.3503273585918214, 'recall': 0.3143324899538622, 'f1-score': 0.3313552674080569, 'support': 114223}, 'accuracy': 0.3350112812030886, 'macro avg': {'precision': 0.33381175923069933, 'recall': 0.33336359472627697, 'f1-score': 0.29860952943789326, 'support': 333741}, 'weighted avg': {'precision': 0.33405983440140663, 'recall': 0.3350112812030886, 'f1-score': 0.3001136666904523, 'support': 333741}}
[[66165 10150 34698]
 [66882  9738 31885]
 [67959 10360 35904]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995661
{'0': {'precision': 0.3245123740746237, 'recall': 0.6081448523050302, 'f1-score': 0.4232005590496156, 'support': 32364}, '1': {'precision': 0.3238623751387347, 'recall': 0.08977356633029782, 'f1-score': 0.14057908175555234, 'support': 32504}, '2': {'precision': 0.34535595592093754, 'recall': 0.2957636766732578, 'f1-score': 0.31864177008860123, 'support': 33378}, 'accuracy': 0.3305172729678562, 'macro avg': {'precision': 0.3312435683780987, 'recall': 0.33122736510286194, 'f1-score': 0.29414047029792306, 'support': 98246}, 'weighted avg': {'precision': 0.33137870460669755, 'recall': 0.3305172729678562, 'f1-score': 0.2941745248506969, 'support': 98246}}
[[19682  3079  9603]
 [20476  2918  9110]
 [20493  3013  9872]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0999758
{'0': {'precision': 0.2918241495922021, 'recall': 0.6312392426850258, 'f1-score': 0.3991293701537205, 'support': 6972}, '1': {'precision': 0.34857968223399133, 'recall': 0.08606752258678078, 'f1-score': 0.1380493850700734, 'support': 8412}, '2': {'precision': 0.3693763574309649, 'recall': 0.28965936739659365, 'f1-score': 0.32469657711714167, 'support': 8220}, 'accuracy': 0.31799694966954756, 'macro avg': {'precision': 0.3365933964190528, 'recall': 0.33565537755613345, 'f1-score': 0.28729177744697854, 'support': 23604}, 'weighted avg': {'precision': 0.3390579527195264, 'recall': 0.31799694966954756, 'f1-score': 0.2801646864863625, 'support': 23604}}
[[4401  598 1973]
 [5596  724 2092]
 [5084  755 2381]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/PCAR
Evaluating performance on  test set...
2607/2607 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980492
{'0': {'precision': 0.3552793270731713, 'recall': 0.6910514483578387, 'f1-score': 0.46929001671460724, 'support': 232194}, '1': {'precision': 0.2972166182814217, 'recall': 0.08831542266734897, 'f1-score': 0.13616928545128007, 'support': 205185}, '2': {'precision': 0.35993251628917156, 'recall': 0.24217054533277085, 'f1-score': 0.28953532811456, 'support': 229933}, 'accuracy': 0.35105318052125545, 'macro avg': {'precision': 0.3374761538812548, 'recall': 0.3405124721193195, 'f1-score': 0.2983315434268157, 'support': 667312}, 'weighted avg': {'precision': 0.33902954414189995, 'recall': 0.35105318052125545, 'f1-score': 0.3049247542015093, 'support': 667312}}
[[160458  20678  51058]
 [139101  18121  47963]
 [152080  22170  55683]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985334
{'0': {'precision': 0.3404685951308085, 'recall': 0.6624155309598275, 'f1-score': 0.44976618803983054, 'support': 61709}, '1': {'precision': 0.3223435304291428, 'recall': 0.09770001965795164, 'f1-score': 0.14995097176476505, 'support': 61044}, '2': {'precision': 0.351085283084329, 'recall': 0.2614530011142151, 'f1-score': 0.2997112287586539, 'support': 61927}, 'accuracy': 0.3413038769763916, 'macro avg': {'precision': 0.33796580288142675, 'recall': 0.3405228505773314, 'f1-score': 0.2998094628544165, 'support': 184680}, 'weighted avg': {'precision': 0.3380375424193573, 'recall': 0.3413038769763916, 'f1-score': 0.3003489608051515, 'support': 184680}}
[[40877  6042 14790]
 [39944  5964 15136]
 [39240  6496 16191]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991676
{'0': {'precision': 0.3600804530778595, 'recall': 0.660293118509172, 'f1-score': 0.4660227428414851, 'support': 20606}, '1': {'precision': 0.3052924791086351, 'recall': 0.09838420107719928, 'f1-score': 0.14881194840461645, 'support': 16710}, '2': {'precision': 0.35448885318337015, 'recall': 0.2546652558676414, 'f1-score': 0.2963978840717624, 'support': 20792}, 'accuracy': 0.35356577407585876, 'macro avg': {'precision': 0.3399539284566216, 'recall': 0.3377808584846709, 'f1-score': 0.3037441917726213, 'support': 58108}, 'weighted avg': {'precision': 0.3423244196567822, 'recall': 0.35356577407585876, 'f1-score': 0.3141085066161779, 'support': 58108}}
[[13606  1824  5176]
 [10600  1644  4466]
 [13580  1917  5295]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/EXC
Evaluating performance on  test set...
5343/5343 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095122
{'0': {'precision': 0.34983649724635624, 'recall': 0.7137916640484034, 'f1-score': 0.4695444979763749, 'support': 445588}, '1': {'precision': 0.3557562882117315, 'recall': 0.09315252308430522, 'f1-score': 0.14764511195203908, 'support': 470991}, '2': {'precision': 0.3794824994631737, 'recall': 0.2820017286850912, 'f1-score': 0.3235594026298324, 'support': 451210}, 'accuracy': 0.3576377643042896, 'macro avg': {'precision': 0.3616917616404205, 'recall': 0.3629819719392666, 'f1-score': 0.31358300418608215, 'support': 1367789}, 'weighted avg': {'precision': 0.36165465116251094, 'recall': 0.3576377643042896, 'f1-score': 0.3105421601930608, 'support': 1367789}}
[[318057  34837  92694]
 [311749  43874 115368]
 [279353  44615 127242]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933254
{'0': {'precision': 0.3601391589835425, 'recall': 0.7100431220750085, 'f1-score': 0.47788930419069775, 'support': 108761}, '1': {'precision': 0.3295166316399739, 'recall': 0.0834220085862107, 'f1-score': 0.1331381304443306, 'support': 109012}, '2': {'precision': 0.40425193991922675, 'recall': 0.31701718800042705, 'f1-score': 0.35535920858430736, 'support': 112404}, 'accuracy': 0.3693564360933681, 'macro avg': {'precision': 0.3646359101809144, 'recall': 0.37016077288721544, 'f1-score': 0.32212888107311194, 'support': 330177}, 'weighted avg': {'precision': 0.36504631507714547, 'recall': 0.3693564360933681, 'f1-score': 0.32235185664292887, 'support': 330177}}
[[77225  8199 23337]
 [70741  9094 29177]
 [66465 10305 35634]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934197
{'0': {'precision': 0.3539504613268945, 'recall': 0.7319049036140595, 'f1-score': 0.47715024789825394, 'support': 30243}, '1': {'precision': 0.35335734499614097, 'recall': 0.08261405672009864, 'f1-score': 0.13391834247410114, 'support': 33251}, '2': {'precision': 0.3849465228775574, 'recall': 0.2955366269165247, 'f1-score': 0.3343677119673111, 'support': 29350}, 'accuracy': 0.3614234630132265, 'macro avg': {'precision': 0.3640847764001976, 'recall': 0.3700185290835609, 'f1-score': 0.31514543411322204, 'support': 92844}, 'weighted avg': {'precision': 0.36353657023428826, 'recall': 0.3614234630132265, 'f1-score': 0.309089075212548, 'support': 92844}}
[[22135  2277  5831]
 [22476  2747  8028]
 [17926  2750  8674]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/AAL
Evaluating performance on  test set...
7177/7177 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940841
{'0': {'precision': 0.39407176726719323, 'recall': 0.7378932956504404, 'f1-score': 0.5137665897957862, 'support': 682184}, '1': {'precision': 0.27121648032824697, 'recall': 0.08937818911355895, 'f1-score': 0.13444923025077593, 'support': 499943}, '2': {'precision': 0.40419945512917893, 'recall': 0.24374085824826477, 'f1-score': 0.30410184414401886, 'support': 654962}, 'accuracy': 0.38523120001262867, 'macro avg': {'precision': 0.35649590090820643, 'recall': 0.3570041143374214, 'f1-score': 0.3174392213968603, 'support': 1837089}, 'weighted avg': {'precision': 0.3642488299894371, 'recall': 0.38523120001262867, 'f1-score': 0.3357896383118984, 'support': 1837089}}
[[503379  53834 124971]
 [344915  44684 110344]
 [429085  66236 159641]]
Evaluating performance on  train set...
2257/2257 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0939693
{'0': {'precision': 0.36317896306283476, 'recall': 0.7508061808896982, 'f1-score': 0.48955232790484415, 'support': 196606}, '1': {'precision': 0.32000371298616914, 'recall': 0.0914905361938833, 'f1-score': 0.14229754774690734, 'support': 188402}, '2': {'precision': 0.3976104994755379, 'recall': 0.2421235206447626, 'f1-score': 0.3009715005002743, 'support': 192567}, 'accuracy': 0.3661429251612345, 'macro avg': {'precision': 0.3602643918415139, 'recall': 0.3614734125761147, 'f1-score': 0.31094045871734194, 'support': 577575}, 'weighted avg': {'precision': 0.3605751007201798, 'recall': 0.3661429251612345, 'f1-score': 0.31340561227114916, 'support': 577575}}
[[147613  16010  32983]
 [133510  17237  37655]
 [125324  20618  46625]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0922264
{'0': {'precision': 0.39255632764792586, 'recall': 0.7529281098546042, 'f1-score': 0.5160553633217992, 'support': 59424}, '1': {'precision': 0.29258156126619106, 'recall': 0.08910264523478041, 'f1-score': 0.13660398104878485, 'support': 47406}, '2': {'precision': 0.4190176142059287, 'recall': 0.25894721937059717, 'f1-score': 0.3200857646067846, 'support': 56498}, 'accuracy': 0.3893759796238245, 'macro avg': {'precision': 0.36805183437334854, 'recall': 0.3669926581533273, 'f1-score': 0.3242483696591229, 'support': 163328}, 'weighted avg': {'precision': 0.37269204223979946, 'recall': 0.3893759796238245, 'f1-score': 0.3381301905636965, 'support': 163328}}
[[44742  4388 10294]
 [33191  4224  9991]
 [36043  5825 14630]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/WBA
Evaluating performance on  test set...
5696/5696 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979564
{'0': {'precision': 0.36376540463465756, 'recall': 0.653050226341884, 'f1-score': 0.4672569393998443, 'support': 519568}, '1': {'precision': 0.29210009039126505, 'recall': 0.0964800663467804, 'f1-score': 0.14505031001800794, 'support': 422025}, '2': {'precision': 0.3680932944606414, 'recall': 0.2750377107493547, 'f1-score': 0.3148333270531283, 'support': 516431}, 'accuracy': 0.3580592637706924, 'macro avg': {'precision': 0.34131959649552135, 'recall': 0.34152266781267304, 'f1-score': 0.3090468588236602, 'support': 1458024}, 'weighted avg': {'precision': 0.3445548170360686, 'recall': 0.3580592637706924, 'f1-score': 0.32000591245330823, 'support': 1458024}}
[[339304  47575 132689]
 [270160  40717 111148]
 [323291  51102 142038]]
Evaluating performance on  train set...
2222/2222 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964493
{'0': {'precision': 0.35830052388421196, 'recall': 0.6907574347291717, 'f1-score': 0.47184952691749027, 'support': 194459}, '1': {'precision': 0.3255297054054547, 'recall': 0.09753754278321533, 'f1-score': 0.1501008064516129, 'support': 183191}, '2': {'precision': 0.36914965643411746, 'recall': 0.26837863737046325, 'f1-score': 0.31079995269960914, 'support': 190969}, 'accuracy': 0.3577861450285692, 'macro avg': {'precision': 0.3509932952412614, 'recall': 0.35222453829428346, 'f1-score': 0.31091676202290414, 'support': 568619}, 'weighted avg': {'precision': 0.35138645486080766, 'recall': 0.3577861450285692, 'f1-score': 0.314104277480382, 'support': 568619}}
[[134324  17507  42628]
 [120365  17868  44958]
 [120203  19514  51252]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961916
{'0': {'precision': 0.37142857142857144, 'recall': 0.7068856709137117, 'f1-score': 0.48697777438325823, 'support': 58629}, '1': {'precision': 0.3001203028801925, 'recall': 0.08529423595189252, 'f1-score': 0.13283635851095485, 'support': 49722}, '2': {'precision': 0.368260960771974, 'recall': 0.25306328384027676, 'f1-score': 0.2999829118250171, 'support': 55496}, 'accuracy': 0.3645413098805593, 'macro avg': {'precision': 0.34660327836024596, 'recall': 0.34841439690196035, 'f1-score': 0.30659901490641, 'support': 163847}, 'weighted avg': {'precision': 0.3487160441942551, 'recall': 0.3645413098805593, 'f1-score': 0.3161715565548279, 'support': 163847}}
[[41444  4749 12436]
 [33825  4241 11656]
 [36311  5141 14044]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/ATVI
Evaluating performance on  test set...
12066/12066 - 166s - 166s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979513
{'0': {'precision': 0.31913833128176367, 'recall': 0.7204186749077944, 'f1-score': 0.44232920824039806, 'support': 936765}, '1': {'precision': 0.38219760316757334, 'recall': 0.0969504700806691, 'f1-score': 0.15466716599569327, 'support': 1192774}, '2': {'precision': 0.34322660373566, 'recall': 0.24030259469635767, 'f1-score': 0.2826876312894788, 'support': 959303}, 'accuracy': 0.3305530033585402, 'macro avg': {'precision': 0.3481875127283323, 'recall': 0.3525572465616071, 'f1-score': 0.2932280018418567, 'support': 3088842}, 'weighted avg': {'precision': 0.3509701349137283, 'recall': 0.3305530033585402, 'f1-score': 0.2816669119914694, 'support': 3088842}}
[[674863  86553 175349]
 [811371 115640 265763]
 [628407 100373 230523]]
Evaluating performance on  train set...
2948/2948 - 49s - 49s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962589
{'0': {'precision': 0.3534741722103914, 'recall': 0.7384089665408191, 'f1-score': 0.4780887055353977, 'support': 254011}, '1': {'precision': 0.3279380089978716, 'recall': 0.10448288463881106, 'f1-score': 0.15847480853501184, 'support': 246270}, '2': {'precision': 0.37798595492093623, 'recall': 0.21618719045165047, 'f1-score': 0.2750569333566906, 'support': 254201}, 'accuracy': 0.3555419479855053, 'macro avg': {'precision': 0.35313271204306645, 'recall': 0.3530263472104269, 'f1-score': 0.30387348247570006, 'support': 754482}, 'weighted avg': {'precision': 0.353397468939082, 'recall': 0.3555419479855053, 'f1-score': 0.30535801887370856, 'support': 754482}}
[[187564  23928  42519]
 [172624  25731  47915]
 [170442  28804  54955]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0954411
{'0': {'precision': 0.3624911489123454, 'recall': 0.7195319267164594, 'f1-score': 0.4821042372742156, 'support': 61187}, '1': {'precision': 0.3332554061952075, 'recall': 0.09798766132219759, 'f1-score': 0.15144553193184684, 'support': 58191}, '2': {'precision': 0.38096194397027816, 'recall': 0.25712446206499273, 'f1-score': 0.3070262396568816, 'support': 59022}, 'accuracy': 0.3638116591928251, 'macro avg': {'precision': 0.35890283302594367, 'recall': 0.35821468336788326, 'f1-score': 0.313525336287648, 'support': 178400}, 'weighted avg': {'precision': 0.3590658471267867, 'recall': 0.3638116591928251, 'f1-score': 0.3163261302229372, 'support': 178400}}
[[44026  5350 11811]
 [39640  5702 12849]
 [37788  6058 15176]]
testing model on single stock: results/universal/W1/deepVOL_L3/h300/AAPL
Evaluating performance on  test set...
21353/21353 - 295s - 295s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984389
{'0': {'precision': 0.3534577351982023, 'recall': 0.6889049525776793, 'f1-score': 0.467205488378506, 'support': 1903534}, '1': {'precision': 0.3014273451044419, 'recall': 0.10883789394867606, 'f1-score': 0.15992930571171626, 'support': 1645392}, '2': {'precision': 0.3680443085142087, 'recall': 0.22306473039303892, 'f1-score': 0.27777516176434774, 'support': 1917291}, 'accuracy': 0.35090355907934134, 'macro avg': {'precision': 0.34097646293895095, 'recall': 0.34026919230646474, 'f1-score': 0.3016366519515234, 'support': 5466217}, 'weighted avg': {'precision': 0.34291229181797545, 'recall': 0.35090355907934134, 'f1-score': 0.30826872587989673, 'support': 5466217}}
[[1311354  205214  386966]
 [1118923  179081  347388]
 [1279796  209815  427680]]
Evaluating performance on  train set...
6073/6073 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982839
{'0': {'precision': 0.3409176475204384, 'recall': 0.7023430553256681, 'f1-score': 0.4590245592894039, 'support': 519578}, '1': {'precision': 0.32555750570860015, 'recall': 0.10836755987854299, 'f1-score': 0.16260813348520764, 'support': 511786}, '2': {'precision': 0.3521540157942037, 'recall': 0.2112062539421625, 'f1-score': 0.2640481925407658, 'support': 523190}, 'accuracy': 0.34150245022044906, 'macro avg': {'precision': 0.3395430563410808, 'recall': 0.34063895638212455, 'f1-score': 0.2952269617717924, 'support': 1554554}, 'weighted avg': {'precision': 0.33964245861084624, 'recall': 0.34150245022044906, 'f1-score': 0.29581925267680226, 'support': 1554554}}
[[364922  55040  99616]
 [352656  55461 103669]
 [352833  59856 110501]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0987542
{'0': {'precision': 0.3268481507441858, 'recall': 0.7047306542857726, 'f1-score': 0.446577440333035, 'support': 146893}, '1': {'precision': 0.3531705561221429, 'recall': 0.11035435112691282, 'f1-score': 0.16816316425925748, 'support': 160039}, '2': {'precision': 0.3436062964273081, 'recall': 0.20686671857634384, 'f1-score': 0.2582531934780351, 'support': 150261}, 'accuracy': 0.33304315682873536, 'macro avg': {'precision': 0.34120833443121223, 'recall': 0.34065057466300974, 'f1-score': 0.2909979326901092, 'support': 457193}, 'weighted avg': {'precision': 0.34156995786453653, 'recall': 0.33304315682873536, 'f1-score': 0.2872247556129049, 'support': 457193}}
[[103520  15510  27863]
 [110861  17661  31517]
 [102341  16836  31084]]
training model: results/universal/W1/deepVOL_L3/h500
Epoch 1/50
10622/10622 - 560s - loss: 3.2623 - accuracy500: 0.3880 - val_loss: 3.3174 - val_accuracy500: 0.3487 - 560s/epoch - 53ms/step
Epoch 2/50
10622/10622 - 541s - loss: 3.2535 - accuracy500: 0.3938 - val_loss: 3.3204 - val_accuracy500: 0.3498 - 541s/epoch - 51ms/step
Epoch 3/50
10622/10622 - 548s - loss: 3.2511 - accuracy500: 0.3934 - val_loss: 3.3155 - val_accuracy500: 0.3541 - 548s/epoch - 52ms/step
Epoch 4/50
10622/10622 - 549s - loss: 3.2495 - accuracy500: 0.3928 - val_loss: 3.3146 - val_accuracy500: 0.3518 - 549s/epoch - 52ms/step
Epoch 5/50
10622/10622 - 542s - loss: 3.2437 - accuracy500: 0.3972 - val_loss: 3.3283 - val_accuracy500: 0.3535 - 542s/epoch - 51ms/step
Epoch 6/50
10622/10622 - 561s - loss: 3.2313 - accuracy500: 0.4043 - val_loss: 3.3288 - val_accuracy500: 0.3534 - 561s/epoch - 53ms/step
Epoch 7/50
10622/10622 - 553s - loss: 3.2180 - accuracy500: 0.4120 - val_loss: 3.3406 - val_accuracy500: 0.3535 - 553s/epoch - 52ms/step
Epoch 8/50
10622/10622 - 577s - loss: 3.2107 - accuracy500: 0.4163 - val_loss: 3.3424 - val_accuracy500: 0.3539 - 577s/epoch - 54ms/step
Epoch 9/50
10622/10622 - 588s - loss: 3.2046 - accuracy500: 0.4193 - val_loss: 3.3474 - val_accuracy500: 0.3538 - 588s/epoch - 55ms/step
Epoch 10/50
10622/10622 - 599s - loss: 3.1993 - accuracy500: 0.4220 - val_loss: 3.3533 - val_accuracy500: 0.3539 - 599s/epoch - 56ms/step
Epoch 11/50
10622/10622 - 598s - loss: 3.1949 - accuracy500: 0.4238 - val_loss: 3.3665 - val_accuracy500: 0.3531 - 598s/epoch - 56ms/step
Epoch 12/50
10622/10622 - 564s - loss: 3.1915 - accuracy500: 0.4256 - val_loss: 3.3747 - val_accuracy500: 0.3531 - 564s/epoch - 53ms/step
Epoch 13/50
10622/10622 - 569s - loss: 3.1878 - accuracy500: 0.4275 - val_loss: 3.3743 - val_accuracy500: 0.3539 - 569s/epoch - 54ms/step
Epoch 14/50
10622/10622 - 571s - loss: 3.1850 - accuracy500: 0.4287 - val_loss: 3.3866 - val_accuracy500: 0.3531 - 571s/epoch - 54ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h500/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1098s - 1098s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0862051
{'0': {'precision': 0.37055504251853844, 'recall': 0.8123677222423026, 'f1-score': 0.5089545400997422, 'support': 3350431}, '1': {'precision': 0.23417721518987342, 'recall': 3.190710032152871e-05, 'f1-score': 6.380550701882133e-05, 'support': 2319233}, '2': {'precision': 0.37627460154374615, 'recall': 0.18955872716284333, 'f1-score': 0.25211005048210733, 'support': 3377117}, 'accuracy': 0.3716258854945201, 'macro avg': {'precision': 0.327002286417386, 'recall': 0.33398611883515583, 'f1-score': 0.2537094653629561, 'support': 9046781}, 'weighted avg': {'precision': 0.3377283014277119, 'recall': 0.3716258854945201, 'f1-score': 0.28261656670282637, 'support': 9046781}}
[[2721782     124  628525]
 [1886530      74  432629]
 [2736837     118  640162]]
Evaluating performance on  train set...
10622/10622 - 322s - 322s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1189468
{'0': {'precision': 0.3352432489543545, 'recall': 0.8051904778717319, 'f1-score': 0.4733894929257789, 'support': 906352}, '1': {'precision': 0.41125541125541126, 'recall': 0.00010544799859698663, 'f1-score': 0.00021084193623917912, 'support': 900918}, '2': {'precision': 0.34614091666389607, 'recall': 0.20565293159680612, 'f1-score': 0.25801264179336686, 'support': 911244}, 'accuracy': 0.3374200022512299, 'macro avg': {'precision': 0.3642131922912206, 'recall': 0.33698295248904503, 'f1-score': 0.24387099221846165, 'support': 2718514}, 'weighted avg': {'precision': 0.36408663896457955, 'recall': 0.3374200022512299, 'f1-score': 0.24438348919524897, 'support': 2718514}}
[[729786     83 176483]
 [723308     95 177515]
 [723791     53 187400]]
Evaluating performance on  val set...
3064/3064 - 89s - 89s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1043702
{'0': {'precision': 0.3529049886548848, 'recall': 0.7990036648059244, 'f1-score': 0.48957420089932424, 'support': 276413}, '1': {'precision': 0.37254901960784315, 'recall': 8.113763505145834e-05, 'f1-score': 0.0001622399357871412, 'support': 234170}, '2': {'precision': 0.3489648970596617, 'recall': 0.20170208093120298, 'f1-score': 0.25564251615626926, 'support': 273195}, 'accuracy': 0.3521124604160872, 'macro avg': {'precision': 0.3581396351074632, 'recall': 0.3335956277907263, 'f1-score': 0.24845965233046022, 'support': 783778}, 'weighted avg': {'precision': 0.3574006869328376, 'recall': 0.3521124604160872, 'f1-score': 0.26181255728058217, 'support': 783778}}
[[220855     13  55545]
 [186893     19  47258]
 [218072     19  55104]]
testing model out of sample: results/universal/W1/deepVOL_L3/h500/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 715s - 715s/epoch - 30ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1451268
{'0': {'precision': 0.3083858921786616, 'recall': 0.8265111481427474, 'f1-score': 0.4491762138060144, 'support': 1858471}, '1': {'precision': 0.45892351274787535, 'recall': 6.798270553542885e-05, 'f1-score': 0.00013594527279684742, 'support': 2382959}, '2': {'precision': 0.29349290377290643, 'recall': 0.17661050961208247, 'f1-score': 0.22052139944967275, 'support': 1857766}, 'accuracy': 0.305664877797008, 'macro avg': {'precision': 0.3536007695664811, 'recall': 0.33439654682012177, 'f1-score': 0.223277852842828, 'support': 6099196}, 'weighted avg': {'precision': 0.3626647332382679, 'recall': 0.305664877797008, 'f1-score': 0.2040895353140999, 'support': 6099196}}
[[1536047     112  322312]
 [1915292     162  467505]
 [1529586      79  328101]]
Evaluating performance on  train set...
6711/6711 - 211s - 211s/epoch - 31ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173875
{'0': {'precision': 0.34056430319787867, 'recall': 0.8286317422023092, 'f1-score': 0.48272895379864633, 'support': 580300}, '1': {'precision': 0.29591836734693877, 'recall': 5.149604901003285e-05, 'f1-score': 0.00010297417833707354, 'support': 563150}, '2': {'precision': 0.34889793083565934, 'recall': 0.18559394104156646, 'f1-score': 0.24229869680754249, 'support': 573828}, 'accuracy': 0.3420430471944554, 'macro avg': {'precision': 0.32846020046015895, 'recall': 0.33809239309762856, 'f1-score': 0.24171020826150866, 'support': 1717278}, 'weighted avg': {'precision': 0.32870816232009165, 'recall': 0.3420430471944554, 'f1-score': 0.24412085777000783, 'support': 1717278}}
[[480855     45  99400]
 [463776     29  99345]
 [467305     24 106499]]
Evaluating performance on  val set...
1720/1720 - 55s - 55s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1137092
{'0': {'precision': 0.3509786723806775, 'recall': 0.8257280919420138, 'f1-score': 0.492583128174764, 'support': 153140}, '1': {'precision': 0.29411764705882354, 'recall': 7.105199585056344e-05, 'f1-score': 0.00014206967096664204, 'support': 140742}, '2': {'precision': 0.3338907399258188, 'recall': 0.18192654705386688, 'f1-score': 0.23552366677605033, 'support': 145971}, 'accuracy': 0.3478844068359202, 'macro avg': {'precision': 0.3263290197884399, 'recall': 0.33590856366391036, 'f1-score': 0.24274962154059365, 'support': 439853}, 'weighted avg': {'precision': 0.3271137060982683, 'recall': 0.3478844068359202, 'f1-score': 0.24970569845216786, 'support': 439853}}
[[126452     16  26672]
 [114425     10  26307]
 [119407      8  26556]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/LILAK
Evaluating performance on  test set...
663/663 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1389202
{'0': {'precision': 0.3330719354283419, 'recall': 0.9328095705740559, 'f1-score': 0.4908716772999333, 'support': 56005}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 64205}, '2': {'precision': 0.31022665316613446, 'recall': 0.08050042443106027, 'f1-score': 0.12783028708057192, 'support': 49478}, 'accuracy': 0.3313434067229268, 'macro avg': {'precision': 0.21443286286482546, 'recall': 0.3377699983350387, 'f1-score': 0.20623398812683505, 'support': 169688}, 'weighted avg': {'precision': 0.20038593235242497, 'recall': 0.3313434067229268, 'f1-score': 0.19928371618119906, 'support': 169688}}
[[52242     0  3763]
 [59112     0  5093]
 [45495     0  3983]]
Evaluating performance on  train set...
260/260 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1176054
{'0': {'precision': 0.3328350506290819, 'recall': 0.8526555732847048, 'f1-score': 0.4787784149088676, 'support': 21935}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 21909}, '2': {'precision': 0.36660212971926426, 'recall': 0.16698267119361523, 'f1-score': 0.22945257354054954, 'support': 22679}, 'accuracy': 0.33807855929528136, 'macro avg': {'precision': 0.23314572678278203, 'recall': 0.3398794148261067, 'f1-score': 0.2360769961498057, 'support': 66523}, 'weighted avg': {'precision': 0.23472943997492754, 'recall': 0.33807855929528136, 'f1-score': 0.2360951768012888, 'support': 66523}}
[[18703     0  3232]
 [18598     0  3311]
 [18892     0  3787]]
Evaluating performance on  val set...
51/51 - 1s - 952ms/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1612523
{'0': {'precision': 0.31533477321814257, 'recall': 0.9023485784919654, 'f1-score': 0.46734955185659416, 'support': 4045}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 5497}, '2': {'precision': 0.2934697088906373, 'recall': 0.11285930408472013, 'f1-score': 0.16302447552447555, 'support': 3305}, 'accuracy': 0.31314703821903944, 'macro avg': {'precision': 0.2029348273695933, 'recall': 0.3384026275255618, 'f1-score': 0.2101246757936899, 'support': 12847}, 'weighted avg': {'precision': 0.17478372737222256, 'recall': 0.31314703821903944, 'f1-score': 0.18908887902765742, 'support': 12847}}
[[3650    0  395]
 [4994    0  503]
 [2931    1  373]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065769
{'0': {'precision': 0.3724621496439229, 'recall': 0.9159698996655519, 'f1-score': 0.5295803034725877, 'support': 155480}, '1': {'precision': 0.5, 'recall': 3.135951330035358e-05, 'f1-score': 6.27150931711103e-05, 'support': 127553}, '2': {'precision': 0.3540022256152791, 'recall': 0.09913971169107895, 'f1-score': 0.1548992741396687, 'support': 137977}, 'accuracy': 0.3707702904919123, 'macro avg': {'precision': 0.408821458419734, 'recall': 0.33838032362331044, 'f1-score': 0.22818076423514247, 'support': 421010}, 'weighted avg': {'precision': 0.4050523268101862, 'recall': 0.3707702904919123, 'f1-score': 0.24635918916454774, 'support': 421010}}
[[142415      3  13062]
 [115649      4  11900]
 [124297      1  13679]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1224288
{'0': {'precision': 0.35268765392440304, 'recall': 0.9078693495038589, 'f1-score': 0.508020359373795, 'support': 58048}, '1': {'precision': 0.375, 'recall': 5.351600128438403e-05, 'f1-score': 0.00010701673028216744, 'support': 56058}, '2': {'precision': 0.35897289259979415, 'recall': 0.11885556312959177, 'f1-score': 0.17858260547953003, 'support': 52812}, 'accuracy': 0.353347152494039, 'macro avg': {'precision': 0.3622201821747324, 'recall': 0.3422594762115783, 'f1-score': 0.22890332719453568, 'support': 166918}, 'weighted avg': {'precision': 0.36216968415020595, 'recall': 0.353347152494039, 'f1-score': 0.23320953717023415, 'support': 166918}}
[[52700     3  5345]
 [50191     3  5864]
 [46533     2  6277]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0860991
{'0': {'precision': 0.38956777274396964, 'recall': 0.8830909292772289, 'f1-score': 0.54063790378766, 'support': 18014}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 12021}, '2': {'precision': 0.3616865261228231, 'recall': 0.1213780375269148, 'f1-score': 0.181759557807462, 'support': 16255}, 'accuracy': 0.38628213437027437, 'macro avg': {'precision': 0.25041809962226425, 'recall': 0.33482298893471457, 'f1-score': 0.24079915386504067, 'support': 46290}, 'weighted avg': {'precision': 0.278610679203637, 'recall': 0.38628213437027437, 'f1-score': 0.2742180343700843, 'support': 46290}}
[[15908     0  2106]
 [10645     0  1376]
 [14282     0  1973]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/XRAY
Evaluating performance on  test set...
1314/1314 - 22s - 22s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0816982
{'0': {'precision': 0.3794205630455272, 'recall': 0.872358968319397, 'f1-score': 0.5288326300984529, 'support': 127365}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 82887}, '2': {'precision': 0.3635986828470767, 'recall': 0.1253045320720878, 'f1-score': 0.18637865911237014, 'support': 126013}, 'accuracy': 0.377374986989428, 'macro avg': {'precision': 0.24767308196420132, 'recall': 0.3325545001304949, 'f1-score': 0.23840376307027436, 'support': 336265}, 'weighted avg': {'precision': 0.27996687384622915, 'recall': 0.377374986989428, 'f1-score': 0.27014676491224643, 'support': 336265}}
[[111108      1  16256]
 [ 71506      0  11381]
 [110222      1  15790]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1192917
{'0': {'precision': 0.34512326741508104, 'recall': 0.8835200696181877, 'f1-score': 0.4963577696839326, 'support': 45965}, '1': {'precision': 1.0, 'recall': 4.533399823197407e-05, 'f1-score': 9.066388630748657e-05, 'support': 44117}, '2': {'precision': 0.33153869684918935, 'recall': 0.12333849235251275, 'f1-score': 0.17979131069491217, 'support': 43936}, 'accuracy': 0.3434762494590279, 'macro avg': {'precision': 0.5588873214214235, 'recall': 0.33563463198964416, 'f1-score': 0.22541324808838406, 'support': 134018}, 'weighted avg': {'precision': 0.5562467367928202, 'recall': 0.3434762494590279, 'f1-score': 0.22921096963755505, 'support': 134018}}
[[40611     0  5354]
 [38543     2  5572]
 [38517     0  5419]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905086
{'0': {'precision': 0.3898333684876608, 'recall': 0.8780047505938242, 'f1-score': 0.5399357288927841, 'support': 10525}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 7278}, '2': {'precision': 0.34170274170274173, 'recall': 0.12640119568698624, 'f1-score': 0.18453865336658357, 'support': 9367}, 'accuracy': 0.38369525211630473, 'macro avg': {'precision': 0.24384537006346751, 'recall': 0.33480198209360346, 'f1-score': 0.24149146075312256, 'support': 27170}, 'weighted avg': {'precision': 0.26881581836077334, 'recall': 0.38369525211630473, 'f1-score': 0.2727786938785919, 'support': 27170}}
[[9241    0 1284]
 [6281    0  997]
 [8183    0 1184]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102998
{'0': {'precision': 0.34512105836954055, 'recall': 0.9402234977484736, 'f1-score': 0.5049088621449319, 'support': 114811}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 103343}, '2': {'precision': 0.3496993987975952, 'recall': 0.06340678449998702, 'f1-score': 0.10734922553004504, 'support': 115587}, 'accuracy': 0.345408565324608, 'macro avg': {'precision': 0.2316068190557119, 'recall': 0.33454342741615356, 'f1-score': 0.2040860292249923, 'support': 333741}, 'weighted avg': {'precision': 0.2398398705621514, 'recall': 0.345408565324608, 'f1-score': 0.2108739001293311, 'support': 333741}}
[[107948      0   6863]
 [ 96577      0   6766]
 [108258      0   7329]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1201402
{'0': {'precision': 0.3280134075274942, 'recall': 0.9322271340514289, 'f1-score': 0.48527719707650674, 'support': 32122}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 32449}, '2': {'precision': 0.3459879206212252, 'recall': 0.07144766146993319, 'f1-score': 0.11843756922395333, 'support': 33675}, 'accuracy': 0.32928567066343667, 'macro avg': {'precision': 0.22466710938290646, 'recall': 0.33455826517378734, 'f1-score': 0.2012382554334867, 'support': 98246}, 'weighted avg': {'precision': 0.22583708144370176, 'recall': 0.32928567066343667, 'f1-score': 0.19925960617336255, 'support': 98246}}
[[29945     0  2177]
 [30078     0  2371]
 [31269     0  2406]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1331334
{'0': {'precision': 0.2977279970860083, 'recall': 0.9305535790522271, 'f1-score': 0.45112107623318387, 'support': 7027}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8406}, '2': {'precision': 0.3168799512492383, 'recall': 0.06363970138293966, 'f1-score': 0.1059926620464737, 'support': 8171}, 'accuracy': 0.2990594814438231, 'macro avg': {'precision': 0.20486931611174886, 'recall': 0.33139776014505556, 'f1-score': 0.18570457942655252, 'support': 23604}, 'weighted avg': {'precision': 0.1983291271471321, 'recall': 0.2990594814438231, 'f1-score': 0.17099194391934924, 'support': 23604}}
[[6539    0  488]
 [7773    0  633]
 [7651    0  520]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/PCAR
Evaluating performance on  test set...
2607/2607 - 39s - 39s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1121498
{'0': {'precision': 0.3436870477845815, 'recall': 0.8997859904371287, 'f1-score': 0.49738881533533397, 'support': 229429}, '1': {'precision': 0.18181818181818182, 'recall': 9.553607681100576e-06, 'f1-score': 1.9106211429335678e-05, 'support': 209345}, '2': {'precision': 0.3460020706108302, 'recall': 0.10090225695507968, 'f1-score': 0.156241001405898, 'support': 228538}, 'accuracy': 0.34391558970916153, 'macro avg': {'precision': 0.2905024334045312, 'recall': 0.33356593366662984, 'f1-score': 0.21788297431755377, 'support': 667312}, 'weighted avg': {'precision': 0.2936993852533057, 'recall': 0.34391558970916153, 'f1-score': 0.22452229883877878, 'support': 667312}}
[[206437      4  22988]
 [188744      2  20599]
 [205473      5  23060]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182337
{'0': {'precision': 0.3393075739979284, 'recall': 0.8654646768718376, 'f1-score': 0.4874925027170604, 'support': 62452}, '1': {'precision': 0.375, 'recall': 4.959251483642736e-05, 'f1-score': 9.917191451380968e-05, 'support': 60493}, '2': {'precision': 0.3333333333333333, 'recall': 0.13702113873815502, 'f1-score': 0.19420975296170448, 'support': 61735}, 'accuracy': 0.3384881957981373, 'macro avg': {'precision': 0.3492136357770872, 'recall': 0.334178469374943, 'f1-score': 0.2272671425310929, 'support': 184680}, 'weighted avg': {'precision': 0.3490017595010394, 'recall': 0.3384881957981373, 'f1-score': 0.22980517698397968, 'support': 184680}}
[[54050     3  8399]
 [51971     3  8519]
 [53274     2  8459]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1125989
{'0': {'precision': 0.34040525824517737, 'recall': 0.8868230406808856, 'f1-score': 0.49196914126723157, 'support': 19739}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 18239}, '2': {'precision': 0.35368043087971274, 'recall': 0.11743666169895678, 'f1-score': 0.17632579995524725, 'support': 20130}, 'accuracy': 0.34193226406002614, 'macro avg': {'precision': 0.23136189637496338, 'recall': 0.3347532341266141, 'f1-score': 0.22276498040749293, 'support': 58108}, 'weighted avg': {'precision': 0.23815733575600903, 'recall': 0.34193226406002614, 'f1-score': 0.22820295368233307, 'support': 58108}}
[[17505     0  2234]
 [16153     0  2086]
 [17766     0  2364]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/EXC
Evaluating performance on  test set...
5343/5343 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1141233
{'0': {'precision': 0.3452637090242725, 'recall': 0.8212066572403326, 'f1-score': 0.4861381215575678, 'support': 462534}, '1': {'precision': 0.3333333333333333, 'recall': 2.508912340883639e-05, 'f1-score': 5.017447031723949e-05, 'support': 438437}, '2': {'precision': 0.3634852011972065, 'recall': 0.2083831386107648, 'f1-score': 0.2649007884908386, 'support': 466818}, 'accuracy': 0.3488286570516359, 'macro avg': {'precision': 0.3473607478516041, 'recall': 0.3432049616581687, 'f1-score': 0.2503630281729079, 'support': 1367789}, 'weighted avg': {'precision': 0.3476583783821752, 'recall': 0.3488286570516359, 'f1-score': 0.25481844388459535, 'support': 1367789}}
[[379836     11  82687]
 [350767     11  87659]
 [369530     11  97277]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172163
{'0': {'precision': 0.33688619728830194, 'recall': 0.8465254073549301, 'f1-score': 0.4819670928910797, 'support': 108689}, '1': {'precision': 0.35714285714285715, 'recall': 4.637788702346721e-05, 'f1-score': 9.274373052381659e-05, 'support': 107810}, '2': {'precision': 0.3732865907099036, 'recall': 0.18733616003096465, 'f1-score': 0.24947284569607797, 'support': 113678}, 'accuracy': 0.34317653864442405, 'macro avg': {'precision': 0.3557718817136876, 'recall': 0.34463598175763943, 'f1-score': 0.24384422743922718, 'support': 330177}, 'weighted avg': {'precision': 0.3560328804985208, 'recall': 0.34317653864442405, 'f1-score': 0.24457819355638064, 'support': 330177}}
[[92008     4 16677]
 [88728     5 19077]
 [92377     5 21296]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1247262
{'0': {'precision': 0.3336535767183059, 'recall': 0.8152386541471048, 'f1-score': 0.47351228518676325, 'support': 30672}, '1': {'precision': 0.36363636363636365, 'recall': 0.0001260676352863311, 'f1-score': 0.0002520478890989288, 'support': 31729}, '2': {'precision': 0.35064281721632196, 'recall': 0.20605722169300003, 'f1-score': 0.2595742039600273, 'support': 30443}, 'accuracy': 0.33693076558528284, 'macro avg': {'precision': 0.3493109191903305, 'recall': 0.3404739811584638, 'f1-score': 0.24444617901196317, 'support': 92844}, 'weighted avg': {'precision': 0.3494707247796147, 'recall': 0.33693076558528284, 'f1-score': 0.24162879162764134, 'support': 92844}}
[[25005     2  5665]
 [25773     4  5952]
 [24165     5  6273]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/AAL
Evaluating performance on  test set...
7177/7177 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994407
{'0': {'precision': 0.36718911359655826, 'recall': 0.8564248417969303, 'f1-score': 0.5140017848527407, 'support': 670499}, '1': {'precision': 0.2375, 'recall': 3.585859634355555e-05, 'f1-score': 7.170636620441221e-05, 'support': 529859}, '2': {'precision': 0.36501922020867655, 'recall': 0.15658888918554303, 'f1-score': 0.2191605275854755, 'support': 636731}, 'accuracy': 0.36686083254540197, 'macro avg': {'precision': 0.3232361112684116, 'recall': 0.3376831965262723, 'f1-score': 0.24441133960147354, 'support': 1837089}, 'weighted avg': {'precision': 0.3290316903971825, 'recall': 0.36686083254540197, 'f1-score': 0.2635811214892125, 'support': 1837089}}
[[574232     38  96229]
 [452624     19  77216]
 [537003     23  99705]]
Evaluating performance on  train set...
2257/2257 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1151178
{'0': {'precision': 0.3458996714420413, 'recall': 0.8403509745649399, 'f1-score': 0.4900770793701237, 'support': 198191}, '1': {'precision': 0.2727272727272727, 'recall': 4.8194061420653834e-05, 'f1-score': 9.63710929552731e-05, 'support': 186745}, '2': {'precision': 0.35434800716338344, 'recall': 0.17666723768291986, 'f1-score': 0.23578111631097087, 'support': 192639}, 'accuracy': 0.3473003506038177, 'macro avg': {'precision': 0.3243249837775658, 'recall': 0.33902213543642684, 'f1-score': 0.24198485559134997, 'support': 577575}, 'weighted avg': {'precision': 0.3250589136998159, 'recall': 0.3473003506038177, 'f1-score': 0.24683807595935978, 'support': 577575}}
[[166550     14  31627]
 [156352      9  30384]
 [158596     10  34033]]
Evaluating performance on  val set...
638/638 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985688
{'0': {'precision': 0.3689688347278505, 'recall': 0.8486413089031566, 'f1-score': 0.5143225793342375, 'support': 59653}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 46826}, '2': {'precision': 0.36418287639761066, 'recall': 0.16730285493148517, 'f1-score': 0.2292774061351172, 'support': 56849}, 'accuracy': 0.3681854917711599, 'macro avg': {'precision': 0.24438390370848706, 'recall': 0.3386480546115473, 'f1-score': 0.24786666182311823, 'support': 163328}, 'weighted avg': {'precision': 0.2615199490494479, 'recall': 0.3681854917711599, 'f1-score': 0.2676520626371507, 'support': 163328}}
[[50624     7  9022]
 [39243     0  7583]
 [47337     1  9511]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/WBA
Evaluating performance on  test set...
5696/5696 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0761797
{'0': {'precision': 0.3851921094210273, 'recall': 0.8237800785689358, 'f1-score': 0.5249311594016954, 'support': 558745}, '1': {'precision': 0.2391304347826087, 'recall': 3.225134942577938e-05, 'f1-score': 6.449400059217218e-05, 'support': 341071}, '2': {'precision': 0.401225697058175, 'recall': 0.18906214171061683, 'f1-score': 0.25701559345479164, 'support': 558208}, 'accuracy': 0.388080031604418, 'macro avg': {'precision': 0.341849413753937, 'recall': 0.33762482387632614, 'f1-score': 0.26067041561902643, 'support': 1458024}, 'weighted avg': {'precision': 0.3571628557579579, 'recall': 0.388080031604418, 'f1-score': 0.2995786201628976, 'support': 1458024}}
[[460283     20  98442]
 [282004     11  59056]
 [452657     15 105536]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1214937
{'0': {'precision': 0.33964494569757725, 'recall': 0.8476827405743238, 'f1-score': 0.48497337629707604, 'support': 191843}, '1': {'precision': 0.45454545454545453, 'recall': 7.851676594675516e-05, 'f1-score': 0.0001570064110951197, 'support': 191042}, '2': {'precision': 0.33619940748000804, 'recall': 0.16252274758525634, 'f1-score': 0.21912020905923346, 'support': 185734}, 'accuracy': 0.3391075570812794, 'macro avg': {'precision': 0.3767966025743466, 'recall': 0.33676133497517563, 'f1-score': 0.23475019725580157, 'support': 568619}, 'weighted avg': {'precision': 0.37712323857209284, 'recall': 0.3391075570812794, 'f1-score': 0.23524858500534815, 'support': 568619}}
[[162622     12  29209]
 [160636     15  30391]
 [155542      6  30186]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.078937
{'0': {'precision': 0.39315468854537133, 'recall': 0.8694013580016197, 'f1-score': 0.5414559156575675, 'support': 64212}, '1': {'precision': 0.5, 'recall': 0.00010049493756752003, 'f1-score': 0.0002009494863228756, 'support': 39803}, '2': {'precision': 0.36550082402490386, 'recall': 0.13344029950528147, 'f1-score': 0.19550418727655616, 'support': 59832}, 'accuracy': 0.3894731060074338, 'macro avg': {'precision': 0.41955183752342506, 'recall': 0.33431405081482285, 'f1-score': 0.2457203508068155, 'support': 163847}, 'weighted avg': {'precision': 0.4090120305158681, 'recall': 0.3894731060074338, 'f1-score': 0.2836388348992581, 'support': 163847}}
[[55826     4  8382]
 [34321     4  5478]
 [51848     0  7984]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/ATVI
Evaluating performance on  test set...
12066/12066 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.186697
{'0': {'precision': 0.24987378938140956, 'recall': 0.7630167717399858, 'f1-score': 0.37646296536746937, 'support': 775173}, '1': {'precision': 0.5450643776824035, 'recall': 8.485544173938956e-05, 'f1-score': 0.0001696844670571636, 'support': 1496663}, '2': {'precision': 0.2561861256711395, 'recall': 0.2262492564314093, 'f1-score': 0.24028884526889127, 'support': 817006}, 'accuracy': 0.2513705783591391, 'macro avg': {'precision': 0.35037476424498415, 'recall': 0.32978362787104487, 'f1-score': 0.20564049836780596, 'support': 3088842}, 'weighted avg': {'precision': 0.3945746345787545, 'recall': 0.2513705783591391, 'f1-score': 0.15811599137607954, 'support': 3088842}}
[[ 591470      58  183645]
 [1143494     127  353042]
 [ 632111      48  184847]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1185279
{'0': {'precision': 0.336552554964361, 'recall': 0.7989609027752952, 'f1-score': 0.47360483720010316, 'support': 251757}, '1': {'precision': 0.41379310344827586, 'recall': 0.00014406569395644415, 'f1-score': 0.00028803110735959485, 'support': 249886}, '2': {'precision': 0.34886273008581364, 'recall': 0.2162601497395576, 'f1-score': 0.267004253199666, 'support': 252839}, 'accuracy': 0.3391187596258095, 'macro avg': {'precision': 0.3664027961661502, 'recall': 0.3384550394029364, 'f1-score': 0.2469657071690429, 'support': 754482}, 'weighted avg': {'precision': 0.3662601213025699, 'recall': 0.3391187596258095, 'f1-score': 0.24760616729760335, 'support': 754482}}
[[201144     31  50582]
 [198376     36  51474]
 [198140     20  54679]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1282849
{'0': {'precision': 0.33249240968626703, 'recall': 0.7661293048092196, 'f1-score': 0.46373046395548645, 'support': 59178}, '1': {'precision': 0.35714285714285715, 'recall': 0.00015897745699659788, 'f1-score': 0.0003178134435086604, 'support': 62902}, '2': {'precision': 0.3185604798400533, 'recall': 0.23764204545454545, 'f1-score': 0.2722151036264161, 'support': 56320}, 'accuracy': 0.3292152466367713, 'macro avg': {'precision': 0.3360652488897258, 'recall': 0.3346434425735872, 'f1-score': 0.2454211270084704, 'support': 178400}, 'weighted avg': {'precision': 0.3367856616872517, 'recall': 0.3292152466367713, 'f1-score': 0.23987548841603765, 'support': 178400}}
[[45338    12 13828]
 [48090    10 14802]
 [42930     6 13384]]
testing model on single stock: results/universal/W1/deepVOL_L3/h500/AAPL
Evaluating performance on  test set...
21353/21353 - 307s - 307s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0788738
{'0': {'precision': 0.3746621366484093, 'recall': 0.7927616288812115, 'f1-score': 0.5088431030779317, 'support': 2058861}, '1': {'precision': 0.21052631578947367, 'recall': 3.361783701308574e-05, 'f1-score': 6.722493923018277e-05, 'support': 1308829}, '2': {'precision': 0.37516571481100625, 'recall': 0.19836723568483988, 'f1-score': 0.25951633888321923, 'support': 2098527}, 'accuracy': 0.37475808223493506, 'macro avg': {'precision': 0.32011805574962976, 'recall': 0.3303874941343548, 'f1-score': 0.256142222300127, 'support': 5466217}, 'weighted avg': {'precision': 0.3355548436323875, 'recall': 0.37475808223493506, 'f1-score': 0.2913033364909784, 'support': 5466217}}
[[1632186      83  426592]
 [1042069      44  266716]
 [1682166      82  416279]]
Evaluating performance on  train set...
6073/6073 - 102s - 102s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179414
{'0': {'precision': 0.3314941806608621, 'recall': 0.7613090274410937, 'f1-score': 0.4618754967230252, 'support': 515650}, '1': {'precision': 0.3357664233576642, 'recall': 8.957101326235154e-05, 'f1-score': 0.00017909425029589483, 'support': 513559}, '2': {'precision': 0.343506872406639, 'recall': 0.24204665505524942, 'f1-score': 0.2839866401792923, 'support': 525345}, 'accuracy': 0.33435506260959735, 'macro avg': {'precision': 0.33692249214172176, 'recall': 0.3344817511698685, 'f1-score': 0.2486804103842045, 'support': 1554554}, 'weighted avg': {'precision': 0.3369651107361841, 'recall': 0.33435506260959735, 'f1-score': 0.24923485246206048, 'support': 1554554}}
[[392569     42 123039]
 [393534     46 119979]
 [398138     49 127158]]
Evaluating performance on  val set...
1786/1786 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1096358
{'0': {'precision': 0.33996020986552783, 'recall': 0.7523516180154389, 'f1-score': 0.46830878770099743, 'support': 156488}, '1': {'precision': 0.3333333333333333, 'recall': 7.03180485335171e-05, 'f1-score': 0.00014060643555655544, 'support': 142211}, '2': {'precision': 0.34673330566732224, 'recall': 0.24249498403725062, 'f1-score': 0.28539392589292345, 'support': 158494}, 'accuracy': 0.34160190554098596, 'macro avg': {'precision': 0.34000894962206113, 'recall': 0.3316389733670744, 'f1-score': 0.25128110667649245, 'support': 457193}, 'weighted avg': {'precision': 0.3402469165900177, 'recall': 0.34160190554098596, 'f1-score': 0.259273274617139, 'support': 457193}}
[[117734      8  38746]
 [108535     10  33666]
 [120048     12  38434]]
training model: results/universal/W1/deepVOL_L3/h1000
Epoch 1/50
10622/10622 - 579s - loss: 3.2699 - accuracy1000: 0.3844 - val_loss: 3.3104 - val_accuracy1000: 0.3339 - 579s/epoch - 55ms/step
Epoch 2/50
10622/10622 - 575s - loss: 3.2668 - accuracy1000: 0.3831 - val_loss: 3.2990 - val_accuracy1000: 0.3465 - 575s/epoch - 54ms/step
Epoch 3/50
10622/10622 - 619s - loss: 3.2708 - accuracy1000: 0.3780 - val_loss: 3.3088 - val_accuracy1000: 0.3253 - 619s/epoch - 58ms/step
Epoch 4/50
10622/10622 - 606s - loss: 3.2455 - accuracy1000: 0.3975 - val_loss: 3.3817 - val_accuracy1000: 0.3323 - 606s/epoch - 57ms/step
Epoch 5/50
10622/10622 - 608s - loss: 3.2264 - accuracy1000: 0.4076 - val_loss: 3.4087 - val_accuracy1000: 0.3371 - 608s/epoch - 57ms/step
Epoch 6/50
10622/10622 - 618s - loss: 3.2065 - accuracy1000: 0.4192 - val_loss: 3.4345 - val_accuracy1000: 0.3322 - 618s/epoch - 58ms/step
Epoch 7/50
10622/10622 - 574s - loss: 3.1988 - accuracy1000: 0.4226 - val_loss: 3.4468 - val_accuracy1000: 0.3298 - 574s/epoch - 54ms/step
Epoch 8/50
10622/10622 - 533s - loss: 3.1937 - accuracy1000: 0.4240 - val_loss: 3.4493 - val_accuracy1000: 0.3279 - 533s/epoch - 50ms/step
Epoch 9/50
10622/10622 - 541s - loss: 3.1892 - accuracy1000: 0.4263 - val_loss: 3.4566 - val_accuracy1000: 0.3232 - 541s/epoch - 51ms/step
Epoch 10/50
10622/10622 - 526s - loss: 3.1851 - accuracy1000: 0.4283 - val_loss: 3.4669 - val_accuracy1000: 0.3248 - 526s/epoch - 50ms/step
Epoch 11/50
10622/10622 - 543s - loss: 3.1819 - accuracy1000: 0.4295 - val_loss: 3.4667 - val_accuracy1000: 0.3272 - 543s/epoch - 51ms/step
Epoch 12/50
10622/10622 - 527s - loss: 3.1785 - accuracy1000: 0.4310 - val_loss: 3.4606 - val_accuracy1000: 0.3264 - 527s/epoch - 50ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h1000/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 963s - 963s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007254
{'0': {'precision': 0.3526306486733961, 'recall': 0.9981398393189819, 'f1-score': 0.5211465635867492, 'support': 3190047}, '1': {'precision': 0.30525593864954176, 'recall': 0.0018593226460257549, 'f1-score': 0.0036961320461291777, 'support': 2633217}, '2': {'precision': 0.3374125874125874, 'recall': 0.00011974498660934625, 'f1-score': 0.00023940501032511635, 'support': 3223517}, 'accuracy': 0.3525447338672175, 'macro avg': {'precision': 0.3317663915785084, 'recall': 0.3333729689838723, 'f1-score': 0.17502736688106782, 'support': 9046781}, 'weighted avg': {'precision': 0.33341900079708053, 'recall': 0.3525447338672175, 'f1-score': 0.18492616054141234, 'support': 9046781}}
[[3184113    5512     422]
 [2627985    4896     336]
 [3217500    5631     386]]
Evaluating performance on  train set...
10622/10622 - 300s - 300s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006888
{'0': {'precision': 0.3308661195599853, 'recall': 0.9979911218033879, 'f1-score': 0.49697053911919903, 'support': 899507}, '1': {'precision': 0.32872319102024455, 'recall': 0.0018104482736161385, 'f1-score': 0.0036010636312335175, 'support': 905853}, '2': {'precision': 0.3206997084548105, 'recall': 0.00012046160888524828, 'f1-score': 0.0002408327558820664, 'support': 913154}, 'accuracy': 0.3308609041557263, 'macro avg': {'precision': 0.3267630063450135, 'recall': 0.3333073438952964, 'f1-score': 0.16693747850210486, 'support': 2718514}, 'weighted avg': {'precision': 0.32673714424006983, 'recall': 0.3308609041557263, 'f1-score': 0.16571937110472923, 'support': 2718514}}
[[897700   1692    115]
 [904095   1640    118]
 [911387   1657    110]]
Evaluating performance on  val set...
3064/3064 - 85s - 85s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999413
{'0': {'precision': 0.3466304452043849, 'recall': 0.9979719831869677, 'f1-score': 0.5145423889312176, 'support': 271694}, '1': {'precision': 0.33516106922549693, 'recall': 0.001992916790629623, 'f1-score': 0.0039622733239340745, 'support': 245369}, '2': {'precision': 0.2765957446808511, 'recall': 9.74823313274469e-05, 'f1-score': 0.00019489597427373138, 'support': 266715}, 'accuracy': 0.34660069560513307, 'macro avg': {'precision': 0.31946241970357764, 'recall': 0.33335412743630827, 'f1-score': 0.1728998527431418, 'support': 783778}, 'weighted avg': {'precision': 0.3192074574901366, 'recall': 0.34660069560513307, 'f1-score': 0.1796711320568797, 'support': 783778}}
[[271143    513     38]
 [244850    489     30]
 [266232    457     26]]
testing model out of sample: results/universal/W1/deepVOL_L3/h1000/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 658s - 658s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1007258
{'0': {'precision': 0.346857240949378, 'recall': 0.9981007159421688, 'f1-score': 0.5148093421766579, 'support': 2115534}, '1': {'precision': 0.31499678574708423, 'recall': 0.0018562082589902984, 'f1-score': 0.003690668204624418, 'support': 1847853}, '2': {'precision': 0.3490566037735849, 'recall': 0.00012126552514761386, 'f1-score': 0.0002424468220042489, 'support': 2135809}, 'accuracy': 0.34680062749254165, 'macro avg': {'precision': 0.3369702101566823, 'recall': 0.33335939657543556, 'f1-score': 0.1729141524010955, 'support': 6099196}, 'weighted avg': {'precision': 0.3379747556492306, 'recall': 0.34680062749254165, 'f1-score': 0.1797670216387097, 'support': 6099196}}
[[2111516    3750     268]
 [1844208    3430     215]
 [2131841    3709     259]]
Evaluating performance on  train set...
6711/6711 - 201s - 201s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000249
{'0': {'precision': 0.33856659988962534, 'recall': 0.998209491244395, 'f1-score': 0.5056350059963556, 'support': 581399}, '1': {'precision': 0.33936497097985663, 'recall': 0.0017654539383476489, 'f1-score': 0.003512634352079752, 'support': 563028}, '2': {'precision': 0.35294117647058826, 'recall': 0.00011521320552813907, 'f1-score': 0.0002303512158006973, 'support': 572851}, 'accuracy': 0.3385695268908121, 'macro avg': {'precision': 0.34362424911335676, 'recall': 0.33336338612942357, 'f1-score': 0.16979266385474534, 'support': 1717278}, 'weighted avg': {'precision': 0.34362343742389295, 'recall': 0.3385695268908121, 'f1-score': 0.17241550597490946, 'support': 1717278}}
[[580358    975     66]
 [561979    994     55]
 [571825    960     66]]
Evaluating performance on  val set...
1720/1720 - 47s - 47s/epoch - 27ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988216
{'0': {'precision': 0.3632182389349687, 'recall': 0.9980095267305538, 'f1-score': 0.5326004536238129, 'support': 159761}, '1': {'precision': 0.2943305186972256, 'recall': 0.0018784547400187846, 'f1-score': 0.003733084461035931, 'support': 129894}, '2': {'precision': 0.35294117647058826, 'recall': 0.00011984180881236767, 'f1-score': 0.00023960226024798834, 'support': 150198}, 'accuracy': 0.36308721322805576, 'macro avg': {'precision': 0.3368299780342609, 'recall': 0.3333359410931283, 'f1-score': 0.17885771344836562, 'support': 439853}, 'weighted avg': {'precision': 0.3393655068617842, 'recall': 0.36308721322805576, 'f1-score': 0.19463246612995821, 'support': 439853}}
[[159443    302     16]
 [129633    244     17]
 [149897    283     18]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0967101
{'0': {'precision': 0.33543792153229757, 'recall': 0.9987876871178579, 'f1-score': 0.5022108159920843, 'support': 56916}, '1': {'precision': 0.37244897959183676, 'recall': 0.0011334347731577804, 'f1-score': 0.0022599919507136, 'support': 64406}, '2': {'precision': 0.3333333333333333, 'recall': 0.00014472976884588346, 'f1-score': 0.00028933391200115734, 'support': 48366}, 'accuracy': 0.33548041110744425, 'macro avg': {'precision': 0.34707341148582255, 'recall': 0.3333552838866205, 'f1-score': 0.16825338061826633, 'support': 169688}, 'weighted avg': {'precision': 0.34888580053700957, 'recall': 0.33548041110744425, 'f1-score': 0.16938959601486833, 'support': 169688}}
[[56847    61     8]
 [64327    73     6]
 [48297    62     7]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022977
{'0': {'precision': 0.3207353981901134, 'recall': 0.998406374501992, 'f1-score': 0.48550394310981443, 'support': 21335}, '1': {'precision': 0.336734693877551, 'recall': 0.0014894385268098935, 'f1-score': 0.002965758964680507, 'support': 22156}, '2': {'precision': 0.4166666666666667, 'recall': 0.00021708926710663424, 'f1-score': 0.00043395243881270615, 'support': 23032}, 'accuracy': 0.3207762728680306, 'macro avg': {'precision': 0.35804558624477706, 'recall': 0.33337096743196953, 'f1-score': 0.16296788483776922, 'support': 66523}, 'weighted avg': {'precision': 0.3592779980548646, 'recall': 0.3207762728680306, 'f1-score': 0.1568469668301202, 'support': 66523}}
[[21301    29     5]
 [22121    33     2]
 [22991    36     5]]
Evaluating performance on  val set...
51/51 - 1s - 848ms/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0952709
{'0': {'precision': 0.32987762101488816, 'recall': 0.99787785899552, 'f1-score': 0.4958406561218512, 'support': 4241}, '1': {'precision': 0.26666666666666666, 'recall': 0.0007593014426727411, 'f1-score': 0.0015142911224682947, 'support': 5268}, '2': {'precision': 0.3333333333333333, 'recall': 0.0002995805871779509, 'f1-score': 0.000598623166716552, 'support': 3338}, 'accuracy': 0.32980462364754415, 'macro avg': {'precision': 0.30995920700496266, 'recall': 0.33297891367512356, 'f1-score': 0.16598452347034534, 'support': 12847}, 'weighted avg': {'precision': 0.3048554259664363, 'recall': 0.32980462364754415, 'f1-score': 0.16446140829582265, 'support': 12847}}
[[4232    8    1]
 [5263    4    1]
 [3334    3    1]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/QRTEA
Evaluating performance on  test set...
1645/1645 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980843
{'0': {'precision': 0.4168580533534517, 'recall': 0.9980285012621011, 'f1-score': 0.5880842062852539, 'support': 175501}, '1': {'precision': 0.23205128205128206, 'recall': 0.002121872875196361, 'f1-score': 0.004205292627959387, 'support': 85302}, '2': {'precision': 0.29411764705882354, 'recall': 9.362886765247461e-05, 'f1-score': 0.0001871981429944215, 'support': 160207}, 'accuracy': 0.4165007957055652, 'macro avg': {'precision': 0.31434232748785246, 'recall': 0.3334146676683167, 'f1-score': 0.19749223235206925, 'support': 421010}, 'weighted avg': {'precision': 0.3327074168439598, 'recall': 0.4165007957055652, 'f1-score': 0.24607034657588478, 'support': 421010}}
[[175155    324     22]
 [ 85107    181     14]
 [159917    275     15]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976267
{'0': {'precision': 0.3582646686390888, 'recall': 0.9984278833288734, 'f1-score': 0.5273139212889151, 'support': 59792}, '1': {'precision': 0.3233082706766917, 'recall': 0.0016046572377504944, 'f1-score': 0.003193464537690308, 'support': 53594}, '2': {'precision': 0.2857142857142857, 'recall': 0.00011208249271463797, 'f1-score': 0.00022407708251638561, 'support': 53532}, 'accuracy': 0.3581998346493488, 'macro avg': {'precision': 0.3224290750100221, 'recall': 0.3333815410197795, 'f1-score': 0.17691048763637393, 'support': 166918}, 'weighted avg': {'precision': 0.3237733597860755, 'recall': 0.3581998346493488, 'f1-score': 0.18998729804167946, 'support': 166918}}
[[59698    88     6]
 [53499    86     9]
 [53434    92     6]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966502
{'0': {'precision': 0.43067399679667545, 'recall': 0.9979937807202327, 'f1-score': 0.6016933776837012, 'support': 19938}, '1': {'precision': 0.1728395061728395, 'recall': 0.0015569395017793594, 'f1-score': 0.003086079576766229, 'support': 8992}, '2': {'precision': 0.2857142857142857, 'recall': 0.0001152073732718894, 'f1-score': 0.00023032187482006106, 'support': 17360}, 'accuracy': 0.430200907323396, 'macro avg': {'precision': 0.2964092628946002, 'recall': 0.33322197586509467, 'f1-score': 0.20166992637842918, 'support': 46290}, 'weighted avg': {'precision': 0.3262249079204642, 'recall': 0.430200907323396, 'f1-score': 0.25984685633093096, 'support': 46290}}
[[19898    38     2]
 [ 8975    14     3]
 [17329    29     2]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003995
{'0': {'precision': 0.35410354720218784, 'recall': 0.9981693133245438, 'f1-score': 0.5227573589237258, 'support': 119081}, '1': {'precision': 0.28933092224231466, 'recall': 0.0016153294767342076, 'f1-score': 0.003212722380627284, 'support': 99051}, '2': {'precision': 0.38461538461538464, 'recall': 0.0001269755275833171, 'f1-score': 0.0002538672443556849, 'support': 118133}, 'accuracy': 0.35400056503055627, 'macro avg': {'precision': 0.342683284686629, 'recall': 0.33330387277628715, 'f1-score': 0.1754079828495696, 'support': 336265}, 'weighted avg': {'precision': 0.3457430625077736, 'recall': 0.35400056503055627, 'f1-score': 0.18615878108544504, 'support': 336265}}
[[118863    206     12]
 [ 98879    160     12]
 [117931    187     15]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984892
{'0': {'precision': 0.3469883480197613, 'recall': 0.9983656616919703, 'f1-score': 0.5149889905102081, 'support': 46502}, '1': {'precision': 0.3627450980392157, 'recall': 0.0016680567139282735, 'f1-score': 0.0033208427760450555, 'support': 44363}, '2': {'precision': 0.29411764705882354, 'recall': 0.00011586679952726345, 'f1-score': 0.0002316423442205235, 'support': 43153}, 'accuracy': 0.3470056261099255, 'macro avg': {'precision': 0.3346170310392669, 'recall': 0.3333831950684753, 'f1-score': 0.17284715854349122, 'support': 134018}, 'weighted avg': {'precision': 0.33518013824604215, 'recall': 0.3470056261099255, 'f1-score': 0.17986641083182506, 'support': 134018}}
[[46426    72     4]
 [44281    74     8]
 [43090    58     5]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095726
{'0': {'precision': 0.38758432557968076, 'recall': 0.998575363282363, 'f1-score': 0.5584236243892076, 'support': 10529}, '1': {'precision': 0.3333333333333333, 'recall': 0.0015255530129672007, 'f1-score': 0.0030372057706909645, 'support': 7866}, '2': {'precision': 0.14285714285714285, 'recall': 0.00011396011396011396, 'f1-score': 0.0002277385561375541, 'support': 8775}, 'accuracy': 0.38744939271255063, 'macro avg': {'precision': 0.28792493392338564, 'recall': 0.3334049588030968, 'f1-score': 0.18722952290534536, 'support': 27170}, 'weighted avg': {'precision': 0.2928394108428372, 'recall': 0.38744939271255063, 'f1-score': 0.2173548548993864, 'support': 27170}}
[[10514    12     3]
 [ 7851    12     3]
 [ 8762    12     1]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.101525
{'0': {'precision': 0.3398604586985344, 'recall': 0.9989331969706321, 'f1-score': 0.5071698586171473, 'support': 113423}, '1': {'precision': 0.3303030303030303, 'recall': 0.0010642868301827839, 'f1-score': 0.0021217370992544717, 'support': 102416}, '2': {'precision': 0.3333333333333333, 'recall': 9.329782361622364e-05, 'f1-score': 0.00018654343494297704, 'support': 117902}, 'accuracy': 0.3398503630060436, 'macro avg': {'precision': 0.3344989407782993, 'recall': 0.33336359387481035, 'f1-score': 0.16982604638378154, 'support': 333741}, 'weighted avg': {'precision': 0.3346216815588905, 'recall': 0.3398503630060436, 'f1-score': 0.1730803843242412, 'support': 333741}}
[[113302    108     13]
 [102298    109      9]
 [117778    113     11]]
Evaluating performance on  train set...
384/384 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014884
{'0': {'precision': 0.3282347066676178, 'recall': 0.9990384913619305, 'f1-score': 0.4941245052618661, 'support': 32241}, '1': {'precision': 0.3577981651376147, 'recall': 0.0012007019488316246, 'f1-score': 0.002393372200061368, 'support': 32481}, '2': {'precision': 0.3333333333333333, 'recall': 5.965875193890944e-05, 'f1-score': 0.00011929615269907545, 'support': 33524}, 'accuracy': 0.3282678175192883, 'macro avg': {'precision': 0.33978873504618856, 'recall': 0.333432950687567, 'f1-score': 0.16554572453820884, 'support': 98246}, 'weighted avg': {'precision': 0.3397484278868574, 'recall': 0.3282678175192883, 'f1-score': 0.16298685524907988, 'support': 98246}}
[[32210    30     1]
 [32439    39     3]
 [33482    40     2]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1055582
{'0': {'precision': 0.27638553195098164, 'recall': 0.9986211123027424, 'f1-score': 0.4329458651610761, 'support': 6527}, '1': {'precision': 0.3333333333333333, 'recall': 0.0007825600894354388, 'f1-score': 0.0015614543832255185, 'support': 8945}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 8132}, 'accuracy': 0.2764361972547026, 'macro avg': {'precision': 0.2032396217614383, 'recall': 0.3331345574640593, 'f1-score': 0.14483577318143387, 'support': 23604}, 'weighted avg': {'precision': 0.20274678163492305, 'recall': 0.2764361972547026, 'f1-score': 0.12031032330809592, 'support': 23604}}
[[6518    9    0]
 [8938    7    0]
 [8127    5    0]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001858
{'0': {'precision': 0.35269257273602145, 'recall': 0.9981602025901628, 'f1-score': 0.5212169620323377, 'support': 235352}, '1': {'precision': 0.31191088260497, 'recall': 0.0018236472945891784, 'f1-score': 0.0036260939297792965, 'support': 199600}, '2': {'precision': 0.3888888888888889, 'recall': 0.00012050266827336891, 'f1-score': 0.00024093068080126664, 'support': 232360}, 'accuracy': 0.35262515884623685, 'macro avg': {'precision': 0.3511641147432934, 'recall': 0.3333681175176751, 'f1-score': 0.1750279955476394, 'support': 667312}, 'weighted avg': {'precision': 0.35309800628303156, 'recall': 0.35262515884623685, 'f1-score': 0.18499473327260663, 'support': 667312}}
[[234919    409     24]
 [199216    364     20]
 [231938    394     28]]
Evaluating performance on  train set...
722/722 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998968
{'0': {'precision': 0.3407781214390363, 'recall': 0.9980770147640767, 'f1-score': 0.5080800766949958, 'support': 62923}, '1': {'precision': 0.37669376693766937, 'recall': 0.0023161262372113174, 'f1-score': 0.004603944818905983, 'support': 60014}, '2': {'precision': 0.38095238095238093, 'recall': 0.00012956934389323486, 'f1-score': 0.0002590505796256719, 'support': 61743}, 'accuracy': 0.34085445094217026, 'macro avg': {'precision': 0.36614142310969555, 'recall': 0.33350757011506044, 'f1-score': 0.17098102403117585, 'support': 184680}, 'weighted avg': {'precision': 0.3658805735404409, 'recall': 0.34085445094217026, 'f1-score': 0.1746925404493116, 'support': 184680}}
[[62802   112     9]
 [59871   139     4]
 [61617   118     8]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005661
{'0': {'precision': 0.3371268946252134, 'recall': 0.9978563772775991, 'f1-score': 0.5039826772871394, 'support': 19593}, '1': {'precision': 0.2972972972972973, 'recall': 0.0017624439222388379, 'f1-score': 0.0035041146801168036, 'support': 18724}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 19791}, 'accuracy': 0.3370276037722861, 'macro avg': {'precision': 0.21147473064083688, 'recall': 0.3332062737332793, 'f1-score': 0.1691622639890854, 'support': 58108}, 'weighted avg': {'precision': 0.20947067255776142, 'recall': 0.3370276037722861, 'f1-score': 0.1710632553066261, 'support': 58108}}
[[19551    40     2]
 [18689    33     2]
 [19753    38     0]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/EXC
Evaluating performance on  test set...
5343/5343 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000904
{'0': {'precision': 0.2564312122695861, 'recall': 0.9975449521821697, 'f1-score': 0.40798488620924905, 'support': 350706}, '1': {'precision': 0.49571603427172584, 'recall': 0.00243355786159365, 'f1-score': 0.004843338914135374, 'support': 665692}, '2': {'precision': 0.27848101265822783, 'recall': 0.00018782495852198833, 'f1-score': 0.0003753967260855222, 'support': 351391}, 'accuracy': 0.2570067459235306, 'macro avg': {'precision': 0.3435427530665132, 'recall': 0.33338877833409514, 'f1-score': 0.13773454061648996, 'support': 1367789}, 'weighted avg': {'precision': 0.37855391769901536, 'recall': 0.2570067459235306, 'f1-score': 0.10706244201576809, 'support': 1367789}}
[[349845    805     56]
 [663957   1620    115]
 [350482    843     66]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1020311
{'0': {'precision': 0.32170294397076366, 'recall': 0.9978252068877863, 'f1-score': 0.4865425666215255, 'support': 106217}, '1': {'precision': 0.34738372093023256, 'recall': 0.002182827812331607, 'f1-score': 0.0043383947939262466, 'support': 109491}, '2': {'precision': 0.4166666666666667, 'recall': 0.0001310398448488237, 'f1-score': 0.00026199729269464216, 'support': 114469}, 'accuracy': 0.3217668099231624, 'macro avg': {'precision': 0.36191777718922097, 'recall': 0.3333796915149889, 'f1-score': 0.16371431956938212, 'support': 330177}, 'weighted avg': {'precision': 0.363141979165058, 'recall': 0.3217668099231624, 'f1-score': 0.1580488572835716, 'support': 330177}}
[[105986    219     12]
 [109243    239      9]
 [114224    230     15]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999779
{'0': {'precision': 0.31214709089535, 'recall': 0.9972062221915635, 'f1-score': 0.4754637547691093, 'support': 28993}, '1': {'precision': 0.4019138755980861, 'recall': 0.002387720295622513, 'f1-score': 0.004747237842267372, 'support': 35180}, '2': {'precision': 0.5, 'recall': 0.00020927069163963587, 'f1-score': 0.00041836627967785795, 'support': 28671}, 'accuracy': 0.31237344362586705, 'macro avg': {'precision': 0.40468698883114534, 'recall': 0.3332677377262752, 'f1-score': 0.16020978629701818, 'support': 92844}, 'weighted avg': {'precision': 0.40417162929074096, 'recall': 0.31237344362586705, 'f1-score': 0.1504041558842402, 'support': 92844}}
[[28912    79     2]
 [35092    84     4]
 [28619    46     6]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/AAL
Evaluating performance on  test set...
7177/7177 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987262
{'0': {'precision': 0.40347907738632416, 'recall': 0.9982071068181205, 'f1-score': 0.5746731144789577, 'support': 741260}, '1': {'precision': 0.2266222961730449, 'recall': 0.001684976247030879, 'f1-score': 0.003345081232424202, 'support': 404160}, '2': {'precision': 0.3864734299516908, 'recall': 0.00011566226041647089, 'f1-score': 0.00023125531164543933, 'support': 691669}, 'accuracy': 0.40318786950441704, 'macro avg': {'precision': 0.33885826783701994, 'recall': 0.3333359151085226, 'f1-score': 0.1927498170076758, 'support': 1837089}, 'weighted avg': {'precision': 0.3581678726212723, 'recall': 0.40318786950441704, 'f1-score': 0.23270189577081962, 'support': 1837089}}
[[739931   1249     80]
 [403432    681     47]
 [690514   1075     80]]
Evaluating performance on  train set...
2257/2257 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099643
{'0': {'precision': 0.34328873378684494, 'recall': 0.9981088686495809, 'f1-score': 0.5108694529911, 'support': 198294}, '1': {'precision': 0.3295687885010267, 'recall': 0.0017148443551704426, 'f1-score': 0.0034119353964381944, 'support': 187189}, '2': {'precision': 0.30158730158730157, 'recall': 9.891093850863128e-05, 'f1-score': 0.0001977570190731441, 'support': 192092}, 'accuracy': 0.3432610483486993, 'macro avg': {'precision': 0.32481494129172445, 'recall': 0.33330754131442003, 'f1-score': 0.17149304846887045, 'support': 577575}, 'weighted avg': {'precision': 0.3249729577366667, 'recall': 0.3432610483486993, 'f1-score': 0.17656410271851938, 'support': 577575}}
[[197919    352     23]
 [186847    321     21]
 [191772    301     19]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984635
{'0': {'precision': 0.4079932775995633, 'recall': 0.9982741284348596, 'f1-score': 0.5792484869595507, 'support': 66633}, '1': {'precision': 0.2379182156133829, 'recall': 0.001845337639121158, 'f1-score': 0.0036622700351921266, 'support': 34682}, '2': {'precision': 0.22727272727272727, 'recall': 8.06282553658104e-05, 'f1-score': 0.00016119932296284356, 'support': 62013}, 'accuracy': 0.407688822492163, 'macro avg': {'precision': 0.2910614068285578, 'recall': 0.33340003144311553, 'f1-score': 0.19435731877256857, 'support': 163328}, 'weighted avg': {'precision': 0.30326189787763685, 'recall': 0.407688822492163, 'f1-score': 0.23715514629794748, 'support': 163328}}
[[66518   105    10]
 [34611    64     7]
 [61908   100     5]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/WBA
Evaluating performance on  test set...
5696/5696 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1006316
{'0': {'precision': 0.34682010602739555, 'recall': 0.9977754312697245, 'f1-score': 0.5147251664394429, 'support': 505716}, '1': {'precision': 0.3058501539514198, 'recall': 0.002022363631839333, 'f1-score': 0.004018158119466044, 'support': 442057}, '2': {'precision': 0.3556701030927835, 'recall': 0.00013522756447317106, 'f1-score': 0.000270352339625229, 'support': 510251}, 'accuracy': 0.3467391483267765, 'macro avg': {'precision': 0.3361134543571996, 'recall': 0.333311007488679, 'f1-score': 0.17300455896617806, 'support': 1458024}, 'weighted avg': {'precision': 0.3374956132534506, 'recall': 0.3467391483267765, 'f1-score': 0.17984543103992268, 'support': 1458024}}
[[504591   1056     69]
 [441107    894     56]
 [509209    973     69]]
Evaluating performance on  train set...
2222/2222 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992509
{'0': {'precision': 0.3339318564672216, 'recall': 0.9980934423898331, 'f1-score': 0.5004337326490437, 'support': 189871}, '1': {'precision': 0.37107516650808753, 'recall': 0.001979474373420227, 'f1-score': 0.003937942071862394, 'support': 197022}, '2': {'precision': 0.3, 'recall': 9.905021846075961e-05, 'f1-score': 0.00019803505220424017, 'support': 181726}, 'accuracy': 0.3339969294026404, 'macro avg': {'precision': 0.33500234099176973, 'recall': 0.3333906556605714, 'f1-score': 0.16818990325770344, 'support': 568619}, 'weighted avg': {'precision': 0.33595737563297084, 'recall': 0.3339969294026404, 'f1-score': 0.16853060237625883, 'support': 568619}}
[[189509    338     24]
 [196614    390     18]
 [181385    323     18]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982522
{'0': {'precision': 0.3561635462319452, 'recall': 0.9984749044673304, 'f1-score': 0.525040999116942, 'support': 58357}, '1': {'precision': 0.33043478260869563, 'recall': 0.0014639878257854486, 'f1-score': 0.002915060506683543, 'support': 51913}, '2': {'precision': 0.5, 'recall': 0.00016798252981689904, 'f1-score': 0.0003358522250209908, 'support': 53577}, 'accuracy': 0.3561432311851911, 'macro avg': {'precision': 0.3955327762802136, 'recall': 0.33336895827431096, 'f1-score': 0.17609730394954884, 'support': 163847}, 'weighted avg': {'precision': 0.39504535900579707, 'recall': 0.3561432311851911, 'f1-score': 0.1880360401851166, 'support': 163847}}
[[58268    86     3]
 [51831    76     6]
 [53500    68     9]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/ATVI
Evaluating performance on  test set...
12066/12066 - 170s - 170s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022815
{'0': {'precision': 0.31174430030777056, 'recall': 0.9979479191006568, 'f1-score': 0.47508043672146444, 'support': 962925}, '1': {'precision': 0.3660428258303827, 'recall': 0.002009002106167109, 'f1-score': 0.003996072032373521, 'support': 1080636}, '2': {'precision': 0.30952380952380953, 'recall': 0.00012436847125318456, 'f1-score': 0.0002486370386946173, 'support': 1045281}, 'accuracy': 0.3118482589915574, 'macro avg': {'precision': 0.3291036452206543, 'recall': 0.3333604298926924, 'f1-score': 0.15977504859751085, 'support': 3088842}, 'weighted avg': {'precision': 0.32998929458054466, 'recall': 0.3118482589915574, 'f1-score': 0.14958519224979325, 'support': 3088842}}
[[ 960949    1833     143]
 [1078318    2171     147]
 [1043224    1927     130]]
Evaluating performance on  train set...
2948/2948 - 49s - 49s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003791
{'0': {'precision': 0.33449577761812244, 'recall': 0.9981533218411301, 'f1-score': 0.501074246336621, 'support': 252345}, '1': {'precision': 0.32558139534883723, 'recall': 0.0017969884399091879, 'f1-score': 0.0035742494475072004, 'support': 249306}, '2': {'precision': 0.3157894736842105, 'recall': 0.0001186563356550423, 'f1-score': 0.00023722353573772564, 'support': 252831}, 'accuracy': 0.33447716446515624, 'macro avg': {'precision': 0.3252888822170567, 'recall': 0.3333563222055648, 'f1-score': 0.16829523977328864, 'support': 754482}, 'weighted avg': {'precision': 0.32528158494561166, 'recall': 0.33447716446515624, 'f1-score': 0.1688504695782523, 'support': 754482}}
[[251879    434     32]
 [248825    448     33]
 [252307    494     30]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992582
{'0': {'precision': 0.32943317586658205, 'recall': 0.9980090189738791, 'f1-score': 0.4953545727896213, 'support': 58765}, '1': {'precision': 0.3743016759776536, 'recall': 0.0021150992833917355, 'f1-score': 0.004206428930185837, 'support': 63354}, '2': {'precision': 0.4, 'recall': 0.0001066079138608056, 'f1-score': 0.00021315901662640328, 'support': 56281}, 'accuracy': 0.3295291479820628, 'macro avg': {'precision': 0.3679116172814119, 'recall': 0.3334102420570439, 'f1-score': 0.1665913869121445, 'support': 178400}, 'weighted avg': {'precision': 0.36762919820452894, 'recall': 0.3295291479820628, 'f1-score': 0.16473095499461793, 'support': 178400}}
[[58648   114     3]
 [63214   134     6]
 [56165   110     6]]
testing model on single stock: results/universal/W1/deepVOL_L3/h1000/AAPL
Evaluating performance on  test set...
21353/21353 - 302s - 302s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1010675
{'0': {'precision': 0.3740707027372153, 'recall': 0.9982794550401257, 'f1-score': 0.5442154761431833, 'support': 2044701}, '1': {'precision': 0.24709989863723392, 'recall': 0.001640067277144459, 'f1-score': 0.0032585069829923455, 'support': 1337750}, '2': {'precision': 0.3751891074130106, 'recall': 0.00011901528290604607, 'f1-score': 0.00023795508309957606, 'support': 2083766}, 'accuracy': 0.373864594105942, 'macro avg': {'precision': 0.3321199029291533, 'recall': 0.33334617920005877, 'f1-score': 0.1825706460697584, 'support': 5466217}, 'weighted avg': {'precision': 0.3434234196990398, 'recall': 0.373864594105942, 'f1-score': 0.20445819086831551, 'support': 5466217}}
[[2041183    3268     250]
 [1335393    2194     163]
 [2080101    3417     248]]
Evaluating performance on  train set...
6073/6073 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1012138
{'0': {'precision': 0.3289609554172151, 'recall': 0.9979780439824321, 'f1-score': 0.49481673382483543, 'support': 511386}, '1': {'precision': 0.3298305084745763, 'recall': 0.0018957068960478505, 'f1-score': 0.0037697471014984073, 'support': 513265}, '2': {'precision': 0.35353535353535354, 'recall': 0.0001320996484262214, 'f1-score': 0.00026410061478850257, 'support': 529903}, 'accuracy': 0.3289657355099919, 'macro avg': {'precision': 0.33744227247571495, 'recall': 0.33333528350896874, 'f1-score': 0.16628352718037412, 'support': 1554554}, 'weighted avg': {'precision': 0.33762476409544845, 'recall': 0.3289657355099919, 'f1-score': 0.1641095627413883, 'support': 1554554}}
[[510352    981     53]
 [512217    973     75]
 [528837    996     70]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100562
{'0': {'precision': 0.34533512458003957, 'recall': 0.9980681407913655, 'f1-score': 0.5131266159968217, 'support': 157879}, '1': {'precision': 0.30668257756563244, 'recall': 0.0018312799720676361, 'f1-score': 0.0036408196802595327, 'support': 140339}, '2': {'precision': 0.3225806451612903, 'recall': 0.00012580594433086962, 'f1-score': 0.00025151379867577984, 'support': 158975}, 'accuracy': 0.3452611916630395, 'macro avg': {'precision': 0.32486611576898744, 'recall': 0.33334174223592133, 'f1-score': 0.17233964982525238, 'support': 457193}, 'weighted avg': {'precision': 0.3255582400672615, 'recall': 0.3452611916630395, 'f1-score': 0.17839916710495274, 'support': 457193}}
[[157574    283     22]
 [140062    257     20]
 [158657    298     20]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        84 (peak)  21.23 (ave)

============================================
