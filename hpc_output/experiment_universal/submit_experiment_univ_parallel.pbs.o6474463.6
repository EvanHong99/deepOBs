This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W2/deepLOB_L1/h10
Epoch 1/50
9940/9940 - 191s - loss: 2.8422 - accuracy10: 0.5174 - val_loss: 3.8886 - val_accuracy10: 0.4586 - 191s/epoch - 19ms/step
Epoch 2/50
9940/9940 - 153s - loss: 2.7761 - accuracy10: 0.5361 - val_loss: 4.3430 - val_accuracy10: 0.4702 - 153s/epoch - 15ms/step
Epoch 3/50
9940/9940 - 153s - loss: 2.7405 - accuracy10: 0.5424 - val_loss: 4.4205 - val_accuracy10: 0.4778 - 153s/epoch - 15ms/step
Epoch 4/50
9940/9940 - 154s - loss: 2.7229 - accuracy10: 0.5457 - val_loss: 4.4920 - val_accuracy10: 0.4738 - 154s/epoch - 16ms/step
Epoch 5/50
9940/9940 - 153s - loss: 2.7097 - accuracy10: 0.5485 - val_loss: 4.4413 - val_accuracy10: 0.4749 - 153s/epoch - 15ms/step
Epoch 6/50
9940/9940 - 153s - loss: 2.6986 - accuracy10: 0.5510 - val_loss: 4.5410 - val_accuracy10: 0.4796 - 153s/epoch - 15ms/step
Epoch 7/50
9940/9940 - 150s - loss: 2.6890 - accuracy10: 0.5532 - val_loss: 4.4588 - val_accuracy10: 0.4793 - 150s/epoch - 15ms/step
Epoch 8/50
9940/9940 - 153s - loss: 2.6823 - accuracy10: 0.5549 - val_loss: 4.4848 - val_accuracy10: 0.4744 - 153s/epoch - 15ms/step
Epoch 9/50
9940/9940 - 154s - loss: 2.6763 - accuracy10: 0.5562 - val_loss: 4.4664 - val_accuracy10: 0.4802 - 154s/epoch - 16ms/step
Epoch 10/50
9940/9940 - 155s - loss: 2.6697 - accuracy10: 0.5577 - val_loss: 4.4662 - val_accuracy10: 0.4769 - 155s/epoch - 16ms/step
Epoch 11/50
9940/9940 - 155s - loss: 2.6646 - accuracy10: 0.5591 - val_loss: 4.4463 - val_accuracy10: 0.4752 - 155s/epoch - 16ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 172s - 172s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1349844
{'0': {'precision': 0.3446982522855729, 'recall': 0.6343667237887521, 'f1-score': 0.4466814896696045, 'support': 1585493}, '1': {'precision': 0.6104745844772473, 'recall': 0.5056260160378766, 'f1-score': 0.553125465391103, 'support': 3511188}, '2': {'precision': 0.38164104891048634, 'recall': 0.2102570796656339, 'f1-score': 0.2711369695237302, 'support': 1624088}, 'accuracy': 0.4646206408820181, 'macro avg': {'precision': 0.44560462855776883, 'recall': 0.4500832731640876, 'f1-score': 0.4236479748614792, 'support': 6720769}, 'weighted avg': {'precision': 0.49247732651954573, 'recall': 0.4646206408820181, 'f1-score': 0.45987120971368634, 'support': 6720769}}
[[1005784  450284  129425]
 [1311984 1775348  423856]
 [ 600100  682512  341476]]
Evaluating performance on  train set...
9940/9940 - 65s - 65s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1540368
{'0': {'precision': 0.35403630671731534, 'recall': 0.5797645543663099, 'f1-score': 0.43961771754047885, 'support': 639808}, '1': {'precision': 0.5645748438383918, 'recall': 0.5292604970606327, 'f1-score': 0.546347610660022, 'support': 1261496}, '2': {'precision': 0.40722322411784423, 'recall': 0.19862529580271515, 'f1-score': 0.26701338928334106, 'support': 642320}, 'accuracy': 0.45847145647312654, 'macro avg': {'precision': 0.4419447915578505, 'recall': 0.4358834490765526, 'f1-score': 0.41765957249461394, 'support': 2543624}, 'weighted avg': {'precision': 0.4718825541221194, 'recall': 0.45847145647312654, 'f1-score': 0.44896348606782666, 'support': 2543624}}
[[370938 214098  54772]
 [462894 667660 130942]
 [213908 300831 127581]]
Evaluating performance on  val set...
3393/3393 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1681432
{'0': {'precision': 0.3587716012183006, 'recall': 0.6041220997202567, 'f1-score': 0.4501885365679192, 'support': 218772}, '1': {'precision': 0.5643995473737208, 'recall': 0.530827095869795, 'f1-score': 0.5470987662523572, 'support': 426589}, '2': {'precision': 0.4018235168695617, 'recall': 0.17768917863204117, 'f1-score': 0.24641286108767593, 'support': 222726}, 'accuracy': 0.4586936562809949, 'macro avg': {'precision': 0.4416648884871943, 'recall': 0.4375461247406976, 'f1-score': 0.41456672130265076, 'support': 868087}, 'weighted avg': {'precision': 0.47086566654566675, 'recall': 0.4586936562809949, 'f1-score': 0.44552851617116407, 'support': 868087}}
[[132165  70433  16174]
 [157403 226445  42741]
 [ 78814 104336  39576]]
testing model out of sample: results/universal/W2/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 87s - 87s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0239303
{'0': {'precision': 0.35160836354656577, 'recall': 0.6010882627373754, 'f1-score': 0.44368302474736965, 'support': 833806}, '1': {'precision': 0.6341820306873318, 'recall': 0.5528382480679854, 'f1-score': 0.5907229877639719, 'support': 2010078}, '2': {'precision': 0.4281911032501457, 'recall': 0.2544926225832443, 'f1-score': 0.3192443959314096, 'support': 822849}, 'accuracy': 0.49685864773900906, 'macro avg': {'precision': 0.4713271658280144, 'recall': 0.46947304446286836, 'f1-score': 0.4512168028142503, 'support': 3666733}, 'weighted avg': {'precision': 0.5236991982163735, 'recall': 0.49685864773900906, 'f1-score': 0.49636414265202805, 'support': 3666733}}
[[ 501191  266788   65827]
 [ 685011 1111248  213819]
 [ 239222  374218  209409]]
Evaluating performance on  train set...
5373/5373 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94998324
{'0': {'precision': 0.32806719238819493, 'recall': 0.5617938028513456, 'f1-score': 0.41423574375886635, 'support': 261701}, '1': {'precision': 0.7129750526627322, 'recall': 0.6283052579653088, 'f1-score': 0.6679677183605746, 'support': 847362}, '2': {'precision': 0.3847444351241299, 'recall': 0.2605396702391387, 'f1-score': 0.31068853988632744, 'support': 265829}, 'accuracy': 0.5445394983751451, 'macro avg': {'precision': 0.47526222672501905, 'recall': 0.4835462436852644, 'f1-score': 0.4642973340019228, 'support': 1374892}, 'weighted avg': {'precision': 0.5762486852306897, 'recall': 0.5445394983751451, 'f1-score': 0.5505933513412944, 'support': 1374892}}
[[147022  88847  25832]
 [230038 532402  84922]
 [ 71086 125484  69259]]
Evaluating performance on  val set...
1685/1685 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9985035
{'0': {'precision': 0.31511082349134445, 'recall': 0.6579548909432815, 'f1-score': 0.42613505836192783, 'support': 88807}, '1': {'precision': 0.6857302096370463, 'recall': 0.5532319391634981, 'f1-score': 0.6123961962643754, 'support': 253532}, '2': {'precision': 0.4436827362523957, 'recall': 0.20441963931939366, 'f1-score': 0.27988622889073167, 'support': 88333}, 'accuracy': 0.5032832410744139, 'macro avg': {'precision': 0.4815079231269288, 'recall': 0.4718688231420578, 'f1-score': 0.4394724945056783, 'support': 430672}, 'weighted avg': {'precision': 0.5596612399990674, 'recall': 0.5032832410744139, 'f1-score': 0.505788625255072, 'support': 430672}}
[[ 58431  24707   5669]
 [ 96298 140262  16972]
 [ 30701  39575  18057]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2844585
{'0': {'precision': 0.32963169548535404, 'recall': 0.5572, 'f1-score': 0.41421789875003984, 'support': 70000}, '1': {'precision': 0.47000148049448515, 'recall': 0.4490315508446857, 'f1-score': 0.4592772762002071, 'support': 113119}, '2': {'precision': 0.37414262175729013, 'recall': 0.14074031365313652, 'f1-score': 0.2045395033150734, 'support': 69376}, 'accuracy': 0.39431275866848847, 'macro avg': {'precision': 0.39125859924570977, 'recall': 0.3823239548326074, 'f1-score': 0.3593448927551068, 'support': 252495}, 'weighted avg': {'precision': 0.4047479541498414, 'recall': 0.39431275866848847, 'f1-score': 0.3767930917482744, 'support': 252495}}
[[39004 25778  5218]
 [51210 50794 11115]
 [28112 31500  9764]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2811729
{'0': {'precision': 0.34562851508290116, 'recall': 0.5472734632510264, 'f1-score': 0.42368214885282596, 'support': 17293}, '1': {'precision': 0.4584058888712997, 'recall': 0.4504725236261813, 'f1-score': 0.45440458209921347, 'support': 25713}, '2': {'precision': 0.38762834326277096, 'recall': 0.17441396224262817, 'f1-score': 0.2405790260404374, 'support': 17533}, 'accuracy': 0.39817307851137285, 'macro avg': {'precision': 0.3972209157389906, 'recall': 0.39071998303994526, 'f1-score': 0.372888585664159, 'support': 60539}, 'weighted avg': {'precision': 0.40569273153343305, 'recall': 0.39817307851137285, 'f1-score': 0.3837016218172746, 'support': 60539}}
[[ 9464  6115  1714]
 [11013 11583  3117]
 [ 6905  7570  3058]]
Evaluating performance on  val set...
85/85 - 1s - 610ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2650423
{'0': {'precision': 0.33181670458238544, 'recall': 0.5349283967865875, 'f1-score': 0.4095741124557064, 'support': 5726}, '1': {'precision': 0.4988949745363698, 'recall': 0.5203969128996693, 'f1-score': 0.5094191522762951, 'support': 9977}, '2': {'precision': 0.3766564729867482, 'recall': 0.12531795828387315, 'f1-score': 0.1880646392670823, 'support': 5897}, 'accuracy': 0.41638888888888886, 'macro avg': {'precision': 0.4024560507018345, 'recall': 0.3935477559900433, 'f1-score': 0.3690193013330279, 'support': 21600}, 'weighted avg': {'precision': 0.421231520027359, 'recall': 0.41638888888888886, 'f1-score': 0.39521821425647935, 'support': 21600}}
[[3063 2233  430]
 [3992 5192  793]
 [2176 2982  739]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8649336
{'0': {'precision': 0.285568746045534, 'recall': 0.529603627612816, 'f1-score': 0.3710583153347732, 'support': 50281}, '1': {'precision': 0.7556781137439745, 'recall': 0.6505520794994479, 'f1-score': 0.6991856250710785, 'support': 217360}, '2': {'precision': 0.40873143101421394, 'recall': 0.30499621197017424, 'f1-score': 0.34932523462653847, 'support': 50158}, 'accuracy': 0.5768772085500584, 'macro avg': {'precision': 0.48332609693457423, 'recall': 0.4950506396941461, 'f1-score': 0.47318972501079676, 'support': 317799}, 'weighted avg': {'precision': 0.6265407633130272, 'recall': 0.5768772085500584, 'f1-score': 0.5920522900864864, 'support': 317799}}
[[ 26629  20318   3334]
 [ 57160 141404  18796]
 [  9460  25400  15298]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90407586
{'0': {'precision': 0.20050470291351227, 'recall': 0.7617506069849965, 'f1-score': 0.3174512576372764, 'support': 16063}, '1': {'precision': 0.8482582168864397, 'recall': 0.503735159194725, 'f1-score': 0.6320999725014512, 'support': 102673}, '2': {'precision': 0.3398110870238464, 'recall': 0.27129435035233035, 'f1-score': 0.3017116931326047, 'support': 16178}, 'accuracy': 0.5065819707369139, 'macro avg': {'precision': 0.46285800227459944, 'recall': 0.5122600388440173, 'f1-score': 0.4170876410904441, 'support': 134914}, 'weighted avg': {'precision': 0.7101663779233657, 'recall': 0.5065819707369139, 'f1-score': 0.5550195813597428, 'support': 134914}}
[[12236  2999   828]
 [43254 51720  7699]
 [ 5536  6253  4389]]
Evaluating performance on  val set...
159/159 - 1s - 958ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.882249
{'0': {'precision': 0.22668438691783196, 'recall': 0.7294533283748605, 'f1-score': 0.3458825603949921, 'support': 5378}, '1': {'precision': 0.8143833259597896, 'recall': 0.5518838069222826, 'f1-score': 0.657916683213534, 'support': 30019}, '2': {'precision': 0.34046164290563474, 'recall': 0.1929588303193536, 'f1-score': 0.2463163064833006, 'support': 5198}, 'accuracy': 0.529449439586156, 'macro avg': {'precision': 0.4605097852610854, 'recall': 0.49143198853883224, 'f1-score': 0.4167051833639423, 'support': 40595}, 'weighted avg': {'precision': 0.6758418848295237, 'recall': 0.529449439586156, 'f1-score': 0.5638750950681498, 'support': 40595}}
[[ 3923  1298   157]
 [11666 16567  1786]
 [ 1717  2478  1003]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2190361
{'0': {'precision': 0.4549464714695863, 'recall': 0.5885117210762817, 'f1-score': 0.5131807538333711, 'support': 92355}, '1': {'precision': 0.3937213660974594, 'recall': 0.44596060856233044, 'f1-score': 0.41821600398164016, 'support': 84790}, '2': {'precision': 0.48047833197056417, 'recall': 0.2905797997280257, 'f1-score': 0.3621446729835914, 'support': 97068}, 'accuracy': 0.43896897667141965, 'macro avg': {'precision': 0.4430487231792033, 'recall': 0.4416840431222126, 'f1-score': 0.43118047693286754, 'support': 274213}, 'weighted avg': {'precision': 0.44505288491682, 'recall': 0.43896897667141965, 'f1-score': 0.4303515975356949, 'support': 274213}}
[[54352 24907 13096]
 [29575 37813 17402]
 [35542 33320 28206]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2245175
{'0': {'precision': 0.42189557495023733, 'recall': 0.5962262517851733, 'f1-score': 0.4941357913991607, 'support': 23107}, '1': {'precision': 0.43968558951965064, 'recall': 0.46215987955788934, 'f1-score': 0.450642701135021, 'support': 27233}, '2': {'precision': 0.44564477713507994, 'recall': 0.23083362707084948, 'f1-score': 0.30413328689190755, 'support': 22696}, 'accuracy': 0.4326907278602333, 'macro avg': {'precision': 0.4357419805349893, 'recall': 0.4297399194713041, 'f1-score': 0.416303926475363, 'support': 73036}, 'weighted avg': {'precision': 0.4359090389892869, 'recall': 0.4326907278602333, 'f1-score': 0.4188750409547232, 'support': 73036}}
[[13777  6974  2356]
 [10486 12586  4161]
 [ 8392  9065  5239]]
Evaluating performance on  val set...
117/117 - 1s - 772ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2168239
{'0': {'precision': 0.426296668470279, 'recall': 0.5991309071156979, 'f1-score': 0.49814831541866134, 'support': 9205}, '1': {'precision': 0.45232635549966715, 'recall': 0.5311387127594893, 'f1-score': 0.48857462448066474, 'support': 11513}, '2': {'precision': 0.45064121682075753, 'recall': 0.16620833791662085, 'f1-score': 0.24284795885567342, 'support': 9091}, 'accuracy': 0.4408400147606428, 'macro avg': {'precision': 0.4430880802635679, 'recall': 0.4321593192639361, 'f1-score': 0.40985696625166645, 'support': 29809}, 'weighted avg': {'precision': 0.44377447972941375, 'recall': 0.4408400147606428, 'f1-score': 0.416590482372156, 'support': 29809}}
[[5515 3070  620]
 [4176 6115 1222]
 [3246 4334 1511]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3359917
{'0': {'precision': 0.41527297709268124, 'recall': 0.4954979186679475, 'f1-score': 0.4518521546664486, 'support': 78075}, '1': {'precision': 0.30387217300234937, 'recall': 0.3284333221158259, 'f1-score': 0.3156757233592096, 'support': 65374}, '2': {'precision': 0.37222063854047893, 'recall': 0.27311588992744623, 'f1-score': 0.3150584740203434, 'support': 76495}, 'accuracy': 0.3684983450332812, 'macro avg': {'precision': 0.3637885962118365, 'recall': 0.36568237690373984, 'f1-score': 0.36086211734866724, 'support': 219944}, 'weighted avg': {'precision': 0.36718798816753634, 'recall': 0.3684983450332812, 'f1-score': 0.363800511424063, 'support': 219944}}
[[38686 23061 16328]
 [24995 21471 18908]
 [29477 26126 20892]]
Evaluating performance on  train set...
320/320 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3691615
{'0': {'precision': 0.39807469471432394, 'recall': 0.4804733727810651, 'f1-score': 0.4354099639270742, 'support': 27885}, '1': {'precision': 0.3364617396991498, 'recall': 0.3789268220822745, 'f1-score': 0.3564339286023592, 'support': 27153}, '2': {'precision': 0.3776440240756664, 'recall': 0.24726017114547366, 'f1-score': 0.298850053301277, 'support': 26644}, 'accuracy': 0.3706446952817022, 'macro avg': {'precision': 0.37072681949638003, 'recall': 0.3688867886696044, 'f1-score': 0.3635646486102368, 'support': 81682}, 'weighted avg': {'precision': 0.3709287952992335, 'recall': 0.3706446952817022, 'f1-score': 0.36461176425167785, 'support': 81682}}
[[13398  9831  4656]
 [10663 10289  6201]
 [ 9596 10460  6588]]
Evaluating performance on  val set...
98/98 - 1s - 661ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3502586
{'0': {'precision': 0.41183152743795876, 'recall': 0.5281264007171672, 'f1-score': 0.4627847604084839, 'support': 8924}, '1': {'precision': 0.33718044179697193, 'recall': 0.3312202852614897, 'f1-score': 0.3341737900498124, 'support': 8203}, '2': {'precision': 0.34273676497527017, 'recall': 0.2388307378095481, 'f1-score': 0.28150154216504925, 'support': 7834}, 'accuracy': 0.37262128921116944, 'macro avg': {'precision': 0.3639162447367336, 'recall': 0.36605914126273503, 'f1-score': 0.35948669754111523, 'support': 24961}, 'weighted avg': {'precision': 0.36561337813922407, 'recall': 0.37262128921116944, 'f1-score': 0.3636233277106252, 'support': 24961}}
[[4713 2578 1633]
 [3531 2717 1955]
 [3200 2763 1871]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2007148
{'0': {'precision': 0.4404896253505704, 'recall': 0.5179776240498761, 'f1-score': 0.4761013372140418, 'support': 152217}, '1': {'precision': 0.4392758753074492, 'recall': 0.5733274599416331, 'f1-score': 0.49742858439569937, 'support': 181610}, '2': {'precision': 0.48534387095028014, 'recall': 0.22976193526894395, 'f1-score': 0.3118798535563034, 'support': 156092}, 'accuracy': 0.4466677144589208, 'macro avg': {'precision': 0.4550364572027666, 'recall': 0.4403556730868177, 'f1-score': 0.42846992505534814, 'support': 489919}, 'weighted avg': {'precision': 0.45433060673487813, 'recall': 0.4466677144589208, 'f1-score': 0.4316849776394124, 'support': 489919}}
[[ 78845  58264  15108]
 [ 54566 104122  22922]
 [ 45583  74645  35864]]
Evaluating performance on  train set...
716/716 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1878195
{'0': {'precision': 0.4034331134787756, 'recall': 0.6324111420401826, 'f1-score': 0.492613816551246, 'support': 52809}, '1': {'precision': 0.5262002495977867, 'recall': 0.45794893939988746, 'f1-score': 0.4897079607629123, 'support': 76419}, '2': {'precision': 0.4223826714801444, 'recall': 0.2650450283167765, 'f1-score': 0.3257082225695673, 'support': 53855}, 'accuracy': 0.45152744929895183, 'macro avg': {'precision': 0.45067201151890224, 'recall': 0.45180170325228214, 'f1-score': 0.43600999996124185, 'support': 183083}, 'weighted avg': {'precision': 0.46025035058567476, 'recall': 0.45152744929895183, 'f1-score': 0.4423045941910488, 'support': 183083}}
[[33397 12688  6724]
 [28627 34996 12796]
 [20758 18823 14274]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2635909
{'0': {'precision': 0.420506095832152, 'recall': 0.6526402640264026, 'f1-score': 0.5114665057332528, 'support': 18180}, '1': {'precision': 0.4051167837359374, 'recall': 0.38592100968338594, 'f1-score': 0.395285988911487, 'support': 18382}, '2': {'precision': 0.4633135431836003, 'recall': 0.2286093300906478, 'f1-score': 0.30615492801362004, 'support': 18092}, 'accuracy': 0.4225674241592564, 'macro avg': {'precision': 0.42964547425056326, 'recall': 0.42239020126681215, 'f1-score': 0.40430247421945326, 'support': 54654}, 'weighted avg': {'precision': 0.429500606801702, 'recall': 0.4225674241592564, 'f1-score': 0.4044271797128097, 'support': 54654}}
[[11865  4315  2000]
 [ 8497  7094  2791]
 [ 7854  6102  4136]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
4918/4918 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91130877
{'0': {'precision': 0.23634727266883096, 'recall': 0.8086051067046978, 'f1-score': 0.36578051863056166, 'support': 145495}, '1': {'precision': 0.900239017838369, 'recall': 0.4338315350852251, 'f1-score': 0.5855043786050841, 'support': 967145}, '2': {'precision': 0.28593947570926376, 'recall': 0.5769464907420707, 'f1-score': 0.3823721406747237, 'support': 146199}, 'accuracy': 0.49376846443429223, 'macro avg': {'precision': 0.4741752554054879, 'recall': 0.6064610441773312, 'f1-score': 0.4445523459701232, 'support': 1258839}, 'weighted avg': {'precision': 0.7521637610158722, 'recall': 0.49376846443429223, 'f1-score': 0.5365176113853094, 'support': 1258839}}
[[117648  13345  14502]
 [351429 419578 196138]
 [ 28699  33151  84349]]
Evaluating performance on  train set...
1403/1403 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.84054834
{'0': {'precision': 0.20322812152596992, 'recall': 0.8016652789342215, 'f1-score': 0.3242551471743866, 'support': 36030}, '1': {'precision': 0.8927634672011482, 'recall': 0.5033921775861648, 'f1-score': 0.6437822996335378, 'support': 286689}, '2': {'precision': 0.32254266149777183, 'recall': 0.4910234135848432, 'f1-score': 0.389337764997868, 'support': 36261}, 'accuracy': 0.532079781603432, 'macro avg': {'precision': 0.4728447500749633, 'recall': 0.5986936233684098, 'f1-score': 0.45245840393526415, 'support': 358980}, 'weighted avg': {'precision': 0.7659576976867272, 'recall': 0.532079781603432, 'f1-score': 0.5860103441665836, 'support': 358980}}
[[ 28884   5124   2022]
 [106997 144317  35375]
 [  6245  12211  17805]]
Evaluating performance on  val set...
480/480 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8495313
{'0': {'precision': 0.21952946075369562, 'recall': 0.7881596651218419, 'f1-score': 0.3434080250130276, 'support': 13378}, '1': {'precision': 0.8900057219149342, 'recall': 0.48553680311322917, 'f1-score': 0.6283055959498034, 'support': 96106}, '2': {'precision': 0.31626005301702836, 'recall': 0.5319277563666591, 'f1-score': 0.3966751197520429, 'support': 13233}, 'accuracy': 0.5235297473047744, 'macro avg': {'precision': 0.475265078561886, 'recall': 0.6018747415339101, 'f1-score': 0.45612958023829125, 'support': 122717}, 'weighted avg': {'precision': 0.755044731519626, 'recall': 0.5235297473047744, 'f1-score': 0.5722699546326497, 'support': 122717}}
[[10544  1905   929]
 [35154 46663 14289]
 [ 2332  3862  7039]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
4856/4856 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93284243
{'0': {'precision': 0.32533136621235537, 'recall': 0.5640214690550043, 'f1-score': 0.4126458427393484, 'support': 246308}, '1': {'precision': 0.6705870724044198, 'recall': 0.6232486049209673, 'f1-score': 0.6460518359148352, 'support': 761964}, '2': {'precision': 0.4562250487419924, 'recall': 0.20943345565201826, 'f1-score': 0.2870805011348268, 'support': 234633}, 'accuracy': 0.5333923348928519, 'macro avg': {'precision': 0.48404782911958916, 'recall': 0.46556784320933, 'f1-score': 0.44859272659633675, 'support': 1242905}, 'weighted avg': {'precision': 0.5617005145590968, 'recall': 0.5333923348928519, 'f1-score': 0.5320316295752473, 'support': 1242905}}
[[138923  97044  10341]
 [238842 474893  48229]
 [ 49255 136238  49140]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80169874
{'0': {'precision': 0.27437010105748744, 'recall': 0.3856817057756773, 'f1-score': 0.3206400694436513, 'support': 72788}, '1': {'precision': 0.7827555902743872, 'recall': 0.730641326454879, 'f1-score': 0.7558011734344778, 'support': 384001}, '2': {'precision': 0.3461369715668653, 'recall': 0.3277495611155037, 'f1-score': 0.33669241041313897, 'support': 74621}, 'accuracy': 0.6268173350143956, 'macro avg': {'precision': 0.4677542209662467, 'recall': 0.48135753111535334, 'f1-score': 0.47104455109708937, 'support': 531410}, 'weighted avg': {'precision': 0.6518109694812261, 'recall': 0.6268173350143956, 'f1-score': 0.6373449504753698, 'support': 531410}}
[[ 28073  36262   8453]
 [ 65687 280567  37747]
 [  8558  41606  24457]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8122263
{'0': {'precision': 0.2497437774524158, 'recall': 0.675043284689587, 'f1-score': 0.36459822323158103, 'support': 20215}, '1': {'precision': 0.8119194954861152, 'recall': 0.623764896237649, 'f1-score': 0.7055128310577398, 'support': 110011}, '2': {'precision': 0.45135837891150365, 'recall': 0.2506472814180442, 'f1-score': 0.32231008099369335, 'support': 20084}, 'accuracy': 0.5808063335772736, 'macro avg': {'precision': 0.5043405506166782, 'recall': 0.5164851541150934, 'f1-score': 0.4641403784276714, 'support': 150310}, 'weighted avg': {'precision': 0.6881360372642022, 'recall': 0.5808063335772736, 'f1-score': 0.6084611855950819, 'support': 150310}}
[[13646  5599   970]
 [36241 68621  5149]
 [ 4753 10297  5034]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
4353/4353 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85575813
{'0': {'precision': 0.31928146775712885, 'recall': 0.5467476417865803, 'f1-score': 0.4031420829591821, 'support': 187218}, '1': {'precision': 0.7237718454289109, 'recall': 0.7347817452544065, 'f1-score': 0.7292352411968738, 'support': 740213}, '2': {'precision': 0.45031622332235827, 'recall': 0.10174090347163874, 'f1-score': 0.16598129861966002, 'support': 186857}, 'accuracy': 0.5970332624958719, 'macro avg': {'precision': 0.49778984550279937, 'recall': 0.4610900968375418, 'f1-score': 0.4327862075919053, 'support': 1114288}, 'weighted avg': {'precision': 0.6099547921115283, 'recall': 0.5970332624958719, 'f1-score': 0.579993347855929, 'support': 1114288}}
[[102361  78507   6350]
 [179462 543895  16856]
 [ 38775 129071  19011]]
Evaluating performance on  train set...
1542/1542 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9268067
{'0': {'precision': 0.33598900240572377, 'recall': 0.43102204408817635, 'f1-score': 0.37761820320592726, 'support': 74850}, '1': {'precision': 0.6824667794612475, 'recall': 0.7252895113258931, 'f1-score': 0.7032268301139468, 'support': 247486}, '2': {'precision': 0.38491851268049654, 'recall': 0.1893336286984092, 'f1-score': 0.2538188837537354, 'support': 72227}, 'accuracy': 0.5713561585855744, 'macro avg': {'precision': 0.46779143151582264, 'recall': 0.4485483947041596, 'f1-score': 0.4448879723578698, 'support': 394563}, 'weighted avg': {'precision': 0.5622708151225253, 'recall': 0.5713561585855744, 'f1-score': 0.5591910399718801, 'support': 394563}}
[[ 32262  37652   4936]
 [ 51071 179499  16916]
 [ 12688  45864  13675]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90926224
{'0': {'precision': 0.315712187958884, 'recall': 0.5047631947266242, 'f1-score': 0.3884574625180244, 'support': 22149}, '1': {'precision': 0.6920856975151634, 'recall': 0.7145688925924523, 'f1-score': 0.703147615527491, 'support': 79203}, '2': {'precision': 0.4310682783404116, 'recall': 0.12018398761271519, 'f1-score': 0.18796296296296297, 'support': 21958}, 'accuracy': 0.5710404671154002, 'macro avg': {'precision': 0.4796220546048197, 'recall': 0.4465053583105972, 'f1-score': 0.4265226803361594, 'support': 123310}, 'weighted avg': {'precision': 0.5780015408903865, 'recall': 0.5710404671154002, 'f1-score': 0.5548831049442572, 'support': 123310}}
[[11180 10260   709]
 [19833 56596  2774]
 [ 4399 14920  2639]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.95818305
{'0': {'precision': 0.3266143500452377, 'recall': 0.6970607417395192, 'f1-score': 0.4448091839537997, 'support': 272926}, '1': {'precision': 0.7358228104755479, 'recall': 0.5097300813382531, 'f1-score': 0.6022562726951828, 'support': 868595}, '2': {'precision': 0.38791387165046454, 'recall': 0.32562104787714546, 'f1-score': 0.3540483245207655, 'support': 265680}, 'accuracy': 0.5113029339802914, 'macro avg': {'precision': 0.48345034405708337, 'recall': 0.5108039569849726, 'f1-score': 0.4670379270565827, 'support': 1407201}, 'weighted avg': {'precision': 0.5907716947227514, 'recall': 0.5113029339802914, 'f1-score': 0.5248577405645135, 'support': 1407201}}
[[190246  60674  22006]
 [311347 442749 114499]
 [ 80886  98283  86511]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9410764
{'0': {'precision': 0.3072004092594961, 'recall': 0.6525537072640643, 'f1-score': 0.4177419246951485, 'support': 95704}, '1': {'precision': 0.719668039249389, 'recall': 0.5766506185702823, 'f1-score': 0.6402700717066311, 'support': 333996}, '2': {'precision': 0.39888745796665953, 'recall': 0.22961368971623902, 'f1-score': 0.2914553818809138, 'support': 97124}, 'accuracy': 0.5264604497896831, 'macro avg': {'precision': 0.4752519688251815, 'recall': 0.48627267185019524, 'f1-score': 0.44982245942756444, 'support': 526824}, 'weighted avg': {'precision': 0.5855999344609653, 'recall': 0.5264604497896831, 'f1-score': 0.5355384882627866, 'support': 526824}}
[[ 62452  26764   6488]
 [114278 192599  27119]
 [ 26564  48259  22301]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0064217
{'0': {'precision': 0.30253503581438806, 'recall': 0.6844790169386432, 'f1-score': 0.41960675904488753, 'support': 35481}, '1': {'precision': 0.677434522372317, 'recall': 0.5143127285357312, 'f1-score': 0.5847098826368322, 'support': 103649}, '2': {'precision': 0.43109632818104743, 'recall': 0.1879496147175069, 'f1-score': 0.26177181101738545, 'support': 35169}, 'accuracy': 0.4831008783756648, 'macro avg': {'precision': 0.47035529545591753, 'recall': 0.4622471200639604, 'f1-score': 0.42202948423303505, 'support': 174299}, 'weighted avg': {'precision': 0.5514138530966779, 'recall': 0.4831008783756648, 'f1-score': 0.48594033737868314, 'support': 174299}}
[[24286  9521  1674]
 [43292 53308  7049]
 [12697 15862  6610]]
testing model on single stock: results/universal/W2/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 98s - 98s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3015307
{'0': {'precision': 0.3765612791788504, 'recall': 0.640788528170868, 'f1-score': 0.47436220286855224, 'support': 1124424}, '1': {'precision': 0.45290595570148623, 'recall': 0.42656939469961136, 'f1-score': 0.43934334098465, 'support': 1521096}, '2': {'precision': 0.43528156260779577, 'recall': 0.17339800872396358, 'f1-score': 0.24800226505156864, 'support': 1164379}, 'accuracy': 0.412418281954456, 'macro avg': {'precision': 0.4215829324960441, 'recall': 0.4135853105314809, 'f1-score': 0.3872359363015903, 'support': 3809899}, 'weighted avg': {'precision': 0.42498782460133727, 'recall': 0.412418281954456, 'f1-score': 0.3912009934056353, 'support': 3809899}}
[[720518 315078  88828]
 [699132 648853 173111]
 [493765 468713 201901]]
Evaluating performance on  train set...
6147/6147 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2928637
{'0': {'precision': 0.3977035154417582, 'recall': 0.5856200255680647, 'f1-score': 0.4737060248600009, 'support': 484980}, '1': {'precision': 0.42296697792028987, 'recall': 0.4720039498238479, 'f1-score': 0.4461420545282975, 'support': 597495}, '2': {'precision': 0.44341170606073194, 'recall': 0.17391499154803364, 'f1-score': 0.2498383543448304, 'support': 491010}, 'accuracy': 0.41400331112149147, 'macro avg': {'precision': 0.42136073314092665, 'recall': 0.41051298897998206, 'f1-score': 0.3898954779110429, 'support': 1573485}, 'weighted avg': {'precision': 0.42156009570113945, 'recall': 0.41400331112149147, 'f1-score': 0.3933807600160431, 'support': 1573485}}
[[284014 158714  42252]
 [250537 282020  64938]
 [179584 226032  85394]]
Evaluating performance on  val set...
2174/2174 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3082002
{'0': {'precision': 0.3967642256781137, 'recall': 0.6027003190425173, 'f1-score': 0.4785160747602062, 'support': 168943}, '1': {'precision': 0.4347389853277639, 'recall': 0.4860507467450178, 'f1-score': 0.45896517108648394, 'support': 213058}, '2': {'precision': 0.4383310631121489, 'recall': 0.15490278104101363, 'f1-score': 0.22891040813647737, 'support': 174503}, 'accuracy': 0.4176250305478487, 'macro avg': {'precision': 0.42327809137267547, 'recall': 0.41455128227618293, 'f1-score': 0.3887972179943892, 'support': 556504}, 'weighted avg': {'precision': 0.4243370089360716, 'recall': 0.4176250305478487, 'f1-score': 0.39276212855720233, 'support': 556504}}
[[101822  54356  12765]
 [ 87629 103557  21872]
 [ 67180  80292  27031]]
training model: results/universal/W2/deepLOB_L1/h20
Epoch 1/50
9940/9940 - 152s - loss: 2.9106 - accuracy20: 0.5029 - val_loss: 3.8407 - val_accuracy20: 0.4377 - 152s/epoch - 15ms/step
Epoch 2/50
9940/9940 - 153s - loss: 2.8331 - accuracy20: 0.5241 - val_loss: 4.0731 - val_accuracy20: 0.4505 - 153s/epoch - 15ms/step
Epoch 3/50
9940/9940 - 149s - loss: 2.8070 - accuracy20: 0.5305 - val_loss: 4.1197 - val_accuracy20: 0.4530 - 149s/epoch - 15ms/step
Epoch 4/50
9940/9940 - 152s - loss: 2.7915 - accuracy20: 0.5341 - val_loss: 4.1266 - val_accuracy20: 0.4548 - 152s/epoch - 15ms/step
Epoch 5/50
9940/9940 - 152s - loss: 2.7791 - accuracy20: 0.5369 - val_loss: 4.1184 - val_accuracy20: 0.4586 - 152s/epoch - 15ms/step
Epoch 6/50
9940/9940 - 151s - loss: 2.7700 - accuracy20: 0.5388 - val_loss: 4.1448 - val_accuracy20: 0.4564 - 151s/epoch - 15ms/step
Epoch 7/50
9940/9940 - 149s - loss: 2.7627 - accuracy20: 0.5407 - val_loss: 4.1742 - val_accuracy20: 0.4593 - 149s/epoch - 15ms/step
Epoch 8/50
9940/9940 - 152s - loss: 2.7556 - accuracy20: 0.5422 - val_loss: 4.1925 - val_accuracy20: 0.4606 - 152s/epoch - 15ms/step
Epoch 9/50
9940/9940 - 150s - loss: 2.7502 - accuracy20: 0.5432 - val_loss: 4.1863 - val_accuracy20: 0.4601 - 150s/epoch - 15ms/step
Epoch 10/50
9940/9940 - 151s - loss: 2.7447 - accuracy20: 0.5444 - val_loss: 4.1121 - val_accuracy20: 0.4608 - 151s/epoch - 15ms/step
Epoch 11/50
9940/9940 - 151s - loss: 2.7407 - accuracy20: 0.5452 - val_loss: 4.1145 - val_accuracy20: 0.4603 - 151s/epoch - 15ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 173s - 173s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.203829
{'0': {'precision': 0.36289566576707394, 'recall': 0.6714687502270186, 'f1-score': 0.4711552241890167, 'support': 1789501}, '1': {'precision': 0.5626220504475183, 'recall': 0.44808827979851457, 'f1-score': 0.4988656773704349, 'support': 3086278}, '2': {'precision': 0.43478055275045946, 'recall': 0.22425866806866163, 'f1-score': 0.2958953111797731, 'support': 1844990}, 'accuracy': 0.4461206745835186, 'macro avg': {'precision': 0.45343275632168395, 'recall': 0.4479385660313982, 'f1-score': 0.4219720709130749, 'support': 6720769}, 'weighted avg': {'precision': 0.4743469066435672, 'recall': 0.4461206745835186, 'f1-score': 0.4357678116951364, 'support': 6720769}}
[[1201594  455721  132186]
 [1297653 1382925  405700]
 [ 811881  619354  413755]]
Evaluating performance on  train set...
9940/9940 - 66s - 66s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2259535
{'0': {'precision': 0.37243469070690427, 'recall': 0.6062947553929552, 'f1-score': 0.46142516831756714, 'support': 717232}, '1': {'precision': 0.5075481765853059, 'recall': 0.48611814636052475, 'f1-score': 0.4966020747465012, 'support': 1105544}, '2': {'precision': 0.4481288683034799, 'recall': 0.19716916742503274, 'f1-score': 0.2738492633493544, 'support': 720848}, 'accuracy': 0.43811821244020344, 'macro avg': {'precision': 0.44270391186523006, 'recall': 0.4298606897261708, 'f1-score': 0.4106255021378076, 'support': 2543624}, 'weighted avg': {'precision': 0.4526108095688462, 'recall': 0.43811821244020344, 'f1-score': 0.4235563252403447, 'support': 2543624}}
[[434854 230607  51771]
 [444858 537425 123261]
 [287886 290833 142129]]
Evaluating performance on  val set...
3393/3393 - 24s - 24s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2297717
{'0': {'precision': 0.3780457620929896, 'recall': 0.6269833528417219, 'f1-score': 0.4716846426087156, 'support': 246048}, '1': {'precision': 0.5038560411311054, 'recall': 0.47821944024672736, 'f1-score': 0.4907031252151735, 'support': 372557}, '2': {'precision': 0.44924308629098186, 'recall': 0.1916290554027946, 'f1-score': 0.2686589810087637, 'support': 249482}, 'accuracy': 0.4380206131413096, 'macro avg': {'precision': 0.4437149631716923, 'recall': 0.43227728283041467, 'f1-score': 0.41034891627755093, 'support': 868087}, 'weighted avg': {'precision': 0.4525013765223807, 'recall': 0.4380206131413096, 'f1-score': 0.42149868281106273, 'support': 868087}}
[[154268  75822  15958]
 [151740 178164  42653]
 [102059  99615  47808]]
testing model out of sample: results/universal/W2/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 96s - 96s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1086966
{'0': {'precision': 0.3829041380017244, 'recall': 0.6361763981078736, 'f1-score': 0.47806736897257274, 'support': 998242}, '1': {'precision': 0.5745079867774867, 'recall': 0.47167211449057256, 'f1-score': 0.5180358460012936, 'support': 1669168}, '2': {'precision': 0.4697113417255528, 'recall': 0.2997909584788902, 'f1-score': 0.3659903636594638, 'support': 999323}, 'accuracy': 0.46961314063500126, 'macro avg': {'precision': 0.47570782216825463, 'recall': 0.46921315702577876, 'f1-score': 0.4540311928777767, 'support': 3666733}, 'weighted avg': {'precision': 0.49378416343587755, 'recall': 0.46961314063500126, 'f1-score': 0.4657165852325415, 'support': 3666733}}
[[635058 263434  99750]
 [643393 787300 238475]
 [380079 319656 299588]]
Evaluating performance on  train set...
5373/5373 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0299926
{'0': {'precision': 0.37385151046022624, 'recall': 0.58053225588564, 'f1-score': 0.45481255735248316, 'support': 325708}, '1': {'precision': 0.6571501657139044, 'recall': 0.5751607174890386, 'f1-score': 0.6134279360215703, 'support': 719119}, '2': {'precision': 0.4478331059857084, 'recall': 0.3252541166133943, 'f1-score': 0.37682568543277645, 'support': 330065}, 'accuracy': 0.5164391093991383, 'macro avg': {'precision': 0.49294492738661305, 'recall': 0.49364902999602434, 'f1-score': 0.4816887262689433, 'support': 1374892}, 'weighted avg': {'precision': 0.5397875847078676, 'recall': 0.5164391093991383, 'f1-score': 0.5190522180770762, 'support': 1374892}}
[[189084 100868  35756]
 [208900 413609  96610]
 [107789 114921 107355]]
Evaluating performance on  val set...
1685/1685 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0862288
{'0': {'precision': 0.3582848735374483, 'recall': 0.7056891571142063, 'f1-score': 0.4752705294104891, 'support': 108698}, '1': {'precision': 0.6424879482354154, 'recall': 0.4670855354398591, 'f1-score': 0.5409228532051351, 'support': 213432}, '2': {'precision': 0.47848175467734844, 'recall': 0.2707246964308747, 'f1-score': 0.34579741696331384, 'support': 108542}, 'accuracy': 0.4778183861500167, 'macro avg': {'precision': 0.49308485881673736, 'recall': 0.48116646299498006, 'f1-score': 0.45399693319297935, 'support': 430672}, 'weighted avg': {'precision': 0.5294230959239131, 'recall': 0.4778183861500167, 'f1-score': 0.4751754134078179, 'support': 430672}}
[[76707 23569  8422]
 [90135 99691 23606]
 [47253 31904 29385]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3957586
{'0': {'precision': 0.3515950860271116, 'recall': 0.5385316063986424, 'f1-score': 0.42543397044762293, 'support': 80142}, '1': {'precision': 0.3644730557987742, 'recall': 0.4038253775768934, 'f1-score': 0.3831414017802044, 'support': 90710}, '2': {'precision': 0.41041075276172234, 'recall': 0.14698137011133838, 'f1-score': 0.21644631229595424, 'support': 81643}, 'accuracy': 0.3635319511277451, 'macro avg': {'precision': 0.375492964862536, 'recall': 0.36311278469562475, 'f1-score': 0.3416738948412605, 'support': 252495}, 'weighted avg': {'precision': 0.37523930914915893, 'recall': 0.3635319511277451, 'f1-score': 0.34266505114903, 'support': 252495}}
[[43159 29658  7325]
 [44165 36631  9914]
 [35428 34215 12000]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.384104
{'0': {'precision': 0.3692332268370607, 'recall': 0.5785442531037245, 'f1-score': 0.45077619159060767, 'support': 19976}, '1': {'precision': 0.35957812116752513, 'recall': 0.3668117900215183, 'f1-score': 0.36315893777249303, 'support': 19983}, '2': {'precision': 0.41427603343121755, 'recall': 0.1782312925170068, 'f1-score': 0.2492355779031053, 'support': 20580}, 'accuracy': 0.3725697484266341, 'macro avg': {'precision': 0.38102912714526777, 'recall': 0.3745291118807499, 'f1-score': 0.354390235755402, 'support': 60539}, 'weighted avg': {'precision': 0.38135835250998923, 'recall': 0.3725697484266341, 'f1-score': 0.3533421174774544, 'support': 60539}}
[[11557  6102  2317]
 [ 9784  7330  2869]
 [ 9959  6953  3668]]
Evaluating performance on  val set...
85/85 - 1s - 621ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.360358
{'0': {'precision': 0.36428571428571427, 'recall': 0.5487968913465849, 'f1-score': 0.43789875380120447, 'support': 6691}, '1': {'precision': 0.4112963959117805, 'recall': 0.481607457797934, 'f1-score': 0.4436836302442988, 'support': 7938}, '2': {'precision': 0.40808988764044946, 'recall': 0.13025390905178597, 'f1-score': 0.197477163984341, 'support': 6971}, 'accuracy': 0.38902777777777775, 'macro avg': {'precision': 0.3945573326126481, 'recall': 0.386886086065435, 'f1-score': 0.35968651600994805, 'support': 21600}, 'weighted avg': {'precision': 0.395699125545139, 'recall': 0.38902777777777775, 'f1-score': 0.3624330800323122, 'support': 21600}}
[[3672 2427  592]
 [3390 3823  725]
 [3018 3045  908]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9648264
{'0': {'precision': 0.33465971791505233, 'recall': 0.6411673019645365, 'f1-score': 0.43977644406338323, 'support': 64799}, '1': {'precision': 0.7395435636250535, 'recall': 0.5075620116979037, 'f1-score': 0.6019766510859555, 'support': 187384}, '2': {'precision': 0.4412194259535413, 'recall': 0.43739331870275544, 'f1-score': 0.43929804152667545, 'support': 65616}, 'accuracy': 0.5203163005547532, 'macro avg': {'precision': 0.5051409024978823, 'recall': 0.5287075441217319, 'f1-score': 0.4936837122253381, 'support': 317799}, 'weighted avg': {'precision': 0.5953930001065518, 'recall': 0.5203163005547532, 'f1-score': 0.5353158659365455, 'support': 317799}}
[[41547 14888  8364]
 [64292 95109 27983]
 [18308 18608 28700]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0190709
{'0': {'precision': 0.255592340730136, 'recall': 0.7918591757530955, 'f1-score': 0.3864487034949267, 'support': 21644}, '1': {'precision': 0.8418562213546087, 'recall': 0.43403347554972105, 'f1-score': 0.5727670386464364, 'support': 91410}, '2': {'precision': 0.4123974915581283, 'recall': 0.3910795974382434, 'f1-score': 0.4014557407842217, 'support': 21860}, 'accuracy': 0.4844790014379531, 'macro avg': {'precision': 0.5032820178809577, 'recall': 0.5389907495803533, 'f1-score': 0.45355716097519494, 'support': 134914}, 'weighted avg': {'precision': 0.6782181758916682, 'recall': 0.4844790014379531, 'f1-score': 0.5151189145282035, 'support': 134914}}
[[17139  2995  1510]
 [41064 39675 10671]
 [ 8853  4458  8549]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98160315
{'0': {'precision': 0.2909424537438198, 'recall': 0.7937699902656098, 'f1-score': 0.4258112644535621, 'support': 7191}, '1': {'precision': 0.8043226553454265, 'recall': 0.4729198184568835, 'f1-score': 0.595627113799838, 'support': 26440}, '2': {'precision': 0.4298342541436464, 'recall': 0.3351522113727743, 'f1-score': 0.37663385509117314, 'support': 6964}, 'accuracy': 0.506121443527528, 'macro avg': {'precision': 0.5083664544109642, 'recall': 0.5339473400317559, 'f1-score': 0.4660240777815244, 'support': 40595}, 'weighted avg': {'precision': 0.6491396462140963, 'recall': 0.506121443527528, 'f1-score': 0.5279780233626854, 'support': 40595}}
[[ 5708  1160   323]
 [11163 12504  2773]
 [ 2748  1882  2334]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.262216
{'0': {'precision': 0.4296193910565778, 'recall': 0.5846187794216543, 'f1-score': 0.4952753136808934, 'support': 95168}, '1': {'precision': 0.3746541840957882, 'recall': 0.43488760436737317, 'f1-score': 0.4025300803728539, 'support': 77850}, '2': {'precision': 0.49129618725158253, 'recall': 0.2638371461040565, 'f1-score': 0.34330939507133257, 'support': 101195}, 'accuracy': 0.42372899898983635, 'macro avg': {'precision': 0.4318565874679828, 'recall': 0.427781176631028, 'f1-score': 0.41370492970836, 'support': 274213}, 'weighted avg': {'precision': 0.43677566019427744, 'recall': 0.42372899898983635, 'f1-score': 0.41286343843528, 'support': 274213}}
[[55637 25815 13716]
 [30065 33856 13929]
 [43801 30695 26699]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2619926
{'0': {'precision': 0.41952484754835684, 'recall': 0.6237026705501088, 'f1-score': 0.5016331782638821, 'support': 24377}, '1': {'precision': 0.4292555840772384, 'recall': 0.4548370072666748, 'f1-score': 0.4416761934797177, 'support': 24633}, '2': {'precision': 0.48559940153357023, 'recall': 0.2161408474153001, 'f1-score': 0.29913594470046084, 'support': 24026}, 'accuracy': 0.4326770359822553, 'macro avg': {'precision': 0.4447932777197218, 'recall': 0.4315601750773612, 'f1-score': 0.41414843881468694, 'support': 73036}, 'weighted avg': {'precision': 0.44454270815086355, 'recall': 0.4326770359822553, 'f1-score': 0.4147976596185144, 'support': 73036}}
[[15204  6803  2370]
 [10298 11204  3131]
 [10739  8094  5193]]
Evaluating performance on  val set...
117/117 - 1s - 777ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2627561
{'0': {'precision': 0.4099979977307615, 'recall': 0.6283113429477345, 'f1-score': 0.4962035541195477, 'support': 9777}, '1': {'precision': 0.4321461187214612, 'recall': 0.4569773056494447, 'f1-score': 0.4442149730110303, 'support': 10355}, '2': {'precision': 0.4824561403508772, 'recall': 0.19324170714064276, 'f1-score': 0.27595366339555816, 'support': 9677}, 'accuracy': 0.42755543627763426, 'macro avg': {'precision': 0.44153341893436665, 'recall': 0.42617678524594066, 'f1-score': 0.4054573968420454, 'support': 29809}, 'weighted avg': {'precision': 0.44121411497701446, 'recall': 0.42755543627763426, 'f1-score': 0.40664335586013794, 'support': 29809}}
[[6143 2826  808]
 [4425 4732 1198]
 [4415 3392 1870]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3992519
{'0': {'precision': 0.37452744632503543, 'recall': 0.48779678562422857, 'f1-score': 0.4237229517079188, 'support': 75349}, '1': {'precision': 0.3242486321084978, 'recall': 0.3723922269376815, 'f1-score': 0.3466568709670712, 'support': 67155}, '2': {'precision': 0.3818177748931313, 'recall': 0.2202995867768595, 'f1-score': 0.27939502624446244, 'support': 77440}, 'accuracy': 0.3583775870221511, 'macro avg': {'precision': 0.3601979511088882, 'recall': 0.36016286644625656, 'f1-score': 0.3499249496398175, 'support': 219944}, 'weighted avg': {'precision': 0.36174277966262025, 'recall': 0.3583775870221511, 'f1-score': 0.3493761761648639, 'support': 219944}}
[[36755 25616 12978]
 [27504 25008 14643]
 [33878 26502 17060]]
Evaluating performance on  train set...
320/320 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4182483
{'0': {'precision': 0.3822069105279157, 'recall': 0.5356622998544396, 'f1-score': 0.44610676640598435, 'support': 28167}, '1': {'precision': 0.32592622038479885, 'recall': 0.3021892967713401, 'f1-score': 0.3136092411260709, 'support': 27132}, '2': {'precision': 0.3616422287390029, 'recall': 0.23371110184588562, 'f1-score': 0.2839315727672507, 'support': 26383}, 'accuracy': 0.36058127861707595, 'macro avg': {'precision': 0.3565917865505725, 'recall': 0.35718756615722175, 'f1-score': 0.34788252676643533, 'support': 81682}, 'weighted avg': {'precision': 0.35687004702555375, 'recall': 0.36058127861707595, 'f1-score': 0.34971354648402697, 'support': 81682}}
[[15088  8461  4618]
 [12667  8199  6266]
 [11721  8496  6166]]
Evaluating performance on  val set...
98/98 - 1s - 715ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4112626
{'0': {'precision': 0.391399240158435, 'recall': 0.5455159981973862, 'f1-score': 0.45578199275191783, 'support': 8876}, '1': {'precision': 0.32447089947089947, 'recall': 0.30502362596369065, 'f1-score': 0.31444686578643766, 'support': 8042}, '2': {'precision': 0.33936381709741553, 'recall': 0.2122342409548676, 'f1-score': 0.2611489329151687, 'support': 8043}, 'accuracy': 0.36064260245983737, 'macro avg': {'precision': 0.35174465224225004, 'recall': 0.35425795503864815, 'f1-score': 0.34379259715117466, 'support': 24961}, 'weighted avg': {'precision': 0.3530691002005431, 'recall': 0.36064260245983737, 'f1-score': 0.3475310896902069, 'support': 24961}}
[[4842 2568 1466]
 [3732 2453 1857]
 [3797 2539 1707]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2724771
{'0': {'precision': 0.444124515066658, 'recall': 0.561335536101688, 'f1-score': 0.4958981164316859, 'support': 170089}, '1': {'precision': 0.3740653286107832, 'recall': 0.492314691677749, 'f1-score': 0.42512027657568363, 'support': 142870}, '2': {'precision': 0.5186233560012427, 'recall': 0.2547016274864376, 'f1-score': 0.34162665282130766, 'support': 176960}, 'accuracy': 0.43045074798078864, 'macro avg': {'precision': 0.44560439989289463, 'recall': 0.4361172850886248, 'f1-score': 0.42088168194289244, 'support': 489919}, 'weighted avg': {'precision': 0.45060305319813126, 'recall': 0.43045074798078864, 'f1-score': 0.4195346600629401, 'support': 489919}}
[[95477 54191 20421]
 [51119 70337 21414]
 [68382 63506 45072]]
Evaluating performance on  train set...
716/716 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.271098
{'0': {'precision': 0.4281046131661879, 'recall': 0.605862120040156, 'f1-score': 0.5017035078633924, 'support': 60763}, '1': {'precision': 0.4427768741682685, 'recall': 0.4926055700866933, 'f1-score': 0.4663640115559224, 'support': 60789}, '2': {'precision': 0.4770875763747454, 'recall': 0.22842144610033965, 'f1-score': 0.30893165258102445, 'support': 61531}, 'accuracy': 0.44140635667975725, 'macro avg': {'precision': 0.4493230212364006, 'recall': 0.44229637874239636, 'f1-score': 0.4256663906667797, 'support': 183083}, 'weighted avg': {'precision': 0.449438558880652, 'recall': 0.44140635667975725, 'f1-score': 0.42518248915376794, 'support': 183083}}
[[36814 17059  6890]
 [22329 29945  8515]
 [26850 20626 14055]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3398696
{'0': {'precision': 0.43531840763920254, 'recall': 0.6640421239112249, 'f1-score': 0.5258870983456421, 'support': 20321}, '1': {'precision': 0.3318710661834827, 'recall': 0.37648755860079336, 'f1-score': 0.3527742109887139, 'support': 13865}, '2': {'precision': 0.5175980825028385, 'recall': 0.2004592534688294, 'f1-score': 0.28899454129248103, 'support': 20468}, 'accuracy': 0.41748087971603176, 'macro avg': {'precision': 0.4282625187751745, 'recall': 0.41366297866028257, 'f1-score': 0.3892186168756124, 'support': 54654}, 'weighted avg': {'precision': 0.43988903368350574, 'recall': 0.41748087971603176, 'f1-score': 0.39325404237594347, 'support': 54654}}
[[13494  4696  2131]
 [ 6952  5220  1693]
 [10552  5813  4103]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
4918/4918 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9551529
{'0': {'precision': 0.31286727267631426, 'recall': 0.826350230960559, 'f1-score': 0.4538868867634283, 'support': 202632}, '1': {'precision': 0.904000928648816, 'recall': 0.41206765790077077, 'f1-score': 0.5660944258005113, 'support': 850455}, '2': {'precision': 0.3904918091337683, 'recall': 0.6376560130642716, 'f1-score': 0.48436507819306823, 'support': 205752}, 'accuracy': 0.5156251117100757, 'macro avg': {'precision': 0.5357866701529662, 'recall': 0.6253579673085338, 'f1-score': 0.5014487969190026, 'support': 1258839}, 'weighted avg': {'precision': 0.7249167698838904, 'recall': 0.5156251117100757, 'f1-score': 0.5346743516058854, 'support': 1258839}}
[[167445  14776  20411]
 [315636 350445 184374]
 [ 52114  22439 131199]]
Evaluating performance on  train set...
1403/1403 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9223866
{'0': {'precision': 0.2752540831899211, 'recall': 0.8308992178157653, 'f1-score': 0.4135202638100256, 'support': 51011}, '1': {'precision': 0.8954031101295508, 'recall': 0.4598412123054617, 'f1-score': 0.6076295540928897, 'support': 256569}, '2': {'precision': 0.4164572864321608, 'recall': 0.5933463035019455, 'f1-score': 0.48940881956479876, 'support': 51400}, 'accuracy': 0.5316842163908853, 'macro avg': {'precision': 0.5290381599172108, 'recall': 0.6280289112077242, 'f1-score': 0.5035195458225713, 'support': 358980}, 'weighted avg': {'precision': 0.7387029113684407, 'recall': 0.5316842163908853, 'f1-score': 0.5631194009886414, 'support': 358980}}
[[ 42385   5019   3607]
 [ 99461 117981  39127]
 [ 12139   8763  30498]]
Evaluating performance on  val set...
480/480 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9352131
{'0': {'precision': 0.29382961631154125, 'recall': 0.8196563867250026, 'f1-score': 0.4325861680558684, 'support': 18742}, '1': {'precision': 0.8967824967824968, 'recall': 0.4486327027533246, 'f1-score': 0.5980695854368402, 'support': 85424}, '2': {'precision': 0.41660649819494583, 'recall': 0.6220688911648967, 'f1-score': 0.499016237486757, 'support': 18551}, 'accuracy': 0.5315156009354857, 'macro avg': {'precision': 0.5357395370963279, 'recall': 0.6301193268810746, 'f1-score': 0.5098906636598218, 'support': 122717}, 'weighted avg': {'precision': 0.7321085898618233, 'recall': 0.5315156009354857, 'f1-score': 0.5578222776769033, 'support': 122717}}
[[15362  1792  1588]
 [32528 38324 14572]
 [ 4392  2619 11540]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
4856/4856 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0128214
{'0': {'precision': 0.37918737615073117, 'recall': 0.6426161078276474, 'f1-score': 0.4769447738632238, 'support': 307602}, '1': {'precision': 0.6315187983514611, 'recall': 0.5262346211652928, 'f1-score': 0.5740895254672715, 'support': 637402}, '2': {'precision': 0.4909670340055337, 'recall': 0.31390965454966585, 'f1-score': 0.38296373651125176, 'support': 297901}, 'accuracy': 0.5041471391618828, 'macro avg': {'precision': 0.5005577361692419, 'recall': 0.49425346118086866, 'f1-score': 0.47799934528058236, 'support': 1242905}, 'weighted avg': {'precision': 0.5353826002653603, 'recall': 0.5041471391618828, 'f1-score': 0.5042382628698119, 'support': 1242905}}
[[197670  86305  23627]
 [228651 335423  73328]
 [ 94978 109409  93514]]
Evaluating performance on  train set...
2076/2076 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86922634
{'0': {'precision': 0.34623174772667564, 'recall': 0.42418988090911924, 'f1-score': 0.3812665646347382, 'support': 96313}, '1': {'precision': 0.7383442824715285, 'recall': 0.6751002859374026, 'f1-score': 0.7053073708831348, 'support': 336787}, '2': {'precision': 0.42674833131067963, 'recall': 0.45783745295493844, 'f1-score': 0.4417465723174765, 'support': 98310}, 'accuracy': 0.5894318887488004, 'macro avg': {'precision': 0.503774787169628, 'recall': 0.5190425399338201, 'f1-score': 0.5094401692784498, 'support': 531410}, 'weighted avg': {'precision': 0.6096328684644454, 'recall': 0.5894318887488004, 'f1-score': 0.5978197355748198, 'support': 531410}}
[[ 40855  42145  13313]
 [ 62273 227365  47149]
 [ 14871  38429  45010]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9055521
{'0': {'precision': 0.31018153117600633, 'recall': 0.7147045724465558, 'f1-score': 0.43261033169712565, 'support': 26944}, '1': {'precision': 0.7881024685047656, 'recall': 0.5427261056816299, 'f1-score': 0.642793207038195, 'support': 96592}, '2': {'precision': 0.47270717214058683, 'recall': 0.38328228878762977, 'f1-score': 0.423323639213745, 'support': 26774}, 'accuracy': 0.5451533497438626, 'macro avg': {'precision': 0.5236637239404529, 'recall': 0.5469043223052719, 'f1-score': 0.49957572598302186, 'support': 150310}, 'weighted avg': {'precision': 0.6462523228042759, 'recall': 0.5451533497438626, 'f1-score': 0.566023560293989, 'support': 150310}}
[[19257  5868  1819]
 [34541 52423  9628]
 [ 8285  8227 10262]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
4353/4353 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9374832
{'0': {'precision': 0.3877046713378285, 'recall': 0.6108252675537291, 'f1-score': 0.47433692346700645, 'support': 240419}, '1': {'precision': 0.6850314697839825, 'recall': 0.6698493003911723, 'f1-score': 0.6773553228914987, 'support': 630924}, '2': {'precision': 0.5085899349745717, 'recall': 0.24821667455596946, 'f1-score': 0.3336136359864348, 'support': 242945}, 'accuracy': 0.5651869175652973, 'macro avg': {'precision': 0.5271086920321276, 'recall': 0.509630414166957, 'f1-score': 0.49510196078164664, 'support': 1114288}, 'weighted avg': {'precision': 0.5824111416193624, 'recall': 0.5651869175652973, 'f1-score': 0.5586070238015078, 'support': 1114288}}
[[146854  78123  15442]
 [165476 422624  42824]
 [ 66448 116194  60303]]
Evaluating performance on  train set...
1542/1542 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0328287
{'0': {'precision': 0.3984375, 'recall': 0.5156984138663191, 'f1-score': 0.4495471267632735, 'support': 95137}, '1': {'precision': 0.6210125917023137, 'recall': 0.6969031896276673, 'f1-score': 0.6567728561828723, 'support': 206858}, '2': {'precision': 0.48600152710613387, 'recall': 0.2062807881773399, 'f1-score': 0.28962975321937234, 'support': 92568}, 'accuracy': 0.5381067155308531, 'macro avg': {'precision': 0.5018172062694825, 'recall': 0.47296079722377543, 'f1-score': 0.4653165787218394, 'support': 394563}, 'weighted avg': {'precision': 0.5356705025382963, 'recall': 0.5381067155308531, 'f1-score': 0.5206715568341812, 'support': 394563}}
[[ 49062  40455   5620]
 [ 48123 144160  14575]
 [ 25951  47522  19095]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0162843
{'0': {'precision': 0.3726276338439413, 'recall': 0.5945485519591142, 'f1-score': 0.45812794684954994, 'support': 28763}, '1': {'precision': 0.6430995475113123, 'recall': 0.6185323984526112, 'f1-score': 0.630576780872566, 'support': 66176}, '2': {'precision': 0.4856561841818578, 'recall': 0.2356984244474992, 'f1-score': 0.31737066919791174, 'support': 28371}, 'accuracy': 0.5248560538480253, 'macro avg': {'precision': 0.5004611218457038, 'recall': 0.4829264582864082, 'f1-score': 0.4686917989733425, 'support': 123310}, 'weighted avg': {'precision': 0.5437855477235048, 'recall': 0.5248560538480253, 'f1-score': 0.5182897286681574, 'support': 123310}}
[[17101  9999  1663]
 [19825 40932  5419]
 [ 8967 12717  6687]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0554054
{'0': {'precision': 0.36273549258162896, 'recall': 0.70348249483694, 'f1-score': 0.4786602220152838, 'support': 345241}, '1': {'precision': 0.6747819254802632, 'recall': 0.4315999755669576, 'f1-score': 0.5264653412617172, 'support': 720336}, '2': {'precision': 0.44054024773392075, 'recall': 0.35708849495351613, 'f1-score': 0.39444880960464584, 'support': 341624}, 'accuracy': 0.48021426931902406, 'macro avg': {'precision': 0.4926858885986043, 'recall': 0.4973903217858046, 'f1-score': 0.466524790960549, 'support': 1407201}, 'weighted avg': {'precision': 0.541358341032289, 'recall': 0.48021426931902406, 'f1-score': 0.4826874425929604, 'support': 1407201}}
[[242871  67532  34838]
 [289357 310897 120082]
 [137326  82308 121990]]
Evaluating performance on  train set...
2058/2058 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0358294
{'0': {'precision': 0.3617384694875375, 'recall': 0.6816356745709251, 'f1-score': 0.4726470309265697, 'support': 124279}, '1': {'precision': 0.6638535507952277, 'recall': 0.4970912912067079, 'f1-score': 0.5684952579967747, 'support': 276927}, '2': {'precision': 0.46142661147527525, 'recall': 0.3132512856437772, 'f1-score': 0.3731679445416483, 'support': 125618}, 'accuracy': 0.4967901993834753, 'macro avg': {'precision': 0.49567287725268017, 'recall': 0.4973260838071368, 'f1-score': 0.4714367444883309, 'support': 526824}, 'weighted avg': {'precision': 0.5443164236838353, 'recall': 0.4967901993834753, 'f1-score': 0.4993098217340682, 'support': 526824}}
[[ 84713  28730  10836]
 [104176 137658  35093]
 [ 45294  40974  39350]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0989162
{'0': {'precision': 0.35552449303179506, 'recall': 0.7579673079061492, 'f1-score': 0.48401962663939957, 'support': 44965}, '1': {'precision': 0.6360420668276819, 'recall': 0.3949481589948277, 'f1-score': 0.48730557680399234, 'support': 84682}, '2': {'precision': 0.47791273402444684, 'recall': 0.2766953327958434, 'f1-score': 0.3504765687053217, 'support': 44652}, 'accuracy': 0.45830440794267324, 'macro avg': {'precision': 0.48982643129464126, 'recall': 0.4765369332322735, 'f1-score': 0.44060059071623786, 'support': 174299}, 'weighted avg': {'precision': 0.5231655519075613, 'recall': 0.45830440794267324, 'f1-score': 0.4514049599400243, 'support': 174299}}
[[34082  7734  3149]
 [40889 33445 10348]
 [20893 11404 12355]]
testing model on single stock: results/universal/W2/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 96s - 96s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3723979
{'0': {'precision': 0.3719672472589189, 'recall': 0.6706570991343793, 'f1-score': 0.4785280065301004, 'support': 1206302}, '1': {'precision': 0.39230005154891257, 'recall': 0.36237669954678753, 'f1-score': 0.3767451367911618, 'support': 1350360}, '2': {'precision': 0.4552669534053878, 'recall': 0.14079619417556297, 'f1-score': 0.21507739451272356, 'support': 1253237}, 'accuracy': 0.3870981881671929, 'macro avg': {'precision': 0.4065114174044064, 'recall': 0.39127666428557656, 'f1-score': 0.35678351261132857, 'support': 3809899}, 'weighted avg': {'precision': 0.4065746947090791, 'recall': 0.3870981881671929, 'f1-score': 0.3557925821439173, 'support': 3809899}}
[[809015 322418  74869]
 [724764 489339 136257]
 [641184 435602 176451]]
Evaluating performance on  train set...
6147/6147 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3511491
{'0': {'precision': 0.39685867618010323, 'recall': 0.5962499496425098, 'f1-score': 0.47653793257827465, 'support': 521273}, '1': {'precision': 0.3654298598963265, 'recall': 0.43490044406245526, 'f1-score': 0.397150045566132, 'support': 523575}, '2': {'precision': 0.46637001949737444, 'recall': 0.14750764702432861, 'f1-score': 0.22412655801126413, 'support': 528637}, 'accuracy': 0.3917990956380264, 'macro avg': {'precision': 0.4095528518579347, 'recall': 0.3928860135764312, 'f1-score': 0.36593817871855694, 'support': 1573485}, 'weighted avg': {'precision': 0.4097542077621863, 'recall': 0.3917990956380264, 'f1-score': 0.36532015499579795, 'support': 1573485}}
[[310809 173850  36614]
 [243262 227703  52610]
 [229102 221557  77978]]
Evaluating performance on  val set...
2174/2174 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3526988
{'0': {'precision': 0.3998573790152669, 'recall': 0.6084306977355927, 'f1-score': 0.4825714192573919, 'support': 182476}, '1': {'precision': 0.373949860724234, 'recall': 0.44995307681994906, 'f1-score': 0.408445904831447, 'support': 186475}, '2': {'precision': 0.46638516614650266, 'recall': 0.13544971288115892, 'f1-score': 0.20993046115451838, 'support': 187553}, 'accuracy': 0.395923479435907, 'macro avg': {'precision': 0.41339746862866783, 'recall': 0.39794449581223357, 'f1-score': 0.366982595081119, 'support': 556504}, 'weighted avg': {'precision': 0.4135974088919691, 'recall': 0.395923479435907, 'f1-score': 0.3658477570417631, 'support': 556504}}
[[111024  60487  10965]
 [ 84469  83905  18101]
 [ 82166  79983  25404]]
training model: results/universal/W2/deepLOB_L1/h30
Epoch 1/50
9940/9940 - 153s - loss: 2.9829 - accuracy30: 0.4835 - val_loss: 3.6961 - val_accuracy30: 0.4364 - 153s/epoch - 15ms/step
Epoch 2/50
9940/9940 - 147s - loss: 2.9136 - accuracy30: 0.5026 - val_loss: 3.9228 - val_accuracy30: 0.4410 - 147s/epoch - 15ms/step
Epoch 3/50
9940/9940 - 147s - loss: 2.8885 - accuracy30: 0.5092 - val_loss: 4.0728 - val_accuracy30: 0.4406 - 147s/epoch - 15ms/step
Epoch 4/50
9940/9940 - 149s - loss: 2.8736 - accuracy30: 0.5129 - val_loss: 4.1313 - val_accuracy30: 0.4410 - 149s/epoch - 15ms/step
Epoch 5/50
9940/9940 - 150s - loss: 2.8638 - accuracy30: 0.5152 - val_loss: 4.1359 - val_accuracy30: 0.4432 - 150s/epoch - 15ms/step
Epoch 6/50
9940/9940 - 147s - loss: 2.8553 - accuracy30: 0.5171 - val_loss: 4.1180 - val_accuracy30: 0.4437 - 147s/epoch - 15ms/step
Epoch 7/50
9940/9940 - 147s - loss: 2.8492 - accuracy30: 0.5184 - val_loss: 4.1349 - val_accuracy30: 0.4457 - 147s/epoch - 15ms/step
Epoch 8/50
9940/9940 - 146s - loss: 2.8435 - accuracy30: 0.5199 - val_loss: 4.1500 - val_accuracy30: 0.4454 - 146s/epoch - 15ms/step
Epoch 9/50
9940/9940 - 147s - loss: 2.8385 - accuracy30: 0.5210 - val_loss: 4.1361 - val_accuracy30: 0.4458 - 147s/epoch - 15ms/step
Epoch 10/50
9940/9940 - 145s - loss: 2.8350 - accuracy30: 0.5215 - val_loss: 4.1089 - val_accuracy30: 0.4468 - 145s/epoch - 15ms/step
Epoch 11/50
9940/9940 - 146s - loss: 2.8316 - accuracy30: 0.5226 - val_loss: 4.1756 - val_accuracy30: 0.4474 - 146s/epoch - 15ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 140s - 140s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.158107
{'0': {'precision': 0.3691749650231862, 'recall': 0.6127380149371389, 'f1-score': 0.4607486403569792, 'support': 1845735}, '1': {'precision': 0.5190346763335407, 'recall': 0.5225652276375167, 'f1-score': 0.5207939685016294, 'support': 2961858}, '2': {'precision': 0.4920672998611, 'recall': 0.1736881499663387, 'f1-score': 0.25674970890274684, 'support': 1913176}, 'accuracy': 0.4480159934078972, 'macro avg': {'precision': 0.4600923137392756, 'recall': 0.4363304641803314, 'f1-score': 0.4127641059204518, 'support': 6720769}, 'weighted avg': {'precision': 0.47020177466626795, 'recall': 0.4480159934078972, 'f1-score': 0.4291391438609644, 'support': 6720769}}
[[1130952  623330   91453]
 [1162537 1547764  251557]
 [ 769969  810911  332296]]
Evaluating performance on  train set...
9940/9940 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1869183
{'0': {'precision': 0.3828575215447615, 'recall': 0.5570078765463179, 'f1-score': 0.4537982896882175, 'support': 746774}, '1': {'precision': 0.4685860519272733, 'recall': 0.5361242785590925, 'f1-score': 0.5000851517287588, 'support': 1043398}, '2': {'precision': 0.4715126433290303, 'recall': 0.1648240365676911, 'f1-score': 0.2442625723816717, 'support': 753452}, 'accuracy': 0.43227182948423193, 'macro avg': {'precision': 0.44098540560035504, 'recall': 0.4193187305577006, 'f1-score': 0.3993820045995493, 'support': 2543624}, 'weighted avg': {'precision': 0.44428419308216366, 'recall': 0.43227182948423193, 'f1-score': 0.4107182251831355, 'support': 2543624}}
[[415959 286705  44110]
 [388924 559391  95083]
 [281576 347689 124187]]
Evaluating performance on  val set...
3393/3393 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1883545
{'0': {'precision': 0.3881964202783279, 'recall': 0.5712894115613794, 'f1-score': 0.4622736410517199, 'support': 254589}, '1': {'precision': 0.4729820855707776, 'recall': 0.5365976452852265, 'f1-score': 0.5027855960701221, 'support': 355542}, '2': {'precision': 0.4717462996480085, 'recall': 0.16469863077424057, 'f1-score': 0.2441561426949988, 'support': 257956}, 'accuracy': 0.4362604209025132, 'macro avg': {'precision': 0.44430826849903804, 'recall': 0.42419522920694885, 'f1-score': 0.40307179327228027, 'support': 868087}, 'weighted avg': {'precision': 0.4477492734970646, 'recall': 0.4362604209025132, 'f1-score': 0.4140514975396599, 'support': 868087}}
[[145444  94658  14487]
 [131672 190783  33087]
 [ 97550 117921  42485]]
testing model out of sample: results/universal/W2/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 80s - 80s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0806038
{'0': {'precision': 0.41067785756934644, 'recall': 0.490840471976728, 'f1-score': 0.4471951525183656, 'support': 1083189}, '1': {'precision': 0.48971073691133205, 'recall': 0.5639811349386362, 'f1-score': 0.5242284287720392, 'support': 1489314}, '2': {'precision': 0.4946173377742326, 'recall': 0.2969448836167899, 'f1-score': 0.3710992865276269, 'support': 1094230}, 'accuracy': 0.46268544778144466, 'macro avg': {'precision': 0.4650019774183037, 'recall': 0.45058883017738466, 'f1-score': 0.4475076226060106, 'support': 3666733}, 'weighted avg': {'precision': 0.4678278794250208, 'recall': 0.46268544778144466, 'f1-score': 0.45577509475779726, 'support': 3666733}}
[[531673 410906 140610]
 [457981 839945 191388]
 [304969 464335 324926]]
Evaluating performance on  train set...
5373/5373 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.025559
{'0': {'precision': 0.40720833839001486, 'recall': 0.47980189633931714, 'f1-score': 0.4405345627704753, 'support': 363648}, '1': {'precision': 0.5601759301596079, 'recall': 0.654340481558077, 'f1-score': 0.6036077970811073, 'support': 644076}, '2': {'precision': 0.48780349560987674, 'recall': 0.2578356501655918, 'f1-score': 0.3373565676003136, 'support': 367168}, 'accuracy': 0.5022889070559724, 'macro avg': {'precision': 0.4850625880531665, 'recall': 0.4639926760209953, 'f1-score': 0.4604996424839654, 'support': 1374892}, 'weighted avg': {'precision': 0.5003899972568164, 'recall': 0.5022889070559724, 'f1-score': 0.4893732339760803, 'support': 1374892}}
[[174479 153167  36002]
 [159230 421445  63401]
 [ 94767 177732  94669]]
Evaluating performance on  val set...
1685/1685 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.045536
{'0': {'precision': 0.3891942408224059, 'recall': 0.5566443614612834, 'f1-score': 0.45809671786269196, 'support': 119703}, '1': {'precision': 0.54595660539828, 'recall': 0.5369772061898788, 'f1-score': 0.541429678398794, 'support': 191280}, '2': {'precision': 0.48660507759382055, 'recall': 0.2900099424341418, 'f1-score': 0.36342410821790155, 'support': 119689}, 'accuracy': 0.4738083738901066, 'macro avg': {'precision': 0.47391864127150213, 'recall': 0.461210503361768, 'f1-score': 0.4543168348264625, 'support': 430672}, 'weighted avg': {'precision': 0.4858908236938418, 'recall': 0.4738083738901066, 'f1-score': 0.46879780526928044, 'support': 430672}}
[[ 66632  39170  13901]
 [ 65846 102713  22721]
 [ 38727  46251  34711]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2830955
{'0': {'precision': 0.3385617308885977, 'recall': 0.4355149425870067, 'f1-score': 0.3809666350700392, 'support': 78902}, '1': {'precision': 0.35735690362871747, 'recall': 0.4774952612748012, 'f1-score': 0.4087819023294222, 'support': 89159}, '2': {'precision': 0.4466970029813275, 'recall': 0.16858137717033422, 'f1-score': 0.24478284422050062, 'support': 84434}, 'accuracy': 0.36107645695954377, 'macro avg': {'precision': 0.38087187916621423, 'recall': 0.36053052701071403, 'f1-score': 0.34484379387332065, 'support': 252495}, 'weighted avg': {'precision': 0.3813588253665631, 'recall': 0.36107645695954377, 'f1-score': 0.3452488553793102, 'support': 252495}}
[[34363 36545  7994]
 [36949 42573  9637]
 [30185 40015 14234]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2975773
{'0': {'precision': 0.3680894387029851, 'recall': 0.48148148148148145, 'f1-score': 0.417218254659467, 'support': 19899}, '1': {'precision': 0.3507645259938838, 'recall': 0.4590984139690799, 'f1-score': 0.3976856567057447, 'support': 19987}, '2': {'precision': 0.42047904191616764, 'recall': 0.16999951580884132, 'f1-score': 0.24211288487397856, 'support': 20653}, 'accuracy': 0.36782900279158887, 'macro avg': {'precision': 0.37977766887101216, 'recall': 0.3701931370864675, 'f1-score': 0.3523389320797301, 'support': 60539}, 'weighted avg': {'precision': 0.38024242181874607, 'recall': 0.36782900279158887, 'f1-score': 0.35103200715817456, 'support': 60539}}
[[9581 8098 2220]
 [8192 9176 2619]
 [8256 8886 3511]]
Evaluating performance on  val set...
85/85 - 1s - 609ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2543958
{'0': {'precision': 0.35930192768335806, 'recall': 0.46618321740417346, 'f1-score': 0.4058232414326204, 'support': 6757}, '1': {'precision': 0.4039091179680524, 'recall': 0.5199897815813003, 'f1-score': 0.45465713647531825, 'support': 7829}, '2': {'precision': 0.44262890341321715, 'recall': 0.17379526660963787, 'f1-score': 0.24959049959049961, 'support': 7014}, 'accuracy': 0.3907407407407407, 'macro avg': {'precision': 0.4019466496882092, 'recall': 0.38665608853170386, 'f1-score': 0.37002362583281273, 'support': 21600}, 'weighted avg': {'precision': 0.4025280897439184, 'recall': 0.3907407407407407, 'f1-score': 0.3727910244422799, 'support': 21600}}
[[3150 2921  686]
 [2909 4071  849]
 [2708 3087 1219]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94475466
{'0': {'precision': 0.3775273773810395, 'recall': 0.4187134819303181, 'f1-score': 0.39705523990303837, 'support': 73936}, '1': {'precision': 0.6093753307508308, 'recall': 0.6874462699398224, 'f1-score': 0.6460607964810305, 'support': 167504}, '2': {'precision': 0.5400465483740098, 'recall': 0.33122487198627537, 'f1-score': 0.41061107864147023, 'support': 76359}, 'accuracy': 0.5393346108703929, 'macro avg': {'precision': 0.50898308550196, 'recall': 0.4791282079521386, 'f1-score': 0.4845757050085131, 'support': 317799}, 'weighted avg': {'precision': 0.5387779192616173, 'recall': 0.5393346108703929, 'f1-score': 0.5315570383330773, 'support': 317799}}
[[ 30958  36231   6747]
 [ 37560 115150  14794]
 [ 13484  37583  25292]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9029897
{'0': {'precision': 0.31121760391198044, 'recall': 0.62225263981228, 'f1-score': 0.4149162266119043, 'support': 25570}, '1': {'precision': 0.7556427218030116, 'recall': 0.5444464403329142, 'f1-score': 0.6328904232586953, 'support': 83505}, '2': {'precision': 0.44676798035812554, 'recall': 0.40845233948682225, 'f1-score': 0.4267518499049776, 'support': 25839}, 'accuracy': 0.533147041819233, 'macro avg': {'precision': 0.5045427686910392, 'recall': 0.5250504732106721, 'f1-score': 0.4915194999251924, 'support': 134914}, 'weighted avg': {'precision': 0.6122553438535915, 'recall': 0.533147041819233, 'f1-score': 0.5520981051512701, 'support': 134914}}
[[15911  6395  3264]
 [28236 45464  9805]
 [ 6978  8307 10554]]
Evaluating performance on  val set...
159/159 - 1s - 969ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91189814
{'0': {'precision': 0.34572715659248304, 'recall': 0.6028135990621336, 'f1-score': 0.43943084219971806, 'support': 8530}, '1': {'precision': 0.723571308395491, 'recall': 0.5392009361417586, 'f1-score': 0.6179266744893316, 'support': 23928}, '2': {'precision': 0.4184514003294893, 'recall': 0.4058006636352464, 'f1-score': 0.41202894933865736, 'support': 8137}, 'accuracy': 0.5258283039783225, 'macro avg': {'precision': 0.49591662177248774, 'recall': 0.5159383996130462, 'f1-score': 0.48979548867590234, 'support': 40595}, 'weighted avg': {'precision': 0.5830177597611096, 'recall': 0.5258283039783225, 'f1-score': 0.5391495039269115, 'support': 40595}}
[[ 5142  2272  1116]
 [ 7553 12902  3473]
 [ 2178  2657  3302]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2377079
{'0': {'precision': 0.42306755637815985, 'recall': 0.45859643935714134, 'f1-score': 0.4401161347203291, 'support': 94702}, '1': {'precision': 0.3304486047333098, 'recall': 0.5087003806416531, 'f1-score': 0.4006423982869379, 'support': 77238}, '2': {'precision': 0.4902195381343057, 'recall': 0.2523931047294985, 'f1-score': 0.333223605651621, 'support': 102273}, 'accuracy': 0.395801803707337, 'macro avg': {'precision': 0.4145785664152584, 'recall': 0.40656330824276427, 'f1-score': 0.39132737955296265, 'support': 274213}, 'weighted avg': {'precision': 0.42202505307963417, 'recall': 0.395801803707337, 'f1-score': 0.38912988651150515, 'support': 274213}}
[[43430 37278 13994]
 [25098 39291 12849]
 [34127 42333 25813]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.229615
{'0': {'precision': 0.41642829280977767, 'recall': 0.5169895076674738, 'f1-score': 0.46129194872533485, 'support': 24780}, '1': {'precision': 0.376021012844742, 'recall': 0.4950449120735462, 'f1-score': 0.42740115051336197, 'support': 23713}, '2': {'precision': 0.4643083325793902, 'recall': 0.20910239172065354, 'f1-score': 0.28834700528149226, 'support': 24543}, 'accuracy': 0.40640232214250505, 'macro avg': {'precision': 0.4189192127446366, 'recall': 0.4070456038205579, 'f1-score': 0.3923467015067297, 'support': 73036}, 'weighted avg': {'precision': 0.4193986360138785, 'recall': 0.40640232214250505, 'f1-score': 0.3921720592880335, 'support': 73036}}
[[12811  9245  2724]
 [ 8777 11739  3197]
 [ 9176 10235  5132]]
Evaluating performance on  val set...
117/117 - 1s - 772ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2232488
{'0': {'precision': 0.4014359294521617, 'recall': 0.5215980531332387, 'f1-score': 0.4536955371317693, 'support': 9862}, '1': {'precision': 0.3791290057518488, 'recall': 0.4646993654950146, 'f1-score': 0.417575455902982, 'support': 9929}, '2': {'precision': 0.4750259067357513, 'recall': 0.22878818127370731, 'f1-score': 0.30883244627096945, 'support': 10018}, 'accuracy': 0.40424033010164717, 'macro avg': {'precision': 0.4185302806465872, 'recall': 0.4050285333006536, 'f1-score': 0.39336781310190694, 'support': 29809}, 'weighted avg': {'precision': 0.4187373802558315, 'recall': 0.40424033010164717, 'f1-score': 0.3929798227245727, 'support': 29809}}
[[5144 3590 1128]
 [3910 4614 1405]
 [3760 3966 2292]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
860/860 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3497288
{'0': {'precision': 0.3646363729148002, 'recall': 0.4306435411504721, 'f1-score': 0.3949007037323606, 'support': 74665}, '1': {'precision': 0.30535058297396583, 'recall': 0.42622098035135697, 'f1-score': 0.3558006662655012, 'support': 67282}, '2': {'precision': 0.38686324244345804, 'recall': 0.1877251689167532, 'f1-score': 0.25278605032586643, 'support': 77997}, 'accuracy': 0.3431464372749427, 'macro avg': {'precision': 0.3522833994440748, 'recall': 0.34819656347286077, 'f1-score': 0.334495806774576, 'support': 219944}, 'weighted avg': {'precision': 0.3543826839022675, 'recall': 0.3431464372749427, 'f1-score': 0.33254280652856527, 'support': 219944}}
[[32154 31705 10806]
 [26205 28677 12400]
 [29822 33533 14642]]
Evaluating performance on  train set...
320/320 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3267118
{'0': {'precision': 0.38406658739595717, 'recall': 0.44797297297297295, 'f1-score': 0.4135655542605755, 'support': 28120}, '1': {'precision': 0.32839794791869603, 'recall': 0.3716332904648172, 'f1-score': 0.3486804681709272, 'support': 27215}, '2': {'precision': 0.36555156206801215, 'recall': 0.2509204083956428, 'f1-score': 0.2975783219301404, 'support': 26347}, 'accuracy': 0.3589774981023971, 'macro avg': {'precision': 0.3593386991275551, 'recall': 0.3568422239444777, 'f1-score': 0.353274781453881, 'support': 81682}, 'weighted avg': {'precision': 0.35954665159995525, 'recall': 0.3589774981023971, 'f1-score': 0.3545346389041965, 'support': 81682}}
[[12597 10618  4905]
 [10532 10114  6569]
 [ 9670 10066  6611]]
Evaluating performance on  val set...
98/98 - 1s - 688ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3242989
{'0': {'precision': 0.38997508146444315, 'recall': 0.4673788192051459, 'f1-score': 0.4251828631138976, 'support': 8706}, '1': {'precision': 0.33506493506493507, 'recall': 0.4059058453346242, 'f1-score': 0.36709899852241007, 'support': 8263}, '2': {'precision': 0.3491255257914545, 'recall': 0.19732232232232233, 'f1-score': 0.2521384603085778, 'support': 7992}, 'accuracy': 0.36056247746484515, 'macro avg': {'precision': 0.3580551807736109, 'recall': 0.35686899562069746, 'f1-score': 0.34814010731496187, 'support': 24961}, 'weighted avg': {'precision': 0.3587186338606749, 'recall': 0.36056247746484515, 'f1-score': 0.3505497217998646, 'support': 24961}}
[[4069 3372 1265]
 [3234 3354 1675]
 [3131 3284 1577]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.226812
{'0': {'precision': 0.43162759173110693, 'recall': 0.41848225433560543, 'f1-score': 0.4249532891703671, 'support': 167393}, '1': {'precision': 0.34985310848041523, 'recall': 0.520993651895246, 'f1-score': 0.4186069396078088, 'support': 146973}, '2': {'precision': 0.47838720058847867, 'recall': 0.29636064322455324, 'f1-score': 0.3659904047722891, 'support': 175553}, 'accuracy': 0.405475190796846, 'macro avg': {'precision': 0.41995596693333365, 'recall': 0.4119455164851349, 'f1-score': 0.4031835445168217, 'support': 489919}, 'weighted avg': {'precision': 0.4238510990597352, 'recall': 0.405475190796846, 'f1-score': 0.40192120982869295, 'support': 489919}}
[[70051 69255 28087]
 [41760 76572 28641]
 [50484 73042 52027]]
Evaluating performance on  train set...
716/716 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2496039
{'0': {'precision': 0.4279124793959696, 'recall': 0.5181149506687482, 'f1-score': 0.46871337153007814, 'support': 62131}, '1': {'precision': 0.39363744935952977, 'recall': 0.5678789209641729, 'f1-score': 0.4649705754216601, 'support': 59201}, '2': {'precision': 0.4764132032607243, 'recall': 0.1731955757801493, 'f1-score': 0.25403800475059385, 'support': 61751}, 'accuracy': 0.4178705832873615, 'macro avg': {'precision': 0.43265437733874124, 'recall': 0.4197298158043568, 'f1-score': 0.3959073172341107, 'support': 183083}, 'weighted avg': {'precision': 0.4331879672686022, 'recall': 0.4178705832873615, 'f1-score': 0.39509651007153535, 'support': 183083}}
[[32191 24399  5541]
 [19369 33619  6213]
 [23668 27388 10695]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3031477
{'0': {'precision': 0.4238712867521205, 'recall': 0.5567545963229417, 'f1-score': 0.4813095212386896, 'support': 20016}, '1': {'precision': 0.30279129079488026, 'recall': 0.44326903132130263, 'f1-score': 0.359804691884611, 'support': 14463}, '2': {'precision': 0.49304589707927676, 'recall': 0.17571251548946717, 'f1-score': 0.25909007856751326, 'support': 20175}, 'accuracy': 0.3860650638562594, 'macro avg': {'precision': 0.40656949154209254, 'recall': 0.39191204771123717, 'f1-score': 0.366734763896938, 'support': 54654}, 'weighted avg': {'precision': 0.4173652264787793, 'recall': 0.3860650638562594, 'f1-score': 0.36712571762250373, 'support': 54654}}
[[11144  6818  2054]
 [ 6461  6411  1591]
 [ 8686  7944  3545]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
4918/4918 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8513619
{'0': {'precision': 0.3816105227071793, 'recall': 0.6953777109250743, 'f1-score': 0.4927880239695357, 'support': 243321}, '1': {'precision': 0.7811210527590402, 'recall': 0.5468693958945505, 'f1-score': 0.6433347448785458, 'support': 766737}, '2': {'precision': 0.48879622186495175, 'recall': 0.547493578689691, 'f1-score': 0.5164825372508944, 'support': 248781}, 'accuracy': 0.5756979248339145, 'macro avg': {'precision': 0.550509265777057, 'recall': 0.5965802285031052, 'f1-score': 0.5508684353663252, 'support': 1258839}, 'weighted avg': {'precision': 0.64612828129469, 'recall': 0.5756979248339145, 'f1-score': 0.5891661039767975, 'support': 1258839}}
[[169200  47755  26366]
 [231348 419305 116084]
 [ 42836  69739 136206]]
Evaluating performance on  train set...
1403/1403 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8422908
{'0': {'precision': 0.33455247770182417, 'recall': 0.7067270624518118, 'f1-score': 0.454128369347006, 'support': 62256}, '1': {'precision': 0.8130300845513535, 'recall': 0.5297177264380578, 'f1-score': 0.6414852355587733, 'support': 234170}, '2': {'precision': 0.469177670667717, 'recall': 0.5617546439875947, 'f1-score': 0.5113094848345956, 'support': 62554}, 'accuracy': 0.5659981057440526, 'macro avg': {'precision': 0.5389200776402983, 'recall': 0.5993998109591547, 'f1-score': 0.5356410299134583, 'support': 358980}, 'weighted avg': {'precision': 0.6701323025297888, 'recall': 0.5659981057440526, 'f1-score': 0.5863091728987924, 'support': 358980}}
[[ 43998  11935   6323]
 [ 76692 124044  33434]
 [ 10823  16591  35140]]
Evaluating performance on  val set...
480/480 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86058253
{'0': {'precision': 0.34857641841119563, 'recall': 0.6687976720603148, 'f1-score': 0.45829179129278824, 'support': 22681}, '1': {'precision': 0.8008325456995193, 'recall': 0.514170249577152, 'f1-score': 0.6262561134787462, 'support': 77451}, '2': {'precision': 0.4569266786550402, 'recall': 0.5962807172902369, 'f1-score': 0.5173844557993008, 'support': 22585}, 'accuracy': 0.5578607690865977, 'macro avg': {'precision': 0.5354452142552518, 'recall': 0.5930828796425679, 'f1-score': 0.5339774535236118, 'support': 122717}, 'weighted avg': {'precision': 0.6539520382700187, 'recall': 0.5578607690865977, 'f1-score': 0.5751754548887383, 'support': 122717}}
[[15169  4506  3006]
 [24628 39823 13000]
 [ 3720  5398 13467]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
4856/4856 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99396694
{'0': {'precision': 0.4159800649150747, 'recall': 0.49190797507323814, 'f1-score': 0.4507690428565237, 'support': 348862}, '1': {'precision': 0.5492217172522702, 'recall': 0.5644623216235009, 'f1-score': 0.5567377367089013, 'support': 555146}, '2': {'precision': 0.49350499393799435, 'recall': 0.3783450428891374, 'f1-score': 0.42831945910554653, 'support': 338897}, 'accuracy': 0.4933498537699985, 'macro avg': {'precision': 0.4862355920351131, 'recall': 0.4782384465286255, 'f1-score': 0.4786087462236572, 'support': 1242905}, 'weighted avg': {'precision': 0.4966310689736834, 'recall': 0.4933498537699985, 'f1-score': 0.49197895023714977, 'support': 1242905}}
[[171608 122481  54773]
 [164965 313359  76822]
 [ 75966 134711 128220]]
Evaluating performance on  train set...
2076/2076 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8877809
{'0': {'precision': 0.39519795328633744, 'recall': 0.3796771113311642, 'f1-score': 0.38728209013103904, 'support': 113104}, '1': {'precision': 0.6424517404536064, 'recall': 0.7632396698576904, 'f1-score': 0.697656186395448, 'support': 303142}, '2': {'precision': 0.5079856896441577, 'recall': 0.27618005626758363, 'f1-score': 0.35782107821078213, 'support': 115164}, 'accuracy': 0.5760505071413786, 'macro avg': {'precision': 0.5152117944613671, 'recall': 0.473032279152146, 'f1-score': 0.480919784912423, 'support': 531410}, 'weighted avg': {'precision': 0.5606861722121617, 'recall': 0.5760505071413786, 'f1-score': 0.557949891476518, 'support': 531410}}
[[ 42943  60679   9482]
 [ 50448 231370  21324]
 [ 15271  68087  31806]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8883268
{'0': {'precision': 0.3591312388109618, 'recall': 0.5723288186606471, 'f1-score': 0.44133112526744595, 'support': 31896}, '1': {'precision': 0.682924040501569, 'recall': 0.6196398930284028, 'f1-score': 0.6497446589913275, 'support': 86752}, '2': {'precision': 0.5019743812000386, 'recall': 0.32922746510012, 'f1-score': 0.3976501106279087, 'support': 31662}, 'accuracy': 0.5484265850575477, 'macro avg': {'precision': 0.5146765535041898, 'recall': 0.5070653922630567, 'f1-score': 0.4962419649622274, 'support': 150310}, 'weighted avg': {'precision': 0.5760986575228672, 'recall': 0.5484265850575477, 'f1-score': 0.5524166324998133, 'support': 150310}}
[[18255 11053  2588]
 [25243 53755  7754]
 [ 7333 13905 10424]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
4353/4353 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9507384
{'0': {'precision': 0.4117685840492345, 'recall': 0.5172122028235142, 'f1-score': 0.4585062240663901, 'support': 277739}, '1': {'precision': 0.5997383651131405, 'recall': 0.6517926236264231, 'f1-score': 0.6246829619140347, 'support': 555666}, '2': {'precision': 0.49174157442488176, 'recall': 0.28279390351142647, 'f1-score': 0.3590836657889086, 'support': 280883}, 'accuracy': 0.5252331533678906, 'macro avg': {'precision': 0.5010828411957523, 'recall': 0.48393290998712124, 'f1-score': 0.48075761725644445, 'support': 1114288}, 'weighted avg': {'precision': 0.5256632592322567, 'recall': 0.5252331533678906, 'f1-score': 0.5163123359299259, 'support': 1114288}}
[[143650 107943  26146]
 [137533 362179  55954]
 [ 67678 133773  79432]]
Evaluating performance on  train set...
1542/1542 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.044334
{'0': {'precision': 0.43211525712193627, 'recall': 0.40210305329453794, 'f1-score': 0.4165692891040469, 'support': 108604}, '1': {'precision': 0.5327814800099939, 'recall': 0.7241183511008433, 'f1-score': 0.6138863849809572, 'support': 179635}, '2': {'precision': 0.4775807922196333, 'recall': 0.22169030510515028, 'f1-score': 0.3028154086292949, 'support': 106324}, 'accuracy': 0.5000925074069287, 'macro avg': {'precision': 0.48082584311718785, 'recall': 0.4493039031668438, 'f1-score': 0.4444236942380997, 'support': 394563}, 'weighted avg': {'precision': 0.49019788144865667, 'recall': 0.5000925074069287, 'f1-score': 0.4757494173224841, 'support': 394563}}
[[ 43670  54317  10617]
 [ 34391 130077  15167]
 [ 23000  59753  23571]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0025482
{'0': {'precision': 0.41301365948448304, 'recall': 0.4364619194298484, 'f1-score': 0.424414165736771, 'support': 33114}, '1': {'precision': 0.5549543601814111, 'recall': 0.6731368487021917, 'f1-score': 0.6083590965945295, 'support': 57443}, '2': {'precision': 0.4947424892703863, 'recall': 0.2815619943211309, 'f1-score': 0.35888155974549063, 'support': 32753}, 'accuracy': 0.5055713243045982, 'macro avg': {'precision': 0.4875701696454268, 'recall': 0.463720254151057, 'f1-score': 0.46388494069226366, 'support': 123310}, 'weighted avg': {'precision': 0.5008440384651929, 'recall': 0.5055713243045982, 'f1-score': 0.4926970237306873, 'support': 123310}}
[[14453 14726  3935]
 [13293 38667  5483]
 [ 7248 16283  9222]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0390538
{'0': {'precision': 0.41132571751753844, 'recall': 0.5399155925050212, 'f1-score': 0.46692919272138816, 'support': 393330}, '1': {'precision': 0.5360156942417094, 'recall': 0.5932896046701182, 'f1-score': 0.5632002960405342, 'support': 620798}, '2': {'precision': 0.5129357726130653, 'recall': 0.2659149827131347, 'f1-score': 0.35025274399387446, 'support': 393073}, 'accuracy': 0.4869254640950369, 'macro avg': {'precision': 0.4867590614574377, 'recall': 0.46637339329609134, 'f1-score': 0.46012741091859893, 'support': 1407201}, 'weighted avg': {'precision': 0.49471640396316774, 'recall': 0.4869254640950369, 'f1-score': 0.47680876690279456, 'support': 1407201}}
[[212365 145027  35938]
 [189171 368313  63314]
 [114758 173791 104524]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0276324
{'0': {'precision': 0.4085516375476155, 'recall': 0.5342716406695702, 'f1-score': 0.46302962333206715, 'support': 143734}, '1': {'precision': 0.5430353780875039, 'recall': 0.5683035545491592, 'f1-score': 0.5553822088836521, 'support': 238033}, '2': {'precision': 0.48649040122115633, 'recall': 0.3010058115085794, 'f1-score': 0.3719038533610439, 'support': 145057}, 'accuracy': 0.4854201782758568, 'macro avg': {'precision': 0.4793591389520919, 'recall': 0.4678603355757696, 'f1-score': 0.463438561858921, 'support': 526824}, 'weighted avg': {'precision': 0.4907747926319018, 'recall': 0.4854201782758568, 'f1-score': 0.47966617022802044, 'support': 526824}}
[[ 76793  51031  15910]
 [ 72580 135275  30178]
 [ 38591  62803  43663]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0447416
{'0': {'precision': 0.3982505432450762, 'recall': 0.5622996951457828, 'f1-score': 0.46626641711836525, 'support': 51172}, '1': {'precision': 0.5147178697581741, 'recall': 0.4715726001631931, 'f1-score': 0.49220154020483137, 'support': 72307}, '2': {'precision': 0.4798055974526563, 'recall': 0.33801652892561984, 'f1-score': 0.3966197963565838, 'support': 50820}, 'accuracy': 0.4592682688942564, 'macro avg': {'precision': 0.46425800348530216, 'recall': 0.4572962747448652, 'f1-score': 0.4516959178932602, 'support': 174299}, 'weighted avg': {'precision': 0.4703452244137105, 'recall': 0.4592682688942564, 'f1-score': 0.4567187414455236, 'support': 174299}}
[[28774 14804  7594]
 [27179 34098 11030]
 [16298 17344 17178]]
testing model on single stock: results/universal/W2/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 77s - 77s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3268982
{'0': {'precision': 0.3594118126109959, 'recall': 0.6416866625739537, 'f1-score': 0.4607534068641891, 'support': 1176074}, '1': {'precision': 0.3994857372541754, 'recall': 0.4436340518655997, 'f1-score': 0.42040402459444404, 'support': 1404669}, '2': {'precision': 0.5115102790552187, 'recall': 0.06252908499816134, 'f1-score': 0.11143580639010942, 'support': 1229156}, 'accuracy': 0.38181799570014846, 'macro avg': {'precision': 0.4234692763067967, 'recall': 0.3826165998125715, 'f1-score': 0.3308644126162475, 'support': 3809899}, 'weighted avg': {'precision': 0.4232569020150262, 'recall': 0.38181799570014846, 'f1-score': 0.3331795916602221, 'support': 3809899}}
[[754671 400182  21221]
 [729332 623159  52178]
 [615736 536562  76858]]
Evaluating performance on  train set...
6147/6147 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3181951
{'0': {'precision': 0.3889820178755675, 'recall': 0.5731984742179601, 'f1-score': 0.4634554555546438, 'support': 522224}, '1': {'precision': 0.3534376394427249, 'recall': 0.4808575508843204, 'f1-score': 0.40741732581759754, 'support': 518873}, '2': {'precision': 0.4979491470084075, 'recall': 0.09166810671915972, 'f1-score': 0.1548328352337261, 'support': 532388}, 'accuracy': 0.37982249592465134, 'macro avg': {'precision': 0.41345626810889996, 'recall': 0.3819080439404801, 'f1-score': 0.34190187220198914, 'support': 1573485}, 'weighted avg': {'precision': 0.41412987354256786, 'recall': 0.37982249592465134, 'f1-score': 0.3405539648645748, 'support': 1573485}}
[[299338 203667  19219]
 [239383 249504  29986]
 [230821 252764  48803]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3153179
{'0': {'precision': 0.3936173355588709, 'recall': 0.58708511880501, 'f1-score': 0.4712680776559951, 'support': 181558}, '1': {'precision': 0.3751596361662325, 'recall': 0.5097183973001799, 'f1-score': 0.4322081942282253, 'support': 188457}, '2': {'precision': 0.5012981758100954, 'recall': 0.07972051970893726, 'f1-score': 0.13756442404670918, 'support': 186489}, 'accuracy': 0.3908633181432658, 'macro avg': {'precision': 0.4233583825117329, 'recall': 0.39217467860470906, 'f1-score': 0.34701356531030986, 'support': 556504}, 'weighted avg': {'precision': 0.42345145995541095, 'recall': 0.3908633181432658, 'f1-score': 0.3462138658100976, 'support': 556504}}
[[106590  69607   5361]
 [ 82968  96060   9429]
 [ 81238  90384  14867]]
training model: results/universal/W2/deepOF_L1/h10
Epoch 1/50
9940/9940 - 136s - loss: 2.9864 - accuracy10: 0.5075 - val_loss: 3.8106 - val_accuracy10: 0.4909 - 136s/epoch - 14ms/step
Epoch 2/50
9940/9940 - 130s - loss: 2.9804 - accuracy10: 0.5059 - val_loss: 3.8039 - val_accuracy10: 0.4957 - 130s/epoch - 13ms/step
Epoch 3/50
9940/9940 - 130s - loss: 2.9629 - accuracy10: 0.5089 - val_loss: 3.9123 - val_accuracy10: 0.4961 - 130s/epoch - 13ms/step
Epoch 4/50
9940/9940 - 131s - loss: 2.9473 - accuracy10: 0.5125 - val_loss: 3.9584 - val_accuracy10: 0.4966 - 131s/epoch - 13ms/step
Epoch 5/50
9940/9940 - 129s - loss: 2.9339 - accuracy10: 0.5139 - val_loss: 3.9617 - val_accuracy10: 0.4970 - 129s/epoch - 13ms/step
Epoch 6/50
9940/9940 - 131s - loss: 2.9250 - accuracy10: 0.5141 - val_loss: 3.8984 - val_accuracy10: 0.4973 - 131s/epoch - 13ms/step
Epoch 7/50
9940/9940 - 133s - loss: 2.9169 - accuracy10: 0.5147 - val_loss: 4.0005 - val_accuracy10: 0.4974 - 133s/epoch - 13ms/step
Epoch 8/50
9940/9940 - 131s - loss: 2.9065 - accuracy10: 0.5158 - val_loss: 4.0126 - val_accuracy10: 0.4978 - 131s/epoch - 13ms/step
Epoch 9/50
9940/9940 - 129s - loss: 2.8998 - accuracy10: 0.5172 - val_loss: 3.9921 - val_accuracy10: 0.4980 - 129s/epoch - 13ms/step
Epoch 10/50
9940/9940 - 132s - loss: 2.8941 - accuracy10: 0.5177 - val_loss: 4.0030 - val_accuracy10: 0.4980 - 132s/epoch - 13ms/step
Epoch 11/50
9940/9940 - 134s - loss: 2.8887 - accuracy10: 0.5187 - val_loss: 3.9897 - val_accuracy10: 0.4982 - 134s/epoch - 13ms/step
Epoch 12/50
9940/9940 - 131s - loss: 2.8836 - accuracy10: 0.5196 - val_loss: 4.0285 - val_accuracy10: 0.4982 - 131s/epoch - 13ms/step
testing model in sample: results/universal/W2/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 143s - 143s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0382056
{'0': {'precision': 0.4568557104089048, 'recall': 0.06264648523731554, 'f1-score': 0.11018395978909465, 'support': 1585484}, '1': {'precision': 0.5286558380600017, 'recall': 0.9542940240636913, 'f1-score': 0.6803913199392609, 'support': 3511182}, '2': {'precision': 0.4241391418055017, 'recall': 0.04313893790815466, 'f1-score': 0.07831273452406634, 'support': 1624078}, 'accuracy': 0.5237643332345348, 'macro avg': {'precision': 0.4698835634248028, 'recall': 0.35335981573638714, 'f1-score': 0.28962933808414065, 'support': 6720744}, 'weighted avg': {'precision': 0.4864609232397991, 'recall': 0.5237643332345348, 'f1-score': 0.40038106645478594, 'support': 6720744}}
[[  99325 1464173   21986]
 [  87345 3350700   73137]
 [  30740 1523277   70061]]
Evaluating performance on  train set...
9940/9940 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0687544
{'0': {'precision': 0.4547630739013013, 'recall': 0.057912311583712954, 'f1-score': 0.10274096076457356, 'support': 639674}, '1': {'precision': 0.5011109833639926, 'recall': 0.9538389688321657, 'f1-score': 0.6570386602245702, 'support': 1261172}, '2': {'precision': 0.4429144406735625, 'recall': 0.042434887588619935, 'f1-score': 0.07744947157403358, 'support': 642773}, 'accuracy': 0.4982176969113692, 'macro avg': {'precision': 0.4662628326462855, 'recall': 0.3513953893348329, 'f1-score': 0.2790763641877258, 'support': 2543619}, 'weighted avg': {'precision': 0.4747490482737163, 'recall': 0.4982176969113692, 'f1-score': 0.3711805548397444, 'support': 2543619}}
[[  37045  593929    8700]
 [  32610 1202955   25607]
 [  11805  603692   27276]]
Evaluating performance on  val set...
3393/3393 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0716453
{'0': {'precision': 0.4756565555444322, 'recall': 0.06517782838120845, 'f1-score': 0.11464604421280378, 'support': 218694}, '1': {'precision': 0.4973434537430032, 'recall': 0.9513189482173334, 'f1-score': 0.6531987724363179, 'support': 426552}, '2': {'precision': 0.44765164137434144, 'recall': 0.04461108343766969, 'f1-score': 0.08113644896426765, 'support': 222837}, 'accuracy': 0.4953236038489407, 'macro avg': {'precision': 0.4735505502205923, 'recall': 0.35370262001207053, 'f1-score': 0.28299375520446307, 'support': 868083}, 'weighted avg': {'precision': 0.47912403358682715, 'recall': 0.4953236038489407, 'f1-score': 0.3706740572631669, 'support': 868083}}
[[ 14254 201420   3020]
 [ 11519 405787   9246]
 [  4194 208702   9941]]
testing model out of sample: results/universal/W2/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 71s - 71s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9932866
{'0': {'precision': 0.45588435466746524, 'recall': 0.10042036711661739, 'f1-score': 0.16458632280384486, 'support': 833795}, '1': {'precision': 0.5625582487829119, 'recall': 0.9264111669520625, 'f1-score': 0.7000281378865458, 'support': 2010074}, '2': {'precision': 0.45628383693489427, 'recall': 0.09587051658951508, 'f1-score': 0.1584490528026256, 'support': 822839}, 'accuracy': 0.552204047881642, 'macro avg': {'precision': 0.4915754801284238, 'recall': 0.374234016886065, 'f1-score': 0.3410211711643388, 'support': 3666708}, 'weighted avg': {'precision': 0.5144521846200171, 'recall': 0.552204047881642, 'f1-score': 0.45673603472527735, 'support': 3666708}}
[[  83730  729728   20337]
 [  74254 1862155   73665]
 [  25681  718272   78886]]
Evaluating performance on  train set...
5373/5373 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90948397
{'0': {'precision': 0.4323540162661062, 'recall': 0.07236291195240298, 'f1-score': 0.12397601056007021, 'support': 261529}, '1': {'precision': 0.6275529232973934, 'recall': 0.9566348226007547, 'f1-score': 0.7579139290852518, 'support': 847777}, '2': {'precision': 0.4284314231185846, 'recall': 0.0625494197648937, 'f1-score': 0.10916163965882057, 'support': 265582}, 'accuracy': 0.6157228807001006, 'macro avg': {'precision': 0.49611278756069477, 'recall': 0.3638490514393505, 'f1-score': 0.3303505264347142, 'support': 1374888}, 'weighted avg': {'precision': 0.5519589394838218, 'recall': 0.6157228807001006, 'f1-score': 0.5120102042549945, 'support': 1374888}}
[[ 18925 237848   4756]
 [ 19358 811013  17406]
 [  5489 243481  16612]]
Evaluating performance on  val set...
1685/1685 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9457002
{'0': {'precision': 0.4463162034609334, 'recall': 0.07661839336551553, 'f1-score': 0.13078511404561824, 'support': 88869}, '1': {'precision': 0.6000554379095413, 'recall': 0.9485183533136228, 'f1-score': 0.7350810133668614, 'support': 253333}, '2': {'precision': 0.4368860674908119, 'recall': 0.07390326336374015, 'f1-score': 0.12642122360584732, 'support': 88467}, 'accuracy': 0.588939533609338, 'macro avg': {'precision': 0.49441923628709555, 'recall': 0.36634667001429283, 'f1-score': 0.3307624503394423, 'support': 430669}, 'weighted avg': {'precision': 0.5348133222266223, 'recall': 0.588939533609338, 'f1-score': 0.4853544765193818, 'support': 430669}}
[[  6809  80266   1794]
 [  6409 240291   6633]
 [  2038  79891   6538]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1837217
{'0': {'precision': 0.4359966823334255, 'recall': 0.022529215120432013, 'f1-score': 0.04284452896828093, 'support': 69998}, '1': {'precision': 0.45043641149445707, 'recall': 0.9863418170245494, 'f1-score': 0.6184451570169142, 'support': 113119}, '2': {'precision': 0.3919726729291204, 'recall': 0.006616406959479913, 'f1-score': 0.013013154910410524, 'support': 69373}, 'accuracy': 0.44995841419462157, 'macro avg': {'precision': 0.42613525558566767, 'recall': 0.3384958130348204, 'f1-score': 0.22476761363186856, 'support': 252490}, 'weighted avg': {'precision': 0.4303700441242365, 'recall': 0.44995841419462157, 'f1-score': 0.2925252114971601, 'support': 252490}}
[[  1577  68127    294]
 [  1127 111574    418]
 [   913  68001    459]]
Evaluating performance on  train set...
237/237 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2206687
{'0': {'precision': 0.44083969465648853, 'recall': 0.026672824894636567, 'f1-score': 0.050302139474113994, 'support': 17321}, '1': {'precision': 0.42988291192940775, 'recall': 0.9819372843908679, 'f1-score': 0.5979770798663976, 'support': 25799}, '2': {'precision': 0.42678571428571427, 'recall': 0.013721437593294293, 'f1-score': 0.02658805206363333, 'support': 17418}, 'accuracy': 0.4300439393438832, 'macro avg': {'precision': 0.4325027736238702, 'recall': 0.3407771822929329, 'f1-score': 0.22495575713471497, 'support': 60538}, 'weighted avg': {'precision': 0.4321267165654696, 'recall': 0.4300439393438832, 'f1-score': 0.2768774114134706, 'support': 60538}}
[[  462 16695   164]
 [  309 25333   157]
 [  277 16902   239]]
Evaluating performance on  val set...
85/85 - 1s - 576ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1707238
{'0': {'precision': 0.46070460704607047, 'recall': 0.02954466458116093, 'f1-score': 0.05552833578311285, 'support': 5754}, '1': {'precision': 0.4655989385898408, 'recall': 0.9834851366229607, 'f1-score': 0.6319987136195531, 'support': 9991}, '2': {'precision': 0.45161290322580644, 'recall': 0.009569377990430622, 'f1-score': 0.018741633199464525, 'support': 5852}, 'accuracy': 0.4654350141223318, 'macro avg': {'precision': 0.4593054829539059, 'recall': 0.3408663930648508, 'f1-score': 0.23542289420071016, 'support': 21597}, 'weighted avg': {'precision': 0.46050525601109454, 'recall': 0.4654350141223318, 'f1-score': 0.31224175715850594, 'support': 21597}}
[[ 170 5550   34]
 [ 131 9826   34]
 [  68 5728   56]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8061808
{'0': {'precision': 0.4924827730215076, 'recall': 0.09381836986355861, 'f1-score': 0.1576116011761561, 'support': 50278}, '1': {'precision': 0.7062818163995159, 'recall': 0.9612898476713639, 'f1-score': 0.8142876906918786, 'support': 217359}, '2': {'precision': 0.5089675230247213, 'recall': 0.1256055984209582, 'f1-score': 0.20148716718637563, 'support': 50157}, 'accuracy': 0.6921527782148184, 'macro avg': {'precision': 0.5692440374819149, 'recall': 0.3935712719852935, 'f1-score': 0.39112881968480345, 'support': 317794}, 'weighted avg': {'precision': 0.6413149469313727, 'recall': 0.6921527782148184, 'f1-score': 0.6136778733695345, 'support': 317794}}
[[  4717  44232   1329]
 [  3665 208945   4749]
 [  1196  42661   6300]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7074158
{'0': {'precision': 0.4037752223909742, 'recall': 0.11542516901321094, 'f1-score': 0.17952923017557398, 'support': 16123}, '1': {'precision': 0.7822440234371895, 'recall': 0.9585569963077343, 'f1-score': 0.8614717856673817, 'support': 102647}, '2': {'precision': 0.43530192435301923, 'recall': 0.12191042557145512, 'f1-score': 0.1904761904761905, 'support': 16143}, 'accuracy': 0.7576882880078273, 'macro avg': {'precision': 0.5404403900603942, 'recall': 0.3986308636308001, 'f1-score': 0.41049240210638205, 'support': 134913}, 'weighted avg': {'precision': 0.6955011685248838, 'recall': 0.7576882880078273, 'f1-score': 0.699687215497229, 'support': 134913}}
[[ 1861 13652   610]
 [ 2311 98393  1943]
 [  437 13738  1968]]
Evaluating performance on  val set...
159/159 - 1s - 976ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72894347
{'0': {'precision': 0.453781512605042, 'recall': 0.11938098747236552, 'f1-score': 0.18903150525087514, 'support': 5428}, '1': {'precision': 0.7603353722843282, 'recall': 0.9616192603954783, 'f1-score': 0.8492130099974969, 'support': 29989}, '2': {'precision': 0.4927302100161551, 'recall': 0.11782885841220785, 'f1-score': 0.1901792673421668, 'support': 5177}, 'accuracy': 0.7413903532541755, 'macro avg': {'precision': 0.5689490316351751, 'recall': 0.3996097020933505, 'f1-score': 0.4094745941968463, 'support': 40594}, 'weighted avg': {'precision': 0.6852167272776402, 'recall': 0.7413903532541755, 'f1-score': 0.6768899353191872, 'support': 40594}}
[[  648  4665   115]
 [  638 28838   513]
 [  142  4425   610]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2785124
{'0': {'precision': 0.5609091472100081, 'recall': 0.09806936428702911, 'f1-score': 0.16694930875576036, 'support': 92353}, '1': {'precision': 0.3158442088091354, 'recall': 0.9133849909776032, 'f1-score': 0.4693792823397143, 'support': 84789}, '2': {'precision': 0.5501127439545914, 'recall': 0.07288855005872293, 'f1-score': 0.12872178809573626, 'support': 97066}, 'accuracy': 0.341262836970475, 'macro avg': {'precision': 0.47562203332457825, 'recall': 0.36144763510778505, 'f1-score': 0.255016793063737, 'support': 274208}, 'weighted avg': {'precision': 0.48130981115685906, 'recall': 0.341262836970475, 'f1-score': 0.2469329070089987, 'support': 274208}}
[[ 9057 80849  2447]
 [ 4005 77445  3339]
 [ 3085 86906  7075]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1972573
{'0': {'precision': 0.5357062401441767, 'recall': 0.1031178179610598, 'f1-score': 0.17294545454545457, 'support': 23061}, '1': {'precision': 0.38248663307601044, 'recall': 0.9083025357678657, 'f1-score': 0.5382963958884504, 'support': 27329}, '2': {'precision': 0.5074424898511503, 'recall': 0.08280704853597139, 'f1-score': 0.1423798314222796, 'support': 22643}, 'accuracy': 0.39812139717661876, 'macro avg': {'precision': 0.4752117876904458, 'recall': 0.36474246742163224, 'f1-score': 0.2845405606187282, 'support': 73033}, 'weighted avg': {'precision': 0.4696085207645686, 'recall': 0.39812139717661876, 'f1-score': 0.3001835314638981, 'support': 73033}}
[[ 2378 20019   664]
 [ 1350 24823  1156]
 [  711 20057  1875]]
Evaluating performance on  val set...
117/117 - 1s - 730ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1954085
{'0': {'precision': 0.5203562340966921, 'recall': 0.08873942286830115, 'f1-score': 0.15162187210379982, 'support': 9218}, '1': {'precision': 0.3918246005202527, 'recall': 0.922726874945305, 'f1-score': 0.5500691238229386, 'support': 11427}, '2': {'precision': 0.5131876412961568, 'recall': 0.07431252728066347, 'f1-score': 0.12982556476980267, 'support': 9164}, 'accuracy': 0.40400550169411925, 'macro avg': {'precision': 0.47512282530436717, 'recall': 0.3619262750314232, 'f1-score': 0.27717218689884704, 'support': 29809}, 'weighted avg': {'precision': 0.4688810433387975, 'recall': 0.40400550169411925, 'f1-score': 0.2976621748642362, 'support': 29809}}
[[  818  8188   212]
 [  449 10544   434]
 [  305  8178   681]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
860/860 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3671023
{'0': {'precision': 0.4604948124501197, 'recall': 0.02217155738859785, 'f1-score': 0.042306188288200215, 'support': 78073}, '1': {'precision': 0.2990393510947473, 'recall': 0.9790127422636257, 'f1-score': 0.4581399094471984, 'support': 65373}, '2': {'precision': 0.5468025949953661, 'recall': 0.015426248153425803, 'f1-score': 0.03000597576636025, 'support': 76493}, 'accuracy': 0.304229809174362, 'macro avg': {'precision': 0.43544558618007767, 'recall': 0.3388701826018831, 'f1-score': 0.1768173578339196, 'support': 219939}, 'weighted avg': {'precision': 0.44252216246557297, 'recall': 0.304229809174362, 'f1-score': 0.1616275351020626, 'support': 219939}}
[[ 1731 75737   605]
 [  999 64001   373]
 [ 1029 74284  1180]]
Evaluating performance on  train set...
320/320 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3069857
{'0': {'precision': 0.5221291866028708, 'recall': 0.031243289671462313, 'f1-score': 0.05895860066184913, 'support': 27942}, '1': {'precision': 0.3344306049822064, 'recall': 0.9756395995550612, 'f1-score': 0.49811642214860385, 'support': 26970}, '2': {'precision': 0.5116629044394282, 'recall': 0.025402517837797452, 'f1-score': 0.048402021496191903, 'support': 26769}, 'accuracy': 0.3411564500924328, 'macro avg': {'precision': 0.4560742320081685, 'recall': 0.344095135688107, 'f1-score': 0.20182568143554827, 'support': 81681}, 'weighted avg': {'precision': 0.45672349062042067, 'recall': 0.3411564500924328, 'f1-score': 0.20050311380214242, 'support': 81681}}
[[  873 26690   379]
 [  387 26313   270]
 [  412 25677   680]]
Evaluating performance on  val set...
98/98 - 1s - 655ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3152186
{'0': {'precision': 0.5167785234899329, 'recall': 0.02578700602813128, 'f1-score': 0.04912280701754385, 'support': 8958}, '1': {'precision': 0.3314855417201009, 'recall': 0.977552763206051, 'f1-score': 0.4950880444856348, 'support': 8197}, '2': {'precision': 0.5131964809384164, 'recall': 0.022418652318729183, 'f1-score': 0.04296059899349454, 'support': 7806}, 'accuracy': 0.3372861664196146, 'macro avg': {'precision': 0.4538201820494834, 'recall': 0.3419194738509705, 'f1-score': 0.19572381683222442, 'support': 24961}, 'weighted avg': {'precision': 0.4548095320342841, 'recall': 0.3372861664196146, 'f1-score': 0.19364725939085473, 'support': 24961}}
[[ 231 8633   94]
 [ 112 8013   72]
 [ 104 7527  175]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2171897
{'0': {'precision': 0.5082782608695652, 'recall': 0.09600299578225394, 'f1-score': 0.1615017351517429, 'support': 152214}, '1': {'precision': 0.37865708201186354, 'recall': 0.9124933235687659, 'f1-score': 0.535215816475657, 'support': 181609}, '2': {'precision': 0.48881802721088435, 'recall': 0.07365575209333017, 'f1-score': 0.12802111229267696, 'support': 156091}, 'accuracy': 0.3915523949101271, 'macro avg': {'precision': 0.4585844566974377, 'recall': 0.36071735714811665, 'f1-score': 0.27491288797335894, 'support': 489914}, 'weighted avg': {'precision': 0.45402804551914555, 'recall': 0.3915523949101271, 'f1-score': 0.2893687009711729, 'support': 489914}}
[[ 14613 132963   4638]
 [  8507 165717   7385]
 [  5630 138964  11497]]
Evaluating performance on  train set...
716/716 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1683455
{'0': {'precision': 0.46440608722295984, 'recall': 0.0862072234335008, 'f1-score': 0.14542023794294484, 'support': 52745}, '1': {'precision': 0.4234364761120363, 'recall': 0.9213924100310035, 'f1-score': 0.5802242340865468, 'support': 76443}, '2': {'precision': 0.45433625773047603, 'recall': 0.05861397161146674, 'f1-score': 0.10383250065737576, 'support': 53895}, 'accuracy': 0.4268009591278273, 'macro avg': {'precision': 0.44739294035515736, 'recall': 0.35540453502532365, 'f1-score': 0.2764923242289558, 'support': 183083}, 'weighted avg': {'precision': 0.44433566319314954, 'recall': 0.4268009591278273, 'f1-score': 0.31472241660617195, 'support': 183083}}
[[ 4547 46776  1422]
 [ 3637 70434  2372]
 [ 1607 49129  3159]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2734021
{'0': {'precision': 0.4971297359357061, 'recall': 0.07162154711363511, 'f1-score': 0.12520481927710841, 'support': 18137}, '1': {'precision': 0.34153284817866525, 'recall': 0.9235105979292025, 'f1-score': 0.498653553448074, 'support': 18447}, '2': {'precision': 0.46574074074074073, 'recall': 0.055672385168788044, 'f1-score': 0.09945625308947106, 'support': 18070}, 'accuracy': 0.353880777253266, 'macro avg': {'precision': 0.4348011082850374, 'recall': 0.3502681767372086, 'f1-score': 0.24110487527155114, 'support': 54654}, 'weighted avg': {'precision': 0.43423415772318447, 'recall': 0.353880777253266, 'f1-score': 0.24273934937995895, 'support': 54654}}
[[ 1299 16392   446]
 [  703 17036   708]
 [  611 16453  1006]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/EXC
Evaluating performance on  test set...
4918/4918 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73322666
{'0': {'precision': 0.31682288581483675, 'recall': 0.12498797201259158, 'f1-score': 0.17925793032746484, 'support': 145494}, '1': {'precision': 0.7845349534927252, 'recall': 0.9274015604740565, 'f1-score': 0.8500069181066753, 'support': 967142}, '2': {'precision': 0.30250627428060645, 'recall': 0.12037100370730106, 'f1-score': 0.17221537196876283, 'support': 146198}, 'accuracy': 0.7409332763493837, 'macro avg': {'precision': 0.4679547045293894, 'recall': 0.3909201787313164, 'f1-score': 0.40049340680096773, 'support': 1258834}, 'weighted avg': {'precision': 0.6744958789060997, 'recall': 0.7409332763493837, 'f1-score': 0.6937657284897608, 'support': 1258834}}
[[ 18185 122785   4524]
 [ 34161 896929  36052]
 [  5052 123548  17598]]
Evaluating performance on  train set...
1403/1403 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68955034
{'0': {'precision': 0.28507302693286884, 'recall': 0.11807309154480118, 'f1-score': 0.16698389027333557, 'support': 36037}, '1': {'precision': 0.8143618058602701, 'recall': 0.9323030768157399, 'f1-score': 0.8693505259939235, 'support': 286660}, '2': {'precision': 0.33574757526136795, 'recall': 0.14692831353526445, 'f1-score': 0.20440559038361997, 'support': 36283}, 'accuracy': 0.7711850242353334, 'macro avg': {'precision': 0.47839413601816894, 'recall': 0.39910149396526845, 'f1-score': 0.4135800022169596, 'support': 358980}, 'weighted avg': {'precision': 0.7128532542556495, 'recall': 0.7711850242353334, 'f1-score': 0.7316342645024436, 'support': 358980}}
[[  4255  30872    910]
 [  9769 267254   9637]
 [   902  30050   5331]]
Evaluating performance on  val set...
480/480 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71532786
{'0': {'precision': 0.2952, 'recall': 0.13735854675402026, 'f1-score': 0.1874809470582258, 'support': 13432}, '1': {'precision': 0.8024131361698267, 'recall': 0.9203762668831034, 'f1-score': 0.8573561056937363, 'support': 96102}, '2': {'precision': 0.34044259140474664, 'recall': 0.1610529509937794, 'f1-score': 0.2186630960964054, 'support': 13182}, 'accuracy': 0.7531047296196095, 'macro avg': {'precision': 0.47935190919152443, 'recall': 0.40626258821030103, 'f1-score': 0.4211667162827892, 'support': 122716}, 'weighted avg': {'precision': 0.6972713244572023, 'recall': 0.7531047296196095, 'f1-score': 0.7154266557173339, 'support': 122716}}
[[ 1845 11162   425]
 [ 3964 88450  3688]
 [  441 10618  2123]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/AAL
Evaluating performance on  test set...
4856/4856 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9110383
{'0': {'precision': 0.4290388683236383, 'recall': 0.10540589919002863, 'f1-score': 0.169234429643729, 'support': 246305}, '1': {'precision': 0.6305388416626829, 'recall': 0.9295661337886485, 'f1-score': 0.7513950182466265, 'support': 761963}, '2': {'precision': 0.43572988437642834, 'recall': 0.10969944423608033, 'f1-score': 0.17527229888697082, 'support': 234632}, 'accuracy': 0.6114699493120926, 'macro avg': {'precision': 0.4984358647875832, 'recall': 0.3815571590715858, 'f1-score': 0.3653005822591087, 'support': 1242900}, 'weighted avg': {'precision': 0.5538320541502025, 'recall': 0.6114699493120926, 'f1-score': 0.5272692722778185, 'support': 1242900}}
[[ 25962 213774   6569]
 [ 26905 708295  26763]
 [  7645 201248  25739]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77177775
{'0': {'precision': 0.38045218087234894, 'recall': 0.05231014704061843, 'f1-score': 0.09197431587602936, 'support': 72701}, '1': {'precision': 0.7302191595561306, 'recall': 0.9726687475106667, 'f1-score': 0.8341845078425266, 'support': 384139}, '2': {'precision': 0.39036169338265514, 'recall': 0.05094542041035269, 'f1-score': 0.09012834808189604, 'support': 74570}, 'accuracy': 0.7174159312018968, 'macro avg': {'precision': 0.5003443446037116, 'recall': 0.3586414383205459, 'f1-score': 0.3387623906001507, 'support': 531410}, 'weighted avg': {'precision': 0.6346779006979126, 'recall': 0.7174159312018968, 'f1-score': 0.6282348813780142, 'support': 531410}}
[[  3803  68152    746]
 [  5312 373640   5187]
 [   881  69890   3799]]
Evaluating performance on  val set...
588/588 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75376654
{'0': {'precision': 0.4058286211396259, 'recall': 0.09203906481207458, 'f1-score': 0.1500482470247668, 'support': 20274}, '1': {'precision': 0.7456536832112445, 'recall': 0.9578813250819075, 'f1-score': 0.8385477664380123, 'support': 109880}, '2': {'precision': 0.42365072400175513, 'recall': 0.09580273863861877, 'f1-score': 0.1562677025167921, 'support': 20156}, 'accuracy': 0.7254939791098397, 'macro avg': {'precision': 0.5250443427842085, 'recall': 0.38190770951086694, 'f1-score': 0.38162123865985703, 'support': 150310}, 'weighted avg': {'precision': 0.6566382820119466, 'recall': 0.7254939791098397, 'f1-score': 0.6541909290687072, 'support': 150310}}
[[  1866  18058    350]
 [  2351 105252   2277]
 [   381  17844   1931]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/WBA
Evaluating performance on  test set...
4353/4353 - 22s - 22s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83169365
{'0': {'precision': 0.4777141107514653, 'recall': 0.1166720970852006, 'f1-score': 0.187541051167463, 'support': 187217}, '1': {'precision': 0.6837753245177727, 'recall': 0.9518151556581088, 'f1-score': 0.7958321166935034, 'support': 740212}, '2': {'precision': 0.45440498638173055, 'recall': 0.09285859548096374, 'f1-score': 0.15420506758858502, 'support': 186854}, 'accuracy': 0.6674597027864555, 'macro avg': {'precision': 0.5386314738836562, 'recall': 0.38711528274142437, 'f1-score': 0.37919274514985046, 'support': 1114283}, 'weighted avg': {'precision': 0.6106907244478095, 'recall': 0.6674597027864555, 'f1-score': 0.5860353154786961, 'support': 1114283}}
[[ 21843 160485   4889]
 [ 19723 704545  15944]
 [  4158 165345  17351]]
Evaluating performance on  train set...
1542/1542 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8744113
{'0': {'precision': 0.49146510981373365, 'recall': 0.11809582342409748, 'f1-score': 0.19043207549202315, 'support': 74846}, '1': {'precision': 0.6473333976275436, 'recall': 0.9495721555518729, 'f1-score': 0.7698511267896408, 'support': 247403}, '2': {'precision': 0.47987117552334946, 'recall': 0.09066143017161506, 'f1-score': 0.1525094504216342, 'support': 72313}, 'accuracy': 0.6344300768953929, 'macro avg': {'precision': 0.5395565609882089, 'recall': 0.3861098030491952, 'f1-score': 0.3709308842344327, 'support': 394562}, 'weighted avg': {'precision': 0.5870746460581248, 'recall': 0.6344300768953929, 'f1-score': 0.5467961266714816, 'support': 394562}}
[[  8839  64315   1692]
 [  7062 234927   5414]
 [  2084  63673   6556]]
Evaluating performance on  val set...
482/482 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8574307
{'0': {'precision': 0.5049934867564047, 'recall': 0.10514895348311559, 'f1-score': 0.17405619785235904, 'support': 22121}, '1': {'precision': 0.6620414952289241, 'recall': 0.954150317314122, 'f1-score': 0.7816981843929112, 'support': 79259}, '2': {'precision': 0.46568298680974735, 'recall': 0.09498837156277076, 'f1-score': 0.15779107643360352, 'support': 21929}, 'accuracy': 0.6490523806048221, 'macro avg': {'precision': 0.5442393229316921, 'recall': 0.3847625474533362, 'f1-score': 0.3711818195596246, 'support': 123309}, 'weighted avg': {'precision': 0.5989479276341441, 'recall': 0.6490523806048221, 'f1-score': 0.5617360781824706, 'support': 123309}}
[[ 2326 19259   536]
 [ 1780 75625  1854]
 [  500 19346  2083]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.898152
{'0': {'precision': 0.4354661153474385, 'recall': 0.11884950077860218, 'f1-score': 0.18673452058500975, 'support': 272925}, '1': {'precision': 0.6361504308928144, 'recall': 0.9203056894245183, 'f1-score': 0.7522895804619958, 'support': 868594}, '2': {'precision': 0.44703208942480727, 'recall': 0.12809915800012797, 'f1-score': 0.19913518700557037, 'support': 265677}, 'accuracy': 0.6152959502443156, 'macro avg': {'precision': 0.5062162118883534, 'recall': 0.38908478273441616, 'f1-score': 0.37938642935085864, 'support': 1407196}, 'weighted avg': {'precision': 0.5615224754222066, 'recall': 0.6152959502443156, 'f1-score': 0.5381655248881815, 'support': 1407196}}
[[ 32437 234038   6450]
 [ 33574 799372  35648]
 [  8477 223167  34033]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8827155
{'0': {'precision': 0.4242766483811982, 'recall': 0.08243383036749877, 'f1-score': 0.13804628373944616, 'support': 95701}, '1': {'precision': 0.646347682065173, 'recall': 0.9485552299389045, 'f1-score': 0.7688198066068122, 'support': 334067}, '2': {'precision': 0.42413447623288436, 'recall': 0.07851137487636003, 'f1-score': 0.13249639199457494, 'support': 97056}, 'accuracy': 0.6309317722806858, 'macro avg': {'precision': 0.4982529355597518, 'recall': 0.36983347839425446, 'f1-score': 0.34645416078027774, 'support': 526824}, 'weighted avg': {'precision': 0.5650690294224523, 'recall': 0.6309317722806858, 'f1-score': 0.5370067870015264, 'support': 526824}}
[[  7889  86002   1810]
 [  8650 316881   8536]
 [  2055  87381   7620]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9379724
{'0': {'precision': 0.4308145240431796, 'recall': 0.07422645550357887, 'f1-score': 0.12663461538461535, 'support': 35486}, '1': {'precision': 0.6049662377530621, 'recall': 0.9435938525697958, 'f1-score': 0.7372557597516962, 'support': 103588}, '2': {'precision': 0.4237980042334442, 'recall': 0.07957416607523066, 'f1-score': 0.13398981811228755, 'support': 35225}, 'accuracy': 0.5919827422991526, 'macro avg': {'precision': 0.48652625534322863, 'recall': 0.36579815804953514, 'f1-score': 0.3326267310828664, 'support': 174299}, 'weighted avg': {'precision': 0.5328969846968918, 'recall': 0.5919827422991526, 'f1-score': 0.4910205850045182, 'support': 174299}}
[[ 2634 32098   754]
 [ 2786 97745  3057]
 [  694 31728  2803]]
testing model on single stock: results/universal/W2/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 74s - 74s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1996671
{'0': {'precision': 0.5245590688805911, 'recall': 0.046976135294400145, 'f1-score': 0.0862300611043181, 'support': 1124422}, '1': {'precision': 0.40399317516332933, 'recall': 0.9707138799917954, 'f1-score': 0.5705386919815408, 'support': 1521096}, '2': {'precision': 0.5086905287965827, 'recall': 0.023727730561261998, 'f1-score': 0.045340562966075, 'support': 1164376}, 'accuracy': 0.40867226227291364, 'macro avg': {'precision': 0.4790809242801677, 'recall': 0.34713924861581913, 'f1-score': 0.23403643868397797, 'support': 3809894}, 'weighted avg': {'precision': 0.47157354070090696, 'recall': 0.40867226227291364, 'f1-score': 0.26709314309783416, 'support': 3809894}}
[[  52821 1060904   10697]
 [  28560 1476549   15987]
 [  19315 1117433   27628]]
Evaluating performance on  train set...
6147/6147 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.222698
{'0': {'precision': 0.5062673269672772, 'recall': 0.04407851033367304, 'f1-score': 0.08109631468376194, 'support': 484726}, '1': {'precision': 0.3827723314369702, 'recall': 0.964141779304158, 'f1-score': 0.5479886115336284, 'support': 597492}, '2': {'precision': 0.48216323115539667, 'recall': 0.02580684559250099, 'f1-score': 0.04899151594310987, 'support': 491265}, 'accuracy': 0.38774553013918805, 'macro avg': {'precision': 0.45706762985321464, 'recall': 0.34467571174344397, 'f1-score': 0.22602548072016673, 'support': 1573483}, 'weighted avg': {'precision': 0.45184743777977554, 'recall': 0.38774553013918805, 'f1-score': 0.24836373878436802, 'support': 1573483}}
[[ 21366 458277   5083]
 [ 12892 576067   8533]
 [  7945 470642  12678]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.211869
{'0': {'precision': 0.5309482257126236, 'recall': 0.054084323427454, 'f1-score': 0.0981688133587889, 'support': 168755}, '1': {'precision': 0.38702116488057686, 'recall': 0.9620102814487923, 'f1-score': 0.551978741142704, 'support': 213005}, '2': {'precision': 0.5020810070043651, 'recall': 0.0283044242115564, 'f1-score': 0.05358787392873007, 'support': 174743}, 'accuracy': 0.39350371875803003, 'macro avg': {'precision': 0.47335013253252184, 'recall': 0.34813300969593425, 'f1-score': 0.23457847614340765, 'support': 556503}, 'weighted avg': {'precision': 0.46679488243995954, 'recall': 0.39350371875803003, 'f1-score': 0.257868898657136, 'support': 556503}}
[[  9127 157767   1861]
 [  5048 204913   3044]
 [  3015 166782   4946]]
training model: results/universal/W2/deepOF_L1/h20
Epoch 1/50
9940/9940 - 132s - loss: 3.0390 - accuracy20: 0.4866 - val_loss: 3.5783 - val_accuracy20: 0.4411 - 132s/epoch - 13ms/step
Epoch 2/50
9940/9940 - 129s - loss: 3.0252 - accuracy20: 0.4892 - val_loss: 3.5849 - val_accuracy20: 0.4434 - 129s/epoch - 13ms/step
Epoch 3/50
9940/9940 - 129s - loss: 3.0145 - accuracy20: 0.4914 - val_loss: 3.6016 - val_accuracy20: 0.4442 - 129s/epoch - 13ms/step
Epoch 4/50
9940/9940 - 132s - loss: 3.0024 - accuracy20: 0.4943 - val_loss: 3.6219 - val_accuracy20: 0.4444 - 132s/epoch - 13ms/step
Epoch 5/50
9940/9940 - 130s - loss: 2.9930 - accuracy20: 0.4962 - val_loss: 3.6931 - val_accuracy20: 0.4446 - 130s/epoch - 13ms/step
Epoch 6/50
9940/9940 - 130s - loss: 2.9825 - accuracy20: 0.4979 - val_loss: 3.7537 - val_accuracy20: 0.4456 - 130s/epoch - 13ms/step
Epoch 7/50
9940/9940 - 131s - loss: 2.9731 - accuracy20: 0.4993 - val_loss: 3.7511 - val_accuracy20: 0.4464 - 131s/epoch - 13ms/step
Epoch 8/50
9940/9940 - 131s - loss: 2.9645 - accuracy20: 0.5003 - val_loss: 3.7451 - val_accuracy20: 0.4483 - 131s/epoch - 13ms/step
Epoch 9/50
9940/9940 - 132s - loss: 2.9571 - accuracy20: 0.5014 - val_loss: 3.7407 - val_accuracy20: 0.4483 - 132s/epoch - 13ms/step
Epoch 10/50
9940/9940 - 134s - loss: 2.9508 - accuracy20: 0.5026 - val_loss: 3.7572 - val_accuracy20: 0.4483 - 134s/epoch - 13ms/step
Epoch 11/50
9940/9940 - 130s - loss: 2.9453 - accuracy20: 0.5034 - val_loss: 3.7443 - val_accuracy20: 0.4496 - 130s/epoch - 13ms/step
testing model in sample: results/universal/W2/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 156s - 156s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0711507
{'0': {'precision': 0.473872366064704, 'recall': 0.07911007245623623, 'f1-score': 0.13558505515891622, 'support': 1789494}, '1': {'precision': 0.46572850228735385, 'recall': 0.9526146909233241, 'f1-score': 0.6256029082162344, 'support': 3086273}, '2': {'precision': 0.49486480054189624, 'recall': 0.029302262304624935, 'f1-score': 0.055328383710559134, 'support': 1844977}, 'accuracy': 0.46656411849640456, 'macro avg': {'precision': 0.47815522296465135, 'recall': 0.3536756752280617, 'f1-score': 0.2721721156952366, 'support': 6720744}, 'weighted avg': {'precision': 0.47589541171154204, 'recall': 0.46656411849640456, 'f1-score': 0.33857703885744617, 'support': 6720744}}
[[ 141567 1632081   15846]
 [ 106906 2940029   39338]
 [  50272 1740643   54062]]
Evaluating performance on  train set...
9940/9940 - 58s - 58s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0943462
{'0': {'precision': 0.47632059872944044, 'recall': 0.07630410113283723, 'f1-score': 0.13153670165724612, 'support': 717314}, '1': {'precision': 0.4406498761427048, 'recall': 0.9496593839055503, 'f1-score': 0.601977275014645, 'support': 1105350}, '2': {'precision': 0.4989899424052265, 'recall': 0.032205893571720844, 'f1-score': 0.06050656232613712, 'support': 720955}, 'accuracy': 0.4433285802630032, 'macro avg': {'precision': 0.4719868057591239, 'recall': 0.35272312620336943, 'f1-score': 0.2646735129993428, 'support': 2543619}, 'weighted avg': {'precision': 0.4672449248405947, 'recall': 0.4433285802630032, 'f1-score': 0.3158378700551631, 'support': 2543619}}
[[  54734  654976    7604]
 [  39935 1049706   15709]
 [  20241  677495   23219]]
Evaluating performance on  val set...
3393/3393 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.096602
{'0': {'precision': 0.4936401314849221, 'recall': 0.08424801209815112, 'f1-score': 0.14393165954786957, 'support': 245988}, '1': {'precision': 0.43673063255152805, 'recall': 0.9481087521198721, 'f1-score': 0.598001673875275, 'support': 372664}, '2': {'precision': 0.5182126961817756, 'recall': 0.03547674507178338, 'f1-score': 0.06640726134773196, 'support': 249431}, 'accuracy': 0.44108570263442554, 'macro avg': {'precision': 0.4828611534060752, 'recall': 0.3559445030966022, 'f1-score': 0.2694468649236255, 'support': 868083}, 'weighted avg': {'precision': 0.47626971629926185, 'recall': 0.44108570263442554, 'f1-score': 0.31658630161763673, 'support': 868083}}
[[ 20724 222497   2767]
 [ 13878 353326   5460]
 [  7380 233202   8849]]
testing model out of sample: results/universal/W2/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 85s - 85s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0710007
{'0': {'precision': 0.4560714150907787, 'recall': 0.1210410004888643, 'f1-score': 0.1913087949130832, 'support': 998232}, '1': {'precision': 0.46800865835316213, 'recall': 0.9160555823154585, 'f1-score': 0.6195116259188567, 'support': 1669164}, '2': {'precision': 0.5190799441490151, 'recall': 0.06993911811326192, 'f1-score': 0.12326933320164099, 'support': 999312}, 'accuracy': 0.4690215310300138, 'macro avg': {'precision': 0.481053339197652, 'recall': 0.36901190030586156, 'f1-score': 0.31136325134452697, 'support': 3666708}, 'weighted avg': {'precision': 0.4786776318669871, 'recall': 0.4690215310300138, 'f1-score': 0.3676926519453683, 'support': 3666708}}
[[ 120827  857918   19487]
 [  94851 1529047   45266]
 [  49252  880169   69891]]
Evaluating performance on  train set...
5373/5373 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0052575
{'0': {'precision': 0.45127170758104984, 'recall': 0.08457028008776944, 'f1-score': 0.14244562980907347, 'support': 325398}, '1': {'precision': 0.5337502351973403, 'recall': 0.9539959615836262, 'f1-score': 0.6845194025356189, 'support': 719589}, '2': {'precision': 0.5012791409937665, 'recall': 0.04217022682562344, 'f1-score': 0.0777958585672186, 'support': 329901}, 'accuracy': 0.5294365795613897, 'macro avg': {'precision': 0.4954336945907189, 'recall': 0.36024548949900637, 'f1-score': 0.3015869636373037, 'support': 1374888}, 'weighted avg': {'precision': 0.5064384873472326, 'recall': 0.5294365795613897, 'f1-score': 0.4106436938405167, 'support': 1374888}}
[[ 27519 293888   3991]
 [ 23254 686485   9850]
 [ 10208 305781  13912]]
Evaluating performance on  val set...
1685/1685 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0332297
{'0': {'precision': 0.4672465477419038, 'recall': 0.08740979085267754, 'f1-score': 0.14726929153371954, 'support': 108775}, '1': {'precision': 0.5063258552776279, 'recall': 0.9502239733577241, 'f1-score': 0.6606337202571666, 'support': 213195}, '2': {'precision': 0.519283476898982, 'recall': 0.0488044968214979, 'f1-score': 0.08922339486187612, 'support': 108699}, 'accuracy': 0.5047867387715391, 'macro avg': {'precision': 0.49761862663950457, 'recall': 0.36214608701063317, 'f1-score': 0.29904213555092074, 'support': 430669}, 'weighted avg': {'precision': 0.49972595799089764, 'recall': 0.5047867387715391, 'f1-score': 0.3867506529954514, 'support': 430669}}
[[  9508  97723   1544]
 [  7245 202583   3367]
 [  3596  99798   5305]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
987/987 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2137688
{'0': {'precision': 0.432076492873895, 'recall': 0.02988482799066645, 'f1-score': 0.05590308575696746, 'support': 80141}, '1': {'precision': 0.36229400078165713, 'recall': 0.981060313750565, 'f1-score': 0.52917128747313, 'support': 90709}, '2': {'precision': 0.39695817490494295, 'recall': 0.0063939245467907885, 'f1-score': 0.012585136519799891, 'support': 81640}, 'accuracy': 0.36400649530674484, 'macro avg': {'precision': 0.3971095561868317, 'recall': 0.3391130220960074, 'f1-score': 0.19921983658329911, 'support': 252490}, 'weighted avg': {'precision': 0.39565144810309205, 'recall': 0.36400649530674484, 'f1-score': 0.21192196941077168, 'support': 252490}}
[[ 2395 77327   419]
 [ 1344 88991   374]
 [ 1804 79314   522]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2493324
{'0': {'precision': 0.41957255343082117, 'recall': 0.037333600240216196, 'f1-score': 0.06856617647058823, 'support': 19982}, '1': {'precision': 0.3353367448569564, 'recall': 0.9720258835241413, 'f1-score': 0.4986466472600991, 'support': 20090}, '2': {'precision': 0.45627376425855515, 'recall': 0.011726766344180592, 'f1-score': 0.022865853658536585, 'support': 20466}, 'accuracy': 0.33886154151111697, 'macro avg': {'precision': 0.40372768751544424, 'recall': 0.34036208336951274, 'f1-score': 0.19669289246307464, 'support': 60538}, 'weighted avg': {'precision': 0.4040257825852607, 'recall': 0.33886154151111697, 'f1-score': 0.1958418355853562, 'support': 60538}}
[[  746 19076   160]
 [  436 19528   126]
 [  596 19630   240]]
Evaluating performance on  val set...
85/85 - 1s - 579ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.209916
{'0': {'precision': 0.4665461121157324, 'recall': 0.03833580980683507, 'f1-score': 0.07084992448166966, 'support': 6730}, '1': {'precision': 0.3696743652273705, 'recall': 0.9746596066565809, 'f1-score': 0.53603744149766, 'support': 7932}, '2': {'precision': 0.42748091603053434, 'recall': 0.008074981975486662, 'f1-score': 0.01585055193886216, 'support': 6935}, 'accuracy': 0.3725054405704496, 'macro avg': {'precision': 0.4212337977912124, 'recall': 0.3403567994796342, 'f1-score': 0.20757930597273064, 'support': 21597}, 'weighted avg': {'precision': 0.4184235103113459, 'recall': 0.3725054405704496, 'f1-score': 0.22404003127365307, 'support': 21597}}
[[ 258 6433   39]
 [ 165 7731   36]
 [ 130 6749   56]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92082787
{'0': {'precision': 0.5271739130434783, 'recall': 0.09430846631068861, 'f1-score': 0.15999476371252783, 'support': 64798}, '1': {'precision': 0.6078510846408425, 'recall': 0.9684069526050922, 'f1-score': 0.7468919461222642, 'support': 187383}, '2': {'precision': 0.6495436766623207, 'recall': 0.07593007483273131, 'f1-score': 0.1359660494248325, 'support': 65613}, 'accuracy': 0.6059145232446176, 'macro avg': {'precision': 0.5948562247822138, 'recall': 0.37954849791617074, 'f1-score': 0.3476175864198749, 'support': 317794}, 'weighted avg': {'precision': 0.6000090759029155, 'recall': 0.6059145232446176, 'f1-score': 0.5010898086187409, 'support': 317794}}
[[  6111  57922    765]
 [  3997 181463   1923]
 [  1484  59147   4982]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82599705
{'0': {'precision': 0.47756183745583036, 'recall': 0.12467712177121772, 'f1-score': 0.19773226042428677, 'support': 21680}, '1': {'precision': 0.6978949620110758, 'recall': 0.9639961041377122, 'f1-score': 0.809641544117647, 'support': 91379}, '2': {'precision': 0.5491424802110818, 'recall': 0.0761874256429029, 'f1-score': 0.1338101743952423, 'support': 21854}, 'accuracy': 0.6853083097996486, 'macro avg': {'precision': 0.5748664265593293, 'recall': 0.388286883850611, 'f1-score': 0.38039465964572533, 'support': 134913}, 'weighted avg': {'precision': 0.6383924761304357, 'recall': 0.6853083097996486, 'f1-score': 0.6018349426456949, 'support': 134913}}
[[ 2703 18521   456]
 [ 2379 88089   911]
 [  578 19611  1665]]
Evaluating performance on  val set...
159/159 - 1s - 928ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8523246
{'0': {'precision': 0.5092364532019704, 'recall': 0.11377080753886366, 'f1-score': 0.18598898009670525, 'support': 7269}, '1': {'precision': 0.6702939402679813, 'recall': 0.9685155717208457, 'f1-score': 0.7922703816770235, 'support': 26394}, '2': {'precision': 0.6398559423769508, 'recall': 0.07690088010388112, 'f1-score': 0.13730036063884596, 'support': 6931}, 'accuracy': 0.6632260925259891, 'macro avg': {'precision': 0.6064621119489675, 'recall': 0.3863957531211968, 'f1-score': 0.3718532408041915, 'support': 40594}, 'weighted avg': {'precision': 0.636257071842461, 'recall': 0.6632260925259891, 'f1-score': 0.57187680814638, 'support': 40594}}
[[  827  6358    84]
 [  615 25563   216]
 [  182  6216   533]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.23821
{'0': {'precision': 0.5083841788624824, 'recall': 0.12520227812454027, 'f1-score': 0.20092240499818723, 'support': 95166}, '1': {'precision': 0.2845116939338882, 'recall': 0.88304281365207, 'f1-score': 0.43036278836823494, 'support': 77849}, '2': {'precision': 0.5790163934426229, 'recall': 0.05235540007708043, 'f1-score': 0.09602784046110764, 'support': 101193}, 'accuracy': 0.3134737133854592, 'macro avg': {'precision': 0.45730408874633116, 'recall': 0.3535334972845636, 'f1-score': 0.24243767794250995, 'support': 274208}, 'weighted avg': {'precision': 0.4708916061104184, 'recall': 0.3134737133854592, 'f1-score': 0.22735164388171414, 'support': 274208}}
[[11915 81730  1521]
 [ 6774 68744  2331]
 [ 4748 91147  5298]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1795521
{'0': {'precision': 0.5108828939301042, 'recall': 0.13698573835847272, 'f1-score': 0.2160427807486631, 'support': 24331}, '1': {'precision': 0.3451118040647476, 'recall': 0.891118753793243, 'f1-score': 0.49753761351827586, 'support': 24715}, '2': {'precision': 0.5471768202080238, 'recall': 0.061408262809021556, 'f1-score': 0.11042392893286855, 'support': 23987}, 'accuracy': 0.3673681760300138, 'macro avg': {'precision': 0.4677238394009586, 'recall': 0.3631709183202458, 'f1-score': 0.27466810773326916, 'support': 73033}, 'weighted avg': {'precision': 0.46670491854371954, 'recall': 0.3673681760300138, 'f1-score': 0.27661355551343403, 'support': 73033}}
[[ 3333 20532   466]
 [ 1938 22024   753]
 [ 1253 21261  1473]]
Evaluating performance on  val set...
117/117 - 1s - 745ms/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1837223
{'0': {'precision': 0.48204419889502764, 'recall': 0.10745073891625616, 'f1-score': 0.175730110775428, 'support': 9744}, '1': {'precision': 0.350211920033007, 'recall': 0.9064168527327444, 'f1-score': 0.5052215789188896, 'support': 10301}, '2': {'precision': 0.5450819672131147, 'recall': 0.054485866448176976, 'f1-score': 0.09906890130353817, 'support': 9764}, 'accuracy': 0.3661981280821229, 'macro avg': {'precision': 0.4591126953803831, 'recall': 0.3561178193657258, 'f1-score': 0.26000686366595194, 'support': 29809}, 'weighted avg': {'precision': 0.4571354956611093, 'recall': 0.3661981280821229, 'f1-score': 0.26448087611684384, 'support': 29809}}
[[1047 8535  162]
 [ 682 9337  282]
 [ 443 8789  532]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2469063
{'0': {'precision': 0.3918768287585342, 'recall': 0.07465360726230291, 'f1-score': 0.12541526387371518, 'support': 75348}, '1': {'precision': 0.30320233183326606, 'recall': 0.9170253004333387, 'f1-score': 0.4557251484708886, 'support': 67153}, '2': {'precision': 0.5368505839710028, 'recall': 0.01721377101681345, 'f1-score': 0.03335794096670462, 'support': 77438}, 'accuracy': 0.3116273148463892, 'macro avg': {'precision': 0.410643248187601, 'recall': 0.33629755957081836, 'f1-score': 0.20483278443710282, 'support': 219939}, 'weighted avg': {'precision': 0.4158458345470511, 'recall': 0.3116273148463892, 'f1-score': 0.19385498902060094, 'support': 219939}}
[[ 5625 69092   631]
 [ 5053 61581   519]
 [ 3676 72429  1333]]
Evaluating performance on  train set...
320/320 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2160673
{'0': {'precision': 0.4564725252109488, 'recall': 0.07859117000921267, 'f1-score': 0.13409509990629062, 'support': 28222}, '1': {'precision': 0.3329798655938921, 'recall': 0.9308555971393634, 'f1-score': 0.49050082983500926, 'support': 26987}, '2': {'precision': 0.485859318346628, 'recall': 0.025309761257177394, 'f1-score': 0.04811317367419481, 'support': 26472}, 'accuracy': 0.34290716323257553, 'macro avg': {'precision': 0.4251039030504897, 'recall': 0.3449188428019178, 'f1-score': 0.22423636780516487, 'support': 81681}, 'weighted avg': {'precision': 0.42519512633975715, 'recall': 0.34290716323257553, 'f1-score': 0.22398390981765667, 'support': 81681}}
[[ 2218 25625   379]
 [ 1536 25121   330]
 [ 1105 24697   670]]
Evaluating performance on  val set...
98/98 - 1s - 645ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2256052
{'0': {'precision': 0.4456591639871383, 'recall': 0.07776032315978457, 'f1-score': 0.13241616509028376, 'support': 8912}, '1': {'precision': 0.324736225087925, 'recall': 0.9275703832320477, 'f1-score': 0.48105743873416096, 'support': 8063}, '2': {'precision': 0.5493333333333333, 'recall': 0.025795141497620837, 'f1-score': 0.0492764023442172, 'support': 7986}, 'accuracy': 0.3356436040222747, 'macro avg': {'precision': 0.43990957413613224, 'recall': 0.343708615963151, 'f1-score': 0.2209166687228873, 'support': 24961}, 'weighted avg': {'precision': 0.43976758352378975, 'recall': 0.3356436040222747, 'f1-score': 0.2184359737558218, 'support': 24961}}
[[ 693 8122   97]
 [ 512 7479   72]
 [ 350 7430  206]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2431864
{'0': {'precision': 0.48163471241170536, 'recall': 0.14031137189421822, 'f1-score': 0.2173141015134131, 'support': 170086}, '1': {'precision': 0.2968246849245504, 'recall': 0.8755153322274252, 'f1-score': 0.4433433284421099, 'support': 142869}, '2': {'precision': 0.5198079864957535, 'recall': 0.055685215219344594, 'f1-score': 0.10059413217909717, 'support': 176959}, 'accuracy': 0.32414464579497626, 'macro avg': {'precision': 0.43275579461066976, 'recall': 0.3571706397803293, 'f1-score': 0.2537505207115401, 'support': 489914}, 'weighted avg': {'precision': 0.44152865418837794, 'recall': 0.32414464579497626, 'f1-score': 0.24106912906650357, 'support': 489914}}
[[ 23865 141817   4404]
 [ 13086 125084   4699]
 [ 12599 154506   9854]]
Evaluating performance on  train set...
716/716 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2091019
{'0': {'precision': 0.4713400975095533, 'recall': 0.11816004624659344, 'f1-score': 0.18895183761868917, 'support': 60545}, '1': {'precision': 0.338126265143265, 'recall': 0.901464822925381, 'f1-score': 0.49178948875585027, 'support': 60963}, '2': {'precision': 0.5040937848902122, 'recall': 0.043995127892813644, 'f1-score': 0.08092727299884987, 'support': 61575}, 'accuracy': 0.3540416095432126, 'macro avg': {'precision': 0.4378533825143435, 'recall': 0.35453999902159605, 'f1-score': 0.2538895331244631, 'support': 183083}, 'weighted avg': {'precision': 0.4379983532619609, 'recall': 0.3540416095432126, 'f1-score': 0.2534596245776539, 'support': 183083}}
[[ 7154 52137  1254]
 [ 4596 54956  1411]
 [ 3428 55438  2709]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2949028
{'0': {'precision': 0.482886216466235, 'recall': 0.10281156137672953, 'f1-score': 0.16952868103763244, 'support': 20309}, '1': {'precision': 0.257762312633833, 'recall': 0.9048135299219427, 'f1-score': 0.4012242804948401, 'support': 13836}, '2': {'precision': 0.5187287173666288, 'recall': 0.04456580038032083, 'f1-score': 0.08207983476269587, 'support': 20509}, 'accuracy': 0.2839865334650712, 'macro avg': {'precision': 0.41979241548889895, 'recall': 0.35073029722633103, 'f1-score': 0.21761093209838947, 'support': 54654}, 'weighted avg': {'precision': 0.4393446553278199, 'recall': 0.2839865334650712, 'f1-score': 0.1953685450153331, 'support': 54654}}
[[ 2088 17781   440]
 [  909 12519   408]
 [ 1327 18268   914]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/EXC
Evaluating performance on  test set...
4918/4918 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8379444
{'0': {'precision': 0.36725520065929124, 'recall': 0.14515197725893134, 'f1-score': 0.2080681958863166, 'support': 202629}, '1': {'precision': 0.6909335935032392, 'recall': 0.9259796226725694, 'f1-score': 0.7913726250776923, 'support': 850455}, '2': {'precision': 0.3857106208311955, 'recall': 0.0730741190765492, 'f1-score': 0.12287010174477996, 'support': 205750}, 'accuracy': 0.660890157081871, 'macro avg': {'precision': 0.4812998049979087, 'recall': 0.3814019063360166, 'f1-score': 0.37410364090292964, 'support': 1258834}, 'weighted avg': {'precision': 0.5889453601930099, 'recall': 0.660890157081871, 'f1-score': 0.5882173342622504, 'support': 1258834}}
[[ 29412 169629   3588]
 [ 42594 787504  20357]
 [  8080 182635  15035]]
Evaluating performance on  train set...
1403/1403 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79833794
{'0': {'precision': 0.34720537463842494, 'recall': 0.14583864077289385, 'f1-score': 0.2054013772545989, 'support': 51029}, '1': {'precision': 0.7313407202725787, 'recall': 0.9295623667356621, 'f1-score': 0.8186230926348672, 'support': 256539}, '2': {'precision': 0.42919389978213507, 'recall': 0.09579475608807282, 'f1-score': 0.15663014613513127, 'support': 51412}, 'accuracy': 0.6987464482700986, 'macro avg': {'precision': 0.5025799982310463, 'recall': 0.3903985878655429, 'f1-score': 0.39355153867486575, 'support': 358980}, 'weighted avg': {'precision': 0.6334633597304317, 'recall': 0.6987464482700986, 'f1-score': 0.6366450652250278, 'support': 358980}}
[[  7442  42819    768]
 [ 12288 238469   5782]
 [  1704  44783   4925]]
Evaluating performance on  val set...
480/480 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8165219
{'0': {'precision': 0.35128205128205126, 'recall': 0.16799061683638108, 'f1-score': 0.22728748151621164, 'support': 18757}, '1': {'precision': 0.716518409263721, 'recall': 0.91530719719134, 'f1-score': 0.8038045907906705, 'support': 85450}, '2': {'precision': 0.44628459359337547, 'recall': 0.11064887352098979, 'f1-score': 0.17733137068144425, 'support': 18509}, 'accuracy': 0.6797157664852179, 'macro avg': {'precision': 0.5046950180463826, 'recall': 0.39798222918290366, 'f1-score': 0.4028078143294422, 'support': 122716}, 'weighted avg': {'precision': 0.6199336439445727, 'recall': 0.6797157664852179, 'f1-score': 0.6211949535008086, 'support': 122716}}
[[ 3151 15252   354]
 [ 5050 78213  2187]
 [  769 15692  2048]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/AAL
Evaluating performance on  test set...
4856/4856 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0113261
{'0': {'precision': 0.4448330039024885, 'recall': 0.11413561162422504, 'f1-score': 0.18166059975732363, 'support': 307599}, '1': {'precision': 0.5287825894514406, 'recall': 0.9296456553321139, 'f1-score': 0.674123582914773, 'support': 637402}, '2': {'precision': 0.5130972145360635, 'recall': 0.07469645752419445, 'f1-score': 0.13040815549115503, 'support': 297899}, 'accuracy': 0.5229044975460616, 'macro avg': {'precision': 0.49557093596333085, 'recall': 0.37282590816017774, 'f1-score': 0.3287307793877506, 'support': 1242900}, 'weighted avg': {'precision': 0.5042468536181571, 'recall': 0.5229044975460616, 'f1-score': 0.42192839161191953, 'support': 1242900}}
[[ 35108 266081   6410]
 [ 30138 592558  14706]
 [ 13678 261969  22252]]
Evaluating performance on  train set...
2076/2076 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88927156
{'0': {'precision': 0.41324482865081813, 'recall': 0.05564736574059639, 'f1-score': 0.09808645311397925, 'support': 96213}, '1': {'precision': 0.6409109943136234, 'recall': 0.9719629773608758, 'f1-score': 0.7724617908113992, 'support': 336983}, '2': {'precision': 0.4781317494600432, 'recall': 0.03606410491375975, 'f1-score': 0.06706936054988544, 'support': 98214}, 'accuracy': 0.6330912101766997, 'macro avg': {'precision': 0.5107625241414949, 'recall': 0.3545581493384107, 'f1-score': 0.3125392014917546, 'support': 531410}, 'weighted avg': {'precision': 0.5696070189443887, 'recall': 0.6330912101766997, 'f1-score': 0.5199955472111918, 'support': 531410}}
[[  5354  90165    694]
 [  6276 327535   3172]
 [  1326  93346   3542]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87055826
{'0': {'precision': 0.45413618458075405, 'recall': 0.08967663073674853, 'f1-score': 0.14977728285077951, 'support': 26997}, '1': {'precision': 0.6546934529248851, 'recall': 0.9651306177010042, 'f1-score': 0.780164596988671, 'support': 96503}, '2': {'precision': 0.548398969451601, 'recall': 0.05557627750839239, 'f1-score': 0.1009245775053341, 'support': 26810}, 'accuracy': 0.6456589714589848, 'macro avg': {'precision': 0.5524095356524135, 'recall': 0.37012784198204834, 'f1-score': 0.3436221524482615, 'support': 150310}, 'weighted avg': {'precision': 0.5997124158987042, 'recall': 0.6456589714589848, 'f1-score': 0.5457890315430658, 'support': 150310}}
[[ 2421 24314   262]
 [ 2400 93138   965]
 [  510 24810  1490]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/WBA
Evaluating performance on  test set...
4353/4353 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9413935
{'0': {'precision': 0.5408050394645569, 'recall': 0.11998269680306799, 'f1-score': 0.19639361785421283, 'support': 240418}, '1': {'precision': 0.5823919072818483, 'recall': 0.9588586879856972, 'f1-score': 0.72464729853074, 'support': 630923}, '2': {'precision': 0.5534869043862417, 'recall': 0.05053881173284158, 'f1-score': 0.09262046204620461, 'support': 242942}, 'accuracy': 0.5798257713704688, 'macro avg': {'precision': 0.5588946170442157, 'recall': 0.3764600655072023, 'f1-score': 0.33788712614371913, 'support': 1114283}, 'weighted avg': {'precision': 0.5671170885864523, 'recall': 0.5798257713704688, 'f1-score': 0.47287323654638297, 'support': 1114283}}
[[ 28846 208367   3205]
 [ 19257 604966   6700]
 [  5236 225428  12278]]
Evaluating performance on  train set...
1542/1542 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9835066
{'0': {'precision': 0.5279503105590062, 'recall': 0.12496455837105022, 'f1-score': 0.20209396520247608, 'support': 95227}, '1': {'precision': 0.542496097606716, 'recall': 0.9511210393729722, 'f1-score': 0.6909126032858285, 'support': 206817}, '2': {'precision': 0.5804329371816639, 'recall': 0.05912362999632504, 'f1-score': 0.1073159247415197, 'support': 92518}, 'accuracy': 0.5425712562284254, 'macro avg': {'precision': 0.5502931151157954, 'recall': 0.3784030759134492, 'f1-score': 0.3334408310766081, 'support': 394562}, 'weighted avg': {'precision': 0.5478810278853611, 'recall': 0.5425712562284254, 'f1-score': 0.43609351286575315, 'support': 394562}}
[[ 11900  82043   1284]
 [  7439 196708   2670]
 [  3201  83847   5470]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97322506
{'0': {'precision': 0.5446459713986745, 'recall': 0.10865632175909819, 'f1-score': 0.18116950922380787, 'support': 28742}, '1': {'precision': 0.5544183289161668, 'recall': 0.9607650586937801, 'f1-score': 0.703104010613892, 'support': 66191}, '2': {'precision': 0.569836293974225, 'recall': 0.05765435579362842, 'f1-score': 0.1047140525490447, 'support': 28376}, 'accuracy': 0.5543228799195516, 'macro avg': {'precision': 0.5563001980963554, 'recall': 0.3756919120821689, 'f1-score': 0.32966252412891484, 'support': 123309}, 'weighted avg': {'precision': 0.5556884963550375, 'recall': 0.5543228799195516, 'f1-score': 0.44374455681082897, 'support': 123309}}
[[ 3123 25206   413]
 [ 1775 63594   822]
 [  836 25904  1636]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.005433
{'0': {'precision': 0.44068744407992844, 'recall': 0.13695979608388367, 'f1-score': 0.20897342973818658, 'support': 345240}, '1': {'precision': 0.5279083516675228, 'recall': 0.9073778172655779, 'f1-score': 0.6674798910776278, 'support': 720335}, '2': {'precision': 0.5170616420616421, 'recall': 0.09350127773175537, 'f1-score': 0.1583650845197163, 'support': 341621}, 'accuracy': 0.5207817532170359, 'macro avg': {'precision': 0.4952191459363644, 'recall': 0.37927963036040563, 'f1-score': 0.3449394684451769, 'support': 1407196}, 'weighted avg': {'precision': 0.5038764400377203, 'recall': 0.5207817532170359, 'f1-score': 0.4313940295175118, 'support': 1407196}}
[[ 47284 291229   6727]
 [ 43612 653616  23107]
 [ 16400 293279  31942]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9993513
{'0': {'precision': 0.442131522983805, 'recall': 0.08695617203021065, 'f1-score': 0.14532965001781165, 'support': 124327}, '1': {'precision': 0.5348610672399915, 'recall': 0.9480598761730687, 'f1-score': 0.6838939316754893, 'support': 276838}, '2': {'precision': 0.50698551469958, 'recall': 0.04707183727389204, 'f1-score': 0.08614537669487204, 'support': 125659}, 'accuracy': 0.5299397901386421, 'macro avg': {'precision': 0.49465936830779217, 'recall': 0.3606959618257238, 'f1-score': 0.305122986129391, 'support': 526824}, 'weighted avg': {'precision': 0.5063285780113033, 'recall': 0.5299397901386421, 'f1-score': 0.41422025106115984, 'support': 526824}}
[[ 10811 112111   1405]
 [ 10032 262459   4347]
 [  3609 116135   5915]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.043705
{'0': {'precision': 0.45995817443720016, 'recall': 0.08309812201355707, 'f1-score': 0.14076500263534372, 'support': 44995}, '1': {'precision': 0.49359367355911843, 'recall': 0.9418952294293513, 'f1-score': 0.6477424178396126, 'support': 84623}, '2': {'precision': 0.4964811260396673, 'recall': 0.052102683467245586, 'f1-score': 0.09430828438322868, 'support': 44681}, 'accuracy': 0.4921026511913436, 'macro avg': {'precision': 0.48334432467866195, 'recall': 0.359032011636718, 'f1-score': 0.29427190161939504, 'support': 174299}, 'weighted avg': {'precision': 0.48565091417032497, 'recall': 0.4921026511913436, 'f1-score': 0.37499593441698387, 'support': 174299}}
[[ 3739 40609   647]
 [ 3203 79706  1714]
 [ 1187 41166  2328]]
testing model on single stock: results/universal/W2/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 74s - 74s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1885269
{'0': {'precision': 0.5121699344530343, 'recall': 0.059204128986049084, 'f1-score': 0.10613913652160924, 'support': 1206301}, '1': {'precision': 0.3590481643799414, 'recall': 0.9658646330346227, 'f1-score': 0.5234939600663787, 'support': 1350359}, '2': {'precision': 0.5336218726908054, 'recall': 0.016134257449127616, 'f1-score': 0.031321497669476096, 'support': 1253234}, 'accuracy': 0.366388671180878, 'macro avg': {'precision': 0.46827999050792696, 'recall': 0.3470676731565998, 'f1-score': 0.22031819808582134, 'support': 3809894}, 'weighted avg': {'precision': 0.4649546938325192, 'recall': 0.366388671180878, 'f1-score': 0.22945354720019429, 'support': 3809894}}
[[  71418 1127110    7773]
 [  36196 1304264    9899]
 [  31828 1201186   20220]]
Evaluating performance on  train set...
6147/6147 - 36s - 36s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2064767
{'0': {'precision': 0.5027012738116874, 'recall': 0.0583836701486695, 'f1-score': 0.10461711963388994, 'support': 521156}, '1': {'precision': 0.3360197806190964, 'recall': 0.9571566073624787, 'f1-score': 0.49741637136764844, 'support': 523628}, '2': {'precision': 0.49595699929890164, 'recall': 0.020070020938189784, 'f1-score': 0.03857886106738121, 'support': 528699}, 'accuracy': 0.34460620165581707, 'macro avg': {'precision': 0.4448926845765618, 'recall': 0.345203432816446, 'f1-score': 0.21353745068963983, 'support': 1573483}, 'weighted avg': {'precision': 0.4449664345359626, 'recall': 0.34460620165581707, 'f1-score': 0.21314471435273336, 'support': 1573483}}
[[ 30427 486008   4721]
 [ 16371 501194   6063]
 [ 13729 504359  10611]]
Evaluating performance on  val set...
2174/2174 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1978399
{'0': {'precision': 0.5355544505221282, 'recall': 0.07089101959321588, 'f1-score': 0.12520829296647937, 'support': 182308}, '1': {'precision': 0.3405735420976693, 'recall': 0.9565033285807704, 'f1-score': 0.502298258502712, 'support': 186566}, '2': {'precision': 0.5280390522681272, 'recall': 0.02363707102846575, 'f1-score': 0.04524863794968066, 'support': 187629}, 'accuracy': 0.3518579414666228, 'macro avg': {'precision': 0.4680556816293082, 'recall': 0.3503438064008173, 'f1-score': 0.2242517298062907, 'support': 556503}, 'weighted avg': {'precision': 0.467653801612567, 'recall': 0.3518579414666228, 'f1-score': 0.2246676245407671, 'support': 556503}}
[[ 12924 167544   1840]
 [  5991 178451   2124]
 [  5217 177977   4435]]
training model: results/universal/W2/deepOF_L1/h30
Epoch 1/50
9940/9940 - 136s - loss: 3.0980 - accuracy30: 0.4641 - val_loss: 3.3944 - val_accuracy30: 0.4245 - 136s/epoch - 14ms/step
Epoch 2/50
9940/9940 - 132s - loss: 3.0859 - accuracy30: 0.4655 - val_loss: 3.3675 - val_accuracy30: 0.4284 - 132s/epoch - 13ms/step
Epoch 3/50
9940/9940 - 129s - loss: 3.0748 - accuracy30: 0.4685 - val_loss: 3.3732 - val_accuracy30: 0.4300 - 129s/epoch - 13ms/step
Epoch 4/50
9940/9940 - 131s - loss: 3.0637 - accuracy30: 0.4719 - val_loss: 3.4206 - val_accuracy30: 0.4302 - 131s/epoch - 13ms/step
Epoch 5/50
9940/9940 - 129s - loss: 3.0528 - accuracy30: 0.4749 - val_loss: 3.4811 - val_accuracy30: 0.4283 - 129s/epoch - 13ms/step
Epoch 6/50
9940/9940 - 130s - loss: 3.0419 - accuracy30: 0.4770 - val_loss: 3.5387 - val_accuracy30: 0.4286 - 130s/epoch - 13ms/step
Epoch 7/50
9940/9940 - 131s - loss: 3.0332 - accuracy30: 0.4783 - val_loss: 3.6235 - val_accuracy30: 0.4290 - 131s/epoch - 13ms/step
Epoch 8/50
9940/9940 - 130s - loss: 3.0259 - accuracy30: 0.4796 - val_loss: 3.6072 - val_accuracy30: 0.4304 - 130s/epoch - 13ms/step
Epoch 9/50
9940/9940 - 129s - loss: 3.0195 - accuracy30: 0.4809 - val_loss: 3.6244 - val_accuracy30: 0.4319 - 129s/epoch - 13ms/step
Epoch 10/50
9940/9940 - 129s - loss: 3.0133 - accuracy30: 0.4819 - val_loss: 3.6425 - val_accuracy30: 0.4320 - 129s/epoch - 13ms/step
Epoch 11/50
9940/9940 - 130s - loss: 3.0084 - accuracy30: 0.4826 - val_loss: 3.6812 - val_accuracy30: 0.4324 - 130s/epoch - 13ms/step
Epoch 12/50
9940/9940 - 132s - loss: 3.0044 - accuracy30: 0.4831 - val_loss: 3.6397 - val_accuracy30: 0.4326 - 132s/epoch - 13ms/step
testing model in sample: results/universal/W2/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 137s - 137s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0559831
{'0': {'precision': 0.48402067400535803, 'recall': 0.10238897864580117, 'f1-score': 0.16902307876689052, 'support': 1845726}, '1': {'precision': 0.450590017760798, 'recall': 0.9163426298721579, 'f1-score': 0.6041187802252873, 'support': 2961855}, '2': {'precision': 0.47823239629354497, 'recall': 0.07672163845945171, 'f1-score': 0.13222995315048466, 'support': 1913163}, 'accuracy': 0.4537945501271883, 'macro avg': {'precision': 0.47094769601990033, 'recall': 0.36515108232580357, 'f1-score': 0.30179060404755415, 'support': 6720744}, 'weighted avg': {'precision': 0.46763994664791114, 'recall': 0.4537945501271883, 'f1-score': 0.35029752282537574, 'support': 6720744}}
[[ 188982 1607560   49184]
 [ 136822 2714074  110959]
 [  64638 1701744  146781]]
Evaluating performance on  train set...
9940/9940 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0767276
{'0': {'precision': 0.4888890346016904, 'recall': 0.09982474203339407, 'f1-score': 0.1657960920874444, 'support': 746899}, '1': {'precision': 0.41903657079342294, 'recall': 0.9102310863937099, 'f1-score': 0.5738800775144357, 'support': 1042900}, '2': {'precision': 0.48101809504871745, 'recall': 0.08022604865883103, 'f1-score': 0.13751655685610173, 'support': 753820}, 'accuracy': 0.42628829238970145, 'macro avg': {'precision': 0.4629812334812769, 'recall': 0.36342729236197835, 'f1-score': 0.29239757548599393, 'support': 2543619}, 'weighted avg': {'precision': 0.45791646907223643, 'recall': 0.42628829238970145, 'f1-score': 0.3247322807044183, 'support': 2543619}}
[[ 74559 650176  22164]
 [ 50535 949280  43085]
 [ 27413 665931  60476]]
Evaluating performance on  val set...
3393/3393 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0744827
{'0': {'precision': 0.4987595767967895, 'recall': 0.10741772380656796, 'f1-score': 0.1767655054483626, 'support': 254539}, '1': {'precision': 0.4196131526033904, 'recall': 0.9080375336327918, 'f1-score': 0.5739830455705885, 'support': 355308}, '2': {'precision': 0.4953020436673351, 'recall': 0.08512368531111077, 'f1-score': 0.1452793465006923, 'support': 258236}, 'accuracy': 0.42848091714732345, 'macro avg': {'precision': 0.47122492435583835, 'recall': 0.3668596475834902, 'f1-score': 0.29867596583988115, 'support': 868083}, 'weighted avg': {'precision': 0.46533625527969263, 'recall': 0.42848091714732345, 'f1-score': 0.3299809353136373, 'support': 868083}}
[[ 27342 219421   7776]
 [ 18052 322633  14623]
 [  9426 226828  21982]]
testing model out of sample: results/universal/W2/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 76s - 76s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0806971
{'0': {'precision': 0.467596667105028, 'recall': 0.12802178779975534, 'f1-score': 0.20100975985226135, 'support': 1083175}, '1': {'precision': 0.4201792795783345, 'recall': 0.8728607571818396, 'f1-score': 0.5672801981349462, 'support': 1489312}, '2': {'precision': 0.4860235522325403, 'recall': 0.12273480402953334, 'f1-score': 0.19597925785619277, 'support': 1094221}, 'accuracy': 0.42897634608482593, 'macro avg': {'precision': 0.45793316630530095, 'recall': 0.3745391163370428, 'f1-score': 0.3214230719478001, 'support': 3666708}, 'weighted avg': {'precision': 0.45383604052089777, 'recall': 0.42897634608482593, 'f1-score': 0.34827713921680903, 'support': 3666708}}
[[ 138670  892851   51654]
 [  98981 1299962   90369]
 [  58908  901014  134299]]
Evaluating performance on  train set...
5373/5373 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0372275
{'0': {'precision': 0.46866939371042965, 'recall': 0.09901169943112857, 'f1-score': 0.16348528673317989, 'support': 363351}, '1': {'precision': 0.48223252992499693, 'recall': 0.9179701444353735, 'f1-score': 0.6323014135777228, 'support': 644302}, '2': {'precision': 0.4731097246067306, 'recall': 0.09229784742739662, 'f1-score': 0.15446206007136376, 'support': 367235}, 'accuracy': 0.4809999069015076, 'macro avg': {'precision': 0.4746705494140524, 'recall': 0.36975989709796625, 'f1-score': 0.3167495867940888, 'support': 1374888}, 'weighted avg': {'precision': 0.47621139037199134, 'recall': 0.4809999069015076, 'f1-score': 0.3807724574082026, 'support': 1374888}}
[[ 35976 315311  12064]
 [ 27168 591450  25684]
 [ 13618 319722  33895]]
Evaluating performance on  val set...
1685/1685 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.054793
{'0': {'precision': 0.4795862177470107, 'recall': 0.1017847602511019, 'f1-score': 0.16792915381225207, 'support': 119792}, '1': {'precision': 0.4579424304240892, 'recall': 0.913733389138851, 'f1-score': 0.6101110525010391, 'support': 191140}, '2': {'precision': 0.4903406947994804, 'recall': 0.09772250849779099, 'f1-score': 0.162966573816156, 'support': 119737}, 'accuracy': 0.46101530409664965, 'macro avg': {'precision': 0.47595644765686007, 'recall': 0.37108021929591467, 'f1-score': 0.3136689267098157, 'support': 430669}, 'weighted avg': {'precision': 0.4729702674694851, 'recall': 0.46101530409664965, 'f1-score': 0.3627990972592664, 'support': 430669}}
[[ 12193 103430   4169]
 [  8496 174651   7993]
 [  4735 103301  11701]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
987/987 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1566675
{'0': {'precision': 0.4406497825530826, 'recall': 0.043661757623380905, 'f1-score': 0.07945110701107011, 'support': 78902}, '1': {'precision': 0.3575710493409164, 'recall': 0.9653872899795868, 'f1-score': 0.5218524817277057, 'support': 89158}, '2': {'precision': 0.39454407678706743, 'recall': 0.018500532985905482, 'f1-score': 0.03534376449558203, 'support': 84430}, 'accuracy': 0.36072319695829536, 'macro avg': {'precision': 0.3975883028936888, 'recall': 0.3425165268629577, 'f1-score': 0.21221578441145264, 'support': 252490}, 'weighted avg': {'precision': 0.39589617475255595, 'recall': 0.36072319695829536, 'f1-score': 0.22092062595599127, 'support': 252490}}
[[ 3445 74193  1264]
 [ 1953 86072  1133]
 [ 2420 80448  1562]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1781185
{'0': {'precision': 0.40173053152039556, 'recall': 0.04892367906066536, 'f1-score': 0.08722490606548577, 'support': 19929}, '1': {'precision': 0.3343081123932, 'recall': 0.9462006382130036, 'f1-score': 0.4940576144543809, 'support': 20056}, '2': {'precision': 0.41679049034175336, 'recall': 0.02729528535980149, 'f1-score': 0.05123521621991872, 'support': 20553}, 'accuracy': 0.33884502296078495, 'macro avg': {'precision': 0.38427637808511633, 'recall': 0.3408065342111568, 'f1-score': 0.21083924557992847, 'support': 60538}, 'weighted avg': {'precision': 0.38450669352839606, 'recall': 0.33884502296078495, 'f1-score': 0.20978826633592323, 'support': 60538}}
[[  975 18536   418]
 [  712 18977   367]
 [  740 19252   561]]
Evaluating performance on  val set...
85/85 - 1s - 587ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1498877
{'0': {'precision': 0.44198174706649285, 'recall': 0.049852941176470586, 'f1-score': 0.08959957711114047, 'support': 6800}, '1': {'precision': 0.36573190427250035, 'recall': 0.9561156601842374, 'f1-score': 0.5290806754221388, 'support': 7816}, '2': {'precision': 0.4080604534005038, 'recall': 0.023205844434894714, 'f1-score': 0.043914339929520194, 'support': 6981}, 'accuracy': 0.3692179469370746, 'macro avg': {'precision': 0.40525803491316564, 'recall': 0.3430581485985343, 'f1-score': 0.2208648641542665, 'support': 21597}, 'weighted avg': {'precision': 0.4034220710763038, 'recall': 0.3692179469370746, 'f1-score': 0.2338814506877424, 'support': 21597}}
[[ 339 6337  124]
 [ 232 7473  111]
 [ 196 6623  162]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9796641
{'0': {'precision': 0.5379923087123724, 'recall': 0.10974653068953391, 'f1-score': 0.18230430484407298, 'support': 73934}, '1': {'precision': 0.5542308018787845, 'recall': 0.9355060177667399, 'f1-score': 0.6960776474769012, 'support': 167504}, '2': {'precision': 0.5848017621145375, 'recall': 0.152993870815653, 'f1-score': 0.24253622887514015, 'support': 76356}, 'accuracy': 0.5553817882024205, 'macro avg': {'precision': 0.5590082909018981, 'recall': 0.3994154730906423, 'f1-score': 0.3736393937320381, 'support': 317794}, 'weighted avg': {'precision': 0.5577982055616597, 'recall': 0.5553817882024205, 'f1-score': 0.4675776541700056, 'support': 317794}}
[[  8114  63295   2525]
 [  5034 156701   5769]
 [  1934  62740  11682]]
Evaluating performance on  train set...
528/528 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9010204
{'0': {'precision': 0.5084487534626039, 'recall': 0.14360037552808638, 'f1-score': 0.2239507076622743, 'support': 25564}, '1': {'precision': 0.649776565298164, 'recall': 0.9297928391809365, 'f1-score': 0.7649649274905423, 'support': 83510}, '2': {'precision': 0.5280048810250153, 'recall': 0.16746004102325943, 'f1-score': 0.2542751366280778, 'support': 25839}, 'accuracy': 0.6348165113814087, 'macro avg': {'precision': 0.5620767332619278, 'recall': 0.4136177519107607, 'f1-score': 0.41439692392696487, 'support': 134913}, 'weighted avg': {'precision': 0.599674924005641, 'recall': 0.6348165113814087, 'f1-score': 0.5646417486880173, 'support': 134913}}
[[ 3671 20988   905]
 [ 2900 77647  2963]
 [  649 20863  4327]]
Evaluating performance on  val set...
159/159 - 1s - 970ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9237454
{'0': {'precision': 0.5197339246119734, 'recall': 0.1365012811553692, 'f1-score': 0.2162162162162162, 'support': 8586}, '1': {'precision': 0.616826035437736, 'recall': 0.9375497382198953, 'f1-score': 0.7440994614719767, 'support': 23875}, '2': {'precision': 0.5965853658536585, 'recall': 0.15037501536948236, 'f1-score': 0.24020426200530295, 'support': 8133}, 'accuracy': 0.6104104054786421, 'macro avg': {'precision': 0.577715108634456, 'recall': 0.4081420115815822, 'f1-score': 0.4001733132311653, 'support': 40594}, 'weighted avg': {'precision': 0.5922349572173758, 'recall': 0.6104104054786421, 'f1-score': 0.5314920514845791, 'support': 40594}}
[[ 1172  7241   173]
 [  837 22384   654]
 [  246  6664  1223]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1648355
{'0': {'precision': 0.5041358641358641, 'recall': 0.13322210371809629, 'f1-score': 0.2107513948748789, 'support': 94699}, '1': {'precision': 0.27984948918203495, 'recall': 0.8281134689332833, 'f1-score': 0.41833010673922144, 'support': 77237}, '2': {'precision': 0.5127981384525887, 'recall': 0.10343006883604505, 'f1-score': 0.17213995117982098, 'support': 102272}, 'accuracy': 0.31784265958688296, 'macro avg': {'precision': 0.43226116392349595, 'recall': 0.35492188049580825, 'f1-score': 0.2670738175979738, 'support': 274208}, 'weighted avg': {'precision': 0.4441912285913547, 'recall': 0.31784265958688296, 'f1-score': 0.25481972037481054, 'support': 274208}}
[[12616 77837  4246]
 [ 7472 63961  5804]
 [ 4937 86757 10578]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1330068
{'0': {'precision': 0.5091172214182345, 'recall': 0.14198078940996045, 'f1-score': 0.22203988891694018, 'support': 24778}, '1': {'precision': 0.32722391621370805, 'recall': 0.8347495244134433, 'f1-score': 0.4701484541482637, 'support': 23655}, '2': {'precision': 0.48762761723481574, 'recall': 0.11455284552845528, 'f1-score': 0.18552289410448008, 'support': 24600}, 'accuracy': 0.3571262306080813, 'macro avg': {'precision': 0.4413229182889194, 'recall': 0.36376105311728635, 'f1-score': 0.2925704123898946, 'support': 73033}, 'weighted avg': {'precision': 0.44296451787976315, 'recall': 0.3571262306080813, 'f1-score': 0.29010076602948437, 'support': 73033}}
[[ 3518 20134  1126]
 [ 2074 19746  1835]
 [ 1318 20464  2818]]
Evaluating performance on  val set...
117/117 - 1s - 994ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1350744
{'0': {'precision': 0.4897877452943532, 'recall': 0.12399878333164352, 'f1-score': 0.19789644012944985, 'support': 9863}, '1': {'precision': 0.3385867407701469, 'recall': 0.8578756789378394, 'f1-score': 0.48554024820676306, 'support': 9942}, '2': {'precision': 0.49151743638077283, 'recall': 0.10425829668132747, 'f1-score': 0.17202704931552035, 'support': 10004}, 'accuracy': 0.36213895132342583, 'macro avg': {'precision': 0.4399639741484243, 'recall': 0.36204425298360343, 'f1-score': 0.2851545792172444, 'support': 29809}, 'weighted avg': {'precision': 0.4399391573728826, 'recall': 0.36213895132342583, 'f1-score': 0.2851505363487828, 'support': 29809}}
[[1223 8233  407]
 [ 741 8529  672]
 [ 533 8428 1043]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.168513
{'0': {'precision': 0.40777307632032594, 'recall': 0.06969891781849352, 'f1-score': 0.11904925308260701, 'support': 74664}, '1': {'precision': 0.30645201460457566, 'recall': 0.9144322235434007, 'f1-score': 0.45906006215513423, 'support': 67280}, '2': {'precision': 0.5506388282954191, 'recall': 0.04531059683313033, 'f1-score': 0.08373117884686009, 'support': 77995}, 'accuracy': 0.31945675846484706, 'macro avg': {'precision': 0.4216213064067736, 'recall': 0.34314724606500824, 'f1-score': 0.22061349802820043, 'support': 219939}, 'weighted avg': {'precision': 0.42744186308875587, 'recall': 0.31945675846484706, 'f1-score': 0.21053504702721232, 'support': 219939}}
[[ 5204 67874  1586]
 [ 4459 61523  1298]
 [ 3099 71362  3534]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1484522
{'0': {'precision': 0.4713184931506849, 'recall': 0.07837135637256647, 'f1-score': 0.13439531264304677, 'support': 28097}, '1': {'precision': 0.33686909581646424, 'recall': 0.9176193802154174, 'f1-score': 0.4928185739810272, 'support': 27203}, '2': {'precision': 0.4706084565142661, 'recall': 0.051893408134642355, 'f1-score': 0.09347900307272106, 'support': 26381}, 'accuracy': 0.3493223638300217, 'macro avg': {'precision': 0.4262653484938051, 'recall': 0.34929471490754205, 'f1-score': 0.240230963232265, 'support': 81681}, 'weighted avg': {'precision': 0.42631220732915764, 'recall': 0.3493223638300217, 'f1-score': 0.24054943435314236, 'support': 81681}}
[[ 2202 25182   713]
 [ 1414 24962   827]
 [ 1056 23956  1369]]
Evaluating performance on  val set...
98/98 - 1s - 718ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1532425
{'0': {'precision': 0.4357388316151203, 'recall': 0.07254004576659039, 'f1-score': 0.12437469347719472, 'support': 8740}, '1': {'precision': 0.33373089495538477, 'recall': 0.9178714615478071, 'f1-score': 0.4894878356927662, 'support': 8231}, '2': {'precision': 0.511520737327189, 'recall': 0.0555694618272841, 'f1-score': 0.1002483630616392, 'support': 7990}, 'accuracy': 0.3458595408837787, 'macro avg': {'precision': 0.4269968212992314, 'recall': 0.34866032304722716, 'f1-score': 0.23803696407720007, 'support': 24961}, 'weighted avg': {'precision': 0.426359003082335, 'recall': 0.3458595408837787, 'f1-score': 0.23704954198310718, 'support': 24961}}
[[ 634 7866  240]
 [ 492 7555  184]
 [ 329 7217  444]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1688696
{'0': {'precision': 0.46721960489330533, 'recall': 0.14100687619855545, 'f1-score': 0.2166337015332229, 'support': 167389}, '1': {'precision': 0.3022180067486201, 'recall': 0.8281657175127405, 'f1-score': 0.44283474192409983, 'support': 146973}, '2': {'precision': 0.45144213714628756, 'recall': 0.0942398833394094, 'f1-score': 0.15592910428418608, 'support': 175552}, 'accuracy': 0.3303947223390228, 'macro avg': {'precision': 0.4069599162627377, 'recall': 0.35447082568356847, 'f1-score': 0.2717991825805029, 'support': 489914}, 'weighted avg': {'precision': 0.4120659536360576, 'recall': 0.3303947223390228, 'f1-score': 0.26274104293009143, 'support': 489914}}
[[ 23603 134295   9491]
 [ 14643 121718  10612]
 [ 12272 146736  16544]]
Evaluating performance on  train set...
716/716 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1556598
{'0': {'precision': 0.4653520430240465, 'recall': 0.12134107027724049, 'f1-score': 0.19249012363041285, 'support': 62040}, '1': {'precision': 0.3282944864169748, 'recall': 0.8631223058067788, 'f1-score': 0.47566610769517426, 'support': 59155}, '2': {'precision': 0.46340391881205517, 'recall': 0.08521845915201655, 'f1-score': 0.1439626581501044, 'support': 61888}, 'accuracy': 0.34880354811752046, 'macro avg': {'precision': 0.4190168160843588, 'recall': 0.3565606117453453, 'f1-score': 0.27070629649189715, 'support': 183083}, 'weighted avg': {'precision': 0.4204095564342318, 'recall': 0.34880354811752046, 'f1-score': 0.2675817899987028, 'support': 183083}}
[[ 7528 51642  2870]
 [ 4860 51058  3237]
 [ 3789 52825  5274]]
Evaluating performance on  val set...
214/214 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2027388
{'0': {'precision': 0.46820056435858476, 'recall': 0.10777455780953332, 'f1-score': 0.17521627878640184, 'support': 20014}, '1': {'precision': 0.2665836321858827, 'recall': 0.8607682706975455, 'f1-score': 0.4070898030792438, 'support': 14422}, '2': {'precision': 0.47270114942528735, 'recall': 0.0813631417548719, 'f1-score': 0.13883028103637438, 'support': 20218}, 'accuracy': 0.2967028945731328, 'macro avg': {'precision': 0.4024951153232516, 'recall': 0.34996865675398353, 'f1-score': 0.24037878763400666, 'support': 54654}, 'weighted avg': {'precision': 0.41666313677933864, 'recall': 0.2967028945731328, 'f1-score': 0.22294248116575763, 'support': 54654}}
[[ 2157 16910   947]
 [ 1120 12414   888]
 [ 1330 17243  1645]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/EXC
Evaluating performance on  test set...
4918/4918 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9144499
{'0': {'precision': 0.4328763972102847, 'recall': 0.17014359808974264, 'f1-score': 0.24427431369945862, 'support': 243318}, '1': {'precision': 0.6355360017650765, 'recall': 0.8866090980349194, 'f1-score': 0.740365687039549, 'support': 766737}, '2': {'precision': 0.4410667521778633, 'recall': 0.16586608998347932, 'f1-score': 0.24107450618401913, 'support': 248779}, 'accuracy': 0.6056866910172429, 'macro avg': {'precision': 0.5031597170510748, 'recall': 0.4075395953693805, 'f1-score': 0.4085715023076755, 'support': 1258834}, 'weighted avg': {'precision': 0.5579319689028245, 'recall': 0.6056866910172429, 'f1-score': 0.5458037976558637, 'support': 1258834}}
[[ 41399 192551   9368]
 [ 44018 679796  42923]
 [ 10220 197295  41264]]
Evaluating performance on  train set...
1403/1403 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88459766
{'0': {'precision': 0.4001787032360825, 'recall': 0.1654274197433715, 'f1-score': 0.23408703556414043, 'support': 62269}, '1': {'precision': 0.681216176325888, 'recall': 0.8870590245152473, 'f1-score': 0.770628721963527, 'support': 234140}, '2': {'precision': 0.459416557903277, 'recall': 0.20814754438957345, 'f1-score': 0.28649362076550816, 'support': 62571}, 'accuracy': 0.6435483870967742, 'macro avg': {'precision': 0.5136038124884158, 'recall': 0.42021132954939744, 'f1-score': 0.43040312609772524, 'support': 358980}, 'weighted avg': {'precision': 0.5938069993908213, 'recall': 0.6435483870967742, 'f1-score': 0.5931739008384932, 'support': 358980}}
[[ 10301  49797   2171]
 [ 13290 207696  13154]
 [  2150  47397  13024]]
Evaluating performance on  val set...
480/480 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89640325
{'0': {'precision': 0.4162013909295719, 'recall': 0.18723010487353486, 'f1-score': 0.25827432149044155, 'support': 22694}, '1': {'precision': 0.6636532810969638, 'recall': 0.8749418934972367, 'f1-score': 0.7547899122220738, 'support': 77444}, '2': {'precision': 0.4736235226289997, 'recall': 0.21830985915492956, 'f1-score': 0.2988631195998181, 'support': 22578}, 'accuracy': 0.6269516607451351, 'macro avg': {'precision': 0.5178260648851785, 'recall': 0.4268272858419004, 'f1-score': 0.4373091177707778, 'support': 122716}, 'weighted avg': {'precision': 0.5829289657497516, 'recall': 0.6269516607451351, 'f1-score': 0.5790847071967393, 'support': 122716}}
[[ 4249 17570   875]
 [ 5082 67759  4603]
 [  878 16771  4929]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/AAL
Evaluating performance on  test set...
4856/4856 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0477021
{'0': {'precision': 0.4635401165015519, 'recall': 0.12500179155475422, 'f1-score': 0.19690473771546615, 'support': 348859}, '1': {'precision': 0.4670230645211858, 'recall': 0.8854859802646511, 'f1-score': 0.6115188326289175, 'support': 555146}, '2': {'precision': 0.49233806036050076, 'recall': 0.13983682261467417, 'f1-score': 0.21780995059174996, 'support': 338895}, 'accuracy': 0.4687199291978438, 'macro avg': {'precision': 0.47430041379441285, 'recall': 0.38344153147802645, 'f1-score': 0.3420778403120445, 'support': 1242900}, 'weighted avg': {'precision': 0.4729479721982178, 'recall': 0.4687199291978438, 'f1-score': 0.3877938104103982, 'support': 1242900}}
[[ 43608 287151  18100]
 [ 32807 491574  30765]
 [ 17661 273844  47390]]
Evaluating performance on  train set...
2076/2076 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95862865
{'0': {'precision': 0.4343769438109061, 'recall': 0.0742256353023499, 'f1-score': 0.12678624112080247, 'support': 112899}, '1': {'precision': 0.5823421457066248, 'recall': 0.9393960373190914, 'f1-score': 0.7189803215070613, 'support': 303330}, '2': {'precision': 0.4636060685784443, 'recall': 0.09179465363210947, 'f1-score': 0.15324632030553603, 'support': 115181}, 'accuracy': 0.5718748235825446, 'macro avg': {'precision': 0.49344171936532505, 'recall': 0.3684721087511836, 'f1-score': 0.33300429431113326, 'support': 531410}, 'weighted avg': {'precision': 0.5251711037079313, 'recall': 0.5718748235825446, 'f1-score': 0.4705470449900196, 'support': 531410}}
[[  8380 102008   2511]
 [  8661 284947   9722]
 [  2251 102357  10573]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9439099
{'0': {'precision': 0.4796511627906977, 'recall': 0.11361857961125543, 'f1-score': 0.18371839967608877, 'support': 31949}, '1': {'precision': 0.5968839488678298, 'recall': 0.9333402578217868, 'f1-score': 0.7281231290036508, 'support': 86649}, '2': {'precision': 0.5213793103448275, 'recall': 0.11919778002018164, 'f1-score': 0.19403521379805966, 'support': 31712}, 'accuracy': 0.5873394983700353, 'macro avg': {'precision': 0.532638140667785, 'recall': 0.3887188724844079, 'f1-score': 0.3686255808259331, 'support': 150310}, 'weighted avg': {'precision': 0.5560358790173892, 'recall': 0.5873394983700353, 'f1-score': 0.4997272626987743, 'support': 150310}}
[[ 3630 27560   759]
 [ 3065 80873  2711]
 [  873 27059  3780]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/WBA
Evaluating performance on  test set...
4353/4353 - 29s - 29s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9947896
{'0': {'precision': 0.5560274619049794, 'recall': 0.1315129060946147, 'f1-score': 0.2127141642498573, 'support': 277737}, '1': {'precision': 0.5206482879969081, 'recall': 0.9212440566815318, 'f1-score': 0.6652981309024604, 'support': 555666}, '2': {'precision': 0.5177481762429841, 'recall': 0.1205283395044147, 'f1-score': 0.1955369700260204, 'support': 280880}, 'accuracy': 0.5225638370144747, 'macro avg': {'precision': 0.5314746420482905, 'recall': 0.39109510076018705, 'f1-score': 0.357849755059446, 'support': 1114283}, 'weighted avg': {'precision': 0.5287355712402706, 'recall': 0.5225638370144747, 'f1-score': 0.4340769527877728, 'support': 1114283}}
[[ 36526 231320   9891]
 [ 22120 511904  21642]
 [  7045 239981  33854]]
Evaluating performance on  train set...
1542/1542 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0272722
{'0': {'precision': 0.5460407810360977, 'recall': 0.13944523667142003, 'f1-score': 0.22215707972708548, 'support': 108695}, '1': {'precision': 0.4788379453526525, 'recall': 0.9186610067517882, 'f1-score': 0.6295385743026314, 'support': 179508}, '2': {'precision': 0.5479164807709467, 'recall': 0.11546742635790107, 'f1-score': 0.1907387418169958, 'support': 106359}, 'accuracy': 0.48748992553768483, 'macro avg': {'precision': 0.5242650690532323, 'recall': 0.39119122326036976, 'f1-score': 0.34747813194890426, 'support': 394562}, 'weighted avg': {'precision': 0.5159721249572936, 'recall': 0.48748992553768483, 'f1-score': 0.3990281781260389, 'support': 394562}}
[[ 15157  89968   3570]
 [  8038 164907   6563]
 [  4563  89515  12281]]
Evaluating performance on  val set...
482/482 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0232948
{'0': {'precision': 0.5652904128761371, 'recall': 0.12200942484291928, 'f1-score': 0.20070063852518075, 'support': 33104}, '1': {'precision': 0.48777463443309577, 'recall': 0.9245621365646436, 'f1-score': 0.638626661054657, 'support': 57438}, '2': {'precision': 0.5163192539769611, 'recall': 0.11490218817712942, 'f1-score': 0.18797274020819293, 'support': 32767}, 'accuracy': 0.49395421258788896, 'macro avg': {'precision': 0.5231281004287314, 'recall': 0.3871579165282308, 'f1-score': 0.34243334659601027, 'support': 123309}, 'weighted avg': {'precision': 0.5161699979359404, 'recall': 0.49395421258788896, 'f1-score': 0.4013067567963152, 'support': 123309}}
[[ 4039 27891  1174]
 [ 1980 53105  2353]
 [ 1126 27876  3765]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0490873
{'0': {'precision': 0.4648078485912248, 'recall': 0.14105093484793785, 'f1-score': 0.21642529038298372, 'support': 393326}, '1': {'precision': 0.4590864885808934, 'recall': 0.86458880344331, 'f1-score': 0.5997256883629852, 'support': 620798}, '2': {'precision': 0.49129738837405224, 'recall': 0.14836213212846502, 'f1-score': 0.2279022689791548, 'support': 393072}, 'accuracy': 0.46228883538611537, 'macro avg': {'precision': 0.4717305751820568, 'recall': 0.38466729013990425, 'f1-score': 0.348017749241708, 'support': 1407196}, 'weighted avg': {'precision': 0.4696831378400728, 'recall': 0.46228883538611537, 'f1-score': 0.3887277979199176, 'support': 1407196}}
[[ 55479 319352  18495]
 [ 42175 536735  41888]
 [ 21705 313050  58317]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0462464
{'0': {'precision': 0.48260828357501656, 'recall': 0.1063011029539682, 'f1-score': 0.17422643962636436, 'support': 143705}, '1': {'precision': 0.4657363134449012, 'recall': 0.909792277389062, 'f1-score': 0.6160879593421251, 'support': 238106}, '2': {'precision': 0.4841394001930566, 'recall': 0.10030135229255308, 'f1-score': 0.16617539530207479, 'support': 145013}, 'accuracy': 0.4677994928097429, 'macro avg': {'precision': 0.47749466573765814, 'recall': 0.3721315775451944, 'f1-score': 0.31882993142352145, 'support': 526824}, 'weighted avg': {'precision': 0.47540419737987466, 'recall': 0.4677994928097429, 'f1-score': 0.37171625201692127, 'support': 526824}}
[[ 15276 123427   5002]
 [ 10983 216627  10496]
 [  5394 125074  14545]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0783192
{'0': {'precision': 0.48364767255216695, 'recall': 0.09422272602900364, 'f1-score': 0.15771910884286977, 'support': 51166}, '1': {'precision': 0.4259438843583018, 'recall': 0.9050490243531413, 'f1-score': 0.5792669434142628, 'support': 72311}, '2': {'precision': 0.48932983901160615, 'recall': 0.10286883633072291, 'f1-score': 0.16999967482847203, 'support': 50822}, 'accuracy': 0.4331292778501311, 'macro avg': {'precision': 0.466307131974025, 'recall': 0.3673801955709559, 'f1-score': 0.3023285756952015, 'support': 174299}, 'weighted avg': {'precision': 0.46136504577699916, 'recall': 0.4331292778501311, 'f1-score': 0.3361863885760425, 'support': 174299}}
[[ 4821 44396  1949]
 [ 3359 65445  3507]
 [ 1788 43806  5228]]
testing model on single stock: results/universal/W2/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 77s - 77s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1205229
{'0': {'precision': 0.485665032217039, 'recall': 0.08312409178681936, 'f1-score': 0.14195230890309316, 'support': 1176073}, '1': {'precision': 0.3740289408533247, 'recall': 0.9285147807168669, 'f1-score': 0.5332510444709427, 'support': 1404668}, '2': {'precision': 0.4654080289568937, 'recall': 0.046027630408907595, 'f1-score': 0.0837705715425853, 'support': 1229153}, 'accuracy': 0.3828426722633228, 'macro avg': {'precision': 0.4417006673424191, 'recall': 0.3525555009708646, 'f1-score': 0.2529913083055404, 'support': 3809894}, 'weighted avg': {'precision': 0.4379706340233088, 'recall': 0.3828426722633228, 'f1-score': 0.2674493844833428, 'support': 3809894}}
[[  97760 1052482   25831]
 [  61259 1304255   39154]
 [  42272 1130306   56575]]
Evaluating performance on  train set...
6147/6147 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1443502
{'0': {'precision': 0.4956223392658382, 'recall': 0.08269988550071418, 'f1-score': 0.14174765884339396, 'support': 522274}, '1': {'precision': 0.3332597379676851, 'recall': 0.9140276816208617, 'f1-score': 0.4884337336981445, 'support': 518539}, '2': {'precision': 0.4620781042949567, 'recall': 0.055644207483057054, 'f1-score': 0.0993272622169349, 'support': 532670}, 'accuracy': 0.347503595526612, 'macro avg': {'precision': 0.4303200605094933, 'recall': 0.3507905915348776, 'f1-score': 0.2431695515861578, 'support': 1573483}, 'weighted avg': {'precision': 0.4307602793919899, 'recall': 0.347503595526612, 'f1-score': 0.24163699854270534, 'support': 1573483}}
[[ 43192 464234  14848]
 [ 24923 473959  19657]
 [ 19032 483998  29640]]
Evaluating performance on  val set...
2174/2174 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1325798
{'0': {'precision': 0.5106446065350175, 'recall': 0.09493151062481052, 'f1-score': 0.16009965557471612, 'support': 181415}, '1': {'precision': 0.3442504324678631, 'recall': 0.9119583687340697, 'f1-score': 0.4998246510118582, 'support': 188320}, '2': {'precision': 0.48853364579846, 'recall': 0.06250535423627174, 'f1-score': 0.11083051684198533, 'support': 186768}, 'accuracy': 0.3605299522194849, 'macro avg': {'precision': 0.4478095616004469, 'recall': 0.3564650778650506, 'f1-score': 0.25691827447618654, 'support': 556503}, 'weighted avg': {'precision': 0.44691634132320035, 'recall': 0.3605299522194849, 'f1-score': 0.25852700032917014, 'support': 556503}}
[[ 17222 158869   5324]
 [  9682 171740   6898]
 [  6822 168272  11674]]
training model: results/universal/W2/deepLOB_L2/h10
Epoch 1/50
9940/9940 - 405s - loss: 2.8584 - accuracy10: 0.5128 - val_loss: 3.7353 - val_accuracy10: 0.4561 - 405s/epoch - 41ms/step
Epoch 2/50
9940/9940 - 401s - loss: 2.7152 - accuracy10: 0.5506 - val_loss: 4.0664 - val_accuracy10: 0.4709 - 401s/epoch - 40ms/step
Epoch 3/50
9940/9940 - 400s - loss: 2.6526 - accuracy10: 0.5655 - val_loss: 3.9635 - val_accuracy10: 0.4851 - 400s/epoch - 40ms/step
Epoch 4/50
9940/9940 - 401s - loss: 2.6222 - accuracy10: 0.5715 - val_loss: 4.1145 - val_accuracy10: 0.4982 - 401s/epoch - 40ms/step
Epoch 5/50
9940/9940 - 401s - loss: 2.6029 - accuracy10: 0.5748 - val_loss: 4.1052 - val_accuracy10: 0.4999 - 401s/epoch - 40ms/step
Epoch 6/50
9940/9940 - 403s - loss: 2.5881 - accuracy10: 0.5776 - val_loss: 4.0659 - val_accuracy10: 0.4994 - 403s/epoch - 40ms/step
Epoch 7/50
9940/9940 - 403s - loss: 2.5773 - accuracy10: 0.5795 - val_loss: 4.0292 - val_accuracy10: 0.5034 - 403s/epoch - 41ms/step
Epoch 8/50
9940/9940 - 403s - loss: 2.5691 - accuracy10: 0.5810 - val_loss: 3.9247 - val_accuracy10: 0.5068 - 403s/epoch - 41ms/step
Epoch 9/50
9940/9940 - 402s - loss: 2.5624 - accuracy10: 0.5824 - val_loss: 3.9421 - val_accuracy10: 0.5062 - 402s/epoch - 40ms/step
Epoch 10/50
9940/9940 - 403s - loss: 2.5565 - accuracy10: 0.5835 - val_loss: 3.9263 - val_accuracy10: 0.5090 - 403s/epoch - 41ms/step
Epoch 11/50
9940/9940 - 401s - loss: 2.5519 - accuracy10: 0.5843 - val_loss: 3.8689 - val_accuracy10: 0.5107 - 401s/epoch - 40ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 351s - 351s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1155806
{'0': {'precision': 0.3452880915828649, 'recall': 0.6159465856992116, 'f1-score': 0.44251216923305225, 'support': 1585493}, '1': {'precision': 0.607180723287663, 'recall': 0.46287866101160063, 'f1-score': 0.5252998185170761, 'support': 3511188}, '2': {'precision': 0.3449193704271866, 'recall': 0.25819660018422647, 'f1-score': 0.29532299962709074, 'support': 1624088}, 'accuracy': 0.449526981213013, 'macro avg': {'precision': 0.4324627284325715, 'recall': 0.44567394896501283, 'f1-score': 0.42104499579240634, 'support': 6720769}, 'weighted avg': {'precision': 0.4820217644893468, 'recall': 0.449526981213013, 'f1-score': 0.45019504549725153, 'support': 6720769}}
[[ 976579  412692  196222]
 [1285745 1625254  600189]
 [ 565978  638776  419334]]
Evaluating performance on  train set...
9940/9940 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1292782
{'0': {'precision': 0.36124129128891563, 'recall': 0.535274644893468, 'f1-score': 0.43136612772089106, 'support': 639808}, '1': {'precision': 0.5649649844075405, 'recall': 0.5395506604856456, 'f1-score': 0.5519654373348957, 'support': 1261496}, '2': {'precision': 0.3849781234807973, 'recall': 0.2342461701332669, 'f1-score': 0.29126651502685963, 'support': 642320}, 'accuracy': 0.4613791189263822, 'macro avg': {'precision': 0.4370614663924178, 'recall': 0.4363571585041269, 'f1-score': 0.42486602669421547, 'support': 2543624}, 'weighted avg': {'precision': 0.4682709725735168, 'recall': 0.4613791189263822, 'f1-score': 0.4557984980142985, 'support': 2543624}}
[[342473 221864  75471]
 [415957 680641 164898]
 [189615 302244 150461]]
Evaluating performance on  val set...
3393/3393 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1422094
{'0': {'precision': 0.3657177628903738, 'recall': 0.579658274367835, 'f1-score': 0.4484804331565649, 'support': 218772}, '1': {'precision': 0.5692045318025354, 'recall': 0.5109015938057474, 'f1-score': 0.538479498642961, 'support': 426589}, '2': {'precision': 0.36839976307767874, 'recall': 0.2289898799421711, 'f1-score': 0.2824281220927657, 'support': 222726}, 'accuracy': 0.45589900551442425, 'macro avg': {'precision': 0.4344406859235293, 'recall': 0.4398499160385845, 'f1-score': 0.42312935129743057, 'support': 868087}, 'weighted avg': {'precision': 0.46640187454875337, 'recall': 0.45589900551442425, 'f1-score': 0.4501029022325682, 'support': 868087}}
[[126813  66130  25829]
 [147033 217945  61611]
 [ 72905  98819  51002]]
testing model out of sample: results/universal/W2/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 195s - 195s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0156999
{'0': {'precision': 0.3433375456332491, 'recall': 0.5982578681371926, 'f1-score': 0.4362901201472519, 'support': 833806}, '1': {'precision': 0.6667194627010548, 'recall': 0.4565245726782742, 'f1-score': 0.5419549238079826, 'support': 2010078}, '2': {'precision': 0.37486910119537326, 'recall': 0.38153415754287845, 'f1-score': 0.37817226475732507, 'support': 822849}, 'accuracy': 0.47192582606914657, 'macro avg': {'precision': 0.4616420365098924, 'recall': 0.47877219945278177, 'f1-score': 0.4521391029041865, 'support': 3666733}, 'weighted avg': {'precision': 0.527689279467853, 'recall': 0.47192582606914657, 'f1-score': 0.4811726567330923, 'support': 3666733}}
[[498831 183102 151873]
 [720767 917650 371661]
 [233290 275614 313945]]
Evaluating performance on  train set...
5373/5373 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9655883
{'0': {'precision': 0.31535699645485765, 'recall': 0.5849843905831464, 'f1-score': 0.4097977123859338, 'support': 261701}, '1': {'precision': 0.7293155282572394, 'recall': 0.5190379082375656, 'f1-score': 0.6064667187438595, 'support': 847362}, '2': {'precision': 0.3368658123537833, 'recall': 0.362921276459679, 'f1-score': 0.34940847743377174, 'support': 265829}, 'accuracy': 0.50140592861112, 'macro avg': {'precision': 0.46051277902196014, 'recall': 0.48898119176013033, 'f1-score': 0.4552243028545217, 'support': 1374892}, 'weighted avg': {'precision': 0.5746431050704619, 'recall': 0.50140592861112, 'f1-score': 0.5193311394677456, 'support': 1374892}}
[[153091  63920  44690]
 [262324 439813 145225]
 [ 70038  99316  96475]]
Evaluating performance on  val set...
1685/1685 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9559594
{'0': {'precision': 0.3379639042709691, 'recall': 0.6363800150889006, 'f1-score': 0.44147342683836593, 'support': 88807}, '1': {'precision': 0.725852423797673, 'recall': 0.538385687013868, 'f1-score': 0.6182198630385158, 'support': 253532}, '2': {'precision': 0.38275551075625347, 'recall': 0.3267068932335594, 'f1-score': 0.35251723864143014, 'support': 88333}, 'accuracy': 0.5151762826466545, 'macro avg': {'precision': 0.48219061294163185, 'recall': 0.5004908651121093, 'f1-score': 0.47073684283943734, 'support': 430672}, 'weighted avg': {'precision': 0.5754967113917221, 'recall': 0.5151762826466545, 'f1-score': 0.5272768003817968, 'support': 430672}}
[[ 56515  19155  13137]
 [ 83632 136498  33402]
 [ 27075  32399  28859]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2529154
{'0': {'precision': 0.33197450997768413, 'recall': 0.5886714285714286, 'f1-score': 0.4245365147558042, 'support': 70000}, '1': {'precision': 0.45628068248137593, 'recall': 0.11749573458039764, 'f1-score': 0.18687081716438894, 'support': 113119}, '2': {'precision': 0.3213555154727476, 'recall': 0.4596834640221402, 'f1-score': 0.3782700234261483, 'support': 69376}, 'accuracy': 0.34214142854313945, 'macro avg': {'precision': 0.3698702359772692, 'recall': 0.3886168757246555, 'f1-score': 0.3298924517821138, 'support': 252495}, 'weighted avg': {'precision': 0.38474659086907065, 'recall': 0.34214142854313945, 'f1-score': 0.30534884708583243, 'support': 252495}}
[[41207  6512 22281]
 [54761 13291 45067]
 [28159  9326 31891]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2463926
{'0': {'precision': 0.3343675732770003, 'recall': 0.5857861562481929, 'f1-score': 0.42572863476853895, 'support': 17293}, '1': {'precision': 0.4480846124081001, 'recall': 0.1351067553377669, 'f1-score': 0.20761369748401365, 'support': 25713}, '2': {'precision': 0.34353045798132503, 'recall': 0.44065476529972053, 'f1-score': 0.38607800514704044, 'support': 17533}, 'accuracy': 0.3523348585209534, 'macro avg': {'precision': 0.37532754788880845, 'recall': 0.3871825589618934, 'f1-score': 0.33980677913319773, 'support': 60539}, 'weighted avg': {'precision': 0.3853208279508286, 'recall': 0.3523348585209534, 'f1-score': 0.3216042872974751, 'support': 60539}}
[[10130  1810  5353]
 [12828  3474  9411]
 [ 7338  2469  7726]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2547114
{'0': {'precision': 0.32159821179100306, 'recall': 0.6030387705204331, 'f1-score': 0.4194861203911802, 'support': 5726}, '1': {'precision': 0.5069503546099291, 'recall': 0.1791119575022552, 'f1-score': 0.26470152569989636, 'support': 9977}, '2': {'precision': 0.3326519487598801, 'recall': 0.41393929116499917, 'f1-score': 0.3688704193426521, 'support': 5897}, 'accuracy': 0.35560185185185184, 'macro avg': {'precision': 0.3870668383869374, 'recall': 0.39869667306256246, 'f1-score': 0.3510193551445762, 'support': 21600}, 'weighted avg': {'precision': 0.4102297958562759, 'recall': 0.35560185185185184, 'f1-score': 0.33417284769126776, 'support': 21600}}
[[3453  749 1524]
 [4817 1787 3373]
 [2467  989 2441]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0119075
{'0': {'precision': 0.24915494317998904, 'recall': 0.6156997673077306, 'f1-score': 0.3547523963949511, 'support': 50281}, '1': {'precision': 0.7887350007791804, 'recall': 0.3725662495399337, 'f1-score': 0.5060806419358064, 'support': 217360}, '2': {'precision': 0.27600550206327373, 'recall': 0.5000598109972487, 'f1-score': 0.3556898030957294, 'support': 50158}, 'accuracy': 0.4311561710389271, 'macro avg': {'precision': 0.43796514867414765, 'recall': 0.49610860928163764, 'f1-score': 0.40550761380882894, 'support': 317799}, 'weighted avg': {'precision': 0.6224408618022252, 'recall': 0.4311561710389271, 'f1-score': 0.4584019544365369, 'support': 317799}}
[[30958  7625 11698]
 [82284 80981 54095]
 [11010 14066 25082]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93615144
{'0': {'precision': 0.20239900266181476, 'recall': 0.7479300255244973, 'f1-score': 0.31858500948011825, 'support': 16063}, '1': {'precision': 0.8469320066334992, 'recall': 0.44766394280872285, 'f1-score': 0.5857285766169884, 'support': 102673}, '2': {'precision': 0.26341257164333365, 'recall': 0.3465817777228335, 'f1-score': 0.2993273542600897, 'support': 16178}, 'accuracy': 0.4712928235765006, 'macro avg': {'precision': 0.4375811936462159, 'recall': 0.5140585820186846, 'f1-score': 0.4012136467857321, 'support': 134914}, 'weighted avg': {'precision': 0.7002214275826368, 'recall': 0.4712928235765006, 'f1-score': 0.519578836084431, 'support': 134914}}
[[12014  2498  1551]
 [42582 45963 14128]
 [ 4762  5809  5607]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93506664
{'0': {'precision': 0.23297378652953718, 'recall': 0.6907772406098922, 'f1-score': 0.3484336897392609, 'support': 5378}, '1': {'precision': 0.8159842961301178, 'recall': 0.4846597155135081, 'f1-score': 0.6081213818470605, 'support': 30019}, '2': {'precision': 0.2444639976536149, 'recall': 0.32070026933435936, 'f1-score': 0.27744029291836564, 'support': 5198}, 'accuracy': 0.4909717945559798, 'macro avg': {'precision': 0.43114069343775663, 'recall': 0.49871240848591986, 'f1-score': 0.411331788168229, 'support': 40595}, 'weighted avg': {'precision': 0.6655669286682928, 'recall': 0.4909717945559798, 'f1-score': 0.5313759523999093, 'support': 40595}}
[[ 3715  1117   546]
 [10864 14549  4606]
 [ 1367  2164  1667]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1288401
{'0': {'precision': 0.4538631195609431, 'recall': 0.5748687131178605, 'f1-score': 0.5072492153649927, 'support': 92355}, '1': {'precision': 0.44211990860702294, 'recall': 0.4085033612454299, 'f1-score': 0.4246473736153936, 'support': 84790}, '2': {'precision': 0.4697941489631395, 'recall': 0.38182511229241356, 'f1-score': 0.4212661968629233, 'support': 97068}, 'accuracy': 0.4550914799808908, 'macro avg': {'precision': 0.45525905904370184, 'recall': 0.45506572888523467, 'f1-score': 0.45105426194776993, 'support': 274213}, 'weighted avg': {'precision': 0.4558713624423145, 'recall': 0.4550914799808908, 'f1-score': 0.45127079785047886, 'support': 274213}}
[[53092 17482 21781]
 [30105 34637 20048]
 [33781 26224 37063]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1505373
{'0': {'precision': 0.4233908063032317, 'recall': 0.6174319470290388, 'f1-score': 0.5023237800154918, 'support': 23107}, '1': {'precision': 0.46400170104188815, 'recall': 0.4006536187713436, 'f1-score': 0.43000709387562075, 'support': 27233}, '2': {'precision': 0.43825834175935285, 'recall': 0.3055604511808248, 'f1-score': 0.3600726895119418, 'support': 22696}, 'accuracy': 0.43968727750698283, 'macro avg': {'precision': 0.4418836163681576, 'recall': 0.4412153389937357, 'f1-score': 0.4308011878010181, 'support': 73036}, 'weighted avg': {'precision': 0.4431535271686947, 'recall': 0.43968727750698283, 'f1-score': 0.431154342153127, 'support': 73036}}
[[14267  4938  3902]
 [11335 10911  4987]
 [ 8095  7666  6935]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1505072
{'0': {'precision': 0.43481761816571385, 'recall': 0.5866376969038566, 'f1-score': 0.49944506104328523, 'support': 9205}, '1': {'precision': 0.49720859414650653, 'recall': 0.510553287587944, 'f1-score': 0.5037925862438397, 'support': 11513}, '2': {'precision': 0.4437859195402299, 'recall': 0.27180728192718073, 'f1-score': 0.337130772904018, 'support': 9091}, 'accuracy': 0.46123653930021136, 'macro avg': {'precision': 0.4586040439508168, 'recall': 0.45633275547299385, 'f1-score': 0.44678947339704767, 'support': 29809}, 'weighted avg': {'precision': 0.46164972035842716, 'recall': 0.46123653930021136, 'f1-score': 0.45162238548086797, 'support': 29809}}
[[5400 2398 1407]
 [3945 5878 1690]
 [3074 3546 2471]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2155575
{'0': {'precision': 0.4092692568663894, 'recall': 0.5330643611911623, 'f1-score': 0.4630352791962885, 'support': 78075}, '1': {'precision': 0.30329017048754653, 'recall': 0.13578792792241565, 'f1-score': 0.18758915080882899, 'support': 65374}, '2': {'precision': 0.38619302346489254, 'recall': 0.4492450486959932, 'f1-score': 0.4153397107790112, 'support': 76495}, 'accuracy': 0.38583002946204487, 'macro avg': {'precision': 0.3662508169396095, 'recall': 0.3726991126031904, 'f1-score': 0.3553213802613762, 'support': 219944}, 'weighted avg': {'precision': 0.3697433172318553, 'recall': 0.38583002946204487, 'f1-score': 0.36457618186568885, 'support': 219944}}
[[41619  8914 27542]
 [29420  8877 27077]
 [30652 11478 34365]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2548251
{'0': {'precision': 0.39044468762435336, 'recall': 0.5629908552985476, 'f1-score': 0.461104665677823, 'support': 27885}, '1': {'precision': 0.35194885909615553, 'recall': 0.1459875520200346, 'f1-score': 0.20637234485630987, 'support': 27153}, '2': {'precision': 0.3690708682268048, 'recall': 0.41848070860231196, 'f1-score': 0.3922258376571981, 'support': 26644}, 'accuracy': 0.3772312137312994, 'macro avg': {'precision': 0.3704881383157712, 'recall': 0.37581970530696474, 'f1-score': 0.3532342827304437, 'support': 81682}, 'weighted avg': {'precision': 0.37067581227783347, 'recall': 0.3772312137312994, 'f1-score': 0.3539579968762746, 'support': 81682}}
[[15699  3351  8835]
 [12963  3964 10226]
 [11546  3948 11150]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2223194
{'0': {'precision': 0.41339071422659934, 'recall': 0.5597265800089646, 'f1-score': 0.47555576712524394, 'support': 8924}, '1': {'precision': 0.38430813124108415, 'recall': 0.16420821650615627, 'f1-score': 0.23009907755380932, 'support': 8203}, '2': {'precision': 0.3552757921689961, 'recall': 0.4250702067909114, 'f1-score': 0.3870517812518161, 'support': 7834}, 'accuracy': 0.3874844757822203, 'macro avg': {'precision': 0.38432487921222647, 'recall': 0.3830016677686774, 'f1-score': 0.36423554197695646, 'support': 24961}, 'weighted avg': {'precision': 0.3855938820632467, 'recall': 0.3874844757822203, 'f1-score': 0.36711373956677623, 'support': 24961}}
[[4995 1034 2895]
 [3708 1347 3148]
 [3380 1124 3330]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1205205
{'0': {'precision': 0.46466421050237655, 'recall': 0.536911120308507, 'f1-score': 0.4981819622616207, 'support': 152217}, '1': {'precision': 0.4834465020104442, 'recall': 0.580612301084742, 'f1-score': 0.52759299611479, 'support': 181610}, '2': {'precision': 0.47627288269880325, 'recall': 0.29268636445173357, 'f1-score': 0.36256428163291216, 'support': 156092}, 'accuracy': 0.4752989779943215, 'macro avg': {'precision': 0.474794531737208, 'recall': 0.47006992861499414, 'f1-score': 0.46277974666977434, 'support': 489919}, 'weighted avg': {'precision': 0.4753253051348868, 'recall': 0.4752989779943215, 'f1-score': 0.46587560723839794, 'support': 489919}}
[[ 81727  45924  24566]
 [ 50493 105445  25672]
 [ 43664  66742  45686]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0844618
{'0': {'precision': 0.4043628389958665, 'recall': 0.6076047643394118, 'f1-score': 0.4855744130265358, 'support': 52809}, '1': {'precision': 0.5695725132499294, 'recall': 0.44860571323885423, 'f1-score': 0.5019032560318577, 'support': 76419}, '2': {'precision': 0.4365210601258555, 'recall': 0.35292916163773097, 'f1-score': 0.3902994958776964, 'support': 53855}, 'accuracy': 0.4663240169759071, 'macro avg': {'precision': 0.4701521374572171, 'recall': 0.469713213071999, 'f1-score': 0.4592590549786966, 'support': 183083}, 'weighted avg': {'precision': 0.48278103782250137, 'recall': 0.4663240169759071, 'f1-score': 0.4643643781820824, 'support': 183083}}
[[32087 10167 10555]
 [28157 34282 13980]
 [19108 15740 19007]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1403673
{'0': {'precision': 0.4179652676247192, 'recall': 0.6447194719471947, 'f1-score': 0.507150120070095, 'support': 18180}, '1': {'precision': 0.43252651177851537, 'recall': 0.29066478076379065, 'f1-score': 0.3476817959980478, 'support': 18382}, '2': {'precision': 0.4449431897881891, 'recall': 0.3506522219765642, 'f1-score': 0.39221020092735703, 'support': 18092}, 'accuracy': 0.42829436088849854, 'macro avg': {'precision': 0.4318116563971412, 'recall': 0.4286788248958498, 'f1-score': 0.4156807056651666, 'support': 54654}, 'weighted avg': {'precision': 0.43179315502210236, 'recall': 0.42829436088849854, 'f1-score': 0.4154671737125953, 'support': 54654}}
[[11721  2669  3790]
 [ 8915  5343  4124]
 [ 7407  4341  6344]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
4918/4918 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97245437
{'0': {'precision': 0.22402381765498341, 'recall': 0.734904979552562, 'f1-score': 0.343375273768923, 'support': 145495}, '1': {'precision': 0.8686076631265214, 'recall': 0.35677897316327956, 'f1-score': 0.5058010932293949, 'support': 967145}, '2': {'precision': 0.22350914536564548, 'recall': 0.5875074384913713, 'f1-score': 0.3238239219441575, 'support': 146199}, 'accuracy': 0.4272786273701403, 'macro avg': {'precision': 0.43871354204905005, 'recall': 0.5597304637357375, 'f1-score': 0.39100009631415844, 'support': 1258839}, 'weighted avg': {'precision': 0.7191870582715688, 'recall': 0.4272786273701403, 'f1-score': 0.4658936665710757, 'support': 1258839}}
[[106925  14146  24424]
 [348112 345057 273976]
 [ 22256  38050  85893]]
Evaluating performance on  train set...
1403/1403 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81691575
{'0': {'precision': 0.21621161929908397, 'recall': 0.740910352484041, 'f1-score': 0.3347398383668659, 'support': 36030}, '1': {'precision': 0.8930372945452837, 'recall': 0.5304633243689154, 'f1-score': 0.6655754493612439, 'support': 286689}, '2': {'precision': 0.2768475927629562, 'recall': 0.4979454510355478, 'f1-score': 0.3558498635212503, 'support': 36261}, 'accuracy': 0.5483007409883559, 'macro avg': {'precision': 0.462032168869108, 'recall': 0.5897730426295015, 'f1-score': 0.4520550504164534, 'support': 358980}, 'weighted avg': {'precision': 0.7628637922458533, 'recall': 0.5483007409883559, 'f1-score': 0.6010844845936483, 'support': 358980}}
[[ 26695   5376   3959]
 [ 91406 152078  43205]
 [  5366  12839  18056]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8536569
{'0': {'precision': 0.23217290955426265, 'recall': 0.7218567797877111, 'f1-score': 0.3513425016371971, 'support': 13378}, '1': {'precision': 0.9002035486596512, 'recall': 0.48778432147836764, 'f1-score': 0.6327219230405853, 'support': 96106}, '2': {'precision': 0.27307467208317554, 'recall': 0.5994105644978462, 'f1-score': 0.37521286660359504, 'support': 13233}, 'accuracy': 0.5253387876170376, 'macro avg': {'precision': 0.46848371009902984, 'recall': 0.6030172219213084, 'f1-score': 0.45309243042712577, 'support': 122717}, 'weighted avg': {'precision': 0.759752671326532, 'recall': 0.5253387876170376, 'f1-score': 0.5742792358549043, 'support': 122717}}
[[ 9657  1670  2051]
 [30163 46879 19064]
 [ 1774  3527  7932]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
4856/4856 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91954803
{'0': {'precision': 0.3311396969121913, 'recall': 0.5950963833899021, 'f1-score': 0.4255071470871701, 'support': 246308}, '1': {'precision': 0.7163646679427023, 'recall': 0.5766519153135844, 'f1-score': 0.6389601853238733, 'support': 761964}, '2': {'precision': 0.4024333477793294, 'recall': 0.3205687179552748, 'f1-score': 0.35686631746754727, 'support': 234633}, 'accuracy': 0.5319642289635974, 'macro avg': {'precision': 0.48331257087807433, 'recall': 0.49743900555292037, 'f1-score': 0.4737778832928636, 'support': 1242905}, 'weighted avg': {'precision': 0.5807608690936545, 'recall': 0.5319642289635974, 'f1-score': 0.5434068474269791, 'support': 1242905}}
[[146577  71217  28514]
 [239403 439388  83173]
 [ 56664 102753  75216]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91533273
{'0': {'precision': 0.23417353428861337, 'recall': 0.5199895587184701, 'f1-score': 0.3229216435738175, 'support': 72788}, '1': {'precision': 0.7922032606733912, 'recall': 0.5143840771247992, 'f1-score': 0.6237573736531636, 'support': 384001}, '2': {'precision': 0.2696455702508157, 'recall': 0.43523940981761167, 'f1-score': 0.33299157216970493, 'support': 74621}, 'accuracy': 0.504038313166858, 'macro avg': {'precision': 0.43200745507094007, 'recall': 0.4898710152202936, 'f1-score': 0.4265568631322287, 'support': 531410}, 'weighted avg': {'precision': 0.6423911661679845, 'recall': 0.504038313166858, 'f1-score': 0.5417219095228074, 'support': 531410}}
[[ 37849  22581  12358]
 [110866 197524  75611]
 [ 12913  29230  32478]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8408933
{'0': {'precision': 0.2649670694804296, 'recall': 0.6627256987385605, 'f1-score': 0.378574658076184, 'support': 20215}, '1': {'precision': 0.8178417851963055, 'recall': 0.5843415658434157, 'f1-score': 0.6816497272192266, 'support': 110011}, '2': {'precision': 0.3063791554357592, 'recall': 0.3225951005775742, 'f1-score': 0.3142780917270986, 'support': 20084}, 'accuracy': 0.5599095203246623, 'macro avg': {'precision': 0.46306267003749807, 'recall': 0.5232207883865169, 'f1-score': 0.45816749234083637, 'support': 150310}, 'weighted avg': {'precision': 0.6751461705711491, 'recall': 0.5599095203246623, 'f1-score': 0.5918023820662062, 'support': 150310}}
[[13397  5100  1718]
 [32777 64284 12950]
 [ 4387  9218  6479]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
4353/4353 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8139895
{'0': {'precision': 0.367307729255125, 'recall': 0.5105812475296179, 'f1-score': 0.4272532030581299, 'support': 187218}, '1': {'precision': 0.74436944901939, 'recall': 0.7961978511590583, 'f1-score': 0.7694118338212688, 'support': 740213}, '2': {'precision': 0.440673612560402, 'recall': 0.14690378203653062, 'f1-score': 0.22035095605824653, 'support': 186857}, 'accuracy': 0.6393284321468059, 'macro avg': {'precision': 0.517450263611639, 'recall': 0.48456096024173556, 'f1-score': 0.47233866431254845, 'support': 1114288}, 'weighted avg': {'precision': 0.6300898068047711, 'recall': 0.6393284321468059, 'f1-score': 0.6198507482039253, 'support': 1114288}}
[[ 95590  80674  10954]
 [126970 589356  23887]
 [ 37685 121722  27450]]
Evaluating performance on  train set...
1542/1542 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89346427
{'0': {'precision': 0.34417520617486647, 'recall': 0.48730794923179693, 'f1-score': 0.40342203641029045, 'support': 74850}, '1': {'precision': 0.7254253043728993, 'recall': 0.681097112563943, 'f1-score': 0.7025626811767869, 'support': 247486}, '2': {'precision': 0.38431574828359005, 'recall': 0.2991540559624517, 'f1-score': 0.33642924429150867, 'support': 72227}, 'accuracy': 0.5744177735874879, 'macro avg': {'precision': 0.4846387529437853, 'recall': 0.4891863725860639, 'f1-score': 0.4808046539595287, 'support': 394563}, 'weighted avg': {'precision': 0.5906587658029236, 'recall': 0.5744177735874879, 'f1-score': 0.5787918334118285, 'support': 394563}}
[[ 36475  28921   9454]
 [ 53763 168562  25161]
 [ 15740  34880  21607]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9033924
{'0': {'precision': 0.33212198738262055, 'recall': 0.5157794934308547, 'f1-score': 0.40406041099282, 'support': 22149}, '1': {'precision': 0.7072922643576235, 'recall': 0.6847972930318296, 'f1-score': 0.695863028988947, 'support': 79203}, '2': {'precision': 0.353667511652629, 'recall': 0.19696693687949723, 'f1-score': 0.25302015385965426, 'support': 21958}, 'accuracy': 0.5675695401832779, 'macro avg': {'precision': 0.4643605877976243, 'recall': 0.46584790778072716, 'f1-score': 0.45098119794714037, 'support': 123310}, 'weighted avg': {'precision': 0.5769335036357387, 'recall': 0.5675695401832779, 'f1-score': 0.5645915989501405, 'support': 123310}}
[[11424  9344  1381]
 [18442 54238  6523]
 [ 4531 13102  4325]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99963695
{'0': {'precision': 0.2968759743094095, 'recall': 0.6454386903409716, 'f1-score': 0.4066905615292712, 'support': 272926}, '1': {'precision': 0.7436851779366355, 'recall': 0.3740442899164743, 'f1-score': 0.4977433311067942, 'support': 868595}, '2': {'precision': 0.33022339062454403, 'recall': 0.46854110207768745, 'f1-score': 0.38740638270392735, 'support': 265680}, 'accuracy': 0.44452214004964463, 'macro avg': {'precision': 0.456928180956863, 'recall': 0.49600802744504446, 'f1-score': 0.4306134251133309, 'support': 1407201}, 'weighted avg': {'precision': 0.578965016167108, 'recall': 0.44452214004964463, 'f1-score': 0.45925203623037736, 'support': 1407201}}
[[176157  41799  54970]
 [346191 324893 197511]
 [ 71021  70177 124482]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9172461
{'0': {'precision': 0.3248699283086814, 'recall': 0.6145929114770543, 'f1-score': 0.42505727025054385, 'support': 95704}, '1': {'precision': 0.7381551825117326, 'recall': 0.5811207319848142, 'f1-score': 0.6502919901229274, 'support': 333996}, '2': {'precision': 0.3627275800453953, 'recall': 0.30933651826531033, 'f1-score': 0.3339112652262826, 'support': 97124}, 'accuracy': 0.5370958802180614, 'macro avg': {'precision': 0.4752508969552698, 'recall': 0.5016833872423929, 'f1-score': 0.4697535085332513, 'support': 526824}, 'weighted avg': {'precision': 0.5938639535051017, 'recall': 0.5370958802180614, 'f1-score': 0.5510481721580505, 'support': 526824}}
[[ 58819  24450  12435]
 [ 99555 194092  40349]
 [ 22680  44400  30044]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9278813
{'0': {'precision': 0.34322091908912516, 'recall': 0.6359178151686818, 'f1-score': 0.4458209839952578, 'support': 35481}, '1': {'precision': 0.7241886820222239, 'recall': 0.569672645177474, 'f1-score': 0.637704324911034, 'support': 103649}, '2': {'precision': 0.4086805298601347, 'recall': 0.31405499161193096, 'f1-score': 0.35517324543773615, 'support': 35169}, 'accuracy': 0.5315807893332721, 'macro avg': {'precision': 0.4920300436571612, 'recall': 0.5065484839860289, 'f1-score': 0.47956618478134266, 'support': 174299}, 'weighted avg': {'precision': 0.5829760336420392, 'recall': 0.5315807893332721, 'f1-score': 0.5416363706885252, 'support': 174299}}
[[22563  8207  4711]
 [33333 59046 11270]
 [ 9843 14281 11045]]
testing model on single stock: results/universal/W2/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 213s - 213s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2538351
{'0': {'precision': 0.37635602754579256, 'recall': 0.6241746885516496, 'f1-score': 0.4695746017557605, 'support': 1124424}, '1': {'precision': 0.44325607452629434, 'recall': 0.39479559475536063, 'f1-score': 0.4176247169140159, 'support': 1521096}, '2': {'precision': 0.4180626143525107, 'recall': 0.21193614793808546, 'f1-score': 0.28127858461387656, 'support': 1164379}, 'accuracy': 0.4066073667569665, 'macro avg': {'precision': 0.4125582388081992, 'recall': 0.4103021437483652, 'f1-score': 0.38949263442788434, 'support': 3809899}, 'weighted avg': {'precision': 0.4158121043870088, 'recall': 0.4066073667569665, 'f1-score': 0.39128678095607844, 'support': 3809899}}
[[701837 301009 121578]
 [698646 600522 221928]
 [464339 453266 246774]]
Evaluating performance on  train set...
6147/6147 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2694222
{'0': {'precision': 0.4065229253235956, 'recall': 0.5192358447771042, 'f1-score': 0.45601787715971914, 'support': 484980}, '1': {'precision': 0.4208564489048517, 'recall': 0.5185248412120603, 'f1-score': 0.4646133058798741, 'support': 597495}, '2': {'precision': 0.4306164317546573, 'recall': 0.19108368465000714, 'f1-score': 0.2647056749043932, 'support': 491010}, 'accuracy': 0.41656514043667403, 'macro avg': {'precision': 0.41933193532770147, 'recall': 0.4096147902130573, 'f1-score': 0.3951122859813288, 'support': 1573485}, 'weighted avg': {'precision': 0.4194841936324122, 'recall': 0.41656514043667403, 'f1-score': 0.3995823351963458, 'support': 1573485}}
[[251819 181604  51557]
 [215177 309816  72502]
 [152450 244736  93824]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2703556
{'0': {'precision': 0.39948229813536795, 'recall': 0.5745902464144712, 'f1-score': 0.471296790794776, 'support': 168943}, '1': {'precision': 0.4335618913245466, 'recall': 0.4730683663603338, 'f1-score': 0.45245438017641904, 'support': 213058}, '2': {'precision': 0.41712840130807677, 'recall': 0.19370440622797316, 'f1-score': 0.2645555651214301, 'support': 174503}, 'accuracy': 0.41628811293359974, 'macro avg': {'precision': 0.41672419692266377, 'recall': 0.413787673000926, 'f1-score': 0.3961022453642083, 'support': 556504}, 'weighted avg': {'precision': 0.4180629874163924, 'recall': 0.41628811293359974, 'f1-score': 0.39925509760802125, 'support': 556504}}
[[ 97073  52920  18950]
 [ 83984 100791  28283]
 [ 61940  78761  33802]]
training model: results/universal/W2/deepLOB_L2/h20
Epoch 1/50
9940/9940 - 409s - loss: 2.9238 - accuracy20: 0.4995 - val_loss: 3.6260 - val_accuracy20: 0.4339 - 409s/epoch - 41ms/step
Epoch 2/50
9940/9940 - 400s - loss: 2.8184 - accuracy20: 0.5296 - val_loss: 3.8169 - val_accuracy20: 0.4453 - 400s/epoch - 40ms/step
Epoch 3/50
9940/9940 - 400s - loss: 2.7660 - accuracy20: 0.5434 - val_loss: 3.9076 - val_accuracy20: 0.4614 - 400s/epoch - 40ms/step
Epoch 4/50
9940/9940 - 403s - loss: 2.7347 - accuracy20: 0.5500 - val_loss: 3.9660 - val_accuracy20: 0.4624 - 403s/epoch - 41ms/step
Epoch 5/50
9940/9940 - 399s - loss: 2.7134 - accuracy20: 0.5549 - val_loss: 3.8228 - val_accuracy20: 0.4700 - 399s/epoch - 40ms/step
Epoch 6/50
9940/9940 - 402s - loss: 2.6985 - accuracy20: 0.5578 - val_loss: 3.8194 - val_accuracy20: 0.4761 - 402s/epoch - 40ms/step
Epoch 7/50
9940/9940 - 404s - loss: 2.6870 - accuracy20: 0.5599 - val_loss: 3.7839 - val_accuracy20: 0.4792 - 404s/epoch - 41ms/step
Epoch 8/50
9940/9940 - 402s - loss: 2.6777 - accuracy20: 0.5617 - val_loss: 3.7073 - val_accuracy20: 0.4802 - 402s/epoch - 40ms/step
Epoch 9/50
9940/9940 - 401s - loss: 2.6707 - accuracy20: 0.5632 - val_loss: 3.7348 - val_accuracy20: 0.4810 - 401s/epoch - 40ms/step
Epoch 10/50
9940/9940 - 401s - loss: 2.6648 - accuracy20: 0.5642 - val_loss: 3.6895 - val_accuracy20: 0.4825 - 401s/epoch - 40ms/step
Epoch 11/50
9940/9940 - 402s - loss: 2.6591 - accuracy20: 0.5654 - val_loss: 3.7105 - val_accuracy20: 0.4813 - 402s/epoch - 40ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 350s - 350s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1540792
{'0': {'precision': 0.3665538372407524, 'recall': 0.6399448784884725, 'f1-score': 0.4661193246780523, 'support': 1789501}, '1': {'precision': 0.5582021163474586, 'recall': 0.42370000369376964, 'f1-score': 0.4817389308587247, 'support': 3086278}, '2': {'precision': 0.4063716393545902, 'recall': 0.2761939089100754, 'f1-score': 0.3288691374151205, 'support': 1844990}, 'accuracy': 0.4407848268553792, 'macro avg': {'precision': 0.4437091976476004, 'recall': 0.4466129303641058, 'f1-score': 0.42557579765063247, 'support': 6720769}, 'weighted avg': {'precision': 0.46549241320830864, 'recall': 0.4407848268553792, 'f1-score': 0.4356140690928412, 'support': 6720769}}
[[1145182  415801  228518]
 [1262752 1307656  515870]
 [ 716251  619164  509575]]
Evaluating performance on  train set...
9940/9940 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1755056
{'0': {'precision': 0.37588510036919504, 'recall': 0.5740513529792313, 'f1-score': 0.4542984947489446, 'support': 717232}, '1': {'precision': 0.511856650481271, 'recall': 0.46398062854124306, 'f1-score': 0.48674420524538337, 'support': 1105544}, '2': {'precision': 0.41631811355434517, 'recall': 0.25765764765942334, 'f1-score': 0.31831277024931065, 'support': 720848}, 'accuracy': 0.436546832393467, 'macro avg': {'precision': 0.4346866214682705, 'recall': 0.43189654305996594, 'f1-score': 0.4197851567478796, 'support': 2543624}, 'weighted avg': {'precision': 0.4464413571451943, 'recall': 0.436546832393467, 'f1-score': 0.4298629347097889, 'support': 2543624}}
[[411728 211353  94151]
 [426346 512951 166247]
 [257282 277834 185732]]
Evaluating performance on  val set...
3393/3393 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1745554
{'0': {'precision': 0.38099793860723324, 'recall': 0.606950676290805, 'f1-score': 0.4681355953455712, 'support': 246048}, '1': {'precision': 0.5170769304879811, 'recall': 0.4321754791884195, 'f1-score': 0.47082939781443456, 'support': 372557}, '2': {'precision': 0.40289800526910047, 'recall': 0.2660352249861713, 'f1-score': 0.3204656507715781, 'support': 249482}, 'accuracy': 0.4339657200257578, 'macro avg': {'precision': 0.43365762478810493, 'recall': 0.4350537934884653, 'f1-score': 0.4198102146438613, 'support': 868087}, 'weighted avg': {'precision': 0.4456928982242437, 'recall': 0.4339657200257578, 'f1-score': 0.4268524081237644, 'support': 868087}}
[[149339  62155  34554]
 [147738 161010  63809]
 [ 94891  88220  66371]]
testing model out of sample: results/universal/W2/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 204s - 204s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0539201
{'0': {'precision': 0.3747876772683388, 'recall': 0.6770332244085102, 'f1-score': 0.4824846306154072, 'support': 998242}, '1': {'precision': 0.6871097922163398, 'recall': 0.3565057561611533, 'f1-score': 0.4694422125478214, 'support': 1669168}, '2': {'precision': 0.44753208029925234, 'recall': 0.4466794019551236, 'f1-score': 0.4471053345900472, 'support': 999323}, 'accuracy': 0.4683427999802549, 'macro avg': {'precision': 0.5031431832613104, 'recall': 0.4934061275082624, 'f1-score': 0.4663440592510919, 'support': 3666733}, 'weighted avg': {'precision': 0.5367883560834003, 'recall': 0.4683427999802549, 'f1-score': 0.46690527669926807, 'support': 3666733}}
[[675843 114743 207656]
 [730714 595068 343386]
 [396712 156234 446377]]
Evaluating performance on  train set...
5373/5373 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99818987
{'0': {'precision': 0.35840050321247247, 'recall': 0.6122754123325187, 'f1-score': 0.4521381696410859, 'support': 325708}, '1': {'precision': 0.7041203398324608, 'recall': 0.494307618071557, 'f1-score': 0.5808476775308916, 'support': 719119}, '2': {'precision': 0.43231195995281063, 'recall': 0.4107857543211186, 'f1-score': 0.42127405059849776, 'support': 330065}, 'accuracy': 0.5022030821329966, 'macro avg': {'precision': 0.498277600999248, 'recall': 0.5057895949083981, 'f1-score': 0.4847532992568251, 'support': 1374892}, 'weighted avg': {'precision': 0.5569683093814873, 'recall': 0.5022030821329966, 'f1-score': 0.5120485387118329, 'support': 1374892}}
[[199423  66506  59779]
 [245388 355466 118265]
 [111614  82865 135586]]
Evaluating performance on  val set...
1685/1685 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0387847
{'0': {'precision': 0.3518990923237698, 'recall': 0.7094150766343447, 'f1-score': 0.4704403820284355, 'support': 108698}, '1': {'precision': 0.7153594742138589, 'recall': 0.37635874657970686, 'f1-score': 0.4932257975383841, 'support': 213432}, '2': {'precision': 0.44101882077943017, 'recall': 0.4032724659578781, 'f1-score': 0.4213018662714034, 'support': 108542}, 'accuracy': 0.46720241854590033, 'macro avg': {'precision': 0.5027591291056862, 'recall': 0.49634876305730985, 'f1-score': 0.46165601527940764, 'support': 430672}, 'weighted avg': {'precision': 0.5544832161897276, 'recall': 0.46720241854590033, 'f1-score': 0.46934800552339123, 'support': 430672}}
[[77112 12555 19031]
 [96656 80327 36449]
 [45363 19407 43772]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2214632
{'0': {'precision': 0.3584781481432237, 'recall': 0.6728432033141174, 'f1-score': 0.46774865113374153, 'support': 80142}, '1': {'precision': 0.4420086668366046, 'recall': 0.038231727483188184, 'f1-score': 0.07037623280165592, 'support': 90710}, '2': {'precision': 0.3922442611990194, 'recall': 0.4527026199429222, 'f1-score': 0.42031045658725197, 'support': 81643}, 'accuracy': 0.3736747262322026, 'macro avg': {'precision': 0.3975770253929492, 'recall': 0.3879258502467426, 'f1-score': 0.31947844684088317, 'support': 252495}, 'weighted avg': {'precision': 0.39940497884835013, 'recall': 0.3736747262322026, 'f1-score': 0.3096518627448129, 'support': 252495}}
[[53923  2131 24088]
 [54063  3468 33179]
 [42436  2247 36960]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2004361
{'0': {'precision': 0.37657469774258095, 'recall': 0.6689026832198638, 'f1-score': 0.48186948917218125, 'support': 19976}, '1': {'precision': 0.42663779101245264, 'recall': 0.07886703698143421, 'f1-score': 0.13312497360307468, 'support': 19983}, '2': {'precision': 0.41644040820147926, 'recall': 0.43226433430515065, 'f1-score': 0.42420485432263605, 'support': 20580}, 'accuracy': 0.39369662531591204, 'macro avg': {'precision': 0.4065509656521709, 'recall': 0.3933446848354829, 'f1-score': 0.346399772365964, 'support': 60539}, 'weighted avg': {'precision': 0.4066519556103352, 'recall': 0.39369662531591204, 'f1-score': 0.34715137622315506, 'support': 60539}}
[[13362   920  5694]
 [11635  1576  6772]
 [10486  1198  8896]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2045884
{'0': {'precision': 0.3612892880051315, 'recall': 0.6734419369302047, 'f1-score': 0.47028127119970775, 'support': 6691}, '1': {'precision': 0.49327878433664524, 'recall': 0.10632401108591585, 'f1-score': 0.17494040833246968, 'support': 7938}, '2': {'precision': 0.39045436160172575, 'recall': 0.41543537512552003, 'f1-score': 0.40255768696135674, 'support': 6971}, 'accuracy': 0.38175925925925924, 'macro avg': {'precision': 0.4150074779811675, 'recall': 0.3984004410472135, 'f1-score': 0.3492597888311781, 'support': 21600}, 'weighted avg': {'precision': 0.419207915316308, 'recall': 0.38175925925925924, 'f1-score': 0.3398869714235188, 'support': 21600}}
[[4506  345 1840]
 [4413  844 2681]
 [3553  522 2896]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.100579
{'0': {'precision': 0.2850849096512963, 'recall': 0.7279896294695906, 'f1-score': 0.4097208047978668, 'support': 64799}, '1': {'precision': 0.7789889118586731, 'recall': 0.2433238697007215, 'f1-score': 0.3708191854909217, 'support': 187384}, '2': {'precision': 0.3781317298876309, 'recall': 0.5405388929529383, 'f1-score': 0.4449797382914926, 'support': 65616}, 'accuracy': 0.40351291224956654, 'macro avg': {'precision': 0.48073518379920016, 'recall': 0.5039507973744168, 'f1-score': 0.40850657619342706, 'support': 317799}, 'weighted avg': {'precision': 0.5955171882495752, 'recall': 0.40351291224956654, 'f1-score': 0.394063137995596, 'support': 317799}}
[[47173  5229 12397]
 [95856 45595 45933]
 [22441  7707 35468]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0791148
{'0': {'precision': 0.23645373701717468, 'recall': 0.8046571798188874, 'f1-score': 0.3655022613038961, 'support': 21644}, '1': {'precision': 0.8489754848152213, 'recall': 0.3045946832950443, 'f1-score': 0.4483358291869958, 'support': 91410}, '2': {'precision': 0.347328110178126, 'recall': 0.45224153705397985, 'f1-score': 0.39290185402301125, 'support': 21860}, 'accuracy': 0.40874186518819394, 'macro avg': {'precision': 0.47758577733684066, 'recall': 0.5204978000559705, 'f1-score': 0.4022466481713011, 'support': 134914}, 'weighted avg': {'precision': 0.669428274600508, 'recall': 0.40874186518819394, 'f1-score': 0.4260650756673721, 'support': 134914}}
[[17416  1926  2302]
 [47292 27843 16275]
 [ 8947  3027  9886]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0922616
{'0': {'precision': 0.26439150649475146, 'recall': 0.7670699485467946, 'f1-score': 0.3932416054751551, 'support': 7191}, '1': {'precision': 0.8088172954641797, 'recall': 0.2886535552193646, 'f1-score': 0.4254654922510871, 'support': 26440}, '2': {'precision': 0.32255244755244755, 'recall': 0.47688110281447443, 'f1-score': 0.38482039397450757, 'support': 6964}, 'accuracy': 0.4056903559551669, 'macro avg': {'precision': 0.46525374983712625, 'recall': 0.5108682021935446, 'f1-score': 0.4011758305669166, 'support': 40595}, 'weighted avg': {'precision': 0.6289598191903415, 'recall': 0.4056903559551669, 'f1-score': 0.4127847573279728, 'support': 40595}}
[[ 5516   819   856]
 [12689  7632  6119]
 [ 2658   985  3321]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1095573
{'0': {'precision': 0.43144182417201316, 'recall': 0.6274693174176194, 'f1-score': 0.5113110936055073, 'support': 95168}, '1': {'precision': 0.52720151269584, 'recall': 0.25070006422607577, 'f1-score': 0.3398102202489771, 'support': 77850}, '2': {'precision': 0.47750164498658704, 'recall': 0.46612974949355207, 'f1-score': 0.47174717471747174, 'support': 101195}, 'accuracy': 0.46096282816642536, 'macro avg': {'precision': 0.4787149939514801, 'recall': 0.4480997103790824, 'f1-score': 0.4409561628573187, 'support': 274213}, 'weighted avg': {'precision': 0.47562614555324134, 'recall': 0.46096282816642536, 'f1-score': 0.44802082741579113, 'support': 274213}}
[[59715  7841 27612]
 [34330 19517 24003]
 [44363  9662 47170]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1389358
{'0': {'precision': 0.41653941340635037, 'recall': 0.6490134142839562, 'f1-score': 0.5074167321477252, 'support': 24377}, '1': {'precision': 0.5024048972452995, 'recall': 0.27986846912678115, 'f1-score': 0.3594837700430191, 'support': 24633}, '2': {'precision': 0.4499343708981811, 'recall': 0.399483892449846, 'f1-score': 0.4232108999514969, 'support': 24026}, 'accuracy': 0.44242565310257953, 'macro avg': {'precision': 0.4562928938499436, 'recall': 0.44278859195352777, 'f1-score': 0.4300371340474138, 'support': 73036}, 'weighted avg': {'precision': 0.4564850800926908, 'recall': 0.44242565310257953, 'f1-score': 0.4298226418378533, 'support': 73036}}
[[15821  2901  5655]
 [11660  6894  6079]
 [10501  3927  9598]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1329119
{'0': {'precision': 0.4203337370475037, 'recall': 0.638948552725785, 'f1-score': 0.5070822679491862, 'support': 9777}, '1': {'precision': 0.5120786923188196, 'recall': 0.3418638338966683, 'f1-score': 0.41000694927032666, 'support': 10355}, '2': {'precision': 0.45319890465521534, 'recall': 0.37625297096207505, 'f1-score': 0.41115690813618655, 'support': 9677}, 'accuracy': 0.4504679794692878, 'macro avg': {'precision': 0.46187044467384625, 'recall': 0.4523551191948428, 'f1-score': 0.4427487084518998, 'support': 29809}, 'weighted avg': {'precision': 0.462873078815906, 'recall': 0.4504679794692878, 'f1-score': 0.4422198226531351, 'support': 29809}}
[[6247 1406 2124]
 [4546 3540 2269]
 [4069 1967 3641]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2375709
{'0': {'precision': 0.38121737134989386, 'recall': 0.6173273699717315, 'f1-score': 0.4713577819887924, 'support': 75349}, '1': {'precision': 0.42915514962143975, 'recall': 0.0531754895391259, 'f1-score': 0.09462610631194023, 'support': 67155}, '2': {'precision': 0.40474968194094146, 'recall': 0.46833677685950414, 'f1-score': 0.43422769775989845, 'support': 77440}, 'accuracy': 0.3926181209762485, 'macro avg': {'precision': 0.40504073430409165, 'recall': 0.3796132121234539, 'f1-score': 0.3334038620202104, 'support': 219944}, 'weighted avg': {'precision': 0.40413958624094065, 'recall': 0.3926181209762485, 'f1-score': 0.3432580411330993, 'support': 219944}}
[[46515  2211 26623]
 [36869  3571 26715]
 [38633  2539 36268]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2517712
{'0': {'precision': 0.3953918328672783, 'recall': 0.6074129300244967, 'f1-score': 0.47898877348190044, 'support': 28167}, '1': {'precision': 0.3788977519941987, 'recall': 0.03851540616246499, 'f1-score': 0.06992305118768818, 'support': 27132}, '2': {'precision': 0.3701231312932993, 'recall': 0.5001705643785771, 'f1-score': 0.42543039525436843, 'support': 26383}, 'accuracy': 0.383805489581548, 'macro avg': {'precision': 0.38147090538492545, 'recall': 0.3820329668551796, 'f1-score': 0.32478073997465234, 'support': 81682}, 'weighted avg': {'precision': 0.38175135447700037, 'recall': 0.383805489581548, 'f1-score': 0.3258117960564757, 'support': 81682}}
[[17109   899 10159]
 [13789  1045 12298]
 [12373   814 13196]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2356132
{'0': {'precision': 0.40326633165829145, 'recall': 0.614803965750338, 'f1-score': 0.4870581935023206, 'support': 8876}, '1': {'precision': 0.44813695871097686, 'recall': 0.05533449390698831, 'f1-score': 0.09850581073602654, 'support': 8042}, '2': {'precision': 0.3632617861249521, 'recall': 0.4713415392266567, 'f1-score': 0.41030358785648574, 'support': 8043}, 'accuracy': 0.38832578822963826, 'macro avg': {'precision': 0.4048883588314068, 'recall': 0.38049333296132765, 'f1-score': 0.331955864031611, 'support': 24961}, 'weighted avg': {'precision': 0.4048324957956676, 'recall': 0.38832578822963826, 'f1-score': 0.3371413009332734, 'support': 24961}}
[[5457  282 3137]
 [4089  445 3508]
 [3986  266 3791]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040654
{'0': {'precision': 0.4573672333653993, 'recall': 0.5981868315999271, 'f1-score': 0.5183837858906069, 'support': 170089}, '1': {'precision': 0.473702854207809, 'recall': 0.3744033037026668, 'f1-score': 0.41823989116114324, 'support': 142870}, '2': {'precision': 0.5009770933091756, 'recall': 0.43750565099457506, 'f1-score': 0.4670950226244344, 'support': 176960}, 'accuracy': 0.47488870609223155, 'macro avg': {'precision': 0.477349060294128, 'recall': 0.4700319287657229, 'f1-score': 0.4679062332253949, 'support': 489919}, 'weighted avg': {'precision': 0.47788301447494136, 'recall': 0.47488870609223155, 'f1-score': 0.4706542269480462, 'support': 489919}}
[[101745  26546  41798]
 [ 54058  53491  35321]
 [ 66655  32884  77421]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.103553
{'0': {'precision': 0.43113342898134865, 'recall': 0.6330168029886608, 'f1-score': 0.5129251428533327, 'support': 60763}, '1': {'precision': 0.5419696809074526, 'recall': 0.42050370955271515, 'f1-score': 0.4735720769957575, 'support': 60789}, '2': {'precision': 0.48201361826045996, 'recall': 0.36584810908322635, 'f1-score': 0.4159729472526863, 'support': 61531}, 'accuracy': 0.4726654031231736, 'macro avg': {'precision': 0.4850389093830871, 'recall': 0.47312287387486746, 'f1-score': 0.46749005570059216, 'support': 183083}, 'weighted avg': {'precision': 0.4850343036931948, 'recall': 0.4726654031231736, 'f1-score': 0.46727481448904157, 'support': 183083}}
[[38464  9004 13295]
 [24331 25562 10896]
 [26421 12599 22511]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1193621
{'0': {'precision': 0.4398540008180989, 'recall': 0.6879090595935239, 'f1-score': 0.5366012821004953, 'support': 20321}, '1': {'precision': 0.45380557648831954, 'recall': 0.2171655247024883, 'f1-score': 0.29375609756097565, 'support': 13865}, '2': {'precision': 0.5015395984727183, 'recall': 0.39788938831346493, 'f1-score': 0.4437421674930529, 'support': 20468}, 'accuracy': 0.4598748490503897, 'macro avg': {'precision': 0.46506639192637894, 'recall': 0.434321324203159, 'f1-score': 0.4246998490515079, 'support': 54654}, 'weighted avg': {'precision': 0.46649467504985437, 'recall': 0.4598748490503897, 'f1-score': 0.4402187878379423, 'support': 54654}}
[[13979  1536  4806]
 [ 7566  3011  3288]
 [10236  2088  8144]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
4918/4918 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090582
{'0': {'precision': 0.292, 'recall': 0.761587508389593, 'f1-score': 0.4221453855117817, 'support': 202632}, '1': {'precision': 0.8791208791208791, 'recall': 0.33215161296012136, 'f1-score': 0.4821399311813862, 'support': 850455}, '2': {'precision': 0.3381807157631205, 'recall': 0.6722753606283293, 'f1-score': 0.4499959334385218, 'support': 205752}, 'accuracy': 0.45686859082058945, 'macro avg': {'precision': 0.5031005316279998, 'recall': 0.5886714939926811, 'f1-score': 0.45142708337722987, 'support': 1258839}, 'weighted avg': {'precision': 0.6961991564309977, 'recall': 0.45686859082058945, 'f1-score': 0.46722896432882355, 'support': 1258839}}
[[154322  13684  34626]
 [331905 282480 236070]
 [ 42273  25157 138322]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9638339
{'0': {'precision': 0.25976434865837156, 'recall': 0.7714610574189881, 'f1-score': 0.38866008908378025, 'support': 51011}, '1': {'precision': 0.8816497206510047, 'recall': 0.3960961768569079, 'f1-score': 0.5466158558723312, 'support': 256569}, '2': {'precision': 0.34884023553140964, 'recall': 0.6258560311284047, 'f1-score': 0.44798317747898925, 'support': 51400}, 'accuracy': 0.4823332776199231, 'macro avg': {'precision': 0.4967514349469286, 'recall': 0.5978044218014336, 'f1-score': 0.46108637414503356, 'support': 358980}, 'weighted avg': {'precision': 0.7169904018982514, 'recall': 0.4823332776199231, 'f1-score': 0.5100477983508299, 'support': 358980}}
[[ 39353   4923   6735]
 [101630 101626  53313]
 [ 10512   8719  32169]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0043432
{'0': {'precision': 0.2731251089208605, 'recall': 0.7525877707822004, 'f1-score': 0.400795624067628, 'support': 18742}, '1': {'precision': 0.8830411071365742, 'recall': 0.352558999812699, 'f1-score': 0.503923701162888, 'support': 85424}, '2': {'precision': 0.3413492750486908, 'recall': 0.680232871543313, 'f1-score': 0.4545831156901241, 'support': 18551}, 'accuracy': 0.4631876594114915, 'macro avg': {'precision': 0.49917183036870855, 'recall': 0.5951265473794042, 'f1-score': 0.4531008136402133, 'support': 122717}, 'weighted avg': {'precision': 0.708004471498307, 'recall': 0.4631876594114915, 'f1-score': 0.48071466230091614, 'support': 122717}}
[[14105  1563  3074]
 [34032 30117 21275]
 [ 3506  2426 12619]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
4856/4856 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0080197
{'0': {'precision': 0.35807384731027014, 'recall': 0.7247677193256221, 'f1-score': 0.479332108521615, 'support': 307602}, '1': {'precision': 0.7445071885736156, 'recall': 0.3845202870402038, 'f1-score': 0.5071233854573481, 'support': 637402}, '2': {'precision': 0.4491657305397244, 'recall': 0.43890084289747266, 'f1-score': 0.443973962383318, 'support': 297901}, 'accuracy': 0.4817608747249387, 'macro avg': {'precision': 0.5172489221412034, 'recall': 0.5160629497544328, 'f1-score': 0.476809818787427, 'support': 1242905}, 'weighted avg': {'precision': 0.5780824140904155, 'recall': 0.4817608747249387, 'f1-score': 0.48510969281699173, 'support': 1242905}}
[[222940  35089  49573]
 [281537 245094 110771]
 [118132  49020 130749]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9127819
{'0': {'precision': 0.3036538198460371, 'recall': 0.5070239739183703, 'f1-score': 0.3798297365934096, 'support': 96313}, '1': {'precision': 0.7462987989707646, 'recall': 0.5804469887495658, 'f1-score': 0.6530066190212934, 'support': 336787}, '2': {'precision': 0.4017119190059825, 'recall': 0.44396297426507986, 'f1-score': 0.42178198685736373, 'support': 98310}, 'accuracy': 0.5418904424079336, 'macro avg': {'precision': 0.48388817927426137, 'recall': 0.510477978977672, 'f1-score': 0.4848727808240223, 'support': 531410}, 'weighted avg': {'precision': 0.6023255917601784, 'recall': 0.5418904424079336, 'f1-score': 0.5607197244101406, 'support': 531410}}
[[ 48833  32657  14823]
 [ 91119 195487  50181]
 [ 20866  33798  43646]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9678034
{'0': {'precision': 0.2878827305056813, 'recall': 0.7390884798099763, 'f1-score': 0.41436567552383524, 'support': 26944}, '1': {'precision': 0.7990357054725613, 'recall': 0.43579178399867485, 'f1-score': 0.5639867893055006, 'support': 96592}, '2': {'precision': 0.4021437357230715, 'recall': 0.42739224620900873, 'f1-score': 0.4143837476687972, 'support': 26774}, 'accuracy': 0.4886634289135786, 'macro avg': {'precision': 0.4963540572337714, 'recall': 0.5340908366725533, 'f1-score': 0.4642454041660444, 'support': 150310}, 'weighted avg': {'precision': 0.6367118989687994, 'recall': 0.4886634289135786, 'f1-score': 0.5105182035393222, 'support': 150310}}
[[19914  4169  2861]
 [40347 42094 14151]
 [ 8913  6418 11443]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
4353/4353 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93557966
{'0': {'precision': 0.3739101116353098, 'recall': 0.6273339461523424, 'f1-score': 0.4685501082657902, 'support': 240419}, '1': {'precision': 0.701356317161525, 'recall': 0.63920377097717, 'f1-score': 0.6688392511383264, 'support': 630924}, '2': {'precision': 0.45549930835565233, 'recall': 0.254814875794933, 'f1-score': 0.3268074952554157, 'support': 242945}, 'accuracy': 0.5528355326450612, 'macro avg': {'precision': 0.5102552457174957, 'recall': 0.5071175309748152, 'f1-score': 0.4880656182198441, 'support': 1114288}, 'weighted avg': {'precision': 0.5771029640869609, 'recall': 0.5528355326450612, 'f1-score': 0.5510526283143833, 'support': 1114288}}
[[150823  67191  22405]
 [176038 403289  51597]
 [ 76506 104533  61906]]
Evaluating performance on  train set...
1542/1542 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98542565
{'0': {'precision': 0.3871729443576951, 'recall': 0.5342821404921324, 'f1-score': 0.44898463930183463, 'support': 95137}, '1': {'precision': 0.6548667235580543, 'recall': 0.6306548453528508, 'f1-score': 0.6425327777613601, 'support': 206858}, '2': {'precision': 0.44070362739589186, 'recall': 0.30501901304986606, 'f1-score': 0.36051737786971066, 'support': 92568}, 'accuracy': 0.5310203947151659, 'macro avg': {'precision': 0.49424776510388035, 'recall': 0.4899853329649497, 'f1-score': 0.48401159831096846, 'support': 394563}, 'weighted avg': {'precision': 0.5400758471775431, 'recall': 0.5310203947151659, 'f1-score': 0.5297011367159653, 'support': 394563}}
[[ 50830  31374  12933]
 [ 53502 130456  22900]
 [ 26953  37380  28235]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9929247
{'0': {'precision': 0.36416824158591016, 'recall': 0.6297326426311581, 'f1-score': 0.4614718283843518, 'support': 28763}, '1': {'precision': 0.6822779523126373, 'recall': 0.5677435928433269, 'f1-score': 0.6197636152190229, 'support': 66176}, '2': {'precision': 0.47289921642799243, 'recall': 0.3084487681082796, 'f1-score': 0.37336803481525727, 'support': 28371}, 'accuracy': 0.5225448057740654, 'macro avg': {'precision': 0.5064484701088466, 'recall': 0.5019750011942549, 'f1-score': 0.484867826139544, 'support': 123310}, 'weighted avg': {'precision': 0.5599028511414743, 'recall': 0.5225448057740654, 'f1-score': 0.5261504802229895, 'support': 123310}}
[[18113  7697  2953]
 [21804 37571  6801]
 [ 9821  9799  8751]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0363914
{'0': {'precision': 0.35444330339191565, 'recall': 0.6868042903363157, 'f1-score': 0.4675798204323742, 'support': 345241}, '1': {'precision': 0.72162622370065, 'recall': 0.3800615268430288, 'f1-score': 0.49789491487817783, 'support': 720336}, '2': {'precision': 0.42901133076584386, 'recall': 0.450638713907688, 'f1-score': 0.4395591531400346, 'support': 341624}, 'accuracy': 0.472451341350667, 'macro avg': {'precision': 0.5016936192861364, 'recall': 0.5058348436956775, 'f1-score': 0.4683446294835289, 'support': 1407201}, 'weighted avg': {'precision': 0.5605043450392022, 'recall': 0.472451341350667, 'f1-score': 0.47629536386194404, 'support': 1407201}}
[[237113  43314  64814]
 [306481 273772 140083]
 [125379  62296 153949]]
Evaluating performance on  train set...
2058/2058 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0057697
{'0': {'precision': 0.3559925986030078, 'recall': 0.6672165047996845, 'f1-score': 0.4642729166200086, 'support': 124279}, '1': {'precision': 0.7050889643806129, 'recall': 0.45419189894809825, 'f1-score': 0.5524902649386246, 'support': 276927}, '2': {'precision': 0.4398878009505753, 'recall': 0.4044882102883345, 'f1-score': 0.4214459600127733, 'support': 125618}, 'accuracy': 0.49259335185944453, 'macro avg': {'precision': 0.5003231213113987, 'recall': 0.5086322046787057, 'f1-score': 0.47940304719046883, 'support': 526824}, 'weighted avg': {'precision': 0.5595007091184581, 'recall': 0.49259335185944453, 'f1-score': 0.5004328656404438, 'support': 526824}}
[[ 82921  21062  20296]
 [106747 125778  44402]
 [ 43261  31546  50811]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0372863
{'0': {'precision': 0.3574754780540969, 'recall': 0.7221616813076838, 'f1-score': 0.4782256520522526, 'support': 44965}, '1': {'precision': 0.6945612338961711, 'recall': 0.36480007557686406, 'f1-score': 0.478356134686704, 'support': 84682}, '2': {'precision': 0.45132743362831856, 'recall': 0.3940472991131416, 'f1-score': 0.4207467986656623, 'support': 44652}, 'accuracy': 0.4644834451144298, 'macro avg': {'precision': 0.5011213818595289, 'recall': 0.4936696853325631, 'f1-score': 0.4591095284682063, 'support': 174299}, 'weighted avg': {'precision': 0.5452893696800883, 'recall': 0.4644834451144298, 'f1-score': 0.4635640864037554, 'support': 174299}}
[[32472  5132  7361]
 [39761 30892 14029]
 [18604  8453 17595]]
testing model on single stock: results/universal/W2/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 203s - 203s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2656139
{'0': {'precision': 0.3916720864349368, 'recall': 0.618551573320777, 'f1-score': 0.47963514406056496, 'support': 1206302}, '1': {'precision': 0.4150203301686074, 'recall': 0.42396916377854793, 'f1-score': 0.4194470219284155, 'support': 1350360}, '2': {'precision': 0.45227168469560813, 'recall': 0.18959302988979737, 'f1-score': 0.267182654183412, 'support': 1253237}, 'accuracy': 0.4084822196073964, 'macro avg': {'precision': 0.4196547004330508, 'recall': 0.41070458899637413, 'f1-score': 0.3887549400574642, 'support': 3809899}, 'weighted avg': {'precision': 0.4198812838791757, 'recall': 0.4084822196073964, 'f1-score': 0.38841777749558704, 'support': 3809899}}
[[746160 327782 132360]
 [622455 572511 155394]
 [536448 479184 237605]]
Evaluating performance on  train set...
6147/6147 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2752211
{'0': {'precision': 0.4129496609585105, 'recall': 0.551430824155481, 'f1-score': 0.4722475732182859, 'support': 521273}, '1': {'precision': 0.3865187988270011, 'recall': 0.48107720956882966, 'f1-score': 0.42864509146232505, 'support': 523575}, '2': {'precision': 0.453243082811351, 'recall': 0.19354680054555395, 'f1-score': 0.2712588765063714, 'support': 528637}, 'accuracy': 0.40778399539874866, 'macro avg': {'precision': 0.41757051419895413, 'recall': 0.4086849447566216, 'f1-score': 0.39071718039566083, 'support': 1573485}, 'weighted avg': {'precision': 0.4176920353742278, 'recall': 0.40778399539874866, 'f1-score': 0.39021359701319114, 'support': 1573485}}
[[287446 171940  61887]
 [210156 251880  61539]
 [198478 227843 102316]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2554753
{'0': {'precision': 0.41393925674990045, 'recall': 0.5812380806243013, 'f1-score': 0.48352640288852117, 'support': 182476}, '1': {'precision': 0.4018765324779016, 'recall': 0.4561683871832685, 'f1-score': 0.42730483093971494, 'support': 186475}, '2': {'precision': 0.4294162124341222, 'recall': 0.20288131888052977, 'f1-score': 0.27556814067003665, 'support': 187553}, 'accuracy': 0.4118155484956083, 'macro avg': {'precision': 0.4150773338873081, 'recall': 0.41342926222936655, 'f1-score': 0.3954664581660909, 'support': 556504}, 'weighted avg': {'precision': 0.4151132877736161, 'recall': 0.4118155484956083, 'f1-score': 0.3946014111849268, 'support': 556504}}
[[106062  51975  24439]
 [ 75290  85064  26121]
 [ 74874  74628  38051]]
training model: results/universal/W2/deepLOB_L2/h30
Epoch 1/50
9940/9940 - 409s - loss: 2.9941 - accuracy30: 0.4787 - val_loss: 3.8652 - val_accuracy30: 0.3949 - 409s/epoch - 41ms/step
Epoch 2/50
9940/9940 - 401s - loss: 2.8943 - accuracy30: 0.5098 - val_loss: 3.7958 - val_accuracy30: 0.4335 - 401s/epoch - 40ms/step
Epoch 3/50
9940/9940 - 402s - loss: 2.8419 - accuracy30: 0.5225 - val_loss: 3.7360 - val_accuracy30: 0.4391 - 402s/epoch - 40ms/step
Epoch 4/50
9940/9940 - 399s - loss: 2.8142 - accuracy30: 0.5288 - val_loss: 3.6423 - val_accuracy30: 0.4523 - 399s/epoch - 40ms/step
Epoch 5/50
9940/9940 - 400s - loss: 2.7969 - accuracy30: 0.5327 - val_loss: 3.6358 - val_accuracy30: 0.4531 - 400s/epoch - 40ms/step
Epoch 6/50
9940/9940 - 401s - loss: 2.7851 - accuracy30: 0.5351 - val_loss: 3.5612 - val_accuracy30: 0.4599 - 401s/epoch - 40ms/step
Epoch 7/50
9940/9940 - 402s - loss: 2.7771 - accuracy30: 0.5371 - val_loss: 3.5801 - val_accuracy30: 0.4654 - 402s/epoch - 40ms/step
Epoch 8/50
9940/9940 - 403s - loss: 2.7705 - accuracy30: 0.5383 - val_loss: 3.5336 - val_accuracy30: 0.4677 - 403s/epoch - 41ms/step
Epoch 9/50
9940/9940 - 400s - loss: 2.7645 - accuracy30: 0.5396 - val_loss: 3.5333 - val_accuracy30: 0.4681 - 400s/epoch - 40ms/step
Epoch 10/50
9940/9940 - 403s - loss: 2.7602 - accuracy30: 0.5406 - val_loss: 3.5180 - val_accuracy30: 0.4730 - 403s/epoch - 41ms/step
Epoch 11/50
9940/9940 - 402s - loss: 2.7565 - accuracy30: 0.5414 - val_loss: 3.5321 - val_accuracy30: 0.4713 - 402s/epoch - 40ms/step
Epoch 12/50
9940/9940 - 402s - loss: 2.7531 - accuracy30: 0.5422 - val_loss: 3.5093 - val_accuracy30: 0.4750 - 402s/epoch - 40ms/step
Epoch 13/50
9940/9940 - 402s - loss: 2.7503 - accuracy30: 0.5426 - val_loss: 3.5383 - val_accuracy30: 0.4738 - 402s/epoch - 40ms/step
Epoch 14/50
9940/9940 - 399s - loss: 2.7473 - accuracy30: 0.5433 - val_loss: 3.4928 - val_accuracy30: 0.4740 - 399s/epoch - 40ms/step
Epoch 15/50
9940/9940 - 404s - loss: 2.7445 - accuracy30: 0.5440 - val_loss: 3.5152 - val_accuracy30: 0.4747 - 404s/epoch - 41ms/step
Epoch 16/50
9940/9940 - 410s - loss: 2.7421 - accuracy30: 0.5444 - val_loss: 3.5139 - val_accuracy30: 0.4746 - 410s/epoch - 41ms/step
Epoch 17/50
9940/9940 - 403s - loss: 2.7401 - accuracy30: 0.5449 - val_loss: 3.5373 - val_accuracy30: 0.4732 - 403s/epoch - 41ms/step
Epoch 18/50
9940/9940 - 399s - loss: 2.7380 - accuracy30: 0.5451 - val_loss: 3.5390 - val_accuracy30: 0.4732 - 399s/epoch - 40ms/step
Epoch 19/50
9940/9940 - 400s - loss: 2.7363 - accuracy30: 0.5455 - val_loss: 3.5657 - val_accuracy30: 0.4718 - 400s/epoch - 40ms/step
Epoch 20/50
9940/9940 - 401s - loss: 2.7342 - accuracy30: 0.5462 - val_loss: 3.5739 - val_accuracy30: 0.4711 - 401s/epoch - 40ms/step
Epoch 21/50
9940/9940 - 404s - loss: 2.7322 - accuracy30: 0.5464 - val_loss: 3.5608 - val_accuracy30: 0.4731 - 404s/epoch - 41ms/step
Epoch 22/50
9940/9940 - 400s - loss: 2.7303 - accuracy30: 0.5469 - val_loss: 3.5478 - val_accuracy30: 0.4735 - 400s/epoch - 40ms/step
Epoch 23/50
9940/9940 - 399s - loss: 2.7289 - accuracy30: 0.5473 - val_loss: 3.5530 - val_accuracy30: 0.4731 - 399s/epoch - 40ms/step
Epoch 24/50
9940/9940 - 399s - loss: 2.7272 - accuracy30: 0.5474 - val_loss: 3.5646 - val_accuracy30: 0.4726 - 399s/epoch - 40ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 353s - 353s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1097417
{'0': {'precision': 0.419388987214053, 'recall': 0.5494829972883432, 'f1-score': 0.4757018912925963, 'support': 1845735}, '1': {'precision': 0.5485440980923965, 'recall': 0.5894320389431229, 'f1-score': 0.5682535084278759, 'support': 2961858}, '2': {'precision': 0.47409178136137026, 'recall': 0.2775045265046185, 'f1-score': 0.3500885087633402, 'support': 1913176}, 'accuracy': 0.48966554273774326, 'macro avg': {'precision': 0.4806749555559399, 'recall': 0.4721398542453616, 'f1-score': 0.4646813028279375, 'support': 6720769}, 'weighted avg': {'precision': 0.49187997318477994, 'recall': 0.48966554273774326, 'f1-score': 0.48073170840002455, 'support': 6720769}}
[[1014200  613784  217751]
 [ 844853 1745814  371191]
 [ 559227  823034  530915]]
Evaluating performance on  train set...
9940/9940 - 137s - 137s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1433986
{'0': {'precision': 0.43608316280838333, 'recall': 0.4668681555597811, 'f1-score': 0.4509508713248561, 'support': 746774}, '1': {'precision': 0.49746734406487486, 'recall': 0.6283834164911184, 'f1-score': 0.5553137950573012, 'support': 1043398}, '2': {'precision': 0.47150285816195314, 'recall': 0.2666792310591783, 'f1-score': 0.3406748050186504, 'support': 753452}, 'accuracy': 0.47382356826323385, 'macro avg': {'precision': 0.46835112167840376, 'recall': 0.45397693437002595, 'f1-score': 0.4489798238002692, 'support': 2543624}, 'weighted avg': {'precision': 0.47175477632445284, 'recall': 0.47382356826323385, 'f1-score': 0.46109558736230605, 'support': 2543624}}
[[348645 300068  98061]
 [260587 655654 127157]
 [190260 362262 200930]]
Evaluating performance on  val set...
3393/3393 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1404845
{'0': {'precision': 0.4335376872540575, 'recall': 0.5041498257976582, 'f1-score': 0.46618504877924755, 'support': 254589}, '1': {'precision': 0.5057148885827882, 'recall': 0.5999488105484022, 'f1-score': 0.5488161474782429, 'support': 355542}, '2': {'precision': 0.4633284300348112, 'recall': 0.2698522228597125, 'f1-score': 0.34106248239199405, 'support': 257956}, 'accuracy': 0.47376357438828137, 'macro avg': {'precision': 0.467527001957219, 'recall': 0.4579836197352576, 'f1-score': 0.4520212262164949, 'support': 868087}, 'weighted avg': {'precision': 0.47195172566215676, 'recall': 0.47376357438828137, 'f1-score': 0.462847490860108, 'support': 868087}}
[[128351  91746  34492]
 [ 96098 213307  46137]
 [ 71606 116740  69610]]
testing model out of sample: results/universal/W2/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 214s - 214s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0385002
{'0': {'precision': 0.44550109622126083, 'recall': 0.5612778564036378, 'f1-score': 0.49673247471176035, 'support': 1083189}, '1': {'precision': 0.5869003004095013, 'recall': 0.5808607184247244, 'f1-score': 0.5838648912598176, 'support': 1489314}, '2': {'precision': 0.5129586489818938, 'recall': 0.38818072982828106, 'f1-score': 0.4419308875313624, 'support': 1094230}, 'accuracy': 0.5175760002159961, 'macro avg': {'precision': 0.5151200152042187, 'recall': 0.5101064348855479, 'f1-score': 0.5075094178343135, 'support': 3666733}, 'weighted avg': {'precision': 0.52306384549798, 'recall': 0.5175760002159961, 'f1-score': 0.5157690358899117, 'support': 3666733}}
[[607970 281982 193237]
 [414169 865084 210061]
 [342549 326922 424759]]
Evaluating performance on  train set...
5373/5373 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9601001
{'0': {'precision': 0.46542526096604026, 'recall': 0.5150832673354453, 'f1-score': 0.4889967954365973, 'support': 363648}, '1': {'precision': 0.6366089821654166, 'recall': 0.6947549668051597, 'f1-score': 0.6644122407162689, 'support': 644076}, '2': {'precision': 0.5165373727930074, 'recall': 0.3791942652954506, 'f1-score': 0.43733636559244493, 'support': 367168}, 'accuracy': 0.5629620362908505, 'macro avg': {'precision': 0.5395238719748214, 'recall': 0.5296774998120185, 'f1-score': 0.530248467248437, 'support': 1374892}, 'weighted avg': {'precision': 0.559266856008046, 'recall': 0.5629620362908505, 'f1-score': 0.5573751274284425, 'support': 1374892}}
[[187309 120843  55496]
 [121784 447475  74817]
 [ 93354 134586 139228]]
Evaluating performance on  val set...
1685/1685 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0070556
{'0': {'precision': 0.43838335860477295, 'recall': 0.6014051443990543, 'f1-score': 0.5071146801916033, 'support': 119703}, '1': {'precision': 0.6312772516455134, 'recall': 0.5941656210790465, 'f1-score': 0.6121594872278255, 'support': 191280}, '2': {'precision': 0.5098935431613053, 'recall': 0.368162487780832, 'f1-score': 0.4275892852810892, 'support': 119689}, 'accuracy': 0.5333687818107515, 'macro avg': {'precision': 0.5265180511371973, 'recall': 0.5212444177529777, 'f1-score': 0.5156211509001727, 'support': 430672}, 'weighted avg': {'precision': 0.5439294037161794, 'recall': 0.5333687818107515, 'f1-score': 0.5316685302177115, 'support': 430672}}
[[ 71990  29705  18008]
 [ 53281 113652  24347]
 [ 38946  36678  44065]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2872124
{'0': {'precision': 0.3303867942957609, 'recall': 0.5144356290081367, 'f1-score': 0.4023632272326252, 'support': 78902}, '1': {'precision': 0.35789710566403543, 'recall': 0.2318890970064716, 'f1-score': 0.2814322758921097, 'support': 89159}, '2': {'precision': 0.3873328602635277, 'recall': 0.32970130516142787, 'f1-score': 0.3562010172419308, 'support': 84434}, 'accuracy': 0.3528901562407176, 'macro avg': {'precision': 0.3585389200744413, 'recall': 0.3586753437253454, 'f1-score': 0.3466655067888886, 'support': 252495}, 'weighted avg': {'precision': 0.3591437042749938, 'recall': 0.3528901562407176, 'f1-score': 0.3442244810042907, 'support': 252495}}
[[40590 17339 20973]
 [45424 20675 23060]
 [36842 19754 27838]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2644132
{'0': {'precision': 0.36258150810901185, 'recall': 0.5449017538569777, 'f1-score': 0.4354268733435065, 'support': 19899}, '1': {'precision': 0.36058424477363976, 'recall': 0.2606194026116976, 'f1-score': 0.30255859204832575, 'support': 19987}, '2': {'precision': 0.38923894242648877, 'recall': 0.30508884907761585, 'f1-score': 0.34206454765071526, 'support': 20653}, 'accuracy': 0.36923305637688103, 'macro avg': {'precision': 0.3708015651030468, 'recall': 0.370203335182097, 'f1-score': 0.3600166710141825, 'support': 60539}, 'weighted avg': {'precision': 0.371016346620959, 'recall': 0.36923305637688103, 'f1-score': 0.359709559698088, 'support': 60539}}
[[10843  4297  4759]
 [ 9650  5209  5128]
 [ 9412  4940  6301]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2619759
{'0': {'precision': 0.36128261302529374, 'recall': 0.5369246707118543, 'f1-score': 0.4319304720519079, 'support': 6757}, '1': {'precision': 0.41518175338560226, 'recall': 0.2976114446289437, 'f1-score': 0.3467003943158991, 'support': 7829}, '2': {'precision': 0.365455768583922, 'recall': 0.3098089535215284, 'f1-score': 0.3353395061728395, 'support': 7014}, 'accuracy': 0.3764351851851852, 'macro avg': {'precision': 0.3806400449982727, 'recall': 0.38144835628744217, 'f1-score': 0.37132345751354884, 'support': 21600}, 'weighted avg': {'precision': 0.38217367242201017, 'recall': 0.3764351851851852, 'f1-score': 0.369673281622695, 'support': 21600}}
[[3628 1492 1637]
 [3363 2330 2136]
 [3051 1790 2173]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9328507
{'0': {'precision': 0.4105934251873338, 'recall': 0.5513822765635144, 'f1-score': 0.4706853553780077, 'support': 73936}, '1': {'precision': 0.7068599150028065, 'recall': 0.6315252173082434, 'f1-score': 0.66707235556004, 'support': 167504}, '2': {'precision': 0.5253924686678575, 'recall': 0.4737882895271022, 'f1-score': 0.49825779173380713, 'support': 76359}, 'accuracy': 0.5749797828186999, 'macro avg': {'precision': 0.5476152696193326, 'recall': 0.55223192779962, 'f1-score': 0.5453385008906183, 'support': 317799}, 'weighted avg': {'precision': 0.5943314554239936, 'recall': 0.5749797828186999, 'f1-score': 0.5808210441189529, 'support': 317799}}
[[ 40767  21425  11744]
 [ 40784 105783  20937]
 [ 17737  22444  36178]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8925415
{'0': {'precision': 0.363055918080514, 'recall': 0.707156824403598, 'f1-score': 0.479787728026534, 'support': 25570}, '1': {'precision': 0.8098868392990721, 'recall': 0.6093766840308964, 'f1-score': 0.6954679641373278, 'support': 83505}, '2': {'precision': 0.5280545829966783, 'recall': 0.4552807771198576, 'f1-score': 0.48897479061454374, 'support': 25839}, 'accuracy': 0.5983960152393376, 'macro avg': {'precision': 0.5669991134587548, 'recall': 0.5906047618514506, 'f1-score': 0.5547434942594686, 'support': 134914}, 'weighted avg': {'precision': 0.6712227249287617, 'recall': 0.5983960152393376, 'f1-score': 0.6150425023764416, 'support': 134914}}
[[18082  4812  2676]
 [24781 50886  7838]
 [ 6942  7133 11764]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9295349
{'0': {'precision': 0.3927946127946128, 'recall': 0.6838218053927315, 'f1-score': 0.4989734816082122, 'support': 8530}, '1': {'precision': 0.7710810956250337, 'recall': 0.5988381812102975, 'f1-score': 0.6741314012843734, 'support': 23928}, '2': {'precision': 0.4941357162803686, 'recall': 0.4349268772274794, 'f1-score': 0.46264461729524803, 'support': 8137}, 'accuracy': 0.5838403744303485, 'macro avg': {'precision': 0.552670474900005, 'recall': 0.5725289546101695, 'f1-score': 0.5452498333959446, 'support': 40595}, 'weighted avg': {'precision': 0.6360820009022592, 'recall': 0.5838403744303485, 'f1-score': 0.5949353176248792, 'support': 40595}}
[[ 5833  1853   844]
 [ 6820 14329  2779]
 [ 2197  2401  3539]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1931881
{'0': {'precision': 0.44065483069587136, 'recall': 0.5113302781356255, 'f1-score': 0.47336907909850295, 'support': 94702}, '1': {'precision': 0.39764946897406866, 'recall': 0.4774851756907222, 'f1-score': 0.43392574551572805, 'support': 77238}, '2': {'precision': 0.4875448817357531, 'recall': 0.3412142012065746, 'f1-score': 0.4014610296232385, 'support': 102273}, 'accuracy': 0.43834902065182907, 'macro avg': {'precision': 0.44194972713523106, 'recall': 0.4433432183443074, 'f1-score': 0.4362519514124898, 'support': 274213}, 'weighted avg': {'precision': 0.4460299881877963, 'recall': 0.43834902065182907, 'f1-score': 0.4354395274607247, 'support': 274213}}
[[48424 25515 20763]
 [24441 36880 15917]
 [37026 30350 34897]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1987766
{'0': {'precision': 0.4520253716817129, 'recall': 0.5435431799838579, 'f1-score': 0.4935778807922751, 'support': 24780}, '1': {'precision': 0.4328748230682684, 'recall': 0.5029730527558723, 'f1-score': 0.4652986384738423, 'support': 23713}, '2': {'precision': 0.4763483360958817, 'recall': 0.3044452593407489, 'f1-score': 0.3714733152700788, 'support': 24543}, 'accuracy': 0.45002464538036036, 'macro avg': {'precision': 0.45374951028195437, 'recall': 0.4503204973601597, 'f1-score': 0.44344994484539874, 'support': 73036}, 'weighted avg': {'precision': 0.4539811408413921, 'recall': 0.45002464538036036, 'f1-score': 0.443364314541272, 'support': 73036}}
[[13469  7118  4193]
 [ 7765 11927  4021]
 [ 8563  8508  7472]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1909797
{'0': {'precision': 0.45031620895780994, 'recall': 0.5270736158994119, 'f1-score': 0.485680915673908, 'support': 9862}, '1': {'precision': 0.44854057702041505, 'recall': 0.5355020646590795, 'f1-score': 0.4881788550704678, 'support': 9929}, '2': {'precision': 0.4775421085464754, 'recall': 0.3056498303054502, 'f1-score': 0.37273280584297025, 'support': 10018}, 'accuracy': 0.4554664698580965, 'macro avg': {'precision': 0.4587996315082335, 'recall': 0.45607517028798056, 'f1-score': 0.44886419219578205, 'support': 29809}, 'weighted avg': {'precision': 0.45887465817022416, 'recall': 0.4554664698580965, 'f1-score': 0.44855413772034053, 'support': 29809}}
[[5198 2909 1755]
 [3017 5317 1595]
 [3328 3628 3062]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2689558
{'0': {'precision': 0.36944257754424553, 'recall': 0.4859037032076609, 'f1-score': 0.4197446591888562, 'support': 74665}, '1': {'precision': 0.3277500164376356, 'recall': 0.29634969233970454, 'f1-score': 0.31125993224995707, 'support': 67282}, '2': {'precision': 0.3938035661511181, 'recall': 0.30751182737797605, 'f1-score': 0.3453489125504849, 'support': 77997}, 'accuracy': 0.3646564580074928, 'macro avg': {'precision': 0.3636653867109998, 'recall': 0.3632550743084471, 'f1-score': 0.3587845013297661, 'support': 219944}, 'weighted avg': {'precision': 0.3653275534108084, 'recall': 0.3646564580074928, 'f1-score': 0.36017624882778215, 'support': 219944}}
[[36280 19900 18485]
 [28907 19939 18436]
 [33015 20997 23985]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.267565
{'0': {'precision': 0.37692056227525333, 'recall': 0.5330369843527738, 'f1-score': 0.44158675445961665, 'support': 28120}, '1': {'precision': 0.34343187157400157, 'recall': 0.2578357523424582, 'f1-score': 0.29454110437173375, 'support': 27215}, '2': {'precision': 0.3575850672624866, 'recall': 0.2915701977454739, 'f1-score': 0.3212209910098265, 'support': 26347}, 'accuracy': 0.363458289464019, 'macro avg': {'precision': 0.35931250037058043, 'recall': 0.3608143114802353, 'f1-score': 0.35244961661372565, 'support': 81682}, 'weighted avg': {'precision': 0.35952594651491526, 'recall': 0.363458289464019, 'f1-score': 0.3537690695749009, 'support': 81682}}
[[14989  6625  6506]
 [12903  7017  7295]
 [11875  6790  7682]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2751338
{'0': {'precision': 0.3849612790407195, 'recall': 0.531013094417643, 'f1-score': 0.4463432295438088, 'support': 8706}, '1': {'precision': 0.34378610331737913, 'recall': 0.25208761950865305, 'f1-score': 0.2908811618489038, 'support': 8263}, '2': {'precision': 0.34484259393587696, 'recall': 0.29742242242242245, 'f1-score': 0.31938192811555255, 'support': 7992}, 'accuracy': 0.36388766475702095, 'macro avg': {'precision': 0.3578633254313252, 'recall': 0.36017437878290615, 'f1-score': 0.352202106502755, 'support': 24961}, 'weighted avg': {'precision': 0.35848561667303136, 'recall': 0.36388766475702095, 'f1-score': 0.3542292202341808, 'support': 24961}}
[[4623 1926 2157]
 [3821 2083 2359]
 [3565 2050 2377]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.18493
{'0': {'precision': 0.4618929253199379, 'recall': 0.47844891960834685, 'f1-score': 0.4700251770906082, 'support': 167393}, '1': {'precision': 0.40926779107396694, 'recall': 0.5524348009498343, 'f1-score': 0.4701947828201958, 'support': 146973}, '2': {'precision': 0.5038936854579312, 'recall': 0.3390998729728344, 'f1-score': 0.405389301072889, 'support': 175553}, 'accuracy': 0.45071124002130963, 'macro avg': {'precision': 0.4583514672839453, 'recall': 0.4566611978436718, 'f1-score': 0.44853642032789764, 'support': 489919}, 'weighted avg': {'precision': 0.46115583528867166, 'recall': 0.45071124002130963, 'f1-score': 0.4469150415791379, 'support': 489919}}
[[80089 55502 31802]
 [38972 81193 26808]
 [54332 61691 59530]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1571062
{'0': {'precision': 0.4723927274848003, 'recall': 0.521478810899551, 'f1-score': 0.4957236187824171, 'support': 62131}, '1': {'precision': 0.4601100936049314, 'recall': 0.6127599195959528, 'f1-score': 0.5255753641981122, 'support': 59201}, '2': {'precision': 0.4988781062433388, 'recall': 0.2880439183171123, 'f1-score': 0.3652173913043478, 'support': 61751}, 'accuracy': 0.47226121485883454, 'macro avg': {'precision': 0.47712697577769014, 'recall': 0.47409421627087206, 'f1-score': 0.4621721247616257, 'support': 183083}, 'weighted avg': {'precision': 0.47735416254647395, 'recall': 0.47226121485883454, 'f1-score': 0.4613586757093645, 'support': 183083}}
[[32400 19433 10298]
 [15356 36276  7569]
 [20831 23133 17787]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2002751
{'0': {'precision': 0.4497671819705718, 'recall': 0.6032174260591526, 'f1-score': 0.5153112396235675, 'support': 20016}, '1': {'precision': 0.3675679019983914, 'recall': 0.4107723155638526, 'f1-score': 0.3879710050284072, 'support': 14463}, '2': {'precision': 0.49811093937832734, 'recall': 0.2875340768277571, 'f1-score': 0.3646019923949593, 'support': 20175}, 'accuracy': 0.43575950525121676, 'macro avg': {'precision': 0.43848200778243024, 'recall': 0.43384127281692075, 'f1-score': 0.4226280790156447, 'support': 54654}, 'weighted avg': {'precision': 0.44586055335169344, 'recall': 0.43575950525121676, 'f1-score': 0.42598052502286166, 'support': 54654}}
[[12074  4521  3421]
 [ 6098  5941  2424]
 [ 8673  5701  5801]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
4918/4918 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8798757
{'0': {'precision': 0.41296285565277857, 'recall': 0.7615002404231447, 'f1-score': 0.5355150194435573, 'support': 243321}, '1': {'precision': 0.8405932801639686, 'recall': 0.5948036940958895, 'f1-score': 0.6966546498839058, 'support': 766737}, '2': {'precision': 0.5091512402191216, 'recall': 0.5476945586680655, 'f1-score': 0.5277200592569642, 'support': 248781}, 'accuracy': 0.6177144178087904, 'macro avg': {'precision': 0.5875691253452896, 'recall': 0.6346661643956999, 'f1-score': 0.5866299095281424, 'support': 1258839}, 'weighted avg': {'precision': 0.6924345842052272, 'recall': 0.6177144178087904, 'f1-score': 0.6321218761065306, 'support': 1258839}}
[[185289  34618  23414]
 [202735 456058 107944]
 [ 60658  51867 136256]]
Evaluating performance on  train set...
1403/1403 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7987282
{'0': {'precision': 0.3969835805313247, 'recall': 0.7390452325880237, 'f1-score': 0.5165165165165165, 'support': 62256}, '1': {'precision': 0.8543580639872456, 'recall': 0.6453345859845412, 'f1-score': 0.735279735505986, 'support': 234170}, '2': {'precision': 0.5243648228150207, 'recall': 0.5549445279278703, 'f1-score': 0.5392214731740657, 'support': 62554}, 'accuracy': 0.6458354225862165, 'macro avg': {'precision': 0.5919021557778636, 'recall': 0.6464414488334783, 'f1-score': 0.597005908398856, 'support': 358980}, 'weighted avg': {'precision': 0.7175351127077337, 'recall': 0.6458354225862165, 'f1-score': 0.6631766893660357, 'support': 358980}}
[[ 46010  10915   5331]
 [ 56895 151118  26157]
 [ 12994  14846  34714]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8475694
{'0': {'precision': 0.4027034228821976, 'recall': 0.7329482827035845, 'f1-score': 0.5198086363778495, 'support': 22681}, '1': {'precision': 0.8427702549624441, 'recall': 0.6243818672450969, 'f1-score': 0.7173222973774772, 'support': 77451}, '2': {'precision': 0.5233007690708792, 'recall': 0.5573610803630729, 'f1-score': 0.5397941680960548, 'support': 22585}, 'accuracy': 0.632112910191742, 'macro avg': {'precision': 0.5895914823051737, 'recall': 0.6382304101039181, 'f1-score': 0.5923083672837938, 'support': 122717}, 'weighted avg': {'precision': 0.7026399212900674, 'recall': 0.632112910191742, 'f1-score': 0.648144594655332, 'support': 122717}}
[[16624  3959  2098]
 [19723 48359  9369]
 [ 4934  5063 12588]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
4856/4856 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9321322
{'0': {'precision': 0.46693239773851786, 'recall': 0.5802437640098377, 'f1-score': 0.5174575623447851, 'support': 348862}, '1': {'precision': 0.6625112990148403, 'recall': 0.6257975379449731, 'f1-score': 0.6436312907122372, 'support': 555146}, '2': {'precision': 0.5328629272777033, 'recall': 0.44812140561881636, 'f1-score': 0.48683200325693743, 'support': 338897}, 'accuracy': 0.5645652724866341, 'macro avg': {'precision': 0.5541022080103538, 'recall': 0.551387569191209, 'f1-score': 0.5493069521046533, 'support': 1242905}, 'weighted avg': {'precision': 0.5722650686966254, 'recall': 0.5645652724866341, 'f1-score': 0.5654627843931985, 'support': 1242905}}
[[202425  82403  64034]
 [138636 347409  69101]
 [ 92460  94570 151867]]
Evaluating performance on  train set...
2076/2076 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80746
{'0': {'precision': 0.4857287095646771, 'recall': 0.4423539397368793, 'f1-score': 0.46302774538656605, 'support': 113104}, '1': {'precision': 0.7188881985866827, 'recall': 0.774871182482137, 'f1-score': 0.7458306278387846, 'support': 303142}, '2': {'precision': 0.5303815772647236, 'recall': 0.468175818832274, 'f1-score': 0.4973411247065552, 'support': 115164}, 'accuracy': 0.6376338420428671, 'macro avg': {'precision': 0.5783328284720278, 'recall': 0.5618003136837634, 'f1-score': 0.568733165977302, 'support': 531410}, 'weighted avg': {'precision': 0.62841107662009, 'recall': 0.6376338420428671, 'f1-score': 0.6317883961239208, 'support': 531410}}
[[ 50032  47310  15762]
 [ 36268 234896  31978]
 [ 16704  44543  53917]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8748293
{'0': {'precision': 0.4097665847665848, 'recall': 0.6274454477050414, 'f1-score': 0.49576397146254464, 'support': 31896}, '1': {'precision': 0.750131981839299, 'recall': 0.6551549243821468, 'f1-score': 0.6994339158257447, 'support': 86752}, '2': {'precision': 0.5341607656991674, 'recall': 0.43361126902912006, 'f1-score': 0.478662575831532, 'support': 31662}, 'accuracy': 0.6026079435832613, 'macro avg': {'precision': 0.5646864441016837, 'recall': 0.5720705470387694, 'f1-score': 0.5579534877066071, 'support': 150310}, 'weighted avg': {'precision': 0.6324127658825419, 'recall': 0.6026079435832613, 'f1-score': 0.6097105526941807, 'support': 150310}}
[[20013  8402  3481]
 [21424 56836  8492]
 [ 7403 10530 13729]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
4353/4353 - 58s - 58s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88009083
{'0': {'precision': 0.5125660265499051, 'recall': 0.5167405369789623, 'f1-score': 0.5146448165812026, 'support': 277739}, '1': {'precision': 0.6618371433133928, 'recall': 0.7757105887349595, 'f1-score': 0.7142636987152613, 'support': 555666}, '2': {'precision': 0.5548780154632134, 'recall': 0.36154199435352086, 'f1-score': 0.4378160716364373, 'support': 280883}, 'accuracy': 0.6067605502347687, 'macro avg': {'precision': 0.5764270617755037, 'recall': 0.5513310400224808, 'f1-score': 0.5555748623109671, 'support': 1114288}, 'weighted avg': {'precision': 0.5976693416259329, 'recall': 0.6067605502347687, 'f1-score': 0.5948229549023399, 'support': 1114288}}
[[143519  96678  37542]
 [ 80708 431036  43922]
 [ 55774 123558 101551]]
Evaluating performance on  train set...
1542/1542 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9521163
{'0': {'precision': 0.507861347019409, 'recall': 0.4592188133033774, 'f1-score': 0.4823167606355715, 'support': 108604}, '1': {'precision': 0.6013743819921368, 'recall': 0.7935925626965792, 'f1-score': 0.684240209077797, 'support': 179635}, '2': {'precision': 0.5706047985971775, 'recall': 0.3182912606749182, 'f1-score': 0.40863837520300905, 'support': 106324}, 'accuracy': 0.5734749583716668, 'macro avg': {'precision': 0.5599468425362412, 'recall': 0.523700878891625, 'f1-score': 0.5250651149721258, 'support': 394563}, 'weighted avg': {'precision': 0.5673432264223957, 'recall': 0.5734749583716668, 'f1-score': 0.554393306100269, 'support': 394563}}
[[ 49873  44723  14008]
 [ 25619 142557  11459]
 [ 22710  49772  33842]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9555906
{'0': {'precision': 0.4789707382994567, 'recall': 0.5244609530712085, 'f1-score': 0.5006847044239114, 'support': 33114}, '1': {'precision': 0.6287602448070084, 'recall': 0.7171805093745104, 'f1-score': 0.6700660355876517, 'support': 57443}, '2': {'precision': 0.5492336274965165, 'recall': 0.3610356303239398, 'f1-score': 0.4356796787207782, 'support': 32753}, 'accuracy': 0.5708296164139162, 'macro avg': {'precision': 0.5523215368676606, 'recall': 0.5342256975898864, 'f1-score': 0.5354768062441138, 'support': 123310}, 'weighted avg': {'precision': 0.5674118949954634, 'recall': 0.5708296164139162, 'f1-score': 0.562323356594733, 'support': 123310}}
[[17367 11232  4515]
 [11056 41197  5190]
 [ 7836 13092 11825]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0061836
{'0': {'precision': 0.44975035011873593, 'recall': 0.6009203467825999, 'f1-score': 0.5144602150912103, 'support': 393330}, '1': {'precision': 0.6305779942089148, 'recall': 0.6107413361512118, 'f1-score': 0.6205011672846088, 'support': 620798}, '2': {'precision': 0.5362202028559608, 'recall': 0.38250910136285116, 'f1-score': 0.44650607526107355, 'support': 393073}, 'accuracy': 0.5442442124472623, 'macro avg': {'precision': 0.5388495157278705, 'recall': 0.5313902614322209, 'f1-score': 0.5271558192122976, 'support': 1407201}, 'weighted avg': {'precision': 0.5536775106458206, 'recall': 0.5442442124472623, 'f1-score': 0.5422594231889207, 'support': 1407201}}
[[236360 101546  55424]
 [167033 379147  74618]
 [122143 120576 150354]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9774772
{'0': {'precision': 0.4702066580098176, 'recall': 0.5618016614023126, 'f1-score': 0.5119394421603528, 'support': 143734}, '1': {'precision': 0.6244203957966692, 'recall': 0.6692727478963001, 'f1-score': 0.6460690561354844, 'support': 238033}, '2': {'precision': 0.5369447779111645, 'recall': 0.37001316723770655, 'f1-score': 0.4381165388524062, 'support': 145057}, 'accuracy': 0.5575524273761256, 'macro avg': {'precision': 0.5438572772392171, 'recall': 0.5336958588454398, 'f1-score': 0.5320416790494145, 'support': 526824}, 'weighted avg': {'precision': 0.5582603345795017, 'recall': 0.5575524273761256, 'f1-score': 0.5522161674390069, 'support': 526824}}
[[ 80750  42540  20444]
 [ 52881 159309  25843]
 [ 38102  53282  53673]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9968499
{'0': {'precision': 0.4660344724756963, 'recall': 0.6108027827718283, 'f1-score': 0.5286874154262515, 'support': 51172}, '1': {'precision': 0.6140582612524322, 'recall': 0.5979227460688453, 'f1-score': 0.6058830948610507, 'support': 72307}, '2': {'precision': 0.5253367369107104, 'recall': 0.3806572215663125, 'f1-score': 0.4414449363333485, 'support': 50820}, 'accuracy': 0.5383565023321992, 'macro avg': {'precision': 0.535143156879613, 'recall': 0.5297942501356621, 'f1-score': 0.5253384822068836, 'support': 174299}, 'weighted avg': {'precision': 0.5447319817767644, 'recall': 0.5383565023321992, 'f1-score': 0.5352745169322309, 'support': 174299}}
[[31256 12218  7698]
 [19292 43234  9781]
 [16520 14955 19345]]
testing model on single stock: results/universal/W2/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 204s - 204s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2585304
{'0': {'precision': 0.4076982834835986, 'recall': 0.5171885442582694, 'f1-score': 0.45596255759483445, 'support': 1176074}, '1': {'precision': 0.41240250035270465, 'recall': 0.5223358670263244, 'f1-score': 0.4609046233751223, 'support': 1404669}, '2': {'precision': 0.43154880649058314, 'recall': 0.18919486216558354, 'f1-score': 0.2630612959402815, 'support': 1229156}, 'accuracy': 0.41326843572493654, 'macro avg': {'precision': 0.41721653010896215, 'recall': 0.4095730911500591, 'f1-score': 0.3933094923034128, 'support': 3809899}, 'weighted avg': {'precision': 0.4171273736149862, 'recall': 0.41326843572493654, 'f1-score': 0.3955505160754313, 'support': 3809899}}
[[608252 441193 126629]
 [491266 733709 179694]
 [392399 604207 232550]]
Evaluating performance on  train set...
6147/6147 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2850811
{'0': {'precision': 0.4433513042355372, 'recall': 0.4207619718741383, 'f1-score': 0.4317613770337185, 'support': 522224}, '1': {'precision': 0.37056487626920176, 'recall': 0.5861164485336489, 'f1-score': 0.4540575081780219, 'support': 518873}, '2': {'precision': 0.43901063862879897, 'recall': 0.21206901733322314, 'f1-score': 0.2859882162813907, 'support': 532388}, 'accuracy': 0.40467815072911406, 'macro avg': {'precision': 0.4176422730445126, 'recall': 0.4063158125803368, 'f1-score': 0.390602367164377, 'support': 1573485}, 'weighted avg': {'precision': 0.4178805622079891, 'recall': 0.40467815072911406, 'f1-score': 0.3897914688036609, 'support': 1573485}}
[[219732 232624  69868]
 [140348 304120  74405]
 [135536 283949 112903]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2546151
{'0': {'precision': 0.4386675928198754, 'recall': 0.46262351424889014, 'f1-score': 0.45032718460396054, 'support': 181558}, '1': {'precision': 0.39156270949313593, 'recall': 0.5702786311996901, 'f1-score': 0.4643174223261018, 'support': 188457}, '2': {'precision': 0.4347441999138683, 'recall': 0.2111116473357678, 'f1-score': 0.28421067829401403, 'support': 186489}, 'accuracy': 0.4147966591435102, 'macro avg': {'precision': 0.4216581674089599, 'recall': 0.41467126426144935, 'f1-score': 0.3996184284080255, 'support': 556504}, 'weighted avg': {'precision': 0.4214010239960112, 'recall': 0.4147966591435102, 'f1-score': 0.3993979138083615, 'support': 556504}}
[[ 83993  72691  24874]
 [ 54669 107473  26315]
 [ 52811  94308  39370]]
training model: results/universal/W2/deepOF_L2/h10
Epoch 1/50
9940/9940 - 219s - loss: 2.7231 - accuracy10: 0.5527 - val_loss: 3.6091 - val_accuracy10: 0.5549 - 219s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 215s - loss: 2.6384 - accuracy10: 0.5719 - val_loss: 3.6780 - val_accuracy10: 0.5594 - 215s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 215s - loss: 2.6122 - accuracy10: 0.5766 - val_loss: 3.6922 - val_accuracy10: 0.5626 - 215s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 214s - loss: 2.5969 - accuracy10: 0.5792 - val_loss: 3.6748 - val_accuracy10: 0.5627 - 214s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 217s - loss: 2.5862 - accuracy10: 0.5810 - val_loss: 3.7041 - val_accuracy10: 0.5625 - 217s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 216s - loss: 2.5774 - accuracy10: 0.5828 - val_loss: 3.6930 - val_accuracy10: 0.5641 - 216s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 216s - loss: 2.5708 - accuracy10: 0.5839 - val_loss: 3.6556 - val_accuracy10: 0.5644 - 216s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 216s - loss: 2.5644 - accuracy10: 0.5850 - val_loss: 3.6829 - val_accuracy10: 0.5653 - 216s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 215s - loss: 2.5597 - accuracy10: 0.5862 - val_loss: 3.6290 - val_accuracy10: 0.5668 - 215s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 217s - loss: 2.5549 - accuracy10: 0.5866 - val_loss: 3.6037 - val_accuracy10: 0.5667 - 217s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 216s - loss: 2.5503 - accuracy10: 0.5875 - val_loss: 3.5592 - val_accuracy10: 0.5679 - 216s/epoch - 22ms/step
Epoch 12/50
9940/9940 - 214s - loss: 2.5466 - accuracy10: 0.5881 - val_loss: 3.5339 - val_accuracy10: 0.5692 - 214s/epoch - 22ms/step
Epoch 13/50
9940/9940 - 215s - loss: 2.5433 - accuracy10: 0.5885 - val_loss: 3.5537 - val_accuracy10: 0.5681 - 215s/epoch - 22ms/step
Epoch 14/50
9940/9940 - 217s - loss: 2.5398 - accuracy10: 0.5891 - val_loss: 3.5214 - val_accuracy10: 0.5690 - 217s/epoch - 22ms/step
Epoch 15/50
9940/9940 - 215s - loss: 2.5370 - accuracy10: 0.5897 - val_loss: 3.4978 - val_accuracy10: 0.5700 - 215s/epoch - 22ms/step
Epoch 16/50
9940/9940 - 214s - loss: 2.5340 - accuracy10: 0.5900 - val_loss: 3.5039 - val_accuracy10: 0.5707 - 214s/epoch - 22ms/step
Epoch 17/50
9940/9940 - 224s - loss: 2.5312 - accuracy10: 0.5904 - val_loss: 3.4502 - val_accuracy10: 0.5699 - 224s/epoch - 23ms/step
Epoch 18/50
9940/9940 - 216s - loss: 2.5291 - accuracy10: 0.5906 - val_loss: 3.4734 - val_accuracy10: 0.5711 - 216s/epoch - 22ms/step
Epoch 19/50
9940/9940 - 223s - loss: 2.5271 - accuracy10: 0.5911 - val_loss: 3.4657 - val_accuracy10: 0.5708 - 223s/epoch - 22ms/step
Epoch 20/50
9940/9940 - 225s - loss: 2.5249 - accuracy10: 0.5915 - val_loss: 3.4909 - val_accuracy10: 0.5717 - 225s/epoch - 23ms/step
Epoch 21/50
9940/9940 - 222s - loss: 2.5230 - accuracy10: 0.5920 - val_loss: 3.4805 - val_accuracy10: 0.5721 - 222s/epoch - 22ms/step
Epoch 22/50
9940/9940 - 216s - loss: 2.5206 - accuracy10: 0.5923 - val_loss: 3.4360 - val_accuracy10: 0.5714 - 216s/epoch - 22ms/step
Epoch 23/50
9940/9940 - 217s - loss: 2.5191 - accuracy10: 0.5925 - val_loss: 3.4367 - val_accuracy10: 0.5719 - 217s/epoch - 22ms/step
Epoch 24/50
9940/9940 - 215s - loss: 2.5173 - accuracy10: 0.5926 - val_loss: 3.4670 - val_accuracy10: 0.5713 - 215s/epoch - 22ms/step
Epoch 25/50
9940/9940 - 216s - loss: 2.5155 - accuracy10: 0.5930 - val_loss: 3.4244 - val_accuracy10: 0.5723 - 216s/epoch - 22ms/step
Epoch 26/50
9940/9940 - 216s - loss: 2.5139 - accuracy10: 0.5935 - val_loss: 3.4091 - val_accuracy10: 0.5726 - 216s/epoch - 22ms/step
Epoch 27/50
9940/9940 - 215s - loss: 2.5126 - accuracy10: 0.5937 - val_loss: 3.4449 - val_accuracy10: 0.5729 - 215s/epoch - 22ms/step
Epoch 28/50
9940/9940 - 216s - loss: 2.5106 - accuracy10: 0.5940 - val_loss: 3.4027 - val_accuracy10: 0.5728 - 216s/epoch - 22ms/step
Epoch 29/50
9940/9940 - 214s - loss: 2.5092 - accuracy10: 0.5943 - val_loss: 3.4161 - val_accuracy10: 0.5725 - 214s/epoch - 22ms/step
Epoch 30/50
9940/9940 - 216s - loss: 2.5081 - accuracy10: 0.5944 - val_loss: 3.3769 - val_accuracy10: 0.5736 - 216s/epoch - 22ms/step
Epoch 31/50
9940/9940 - 216s - loss: 2.5063 - accuracy10: 0.5948 - val_loss: 3.3692 - val_accuracy10: 0.5727 - 216s/epoch - 22ms/step
Epoch 32/50
9940/9940 - 219s - loss: 2.5048 - accuracy10: 0.5951 - val_loss: 3.3889 - val_accuracy10: 0.5731 - 219s/epoch - 22ms/step
Epoch 33/50
9940/9940 - 224s - loss: 2.5039 - accuracy10: 0.5952 - val_loss: 3.3653 - val_accuracy10: 0.5741 - 224s/epoch - 23ms/step
Epoch 34/50
9940/9940 - 219s - loss: 2.5026 - accuracy10: 0.5953 - val_loss: 3.3632 - val_accuracy10: 0.5734 - 219s/epoch - 22ms/step
Epoch 35/50
9940/9940 - 214s - loss: 2.5008 - accuracy10: 0.5958 - val_loss: 3.3437 - val_accuracy10: 0.5738 - 214s/epoch - 22ms/step
Epoch 36/50
9940/9940 - 215s - loss: 2.5001 - accuracy10: 0.5959 - val_loss: 3.3493 - val_accuracy10: 0.5750 - 215s/epoch - 22ms/step
Epoch 37/50
9940/9940 - 215s - loss: 2.4988 - accuracy10: 0.5960 - val_loss: 3.3696 - val_accuracy10: 0.5745 - 215s/epoch - 22ms/step
Epoch 38/50
9940/9940 - 215s - loss: 2.4976 - accuracy10: 0.5963 - val_loss: 3.3563 - val_accuracy10: 0.5753 - 215s/epoch - 22ms/step
Epoch 39/50
9940/9940 - 214s - loss: 2.4970 - accuracy10: 0.5963 - val_loss: 3.3150 - val_accuracy10: 0.5751 - 214s/epoch - 22ms/step
Epoch 40/50
9940/9940 - 214s - loss: 2.4956 - accuracy10: 0.5966 - val_loss: 3.3821 - val_accuracy10: 0.5746 - 214s/epoch - 22ms/step
Epoch 41/50
9940/9940 - 216s - loss: 2.4947 - accuracy10: 0.5968 - val_loss: 3.3291 - val_accuracy10: 0.5757 - 216s/epoch - 22ms/step
Epoch 42/50
9940/9940 - 215s - loss: 2.4933 - accuracy10: 0.5970 - val_loss: 3.3558 - val_accuracy10: 0.5752 - 215s/epoch - 22ms/step
Epoch 43/50
9940/9940 - 215s - loss: 2.4923 - accuracy10: 0.5971 - val_loss: 3.3591 - val_accuracy10: 0.5752 - 215s/epoch - 22ms/step
Epoch 44/50
9940/9940 - 215s - loss: 2.4912 - accuracy10: 0.5972 - val_loss: 3.3539 - val_accuracy10: 0.5749 - 215s/epoch - 22ms/step
Epoch 45/50
9940/9940 - 215s - loss: 2.4908 - accuracy10: 0.5973 - val_loss: 3.3277 - val_accuracy10: 0.5758 - 215s/epoch - 22ms/step
Epoch 46/50
9940/9940 - 215s - loss: 2.4894 - accuracy10: 0.5977 - val_loss: 3.3260 - val_accuracy10: 0.5761 - 215s/epoch - 22ms/step
Epoch 47/50
9940/9940 - 216s - loss: 2.4882 - accuracy10: 0.5978 - val_loss: 3.3300 - val_accuracy10: 0.5758 - 216s/epoch - 22ms/step
Epoch 48/50
9940/9940 - 217s - loss: 2.4875 - accuracy10: 0.5981 - val_loss: 3.3316 - val_accuracy10: 0.5755 - 217s/epoch - 22ms/step
Epoch 49/50
9940/9940 - 216s - loss: 2.4865 - accuracy10: 0.5982 - val_loss: 3.2849 - val_accuracy10: 0.5771 - 216s/epoch - 22ms/step
Epoch 50/50
9940/9940 - 215s - loss: 2.4859 - accuracy10: 0.5982 - val_loss: 3.3009 - val_accuracy10: 0.5761 - 215s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 212s - 212s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94985676
{'0': {'precision': 0.47867590334823246, 'recall': 0.38940096525729684, 'f1-score': 0.42944781862149245, 'support': 1585484}, '1': {'precision': 0.6857093576892376, 'recall': 0.7303070589903913, 'f1-score': 0.7073059018771497, 'support': 3511182}, '2': {'precision': 0.4447450476347009, 'recall': 0.4631846499983375, 'f1-score': 0.4537775992220762, 'support': 1624078}, 'accuracy': 0.5853337071014757, 'macro avg': {'precision': 0.5363767695573903, 'recall': 0.5276308914153418, 'f1-score': 0.5301771065735729, 'support': 6720744}, 'weighted avg': {'precision': 0.578638910716827, 'recall': 0.5853337071014757, 'f1-score': 0.5804911795797435, 'support': 6720744}}
[[ 617389  566543  401552]
 [ 409327 2564241  537614]
 [ 263069  608761  752248]]
Evaluating performance on  train set...
9940/9940 - 78s - 78s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9994655
{'0': {'precision': 0.4828256915248064, 'recall': 0.37719525883496907, 'f1-score': 0.4235235469803046, 'support': 639674}, '1': {'precision': 0.6526708839879486, 'recall': 0.7341385631777426, 'f1-score': 0.6910118271520723, 'support': 1261172}, '2': {'precision': 0.44521954402395025, 'recall': 0.4331140231465852, 'f1-score': 0.4390833621829727, 'support': 642773}, 'accuracy': 0.5683048443969007, 'macro avg': {'precision': 0.5269053731789017, 'recall': 0.5148159483864324, 'f1-score': 0.5178729121051165, 'support': 2543619}, 'weighted avg': {'precision': 0.5575349089121424, 'recall': 0.5683048443969007, 'f1-score': 0.5600810103339173, 'support': 2543619}}
[[241282 239458 158934]
 [147329 925875 187968]
 [111118 253261 278394]]
Evaluating performance on  val set...
3393/3393 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9752944
{'0': {'precision': 0.4895747291907583, 'recall': 0.37942970543316235, 'f1-score': 0.4275218580783439, 'support': 218694}, '1': {'precision': 0.6690953081686383, 'recall': 0.7429785817438437, 'f1-score': 0.7041040651851523, 'support': 426552}, '2': {'precision': 0.45034187198250186, 'recall': 0.45458788262272426, 'f1-score': 0.45245491597342413, 'support': 222837}, 'accuracy': 0.5773606901644197, 'macro avg': {'precision': 0.5363373031139661, 'recall': 0.5256653899332434, 'f1-score': 0.5280269464123067, 'support': 868083}, 'weighted avg': {'precision': 0.5677151026371412, 'recall': 0.5773606901644197, 'f1-score': 0.5698270310030404, 'support': 868083}}
[[ 82979  75225  60490]
 [ 46484 316919  63149]
 [ 40029  81509 101299]]
testing model out of sample: results/universal/W2/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 118s - 118s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91136616
{'0': {'precision': 0.4887075879041419, 'recall': 0.3967821826708004, 'f1-score': 0.4379733563505376, 'support': 833795}, '1': {'precision': 0.7098777560417219, 'recall': 0.7854840170063391, 'f1-score': 0.7457695407881427, 'support': 2010074}, '2': {'precision': 0.47948771535678364, 'recall': 0.4461273712111361, 'f1-score': 0.46220636868251586, 'support': 822839}, 'accuracy': 0.6209403639449883, 'macro avg': {'precision': 0.5593576864342158, 'recall': 0.5427978569627586, 'f1-score': 0.548649755273732, 'support': 3666708}, 'weighted avg': {'precision': 0.6078831355185094, 'recall': 0.6209403639449883, 'f1-score': 0.6121440225916093, 'support': 3666708}}
[[ 330835  330372  172588]
 [ 205282 1578881  225911]
 [ 140842  314906  367091]]
Evaluating performance on  train set...
5373/5373 - 46s - 46s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79331124
{'0': {'precision': 0.5179209494876356, 'recall': 0.3774304188063274, 'f1-score': 0.4366534252271541, 'support': 261529}, '1': {'precision': 0.7560365943540319, 'recall': 0.8530309267649394, 'f1-score': 0.8016103591495513, 'support': 847777}, '2': {'precision': 0.4768484369511767, 'recall': 0.40893961187128647, 'f1-score': 0.4402909138082709, 'support': 265582}, 'accuracy': 0.6767794904021273, 'macro avg': {'precision': 0.5836019935976148, 'recall': 0.5464669858141844, 'f1-score': 0.5595182327283253, 'support': 1374888}, 'weighted avg': {'precision': 0.6568128788909333, 'recall': 0.6767794904021273, 'f1-score': 0.662394100876573, 'support': 1374888}}
[[ 98709 112450  50370]
 [ 55814 723180  68783]
 [ 36064 120911 108607]]
Evaluating performance on  val set...
1685/1685 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8291794
{'0': {'precision': 0.5048104131295982, 'recall': 0.3814153416827015, 'f1-score': 0.4345223215716437, 'support': 88869}, '1': {'precision': 0.7400657671255424, 'recall': 0.8341905713033833, 'f1-score': 0.7843143076643299, 'support': 253333}, '2': {'precision': 0.4813518019751186, 'recall': 0.42423728621972034, 'f1-score': 0.45099346900028237, 'support': 88467}, 'accuracy': 0.6565483004349048, 'macro avg': {'precision': 0.5754093274100864, 'recall': 0.5466143997352684, 'f1-score': 0.5566100327454186, 'support': 430669}, 'weighted avg': {'precision': 0.6383761716143075, 'recall': 0.6565483004349048, 'f1-score': 0.6436643917285109, 'support': 430669}}
[[ 33896  36844  18129]
 [ 19695 211328  22310]
 [ 13555  37381  37531]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
987/987 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3042164
{'0': {'precision': 0.364118044414422, 'recall': 0.4928426526472185, 'f1-score': 0.4188124461278848, 'support': 69998}, '1': {'precision': 0.6047847791278139, 'recall': 0.17028969492304563, 'f1-score': 0.2657515348003035, 'support': 113119}, '2': {'precision': 0.32154573255490687, 'recall': 0.5835267323021925, 'f1-score': 0.4146199069996108, 'support': 69373}, 'accuracy': 0.373250425759436, 'macro avg': {'precision': 0.4301495186990476, 'recall': 0.4155530266241523, 'f1-score': 0.36639462930926636, 'support': 252490}, 'weighted avg': {'precision': 0.46024308450873885, 'recall': 0.373250425759436, 'f1-score': 0.3490871253412777, 'support': 252490}}
[[34498  5689 29811]
 [38253 19263 55603]
 [21993  6899 40481]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3151563
{'0': {'precision': 0.35779372631239414, 'recall': 0.5123260781710063, 'f1-score': 0.4213375115732498, 'support': 17321}, '1': {'precision': 0.5363072279054167, 'recall': 0.12395829295709136, 'f1-score': 0.2013727095271079, 'support': 25799}, '2': {'precision': 0.34467470526987537, 'recall': 0.5891606384200253, 'f1-score': 0.4349134368841516, 'support': 17418}, 'accuracy': 0.3689253031153986, 'macro avg': {'precision': 0.41292521982922875, 'recall': 0.4084816698493743, 'f1-score': 0.3525412193281698, 'support': 60538}, 'weighted avg': {'precision': 0.4300948052889015, 'recall': 0.3689253031153986, 'f1-score': 0.3315029207224928, 'support': 60538}}
[[ 8874  1363  7084]
 [10174  3198 12427]
 [ 5754  1402 10262]]
Evaluating performance on  val set...
85/85 - 1s - 845ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3042935
{'0': {'precision': 0.33639559941023023, 'recall': 0.5154675008689608, 'f1-score': 0.4071100130395992, 'support': 5754}, '1': {'precision': 0.6247457627118644, 'recall': 0.18446601941747573, 'f1-score': 0.2848311567885016, 'support': 9991}, '2': {'precision': 0.3412004069175992, 'recall': 0.5731373889268626, 'f1-score': 0.4277515623007269, 'support': 5852}, 'accuracy': 0.3779691623836644, 'macro avg': {'precision': 0.4341139230132313, 'recall': 0.4243569697377663, 'f1-score': 0.37323091070960923, 'support': 21597}, 'weighted avg': {'precision': 0.4710913541483767, 'recall': 0.3779691623836644, 'f1-score': 0.35613563203628407, 'support': 21597}}
[[2966  548 2240]
 [3912 1843 4236]
 [1939  559 3354]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70146084
{'0': {'precision': 0.4930807885581755, 'recall': 0.3805640638052428, 'f1-score': 0.42957691141968724, 'support': 50278}, '1': {'precision': 0.8155645463801511, 'recall': 0.8402274578002291, 'f1-score': 0.8277123258802015, 'support': 217359}, '2': {'precision': 0.46495450169824, 'recall': 0.5103774149171602, 'f1-score': 0.48660824605090575, 'support': 50157}, 'accuracy': 0.71544459618495, 'macro avg': {'precision': 0.5911999455455222, 'recall': 0.5770563121742107, 'f1-score': 0.5812991611169315, 'support': 317794}, 'weighted avg': {'precision': 0.7092082703432093, 'recall': 0.71544459618495, 'f1-score': 0.7108875598360228, 'support': 317794}}
[[ 19134  22415   8729]
 [ 13999 182631  20729]
 [  5672  18886  25599]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54027236
{'0': {'precision': 0.526023757424195, 'recall': 0.41747813682317186, 'f1-score': 0.4655071060548428, 'support': 16123}, '1': {'precision': 0.8696756710983149, 'recall': 0.9004646994067045, 'f1-score': 0.8848024199724307, 'support': 102647}, '2': {'precision': 0.4785299318009598, 'recall': 0.46942947407545066, 'f1-score': 0.4739360205134619, 'support': 16143}, 'accuracy': 0.7911691238057118, 'macro avg': {'precision': 0.6247431201078233, 'recall': 0.5957907701017757, 'f1-score': 0.6080818488469119, 'support': 134913}, 'weighted avg': {'precision': 0.7818044839358841, 'recall': 0.7911691238057118, 'f1-score': 0.7855316704319164, 'support': 134913}}
[[ 6731  6968  2424]
 [ 4383 92430  5834]
 [ 1682  6883  7578]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6053577
{'0': {'precision': 0.5094296228150874, 'recall': 0.408069270449521, 'f1-score': 0.45315057283142396, 'support': 5428}, '1': {'precision': 0.8469514328424669, 'recall': 0.8879589182700324, 'f1-score': 0.8669705355689403, 'support': 29989}, '2': {'precision': 0.4711758584807492, 'recall': 0.43731891056596484, 'f1-score': 0.4536165097174915, 'support': 5177}, 'accuracy': 0.7663201458343598, 'macro avg': {'precision': 0.6091856380461013, 'recall': 0.5777823664285061, 'f1-score': 0.591245872705952, 'support': 40594}, 'weighted avg': {'precision': 0.7538968303568969, 'recall': 0.7663201458343598, 'f1-score': 0.7589213522026254, 'support': 40594}}
[[ 2215  2465   748]
 [ 1567 26629  1793]
 [  566  2347  2264]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2445617
{'0': {'precision': 0.5002410634341208, 'recall': 0.393219494764653, 'f1-score': 0.4403205858816111, 'support': 92353}, '1': {'precision': 0.4656836484670712, 'recall': 0.625387727181592, 'f1-score': 0.5338474548969072, 'support': 84789}, '2': {'precision': 0.49409659699587444, 'recall': 0.4466548533987184, 'f1-score': 0.4691794905092743, 'support': 97066}, 'accuracy': 0.4839246119733925, 'macro avg': {'precision': 0.4866737696323555, 'recall': 0.4884206917816545, 'f1-score': 0.48111584376259753, 'support': 274208}, 'weighted avg': {'precision': 0.4873803612046599, 'recall': 0.4839246119733925, 'f1-score': 0.4794560893444083, 'support': 274208}}
[[36315 28612 27426]
 [14798 53026 16965]
 [21482 32229 43355]]
Evaluating performance on  train set...
286/286 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2051729
{'0': {'precision': 0.5145766884897319, 'recall': 0.3987684835870084, 'f1-score': 0.449330597087853, 'support': 23061}, '1': {'precision': 0.5225062517365935, 'recall': 0.6880968934099309, 'f1-score': 0.5939765315308201, 'support': 27329}, '2': {'precision': 0.47579803880659294, 'recall': 0.4028618115974032, 'f1-score': 0.4363027621666866, 'support': 22643}, 'accuracy': 0.5083044651048156, 'macro avg': {'precision': 0.5042936596776395, 'recall': 0.49657572953144746, 'f1-score': 0.4932032969284532, 'support': 73033}, 'weighted avg': {'precision': 0.5055210844367445, 'recall': 0.5083044651048156, 'f1-score': 0.49941808461091625, 'support': 73033}}
[[ 9196  8238  5627]
 [ 4101 18805  4423]
 [ 4574  8947  9122]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2131716
{'0': {'precision': 0.4983993015133877, 'recall': 0.37155565198524626, 'f1-score': 0.4257302672467371, 'support': 9218}, '1': {'precision': 0.5233214089157953, 'recall': 0.6657040343047169, 'f1-score': 0.5859877518006393, 'support': 11427}, '2': {'precision': 0.45935007737174144, 'recall': 0.42110432125709296, 'f1-score': 0.43939652718474237, 'support': 9164}, 'accuracy': 0.4995471166426247, 'macro avg': {'precision': 0.4936902626003081, 'recall': 0.4861213358490188, 'f1-score': 0.48370484874403963, 'support': 29809}, 'weighted avg': {'precision': 0.4959482911223401, 'recall': 0.4995471166426247, 'f1-score': 0.49136480319458237, 'support': 29809}}
[[3425 3388 2405]
 [1683 7607 2137]
 [1764 3541 3859]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
860/860 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3424267
{'0': {'precision': 0.3919009041512239, 'recall': 0.45913439985654453, 'f1-score': 0.4228618615076088, 'support': 78073}, '1': {'precision': 0.3652809853733641, 'recall': 0.014516696495495082, 'f1-score': 0.02792367333127363, 'support': 65373}, '2': {'precision': 0.3674944786055897, 'recall': 0.6047350737976024, 'f1-score': 0.4571694001492338, 'support': 76493}, 'accuracy': 0.37761833963053393, 'macro avg': {'precision': 0.3748921227100593, 'recall': 0.35946205671654735, 'f1-score': 0.30265164499603875, 'support': 219939}, 'weighted avg': {'precision': 0.3755002446068629, 'recall': 0.37761833963053393, 'f1-score': 0.3174053139087849, 'support': 219939}}
[[35846   873 41354]
 [26162   949 38262]
 [29459   776 46258]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3659517
{'0': {'precision': 0.3799629641254198, 'recall': 0.4332545988118245, 'f1-score': 0.404862632309416, 'support': 27942}, '1': {'precision': 0.4219096965210955, 'recall': 0.021134593993325918, 'f1-score': 0.04025281593164084, 'support': 26970}, '2': {'precision': 0.3457467659741278, 'recall': 0.6260226381261907, 'f1-score': 0.4454663866663122, 'support': 26769}, 'accuracy': 0.3603530808878442, 'macro avg': {'precision': 0.38253980887354766, 'recall': 0.3601372769771137, 'f1-score': 0.2968606116357897, 'support': 81681}, 'weighted avg': {'precision': 0.3825996845916168, 'recall': 0.3603530808878442, 'f1-score': 0.29778014253420704, 'support': 81681}}
[[12106   364 15472]
 [10161   570 16239]
 [ 9594   417 16758]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3870654
{'0': {'precision': 0.38871255703233487, 'recall': 0.43748604599240903, 'f1-score': 0.41165966386554625, 'support': 8958}, '1': {'precision': 0.3505535055350554, 'recall': 0.011589605953397584, 'f1-score': 0.022437411431270666, 'support': 8197}, '2': {'precision': 0.32468510405257395, 'recall': 0.6076095311299001, 'f1-score': 0.4232176318372446, 'support': 7806}, 'accuracy': 0.3508272905732943, 'macro avg': {'precision': 0.3546503888733214, 'recall': 0.3522283943585689, 'f1-score': 0.28577156904468715, 'support': 24961}, 'weighted avg': {'precision': 0.35615825059095774, 'recall': 0.3508272905732943, 'f1-score': 0.2874565748379961, 'support': 24961}}
[[3919   92 4947]
 [3184   95 4918]
 [2979   84 4743]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1297945
{'0': {'precision': 0.5178162046072424, 'recall': 0.3991682762426584, 'f1-score': 0.45081635757240746, 'support': 152214}, '1': {'precision': 0.530785958654826, 'recall': 0.6424296152723709, 'f1-score': 0.5812957597710112, 'support': 181609}, '2': {'precision': 0.4946226001348441, 'recall': 0.48409581590226214, 'f1-score': 0.4893025966457294, 'support': 156091}, 'accuracy': 0.5164028788726185, 'macro avg': {'precision': 0.5144082544656375, 'recall': 0.5085645691390971, 'f1-score': 0.5071382379963827, 'support': 489914}, 'weighted avg': {'precision': 0.5152343456424577, 'recall': 0.5164028788726185, 'f1-score': 0.5114465687871923, 'support': 489914}}
[[ 60759  51075  40380]
 [ 28112 116671  36826]
 [ 28466  52062  75563]]
Evaluating performance on  train set...
716/716 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0465925
{'0': {'precision': 0.5453445510565857, 'recall': 0.3674471513887572, 'f1-score': 0.439060305378098, 'support': 52745}, '1': {'precision': 0.5927669297002264, 'recall': 0.7330821657967375, 'f1-score': 0.6554997338885608, 'support': 76443}, '2': {'precision': 0.4941138739010678, 'recall': 0.4859634474441043, 'f1-score': 0.4900047707692164, 'support': 53895}, 'accuracy': 0.5549996449697678, 'macro avg': {'precision': 0.5440751182192932, 'recall': 0.5288309215431997, 'f1-score': 0.5281882700119583, 'support': 183083}, 'weighted avg': {'precision': 0.5500638944437881, 'recall': 0.5549996449697678, 'f1-score': 0.5444274404800988, 'support': 183083}}
[[19381 19163 14201]
 [ 7790 56039 12614]
 [ 8368 19336 26191]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.134255
{'0': {'precision': 0.5315633792655653, 'recall': 0.40624138501405965, 'f1-score': 0.4605287830489405, 'support': 18137}, '1': {'precision': 0.5014205186020293, 'recall': 0.6027538353119748, 'f1-score': 0.5474373492196346, 'support': 18447}, '2': {'precision': 0.48297346653775913, 'recall': 0.4976203652462645, 'f1-score': 0.4901875272568687, 'support': 18070}, 'accuracy': 0.5027811322135617, 'macro avg': {'precision': 0.5053191214684513, 'recall': 0.5022051951907663, 'f1-score': 0.49938455317514796, 'support': 54654}, 'weighted avg': {'precision': 0.5053244018137465, 'recall': 0.5027811322135617, 'f1-score': 0.49966838542000314, 'support': 54654}}
[[ 7368  5433  5336]
 [ 3038 11119  4290]
 [ 3455  5623  8992]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/EXC
Evaluating performance on  test set...
4918/4918 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49626336
{'0': {'precision': 0.5256411361579242, 'recall': 0.41910319325882855, 'f1-score': 0.46636507214176726, 'support': 145494}, '1': {'precision': 0.8709534151687245, 'recall': 0.9043356611542048, 'f1-score': 0.8873306810094387, 'support': 967142}, '2': {'precision': 0.48018294882338514, 'recall': 0.45528666602826307, 'f1-score': 0.4674035166563677, 'support': 146198}, 'accuracy': 0.796101789433714, 'macro avg': {'precision': 0.6255925000500112, 'recall': 0.5929085068137655, 'f1-score': 0.6070330899358579, 'support': 1258834}, 'weighted avg': {'precision': 0.785659623166639, 'recall': 0.796101789433714, 'f1-score': 0.7899068094976402, 'support': 1258834}}
[[ 60977  65682  18835]
 [ 39300 874621  53221]
 [ 15728  63908  66562]]
Evaluating performance on  train set...
1403/1403 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45746857
{'0': {'precision': 0.5073790145554017, 'recall': 0.4169048477953215, 'f1-score': 0.45771386790153545, 'support': 36037}, '1': {'precision': 0.89177986141663, 'recall': 0.9051070955138492, 'f1-score': 0.8983940554428294, 'support': 286660}, '2': {'precision': 0.4803903708523097, 'recall': 0.5087506545765235, 'f1-score': 0.49416394495904054, 'support': 36283}, 'accuracy': 0.8160371051312051, 'macro avg': {'precision': 0.6265164156081138, 'recall': 0.6102541992952314, 'f1-score': 0.6167572894344684, 'support': 358980}, 'weighted avg': {'precision': 0.8116107762183368, 'recall': 0.8160371051312051, 'f1-score': 0.8132988606768009, 'support': 358980}}
[[ 15024  16906   4107]
 [ 11343 259458  15859]
 [  3244  14580  18459]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47539634
{'0': {'precision': 0.5267130089374379, 'recall': 0.39487790351399643, 'f1-score': 0.45136584120500384, 'support': 13432}, '1': {'precision': 0.8809345605340346, 'recall': 0.9063078812095482, 'f1-score': 0.8934411094926451, 'support': 96102}, '2': {'precision': 0.48657084785133564, 'recall': 0.5084964345319375, 'f1-score': 0.4972920839824913, 'support': 13182}, 'accuracy': 0.8075964014472441, 'macro avg': {'precision': 0.6314061391076028, 'recall': 0.603227406418494, 'f1-score': 0.6140330115600467, 'support': 122716}, 'weighted avg': {'precision': 0.7998008343562842, 'recall': 0.8075964014472441, 'f1-score': 0.8024994926055689, 'support': 122716}}
[[ 5304  6436  1692]
 [ 3623 87098  5381]
 [ 1143  5336  6703]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/AAL
Evaluating performance on  test set...
4856/4856 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7700305
{'0': {'precision': 0.5100336616511325, 'recall': 0.3992407787093238, 'f1-score': 0.44788729828333024, 'support': 246305}, '1': {'precision': 0.7577128017903835, 'recall': 0.8340247492332304, 'f1-score': 0.7940394810660062, 'support': 761963}, '2': {'precision': 0.5039546632859657, 'recall': 0.45404718878925293, 'f1-score': 0.47770095150977065, 'support': 234632}, 'accuracy': 0.6761324322149811, 'macro avg': {'precision': 0.5905670422424939, 'recall': 0.5624375722439358, 'f1-score': 0.5732092436197024, 'support': 1242900}, 'weighted avg': {'precision': 0.6607264069351524, 'recall': 0.6761324322149811, 'f1-score': 0.6657249302194975, 'support': 1242900}}
[[ 98335 108269  39701]
 [ 61306 635496  65161]
 [ 33160  94938 106534]]
Evaluating performance on  train set...
2076/2076 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58097833
{'0': {'precision': 0.5538608780646738, 'recall': 0.37412140135623995, 'f1-score': 0.44658440673513455, 'support': 72701}, '1': {'precision': 0.826990672372388, 'recall': 0.9125941391006901, 'f1-score': 0.8676861693899196, 'support': 384139}, '2': {'precision': 0.5098116438356164, 'recall': 0.399262437977739, 'f1-score': 0.4478152966834624, 'support': 74570}, 'accuracy': 0.7668937355337686, 'macro avg': {'precision': 0.6302210647575593, 'recall': 0.561992659478223, 'f1-score': 0.5873619576028388, 'support': 531410}, 'weighted avg': {'precision': 0.745116320489751, 'recall': 0.7668937355337686, 'f1-score': 0.7511578951299583, 'support': 531410}}
[[ 27199  35797   9705]
 [ 14654 350563  18922]
 [  7255  37542  29773]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5451957
{'0': {'precision': 0.581310402556883, 'recall': 0.37678800434053467, 'f1-score': 0.4572198114619183, 'support': 20274}, '1': {'precision': 0.8328734693877551, 'recall': 0.9285311248634874, 'f1-score': 0.8781048282984766, 'support': 109880}, '2': {'precision': 0.5566841638830186, 'recall': 0.405139908712046, 'f1-score': 0.4689734386216798, 'support': 20156}, 'accuracy': 0.7839265517929612, 'macro avg': {'precision': 0.6569560119425523, 'recall': 0.5701530126386893, 'f1-score': 0.6014326927940249, 'support': 150310}, 'weighted avg': {'precision': 0.7619063929545, 'recall': 0.7839265517929612, 'f1-score': 0.7664723679054896, 'support': 150310}}
[[  7639  10187   2448]
 [  3798 102027   4055]
 [  1704  10286   8166]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/WBA
Evaluating performance on  test set...
4353/4353 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6766023
{'0': {'precision': 0.5589091951767955, 'recall': 0.3956371483358883, 'f1-score': 0.4633095955189011, 'support': 187217}, '1': {'precision': 0.7898925482241274, 'recall': 0.8922119608976887, 'f1-score': 0.8379403010071635, 'support': 740212}, '2': {'precision': 0.5256588929088775, 'recall': 0.40977447632911257, 'f1-score': 0.4605386223177902, 'support': 186854}, 'accuracy': 0.7278797217582966, 'macro avg': {'precision': 0.6248202121032668, 'recall': 0.5658745285208965, 'f1-score': 0.5872628396146182, 'support': 1114283}, 'weighted avg': {'precision': 0.7067744123127493, 'recall': 0.7278797217582966, 'f1-score': 0.7117100255212949, 'support': 1114283}}
[[ 74070  85715  27432]
 [ 38125 660426  41661]
 [ 20331  89955  76568]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75113094
{'0': {'precision': 0.5432381590955654, 'recall': 0.38969350399486946, 'f1-score': 0.4538304145887954, 'support': 74846}, '1': {'precision': 0.7621046040412, 'recall': 0.8756765277704798, 'f1-score': 0.814952743687403, 'support': 247403}, '2': {'precision': 0.5215286489160585, 'recall': 0.4081976961265609, 'f1-score': 0.4579558148194117, 'support': 72313}, 'accuracy': 0.6978117507514662, 'macro avg': {'precision': 0.6089571373509414, 'recall': 0.5578559092973034, 'f1-score': 0.5755796576985367, 'support': 394562}, 'weighted avg': {'precision': 0.6764956326213335, 'recall': 0.6978117507514662, 'f1-score': 0.6810217499248373, 'support': 394562}}
[[ 29167  34321  11358]
 [ 15035 216645  15723]
 [  9489  33306  29518]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7391985
{'0': {'precision': 0.5536537655442224, 'recall': 0.3582568599972876, 'f1-score': 0.43502127075614105, 'support': 22121}, '1': {'precision': 0.7638281113250481, 'recall': 0.8809094235354975, 'f1-score': 0.8182015269501426, 'support': 79259}, '2': {'precision': 0.513731733666913, 'recall': 0.4120114916320854, 'f1-score': 0.4572831258224517, 'support': 21929}, 'accuracy': 0.7037604716606249, 'macro avg': {'precision': 0.6104045368453944, 'recall': 0.5503925917216236, 'f1-score': 0.5701686411762451, 'support': 123309}, 'weighted avg': {'precision': 0.6816473283434094, 'recall': 0.7037604716606249, 'f1-score': 0.6852760303067781, 'support': 123309}}
[[ 7925 10955  3241]
 [ 4128 69820  5311]
 [ 2261 10633  9035]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82446665
{'0': {'precision': 0.506530599951811, 'recall': 0.3697316112485115, 'f1-score': 0.4274528160019994, 'support': 272925}, '1': {'precision': 0.7397571320165729, 'recall': 0.8686866361038644, 'f1-score': 0.7990545237353938, 'support': 868594}, '2': {'precision': 0.5391219242348486, 'recall': 0.38150084501104725, 'f1-score': 0.44681812470932086, 'support': 265677}, 'accuracy': 0.6799344227811904, 'macro avg': {'precision': 0.5951365520677442, 'recall': 0.5399730307878078, 'f1-score': 0.5577751548155713, 'support': 1407196}, 'weighted avg': {'precision': 0.6566432577861172, 'recall': 0.6799344227811904, 'f1-score': 0.6604807174801268, 'support': 1407196}}
[[100909 136723  35293]
 [ 62705 754536  51353]
 [ 35602 128719 101356]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80212885
{'0': {'precision': 0.5385948179939596, 'recall': 0.35405063687944743, 'f1-score': 0.4272465339730535, 'support': 95701}, '1': {'precision': 0.7441269680938372, 'recall': 0.8820925143758588, 'f1-score': 0.807257366396739, 'support': 334067}, '2': {'precision': 0.4927623731758677, 'recall': 0.34478033300362676, 'f1-score': 0.4056981784014791, 'support': 97056}, 'accuracy': 0.6871820570057553, 'macro avg': {'precision': 0.5918280530878881, 'recall': 0.5269744947529776, 'f1-score': 0.5467340262570904, 'support': 526824}, 'weighted avg': {'precision': 0.6604821940875906, 'recall': 0.6871820570057553, 'f1-score': 0.6642472810098792, 'support': 526824}}
[[ 33883  47783  14035]
 [ 18978 294678  20411]
 [ 10049  53544  33463]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85277027
{'0': {'precision': 0.5196733481811433, 'recall': 0.3550696049146142, 'f1-score': 0.4218844170628809, 'support': 35486}, '1': {'precision': 0.7198770757654385, 'recall': 0.857058732671738, 'f1-score': 0.7825010135909324, 'support': 103588}, '2': {'precision': 0.4978484565014032, 'recall': 0.3777146912704045, 'f1-score': 0.42953995157384983, 'support': 35225}, 'accuracy': 0.6579842684123259, 'macro avg': {'precision': 0.5791329601493284, 'recall': 0.5299476762855856, 'f1-score': 0.5446417940758878, 'support': 174299}, 'weighted avg': {'precision': 0.6342461335877326, 'recall': 0.6579842684123259, 'f1-score': 0.6377503612409696, 'support': 174299}}
[[12600 17174  5712]
 [ 7099 88781  7708]
 [ 4547 17373 13305]]
testing model on single stock: results/universal/W2/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 115s - 115s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1777964
{'0': {'precision': 0.469209956472278, 'recall': 0.38001924544343674, 'f1-score': 0.4199309519995519, 'support': 1124422}, '1': {'precision': 0.5055575616556942, 'recall': 0.5559372978431342, 'f1-score': 0.5295518903666261, 'support': 1521096}, '2': {'precision': 0.43808487983211225, 'recall': 0.4614712086130253, 'f1-score': 0.4494740496296389, 'support': 1164376}, 'accuracy': 0.475147602531724, 'macro avg': {'precision': 0.47095079932002815, 'recall': 0.4658092506331987, 'f1-score': 0.4663189639986056, 'support': 3809894}, 'weighted avg': {'precision': 0.47420928312443783, 'recall': 0.475147602531724, 'f1-score': 0.4727259233852475, 'support': 3809894}}
[[427302 391843 305277]
 [291531 845634 383931]
 [191851 435199 537326]]
Evaluating performance on  train set...
6147/6147 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2062036
{'0': {'precision': 0.4794575554962661, 'recall': 0.3670279704410327, 'f1-score': 0.4157763555651115, 'support': 484726}, '1': {'precision': 0.48472241288153195, 'recall': 0.596886652875687, 'f1-score': 0.5349887454875067, 'support': 597492}, '2': {'precision': 0.44190018235544953, 'recall': 0.4197775131548146, 'f1-score': 0.4305548596148386, 'support': 491265}, 'accuracy': 0.47078042787878865, 'macro avg': {'precision': 0.4686933835777492, 'recall': 0.46123071215717815, 'f1-score': 0.4604399868891523, 'support': 1573483}, 'weighted avg': {'precision': 0.4697307819962117, 'recall': 0.47078042787878865, 'f1-score': 0.46565843949706437, 'support': 1573483}}
[[177908 180988 125830]
 [106238 356635 134619]
 [ 86915 198128 206222]]
Evaluating performance on  val set...
2174/2174 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1461744
{'0': {'precision': 0.48736929130241746, 'recall': 0.3772747474148914, 'f1-score': 0.4253128872470264, 'support': 168755}, '1': {'precision': 0.5299565201825118, 'recall': 0.6254360226285768, 'f1-score': 0.5737511466753951, 'support': 213005}, '2': {'precision': 0.450684287744716, 'recall': 0.4500266105080032, 'f1-score': 0.45035520901638165, 'support': 174743}, 'accuracy': 0.49510424921339147, 'macro avg': {'precision': 0.4893366997432151, 'recall': 0.4842457935171571, 'f1-score': 0.4831397476462677, 'support': 556503}, 'weighted avg': {'precision': 0.4921506583586976, 'recall': 0.49510424921339147, 'f1-score': 0.48999189505557755, 'support': 556503}}
[[ 63667  55070  50018]
 [ 33953 133221  45831]
 [ 33014  63090  78639]]
training model: results/universal/W2/deepOF_L2/h20
Epoch 1/50
9940/9940 - 220s - loss: 2.8117 - accuracy20: 0.5341 - val_loss: 3.4179 - val_accuracy20: 0.5188 - 220s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 216s - loss: 2.7319 - accuracy20: 0.5528 - val_loss: 3.4900 - val_accuracy20: 0.5200 - 216s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 215s - loss: 2.7102 - accuracy20: 0.5568 - val_loss: 3.4822 - val_accuracy20: 0.5197 - 215s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 214s - loss: 2.6979 - accuracy20: 0.5592 - val_loss: 3.4760 - val_accuracy20: 0.5204 - 214s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 214s - loss: 2.6891 - accuracy20: 0.5610 - val_loss: 3.5234 - val_accuracy20: 0.5210 - 214s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 215s - loss: 2.6822 - accuracy20: 0.5625 - val_loss: 3.4682 - val_accuracy20: 0.5237 - 215s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 216s - loss: 2.6769 - accuracy20: 0.5633 - val_loss: 3.4780 - val_accuracy20: 0.5237 - 216s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 219s - loss: 2.6717 - accuracy20: 0.5643 - val_loss: 3.4622 - val_accuracy20: 0.5256 - 219s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 216s - loss: 2.6674 - accuracy20: 0.5651 - val_loss: 3.4483 - val_accuracy20: 0.5253 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 215s - loss: 2.6641 - accuracy20: 0.5658 - val_loss: 3.4565 - val_accuracy20: 0.5259 - 215s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 218s - loss: 2.6607 - accuracy20: 0.5666 - val_loss: 3.4801 - val_accuracy20: 0.5278 - 218s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 197s - 197s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0358796
{'0': {'precision': 0.47912496515577924, 'recall': 0.3400173456854284, 'f1-score': 0.3977594533887336, 'support': 1789494}, '1': {'precision': 0.5996693318745513, 'recall': 0.7160549309798583, 'f1-score': 0.6527145453935952, 'support': 3086273}, '2': {'precision': 0.4347536730971827, 'recall': 0.4160349966422346, 'f1-score': 0.4251884148447438, 'support': 1844977}, 'accuracy': 0.5335681585253061, 'macro avg': {'precision': 0.5045159900425045, 'recall': 0.4907024244358404, 'f1-score': 0.4918874712090242, 'support': 6720744}, 'weighted avg': {'precision': 0.5223000676441126, 'recall': 0.5335681585253061, 'f1-score': 0.5223686960093937, 'support': 6720744}}
[[ 608459  707813  473222]
 [ 351589 2209941  524743]
 [ 309890  767512  767575]]
Evaluating performance on  train set...
9940/9940 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0944585
{'0': {'precision': 0.4795196969210518, 'recall': 0.3123234734021642, 'f1-score': 0.37826999820180174, 'support': 717314}, '1': {'precision': 0.5544461097092801, 'recall': 0.7373067354231692, 'f1-score': 0.6329335408987001, 'support': 1105350}, '2': {'precision': 0.43613223832708725, 'recall': 0.36690084679348917, 'f1-score': 0.3985322411270797, 'support': 720955}, 'accuracy': 0.5124725833546612, 'macro avg': {'precision': 0.4900326816524731, 'recall': 0.4721770185396075, 'f1-score': 0.4699119267425272, 'support': 2543619}, 'weighted avg': {'precision': 0.4997819709349101, 'recall': 0.5124725833546612, 'f1-score': 0.4946791429157744, 'support': 2543619}}
[[224034 314851 178429]
 [126805 814982 163563]
 [116366 340070 264519]]
Evaluating performance on  val set...
3393/3393 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0706027
{'0': {'precision': 0.48941993438814785, 'recall': 0.3220400995170496, 'f1-score': 0.3884673003979414, 'support': 245988}, '1': {'precision': 0.5662988115449915, 'recall': 0.7339345898718417, 'f1-score': 0.6393102738989581, 'support': 372664}, '2': {'precision': 0.4373728957812598, 'recall': 0.39145094234477673, 'f1-score': 0.4131397393123788, 'support': 249431}, 'accuracy': 0.5188086853446041, 'macro avg': {'precision': 0.4976972139047997, 'recall': 0.48247521057788934, 'f1-score': 0.48030577120309276, 'support': 868083}, 'weighted avg': {'precision': 0.5074687211862113, 'recall': 0.5188086853446041, 'f1-score': 0.5032422896416541, 'support': 868083}}
[[ 79218  98825  67945]
 [ 41496 273511  57657]
 [ 41147 110644  97640]]
testing model out of sample: results/universal/W2/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0136087
{'0': {'precision': 0.5008027032757698, 'recall': 0.29812508515054614, 'f1-score': 0.37375555268092286, 'support': 998232}, '1': {'precision': 0.5848714343058539, 'recall': 0.8257804505728616, 'f1-score': 0.684754901936432, 'support': 1669164}, '2': {'precision': 0.48849633682234006, 'recall': 0.34989272619562256, 'f1-score': 0.40773746358778923, 'support': 999312}, 'accuracy': 0.5524336816566795, 'macro avg': {'precision': 0.5247234914679879, 'recall': 0.49126608730634347, 'f1-score': 0.4887493060683814, 'support': 3666708}, 'weighted avg': {'precision': 0.5357186550471651, 'recall': 0.5524336816566795, 'f1-score': 0.5245904294021904, 'support': 3666708}}
[[ 297598  490855  209779]
 [ 134460 1378363  156341]
 [ 162184  487476  349652]]
Evaluating performance on  train set...
5373/5373 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9180856
{'0': {'precision': 0.5405425842552845, 'recall': 0.2855856520322805, 'f1-score': 0.37372214044993524, 'support': 325398}, '1': {'precision': 0.64429372091205, 'recall': 0.8703398745672877, 'f1-score': 0.7404490669119511, 'support': 719589}, '2': {'precision': 0.4814349682571302, 'recall': 0.33698594426812895, 'f1-score': 0.3964630299615384, 'support': 329901}, 'accuracy': 0.6039677413723882, 'macro avg': {'precision': 0.5554237578081548, 'recall': 0.49763715695589905, 'f1-score': 0.5035447457744749, 'support': 1374888}, 'weighted avg': {'precision': 0.5806611357666062, 'recall': 0.6039677413723882, 'f1-score': 0.571116331450688, 'support': 1374888}}
[[ 92929 165688  66781]
 [ 40337 626287  52965]
 [ 38652 180077 111172]]
Evaluating performance on  val set...
1685/1685 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94691503
{'0': {'precision': 0.5262073583188833, 'recall': 0.281774304757527, 'f1-score': 0.36701751865023774, 'support': 108775}, '1': {'precision': 0.623728894286871, 'recall': 0.8599498112057037, 'f1-score': 0.7230346339808964, 'support': 213195}, '2': {'precision': 0.4866407593807734, 'recall': 0.3513739776814874, 'f1-score': 0.4080904350799214, 'support': 108699}, 'accuracy': 0.5855564250038893, 'macro avg': {'precision': 0.5455256706621759, 'recall': 0.49769936454823943, 'f1-score': 0.4993808625703518, 'support': 430669}, 'weighted avg': {'precision': 0.5644972146185508, 'recall': 0.5855564250038893, 'f1-score': 0.5536240629938286, 'support': 430669}}
[[ 30650  54795  23330]
 [ 12897 183337  16961]
 [ 14700  55805  38194]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
987/987 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.298205
{'0': {'precision': 0.3601903379304783, 'recall': 0.4458142523801799, 'f1-score': 0.39845427221983687, 'support': 80141}, '1': {'precision': 0.4784052053248348, 'recall': 0.1588706743542537, 'f1-score': 0.2385295286016949, 'support': 90709}, '2': {'precision': 0.34051552668966917, 'recall': 0.5137555120039197, 'f1-score': 0.40956961160071287, 'support': 81640}, 'accuracy': 0.3646956315101588, 'macro avg': {'precision': 0.39303702331499407, 'recall': 0.3728134795794511, 'f1-score': 0.34885113747408153, 'support': 252490}, 'weighted avg': {'precision': 0.3962983058372272, 'recall': 0.3646956315101588, 'f1-score': 0.344594090581739, 'support': 252490}}
[[35728  7308 37105]
 [32171 14411 44127]
 [31293  8404 41943]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3121212
{'0': {'precision': 0.3565763941618156, 'recall': 0.4230307276548894, 'f1-score': 0.3869712506866874, 'support': 19982}, '1': {'precision': 0.33882386938303716, 'recall': 0.11672473867595819, 'f1-score': 0.1736329643478583, 'support': 20090}, '2': {'precision': 0.35080739527264215, 'recall': 0.5127039968728623, 'f1-score': 0.416578994382357, 'support': 20466}, 'accuracy': 0.35169645511909875, 'macro avg': {'precision': 0.3487358862724983, 'recall': 0.35081982106790327, 'f1-score': 0.3257277364723009, 'support': 60538}, 'weighted avg': {'precision': 0.3487347648699413, 'recall': 0.35169645511909875, 'f1-score': 0.326182752717288, 'support': 60538}}
[[ 8453  2243  9286]
 [ 7613  2345 10132]
 [ 7640  2333 10493]]
Evaluating performance on  val set...
85/85 - 1s - 855ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.297239
{'0': {'precision': 0.3407835258663988, 'recall': 0.40326894502228827, 'f1-score': 0.36940247720157887, 'support': 6730}, '1': {'precision': 0.4381711118808452, 'recall': 0.15948058497226425, 'f1-score': 0.2338478602458638, 'support': 7932}, '2': {'precision': 0.33835845896147404, 'recall': 0.5242970439798126, 'f1-score': 0.41128895424466944, 'support': 6935}, 'accuracy': 0.35259526786127704, 'macro avg': {'precision': 0.37243769890290607, 'recall': 0.36234885799145505, 'f1-score': 0.3381797638973707, 'support': 21597}, 'weighted avg': {'precision': 0.3757726675657522, 'recall': 0.35259526786127704, 'f1-score': 0.33306703693677825, 'support': 21597}}
[[2714  802 3214]
 [2771 1265 3896]
 [2479  820 3636]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84912467
{'0': {'precision': 0.48737223266260254, 'recall': 0.3281891416401741, 'f1-score': 0.39224583148885944, 'support': 64798}, '1': {'precision': 0.7070096953104051, 'recall': 0.8020684907382206, 'f1-score': 0.7515451545154516, 'support': 187383}, '2': {'precision': 0.43279801243849764, 'recall': 0.406215231737613, 'f1-score': 0.4190855058335167, 'support': 65613}, 'accuracy': 0.6237153627821796, 'macro avg': {'precision': 0.5423933134705018, 'recall': 0.5121576213720026, 'f1-score': 0.5209588306126093, 'support': 317794}, 'weighted avg': {'precision': 0.6056109292766638, 'recall': 0.6237153627821796, 'f1-score': 0.6096433172798684, 'support': 317794}}
[[ 21266  31367  12165]
 [ 14324 150294  22765]
 [  8044  30916  26653]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71006703
{'0': {'precision': 0.5148978246539222, 'recall': 0.3602859778597786, 'f1-score': 0.4239348710990502, 'support': 21680}, '1': {'precision': 0.782120262519955, 'recall': 0.8685584215191674, 'f1-score': 0.8230761652416039, 'support': 91379}, '2': {'precision': 0.4493293183684643, 'recall': 0.37553765900979225, 'f1-score': 0.40913282983125204, 'support': 21854}, 'accuracy': 0.7070185971700281, 'macro avg': {'precision': 0.5821158018474472, 'recall': 0.5347940194629127, 'f1-score': 0.5520479553906353, 'support': 134913}, 'weighted avg': {'precision': 0.6852712135297001, 'recall': 0.7070185971700281, 'f1-score': 0.6918827227337032, 'support': 134913}}
[[ 7811 10440  3429]
 [ 5382 79368  6629]
 [ 1977 11670  8207]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77702785
{'0': {'precision': 0.4902105652013299, 'recall': 0.36511211996148024, 'f1-score': 0.41851297011748, 'support': 7269}, '1': {'precision': 0.7559476810051838, 'recall': 0.8342805182996136, 'f1-score': 0.7931848062964898, 'support': 26394}, '2': {'precision': 0.43381259295984137, 'recall': 0.37873322752849514, 'f1-score': 0.4044061007548914, 'support': 6931}, 'accuracy': 0.672488545105188, 'macro avg': {'precision': 0.5599902797221183, 'recall': 0.5260419552631963, 'f1-score': 0.5387012923896204, 'support': 40594}, 'weighted avg': {'precision': 0.6533620429793553, 'recall': 0.672488545105188, 'f1-score': 0.6597139784575471, 'support': 40594}}
[[ 2654  3521  1094]
 [ 2042 22020  2332]
 [  718  3588  2625]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2605389
{'0': {'precision': 0.48526910253793293, 'recall': 0.29977092659142973, 'f1-score': 0.3706042064512777, 'support': 95166}, '1': {'precision': 0.3800200118251694, 'recall': 0.6439774435124408, 'f1-score': 0.4779783668857945, 'support': 77849}, '2': {'precision': 0.46443028575534745, 'recall': 0.38321820679296, 'f1-score': 0.41993383543323715, 'support': 101193}, 'accuracy': 0.42828801493756563, 'macro avg': {'precision': 0.44323980003948327, 'recall': 0.4423221922989435, 'f1-score': 0.42283880292343645, 'support': 274208}, 'weighted avg': {'precision': 0.4476980657717624, 'recall': 0.42828801493756563, 'f1-score': 0.41929273545567625, 'support': 274208}}
[[28528 38209 28429]
 [11426 50133 16290]
 [18834 43580 38779]]
Evaluating performance on  train set...
286/286 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2260451
{'0': {'precision': 0.5100593428860906, 'recall': 0.2896716123463894, 'f1-score': 0.36949854517811737, 'support': 24331}, '1': {'precision': 0.4345833866632536, 'recall': 0.686910782925349, 'f1-score': 0.5323612417685796, 'support': 24715}, '2': {'precision': 0.44193548387096776, 'recall': 0.37124275649310046, 'f1-score': 0.4035163241724631, 'support': 23987}, 'accuracy': 0.450892062492298, 'macro avg': {'precision': 0.46219273780677067, 'recall': 0.4492750505882796, 'f1-score': 0.4351253703730533, 'support': 73033}, 'weighted avg': {'precision': 0.4621429863863827, 'recall': 0.450892062492298, 'f1-score': 0.43578551149431194, 'support': 73033}}
[[ 7048 10731  6552]
 [ 3045 16977  4693]
 [ 3725 11357  8905]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2307887
{'0': {'precision': 0.47932131495228, 'recall': 0.27832512315270935, 'f1-score': 0.35216205687573043, 'support': 9744}, '1': {'precision': 0.43627848891664067, 'recall': 0.6782836617804097, 'f1-score': 0.5310077519379846, 'support': 10301}, '2': {'precision': 0.4384218289085546, 'recall': 0.3653215895124949, 'f1-score': 0.3985474860335195, 'support': 9764}, 'accuracy': 0.44503337918078434, 'macro avg': {'precision': 0.4513405442591584, 'recall': 0.44064345814853795, 'f1-score': 0.4272390982824115, 'support': 29809}, 'weighted avg': {'precision': 0.4510504325770224, 'recall': 0.44503337918078434, 'f1-score': 0.42915883084107415, 'support': 29809}}
[[2712 4488 2544]
 [1289 6987 2025]
 [1657 4540 3567]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.341501
{'0': {'precision': 0.3397945552535815, 'recall': 0.48950204384986995, 'f1-score': 0.40113544289342173, 'support': 75348}, '1': {'precision': 0.2891165882027139, 'recall': 0.06218635057257308, 'f1-score': 0.10235670429059893, 'support': 67153}, '2': {'precision': 0.3595358432181537, 'recall': 0.45012784421085256, 'f1-score': 0.3997637452118265, 'support': 77438}, 'accuracy': 0.3451684330655318, 'macro avg': {'precision': 0.32948232889148305, 'recall': 0.33393874621109854, 'f1-score': 0.3010852974652824, 'support': 219939}, 'weighted avg': {'precision': 0.3312719573334019, 'recall': 0.3451684330655318, 'f1-score': 0.30942769593420705, 'support': 219939}}
[[36883  5003 33462]
 [34346  4176 28631]
 [37316  5265 34857]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3433368
{'0': {'precision': 0.3475500308087979, 'recall': 0.45967684784919566, 'f1-score': 0.3958260232802941, 'support': 28222}, '1': {'precision': 0.32208095864386965, 'recall': 0.08166895171749361, 'f1-score': 0.1302985515814366, 'support': 26987}, '2': {'precision': 0.31449441497160835, 'recall': 0.4456406769416742, 'f1-score': 0.3687542003344639, 'support': 26472}, 'accuracy': 0.3302359177776962, 'macro avg': {'precision': 0.32804180147475864, 'recall': 0.3289954921694545, 'f1-score': 0.29829292506539823, 'support': 81681}, 'weighted avg': {'precision': 0.32842217839566634, 'recall': 0.3302359177776962, 'f1-score': 0.2993233460878125, 'support': 81681}}
[[12973  2166 13083]
 [12152  2204 12631]
 [12202  2473 11797]]
Evaluating performance on  val set...
98/98 - 1s - 936ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3514572
{'0': {'precision': 0.3641937461679951, 'recall': 0.3999102333931777, 'f1-score': 0.38121724248582733, 'support': 8912}, '1': {'precision': 0.29559426229508196, 'recall': 0.07156145355326801, 'f1-score': 0.11522715926110834, 'support': 8063}, '2': {'precision': 0.3113514331089768, 'recall': 0.5155271725519659, 'f1-score': 0.3882314111933613, 'support': 7986}, 'accuracy': 0.33083610432274346, 'macro avg': {'precision': 0.3237131471906846, 'recall': 0.32899961983280385, 'f1-score': 0.29489193764676563, 'support': 24961}, 'weighted avg': {'precision': 0.3251281498154203, 'recall': 0.33083610432274346, 'f1-score': 0.29754019069533244, 'support': 24961}}
[[3564  716 4632]
 [3012  577 4474]
 [3210  659 4117]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2101098
{'0': {'precision': 0.5217680292455965, 'recall': 0.29537998424326517, 'f1-score': 0.3772139923566114, 'support': 170086}, '1': {'precision': 0.39594969308674943, 'recall': 0.7016287648125206, 'f1-score': 0.5062229348416175, 'support': 142869}, '2': {'precision': 0.49446817599316534, 'recall': 0.3924807441271707, 'f1-score': 0.4376108550527852, 'support': 176959}, 'accuracy': 0.44892368864739524, 'macro avg': {'precision': 0.47072863277517046, 'recall': 0.4631631643943188, 'f1-score': 0.4403492607503381, 'support': 489914}, 'weighted avg': {'precision': 0.47521599235672357, 'recall': 0.44892368864739524, 'f1-score': 0.4366512548756301, 'support': 489914}}
[[ 50240  74230  45616]
 [ 17237 100241  25391]
 [ 28811  78695  69453]]
Evaluating performance on  train set...
716/716 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1549942
{'0': {'precision': 0.5526937539516156, 'recall': 0.2743248823189363, 'f1-score': 0.36666077972537414, 'support': 60545}, '1': {'precision': 0.45247301511153754, 'recall': 0.7735675737742566, 'f1-score': 0.570973678475434, 'support': 60963}, '2': {'precision': 0.48816768086544965, 'recall': 0.3869427527405603, 'f1-score': 0.4317008207859977, 'support': 61575}, 'accuracy': 0.47843874089893657, 'macro avg': {'precision': 0.4977781499762009, 'recall': 0.47827840294458435, 'f1-score': 0.45644509299560193, 'support': 183083}, 'weighted avg': {'precision': 0.4976206458411502, 'recall': 0.47843874089893657, 'f1-score': 0.4565673673102826, 'support': 183083}}
[[16609 27838 16098]
 [ 4921 47159  8883]
 [ 8521 29228 23826]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.224943
{'0': {'precision': 0.5342741935483871, 'recall': 0.3001132502831257, 'f1-score': 0.38433647570703405, 'support': 20309}, '1': {'precision': 0.34752425881179766, 'recall': 0.6548858051459959, 'f1-score': 0.4540830389135283, 'support': 13836}, '2': {'precision': 0.475921504687591, 'recall': 0.39850797210980543, 'f1-score': 0.4337880154981158, 'support': 20509}, 'accuracy': 0.4268489040143448, 'macro avg': {'precision': 0.4525733190159252, 'recall': 0.45116900917964237, 'f1-score': 0.42406917670622607, 'support': 54654}, 'weighted avg': {'precision': 0.46510034729996025, 'recall': 0.4268489040143448, 'f1-score': 0.42055002051803325, 'support': 54654}}
[[6095 8218 5996]
 [1771 9061 3004]
 [3542 8794 8173]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/EXC
Evaluating performance on  test set...
4918/4918 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6365144
{'0': {'precision': 0.6139563336837208, 'recall': 0.3516623977811666, 'f1-score': 0.4471855182606349, 'support': 202629}, '1': {'precision': 0.7786314138058325, 'recall': 0.9524031253858228, 'f1-score': 0.8567951421449391, 'support': 850455}, '2': {'precision': 0.630087010808069, 'recall': 0.31394410692588093, 'f1-score': 0.41907962603725357, 'support': 205750}, 'accuracy': 0.7513516476358281, 'macro avg': {'precision': 0.6742249194325408, 'recall': 0.53933654336429, 'f1-score': 0.5743534288142759, 'support': 1258834}, 'weighted avg': {'precision': 0.7278455614004692, 'recall': 0.7513516476358281, 'f1-score': 0.7193197038288395, 'support': 1258834}}
[[ 71257 108377  22995]
 [ 25552 809976  14927]
 [ 19253 121903  64594]]
Evaluating performance on  train set...
1403/1403 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.58720905
{'0': {'precision': 0.5756972111553785, 'recall': 0.3737874541927139, 'f1-score': 0.45327408181937, 'support': 51029}, '1': {'precision': 0.8091922517674193, 'recall': 0.9436459953457369, 'f1-score': 0.8712623986870707, 'support': 256539}, '2': {'precision': 0.6412322452497845, 'recall': 0.3328016805415078, 'f1-score': 0.43818426275689865, 'support': 51412}, 'accuracy': 0.7751573903838654, 'macro avg': {'precision': 0.6753739027241941, 'recall': 0.5500783766933196, 'f1-score': 0.5875735810877797, 'support': 358980}, 'weighted avg': {'precision': 0.7519462261323521, 'recall': 0.7751573903838654, 'f1-score': 0.749821262841386, 'support': 358980}}
[[ 19074  27073   4882]
 [  9766 242082   4691]
 [  4292  30010  17110]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61210644
{'0': {'precision': 0.5995119305856833, 'recall': 0.35362797888788183, 'f1-score': 0.44485429730726667, 'support': 18757}, '1': {'precision': 0.7916764223835168, 'recall': 0.9496781743709772, 'f1-score': 0.8635091564957383, 'support': 85450}, '2': {'precision': 0.65030607783122, 'recall': 0.3214112053595548, 'f1-score': 0.4301985030914416, 'support': 18509}, 'accuracy': 0.7638123798037746, 'macro avg': {'precision': 0.6804981436001402, 'recall': 0.5415724528728046, 'f1-score': 0.5795206522981489, 'support': 122716}, 'weighted avg': {'precision': 0.7409817038466476, 'recall': 0.7638123798037746, 'f1-score': 0.7341628929469078, 'support': 122716}}
[[ 6633 10403  1721]
 [ 2822 81150  1478]
 [ 1609 10951  5949]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/AAL
Evaluating performance on  test set...
4856/4856 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89774215
{'0': {'precision': 0.5391383638861257, 'recall': 0.2960152666296054, 'f1-score': 0.38218881102737323, 'support': 307599}, '1': {'precision': 0.6349678019316584, 'recall': 0.8826941239594479, 'f1-score': 0.7386129125423373, 'support': 637402}, '2': {'precision': 0.5234284376430023, 'recall': 0.3302125888304425, 'f1-score': 0.40495396566309816, 'support': 297899}, 'accuracy': 0.6050808592807144, 'macro avg': {'precision': 0.5658448678202621, 'recall': 0.5029739931398319, 'f1-score': 0.5085852297442696, 'support': 1242900}, 'weighted avg': {'precision': 0.5845176415039536, 'recall': 0.6050808592807144, 'f1-score': 0.5704317524986653, 'support': 1242900}}
[[ 91054 165025  51520]
 [ 36727 562631  38044]
 [ 41107 158422  98370]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7337868
{'0': {'precision': 0.5651068351740104, 'recall': 0.30952158232255517, 'f1-score': 0.39997045214927035, 'support': 96213}, '1': {'precision': 0.7371030008421648, 'recall': 0.9116542971010407, 'f1-score': 0.8151389157908423, 'support': 336983}, '2': {'precision': 0.5159295322062362, 'recall': 0.3253202191133647, 'f1-score': 0.39903086616336647, 'support': 98214}, 'accuracy': 0.6942718428332173, 'macro avg': {'precision': 0.6060464560741372, 'recall': 0.5154986995123202, 'f1-score': 0.5380467447011598, 'support': 531410}, 'weighted avg': {'precision': 0.6650859177311221, 'recall': 0.6942718428332173, 'f1-score': 0.6630675596280688, 'support': 531410}}
[[ 29780  51666  14767]
 [ 14560 307212  15211]
 [  8358  57905  31951]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7047959
{'0': {'precision': 0.6095114106294992, 'recall': 0.29481053450383377, 'f1-score': 0.3974035700911247, 'support': 26997}, '1': {'precision': 0.7400561458486347, 'recall': 0.9397117188066693, 'f1-score': 0.8280184988198557, 'support': 96503}, '2': {'precision': 0.5823705314666304, 'recall': 0.3196195449459157, 'f1-score': 0.4127251709854542, 'support': 26810}, 'accuracy': 0.7132792229392588, 'macro avg': {'precision': 0.6439793626482547, 'recall': 0.5180472660854729, 'f1-score': 0.5460490799654782, 'support': 150310}, 'weighted avg': {'precision': 0.6884836121629682, 'recall': 0.7132792229392588, 'f1-score': 0.6766025893651962, 'support': 150310}}
[[ 7959 15634  3404]
 [ 3077 90685  2741]
 [ 2022 16219  8569]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/WBA
Evaluating performance on  test set...
4353/4353 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8140504
{'0': {'precision': 0.6314278922764048, 'recall': 0.2983220890282757, 'f1-score': 0.40520331633733986, 'support': 240418}, '1': {'precision': 0.6825760462403349, 'recall': 0.9227639505930201, 'f1-score': 0.7847017706546044, 'support': 630923}, '2': {'precision': 0.5409614174240834, 'recall': 0.3290209185731574, 'f1-score': 0.4091752558849049, 'support': 242942}, 'accuracy': 0.658583142702527, 'macro avg': {'precision': 0.6183217853136077, 'recall': 0.516702319398151, 'f1-score': 0.5330267809589497, 'support': 1114283}, 'weighted avg': {'precision': 0.6406647202723557, 'recall': 0.658583142702527, 'f1-score': 0.6209467623297638, 'support': 1114283}}
[[ 71722 128312  40384]
 [ 21286 582193  27444]
 [ 20579 142430  79933]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8989695
{'0': {'precision': 0.5839286856752895, 'recall': 0.2875339977107333, 'f1-score': 0.3853276854444898, 'support': 95227}, '1': {'precision': 0.6397562208770036, 'recall': 0.9054961632747791, 'f1-score': 0.7497762946384781, 'support': 206817}, '2': {'precision': 0.539592698418476, 'recall': 0.3204673685120733, 'f1-score': 0.4021157562811514, 'support': 92518}, 'accuracy': 0.6191726522067508, 'macro avg': {'precision': 0.5877592016569231, 'recall': 0.5044991764991952, 'f1-score': 0.5124065787880397, 'support': 394562}, 'weighted avg': {'precision': 0.6027956989172819, 'recall': 0.6191726522067508, 'f1-score': 0.5802967061442513, 'support': 394562}}
[[ 27381  52750  15096]
 [  9343 187272  10202]
 [ 10167  52702  29649]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88636005
{'0': {'precision': 0.6099251234666242, 'recall': 0.26640456474845176, 'f1-score': 0.37083494769469194, 'support': 28742}, '1': {'precision': 0.6450283743066129, 'recall': 0.9152754906256138, 'f1-score': 0.7567483168242628, 'support': 66191}, '2': {'precision': 0.5387357414448669, 'recall': 0.3195658302791091, 'f1-score': 0.40116793487878255, 'support': 28376}, 'accuracy': 0.6269453162380686, 'macro avg': {'precision': 0.5978964130727014, 'recall': 0.5004152952177249, 'f1-score': 0.5095837331325791, 'support': 123309}, 'weighted avg': {'precision': 0.6123860093070762, 'recall': 0.6269453162380686, 'f1-score': 0.5849695255470074, 'support': 123309}}
[[ 7657 16605  4480]
 [ 2324 60583  3284]
 [ 2573 16735  9068]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9487346
{'0': {'precision': 0.5385458573844091, 'recall': 0.2675414204611285, 'f1-score': 0.35748814707305276, 'support': 345240}, '1': {'precision': 0.6168285494982422, 'recall': 0.903653161376304, 'f1-score': 0.7331874692009855, 'support': 720335}, '2': {'precision': 0.5603505620967205, 'recall': 0.29589808589050437, 'f1-score': 0.38728623780451593, 'support': 341621}, 'accuracy': 0.6000471860352076, 'macro avg': {'precision': 0.5719083229931239, 'recall': 0.48903088924264565, 'f1-score': 0.49265395135951806, 'support': 1407196}, 'weighted avg': {'precision': 0.5839117538567857, 'recall': 0.6000471860352076, 'f1-score': 0.5570403237128368, 'support': 1407196}}
[[ 92366 206156  46718]
 [ 36809 650933  32593]
 [ 42335 198201 101085]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.933296
{'0': {'precision': 0.6026166119921579, 'recall': 0.24970440853555542, 'f1-score': 0.35309706330611224, 'support': 124327}, '1': {'precision': 0.6241816911181847, 'recall': 0.9130357826598949, 'f1-score': 0.7414698682436942, 'support': 276838}, '2': {'precision': 0.5139575871283188, 'recall': 0.2877629139178252, 'f1-score': 0.36895135576358945, 'support': 125659}, 'accuracy': 0.6073527401940686, 'macro avg': {'precision': 0.5802519634128872, 'recall': 0.4835010350377586, 'f1-score': 0.48783942910446537, 'support': 526824}, 'weighted avg': {'precision': 0.592801624386669, 'recall': 0.6073527401940686, 'f1-score': 0.5609626599934774, 'support': 526824}}
[[ 31045  73135  20147]
 [ 10026 252763  14049]
 [ 10446  79053  36160]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9754547
{'0': {'precision': 0.5594184263884081, 'recall': 0.25140571174574955, 'f1-score': 0.34690873405299316, 'support': 44995}, '1': {'precision': 0.5971669055292059, 'recall': 0.8912234262552734, 'f1-score': 0.7151472624172657, 'support': 84623}, '2': {'precision': 0.5117869353967969, 'recall': 0.31825608200353617, 'f1-score': 0.39245991223470317, 'support': 44681}, 'accuracy': 0.5791771610852615, 'macro avg': {'precision': 0.5561240891048036, 'recall': 0.48696174000151976, 'f1-score': 0.4848386362349873, 'support': 174299}, 'weighted avg': {'precision': 0.5655353111745259, 'recall': 0.5791771610852615, 'f1-score': 0.5373672058635418, 'support': 174299}}
[[11312 25425  8258]
 [ 3898 75418  5307]
 [ 5011 25450 14220]]
testing model on single stock: results/universal/W2/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 114s - 114s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2305014
{'0': {'precision': 0.4586766766654098, 'recall': 0.3378170125035128, 'f1-score': 0.389077243732653, 'support': 1206301}, '1': {'precision': 0.4238133669190065, 'recall': 0.491164201519744, 'f1-score': 0.45500996119797815, 'support': 1350359}, '2': {'precision': 0.414056510303016, 'recall': 0.44817328607426865, 'f1-score': 0.43043993056752994, 'support': 1253234}, 'accuracy': 0.4284694009859592, 'macro avg': {'precision': 0.4321821846291441, 'recall': 0.42571816669917517, 'f1-score': 0.42484237849938705, 'support': 3809894}, 'weighted avg': {'precision': 0.4316424616303322, 'recall': 0.4284694009859592, 'f1-score': 0.42605201623198746, 'support': 3809894}}
[[407509 434709 364083]
 [256364 663248 430747]
 [224572 466996 561666]]
Evaluating performance on  train set...
6147/6147 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2789645
{'0': {'precision': 0.4679269347880109, 'recall': 0.29988909270928477, 'f1-score': 0.36552033013743646, 'support': 521156}, '1': {'precision': 0.3950697856671126, 'recall': 0.581494878043191, 'f1-score': 0.470488161966091, 'support': 523628}, '2': {'precision': 0.42086726128128715, 'recall': 0.373155614063957, 'f1-score': 0.39557797690538593, 'support': 528699}, 'accuracy': 0.4182205972355596, 'macro avg': {'precision': 0.42795466057880355, 'recall': 0.41817986160547754, 'f1-score': 0.4105288230029711, 'support': 1573483}, 'weighted avg': {'precision': 0.4278690214815379, 'recall': 0.4182205972355596, 'f1-score': 0.41055134962308887, 'support': 1573483}}
[[156289 222763 142104]
 [ 89769 304487 129372]
 [ 87945 243467 197287]]
Evaluating performance on  val set...
2174/2174 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2215924
{'0': {'precision': 0.47659242906304783, 'recall': 0.3220922833885512, 'f1-score': 0.3843988530878906, 'support': 182308}, '1': {'precision': 0.42729073527454375, 'recall': 0.5850369306304471, 'f1-score': 0.4938734140558542, 'support': 186566}, '2': {'precision': 0.42640270335614244, 'recall': 0.4041859200869802, 'f1-score': 0.41499718180375506, 'support': 187629}, 'accuracy': 0.43792216753548496, 'macro avg': {'precision': 0.443428622564578, 'recall': 0.43710504470199285, 'f1-score': 0.43108981631583326, 'support': 556503}, 'weighted avg': {'precision': 0.4431423526968701, 'recall': 0.43792216753548496, 'f1-score': 0.4314163260578081, 'support': 556503}}
[[ 58720  67633  55955]
 [ 31357 109148  46061]
 [ 33131  78661  75837]]
training model: results/universal/W2/deepOF_L2/h30
Epoch 1/50
9940/9940 - 226s - loss: 2.9042 - accuracy30: 0.5077 - val_loss: 3.4410 - val_accuracy30: 0.4881 - 226s/epoch - 23ms/step
Epoch 2/50
9940/9940 - 219s - loss: 2.8267 - accuracy30: 0.5269 - val_loss: 3.4567 - val_accuracy30: 0.4893 - 219s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 218s - loss: 2.8060 - accuracy30: 0.5313 - val_loss: 3.4938 - val_accuracy30: 0.4884 - 218s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 219s - loss: 2.7959 - accuracy30: 0.5337 - val_loss: 3.5190 - val_accuracy30: 0.4891 - 219s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 218s - loss: 2.7882 - accuracy30: 0.5351 - val_loss: 3.5373 - val_accuracy30: 0.4907 - 218s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 216s - loss: 2.7825 - accuracy30: 0.5364 - val_loss: 3.5121 - val_accuracy30: 0.4919 - 216s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 215s - loss: 2.7777 - accuracy30: 0.5375 - val_loss: 3.4975 - val_accuracy30: 0.4924 - 215s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 217s - loss: 2.7733 - accuracy30: 0.5385 - val_loss: 3.5143 - val_accuracy30: 0.4922 - 217s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 215s - loss: 2.7699 - accuracy30: 0.5395 - val_loss: 3.4952 - val_accuracy30: 0.4930 - 215s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 215s - loss: 2.7666 - accuracy30: 0.5400 - val_loss: 3.5159 - val_accuracy30: 0.4930 - 215s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 218s - loss: 2.7634 - accuracy30: 0.5407 - val_loss: 3.4945 - val_accuracy30: 0.4935 - 218s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 208s - 208s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0834926
{'0': {'precision': 0.43877173787216245, 'recall': 0.3819635200457706, 'f1-score': 0.4084016030197388, 'support': 1845726}, '1': {'precision': 0.5445201271291982, 'recall': 0.7196479908705862, 'f1-score': 0.6199536436611677, 'support': 2961855}, '2': {'precision': 0.4579535706514898, 'recall': 0.2871344469864826, 'f1-score': 0.35296298461852804, 'support': 1913163}, 'accuracy': 0.5037876758882648, 'macro avg': {'precision': 0.48041514521761686, 'recall': 0.4629153193009465, 'f1-score': 0.46043941043314485, 'support': 6720744}, 'weighted avg': {'precision': 0.4908358200940851, 'recall': 0.5037876758882648, 'f1-score': 0.485851860883705, 'support': 6720744}}
[[ 705000  836039  304687]
 [ 484841 2131493  345521]
 [ 416917  946911  549335]]
Evaluating performance on  train set...
9940/9940 - 79s - 79s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1253452
{'0': {'precision': 0.4553498993694797, 'recall': 0.33290578779727914, 'f1-score': 0.3846178833618468, 'support': 746899}, '1': {'precision': 0.5033209426764987, 'recall': 0.7435564291878416, 'f1-score': 0.6002956366309191, 'support': 1042900}, '2': {'precision': 0.45173730807533624, 'recall': 0.2737948051258921, 'f1-score': 0.34094515179172463, 'support': 753820}, 'accuracy': 0.48375719791368127, 'macro avg': {'precision': 0.4701360500404382, 'recall': 0.4500856740370043, 'f1-score': 0.44195289059483017, 'support': 2543619}, 'weighted avg': {'precision': 0.47394771511764755, 'recall': 0.48375719791368127, 'f1-score': 0.46010440487789384, 'support': 2543619}}
[[248647 364299 133953]
 [150905 775455 116540]
 [146505 400923 206392]]
Evaluating performance on  val set...
3393/3393 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1052408
{'0': {'precision': 0.45836270974759785, 'recall': 0.3575797814873163, 'f1-score': 0.40174703328764916, 'support': 254539}, '1': {'precision': 0.5138947121603819, 'recall': 0.7278670899613856, 'f1-score': 0.6024457316171203, 'support': 355308}, '2': {'precision': 0.44500246598741744, 'recall': 0.28650923961027897, 'f1-score': 0.3485858590617623, 'support': 258236}, 'accuracy': 0.4879971154831969, 'macro avg': {'precision': 0.4724199626317991, 'recall': 0.4573187036863269, 'f1-score': 0.4509262079888439, 'support': 868083}, 'weighted avg': {'precision': 0.4771176776546154, 'recall': 0.4879971154831969, 'f1-score': 0.4680790823182737, 'support': 868083}}
[[ 91018 114222  49299]
 [ 53715 258617  42976]
 [ 53839 130410  73987]]
testing model out of sample: results/universal/W2/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 109s - 109s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0800481
{'0': {'precision': 0.48664772636687426, 'recall': 0.28180303275094054, 'f1-score': 0.35692281787572444, 'support': 1083175}, '1': {'precision': 0.5093677241278882, 'recall': 0.8267320749446725, 'f1-score': 0.6303580552446816, 'support': 1489312}, '2': {'precision': 0.5016312086372096, 'recall': 0.28525681740708686, 'f1-score': 0.36369525866915553, 'support': 1094221}, 'accuracy': 0.5041683166480668, 'macro avg': {'precision': 0.49921555304399073, 'recall': 0.4645973083675667, 'f1-score': 0.4503253772631872, 'support': 3666708}, 'weighted avg': {'precision': 0.5003473190965871, 'recall': 0.5041683166480668, 'f1-score': 0.4700054323554881, 'support': 3666708}}
[[ 305242  590520  187413]
 [ 135359 1231262  122691]
 [ 186633  595454  312134]]
Evaluating performance on  train set...
5373/5373 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99588156
{'0': {'precision': 0.5312435213880575, 'recall': 0.2750425896722453, 'f1-score': 0.36243857326781154, 'support': 363351}, '1': {'precision': 0.5692578751751731, 'recall': 0.870043861419024, 'f1-score': 0.6882216664763707, 'support': 644302}, '2': {'precision': 0.49796316370422067, 'recall': 0.2739472000217844, 'f1-score': 0.35344936619916245, 'support': 367235}, 'accuracy': 0.5535803643642245, 'macro avg': {'precision': 0.5328215200891505, 'recall': 0.47301121703768456, 'f1-score': 0.4680365353144482, 'support': 1374888}, 'weighted avg': {'precision': 0.5401686207559495, 'recall': 0.5535803643642245, 'f1-score': 0.5127064838631515, 'support': 1374888}}
[[ 99937 203542  59872]
 [ 42177 560571  41554]
 [ 46005 220627 100603]]
Evaluating performance on  val set...
1685/1685 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0189177
{'0': {'precision': 0.5161019322318678, 'recall': 0.2769300120208361, 'f1-score': 0.3604498288694518, 'support': 119792}, '1': {'precision': 0.5487675134487945, 'recall': 0.8608506853615151, 'f1-score': 0.6702621893718901, 'support': 191140}, '2': {'precision': 0.5026746806912096, 'recall': 0.2793873238848476, 'f1-score': 0.3591554966261736, 'support': 119737}, 'accuracy': 0.5367695376263442, 'macro avg': {'precision': 0.522514708790624, 'recall': 0.4723893404223996, 'f1-score': 0.46328917162250516, 'support': 430669}, 'weighted avg': {'precision': 0.5268664877863181, 'recall': 0.5367695376263442, 'f1-score': 0.4975912417099921, 'support': 430669}}
[[ 33174  66605  20013]
 [ 13513 164543  13084]
 [ 17591  68693  33453]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
987/987 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2850525
{'0': {'precision': 0.3311241372790016, 'recall': 0.4438797495627487, 'f1-score': 0.3792995148154566, 'support': 78902}, '1': {'precision': 0.43942375618124935, 'recall': 0.19534982839453555, 'f1-score': 0.2704629097628771, 'support': 89158}, '2': {'precision': 0.3482126181315603, 'recall': 0.4416439654151368, 'f1-score': 0.3894023413431916, 'support': 84430}, 'accuracy': 0.35537248999960397, 'macro avg': {'precision': 0.3729201705306038, 'recall': 0.3602911811241403, 'f1-score': 0.3463882553071751, 'support': 252490}, 'weighted avg': {'precision': 0.3750805627234474, 'recall': 0.35537248999960397, 'f1-score': 0.34424595867643637, 'support': 252490}}
[[35023 10150 33729]
 [35674 17417 36067]
 [35073 12069 37288]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.306153
{'0': {'precision': 0.33797787696487486, 'recall': 0.43695117667720407, 'f1-score': 0.3811441327088895, 'support': 19929}, '1': {'precision': 0.34204896600903256, 'recall': 0.14349820502592742, 'f1-score': 0.20217773094485425, 'support': 20056}, '2': {'precision': 0.3539587996509731, 'recall': 0.45394832871113705, 'f1-score': 0.3977660300136426, 'support': 20553}, 'accuracy': 0.3455019987445902, 'macro avg': {'precision': 0.34466188087496014, 'recall': 0.34479923680475616, 'f1-score': 0.32702929788912877, 'support': 60538}, 'weighted avg': {'precision': 0.3447522280474512, 'recall': 0.3455019987445902, 'f1-score': 0.3274965014941995, 'support': 60538}}
[[8708 2789 8432]
 [8581 2878 8597]
 [8476 2747 9330]]
Evaluating performance on  val set...
85/85 - 1s - 831ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.277119
{'0': {'precision': 0.339727860807495, 'recall': 0.44794117647058823, 'f1-score': 0.3864011163262717, 'support': 6800}, '1': {'precision': 0.43542234332425067, 'recall': 0.20445240532241557, 'f1-score': 0.2782517847814731, 'support': 7816}, '2': {'precision': 0.33958263586653276, 'recall': 0.4358974358974359, 'f1-score': 0.38175887592522895, 'support': 6981}, 'accuracy': 0.3559290642218827, 'macro avg': {'precision': 0.3715776133327595, 'recall': 0.3627636725634799, 'f1-score': 0.348803925677658, 'support': 21597}, 'weighted avg': {'precision': 0.37431295410925475, 'recall': 0.3559290642218827, 'f1-score': 0.34576108967470787, 'support': 21597}}
[[3046 1007 2747]
 [3047 1598 3171]
 [2873 1065 3043]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8885759
{'0': {'precision': 0.5230389129092032, 'recall': 0.28633646225011494, 'f1-score': 0.37007578075151426, 'support': 73934}, '1': {'precision': 0.6321886938232391, 'recall': 0.8792685547807814, 'f1-score': 0.7355333929293787, 'support': 167504}, '2': {'precision': 0.5467992513923651, 'recall': 0.3175912829378176, 'f1-score': 0.40180605608715464, 'support': 76356}, 'accuracy': 0.6063707936587852, 'macro avg': {'precision': 0.5673422860416024, 'recall': 0.49439876665623794, 'f1-score': 0.5024717432560158, 'support': 317794}, 'weighted avg': {'precision': 0.5862788397405625, 'recall': 0.6063707936587852, 'f1-score': 0.5703262850837835, 'support': 317794}}
[[ 21170  42729  10035]
 [ 10159 147281  10064]
 [  9146  42960  24250]]
Evaluating performance on  train set...
528/528 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7580469
{'0': {'precision': 0.5773857799405244, 'recall': 0.33418087936160223, 'f1-score': 0.4233399405351833, 'support': 25564}, '1': {'precision': 0.7168046769994266, 'recall': 0.9132199736558496, 'f1-score': 0.8031784647951848, 'support': 83510}, '2': {'precision': 0.5778927426406295, 'recall': 0.30693912303107707, 'f1-score': 0.40093016202006926, 'support': 25839}, 'accuracy': 0.6873837213611735, 'macro avg': {'precision': 0.6240277331935269, 'recall': 0.5181133253495096, 'f1-score': 0.5424828557834792, 'support': 134913}, 'weighted avg': {'precision': 0.6637819871451448, 'recall': 0.6873837213611735, 'f1-score': 0.6541647601885948, 'support': 134913}}
[[ 8543 14239  2782]
 [ 4236 76263  3011]
 [ 2017 15891  7931]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8147325
{'0': {'precision': 0.5501555209953344, 'recall': 0.3296063358956441, 'f1-score': 0.41223597960670066, 'support': 8586}, '1': {'precision': 0.6862770298493076, 'recall': 0.8946178010471204, 'f1-score': 0.776719153423761, 'support': 23875}, '2': {'precision': 0.5641321932054542, 'recall': 0.30013525144473135, 'f1-score': 0.39181380417335476, 'support': 8133}, 'accuracy': 0.6560082770852835, 'macro avg': {'precision': 0.6001882480166988, 'recall': 0.5081197961291652, 'f1-score': 0.5269229790679388, 'support': 40594}, 'weighted avg': {'precision': 0.6330143991293816, 'recall': 0.6560082770852835, 'f1-score': 0.622511937188681, 'support': 40594}}
[[ 2830  4916   840]
 [ 1470 21359  1046]
 [  844  4848  2441]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2885656
{'0': {'precision': 0.4512678093109625, 'recall': 0.2899819427871466, 'f1-score': 0.3530780703558938, 'support': 94699}, '1': {'precision': 0.3440688479939537, 'recall': 0.624778279839973, 'f1-score': 0.44375781652321045, 'support': 77237}, '2': {'precision': 0.4463640840446487, 'recall': 0.31906093554443055, 'f1-score': 0.3721261746191041, 'support': 102272}, 'accuracy': 0.39513070369938147, 'macro avg': {'precision': 0.4139002471165216, 'recall': 0.4112737193905167, 'f1-score': 0.3896540204994028, 'support': 274208}, 'weighted avg': {'precision': 0.4192437984663545, 'recall': 0.39513070369938147, 'f1-score': 0.3857245258711672, 'support': 274208}}
[[27461 42471 24767]
 [13275 48256 15706]
 [20117 49524 32631]]
Evaluating performance on  train set...
286/286 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2549094
{'0': {'precision': 0.4718652194179929, 'recall': 0.2859794979417225, 'f1-score': 0.35612514134941575, 'support': 24778}, '1': {'precision': 0.38999411995295963, 'recall': 0.6729232720355105, 'f1-score': 0.49380341548913465, 'support': 23655}, '2': {'precision': 0.43017441860465117, 'recall': 0.30077235772357724, 'f1-score': 0.35401913875598084, 'support': 24600}, 'accuracy': 0.41629126559226654, 'macro avg': {'precision': 0.4306779193252013, 'recall': 0.4198917092336034, 'f1-score': 0.4013158985315104, 'support': 73033}, 'weighted avg': {'precision': 0.431304725424133, 'recall': 0.41629126559226654, 'f1-score': 0.4000090282358445, 'support': 73033}}
[[ 7086 12098  5594]
 [ 3530 15918  4207]
 [ 4401 12800  7399]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2643864
{'0': {'precision': 0.4568081991215227, 'recall': 0.28470039541721587, 'f1-score': 0.3507807620237352, 'support': 9863}, '1': {'precision': 0.3964315254637835, 'recall': 0.6749145041239187, 'f1-score': 0.4994789340479381, 'support': 9942}, '2': {'precision': 0.4285926365795725, 'recall': 0.28858456617353057, 'f1-score': 0.34492234169653524, 'support': 10004}, 'accuracy': 0.4161494850548492, 'macro avg': {'precision': 0.42727745372162623, 'recall': 0.41606648857155504, 'f1-score': 0.3983940125894028, 'support': 29809}, 'weighted avg': {'precision': 0.42720192661406137, 'recall': 0.4161494850548492, 'f1-score': 0.3984089813303647, 'support': 29809}}
[[2808 4943 2112]
 [1495 6710 1737]
 [1844 5273 2887]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
860/860 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2725301
{'0': {'precision': 0.33797346664103056, 'recall': 0.470856102003643, 'f1-score': 0.39349913814331444, 'support': 74664}, '1': {'precision': 0.3680926149079015, 'recall': 0.12712544589774077, 'f1-score': 0.1889831631976667, 'support': 67280}, '2': {'precision': 0.35649471855680115, 'recall': 0.4236297198538368, 'f1-score': 0.3871735080092338, 'support': 77995}, 'accuracy': 0.3489603935636699, 'macro avg': {'precision': 0.3541869333685777, 'recall': 0.34053708925174014, 'f1-score': 0.3232186031167383, 'support': 219939}, 'weighted avg': {'precision': 0.35375503034080913, 'recall': 0.3489603935636699, 'f1-score': 0.32869388615685097, 'support': 219939}}
[[35156  7531 31977]
 [31062  8553 27665]
 [37802  7152 33041]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2963266
{'0': {'precision': 0.34509516069836943, 'recall': 0.46851977079403495, 'f1-score': 0.39744576785471675, 'support': 28097}, '1': {'precision': 0.35970573051109966, 'recall': 0.10245193544829614, 'f1-score': 0.15948041543875713, 'support': 27203}, '2': {'precision': 0.3158968340458826, 'recall': 0.42852810734998675, 'f1-score': 0.3636919315403423, 'support': 26381}, 'accuracy': 0.3336883730610546, 'macro avg': {'precision': 0.34023257508511723, 'recall': 0.3331666045307726, 'f1-score': 0.3068727049446054, 'support': 81681}, 'weighted avg': {'precision': 0.3405306998714506, 'recall': 0.3336883730610546, 'f1-score': 0.30729222617940843, 'support': 81681}}
[[13164  2508 12425]
 [12359  2787 12057]
 [12623  2453 11305]]
Evaluating performance on  val set...
98/98 - 1s - 955ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3029691
{'0': {'precision': 0.34713674767914887, 'recall': 0.38077803203661326, 'f1-score': 0.3631800076390026, 'support': 8740}, '1': {'precision': 0.33671875, 'recall': 0.10472603571862471, 'f1-score': 0.15976276526735242, 'support': 8231}, '2': {'precision': 0.30685188075542374, 'recall': 0.4921151439299124, 'f1-score': 0.3780042299557777, 'support': 7990}, 'accuracy': 0.3253876046632747, 'macro avg': {'precision': 0.3302357928115242, 'recall': 0.32587307056171677, 'f1-score': 0.3003156676207109, 'support': 24961}, 'weighted avg': {'precision': 0.330806207011001, 'recall': 0.3253876046632747, 'f1-score': 0.30084749749718054, 'support': 24961}}
[[3328  957 4455]
 [2942  862 4427]
 [3317  741 3932]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2438335
{'0': {'precision': 0.47384477344100495, 'recall': 0.2839433893505547, 'f1-score': 0.3550994792561656, 'support': 167389}, '1': {'precision': 0.37189806771714473, 'recall': 0.6670749049145082, 'f1-score': 0.47755596092537983, 'support': 146973}, '2': {'precision': 0.4625147837406634, 'recall': 0.33191874772147284, 'f1-score': 0.38648249788581757, 'support': 175552}, 'accuracy': 0.4160730250615414, 'macro avg': {'precision': 0.43608587496627105, 'recall': 0.4276456806621786, 'f1-score': 0.4063793126891209, 'support': 489914}, 'weighted avg': {'precision': 0.4392011104058044, 'recall': 0.4160730250615414, 'f1-score': 0.4030816723897403, 'support': 489914}}
[[47529 79862 39998]
 [21215 98042 27716]
 [31561 85722 58269]]
Evaluating performance on  train set...
716/716 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1828927
{'0': {'precision': 0.520548821441136, 'recall': 0.26234687298517084, 'f1-score': 0.3488698597104183, 'support': 62040}, '1': {'precision': 0.41402653920903115, 'recall': 0.752666723015806, 'f1-score': 0.5342003911358537, 'support': 59155}, '2': {'precision': 0.4634460329290602, 'recall': 0.3315667011375388, 'f1-score': 0.3865680779918052, 'support': 61888}, 'accuracy': 0.44417013048726534, 'macro avg': {'precision': 0.4660071311930758, 'recall': 0.4488600990461718, 'f1-score': 0.4232127762793591, 'support': 183083}, 'weighted avg': {'precision': 0.46682836142641315, 'recall': 0.44417013048726534, 'f1-score': 0.4214942700569283, 'support': 183083}}
[[16276 31103 14661]
 [ 5535 44524  9096]
 [ 9456 31912 20520]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.249101
{'0': {'precision': 0.48630250705628425, 'recall': 0.29269511342060556, 'f1-score': 0.3654398003742982, 'support': 20014}, '1': {'precision': 0.32557883939038684, 'recall': 0.6162113437803356, 'f1-score': 0.4260511050385924, 'support': 14422}, '2': {'precision': 0.45193312434691746, 'recall': 0.342269265011376, 'f1-score': 0.38952997466929357, 'support': 20218}, 'accuracy': 0.39640282504482743, 'macro avg': {'precision': 0.42127149026452954, 'recall': 0.41705857407077235, 'f1-score': 0.3936736266940614, 'support': 54654}, 'weighted avg': {'precision': 0.4311768636505765, 'recall': 0.39640282504482743, 'f1-score': 0.3903454134998639, 'support': 54654}}
[[5858 8948 5208]
 [2351 8887 3184]
 [3837 9461 6920]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/EXC
Evaluating performance on  test set...
4918/4918 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7387781
{'0': {'precision': 0.6386969704019044, 'recall': 0.3385158516838047, 'f1-score': 0.442501457240403, 'support': 243318}, '1': {'precision': 0.7089768978181705, 'recall': 0.9506766987898067, 'f1-score': 0.8122271034311772, 'support': 766737}, '2': {'precision': 0.6968991105214015, 'recall': 0.28501601823305023, 'f1-score': 0.40457144161312775, 'support': 248779}, 'accuracy': 0.7008008998803655, 'macro avg': {'precision': 0.6815243262471588, 'recall': 0.5247361895688872, 'f1-score': 0.5531000007615693, 'support': 1258834}, 'weighted avg': {'precision': 0.6930057123997803, 'recall': 0.7008008998803655, 'f1-score': 0.660199852283465, 'support': 1258834}}
[[ 82367 140759  20192]
 [ 27171 728919  10647]
 [ 19423 158450  70906]]
Evaluating performance on  train set...
1403/1403 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6830809
{'0': {'precision': 0.6055214387542494, 'recall': 0.3547029822222936, 'f1-score': 0.4473542964200719, 'support': 62269}, '1': {'precision': 0.7455364665125465, 'recall': 0.9448577773981379, 'f1-score': 0.8334457257599674, 'support': 234140}, '2': {'precision': 0.7118295428083521, 'recall': 0.2931230122580748, 'f1-score': 0.41525068770730267, 'support': 62571}, 'accuracy': 0.7288901888684607, 'macro avg': {'precision': 0.6876291493583825, 'recall': 0.5308945906261687, 'f1-score': 0.565350236629114, 'support': 358980}, 'weighted avg': {'precision': 0.7153741407936303, 'recall': 0.7288901888684607, 'f1-score': 0.6935816415782324, 'support': 358980}}
[[ 22087  35773   4409]
 [  9895 221229   3016]
 [  4494  39736  18341]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71468323
{'0': {'precision': 0.6280670499635598, 'recall': 0.3417643429981493, 'f1-score': 0.4426561652826527, 'support': 22694}, '1': {'precision': 0.7249177184537988, 'recall': 0.9470714322607303, 'f1-score': 0.8212360248794934, 'support': 77444}, '2': {'precision': 0.718063112078346, 'recall': 0.29227566657808485, 'f1-score': 0.4154495089398137, 'support': 22578}, 'accuracy': 0.7146582352749438, 'macro avg': {'precision': 0.6903492934985683, 'recall': 0.5270371472789881, 'f1-score': 0.55978056636732, 'support': 122716}, 'weighted avg': {'precision': 0.7057458714781601, 'recall': 0.7146582352749438, 'f1-score': 0.6765658979964726, 'support': 122716}}
[[ 7756 13412  1526]
 [ 3034 73345  1065]
 [ 1559 14420  6599]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/AAL
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97589487
{'0': {'precision': 0.5480835567016139, 'recall': 0.27782571182053495, 'f1-score': 0.3687371242369654, 'support': 348859}, '1': {'precision': 0.5522720282861271, 'recall': 0.899226509783012, 'f1-score': 0.6842826712139115, 'support': 555146}, '2': {'precision': 0.5681195885443647, 'recall': 0.27183640950736954, 'f1-score': 0.36772304615697804, 'support': 338895}, 'accuracy': 0.5537436640115858, 'macro avg': {'precision': 0.5561583911773685, 'recall': 0.4829628770369721, 'f1-score': 0.4735809472026183, 'support': 1242900}, 'weighted avg': {'precision': 0.5554174727508577, 'recall': 0.5537436640115858, 'f1-score': 0.5094002364995339, 'support': 1242900}}
[[ 96922 205325  46612]
 [ 32524 499202  23420]
 [ 47392 199379  92124]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8284999
{'0': {'precision': 0.5719700850322713, 'recall': 0.29670767677304494, 'f1-score': 0.39072697051876476, 'support': 112899}, '1': {'precision': 0.6633810265651061, 'recall': 0.9138990538357564, 'f1-score': 0.7687452596958718, 'support': 303330}, '2': {'precision': 0.5570635859183116, 'recall': 0.2658337746676969, 'f1-score': 0.3599144264337686, 'support': 115181}, 'accuracy': 0.6423100807286276, 'macro avg': {'precision': 0.5974715658385631, 'recall': 0.49214683509216606, 'f1-score': 0.5064622188828017, 'support': 531410}, 'weighted avg': {'precision': 0.6209167277764985, 'recall': 0.6423100807286276, 'f1-score': 0.5998221475305596, 'support': 531410}}
[[ 33498  66179  13222]
 [ 14993 277213  11124]
 [ 10075  74487  30619]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8052951
{'0': {'precision': 0.6185066046129628, 'recall': 0.2828570534289023, 'f1-score': 0.3881872852233677, 'support': 31949}, '1': {'precision': 0.6656930624598286, 'recall': 0.9442809495781832, 'f1-score': 0.7808837564420692, 'support': 86649}, '2': {'precision': 0.6322333437597748, 'recall': 0.2549508072653885, 'f1-score': 0.36337078651685395, 'support': 31712}, 'accuracy': 0.6582595968332113, 'macro avg': {'precision': 0.6388110036108553, 'recall': 0.494029603424158, 'f1-score': 0.5108139427274302, 'support': 150310}, 'weighted avg': {'precision': 0.6486041479420612, 'recall': 0.6582595968332113, 'f1-score': 0.6093287643508264, 'support': 150310}}
[[ 9037 20004  2908]
 [ 3033 81821  1795]
 [ 2541 21086  8085]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/WBA
Evaluating performance on  test set...
4353/4353 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.903255
{'0': {'precision': 0.625474420501239, 'recall': 0.287188959339231, 'f1-score': 0.39363768040842817, 'support': 277737}, '1': {'precision': 0.6025365767281259, 'recall': 0.9308073554977271, 'f1-score': 0.7315325228578279, 'support': 555666}, '2': {'precision': 0.573295003038377, 'recall': 0.26198732554827686, 'f1-score': 0.3596293599323621, 'support': 280880}, 'accuracy': 0.6017932607784557, 'macro avg': {'precision': 0.6004353334225806, 'recall': 0.4933278801284116, 'f1-score': 0.4949331877328727, 'support': 1114283}, 'weighted avg': {'precision': 0.6008828807622325, 'recall': 0.6017932607784557, 'f1-score': 0.5535651121911715, 'support': 1114283}}
[[ 79763 160674  37300]
 [ 20977 517218  17471]
 [ 26784 180509  73587]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9840173
{'0': {'precision': 0.5810361450524368, 'recall': 0.2716776300657804, 'f1-score': 0.3702403490515177, 'support': 108695}, '1': {'precision': 0.5555210195042349, 'recall': 0.9159870312186643, 'f1-score': 0.6916034868926066, 'support': 179508}, '2': {'precision': 0.5783213268554197, 'recall': 0.25964892486766517, 'f1-score': 0.3583910298421268, 'support': 106359}, 'accuracy': 0.5615670034113777, 'macro avg': {'precision': 0.5716261638040304, 'recall': 0.4824378620507033, 'f1-score': 0.4734116219287503, 'support': 394562}, 'weighted avg': {'precision': 0.5686960958193045, 'recall': 0.5615670034113777, 'f1-score': 0.5132520237839718, 'support': 394562}}
[[ 29530  65338  13827]
 [  8772 164427   6309]
 [ 12521  66222  27616]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97399557
{'0': {'precision': 0.6064228619933508, 'recall': 0.25897172547124214, 'f1-score': 0.3629474397239686, 'support': 33104}, '1': {'precision': 0.5596812514455121, 'recall': 0.9268776767993314, 'f1-score': 0.697928683796539, 'support': 57438}, '2': {'precision': 0.580711743772242, 'recall': 0.2490005188146611, 'f1-score': 0.34854860413952193, 'support': 32767}, 'accuracy': 0.5674362779683559, 'macro avg': {'precision': 0.5822719524037017, 'recall': 0.47828330702841154, 'f1-score': 0.4698082425533432, 'support': 123309}, 'weighted avg': {'precision': 0.5778181304863413, 'recall': 0.5674362779683559, 'f1-score': 0.5151573031682001, 'support': 123309}}
[[ 8573 20700  3831]
 [ 2140 53238  2060]
 [ 3424 21184  8159]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0374774
{'0': {'precision': 0.5378633252927886, 'recall': 0.2505733157736839, 'f1-score': 0.34187705094317367, 'support': 393326}, '1': {'precision': 0.531317526898604, 'recall': 0.9157245996282205, 'f1-score': 0.6724621497543681, 'support': 620798}, '2': {'precision': 0.5964327918241199, 'recall': 0.23369509911670128, 'f1-score': 0.33581191988096937, 'support': 393072}, 'accuracy': 0.5392965869715377, 'macro avg': {'precision': 0.5552045480051708, 'recall': 0.46666433817286856, 'f1-score': 0.45005037352617033, 'support': 1407196}, 'weighted avg': {'precision': 0.5513357902492626, 'recall': 0.5392965869715377, 'f1-score': 0.48602366234265826, 'support': 1407196}}
[[ 98557 252489  42280]
 [ 32443 568480  19875]
 [ 52238 248975  91859]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0277694
{'0': {'precision': 0.5976551628165878, 'recall': 0.2390870185449358, 'f1-score': 0.34154269780757773, 'support': 143705}, '1': {'precision': 0.5367626802540317, 'recall': 0.9246806044366794, 'f1-score': 0.6792381816190569, 'support': 238106}, '2': {'precision': 0.5539044141265574, 'recall': 0.2259383641466627, 'f1-score': 0.3209576614878235, 'support': 145013}, 'accuracy': 0.545332027394348, 'macro avg': {'precision': 0.5627740857323923, 'recall': 0.4632353290427593, 'f1-score': 0.4472461803048194, 'support': 526824}, 'weighted avg': {'precision': 0.5580911095980038, 'recall': 0.545332027394348, 'f1-score': 0.4885030166172362, 'support': 526824}}
[[ 34358  91463  17884]
 [  9431 220172   8503]
 [ 13699  98550  32764]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0564272
{'0': {'precision': 0.5542701447203859, 'recall': 0.2425243325645937, 'f1-score': 0.3374119694374201, 'support': 51166}, '1': {'precision': 0.5080251221214236, 'recall': 0.9060862109499246, 'f1-score': 0.6510301518772263, 'support': 72311}, '2': {'precision': 0.5511965476657513, 'recall': 0.2488095706583763, 'f1-score': 0.34285481881159935, 'support': 50822}, 'accuracy': 0.5196472727898611, 'macro avg': {'precision': 0.5378306048358535, 'recall': 0.4658067047242982, 'f1-score': 0.4437656467087486, 'support': 174299}, 'weighted avg': {'precision': 0.5341883876324841, 'recall': 0.5196472727898611, 'f1-score': 0.4691090008678894, 'support': 174299}}
[[12409 31715  7042]
 [ 3537 65520  3254]
 [ 6442 31735 12645]]
testing model on single stock: results/universal/W2/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 120s - 120s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.255364
{'0': {'precision': 0.40372292261614545, 'recall': 0.41399215865001576, 'f1-score': 0.40879305777643815, 'support': 1176073}, '1': {'precision': 0.4117206644608314, 'recall': 0.5191134132763044, 'f1-score': 0.4592219484792149, 'support': 1404668}, '2': {'precision': 0.41768826409684384, 'recall': 0.28301602811041426, 'f1-score': 0.3374104449129219, 'support': 1229153}, 'accuracy': 0.41049357278706444, 'macro avg': {'precision': 0.41104395039127356, 'recall': 0.40537386667891145, 'f1-score': 0.4018084837228583, 'support': 3809894}, 'weighted avg': {'precision': 0.4111771230265811, 'recall': 0.41049357278706444, 'f1-score': 0.4043561092147875, 'support': 3809894}}
[[486885 484075 205113]
 [395623 729182 279863]
 [323480 557803 347870]]
Evaluating performance on  train set...
6147/6147 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2840997
{'0': {'precision': 0.4314950738916256, 'recall': 0.33543121043743324, 'f1-score': 0.3774467452497862, 'support': 522274}, '1': {'precision': 0.3723095869988729, 'recall': 0.5981613726257813, 'f1-score': 0.45895492573444335, 'support': 518539}, '2': {'precision': 0.4232414036472819, 'recall': 0.2656917040569208, 'f1-score': 0.3264518093410345, 'support': 532670}, 'accuracy': 0.398404685655962, 'macro avg': {'precision': 0.4090153548459268, 'recall': 0.3997614290400451, 'f1-score': 0.38761782677508805, 'support': 1573483}, 'weighted avg': {'precision': 0.40919647535771353, 'recall': 0.398404685655962, 'f1-score': 0.38704436904986467, 'support': 1573483}}
[[175187 246636 100451]
 [115960 310170  92409]
 [114853 276291 141526]]
Evaluating performance on  val set...
2174/2174 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2326475
{'0': {'precision': 0.43601052404133356, 'recall': 0.37818261995976077, 'f1-score': 0.40504296437985765, 'support': 181415}, '1': {'precision': 0.40144261527943814, 'recall': 0.5830872982158029, 'f1-score': 0.4755083349391903, 'support': 188320}, '2': {'precision': 0.4207119998726297, 'recall': 0.2829660327250921, 'f1-score': 0.33835703264550904, 'support': 186768}, 'accuracy': 0.41556649290300324, 'macro avg': {'precision': 0.4193883797311338, 'recall': 0.41474531696688527, 'f1-score': 0.40630277732151904, 'support': 556503}, 'weighted avg': {'precision': 0.4191784434595925, 'recall': 0.41556649290300324, 'f1-score': 0.40650789895446493, 'support': 556503}}
[[ 68608  74364  38443]
 [ 44187 109807  34326]
 [ 44559  89360  52849]]
training model: results/universal/W2/deepVOL_L2/h10
Epoch 1/50
9940/9940 - 322s - loss: 2.7966 - accuracy10: 0.5226 - val_loss: 2.9577 - val_accuracy10: 0.5518 - 322s/epoch - 32ms/step
Epoch 2/50
9940/9940 - 313s - loss: 2.7039 - accuracy10: 0.5545 - val_loss: 2.8820 - val_accuracy10: 0.5608 - 313s/epoch - 32ms/step
Epoch 3/50
9940/9940 - 308s - loss: 2.6597 - accuracy10: 0.5645 - val_loss: 2.8914 - val_accuracy10: 0.5607 - 308s/epoch - 31ms/step
Epoch 4/50
9940/9940 - 308s - loss: 2.6348 - accuracy10: 0.5697 - val_loss: 2.8826 - val_accuracy10: 0.5706 - 308s/epoch - 31ms/step
Epoch 5/50
9940/9940 - 312s - loss: 2.6172 - accuracy10: 0.5728 - val_loss: 2.9013 - val_accuracy10: 0.5682 - 312s/epoch - 31ms/step
Epoch 6/50
9940/9940 - 310s - loss: 2.6043 - accuracy10: 0.5754 - val_loss: 2.8772 - val_accuracy10: 0.5697 - 310s/epoch - 31ms/step
Epoch 7/50
9940/9940 - 310s - loss: 2.5936 - accuracy10: 0.5773 - val_loss: 2.8771 - val_accuracy10: 0.5702 - 310s/epoch - 31ms/step
Epoch 8/50
9940/9940 - 313s - loss: 2.5857 - accuracy10: 0.5789 - val_loss: 2.8870 - val_accuracy10: 0.5652 - 313s/epoch - 32ms/step
Epoch 9/50
9940/9940 - 311s - loss: 2.5790 - accuracy10: 0.5800 - val_loss: 2.8694 - val_accuracy10: 0.5685 - 311s/epoch - 31ms/step
Epoch 10/50
9940/9940 - 315s - loss: 2.5730 - accuracy10: 0.5812 - val_loss: 2.8606 - val_accuracy10: 0.5679 - 315s/epoch - 32ms/step
Epoch 11/50
9940/9940 - 309s - loss: 2.5674 - accuracy10: 0.5823 - val_loss: 2.8518 - val_accuracy10: 0.5701 - 309s/epoch - 31ms/step
Epoch 12/50
9940/9940 - 310s - loss: 2.5629 - accuracy10: 0.5833 - val_loss: 2.8499 - val_accuracy10: 0.5701 - 310s/epoch - 31ms/step
Epoch 13/50
9940/9940 - 316s - loss: 2.5581 - accuracy10: 0.5840 - val_loss: 2.8422 - val_accuracy10: 0.5721 - 316s/epoch - 32ms/step
Epoch 14/50
9940/9940 - 316s - loss: 2.5547 - accuracy10: 0.5849 - val_loss: 2.8305 - val_accuracy10: 0.5721 - 316s/epoch - 32ms/step
Epoch 15/50
9940/9940 - 332s - loss: 2.5513 - accuracy10: 0.5854 - val_loss: 2.8219 - val_accuracy10: 0.5712 - 332s/epoch - 33ms/step
Epoch 16/50
9940/9940 - 330s - loss: 2.5478 - accuracy10: 0.5859 - val_loss: 2.8198 - val_accuracy10: 0.5726 - 330s/epoch - 33ms/step
Epoch 17/50
9940/9940 - 328s - loss: 2.5449 - accuracy10: 0.5867 - val_loss: 2.8111 - val_accuracy10: 0.5709 - 328s/epoch - 33ms/step
Epoch 18/50
9940/9940 - 329s - loss: 2.5421 - accuracy10: 0.5872 - val_loss: 2.8017 - val_accuracy10: 0.5717 - 329s/epoch - 33ms/step
Epoch 19/50
9940/9940 - 329s - loss: 2.5398 - accuracy10: 0.5875 - val_loss: 2.8036 - val_accuracy10: 0.5719 - 329s/epoch - 33ms/step
Epoch 20/50
9940/9940 - 329s - loss: 2.5371 - accuracy10: 0.5883 - val_loss: 2.8006 - val_accuracy10: 0.5701 - 329s/epoch - 33ms/step
Epoch 21/50
9940/9940 - 328s - loss: 2.5343 - accuracy10: 0.5885 - val_loss: 2.7975 - val_accuracy10: 0.5717 - 328s/epoch - 33ms/step
Epoch 22/50
9940/9940 - 327s - loss: 2.5320 - accuracy10: 0.5891 - val_loss: 2.7986 - val_accuracy10: 0.5716 - 327s/epoch - 33ms/step
Epoch 23/50
9940/9940 - 330s - loss: 2.5297 - accuracy10: 0.5897 - val_loss: 2.7952 - val_accuracy10: 0.5721 - 330s/epoch - 33ms/step
Epoch 24/50
9940/9940 - 331s - loss: 2.5275 - accuracy10: 0.5900 - val_loss: 2.7882 - val_accuracy10: 0.5745 - 331s/epoch - 33ms/step
Epoch 25/50
9940/9940 - 328s - loss: 2.5258 - accuracy10: 0.5902 - val_loss: 2.7824 - val_accuracy10: 0.5743 - 328s/epoch - 33ms/step
Epoch 26/50
9940/9940 - 330s - loss: 2.5241 - accuracy10: 0.5906 - val_loss: 2.7962 - val_accuracy10: 0.5720 - 330s/epoch - 33ms/step
Epoch 27/50
9940/9940 - 325s - loss: 2.5223 - accuracy10: 0.5909 - val_loss: 2.8046 - val_accuracy10: 0.5737 - 325s/epoch - 33ms/step
Epoch 28/50
9940/9940 - 328s - loss: 2.5204 - accuracy10: 0.5914 - val_loss: 2.7899 - val_accuracy10: 0.5732 - 328s/epoch - 33ms/step
Epoch 29/50
9940/9940 - 328s - loss: 2.5189 - accuracy10: 0.5915 - val_loss: 2.7927 - val_accuracy10: 0.5742 - 328s/epoch - 33ms/step
Epoch 30/50
9940/9940 - 330s - loss: 2.5170 - accuracy10: 0.5921 - val_loss: 2.7893 - val_accuracy10: 0.5739 - 330s/epoch - 33ms/step
Epoch 31/50
9940/9940 - 327s - loss: 2.5155 - accuracy10: 0.5923 - val_loss: 2.7969 - val_accuracy10: 0.5745 - 327s/epoch - 33ms/step
Epoch 32/50
9940/9940 - 336s - loss: 2.5138 - accuracy10: 0.5925 - val_loss: 2.7828 - val_accuracy10: 0.5732 - 336s/epoch - 34ms/step
Epoch 33/50
9940/9940 - 329s - loss: 2.5126 - accuracy10: 0.5930 - val_loss: 2.7843 - val_accuracy10: 0.5732 - 329s/epoch - 33ms/step
Epoch 34/50
9940/9940 - 326s - loss: 2.5108 - accuracy10: 0.5932 - val_loss: 2.7944 - val_accuracy10: 0.5721 - 326s/epoch - 33ms/step
Epoch 35/50
9940/9940 - 330s - loss: 2.5097 - accuracy10: 0.5932 - val_loss: 2.7944 - val_accuracy10: 0.5740 - 330s/epoch - 33ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 427s - 427s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89430207
{'0': {'precision': 0.44143485900179186, 'recall': 0.5281480271436076, 'f1-score': 0.48091391303548786, 'support': 1585493}, '1': {'precision': 0.7709791962975383, 'recall': 0.6108983626054771, 'f1-score': 0.681666657927265, 'support': 3511188}, '2': {'precision': 0.44594723661531843, 'recall': 0.5606112476663826, 'f1-score': 0.4967481584355151, 'support': 1624088}, 'accuracy': 0.5792247881157647, 'macro avg': {'precision': 0.5527870973048828, 'recall': 0.5665525458051558, 'f1-score': 0.5531095764660893, 'support': 6720769}, 'weighted avg': {'precision': 0.6146919105258623, 'recall': 0.5792247881157647, 'f1-score': 0.5896212405413593, 'support': 6720769}}
[[ 837375  295775  452343]
 [ 687353 2144979  678856]
 [ 372211  341395  910482]]
Evaluating performance on  train set...
9940/9940 - 165s - 165s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91525626
{'0': {'precision': 0.44638347401177697, 'recall': 0.5472719940982295, 'f1-score': 0.4917059922582239, 'support': 639808}, '1': {'precision': 0.765921128599041, 'recall': 0.5804917336242049, 'f1-score': 0.660437665495422, 'support': 1261496}, '2': {'precision': 0.4490408069498694, 'recall': 0.5614569062149707, 'f1-score': 0.49899580958917095, 'support': 642320}, 'accuracy': 0.5673291335511852, 'macro avg': {'precision': 0.5537818031868958, 'recall': 0.5630735446458016, 'f1-score': 0.5503798224476056, 'support': 2543624}, 'weighted avg': {'precision': 0.6055274084942361, 'recall': 0.5673291335511852, 'f1-score': 0.5772283518247504, 'support': 2543624}}
[[350149 106020 183639]
 [270359 732288 258849]
 [163905 117780 360635]]
Evaluating performance on  val set...
3393/3393 - 55s - 55s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90645164
{'0': {'precision': 0.4543969237950937, 'recall': 0.5250306254913791, 'f1-score': 0.4871668175870691, 'support': 218772}, '1': {'precision': 0.7634494090210421, 'recall': 0.6077793848411469, 'f1-score': 0.676778104790556, 'support': 426589}, '2': {'precision': 0.45282587721525414, 'recall': 0.5605317744672826, 'f1-score': 0.5009550025279478, 'support': 222726}, 'accuracy': 0.574802986336623, 'macro avg': {'precision': 0.55689073667713, 'recall': 0.5644472615999362, 'f1-score': 0.5549666416351909, 'support': 868087}, 'weighted avg': {'precision': 0.6058661632831989, 'recall': 0.574802986336623, 'f1-score': 0.5838818665118778, 'support': 868087}}
[[114862  37898  66012]
 [ 82472 259272  84845]
 [ 55445  42436 124845]]
testing model out of sample: results/universal/W2/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 231s - 231s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85469884
{'0': {'precision': 0.4684240232700838, 'recall': 0.4797530840507264, 'f1-score': 0.474020872413315, 'support': 833806}, '1': {'precision': 0.7558112620754522, 'recall': 0.7147832074178216, 'f1-score': 0.7347249147413912, 'support': 2010078}, '2': {'precision': 0.46912744832457226, 'recall': 0.5198389984067551, 'f1-score': 0.4931830471462189, 'support': 822849}, 'accuracy': 0.6175906454055967, 'macro avg': {'precision': 0.5644542445567028, 'recall': 0.5714584299584343, 'f1-score': 0.5673096114336417, 'support': 3666733}, 'weighted avg': {'precision': 0.6261256008886554, 'recall': 0.6175906454055967, 'f1-score': 0.621237219038916, 'support': 3666733}}
[[ 400021  227210  206575]
 [ 295835 1436770  277473]
 [ 158116  236984  427749]]
Evaluating performance on  train set...
5373/5373 - 88s - 88s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7547383
{'0': {'precision': 0.48142377263878455, 'recall': 0.49232521083220926, 'f1-score': 0.48681346915334156, 'support': 261701}, '1': {'precision': 0.7894106262926023, 'recall': 0.7923461283371216, 'f1-score': 0.7908756533902672, 'support': 847362}, '2': {'precision': 0.4763546145697015, 'recall': 0.4600890045856547, 'f1-score': 0.46808054636506113, 'support': 265829}, 'accuracy': 0.670998885730661, 'macro avg': {'precision': 0.5823963378336962, 'recall': 0.5815867812516619, 'f1-score': 0.5819232229695567, 'support': 1374892}, 'weighted avg': {'precision': 0.6702595699708368, 'recall': 0.670998885730661, 'f1-score': 0.6705886212580043, 'support': 1374892}}
[[128842  78801  54058]
 [ 95569 671404  80389]
 [ 43216 100308 122305]]
Evaluating performance on  val set...
1685/1685 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78524345
{'0': {'precision': 0.48451824555096173, 'recall': 0.48561487270147624, 'f1-score': 0.4850659393189551, 'support': 88807}, '1': {'precision': 0.7776236085122578, 'recall': 0.7736853730495559, 'f1-score': 0.7756494918739373, 'support': 253532}, '2': {'precision': 0.4740203095642838, 'recall': 0.4798319993660353, 'f1-score': 0.4769084495552718, 'support': 88333}, 'accuracy': 0.6540127986031132, 'macro avg': {'precision': 0.5787207212091677, 'recall': 0.5797107483723558, 'f1-score': 0.579207960249388, 'support': 430672}, 'weighted avg': {'precision': 0.6549130580829863, 'recall': 0.6540127986031132, 'f1-score': 0.6544562263658824, 'support': 430672}}
[[ 43126  25971  19710]
 [ 30057 196154  27321]
 [ 15825  30123  42385]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
987/987 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4077924
{'0': {'precision': 0.32864600688659334, 'recall': 0.4226857142857143, 'f1-score': 0.3697806661251016, 'support': 70000}, '1': {'precision': 0.5996892801657172, 'recall': 0.051185035228387805, 'f1-score': 0.09431964422434719, 'support': 113119}, '2': {'precision': 0.32166743014200644, 'recall': 0.7085159132841329, 'f1-score': 0.4424581206736698, 'support': 69376}, 'accuracy': 0.33478682746192995, 'macro avg': {'precision': 0.41666757239810565, 'recall': 0.3941288875994116, 'f1-score': 0.30218614367437285, 'support': 252495}, 'weighted avg': {'precision': 0.44815727756454243, 'recall': 0.33478682746192995, 'f1-score': 0.26634176931672926, 'support': 252495}}
[[29588  1496 38916]
 [42589  5790 64740]
 [17853  2369 49154]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3890228
{'0': {'precision': 0.35969132567998857, 'recall': 0.4366506679003065, 'f1-score': 0.3944522802068641, 'support': 17293}, '1': {'precision': 0.5865939704939064, 'recall': 0.071131334344495, 'f1-score': 0.12687731955187126, 'support': 25713}, '2': {'precision': 0.3386406061271549, 'recall': 0.7035875206752981, 'f1-score': 0.45721910268527266, 'support': 17533}, 'accuracy': 0.3587109136259271, 'macro avg': {'precision': 0.42830863410034997, 'recall': 0.4037898409733665, 'f1-score': 0.32618290081466933, 'support': 60539}, 'weighted avg': {'precision': 0.4499680966900884, 'recall': 0.3587109136259271, 'f1-score': 0.2989821821740606, 'support': 60539}}
[[ 7551   542  9200]
 [ 8992  1829 14892]
 [ 4450   747 12336]]
Evaluating performance on  val set...
85/85 - 1s - 747ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3978584
{'0': {'precision': 0.3364546755104695, 'recall': 0.45179881243450926, 'f1-score': 0.3856876630637346, 'support': 5726}, '1': {'precision': 0.6130584192439863, 'recall': 0.08940563295579834, 'f1-score': 0.15605318404478657, 'support': 9977}, '2': {'precision': 0.3300417469492614, 'recall': 0.6971341360013567, 'f1-score': 0.4479921538713017, 'support': 5897}, 'accuracy': 0.35138888888888886, 'macro avg': {'precision': 0.42651828056790575, 'recall': 0.41277952713055477, 'f1-score': 0.32991100032660764, 'support': 21600}, 'weighted avg': {'precision': 0.4624666436356479, 'recall': 0.35138888888888886, 'f1-score': 0.29662962533781695, 'support': 21600}}
[[2587  246 2893]
 [3633  892 5452]
 [1469  317 4111]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71656406
{'0': {'precision': 0.4211762285949365, 'recall': 0.4886736540641594, 'f1-score': 0.45242128521450925, 'support': 50281}, '1': {'precision': 0.8268280283559748, 'recall': 0.8081201693043798, 'f1-score': 0.8173670666958274, 'support': 217360}, '2': {'precision': 0.48923816410736315, 'recall': 0.45861078990390364, 'f1-score': 0.4734296534123652, 'support': 50158}, 'accuracy': 0.7024156778341026, 'macro avg': {'precision': 0.5790808070194248, 'recall': 0.5851348710908143, 'f1-score': 0.5810726684409006, 'support': 317799}, 'weighted avg': {'precision': 0.7093656997936866, 'recall': 0.7024156778341026, 'f1-score': 0.7053432667023282, 'support': 317799}}
[[ 24571  17362   8348]
 [ 26040 175653  15667]
 [  7728  19427  23003]]
Evaluating performance on  train set...
528/528 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5668139
{'0': {'precision': 0.4426033574183734, 'recall': 0.5071904376517462, 'f1-score': 0.47270089933275306, 'support': 16063}, '1': {'precision': 0.8737407591833608, 'recall': 0.8886756985770359, 'f1-score': 0.8811449485999585, 'support': 102673}, '2': {'precision': 0.5263680768275519, 'recall': 0.39300284336753616, 'f1-score': 0.4500123863113564, 'support': 16178}, 'accuracy': 0.7838178395125783, 'macro avg': {'precision': 0.614237397809762, 'recall': 0.5962896598654394, 'f1-score': 0.601286078081356, 'support': 134914}, 'weighted avg': {'precision': 0.7807544468680838, 'recall': 0.7838178395125783, 'f1-score': 0.7808165960488213, 'support': 134914}}
[[ 8147  5595  2321]
 [ 8030 91243  3400]
 [ 2230  7590  6358]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62036246
{'0': {'precision': 0.44437140509449463, 'recall': 0.502789140944589, 'f1-score': 0.47177876646602107, 'support': 5378}, '1': {'precision': 0.8606497717197115, 'recall': 0.8665844964855591, 'f1-score': 0.8636069383351315, 'support': 30019}, '2': {'precision': 0.5042016806722689, 'recall': 0.41554444016929587, 'f1-score': 0.455600084370386, 'support': 5198}, 'accuracy': 0.7606355462495381, 'macro avg': {'precision': 0.603074285828825, 'recall': 0.594972692533148, 'f1-score': 0.5969952630571795, 'support': 40595}, 'weighted avg': {'precision': 0.7598599642809869, 'recall': 0.7606355462495381, 'f1-score': 0.7594544186844152, 'support': 40595}}
[[ 2704  1952   722]
 [ 2603 26014  1402]
 [  778  2260  2160]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.069166
{'0': {'precision': 0.4963304298960382, 'recall': 0.4781657733744789, 'f1-score': 0.48707880659570946, 'support': 92355}, '1': {'precision': 0.5385169556939227, 'recall': 0.49369029366670597, 'f1-score': 0.5151302592879733, 'support': 84790}, '2': {'precision': 0.4932189831265232, 'recall': 0.5462562327440557, 'f1-score': 0.5183845454456577, 'support': 97068}, 'accuracy': 0.5070693220233906, 'macro avg': {'precision': 0.509355456238828, 'recall': 0.5060374332617469, 'f1-score': 0.5068645371097801, 'support': 274213}, 'weighted avg': {'precision': 0.5082736040248335, 'recall': 0.5070693220233906, 'f1-score': 0.5068345006454585, 'support': 274213}}
[[44161 15699 32495]
 [20943 41860 21987]
 [23871 20173 53024]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0607976
{'0': {'precision': 0.4945941155618575, 'recall': 0.48305708226944216, 'f1-score': 0.4887575259989054, 'support': 23107}, '1': {'precision': 0.5669873342495264, 'recall': 0.560533176660669, 'f1-score': 0.5637417829972671, 'support': 27233}, '2': {'precision': 0.4763644085793162, 'recall': 0.49418399718011985, 'f1-score': 0.48511061611989365, 'support': 22696}, 'accuracy': 0.5154033627252314, 'macro avg': {'precision': 0.5126486194635668, 'recall': 0.5125914187034103, 'f1-score': 0.5125366417053554, 'support': 73036}, 'weighted avg': {'precision': 0.5159225439375288, 'recall': 0.5154033627252314, 'f1-score': 0.5155836939739087, 'support': 73036}}
[[11162  5199  6746]
 [ 6385 15265  5583]
 [ 5021  6459 11216]]
Evaluating performance on  val set...
117/117 - 1s - 949ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0773658
{'0': {'precision': 0.4777801179443976, 'recall': 0.4928843020097773, 'f1-score': 0.48521469440136883, 'support': 9205}, '1': {'precision': 0.5865159781761496, 'recall': 0.5228871710240598, 'f1-score': 0.5528768884603021, 'support': 11513}, '2': {'precision': 0.46123992437058414, 'recall': 0.5098449015509845, 'f1-score': 0.48432601880877746, 'support': 9091}, 'accuracy': 0.5096447381663256, 'macro avg': {'precision': 0.5085120068303771, 'recall': 0.5085387915282739, 'f1-score': 0.5074725338901495, 'support': 29809}, 'weighted avg': {'precision': 0.5147323491184935, 'recall': 0.5096447381663256, 'f1-score': 0.5110765445267756, 'support': 29809}}
[[4537 1917 2751]
 [2830 6020 2663]
 [2129 2327 4635]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2483661
{'0': {'precision': 0.3629882150253844, 'recall': 0.2536663464617355, 'f1-score': 0.2986368708344642, 'support': 78075}, '1': {'precision': 0.32531785516860146, 'recall': 0.09002049744546761, 'f1-score': 0.1410188823924087, 'support': 65374}, '2': {'precision': 0.3506819740245633, 'recall': 0.6752467481534741, 'f1-score': 0.4616243945162386, 'support': 76495}, 'accuracy': 0.3516486014621904, 'macro avg': {'precision': 0.3463293480728497, 'recall': 0.33964453068689243, 'f1-score': 0.3004267159143705, 'support': 219944}, 'weighted avg': {'precision': 0.3475114208839887, 'recall': 0.3516486014621904, 'f1-score': 0.3084739759504319, 'support': 219944}}
[[19805  6302 51968]
 [15817  5885 43672]
 [18939  5903 51653]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2983799
{'0': {'precision': 0.362513833071233, 'recall': 0.22320243858705396, 'f1-score': 0.2762906734141253, 'support': 27885}, '1': {'precision': 0.3276001074979844, 'recall': 0.044893750230177144, 'f1-score': 0.0789661203601736, 'support': 27153}, '2': {'precision': 0.3277898407685222, 'recall': 0.7478982134814592, 'f1-score': 0.45580767647193376, 'support': 26644}, 'accuracy': 0.335079944173747, 'macro avg': {'precision': 0.3393012604459132, 'recall': 0.3386648007662301, 'f1-score': 0.2703548234154109, 'support': 81682}, 'weighted avg': {'precision': 0.3395810150525282, 'recall': 0.335079944173747, 'f1-score': 0.2692523717123832, 'support': 81682}}
[[ 6224  1284 20377]
 [ 5446  1219 20488]
 [ 5499  1218 19927]]
Evaluating performance on  val set...
98/98 - 1s - 854ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2799516
{'0': {'precision': 0.37284927735719203, 'recall': 0.24282832810398924, 'f1-score': 0.2941096634093377, 'support': 8924}, '1': {'precision': 0.34441260744985674, 'recall': 0.07326587833719371, 'f1-score': 0.12082830719742661, 'support': 8203}, '2': {'precision': 0.3154447253504941, 'recall': 0.7007914220066377, 'f1-score': 0.4350582455028132, 'support': 7834}, 'accuracy': 0.33083610432274346, 'macro avg': {'precision': 0.34423553671918095, 'recall': 0.3389618761492736, 'f1-score': 0.28333207203652583, 'support': 24961}, 'weighted avg': {'precision': 0.34548766269149983, 'recall': 0.33083610432274346, 'f1-score': 0.2814004060524201, 'support': 24961}}
[[2167  595 6162]
 [1850  601 5752]
 [1795  549 5490]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.018044
{'0': {'precision': 0.5079217211554153, 'recall': 0.49072705413981355, 'f1-score': 0.4991763593412211, 'support': 152217}, '1': {'precision': 0.588769002931665, 'recall': 0.5363305985353229, 'f1-score': 0.5613277816997796, 'support': 181610}, '2': {'precision': 0.4908240333671514, 'recall': 0.5578889372933911, 'f1-score': 0.5222120943174459, 'support': 156092}, 'accuracy': 0.5290303090919111, 'macro avg': {'precision': 0.5291715858180772, 'recall': 0.5283155299895091, 'f1-score': 0.5275720784528155, 'support': 489919}, 'weighted avg': {'precision': 0.5324438616748461, 'recall': 0.5290303090919111, 'f1-score': 0.5295548785626571, 'support': 489919}}
[[74697 30011 47509]
 [41378 97403 42829]
 [30989 38021 87082]]
Evaluating performance on  train set...
716/716 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9678413
{'0': {'precision': 0.5064331399672766, 'recall': 0.5157832945141927, 'f1-score': 0.5110654545795691, 'support': 52809}, '1': {'precision': 0.6272579026593076, 'recall': 0.654352975045473, 'f1-score': 0.6405190247151576, 'support': 76419}, '2': {'precision': 0.5092882067004175, 'recall': 0.46885154581747285, 'f1-score': 0.48823404296459577, 'support': 53855}, 'accuracy': 0.5598171321204044, 'macro avg': {'precision': 0.5476597497756672, 'recall': 0.5463292717923794, 'f1-score': 0.5466061740864409, 'support': 183083}, 'weighted avg': {'precision': 0.5577053343221627, 'recall': 0.5598171321204044, 'f1-score': 0.55838348358099, 'support': 183083}}
[[27238 12269 13302]
 [15387 50005 11027]
 [11159 17446 25250]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0518582
{'0': {'precision': 0.504302203567681, 'recall': 0.5287128712871287, 'f1-score': 0.5162191192266381, 'support': 18180}, '1': {'precision': 0.544937015503876, 'recall': 0.4895005984114895, 'f1-score': 0.5157333639021036, 'support': 18382}, '2': {'precision': 0.489518918352374, 'recall': 0.5163055494141057, 'f1-score': 0.5025555495776618, 'support': 18092}, 'accuracy': 0.511417279613569, 'macro avg': {'precision': 0.5129193791413104, 'recall': 0.5115063397042413, 'f1-score': 0.5115026775688012, 'support': 54654}, 'weighted avg': {'precision': 0.513075393396345, 'recall': 0.511417279613569, 'f1-score': 0.5115327201256598, 'support': 54654}}
[[9612 3125 5443]
 [5086 8998 4298]
 [4362 4389 9341]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
4918/4918 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4874454
{'0': {'precision': 0.5089349295282626, 'recall': 0.5206845596068593, 'f1-score': 0.5147427033895137, 'support': 145495}, '1': {'precision': 0.8824027743071851, 'recall': 0.8982024412058172, 'f1-score': 0.8902325109512316, 'support': 967145}, '2': {'precision': 0.5203588187025485, 'recall': 0.44676776174939636, 'f1-score': 0.48076342732645866, 'support': 146199}, 'accuracy': 0.802140702663327, 'macro avg': {'precision': 0.6372321741793321, 'recall': 0.6218849208540242, 'f1-score': 0.6285795472224013, 'support': 1258839}, 'weighted avg': {'precision': 0.7971907906130419, 'recall': 0.802140702663327, 'f1-score': 0.7992789735186844, 'support': 1258839}}
[[ 75757  50997  18741]
 [ 56988 868692  41465]
 [ 16109  64773  65317]]
Evaluating performance on  train set...
1403/1403 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4583394
{'0': {'precision': 0.4751025622128872, 'recall': 0.5367749097973911, 'f1-score': 0.5040593194938555, 'support': 36030}, '1': {'precision': 0.8981107595814948, 'recall': 0.903044762791736, 'f1-score': 0.9005710031950437, 'support': 286689}, '2': {'precision': 0.5374720917058216, 'recall': 0.44480295634428174, 'f1-score': 0.48676625924249284, 'support': 36261}, 'accuracy': 0.8199955429271826, 'macro avg': {'precision': 0.6368951378334012, 'recall': 0.6282075429778029, 'f1-score': 0.630465527310464, 'support': 358980}, 'weighted avg': {'precision': 0.8192258521018838, 'recall': 0.8199955429271826, 'f1-score': 0.8189751210171583, 'support': 358980}}
[[ 19340  12875   3815]
 [ 17731 258893  10065]
 [  3636  16496  16129]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4691394
{'0': {'precision': 0.500329163923634, 'recall': 0.5112871879204665, 'f1-score': 0.505748826204296, 'support': 13378}, '1': {'precision': 0.888659856934396, 'recall': 0.9061452979002351, 'f1-score': 0.8973174036465176, 'support': 96106}, '2': {'precision': 0.5459317585301837, 'recall': 0.45583012166553316, 'f1-score': 0.4968289267770365, 'support': 13233}, 'accuracy': 0.8145407726720829, 'macro avg': {'precision': 0.6449735931294046, 'recall': 0.6244208691620783, 'f1-score': 0.6332983855426166, 'support': 122717}, 'weighted avg': {'precision': 0.8093684063832831, 'recall': 0.8145407726720829, 'f1-score': 0.8114444728917249, 'support': 122717}}
[[ 6840  4989  1549]
 [ 5552 87086  3468]
 [ 1279  5922  6032]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
4856/4856 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7477769
{'0': {'precision': 0.4750702327387342, 'recall': 0.5066826899654092, 'f1-score': 0.49036750057956097, 'support': 246308}, '1': {'precision': 0.7895941634384412, 'recall': 0.788591062044926, 'f1-score': 0.7890922939538793, 'support': 761964}, '2': {'precision': 0.5041580942562189, 'recall': 0.4710207004129854, 'f1-score': 0.48702637910823987, 'support': 234633}, 'accuracy': 0.6727746690213653, 'macro avg': {'precision': 0.5896074968111314, 'recall': 0.5887648174744402, 'f1-score': 0.5888287245472267, 'support': 1242905}, 'weighted avg': {'precision': 0.6733805497324735, 'recall': 0.6727746690213653, 'f1-score': 0.672870267166298, 'support': 1242905}}
[[124800  78695  42813]
 [ 95205 600878  65881]
 [ 42693  81423 110517]]
Evaluating performance on  train set...
2076/2076 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5785289
{'0': {'precision': 0.4894746671646968, 'recall': 0.504094081441996, 'f1-score': 0.49667681895093063, 'support': 72788}, '1': {'precision': 0.8446587852630262, 'recall': 0.8791357314173661, 'f1-score': 0.8615524783201222, 'support': 384001}, '2': {'precision': 0.537103905025276, 'recall': 0.4086383189718712, 'f1-score': 0.46414600362269204, 'support': 74621}, 'accuracy': 0.7616981238591671, 'macro avg': {'precision': 0.6237457858176664, 'recall': 0.5972893772770778, 'f1-score': 0.6074584336312483, 'support': 531410}, 'weighted avg': {'precision': 0.7528216081185194, 'recall': 0.7616981238591671, 'f1-score': 0.7557708068375348, 'support': 531410}}
[[ 36692  27119   8977]
 [ 29109 337589  17303]
 [  9161  34967  30493]]
Evaluating performance on  val set...
588/588 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5446876
{'0': {'precision': 0.5275184541901867, 'recall': 0.48078159782339847, 'f1-score': 0.503066849556148, 'support': 20215}, '1': {'precision': 0.8436030978389529, 'recall': 0.9069820290698203, 'f1-score': 0.8741452645135289, 'support': 110011}, '2': {'precision': 0.5767817781043351, 'recall': 0.3908583947420832, 'f1-score': 0.46595833086009375, 'support': 20084}, 'accuracy': 0.7806998869004058, 'macro avg': {'precision': 0.6493011100444916, 'recall': 0.5928740072117673, 'f1-score': 0.6143901483099236, 'support': 150310}, 'weighted avg': {'precision': 0.7654413623795032, 'recall': 0.7806998869004058, 'f1-score': 0.7696986107056716, 'support': 150310}}
[[ 9719  8354  2142]
 [ 6615 99778  3618]
 [ 2090 10144  7850]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
4353/4353 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6627793
{'0': {'precision': 0.5235079559941451, 'recall': 0.4737738892627846, 'f1-score': 0.49740081312210854, 'support': 187218}, '1': {'precision': 0.80776608377059, 'recall': 0.8601848386883235, 'f1-score': 0.83315177816117, 'support': 740213}, '2': {'precision': 0.5130900081732734, 'recall': 0.4300293807564073, 'f1-score': 0.4679021152082454, 'support': 186857}, 'accuracy': 0.7231281320448574, 'macro avg': {'precision': 0.6147880159793362, 'recall': 0.5879960362358384, 'f1-score': 0.5994849021638413, 'support': 1114288}, 'weighted avg': {'precision': 0.7105914524150174, 'recall': 0.7231281320448574, 'f1-score': 0.7154909216832419, 'support': 1114288}}
[[ 88699  69353  29166]
 [ 56405 636720  47088]
 [ 24328  82175  80354]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72958213
{'0': {'precision': 0.4922482706645493, 'recall': 0.48867067468269876, 'f1-score': 0.4904529485907373, 'support': 74850}, '1': {'precision': 0.7858845787061248, 'recall': 0.8258002472867152, 'f1-score': 0.8053481288248067, 'support': 247486}, '2': {'precision': 0.5192272553612066, 'recall': 0.43277444722887565, 'f1-score': 0.4720753919110762, 'support': 72227}, 'accuracy': 0.6898999652780418, 'macro avg': {'precision': 0.5991200349106269, 'recall': 0.5824151230660966, 'f1-score': 0.5892921564422068, 'support': 394563}, 'weighted avg': {'precision': 0.6813675911777825, 'recall': 0.6898999652780418, 'f1-score': 0.6846039277476959, 'support': 394563}}
[[ 36577  26291  11982]
 [ 26151 204374  16961]
 [ 11578  29391  31258]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71182907
{'0': {'precision': 0.5068823124569856, 'recall': 0.4655289177840986, 'f1-score': 0.4853263043938717, 'support': 22149}, '1': {'precision': 0.7838278409757242, 'recall': 0.8438695503958183, 'f1-score': 0.8127413010038121, 'support': 79203}, '2': {'precision': 0.5206803028590801, 'recall': 0.41966481464614264, 'f1-score': 0.46474682267500506, 'support': 21958}, 'accuracy': 0.7003730435487795, 'macro avg': {'precision': 0.60379681876393, 'recall': 0.5763544276086865, 'f1-score': 0.587604809357563, 'support': 123310}, 'weighted avg': {'precision': 0.6872236713777451, 'recall': 0.7003730435487795, 'f1-score': 0.6919629576816362, 'support': 123310}}
[[10311  8750  3088]
 [ 6971 66837  5395]
 [ 3060  9683  9215]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7513285
{'0': {'precision': 0.4780498084579548, 'recall': 0.4654595018429904, 'f1-score': 0.47167065183491, 'support': 272926}, '1': {'precision': 0.7790030196145226, 'recall': 0.7950943765506364, 'f1-score': 0.7869664503866377, 'support': 868595}, '2': {'precision': 0.5014474788762229, 'recall': 0.4811502559470039, 'f1-score': 0.49108923062738424, 'support': 265680}, 'accuracy': 0.6718890904710841, 'macro avg': {'precision': 0.5861667689829001, 'recall': 0.5805680447802102, 'f1-score': 0.583242110949644, 'support': 1407201}, 'weighted avg': {'precision': 0.6682307048055728, 'recall': 0.6718890904710841, 'f1-score': 0.6699532583400379, 'support': 1407201}}
[[127036 101089  44801]
 [ 95687 690615  82293]
 [ 43015  94833 127832]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7434116
{'0': {'precision': 0.4844888502143988, 'recall': 0.4828638301429407, 'f1-score': 0.4836749752730431, 'support': 95704}, '1': {'precision': 0.7822564814733431, 'recall': 0.7994077773386508, 'f1-score': 0.790739136551091, 'support': 333996}, '2': {'precision': 0.47747497836266395, 'recall': 0.4430521807174334, 'f1-score': 0.4596199651794965, 'support': 97124}, 'accuracy': 0.6762068546611392, 'macro avg': {'precision': 0.581406770016802, 'recall': 0.5751079293996749, 'f1-score': 0.5780113590012103, 'support': 526824}, 'weighted avg': {'precision': 0.6719745807054821, 'recall': 0.6762068546611392, 'f1-score': 0.6739128589114067, 'support': 526824}}
[[ 46212  33701  15791]
 [ 35697 266999  31300]
 [ 13474  40619  43031]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7834858
{'0': {'precision': 0.48733920500637384, 'recall': 0.47408472140018604, 'f1-score': 0.48062059802562973, 'support': 35481}, '1': {'precision': 0.7610741552649483, 'recall': 0.777103493521404, 'f1-score': 0.7690053035836185, 'support': 103649}, '2': {'precision': 0.4823421990515743, 'recall': 0.4656373510762319, 'f1-score': 0.47384259259259254, 'support': 35169}, 'accuracy': 0.6525740250948083, 'macro avg': {'precision': 0.5769185197742989, 'recall': 0.5722751886659406, 'f1-score': 0.5744894980672802, 'support': 174299}, 'weighted avg': {'precision': 0.6491107249630381, 'recall': 0.6525740250948083, 'f1-score': 0.6507444121227014, 'support': 174299}}
[[16821 12345  6315]
 [11843 80546 11260]
 [ 5852 12941 16376]]
testing model on single stock: results/universal/W2/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 109s - 109s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0908426
{'0': {'precision': 0.4289051575111874, 'recall': 0.5589154980683443, 'f1-score': 0.48535478253146613, 'support': 1124424}, '1': {'precision': 0.5879609846487092, 'recall': 0.30122227656900025, 'f1-score': 0.39835870523944095, 'support': 1521096}, '2': {'precision': 0.4408469644265997, 'recall': 0.5926609806600772, 'f1-score': 0.5056038427187411, 'support': 1164379}, 'accuracy': 0.4663451708299879, 'macro avg': {'precision': 0.4859043688621654, 'recall': 0.48426625176580723, 'f1-score': 0.46310577682988274, 'support': 3809899}, 'weighted avg': {'precision': 0.4960575863892066, 'recall': 0.4663451708299879, 'f1-score': 0.4568102450692418, 'support': 3809899}}
[[628458 151751 344215]
 [531850 458188 531058]
 [304953 169344 690082]]
Evaluating performance on  train set...
6147/6147 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0761378
{'0': {'precision': 0.44154156177649473, 'recall': 0.5764876902140295, 'f1-score': 0.5000706503950161, 'support': 484980}, '1': {'precision': 0.5888644732749365, 'recall': 0.29467024828659655, 'f1-score': 0.3927878244341227, 'support': 597495}, '2': {'precision': 0.44829204701743663, 'recall': 0.5855013136188673, 'f1-score': 0.5077911938843279, 'support': 491010}, 'accuracy': 0.4722866757547736, 'macro avg': {'precision': 0.4928993606896226, 'recall': 0.48555308403983116, 'f1-score': 0.46688322290448897, 'support': 1573485}, 'weighted avg': {'precision': 0.49959057957070074, 'recall': 0.4722866757547736, 'f1-score': 0.4617416621689974, 'support': 1573485}}
[[279585  60036 145359]
 [212983 176064 208448]
 [140634  62889 287487]]
Evaluating performance on  val set...
2174/2174 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0503498
{'0': {'precision': 0.4477365699289904, 'recall': 0.5493805603073226, 'f1-score': 0.4933778794861776, 'support': 168943}, '1': {'precision': 0.6318657472151227, 'recall': 0.3689981131898356, 'f1-score': 0.46591205404764724, 'support': 213058}, '2': {'precision': 0.4516206525317413, 'recall': 0.5817550414606053, 'f1-score': 0.5084938478144903, 'support': 174503}, 'accuracy': 0.49047266506619897, 'macro avg': {'precision': 0.5104076565586181, 'recall': 0.5000445716525879, 'f1-score': 0.4892612604494384, 'support': 556504}, 'weighted avg': {'precision': 0.519448504291828, 'recall': 0.49047266506619897, 'f1-score': 0.48760248161826136, 'support': 556504}}
[[ 92814  21660  54469]
 [ 65641  78618  68799]
 [ 48841  24144 101518]]
training model: results/universal/W2/deepVOL_L2/h20
Epoch 1/50
9940/9940 - 331s - loss: 2.8467 - accuracy20: 0.5212 - val_loss: 3.1522 - val_accuracy20: 0.5312 - 331s/epoch - 33ms/step
Epoch 2/50
9940/9940 - 330s - loss: 2.7751 - accuracy20: 0.5424 - val_loss: 3.1193 - val_accuracy20: 0.5395 - 330s/epoch - 33ms/step
Epoch 3/50
9940/9940 - 329s - loss: 2.7419 - accuracy20: 0.5500 - val_loss: 3.1116 - val_accuracy20: 0.5442 - 329s/epoch - 33ms/step
Epoch 4/50
9940/9940 - 344s - loss: 2.7235 - accuracy20: 0.5538 - val_loss: 3.0611 - val_accuracy20: 0.5465 - 344s/epoch - 35ms/step
Epoch 5/50
9940/9940 - 328s - loss: 2.7098 - accuracy20: 0.5566 - val_loss: 3.0631 - val_accuracy20: 0.5479 - 328s/epoch - 33ms/step
Epoch 6/50
9940/9940 - 332s - loss: 2.7005 - accuracy20: 0.5584 - val_loss: 3.0755 - val_accuracy20: 0.5468 - 332s/epoch - 33ms/step
Epoch 7/50
9940/9940 - 326s - loss: 2.6931 - accuracy20: 0.5600 - val_loss: 3.0785 - val_accuracy20: 0.5488 - 326s/epoch - 33ms/step
Epoch 8/50
9940/9940 - 327s - loss: 2.6864 - accuracy20: 0.5612 - val_loss: 3.0809 - val_accuracy20: 0.5485 - 327s/epoch - 33ms/step
Epoch 9/50
9940/9940 - 330s - loss: 2.6802 - accuracy20: 0.5625 - val_loss: 3.0721 - val_accuracy20: 0.5490 - 330s/epoch - 33ms/step
Epoch 10/50
9940/9940 - 327s - loss: 2.6750 - accuracy20: 0.5637 - val_loss: 3.0784 - val_accuracy20: 0.5495 - 327s/epoch - 33ms/step
Epoch 11/50
9940/9940 - 325s - loss: 2.6703 - accuracy20: 0.5645 - val_loss: 3.0674 - val_accuracy20: 0.5494 - 325s/epoch - 33ms/step
Epoch 12/50
9940/9940 - 323s - loss: 2.6657 - accuracy20: 0.5654 - val_loss: 3.0638 - val_accuracy20: 0.5485 - 323s/epoch - 32ms/step
Epoch 13/50
9940/9940 - 321s - loss: 2.6620 - accuracy20: 0.5663 - val_loss: 3.0540 - val_accuracy20: 0.5496 - 321s/epoch - 32ms/step
Epoch 14/50
9940/9940 - 317s - loss: 2.6579 - accuracy20: 0.5669 - val_loss: 3.0499 - val_accuracy20: 0.5505 - 317s/epoch - 32ms/step
Epoch 15/50
9940/9940 - 328s - loss: 2.6543 - accuracy20: 0.5677 - val_loss: 3.0414 - val_accuracy20: 0.5507 - 328s/epoch - 33ms/step
Epoch 16/50
9940/9940 - 325s - loss: 2.6511 - accuracy20: 0.5682 - val_loss: 3.0338 - val_accuracy20: 0.5503 - 325s/epoch - 33ms/step
Epoch 17/50
9940/9940 - 321s - loss: 2.6483 - accuracy20: 0.5688 - val_loss: 3.0205 - val_accuracy20: 0.5512 - 321s/epoch - 32ms/step
Epoch 18/50
9940/9940 - 333s - loss: 2.6452 - accuracy20: 0.5694 - val_loss: 3.0109 - val_accuracy20: 0.5512 - 333s/epoch - 33ms/step
Epoch 19/50
9940/9940 - 341s - loss: 2.6428 - accuracy20: 0.5699 - val_loss: 3.0163 - val_accuracy20: 0.5515 - 341s/epoch - 34ms/step
Epoch 20/50
9940/9940 - 336s - loss: 2.6402 - accuracy20: 0.5703 - val_loss: 3.0246 - val_accuracy20: 0.5508 - 336s/epoch - 34ms/step
Epoch 21/50
9940/9940 - 333s - loss: 2.6382 - accuracy20: 0.5709 - val_loss: 3.0043 - val_accuracy20: 0.5515 - 333s/epoch - 34ms/step
Epoch 22/50
9940/9940 - 334s - loss: 2.6359 - accuracy20: 0.5711 - val_loss: 2.9985 - val_accuracy20: 0.5508 - 334s/epoch - 34ms/step
Epoch 23/50
9940/9940 - 329s - loss: 2.6337 - accuracy20: 0.5717 - val_loss: 3.0143 - val_accuracy20: 0.5511 - 329s/epoch - 33ms/step
Epoch 24/50
9940/9940 - 332s - loss: 2.6321 - accuracy20: 0.5717 - val_loss: 3.0147 - val_accuracy20: 0.5497 - 332s/epoch - 33ms/step
Epoch 25/50
9940/9940 - 334s - loss: 2.6300 - accuracy20: 0.5723 - val_loss: 3.0170 - val_accuracy20: 0.5503 - 334s/epoch - 34ms/step
Epoch 26/50
9940/9940 - 334s - loss: 2.6282 - accuracy20: 0.5727 - val_loss: 3.0047 - val_accuracy20: 0.5502 - 334s/epoch - 34ms/step
Epoch 27/50
9940/9940 - 338s - loss: 2.6258 - accuracy20: 0.5732 - val_loss: 3.0209 - val_accuracy20: 0.5496 - 338s/epoch - 34ms/step
Epoch 28/50
9940/9940 - 341s - loss: 2.6246 - accuracy20: 0.5733 - val_loss: 3.0020 - val_accuracy20: 0.5504 - 341s/epoch - 34ms/step
Epoch 29/50
9940/9940 - 339s - loss: 2.6233 - accuracy20: 0.5739 - val_loss: 3.0219 - val_accuracy20: 0.5485 - 339s/epoch - 34ms/step
Epoch 30/50
9940/9940 - 337s - loss: 2.6215 - accuracy20: 0.5739 - val_loss: 3.0137 - val_accuracy20: 0.5492 - 337s/epoch - 34ms/step
Epoch 31/50
9940/9940 - 338s - loss: 2.6201 - accuracy20: 0.5745 - val_loss: 3.0074 - val_accuracy20: 0.5493 - 338s/epoch - 34ms/step
Epoch 32/50
9940/9940 - 339s - loss: 2.6189 - accuracy20: 0.5746 - val_loss: 3.0057 - val_accuracy20: 0.5501 - 339s/epoch - 34ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 443s - 443s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0176742
{'0': {'precision': 0.4695528931277144, 'recall': 0.5006110642016964, 'f1-score': 0.48458484105040156, 'support': 1789501}, '1': {'precision': 0.6882702303331272, 'recall': 0.6033759758518189, 'f1-score': 0.6430332391152374, 'support': 3086278}, '2': {'precision': 0.46455274521900064, 'recall': 0.5306001658545575, 'f1-score': 0.4953847010214331, 'support': 1844990}, 'accuracy': 0.5560348823177824, 'macro avg': {'precision': 0.540791956226614, 'recall': 0.5448624019693575, 'f1-score': 0.5410009270623574, 'support': 6720769}, 'weighted avg': {'precision': 0.5686185332569242, 'recall': 0.5560348823177824, 'f1-score': 0.5603115084497272, 'support': 6720769}}
[[ 895844  398263  495394]
 [ 591138 1862186  632954]
 [ 420884  445154  978952]]
Evaluating performance on  train set...
9940/9940 - 168s - 168s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0236552
{'0': {'precision': 0.4726232627165426, 'recall': 0.5132899814843732, 'f1-score': 0.49211791645111747, 'support': 717232}, '1': {'precision': 0.6820885014081132, 'recall': 0.5766111525185791, 'f1-score': 0.6249303965241396, 'support': 1105544}, '2': {'precision': 0.4626403756682978, 'recall': 0.5327544780591748, 'f1-score': 0.4952280613975248, 'support': 720848}, 'accuracy': 0.546327601878265, 'macro avg': {'precision': 0.5391173799309845, 'recall': 0.540885204020709, 'f1-score': 0.5374254581242607, 'support': 2543624}, 'weighted avg': {'precision': 0.5608347647628672, 'recall': 0.546327601878265, 'f1-score': 0.5507240556580824, 'support': 2543624}}
[[368148 141958 207126]
 [229142 637469 238933]
 [181656 155157 384035]]
Evaluating performance on  val set...
3393/3393 - 56s - 56s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0140287
{'0': {'precision': 0.4836955447012992, 'recall': 0.4970574847184289, 'f1-score': 0.49028549207946387, 'support': 246048}, '1': {'precision': 0.67791682237028, 'recall': 0.598933854416908, 'f1-score': 0.6359824884424861, 'support': 372557}, '2': {'precision': 0.46535892425836534, 'recall': 0.5336457139192406, 'f1-score': 0.497168453226731, 'support': 249482}, 'accuracy': 0.5512949738908658, 'macro avg': {'precision': 0.5423237637766481, 'recall': 0.5432123510181924, 'f1-score': 0.5411454779162269, 'support': 868087}, 'weighted avg': {'precision': 0.5617796996341324, 'recall': 0.5512949738908658, 'f1-score': 0.5547924030077014, 'support': 868087}}
[[122300  50770  72978]
 [ 69442 223137  79978]
 [ 61103  55244 133135]]
testing model out of sample: results/universal/W2/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 241s - 241s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9497925
{'0': {'precision': 0.5086622051938569, 'recall': 0.4410143031449288, 'f1-score': 0.4724288870788946, 'support': 998242}, '1': {'precision': 0.6473956365385073, 'recall': 0.7339405020944566, 'f1-score': 0.687956921195247, 'support': 1669168}, '2': {'precision': 0.5096287560069708, 'recall': 0.46353781510082326, 'f1-score': 0.4854918101083339, 'support': 999323}, 'accuracy': 0.5804984982544407, 'macro avg': {'precision': 0.5552288659131116, 'recall': 0.5461642067800696, 'f1-score': 0.5486258727941585, 'support': 3666733}, 'weighted avg': {'precision': 0.5720797762547715, 'recall': 0.5804984982544407, 'f1-score': 0.5741015687496003, 'support': 3666733}}
[[ 440239  328674  229329]
 [ 227707 1225070  216391]
 [ 197538  338561  463224]]
Evaluating performance on  train set...
5373/5373 - 90s - 90s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8575655
{'0': {'precision': 0.5300610820244328, 'recall': 0.4476033748019699, 'f1-score': 0.4853549241945042, 'support': 325708}, '1': {'precision': 0.6888841741447381, 'recall': 0.8082167207374579, 'f1-score': 0.7437945032275237, 'support': 719119}, '2': {'precision': 0.5196808282226552, 'recall': 0.4033235877781649, 'f1-score': 0.45416800289307235, 'support': 330065}, 'accuracy': 0.6255873188584994, 'macro avg': {'precision': 0.5795420281306086, 'recall': 0.5530478944391976, 'f1-score': 0.5611058101050335, 'support': 1374892}, 'weighted avg': {'precision': 0.6106394436058357, 'recall': 0.6255873188584994, 'f1-score': 0.6130413900807621, 'support': 1374892}}
[[145788 119664  60256]
 [ 75131 581204  62784]
 [ 54121 142821 133123]]
Evaluating performance on  val set...
1685/1685 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8849474
{'0': {'precision': 0.5250808623879015, 'recall': 0.446549154538262, 'f1-score': 0.48264135746921283, 'support': 108698}, '1': {'precision': 0.673891072878038, 'recall': 0.7935314292139886, 'f1-score': 0.7288340548588936, 'support': 213432}, '2': {'precision': 0.5197279850875073, 'recall': 0.41613384680584475, 'f1-score': 0.4621972995512896, 'support': 108542}, 'accuracy': 0.6108407326225063, 'macro avg': {'precision': 0.572899973451149, 'recall': 0.5520714768526984, 'f1-score': 0.5578909039597987, 'support': 430672}, 'weighted avg': {'precision': 0.5974789956247765, 'recall': 0.6108407326225063, 'f1-score': 0.5994967853928929, 'support': 430672}}
[[ 48539  38685  21474]
 [ 23802 169365  20265]
 [ 20100  43274  45168]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
987/987 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.442178
{'0': {'precision': 0.40884831614593037, 'recall': 0.4655112175887799, 'f1-score': 0.4353437461710358, 'support': 80142}, '1': {'precision': 0.5090242785158039, 'recall': 0.06125013780178591, 'f1-score': 0.10934317343173432, 'support': 90710}, '2': {'precision': 0.37418762597202176, 'recall': 0.6889996692919172, 'f1-score': 0.4849853862932916, 'support': 81643}, 'accuracy': 0.3925424265827046, 'macro avg': {'precision': 0.43068674021125203, 'recall': 0.40525367489416103, 'f1-score': 0.34322410196535386, 'support': 252495}, 'weighted avg': {'precision': 0.43362963386985687, 'recall': 0.3925424265827046, 'f1-score': 0.33427790514970585, 'support': 252495}}
[[37307  2475 40360]
 [31435  5556 53719]
 [22507  2884 56252]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3925796
{'0': {'precision': 0.4174980460668475, 'recall': 0.45459551461754105, 'f1-score': 0.4352577467826587, 'support': 19976}, '1': {'precision': 0.4304805962477512, 'recall': 0.08382124806085173, 'f1-score': 0.14032001340370276, 'support': 19983}, '2': {'precision': 0.39553543284523024, 'recall': 0.6706997084548105, 'f1-score': 0.4976116228346882, 'support': 20580}, 'accuracy': 0.4056723764845802, 'macro avg': {'precision': 0.41450469171994303, 'recall': 0.4030388237110678, 'f1-score': 0.3577297943403499, 'support': 60539}, 'weighted avg': {'precision': 0.41431728193404244, 'recall': 0.4056723764845802, 'f1-score': 0.35910026223615304, 'support': 60539}}
[[ 9081  1096  9799]
 [ 7013  1675 11295]
 [ 5657  1120 13803]]
Evaluating performance on  val set...
85/85 - 1s - 830ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4116018
{'0': {'precision': 0.4001769016932019, 'recall': 0.4733223733373188, 'f1-score': 0.4336870934611434, 'support': 6691}, '1': {'precision': 0.4709058188362327, 'recall': 0.09889140841521794, 'f1-score': 0.16345653305570018, 'support': 7938}, '2': {'precision': 0.3876362426158582, 'recall': 0.6683402668196815, 'f1-score': 0.4906793048973144, 'support': 6971}, 'accuracy': 0.3986574074074074, 'macro avg': {'precision': 0.4195729877150976, 'recall': 0.4135180161907394, 'f1-score': 0.36260764380471927, 'support': 21600}, 'weighted avg': {'precision': 0.4221225132604804, 'recall': 0.3986574074074074, 'f1-score': 0.3527705433418443, 'support': 21600}}
[[3167  449 3075]
 [2868  785 4285]
 [1879  433 4659]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80821246
{'0': {'precision': 0.5144355950375249, 'recall': 0.4146668930076081, 'f1-score': 0.4591945723782587, 'support': 64799}, '1': {'precision': 0.7325630586576296, 'recall': 0.8594276992699483, 'f1-score': 0.7909405013027387, 'support': 187384}, '2': {'precision': 0.5671739700865914, 'recall': 0.39529992684711046, 'f1-score': 0.4658907209828645, 'support': 65616}, 'accuracy': 0.6729127530294305, 'macro avg': {'precision': 0.6047242079272487, 'recall': 0.5564648397082222, 'f1-score': 0.5720085982212874, 'support': 317799}, 'weighted avg': {'precision': 0.6539391109712102, 'recall': 0.6729127530294305, 'f1-score': 0.6561846624428107, 'support': 317799}}
[[ 26870  28885   9044]
 [ 15591 161043  10750]
 [  9771  29907  25938]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64258945
{'0': {'precision': 0.567673507032511, 'recall': 0.45499907595638517, 'f1-score': 0.5051292572835454, 'support': 21644}, '1': {'precision': 0.8001836999441325, 'recall': 0.9244612186850454, 'f1-score': 0.8578447545135699, 'support': 91410}, '2': {'precision': 0.623797976419433, 'recall': 0.3412625800548948, 'f1-score': 0.44117212217983975, 'support': 21860}, 'accuracy': 0.7546511110781683, 'macro avg': {'precision': 0.6638850611320255, 'recall': 0.5735742915654417, 'f1-score': 0.6013820446589849, 'support': 134914}, 'weighted avg': {'precision': 0.734302897865556, 'recall': 0.7546511110781683, 'f1-score': 0.7337461586312893, 'support': 134914}}
[[ 9848  9358  2438]
 [ 4844 84505  2061]
 [ 2656 11744  7460]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6960852
{'0': {'precision': 0.5601483836777954, 'recall': 0.44096787651230707, 'f1-score': 0.49346405228758167, 'support': 7191}, '1': {'precision': 0.7823244315779202, 'recall': 0.9096444780635401, 'f1-score': 0.8411940611720267, 'support': 26440}, '2': {'precision': 0.6060606060606061, 'recall': 0.36473291211947156, 'f1-score': 0.45540116539668307, 'support': 6964}, 'accuracy': 0.7331444759206799, 'macro avg': {'precision': 0.6495111404387739, 'recall': 0.5717817555651062, 'f1-score': 0.5966864262854304, 'support': 40595}, 'weighted avg': {'precision': 0.7127304115914102, 'recall': 0.7331444759206799, 'f1-score': 0.713415068190932, 'support': 40595}}
[[ 3171  3248   772]
 [ 1510 24051   879]
 [  980  3444  2540]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1603961
{'0': {'precision': 0.4871515110186732, 'recall': 0.4503929892400807, 'f1-score': 0.46805165024159867, 'support': 95168}, '1': {'precision': 0.4467783564548094, 'recall': 0.4980732177263969, 'f1-score': 0.47103341877330873, 'support': 77850}, '2': {'precision': 0.49577626259578833, 'recall': 0.4871683383566382, 'f1-score': 0.49143460946105577, 'support': 101195}, 'accuracy': 0.4775010666890337, 'macro avg': {'precision': 0.47656871002309026, 'recall': 0.4785448484410386, 'f1-score': 0.4768398928253211, 'support': 274213}, 'weighted avg': {'precision': 0.4788722961493905, 'recall': 0.4775010666890337, 'f1-score': 0.47752738347965307, 'support': 274213}}
[[42863 22311 29994]
 [18930 38775 20145]
 [26194 25702 49299]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1582
{'0': {'precision': 0.5018587360594795, 'recall': 0.45411658530582105, 'f1-score': 0.4767955206202218, 'support': 24377}, '1': {'precision': 0.48001604063627856, 'recall': 0.5831202046035806, 'f1-score': 0.5265685429917334, 'support': 24633}, '2': {'precision': 0.4815711978721383, 'recall': 0.4220011654041455, 'f1-score': 0.4498225377107365, 'support': 24026}, 'accuracy': 0.4870611753108056, 'macro avg': {'precision': 0.4878153248559654, 'recall': 0.4864126517711824, 'f1-score': 0.48439553377423056, 'support': 73036}, 'weighted avg': {'precision': 0.48781799575539975, 'recall': 0.4870611753108056, 'f1-score': 0.4847095078688958, 'support': 73036}}
[[11070  7252  6055]
 [ 5409 14364  4860]
 [ 5579  8308 10139]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1901308
{'0': {'precision': 0.4737343783096801, 'recall': 0.45750230131942315, 'f1-score': 0.46547687184556946, 'support': 9777}, '1': {'precision': 0.490947442432765, 'recall': 0.5394495412844037, 'f1-score': 0.514056964063866, 'support': 10355}, '2': {'precision': 0.46868394704639005, 'recall': 0.43536219902862455, 'f1-score': 0.45140897889210324, 'support': 9677}, 'accuracy': 0.47878157603408367, 'macro avg': {'precision': 0.47778858926294504, 'recall': 0.4774380138774838, 'f1-score': 0.4769809382671795, 'support': 29809}, 'weighted avg': {'precision': 0.47807428423271303, 'recall': 0.47878157603408367, 'f1-score': 0.477785632783869, 'support': 29809}}
[[4473 2721 2583]
 [2576 5586 2193]
 [2393 3071 4213]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5337197
{'0': {'precision': 0.37851321170635494, 'recall': 0.17319407025972475, 'f1-score': 0.2376486442190374, 'support': 75349}, '1': {'precision': 0.29789047517579376, 'recall': 0.020817511726602636, 'f1-score': 0.03891548825297851, 'support': 67155}, '2': {'precision': 0.3535021629216591, 'recall': 0.8252066115702479, 'f1-score': 0.49496928903932397, 'support': 77440}, 'accuracy': 0.3562361328338122, 'macro avg': {'precision': 0.3433019499346026, 'recall': 0.3397393978521917, 'f1-score': 0.25717780717044664, 'support': 219944}, 'weighted avg': {'precision': 0.34509072466603247, 'recall': 0.3562361328338122, 'f1-score': 0.26756983163939124, 'support': 219944}}
[[13050  1658 60641]
 [ 9528  1398 56229]
 [11899  1637 63904]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5874845
{'0': {'precision': 0.3875590673173755, 'recall': 0.17761919977278376, 'f1-score': 0.2435972343947804, 'support': 28167}, '1': {'precision': 0.296875, 'recall': 0.01330532212885154, 'f1-score': 0.02546916890080429, 'support': 27132}, '2': {'precision': 0.3259913850526222, 'recall': 0.8347420687563961, 'f1-score': 0.468873749201618, 'support': 26383}, 'accuracy': 0.3352880683626748, 'macro avg': {'precision': 0.33680848412333253, 'recall': 0.3418888635526771, 'f1-score': 0.2459800508324009, 'support': 81682}, 'weighted avg': {'precision': 0.33755073897519466, 'recall': 0.3352880683626748, 'f1-score': 0.24390598806347405, 'support': 81682}}
[[ 5003   440 22724]
 [ 3961   361 22810]
 [ 3945   415 22023]]
Evaluating performance on  val set...
98/98 - 1s - 907ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5778334
{'0': {'precision': 0.3953771289537713, 'recall': 0.1830779630464173, 'f1-score': 0.2502695210226397, 'support': 8876}, '1': {'precision': 0.2578125, 'recall': 0.012310370554588411, 'f1-score': 0.02349869451697128, 'support': 8042}, '2': {'precision': 0.32315434602042314, 'recall': 0.8223299763769738, 'f1-score': 0.46397755173623295, 'support': 8043}, 'accuracy': 0.334041104122431, 'macro avg': {'precision': 0.3254479916580648, 'recall': 0.33923943665932654, 'f1-score': 0.24591525575861464, 'support': 24961}, 'weighted avg': {'precision': 0.32778438069932847, 'recall': 0.334041104122431, 'f1-score': 0.24606947712499316, 'support': 24961}}
[[1625  140 7111]
 [1201   99 6742]
 [1284  145 6614]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0927587
{'0': {'precision': 0.5174883312930826, 'recall': 0.46476256548042494, 'f1-score': 0.4897103280800872, 'support': 170089}, '1': {'precision': 0.45862502928309534, 'recall': 0.5892209701126898, 'f1-score': 0.5157847333061701, 'support': 142870}, '2': {'precision': 0.5263171600252593, 'recall': 0.4568603074141049, 'f1-score': 0.48913533413801136, 'support': 176960}, 'accuracy': 0.49820276413039705, 'macro avg': {'precision': 0.5008101735338124, 'recall': 0.50361461433574, 'f1-score': 0.4982101318414229, 'support': 489919}, 'weighted avg': {'precision': 0.5035116322352364, 'recall': 0.49820276413039705, 'f1-score': 0.49710644732971976, 'support': 489919}}
[[79051 45928 45110]
 [31037 84182 27651]
 [42671 53443 80846]]
Evaluating performance on  train set...
716/716 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0493333
{'0': {'precision': 0.5404583447788722, 'recall': 0.4533186314039794, 'f1-score': 0.4930680485818364, 'support': 60763}, '1': {'precision': 0.49524396788964636, 'recall': 0.7134514468078106, 'f1-score': 0.5846510562003747, 'support': 60789}, '2': {'precision': 0.5328663793103449, 'recall': 0.3857567730087273, 'f1-score': 0.4475324063162856, 'support': 61531}, 'accuracy': 0.5169841001076014, 'macro avg': {'precision': 0.5228562306596212, 'recall': 0.5175089504068391, 'f1-score': 0.5084171703661655, 'support': 183083}, 'weighted avg': {'precision': 0.5228943001435805, 'recall': 0.5169841001076014, 'f1-score': 0.5081725959504163, 'support': 183083}}
[[27545 19863 13355]
 [ 9966 43370  7453]
 [13455 24340 23736]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1217247
{'0': {'precision': 0.5224419334588826, 'recall': 0.49146203434870334, 'f1-score': 0.5064786875269417, 'support': 20321}, '1': {'precision': 0.39322333836464896, 'recall': 0.5448972232239452, 'f1-score': 0.4567990809601548, 'support': 13865}, '2': {'precision': 0.5141194486983155, 'recall': 0.4100547195622435, 'f1-score': 0.4562280868643492, 'support': 20468}, 'accuracy': 0.4745306839389615, 'macro avg': {'precision': 0.4765949068406157, 'recall': 0.48213799237829735, 'f1-score': 0.4731686184504819, 'support': 54654}, 'weighted avg': {'precision': 0.486544095440424, 'recall': 0.4745306839389615, 'f1-score': 0.4750567048832112, 'support': 54654}}
[[9987 5184 5150]
 [3528 7555 2782]
 [5601 6474 8393]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
4918/4918 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5856096
{'0': {'precision': 0.5865408107930946, 'recall': 0.48574756208298786, 'f1-score': 0.5314069910890475, 'support': 202632}, '1': {'precision': 0.8073310752507075, 'recall': 0.9131041618898119, 'f1-score': 0.8569661315001161, 'support': 850455}, '2': {'precision': 0.639883855981417, 'recall': 0.4016534468680742, 'f1-score': 0.4935234785101313, 'support': 205752}, 'accuracy': 0.7607192023761578, 'macro avg': {'precision': 0.677918580675073, 'recall': 0.6001683902802913, 'f1-score': 0.6272988670330983, 'support': 1258839}, 'weighted avg': {'precision': 0.7444224958957065, 'recall': 0.7607192023761578, 'f1-score': 0.7451585433353302, 'support': 1258839}}
[[ 98428  84147  20057]
 [ 47449 776554  26452]
 [ 21934 101177  82641]]
Evaluating performance on  train set...
1403/1403 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54906917
{'0': {'precision': 0.5562024663773472, 'recall': 0.5075179863166768, 'f1-score': 0.5307461279047121, 'support': 51011}, '1': {'precision': 0.8334072814655218, 'recall': 0.9151339405773885, 'f1-score': 0.8723606626812658, 'support': 256569}, '2': {'precision': 0.6619117407588341, 'recall': 0.3954085603112841, 'f1-score': 0.49507338164545395, 'support': 51400}, 'accuracy': 0.7827956989247312, 'macro avg': {'precision': 0.6838404962005677, 'recall': 0.606020162401783, 'f1-score': 0.6327267240771439, 'support': 358980}, 'weighted avg': {'precision': 0.769461196405667, 'recall': 0.7827956989247312, 'f1-score': 0.7697959925639124, 'support': 358980}}
[[ 25889  21062   4060]
 [ 15453 234795   6321]
 [  5204  25872  20324]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.56611323
{'0': {'precision': 0.5779828522809084, 'recall': 0.4711877067548821, 'f1-score': 0.5191499368037389, 'support': 18742}, '1': {'precision': 0.8176812863667647, 'recall': 0.9179387525753886, 'f1-score': 0.864914351264601, 'support': 85424}, '2': {'precision': 0.6596187175043328, 'recall': 0.41032828418953154, 'f1-score': 0.5059320062477152, 'support': 18551}, 'accuracy': 0.772973589641207, 'macro avg': {'precision': 0.685094285384002, 'recall': 0.5998182478399341, 'f1-score': 0.6299987647720183, 'support': 122717}, 'weighted avg': {'precision': 0.7571791003077502, 'recall': 0.772973589641207, 'f1-score': 0.7578403669084505, 'support': 122717}}
[[ 8831  8245  1666]
 [ 4748 78414  2262]
 [ 1700  9239  7612]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
4856/4856 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84092385
{'0': {'precision': 0.5327048173498848, 'recall': 0.4384724416616277, 'f1-score': 0.48101699207012955, 'support': 307602}, '1': {'precision': 0.6884228011494543, 'recall': 0.811451799649201, 'f1-score': 0.744891500415852, 'support': 637402}, '2': {'precision': 0.5467632538181147, 'recall': 0.43756147176410953, 'f1-score': 0.4861048957307796, 'support': 297901}, 'accuracy': 0.6295300123500992, 'macro avg': {'precision': 0.5892969574391512, 'recall': 0.5624952376916461, 'f1-score': 0.5706711294055871, 'support': 1242905}, 'weighted avg': {'precision': 0.6159315938067624, 'recall': 0.6295300123500992, 'f1-score': 0.6175598742348899, 'support': 1242905}}
[[134875 116516  56211]
 [ 68339 517221  51842]
 [ 49975 117576 130350]]
Evaluating performance on  train set...
2076/2076 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68377244
{'0': {'precision': 0.5515536276605162, 'recall': 0.4528256829296149, 'f1-score': 0.49733730172305657, 'support': 96313}, '1': {'precision': 0.7642620082842368, 'recall': 0.8820441406586359, 'f1-score': 0.8189398147701443, 'support': 336787}, '2': {'precision': 0.5785975772620862, 'recall': 0.3745905808157868, 'f1-score': 0.45476268392227565, 'support': 98310}, 'accuracy': 0.71037428727348, 'macro avg': {'precision': 0.6314710710689464, 'recall': 0.5698201348013459, 'f1-score': 0.5903466001384922, 'support': 531410}, 'weighted avg': {'precision': 0.6913630179061858, 'recall': 0.71037428727348, 'f1-score': 0.6932802363415146, 'support': 531410}}
[[ 43613  41466  11234]
 [ 24139 297061  15587]
 [ 11321  50163  36826]]
Evaluating performance on  val set...
588/588 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65567034
{'0': {'precision': 0.578232308151687, 'recall': 0.43122773159144895, 'f1-score': 0.49402610655214935, 'support': 26944}, '1': {'precision': 0.7610039543437344, 'recall': 0.9125082822594004, 'f1-score': 0.8298982176316062, 'support': 96592}, '2': {'precision': 0.6402667778240934, 'recall': 0.3442145364906252, 'f1-score': 0.4477263894286824, 'support': 26774}, 'accuracy': 0.7250083161466303, 'macro avg': {'precision': 0.6598343467731717, 'recall': 0.5626501834471582, 'f1-score': 0.5905502378708126, 'support': 150310}, 'weighted avg': {'precision': 0.7067346682075133, 'recall': 0.7250083161466303, 'f1-score': 0.7016166216683971, 'support': 150310}}
[[11619 12804  2521]
 [ 5794 88141  2657]
 [ 2681 14877  9216]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
4353/4353 - 42s - 42s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7713558
{'0': {'precision': 0.592707488470396, 'recall': 0.416422994854816, 'f1-score': 0.48916771715868784, 'support': 240419}, '1': {'precision': 0.7112390800087706, 'recall': 0.8791534321090971, 'f1-score': 0.7863320198950808, 'support': 630924}, '2': {'precision': 0.5647681542979371, 'recall': 0.38472905390108875, 'f1-score': 0.4576795293345706, 'support': 242945}, 'accuracy': 0.6715166994529242, 'macro avg': {'precision': 0.6229049075923679, 'recall': 0.5601018269550007, 'f1-score': 0.5777264221294464, 'support': 1114288}, 'weighted avg': {'precision': 0.6537300466593288, 'recall': 0.6715166994529242, 'f1-score': 0.6505606359989928, 'support': 1114288}}
[[100116 104961  35342]
 [ 39557 554679  36688]
 [ 29240 120237  93468]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8412221
{'0': {'precision': 0.5618668596237337, 'recall': 0.42441952132188315, 'f1-score': 0.48356596667085827, 'support': 95137}, '1': {'precision': 0.6772192439967363, 'recall': 0.8586421603225401, 'f1-score': 0.7572154532199893, 'support': 206858}, '2': {'precision': 0.5729913115432355, 'recall': 0.37402774176821363, 'f1-score': 0.4526089428928121, 'support': 92568}, 'accuracy': 0.6402475650276381, 'macro avg': {'precision': 0.6040258050545685, 'recall': 0.5523631411375457, 'f1-score': 0.5644634542612199, 'support': 394563}, 'weighted avg': {'precision': 0.6249526831599371, 'recall': 0.6402475650276381, 'f1-score': 0.6197697052664539, 'support': 394563}}
[[ 40378  40992  13767]
 [ 17206 177617  12035]
 [ 14280  43665  34623]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83302945
{'0': {'precision': 0.5692217728180888, 'recall': 0.4061120189131871, 'f1-score': 0.4740280821361903, 'support': 28763}, '1': {'precision': 0.6757668351157597, 'recall': 0.8689101789168279, 'f1-score': 0.7602633770972987, 'support': 66176}, '2': {'precision': 0.573987230917001, 'recall': 0.3580769095202848, 'f1-score': 0.44102452789233776, 'support': 28371}, 'accuracy': 0.6434271348633526, 'macro avg': {'precision': 0.6063252796169499, 'recall': 0.5443663691167666, 'f1-score': 0.5584386623752756, 'support': 123310}, 'weighted avg': {'precision': 0.6274970696661539, 'recall': 0.6434271348633526, 'f1-score': 0.6200467589823014, 'support': 123310}}
[[11681 13299  3783]
 [ 4918 57501  3757]
 [ 3922 14290 10159]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8668877
{'0': {'precision': 0.5210990046696274, 'recall': 0.4227887186052641, 'f1-score': 0.466824125408372, 'support': 345241}, '1': {'precision': 0.6738396403626614, 'recall': 0.8042594011683437, 'f1-score': 0.7332957405617778, 'support': 720336}, '2': {'precision': 0.5486275800671808, 'recall': 0.42932873568601737, 'f1-score': 0.48170164969242746, 'support': 341624}, 'accuracy': 0.6196485079245965, 'macro avg': {'precision': 0.5811887416998233, 'recall': 0.5521256184865417, 'f1-score': 0.5606071718875257, 'support': 1407201}, 'weighted avg': {'precision': 0.60596889930031, 'recall': 0.6196485079245965, 'f1-score': 0.6068408086889835, 'support': 1407201}}
[[145964 141620  57657]
 [ 77987 579337  63012]
 [ 56157 138798 146669]]
Evaluating performance on  train set...
2058/2058 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8633475
{'0': {'precision': 0.5389196044626756, 'recall': 0.4376523789216199, 'f1-score': 0.48303545658400127, 'support': 124279}, '1': {'precision': 0.6744441945881119, 'recall': 0.8122862703889473, 'f1-score': 0.7369752249153086, 'support': 276927}, '2': {'precision': 0.5307828044991502, 'recall': 0.39031030584788806, 'f1-score': 0.44983508493469915, 'support': 125618}, 'accuracy': 0.6232916495831625, 'macro avg': {'precision': 0.5813822011833126, 'recall': 0.5467496517194851, 'f1-score': 0.5566152554780031, 'support': 526824}, 'weighted avg': {'precision': 0.6082184398077787, 'recall': 0.6232916495831625, 'f1-score': 0.6086034146474948, 'support': 526824}}
[[ 54391  50039  19849]
 [ 28489 224944  23494]
 [ 18046  58542  49030]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8914713
{'0': {'precision': 0.5365799359955475, 'recall': 0.42882241743578337, 'f1-score': 0.47668726823238566, 'support': 44965}, '1': {'precision': 0.6505958777458298, 'recall': 0.7935806901112397, 'f1-score': 0.7150099747306823, 'support': 84682}, '2': {'precision': 0.5307804168686379, 'recall': 0.41689062080086, 'f1-score': 0.4669919596603238, 'support': 44652}, 'accuracy': 0.6029810842288251, 'macro avg': {'precision': 0.5726520768700051, 'recall': 0.5464312427826277, 'f1-score': 0.5528964008744639, 'support': 174299}, 'weighted avg': {'precision': 0.590488092962843, 'recall': 0.6029810842288251, 'f1-score': 0.5899910078598595, 'support': 174299}}
[[19282 17573  8110]
 [ 9134 67202  8346]
 [ 7519 18518 18615]]
testing model on single stock: results/universal/W2/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 113s - 113s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2201515
{'0': {'precision': 0.4428824899745075, 'recall': 0.5448245961624867, 'f1-score': 0.4885927764100913, 'support': 1206302}, '1': {'precision': 0.49840401585033306, 'recall': 0.2730042359074617, 'f1-score': 0.3527740524174545, 'support': 1350360}, '2': {'precision': 0.4493630627455851, 'recall': 0.5687735041336954, 'f1-score': 0.5020658566649058, 'support': 1253237}, 'accuracy': 0.4563598667576227, 'macro avg': {'precision': 0.4635498561901419, 'recall': 0.46220077873454796, 'f1-score': 0.44781089516415057, 'support': 3809899}, 'weighted avg': {'precision': 0.4646929739951041, 'recall': 0.4563598667576227, 'f1-score': 0.44488578852107014, 'support': 3809899}}
[[657223 178533 370546]
 [478797 368654 502909]
 [347947 192482 712808]]
Evaluating performance on  train set...
6147/6147 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1806598
{'0': {'precision': 0.4556801937297736, 'recall': 0.5515842946018689, 'f1-score': 0.49906661285913273, 'support': 521273}, '1': {'precision': 0.494332682647878, 'recall': 0.26746884400515686, 'f1-score': 0.34712083542992267, 'support': 523575}, '2': {'precision': 0.4545396625061437, 'recall': 0.5668123873281666, 'f1-score': 0.5045052022605567, 'support': 528637}, 'accuracy': 0.46216138062962153, 'macro avg': {'precision': 0.4681841796279318, 'recall': 0.46195517531173075, 'f1-score': 0.4502308835165374, 'support': 1573485}, 'weighted avg': {'precision': 0.4681585776233794, 'recall': 0.46216138062962153, 'f1-score': 0.45033404099978985, 'support': 1573485}}
[[287526  69931 163816]
 [187777 140040 195758]
 [155679  73320 299638]]
Evaluating performance on  val set...
2174/2174 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1515257
{'0': {'precision': 0.4676540416128736, 'recall': 0.5300203862425744, 'f1-score': 0.4968879001867517, 'support': 182476}, '1': {'precision': 0.5372959676110594, 'recall': 0.3373374446976807, 'f1-score': 0.41445946658233185, 'support': 186475}, '2': {'precision': 0.45706228290401346, 'recall': 0.5668797619872783, 'f1-score': 0.5060820764977902, 'support': 187553}, 'accuracy': 0.4778779667351897, 'macro avg': {'precision': 0.48733743070931546, 'recall': 0.4780791976425111, 'f1-score': 0.4724764810889579, 'support': 556504}, 'weighted avg': {'precision': 0.48742022843163657, 'recall': 0.4778779667351897, 'f1-score': 0.4723661594504408, 'support': 556504}}
[[ 96716  25969  59791]
 [ 57065  62905  66505]
 [ 53030  28203 106320]]
training model: results/universal/W2/deepVOL_L2/h30
Epoch 1/50
9940/9940 - 333s - loss: 2.9443 - accuracy30: 0.4909 - val_loss: 3.3155 - val_accuracy30: 0.5024 - 333s/epoch - 34ms/step
Epoch 2/50
9940/9940 - 333s - loss: 2.8809 - accuracy30: 0.5133 - val_loss: 3.3438 - val_accuracy30: 0.5095 - 333s/epoch - 34ms/step
Epoch 3/50
9940/9940 - 331s - loss: 2.8541 - accuracy30: 0.5208 - val_loss: 3.3619 - val_accuracy30: 0.5093 - 331s/epoch - 33ms/step
Epoch 4/50
9940/9940 - 335s - loss: 2.8367 - accuracy30: 0.5254 - val_loss: 3.3632 - val_accuracy30: 0.5091 - 335s/epoch - 34ms/step
Epoch 5/50
9940/9940 - 334s - loss: 2.8220 - accuracy30: 0.5286 - val_loss: 3.3385 - val_accuracy30: 0.5119 - 334s/epoch - 34ms/step
Epoch 6/50
9940/9940 - 335s - loss: 2.8108 - accuracy30: 0.5307 - val_loss: 3.3537 - val_accuracy30: 0.5107 - 335s/epoch - 34ms/step
Epoch 7/50
9940/9940 - 335s - loss: 2.8006 - accuracy30: 0.5326 - val_loss: 3.3160 - val_accuracy30: 0.5136 - 335s/epoch - 34ms/step
Epoch 8/50
9940/9940 - 337s - loss: 2.7928 - accuracy30: 0.5342 - val_loss: 3.3241 - val_accuracy30: 0.5128 - 337s/epoch - 34ms/step
Epoch 9/50
9940/9940 - 342s - loss: 2.7859 - accuracy30: 0.5358 - val_loss: 3.3942 - val_accuracy30: 0.5108 - 342s/epoch - 34ms/step
Epoch 10/50
9940/9940 - 338s - loss: 2.7807 - accuracy30: 0.5370 - val_loss: 3.3787 - val_accuracy30: 0.5125 - 338s/epoch - 34ms/step
Epoch 11/50
9940/9940 - 335s - loss: 2.7755 - accuracy30: 0.5380 - val_loss: 3.3996 - val_accuracy30: 0.5122 - 335s/epoch - 34ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 439s - 439s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1283773
{'0': {'precision': 0.42461463024229684, 'recall': 0.4081739794715926, 'f1-score': 0.41623202177897545, 'support': 1845735}, '1': {'precision': 0.5857457331766609, 'recall': 0.6035333226643546, 'f1-score': 0.594506506852732, 'support': 2961858}, '2': {'precision': 0.43422246406681386, 'recall': 0.4300283925786232, 'f1-score': 0.43211525174290216, 'support': 1913176}, 'accuracy': 0.5004904944657375, 'macro avg': {'precision': 0.48152760916192383, 'recall': 0.48057856490485684, 'f1-score': 0.48095126012486983, 'support': 6720769}, 'weighted avg': {'precision': 0.49836049524078496, 'recall': 0.5004904944657375, 'f1-score': 0.49931940719291423, 'support': 6720769}}
[[ 753381  623994  468360]
 [ 570661 1787580  603617]
 [ 450228  640228  822720]]
Evaluating performance on  train set...
9940/9940 - 166s - 166s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1139238
{'0': {'precision': 0.43342524925969195, 'recall': 0.4272765254280411, 'f1-score': 0.43032892456542826, 'support': 746774}, '1': {'precision': 0.5751171392182572, 'recall': 0.5864205221784976, 'f1-score': 0.5807138318504743, 'support': 1043398}, '2': {'precision': 0.43811689770139833, 'recall': 0.432352691345965, 'f1-score': 0.4352157093796824, 'support': 753452}, 'accuracy': 0.49406122917538126, 'macro avg': {'precision': 0.4822197620597825, 'recall': 0.4820165796508346, 'f1-score': 0.482086155265195, 'support': 2543624}, 'weighted avg': {'precision': 0.4929371765338046, 'recall': 0.49406122917538126, 'f1-score': 0.493464541025751, 'support': 2543624}}
[[319079 225054 202641]
 [216387 611870 215141]
 [200714 226981 325757]]
Evaluating performance on  val set...
3393/3393 - 56s - 56s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0987664
{'0': {'precision': 0.44328220858895706, 'recall': 0.3973345274147744, 'f1-score': 0.41905262961666484, 'support': 254589}, '1': {'precision': 0.573137621346623, 'recall': 0.6210433647782821, 'f1-score': 0.5961296000820733, 'support': 355542}, '2': {'precision': 0.44695574310658337, 'recall': 0.44118764440447206, 'f1-score': 0.44405296312987363, 'support': 257956}, 'accuracy': 0.5019900079139533, 'macro avg': {'precision': 0.4877918576807212, 'recall': 0.4865218455325095, 'f1-score': 0.4864117309428706, 'support': 868087}, 'weighted avg': {'precision': 0.4975586387540383, 'recall': 0.5019900079139533, 'f1-score': 0.49900692712940903, 'support': 868087}}
[[101157  82687  70745]
 [ 64660 220807  70075]
 [ 62383  81766 113807]]
testing model out of sample: results/universal/W2/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 240s - 240s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0747628
{'0': {'precision': 0.46365075932862637, 'recall': 0.3305886599660816, 'f1-score': 0.3859734973991062, 'support': 1083189}, '1': {'precision': 0.5445828186760413, 'recall': 0.7427607609946593, 'f1-score': 0.6284177048180125, 'support': 1489314}, '2': {'precision': 0.4732499226641981, 'recall': 0.3732953766575583, 'f1-score': 0.41737165932084674, 'support': 1094230}, 'accuracy': 0.5107448510704216, 'macro avg': {'precision': 0.4938278335562886, 'recall': 0.482214932539433, 'f1-score': 0.4772542871793218, 'support': 3666733}, 'weighted avg': {'precision': 0.49938746050965543, 'recall': 0.5107448510704216, 'f1-score': 0.493816736338922, 'support': 3666733}}
[[ 358090  466900  258199]
 [ 186661 1106204  196449]
 [ 227576  458183  408471]]
Evaluating performance on  train set...
5373/5373 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9859405
{'0': {'precision': 0.4989613459343248, 'recall': 0.34016686466033086, 'f1-score': 0.40453917408615603, 'support': 363648}, '1': {'precision': 0.5942823547032478, 'recall': 0.8255019593960962, 'f1-score': 0.6910644713711499, 'support': 644076}, '2': {'precision': 0.49151550110629944, 'recall': 0.31098025971762244, 'f1-score': 0.38094062461424516, 'support': 367168}, 'accuracy': 0.5597305097418561, 'macro avg': {'precision': 0.5282530672479574, 'recall': 0.49221636125801654, 'f1-score': 0.4921814233571837, 'support': 1374892}, 'weighted avg': {'precision': 0.5416265866150738, 'recall': 0.5597305097418561, 'f1-score': 0.5324615382875821, 'support': 1374892}}
[[123701 174788  65159]
 [ 59425 531686  52965]
 [ 64791 188195 114182]]
Evaluating performance on  val set...
1685/1685 - 31s - 31s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0169318
{'0': {'precision': 0.4881641556698189, 'recall': 0.34025045320501573, 'f1-score': 0.4010022841839949, 'support': 119703}, '1': {'precision': 0.5766675065150928, 'recall': 0.8016938519447929, 'f1-score': 0.6708121810757194, 'support': 191280}, '2': {'precision': 0.48464054698836667, 'recall': 0.32927002481431045, 'f1-score': 0.39212564736551464, 'support': 119689}, 'accuracy': 0.542145762900769, 'macro avg': {'precision': 0.5164907363910928, 'recall': 0.49040477665470633, 'f1-score': 0.48798003754174296, 'support': 430672}, 'weighted avg': {'precision': 0.5264930550415209, 'recall': 0.542145762900769, 'f1-score': 0.5183695643723563, 'support': 430672}}
[[ 40729  55522  23452]
 [ 19476 153348  18456]
 [ 23228  57051  39410]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
987/987 - 8s - 8s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3512774
{'0': {'precision': 0.3482825292287242, 'recall': 0.2922232643025525, 'f1-score': 0.31779964714963055, 'support': 78902}, '1': {'precision': 0.35822265625, 'recall': 0.20571114525734924, 'f1-score': 0.26134412470878254, 'support': 89159}, '2': {'precision': 0.3500255379627368, 'recall': 0.5600350569675723, 'f1-score': 0.4307989450044869, 'support': 84434}, 'accuracy': 0.3512307174399493, 'macro avg': {'precision': 0.35217690781382033, 'recall': 0.3526564888424913, 'f1-score': 0.33664757228763337, 'support': 252495}, 'weighted avg': {'precision': 0.35237536664941593, 'recall': 0.3512307174399493, 'f1-score': 0.3356513463506974, 'support': 252495}}
[[23057 16204 39641]
 [22652 18341 48166]
 [20493 16655 47286]]
Evaluating performance on  train set...
237/237 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3340083
{'0': {'precision': 0.35920599072863424, 'recall': 0.30373385597266195, 'f1-score': 0.32914908100748813, 'support': 19899}, '1': {'precision': 0.3476736176341662, 'recall': 0.27778055736228546, 'f1-score': 0.30882189342529753, 'support': 19987}, '2': {'precision': 0.35564446366782004, 'recall': 0.4777514162591391, 'f1-score': 0.4077525466454532, 'support': 20653}, 'accuracy': 0.35453178942499874, 'macro avg': {'precision': 0.35417469067687346, 'recall': 0.35308860986469554, 'f1-score': 0.34857450702607967, 'support': 60539}, 'weighted avg': {'precision': 0.35418354636341304, 'recall': 0.35453178942499874, 'f1-score': 0.3492537718285398, 'support': 60539}}
[[6044 4886 8969]
 [5527 5552 8908]
 [5255 5531 9867]]
Evaluating performance on  val set...
85/85 - 1s - 809ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.326603
{'0': {'precision': 0.35629304946775203, 'recall': 0.2526269054314045, 'f1-score': 0.29563560789747145, 'support': 6757}, '1': {'precision': 0.38054226475279107, 'recall': 0.304764337718738, 'f1-score': 0.33846372083126464, 'support': 7829}, '2': {'precision': 0.3506974096214062, 'recall': 0.5269461077844312, 'f1-score': 0.42112459408648095, 'support': 7014}, 'accuracy': 0.36060185185185184, 'macro avg': {'precision': 0.3625109079473164, 'recall': 0.36144578364485785, 'f1-score': 0.35174130760507233, 'support': 21600}, 'weighted avg': {'precision': 0.3632652387540623, 'recall': 0.36060185185185184, 'f1-score': 0.3519078785126742, 'support': 21600}}
[[1707 1973 3077]
 [1677 2386 3766]
 [1407 1911 3696]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9555314
{'0': {'precision': 0.4682628167576863, 'recall': 0.33515472841376326, 'f1-score': 0.39068227503842967, 'support': 73936}, '1': {'precision': 0.6432324210726594, 'recall': 0.8880504346164868, 'f1-score': 0.7460709547824386, 'support': 167504}, '2': {'precision': 0.5827558516491688, 'recall': 0.25660367474691914, 'f1-score': 0.3563128511938317, 'support': 76359}, 'accuracy': 0.6076985767733694, 'macro avg': {'precision': 0.5647503631598382, 'recall': 0.4932696125923897, 'f1-score': 0.4976886936715667, 'support': 317799}, 'weighted avg': {'precision': 0.5879947298614216, 'recall': 0.6076985767733694, 'f1-score': 0.5697407697992402, 'support': 317799}}
[[ 24780  40842   8314]
 [ 13037 148752   5715]
 [ 15102  41663  19594]]
Evaluating performance on  train set...
528/528 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7961605
{'0': {'precision': 0.5647923364608621, 'recall': 0.3366445052796246, 'f1-score': 0.42184705104016074, 'support': 25570}, '1': {'precision': 0.7186345861394743, 'recall': 0.9507095383509969, 'f1-score': 0.8185403424117292, 'support': 83505}, '2': {'precision': 0.631344419084882, 'recall': 0.2248152018266961, 'f1-score': 0.33156392694063924, 'support': 25839}, 'accuracy': 0.6953021925078198, 'macro avg': {'precision': 0.6382571138950729, 'recall': 0.5040564151524392, 'f1-score': 0.5239837734641764, 'support': 134914}, 'weighted avg': {'precision': 0.6727591621597115, 'recall': 0.6953021925078198, 'f1-score': 0.6500890989549457, 'support': 134914}}
[[ 8608 14667  2295]
 [ 3019 79389  1097]
 [ 3614 16416  5809]]
Evaluating performance on  val set...
159/159 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8419584
{'0': {'precision': 0.5438423645320197, 'recall': 0.3235638921453693, 'f1-score': 0.4057331863285557, 'support': 8530}, '1': {'precision': 0.6961939214049407, 'recall': 0.9410314276161819, 'f1-score': 0.8003056636633433, 'support': 23928}, '2': {'precision': 0.6137865911237016, 'recall': 0.23964606120191717, 'f1-score': 0.34470567438571675, 'support': 8137}, 'accuracy': 0.670698361867225, 'macro avg': {'precision': 0.6179409590202206, 'recall': 0.5014137936544895, 'f1-score': 0.5169148414592053, 'support': 40595}, 'weighted avg': {'precision': 0.6476631361697034, 'recall': 0.670698361867225, 'f1-score': 0.6260743459045606, 'support': 40595}}
[[ 2760  5032   738]
 [  922 22517   489]
 [ 1393  4794  1950]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3268293
{'0': {'precision': 0.4406393361189843, 'recall': 0.3184726827310933, 'f1-score': 0.36972564787800033, 'support': 94702}, '1': {'precision': 0.3742503034222486, 'recall': 0.5469458038789197, 'f1-score': 0.44441054718936224, 'support': 77238}, '2': {'precision': 0.4590474549995694, 'recall': 0.4169233326488907, 'f1-score': 0.4369725508682575, 'support': 102273}, 'accuracy': 0.4195461192576574, 'macro avg': {'precision': 0.4246456981802674, 'recall': 0.4274472730863012, 'f1-score': 0.41703624864520666, 'support': 274213}, 'weighted avg': {'precision': 0.42880509571041, 'recall': 0.4195461192576574, 'f1-score': 0.4158432818433249, 'support': 274213}}
[[30160 33533 31009]
 [15754 42245 19239]
 [22532 37101 42640]]
Evaluating performance on  train set...
286/286 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3415245
{'0': {'precision': 0.4514472719065621, 'recall': 0.3228813559322034, 'f1-score': 0.3764910712185022, 'support': 24780}, '1': {'precision': 0.4068089542411939, 'recall': 0.6253531817990132, 'f1-score': 0.49294440289204683, 'support': 23713}, '2': {'precision': 0.4358199459201527, 'recall': 0.33492238112700157, 'f1-score': 0.37876693392314076, 'support': 24543}, 'accuracy': 0.42513281121638646, 'macro avg': {'precision': 0.43135872402263625, 'recall': 0.4277189729527395, 'f1-score': 0.41606746934456323, 'support': 73036}, 'weighted avg': {'precision': 0.4317029007952838, 'recall': 0.42513281121638646, 'f1-score': 0.4150653955562905, 'support': 73036}}
[[ 8001 10640  6139]
 [ 4382 14829  4502]
 [ 5340 10983  8220]]
Evaluating performance on  val set...
117/117 - 1s - 999ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3685496
{'0': {'precision': 0.4297911467227111, 'recall': 0.33177854390590145, 'f1-score': 0.37447782546494995, 'support': 9862}, '1': {'precision': 0.4159971045964531, 'recall': 0.578809547789304, 'f1-score': 0.4840801886792453, 'support': 9929}, '2': {'precision': 0.4217873762080897, 'recall': 0.3528648432820922, 'f1-score': 0.38426001413120275, 'support': 10018}, 'accuracy': 0.42114797544365795, 'macro avg': {'precision': 0.42252520917575137, 'recall': 0.4211509783257659, 'f1-score': 0.41427267609179935, 'support': 29809}, 'weighted avg': {'precision': 0.42250667500990324, 'recall': 0.42114797544365795, 'f1-score': 0.41427251265382775, 'support': 29809}}
[[3272 3890 2700]
 [2036 5747 2146]
 [2305 4178 3535]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
860/860 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.5258864
{'0': {'precision': 0.3358258860721016, 'recall': 0.07398379428112235, 'f1-score': 0.1212546919244024, 'support': 74665}, '1': {'precision': 0.29705989465845534, 'recall': 0.8122677684967747, 'f1-score': 0.435024178623311, 'support': 67282}, '2': {'precision': 0.2706177645733019, 'recall': 0.06773337436055232, 'f1-score': 0.1083481167772434, 'support': 77997}, 'accuracy': 0.2976121194485869, 'macro avg': {'precision': 0.30116784843461963, 'recall': 0.3179949790461498, 'f1-score': 0.22154232910831895, 'support': 219944}, 'weighted avg': {'precision': 0.30084293001585627, 'recall': 0.2976121194485869, 'f1-score': 0.2126614339238341, 'support': 219944}}
[[ 5524 61947  7194]
 [ 5586 54651  7045]
 [ 5339 67375  5283]]
Evaluating performance on  train set...
320/320 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4360883
{'0': {'precision': 0.3173639226270805, 'recall': 0.1003556187766714, 'f1-score': 0.1524910839727656, 'support': 28120}, '1': {'precision': 0.3210073064739498, 'recall': 0.740988425500643, 'f1-score': 0.4479541516726642, 'support': 27215}, '2': {'precision': 0.25830073227003714, 'recall': 0.09773408737237636, 'f1-score': 0.14181077211146603, 'support': 26347}, 'accuracy': 0.3129575671506574, 'macro avg': {'precision': 0.29889065379035584, 'recall': 0.31302604388323024, 'f1-score': 0.2474186692522986, 'support': 81682}, 'weighted avg': {'precision': 0.2995266612360216, 'recall': 0.3129575671506574, 'f1-score': 0.24748916446593522, 'support': 81682}}
[[ 2822 21674  3624]
 [ 3279 20166  3770]
 [ 2791 20981  2575]]
Evaluating performance on  val set...
98/98 - 1s - 955ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4567381
{'0': {'precision': 0.3417598444336412, 'recall': 0.08074890879852975, 'f1-score': 0.13063272321843353, 'support': 8706}, '1': {'precision': 0.32244735401005625, 'recall': 0.7838557424664165, 'f1-score': 0.4569312169312169, 'support': 8263}, '2': {'precision': 0.26766063187788425, 'recall': 0.09434434434434434, 'f1-score': 0.13951336848922194, 'support': 7992}, 'accuracy': 0.31785585513400905, 'macro avg': {'precision': 0.3106226101071939, 'recall': 0.3196496652030969, 'f1-score': 0.24235910287962412, 'support': 24961}, 'weighted avg': {'precision': 0.31164165946045536, 'recall': 0.31785585513400905, 'f1-score': 0.24149280777245263, 'support': 24961}}
[[ 703 6975 1028]
 [ 751 6477 1035]
 [ 603 6635  754]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 16s - 16s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.306404
{'0': {'precision': 0.4589576518970319, 'recall': 0.3160167987908694, 'f1-score': 0.37430479883390183, 'support': 167393}, '1': {'precision': 0.4003329658709982, 'recall': 0.6053628897824771, 'f1-score': 0.4819483340465524, 'support': 146973}, '2': {'precision': 0.46267755798313814, 'recall': 0.401696353807682, 'f1-score': 0.43003585715679576, 'support': 175553}, 'accuracy': 0.4335206432083671, 'macro avg': {'precision': 0.44065605858372275, 'recall': 0.4410253474603428, 'f1-score': 0.42876299667908335, 'support': 489919}, 'weighted avg': {'precision': 0.4427035255900913, 'recall': 0.4335206432083671, 'f1-score': 0.42656741323050185, 'support': 489919}}
[[52899 64732 49762]
 [25867 88972 32134]
 [36493 68541 70519]]
Evaluating performance on  train set...
716/716 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2639228
{'0': {'precision': 0.5005514126667366, 'recall': 0.3068194621042636, 'f1-score': 0.38044204959337424, 'support': 62131}, '1': {'precision': 0.427574073556927, 'recall': 0.7758821641526326, 'f1-score': 0.5513239071464578, 'support': 59201}, '2': {'precision': 0.4755402959650804, 'recall': 0.2893394438956454, 'f1-score': 0.3597756813628263, 'support': 61751}, 'accuracy': 0.4525980019990933, 'macro avg': {'precision': 0.4678885940629147, 'recall': 0.45734702338418054, 'f1-score': 0.43051387936755275, 'support': 183083}, 'weighted avg': {'precision': 0.46851789278731687, 'recall': 0.4525980019990933, 'f1-score': 0.4287272969642144, 'support': 183083}}
[[19063 29980 13088]
 [ 6651 45933  6617]
 [12370 31514 17867]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3649868
{'0': {'precision': 0.46000134562336004, 'recall': 0.3415767386091127, 'f1-score': 0.39204105622294216, 'support': 20016}, '1': {'precision': 0.33982560508516013, 'recall': 0.576643849823688, 'f1-score': 0.42763748237405463, 'support': 14463}, '2': {'precision': 0.4533412027018165, 'recall': 0.34265179677819085, 'f1-score': 0.3903003613369467, 'support': 20175}, 'accuracy': 0.4041790170893256, 'macro avg': {'precision': 0.41772271780344555, 'recall': 0.4202907950703305, 'f1-score': 0.40332629997798114, 'support': 54654}, 'weighted avg': {'precision': 0.4257409050545796, 'recall': 0.4041790170893256, 'f1-score': 0.4008183203225247, 'support': 54654}}
[[6837 7837 5342]
 [3129 8340 2994]
 [4897 8365 6913]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
4918/4918 - 44s - 44s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72241336
{'0': {'precision': 0.6015069894306171, 'recall': 0.36252933367855633, 'f1-score': 0.45239774239622943, 'support': 243321}, '1': {'precision': 0.719715949495502, 'recall': 0.9437942866980464, 'f1-score': 0.8166632057926004, 'support': 766737}, '2': {'precision': 0.6850675511083628, 'recall': 0.29391312037494827, 'f1-score': 0.41134691925797784, 'support': 248781}, 'accuracy': 0.7030072948168908, 'macro avg': {'precision': 0.6687634966781607, 'recall': 0.5334122469171837, 'f1-score': 0.5601359558156025, 'support': 1258839}, 'weighted avg': {'precision': 0.690019867970304, 'recall': 0.7030072948168908, 'f1-score': 0.6661527529869292, 'support': 1258839}}
[[ 88211 137573  17537]
 [ 27018 723642  16077]
 [ 31421 144240  73120]]
Evaluating performance on  train set...
1403/1403 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6754042
{'0': {'precision': 0.5866574796367842, 'recall': 0.382934978154716, 'f1-score': 0.4633940112544099, 'support': 62256}, '1': {'precision': 0.7545450205940918, 'recall': 0.9450356578554042, 'f1-score': 0.8391151522964861, 'support': 234170}, '2': {'precision': 0.7074436240271403, 'recall': 0.28335518112350927, 'f1-score': 0.4046387928180895, 'support': 62554}, 'accuracy': 0.7322524931751072, 'macro avg': {'precision': 0.6828820414193387, 'recall': 0.5371086057112099, 'f1-score': 0.5690493187896618, 'support': 358980}, 'weighted avg': {'precision': 0.7172215276120671, 'recall': 0.7322524931751072, 'f1-score': 0.698246219354464, 'support': 358980}}
[[ 23840  34863   3553]
 [  9094 221299   3777]
 [  7703  37126  17725]]
Evaluating performance on  val set...
480/480 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7041309
{'0': {'precision': 0.6197160503729847, 'recall': 0.34063753802742386, 'f1-score': 0.43962672129281893, 'support': 22681}, '1': {'precision': 0.7326909101768987, 'recall': 0.9502911518250249, 'f1-score': 0.8274237791168271, 'support': 77451}, '2': {'precision': 0.7029702970297029, 'recall': 0.3049369050254594, 'f1-score': 0.4253597677722192, 'support': 22585}, 'accuracy': 0.7188409103873139, 'macro avg': {'precision': 0.6851257525265287, 'recall': 0.531955198292636, 'f1-score': 0.5641367560606217, 'support': 122717}, 'weighted avg': {'precision': 0.7063406665827594, 'recall': 0.7188409103873139, 'f1-score': 0.6817533278775995, 'support': 122717}}
[[ 7726 13426  1529]
 [ 2469 73601  1381]
 [ 2272 13426  6887]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
4856/4856 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9852752
{'0': {'precision': 0.5071777168212195, 'recall': 0.2952084205215816, 'f1-score': 0.3731947144609464, 'support': 348862}, '1': {'precision': 0.5812998376794278, 'recall': 0.8553875917326252, 'f1-score': 0.6921988152018005, 'support': 555146}, '2': {'precision': 0.513815128462753, 'recall': 0.3380142049059154, 'f1-score': 0.40777372957829705, 'support': 338897}, 'accuracy': 0.5570852156842236, 'macro avg': {'precision': 0.5340975609878001, 'recall': 0.4962034057200407, 'f1-score': 0.49105575308034793, 'support': 1242905}, 'weighted avg': {'precision': 0.5420943015956243, 'recall': 0.5570852156842236, 'f1-score': 0.5251070287537579, 'support': 1242905}}
[[102987 177378  68497]
 [ 40386 474865  39895]
 [ 59686 164659 114552]]
Evaluating performance on  train set...
2076/2076 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8135705
{'0': {'precision': 0.5318909648123937, 'recall': 0.3345151365115292, 'f1-score': 0.4107209735286615, 'support': 113104}, '1': {'precision': 0.6784092096295153, 'recall': 0.8996773789181308, 'f1-score': 0.7735309633612989, 'support': 303142}, '2': {'precision': 0.5605959185074576, 'recall': 0.2836129345976173, 'f1-score': 0.37666568642714227, 'support': 115164}, 'accuracy': 0.6458798291338138, 'macro avg': {'precision': 0.5902986976497889, 'recall': 0.5059351500090924, 'f1-score': 0.5203058744390342, 'support': 531410}, 'weighted avg': {'precision': 0.6216928335346426, 'recall': 0.6458798291338138, 'f1-score': 0.61030510415113, 'support': 531410}}
[[ 37835  62124  13145]
 [ 17956 272730  12456]
 [ 15342  67160  32662]]
Evaluating performance on  val set...
588/588 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8089572
{'0': {'precision': 0.5692881566677028, 'recall': 0.2870892901931277, 'f1-score': 0.3816927533815469, 'support': 31896}, '1': {'precision': 0.6716301976598136, 'recall': 0.9369005901881224, 'f1-score': 0.7823918986561934, 'support': 86752}, '2': {'precision': 0.6126126126126126, 'recall': 0.25557450571663193, 'f1-score': 0.3606783891600366, 'support': 31662}, 'accuracy': 0.6554919832346484, 'macro avg': {'precision': 0.6178436556467096, 'recall': 0.493188128699294, 'f1-score': 0.5082543470659256, 'support': 150310}, 'weighted avg': {'precision': 0.6374813285410001, 'recall': 0.6554919832346484, 'f1-score': 0.6085312568136849, 'support': 150310}}
[[ 9157 19723  3016]
 [ 3373 81278  2101]
 [ 3555 20015  8092]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
4353/4353 - 33s - 33s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90822977
{'0': {'precision': 0.5673302981014411, 'recall': 0.28759014758460283, 'f1-score': 0.3816930685972332, 'support': 277739}, '1': {'precision': 0.6172146143624933, 'recall': 0.89613004934619, 'f1-score': 0.7309697203681059, 'support': 555666}, '2': {'precision': 0.5240180172615442, 'recall': 0.31105122061498913, 'f1-score': 0.39037827404091036, 'support': 280883}, 'accuracy': 0.5969668523756875, 'macro avg': {'precision': 0.5695209765751595, 'recall': 0.4982571391819273, 'f1-score': 0.5010136876687498, 'support': 1114288}, 'weighted avg': {'precision': 0.58128839071337, 'recall': 0.5969668523756875, 'f1-score': 0.5580574255171229, 'support': 1114288}}
[[ 79875 151276  46588]
 [ 24945 497949  32772]
 [ 35971 157543  87369]]
Evaluating performance on  train set...
1542/1542 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.004434
{'0': {'precision': 0.5312187853084216, 'recall': 0.2987090714890796, 'f1-score': 0.3823943703476687, 'support': 108604}, '1': {'precision': 0.5684690711378064, 'recall': 0.8893478442397083, 'f1-score': 0.6935942882819911, 'support': 179635}, '2': {'precision': 0.5438984407761809, 'recall': 0.26836838343177455, 'f1-score': 0.3594019623896313, 'support': 106324}, 'accuracy': 0.5594366425640519, 'macro avg': {'precision': 0.5478620990741363, 'recall': 0.4854750997201875, 'f1-score': 0.4784635403397637, 'support': 394563}, 'weighted avg': {'precision': 0.5515947627389348, 'recall': 0.5594366425640519, 'f1-score': 0.5178803446392309, 'support': 394563}}
[[ 32441  60868  15295]
 [ 11244 159758   8633]
 [ 17384  60406  28534]]
Evaluating performance on  val set...
482/482 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9745155
{'0': {'precision': 0.5391455215788332, 'recall': 0.3002959473334541, 'f1-score': 0.38574033127739626, 'support': 33114}, '1': {'precision': 0.5790225001699408, 'recall': 0.8897167627038978, 'f1-score': 0.7015077997927377, 'support': 57443}, '2': {'precision': 0.5407831325301204, 'recall': 0.2740817635025799, 'f1-score': 0.36378740907340995, 'support': 32753}, 'accuracy': 0.5679101451625983, 'macro avg': {'precision': 0.5529837180929649, 'recall': 0.48803149117997724, 'f1-score': 0.48367851338118134, 'support': 123310}, 'weighted avg': {'precision': 0.5581568746945296, 'recall': 0.5679101451625983, 'f1-score': 0.5270071112058659, 'support': 123310}}
[[ 9944 18620  4550]
 [ 3262 51108  3073]
 [ 5238 18538  8977]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9740117
{'0': {'precision': 0.46657822609914523, 'recall': 0.3791320265425978, 'f1-score': 0.4183341702410575, 'support': 393330}, '1': {'precision': 0.5817140568875637, 'recall': 0.7768775028270065, 'f1-score': 0.6652780383371774, 'support': 620798}, '2': {'precision': 0.5140165947817341, 'recall': 0.33805679860992743, 'f1-score': 0.4078681620901551, 'support': 393073}, 'accuracy': 0.5431271012456642, 'macro avg': {'precision': 0.5207696259228144, 'recall': 0.49802210932651053, 'f1-score': 0.49716012355613, 'support': 1407201}, 'weighted avg': {'precision': 0.5306222648505104, 'recall': 0.5431271012456642, 'f1-score': 0.5243519702599854, 'support': 1407201}}
[[149124 175220  68986]
 [ 81866 482284  56648]
 [ 88622 171570 132881]]
Evaluating performance on  train set...
2058/2058 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9738159
{'0': {'precision': 0.5091635450896236, 'recall': 0.3697594167002936, 'f1-score': 0.42840618261693164, 'support': 143734}, '1': {'precision': 0.5797139360700938, 'recall': 0.8099843299038368, 'f1-score': 0.6757714469976307, 'support': 238033}, '2': {'precision': 0.5085243712441576, 'recall': 0.31502099174807147, 'f1-score': 0.38903953311169476, 'support': 145057}, 'accuracy': 0.5535928507433222, 'macro avg': {'precision': 0.5324672841346251, 'recall': 0.49825491278406736, 'f1-score': 0.49773905424208564, 'support': 526824}, 'weighted avg': {'precision': 0.5408640837434292, 'recall': 0.5535928507433222, 'f1-score': 0.5293330346567966, 'support': 526824}}
[[ 53147  66921  23666]
 [ 24732 192803  20498]
 [ 26502  72859  45696]]
Evaluating performance on  val set...
681/681 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98910135
{'0': {'precision': 0.4908098866007895, 'recall': 0.3814586101774408, 'f1-score': 0.4292798786052802, 'support': 51172}, '1': {'precision': 0.5537048474826164, 'recall': 0.7686945938844095, 'f1-score': 0.6437236882488173, 'support': 72307}, '2': {'precision': 0.5054471973291161, 'recall': 0.3396103896103896, 'f1-score': 0.4062566202951769, 'support': 50820}, 'accuracy': 0.5298997699355705, 'macro avg': {'precision': 0.5166539771375074, 'recall': 0.49658786455741327, 'f1-score': 0.4930867290497582, 'support': 174299}, 'weighted avg': {'precision': 0.5211692923787676, 'recall': 0.5298997699355705, 'f1-score': 0.511527892400975, 'support': 174299}}
[[19520 22228  9424]
 [ 9262 55582  7463]
 [10989 22572 17259]]
testing model on single stock: results/universal/W2/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 129s - 129s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3184658
{'0': {'precision': 0.39150458680655714, 'recall': 0.471996660074111, 'f1-score': 0.42799905163756363, 'support': 1176074}, '1': {'precision': 0.4397151412823012, 'recall': 0.25789563235182095, 'f1-score': 0.32511141943786803, 'support': 1404669}, '2': {'precision': 0.4065142990509386, 'recall': 0.5186388058147217, 'f1-score': 0.4557820527165658, 'support': 1229156}, 'accuracy': 0.40810766899594975, 'macro avg': {'precision': 0.41257800904659897, 'recall': 0.41617703274688456, 'f1-score': 0.40296417459733247, 'support': 3809899}, 'weighted avg': {'precision': 0.41412176096480746, 'recall': 0.40810766899594975, 'f1-score': 0.3990288807852518, 'support': 3809899}}
[[555103 232270 388701]
 [500419 362258 541992]
 [362349 229319 637488]]
Evaluating performance on  train set...
6147/6147 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2524023
{'0': {'precision': 0.41247925426886467, 'recall': 0.48162282851803057, 'f1-score': 0.444377502235006, 'support': 522224}, '1': {'precision': 0.41605024203499225, 'recall': 0.2534358118460587, 'f1-score': 0.31499395767136196, 'support': 518873}, '2': {'precision': 0.41983413906563877, 'recall': 0.5107290171829568, 'f1-score': 0.4608423958869156, 'support': 532388}, 'accuracy': 0.4162238597762292, 'macro avg': {'precision': 0.4161212117898319, 'recall': 0.41526255251568206, 'f1-score': 0.4067379519310945, 'support': 1573485}, 'weighted avg': {'precision': 0.4161453467593294, 'recall': 0.4162238597762292, 'f1-score': 0.4072828263297264, 'support': 1573485}}
[[251515  92685 178024]
 [189651 131501 197721]
 [168598  91884 271906]]
Evaluating performance on  val set...
2174/2174 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2164059
{'0': {'precision': 0.42095401506339575, 'recall': 0.44052038467046345, 'f1-score': 0.43051499777960195, 'support': 181558}, '1': {'precision': 0.46536076604195453, 'recall': 0.3556142780581247, 'f1-score': 0.4031521641050321, 'support': 188457}, '2': {'precision': 0.42760703659424526, 'recall': 0.5101641383674104, 'f1-score': 0.46525161192519005, 'support': 186489}, 'accuracy': 0.43510558774060926, 'macro avg': {'precision': 0.4379739392331985, 'recall': 0.43543293369866615, 'f1-score': 0.43297292460327474, 'support': 556504}, 'weighted avg': {'precision': 0.4382215969701436, 'recall': 0.43510558774060926, 'f1-score': 0.43288924646350746, 'support': 556504}}
[[79980 38532 63046]
 [57131 67018 64308]
 [52886 38463 95140]]
training model: results/universal/W2/deepVOL_L3/h10
Epoch 1/50
9940/9940 - 570s - loss: 2.7919 - accuracy10: 0.5188 - val_loss: 2.9407 - val_accuracy10: 0.5414 - 570s/epoch - 57ms/step
Epoch 2/50
9940/9940 - 558s - loss: 2.6803 - accuracy10: 0.5571 - val_loss: 2.8006 - val_accuracy10: 0.5594 - 558s/epoch - 56ms/step
Epoch 3/50
9940/9940 - 563s - loss: 2.6395 - accuracy10: 0.5660 - val_loss: 2.8787 - val_accuracy10: 0.5457 - 563s/epoch - 57ms/step
Epoch 4/50
9940/9940 - 541s - loss: 2.6186 - accuracy10: 0.5708 - val_loss: 2.7881 - val_accuracy10: 0.5542 - 541s/epoch - 54ms/step
Epoch 5/50
9940/9940 - 561s - loss: 2.6005 - accuracy10: 0.5740 - val_loss: 2.7784 - val_accuracy10: 0.5598 - 561s/epoch - 56ms/step
Epoch 6/50
9940/9940 - 559s - loss: 2.5879 - accuracy10: 0.5767 - val_loss: 2.7513 - val_accuracy10: 0.5583 - 559s/epoch - 56ms/step
Epoch 7/50
9940/9940 - 554s - loss: 2.5780 - accuracy10: 0.5788 - val_loss: 2.7261 - val_accuracy10: 0.5664 - 554s/epoch - 56ms/step
Epoch 8/50
9940/9940 - 549s - loss: 2.5690 - accuracy10: 0.5807 - val_loss: 2.7215 - val_accuracy10: 0.5600 - 549s/epoch - 55ms/step
Epoch 9/50
9940/9940 - 549s - loss: 2.5619 - accuracy10: 0.5823 - val_loss: 2.7055 - val_accuracy10: 0.5668 - 549s/epoch - 55ms/step
Epoch 10/50
9940/9940 - 574s - loss: 2.5557 - accuracy10: 0.5836 - val_loss: 2.6902 - val_accuracy10: 0.5679 - 574s/epoch - 58ms/step
Epoch 11/50
9940/9940 - 550s - loss: 2.5494 - accuracy10: 0.5850 - val_loss: 2.7202 - val_accuracy10: 0.5647 - 550s/epoch - 55ms/step
Epoch 12/50
9940/9940 - 549s - loss: 2.5446 - accuracy10: 0.5859 - val_loss: 2.6902 - val_accuracy10: 0.5687 - 549s/epoch - 55ms/step
Epoch 13/50
9940/9940 - 564s - loss: 2.5400 - accuracy10: 0.5870 - val_loss: 2.6845 - val_accuracy10: 0.5729 - 564s/epoch - 57ms/step
Epoch 14/50
9940/9940 - 579s - loss: 2.5356 - accuracy10: 0.5880 - val_loss: 2.6920 - val_accuracy10: 0.5735 - 579s/epoch - 58ms/step
Epoch 15/50
9940/9940 - 599s - loss: 2.5319 - accuracy10: 0.5886 - val_loss: 2.6727 - val_accuracy10: 0.5778 - 599s/epoch - 60ms/step
Epoch 16/50
9940/9940 - 584s - loss: 2.5287 - accuracy10: 0.5893 - val_loss: 2.6670 - val_accuracy10: 0.5762 - 584s/epoch - 59ms/step
Epoch 17/50
9940/9940 - 567s - loss: 2.5255 - accuracy10: 0.5899 - val_loss: 2.6816 - val_accuracy10: 0.5709 - 567s/epoch - 57ms/step
Epoch 18/50
9940/9940 - 544s - loss: 2.5224 - accuracy10: 0.5905 - val_loss: 2.6832 - val_accuracy10: 0.5675 - 544s/epoch - 55ms/step
Epoch 19/50
9940/9940 - 537s - loss: 2.5198 - accuracy10: 0.5910 - val_loss: 2.6799 - val_accuracy10: 0.5711 - 537s/epoch - 54ms/step
Epoch 20/50
9940/9940 - 539s - loss: 2.5172 - accuracy10: 0.5917 - val_loss: 2.6648 - val_accuracy10: 0.5738 - 539s/epoch - 54ms/step
Epoch 21/50
9940/9940 - 555s - loss: 2.5145 - accuracy10: 0.5920 - val_loss: 2.6714 - val_accuracy10: 0.5749 - 555s/epoch - 56ms/step
Epoch 22/50
9940/9940 - 563s - loss: 2.5126 - accuracy10: 0.5925 - val_loss: 2.6847 - val_accuracy10: 0.5699 - 563s/epoch - 57ms/step
Epoch 23/50
9940/9940 - 549s - loss: 2.5106 - accuracy10: 0.5929 - val_loss: 2.6946 - val_accuracy10: 0.5685 - 549s/epoch - 55ms/step
Epoch 24/50
9940/9940 - 554s - loss: 2.5085 - accuracy10: 0.5933 - val_loss: 2.7009 - val_accuracy10: 0.5689 - 554s/epoch - 56ms/step
Epoch 25/50
9940/9940 - 542s - loss: 2.5063 - accuracy10: 0.5940 - val_loss: 2.6868 - val_accuracy10: 0.5681 - 542s/epoch - 55ms/step
Epoch 26/50
9940/9940 - 551s - loss: 2.5044 - accuracy10: 0.5942 - val_loss: 2.6921 - val_accuracy10: 0.5689 - 551s/epoch - 55ms/step
Epoch 27/50
9940/9940 - 563s - loss: 2.5027 - accuracy10: 0.5946 - val_loss: 2.6844 - val_accuracy10: 0.5711 - 563s/epoch - 57ms/step
Epoch 28/50
9940/9940 - 548s - loss: 2.5011 - accuracy10: 0.5947 - val_loss: 2.7027 - val_accuracy10: 0.5662 - 548s/epoch - 55ms/step
Epoch 29/50
9940/9940 - 559s - loss: 2.4998 - accuracy10: 0.5952 - val_loss: 2.6856 - val_accuracy10: 0.5682 - 559s/epoch - 56ms/step
Epoch 30/50
9940/9940 - 564s - loss: 2.4982 - accuracy10: 0.5956 - val_loss: 2.6990 - val_accuracy10: 0.5653 - 564s/epoch - 57ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 790s - 790s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88933283
{'0': {'precision': 0.45964419135542023, 'recall': 0.5187711330166705, 'f1-score': 0.4874211022543229, 'support': 1585493}, '1': {'precision': 0.8099055892278587, 'recall': 0.5612271402157902, 'f1-score': 0.6630153127065538, 'support': 3511188}, '2': {'precision': 0.42990865944049256, 'recall': 0.6613016043465625, 'f1-score': 0.5210715031653285, 'support': 1624088}, 'accuracy': 0.5753945716628558, 'macro avg': {'precision': 0.5664861466745905, 'recall': 0.5804332925263411, 'f1-score': 0.5571693060420685, 'support': 6720769}, 'weighted avg': {'precision': 0.635448551915392, 'recall': 0.5753945716628558, 'f1-score': 0.5872899560899629, 'support': 6720769}}
[[ 822508  222694  540291]
 [ 656684 1970574  883930]
 [ 310253  239823 1074012]]
Evaluating performance on  train set...
9940/9940 - 316s - 316s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91670936
{'0': {'precision': 0.4653468951298084, 'recall': 0.5393774382314694, 'f1-score': 0.4996347910563262, 'support': 639808}, '1': {'precision': 0.8145475217172253, 'recall': 0.5293064742179127, 'f1-score': 0.6416549388656841, 'support': 1261496}, '2': {'precision': 0.4357847478850441, 'recall': 0.6664388466807821, 'f1-score': 0.5269781670677885, 'support': 642320}, 'accuracy': 0.5664685503832327, 'macro avg': {'precision': 0.5718930549106926, 'recall': 0.5783742530433881, 'f1-score': 0.5560892989965996, 'support': 2543624}, 'weighted avg': {'precision': 0.6310658988895085, 'recall': 0.5664685503832327, 'f1-score': 0.5769736767016088, 'support': 2543624}}
[[345098  74545 220165]
 [259720 667718 334058]
 [136775  77478 428067]]
Evaluating performance on  val set...
3393/3393 - 97s - 97s/epoch - 29ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89823335
{'0': {'precision': 0.47379593062291747, 'recall': 0.5193169144131791, 'f1-score': 0.495513157406943, 'support': 218772}, '1': {'precision': 0.808428043269889, 'recall': 0.553596084287218, 'f1-score': 0.6571727917696871, 'support': 426589}, '2': {'precision': 0.4401652705725572, 'recall': 0.664372367842102, 'f1-score': 0.5295132241430518, 'support': 222726}, 'accuracy': 0.573379165913094, 'macro avg': {'precision': 0.5741297481551212, 'recall': 0.579095122180833, 'f1-score': 0.5607330577732274, 'support': 868087}, 'weighted avg': {'precision': 0.6296097556330633, 'recall': 0.573379165913094, 'f1-score': 0.5836781922790644, 'support': 868087}}
[[113612  27569  77591]
 [ 79819 236158 110612]
 [ 46360  28393 147973]]
testing model out of sample: results/universal/W2/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 445s - 445s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86368394
{'0': {'precision': 0.4652920546619906, 'recall': 0.5075820994332015, 'f1-score': 0.4855179201971325, 'support': 833806}, '1': {'precision': 0.8015509543493271, 'recall': 0.6381473753754829, 'f1-score': 0.7105761355512697, 'support': 2010078}, '2': {'precision': 0.44209993101886347, 'recall': 0.6215453868206682, 'f1-score': 0.5166857184999446, 'support': 822849}, 'accuracy': 0.6047315144026031, 'macro avg': {'precision': 0.5696476466767271, 'recall': 0.5890916205431176, 'f1-score': 0.5709265914161157, 'support': 3666733}, 'weighted avg': {'precision': 0.6444223597095897, 'recall': 0.6047315144026031, 'f1-score': 0.6158876414362531, 'support': 3666733}}
[[ 423225  162938  247643]
 [ 329595 1282726  397757]
 [ 156770  154641  511438]]
Evaluating performance on  train set...
5373/5373 - 176s - 176s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75203
{'0': {'precision': 0.47754996930935467, 'recall': 0.5172811720245624, 'f1-score': 0.49662218553675425, 'support': 261701}, '1': {'precision': 0.823270734250216, 'recall': 0.7399139918948454, 'f1-score': 0.7793698661469002, 'support': 847362}, '2': {'precision': 0.45530419703382125, 'recall': 0.5649609335324588, 'f1-score': 0.504239685334936, 'support': 265829}, 'accuracy': 0.6637110405762779, 'macro avg': {'precision': 0.585374966864464, 'recall': 0.6073853658172889, 'f1-score': 0.5934105790061969, 'support': 1374892}, 'weighted avg': {'precision': 0.6863205981468091, 'recall': 0.6637110405762779, 'f1-score': 0.6723556922347533, 'support': 1374892}}
[[135373  62411  63917]
 [104635 626975 115752]
 [ 43466  72180 150183]]
Evaluating performance on  val set...
1685/1685 - 52s - 52s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78513414
{'0': {'precision': 0.4797678779054542, 'recall': 0.5157476325064466, 'f1-score': 0.4971075680779708, 'support': 88807}, '1': {'precision': 0.8164736628666697, 'recall': 0.7147026805294795, 'f1-score': 0.7622060227736391, 'support': 253532}, '2': {'precision': 0.45310968881041713, 'recall': 0.5810512492499972, 'f1-score': 0.5091663029244873, 'support': 88333}, 'accuracy': 0.6462644425456031, 'macro avg': {'precision': 0.5831170765275137, 'recall': 0.6038338540953078, 'f1-score': 0.5894932979253658, 'support': 430672}, 'weighted avg': {'precision': 0.6725152430823288, 'recall': 0.6462644425456031, 'f1-score': 0.6556415002609302, 'support': 430672}}
[[ 45802  19643  23362]
 [ 33745 181200  38587]
 [ 15920  21087  51326]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5270292
{'0': {'precision': 0.35154473428832145, 'recall': 0.34672857142857144, 'f1-score': 0.349120043728109, 'support': 70000}, '1': {'precision': 0.6256725595695619, 'recall': 0.007195961774768164, 'f1-score': 0.014228281768921519, 'support': 113119}, '2': {'precision': 0.3078456023233216, 'recall': 0.8082766374538746, 'f1-score': 0.4458730404843974, 'support': 69376}, 'accuracy': 0.3214321075664865, 'macro avg': {'precision': 0.4283542987270683, 'recall': 0.3874003902190714, 'f1-score': 0.2697404553271427, 'support': 252495}, 'weighted avg': {'precision': 0.4623484907539339, 'recall': 0.3214321075664865, 'f1-score': 0.22567092466398073, 'support': 252495}}
[[24271   243 45486]
 [31713   814 80592]
 [13057   244 56075]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4714297
{'0': {'precision': 0.38174394867308253, 'recall': 0.378476840340022, 'f1-score': 0.3801033741796852, 'support': 17293}, '1': {'precision': 0.7101669195751138, 'recall': 0.018200910045502276, 'f1-score': 0.03549218868496891, 'support': 25713}, '2': {'precision': 0.3283725283725284, 'recall': 0.8003764330120344, 'f1-score': 0.46568659985398553, 'support': 17533}, 'accuracy': 0.34764366771833033, 'macro avg': {'precision': 0.4734277988735749, 'recall': 0.3990180611325196, 'f1-score': 0.2937607209062132, 'support': 60539}, 'weighted avg': {'precision': 0.5057793430250592, 'recall': 0.34764366771833033, 'f1-score': 0.2585213077947411, 'support': 60539}}
[[ 6545    93 10655]
 [ 7198   468 18047]
 [ 3402    98 14033]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.5050713
{'0': {'precision': 0.35526921306948916, 'recall': 0.4044708347886832, 'f1-score': 0.37827684769293585, 'support': 5726}, '1': {'precision': 0.7006802721088435, 'recall': 0.030971233837827003, 'f1-score': 0.059320406987905555, 'support': 9977}, '2': {'precision': 0.31816939890710383, 'recall': 0.7898931660166186, 'f1-score': 0.4536202950771779, 'support': 5897}, 'accuracy': 0.33717592592592593, 'macro avg': {'precision': 0.45803962802847886, 'recall': 0.40844507821437626, 'f1-score': 0.2970725165860064, 'support': 21600}, 'weighted avg': {'precision': 0.5046853488065285, 'recall': 0.33717592592592593, 'f1-score': 0.2515209171517686, 'support': 21600}}
[[2316   49 3361]
 [3047  309 6621]
 [1156   83 4658]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1242/1242 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75031424
{'0': {'precision': 0.39503446335630893, 'recall': 0.5585211113541895, 'f1-score': 0.46276293348493464, 'support': 50281}, '1': {'precision': 0.8635774668790064, 'recall': 0.6960388295914611, 'f1-score': 0.7708093980145255, 'support': 217360}, '2': {'precision': 0.4181045331245281, 'recall': 0.5961561465768173, 'f1-score': 0.49150202176271407, 'support': 50158}, 'accuracy': 0.6585168612865364, 'macro avg': {'precision': 0.5589054877866145, 'recall': 0.6169053625074893, 'f1-score': 0.5750247844207248, 'support': 317799}, 'weighted avg': {'precision': 0.7191376097007841, 'recall': 0.6585168612865364, 'f1-score': 0.6779885154407895, 'support': 317799}}
[[ 28083  11754  10444]
 [ 34897 151291  31172]
 [  8110  12146  29902]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56073976
{'0': {'precision': 0.4484791568842281, 'recall': 0.5351428749299633, 'f1-score': 0.487993187624184, 'support': 16063}, '1': {'precision': 0.8932833763820686, 'recall': 0.8522006759323288, 'f1-score': 0.8722585533136614, 'support': 102673}, '2': {'precision': 0.4692627556754327, 'recall': 0.5161948324885647, 'f1-score': 0.491611232118679, 'support': 16178}, 'accuracy': 0.7741598351542464, 'macro avg': {'precision': 0.6036750963139098, 'recall': 0.6345127944502856, 'f1-score': 0.6172876576855081, 'support': 134914}, 'weighted avg': {'precision': 0.7894787617417365, 'recall': 0.7741598351542464, 'f1-score': 0.7808627980075961, 'support': 134914}}
[[ 8596  4785  2682]
 [ 8412 87498  6763]
 [ 2159  5668  8351]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62015676
{'0': {'precision': 0.4508748317631225, 'recall': 0.5606173298624024, 'f1-score': 0.4997927890592623, 'support': 5378}, '1': {'precision': 0.8862120494223129, 'recall': 0.8099870082281222, 'f1-score': 0.8463868003341688, 'support': 30019}, '2': {'precision': 0.44212641013753673, 'recall': 0.5504040015390534, 'f1-score': 0.49035907104293425, 'support': 5198}, 'accuracy': 0.7437122798374184, 'macro avg': {'precision': 0.5930710971076575, 'recall': 0.6403361132098594, 'f1-score': 0.6121795534787885, 'support': 40595}, 'weighted avg': {'precision': 0.7716757590029659, 'recall': 0.7437122798374184, 'f1-score': 0.7548825577059564, 'support': 40595}}
[[ 3015  1526   837]
 [ 2931 24315  2773]
 [  741  1596  2861]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0201334
{'0': {'precision': 0.4904427067547635, 'recall': 0.5256347788425099, 'f1-score': 0.5074293001353631, 'support': 92355}, '1': {'precision': 0.661856543848693, 'recall': 0.34998230923457957, 'f1-score': 0.457855677101816, 'support': 84790}, '2': {'precision': 0.48455845699605044, 'recall': 0.6509251246548811, 'f1-score': 0.5555540901157551, 'support': 97068}, 'accuracy': 0.515672123495239, 'macro avg': {'precision': 0.5456192358665023, 'recall': 0.5088474042439902, 'f1-score': 0.5069463557843115, 'support': 274213}, 'weighted avg': {'precision': 0.5413630018961882, 'recall': 0.515672123495239, 'f1-score': 0.5091361105958526, 'support': 274213}}
[[48545  7175 36635]
 [24539 29675 30576]
 [25898  7986 63184]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0136356
{'0': {'precision': 0.4786822433417227, 'recall': 0.5514779071277102, 'f1-score': 0.5125080437580437, 'support': 23107}, '1': {'precision': 0.6607383929095498, 'recall': 0.4133587926412808, 'f1-score': 0.5085611023266321, 'support': 27233}, '2': {'precision': 0.46939886990264823, 'recall': 0.6075960521677829, 'f1-score': 0.5296309098590467, 'support': 22696}, 'accuracy': 0.517416068787995, 'macro avg': {'precision': 0.5362731687179735, 'recall': 0.5241442506455912, 'f1-score': 0.5169000186479075, 'support': 73036}, 'weighted avg': {'precision': 0.5436808697397648, 'recall': 0.517416068787995, 'f1-score': 0.5163572895139276, 'support': 73036}}
[[12743  2718  7646]
 [ 8034 11257  7942]
 [ 5844  3062 13790]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0288054
{'0': {'precision': 0.4662002544066873, 'recall': 0.5574144486692015, 'f1-score': 0.5077433080995498, 'support': 9205}, '1': {'precision': 0.6729312354312355, 'recall': 0.4011986450099887, 'f1-score': 0.5026935843717691, 'support': 11513}, '2': {'precision': 0.4603400619817405, 'recall': 0.6045539544604553, 'f1-score': 0.5226818830242511, 'support': 9091}, 'accuracy': 0.5114562715958267, 'macro avg': {'precision': 0.5331571839398878, 'recall': 0.5210556827132152, 'f1-score': 0.5110395918318567, 'support': 29809}, 'weighted avg': {'precision': 0.5442578469190302, 'recall': 0.5114562715958267, 'f1-score': 0.5103488673387904, 'support': 29809}}
[[5131 1043 3031]
 [3482 4619 3412]
 [2393 1202 5496]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2425534
{'0': {'precision': 0.3707645525629887, 'recall': 0.17490874159462055, 'f1-score': 0.23768786932040695, 'support': 78075}, '1': {'precision': 0.34547406673273867, 'recall': 0.06398568238137486, 'f1-score': 0.10797346480472884, 'support': 65374}, '2': {'precision': 0.3539449369605389, 'recall': 0.7912412575985358, 'f1-score': 0.4891009660645093, 'support': 76495}, 'accuracy': 0.35629523878805514, 'macro avg': {'precision': 0.35672785208542207, 'recall': 0.3433785605248438, 'f1-score': 0.27825410006321505, 'support': 219944}, 'weighted avg': {'precision': 0.35739771047511104, 'recall': 0.35629523878805514, 'f1-score': 0.28657256430927763, 'support': 219944}}
[[13656  4183 60236]
 [10949  4183 50242]
 [12227  3742 60526]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3292634
{'0': {'precision': 0.3861490031479538, 'recall': 0.15836471221086607, 'f1-score': 0.22461280231937134, 'support': 27885}, '1': {'precision': 0.3827424177701837, 'recall': 0.03299819541118845, 'f1-score': 0.06075812029565336, 'support': 27153}, '2': {'precision': 0.3304322214858994, 'recall': 0.8421408196967423, 'f1-score': 0.4746322012924515, 'support': 26644}, 'accuracy': 0.33973213192625057, 'macro avg': {'precision': 0.36644121413467895, 'recall': 0.34450124243959895, 'f1-score': 0.2533343746358254, 'support': 81682}, 'weighted avg': {'precision': 0.3668422165442177, 'recall': 0.33973213192625057, 'f1-score': 0.25169797022966656, 'support': 81682}}
[[ 4416   733 22736]
 [ 3526   896 22731]
 [ 3494   712 22438]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2927953
{'0': {'precision': 0.38611388611388614, 'recall': 0.17324069923800986, 'f1-score': 0.2391707920792079, 'support': 8924}, '1': {'precision': 0.3719892952720785, 'recall': 0.05083506034377667, 'f1-score': 0.08944658944658945, 'support': 8203}, '2': {'precision': 0.32133494656180683, 'recall': 0.8136328823078887, 'f1-score': 0.4607155764365739, 'support': 7834}, 'accuracy': 0.3340010416249349, 'macro avg': {'precision': 0.35981270931592385, 'recall': 0.3459028806298918, 'f1-score': 0.2631109859874571, 'support': 24961}, 'weighted avg': {'precision': 0.36114123954017774, 'recall': 0.3340010416249349, 'f1-score': 0.25949827120505364, 'support': 24961}}
[[1546  396 6982]
 [1306  417 6480]
 [1152  308 6374]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9968176
{'0': {'precision': 0.4857823113899483, 'recall': 0.5656529822555957, 'f1-score': 0.5226840202633999, 'support': 152217}, '1': {'precision': 0.6749891345558114, 'recall': 0.4019272066516161, 'f1-score': 0.5038395035737582, 'support': 181610}, '2': {'precision': 0.4888038174582221, 'recall': 0.640500474079389, 'f1-score': 0.5544636271372557, 'support': 156092}, 'accuracy': 0.5288078233340614, 'macro avg': {'precision': 0.5498584211346607, 'recall': 0.5360268876622003, 'f1-score': 0.5269957169914713, 'support': 489919}, 'weighted avg': {'precision': 0.5568828077584529, 'recall': 0.5288078233340614, 'f1-score': 0.5258237019661876, 'support': 489919}}
[[86102 16781 49334]
 [53393 72994 55223]
 [37749 18366 99977]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94890875
{'0': {'precision': 0.47884490389674705, 'recall': 0.5859228540589673, 'f1-score': 0.5269997530380577, 'support': 52809}, '1': {'precision': 0.7255093302531217, 'recall': 0.47671390622750887, 'f1-score': 0.5753679954513866, 'support': 76419}, '2': {'precision': 0.4852458536013597, 'recall': 0.6149661127100547, 'f1-score': 0.5424586633034961, 'support': 53855}, 'accuracy': 0.5488822009689595, 'macro avg': {'precision': 0.5632000292504095, 'recall': 0.5592009576655103, 'f1-score': 0.5482754705976468, 'support': 183083}, 'weighted avg': {'precision': 0.5836857244211524, 'recall': 0.5488822009689595, 'f1-score': 0.5517360329183817, 'support': 183083}}
[[30942  6368 15499]
 [20355 36430 19634]
 [13321  7415 33119]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199114
{'0': {'precision': 0.4819809957525069, 'recall': 0.6054455445544554, 'f1-score': 0.5367042933417852, 'support': 18180}, '1': {'precision': 0.6526048870447211, 'recall': 0.308018713959308, 'f1-score': 0.4185083893857639, 'support': 18382}, '2': {'precision': 0.48571798971522406, 'recall': 0.6212690692018572, 'f1-score': 0.5451943831397182, 'support': 18092}, 'accuracy': 0.510648808870348, 'macro avg': {'precision': 0.5401012908374839, 'recall': 0.5115777759052068, 'f1-score': 0.5001356886224224, 'support': 54654}, 'weighted avg': {'precision': 0.540604665831677, 'recall': 0.510648808870348, 'f1-score': 0.4997614455740942, 'support': 54654}}
[[11007  1338  5835]
 [ 6654  5662  6066]
 [ 5176  1676 11240]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
4918/4918 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48537526
{'0': {'precision': 0.5027728199898012, 'recall': 0.5421148493075364, 'f1-score': 0.5217031831335263, 'support': 145495}, '1': {'precision': 0.8944098140661707, 'recall': 0.8814035123998987, 'f1-score': 0.8878590332596268, 'support': 967145}, '2': {'precision': 0.5094506911699512, 'recall': 0.5187860382081957, 'f1-score': 0.5140759869457803, 'support': 146199}, 'accuracy': 0.8000753074857071, 'macro avg': {'precision': 0.6355444417419743, 'recall': 0.6474347999718769, 'f1-score': 0.6412127344463111, 'support': 1258839}, 'weighted avg': {'precision': 0.8044365424552294, 'recall': 0.8000753074857071, 'f1-score': 0.8021288064378211, 'support': 1258839}}
[[ 78875  45866  20754]
 [ 62422 852445  52278]
 [ 15583  54770  75846]]
Evaluating performance on  train set...
1403/1403 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46597156
{'0': {'precision': 0.457538530265803, 'recall': 0.568526228143214, 'f1-score': 0.5070297029702969, 'support': 36030}, '1': {'precision': 0.9101381325062213, 'recall': 0.880236074631395, 'f1-score': 0.8949373979314099, 'support': 286689}, '2': {'precision': 0.5138061721710883, 'recall': 0.5234273737624445, 'f1-score': 0.5185721506536797, 'support': 36261}, 'accuracy': 0.8129087971474734, 'macro avg': {'precision': 0.6271609449810375, 'recall': 0.6573965588456844, 'f1-score': 0.6401797505184622, 'support': 358980}, 'weighted avg': {'precision': 0.8246777812821016, 'recall': 0.8129087971474734, 'f1-score': 0.8179868868138361, 'support': 358980}}
[[ 20484  11214   4332]
 [ 20707 252354  13628]
 [  3579  13702  18980]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.47102767
{'0': {'precision': 0.48779651720828193, 'recall': 0.5318433248617133, 'f1-score': 0.5088685452724931, 'support': 13378}, '1': {'precision': 0.8995187030313265, 'recall': 0.886770857178532, 'f1-score': 0.8930992926381975, 'support': 96106}, '2': {'precision': 0.5229700455665944, 'recall': 0.5290561475100128, 'f1-score': 0.5259954921111946, 'support': 13233}, 'accuracy': 0.8095047955865935, 'macro avg': {'precision': 0.6367617552687342, 'recall': 0.6492234431834194, 'f1-score': 0.6426544433406284, 'support': 122717}, 'weighted avg': {'precision': 0.8140302394429769, 'recall': 0.8095047955865935, 'f1-score': 0.8116262813143206, 'support': 122717}}
[[ 7115  4489  1774]
 [ 6270 85224  4612]
 [ 1201  5031  7001]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
4856/4856 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7581517
{'0': {'precision': 0.4658183042783546, 'recall': 0.5278837877779041, 'f1-score': 0.4949127768663619, 'support': 246308}, '1': {'precision': 0.8313701168388264, 'recall': 0.7089718149413883, 'f1-score': 0.7653079728110116, 'support': 761964}, '2': {'precision': 0.45079380244908357, 'recall': 0.6032697872848235, 'f1-score': 0.5160035579664181, 'support': 234633}, 'accuracy': 0.6531311725353104, 'macro avg': {'precision': 0.5826607411887549, 'recall': 0.613375130001372, 'f1-score': 0.5920747692145971, 'support': 1242905}, 'weighted avg': {'precision': 0.6870838695211688, 'recall': 0.6531311725353104, 'f1-score': 0.6646602622531119, 'support': 1242905}}
[[130022  56924  59362]
 [108667 540211 113086]
 [ 40437  52649 141547]]
Evaluating performance on  train set...
2076/2076 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5778784
{'0': {'precision': 0.49184585021294275, 'recall': 0.5204154530966643, 'f1-score': 0.505727483912312, 'support': 72788}, '1': {'precision': 0.8606072736945511, 'recall': 0.8509613256215479, 'f1-score': 0.8557571186516135, 'support': 384001}, '2': {'precision': 0.500756389145481, 'recall': 0.5012663995390038, 'f1-score': 0.501011264549485, 'support': 74621}, 'accuracy': 0.7565815472046066, 'macro avg': {'precision': 0.6177365043509916, 'recall': 0.6242143927524054, 'f1-score': 0.6208319557044701, 'support': 531410}, 'weighted avg': {'precision': 0.7595669482427992, 'recall': 0.7565815472046066, 'f1-score': 0.7579993658197903, 'support': 531410}}
[[ 37880  24122  10786]
 [ 30725 326770  26506]
 [  8411  28805  37405]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54784495
{'0': {'precision': 0.519045668646324, 'recall': 0.501508780608459, 'f1-score': 0.5101265504314791, 'support': 20215}, '1': {'precision': 0.8601198717318875, 'recall': 0.8753033787530338, 'f1-score': 0.8676452037267306, 'support': 110011}, '2': {'precision': 0.5256839309428951, 'recall': 0.4927305317665804, 'f1-score': 0.5086740856871161, 'support': 20084}, 'accuracy': 0.7739139112500831, 'macro avg': {'precision': 0.6349498237737022, 'recall': 0.6231808970426911, 'f1-score': 0.628815279948442, 'support': 150310}, 'weighted avg': {'precision': 0.7695628465826574, 'recall': 0.7739139112500831, 'f1-score': 0.7715982639950352, 'support': 150310}}
[[10138  7389  2688]
 [ 7477 96293  6241]
 [ 1917  8271  9896]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
4353/4353 - 76s - 76s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6570876
{'0': {'precision': 0.5219447173529598, 'recall': 0.48523646230597484, 'f1-score': 0.502921645643551, 'support': 187218}, '1': {'precision': 0.8236355404884648, 'recall': 0.8258041941981564, 'f1-score': 0.8247184416898558, 'support': 740213}, '2': {'precision': 0.47893474693929067, 'recall': 0.5076876970089427, 'f1-score': 0.49289225109889534, 'support': 186857}, 'accuracy': 0.7152378918197091, 'macro avg': {'precision': 0.6081716682602384, 'recall': 0.606242784504358, 'f1-score': 0.6068441128107674, 'support': 1114288}, 'weighted avg': {'precision': 0.7151432039417184, 'recall': 0.7152378918197091, 'f1-score': 0.7150069496362285, 'support': 1114288}}
[[ 90845  61493  34880]
 [ 60612 611271  68330]
 [ 22594  69398  94865]]
Evaluating performance on  train set...
1542/1542 - 27s - 27s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.718725
{'0': {'precision': 0.48939778376139187, 'recall': 0.5050768203072812, 'f1-score': 0.4971137030072716, 'support': 74850}, '1': {'precision': 0.8126785056931416, 'recall': 0.7760681412281907, 'f1-score': 0.7939515070593999, 'support': 247486}, '2': {'precision': 0.4809207439057522, 'recall': 0.5391889459620364, 'f1-score': 0.5083907183185927, 'support': 72227}, 'accuracy': 0.6812980436584272, 'macro avg': {'precision': 0.5943323444534285, 'recall': 0.6067779691658362, 'f1-score': 0.5998186427950881, 'support': 394563}, 'weighted avg': {'precision': 0.6906208624341202, 'recall': 0.6812980436584272, 'f1-score': 0.6853667975917507, 'support': 394563}}
[[ 37805  21958  15087]
 [ 28473 192066  26947]
 [ 10970  22313  38944]]
Evaluating performance on  val set...
482/482 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7036616
{'0': {'precision': 0.5084298286243631, 'recall': 0.49559799539482596, 'f1-score': 0.5019319143098837, 'support': 22149}, '1': {'precision': 0.8089721690661803, 'recall': 0.7952855321136826, 'f1-score': 0.8020704671921358, 'support': 79203}, '2': {'precision': 0.48057173995053865, 'recall': 0.5221331633117771, 'f1-score': 0.5004911055331225, 'support': 21958}, 'accuracy': 0.6928148568648123, 'macro avg': {'precision': 0.599324579213694, 'recall': 0.6043388969400952, 'f1-score': 0.601497829011714, 'support': 123310}, 'weighted avg': {'precision': 0.6965098471055358, 'recall': 0.6928148568648123, 'f1-score': 0.6944567421812071, 'support': 123310}}
[[10977  7251  3921]
 [ 7743 62989  8471]
 [ 2870  7623 11465]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
5497/5497 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76086813
{'0': {'precision': 0.47154508588873195, 'recall': 0.49294314209712525, 'f1-score': 0.48200674623860473, 'support': 272926}, '1': {'precision': 0.8027331458310042, 'recall': 0.7357157248199678, 'f1-score': 0.7677647395225732, 'support': 868595}, '2': {'precision': 0.46210226174070246, 'recall': 0.5666892502258356, 'f1-score': 0.5090795971536338, 'support': 265680}, 'accuracy': 0.6567178391715185, 'macro avg': {'precision': 0.5787934978201462, 'recall': 0.5984493723809762, 'f1-score': 0.5862836943049373, 'support': 1407201}, 'weighted avg': {'precision': 0.6741881506718791, 'recall': 0.6567178391715185, 'f1-score': 0.6635022676371779, 'support': 1407201}}
[[134537  81611  56778]
 [111081 639039 118475]
 [ 39693  75429 150558]]
Evaluating performance on  train set...
2058/2058 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7407273
{'0': {'precision': 0.48410060242812286, 'recall': 0.4945561314051659, 'f1-score': 0.4892725158289185, 'support': 95704}, '1': {'precision': 0.8031309645575831, 'recall': 0.7546467622366735, 'f1-score': 0.7781343533555923, 'support': 333996}, '2': {'precision': 0.4519180697795522, 'recall': 0.5361187759976936, 'f1-score': 0.4904306220095694, 'support': 97124}, 'accuracy': 0.6671108377750444, 'macro avg': {'precision': 0.5797165455884193, 'recall': 0.5951072232131777, 'f1-score': 0.5859458303980267, 'support': 526824}, 'weighted avg': {'precision': 0.6804264503941067, 'recall': 0.6671108377750444, 'f1-score': 0.6726187153020794, 'support': 526824}}
[[ 47331  29128  19245]
 [ 38042 252049  43905]
 [ 12398  32656  52070]]
Evaluating performance on  val set...
681/681 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7841658
{'0': {'precision': 0.48419548282239533, 'recall': 0.4869930385276627, 'f1-score': 0.4855902314274875, 'support': 35481}, '1': {'precision': 0.7902579953053139, 'recall': 0.717826510627213, 'f1-score': 0.752302854427244, 'support': 103649}, '2': {'precision': 0.45009445843828716, 'recall': 0.5690522903693593, 'f1-score': 0.5026308188816194, 'support': 35169}, 'accuracy': 0.6408183638460346, 'macro avg': {'precision': 0.5748493121886654, 'recall': 0.591290613174745, 'f1-score': 0.580174634912117, 'support': 174299}, 'weighted avg': {'precision': 0.6593185439402293, 'recall': 0.6408183638460346, 'f1-score': 0.6476324524469776, 'support': 174299}}
[[17279  9862  8340]
 [13136 74402 16111]
 [ 5271  9885 20013]]
testing model on single stock: results/universal/W2/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
14883/14883 - 245s - 245s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.081951
{'0': {'precision': 0.452607905544604, 'recall': 0.5435663059486457, 'f1-score': 0.49393450346651757, 'support': 1124424}, '1': {'precision': 0.6383587509077705, 'recall': 0.23115437815890647, 'f1-score': 0.33940699726241086, 'support': 1521096}, '2': {'precision': 0.42585522644934654, 'recall': 0.6980819818976467, 'f1-score': 0.5290008343410073, 'support': 1164379}, 'accuracy': 0.4660593364810983, 'macro avg': {'precision': 0.5056072943005737, 'recall': 0.490934222001733, 'f1-score': 0.45411411168997856, 'support': 3809899}, 'weighted avg': {'precision': 0.5185924920510375, 'recall': 0.4660593364810983, 'f1-score': 0.442956597674334, 'support': 3809899}}
[[611199  99243 413982]
 [487597 351608 681891]
 [251598  99949 812832]]
Evaluating performance on  train set...
6147/6147 - 103s - 103s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.078461
{'0': {'precision': 0.46485016490004205, 'recall': 0.5649820611159223, 'f1-score': 0.5100481372413973, 'support': 484980}, '1': {'precision': 0.6556100501144709, 'recall': 0.2257391275240797, 'f1-score': 0.33584155851916775, 'support': 597495}, '2': {'precision': 0.4351156611521403, 'recall': 0.68970896723081, 'f1-score': 0.5335999331924702, 'support': 491010}, 'accuracy': 0.47508365189372637, 'macro avg': {'precision': 0.5185252920555511, 'recall': 0.493476718623604, 'f1-score': 0.45982987631767847, 'support': 1573485}, 'weighted avg': {'precision': 0.528008147931935, 'recall': 0.47508365189372637, 'f1-score': 0.4512465646660615, 'support': 1573485}}
[[274005  35668 175307]
 [198270 134878 264347]
 [117173  35183 338654]]
Evaluating performance on  val set...
2174/2174 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0380716
{'0': {'precision': 0.47207281968828607, 'recall': 0.5387497558348082, 'f1-score': 0.503212180855181, 'support': 168943}, '1': {'precision': 0.6953726800215377, 'recall': 0.29701301992884566, 'f1-score': 0.41623884681034395, 'support': 213058}, '2': {'precision': 0.44155029776747734, 'recall': 0.6900110599817768, 'f1-score': 0.5385029930746713, 'support': 174503}, 'accuracy': 0.49363167200954533, 'macro avg': {'precision': 0.5363319324924337, 'recall': 0.5085912785818102, 'f1-score': 0.4859846735800654, 'support': 556504}, 'weighted avg': {'precision': 0.5479923997813942, 'recall': 0.49363167200954533, 'f1-score': 0.48098051315793694, 'support': 556504}}
[[ 91018  13866  64059]
 [ 61549  63281  88228]
 [ 40238  13856 120409]]
training model: results/universal/W2/deepVOL_L3/h20
Epoch 1/50
9940/9940 - 628s - loss: 2.8703 - accuracy20: 0.5066 - val_loss: 3.0909 - val_accuracy20: 0.5233 - 628s/epoch - 63ms/step
Epoch 2/50
9940/9940 - 602s - loss: 2.7724 - accuracy20: 0.5423 - val_loss: 3.0431 - val_accuracy20: 0.5379 - 602s/epoch - 61ms/step
Epoch 3/50
9940/9940 - 551s - loss: 2.7390 - accuracy20: 0.5488 - val_loss: 2.9812 - val_accuracy20: 0.5441 - 551s/epoch - 55ms/step
Epoch 4/50
9940/9940 - 557s - loss: 2.7168 - accuracy20: 0.5533 - val_loss: 3.0135 - val_accuracy20: 0.5448 - 557s/epoch - 56ms/step
Epoch 5/50
9940/9940 - 549s - loss: 2.7027 - accuracy20: 0.5563 - val_loss: 3.0581 - val_accuracy20: 0.5420 - 549s/epoch - 55ms/step
Epoch 6/50
9940/9940 - 546s - loss: 2.6933 - accuracy20: 0.5582 - val_loss: 3.0210 - val_accuracy20: 0.5466 - 546s/epoch - 55ms/step
Epoch 7/50
9940/9940 - 544s - loss: 2.6852 - accuracy20: 0.5601 - val_loss: 2.9755 - val_accuracy20: 0.5466 - 544s/epoch - 55ms/step
Epoch 8/50
9940/9940 - 551s - loss: 2.6793 - accuracy20: 0.5611 - val_loss: 2.9776 - val_accuracy20: 0.5452 - 551s/epoch - 55ms/step
Epoch 9/50
9940/9940 - 555s - loss: 2.6731 - accuracy20: 0.5625 - val_loss: 2.9626 - val_accuracy20: 0.5466 - 555s/epoch - 56ms/step
Epoch 10/50
9940/9940 - 569s - loss: 2.6685 - accuracy20: 0.5635 - val_loss: 2.9463 - val_accuracy20: 0.5460 - 569s/epoch - 57ms/step
Epoch 11/50
9940/9940 - 556s - loss: 2.6639 - accuracy20: 0.5645 - val_loss: 2.9584 - val_accuracy20: 0.5465 - 556s/epoch - 56ms/step
Epoch 12/50
9940/9940 - 562s - loss: 2.6597 - accuracy20: 0.5652 - val_loss: 2.9235 - val_accuracy20: 0.5470 - 562s/epoch - 57ms/step
Epoch 13/50
9940/9940 - 562s - loss: 2.6563 - accuracy20: 0.5660 - val_loss: 2.9185 - val_accuracy20: 0.5478 - 562s/epoch - 57ms/step
Epoch 14/50
9940/9940 - 575s - loss: 2.6532 - accuracy20: 0.5667 - val_loss: 2.9512 - val_accuracy20: 0.5481 - 575s/epoch - 58ms/step
Epoch 15/50
9940/9940 - 574s - loss: 2.6502 - accuracy20: 0.5676 - val_loss: 2.9145 - val_accuracy20: 0.5488 - 574s/epoch - 58ms/step
Epoch 16/50
9940/9940 - 577s - loss: 2.6474 - accuracy20: 0.5680 - val_loss: 2.9200 - val_accuracy20: 0.5469 - 577s/epoch - 58ms/step
Epoch 17/50
9940/9940 - 580s - loss: 2.6445 - accuracy20: 0.5686 - val_loss: 2.9200 - val_accuracy20: 0.5457 - 580s/epoch - 58ms/step
Epoch 18/50
9940/9940 - 580s - loss: 2.6420 - accuracy20: 0.5690 - val_loss: 2.9097 - val_accuracy20: 0.5462 - 580s/epoch - 58ms/step
Epoch 19/50
9940/9940 - 566s - loss: 2.6396 - accuracy20: 0.5697 - val_loss: 2.8978 - val_accuracy20: 0.5464 - 566s/epoch - 57ms/step
Epoch 20/50
9940/9940 - 555s - loss: 2.6373 - accuracy20: 0.5701 - val_loss: 2.8969 - val_accuracy20: 0.5466 - 555s/epoch - 56ms/step
Epoch 21/50
9940/9940 - 571s - loss: 2.6354 - accuracy20: 0.5704 - val_loss: 2.8897 - val_accuracy20: 0.5454 - 571s/epoch - 57ms/step
Epoch 22/50
9940/9940 - 611s - loss: 2.6333 - accuracy20: 0.5710 - val_loss: 2.8909 - val_accuracy20: 0.5465 - 611s/epoch - 62ms/step
Epoch 23/50
9940/9940 - 590s - loss: 2.6312 - accuracy20: 0.5715 - val_loss: 2.9020 - val_accuracy20: 0.5484 - 590s/epoch - 59ms/step
Epoch 24/50
9940/9940 - 597s - loss: 2.6291 - accuracy20: 0.5720 - val_loss: 2.8821 - val_accuracy20: 0.5469 - 597s/epoch - 60ms/step
Epoch 25/50
9940/9940 - 545s - loss: 2.6276 - accuracy20: 0.5721 - val_loss: 2.9105 - val_accuracy20: 0.5461 - 545s/epoch - 55ms/step
Epoch 26/50
9940/9940 - 545s - loss: 2.6257 - accuracy20: 0.5726 - val_loss: 2.8746 - val_accuracy20: 0.5493 - 545s/epoch - 55ms/step
Epoch 27/50
9940/9940 - 541s - loss: 2.6240 - accuracy20: 0.5730 - val_loss: 2.8867 - val_accuracy20: 0.5489 - 541s/epoch - 54ms/step
Epoch 28/50
9940/9940 - 541s - loss: 2.6223 - accuracy20: 0.5733 - val_loss: 2.8763 - val_accuracy20: 0.5480 - 541s/epoch - 54ms/step
Epoch 29/50
9940/9940 - 531s - loss: 2.6212 - accuracy20: 0.5734 - val_loss: 2.9018 - val_accuracy20: 0.5487 - 531s/epoch - 53ms/step
Epoch 30/50
9940/9940 - 548s - loss: 2.6193 - accuracy20: 0.5738 - val_loss: 2.8691 - val_accuracy20: 0.5492 - 548s/epoch - 55ms/step
Epoch 31/50
9940/9940 - 541s - loss: 2.6182 - accuracy20: 0.5742 - val_loss: 2.8584 - val_accuracy20: 0.5482 - 541s/epoch - 54ms/step
Epoch 32/50
9940/9940 - 538s - loss: 2.6167 - accuracy20: 0.5745 - val_loss: 2.8688 - val_accuracy20: 0.5484 - 538s/epoch - 54ms/step
Epoch 33/50
9940/9940 - 537s - loss: 2.6153 - accuracy20: 0.5747 - val_loss: 2.8730 - val_accuracy20: 0.5492 - 537s/epoch - 54ms/step
Epoch 34/50
9940/9940 - 540s - loss: 2.6141 - accuracy20: 0.5750 - val_loss: 2.8765 - val_accuracy20: 0.5471 - 540s/epoch - 54ms/step
Epoch 35/50
9940/9940 - 540s - loss: 2.6133 - accuracy20: 0.5754 - val_loss: 2.8399 - val_accuracy20: 0.5511 - 540s/epoch - 54ms/step
Epoch 36/50
9940/9940 - 536s - loss: 2.6117 - accuracy20: 0.5756 - val_loss: 2.8621 - val_accuracy20: 0.5496 - 536s/epoch - 54ms/step
Epoch 37/50
9940/9940 - 528s - loss: 2.6105 - accuracy20: 0.5758 - val_loss: 2.8699 - val_accuracy20: 0.5489 - 528s/epoch - 53ms/step
Epoch 38/50
9940/9940 - 541s - loss: 2.6094 - accuracy20: 0.5760 - val_loss: 2.8784 - val_accuracy20: 0.5455 - 541s/epoch - 54ms/step
Epoch 39/50
9940/9940 - 537s - loss: 2.6084 - accuracy20: 0.5763 - val_loss: 2.8467 - val_accuracy20: 0.5487 - 537s/epoch - 54ms/step
Epoch 40/50
9940/9940 - 533s - loss: 2.6077 - accuracy20: 0.5764 - val_loss: 2.8711 - val_accuracy20: 0.5467 - 533s/epoch - 54ms/step
Epoch 41/50
9940/9940 - 544s - loss: 2.6062 - accuracy20: 0.5765 - val_loss: 2.8564 - val_accuracy20: 0.5476 - 544s/epoch - 55ms/step
Epoch 42/50
9940/9940 - 545s - loss: 2.6051 - accuracy20: 0.5768 - val_loss: 2.8878 - val_accuracy20: 0.5462 - 545s/epoch - 55ms/step
Epoch 43/50
9940/9940 - 530s - loss: 2.6043 - accuracy20: 0.5771 - val_loss: 2.8635 - val_accuracy20: 0.5475 - 530s/epoch - 53ms/step
Epoch 44/50
9940/9940 - 532s - loss: 2.6033 - accuracy20: 0.5775 - val_loss: 2.8655 - val_accuracy20: 0.5463 - 532s/epoch - 53ms/step
Epoch 45/50
9940/9940 - 542s - loss: 2.6021 - accuracy20: 0.5775 - val_loss: 2.8712 - val_accuracy20: 0.5477 - 542s/epoch - 55ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 849s - 849s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98582625
{'0': {'precision': 0.4719439355132046, 'recall': 0.5092777260252997, 'f1-score': 0.48990058762612, 'support': 1789501}, '1': {'precision': 0.7300736471482322, 'recall': 0.5384919958603859, 'f1-score': 0.6198162744586515, 'support': 3086278}, '2': {'precision': 0.4433603945709884, 'recall': 0.6039615390869327, 'f1-score': 0.5113473091125855, 'support': 1844990}, 'accuracy': 0.5486860209002868, 'macro avg': {'precision': 0.5484593257441417, 'recall': 0.5505770869908728, 'f1-score': 0.5403547237324523, 'support': 6720769}, 'weighted avg': {'precision': 0.5826342007138907, 'recall': 0.5486860209002868, 'f1-score': 0.5554473893092973, 'support': 6720769}}
[[ 911353  290693  587455]
 [ 612788 1661936  811554]
 [ 406921  323766 1114303]]
Evaluating performance on  train set...
9940/9940 - 299s - 299s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9896779
{'0': {'precision': 0.4743932705796145, 'recall': 0.5271390568184353, 'f1-score': 0.499377233012594, 'support': 717232}, '1': {'precision': 0.7391022241794666, 'recall': 0.5131184285745298, 'f1-score': 0.6057190815258215, 'support': 1105544}, '2': {'precision': 0.4502194301658518, 'recall': 0.6115325283554924, 'f1-score': 0.5186217444374183, 'support': 720848}, 'accuracy': 0.544961833981752, 'macro avg': {'precision': 0.5545716416416443, 'recall': 0.5505966712494859, 'f1-score': 0.5412393529919446, 'support': 2543624}, 'weighted avg': {'precision': 0.5825939051403888, 'recall': 0.544961833981752, 'f1-score': 0.5510507351277923, 'support': 2543624}}
[[378081  96006 243145]
 [243109 567275 295160]
 [175788 104238 440822]]
Evaluating performance on  val set...
3393/3393 - 109s - 109s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96806866
{'0': {'precision': 0.47886925689879045, 'recall': 0.5231093120041618, 'f1-score': 0.5000126256004445, 'support': 246048}, '1': {'precision': 0.7288763938557455, 'recall': 0.5372278604347791, 'f1-score': 0.6185473341007951, 'support': 372557}, '2': {'precision': 0.4606479627975732, 'recall': 0.5995502681556184, 'f1-score': 0.5209999442695126, 'support': 249482}, 'accuracy': 0.5511371556076753, 'macro avg': {'precision': 0.5561312045173697, 'recall': 0.5532958135315198, 'f1-score': 0.5465199679902507, 'support': 868087}, 'weighted avg': {'precision': 0.5809281795969906, 'recall': 0.5511371556076753, 'f1-score': 0.5569157858032371, 'support': 868087}}
[[128710  36078  81260]
 [ 78536 200148  93873]
 [ 61533  38372 149577]]
testing model out of sample: results/universal/W2/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 471s - 471s/epoch - 33ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92549145
{'0': {'precision': 0.48216555682087464, 'recall': 0.5034640898699915, 'f1-score': 0.49258470267507415, 'support': 998242}, '1': {'precision': 0.7064931118648994, 'recall': 0.6407467672517086, 'f1-score': 0.6720157034096418, 'support': 1669168}, '2': {'precision': 0.4825831269061312, 'recall': 0.5363010758283357, 'f1-score': 0.5080260336587225, 'support': 999323}, 'accuracy': 0.5749071448616521, 'macro avg': {'precision': 0.5570805985306351, 'recall': 0.5601706443166786, 'f1-score': 0.5575421465811461, 'support': 3666733}, 'weighted avg': {'precision': 0.5843976156558195, 'recall': 0.5749071448616521, 'f1-score': 0.5784735202782891, 'support': 3666733}}
[[ 502579  220423  275240]
 [ 300271 1069514  299383]
 [ 239487  223898  535938]]
Evaluating performance on  train set...
5373/5373 - 197s - 197s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82797575
{'0': {'precision': 0.509367093528396, 'recall': 0.48274835128397214, 'f1-score': 0.49570062815753596, 'support': 325708}, '1': {'precision': 0.7328725830979795, 'recall': 0.7505656226577242, 'f1-score': 0.7416135900065883, 'support': 719119}, '2': {'precision': 0.49527333383880506, 'recall': 0.49476315271234456, 'f1-score': 0.495018111823459, 'support': 330065}, 'accuracy': 0.625710964933973, 'macro avg': {'precision': 0.5791710034883936, 'recall': 0.5760257088846803, 'f1-score': 0.5774441099958612, 'support': 1374892}, 'weighted avg': {'precision': 0.6228852370348273, 'recall': 0.625710964933973, 'f1-score': 0.6241582877105202, 'support': 1374892}}
[[157235  91762  76711]
 [ 89663 539746  89710]
 [ 61789 104972 163304]]
Evaluating performance on  val set...
1685/1685 - 64s - 64s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85815054
{'0': {'precision': 0.5023663552461293, 'recall': 0.48924543229866235, 'f1-score': 0.49571908630340655, 'support': 108698}, '1': {'precision': 0.7228221404979972, 'recall': 0.7229000337343978, 'f1-score': 0.722861085017815, 'support': 213432}, '2': {'precision': 0.49117261445069055, 'recall': 0.5039155350002764, 'f1-score': 0.497462482946794, 'support': 108542}, 'accuracy': 0.6087370435041052, 'macro avg': {'precision': 0.572120370064939, 'recall': 0.5720203336777788, 'f1-score': 0.5720142180893385, 'support': 430672}, 'weighted avg': {'precision': 0.6087984616855034, 'recall': 0.6087370435041052, 'f1-score': 0.608725278551986, 'support': 430672}}
[[ 53180  28435  27083]
 [ 29563 154290  29579]
 [ 23116  30730  54696]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.4026175
{'0': {'precision': 0.3637019924920589, 'recall': 0.6286341743405456, 'f1-score': 0.4608025171268899, 'support': 80142}, '1': {'precision': 0.44025157232704404, 'recall': 0.0054018300077169, 'f1-score': 0.010672707273776722, 'support': 90710}, '2': {'precision': 0.37448388297212526, 'recall': 0.517680633979643, 'f1-score': 0.43459037042749543, 'support': 81643}, 'accuracy': 0.3688587892829561, 'macro avg': {'precision': 0.3928124825970761, 'recall': 0.3839055461093019, 'f1-score': 0.3020218649427207, 'support': 252495}, 'weighted avg': {'precision': 0.39468905469644144, 'recall': 0.3688587892829561, 'f1-score': 0.290615727904313, 'support': 252495}}
[[50380   266 29496]
 [49119   490 41101]
 [39021   357 42265]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3417131
{'0': {'precision': 0.3873597724759046, 'recall': 0.6136363636363636, 'f1-score': 0.47492299645493113, 'support': 19976}, '1': {'precision': 0.5268225584594223, 'recall': 0.019166291347645498, 'f1-score': 0.03698696281989377, 'support': 19983}, '2': {'precision': 0.3980544608939539, 'recall': 0.5448007774538387, 'f1-score': 0.4600077953515088, 'support': 20580}, 'accuracy': 0.39401047258791855, 'macro avg': {'precision': 0.43741226394309357, 'recall': 0.39253447747928255, 'f1-score': 0.32397258487544456, 'support': 60539}, 'weighted avg': {'precision': 0.4370299279121042, 'recall': 0.39401047258791855, 'f1-score': 0.32529662999963155, 'support': 60539}}
[[12258   148  7570]
 [10215   383  9385]
 [ 9172   196 11212]]
Evaluating performance on  val set...
85/85 - 4s - 4s/epoch - 45ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3857006
{'0': {'precision': 0.3698532044396706, 'recall': 0.6175459572560156, 'f1-score': 0.46263225661982876, 'support': 6691}, '1': {'precision': 0.49135802469135803, 'recall': 0.02506928697404888, 'f1-score': 0.047704662591393984, 'support': 7938}, '2': {'precision': 0.3901027636436197, 'recall': 0.5608951369961268, 'f1-score': 0.4601624102624456, 'support': 6971}, 'accuracy': 0.3815277777777778, 'macro avg': {'precision': 0.41710466425821613, 'recall': 0.40117012707539706, 'f1-score': 0.3234997764912228, 'support': 21600}, 'weighted avg': {'precision': 0.4210413961234032, 'recall': 0.3815277777777778, 'f1-score': 0.30934926864042905, 'support': 21600}}
[[4132   97 2462]
 [4088  199 3651]
 [2952  109 3910]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1242/1242 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87154675
{'0': {'precision': 0.39464476049999464, 'recall': 0.5656723097578666, 'f1-score': 0.4649289700659564, 'support': 64799}, '1': {'precision': 0.7797610793034452, 'recall': 0.6301498527088759, 'f1-score': 0.6970175464486519, 'support': 187384}, '2': {'precision': 0.4680011430593166, 'recall': 0.5241404535479152, 'f1-score': 0.49448250576910635, 'support': 65616}, 'accuracy': 0.5951151514007281, 'macro avg': {'precision': 0.5474689942875854, 'recall': 0.5733208720048859, 'f1-score': 0.5521430074279049, 'support': 317799}, 'weighted avg': {'precision': 0.6368670100372124, 'recall': 0.5951151514007281, 'f1-score': 0.6078774079011696, 'support': 317799}}
[[ 36655  14982  13162]
 [ 43371 118080  25933]
 [ 12855  18369  34392]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65142435
{'0': {'precision': 0.49444147990039133, 'recall': 0.5137220476806506, 'f1-score': 0.503897398712952, 'support': 21644}, '1': {'precision': 0.8256033022861982, 'recall': 0.8533311453889071, 'f1-score': 0.8392382591855398, 'support': 91410}, '2': {'precision': 0.5499275604591553, 'recall': 0.45146386093321134, 'f1-score': 0.4958548962467969, 'support': 21860}, 'accuracy': 0.7337340824525254, 'macro avg': {'precision': 0.6233241142152482, 'recall': 0.6061723513342563, 'f1-score': 0.6129968513817629, 'support': 134914}, 'weighted avg': {'precision': 0.7278081275818861, 'recall': 0.7337340824525254, 'f1-score': 0.7298020413140839, 'support': 134914}}
[[11119  7224  3301]
 [ 8631 78003  4776]
 [ 2738  9253  9869]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7153322
{'0': {'precision': 0.47270471464019853, 'recall': 0.5298289528577388, 'f1-score': 0.499639367910301, 'support': 7191}, '1': {'precision': 0.8154473421032387, 'recall': 0.8018154311649016, 'f1-score': 0.8085739349326823, 'support': 26440}, '2': {'precision': 0.5139972464433227, 'recall': 0.48248133256748993, 'f1-score': 0.4977409080808829, 'support': 6964}, 'accuracy': 0.6988545387362975, 'macro avg': {'precision': 0.6007164343955866, 'recall': 0.6047085721967101, 'f1-score': 0.6019847369746221, 'support': 40595}, 'weighted avg': {'precision': 0.7030206713245128, 'recall': 0.6988545387362975, 'f1-score': 0.700526400249744, 'support': 40595}}
[[ 3810  2246  1135]
 [ 3198 21200  2042]
 [ 1052  2552  3360]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1072/1072 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.076687
{'0': {'precision': 0.4704265731711771, 'recall': 0.5413899630127774, 'f1-score': 0.5034197721454673, 'support': 95168}, '1': {'precision': 0.564097692778587, 'recall': 0.3432626846499679, 'f1-score': 0.42680657706651337, 'support': 77850}, '2': {'precision': 0.4811278938934161, 'recall': 0.5577745936064035, 'f1-score': 0.5166238770588208, 'support': 101195}, 'accuracy': 0.49118750752152524, 'macro avg': {'precision': 0.5052173866143934, 'recall': 0.4808090804230496, 'f1-score': 0.4822834087569339, 'support': 274213}, 'weighted avg': {'precision': 0.5009693148060516, 'recall': 0.49118750752152524, 'f1-score': 0.48654184206852075, 'support': 274213}}
[[51523  9423 34222]
 [24477 26723 26650]
 [33524 11227 56444]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0721923
{'0': {'precision': 0.4789042480239651, 'recall': 0.5443245682405546, 'f1-score': 0.5095230781046002, 'support': 24377}, '1': {'precision': 0.5724443938790602, 'recall': 0.40851703000040596, 'f1-score': 0.4767838529328153, 'support': 24633}, '2': {'precision': 0.4636756756756757, 'recall': 0.5355448264380255, 'f1-score': 0.49702564894932016, 'support': 24026}, 'accuracy': 0.49563229092502326, 'macro avg': {'precision': 0.505008105859567, 'recall': 0.49612880822632865, 'f1-score': 0.4944441933289119, 'support': 73036}, 'weighted avg': {'precision': 0.5054431156181454, 'recall': 0.49563229092502326, 'f1-score': 0.4943698856167677, 'support': 73036}}
[[13269  3463  7645]
 [ 7332 10063  7238]
 [ 7106  4053 12867]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.095801
{'0': {'precision': 0.4657353716394307, 'recall': 0.5421908560908254, 'f1-score': 0.5010633772862612, 'support': 9777}, '1': {'precision': 0.5797289504036909, 'recall': 0.3883148237566393, 'f1-score': 0.4650974495402232, 'support': 10355}, '2': {'precision': 0.4489600556957619, 'recall': 0.5331197685233027, 'f1-score': 0.48743386243386244, 'support': 9677}, 'accuracy': 0.4857928813445604, 'macro avg': {'precision': 0.49814145924629444, 'recall': 0.48787514945692245, 'f1-score': 0.4845315630867823, 'support': 29809}, 'weighted avg': {'precision': 0.49988843869022176, 'recall': 0.4857928813445604, 'f1-score': 0.4841449970307381, 'support': 29809}}
[[5301 1315 3161]
 [3163 4021 3171]
 [2918 1600 5159]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2670237
{'0': {'precision': 0.35427225181754884, 'recall': 0.58075090578508, 'f1-score': 0.4400830705949202, 'support': 75349}, '1': {'precision': 0.3200683777872747, 'recall': 0.18959124413669867, 'f1-score': 0.23812819122075296, 'support': 67155}, '2': {'precision': 0.3701696471128215, 'recall': 0.27077737603305785, 'f1-score': 0.3127670840573657, 'support': 77440}, 'accuracy': 0.3521805550503765, 'macro avg': {'precision': 0.348170092239215, 'recall': 0.3470398419849456, 'f1-score': 0.3303261152910129, 'support': 219944}, 'weighted avg': {'precision': 0.34942616886535577, 'recall': 0.3521805550503765, 'f1-score': 0.33359401009842826, 'support': 219944}}
[[43759 13613 17977]
 [36722 12732 17701]
 [43037 13434 20969]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3049083
{'0': {'precision': 0.36489161058979674, 'recall': 0.5563602797600028, 'f1-score': 0.44072897038557807, 'support': 28167}, '1': {'precision': 0.3247400806280501, 'recall': 0.1128188117352204, 'f1-score': 0.16745992669183216, 'support': 27132}, '2': {'precision': 0.3413286021358627, 'recall': 0.3791835651745442, 'f1-score': 0.35926165337930044, 'support': 26383}, 'accuracy': 0.35180333488406257, 'macro avg': {'precision': 0.3436534311179032, 'recall': 0.3494542188899225, 'f1-score': 0.3224835168189035, 'support': 81682}, 'weighted avg': {'precision': 0.3439438600087354, 'recall': 0.35180333488406257, 'f1-score': 0.323644570908639, 'support': 81682}}
[[15671  3402  9094]
 [13860  3061 10211]
 [13416  2963 10004]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2765597
{'0': {'precision': 0.37513840702738616, 'recall': 0.5725552050473186, 'f1-score': 0.453284573875039, 'support': 8876}, '1': {'precision': 0.33221476510067116, 'recall': 0.16003481720964935, 'f1-score': 0.21601208459214502, 'support': 8042}, '2': {'precision': 0.3319628647214854, 'recall': 0.3112022877035932, 'f1-score': 0.3212475133157929, 'support': 8043}, 'accuracy': 0.35543447778534515, 'macro avg': {'precision': 0.34643867894984753, 'recall': 0.3479307699868537, 'f1-score': 0.3301813905943256, 'support': 24961}, 'weighted avg': {'precision': 0.3473970178546366, 'recall': 0.35543447778534515, 'f1-score': 0.33429417137149153, 'support': 24961}}
[[5082 1348 2446]
 [4164 1287 2591]
 [4301 1239 2503]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
1914/1914 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0223123
{'0': {'precision': 0.4914645527278828, 'recall': 0.5511173562076325, 'f1-score': 0.519584394564648, 'support': 170089}, '1': {'precision': 0.5536911820477481, 'recall': 0.4189752922236999, 'f1-score': 0.4770040521318517, 'support': 142870}, '2': {'precision': 0.5044851263371642, 'recall': 0.5447276220614828, 'f1-score': 0.5238346248736536, 'support': 176960}, 'accuracy': 0.5102741473590532, 'macro avg': {'precision': 0.516546953704265, 'recall': 0.5049400901642717, 'f1-score': 0.5068076905233845, 'support': 489919}, 'weighted avg': {'precision': 0.5143141242628255, 'recall': 0.5102741473590532, 'f1-score': 0.5087023247369991, 'support': 489919}}
[[93739 22566 53784]
 [42114 59859 40897]
 [54881 25684 96395]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97170615
{'0': {'precision': 0.49859847406052793, 'recall': 0.5474219508582525, 'f1-score': 0.5218707835200351, 'support': 60763}, '1': {'precision': 0.607130060910068, 'recall': 0.5017519617035977, 'f1-score': 0.5494339214785592, 'support': 60789}, '2': {'precision': 0.4999395149095748, 'recall': 0.5373226503713575, 'f1-score': 0.5179574348088327, 'support': 61531}, 'accuracy': 0.5288639578770284, 'macro avg': {'precision': 0.5352226832933903, 'recall': 0.5288321876444025, 'f1-score': 0.5297540466024756, 'support': 183083}, 'weighted avg': {'precision': 0.5350848885145155, 'recall': 0.5288639578770284, 'f1-score': 0.5297073567344337, 'support': 183083}}
[[33263  9039 18461]
 [15679 30501 14609]
 [17771 10698 33062]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0272171
{'0': {'precision': 0.49299962829884775, 'recall': 0.587421878844545, 'f1-score': 0.536084789149863, 'support': 20321}, '1': {'precision': 0.5015035081857668, 'recall': 0.32477461233321314, 'f1-score': 0.3942391875328314, 'support': 13865}, '2': {'precision': 0.49478147423352903, 'recall': 0.5188098495212038, 'f1-score': 0.5065108514190317, 'support': 20468}, 'accuracy': 0.4950964247813518, 'macro avg': {'precision': 0.49642820357271455, 'recall': 0.47700211356632066, 'f1-score': 0.47894494270057536, 'support': 54654}, 'weighted avg': {'precision': 0.49582425444191486, 'recall': 0.4950964247813518, 'f1-score': 0.48902494679807174, 'support': 54654}}
[[11937  1931  6453]
 [ 4972  4503  4390]
 [ 7304  2545 10619]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
4918/4918 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57454014
{'0': {'precision': 0.5796547144754316, 'recall': 0.4846618500532986, 'f1-score': 0.5279191091687563, 'support': 202632}, '1': {'precision': 0.817800741929746, 'recall': 0.8974090339876889, 'f1-score': 0.8557574520784639, 'support': 850455}, '2': {'precision': 0.6113195707297082, 'recall': 0.4640100703759866, 'f1-score': 0.5275748499685017, 'support': 205752}, 'accuracy': 0.7601329478988179, 'macro avg': {'precision': 0.6695916757116286, 'recall': 0.6153603181389914, 'f1-score': 0.637083803738574, 'support': 1258839}, 'weighted avg': {'precision': 0.7457185139626487, 'recall': 0.7601329478988179, 'f1-score': 0.7493460953840742, 'support': 1258839}}
[[ 98208  79377  25047]
 [ 51595 763206  35654]
 [ 19622  90659  95471]]
Evaluating performance on  train set...
1403/1403 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.545129
{'0': {'precision': 0.5363866653156348, 'recall': 0.5188684793475917, 'f1-score': 0.5274821634979473, 'support': 51011}, '1': {'precision': 0.8449696076625529, 'recall': 0.8939778383202959, 'f1-score': 0.8687831309100619, 'support': 256569}, '2': {'precision': 0.6225743092837501, 'recall': 0.46250972762645914, 'f1-score': 0.5307361723502819, 'support': 51400}, 'accuracy': 0.7788957602094824, 'macro avg': {'precision': 0.6679768607539792, 'recall': 0.6251186817647822, 'f1-score': 0.6423338222527637, 'support': 358980}, 'weighted avg': {'precision': 0.7692766921554799, 'recall': 0.7788957602094824, 'f1-score': 0.7718815839753245, 'support': 358980}}
[[ 26468  19180   5363]
 [ 18153 229367   9049]
 [  4724  22903  23773]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.55892307
{'0': {'precision': 0.5612429167445047, 'recall': 0.48089851670045886, 'f1-score': 0.5179736214476597, 'support': 18742}, '1': {'precision': 0.8283267811944639, 'recall': 0.9002856340138603, 'f1-score': 0.8628084523949762, 'support': 85424}, '2': {'precision': 0.6260768840946934, 'recall': 0.4661743302247857, 'f1-score': 0.5344209615622296, 'support': 18551}, 'accuracy': 0.7706104288729353, 'macro avg': {'precision': 0.6718821940112206, 'recall': 0.6157861603130349, 'f1-score': 0.6384010118016219, 'support': 122717}, 'weighted avg': {'precision': 0.7569623929791475, 'recall': 0.7706104288729353, 'f1-score': 0.7605014310038658, 'support': 122717}}
[[ 9013  7663  2066]
 [ 5419 76906  3099]
 [ 1627  8276  8648]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
4856/4856 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8255451
{'0': {'precision': 0.5179806338454513, 'recall': 0.48675886372650373, 'f1-score': 0.501884648453147, 'support': 307602}, '1': {'precision': 0.7463401861062037, 'recall': 0.724417243748843, 'f1-score': 0.735215324489424, 'support': 637402}, '2': {'precision': 0.49178762698969164, 'recall': 0.5533046213339331, 'f1-score': 0.5207355947089245, 'support': 297901}, 'accuracy': 0.6245875589847977, 'macro avg': {'precision': 0.5853694823137823, 'recall': 0.5881602429364267, 'f1-score': 0.5859451892171651, 'support': 1242905}, 'weighted avg': {'precision': 0.6288128474054341, 'recall': 0.6245875589847977, 'f1-score': 0.6260624056489241, 'support': 1242905}}
[[149728  78061  79813]
 [ 85135 461745  90522]
 [ 54198  78873 164830]]
Evaluating performance on  train set...
2076/2076 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66895396
{'0': {'precision': 0.5428171882091731, 'recall': 0.45944991849490724, 'f1-score': 0.4976663630126972, 'support': 96313}, '1': {'precision': 0.7833458051362138, 'recall': 0.8578805001380695, 'f1-score': 0.8189206923282961, 'support': 336787}, '2': {'precision': 0.5481698064325105, 'recall': 0.45196826365578274, 'f1-score': 0.49544230544080015, 'support': 98310}, 'accuracy': 0.7105756383959655, 'macro avg': {'precision': 0.6247775999259658, 'recall': 0.5897662274295865, 'f1-score': 0.6040097869272645, 'support': 531410}, 'weighted avg': {'precision': 0.6962451011324217, 'recall': 0.7105756383959655, 'f1-score': 0.7008534214182963, 'support': 531410}}
[[ 44251  36748  15314]
 [ 26554 288923  21310]
 [ 10716  43161  44433]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6501154
{'0': {'precision': 0.5668583578988063, 'recall': 0.43534738717339666, 'f1-score': 0.49247433717488504, 'support': 26944}, '1': {'precision': 0.7794924805152036, 'recall': 0.8821745072055657, 'f1-score': 0.8276608970996755, 'support': 96592}, '2': {'precision': 0.5734692872272302, 'recall': 0.43482483005901246, 'f1-score': 0.4946149761019649, 'support': 26774}, 'accuracy': 0.7223937196460648, 'macro avg': {'precision': 0.6399400418804134, 'recall': 0.5841155748126583, 'f1-score': 0.6049167367921752, 'support': 150310}, 'weighted avg': {'precision': 0.7046785707495965, 'recall': 0.7223937196460648, 'f1-score': 0.7082527528683784, 'support': 150310}}
[[11730 11480  3734]
 [ 6456 85211  4925]
 [ 2507 12625 11642]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
4353/4353 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7592308
{'0': {'precision': 0.5854564508616674, 'recall': 0.4182614518819228, 'f1-score': 0.4879336404814413, 'support': 240419}, '1': {'precision': 0.7308576922971862, 'recall': 0.8481449429725292, 'f1-score': 0.7851453087012086, 'support': 630924}, '2': {'precision': 0.524858096351864, 'recall': 0.45444853773487826, 'f1-score': 0.48712218645970984, 'support': 242945}, 'accuracy': 0.6695567034734288, 'macro avg': {'precision': 0.6137240798369059, 'recall': 0.5736183108631101, 'f1-score': 0.5867337118807865, 'support': 1114288}, 'weighted avg': {'precision': 0.6545723936117276, 'recall': 0.6695567034734288, 'f1-score': 0.6560417380850939, 'support': 1114288}}
[[100558  92646  47215]
 [ 43076 535115  52733]
 [ 28126 104413 110406]]
Evaluating performance on  train set...
1542/1542 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8121389
{'0': {'precision': 0.5358608341001219, 'recall': 0.4529783365041992, 'f1-score': 0.49094606371647137, 'support': 95137}, '1': {'precision': 0.7109757471254409, 'recall': 0.7933268232313955, 'f1-score': 0.749897184218463, 'support': 206858}, '2': {'precision': 0.5270213506474802, 'recall': 0.4743863970270504, 'f1-score': 0.49932060196371614, 'support': 92568}, 'accuracy': 0.6364357529722756, 'macro avg': {'precision': 0.5912859772910144, 'recall': 0.573563852254215, 'f1-score': 0.5800546166328835, 'support': 394563}, 'weighted avg': {'precision': 0.6255947102475237, 'recall': 0.6364357529722756, 'f1-score': 0.6286714083161219, 'support': 394563}}
[[ 43095  32609  19433]
 [ 22775 164106  19977]
 [ 14552  34103  43913]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8054452
{'0': {'precision': 0.562246247890151, 'recall': 0.42850189479539685, 'f1-score': 0.48634677610291216, 'support': 28763}, '1': {'precision': 0.7110809600337223, 'recall': 0.8157186895551257, 'f1-score': 0.7598142022661694, 'support': 66176}, '2': {'precision': 0.5247890088321884, 'recall': 0.4712206125973706, 'f1-score': 0.4965642758979311, 'support': 28371}, 'accuracy': 0.6461357554131862, 'macro avg': {'precision': 0.5993720722520206, 'recall': 0.5718137323159643, 'f1-score': 0.5809084180890042, 'support': 123310}, 'weighted avg': {'precision': 0.6335023226732142, 'recall': 0.6461357554131862, 'f1-score': 0.6354576436762168, 'support': 123310}}
[[12325 10798  5640]
 [ 5729 53981  6466]
 [ 3867 11135 13369]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
5497/5497 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8646272
{'0': {'precision': 0.5014211176494873, 'recall': 0.45734428993080195, 'f1-score': 0.4783695431533598, 'support': 345241}, '1': {'precision': 0.7049702435358398, 'recall': 0.7227418871193443, 'f1-score': 0.7137454578357603, 'support': 720336}, '2': {'precision': 0.4983564764437711, 'recall': 0.5161376249912184, 'f1-score': 0.5070912246544259, 'support': 341624}, 'accuracy': 0.6074725643316058, 'macro avg': {'precision': 0.5682492792096994, 'recall': 0.5654079340137882, 'f1-score': 0.5664020752145154, 'support': 1407201}, 'weighted avg': {'precision': 0.6048724427673703, 'recall': 0.6074725643316058, 'f1-score': 0.6058294871128808, 'support': 1407201}}
[[157894 110087  77260]
 [ 99491 520617 100228]
 [ 57508 107791 176325]]
Evaluating performance on  train set...
2058/2058 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8456368
{'0': {'precision': 0.5379768223110104, 'recall': 0.4355361726438095, 'f1-score': 0.4813666943835513, 'support': 124279}, '1': {'precision': 0.7019113515102717, 'recall': 0.7586620300656852, 'f1-score': 0.7291841650411979, 'support': 276927}, '2': {'precision': 0.4883642123679005, 'recall': 0.4933210208728048, 'f1-score': 0.4908301024509823, 'support': 125618}, 'accuracy': 0.6191669324100648, 'macro avg': {'precision': 0.5760841287297276, 'recall': 0.5625064078607664, 'f1-score': 0.5671269872919105, 'support': 526824}, 'weighted avg': {'precision': 0.6123197917500076, 'recall': 0.6191669324100648, 'f1-score': 0.6138893643671219, 'support': 526824}}
[[ 54128  42405  27746]
 [ 29656 210094  37177]
 [ 16830  46818  61970]]
Evaluating performance on  val set...
681/681 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8784441
{'0': {'precision': 0.5264325806030544, 'recall': 0.4484599132658735, 'f1-score': 0.48432808934790444, 'support': 44965}, '1': {'precision': 0.6880535998183057, 'recall': 0.7155003424576651, 'f1-score': 0.701508608213405, 'support': 84682}, '2': {'precision': 0.4870446864438603, 'recall': 0.5228433216877184, 'f1-score': 0.5043095068368868, 'support': 44652}, 'accuracy': 0.5972552911950154, 'macro avg': {'precision': 0.5671769556217401, 'recall': 0.5622678591370857, 'f1-score': 0.5633820681327321, 'support': 174299}, 'weighted avg': {'precision': 0.594864659382563, 'recall': 0.5972552911950154, 'f1-score': 0.5949626366045517, 'support': 174299}}
[[20165 13631 11169]
 [10673 60590 13419]
 [ 7467 13839 23346]]
testing model on single stock: results/universal/W2/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
14883/14883 - 213s - 213s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1813877
{'0': {'precision': 0.46005448472476623, 'recall': 0.5238563809062738, 'f1-score': 0.48988680947851426, 'support': 1206302}, '1': {'precision': 0.5541586119549381, 'recall': 0.17237699576409254, 'f1-score': 0.2629580592904219, 'support': 1350360}, '2': {'precision': 0.4229407035504863, 'recall': 0.6804443213853405, 'f1-score': 0.5216449263128017, 'support': 1253237}, 'accuracy': 0.4507883279845476, 'macro avg': {'precision': 0.4790512667433968, 'recall': 0.458892566018569, 'f1-score': 0.4248299316939126, 'support': 3809899}, 'weighted avg': {'precision': 0.48119994959641343, 'recall': 0.4507883279845476, 'f1-score': 0.41990199884785434, 'support': 3809899}}
[[631929  90274 484099]
 [438187 232771 679402]
 [303480  96999 852758]]
Evaluating performance on  train set...
6147/6147 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1480887
{'0': {'precision': 0.46919749912216324, 'recall': 0.5408778125857276, 'f1-score': 0.5024942478136346, 'support': 521273}, '1': {'precision': 0.5747158423311441, 'recall': 0.17750083560139426, 'f1-score': 0.2712318012610885, 'support': 523575}, '2': {'precision': 0.43575912291736035, 'recall': 0.6684057302080634, 'f1-score': 0.5275732041713854, 'support': 528637}, 'accuracy': 0.4628096232248798, 'macro avg': {'precision': 0.4932241547902225, 'recall': 0.4622614594650618, 'f1-score': 0.43376641774870284, 'support': 1573485}, 'weighted avg': {'precision': 0.49307443704267967, 'recall': 0.4628096232248798, 'f1-score': 0.4339676516264088, 'support': 1573485}}
[[281945  33605 205723]
 [178837  92935 251803]
 [140127  35166 353344]]
Evaluating performance on  val set...
2174/2174 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0985928
{'0': {'precision': 0.4716713135883003, 'recall': 0.5404875161665096, 'f1-score': 0.5037400242609973, 'support': 182476}, '1': {'precision': 0.616949197226543, 'recall': 0.25098806810564417, 'f1-score': 0.3568158513667534, 'support': 186475}, '2': {'precision': 0.4486398102694601, 'recall': 0.6495497272770897, 'f1-score': 0.5307168870998659, 'support': 187553}, 'accuracy': 0.4802373388151747, 'macro avg': {'precision': 0.5124201070281011, 'recall': 0.4803417705164145, 'f1-score': 0.46375758757587215, 'support': 556504}, 'weighted avg': {'precision': 0.5125893767279773, 'recall': 0.4802373388151747, 'f1-score': 0.4635999828876454, 'support': 556504}}
[[ 98626  13973  69877]
 [ 59831  46803  79841]
 [ 50642  15086 121825]]
training model: results/universal/W2/deepVOL_L3/h30
Epoch 1/50
9940/9940 - 580s - loss: 2.9508 - accuracy30: 0.4877 - val_loss: 3.3122 - val_accuracy30: 0.4919 - 580s/epoch - 58ms/step
Epoch 2/50
9940/9940 - 590s - loss: 2.8624 - accuracy30: 0.5188 - val_loss: 3.3407 - val_accuracy30: 0.4993 - 590s/epoch - 59ms/step
Epoch 3/50
9940/9940 - 584s - loss: 2.8300 - accuracy30: 0.5263 - val_loss: 3.2615 - val_accuracy30: 0.5105 - 584s/epoch - 59ms/step
Epoch 4/50
9940/9940 - 574s - loss: 2.8102 - accuracy30: 0.5301 - val_loss: 3.1811 - val_accuracy30: 0.5125 - 574s/epoch - 58ms/step
Epoch 5/50
9940/9940 - 593s - loss: 2.7967 - accuracy30: 0.5328 - val_loss: 3.2058 - val_accuracy30: 0.5140 - 593s/epoch - 60ms/step
Epoch 6/50
9940/9940 - 586s - loss: 2.7872 - accuracy30: 0.5350 - val_loss: 3.1685 - val_accuracy30: 0.5124 - 586s/epoch - 59ms/step
Epoch 7/50
9940/9940 - 603s - loss: 2.7798 - accuracy30: 0.5368 - val_loss: 3.1113 - val_accuracy30: 0.5135 - 603s/epoch - 61ms/step
Epoch 8/50
9940/9940 - 605s - loss: 2.7740 - accuracy30: 0.5376 - val_loss: 3.1037 - val_accuracy30: 0.5100 - 605s/epoch - 61ms/step
Epoch 9/50
9940/9940 - 610s - loss: 2.7690 - accuracy30: 0.5388 - val_loss: 3.0921 - val_accuracy30: 0.5090 - 610s/epoch - 61ms/step
Epoch 10/50
9940/9940 - 623s - loss: 2.7645 - accuracy30: 0.5397 - val_loss: 3.1153 - val_accuracy30: 0.5062 - 623s/epoch - 63ms/step
Epoch 11/50
9940/9940 - 624s - loss: 2.7612 - accuracy30: 0.5404 - val_loss: 3.1133 - val_accuracy30: 0.5054 - 624s/epoch - 63ms/step
Epoch 12/50
9940/9940 - 626s - loss: 2.7579 - accuracy30: 0.5409 - val_loss: 3.1431 - val_accuracy30: 0.5091 - 626s/epoch - 63ms/step
Epoch 13/50
9940/9940 - 619s - loss: 2.7548 - accuracy30: 0.5415 - val_loss: 3.1153 - val_accuracy30: 0.5095 - 619s/epoch - 62ms/step
Epoch 14/50
9940/9940 - 628s - loss: 2.7518 - accuracy30: 0.5423 - val_loss: 3.1334 - val_accuracy30: 0.5092 - 628s/epoch - 63ms/step
Epoch 15/50
9940/9940 - 629s - loss: 2.7495 - accuracy30: 0.5427 - val_loss: 3.1579 - val_accuracy30: 0.5093 - 629s/epoch - 63ms/step
Epoch 16/50
9940/9940 - 596s - loss: 2.7466 - accuracy30: 0.5433 - val_loss: 3.1425 - val_accuracy30: 0.5092 - 596s/epoch - 60ms/step
Epoch 17/50
9940/9940 - 576s - loss: 2.7442 - accuracy30: 0.5440 - val_loss: 3.1387 - val_accuracy30: 0.5103 - 576s/epoch - 58ms/step
Epoch 18/50
9940/9940 - 595s - loss: 2.7421 - accuracy30: 0.5444 - val_loss: 3.1846 - val_accuracy30: 0.5090 - 595s/epoch - 60ms/step
Epoch 19/50
9940/9940 - 600s - loss: 2.7400 - accuracy30: 0.5448 - val_loss: 3.1950 - val_accuracy30: 0.5095 - 600s/epoch - 60ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 889s - 889s/epoch - 34ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1003491
{'0': {'precision': 0.4616012678962756, 'recall': 0.44199465253679426, 'f1-score': 0.45158524380361087, 'support': 1845735}, '1': {'precision': 0.6739650681454755, 'recall': 0.477415190059753, 'f1-score': 0.5589138059460352, 'support': 2961858}, '2': {'precision': 0.4240325256439935, 'recall': 0.632853433243988, 'f1-score': 0.5078134256666058, 'support': 1913176}, 'accuracy': 0.51193561332044, 'macro avg': {'precision': 0.5198662872285816, 'recall': 0.517421091946845, 'f1-score': 0.5061041584720839, 'support': 6720769}, 'weighted avg': {'precision': 0.544495919483206, 'recall': 0.51193561332044, 'f1-score': 0.5148914470779614, 'support': 6720769}}
[[ 815805  335893  694037]
 [ 597272 1414036  950550]
 [ 354260  348156 1210760]]
Evaluating performance on  train set...
9940/9940 - 363s - 363s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0806602
{'0': {'precision': 0.4716324865592335, 'recall': 0.45285052773663786, 'f1-score': 0.46205071836557915, 'support': 746774}, '1': {'precision': 0.6840688139925615, 'recall': 0.4565515747586252, 'f1-score': 0.5476189928772113, 'support': 1043398}, '2': {'precision': 0.4311120234220094, 'recall': 0.6466914946141228, 'f1-score': 0.517341934976968, 'support': 753452}, 'accuracy': 0.5117867263400565, 'macro avg': {'precision': 0.5289377746579348, 'recall': 0.5186978657031286, 'f1-score': 0.5090038820732529, 'support': 2543624}, 'weighted avg': {'precision': 0.5467715067837681, 'recall': 0.5117867263400565, 'f1-score': 0.5135288630234264, 'support': 2543624}}
[[338177 108801 299796]
 [223861 476365 343172]
 [154997 111204 487251]]
Evaluating performance on  val set...
3393/3393 - 122s - 122s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0658245
{'0': {'precision': 0.4686765245948695, 'recall': 0.43611075105365904, 'f1-score': 0.45180757210755906, 'support': 254589}, '1': {'precision': 0.6776656964100505, 'recall': 0.45574925044017306, 'f1-score': 0.5449824603887302, 'support': 355542}, '2': {'precision': 0.4302456666564646, 'recall': 0.6539448588131309, 'f1-score': 0.5190175252910627, 'support': 257956}, 'accuracy': 0.5088844781686628, 'macro avg': {'precision': 0.5255292958871282, 'recall': 0.5152682867689876, 'f1-score': 0.5052691859291173, 'support': 868087}, 'weighted avg': {'precision': 0.5428522209653415, 'recall': 0.5088844781686628, 'f1-score': 0.5099409122136406, 'support': 868087}}
[[111029  38892 104668]
 [ 74785 162038 118719]
 [ 51085  38182 168689]]
testing model out of sample: results/universal/W2/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 518s - 518s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9877011
{'0': {'precision': 0.4976381661218363, 'recall': 0.3960389184158997, 'f1-score': 0.4410632978808173, 'support': 1083189}, '1': {'precision': 0.6332125694548731, 'recall': 0.5888919327959047, 'f1-score': 0.6102485887420828, 'support': 1489314}, '2': {'precision': 0.46274528588304326, 'recall': 0.6003509317054001, 'f1-score': 0.5226423703253457, 'support': 1094230}, 'accuracy': 0.5353408606517027, 'macro avg': {'precision': 0.5311986738199176, 'recall': 0.5284272609724016, 'f1-score': 0.5246514189827486, 'support': 3666733}, 'weighted avg': {'precision': 0.5422915457330172, 'recall': 0.5353408606517027, 'f1-score': 0.5341260572130978, 'support': 3666733}}
[[428985 259305 394899]
 [244471 877045 367798]
 [188586 248722 656922]]
Evaluating performance on  train set...
5373/5373 - 195s - 195s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9083315
{'0': {'precision': 0.518256903397191, 'recall': 0.3980745116156283, 'f1-score': 0.45028438473514193, 'support': 363648}, '1': {'precision': 0.6628189793549936, 'recall': 0.6943248933355691, 'f1-score': 0.6782062335499751, 'support': 644076}, '2': {'precision': 0.4696185629226244, 'recall': 0.5383203329266167, 'f1-score': 0.5016280692849439, 'support': 367168}, 'accuracy': 0.5743076547103336, 'macro avg': {'precision': 0.550231481891603, 'recall': 0.5435732459592714, 'f1-score': 0.5433728958566869, 'support': 1374892}, 'weighted avg': {'precision': 0.5729888542989579, 'recall': 0.5743076547103336, 'f1-score': 0.5707671213181202, 'support': 1374892}}
[[144759 109797 109092]
 [ 82742 447198 114136]
 [ 51818 117696 197654]]
Evaluating performance on  val set...
1685/1685 - 62s - 62s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9314698
{'0': {'precision': 0.5188928140231632, 'recall': 0.3877597052705446, 'f1-score': 0.44384308288111685, 'support': 119703}, '1': {'precision': 0.6493639107781508, 'recall': 0.6815401505646174, 'f1-score': 0.665063080619736, 'support': 191280}, '2': {'precision': 0.46976406430208884, 'recall': 0.5512954406837721, 'f1-score': 0.5072746212776427, 'support': 119689}, 'accuracy': 0.5636888397666902, 'macro avg': {'precision': 0.5460069297011343, 'recall': 0.540198432172978, 'f1-score': 0.5387269282594985, 'support': 430672}, 'weighted avg': {'precision': 0.5631871736795337, 'recall': 0.5636888397666902, 'f1-score': 0.5597248178594411, 'support': 430672}}
[[ 46416  34797  38490]
 [ 24927 130365  35988]
 [ 18109  35596  65984]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4369302
{'0': {'precision': 0.3988187935239327, 'recall': 0.3440470457022636, 'f1-score': 0.369413749931958, 'support': 78902}, '1': {'precision': 0.34113411341134114, 'recall': 0.0085016655637681, 'f1-score': 0.016589881922938032, 'support': 89159}, '2': {'precision': 0.36150641852398646, 'recall': 0.7801241206149182, 'f1-score': 0.49406505376142446, 'support': 84434}, 'accuracy': 0.3713855719915246, 'macro avg': {'precision': 0.3671531084864201, 'recall': 0.3775576106269833, 'f1-score': 0.29335622853877347, 'support': 252495}, 'weighted avg': {'precision': 0.3659724343290813, 'recall': 0.3713855719915246, 'f1-score': 0.2865106625033791, 'support': 252495}}
[[27146   766 50990]
 [23053   758 65348]
 [17867   698 65869]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3813082
{'0': {'precision': 0.41116780045351475, 'recall': 0.36449067792351375, 'f1-score': 0.38642478489038073, 'support': 19899}, '1': {'precision': 0.37795918367346937, 'recall': 0.023165057287236702, 'f1-score': 0.043654535168772386, 'support': 19987}, '2': {'precision': 0.374286125641887, 'recall': 0.7552413692925967, 'f1-score': 0.5005214433552073, 'support': 20653}, 'accuracy': 0.3851071210294191, 'macro avg': {'precision': 0.387804369922957, 'recall': 0.3809657015011157, 'f1-score': 0.3102002544714535, 'support': 60539}, 'weighted avg': {'precision': 0.3876216921024136, 'recall': 0.3851071210294191, 'f1-score': 0.3121832101383742, 'support': 60539}}
[[ 7253   362 12284]
 [ 5732   463 13792]
 [ 4655   400 15598]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4185905
{'0': {'precision': 0.39474889329873303, 'recall': 0.3827142222879976, 'f1-score': 0.3886384129846709, 'support': 6757}, '1': {'precision': 0.35570469798657717, 'recall': 0.020309107165666113, 'f1-score': 0.038424359594006766, 'support': 7829}, '2': {'precision': 0.36645664977400355, 'recall': 0.7629027658967779, 'f1-score': 0.4950962250185048, 'support': 7014}, 'accuracy': 0.3748148148148148, 'macro avg': {'precision': 0.3723034136864379, 'recall': 0.3886420317834805, 'f1-score': 0.30738633253239417, 'support': 21600}, 'weighted avg': {'precision': 0.37141005991070897, 'recall': 0.3748148148148148, 'f1-score': 0.29627124954068024, 'support': 21600}}
[[2586  150 4021]
 [2440  159 5230]
 [1525  138 5351]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1242/1242 - 22s - 22s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93365085
{'0': {'precision': 0.4126920053538422, 'recall': 0.5254544470893746, 'f1-score': 0.46229636945631086, 'support': 73936}, '1': {'precision': 0.7251542044310171, 'recall': 0.5502555162861782, 'f1-score': 0.6257128116004996, 'support': 167504}, '2': {'precision': 0.45137069295856336, 'recall': 0.5707644154585576, 'f1-score': 0.5040944736172476, 'support': 76359}, 'accuracy': 0.5494133084119207, 'macro avg': {'precision': 0.5297389675811409, 'recall': 0.5488247929447035, 'f1-score': 0.530701218224686, 'support': 317799}, 'weighted avg': {'precision': 0.5866766122941787, 'recall': 0.5494133084119207, 'f1-score': 0.5584721571729028, 'support': 317799}}
[[38850 16423 18663]
 [41023 92170 34311]
 [14265 18511 43583]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73233134
{'0': {'precision': 0.5212085257849909, 'recall': 0.48103245991396165, 'f1-score': 0.5003152392767801, 'support': 25570}, '1': {'precision': 0.7754494420327734, 'recall': 0.8171726243937488, 'f1-score': 0.7957645055771619, 'support': 83505}, '2': {'precision': 0.5229231890895055, 'recall': 0.4718835868261156, 'f1-score': 0.4960940678655708, 'support': 25839}, 'accuracy': 0.6873341536089657, 'macro avg': {'precision': 0.6065270523024232, 'recall': 0.5900295570446087, 'f1-score': 0.5973912709065042, 'support': 134914}, 'weighted avg': {'precision': 0.6788992983986294, 'recall': 0.6873341536089657, 'f1-score': 0.6823750709793399, 'support': 134914}}
[[12300  8921  4349]
 [ 8492 68238  6775]
 [ 2807 10839 12193]]
Evaluating performance on  val set...
159/159 - 6s - 6s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79034054
{'0': {'precision': 0.49553518275985237, 'recall': 0.48792497069167645, 'f1-score': 0.4917006320515092, 'support': 8530}, '1': {'precision': 0.7624853360147478, 'recall': 0.7605733868271481, 'f1-score': 0.7615281613524144, 'support': 23928}, '2': {'precision': 0.4883525456292027, 'recall': 0.49981565687599855, 'f1-score': 0.49401761311873676, 'support': 8137}, 'accuracy': 0.6510161349919941, 'macro avg': {'precision': 0.5821243548012677, 'recall': 0.5827713381316078, 'f1-score': 0.5824154688408868, 'support': 40595}, 'weighted avg': {'precision': 0.6514444855988976, 'recall': 0.6510161349919941, 'f1-score': 0.6512100887840154, 'support': 40595}}
[[ 4162  2745  1623]
 [ 3091 18199  2638]
 [ 1146  2924  4067]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.139203
{'0': {'precision': 0.46313466377790635, 'recall': 0.36341365546662163, 'f1-score': 0.4072586132427683, 'support': 94702}, '1': {'precision': 0.49517896274653034, 'recall': 0.2633030373650276, 'f1-score': 0.34379754538999896, 'support': 77238}, '2': {'precision': 0.4454455021658104, 'recall': 0.6917857107936601, 'f1-score': 0.5419352367821375, 'support': 102273}, 'accuracy': 0.4576880016629409, 'macro avg': {'precision': 0.4679197095634157, 'recall': 0.43950080120843643, 'f1-score': 0.4309971318049683, 'support': 274213}, 'weighted avg': {'precision': 0.4655631188044174, 'recall': 0.4576880016629409, 'f1-score': 0.43961366701640303, 'support': 274213}}
[[34416 10438 49848]
 [18668 20337 38233]
 [21227 10295 70751]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1443379
{'0': {'precision': 0.47093487814622453, 'recall': 0.38054882970137205, 'f1-score': 0.4209445585215606, 'support': 24780}, '1': {'precision': 0.4923385625684057, 'recall': 0.3414582718340151, 'f1-score': 0.40324709280609583, 'support': 23713}, '2': {'precision': 0.4235081769950227, 'recall': 0.6309742085319643, 'f1-score': 0.506832054198236, 'support': 24543}, 'accuracy': 0.45200996768716795, 'macro avg': {'precision': 0.4622605392365509, 'recall': 0.4509937700224505, 'f1-score': 0.4436745685086308, 'support': 73036}, 'weighted avg': {'precision': 0.46194687281117386, 'recall': 0.45200996768716795, 'f1-score': 0.44406023848598675, 'support': 73036}}
[[ 9430  4232 11118]
 [ 5654  8097  9962]
 [ 4940  4117 15486]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1686314
{'0': {'precision': 0.45464135021097046, 'recall': 0.39332792537010747, 'f1-score': 0.42176796781559206, 'support': 9862}, '1': {'precision': 0.5060406790029056, 'recall': 0.3332661899486353, 'f1-score': 0.4018702939033277, 'support': 9929}, '2': {'precision': 0.4218347129868367, 'recall': 0.6205829506887602, 'f1-score': 0.5022620778801098, 'support': 10018}, 'accuracy': 0.44969640041598175, 'macro avg': {'precision': 0.46083891406690425, 'recall': 0.449059022002501, 'f1-score': 0.4419667798663432, 'support': 29809}, 'weighted avg': {'precision': 0.4607363900936821, 'recall': 0.44969640041598175, 'f1-score': 0.4421922017835704, 'support': 29809}}
[[3879 1606 4377]
 [2476 3309 4144]
 [2177 1624 6217]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
860/860 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2509477
{'0': {'precision': 0.34137481948738846, 'recall': 0.5160650907386326, 'f1-score': 0.4109247192568972, 'support': 74665}, '1': {'precision': 0.2999184561022017, 'recall': 0.0819981570107904, 'f1-score': 0.12878602191953498, 'support': 67282}, '2': {'precision': 0.3608304389011683, 'recall': 0.4102337269382156, 'f1-score': 0.38394940992242294, 'support': 77997}, 'accuracy': 0.34575164587349505, 'macro avg': {'precision': 0.33404123816358616, 'recall': 0.33609899156254625, 'f1-score': 0.30788671703295173, 'support': 219944}, 'weighted avg': {'precision': 0.33559249719687106, 'recall': 0.34575164587349505, 'f1-score': 0.3150510012358855, 'support': 219944}}
[[38532  6527 29606]
 [34692  5517 27073]
 [39649  6351 31997]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3347529
{'0': {'precision': 0.3521994956570468, 'recall': 0.4470128022759602, 'f1-score': 0.3939821344616831, 'support': 28120}, '1': {'precision': 0.29244629244629244, 'recall': 0.04651846408230755, 'f1-score': 0.08026883083946235, 'support': 27215}, '2': {'precision': 0.3222043539831505, 'recall': 0.5095077238395264, 'f1-score': 0.3947654756653433, 'support': 26347}, 'accuracy': 0.3337332582453907, 'macro avg': {'precision': 0.32228338069549656, 'recall': 0.33434633006593134, 'f1-score': 0.2896721469888296, 'support': 81682}, 'weighted avg': {'precision': 0.322615677642517, 'recall': 0.3337332582453907, 'f1-score': 0.2897110726930449, 'support': 81682}}
[[12570  1589 13961]
 [11671  1266 14278]
 [11449  1474 13424]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.302724
{'0': {'precision': 0.3578044013934914, 'recall': 0.48368940960257295, 'f1-score': 0.4113308913308914, 'support': 8706}, '1': {'precision': 0.3069069069069069, 'recall': 0.06184194602444633, 'f1-score': 0.10294117647058823, 'support': 8263}, '2': {'precision': 0.32063850091090484, 'recall': 0.4624624624624625, 'f1-score': 0.3787079256109432, 'support': 7992}, 'accuracy': 0.3372461039221185, 'macro avg': {'precision': 0.32844993640376774, 'recall': 0.33599793936316064, 'f1-score': 0.29765999780414093, 'support': 24961}, 'weighted avg': {'precision': 0.32905571850420495, 'recall': 0.3372461039221185, 'f1-score': 0.2987974609425051, 'support': 24961}}
[[4211  603 3892]
 [3813  511 3939]
 [3745  551 3696]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
1914/1914 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1055573
{'0': {'precision': 0.4871277552346625, 'recall': 0.38511765724970576, 'f1-score': 0.4301576074626666, 'support': 167393}, '1': {'precision': 0.4921529064830961, 'recall': 0.36677484980234465, 'f1-score': 0.42031313351838573, 'support': 146973}, '2': {'precision': 0.46019939608706345, 'recall': 0.6502423769459935, 'f1-score': 0.538958739571579, 'support': 175553}, 'accuracy': 0.47461723264458, 'macro avg': {'precision': 0.4798266859349407, 'recall': 0.4673782946660146, 'f1-score': 0.4631431601842104, 'support': 489919}, 'weighted avg': {'precision': 0.47898601613288766, 'recall': 0.47461723264458, 'f1-score': 0.46619110131798375, 'support': 489919}}
[[ 64466  28626  74301]
 [ 33471  53906  59596]
 [ 34402  26999 114152]]
Evaluating performance on  train set...
716/716 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0383707
{'0': {'precision': 0.5061565704402257, 'recall': 0.39564790523249266, 'f1-score': 0.4441312772703867, 'support': 62131}, '1': {'precision': 0.5356833477710402, 'recall': 0.4073748754244016, 'f1-score': 0.46280056034234607, 'support': 59201}, '2': {'precision': 0.44442209707696434, 'recall': 0.6441029295072145, 'f1-score': 0.5259476221015954, 'support': 61751}, 'accuracy': 0.48323984203885667, 'macro avg': {'precision': 0.4954206717627434, 'recall': 0.48237523672136956, 'f1-score': 0.47762648657144274, 'support': 183083}, 'weighted avg': {'precision': 0.49488217183471234, 'recall': 0.48323984203885667, 'f1-score': 0.47776346232751943, 'support': 183083}}
[[24582 10648 26901]
 [12263 24117 22821]
 [11721 10256 39774]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1098868
{'0': {'precision': 0.49261204054219077, 'recall': 0.4030775379696243, 'f1-score': 0.44336978622849926, 'support': 20016}, '1': {'precision': 0.42812604387039305, 'recall': 0.2658507916753094, 'f1-score': 0.3280156969800375, 'support': 14463}, '2': {'precision': 0.4489161973032941, 'recall': 0.6518463444857497, 'f1-score': 0.5316757630887406, 'support': 20175}, 'accuracy': 0.45859406447835477, 'macro avg': {'precision': 0.45655142723862596, 'recall': 0.4402582247102278, 'f1-score': 0.4343537487657591, 'support': 54654}, 'weighted avg': {'precision': 0.4594173135833415, 'recall': 0.45859406447835477, 'f1-score': 0.4454411239229931, 'support': 54654}}
[[ 8068  2488  9460]
 [ 3934  3845  6684]
 [ 4376  2648 13151]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
4918/4918 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66170686
{'0': {'precision': 0.6297904851458964, 'recall': 0.44041410318057217, 'f1-score': 0.518346893169132, 'support': 243321}, '1': {'precision': 0.7506254696451763, 'recall': 0.9015568571752766, 'f1-score': 0.819197165280613, 'support': 766737}, '2': {'precision': 0.6469638088880412, 'recall': 0.43630743505332, 'f1-score': 0.5211531675136896, 'support': 248781}, 'accuracy': 0.720476566105753, 'macro avg': {'precision': 0.6757932545597045, 'recall': 0.5927594651363896, 'f1-score': 0.6195657419878114, 'support': 1258839}, 'weighted avg': {'precision': 0.7067828965375985, 'recall': 0.720476566105753, 'f1-score': 0.7021441721108029, 'support': 1258839}}
[[107162 108428  27731]
 [ 43980 691257  31500]
 [ 19013 121223 108545]]
Evaluating performance on  train set...
1403/1403 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6247237
{'0': {'precision': 0.5929049914222694, 'recall': 0.466316499614495, 'f1-score': 0.5220463945333573, 'support': 62256}, '1': {'precision': 0.7854757992231849, 'recall': 0.8981466455993509, 'f1-score': 0.8380411611180841, 'support': 234170}, '2': {'precision': 0.64684305187429, 'recall': 0.4369504747897816, 'f1-score': 0.5215723690487549, 'support': 62554}, 'accuracy': 0.7428909688562036, 'macro avg': {'precision': 0.6750746141732481, 'recall': 0.6004712066678758, 'f1-score': 0.6272199749000654, 'support': 358980}, 'weighted avg': {'precision': 0.7279218377542547, 'recall': 0.7428909688562036, 'f1-score': 0.7280936459149988, 'support': 358980}}
[[ 29031  26837   6388]
 [ 15316 210319   8535]
 [  4617  30604  27333]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6493595
{'0': {'precision': 0.6102320999815305, 'recall': 0.43701776817600635, 'f1-score': 0.5093001746994142, 'support': 22681}, '1': {'precision': 0.7647200719282472, 'recall': 0.9004919239260952, 'f1-score': 0.8270709682009808, 'support': 77451}, '2': {'precision': 0.6500785751702463, 'recall': 0.43958379455390745, 'f1-score': 0.5245000924531791, 'support': 22585}, 'accuracy': 0.7300048078098389, 'macro avg': {'precision': 0.6750102490266746, 'recall': 0.592364495552003, 'f1-score': 0.6202904117845247, 'support': 122717}, 'weighted avg': {'precision': 0.7150682722916611, 'recall': 0.7300048078098389, 'f1-score': 0.7126538736160974, 'support': 122717}}
[[ 9912 10394  2375]
 [ 4738 69744  2969]
 [ 1593 11064  9928]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
4856/4856 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8865587
{'0': {'precision': 0.5224512166043269, 'recall': 0.4208024949693575, 'f1-score': 0.46614982321159515, 'support': 348862}, '1': {'precision': 0.6794845943260324, 'recall': 0.6737723049432042, 'f1-score': 0.676616393442623, 'support': 555146}, '2': {'precision': 0.48204472594965475, 'recall': 0.5852279601176759, 'f1-score': 0.5286484988058684, 'support': 338897}, 'accuracy': 0.5786250759309842, 'macro avg': {'precision': 0.5613268456266713, 'recall': 0.5599342533434125, 'f1-score': 0.5571382384866955, 'support': 1242905}, 'weighted avg': {'precision': 0.5815730425244877, 'recall': 0.5786250759309842, 'f1-score': 0.57719635392822, 'support': 1242905}}
[[146802  90214 111846]
 [ 79843 374042 101261]
 [ 54342  86223 198332]]
Evaluating performance on  train set...
2076/2076 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7661203
{'0': {'precision': 0.527194701986755, 'recall': 0.4398960248974395, 'f1-score': 0.47960516486005816, 'support': 113104}, '1': {'precision': 0.7257566528743358, 'recall': 0.7979032928462568, 'f1-score': 0.7601218693973624, 'support': 303142}, '2': {'precision': 0.51588311262746, 'recall': 0.4647893438921885, 'f1-score': 0.4890052164697929, 'support': 115164}, 'accuracy': 0.6495154400557008, 'macro avg': {'precision': 0.5896114891628502, 'recall': 0.5675295538786282, 'f1-score': 0.5762440835757378, 'support': 531410}, 'weighted avg': {'precision': 0.6380126750000388, 'recall': 0.6495154400557008, 'f1-score': 0.6416626014729013, 'support': 531410}}
[[ 49754  42428  20922]
 [ 31955 241878  29309]
 [ 12666  48971  53527]]
Evaluating performance on  val set...
588/588 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7462518
{'0': {'precision': 0.561759654762429, 'recall': 0.39995610734888387, 'f1-score': 0.46724658914018863, 'support': 31896}, '1': {'precision': 0.7158143317687868, 'recall': 0.8420670416820362, 'f1-score': 0.7738248457403141, 'support': 86752}, '2': {'precision': 0.5454047283544701, 'recall': 0.4400859073968795, 'f1-score': 0.4871176367767873, 'support': 31662}, 'accuracy': 0.6635752777592975, 'macro avg': {'precision': 0.6076595716285619, 'recall': 0.5607030188092665, 'f1-score': 0.5760630238857634, 'support': 150310}, 'weighted avg': {'precision': 0.6472278315951531, 'recall': 0.6635752777592975, 'f1-score': 0.648375150292767, 'support': 150310}}
[[12757 14042  5097]
 [ 7184 73051  6517]
 [ 2768 14960 13934]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
4353/4353 - 65s - 65s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8424173
{'0': {'precision': 0.5978539261740893, 'recall': 0.3546711120872474, 'f1-score': 0.44521982802454213, 'support': 277739}, '1': {'precision': 0.6600853972930669, 'recall': 0.8257262456223703, 'f1-score': 0.7336728575197677, 'support': 555666}, '2': {'precision': 0.5114850364361012, 'recall': 0.4632925452946601, 'f1-score': 0.48619748515321287, 'support': 280883}, 'accuracy': 0.6169545036830694, 'macro avg': {'precision': 0.5898081199677524, 'recall': 0.5478966343347592, 'f1-score': 0.5550300568991743, 'support': 1114288}, 'weighted avg': {'precision': 0.6071157685115482, 'recall': 0.6169545036830694, 'f1-score': 0.5993931372181854, 'support': 1114288}}
[[ 98506 113737  65496]
 [ 38047 458828  58791]
 [ 28213 122539 130131]]
Evaluating performance on  train set...
1542/1542 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89561456
{'0': {'precision': 0.5343069648310511, 'recall': 0.3995248793782918, 'f1-score': 0.4571892188059764, 'support': 108604}, '1': {'precision': 0.6360566113876132, 'recall': 0.7370445625852423, 'f1-score': 0.6828368889427553, 'support': 179635}, '2': {'precision': 0.5028184678561584, 'recall': 0.49749821300929237, 'f1-score': 0.5001441923573323, 'support': 106324}, 'accuracy': 0.5795905850269792, 'macro avg': {'precision': 0.5577273480249408, 'recall': 0.5446892183242755, 'f1-score': 0.546723433368688, 'support': 394563}, 'weighted avg': {'precision': 0.5721458265763986, 'recall': 0.5795905850269792, 'f1-score': 0.5714963480423586, 'support': 394563}}
[[ 43390  37652  27562]
 [ 22495 132399  24741]
 [ 15323  38105  52896]]
Evaluating performance on  val set...
482/482 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8797658
{'0': {'precision': 0.5663660088823772, 'recall': 0.3735580117170985, 'f1-score': 0.4501865162405605, 'support': 33114}, '1': {'precision': 0.6366282387855268, 'recall': 0.7767700154936198, 'f1-score': 0.6997514329849214, 'support': 57443}, '2': {'precision': 0.5076638730441987, 'recall': 0.4863981925319818, 'f1-score': 0.496803567530483, 'support': 32753}, 'accuracy': 0.5913632308815181, 'macro avg': {'precision': 0.5702193735707008, 'recall': 0.5455754065809001, 'f1-score': 0.5489138389186549, 'support': 123310}, 'weighted avg': {'precision': 0.583504945036937, 'recall': 0.5913632308815181, 'f1-score': 0.5788265761987565, 'support': 123310}}
[[12370 12755  7989]
 [ 5362 44620  7461]
 [ 4109 12713 15931]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
5497/5497 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92603374
{'0': {'precision': 0.5099501675233324, 'recall': 0.3970203137314723, 'f1-score': 0.446454608351583, 'support': 393330}, '1': {'precision': 0.6280335434076052, 'recall': 0.6894480974487676, 'f1-score': 0.657309397275442, 'support': 620798}, '2': {'precision': 0.4948911721934823, 'recall': 0.5281258188682509, 'f1-score': 0.5109686502745086, 'support': 393073}, 'accuracy': 0.5626488326827511, 'macro avg': {'precision': 0.54429162770814, 'recall': 0.5381980766828303, 'f1-score': 0.5382442186338445, 'support': 1407201}, 'weighted avg': {'precision': 0.5578371709513534, 'recall': 0.5626488326827511, 'f1-score': 0.5574955749619847, 'support': 1407201}}
[[156160 128904 108266]
 [ 89178 428008 103612]
 [ 60888 124593 207592]]
Evaluating performance on  train set...
2058/2058 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91874224
{'0': {'precision': 0.5471719136177626, 'recall': 0.3758261789138269, 'f1-score': 0.4455947009378944, 'support': 143734}, '1': {'precision': 0.6192670262278728, 'recall': 0.7249961139841955, 'f1-score': 0.6679736639404225, 'support': 238033}, '2': {'precision': 0.4900586908657739, 'recall': 0.5048222422909615, 'f1-score': 0.49733092460031786, 'support': 145057}, 'accuracy': 0.5691084688624664, 'macro avg': {'precision': 0.552165876903803, 'recall': 0.5352148450629947, 'f1-score': 0.5369664298262116, 'support': 526824}, 'weighted avg': {'precision': 0.5640206964886779, 'recall': 0.5691084688624664, 'f1-score': 0.5603165683854309, 'support': 526824}}
[[ 54019  51992  37723]
 [ 26984 172573  38476]
 [ 17721  54108  73228]]
Evaluating performance on  val set...
681/681 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93542093
{'0': {'precision': 0.5395350151134213, 'recall': 0.37323145470179003, 'f1-score': 0.44123320742511923, 'support': 51172}, '1': {'precision': 0.6046019027330606, 'recall': 0.690818316345582, 'f1-score': 0.6448410521219945, 'support': 72307}, '2': {'precision': 0.48550158132262533, 'recall': 0.5376820149547422, 'f1-score': 0.5102612462885847, 'support': 50820}, 'accuracy': 0.5529291619573262, 'macro avg': {'precision': 0.5432128330563691, 'recall': 0.5339105953340381, 'f1-score': 0.5321118352785662, 'support': 174299}, 'weighted avg': {'precision': 0.5507732456131087, 'recall': 0.5529291619573262, 'f1-score': 0.5458251865043926, 'support': 174299}}
[[19099 16503 15570]
 [ 8969 49951 13387]
 [ 7331 16164 27325]]
testing model on single stock: results/universal/W2/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
14883/14883 - 216s - 216s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3259432
{'0': {'precision': 0.4346058483310938, 'recall': 0.4529383355129014, 'f1-score': 0.4435827604541175, 'support': 1176074}, '1': {'precision': 0.4945922410026719, 'recall': 0.1184699028739155, 'f1-score': 0.19115287198543474, 'support': 1404669}, '2': {'precision': 0.3987525330830095, 'recall': 0.7291979211751803, 'f1-score': 0.5155714368299907, 'support': 1229156}, 'accuracy': 0.4187507332871554, 'macro avg': {'precision': 0.4426502074722584, 'recall': 0.4335353865206657, 'f1-score': 0.3834356897565143, 'support': 3809899}, 'weighted avg': {'precision': 0.44515513287919295, 'recall': 0.4187507332871554, 'f1-score': 0.37373966868030584, 'support': 3809899}}
[[532689  90712 552673]
 [439474 166411 798784]
 [253520  79338 896298]]
Evaluating performance on  train set...
6147/6147 - 104s - 104s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2475854
{'0': {'precision': 0.45670889911558055, 'recall': 0.46178651306718954, 'f1-score': 0.4592336710928975, 'support': 522224}, '1': {'precision': 0.5030821034868005, 'recall': 0.1241016587874104, 'f1-score': 0.19909100746672437, 'support': 518873}, '2': {'precision': 0.41588497784094747, 'recall': 0.7166897075065554, 'f1-score': 0.5263414183299467, 'support': 532388}, 'accuracy': 0.43667782025249685, 'macro avg': {'precision': 0.4585586601477762, 'recall': 0.4341926264537184, 'f1-score': 0.3948886989631895, 'support': 1573485}, 'weighted avg': {'precision': 0.45818818736564243, 'recall': 0.43667782025249685, 'f1-score': 0.3961548079530105, 'support': 1573485}}
[[241156  33563 247505]
 [166084  64393 288396]
 [120790  30041 381557]]
Evaluating performance on  val set...
2174/2174 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2081044
{'0': {'precision': 0.451462119094213, 'recall': 0.4447284063494861, 'f1-score': 0.4480699651506071, 'support': 181558}, '1': {'precision': 0.5565194027559206, 'recall': 0.1538706442318407, 'f1-score': 0.24108445604685674, 'support': 188457}, '2': {'precision': 0.41528131028296905, 'recall': 0.7249435623548842, 'f1-score': 0.5280634016682388, 'support': 186489}, 'accuracy': 0.44013340425226055, 'macro avg': {'precision': 0.4744209440443676, 'recall': 0.441180870978737, 'f1-score': 0.40573927428856754, 'support': 556504}, 'weighted avg': {'precision': 0.4749147046149539, 'recall': 0.44013340425226055, 'f1-score': 0.4047819167153239, 'support': 556504}}
[[ 80744  12249  88565]
 [ 57670  28998 101789]
 [ 40436  10859 135194]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        84 (peak)  21.95 (ave)

============================================
