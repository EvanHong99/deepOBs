This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W6/deepLOB_L1/h50
Epoch 1/50
9426/9426 - 165s - loss: 3.0647 - accuracy50: 0.4648 - val_loss: 3.4205 - val_accuracy50: 0.3581 - 165s/epoch - 17ms/step
Epoch 2/50
9426/9426 - 149s - loss: 3.0195 - accuracy50: 0.4802 - val_loss: 3.5068 - val_accuracy50: 0.4020 - 149s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 148s - loss: 2.9931 - accuracy50: 0.4885 - val_loss: 3.5524 - val_accuracy50: 0.3983 - 148s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 147s - loss: 2.9767 - accuracy50: 0.4930 - val_loss: 3.8490 - val_accuracy50: 0.4046 - 147s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 152s - loss: 2.9643 - accuracy50: 0.4961 - val_loss: 3.8420 - val_accuracy50: 0.4100 - 152s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 152s - loss: 2.9569 - accuracy50: 0.4980 - val_loss: 3.7408 - val_accuracy50: 0.4092 - 152s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 151s - loss: 2.9513 - accuracy50: 0.4997 - val_loss: 3.7584 - val_accuracy50: 0.4119 - 151s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 148s - loss: 2.9465 - accuracy50: 0.5009 - val_loss: 3.6752 - val_accuracy50: 0.4108 - 148s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 150s - loss: 2.9430 - accuracy50: 0.5018 - val_loss: 3.6556 - val_accuracy50: 0.4009 - 150s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 149s - loss: 2.9401 - accuracy50: 0.5025 - val_loss: 3.6794 - val_accuracy50: 0.4040 - 149s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 148s - loss: 2.9373 - accuracy50: 0.5032 - val_loss: 3.7113 - val_accuracy50: 0.4122 - 148s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 248s - 248s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.122893
{'0': {'precision': 0.3270316911909007, 'recall': 0.5771334918542105, 'f1-score': 0.4174921694028017, 'support': 3245419}, '1': {'precision': 0.41987557919176083, 'recall': 0.448192245137785, 'f1-score': 0.43357206255589126, 'support': 4343288}, '2': {'precision': 0.4456553509541108, 'recall': 0.06278386908414507, 'f1-score': 0.11006219075250077, 'support': 3229922}, 'accuracy': 0.37180820231472955, 'macro avg': {'precision': 0.39752087377892414, 'recall': 0.3627032020253802, 'f1-score': 0.3203754742370646, 'support': 10818629}, 'weighted avg': {'precision': 0.3997204683933713, 'recall': 0.37180820231472955, 'f1-score': 0.33216386721875957, 'support': 10818629}}
[[1873040 1301215   71164]
 [2215580 1946628  181080]
 [1638776 1388359  202787]]
Evaluating performance on  train set...
9426/9426 - 61s - 61s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1300168
{'0': {'precision': 0.3511416825376546, 'recall': 0.423598376201, 'f1-score': 0.3839818139302216, 'support': 765612}, '1': {'precision': 0.362893538932708, 'recall': 0.5294494078913152, 'f1-score': 0.4306276415347662, 'support': 884466}, '2': {'precision': 0.4566851664984864, 'recall': 0.11876722987557094, 'f1-score': 0.18850988367431307, 'support': 762121}, 'accuracy': 0.3661003922147385, 'macro avg': {'precision': 0.39024012932294966, 'recall': 0.3572716713226287, 'f1-score': 0.33437311304643363, 'support': 2412199}, 'weighted avg': {'precision': 0.3887965455725951, 'recall': 0.3661003922147385, 'f1-score': 0.33932686862907435, 'support': 2412199}}
[[324312 405757  35543]
 [344044 468280  72142]
 [255237 416369  90515]]
Evaluating performance on  val set...
3323/3323 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1290897
{'0': {'precision': 0.32585860934951716, 'recall': 0.4171227491660751, 'f1-score': 0.3658854624370827, 'support': 262014}, '1': {'precision': 0.36988743620219533, 'recall': 0.5129031671685743, 'f1-score': 0.4298107315587037, 'support': 330074}, '2': {'precision': 0.44436092854146275, 'recall': 0.09844972948689648, 'f1-score': 0.1611877459015094, 'support': 258213}, 'accuracy': 0.35753103900853933, 'macro avg': {'precision': 0.38003565803105843, 'recall': 0.3428252152738486, 'f1-score': 0.3189613132990986, 'support': 850301}, 'weighted avg': {'precision': 0.37893582593526826, 'recall': 0.35753103900853933, 'f1-score': 0.32853922598699026, 'support': 850301}}
[[109292 144295   8427]
 [137418 169296  23360]
 [ 88687 144105  25421]]
testing model out of sample: results/universal/W6/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 112s - 112s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1126877
{'0': {'precision': 0.34662342268007335, 'recall': 0.6649940673986529, 'f1-score': 0.4557108234372781, 'support': 1394835}, '1': {'precision': 0.4135582971927573, 'recall': 0.34923659272436075, 'f1-score': 0.3786855221858663, 'support': 1692085}, '2': {'precision': 0.442047794494718, 'recall': 0.12021687527669049, 'f1-score': 0.18902700964196315, 'support': 1398223}, 'accuracy': 0.3760381776010263, 'macro avg': {'precision': 0.40074317145584953, 'recall': 0.37814917846656804, 'f1-score': 0.3411411184217025, 'support': 4485143}, 'weighted avg': {'precision': 0.4016236865672187, 'recall': 0.3760381776010263, 'f1-score': 0.343514445519267, 'support': 4485143}}
[[927557 402705  64573]
 [953557 590938 147590]
 [794865 435268 168090]]
Evaluating performance on  train set...
5153/5153 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996971
{'0': {'precision': 0.3675147045391303, 'recall': 0.42826590625556943, 'f1-score': 0.39557138202831615, 'support': 403992}, '1': {'precision': 0.41391236083357125, 'recall': 0.565805108473604, 'f1-score': 0.4780842141880323, 'support': 512521}, '2': {'precision': 0.43727333233724075, 'recall': 0.16012106380968014, 'f1-score': 0.23440685617754994, 'support': 402102}, 'accuracy': 0.3999560144545603, 'macro avg': {'precision': 0.40623346590331416, 'recall': 0.3847306928462845, 'f1-score': 0.36935415079796613, 'support': 1318615}, 'weighted avg': {'precision': 0.4068209895097692, 'recall': 0.3999560144545603, 'f1-score': 0.3784966339613558, 'support': 1318615}}
[[173016 202060  28916]
 [168593 289987  53941]
 [129164 208553  64385]]
Evaluating performance on  val set...
1795/1795 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0989401
{'0': {'precision': 0.36169490516034897, 'recall': 0.43995479767613693, 'f1-score': 0.39700484702298655, 'support': 138046}, '1': {'precision': 0.4216955210719825, 'recall': 0.5809570810330054, 'f1-score': 0.4886777304369246, 'support': 184394}, '2': {'precision': 0.43951492840321577, 'recall': 0.11899422507548442, 'f1-score': 0.18728337033939846, 'support': 136452}, 'accuracy': 0.40117500414040774, 'macro avg': {'precision': 0.4076351182118491, 'recall': 0.37996870126154225, 'f1-score': 0.35765531593310323, 'support': 458892}, 'weighted avg': {'precision': 0.40894447887692154, 'recall': 0.40117500414040774, 'f1-score': 0.3714803548283105, 'support': 458892}}
[[ 60734  71098   6214]
 [ 62777 107125  14492]
 [ 44404  75811  16237]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.180425
{'0': {'precision': 0.34449025487256374, 'recall': 0.7047463605393741, 'f1-score': 0.4627712182297492, 'support': 91291}, '1': {'precision': 0.3123236904696056, 'recall': 0.2773568455048936, 'f1-score': 0.29380353693357353, 'support': 81433}, '2': {'precision': 0.43232424318238677, 'recall': 0.052713462066440925, 'f1-score': 0.0939692207297841, 'support': 98343}, 'accuracy': 0.339794220617043, 'macro avg': {'precision': 0.3630460628415187, 'recall': 0.34493888937023626, 'f1-score': 0.2835146586310356, 'support': 271067}, 'weighted avg': {'precision': 0.3666930242001722, 'recall': 0.339794220617043, 'f1-score': 0.27820932013396277, 'support': 271067}}
[[64337 23271  3683]
 [55723 22586  3124]
 [66700 26459  5184]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1684453
{'0': {'precision': 0.3910764430577223, 'recall': 0.33908667893085165, 'f1-score': 0.36323064885385575, 'support': 18482}, '1': {'precision': 0.34058801069110345, 'recall': 0.6467733839031736, 'f1-score': 0.4462059412036324, 'support': 17929}, '2': {'precision': 0.40493954206328786, 'recall': 0.08969683154775474, 'f1-score': 0.1468626078843014, 'support': 17548}, 'accuracy': 0.36021794325321077, 'macro avg': {'precision': 0.3788679986040379, 'recall': 0.35851896479392664, 'f1-score': 0.31876639931392986, 'support': 53959}, 'weighted avg': {'precision': 0.378809028121355, 'recall': 0.36021794325321077, 'f1-score': 0.3204358904929781, 'support': 53959}}
[[ 6267 11225   990]
 [ 5010 11596  1323]
 [ 4748 11226  1574]]
Evaluating performance on  val set...
81/81 - 1s - 647ms/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1494927
{'0': {'precision': 0.3943403908794788, 'recall': 0.5365650969529085, 'f1-score': 0.4545881248533208, 'support': 7220}, '1': {'precision': 0.3359060767474725, 'recall': 0.4788470478847048, 'f1-score': 0.39483772041911575, 'support': 6453}, '2': {'precision': 0.459727385377943, 'recall': 0.10654796094198736, 'f1-score': 0.17300069946374447, 'support': 6964}, 'accuracy': 0.3734069874497262, 'macro avg': {'precision': 0.3966579510016315, 'recall': 0.37398670192653355, 'f1-score': 0.3408088482453937, 'support': 20637}, 'weighted avg': {'precision': 0.3981335003718211, 'recall': 0.3734069874497262, 'f1-score': 0.34088244136119816, 'support': 20637}}
[[3874 3006  340]
 [2831 3090  532]
 [3119 3103  742]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0226058
{'0': {'precision': 0.29938512264129924, 'recall': 0.5967097375782603, 'f1-score': 0.39872122003323046, 'support': 135126}, '1': {'precision': 0.5477922316568025, 'recall': 0.4989539092411658, 'f1-score': 0.522233738932401, 'support': 286782}, '2': {'precision': 0.5001222109710535, 'recall': 0.10434408852819688, 'f1-score': 0.17266403867250132, 'support': 137267}, 'accuracy': 0.4257075155362811, 'macro avg': {'precision': 0.44909985508971834, 'recall': 0.40000257844920767, 'f1-score': 0.3645396658793776, 'support': 559175}, 'weighted avg': {'precision': 0.4760619508997951, 'recall': 0.4257075155362811, 'f1-score': 0.4065738173079632, 'support': 559175}}
[[ 80631  52546   1949]
 [131324 143091  12367]
 [ 57367  65577  14323]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9275457
{'0': {'precision': 0.34749307724032286, 'recall': 0.425280311497278, 'f1-score': 0.38247166966587226, 'support': 27737}, '1': {'precision': 0.6403568345323741, 'recall': 0.6862263778556273, 'f1-score': 0.6624985858297161, 'support': 81068}, '2': {'precision': 0.42321879246748206, 'recall': 0.23808657031562852, 'f1-score': 0.3047388285727599, 'support': 27469}, 'accuracy': 0.5427814550097597, 'macro avg': {'precision': 0.47035623474672633, 'recall': 0.44986441988951126, 'f1-score': 0.44990302802278276, 'support': 136274}, 'weighted avg': {'precision': 0.5369788833935645, 'recall': 0.5427814550097597, 'f1-score': 0.5333880486345954, 'support': 136274}}
[[11796 14830  1111]
 [17635 55631  7802]
 [ 4515 16414  6540]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9665994
{'0': {'precision': 0.29492455418381347, 'recall': 0.4367255738370912, 'f1-score': 0.3520838450831082, 'support': 9846}, '1': {'precision': 0.6535225868187073, 'recall': 0.562742472619906, 'f1-score': 0.6047446871310508, 'support': 29127}, '2': {'precision': 0.3431682472778363, 'recall': 0.31758587062520316, 'f1-score': 0.3298818232976928, 'support': 9229}, 'accuracy': 0.4900626530019501, 'macro avg': {'precision': 0.43053846276011903, 'recall': 0.4390179723607335, 'f1-score': 0.4289034518372839, 'support': 48202}, 'weighted avg': {'precision': 0.5208514024498873, 'recall': 0.4900626530019501, 'f1-score': 0.5005081819835029, 'support': 48202}}
[[ 4300  4535  1011]
 [ 8137 16391  4599]
 [ 2143  4155  2931]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1785376
{'0': {'precision': 0.4199179346896905, 'recall': 0.4295683503567931, 'f1-score': 0.4246883267338717, 'support': 114352}, '1': {'precision': 0.27823353965555947, 'recall': 0.517229866692104, 'f1-score': 0.3618285781016053, 'support': 83866}, '2': {'precision': 0.47704432455305196, 'recall': 0.16036771308422015, 'f1-score': 0.24004098715159258, 'support': 112479}, 'accuracy': 0.3557742752585316, 'macro avg': {'precision': 0.39173193296610065, 'recall': 0.3690553100443725, 'f1-score': 0.34218596399568985, 'support': 310697}, 'weighted avg': {'precision': 0.4023542495929841, 'recall': 0.3557742752585316, 'f1-score': 0.34087437362950046, 'support': 310697}}
[[49122 55636  9594]
 [30308 43378 10180]
 [37550 56891 18038]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1622562
{'0': {'precision': 0.40413585662363705, 'recall': 0.36072579201718274, 'f1-score': 0.3811989455142982, 'support': 44696}, '1': {'precision': 0.3406521892905143, 'recall': 0.5647574819401445, 'f1-score': 0.42496977612269576, 'support': 42636}, '2': {'precision': 0.44151128557409225, 'recall': 0.2062436967085358, 'f1-score': 0.28115235595550553, 'support': 43628}, 'accuracy': 0.37568723274282223, 'macro avg': {'precision': 0.39543311049608115, 'recall': 0.3772423235552877, 'f1-score': 0.36244035919749984, 'support': 130960}, 'weighted avg': {'precision': 0.3959190390750378, 'recall': 0.37568723274282223, 'f1-score': 0.36211968867670374, 'support': 130960}}
[[16123 23616  4957]
 [12132 24079  6425]
 [11640 22990  8998]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1696953
{'0': {'precision': 0.39802199322221454, 'recall': 0.39774690718086947, 'f1-score': 0.39788440265486724, 'support': 14469}, '1': {'precision': 0.345080831408776, 'recall': 0.54082814535978, 'f1-score': 0.42132867132867136, 'support': 13814}, '2': {'precision': 0.4462915601023018, 'recall': 0.21131593110871905, 'f1-score': 0.28682312117614833, 'support': 14864}, 'accuracy': 0.3793311238324797, 'macro avg': {'precision': 0.3964647949110975, 'recall': 0.3832969945497895, 'f1-score': 0.3686787317198956, 'support': 43147}, 'weighted avg': {'precision': 0.3977009890461369, 'recall': 0.3793311238324797, 'f1-score': 0.3671301031568779, 'support': 43147}}
[[5755 6975 1739]
 [4185 7471 2158]
 [4519 7204 3141]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2084298
{'0': {'precision': 0.396440503624084, 'recall': 0.4963610043428343, 'f1-score': 0.4408093059545342, 'support': 100165}, '1': {'precision': 0.286995043642265, 'recall': 0.429146717387027, 'f1-score': 0.3439625716238238, 'support': 76235}, '2': {'precision': 0.4437234225597916, 'recall': 0.17409754168716066, 'f1-score': 0.2500761920594021, 'support': 103689}, 'accuracy': 0.35876453555834037, 'macro avg': {'precision': 0.37571965660871354, 'recall': 0.36653508780567395, 'f1-score': 0.34494935654592007, 'support': 280089}, 'weighted avg': {'precision': 0.3841556368132154, 'recall': 0.35876453555834037, 'f1-score': 0.34383999749053146, 'support': 280089}}
[[49718 38627 11820]
 [32708 32716 10811]
 [42985 42652 18052]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.162326
{'0': {'precision': 0.3416368961410962, 'recall': 0.5558319151721429, 'f1-score': 0.4231739039437097, 'support': 38195}, '1': {'precision': 0.3263805286574195, 'recall': 0.3282705975256647, 'f1-score': 0.3273228346456693, 'support': 37990}, '2': {'precision': 0.41380523501266536, 'recall': 0.15323484197086948, 'f1-score': 0.2236504344849879, 'support': 38379}, 'accuracy': 0.34550120456687966, 'macro avg': {'precision': 0.3606075532703937, 'recall': 0.34577911822289237, 'f1-score': 0.3247157243581223, 'support': 114564}, 'weighted avg': {'precision': 0.3607542390834435, 'recall': 0.34550120456687966, 'f1-score': 0.32454873934585315, 'support': 114564}}
[[21230 13073  3892]
 [21080 12471  4439]
 [19832 12666  5881]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1651378
{'0': {'precision': 0.34933009663414405, 'recall': 0.6366343372468947, 'f1-score': 0.4511228334589299, 'support': 11754}, '1': {'precision': 0.3051051051051051, 'recall': 0.27873799725651577, 'f1-score': 0.29132616487455193, 'support': 10935}, '2': {'precision': 0.4164187983343248, 'recall': 0.11585567692816948, 'f1-score': 0.1812767059432863, 'support': 12084}, 'accuracy': 0.3431110344232594, 'macro avg': {'precision': 0.356951333357858, 'recall': 0.3437426704771933, 'f1-score': 0.30790856809225603, 'support': 34773}, 'weighted avg': {'precision': 0.3587368084213049, 'recall': 0.3431110344232594, 'f1-score': 0.3070973776205147, 'support': 34773}}
[[7483 3388  883]
 [6808 3048 1079]
 [7130 3554 1400]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1646318
{'0': {'precision': 0.36562095838169456, 'recall': 0.7142033529396523, 'f1-score': 0.4836485188255886, 'support': 154372}, '1': {'precision': 0.30982919131803116, 'recall': 0.27199271475647685, 'f1-score': 0.2896806805572679, 'support': 129577}, '2': {'precision': 0.44053969250078445, 'recall': 0.07160981829773669, 'f1-score': 0.12319436675331513, 'support': 156850}, 'accuracy': 0.35555661423914303, 'macro avg': {'precision': 0.3719966140668367, 'recall': 0.3526019619979553, 'f1-score': 0.2988411887120572, 'support': 440799}, 'weighted avg': {'precision': 0.37587886197442266, 'recall': 0.35555661423914303, 'f1-score': 0.29836905056039226, 'support': 440799}}
[[110253  38110   6009]
 [ 86078  35244   8255]
 [105219  40399  11232]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1858084
{'0': {'precision': 0.3503746848030685, 'recall': 0.3760004573519323, 'f1-score': 0.36273554554646564, 'support': 52476}, '1': {'precision': 0.3344679235733266, 'recall': 0.5020322115019372, 'f1-score': 0.4014671709117419, 'support': 52652}, '2': {'precision': 0.4189482064664514, 'recall': 0.17930903928064362, 'f1-score': 0.25113344115385633, 'support': 52825}, 'accuracy': 0.35223135996150756, 'macro avg': {'precision': 0.3679302716142822, 'recall': 0.3524472360448377, 'f1-score': 0.33844538587068795, 'support': 157953}, 'weighted avg': {'precision': 0.3680057110551804, 'recall': 0.35223135996150756, 'f1-score': 0.3383226909263758, 'support': 157953}}
[[19731 26292  6453]
 [19535 26433  6684]
 [17048 26305  9472]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1948556
{'0': {'precision': 0.3388583859939915, 'recall': 0.3452607135317712, 'f1-score': 0.3420295916766874, 'support': 18948}, '1': {'precision': 0.3195873196772936, 'recall': 0.5504132231404959, 'f1-score': 0.40437925734777913, 'support': 19360}, '2': {'precision': 0.41588492808005, 'recall': 0.10424286759326994, 'f1-score': 0.16670148318362232, 'support': 19138}, 'accuracy': 0.3341050725899105, 'macro avg': {'precision': 0.35811021125044507, 'recall': 0.3333056014218457, 'f1-score': 0.3043701107360296, 'support': 57446}, 'weighted avg': {'precision': 0.3580250141065096, 'recall': 0.3341050725899105, 'f1-score': 0.30463203896722213, 'support': 57446}}
[[ 6542 11237  1169]
 [ 7071 10656  1633]
 [ 5693 11450  1995]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.021381
{'0': {'precision': 0.40968389638033376, 'recall': 0.6569738628599245, 'f1-score': 0.5046634867179888, 'support': 341009}, '1': {'precision': 0.4997220930093868, 'recall': 0.4553974178653803, 'f1-score': 0.47653125753515646, 'support': 460007}, '2': {'precision': 0.4958224995666493, 'recall': 0.2538028127356886, 'f1-score': 0.33574411894165396, 'support': 338105}, 'accuracy': 0.45590591341920655, 'macro avg': {'precision': 0.46840949631879, 'recall': 0.4553913644869978, 'f1-score': 0.43897962106493305, 'support': 1139121}, 'weighted avg': {'precision': 0.47161067426174413, 'recall': 0.45590591341920655, 'f1-score': 0.44316562547960864, 'support': 1139121}}
[[224034  96616  20359]
 [183622 209486  66899]
 [139190 113103  85812]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0075873
{'0': {'precision': 0.3605038752949224, 'recall': 0.6072809655872817, 'f1-score': 0.4524293670223021, 'support': 102404}, '1': {'precision': 0.5219306447256332, 'recall': 0.4186062013264751, 'f1-score': 0.4645929725380919, 'support': 180026}, '2': {'precision': 0.49519351087164537, 'recall': 0.32853138520739533, 'f1-score': 0.39500228983430996, 'support': 102389}, 'accuracy': 0.4448480974172273, 'macro avg': {'precision': 0.4592093436307337, 'recall': 0.45147285070705073, 'f1-score': 0.437341543131568, 'support': 384819}, 'weighted avg': {'precision': 0.4718594806330118, 'recall': 0.4448480974172273, 'f1-score': 0.44284009061023366, 'support': 384819}}
[[62188 33285  6931]
 [77306 75360 27360]
 [33009 35742 33638]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0277473
{'0': {'precision': 0.33809256193325943, 'recall': 0.654926883808515, 'f1-score': 0.44596489822086877, 'support': 33987}, '1': {'precision': 0.5121313672922252, 'recall': 0.37344215825228483, 'f1-score': 0.4319267403408609, 'support': 61383}, '2': {'precision': 0.48157075424324597, 'recall': 0.27290060043823455, 'f1-score': 0.34837889383343934, 'support': 35141}, 'accuracy': 0.4196734374880278, 'macro avg': {'precision': 0.44393156115624355, 'recall': 0.4337565474996781, 'f1-score': 0.40875684413172303, 'support': 130511}, 'weighted avg': {'precision': 0.45858042230759294, 'recall': 0.4196734374880278, 'f1-score': 0.4130866425540884, 'support': 130511}}
[[22259 10198  1530]
 [29666 22923  8794]
 [13912 11639  9590]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
6203/6203 - 39s - 39s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0651324
{'0': {'precision': 0.2774983074331239, 'recall': 0.7395859833354752, 'f1-score': 0.4035729593695014, 'support': 381289}, '1': {'precision': 0.5837129957827148, 'recall': 0.312321625562748, 'f1-score': 0.40691774036858674, 'support': 816751}, '2': {'precision': 0.37169061676135307, 'recall': 0.128387980525044, 'f1-score': 0.19085242969823962, 'support': 389834}, 'accuracy': 0.3697617065333899, 'macro avg': {'precision': 0.41096730665906395, 'recall': 0.39343186314108913, 'f1-score': 0.3337810431454426, 'support': 1587874}, 'weighted avg': {'precision': 0.45813009411070515, 'recall': 0.3697617065333899, 'f1-score': 0.3530690517936593, 'support': 1587874}}
[[281996  88519  10774]
 [487831 255089  73831]
 [246381  93403  50050]]
Evaluating performance on  train set...
1766/1766 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.013678
{'0': {'precision': 0.3277772091302054, 'recall': 0.36713024613512296, 'f1-score': 0.34633943427620634, 'support': 113393}, '1': {'precision': 0.5142346669790874, 'recall': 0.6228840806588231, 'f1-score': 0.5633687571320561, 'support': 225493}, '2': {'precision': 0.4164480790001543, 'recall': 0.19090225896291058, 'f1-score': 0.2617957842536965, 'support': 113105}, 'accuracy': 0.450624016849893, 'macro avg': {'precision': 0.419486651703149, 'recall': 0.3936388619189522, 'f1-score': 0.390501325220653, 'support': 451991}, 'weighted avg': {'precision': 0.4429874019866086, 'recall': 0.450624016849893, 'f1-score': 0.4334568405142468, 'support': 451991}}
[[ 41630  64950   6813]
 [ 61594 140456  23443]
 [ 23783  67730  21592]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0119674
{'0': {'precision': 0.29388104545601396, 'recall': 0.5348208248816768, 'f1-score': 0.379325083660853, 'support': 34017}, '1': {'precision': 0.5813836375267105, 'recall': 0.5260915080977893, 'f1-score': 0.5523573072645925, 'support': 81195}, '2': {'precision': 0.3731190419916489, 'recall': 0.14412659768715763, 'f1-score': 0.20793361578820274, 'support': 32860}, 'accuracy': 0.4433316224539413, 'macro avg': {'precision': 0.41612790832479113, 'recall': 0.40167964355554125, 'f1-score': 0.37987200223788276, 'support': 148072}, 'weighted avg': {'precision': 0.4691169680432767, 'recall': 0.4433316224539413, 'f1-score': 0.4361719403333525, 'support': 148072}}
[[18193 14767  1057]
 [31579 42716  6900]
 [12134 15990  4736]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1466564
{'0': {'precision': 0.3709682449099238, 'recall': 0.5212538011900901, 'f1-score': 0.4334540008854217, 'support': 456436}, '1': {'precision': 0.328723975009086, 'recall': 0.5117933367463667, 'f1-score': 0.40032189149574166, 'support': 408239}, '2': {'precision': 0.5280043283970903, 'recall': 0.05701210606601539, 'f1-score': 0.102912113234961, 'support': 462165}, 'accuracy': 0.356638328660577, 'macro avg': {'precision': 0.4092321827720334, 'recall': 0.3633530813341574, 'f1-score': 0.31222933520537477, 'support': 1326840}, 'weighted avg': {'precision': 0.4126694470328611, 'recall': 0.356638328660577, 'f1-score': 0.3081256186305087, 'support': 1326840}}
[[237919 210613   7904]
 [183655 208934  15650]
 [219772 216044  26349]]
Evaluating performance on  train set...
1489/1489 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1129031
{'0': {'precision': 0.42551559497030966, 'recall': 0.3843931985923827, 'f1-score': 0.4039104202883731, 'support': 128444}, '1': {'precision': 0.36545207380719247, 'recall': 0.6133950297179784, 'f1-score': 0.45802145169793673, 'support': 125345}, '2': {'precision': 0.4828545288197621, 'recall': 0.207325696506859, 'f1-score': 0.2900927839584891, 'support': 127278}, 'accuracy': 0.40057785113903854, 'macro avg': {'precision': 0.42460739919908813, 'recall': 0.4017046416057401, 'f1-score': 0.3840082186482663, 'support': 381067}, 'weighted avg': {'precision': 0.42491024935470845, 'recall': 0.40057785113903854, 'f1-score': 0.38369367655364084, 'support': 381067}}
[[49373 66695 12376]
 [32573 76886 15886]
 [34085 66805 26388]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1066976
{'0': {'precision': 0.3741739017753013, 'recall': 0.40855067679102014, 'f1-score': 0.39060738603057216, 'support': 42406}, '1': {'precision': 0.38728850497285733, 'recall': 0.6069425182670614, 'f1-score': 0.47285159084678524, 'support': 48311}, '2': {'precision': 0.49958096657044415, 'recall': 0.12763173545854645, 'f1-score': 0.2033198165763444, 'support': 42035}, 'accuracy': 0.39179824032782934, 'macro avg': {'precision': 0.42034779110620085, 'recall': 0.38104164350554265, 'f1-score': 0.35559293115123397, 'support': 132752}, 'weighted avg': {'precision': 0.41865583473104556, 'recall': 0.39179824032782934, 'f1-score': 0.36123432044110915, 'support': 132752}}
[[17325 23204  1877]
 [15492 29322  3497]
 [13485 23185  5365]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 51s - 51s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.120064
{'0': {'precision': 0.3999372281585757, 'recall': 0.6453848401988582, 'f1-score': 0.4938447812362423, 'support': 653531}, '1': {'precision': 0.3604174397174368, 'recall': 0.40327637830816354, 'f1-score': 0.3806442748066777, 'support': 580458}, '2': {'precision': 0.4897485493230174, 'recall': 0.1304101498789637, 'f1-score': 0.2059736702957007, 'support': 640717}, 'accuracy': 0.39441917826048456, 'macro avg': {'precision': 0.41670107239967663, 'recall': 0.39302378946199523, 'f1-score': 0.36015424211287356, 'support': 1874706}, 'weighted avg': {'precision': 0.4183956226500592, 'recall': 0.39441917826048456, 'f1-score': 0.3604094296933427, 'support': 1874706}}
[[421779 197090  34662]
 [293981 234085  52392]
 [338853 218308  83556]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1253474
{'0': {'precision': 0.38416573280431293, 'recall': 0.5075195061304981, 'f1-score': 0.43731037471925605, 'support': 174945}, '1': {'precision': 0.3574293568885484, 'recall': 0.5019302575786343, 'f1-score': 0.41753092919189266, 'support': 173811}, '2': {'precision': 0.46912715739176997, 'recall': 0.1301629751537178, 'f1-score': 0.20378438828002685, 'support': 174996}, 'accuracy': 0.37958232140402326, 'macro avg': {'precision': 0.40357408236154374, 'recall': 0.37987091295428344, 'f1-score': 0.3528752307303918, 'support': 523752}, 'weighted avg': {'precision': 0.40368037565591386, 'recall': 0.37958232140402326, 'f1-score': 0.35272072402679866, 'support': 523752}}
[[88788 76536  9621]
 [70415 87241 16155]
 [71916 80302 22778]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.116203
{'0': {'precision': 0.41916033586565377, 'recall': 0.4134275618374558, 'f1-score': 0.41627421237799506, 'support': 63392}, '1': {'precision': 0.3713653276372907, 'recall': 0.6782388472912603, 'f1-score': 0.47994167278879757, 'support': 63572}, '2': {'precision': 0.5231274518748289, 'recall': 0.09155941621690672, 'f1-score': 0.15584274396292822, 'support': 62626}, 'accuracy': 0.3959016825781951, 'macro avg': {'precision': 0.43788437179259115, 'recall': 0.3944086084485409, 'f1-score': 0.350686209709907, 'support': 189590}, 'weighted avg': {'precision': 0.43747681006839173, 'recall': 0.3959016825781951, 'f1-score': 0.3515961526294512, 'support': 189590}}
[[26208 35282  1902]
 [17130 43117  3325]
 [19187 37705  5734]]
testing model on single stock: results/universal/W6/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 148s - 148s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1383227
{'0': {'precision': 0.30905401881526867, 'recall': 0.5790128997240003, 'f1-score': 0.40300175554320405, 'support': 2212683}, '1': {'precision': 0.421866557690028, 'recall': 0.4345488869787357, 'f1-score': 0.42811381844860513, 'support': 3112025}, '2': {'precision': 0.35923651615843705, 'recall': 0.026648744275130032, 'f1-score': 0.0496168319185796, 'support': 2188696}, 'accuracy': 0.3582697003914604, 'macro avg': {'precision': 0.3633856975545779, 'recall': 0.34673684365928864, 'f1-score': 0.2935774686367963, 'support': 7513404}, 'weighted avg': {'precision': 0.3703990060536398, 'recall': 0.3582697003914604, 'f1-score': 0.31046010581501954, 'support': 7513404}}
[[1281172  902499   29012]
 [1684675 1352327   75023]
 [1179616  950754   58326]]
Evaluating performance on  train set...
5452/5452 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1855935
{'0': {'precision': 0.33297691165869503, 'recall': 0.38325455600300323, 'f1-score': 0.3563510518565528, 'support': 468832}, '1': {'precision': 0.3056475287044733, 'recall': 0.5379741194729989, 'f1-score': 0.38982039040633065, 'support': 460037}, '2': {'precision': 0.3939308550991655, 'recall': 0.03894934912967257, 'f1-score': 0.07088959143115141, 'support': 466606}, 'accuracy': 0.319134344936312, 'macro avg': {'precision': 0.3441850984874446, 'recall': 0.3200593415352249, 'f1-score': 0.2723536778980116, 'support': 1395475}, 'weighted avg': {'precision': 0.3443486298097711, 'recall': 0.319134344936312, 'f1-score': 0.27193470895909444, 'support': 1395475}}
[[179682 277993  11157]
 [195745 247488  16804]
 [164196 284236  18174]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1747594
{'0': {'precision': 0.31041314017503857, 'recall': 0.3544180318373867, 'f1-score': 0.33095925350276406, 'support': 164021}, '1': {'precision': 0.3239376517522213, 'recall': 0.5430794485298195, 'f1-score': 0.40581409804815377, 'support': 180318}, '2': {'precision': 0.41261733848702375, 'recall': 0.03742706168140041, 'f1-score': 0.06862902670309737, 'support': 159724}, 'accuracy': 0.3214618014018089, 'macro avg': {'precision': 0.34898937680476116, 'recall': 0.3116415140162022, 'f1-score': 0.26846745941800504, 'support': 504063}, 'weighted avg': {'precision': 0.34763701149619874, 'recall': 0.3214618014018089, 'f1-score': 0.2746116198009958, 'support': 504063}}
[[ 58132 102689   3200]
 [ 77081  97927   5310]
 [ 52060 101686   5978]]
training model: results/universal/W6/deepLOB_L1/h100
Epoch 1/50
9426/9426 - 161s - loss: 3.1886 - accuracy100: 0.4217 - val_loss: 3.4578 - val_accuracy100: 0.3633 - 161s/epoch - 17ms/step
Epoch 2/50
9426/9426 - 149s - loss: 3.1617 - accuracy100: 0.4340 - val_loss: 3.4510 - val_accuracy100: 0.3593 - 149s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 150s - loss: 3.1479 - accuracy100: 0.4399 - val_loss: 3.4110 - val_accuracy100: 0.3619 - 150s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 150s - loss: 3.1417 - accuracy100: 0.4428 - val_loss: 3.4643 - val_accuracy100: 0.3525 - 150s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 149s - loss: 3.1356 - accuracy100: 0.4451 - val_loss: 3.4811 - val_accuracy100: 0.3655 - 149s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 148s - loss: 3.1302 - accuracy100: 0.4468 - val_loss: 3.4689 - val_accuracy100: 0.3601 - 148s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 148s - loss: 3.1247 - accuracy100: 0.4486 - val_loss: 3.4386 - val_accuracy100: 0.3604 - 148s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 147s - loss: 3.1211 - accuracy100: 0.4498 - val_loss: 3.4381 - val_accuracy100: 0.3579 - 147s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 149s - loss: 3.1173 - accuracy100: 0.4508 - val_loss: 3.5046 - val_accuracy100: 0.3511 - 149s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 148s - loss: 3.1143 - accuracy100: 0.4520 - val_loss: 3.6179 - val_accuracy100: 0.3457 - 148s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 149s - loss: 3.1114 - accuracy100: 0.4528 - val_loss: 3.5165 - val_accuracy100: 0.3556 - 149s/epoch - 16ms/step
Epoch 12/50
9426/9426 - 149s - loss: 3.1085 - accuracy100: 0.4538 - val_loss: 3.5071 - val_accuracy100: 0.3514 - 149s/epoch - 16ms/step
Epoch 13/50
9426/9426 - 152s - loss: 3.1060 - accuracy100: 0.4544 - val_loss: 3.5695 - val_accuracy100: 0.3489 - 152s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 281s - 281s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1285601
{'0': {'precision': 0.31861550728819665, 'recall': 0.11162044937811681, 'f1-score': 0.16532326297370925, 'support': 3343554}, '1': {'precision': 0.3833243642078939, 'recall': 0.8541850266164247, 'f1-score': 0.5291756728012209, 'support': 4126963}, '2': {'precision': 0.3374190543777167, 'recall': 0.045443222926831596, 'f1-score': 0.08009882517441284, 'support': 3348112}, 'accuracy': 0.37440492690894567, 'macro avg': {'precision': 0.34645297529126906, 'recall': 0.33708289964045773, 'f1-score': 0.25819925364978097, 'support': 10818629}, 'weighted avg': {'precision': 0.3491191357916671, 'recall': 0.37440492690894567, 'f1-score': 0.2777464239795908, 'support': 10818629}}
[[ 373209 2828907  141438]
 [ 444440 3525190  157333]
 [ 353697 2842266  152149]]
Evaluating performance on  train set...
9426/9426 - 55s - 55s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1465192
{'0': {'precision': 0.34844653414241655, 'recall': 0.09999016702368253, 'f1-score': 0.1553897219256302, 'support': 803419}, '1': {'precision': 0.34095625719878725, 'recall': 0.8145521223181817, 'f1-score': 0.48070035292177216, 'support': 810411}, '2': {'precision': 0.39092278872780584, 'recall': 0.12023888703093431, 'f1-score': 0.1839109747885153, 'support': 798369}, 'accuracy': 0.3467587044020829, 'macro avg': {'precision': 0.3601085266896698, 'recall': 0.34492705879093283, 'f1-score': 0.27333368321197254, 'support': 2412199}, 'weighted avg': {'precision': 0.35998850147965494, 'recall': 0.3467587044020829, 'f1-score': 0.27412196495495866, 'support': 2412199}}
[[ 80334 645048  78037]
 [ 78761 660122  71528]
 [ 71454 630920  95995]]
Evaluating performance on  val set...
3323/3323 - 28s - 28s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1362393
{'0': {'precision': 0.3223737069398413, 'recall': 0.09509613675416247, 'f1-score': 0.14686806524673424, 'support': 270032}, '1': {'precision': 0.36744547864951466, 'recall': 0.8247090048605782, 'f1-score': 0.5083830983805456, 'support': 312720}, '2': {'precision': 0.3486999011110465, 'recall': 0.08962096662667399, 'f1-score': 0.14259335797307862, 'support': 267549}, 'accuracy': 0.36170720721250477, 'macro avg': {'precision': 0.3461730289001341, 'recall': 0.3364753694138049, 'f1-score': 0.26594817386678615, 'support': 850301}, 'weighted avg': {'precision': 0.3472335993466018, 'recall': 0.36170720721250477, 'f1-score': 0.27847944463502877, 'support': 850301}}
[[ 25679 224092  20261]
 [ 30292 257903  24525]
 [ 23685 219886  23978]]
testing model out of sample: results/universal/W6/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 105s - 105s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1424993
{'0': {'precision': 0.321721420663442, 'recall': 0.11371597895644385, 'f1-score': 0.16803731757509974, 'support': 1433598}, '1': {'precision': 0.3587913465327814, 'recall': 0.8436014133816698, 'f1-score': 0.5034576007688235, 'support': 1601549}, '2': {'precision': 0.34994126215873317, 'recall': 0.05135945202607455, 'f1-score': 0.08957268617024475, 'support': 1449996}, 'accuracy': 0.35418335602677553, 'macro avg': {'precision': 0.3434846764516522, 'recall': 0.33622561478806273, 'f1-score': 0.2536892015047227, 'support': 4485143}, 'weighted avg': {'precision': 0.3440814568974976, 'recall': 0.35418335602677553, 'f1-score': 0.2624420260649095, 'support': 4485143}}
[[ 163023 1200906   69669]
 [ 181810 1351069   68670]
 [ 161888 1213637   74471]]
Evaluating performance on  train set...
5153/5153 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.143675
{'0': {'precision': 0.34732149574900306, 'recall': 0.08459202045051607, 'f1-score': 0.13604865774902652, 'support': 436566}, '1': {'precision': 0.34559243796221883, 'recall': 0.7958934131576486, 'f1-score': 0.4819240549348514, 'support': 448986}, '2': {'precision': 0.38660533991474083, 'recall': 0.15915467264578134, 'f1-score': 0.22548389365707958, 'support': 433063}, 'accuracy': 0.3512769079678299, 'macro avg': {'precision': 0.3598397578753209, 'recall': 0.34654670208464866, 'f1-score': 0.2811522021136525, 'support': 1318615}, 'weighted avg': {'precision': 0.35963445796048243, 'recall': 0.3512769079678299, 'f1-score': 0.2831911539658328, 'support': 1318615}}
[[ 36930 344400  55236]
 [ 37521 357345  54120]
 [ 31877 332262  68924]]
Evaluating performance on  val set...
1795/1795 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1362492
{'0': {'precision': 0.3427153853287582, 'recall': 0.10036596709691, 'f1-score': 0.15526250833714086, 'support': 147281}, '1': {'precision': 0.36532471095855773, 'recall': 0.8196066361293671, 'f1-score': 0.5053838067151057, 'support': 165699}, '2': {'precision': 0.38174217294497204, 'recall': 0.11515159822358682, 'f1-score': 0.17693206827922453, 'support': 145912}, 'accuracy': 0.3647742824019595, 'macro avg': {'precision': 0.36326075641076266, 'recall': 0.345041400483288, 'f1-score': 0.2791927944438237, 'support': 458892}, 'weighted avg': {'precision': 0.3632884597824187, 'recall': 0.3647742824019595, 'f1-score': 0.2885762245278779, 'support': 458892}}
[[ 14782 119422  13077]
 [ 15756 135808  14135]
 [ 12594 116516  16802]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1605862
{'0': {'precision': 0.3120567375886525, 'recall': 0.1293208430913349, 'f1-score': 0.18286130589199528, 'support': 85400}, '1': {'precision': 0.33298898995590615, 'recall': 0.8240117746005047, 'f1-score': 0.474307117059157, 'support': 90364}, '2': {'precision': 0.3540872160504062, 'recall': 0.044814958605710206, 'f1-score': 0.07956037814930376, 'support': 95303}, 'accuracy': 0.33119487064083786, 'macro avg': {'precision': 0.333044314531655, 'recall': 0.3327158587658499, 'f1-score': 0.24557626703348534, 'support': 271067}, 'weighted avg': {'precision': 0.33381207018817594, 'recall': 0.33119487064083786, 'f1-score': 0.24369984752062462, 'support': 271067}}
[[11044 70518  3838]
 [11950 74461  3953]
 [12397 78635  4271]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1683309
{'0': {'precision': 0.3169415292353823, 'recall': 0.05671513655631271, 'f1-score': 0.09621336246131439, 'support': 18637}, '1': {'precision': 0.32172180500514524, 'recall': 0.8442401608733122, 'f1-score': 0.46589936269380766, 'support': 17405}, '2': {'precision': 0.3530599878812361, 'recall': 0.0975609756097561, 'f1-score': 0.1528773832429596, 'support': 17917}, 'accuracy': 0.3243017846883745, 'macro avg': {'precision': 0.33057444070725456, 'recall': 0.33283875767979365, 'f1-score': 0.23833003613269388, 'support': 53959}, 'weighted avg': {'precision': 0.3304765303163973, 'recall': 0.3243017846883745, 'f1-score': 0.23427437349545666, 'support': 53959}}
[[ 1057 15829  1751]
 [ 1259 14694  1452]
 [ 1019 15150  1748]]
Evaluating performance on  val set...
81/81 - 1s - 646ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1384274
{'0': {'precision': 0.33370165745856356, 'recall': 0.09183518321423141, 'f1-score': 0.14403243114343628, 'support': 6577}, '1': {'precision': 0.36010468159348646, 'recall': 0.8472906403940886, 'f1-score': 0.5054075011223116, 'support': 7308}, '2': {'precision': 0.4166666666666667, 'recall': 0.10071090047393365, 'f1-score': 0.16221374045801526, 'support': 6752}, 'accuracy': 0.36226195667975, 'macro avg': {'precision': 0.37015766857290555, 'recall': 0.34661224136075125, 'f1-score': 0.2705512242412544, 'support': 20637}, 'weighted avg': {'precision': 0.37019596586342524, 'recall': 0.36226195667975, 'f1-score': 0.2779515672532225, 'support': 20637}}
[[ 604 5477  496]
 [ 660 6192  456]
 [ 546 5526  680]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1229407
{'0': {'precision': 0.37844379370106973, 'recall': 0.21641927068500016, 'f1-score': 0.2753659950717495, 'support': 175562}, '1': {'precision': 0.375005739368394, 'recall': 0.8034509217541858, 'f1-score': 0.5113445693821842, 'support': 203308}, '2': {'precision': 0.4147656216309457, 'recall': 0.0533429466736918, 'f1-score': 0.09452858560940372, 'support': 180305}, 'accuracy': 0.37727187374256715, 'macro avg': {'precision': 0.3894050515668031, 'recall': 0.35773771303762597, 'f1-score': 0.2937463833544458, 'support': 559175}, 'weighted avg': {'precision': 0.3889056763578921, 'recall': 0.37727187374256715, 'f1-score': 0.3028537097814515, 'support': 559175}}
[[ 37995 131756   5811]
 [ 32200 163348   7760]
 [ 30203 140484   9618]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0578717
{'0': {'precision': 0.3817924425568986, 'recall': 0.09233119140419256, 'f1-score': 0.1487010921429329, 'support': 37972}, '1': {'precision': 0.4809557655322351, 'recall': 0.7491818492648855, 'f1-score': 0.5858260498691842, 'support': 61419}, '2': {'precision': 0.3834622362264872, 'recall': 0.32665455629965023, 'f1-score': 0.35278615560305704, 'support': 36883}, 'accuracy': 0.4517956470052982, 'macro avg': {'precision': 0.41540348143854033, 'recall': 0.3893891989895761, 'f1-score': 0.36243776587172477, 'support': 136274}, 'weighted avg': {'precision': 0.42693751156300125, 'recall': 0.4517956470052982, 'f1-score': 0.4009505834192467, 'support': 136274}}
[[ 3506 26609  7857]
 [ 3891 46014 11514]
 [ 1786 23049 12048]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.070454
{'0': {'precision': 0.37642163661581135, 'recall': 0.10170126658172825, 'f1-score': 0.16013688930847297, 'support': 13343}, '1': {'precision': 0.4917752417674679, 'recall': 0.7020152698863636, 'f1-score': 0.5783824309250827, 'support': 22528}, '2': {'precision': 0.32850940665701883, 'recall': 0.3313599870245722, 'f1-score': 0.3299285397068917, 'support': 12331}, 'accuracy': 0.44101904485291066, 'macro avg': {'precision': 0.3989020950134327, 'recall': 0.37835884116422136, 'f1-score': 0.3561492866468157, 'support': 48202}, 'weighted avg': {'precision': 0.41807717599663885, 'recall': 0.44101904485291066, 'f1-score': 0.3990468184110389, 'support': 48202}}
[[ 1357  8945  3041]
 [ 1402 15815  5311]
 [  846  7399  4086]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1832954
{'0': {'precision': 0.39883184309201036, 'recall': 0.0955787691058175, 'f1-score': 0.15420322987600452, 'support': 115737}, '1': {'precision': 0.26030312775032155, 'recall': 0.7649143311864323, 'f1-score': 0.3884241165291291, 'support': 80426}, '2': {'precision': 0.41477747989276137, 'recall': 0.1688494246250022, 'f1-score': 0.23999900719165546, 'support': 114534}, 'accuracy': 0.2958509415926127, 'macro avg': {'precision': 0.35797081691169774, 'recall': 0.34311417497241736, 'f1-score': 0.2608754511989297, 'support': 310697}, 'weighted avg': {'precision': 0.3688508877086837, 'recall': 0.2958509415926127, 'f1-score': 0.2464602603237879, 'support': 310697}}
[[11062 88854 15821]
 [ 7442 61519 11465]
 [ 9232 85963 19339]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1543813
{'0': {'precision': 0.34997277182791797, 'recall': 0.08774604619410627, 'f1-score': 0.1403125739133599, 'support': 43945}, '1': {'precision': 0.3381683610532137, 'recall': 0.7190340523673857, 'f1-score': 0.4599962390244609, 'support': 44226}, '2': {'precision': 0.36389253454798115, 'recall': 0.2203136320082264, 'f1-score': 0.2744595676541233, 'support': 42789}, 'accuracy': 0.34425015271838727, 'macro avg': {'precision': 0.3506778891430376, 'recall': 0.3423645768565728, 'f1-score': 0.29158946019731474, 'support': 130960}, 'weighted avg': {'precision': 0.35053440023435284, 'recall': 0.34425015271838727, 'f1-score': 0.2921020171660865, 'support': 130960}}
[[ 3856 32194  7895]
 [ 3842 31800  8584]
 [ 3320 30042  9427]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1512665
{'0': {'precision': 0.3683282980866062, 'recall': 0.10331191300049432, 'f1-score': 0.16136326035405063, 'support': 14161}, '1': {'precision': 0.33667846698476217, 'recall': 0.7541718383671218, 'f1-score': 0.4655330197714262, 'support': 14502}, '2': {'precision': 0.38101644245142, 'recall': 0.17598729632698148, 'f1-score': 0.2407669783696987, 'support': 14484}, 'accuracy': 0.3464667300159918, 'macro avg': {'precision': 0.3620077358409295, 'recall': 0.34449034923153254, 'f1-score': 0.28922108616505854, 'support': 43147}, 'weighted avg': {'precision': 0.36194985305777505, 'recall': 0.3464667300159918, 'f1-score': 0.2902517880108849, 'support': 43147}}
[[ 1463 10857  1841]
 [ 1265 10937  2300]
 [ 1244 10691  2549]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2048001
{'0': {'precision': 0.36549601231285855, 'recall': 0.13198261924009702, 'f1-score': 0.1939344444856899, 'support': 98960}, '1': {'precision': 0.2720677500648867, 'recall': 0.8532025783414071, 'f1-score': 0.41257447206960146, 'support': 76173}, '2': {'precision': 0.3785609934258583, 'recall': 0.019751133808453065, 'f1-score': 0.03754346566212692, 'support': 104956}, 'accuracy': 0.2860697849612088, 'macro avg': {'precision': 0.3387082519345345, 'recall': 0.33497877712998575, 'f1-score': 0.2146841274058061, 'support': 280089}, 'weighted avg': {'precision': 0.34498302228997735, 'recall': 0.28606978496120883, 'f1-score': 0.19479236910159206, 'support': 280089}}
[[13061 83971  1928]
 [ 9707 64991  1475]
 [12967 89916  2073]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1548092
{'0': {'precision': 0.3485010266940452, 'recall': 0.11115768515365068, 'f1-score': 0.16855360902554323, 'support': 38171}, '1': {'precision': 0.332053229498727, 'recall': 0.819412913784911, 'f1-score': 0.47259523157029326, 'support': 37882}, '2': {'precision': 0.3587066352307174, 'recall': 0.08296330918438888, 'f1-score': 0.13475895229659623, 'support': 38511}, 'accuracy': 0.3358733982751999, 'macro avg': {'precision': 0.3464202971411632, 'recall': 0.33784463604098347, 'f1-score': 0.2586359309641442, 'support': 114564}, 'weighted avg': {'precision': 0.3464930026812903, 'recall': 0.3358733982751999, 'f1-score': 0.25772855682722384, 'support': 114564}}
[[ 4243 31033  2895]
 [ 4024 31041  2817]
 [ 3908 31408  3195]]
Evaluating performance on  val set...
136/136 - 1s - 876ms/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1648948
{'0': {'precision': 0.3408304498269896, 'recall': 0.11820675467169553, 'f1-score': 0.1755346232179226, 'support': 11666}, '1': {'precision': 0.3149677279774997, 'recall': 0.8033661363009289, 'f1-score': 0.4525203336268974, 'support': 10873}, '2': {'precision': 0.3884435537742151, 'recall': 0.09506293934935425, 'f1-score': 0.15274494352508536, 'support': 12234}, 'accuracy': 0.32430333879734274, 'macro avg': {'precision': 0.3480805771929015, 'recall': 0.33887861010732623, 'f1-score': 0.26026663345663514, 'support': 34773}, 'weighted avg': {'precision': 0.34949502691325923, 'recall': 0.32430333879734274, 'f1-score': 0.25412596385331826, 'support': 34773}}
[[1379 9292  995]
 [1302 8735  836]
 [1365 9706 1163]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1848423
{'0': {'precision': 0.36226991399405195, 'recall': 0.11342716388048245, 'f1-score': 0.1727622506624246, 'support': 158939}, '1': {'precision': 0.27477312225022027, 'recall': 0.8462483711877546, 'f1-score': 0.4148471880540052, 'support': 121254}, '2': {'precision': 0.3706524210047738, 'recall': 0.040608694569318704, 'f1-score': 0.07319783167416752, 'support': 160606}, 'accuracy': 0.28847842213798125, 'macro avg': {'precision': 0.33589848574968206, 'recall': 0.33342807654585194, 'f1-score': 0.2202690901301991, 'support': 440799}, 'weighted avg': {'precision': 0.34125567606442286, 'recall': 0.28847842213798125, 'f1-score': 0.20307793632062868, 'support': 440799}}
[[ 18028 134726   6185]
 [ 13754 102611   4889]
 [ 17982 136102   6522]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1571128
{'0': {'precision': 0.3492617980490377, 'recall': 0.09959028717486092, 'f1-score': 0.15498683825680024, 'support': 53208}, '1': {'precision': 0.3363480626794982, 'recall': 0.7747644931040486, 'f1-score': 0.46906235544182834, 'support': 51697}, '2': {'precision': 0.3772733026709988, 'recall': 0.16854546825516514, 'f1-score': 0.23299933547891125, 'support': 53048}, 'accuracy': 0.343728830728128, 'macro avg': {'precision': 0.35429438779984485, 'recall': 0.34763341617802485, 'f1-score': 0.28568284305917996, 'support': 157953}, 'weighted avg': {'precision': 0.35444278808902874, 'recall': 0.343728830728128, 'f1-score': 0.28398197582653895, 'support': 157953}}
[[ 5299 39555  8354]
 [ 5240 40053  6404]
 [ 4633 39474  8941]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1634294
{'0': {'precision': 0.34209047485248667, 'recall': 0.1273269190545911, 'f1-score': 0.18558036735004954, 'support': 19124}, '1': {'precision': 0.3267014743427559, 'recall': 0.7518128407346636, 'f1-score': 0.4554753888087221, 'support': 18893}, '2': {'precision': 0.3765873595095606, 'recall': 0.132791188429667, 'f1-score': 0.1963470319634703, 'support': 19429}, 'accuracy': 0.33455767155241445, 'macro avg': {'precision': 0.3484597695682677, 'recall': 0.33731031607297396, 'f1-score': 0.279134262707414, 'support': 57446}, 'weighted avg': {'precision': 0.3486966020914928, 'recall': 0.33455767155241445, 'f1-score': 0.27798562040844965, 'support': 57446}}
[[ 2435 14569  2120]
 [ 2538 14204  2151]
 [ 2145 14704  2580]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
4450/4450 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.165054
{'0': {'precision': 0.38789071652842216, 'recall': 0.10152635426530401, 'f1-score': 0.16093075886633754, 'support': 407638}, '1': {'precision': 0.29012217574707655, 'recall': 0.8008399808844613, 'f1-score': 0.4259385832352354, 'support': 326436}, '2': {'precision': 0.3958978887983738, 'recall': 0.12838016328969232, 'f1-score': 0.19388732909018372, 'support': 405047}, 'accuracy': 0.3114761294015298, 'macro avg': {'precision': 0.3579702603579575, 'recall': 0.3435821661464859, 'f1-score': 0.26025222373058554, 'support': 1139121}, 'weighted avg': {'precision': 0.36272052804794275, 'recall': 0.3114761294015298, 'f1-score': 0.2485922575615102, 'support': 1139121}}
[[ 41386 319411  46841]
 [ 32507 261423  32506]
 [ 32802 320245  52000]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1419239
{'0': {'precision': 0.37024067093435636, 'recall': 0.12883221309821333, 'f1-score': 0.19115013674967615, 'support': 128842}, '1': {'precision': 0.3399404037036785, 'recall': 0.7899562870038812, 'f1-score': 0.47533205702938275, 'support': 126507}, '2': {'precision': 0.4450095635541645, 'recall': 0.15813702015911021, 'f1-score': 0.23335118932287807, 'support': 129470}, 'accuracy': 0.35603231649164935, 'macro avg': {'precision': 0.3850635460640664, 'recall': 0.3589751734204016, 'f1-score': 0.299944461033979, 'support': 384819}, 'weighted avg': {'precision': 0.38543517178004016, 'recall': 0.35603231649164935, 'f1-score': 0.29877157037295693, 'support': 384819}}
[[16599 98771 13472]
 [14510 99935 12062]
 [13724 95272 20474]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1529843
{'0': {'precision': 0.35134690294617876, 'recall': 0.15301538755615024, 'f1-score': 0.21318597180379165, 'support': 41852}, '1': {'precision': 0.34443619489559163, 'recall': 0.8350884298636425, 'f1-score': 0.48771288898233806, 'support': 44442}, '2': {'precision': 0.3542126157917953, 'recall': 0.036320872062781284, 'f1-score': 0.06588582798301573, 'support': 44217}, 'accuracy': 0.34574097202534654, 'macro avg': {'precision': 0.34999857121118855, 'recall': 0.3414748964941913, 'f1-score': 0.2555948962563818, 'support': 130511}, 'weighted avg': {'precision': 0.34996454849107866, 'recall': 0.34574097202534654, 'f1-score': 0.2567635613857097, 'support': 130511}}
[[ 6404 34032  1416]
 [ 5817 37113  1512]
 [ 6006 36605  1606]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
6203/6203 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1314313
{'0': {'precision': 0.3014456058885047, 'recall': 0.12506201928566238, 'f1-score': 0.17678181562081838, 'support': 481705}, '1': {'precision': 0.38413698838180577, 'recall': 0.8301633511771328, 'f1-score': 0.5252348849741105, 'support': 609362}, '2': {'precision': 0.3223951523331506, 'recall': 0.046156757050524654, 'f1-score': 0.08075234094102485, 'support': 496807}, 'accuracy': 0.3709639429828815, 'macro avg': {'precision': 0.33599258220115363, 'recall': 0.33379404250443995, 'f1-score': 0.26092301384531796, 'support': 1587874}, 'weighted avg': {'precision': 0.33973382494077714, 'recall': 0.3709639429828815, 'f1-score': 0.28045877236928624, 'support': 1587874}}
[[ 60243 399441  22021]
 [ 77317 505870  26175]
 [ 62287 411589  22931]]
Evaluating performance on  train set...
1766/1766 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1197011
{'0': {'precision': 0.3640669403220714, 'recall': 0.07151570285525255, 'f1-score': 0.11954793668348657, 'support': 145101}, '1': {'precision': 0.3713467826795352, 'recall': 0.8023959415683638, 'f1-score': 0.5077214029632552, 'support': 163610}, '2': {'precision': 0.4081956434737865, 'recall': 0.19932300390843105, 'f1-score': 0.2678527883551237, 'support': 143280}, 'accuracy': 0.37659156930115867, 'macro avg': {'precision': 0.38120312215846436, 'recall': 0.3577448827773491, 'f1-score': 0.29837404266728845, 'support': 451991}, 'weighted avg': {'precision': 0.3806907571584296, 'recall': 0.37659156930115867, 'f1-score': 0.3070697677941616, 'support': 451991}}
[[ 10377 114999  19725]
 [ 10650 131280  21680]
 [  7476 107245  28559]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112115
{'0': {'precision': 0.29711129222131666, 'recall': 0.07369390413728044, 'f1-score': 0.1180959236929722, 'support': 44522}, '1': {'precision': 0.41334054593874836, 'recall': 0.8203726338740048, 'f1-score': 0.5497116800035418, 'support': 60542}, '2': {'precision': 0.3687236943505839, 'recall': 0.14462425595238096, 'f1-score': 0.20775923977487182, 'support': 43008}, 'accuracy': 0.3995893889459182, 'macro avg': {'precision': 0.35972517750354965, 'recall': 0.3462302646545554, 'f1-score': 0.2918556144904619, 'support': 148072}, 'weighted avg': {'precision': 0.36543384928366657, 'recall': 0.3995893889459182, 'f1-score': 0.3206130843756458, 'support': 148072}}
[[ 3281 36920  4321]
 [ 4547 49667  6328]
 [ 3215 33573  6220]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
5183/5183 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1352688
{'0': {'precision': 0.30664903825649337, 'recall': 0.1064008208204258, 'f1-score': 0.15798436269752622, 'support': 405448}, '1': {'precision': 0.3734583832490134, 'recall': 0.859977882535275, 'f1-score': 0.5207661855755771, 'support': 495536}, '2': {'precision': 0.3323939911687044, 'recall': 0.035176209798617374, 'f1-score': 0.06361974250567502, 'support': 425856}, 'accuracy': 0.3649799523680323, 'macro avg': {'precision': 0.3375004708914037, 'recall': 0.33385163771810605, 'f1-score': 0.24745676359292612, 'support': 1326840}, 'weighted avg': {'precision': 0.33986335064351514, 'recall': 0.3649799523680323, 'f1-score': 0.26318597983695285, 'support': 1326840}}
[[ 43140 348636  13672]
 [ 52971 426150  16415]
 [ 44571 366305  14980]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1404818
{'0': {'precision': 0.3731396033771844, 'recall': 0.07344313992224395, 'f1-score': 0.12272997339257577, 'support': 129379}, '1': {'precision': 0.3437779607666998, 'recall': 0.7700273871974832, 'f1-score': 0.47534058871079043, 'support': 125241}, '2': {'precision': 0.40587412587412586, 'recall': 0.24097843365204394, 'f1-score': 0.3024086700211391, 'support': 126447}, 'accuracy': 0.3579737946345393, 'macro avg': {'precision': 0.37426389667267007, 'recall': 0.3614829869239237, 'f1-score': 0.30015974404150175, 'support': 381067}, 'weighted avg': {'precision': 0.3743517279746727, 'recall': 0.3579737946345393, 'f1-score': 0.2982401546091609, 'support': 381067}}
[[ 9502 94892 24985]
 [ 9183 96439 19619]
 [ 6780 89196 30471]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1357318
{'0': {'precision': 0.3439654456350195, 'recall': 0.0960320957306185, 'f1-score': 0.1501450326323423, 'support': 43121}, '1': {'precision': 0.35743005606709394, 'recall': 0.8192528919964932, 'f1-score': 0.4977136918680176, 'support': 46767}, '2': {'precision': 0.3960059171597633, 'recall': 0.12490668159761105, 'f1-score': 0.18991203178206584, 'support': 42864}, 'accuracy': 0.360137700373629, 'macro avg': {'precision': 0.36580047295395896, 'recall': 0.3467305564415742, 'f1-score': 0.2792569187608086, 'support': 132752}, 'weighted avg': {'precision': 0.3655121056289439, 'recall': 0.360137700373629, 'f1-score': 0.2854297450135387, 'support': 132752}}
[[ 4141 34796  4184]
 [ 4471 38314  3982]
 [ 3427 34083  5354]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1326834
{'0': {'precision': 0.32505592149343887, 'recall': 0.10656672586289342, 'f1-score': 0.16051124975981085, 'support': 591817}, '1': {'precision': 0.3754072820986592, 'recall': 0.86592738911908, 'f1-score': 0.5237514993842645, 'support': 700143}, '2': {'precision': 0.3290823314563993, 'recall': 0.03710707581004417, 'f1-score': 0.0666938080609941, 'support': 582746}, 'accuracy': 0.36857245882821094, 'macro avg': {'precision': 0.34318184501616583, 'recall': 0.33653373026400585, 'f1-score': 0.25031885240168983, 'support': 1874706}, 'weighted avg': {'precision': 0.34511214735951923, 'recall': 0.36857245882821094, 'f1-score': 0.2670070838866527, 'support': 1874706}}
[[ 63068 507371  21378]
 [ 71162 606273  22708]
 [ 59792 501330  21624]]
Evaluating performance on  train set...
2046/2046 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1558361
{'0': {'precision': 0.33793103448275863, 'recall': 0.09232389355343674, 'f1-score': 0.145026154602763, 'support': 175675}, '1': {'precision': 0.33101006512729425, 'recall': 0.8123837533711522, 'f1-score': 0.4703667183803411, 'support': 172048}, '2': {'precision': 0.37486683985272956, 'recall': 0.11394713371092263, 'f1-score': 0.17476997072354664, 'support': 176029}, 'accuracy': 0.3361247307886175, 'macro avg': {'precision': 0.34793597982092744, 'recall': 0.3395515935451705, 'f1-score': 0.26338761456888354, 'support': 523752}, 'weighted avg': {'precision': 0.3480713947063027, 'recall': 0.3361247307886175, 'f1-score': 0.261894381406155, 'support': 523752}}
[[ 16219 141932  17524]
 [ 16354 139769  15925]
 [ 15422 140549  20058]]
Evaluating performance on  val set...
741/741 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1446762
{'0': {'precision': 0.3595086872080206, 'recall': 0.10889231600871266, 'f1-score': 0.16715478108068532, 'support': 62897}, '1': {'precision': 0.3451635702746365, 'recall': 0.8486052068141621, 'f1-score': 0.49072753209700426, 'support': 64454}, '2': {'precision': 0.39710144927536234, 'recall': 0.07704172624881506, 'f1-score': 0.12904701671286703, 'support': 62239}, 'accuracy': 0.34991297009335937, 'macro avg': {'precision': 0.3672579022526732, 'recall': 0.34484641635722996, 'f1-score': 0.26230977663018556, 'support': 189590}, 'weighted avg': {'precision': 0.3669728770465403, 'recall': 0.34991297009335937, 'f1-score': 0.26464815598187835, 'support': 189590}}
[[ 6849 51795  4253]
 [ 6731 54696  3027]
 [ 5471 51973  4795]]
testing model on single stock: results/universal/W6/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 149s - 149s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1194446
{'0': {'precision': 0.3014833130458869, 'recall': 0.10517716292854527, 'f1-score': 0.15594906025958866, 'support': 2255946}, '1': {'precision': 0.4026064717125642, 'recall': 0.862464179592862, 'f1-score': 0.5489553646131038, 'support': 3025510}, '2': {'precision': 0.29813568310692284, 'recall': 0.032743594384815417, 'f1-score': 0.05900661989650709, 'support': 2231948}, 'accuracy': 0.38860548427849745, 'macro avg': {'precision': 0.33407515595512466, 'recall': 0.3334616456354076, 'f1-score': 0.2546370149230665, 'support': 7513404}, 'weighted avg': {'precision': 0.34120930033881136, 'recall': 0.38860548427849745, 'f1-score': 0.2854075610937119, 'support': 7513404}}
[[ 237274 1945328   73344]
 [ 317412 2609394   98704]
 [ 232336 1926530   73082]]
Evaluating performance on  train set...
5452/5452 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1573333
{'0': {'precision': 0.33526844266701067, 'recall': 0.0997303088123994, 'f1-score': 0.15373113237000108, 'support': 469055}, '1': {'precision': 0.3301548670300825, 'recall': 0.8422333584406199, 'f1-score': 0.47436068773655815, 'support': 459362}, '2': {'precision': 0.3543826690763816, 'recall': 0.06381434425703017, 'f1-score': 0.10815331971362321, 'support': 467058}, 'accuracy': 0.332126336910371, 'macro avg': {'precision': 0.3399353262578249, 'recall': 0.3352593371700165, 'f1-score': 0.2454150466067275, 'support': 1395475}, 'weighted avg': {'precision': 0.3399825866155424, 'recall': 0.332126336910371, 'f1-score': 0.24402121409029695, 'support': 1395475}}
[[ 46779 393673  28603]
 [ 46776 386890  25696]
 [ 45972 391281  29805]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1356578
{'0': {'precision': 0.29818938506063286, 'recall': 0.07789440799750078, 'f1-score': 0.1235218642715955, 'support': 160050}, '1': {'precision': 0.37010467086723275, 'recall': 0.8405985859337621, 'f1-score': 0.5139318181079509, 'support': 188110}, '2': {'precision': 0.32724935732647814, 'recall': 0.07348800215518624, 'f1-score': 0.12002325666664919, 'support': 155903}, 'accuracy': 0.3611631879348415, 'macro avg': {'precision': 0.33184780441811457, 'recall': 0.3306603320288164, 'f1-score': 0.2524923130153985, 'support': 504063}, 'weighted avg': {'precision': 0.33401530616422825, 'recall': 0.3611631879348415, 'f1-score': 0.26813587679527384, 'support': 504063}}
[[ 12467 136758  10825]
 [ 17257 158125  12728]
 [ 12085 132361  11457]]
training model: results/universal/W6/deepLOB_L1/h200
Epoch 1/50
9426/9426 - 152s - loss: 3.2052 - accuracy200: 0.4150 - val_loss: 3.3796 - val_accuracy200: 0.3585 - 152s/epoch - 16ms/step
Epoch 2/50
9426/9426 - 150s - loss: 3.1886 - accuracy200: 0.4244 - val_loss: 3.4492 - val_accuracy200: 0.3663 - 150s/epoch - 16ms/step
Epoch 3/50
9426/9426 - 150s - loss: 3.1767 - accuracy200: 0.4306 - val_loss: 3.4679 - val_accuracy200: 0.3663 - 150s/epoch - 16ms/step
Epoch 4/50
9426/9426 - 151s - loss: 3.1700 - accuracy200: 0.4342 - val_loss: 3.5018 - val_accuracy200: 0.3647 - 151s/epoch - 16ms/step
Epoch 5/50
9426/9426 - 150s - loss: 3.1640 - accuracy200: 0.4376 - val_loss: 3.5718 - val_accuracy200: 0.3638 - 150s/epoch - 16ms/step
Epoch 6/50
9426/9426 - 149s - loss: 3.1600 - accuracy200: 0.4392 - val_loss: 3.5886 - val_accuracy200: 0.3622 - 149s/epoch - 16ms/step
Epoch 7/50
9426/9426 - 150s - loss: 3.1568 - accuracy200: 0.4407 - val_loss: 3.6174 - val_accuracy200: 0.3572 - 150s/epoch - 16ms/step
Epoch 8/50
9426/9426 - 152s - loss: 3.1539 - accuracy200: 0.4418 - val_loss: 3.6780 - val_accuracy200: 0.3521 - 152s/epoch - 16ms/step
Epoch 9/50
9426/9426 - 150s - loss: 3.1503 - accuracy200: 0.4434 - val_loss: 3.6704 - val_accuracy200: 0.3444 - 150s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 151s - loss: 3.1484 - accuracy200: 0.4445 - val_loss: 3.7780 - val_accuracy200: 0.3303 - 151s/epoch - 16ms/step
Epoch 11/50
9426/9426 - 151s - loss: 3.1459 - accuracy200: 0.4454 - val_loss: 3.7458 - val_accuracy200: 0.3287 - 151s/epoch - 16ms/step
testing model in sample: results/universal/W6/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 256s - 256s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164693
{'0': {'precision': 0.31296784033429087, 'recall': 0.4094807227797749, 'f1-score': 0.35477763818785973, 'support': 3340990}, '1': {'precision': 0.37769500263587846, 'recall': 0.5886103618347979, 'f1-score': 0.46013444680911897, 'support': 4073931}, '2': {'precision': 0.39751470752598583, 'recall': 0.01149422923470521, 'f1-score': 0.022342422190857157, 'support': 3403708}, 'accuracy': 0.35172220065962145, 'macro avg': {'precision': 0.3627258501653851, 'recall': 0.3365284379497593, 'f1-score': 0.2790848357292786, 'support': 10818629}, 'weighted avg': {'precision': 0.36394165977830534, 'recall': 0.35172220065962145, 'f1-score': 0.2898622006155471, 'support': 10818629}}
[[1368071 1947574   25345]
 [1642022 2397958   33951]
 [1361190 2003395   39123]]
Evaluating performance on  train set...
9426/9426 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1279787
{'0': {'precision': 0.3420190935887525, 'recall': 0.26916580314725, 'f1-score': 0.30125038923295155, 'support': 808706}, '1': {'precision': 0.34796886139576416, 'recall': 0.6037841471673877, 'f1-score': 0.441497069782486, 'support': 800286}, '2': {'precision': 0.3730371327090733, 'recall': 0.1797942498011098, 'f1-score': 0.24264154874438387, 'support': 803207}, 'accuracy': 0.3504221666620374, 'macro avg': {'precision': 0.35434169589786335, 'recall': 0.35091473337191587, 'f1-score': 0.3284630025866071, 'support': 2412199}, 'weighted avg': {'precision': 0.3543213215670071, 'recall': 0.3504221666620374, 'f1-score': 0.32826409085871455, 'support': 2412199}}
[[217676 455296 135734]
 [210107 483200 106979]
 [208661 450134 144412]]
Evaluating performance on  val set...
3323/3323 - 21s - 21s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265341
{'0': {'precision': 0.3256543215944558, 'recall': 0.24354973294662977, 'f1-score': 0.27868045712074496, 'support': 272043}, '1': {'precision': 0.37849252692822594, 'recall': 0.5810883209569484, 'f1-score': 0.45840345282463085, 'support': 307979}, '2': {'precision': 0.3420452259862656, 'recall': 0.22022058687504395, 'f1-score': 0.2679351960638676, 'support': 270279}, 'accuracy': 0.35839073457516807, 'macro avg': {'precision': 0.3487306915029824, 'recall': 0.348286213592874, 'f1-score': 0.3350063686697478, 'support': 850301}, 'weighted avg': {'precision': 0.3500023758583025, 'recall': 0.35839073457516807, 'f1-score': 0.34036060342269603, 'support': 850301}}
[[ 66256 145650  60137]
 [ 74659 178963  54357]
 [ 62540 148218  59521]]
testing model out of sample: results/universal/W6/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 99s - 99s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.126555
{'0': {'precision': 0.33580206071799806, 'recall': 0.3844149038377557, 'f1-score': 0.35846785963741756, 'support': 1431175}, '1': {'precision': 0.3675485083200749, 'recall': 0.6359789098737448, 'f1-score': 0.4658629060037811, 'support': 1589559}, '2': {'precision': 0.40083674189730706, 'recall': 0.026366267893737336, 'f1-score': 0.04947797031526813, 'support': 1464409}, 'accuracy': 0.35666688888180376, 'macro avg': {'precision': 0.36806243697846003, 'recall': 0.3489200272017459, 'f1-score': 0.2912695786521556, 'support': 4485143}, 'weighted avg': {'precision': 0.36828713955160947, 'recall': 0.35666688888180376, 'f1-score': 0.29564337169460525, 'support': 4485143}}
[[ 550165  849851   31159]
 [ 552077 1010926   26556]
 [ 536119  889679   38611]]
Evaluating performance on  train set...
5153/5153 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293317
{'0': {'precision': 0.34357715090393837, 'recall': 0.21826022907065495, 'f1-score': 0.26694282129511443, 'support': 449381}, '1': {'precision': 0.33132674557108255, 'recall': 0.6062778754044207, 'f1-score': 0.42848781005473574, 'support': 426227}, '2': {'precision': 0.3651816074341162, 'recall': 0.20872807878882274, 'f1-score': 0.26562944365127017, 'support': 443007}, 'accuracy': 0.34047997330532415, 'macro avg': {'precision': 0.34669516796971234, 'recall': 0.3444220610879662, 'f1-score': 0.32035335833370676, 'support': 1318615}, 'weighted avg': {'precision': 0.3468756663616401, 'recall': 0.34047997330532415, 'f1-score': 0.31871911720724994, 'support': 1318615}}
[[ 98082 264387  86912]
 [ 93984 258412  73831]
 [ 93407 257132  92468]]
Evaluating performance on  val set...
1795/1795 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1243371
{'0': {'precision': 0.35584295034853314, 'recall': 0.2593055094859938, 'f1-score': 0.29999924753756674, 'support': 153753}, '1': {'precision': 0.34388491319705533, 'recall': 0.6129409764899709, 'f1-score': 0.4405841371288931, 'support': 152956}, '2': {'precision': 0.36442025275524775, 'recall': 0.177733386777761, 'f1-score': 0.23893465250325743, 'support': 152183}, 'accuracy': 0.3501259555625289, 'macro avg': {'precision': 0.3547160387669454, 'recall': 0.3499932909179086, 'f1-score': 0.32650601238990573, 'support': 458892}, 'weighted avg': {'precision': 0.35470164930519316, 'recall': 0.3501259555625289, 'f1-score': 0.3266074889238289, 'support': 458892}}
[[39869 89471 24413]
 [36442 93753 22761]
 [35730 89405 27048]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1320499
{'0': {'precision': 0.3150458530686284, 'recall': 0.38098371843618994, 'f1-score': 0.34489149741292763, 'support': 82056}, '1': {'precision': 0.3589504427564577, 'recall': 0.6458766022615227, 'f1-score': 0.46144795464509336, 'support': 95334}, '2': {'precision': 0.4228187919463087, 'recall': 0.0013450473435314965, 'f1-score': 0.0026815642458100563, 'support': 93677}, 'accuracy': 0.3429484223457669, 'macro avg': {'precision': 0.3656050292571316, 'recall': 0.34273512268041467, 'f1-score': 0.26967367210127696, 'support': 271067}, 'weighted avg': {'precision': 0.3677318891724108, 'recall': 0.3429484223457669, 'f1-score': 0.2676212778158362, 'support': 271067}}
[[31262 50734    60]
 [33648 61574   112]
 [34320 59231   126]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1342096
{'0': {'precision': 0.3487594580327292, 'recall': 0.21457183068095703, 'f1-score': 0.26568364611260054, 'support': 18474}, '1': {'precision': 0.3400438856187524, 'recall': 0.5607696726019529, 'f1-score': 0.42336462782680334, 'support': 17410}, '2': {'precision': 0.34670796715170726, 'recall': 0.26627939142461965, 'f1-score': 0.30121726069405763, 'support': 18075}, 'accuracy': 0.34359421041902183, 'macro avg': {'precision': 0.34517043693439625, 'recall': 0.3472069649025098, 'f1-score': 0.3300885115444872, 'support': 53959}, 'weighted avg': {'precision': 0.34526015646298536, 'recall': 0.34359421041902183, 'f1-score': 0.3284627186529387, 'support': 53959}}
[[3964 9600 4910]
 [3488 9763 4159]
 [3914 9348 4813]]
Evaluating performance on  val set...
81/81 - 1s - 657ms/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1284686
{'0': {'precision': 0.35213364207740655, 'recall': 0.30284495021337127, 'f1-score': 0.3256347506882839, 'support': 7030}, '1': {'precision': 0.3203663323157436, 'recall': 0.5629981606376456, 'f1-score': 0.40836066485074207, 'support': 6524}, '2': {'precision': 0.4056301983365323, 'recall': 0.17902018918537344, 'f1-score': 0.24840826721520223, 'support': 7083}, 'accuracy': 0.3425885545379658, 'macro avg': {'precision': 0.3593767242432275, 'recall': 0.34828776667879674, 'f1-score': 0.32746789425140943, 'support': 20637}, 'weighted avg': {'precision': 0.36045201098268825, 'recall': 0.3425885545379658, 'f1-score': 0.32528143778214635, 'support': 20637}}
[[2129 3927  974]
 [1967 3673  884]
 [1950 3865 1268]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1417055
{'0': {'precision': 0.37819935719287257, 'recall': 0.4336242146205246, 'f1-score': 0.4040198016581914, 'support': 200540}, '1': {'precision': 0.2818913003010521, 'recall': 0.578758006273228, 'f1-score': 0.3791250296764725, 'support': 151756}, '2': {'precision': 0.5196921684019918, 'recall': 0.04439309934792802, 'f1-score': 0.08179878958454873, 'support': 206879}, 'accuracy': 0.3290079134439129, 'macro avg': {'precision': 0.3932609419653055, 'recall': 0.35225844008056023, 'f1-score': 0.2883145403064042, 'support': 559175}, 'weighted avg': {'precision': 0.4044104106349189, 'recall': 0.3290079134439129, 'f1-score': 0.278050844223326, 'support': 559175}}
[[ 86959 109967   3614]
 [ 59052  87830   4874]
 [ 83918 113777   9184]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1170963
{'0': {'precision': 0.3447728855528902, 'recall': 0.1930835734870317, 'f1-score': 0.2475380918649388, 'support': 46151}, '1': {'precision': 0.37626889239792466, 'recall': 0.5363918962375389, 'f1-score': 0.44228389605798124, 'support': 46645}, '2': {'precision': 0.38433523774838957, 'recall': 0.3883573301439809, 'f1-score': 0.38633581585841603, 'support': 43478}, 'accuracy': 0.3728957834950174, 'macro avg': {'precision': 0.3684590052330681, 'recall': 0.37261093328951717, 'f1-score': 0.358719267927112, 'support': 136274}, 'weighted avg': {'precision': 0.36817590585054455, 'recall': 0.3728957834950174, 'f1-score': 0.3584804981961015, 'support': 136274}}
[[ 8911 22972 14268]
 [ 8845 25020 12780]
 [ 8090 18503 16885]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196784
{'0': {'precision': 0.37626160678239806, 'recall': 0.1677264547090582, 'f1-score': 0.23202356748682626, 'support': 16670}, '1': {'precision': 0.3636906434391683, 'recall': 0.6145035902913774, 'f1-score': 0.4569423912803654, 'support': 16851}, '2': {'precision': 0.3135214245060574, 'recall': 0.26265240787412303, 'f1-score': 0.2858413639733136, 'support': 14681}, 'accuracy': 0.35282768349861, 'macro avg': {'precision': 0.35115789157587457, 'recall': 0.3482941509581862, 'f1-score': 0.3249357742468351, 'support': 48202}, 'weighted avg': {'precision': 0.35275797790194247, 'recall': 0.35282768349861, 'f1-score': 0.3270446489764543, 'support': 48202}}
[[ 2796  9934  3940]
 [ 1993 10355  4503]
 [ 2642  8183  3856]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.146184
{'0': {'precision': 0.39076040448842336, 'recall': 0.2761043407168953, 'f1-score': 0.3235757914487604, 'support': 117423}, '1': {'precision': 0.2487022503458383, 'recall': 0.47290768689854545, 'f1-score': 0.3259744631196284, 'support': 76793}, '2': {'precision': 0.4126012777519399, 'recall': 0.2894205921995862, 'f1-score': 0.3402039487958342, 'support': 116481}, 'accuracy': 0.32973926365558726, 'macro avg': {'precision': 0.3506879775287339, 'recall': 0.34614420660500905, 'f1-score': 0.32991806778807437, 'support': 310697}, 'weighted avg': {'precision': 0.36383698690645805, 'recall': 0.32973926365558726, 'f1-score': 0.3304025892278361, 'support': 310697}}
[[32421 56764 28238]
 [20721 36316 19756]
 [29827 52942 33712]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1311994
{'0': {'precision': 0.3400259067357513, 'recall': 0.20978555254628603, 'f1-score': 0.2594799417886268, 'support': 45046}, '1': {'precision': 0.3367169460521186, 'recall': 0.5222436687518895, 'f1-score': 0.40944436847622956, 'support': 43001}, '2': {'precision': 0.3573230246202775, 'recall': 0.3037075012234055, 'f1-score': 0.3283409122400393, 'support': 42913}, 'accuracy': 0.3431582162492364, 'macro avg': {'precision': 0.34468862580271575, 'recall': 0.3452455741738604, 'f1-score': 0.33242174083496523, 'support': 130960}, 'weighted avg': {'precision': 0.3446073255004259, 'recall': 0.3431582162492364, 'f1-score': 0.3312854636042581, 'support': 130960}}
[[ 9450 23120 12476]
 [ 9579 22457 10965]
 [ 8763 21117 13033]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1364614
{'0': {'precision': 0.3672514619883041, 'recall': 0.24899226855217074, 'f1-score': 0.2967747016894419, 'support': 15133}, '1': {'precision': 0.2921163193014252, 'recall': 0.5592618878637331, 'f1-score': 0.38377661733272, 'support': 12681}, '2': {'precision': 0.3726332907422465, 'recall': 0.20922193960738278, 'f1-score': 0.2679809539720992, 'support': 15333}, 'accuracy': 0.32604816093818806, 'macro avg': {'precision': 0.34400035734399187, 'recall': 0.3391586986744288, 'f1-score': 0.3161774243314204, 'support': 43147}, 'weighted avg': {'precision': 0.34708159701210384, 'recall': 0.32604816093818806, 'f1-score': 0.3121124252512746, 'support': 43147}}
[[3768 8565 2800]
 [2988 7092 2601]
 [3504 8621 3208]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1593261
{'0': {'precision': 0.3476069845290871, 'recall': 0.38958234047515233, 'f1-score': 0.36739962993244113, 'support': 98621}, '1': {'precision': 0.2619170937098219, 'recall': 0.5862680378624622, 'f1-score': 0.362075718840421, 'support': 73318}, '2': {'precision': 0.39460154241645246, 'recall': 0.019870550161812297, 'f1-score': 0.03783583929011585, 'support': 108150}, 'accuracy': 0.2983123221547437, 'macro avg': {'precision': 0.3347085402184538, 'recall': 0.3319069761664756, 'f1-score': 0.25577039602099266, 'support': 280089}, 'weighted avg': {'precision': 0.34332209658429697, 'recall': 0.2983123221547437, 'f1-score': 0.23875244110527474, 'support': 280089}}
[[38421 58285  1915]
 [28952 42984  1382]
 [43157 62844  2149]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1326015
{'0': {'precision': 0.3316800482284274, 'recall': 0.3197970884303416, 'f1-score': 0.3256301955825778, 'support': 37849}, '1': {'precision': 0.33324432972868734, 'recall': 0.5930413663842031, 'f1-score': 0.42670997397762456, 'support': 37881}, '2': {'precision': 0.3693000562957403, 'recall': 0.10135448318483803, 'f1-score': 0.15905600905196798, 'support': 38834}, 'accuracy': 0.336100345658322, 'macro avg': {'precision': 0.344741478084285, 'recall': 0.3380643126664609, 'f1-score': 0.30379872620405673, 'support': 114564}, 'weighted avg': {'precision': 0.34494941679793767, 'recall': 0.336100345658322, 'f1-score': 0.3025885867495505, 'support': 114564}}
[[12104 22286  3459]
 [12153 22465  3263]
 [12236 22662  3936]]
Evaluating performance on  val set...
136/136 - 1s - 971ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1496284
{'0': {'precision': 0.3362779240635352, 'recall': 0.33947864860229804, 'f1-score': 0.3378707062086622, 'support': 11662}, '1': {'precision': 0.3018196604655891, 'recall': 0.5791475665658832, 'f1-score': 0.39683229191031505, 'support': 10253}, '2': {'precision': 0.4176187612748046, 'recall': 0.10802613159122725, 'f1-score': 0.17165101334651506, 'support': 12858}, 'accuracy': 0.324562160296782, 'macro avg': {'precision': 0.3519054486013096, 'recall': 0.3422174489198028, 'f1-score': 0.30211800382183074, 'support': 34773}, 'weighted avg': {'precision': 0.35619509854352716, 'recall': 0.324562160296782, 'f1-score': 0.29379283910998094, 'support': 34773}}
[[3959 6525 1178]
 [3556 5938  759]
 [4258 7211 1389]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1520463
{'0': {'precision': 0.3488681131298877, 'recall': 0.38830351182607103, 'f1-score': 0.36753100338218714, 'support': 152798}, '1': {'precision': 0.2922629090571985, 'recall': 0.6174866812911313, 'f1-score': 0.3967431383159458, 'support': 127640}, '2': {'precision': 0.41935483870967744, 'recall': 0.002756281140676349, 'f1-score': 0.005476566614007372, 'support': 160361}, 'accuracy': 0.31440633939732165, 'macro avg': {'precision': 0.35349528696558785, 'recall': 0.3361821580859596, 'f1-score': 0.2565835694373801, 'support': 440799}, 'weighted avg': {'precision': 0.35812002511894075, 'recall': 0.31440633939732165, 'f1-score': 0.24427579039024042, 'support': 440799}}
[[59332 93205   261]
 [48473 78816   351]
 [62265 97654   442]]
Evaluating performance on  train set...
618/618 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1308757
{'0': {'precision': 0.33197384993702395, 'recall': 0.31224144415193683, 'f1-score': 0.3218054438512002, 'support': 53180}, '1': {'precision': 0.34069411890682816, 'recall': 0.5491207547893455, 'f1-score': 0.420496930893712, 'support': 52147}, '2': {'precision': 0.37136277998743983, 'recall': 0.16854786607380381, 'f1-score': 0.2318620851903648, 'support': 52626}, 'accuracy': 0.3425702582413756, 'macro avg': {'precision': 0.34801024961043064, 'recall': 0.3433033550050287, 'f1-score': 0.3247214866450923, 'support': 157953}, 'weighted avg': {'precision': 0.3479761904990998, 'recall': 0.3425702582413756, 'f1-score': 0.3244208153979307, 'support': 157953}}
[[16605 27881  8694]
 [17191 28635  6321]
 [16223 27533  8870]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1285675
{'0': {'precision': 0.34175497544585165, 'recall': 0.2782951854775059, 'f1-score': 0.3067776456599287, 'support': 19005}, '1': {'precision': 0.3385970139371669, 'recall': 0.5391102677630192, 'f1-score': 0.4159498973138942, 'support': 18972}, '2': {'precision': 0.3669982147411375, 'recall': 0.22173712055061892, 'f1-score': 0.2764472336065574, 'support': 19469}, 'accuracy': 0.34526337778087246, 'macro avg': {'precision': 0.349116734708052, 'recall': 0.3463808579303813, 'f1-score': 0.33305825886012674, 'support': 57446}, 'weighted avg': {'precision': 0.3492672091974994, 'recall': 0.34526337778087246, 'f1-score': 0.33255338576562704, 'support': 57446}}
[[ 5289  9824  3892]
 [ 5190 10228  3554]
 [ 4997 10155  4317]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154852
{'0': {'precision': 0.36490262153578573, 'recall': 0.3264977261375884, 'f1-score': 0.3446335443538485, 'support': 380410}, '1': {'precision': 0.3461222626540352, 'recall': 0.6824913996016657, 'f1-score': 0.45930843841606495, 'support': 386610}, '2': {'precision': 0.40835209488770524, 'recall': 0.03997033063603699, 'f1-score': 0.07281352579903702, 'support': 372101}, 'accuracy': 0.3537236167185049, 'macro avg': {'precision': 0.3731256596925087, 'recall': 0.349653152125097, 'f1-score': 0.29225183618965017, 'support': 1139121}, 'weighted avg': {'precision': 0.37272173639403966, 'recall': 0.3537236167185049, 'f1-score': 0.2947617221937177, 'support': 1139121}}
[[124203 247149   9058]
 [110261 263858  12491]
 [105909 251319  14873]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1184354
{'0': {'precision': 0.3690684709391358, 'recall': 0.2852236600892629, 'f1-score': 0.3217738839051974, 'support': 129281}, '1': {'precision': 0.3363032441344987, 'recall': 0.6152003501651347, 'f1-score': 0.4348777551502605, 'support': 125655}, '2': {'precision': 0.4116118952894799, 'recall': 0.17444931207317355, 'f1-score': 0.24504407072946519, 'support': 129883}, 'accuracy': 0.3555827544897731, 'macro avg': {'precision': 0.37232787012103813, 'recall': 0.35829110744252374, 'f1-score': 0.3338985699283077, 'support': 384819}, 'weighted avg': {'precision': 0.37272877100425494, 'recall': 0.3555827544897731, 'f1-score': 0.3328080808045053, 'support': 384819}}
[[36874 75063 17344]
 [33307 77303 15045]
 [29730 77495 22658]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1213433
{'0': {'precision': 0.33593701181028557, 'recall': 0.4036036036036036, 'f1-score': 0.3666746240152781, 'support': 39960}, '1': {'precision': 0.3656226335456159, 'recall': 0.6264516952397158, 'f1-score': 0.46174951202113396, 'support': 47014}, '2': {'precision': 0.4864032837352488, 'recall': 0.021774582538989826, 'f1-score': 0.04168315525656246, 'support': 43537}, 'accuracy': 0.3565063481239129, 'macro avg': {'precision': 0.3959876430303834, 'recall': 0.35060996046076975, 'f1-score': 0.2900357637643248, 'support': 130511}, 'weighted avg': {'precision': 0.3968245224497102, 'recall': 0.3565063481239129, 'f1-score': 0.29250997283153957, 'support': 130511}}
[[16128 23424   408]
 [16969 29452   593]
 [14912 27677   948]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
6203/6203 - 43s - 43s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1312486
{'0': {'precision': 0.333867875495585, 'recall': 0.4671278266583329, 'f1-score': 0.3894127637686593, 'support': 499176}, '1': {'precision': 0.3764054805865884, 'recall': 0.5923012768639895, 'f1-score': 0.4602950171562405, 'support': 564743}, '2': {'precision': 0.33417402269861285, 'recall': 0.0005057686251681919, 'f1-score': 0.0010100086136583654, 'support': 523955}, 'accuracy': 0.3576744754306702, 'macro avg': {'precision': 0.34814912626026207, 'recall': 0.35331162404916355, 'f1-score': 0.28357259651285277, 'support': 1587874}, 'weighted avg': {'precision': 0.34909781317935024, 'recall': 0.3576744754306702, 'f1-score': 0.2864604456676162, 'support': 1587874}}
[[233179 265862    135]
 [229852 334498    393]
 [235386 288304    265]]
Evaluating performance on  train set...
1766/1766 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1277413
{'0': {'precision': 0.3582266189233477, 'recall': 0.14950891924238682, 'f1-score': 0.21096839048363678, 'support': 157917}, '1': {'precision': 0.32623180520671075, 'recall': 0.6174740435616748, 'f1-score': 0.4269119920413925, 'support': 141776}, '2': {'precision': 0.377808165657355, 'recall': 0.2920721217612838, 'f1-score': 0.3294535893495288, 'support': 152298}, 'accuracy': 0.344332077408621, 'macro avg': {'precision': 0.3540888632624711, 'recall': 0.35301836152178184, 'f1-score': 0.3224446572915194, 'support': 451991}, 'weighted avg': {'precision': 0.3547887931591309, 'recall': 0.344332077408621, 'f1-score': 0.3186269033109497, 'support': 451991}}
[[23610 93841 40466]
 [21444 87543 32789]
 [20854 86962 44482]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265382
{'0': {'precision': 0.357948859518962, 'recall': 0.209441314838371, 'f1-score': 0.2642600565561868, 'support': 49527}, '1': {'precision': 0.36291250845486583, 'recall': 0.6027394560504533, 'f1-score': 0.45304456673900645, 'support': 50740}, '2': {'precision': 0.34728045488484294, 'recall': 0.2529651710072168, 'f1-score': 0.29271303569051277, 'support': 47805}, 'accuracy': 0.35826489815765306, 'macro avg': {'precision': 0.35604727428622357, 'recall': 0.3550486472986804, 'f1-score': 0.3366725529952353, 'support': 148072}, 'weighted avg': {'precision': 0.35620546754393434, 'recall': 0.35826489815765306, 'f1-score': 0.3381370941743234, 'support': 148072}}
[[10373 27132 12022]
 [ 9450 30583 10707]
 [ 9156 26556 12093]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
5183/5183 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1453636
{'0': {'precision': 0.3486985062000141, 'recall': 0.4963306373385246, 'f1-score': 0.4096184211979226, 'support': 448443}, '1': {'precision': 0.30216414203027214, 'recall': 0.523317262410842, 'f1-score': 0.3831163506658567, 'support': 392842}, '2': {'precision': 0.4498959990211673, 'recall': 0.0075727775432237335, 'f1-score': 0.014894840884049519, 'support': 485555}, 'accuracy': 0.32546049259895693, 'macro avg': {'precision': 0.3669195490838178, 'recall': 0.3424068924308634, 'f1-score': 0.2692098709159429, 'support': 1326840}, 'weighted avg': {'precision': 0.3719539823219318, 'recall': 0.32546049259895693, 'f1-score': 0.25732339359002676, 'support': 1326840}}
[[222576 224418   1449]
 [184214 205581   3047]
 [231515 250363   3677]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1245257
{'0': {'precision': 0.3504794080559587, 'recall': 0.22718650236732932, 'f1-score': 0.27567557451905084, 'support': 129682}, '1': {'precision': 0.3439938424383207, 'recall': 0.5954303219835977, 'f1-score': 0.4360636486064087, 'support': 125348}, '2': {'precision': 0.3710080463791294, 'recall': 0.23559748327871974, 'f1-score': 0.28818913685926834, 'support': 126037}, 'accuracy': 0.35109836327994814, 'macro avg': {'precision': 0.3551604322911363, 'recall': 0.3527381025432155, 'f1-score': 0.33330945332824263, 'support': 381067}, 'weighted avg': {'precision': 0.3551358472367268, 'recall': 0.35109836327994814, 'f1-score': 0.33257238313112203, 'support': 381067}}
[[29462 73172 27048]
 [27418 74636 23294]
 [27182 69161 29694]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1328034
{'0': {'precision': 0.34486702293568444, 'recall': 0.37375490151890745, 'f1-score': 0.3587303303952846, 'support': 44374}, '1': {'precision': 0.34117798768496727, 'recall': 0.4792699771301768, 'f1-score': 0.39860264969256404, 'support': 44163}, '2': {'precision': 0.3489811254033506, 'recall': 0.17855931245052584, 'f1-score': 0.23624285586043867, 'support': 44215}, 'accuracy': 0.3438441605399542, 'macro avg': {'precision': 0.34500871200800076, 'recall': 0.3438613970332034, 'f1-score': 0.3311919453160958, 'support': 132752}, 'weighted avg': {'precision': 0.345010042828646, 'recall': 0.3438441605399542, 'f1-score': 0.33119852334580546, 'support': 132752}}
[[16585 20609  7180]
 [15449 21166  7548]
 [16057 20263  7895]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 44s - 44s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.11255
{'0': {'precision': 0.33030679651321165, 'recall': 0.33465868122996884, 'f1-score': 0.33246849835744186, 'support': 579722}, '1': {'precision': 0.39261717852147454, 'recall': 0.6902788639112667, 'f1-score': 0.5005380559578197, 'support': 725049}, '2': {'precision': 0.33190510195985085, 'recall': 0.007339433444164685, 'f1-score': 0.014361294885483863, 'support': 569935}, 'accuracy': 0.3726867039418447, 'macro avg': {'precision': 0.35160969233151235, 'recall': 0.3440923261951334, 'f1-score': 0.28245594973358185, 'support': 1874706}, 'weighted avg': {'precision': 0.354891456923665, 'recall': 0.3726867039418447, 'f1-score': 0.30076125234543033, 'support': 1874706}}
[[194009 383193   2520]
 [218663 500486   5900]
 [174688 391064   4183]]
Evaluating performance on  train set...
2046/2046 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1296471
{'0': {'precision': 0.3399132404314945, 'recall': 0.25332448330319746, 'f1-score': 0.2902996305027065, 'support': 174764}, '1': {'precision': 0.3320530211657558, 'recall': 0.6422483754428627, 'f1-score': 0.43777113354640695, 'support': 171893}, '2': {'precision': 0.3494658889835507, 'recall': 0.12044382958299218, 'f1-score': 0.17914509240712045, 'support': 177095}, 'accuracy': 0.3360369029617071, 'macro avg': {'precision': 0.3404773835269337, 'recall': 0.3386722294430175, 'f1-score': 0.30240528548541135, 'support': 523752}, 'weighted avg': {'precision': 0.3405635665879212, 'recall': 0.3360369029617071, 'f1-score': 0.3011146844760622, 'support': 523752}}
[[ 44272 110276  20216]
 [ 42005 110398  19490]
 [ 43968 111797  21330]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1182125
{'0': {'precision': 0.35715534829495776, 'recall': 0.291493545624663, 'f1-score': 0.3210010216288431, 'support': 63058}, '1': {'precision': 0.3451534324063629, 'recall': 0.6593482096847234, 'f1-score': 0.4531128435985899, 'support': 64039}, '2': {'precision': 0.38743588119815087, 'recall': 0.09789896468404462, 'f1-score': 0.15630269275969547, 'support': 62493}, 'accuracy': 0.3519331188353816, 'macro avg': {'precision': 0.36324822063315715, 'recall': 0.34958023999781035, 'f1-score': 0.3101388526623761, 'support': 189590}, 'weighted avg': {'precision': 0.36308251033477806, 'recall': 0.3519331188353816, 'f1-score': 0.3113370957946798, 'support': 189590}}
[[18381 39900  4777]
 [16919 42224  4896]
 [16165 40210  6118]]
testing model on single stock: results/universal/W6/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 161s - 161s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080354
{'0': {'precision': 0.29354604595995093, 'recall': 0.40484126352929267, 'f1-score': 0.34032563460342974, 'support': 2212976}, '1': {'precision': 0.40572852631978035, 'recall': 0.585735997693364, 'f1-score': 0.4793914404413409, 'support': 3069405}, '2': {'precision': 0.29556063164167246, 'recall': 0.0040017516628022215, 'f1-score': 0.007896587255608675, 'support': 2231023}, 'accuracy': 0.3597161819063636, 'macro avg': {'precision': 0.33161173464046795, 'recall': 0.3315263376284863, 'f1-score': 0.2758712207667931, 'support': 7513404}, 'weighted avg': {'precision': 0.3399734779362234, 'recall': 0.3597161819063636, 'f1-score': 0.29842617455400816, 'support': 7513404}}
[[ 895904 1307840    9232]
 [1259497 1797861   12047]
 [ 896604 1325491    8928]]
Evaluating performance on  train set...
5452/5452 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1322174
{'0': {'precision': 0.335619065151027, 'recall': 0.2818464260332415, 'f1-score': 0.3063913218535008, 'support': 465743}, '1': {'precision': 0.35208815842330526, 'recall': 0.6110203826946125, 'f1-score': 0.44674724004074556, 'support': 464757}, '2': {'precision': 0.3594347968959329, 'recall': 0.15290714554545942, 'f1-score': 0.21454479616162225, 'support': 464975}, 'accuracy': 0.3485135885630341, 'macro avg': {'precision': 0.34904734015675504, 'recall': 0.34859131809110444, 'f1-score': 0.3225611193519562, 'support': 1395475}, 'weighted avg': {'precision': 0.3490394748681712, 'recall': 0.3485135885630341, 'f1-score': 0.32253282004255335, 'support': 1395475}}
[[131268 260284  74191]
 [128265 283976  52516]
 [131589 262288  71098]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1255103
{'0': {'precision': 0.30155785928058537, 'recall': 0.166272423248022, 'f1-score': 0.21435446949291015, 'support': 159377}, '1': {'precision': 0.3978057081336832, 'recall': 0.5921411928433615, 'f1-score': 0.475898548299288, 'support': 189698}, '2': {'precision': 0.3391796259070223, 'recall': 0.292848478591891, 'f1-score': 0.3143158878828275, 'support': 154988}, 'accuracy': 0.3654622537262207, 'macro avg': {'precision': 0.34618106444043034, 'recall': 0.3504206982277582, 'f1-score': 0.3348563018916752, 'support': 504063}, 'weighted avg': {'precision': 0.3493474149465104, 'recall': 0.3654622537262207, 'f1-score': 0.3435192940779893, 'support': 504063}}
[[ 26500  85360  47517]
 [ 36458 112328  40912]
 [ 24919  84681  45388]]
training model: results/universal/W6/deepOF_L1/h50
Epoch 1/50
9426/9426 - 143s - loss: 3.1272 - accuracy50: 0.4537 - val_loss: 3.2299 - val_accuracy50: 0.3947 - 143s/epoch - 15ms/step
Epoch 2/50
9426/9426 - 135s - loss: 3.1184 - accuracy50: 0.4566 - val_loss: 3.2292 - val_accuracy50: 0.4063 - 135s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 137s - loss: 3.1098 - accuracy50: 0.4604 - val_loss: 3.2271 - val_accuracy50: 0.4081 - 137s/epoch - 15ms/step
Epoch 4/50
9426/9426 - 134s - loss: 3.1028 - accuracy50: 0.4621 - val_loss: 3.2272 - val_accuracy50: 0.4089 - 134s/epoch - 14ms/step
Epoch 5/50
9426/9426 - 134s - loss: 3.0970 - accuracy50: 0.4639 - val_loss: 3.2416 - val_accuracy50: 0.4079 - 134s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 135s - loss: 3.0933 - accuracy50: 0.4662 - val_loss: 3.2444 - val_accuracy50: 0.4090 - 135s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 134s - loss: 3.0896 - accuracy50: 0.4669 - val_loss: 3.2562 - val_accuracy50: 0.4071 - 134s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 135s - loss: 3.0851 - accuracy50: 0.4687 - val_loss: 3.2677 - val_accuracy50: 0.4065 - 135s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 137s - loss: 3.0845 - accuracy50: 0.4682 - val_loss: 3.2869 - val_accuracy50: 0.4054 - 137s/epoch - 15ms/step
Epoch 10/50
9426/9426 - 139s - loss: 3.0800 - accuracy50: 0.4696 - val_loss: 3.3323 - val_accuracy50: 0.4034 - 139s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 135s - loss: 3.0769 - accuracy50: 0.4700 - val_loss: 3.3312 - val_accuracy50: 0.4046 - 135s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 135s - loss: 3.0722 - accuracy50: 0.4717 - val_loss: 3.3425 - val_accuracy50: 0.4028 - 135s/epoch - 14ms/step
Epoch 13/50
9426/9426 - 136s - loss: 3.0699 - accuracy50: 0.4724 - val_loss: 3.3577 - val_accuracy50: 0.4053 - 136s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 255s - 255s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.074776
{'0': {'precision': 0.403757522720432, 'recall': 0.22774568967509448, 'f1-score': 0.29122270059294414, 'support': 3245405}, '1': {'precision': 0.4083966851678944, 'recall': 0.6892323001524652, 'f1-score': 0.512887670528773, 'support': 4343286}, '2': {'precision': 0.3998663465255826, 'recall': 0.2052643523215641, 'f1-score': 0.2712746413002472, 'support': 3229913}, 'accuracy': 0.40630436237429524, 'macro avg': {'precision': 0.40400685147130294, 'recall': 0.3740807807163746, 'f1-score': 0.35846167080732144, 'support': 10818604}, 'weighted avg': {'precision': 0.40445826458442435, 'recall': 0.40630436237429524, 'f1-score': 0.37425780055394225, 'support': 10818604}}
[[ 739127 2153047  353231]
 [ 707951 2993533  641802]
 [ 383543 2183384  662986]]
Evaluating performance on  train set...
9426/9426 - 56s - 56s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779407
{'0': {'precision': 0.4344365784371195, 'recall': 0.25157552945231504, 'f1-score': 0.31863464500654415, 'support': 765933}, '1': {'precision': 0.37798481136912404, 'recall': 0.6827436165052112, 'f1-score': 0.48658395554713857, 'support': 884351}, '2': {'precision': 0.43314990936539616, 'recall': 0.21107065701018235, 'f1-score': 0.28383209330934184, 'support': 761906}, 'accuracy': 0.39685555449612175, 'macro avg': {'precision': 0.4151904330572132, 'recall': 0.3817966009892362, 'f1-score': 0.36301689795434156, 'support': 2412190}, 'weighted avg': {'precision': 0.4133339714517206, 'recall': 0.39685555449612175, 'f1-score': 0.3692151829295422, 'support': 2412190}}
[[192690 490480  82763]
 [152874 603785 127692]
 [ 97976 503114 160816]]
Evaluating performance on  val set...
3323/3323 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0722549
{'0': {'precision': 0.4205630156932535, 'recall': 0.2378516039009066, 'f1-score': 0.3038559134233712, 'support': 262298}, '1': {'precision': 0.3989175895201395, 'recall': 0.6918482069452998, 'f1-score': 0.506048906048906, 'support': 329633}, '2': {'precision': 0.43226603821382237, 'recall': 0.2179457902905557, 'f1-score': 0.28978421857068604, 'support': 258367}, 'accuracy': 0.4078029114498682, 'macro avg': {'precision': 0.4172488811424051, 'recall': 0.38254853371225406, 'f1-score': 0.36656301268098773, 'support': 850298}, 'weighted avg': {'precision': 0.41572780269010606, 'recall': 0.4078029114498682, 'f1-score': 0.37796383929657, 'support': 850298}}
[[ 62388 172032  27878]
 [ 55498 228056  46079]
 [ 30458 171599  56310]]
testing model out of sample: results/universal/W6/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 89s - 89s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0760764
{'0': {'precision': 0.4115731416989287, 'recall': 0.273543992974029, 'f1-score': 0.32865434210730327, 'support': 1394825}, '1': {'precision': 0.3885055056264368, 'recall': 0.6556788095125526, 'f1-score': 0.48791161430979185, 'support': 1692080}, '2': {'precision': 0.43397403041175464, 'recall': 0.2179968288093445, 'f1-score': 0.2902122420882302, 'support': 1398213}, 'accuracy': 0.40039370201631264, 'macro avg': {'precision': 0.4113508925790401, 'recall': 0.38240654376530875, 'f1-score': 0.36892606616844176, 'support': 4485118}, 'weighted avg': {'precision': 0.40985388440498116, 'recall': 0.40039370201631264, 'f1-score': 0.3767524748998895, 'support': 4485118}}
[[ 381546  860188  153091]
 [ 338156 1109461  244463]
 [ 207341  886066  304806]]
Evaluating performance on  train set...
5152/5152 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0744212
{'0': {'precision': 0.4190769042081149, 'recall': 0.23680628090827635, 'f1-score': 0.3026149941089489, 'support': 404018}, '1': {'precision': 0.40184258184140026, 'recall': 0.6900182408771228, 'f1-score': 0.5079012007067965, 'support': 512585}, '2': {'precision': 0.42000618649915533, 'recall': 0.21954344078585697, 'f1-score': 0.28835793002277255, 'support': 402007}, 'accuracy': 0.4077210092445833, 'macro avg': {'precision': 0.41364189084955677, 'recall': 0.38212265419041874, 'f1-score': 0.36629137494617264, 'support': 1318610}, 'weighted avg': {'precision': 0.41266069536367406, 'recall': 0.4077210092445833, 'f1-score': 0.3780695945191279, 'support': 1318610}}
[[ 95674 263786  44558]
 [ 81573 353693  77319]
 [ 51050 262699  88258]]
Evaluating performance on  val set...
1795/1795 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723734
{'0': {'precision': 0.40901735804648426, 'recall': 0.24177910465065724, 'f1-score': 0.30391022780059934, 'support': 138002}, '1': {'precision': 0.41485553566862693, 'recall': 0.6861841427510261, 'f1-score': 0.5170881589242703, 'support': 184433}, '2': {'precision': 0.40541139021521, 'recall': 0.21467307664121243, 'f1-score': 0.28070662980513533, 'support': 136454}, 'accuracy': 0.4123306507673969, 'macro avg': {'precision': 0.4097614279767738, 'recall': 0.38087877468096526, 'f1-score': 0.3672350055100016, 'support': 458889}, 'weighted avg': {'precision': 0.4102915308397653, 'recall': 0.4123306507673969, 'f1-score': 0.3826892388687639, 'support': 458889}}
[[ 33366  89562  15074]
 [ 29990 126555  27888]
 [ 18220  88941  29293]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1146758
{'0': {'precision': 0.3960882196489218, 'recall': 0.10603687191227859, 'f1-score': 0.167288815152772, 'support': 91289}, '1': {'precision': 0.3013133923032964, 'recall': 0.7575832002947317, 'f1-score': 0.4311468478196298, 'support': 81430}, '2': {'precision': 0.4188511674545194, 'recall': 0.17839602208596442, 'f1-score': 0.25021928417089184, 'support': 98343}, 'accuracy': 0.32802089558846315, 'macro avg': {'precision': 0.37208425980224585, 'recall': 0.34733869809765827, 'f1-score': 0.2828849823810979, 'support': 271062}, 'weighted avg': {'precision': 0.37587536201963995, 'recall': 0.32802089558846315, 'f1-score': 0.27664236052140057, 'support': 271062}}
[[ 9680 69694 11915]
 [ 7313 61690 12427]
 [ 7446 73353 17544]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1088266
{'0': {'precision': 0.4162525577316574, 'recall': 0.07706461738283364, 'f1-score': 0.13005160052970455, 'support': 18478}, '1': {'precision': 0.3364909971322458, 'recall': 0.79816002230276, 'f1-score': 0.4734031119268482, 'support': 17935}, '2': {'precision': 0.3791895947973987, 'recall': 0.17280291804399864, 'f1-score': 0.23741288857567924, 'support': 17546}, 'accuracy': 0.3478752386070906, 'macro avg': {'precision': 0.3773110498871006, 'recall': 0.3493425192431974, 'f1-score': 0.28028920034407734, 'support': 53959}, 'weighted avg': {'precision': 0.37768938315475736, 'recall': 0.3478752386070906, 'f1-score': 0.2790864328461382, 'support': 53959}}
[[ 1424 14610  2444]
 [ 1100 14315  2520]
 [  897 13617  3032]]
Evaluating performance on  val set...
81/81 - 1s - 582ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109803
{'0': {'precision': 0.4310455420141116, 'recall': 0.09304901689282748, 'f1-score': 0.15305773829859923, 'support': 7222}, '1': {'precision': 0.3143439081594865, 'recall': 0.7912070840453628, 'f1-score': 0.44993153407836034, 'support': 6437}, '2': {'precision': 0.41704347826086957, 'recall': 0.17185036548659882, 'f1-score': 0.2434023548518067, 'support': 6977}, 'accuracy': 0.3374685016476061, 'macro avg': {'precision': 0.3874776428114892, 'recall': 0.3520354888082631, 'f1-score': 0.28213054240958874, 'support': 20636}, 'weighted avg': {'precision': 0.38990865424862453, 'recall': 0.3374685016476061, 'f1-score': 0.2762071380430289, 'support': 20636}}
[[ 672 5685  865]
 [ 533 5093  811]
 [ 354 5424 1199]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0208675
{'0': {'precision': 0.43016790683521894, 'recall': 0.2301754697571842, 'f1-score': 0.29988670603832707, 'support': 135123}, '1': {'precision': 0.5463258386196714, 'recall': 0.761275114895635, 'f1-score': 0.6361333164334925, 'support': 286782}, '2': {'precision': 0.4460133175936644, 'recall': 0.2835099989072233, 'f1-score': 0.3466626283861428, 'support': 137265}, 'accuracy': 0.5156535579519645, 'macro avg': {'precision': 0.4741690210161849, 'recall': 0.4249868611866809, 'f1-score': 0.4275608836193208, 'support': 559170}, 'weighted avg': {'precision': 0.493631655428253, 'recall': 0.5156535579519645, 'f1-score': 0.4838203441151539, 'support': 559170}}
[[ 31102  92819  11202]
 [ 31327 218320  37135]
 [  9873  88476  38916]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9996615
{'0': {'precision': 0.41135742130680164, 'recall': 0.2541245821501743, 'f1-score': 0.31416637042303586, 'support': 27821}, '1': {'precision': 0.6329236773013781, 'recall': 0.7646877314243397, 'f1-score': 0.6925944764598367, 'support': 81020}, '2': {'precision': 0.38595084210029723, 'recall': 0.2982500911410864, 'f1-score': 0.33647973348139926, 'support': 27430}, 'accuracy': 0.5665622179333828, 'macro avg': {'precision': 0.476743980236159, 'recall': 0.4390208015718668, 'f1-score': 0.447746860121424, 'support': 136271}, 'weighted avg': {'precision': 0.5379756716538759, 'recall': 0.5665622179333828, 'f1-score': 0.5436524731139423, 'support': 136271}}
[[ 7070 18400  2351]
 [ 8400 61955 10665]
 [ 1717 17532  8181]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99272853
{'0': {'precision': 0.433134073441503, 'recall': 0.2571747287293378, 'f1-score': 0.322728429625859, 'support': 9861}, '1': {'precision': 0.6449279489662243, 'recall': 0.7782398020550534, 'f1-score': 0.7053400401787799, 'support': 29099}, '2': {'precision': 0.37444690265486724, 'recall': 0.29304187858456876, 'f1-score': 0.32878042858010076, 'support': 9241}, 'accuracy': 0.5786187008568286, 'macro avg': {'precision': 0.48416964168753146, 'recall': 0.44281880312298666, 'f1-score': 0.4522829661282466, 'support': 48201}, 'weighted avg': {'precision': 0.5497428956371954, 'recall': 0.5786187008568286, 'f1-score': 0.5548717830379375, 'support': 48201}}
[[ 2536  6500   825]
 [ 2754 22646  3699]
 [  565  5968  2708]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008084
{'0': {'precision': 0.4823883787591702, 'recall': 0.2604897245299519, 'f1-score': 0.33829834354539207, 'support': 114350}, '1': {'precision': 0.2743859438534368, 'recall': 0.6541506689242362, 'f1-score': 0.38660780037137915, 'support': 83866}, '2': {'precision': 0.47163381086486267, 'recall': 0.2054749457662079, 'f1-score': 0.28624332726439516, 'support': 112476}, 'accuracy': 0.3468354511863839, 'macro avg': {'precision': 0.40946937782582316, 'recall': 0.37337177974013197, 'f1-score': 0.33704982372705544, 'support': 310692}, 'weighted avg': {'precision': 0.4223483295004691, 'recall': 0.3468354511863839, 'f1-score': 0.3324938197563883, 'support': 310692}}
[[29787 71380 13183]
 [16297 54861 12708]
 [15665 73700 23111]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0916361
{'0': {'precision': 0.4536732884926221, 'recall': 0.19477525071633237, 'f1-score': 0.2725407589544408, 'support': 44672}, '1': {'precision': 0.3385769473605359, 'recall': 0.7410122491041525, 'f1-score': 0.46478728405218006, 'support': 42697}, '2': {'precision': 0.44851096323770046, 'recall': 0.18863985685118487, 'f1-score': 0.2655793298344772, 'support': 43591}, 'accuracy': 0.37082315210751376, 'macro avg': {'precision': 0.41358706636361947, 'recall': 0.3748091188905566, 'f1-score': 0.3343024576136993, 'support': 130960}, 'weighted avg': {'precision': 0.4144300127022741, 'recall': 0.37082315210751376, 'f1-score': 0.332901893845475, 'support': 130960}}
[[ 8701 31272  4699]
 [ 5646 31639  5412]
 [ 4832 30536  8223]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960692
{'0': {'precision': 0.44825878857897344, 'recall': 0.18812772736718156, 'f1-score': 0.26502732240437155, 'support': 14437}, '1': {'precision': 0.3309866072890402, 'recall': 0.7274035693724813, 'f1-score': 0.4549566782941375, 'support': 13896}, '2': {'precision': 0.4402871105681124, 'recall': 0.19462634172686155, 'f1-score': 0.2699311829970507, 'support': 14813}, 'accuracy': 0.3640430167338803, 'macro avg': {'precision': 0.40651083547870864, 'recall': 0.37005254615550814, 'f1-score': 0.3299717278985199, 'support': 43146}, 'weighted avg': {'precision': 0.407752166932012, 'recall': 0.3640430167338803, 'f1-score': 0.32788133474395215, 'support': 43146}}
[[ 2716 10074  1647]
 [ 1770 10108  2018]
 [ 1573 10357  2883]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1113049
{'0': {'precision': 0.4887972591941303, 'recall': 0.1609576390483512, 'f1-score': 0.24217024920012623, 'support': 100163}, '1': {'precision': 0.2772306321042553, 'recall': 0.7425558149906866, 'f1-score': 0.40373005259873407, 'support': 76234}, '2': {'precision': 0.44241435562805875, 'recall': 0.18308949048578896, 'f1-score': 0.258995750254098, 'support': 103687}, 'accuracy': 0.3274517644706588, 'macro avg': {'precision': 0.4028140823088148, 'recall': 0.36220098150827557, 'f1-score': 0.3016320173509861, 'support': 280084}, 'weighted avg': {'precision': 0.4140415631471416, 'recall': 0.3274517644706588, 'f1-score': 0.2923728162159952, 'support': 280084}}
[[16122 72168 11873]
 [ 7573 56608 12053]
 [ 9288 75415 18984]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1014173
{'0': {'precision': 0.4165579682344817, 'recall': 0.14237012561298612, 'f1-score': 0.21221123402259312, 'support': 38133}, '1': {'precision': 0.3392222341915329, 'recall': 0.7434289911337285, 'f1-score': 0.4658705175517182, 'support': 38122}, '2': {'precision': 0.40454874047711725, 'recall': 0.18990811318784587, 'f1-score': 0.25847826473148455, 'support': 38308}, 'accuracy': 0.35827448652706373, 'macro avg': {'precision': 0.3867763143010439, 'recall': 0.3585690766448535, 'f1-score': 0.31218667210193196, 'support': 114563}, 'weighted avg': {'precision': 0.38680802846235274, 'recall': 0.35827448652706373, 'f1-score': 0.3120898738896839, 'support': 114563}}
[[ 5429 27771  4933]
 [ 4006 28341  5775]
 [ 3598 27435  7275]]
Evaluating performance on  val set...
136/136 - 1s - 892ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1050664
{'0': {'precision': 0.41712926249008725, 'recall': 0.13384223918575064, 'f1-score': 0.20265844731265653, 'support': 11790}, '1': {'precision': 0.3202313503305005, 'recall': 0.746765758326452, 'f1-score': 0.44824452705493595, 'support': 10899}, '2': {'precision': 0.43738787226408327, 'recall': 0.20175438596491227, 'f1-score': 0.2761354626798052, 'support': 12084}, 'accuracy': 0.34955281396485777, 'macro avg': {'precision': 0.391582828361557, 'recall': 0.3607874611590383, 'f1-score': 0.3090128123491325, 'support': 34773}, 'weighted avg': {'precision': 0.3937983648362073, 'recall': 0.34955281396485777, 'f1-score': 0.3051672598053298, 'support': 34773}}
[[1578 8688 1524]
 [1148 8139 1612]
 [1057 8589 2438]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1045222
{'0': {'precision': 0.4291702067403002, 'recall': 0.19633348448532745, 'f1-score': 0.2694164185074892, 'support': 154370}, '1': {'precision': 0.2914178659852507, 'recall': 0.6794570024001173, 'f1-score': 0.40789171934685065, 'support': 129577}, '2': {'precision': 0.4579917129507185, 'recall': 0.19872869739300084, 'f1-score': 0.2771836997843534, 'support': 156847}, 'accuracy': 0.3392060690481268, 'macro avg': {'precision': 0.39285992855875645, 'recall': 0.3581730614261485, 'f1-score': 0.3181639458795644, 'support': 440794}, 'weighted avg': {'precision': 0.39893166385307494, 'recall': 0.3392060690481268, 'f1-score': 0.31288681244046984, 'support': 440794}}
[[ 30308 106782  17280]
 [ 21927  88042  19608]
 [ 18385 107292  31170]]
Evaluating performance on  train set...
617/617 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0987765
{'0': {'precision': 0.42033542976939203, 'recall': 0.19097784466500295, 'f1-score': 0.2626304965746696, 'support': 52493}, '1': {'precision': 0.3420872669786939, 'recall': 0.7304206015094625, 'f1-score': 0.465950124296109, 'support': 52734}, '2': {'precision': 0.4202278539874448, 'recall': 0.17139876718824087, 'f1-score': 0.24348646099959587, 'support': 52725}, 'accuracy': 0.36454112641815234, 'macro avg': {'precision': 0.3942168502451769, 'recall': 0.3642657377875688, 'f1-score': 0.3240223606234582, 'support': 157952}, 'weighted avg': {'precision': 0.394175516949625, 'recall': 0.36454112641815234, 'f1-score': 0.32412061998283553, 'support': 157952}}
[[10025 36908  5560]
 [ 7308 38518  6908]
 [ 6517 37171  9037]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0972542
{'0': {'precision': 0.40403173922367575, 'recall': 0.19902810057046272, 'f1-score': 0.2666855403779461, 'support': 18932}, '1': {'precision': 0.34498834498834496, 'recall': 0.7259022148794465, 'f1-score': 0.4677000864879248, 'support': 19369}, '2': {'precision': 0.4261271048343292, 'recall': 0.16391558712912663, 'f1-score': 0.23675871435038479, 'support': 19144}, 'accuracy': 0.3649751936635042, 'macro avg': {'precision': 0.3917157296821166, 'recall': 0.36294863419301193, 'f1-score': 0.32371478040541857, 'support': 57445}, 'weighted avg': {'precision': 0.39148725626269093, 'recall': 0.3649751936635042, 'f1-score': 0.32448920625195676, 'support': 57445}}
[[ 3768 13315  1849]
 [ 2932 14060  2377]
 [ 2626 13380  3138]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/EXC
Evaluating performance on  test set...
4450/4450 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.051052
{'0': {'precision': 0.4564546891950339, 'recall': 0.37757106913074845, 'f1-score': 0.41328240354368617, 'support': 341006}, '1': {'precision': 0.4329092600959251, 'recall': 0.6290621664452932, 'f1-score': 0.512870365857441, 'support': 460007}, '2': {'precision': 0.4766866026171237, 'recall': 0.26591009248660913, 'f1-score': 0.34138524834490525, 'support': 338103}, 'accuracy': 0.4459879415265873, 'macro avg': {'precision': 0.45535018396936094, 'recall': 0.42418110935421693, 'f1-score': 0.42251267258201075, 'support': 1139116}, 'weighted avg': {'precision': 0.4529514537213465, 'recall': 0.4459879415265873, 'f1-score': 0.43215889717198214, 'support': 1139116}}
[[128754 179227  33025]
 [104960 289373  65674]
 [ 48360 199838  89905]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0368503
{'0': {'precision': 0.43144735684756796, 'recall': 0.3829735321673954, 'f1-score': 0.4057678785622699, 'support': 102464}, '1': {'precision': 0.5018510259663221, 'recall': 0.6439254205649014, 'f1-score': 0.5640797276547698, 'support': 179996}, '2': {'precision': 0.44048129957242543, 'recall': 0.27073604408057994, 'f1-score': 0.33535223965486993, 'support': 102358}, 'accuracy': 0.47517787629476793, 'macro avg': {'precision': 0.45792656079543853, 'recall': 0.43254499893762555, 'f1-score': 0.43506661529063656, 'support': 384818}, 'weighted avg': {'precision': 0.46678113836540297, 'recall': 0.47517787629476793, 'f1-score': 0.4610872649266551, 'support': 384818}}
[[ 39241  54200   9023]
 [ 37914 115904  26178]
 [ 13797  60849  27712]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0350734
{'0': {'precision': 0.4282119295381895, 'recall': 0.37037472792517206, 'f1-score': 0.3971989148949593, 'support': 33998}, '1': {'precision': 0.504645280845416, 'recall': 0.6566629193346042, 'f1-score': 0.5707043888900689, 'support': 61377}, '2': {'precision': 0.4423937096850134, 'recall': 0.26741803278688525, 'f1-score': 0.333339246119734, 'support': 35136}, 'accuracy': 0.47729310173088857, 'macro avg': {'precision': 0.4584169733562063, 'recall': 0.43148522668222045, 'f1-score': 0.4337475166349207, 'support': 130511}, 'weighted avg': {'precision': 0.46797517424876905, 'recall': 0.47729310173088857, 'f1-score': 0.46160323449492807, 'support': 130511}}
[[12592 18507  2899]
 [12129 40304  8944]
 [ 4685 21055  9396]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/AAL
Evaluating performance on  test set...
6203/6203 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0371258
{'0': {'precision': 0.3740599886872815, 'recall': 0.3763683953777479, 'f1-score': 0.37521064156616657, 'support': 381286}, '1': {'precision': 0.548778146134465, 'recall': 0.6333541475359658, 'f1-score': 0.5880406394316163, 'support': 816750}, '2': {'precision': 0.3907417671680587, 'recall': 0.26221484584424615, 'f1-score': 0.31382879107451517, 'support': 389833}, 'accuracy': 0.48052830554661624, 'macro avg': {'precision': 0.43785996732993504, 'recall': 0.42397912958598655, 'f1-score': 0.4256933573574327, 'support': 1587869}, 'weighted avg': {'precision': 0.4680250215996212, 'recall': 0.48052830554661624, 'f1-score': 0.4696140399786894, 'support': 1587869}}
[[143504 198637  39145]
 [179218 517292 120240]
 [ 60917 226696 102220]]
Evaluating performance on  train set...
1766/1766 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0423231
{'0': {'precision': 0.3920637372255258, 'recall': 0.2687316388915845, 'f1-score': 0.3188882200528671, 'support': 113351}, '1': {'precision': 0.5227035915188231, 'recall': 0.6694984392735528, 'f1-score': 0.5870636514382469, 'support': 225536}, '2': {'precision': 0.3832240693046125, 'recall': 0.2894290109812382, 'f1-score': 0.3297871268675512, 'support': 113102}, 'accuracy': 0.4738876388584678, 'macro avg': {'precision': 0.4326637993496538, 'recall': 0.40921969638212524, 'f1-score': 0.41191299945288834, 'support': 451989}, 'weighted avg': {'precision': 0.4550391770187552, 'recall': 0.4738876388584678, 'f1-score': 0.4554311497513496, 'support': 451989}}
[[ 30461  69214  13676]
 [ 35531 150996  39009]
 [ 11702  68665  32735]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.02904
{'0': {'precision': 0.3789519616010155, 'recall': 0.2808962333499956, 'f1-score': 0.3226383869769327, 'support': 34009}, '1': {'precision': 0.5780227423621284, 'recall': 0.6754762989691991, 'f1-score': 0.6229612466494026, 'support': 81199}, '2': {'precision': 0.35440051476370915, 'recall': 0.3016674780915287, 'f1-score': 0.32591472434991287, 'support': 32864}, 'accuracy': 0.501884218488303, 'macro avg': {'precision': 0.43712507290895103, 'recall': 0.4193466701369078, 'f1-score': 0.423838119325416, 'support': 148072}, 'weighted avg': {'precision': 0.48266832646513813, 'recall': 0.501884218488303, 'f1-score': 0.48805513986721927, 'support': 148072}}
[[ 9553 20419  4037]
 [12328 54848 14023]
 [ 3328 19622  9914]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/WBA
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.084976
{'0': {'precision': 0.4684740232385358, 'recall': 0.26800647630648966, 'f1-score': 0.3409569494015059, 'support': 456433}, '1': {'precision': 0.32547766833936015, 'recall': 0.6960547523748402, 'f1-score': 0.4435498536230538, 'support': 408238}, '2': {'precision': 0.49577524730892597, 'recall': 0.20668637107174076, 'f1-score': 0.29174543933003283, 'support': 462164}, 'accuracy': 0.3783484758843413, 'macro avg': {'precision': 0.42990897962894065, 'recall': 0.3902491999176902, 'f1-score': 0.35875074745153085, 'support': 1326835}, 'weighted avg': {'precision': 0.4339867636998126, 'recall': 0.3783484758843413, 'f1-score': 0.3553811496169992, 'support': 1326835}}
[[122327 288934  45172]
 [ 72103 284156  51979]
 [ 66688 299953  95523]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0853571
{'0': {'precision': 0.4591181982783266, 'recall': 0.22504826856003987, 'f1-score': 0.3020427354892639, 'support': 128448}, '1': {'precision': 0.34728363324764355, 'recall': 0.7270378874856487, 'f1-score': 0.47004244856301175, 'support': 125424}, '2': {'precision': 0.46347788503097537, 'recall': 0.20233817898783737, 'f1-score': 0.28169723239255473, 'support': 127193}, 'accuracy': 0.38269324131053756, 'macro avg': {'precision': 0.4232932388523152, 'recall': 0.38480811167784196, 'f1-score': 0.35126080548161015, 'support': 381065}, 'weighted avg': {'precision': 0.4237640806152541, 'recall': 0.38269324131053756, 'f1-score': 0.35054729622609887, 'support': 381065}}
[[28907 85803 13738]
 [18182 91188 16054]
 [15873 85584 25736]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0756903
{'0': {'precision': 0.4443281807372176, 'recall': 0.2199100774463878, 'f1-score': 0.2942084212515353, 'support': 42481}, '1': {'precision': 0.3815355475000816, 'recall': 0.7281244806381918, 'f1-score': 0.5007035764541176, 'support': 48136}, '2': {'precision': 0.4581382469918945, 'recall': 0.21597759529121374, 'f1-score': 0.29356259173830995, 'support': 42134}, 'accuracy': 0.40294235071675544, 'macro avg': {'precision': 0.42800065840973117, 'recall': 0.3880040511252645, 'f1-score': 0.3628248631479876, 'support': 132751}, 'weighted avg': {'precision': 0.4259425349648451, 'recall': 0.40294235071675544, 'f1-score': 0.3688793420741375, 'support': 132751}}
[[ 9342 28571  4568]
 [ 6892 35049  6195]
 [ 4791 28243  9100]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0926282
{'0': {'precision': 0.4352366445379477, 'recall': 0.2575184000734473, 'f1-score': 0.32358174863272404, 'support': 653530}, '1': {'precision': 0.3212996838732244, 'recall': 0.6678203553407057, 'f1-score': 0.43386133239317604, 'support': 580457}, '2': {'precision': 0.4639312936429571, 'recall': 0.20386319012851287, 'f1-score': 0.2832563485351202, 'support': 640714}, 'accuracy': 0.36622106671943955, 'macro avg': {'precision': 0.40682254068470974, 'recall': 0.37640064851422195, 'f1-score': 0.34689980985367347, 'support': 1874701}, 'weighted avg': {'precision': 0.40976567985083423, 'recall': 0.36622106671943955, 'f1-score': 0.34394526684320376, 'support': 1874701}}
[[168296 413546  71688]
 [113576 387641  79240]
 [104805 405291 130618]]
Evaluating performance on  train set...
2046/2046 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0870627
{'0': {'precision': 0.4329774387088117, 'recall': 0.2581131730505531, 'f1-score': 0.3234226559088208, 'support': 175024}, '1': {'precision': 0.34570119905475977, 'recall': 0.6822544520764842, 'f1-score': 0.4588839642716762, 'support': 173683}, '2': {'precision': 0.4593434409331698, 'recall': 0.20112201002039498, 'f1-score': 0.2797544549734788, 'support': 175043}, 'accuracy': 0.37971742243436757, 'macro avg': {'precision': 0.4126740262322471, 'recall': 0.38049654504914404, 'f1-score': 0.3540203583846586, 'support': 523750}, 'weighted avg': {'precision': 0.4128471952635107, 'recall': 0.37971742243436757, 'f1-score': 0.3537491733771946, 'support': 523750}}
[[ 45176 111471  18377]
 [ 32127 118496  23060]
 [ 27035 112803  35205]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0888056
{'0': {'precision': 0.425446113519508, 'recall': 0.26623765811804045, 'f1-score': 0.3275189662197559, 'support': 63402}, '1': {'precision': 0.34697545235469507, 'recall': 0.668560725303784, 'f1-score': 0.4568506079689374, 'support': 63532}, '2': {'precision': 0.4459798538128659, 'recall': 0.19573544433094994, 'f1-score': 0.2720647773279352, 'support': 62656}, 'accuracy': 0.37775726567856954, 'macro avg': {'precision': 0.4061338065623563, 'recall': 0.3768446092509248, 'f1-score': 0.3521447838388762, 'support': 189590}, 'weighted avg': {'precision': 0.4059364557669775, 'recall': 0.37775726567856954, 'f1-score': 0.3525316789387974, 'support': 189590}}
[[16880 39852  6670]
 [12492 42475  8565]
 [10304 40088 12264]]
testing model on single stock: results/universal/W6/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 148s - 148s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0792171
{'0': {'precision': 0.3731019302662054, 'recall': 0.19940705388940108, 'f1-score': 0.25990563912132875, 'support': 2212680}, '1': {'precision': 0.41374682390234974, 'recall': 0.6891702348149517, 'f1-score': 0.5170687923067298, 'support': 3112025}, '2': {'precision': 0.3658692004271362, 'recall': 0.19176550033947184, 'f1-score': 0.25163817883735845, 'support': 2188694}, 'accuracy': 0.40003931642656004, 'macro avg': {'precision': 0.3842393181985638, 'recall': 0.3601142630146082, 'f1-score': 0.34287087008847233, 'support': 7513399}, 'weighted avg': {'precision': 0.38782997714826645, 'recall': 0.40003931642656004, 'f1-score': 0.364013409928261, 'support': 7513399}}
[[ 441224 1519290  252166]
 [ 492017 2144715  475293]
 [ 249342 1519636  419716]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0930402
{'0': {'precision': 0.43070099790563016, 'recall': 0.23849897775797488, 'f1-score': 0.30699865946040883, 'support': 469067}, '1': {'precision': 0.33207377320325593, 'recall': 0.6659076228443916, 'f1-score': 0.4431554692271842, 'support': 459789}, '2': {'precision': 0.42952263305164845, 'recall': 0.19672450853698, 'f1-score': 0.26985393874452285, 'support': 466617}, 'accuracy': 0.365355689432902, 'macro avg': {'precision': 0.3974324680535115, 'recall': 0.36704370304644884, 'f1-score': 0.34000268914403864, 'support': 1395473}, 'weighted avg': {'precision': 0.39781067463047515, 'recall': 0.365355689432902, 'f1-score': 0.33944002182254074, 'support': 1395473}}
[[111872 304347  52848]
 [ 84541 306177  69071]
 [ 63331 311491  91795]]
Evaluating performance on  val set...
1969/1969 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0863631
{'0': {'precision': 0.41222875226039785, 'recall': 0.22217484528044443, 'f1-score': 0.2887337323074, 'support': 164168}, '1': {'precision': 0.35987228314496866, 'recall': 0.6783013735135075, 'f1-score': 0.4702524715033785, 'support': 180122}, '2': {'precision': 0.42897701134317373, 'recall': 0.2042723380817665, 'f1-score': 0.2767571326207426, 'support': 159772}, 'accuracy': 0.37949299887712223, 'macro avg': {'precision': 0.4003593489161801, 'recall': 0.36824951895857283, 'f1-score': 0.34524777881050706, 'support': 504062}, 'weighted avg': {'precision': 0.398828319218756, 'recall': 0.37949299887712223, 'f1-score': 0.34980160303822555, 'support': 504062}}
[[ 36474 109591  18103]
 [ 32604 122177  25341]
 [ 19402 107733  32637]]
training model: results/universal/W6/deepOF_L1/h100
Epoch 1/50
9426/9426 - 139s - loss: 3.2213 - accuracy100: 0.4125 - val_loss: 3.2603 - val_accuracy100: 0.3742 - 139s/epoch - 15ms/step
Epoch 2/50
9426/9426 - 136s - loss: 3.2145 - accuracy100: 0.4157 - val_loss: 3.2542 - val_accuracy100: 0.3804 - 136s/epoch - 14ms/step
Epoch 3/50
9426/9426 - 136s - loss: 3.2103 - accuracy100: 0.4171 - val_loss: 3.2507 - val_accuracy100: 0.3866 - 136s/epoch - 14ms/step
Epoch 4/50
9426/9426 - 138s - loss: 3.2065 - accuracy100: 0.4191 - val_loss: 3.2504 - val_accuracy100: 0.3874 - 138s/epoch - 15ms/step
Epoch 5/50
9426/9426 - 138s - loss: 3.2034 - accuracy100: 0.4201 - val_loss: 3.2483 - val_accuracy100: 0.3880 - 138s/epoch - 15ms/step
Epoch 6/50
9426/9426 - 133s - loss: 3.2001 - accuracy100: 0.4215 - val_loss: 3.2467 - val_accuracy100: 0.3893 - 133s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 137s - loss: 3.1974 - accuracy100: 0.4225 - val_loss: 3.2469 - val_accuracy100: 0.3882 - 137s/epoch - 15ms/step
Epoch 8/50
9426/9426 - 135s - loss: 3.1953 - accuracy100: 0.4237 - val_loss: 3.2454 - val_accuracy100: 0.3890 - 135s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 146s - loss: 3.1930 - accuracy100: 0.4244 - val_loss: 3.2450 - val_accuracy100: 0.3891 - 146s/epoch - 16ms/step
Epoch 10/50
9426/9426 - 138s - loss: 3.1909 - accuracy100: 0.4254 - val_loss: 3.2453 - val_accuracy100: 0.3891 - 138s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 132s - loss: 3.1894 - accuracy100: 0.4262 - val_loss: 3.2439 - val_accuracy100: 0.3896 - 132s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 131s - loss: 3.1873 - accuracy100: 0.4269 - val_loss: 3.2455 - val_accuracy100: 0.3887 - 131s/epoch - 14ms/step
Epoch 13/50
9426/9426 - 132s - loss: 3.1856 - accuracy100: 0.4279 - val_loss: 3.2436 - val_accuracy100: 0.3899 - 132s/epoch - 14ms/step
Epoch 14/50
9426/9426 - 135s - loss: 3.1838 - accuracy100: 0.4286 - val_loss: 3.2437 - val_accuracy100: 0.3898 - 135s/epoch - 14ms/step
Epoch 15/50
9426/9426 - 135s - loss: 3.1820 - accuracy100: 0.4293 - val_loss: 3.2461 - val_accuracy100: 0.3886 - 135s/epoch - 14ms/step
Epoch 16/50
9426/9426 - 136s - loss: 3.1805 - accuracy100: 0.4298 - val_loss: 3.2472 - val_accuracy100: 0.3887 - 136s/epoch - 14ms/step
Epoch 17/50
9426/9426 - 131s - loss: 3.1789 - accuracy100: 0.4307 - val_loss: 3.2475 - val_accuracy100: 0.3896 - 131s/epoch - 14ms/step
Epoch 18/50
9426/9426 - 131s - loss: 3.1770 - accuracy100: 0.4313 - val_loss: 3.2487 - val_accuracy100: 0.3888 - 131s/epoch - 14ms/step
Epoch 19/50
9426/9426 - 136s - loss: 3.1749 - accuracy100: 0.4322 - val_loss: 3.2455 - val_accuracy100: 0.3910 - 136s/epoch - 14ms/step
Epoch 20/50
9426/9426 - 131s - loss: 3.1732 - accuracy100: 0.4332 - val_loss: 3.2466 - val_accuracy100: 0.3913 - 131s/epoch - 14ms/step
Epoch 21/50
9426/9426 - 131s - loss: 3.1714 - accuracy100: 0.4339 - val_loss: 3.2492 - val_accuracy100: 0.3894 - 131s/epoch - 14ms/step
Epoch 22/50
9426/9426 - 131s - loss: 3.1699 - accuracy100: 0.4346 - val_loss: 3.2450 - val_accuracy100: 0.3926 - 131s/epoch - 14ms/step
Epoch 23/50
9426/9426 - 131s - loss: 3.1677 - accuracy100: 0.4355 - val_loss: 3.2499 - val_accuracy100: 0.3885 - 131s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 268s - 268s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0848057
{'0': {'precision': 0.3767282440181557, 'recall': 0.3619319643252361, 'f1-score': 0.3691819102590699, 'support': 3343540}, '1': {'precision': 0.39768859590862404, 'recall': 0.3960931039053211, 'f1-score': 0.39688924644676865, 'support': 4126959}, '2': {'precision': 0.3694263872067991, 'recall': 0.38574297998420004, 'f1-score': 0.3774084110853646, 'support': 3348105}, 'accuracy': 0.38233232309824816, 'macro avg': {'precision': 0.3812810757111929, 'recall': 0.3812560160715857, 'f1-score': 0.381159855930401, 'support': 10818604}, 'weighted avg': {'precision': 0.38246420861933234, 'recall': 0.38233232309824816, 'f1-score': 0.38229730194868816, 'support': 10818604}}
[[1210134 1235323  898083]
 [1185908 1634660 1306391]
 [ 816178 1240419 1291508]]
Evaluating performance on  train set...
9426/9426 - 62s - 62s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0857306
{'0': {'precision': 0.4065380749404701, 'recall': 0.37638720240465007, 'f1-score': 0.39088207553264337, 'support': 803776}, '1': {'precision': 0.3606951819627226, 'recall': 0.3890582461339013, 'f1-score': 0.3743402287325858, 'support': 809925}, '2': {'precision': 0.402132140335065, 'recall': 0.40007939996668707, 'f1-score': 0.40110314382177936, 'support': 798489}, 'accuracy': 0.38848432337419525, 'macro avg': {'precision': 0.38978846574608594, 'recall': 0.3885082828350795, 'f1-score': 0.38877514936233615, 'support': 2412190}, 'weighted avg': {'precision': 0.3896872483421767, 'recall': 0.38848432337419525, 'f1-score': 0.3887113324848682, 'support': 2412190}}
[[302531 280851 220394]
 [240257 315108 254560]
 [201376 277654 319459]]
Evaluating performance on  val set...
3323/3323 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0814388
{'0': {'precision': 0.3865891421408796, 'recall': 0.36685614341932665, 'f1-score': 0.3764642356694558, 'support': 269866}, '1': {'precision': 0.3943474636334968, 'recall': 0.40375941051420167, 'f1-score': 0.3989979402807789, 'support': 312815}, '2': {'precision': 0.3879441893066011, 'recall': 0.3970898709723224, 'f1-score': 0.3924637563406784, 'support': 267617}, 'accuracy': 0.38994799470303354, 'macro avg': {'precision': 0.38962693169365914, 'recall': 0.38923514163528355, 'f1-score': 0.3893086440969711, 'support': 850298}, 'weighted avg': {'precision': 0.3898698190271735, 'recall': 0.38994799470303354, 'f1-score': 0.38978971042237964, 'support': 850298}}
[[ 99002  97859  73005]
 [ 91860 126302  94653]
 [ 65229  96120 106268]]
testing model out of sample: results/universal/W6/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 103s - 103s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0852715
{'0': {'precision': 0.3816874516803819, 'recall': 0.4025824731948602, 'f1-score': 0.39185661316638004, 'support': 1433587}, '1': {'precision': 0.37840583776560166, 'recall': 0.3444138698395988, 'f1-score': 0.36061058541566693, 'support': 1601547}, '2': {'precision': 0.389619036934874, 'recall': 0.4071886310469633, 'f1-score': 0.39821012938084294, 'support': 1449984}, 'accuracy': 0.38330072921158376, 'macro avg': {'precision': 0.3832374421269525, 'recall': 0.3847283246938074, 'f1-score': 0.3835591093209633, 'support': 4485118}, 'weighted avg': {'precision': 0.38307983707431686, 'recall': 0.38330072921158376, 'f1-score': 0.3827532885378286, 'support': 4485118}}
[[577137 446841 409609]
 [534608 551595 515344]
 [400322 459245 590417]]
Evaluating performance on  train set...
5152/5152 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894623
{'0': {'precision': 0.3993508810415505, 'recall': 0.3460019189506683, 'f1-score': 0.37076716201095383, 'support': 436697}, '1': {'precision': 0.3545922228834594, 'recall': 0.3808240654549018, 'f1-score': 0.36724030739727026, 'support': 449042}, '2': {'precision': 0.38694949671390205, 'recall': 0.40940372535928715, 'f1-score': 0.39786004775155714, 'support': 432871}, 'accuracy': 0.3786737549389129, 'macro avg': {'precision': 0.38029753354630397, 'recall': 0.37874323658828574, 'f1-score': 0.3786225057199271, 'support': 1318610}, 'weighted avg': {'precision': 0.380037576112937, 'recall': 0.3786737549389129, 'f1-score': 0.3784601255816707, 'support': 1318610}}
[[151098 158755 126844]
 [124109 171006 153927]
 [103152 152500 177219]]
Evaluating performance on  val set...
1795/1795 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0870591
{'0': {'precision': 0.39051992162973836, 'recall': 0.3506469689251146, 'f1-score': 0.36951091196701713, 'support': 147225}, '1': {'precision': 0.3769867432715628, 'recall': 0.3863197644958135, 'f1-score': 0.3815961960148727, 'support': 165772}, '2': {'precision': 0.3756854992985589, 'recall': 0.4038261179502646, 'f1-score': 0.3892478659584028, 'support': 145892}, 'accuracy': 0.38044058584973706, 'macro avg': {'precision': 0.38106405473328664, 'recall': 0.38026428379039756, 'f1-score': 0.38011832464676426, 'support': 458889}, 'weighted avg': {'precision': 0.38091488514916916, 'recall': 0.38044058584973706, 'f1-score': 0.38015153616784203, 'support': 458889}}
[[51624 53826 41775]
 [45601 64041 56130]
 [34968 52009 58915]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101942
{'0': {'precision': 0.3456474923961548, 'recall': 0.18231106114897305, 'f1-score': 0.23871328799993866, 'support': 85398}, '1': {'precision': 0.3300156757445979, 'recall': 0.48693034682720615, 'f1-score': 0.3934033412461051, 'support': 90362}, '2': {'precision': 0.38309670737496226, 'recall': 0.37260498205703974, 'f1-score': 0.37777801419194235, 'support': 95302}, 'accuracy': 0.3507647696836886, 'macro avg': {'precision': 0.3529199585052383, 'recall': 0.34728213001107305, 'f1-score': 0.336631547812662, 'support': 271062}, 'weighted avg': {'precision': 0.35360309985733457, 'recall': 0.3507647696836886, 'f1-score': 0.33917461834864276, 'support': 271062}}
[[15569 43126 26703]
 [15883 44000 30479]
 [13591 46201 35510]]
Evaluating performance on  train set...
211/211 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108217
{'0': {'precision': 0.3958362638908426, 'recall': 0.15040889411513175, 'f1-score': 0.21798745061584937, 'support': 18709}, '1': {'precision': 0.31887811736846, 'recall': 0.4967433281457144, 'f1-score': 0.3884169014084507, 'support': 17349}, '2': {'precision': 0.35411622276029053, 'recall': 0.39215686274509803, 'f1-score': 0.3721669980119285, 'support': 17901}, 'accuracy': 0.3419633425378528, 'macro avg': {'precision': 0.3562768680065311, 'recall': 0.34643636166864805, 'f1-score': 0.3261904500120762, 'support': 53959}, 'weighted avg': {'precision': 0.35725183237256336, 'recall': 0.3419633425378528, 'f1-score': 0.32393360639594265, 'support': 53959}}
[[2814 9561 6334]
 [2261 8618 6470]
 [2034 8847 7020]]
Evaluating performance on  val set...
81/81 - 1s - 708ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0975162
{'0': {'precision': 0.36655353286022835, 'recall': 0.18041002277904328, 'f1-score': 0.241807449623448, 'support': 6585}, '1': {'precision': 0.34905570845591727, 'recall': 0.5052891880752851, 'f1-score': 0.41288729232150884, 'support': 7279}, '2': {'precision': 0.35710119568387283, 'recall': 0.36163614884819845, 'f1-score': 0.35935436537050625, 'support': 6772}, 'accuracy': 0.35447761194029853, 'macro avg': {'precision': 0.35757014566667283, 'recall': 0.3491117865675089, 'f1-score': 0.33801636910515437, 'support': 20636}, 'weighted avg': {'precision': 0.35727955092587765, 'recall': 0.35447761194029853, 'f1-score': 0.3407276806972154, 'support': 20636}}
[[1188 3381 2016]
 [1208 3678 2393]
 [ 845 3478 2449]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0571661
{'0': {'precision': 0.4391085665364653, 'recall': 0.3739597514225987, 'f1-score': 0.40392406581946716, 'support': 175559}, '1': {'precision': 0.43880755775834795, 'recall': 0.47074881460641, 'f1-score': 0.4542173392024489, 'support': 203308}, '2': {'precision': 0.43445348758294133, 'recall': 0.46155638009350924, 'f1-score': 0.44759502385344785, 'support': 180303}, 'accuracy': 0.4373964983815298, 'macro avg': {'precision': 0.4374565372925849, 'recall': 0.435421648707506, 'f1-score': 0.43524547629178795, 'support': 559170}, 'weighted avg': {'precision': 0.43749810425626656, 'recall': 0.4373964983815298, 'f1-score': 0.43629173499225554, 'support': 559170}}
[[65652 61014 48893]
 [48163 95707 59438]
 [35697 61386 83220]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0354443
{'0': {'precision': 0.44101943254485626, 'recall': 0.37379956323835084, 'f1-score': 0.4046367895643753, 'support': 38007}, '1': {'precision': 0.5431579988135258, 'recall': 0.536946535040563, 'f1-score': 0.5400344064880805, 'support': 61386}, '2': {'precision': 0.40797270191132734, 'recall': 0.4798253701393785, 'f1-score': 0.44099138951539546, 'support': 36878}, 'accuracy': 0.47598535271627856, 'macro avg': {'precision': 0.46405004442323644, 'recall': 0.46352382280609744, 'f1-score': 0.4618875285226171, 'support': 136271}, 'weighted avg': {'precision': 0.4780866052864173, 'recall': 0.47598535271627856, 'f1-score': 0.4754677297458687, 'support': 136271}}
[[14207 14210  9590]
 [12337 32961 16088]
 [ 5670 13513 17695]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0200533
{'0': {'precision': 0.45561059249380836, 'recall': 0.35803578112134143, 'f1-score': 0.40097246091293964, 'support': 13359}, '1': {'precision': 0.5649134771119256, 'recall': 0.5892237930114698, 'f1-score': 0.5768126033597354, 'support': 22494}, '2': {'precision': 0.4103644406993891, 'recall': 0.47327502429543244, 'f1-score': 0.4395802775583888, 'support': 12348}, 'accuracy': 0.49544615256944874, 'macro avg': {'precision': 0.4769628367683744, 'recall': 0.47351153280941455, 'f1-score': 0.47245511394368794, 'support': 48201}, 'weighted avg': {'precision': 0.49502802375545113, 'recall': 0.49544615256944874, 'f1-score': 0.4929223682620865, 'support': 48201}}
[[ 4783  5518  3058]
 [ 3901 13254  5339]
 [ 1814  4690  5844]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1059953
{'0': {'precision': 0.4276378029816988, 'recall': 0.33979349375729034, 'f1-score': 0.3786880825822356, 'support': 115735}, '1': {'precision': 0.2553198191812755, 'recall': 0.403103474000945, 'f1-score': 0.31262656457927523, 'support': 80426}, '2': {'precision': 0.42994779462251914, 'recall': 0.34443949673014296, 'f1-score': 0.3824727075294254, 'support': 114531}, 'accuracy': 0.35789463520142134, 'macro avg': {'precision': 0.37096847226183116, 'recall': 0.36244548816279276, 'f1-score': 0.3579291182303121, 'support': 310692}, 'weighted avg': {'precision': 0.3838829573065027, 'recall': 0.35789463520142134, 'f1-score': 0.3629824745618183, 'support': 310692}}
[[39326 47928 28481]
 [24183 32420 23823]
 [28452 46630 39449]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946815
{'0': {'precision': 0.3993654116646495, 'recall': 0.27790676500045525, 'f1-score': 0.3277451914687999, 'support': 43932}, '1': {'precision': 0.34471804225566194, 'recall': 0.512265088543549, 'f1-score': 0.4121131725754575, 'support': 44272}, '2': {'precision': 0.38232318853146047, 'recall': 0.30938347834222096, 'f1-score': 0.34200762717342126, 'support': 42756}, 'accuracy': 0.36740989615149666, 'macro avg': {'precision': 0.37546888081725727, 'recall': 0.36651844396207506, 'f1-score': 0.36062199707255954, 'support': 130960}, 'weighted avg': {'precision': 0.3753274945085917, 'recall': 0.36740989615149666, 'f1-score': 0.3609228331955923, 'support': 130960}}
[[12209 21862  9861]
 [10083 22679 11510]
 [ 8279 21249 13228]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09589
{'0': {'precision': 0.40308747855917665, 'recall': 0.26564928642079977, 'f1-score': 0.3202452942679499, 'support': 14154}, '1': {'precision': 0.34260035391636395, 'recall': 0.5080450245148815, 'f1-score': 0.4092337644277569, 'support': 14481}, '2': {'precision': 0.3880427738172391, 'recall': 0.3300944111363793, 'f1-score': 0.3567305902066654, 'support': 14511}, 'accuracy': 0.36867844064339683, 'macro avg': {'precision': 0.37791020209759324, 'recall': 0.3679295740240202, 'f1-score': 0.36206988296745735, 'support': 43146}, 'weighted avg': {'precision': 0.3777264308962919, 'recall': 0.36867844064339683, 'f1-score': 0.3623831556166465, 'support': 43146}}
[[3760 7015 3379]
 [2949 7357 4175]
 [2619 7102 4790]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1079555
{'0': {'precision': 0.4272981452068101, 'recall': 0.3289443102699098, 'f1-score': 0.371725476761448, 'support': 98959}, '1': {'precision': 0.2723883887414723, 'recall': 0.4460811343048444, 'f1-score': 0.3382393198978652, 'support': 76170}, '2': {'precision': 0.43677522043404665, 'recall': 0.3294364251345815, 'f1-score': 0.37558726244724827, 'support': 104955}, 'accuracy': 0.36098456177432486, 'macro avg': {'precision': 0.3788205847941097, 'recall': 0.3681539565697786, 'f1-score': 0.3618506863688538, 'support': 280084}, 'weighted avg': {'precision': 0.3887211121756831, 'recall': 0.36098456177432486, 'f1-score': 0.3640658930235482, 'support': 280084}}
[[32552 44609 21798]
 [19404 33978 22788]
 [24225 46154 34576]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1037335
{'0': {'precision': 0.38634658664666166, 'recall': 0.2827377062037594, 'f1-score': 0.3265201376728458, 'support': 38251}, '1': {'precision': 0.34028066246455596, 'recall': 0.4975572398130298, 'f1-score': 0.4041571925007508, 'support': 37867}, '2': {'precision': 0.38072497676356526, 'recall': 0.3089868643516712, 'f1-score': 0.3411251184561927, 'support': 38445}, 'accuracy': 0.3625516091582797, 'macro avg': {'precision': 0.3691174086249276, 'recall': 0.3630939367894868, 'f1-score': 0.35726748287659643, 'support': 114563}, 'weighted avg': {'precision': 0.3692337217342603, 'recall': 0.3625516091582797, 'f1-score': 0.3570829794401184, 'support': 114563}}
[[10815 18526  8910]
 [ 8614 18841 10412]
 [ 8564 18002 11879]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1066731
{'0': {'precision': 0.39470066241719787, 'recall': 0.27074759945130317, 'f1-score': 0.32117976099669465, 'support': 11664}, '1': {'precision': 0.32211046196470516, 'recall': 0.49267618608935976, 'f1-score': 0.38954038895768084, 'support': 10855}, '2': {'precision': 0.4022027731340348, 'recall': 0.333768565366411, 'f1-score': 0.36480399589706997, 'support': 12254}, 'accuracy': 0.3622350674373796, 'macro avg': {'precision': 0.3730046325053126, 'recall': 0.3657307836356913, 'f1-score': 0.3585080486171485, 'support': 34773}, 'weighted avg': {'precision': 0.37468410470898494, 'recall': 0.3622350674373796, 'f1-score': 0.35789290024225023, 'support': 34773}}
[[3158 5550 2956]
 [2384 5348 3123]
 [2459 5705 4090]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1019772
{'0': {'precision': 0.405462381085805, 'recall': 0.38240068454365855, 'f1-score': 0.3935940110608867, 'support': 158938}, '1': {'precision': 0.2823297554108745, 'recall': 0.3308097052468372, 'f1-score': 0.3046531145449229, 'support': 121254}, '2': {'precision': 0.4156873021952547, 'recall': 0.3851944558598274, 'f1-score': 0.3998603852977962, 'support': 160602}, 'accuracy': 0.3692268951029279, 'macro avg': {'precision': 0.36782647956397807, 'recall': 0.36613494855010775, 'f1-score': 0.3660358369678686, 'support': 440794}, 'weighted avg': {'precision': 0.3753163704468939, 'recall': 0.3692268951029279, 'f1-score': 0.37141120632454605, 'support': 440794}}
[[60778 50512 47648]
 [41832 40112 39310]
 [47288 51451 61863]]
Evaluating performance on  train set...
617/617 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015245
{'0': {'precision': 0.3849355080518003, 'recall': 0.2797355173191074, 'f1-score': 0.3240103129793414, 'support': 53236}, '1': {'precision': 0.3346591705868105, 'recall': 0.5072558984367452, 'f1-score': 0.40326594568022617, 'support': 51751}, '2': {'precision': 0.38095238095238093, 'recall': 0.29362786745964314, 'f1-score': 0.3316380385759524, 'support': 52965}, 'accuracy': 0.3589381584278768, 'macro avg': {'precision': 0.36684901986366397, 'recall': 0.3602064277384986, 'f1-score': 0.35297143241184, 'support': 157952}, 'weighted avg': {'precision': 0.36712745834700744, 'recall': 0.35893815842787685, 'f1-score': 0.3525351859415577, 'support': 157952}}
[[14892 26360 11984]
 [12212 26251 13288]
 [11583 25830 15552]]
Evaluating performance on  val set...
225/225 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099745
{'0': {'precision': 0.38573324485733246, 'recall': 0.30429775427943256, 'f1-score': 0.34021010739472685, 'support': 19103}, '1': {'precision': 0.3342440801457195, 'recall': 0.5038546837047206, 'f1-score': 0.40188687192014483, 'support': 18938}, '2': {'precision': 0.3917697258986042, 'recall': 0.27916924345495775, 'f1-score': 0.32602088411423075, 'support': 19404}, 'accuracy': 0.3615980503089912, 'macro avg': {'precision': 0.37058235030055203, 'recall': 0.36244056047970363, 'f1-score': 0.3560392878097008, 'support': 57445}, 'weighted avg': {'precision': 0.3707977426694364, 'recall': 0.3615980503089912, 'f1-score': 0.35575030894486387, 'support': 57445}}
[[5813 9425 3865]
 [4851 9542 4545]
 [4406 9581 5417]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/EXC
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0658534
{'0': {'precision': 0.46524263762811624, 'recall': 0.5045555571910095, 'f1-score': 0.48410227924016697, 'support': 407634}, '1': {'precision': 0.3706574096499018, 'recall': 0.33756080824418877, 'f1-score': 0.3533357703086622, 'support': 326436}, '2': {'precision': 0.46790611108470564, 'recall': 0.4617870562849652, 'f1-score': 0.4648264464863723, 'support': 405046}, 'accuracy': 0.4414923502084072, 'macro avg': {'precision': 0.4346020527875745, 'recall': 0.43463447390672116, 'f1-score': 0.43408816534506717, 'support': 1139116}, 'weighted avg': {'precision': 0.43908446391218325, 'recall': 0.4414923502084072, 'f1-score': 0.439774489038679, 'support': 1139116}}
[[205674  90444 111516]
 [115056 110192 101188]
 [121349  96652 187045]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0654253
{'0': {'precision': 0.4481339525717474, 'recall': 0.48000093127211774, 'f1-score': 0.46352037470725993, 'support': 128856}, '1': {'precision': 0.3929168528910298, 'recall': 0.3753607489345552, 'f1-score': 0.3839382114478659, 'support': 126473}, '2': {'precision': 0.45504338093461505, 'recall': 0.44270169666921516, 'f1-score': 0.4487877056046597, 'support': 129489}, 'accuracy': 0.43305926437952486, 'macro avg': {'precision': 0.43203139546579744, 'recall': 0.4326877922919627, 'f1-score': 0.4320820972532618, 'support': 384818}, 'weighted avg': {'precision': 0.43231146693271794, 'recall': 0.43305926437952486, 'f1-score': 0.4324077096985235, 'support': 384818}}
[[61851 35950 31055]
 [41403 47473 37597]
 [34765 37399 57325]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0625926
{'0': {'precision': 0.4283967566176155, 'recall': 0.477535209583702, 'f1-score': 0.4516333291873495, 'support': 41821}, '1': {'precision': 0.4186236963171713, 'recall': 0.39106270953806, 'f1-score': 0.4043741275011633, 'support': 44443}, '2': {'precision': 0.45655559750802344, 'recall': 0.4372499830496983, 'f1-score': 0.4466942959722014, 'support': 44247}, 'accuracy': 0.4344308142608669, 'macro avg': {'precision': 0.4345253501476034, 'recall': 0.4352826340571534, 'f1-score': 0.4342339175535714, 'support': 130511}, 'weighted avg': {'precision': 0.43461539040285385, 'recall': 0.4344308142608669, 'f1-score': 0.43386564597896227, 'support': 130511}}
[[19971 11751 10099]
 [14133 17380 12930]
 [12514 12386 19347]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/AAL
Evaluating performance on  test set...
6203/6203 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0718005
{'0': {'precision': 0.39205659546165206, 'recall': 0.4711221276268889, 'f1-score': 0.4279682352297779, 'support': 481701}, '1': {'precision': 0.43784052796711026, 'recall': 0.3320653404708531, 'f1-score': 0.3776868574500332, 'support': 609362}, '2': {'precision': 0.40429605356992654, 'recall': 0.44504092140594115, 'f1-score': 0.42369116970718995, 'support': 496806}, 'accuracy': 0.4095973912205604, 'macro avg': {'precision': 0.4113977256662296, 'recall': 0.41607612983456105, 'f1-score': 0.4097820874623337, 'support': 1587869}, 'weighted avg': {'precision': 0.4134561094671087, 'recall': 0.4095973912205604, 'f1-score': 0.40733401871655445, 'support': 1587869}}
[[226940 125044 129717]
 [210956 202348 196058]
 [140949 134758 221099]]
Evaluating performance on  train set...
1766/1766 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0792823
{'0': {'precision': 0.4110772357723577, 'recall': 0.3848954347061622, 'f1-score': 0.397555738352901, 'support': 145029}, '1': {'precision': 0.4017962996227771, 'recall': 0.27333549218840697, 'f1-score': 0.3253444457777438, 'support': 163667}, '2': {'precision': 0.38621086904523644, 'recall': 0.5521414165381421, 'f1-score': 0.45450524199339365, 'support': 143293}, 'accuracy': 0.3975207361241092, 'macro avg': {'precision': 0.39969480148012376, 'recall': 0.4034574478109037, 'f1-score': 0.3924684753746795, 'support': 451989}, 'weighted avg': {'precision': 0.3998332469491279, 'recall': 0.3975207361241092, 'f1-score': 0.38946231042270546, 'support': 451989}}
[[55821 35706 53502]
 [46694 44736 72237]
 [33277 30898 79118]]
Evaluating performance on  val set...
579/579 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0699533
{'0': {'precision': 0.41213123092573756, 'recall': 0.3642555295810106, 'f1-score': 0.38671725849560906, 'support': 44488}, '1': {'precision': 0.4682650983940285, 'recall': 0.34153825848813807, 'f1-score': 0.39498588109593225, 'support': 60614}, '2': {'precision': 0.3667379380868272, 'recall': 0.5508494298347685, 'f1-score': 0.44032294069499217, 'support': 42970}, 'accuracy': 0.4091050299854125, 'macro avg': {'precision': 0.41571142246886444, 'recall': 0.41888107263463903, 'f1-score': 0.40734202676217784, 'support': 148072}, 'weighted avg': {'precision': 0.4219369230851938, 'recall': 0.4091050299854125, 'f1-score': 0.4056582497323283, 'support': 148072}}
[[16205 12617 15666]
 [14706 20702 25206]
 [ 8409 10891 23670]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/WBA
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783234
{'0': {'precision': 0.3830304120928559, 'recall': 0.40948340712057124, 'f1-score': 0.3958154277492547, 'support': 405445}, '1': {'precision': 0.3877088025428928, 'recall': 0.3800498451168939, 'f1-score': 0.38384112196200687, 'support': 495535}, '2': {'precision': 0.3942518330990597, 'recall': 0.3773913656056639, 'f1-score': 0.38563739805014524, 'support': 425855}, 'accuracy': 0.38819069439681647, 'macro avg': {'precision': 0.38833034924493615, 'recall': 0.3889748726143763, 'f1-score': 0.3884313159204689, 'support': 1326835}, 'weighted avg': {'precision': 0.38837923425556337, 'recall': 0.38819069439681647, 'f1-score': 0.3880766716448422, 'support': 1326835}}
[[166023 142681  96741]
 [157019 188328 150188]
 [110404 154737 160714]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0887338
{'0': {'precision': 0.40656770041652684, 'recall': 0.3180379258161154, 'f1-score': 0.35689468439977473, 'support': 129516}, '1': {'precision': 0.35034920023821414, 'recall': 0.46546253746253746, 'f1-score': 0.39978446056795325, 'support': 125125}, '2': {'precision': 0.39475307010589, 'recall': 0.35444219452002784, 'f1-score': 0.3735131575657044, 'support': 126424}, 'accuracy': 0.37852334903494156, 'macro avg': {'precision': 0.3838899902535437, 'recall': 0.3793142192662269, 'f1-score': 0.37673076751114415, 'support': 381065}, 'weighted avg': {'precision': 0.38418833559109455, 'recall': 0.37852334903494156, 'f1-score': 0.37649122854466555, 'support': 381065}}
[[41191 54854 33471]
 [31651 58241 35233]
 [28472 53142 44810]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0848908
{'0': {'precision': 0.39482368758785064, 'recall': 0.2998259658893143, 'f1-score': 0.3408290579127155, 'support': 43095}, '1': {'precision': 0.3668738478604871, 'recall': 0.4805958028807112, 'f1-score': 0.4161046506249248, 'support': 46794}, '2': {'precision': 0.390538656199969, 'recall': 0.35285334328776075, 'f1-score': 0.3707407952149826, 'support': 42862}, 'accuracy': 0.38066756559272624, 'macro avg': {'precision': 0.3840787305494356, 'recall': 0.3777583706859287, 'f1-score': 0.37589150125087434, 'support': 132751}, 'weighted avg': {'precision': 0.3835879920710588, 'recall': 0.38066756559272624, 'f1-score': 0.37702104870468617, 'support': 132751}}
[[12921 19421 10753]
 [11456 22489 12849]
 [ 8349 19389 15124]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 45s - 45s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0869524
{'0': {'precision': 0.3631595832229088, 'recall': 0.39594129922357496, 'f1-score': 0.37884260322120655, 'support': 591815}, '1': {'precision': 0.39197381427908573, 'recall': 0.33301339869141017, 'f1-score': 0.36009609481602284, 'support': 700143}, '2': {'precision': 0.3658853263918215, 'recall': 0.3984672488558421, 'f1-score': 0.38148185569161286, 'support': 582743}, 'accuracy': 0.37322485025612084, 'macro avg': {'precision': 0.3736729079646053, 'recall': 0.37580731559027575, 'f1-score': 0.3734735179096141, 'support': 1874701}, 'weighted avg': {'precision': 0.37476809568748126, 'recall': 0.37322485025612084, 'f1-score': 0.37266176119254785, 'support': 1874701}}
[[234324 180751 176740]
 [241294 233157 225692]
 [169619 180920 232204]]
Evaluating performance on  train set...
2046/2046 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0915172
{'0': {'precision': 0.39208023496348293, 'recall': 0.3698255314549664, 'f1-score': 0.3806278615004508, 'support': 175791}, '1': {'precision': 0.3435312756954054, 'recall': 0.3983535170898182, 'f1-score': 0.36891682707191986, 'support': 172003}, '2': {'precision': 0.39409407830394044, 'recall': 0.3549637409352338, 'f1-score': 0.3735068367813755, 'support': 175956}, 'accuracy': 0.37420143198090694, 'macro avg': {'precision': 0.37656852965427623, 'recall': 0.37438092982667276, 'f1-score': 0.3743505084512487, 'support': 523750}, 'weighted avg': {'precision': 0.37681299138892715, 'recall': 0.37420143198090694, 'f1-score': 0.37438954153810194, 'support': 523750}}
[[65012 65299 45480]
 [52938 68518 50547]
 [47863 65635 62458]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0928236
{'0': {'precision': 0.37897825018432046, 'recall': 0.3922887351935766, 'f1-score': 0.38551863686435045, 'support': 62895}, '1': {'precision': 0.3485758039816233, 'recall': 0.3531182128451753, 'f1-score': 0.3508323057953144, 'support': 64460}, '2': {'precision': 0.3842462744567972, 'recall': 0.3654213866795212, 'f1-score': 0.37459747490137624, 'support': 62235}, 'accuracy': 0.37015137929215675, 'macro avg': {'precision': 0.37060010954091366, 'recall': 0.37027611157275775, 'f1-score': 0.3703161391870137, 'support': 189590}, 'weighted avg': {'precision': 0.370370801523377, 'recall': 0.37015137929215675, 'f1-score': 0.3701404026986468, 'support': 189590}}
[[24673 21508 16714]
 [21968 22762 19730]
 [18463 21030 22742]]
testing model on single stock: results/universal/W6/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 192s - 192s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0900183
{'0': {'precision': 0.350897555925877, 'recall': 0.32845821015867865, 'f1-score': 0.3393072935341016, 'support': 2255943}, '1': {'precision': 0.40424903874117646, 'recall': 0.3987866508456426, 'f1-score': 0.4014992667389667, 'support': 3025510}, '2': {'precision': 0.3415364413104673, 'recall': 0.369867819382727, 'f1-score': 0.355137987686915, 'support': 2231946}, 'accuracy': 0.3690794273004801, 'macro avg': {'precision': 0.36556101199250696, 'recall': 0.3657042267956827, 'f1-score': 0.3653148493199944, 'support': 7513399}, 'weighted avg': {'precision': 0.3696004016620227, 'recall': 0.3690794273004801, 'f1-score': 0.36905357632071345, 'support': 7513399}}
[[ 740983  896091  618869]
 [ 846279 1206533  972698]
 [ 524417  882004  825525]]
Evaluating performance on  train set...
5452/5452 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0939975
{'0': {'precision': 0.3922850347315198, 'recall': 0.3716007383628977, 'f1-score': 0.3816628446015839, 'support': 469146}, '1': {'precision': 0.3355132879494828, 'recall': 0.3439750454175144, 'f1-score': 0.33969147899488666, 'support': 459074}, '2': {'precision': 0.3903253873758357, 'recall': 0.40131791556180485, 'f1-score': 0.3957453319474708, 'support': 467253}, 'accuracy': 0.37246295700454257, 'macro avg': {'precision': 0.3727079033522795, 'recall': 0.37229789978073896, 'f1-score': 0.37236655184798045, 'support': 1395473}, 'weighted avg': {'precision': 0.3729524614835227, 'recall': 0.37246295700454257, 'f1-score': 0.37257067425167295, 'support': 1395473}}
[[174335 157276 137535]
 [145804 157910 155360]
 [124270 155466 187517]]
Evaluating performance on  val set...
1969/1969 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0893012
{'0': {'precision': 0.36797089988929305, 'recall': 0.3637096925472247, 'f1-score': 0.36582788787491904, 'support': 159927}, '1': {'precision': 0.38344052352364755, 'recall': 0.36171896997805864, 'f1-score': 0.37226315285884165, 'support': 188229}, '2': {'precision': 0.36733542729232105, 'recall': 0.3968224442933563, 'f1-score': 0.3815100192090082, 'support': 155906}, 'accuracy': 0.37320805773892896, 'macro avg': {'precision': 0.37291561690175384, 'recall': 0.37408370227287985, 'f1-score': 0.3732003533142563, 'support': 504062}, 'weighted avg': {'precision': 0.3735510820818952, 'recall': 0.37320805773892896, 'f1-score': 0.3730814437081921, 'support': 504062}}
[[58167 55520 46240]
 [59829 68086 60314]
 [40079 53960 61867]]
training model: results/universal/W6/deepOF_L1/h200
Epoch 1/50
9426/9426 - 139s - loss: 3.2222 - accuracy200: 0.4044 - val_loss: 3.2759 - val_accuracy200: 0.3638 - 139s/epoch - 15ms/step
Epoch 2/50
9426/9426 - 139s - loss: 3.2229 - accuracy200: 0.4053 - val_loss: 3.2742 - val_accuracy200: 0.3647 - 139s/epoch - 15ms/step
Epoch 3/50
9426/9426 - 139s - loss: 3.2225 - accuracy200: 0.4062 - val_loss: 3.2745 - val_accuracy200: 0.3645 - 139s/epoch - 15ms/step
Epoch 4/50
9426/9426 - 137s - loss: 3.2214 - accuracy200: 0.4074 - val_loss: 3.2728 - val_accuracy200: 0.3666 - 137s/epoch - 15ms/step
Epoch 5/50
9426/9426 - 133s - loss: 3.2201 - accuracy200: 0.4084 - val_loss: 3.2721 - val_accuracy200: 0.3674 - 133s/epoch - 14ms/step
Epoch 6/50
9426/9426 - 136s - loss: 3.2192 - accuracy200: 0.4090 - val_loss: 3.2717 - val_accuracy200: 0.3686 - 136s/epoch - 14ms/step
Epoch 7/50
9426/9426 - 134s - loss: 3.2188 - accuracy200: 0.4097 - val_loss: 3.2709 - val_accuracy200: 0.3702 - 134s/epoch - 14ms/step
Epoch 8/50
9426/9426 - 135s - loss: 3.2182 - accuracy200: 0.4101 - val_loss: 3.2710 - val_accuracy200: 0.3700 - 135s/epoch - 14ms/step
Epoch 9/50
9426/9426 - 139s - loss: 3.2167 - accuracy200: 0.4111 - val_loss: 3.2713 - val_accuracy200: 0.3694 - 139s/epoch - 15ms/step
Epoch 10/50
9426/9426 - 138s - loss: 3.2152 - accuracy200: 0.4115 - val_loss: 3.2720 - val_accuracy200: 0.3695 - 138s/epoch - 15ms/step
Epoch 11/50
9426/9426 - 135s - loss: 3.2142 - accuracy200: 0.4123 - val_loss: 3.2709 - val_accuracy200: 0.3699 - 135s/epoch - 14ms/step
Epoch 12/50
9426/9426 - 139s - loss: 3.2124 - accuracy200: 0.4132 - val_loss: 3.2722 - val_accuracy200: 0.3691 - 139s/epoch - 15ms/step
Epoch 13/50
9426/9426 - 136s - loss: 3.2118 - accuracy200: 0.4137 - val_loss: 3.2726 - val_accuracy200: 0.3695 - 136s/epoch - 14ms/step
Epoch 14/50
9426/9426 - 137s - loss: 3.2109 - accuracy200: 0.4143 - val_loss: 3.2733 - val_accuracy200: 0.3687 - 137s/epoch - 15ms/step
Epoch 15/50
9426/9426 - 135s - loss: 3.2092 - accuracy200: 0.4148 - val_loss: 3.2747 - val_accuracy200: 0.3690 - 135s/epoch - 14ms/step
Epoch 16/50
9426/9426 - 137s - loss: 3.2082 - accuracy200: 0.4154 - val_loss: 3.2755 - val_accuracy200: 0.3689 - 137s/epoch - 15ms/step
Epoch 17/50
9426/9426 - 140s - loss: 3.2071 - accuracy200: 0.4159 - val_loss: 3.2754 - val_accuracy200: 0.3687 - 140s/epoch - 15ms/step
Epoch 18/50
9426/9426 - 139s - loss: 3.2065 - accuracy200: 0.4163 - val_loss: 3.2766 - val_accuracy200: 0.3683 - 139s/epoch - 15ms/step
Epoch 19/50
9426/9426 - 138s - loss: 3.2059 - accuracy200: 0.4167 - val_loss: 3.2770 - val_accuracy200: 0.3684 - 138s/epoch - 15ms/step
Epoch 20/50
9426/9426 - 137s - loss: 3.2045 - accuracy200: 0.4170 - val_loss: 3.2780 - val_accuracy200: 0.3680 - 137s/epoch - 15ms/step
Epoch 21/50
9426/9426 - 137s - loss: 3.2036 - accuracy200: 0.4176 - val_loss: 3.2786 - val_accuracy200: 0.3688 - 137s/epoch - 14ms/step
testing model in sample: results/universal/W6/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 270s - 270s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089712
{'0': {'precision': 0.3768834095291747, 'recall': 0.052063450824772727, 'f1-score': 0.09148849273545824, 'support': 3340981}, '1': {'precision': 0.37649807539595653, 'recall': 0.789279819652993, 'f1-score': 0.5098095174222567, 'support': 4073924}, '2': {'precision': 0.36065794862535616, 'recall': 0.19248970017619066, 'f1-score': 0.2510105233113328, 'support': 3403699}, 'accuracy': 0.37385470435926854, 'macro avg': {'precision': 0.3713464778501625, 'recall': 0.34461099021798547, 'f1-score': 0.28410284448968254, 'support': 10818604}, 'weighted avg': {'precision': 0.3716335263625293, 'recall': 0.37385470435926854, 'f1-score': 0.29920226413565126, 'support': 10818604}}
[[ 173943 2694104  472934]
 [ 169953 3215466  688505]
 [ 117634 2630888  655177]]
Evaluating performance on  train set...
9426/9426 - 62s - 62s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097017
{'0': {'precision': 0.4025733808621634, 'recall': 0.05544809879865544, 'f1-score': 0.09747109944400059, 'support': 808594}, '1': {'precision': 0.33443451792804146, 'recall': 0.8139525005840297, 'f1-score': 0.4740802669501485, 'support': 800473}, '2': {'precision': 0.3938073927864464, 'recall': 0.1729025317417133, 'f1-score': 0.24030034514772827, 'support': 803123}, 'accuracy': 0.34625962299818835, 'macro avg': {'precision': 0.3769384305255505, 'recall': 0.3474343770414661, 'f1-score': 0.27061723718062575, 'support': 2412190}, 'weighted avg': {'precision': 0.3770432664554212, 'recall': 0.34625962299818835, 'f1-score': 0.2700010089612706, 'support': 2412190}}
[[ 44835 663237 100522]
 [ 35696 651547 113230]
 [ 30840 633421 138862]]
Evaluating performance on  val set...
3323/3323 - 23s - 23s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903655
{'0': {'precision': 0.3794189618368303, 'recall': 0.053586528916504284, 'f1-score': 0.0939098722954601, 'support': 271990}, '1': {'precision': 0.36647030945160514, 'recall': 0.8181924406433081, 'f1-score': 0.5062086013753606, 'support': 308095}, '2': {'precision': 0.384714002354421, 'recall': 0.17657551635191496, 'f1-score': 0.24205359747358807, 'support': 270213}, 'accuracy': 0.36971626418032266, 'macro avg': {'precision': 0.3768677578809522, 'recall': 0.3494514953039091, 'f1-score': 0.28072402371480293, 'support': 850298}, 'weighted avg': {'precision': 0.3764098682328865, 'recall': 0.36971626418032266, 'f1-score': 0.29037927166771477, 'support': 850298}}
[[ 14575 223202  34213]
 [ 13918 252081  42096]
 [  9921 212579  47713]]
testing model out of sample: results/universal/W6/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 112s - 112s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923965
{'0': {'precision': 0.3828619544450096, 'recall': 0.06258834610501544, 'f1-score': 0.1075886422600173, 'support': 1431161}, '1': {'precision': 0.35780810790826206, 'recall': 0.8158519538135759, 'f1-score': 0.49744973599771375, 'support': 1589558}, '2': {'precision': 0.3889512035957093, 'recall': 0.16646692602221116, 'f1-score': 0.23314871367183354, 'support': 1464399}, 'accuracy': 0.36346691435988976, 'macro avg': {'precision': 0.3765404219829936, 'recall': 0.3483024086469342, 'f1-score': 0.27939569730985486, 'support': 4485118}, 'weighted avg': {'precision': 0.3759708421428976, 'recall': 0.36346691435988976, 'f1-score': 0.28675379765947334, 'support': 4485118}}
[[  89574 1169813  171774]
 [  81515 1296844  211199]
 [  62870 1157755  243774]]
Evaluating performance on  train set...
5152/5152 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001621
{'0': {'precision': 0.40141225497762, 'recall': 0.04629532796788743, 'f1-score': 0.0830162932343277, 'support': 449419}, '1': {'precision': 0.32623412787343303, 'recall': 0.802500674431425, 'f1-score': 0.4638877212014374, 'support': 426285}, '2': {'precision': 0.3932014136219249, 'recall': 0.1936799230536502, 'f1-score': 0.2595251025233372, 'support': 442906}, 'accuracy': 0.34026891954406535, 'macro avg': {'precision': 0.3736159321576593, 'recall': 0.3474919751509875, 'f1-score': 0.2688097056530341, 'support': 1318610}, 'weighted avg': {'precision': 0.37435047111878844, 'recall': 0.34026891954406535, 'f1-score': 0.2654330710214804, 'support': 1318610}}
[[ 20806 364062  64551]
 [ 16361 342094  67830]
 [ 14665 342459  85782]]
Evaluating performance on  val set...
1795/1795 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979335
{'0': {'precision': 0.39432532645494117, 'recall': 0.04771565682181733, 'f1-score': 0.08513007917863047, 'support': 153786}, '1': {'precision': 0.3350288605234655, 'recall': 0.7990321103917337, 'f1-score': 0.472106569808441, 'support': 152910}, '2': {'precision': 0.39331966399894175, 'recall': 0.1953637815142615, 'f1-score': 0.2610585281050802, 'support': 152193}, 'accuracy': 0.34703599345375463, 'macro avg': {'precision': 0.37422461699244947, 'recall': 0.3473705162426042, 'f1-score': 0.2727650590307172, 'support': 458889}, 'weighted avg': {'precision': 0.3742331529843462, 'recall': 0.34703599345375463, 'f1-score': 0.27242516276021006, 'support': 458889}}
[[  7338 125207  21241]
 [  6109 122180  24621]
 [  5162 117298  29733]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955771
{'0': {'precision': 0.34443765281173594, 'recall': 0.02747038463413445, 'f1-score': 0.05088265835929387, 'support': 82052}, '1': {'precision': 0.35288357172145973, 'recall': 0.7673128159942938, 'f1-score': 0.4834368153746006, 'support': 95334}, '2': {'precision': 0.3791657200775912, 'recall': 0.23161749007216362, 'f1-score': 0.2875698314766831, 'support': 93676}, 'accuracy': 0.3582280068766555, 'macro avg': {'precision': 0.358828981536929, 'recall': 0.3421335635668639, 'f1-score': 0.27396310173685917, 'support': 271062}, 'weighted avg': {'precision': 0.3594097612686051, 'recall': 0.3582280068766555, 'f1-score': 0.284810784152809, 'support': 271062}}
[[ 2254 64001 15797]
 [ 2454 73151 19729]
 [ 1836 70143 21697]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1051304
{'0': {'precision': 0.3892307692307692, 'recall': 0.013706051248713364, 'f1-score': 0.026479669265790987, 'support': 18459}, '1': {'precision': 0.319976001799865, 'recall': 0.7347454221916079, 'f1-score': 0.44580663137364174, 'support': 17421}, '2': {'precision': 0.35555388546520367, 'recall': 0.26168482770064716, 'f1-score': 0.30148159949020237, 'support': 18079}, 'accuracy': 0.3295835727126151, 'macro avg': {'precision': 0.35492021883194597, 'recall': 0.3367121003803228, 'f1-score': 0.25792263337654503, 'support': 53959}, 'weighted avg': {'precision': 0.355587972199478, 'recall': 0.3295835727126151, 'f1-score': 0.25400158226284436, 'support': 53959}}
[[  253 14041  4165]
 [  211 12800  4410]
 [  186 13162  4731]]
Evaluating performance on  val set...
81/81 - 1s - 726ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040078
{'0': {'precision': 0.4214876033057851, 'recall': 0.0217206132879046, 'f1-score': 0.041312272174969626, 'support': 7044}, '1': {'precision': 0.3145232397027333, 'recall': 0.7698473870818561, 'f1-score': 0.44659065504135925, 'support': 6487}, '2': {'precision': 0.3670079635949943, 'recall': 0.22702322308233638, 'f1-score': 0.28052173913043477, 'support': 7105}, 'accuracy': 0.32758286489629773, 'macro avg': {'precision': 0.36767293553450425, 'recall': 0.3395304078173657, 'f1-score': 0.2561415554489212, 'support': 20636}, 'weighted avg': {'precision': 0.3691055686654398, 'recall': 0.32758286489629773, 'f1-score': 0.2510730849474473, 'support': 20636}}
[[ 153 5475 1416]
 [ 127 4994 1366]
 [  83 5409 1613]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990196
{'0': {'precision': 0.450632811885858, 'recall': 0.0571714945371677, 'f1-score': 0.10146960558281963, 'support': 200537}, '1': {'precision': 0.27804066899069624, 'recall': 0.7999156540762803, 'f1-score': 0.4126495273253857, 'support': 151756}, '2': {'precision': 0.451395037578503, 'recall': 0.21193269430627862, 'f1-score': 0.2884407266937932, 'support': 206877}, 'accuracy': 0.31600586583686535, 'macro avg': {'precision': 0.3933561728183524, 'recall': 0.3563399476399089, 'f1-score': 0.2675199532006662, 'support': 559170}, 'weighted avg': {'precision': 0.4040741512413656, 'recall': 0.31600586583686535, 'f1-score': 0.2550963109247366, 'support': 559170}}
[[ 11465 159885  29187]
 [  6265 121392  24099]
 [  7712 155321  43844]]
Evaluating performance on  train set...
533/533 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083677
{'0': {'precision': 0.4747585201385092, 'recall': 0.05646349921969828, 'f1-score': 0.10092400674118127, 'support': 46136}, '1': {'precision': 0.35146365723741085, 'recall': 0.8104261339278059, 'f1-score': 0.49029664451288696, 'support': 46652}, '2': {'precision': 0.4266942398000948, 'recall': 0.2277671733781018, 'f1-score': 0.2969982307254026, 'support': 43483}, 'accuracy': 0.3692421718487426, 'macro avg': {'precision': 0.41763880572533835, 'recall': 0.364885602175202, 'f1-score': 0.2960729606598236, 'support': 136271}, 'weighted avg': {'precision': 0.4172119324858368, 'recall': 0.3692421718487426, 'f1-score': 0.2967903890149703, 'support': 136271}}
[[ 2605 37494  6037]
 [ 1574 37808  7270]
 [ 1308 32271  9904]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0792079
{'0': {'precision': 0.49139367018323155, 'recall': 0.05312443724113092, 'f1-score': 0.09588299024918742, 'support': 16659}, '1': {'precision': 0.3594915432293308, 'recall': 0.811910552227297, 'f1-score': 0.49833439519432055, 'support': 16859}, '2': {'precision': 0.41074002883229216, 'recall': 0.23285432132398012, 'f1-score': 0.2972138914243491, 'support': 14683}, 'accuracy': 0.3732702641024045, 'macro avg': {'precision': 0.42054174741495154, 'recall': 0.36596310359746936, 'f1-score': 0.2971437589559524, 'support': 48201}, 'weighted avg': {'precision': 0.4206902537754463, 'recall': 0.3732702641024045, 'f1-score': 0.2979756824739317, 'support': 48201}}
[[  885 13515  2259]
 [  525 13688  2646]
 [  391 10873  3419]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.118505
{'0': {'precision': 0.42116531579752253, 'recall': 0.0469081339794415, 'f1-score': 0.08441443995739431, 'support': 117421}, '1': {'precision': 0.24858724682202177, 'recall': 0.8472256585886735, 'f1-score': 0.38438951186945375, 'support': 76793}, '2': {'precision': 0.4151179961550249, 'recall': 0.12791256718006833, 'f1-score': 0.19556471460730201, 'support': 116478}, 'accuracy': 0.27508915581991167, 'macro avg': {'precision': 0.3616235195915231, 'recall': 0.34068211991606107, 'f1-score': 0.22145622214471672, 'support': 310692}, 'weighted avg': {'precision': 0.37624247469393934, 'recall': 0.27508915581991167, 'f1-score': 0.20022864627108994, 'support': 310692}}
[[ 5508 99459 12454]
 [ 3194 65061  8538]
 [ 4376 97203 14899]]
Evaluating performance on  train set...
512/512 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995984
{'0': {'precision': 0.39725, 'recall': 0.03525001109188518, 'f1-score': 0.06475406495782224, 'support': 45078}, '1': {'precision': 0.3310350371091482, 'recall': 0.8612757058208435, 'f1-score': 0.47825189352395453, 'support': 43035}, '2': {'precision': 0.3852464483425599, 'recall': 0.13480523723948, 'f1-score': 0.19972337482710928, 'support': 42847}, 'accuracy': 0.33926389737324375, 'macro avg': {'precision': 0.3711771618172361, 'recall': 0.34377698471740287, 'f1-score': 0.24757644443629534, 'support': 130960}, 'weighted avg': {'precision': 0.37156370566681324, 'recall': 0.33926389737324375, 'f1-score': 0.24479307742203152, 'support': 130960}}
[[ 1589 38955  4534]
 [ 1287 37065  4683]
 [ 1124 35947  5776]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.108064
{'0': {'precision': 0.43112062812276947, 'recall': 0.03996294825989149, 'f1-score': 0.07314562518922191, 'support': 15114}, '1': {'precision': 0.2948546106080915, 'recall': 0.848272605650429, 'f1-score': 0.43760149399155573, 'support': 12707}, '2': {'precision': 0.39167309175019277, 'recall': 0.1325938009787928, 'f1-score': 0.19811826646516842, 'support': 15325}, 'accuracy': 0.31092105873082093, 'macro avg': {'precision': 0.3725494434936845, 'recall': 0.3402764516297044, 'f1-score': 0.23628846188198202, 'support': 43146}, 'weighted avg': {'precision': 0.37697735228100543, 'recall': 0.31092105873082093, 'f1-score': 0.22487107951697274, 'support': 43146}}
[[  604 12912  1598]
 [  370 10779  1558]
 [  427 12866  2032]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1124609
{'0': {'precision': 0.4207232267037552, 'recall': 0.05521248440969793, 'f1-score': 0.09761475784548362, 'support': 98619}, '1': {'precision': 0.260280489910026, 'recall': 0.8431878009192957, 'f1-score': 0.3977737026670528, 'support': 73317}, '2': {'precision': 0.43410172466164904, 'recall': 0.1189296149720753, 'f1-score': 0.18670750560688648, 'support': 108148}, 'accuracy': 0.2860820325330972, 'macro avg': {'precision': 0.3717018137584767, 'recall': 0.339109966767023, 'f1-score': 0.22736532203980764, 'support': 280084}, 'weighted avg': {'precision': 0.38389026824716527, 'recall': 0.2860820325330972, 'f1-score': 0.2105878510688851, 'support': 280084}}
[[ 5445 84621  8553]
 [ 3283 61820  8214]
 [ 4214 91072 12862]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028242
{'0': {'precision': 0.3833612040133779, 'recall': 0.04845186515904047, 'f1-score': 0.08603058448259687, 'support': 37852}, '1': {'precision': 0.3264255940870611, 'recall': 0.8027316918524781, 'f1-score': 0.46411987535895394, 'support': 37852}, '2': {'precision': 0.3669362084456424, 'recall': 0.15764687717131168, 'f1-score': 0.22054217518090508, 'support': 38859}, 'accuracy': 0.33470666794689385, 'macro avg': {'precision': 0.35890766884869385, 'recall': 0.33627681139427673, 'f1-score': 0.2568975450074853, 'support': 114563}, 'weighted avg': {'precision': 0.3589782390971521, 'recall': 0.33470666794689385, 'f1-score': 0.25657798408977744, 'support': 114563}}
[[ 1834 31419  4599]
 [ 1497 30385  5970]
 [ 1453 31280  6126]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083411
{'0': {'precision': 0.4064613072877536, 'recall': 0.04634626916816585, 'f1-score': 0.08320516764072593, 'support': 11673}, '1': {'precision': 0.29640514676893304, 'recall': 0.8030685570013595, 'f1-score': 0.43299562815780523, 'support': 10298}, '2': {'precision': 0.4127413824219455, 'recall': 0.1786439618809561, 'f1-score': 0.2493594286648858, 'support': 12802}, 'accuracy': 0.3191556667529405, 'macro avg': {'precision': 0.37186927882621074, 'recall': 0.34268626268349384, 'f1-score': 0.2551867414878057, 'support': 34773}, 'weighted avg': {'precision': 0.37618031861392937, 'recall': 0.3191556667529405, 'f1-score': 0.24796659208026745, 'support': 34773}}
[[  541  9533  1599]
 [  373  8270  1655]
 [  417 10098  2287]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073545
{'0': {'precision': 0.3930960769565734, 'recall': 0.06498903759939789, 'f1-score': 0.11153794311901874, 'support': 152795}, '1': {'precision': 0.2928138875394019, 'recall': 0.8121983704167972, 'f1-score': 0.4304440255437174, 'support': 127640}, '2': {'precision': 0.4121224934541137, 'recall': 0.15802667764204067, 'f1-score': 0.22845371605784143, 'support': 160359}, 'accuracy': 0.31520392745817777, 'macro avg': {'precision': 0.3660108193166964, 'recall': 0.34507136188607856, 'f1-score': 0.2568118949068592, 'support': 440794}, 'weighted avg': {'precision': 0.37097925700421763, 'recall': 0.31520392745817777, 'f1-score': 0.24641652312098156, 'support': 440794}}
[[  9930 123565  19300]
 [  7123 103669  16848]
 [  8208 126810  25341]]
Evaluating performance on  train set...
617/617 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1032984
{'0': {'precision': 0.397504765205337, 'recall': 0.043117869293084976, 'f1-score': 0.07779699528605827, 'support': 53203}, '1': {'precision': 0.3300719233211738, 'recall': 0.8572223074562749, 'f1-score': 0.47662156254331806, 'support': 52144}, '2': {'precision': 0.36123873739483264, 'recall': 0.11508411747932706, 'f1-score': 0.17455740730061703, 'support': 52605}, 'accuracy': 0.3358425344408428, 'macro avg': {'precision': 0.3629384753071145, 'recall': 0.3384747647428957, 'f1-score': 0.24299198837666447, 'support': 157952}, 'weighted avg': {'precision': 0.36316526649573294, 'recall': 0.3358425344408428, 'f1-score': 0.24168469350506416, 'support': 157952}}
[[ 2294 45890  5019]
 [ 1759 44699  5686]
 [ 1718 44833  6054]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022849
{'0': {'precision': 0.3801930339907679, 'recall': 0.047604035308953345, 'f1-score': 0.0846135886061172, 'support': 19032}, '1': {'precision': 0.3306563109954457, 'recall': 0.8555871212121212, 'f1-score': 0.4769767714687941, 'support': 19008}, '2': {'precision': 0.37699897924464104, 'recall': 0.11419737181138882, 'f1-score': 0.17529565320571136, 'support': 19405}, 'accuracy': 0.33745321611976675, 'macro avg': {'precision': 0.3626161080769516, 'recall': 0.33912950944415443, 'f1-score': 0.2456286710935409, 'support': 57445}, 'weighted avg': {'precision': 0.3627228509801721, 'recall': 0.33745321611976675, 'f1-score': 0.2450753318981163, 'support': 57445}}
[[  906 16455  1671]
 [  754 16263  1991]
 [  723 16466  2216]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/EXC
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0870554
{'0': {'precision': 0.42201646415648847, 'recall': 0.07021145717229922, 'f1-score': 0.1203929708787754, 'support': 380408}, '1': {'precision': 0.34257467136152775, 'recall': 0.8181185642341487, 'f1-score': 0.4829298382762496, 'support': 386609}, '2': {'precision': 0.4240370244119884, 'recall': 0.17384083268162506, 'f1-score': 0.2465886586600133, 'support': 372099}, 'accuracy': 0.3578977031312, 'macro avg': {'precision': 0.3962093866433349, 'recall': 0.354056951362691, 'f1-score': 0.2833038226050128, 'support': 1139116}, 'weighted avg': {'precision': 0.3957144337924555, 'recall': 0.3578977031312, 'f1-score': 0.28465833542056124, 'support': 1139116}}
[[ 26709 315433  38266]
 [ 20721 316292  49596]
 [ 15859 291554  64686]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924635
{'0': {'precision': 0.4374476169190367, 'recall': 0.06050559149258461, 'f1-score': 0.10630728494806166, 'support': 129393}, '1': {'precision': 0.32786993195572417, 'recall': 0.8327837777565389, 'f1-score': 0.4705016806684875, 'support': 125556}, '2': {'precision': 0.4413780175376476, 'recall': 0.1631721195974405, 'f1-score': 0.2382617494940409, 'support': 129869}, 'accuracy': 0.34712773311019757, 'macro avg': {'precision': 0.4022318554708028, 'recall': 0.35215382961552133, 'f1-score': 0.2716902383701967, 'support': 384818}, 'weighted avg': {'precision': 0.40302173607324654, 'recall': 0.34712773311019757, 'f1-score': 0.2696665506404034, 'support': 384818}}
[[  7829 110144  11420]
 [  5595 104561  15400]
 [  4473 104205  21191]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0847883
{'0': {'precision': 0.3895660653339834, 'recall': 0.05997447894512973, 'f1-score': 0.1039462272333044, 'support': 39967}, '1': {'precision': 0.3633953987586915, 'recall': 0.8285489328197817, 'f1-score': 0.5052096173558759, 'support': 46993}, '2': {'precision': 0.43873816301632484, 'recall': 0.17340589194277972, 'f1-score': 0.24856823118952007, 'support': 43551}, 'accuracy': 0.37456612852556487, 'macro avg': {'precision': 0.39723320903633325, 'recall': 0.3539764345692304, 'f1-score': 0.28590802525956677, 'support': 130511}, 'weighted avg': {'precision': 0.39655134543903936, 'recall': 0.37456612852556487, 'f1-score': 0.29668862738599006, 'support': 130511}}
[[ 2397 33907  3663]
 [ 2059 38936  5998]
 [ 1697 34302  7552]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/AAL
Evaluating performance on  test set...
6203/6203 - 40s - 40s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890672
{'0': {'precision': 0.3975296350455804, 'recall': 0.0767891628536857, 'f1-score': 0.1287149824964951, 'support': 499172}, '1': {'precision': 0.3599203504076153, 'recall': 0.8062322153616778, 'f1-score': 0.49766967029988246, 'support': 564743}, '2': {'precision': 0.413157836620216, 'recall': 0.17852903117449243, 'f1-score': 0.2493233239022921, 'support': 523954}, 'accuracy': 0.3697949893851445, 'macro avg': {'precision': 0.39020260735780393, 'recall': 0.35385013646328534, 'f1-score': 0.2919026588995565, 'support': 1587869}, 'weighted avg': {'precision': 0.3893103666383871, 'recall': 0.3697949893851445, 'f1-score': 0.2997352619824485, 'support': 1587869}}
[[ 38331 403990  56851]
 [ 33416 455314  76013]
 [ 24676 405737  93541]]
Evaluating performance on  train set...
1766/1766 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992533
{'0': {'precision': 0.4188872086353444, 'recall': 0.0508775152163862, 'f1-score': 0.09073452836795319, 'support': 157889}, '1': {'precision': 0.3189081121206167, 'recall': 0.7210668472013596, 'f1-score': 0.4422300073526232, 'support': 141801}, '2': {'precision': 0.40397350993377484, 'recall': 0.2975922363245983, 'f1-score': 0.3427173600713821, 'support': 152299}, 'accuracy': 0.3442650152990449, 'macro avg': {'precision': 0.380589610229912, 'recall': 0.35651219958078134, 'f1-score': 0.29189396526398614, 'support': 451989}, 'weighted avg': {'precision': 0.38249588658229616, 'recall': 0.3442650152990449, 'f1-score': 0.28591437500383526, 'support': 451989}}
[[  8033 116697  33159]
 [  5842 102248  33711]
 [  5302 101674  45323]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912039
{'0': {'precision': 0.42224137931034483, 'recall': 0.04944877438113314, 'f1-score': 0.08852980515490004, 'support': 49526}, '1': {'precision': 0.3482994489834695, 'recall': 0.7231591612915952, 'f1-score': 0.4701552350968536, 'support': 50697}, '2': {'precision': 0.4012482438128175, 'recall': 0.31037221258542497, 'f1-score': 0.35000765958449703, 'support': 47849}, 'accuracy': 0.36443081744016426, 'macro avg': {'precision': 0.39059635736887727, 'recall': 0.3609933827527178, 'f1-score': 0.3028975666120835, 'support': 148072}, 'weighted avg': {'precision': 0.39014122139930973, 'recall': 0.36443081744016426, 'f1-score': 0.3036867442005603, 'support': 148072}}
[[ 2449 37026 10051]
 [ 1925 36662 12110]
 [ 1426 31572 14851]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/WBA
Evaluating performance on  test set...
5183/5183 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981643
{'0': {'precision': 0.4348429581329288, 'recall': 0.0600792523431176, 'f1-score': 0.1055723071557742, 'support': 448441}, '1': {'precision': 0.2972332432466817, 'recall': 0.8326086956521739, 'f1-score': 0.4380771760079611, 'support': 392840}, '2': {'precision': 0.4502143443495181, 'recall': 0.1524856143703893, 'f1-score': 0.22781223029219594, 'support': 485554}, 'accuracy': 0.32262037103332364, 'macro avg': {'precision': 0.3940968485763762, 'recall': 0.34839118745522696, 'f1-score': 0.2571539044853104, 'support': 1326835}, 'weighted avg': {'precision': 0.39972558307657025, 'recall': 0.32262037103332364, 'f1-score': 0.24875159947054973, 'support': 1326835}}
[[ 26942 379118  42381]
 [ 17724 327082  48034]
 [ 17292 394222  74040]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989915
{'0': {'precision': 0.40509687273896616, 'recall': 0.03886467934132891, 'f1-score': 0.0709248807127676, 'support': 129655}, '1': {'precision': 0.33061974789915966, 'recall': 0.8529538353631321, 'f1-score': 0.47652868567764456, 'support': 125464}, '2': {'precision': 0.3867529924798647, 'recall': 0.13801946866117226, 'f1-score': 0.20343842894927794, 'support': 125946}, 'accuracy': 0.339671709550864, 'macro avg': {'precision': 0.37415653770599683, 'recall': 0.3432793277885444, 'f1-score': 0.2502973317798967, 'support': 381065}, 'weighted avg': {'precision': 0.3745127562916034, 'recall': 0.339671709550864, 'f1-score': 0.24826530067342745, 'support': 381065}}
[[  5039 111492  13124]
 [  4010 107015  14439]
 [  3390 105173  17383]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975381
{'0': {'precision': 0.38874937217478656, 'recall': 0.03489158364513366, 'f1-score': 0.06403574087862993, 'support': 44366}, '1': {'precision': 0.33384466690903286, 'recall': 0.8519834355411735, 'f1-score': 0.4797156108251363, 'support': 44191}, '2': {'precision': 0.3946348174087044, 'recall': 0.14280219034258043, 'f1-score': 0.20971654537600107, 'support': 44194}, 'accuracy': 0.34281474339176354, 'macro avg': {'precision': 0.3724096188308413, 'recall': 0.3432257365096292, 'f1-score': 0.25115596569325577, 'support': 132751}, 'weighted avg': {'precision': 0.37243166109365605, 'recall': 0.34281474339176354, 'f1-score': 0.25090835657842037, 'support': 132751}}
[[ 1548 38283  4535]
 [ 1395 37650  5146]
 [ 1039 36844  6311]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 47s - 47s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869303
{'0': {'precision': 0.36324063399023804, 'recall': 0.05815211110171962, 'f1-score': 0.10025426375031596, 'support': 579721}, '1': {'precision': 0.390472707728326, 'recall': 0.8276541691032869, 'f1-score': 0.5306119922630561, 'support': 725048}, '2': {'precision': 0.36029216738416336, 'recall': 0.1549219906936266, 'f1-score': 0.21667564420482527, 'support': 569932}, 'accuracy': 0.3851792899240999, 'macro avg': {'precision': 0.3713351697009091, 'recall': 0.34690942363287774, 'f1-score': 0.28251396673939916, 'support': 1874701}, 'weighted avg': {'precision': 0.3728763759725167, 'recall': 0.3851792899240999, 'f1-score': 0.3020903328343484, 'support': 1874701}}
[[ 33712 478967  67042]
 [ 35231 600089  89728]
 [ 23866 457771  88295]]
Evaluating performance on  train set...
2046/2046 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996153
{'0': {'precision': 0.38498929718159114, 'recall': 0.04939069740831856, 'f1-score': 0.08754956544667214, 'support': 174790}, '1': {'precision': 0.3296739528358304, 'recall': 0.8435049219240883, 'f1-score': 0.4740651367492443, 'support': 171884}, '2': {'precision': 0.3955608273889801, 'recall': 0.13747769319388287, 'f1-score': 0.2040407511556079, 'support': 177076}, 'accuracy': 0.33978424821002384, 'macro avg': {'precision': 0.37007469246880054, 'recall': 0.34345777084209655, 'f1-score': 0.2552184844505081, 'support': 523750}, 'weighted avg': {'precision': 0.3704100926669885, 'recall': 0.33978424821002384, 'f1-score': 0.25378085071324363, 'support': 523750}}
[[  8633 148537  17620]
 [  7320 144985  19579]
 [  6471 146261  24344]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0989208
{'0': {'precision': 0.3760761214318079, 'recall': 0.052639923894085935, 'f1-score': 0.09235305571782247, 'support': 63070}, '1': {'precision': 0.3385058857890259, 'recall': 0.8328880973582665, 'f1-score': 0.48137096009642955, 'support': 64011}, '2': {'precision': 0.3838118982118294, 'recall': 0.14284343054600138, 'f1-score': 0.2082007158429809, 'support': 62509}, 'accuracy': 0.3458146526715544, 'macro avg': {'precision': 0.36613130181088777, 'recall': 0.3427904839327846, 'f1-score': 0.2606415772190776, 'support': 189590}, 'weighted avg': {'precision': 0.3659418702424638, 'recall': 0.3458146526715544, 'f1-score': 0.26189230601553093, 'support': 189590}}
[[ 3320 53039  6711]
 [ 3073 53314  7624]
 [ 2435 51145  8929]]
testing model on single stock: results/universal/W6/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 167s - 167s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0870714
{'0': {'precision': 0.34769178194634764, 'recall': 0.04689522163819219, 'f1-score': 0.0826437922589035, 'support': 2212976}, '1': {'precision': 0.4088859717060658, 'recall': 0.778133981798409, 'f1-score': 0.5360787210456158, 'support': 3069402}, '2': {'precision': 0.33484606928883937, 'recall': 0.20616928303229776, 'f1-score': 0.25520523118347727, 'support': 2231021}, 'accuracy': 0.3929183050174761, 'macro avg': {'precision': 0.3638079409804176, 'recall': 0.34373282882296624, 'f1-score': 0.2913092481626655, 'support': 7513399}, 'weighted avg': {'precision': 0.36887666960345084, 'recall': 0.3929183050174761, 'f1-score': 0.31912295053583434, 'support': 7513399}}
[[ 103778 1754260  354938]
 [ 122232 2388406  558764]
 [  72467 1698586  459968]]
Evaluating performance on  train set...
5452/5452 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986594
{'0': {'precision': 0.39094228338716475, 'recall': 0.059797060731423365, 'f1-score': 0.10372824013354, 'support': 465558}, '1': {'precision': 0.33605516158159787, 'recall': 0.7988596598766746, 'f1-score': 0.4730943803093979, 'support': 464949}, '2': {'precision': 0.38097999552513456, 'recall': 0.17944322810700136, 'f1-score': 0.24397375896790344, 'support': 464966}, 'accuracy': 0.34590637009816744, 'macro avg': {'precision': 0.3693258134979657, 'recall': 0.3460333162383664, 'f1-score': 0.27359879313694707, 'support': 1395473}, 'weighted avg': {'precision': 0.3693353891409606, 'recall': 0.34590637009816744, 'f1-score': 0.27352429883117413, 'support': 1395473}}
[[ 27839 372477  65242]
 [ 23196 371429  70324]
 [ 20175 361356  83435]]
Evaluating performance on  val set...
1969/1969 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0897874
{'0': {'precision': 0.36536405748901296, 'recall': 0.05791934724619489, 'f1-score': 0.09998808117801301, 'support': 159325}, '1': {'precision': 0.38141671267352045, 'recall': 0.8082728163833174, 'f1-score': 0.5182675866916272, 'support': 189754}, '2': {'precision': 0.36665319268232255, 'recall': 0.18143280230734984, 'f1-score': 0.24274627277985444, 'support': 154983}, 'accuracy': 0.37836615337002194, 'macro avg': {'precision': 0.37114465428161864, 'recall': 0.3492083219789541, 'f1-score': 0.2870006468831649, 'support': 504062}, 'weighted avg': {'precision': 0.3718034430636957, 'recall': 0.37836615337002194, 'f1-score': 0.30134287899704826, 'support': 504062}}
[[  9228 128207  21890]
 [  9699 153373  26682]
 [  6330 120534  28119]]
training model: results/universal/W6/deepLOB_L2/h50
Epoch 1/50
9426/9426 - 391s - loss: 3.0657 - accuracy50: 0.4618 - val_loss: 3.3714 - val_accuracy50: 0.4046 - 391s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 386s - loss: 3.0201 - accuracy50: 0.4795 - val_loss: 3.3289 - val_accuracy50: 0.4198 - 386s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 388s - loss: 3.0011 - accuracy50: 0.4866 - val_loss: 3.2749 - val_accuracy50: 0.4268 - 388s/epoch - 41ms/step
Epoch 4/50
9426/9426 - 388s - loss: 2.9787 - accuracy50: 0.4937 - val_loss: 3.3626 - val_accuracy50: 0.4331 - 388s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 383s - loss: 2.9534 - accuracy50: 0.5010 - val_loss: 3.3255 - val_accuracy50: 0.4454 - 383s/epoch - 41ms/step
Epoch 6/50
9426/9426 - 384s - loss: 2.9357 - accuracy50: 0.5062 - val_loss: 3.3565 - val_accuracy50: 0.4541 - 384s/epoch - 41ms/step
Epoch 7/50
9426/9426 - 384s - loss: 2.9224 - accuracy50: 0.5098 - val_loss: 3.3809 - val_accuracy50: 0.4513 - 384s/epoch - 41ms/step
Epoch 8/50
9426/9426 - 383s - loss: 2.9126 - accuracy50: 0.5124 - val_loss: 3.3788 - val_accuracy50: 0.4520 - 383s/epoch - 41ms/step
Epoch 9/50
9426/9426 - 386s - loss: 2.9050 - accuracy50: 0.5140 - val_loss: 3.3387 - val_accuracy50: 0.4565 - 386s/epoch - 41ms/step
Epoch 10/50
9426/9426 - 381s - loss: 2.8990 - accuracy50: 0.5157 - val_loss: 3.3266 - val_accuracy50: 0.4599 - 381s/epoch - 40ms/step
Epoch 11/50
9426/9426 - 384s - loss: 2.8947 - accuracy50: 0.5167 - val_loss: 3.3306 - val_accuracy50: 0.4590 - 384s/epoch - 41ms/step
Epoch 12/50
9426/9426 - 387s - loss: 2.8905 - accuracy50: 0.5180 - val_loss: 3.2736 - val_accuracy50: 0.4612 - 387s/epoch - 41ms/step
Epoch 13/50
9426/9426 - 384s - loss: 2.8866 - accuracy50: 0.5191 - val_loss: 3.3622 - val_accuracy50: 0.4564 - 384s/epoch - 41ms/step
Epoch 14/50
9426/9426 - 382s - loss: 2.8831 - accuracy50: 0.5200 - val_loss: 3.3600 - val_accuracy50: 0.4571 - 382s/epoch - 41ms/step
Epoch 15/50
9426/9426 - 381s - loss: 2.8801 - accuracy50: 0.5210 - val_loss: 3.3607 - val_accuracy50: 0.4561 - 381s/epoch - 40ms/step
Epoch 16/50
9426/9426 - 382s - loss: 2.8771 - accuracy50: 0.5214 - val_loss: 3.3629 - val_accuracy50: 0.4550 - 382s/epoch - 41ms/step
Epoch 17/50
9426/9426 - 384s - loss: 2.8748 - accuracy50: 0.5220 - val_loss: 3.3815 - val_accuracy50: 0.4538 - 384s/epoch - 41ms/step
Epoch 18/50
9426/9426 - 385s - loss: 2.8726 - accuracy50: 0.5227 - val_loss: 3.3550 - val_accuracy50: 0.4562 - 385s/epoch - 41ms/step
Epoch 19/50
9426/9426 - 382s - loss: 2.8700 - accuracy50: 0.5235 - val_loss: 3.3406 - val_accuracy50: 0.4565 - 382s/epoch - 41ms/step
Epoch 20/50
9426/9426 - 387s - loss: 2.8677 - accuracy50: 0.5238 - val_loss: 3.3376 - val_accuracy50: 0.4567 - 387s/epoch - 41ms/step
Epoch 21/50
9426/9426 - 387s - loss: 2.8657 - accuracy50: 0.5243 - val_loss: 3.3577 - val_accuracy50: 0.4539 - 387s/epoch - 41ms/step
Epoch 22/50
9426/9426 - 386s - loss: 2.8636 - accuracy50: 0.5251 - val_loss: 3.3788 - val_accuracy50: 0.4516 - 386s/epoch - 41ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 596s - 596s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1709043
{'0': {'precision': 0.36818634823786356, 'recall': 0.5030308875371716, 'f1-score': 0.4251731897117498, 'support': 3245419}, '1': {'precision': 0.45139782700511727, 'recall': 0.5812248692695487, 'f1-score': 0.508150060881137, 'support': 4343288}, '2': {'precision': 0.43130777057648756, 'recall': 0.10577871539931924, 'f1-score': 0.1698913791525943, 'support': 3229922}, 'accuracy': 0.4158225594019353, 'macro avg': {'precision': 0.4169639819398228, 'recall': 0.39667815740201323, 'f1-score': 0.3677382099151603, 'support': 10818629}, 'weighted avg': {'precision': 0.42043776455640824, 'recall': 0.4158225594019353, 'f1-score': 0.3822705365846943, 'support': 10818629}}
[[1632546 1451211  161662]
 [1530038 2524427  288823]
 [1271437 1616828  341657]]
Evaluating performance on  train set...
9426/9426 - 137s - 137s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0920715
{'0': {'precision': 0.433878515749338, 'recall': 0.418392083718646, 'f1-score': 0.42599459936418516, 'support': 765612}, '1': {'precision': 0.46402075069231347, 'recall': 0.6729246799763925, 'f1-score': 0.5492805665763165, 'support': 884466}, '2': {'precision': 0.46521732462978393, 'recall': 0.23883346607690906, 'f1-score': 0.3156291210434732, 'support': 762121}, 'accuracy': 0.4549894100776926, 'macro avg': {'precision': 0.45437219702381176, 'recall': 0.44338340992398256, 'f1-score': 0.4303014289946583, 'support': 2412199}, 'weighted avg': {'precision': 0.4548319057200029, 'recall': 0.4549894100776926, 'f1-score': 0.4363297323996376, 'support': 2412199}}
[[320326 338448 106838]
 [186887 595179 102400]
 [231072 349029 182020]]
Evaluating performance on  val set...
3323/3323 - 48s - 48s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0750959
{'0': {'precision': 0.4487023008563907, 'recall': 0.33954674177715694, 'f1-score': 0.38656667130144606, 'support': 262014}, '1': {'precision': 0.46858211512437636, 'recall': 0.7332901107024485, 'f1-score': 0.5717856252753626, 'support': 330074}, '2': {'precision': 0.45060152040741014, 'recall': 0.23644045807143715, 'f1-score': 0.3101424169996165, 'support': 258213}, 'accuracy': 0.46108142881167963, 'macro avg': {'precision': 0.4559619787960591, 'recall': 0.4364257701836809, 'f1-score': 0.4228315711921417, 'support': 850301}, 'weighted avg': {'precision': 0.45699608504883366, 'recall': 0.46108142881167963, 'f1-score': 0.4352579289125134, 'support': 850301}}
[[ 88966 135846  37202]
 [ 50798 242040  37236]
 [ 58510 138651  61052]]
testing model out of sample: results/universal/W6/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 245s - 245s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935057
{'0': {'precision': 0.42175657464378635, 'recall': 0.4918208963784247, 'f1-score': 0.4541020398909507, 'support': 1394835}, '1': {'precision': 0.4718726226013808, 'recall': 0.7030710632149094, 'f1-score': 0.5647249148692106, 'support': 1692085}, '2': {'precision': 0.5298574912654503, 'recall': 0.12787802803987633, 'f1-score': 0.2060315404487934, 'support': 1398223}, 'accuracy': 0.4580605345247632, 'macro avg': {'precision': 0.4744955628368725, 'recall': 0.44092332921107014, 'f1-score': 0.4082861650696516, 'support': 4485143}, 'weighted avg': {'precision': 0.474363548590842, 'recall': 0.4580605345247632, 'f1-score': 0.4185012640552811, 'support': 4485143}}
[[ 686009  627954   80872]
 [ 424650 1189656   77779]
 [ 515893  703528  178802]]
Evaluating performance on  train set...
5153/5153 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0796276
{'0': {'precision': 0.4383222703329441, 'recall': 0.39114635933384817, 'f1-score': 0.4133927532004453, 'support': 403992}, '1': {'precision': 0.49156487926199727, 'recall': 0.69877136741714, 'f1-score': 0.5771335012513275, 'support': 512521}, '2': {'precision': 0.45893362028029605, 'recall': 0.26198576480594477, 'f1-score': 0.3335576154327194, 'support': 402102}, 'accuracy': 0.4713278705308221, 'macro avg': {'precision': 0.4629402566250791, 'recall': 0.45063449718564424, 'f1-score': 0.44136128996149737, 'support': 1318615}, 'weighted avg': {'precision': 0.46530195751036685, 'recall': 0.4713278705308221, 'f1-score': 0.45269057960550524, 'support': 1318615}}
[[158020 187599  58373]
 [ 88561 358135  65825]
 [113930 182827 105345]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0571014
{'0': {'precision': 0.43725550896349874, 'recall': 0.4501977601669009, 'f1-score': 0.4436322623475077, 'support': 138046}, '1': {'precision': 0.5141782693455971, 'recall': 0.7051693655975791, 'f1-score': 0.5947159835437625, 'support': 184394}, '2': {'precision': 0.4666134360371362, 'recall': 0.21842112977457273, 'f1-score': 0.2975564707350555, 'support': 136452}, 'accuracy': 0.48373255580833835, 'macro avg': {'precision': 0.4726824047820773, 'recall': 0.4579294185130176, 'f1-score': 0.44530157220877525, 'support': 458892}, 'weighted avg': {'precision': 0.47689455985771484, 'recall': 0.48373255580833835, 'f1-score': 0.46090560284845317, 'support': 458892}}
[[ 62148  60633  15265]
 [ 35561 130029  18804]
 [ 44423  62225  29804]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2505219
{'0': {'precision': 0.368500491808839, 'recall': 0.4760381636744038, 'f1-score': 0.41542277856640997, 'support': 91291}, '1': {'precision': 0.32113666674117286, 'recall': 0.5292940208514976, 'f1-score': 0.3997403199629029, 'support': 81433}, '2': {'precision': 0.4477746061951581, 'recall': 0.08613729497778184, 'f1-score': 0.14448111477814446, 'support': 98343}, 'accuracy': 0.35058122161679584, 'macro avg': {'precision': 0.3791372549150567, 'recall': 0.3638231598345611, 'f1-score': 0.3198814044358191, 'support': 271067}, 'weighted avg': {'precision': 0.3830322343830311, 'recall': 0.35058122161679584, 'f1-score': 0.31241398113482005, 'support': 271067}}
[[43458 42328  5505]
 [33389 43102  4942]
 [41085 48787  8471]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2026798
{'0': {'precision': 0.3765729314181671, 'recall': 0.5035710420950114, 'f1-score': 0.4309095539042063, 'support': 18482}, '1': {'precision': 0.3719958800640879, 'recall': 0.3625969100340231, 'f1-score': 0.3672362660641152, 'support': 17929}, '2': {'precision': 0.3686267845003399, 'recall': 0.24720765899247776, 'f1-score': 0.29594760540319276, 'support': 17548}, 'accuracy': 0.37335754925035675, 'macro avg': {'precision': 0.3723985319941983, 'recall': 0.37112520370717067, 'f1-score': 0.3646978084571715, 'support': 53959}, 'weighted avg': {'precision': 0.37246794541321304, 'recall': 0.37335754925035675, 'f1-score': 0.3658618204402655, 'support': 53959}}
[[9307 5627 3548]
 [7546 6501 3882]
 [7862 5348 4338]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1968096
{'0': {'precision': 0.3856648541769649, 'recall': 0.5403047091412743, 'f1-score': 0.45007210845111045, 'support': 7220}, '1': {'precision': 0.3558823529411765, 'recall': 0.39377033937703393, 'f1-score': 0.3738689031118958, 'support': 6453}, '2': {'precision': 0.43021880544056773, 'recall': 0.20893164847788628, 'f1-score': 0.2812681229460661, 'support': 6964}, 'accuracy': 0.3826622086543587, 'macro avg': {'precision': 0.390588670852903, 'recall': 0.3810022323320648, 'f1-score': 0.3684030448363575, 'support': 20637}, 'weighted avg': {'precision': 0.39138696669938516, 'recall': 0.3826622086543587, 'f1-score': 0.36928079967991884, 'support': 20637}}
[[3901 2354  965]
 [2950 2541  962]
 [3264 2245 1455]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95236003
{'0': {'precision': 0.3761475365310446, 'recall': 0.7174266980447879, 'f1-score': 0.4935344608147598, 'support': 135126}, '1': {'precision': 0.6809479709110784, 'recall': 0.6255901695364423, 'f1-score': 0.6520963198546116, 'support': 286782}, '2': {'precision': 0.6185197862088939, 'recall': 0.17114091515076457, 'f1-score': 0.2681000639094312, 'support': 137267}, 'accuracy': 0.5362239012831403, 'macro avg': {'precision': 0.5585384312170056, 'recall': 0.5047192609106649, 'f1-score': 0.47124361485960087, 'support': 559175}, 'weighted avg': {'precision': 0.5919672526644629, 'recall': 0.5362239012831403, 'f1-score': 0.5195155645822083, 'support': 559175}}
[[ 96943  33776   4407]
 [ 97292 179408  10082]
 [ 63491  50284  23492]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8657562
{'0': {'precision': 0.38716825973193786, 'recall': 0.522803475502037, 'f1-score': 0.44487736037183045, 'support': 27737}, '1': {'precision': 0.7497802636835798, 'recall': 0.6944910445551883, 'f1-score': 0.7210773703556655, 'support': 81068}, '2': {'precision': 0.46367467340918667, 'recall': 0.4005606319851469, 'f1-score': 0.4298130822867634, 'support': 27469}, 'accuracy': 0.6002979291721091, 'macro avg': {'precision': 0.5335410656082348, 'recall': 0.5392850506807907, 'f1-score': 0.5319226043380865, 'support': 136274}, 'weighted avg': {'precision': 0.6183039467569907, 'recall': 0.6002979291721091, 'f1-score': 0.6061493693731868, 'support': 136274}}
[[14501 10192  3044]
 [15084 56301  9683]
 [ 7869  8597 11003]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8891936
{'0': {'precision': 0.4067442794058611, 'recall': 0.5145236644322567, 'f1-score': 0.4543294022689566, 'support': 9846}, '1': {'precision': 0.7545022607096329, 'recall': 0.6760394136024994, 'f1-score': 0.713119058397465, 'support': 29127}, '2': {'precision': 0.3691574256399627, 'recall': 0.3859573084841261, 'f1-score': 0.3773704841614578, 'support': 9229}, 'accuracy': 0.5875067424588192, 'macro avg': {'precision': 0.5101346552518189, 'recall': 0.5255067955062941, 'f1-score': 0.5149396482759598, 'support': 48202}, 'weighted avg': {'precision': 0.6096872620213021, 'recall': 0.5875067424588192, 'f1-score': 0.5959731610101076, 'support': 48202}}
[[ 5066  3430  1350]
 [ 4699 19691  4737]
 [ 2690  2977  3562]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2363874
{'0': {'precision': 0.4483836658394302, 'recall': 0.36497831257870433, 'f1-score': 0.40240463185703335, 'support': 114352}, '1': {'precision': 0.3122441529997653, 'recall': 0.5711730617890445, 'f1-score': 0.4037626750056896, 'support': 83866}, '2': {'precision': 0.4574014080119619, 'recall': 0.26108873656415865, 'f1-score': 0.3324258700610699, 'support': 112479}, 'accuracy': 0.3830259062688085, 'macro avg': {'precision': 0.40600974228371917, 'recall': 0.3990800369773025, 'f1-score': 0.37953105897459755, 'support': 310697}, 'weighted avg': {'precision': 0.41490033718808456, 'recall': 0.3830259062688085, 'f1-score': 0.37743738884746786, 'support': 310697}}
[[41736 53512 19104]
 [20231 47902 15733]
 [31114 51998 29367]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1872413
{'0': {'precision': 0.40980445621689, 'recall': 0.4707580096652944, 'f1-score': 0.43817159516867965, 'support': 44696}, '1': {'precision': 0.38110161255132197, 'recall': 0.45065203114738717, 'f1-score': 0.41296895317722154, 'support': 42636}, '2': {'precision': 0.4285763211068872, 'recall': 0.28683414321078204, 'f1-score': 0.3436637510813297, 'support': 43628}, 'accuracy': 0.40293982895540625, 'macro avg': {'precision': 0.40649412995836637, 'recall': 0.40274806134115454, 'f1-score': 0.3982680998090769, 'support': 130960}, 'weighted avg': {'precision': 0.40671347025854887, 'recall': 0.40293982895540625, 'f1-score': 0.3984821627787078, 'support': 130960}}
[[21041 15679  7976]
 [14713 19214  8709]
 [15590 15524 12514]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1814529
{'0': {'precision': 0.39739304812834225, 'recall': 0.49305411569562513, 'f1-score': 0.44008513000832794, 'support': 14469}, '1': {'precision': 0.3862727954034474, 'recall': 0.44773418271318954, 'f1-score': 0.41473881848052035, 'support': 13814}, '2': {'precision': 0.4525754110857018, 'recall': 0.2796017222820237, 'f1-score': 0.34565642283860776, 'support': 14864}, 'accuracy': 0.40501077711080724, 'macro avg': {'precision': 0.41208041820583047, 'recall': 0.4067966735636128, 'f1-score': 0.4001601237758187, 'support': 43147}, 'weighted avg': {'precision': 0.41284291652838156, 'recall': 0.40501077711080724, 'f1-score': 0.3994398417886173, 'support': 43147}}
[[7134 4923 2412]
 [5014 6185 2615]
 [5804 4904 4156]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2755692
{'0': {'precision': 0.3741954493370437, 'recall': 0.5705485948185494, 'f1-score': 0.4519672584918344, 'support': 100165}, '1': {'precision': 0.2651230657859017, 'recall': 0.3074572046960058, 'f1-score': 0.2847251325595379, 'support': 76235}, '2': {'precision': 0.4378529623164596, 'recall': 0.1645015382538167, 'f1-score': 0.23915314241648847, 'support': 103689}, 'accuracy': 0.3486213310769077, 'macro avg': {'precision': 0.35905715914646835, 'recall': 0.3475024459227906, 'f1-score': 0.32528184448928693, 'support': 280089}, 'weighted avg': {'precision': 0.3680740047365822, 'recall': 0.3486213310769077, 'f1-score': 0.3276632467234852, 'support': 280089}}
[[57149 31475 11541]
 [42438 23439 10358]
 [53138 33494 17057]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2107509
{'0': {'precision': 0.35868766404199476, 'recall': 0.3577955229742113, 'f1-score': 0.35824103807588964, 'support': 38195}, '1': {'precision': 0.34222782505165106, 'recall': 0.5145038167938931, 'f1-score': 0.4110447510094212, 'support': 37990}, '2': {'precision': 0.3986046511627907, 'recall': 0.20096928007504103, 'f1-score': 0.2672140518630151, 'support': 38379}, 'accuracy': 0.3572239097796865, 'macro avg': {'precision': 0.3665067134188122, 'recall': 0.35775620661438184, 'f1-score': 0.3454999469827753, 'support': 114564}, 'weighted avg': {'precision': 0.36660171003782127, 'recall': 0.3572239097796865, 'f1-score': 0.34525692745196723, 'support': 114564}}
[[13666 18787  5742]
 [12549 19546  5895]
 [11885 18781  7713]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2265333
{'0': {'precision': 0.3848314606741573, 'recall': 0.26807895184618, 'f1-score': 0.3160164476983251, 'support': 11754}, '1': {'precision': 0.32893466366269714, 'recall': 0.6542295381801555, 'f1-score': 0.43776771508995227, 'support': 10935}, '2': {'precision': 0.41046319272125725, 'recall': 0.16426679907315458, 'f1-score': 0.23463356973995272, 'support': 12084}, 'accuracy': 0.3534351364564461, 'macro avg': {'precision': 0.37474310568603725, 'recall': 0.3621917630331634, 'f1-score': 0.32947257750941, 'support': 34773}, 'weighted avg': {'precision': 0.3761610087354934, 'recall': 0.3534351364564461, 'f1-score': 0.32602189478883986, 'support': 34773}}
[[3151 7156 1447]
 [2377 7154 1404]
 [2660 7439 1985]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2442261
{'0': {'precision': 0.39466895449973377, 'recall': 0.43209260746767547, 'f1-score': 0.4125337835748434, 'support': 154372}, '1': {'precision': 0.3225233953171783, 'recall': 0.5960548554141553, 'f1-score': 0.4185634389022566, 'support': 129577}, '2': {'precision': 0.44653134476143325, 'recall': 0.09200510041440867, 'f1-score': 0.15257337393216613, 'support': 156850}, 'accuracy': 0.3592771308464856, 'macro avg': {'precision': 0.38790789819278176, 'recall': 0.37338418776541316, 'f1-score': 0.32789019880308873, 'support': 440799}, 'weighted avg': {'precision': 0.39191534296783276, 'recall': 0.3592771308464856, 'f1-score': 0.3218042546873148, 'support': 440799}}
[[66703 78814  8855]
 [43310 77235  9032]
 [58997 83422 14431]]
Evaluating performance on  train set...
618/618 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2057874
{'0': {'precision': 0.3881494454173964, 'recall': 0.38011662474273955, 'f1-score': 0.38409104037894976, 'support': 52476}, '1': {'precision': 0.3837826303435522, 'recall': 0.5123831953202157, 'f1-score': 0.43885576711916513, 'support': 52652}, '2': {'precision': 0.41218153744347635, 'recall': 0.28299100804543303, 'f1-score': 0.3355819200161629, 'support': 52825}, 'accuracy': 0.39172412046621463, 'macro avg': {'precision': 0.39470453773480835, 'recall': 0.3918302760361294, 'f1-score': 0.38617624250475924, 'support': 157953}, 'weighted avg': {'precision': 0.3947309836851699, 'recall': 0.39172412046621463, 'f1-score': 0.3861231518878265, 'support': 157953}}
[[19947 21208 11321]
 [15676 26978  9998]
 [15767 22109 14949]]
Evaluating performance on  val set...
225/225 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1902633
{'0': {'precision': 0.401144578313253, 'recall': 0.3514355077052987, 'f1-score': 0.3746483627770901, 'support': 18948}, '1': {'precision': 0.3810554071870457, 'recall': 0.5822314049586776, 'f1-score': 0.4606362763327271, 'support': 19360}, '2': {'precision': 0.4185530403905903, 'recall': 0.24636848155502142, 'f1-score': 0.31016675985922443, 'support': 19138}, 'accuracy': 0.39421369634091147, 'macro avg': {'precision': 0.4002510086302964, 'recall': 0.39334513140633254, 'f1-score': 0.3818171329896805, 'support': 57446}, 'weighted avg': {'precision': 0.40017387181032343, 'recall': 0.39421369634091147, 'f1-score': 0.3821454398546067, 'support': 57446}}
[[ 6659  8962  3327]
 [ 4865 11272  3223]
 [ 5076  9347  4715]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
4450/4450 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93611014
{'0': {'precision': 0.4806339128648861, 'recall': 0.6313587031427323, 'f1-score': 0.5457813290204662, 'support': 341009}, '1': {'precision': 0.5868539828406457, 'recall': 0.6902394963554902, 'f1-score': 0.6343620167963134, 'support': 460007}, '2': {'precision': 0.6044748779366803, 'recall': 0.2684018278345484, 'f1-score': 0.3717413033148175, 'support': 338105}, 'accuracy': 0.5474062895864443, 'macro avg': {'precision': 0.5573209245474041, 'recall': 0.5300000091109237, 'f1-score': 0.5172948830438657, 'support': 1139121}, 'weighted avg': {'precision': 0.560285877164498, 'recall': 0.5474062895864443, 'f1-score': 0.5298953375853999, 'support': 1139121}}
[[215299 102141  23569]
 [106682 317515  35810]
 [125967 121390  90748]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9330357
{'0': {'precision': 0.435804925742063, 'recall': 0.6180910901917894, 'f1-score': 0.511183527768019, 'support': 102404}, '1': {'precision': 0.6303881528345016, 'recall': 0.6464677324386477, 'f1-score': 0.6383266967233796, 'support': 180026}, '2': {'precision': 0.5712648278873445, 'recall': 0.30666380177558134, 'f1-score': 0.39908994426544137, 'support': 102389}, 'accuracy': 0.5485046216532967, 'macro avg': {'precision': 0.5458193021546364, 'recall': 0.5237408748020062, 'f1-score': 0.51620005625228, 'support': 384819}, 'weighted avg': {'precision': 0.5628767282291973, 'recall': 0.5485046216532967, 'f1-score': 0.5408388364017204, 'support': 384819}}
[[ 63295  32382   6727]
 [ 46807 116381  16838]
 [ 35135  35855  31399]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9191041
{'0': {'precision': 0.4468098402316329, 'recall': 0.6311236649307088, 'f1-score': 0.5232090152938019, 'support': 33987}, '1': {'precision': 0.6266287643756945, 'recall': 0.707459720117948, 'f1-score': 0.6645955128401335, 'support': 61383}, '2': {'precision': 0.6181928349617511, 'recall': 0.23226430665035144, 'f1-score': 0.33766341221247725, 'support': 35141}, 'accuracy': 0.559630988958785, 'macro avg': {'precision': 0.5638771465230262, 'recall': 0.5236158972330027, 'f1-score': 0.5084893134488043, 'support': 130511}, 'weighted avg': {'precision': 0.5775298166209488, 'recall': 0.559630988958785, 'f1-score': 0.5397476161857241, 'support': 130511}}
[[21450 11147  1390]
 [14306 43426  3651]
 [12251 14728  8162]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
6203/6203 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94446665
{'0': {'precision': 0.3991215792790954, 'recall': 0.5796180849696687, 'f1-score': 0.47272649490379787, 'support': 381289}, '1': {'precision': 0.6371993531615254, 'recall': 0.7622665904296414, 'f1-score': 0.6941444778742021, 'support': 816751}, '2': {'precision': 0.6202686844271627, 'recall': 0.09084122985681085, 'f1-score': 0.15847330772139523, 'support': 389834}, 'accuracy': 0.5535684821339728, 'macro avg': {'precision': 0.5521965389559278, 'recall': 0.4775753017520403, 'f1-score': 0.4417814268331317, 'support': 1587874}, 'weighted avg': {'precision': 0.5758742186475467, 'recall': 0.5535684821339728, 'f1-score': 0.5094654187963711, 'support': 1587874}}
[[221002 151140   9147]
 [181636 622582  12533]
 [151083 203338  35413]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9215487
{'0': {'precision': 0.48003698730778, 'recall': 0.3342093427283871, 'f1-score': 0.39406464627558635, 'support': 113393}, '1': {'precision': 0.6200260914880892, 'recall': 0.7861707458768121, 'f1-score': 0.6932832756496744, 'support': 225493}, '2': {'precision': 0.4695849784225507, 'recall': 0.3617346713231068, 'f1-score': 0.4086639065488705, 'support': 113105}, 'accuracy': 0.5665754406614291, 'macro avg': {'precision': 0.5232160190728067, 'recall': 0.49403825330943535, 'f1-score': 0.4986706094913771, 'support': 451991}, 'weighted avg': {'precision': 0.5472604245088893, 'recall': 0.5665754406614291, 'f1-score': 0.5469945845413063, 'support': 451991}}
[[ 37897  56986  18510]
 [ 20513 177276  27704]
 [ 20536  51655  40914]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90201855
{'0': {'precision': 0.46677061001754044, 'recall': 0.35202986741923153, 'f1-score': 0.4013607722214774, 'support': 34017}, '1': {'precision': 0.6488432426129794, 'recall': 0.8224274893774247, 'f1-score': 0.7253954114886592, 'support': 81195}, '2': {'precision': 0.44266666666666665, 'recall': 0.2626902008520998, 'f1-score': 0.3297173414820474, 'support': 32860}, 'accuracy': 0.5901453347020369, 'macro avg': {'precision': 0.5194268397657288, 'recall': 0.47904918588291867, 'f1-score': 0.4854911750640613, 'support': 148072}, 'weighted avg': {'precision': 0.5612606677264724, 'recall': 0.5901453347020369, 'f1-score': 0.5631455080337927, 'support': 148072}}
[[11975 18387  3655]
 [ 7205 66777  7213]
 [ 6475 17753  8632]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
5183/5183 - 72s - 72s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1027852
{'0': {'precision': 0.4813986944643602, 'recall': 0.4501397786327108, 'f1-score': 0.46524477092140926, 'support': 456436}, '1': {'precision': 0.4000607373969901, 'recall': 0.7841362535181597, 'f1-score': 0.5298140937847823, 'support': 408239}, '2': {'precision': 0.5545476390724499, 'recall': 0.11984031676998474, 'f1-score': 0.1970888244807763, 'support': 462165}, 'accuracy': 0.4378530945705586, 'macro avg': {'precision': 0.47866902364460007, 'recall': 0.45137211630695173, 'f1-score': 0.3973825630623226, 'support': 1326840}, 'weighted avg': {'precision': 0.48185206919648443, 'recall': 0.4378530945705586, 'f1-score': 0.3917072101075096, 'support': 1326840}}
[[205460 223694  27282]
 [ 70916 320115  17208]
 [150422 256357  55386]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0537922
{'0': {'precision': 0.48994928538497, 'recall': 0.41368222727414283, 'f1-score': 0.4485972629108378, 'support': 128444}, '1': {'precision': 0.4619300855728952, 'recall': 0.6985280625473692, 'f1-score': 0.5561098919943726, 'support': 125345}, '2': {'precision': 0.508372356177246, 'recall': 0.3318012539480507, 'f1-score': 0.401532690908918, 'support': 127278}, 'accuracy': 0.48002844644117704, 'macro avg': {'precision': 0.4867505757117037, 'recall': 0.481337181256521, 'f1-score': 0.4687466152713761, 'support': 381067}, 'weighted avg': {'precision': 0.4868862676055632, 'recall': 0.48002844644117704, 'f1-score': 0.4682418028400768, 'support': 381067}}
[[53135 52530 22779]
 [19727 87557 18061]
 [35588 49459 42231]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0436032
{'0': {'precision': 0.4898079839601059, 'recall': 0.4493467905485073, 'f1-score': 0.46870580132580647, 'support': 42406}, '1': {'precision': 0.4771566746818685, 'recall': 0.7311378361035789, 'f1-score': 0.5774540817577675, 'support': 48311}, '2': {'precision': 0.5164203198305, 'recall': 0.2435351492803616, 'f1-score': 0.3309838662743703, 'support': 42035}, 'accuracy': 0.4867271302880559, 'macro avg': {'precision': 0.4944616594908248, 'recall': 0.4746732586441493, 'f1-score': 0.45904791645264803, 'support': 132752}, 'weighted avg': {'precision': 0.49363054132851536, 'recall': 0.4867271302880559, 'f1-score': 0.46467269173846576, 'support': 132752}}
[[19055 18933  4418]
 [ 7821 35322  5168]
 [12027 19771 10237]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 100s - 100s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1376885
{'0': {'precision': 0.4519778821207075, 'recall': 0.4792840737470755, 'f1-score': 0.4652306458380522, 'support': 653531}, '1': {'precision': 0.3921806683169291, 'recall': 0.6867232426807797, 'f1-score': 0.4992466474873847, 'support': 580458}, '2': {'precision': 0.552042495522966, 'recall': 0.1424123286880167, 'f1-score': 0.22641546888666947, 'support': 640717}, 'accuracy': 0.4283802366877793, 'macro avg': {'precision': 0.46540034865353413, 'recall': 0.4361398817052906, 'f1-score': 0.3969642540707021, 'support': 1874706}, 'weighted avg': {'precision': 0.4676621162220233, 'recall': 0.4283802366877793, 'f1-score': 0.39414318815381216, 'support': 1874706}}
[[313227 301803  38501]
 [146303 398614  35541]
 [233484 315987  91246]]
Evaluating performance on  train set...
2046/2046 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1381391
{'0': {'precision': 0.4530677715146635, 'recall': 0.3987939066563777, 'f1-score': 0.42420188913851753, 'support': 174945}, '1': {'precision': 0.4211082521595295, 'recall': 0.7382156480314824, 'f1-score': 0.5362930949808467, 'support': 173811}, '2': {'precision': 0.4979406159709842, 'recall': 0.18514708907632174, 'f1-score': 0.26992801919488135, 'support': 174996}, 'accuracy': 0.44004987093128045, 'macro avg': {'precision': 0.45737221321505905, 'recall': 0.4407188812547273, 'f1-score': 0.41014100110474855, 'support': 523752}, 'weighted avg': {'precision': 0.45745468033762376, 'recall': 0.44004987093128045, 'f1-score': 0.4098542101492335, 'support': 523752}}
[[ 69767  88041  17137]
 [ 29970 128310  15531]
 [ 54251  88345  32400]]
Evaluating performance on  val set...
741/741 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0940629
{'0': {'precision': 0.45063851713621234, 'recall': 0.5104587329631499, 'f1-score': 0.4786869725367791, 'support': 63392}, '1': {'precision': 0.44486148530530817, 'recall': 0.6805039954697036, 'f1-score': 0.5380119140892189, 'support': 63572}, '2': {'precision': 0.5273408969177582, 'recall': 0.17293137035735956, 'f1-score': 0.26045236463331045, 'support': 62626}, 'accuracy': 0.4559839653990189, 'macro avg': {'precision': 0.4742802997864262, 'recall': 0.45463136626340434, 'f1-score': 0.4257170837531028, 'support': 189590}, 'weighted avg': {'precision': 0.4740379884619408, 'recall': 0.4559839653990189, 'f1-score': 0.4264914170212407, 'support': 189590}}
[[32359 26015  5018]
 [15622 43261  4689]
 [23826 27970 10830]]
testing model on single stock: results/universal/W6/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 419s - 419s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2309229
{'0': {'precision': 0.3359521012547919, 'recall': 0.47808429856423174, 'f1-score': 0.3946099332051601, 'support': 2212683}, '1': {'precision': 0.4318410394411373, 'recall': 0.5411338276524128, 'f1-score': 0.48034908714185903, 'support': 3112025}, '2': {'precision': 0.3324730461264493, 'recall': 0.07062972655864497, 'f1-score': 0.11650865202247314, 'support': 2188696}, 'accuracy': 0.3855054247049673, 'macro avg': {'precision': 0.36675539560745946, 'recall': 0.3632826175917632, 'f1-score': 0.3304892241231641, 'support': 7513404}, 'weighted avg': {'precision': 0.3746554877379597, 'recall': 0.3855054247049673, 'f1-score': 0.3491103472399216, 'support': 7513404}}
[[1057849 1060030   94804]
 [1212433 1684022  215570]
 [ 878527 1155582  154587]]
Evaluating performance on  train set...
5452/5452 - 81s - 81s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1585648
{'0': {'precision': 0.42953095510734246, 'recall': 0.37524315746365433, 'f1-score': 0.40055600523218676, 'support': 468832}, '1': {'precision': 0.4065703361252426, 'recall': 0.6853296582666177, 'f1-score': 0.5103667203025192, 'support': 460037}, '2': {'precision': 0.4279686185808034, 'recall': 0.19301723509770555, 'f1-score': 0.2660457367192035, 'support': 466606}, 'accuracy': 0.41653630484243714, 'macro avg': {'precision': 0.4213566366044628, 'recall': 0.41786335027599253, 'f1-score': 0.39232282075130315, 'support': 1395475}, 'weighted avg': {'precision': 0.4214392803213588, 'recall': 0.41653630484243714, 'f1-score': 0.39178027910240404, 'support': 1395475}}
[[175926 224282  68624]
 [ 93004 315277  51756]
 [140647 235896  90063]]
Evaluating performance on  val set...
1969/1969 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1305745
{'0': {'precision': 0.4443176581597946, 'recall': 0.2468952146371501, 'f1-score': 0.3174127910394532, 'support': 164021}, '1': {'precision': 0.4197098503049344, 'recall': 0.7556816291218846, 'f1-score': 0.539678956310968, 'support': 180318}, '2': {'precision': 0.4235279455252037, 'recall': 0.23403496030652876, 'f1-score': 0.30147791197048207, 'support': 159724}, 'accuracy': 0.4248278488998399, 'macro avg': {'precision': 0.4291851513299776, 'recall': 0.4122039346885212, 'f1-score': 0.38618988644030106, 'support': 504063}, 'weighted avg': {'precision': 0.4289270288979363, 'recall': 0.4248278488998399, 'f1-score': 0.3918745304748346, 'support': 504063}}
[[ 40496  94962  28563]
 [ 21738 136263  22317]
 [ 28908  93435  37381]]
training model: results/universal/W6/deepLOB_L2/h100
Epoch 1/50
9426/9426 - 388s - loss: 3.1855 - accuracy100: 0.4252 - val_loss: 3.2837 - val_accuracy100: 0.3911 - 388s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 385s - loss: 3.1438 - accuracy100: 0.4423 - val_loss: 3.4403 - val_accuracy100: 0.3664 - 385s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 387s - loss: 3.1280 - accuracy100: 0.4483 - val_loss: 3.6213 - val_accuracy100: 0.3661 - 387s/epoch - 41ms/step
Epoch 4/50
9426/9426 - 382s - loss: 3.1193 - accuracy100: 0.4509 - val_loss: 3.5220 - val_accuracy100: 0.3686 - 382s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 382s - loss: 3.1114 - accuracy100: 0.4537 - val_loss: 3.6223 - val_accuracy100: 0.3599 - 382s/epoch - 41ms/step
Epoch 6/50
9426/9426 - 381s - loss: 3.1048 - accuracy100: 0.4557 - val_loss: 3.5365 - val_accuracy100: 0.3699 - 381s/epoch - 40ms/step
Epoch 7/50
9426/9426 - 382s - loss: 3.0987 - accuracy100: 0.4576 - val_loss: 3.5550 - val_accuracy100: 0.3746 - 382s/epoch - 41ms/step
Epoch 8/50
9426/9426 - 381s - loss: 3.0929 - accuracy100: 0.4594 - val_loss: 3.5039 - val_accuracy100: 0.3725 - 381s/epoch - 40ms/step
Epoch 9/50
9426/9426 - 378s - loss: 3.0891 - accuracy100: 0.4606 - val_loss: 3.5040 - val_accuracy100: 0.3700 - 378s/epoch - 40ms/step
Epoch 10/50
9426/9426 - 384s - loss: 3.0853 - accuracy100: 0.4616 - val_loss: 3.5469 - val_accuracy100: 0.3737 - 384s/epoch - 41ms/step
Epoch 11/50
9426/9426 - 387s - loss: 3.0814 - accuracy100: 0.4627 - val_loss: 3.5348 - val_accuracy100: 0.3802 - 387s/epoch - 41ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 595s - 595s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977653
{'0': {'precision': 0.3428094052187777, 'recall': 0.43421341482745607, 'f1-score': 0.3831353176117986, 'support': 3343554}, '1': {'precision': 0.40977460144337435, 'recall': 0.6230593780462776, 'f1-score': 0.49439486574720726, 'support': 4126963}, '2': {'precision': 0.3835842856124294, 'recall': 0.0353506692727125, 'f1-score': 0.06473540133509449, 'support': 3348112}, 'accuracy': 0.38281347849159075, 'macro avg': {'precision': 0.37872276409152716, 'recall': 0.36420782071548213, 'f1-score': 0.3140885282313668, 'support': 10818629}, 'weighted avg': {'precision': 0.38097336790306974, 'recall': 0.38281347849159075, 'f1-score': 0.32703998964247105, 'support': 10818629}}
[[1451816 1808185   83553]
 [1448973 2571343  106647]
 [1334264 1895490  118358]]
Evaluating performance on  train set...
9426/9426 - 132s - 132s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986865
{'0': {'precision': 0.38915583229423956, 'recall': 0.30494051049327936, 'f1-score': 0.3419392117372681, 'support': 803419}, '1': {'precision': 0.37159259793858523, 'recall': 0.6861567772401904, 'f1-score': 0.48210055317641864, 'support': 810411}, '2': {'precision': 0.39426127548952467, 'recall': 0.14133314294517949, 'f1-score': 0.20807604892284004, 'support': 798369}, 'accuracy': 0.37886592275347103, 'macro avg': {'precision': 0.3850032352407831, 'recall': 0.37747681022621643, 'f1-score': 0.34403860461217556, 'support': 2412199}, 'weighted avg': {'precision': 0.3849449812247285, 'recall': 0.37886592275347103, 'f1-score': 0.34472343204581285, 'support': 2412199}}
[[244995 467417  91007]
 [171989 556069  82353]
 [212571 472962 112836]]
Evaluating performance on  val set...
3323/3323 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0940824
{'0': {'precision': 0.3804188413923996, 'recall': 0.26128014457545773, 'f1-score': 0.3097897676379156, 'support': 270032}, '1': {'precision': 0.40368559495979317, 'recall': 0.6880340240470708, 'f1-score': 0.5088292259558196, 'support': 312720}, '2': {'precision': 0.3584187253020638, 'recall': 0.17662185244572023, 'f1-score': 0.23663468472077562, 'support': 267549}, 'accuracy': 0.39159191862646286, 'macro avg': {'precision': 0.3808410538847522, 'recall': 0.3753120070227496, 'f1-score': 0.35175122610483694, 'support': 850301}, 'weighted avg': {'precision': 0.3820534038776161, 'recall': 0.39159191862646286, 'f1-score': 0.35997323222960376, 'support': 850301}}
[[ 70554 158357  41121]
 [ 54091 215162  43467]
 [ 60819 159475  47255]]
testing model out of sample: results/universal/W6/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 248s - 248s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0935576
{'0': {'precision': 0.36923770084241175, 'recall': 0.43045330699401085, 'f1-score': 0.3975025049349877, 'support': 1433598}, '1': {'precision': 0.4082303396058495, 'recall': 0.6827989652517656, 'f1-score': 0.5109656582572323, 'support': 1601549}, '2': {'precision': 0.4078151938259821, 'recall': 0.03801044968399913, 'f1-score': 0.06953946741713524, 'support': 1449996}, 'accuracy': 0.39368822800075715, 'macro avg': {'precision': 0.3950944114247477, 'recall': 0.3837542406432585, 'f1-score': 0.32600254353645175, 'support': 4485143}, 'weighted avg': {'precision': 0.39563280845328397, 'recall': 0.39368822800075715, 'f1-score': 0.3319910390110141, 'support': 4485143}}
[[ 617097  772465   44036]
 [ 472017 1093536   35996]
 [ 582159  812722   55115]]
Evaluating performance on  train set...
5153/5153 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0987104
{'0': {'precision': 0.38472109658550335, 'recall': 0.3001058259232281, 'f1-score': 0.3371860499231773, 'support': 436566}, '1': {'precision': 0.3764223385258312, 'recall': 0.6788875376960529, 'f1-score': 0.48430975639208607, 'support': 448986}, '2': {'precision': 0.39343112964844423, 'recall': 0.15290615915005437, 'f1-score': 0.22022308986783554, 'support': 433063}, 'accuracy': 0.38073660621182076, 'macro avg': {'precision': 0.38485818825325957, 'recall': 0.3772998409231118, 'f1-score': 0.3472396320610329, 'support': 1318615}, 'weighted avg': {'precision': 0.38475595654247063, 'recall': 0.38073660621182076, 'f1-score': 0.3488681209615039, 'support': 1318615}}
[[131016 252974  52576]
 [ 94660 304811  49515]
 [114872 251973  66218]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0902802
{'0': {'precision': 0.3816595769997323, 'recall': 0.3484563521431821, 'f1-score': 0.3643029788925604, 'support': 147281}, '1': {'precision': 0.4041525120521701, 'recall': 0.6612653063687771, 'f1-score': 0.5016849353955477, 'support': 165699}, '2': {'precision': 0.3887565418018795, 'recall': 0.14203766653873567, 'f1-score': 0.20805830652083343, 'support': 145912}, 'accuracy': 0.39577286158834757, 'macro avg': {'precision': 0.39152287695126065, 'recall': 0.38391977501689833, 'f1-score': 0.3580154069363139, 'support': 458892}, 'weighted avg': {'precision': 0.3920380302598998, 'recall': 0.39577286158834757, 'f1-score': 0.36422906210055944, 'support': 458892}}
[[ 51321  79916  16044]
 [ 39586 109571  16542]
 [ 43561  81626  20725]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1234509
{'0': {'precision': 0.3239941562061475, 'recall': 0.3947189695550351, 'f1-score': 0.35587673272030484, 'support': 85400}, '1': {'precision': 0.3392463020230574, 'recall': 0.5936434863441193, 'f1-score': 0.43175809184236047, 'support': 90364}, '2': {'precision': 0.3624409979770735, 'recall': 0.03383943842271492, 'f1-score': 0.061899597892534616, 'support': 95303}, 'accuracy': 0.3341535487536292, 'macro avg': {'precision': 0.3418938187354261, 'recall': 0.34073396477395645, 'f1-score': 0.2831781408184, 'support': 271067}, 'weighted avg': {'precision': 0.3425959936334028, 'recall': 0.3341535487536292, 'f1-score': 0.2778149998469357, 'support': 271067}}
[[33709 48936  2755]
 [33802 53644  2918]
 [36531 55547  3225]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1153425
{'0': {'precision': 0.35423970201577565, 'recall': 0.3469979073885282, 'f1-score': 0.3505814111077983, 'support': 18637}, '1': {'precision': 0.3279978387870192, 'recall': 0.5580580293019247, 'f1-score': 0.41316091709558045, 'support': 17405}, '2': {'precision': 0.361247947454844, 'recall': 0.12278841323882346, 'f1-score': 0.18327987670262838, 'support': 17917}, 'accuracy': 0.3406289960896236, 'macro avg': {'precision': 0.34782849608587957, 'recall': 0.3426147833097588, 'f1-score': 0.31567406830200234, 'support': 53959}, 'weighted avg': {'precision': 0.3481022106618825, 'recall': 0.3406289960896236, 'f1-score': 0.31521483110779686, 'support': 53959}}
[[6467 9972 2198]
 [6000 9713 1692]
 [5789 9928 2200]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011555
{'0': {'precision': 0.3451789264413519, 'recall': 0.4223810247833359, 'f1-score': 0.3798974358974359, 'support': 6577}, '1': {'precision': 0.37901222299513065, 'recall': 0.5218938149972633, 'f1-score': 0.4391226757239077, 'support': 7308}, '2': {'precision': 0.41963578780680916, 'recall': 0.15699052132701422, 'f1-score': 0.22849752101746065, 'support': 6752}, 'accuracy': 0.37079032805155787, 'macro avg': {'precision': 0.3812756457477639, 'recall': 0.3670884537025378, 'f1-score': 0.34917254421293475, 'support': 20637}, 'weighted avg': {'precision': 0.381520761938497, 'recall': 0.37079032805155787, 'f1-score': 0.3513354272422178, 'support': 20637}}
[[2778 3117  682]
 [2710 3814  784]
 [2560 3132 1060]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.075205
{'0': {'precision': 0.38748369567320906, 'recall': 0.5702429910800743, 'f1-score': 0.46142571711040287, 'support': 175562}, '1': {'precision': 0.45424845191646923, 'recall': 0.5949839652153383, 'f1-score': 0.5151776493010083, 'support': 203308}, '2': {'precision': 0.4555069398162905, 'recall': 0.08718560217409389, 'f1-score': 0.14635781319827199, 'support': 180305}, 'accuracy': 0.4234774444494121, 'macro avg': {'precision': 0.4324130291353229, 'recall': 0.4174708528231688, 'f1-score': 0.3743203932032277, 'support': 559175}, 'weighted avg': {'precision': 0.4336923782815571, 'recall': 0.4234774444494121, 'f1-score': 0.37937605361495125, 'support': 559175}}
[[100113  67836   7613]
 [ 71165 120965  11178]
 [ 87089  77496  15720]]
Evaluating performance on  train set...
533/533 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0462198
{'0': {'precision': 0.37840598212657306, 'recall': 0.27320130622563993, 'f1-score': 0.31731078043036076, 'support': 37972}, '1': {'precision': 0.5135190260692205, 'recall': 0.6558719614451554, 'f1-score': 0.5760310015443573, 'support': 61419}, '2': {'precision': 0.37745774972052343, 'recall': 0.3112545074966787, 'f1-score': 0.3411741979583042, 'support': 36883}, 'accuracy': 0.4559710583089951, 'macro avg': {'precision': 0.4231275859721057, 'recall': 0.4134425917224913, 'f1-score': 0.41150532664434075, 'support': 136274}, 'weighted avg': {'precision': 0.43904509443032236, 'recall': 0.4559710583089951, 'f1-score': 0.44037528054985303, 'support': 136274}}
[[10374 19999  7599]
 [ 9801 40283 11335]
 [ 7240 18163 11480]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0497907
{'0': {'precision': 0.39032620922384703, 'recall': 0.312073746533763, 'f1-score': 0.3468410311940361, 'support': 13343}, '1': {'precision': 0.5272973889454052, 'recall': 0.6902521306818182, 'f1-score': 0.5978699680879695, 'support': 22528}, '2': {'precision': 0.30469915464942815, 'recall': 0.1987673343605547, 'f1-score': 0.24058895705521474, 'support': 12331}, 'accuracy': 0.45983569146508446, 'macro avg': {'precision': 0.4074409176062268, 'recall': 0.40036440385871197, 'f1-score': 0.39509998544574015, 'support': 48202}, 'weighted avg': {'precision': 0.43243690020783326, 'recall': 0.45983569146508446, 'f1-score': 0.43698221961237405, 'support': 48202}}
[[ 4164  7419  1760]
 [ 3145 15550  3833]
 [ 3359  6521  2451]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1220082
{'0': {'precision': 0.4046034585569469, 'recall': 0.2931301139652834, 'f1-score': 0.33996202157455147, 'support': 115737}, '1': {'precision': 0.27992417039764445, 'recall': 0.604033521498023, 'f1-score': 0.3825603509034425, 'support': 80426}, '2': {'precision': 0.4170356472795497, 'recall': 0.1940733755915274, 'f1-score': 0.264880775051539, 'support': 114534}, 'accuracy': 0.33709369578721393, 'macro avg': {'precision': 0.3671877587447137, 'recall': 0.36374567035161126, 'f1-score': 0.3291343825098443, 'support': 310697}, 'weighted avg': {'precision': 0.3769123378626838, 'recall': 0.33709369578721393, 'f1-score': 0.32331125811477773, 'support': 310697}}
[[33926 63891 17920]
 [18694 48580 13152]
 [31230 61076 22228]]
Evaluating performance on  train set...
512/512 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1041138
{'0': {'precision': 0.37082794149962156, 'recall': 0.34561383547616337, 'f1-score': 0.35777720195048407, 'support': 43945}, '1': {'precision': 0.3605736470961097, 'recall': 0.514493736715959, 'f1-score': 0.4239967949613812, 'support': 44226}, '2': {'precision': 0.3563461967432523, 'recall': 0.2240061698099979, 'f1-score': 0.2750871755133669, 'support': 42789}, 'accuracy': 0.36291233964569336, 'macro avg': {'precision': 0.36258259511299445, 'recall': 0.3613712473340401, 'f1-score': 0.35228705747507744, 'support': 130960}, 'weighted avg': {'precision': 0.3626333339807608, 'recall': 0.36291233964569336, 'f1-score': 0.3531223774184295, 'support': 130960}}
[[15188 20310  8447]
 [12606 22754  8866]
 [13163 20041  9585]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1018962
{'0': {'precision': 0.36337321497491315, 'recall': 0.39891250617894214, 'f1-score': 0.38031440401252226, 'support': 14161}, '1': {'precision': 0.3636104377584486, 'recall': 0.5275134464211833, 'f1-score': 0.4304887313243859, 'support': 14502}, '2': {'precision': 0.38189576348674187, 'recall': 0.17301850317591824, 'f1-score': 0.23814501567993918, 'support': 14484}, 'accuracy': 0.3663058845342666, 'macro avg': {'precision': 0.3696264720733679, 'recall': 0.36648148525868124, 'f1-score': 0.34964938367228243, 'support': 43147}, 'weighted avg': {'precision': 0.3696707744217382, 'recall': 0.3663058845342666, 'f1-score': 0.34945354865913764, 'support': 43147}}
[[5649 6638 1874]
 [4670 7650 2182]
 [5227 6751 2506]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1357619
{'0': {'precision': 0.3729436240929619, 'recall': 0.37134195634599837, 'f1-score': 0.3721410668624522, 'support': 98960}, '1': {'precision': 0.2733221011816839, 'recall': 0.6218738923240519, 'f1-score': 0.37974226907429304, 'support': 76173}, '2': {'precision': 0.4528027177869449, 'recall': 0.035557757536491486, 'f1-score': 0.0659375607342886, 'support': 104956}, 'accuracy': 0.31365030401051097, 'macro avg': {'precision': 0.3663561476871969, 'recall': 0.34292453540218054, 'f1-score': 0.27260696555701125, 'support': 280089}, 'weighted avg': {'precision': 0.3757756552438636, 'recall': 0.31365030401051097, 'f1-score': 0.2594665640683225, 'support': 280089}}
[[36748 59802  2410]
 [26703 47370  2100]
 [35084 66140  3732]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1170993
{'0': {'precision': 0.34759084360493037, 'recall': 0.28443058866678894, 'f1-score': 0.31285479641529557, 'support': 38171}, '1': {'precision': 0.3370181741613697, 'recall': 0.6760202734808088, 'f1-score': 0.4497975744056767, 'support': 37882}, '2': {'precision': 0.38368292018523564, 'recall': 0.07314793175975695, 'f1-score': 0.12287091357163107, 'support': 38511}, 'accuracy': 0.34289130966097553, 'macro avg': {'precision': 0.35609731265051187, 'recall': 0.3445329313024516, 'f1-score': 0.29517442813086775, 'support': 114564}, 'weighted avg': {'precision': 0.35622730966166, 'recall': 0.34289130966097553, 'f1-score': 0.2942730168304282, 'support': 114564}}
[[10857 25041  2273]
 [10021 25609  2252]
 [10357 25337  2817]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1259576
{'0': {'precision': 0.33508186297885867, 'recall': 0.18069603977370136, 'f1-score': 0.23478309294425576, 'support': 11666}, '1': {'precision': 0.31902949205983006, 'recall': 0.7630828658144027, 'f1-score': 0.44994577006507597, 'support': 10873}, '2': {'precision': 0.41373737373737374, 'recall': 0.08370116069968939, 'f1-score': 0.1392344822897546, 'support': 12234}, 'accuracy': 0.32867454634342735, 'macro avg': {'precision': 0.3559495762586875, 'recall': 0.34249335542926446, 'f1-score': 0.27465444843302883, 'support': 34773}, 'weighted avg': {'precision': 0.3577354761159787, 'recall': 0.32867454634342735, 'f1-score': 0.2684449019796427, 'support': 34773}}
[[2108 8698  860]
 [1985 8297  591]
 [2198 9012 1024]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1261367
{'0': {'precision': 0.38694264520538496, 'recall': 0.38826216347152054, 'f1-score': 0.38760128132654986, 'support': 158939}, '1': {'precision': 0.29851313906948945, 'recall': 0.6796889174790111, 'f1-score': 0.4148346877603255, 'support': 121254}, '2': {'precision': 0.4198356583221861, 'recall': 0.01367943912431665, 'f1-score': 0.026495577035558583, 'support': 160606}, 'accuracy': 0.3319472140363295, 'macro avg': {'precision': 0.36843048086568686, 'recall': 0.36054350669161606, 'f1-score': 0.2763105153741447, 'support': 440799}, 'weighted avg': {'precision': 0.37460229036709153, 'recall': 0.3319472140363295, 'f1-score': 0.2635229978466919, 'support': 440799}}
[[61710 95367  1862]
 [37665 82415  1174]
 [60106 98303  2197]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1135727
{'0': {'precision': 0.37315968289920726, 'recall': 0.26009246729815066, 'f1-score': 0.30653199548142734, 'support': 53208}, '1': {'precision': 0.3488301335686251, 'recall': 0.6653190707391144, 'f1-score': 0.45769072110074654, 'support': 51697}, '2': {'precision': 0.38511632084792957, 'recall': 0.16164605640174937, 'f1-score': 0.22771330695488223, 'support': 53048}, 'accuracy': 0.3596576196716745, 'macro avg': {'precision': 0.3690353791052539, 'recall': 0.36235253147967156, 'f1-score': 0.3306453411790187, 'support': 157953}, 'weighted avg': {'precision': 0.3692123759038397, 'recall': 0.3596576196716745, 'f1-score': 0.3295342736868795, 'support': 157953}}
[[13839 32055  7314]
 [10925 34395  6377]
 [12322 32151  8575]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1111193
{'0': {'precision': 0.37576594459307844, 'recall': 0.22767203513909223, 'f1-score': 0.2835466119631402, 'support': 19124}, '1': {'precision': 0.34533909902019816, 'recall': 0.667866405547028, 'f1-score': 0.45526871245332035, 'support': 18893}, '2': {'precision': 0.36981010621177984, 'recall': 0.17741520407638067, 'f1-score': 0.23979130434782608, 'support': 19429}, 'accuracy': 0.3554468544372106, 'macro avg': {'precision': 0.3636383832750188, 'recall': 0.35765121492083357, 'f1-score': 0.3262022095880956, 'support': 57446}, 'weighted avg': {'precision': 0.36374473550421804, 'recall': 0.3554468544372106, 'f1-score': 0.325224427179222, 'support': 57446}}
[[ 4354 11757  3013]
 [ 3414 12618  2861]
 [ 3819 12163  3447]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
4450/4450 - 65s - 65s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958681
{'0': {'precision': 0.437001591599661, 'recall': 0.5186390866405978, 'f1-score': 0.4743333168803313, 'support': 407638}, '1': {'precision': 0.35113072803015277, 'recall': 0.6506819100834467, 'f1-score': 0.45612204141058843, 'support': 326436}, '2': {'precision': 0.5002876356350796, 'recall': 0.06226437919550077, 'f1-score': 0.11074566699893294, 'support': 405047}, 'accuracy': 0.39420131838496525, 'macro avg': {'precision': 0.4294733184216311, 'recall': 0.4105284586398485, 'f1-score': 0.3470670084299509, 'support': 1139121}, 'weighted avg': {'precision': 0.4348968819667407, 'recall': 0.39420131838496525, 'f1-score': 0.33983057069204076, 'support': 1139121}}
[[211417 182436  13785]
 [102624 212406  11406]
 [169749 210078  25220]]
Evaluating performance on  train set...
1504/1504 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0803559
{'0': {'precision': 0.4055579886677798, 'recall': 0.45998199344934104, 'f1-score': 0.43105893648126736, 'support': 128842}, '1': {'precision': 0.37759846616803455, 'recall': 0.5822365560799008, 'f1-score': 0.4581029560847581, 'support': 126507}, '2': {'precision': 0.4648784961027052, 'recall': 0.1566231559434618, 'f1-score': 0.23430585244670402, 'support': 129470}, 'accuracy': 0.3981092409678316, 'macro avg': {'precision': 0.4160116503128399, 'recall': 0.39961390182423456, 'f1-score': 0.3744892483375765, 'support': 384819}, 'weighted avg': {'precision': 0.41632448092706154, 'recall': 0.3981092409678316, 'f1-score': 0.3737531277712605, 'support': 384819}}
[[59265 57173 12404]
 [41912 73657 10938]
 [44955 64237 20278]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0845147
{'0': {'precision': 0.40455728435282445, 'recall': 0.5162716238172608, 'f1-score': 0.4536379000850295, 'support': 41852}, '1': {'precision': 0.4100041917004331, 'recall': 0.6602763151973359, 'f1-score': 0.5058787022032203, 'support': 44442}, '2': {'precision': 0.5084960231381056, 'recall': 0.06361806544994007, 'f1-score': 0.11308770025528152, 'support': 44217}, 'accuracy': 0.4119499505788784, 'macro avg': {'precision': 0.4410191663971211, 'recall': 0.41338866815484554, 'f1-score': 0.3575347675145104, 'support': 130511}, 'weighted avg': {'precision': 0.44162642541534947, 'recall': 0.4119499505788784, 'f1-score': 0.3560490190088341, 'support': 130511}}
[[21607 18832  1413]
 [13792 29344  1306]
 [18010 23394  2813]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0819658
{'0': {'precision': 0.37270996541331364, 'recall': 0.42795279268431924, 'f1-score': 0.3984256016575055, 'support': 481705}, '1': {'precision': 0.4542996315802487, 'recall': 0.7537900295719129, 'f1-score': 0.5669223795803231, 'support': 609362}, '2': {'precision': 0.400362930452397, 'recall': 0.01909594671572663, 'f1-score': 0.03645320007761722, 'support': 496807}, 'accuracy': 0.4250746595762636, 'macro avg': {'precision': 0.40912417581531973, 'recall': 0.4002795896573195, 'f1-score': 0.3339337271051486, 'support': 1587874}, 'weighted avg': {'precision': 0.4126727261594357, 'recall': 0.4250746595762636, 'f1-score': 0.3498355439305727, 'support': 1587874}}
[[206147 267185   8373]
 [144195 459331   5836]
 [202761 284559   9487]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0810609
{'0': {'precision': 0.405412731177415, 'recall': 0.26800642311217704, 'f1-score': 0.3226911954460778, 'support': 145101}, '1': {'precision': 0.409549028992241, 'recall': 0.7165393313367153, 'f1-score': 0.5211988645331093, 'support': 163610}, '2': {'precision': 0.40598682325981095, 'recall': 0.19783640424343943, 'f1-score': 0.2660347254809948, 'support': 143280}, 'accuracy': 0.40812095816067134, 'macro avg': {'precision': 0.4069828611431556, 'recall': 0.39412738623077725, 'f1-score': 0.3699749284867273, 'support': 451991}, 'weighted avg': {'precision': 0.4070919584165622, 'recall': 0.40812095816067134, 'f1-score': 0.3765862967262628, 'support': 451991}}
[[ 38888  85538  20675]
 [ 25578 117233  20799]
 [ 31456  83478  28346]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0763873
{'0': {'precision': 0.37981978819261597, 'recall': 0.2916086429181079, 'f1-score': 0.3299196991258385, 'support': 44522}, '1': {'precision': 0.4547067086362285, 'recall': 0.7325162696970698, 'f1-score': 0.5611078425790615, 'support': 60542}, '2': {'precision': 0.35582859587994375, 'recall': 0.13534691220238096, 'f1-score': 0.19610221166641403, 'support': 43008}, 'accuracy': 0.42649521854233075, 'macro avg': {'precision': 0.3967850309029293, 'recall': 0.3864906082725195, 'f1-score': 0.3623765844571047, 'support': 148072}, 'weighted avg': {'precision': 0.4034703820828436, 'recall': 0.42649521854233075, 'f1-score': 0.38557755530587323, 'support': 148072}}
[[12983 26581  4958]
 [10614 44348  5580]
 [10585 26602  5821]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
5183/5183 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0850009
{'0': {'precision': 0.36752969572883964, 'recall': 0.38607170339969615, 'f1-score': 0.3765725908791834, 'support': 405448}, '1': {'precision': 0.42260637917981975, 'recall': 0.7164666139291596, 'f1-score': 0.5316311831595844, 'support': 495536}, '2': {'precision': 0.4113991681599237, 'recall': 0.05876399534114818, 'f1-score': 0.10283859169688812, 'support': 425856}, 'accuracy': 0.40441349371438906, 'macro avg': {'precision': 0.40051174768952774, 'recall': 0.3871007708900012, 'f1-score': 0.33701412191188523, 'support': 1326840}, 'weighted avg': {'precision': 0.4021793576791702, 'recall': 0.40441349371438906, 'f1-score': 0.34662613812563753, 'support': 1326840}}
[[156532 234409  14507]
 [119204 355035  21297]
 [150167 250664  25025]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093186
{'0': {'precision': 0.39707132251292815, 'recall': 0.29970860804303634, 'f1-score': 0.3415876036188412, 'support': 129379}, '1': {'precision': 0.3730042332693331, 'recall': 0.6437428637586733, 'f1-score': 0.4723275119659271, 'support': 125241}, '2': {'precision': 0.40578589798861253, 'recall': 0.21586909930642878, 'f1-score': 0.28181752480460887, 'support': 126447}, 'accuracy': 0.3849585505960894, 'macro avg': {'precision': 0.39195381792362455, 'recall': 0.3864401903693795, 'f1-score': 0.36524421346312574, 'support': 381067}, 'weighted avg': {'precision': 0.392053164554398, 'recall': 0.3849585505960894, 'f1-score': 0.3647232981436207, 'support': 381067}}
[[38776 68710 21893]
 [26540 80623 18078]
 [32339 66812 27296]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0847559
{'0': {'precision': 0.39875613747954175, 'recall': 0.2825073630017857, 'f1-score': 0.33071357793432965, 'support': 43121}, '1': {'precision': 0.39030589774886437, 'recall': 0.6632454508520965, 'f1-score': 0.491420966745354, 'support': 46767}, '2': {'precision': 0.3961550305749857, 'recall': 0.21008305337812616, 'f1-score': 0.27456361003125235, 'support': 42864}, 'accuracy': 0.3932520790647222, 'macro avg': {'precision': 0.39507235526779727, 'recall': 0.38527862241066946, 'f1-score': 0.365566051570312, 'support': 132752}, 'weighted avg': {'precision': 0.39493934972612577, 'recall': 0.3932520790647222, 'f1-score': 0.369198800215935, 'support': 132752}}
[[12182 24517  6422]
 [ 8445 31018  7304]
 [ 9923 23936  9005]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 106s - 106s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865977
{'0': {'precision': 0.36536351726994293, 'recall': 0.4754966484572089, 'f1-score': 0.413217643102785, 'support': 591817}, '1': {'precision': 0.4239783979756119, 'recall': 0.6420574082723101, 'f1-score': 0.5107116848650374, 'support': 700143}, '2': {'precision': 0.40925741678726485, 'recall': 0.03105812824112049, 'f1-score': 0.05773481984783961, 'support': 582746}, 'accuracy': 0.3995495827079019, 'macro avg': {'precision': 0.39953311067760655, 'recall': 0.38287072832354646, 'f1-score': 0.32722138260522066, 'support': 1874706}, 'weighted avg': {'precision': 0.4008985786555845, 'recall': 0.3995495827079019, 'f1-score': 0.3391279338689223, 'support': 1874706}}
[[281407 297371  13039]
 [237525 449532  13086]
 [251279 313368  18099]]
Evaluating performance on  train set...
2046/2046 - 30s - 30s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1067848
{'0': {'precision': 0.38297600043108965, 'recall': 0.32364878326455104, 'f1-score': 0.35082187723671543, 'support': 175675}, '1': {'precision': 0.36360514193958493, 'recall': 0.7015135311075978, 'f1-score': 0.4789586991676339, 'support': 172048}, '2': {'precision': 0.4031231258938045, 'recall': 0.09928477694016327, 'f1-score': 0.15932866265845577, 'support': 176029}, 'accuracy': 0.3723670744932716, 'macro avg': {'precision': 0.38323475608815966, 'recall': 0.37481569710410406, 'f1-score': 0.3297030796876017, 'support': 523752}, 'weighted avg': {'precision': 0.3833841342164113, 'recall': 0.3723670744932716, 'f1-score': 0.32855432478932467, 'support': 523752}}
[[ 56857 104972  13846]
 [ 39323 120694  12031]
 [ 52281 106271  17477]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0910693
{'0': {'precision': 0.39357361963190185, 'recall': 0.4079844825667361, 'f1-score': 0.4006495077948742, 'support': 62897}, '1': {'precision': 0.38887682151727787, 'recall': 0.6388587209482732, 'f1-score': 0.48346551916449954, 'support': 64454}, '2': {'precision': 0.42512025077014537, 'recall': 0.12638377865968284, 'f1-score': 0.19484283272646205, 'support': 62239}, 'accuracy': 0.39402922095047205, 'macro avg': {'precision': 0.40252356397310834, 'recall': 0.39107566072489736, 'f1-score': 0.3596526198952786, 'support': 189590}, 'weighted avg': {'precision': 0.4023330655400888, 'recall': 0.39402922095047205, 'f1-score': 0.36124142481177873, 'support': 189590}}
[[25661 31668  5568]
 [18208 41177  5069]
 [21331 33042  7866]]
testing model on single stock: results/universal/W6/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 413s - 413s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1005818
{'0': {'precision': 0.31879136083896487, 'recall': 0.41955303894685425, 'f1-score': 0.36229673921489597, 'support': 2255946}, '1': {'precision': 0.418057956250803, 'recall': 0.6065906243905986, 'f1-score': 0.4949795305525956, 'support': 3025510}, '2': {'precision': 0.3145067322630761, 'recall': 0.02176798025760457, 'f1-score': 0.040717758926730664, 'support': 2231948}, 'accuracy': 0.3767027568329881, 'macro avg': {'precision': 0.350452016450948, 'recall': 0.34930388119835243, 'f1-score': 0.2993313428980741, 'support': 7513404}, 'weighted avg': {'precision': 0.35749139732093393, 'recall': 0.3767027568329881, 'f1-score': 0.32019672038507047, 'support': 7513404}}
[[ 946489 1264164   45293]
 [1129662 1835246   60602]
 [ 892841 1290522   48585]]
Evaluating performance on  train set...
5452/5452 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108808
{'0': {'precision': 0.3852040738235105, 'recall': 0.2682734434128194, 'f1-score': 0.31627721099976625, 'support': 469055}, '1': {'precision': 0.3613740574497602, 'recall': 0.7320805813280158, 'f1-score': 0.48388825777060884, 'support': 459362}, '2': {'precision': 0.3685219618426098, 'recall': 0.10905711924429086, 'f1-score': 0.16830696790714963, 'support': 467058}, 'accuracy': 0.3676604740321396, 'macro avg': {'precision': 0.37170003103862687, 'recall': 0.36980371466170864, 'f1-score': 0.3228241455591749, 'support': 1395475}, 'weighted avg': {'precision': 0.37177630346642476, 'recall': 0.3676604740321396, 'f1-score': 0.3219265131143842, 'support': 1395475}}
[[125835 295843  47377]
 [ 83168 336290  39904]
 [117668 298454  50936]]
Evaluating performance on  val set...
1969/1969 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1009787
{'0': {'precision': 0.3610624496946167, 'recall': 0.19059044048734772, 'f1-score': 0.2494867789346267, 'support': 160050}, '1': {'precision': 0.40119179516058934, 'recall': 0.6968422731380575, 'f1-score': 0.5092144416561132, 'support': 188110}, '2': {'precision': 0.3451774462814368, 'recall': 0.2055637159002713, 'f1-score': 0.25767443356328495, 'support': 155903}, 'accuracy': 0.384148410020176, 'macro avg': {'precision': 0.3691438970455476, 'recall': 0.3643321431752255, 'f1-score': 0.33879188471800825, 'support': 504063}, 'weighted avg': {'precision': 0.3711251035463756, 'recall': 0.384148410020176, 'f1-score': 0.34894627220056873, 'support': 504063}}
[[ 30504  99177  30369]
 [ 26599 131083  30428]
 [ 27381  96474  32048]]
training model: results/universal/W6/deepLOB_L2/h200
Epoch 1/50
9426/9426 - 386s - loss: 3.2044 - accuracy200: 0.4163 - val_loss: 3.4717 - val_accuracy200: 0.3380 - 386s/epoch - 41ms/step
Epoch 2/50
9426/9426 - 382s - loss: 3.1790 - accuracy200: 0.4304 - val_loss: 3.5668 - val_accuracy200: 0.3310 - 382s/epoch - 41ms/step
Epoch 3/50
9426/9426 - 380s - loss: 3.1655 - accuracy200: 0.4364 - val_loss: 3.5248 - val_accuracy200: 0.3398 - 380s/epoch - 40ms/step
Epoch 4/50
9426/9426 - 386s - loss: 3.1558 - accuracy200: 0.4408 - val_loss: 3.5247 - val_accuracy200: 0.3576 - 386s/epoch - 41ms/step
Epoch 5/50
9426/9426 - 383s - loss: 3.1489 - accuracy200: 0.4434 - val_loss: 3.6236 - val_accuracy200: 0.3432 - 383s/epoch - 41ms/step
Epoch 6/50
9426/9426 - 384s - loss: 3.1436 - accuracy200: 0.4456 - val_loss: 3.6255 - val_accuracy200: 0.3455 - 384s/epoch - 41ms/step
Epoch 7/50
9426/9426 - 381s - loss: 3.1382 - accuracy200: 0.4478 - val_loss: 3.6002 - val_accuracy200: 0.3477 - 381s/epoch - 40ms/step
Epoch 8/50
9426/9426 - 383s - loss: 3.1345 - accuracy200: 0.4494 - val_loss: 3.6674 - val_accuracy200: 0.3481 - 383s/epoch - 41ms/step
Epoch 9/50
9426/9426 - 386s - loss: 3.1309 - accuracy200: 0.4509 - val_loss: 3.6661 - val_accuracy200: 0.3409 - 386s/epoch - 41ms/step
Epoch 10/50
9426/9426 - 382s - loss: 3.1278 - accuracy200: 0.4515 - val_loss: 3.8052 - val_accuracy200: 0.3421 - 382s/epoch - 41ms/step
Epoch 11/50
9426/9426 - 380s - loss: 3.1241 - accuracy200: 0.4531 - val_loss: 3.7178 - val_accuracy200: 0.3450 - 380s/epoch - 40ms/step
testing model in sample: results/universal/W6/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 578s - 578s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1590213
{'0': {'precision': 0.30786754080220946, 'recall': 0.5742827724716326, 'f1-score': 0.4008455752393575, 'support': 3340990}, '1': {'precision': 0.3745061758260428, 'recall': 0.41230840679432224, 'f1-score': 0.3924991938385901, 'support': 4073931}, '2': {'precision': 0.3404116753172426, 'recall': 0.01013541702167166, 'f1-score': 0.019684740588579337, 'support': 3403708}, 'accuracy': 0.33579920339259256, 'macro avg': {'precision': 0.3409284639818316, 'recall': 0.3322421987625422, 'f1-score': 0.271009836555509, 'support': 10818629}, 'weighted avg': {'precision': 0.34320029248665807, 'recall': 0.33579920339259256, 'f1-score': 0.27778351588655587, 'support': 10818629}}
[[1918673 1388598   33719]
 [2361090 1679716   33125]
 [1952375 1416835   34498]]
Evaluating performance on  train set...
9426/9426 - 132s - 132s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1636634
{'0': {'precision': 0.3216320356496765, 'recall': 0.3891253434499064, 'f1-score': 0.3521741174048019, 'support': 808706}, '1': {'precision': 0.32495217452763514, 'recall': 0.4308747122903562, 'f1-score': 0.3704913840712224, 'support': 800286}, '2': {'precision': 0.3545576281602301, 'recall': 0.1644930883321485, 'f1-score': 0.22472670740896342, 'support': 803207}, 'accuracy': 0.3281789769417863, 'macro avg': {'precision': 0.33371394611251387, 'recall': 0.32816438135747034, 'f1-score': 0.3157974029616626, 'support': 2412199}, 'weighted avg': {'precision': 0.33369701330935975, 'recall': 0.3281789769417863, 'f1-score': 0.31581409911065433, 'support': 2412199}}
[[314688 361229 132789]
 [347735 344823 107728]
 [315987 355098 132122]]
Evaluating performance on  val set...
3323/3323 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1572328
{'0': {'precision': 0.31139722747462995, 'recall': 0.40922574740022716, 'f1-score': 0.35367110845666194, 'support': 272043}, '1': {'precision': 0.36967241986615007, 'recall': 0.4021085853256228, 'f1-score': 0.38520889419749577, 'support': 307979}, '2': {'precision': 0.33117858432990477, 'recall': 0.19334465496764455, 'f1-score': 0.2441516574392039, 'support': 270279}, 'accuracy': 0.3380273573710956, 'macro avg': {'precision': 0.33741607722356165, 'recall': 0.3348929958978315, 'f1-score': 0.32767722003112054, 'support': 850301}, 'weighted avg': {'precision': 0.33879225679605235, 'recall': 0.3380273573710956, 'f1-score': 0.3302819415770848, 'support': 850301}}
[[111327 105419  55297]
 [133901 123841  50237]
 [112280 105742  52257]]
testing model out of sample: results/universal/W6/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 238s - 238s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1711537
{'0': {'precision': 0.3162546220698437, 'recall': 0.5500997432179853, 'f1-score': 0.40161761367549276, 'support': 1431175}, '1': {'precision': 0.3480308376830553, 'recall': 0.42211015759717, 'f1-score': 0.38150767883643305, 'support': 1589559}, '2': {'precision': 0.40259778554263054, 'recall': 0.018647112930882014, 'f1-score': 0.035643334316645736, 'support': 1464409}, 'accuracy': 0.33121909379477976, 'macro avg': {'precision': 0.35562774843184325, 'recall': 0.3302856712486791, 'f1-score': 0.2729228756095239, 'support': 4485143}, 'weighted avg': {'precision': 0.35570751692557995, 'recall': 0.33121909379477976, 'f1-score': 0.2749991410037294, 'support': 4485143}}
[[787289 619580  24306]
 [902376 670969  16214]
 [799750 637352  27307]]
Evaluating performance on  train set...
5153/5153 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1615902
{'0': {'precision': 0.3301950745243553, 'recall': 0.3295065879509815, 'f1-score': 0.329850471973937, 'support': 449381}, '1': {'precision': 0.3189847342640097, 'recall': 0.46430892458713313, 'f1-score': 0.3781658570888064, 'support': 426227}, '2': {'precision': 0.3484717451013365, 'recall': 0.1964641642231387, 'f1-score': 0.25126701685554637, 'support': 443007}, 'accuracy': 0.3283824315664542, 'macro avg': {'precision': 0.3325505179632338, 'recall': 0.3300932255870844, 'f1-score': 0.31976111530609663, 'support': 1318615}, 'weighted avg': {'precision': 0.3327117630984656, 'recall': 0.3283824315664542, 'f1-score': 0.3190666578581584, 'support': 1318615}}
[[148074 214281  87026]
 [152625 197901  75701]
 [147745 208227  87035]]
Evaluating performance on  val set...
1795/1795 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1616766
{'0': {'precision': 0.33401858950579116, 'recall': 0.42164380532412377, 'f1-score': 0.37275076831080867, 'support': 153753}, '1': {'precision': 0.3335867928114993, 'recall': 0.44744240173644706, 'f1-score': 0.3822158679984474, 'support': 152956}, '2': {'precision': 0.34173331321362105, 'recall': 0.13393085955724357, 'f1-score': 0.19244096569826177, 'support': 152183}, 'accuracy': 0.33482823845262066, 'macro avg': {'precision': 0.3364462318436372, 'recall': 0.33433902220593814, 'f1-score': 0.31580253400250596, 'support': 458892}, 'weighted avg': {'precision': 0.3364331094862148, 'recall': 0.33482823845262066, 'f1-score': 0.3161092428469463, 'support': 458892}}
[[64829 68548 20376]
 [65632 68439 18885]
 [63627 68174 20382]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1908294
{'0': {'precision': 0.30153701980505127, 'recall': 0.5568270449449156, 'f1-score': 0.39121853902039105, 'support': 82056}, '1': {'precision': 0.3481757322175732, 'recall': 0.4364340109509724, 'f1-score': 0.38734092368991874, 'support': 95334}, '2': {'precision': 0.3, 'recall': 0.00012809974700299967, 'f1-score': 0.0002560901437305932, 'support': 93677}, 'accuracy': 0.322097488812729, 'macro avg': {'precision': 0.31657091734087484, 'recall': 0.33112971854763035, 'f1-score': 0.25960518428468016, 'support': 271067}, 'weighted avg': {'precision': 0.31740863680327525, 'recall': 0.322097488812729, 'f1-score': 0.25474357931177966, 'support': 271067}}
[[45691 36355    10]
 [53709 41607    18]
 [52127 41538    12]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1679543
{'0': {'precision': 0.3262858081831626, 'recall': 0.3224531774385623, 'f1-score': 0.3243581715716969, 'support': 18474}, '1': {'precision': 0.3188346495355784, 'recall': 0.447558874210224, 'f1-score': 0.37238643695189844, 'support': 17410}, '2': {'precision': 0.33268223386309154, 'recall': 0.20730290456431535, 'f1-score': 0.25543663508078257, 'support': 18075}, 'accuracy': 0.3242461869196983, 'macro avg': {'precision': 0.3259342305272775, 'recall': 0.32577165207103387, 'f1-score': 0.31739374786812596, 'support': 53959}, 'weighted avg': {'precision': 0.3260243267270621, 'recall': 0.3242461869196983, 'f1-score': 0.31676750695960315, 'support': 53959}}
[[5957 8615 3902]
 [6004 7792 3614]
 [6296 8032 3747]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1689171
{'0': {'precision': 0.338034835289663, 'recall': 0.5079658605974395, 'f1-score': 0.40593384108218716, 'support': 7030}, '1': {'precision': 0.310260486731075, 'recall': 0.38887185775597793, 'f1-score': 0.3451465886674376, 'support': 6524}, '2': {'precision': 0.38396624472573837, 'recall': 0.10278130735564027, 'f1-score': 0.1621561421093663, 'support': 7083}, 'accuracy': 0.33124969714590297, 'macro avg': {'precision': 0.3440871889154921, 'recall': 0.3332063419030193, 'f1-score': 0.3044121906196637, 'support': 20637}, 'weighted avg': {'precision': 0.3450190056167209, 'recall': 0.33124969714590297, 'f1-score': 0.3030480787825159, 'support': 20637}}
[[3571 2809  650]
 [3469 2537  518]
 [3524 2831  728]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.193838
{'0': {'precision': 0.3599301548739751, 'recall': 0.49646454572653836, 'f1-score': 0.41731356045872176, 'support': 200540}, '1': {'precision': 0.26362074305688704, 'recall': 0.47111811065130865, 'f1-score': 0.33806979383393226, 'support': 151756}, '2': {'precision': 0.49273703671097807, 'recall': 0.027054461786841583, 'f1-score': 0.05129262548227165, 'support': 206879}, 'accuracy': 0.31591719944561186, 'macro avg': {'precision': 0.37209597821394674, 'recall': 0.3315457060548962, 'f1-score': 0.26889199325830854, 'support': 559175}, 'weighted avg': {'precision': 0.382927291383732, 'recall': 0.31591719944561186, 'f1-score': 0.2603899461073924, 'support': 559175}}
[[ 99561  98068   2911]
 [ 77410  71495   2851]
 [ 99641 101641   5597]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1443871
{'0': {'precision': 0.3269384759108501, 'recall': 0.21232476002686831, 'f1-score': 0.2574517557111517, 'support': 46151}, '1': {'precision': 0.34378896253034974, 'recall': 0.4492657305177404, 'f1-score': 0.38951310861423216, 'support': 46645}, '2': {'precision': 0.33246592863758656, 'recall': 0.346750080500483, 'f1-score': 0.33945780419706384, 'support': 43478}, 'accuracy': 0.3363150711067408, 'macro avg': {'precision': 0.33439778902626216, 'recall': 0.3361135236816972, 'f1-score': 0.3288075561741492, 'support': 136274}, 'weighted avg': {'precision': 0.33446972573120914, 'recall': 0.3363150711067408, 'f1-score': 0.32881871332767926, 'support': 136274}}
[[ 9799 21105 15247]
 [10666 20956 15023]
 [ 9507 18895 15076]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1491377
{'0': {'precision': 0.35850418712099336, 'recall': 0.1489502099580084, 'f1-score': 0.21045939989828785, 'support': 16670}, '1': {'precision': 0.34922779922779923, 'recall': 0.5367633968310486, 'f1-score': 0.4231479965380927, 'support': 16851}, '2': {'precision': 0.28902185223725285, 'recall': 0.3027041754648866, 'f1-score': 0.2957048274944273, 'support': 14681}, 'accuracy': 0.3313555454130534, 'macro avg': {'precision': 0.3322512795286818, 'recall': 0.32947259408464785, 'f1-score': 0.30977074131026927, 'support': 48202}, 'weighted avg': {'precision': 0.33409883940064133, 'recall': 0.3313555454130534, 'f1-score': 0.3107768901376198, 'support': 48202}}
[[2483 9231 4956]
 [1830 9045 5976]
 [2613 7624 4444]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1797099
{'0': {'precision': 0.3887994130384209, 'recall': 0.3700552702622144, 'f1-score': 0.3791958461504898, 'support': 117423}, '1': {'precision': 0.24824952259707192, 'recall': 0.4266013829385491, 'f1-score': 0.31385773890216856, 'support': 76793}, '2': {'precision': 0.4013378925206433, 'recall': 0.23075007941209297, 'f1-score': 0.29302487844231734, 'support': 116481}, 'accuracy': 0.3318055855061362, 'macro avg': {'precision': 0.34612894271871203, 'recall': 0.34246891087095216, 'f1-score': 0.32869282116499193, 'support': 310697}, 'weighted avg': {'precision': 0.35876129516765365, 'recall': 0.3318055855061362, 'f1-score': 0.3307409535717524, 'support': 310697}}
[[43453 49840 24130]
 [28070 32760 15963]
 [40239 49364 26878]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1533102
{'0': {'precision': 0.32983738545473806, 'recall': 0.276472938773698, 'f1-score': 0.30080672431283517, 'support': 45046}, '1': {'precision': 0.3262036716314513, 'recall': 0.4380130694635008, 'f1-score': 0.3739291847410687, 'support': 43001}, '2': {'precision': 0.34848570300603465, 'recall': 0.2879780020040547, 'f1-score': 0.31535566188197767, 'support': 42913}, 'accuracy': 0.3332849725106903, 'macro avg': {'precision': 0.3348422533640747, 'recall': 0.3341546700804179, 'f1-score': 0.33003052364529384, 'support': 130960}, 'weighted avg': {'precision': 0.33475493220919467, 'recall': 0.3332849725106903, 'f1-score': 0.32958404165232114, 'support': 130960}}
[[12454 19942 12650]
 [13712 18835 10454]
 [11592 18963 12358]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1658083
{'0': {'precision': 0.3521951219512195, 'recall': 0.3339721139232142, 'f1-score': 0.34284163755384456, 'support': 15133}, '1': {'precision': 0.28469646691391765, 'recall': 0.46005835501932024, 'f1-score': 0.3517318301027945, 'support': 12681}, '2': {'precision': 0.36279349789283566, 'recall': 0.19650427183199634, 'f1-score': 0.2549285049496573, 'support': 15333}, 'accuracy': 0.32217767168053396, 'macro avg': {'precision': 0.3332283622526576, 'recall': 0.3301782469248436, 'f1-score': 0.3165006575354321, 'support': 43147}, 'weighted avg': {'precision': 0.33612342412251245, 'recall': 0.32217767168053396, 'f1-score': 0.314213099520916, 'support': 43147}}
[[5054 7299 2780]
 [4335 5834 2512]
 [4961 7359 3013]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.2141345
{'0': {'precision': 0.3502707652651691, 'recall': 0.6283144563531093, 'f1-score': 0.4497925793116464, 'support': 98621}, '1': {'precision': 0.2581977144297221, 'recall': 0.36332142175182086, 'f1-score': 0.30186925949220056, 'support': 73318}, '2': {'precision': 0.35714285714285715, 'recall': 4.6232085067036525e-05, 'f1-score': 9.245220221145669e-05, 'support': 108150}, 'accuracy': 0.3163565866563842, 'macro avg': {'precision': 0.32187044561258277, 'recall': 0.3305607033966657, 'f1-score': 0.25058476366868615, 'support': 280089}, 'weighted avg': {'precision': 0.32882259984424456, 'recall': 0.3163565866563842, 'f1-score': 0.23742968498374523, 'support': 280089}}
[[61965 36649     7]
 [46678 26638     2]
 [68263 39882     5]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1747636
{'0': {'precision': 0.3321935495360724, 'recall': 0.4928267589632487, 'f1-score': 0.39687234042553193, 'support': 37849}, '1': {'precision': 0.336086456278764, 'recall': 0.4318259813626884, 'f1-score': 0.3779880535625571, 'support': 37881}, '2': {'precision': 0.3544810594394826, 'recall': 0.08891692846474739, 'f1-score': 0.1421718991250643, 'support': 38834}, 'accuracy': 0.33574246709262945, 'macro avg': {'precision': 0.340920355084773, 'recall': 0.3378565562635614, 'f1-score': 0.3056774310377178, 'support': 114564}, 'weighted avg': {'precision': 0.3410355972989729, 'recall': 0.33574246709262945, 'f1-score': 0.3042918386263742, 'support': 114564}}
[[18653 15936  3260]
 [18495 16358  3028]
 [19003 16378  3453]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1960535
{'0': {'precision': 0.3326409869083585, 'recall': 0.4531812725090036, 'f1-score': 0.38366606170598916, 'support': 11662}, '1': {'precision': 0.2947101678808996, 'recall': 0.45372086218667707, 'f1-score': 0.3573239112066979, 'support': 10253}, '2': {'precision': 0.41451612903225804, 'recall': 0.09993778192564941, 'f1-score': 0.1610477503446547, 'support': 12858}, 'accuracy': 0.3227216518563253, 'macro avg': {'precision': 0.34728909460717206, 'recall': 0.3356133055404434, 'f1-score': 0.30067924108578054, 'support': 34773}, 'weighted avg': {'precision': 0.35173183008957853, 'recall': 0.3227216518563253, 'f1-score': 0.29358144673019554, 'support': 34773}}
[[5285 5292 1085]
 [4871 4652  730]
 [5732 5841 1285]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.204872
{'0': {'precision': 0.3455604896688142, 'recall': 0.5693726357674839, 'f1-score': 0.4300919517500495, 'support': 152798}, '1': {'precision': 0.2829556639818803, 'recall': 0.4189047320589157, 'f1-score': 0.33776365577405354, 'support': 127640}, '2': {'precision': 0.29577464788732394, 'recall': 0.0001309545338330392, 'f1-score': 0.00026179315847212525, 'support': 160361}, 'accuracy': 0.3187144253957019, 'macro avg': {'precision': 0.30809693384600617, 'recall': 0.3294694407867442, 'f1-score': 0.25603913356085833, 'support': 440799}, 'weighted avg': {'precision': 0.30932041806111593, 'recall': 0.3187144253957019, 'f1-score': 0.24698632365134676, 'support': 440799}}
[[86999 65770    29]
 [74150 53469    21]
 [90613 69727    21]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.156327
{'0': {'precision': 0.3197431352219138, 'recall': 0.35953365927040243, 'f1-score': 0.3384729770397777, 'support': 53180}, '1': {'precision': 0.319623590492415, 'recall': 0.4533338447082287, 'f1-score': 0.37491376507624363, 'support': 52147}, '2': {'precision': 0.36601496300582814, 'recall': 0.16826283586060123, 'f1-score': 0.23054192322211953, 'support': 52626}, 'accuracy': 0.32677442023893183, 'macro avg': {'precision': 0.3351272295733856, 'recall': 0.32704344661307744, 'f1-score': 0.314642888446047, 'support': 157953}, 'weighted avg': {'precision': 0.3351202873491105, 'recall': 0.32677442023893183, 'f1-score': 0.31454369513648694, 'support': 157953}}
[[19120 25251  8809]
 [21978 23640  6529]
 [18700 25071  8855]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1582965
{'0': {'precision': 0.3327315865483804, 'recall': 0.33943699026571955, 'f1-score': 0.3360508426015159, 'support': 19005}, '1': {'precision': 0.3331354748603352, 'recall': 0.5028990090659919, 'f1-score': 0.40078131563471386, 'support': 18972}, '2': {'precision': 0.3657889148439159, 'recall': 0.17694796856541167, 'f1-score': 0.23851559525045868, 'support': 19469}, 'accuracy': 0.3383525397764857, 'macro avg': {'precision': 0.34388532541754385, 'recall': 0.33976132263237435, 'f1-score': 0.3251159178288962, 'support': 57446}, 'weighted avg': {'precision': 0.34406841928939264, 'recall': 0.3383525397764857, 'f1-score': 0.3243729677922707, 'support': 57446}}
[[6451 9440 3114]
 [6572 9541 2859]
 [6365 9659 3445]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
4450/4450 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1618
{'0': {'precision': 0.3331109303452121, 'recall': 0.4790357771877711, 'f1-score': 0.39296361587768813, 'support': 380410}, '1': {'precision': 0.3380540074771031, 'recall': 0.44041281912004343, 'f1-score': 0.38250395099974055, 'support': 386610}, '2': {'precision': 0.3186944962950393, 'recall': 0.07570793951104673, 'f1-score': 0.12235068274208681, 'support': 372101}, 'accuracy': 0.33417784414473967, 'macro avg': {'precision': 0.32995314470578485, 'recall': 0.33171884527295376, 'f1-score': 0.2992727498731718, 'support': 1139121}, 'weighted avg': {'precision': 0.3300793590928667, 'recall': 0.33417784414473967, 'f1-score': 0.301016268694067, 'support': 1139121}}
[[182230 167772  30408]
 [186526 170268  29816]
 [178299 165631  28171]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.164156
{'0': {'precision': 0.3262432684497127, 'recall': 0.4193965083809686, 'f1-score': 0.3670010423858452, 'support': 129281}, '1': {'precision': 0.32252395597088473, 'recall': 0.4323266085710875, 'f1-score': 0.36943918337646087, 'support': 125655}, '2': {'precision': 0.3741980474198047, 'recall': 0.14459937020241295, 'f1-score': 0.20859318165410695, 'support': 129883}, 'accuracy': 0.33086983750802323, 'macro avg': {'precision': 0.3409884239468007, 'recall': 0.33210749571815634, 'f1-score': 0.315011135805471, 'support': 384819}, 'weighted avg': {'precision': 0.3412143596573852, 'recall': 0.33086983750802323, 'f1-score': 0.31433180420050466, 'support': 384819}}
[[54220 57197 17864]
 [57786 54324 13545]
 [54189 56913 18781]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.170977
{'0': {'precision': 0.3039271723522605, 'recall': 0.5455705705705706, 'f1-score': 0.3903806036296568, 'support': 39960}, '1': {'precision': 0.35082977551301475, 'recall': 0.43346662696218147, 'f1-score': 0.38779471370668495, 'support': 47014}, '2': {'precision': 0.5375722543352601, 'recall': 0.008544456439350437, 'f1-score': 0.016821542426914467, 'support': 43537}, 'accuracy': 0.3260414830933791, 'macro avg': {'precision': 0.3974430674001785, 'recall': 0.3291938846573675, 'f1-score': 0.26499895325441875, 'support': 130511}, 'weighted avg': {'precision': 0.398764273587356, 'recall': 0.3260414830933791, 'f1-score': 0.2648339916473535, 'support': 130511}}
[[21801 17994   165]
 [26480 20379   155]
 [23450 19715   372]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
6203/6203 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1782657
{'0': {'precision': 0.3132719972119248, 'recall': 0.5456271936150776, 'f1-score': 0.39802044873822967, 'support': 499176}, '1': {'precision': 0.34969601096198677, 'recall': 0.4446677515259153, 'f1-score': 0.3915046135161954, 'support': 564743}, '2': {'precision': 0.34513274336283184, 'recall': 0.00022330161941388097, 'f1-score': 0.00044631447241433243, 'support': 523955}, 'accuracy': 0.3297516049762135, 'macro avg': {'precision': 0.3360335838455811, 'recall': 0.3301727489201356, 'f1-score': 0.2633237922422798, 'support': 1587874}, 'weighted avg': {'precision': 0.33673973082728076, 'recall': 0.3297516049762135, 'f1-score': 0.2645144351313298, 'support': 1587874}}
[[272364 226711    101]
 [313499 251123    121]
 [283554 240284    117]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1542912
{'0': {'precision': 0.33300760667548046, 'recall': 0.2201156303627855, 'f1-score': 0.2650410409494508, 'support': 157917}, '1': {'precision': 0.31039547623878544, 'recall': 0.4963534025505022, 'f1-score': 0.3819425221851339, 'support': 141776}, '2': {'precision': 0.3555647462674221, 'recall': 0.28224927444877806, 'f1-score': 0.3146932754499566, 'support': 152298}, 'accuracy': 0.3276990028562516, 'macro avg': {'precision': 0.33298927639389597, 'recall': 0.3329061024540219, 'f1-score': 0.3205589461948471, 'support': 451991}, 'weighted avg': {'precision': 0.3335154704178573, 'recall': 0.3276990028562516, 'f1-score': 0.3184398042293132, 'support': 451991}}
[[34760 80761 42396]
 [35892 70371 35513]
 [33730 75582 42986]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1616523
{'0': {'precision': 0.3249848594369664, 'recall': 0.33587740020594825, 'f1-score': 0.3303413626705324, 'support': 49527}, '1': {'precision': 0.3445771605833068, 'recall': 0.4684864012613323, 'f1-score': 0.39709002221739637, 'support': 50740}, '2': {'precision': 0.3163912685042475, 'recall': 0.1846459575358226, 'f1-score': 0.23319771742576353, 'support': 47805}, 'accuracy': 0.3324936517369928, 'macro avg': {'precision': 0.32865109617484023, 'recall': 0.32966991966770104, 'f1-score': 0.3202097007712308, 'support': 148072}, 'weighted avg': {'precision': 0.3289241372587469, 'recall': 0.3324936517369928, 'f1-score': 0.32185140524766853, 'support': 148072}}
[[16635 22989  9903]
 [17800 23771  9169]
 [16752 22226  8827]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
5183/5183 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.2038258
{'0': {'precision': 0.340332109011029, 'recall': 0.6004464335489683, 'f1-score': 0.43442997864683713, 'support': 448443}, '1': {'precision': 0.2943124200461281, 'recall': 0.40116382667841016, 'f1-score': 0.3395299184429289, 'support': 392842}, '2': {'precision': 0.3862433862433862, 'recall': 0.0001503434214455623, 'f1-score': 0.0003005698474916829, 'support': 485555}, 'accuracy': 0.3217667540924301, 'macro avg': {'precision': 0.34029597176684784, 'recall': 0.3339202012162747, 'f1-score': 0.25808682231241925, 'support': 1326840}, 'weighted avg': {'precision': 0.34350806358294994, 'recall': 0.3217667540924301, 'f1-score': 0.24746362660726198, 'support': 1326840}}
[[269266 179119     58]
 [235190 157594     58]
 [286730 198752     73]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1519212
{'0': {'precision': 0.33168114505343527, 'recall': 0.2941271726222606, 'f1-score': 0.31177737543985845, 'support': 129682}, '1': {'precision': 0.3324895400958387, 'recall': 0.47991990299007564, 'f1-score': 0.392827407869347, 'support': 125348}, '2': {'precision': 0.3539388529346128, 'recall': 0.2390885216246023, 'f1-score': 0.2853922794256923, 'support': 126037}, 'accuracy': 0.3370378437387651, 'macro avg': {'precision': 0.3393698460279622, 'recall': 0.3377118657456462, 'f1-score': 0.3299990209116326, 'support': 381067}, 'weighted avg': {'precision': 0.3393087418539852, 'recall': 0.3370378437387651, 'f1-score': 0.32971112755860416, 'support': 381067}}
[[38143 62355 29184]
 [39370 60157 25821]
 [37486 58417 30134]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.166774
{'0': {'precision': 0.3423242377617986, 'recall': 0.4913688195790328, 'f1-score': 0.40352370729540654, 'support': 44374}, '1': {'precision': 0.3327710563052583, 'recall': 0.3886284899123701, 'f1-score': 0.3585372732115439, 'support': 44163}, '2': {'precision': 0.32290355794531517, 'recall': 0.12767160465905236, 'f1-score': 0.18299106925782455, 'support': 44215}, 'accuracy': 0.33605520067494277, 'macro avg': {'precision': 0.33266628400412407, 'recall': 0.3358896380501517, 'f1-score': 0.31501734992159164, 'support': 132752}, 'weighted avg': {'precision': 0.332677810508341, 'recall': 0.33605520067494277, 'f1-score': 0.3151063088435767, 'support': 132752}}
[[21804 16779  5791]
 [20954 17163  6046]
 [20936 17634  5645]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 105s - 105s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1530668
{'0': {'precision': 0.30597167401064257, 'recall': 0.5838005112795444, 'f1-score': 0.4015104600425662, 'support': 579722}, '1': {'precision': 0.3783395108644726, 'recall': 0.4009480738543188, 'f1-score': 0.3893158344074861, 'support': 725049}, '2': {'precision': 0.28846153846153844, 'recall': 0.00010527516295717932, 'f1-score': 0.00021047351278538894, 'support': 569935}, 'accuracy': 0.33563076023653843, 'macro avg': {'precision': 0.3242575744455512, 'recall': 0.3282846200989401, 'f1-score': 0.2636789226542792, 'support': 1874706}, 'weighted avg': {'precision': 0.3286368751882427, 'recall': 0.33563076023653843, 'f1-score': 0.27479373275575975, 'support': 1874706}}
[[338442 241209     71]
 [434265 290707     77]
 [333415 236460     60]]
Evaluating performance on  train set...
2046/2046 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1709459
{'0': {'precision': 0.33125751024023997, 'recall': 0.43220571742464126, 'f1-score': 0.3750577229595865, 'support': 174764}, '1': {'precision': 0.32599884679649327, 'recall': 0.4506117177546497, 'f1-score': 0.3783077569280963, 'support': 171893}, '2': {'precision': 0.3303744989764497, 'recall': 0.10844462011914509, 'f1-score': 0.16328977238910666, 'support': 177095}, 'accuracy': 0.32877392353633017, 'macro avg': {'precision': 0.32921028533772767, 'recall': 0.3304206850994787, 'f1-score': 0.3055517507589298, 'support': 523752}, 'weighted avg': {'precision': 0.32923307059113716, 'recall': 0.32877392353633017, 'f1-score': 0.3045197830236434, 'support': 523752}}
[[75534 79872 19358]
 [74868 77457 19568]
 [77620 80270 19205]]
Evaluating performance on  val set...
741/741 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1614357
{'0': {'precision': 0.3339060825971821, 'recall': 0.5238986330045355, 'f1-score': 0.4078619225166053, 'support': 63058}, '1': {'precision': 0.339465565159744, 'recall': 0.41579350083542843, 'f1-score': 0.37377260891231573, 'support': 64039}, '2': {'precision': 0.37375143278205336, 'recall': 0.07304818139631639, 'f1-score': 0.12221077007509334, 'support': 62493}, 'accuracy': 0.33877314204335673, 'macro avg': {'precision': 0.3490410268463265, 'recall': 0.33758010507876013, 'f1-score': 0.3012817671680048, 'support': 189590}, 'weighted avg': {'precision': 0.34891784045849894, 'recall': 0.33877314204335673, 'f1-score': 0.30219051039870615, 'support': 189590}}
[[33036 26122  3900]
 [33663 26627  3749]
 [32239 25689  4565]]
testing model on single stock: results/universal/W6/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 413s - 413s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1459887
{'0': {'precision': 0.2942208276153777, 'recall': 0.5903041876640325, 'f1-score': 0.39270746138134177, 'support': 2212976}, '1': {'precision': 0.40809490052253095, 'recall': 0.40848698689159624, 'f1-score': 0.40829084957582995, 'support': 3069405}, '2': {'precision': 0.2727272727272727, 'recall': 0.00013312278716983195, 'f1-score': 0.0002661156787831435, 'support': 2231023}, 'accuracy': 0.340782686515992, 'macro avg': {'precision': 0.3250143336217271, 'recall': 0.3329747657809328, 'f1-score': 0.2670881422119849, 'support': 7513404}, 'weighted avg': {'precision': 0.3343588307687362, 'recall': 0.340782686515992, 'f1-score': 0.28254248971573503, 'support': 7513404}}
[[1306329  906279     368]
 [1815169 1253812     424]
 [1318463  912263     297]]
Evaluating performance on  train set...
5452/5452 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1678147
{'0': {'precision': 0.31679308632750475, 'recall': 0.4150980261646445, 'f1-score': 0.3593435760939469, 'support': 465743}, '1': {'precision': 0.3203977806769035, 'recall': 0.4158710896231794, 'f1-score': 0.36194433728712627, 'support': 464757}, '2': {'precision': 0.35606922438571326, 'recall': 0.13934082477552556, 'f1-score': 0.20029863942844245, 'support': 464975}, 'accuracy': 0.32347265268098674, 'macro avg': {'precision': 0.3310866971300405, 'recall': 0.3234366468544498, 'f1-score': 0.30719551760317193, 'support': 1395475}, 'weighted avg': {'precision': 0.33108050045198495, 'recall': 0.32347265268098674, 'f1-score': 0.30721566448235627, 'support': 1395475}}
[[193329 205289  67125]
 [221434 193279  50044]
 [195506 204679  64790]]
Evaluating performance on  val set...
1969/1969 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1492926
{'0': {'precision': 0.3006484889456421, 'recall': 0.3767042923382922, 'f1-score': 0.3344064700115854, 'support': 159377}, '1': {'precision': 0.3940221687903125, 'recall': 0.38096342607723854, 'f1-score': 0.38738277554280387, 'support': 189698}, '2': {'precision': 0.3349454764916458, 'recall': 0.26140088264897926, 'f1-score': 0.29363822500860676, 'support': 154988}, 'accuracy': 0.3428539686507441, 'macro avg': {'precision': 0.3432053780758668, 'recall': 0.33968953368817, 'f1-score': 0.33847582352099864, 'support': 504063}, 'weighted avg': {'precision': 0.34633409139008714, 'recall': 0.3428539686507441, 'f1-score': 0.3418081449017071, 'support': 504063}}
[[60038 56242 43097]
 [80084 72268 37346]
 [59573 54901 40514]]
training model: results/universal/W6/deepOF_L2/h50
Epoch 1/50
9426/9426 - 216s - loss: 3.0104 - accuracy50: 0.4865 - val_loss: 3.1748 - val_accuracy50: 0.4572 - 216s/epoch - 23ms/step
Epoch 2/50
9426/9426 - 213s - loss: 2.9375 - accuracy50: 0.5063 - val_loss: 3.1587 - val_accuracy50: 0.4625 - 213s/epoch - 23ms/step
Epoch 3/50
9426/9426 - 211s - loss: 2.9190 - accuracy50: 0.5113 - val_loss: 3.1586 - val_accuracy50: 0.4632 - 211s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 212s - loss: 2.9096 - accuracy50: 0.5136 - val_loss: 3.1619 - val_accuracy50: 0.4623 - 212s/epoch - 23ms/step
Epoch 5/50
9426/9426 - 208s - loss: 2.9026 - accuracy50: 0.5155 - val_loss: 3.1576 - val_accuracy50: 0.4619 - 208s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 210s - loss: 2.8978 - accuracy50: 0.5166 - val_loss: 3.1573 - val_accuracy50: 0.4617 - 210s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 211s - loss: 2.8932 - accuracy50: 0.5174 - val_loss: 3.1538 - val_accuracy50: 0.4623 - 211s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 211s - loss: 2.8896 - accuracy50: 0.5186 - val_loss: 3.1531 - val_accuracy50: 0.4622 - 211s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 210s - loss: 2.8862 - accuracy50: 0.5189 - val_loss: 3.1555 - val_accuracy50: 0.4614 - 210s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 210s - loss: 2.8830 - accuracy50: 0.5198 - val_loss: 3.1673 - val_accuracy50: 0.4607 - 210s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 208s - loss: 2.8802 - accuracy50: 0.5206 - val_loss: 3.1535 - val_accuracy50: 0.4632 - 208s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 209s - loss: 2.8780 - accuracy50: 0.5211 - val_loss: 3.1523 - val_accuracy50: 0.4637 - 209s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 209s - loss: 2.8758 - accuracy50: 0.5216 - val_loss: 3.1678 - val_accuracy50: 0.4614 - 209s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 210s - loss: 2.8739 - accuracy50: 0.5221 - val_loss: 3.1734 - val_accuracy50: 0.4607 - 210s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 210s - loss: 2.8715 - accuracy50: 0.5227 - val_loss: 3.1744 - val_accuracy50: 0.4597 - 210s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 209s - loss: 2.8696 - accuracy50: 0.5233 - val_loss: 3.1745 - val_accuracy50: 0.4607 - 209s/epoch - 22ms/step
Epoch 17/50
9426/9426 - 210s - loss: 2.8677 - accuracy50: 0.5236 - val_loss: 3.1735 - val_accuracy50: 0.4598 - 210s/epoch - 22ms/step
Epoch 18/50
9426/9426 - 209s - loss: 2.8659 - accuracy50: 0.5240 - val_loss: 3.1638 - val_accuracy50: 0.4601 - 209s/epoch - 22ms/step
Epoch 19/50
9426/9426 - 208s - loss: 2.8642 - accuracy50: 0.5245 - val_loss: 3.1776 - val_accuracy50: 0.4584 - 208s/epoch - 22ms/step
Epoch 20/50
9426/9426 - 209s - loss: 2.8625 - accuracy50: 0.5248 - val_loss: 3.1769 - val_accuracy50: 0.4587 - 209s/epoch - 22ms/step
Epoch 21/50
9426/9426 - 211s - loss: 2.8608 - accuracy50: 0.5254 - val_loss: 3.1758 - val_accuracy50: 0.4599 - 211s/epoch - 22ms/step
Epoch 22/50
9426/9426 - 209s - loss: 2.8592 - accuracy50: 0.5258 - val_loss: 3.1801 - val_accuracy50: 0.4578 - 209s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 328s - 328s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.14653
{'0': {'precision': 0.4029964314360596, 'recall': 0.3888885978791553, 'f1-score': 0.3958168455514233, 'support': 3245405}, '1': {'precision': 0.4801316629404522, 'recall': 0.36539891685696035, 'f1-score': 0.4149810634387875, 'support': 4343286}, '2': {'precision': 0.3705213536671595, 'recall': 0.5026150859171749, 'f1-score': 0.4265762223741889, 'support': 3229913}, 'accuracy': 0.4134115640058551, 'macro avg': {'precision': 0.41788314934789045, 'recall': 0.4189675335510968, 'f1-score': 0.4124580437881333, 'support': 10818604}, 'weighted avg': {'precision': 0.4242680017087127, 'recall': 0.4134115640058551, 'f1-score': 0.4126938650192667, 'support': 10818604}}
[[1262101  855999 1127305]
 [1125560 1587032 1630694]
 [ 744131  862379 1623403]]
Evaluating performance on  train set...
9426/9426 - 76s - 76s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0611244
{'0': {'precision': 0.4512569068904906, 'recall': 0.3502643181583768, 'f1-score': 0.3943980218281037, 'support': 765933}, '1': {'precision': 0.534237347436197, 'recall': 0.46273594986606, 'f1-score': 0.4959226633025155, 'support': 884351}, '2': {'precision': 0.411190053285968, 'recall': 0.5675792026837957, 'f1-score': 0.4768905871779179, 'support': 761906}, 'accuracy': 0.4601387121246668, 'macro avg': {'precision': 0.4655614358708852, 'recall': 0.46019315690274415, 'f1-score': 0.45573709076951235, 'support': 2412190}, 'weighted avg': {'precision': 0.4690236082757997, 'recall': 0.4601387121246668, 'f1-score': 0.4576745459443437, 'support': 2412190}}
[[268279 183488 314166]
 [170054 409221 305076]
 [156182 173282 432442]]
Evaluating performance on  val set...
3323/3323 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0566901
{'0': {'precision': 0.4491497830112115, 'recall': 0.3523549550511251, 'f1-score': 0.39490758841111034, 'support': 262298}, '1': {'precision': 0.5476519724835042, 'recall': 0.47336583412461736, 'f1-score': 0.507806486991358, 'support': 329633}, '2': {'precision': 0.4055899912960537, 'recall': 0.5645186885322042, 'f1-score': 0.4720360403512122, 'support': 258367}, 'accuracy': 0.4637338909417639, 'macro avg': {'precision': 0.46746391559692313, 'recall': 0.46341315923598225, 'f1-score': 0.4582500385845602, 'support': 850298}, 'weighted avg': {'precision': 0.47410004693779967, 'recall': 0.4637338909417639, 'f1-score': 0.46211067412707235, 'support': 850298}}
[[ 92422  66157 103719]
 [ 63561 156037 110035]
 [ 49788  62726 145853]]
testing model out of sample: results/universal/W6/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 145s - 145s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0396792
{'0': {'precision': 0.4740210661216468, 'recall': 0.31609413367268296, 'f1-score': 0.37927451155812786, 'support': 1394825}, '1': {'precision': 0.5100170484581075, 'recall': 0.628342040565458, 'f1-score': 0.5630299894670676, 'support': 1692080}, '2': {'precision': 0.4431983340055075, 'recall': 0.46606489855265254, 'f1-score': 0.45434408690614053, 'support': 1398213}, 'accuracy': 0.48064710895008783, 'macro avg': {'precision': 0.47574548286175394, 'recall': 0.4701670242635978, 'f1-score': 0.4655495293104453, 'support': 4485118}, 'weighted avg': {'precision': 0.4779922742485177, 'recall': 0.48064710895008783, 'f1-score': 0.47200166505023883, 'support': 4485118}}
[[ 440896  528901  425028]
 [ 235208 1063205  393667]
 [ 254015  492540  651658]]
Evaluating performance on  train set...
5152/5152 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0427122
{'0': {'precision': 0.4820088347557576, 'recall': 0.3059987426302789, 'f1-score': 0.3743469012346614, 'support': 404018}, '1': {'precision': 0.5158554215258464, 'recall': 0.602860013461182, 'f1-score': 0.5559744625650961, 'support': 512585}, '2': {'precision': 0.42807907835494563, 'recall': 0.49311827903494215, 'f1-score': 0.4583027007532147, 'support': 402007}, 'accuracy': 0.4784454842599404, 'macro avg': {'precision': 0.47531444487884994, 'recall': 0.46732567837546773, 'f1-score': 0.46287468818432403, 'support': 1318610}, 'weighted avg': {'precision': 0.47872440122205523, 'recall': 0.4784454842599404, 'f1-score': 0.4705469775435138, 'support': 1318610}}
[[123629 154310 126079]
 [ 64799 309017 138769]
 [ 68059 135711 198237]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0296433
{'0': {'precision': 0.4788760842487965, 'recall': 0.3092418950449993, 'f1-score': 0.37580299314456295, 'support': 138002}, '1': {'precision': 0.5368011719529466, 'recall': 0.5980274679693981, 'f1-score': 0.5657626788269873, 'support': 184433}, '2': {'precision': 0.41960889332513707, 'recall': 0.5052471895290721, 'f1-score': 0.4584631446649621, 'support': 136454}, 'accuracy': 0.4835918925927621, 'macro avg': {'precision': 0.4784287165089601, 'recall': 0.4708388508478232, 'f1-score': 0.46667627221217073, 'support': 458889}, 'weighted avg': {'precision': 0.4845333399909096, 'recall': 0.4835918925927621, 'f1-score': 0.4767296726357495, 'support': 458889}}
[[ 42676  50991  44335]
 [ 23112 110296  51025]
 [ 23329  44182  68943]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1581122
{'0': {'precision': 0.3682672233820459, 'recall': 0.41544983513895434, 'f1-score': 0.3904382470119522, 'support': 91289}, '1': {'precision': 0.4005270830996972, 'recall': 0.08771951369274224, 'f1-score': 0.14391924564796904, 'support': 81430}, '2': {'precision': 0.38531578842275516, 'recall': 0.5886641652176565, 'f1-score': 0.4657623518621322, 'support': 98343}, 'accuracy': 0.3798392987582177, 'macro avg': {'precision': 0.3847033649681661, 'recall': 0.36394450468311773, 'f1-score': 0.3333732815073511, 'support': 271062}, 'weighted avg': {'precision': 0.3841437660498002, 'recall': 0.3798392987582177, 'f1-score': 0.3437092926111586, 'support': 271062}}
[[37926  4518 48845]
 [30780  7143 43507]
 [34279  6173 57891]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1770976
{'0': {'precision': 0.39721520474707717, 'recall': 0.3658945773352094, 'f1-score': 0.38091213837009497, 'support': 18478}, '1': {'precision': 0.40819642534753564, 'recall': 0.12606635071090047, 'f1-score': 0.19263866405384683, 'support': 17935}, '2': {'precision': 0.35281378387846746, 'recall': 0.6313689729852958, 'f1-score': 0.45267136581877615, 'support': 17546}, 'accuracy': 0.37250505013065477, 'macro avg': {'precision': 0.3860751379910268, 'recall': 0.3744433003438019, 'f1-score': 0.34207405608090596, 'support': 53959}, 'weighted avg': {'precision': 0.3864270296680097, 'recall': 0.37250505013065477, 'f1-score': 0.3416675757012659, 'support': 53959}}
[[ 6761  1674 10043]
 [ 5396  2261 10278]
 [ 4864  1604 11078]]
Evaluating performance on  val set...
81/81 - 1s - 944ms/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1531986
{'0': {'precision': 0.39929793769197014, 'recall': 0.3780116311271116, 'f1-score': 0.3883633259833559, 'support': 7222}, '1': {'precision': 0.4408033826638478, 'recall': 0.12956346123970794, 'f1-score': 0.20026413735142273, 'support': 6437}, '2': {'precision': 0.3661711598219535, 'recall': 0.6249104199512685, 'f1-score': 0.4617665748782038, 'support': 6977}, 'accuracy': 0.383989145183175, 'macro avg': {'precision': 0.4020908267259238, 'recall': 0.37749517077269595, 'f1-score': 0.3501313460709941, 'support': 20636}, 'weighted avg': {'precision': 0.4010446434530125, 'recall': 0.383989145183175, 'f1-score': 0.3545069580009756, 'support': 20636}}
[[2730  509 3983]
 [2039  834 3564]
 [2068  549 4360]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8781161
{'0': {'precision': 0.5660142583185724, 'recall': 0.2861466959732984, 'f1-score': 0.3801232832269925, 'support': 135123}, '1': {'precision': 0.6203535799440658, 'recall': 0.8183254179132582, 'f1-score': 0.7057183754232549, 'support': 286782}, '2': {'precision': 0.5173112289773182, 'recall': 0.42419407715003826, 'f1-score': 0.4661478973028797, 'support': 137265}, 'accuracy': 0.592973514315861, 'macro avg': {'precision': 0.5678930224133188, 'recall': 0.5095553970121983, 'f1-score': 0.5173298519843758, 'support': 559170}, 'weighted avg': {'precision': 0.5819276979020175, 'recall': 0.592973514315861, 'f1-score': 0.5682288332052732, 'support': 559170}}
[[ 38665  75943  20515]
 [ 18286 234681  33815]
 [ 11360  67678  58227]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8005984
{'0': {'precision': 0.600158867706528, 'recall': 0.2987311742928004, 'f1-score': 0.39890566128296817, 'support': 27821}, '1': {'precision': 0.7089790098345531, 'recall': 0.834621081214515, 'f1-score': 0.7666866971280855, 'support': 81020}, '2': {'precision': 0.4919948234424108, 'recall': 0.4850893182646737, 'f1-score': 0.48851766865534646, 'support': 27430}, 'accuracy': 0.6548568660977023, 'macro avg': {'precision': 0.6003775669944973, 'recall': 0.539480524590663, 'f1-score': 0.5513700090221334, 'support': 136271}, 'weighted avg': {'precision': 0.6430855959249153, 'recall': 0.6548568660977023, 'f1-score': 0.6356080916342223, 'support': 136271}}
[[ 8311 15510  4000]
 [ 3660 67621  9739]
 [ 1877 12247 13306]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81323355
{'0': {'precision': 0.6144552776600254, 'recall': 0.2939864111144914, 'f1-score': 0.39769531517936757, 'support': 9861}, '1': {'precision': 0.7025807001107232, 'recall': 0.8504415959311317, 'f1-score': 0.7694723422779143, 'support': 29099}, '2': {'precision': 0.4700968523002421, 'recall': 0.420192619846337, 'f1-score': 0.44374607165304847, 'support': 9241}, 'accuracy': 0.65411505985353, 'macro avg': {'precision': 0.5957109433569969, 'recall': 0.5215402089639868, 'f1-score': 0.5369712430367768, 'support': 48201}, 'weighted avg': {'precision': 0.6399805874905911, 'recall': 0.65411505985353, 'f1-score': 0.6309663002650274, 'support': 48201}}
[[ 2899  5677  1285]
 [ 1260 24747  3092]
 [  559  4799  3883]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1685126
{'0': {'precision': 0.4441362476422945, 'recall': 0.315059029296021, 'f1-score': 0.3686248829725734, 'support': 114350}, '1': {'precision': 0.34953273038166627, 'recall': 0.38754680084897336, 'f1-score': 0.3675594985666062, 'support': 83866}, '2': {'precision': 0.401360295194307, 'recall': 0.48740175681923253, 'f1-score': 0.44021616933800145, 'support': 112476}, 'accuracy': 0.3970169814478648, 'macro avg': {'precision': 0.3983430910727559, 'recall': 0.3966691956547423, 'f1-score': 0.3921335169590603, 'support': 310692}, 'weighted avg': {'precision': 0.40311399214128485, 'recall': 0.3970169814478648, 'f1-score': 0.3942546127263072, 'support': 310692}}
[[36027 29432 48891]
 [18488 32502 32876]
 [26602 31053 54821]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1578141
{'0': {'precision': 0.41091207438807603, 'recall': 0.33634043696275073, 'f1-score': 0.3699053387003459, 'support': 44672}, '1': {'precision': 0.4042275643585443, 'recall': 0.3556221748600604, 'f1-score': 0.37837029653625714, 'support': 42697}, '2': {'precision': 0.37832559121621623, 'recall': 0.4932440182606501, 'f1-score': 0.428208677295042, 'support': 43591}, 'accuracy': 0.39485339034819794, 'macro avg': {'precision': 0.3978217433209455, 'recall': 0.39506887669448715, 'f1-score': 0.3921614375105484, 'support': 130960}, 'weighted avg': {'precision': 0.397886067113523, 'recall': 0.39485339034819794, 'f1-score': 0.3920718715149557, 'support': 130960}}
[[15025 11112 18535]
 [10717 15184 16796]
 [10823 11267 21501]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1549497
{'0': {'precision': 0.3958982772764561, 'recall': 0.3342799750640715, 'f1-score': 0.36248920268899987, 'support': 14437}, '1': {'precision': 0.414311835106383, 'recall': 0.3587363270005757, 'f1-score': 0.38452638074668316, 'support': 13896}, '2': {'precision': 0.39235890932149653, 'recall': 0.5012489029906163, 'f1-score': 0.4401695467883926, 'support': 14813}, 'accuracy': 0.3994808325221341, 'macro avg': {'precision': 0.40085634056811187, 'recall': 0.39808840168508786, 'f1-score': 0.3957283767413586, 'support': 43146}, 'weighted avg': {'precision': 0.40061357283312066, 'recall': 0.3994808325221341, 'f1-score': 0.39625612345648403, 'support': 43146}}
[[4826 3509 6102]
 [3514 4985 5397]
 [3850 3538 7425]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1638261
{'0': {'precision': 0.37708854765609146, 'recall': 0.33392570110719527, 'f1-score': 0.35419700202794646, 'support': 100163}, '1': {'precision': 0.30111704711024767, 'recall': 0.008132854107091324, 'f1-score': 0.015837942089331102, 'support': 76234}, '2': {'precision': 0.37793869865365215, 'recall': 0.6900961547735011, 'f1-score': 0.48839987167848625, 'support': 103687}, 'accuracy': 0.3771047257251396, 'macro avg': {'precision': 0.35204809780666374, 'recall': 0.34405156999592923, 'f1-score': 0.2861449385985879, 'support': 280084}, 'weighted avg': {'precision': 0.3567251503676788, 'recall': 0.3771047257251396, 'f1-score': 0.31178339885923684, 'support': 280084}}
[[33447   747 65969]
 [23810   620 51804]
 [31441   692 71554]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.228212
{'0': {'precision': 0.3588527384569777, 'recall': 0.2539532688222799, 'f1-score': 0.2974247147529907, 'support': 38133}, '1': {'precision': 0.3966565349544073, 'recall': 0.013692880751272231, 'f1-score': 0.02647193062528526, 'support': 38122}, '2': {'precision': 0.3372671311484912, 'recall': 0.7594497232953952, 'f1-score': 0.467098555820469, 'support': 38308}, 'accuracy': 0.34303396384522056, 'macro avg': {'precision': 0.36425880151995876, 'recall': 0.3423652909563158, 'f1-score': 0.2636650670662483, 'support': 114563}, 'weighted avg': {'precision': 0.36421445982689216, 'recall': 0.34303396384522056, 'f1-score': 0.26399859521262053, 'support': 114563}}
[[ 9684   335 28114]
 [ 8546   522 29054]
 [ 8756   459 29093]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2083327
{'0': {'precision': 0.3606070603761135, 'recall': 0.278117048346056, 'f1-score': 0.3140353397500359, 'support': 11790}, '1': {'precision': 0.45652173913043476, 'recall': 0.01348747591522158, 'f1-score': 0.026200873362445413, 'support': 10899}, '2': {'precision': 0.35117122801482764, 'recall': 0.7369248593181066, 'f1-score': 0.4756690347737834, 'support': 12084}, 'accuracy': 0.35461421217611366, 'macro avg': {'precision': 0.3894333425071253, 'recall': 0.3428431278597947, 'f1-score': 0.27196841596208826, 'support': 34773}, 'weighted avg': {'precision': 0.38739081459604185, 'recall': 0.35461421217611366, 'f1-score': 0.27998805368063195, 'support': 34773}}
[[3279   97 8414]
 [2713  147 8039]
 [3101   78 8905]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1786062
{'0': {'precision': 0.3738732455178919, 'recall': 0.3646045216039386, 'f1-score': 0.36918071712258904, 'support': 154370}, '1': {'precision': 0.3853479689700655, 'recall': 0.13302515106847665, 'f1-score': 0.19777634990935583, 'support': 129577}, '2': {'precision': 0.36968475073313783, 'recall': 0.5786849605029105, 'f1-score': 0.45115528857982895, 'support': 156847}, 'accuracy': 0.37270471013670786, 'macro avg': {'precision': 0.3763019884070318, 'recall': 0.3587715443917752, 'f1-score': 0.33937078520392455, 'support': 440794}, 'weighted avg': {'precision': 0.37575600117985186, 'recall': 0.37270471013670786, 'f1-score': 0.3479631005465118, 'support': 440794}}
[[56284 13234 84852]
 [42437 17237 69903]
 [51822 14260 90765]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1879781
{'0': {'precision': 0.3682340352506511, 'recall': 0.347455851256358, 'f1-score': 0.35754332313965337, 'support': 52493}, '1': {'precision': 0.42028985507246375, 'recall': 0.17982705654795766, 'f1-score': 0.2518825451213195, 'support': 52734}, '2': {'precision': 0.35253558200750074, 'recall': 0.5740730203888098, 'f1-score': 0.43682125513230335, 'support': 52725}, 'accuracy': 0.36713685170178284, 'macro avg': {'precision': 0.38035315744353854, 'recall': 0.3671186427310418, 'f1-score': 0.34874904113109206, 'support': 157952}, 'weighted avg': {'precision': 0.380373233584565, 'recall': 0.36713685170178284, 'f1-score': 0.3487306046954023, 'support': 157952}}
[[18239  6064 28190]
 [15851  9483 27400]
 [15441  7016 30268]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1842487
{'0': {'precision': 0.3746324361004298, 'recall': 0.3499366152545954, 'f1-score': 0.3618636661568714, 'support': 18932}, '1': {'precision': 0.4096587106848093, 'recall': 0.18963291858123807, 'f1-score': 0.25925533792129873, 'support': 19369}, '2': {'precision': 0.3627861665854847, 'recall': 0.5835770998746344, 'f1-score': 0.4474258595486494, 'support': 19144}, 'accuracy': 0.3737488032030638, 'macro avg': {'precision': 0.38235910445690796, 'recall': 0.37438221123682264, 'f1-score': 0.35618162120893987, 'support': 57445}, 'weighted avg': {'precision': 0.38249454644651276, 'recall': 0.3737488032030638, 'f1-score': 0.3557810118039667, 'support': 57445}}
[[ 6625  2554  9753]
 [ 5826  3673  9870]
 [ 5233  2739 11172]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/EXC
Evaluating performance on  test set...
4450/4450 - 38s - 38s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9403034
{'0': {'precision': 0.6022575028612032, 'recall': 0.3256071740673185, 'f1-score': 0.42268957627876785, 'support': 341006}, '1': {'precision': 0.5290757766103243, 'recall': 0.8056551313349579, 'f1-score': 0.6387094383651001, 'support': 460007}, '2': {'precision': 0.5739421802550801, 'recall': 0.43163769620500264, 'f1-score': 0.49272083946682516, 'support': 338103}, 'accuracy': 0.5509351110861405, 'macro avg': {'precision': 0.5684251532422026, 'recall': 0.5209666672024263, 'f1-score': 0.5180399513702311, 'support': 1139116}, 'weighted avg': {'precision': 0.5643003484830836, 'recall': 0.5509351110861405, 'f1-score': 0.5307105582300522, 'support': 1139116}}
[[111034 174022  55950]
 [ 37015 370607  52385]
 [ 36314 155851 145938]]
Evaluating performance on  train set...
1504/1504 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88255113
{'0': {'precision': 0.6062894438750742, 'recall': 0.3290911930043723, 'f1-score': 0.4266167344589167, 'support': 102464}, '1': {'precision': 0.5805527313060357, 'recall': 0.8025900575568345, 'f1-score': 0.6737494549160162, 'support': 179996}, '2': {'precision': 0.5664974366631825, 'recall': 0.44477226987631646, 'f1-score': 0.49830890642615566, 'support': 102358}, 'accuracy': 0.5813371515885432, 'macro avg': {'precision': 0.5844465372814308, 'recall': 0.5254845068125077, 'f1-score': 0.5328916986003628, 'support': 384818}, 'weighted avg': {'precision': 0.5836669688615056, 'recall': 0.5813371515885432, 'f1-score': 0.5612808314856117, 'support': 384818}}
[[ 33720  56434  12310]
 [ 13005 144463  22528]
 [  8892  47940  45526]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8881248
{'0': {'precision': 0.5970449610761002, 'recall': 0.3316077416318607, 'f1-score': 0.4263913314801157, 'support': 33998}, '1': {'precision': 0.576441251558511, 'recall': 0.7909314564087525, 'f1-score': 0.6668635639320842, 'support': 61377}, '2': {'precision': 0.5471856418487578, 'recall': 0.42691256830601093, 'f1-score': 0.4796239748037538, 'support': 35136}, 'accuracy': 0.5732773482694945, 'macro avg': {'precision': 0.5735572848277898, 'recall': 0.5164839221155414, 'f1-score': 0.5242929567386513, 'support': 130511}, 'weighted avg': {'precision': 0.5739323428337071, 'recall': 0.5732773482694945, 'f1-score': 0.5538123639373325, 'support': 130511}}
[[11274 18844  3880]
 [ 4299 48545  8533]
 [ 3310 16826 15000]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/AAL
Evaluating performance on  test set...
6203/6203 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87998444
{'0': {'precision': 0.5637743768137862, 'recall': 0.31283603384336167, 'f1-score': 0.4023884222244712, 'support': 381286}, '1': {'precision': 0.6189030108190952, 'recall': 0.7999902050811142, 'f1-score': 0.6978909208983186, 'support': 816750}, '2': {'precision': 0.5015020167265082, 'recall': 0.41239710337503493, 'f1-score': 0.4526057077542011, 'support': 389833}, 'accuracy': 0.5878557991874644, 'macro avg': {'precision': 0.5613931347864631, 'recall': 0.5084077807665036, 'f1-score': 0.5176283502923303, 'support': 1587869}, 'weighted avg': {'precision': 0.5768425145971501, 'recall': 0.5878557991874644, 'f1-score': 0.566714333783785, 'support': 1587869}}
[[119280 205776  56230]
 [ 59785 653392 103573]
 [ 32509 196558 160766]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9075389
{'0': {'precision': 0.6135355703610701, 'recall': 0.26728480560383233, 'f1-score': 0.37235454612491703, 'support': 113351}, '1': {'precision': 0.6176950762494898, 'recall': 0.7381304980136209, 'f1-score': 0.6725637617514333, 'support': 225536}, '2': {'precision': 0.45822626936543, 'recall': 0.5392389170836943, 'f1-score': 0.49544272948822093, 'support': 113102}, 'accuracy': 0.5702815776490135, 'macro avg': {'precision': 0.5631523053253299, 'recall': 0.5148847402337159, 'f1-score': 0.5134536791215237, 'support': 451989}, 'weighted avg': {'precision': 0.5767477851690449, 'recall': 0.5702815776490135, 'f1-score': 0.552955192092625, 'support': 451989}}
[[ 30297  58840  24214]
 [ 11166 166475  47895]
 [  7918  44195  60989]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8740514
{'0': {'precision': 0.5945573112616002, 'recall': 0.2788085506777618, 'f1-score': 0.379606461556939, 'support': 34009}, '1': {'precision': 0.662007623888183, 'recall': 0.7314622101257404, 'f1-score': 0.6950040077932564, 'support': 81199}, '2': {'precision': 0.42809979719850966, 'recall': 0.5523977604673808, 'f1-score': 0.4823701341836057, 'support': 32864}, 'accuracy': 0.5877546058674159, 'macro avg': {'precision': 0.5615549107827643, 'recall': 0.5208895070902942, 'f1-score': 0.5189935345112671, 'support': 148072}, 'weighted avg': {'precision': 0.5946007914117737, 'recall': 0.5877546058674159, 'f1-score': 0.5753706215199673, 'support': 148072}}
[[ 9482 17810  6717]
 [ 4270 59394 17535]
 [ 2196 12514 18154]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/WBA
Evaluating performance on  test set...
5183/5183 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0530908
{'0': {'precision': 0.5446428222837354, 'recall': 0.3056330282867365, 'f1-score': 0.391545484909468, 'support': 456433}, '1': {'precision': 0.426144165111969, 'recall': 0.6781387327980247, 'f1-score': 0.5233891870737947, 'support': 408238}, '2': {'precision': 0.48041124975656563, 'recall': 0.43768229459672325, 'f1-score': 0.4580524488746884, 'support': 462164}, 'accuracy': 0.46624033885147737, 'macro avg': {'precision': 0.48373274571742336, 'recall': 0.4738180185604948, 'f1-score': 0.45766237361931705, 'support': 1326835}, 'weighted avg': {'precision': 0.485810205347994, 'recall': 0.46624033885147737, 'f1-score': 0.45527664498452064, 'support': 1326835}}
[[139501 185789 131143]
 [ 43762 276842  87634]
 [ 72870 187013 202281]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0294616
{'0': {'precision': 0.5499706276642214, 'recall': 0.2842551071250623, 'f1-score': 0.3747953417472041, 'support': 128448}, '1': {'precision': 0.44547275794639773, 'recall': 0.7410623166220182, 'f1-score': 0.5564489092171747, 'support': 125424}, '2': {'precision': 0.5062153393443242, 'recall': 0.42198076938196283, 'f1-score': 0.4602758756715733, 'support': 127193}, 'accuracy': 0.4805794287063887, 'macro avg': {'precision': 0.5005529083183144, 'recall': 0.4824327310430144, 'f1-score': 0.463840042211984, 'support': 381065}, 'weighted avg': {'precision': 0.5009713566769594, 'recall': 0.4805794287063887, 'f1-score': 0.46311686851506756, 'support': 381065}}
[[36512 60568 31368]
 [11490 92947 20987]
 [18387 55133 53673]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.011639
{'0': {'precision': 0.5540528149642399, 'recall': 0.28448012052446975, 'f1-score': 0.3759351717916414, 'support': 42481}, '1': {'precision': 0.4730047994296699, 'recall': 0.7718755193618082, 'f1-score': 0.586563735821355, 'support': 48136}, '2': {'precision': 0.5131530196369025, 'recall': 0.3944557839274695, 'f1-score': 0.4460427793134913, 'support': 42134}, 'accuracy': 0.4961167900806774, 'macro avg': {'precision': 0.5134035446769374, 'recall': 0.48360380793791585, 'f1-score': 0.46951389564216256, 'support': 132751}, 'weighted avg': {'precision': 0.5116832715928596, 'recall': 0.4961167900806774, 'f1-score': 0.47456140054667845, 'support': 132751}}
[[12085 21514  8882]
 [ 4095 37155  6886]
 [ 5632 19882 16620]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1039487
{'0': {'precision': 0.4988298585655136, 'recall': 0.2925573424326351, 'f1-score': 0.36881146817615845, 'support': 653530}, '1': {'precision': 0.40406784781964317, 'recall': 0.6082552195942162, 'f1-score': 0.48556905481641216, 'support': 580457}, '2': {'precision': 0.46508374687315324, 'recall': 0.44833108063816307, 'f1-score': 0.45655378595286367, 'support': 640714}, 'accuracy': 0.44354433053590947, 'macro avg': {'precision': 0.45599381775277, 'recall': 0.4497145475550048, 'f1-score': 0.4369781029818114, 'support': 1874701}, 'weighted avg': {'precision': 0.4579556718667415, 'recall': 0.44354433053590947, 'f1-score': 0.43495027637033223, 'support': 1874701}}
[[191195 275945 186390]
 [ 83398 353066 143993]
 [108694 244768 287252]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0731585
{'0': {'precision': 0.5128002315038102, 'recall': 0.3037412012066917, 'f1-score': 0.38150803390098104, 'support': 175024}, '1': {'precision': 0.43832491445331595, 'recall': 0.6659834295814789, 'f1-score': 0.5286877191057969, 'support': 173683}, '2': {'precision': 0.47795299284840803, 'recall': 0.4264723525076695, 'f1-score': 0.4507475123176504, 'support': 175043}, 'accuracy': 0.46488400954653936, 'macro avg': {'precision': 0.47635937960184477, 'recall': 0.4653989944319467, 'f1-score': 0.4536477551081428, 'support': 523750}, 'weighted avg': {'precision': 0.47645682016779384, 'recall': 0.46488400954653936, 'f1-score': 0.45345551893375835, 'support': 523750}}
[[ 53162  76667  45195]
 [ 21670 115670  36343]
 [ 28838  71554  74651]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0617561
{'0': {'precision': 0.521124839756703, 'recall': 0.3013469606637015, 'f1-score': 0.3818717833408285, 'support': 63402}, '1': {'precision': 0.4460595465483937, 'recall': 0.6506170118995152, 'f1-score': 0.5292607507090314, 'support': 63532}, '2': {'precision': 0.4619482243611019, 'recall': 0.4442830694586313, 'f1-score': 0.45294347359172116, 'support': 62656}, 'accuracy': 0.46562582414684317, 'macro avg': {'precision': 0.47637753688873286, 'recall': 0.46541568067394934, 'f1-score': 0.45469200254719366, 'support': 189590}, 'weighted avg': {'precision': 0.47641352469611387, 'recall': 0.46562582414684317, 'f1-score': 0.4547500137284892, 'support': 189590}}
[[19106 26523 17773]
 [ 7547 41335 14650]
 [10010 24809 27837]]
testing model on single stock: results/universal/W6/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 245s - 245s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2136086
{'0': {'precision': 0.3707192294218455, 'recall': 0.4246922284288736, 'f1-score': 0.39587454797299804, 'support': 2212680}, '1': {'precision': 0.44720119107708034, 'recall': 0.22633558535037476, 'f1-score': 0.30055535761147156, 'support': 3112025}, '2': {'precision': 0.3364218913892341, 'recall': 0.5231530766749486, 'f1-score': 0.4095050555914785, 'support': 2188694}, 'accuracy': 0.3712157440327607, 'macro avg': {'precision': 0.38478077062938665, 'recall': 0.39139363015139894, 'f1-score': 0.3686449870586494, 'support': 7513399}, 'weighted avg': {'precision': 0.3924068036811366, 'recall': 0.3712157440327607, 'f1-score': 0.36036429580306706, 'support': 7513399}}
[[ 939708  419210  853762]
 [1002917  704362 1404746]
 [ 592199  451473 1145022]]
Evaluating performance on  train set...
5452/5452 - 46s - 46s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1306964
{'0': {'precision': 0.41726915543398896, 'recall': 0.3837660717978455, 'f1-score': 0.39981698487015704, 'support': 469067}, '1': {'precision': 0.48957567531904467, 'recall': 0.22594276940074687, 'f1-score': 0.30919142540384087, 'support': 459789}, '2': {'precision': 0.3867320501361934, 'recall': 0.623151321104889, 'f1-score': 0.47726815752953045, 'support': 466617}, 'accuracy': 0.4118109056929084, 'macro avg': {'precision': 0.4311922936297424, 'recall': 0.4109533874344938, 'f1-score': 0.3954255226011762, 'support': 1395473}, 'weighted avg': {'precision': 0.4308821812744662, 'recall': 0.4118109056929084, 'f1-score': 0.3958551729765129, 'support': 1395473}}
[[180012  50836 238219]
 [133023 103886 222880]
 [118370  57474 290773]]
Evaluating performance on  val set...
1969/1969 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1255298
{'0': {'precision': 0.41592873639063016, 'recall': 0.3839603333170898, 'f1-score': 0.39930570952558936, 'support': 164168}, '1': {'precision': 0.5255034798492451, 'recall': 0.2523567359900512, 'f1-score': 0.34097217012977277, 'support': 180122}, '2': {'precision': 0.38073560038193477, 'recall': 0.6339095711388729, 'f1-score': 0.47573663765365704, 'support': 159772}, 'accuracy': 0.41615912328245336, 'macro avg': {'precision': 0.44072260554060333, 'recall': 0.4234088801486713, 'f1-score': 0.4053381724363397, 'support': 504062}, 'weighted avg': {'precision': 0.4439291494645602, 'recall': 0.41615912328245336, 'f1-score': 0.4026869770399513, 'support': 504062}}
[[ 63034  19874  81260]
 [ 51194  45455  83473]
 [ 37322  21169 101281]]
training model: results/universal/W6/deepOF_L2/h100
Epoch 1/50
9426/9426 - 221s - loss: 3.1782 - accuracy100: 0.4289 - val_loss: 3.2447 - val_accuracy100: 0.3996 - 221s/epoch - 23ms/step
Epoch 2/50
9426/9426 - 218s - loss: 3.1328 - accuracy100: 0.4450 - val_loss: 3.2382 - val_accuracy100: 0.4078 - 218s/epoch - 23ms/step
Epoch 3/50
9426/9426 - 212s - loss: 3.1170 - accuracy100: 0.4502 - val_loss: 3.2351 - val_accuracy100: 0.4083 - 212s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 212s - loss: 3.1083 - accuracy100: 0.4528 - val_loss: 3.2347 - val_accuracy100: 0.4092 - 212s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 212s - loss: 3.1031 - accuracy100: 0.4544 - val_loss: 3.2282 - val_accuracy100: 0.4097 - 212s/epoch - 23ms/step
Epoch 6/50
9426/9426 - 210s - loss: 3.0990 - accuracy100: 0.4558 - val_loss: 3.2266 - val_accuracy100: 0.4102 - 210s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 211s - loss: 3.0951 - accuracy100: 0.4570 - val_loss: 3.2273 - val_accuracy100: 0.4107 - 211s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 213s - loss: 3.0922 - accuracy100: 0.4577 - val_loss: 3.2335 - val_accuracy100: 0.4098 - 213s/epoch - 23ms/step
Epoch 9/50
9426/9426 - 211s - loss: 3.0894 - accuracy100: 0.4587 - val_loss: 3.2401 - val_accuracy100: 0.4089 - 211s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 210s - loss: 3.0867 - accuracy100: 0.4594 - val_loss: 3.2419 - val_accuracy100: 0.4071 - 210s/epoch - 22ms/step
Epoch 11/50
9426/9426 - 211s - loss: 3.0843 - accuracy100: 0.4603 - val_loss: 3.2515 - val_accuracy100: 0.4069 - 211s/epoch - 22ms/step
Epoch 12/50
9426/9426 - 211s - loss: 3.0826 - accuracy100: 0.4605 - val_loss: 3.2570 - val_accuracy100: 0.4043 - 211s/epoch - 22ms/step
Epoch 13/50
9426/9426 - 205s - loss: 3.0805 - accuracy100: 0.4614 - val_loss: 3.2639 - val_accuracy100: 0.4032 - 205s/epoch - 22ms/step
Epoch 14/50
9426/9426 - 204s - loss: 3.0786 - accuracy100: 0.4621 - val_loss: 3.2678 - val_accuracy100: 0.4028 - 204s/epoch - 22ms/step
Epoch 15/50
9426/9426 - 205s - loss: 3.0766 - accuracy100: 0.4626 - val_loss: 3.2636 - val_accuracy100: 0.4029 - 205s/epoch - 22ms/step
Epoch 16/50
9426/9426 - 204s - loss: 3.0751 - accuracy100: 0.4636 - val_loss: 3.2859 - val_accuracy100: 0.4018 - 204s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 313s - 313s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101885
{'0': {'precision': 0.3745175823110609, 'recall': 0.3663078653164012, 'f1-score': 0.37036723438477837, 'support': 3343540}, '1': {'precision': 0.401298208766645, 'recall': 0.3774154286485521, 'f1-score': 0.38899058190451496, 'support': 4126959}, '2': {'precision': 0.35942153400768856, 'recall': 0.3936561129355262, 'f1-score': 0.375760679013912, 'support': 3348105}, 'accuracy': 0.37900869650095337, 'macro avg': {'precision': 0.3784124416951315, 'recall': 0.3791264689668265, 'f1-score': 0.3783728317677351, 'support': 10818604}, 'weighted avg': {'precision': 0.3800616795505705, 'recall': 0.37900869650095337, 'f1-score': 0.3791406039051648, 'support': 10818604}}
[[1224765 1159719  959056]
 [1179430 1557578 1389951]
 [ 866052 1164051 1318002]]
Evaluating performance on  train set...
9426/9426 - 75s - 75s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0773414
{'0': {'precision': 0.4122058289514323, 'recall': 0.39684688271359186, 'f1-score': 0.40438056976311537, 'support': 803776}, '1': {'precision': 0.4092542292468519, 'recall': 0.40685001697688056, 'f1-score': 0.40804858175261843, 'support': 809925}, '2': {'precision': 0.4082652821184931, 'recall': 0.4260108780459092, 'f1-score': 0.41694934990515936, 'support': 798489}, 'accuracy': 0.4098595052628524, 'macro avg': {'precision': 0.4099084467722591, 'recall': 0.40990259257879386, 'f1-score': 0.40979283380696435, 'support': 2412190}, 'weighted avg': {'precision': 0.4099103805452872, 'recall': 0.4098595052628524, 'f1-score': 0.409772701932405, 'support': 2412190}}
[[318976 244034 240766]
 [228142 329518 252265]
 [226709 231615 340165]]
Evaluating performance on  val set...
3323/3323 - 25s - 25s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.07574
{'0': {'precision': 0.399770957927979, 'recall': 0.38417955577953505, 'f1-score': 0.3918202140183331, 'support': 269866}, '1': {'precision': 0.43323251068213786, 'recall': 0.4194204242123939, 'f1-score': 0.4262145967641073, 'support': 312815}, '2': {'precision': 0.3941204033111778, 'recall': 0.424307872818244, 'f1-score': 0.4086574104064549, 'support': 267617}, 'accuracy': 0.40977398512051066, 'macro avg': {'precision': 0.40904129064043154, 'recall': 0.40930261760339093, 'f1-score': 0.4088974070629651, 'support': 850298}, 'weighted avg': {'precision': 0.4103026669875178, 'recall': 0.40977398512051066, 'f1-score': 0.40977274221952764, 'support': 850298}}
[[103677  86957  79232]
 [ 86283 131201  95331]
 [ 69381  84684 113552]]
testing model out of sample: results/universal/W6/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 132s - 132s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0793674
{'0': {'precision': 0.4139190841989803, 'recall': 0.31113912165777174, 'f1-score': 0.35524436315531893, 'support': 1433587}, '1': {'precision': 0.41015531121634824, 'recall': 0.556254671264721, 'f1-score': 0.4721615296696261, 'support': 1601547}, '2': {'precision': 0.411469083221231, 'recall': 0.3505976617673023, 'f1-score': 0.37860226657461554, 'support': 1449984}, 'accuracy': 0.4114215055211479, 'macro avg': {'precision': 0.4118478262121865, 'recall': 0.405997151563265, 'f1-score': 0.4020027197998535, 'support': 4485118}, 'weighted avg': {'precision': 0.4117830597851887, 'recall': 0.4114215055211479, 'f1-score': 0.4045444982935727, 'support': 4485118}}
[[446045 648702 338840]
 [322402 890868 388277]
 [309167 632456 508361]]
Evaluating performance on  train set...
5152/5152 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0838975
{'0': {'precision': 0.42602222268260515, 'recall': 0.2825345720259127, 'f1-score': 0.33974977661084577, 'support': 436697}, '1': {'precision': 0.3906777942438187, 'recall': 0.5577295664993475, 'f1-score': 0.4594914924611867, 'support': 449042}, '2': {'precision': 0.4150783871982183, 'recall': 0.3719999722781152, 'f1-score': 0.39236029468200584, 'support': 432871}, 'accuracy': 0.40561955392420806, 'macro avg': {'precision': 0.4105928013748807, 'recall': 0.40408803693445844, 'f1-score': 0.39720052125134614, 'support': 1318610}, 'weighted avg': {'precision': 0.4103933393547284, 'recall': 0.40561955392420806, 'f1-score': 0.3977977416170644, 'support': 1318610}}
[[123382 203042 110273]
 [ 81953 250444 116645]
 [ 84279 187564 161028]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0740541
{'0': {'precision': 0.4159866730666064, 'recall': 0.30021395822720326, 'f1-score': 0.34874307626757567, 'support': 147225}, '1': {'precision': 0.414032016240932, 'recall': 0.536399391935912, 'f1-score': 0.46733834728726176, 'support': 165772}, '2': {'precision': 0.40644946036903795, 'recall': 0.3841060510514627, 'f1-score': 0.39496201068493536, 'support': 145892}, 'accuracy': 0.41220643772241217, 'macro avg': {'precision': 0.4121560498921921, 'recall': 0.40690646707152595, 'f1-score': 0.40368114474659095, 'support': 458889}, 'weighted avg': {'precision': 0.412248447905011, 'recall': 0.41220643772241217, 'f1-score': 0.4062793171613274, 'support': 458889}}
[[44199 66165 36861]
 [31879 88920 44973]
 [30173 59681 56038]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1200382
{'0': {'precision': 0.3323682492929225, 'recall': 0.46511627906976744, 'f1-score': 0.38769374926794986, 'support': 85398}, '1': {'precision': 0.38572437575304336, 'recall': 0.10274230318054049, 'f1-score': 0.16226372224309846, 'support': 90362}, '2': {'precision': 0.3649548581423988, 'recall': 0.4882059138318188, 'f1-score': 0.4176777129930113, 'support': 95302}, 'accuracy': 0.3524322848647173, 'macro avg': {'precision': 0.36101582772945484, 'recall': 0.35202149869404226, 'f1-score': 0.3225450615013532, 'support': 271062}, 'weighted avg': {'precision': 0.361612242533444, 'recall': 0.3524322848647173, 'f1-score': 0.32308573932522894, 'support': 271062}}
[[39720  6924 38754]
 [38872  9284 42206]
 [40914  7861 46527]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129334
{'0': {'precision': 0.3807667316439246, 'recall': 0.4385055320968518, 'f1-score': 0.407601540181344, 'support': 18709}, '1': {'precision': 0.3429171377806493, 'recall': 0.12237016542740216, 'f1-score': 0.18037383177570096, 'support': 17349}, '2': {'precision': 0.35092670276866755, 'recall': 0.5140494944416513, 'f1-score': 0.41710672438410806, 'support': 17901}, 'accuracy': 0.3619229414926148, 'macro avg': {'precision': 0.35820352406441386, 'recall': 0.35830839732196845, 'f1-score': 0.33502736544705103, 'support': 53959}, 'weighted avg': {'precision': 0.35869777260409913, 'recall': 0.3619229414926148, 'f1-score': 0.3376962192762898, 'support': 53959}}
[[8204 1972 8533]
 [6739 2123 8487]
 [6603 2096 9202]]
Evaluating performance on  val set...
81/81 - 1s - 813ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1165029
{'0': {'precision': 0.34727102365893653, 'recall': 0.45026575550493547, 'f1-score': 0.39211796601203464, 'support': 6585}, '1': {'precision': 0.39066666666666666, 'recall': 0.12075834592663827, 'f1-score': 0.18448945324797983, 'support': 7279}, '2': {'precision': 0.3499187652315191, 'recall': 0.5088600118133491, 'f1-score': 0.41468110709987965, 'support': 6772}, 'accuracy': 0.3532661368482264, 'macro avg': {'precision': 0.3626188185190407, 'recall': 0.35996137108164095, 'f1-score': 0.33042950878663135, 'support': 20636}, 'weighted avg': {'precision': 0.36344699726732943, 'recall': 0.3532661368482264, 'f1-score': 0.3262849386345066, 'support': 20636}}
[[2965  673 2947]
 [2945  879 3455]
 [2628  698 3446]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0382158
{'0': {'precision': 0.5181231876812319, 'recall': 0.2361257468999026, 'f1-score': 0.32440808085550954, 'support': 175559}, '1': {'precision': 0.42380132273259885, 'recall': 0.7952121903712593, 'f1-score': 0.5529257461212638, 'support': 203308}, '2': {'precision': 0.5447537341700878, 'recall': 0.2951198815327532, 'f1-score': 0.3828377376952464, 'support': 180303}, 'accuracy': 0.4584258812168035, 'macro avg': {'precision': 0.4955594148613061, 'recall': 0.4421526062679717, 'f1-score': 0.42005718822400656, 'support': 559170}, 'weighted avg': {'precision': 0.4924157600735339, 'recall': 0.4584258812168035, 'f1-score': 0.4263350653271819, 'support': 559170}}
[[ 41454 110409  23696]
 [ 20863 161673  20772]
 [ 17691 109401  53211]]
Evaluating performance on  train set...
533/533 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9814288
{'0': {'precision': 0.5327368608164958, 'recall': 0.23656168600520958, 'f1-score': 0.32763646964506965, 'support': 38007}, '1': {'precision': 0.5210953518358029, 'recall': 0.8031961685074773, 'f1-score': 0.6320991769441809, 'support': 61386}, '2': {'precision': 0.5193332257022926, 'recall': 0.34890720754921634, 'f1-score': 0.4173938430596555, 'support': 36878}, 'accuracy': 0.522216759251785, 'macro avg': {'precision': 0.5243884794515304, 'recall': 0.4628883540206344, 'f1-score': 0.45904316321630206, 'support': 136271}, 'weighted avg': {'precision': 0.5238653846694771, 'recall': 0.522216759251785, 'f1-score': 0.48907815692296697, 'support': 136271}}
[[ 8991 24280  4736]
 [ 4908 49305  7173]
 [ 2978 21033 12867]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9821796
{'0': {'precision': 0.55621925509487, 'recall': 0.23699378696010182, 'f1-score': 0.3323710041467639, 'support': 13359}, '1': {'precision': 0.5315471291119122, 'recall': 0.8325775762425536, 'f1-score': 0.648847159907842, 'support': 22494}, '2': {'precision': 0.4910665200659703, 'recall': 0.2893586005830904, 'f1-score': 0.3641459437423563, 'support': 12348}, 'accuracy': 0.5283500342316549, 'macro avg': {'precision': 0.5262776347575842, 'recall': 0.45297665459524855, 'f1-score': 0.4484547025989874, 'support': 48201}, 'weighted avg': {'precision': 0.5280148449374561, 'recall': 0.5283500342316549, 'f1-score': 0.48820120687733104, 'support': 48201}}
[[ 3166  8660  1533]
 [ 1596 18728  2170]
 [  930  7845  3573]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1243281
{'0': {'precision': 0.4125987793782394, 'recall': 0.3487276968937659, 'f1-score': 0.3779840227764406, 'support': 115735}, '1': {'precision': 0.2822061774623994, 'recall': 0.3392186606321339, 'f1-score': 0.3080971202710333, 'support': 80426}, '2': {'precision': 0.398333892718526, 'recall': 0.40413512498799453, 'f1-score': 0.4012135396350713, 'support': 114531}, 'accuracy': 0.36669112819126337, 'macro avg': {'precision': 0.36437961651972156, 'recall': 0.3640271608379648, 'f1-score': 0.3624315608941817, 'support': 310692}, 'weighted avg': {'precision': 0.37358674451507273, 'recall': 0.36669112819126337, 'f1-score': 0.36845618097309824, 'support': 310692}}
[[40360 34844 40531]
 [23762 27282 29382]
 [33697 34548 46286]]
Evaluating performance on  train set...
512/512 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1141
{'0': {'precision': 0.37134890205646565, 'recall': 0.3637667304015296, 'f1-score': 0.36751871399496355, 'support': 43932}, '1': {'precision': 0.3624682068673167, 'recall': 0.3090215034333213, 'f1-score': 0.33361783066718687, 'support': 44272}, '2': {'precision': 0.3515673262788705, 'recall': 0.4126204509308635, 'f1-score': 0.3796550351313255, 'support': 42756}, 'accuracy': 0.36120952962736713, 'macro avg': {'precision': 0.3617948117342176, 'recall': 0.3618028949219048, 'f1-score': 0.36026385993115867, 'support': 130960}, 'weighted avg': {'precision': 0.3618884012061231, 'recall': 0.36120952962736713, 'f1-score': 0.3600205515012171, 'support': 130960}}
[[15981 12084 15867]
 [13919 13681 16672]
 [13135 11979 17642]]
Evaluating performance on  val set...
169/169 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1140383
{'0': {'precision': 0.3626230853391685, 'recall': 0.37466440582167587, 'f1-score': 0.36854541663770934, 'support': 14154}, '1': {'precision': 0.36994019242437376, 'recall': 0.29473102686278574, 'f1-score': 0.3280805596125759, 'support': 14481}, '2': {'precision': 0.3613776861937003, 'recall': 0.42298945627455037, 'f1-score': 0.38976377952755903, 'support': 14511}, 'accuracy': 0.3640893709729755, 'macro avg': {'precision': 0.3646469879857475, 'recall': 0.36412829631967064, 'f1-score': 0.3621299185926148, 'support': 43146}, 'weighted avg': {'precision': 0.36466005378817806, 'recall': 0.3640893709729755, 'f1-score': 0.36210051025736467, 'support': 43146}}
[[5303 3603 5248]
 [4614 4268 5599]
 [4707 3666 6138]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062167
{'0': {'precision': 0.37831299057932116, 'recall': 0.4914257419739488, 'f1-score': 0.42751399963077896, 'support': 98959}, '1': {'precision': 0.2549019607843137, 'recall': 0.01587239070500197, 'f1-score': 0.02988394942716251, 'support': 76170}, '2': {'precision': 0.3872978459610066, 'recall': 0.5416892954123196, 'f1-score': 0.45166415755375394, 'support': 104955}, 'accuracy': 0.38093214892675054, 'macro avg': {'precision': 0.34017093244154717, 'recall': 0.34966247603042344, 'f1-score': 0.3030207022038985, 'support': 280084}, 'weighted avg': {'precision': 0.34811771829350363, 'recall': 0.38093214892675054, 'f1-score': 0.3284265790740759, 'support': 280084}}
[[48631  1636 48692]
 [33712  1209 41249]
 [46204  1898 56853]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1340991
{'0': {'precision': 0.35729347785875476, 'recall': 0.5049802619539359, 'f1-score': 0.4184892702002968, 'support': 38251}, '1': {'precision': 0.32332878581173263, 'recall': 0.012517495444582354, 'f1-score': 0.02410189916863702, 'support': 37867}, '2': {'precision': 0.34201744727703903, 'recall': 0.5251918324879699, 'f1-score': 0.4142593352482561, 'support': 38445}, 'accuracy': 0.3489870202421375, 'macro avg': {'precision': 0.3408799036491755, 'recall': 0.34756319662882934, 'f1-score': 0.28561683487239664, 'support': 114563}, 'weighted avg': {'precision': 0.34094065897780146, 'recall': 0.3489870202421375, 'f1-score': 0.28671124039933954, 'support': 114563}}
[[19316   343 18592]
 [17141   474 20252]
 [17605   649 20191]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1231121
{'0': {'precision': 0.35407115083280133, 'recall': 0.523062414266118, 'f1-score': 0.4222875930091711, 'support': 11664}, '1': {'precision': 0.35792349726775957, 'recall': 0.012068171349608475, 'f1-score': 0.023349077622315303, 'support': 10855}, '2': {'precision': 0.36836283185840707, 'recall': 0.5163212012404113, 'f1-score': 0.4299694189602446, 'support': 12254}, 'accuracy': 0.36117102349524055, 'macro avg': {'precision': 0.36011915998632266, 'recall': 0.3504839289520459, 'f1-score': 0.291868696530577, 'support': 34773}, 'weighted avg': {'precision': 0.3603101143918628, 'recall': 0.36117102349524055, 'f1-score': 0.300459033801744, 'support': 34773}}
[[6101  116 5447]
 [5322  131 5402]
 [5808  119 6327]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1024017
{'0': {'precision': 0.3831048743088146, 'recall': 0.5187431577092955, 'f1-score': 0.4407239915755262, 'support': 158938}, '1': {'precision': 0.3503066774678857, 'recall': 0.14978474936909297, 'f1-score': 0.209844020797227, 'support': 121254}, '2': {'precision': 0.38487262429635427, 'recall': 0.41635222475436173, 'f1-score': 0.3999940180654423, 'support': 160602}, 'accuracy': 0.37994391938184274, 'macro avg': {'precision': 0.37276139202435155, 'recall': 0.3616267106109167, 'f1-score': 0.3501873434793985, 'support': 440794}, 'weighted avg': {'precision': 0.37472679208389514, 'recall': 0.37994391938184274, 'f1-score': 0.36237348049230284, 'support': 440794}}
[[82448 16823 59667]
 [55888 18162 47204]
 [76874 16861 66867]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1081887
{'0': {'precision': 0.3683692922201713, 'recall': 0.45734089713727555, 'f1-score': 0.40806167770049445, 'support': 53236}, '1': {'precision': 0.3925922822306951, 'recall': 0.1810593032018705, 'f1-score': 0.24782459202835302, 'support': 51751}, '2': {'precision': 0.35306143460163847, 'recall': 0.45322382705560277, 'f1-score': 0.39692119448394464, 'support': 52965}, 'accuracy': 0.3654401337115073, 'macro avg': {'precision': 0.37134100301750167, 'recall': 0.3638746757982496, 'f1-score': 0.350935821404264, 'support': 157952}, 'weighted avg': {'precision': 0.371172569654259, 'recall': 0.3654401337115073, 'f1-score': 0.3518263333288908, 'support': 157952}}
[[24347  6940 21949]
 [20344  9370 22037]
 [21403  7557 24005]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1096088
{'0': {'precision': 0.3642278369855905, 'recall': 0.47767366382243626, 'f1-score': 0.413307364797536, 'support': 19103}, '1': {'precision': 0.38807397959183676, 'recall': 0.19278698912239942, 'f1-score': 0.25760248359556903, 'support': 18938}, '2': {'precision': 0.3674295161851723, 'recall': 0.4352195423623995, 'f1-score': 0.3984618288194772, 'support': 19404}, 'accuracy': 0.3694142222995909, 'macro avg': {'precision': 0.3732437775875332, 'recall': 0.36856006510241174, 'f1-score': 0.3564572257375274, 'support': 57445}, 'weighted avg': {'precision': 0.37317071507534205, 'recall': 0.3694142222995909, 'f1-score': 0.356961262955407, 'support': 57445}}
[[9125 2822 7156]
 [7904 3651 7383]
 [8024 2935 8445]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/EXC
Evaluating performance on  test set...
4450/4450 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0737903
{'0': {'precision': 0.5566312097145774, 'recall': 0.27561734300867935, 'f1-score': 0.36868124205258623, 'support': 407634}, '1': {'precision': 0.3269062123809871, 'recall': 0.6863121714516781, 'f1-score': 0.4428654593327871, 'support': 326436}, '2': {'precision': 0.5327366540980353, 'recall': 0.3313771769132395, 'f1-score': 0.4085960949533939, 'support': 405046}, 'accuracy': 0.4131370290646431, 'macro avg': {'precision': 0.47209135873119995, 'recall': 0.4311022304578656, 'f1-score': 0.4067142654462557, 'support': 1139116}, 'weighted avg': {'precision': 0.48230260454719687, 'recall': 0.4131370290646431, 'f1-score': 0.4041330754568578, 'support': 1139116}}
[[112351 237460  57823]
 [ 42495 224037  59904]
 [ 46995 223828 134223]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0475737
{'0': {'precision': 0.5644485282264564, 'recall': 0.27173744334761285, 'f1-score': 0.36686049557336686, 'support': 128856}, '1': {'precision': 0.3784508230444124, 'recall': 0.7200509199592008, 'f1-score': 0.4961373343793584, 'support': 126473}, '2': {'precision': 0.558494516329288, 'recall': 0.3543312559367977, 'f1-score': 0.43358123623855377, 'support': 129489}, 'accuracy': 0.4468709883633302, 'macro avg': {'precision': 0.5004646225333856, 'recall': 0.44870653974787045, 'f1-score': 0.4321930220637597, 'support': 384818}, 'weighted avg': {'precision': 0.5013156529086671, 'recall': 0.4468709883633302, 'f1-score': 0.4317993280144287, 'support': 384818}}
[[35015 77877 15964]
 [15099 91067 20307]
 [11920 71687 45882]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.04441
{'0': {'precision': 0.5512639789493469, 'recall': 0.2805289208770713, 'f1-score': 0.3718365212430471, 'support': 41821}, '1': {'precision': 0.3849933872866035, 'recall': 0.7139482033166078, 'f1-score': 0.5002364811603343, 'support': 44443}, '2': {'precision': 0.546844696404595, 'recall': 0.33136709833435035, 'f1-score': 0.41267116058486614, 'support': 44247}, 'accuracy': 0.4453570963367072, 'macro avg': {'precision': 0.49436735421351513, 'recall': 0.44194807417600984, 'f1-score': 0.4282480543294158, 'support': 130511}, 'weighted avg': {'precision': 0.49314547629420713, 'recall': 0.4453570963367072, 'f1-score': 0.42940476993903026, 'support': 130511}}
[[11732 25402  4687]
 [ 5250 31730  7463]
 [ 4300 25285 14662]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/AAL
Evaluating performance on  test set...
6203/6203 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0354294
{'0': {'precision': 0.5130829657430198, 'recall': 0.2622373630114947, 'f1-score': 0.3470811197707374, 'support': 481701}, '1': {'precision': 0.4383855522164867, 'recall': 0.7504997029680223, 'f1-score': 0.5534734749029842, 'support': 609362}, '2': {'precision': 0.5081114766841114, 'recall': 0.3052579880275198, 'f1-score': 0.38138900904344675, 'support': 496806}, 'accuracy': 0.46307346512842057, 'macro avg': {'precision': 0.48652666488120594, 'recall': 0.4393316846690123, 'f1-score': 0.42731453457238944, 'support': 1587869}, 'weighted avg': {'precision': 0.4828615615246898, 'recall': 0.46307346512842057, 'f1-score': 0.4370205439588246, 'support': 1587869}}
[[126320 292025  63356]
 [ 68580 457326  83456]
 [ 51298 293854 151654]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0420958
{'0': {'precision': 0.5543774262703517, 'recall': 0.19791903688227871, 'f1-score': 0.29169842382854183, 'support': 145029}, '1': {'precision': 0.42358487319775645, 'recall': 0.7521247410901404, 'f1-score': 0.541951276423856, 'support': 163667}, '2': {'precision': 0.4911041769310779, 'recall': 0.37563593476303797, 'f1-score': 0.4256786413333597, 'support': 143293}, 'accuracy': 0.45494027509519036, 'macro avg': {'precision': 0.48968882546639536, 'recall': 0.4418932375784857, 'f1-score': 0.41977611386191915, 'support': 451989}, 'weighted avg': {'precision': 0.4869575587485647, 'recall': 0.45494027509519036, 'f1-score': 0.4247913993935116, 'support': 451989}}
[[ 28704  90207  26118]
 [ 10911 123098  29658]
 [ 12162  77305  53826]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0137321
{'0': {'precision': 0.5379824203969963, 'recall': 0.20774141341485344, 'f1-score': 0.29973892033016036, 'support': 44488}, '1': {'precision': 0.4706426407271568, 'recall': 0.7303758207674794, 'f1-score': 0.5724241816924082, 'support': 60614}, '2': {'precision': 0.4673889431953948, 'recall': 0.40058180125669074, 'f1-score': 0.43141432116093137, 'support': 42970}, 'accuracy': 0.4776460100491653, 'macro avg': {'precision': 0.492004668106516, 'recall': 0.44623301181300784, 'f1-score': 0.43452580772783334, 'support': 148072}, 'weighted avg': {'precision': 0.48993055967882904, 'recall': 0.4776460100491653, 'f1-score': 0.44957573219134633, 'support': 148072}}
[[ 9242 27668  7578]
 [ 4306 44271 12037]
 [ 3631 22126 17213]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/WBA
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0845088
{'0': {'precision': 0.40561949081517185, 'recall': 0.30677897125380754, 'f1-score': 0.34934250068811334, 'support': 405445}, '1': {'precision': 0.39910055625850505, 'recall': 0.5397681293955018, 'f1-score': 0.45889646546747226, 'support': 495535}, '2': {'precision': 0.3940416461902422, 'recall': 0.3238496671402238, 'f1-score': 0.3555141386683783, 'support': 425855}, 'accuracy': 0.3992727053476883, 'macro avg': {'precision': 0.39958723108797295, 'recall': 0.39013225592984435, 'f1-score': 0.38791770160798794, 'support': 1326835}, 'weighted avg': {'precision': 0.39946888184096835, 'recall': 0.3992727053476883, 'f1-score': 0.3922386006772042, 'support': 1326835}}
[[124382 195004  86059]
 [102037 267474 126024]
 [ 80228 207714 137913]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0801619
{'0': {'precision': 0.45858759607377375, 'recall': 0.2593656382223046, 'f1-score': 0.3313359668979666, 'support': 129516}, '1': {'precision': 0.37118685584006933, 'recall': 0.6297702297702298, 'f1-score': 0.46707782951066484, 'support': 125125}, '2': {'precision': 0.4397730365779611, 'recall': 0.3322786812630513, 'f1-score': 0.37854252836275487, 'support': 126424}, 'accuracy': 0.405180218597877, 'macro avg': {'precision': 0.4231824961639347, 'recall': 0.4071381830851952, 'f1-score': 0.39231877492379547, 'support': 381065}, 'weighted avg': {'precision': 0.4236470229656665, 'recall': 0.405180218597877, 'f1-score': 0.3915691105507247, 'support': 381065}}
[[33592 69127 26797]
 [19608 78800 26717]
 [20051 64365 42008]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0743464
{'0': {'precision': 0.4498048658972017, 'recall': 0.2513980740225084, 'f1-score': 0.32253166817999135, 'support': 43095}, '1': {'precision': 0.3854166666666667, 'recall': 0.6483737231268966, 'f1-score': 0.48345204519017804, 'support': 46794}, '2': {'precision': 0.4442811821673067, 'recall': 0.310391488964584, 'f1-score': 0.36545936517093136, 'support': 42862}, 'accuracy': 0.41037732295801915, 'macro avg': {'precision': 0.42650090491039166, 'recall': 0.40338776203799637, 'f1-score': 0.3904810261803669, 'support': 132751}, 'weighted avg': {'precision': 0.4253249182747776, 'recall': 0.41037732295801915, 'f1-score': 0.39311550611899254, 'support': 132751}}
[[10834 24628  7633]
 [ 7446 30340  9008]
 [ 5806 23752 13304]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 59s - 59s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978746
{'0': {'precision': 0.3936077574200154, 'recall': 0.265025388001318, 'f1-score': 0.3167652565187448, 'support': 591815}, '1': {'precision': 0.39643384644995544, 'recall': 0.5412979919816381, 'f1-score': 0.45767635531247225, 'support': 700143}, '2': {'precision': 0.3794821521250216, 'recall': 0.33877369612333397, 'f1-score': 0.35797431124787277, 'support': 582743}, 'accuracy': 0.3911290387107064, 'macro avg': {'precision': 0.3898412519983308, 'recall': 0.3816990253687633, 'f1-score': 0.3774719743596966, 'support': 1874701}, 'weighted avg': {'precision': 0.39027232891449304, 'recall': 0.3911290387107064, 'f1-score': 0.3822008687165048, 'support': 1874701}}
[[156846 298184 136785]
 [135130 378986 186027]
 [106507 278818 197418]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026733
{'0': {'precision': 0.43106444129277066, 'recall': 0.26107707448049106, 'f1-score': 0.3251966272231276, 'support': 175791}, '1': {'precision': 0.36041127652655836, 'recall': 0.5928326831508752, 'f1-score': 0.448287307633972, 'support': 172003}, '2': {'precision': 0.42152623235112424, 'recall': 0.32187024028734457, 'f1-score': 0.3650185457908628, 'support': 175956}, 'accuracy': 0.3904515513126492, 'macro avg': {'precision': 0.4043339833901511, 'recall': 0.39192666597290365, 'f1-score': 0.37950082688265413, 'support': 523750}, 'weighted avg': {'precision': 0.4046570687069585, 'recall': 0.3904515513126492, 'f1-score': 0.37899876909656127, 'support': 523750}}
[[ 45895  92263  37633]
 [ 29945 101969  40089]
 [ 30629  88692  56635]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964724
{'0': {'precision': 0.4298418252059188, 'recall': 0.28127832101120914, 'f1-score': 0.34004151770268715, 'support': 62895}, '1': {'precision': 0.3676762482645138, 'recall': 0.5546230220291654, 'f1-score': 0.44220291289155506, 'support': 64460}, '2': {'precision': 0.40610961365678344, 'recall': 0.33408853539005384, 'f1-score': 0.3665952588752832, 'support': 62235}, 'accuracy': 0.39155018724616275, 'macro avg': {'precision': 0.40120922904240536, 'recall': 0.38999662614347613, 'f1-score': 0.3829465631565085, 'support': 189590}, 'weighted avg': {'precision': 0.4009153666616738, 'recall': 0.39155018724616275, 'f1-score': 0.38349262596657735, 'support': 189590}}
[[17691 31258 13946]
 [12249 35751 16460]
 [11217 30226 20792]]
testing model on single stock: results/universal/W6/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 218s - 218s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1137978
{'0': {'precision': 0.3515671696159218, 'recall': 0.39787219801209517, 'f1-score': 0.37328917739321776, 'support': 2255943}, '1': {'precision': 0.42188188366831225, 'recall': 0.2984723236743557, 'f1-score': 0.3496059712043745, 'support': 3025510}, '2': {'precision': 0.331748374554319, 'recall': 0.41913110801067766, 'f1-score': 0.3703552088884173, 'support': 2231946}, 'accuracy': 0.3641608811138607, 'macro avg': {'precision': 0.368399142612851, 'recall': 0.3718252098990429, 'f1-score': 0.3644167858286698, 'support': 7513399}, 'weighted avg': {'precision': 0.3739942216266141, 'recall': 0.3641608811138607, 'f1-score': 0.3628808074364482, 'support': 7513399}}
[[ 897577  615872  742494]
 [ 980609  903031 1141870]
 [ 674888  621580  935478]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0895113
{'0': {'precision': 0.3917202164538767, 'recall': 0.4740059597651904, 'f1-score': 0.42895253085812496, 'support': 469146}, '1': {'precision': 0.42895285154157986, 'recall': 0.2390246452641622, 'f1-score': 0.3069872972220629, 'support': 459074}, '2': {'precision': 0.3832085011748909, 'recall': 0.46908848097283484, 'f1-score': 0.4218217299303998, 'support': 467253}, 'accuracy': 0.39505672986865387, 'macro avg': {'precision': 0.40129385639011583, 'recall': 0.3940396953340624, 'f1-score': 0.3859205193368626, 'support': 1395473}, 'weighted avg': {'precision': 0.40111875746541925, 'recall': 0.39505672986865387, 'f1-score': 0.38644152864444975, 'support': 1395473}}
[[222378  72063 174705]
 [171264 109730 178080]
 [174054  74016 219183]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089784
{'0': {'precision': 0.377263660494118, 'recall': 0.4505805773884335, 'f1-score': 0.4106755116346664, 'support': 159927}, '1': {'precision': 0.4745013802134856, 'recall': 0.26757300947250423, 'f1-score': 0.3421860774801951, 'support': 188229}, '2': {'precision': 0.3648555907825549, 'recall': 0.4842212615293831, 'f1-score': 0.4161480411666455, 'support': 155906}, 'accuracy': 0.3926461427364094, 'macro avg': {'precision': 0.40554021049671957, 'recall': 0.4007916161301069, 'f1-score': 0.3896698767605023, 'support': 504062}, 'weighted avg': {'precision': 0.40973678131775854, 'recall': 0.3926461427364094, 'f1-score': 0.3867925418566446, 'support': 504062}}
[[72060 27973 59894]
 [66339 50365 71525]
 [52608 27805 75493]]
training model: results/universal/W6/deepOF_L2/h200
Epoch 1/50
9426/9426 - 206s - loss: 3.2083 - accuracy200: 0.4128 - val_loss: 3.3070 - val_accuracy200: 0.3632 - 206s/epoch - 22ms/step
Epoch 2/50
9426/9426 - 203s - loss: 3.1842 - accuracy200: 0.4238 - val_loss: 3.3409 - val_accuracy200: 0.3649 - 203s/epoch - 22ms/step
Epoch 3/50
9426/9426 - 204s - loss: 3.1747 - accuracy200: 0.4283 - val_loss: 3.3555 - val_accuracy200: 0.3658 - 204s/epoch - 22ms/step
Epoch 4/50
9426/9426 - 205s - loss: 3.1693 - accuracy200: 0.4309 - val_loss: 3.3773 - val_accuracy200: 0.3653 - 205s/epoch - 22ms/step
Epoch 5/50
9426/9426 - 204s - loss: 3.1650 - accuracy200: 0.4329 - val_loss: 3.3619 - val_accuracy200: 0.3660 - 204s/epoch - 22ms/step
Epoch 6/50
9426/9426 - 203s - loss: 3.1614 - accuracy200: 0.4342 - val_loss: 3.3502 - val_accuracy200: 0.3655 - 203s/epoch - 22ms/step
Epoch 7/50
9426/9426 - 204s - loss: 3.1582 - accuracy200: 0.4355 - val_loss: 3.3372 - val_accuracy200: 0.3691 - 204s/epoch - 22ms/step
Epoch 8/50
9426/9426 - 203s - loss: 3.1557 - accuracy200: 0.4366 - val_loss: 3.3332 - val_accuracy200: 0.3699 - 203s/epoch - 22ms/step
Epoch 9/50
9426/9426 - 204s - loss: 3.1538 - accuracy200: 0.4373 - val_loss: 3.3269 - val_accuracy200: 0.3743 - 204s/epoch - 22ms/step
Epoch 10/50
9426/9426 - 202s - loss: 3.1521 - accuracy200: 0.4383 - val_loss: 3.3226 - val_accuracy200: 0.3754 - 202s/epoch - 21ms/step
Epoch 11/50
9426/9426 - 203s - loss: 3.1502 - accuracy200: 0.4388 - val_loss: 3.3164 - val_accuracy200: 0.3789 - 203s/epoch - 22ms/step
testing model in sample: results/universal/W6/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 313s - 313s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979007
{'0': {'precision': 0.3769049810780403, 'recall': 0.011029694571744048, 'f1-score': 0.021432200237818905, 'support': 3340981}, '1': {'precision': 0.375868215425486, 'recall': 0.9673545701883491, 'f1-score': 0.5413812807146855, 'support': 4073924}, '2': {'precision': 0.3877905621596423, 'recall': 0.0268839870975665, 'f1-score': 0.050282113953375916, 'support': 3403699}, 'accuracy': 0.3761376236712241, 'macro avg': {'precision': 0.3801879195543895, 'recall': 0.33508941728588654, 'f1-score': 0.2043651983019601, 'support': 10818604}, 'weighted avg': {'precision': 0.37993934086859654, 'recall': 0.3761376236712241, 'f1-score': 0.22630423919925663, 'support': 10818604}}
[[  36850 3255140   48991]
 [  37526 3940929   95469]
 [  23394 3288800   91505]]
Evaluating performance on  train set...
9426/9426 - 75s - 75s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1173103
{'0': {'precision': 0.4112416964741952, 'recall': 0.009953079048323385, 'f1-score': 0.01943576393081563, 'support': 808594}, '1': {'precision': 0.33125206764149073, 'recall': 0.9694343219571429, 'f1-score': 0.4937810161756575, 'support': 800473}, '2': {'precision': 0.4264932466233117, 'recall': 0.026538898773911343, 'f1-score': 0.049968467866528817, 'support': 803123}, 'accuracy': 0.33387419730618234, 'macro avg': {'precision': 0.38966233691299923, 'recall': 0.33530876659312586, 'f1-score': 0.18772841599100065, 'support': 2412190}, 'weighted avg': {'precision': 0.38977544901848377, 'recall': 0.33387419730618234, 'f1-score': 0.18701049224125016, 'support': 2412190}}
[[  8048 789281  11265]
 [  7071 776006  17396]
 [  4451 777358  21314]]
Evaluating performance on  val set...
3323/3323 - 26s - 26s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026396
{'0': {'precision': 0.405736480430236, 'recall': 0.009985661237545499, 'f1-score': 0.019491610569677485, 'support': 271990}, '1': {'precision': 0.36198385314616766, 'recall': 0.9708174426719032, 'f1-score': 0.5273407817092243, 'support': 308095}, '2': {'precision': 0.40899901807890027, 'recall': 0.026205252893088046, 'f1-score': 0.04925467609885714, 'support': 270213}, 'accuracy': 0.36328557752693763, 'macro avg': {'precision': 0.3922397838851013, 'recall': 0.33566945226751227, 'f1-score': 0.19869568945925298, 'support': 850298}, 'weighted avg': {'precision': 0.3909200447601221, 'recall': 0.36328557752693763, 'f1-score': 0.21296279080069633, 'support': 850298}}
[[  2716 265510   3764]
 [  2523 299104   6468]
 [  1455 261677   7081]]
testing model out of sample: results/universal/W6/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 133s - 133s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062821
{'0': {'precision': 0.38692335479484075, 'recall': 0.012723236589035056, 'f1-score': 0.02463635367353483, 'support': 1431161}, '1': {'precision': 0.3539842939475948, 'recall': 0.9650682768417383, 'f1-score': 0.517976341738399, 'support': 1589558}, '2': {'precision': 0.4155647686253483, 'recall': 0.029638097267206547, 'f1-score': 0.0553300527778486, 'support': 1464399}, 'accuracy': 0.3557638840271315, 'macro avg': {'precision': 0.38549080578926126, 'recall': 0.33580987023265996, 'f1-score': 0.19931424939659415, 'support': 4485118}, 'weighted avg': {'precision': 0.3846009878225013, 'recall': 0.3557638840271315, 'f1-score': 0.20950113248717306, 'support': 4485118}}
[[  18209 1390116   22836]
 [  17323 1534032   38203]
 [  11529 1409468   43402]]
Evaluating performance on  train set...
5152/5152 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1190755
{'0': {'precision': 0.40705128205128205, 'recall': 0.008760199279514217, 'f1-score': 0.017151283732419063, 'support': 449419}, '1': {'precision': 0.32262675345316816, 'recall': 0.9647348604806644, 'f1-score': 0.4835459945537407, 'support': 426285}, '2': {'precision': 0.4252460644294518, 'recall': 0.03287379263319982, 'f1-score': 0.06102966603443397, 'support': 442906}, 'accuracy': 0.3259106179992568, 'macro avg': {'precision': 0.3849746999779673, 'recall': 0.33545628413112616, 'f1-score': 0.18724231477353123, 'support': 1318610}, 'weighted avg': {'precision': 0.3858696347943513, 'recall': 0.3259106179992568, 'f1-score': 0.1826672953615765, 'support': 1318610}}
[[  3937 437603   7879]
 [  3233 411252  11800]
 [  2502 425844  14560]]
Evaluating performance on  val set...
1795/1795 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114424
{'0': {'precision': 0.39574992300585154, 'recall': 0.00835576710493803, 'f1-score': 0.016365986767112647, 'support': 153786}, '1': {'precision': 0.3319755094663594, 'recall': 0.9609508861421752, 'f1-score': 0.4934730408207815, 'support': 152910}, '2': {'precision': 0.41921363845799414, 'recall': 0.035868929582832325, 'f1-score': 0.06608358805193233, 'support': 152193}, 'accuracy': 0.33490234021735105, 'macro avg': {'precision': 0.38231302364340164, 'recall': 0.33505852760998184, 'f1-score': 0.1919742052132755, 'support': 458889}, 'weighted avg': {'precision': 0.3822810180451403, 'recall': 0.33490234021735105, 'f1-score': 0.19183567666529514, 'support': 458889}}
[[  1285 149718   2783]
 [  1191 146939   4780]
 [   771 145963   5459]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1193792
{'0': {'precision': 0.27486559139784944, 'recall': 0.004984643884366011, 'f1-score': 0.009791716542973424, 'support': 82052}, '1': {'precision': 0.3516251693862306, 'recall': 0.9825875343529066, 'f1-score': 0.5179121848193577, 'support': 95334}, '2': {'precision': 0.3513087354146957, 'recall': 0.01189205346086511, 'f1-score': 0.023005358968269534, 'support': 93676}, 'accuracy': 0.35120009444333766, 'macro avg': {'precision': 0.3259331653995919, 'recall': 0.3331547438993792, 'f1-score': 0.18356975344353355, 'support': 271062}, 'weighted avg': {'precision': 0.3282802550794663, 'recall': 0.35120009444333766, 'f1-score': 0.1930669741980223, 'support': 271062}}
[[  409 80719   924]
 [  527 93674  1133]
 [  552 92010  1114]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1294057
{'0': {'precision': 0.36419753086419754, 'recall': 0.006392545641692399, 'f1-score': 0.012564553053292871, 'support': 18459}, '1': {'precision': 0.3228812277916383, 'recall': 0.9805981286952529, 'f1-score': 0.48580244280453294, 'support': 17421}, '2': {'precision': 0.3672627235213205, 'recall': 0.014768515957741025, 'f1-score': 0.028395193023503136, 'support': 18079}, 'accuracy': 0.3237272744120536, 'macro avg': {'precision': 0.3514471607257188, 'recall': 0.3339197300982288, 'f1-score': 0.17558739629377632, 'support': 53959}, 'weighted avg': {'precision': 0.35188529939625096, 'recall': 0.3237272744120536, 'f1-score': 0.1706564268348267, 'support': 53959}}
[[  118 18124   217]
 [   95 17083   243]
 [  111 17701   267]]
Evaluating performance on  val set...
81/81 - 1s - 801ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327701
{'0': {'precision': 0.3592233009708738, 'recall': 0.005252697331061896, 'f1-score': 0.010353994683083812, 'support': 7044}, '1': {'precision': 0.3142490498988204, 'recall': 0.9815014644673963, 'f1-score': 0.47607297741887245, 'support': 6487}, '2': {'precision': 0.3602941176470588, 'recall': 0.013793103448275862, 'f1-score': 0.026569066015995665, 'support': 7105}, 'accuracy': 0.31508044194611357, 'macro avg': {'precision': 0.34458882283891773, 'recall': 0.3335157550822447, 'f1-score': 0.17099867937265065, 'support': 20636}, 'weighted avg': {'precision': 0.34545416866712714, 'recall': 0.31508044194611357, 'f1-score': 0.16233728227890665, 'support': 20636}}
[[  37 6922   85]
 [  31 6367   89]
 [  35 6972   98]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1302761
{'0': {'precision': 0.4632790028763183, 'recall': 0.01204765205423438, 'f1-score': 0.023484583381935535, 'support': 200537}, '1': {'precision': 0.27152739126977815, 'recall': 0.9676388412978729, 'f1-score': 0.4240600548394595, 'support': 151756}, '2': {'precision': 0.5359860012172855, 'recall': 0.03405405144119453, 'f1-score': 0.06403934169920145, 'support': 206877}, 'accuracy': 0.2795321637426901, 'macro avg': {'precision': 0.42359746512112734, 'recall': 0.3379135149311006, 'f1-score': 0.17052799330686552, 'support': 559170}, 'weighted avg': {'precision': 0.4381380763688557, 'recall': 0.2795321637426901, 'f1-score': 0.14720291230320998, 'support': 559170}}
[[  2416 195542   2579]
 [  1391 146845   3520]
 [  1408 198424   7045]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.095434
{'0': {'precision': 0.4588235294117647, 'recall': 0.010143922316629096, 'f1-score': 0.019849011790652304, 'support': 46136}, '1': {'precision': 0.3434406924702194, 'recall': 0.972112663980108, 'f1-score': 0.5075629123507983, 'support': 46652}, '2': {'precision': 0.5115552779512804, 'recall': 0.03766989398155601, 'f1-score': 0.0701724322587555, 'support': 43483}, 'accuracy': 0.3482545809453222, 'macro avg': {'precision': 0.4379398332777549, 'recall': 0.3399754934260977, 'f1-score': 0.19919478546673539, 'support': 136271}, 'weighted avg': {'precision': 0.43614881881851153, 'recall': 0.3482545809453222, 'f1-score': 0.2028743229804613, 'support': 136271}}
[[  468 45066   602]
 [  339 45351   962]
 [  213 41632  1638]]
Evaluating performance on  val set...
189/189 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092705
{'0': {'precision': 0.4881889763779528, 'recall': 0.011165135962542769, 'f1-score': 0.021830985915492956, 'support': 16659}, '1': {'precision': 0.35127406205984035, 'recall': 0.9763331158431698, 'f1-score': 0.5166596041872656, 'support': 16859}, '2': {'precision': 0.5051975051975052, 'recall': 0.03309950282639788, 'f1-score': 0.06212847555129435, 'support': 14683}, 'accuracy': 0.3554283106159623, 'macro avg': {'precision': 0.4482201812117661, 'recall': 0.34019925154403685, 'f1-score': 0.20020635521801763, 'support': 48201}, 'weighted avg': {'precision': 0.44548213810008364, 'recall': 0.3554283106159623, 'f1-score': 0.20717991468805552, 'support': 48201}}
[[  186 16280   193]
 [  116 16460   283]
 [   79 14118   486]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1623571
{'0': {'precision': 0.404551201011378, 'recall': 0.008175709626046449, 'f1-score': 0.01602751389885971, 'support': 117421}, '1': {'precision': 0.24722396815420072, 'recall': 0.9834229682392926, 'f1-score': 0.39511856957869546, 'support': 76793}, '2': {'precision': 0.41201264488935724, 'recall': 0.010070571266676969, 'f1-score': 0.01966059082338152, 'support': 116478}, 'accuracy': 0.24993562756685078, 'macro avg': {'precision': 0.35459593801831196, 'recall': 0.33388974971067203, 'f1-score': 0.1436022247669789, 'support': 310692}, 'weighted avg': {'precision': 0.3684622893793374, 'recall': 0.24993562756685078, 'f1-score': 0.11108858072013633, 'support': 310692}}
[[   960 115459   1002]
 [   601  75520    672]
 [   812 114493   1173]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1268125
{'0': {'precision': 0.34827144686299616, 'recall': 0.00603398553618173, 'f1-score': 0.011862447938245492, 'support': 45078}, '1': {'precision': 0.32797532571455207, 'recall': 0.9809689787382363, 'f1-score': 0.49159252876240156, 'support': 43035}, '2': {'precision': 0.3399452804377565, 'recall': 0.011599411860807058, 'f1-score': 0.02243336568191564, 'support': 42847}, 'accuracy': 0.3282299938912645, 'macro avg': {'precision': 0.33873068433843495, 'recall': 0.33286745871174167, 'f1-score': 0.1752961141275209, 'support': 130960}, 'weighted avg': {'precision': 0.3388777783653974, 'recall': 0.3282299938912645, 'f1-score': 0.1729659615365243, 'support': 130960}}
[[  272 44390   416]
 [  270 42216   549]
 [  239 42111   497]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1419519
{'0': {'precision': 0.40562248995983935, 'recall': 0.006682545983856028, 'f1-score': 0.013148473605415609, 'support': 15114}, '1': {'precision': 0.29335321687260335, 'recall': 0.9752892106712835, 'f1-score': 0.45103997961894715, 'support': 12707}, '2': {'precision': 0.34715821812596004, 'recall': 0.014747145187601958, 'f1-score': 0.028292438657986984, 'support': 15325}, 'accuracy': 0.29481296064525103, 'macro avg': {'precision': 0.34871130831946756, 'recall': 0.3322396339475805, 'f1-score': 0.16416029729411658, 'support': 43146}, 'weighted avg': {'precision': 0.35179199306618275, 'recall': 0.29481296064525103, 'f1-score': 0.14749160231594732, 'support': 43146}}
[[  101 14834   179]
 [   68 12393   246]
 [   80 15019   226]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1636853
{'0': {'precision': 0.32634032634032634, 'recall': 0.0014196047414798366, 'f1-score': 0.00282691220418383, 'support': 98619}, '1': {'precision': 0.2620317563775279, 'recall': 0.9870016503675819, 'f1-score': 0.4141214712059562, 'support': 73317}, '2': {'precision': 0.37335243553008596, 'recall': 0.012048304175759144, 'f1-score': 0.0233433060427453, 'support': 108148}, 'accuracy': 0.26351737335942077, 'macro avg': {'precision': 0.32057483941598003, 'recall': 0.33348985309494034, 'f1-score': 0.14676389648429514, 'support': 280084}, 'weighted avg': {'precision': 0.3276590527248811, 'recall': 0.26351737335942077, 'f1-score': 0.1184125584502589, 'support': 280084}}
[[   140  97132   1347]
 [   113  72364    840]
 [   176 106669   1303]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297736
{'0': {'precision': 0.2925170068027211, 'recall': 0.0011360033815914616, 'f1-score': 0.002263217453090871, 'support': 37852}, '1': {'precision': 0.3303456423831647, 'recall': 0.9824579942935644, 'f1-score': 0.49443908924713315, 'support': 37852}, '2': {'precision': 0.3494302767227347, 'recall': 0.016572737332406908, 'f1-score': 0.031644636627192774, 'support': 38859}, 'accuracy': 0.330604121749605, 'macro avg': {'precision': 0.3240976419695401, 'recall': 0.33338891166918755, 'f1-score': 0.1761156477758056, 'support': 114563}, 'weighted avg': {'precision': 0.3243203138897628, 'recall': 0.330604121749605, 'f1-score': 0.17484575864732038, 'support': 114563}}
[[   43 37222   587]
 [   52 37188   612]
 [   52 38163   644]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1460856
{'0': {'precision': 0.3404255319148936, 'recall': 0.0013706844855649791, 'f1-score': 0.0027303754266211604, 'support': 11673}, '1': {'precision': 0.2967074702737445, 'recall': 0.9862109147407263, 'f1-score': 0.4561726592853774, 'support': 10298}, '2': {'precision': 0.32796780684104626, 'recall': 0.012732385564755507, 'f1-score': 0.024513121287314834, 'support': 12802}, 'accuracy': 0.2972133551893711, 'macro avg': {'precision': 0.32170026967656146, 'recall': 0.3334379949303489, 'f1-score': 0.16113871866643778, 'support': 34773}, 'weighted avg': {'precision': 0.32289203192421273, 'recall': 0.2972133551893711, 'f1-score': 0.1450365138583375, 'support': 34773}}
[[   16 11457   200]
 [    8 10156   134]
 [   23 12616   163]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1469424
{'0': {'precision': 0.3467874794069193, 'recall': 0.005510651526555188, 'f1-score': 0.010848907700534071, 'support': 152795}, '1': {'precision': 0.2895285745133443, 'recall': 0.9874412409902852, 'f1-score': 0.4477669737351632, 'support': 127640}, '2': {'precision': 0.4019028871391076, 'recall': 0.007639109747504038, 'f1-score': 0.014993237743793105, 'support': 160359}, 'accuracy': 0.29062101571255505, 'macro avg': {'precision': 0.3460729803531237, 'recall': 0.33353033408811483, 'f1-score': 0.15786970639316347, 'support': 440794}, 'weighted avg': {'precision': 0.35025786477493714, 'recall': 0.29062101571255505, 'f1-score': 0.13887424962911532, 'support': 440794}}
[[   842 150940   1013]
 [   793 126037    810]
 [   793 158341   1225]]
Evaluating performance on  train set...
617/617 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293042
{'0': {'precision': 0.3324607329842932, 'recall': 0.004774166870289269, 'f1-score': 0.009413159894009301, 'support': 53203}, '1': {'precision': 0.3272166915974622, 'recall': 0.9732663393679043, 'f1-score': 0.4897703146110789, 'support': 52144}, '2': {'precision': 0.23518164435946462, 'recall': 0.009352723125178215, 'f1-score': 0.017990017734062197, 'support': 52605}, 'accuracy': 0.326023095623987, 'macro avg': {'precision': 0.29828635631374, 'recall': 0.32913107645445727, 'f1-score': 0.1723911640797168, 'support': 157952}, 'weighted avg': {'precision': 0.2983313028334624, 'recall': 0.326023095623987, 'f1-score': 0.17084783044102905, 'support': 157952}}
[[  254 52468   481]
 [  275 50750  1119]
 [  235 51878   492]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1279345
{'0': {'precision': 0.34347826086956523, 'recall': 0.004150903741067675, 'f1-score': 0.008202678849548332, 'support': 19032}, '1': {'precision': 0.3308956014838368, 'recall': 0.985479797979798, 'f1-score': 0.4954375942235975, 'support': 19008}, '2': {'precision': 0.3586776859504132, 'recall': 0.011182684875032208, 'f1-score': 0.021689155422288855, 'support': 19405}, 'accuracy': 0.3312385760292454, 'macro avg': {'precision': 0.3443505161012717, 'recall': 0.33360446219863266, 'f1-score': 0.17510980949847824, 'support': 57445}, 'weighted avg': {'precision': 0.3444491661544452, 'recall': 0.3312385760292454, 'f1-score': 0.17397979346916634, 'support': 57445}}
[[   79 18765   188]
 [   76 18732   200]
 [   75 19113   217]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/EXC
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974846
{'0': {'precision': 0.4777297249097151, 'recall': 0.028167125822800784, 'f1-score': 0.0531976953457602, 'support': 380408}, '1': {'precision': 0.3351642765562076, 'recall': 0.9209382088880497, 'f1-score': 0.4914656122597579, 'support': 386609}, '2': {'precision': 0.4015222547018918, 'recall': 0.058694057226705794, 'f1-score': 0.10241692692946175, 'support': 372099}, 'accuracy': 0.3411399716973513, 'macro avg': {'precision': 0.40480541872260484, 'recall': 0.3359331306458521, 'f1-score': 0.2156934115116599, 'support': 1139116}, 'weighted avg': {'precision': 0.40445026181784205, 'recall': 0.3411399716973513, 'f1-score': 0.21802089855181425, 'support': 1139116}}
[[ 10715 360817   8876]
 [  6889 356043  23677]
 [  4825 345434  21840]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041048
{'0': {'precision': 0.47654628476546285, 'recall': 0.026616586677795553, 'f1-score': 0.05041721563460694, 'support': 129393}, '1': {'precision': 0.3263827925344392, 'recall': 0.9327551052916627, 'f1-score': 0.48356135819826296, 'support': 125556}, '2': {'precision': 0.48726691529035693, 'recall': 0.07042481269587045, 'f1-score': 0.12306326065164594, 'support': 129869}, 'accuracy': 0.33705024193254995, 'macro avg': {'precision': 0.4300653308634197, 'recall': 0.3432655015551096, 'f1-score': 0.21901394482817196, 'support': 384818}, 'weighted avg': {'precision': 0.43116989939648076, 'recall': 0.33705024193254995, 'f1-score': 0.21625747046686591, 'support': 384818}}
[[  3444 122406   3543]
 [  2362 117113   6081]
 [  1421 119302   9146]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895036
{'0': {'precision': 0.4691923397169026, 'recall': 0.028198263567443142, 'f1-score': 0.0531992730534117, 'support': 39967}, '1': {'precision': 0.35934805813285164, 'recall': 0.9313089183495414, 'f1-score': 0.5185948821860022, 'support': 46993}, '2': {'precision': 0.4513372369045735, 'recall': 0.06548644118389933, 'f1-score': 0.11437738119109683, 'support': 43551}, 'accuracy': 0.3658235704270138, 'macro avg': {'precision': 0.42662587825144255, 'recall': 0.3416645410336279, 'f1-score': 0.2287238454768369, 'support': 130511}, 'weighted avg': {'precision': 0.4236826132795981, 'recall': 0.3658235704270138, 'f1-score': 0.24118881912594317, 'support': 130511}}
[[ 1127 37785  1055]
 [  816 43765  2412]
 [  459 40240  2852]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/AAL
Evaluating performance on  test set...
6203/6203 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978694
{'0': {'precision': 0.4250841351850974, 'recall': 0.017965751284126513, 'f1-score': 0.034474473781832084, 'support': 499172}, '1': {'precision': 0.35565283515218776, 'recall': 0.9499099590433171, 'f1-score': 0.5175364548914433, 'support': 564743}, '2': {'precision': 0.44991011043575035, 'recall': 0.050151349164239606, 'f1-score': 0.09024330352926631, 'support': 523954}, 'accuracy': 0.36004229568056306, 'macro avg': {'precision': 0.4102156935910119, 'recall': 0.3393423531638944, 'f1-score': 0.2140847440675139, 'support': 1587869}, 'weighted avg': {'precision': 0.4085820360585291, 'recall': 0.36004229568056306, 'f1-score': 0.22468296945702462, 'support': 1587869}}
[[  8968 478638  11566]
 [  7726 536455  20562]
 [  4403 493274  26277]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1149926
{'0': {'precision': 0.4684361549497848, 'recall': 0.00827163386936392, 'f1-score': 0.016256215886530118, 'support': 157889}, '1': {'precision': 0.31308953623343483, 'recall': 0.9491823047792328, 'f1-score': 0.4708637837724377, 'support': 141801}, '2': {'precision': 0.4520923969339134, 'recall': 0.057314887162752216, 'f1-score': 0.10173244681161026, 'support': 152299}, 'accuracy': 0.31998566336791384, 'macro avg': {'precision': 0.41120602937237766, 'recall': 0.33825627527044966, 'f1-score': 0.196284148823526, 'support': 451989}, 'weighted avg': {'precision': 0.41419270238200917, 'recall': 0.31998566336791384, 'f1-score': 0.18768019352193355, 'support': 451989}}
[[  1306 152318   4265]
 [   892 134595   6314]
 [   590 142980   8729]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000906
{'0': {'precision': 0.42934293429342935, 'recall': 0.009631304769212132, 'f1-score': 0.018839978671722258, 'support': 49526}, '1': {'precision': 0.3397119223367895, 'recall': 0.9332110381284888, 'f1-score': 0.49810228199931567, 'support': 50697}, '2': {'precision': 0.4349408553230209, 'recall': 0.06992831616125729, 'f1-score': 0.12048539843721867, 'support': 47849}, 'accuracy': 0.34533200064833325, 'macro avg': {'precision': 0.40133190398441326, 'recall': 0.3375902196863194, 'f1-score': 0.21247588636941886, 'support': 148072}, 'weighted avg': {'precision': 0.4004639531908519, 'recall': 0.34533200064833325, 'f1-score': 0.21577655467635673, 'support': 148072}}
[[  477 47639  1410]
 [  449 47311  2937]
 [  185 44318  3346]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/WBA
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265931
{'0': {'precision': 0.4197284934336727, 'recall': 0.012686172762972164, 'f1-score': 0.024627972164200908, 'support': 448441}, '1': {'precision': 0.29568067851076957, 'recall': 0.9687328174320334, 'f1-score': 0.453072634344786, 'support': 392840}, '2': {'precision': 0.46928737560529227, 'recall': 0.025348364960436943, 'f1-score': 0.04809869846672697, 'support': 485554}, 'accuracy': 0.3003794744636673, 'macro avg': {'precision': 0.3948988491832448, 'recall': 0.33558911838514754, 'f1-score': 0.17526643499190464, 'support': 1326835}, 'weighted avg': {'precision': 0.4011373120581778, 'recall': 0.3003794744636673, 'f1-score': 0.1600679523652943, 'support': 1326835}}
[[  5689 437281   5471]
 [  3835 380557   8448]
 [  4030 469216  12308]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.113364
{'0': {'precision': 0.427158273381295, 'recall': 0.010990706104662374, 'f1-score': 0.021430021580407698, 'support': 129655}, '1': {'precision': 0.329225765847044, 'recall': 0.9714579480966652, 'f1-score': 0.4917859484541282, 'support': 125464}, '2': {'precision': 0.42764032987496675, 'recall': 0.025526813078620997, 'f1-score': 0.048177785769945455, 'support': 125946}, 'accuracy': 0.3320247201920932, 'macro avg': {'precision': 0.39467478970110187, 'recall': 0.33599182242664954, 'f1-score': 0.18713125193482713, 'support': 381065}, 'weighted avg': {'precision': 0.3950737443950976, 'recall': 0.3320247201920932, 'f1-score': 0.1851330903951768, 'support': 381065}}
[[  1425 126409   1821]
 [  1099 121883   2482]
 [   812 121919   3215]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089388
{'0': {'precision': 0.424812030075188, 'recall': 0.012734977234819457, 'f1-score': 0.024728641456582632, 'support': 44366}, '1': {'precision': 0.3333255716481162, 'recall': 0.9718042135276413, 'f1-score': 0.49639077842442597, 'support': 44191}, '2': {'precision': 0.45954316686024005, 'recall': 0.02685884961759515, 'f1-score': 0.05075143767236035, 'support': 44194}, 'accuracy': 0.3366980286400856, 'macro avg': {'precision': 0.4058935895278481, 'recall': 0.33713268012668535, 'f1-score': 0.19062361918445633, 'support': 132751}, 'weighted avg': {'precision': 0.4059197413144846, 'recall': 0.3366980286400856, 'f1-score': 0.1904017659581385, 'support': 132751}}
[[  565 43193   608]
 [  458 42945   788]
 [  307 42700  1187]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926805
{'0': {'precision': 0.3530074802746183, 'recall': 0.011885027452860944, 'f1-score': 0.022995833048249526, 'support': 579721}, '1': {'precision': 0.3862613863433163, 'recall': 0.9688530966225685, 'f1-score': 0.5523231357477413, 'support': 725048}, '2': {'precision': 0.3688212927756654, 'recall': 0.02365720822835005, 'f1-score': 0.04446247170187753, 'support': 569932}, 'accuracy': 0.38557508637377375, 'macro avg': {'precision': 0.3693633864645333, 'recall': 0.33479844410125986, 'f1-score': 0.20659381349928943, 'support': 1874701}, 'weighted avg': {'precision': 0.37067615163802187, 'recall': 0.38557508637377375, 'f1-score': 0.23424137378717302, 'support': 1874701}}
[[  6890 564534   8297]
 [  7806 702465  14777]
 [  4822 551627  13483]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164234
{'0': {'precision': 0.38256119765324703, 'recall': 0.010818696721780423, 'f1-score': 0.021042323891550245, 'support': 174790}, '1': {'precision': 0.32800607630006845, 'recall': 0.9698052174722487, 'f1-score': 0.4902130312547788, 'support': 171884}, '2': {'precision': 0.42752051306234085, 'recall': 0.025599177754184643, 'f1-score': 0.04830588398275779, 'support': 177076}, 'accuracy': 0.33053556085918856, 'macro avg': {'precision': 0.3793625956718854, 'recall': 0.3354076973160713, 'f1-score': 0.18652041304302894, 'support': 523750}, 'weighted avg': {'precision': 0.37985773847751614, 'recall': 0.33053556085918856, 'f1-score': 0.18423212824693325, 'support': 523750}}
[[  1891 170380   2519]
 [  1639 166694   3551]
 [  1413 171130   4533]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130059
{'0': {'precision': 0.3836477987421384, 'recall': 0.009671793245600127, 'f1-score': 0.018867924528301886, 'support': 63070}, '1': {'precision': 0.33747287326388886, 'recall': 0.9717548546343597, 'f1-score': 0.5009684654755144, 'support': 64011}, '2': {'precision': 0.4043478260869565, 'recall': 0.023804572141611607, 'f1-score': 0.04496215383220777, 'support': 62509}, 'accuracy': 0.33915818344849413, 'macro avg': {'precision': 0.3751561660309946, 'recall': 0.3350770733405238, 'f1-score': 0.1882661812786747, 'support': 189590}, 'weighted avg': {'precision': 0.3748827523499711, 'recall': 0.33915818344849413, 'f1-score': 0.1902422686716105, 'support': 189590}}
[[  610 61522   938]
 [  554 62203  1254]
 [  426 60595  1488]]
testing model on single stock: results/universal/W6/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 219s - 219s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0880709
{'0': {'precision': 0.3196074964639321, 'recall': 0.008168638069278655, 'f1-score': 0.015930128449163177, 'support': 2212976}, '1': {'precision': 0.4078510426546825, 'recall': 0.972377029792774, 'f1-score': 0.5746658735193109, 'support': 3069402}, '2': {'precision': 0.3516396510523134, 'recall': 0.021897597557351545, 'f1-score': 0.04122782181756347, 'support': 2231021}, 'accuracy': 0.40614733757650834, 'macro avg': {'precision': 0.35969939672364265, 'recall': 0.3341477551398014, 'f1-score': 0.21060794126201252, 'support': 7513399}, 'weighted avg': {'precision': 0.36516867679348824, 'recall': 0.40614733757650834, 'f1-score': 0.2516988262843591, 'support': 7513399}}
[[  18077 2164152   30747]
 [  25455 2984616   59331]
 [  13028 2169139   48854]]
Evaluating performance on  train set...
5452/5452 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1231347
{'0': {'precision': 0.332059123343527, 'recall': 0.0055975839744994175, 'f1-score': 0.01100957740290575, 'support': 465558}, '1': {'precision': 0.3320557211313698, 'recall': 0.9776792723503008, 'f1-score': 0.4957399740117966, 'support': 464949}, '2': {'precision': 0.3595499598178409, 'recall': 0.01443331340356069, 'f1-score': 0.02775256342128606, 'support': 464966}, 'accuracy': 0.3324234865167581, 'macro avg': {'precision': 0.34122160143091257, 'recall': 0.3325700565761203, 'f1-score': 0.17816737161199614, 'support': 1395473}, 'weighted avg': {'precision': 0.3412178261037922, 'recall': 0.3324234865167581, 'f1-score': 0.17809258969331151, 'support': 1395473}}
[[  2606 458239   4713]
 [  3137 454571   7241]
 [  2105 456150   6711]]
Evaluating performance on  val set...
1969/1969 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1025563
{'0': {'precision': 0.30666666666666664, 'recall': 0.004763847481562843, 'f1-score': 0.009381953028430161, 'support': 159325}, '1': {'precision': 0.37566826274929105, 'recall': 0.9794945034096778, 'f1-score': 0.5430565355796215, 'support': 189754}, '2': {'precision': 0.35455077553409425, 'recall': 0.015633972758302524, 'f1-score': 0.0299474097282733, 'support': 154983}, 'accuracy': 0.37504314945383704, 'macro avg': {'precision': 0.345628568316684, 'recall': 0.3332974412165144, 'f1-score': 0.19412863277877498, 'support': 504062}, 'weighted avg': {'precision': 0.34736513571940786, 'recall': 0.37504314945383704, 'f1-score': 0.21660682400289472, 'support': 504062}}
[[   759 156917   1649]
 [  1129 185863   2762]
 [   587 151973   2423]]
training model: results/universal/W6/deepVOL_L2/h50
Epoch 1/50
9426/9426 - 298s - loss: 3.0403 - accuracy50: 0.4712 - val_loss: 3.2767 - val_accuracy50: 0.4427 - 298s/epoch - 32ms/step
Epoch 2/50
9426/9426 - 294s - loss: 2.9862 - accuracy50: 0.4896 - val_loss: 3.2583 - val_accuracy50: 0.4509 - 294s/epoch - 31ms/step
Epoch 3/50
9426/9426 - 294s - loss: 2.9680 - accuracy50: 0.4954 - val_loss: 3.2919 - val_accuracy50: 0.4526 - 294s/epoch - 31ms/step
Epoch 4/50
9426/9426 - 295s - loss: 2.9534 - accuracy50: 0.5002 - val_loss: 3.2963 - val_accuracy50: 0.4535 - 295s/epoch - 31ms/step
Epoch 5/50
9426/9426 - 291s - loss: 2.9408 - accuracy50: 0.5038 - val_loss: 3.2903 - val_accuracy50: 0.4550 - 291s/epoch - 31ms/step
Epoch 6/50
9426/9426 - 293s - loss: 2.9308 - accuracy50: 0.5062 - val_loss: 3.2737 - val_accuracy50: 0.4585 - 293s/epoch - 31ms/step
Epoch 7/50
9426/9426 - 295s - loss: 2.9216 - accuracy50: 0.5091 - val_loss: 3.2572 - val_accuracy50: 0.4598 - 295s/epoch - 31ms/step
Epoch 8/50
9426/9426 - 295s - loss: 2.9158 - accuracy50: 0.5105 - val_loss: 3.2457 - val_accuracy50: 0.4607 - 295s/epoch - 31ms/step
Epoch 9/50
9426/9426 - 302s - loss: 2.9109 - accuracy50: 0.5121 - val_loss: 3.2421 - val_accuracy50: 0.4613 - 302s/epoch - 32ms/step
Epoch 10/50
9426/9426 - 293s - loss: 2.9068 - accuracy50: 0.5132 - val_loss: 3.2375 - val_accuracy50: 0.4625 - 293s/epoch - 31ms/step
Epoch 11/50
9426/9426 - 293s - loss: 2.9027 - accuracy50: 0.5145 - val_loss: 3.2281 - val_accuracy50: 0.4652 - 293s/epoch - 31ms/step
Epoch 12/50
9426/9426 - 293s - loss: 2.8995 - accuracy50: 0.5153 - val_loss: 3.2197 - val_accuracy50: 0.4647 - 293s/epoch - 31ms/step
Epoch 13/50
9426/9426 - 297s - loss: 2.8966 - accuracy50: 0.5162 - val_loss: 3.2229 - val_accuracy50: 0.4648 - 297s/epoch - 31ms/step
Epoch 14/50
9426/9426 - 294s - loss: 2.8939 - accuracy50: 0.5170 - val_loss: 3.2136 - val_accuracy50: 0.4651 - 294s/epoch - 31ms/step
Epoch 15/50
9426/9426 - 294s - loss: 2.8918 - accuracy50: 0.5173 - val_loss: 3.1980 - val_accuracy50: 0.4653 - 294s/epoch - 31ms/step
Epoch 16/50
9426/9426 - 294s - loss: 2.8899 - accuracy50: 0.5180 - val_loss: 3.2046 - val_accuracy50: 0.4669 - 294s/epoch - 31ms/step
Epoch 17/50
9426/9426 - 296s - loss: 2.8875 - accuracy50: 0.5188 - val_loss: 3.1955 - val_accuracy50: 0.4657 - 296s/epoch - 31ms/step
Epoch 18/50
9426/9426 - 299s - loss: 2.8860 - accuracy50: 0.5191 - val_loss: 3.1839 - val_accuracy50: 0.4666 - 299s/epoch - 32ms/step
Epoch 19/50
9426/9426 - 296s - loss: 2.8839 - accuracy50: 0.5196 - val_loss: 3.1850 - val_accuracy50: 0.4641 - 296s/epoch - 31ms/step
Epoch 20/50
9426/9426 - 297s - loss: 2.8821 - accuracy50: 0.5200 - val_loss: 3.1924 - val_accuracy50: 0.4649 - 297s/epoch - 32ms/step
Epoch 21/50
9426/9426 - 295s - loss: 2.8807 - accuracy50: 0.5205 - val_loss: 3.1907 - val_accuracy50: 0.4664 - 295s/epoch - 31ms/step
Epoch 22/50
9426/9426 - 296s - loss: 2.8792 - accuracy50: 0.5208 - val_loss: 3.1909 - val_accuracy50: 0.4664 - 296s/epoch - 31ms/step
Epoch 23/50
9426/9426 - 298s - loss: 2.8776 - accuracy50: 0.5211 - val_loss: 3.1850 - val_accuracy50: 0.4656 - 298s/epoch - 32ms/step
Epoch 24/50
9426/9426 - 298s - loss: 2.8760 - accuracy50: 0.5216 - val_loss: 3.1920 - val_accuracy50: 0.4665 - 298s/epoch - 32ms/step
Epoch 25/50
9426/9426 - 295s - loss: 2.8743 - accuracy50: 0.5224 - val_loss: 3.1968 - val_accuracy50: 0.4672 - 295s/epoch - 31ms/step
Epoch 26/50
9426/9426 - 296s - loss: 2.8734 - accuracy50: 0.5223 - val_loss: 3.2055 - val_accuracy50: 0.4659 - 296s/epoch - 31ms/step
Epoch 27/50
9426/9426 - 296s - loss: 2.8719 - accuracy50: 0.5229 - val_loss: 3.1973 - val_accuracy50: 0.4676 - 296s/epoch - 31ms/step
Epoch 28/50
9426/9426 - 298s - loss: 2.8703 - accuracy50: 0.5230 - val_loss: 3.1942 - val_accuracy50: 0.4672 - 298s/epoch - 32ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 650s - 650s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1344489
{'0': {'precision': 0.3892702479231867, 'recall': 0.3799210517963936, 'f1-score': 0.3845388320901085, 'support': 3245419}, '1': {'precision': 0.46566205889196177, 'recall': 0.4096504767816456, 'f1-score': 0.4358641666143036, 'support': 4343288}, '2': {'precision': 0.38304699768555683, 'recall': 0.4542471923470598, 'f1-score': 0.4156198031873525, 'support': 3229922}, 'accuracy': 0.41404654878173563, 'macro avg': {'precision': 0.41265976816690175, 'recall': 0.41460624030836635, 'f1-score': 0.4120076006305882, 'support': 10818629}, 'weighted avg': {'precision': 0.41808083224259757, 'recall': 0.41404654878173563, 'f1-score': 0.4144233786313824, 'support': 10818629}}
[[1233003 1094699  917717]
 [1118663 1779230 1445395]
 [ 815807  946932 1467183]]
Evaluating performance on  train set...
9426/9426 - 148s - 148s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0609016
{'0': {'precision': 0.4402804880247535, 'recall': 0.4146421424951542, 'f1-score': 0.4270768800268525, 'support': 765612}, '1': {'precision': 0.5237056884208436, 'recall': 0.4890521512415401, 'f1-score': 0.5057860497530705, 'support': 884466}, '2': {'precision': 0.4312800426245537, 'recall': 0.48962828737169034, 'f1-score': 0.45860570866746553, 'support': 762121}, 'accuracy': 0.46561705729916975, 'macro avg': {'precision': 0.46508873969005027, 'recall': 0.4644408603694616, 'f1-score': 0.4638228794824628, 'support': 2412199}, 'weighted avg': {'precision': 0.4680258460340565, 'recall': 0.46561705729916975, 'f1-score': 0.4658980415162163, 'support': 2412199}}
[[317455 216959 231198]
 [191041 432550 260875]
 [212533 176432 373156]]
Evaluating performance on  val set...
3323/3323 - 51s - 51s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0664229
{'0': {'precision': 0.4408403600067146, 'recall': 0.39089514300762557, 'f1-score': 0.4143681613778288, 'support': 262014}, '1': {'precision': 0.5293537557041416, 'recall': 0.5106460975417634, 'f1-score': 0.5198316686790555, 'support': 330074}, '2': {'precision': 0.4190370639898786, 'recall': 0.48614128645730464, 'f1-score': 0.45010183299389, 'support': 258213}, 'accuracy': 0.4663042851884215, 'macro avg': {'precision': 0.46307705990024495, 'recall': 0.46256084233556455, 'f1-score': 0.46143388768359145, 'support': 850301}, 'weighted avg': {'precision': 0.4685788621336523, 'recall': 0.4663042851884215, 'f1-score': 0.46615883345506154, 'support': 850301}}
[[102420  81328  78266]
 [ 65754 168551  95769]
 [ 64155  68530 125528]]
testing model out of sample: results/universal/W6/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 267s - 267s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0191094
{'0': {'precision': 0.48424622177256255, 'recall': 0.3355952496173383, 'f1-score': 0.39644428183538205, 'support': 1394835}, '1': {'precision': 0.5049975722273461, 'recall': 0.6724289855415064, 'f1-score': 0.5768088089285682, 'support': 1692085}, '2': {'precision': 0.4740388749099093, 'recall': 0.42900524451392946, 'f1-score': 0.4503991755565275, 'support': 1398223}, 'accuracy': 0.4917907857118491, 'macro avg': {'precision': 0.48776088963660597, 'recall': 0.47900982655759133, 'f1-score': 0.4745507554401593, 'support': 4485143}, 'weighted avg': {'precision': 0.4888928744393655, 'recall': 0.4917907857118491, 'f1-score': 0.4813095992154377, 'support': 4485143}}
[[ 468100  594786  331949]
 [ 220680 1137807  333598]
 [ 277877  520501  599845]]
Evaluating performance on  train set...
5153/5153 - 82s - 82s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0183444
{'0': {'precision': 0.48273453921894016, 'recall': 0.34562565595358324, 'f1-score': 0.4028330736829958, 'support': 403992}, '1': {'precision': 0.5182398434588148, 'recall': 0.65110502789154, 'f1-score': 0.5771241247932234, 'support': 512521}, '2': {'precision': 0.45900473995127733, 'recall': 0.4399928376382112, 'f1-score': 0.44929775798077326, 'support': 402102}, 'accuracy': 0.4931363589827205, 'macro avg': {'precision': 0.4866597075430108, 'recall': 0.47890784049444485, 'f1-score': 0.4764183188189975, 'support': 1318615}, 'weighted avg': {'precision': 0.4892985585037193, 'recall': 0.4931363589827205, 'f1-score': 0.48474581264893346, 'support': 1318615}}
[[139630 165098  99264]
 [ 69555 333705 109261]
 [ 80063 145117 176922]]
Evaluating performance on  val set...
1795/1795 - 28s - 28s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0106525
{'0': {'precision': 0.47999476855903983, 'recall': 0.3456166784984715, 'f1-score': 0.40186990671523926, 'support': 138046}, '1': {'precision': 0.5358092062495301, 'recall': 0.6570821176394026, 'f1-score': 0.590281177912078, 'support': 184394}, '2': {'precision': 0.4532257580756426, 'recall': 0.44296895611643655, 'f1-score': 0.4480386633854182, 'support': 136452}, 'accuracy': 0.4997188881043906, 'macro avg': {'precision': 0.48967657762807076, 'recall': 0.4818892507514369, 'f1-score': 0.4800632493375785, 'support': 458892}, 'weighted avg': {'precision': 0.4944625788608532, 'recall': 0.4997188881043906, 'f1-score': 0.49130647812251843, 'support': 458892}}
[[ 47711  56577  33758]
 [ 24070 121162  39162]
 [ 27618  48390  60444]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1309205
{'0': {'precision': 0.39425101727386436, 'recall': 0.5455192735318926, 'f1-score': 0.4577108483564558, 'support': 91291}, '1': {'precision': 0.4132572708501032, 'recall': 0.14500264020728698, 'f1-score': 0.2146791993164009, 'support': 81433}, '2': {'precision': 0.4242012119542763, 'recall': 0.5011236183561616, 'f1-score': 0.4594651289629357, 'support': 98343}, 'accuracy': 0.4090907414034169, 'macro avg': {'precision': 0.4105698333594146, 'recall': 0.39721517736511375, 'f1-score': 0.3772850588785975, 'support': 271067}, 'weighted avg': {'precision': 0.41082672823436345, 'recall': 0.4090907414034169, 'f1-score': 0.38533658273727034, 'support': 271067}}
[[49801  7430 34060]
 [36791 11808 32834]
 [39726  9335 49282]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1192335
{'0': {'precision': 0.42159024434144804, 'recall': 0.5069256573963856, 'f1-score': 0.4603365679891905, 'support': 18482}, '1': {'precision': 0.4550547159979156, 'recall': 0.19482402811088181, 'f1-score': 0.27283733645772307, 'support': 17929}, '2': {'precision': 0.38873649210307565, 'recall': 0.5329952131297014, 'f1-score': 0.4495770044222265, 'support': 17548}, 'accuracy': 0.41170147704738785, 'macro avg': {'precision': 0.42179381748081307, 'recall': 0.41158163287898963, 'f1-score': 0.39425030295637997, 'support': 53959}, 'weighted avg': {'precision': 0.42202514617524495, 'recall': 0.41170147704738785, 'f1-score': 0.39453693227316977, 'support': 53959}}
[[9369 2172 6941]
 [6670 3493 7766]
 [6184 2011 9353]]
Evaluating performance on  val set...
81/81 - 1s - 705ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109813
{'0': {'precision': 0.43648432135500115, 'recall': 0.5282548476454294, 'f1-score': 0.47800476250156665, 'support': 7220}, '1': {'precision': 0.4628224582701062, 'recall': 0.18905935223926856, 'f1-score': 0.2684563758389262, 'support': 6453}, '2': {'precision': 0.4095865270430746, 'recall': 0.5448018380241241, 'f1-score': 0.4676157022246872, 'support': 6964}, 'accuracy': 0.4277753549450017, 'macro avg': {'precision': 0.4362977688893939, 'recall': 0.42070534596960735, 'f1-score': 0.40469228018839337, 'support': 20637}, 'weighted avg': {'precision': 0.43564329591161866, 'recall': 0.4277753549450017, 'f1-score': 0.4089750995223445, 'support': 20637}}
[[3814  722 2684]
 [2448 1220 2785]
 [2476  694 3794]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 16s - 16s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8623289
{'0': {'precision': 0.6220370975353008, 'recall': 0.2536373458845818, 'f1-score': 0.36034359491967366, 'support': 135126}, '1': {'precision': 0.6085839103631286, 'recall': 0.8884588293547014, 'f1-score': 0.7223598020551449, 'support': 286782}, '2': {'precision': 0.5830933146001639, 'recall': 0.3628111636445759, 'f1-score': 0.4473025952388437, 'support': 137267}, 'accuracy': 0.6060160057227165, 'macro avg': {'precision': 0.6045714408328644, 'recall': 0.501635779627953, 'f1-score': 0.5100019974045541, 'support': 559175}, 'weighted avg': {'precision': 0.6055774414781321, 'recall': 0.6060160057227165, 'f1-score': 0.5673563065243344, 'support': 559175}}
[[ 34273  86729  14124]
 [ 10504 254794  21484]
 [ 10321  77144  49802]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76620406
{'0': {'precision': 0.6556504099399881, 'recall': 0.27966254461549556, 'f1-score': 0.3920845127375657, 'support': 27737}, '1': {'precision': 0.697544414200837, 'recall': 0.8819632900774659, 'f1-score': 0.7789877375809641, 'support': 81068}, '2': {'precision': 0.5385106189043842, 'recall': 0.4301576322399796, 'f1-score': 0.478274068527251, 'support': 27469}, 'accuracy': 0.6683006296138662, 'macro avg': {'precision': 0.6305684810150698, 'recall': 0.5305944889776469, 'f1-score': 0.5497821062819269, 'support': 136274}, 'weighted avg': {'precision': 0.6569606394589096, 'recall': 0.6683006296138662, 'f1-score': 0.6396226457606772, 'support': 136274}}
[[ 7757 17214  2766]
 [ 2209 71499  7360]
 [ 1865 13788 11816]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7872265
{'0': {'precision': 0.670957361222848, 'recall': 0.25411334552102377, 'f1-score': 0.36861878453038677, 'support': 9846}, '1': {'precision': 0.6930299940977626, 'recall': 0.8868747210491983, 'f1-score': 0.7780605713769372, 'support': 29127}, '2': {'precision': 0.4949298513682456, 'recall': 0.3860656625853289, 'f1-score': 0.43377160944728516, 'support': 9229}, 'accuracy': 0.661736027550724, 'macro avg': {'precision': 0.6196390688962854, 'recall': 0.509017909718517, 'f1-score': 0.5268169884515363, 'support': 48202}, 'weighted avg': {'precision': 0.6505920587312399, 'recall': 0.661736027550724, 'f1-score': 0.628506472730825, 'support': 48202}}
[[ 2502  6285  1059]
 [  718 25832  2577]
 [  509  5157  3563]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1679821
{'0': {'precision': 0.4732855503879794, 'recall': 0.3354991604869176, 'f1-score': 0.39265555515753814, 'support': 114352}, '1': {'precision': 0.3369688687705513, 'recall': 0.47044094150191973, 'f1-score': 0.39267284064274377, 'support': 83866}, '2': {'precision': 0.4493163099394941, 'recall': 0.44960392606619903, 'f1-score': 0.44946007199040133, 'support': 112479}, 'accuracy': 0.41323218441117876, 'macro avg': {'precision': 0.41985690969934164, 'recall': 0.4185146760183454, 'f1-score': 0.41159615593022775, 'support': 310697}, 'weighted avg': {'precision': 0.4278124012525439, 'recall': 0.41323218441117876, 'f1-score': 0.41322467849424843, 'support': 310697}}
[[38365 40576 35411]
 [17843 39454 26569]
 [24853 37055 50571]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1570646
{'0': {'precision': 0.4323971260613978, 'recall': 0.3999015571863254, 'f1-score': 0.41551497681122357, 'support': 44696}, '1': {'precision': 0.39475778035417947, 'recall': 0.40728492353879353, 'f1-score': 0.40092352092352096, 'support': 42636}, '2': {'precision': 0.41859140114826665, 'recall': 0.4378380856330797, 'f1-score': 0.4279984763953306, 'support': 43628}, 'accuracy': 0.4149434941967013, 'macro avg': {'precision': 0.4152487691879479, 'recall': 0.4150081887860662, 'f1-score': 0.41481232471002505, 'support': 130960}, 'weighted avg': {'precision': 0.4155438326123825, 'recall': 0.4149434941967013, 'f1-score': 0.41492326030715615, 'support': 130960}}
[[17874 13818 13004]
 [11743 17365 13528]
 [11720 12806 19102]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1657724
{'0': {'precision': 0.4138434782608696, 'recall': 0.41115488285299606, 'f1-score': 0.41249479961170443, 'support': 14469}, '1': {'precision': 0.38484064287660036, 'recall': 0.40907774721297235, 'f1-score': 0.3965892343322338, 'support': 13814}, '2': {'precision': 0.428946621237933, 'recall': 0.40655274488697524, 'f1-score': 0.4174495717048909, 'support': 14864}, 'accuracy': 0.4089044429508425, 'macro avg': {'precision': 0.4092102474584676, 'recall': 0.40892845831764785, 'f1-score': 0.4088445352162764, 'support': 43147}, 'weighted avg': {'precision': 0.40976087574418885, 'recall': 0.4089044429508425, 'f1-score': 0.40910935574822643, 'support': 43147}}
[[5949 4651 3869]
 [3987 5651 4176]
 [4439 4382 6043]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1321487
{'0': {'precision': 0.35907983475159777, 'recall': 0.6091648779513802, 'f1-score': 0.45182549585139825, 'support': 100165}, '1': {'precision': 0.25802807810230755, 'recall': 0.02097461795763101, 'f1-score': 0.03879561335403727, 'support': 76235}, '2': {'precision': 0.3708904834272743, 'recall': 0.3718812988841632, 'f1-score': 0.371385230309889, 'support': 103689}, 'accuracy': 0.36122803823070526, 'macro avg': {'precision': 0.3293327987603932, 'recall': 0.33400693159772477, 'f1-score': 0.28733544650510817, 'support': 280089}, 'weighted avg': {'precision': 0.3359477363199335, 'recall': 0.36122803823070526, 'f1-score': 0.3096274667038064, 'support': 280089}}
[[61017  2316 36832]
 [46062  1599 28574]
 [62847  2282 38560]]
Evaluating performance on  train set...
448/448 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1573375
{'0': {'precision': 0.33821474321649003, 'recall': 0.6082995156434088, 'f1-score': 0.4347232227222123, 'support': 38195}, '1': {'precision': 0.26761951700345, 'recall': 0.014293235061858384, 'f1-score': 0.027137109872810417, 'support': 37990}, '2': {'precision': 0.33280868632952393, 'recall': 0.38015581437765444, 'f1-score': 0.35491011700600844, 'support': 38379}, 'accuracy': 0.33489577877867394, 'macro avg': {'precision': 0.31288098218315463, 'recall': 0.33424952169430727, 'f1-score': 0.27225681653367706, 'support': 114564}, 'weighted avg': {'precision': 0.3129939783942225, 'recall': 0.33489577877867394, 'f1-score': 0.27282818054988095, 'support': 114564}}
[[23234   762 14199]
 [22397   543 15050]
 [23065   724 14590]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1534219
{'0': {'precision': 0.3405314819248264, 'recall': 0.6050706142589757, 'f1-score': 0.4357976653696498, 'support': 11754}, '1': {'precision': 0.31392045454545453, 'recall': 0.020210333790580706, 'f1-score': 0.03797577111435691, 'support': 10935}, '2': {'precision': 0.3512591019417476, 'recall': 0.3832340284673949, 'f1-score': 0.36655057780592054, 'support': 12084}, 'accuracy': 0.34406004658786987, 'macro avg': {'precision': 0.33523701280400947, 'recall': 0.33617165883898376, 'f1-score': 0.2801080047633091, 'support': 34773}, 'weighted avg': {'precision': 0.33589112808394544, 'recall': 0.34406004658786987, 'f1-score': 0.2866312368244644, 'support': 34773}}
[[7112  236 4406]
 [6567  221 4147]
 [7206  247 4631]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1757618
{'0': {'precision': 0.4057061021291935, 'recall': 0.5395214158007929, 'f1-score': 0.46314168063815647, 'support': 154372}, '1': {'precision': 0.33810205659110204, 'recall': 0.2059161733949698, 'f1-score': 0.25594981150536705, 'support': 129577}, '2': {'precision': 0.41972501963689307, 'recall': 0.4190372967803634, 'f1-score': 0.41938087626777437, 'support': 156850}, 'accuracy': 0.39858302763844744, 'macro avg': {'precision': 0.3878443927857296, 'recall': 0.3881582953253753, 'f1-score': 0.37949078947043263, 'support': 440799}, 'weighted avg': {'precision': 0.3908216259901673, 'recall': 0.39858302763844744, 'f1-score': 0.38666423175076364, 'support': 440799}}
[[83287 26568 44517]
 [56545 26682 46350]
 [65457 25667 65726]]
Evaluating performance on  train set...
618/618 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1942145
{'0': {'precision': 0.3979422894985809, 'recall': 0.5129964174098636, 'f1-score': 0.44820352302620625, 'support': 52476}, '1': {'precision': 0.38879832810867293, 'recall': 0.17666945225252603, 'f1-score': 0.24294500959818224, 'support': 52652}, '2': {'precision': 0.3874811690268153, 'recall': 0.48690960719356363, 'f1-score': 0.4315423010779749, 'support': 52825}, 'accuracy': 0.39216095927269506, 'macro avg': {'precision': 0.3914072622113564, 'recall': 0.3921918256186511, 'f1-score': 0.3742302779007878, 'support': 157953}, 'weighted avg': {'precision': 0.3913956804185226, 'recall': 0.39216095927269506, 'f1-score': 0.37421062451571485, 'support': 157953}}
[[26920  7462 18094]
 [20785  9302 22565]
 [19943  7161 25721]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2057799
{'0': {'precision': 0.39331210191082805, 'recall': 0.49535571036521003, 'f1-score': 0.43847519387087736, 'support': 18948}, '1': {'precision': 0.3842118840828962, 'recall': 0.23078512396694215, 'f1-score': 0.28836038594339924, 'support': 19360}, '2': {'precision': 0.395526807270077, 'recall': 0.4537046713345177, 'f1-score': 0.4226229587987637, 'support': 19138}, 'accuracy': 0.39231626222887583, 'macro avg': {'precision': 0.39101693108793373, 'recall': 0.3932818352222233, 'f1-score': 0.38315284620434675, 'support': 57446}, 'weighted avg': {'precision': 0.39098304181989996, 'recall': 0.39231626222887583, 'f1-score': 0.38260354473453906, 'support': 57446}}
[[9386 3614 5948]
 [7570 4468 7322]
 [6908 3547 8683]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9178965
{'0': {'precision': 0.6505579301736203, 'recall': 0.25217516253236716, 'f1-score': 0.3634619204808176, 'support': 341009}, '1': {'precision': 0.5206138818165177, 'recall': 0.816124537235303, 'f1-score': 0.6357051721116259, 'support': 460007}, '2': {'precision': 0.5610314183752012, 'recall': 0.4742727850815575, 'f1-score': 0.5140169090836239, 'support': 338105}, 'accuracy': 0.5458340246558531, 'macro avg': {'precision': 0.5774010767884464, 'recall': 0.5141908282830759, 'f1-score': 0.5043946672253558, 'support': 1139121}, 'weighted avg': {'precision': 0.5715105479164148, 'recall': 0.5458340246558531, 'f1-score': 0.5180874570783213, 'support': 1139121}}
[[ 85994 198256  56759]
 [ 15877 375423  68707]
 [ 30314 147437 160354]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8867002
{'0': {'precision': 0.6736121813642388, 'recall': 0.21340963243623295, 'f1-score': 0.32413031064836445, 'support': 102404}, '1': {'precision': 0.5719477769936485, 'recall': 0.8103329519069468, 'f1-score': 0.6705846660200512, 'support': 180026}, '2': {'precision': 0.5385548111307493, 'recall': 0.5118713924347342, 'f1-score': 0.5248741894294084, 'support': 102389}, 'accuracy': 0.5720741439481938, 'macro avg': {'precision': 0.5947049231628788, 'recall': 0.511871325592638, 'f1-score': 0.506529722032608, 'support': 384819}, 'weighted avg': {'precision': 0.5901167584717708, 'recall': 0.5720741439481938, 'f1-score': 0.5396205977304876, 'support': 384819}}
[[ 21854  64765  15785]
 [  5024 145881  29121]
 [  5565  44414  52410]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8855478
{'0': {'precision': 0.6570449215226412, 'recall': 0.21431723894430224, 'f1-score': 0.3232090164843698, 'support': 33987}, '1': {'precision': 0.5731965971332013, 'recall': 0.8012967759803202, 'f1-score': 0.6683198249916775, 'support': 61383}, '2': {'precision': 0.5294660121969359, 'recall': 0.5064739193534618, 'f1-score': 0.5177148176159172, 'support': 35141}, 'accuracy': 0.5690554819134019, 'macro avg': {'precision': 0.5865691769509261, 'recall': 0.5073626447593614, 'f1-score': 0.5030812196973214, 'support': 130511}, 'weighted avg': {'precision': 0.5832571783545434, 'recall': 0.5690554819134019, 'f1-score': 0.5378964000471942, 'support': 130511}}
[[ 7284 21452  5251]
 [ 1631 49186 10566]
 [ 2171 15172 17798]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
6203/6203 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8751792
{'0': {'precision': 0.6182229466750939, 'recall': 0.2437049062522129, 'f1-score': 0.34959762525536403, 'support': 381289}, '1': {'precision': 0.6078811285954124, 'recall': 0.8631320928899995, 'f1-score': 0.7133609720014288, 'support': 816751}, '2': {'precision': 0.5178325931577545, 'recall': 0.3690955637527768, 'f1-score': 0.43099254750664967, 'support': 389834}, 'accuracy': 0.5931024753853266, 'macro avg': {'precision': 0.5813122228094203, 'recall': 0.4919775209649964, 'f1-score': 0.49798371492114746, 'support': 1587874}, 'weighted avg': {'precision': 0.5882569271222349, 'recall': 0.5931024753853266, 'f1-score': 0.5566887328237875, 'support': 1587874}}
[[ 92922 240343  48024]
 [ 25835 704964  85952]
 [ 31548 214400 143886]]
Evaluating performance on  train set...
1766/1766 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8861328
{'0': {'precision': 0.605923180061519, 'recall': 0.2710043829866041, 'f1-score': 0.3745071872962482, 'support': 113393}, '1': {'precision': 0.5999182799160512, 'recall': 0.8594767908538181, 'f1-score': 0.7066158414866912, 'support': 225493}, '2': {'precision': 0.5199626698712622, 'recall': 0.3595950665310994, 'f1-score': 0.42515915244138275, 'support': 113105}, 'accuracy': 0.5867550460075532, 'macro avg': {'precision': 0.5752680432829441, 'recall': 0.49669208012384053, 'f1-score': 0.5020940604081073, 'support': 451991}, 'weighted avg': {'precision': 0.5814168813662554, 'recall': 0.5867550460075532, 'f1-score': 0.5528673034868494, 'support': 451991}}
[[ 30730  67694  14969]
 [  9107 193806  22580]
 [ 10879  61554  40672]]
Evaluating performance on  val set...
579/579 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8483798
{'0': {'precision': 0.6235959127473005, 'recall': 0.2529617544169092, 'f1-score': 0.35992136523339474, 'support': 34017}, '1': {'precision': 0.6451001624255549, 'recall': 0.8511238376747337, 'f1-score': 0.7339277085402053, 'support': 81195}, '2': {'precision': 0.4872361586915681, 'recall': 0.4025258673158856, 'f1-score': 0.4408485676671055, 'support': 32860}, 'accuracy': 0.6141539251175104, 'macro avg': {'precision': 0.5853107446214745, 'recall': 0.5022038198025095, 'f1-score': 0.5115658804802351, 'support': 148072}, 'weighted avg': {'precision': 0.6051268979055647, 'recall': 0.6141539251175104, 'f1-score': 0.5829663225296304, 'support': 148072}}
[[ 8605 21062  4350]
 [ 2518 69107  9570]
 [ 2676 16957 13227]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
5183/5183 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0303861
{'0': {'precision': 0.547676095841013, 'recall': 0.2994702433638013, 'f1-score': 0.3872121878257717, 'support': 456436}, '1': {'precision': 0.4230910241831769, 'recall': 0.7236569754482056, 'f1-score': 0.5339843993590561, 'support': 408239}, '2': {'precision': 0.5130261790050817, 'recall': 0.42071554531390304, 'f1-score': 0.4623079017227175, 'support': 462165}, 'accuracy': 0.47221518796539147, 'macro avg': {'precision': 0.4945977663430905, 'recall': 0.4812809213753033, 'f1-score': 0.4611681629691818, 'support': 1326840}, 'weighted avg': {'precision': 0.4972747935867838, 'recall': 0.47221518796539147, 'f1-score': 0.4585280597299338, 'support': 1326840}}
[[136689 209779 109968]
 [ 38216 295425  74598]
 [ 74675 193050 194440]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0127007
{'0': {'precision': 0.5469220045491232, 'recall': 0.2901653638939927, 'f1-score': 0.3791666878614775, 'support': 128444}, '1': {'precision': 0.44920106165341234, 'recall': 0.7304798755434999, 'f1-score': 0.5563069220907837, 'support': 125345}, '2': {'precision': 0.5057521839965533, 'recall': 0.43347632740929304, 'f1-score': 0.466833356602233, 'support': 127278}, 'accuracy': 0.48286521792755605, 'macro avg': {'precision': 0.5006250833996962, 'recall': 0.4847071889489285, 'f1-score': 0.4674356555181647, 'support': 381067}, 'weighted avg': {'precision': 0.5010275975090152, 'recall': 0.48286521792755605, 'f1-score': 0.46671475925957356, 'support': 381067}}
[[37270 60491 30683]
 [10549 91562 23234]
 [20326 51780 55172]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9919163
{'0': {'precision': 0.5562602771905097, 'recall': 0.2792057727680045, 'f1-score': 0.3717950730872494, 'support': 42406}, '1': {'precision': 0.48233677875179903, 'recall': 0.7630767320072033, 'f1-score': 0.5910646860294531, 'support': 48311}, '2': {'precision': 0.5163684105374319, 'recall': 0.4304032353990722, 'f1-score': 0.46948308075565703, 'support': 42035}, 'accuracy': 0.5031713269856575, 'macro avg': {'precision': 0.5183218221599136, 'recall': 0.49089524672476, 'f1-score': 0.4774476132907865, 'support': 132752}, 'weighted avg': {'precision': 0.5167266148137871, 'recall': 0.5031713269856575, 'f1-score': 0.48252372254784, 'support': 132752}}
[[11840 21515  9051]
 [ 3552 36865  7894]
 [ 5893 18050 18092]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 60s - 60s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0634168
{'0': {'precision': 0.5041611502245759, 'recall': 0.31173578606064595, 'f1-score': 0.3852571703040583, 'support': 653531}, '1': {'precision': 0.40815476327479455, 'recall': 0.6110037246450217, 'f1-score': 0.489392147636467, 'support': 580458}, '2': {'precision': 0.48165193270076173, 'recall': 0.45229953317923516, 'f1-score': 0.4665144866177072, 'support': 640717}, 'accuracy': 0.45243734217525305, 'macro avg': {'precision': 0.4646559487333774, 'recall': 0.4583463479616343, 'f1-score': 0.4470546015194108, 'support': 1874706}, 'weighted avg': {'precision': 0.46674210228836516, 'recall': 0.45243734217525305, 'f1-score': 0.44527134031735505, 'support': 1874706}}
[[203729 280147 169655]
 [ 83576 354662 142220]
 [116790 234131 289796]]
Evaluating performance on  train set...
2046/2046 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0347421
{'0': {'precision': 0.5110608135170127, 'recall': 0.31362999799937125, 'f1-score': 0.3887129568624117, 'support': 174945}, '1': {'precision': 0.44697829811303863, 'recall': 0.6319507971302162, 'f1-score': 0.5236086282922178, 'support': 173811}, '2': {'precision': 0.48037526662447555, 'recall': 0.4684507074447416, 'f1-score': 0.4743380548997825, 'support': 174996}, 'accuracy': 0.47099581481311764, 'macro avg': {'precision': 0.47947145941817565, 'recall': 0.47134383419144293, 'f1-score': 0.46221988001813735, 'support': 523752}, 'weighted avg': {'precision': 0.4795418998920784, 'recall': 0.47099581481311764, 'f1-score': 0.46208814436152146, 'support': 523752}}
[[ 54868  73994  46083]
 [ 21379 109840  42592]
 [ 31114  61905  81977]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0317394
{'0': {'precision': 0.5219986620696753, 'recall': 0.32004038364462395, 'f1-score': 0.39680025034716115, 'support': 63392}, '1': {'precision': 0.4527811702009548, 'recall': 0.6415088403699742, 'f1-score': 0.5308704651071973, 'support': 63572}, '2': {'precision': 0.47380222244204834, 'recall': 0.45888289208954747, 'f1-score': 0.46622323166774826, 'support': 62626}, 'accuracy': 0.4736958700353394, 'macro avg': {'precision': 0.4828606849042261, 'recall': 0.47347737203471524, 'f1-score': 0.46463131570736893, 'support': 189590}, 'weighted avg': {'precision': 0.4828687257797968, 'recall': 0.4736958700353394, 'f1-score': 0.4646877724786454, 'support': 189590}}
[[20288 26446 16658]
 [ 7532 40782 15258]
 [11046 22842 28738]]
testing model on single stock: results/universal/W6/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 203s - 203s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2059631
{'0': {'precision': 0.3573088982170447, 'recall': 0.4134699819178798, 'f1-score': 0.3833434140256615, 'support': 2212683}, '1': {'precision': 0.43101168897376557, 'recall': 0.27384645046231954, 'f1-score': 0.3349071665049212, 'support': 3112025}, '2': {'precision': 0.3441486473044217, 'recall': 0.4678945819794069, 'f1-score': 0.39659289471890546, 'support': 2188696}, 'accuracy': 0.37149260175547594, 'macro avg': {'precision': 0.377489744831744, 'recall': 0.3850703381198688, 'f1-score': 0.3716144917498294, 'support': 7513404}, 'weighted avg': {'precision': 0.3840026762799879, 'recall': 0.37149260175547594, 'f1-score': 0.36714094071325193, 'support': 7513404}}
[[ 914878  597961  699844]
 [1008043  852217 1251765]
 [ 637547  527070 1024079]]
Evaluating performance on  train set...
5452/5452 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1428075
{'0': {'precision': 0.42128765316857064, 'recall': 0.4851737935977066, 'f1-score': 0.4509794202783615, 'support': 468832}, '1': {'precision': 0.467714585119558, 'recall': 0.2668046265843834, 'f1-score': 0.33978257679988705, 'support': 460037}, '2': {'precision': 0.40325430518510524, 'recall': 0.5125930656699657, 'f1-score': 0.45139696223936704, 'support': 466606}, 'accuracy': 0.4223536788548702, 'macro avg': {'precision': 0.4307521811577446, 'recall': 0.4215238286173519, 'f1-score': 0.41405298643920524, 'support': 1395475}, 'weighted avg': {'precision': 0.43056308850403957, 'recall': 0.4223536788548702, 'f1-score': 0.4144615072386797, 'support': 1395475}}
[[227465  74059 167308]
 [150662 122740 186635]
 [161801  65626 239179]]
Evaluating performance on  val set...
1969/1969 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1536252
{'0': {'precision': 0.4218936704229056, 'recall': 0.44989970796422407, 'f1-score': 0.435446847431623, 'support': 164021}, '1': {'precision': 0.477721013634672, 'recall': 0.31322441464523787, 'f1-score': 0.3783671528005735, 'support': 180318}, '2': {'precision': 0.38725429771578657, 'recall': 0.5113946557812226, 'f1-score': 0.44075003372453797, 'support': 159724}, 'accuracy': 0.4204930732864741, 'macro avg': {'precision': 0.42895632725778804, 'recall': 0.4248395927968948, 'f1-score': 0.41818801131891153, 'support': 504063}, 'weighted avg': {'precision': 0.43088845025595707, 'recall': 0.4204930732864741, 'f1-score': 0.416708217044088, 'support': 504063}}
[[73793 31817 58411]
 [53005 56480 70833]
 [48111 29931 81682]]
training model: results/universal/W6/deepVOL_L2/h100
Epoch 1/50
9426/9426 - 304s - loss: 3.1886 - accuracy100: 0.4208 - val_loss: 3.3186 - val_accuracy100: 0.3827 - 304s/epoch - 32ms/step
Epoch 2/50
9426/9426 - 300s - loss: 3.1573 - accuracy100: 0.4320 - val_loss: 3.3296 - val_accuracy100: 0.3879 - 300s/epoch - 32ms/step
Epoch 3/50
9426/9426 - 308s - loss: 3.1459 - accuracy100: 0.4359 - val_loss: 3.3133 - val_accuracy100: 0.3918 - 308s/epoch - 33ms/step
Epoch 4/50
9426/9426 - 308s - loss: 3.1373 - accuracy100: 0.4395 - val_loss: 3.3012 - val_accuracy100: 0.3941 - 308s/epoch - 33ms/step
Epoch 5/50
9426/9426 - 300s - loss: 3.1311 - accuracy100: 0.4415 - val_loss: 3.2921 - val_accuracy100: 0.3959 - 300s/epoch - 32ms/step
Epoch 6/50
9426/9426 - 302s - loss: 3.1262 - accuracy100: 0.4431 - val_loss: 3.3066 - val_accuracy100: 0.3963 - 302s/epoch - 32ms/step
Epoch 7/50
9426/9426 - 309s - loss: 3.1215 - accuracy100: 0.4447 - val_loss: 3.3167 - val_accuracy100: 0.3972 - 309s/epoch - 33ms/step
Epoch 8/50
9426/9426 - 304s - loss: 3.1175 - accuracy100: 0.4463 - val_loss: 3.3181 - val_accuracy100: 0.3989 - 304s/epoch - 32ms/step
Epoch 9/50
9426/9426 - 303s - loss: 3.1157 - accuracy100: 0.4469 - val_loss: 3.3096 - val_accuracy100: 0.3992 - 303s/epoch - 32ms/step
Epoch 10/50
9426/9426 - 307s - loss: 3.1123 - accuracy100: 0.4481 - val_loss: 3.2983 - val_accuracy100: 0.3988 - 307s/epoch - 33ms/step
Epoch 11/50
9426/9426 - 301s - loss: 3.1096 - accuracy100: 0.4497 - val_loss: 3.2951 - val_accuracy100: 0.3992 - 301s/epoch - 32ms/step
Epoch 12/50
9426/9426 - 305s - loss: 3.1069 - accuracy100: 0.4506 - val_loss: 3.2936 - val_accuracy100: 0.4011 - 305s/epoch - 32ms/step
Epoch 13/50
9426/9426 - 307s - loss: 3.1045 - accuracy100: 0.4516 - val_loss: 3.3420 - val_accuracy100: 0.4008 - 307s/epoch - 33ms/step
Epoch 14/50
9426/9426 - 308s - loss: 3.1017 - accuracy100: 0.4523 - val_loss: 3.3606 - val_accuracy100: 0.4016 - 308s/epoch - 33ms/step
Epoch 15/50
9426/9426 - 306s - loss: 3.0995 - accuracy100: 0.4532 - val_loss: 3.3368 - val_accuracy100: 0.4025 - 306s/epoch - 32ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 669s - 669s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1229953
{'0': {'precision': 0.34285710652248835, 'recall': 0.40316770717625616, 'f1-score': 0.37057457335883165, 'support': 3343554}, '1': {'precision': 0.3847744713429469, 'recall': 0.29032487085539654, 'f1-score': 0.33094269752161715, 'support': 4126963}, '2': {'precision': 0.3478657279255001, 'recall': 0.3920107810013524, 'f1-score': 0.3686212875861454, 'support': 3348112}, 'accuracy': 0.3566689457601328, 'macro avg': {'precision': 0.3584991019303117, 'recall': 0.36183445301100176, 'f1-score': 0.35671285282219806, 'support': 10818629}, 'weighted avg': {'precision': 0.3603972993782018, 'recall': 0.3566689457601328, 'f1-score': 0.3548517766222268, 'support': 10818629}}
[[1348013 1009593  985948]
 [1454251 1198160 1474552]
 [1129441  906175 1312496]]
Evaluating performance on  train set...
9426/9426 - 147s - 147s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1047999
{'0': {'precision': 0.3851853656056999, 'recall': 0.4527264105031123, 'f1-score': 0.4162337680914794, 'support': 803419}, '1': {'precision': 0.40228464649179924, 'recall': 0.3804045107976076, 'f1-score': 0.39103874820516205, 'support': 810411}, '2': {'precision': 0.39871716293456105, 'recall': 0.35037432565643206, 'f1-score': 0.3729858347572801, 'support': 798369}, 'accuracy': 0.3945532686150687, 'macro avg': {'precision': 0.39539572501068676, 'recall': 0.39450174898571727, 'f1-score': 0.39341945035130715, 'support': 2412199}, 'weighted avg': {'precision': 0.39540873972360235, 'recall': 0.3945532686150687, 'f1-score': 0.3934553279423948, 'support': 2412199}}
[[363729 249232 190458]
 [270743 308284 231384]
 [309824 208817 279728]]
Evaluating performance on  val set...
3323/3323 - 52s - 52s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0974002
{'0': {'precision': 0.37780485059556523, 'recall': 0.42262398530544526, 'f1-score': 0.39895961880656805, 'support': 270032}, '1': {'precision': 0.4254770623694297, 'recall': 0.39792146328984396, 'f1-score': 0.4112381792735138, 'support': 312720}, '2': {'precision': 0.38318319727252825, 'recall': 0.3663104702316211, 'f1-score': 0.37455691292276005, 'support': 267549}, 'accuracy': 0.39581983321200376, 'macro avg': {'precision': 0.3954883700791744, 'recall': 0.3956186396089701, 'f1-score': 0.39491823700094725, 'support': 850301}, 'weighted avg': {'precision': 0.39702983720736235, 'recall': 0.39581983321200376, 'f1-score': 0.3957970115330453, 'support': 850301}}
[[114122  89845  66065]
 [ 96585 124438  91697]
 [ 91359  78184  98006]]
testing model out of sample: results/universal/W6/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 269s - 269s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912234
{'0': {'precision': 0.39785572599589575, 'recall': 0.3644606089015191, 'f1-score': 0.38042669037370996, 'support': 1433598}, '1': {'precision': 0.41072195075896883, 'recall': 0.46720955774690626, 'f1-score': 0.43714849988154925, 'support': 1601549}, '2': {'precision': 0.39313839936477085, 'recall': 0.36604376839660246, 'f1-score': 0.37910759055163107, 'support': 1449996}, 'accuracy': 0.40166188681163567, 'macro avg': {'precision': 0.40057202537321185, 'recall': 0.3992379783483426, 'f1-score': 0.3988942602689634, 'support': 4485143}, 'weighted avg': {'precision': 0.40092492237542043, 'recall': 0.40166188681163567, 'f1-score': 0.400254389920827, 'support': 4485143}}
[[522490 561128 349980]
 [383968 748259 469322]
 [406807 512427 530762]]
Evaluating performance on  train set...
5153/5153 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.088974
{'0': {'precision': 0.4119332107843137, 'recall': 0.36957985734115806, 'f1-score': 0.38960888431697827, 'support': 436566}, '1': {'precision': 0.4030580956404421, 'recall': 0.46111014597337113, 'f1-score': 0.4301342455479157, 'support': 448986}, '2': {'precision': 0.40228221892073696, 'recall': 0.38390719133243895, 'f1-score': 0.39287997211539033, 'support': 433063}, 'accuracy': 0.40545117414863324, 'macro avg': {'precision': 0.4057578417818309, 'recall': 0.4048657315489894, 'f1-score': 0.40420770066009476, 'support': 1318615}, 'weighted avg': {'precision': 0.40574164619768116, 'recall': 0.40545117414863324, 'f1-score': 0.4044819950679384, 'support': 1318615}}
[[161346 162150 113070]
 [107998 207032 133956]
 [122336 144471 166256]]
Evaluating performance on  val set...
1795/1795 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0824144
{'0': {'precision': 0.40486737471313444, 'recall': 0.3605488827479444, 'f1-score': 0.3814250826030743, 'support': 147281}, '1': {'precision': 0.4245839840594539, 'recall': 0.4758085444088377, 'f1-score': 0.4487391466437481, 'support': 165699}, '2': {'precision': 0.3975979104918933, 'recall': 0.38705521136027193, 'f1-score': 0.39225573440294487, 'support': 145912}, 'accuracy': 0.4105955213862957, 'macro avg': {'precision': 0.40901642308816055, 'recall': 0.407804212839018, 'f1-score': 0.4074733212165891, 'support': 458892}, 'weighted avg': {'precision': 0.40967530422296694, 'recall': 0.4105955213862957, 'f1-score': 0.40917495656666125, 'support': 458892}}
[[53102 57614 36565]
 [37856 78841 49002]
 [40201 49235 56476]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1503366
{'0': {'precision': 0.3385184462017421, 'recall': 0.7308430913348947, 'f1-score': 0.46271323404034487, 'support': 85400}, '1': {'precision': 0.35446547176712934, 'recall': 0.20375370722854233, 'f1-score': 0.2587645020975778, 'support': 90364}, '2': {'precision': 0.38080575539568345, 'recall': 0.13885187244892605, 'f1-score': 0.20350164932758186, 'support': 95303}, 'accuracy': 0.3469953922830887, 'macro avg': {'precision': 0.3579298911215183, 'recall': 0.35781622367078764, 'f1-score': 0.3083264618218348, 'support': 271067}, 'weighted avg': {'precision': 0.358702181021181, 'recall': 0.3469953922830887, 'f1-score': 0.3035892356519145, 'support': 271067}}
[[62414 14312  8674]
 [59109 18412 12843]
 [62851 19219 13233]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1289921
{'0': {'precision': 0.37450942546483945, 'recall': 0.6246713526855181, 'f1-score': 0.46827423928564244, 'support': 18637}, '1': {'precision': 0.33048457396803693, 'recall': 0.22217753519103706, 'f1-score': 0.2657184085755514, 'support': 17405}, '2': {'precision': 0.36994271392767636, 'recall': 0.23067477814366244, 'f1-score': 0.2841623981573791, 'support': 17917}, 'accuracy': 0.3640171241127523, 'macro avg': {'precision': 0.3583122377868509, 'recall': 0.35917455534007253, 'f1-score': 0.3393850153395243, 'support': 53959}, 'weighted avg': {'precision': 0.35879241234537473, 'recall': 0.3640171241127523, 'f1-score': 0.3418038434109185, 'support': 53959}}
[[11642  3884  3111]
 [ 9610  3867  3928]
 [ 9834  3950  4133]]
Evaluating performance on  val set...
81/81 - 1s - 778ms/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.125633
{'0': {'precision': 0.35322176408763845, 'recall': 0.664284628249962, 'f1-score': 0.4612055315106091, 'support': 6577}, '1': {'precision': 0.39795189330793046, 'recall': 0.2286535303776683, 'f1-score': 0.29043191101068916, 'support': 7308}, '2': {'precision': 0.37552224133693785, 'recall': 0.22630331753554503, 'f1-score': 0.2824138249699658, 'support': 6752}, 'accuracy': 0.36671996898774045, 'macro avg': {'precision': 0.3755652995775023, 'recall': 0.3730804920543918, 'f1-score': 0.3446837558304214, 'support': 20637}, 'weighted avg': {'precision': 0.3763579082330648, 'recall': 0.36671996898774045, 'f1-score': 0.3422340133066144, 'support': 20637}}
[[4369 1185 1023]
 [4119 1671 1518]
 [3881 1343 1528]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0619544
{'0': {'precision': 0.5342037481126211, 'recall': 0.17129561066745652, 'f1-score': 0.25940989489211025, 'support': 175562}, '1': {'precision': 0.41613703356689896, 'recall': 0.8672851043736597, 'f1-score': 0.5624173682556948, 'support': 203308}, '2': {'precision': 0.5500448464482877, 'recall': 0.2414852610853831, 'f1-score': 0.33562266826997195, 'support': 180305}, 'accuracy': 0.44697992578352036, 'macro avg': {'precision': 0.5001285427092692, 'recall': 0.42668865870883305, 'f1-score': 0.3858166438059256, 'support': 559175}, 'weighted avg': {'precision': 0.49638432062489485, 'recall': 0.44697992578352036, 'f1-score': 0.3941537362628779, 'support': 559175}}
[[ 30073 125984  19505]
 [ 10869 176326  16113]
 [ 15353 121411  43541]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99010885
{'0': {'precision': 0.5598627787307032, 'recall': 0.17191614874117772, 'f1-score': 0.2630560928433269, 'support': 37972}, '1': {'precision': 0.5111061251963204, 'recall': 0.8530584998127615, 'f1-score': 0.6392240590495942, 'support': 61419}, '2': {'precision': 0.5333212686060715, 'recall': 0.319605238185614, 'f1-score': 0.3996880615739328, 'support': 36883}, 'accuracy': 0.5188810778284926, 'macro avg': {'precision': 0.5347633908443651, 'recall': 0.4481932955798511, 'f1-score': 0.43398940448895135, 'support': 136274}, 'weighted avg': {'precision': 0.5307044989315115, 'recall': 0.5188810778284926, 'f1-score': 0.4695757313592116, 'support': 136274}}
[[ 6528 27612  3832]
 [ 2542 52394  6483]
 [ 2590 22505 11788]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9968714
{'0': {'precision': 0.5416469474680549, 'recall': 0.17155062579629768, 'f1-score': 0.2605725994649667, 'support': 13343}, '1': {'precision': 0.5295792985596876, 'recall': 0.8666548295454546, 'f1-score': 0.6574290765215927, 'support': 22528}, '2': {'precision': 0.4782669855113237, 'recall': 0.27572784040223824, 'f1-score': 0.3497942386831276, 'support': 12331}, 'accuracy': 0.5230695821750135, 'macro avg': {'precision': 0.5164977438463554, 'recall': 0.43797776524799686, 'f1-score': 0.42259863822322896, 'support': 48202}, 'weighted avg': {'precision': 0.5197931176374223, 'recall': 0.5230695821750135, 'f1-score': 0.468874635652901, 'support': 48202}}
[[ 2289  9496  1558]
 [  853 19524  2151]
 [ 1084  7847  3400]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1522222
{'0': {'precision': 0.41095283487507217, 'recall': 0.26447030768034424, 'f1-score': 0.3218273577962359, 'support': 115737}, '1': {'precision': 0.2678748923199258, 'recall': 0.5026359634943923, 'f1-score': 0.34949164851125636, 'support': 80426}, '2': {'precision': 0.4167096501922536, 'recall': 0.31036198857981034, 'f1-score': 0.3557581641129315, 'support': 114534}, 'accuracy': 0.34303839431986793, 'macro avg': {'precision': 0.36517912579575046, 'recall': 0.35915608658484893, 'f1-score': 0.34235905680680795, 'support': 310697}, 'weighted avg': {'precision': 0.3760383184091837, 'recall': 0.34303839431986793, 'f1-score': 0.341496550661705, 'support': 310697}}
[[30609 58162 26966]
 [17210 40425 22791]
 [26664 52323 35547]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1250448
{'0': {'precision': 0.37727124106684107, 'recall': 0.36759585845943793, 'f1-score': 0.3723707110173692, 'support': 43945}, '1': {'precision': 0.3439985066268434, 'recall': 0.4166779722335278, 'f1-score': 0.37686612949404885, 'support': 44226}, '2': {'precision': 0.373134328358209, 'recall': 0.3014793521699502, 'f1-score': 0.33350137666265944, 'support': 42789}, 'accuracy': 0.36256872327428225, 'macro avg': {'precision': 0.36480135868396446, 'recall': 0.36191772762097196, 'f1-score': 0.3609127390580258, 'support': 130960}, 'weighted avg': {'precision': 0.36468316599633865, 'recall': 0.36256872327428225, 'f1-score': 0.36118893360324245, 'support': 130960}}
[[16154 18030  9761]
 [13887 18428 11911]
 [12777 17112 12900]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1284953
{'0': {'precision': 0.369158565202816, 'recall': 0.3888143492691194, 'f1-score': 0.3787315999449718, 'support': 14161}, '1': {'precision': 0.33761550597250395, 'recall': 0.4131843883602262, 'f1-score': 0.3715968992248062, 'support': 14502}, '2': {'precision': 0.37914917970240364, 'recall': 0.2744407622203811, 'f1-score': 0.31840756167894907, 'support': 14484}, 'accuracy': 0.3586112591837208, 'macro avg': {'precision': 0.36197441695924115, 'recall': 0.35881316661657553, 'f1-score': 0.3562453536162424, 'support': 43147}, 'weighted avg': {'precision': 0.36191047415254696, 'recall': 0.3586112591837208, 'f1-score': 0.3560834250987736, 'support': 43147}}
[[5506 5901 2754]
 [4755 5992 3755]
 [4654 5855 3975]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2779996
{'0': {'precision': 0.35419127310232396, 'recall': 0.43030517380759903, 'f1-score': 0.3885558384203371, 'support': 98960}, '1': {'precision': 0.27426314037544824, 'recall': 0.573287122733777, 'f1-score': 0.37102584580876474, 'support': 76173}, '2': {'precision': 0.3125, 'recall': 0.0019055604253210869, 'f1-score': 0.0037880222735709687, 'support': 104956}, 'accuracy': 0.30865903337867606, 'macro avg': {'precision': 0.3136514711592574, 'recall': 0.3351659523222324, 'f1-score': 0.2544565688342243, 'support': 280089}, 'weighted avg': {'precision': 0.3168313092553617, 'recall': 0.30865903337867606, 'f1-score': 0.23960674353013683, 'support': 280089}}
[[42583 56056   321]
 [32385 43669   119]
 [45258 59498   200]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2334869
{'0': {'precision': 0.3364749082007344, 'recall': 0.43210814492677685, 'f1-score': 0.3783418013327063, 'support': 38171}, '1': {'precision': 0.3323414372267812, 'recall': 0.5719602977667494, 'f1-score': 0.42040416387748963, 'support': 37882}, '2': {'precision': 0.3467048710601719, 'recall': 0.003141959440159954, 'f1-score': 0.006227483273288729, 'support': 38511}, 'accuracy': 0.33415383541077476, 'macro avg': {'precision': 0.3385070721625625, 'recall': 0.33573680071122874, 'f1-score': 0.2683244828278282, 'support': 114564}, 'weighted avg': {'precision': 0.33854695484928454, 'recall': 0.33415383541077476, 'f1-score': 0.26716300096902534, 'support': 114564}}
[[16494 21545   132]
 [16119 21667    96]
 [16407 21983   121]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2513913
{'0': {'precision': 0.3431746669344581, 'recall': 0.4393965369449683, 'f1-score': 0.38537007104461907, 'support': 11666}, '1': {'precision': 0.31524050632911393, 'recall': 0.5726110549066495, 'f1-score': 0.40662247330437906, 'support': 10873}, '2': {'precision': 0.29069767441860467, 'recall': 0.0020434853686447604, 'f1-score': 0.004058441558441558, 'support': 12234}, 'accuracy': 0.3271791332355563, 'macro avg': {'precision': 0.31637094922739223, 'recall': 0.3380170257400876, 'f1-score': 0.26535032863581326, 'support': 34773}, 'weighted avg': {'precision': 0.3159773686081458, 'recall': 0.3271791332355563, 'f1-score': 0.257860534756018, 'support': 34773}}
[[5126 6510   30]
 [4616 6226   31]
 [5195 7014   25]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1455677
{'0': {'precision': 0.3921735181322748, 'recall': 0.586778575428309, 'f1-score': 0.4701333595465121, 'support': 158939}, '1': {'precision': 0.3080385697838045, 'recall': 0.3177379715308361, 'f1-score': 0.3128131013372523, 'support': 121254}, '2': {'precision': 0.3936652164427162, 'recall': 0.1909891286751429, 'f1-score': 0.25719735876742483, 'support': 160606}, 'accuracy': 0.3685648107187176, 'macro avg': {'precision': 0.3646257681195985, 'recall': 0.36516855854476266, 'f1-score': 0.3467146065503964, 'support': 440799}, 'weighted avg': {'precision': 0.36957336856705647, 'recall': 0.3685648107187176, 'f1-score': 0.34927439677656097, 'support': 440799}}
[[93262 43009 22668]
 [58150 38527 24577]
 [86396 43536 30674]]
Evaluating performance on  train set...
618/618 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1257921
{'0': {'precision': 0.37491009201617104, 'recall': 0.5681852353029619, 'f1-score': 0.45174304798051496, 'support': 53208}, '1': {'precision': 0.36619871290086076, 'recall': 0.26086620113352804, 'f1-score': 0.3046857349419366, 'support': 51697}, '2': {'precision': 0.35934103932029243, 'recall': 0.2742610465993063, 'f1-score': 0.31108877865206974, 'support': 53048}, 'accuracy': 0.3688882135825214, 'macro avg': {'precision': 0.36681661474577476, 'recall': 0.36777082767859876, 'f1-score': 0.35583918719150714, 'support': 157953}, 'weighted avg': {'precision': 0.3668300981348572, 'recall': 0.3688882135825214, 'f1-score': 0.356373858465338, 'support': 157953}}
[[30232 11792 11184]
 [23456 13486 14755]
 [26950 11549 14549]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.132439
{'0': {'precision': 0.36677263203525756, 'recall': 0.530903576657603, 'f1-score': 0.43383326923898646, 'support': 19124}, '1': {'precision': 0.3490157018982892, 'recall': 0.31530196369025565, 'f1-score': 0.33130335641389286, 'support': 18893}, '2': {'precision': 0.37578764965343414, 'recall': 0.2455607596891245, 'f1-score': 0.2970272373540856, 'support': 19429}, 'accuracy': 0.3634891898478571, 'macro avg': {'precision': 0.3638586611956603, 'recall': 0.36392210001232767, 'f1-score': 0.35405462100232166, 'support': 57446}, 'weighted avg': {'precision': 0.3639816822080426, 'recall': 0.3634891898478571, 'f1-score': 0.3538433302267623, 'support': 57446}}
[[10153  5473  3498]
 [ 8509  5957  4427]
 [ 9020  5638  4771]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
4450/4450 - 40s - 40s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0641308
{'0': {'precision': 0.5752073104841552, 'recall': 0.18020400453343408, 'f1-score': 0.2744323753840981, 'support': 407638}, '1': {'precision': 0.35158545265276814, 'recall': 0.6870044970530211, 'f1-score': 0.4651321479459669, 'support': 326436}, '2': {'precision': 0.5083522508245171, 'recall': 0.46882460553960403, 'f1-score': 0.4877889645375861, 'support': 405047}, 'accuracy': 0.42806427060865354, 'macro avg': {'precision': 0.4783816713204801, 'recall': 0.44534436904201974, 'f1-score': 0.409117829289217, 'support': 1139121}, 'weighted avg': {'precision': 0.48735214309368124, 'recall': 0.42806427060865354, 'f1-score': 0.4049459181270192, 'support': 1139121}}
[[ 73458 234727  99453]
 [ 17970 224263  84203]
 [ 36279 178872 189896]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.052028
{'0': {'precision': 0.604196646698571, 'recall': 0.1401251144813027, 'f1-score': 0.22749065982875827, 'support': 128842}, '1': {'precision': 0.3858317091771884, 'recall': 0.7198336850925245, 'f1-score': 0.5023846499708987, 'support': 126507}, '2': {'precision': 0.5168435392455305, 'recall': 0.4747200123580752, 'f1-score': 0.49488703157962544, 'support': 129470}, 'accuracy': 0.44327333109851647, 'macro avg': {'precision': 0.5022906317070966, 'recall': 0.4448929373106341, 'f1-score': 0.4082541137930941, 'support': 384819}, 'weighted avg': {'precision': 0.503021029140803, 'recall': 0.44327333109851647, 'f1-score': 0.40782432906415605, 'support': 384819}}
[[18054 83630 27158]
 [ 5145 91064 30298]
 [ 6682 61326 61462]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0417348
{'0': {'precision': 0.5878441655740776, 'recall': 0.14998088502341583, 'f1-score': 0.2389872453835903, 'support': 41852}, '1': {'precision': 0.40273581630947636, 'recall': 0.7048737680572431, 'f1-score': 0.512595622826754, 'support': 44442}, '2': {'precision': 0.5110582639714626, 'recall': 0.4860121672659837, 'f1-score': 0.498220640569395, 'support': 44217}, 'accuracy': 0.45278175785949076, 'macro avg': {'precision': 0.5005460819516722, 'recall': 0.4469556067822142, 'f1-score': 0.4166011695932464, 'support': 130511}, 'weighted avg': {'precision': 0.4987955224008567, 'recall': 0.45278175785949076, 'f1-score': 0.4199852190812848, 'support': 130511}}
[[ 6277 26423  9152]
 [ 1708 31326 11408]
 [ 2693 20034 21490]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
6203/6203 - 62s - 62s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0409684
{'0': {'precision': 0.48633933388924316, 'recall': 0.26758078076831254, 'f1-score': 0.3452224079192647, 'support': 481705}, '1': {'precision': 0.4576628544926446, 'recall': 0.7028154036516882, 'f1-score': 0.5543447308198114, 'support': 609362}, '2': {'precision': 0.46146811033691665, 'recall': 0.3595359968760505, 'f1-score': 0.4041743411971815, 'support': 496807}, 'accuracy': 0.4633768170522346, 'macro avg': {'precision': 0.4684900995729348, 'recall': 0.44331072709868374, 'f1-score': 0.4345804933120858, 'support': 1587874}, 'weighted avg': {'precision': 0.4675528591453839, 'recall': 0.4633768170522346, 'f1-score': 0.4439197416140824, 'support': 1587874}}
[[128895 265171  87639]
 [ 60283 428269 120810]
 [ 75853 242334 178620]]
Evaluating performance on  train set...
1766/1766 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0563066
{'0': {'precision': 0.48258871410279863, 'recall': 0.29092149606136414, 'f1-score': 0.36300860375022037, 'support': 145101}, '1': {'precision': 0.4340241783319785, 'recall': 0.7114112829289163, 'f1-score': 0.5391306764493358, 'support': 163610}, '2': {'precision': 0.46303388862940476, 'recall': 0.311355388051368, 'f1-score': 0.37234011476265, 'support': 143280}, 'accuracy': 0.44960629747052483, 'macro avg': {'precision': 0.4598822603547273, 'recall': 0.4378960556805495, 'f1-score': 0.42482646498740206, 'support': 451991}, 'weighted avg': {'precision': 0.45881067628502836, 'recall': 0.44960629747052483, 'f1-score': 0.4297186736679028, 'support': 451991}}
[[ 42213  79631  23257]
 [ 18739 116394  28477]
 [ 26520  72149  44611]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0320796
{'0': {'precision': 0.5009626672927917, 'recall': 0.2396118772741566, 'f1-score': 0.32417156661652763, 'support': 44522}, '1': {'precision': 0.47967077102520933, 'recall': 0.7200290707277592, 'f1-score': 0.575772184835657, 'support': 60542}, '2': {'precision': 0.4381024012479804, 'recall': 0.36567615327380953, 'f1-score': 0.3986262134691912, 'support': 43008}, 'accuracy': 0.47265519477011186, 'macro avg': {'precision': 0.4729119465219938, 'recall': 0.4417723670919084, 'f1-score': 0.43285665497379194, 'support': 148072}, 'weighted avg': {'precision': 0.4739991069580409, 'recall': 0.47265519477011186, 'f1-score': 0.44866877122011156, 'support': 148072}}
[[10668 26140  7714]
 [ 4493 43592 12457]
 [ 6134 21147 15727]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
5183/5183 - 45s - 45s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.088588
{'0': {'precision': 0.3822805626180868, 'recall': 0.32337069118604606, 'f1-score': 0.350366641012485, 'support': 405448}, '1': {'precision': 0.402189694612634, 'recall': 0.4662123438054955, 'f1-score': 0.4318409950334314, 'support': 495536}, '2': {'precision': 0.39341904096675084, 'recall': 0.378266362338443, 'f1-score': 0.3856939339885791, 'support': 425856}, 'accuracy': 0.39433692080431704, 'macro avg': {'precision': 0.39262976606582384, 'recall': 0.3892831324433282, 'f1-score': 0.38930052334483184, 'support': 1326840}, 'weighted avg': {'precision': 0.39329099301489323, 'recall': 0.39433692080431704, 'f1-score': 0.3921334065394146, 'support': 1326840}}
[[131110 178575  95763]
 [111907 231025 152604]
 [ 99951 164818 161087]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0849974
{'0': {'precision': 0.43080507097193627, 'recall': 0.30730644076704877, 'f1-score': 0.35872404350630893, 'support': 129379}, '1': {'precision': 0.39002064567993716, 'recall': 0.511342132368793, 'f1-score': 0.44251658374792713, 'support': 125241}, '2': {'precision': 0.4124002632888632, 'recall': 0.40630461774498405, 'f1-score': 0.4093297480330644, 'support': 126447}, 'accuracy': 0.4072144793435275, 'macro avg': {'precision': 0.4110753266469122, 'recall': 0.40831773029360857, 'f1-score': 0.40352345842910015, 'support': 381067}, 'weighted avg': {'precision': 0.4112937647578144, 'recall': 0.4072144793435275, 'f1-score': 0.4030553580853597, 'support': 381067}}
[[39759 54109 35511]
 [23509 64041 37691]
 [29022 46049 51376]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0779113
{'0': {'precision': 0.41969772463046007, 'recall': 0.29301268523457247, 'f1-score': 0.34509600415153086, 'support': 43121}, '1': {'precision': 0.4051147786245266, 'recall': 0.5558406568734364, 'f1-score': 0.46865703932067715, 'support': 46767}, '2': {'precision': 0.4205821205821206, 'recall': 0.37756625606569616, 'f1-score': 0.3979150275373721, 'support': 42864}, 'accuracy': 0.4129052669639629, 'macro avg': {'precision': 0.41513154127903573, 'recall': 0.4088065327245684, 'f1-score': 0.4038893570031934, 'support': 132752}, 'weighted avg': {'precision': 0.41484588143572465, 'recall': 0.4129052669639629, 'f1-score': 0.40567975091366, 'support': 132752}}
[[12635 20350 10136]
 [ 8612 25995 12160]
 [ 8858 17822 16184]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023757
{'0': {'precision': 0.37592790795805014, 'recall': 0.35075200610999685, 'f1-score': 0.36290384615384613, 'support': 591817}, '1': {'precision': 0.39809220131306705, 'recall': 0.3174051586604451, 'f1-score': 0.3531991182299754, 'support': 700143}, '2': {'precision': 0.3567254752135321, 'recall': 0.46785563521671536, 'f1-score': 0.4048019574858541, 'support': 582746}, 'accuracy': 0.3746992861814066, 'macro avg': {'precision': 0.3769151948282164, 'recall': 0.3786709333290525, 'f1-score': 0.37363497395655854, 'support': 1874706}, 'weighted avg': {'precision': 0.3782365547380384, 'recall': 0.3746992861814066, 'f1-score': 0.37230332503932456, 'support': 1874706}}
[[207581 180839 203397]
 [189664 222229 288250]
 [154938 155167 272641]]
Evaluating performance on  train set...
2046/2046 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0929457
{'0': {'precision': 0.40753083863728956, 'recall': 0.34734595133058205, 'f1-score': 0.375039181822093, 'support': 175675}, '1': {'precision': 0.383430305742818, 'recall': 0.31868432065470104, 'f1-score': 0.3480720153375402, 'support': 172048}, '2': {'precision': 0.38960718536954875, 'recall': 0.5113305194030529, 'f1-score': 0.4422459919322743, 'support': 176029}, 'accuracy': 0.39304479982892665, 'macro avg': {'precision': 0.39352277658321877, 'recall': 0.39245359712944533, 'f1-score': 0.38845239636396917, 'support': 523752}, 'weighted avg': {'precision': 0.3935900207607083, 'recall': 0.39304479982892665, 'f1-score': 0.3887683905268822, 'support': 523752}}
[[61020 48631 66024]
 [42227 54829 74992]
 [46484 39536 90009]]
Evaluating performance on  val set...
741/741 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0912411
{'0': {'precision': 0.41141541665905396, 'recall': 0.35801389573429576, 'f1-score': 0.38286151491966336, 'support': 62897}, '1': {'precision': 0.38889189725817225, 'recall': 0.3342694014335805, 'f1-score': 0.3595177506153268, 'support': 64454}, '2': {'precision': 0.38583618606524367, 'recall': 0.4925689680104115, 'f1-score': 0.43271816224990295, 'support': 62239}, 'accuracy': 0.39411361358721453, 'macro avg': {'precision': 0.3953811666608233, 'recall': 0.3949507550594293, 'f1-score': 0.39169914259496436, 'support': 189590}, 'weighted avg': {'precision': 0.39536100106544364, 'recall': 0.39411361358721453, 'f1-score': 0.3912924917049108, 'support': 189590}}
[[22518 18592 21787]
 [15897 21545 27012]
 [16318 15264 30657]]
testing model on single stock: results/universal/W6/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 219s - 219s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1368004
{'0': {'precision': 0.32604622244307147, 'recall': 0.4746704929993892, 'f1-score': 0.38656498150440477, 'support': 2255946}, '1': {'precision': 0.39681170406306854, 'recall': 0.1730200858698203, 'f1-score': 0.24097074373203275, 'support': 3025510}, '2': {'precision': 0.3154387486631898, 'recall': 0.41125465288617835, 'f1-score': 0.35702994636182234, 'support': 2231948}, 'accuracy': 0.33436295985148673, 'macro avg': {'precision': 0.34609889172311, 'recall': 0.3529817439184626, 'f1-score': 0.3281885571994199, 'support': 7513404}, 'weighted avg': {'precision': 0.35139110505660565, 'recall': 0.33436295985148673, 'f1-score': 0.3191631108025091, 'support': 7513404}}
[[1070831  414229  770886]
 [1280909  523474 1221127]
 [ 932552  381497  917899]]
Evaluating performance on  train set...
5452/5452 - 39s - 39s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1254675
{'0': {'precision': 0.3717152431626109, 'recall': 0.6035091833580284, 'f1-score': 0.4600655125982953, 'support': 469055}, '1': {'precision': 0.39844185590934433, 'recall': 0.1726808051166618, 'f1-score': 0.2409403974515715, 'support': 459362}, '2': {'precision': 0.3557919621749409, 'recall': 0.33125222135152377, 'f1-score': 0.34308383837711853, 'support': 467058}, 'accuracy': 0.37056629463086044, 'macro avg': {'precision': 0.37531635374896544, 'recall': 0.3691474032754047, 'f1-score': 0.3480299161423284, 'support': 1395475}, 'weighted avg': {'precision': 0.3751836639605655, 'recall': 0.37056629463086044, 'f1-score': 0.34878084039533663, 'support': 1395475}}
[[283079  62476 123500]
 [223409  79323 156630]
 [255060  57284 154714]]
Evaluating performance on  val set...
1969/1969 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1159827
{'0': {'precision': 0.36245830443541727, 'recall': 0.5485723211496407, 'f1-score': 0.43650474045570026, 'support': 160050}, '1': {'precision': 0.44021097629706823, 'recall': 0.22006804529264792, 'f1-score': 0.29344069977210624, 'support': 188110}, '2': {'precision': 0.33896729283875277, 'recall': 0.3648165846712379, 'f1-score': 0.35141722918179147, 'support': 155903}, 'accuracy': 0.3691443331488326, 'macro avg': {'precision': 0.3805455245237461, 'recall': 0.3778189837045088, 'f1-score': 0.36045422313653264, 'support': 504063}, 'weighted avg': {'precision': 0.38420902988628425, 'recall': 0.3691443331488326, 'f1-score': 0.3567980867970761, 'support': 504063}}
[[87799 27210 45041]
 [80838 41397 65875]
 [73595 25432 56876]]
training model: results/universal/W6/deepVOL_L2/h200
Epoch 1/50
9426/9426 - 311s - loss: 3.2191 - accuracy200: 0.4025 - val_loss: 3.3319 - val_accuracy200: 0.3610 - 311s/epoch - 33ms/step
Epoch 2/50
9426/9426 - 308s - loss: 3.2062 - accuracy200: 0.4115 - val_loss: 3.3476 - val_accuracy200: 0.3620 - 308s/epoch - 33ms/step
Epoch 3/50
9426/9426 - 307s - loss: 3.1950 - accuracy200: 0.4175 - val_loss: 3.3308 - val_accuracy200: 0.3641 - 307s/epoch - 33ms/step
Epoch 4/50
9426/9426 - 309s - loss: 3.1872 - accuracy200: 0.4216 - val_loss: 3.3588 - val_accuracy200: 0.3644 - 309s/epoch - 33ms/step
Epoch 5/50
9426/9426 - 311s - loss: 3.1813 - accuracy200: 0.4243 - val_loss: 3.3809 - val_accuracy200: 0.3649 - 311s/epoch - 33ms/step
Epoch 6/50
9426/9426 - 308s - loss: 3.1767 - accuracy200: 0.4259 - val_loss: 3.4301 - val_accuracy200: 0.3635 - 308s/epoch - 33ms/step
Epoch 7/50
9426/9426 - 309s - loss: 3.1725 - accuracy200: 0.4277 - val_loss: 3.4380 - val_accuracy200: 0.3645 - 309s/epoch - 33ms/step
Epoch 8/50
9426/9426 - 307s - loss: 3.1681 - accuracy200: 0.4291 - val_loss: 3.4358 - val_accuracy200: 0.3651 - 307s/epoch - 33ms/step
Epoch 9/50
9426/9426 - 309s - loss: 3.1659 - accuracy200: 0.4302 - val_loss: 3.4521 - val_accuracy200: 0.3639 - 309s/epoch - 33ms/step
Epoch 10/50
9426/9426 - 312s - loss: 3.1631 - accuracy200: 0.4309 - val_loss: 3.4689 - val_accuracy200: 0.3648 - 312s/epoch - 33ms/step
Epoch 11/50
9426/9426 - 307s - loss: 3.1610 - accuracy200: 0.4321 - val_loss: 3.4647 - val_accuracy200: 0.3663 - 307s/epoch - 33ms/step
Epoch 12/50
9426/9426 - 310s - loss: 3.1586 - accuracy200: 0.4326 - val_loss: 3.4682 - val_accuracy200: 0.3669 - 310s/epoch - 33ms/step
Epoch 13/50
9426/9426 - 311s - loss: 3.1566 - accuracy200: 0.4337 - val_loss: 3.4661 - val_accuracy200: 0.3665 - 311s/epoch - 33ms/step
testing model in sample: results/universal/W6/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 675s - 675s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1092379
{'0': {'precision': 0.37388242548151035, 'recall': 0.006896758146537404, 'f1-score': 0.013543685026151915, 'support': 3340990}, '1': {'precision': 0.3747529698794706, 'recall': 0.9335462480832395, 'f1-score': 0.5348153147012011, 'support': 4073931}, '2': {'precision': 0.3584346854250214, 'recall': 0.06407306384683997, 'f1-score': 0.10871283910763012, 'support': 3403708}, 'accuracy': 0.3738302699907724, 'macro avg': {'precision': 0.3690233602620008, 'recall': 0.33483869002553895, 'f1-score': 0.2190239462783277, 'support': 10818629}, 'weighted avg': {'precision': 0.3693501452265478, 'recall': 0.3738302699907724, 'f1-score': 0.23977869712001915, 'support': 10818629}}
[[  23042 3176063  141885]
 [  22259 3803203  248469]
 [  16328 3169294  218086]]
Evaluating performance on  train set...
9426/9426 - 158s - 158s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1260977
{'0': {'precision': 0.41019490254872565, 'recall': 0.005074773774400091, 'f1-score': 0.010025515719222047, 'support': 808706}, '1': {'precision': 0.3295490930444822, 'recall': 0.929840082170624, 'f1-score': 0.4866294895752101, 'support': 800286}, '2': {'precision': 0.40064518366922197, 'recall': 0.07190051879527942, 'f1-score': 0.12192089107322304, 'support': 803207}, 'accuracy': 0.3341320512942755, 'macro avg': {'precision': 0.38012972642080994, 'recall': 0.33560512491343447, 'f1-score': 0.20619196545588506, 'support': 2412199}, 'weighted avg': {'precision': 0.3802595144000023, 'recall': 0.3341320512942755, 'f1-score': 0.20540518239401725, 'support': 2412199}}
[[  4104 771206  33396]
 [  3150 744138  52998]
 [  2751 742705  57751]]
Evaluating performance on  val set...
3323/3323 - 55s - 55s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1107559
{'0': {'precision': 0.3927431059506531, 'recall': 0.004973478457449741, 'f1-score': 0.009822569404111976, 'support': 272043}, '1': {'precision': 0.36118033643507447, 'recall': 0.9336350855090769, 'f1-score': 0.5208628636588831, 'support': 307979}, '2': {'precision': 0.3991604918808135, 'recall': 0.07494107940313528, 'f1-score': 0.12619033527192758, 'support': 270279}, 'accuracy': 0.3635747811657284, 'macro avg': {'precision': 0.3843613114221804, 'recall': 0.3378498811232207, 'f1-score': 0.21895858944497423, 'support': 850301}, 'weighted avg': {'precision': 0.3833509194886584, 'recall': 0.3635747811657284, 'f1-score': 0.23191032676918327, 'support': 850301}}
[[  1353 259504  11186]
 [  1136 287540  19303]
 [   956 249068  20255]]
testing model out of sample: results/universal/W6/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 282s - 282s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136621
{'0': {'precision': 0.3967317294598275, 'recall': 0.004274809160305344, 'f1-score': 0.008458477695223822, 'support': 1431175}, '1': {'precision': 0.3516093538416407, 'recall': 0.928977156557259, 'f1-score': 0.5101366523828146, 'support': 1589559}, '2': {'precision': 0.37453193230935616, 'recall': 0.06905243002467207, 'f1-score': 0.1166061847253405, 'support': 1464409}, 'accuracy': 0.35314437020179734, 'macro avg': {'precision': 0.37429100520360814, 'recall': 0.33410146524741213, 'f1-score': 0.21173377160112627, 'support': 4485143}, 'weighted avg': {'precision': 0.37349183253556134, 'recall': 0.35314437020179734, 'f1-score': 0.2215664060672954, 'support': 4485143}}
[[   6118 1364133   60924]
 [   4947 1476664  107948]
 [   4356 1358932  101121]]
Evaluating performance on  train set...
5153/5153 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1264153
{'0': {'precision': 0.42708824917413873, 'recall': 0.004027762633489178, 'f1-score': 0.00798026537689118, 'support': 449381}, '1': {'precision': 0.3217558415908684, 'recall': 0.9356704291375253, 'f1-score': 0.47884704397728045, 'support': 426227}, '2': {'precision': 0.3991562420730812, 'recall': 0.06748877557239502, 'f1-score': 0.11545635342047846, 'support': 443007}, 'accuracy': 0.3264910531125461, 'macro avg': {'precision': 0.38266677761269613, 'recall': 0.33572898911446986, 'f1-score': 0.20076122092488335, 'support': 1318615}, 'weighted avg': {'precision': 0.38365662526813676, 'recall': 0.3264910531125461, 'f1-score': 0.1962905710979952, 'support': 1318615}}
[[  1810 428697  18874]
 [  1288 398808  26131]
 [  1140 411969  29898]]
Evaluating performance on  val set...
1795/1795 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1209869
{'0': {'precision': 0.41584766584766586, 'recall': 0.004403166117083895, 'f1-score': 0.008714064139116108, 'support': 153753}, '1': {'precision': 0.330772263921586, 'recall': 0.9268547817673056, 'f1-score': 0.48754971601900426, 'support': 152956}, '2': {'precision': 0.40164649248264556, 'recall': 0.07565891065362097, 'f1-score': 0.12733204312966548, 'support': 152183}, 'accuracy': 0.3355015995048944, 'macro avg': {'precision': 0.3827554740839658, 'recall': 0.33563895284600354, 'f1-score': 0.20786527442926195, 'support': 458892}, 'weighted avg': {'precision': 0.38278112656780405, 'recall': 0.3355015995048944, 'f1-score': 0.20765504778158309, 'support': 458892}}
[[   677 146578   6498]
 [   533 141768  10655]
 [   418 140251  11514]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1327251
{'0': {'precision': 0.30985915492957744, 'recall': 0.008847616262064931, 'f1-score': 0.01720399530800128, 'support': 82056}, '1': {'precision': 0.35170499454956156, 'recall': 0.9848322739001825, 'f1-score': 0.5183101701698939, 'support': 95334}, '2': {'precision': 0.37055837563451777, 'recall': 0.007013461148414232, 'f1-score': 0.013766369827134625, 'support': 93677}, 'accuracy': 0.3514666115757359, 'macro avg': {'precision': 0.34404084170455224, 'recall': 0.33356445043688726, 'f1-score': 0.1830935117683433, 'support': 271067}, 'weighted avg': {'precision': 0.3455531057694372, 'recall': 0.3514666115757359, 'f1-score': 0.19225455340659875, 'support': 271067}}
[[  726 80833   497]
 [  827 93888   619]
 [  790 92230   657]]
Evaluating performance on  train set...
211/211 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1342747
{'0': {'precision': 0.408675799086758, 'recall': 0.009689293060517483, 'f1-score': 0.018929780033840944, 'support': 18474}, '1': {'precision': 0.32239216360199346, 'recall': 0.9697874784606548, 'f1-score': 0.4839139593872257, 'support': 17410}, '2': {'precision': 0.3826086956521739, 'recall': 0.02434301521438451, 'f1-score': 0.04577373211963589, 'support': 18075}, 'accuracy': 0.32437591504660945, 'macro avg': {'precision': 0.3712255527803085, 'recall': 0.3346065955785189, 'f1-score': 0.1828724905135675, 'support': 53959}, 'weighted avg': {'precision': 0.37210430983807186, 'recall': 0.32437591504660945, 'f1-score': 0.17795012875218583, 'support': 53959}}
[[  179 17958   337]
 [  153 16884   373]
 [  106 17529   440]]
Evaluating performance on  val set...
81/81 - 1s - 767ms/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1365316
{'0': {'precision': 0.36065573770491804, 'recall': 0.009388335704125178, 'f1-score': 0.018300291140995423, 'support': 7030}, '1': {'precision': 0.3166733911640105, 'recall': 0.9624463519313304, 'f1-score': 0.47654826958105645, 'support': 6524}, '2': {'precision': 0.4424920127795527, 'recall': 0.039107722716363126, 'f1-score': 0.07186405500064859, 'support': 7083}, 'accuracy': 0.3208799728642729, 'macro avg': {'precision': 0.37327371388282704, 'recall': 0.33698080345060627, 'f1-score': 0.18890420524090015, 'support': 20637}, 'weighted avg': {'precision': 0.37483926765213693, 'recall': 0.3208799728642729, 'f1-score': 0.1815508581207348, 'support': 20637}}
[[  66 6809  155]
 [  51 6279  194]
 [  66 6740  277]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1450088
{'0': {'precision': 0.5547558840692473, 'recall': 0.014221601675476214, 'f1-score': 0.027732265012324904, 'support': 200540}, '1': {'precision': 0.271397092896795, 'recall': 0.9455243944226258, 'f1-score': 0.42174055530000987, 'support': 151756}, '2': {'precision': 0.49425559635200755, 'recall': 0.060513633573248134, 'f1-score': 0.10782574243781438, 'support': 206879}, 'accuracy': 0.28409710734564314, 'macro avg': {'precision': 0.44013619110601665, 'recall': 0.3400865432237834, 'f1-score': 0.18576618758338304, 'support': 559175}, 'weighted avg': {'precision': 0.45547098088898796, 'recall': 0.28409710734564314, 'f1-score': 0.1642955602547906, 'support': 559175}}
[[  2852 191821   5867]
 [  1324 143489   6943]
 [   965 193395  12519]]
Evaluating performance on  train set...
533/533 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916324
{'0': {'precision': 0.5513888888888889, 'recall': 0.017204394270980045, 'f1-score': 0.03336765354793974, 'support': 46151}, '1': {'precision': 0.3448982532541347, 'recall': 0.923657412370029, 'f1-score': 0.5022528167495321, 'support': 46645}, '2': {'precision': 0.5007059298104074, 'recall': 0.11419568517411105, 'f1-score': 0.18597595235419712, 'support': 43478}, 'accuracy': 0.35841759983562527, 'macro avg': {'precision': 0.4656643573178103, 'recall': 0.35168583060504005, 'f1-score': 0.24053214088388963, 'support': 136274}, 'weighted avg': {'precision': 0.4645392374953925, 'recall': 0.35841759983562527, 'f1-score': 0.24255100512664687, 'support': 136274}}
[[  794 43487  1870]
 [  480 43084  3081]
 [  166 38347  4965]]
Evaluating performance on  val set...
189/189 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108077
{'0': {'precision': 0.5, 'recall': 0.010497900419916016, 'f1-score': 0.020564042303172735, 'support': 16670}, '1': {'precision': 0.3492343934040047, 'recall': 0.9149605364666785, 'f1-score': 0.5055164838767848, 'support': 16851}, '2': {'precision': 0.38903887688984884, 'recall': 0.09815407669777264, 'f1-score': 0.1567582268153386, 'support': 14681}, 'accuracy': 0.35338782623127674, 'macro avg': {'precision': 0.41275775676461784, 'recall': 0.3412041711947891, 'f1-score': 0.22761291766509872, 'support': 48202}, 'weighted avg': {'precision': 0.41349795682483614, 'recall': 0.35338782623127674, 'f1-score': 0.23158019133806845, 'support': 48202}}
[[  175 15553   942]
 [  112 15418  1321]
 [   63 13177  1441]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1707942
{'0': {'precision': 0.5412445730824892, 'recall': 0.0031850659581172344, 'f1-score': 0.006332864859373149, 'support': 117423}, '1': {'precision': 0.2474871756366106, 'recall': 0.9442657533889808, 'f1-score': 0.39218475350874826, 'support': 76793}, '2': {'precision': 0.45040860720794873, 'recall': 0.06577038315261717, 'f1-score': 0.11478013334332161, 'support': 116481}, 'accuracy': 0.25924936513709496, 'macro avg': {'precision': 0.41304678530901623, 'recall': 0.33774040083323836, 'f1-score': 0.171099250570481, 'support': 310697}, 'weighted avg': {'precision': 0.43458382012029867, 'recall': 0.25924936513709496, 'f1-score': 0.14235854378556254, 'support': 310697}}
[[   374 111878   5171]
 [   103  72513   4177]
 [   214 108606   7661]]
Evaluating performance on  train set...
512/512 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1310538
{'0': {'precision': 0.44212962962962965, 'recall': 0.004240110109665675, 'f1-score': 0.00839966577246141, 'support': 45046}, '1': {'precision': 0.327315743042746, 'recall': 0.9491174623845957, 'f1-score': 0.4867643463274714, 'support': 43001}, '2': {'precision': 0.36519355943816373, 'recall': 0.049681914571342016, 'f1-score': 0.08746487251543557, 'support': 42913}, 'accuracy': 0.3293830177153329, 'macro avg': {'precision': 0.37821297737017984, 'recall': 0.3343464956885345, 'f1-score': 0.1942096282051228, 'support': 130960}, 'weighted avg': {'precision': 0.3792198135235747, 'recall': 0.3293830177153329, 'f1-score': 0.19137984938201572, 'support': 130960}}
[[  191 43185  1670]
 [  152 40813  2036]
 [   89 40692  2132]]
Evaluating performance on  val set...
169/169 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.150136
{'0': {'precision': 0.42783505154639173, 'recall': 0.0054847023062181985, 'f1-score': 0.010830560448881059, 'support': 15133}, '1': {'precision': 0.2944936800813599, 'recall': 0.9590726283416134, 'f1-score': 0.450619685433224, 'support': 12681}, '2': {'precision': 0.3933534743202417, 'recall': 0.042457444727059285, 'f1-score': 0.07664233576642336, 'support': 15333}, 'accuracy': 0.29888520638746613, 'macro avg': {'precision': 0.3718940686493311, 'recall': 0.33567159179163036, 'f1-score': 0.17936419388284278, 'support': 43147}, 'weighted avg': {'precision': 0.3763921249198215, 'recall': 0.29888520638746613, 'f1-score': 0.16347287265761698, 'support': 43147}}
[[   83 14523   527]
 [   42 12162   477]
 [   69 14613   651]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 9s - 9s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.2018292
{'0': {'precision': 0.336734693877551, 'recall': 0.0030115289846989993, 'f1-score': 0.0059696692562033315, 'support': 98621}, '1': {'precision': 0.2618839416267668, 'recall': 0.9966720314247525, 'f1-score': 0.41478075776926354, 'support': 73318}, '2': {'precision': 0.36, 'recall': 0.0005825242718446602, 'f1-score': 0.0011631663974151858, 'support': 108150}, 'accuracy': 0.2621809496267258, 'macro avg': {'precision': 0.31953954516810595, 'recall': 0.3334220282270987, 'f1-score': 0.14063786447429402, 'support': 280089}, 'weighted avg': {'precision': 0.32612462137780934, 'recall': 0.2621809496267258, 'f1-score': 0.11112691607211758, 'support': 280089}}
[[   297  98250     74]
 [   206  73074     38]
 [   379 107708     63]]
Evaluating performance on  train set...
448/448 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1586356
{'0': {'precision': 0.29304029304029305, 'recall': 0.0021136621839414516, 'f1-score': 0.0041970515712711825, 'support': 37849}, '1': {'precision': 0.33079428451355325, 'recall': 0.9973865526253267, 'f1-score': 0.49681453283102234, 'support': 37881}, '2': {'precision': 0.37333333333333335, 'recall': 0.0007210176649327908, 'f1-score': 0.001439255699195559, 'support': 38834}, 'accuracy': 0.3307321671729339, 'macro avg': {'precision': 0.3323893036290599, 'recall': 0.33340707749140036, 'f1-score': 0.16748361336716303, 'support': 114564}, 'weighted avg': {'precision': 0.3327408872735469, 'recall': 0.3307321671729339, 'f1-score': 0.16614798347574775, 'support': 114564}}
[[   80 37744    25]
 [   77 37782    22]
 [  116 38690    28]]
Evaluating performance on  val set...
136/136 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1854665
{'0': {'precision': 0.3706896551724138, 'recall': 0.0036871891613788374, 'f1-score': 0.007301749023603329, 'support': 11662}, '1': {'precision': 0.29508054737571454, 'recall': 0.9968789622549498, 'f1-score': 0.45536967320843824, 'support': 10253}, '2': {'precision': 0.3684210526315789, 'recall': 0.0005444081505677399, 'f1-score': 0.0010872097538246488, 'support': 12858}, 'accuracy': 0.2953728467489144, 'macro avg': {'precision': 0.34473041839323576, 'recall': 0.3337035198556321, 'f1-score': 0.1545862106619554, 'support': 34773}, 'weighted avg': {'precision': 0.34755705592271974, 'recall': 0.2953728467489144, 'f1-score': 0.13711896009933158, 'support': 34773}}
[[   43 11611     8]
 [   28 10221     4]
 [   45 12806     7]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1561133
{'0': {'precision': 0.4188235294117647, 'recall': 0.005824683569156664, 'f1-score': 0.011489578693931824, 'support': 152798}, '1': {'precision': 0.28708247475428744, 'recall': 0.9670792854904419, 'f1-score': 0.4427363731900562, 'support': 127640}, '2': {'precision': 0.3525287356321839, 'recall': 0.01912559786980625, 'f1-score': 0.03628276184335831, 'support': 160361}, 'accuracy': 0.2890092763368338, 'macro avg': {'precision': 0.35281157993274537, 'recall': 0.3306765223098016, 'f1-score': 0.16350290457578212, 'support': 440799}, 'weighted avg': {'precision': 0.35655812581110374, 'recall': 0.2890092763368338, 'f1-score': 0.14538325924336706, 'support': 440799}}
[[   890 149929   1979]
 [   548 123438   3654]
 [   687 156607   3067]]
Evaluating performance on  train set...
618/618 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1325864
{'0': {'precision': 0.30851063829787234, 'recall': 0.002726588943211734, 'f1-score': 0.005405405405405405, 'support': 53180}, '1': {'precision': 0.3271863649063984, 'recall': 0.9655972539168121, 'f1-score': 0.4887596823979344, 'support': 52147}, '2': {'precision': 0.3031232571109872, 'recall': 0.02065518945008171, 'f1-score': 0.038675016010816195, 'support': 52626}, 'accuracy': 0.3265844903230708, 'macro avg': {'precision': 0.31294008677175267, 'recall': 0.3296596774367018, 'f1-score': 0.17761336793805202, 'support': 157953}, 'weighted avg': {'precision': 0.31288134852885113, 'recall': 0.3265844903230708, 'f1-score': 0.17606580444847364, 'support': 157953}}
[[  145 52159   876]
 [  171 50353  1623]
 [  154 51385  1087]]
Evaluating performance on  val set...
225/225 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1324371
{'0': {'precision': 0.38275862068965516, 'recall': 0.005840568271507498, 'f1-score': 0.011505571391552215, 'support': 19005}, '1': {'precision': 0.32841209116870523, 'recall': 0.9637887413029728, 'f1-score': 0.48989269782582484, 'support': 18972}, '2': {'precision': 0.35496957403651114, 'recall': 0.02696594586265345, 'f1-score': 0.050124116860798165, 'support': 19469}, 'accuracy': 0.3293701911360234, 'macro avg': {'precision': 0.35538009529829045, 'recall': 0.3321984184790446, 'f1-score': 0.18384079535939177, 'support': 57446}, 'weighted avg': {'precision': 0.3553922712943705, 'recall': 0.3293701911360234, 'f1-score': 0.18258493330450995, 'support': 57446}}
[[  111 18529   365]
 [   98 18285   589]
 [   81 18863   525]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
4450/4450 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1108446
{'0': {'precision': 0.5419047619047619, 'recall': 0.00448726374175232, 'f1-score': 0.008900823860673689, 'support': 380410}, '1': {'precision': 0.33427751434988767, 'recall': 0.8315046170559478, 'f1-score': 0.47685290256547186, 'support': 386610}, '2': {'precision': 0.4185012421754422, 'recall': 0.19602473521973873, 'f1-score': 0.26699146400386536, 'support': 372101}, 'accuracy': 0.3477382999698891, 'macro avg': {'precision': 0.4315611728100306, 'recall': 0.3440055386724796, 'f1-score': 0.2509150634766703, 'support': 1139121}, 'weighted avg': {'precision': 0.4311269399947194, 'recall': 0.3477382999698891, 'f1-score': 0.252027531590567, 'support': 1139121}}
[[  1707 341475  37228]
 [  1020 321468  64122]
 [   423 298737  72941]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1140538
{'0': {'precision': 0.5714285714285714, 'recall': 0.0029702740541920312, 'f1-score': 0.005909828938154563, 'support': 129281}, '1': {'precision': 0.3255864342910975, 'recall': 0.8251402650113405, 'f1-score': 0.4669301178775289, 'support': 125655}, '2': {'precision': 0.45014232004505533, 'recall': 0.22768953596698568, 'f1-score': 0.30241333469679926, 'support': 129883}, 'accuracy': 0.34728014988864897, 'macro avg': {'precision': 0.44905244192157473, 'recall': 0.3519333583441728, 'f1-score': 0.25841776050416093, 'support': 384819}, 'weighted avg': {'precision': 0.45021751914047103, 'recall': 0.34728014988864897, 'f1-score': 0.25652185496890445, 'support': 384819}}
[[   384 114545  14352]
 [   200 103683  21772]
 [    88 100222  29573]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0900518
{'0': {'precision': 0.5526315789473685, 'recall': 0.004204204204204204, 'f1-score': 0.008344923504867872, 'support': 39960}, '1': {'precision': 0.3619631338099351, 'recall': 0.8378568086102012, 'f1-score': 0.5055313141683778, 'support': 47014}, '2': {'precision': 0.46012815116224687, 'recall': 0.2259687162643269, 'f1-score': 0.3030900520656829, 'support': 43537}, 'accuracy': 0.3784891694952916, 'macro avg': {'precision': 0.4582409546398501, 'recall': 0.35600990969291074, 'f1-score': 0.27232209657964285, 'support': 130511}, 'weighted avg': {'precision': 0.45308895024042317, 'recall': 0.3784891694952916, 'f1-score': 0.28577011856740253, 'support': 130511}}
[[  168 35775  4017]
 [   97 39391  7526]
 [   39 33660  9838]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
6203/6203 - 47s - 47s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027128
{'0': {'precision': 0.4015202026936925, 'recall': 0.006031940638171707, 'f1-score': 0.01188533083337445, 'support': 499176}, '1': {'precision': 0.35194953276684005, 'recall': 0.9061944990907368, 'f1-score': 0.5069923990816486, 'support': 564743}, '2': {'precision': 0.3980820854746878, 'recall': 0.09594526247483086, 'f1-score': 0.1546233840532236, 'support': 523955}, 'accuracy': 0.35585254245613945, 'macro avg': {'precision': 0.3838506069784067, 'recall': 0.3360572340679131, 'f1-score': 0.2245003713227489, 'support': 1587874}, 'weighted avg': {'precision': 0.382755421889936, 'recall': 0.35585254245613945, 'f1-score': 0.2350746819522549, 'support': 1587874}}
[[  3011 470498  25667]
 [  2631 511767  50345]
 [  1857 471827  50271]]
Evaluating performance on  train set...
1766/1766 - 15s - 15s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1256486
{'0': {'precision': 0.4644995722840034, 'recall': 0.0068770303387222405, 'f1-score': 0.013553399269913577, 'support': 157917}, '1': {'precision': 0.31157336113151224, 'recall': 0.9276041078885001, 'f1-score': 0.4664654368236425, 'support': 141776}, '2': {'precision': 0.4136705003083844, 'recall': 0.07486638038582254, 'f1-score': 0.12678679647060787, 'support': 152298}, 'accuracy': 0.3185904144109064, 'macro avg': {'precision': 0.3965811445746334, 'recall': 0.336449172871015, 'f1-score': 0.20226854418805465, 'support': 451991}, 'weighted avg': {'precision': 0.39940439889316504, 'recall': 0.3185904144109064, 'f1-score': 0.19377220221751387, 'support': 451991}}
[[  1086 150296   6535]
 [   638 131512   9626]
 [   614 140282  11402]]
Evaluating performance on  val set...
579/579 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097773
{'0': {'precision': 0.42658730158730157, 'recall': 0.004341066488985806, 'f1-score': 0.00859467130379165, 'support': 49527}, '1': {'precision': 0.33826644741715184, 'recall': 0.9000394166338195, 'f1-score': 0.4917252592249632, 'support': 50740}, '2': {'precision': 0.40574749243750996, 'recall': 0.1066206463759021, 'f1-score': 0.1688670962612023, 'support': 47805}, 'accuracy': 0.3442919660705603, 'macro avg': {'precision': 0.3902004138139878, 'recall': 0.3370003764995691, 'f1-score': 0.22306234226331903, 'support': 148072}, 'weighted avg': {'precision': 0.38959416840209987, 'recall': 0.3442919660705603, 'f1-score': 0.22589348070873833, 'support': 148072}}
[[  215 46747  2565]
 [  172 45668  4900]
 [  117 42591  5097]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
5183/5183 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.134915
{'0': {'precision': 0.41677865233250144, 'recall': 0.004841194979072034, 'f1-score': 0.009571213176619964, 'support': 448443}, '1': {'precision': 0.29483174243649896, 'recall': 0.9277801253430132, 'f1-score': 0.44746667059535605, 'support': 392842}, '2': {'precision': 0.4450492210087673, 'recall': 0.07830420858605101, 'f1-score': 0.13317664531179396, 'support': 485555}, 'accuracy': 0.3049825148473064, 'macro avg': {'precision': 0.3855532052592559, 'recall': 0.33697517630271207, 'f1-score': 0.19673817636125665, 'support': 1326840}, 'weighted avg': {'precision': 0.3910189887681221, 'recall': 0.3049825148473064, 'f1-score': 0.18445361262469626, 'support': 1326840}}
[[  2171 425407  20865]
 [  1826 364471  26545]
 [  1212 446322  38021]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234777
{'0': {'precision': 0.4368029739776952, 'recall': 0.0018121250443392297, 'f1-score': 0.0036092766088158495, 'support': 129682}, '1': {'precision': 0.3292335573766327, 'recall': 0.9304496282349938, 'f1-score': 0.48636870692980533, 'support': 125348}, '2': {'precision': 0.4146564188417929, 'recall': 0.08646667248506391, 'f1-score': 0.1430944268279072, 'support': 126037}, 'accuracy': 0.33527699853306636, 'macro avg': {'precision': 0.39356431673204023, 'recall': 0.3395761419214656, 'f1-score': 0.2110241367888428, 'support': 381067}, 'weighted avg': {'precision': 0.3940942203942736, 'recall': 0.33527699853306636, 'f1-score': 0.2085423171241032, 'support': 381067}}
[[   235 122636   6811]
 [   145 116630   8573]
 [   158 114981  10898]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200501
{'0': {'precision': 0.39730639730639733, 'recall': 0.0026592148555460403, 'f1-score': 0.005283069552953818, 'support': 44374}, '1': {'precision': 0.3335341038580498, 'recall': 0.9278808051989221, 'f1-score': 0.4906869113834622, 'support': 44163}, '2': {'precision': 0.42605523710265764, 'recall': 0.0924573108673527, 'f1-score': 0.1519420182122282, 'support': 44215}, 'accuracy': 0.34036398698324694, 'macro avg': {'precision': 0.3856319127557016, 'recall': 0.3409991103072736, 'f1-score': 0.2159706663828814, 'support': 132752}, 'weighted avg': {'precision': 0.38566630266399854, 'recall': 0.34036398698324694, 'f1-score': 0.21561071269001053, 'support': 132752}}
[[  118 41818  2438]
 [  116 40978  3069]
 [   63 40064  4088]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 65s - 65s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100714
{'0': {'precision': 0.40419480981158906, 'recall': 0.0019612848917239644, 'f1-score': 0.0039036281081823413, 'support': 579722}, '1': {'precision': 0.3845895763839522, 'recall': 0.9312018911825269, 'f1-score': 0.5443575972113209, 'support': 725049}, '2': {'precision': 0.3408514625110666, 'recall': 0.0695781097844491, 'f1-score': 0.11556574905723062, 'support': 569935}, 'accuracy': 0.38190468265424016, 'macro avg': {'precision': 0.3765452829022026, 'recall': 0.3342470952862333, 'f1-score': 0.22127565812557795, 'support': 1874706}, 'weighted avg': {'precision': 0.3773552170780095, 'recall': 0.38190468265424016, 'f1-score': 0.24687279807262336, 'support': 1874706}}
[[  1137 550987  27598]
 [   794 675167  49088]
 [   882 529398  39655]]
Evaluating performance on  train set...
2046/2046 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1232044
{'0': {'precision': 0.42668621700879766, 'recall': 0.00166510265272024, 'f1-score': 0.0033172600116275095, 'support': 174764}, '1': {'precision': 0.32693356942113877, 'recall': 0.9237723467505948, 'f1-score': 0.482946769101626, 'support': 171893}, '2': {'precision': 0.40355852842809364, 'recall': 0.085168977102685, 'f1-score': 0.14065370448081319, 'support': 177095}, 'accuracy': 0.3325314270876293, 'macro avg': {'precision': 0.38572610495267673, 'recall': 0.3368688088353333, 'f1-score': 0.2089725778646889, 'support': 523752}, 'weighted avg': {'precision': 0.3861277468531033, 'recall': 0.3325314270876293, 'f1-score': 0.2071667018071291, 'support': 523752}}
[[   291 165107   9366]
 [   177 158790  12926]
 [   214 161798  15083]]
Evaluating performance on  val set...
741/741 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1179193
{'0': {'precision': 0.44017094017094016, 'recall': 0.00326683370864918, 'f1-score': 0.006485533482353681, 'support': 63058}, '1': {'precision': 0.3364727044409374, 'recall': 0.9288714689486094, 'f1-score': 0.4939998172954748, 'support': 64039}, '2': {'precision': 0.40186461289014996, 'recall': 0.07932088393900116, 'f1-score': 0.13249051157320788, 'support': 62493}, 'accuracy': 0.34098317421804947, 'macro avg': {'precision': 0.3928360858340092, 'recall': 0.33715306219875324, 'f1-score': 0.21099195411701213, 'support': 189590}, 'weighted avg': {'precision': 0.39251753741408557, 'recall': 0.34098317421804947, 'f1-score': 0.21269027169080465, 'support': 189590}}
[[  206 59885  2967]
 [  144 59484  4411]
 [  118 57418  4957]]
testing model on single stock: results/universal/W6/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 235s - 235s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983498
{'0': {'precision': 0.3394844880856647, 'recall': 0.007249061896739956, 'f1-score': 0.01419501555151467, 'support': 2212976}, '1': {'precision': 0.4061848802650907, 'recall': 0.9452063184884367, 'f1-score': 0.5681974481632767, 'support': 3069405}, '2': {'precision': 0.29421273544375004, 'recall': 0.04266607740036746, 'f1-score': 0.07452474221598154, 'support': 2231023}, 'accuracy': 0.4009437000858732, 'macro avg': {'precision': 0.3466273679315018, 'recall': 0.33170715259518135, 'f1-score': 0.21897240197692427, 'support': 7513404}, 'weighted avg': {'precision': 0.3532902405599186, 'recall': 0.4009437000858732, 'f1-score': 0.2584324935898105, 'support': 7513404}}
[[  16042 2118833   78101]
 [  17936 2901221  150248]
 [  13276 2122558   95189]]
Evaluating performance on  train set...
5452/5452 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1309417
{'0': {'precision': 0.3590002889338342, 'recall': 0.005335560598871051, 'f1-score': 0.010514846667301367, 'support': 465743}, '1': {'precision': 0.3289840395456089, 'recall': 0.9527043164492413, 'f1-score': 0.48908069274722943, 'support': 464757}, '2': {'precision': 0.2899868741796362, 'recall': 0.0266078821442013, 'f1-score': 0.048743299864667605, 'support': 464975}, 'accuracy': 0.32794066536483996, 'macro avg': {'precision': 0.3259904008863598, 'recall': 0.3282159197307712, 'f1-score': 0.18277961309306612, 'support': 1395475}, 'weighted avg': {'precision': 0.3260081002222796, 'recall': 0.32794066536483996, 'f1-score': 0.18263695702543356, 'support': 1395475}}
[[  2485 452764  10494]
 [  2183 442776  19798]
 [  2254 450349  12372]]
Evaluating performance on  val set...
1969/1969 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1085297
{'0': {'precision': 0.3672075149444919, 'recall': 0.005396010716728261, 'f1-score': 0.010635732350558686, 'support': 159377}, '1': {'precision': 0.37409008259527493, 'recall': 0.9576590159094982, 'f1-score': 0.5380153675522235, 'support': 189698}, '2': {'precision': 0.3104968944099379, 'recall': 0.03225410999561256, 'f1-score': 0.05843776302253811, 'support': 154988}, 'accuracy': 0.37202690933474586, 'macro avg': {'precision': 0.3505981639832349, 'recall': 0.33176971220727963, 'f1-score': 0.2023629543084401, 'support': 504063}, 'weighted avg': {'precision': 0.3523604495237187, 'recall': 0.37202690933474586, 'f1-score': 0.2238067113120658, 'support': 504063}}
[[   860 154657   3860]
 [   791 181666   7241]
 [   691 149298   4999]]
training model: results/universal/W6/deepVOL_L3/h50
Epoch 1/50
9426/9426 - 543s - loss: 3.0871 - accuracy50: 0.4578 - val_loss: 3.2307 - val_accuracy50: 0.4400 - 543s/epoch - 58ms/step
Epoch 2/50
9426/9426 - 531s - loss: 2.9826 - accuracy50: 0.4915 - val_loss: 3.2820 - val_accuracy50: 0.4525 - 531s/epoch - 56ms/step
Epoch 3/50
9426/9426 - 537s - loss: 2.9565 - accuracy50: 0.4985 - val_loss: 3.2821 - val_accuracy50: 0.4583 - 537s/epoch - 57ms/step
Epoch 4/50
9426/9426 - 532s - loss: 2.9410 - accuracy50: 0.5029 - val_loss: 3.2377 - val_accuracy50: 0.4606 - 532s/epoch - 56ms/step
Epoch 5/50
9426/9426 - 538s - loss: 2.9289 - accuracy50: 0.5063 - val_loss: 3.2597 - val_accuracy50: 0.4621 - 538s/epoch - 57ms/step
Epoch 6/50
9426/9426 - 534s - loss: 2.9188 - accuracy50: 0.5090 - val_loss: 3.2292 - val_accuracy50: 0.4627 - 534s/epoch - 57ms/step
Epoch 7/50
9426/9426 - 545s - loss: 2.9120 - accuracy50: 0.5105 - val_loss: 3.2505 - val_accuracy50: 0.4647 - 545s/epoch - 58ms/step
Epoch 8/50
9426/9426 - 534s - loss: 2.9060 - accuracy50: 0.5125 - val_loss: 3.2629 - val_accuracy50: 0.4596 - 534s/epoch - 57ms/step
Epoch 9/50
9426/9426 - 546s - loss: 2.9018 - accuracy50: 0.5132 - val_loss: 3.2383 - val_accuracy50: 0.4628 - 546s/epoch - 58ms/step
Epoch 10/50
9426/9426 - 540s - loss: 2.8982 - accuracy50: 0.5145 - val_loss: 3.2262 - val_accuracy50: 0.4657 - 540s/epoch - 57ms/step
Epoch 11/50
9426/9426 - 533s - loss: 2.8945 - accuracy50: 0.5153 - val_loss: 3.2420 - val_accuracy50: 0.4623 - 533s/epoch - 57ms/step
Epoch 12/50
9426/9426 - 527s - loss: 2.8918 - accuracy50: 0.5160 - val_loss: 3.2205 - val_accuracy50: 0.4613 - 527s/epoch - 56ms/step
Epoch 13/50
9426/9426 - 525s - loss: 2.8902 - accuracy50: 0.5166 - val_loss: 3.2093 - val_accuracy50: 0.4638 - 525s/epoch - 56ms/step
Epoch 14/50
9426/9426 - 527s - loss: 2.8878 - accuracy50: 0.5173 - val_loss: 3.2102 - val_accuracy50: 0.4626 - 527s/epoch - 56ms/step
Epoch 15/50
9426/9426 - 537s - loss: 2.8855 - accuracy50: 0.5177 - val_loss: 3.2275 - val_accuracy50: 0.4619 - 537s/epoch - 57ms/step
Epoch 16/50
9426/9426 - 532s - loss: 2.8840 - accuracy50: 0.5182 - val_loss: 3.2048 - val_accuracy50: 0.4619 - 532s/epoch - 56ms/step
Epoch 17/50
9426/9426 - 546s - loss: 2.8821 - accuracy50: 0.5185 - val_loss: 3.1815 - val_accuracy50: 0.4638 - 546s/epoch - 58ms/step
Epoch 18/50
9426/9426 - 553s - loss: 2.8801 - accuracy50: 0.5191 - val_loss: 3.1853 - val_accuracy50: 0.4628 - 553s/epoch - 59ms/step
Epoch 19/50
9426/9426 - 555s - loss: 2.8785 - accuracy50: 0.5195 - val_loss: 3.1789 - val_accuracy50: 0.4632 - 555s/epoch - 59ms/step
Epoch 20/50
9426/9426 - 546s - loss: 2.8768 - accuracy50: 0.5201 - val_loss: 3.1870 - val_accuracy50: 0.4623 - 546s/epoch - 58ms/step
Epoch 21/50
9426/9426 - 539s - loss: 2.8753 - accuracy50: 0.5204 - val_loss: 3.1774 - val_accuracy50: 0.4621 - 539s/epoch - 57ms/step
Epoch 22/50
9426/9426 - 540s - loss: 2.8740 - accuracy50: 0.5207 - val_loss: 3.1819 - val_accuracy50: 0.4615 - 540s/epoch - 57ms/step
Epoch 23/50
9426/9426 - 539s - loss: 2.8725 - accuracy50: 0.5209 - val_loss: 3.2087 - val_accuracy50: 0.4610 - 539s/epoch - 57ms/step
Epoch 24/50
9426/9426 - 538s - loss: 2.8715 - accuracy50: 0.5217 - val_loss: 3.1928 - val_accuracy50: 0.4604 - 538s/epoch - 57ms/step
Epoch 25/50
9426/9426 - 540s - loss: 2.8700 - accuracy50: 0.5218 - val_loss: 3.1742 - val_accuracy50: 0.4604 - 540s/epoch - 57ms/step
Epoch 26/50
9426/9426 - 528s - loss: 2.8684 - accuracy50: 0.5223 - val_loss: 3.1874 - val_accuracy50: 0.4611 - 528s/epoch - 56ms/step
Epoch 27/50
9426/9426 - 530s - loss: 2.8672 - accuracy50: 0.5227 - val_loss: 3.1880 - val_accuracy50: 0.4608 - 530s/epoch - 56ms/step
Epoch 28/50
9426/9426 - 529s - loss: 2.8665 - accuracy50: 0.5229 - val_loss: 3.1607 - val_accuracy50: 0.4635 - 529s/epoch - 56ms/step
Epoch 29/50
9426/9426 - 528s - loss: 2.8653 - accuracy50: 0.5231 - val_loss: 3.1948 - val_accuracy50: 0.4609 - 528s/epoch - 56ms/step
Epoch 30/50
9426/9426 - 535s - loss: 2.8639 - accuracy50: 0.5234 - val_loss: 3.1755 - val_accuracy50: 0.4618 - 535s/epoch - 57ms/step
Epoch 31/50
9426/9426 - 529s - loss: 2.8631 - accuracy50: 0.5238 - val_loss: 3.1791 - val_accuracy50: 0.4616 - 529s/epoch - 56ms/step
Epoch 32/50
9426/9426 - 531s - loss: 2.8615 - accuracy50: 0.5243 - val_loss: 3.1747 - val_accuracy50: 0.4617 - 531s/epoch - 56ms/step
Epoch 33/50
9426/9426 - 555s - loss: 2.8607 - accuracy50: 0.5243 - val_loss: 3.1725 - val_accuracy50: 0.4631 - 555s/epoch - 59ms/step
Epoch 34/50
9426/9426 - 551s - loss: 2.8594 - accuracy50: 0.5248 - val_loss: 3.1847 - val_accuracy50: 0.4613 - 551s/epoch - 58ms/step
Epoch 35/50
9426/9426 - 543s - loss: 2.8582 - accuracy50: 0.5251 - val_loss: 3.1757 - val_accuracy50: 0.4628 - 543s/epoch - 58ms/step
Epoch 36/50
9426/9426 - 546s - loss: 2.8572 - accuracy50: 0.5255 - val_loss: 3.1880 - val_accuracy50: 0.4609 - 546s/epoch - 58ms/step
Epoch 37/50
9426/9426 - 531s - loss: 2.8560 - accuracy50: 0.5258 - val_loss: 3.1817 - val_accuracy50: 0.4603 - 531s/epoch - 56ms/step
Epoch 38/50
9426/9426 - 533s - loss: 2.8552 - accuracy50: 0.5258 - val_loss: 3.2089 - val_accuracy50: 0.4596 - 533s/epoch - 57ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1308s - 1308s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1441519
{'0': {'precision': 0.3810766651335964, 'recall': 0.5220974549048982, 'f1-score': 0.4405776307705029, 'support': 3245419}, '1': {'precision': 0.5220642645897167, 'recall': 0.2888116100060599, 'f1-score': 0.3718897688451985, 'support': 4343288}, '2': {'precision': 0.3918412076201801, 'recall': 0.48155899739993724, 'f1-score': 0.43209208790421183, 'support': 3229922}, 'accuracy': 0.41633879856680545, 'macro avg': {'precision': 0.43166071244783105, 'recall': 0.43082268743696517, 'f1-score': 0.4148531625066377, 'support': 10818629}, 'weighted avg': {'precision': 0.44089185811820886, 'recall': 0.41633879856680545, 'f1-score': 0.4104685653767633, 'support': 10818629}}
[[1694425  608491  942503]
 [1617337 1254392 1471559]
 [1134653  539871 1555398]]
Evaluating performance on  train set...
9426/9426 - 305s - 305s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602533
{'0': {'precision': 0.4248315242497974, 'recall': 0.512895565900221, 'f1-score': 0.46472839983218234, 'support': 765612}, '1': {'precision': 0.5763159211865396, 'recall': 0.39056108431528175, 'f1-score': 0.46559504426305515, 'support': 884466}, '2': {'precision': 0.4358519829103695, 'recall': 0.5081227259188501, 'f1-score': 0.4692208288678205, 'support': 762121}, 'accuracy': 0.46653199010529395, 'macro avg': {'precision': 0.47899980944890225, 'recall': 0.470526458711451, 'f1-score': 0.4665147576543527, 'support': 2412199}, 'weighted avg': {'precision': 0.4838572188943548, 'recall': 0.46653199010529395, 'f1-score': 0.4664655251863782, 'support': 2412199}}
[[392679 138489 234444]
 [272231 345438 266797]
 [259407 115463 387251]]
Evaluating performance on  val set...
3323/3323 - 106s - 106s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0675346
{'0': {'precision': 0.41962067939421466, 'recall': 0.5112932896715443, 'f1-score': 0.4609432121788707, 'support': 262014}, '1': {'precision': 0.5839913560434751, 'recall': 0.388079642746778, 'f1-score': 0.4662934232223917, 'support': 330074}, '2': {'precision': 0.42403962759302155, 'recall': 0.5118797272019612, 'f1-score': 0.46383758981602524, 'support': 258213}, 'accuracy': 0.46364169864553845, 'macro avg': {'precision': 0.47588388767690376, 'recall': 0.47041755320676115, 'f1-score': 0.46369140840576256, 'support': 850301}, 'weighted avg': {'precision': 0.48476880528797056, 'recall': 0.46364169864553845, 'f1-score': 0.4638990260527832, 'support': 850301}}
[[133966  49054  78994]
 [101445 128095 100534]
 [ 83844  42195 132174]]
testing model out of sample: results/universal/W6/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 562s - 562s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0000919
{'0': {'precision': 0.46612229867923105, 'recall': 0.4519394767122993, 'f1-score': 0.45892133491601905, 'support': 1394835}, '1': {'precision': 0.5580977724222189, 'recall': 0.5912273910589598, 'f1-score': 0.5741850964884213, 'support': 1692085}, '2': {'precision': 0.4712886476016233, 'recall': 0.4517376698852758, 'f1-score': 0.46130610033004166, 'support': 1398223}, 'accuracy': 0.504424942526916, 'macro avg': {'precision': 0.4985029062343578, 'recall': 0.4983015125521783, 'f1-score': 0.49813751057816064, 'support': 4485143}, 'weighted avg': {'precision': 0.5024319609079978, 'recall': 0.504424942526916, 'f1-score': 0.5031496941571244, 'support': 4485143}}
[[ 630381  410024  354430]
 [ 337519 1000407  354159]
 [ 384494  382099  631630]]
Evaluating performance on  train set...
5153/5153 - 165s - 165s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0079929
{'0': {'precision': 0.4681964235086577, 'recall': 0.44147161329927326, 'f1-score': 0.4544414491084487, 'support': 403992}, '1': {'precision': 0.5629925695636647, 'recall': 0.5752252102840664, 'f1-score': 0.5690431566777135, 'support': 512521}, '2': {'precision': 0.452971552511195, 'recall': 0.46640404673441066, 'f1-score': 0.45958967220828106, 'support': 402102}, 'accuracy': 0.5010620992480747, 'macro avg': {'precision': 0.49472018186117245, 'recall': 0.4943669567725834, 'f1-score': 0.4943580926648144, 'support': 1318615}, 'weighted avg': {'precision': 0.5003992002815872, 'recall': 0.5010620992480747, 'f1-score': 0.5005549034298359, 'support': 1318615}}
[[178351 117980 107661]
 [ 98883 294815 118823]
 [103698 110862 187542]]
Evaluating performance on  val set...
1795/1795 - 58s - 58s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9959578
{'0': {'precision': 0.4632654589010331, 'recall': 0.44827811019515235, 'f1-score': 0.45564857561500005, 'support': 138046}, '1': {'precision': 0.582807745132362, 'recall': 0.586824950920312, 'f1-score': 0.5848094493040299, 'support': 184394}, '2': {'precision': 0.4531139229628993, 'recall': 0.46372350716735555, 'f1-score': 0.4583573283496137, 'support': 136452}, 'accuracy': 0.5085423149673561, 'macro avg': {'precision': 0.49972904233209814, 'recall': 0.4996088560942733, 'f1-score': 0.4996051177562146, 'support': 458892}, 'weighted avg': {'precision': 0.5082818962011156, 'recall': 0.5085423149673561, 'f1-score': 0.5083540158300365, 'support': 458892}}
[[ 61883  40595  35568]
 [ 35384 108207  40803]
 [ 36313  36863  63276]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1653911
{'0': {'precision': 0.37855068666623, 'recall': 0.5697604364066556, 'f1-score': 0.45487857136610493, 'support': 91291}, '1': {'precision': 0.44929881337648325, 'recall': 0.030687804698340967, 'f1-score': 0.05745157767687798, 'support': 81433}, '2': {'precision': 0.41171878659193456, 'recall': 0.5363066003680994, 'f1-score': 0.46582613879750057, 'support': 98343}, 'accuracy': 0.39567708352547526, 'macro avg': {'precision': 0.4131894288782159, 'recall': 0.378918280491032, 'f1-score': 0.3260520959468278, 'support': 271067}, 'weighted avg': {'precision': 0.41183796491621844, 'recall': 0.39567708352547526, 'f1-score': 0.33945671716330983, 'support': 271067}}
[[52014  1480 37797]
 [41371  2499 37563]
 [44018  1583 52742]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1752264
{'0': {'precision': 0.4050204081632653, 'recall': 0.5369007683151175, 'f1-score': 0.46172816527848864, 'support': 18482}, '1': {'precision': 0.4541631623212784, 'recall': 0.030118801940989457, 'f1-score': 0.05649126477665028, 'support': 17929}, '2': {'precision': 0.37389458790237, 'recall': 0.6023478459083657, 'f1-score': 0.46139071980444374, 'support': 17548}, 'accuracy': 0.3897959561889583, 'macro avg': {'precision': 0.4110260527956379, 'recall': 0.38978913872149085, 'f1-score': 0.3265367166198609, 'support': 53959}, 'weighted avg': {'precision': 0.4112266859920024, 'recall': 0.3897959561889583, 'f1-score': 0.3269700362865503, 'support': 53959}}
[[ 9923   367  8192]
 [ 7881   540  9508]
 [ 6696   282 10570]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1495936
{'0': {'precision': 0.4227831989817565, 'recall': 0.5520775623268698, 'f1-score': 0.47885631907736664, 'support': 7220}, '1': {'precision': 0.5640194489465153, 'recall': 0.05392840539284054, 'f1-score': 0.09844413012729844, 'support': 6453}, '2': {'precision': 0.3935045317220544, 'recall': 0.5985066053991959, 'f1-score': 0.4748234221918432, 'support': 6964}, 'accuracy': 0.4119784852449484, 'macro avg': {'precision': 0.46010239321677543, 'recall': 0.40150419103963536, 'f1-score': 0.3507079571321694, 'support': 20637}, 'weighted avg': {'precision': 0.4570663255130364, 'recall': 0.4119784852449484, 'f1-score': 0.35854401839385763, 'support': 20637}}
[[3986  124 3110]
 [2791  348 3314]
 [2651  145 4168]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
2185/2185 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8478652
{'0': {'precision': 0.5522321328772941, 'recall': 0.3656291165282773, 'f1-score': 0.43996224264443967, 'support': 135126}, '1': {'precision': 0.6436534042020193, 'recall': 0.8242602394850443, 'f1-score': 0.722846212888015, 'support': 286782}, '2': {'precision': 0.5579023395180417, 'recall': 0.4164220096600057, 'f1-score': 0.47689009027047774, 'support': 137267}, 'accuracy': 0.61331425761166, 'macro avg': {'precision': 0.5845959588657851, 'recall': 0.5354371218911091, 'f1-score': 0.5465661819343108, 'support': 559175}, 'weighted avg': {'precision': 0.6005109495053674, 'recall': 0.61331425761166, 'f1-score': 0.5941089867128911, 'support': 559175}}
[[ 49406  68084  17636]
 [ 22739 236383  27660]
 [ 17321  62785  57161]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76955634
{'0': {'precision': 0.5724526097807041, 'recall': 0.38868659191693405, 'f1-score': 0.4630019325746189, 'support': 27737}, '1': {'precision': 0.7305202324888884, 'recall': 0.8170548181773326, 'f1-score': 0.77136818078596, 'support': 81068}, '2': {'precision': 0.5077325364213672, 'recall': 0.49481233390367324, 'f1-score': 0.5011891812164678, 'support': 27469}, 'accuracy': 0.6649104011036588, 'macro avg': {'precision': 0.6035684595636532, 'recall': 0.5668512479993133, 'f1-score': 0.5785197648590156, 'support': 136274}, 'weighted avg': {'precision': 0.6534396677858956, 'recall': 0.6649104011036588, 'f1-score': 0.6541433134905673, 'support': 136274}}
[[10781 13518  3438]
 [ 5091 66237  9740]
 [ 2961 10916 13592]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7881814
{'0': {'precision': 0.6081759916854322, 'recall': 0.3565915092423319, 'f1-score': 0.4495806389653627, 'support': 9846}, '1': {'precision': 0.7229130719343131, 'recall': 0.8342774745081882, 'f1-score': 0.7746130919175658, 'support': 29127}, '2': {'precision': 0.4788428814520703, 'recall': 0.4573626611767255, 'f1-score': 0.46785635114165375, 'support': 9229}, 'accuracy': 0.6645367412140575, 'macro avg': {'precision': 0.6033106483572719, 'recall': 0.549410548309082, 'f1-score': 0.5640166940081941, 'support': 48202}, 'weighted avg': {'precision': 0.652745338643348, 'recall': 0.6645367412140575, 'f1-score': 0.6494870080955608, 'support': 48202}}
[[ 3511  5107  1228]
 [ 1461 24300  3366]
 [  801  4207  4221]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.09936
{'0': {'precision': 0.45052448605529694, 'recall': 0.45784070239261226, 'f1-score': 0.4541531308417296, 'support': 114352}, '1': {'precision': 0.40940820772753544, 'recall': 0.21958839100469796, 'f1-score': 0.28585620265739475, 'support': 83866}, '2': {'precision': 0.4344641686621273, 'recall': 0.577485575085127, 'f1-score': 0.4958680840506136, 'support': 112479}, 'accuracy': 0.43684361290904, 'macro avg': {'precision': 0.4314656208149866, 'recall': 0.41830488949414574, 'f1-score': 0.411959139183246, 'support': 310697}, 'weighted avg': {'precision': 0.43361184693003224, 'recall': 0.43684361290904, 'f1-score': 0.4238266907501762, 'support': 310697}}
[[52355 14781 47216]
 [28115 18416 37335]
 [35739 11785 64955]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1309159
{'0': {'precision': 0.4118917036650126, 'recall': 0.5292867370681941, 'f1-score': 0.4632677639502208, 'support': 44696}, '1': {'precision': 0.46896067415730336, 'recall': 0.15662820151984239, 'f1-score': 0.23482664041071807, 'support': 42636}, '2': {'precision': 0.40264822467740574, 'recall': 0.5471486201521958, 'f1-score': 0.46390640638208974, 'support': 43628}, 'accuracy': 0.41391264508246794, 'macro avg': {'precision': 0.42783353416657394, 'recall': 0.4110211862467441, 'f1-score': 0.38733360358100954, 'support': 130960}, 'weighted avg': {'precision': 0.4273919947816742, 'recall': 0.41391264508246794, 'f1-score': 0.3891080735774913, 'support': 130960}}
[[23657  4023 17016]
 [17560  6678 18398]
 [16218  3539 23871]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1287566
{'0': {'precision': 0.39881748071979434, 'recall': 0.5361116870550833, 'f1-score': 0.4573837672101182, 'support': 14469}, '1': {'precision': 0.4723332632021881, 'recall': 0.16251628782394673, 'f1-score': 0.24182689718317446, 'support': 13814}, '2': {'precision': 0.4167018581081081, 'recall': 0.5310818083961248, 'f1-score': 0.46699006152389966, 'support': 14864}, 'accuracy': 0.4147681182932765, 'macro avg': {'precision': 0.42928420067669687, 'recall': 0.4099032610917183, 'f1-score': 0.3887335753057308, 'support': 43147}, 'weighted avg': {'precision': 0.42851549923120147, 'recall': 0.4147681182932765, 'f1-score': 0.3916801344228525, 'support': 43147}}
[[7757 1379 5333]
 [5852 2245 5717]
 [5841 1129 7894]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
1095/1095 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1620313
{'0': {'precision': 0.360322844422908, 'recall': 0.7126740877552039, 'f1-score': 0.47864583158720525, 'support': 100165}, '1': {'precision': 0.28763742427641914, 'recall': 0.033632845805732274, 'f1-score': 0.06022384291066248, 'support': 76235}, '2': {'precision': 0.38857940624957227, 'recall': 0.2737995351483764, 'f1-score': 0.3212446958981613, 'support': 103689}, 'accuracy': 0.3653802898364448, 'macro avg': {'precision': 0.34551322498296644, 'recall': 0.3400354895697708, 'f1-score': 0.28670479013200967, 'support': 280089}, 'weighted avg': {'precision': 0.35099981365189387, 'recall': 0.3653802898364448, 'f1-score': 0.3064892432698578, 'support': 280089}}
[[71385  3224 25556]
 [54556  2564 19115]
 [72173  3126 28390]]
Evaluating performance on  train set...
448/448 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2027879
{'0': {'precision': 0.3352942612346523, 'recall': 0.7192564471789501, 'f1-score': 0.45737498855397113, 'support': 38195}, '1': {'precision': 0.32587682960508146, 'recall': 0.031060805475125033, 'f1-score': 0.05671577227175507, 'support': 37990}, '2': {'precision': 0.3492019718018546, 'recall': 0.2639464290367128, 'f1-score': 0.3006469994657803, 'support': 38379}, 'accuracy': 0.3385182081631228, 'macro avg': {'precision': 0.3367910208805294, 'recall': 0.33808789389692934, 'f1-score': 0.27157925343050215, 'support': 114564}, 'weighted avg': {'precision': 0.3368304837500259, 'recall': 0.3385182081631228, 'f1-score': 0.272010413994973, 'support': 114564}}
[[27472  1259  9464]
 [27395  1180  9415]
 [27067  1182 10130]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1932257
{'0': {'precision': 0.33978176585794795, 'recall': 0.7232431512676536, 'f1-score': 0.4623500938188344, 'support': 11754}, '1': {'precision': 0.3242087254063302, 'recall': 0.034659350708733425, 'f1-score': 0.06262392597488434, 'support': 10935}, '2': {'precision': 0.36633663366336633, 'recall': 0.26026150281363786, 'f1-score': 0.30432047994581257, 'support': 12084}, 'accuracy': 0.34581428119518015, 'macro avg': {'precision': 0.3434423749758815, 'recall': 0.339388001596675, 'f1-score': 0.2764314999131771, 'support': 34773}, 'weighted avg': {'precision': 0.3441126497397595, 'recall': 0.34581428119518015, 'f1-score': 0.28173192744218617, 'support': 34773}}
[[8501  400 2853]
 [7969  379 2587]
 [8549  390 3145]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1722/1722 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1619321
{'0': {'precision': 0.39961540825555153, 'recall': 0.5896276526831291, 'f1-score': 0.4763729045966725, 'support': 154372}, '1': {'precision': 0.4171616130040638, 'recall': 0.06179337382405828, 'f1-score': 0.10764194634707032, 'support': 129577}, '2': {'precision': 0.41147184918821034, 'recall': 0.5084858144724259, 'f1-score': 0.45486353694668374, 'support': 156850}, 'accuracy': 0.40559302539252584, 'macro avg': {'precision': 0.4094162901492752, 'recall': 0.38663561365987115, 'f1-score': 0.34629279596347556, 'support': 440799}, 'weighted avg': {'precision': 0.40899217030125834, 'recall': 0.40559302539252584, 'f1-score': 0.3603272790553046, 'support': 440799}}
[[91022  6210 57140]
 [64635  8007 56935]
 [72117  4977 79756]]
Evaluating performance on  train set...
618/618 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2008893
{'0': {'precision': 0.3921540676540605, 'recall': 0.5242396524125315, 'f1-score': 0.4486776974075857, 'support': 52476}, '1': {'precision': 0.4506631299734748, 'recall': 0.03226847982982603, 'f1-score': 0.06022473503243416, 'support': 52652}, '2': {'precision': 0.3766660319878142, 'recall': 0.5991859914813062, 'f1-score': 0.4625558064256853, 'support': 52825}, 'accuracy': 0.3853108203073066, 'macro avg': {'precision': 0.40649440987178315, 'recall': 0.3852313745745546, 'f1-score': 0.32381941295523503, 'support': 157953}, 'weighted avg': {'precision': 0.40647771877288913, 'recall': 0.3853108203073066, 'f1-score': 0.3238322416954728, 'support': 157953}}
[[27510  1076 23890]
 [22463  1699 28490]
 [20178   995 31652]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1929178
{'0': {'precision': 0.38360844391699933, 'recall': 0.5629617901625501, 'f1-score': 0.4562934445513849, 'support': 18948}, '1': {'precision': 0.41045021360499506, 'recall': 0.06451446280991735, 'f1-score': 0.1115029237155738, 'support': 19360}, '2': {'precision': 0.3858474958640397, 'recall': 0.5362106803218727, 'f1-score': 0.4487689683823851, 'support': 19138}, 'accuracy': 0.38606691501584095, 'macro avg': {'precision': 0.393302051128678, 'recall': 0.38789564443144675, 'f1-score': 0.338855112216448, 'support': 57446}, 'weighted avg': {'precision': 0.39340038134209515, 'recall': 0.38606691501584095, 'f1-score': 0.3375880880721937, 'support': 57446}}
[[10667   863  7418]
 [ 9195  1249  8916]
 [ 7945   931 10262]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
4450/4450 - 65s - 65s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89028853
{'0': {'precision': 0.5934023355037544, 'recall': 0.3907198930233513, 'f1-score': 0.4711896354477025, 'support': 341009}, '1': {'precision': 0.5654633932824388, 'recall': 0.7638753323318993, 'f1-score': 0.6498622648121966, 'support': 460007}, '2': {'precision': 0.563725607239461, 'recall': 0.48880673163662175, 'f1-score': 0.5235998200470159, 'support': 338105}, 'accuracy': 0.5705232367764267, 'macro avg': {'precision': 0.5741971120085514, 'recall': 0.5478006523306241, 'f1-score': 0.548217240102305, 'support': 1139121}, 'weighted avg': {'precision': 0.573311441556404, 'recall': 0.5705232367764267, 'f1-score': 0.5588983210746232, 'support': 1139121}}
[[133239 148778  58992]
 [ 39708 351388  68911]
 [ 51587 121250 165268]]
Evaluating performance on  train set...
1504/1504 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8685198
{'0': {'precision': 0.6061047508055117, 'recall': 0.3453478379750791, 'f1-score': 0.4399945257290734, 'support': 102404}, '1': {'precision': 0.6006761295915051, 'recall': 0.7698388010620688, 'f1-score': 0.6748175902188918, 'support': 180026}, '2': {'precision': 0.5475320117811711, 'recall': 0.5120081258728965, 'f1-score': 0.5291745527039645, 'support': 102389}, 'accuracy': 0.5882765663857554, 'macro avg': {'precision': 0.584770964059396, 'recall': 0.5423982549700148, 'f1-score': 0.5479955562173099, 'support': 384819}, 'weighted avg': {'precision': 0.587980653142361, 'recall': 0.5882765663857554, 'f1-score': 0.573577614895087, 'support': 384819}}
[[ 35365  51955  15084]
 [ 13197 138591  28238]
 [  9786  40179  52424]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86707586
{'0': {'precision': 0.6052562555736243, 'recall': 0.33948274340188894, 'f1-score': 0.4349858623939679, 'support': 33987}, '1': {'precision': 0.5995877905065372, 'recall': 0.7725103041558737, 'f1-score': 0.6751525247563519, 'support': 61383}, '2': {'precision': 0.5401396699833138, 'recall': 0.4974246606527987, 'f1-score': 0.5179029080189028, 'support': 35141}, 'accuracy': 0.5856747707089824, 'macro avg': {'precision': 0.581661238687825, 'recall': 0.5364725694035205, 'f1-score': 0.5426804317230742, 'support': 130511}, 'weighted avg': {'precision': 0.5850571204398645, 'recall': 0.5856747707089824, 'f1-score': 0.570269004321438, 'support': 130511}}
[[11538 17492  4957]
 [ 4039 47419  9925]
 [ 3486 14175 17480]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
6203/6203 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86091584
{'0': {'precision': 0.5608182299947005, 'recall': 0.34693631340007186, 'f1-score': 0.42868022114057197, 'support': 381289}, '1': {'precision': 0.6297154911522613, 'recall': 0.8384268889784035, 'f1-score': 0.7192359642139182, 'support': 816751}, '2': {'precision': 0.5283580171312362, 'recall': 0.35855004950825226, 'f1-score': 0.4271982640056237, 'support': 389834}, 'accuracy': 0.6025944124029993, 'macro avg': {'precision': 0.5729639127593994, 'recall': 0.5146377506289092, 'f1-score': 0.5250381497867046, 'support': 1587874}, 'weighted avg': {'precision': 0.588287545775602, 'recall': 0.6025944124029993, 'f1-score': 0.5777688619478105, 'support': 1587874}}
[[132283 203601  45405]
 [ 52599 684786  79366]
 [ 50993 199066 139775]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87223715
{'0': {'precision': 0.563557708004571, 'recall': 0.365331193283536, 'f1-score': 0.4432935083279383, 'support': 113393}, '1': {'precision': 0.6213374251874879, 'recall': 0.8296310750222845, 'f1-score': 0.7105334622155459, 'support': 225493}, '2': {'precision': 0.5282762897786736, 'recall': 0.36149595508598203, 'f1-score': 0.4292553359019853, 'support': 113105}, 'accuracy': 0.5960052301926366, 'macro avg': {'precision': 0.5710571409902441, 'recall': 0.5188194077972675, 'f1-score': 0.5276941021484899, 'support': 451991}, 'weighted avg': {'precision': 0.5835546038681775, 'recall': 0.5960052301926366, 'f1-score': 0.5731035077078837, 'support': 451991}}
[[ 41426  57692  14275]
 [ 16182 187076  22235]
 [ 15900  56318  40887]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8310305
{'0': {'precision': 0.5689083305292506, 'recall': 0.3479142781550401, 'f1-score': 0.4317767238234221, 'support': 34017}, '1': {'precision': 0.6613615491333997, 'recall': 0.8337089722273539, 'f1-score': 0.7376014034399534, 'support': 81195}, '2': {'precision': 0.5074854505318082, 'recall': 0.3847839318320146, 'f1-score': 0.43769796624837726, 'support': 32860}, 'accuracy': 0.6224809552109785, 'macro avg': {'precision': 0.5792517767314861, 'recall': 0.5221357274048029, 'f1-score': 0.5356920311705843, 'support': 148072}, 'weighted avg': {'precision': 0.605973969190496, 'recall': 0.6224809552109785, 'f1-score': 0.6007891426976744, 'support': 148072}}
[[11835 18438  3744]
 [ 4975 67693  8527]
 [ 3993 16223 12644]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
5183/5183 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9956334
{'0': {'precision': 0.5168591582047903, 'recall': 0.4382651675152705, 'f1-score': 0.47432854436337685, 'support': 456436}, '1': {'precision': 0.4750804674291207, 'recall': 0.6077714280115325, 'f1-score': 0.533296077377754, 'support': 408239}, '2': {'precision': 0.5069297256130418, 'recall': 0.4579922754860277, 'f1-score': 0.4812200328743205, 'support': 462165}, 'accuracy': 0.49728980133248923, 'macro avg': {'precision': 0.4996231170823176, 'recall': 0.5013429570042769, 'f1-score': 0.4962815515384838, 'support': 1326840}, 'weighted avg': {'precision': 0.500546168577304, 'recall': 0.49728980133248923, 'f1-score': 0.49487197951600764, 'support': 1326840}}
[[200040 138882 117514]
 [ 71756 248116  88367]
 [115234 135263 211668]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9851266
{'0': {'precision': 0.5173948179704881, 'recall': 0.4037479368440721, 'f1-score': 0.45356073029408545, 'support': 128444}, '1': {'precision': 0.4902311486125141, 'recall': 0.6581913917587459, 'f1-score': 0.5619289253665264, 'support': 125345}, '2': {'precision': 0.5093028628294208, 'recall': 0.450352771099483, 'f1-score': 0.4780172126225899, 'support': 127278}, 'accuracy': 0.5030086572702438, 'macro avg': {'precision': 0.5056429431374744, 'recall': 0.5040973665674336, 'f1-score': 0.49783562276106724, 'support': 381067}, 'weighted avg': {'precision': 0.5057570797194194, 'recall': 0.5030086572702438, 'f1-score': 0.49737502953585266, 'support': 381067}}
[[51859 45424 31161]
 [18779 82501 24065]
 [29593 40365 57320]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9723971
{'0': {'precision': 0.5177741019318998, 'recall': 0.3912182238362496, 'f1-score': 0.4456861928620361, 'support': 42406}, '1': {'precision': 0.5123566839824178, 'recall': 0.690049885119331, 'f1-score': 0.588073418771003, 'support': 48311}, '2': {'precision': 0.5135362603450694, 'recall': 0.43547044129891754, 'f1-score': 0.47129248197734286, 'support': 42035}, 'accuracy': 0.5139809569723996, 'macro avg': {'precision': 0.5145556820864624, 'recall': 0.5055795167514994, 'f1-score': 0.5016840312034607, 'support': 132752}, 'weighted avg': {'precision': 0.5144607164487445, 'recall': 0.5139809569723996, 'f1-score': 0.505611690284674, 'support': 132752}}
[[16590 16765  9051]
 [ 6685 33337  8289]
 [ 8766 14964 18305]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
7324/7324 - 107s - 107s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0393575
{'0': {'precision': 0.4769292823616348, 'recall': 0.4631716016531733, 'f1-score': 0.46994977526956005, 'support': 653531}, '1': {'precision': 0.45110006561215193, 'recall': 0.49391687253858163, 'f1-score': 0.47153849759582767, 'support': 580458}, '2': {'precision': 0.48717066408149895, 'recall': 0.45961321457055143, 'f1-score': 0.47299089055413984, 'support': 640717}, 'accuracy': 0.47147499394571735, 'macro avg': {'precision': 0.47173333735176187, 'recall': 0.4722338962541021, 'f1-score': 0.47149305447317585, 'support': 1874706}, 'weighted avg': {'precision': 0.472432071532542, 'recall': 0.47147499394571735, 'f1-score': 0.47148104515713213, 'support': 1874706}}
[[302697 184050 166784]
 [150552 286698 143208]
 [181430 164805 294482]]
Evaluating performance on  train set...
2046/2046 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0192143
{'0': {'precision': 0.4865953122185916, 'recall': 0.43242161822287006, 'f1-score': 0.4579117649729278, 'support': 174945}, '1': {'precision': 0.4863142273066792, 'recall': 0.569371328627072, 'f1-score': 0.5245754783240173, 'support': 173811}, '2': {'precision': 0.48876738597470687, 'recall': 0.4602562344282155, 'f1-score': 0.4740835354225037, 'support': 174996}, 'accuracy': 0.48716950006873483, 'macro avg': {'precision': 0.4872256418333259, 'recall': 0.4873497270927192, 'f1-score': 0.48552359290648295, 'support': 523752}, 'weighted avg': {'precision': 0.48722776530593204, 'recall': 0.48716950006873483, 'f1-score': 0.4854379258713305, 'support': 523752}}
[[75650 55046 44249]
 [34852 98963 39996]
 [44966 49487 80543]]
Evaluating performance on  val set...
741/741 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0185952
{'0': {'precision': 0.4949119021934556, 'recall': 0.4342346037354871, 'f1-score': 0.46259200752865254, 'support': 63392}, '1': {'precision': 0.48887734441602726, 'recall': 0.5773139117850626, 'f1-score': 0.5294278872508006, 'support': 63572}, '2': {'precision': 0.4822914190634657, 'recall': 0.45358157953565614, 'f1-score': 0.4674961324512031, 'support': 62626}, 'accuracy': 0.4886017194999736, 'macro avg': {'precision': 0.4886935552243162, 'recall': 0.4883766983520686, 'f1-score': 0.48650534241021876, 'support': 189590}, 'weighted avg': {'precision': 0.48871959625155237, 'recall': 0.4886017194999736, 'f1-score': 0.4866228966741562, 'support': 189590}}
[[27527 19873 15992]
 [12371 36701 14500]
 [15722 18498 28406]]
testing model on single stock: results/universal/W6/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
29350/29350 - 417s - 417s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2301991
{'0': {'precision': 0.3497339038467936, 'recall': 0.5606682023588557, 'f1-score': 0.4307649945823684, 'support': 2212683}, '1': {'precision': 0.4710730795488897, 'recall': 0.13369815473847416, 'f1-score': 0.20828239807692503, 'support': 3112025}, '2': {'precision': 0.3546149187773906, 'recall': 0.4995024434640535, 'f1-score': 0.4147697406671886, 'support': 2188696}, 'accuracy': 0.366000816673774, 'macro avg': {'precision': 0.39180730072435793, 'recall': 0.3979562668537944, 'f1-score': 0.351272377775494, 'support': 7513404}, 'weighted avg': {'precision': 0.40141402195555675, 'recall': 0.366000816673774, 'f1-score': 0.33395399511355367, 'support': 7513404}}
[[1240581  249529  722573]
 [1428838  416072 1267115]
 [ 877795  217642 1093259]]
Evaluating performance on  train set...
5452/5452 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.150336
{'0': {'precision': 0.4019015850050908, 'recall': 0.5699952221691352, 'f1-score': 0.47141215310945705, 'support': 468832}, '1': {'precision': 0.5356131765941091, 'recall': 0.12419870575627613, 'f1-score': 0.20164069516914265, 'support': 460037}, '2': {'precision': 0.40670671697532546, 'recall': 0.5437928359258132, 'f1-score': 0.46536413055439396, 'support': 466606}, 'accuracy': 0.4142711263189953, 'macro avg': {'precision': 0.4480738261915085, 'recall': 0.41266225461707484, 'f1-score': 0.37947232627766453, 'support': 1395475}, 'weighted avg': {'precision': 0.4475880952384813, 'recall': 0.4142711263189953, 'f1-score': 0.380456101722785, 'support': 1395475}}
[[267232  26704 174896]
 [207652  57136 195249]
 [190035  22834 253737]]
Evaluating performance on  val set...
1969/1969 - 33s - 33s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.162495
{'0': {'precision': 0.3943790541734324, 'recall': 0.5715792489986038, 'f1-score': 0.4667259091101436, 'support': 164021}, '1': {'precision': 0.5579187993837897, 'recall': 0.12452445124724099, 'f1-score': 0.20360530276926425, 'support': 180318}, '2': {'precision': 0.3927527322102265, 'recall': 0.5559652901254665, 'f1-score': 0.46031988761686055, 'support': 159724}, 'accuracy': 0.4067070981206714, 'macro avg': {'precision': 0.4483501952558162, 'recall': 0.4173563301237704, 'f1-score': 0.37688369983208947, 'support': 504063}, 'weighted avg': {'precision': 0.4523666412956574, 'recall': 0.4067070981206714, 'f1-score': 0.3705701173317988, 'support': 504063}}
[[93751  9270 61000]
 [81566 22454 76298]
 [62401  8522 88801]]
training model: results/universal/W6/deepVOL_L3/h100
Epoch 1/50
9426/9426 - 555s - loss: 3.2254 - accuracy100: 0.4017 - val_loss: 3.2889 - val_accuracy100: 0.3583 - 555s/epoch - 59ms/step
Epoch 2/50
9426/9426 - 550s - loss: 3.1893 - accuracy100: 0.4220 - val_loss: 3.2687 - val_accuracy100: 0.3887 - 550s/epoch - 58ms/step
Epoch 3/50
9426/9426 - 546s - loss: 3.1534 - accuracy100: 0.4354 - val_loss: 3.2844 - val_accuracy100: 0.3924 - 546s/epoch - 58ms/step
Epoch 4/50
9426/9426 - 543s - loss: 3.1384 - accuracy100: 0.4397 - val_loss: 3.2471 - val_accuracy100: 0.3976 - 543s/epoch - 58ms/step
Epoch 5/50
9426/9426 - 540s - loss: 3.1294 - accuracy100: 0.4434 - val_loss: 3.2881 - val_accuracy100: 0.3955 - 540s/epoch - 57ms/step
Epoch 6/50
9426/9426 - 545s - loss: 3.1244 - accuracy100: 0.4447 - val_loss: 3.2579 - val_accuracy100: 0.3957 - 545s/epoch - 58ms/step
Epoch 7/50
9426/9426 - 546s - loss: 3.1178 - accuracy100: 0.4472 - val_loss: 3.2497 - val_accuracy100: 0.3956 - 546s/epoch - 58ms/step
Epoch 8/50
9426/9426 - 548s - loss: 3.1136 - accuracy100: 0.4487 - val_loss: 3.2502 - val_accuracy100: 0.3931 - 548s/epoch - 58ms/step
Epoch 9/50
9426/9426 - 552s - loss: 3.1094 - accuracy100: 0.4504 - val_loss: 3.2490 - val_accuracy100: 0.3931 - 552s/epoch - 59ms/step
Epoch 10/50
9426/9426 - 552s - loss: 3.1048 - accuracy100: 0.4516 - val_loss: 3.2439 - val_accuracy100: 0.3917 - 552s/epoch - 59ms/step
Epoch 11/50
9426/9426 - 548s - loss: 3.1023 - accuracy100: 0.4525 - val_loss: 3.2693 - val_accuracy100: 0.3870 - 548s/epoch - 58ms/step
Epoch 12/50
9426/9426 - 550s - loss: 3.0974 - accuracy100: 0.4541 - val_loss: 3.2768 - val_accuracy100: 0.3878 - 550s/epoch - 58ms/step
Epoch 13/50
9426/9426 - 542s - loss: 3.0938 - accuracy100: 0.4554 - val_loss: 3.2921 - val_accuracy100: 0.3874 - 542s/epoch - 58ms/step
Epoch 14/50
9426/9426 - 549s - loss: 3.0910 - accuracy100: 0.4560 - val_loss: 3.2859 - val_accuracy100: 0.3888 - 549s/epoch - 58ms/step
Epoch 15/50
9426/9426 - 546s - loss: 3.0882 - accuracy100: 0.4571 - val_loss: 3.3014 - val_accuracy100: 0.3901 - 546s/epoch - 58ms/step
Epoch 16/50
9426/9426 - 543s - loss: 3.0864 - accuracy100: 0.4578 - val_loss: 3.2933 - val_accuracy100: 0.3881 - 543s/epoch - 58ms/step
Epoch 17/50
9426/9426 - 537s - loss: 3.0849 - accuracy100: 0.4579 - val_loss: 3.3097 - val_accuracy100: 0.3879 - 537s/epoch - 57ms/step
Epoch 18/50
9426/9426 - 536s - loss: 3.0826 - accuracy100: 0.4589 - val_loss: 3.2937 - val_accuracy100: 0.3888 - 536s/epoch - 57ms/step
Epoch 19/50
9426/9426 - 540s - loss: 3.0814 - accuracy100: 0.4594 - val_loss: 3.2800 - val_accuracy100: 0.3887 - 540s/epoch - 57ms/step
Epoch 20/50
9426/9426 - 546s - loss: 3.0799 - accuracy100: 0.4601 - val_loss: 3.2907 - val_accuracy100: 0.3893 - 546s/epoch - 58ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1293s - 1293s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015182
{'0': {'precision': 0.3448929069341062, 'recall': 0.5541746895668501, 'f1-score': 0.4251758608092902, 'support': 3343554}, '1': {'precision': 0.41324013452326114, 'recall': 0.16780523595680408, 'f1-score': 0.2386865529044823, 'support': 4126963}, '2': {'precision': 0.35791192076077716, 'recall': 0.40304953956140055, 'f1-score': 0.37914202594463103, 'support': 3348112}, 'accuracy': 0.36001733676235687, 'macro avg': {'precision': 0.3720149874060481, 'recall': 0.37500982169501823, 'f1-score': 0.34766814655280115, 'support': 10818629}, 'weighted avg': {'precision': 0.37499428076199737, 'recall': 0.36001733676235687, 'f1-score': 0.33978972652784534, 'support': 10818629}}
[[1852913  524331  966310]
 [1979847  692526 1454590]
 [1539670  458987 1349455]]
Evaluating performance on  train set...
9426/9426 - 293s - 293s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0780594
{'0': {'precision': 0.38165101066838764, 'recall': 0.5962194073080174, 'f1-score': 0.4653944637165665, 'support': 803419}, '1': {'precision': 0.43709954810413776, 'recall': 0.25935605513745497, 'f1-score': 0.3255467081347569, 'support': 810411}, '2': {'precision': 0.3980311316039312, 'recall': 0.33713608619573154, 'f1-score': 0.365061593183213, 'support': 798369}, 'accuracy': 0.3972964087954601, 'macro avg': {'precision': 0.4055938967921522, 'recall': 0.3975705162137346, 'f1-score': 0.38533425501151214, 'support': 2412199}, 'weighted avg': {'precision': 0.40570105191416905, 'recall': 0.3972964087954601, 'f1-score': 0.38520339616216787, 'support': 2412199}}
[[479014 149289 175116]
 [368275 210185 231951]
 [407821 121389 269159]]
Evaluating performance on  val set...
3323/3323 - 105s - 105s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081716
{'0': {'precision': 0.3724140091020134, 'recall': 0.5724469692480891, 'f1-score': 0.45125637675976676, 'support': 270032}, '1': {'precision': 0.4546043949738941, 'recall': 0.2533672294704528, 'f1-score': 0.32538551569782964, 'support': 312720}, '2': {'precision': 0.38140094581854694, 'recall': 0.37197672202101295, 'f1-score': 0.37662988872006314, 'support': 267549}, 'accuracy': 0.39201882627446044, 'macro avg': {'precision': 0.4028064499648181, 'recall': 0.3992636402465182, 'f1-score': 0.38442392705921985, 'support': 850301}, 'weighted avg': {'precision': 0.4054693899629396, 'recall': 0.39201882627446044, 'f1-score': 0.3814827578650182, 'support': 850301}}
[[154579  51206  64247]
 [136318  79233  97169]
 [124176  43851  99522]]
testing model out of sample: results/universal/W6/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 558s - 558s/epoch - 32ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0680168
{'0': {'precision': 0.39625361295711764, 'recall': 0.4860860575977366, 'f1-score': 0.43659684123702813, 'support': 1433598}, '1': {'precision': 0.4545642317737794, 'recall': 0.36002457620715944, 'f1-score': 0.4018083560684457, 'support': 1601549}, '2': {'precision': 0.3945254070247126, 'recall': 0.3967252323454685, 'f1-score': 0.3956222617214056, 'support': 1449996}, 'accuracy': 0.41218284456036297, 'macro avg': {'precision': 0.4151144172518699, 'recall': 0.41427862205012156, 'f1-score': 0.41134248634229315, 'support': 4485143}, 'weighted avg': {'precision': 0.41651638307750005, 'recall': 0.41218284456036297, 'f1-score': 0.410927996334515, 'support': 4485143}}
[[696852 361265 375481]
 [517602 576597 507350]
 [544147 330599 575250]]
Evaluating performance on  train set...
5153/5153 - 177s - 177s/epoch - 34ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0699096
{'0': {'precision': 0.40525672965085235, 'recall': 0.478062881671958, 'f1-score': 0.43865934257637174, 'support': 436566}, '1': {'precision': 0.43431459497025615, 'recall': 0.37302499409781154, 'f1-score': 0.4013433787196925, 'support': 448986}, '2': {'precision': 0.40529483817872114, 'recall': 0.39119019634556634, 'f1-score': 0.3981176304704161, 'support': 433063}, 'accuracy': 0.4137667173511601, 'macro avg': {'precision': 0.4149553875999432, 'recall': 0.41409269070511195, 'f1-score': 0.4127067839221601, 'support': 1318615}, 'weighted avg': {'precision': 0.415163395441627, 'recall': 0.4137667173511601, 'f1-score': 0.4126385094917364, 'support': 1318615}}
[[208706 115468 112392]
 [145313 167483 136190]
 [160978 102675 169410]]
Evaluating performance on  val set...
1795/1795 - 59s - 59s/epoch - 33ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0634166
{'0': {'precision': 0.3991984222914944, 'recall': 0.4686619455326892, 'f1-score': 0.431150254536369, 'support': 147281}, '1': {'precision': 0.4610054443894506, 'recall': 0.39348457142167426, 'f1-score': 0.42457729488260637, 'support': 165699}, '2': {'precision': 0.39978416221040036, 'recall': 0.39606063928943475, 'f1-score': 0.3979136901175701, 'support': 145912}, 'accuracy': 0.4184317878716561, 'macro avg': {'precision': 0.4199960096304485, 'recall': 0.4194023854145994, 'f1-score': 0.4178804131788485, 'support': 458892}, 'weighted avg': {'precision': 0.42170225377615017, 'recall': 0.4184317878716561, 'f1-score': 0.4182087641003958, 'support': 458892}}
[[69025 41101 37155]
 [50891 65200 49608]
 [52993 35129 57790]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115474
{'0': {'precision': 0.3304715232034882, 'recall': 0.8306908665105387, 'f1-score': 0.47283597608526123, 'support': 85400}, '1': {'precision': 0.3781591263650546, 'recall': 0.06706210437784958, 'f1-score': 0.11392155204015451, 'support': 90364}, '2': {'precision': 0.3880523083019616, 'recall': 0.16440196006421623, 'f1-score': 0.23095689089689633, 'support': 95303}, 'accuracy': 0.3418675087708943, 'macro avg': {'precision': 0.3655609859568348, 'recall': 0.3540516436508681, 'f1-score': 0.27257147300743734, 'support': 271067}, 'weighted avg': {'precision': 0.36661337792697574, 'recall': 0.3418675087708943, 'f1-score': 0.2681458239453151, 'support': 271067}}
[[70941  4467  9992]
 [69588  6060 14716]
 [74137  5498 15668]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026478
{'0': {'precision': 0.36619386580131896, 'recall': 0.7508182647421795, 'f1-score': 0.49228658375697015, 'support': 18637}, '1': {'precision': 0.33307003686150605, 'recall': 0.07268026429187015, 'f1-score': 0.11932273734848842, 'support': 17405}, '2': {'precision': 0.37584735124278185, 'recall': 0.25065580175252555, 'f1-score': 0.30074332016339655, 'support': 17917}, 'accuracy': 0.3660001111955373, 'macro avg': {'precision': 0.35837041796853564, 'recall': 0.35805144359552504, 'f1-score': 0.30411754708961836, 'support': 53959}, 'weighted avg': {'precision': 0.3587148772351344, 'recall': 0.3660001111955373, 'f1-score': 0.30838183384415335, 'support': 53959}}
[[13993  1326  3318]
 [12000  1265  4140]
 [12219  1207  4491]]
Evaluating performance on  val set...
81/81 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1062253
{'0': {'precision': 0.3435842342039884, 'recall': 0.7780142922305002, 'f1-score': 0.4766651141127154, 'support': 6577}, '1': {'precision': 0.3981623277182236, 'recall': 0.07115489874110564, 'f1-score': 0.12073368934293012, 'support': 7308}, '2': {'precision': 0.3717890941865705, 'recall': 0.24437203791469195, 'f1-score': 0.29490616621983917, 'support': 6752}, 'accuracy': 0.3531036487861608, 'macro avg': {'precision': 0.3711785520362609, 'recall': 0.36451374296209926, 'f1-score': 0.29743498989182826, 'support': 20637}, 'weighted avg': {'precision': 0.3721395436968617, 'recall': 0.3531036487861608, 'f1-score': 0.2911544648715325, 'support': 20637}}
[[5117  386 1074]
 [5074  520 1714]
 [4702  400 1650]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0354425
{'0': {'precision': 0.5092322643343051, 'recall': 0.2477301466148711, 'f1-score': 0.33331161938774334, 'support': 175562}, '1': {'precision': 0.4486557384762879, 'recall': 0.750388573002538, 'f1-score': 0.5615574606236173, 'support': 203308}, '2': {'precision': 0.4888581470126374, 'recall': 0.36258007265466846, 'f1-score': 0.4163548649035935, 'support': 180305}, 'accuracy': 0.4675226896767559, 'macro avg': {'precision': 0.48224871660774343, 'recall': 0.45356626409069256, 'f1-score': 0.43707464830498477, 'support': 559175}, 'weighted avg': {'precision': 0.4806379109693924, 'recall': 0.4675226896767559, 'f1-score': 0.44307567871213804, 'support': 559175}}
[[ 43492  96842  35228]
 [ 17621 152560  33127]
 [ 24294  90636  65375]]
Evaluating performance on  train set...
533/533 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96312255
{'0': {'precision': 0.5391102221741716, 'recall': 0.26264089328979245, 'f1-score': 0.3532078411928246, 'support': 37972}, '1': {'precision': 0.5546337072090703, 'recall': 0.7423110112505902, 'f1-score': 0.6348932259210004, 'support': 61419}, '2': {'precision': 0.47243696061619767, 'recall': 0.4556570777865141, 'f1-score': 0.4638953295793309, 'support': 36883}, 'accuracy': 0.5310697565199525, 'macro avg': {'precision': 0.5220602966664799, 'recall': 0.48686966077563226, 'f1-score': 0.48399879889771863, 'support': 136274}, 'weighted avg': {'precision': 0.5280613575434694, 'recall': 0.5310697565199525, 'f1-score': 0.5101220088167244, 'support': 136274}}
[[ 9973 20652  7347]
 [ 4407 45592 11420]
 [ 4119 15958 16806]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97750825
{'0': {'precision': 0.5434713375796179, 'recall': 0.25578955257438357, 'f1-score': 0.347857106456709, 'support': 13343}, '1': {'precision': 0.5704794337606838, 'recall': 0.7584783380681818, 'f1-score': 0.6511814024390243, 'support': 22528}, '2': {'precision': 0.42873851294903925, 'recall': 0.41618684616008433, 'f1-score': 0.42236944981687996, 'support': 12331}, 'accuracy': 0.5317621675449151, 'macro avg': {'precision': 0.5142297614297803, 'recall': 0.4768182456008832, 'f1-score': 0.47380265290420437, 'support': 48202}, 'weighted avg': {'precision': 0.5267431505800616, 'recall': 0.5317621675449151, 'f1-score': 0.5086824134121023, 'support': 48202}}
[[ 3413  7172  2758]
 [ 1361 17087  4080]
 [ 1506  5693  5132]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1068443
{'0': {'precision': 0.4078948487813178, 'recall': 0.41426682910391666, 'f1-score': 0.41105614663797463, 'support': 115737}, '1': {'precision': 0.27648524406077835, 'recall': 0.1959316638897869, 'f1-score': 0.22934070732062292, 'support': 80426}, '2': {'precision': 0.39878670368248653, 'recall': 0.47407756648680743, 'f1-score': 0.433184944074801, 'support': 114534}, 'accuracy': 0.3797976806985584, 'macro avg': {'precision': 0.3610555988415276, 'recall': 0.3614253531601703, 'f1-score': 0.3578605993444662, 'support': 310697}, 'weighted avg': {'precision': 0.3705210049398786, 'recall': 0.3797976806985584, 'f1-score': 0.37217535204739977, 'support': 310697}}
[[47946 22617 45174]
 [27982 15758 36686]
 [41617 18619 54298]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048061
{'0': {'precision': 0.36797979171832385, 'recall': 0.5403345090453977, 'f1-score': 0.4378047993509906, 'support': 43945}, '1': {'precision': 0.3550832184882858, 'recall': 0.15147198480531815, 'f1-score': 0.21235655867621886, 'support': 44226}, '2': {'precision': 0.3695707017617626, 'recall': 0.41082988618570193, 'f1-score': 0.38910962315311826, 'support': 42789}, 'accuracy': 0.36669975565058033, 'macro avg': {'precision': 0.36421123732279076, 'recall': 0.3675454600121393, 'f1-score': 0.3464236603934426, 'support': 130960}, 'weighted avg': {'precision': 0.36414434274288887, 'recall': 0.36669975565058033, 'f1-score': 0.34575919927147614, 'support': 130960}}
[[23745  6540 13660]
 [21200  6699 16327]
 [19583  5627 17579]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063501
{'0': {'precision': 0.3580417011114173, 'recall': 0.5505260927900572, 'f1-score': 0.43389453179351606, 'support': 14161}, '1': {'precision': 0.346201358863496, 'recall': 0.15459936560474416, 'f1-score': 0.2137477357231385, 'support': 14502}, '2': {'precision': 0.3757132308518494, 'recall': 0.3864264015465341, 'f1-score': 0.3809945202682005, 'support': 14484}, 'accuracy': 0.36236586552946903, 'macro avg': {'precision': 0.3599854302755876, 'recall': 0.36385061998044516, 'f1-score': 0.34287892926161834, 'support': 43147}, 'weighted avg': {'precision': 0.35999423068429753, 'recall': 0.36236586552946903, 'f1-score': 0.34214371241916125, 'support': 43147}}
[[7796 2260 4105]
 [7065 2242 5195]
 [6913 1974 5597]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
1095/1095 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152627
{'0': {'precision': 0.35461925451635035, 'recall': 0.626818916734034, 'f1-score': 0.4529721045713451, 'support': 98960}, '1': {'precision': 0.2741004862236629, 'recall': 0.33303138907486907, 'f1-score': 0.300705890720293, 'support': 76173}, '2': {'precision': 0.38125049528488786, 'recall': 0.04583825603109875, 'f1-score': 0.08183712523920901, 'support': 104956}, 'accuracy': 0.3292132143711463, 'macro avg': {'precision': 0.33665674534163365, 'recall': 0.33522952061333394, 'f1-score': 0.27850504017694905, 'support': 280089}, 'weighted avg': {'precision': 0.3427007299364623, 'recall': 0.3292132143711463, 'f1-score': 0.27248869680288623, 'support': 280089}}
[[62030 32484  4446]
 [47443 25368  3362]
 [65447 34698  4811]]
Evaluating performance on  train set...
448/448 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112692
{'0': {'precision': 0.33397492145263097, 'recall': 0.618218018914883, 'f1-score': 0.43367117220593776, 'support': 38171}, '1': {'precision': 0.3317539246569993, 'recall': 0.33638667441001, 'f1-score': 0.33405423826563385, 'support': 37882}, '2': {'precision': 0.36178343949044584, 'recall': 0.05162161460361975, 'f1-score': 0.09035131572967323, 'support': 38511}, 'accuracy': 0.3345640864494955, 'macro avg': {'precision': 0.34250409520002534, 'recall': 0.33540876930950425, 'f1-score': 0.28602557540041496, 'support': 114564}, 'weighted avg': {'precision': 0.3425884303868701, 'recall': 0.3345640864494955, 'f1-score': 0.28532370106069127, 'support': 114564}}
[[23598 12766  1807]
 [23439 12743  1700]
 [23621 12902  1988]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129603
{'0': {'precision': 0.3397795216741405, 'recall': 0.6235213440768044, 'f1-score': 0.43986212735078917, 'support': 11666}, '1': {'precision': 0.3205423381939115, 'recall': 0.34571875287409176, 'f1-score': 0.3326548672566372, 'support': 10873}, '2': {'precision': 0.35714285714285715, 'recall': 0.047817557626287394, 'f1-score': 0.08434256055363322, 'support': 12234}, 'accuracy': 0.334109797831651, 'macro avg': {'precision': 0.3391549056703031, 'recall': 0.3390192181923945, 'f1-score': 0.2856198517203532, 'support': 34773}, 'weighted avg': {'precision': 0.33987319061681875, 'recall': 0.334109797831651, 'f1-score': 0.28125944943401116, 'support': 34773}}
[[7274 3823  569]
 [6630 3759  484]
 [7504 4145  585]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1722/1722 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0953575
{'0': {'precision': 0.3842743137300867, 'recall': 0.7219562221984535, 'f1-score': 0.5015757978432769, 'support': 158939}, '1': {'precision': 0.32080867004089103, 'recall': 0.09252478268758144, 'f1-score': 0.14362618018883022, 'support': 121254}, '2': {'precision': 0.38581061545779277, 'recall': 0.25756821040309824, 'f1-score': 0.3089083624877253, 'support': 160606}, 'accuracy': 0.37961293015637515, 'macro avg': {'precision': 0.3636311997429235, 'recall': 0.3573497384297111, 'f1-score': 0.31803678017327747, 'support': 440799}, 'weighted avg': {'precision': 0.3673760814641111, 'recall': 0.37961293015637515, 'f1-score': 0.3329130534591336, 'support': 440799}}
[[114747  12772  31420]
 [ 75601  11219  34434]
 [108259  10980  41367]]
Evaluating performance on  train set...
618/618 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060984
{'0': {'precision': 0.36066482514985815, 'recall': 0.7214516614043001, 'f1-score': 0.4809135440548227, 'support': 53208}, '1': {'precision': 0.38334304018637155, 'recall': 0.06365939996518173, 'f1-score': 0.10918682193689659, 'support': 51697}, '2': {'precision': 0.3454371826524433, 'recall': 0.279576986879807, 'f1-score': 0.30903711112500265, 'support': 53048}, 'accuracy': 0.357758320513064, 'macro avg': {'precision': 0.3631483493295577, 'recall': 0.3548960160830963, 'f1-score': 0.2997124923722406, 'support': 157953}, 'weighted avg': {'precision': 0.3629731048504006, 'recall': 0.357758320513064, 'f1-score': 0.3015256415307078, 'support': 157953}}
[[38387  2723 12098]
 [32401  3291 16005]
 [35646  2571 14831]]
Evaluating performance on  val set...
225/225 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1078804
{'0': {'precision': 0.3557718523365505, 'recall': 0.6823363313114411, 'f1-score': 0.46768933013153646, 'support': 19124}, '1': {'precision': 0.3499152063312606, 'recall': 0.0982903720954851, 'f1-score': 0.15347107438016533, 'support': 18893}, '2': {'precision': 0.36362460384192485, 'recall': 0.2893612640897627, 'f1-score': 0.3222699914015477, 'support': 19429}, 'accuracy': 0.35734428854924627, 'macro avg': {'precision': 0.35643722083657864, 'recall': 0.3566626558322296, 'f1-score': 0.31447679863774985, 'support': 57446}, 'weighted avg': {'precision': 0.3565016071675218, 'recall': 0.35734428854924627, 'f1-score': 0.3151656063196852, 'support': 57446}}
[[13049  1759  4316]
 [11513  1857  5523]
 [12116  1691  5622]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
4450/4450 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0378261
{'0': {'precision': 0.5431694870812239, 'recall': 0.33031513254407097, 'f1-score': 0.41080769389184074, 'support': 407638}, '1': {'precision': 0.39393763233620493, 'recall': 0.5397352007744244, 'f1-score': 0.45545291571397734, 'support': 326436}, '2': {'precision': 0.487847288698688, 'recall': 0.5347330062930968, 'f1-score': 0.5102152829962003, 'support': 405047}, 'accuracy': 0.46301490359672065, 'macro avg': {'precision': 0.4749848027053723, 'recall': 0.4682611132038641, 'f1-score': 0.45882529753400614, 'support': 1139121}, 'weighted avg': {'precision': 0.48073297662816755, 'recall': 0.46301490359672065, 'f1-score': 0.4589488074124277, 'support': 1139121}}
[[134649 153738 119251]
 [ 42115 176189 108132]
 [ 71131 117324 216592]]
Evaluating performance on  train set...
1504/1504 - 23s - 23s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0377678
{'0': {'precision': 0.5671496146339849, 'recall': 0.26614768476118034, 'f1-score': 0.36228500190170304, 'support': 128842}, '1': {'precision': 0.41248439183069757, 'recall': 0.6084248302465476, 'f1-score': 0.4916514429525914, 'support': 126507}, '2': {'precision': 0.49588402683004734, 'recall': 0.5276202981385649, 'f1-score': 0.5112601318733956, 'support': 129470}, 'accuracy': 0.466640160698926, 'macro avg': {'precision': 0.49183934443157656, 'recall': 0.4673976043820976, 'f1-score': 0.4550655255758967, 'support': 384819}, 'weighted avg': {'precision': 0.4923274541009778, 'recall': 0.466640160698926, 'f1-score': 0.45493523599996677, 'support': 384819}}
[[34291 61672 32879]
 [12971 76970 36566]
 [13200 47959 68311]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0292883
{'0': {'precision': 0.5565747719159064, 'recall': 0.2682070151964064, 'f1-score': 0.3619800064495324, 'support': 41852}, '1': {'precision': 0.4308357808708977, 'recall': 0.607330903199676, 'f1-score': 0.5040806798020356, 'support': 44442}, '2': {'precision': 0.4920851242268582, 'recall': 0.5307913246036592, 'f1-score': 0.510705892592915, 'support': 44217}, 'accuracy': 0.47264981495812614, 'macro avg': {'precision': 0.49316522567122073, 'recall': 0.4687764143332472, 'f1-score': 0.458922192948161, 'support': 130511}, 'weighted avg': {'precision': 0.491908720840603, 'recall': 0.47264981495812614, 'f1-score': 0.46075674276090767, 'support': 130511}}
[[11225 19760 10867]
 [ 4093 26991 13358]
 [ 4850 15897 23470]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
6203/6203 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0184748
{'0': {'precision': 0.4857831676971566, 'recall': 0.3593195005241797, 'f1-score': 0.4130891351872536, 'support': 481705}, '1': {'precision': 0.4852046661164558, 'recall': 0.6464039437969549, 'f1-score': 0.5543227702206348, 'support': 609362}, '2': {'precision': 0.4654601070609228, 'recall': 0.39327545706884165, 'f1-score': 0.4263338890295101, 'support': 496807}, 'accuracy': 0.4801149209572044, 'macro avg': {'precision': 0.47881598029151173, 'recall': 0.4663329671299921, 'f1-score': 0.46458193147913285, 'support': 1587874}, 'weighted avg': {'precision': 0.4792025727219102, 'recall': 0.4801149209572044, 'f1-score': 0.47143286821224245, 'support': 1587874}}
[[173086 215001  93618]
 [ 84707 393894 130761]
 [ 98510 202915 195382]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0316124
{'0': {'precision': 0.49340856785238424, 'recall': 0.3368756934824708, 'f1-score': 0.40038661746577164, 'support': 145101}, '1': {'precision': 0.4533594975176527, 'recall': 0.6820426624289468, 'f1-score': 0.544671358981618, 'support': 163610}, '2': {'precision': 0.47080582478812566, 'recall': 0.35088637632607483, 'f1-score': 0.4020954551816528, 'support': 143280}, 'accuracy': 0.46625928392379495, 'macro avg': {'precision': 0.4725246300527209, 'recall': 0.45660157741249746, 'f1-score': 0.4490511438763474, 'support': 451991}, 'weighted avg': {'precision': 0.4717467440025457, 'recall': 0.46625928392379495, 'f1-score': 0.4531559620486042, 'support': 451991}}
[[ 48881  70287  25933]
 [ 21444 111589  30577]
 [ 28743  64262  50275]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0082695
{'0': {'precision': 0.5081896041362435, 'recall': 0.28920533668748033, 'f1-score': 0.36862823687713825, 'support': 44522}, '1': {'precision': 0.4994256645881195, 'recall': 0.7037924085758647, 'f1-score': 0.5842531777482209, 'support': 60542}, '2': {'precision': 0.4512413479782998, 'recall': 0.39260137648809523, 'f1-score': 0.4198838698447039, 'support': 43008}, 'accuracy': 0.488748716840456, 'macro avg': {'precision': 0.48628553890088755, 'recall': 0.4618663739171467, 'f1-score': 0.4575884281566877, 'support': 148072}, 'weighted avg': {'precision': 0.48806549539884975, 'recall': 0.488748716840456, 'f1-score': 0.4716778845680329, 'support': 148072}}
[[12876 23214  8432]
 [ 5831 42609 12102]
 [ 6630 19493 16885]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
5183/5183 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0761821
{'0': {'precision': 0.38314818262686445, 'recall': 0.4568033385292319, 'f1-score': 0.41674635872903726, 'support': 405448}, '1': {'precision': 0.4465057504358814, 'recall': 0.28165663039617705, 'f1-score': 0.3454210446207931, 'support': 495536}, '2': {'precision': 0.3771410810658077, 'recall': 0.4701377930568079, 'f1-score': 0.4185358113807473, 'support': 425856}, 'accuracy': 0.3956709173675801, 'macro avg': {'precision': 0.4022650047095178, 'recall': 0.402865920660739, 'f1-score': 0.39356773824352587, 'support': 1326840}, 'weighted avg': {'precision': 0.404882374752082, 'recall': 0.3956709173675801, 'f1-score': 0.39068277027564713, 'support': 1326840}}
[[185210  91131 129107]
 [154418 139571 201547]
 [143762  81883 200211]]
Evaluating performance on  train set...
1489/1489 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0663182
{'0': {'precision': 0.42498961628167037, 'recall': 0.4112491208001299, 'f1-score': 0.41800648139055285, 'support': 129379}, '1': {'precision': 0.42983753202979347, 'recall': 0.3736955150469894, 'f1-score': 0.3998052314158309, 'support': 125241}, '2': {'precision': 0.4028764252864179, 'recall': 0.4683226964657129, 'f1-score': 0.4331413315778887, 'support': 126447}, 'accuracy': 0.417845155838737, 'macro avg': {'precision': 0.4192345245326272, 'recall': 0.41775577743761066, 'f1-score': 0.4169843481280908, 'support': 381067}, 'weighted avg': {'precision': 0.41924524889859605, 'recall': 0.417845155838737, 'f1-score': 0.41704658104114944, 'support': 381067}}
[[53207 34470 41702]
 [32371 46802 46068]
 [39618 27611 59218]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0655427
{'0': {'precision': 0.416859289222768, 'recall': 0.4014981099696204, 'f1-score': 0.4090345291956576, 'support': 43121}, '1': {'precision': 0.4316617278322316, 'recall': 0.40492227425321276, 'f1-score': 0.4178646689541799, 'support': 46767}, '2': {'precision': 0.4034846884899683, 'recall': 0.4457120194102277, 'f1-score': 0.4235484514598621, 'support': 42864}, 'accuracy': 0.4169805351331807, 'macro avg': {'precision': 0.41733523518165594, 'recall': 0.4173774678776869, 'f1-score': 0.4168158832032332, 'support': 132752}, 'weighted avg': {'precision': 0.4177555225046625, 'recall': 0.4169805351331807, 'f1-score': 0.4168316539848862, 'support': 132752}}
[[17313 13353 12455]
 [12040 18937 15790]
 [12179 11580 19105]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
7324/7324 - 125s - 125s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908045
{'0': {'precision': 0.3759030779407558, 'recall': 0.49066518873232773, 'f1-score': 0.4256849962691873, 'support': 591817}, '1': {'precision': 0.43096120000460125, 'recall': 0.21404056028554166, 'f1-score': 0.28602457354169153, 'support': 700143}, '2': {'precision': 0.3562136420328254, 'recall': 0.46118720677619407, 'f1-score': 0.40195988253268156, 'support': 582746}, 'accuracy': 0.3781915671043886, 'macro avg': {'precision': 0.38769263999272746, 'recall': 0.3886309852646878, 'f1-score': 0.3712231507811868, 'support': 1874706}, 'weighted avg': {'precision': 0.39034513911650504, 'recall': 0.3781915671043886, 'f1-score': 0.3661514040796969, 'support': 1874706}}
[[290384 105976 195457]
 [260019 149859 290265]
 [222094  91897 268755]]
Evaluating performance on  train set...
2046/2046 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0798513
{'0': {'precision': 0.4039737337646661, 'recall': 0.47626013946207485, 'f1-score': 0.4371487910968298, 'support': 175675}, '1': {'precision': 0.4132794211534369, 'recall': 0.25961359620571006, 'f1-score': 0.3189004908522981, 'support': 172048}, '2': {'precision': 0.3929854002349388, 'recall': 0.46562214180617967, 'f1-score': 0.4262312984601944, 'support': 176029}, 'accuracy': 0.4015182758251997, 'macro avg': {'precision': 0.40341285171768054, 'recall': 0.40049862582465484, 'f1-score': 0.39409352680310744, 'support': 523752}, 'weighted avg': {'precision': 0.40333747756127, 'recall': 0.4015182758251997, 'f1-score': 0.394635962750961, 'support': 523752}}
[[83667 34420 57588]
 [58368 44666 69014]
 [65075 28991 81963]]
Evaluating performance on  val set...
741/741 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0792152
{'0': {'precision': 0.4054728381075686, 'recall': 0.4780037203682211, 'f1-score': 0.4387609909153928, 'support': 62897}, '1': {'precision': 0.4173633142671885, 'recall': 0.2796257796257796, 'f1-score': 0.33488484443081834, 'support': 64454}, '2': {'precision': 0.38789631741374775, 'recall': 0.450344639213355, 'f1-score': 0.41679430177400406, 'support': 62239}, 'accuracy': 0.40148214568278917, 'macro avg': {'precision': 0.40357748992950165, 'recall': 0.4026580464024519, 'f1-score': 0.3968133790400717, 'support': 189590}, 'weighted avg': {'precision': 0.40374512925651856, 'recall': 0.40148214568278917, 'f1-score': 0.3962354467886579, 'support': 189590}}
[[30065 13624 19208]
 [21409 18023 25022]
 [22674 11536 28029]]
testing model on single stock: results/universal/W6/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
29350/29350 - 422s - 422s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1200671
{'0': {'precision': 0.32592223989992947, 'recall': 0.6329211780778441, 'f1-score': 0.4302748168711209, 'support': 2255946}, '1': {'precision': 0.41090300823325554, 'recall': 0.06560315450948766, 'f1-score': 0.11314243401335765, 'support': 3025510}, '2': {'precision': 0.3255834317498744, 'recall': 0.38648660273447233, 'f1-score': 0.35343050079270283, 'support': 2231948}, 'accuracy': 0.3312662276645845, 'macro avg': {'precision': 0.35413622662768646, 'recall': 0.36167031177393466, 'f1-score': 0.29894925055906046, 'support': 7513404}, 'weighted avg': {'precision': 0.3600417897374282, 'recall': 0.3312662276645845, 'f1-score': 0.2797438839886905, 'support': 7513404}}
[[1427836  149900  678210]
 [1718402  198483 1108625]
 [1234672  134658  862618]]
Evaluating performance on  train set...
5452/5452 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007911
{'0': {'precision': 0.3651699725096992, 'recall': 0.762938248179851, 'f1-score': 0.49392803634413757, 'support': 469055}, '1': {'precision': 0.4337706699790389, 'recall': 0.060816959173810636, 'f1-score': 0.10667720570406308, 'support': 459362}, '2': {'precision': 0.3517494189490954, 'recall': 0.26441041583700525, 'f1-score': 0.3018898827348664, 'support': 467058}, 'accuracy': 0.3649596015693581, 'macro avg': {'precision': 0.38356335381261114, 'recall': 0.36272187439688897, 'f1-score': 0.30083170826102235, 'support': 1395475}, 'weighted avg': {'precision': 0.3832601401486769, 'recall': 0.3649596015693581, 'f1-score': 0.30217879539541054, 'support': 1395475}}
[[357860  19719  91476]
 [295308  27937 136117]
 [326814  16749 123495]]
Evaluating performance on  val set...
1969/1969 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1074252
{'0': {'precision': 0.3543634686346864, 'recall': 0.7200187441424555, 'f1-score': 0.47496754250386397, 'support': 160050}, '1': {'precision': 0.47458521870286574, 'recall': 0.06690766041146137, 'f1-score': 0.11728090201742532, 'support': 188110}, '2': {'precision': 0.33644473326637914, 'recall': 0.3287621149047805, 'f1-score': 0.3325590599715811, 'support': 155903}, 'accuracy': 0.35527305118606206, 'macro avg': {'precision': 0.3884644735346437, 'recall': 0.37189617315289913, 'f1-score': 0.3082691681642901, 'support': 504063}, 'weighted avg': {'precision': 0.3936865865885929, 'recall': 0.35527305118606206, 'f1-score': 0.2974374647276049, 'support': 504063}}
[[115239   7212  37599]
 [112035  12586  63489]
 [ 97926   6722  51255]]
training model: results/universal/W6/deepVOL_L3/h200
Epoch 1/50
9426/9426 - 536s - loss: 3.2209 - accuracy200: 0.4024 - val_loss: 3.3231 - val_accuracy200: 0.3627 - 536s/epoch - 57ms/step
Epoch 2/50
9426/9426 - 538s - loss: 3.2131 - accuracy200: 0.4062 - val_loss: 3.3037 - val_accuracy200: 0.3574 - 538s/epoch - 57ms/step
Epoch 3/50
9426/9426 - 547s - loss: 3.2115 - accuracy200: 0.4083 - val_loss: 3.3058 - val_accuracy200: 0.3645 - 547s/epoch - 58ms/step
Epoch 4/50
9426/9426 - 543s - loss: 3.2041 - accuracy200: 0.4121 - val_loss: 3.3057 - val_accuracy200: 0.3598 - 543s/epoch - 58ms/step
Epoch 5/50
9426/9426 - 542s - loss: 3.1961 - accuracy200: 0.4172 - val_loss: 3.3074 - val_accuracy200: 0.3627 - 542s/epoch - 58ms/step
Epoch 6/50
9426/9426 - 560s - loss: 3.1889 - accuracy200: 0.4210 - val_loss: 3.3161 - val_accuracy200: 0.3642 - 560s/epoch - 59ms/step
Epoch 7/50
9426/9426 - 540s - loss: 3.1852 - accuracy200: 0.4230 - val_loss: 3.3194 - val_accuracy200: 0.3665 - 540s/epoch - 57ms/step
Epoch 8/50
9426/9426 - 544s - loss: 3.1794 - accuracy200: 0.4255 - val_loss: 3.3369 - val_accuracy200: 0.3650 - 544s/epoch - 58ms/step
Epoch 9/50
9426/9426 - 541s - loss: 3.1729 - accuracy200: 0.4277 - val_loss: 3.3248 - val_accuracy200: 0.3660 - 541s/epoch - 57ms/step
Epoch 10/50
9426/9426 - 553s - loss: 3.1680 - accuracy200: 0.4297 - val_loss: 3.3254 - val_accuracy200: 0.3644 - 553s/epoch - 59ms/step
Epoch 11/50
9426/9426 - 567s - loss: 3.1641 - accuracy200: 0.4305 - val_loss: 3.3274 - val_accuracy200: 0.3639 - 567s/epoch - 60ms/step
Epoch 12/50
9426/9426 - 576s - loss: 3.1608 - accuracy200: 0.4317 - val_loss: 3.3152 - val_accuracy200: 0.3644 - 576s/epoch - 61ms/step
testing model in sample: results/universal/W6/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
42263/42263 - 1352s - 1352s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016656
{'0': {'precision': 0.3590556825946486, 'recall': 0.06715973409079344, 'f1-score': 0.1131544436115118, 'support': 3340990}, '1': {'precision': 0.37183072245238163, 'recall': 0.7182262046166221, 'f1-score': 0.4899901315519554, 'support': 4073931}, '2': {'precision': 0.331142782043158, 'recall': 0.22615071563130562, 'f1-score': 0.2687566872669549, 'support': 3403708}, 'accuracy': 0.36235044200147726, 'macro avg': {'precision': 0.3540097290300628, 'recall': 0.33717888477957375, 'f1-score': 0.29063375414347403, 'support': 10818629}, 'weighted avg': {'precision': 0.35508450177241513, 'recall': 0.36235044200147726, 'f1-score': 0.3040129334030446, 'support': 10818629}}
[[ 224380 2472164  644446]
 [ 237595 2926004  910332]
 [ 162942 2471015  769751]]
Evaluating performance on  train set...
9426/9426 - 297s - 297s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090577
{'0': {'precision': 0.4117001572057839, 'recall': 0.0654143780310768, 'f1-score': 0.112891591976099, 'support': 808706}, '1': {'precision': 0.32202017194453136, 'recall': 0.7189504752051141, 'f1-score': 0.4448089987533943, 'support': 800286}, '2': {'precision': 0.36325221443720496, 'recall': 0.22475401733301628, 'f1-score': 0.2776922763355338, 'support': 803207}, 'accuracy': 0.3352919887621212, 'macro avg': {'precision': 0.3656575145291734, 'recall': 0.3363729568564024, 'f1-score': 0.2784642890216757, 'support': 2412199}, 'weighted avg': {'precision': 0.36581531791511646, 'recall': 0.3352919887621212, 'f1-score': 0.277885407611734, 'support': 2412199}}
[[ 52901 618371 137434]
 [ 45912 575366 179008]
 [ 29681 593002 180524]]
Evaluating performance on  val set...
3323/3323 - 103s - 103s/epoch - 31ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016959
{'0': {'precision': 0.39895405304445275, 'recall': 0.07066529923578257, 'f1-score': 0.12006407914336302, 'support': 272043}, '1': {'precision': 0.35560407009175016, 'recall': 0.7203413219732514, 'f1-score': 0.4761511278139008, 'support': 307979}, '2': {'precision': 0.35237058688224765, 'recall': 0.23238579393885578, 'f1-score': 0.28006849101278414, 'support': 270279}, 'accuracy': 0.35738285618857324, 'macro avg': {'precision': 0.36897623667281687, 'recall': 0.34113080504929655, 'f1-score': 0.292094565990016, 'support': 850301}, 'weighted avg': {'precision': 0.36844554246920347, 'recall': 0.35738285618857324, 'f1-score': 0.29989823857415143, 'support': 850301}}
[[ 19224 206016  46803]
 [ 17494 221850  68635]
 [ 11468 196002  62809]]
testing model out of sample: results/universal/W6/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
17522/17522 - 532s - 532s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027533
{'0': {'precision': 0.38318236595023375, 'recall': 0.08087131203381837, 'f1-score': 0.13355550080860729, 'support': 1431175}, '1': {'precision': 0.3427594037280713, 'recall': 0.691674231657963, 'f1-score': 0.4583722707908305, 'support': 1589559}, '2': {'precision': 0.3458403345406678, 'recall': 0.23036050720802725, 'f1-score': 0.27652842240216147, 'support': 1464409}, 'accuracy': 0.3461517280496965, 'macro avg': {'precision': 0.35726070140632427, 'recall': 0.3343020169666029, 'f1-score': 0.2894853980005331, 'support': 4485143}, 'weighted avg': {'precision': 0.35666399400950644, 'recall': 0.3461517280496965, 'f1-score': 0.2953532970470032, 'support': 4485143}}
[[ 115741 1055911  259523]
 [ 111540 1099457  378562]
 [  74771 1052296  337342]]
Evaluating performance on  train set...
5153/5153 - 167s - 167s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130164
{'0': {'precision': 0.41327773796338524, 'recall': 0.07057930798142334, 'f1-score': 0.12056807684851158, 'support': 449381}, '1': {'precision': 0.31549804111842455, 'recall': 0.6956668629626935, 'f1-score': 0.4341161993457043, 'support': 426227}, '2': {'precision': 0.36119424727195676, 'recall': 0.24626698900920302, 'f1-score': 0.2928589164558321, 'support': 443007}, 'accuracy': 0.33165632121582117, 'macro avg': {'precision': 0.3633233421179222, 'recall': 0.33750438665110666, 'f1-score': 0.282514397550016, 'support': 1318615}, 'weighted avg': {'precision': 0.3641734142541337, 'recall': 0.33165632121582117, 'f1-score': 0.2798023670617514, 'support': 1318615}}
[[ 31717 328922  88742]
 [ 25507 296512 104208]
 [ 19521 314388 109098]]
Evaluating performance on  val set...
1795/1795 - 57s - 57s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080906
{'0': {'precision': 0.4180691868492742, 'recall': 0.07286361892125683, 'f1-score': 0.12409858764885075, 'support': 153753}, '1': {'precision': 0.32375854576289154, 'recall': 0.6789730379978556, 'f1-score': 0.43844898665692833, 'support': 152956}, '2': {'precision': 0.3652108298449543, 'recall': 0.26715204720632396, 'f1-score': 0.30857858484658734, 'support': 152183}, 'accuracy': 0.3393216704584085, 'macro avg': {'precision': 0.36901285415237334, 'recall': 0.3396629013751455, 'f1-score': 0.29037538638412214, 'support': 458892}, 'weighted avg': {'precision': 0.36910445928375296, 'recall': 0.3393216704584085, 'f1-score': 0.29005593500775584, 'support': 458892}}
[[ 11203 111889  30661]
 [  9098 103853  40005]
 [  6496 105031  40656]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
1059/1059 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045905
{'0': {'precision': 0.2677017019618033, 'recall': 0.05022179974651458, 'f1-score': 0.0845767060030785, 'support': 82056}, '1': {'precision': 0.3414030443414957, 'recall': 0.8116621562086979, 'f1-score': 0.4806387895050686, 'support': 95334}, '2': {'precision': 0.3261551183544086, 'recall': 0.10104935042753291, 'f1-score': 0.15429502852485738, 'support': 93677}, 'accuracy': 0.3355849291872489, 'macro avg': {'precision': 0.31175328821923587, 'recall': 0.32097776879424844, 'f1-score': 0.2398368413443348, 'support': 271067}, 'weighted avg': {'precision': 0.3138230832506938, 'recall': 0.3355849291872489, 'f1-score': 0.24796504160811858, 'support': 271067}}
[[ 4121 70173  7762]
 [ 6160 77379 11795]
 [ 5113 79098  9466]]
Evaluating performance on  train set...
211/211 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1163414
{'0': {'precision': 0.37672880336740827, 'recall': 0.06782505142362238, 'f1-score': 0.11495412844036697, 'support': 18474}, '1': {'precision': 0.3249494501158949, 'recall': 0.7569213095921884, 'f1-score': 0.45469601821820443, 'support': 17410}, '2': {'precision': 0.3593610477229884, 'recall': 0.20038727524204702, 'f1-score': 0.25729914044185553, 'support': 18075}, 'accuracy': 0.33456883930391595, 'macro avg': {'precision': 0.35367976706876386, 'recall': 0.3417112120859526, 'f1-score': 0.275649762366809, 'support': 53959}, 'weighted avg': {'precision': 0.35420428061158, 'recall': 0.33456883930391595, 'f1-score': 0.27225490111886463, 'support': 53959}}
[[ 1253 13976  3245]
 [ 1020 13178  3212]
 [ 1053 13400  3622]]
Evaluating performance on  val set...
81/81 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126846
{'0': {'precision': 0.41043083900226757, 'recall': 0.10298719772403983, 'f1-score': 0.1646577211735274, 'support': 7030}, '1': {'precision': 0.31516172506738543, 'recall': 0.7168914776210914, 'f1-score': 0.4378393559258566, 'support': 6524}, '2': {'precision': 0.3674683858170097, 'recall': 0.2092333756882677, 'f1-score': 0.26664267722202234, 'support': 7083}, 'accuracy': 0.33352715995541987, 'macro avg': {'precision': 0.36435364996222086, 'recall': 0.3430373503444663, 'f1-score': 0.2897132514404688, 'support': 20637}, 'weighted avg': {'precision': 0.36556778937187784, 'recall': 0.33352715995541987, 'f1-score': 0.2860220875453685, 'support': 20637}}
[[ 724 5110 1196]
 [ 492 4677 1355]
 [ 548 5053 1482]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
2185/2185 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1180174
{'0': {'precision': 0.4067948194194482, 'recall': 0.18371895881120973, 'f1-score': 0.2531216829435023, 'support': 200540}, '1': {'precision': 0.2508830323202561, 'recall': 0.454472969767258, 'f1-score': 0.32329648128139205, 'support': 151756}, '2': {'precision': 0.4317995260736909, 'recall': 0.40429429763291586, 'f1-score': 0.417594487992411, 'support': 206879}, 'accuracy': 0.3388062771046631, 'macro avg': {'precision': 0.3631591259377984, 'recall': 0.34749540873712786, 'f1-score': 0.3313375507391018, 'support': 559175}, 'weighted avg': {'precision': 0.3737325393548854, 'recall': 0.3388062771046631, 'f1-score': 0.33301691454770127, 'support': 559175}}
[[ 36843 105867  57830]
 [ 30556  68969  52231]
 [ 23170 100069  83640]]
Evaluating performance on  train set...
533/533 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0892632
{'0': {'precision': 0.4676845031949661, 'recall': 0.2077528114233711, 'f1-score': 0.2877032947248394, 'support': 46151}, '1': {'precision': 0.33022750469166695, 'recall': 0.4300568120913281, 'f1-score': 0.37358810328612263, 'support': 46645}, '2': {'precision': 0.40211169062460245, 'recall': 0.5089240535443212, 'f1-score': 0.44925638292472464, 'support': 43478}, 'accuracy': 0.3799330760086297, 'macro avg': {'precision': 0.4000078995037452, 'recall': 0.3822445590196735, 'f1-score': 0.37018259364522893, 'support': 136274}, 'weighted avg': {'precision': 0.39971367647731887, 'recall': 0.3799330760086297, 'f1-score': 0.36864391482915615, 'support': 136274}}
[[ 9588 22542 14021]
 [ 7706 20060 18879]
 [ 3207 18144 22127]]
Evaluating performance on  val set...
189/189 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086006
{'0': {'precision': 0.45733882030178324, 'recall': 0.2, 'f1-score': 0.27829716193656096, 'support': 16670}, '1': {'precision': 0.3253909843606256, 'recall': 0.41979704468577533, 'f1-score': 0.3666139773522324, 'support': 16851}, '2': {'precision': 0.3342374295848112, 'recall': 0.4364825284381173, 'f1-score': 0.37857796945617816, 'support': 14681}, 'accuracy': 0.34886519231567154, 'macro avg': {'precision': 0.37232241141574, 'recall': 0.3520931910412976, 'f1-score': 0.34116303624832384, 'support': 48202}, 'weighted avg': {'precision': 0.3737177153567537, 'recall': 0.34886519231567154, 'f1-score': 0.3397147212030847, 'support': 48202}}
[[3334 7992 5344]
 [2357 7074 7420]
 [1599 6674 6408]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1214/1214 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1407899
{'0': {'precision': 0.4607689127738735, 'recall': 0.04746088926360253, 'f1-score': 0.08605753640420635, 'support': 117423}, '1': {'precision': 0.24305228942610185, 'recall': 0.6056541611865665, 'f1-score': 0.34689410071191235, 'support': 76793}, '2': {'precision': 0.3945395546604006, 'recall': 0.3632523759239704, 'f1-score': 0.3782500838082467, 'support': 116481}, 'accuracy': 0.3038169019977663, 'macro avg': {'precision': 0.36612025228679196, 'recall': 0.3387891421247131, 'f1-score': 0.27040057364145514, 'support': 310697}, 'weighted avg': {'precision': 0.38212774623811396, 'recall': 0.3038169019977663, 'f1-score': 0.26007048920726433, 'support': 310697}}
[[ 5573 74345 37505]
 [ 2856 46510 27427]
 [ 3666 70503 42312]]
Evaluating performance on  train set...
512/512 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1173096
{'0': {'precision': 0.39291815499301136, 'recall': 0.056164809306042715, 'f1-score': 0.09828105273380597, 'support': 45046}, '1': {'precision': 0.3209022524481979, 'recall': 0.7033789911862515, 'f1-score': 0.44073032479927726, 'support': 43001}, '2': {'precision': 0.3414166776793974, 'recall': 0.24081280730780882, 'f1-score': 0.28242303330099344, 'support': 42913}, 'accuracy': 0.32918448381185095, 'macro avg': {'precision': 0.35174569504020226, 'recall': 0.33345220260003433, 'f1-score': 0.2738114702780256, 'support': 130960}, 'weighted avg': {'precision': 0.3523955624358287, 'recall': 0.32918448381185095, 'f1-score': 0.2710646962903656, 'support': 130960}}
[[ 2530 33074  9442]
 [ 2263 30246 10492]
 [ 1646 30933 10334]]
Evaluating performance on  val set...
169/169 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208116
{'0': {'precision': 0.43528534129056323, 'recall': 0.07711623604044142, 'f1-score': 0.13102054563826204, 'support': 15133}, '1': {'precision': 0.29379387117721634, 'recall': 0.7492311331913887, 'f1-score': 0.42207907596623717, 'support': 12681}, '2': {'precision': 0.390057831918297, 'recall': 0.20674362486141004, 'f1-score': 0.27024722932651324, 'support': 15333}, 'accuracy': 0.3207175469905208, 'macro avg': {'precision': 0.37304568146202555, 'recall': 0.34436366469774665, 'f1-score': 0.2744489503103375, 'support': 43147}, 'weighted avg': {'precision': 0.37762833770486065, 'recall': 0.3207175469905208, 'f1-score': 0.26603980454574133, 'support': 43147}}
[[ 1167 11412  2554]
 [  777  9501  2403]
 [  737 11426  3170]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
1095/1095 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1285244
{'0': {'precision': 0.33613013698630134, 'recall': 0.01990448281806106, 'f1-score': 0.03758340433271747, 'support': 98621}, '1': {'precision': 0.2621810515744819, 'recall': 0.9685479691208162, 'f1-score': 0.412657735008092, 'support': 73318}, '2': {'precision': 0.39994114184814594, 'recall': 0.012565880721220528, 'f1-score': 0.024366192132534874, 'support': 108150}, 'accuracy': 0.2653942139819843, 'macro avg': {'precision': 0.33275077680297643, 'recall': 0.3336727775533659, 'f1-score': 0.15820244382444812, 'support': 280089}, 'weighted avg': {'precision': 0.34141189075594136, 'recall': 0.2653942139819843, 'f1-score': 0.1306618839481517, 'support': 280089}}
[[  1963  95411   1247]
 [  1514  71012    792]
 [  2363 104428   1359]]
Evaluating performance on  train set...
448/448 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096122
{'0': {'precision': 0.35873388042203985, 'recall': 0.016169515707152103, 'f1-score': 0.03094425483503982, 'support': 37849}, '1': {'precision': 0.3319060699089783, 'recall': 0.9760829967529896, 'f1-score': 0.495367858362975, 'support': 37881}, '2': {'precision': 0.3791208791208791, 'recall': 0.014214348251532163, 'f1-score': 0.027401340282948623, 'support': 38834}, 'accuracy': 0.33290562480360325, 'macro avg': {'precision': 0.3565869431506324, 'recall': 0.3354889535705579, 'f1-score': 0.18457115116032116, 'support': 114564}, 'weighted avg': {'precision': 0.3567737918900878, 'recall': 0.33290562480360325, 'f1-score': 0.18330664600090169, 'support': 114564}}
[[  612 36765   472]
 [  474 36975   432]
 [  620 37662   552]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200064
{'0': {'precision': 0.38311688311688313, 'recall': 0.02023666609500943, 'f1-score': 0.03844274311777162, 'support': 11662}, '1': {'precision': 0.2957767364612373, 'recall': 0.9726909197308105, 'f1-score': 0.45361715676241154, 'support': 10253}, '2': {'precision': 0.3553530751708428, 'recall': 0.012132524498366775, 'f1-score': 0.023463939234413776, 'support': 12858}, 'accuracy': 0.29807609352083514, 'macro avg': {'precision': 0.34474889824965443, 'recall': 0.3350200367747289, 'f1-score': 0.17184127970486565, 'support': 34773}, 'weighted avg': {'precision': 0.3470979728637982, 'recall': 0.29807609352083514, 'f1-score': 0.15532037239238924, 'support': 34773}}
[[  236 11256   170]
 [  167  9973   113]
 [  213 12489   156]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1722/1722 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1195055
{'0': {'precision': 0.39909653842249515, 'recall': 0.051460097645257136, 'f1-score': 0.09116521739130434, 'support': 152798}, '1': {'precision': 0.27454182594229815, 'recall': 0.7770604826073331, 'f1-score': 0.40573437701340326, 'support': 127640}, '2': {'precision': 0.35683482098084446, 'recall': 0.13312463753655815, 'f1-score': 0.19390790555300721, 'support': 160361}, 'accuracy': 0.2912778840242378, 'macro avg': {'precision': 0.3434910617818792, 'recall': 0.3205484059297161, 'f1-score': 0.2302691666525716, 'support': 440799}, 'weighted avg': {'precision': 0.34765519038941683, 'recall': 0.2912778840242378, 'f1-score': 0.21963086216468977, 'support': 440799}}
[[  7863 129024  15911]
 [  5889  99184  22567]
 [  5950 133063  21348]]
Evaluating performance on  train set...
618/618 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132302
{'0': {'precision': 0.3786931205520811, 'recall': 0.03301993230537796, 'f1-score': 0.06074337997474791, 'support': 53180}, '1': {'precision': 0.315807603181562, 'recall': 0.7735823729073581, 'f1-score': 0.4485137561637286, 'support': 52147}, '2': {'precision': 0.32114933541829555, 'recall': 0.156101546763957, 'f1-score': 0.21008618264583281, 'support': 52626}, 'accuracy': 0.31851879989617166, 'macro avg': {'precision': 0.33855001971731286, 'recall': 0.320901283992231, 'f1-score': 0.23978110626143645, 'support': 157953}, 'weighted avg': {'precision': 0.33875978398505757, 'recall': 0.31851879989617166, 'f1-score': 0.2385201625651089, 'support': 157953}}
[[ 1756 44264  7160]
 [ 1602 40340 10205]
 [ 1279 43132  8215]]
Evaluating performance on  val set...
225/225 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134747
{'0': {'precision': 0.36300174520069806, 'recall': 0.054722441462772956, 'f1-score': 0.0951074531321445, 'support': 19005}, '1': {'precision': 0.3208146404299738, 'recall': 0.7613851992409867, 'f1-score': 0.45142035688615273, 'support': 18972}, '2': {'precision': 0.33647305075876505, 'recall': 0.1651343160922492, 'f1-score': 0.22154079382579933, 'support': 19469}, 'accuracy': 0.3255230999547401, 'macro avg': {'precision': 0.3400964787964789, 'recall': 0.3270806522653363, 'f1-score': 0.25602286794803214, 'support': 57446}, 'weighted avg': {'precision': 0.3400782883229316, 'recall': 0.3255230999547401, 'f1-score': 0.2556321044566198, 'support': 57446}}
[[ 1040 15166  2799]
 [  986 14445  3541]
 [  839 15415  3215]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
4450/4450 - 66s - 66s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035892
{'0': {'precision': 0.4407895818603351, 'recall': 0.14094003837964303, 'f1-score': 0.21358685692887475, 'support': 380410}, '1': {'precision': 0.32010086246816394, 'recall': 0.45772742557098883, 'f1-score': 0.3767385320222004, 'support': 386610}, '2': {'precision': 0.37353520353810893, 'recall': 0.46644593806520274, 'f1-score': 0.4148521193753018, 'support': 372101}, 'accuracy': 0.3547840835170276, 'macro avg': {'precision': 0.37814188262220266, 'recall': 0.35503780067194485, 'f1-score': 0.33505916944212566, 'support': 1139121}, 'weighted avg': {'precision': 0.3778595794880797, 'recall': 0.3547840835170276, 'f1-score': 0.33470399420350017, 'support': 1139121}}
[[ 53615 201647 125148]
 [ 43706 176962 165942]
 [ 24313 174223 173565]]
Evaluating performance on  train set...
1504/1504 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013513
{'0': {'precision': 0.4667289450991664, 'recall': 0.15071820298419722, 'f1-score': 0.22785609458045125, 'support': 129281}, '1': {'precision': 0.3202720855125897, 'recall': 0.44590346583900364, 'f1-score': 0.37278775781769796, 'support': 125655}, '2': {'precision': 0.4017582051556571, 'recall': 0.5200526627811184, 'f1-score': 0.4533151683338423, 'support': 129883}, 'accuracy': 0.37176178930873993, 'macro avg': {'precision': 0.3962530785891378, 'recall': 0.37222477720143976, 'f1-score': 0.3513196735773305, 'support': 384819}, 'weighted avg': {'precision': 0.39697763004602676, 'recall': 0.37176178930873993, 'f1-score': 0.3512769470341708, 'support': 384819}}
[[19485 64880 44916]
 [13961 56030 55664]
 [ 8302 54035 67546]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0864974
{'0': {'precision': 0.4433668936926266, 'recall': 0.14987487487487489, 'f1-score': 0.22402184484177448, 'support': 39960}, '1': {'precision': 0.3616764540262248, 'recall': 0.4781554430595142, 'f1-score': 0.41183852558876605, 'support': 47014}, '2': {'precision': 0.40212952158693116, 'recall': 0.5066035785653582, 'f1-score': 0.4483610306449154, 'support': 43537}, 'accuracy': 0.3871321191317207, 'macro avg': {'precision': 0.40239095643526085, 'recall': 0.3782112988332491, 'f1-score': 0.3614071336918186, 'support': 130511}, 'weighted avg': {'precision': 0.4001832095599338, 'recall': 0.3871321191317207, 'f1-score': 0.36651610632893195, 'support': 130511}}
[[ 5989 20974 12997]
 [ 4739 22480 19795]
 [ 2780 18701 22056]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
6203/6203 - 90s - 90s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931756
{'0': {'precision': 0.3988452143015767, 'recall': 0.12952545795470935, 'f1-score': 0.19554684522837384, 'support': 499176}, '1': {'precision': 0.34189305181208346, 'recall': 0.6644013294542828, 'f1-score': 0.45146669281660723, 'support': 564743}, '2': {'precision': 0.3732988120621383, 'recall': 0.2339017663730664, 'f1-score': 0.2875993687335363, 'support': 523955}, 'accuracy': 0.3542006481622597, 'macro avg': {'precision': 0.37134569272526613, 'recall': 0.3426095179273529, 'f1-score': 0.31153763559283915, 'support': 1587874}, 'weighted avg': {'precision': 0.37016000358198003, 'recall': 0.3542006481622597, 'f1-score': 0.3169420708191128, 'support': 1587874}}
[[ 64656 358132  76388]
 [ 60169 375216 129358]
 [ 37283 364118 122554]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1107111
{'0': {'precision': 0.44217224594131566, 'recall': 0.10296548186705674, 'f1-score': 0.1670347732292362, 'support': 157917}, '1': {'precision': 0.30640286326362864, 'recall': 0.6678422299966144, 'f1-score': 0.4200765759970186, 'support': 141776}, '2': {'precision': 0.38009416195856877, 'recall': 0.26504615950307947, 'f1-score': 0.3123118940958924, 'support': 152298}, 'accuracy': 0.33476330280912675, 'macro avg': {'precision': 0.3762230903878377, 'recall': 0.3452846237889169, 'f1-score': 0.29980774777404906, 'support': 451991}, 'weighted avg': {'precision': 0.3786683088431962, 'recall': 0.33476330280912675, 'f1-score': 0.29535739377467873, 'support': 451991}}
[[ 16260 111060  30597]
 [ 11855  94684  35237]
 [  8658 103274  40366]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1025583
{'0': {'precision': 0.4361904761904762, 'recall': 0.09709855230480344, 'f1-score': 0.15883868410622276, 'support': 49527}, '1': {'precision': 0.32645328005906493, 'recall': 0.5925699645250295, 'f1-score': 0.4209826241581608, 'support': 50740}, '2': {'precision': 0.36756035154077205, 'recall': 0.34557054701391066, 'f1-score': 0.3562264150943396, 'support': 47805}, 'accuracy': 0.34710141012480417, 'macro avg': {'precision': 0.37673470259677105, 'recall': 0.34507968794791455, 'f1-score': 0.31201590778624105, 'support': 148072}, 'weighted avg': {'precision': 0.376429492070677, 'recall': 0.34710141012480417, 'f1-score': 0.312394413738579, 'support': 148072}}
[[ 4809 32991 11727]
 [ 3975 30067 16698]
 [ 2241 29044 16520]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
5183/5183 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1173619
{'0': {'precision': 0.403332895945414, 'recall': 0.06854382831262835, 'f1-score': 0.11717458968117975, 'support': 448443}, '1': {'precision': 0.28652763353879707, 'recall': 0.6728201159753794, 'f1-score': 0.40190130372505906, 'support': 392842}, '2': {'precision': 0.39253543959727455, 'recall': 0.265296413382624, 'f1-score': 0.31661052525503275, 'support': 485555}, 'accuracy': 0.3194552470531488, 'macro avg': {'precision': 0.36079865636049524, 'recall': 0.3355534525568773, 'f1-score': 0.2785621395537572, 'support': 1326840}, 'weighted avg': {'precision': 0.3647986553350457, 'recall': 0.3194552470531488, 'f1-score': 0.2744578548043203, 'support': 1326840}}
[[ 30738 321730  95975]
 [ 25157 264312 103373]
 [ 20315 336424 128816]]
Evaluating performance on  train set...
1489/1489 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119909
{'0': {'precision': 0.42400939869699883, 'recall': 0.06122669298746164, 'f1-score': 0.10700231793434317, 'support': 129682}, '1': {'precision': 0.32576382046337227, 'recall': 0.6778568465392347, 'f1-score': 0.44004920049200485, 'support': 125348}, '2': {'precision': 0.37327856256279923, 'recall': 0.3006498091830177, 'f1-score': 0.3330506128296514, 'support': 126037}, 'accuracy': 0.34324934985186334, 'macro avg': {'precision': 0.37435059390772346, 'recall': 0.346577782903238, 'f1-score': 0.29336737708533317, 'support': 381067}, 'weighted avg': {'precision': 0.37491344146565964, 'recall': 0.34324934985186334, 'f1-score': 0.2913195366348807, 'support': 381067}}
[[ 7940 92032 29710]
 [ 6469 84968 33911]
 [ 4317 83827 37893]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082923
{'0': {'precision': 0.3989968528717545, 'recall': 0.09142741244873123, 'f1-score': 0.14876608851893952, 'support': 44374}, '1': {'precision': 0.3297779273216689, 'recall': 0.665783574485429, 'f1-score': 0.4410791836367318, 'support': 44163}, '2': {'precision': 0.38014600287218764, 'recall': 0.28736854008820534, 'f1-score': 0.32730972835817046, 'support': 44215}, 'accuracy': 0.3477612390020489, 'macro avg': {'precision': 0.36964026102187036, 'recall': 0.34819317567412184, 'f1-score': 0.3057183335046139, 'support': 132752}, 'weighted avg': {'precision': 0.3696910364486552, 'recall': 0.3477612390020489, 'f1-score': 0.30547732643007197, 'support': 132752}}
[[ 4057 30504  9813]
 [ 3855 29403 10905]
 [ 2256 29253 12706]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
7324/7324 - 107s - 107s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004071
{'0': {'precision': 0.3602611839620096, 'recall': 0.057579322502854816, 'f1-score': 0.0992895354838134, 'support': 579722}, '1': {'precision': 0.3765446713582736, 'recall': 0.6909574387386231, 'f1-score': 0.4874488569746681, 'support': 725049}, '2': {'precision': 0.31411900174937446, 'recall': 0.24889329484941264, 'f1-score': 0.2777279068060008, 'support': 569935}, 'accuracy': 0.36070242480687636, 'macro avg': {'precision': 0.35030828568988587, 'recall': 0.33247668536363023, 'f1-score': 0.2881554330881608, 'support': 1874706}, 'weighted avg': {'precision': 0.3525310554158886, 'recall': 0.36070242480687636, 'f1-score': 0.3036590745193387, 'support': 1874706}}
[[ 33380 424127 122215]
 [ 36549 500978 187522]
 [ 22726 405356 141853]]
Evaluating performance on  train set...
2046/2046 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134876
{'0': {'precision': 0.387860814551206, 'recall': 0.05612712000183104, 'f1-score': 0.09806352284883081, 'support': 174764}, '1': {'precision': 0.3209304855002515, 'recall': 0.6866306365006137, 'f1-score': 0.4374140659454691, 'support': 171893}, '2': {'precision': 0.3585162628063383, 'recall': 0.2645868036929332, 'f1-score': 0.30447185112023706, 'support': 177095}, 'accuracy': 0.3335414470970994, 'macro avg': {'precision': 0.3557691876192653, 'recall': 0.33578152006512596, 'f1-score': 0.279983146638179, 'support': 523752}, 'weighted avg': {'precision': 0.3559723855947284, 'recall': 0.3335414470970994, 'f1-score': 0.2792291619294169, 'support': 523752}}
[[  9809 126384  38571]
 [  8597 118027  45269]
 [  6884 123354  46857]]
Evaluating performance on  val set...
741/741 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1078742
{'0': {'precision': 0.4135708426110395, 'recall': 0.055964350280693964, 'f1-score': 0.098587811317065, 'support': 63058}, '1': {'precision': 0.32946891096664366, 'recall': 0.7011664766782741, 'f1-score': 0.4482915262698116, 'support': 64039}, '2': {'precision': 0.36400795157579685, 'recall': 0.2607812074952395, 'f1-score': 0.30386709427207637, 'support': 62493}, 'accuracy': 0.3414104119415581, 'macro avg': {'precision': 0.36901590171782667, 'recall': 0.3393040114847358, 'f1-score': 0.2835821439529843, 'support': 189590}, 'weighted avg': {'precision': 0.3688261970598982, 'recall': 0.3414104119415581, 'f1-score': 0.2843739521027946, 'support': 189590}}
[[ 3529 47245 12284]
 [ 2947 44902 16190]
 [ 2057 44139 16297]]
testing model on single stock: results/universal/W6/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
29350/29350 - 422s - 422s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963571
{'0': {'precision': 0.30738150549879906, 'recall': 0.04585951225860561, 'f1-score': 0.07981160290491396, 'support': 2212976}, '1': {'precision': 0.4009610378730305, 'recall': 0.7640487325719479, 'f1-score': 0.5259248129405973, 'support': 3069405}, '2': {'precision': 0.286506749323269, 'recall': 0.17135726525454914, 'f1-score': 0.21445237659166105, 'support': 2231023}, 'accuracy': 0.37652214628682285, 'macro avg': {'precision': 0.3316164308983662, 'recall': 0.32708850336170087, 'f1-score': 0.2733962641457241, 'support': 7513404}, 'weighted avg': {'precision': 0.3394124495848789, 'recall': 0.37652214628682285, 'f1-score': 0.30203960771904403, 'support': 7513404}}
[[ 101486 1747473  364017]
 [ 136193 2345175  588037]
 [  92484 1756237  382302]]
Evaluating performance on  train set...
5452/5452 - 79s - 79s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1122197
{'0': {'precision': 0.3340091450263135, 'recall': 0.033250097156586354, 'f1-score': 0.060479548219415084, 'support': 465743}, '1': {'precision': 0.32031945922008376, 'recall': 0.8124116473770163, 'f1-score': 0.4594757891547241, 'support': 464757}, '2': {'precision': 0.30783182386467023, 'recall': 0.11279101026936932, 'f1-score': 0.16509166687652674, 'support': 464975}, 'accuracy': 0.31924971783801215, 'macro avg': {'precision': 0.32072014270368915, 'recall': 0.31948425160099064, 'f1-score': 0.22834900141688863, 'support': 1395475}, 'weighted avg': {'precision': 0.32072751890375234, 'recall': 0.31924971783801215, 'f1-score': 0.22822050797932616, 'support': 1395475}}
[[ 15486 402108  48149]
 [ 17408 377574  69775]
 [ 13470 399060  52445]]
Evaluating performance on  val set...
1969/1969 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1020147
{'0': {'precision': 0.33724679116734596, 'recall': 0.03478544582969939, 'f1-score': 0.06306593256586432, 'support': 159377}, '1': {'precision': 0.3667055635292793, 'recall': 0.8067665447184472, 'f1-score': 0.5042229437550347, 'support': 189698}, '2': {'precision': 0.303624023562556, 'recall': 0.13768162696466824, 'f1-score': 0.18945349781816406, 'support': 154988}, 'accuracy': 0.3569494289404301, 'macro avg': {'precision': 0.33585879275306046, 'recall': 0.3264112058376049, 'f1-score': 0.25224745804635434, 'support': 504063}, 'weighted avg': {'precision': 0.3379950006054179, 'recall': 0.3569494289404301, 'f1-score': 0.2679513509994464, 'support': 504063}}
[[  5544 135165  18668]
 [  6382 153042  30274]
 [  4513 129136  21339]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        80 (peak)  23.25 (ave)

============================================
