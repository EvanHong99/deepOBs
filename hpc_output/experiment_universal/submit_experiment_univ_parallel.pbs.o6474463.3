This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W1/deepLOB_L1/h10
Epoch 1/50
10622/10622 - 176s - loss: 2.8369 - accuracy10: 0.5026 - val_loss: 3.9126 - val_accuracy10: 0.5395 - 176s/epoch - 17ms/step
Epoch 2/50
10622/10622 - 159s - loss: 2.7471 - accuracy10: 0.5300 - val_loss: 3.9293 - val_accuracy10: 0.5447 - 159s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 155s - loss: 2.7045 - accuracy10: 0.5397 - val_loss: 3.8560 - val_accuracy10: 0.5485 - 155s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 156s - loss: 2.6800 - accuracy10: 0.5450 - val_loss: 3.8181 - val_accuracy10: 0.5505 - 156s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 157s - loss: 2.6641 - accuracy10: 0.5489 - val_loss: 3.8635 - val_accuracy10: 0.5511 - 157s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 159s - loss: 2.6529 - accuracy10: 0.5515 - val_loss: 3.8752 - val_accuracy10: 0.5517 - 159s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 158s - loss: 2.6450 - accuracy10: 0.5534 - val_loss: 3.8498 - val_accuracy10: 0.5516 - 158s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 157s - loss: 2.6374 - accuracy10: 0.5555 - val_loss: 3.8346 - val_accuracy10: 0.5524 - 157s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 157s - loss: 2.6315 - accuracy10: 0.5570 - val_loss: 3.8501 - val_accuracy10: 0.5529 - 157s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 157s - loss: 2.6265 - accuracy10: 0.5578 - val_loss: 3.8682 - val_accuracy10: 0.5540 - 157s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 157s - loss: 2.6218 - accuracy10: 0.5590 - val_loss: 3.8730 - val_accuracy10: 0.5514 - 157s/epoch - 15ms/step
Epoch 12/50
10622/10622 - 157s - loss: 2.6180 - accuracy10: 0.5598 - val_loss: 3.8424 - val_accuracy10: 0.5517 - 157s/epoch - 15ms/step
Epoch 13/50
10622/10622 - 158s - loss: 2.6145 - accuracy10: 0.5607 - val_loss: 3.8684 - val_accuracy10: 0.5534 - 158s/epoch - 15ms/step
Epoch 14/50
10622/10622 - 158s - loss: 2.6114 - accuracy10: 0.5614 - val_loss: 3.8822 - val_accuracy10: 0.5523 - 158s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 182s - 182s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1568376
{'0': {'precision': 0.42819451779713646, 'recall': 0.15053428211630074, 'f1-score': 0.22275703007131747, 'support': 2450578}, '1': {'precision': 0.47114203772954666, 'recall': 0.8726545325885839, 'f1-score': 0.6119143980556165, 'support': 4137768}, '2': {'precision': 0.4575632235067511, 'recall': 0.09701415738061002, 'f1-score': 0.1600862642678864, 'support': 2458435}, 'accuracy': 0.4662698256982235, 'macro avg': {'precision': 0.4522999263444781, 'recall': 0.3734009906951649, 'f1-score': 0.33158589746494016, 'support': 9046781}, 'weighted avg': {'precision': 0.45581847903560413, 'recall': 0.4662698256982235, 'f1-score': 0.383717143959528, 'support': 9046781}}
[[ 368896 1989080   92602]
 [ 336785 3610842  190141]
 [ 155834 2064098  238503]]
Evaluating performance on  train set...
10622/10622 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.928326
{'0': {'precision': 0.42925747113171375, 'recall': 0.22794554501796838, 'f1-score': 0.2977689566411484, 'support': 587421}, '1': {'precision': 0.6079075767434958, 'recall': 0.8619090719569691, 'f1-score': 0.7129611108567254, 'support': 1544562}, '2': {'precision': 0.4518381759017793, 'recall': 0.1669016641916625, 'f1-score': 0.2437617189542646, 'support': 586531}, 'accuracy': 0.5749703698417591, 'macro avg': {'precision': 0.4963344079256629, 'recall': 0.41891876038886666, 'f1-score': 0.4181639288173795, 'support': 2718514}, 'weighted avg': {'precision': 0.535631927093109, 'recall': 0.5749703698417591, 'f1-score': 0.5220139320107049, 'support': 2718514}}
[[ 133900  423392   30129]
 [ 124657 1331272   88633]
 [  53377  435261   97893]]
Evaluating performance on  val set...
3064/3064 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9891887
{'0': {'precision': 0.4343619843241751, 'recall': 0.20141818708047154, 'f1-score': 0.27521589176322064, 'support': 179666}, '1': {'precision': 0.5741542912276735, 'recall': 0.8715743642429101, 'f1-score': 0.6922712079622058, 'support': 425359}, '2': {'precision': 0.44187787597691913, 'recall': 0.13537674892169643, 'f1-score': 0.2072568592436525, 'support': 178753}, 'accuracy': 0.5500524383179931, 'macro avg': {'precision': 0.4834647171762559, 'recall': 0.40278976674835937, 'f1-score': 0.3915813196563596, 'support': 783778}, 'weighted avg': {'precision': 0.5119418654292432, 'recall': 0.5500524383179931, 'f1-score': 0.486054102714681, 'support': 783778}}
[[ 36188 134850   8628]
 [ 32690 370732  21937]
 [ 14435 140119  24199]]
testing model out of sample: results/universal/W1/deepLOB_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 124s - 124s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7725149
{'0': {'precision': 0.48160016119894333, 'recall': 0.3269751815324591, 'f1-score': 0.3895030971440242, 'support': 1125694}, '1': {'precision': 0.7143072740568964, 'recall': 0.8824608457377691, 'f1-score': 0.7895300430496421, 'support': 3856349}, '2': {'precision': 0.5043109263279247, 'recall': 0.25765494968012437, 'f1-score': 0.34106043443023093, 'support': 1117153}, 'accuracy': 0.6654960752204061, 'macro avg': {'precision': 0.5667394538612549, 'recall': 0.48903032565011745, 'f1-score': 0.5066978582079659, 'support': 6099196}, 'weighted avg': {'precision': 0.6328940762262341, 'recall': 0.6654960752204061, 'f1-score': 0.6335558619408075, 'support': 6099196}}
[[ 368074  670260   87360]
 [ 257713 3403077  195559]
 [ 138486  690827  287840]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7855074
{'0': {'precision': 0.4620075712764699, 'recall': 0.2591378549555258, 'f1-score': 0.33203746883442337, 'support': 301411}, '1': {'precision': 0.7091791605776624, 'recall': 0.8906475826378852, 'f1-score': 0.7896213858209759, 'support': 1115348}, '2': {'precision': 0.4634262116105758, 'recall': 0.22740991418179882, 'f1-score': 0.30510192237292066, 'support': 300519}, 'accuracy': 0.6637422711989556, 'macro avg': {'precision': 0.5448709811549027, 'recall': 0.4590651172584033, 'f1-score': 0.47558692567610655, 'support': 1717278}, 'weighted avg': {'precision': 0.6227903135921995, 'recall': 0.6637422711989556, 'f1-score': 0.6245181639554538, 'support': 1717278}}
[[ 78107 204497  18807]
 [ 61645 993382  60321]
 [ 29308 202870  68341]]
Evaluating performance on  val set...
1720/1720 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73743737
{'0': {'precision': 0.49447972642892035, 'recall': 0.2732241912191435, 'f1-score': 0.35196856554206185, 'support': 74093}, '1': {'precision': 0.7318289191812805, 'recall': 0.9115050006850254, 'f1-score': 0.8118443992611359, 'support': 291960}, '2': {'precision': 0.49759015649807214, 'recall': 0.23781842818428184, 'f1-score': 0.3218241161801379, 'support': 73800}, 'accuracy': 0.6909535685785934, 'macro avg': {'precision': 0.574632934036091, 'recall': 0.4741825400294836, 'f1-score': 0.49521236032777854, 'support': 439853}, 'weighted avg': {'precision': 0.6525462169498046, 'recall': 0.6909535685785934, 'f1-score': 0.6521613300559128, 'support': 439853}}
[[ 20244  48687   5162]
 [ 13278 266123  12559]
 [  7418  48831  17551]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2620192
{'0': {'precision': 0.39144189144189145, 'recall': 0.09085463644619636, 'f1-score': 0.14747902454324474, 'support': 51753}, '1': {'precision': 0.4025928612132829, 'recall': 0.9345780343345059, 'f1-score': 0.562761941831941, 'support': 66522}, '2': {'precision': 0.5485854858548586, 'recall': 0.03469939509462587, 'f1-score': 0.065270282630568, 'support': 51413}, 'accuracy': 0.40460138607326385, 'macro avg': {'precision': 0.44754007950334423, 'recall': 0.35337735529177605, 'f1-score': 0.2585037496685845, 'support': 169688}, 'weighted avg': {'precision': 0.4434255816892063, 'recall': 0.40460138607326385, 'f1-score': 0.2853724063729687, 'support': 169688}}
[[ 4702 46388   663]
 [ 3547 62170   805]
 [ 3763 45866  1784]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0986404
{'0': {'precision': 0.4035502958579882, 'recall': 0.06394549318664833, 'f1-score': 0.11039766902282415, 'support': 15998}, '1': {'precision': 0.5173028153189304, 'recall': 0.9546221972097982, 'f1-score': 0.6709971581149871, 'support': 33761}, '2': {'precision': 0.466785290628707, 'recall': 0.046945836315915056, 'f1-score': 0.08531165311653115, 'support': 16764}, 'accuracy': 0.5116876869654104, 'macro avg': {'precision': 0.46254613393520855, 'recall': 0.3551711755707872, 'f1-score': 0.28890216008478076, 'support': 66523}, 'weighted avg': {'precision': 0.47721609959289496, 'recall': 0.5116876869654104, 'f1-score': 0.3885850234804917, 'support': 66523}}
[[ 1023 14676   299]
 [  932 32229   600]
 [  580 15397   787]]
Evaluating performance on  val set...
51/51 - 0s - 432ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1126066
{'0': {'precision': 0.44052863436123346, 'recall': 0.03156565656565657, 'f1-score': 0.058910162002945514, 'support': 3168}, '1': {'precision': 0.515141829804235, 'recall': 0.9838242026552724, 'f1-score': 0.6762114537444934, 'support': 6553}, '2': {'precision': 0.5238095238095238, 'recall': 0.017594369801663467, 'f1-score': 0.03404518724852986, 'support': 3126}, 'accuracy': 0.5138942943877948, 'macro avg': {'precision': 0.4931599959916641, 'recall': 0.3443280763408641, 'f1-score': 0.2563889343319896, 'support': 12847}, 'weighted avg': {'precision': 0.4988516926747187, 'recall': 0.5138942943877948, 'f1-score': 0.3677330353352457, 'support': 12847}}
[[ 100 3050   18]
 [  74 6447   32]
 [  53 3018   55]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.678723
{'0': {'precision': 0.23345749749402897, 'recall': 0.5523026026875897, 'f1-score': 0.3281896941651299, 'support': 34157}, '1': {'precision': 0.909178529576957, 'recall': 0.7432923476358112, 'f1-score': 0.8179090512132742, 'support': 352806}, '2': {'precision': 0.2820220595336978, 'recall': 0.42881898552001646, 'f1-score': 0.3402628880395264, 'support': 34047}, 'accuracy': 0.7023657395311276, 'macro avg': {'precision': 0.4748860288682279, 'recall': 0.5748046452811391, 'f1-score': 0.4954538778059769, 'support': 421010}, 'weighted avg': {'precision': 0.803638519533444, 'recall': 0.7023657395311276, 'f1-score': 0.739550430286764, 'support': 421010}}
[[ 18865  12366   2926]
 [ 56325 262238  34243]
 [  5617  13830  14600]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7111559
{'0': {'precision': 0.3422695830996448, 'recall': 0.42149369186849617, 'f1-score': 0.3777727338381859, 'support': 21718}, '1': {'precision': 0.8206421343447058, 'recall': 0.8087106414170299, 'f1-score': 0.8146327016621432, 'support': 124147}, '2': {'precision': 0.3681229319724076, 'recall': 0.31178454377048404, 'f1-score': 0.33761958646229817, 'support': 21053}, 'accuracy': 0.6956529553433423, 'macro avg': {'precision': 0.5103448831389193, 'recall': 0.5139962923520033, 'f1-score': 0.5100083406542091, 'support': 166918}, 'weighted avg': {'precision': 0.7013249736101881, 'recall': 0.6956529553433423, 'f1-score': 0.6976274542022944, 'support': 166918}}
[[  9154  10382   2182]
 [ 14663 100399   9085]
 [  2928  11561   6564]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63589925
{'0': {'precision': 0.37112010796221323, 'recall': 0.3227068257383141, 'f1-score': 0.34522439585730724, 'support': 5113}, '1': {'precision': 0.8369016809139153, 'recall': 0.8824875265319624, 'f1-score': 0.8590902992083725, 'support': 36277}, '2': {'precision': 0.38791423001949316, 'recall': 0.2842857142857143, 'f1-score': 0.3281121187139324, 'support': 4900}, 'accuracy': 0.7573341974508533, 'macro avg': {'precision': 0.5319786729652072, 'recall': 0.49649335551866364, 'f1-score': 0.5108089379265374, 'support': 46290}, 'weighted avg': {'precision': 0.7379260988900501, 'recall': 0.7573341974508533, 'f1-score': 0.7461244437696869, 'support': 46290}}
[[ 1650  3122   341]
 [ 2406 32014  1857]
 [  390  3117  1393]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1291015
{'0': {'precision': 0.4945452278536251, 'recall': 0.36674895749540004, 'f1-score': 0.4211660773633188, 'support': 108153}, '1': {'precision': 0.4069112599553467, 'recall': 0.7339349498557494, 'f1-score': 0.5235524167986108, 'support': 116464}, '2': {'precision': 0.5312085570798095, 'recall': 0.21884852393235885, 'f1-score': 0.3099876304354721, 'support': 111648}, 'accuracy': 0.4448158446463355, 'macro avg': {'precision': 0.47755501496292707, 'recall': 0.43984414376116937, 'f1-score': 0.41823537486580054, 'support': 336265}, 'weighted avg': {'precision': 0.47636666316250337, 'recall': 0.4448158446463355, 'f1-score': 0.4197132689931096, 'support': 336265}}
[[39665 58208 10280]
 [19704 85477 11283]
 [20836 66378 24434]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0680897
{'0': {'precision': 0.4816675037669513, 'recall': 0.29613721857279207, 'f1-score': 0.3667750291187873, 'support': 35622}, '1': {'precision': 0.5206866423395179, 'recall': 0.8132385050089905, 'f1-score': 0.6348818409129365, 'support': 62288}, '2': {'precision': 0.5086299892125135, 'recall': 0.20892876924781212, 'f1-score': 0.2961915979583824, 'support': 36108}, 'accuracy': 0.5129758689131311, 'macro avg': {'precision': 0.5036613784396609, 'recall': 0.4394348309431982, 'f1-score': 0.4326161559967021, 'support': 134018}, 'weighted avg': {'precision': 0.5070669689721953, 'recall': 0.5129758689131311, 'f1-score': 0.472366894097328, 'support': 134018}}
[[10549 22343  2730]
 [ 7075 50655  4558]
 [ 4277 24287  7544]]
Evaluating performance on  val set...
107/107 - 1s - 692ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1770787
{'0': {'precision': 0.5196299638989169, 'recall': 0.2652309109754693, 'f1-score': 0.3512009149828441, 'support': 8683}, '1': {'precision': 0.403833738888613, 'recall': 0.8239943256662275, 'f1-score': 0.5420249283476638, 'support': 9869}, '2': {'precision': 0.5497885428681276, 'recall': 0.1659317707124623, 'f1-score': 0.25492468134414836, 'support': 8618}, 'accuracy': 0.4366948840633051, 'macro avg': {'precision': 0.4910840818852192, 'recall': 0.418385669118053, 'f1-score': 0.3827168415582188, 'support': 27170}, 'weighted avg': {'precision': 0.48713506838658593, 'recall': 0.4366948840633051, 'f1-score': 0.3899765353876702, 'support': 27170}}
[[2303 5879  501]
 [1067 8132  670]
 [1062 6126 1430]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2203816
{'0': {'precision': 0.4156377448647236, 'recall': 0.3805780109722958, 'f1-score': 0.39733598604649084, 'support': 117022}, '1': {'precision': 0.3415326752713184, 'recall': 0.43588310136099007, 'f1-score': 0.3829825073997383, 'support': 103748}, '2': {'precision': 0.4237160361431711, 'recall': 0.35324109727275144, 'f1-score': 0.3852823047810303, 'support': 112971}, 'accuracy': 0.3885168438999104, 'macro avg': {'precision': 0.3936288187597377, 'recall': 0.3899007365353458, 'f1-score': 0.38853359940908644, 'support': 333741}, 'weighted avg': {'precision': 0.3953356539734063, 'recall': 0.3885168438999104, 'f1-score': 0.3887938496926008, 'support': 333741}}
[[44536 45297 27189]
 [31440 45222 27086]
 [31175 41890 39906]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2555352
{'0': {'precision': 0.3869468957560261, 'recall': 0.3661011948664995, 'f1-score': 0.3762355224061609, 'support': 33895}, '1': {'precision': 0.3363198687363717, 'recall': 0.4830387596899225, 'f1-score': 0.39654316587967264, 'support': 32250}, '2': {'precision': 0.42773693221875314, 'recall': 0.26460234883648487, 'f1-score': 0.3269500952674224, 'support': 32101}, 'accuracy': 0.37132300551676406, 'macro avg': {'precision': 0.383667898903717, 'recall': 0.37124743446430225, 'f1-score': 0.3665762611844187, 'support': 98246}, 'weighted avg': {'precision': 0.38365596624343673, 'recall': 0.37132300551676406, 'f1-score': 0.366798089894304, 'support': 98246}}
[[12409 15920  5566]
 [10874 15578  5798]
 [ 8786 14821  8494]]
Evaluating performance on  val set...
93/93 - 1s - 632ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.244131
{'0': {'precision': 0.39904547262362455, 'recall': 0.36900821380409465, 'f1-score': 0.3834394904458599, 'support': 8157}, '1': {'precision': 0.3254135672254913, 'recall': 0.39893834218048185, 'f1-score': 0.3584444172679467, 'support': 7347}, '2': {'precision': 0.41409129571874115, 'recall': 0.36061728395061726, 'f1-score': 0.38550877656064403, 'support': 8100}, 'accuracy': 0.37544483985765126, 'macro avg': {'precision': 0.379516778522619, 'recall': 0.3761879466450646, 'f1-score': 0.37579756142481685, 'support': 23604}, 'weighted avg': {'precision': 0.3812899039958649, 'recall': 0.37544483985765126, 'f1-score': 0.3763696046168319, 'support': 23604}}
[[3010 3121 2026]
 [2309 2931 2107]
 [2224 2955 2921]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0716697
{'0': {'precision': 0.5013813171337301, 'recall': 0.4438811416655806, 'f1-score': 0.47088236581785836, 'support': 230190}, '1': {'precision': 0.4342764443204019, 'recall': 0.5764263520303029, 'f1-score': 0.4953550885109821, 'support': 215953}, '2': {'precision': 0.5054019368954269, 'recall': 0.4041976949753356, 'f1-score': 0.44916970229870623, 'support': 221169}, 'accuracy': 0.47362253338768073, 'macro avg': {'precision': 0.4803532327831863, 'recall': 0.4748350628904064, 'f1-score': 0.4718023855425155, 'support': 667312}, 'weighted avg': {'precision': 0.4809976552985137, 'recall': 0.47362253338768073, 'f1-score': 0.47160585019380363, 'support': 667312}}
[[102177  81876  46137]
 [ 50124 124481  41348]
 [ 51490  80283  89396]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0254877
{'0': {'precision': 0.4839136585588463, 'recall': 0.38753768844221104, 'f1-score': 0.4303964444805227, 'support': 54725}, '1': {'precision': 0.5042076533803378, 'recall': 0.7037419150033729, 'f1-score': 0.5874948240165632, 'support': 75603}, '2': {'precision': 0.5093682780482283, 'recall': 0.3311193700323815, 'f1-score': 0.40134249141429906, 'support': 54352}, 'accuracy': 0.500379034004765, 'macro avg': {'precision': 0.4991631966624708, 'recall': 0.4741329911593218, 'f1-score': 0.4730779199704617, 'support': 184680}, 'weighted avg': {'precision': 0.4997128591705861, 'recall': 0.500379034004765, 'f1-score': 0.48615758987259483, 'support': 184680}}
[[21208 26447  7070]
 [12133 53205 10265]
 [10485 25870 17997]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0623097
{'0': {'precision': 0.4971260526667558, 'recall': 0.39610182128022153, 'f1-score': 0.44090100770598695, 'support': 18778}, '1': {'precision': 0.44063810205542486, 'recall': 0.6277070991550937, 'f1-score': 0.5177945564879534, 'support': 20594}, '2': {'precision': 0.5045260337461076, 'recall': 0.3718509820666097, 'f1-score': 0.42814564449224146, 'support': 18736}, 'accuracy': 0.47036552626144423, 'macro avg': {'precision': 0.48076339615609615, 'recall': 0.46521996750064165, 'f1-score': 0.4622804028953939, 'support': 58108}, 'weighted avg': {'precision': 0.4794922189538933, 'recall': 0.47036552626144423, 'f1-score': 0.46404001194710826, 'support': 58108}}
[[ 7438  8246  3094]
 [ 3919 12927  3748]
 [ 3605  8164  6967]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/EXC
Evaluating performance on  test set...
5343/5343 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6073568
{'0': {'precision': 0.41465255946545876, 'recall': 0.47532016300381674, 'f1-score': 0.44291856857865863, 'support': 154843}, '1': {'precision': 0.8229508111449311, 'recall': 0.8989305840830987, 'f1-score': 0.8592643551226754, 'support': 1055997}, '2': {'precision': 0.5689983151258221, 'recall': 0.13340639315956138, 'f1-score': 0.21613754019417075, 'support': 156949}, 'accuracy': 0.7631337874482103, 'macro avg': {'precision': 0.6022005619120706, 'recall': 0.5025523800821589, 'f1-score': 0.5061068212985016, 'support': 1367789}, 'weighted avg': {'precision': 0.7475885173390094, 'recall': 0.7631337874482103, 'f1-score': 0.7383346348938615, 'support': 1367789}}
[[ 73600  78261   2982]
 [ 93851 949268  12878]
 [ 10047 125964  20938]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57996583
{'0': {'precision': 0.38361353956511995, 'recall': 0.5380262206432547, 'f1-score': 0.4478846330005104, 'support': 31807}, '1': {'precision': 0.8943088451437246, 'recall': 0.8385982881522512, 'f1-score': 0.8655580581407326, 'support': 265561}, '2': {'precision': 0.41306191687871074, 'recall': 0.4601481300862568, 'f1-score': 0.43533550563741746, 'support': 32809}, 'accuracy': 0.7720374223522535, 'macro avg': {'precision': 0.5636614338625184, 'recall': 0.6122575462939209, 'f1-score': 0.5829260655928868, 'support': 330177}, 'weighted avg': {'precision': 0.7972914391645511, 'recall': 0.7720374223522535, 'f1-score': 0.7825719314313727, 'support': 330177}}
[[ 17113  12123   2571]
 [ 23981 222699  18881]
 [  3516  14196  15097]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5953081
{'0': {'precision': 0.37868926895716665, 'recall': 0.5512834636994601, 'f1-score': 0.44897043649903545, 'support': 9077}, '1': {'precision': 0.8970310177099722, 'recall': 0.830902308916133, 'f1-score': 0.8627012770682954, 'support': 74797}, '2': {'precision': 0.40775103894848747, 'recall': 0.47034559643255297, 'f1-score': 0.4368173111766837, 'support': 8970}, 'accuracy': 0.7687303433716772, 'macro avg': {'precision': 0.5611571085385422, 'recall': 0.617510456349382, 'f1-score': 0.5828296749146715, 'support': 92844}, 'weighted avg': {'precision': 0.7990836063218403, 'recall': 0.7687303433716772, 'f1-score': 0.7811061926913304, 'support': 92844}}
[[ 5004  3418   655]
 [ 7175 62149  5473]
 [ 1035  3716  4219]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/AAL
Evaluating performance on  test set...
7177/7177 - 38s - 38s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6109337
{'0': {'precision': 0.42495544664736024, 'recall': 0.4412117590937345, 'f1-score': 0.4329310528244347, 'support': 207533}, '1': {'precision': 0.8542272077507334, 'recall': 0.8683221460476548, 'f1-score': 0.861217010253778, 'support': 1423193}, '2': {'precision': 0.44542445738849096, 'recall': 0.37760160493886985, 'f1-score': 0.40871850282189537, 'support': 206363}, 'accuracy': 0.7649487858236591, 'macro avg': {'precision': 0.5748690372621948, 'recall': 0.5623785033600863, 'f1-score': 0.5676221886333693, 'support': 1837089}, 'weighted avg': {'precision': 0.7598116305140998, 'recall': 0.7649487858236591, 'f1-score': 0.7620043868629953, 'support': 1837089}}
[[  91566  103712   12255]
 [ 102640 1235790   84763]
 [  21266  107174   77923]]
Evaluating performance on  train set...
2257/2257 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.635434
{'0': {'precision': 0.4105712879702948, 'recall': 0.2725963109276146, 'f1-score': 0.32765083898607644, 'support': 67334}, '1': {'precision': 0.8157282532991015, 'recall': 0.9015560065283199, 'f1-score': 0.8564973471899944, 'support': 442993}, '2': {'precision': 0.3864466324596681, 'recall': 0.24863192957411373, 'f1-score': 0.3025860976889806, 'support': 67248}, 'accuracy': 0.7522105354282994, 'macro avg': {'precision': 0.537582057909688, 'recall': 0.47426141567668273, 'f1-score': 0.49557809462168373, 'support': 577575}, 'weighted avg': {'precision': 0.7185128794659889, 'recall': 0.7522105354282994, 'f1-score': 0.7303513497180699, 'support': 577575}}
[[ 18355  45521   3458]
 [ 20522 399383  23088]
 [  5829  44699  16720]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5842989
{'0': {'precision': 0.47174474778114817, 'recall': 0.23637694213015087, 'f1-score': 0.3149446840427527, 'support': 17764}, '1': {'precision': 0.8201266367492469, 'recall': 0.9423088997017737, 'f1-score': 0.8769825763358082, 'support': 127420}, '2': {'precision': 0.460493519441675, 'recall': 0.20364858906525574, 'f1-score': 0.2824059920513604, 'support': 18144}, 'accuracy': 0.7834725215517241, 'macro avg': {'precision': 0.5841216346573567, 'recall': 0.46077814363239344, 'f1-score': 0.4914444174766404, 'support': 163328}, 'weighted avg': {'precision': 0.7422842633897624, 'recall': 0.7834725215517241, 'f1-score': 0.7498026766006076, 'support': 163328}}
[[  4199  12898    667]
 [  3689 120069   3662]
 [  1013  13436   3695]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/WBA
Evaluating performance on  test set...
5696/5696 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9020138
{'0': {'precision': 0.45378752167208636, 'recall': 0.3349847684599483, 'f1-score': 0.38543927006333334, 'support': 339099}, '1': {'precision': 0.6275756006628004, 'recall': 0.7684183430211916, 'f1-score': 0.6908921136279682, 'support': 788616}, '2': {'precision': 0.47114852417576064, 'recall': 0.34533118988583417, 'f1-score': 0.39854580013312113, 'support': 330309}, 'accuracy': 0.5717642507942257, 'macro avg': {'precision': 0.5175038821702158, 'recall': 0.48291143378899143, 'f1-score': 0.4916257279414742, 'support': 1458024}, 'weighted avg': {'precision': 0.5517190749780175, 'recall': 0.5717642507942257, 'f1-score': 0.5536218270866673, 'support': 1458024}}
[[113593 187019  38487]
 [ 93080 605987  89549]
 [ 43649 172594 114066]]
Evaluating performance on  train set...
2222/2222 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.795662
{'0': {'precision': 0.4651926298157454, 'recall': 0.32547957021507995, 'f1-score': 0.38299233794674625, 'support': 106658}, '1': {'precision': 0.7088526716548768, 'recall': 0.8263658841879181, 'f1-score': 0.7631117570090559, 'support': 357113}, '2': {'precision': 0.4463239743045096, 'recall': 0.3306691591637418, 'f1-score': 0.37988900272288484, 'support': 104848}, 'accuracy': 0.6410109405419094, 'macro avg': {'precision': 0.5401230919250439, 'recall': 0.49417153785558, 'f1-score': 0.5086643658928957, 'support': 568619}, 'weighted avg': {'precision': 0.614740618413129, 'recall': 0.6410109405419094, 'f1-score': 0.6211486563392853, 'support': 568619}}
[[ 34715  61805  10138]
 [ 29136 295106  32871]
 [ 10774  59404  34670]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7899627
{'0': {'precision': 0.46793197515816354, 'recall': 0.26467498358502956, 'f1-score': 0.3381073203464111, 'support': 30460}, '1': {'precision': 0.7014638416268728, 'recall': 0.8627773291806052, 'f1-score': 0.7738028011156183, 'support': 104028}, '2': {'precision': 0.4500455349011625, 'recall': 0.2861473483429272, 'f1-score': 0.34985216341148545, 'support': 29359}, 'accuracy': 0.648263318827931, 'macro avg': {'precision': 0.5398137838953996, 'recall': 0.47119988703618737, 'f1-score': 0.4872540949578383, 'support': 163847}, 'weighted avg': {'precision': 0.6129985617023274, 'recall': 0.648263318827931, 'f1-score': 0.6168389804989106, 'support': 163847}}
[[ 8062 19722  2676]
 [ 6685 89753  7590]
 [ 2482 18476  8401]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 60s - 60s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73834735
{'0': {'precision': 0.5139088131962805, 'recall': 0.2462575629894047, 'f1-score': 0.33296377188243337, 'support': 528065}, '1': {'precision': 0.7107754556440452, 'recall': 0.9316056251619174, 'f1-score': 0.8063444232809546, 'support': 2034217}, '2': {'precision': 0.5573875866135928, 'recall': 0.17950281069583712, 'f1-score': 0.27155364979493923, 'support': 526560}, 'accuracy': 0.6862270715044667, 'macro avg': {'precision': 0.5940239518179729, 'recall': 0.45245533294905305, 'f1-score': 0.47028728165277567, 'support': 3088842}, 'weighted avg': {'precision': 0.6509710694498488, 'recall': 0.6862270715044667, 'f1-score': 0.6342491256362203, 'support': 3088842}}
[[ 130040  380107   17918]
 [  81991 1895088   57138]
 [  41010  391031   94519]]
Evaluating performance on  train set...
2948/2948 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7636562
{'0': {'precision': 0.47846881413402337, 'recall': 0.2099004164970407, 'f1-score': 0.2917934123101536, 'support': 127732}, '1': {'precision': 0.708658978675037, 'recall': 0.9139749512185866, 'f1-score': 0.7983273904639625, 'support': 500703}, '2': {'precision': 0.48376931546376095, 'recall': 0.202178552444723, 'f1-score': 0.2851755490278361, 'support': 126047}, 'accuracy': 0.6758610543392686, 'macro avg': {'precision': 0.5569657027576072, 'recall': 0.44201797338678345, 'f1-score': 0.45843211726731736, 'support': 754482}, 'weighted avg': {'precision': 0.6321173017683057, 'recall': 0.6758610543392686, 'f1-score': 0.6268430498765902, 'support': 754482}}
[[ 26811  95700   5221]
 [ 21100 457630  21973]
 [  8124  92439  25484]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6773665
{'0': {'precision': 0.4974233128834356, 'recall': 0.23661478599221789, 'f1-score': 0.32068556361239287, 'support': 25700}, '1': {'precision': 0.7632034492744296, 'recall': 0.9300053323296007, 'f1-score': 0.8383883726437602, 'support': 127524}, '2': {'precision': 0.499165120593692, 'recall': 0.21373530346361613, 'f1-score': 0.2993102681054622, 'support': 25176}, 'accuracy': 0.7290358744394618, 'macro avg': {'precision': 0.5865972942505191, 'recall': 0.46011847392847827, 'f1-score': 0.48612806812053844, 'support': 178400}, 'weighted avg': {'precision': 0.6876542426145933, 'recall': 0.7290358744394618, 'f1-score': 0.6877337058726709, 'support': 178400}}
[[  6081  18687    932]
 [  4459 118598   4467]
 [  1685  18110   5381]]
testing model on single stock: results/universal/W1/deepLOB_L1/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 106s - 106s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3953036
{'0': {'precision': 0.4819204966211675, 'recall': 0.06552966921948293, 'f1-score': 0.1153715633099881, 'support': 1805457}, '1': {'precision': 0.3411254642432664, 'recall': 0.9517053513528524, 'f1-score': 0.5022326601232003, 'support': 1836601}, '2': {'precision': 0.5094329875604414, 'recall': 0.02702999025852461, 'f1-score': 0.05133613785284029, 'support': 1824159}, 'accuracy': 0.3504290078494871, 'macro avg': {'precision': 0.4441596494749584, 'recall': 0.34808833694362, 'f1-score': 0.22298012042867624, 'support': 5466217}, 'weighted avg': {'precision': 0.443795932722407, 'recall': 0.3504290078494871, 'f1-score': 0.22398391433845202, 'support': 5466217}}
[[ 118311 1666303   20843]
 [  62060 1747903   26638]
 [  65128 1709724   49307]]
Evaluating performance on  train set...
6073/6073 - 32s - 32s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.05346
{'0': {'precision': 0.45250389312351447, 'recall': 0.15439705295378334, 'f1-score': 0.2302361464418808, 'support': 393343}, '1': {'precision': 0.5145311922388153, 'recall': 0.9109473527448396, 'f1-score': 0.6576189155901597, 'support': 765491}, '2': {'precision': 0.5096180438189473, 'recall': 0.08381936722935408, 'f1-score': 0.1439607991215392, 'support': 395720}, 'accuracy': 0.5089704185251848, 'macro avg': {'precision': 0.49221770972709233, 'recall': 0.38305459097599237, 'f1-score': 0.34393862038452655, 'support': 1554554}, 'weighted avg': {'precision': 0.4975859880139251, 'recall': 0.5089704185251848, 'f1-score': 0.4187254384809348, 'support': 1554554}}
[[ 60731 322814   9798]
 [ 46050 697322  22119]
 [ 27430 335121  33169]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1631671
{'0': {'precision': 0.4548064548064548, 'recall': 0.14485373524937134, 'f1-score': 0.21972582101241758, 'support': 126859}, '1': {'precision': 0.45836986410552744, 'recall': 0.906953821891479, 'f1-score': 0.6089695862660035, 'support': 202910}, '2': {'precision': 0.47755048689628127, 'recall': 0.05734398543445505, 'f1-score': 0.10239271325976529, 'support': 127424}, 'accuracy': 0.45869687418661265, 'macro avg': {'precision': 0.4635756019360879, 'recall': 0.36971718085843513, 'f1-score': 0.3103627068460621, 'support': 457193}, 'weighted avg': {'precision': 0.46272693242944746, 'recall': 0.45869687418661265, 'f1-score': 0.35977695584022806, 'support': 457193}}
[[ 18376 105517   2966]
 [ 13852 184030   5028]
 [  8176 111941   7307]]
training model: results/universal/W1/deepLOB_L1/h20
Epoch 1/50
10622/10622 - 160s - loss: 2.9092 - accuracy20: 0.5074 - val_loss: 3.8201 - val_accuracy20: 0.4495 - 160s/epoch - 15ms/step
Epoch 2/50
10622/10622 - 154s - loss: 2.8171 - accuracy20: 0.5333 - val_loss: 4.0037 - val_accuracy20: 0.4565 - 154s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 157s - loss: 2.7757 - accuracy20: 0.5432 - val_loss: 4.0580 - val_accuracy20: 0.4555 - 157s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 157s - loss: 2.7544 - accuracy20: 0.5482 - val_loss: 3.9732 - val_accuracy20: 0.4571 - 157s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 155s - loss: 2.7394 - accuracy20: 0.5514 - val_loss: 3.9218 - val_accuracy20: 0.4621 - 155s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 156s - loss: 2.7281 - accuracy20: 0.5540 - val_loss: 3.8898 - val_accuracy20: 0.4636 - 156s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 156s - loss: 2.7194 - accuracy20: 0.5556 - val_loss: 3.8457 - val_accuracy20: 0.4685 - 156s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 159s - loss: 2.7120 - accuracy20: 0.5573 - val_loss: 3.8760 - val_accuracy20: 0.4647 - 159s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 157s - loss: 2.7064 - accuracy20: 0.5584 - val_loss: 3.8139 - val_accuracy20: 0.4671 - 157s/epoch - 15ms/step
Epoch 10/50
10622/10622 - 158s - loss: 2.7013 - accuracy20: 0.5596 - val_loss: 3.7996 - val_accuracy20: 0.4659 - 158s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 157s - loss: 2.6968 - accuracy20: 0.5607 - val_loss: 3.8528 - val_accuracy20: 0.4683 - 157s/epoch - 15ms/step
Epoch 12/50
10622/10622 - 156s - loss: 2.6926 - accuracy20: 0.5614 - val_loss: 3.9164 - val_accuracy20: 0.4648 - 156s/epoch - 15ms/step
Epoch 13/50
10622/10622 - 159s - loss: 2.6892 - accuracy20: 0.5622 - val_loss: 3.9105 - val_accuracy20: 0.4670 - 159s/epoch - 15ms/step
Epoch 14/50
10622/10622 - 160s - loss: 2.6862 - accuracy20: 0.5628 - val_loss: 3.8819 - val_accuracy20: 0.4688 - 160s/epoch - 15ms/step
Epoch 15/50
10622/10622 - 158s - loss: 2.6836 - accuracy20: 0.5637 - val_loss: 3.9575 - val_accuracy20: 0.4650 - 158s/epoch - 15ms/step
Epoch 16/50
10622/10622 - 158s - loss: 2.6808 - accuracy20: 0.5643 - val_loss: 3.9567 - val_accuracy20: 0.4650 - 158s/epoch - 15ms/step
Epoch 17/50
10622/10622 - 158s - loss: 2.6786 - accuracy20: 0.5647 - val_loss: 3.9854 - val_accuracy20: 0.4647 - 158s/epoch - 15ms/step
Epoch 18/50
10622/10622 - 163s - loss: 2.6766 - accuracy20: 0.5653 - val_loss: 3.9916 - val_accuracy20: 0.4633 - 163s/epoch - 15ms/step
Epoch 19/50
10622/10622 - 164s - loss: 2.6743 - accuracy20: 0.5656 - val_loss: 4.0166 - val_accuracy20: 0.4628 - 164s/epoch - 15ms/step
Epoch 20/50
10622/10622 - 164s - loss: 2.6723 - accuracy20: 0.5660 - val_loss: 3.9866 - val_accuracy20: 0.4620 - 164s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 182s - 182s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2924796
{'0': {'precision': 0.4798950976748028, 'recall': 0.11889545115951639, 'f1-score': 0.19057529968821602, 'support': 2931912}, '1': {'precision': 0.3615576358995118, 'recall': 0.891724076244875, 'f1-score': 0.5145046732232684, 'support': 3175138}, '2': {'precision': 0.5138071312837006, 'recall': 0.08554116005852236, 'f1-score': 0.14666483142187922, 'support': 2939731}, 'accuracy': 0.3792957959300662, 'macro avg': {'precision': 0.4517532882860051, 'recall': 0.3653868958209712, 'f1-score': 0.2839149347777879, 'support': 9046781}, 'weighted avg': {'precision': 0.44938197756797643, 'recall': 0.3792957959300662, 'f1-score': 0.28999580057579943, 'support': 9046781}}
[[ 348591 2464023  119298]
 [ 225136 2831347  118655]
 [ 152663 2535600  251468]]
Evaluating performance on  train set...
10622/10622 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0469899
{'0': {'precision': 0.4928692484176303, 'recall': 0.17428823809200245, 'f1-score': 0.2575143490207929, 'support': 735850}, '1': {'precision': 0.4933273104046975, 'recall': 0.8958938426082591, 'f1-score': 0.636282997596913, 'support': 1247054}, '2': {'precision': 0.5211802255918688, 'recall': 0.13718274629219288, 'f1-score': 0.2171960991526354, 'support': 735610}, 'accuracy': 0.4952672673379648, 'macro avg': {'precision': 0.5024589281380655, 'recall': 0.40245494233081813, 'f1-score': 0.37033114859011373, 'support': 2718514}, 'weighted avg': {'precision': 0.500740116823076, 'recall': 0.4952672673379648, 'f1-score': 0.420355684579826, 'support': 2718514}}
[[ 128250  567112   40488]
 [  77603 1117228   52223]
 [  54358  580339  100913]]
Evaluating performance on  val set...
3064/3064 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1126813
{'0': {'precision': 0.5021686220668996, 'recall': 0.14471856158193613, 'f1-score': 0.2246856097756774, 'support': 222411}, '1': {'precision': 0.4600933746662239, 'recall': 0.9022486378811944, 'f1-score': 0.6094190985339135, 'support': 339361}, '2': {'precision': 0.4946762377516562, 'recall': 0.12074898876606939, 'f1-score': 0.19411507004058698, 'support': 222006}, 'accuracy': 0.46592530027635376, 'macro avg': {'precision': 0.4856460781615932, 'recall': 0.38923872940973325, 'f1-score': 0.34273992611672593, 'support': 783778}, 'weighted avg': {'precision': 0.48182861213369066, 'recall': 0.46592530027635376, 'f1-score': 0.3826087694383054, 'support': 783778}}
[[ 32187 177141  13083]
 [ 18872 306188  14301]
 [ 13037 182162  26807]]
testing model out of sample: results/universal/W1/deepLOB_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 124s - 124s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8631681
{'0': {'precision': 0.5393505076089866, 'recall': 0.27721986308039476, 'f1-score': 0.36621136215235195, 'support': 1417182}, '1': {'precision': 0.6143071369109555, 'recall': 0.9180009572134156, 'f1-score': 0.7360589451556049, 'support': 3274087}, '2': {'precision': 0.587088205149658, 'recall': 0.19935763715022156, 'f1-score': 0.2976441887851488, 'support': 1407927}, 'accuracy': 0.6032216377371706, 'macro avg': {'precision': 0.5802486165565334, 'recall': 0.4648594858146773, 'f1-score': 0.46663816536436853, 'support': 6099196}, 'weighted avg': {'precision': 0.5906073812767192, 'recall': 0.6032216377371706, 'f1-score': 0.5489199664987289, 'support': 6099196}}
[[ 392871  927834   96477]
 [ 167540 3005615  100932]
 [ 168004  959242  280681]]
Evaluating performance on  train set...
6711/6711 - 38s - 38s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8819624
{'0': {'precision': 0.5289403383793411, 'recall': 0.22766636280765726, 'f1-score': 0.3183210584631428, 'support': 386144}, '1': {'precision': 0.6113532153284519, 'recall': 0.9264554330282541, 'f1-score': 0.736621566598132, 'support': 946093}, '2': {'precision': 0.5598391110202133, 'recall': 0.17062079103264327, 'f1-score': 0.2615343886908352, 'support': 385041}, 'accuracy': 0.5998568665061801, 'macro avg': {'precision': 0.5667108882426688, 'recall': 0.44158086228951826, 'f1-score': 0.4388256712507033, 'support': 1717278}, 'weighted avg': {'precision': 0.5812717257888514, 'recall': 0.5998568665061801, 'f1-score': 0.5360411867866626, 'support': 1717278}}
[[ 87912 276763  21469]
 [ 39397 876513  30183]
 [ 38895 280450  65696]]
Evaluating performance on  val set...
1720/1720 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83135366
{'0': {'precision': 0.5559689759983231, 'recall': 0.2249170526940649, 'f1-score': 0.3202692809865586, 'support': 94337}, '1': {'precision': 0.6388694274381306, 'recall': 0.9403810913937125, 'f1-score': 0.7608428457275258, 'support': 252118}, '2': {'precision': 0.56835049861043, 'recall': 0.18611747574894538, 'f1-score': 0.28040941096763267, 'support': 93398}, 'accuracy': 0.6267730355368726, 'macro avg': {'precision': 0.5877296340156278, 'recall': 0.45047187327890764, 'f1-score': 0.4538405125605724, 'support': 439853}, 'weighted avg': {'precision': 0.6061155146487971, 'recall': 0.6267730355368726, 'f1-score': 0.5643364894751571, 'support': 439853}}
[[ 21218  66690   6429]
 [  8258 237087   6773]
 [  8688  67327  17383]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3910364
{'0': {'precision': 0.41647085151616875, 'recall': 0.06168481413347918, 'f1-score': 0.10745424100698654, 'support': 60339}, '1': {'precision': 0.2981002695692627, 'recall': 0.9469028340080972, 'f1-score': 0.453447849668229, 'support': 49400}, '2': {'precision': 0.6160667709963484, 'recall': 0.03940015679994662, 'f1-score': 0.07406362196823606, 'support': 59949}, 'accuracy': 0.31151878742162087, 'macro avg': {'precision': 0.44354596402725993, 'recall': 0.349329268313841, 'f1-score': 0.2116552375478172, 'support': 169688}, 'weighted avg': {'precision': 0.4525256640470498, 'recall': 0.31151878742162087, 'f1-score': 0.19638421865485395, 'support': 169688}}
[[ 3722 55814   803]
 [ 1954 46777   669]
 [ 3261 54326  2362]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2609483
{'0': {'precision': 0.4630738522954092, 'recall': 0.04742194286882314, 'f1-score': 0.08603346776062672, 'support': 19569}, '1': {'precision': 0.4021297932285946, 'recall': 0.9617405207857469, 'f1-score': 0.5671279927265379, 'support': 26268}, '2': {'precision': 0.5165094339622641, 'recall': 0.04234748138837861, 'f1-score': 0.07827718702528817, 'support': 20686}, 'accuracy': 0.4068818303443922, 'macro avg': {'precision': 0.4605710264954226, 'recall': 0.3505033150143162, 'f1-score': 0.24381288250415092, 'support': 66523}, 'weighted avg': {'precision': 0.45562514882132465, 'recall': 0.4068818303443922, 'f1-score': 0.27359182439687796, 'support': 66523}}
[[  928 18287   354]
 [  539 25263   466]
 [  537 19273   876]]
Evaluating performance on  val set...
51/51 - 0s - 460ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2821096
{'0': {'precision': 0.5, 'recall': 0.019672968829841594, 'f1-score': 0.037856440511307765, 'support': 3914}, '1': {'precision': 0.40622765906743985, 'recall': 0.9907012785741961, 'f1-score': 0.576192890541378, 'support': 5162}, '2': {'precision': 0.6346153846153846, 'recall': 0.017501988862370723, 'f1-score': 0.03406451612903225, 'support': 3771}, 'accuracy': 0.40920059157780025, 'macro avg': {'precision': 0.5136143478942748, 'recall': 0.34262541208880276, 'f1-score': 0.2160379490605727, 'support': 12847}, 'weighted avg': {'precision': 0.5018355874126831, 'recall': 0.40920059157780025, 'f1-score': 0.2530501361764173, 'support': 12847}}
[[  77 3814   23]
 [  33 5114   15]
 [  44 3661   66]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69778633
{'0': {'precision': 0.29317242074831074, 'recall': 0.5590504070599799, 'f1-score': 0.38463687150837983, 'support': 46799}, '1': {'precision': 0.8634569981451943, 'recall': 0.7905131230355079, 'f1-score': 0.825376564509352, 'support': 328011}, '2': {'precision': 0.4081288928435236, 'recall': 0.277987012987013, 'f1-score': 0.33071535252613693, 'support': 46200}, 'accuracy': 0.7085413648131873, 'macro avg': {'precision': 0.5215861039123428, 'recall': 0.542516847694167, 'f1-score': 0.5135762628479563, 'support': 421010}, 'weighted avg': {'precision': 0.7500988679284918, 'recall': 0.7085413648131873, 'f1-score': 0.7221022363784835, 'support': 421010}}
[[ 26163  18512   2124]
 [ 52213 259297  16501]
 [ 10865  22492  12843]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7496871
{'0': {'precision': 0.4404651593773165, 'recall': 0.3351783951487801, 'f1-score': 0.3806759029390566, 'support': 28364}, '1': {'precision': 0.7385206009491854, 'recall': 0.8815638728766926, 'f1-score': 0.8037273261862758, 'support': 110853}, '2': {'precision': 0.4737893927747886, 'recall': 0.22251904263383993, 'f1-score': 0.30281742035322146, 'support': 27701}, 'accuracy': 0.6793455469152518, 'macro avg': {'precision': 0.5509250510337634, 'recall': 0.4797537702197709, 'f1-score': 0.4957402164928513, 'support': 166918}, 'weighted avg': {'precision': 0.64393904747752, 'recall': 0.6793455469152518, 'f1-score': 0.6487102766741468, 'support': 166918}}
[[ 9507 16718  2139]
 [ 8422 97724  4707]
 [ 3655 17882  6164]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6931571
{'0': {'precision': 0.48131609870740305, 'recall': 0.2955266955266955, 'f1-score': 0.3662047384890479, 'support': 6930}, '1': {'precision': 0.7693984306887532, 'recall': 0.9167430491903452, 'f1-score': 0.8366328351550302, 'support': 32730}, '2': {'precision': 0.5255186038854133, 'recall': 0.2407239819004525, 'f1-score': 0.33019551049963797, 'support': 6630}, 'accuracy': 0.7269172607474617, 'macro avg': {'precision': 0.5920777110938565, 'recall': 0.48433124220583107, 'f1-score': 0.5110110280479053, 'support': 46290}, 'weighted avg': {'precision': 0.6913398043690968, 'recall': 0.7269172607474617, 'f1-score': 0.693670074896648, 'support': 46290}}
[[ 2048  4468   414]
 [ 1698 30005  1027]
 [  509  4525  1596]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2289616
{'0': {'precision': 0.5240726828212344, 'recall': 0.3217376349465686, 'f1-score': 0.39870382748699473, 'support': 127921}, '1': {'precision': 0.2732804530453045, 'recall': 0.7627708573223071, 'f1-score': 0.40239390341552306, 'support': 76424}, '2': {'precision': 0.5708689779378658, 'recall': 0.1922225591267435, 'f1-score': 0.2876034932516729, 'support': 131920}, 'accuracy': 0.37116262471562605, 'macro avg': {'precision': 0.4560740379348016, 'recall': 0.42557701713187307, 'f1-score': 0.3629004080513969, 'support': 336265}, 'weighted avg': {'precision': 0.4854329846171107, 'recall': 0.37116262471562605, 'f1-score': 0.35595675083744216, 'support': 336265}}
[[41157 74299 12465]
 [11533 58294  6597]
 [25843 80719 25358]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1760759
{'0': {'precision': 0.5100346473164673, 'recall': 0.36392471488210465, 'f1-score': 0.4247662342965252, 'support': 42877}, '1': {'precision': 0.43663550986878624, 'recall': 0.8292502951593861, 'f1-score': 0.5720581177189232, 'support': 47432}, '2': {'precision': 0.5616849048118723, 'recall': 0.17145210368573977, 'f1-score': 0.2627123100383867, 'support': 43709}, 'accuracy': 0.4658404094972317, 'macro avg': {'precision': 0.5027850206657086, 'recall': 0.4548757045757435, 'f1-score': 0.41984555401794504, 'support': 134018}, 'weighted avg': {'precision': 0.500902390585642, 'recall': 0.4658404094972317, 'f1-score': 0.42404344809685207, 'support': 134018}}
[[15604 24108  3165]
 [ 5416 39333  2683]
 [ 9574 26641  7494]]
Evaluating performance on  val set...
107/107 - 1s - 839ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3082464
{'0': {'precision': 0.5423280423280423, 'recall': 0.21855010660980811, 'f1-score': 0.3115501519756839, 'support': 10318}, '1': {'precision': 0.26743037724669166, 'recall': 0.8318230686530487, 'f1-score': 0.40473788439263164, 'support': 6511}, '2': {'precision': 0.5760869565217391, 'recall': 0.15375689004931825, 'f1-score': 0.24272956262880696, 'support': 10341}, 'accuracy': 0.3408538829591461, 'macro avg': {'precision': 0.46194845869882445, 'recall': 0.40137668843739166, 'f1-score': 0.3196725329990408, 'support': 27170}, 'weighted avg': {'precision': 0.48930052058834206, 'recall': 0.3408538829591461, 'f1-score': 0.3076882311560553, 'support': 27170}}
[[2255 7360  703]
 [ 628 5416  467]
 [1275 7476 1590]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2138075
{'0': {'precision': 0.4034186014454225, 'recall': 0.35360622772268685, 'f1-score': 0.37687358288376543, 'support': 115869}, '1': {'precision': 0.34292515577959815, 'recall': 0.5041971195687776, 'f1-score': 0.4082099616626006, 'support': 106859}, '2': {'precision': 0.41956411691045215, 'recall': 0.2837055119670669, 'f1-score': 0.3385121373180208, 'support': 111013}, 'accuracy': 0.3785720064361286, 'macro avg': {'precision': 0.38863595804515755, 'recall': 0.38050295308617704, 'f1-score': 0.37453189395479564, 'support': 333741}, 'weighted avg': {'precision': 0.3894200007278451, 'recall': 0.3785720064361286, 'f1-score': 0.37414678259053663, 'support': 333741}}
[[40972 53640 21257]
 [30667 53878 22314]
 [29923 49595 31495]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2482575
{'0': {'precision': 0.3740864744212838, 'recall': 0.3080001185641877, 'f1-score': 0.33784179211236465, 'support': 33737}, '1': {'precision': 0.3362460217321708, 'recall': 0.5465258647076829, 'f1-score': 0.416341187580884, 'support': 32670}, '2': {'precision': 0.41374942422846617, 'recall': 0.22569804328025378, 'f1-score': 0.29207226614099624, 'support': 31839}, 'accuracy': 0.36064572603464773, 'macro avg': {'precision': 0.37469397346064026, 'recall': 0.36007467551737476, 'f1-score': 0.34875174861141495, 'support': 98246}, 'weighted avg': {'precision': 0.3743570306735236, 'recall': 0.36064572603464773, 'f1-score': 0.34911267655095884, 'support': 98246}}
[[10391 18433  4913]
 [ 9546 17855  5269]
 [ 7840 16813  7186]]
Evaluating performance on  val set...
93/93 - 1s - 639ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2363976
{'0': {'precision': 0.38459293843011383, 'recall': 0.3243509290020918, 'f1-score': 0.35191242240170884, 'support': 8127}, '1': {'precision': 0.3294813466787989, 'recall': 0.48499866059469593, 'f1-score': 0.3923927178153446, 'support': 7466}, '2': {'precision': 0.41302083333333334, 'recall': 0.296966670827612, 'f1-score': 0.3455086776559436, 'support': 8011}, 'accuracy': 0.3658701914929673, 'macro avg': {'precision': 0.3756983728140821, 'recall': 0.3687720868081332, 'f1-score': 0.3632712726243324, 'support': 23604}, 'weighted avg': {'precision': 0.3768092035569726, 'recall': 0.3658701914929673, 'f1-score': 0.36254305646372714, 'support': 23604}}
[[2636 3851 1640]
 [2104 3621 1741]
 [2114 3518 2379]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1317774
{'0': {'precision': 0.5041977350093652, 'recall': 0.38911339556500846, 'f1-score': 0.43924246769327896, 'support': 253890}, '1': {'precision': 0.3237886835739757, 'recall': 0.6272811816853268, 'f1-score': 0.4271117306261076, 'support': 165594}, '2': {'precision': 0.526437086972404, 'recall': 0.31983068902626016, 'f1-score': 0.397913617960155, 'support': 247828}, 'accuracy': 0.4224845349701489, 'macro avg': {'precision': 0.451474501851915, 'recall': 0.4454084220921984, 'f1-score': 0.42142260542651383, 'support': 667312}, 'weighted avg': {'precision': 0.4676883925352363, 'recall': 0.4224845349701489, 'f1-score': 0.42088340409849595, 'support': 667312}}
[[ 98792 109649  45449]
 [ 35867 103874  25853]
 [ 61280 107285  79263]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0974014
{'0': {'precision': 0.4971562079626177, 'recall': 0.33947851870951107, 'f1-score': 0.4034588755781551, 'support': 62054}, '1': {'precision': 0.40372312627272894, 'recall': 0.7406929841962574, 'f1-score': 0.5225981781494571, 'support': 60492}, '2': {'precision': 0.5344932162809258, 'recall': 0.2694659928541539, 'f1-score': 0.3582961512534908, 'support': 62134}, 'accuracy': 0.44734134719514834, 'macro avg': {'precision': 0.47845751683875754, 'recall': 0.44987916525330746, 'f1-score': 0.42811773499370104, 'support': 184680}, 'weighted avg': {'precision': 0.47911388446935904, 'recall': 0.44734134719514834, 'f1-score': 0.4272883859634405, 'support': 184680}}
[[21066 33258  7730]
 [ 8834 44806  6852]
 [12473 32918 16743]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1299913
{'0': {'precision': 0.5088235294117647, 'recall': 0.34951137004322497, 'f1-score': 0.41438279857397503, 'support': 21284}, '1': {'precision': 0.332385819227084, 'recall': 0.6635424636572304, 'f1-score': 0.44290760522619904, 'support': 15684}, '2': {'precision': 0.5240597799310232, 'recall': 0.3018921475875118, 'f1-score': 0.38309622426316103, 'support': 21140}, 'accuracy': 0.4169477524609348, 'macro avg': {'precision': 0.4550897095232906, 'recall': 0.438315327095989, 'f1-score': 0.41346220935444505, 'support': 58108}, 'weighted avg': {'precision': 0.4667440444775145, 'recall': 0.4169477524609348, 'f1-score': 0.41069974093308, 'support': 58108}}
[[ 7439 10495  3350]
 [ 2831 10407  2446]
 [ 4350 10408  6382]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/EXC
Evaluating performance on  test set...
5343/5343 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69119066
{'0': {'precision': 0.5601123672678819, 'recall': 0.3720691495914261, 'f1-score': 0.44712436021503904, 'support': 219177}, '1': {'precision': 0.7398775776214959, 'recall': 0.9367963014499507, 'f1-score': 0.8267732764172574, 'support': 927066}, '2': {'precision': 0.6722050010332713, 'recall': 0.14682278172478852, 'f1-score': 0.24100527532452135, 'support': 221546}, 'accuracy': 0.7183483709841211, 'macro avg': {'precision': 0.6573983153075497, 'recall': 0.4852294109220551, 'f1-score': 0.5049676373189392, 'support': 1367789}, 'weighted avg': {'precision': 0.7001104876957186, 'recall': 0.7183483709841211, 'f1-score': 0.6710585659783338, 'support': 1367789}}
[[ 81549 129263   8365]
 [ 51097 868472   7497]
 [ 12948 176070  32528]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.621999
{'0': {'precision': 0.4687314701347986, 'recall': 0.5292227354890541, 'f1-score': 0.4971437555683665, 'support': 44811}, '1': {'precision': 0.8290030020290394, 'recall': 0.876307064524356, 'f1-score': 0.8519989431109124, 'support': 239181}, '2': {'precision': 0.564700605516932, 'recall': 0.327119194543683, 'f1-score': 0.41426397400567594, 'support': 46185}, 'accuracy': 0.7523812985156446, 'macro avg': {'precision': 0.6208116925602566, 'recall': 0.5775496648523645, 'f1-score': 0.5878022242283183, 'support': 330177}, 'weighted avg': {'precision': 0.7431371367548849, 'recall': 0.7523812985156446, 'f1-score': 0.742608509019215, 'support': 330177}}
[[ 23715  18584   2512]
 [ 20451 209596   9134]
 [  6428  24649  15108]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6286688
{'0': {'precision': 0.4625429553264605, 'recall': 0.528713960248252, 'f1-score': 0.49341984676857653, 'support': 12729}, '1': {'precision': 0.8308543659321058, 'recall': 0.8760347712766745, 'f1-score': 0.8528466185141935, 'support': 67527}, '2': {'precision': 0.5582804792107118, 'recall': 0.31466476008897365, 'f1-score': 0.4024792968551542, 'support': 12588}, 'accuracy': 0.7523049416225066, 'macro avg': {'precision': 0.6172259334897593, 'recall': 0.5731378305379667, 'f1-score': 0.5829152540459748, 'support': 92844}, 'weighted avg': {'precision': 0.7434023385350939, 'recall': 0.7523049416225066, 'f1-score': 0.7425070465160682, 'support': 92844}}
[[ 6730  5324   675]
 [ 5912 59156  2459]
 [ 1908  6719  3961]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/AAL
Evaluating performance on  test set...
7177/7177 - 41s - 41s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6666388
{'0': {'precision': 0.5231196903172171, 'recall': 0.3546600720754996, 'f1-score': 0.4227248679470277, 'support': 283869}, '1': {'precision': 0.7705395074171265, 'recall': 0.9214626488530185, 'f1-score': 0.8392700599338045, 'support': 1272732}, '2': {'precision': 0.5859920401905134, 'recall': 0.2561678217962979, 'f1-score': 0.3564936095895848, 'support': 280488}, 'accuracy': 0.7323020278277209, 'macro avg': {'precision': 0.6265504126416189, 'recall': 0.5107635142416054, 'f1-score': 0.5394961791568057, 'support': 1837089}, 'weighted avg': {'precision': 0.7041310938629697, 'recall': 0.7323020278277209, 'f1-score': 0.7011944043132854, 'support': 1837089}}
[[ 100677  168734   14458]
 [  63651 1172775   36306]
 [  28127  180509   71852]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6984548
{'0': {'precision': 0.513188479029813, 'recall': 0.22273395179507424, 'f1-score': 0.31064278832183767, 'support': 91194}, '1': {'precision': 0.734956343976957, 'recall': 0.9472470176129294, 'f1-score': 0.8277063532317462, 'support': 396243}, '2': {'precision': 0.5389405817275991, 'recall': 0.1632164015176729, 'f1-score': 0.2505534929663817, 'support': 90138}, 'accuracy': 0.7104947409427347, 'macro avg': {'precision': 0.5956951349114563, 'recall': 0.4443991236418922, 'f1-score': 0.46296754483998853, 'support': 577575}, 'weighted avg': {'precision': 0.6693503751354688, 'recall': 0.7104947409427347, 'f1-score': 0.65599445563058, 'support': 577575}}
[[ 20312  66963   3919]
 [ 12236 375340   8667]
 [  7032  68394  14712]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6630508
{'0': {'precision': 0.6093946244662145, 'recall': 0.2000412286126572, 'f1-score': 0.30120743706738684, 'support': 24255}, '1': {'precision': 0.7453417397538374, 'recall': 0.9697421413253832, 'f1-score': 0.8428617430341143, 'support': 114714}, '2': {'precision': 0.6086672117743255, 'recall': 0.1527977338971222, 'f1-score': 0.24427380717989103, 'support': 24359}, 'accuracy': 0.7335974235893417, 'macro avg': {'precision': 0.6544678586647924, 'recall': 0.44086036794505423, 'f1-score': 0.4627809957604641, 'support': 163328}, 'weighted avg': {'precision': 0.7047690754932439, 'recall': 0.7335974235893417, 'f1-score': 0.673149086779853, 'support': 163328}}
[[  4852  18519    884]
 [  1962 111243   1509]
 [  1148  19489   3722]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/WBA
Evaluating performance on  test set...
5696/5696 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0061285
{'0': {'precision': 0.49276566130498717, 'recall': 0.30497688937467, 'f1-score': 0.37676851622722257, 'support': 431836}, '1': {'precision': 0.4919344624817812, 'recall': 0.8051861516162097, 'f1-score': 0.6107355204874892, 'support': 607811}, '2': {'precision': 0.5370966836304981, 'recall': 0.25149805080107174, 'f1-score': 0.34258095603987726, 'support': 418377}, 'accuracy': 0.4981550372284681, 'macro avg': {'precision': 0.5072656024724221, 'recall': 0.4538870305973171, 'f1-score': 0.4433616642515297, 'support': 1458024}, 'weighted avg': {'precision': 0.5051398529092053, 'recall': 0.4981550372284681, 'f1-score': 0.46449301867569814, 'support': 1458024}}
[[131700 256968  43168]
 [ 70892 489401  47518]
 [ 64675 248481 105221]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88538796
{'0': {'precision': 0.5342279213594712, 'recall': 0.27515817467159576, 'f1-score': 0.3632312944852728, 'support': 136874}, '1': {'precision': 0.5955345573702042, 'recall': 0.8837359662179, 'f1-score': 0.7115605956875691, 'support': 296962}, '2': {'precision': 0.5349185350229773, 'recall': 0.2279961122693515, 'f1-score': 0.31971950413825034, 'support': 134783}, 'accuracy': 0.5818096124118258, 'macro avg': {'precision': 0.5548936712508842, 'recall': 0.46229675105294904, 'f1-score': 0.46483713143703076, 'support': 568619}, 'weighted avg': {'precision': 0.5664090905156682, 'recall': 0.5818096124118258, 'f1-score': 0.5348328700662744, 'support': 568619}}
[[ 37662  88359  10853]
 [ 18661 262436  15865]
 [ 14175  89878  30730]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8927452
{'0': {'precision': 0.5386831780284453, 'recall': 0.22304861022972458, 'f1-score': 0.3154720232645808, 'support': 39395}, '1': {'precision': 0.5878317969061089, 'recall': 0.9053994630623958, 'f1-score': 0.7128468410191465, 'support': 86416}, '2': {'precision': 0.5299293335180824, 'recall': 0.20109895888106005, 'f1-score': 0.29155708023632554, 'support': 38036}, 'accuracy': 0.5778378609312347, 'macro avg': {'precision': 0.5521481028175456, 'recall': 0.4431823440577269, 'f1-score': 0.439958648173351, 'support': 163847}, 'weighted avg': {'precision': 0.5625729399351999, 'recall': 0.5778378609312347, 'f1-score': 0.5195033053634647, 'support': 163847}}
[[ 8787 27736  2872]
 [ 4262 78241  3913]
 [ 3263 27124  7649]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85331786
{'0': {'precision': 0.5873931285623812, 'recall': 0.21470912071392712, 'f1-score': 0.31447028670177996, 'support': 691163}, '1': {'precision': 0.6059892335933983, 'recall': 0.9494443362533239, 'f1-score': 0.7397976446174321, 'support': 1709937}, '2': {'precision': 0.6475803166844866, 'recall': 0.14795228443224348, 'f1-score': 0.24087256027554532, 'support': 687742}, 'accuracy': 0.6065839560586136, 'macro avg': {'precision': 0.6136542262800887, 'recall': 0.4373685804664981, 'f1-score': 0.4317134971982524, 'support': 3088842}, 'weighted avg': {'precision': 0.6110885539618983, 'recall': 0.6065839560586136, 'f1-score': 0.5335383836922978, 'support': 3088842}}
[[ 148399  519172   23592]
 [  54664 1623490   31783]
 [  49577  536412  101753]]
Evaluating performance on  train set...
2948/2948 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8838524
{'0': {'precision': 0.58118449348083, 'recall': 0.17599882663537694, 'f1-score': 0.2701797205347936, 'support': 170450}, '1': {'precision': 0.5943637022668642, 'recall': 0.9428544620818077, 'f1-score': 0.7291072689337105, 'support': 415658}, '2': {'precision': 0.5901232297222733, 'recall': 0.15244633969615262, 'f1-score': 0.24229952329258508, 'support': 168374}, 'accuracy': 0.5932175982992305, 'macro avg': {'precision': 0.5885571418233225, 'recall': 0.42376654280444576, 'f1-score': 0.4138621709203631, 'support': 754482}, 'weighted avg': {'precision': 0.5904399751775466, 'recall': 0.5932175982992305, 'f1-score': 0.5167894561970591, 'support': 754482}}
[[ 29999 134142   6309]
 [ 12234 391905  11519]
 [  9384 133322  25668]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7829514
{'0': {'precision': 0.5893017411595763, 'recall': 0.18995544754961524, 'f1-score': 0.28730200402555356, 'support': 34566}, '1': {'precision': 0.6647332227302086, 'recall': 0.9539196888602143, 'f1-score': 0.7834936130671832, 'support': 110047}, '2': {'precision': 0.5999357326478149, 'recall': 0.16577381833249474, 'f1-score': 0.259768568977112, 'support': 33787}, 'accuracy': 0.6566311659192825, 'macro avg': {'precision': 0.6179902321792, 'recall': 0.4365496515807748, 'f1-score': 0.4435213953566162, 'support': 178400}, 'weighted avg': {'precision': 0.6378460176327629, 'recall': 0.6566311659192825, 'f1-score': 0.5881659380514647, 'support': 178400}}
[[  6566  26639   1361]
 [  2697 104976   2374]
 [  1879  26307   5601]]
testing model on single stock: results/universal/W1/deepLOB_L1/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 111s - 111s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.5699149
{'0': {'precision': 0.5570312055237925, 'recall': 0.032334528198293765, 'f1-score': 0.06112110084374819, 'support': 2118231}, '1': {'precision': 0.22287852090687071, 'recall': 0.9622769707090895, 'f1-score': 0.3619286573814123, 'support': 1205391}, '2': {'precision': 0.501921029153596, 'recall': 0.03255911639857276, 'f1-score': 0.06115140233776285, 'support': 2142595}, 'accuracy': 0.2374902057492412, 'macro avg': {'precision': 0.4272769185280864, 'recall': 0.3423902051019853, 'f1-score': 0.16140038685430777, 'support': 5466217}, 'weighted avg': {'precision': 0.4617434723432442, 'recall': 0.2374902057492412, 'f1-score': 0.12746600541157999, 'support': 5466217}}
[[  68492 2005584   44155]
 [  20399 1159920   25072]
 [  34068 2038766   69761]]
Evaluating performance on  train set...
6073/6073 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.21556
{'0': {'precision': 0.524008584074753, 'recall': 0.09527622423099434, 'f1-score': 0.1612361830475365, 'support': 492064}, '1': {'precision': 0.3822305878005618, 'recall': 0.9334141716074362, 'f1-score': 0.5423644109454366, 'support': 567388}, '2': {'precision': 0.5289131473702744, 'recall': 0.08494411252630771, 'f1-score': 0.14637949517590876, 'support': 495102}, 'accuracy': 0.39789290047177517, 'macro avg': {'precision': 0.4783841064151964, 'recall': 0.3712115027882461, 'f1-score': 0.2833266963896273, 'support': 1554554}, 'weighted avg': {'precision': 0.4738238528571294, 'recall': 0.39789290047177517, 'f1-score': 0.2956104197044266, 'support': 1554554}}
[[ 46882 424991  20191]
 [ 20513 529608  17267]
 [ 22073 430973  42056]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3266084
{'0': {'precision': 0.5427003492221869, 'recall': 0.07708561489402821, 'f1-score': 0.13499624885068168, 'support': 155230}, '1': {'precision': 0.32873347406924597, 'recall': 0.9307542934266158, 'f1-score': 0.48586433354780956, 'support': 145222}, '2': {'precision': 0.47213415651593527, 'recall': 0.07220829266114163, 'f1-score': 0.12525938919723542, 'support': 156741}, 'accuracy': 0.3465713604539002, 'macro avg': {'precision': 0.4478559932691228, 'recall': 0.3600160669939285, 'f1-score': 0.24870665719857554, 'support': 457193}, 'weighted avg': {'precision': 0.4505438351145103, 'recall': 0.3465713604539002, 'f1-score': 0.2431072651543991, 'support': 457193}}
[[ 11966 135740   7524]
 [  4926 135166   5130]
 [  5157 140266  11318]]
training model: results/universal/W1/deepLOB_L1/h30
Epoch 1/50
10622/10622 - 161s - loss: 2.9785 - accuracy30: 0.4922 - val_loss: 3.5845 - val_accuracy30: 0.4300 - 161s/epoch - 15ms/step
Epoch 2/50
10622/10622 - 160s - loss: 2.8903 - accuracy30: 0.5169 - val_loss: 3.7352 - val_accuracy30: 0.4229 - 160s/epoch - 15ms/step
Epoch 3/50
10622/10622 - 162s - loss: 2.8540 - accuracy30: 0.5259 - val_loss: 3.8084 - val_accuracy30: 0.4210 - 162s/epoch - 15ms/step
Epoch 4/50
10622/10622 - 161s - loss: 2.8327 - accuracy30: 0.5309 - val_loss: 3.7105 - val_accuracy30: 0.4289 - 161s/epoch - 15ms/step
Epoch 5/50
10622/10622 - 161s - loss: 2.8188 - accuracy30: 0.5341 - val_loss: 3.7668 - val_accuracy30: 0.4262 - 161s/epoch - 15ms/step
Epoch 6/50
10622/10622 - 162s - loss: 2.8072 - accuracy30: 0.5366 - val_loss: 3.7447 - val_accuracy30: 0.4257 - 162s/epoch - 15ms/step
Epoch 7/50
10622/10622 - 162s - loss: 2.7994 - accuracy30: 0.5384 - val_loss: 3.7711 - val_accuracy30: 0.4273 - 162s/epoch - 15ms/step
Epoch 8/50
10622/10622 - 164s - loss: 2.7930 - accuracy30: 0.5399 - val_loss: 3.7953 - val_accuracy30: 0.4285 - 164s/epoch - 15ms/step
Epoch 9/50
10622/10622 - 165s - loss: 2.7880 - accuracy30: 0.5409 - val_loss: 3.8339 - val_accuracy30: 0.4309 - 165s/epoch - 16ms/step
Epoch 10/50
10622/10622 - 157s - loss: 2.7835 - accuracy30: 0.5416 - val_loss: 3.8112 - val_accuracy30: 0.4329 - 157s/epoch - 15ms/step
Epoch 11/50
10622/10622 - 161s - loss: 2.7795 - accuracy30: 0.5428 - val_loss: 3.8947 - val_accuracy30: 0.4281 - 161s/epoch - 15ms/step
testing model in sample: results/universal/W1/deepLOB_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 187s - 187s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2139524
{'0': {'precision': 0.4283112316639621, 'recall': 0.409912039948982, 'f1-score': 0.41890970258221716, 'support': 3087538}, '1': {'precision': 0.34899229557214584, 'recall': 0.7283101983348377, 'f1-score': 0.47187238392752817, 'support': 2869390}, '2': {'precision': 0.5532425477780669, 'recall': 0.01857855373702244, 'f1-score': 0.035949867454238366, 'support': 3089853}, 'accuracy': 0.3772424688958426, 'macro avg': {'precision': 0.4435153583380583, 'recall': 0.38560026400694736, 'f1-score': 0.3089106513213279, 'support': 9046781}, 'weighted avg': {'precision': 0.44582270230270293, 'recall': 0.3772424688958426, 'f1-score': 0.30491125305367556, 'support': 9046781}}
[[1265619 1807992   13927]
 [ 747155 2089806   32429]
 [ 942131 2090317   57405]]
Evaluating performance on  train set...
10622/10622 - 63s - 63s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1049664
{'0': {'precision': 0.40657080894717423, 'recall': 0.35145537798980325, 'f1-score': 0.3770093957190142, 'support': 793196}, '1': {'precision': 0.4483704419961088, 'recall': 0.7801926045647211, 'f1-score': 0.569470657497037, 'support': 1131022}, '2': {'precision': 0.5627353540341996, 'recall': 0.045906060209292256, 'f1-score': 0.08488729961401108, 'support': 794296}, 'accuracy': 0.4405535524187111, 'macro avg': {'precision': 0.4725588683258275, 'recall': 0.3925180142546055, 'f1-score': 0.34378911761002073, 'support': 2718514}, 'weighted avg': {'precision': 0.46958949418282725, 'recall': 0.4405535524187111, 'f1-score': 0.3717294923493363, 'support': 2718514}}
[[278773 506372   8051]
 [228325 882415  20282]
 [178571 579262  36463]]
Evaluating performance on  val set...
3064/3064 - 22s - 22s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1269882
{'0': {'precision': 0.4048387235174491, 'recall': 0.3955672190524899, 'f1-score': 0.4001492730360736, 'support': 238541}, '1': {'precision': 0.4368352395336781, 'recall': 0.7587766208181218, 'f1-score': 0.5544614902199269, 'support': 307607}, '2': {'precision': 0.5540235495088768, 'recall': 0.03821487185961368, 'f1-score': 0.07149802575377626, 'support': 237630}, 'accuracy': 0.42977093003375955, 'macro avg': {'precision': 0.465232504186668, 'recall': 0.39751957057674175, 'f1-score': 0.3420362630032589, 'support': 783778}, 'weighted avg': {'precision': 0.4626269524579745, 'recall': 0.42977093003375955, 'f1-score': 0.3610694855191762, 'support': 783778}}
[[ 94359 142041   2141]
 [ 69033 233405   5169]
 [ 69686 158863   9081]]
testing model out of sample: results/universal/W1/deepLOB_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 122s - 122s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0118241
{'0': {'precision': 0.42467909803510023, 'recall': 0.34781992228034536, 'f1-score': 0.3824259888700919, 'support': 1593934}, '1': {'precision': 0.5232799963460865, 'recall': 0.8227915329085219, 'f1-score': 0.6397139245228386, 'support': 2924121}, '2': {'precision': 0.5832589000893199, 'recall': 0.07227375673643274, 'f1-score': 0.1286108675761058, 'support': 1581141}, 'accuracy': 0.5041023439810756, 'macro avg': {'precision': 0.5104059981568355, 'recall': 0.4142950706417667, 'f1-score': 0.3835835936563454, 'support': 6099196}, 'weighted avg': {'precision': 0.5130609083867975, 'recall': 0.5041023439810756, 'f1-score': 0.439978420533372, 'support': 6099196}}
[[ 554402 1015820   23712]
 [ 460241 2405942   57938]
 [ 290818 1176048  114275]]
Evaluating performance on  train set...
6711/6711 - 46s - 46s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9920859
{'0': {'precision': 0.44624535602225257, 'recall': 0.26573343206729194, 'f1-score': 0.33310630031008687, 'support': 436189}, '1': {'precision': 0.5312744914164605, 'recall': 0.8799335733386248, 'f1-score': 0.6625334326400392, 'support': 846648}, '2': {'precision': 0.5673953959750977, 'recall': 0.07216630106274499, 'f1-score': 0.1280465267297941, 'support': 434441}, 'accuracy': 0.5195757471999292, 'macro avg': {'precision': 0.5149717478046036, 'recall': 0.40594443548955383, 'f1-score': 0.3745620865599734, 'support': 1717278}, 'weighted avg': {'precision': 0.518815022628585, 'recall': 0.5195757471999292, 'f1-score': 0.4436431205796609, 'support': 1717278}}
[[115910 314590   5689]
 [ 83439 744994  18215]
 [ 60396 342693  31352]]
Evaluating performance on  val set...
1720/1720 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95988816
{'0': {'precision': 0.4419653529252395, 'recall': 0.26157082087510963, 'f1-score': 0.32864050056882815, 'support': 106021}, '1': {'precision': 0.5615947189657061, 'recall': 0.8948845532713544, 'f1-score': 0.6901058583954627, 'support': 229110}, '2': {'precision': 0.5946283053384334, 'recall': 0.06828555604362026, 'f1-score': 0.12250316921917292, 'support': 104722}, 'accuracy': 0.5454322239475461, 'macro avg': {'precision': 0.5327294590764596, 'recall': 0.4082469767300281, 'f1-score': 0.38041650939448796, 'support': 439853}, 'weighted avg': {'precision': 0.5406243452616468, 'recall': 0.5454322239475461, 'f1-score': 0.4678420395331222, 'support': 439853}}
[[ 27732  76819   1470]
 [ 20678 205027   3405]
 [ 14337  83234   7151]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3208804
{'0': {'precision': 0.42037444312863026, 'recall': 0.2288025045656144, 'f1-score': 0.2963220606795393, 'support': 65161}, '1': {'precision': 0.24188421226252418, 'recall': 0.8125267585060568, 'f1-score': 0.37279087636996, 'support': 39707}, '2': {'precision': 0.5880952380952381, 'recall': 0.007621104597346498, 'f1-score': 0.015047212915016752, 'support': 64820}, 'accuracy': 0.28090377634246383, 'macro avg': {'precision': 0.4167846311621308, 'recall': 0.34965012255633926, 'f1-score': 0.22805338332150535, 'support': 169688}, 'weighted avg': {'precision': 0.4426762578281673, 'recall': 0.28090377634246383, 'f1-score': 0.20677012791189034, 'support': 169688}}
[[14909 50106   146]
 [ 7244 32263   200]
 [13313 51013   494]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2372715
{'0': {'precision': 0.40919712902687366, 'recall': 0.22427042356600493, 'f1-score': 0.2897411653468857, 'support': 21862}, '1': {'precision': 0.3339842660268928, 'recall': 0.8302357836338419, 'f1-score': 0.4763458401305057, 'support': 21630}, '2': {'precision': 0.5401554404145078, 'recall': 0.01810603100169337, 'f1-score': 0.035037600302482874, 'support': 23031}, 'accuracy': 0.34992408640620537, 'macro avg': {'precision': 0.42777894515609144, 'recall': 0.3575374127338467, 'f1-score': 0.26704153525995805, 'support': 66523}, 'weighted avg': {'precision': 0.43008083305223355, 'recall': 0.34992408640620537, 'f1-score': 0.2622346083520427, 'support': 66523}}
[[ 4903 16808   151]
 [ 3468 17958   204]
 [ 3611 19003   417]]
Evaluating performance on  val set...
51/51 - 0s - 451ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2295823
{'0': {'precision': 0.462111801242236, 'recall': 0.17158671586715868, 'f1-score': 0.25025227043390513, 'support': 4336}, '1': {'precision': 0.3422039649937489, 'recall': 0.8866265617769551, 'f1-score': 0.4938144329896907, 'support': 4322}, '2': {'precision': 0.5897435897435898, 'recall': 0.00549057054189544, 'f1-score': 0.010879848628192999, 'support': 4189}, 'accuracy': 0.35798240834436057, 'macro avg': {'precision': 0.46468645199319153, 'recall': 0.3545679493953364, 'f1-score': 0.2516488506839296, 'support': 12847}, 'weighted avg': {'precision': 0.4633889783081821, 'recall': 0.35798240834436057, 'f1-score': 0.25413991670322694, 'support': 12847}}
[[ 744 3582   10]
 [ 484 3832    6]
 [ 382 3784   23]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7898485
{'0': {'precision': 0.3268732055200519, 'recall': 0.4992308372380868, 'f1-score': 0.3950717479063324, 'support': 56555}, '1': {'precision': 0.8011929717697908, 'recall': 0.8004849246068485, 'f1-score': 0.8008387916865705, 'support': 308914}, '2': {'precision': 0.4356557534720886, 'recall': 0.20388541797951062, 'f1-score': 0.2777736895037653, 'support': 55541}, 'accuracy': 0.6813116078002898, 'macro avg': {'precision': 0.5212406435873104, 'recall': 0.5012003932748154, 'f1-score': 0.49122807636555604, 'support': 421010}, 'weighted avg': {'precision': 0.6892539275149592, 'recall': 0.6813116078002898, 'f1-score': 0.6773269653610045, 'support': 421010}}
[[ 28234  27289   1032]
 [ 47996 247281  13637]
 [ 10146  34071  11324]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8998701
{'0': {'precision': 0.3832510885341074, 'recall': 0.39901477832512317, 'f1-score': 0.39097410385110826, 'support': 33089}, '1': {'precision': 0.6669838773102634, 'recall': 0.8358251613856995, 'f1-score': 0.74191982153402, 'support': 101465}, '2': {'precision': 0.524445280180519, 'recall': 0.08617599802249414, 'f1-score': 0.1480282362931904, 'support': 32364}, 'accuracy': 0.6038833439173726, 'macro avg': {'precision': 0.5248934153416299, 'recall': 0.4403386459111056, 'f1-score': 0.4269740538927729, 'support': 166918}, 'weighted avg': {'precision': 0.5831010521786343, 'recall': 0.6038833439173726, 'f1-score': 0.5571994791075348, 'support': 166918}}
[[13203 19572   314]
 [14443 84807  2215]
 [ 6804 22771  2789]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8114202
{'0': {'precision': 0.4828098471986418, 'recall': 0.2769661553445337, 'f1-score': 0.3520037134457682, 'support': 8214}, '1': {'precision': 0.6982861495493208, 'recall': 0.9104210805084746, 'f1-score': 0.7903668472403834, 'support': 30208}, '2': {'precision': 0.5426356589147286, 'recall': 0.1512455516014235, 'f1-score': 0.23655700228605506, 'support': 7868}, 'accuracy': 0.6689781810326204, 'macro avg': {'precision': 0.5745772185542304, 'recall': 0.4462109291514773, 'f1-score': 0.45964252099073555, 'support': 46290}, 'weighted avg': {'precision': 0.6335944146644331, 'recall': 0.6689781810326204, 'f1-score': 0.6184487085259823, 'support': 46290}}
[[ 2275  5798   141]
 [ 1844 27502   862]
 [  593  6085  1190]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2757114
{'0': {'precision': 0.4762669926361136, 'recall': 0.36683016461155316, 'f1-score': 0.41444594565613674, 'support': 131704}, '1': {'precision': 0.223296408190668, 'recall': 0.7142243600755884, 'f1-score': 0.3402244294642949, 'support': 69852}, '2': {'precision': 0.600754452144925, 'recall': 0.05083550468045936, 'f1-score': 0.09373887809017986, 'support': 134709}, 'accuracy': 0.31240539455488975, 'macro avg': {'precision': 0.43343928432390216, 'recall': 0.377296676455867, 'f1-score': 0.28280308440353713, 'support': 336265}, 'weighted avg': {'precision': 0.4735877959260462, 'recall': 0.31240539455488975, 'f1-score': 0.270551547744445, 'support': 336265}}
[[48313 80917  2474]
 [17885 49890  2077]
 [35243 92618  6848]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1591321
{'0': {'precision': 0.458478814758894, 'recall': 0.43344633776429653, 'f1-score': 0.44561129964230023, 'support': 44836}, '1': {'precision': 0.390296576892872, 'recall': 0.7705901130974097, 'f1-score': 0.5181533838275428, 'support': 43856}, '2': {'precision': 0.5658468861562872, 'recall': 0.06294400564797246, 'f1-score': 0.11328621346886913, 'support': 45326}, 'accuracy': 0.41846617618528853, 'macro avg': {'precision': 0.471540759269351, 'recall': 0.4223268188365595, 'f1-score': 0.35901696564623736, 'support': 134018}, 'weighted avg': {'precision': 0.47247965778226386, 'recall': 0.41846617618528853, 'f1-score': 0.35695484146601836, 'support': 134018}}
[[19434 24619   783]
 [ 8655 33795  1406]
 [14299 28174  2853]]
Evaluating performance on  val set...
107/107 - 1s - 742ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2861322
{'0': {'precision': 0.4690668793437393, 'recall': 0.38773780372951594, 'f1-score': 0.4245424078370714, 'support': 10618}, '1': {'precision': 0.2352644554011654, 'recall': 0.7181460578074226, 'f1-score': 0.3544207638742351, 'support': 5847}, '2': {'precision': 0.6568807339449542, 'recall': 0.03344231667445119, 'f1-score': 0.06364444444444445, 'support': 10705}, 'accuracy': 0.3192491718807508, 'macro avg': {'precision': 0.4537373562299529, 'recall': 0.3797753927371299, 'f1-score': 0.28086920538525034, 'support': 27170}, 'weighted avg': {'precision': 0.49275125699238764, 'recall': 0.3192491718807508, 'f1-score': 0.2672581255268478, 'support': 27170}}
[[4117 6412   89]
 [1550 4199   98]
 [3110 7237  358]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2185496
{'0': {'precision': 0.37573317528764993, 'recall': 0.4761185397477621, 'f1-score': 0.42001096574727, 'support': 115843}, '1': {'precision': 0.3295876877191756, 'recall': 0.5299743344761049, 'f1-score': 0.4064232968422263, 'support': 106758}, '2': {'precision': 0.44666928412511453, 'recall': 0.06141803131185892, 'f1-score': 0.10798753381531694, 'support': 111140}, 'accuracy': 0.35524553471104836, 'macro avg': {'precision': 0.3839967157106467, 'recall': 0.35583696851190855, 'f1-score': 0.31147393213493774, 'support': 333741}, 'weighted avg': {'precision': 0.38459465522077363, 'recall': 0.35524553471104836, 'f1-score': 0.3117567309308048, 'support': 333741}}
[[55155 57254  3434]
 [45157 56579  5022]
 [46481 57833  6826]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2288939
{'0': {'precision': 0.36273659507168, 'recall': 0.42180825818699574, 'f1-score': 0.3900485503469841, 'support': 33712}, '1': {'precision': 0.3230079125194925, 'recall': 0.5156115550092194, 'f1-score': 0.3971923345525135, 'support': 32540}, '2': {'precision': 0.42543303760033796, 'recall': 0.09442395449146715, 'f1-score': 0.15454661721447754, 'support': 31994}, 'accuracy': 0.34626346110783135, 'macro avg': {'precision': 0.3703925150638368, 'recall': 0.3439479225625608, 'f1-score': 0.3139291673713251, 'support': 98246}, 'weighted avg': {'precision': 0.36999529926333874, 'recall': 0.34626346110783135, 'f1-score': 0.3157229787146175, 'support': 98246}}
[[14220 17645  1847]
 [13529 16778  2233]
 [11453 17520  3021]]
Evaluating performance on  val set...
93/93 - 1s - 694ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2262225
{'0': {'precision': 0.36404293381037567, 'recall': 0.4024224446916327, 'f1-score': 0.38227179336659817, 'support': 8091}, '1': {'precision': 0.3177194421657096, 'recall': 0.5169514148424986, 'f1-score': 0.39355756528808045, 'support': 7492}, '2': {'precision': 0.44129554655870445, 'recall': 0.13589328013963345, 'f1-score': 0.2077971594700219, 'support': 8021}, 'accuracy': 0.3482036942891035, 'macro avg': {'precision': 0.37435264084492986, 'recall': 0.35175571322458826, 'f1-score': 0.32787550604156684, 'support': 23604}, 'weighted avg': {'precision': 0.3755912988100582, 'recall': 0.3482036942891035, 'f1-score': 0.3265647930595022, 'support': 23604}}
[[3256 4166  669]
 [2908 3873  711]
 [2780 4151 1090]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1952486
{'0': {'precision': 0.4578128139367222, 'recall': 0.31467483356824005, 'f1-score': 0.37298245867425417, 'support': 246197}, '1': {'precision': 0.2832258807016277, 'recall': 0.7014811088754751, 'f1-score': 0.4035263422718994, 'support': 178920}, '2': {'precision': 0.5303281224408087, 'recall': 0.12032040298106897, 'f1-score': 0.19614059176695472, 'support': 242195}, 'accuracy': 0.3478462847963172, 'macro avg': {'precision': 0.4237889390263862, 'recall': 0.37882544847492805, 'f1-score': 0.3242164642377028, 'support': 667312}, 'weighted avg': {'precision': 0.43732127631822304, 'recall': 0.3478462847963172, 'f1-score': 0.3169887041751253, 'support': 667312}}
[[ 77472 154579  14146]
 [ 41749 125509  11662]
 [ 50001 163053  29141]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.160902
{'0': {'precision': 0.4288542393333208, 'recall': 0.36751114845214244, 'f1-score': 0.39582010075610585, 'support': 61892}, '1': {'precision': 0.35194531294878423, 'recall': 0.7082906688687035, 'f1-score': 0.4702341467158606, 'support': 60550}, '2': {'precision': 0.5569296811120196, 'recall': 0.08755101385005945, 'f1-score': 0.151314876010108, 'support': 62238}, 'accuracy': 0.38489278752436645, 'macro avg': {'precision': 0.44590974446470816, 'recall': 0.38778427705696844, 'f1-score': 0.33912304116069153, 'support': 184680}, 'weighted avg': {'precision': 0.4468005456623167, 'recall': 0.38489278752436645, 'f1-score': 0.33781844548819234, 'support': 184680}}
[[22746 37432  1714]
 [15042 42887  2621]
 [15251 41538  5449]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1851655
{'0': {'precision': 0.4679649076166423, 'recall': 0.3329550290821393, 'f1-score': 0.3890807614732131, 'support': 21147}, '1': {'precision': 0.2952224980168377, 'recall': 0.7183686176836862, 'f1-score': 0.41846968570340415, 'support': 16060}, '2': {'precision': 0.5711775043936731, 'recall': 0.10884646667623558, 'f1-score': 0.1828484166532712, 'support': 20901}, 'accuracy': 0.35886624905348663, 'macro avg': {'precision': 0.44478830334238434, 'recall': 0.3867233711473537, 'f1-score': 0.33013295460996284, 'support': 58108}, 'weighted avg': {'precision': 0.45734680661615806, 'recall': 0.35886624905348663, 'f1-score': 0.32302314262650117, 'support': 58108}}
[[ 7041 13333   773]
 [ 3588 11537   935]
 [ 4417 14209  2275]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/EXC
Evaluating performance on  test set...
5343/5343 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8947607
{'0': {'precision': 0.4363034063493703, 'recall': 0.4408142880570091, 'f1-score': 0.43854724781697846, 'support': 268308}, '1': {'precision': 0.64987590956818, 'recall': 0.8541934082903054, 'f1-score': 0.738157093650701, 'support': 828920}, '2': {'precision': 0.7177879927566514, 'recall': 0.01904561263448908, 'f1-score': 0.03710664650392453, 'support': 270561}, 'accuracy': 0.6079044355525597, 'macro avg': {'precision': 0.6013224362247339, 'recall': 0.4380177696606012, 'f1-score': 0.4046036626572013, 'support': 1367789}, 'weighted avg': {'precision': 0.6214147579913823, 'recall': 0.6079044355525597, 'f1-score': 0.5407109754654887, 'support': 1367789}}
[[118274 149704    330]
 [119166 708058   1696]
 [ 33642 231766   5153]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8110698
{'0': {'precision': 0.39418315210271193, 'recall': 0.5501856016969298, 'f1-score': 0.45929917491623223, 'support': 54687}, '1': {'precision': 0.7426071690075218, 'recall': 0.813922948195908, 'f1-score': 0.7766313156034155, 'support': 219307}, '2': {'precision': 0.6383262853327398, 'recall': 0.15314240962568748, 'f1-score': 0.24702133157244982, 'support': 56183}, 'accuracy': 0.6578017245295705, 'macro avg': {'precision': 0.5917055354809911, 'recall': 0.5057503198395085, 'f1-score': 0.4943172740306992, 'support': 330177}, 'weighted avg': {'precision': 0.6671534665994994, 'recall': 0.6578017245295705, 'f1-score': 0.6339532353295874, 'support': 330177}}
[[ 30088  24116    483]
 [ 36416 178499   4392]
 [  9826  37753   8604]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81168807
{'0': {'precision': 0.3914585488399586, 'recall': 0.5131069214876033, 'f1-score': 0.44410293665651457, 'support': 15488}, '1': {'precision': 0.7406977250620636, 'recall': 0.8221473806339333, 'f1-score': 0.7793001267775588, 'support': 62057}, '2': {'precision': 0.6163298743855816, 'recall': 0.1475259820903327, 'f1-score': 0.23806761246769684, 'support': 15299}, 'accuracy': 0.6594287191417862, 'macro avg': {'precision': 0.582828716095868, 'recall': 0.49426009473728977, 'f1-score': 0.4871568919672567, 'support': 92844}, 'weighted avg': {'precision': 0.661944977347322, 'recall': 0.6594287191417862, 'f1-score': 0.6341981243108263, 'support': 92844}}
[[ 7947  7459    82]
 [ 9714 51020  1323]
 [ 2640 10402  2257]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/AAL
Evaluating performance on  test set...
7177/7177 - 43s - 43s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82306594
{'0': {'precision': 0.47473512436278215, 'recall': 0.2883140726361672, 'f1-score': 0.3587522735540196, 'support': 342061}, '1': {'precision': 0.6783454020097563, 'recall': 0.9012145811909579, 'f1-score': 0.7740570461101032, 'support': 1158177}, '2': {'precision': 0.5693831627250264, 'recall': 0.1532368910883447, 'f1-score': 0.24148376517811407, 'support': 336851}, 'accuracy': 0.6499440146884555, 'macro avg': {'precision': 0.5741545630325217, 'recall': 0.4475885149718232, 'f1-score': 0.45809769494741226, 'support': 1837089}, 'weighted avg': {'precision': 0.6204542631223632, 'recall': 0.6499440146884555, 'f1-score': 0.5990751001834073, 'support': 1837089}}
[[  98621  238824    4616]
 [  79989 1043766   34422]
 [  29129  256104   51618]]
Evaluating performance on  train set...
2257/2257 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8430054
{'0': {'precision': 0.43927918516583964, 'recall': 0.20183689481700282, 'f1-score': 0.2765887472171625, 'support': 108335}, '1': {'precision': 0.6556660388957738, 'recall': 0.9262521746082948, 'f1-score': 0.7678173108567667, 'support': 362709}, '2': {'precision': 0.5293773940141531, 'recall': 0.07654110071246867, 'f1-score': 0.13374448472124265, 'support': 106531}, 'accuracy': 0.6336493096134701, 'macro avg': {'precision': 0.5414408726919221, 'recall': 0.40154339004592216, 'f1-score': 0.3927168475983906, 'support': 577575}, 'weighted avg': {'precision': 0.591785286739402, 'recall': 0.6336493096134701, 'f1-score': 0.5587264418216804, 'support': 577575}}
[[ 21866  85628    841]
 [ 20341 335960   6408]
 [  7570  90807   8154]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81286293
{'0': {'precision': 0.4829154375614553, 'recall': 0.13593274287295876, 'f1-score': 0.2121490280777538, 'support': 28904}, '1': {'precision': 0.6673478909427837, 'recall': 0.9625792631489152, 'f1-score': 0.7882257063023905, 'support': 105503}, '2': {'precision': 0.6009950248756218, 'recall': 0.06265343522008229, 'f1-score': 0.11347695390781563, 'support': 28921}, 'accuracy': 0.656935736677116, 'macro avg': {'precision': 0.5837527844599536, 'recall': 0.3870551470806521, 'f1-score': 0.3712838960959866, 'support': 163328}, 'weighted avg': {'precision': 0.6229597463989069, 'recall': 0.656935736677116, 'f1-score': 0.5667980945309343, 'support': 163328}}
[[  3929  24758    217]
 [  2962 101555    986]
 [  1245  25864   1812]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/WBA
Evaluating performance on  test set...
5696/5696 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1324736
{'0': {'precision': 0.4385216839590953, 'recall': 0.3873418921229878, 'f1-score': 0.4113459503989374, 'support': 485349}, '1': {'precision': 0.3695893147252734, 'recall': 0.728481224328768, 'f1-score': 0.49038539313119106, 'support': 499343}, '2': {'precision': 0.6321999689489209, 'recall': 0.06021988794334632, 'f1-score': 0.10996510544559515, 'support': 473332}, 'accuracy': 0.39797835975265156, 'macro avg': {'precision': 0.4801036558777632, 'recall': 0.39201433479836734, 'f1-score': 0.33723214965857456, 'support': 1458024}, 'weighted avg': {'precision': 0.477789373613367, 'recall': 0.39797835975265156, 'f1-score': 0.3405752321863403, 'support': 1458024}}
[[187996 290763   6590]
 [125588 363762   9993]
 [115120 329708  28504]]
Evaluating performance on  train set...
2222/2222 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0187846
{'0': {'precision': 0.4685159133811877, 'recall': 0.2488679401940309, 'f1-score': 0.32506611273785985, 'support': 156573}, '1': {'precision': 0.4837384897907552, 'recall': 0.8615014721076386, 'f1-score': 0.6195793061064865, 'support': 257454}, '2': {'precision': 0.5596422209026128, 'recall': 0.09754062305940799, 'f1-score': 0.1661268288383571, 'support': 154592}, 'accuracy': 0.48510865799419295, 'macro avg': {'precision': 0.5039655413581853, 'recall': 0.40263667845369255, 'f1-score': 0.37025741589423444, 'support': 568619}, 'weighted avg': {'precision': 0.5001830073743553, 'recall': 0.48510865799419295, 'f1-score': 0.41520178866310065, 'support': 568619}}
[[ 38966 114045   3562]
 [ 27354 221797   8303]
 [ 16849 122664  15079]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0223646
{'0': {'precision': 0.4654186985475329, 'recall': 0.19538180457417068, 'f1-score': 0.2752248062015504, 'support': 45429}, '1': {'precision': 0.47811406603216655, 'recall': 0.89141085354559, 'f1-score': 0.6223998725416231, 'support': 74501}, '2': {'precision': 0.585631596867552, 'recall': 0.0783295762461006, 'f1-score': 0.13817758229398885, 'support': 43917}, 'accuracy': 0.48049094582140656, 'macro avg': {'precision': 0.5097214538157505, 'recall': 0.38837407812195374, 'f1-score': 0.3452674203457207, 'support': 163847}, 'weighted avg': {'precision': 0.503412726076221, 'recall': 0.48049094582140656, 'f1-score': 0.39635114165507335, 'support': 163847}}
[[ 8876 35767   786]
 [ 6442 66411  1648]
 [ 3753 36724  3440]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 70s - 70s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0387667
{'0': {'precision': 0.3981618148823996, 'recall': 0.3895533072621416, 'f1-score': 0.3938105222371862, 'support': 808811}, '1': {'precision': 0.5110060582670028, 'recall': 0.7814486299167831, 'f1-score': 0.6179326637331853, 'support': 1477465}, '2': {'precision': 0.6912867859203693, 'recall': 0.03283966676883895, 'f1-score': 0.06270072749592001, 'support': 802566}, 'accuracy': 0.4843219562541561, 'macro avg': {'precision': 0.5334848863565905, 'recall': 0.4012805346492545, 'f1-score': 0.3581479711554305, 'support': 3088842}, 'weighted avg': {'precision': 0.5282997615816131, 'recall': 0.4843219562541561, 'f1-score': 0.41498193736915717, 'support': 3088842}}
[[ 315075  491336    2400]
 [ 313532 1154563    9370]
 [ 162717  613493   26356]]
Evaluating performance on  train set...
2948/2948 - 16s - 16s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0129613
{'0': {'precision': 0.45862522531300237, 'recall': 0.23622430544403406, 'f1-score': 0.3118327652625547, 'support': 199264}, '1': {'precision': 0.501008414606559, 'recall': 0.8787073592565583, 'f1-score': 0.6381601041373915, 'support': 357903}, '2': {'precision': 0.5945542707944796, 'recall': 0.07270607911207967, 'f1-score': 0.12956774624735823, 'support': 197315}, 'accuracy': 0.4982345503272444, 'macro avg': {'precision': 0.5180626369046802, 'recall': 0.3958792479375573, 'f1-score': 0.3598535385491015, 'support': 754482}, 'weighted avg': {'precision': 0.514279184197256, 'recall': 0.4982345503272444, 'f1-score': 0.41896575364178346, 'support': 754482}}
[[ 47071 149947   2246]
 [ 35874 314492   7537]
 [ 19690 163279  14346]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9523306
{'0': {'precision': 0.4096389680876645, 'recall': 0.29074019894675246, 'f1-score': 0.3400972521282815, 'support': 41016}, '1': {'precision': 0.5787696768848385, 'recall': 0.8608617962989586, 'f1-score': 0.6921781205360461, 'support': 97378}, '2': {'precision': 0.6037311755450663, 'recall': 0.0671399290106484, 'f1-score': 0.12084130019120459, 'support': 40006}, 'accuracy': 0.5517937219730942, 'macro avg': {'precision': 0.5307132735058564, 'recall': 0.4062473080854532, 'f1-score': 0.3843722242851774, 'support': 178400}, 'weighted avg': {'precision': 0.5454823706257363, 'recall': 0.5517937219730942, 'f1-score': 0.4831094561115585, 'support': 178400}}
[[11925 28743   348]
 [12134 83829  1415]
 [ 5052 32268  2686]]
testing model on single stock: results/universal/W1/deepLOB_L1/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 104s - 104s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3480326
{'0': {'precision': 0.43302156184506596, 'recall': 0.4050126695421616, 'f1-score': 0.4185490572189993, 'support': 2161483}, '1': {'precision': 0.20788256200298685, 'recall': 0.6343656565566815, 'f1-score': 0.31314654047527046, 'support': 1125455}, '2': {'precision': 0.5525460455037919, 'recall': 0.002574245885909973, 'f1-score': 0.005124616795588993, 'support': 2179279}, 'accuracy': 0.29179009907583253, 'macro avg': {'precision': 0.3978167231172816, 'recall': 0.3473175239949177, 'f1-score': 0.24560673816328626, 'support': 5466217}, 'weighted avg': {'precision': 0.434319238859359, 'recall': 0.29179009907583253, 'f1-score': 0.23202280138552206, 'support': 5466217}}
[[ 875428 1283636    2419]
 [ 409381  713950    2124]
 [ 736864 1436805    5610]]
Evaluating performance on  train set...
6073/6073 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2128384
{'0': {'precision': 0.403071627869986, 'recall': 0.354186766575752, 'f1-score': 0.3770513146392724, 'support': 515135}, '1': {'precision': 0.34933704667917903, 'recall': 0.7319857916102842, 'f1-score': 0.47295728083716987, 'support': 520256}, '2': {'precision': 0.587955491378578, 'recall': 0.013332999462596525, 'f1-score': 0.026074705802582608, 'support': 519163}, 'accuracy': 0.3667907322614718, 'macro avg': {'precision': 0.44678805530924776, 'recall': 0.36650185254954426, 'f1-score': 0.2920277670930083, 'support': 1554554}, 'weighted avg': {'precision': 0.446832811436917, 'recall': 0.3667907322614718, 'f1-score': 0.291934673581304, 'support': 1554554}}
[[182454 330850   1831]
 [136416 380820   3020]
 [133789 378452   6922]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2549663
{'0': {'precision': 0.4008520376140725, 'recall': 0.4473682579237412, 'f1-score': 0.42283467796272534, 'support': 161319}, '1': {'precision': 0.3083820903771959, 'recall': 0.6359702734928646, 'f1-score': 0.41535733876655434, 'support': 133349}, '2': {'precision': 0.5276615527661552, 'recall': 0.006983540993693278, 'f1-score': 0.01378464378537249, 'support': 162525}, 'accuracy': 0.345827692025031, 'macro avg': {'precision': 0.4122985602524745, 'recall': 0.36344069080343305, 'f1-score': 0.28399222017155074, 'support': 457193}, 'weighted avg': {'precision': 0.4189602358060876, 'recall': 0.345827692025031, 'f1-score': 0.2752428458280591, 'support': 457193}}
[[ 72169  88709    441]
 [ 47968  84806    575]
 [ 59902 101488   1135]]
training model: results/universal/W1/deepOF_L1/h10
Epoch 1/50
10622/10622 - 144s - loss: 3.0556 - accuracy10: 0.4803 - val_loss: 3.7858 - val_accuracy10: 0.5415 - 144s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 141s - loss: 3.0284 - accuracy10: 0.4812 - val_loss: 3.7948 - val_accuracy10: 0.5411 - 141s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 141s - loss: 3.0035 - accuracy10: 0.4868 - val_loss: 3.8712 - val_accuracy10: 0.5391 - 141s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 142s - loss: 2.9837 - accuracy10: 0.4901 - val_loss: 3.8811 - val_accuracy10: 0.5400 - 142s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 142s - loss: 2.9699 - accuracy10: 0.4917 - val_loss: 3.8837 - val_accuracy10: 0.5400 - 142s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 141s - loss: 2.9583 - accuracy10: 0.4940 - val_loss: 3.8547 - val_accuracy10: 0.5406 - 141s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 144s - loss: 2.9490 - accuracy10: 0.4955 - val_loss: 3.8509 - val_accuracy10: 0.5409 - 144s/epoch - 14ms/step
Epoch 8/50
10622/10622 - 142s - loss: 2.9407 - accuracy10: 0.4973 - val_loss: 3.8559 - val_accuracy10: 0.5405 - 142s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 143s - loss: 2.9340 - accuracy10: 0.4986 - val_loss: 3.8543 - val_accuracy10: 0.5396 - 143s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 144s - loss: 2.9278 - accuracy10: 0.4996 - val_loss: 3.8579 - val_accuracy10: 0.5413 - 144s/epoch - 14ms/step
Epoch 11/50
10622/10622 - 145s - loss: 2.9219 - accuracy10: 0.5010 - val_loss: 3.8308 - val_accuracy10: 0.5405 - 145s/epoch - 14ms/step
testing model in sample: results/universal/W1/deepOF_L1/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 184s - 184s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1017327
{'0': {'precision': 0.4356981754041003, 'recall': 0.02459467609793799, 'f1-score': 0.04656103376603913, 'support': 2450571}, '1': {'precision': 0.45774622405342835, 'recall': 0.9661060737664466, 'f1-score': 0.6211759576169444, 'support': 4137762}, '2': {'precision': 0.41713516780513393, 'recall': 0.029758101026552387, 'f1-score': 0.05555308764316265, 'support': 2458423}, 'accuracy': 0.45662179901834427, 'macro avg': {'precision': 0.43685985575422087, 'recall': 0.34015295029697895, 'f1-score': 0.24109669300871542, 'support': 9046756}, 'weighted avg': {'precision': 0.4407379767477938, 'recall': 0.45662179901834427, 'f1-score': 0.31181921787224576, 'support': 9046756}}
[[  60271 2369042   21258]
 [  59279 3997517   80966]
 [  18782 2366483   73158]]
Evaluating performance on  train set...
10622/10622 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96959656
{'0': {'precision': 0.41801928441213293, 'recall': 0.03238265710659121, 'f1-score': 0.060108866784260896, 'support': 587722}, '1': {'precision': 0.5713866918009954, 'recall': 0.9680781071311546, 'f1-score': 0.7186224036071894, 'support': 1544238}, '2': {'precision': 0.39560381355932206, 'recall': 0.03820128172997744, 'f1-score': 0.06967448238548114, 'support': 586551}, 'accuracy': 0.5651557047221807, 'macro avg': {'precision': 0.4616699299241502, 'recall': 0.3462206819892411, 'f1-score': 0.2828019175923105, 'support': 2718511}, 'weighted avg': {'precision': 0.5003025496287075, 'recall': 0.5651557047221807, 'f1-score': 0.4362384275890091, 'support': 2718511}}
[[  19032  562414    6276]
 [  21338 1494943   27957]
 [   5159  558985   22407]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98993844
{'0': {'precision': 0.4281609195402299, 'recall': 0.03240376733526273, 'f1-score': 0.06024789661125021, 'support': 179331}, '1': {'precision': 0.5465136329631732, 'recall': 0.9680375917767988, 'f1-score': 0.6986171645897148, 'support': 425625}, '2': {'precision': 0.4053141875306824, 'recall': 0.036936584274689634, 'f1-score': 0.06770331495110601, 'support': 178820}, 'accuracy': 0.5415284469031968, 'macro avg': {'precision': 0.4599962466780285, 'recall': 0.3457926477955837, 'f1-score': 0.27552279205069036, 'support': 783776}, 'weighted avg': {'precision': 0.4872191466774387, 'recall': 0.5415284469031968, 'f1-score': 0.4086115841838054, 'support': 783776}}
[[  5811 171445   2075]
 [  5988 412021   7616]
 [  1773 170442   6605]]
testing model out of sample: results/universal/W1/deepOF_L1/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 123s - 123s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89967775
{'0': {'precision': 0.37865145989190085, 'recall': 0.048605028400459806, 'f1-score': 0.08615136559062747, 'support': 1125686}, '1': {'precision': 0.639326478928656, 'recall': 0.9556341331670964, 'f1-score': 0.7661157283363427, 'support': 3856343}, '2': {'precision': 0.3988235294117647, 'recall': 0.06797345368807188, 'f1-score': 0.11615076226996915, 'support': 1117142}, 'accuracy': 0.6256428947474993, 'macro avg': {'precision': 0.4722671560774406, 'recall': 0.35740420508520937, 'f1-score': 0.3228059520656464, 'support': 6099171}, 'weighted avg': {'precision': 0.5471640907108789, 'recall': 0.6256428947474993, 'f1-score': 0.5215694570868411, 'support': 6099171}}
[[  54714 1055583   15389]
 [  72015 3685253   99075]
 [  17768 1023438   75936]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87003255
{'0': {'precision': 0.41269392372333547, 'recall': 0.03388059701492537, 'f1-score': 0.06262030577590329, 'support': 301500}, '1': {'precision': 0.6545259507576943, 'recall': 0.9758066252157159, 'f1-score': 0.7835097801976205, 'support': 1114892}, '2': {'precision': 0.3977744123263317, 'recall': 0.04015527681948405, 'f1-score': 0.0729466032313377, 'support': 300882}, 'accuracy': 0.6464990444157426, 'macro avg': {'precision': 0.4883314289357871, 'recall': 0.3499474996833751, 'f1-score': 0.3063588964016205, 'support': 1717274}, 'weighted avg': {'precision': 0.567082553526289, 'recall': 0.6464990444157426, 'f1-score': 0.5324468476952261, 'support': 1717274}}
[[  10215  288294    2991]
 [  11672 1087919   15301]
 [   2865  285935   12082]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85051054
{'0': {'precision': 0.4299078091106291, 'recall': 0.04284093058445243, 'f1-score': 0.07791729120082562, 'support': 74018}, '1': {'precision': 0.6710095639917131, 'recall': 0.9713451353488738, 'f1-score': 0.7937163342578955, 'support': 292097}, '2': {'precision': 0.39423176678078636, 'recall': 0.051535206683302595, 'f1-score': 0.09115442278860571, 'support': 73736}, 'accuracy': 0.6609010778650043, 'macro avg': {'precision': 0.49838304662770955, 'recall': 0.3552404242055429, 'f1-score': 0.3209293494157756, 'support': 439851}, 'weighted avg': {'precision': 0.5840383911446968, 'recall': 0.6609010778650043, 'f1-score': 0.5554853908859405, 'support': 439851}}
[[  3171  69908    939]
 [  3470 283727   4900]
 [   735  69201   3800]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2139127
{'0': {'precision': 0.38362068965517243, 'recall': 0.005159220899675375, 'f1-score': 0.01018151311775473, 'support': 51752}, '1': {'precision': 0.3933504141095156, 'recall': 0.9924233313289237, 'f1-score': 0.5633966289737572, 'support': 66520}, '2': {'precision': 0.4658599827139153, 'recall': 0.010484137635914492, 'f1-score': 0.0205067721807944, 'support': 51411}, 'accuracy': 0.39380491858347627, 'macro avg': {'precision': 0.41427702882620115, 'recall': 0.3360222299548378, 'f1-score': 0.19802830475743546, 'support': 169683}, 'weighted avg': {'precision': 0.4123520626633461, 'recall': 0.39380491858347627, 'f1-score': 0.2301841144415834, 'support': 169683}}
[[  267 51189   296]
 [  182 66016   322]
 [  247 50625   539]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0689598
{'0': {'precision': 0.3686440677966102, 'recall': 0.010914565299209636, 'f1-score': 0.02120141342756184, 'support': 15942}, '1': {'precision': 0.5089062022609226, 'recall': 0.9861460584352151, 'f1-score': 0.671355588919902, 'support': 33781}, '2': {'precision': 0.350253807106599, 'recall': 0.012321428571428572, 'f1-score': 0.023805416594790407, 'support': 16800}, 'accuracy': 0.5065015107556785, 'macro avg': {'precision': 0.40926802572137727, 'recall': 0.33646068410195107, 'f1-score': 0.23878747298075143, 'support': 66523}, 'weighted avg': {'precision': 0.43522613392030796, 'recall': 0.5065015107556785, 'f1-score': 0.35201339508076723, 'support': 66523}}
[[  174 15655   113]
 [  197 33313   271]
 [  101 16492   207]]
Evaluating performance on  val set...
51/51 - 0s - 415ms/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0668545
{'0': {'precision': 0.38461538461538464, 'recall': 0.009554140127388535, 'f1-score': 0.018645121193287758, 'support': 3140}, '1': {'precision': 0.5146489773355445, 'recall': 0.9881728582259287, 'f1-score': 0.6768096375532245, 'support': 6595}, '2': {'precision': 0.330188679245283, 'recall': 0.011246786632390746, 'f1-score': 0.02175264139216905, 'support': 3112}, 'accuracy': 0.5123375107028878, 'macro avg': {'precision': 0.4098176803987374, 'recall': 0.336324594995236, 'f1-score': 0.23906913337956046, 'support': 12847}, 'weighted avg': {'precision': 0.43818397159115313, 'recall': 0.5123375107028878, 'f1-score': 0.35726624583349187, 'support': 12847}}
[[  30 3084   26]
 [  33 6517   45]
 [  15 3062   35]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65142566
{'0': {'precision': 0.34823865852073316, 'recall': 0.07843883586109973, 'f1-score': 0.12803785217578323, 'support': 34154}, '1': {'precision': 0.8512006691280549, 'recall': 0.9749749153925954, 'f1-score': 0.908893216402392, 'support': 352806}, '2': {'precision': 0.3811386353759235, 'recall': 0.10304009399324424, 'f1-score': 0.16222340400934127, 'support': 34045}, 'accuracy': 0.8317335898623531, 'macro avg': {'precision': 0.5268593210082372, 'recall': 0.3854846150823132, 'f1-score': 0.39971815752917217, 'support': 421005}, 'weighted avg': {'precision': 0.7723858653861189, 'recall': 0.8317335898623531, 'f1-score': 0.7851661635818388, 'support': 421005}}
[[  2679  30792    683]
 [  3816 343977   5013]
 [  1198  29339   3508]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7564124
{'0': {'precision': 0.3960742134982522, 'recall': 0.06811245722741145, 'f1-score': 0.11623594397317025, 'support': 21626}, '1': {'precision': 0.7543813578926966, 'recall': 0.9712227320293005, 'f1-score': 0.8491777780123799, 'support': 124230}, '2': {'precision': 0.38374233128834356, 'recall': 0.05939606874940651, 'f1-score': 0.10286982978373489, 'support': 21062}, 'accuracy': 0.7391593477036629, 'macro avg': {'precision': 0.5113993008930975, 'recall': 0.3662437526687062, 'f1-score': 0.3560945172564283, 'support': 166918}, 'weighted avg': {'precision': 0.661190992066272, 'recall': 0.7391593477036629, 'f1-score': 0.6600469586368563, 'support': 166918}}
[[  1473  19780    373]
 [  1939 120655   1636]
 [   307  19504   1251]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7123476
{'0': {'precision': 0.3435643564356436, 'recall': 0.068401340429726, 'f1-score': 0.11408844320236723, 'support': 5073}, '1': {'precision': 0.7974392272116283, 'recall': 0.9640034151312347, 'f1-score': 0.8728460636891848, 'support': 36309}, '2': {'precision': 0.36265320836337417, 'recall': 0.10248573757131214, 'f1-score': 0.15980937251787133, 'support': 4908}, 'accuracy': 0.7745085331605098, 'macro avg': {'precision': 0.5012189306702154, 'recall': 0.3782968310440909, 'f1-score': 0.38224795980314114, 'support': 46290}, 'weighted avg': {'precision': 0.7015991537626372, 'recall': 0.7745085331605098, 'f1-score': 0.7140912248687391, 'support': 46290}}
[[  347  4584   142]
 [  565 35002   742]
 [   98  4307   503]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1989919
{'0': {'precision': 0.5725381662351576, 'recall': 0.059296175752644426, 'f1-score': 0.1074627365881042, 'support': 108152}, '1': {'precision': 0.3460337707479631, 'recall': 0.9317128039565874, 'f1-score': 0.5046448195438195, 'support': 116464}, '2': {'precision': 0.46949625239672305, 'recall': 0.04825158539643868, 'f1-score': 0.08750954368979354, 'support': 111644}, 'accuracy': 0.3577915898411943, 'macro avg': {'precision': 0.4626893964599479, 'recall': 0.34642018836855687, 'f1-score': 0.23320569994057241, 'support': 336260}, 'weighted avg': {'precision': 0.4598764778255971, 'recall': 0.3577915898411943, 'f1-score': 0.23840236616466828, 'support': 336260}}
[[  6413 100198   1541]
 [  3407 108511   4546]
 [  1381 104876   5387]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0787238
{'0': {'precision': 0.4944473823373876, 'recall': 0.05257387050521522, 'f1-score': 0.09504205738100684, 'support': 35569}, '1': {'precision': 0.4674830146942645, 'recall': 0.9512281378600823, 'f1-score': 0.6268830646015637, 'support': 62208}, '2': {'precision': 0.46307439824945296, 'recall': 0.04671504649430203, 'f1-score': 0.0848685364814397, 'support': 36241}, 'accuracy': 0.4681236848781507, 'macro avg': {'precision': 0.47500159842703504, 'recall': 0.3501723516198665, 'f1-score': 0.2689312194880034, 'support': 134018}, 'weighted avg': {'precision': 0.47344730996894274, 'recall': 0.4681236848781507, 'f1-score': 0.3391590178359845, 'support': 134018}}
[[ 1870 33249   450]
 [ 1521 59174  1513]
 [  391 34157  1693]]
Evaluating performance on  val set...
107/107 - 1s - 664ms/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.187253
{'0': {'precision': 0.5633187772925764, 'recall': 0.044657281329333026, 'f1-score': 0.08275419651448734, 'support': 8666}, '1': {'precision': 0.3641009636016073, 'recall': 0.9432989690721649, 'f1-score': 0.5254032144566105, 'support': 9894}, '2': {'precision': 0.48823529411764705, 'recall': 0.04819976771196283, 'f1-score': 0.08773784355179703, 'support': 8610}, 'accuracy': 0.3730217151269783, 'macro avg': {'precision': 0.4718850116706103, 'recall': 0.3453853393711536, 'f1-score': 0.23196508484096498, 'support': 27170}, 'weighted avg': {'precision': 0.46697980641312886, 'recall': 0.3730217151269783, 'f1-score': 0.2455248473982048, 'support': 27170}}
[[ 387 8172  107]
 [ 233 9333  328]
 [  67 8128  415]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2523143
{'0': {'precision': 0.5229960578186597, 'recall': 0.017005494740260294, 'f1-score': 0.032939930147484815, 'support': 117021}, '1': {'precision': 0.3133139524072226, 'recall': 0.9744182908256704, 'f1-score': 0.4741651031894934, 'support': 103746}, '2': {'precision': 0.5314003023223856, 'recall': 0.03423062964176013, 'f1-score': 0.06431814779701613, 'support': 112969}, 'accuracy': 0.32045988445957285, 'macro avg': {'precision': 0.4559034375160893, 'recall': 0.34188480506923025, 'f1-score': 0.19047439371133146, 'support': 333736}, 'weighted avg': {'precision': 0.4606585796602544, 'recall': 0.32045988445957285, 'f1-score': 0.18072174772804586, 'support': 333736}}
[[  1990 113315   1716]
 [   960 101092   1694]
 [   855 108247   3867]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2396187
{'0': {'precision': 0.5355884425651868, 'recall': 0.022410945977824958, 'f1-score': 0.04302170898078174, 'support': 33912}, '1': {'precision': 0.33286640561162223, 'recall': 0.9699734059001793, 'f1-score': 0.4956427617700737, 'support': 32338}, '2': {'precision': 0.47705360586193596, 'recall': 0.038662290982966085, 'f1-score': 0.0715276974673297, 'support': 31995}, 'accuracy': 0.3395999796427299, 'macro avg': {'precision': 0.44850281801291497, 'recall': 0.34368221428699014, 'f1-score': 0.2033973894060617, 'support': 98245}, 'weighted avg': {'precision': 0.4497983531832856, 'recall': 0.3395999796427299, 'f1-score': 0.20128837605521024, 'support': 98245}}
[[  760 32460   692]
 [  307 31367   664]
 [  352 30406  1237]]
Evaluating performance on  val set...
93/93 - 1s - 678ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2512028
{'0': {'precision': 0.5086848635235732, 'recall': 0.025409023301933564, 'f1-score': 0.048400424979341286, 'support': 8068}, '1': {'precision': 0.31418844232214704, 'recall': 0.9695729294583163, 'f1-score': 0.4745875909971281, 'support': 7329}, '2': {'precision': 0.5017123287671232, 'recall': 0.03570123065675643, 'f1-score': 0.06665908315322489, 'support': 8207}, 'accuracy': 0.32214878834095917, 'macro avg': {'precision': 0.44152854487094784, 'recall': 0.3435610611390021, 'f1-score': 0.19654903304323143, 'support': 23604}, 'weighted avg': {'precision': 0.4458697532146664, 'recall': 0.32214878834095917, 'f1-score': 0.18707923142644442, 'support': 23604}}
[[ 205 7692  171]
 [ 103 7106  120]
 [  95 7819  293]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2271769
{'0': {'precision': 0.5062550070869538, 'recall': 0.03568822006360019, 'f1-score': 0.06667613578718828, 'support': 230188}, '1': {'precision': 0.3228392237599603, 'recall': 0.941070237830629, 'f1-score': 0.4807533993811565, 'support': 215952}, '2': {'precision': 0.47752965159377314, 'recall': 0.04660279336429033, 'f1-score': 0.08491829075884343, 'support': 221167}, 'accuracy': 0.3323028231383756, 'macro avg': {'precision': 0.43554129414689574, 'recall': 0.3411204170861732, 'f1-score': 0.21078260864239606, 'support': 667307}, 'weighted avg': {'precision': 0.4373780045388146, 'recall': 0.3323028231383756, 'f1-score': 0.20672468303195068, 'support': 667307}}
[[  8215 218382   3591]
 [  5040 203226   7686]
 [  2972 207888  10307]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1391004
{'0': {'precision': 0.5062308478038815, 'recall': 0.04532153047040749, 'f1-score': 0.08319484312836782, 'support': 54676}, '1': {'precision': 0.41176300928142506, 'recall': 0.9446436842453517, 'f1-score': 0.5735290572950563, 'support': 75565}, '2': {'precision': 0.46802551734868525, 'recall': 0.055255520041147727, 'f1-score': 0.09884169884169883, 'support': 54438}, 'accuracy': 0.4162249091667163, 'macro avg': {'precision': 0.46200645814466396, 'recall': 0.34840691158563564, 'f1-score': 0.25185519975504095, 'support': 184679}, 'weighted avg': {'precision': 0.4563156760882593, 'recall': 0.4162249091667163, 'f1-score': 0.2884368491216217, 'support': 184679}}
[[ 2478 51235   963]
 [ 1727 71382  2456]
 [  690 50740  3008]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.191658
{'0': {'precision': 0.4852374839537869, 'recall': 0.040264167021729864, 'f1-score': 0.07435821776335201, 'support': 18776}, '1': {'precision': 0.3555408364151533, 'recall': 0.9398375565390789, 'f1-score': 0.515912003417343, 'support': 20561}, '2': {'precision': 0.49499545040946313, 'recall': 0.05796483750665956, 'f1-score': 0.10377718428080883, 'support': 18770}, 'accuracy': 0.36429345861944346, 'macro avg': {'precision': 0.44525792359280114, 'recall': 0.3460221870224894, 'f1-score': 0.23134913515383462, 'support': 58107}, 'weighted avg': {'precision': 0.4424967515176122, 'recall': 0.36429345861944346, 'f1-score': 0.2401038488984024, 'support': 58107}}
[[  756 17644   376]
 [  503 19324   734]
 [  299 17383  1088]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/EXC
Evaluating performance on  test set...
5343/5343 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75027186
{'0': {'precision': 0.330381191508788, 'recall': 0.09347593030314773, 'f1-score': 0.1457221674083322, 'support': 154842}, '1': {'precision': 0.7828311675384356, 'recall': 0.9383766021619421, 'f1-score': 0.8535755694259484, 'support': 1055995}, '2': {'precision': 0.30489880839795724, 'recall': 0.11298081517964663, 'f1-score': 0.16486908658137456, 'support': 156947}, 'accuracy': 0.748017961900417, 'macro avg': {'precision': 0.472703722481727, 'recall': 0.38161111588157876, 'f1-score': 0.38805560780521836, 'support': 1367784}, 'weighted avg': {'precision': 0.676770335449156, 'recall': 0.748017961900417, 'f1-score': 0.6944160436249308, 'support': 1367784}}
[[ 14474 138051   2317]
 [ 26966 990921  38108]
 [  2370 136845  17732]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7216449
{'0': {'precision': 0.32710196779964223, 'recall': 0.1148014440433213, 'f1-score': 0.16995468804461483, 'support': 31855}, '1': {'precision': 0.8198618580617948, 'recall': 0.9369285230097161, 'f1-score': 0.8744947240402393, 'support': 265540}, '2': {'precision': 0.3255903738498166, 'recall': 0.1543529985967909, 'f1-score': 0.20942408376963348, 'support': 32782}, 'accuracy': 0.779911986601126, 'macro avg': {'precision': 0.49085139990375115, 'recall': 0.4020276552166094, 'f1-score': 0.4179578319514959, 'support': 330177}, 'weighted avg': {'precision': 0.7232467876609554, 'recall': 0.779911986601126, 'f1-score': 0.7404894221082707, 'support': 330177}}
[[  3657  27526    672]
 [  6939 248792   9809]
 [   584  27138   5060]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71307886
{'0': {'precision': 0.3234492160872529, 'recall': 0.10554999443888333, 'f1-score': 0.15916142557651994, 'support': 8991}, '1': {'precision': 0.8200642129263412, 'recall': 0.9414907114334174, 'f1-score': 0.8765924111389508, 'support': 74877}, '2': {'precision': 0.3155093765838824, 'recall': 0.13870320855614973, 'f1-score': 0.1926946293143476, 'support': 8976}, 'accuracy': 0.7829261987850588, 'macro avg': {'precision': 0.48634093519915883, 'recall': 0.39524797147615015, 'f1-score': 0.4094828220099395, 'support': 92844}, 'weighted avg': {'precision': 0.7231925825830756, 'recall': 0.7829261987850588, 'f1-score': 0.740998420349568, 'support': 92844}}
[[  949  7907   135]
 [ 1815 70496  2566]
 [  170  7561  1245]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74213517
{'0': {'precision': 0.3581774089483169, 'recall': 0.07757432660338265, 'f1-score': 0.1275284481358698, 'support': 207530}, '1': {'precision': 0.7876640017168908, 'recall': 0.9593301250499757, 'f1-score': 0.8650627883481908, 'support': 1423191}, '2': {'precision': 0.360092562658454, 'recall': 0.10255229861942305, 'f1-score': 0.1596400310786244, 'support': 206363}, 'accuracy': 0.7634773369100161, 'macro avg': {'precision': 0.5019779911078873, 'recall': 0.37981891675759377, 'f1-score': 0.3840770891875617, 'support': 1837084}, 'weighted avg': {'precision': 0.6911162785449083, 'recall': 0.7634773369100161, 'f1-score': 0.7025042672992444, 'support': 1837084}}
[[  16099  187645    3786]
 [  24059 1365310   33822]
 [   4789  180411   21163]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7382066
{'0': {'precision': 0.3593829033889732, 'recall': 0.04218056606853971, 'f1-score': 0.07549976754997675, 'support': 67377}, '1': {'precision': 0.7727884414864511, 'recall': 0.9791485527293422, 'f1-score': 0.8638149505897353, 'support': 442799}, '2': {'precision': 0.34202898550724636, 'recall': 0.043769844802516396, 'f1-score': 0.07760809228786025, 'support': 67398}, 'accuracy': 0.7606955991786334, 'macro avg': {'precision': 0.4914001101275569, 'recall': 0.35503298786679943, 'f1-score': 0.33897427014252407, 'support': 577574}, 'weighted avg': {'precision': 0.6742965586203937, 'recall': 0.7606955991786334, 'f1-score': 0.6801102098578126, 'support': 577574}}
[[  2842  63938    597]
 [  4155 433566   5078]
 [   911  63537   2950]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7278924
{'0': {'precision': 0.37015009912206176, 'recall': 0.07345172530066314, 'f1-score': 0.12257913247362251, 'support': 17794}, '1': {'precision': 0.7895879639741498, 'recall': 0.96465122119671, 'f1-score': 0.868384425714104, 'support': 127416}, '2': {'precision': 0.32348668280871673, 'recall': 0.07374289341502456, 'f1-score': 0.12010608171888344, 'support': 18117}, 'accuracy': 0.7687338896814366, 'macro avg': {'precision': 0.4944082486349761, 'recall': 0.3706152799707993, 'f1-score': 0.3703565466355367, 'support': 163327}, 'weighted avg': {'precision': 0.6921892835474462, 'recall': 0.7687338896814366, 'f1-score': 0.7041285577554534, 'support': 163327}}
[[  1307  16213    274]
 [  1984 122912   2520]
 [   240  16541   1336]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/WBA
Evaluating performance on  test set...
5696/5696 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9904313
{'0': {'precision': 0.4922721504571633, 'recall': 0.04461542091076916, 'f1-score': 0.08181574827421173, 'support': 339098}, '1': {'precision': 0.5484660379178053, 'recall': 0.9591651185939908, 'f1-score': 0.6978755911643192, 'support': 788615}, '2': {'precision': 0.47876207290476686, 'recall': 0.0697837762559566, 'f1-score': 0.12181233501827185, 'support': 330306}, 'accuracy': 0.5449798665175145, 'macro avg': {'precision': 0.5065000870932451, 'recall': 0.3578547719202388, 'f1-score': 0.30050122481893426, 'support': 1458019}, 'weighted avg': {'precision': 0.5196057331359573, 'recall': 0.5449798665175145, 'f1-score': 0.42409190899767674, 'support': 1458019}}
[[ 15129 319344   4625]
 [ 11733 756412  20470]
 [  3871 303385  23050]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89046896
{'0': {'precision': 0.4788233355306526, 'recall': 0.05450657061654051, 'f1-score': 0.09787194623864182, 'support': 106611}, '1': {'precision': 0.6370898531424555, 'recall': 0.965037766720459, 'f1-score': 0.7674991198634562, 'support': 356928}, '2': {'precision': 0.4211856908102642, 'recall': 0.06341895145557153, 'f1-score': 0.11023895583990208, 'support': 105079}, 'accuracy': 0.6277043639139106, 'macro avg': {'precision': 0.5123662931611241, 'recall': 0.36098776293085705, 'f1-score': 0.32520334064733336, 'support': 568618}, 'weighted avg': {'precision': 0.5675177587261404, 'recall': 0.6277043639139106, 'f1-score': 0.520489944313709, 'support': 568618}}
[[  5811  99055   1745]
 [  5066 344449   7413]
 [  1259  97156   6664]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8775612
{'0': {'precision': 0.4984025559105431, 'recall': 0.051072188574234734, 'f1-score': 0.09265033407572382, 'support': 30545}, '1': {'precision': 0.6440072356772581, 'recall': 0.9686112019073622, 'f1-score': 0.7736394525176128, 'support': 104018}, '2': {'precision': 0.4354649800890138, 'recall': 0.0634839326571731, 'f1-score': 0.11081306628516928, 'support': 29283}, 'accuracy': 0.6357921462837054, 'macro avg': {'precision': 0.5259582572256051, 'recall': 0.36105577437958997, 'f1-score': 0.32570095095950197, 'support': 163846}, 'weighted avg': {'precision': 0.5795916392399642, 'recall': 0.6357921462837054, 'f1-score': 0.5282238934508541, 'support': 163846}}
[[  1560  28545    440]
 [  1295 100753   1970]
 [   275  27149   1859]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87277657
{'0': {'precision': 0.332572277005827, 'recall': 0.04496235304811538, 'f1-score': 0.07921515507393369, 'support': 528064}, '1': {'precision': 0.6651275197752127, 'recall': 0.9548990864293664, 'f1-score': 0.7840978148875857, 'support': 2034216}, '2': {'precision': 0.39644933811703575, 'recall': 0.07302913074937756, 'f1-score': 0.12333835295476087, 'support': 526557}, 'accuracy': 0.6490041397458007, 'macro avg': {'precision': 0.46471637829935847, 'recall': 0.35763019007561975, 'f1-score': 0.32888377430542676, 'support': 3088837}, 'weighted avg': {'precision': 0.5624724334054374, 'recall': 0.6490041397458007, 'f1-score': 0.5509515929053966, 'support': 3088837}}
[[  23743  498156    6165]
 [  39368 1942471   52377]
 [   8281  479822   38454]]
Evaluating performance on  train set...
2948/2948 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8505398
{'0': {'precision': 0.36488267861850776, 'recall': 0.021635817908954476, 'f1-score': 0.04084945617685689, 'support': 127936}, '1': {'precision': 0.6666336004000565, 'recall': 0.9800894635582842, 'f1-score': 0.7935281676756157, 'support': 500539}, '2': {'precision': 0.3817057646844881, 'recall': 0.0333161382484822, 'f1-score': 0.06128332956212638, 'support': 126005}, 'accuracy': 0.6594462411197116, 'macro avg': {'precision': 0.4710740145676841, 'recall': 0.3450138065719069, 'f1-score': 0.29855365113819965, 'support': 754480}, 'weighted avg': {'precision': 0.5678806342930895, 'recall': 0.6594462411197116, 'f1-score': 0.5436060829804675, 'support': 754480}}
[[  2768 124262    906]
 [  4072 490573   5894]
 [   746 121061   4198]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.78519845
{'0': {'precision': 0.4275730622617535, 'recall': 0.026246002651899226, 'f1-score': 0.04945620223398001, 'support': 25642}, '1': {'precision': 0.7200905521964639, 'recall': 0.9844395170452319, 'f1-score': 0.8317666062042394, 'support': 127631}, '2': {'precision': 0.40153780435711234, 'recall': 0.037409957416325065, 'f1-score': 0.06844327945245376, 'support': 25127}, 'accuracy': 0.713329596412556, 'macro avg': {'precision': 0.5164004729384432, 'recall': 0.3493651590378188, 'f1-score': 0.3165553626302244, 'support': 178400}, 'weighted avg': {'precision': 0.6331790702913898, 'recall': 0.713329596412556, 'f1-score': 0.6118112888841861, 'support': 178400}}
[[   673  24798    171]
 [   756 125645   1230]
 [   145  24042    940]]
testing model on single stock: results/universal/W1/deepOF_L1/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 106s - 106s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.24484
{'0': {'precision': 0.4979089130184553, 'recall': 0.01437531570971544, 'f1-score': 0.02794385389177975, 'support': 1805456}, '1': {'precision': 0.33668398975871583, 'recall': 0.9828541870848306, 'f1-score': 0.5015561881663014, 'support': 1836600}, '2': {'precision': 0.47451993390187847, 'recall': 0.013695648837051218, 'f1-score': 0.02662290435074502, 'support': 1824156}, 'accuracy': 0.3395490332244706, 'macro avg': {'precision': 0.4363709455596832, 'recall': 0.3369750505438658, 'f1-score': 0.18537431546960872, 'support': 5466212}, 'weighted avg': {'precision': 0.4359334827482396, 'recall': 0.3395490332244706, 'f1-score': 0.18663268540757363, 'support': 5466212}}
[[  25954 1767633   11869]
 [  15693 1805110   15797]
 [  10479 1788694   24983]]
Evaluating performance on  train set...
6073/6073 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0570716
{'0': {'precision': 0.4259172703902781, 'recall': 0.01851579048963979, 'f1-score': 0.03548878622509334, 'support': 393718}, '1': {'precision': 0.49385034646352927, 'recall': 0.9797295354690657, 'f1-score': 0.6566861782849485, 'support': 765202}, '2': {'precision': 0.4187990094923648, 'recall': 0.020519016361122557, 'f1-score': 0.03912128900743825, 'support': 395633}, 'accuracy': 0.49216655848980384, 'macro avg': {'precision': 0.44618887544872404, 'recall': 0.33958811410660933, 'f1-score': 0.24376541783916003, 'support': 1554553}, 'weighted avg': {'precision': 0.45754456567296053, 'recall': 0.49216655848980384, 'f1-score': 0.3421869977188621, 'support': 1554553}}
[[  7290 383609   2819]
 [  7064 749691   8447]
 [  2762 384753   8118]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.100891
{'0': {'precision': 0.45323975844622166, 'recall': 0.021925876798206137, 'f1-score': 0.04182827362348529, 'support': 126654}, '1': {'precision': 0.44640613233525533, 'recall': 0.9778130108522246, 'f1-score': 0.612969887969232, 'support': 203092}, '2': {'precision': 0.44041867954911434, 'recall': 0.02146006936271048, 'f1-score': 0.04092595917878733, 'support': 127446}, 'accuracy': 0.44641638523858684, 'macro avg': {'precision': 0.4466881901101971, 'recall': 0.34039965233771374, 'f1-score': 0.23190804025716819, 'support': 457192}, 'weighted avg': {'precision': 0.44663017206839983, 'recall': 0.44641638523858684, 'f1-score': 0.29528698762982714, 'support': 457192}}
[[  2777 122674   1203]
 [  2234 198586   2272]
 [  1116 123595   2735]]
training model: results/universal/W1/deepOF_L1/h20
Epoch 1/50
10622/10622 - 144s - loss: 3.0619 - accuracy20: 0.4846 - val_loss: 3.8030 - val_accuracy20: 0.4397 - 144s/epoch - 14ms/step
Epoch 2/50
10622/10622 - 141s - loss: 3.0389 - accuracy20: 0.4870 - val_loss: 3.8305 - val_accuracy20: 0.4399 - 141s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 140s - loss: 3.0160 - accuracy20: 0.4914 - val_loss: 3.8276 - val_accuracy20: 0.4425 - 140s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 142s - loss: 2.9986 - accuracy20: 0.4941 - val_loss: 3.8274 - val_accuracy20: 0.4442 - 142s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 141s - loss: 2.9847 - accuracy20: 0.4962 - val_loss: 3.8138 - val_accuracy20: 0.4456 - 141s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 140s - loss: 2.9747 - accuracy20: 0.4978 - val_loss: 3.8390 - val_accuracy20: 0.4450 - 140s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 143s - loss: 2.9666 - accuracy20: 0.4995 - val_loss: 3.8187 - val_accuracy20: 0.4457 - 143s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 141s - loss: 2.9591 - accuracy20: 0.5009 - val_loss: 3.8567 - val_accuracy20: 0.4459 - 141s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 142s - loss: 2.9526 - accuracy20: 0.5027 - val_loss: 3.8418 - val_accuracy20: 0.4462 - 142s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 142s - loss: 2.9463 - accuracy20: 0.5041 - val_loss: 3.8455 - val_accuracy20: 0.4470 - 142s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 142s - loss: 2.9409 - accuracy20: 0.5055 - val_loss: 3.8315 - val_accuracy20: 0.4477 - 142s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 174s - 174s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2313334
{'0': {'precision': 0.5250326024061007, 'recall': 0.02073500410313851, 'f1-score': 0.03989446436663034, 'support': 2931902}, '1': {'precision': 0.3520856791348375, 'recall': 0.9696472557212564, 'f1-score': 0.5165928812828144, 'support': 3175133}, '2': {'precision': 0.5006028260485155, 'recall': 0.03177954642634454, 'f1-score': 0.059765054494997666, 'support': 2939721}, 'accuracy': 0.35736290444884333, 'macro avg': {'precision': 0.45924036919648453, 'recall': 0.34072060208357985, 'f1-score': 0.20541746671481417, 'support': 9046756}, 'weighted avg': {'precision': 0.45639515823155324, 'recall': 0.35736290444884333, 'f1-score': 0.21365784050732528, 'support': 9046756}}
[[  60793 2839374   31735]
 [  34911 3078759   61463]
 [  20085 2826213   93423]]
Evaluating performance on  train set...
10622/10622 - 56s - 56s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0967486
{'0': {'precision': 0.5196250879485376, 'recall': 0.02810551767348997, 'f1-score': 0.053326697259654, 'support': 735763}, '1': {'precision': 0.462526131306594, 'recall': 0.9714542112556779, 'f1-score': 0.6266793828857178, 'support': 1246944}, '2': {'precision': 0.4800602712204922, 'recall': 0.03896961690885073, 'f1-score': 0.07208742806718506, 'support': 735804}, 'accuracy': 0.4637472498731843, 'macro avg': {'precision': 0.4874038301585413, 'recall': 0.3461764486126729, 'f1-score': 0.2506978360708523, 'support': 2718511}, 'weighted avg': {'precision': 0.4827257883692111, 'recall': 0.4637472498731843, 'f1-score': 0.32139363242983027, 'support': 2718511}}
[[  20679  706108    8976]
 [  13515 1211349   22080]
 [   5602  701528   28674]]
Evaluating performance on  val set...
3064/3064 - 18s - 18s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1189344
{'0': {'precision': 0.5236293306424487, 'recall': 0.028011569898470992, 'f1-score': 0.053178361436934496, 'support': 222301}, '1': {'precision': 0.43729291327516234, 'recall': 0.9717730529888742, 'f1-score': 0.6031647624142172, 'support': 339392}, '2': {'precision': 0.48950257484013354, 'recall': 0.038949401800227844, 'f1-score': 0.0721572945602576, 'support': 222083}, 'accuracy': 0.4397799881598824, 'macro avg': {'precision': 0.48347493958591486, 'recall': 0.34624467489585764, 'f1-score': 0.24283347280380307, 'support': 783776}, 'weighted avg': {'precision': 0.47657397085602554, 'recall': 0.4397799881598824, 'f1-score': 0.29671207898545465, 'support': 783776}}
[[  6227 212922   3152]
 [  3711 329812   5869]
 [  1954 211479   8650]]
testing model out of sample: results/universal/W1/deepOF_L1/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 123s - 123s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.006552
{'0': {'precision': 0.46232582074311124, 'recall': 0.04057302813417981, 'f1-score': 0.07459932976201751, 'support': 1417173}, '1': {'precision': 0.5436161384137522, 'recall': 0.9567341318879613, 'f1-score': 0.6932995908495129, 'support': 3274082}, '2': {'precision': 0.46865945437441203, 'recall': 0.07076913679509289, 'f1-score': 0.12296947392065244, 'support': 1407916}, 'accuracy': 0.5393457569889416, 'macro avg': {'precision': 0.49153380451042517, 'recall': 0.3560254322724113, 'f1-score': 0.29695613151072764, 'support': 6099171}, 'weighted avg': {'precision': 0.5074251284994233, 'recall': 0.5393457569889416, 'f1-score': 0.4178880304895619, 'support': 6099171}}
[[  57499 1339164   20510]
 [  49203 3132426   92453]
 [  17667 1290612   99637]]
Evaluating performance on  train set...
6711/6711 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98358184
{'0': {'precision': 0.5086892616289124, 'recall': 0.03046030866722236, 'f1-score': 0.057478787997205925, 'support': 386306}, '1': {'precision': 0.5564203553712684, 'recall': 0.9765926217321143, 'f1-score': 0.7089255234667154, 'support': 945642}, '2': {'precision': 0.47784267573300787, 'recall': 0.04267555264892584, 'f1-score': 0.0783534529791132, 'support': 385326}, 'accuracy': 0.5542027655458593, 'macro avg': {'precision': 0.5143174309110629, 'recall': 0.34990949434942076, 'f1-score': 0.2815859214810115, 'support': 1717274}, 'weighted avg': {'precision': 0.5280516553947201, 'recall': 0.5542027655458593, 'f1-score': 0.4208913505711902, 'support': 1717274}}
[[ 11767 370453   4086]
 [  8252 923507  13883]
 [  3113 365769  16444]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95444864
{'0': {'precision': 0.5273805902038333, 'recall': 0.03677227071688428, 'f1-score': 0.06875080559604192, 'support': 94283}, '1': {'precision': 0.5809085194969683, 'recall': 0.9750019830253034, 'f1-score': 0.7280456781385211, 'support': 252140}, '2': {'precision': 0.48041257562233464, 'recall': 0.051847411910776214, 'f1-score': 0.09359391755465603, 'support': 93428}, 'accuracy': 0.5778047566107614, 'macro avg': {'precision': 0.5295672284410454, 'recall': 0.3545405552176546, 'f1-score': 0.2967968004297397, 'support': 439851}, 'weighted avg': {'precision': 0.5480885218116979, 'recall': 0.5778047566107614, 'f1-score': 0.4519616006764898, 'support': 439851}}
[[  3467  89575   1241]
 [  2305 245837   3998]
 [   802  87782   4844]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/LILAK
Evaluating performance on  test set...
663/663 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3595496
{'0': {'precision': 0.4032258064516129, 'recall': 0.004143394600328157, 'f1-score': 0.008202503404038913, 'support': 60337}, '1': {'precision': 0.29190457194910663, 'recall': 0.9924897265126824, 'f1-score': 0.4511267126123722, 'support': 49399}, '2': {'precision': 0.49094202898550726, 'recall': 0.009041319832518725, 'f1-score': 0.0177556469181504, 'support': 59947}, 'accuracy': 0.29360631294826234, 'macro avg': {'precision': 0.39535746912874226, 'recall': 0.3352248136485098, 'f1-score': 0.15902828764485383, 'support': 169683}, 'weighted avg': {'precision': 0.40180649355079234, 'recall': 0.29360631294826234, 'f1-score': 0.14052392219627444, 'support': 169683}}
[[  250 59748   339]
 [  148 49028   223]
 [  222 59183   542]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2173933
{'0': {'precision': 0.4238178633975482, 'recall': 0.012367130008176614, 'f1-score': 0.024032970852574605, 'support': 19568}, '1': {'precision': 0.39560137036583876, 'recall': 0.9860475754803294, 'f1-score': 0.5646611945511701, 'support': 26232}, '2': {'precision': 0.477112676056338, 'recall': 0.013077257153886985, 'f1-score': 0.025456765769573998, 'support': 20723}, 'accuracy': 0.39653954271454983, 'macro avg': {'precision': 0.43217730327324166, 'recall': 0.33716398754746435, 'f1-score': 0.20471697705777292, 'support': 66523}, 'weighted avg': {'precision': 0.42929346367895915, 'recall': 0.39653954271454983, 'f1-score': 0.23766231508128552, 'support': 66523}}
[[  242 19212   114]
 [  183 25866   183]
 [  146 20306   271]]
Evaluating performance on  val set...
51/51 - 0s - 416ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2126168
{'0': {'precision': 0.38738738738738737, 'recall': 0.011102504518461141, 'f1-score': 0.021586345381526102, 'support': 3873}, '1': {'precision': 0.4049103970948133, 'recall': 0.9876757173117658, 'f1-score': 0.5743561030235163, 'support': 5193}, '2': {'precision': 0.391304347826087, 'recall': 0.007140967997884158, 'f1-score': 0.014025974025974027, 'support': 3781}, 'accuracy': 0.40468591889157, 'macro avg': {'precision': 0.39453404410276255, 'recall': 0.3353063966093704, 'f1-score': 0.20332280747700548, 'support': 12847}, 'weighted avg': {'precision': 0.3956233192648207, 'recall': 0.40468591889157, 'f1-score': 0.2428012272480718, 'support': 12847}}
[[  43 3808   22]
 [  44 5129   20]
 [  24 3730   27]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70951295
{'0': {'precision': 0.4395836078534721, 'recall': 0.0712881442858364, 'f1-score': 0.12268088627378873, 'support': 46796}, '1': {'precision': 0.7941164066318189, 'recall': 0.9758758090429894, 'f1-score': 0.8756637277081868, 'support': 328011}, '2': {'precision': 0.477200116177752, 'recall': 0.10669293042988874, 'f1-score': 0.17439453712385233, 'support': 46198}, 'accuracy': 0.7799503568841225, 'macro avg': {'precision': 0.5703000435543476, 'recall': 0.3846189612529048, 'f1-score': 0.3909130503686093, 'support': 421005}, 'weighted avg': {'precision': 0.7199329274854228, 'recall': 0.7799503568841225, 'f1-score': 0.71501523395068, 'support': 421005}}
[[  3336  42837    623]
 [  3136 320098   4777]
 [  1117  40152   4929]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8375921
{'0': {'precision': 0.5132900177200236, 'recall': 0.061402579049637876, 'f1-score': 0.10968413745227353, 'support': 28305}, '1': {'precision': 0.6756675630041898, 'recall': 0.9743353893878729, 'f1-score': 0.797970472891633, 'support': 110892}, '2': {'precision': 0.47432357813362785, 'recall': 0.06197467623823094, 'f1-score': 0.10962575375681968, 'support': 27721}, 'accuracy': 0.6680046489893241, 'macro avg': {'precision': 0.5544270529526137, 'recall': 0.3659042148919139, 'f1-score': 0.33909345470024205, 'support': 166918}, 'weighted avg': {'precision': 0.6146941927034124, 'recall': 0.6680046489893241, 'f1-score': 0.566937578394052, 'support': 166918}}
[[  1738  26177    390]
 [  1332 108046   1514]
 [   316  25687   1718]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78596723
{'0': {'precision': 0.4984520123839009, 'recall': 0.06987847222222222, 'f1-score': 0.12257327750285497, 'support': 6912}, '1': {'precision': 0.723035588241991, 'recall': 0.970121895334983, 'f1-score': 0.8285498095287794, 'support': 32733}, '2': {'precision': 0.4764621968616263, 'recall': 0.10052671181339352, 'f1-score': 0.16602460544302222, 'support': 6645}, 'accuracy': 0.7108662778137826, 'macro avg': {'precision': 0.5659832658291727, 'recall': 0.38017569312353294, 'f1-score': 0.37238256415821885, 'support': 46290}, 'weighted avg': {'precision': 0.6541048934471403, 'recall': 0.7108662778137826, 'f1-score': 0.6280272394161623, 'support': 46290}}
[[  483  6287   142]
 [  386 31755   592]
 [  100  5877   668]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3415718
{'0': {'precision': 0.6426267041315433, 'recall': 0.04827198036288022, 'f1-score': 0.08979858939867665, 'support': 127921}, '1': {'precision': 0.2268807508398052, 'recall': 0.9350073275410866, 'f1-score': 0.36515593620489656, 'support': 76424}, '2': {'precision': 0.542788749251945, 'recall': 0.04812947731493765, 'f1-score': 0.08841879508676155, 'support': 131915}, 'accuracy': 0.2497501933028014, 'macro avg': {'precision': 0.47076540140776446, 'recall': 0.3438029284063015, 'f1-score': 0.18112444023011157, 'support': 336260}, 'weighted avg': {'precision': 0.5089709242222172, 'recall': 0.2497501933028014, 'f1-score': 0.15183955265824445, 'support': 336260}}
[[  6175 119487   2259]
 [  1878  71457   3089]
 [  1556 124010   6349]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2027042
{'0': {'precision': 0.5936794582392777, 'recall': 0.0430260820790876, 'f1-score': 0.0802370938569156, 'support': 42788}, '1': {'precision': 0.35788488608928837, 'recall': 0.958265776673475, 'f1-score': 0.5211391796257702, 'support': 47491}, '2': {'precision': 0.5295527156549521, 'recall': 0.04547429067879924, 'f1-score': 0.08375618486156437, 'support': 43739}, 'accuracy': 0.3681520392783059, 'macro avg': {'precision': 0.4937056866611727, 'recall': 0.34892204981045394, 'f1-score': 0.22837748611475003, 'support': 134018}, 'weighted avg': {'precision': 0.4891937949711274, 'recall': 0.3681520392783059, 'f1-score': 0.23762492591455717, 'support': 134018}}
[[ 1841 40288   659]
 [  874 45509  1108]
 [  386 41364  1989]]
Evaluating performance on  val set...
107/107 - 1s - 799ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.342067
{'0': {'precision': 0.6307129798903108, 'recall': 0.03339140534262486, 'f1-score': 0.06342494714587739, 'support': 10332}, '1': {'precision': 0.23925001936933446, 'recall': 0.9504462911665128, 'f1-score': 0.3822728398118346, 'support': 6498}, '2': {'precision': 0.5871446229913473, 'recall': 0.045938104448742745, 'f1-score': 0.08520943582384069, 'support': 10340}, 'accuracy': 0.2574898785425101, 'macro avg': {'precision': 0.48570254075033087, 'recall': 0.34325860031929345, 'f1-score': 0.17696907426051756, 'support': 27170}, 'weighted avg': {'precision': 0.5205096995148751, 'recall': 0.2574898785425101, 'f1-score': 0.14797132990162012, 'support': 27170}}
[[ 345 9842  145]
 [ 133 6176  189]
 [  69 9796  475]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2660819
{'0': {'precision': 0.528957528957529, 'recall': 0.011823901542285551, 'f1-score': 0.02313075630819622, 'support': 115867}, '1': {'precision': 0.32216755429488103, 'recall': 0.9810587982069495, 'f1-score': 0.48505052561445067, 'support': 106857}, '2': {'precision': 0.5374978249521489, 'recall': 0.02782582063200375, 'f1-score': 0.052912409321765344, 'support': 111012}, 'accuracy': 0.3274804036723638, 'macro avg': {'precision': 0.46287430273485297, 'recall': 0.3402361734604129, 'f1-score': 0.18703123041480407, 'support': 333736}, 'weighted avg': {'precision': 0.4655874370778042, 'recall': 0.3274804036723638, 'f1-score': 0.1809365718423333, 'support': 333736}}
[[  1370 113195   1302]
 [   668 104833   1356]
 [   552 107371   3089]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2571783
{'0': {'precision': 0.510936132983377, 'recall': 0.01730472916913595, 'f1-score': 0.0334756814078129, 'support': 33748}, '1': {'precision': 0.3335578167583892, 'recall': 0.972630480807585, 'f1-score': 0.4967560960320943, 'support': 32591}, '2': {'precision': 0.45674238762687286, 'recall': 0.029618253620008774, 'f1-score': 0.05562913907284768, 'support': 31906}, 'accuracy': 0.3382156852766044, 'macro avg': {'precision': 0.4337454457895464, 'recall': 0.3398511545322432, 'f1-score': 0.1952869721709183, 'support': 98245}, 'weighted avg': {'precision': 0.4344941527967701, 'recall': 0.3382156852766044, 'f1-score': 0.19435511764660932, 'support': 98245}}
[[  584 32624   540]
 [  308 31699   584]
 [  251 30710   945]]
Evaluating performance on  val set...
93/93 - 1s - 674ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2690808
{'0': {'precision': 0.5162241887905604, 'recall': 0.02168256721595837, 'f1-score': 0.04161712247324613, 'support': 8071}, '1': {'precision': 0.31647182912894434, 'recall': 0.9712705691934178, 'f1-score': 0.47739326438610447, 'support': 7414}, '2': {'precision': 0.49902152641878667, 'recall': 0.03140780884345363, 'f1-score': 0.05909617612977983, 'support': 8119}, 'accuracy': 0.3232926622606338, 'macro avg': {'precision': 0.4439058481127638, 'recall': 0.34145364841761, 'f1-score': 0.19270218766304348, 'support': 23604}, 'weighted avg': {'precision': 0.4475649611034035, 'recall': 0.3232926622606338, 'f1-score': 0.18450632569216366, 'support': 23604}}
[[ 175 7764  132]
 [  89 7201  124]
 [  75 7789  255]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3340654
{'0': {'precision': 0.5096062992125985, 'recall': 0.02549155533148475, 'f1-score': 0.04855432352544001, 'support': 253888}, '1': {'precision': 0.24762355226756524, 'recall': 0.942146963621431, 'f1-score': 0.39217273377415857, 'support': 165592}, '2': {'precision': 0.5118437118437118, 'recall': 0.05074507620235083, 'f1-score': 0.09233581867641713, 'support': 247827}, 'accuracy': 0.2623380243276333, 'macro avg': {'precision': 0.4230245211079586, 'recall': 0.33946119838508887, 'f1-score': 0.17768762532533858, 'support': 667307}, 'weighted avg': {'precision': 0.44542631043383396, 'recall': 0.2623380243276333, 'f1-score': 0.15008284995883125, 'support': 667307}}
[[  6472 241742   5674]
 [  3260 156012   6320]
 [  2968 232283  12576]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2477973
{'0': {'precision': 0.5305443308771096, 'recall': 0.03594723873025076, 'f1-score': 0.0673323478837974, 'support': 62091}, '1': {'precision': 0.32803342457859097, 'recall': 0.9436514646640474, 'f1-score': 0.48683321502185206, 'support': 60321}, '2': {'precision': 0.5066935367784655, 'recall': 0.05653074662341208, 'f1-score': 0.10171352616522669, 'support': 62267}, 'accuracy': 0.33936722637657774, 'macro avg': {'precision': 0.45509043074472205, 'recall': 0.34537648333923676, 'f1-score': 0.21862636302362537, 'support': 184679}, 'weighted avg': {'precision': 0.4563573481937876, 'recall': 0.33936722637657774, 'f1-score': 0.21594439708638327, 'support': 184679}}
[[ 2232 58552  1307]
 [ 1279 56922  2120]
 [  696 58051  3520]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3053157
{'0': {'precision': 0.5027407987470635, 'recall': 0.03008857852556592, 'f1-score': 0.0567789864685593, 'support': 21337}, '1': {'precision': 0.26926040061633283, 'recall': 0.9414443304258594, 'f1-score': 0.41875392251954124, 'support': 15592}, '2': {'precision': 0.5224719101123596, 'recall': 0.05708754367740108, 'f1-score': 0.10292865656393665, 'support': 21178}, 'accuracy': 0.2844751923176209, 'macro avg': {'precision': 0.43149103649191867, 'recall': 0.3428734842096088, 'f1-score': 0.19282052185067908, 'support': 58107}, 'weighted avg': {'precision': 0.4472817165166934, 'recall': 0.2844751923176209, 'f1-score': 0.1707286124376648, 'support': 58107}}
[[  642 20177   518]
 [  326 14679   587]
 [  309 19660  1209]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/EXC
Evaluating performance on  test set...
5343/5343 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8311427
{'0': {'precision': 0.45393937505841303, 'recall': 0.06648112239078362, 'f1-score': 0.11597698130327849, 'support': 219175}, '1': {'precision': 0.6898350660809404, 'recall': 0.9563579213517082, 'f1-score': 0.8015211277282617, 'support': 927064}, '2': {'precision': 0.4226552742699681, 'recall': 0.09623327089304656, 'f1-score': 0.15677162227745342, 'support': 221545}, 'accuracy': 0.6744456727085564, 'macro avg': {'precision': 0.5221432384697738, 'recall': 0.37302410487851273, 'f1-score': 0.35808991043633115, 'support': 1367784}, 'weighted avg': {'precision': 0.608758825200345, 'recall': 0.6744456727085564, 'f1-score': 0.5872364398844245, 'support': 1367784}}
[[ 14571 200969   3635]
 [ 14971 886605  25488]
 [  2557 197668  21320]]
Evaluating performance on  train set...
1290/1290 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78210336
{'0': {'precision': 0.4384678076609617, 'recall': 0.08400811974391577, 'f1-score': 0.1410011606574563, 'support': 44829}, '1': {'precision': 0.7406812693027381, 'recall': 0.9565002905554836, 'f1-score': 0.8348686623206731, 'support': 239197}, '2': {'precision': 0.4428864030250512, 'recall': 0.1218175120799116, 'f1-score': 0.1910782564364007, 'support': 46151}, 'accuracy': 0.721370658767873, 'macro avg': {'precision': 0.5406784933295837, 'recall': 0.387441974126437, 'f1-score': 0.38898269313817674, 'support': 330177}, 'weighted avg': {'precision': 0.6580242152210767, 'recall': 0.721370658767873, 'f1-score': 0.6506736479676886, 'support': 330177}}
[[  3766  40216    847]
 [  4180 228792   6225]
 [   643  39886   5622]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7812116
{'0': {'precision': 0.43238270469181234, 'recall': 0.07413833898572443, 'f1-score': 0.12657375614354002, 'support': 12679}, '1': {'precision': 0.7415840791925289, 'recall': 0.9603149932649466, 'f1-score': 0.8368937048503612, 'support': 67557}, '2': {'precision': 0.4245371823031064, 'recall': 0.10731281725888325, 'f1-score': 0.17132003798670464, 'support': 12608}, 'accuracy': 0.7234608590754383, 'macro avg': {'precision': 0.5328346553958159, 'recall': 0.38058871650318477, 'f1-score': 0.378262499660202, 'support': 92844}, 'weighted avg': {'precision': 0.6563045619024894, 'recall': 0.7234608590754383, 'f1-score': 0.6495073425493966, 'support': 92844}}
[[  940 11532   207]
 [ 1054 64876  1627]
 [  180 11075  1353]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/AAL
Evaluating performance on  test set...
7177/7177 - 37s - 37s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.82038367
{'0': {'precision': 0.47175432246568477, 'recall': 0.059690135486461925, 'f1-score': 0.10597186216903338, 'support': 283866}, '1': {'precision': 0.7065182428085653, 'recall': 0.966441455421452, 'f1-score': 0.8162880666929687, 'support': 1272731}, '2': {'precision': 0.4588669091633863, 'recall': 0.09849654351182051, 'f1-score': 0.16218072522556898, 'support': 280487}, 'accuracy': 0.6938120412566873, 'macro avg': {'precision': 0.5457131581458788, 'recall': 0.37487604480657816, 'f1-score': 0.36148021802919034, 'support': 1837084}, 'weighted avg': {'precision': 0.6324310074768181, 'recall': 0.6938120412566873, 'f1-score': 0.6066606214593496, 'support': 1837084}}
[[  16944  262519    4403]
 [  14534 1230020   28177]
 [   4439  248421   27627]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8225106
{'0': {'precision': 0.4786407766990291, 'recall': 0.03785236371613469, 'f1-score': 0.07015653588127668, 'support': 91170}, '1': {'precision': 0.6929216502487633, 'recall': 0.9816172851037404, 'f1-score': 0.8123834623930204, 'support': 396133}, '2': {'precision': 0.43763604701784936, 'recall': 0.0445436518926344, 'f1-score': 0.08085743874360289, 'support': 90271}, 'accuracy': 0.6861856662522897, 'macro avg': {'precision': 0.5363994913218806, 'recall': 0.35467110023750315, 'f1-score': 0.32113247900596664, 'support': 577574}, 'weighted avg': {'precision': 0.6191979820594281, 'recall': 0.6861856662522897, 'f1-score': 0.5808903297884844, 'support': 577574}}
[[  3451  86995    724]
 [  2839 388851   4443]
 [   920  85330   4021]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80173874
{'0': {'precision': 0.5011836320595198, 'recall': 0.061055493758497094, 'f1-score': 0.10885053250091811, 'support': 24273}, '1': {'precision': 0.7134238310708899, 'recall': 0.9731067969628552, 'f1-score': 0.8232730169149018, 'support': 114713}, '2': {'precision': 0.4425935417734495, 'recall': 0.07095024855182613, 'f1-score': 0.12229579010728321, 'support': 24341}, 'accuracy': 0.7031109369546983, 'macro avg': {'precision': 0.552400334967953, 'recall': 0.36837084642439283, 'f1-score': 0.35147311317436775, 'support': 163327}, 'weighted avg': {'precision': 0.64151908523957, 'recall': 0.7031109369546983, 'f1-score': 0.6126301737725869, 'support': 163327}}
[[  1482  22450    341]
 [  1251 111628   1834]
 [   224  22390   1727]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/WBA
Evaluating performance on  test set...
5696/5696 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1397659
{'0': {'precision': 0.5488747969994586, 'recall': 0.03287142744665774, 'f1-score': 0.0620280710340488, 'support': 431834}, '1': {'precision': 0.42267833654921455, 'recall': 0.9601175365368511, 'f1-score': 0.5869570355737784, 'support': 607811}, '2': {'precision': 0.5272864936224737, 'recall': 0.06491799203583397, 'f1-score': 0.11560324591440849, 'support': 418374}, 'accuracy': 0.42861238433792703, 'macro avg': {'precision': 0.4996132090570489, 'recall': 0.3526356520064476, 'f1-score': 0.2548627841740786, 'support': 1458019}, 'weighted avg': {'precision': 0.4900720093404734, 'recall': 0.42861238433792703, 'f1-score': 0.29623082084818236, 'support': 1458019}}
[[ 14195 409951   7688]
 [  7580 583570  16661]
 [  4087 387127  27160]]
Evaluating performance on  train set...
2222/2222 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0113775
{'0': {'precision': 0.5767723880597015, 'recall': 0.04518514729203359, 'f1-score': 0.08380490251224951, 'support': 136837}, '1': {'precision': 0.5306835190420756, 'recall': 0.9679115368152849, 'f1-score': 0.6855150075010653, 'support': 296711}, '2': {'precision': 0.492766618842659, 'recall': 0.0610276153105797, 'f1-score': 0.10860485645397172, 'support': 135070}, 'accuracy': 0.5304369541590312, 'macro avg': {'precision': 0.5334075086481453, 'recall': 0.35804143313929937, 'f1-score': 0.2926415888224288, 'support': 568618}, 'weighted avg': {'precision': 0.532767918163858, 'recall': 0.5304369541590312, 'f1-score': 0.40367472151243056, 'support': 568618}}
[[  6183 128351   2303]
 [  3339 287190   6182]
 [  1198 125629   8243]]
Evaluating performance on  val set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0052105
{'0': {'precision': 0.5892206846321922, 'recall': 0.04098900542128996, 'f1-score': 0.07664613927048793, 'support': 39474}, '1': {'precision': 0.5357822052610755, 'recall': 0.9719942112879885, 'f1-score': 0.6907883639894189, 'support': 86375}, '2': {'precision': 0.5015901862789641, 'recall': 0.05810985077769298, 'f1-score': 0.10415339984433596, 'support': 37997}, 'accuracy': 0.5357591885062802, 'macro avg': {'precision': 0.5421976920574106, 'recall': 0.35703102249565716, 'f1-score': 0.29052930103474756, 'support': 163846}, 'weighted avg': {'precision': 0.5407273146286046, 'recall': 0.5357591885062802, 'f1-score': 0.4067837565459915, 'support': 163846}}
[[ 1618 37226   630]
 [  855 83956  1564]
 [  273 35516  2208]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 65s - 65s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9907046
{'0': {'precision': 0.4229002274149483, 'recall': 0.040089067525511425, 'f1-score': 0.07323571390812497, 'support': 691161}, '1': {'precision': 0.5590502939080226, 'recall': 0.9509320816685537, 'f1-score': 0.7041391586314082, 'support': 1709936}, '2': {'precision': 0.4572088362162869, 'recall': 0.07628900456567889, 'f1-score': 0.13075969320681127, 'support': 687740}, 'accuracy': 0.5523787755715177, 'macro avg': {'precision': 0.4797197858464193, 'recall': 0.355770051253248, 'f1-score': 0.30271152191544815, 'support': 3088837}, 'weighted avg': {'precision': 0.5059098853269501, 'recall': 0.5523787755715177, 'f1-score': 0.4353027489051904, 'support': 3088837}}
[[  27708  655613    7840]
 [  29455 1626033   54448]
 [   8356  626917   52467]]
Evaluating performance on  train set...
2948/2948 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98249257
{'0': {'precision': 0.49424424424424424, 'recall': 0.023141502967385128, 'f1-score': 0.044212870982365225, 'support': 170689}, '1': {'precision': 0.5545895645668195, 'recall': 0.977743010843272, 'f1-score': 0.7077394024553741, 'support': 415465}, '2': {'precision': 0.4733989445157609, 'recall': 0.03943538134334565, 'f1-score': 0.07280584377125057, 'support': 168326}, 'accuracy': 0.5524414166048139, 'macro avg': {'precision': 0.5074109177756082, 'recall': 0.3467732983846676, 'f1-score': 0.27491937240299663, 'support': 754480}, 'weighted avg': {'precision': 0.5228236135923012, 'recall': 0.5524414166048139, 'f1-score': 0.41597221667223844, 'support': 754480}}
[[  3950 165462   1277]
 [  3140 406218   6107]
 [   902 160786   6638]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9022296
{'0': {'precision': 0.545338441890166, 'recall': 0.024776604386677496, 'f1-score': 0.04739967808181162, 'support': 34468}, '1': {'precision': 0.6227685760294456, 'recall': 0.9831402527600233, 'f1-score': 0.7625200687265864, 'support': 110144}, '2': {'precision': 0.4861205145565335, 'recall': 0.04250029596306381, 'f1-score': 0.07816667573893636, 'support': 33788}, 'accuracy': 0.6198262331838565, 'macro avg': {'precision': 0.5514091774920483, 'recall': 0.3501390510365882, 'f1-score': 0.29602880751577815, 'support': 178400}, 'weighted avg': {'precision': 0.5819281804881931, 'recall': 0.6198262331838565, 'f1-score': 0.4947414696962567, 'support': 178400}}
[[   854  33397    217]
 [   556 108287   1301]
 [   156  32196   1436]]
testing model on single stock: results/universal/W1/deepOF_L1/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 108s - 108s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3939027
{'0': {'precision': 0.5725639902371863, 'recall': 0.01295751641700854, 'f1-score': 0.025341536455868823, 'support': 2118230}, '1': {'precision': 0.22123612749340607, 'recall': 0.9818623018276242, 'f1-score': 0.36110663615560645, 'support': 1205390}, '2': {'precision': 0.5391538629578387, 'recall': 0.017278604606009915, 'f1-score': 0.033484122379262106, 'support': 2142592}, 'accuracy': 0.2283107570654047, 'macro avg': {'precision': 0.4443179935628104, 'recall': 0.3373661409502142, 'f1-score': 0.13997743166357915, 'support': 5466212}, 'weighted avg': {'precision': 0.4819946226567783, 'recall': 0.2283107570654047, 'f1-score': 0.10257493556037517, 'support': 5466212}}
[[  27447 2072249   18534]
 [   8753 1183527   13110]
 [  11737 2093834   37021]]
Evaluating performance on  train set...
6073/6073 - 31s - 31s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2126678
{'0': {'precision': 0.5168075117370892, 'recall': 0.016778987245043127, 'f1-score': 0.032502721354909954, 'support': 492044}, '1': {'precision': 0.366956005942233, 'recall': 0.978830170926768, 'f1-score': 0.5337959568803081, 'support': 567553}, '2': {'precision': 0.49726377234585917, 'recall': 0.024784021205925374, 'f1-score': 0.04721481837863844, 'support': 494956}, 'accuracy': 0.37056375691275883, 'macro avg': {'precision': 0.46034243000839375, 'recall': 0.34013105979257885, 'f1-score': 0.2045044988712855, 'support': 1554553}, 'weighted avg': {'precision': 0.45587555075376235, 'recall': 0.37056375691275883, 'f1-score': 0.22020447253137215, 'support': 1554553}}
[[  8256 478964   4824]
 [  4437 555538   7578]
 [  3282 479407  12267]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2542596
{'0': {'precision': 0.5215427380125087, 'recall': 0.019347146585892438, 'f1-score': 0.037310232971458045, 'support': 155165}, '1': {'precision': 0.3203993231810491, 'recall': 0.9773179275082065, 'f1-score': 0.4825889496961243, 'support': 145313}, '2': {'precision': 0.5113608600048863, 'recall': 0.026711078780453566, 'f1-score': 0.05077016373559733, 'support': 156714}, 'accuracy': 0.3263508547831108, 'macro avg': {'precision': 0.45110097373281466, 'recall': 0.34112538429151745, 'f1-score': 0.19022311546772655, 'support': 457192}, 'weighted avg': {'precision': 0.4541216198182042, 'recall': 0.3263508547831108, 'f1-score': 0.1834504667314161, 'support': 457192}}
[[  3002 150094   2069]
 [  1365 142017   1931]
 [  1389 151139   4186]]
training model: results/universal/W1/deepOF_L1/h30
Epoch 1/50
10622/10622 - 143s - loss: 3.0972 - accuracy30: 0.4694 - val_loss: 3.6279 - val_accuracy30: 0.4016 - 143s/epoch - 13ms/step
Epoch 2/50
10622/10622 - 141s - loss: 3.0780 - accuracy30: 0.4731 - val_loss: 3.6334 - val_accuracy30: 0.4042 - 141s/epoch - 13ms/step
Epoch 3/50
10622/10622 - 140s - loss: 3.0591 - accuracy30: 0.4775 - val_loss: 3.6979 - val_accuracy30: 0.4050 - 140s/epoch - 13ms/step
Epoch 4/50
10622/10622 - 141s - loss: 3.0428 - accuracy30: 0.4811 - val_loss: 3.7634 - val_accuracy30: 0.4051 - 141s/epoch - 13ms/step
Epoch 5/50
10622/10622 - 140s - loss: 3.0294 - accuracy30: 0.4836 - val_loss: 3.7639 - val_accuracy30: 0.4065 - 140s/epoch - 13ms/step
Epoch 6/50
10622/10622 - 141s - loss: 3.0189 - accuracy30: 0.4854 - val_loss: 3.7735 - val_accuracy30: 0.4074 - 141s/epoch - 13ms/step
Epoch 7/50
10622/10622 - 140s - loss: 3.0102 - accuracy30: 0.4871 - val_loss: 3.7613 - val_accuracy30: 0.4085 - 140s/epoch - 13ms/step
Epoch 8/50
10622/10622 - 141s - loss: 3.0029 - accuracy30: 0.4886 - val_loss: 3.7783 - val_accuracy30: 0.4092 - 141s/epoch - 13ms/step
Epoch 9/50
10622/10622 - 140s - loss: 2.9955 - accuracy30: 0.4903 - val_loss: 3.7647 - val_accuracy30: 0.4104 - 140s/epoch - 13ms/step
Epoch 10/50
10622/10622 - 140s - loss: 2.9899 - accuracy30: 0.4915 - val_loss: 3.7516 - val_accuracy30: 0.4115 - 140s/epoch - 13ms/step
Epoch 11/50
10622/10622 - 141s - loss: 2.9848 - accuracy30: 0.4931 - val_loss: 3.7724 - val_accuracy30: 0.4115 - 141s/epoch - 13ms/step
testing model in sample: results/universal/W1/deepOF_L1/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 182s - 182s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2155626
{'0': {'precision': 0.5472090612455038, 'recall': 0.0254741092142676, 'f1-score': 0.048681938315084515, 'support': 3087527}, '1': {'precision': 0.3180905163508407, 'recall': 0.9674233555808261, 'f1-score': 0.4787629311913417, 'support': 2869387}, '2': {'precision': 0.5153157345197023, 'recall': 0.02939017593779876, 'f1-score': 0.0556087966379124, 'support': 3089842}, 'accuracy': 0.3255725035581815, 'macro avg': {'precision': 0.4602051040386823, 'recall': 0.34076254691096414, 'f1-score': 0.19435122204811286, 'support': 9046756}, 'weighted avg': {'precision': 0.46364594595680075, 'recall': 0.3255725035581815, 'f1-score': 0.18745783850296932, 'support': 9046756}}
[[  78652 2978526   30349]
 [  38411 2775912   55064]
 [  26670 2972361   90811]]
Evaluating performance on  train set...
10622/10622 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.110065
{'0': {'precision': 0.5429575917380796, 'recall': 0.03427629612722369, 'f1-score': 0.06448192176576227, 'support': 792997}, '1': {'precision': 0.41988657503110355, 'recall': 0.9688771513500036, 'f1-score': 0.5858714495176917, 'support': 1131034}, '2': {'precision': 0.5057916375236698, 'recall': 0.03731874937065754, 'f1-score': 0.06950893155425104, 'support': 794480}, 'accuracy': 0.42400527347507516, 'macro avg': {'precision': 0.4895452680976177, 'recall': 0.3468240656159616, 'f1-score': 0.23995410094590167, 'support': 2718511}, 'weighted avg': {'precision': 0.48089232453319347, 'recall': 0.42400527347507516, 'f1-score': 0.2828746896700063, 'support': 2718511}}
[[  27181  756764    9052]
 [  15283 1095833   19918]
 [   7597  757234   29649]]
Evaluating performance on  val set...
3064/3064 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1274533
{'0': {'precision': 0.5451498422712934, 'recall': 0.03478702123287384, 'f1-score': 0.06540070249579173, 'support': 238451}, '1': {'precision': 0.39627415912611613, 'recall': 0.9691923938742524, 'f1-score': 0.5625416456668687, 'support': 307489}, '2': {'precision': 0.5097184377838329, 'recall': 0.03539413713651424, 'f1-score': 0.06619199452724776, 'support': 237836}, 'accuracy': 0.4015547809578247, 'macro avg': {'precision': 0.4837141463937475, 'recall': 0.34645785074788016, 'f1-score': 0.23137811422996943, 'support': 783776}, 'weighted avg': {'precision': 0.4759916919167188, 'recall': 0.4015547809578247, 'f1-score': 0.26067788527036595, 'support': 783776}}
[[  8295 227275   2881]
 [  4257 298016   5216]
 [  2664 226754   8418]]
testing model out of sample: results/universal/W1/deepOF_L1/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 126s - 126s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0500654
{'0': {'precision': 0.4903628598902653, 'recall': 0.04351083018335242, 'f1-score': 0.07992937476265691, 'support': 1593925}, '1': {'precision': 0.48522896420701794, 'recall': 0.9557295718813085, 'f1-score': 0.6436655304251693, 'support': 2924119}, '2': {'precision': 0.5028246022859103, 'recall': 0.06304933126813975, 'f1-score': 0.11204882585837242, 'support': 1581127}, 'accuracy': 0.48591997174698004, 'macro avg': {'precision': 0.49280547546106446, 'recall': 0.35409657777760023, 'f1-score': 0.2785479103487329, 'support': 6099171}, 'weighted avg': {'precision': 0.49113205876293137, 'recall': 0.48591997174698004, 'f1-score': 0.3585273244040632, 'support': 6099171}}
[[  69353 1503899   20673]
 [  51556 2794667   77896]
 [  20523 1460915   99689]]
Evaluating performance on  train set...
6711/6711 - 36s - 36s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0320632
{'0': {'precision': 0.5349283376594064, 'recall': 0.03261086432550321, 'f1-score': 0.06147408102301171, 'support': 436051}, '1': {'precision': 0.4979141815762049, 'recall': 0.9756878252509289, 'f1-score': 0.6593487288059495, 'support': 846654}, '2': {'precision': 0.5022447043945621, 'recall': 0.036555759844811755, 'f1-score': 0.06815115433538038, 'support': 434569}, 'accuracy': 0.49856691477306475, 'macro avg': {'precision': 0.5116957412100578, 'recall': 0.348284816473748, 'f1-score': 0.2629913213881139, 'support': 1717274}, 'weighted avg': {'precision': 0.508408704142136, 'recall': 0.49856691477306475, 'f1-score': 0.35792916688368287, 'support': 1717274}}
[[ 14220 417789   4042]
 [  8882 826070  11702]
 [  3481 415202  15886]]
Evaluating performance on  val set...
1720/1720 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0034083
{'0': {'precision': 0.5475119291070212, 'recall': 0.03792865710265104, 'f1-score': 0.07094278294970764, 'support': 105883}, '1': {'precision': 0.5283399230971023, 'recall': 0.9746354223433242, 'f1-score': 0.6852258829803863, 'support': 229375}, '2': {'precision': 0.5044219499200853, 'recall': 0.04526115514422571, 'f1-score': 0.08306866237344049, 'support': 104593}, 'accuracy': 0.5281493051055925, 'macro avg': {'precision': 0.5267579340414029, 'recall': 0.352608411530067, 'f1-score': 0.2797457761011782, 'support': 439851}, 'weighted avg': {'precision': 0.5272675984777301, 'recall': 0.5281493051055925, 'f1-score': 0.3941646653055586, 'support': 439851}}
[[  4016 100626   1241]
 [  2408 223557   3410]
 [   911  98948   4734]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/LILAK
Evaluating performance on  test set...
663/663 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3409083
{'0': {'precision': 0.41646489104116224, 'recall': 0.005279393483632345, 'f1-score': 0.01042661210881261, 'support': 65159}, '1': {'precision': 0.23491168688770767, 'recall': 0.9928222434896489, 'f1-score': 0.3799284881311501, 'support': 39706}, '2': {'precision': 0.5244019138755981, 'recall': 0.008454441667438058, 'f1-score': 0.0166406024626877, 'support': 64818}, 'accuracy': 0.2375783077856945, 'macro avg': {'precision': 0.39192616393482266, 'recall': 0.3355186928802398, 'f1-score': 0.1356652342342168, 'support': 169683}, 'weighted avg': {'precision': 0.41521261722448877, 'recall': 0.2375783077856945, 'f1-score': 0.0992641498474217, 'support': 169683}}
[[  344 64463   352]
 [  140 39421   145]
 [  342 63928   548]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2363207
{'0': {'precision': 0.46079613992762364, 'recall': 0.017479637594948295, 'f1-score': 0.03368161177974695, 'support': 21854}, '1': {'precision': 0.325948784082535, 'recall': 0.9826891923165934, 'f1-score': 0.48952629091202554, 'support': 21605}, '2': {'precision': 0.48566308243727596, 'recall': 0.011749913284772807, 'f1-score': 0.02294471255609178, 'support': 23064}, 'accuracy': 0.32896892803992606, 'macro avg': {'precision': 0.4241360021491449, 'recall': 0.33730624773210477, 'f1-score': 0.1820508717492881, 'support': 66523}, 'weighted avg': {'precision': 0.4256226516455179, 'recall': 0.32896892803992606, 'f1-score': 0.1780059574791065, 'support': 66523}}
[[  382 21330   142]
 [  229 21231   145]
 [  218 22575   271]]
Evaluating performance on  val set...
51/51 - 0s - 418ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2273074
{'0': {'precision': 0.5032258064516129, 'recall': 0.018160651920838183, 'f1-score': 0.0350561797752809, 'support': 4295}, '1': {'precision': 0.3400031761156106, 'recall': 0.9857274401473296, 'f1-score': 0.505608690518361, 'support': 4344}, '2': {'precision': 0.40816326530612246, 'recall': 0.009505703422053232, 'f1-score': 0.01857872735717603, 'support': 4208}, 'accuracy': 0.34249241067953606, 'macro avg': {'precision': 0.4171307492911153, 'recall': 0.33779793183007367, 'f1-score': 0.18641453255027263, 'support': 12847}, 'weighted avg': {'precision': 0.41689730335207076, 'recall': 0.34249241067953606, 'f1-score': 0.18876856296922148, 'support': 12847}}
[[  78 4185   32]
 [  36 4282   26]
 [  41 4127   40]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78927916
{'0': {'precision': 0.5011984933226801, 'recall': 0.0776453529494978, 'f1-score': 0.13446021465864375, 'support': 56552}, '1': {'precision': 0.7500919949477369, 'recall': 0.9765954278537069, 'f1-score': 0.8484875757618373, 'support': 308914}, '2': {'precision': 0.5500597133757962, 'recall': 0.09951565566538828, 'f1-score': 0.16853949715644867, 'support': 55539}, 'accuracy': 0.7401384781653425, 'macro avg': {'precision': 0.6004500672154044, 'recall': 0.38458547882286426, 'f1-score': 0.38382909585897657, 'support': 421005}, 'weighted avg': {'precision': 0.6902708094745853, 'recall': 0.7401384781653425, 'f1-score': 0.6628762132773715, 'support': 421005}}
[[  4391  51617    544]
 [  3253 301684   3977]
 [  1117  48895   5527]]
Evaluating performance on  train set...
653/653 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90277505
{'0': {'precision': 0.5926750804256372, 'recall': 0.07245061560335178, 'f1-score': 0.12911747264003448, 'support': 33057}, '1': {'precision': 0.6209982053888533, 'recall': 0.9749288254474885, 'f1-score': 0.7587177098786018, 'support': 101511}, '2': {'precision': 0.5394474508686984, 'recall': 0.058547140649149926, 'f1-score': 0.10563007166559774, 'support': 32350}, 'accuracy': 0.6185971554895218, 'macro avg': {'precision': 0.5843735788943963, 'recall': 0.3686421938999968, 'f1-score': 0.331155084728078, 'support': 166918}, 'weighted avg': {'precision': 0.5995838315607698, 'recall': 0.6185971554895218, 'f1-score': 0.5074561315072698, 'support': 166918}}
[[ 2395 30277   385]
 [ 1313 98966  1232]
 [  333 30123  1894]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8567494
{'0': {'precision': 0.5960144927536232, 'recall': 0.08034188034188035, 'f1-score': 0.1415967290725199, 'support': 8190}, '1': {'precision': 0.6704449370415229, 'recall': 0.9717143614202438, 'f1-score': 0.7934443077172721, 'support': 30192}, '2': {'precision': 0.5522074281709881, 'recall': 0.09964592817400102, 'f1-score': 0.16882699517943228, 'support': 7908}, 'accuracy': 0.6650248433786995, 'macro avg': {'precision': 0.6062222859887113, 'recall': 0.3839007233120417, 'f1-score': 0.36795601065640815, 'support': 46290}, 'weighted avg': {'precision': 0.6370768757136749, 'recall': 0.6650248433786995, 'f1-score': 0.5714070345124815, 'support': 46290}}
[[  658  7410   122]
 [  337 29338   517]
 [  109  7011   788]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3043969
{'0': {'precision': 0.6240922294843864, 'recall': 0.05220038875053149, 'f1-score': 0.09634248878923768, 'support': 131704}, '1': {'precision': 0.20692503176620075, 'recall': 0.9325430911069118, 'f1-score': 0.3386957561640132, 'support': 69852}, '2': {'precision': 0.5427996936039832, 'recall': 0.042084867561468106, 'f1-score': 0.0781133739355692, 'support': 134704}, 'accuracy': 0.23102361268066376, 'macro avg': {'precision': 0.4579389849515234, 'recall': 0.34227611580630374, 'f1-score': 0.1710505396296067, 'support': 336260}, 'weighted avg': {'precision': 0.5048678410699317, 'recall': 0.23102361268066376, 'f1-score': 0.13938455666949182, 'support': 336260}}
[[  6875 122675   2154]
 [  2091  65140   2621]
 [  2050 126985   5669]]
Evaluating performance on  train set...
524/524 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1934997
{'0': {'precision': 0.6187572590011614, 'recall': 0.047621175892198706, 'f1-score': 0.08843607992862033, 'support': 44749}, '1': {'precision': 0.3301802900694876, 'recall': 0.9572667122975131, 'f1-score': 0.49100366874776924, 'support': 43830}, '2': {'precision': 0.5375606969437303, 'recall': 0.041418165012434255, 'f1-score': 0.07691050265631387, 'support': 45439}, 'accuracy': 0.343013625035443, 'macro avg': {'precision': 0.49549941533812647, 'recall': 0.3487686844007154, 'f1-score': 0.21878341711090113, 'support': 134018}, 'weighted avg': {'precision': 0.4968496112851615, 'recall': 0.343013625035443, 'f1-score': 0.21618628297796416, 'support': 134018}}
[[ 2131 41999   619]
 [  873 41957  1000]
 [  440 43117  1882]]
Evaluating performance on  val set...
107/107 - 1s - 663ms/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3077688
{'0': {'precision': 0.6499189627228525, 'recall': 0.03771987583482269, 'f1-score': 0.07130156472261735, 'support': 10631}, '1': {'precision': 0.21717914956238865, 'recall': 0.9503473987459753, 'f1-score': 0.35356050814866186, 'support': 5901}, '2': {'precision': 0.5636114911080712, 'recall': 0.0387290844143636, 'f1-score': 0.07247779048289207, 'support': 10638}, 'accuracy': 0.23632683106367317, 'macro avg': {'precision': 0.4769032011311041, 'recall': 0.34226545299838723, 'f1-score': 0.1657799544513904, 'support': 27170}, 'weighted avg': {'precision': 0.522140658692748, 'recall': 0.23632683106367317, 'f1-score': 0.13306537461569395, 'support': 27170}}
[[  401 10068   162]
 [  136  5608   157]
 [   80 10146   412]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2081858
{'0': {'precision': 0.5145022210608832, 'recall': 0.01699758287292818, 'f1-score': 0.03290798632872889, 'support': 115840}, '1': {'precision': 0.320862395000108, 'recall': 0.9742876412072163, 'f1-score': 0.4827429367059234, 'support': 106758}, '2': {'precision': 0.502438174851968, 'recall': 0.02595871799024636, 'f1-score': 0.0493668720054757, 'support': 111138}, 'accuracy': 0.32620694201404704, 'macro avg': {'precision': 0.44593426363765304, 'recall': 0.33908131402346364, 'f1-score': 0.18833926501337603, 'support': 333736}, 'weighted avg': {'precision': 0.44854177772194864, 'recall': 0.32620694201404704, 'f1-score': 0.18228559997757354, 'support': 333736}}
[[  1969 112643   1228]
 [  1116 104013   1629]
 [   742 107511   2885]]
Evaluating performance on  train set...
384/384 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2014215
{'0': {'precision': 0.4773638968481375, 'recall': 0.024677094442469488, 'f1-score': 0.04692825554209741, 'support': 33756}, '1': {'precision': 0.33103192279138827, 'recall': 0.9612577376736164, 'f1-score': 0.4924700814919415, 'support': 32471}, '2': {'precision': 0.4334841628959276, 'recall': 0.029920669623336872, 'f1-score': 0.05597756222975341, 'support': 32018}, 'accuracy': 0.33593567102651534, 'macro avg': {'precision': 0.41395999417848445, 'recall': 0.33861850057980764, 'f1-score': 0.19845863308793077, 'support': 98245}, 'weighted avg': {'precision': 0.4146992640293827, 'recall': 0.33593567102651534, 'f1-score': 0.1971336535973955, 'support': 98245}}
[[  833 32365   558]
 [  564 31213   694]
 [  348 30712   958]]
Evaluating performance on  val set...
93/93 - 1s - 628ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2050596
{'0': {'precision': 0.46987951807228917, 'recall': 0.02909000497265042, 'f1-score': 0.054788105830016386, 'support': 8044}, '1': {'precision': 0.3184792219274978, 'recall': 0.9615589962626802, 'f1-score': 0.4784803400637619, 'support': 7492}, '2': {'precision': 0.4732510288065844, 'recall': 0.028507684680218144, 'f1-score': 0.053776011222819727, 'support': 8068}, 'accuracy': 0.32486019318759535, 'macro avg': {'precision': 0.42053658960212376, 'recall': 0.3397188953051829, 'f1-score': 0.19568148570553268, 'support': 23604}, 'weighted avg': {'precision': 0.4229768884284795, 'recall': 0.32486019318759535, 'f1-score': 0.18892370316895718, 'support': 23604}}
[[ 234 7677  133]
 [ 165 7204  123]
 [  99 7739  230]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2653877
{'0': {'precision': 0.4737340915245058, 'recall': 0.028424622758382583, 'f1-score': 0.053631302042020636, 'support': 246195}, '1': {'precision': 0.26701685270299846, 'recall': 0.9409792085848424, 'f1-score': 0.4159902747818868, 'support': 178920}, '2': {'precision': 0.4808976513878163, 'recall': 0.043709123340159875, 'f1-score': 0.08013474385420412, 'support': 242192}, 'accuracy': 0.27864835825189904, 'macro avg': {'precision': 0.40721619853844016, 'recall': 0.33770431822779495, 'f1-score': 0.18325210689270388, 'support': 667307}, 'weighted avg': {'precision': 0.42090849329231406, 'recall': 0.27864835825189904, 'f1-score': 0.16040702743077453, 'support': 667307}}
[[  6998 234107   5090]
 [  4223 168360   6337]
 [  3551 228055  10586]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2030362
{'0': {'precision': 0.5103189493433395, 'recall': 0.039609086790498994, 'f1-score': 0.07351240972357771, 'support': 61804}, '1': {'precision': 0.3284844715489292, 'recall': 0.9405256562458778, 'f1-score': 0.4869119109506311, 'support': 60648}, '2': {'precision': 0.4875661800096262, 'recall': 0.048837321419962394, 'f1-score': 0.08878177037686241, 'support': 62227}, 'accuracy': 0.33857666545736115, 'macro avg': {'precision': 0.4421232003006317, 'recall': 0.34299068815211303, 'f1-score': 0.21640203035035707, 'support': 184679}, 'weighted avg': {'precision': 0.44293860839171867, 'recall': 0.33857666545736115, 'f1-score': 0.21441646192112201, 'support': 184679}}
[[ 2448 58222  1134]
 [ 1547 57041  2060]
 [  802 58386  3039]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2511414
{'0': {'precision': 0.4616977225672878, 'recall': 0.03169114163903363, 'f1-score': 0.05931113967817722, 'support': 21110}, '1': {'precision': 0.2770057201525374, 'recall': 0.9367017978921265, 'f1-score': 0.42756883719614003, 'support': 16130}, '2': {'precision': 0.48628192999053926, 'recall': 0.049264388747783584, 'f1-score': 0.08946521039119273, 'support': 20867}, 'accuracy': 0.28922505033816925, 'macro avg': {'precision': 0.40832845757012143, 'recall': 0.33921910942631456, 'f1-score': 0.19211506242183665, 'support': 58107}, 'weighted avg': {'precision': 0.4192573394353255, 'recall': 0.28922505033816925, 'f1-score': 0.17236501708594623, 'support': 58107}}
[[  669 19953   488]
 [  423 15109   598]
 [  357 19482  1028]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/EXC
Evaluating performance on  test set...
5343/5343 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9106783
{'0': {'precision': 0.5171224232225494, 'recall': 0.06872004353238466, 'f1-score': 0.12131819542638692, 'support': 268306}, '1': {'precision': 0.6182132861579245, 'recall': 0.9531908425310555, 'f1-score': 0.7499983388593944, 'support': 828919}, '2': {'precision': 0.4660574895490363, 'recall': 0.09312571379994751, 'f1-score': 0.15523333364138486, 'support': 270559}, 'accuracy': 0.609564083217818, 'macro avg': {'precision': 0.5337977329765035, 'recall': 0.3716788666211292, 'f1-score': 0.34218328930905534, 'support': 1367784}, 'weighted avg': {'precision': 0.5682855159504627, 'recall': 0.609564083217818, 'f1-score': 0.5090263143213709, 'support': 1367784}}
[[ 18438 245743   4125]
 [ 14060 790118  24741]
 [  3157 242206  25196]]
Evaluating performance on  train set...
1290/1290 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85734016
{'0': {'precision': 0.4948453608247423, 'recall': 0.089607965152458, 'f1-score': 0.15173867228661753, 'support': 54638}, '1': {'precision': 0.682947821761441, 'recall': 0.9514142169377781, 'f1-score': 0.7951313744018044, 'support': 219344}, '2': {'precision': 0.4998980632008155, 'recall': 0.13090132574072427, 'f1-score': 0.20747426315047243, 'support': 56195}, 'accuracy': 0.669153211762176, 'macro avg': {'precision': 0.559230415262333, 'recall': 0.39064116927698683, 'f1-score': 0.38478143661296477, 'support': 330177}, 'weighted avg': {'precision': 0.6206660049087417, 'recall': 0.669153211762176, 'f1-score': 0.5886449085821435, 'support': 330177}}
[[  4896  48750    992]
 [  4290 208687   6367]
 [   708  48131   7356]]
Evaluating performance on  val set...
363/363 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8606347
{'0': {'precision': 0.48826291079812206, 'recall': 0.08073489455298227, 'f1-score': 0.13855889863439547, 'support': 15458}, '1': {'precision': 0.6838096996411387, 'recall': 0.9550523771152296, 'f1-score': 0.7969847962182189, 'support': 62050}, '2': {'precision': 0.48110344827586204, 'recall': 0.11371935315597287, 'f1-score': 0.18395654237645695, 'support': 15336}, 'accuracy': 0.6705118262892594, 'macro avg': {'precision': 0.5510586862383743, 'recall': 0.3831688749413949, 'f1-score': 0.3731667457430237, 'support': 92844}, 'weighted avg': {'precision': 0.6177691872453648, 'recall': 0.6705118262892594, 'f1-score': 0.586100422152388, 'support': 92844}}
[[ 1248 13997   213]
 [ 1121 59261  1668]
 [  187 13405  1744]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/AAL
Evaluating performance on  test set...
7177/7177 - 39s - 39s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89578927
{'0': {'precision': 0.529533836108721, 'recall': 0.061170912535301034, 'f1-score': 0.10967261748765633, 'support': 342058}, '1': {'precision': 0.6439605747350029, 'recall': 0.9661087779404858, 'f1-score': 0.7728064171462791, 'support': 1158176}, '2': {'precision': 0.5073995066995534, 'recall': 0.09038444411459107, 'f1-score': 0.15343678027687763, 'support': 336850}, 'accuracy': 0.6370389160212597, 'macro avg': {'precision': 0.5602979725144257, 'recall': 0.372554711530126, 'f1-score': 0.34530527163693764, 'support': 1837084}, 'weighted avg': {'precision': 0.5976147478001596, 'recall': 0.6370389160212597, 'f1-score': 0.5357650606143584, 'support': 1837084}}
[[  20924  316615    4519]
 [  14213 1118924   25039]
 [   4377  302027   30446]]
Evaluating performance on  train set...
2257/2257 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8952201
{'0': {'precision': 0.5308688075678367, 'recall': 0.03940354216132817, 'f1-score': 0.07336182948749927, 'support': 108239}, '1': {'precision': 0.6353219845607226, 'recall': 0.9818862452896243, 'f1-score': 0.7714701254371022, 'support': 362763}, '2': {'precision': 0.4896536212325686, 'recall': 0.04085500882032804, 'f1-score': 0.07541744613039562, 'support': 106572}, 'accuracy': 0.6316264236271023, 'macro avg': {'precision': 0.5519481377870427, 'recall': 0.3540482654237602, 'f1-score': 0.3067498003516657, 'support': 577574}, 'weighted avg': {'precision': 0.5888689305085301, 'recall': 0.6316264236271023, 'f1-score': 0.5122093727294605, 'support': 577574}}
[[  4265 103215    759]
 [  2792 356192   3779]
 [   977 101241   4354]]
Evaluating performance on  val set...
638/638 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87537384
{'0': {'precision': 0.5623479318734793, 'recall': 0.06391510249230875, 'f1-score': 0.11478412018499551, 'support': 28929}, '1': {'precision': 0.658017401116903, 'recall': 0.9724088269013937, 'f1-score': 0.7849014179298531, 'support': 105541}, '2': {'precision': 0.48821218074656186, 'recall': 0.06889143015559483, 'f1-score': 0.12074463239090166, 'support': 28857}, 'accuracy': 0.6518579291850092, 'macro avg': {'precision': 0.5695258379123147, 'recall': 0.36840511984976576, 'f1-score': 0.34014339016858347, 'support': 163327}, 'weighted avg': {'precision': 0.6110705318303188, 'recall': 0.6518579291850092, 'f1-score': 0.5488633123700957, 'support': 163327}}
[[  1849  26718    362]
 [  1190 102629   1722]
 [   249  26620   1988]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/WBA
Evaluating performance on  test set...
5696/5696 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1859239
{'0': {'precision': 0.5566088840736728, 'recall': 0.03387267254150123, 'f1-score': 0.06385916800515845, 'support': 485347}, '1': {'precision': 0.3464866419860974, 'recall': 0.9575842657251629, 'f1-score': 0.5088529384221145, 'support': 499343}, '2': {'precision': 0.5441279669762642, 'recall': 0.055696988775249354, 'f1-score': 0.10105044472851533, 'support': 473329}, 'accuracy': 0.35731084437171257, 'macro avg': {'precision': 0.48240783101201146, 'recall': 0.34905130901397113, 'f1-score': 0.22458751705192945, 'support': 1458019}, 'weighted avg': {'precision': 0.4805943391743707, 'recall': 0.35731084437171257, 'f1-score': 0.22833455146827103, 'support': 1458019}}
[[ 16440 460458   8449]
 [  7542 478163  13638]
 [  5554 441412  26363]]
Evaluating performance on  train set...
2222/2222 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0696405
{'0': {'precision': 0.5986904386241717, 'recall': 0.04846661812979781, 'f1-score': 0.08967375249618925, 'support': 156582}, '1': {'precision': 0.46035290414560537, 'recall': 0.9665934493148022, 'f1-score': 0.6236732031882003, 'support': 257225}, '2': {'precision': 0.5219530658591975, 'recall': 0.05344581457389979, 'f1-score': 0.09696302068989765, 'support': 154811}, 'accuracy': 0.46515411049245714, 'macro avg': {'precision': 0.5269988028763248, 'recall': 0.35616862733949994, 'f1-score': 0.27010332545809573, 'support': 568618}, 'weighted avg': {'precision': 0.5152184737525574, 'recall': 0.46515411049245714, 'f1-score': 0.3332229676152828, 'support': 568618}}
[[  7589 146472   2521]
 [  3536 248632   5057]
 [  1551 144986   8274]]
Evaluating performance on  val set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0676893
{'0': {'precision': 0.6307931570762053, 'recall': 0.04461359086609323, 'f1-score': 0.08333333333333334, 'support': 45457}, '1': {'precision': 0.4620372440668221, 'recall': 0.9710139090274421, 'f1-score': 0.626138975582095, 'support': 74484}, '2': {'precision': 0.52685546875, 'recall': 0.04915157726910375, 'f1-score': 0.0899147934418033, 'support': 43905}, 'accuracy': 0.46696898306946766, 'macro avg': {'precision': 0.5398952899643424, 'recall': 0.35492635905421305, 'f1-score': 0.26646236745241053, 'support': 163846}, 'weighted avg': {'precision': 0.5262254555116085, 'recall': 0.46696898306946766, 'f1-score': 0.33185508219091386, 'support': 163846}}
[[ 2028 42795   634]
 [  855 72325  1304]
 [  332 41415  2158]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 61s - 61s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0516691
{'0': {'precision': 0.45330721272850016, 'recall': 0.04234126969408105, 'f1-score': 0.07744844836242418, 'support': 808809}, '1': {'precision': 0.48233374876445057, 'recall': 0.9495507507792063, 'f1-score': 0.6397169232733483, 'support': 1477465}, '2': {'precision': 0.5028997277026704, 'recall': 0.06558488243290558, 'f1-score': 0.11603698298553396, 'support': 802563}, 'accuracy': 0.48232069222170026, 'macro avg': {'precision': 0.47951356306520704, 'recall': 0.3524923009687309, 'f1-score': 0.27773411820710214, 'support': 3088837}, 'weighted avg': {'precision': 0.4800767731357248, 'recall': 0.48232069222170026, 'f1-score': 0.35642131821505657, 'support': 3088837}}
[[  34246  766055    8508]
 [  31016 1402928   43521]
 [  10285  739642   52636]]
Evaluating performance on  train set...
2948/2948 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0482605
{'0': {'precision': 0.528641922334263, 'recall': 0.024713522730122114, 'f1-score': 0.04721957389317147, 'support': 199405}, '1': {'precision': 0.4772857532751092, 'recall': 0.9774935160756607, 'f1-score': 0.6413945248888693, 'support': 357808}, '2': {'precision': 0.5054215892539246, 'recall': 0.03166267039089153, 'f1-score': 0.05959212880143112, 'support': 197267}, 'accuracy': 0.47838113667691656, 'macro avg': {'precision': 0.5037830882877655, 'recall': 0.3446232363988915, 'f1-score': 0.24940207586115729, 'support': 754480}, 'weighted avg': {'precision': 0.4982153323855873, 'recall': 0.47838113667691656, 'f1-score': 0.3322387230488234, 'support': 754480}}
[[  4928 193083   1394]
 [  3335 349755   4718]
 [  1059 189962   6246]]
Evaluating performance on  val set...
697/697 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97724485
{'0': {'precision': 0.56188831318365, 'recall': 0.023852583215210908, 'f1-score': 0.04576251318719962, 'support': 40918}, '1': {'precision': 0.5507745464354793, 'recall': 0.9846396946408233, 'f1-score': 0.706408038573374, 'support': 97459}, '2': {'precision': 0.5254934210526315, 'recall': 0.031931639307398244, 'f1-score': 0.060204922859498286, 'support': 40023}, 'accuracy': 0.5505381165919283, 'macro avg': {'precision': 0.5460520935572536, 'recall': 0.34680797238781086, 'f1-score': 0.2707918248733573, 'support': 178400}, 'weighted avg': {'precision': 0.5476519378402098, 'recall': 0.5505381165919283, 'f1-score': 0.40990982720584074, 'support': 178400}}
[[  976 39733   209]
 [  552 95962   945]
 [  209 38536  1278]]
testing model on single stock: results/universal/W1/deepOF_L1/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 109s - 109s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3330297
{'0': {'precision': 0.5660254171664566, 'recall': 0.017246962963374204, 'f1-score': 0.03347396427043343, 'support': 2161482}, '1': {'precision': 0.20627107000529735, 'recall': 0.9791292928269772, 'f1-score': 0.34075583783759544, 'support': 1125453}, '2': {'precision': 0.5307971950862321, 'recall': 0.014136798580446634, 'f1-score': 0.027540117229647283, 'support': 2179277}, 'accuracy': 0.2140515223339307, 'macro avg': {'precision': 0.43436456075266205, 'recall': 0.33683768479026605, 'f1-score': 0.13392330644589204, 'support': 5466212}, 'weighted avg': {'precision': 0.47790979643936193, 'recall': 0.2140515223339307, 'f1-score': 0.0943753362030039, 'support': 5466212}}
[[  37279 2108059   16144]
 [  12400 1101964   11089]
 [  16182 2132287   30808]]
Evaluating performance on  train set...
6073/6073 - 33s - 33s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1950035
{'0': {'precision': 0.5202158799853641, 'recall': 0.022086980837495437, 'f1-score': 0.04237483886831537, 'support': 514964}, '1': {'precision': 0.3365409571228052, 'recall': 0.9765890528605161, 'f1-score': 0.500578331264406, 'support': 520483}, '2': {'precision': 0.5006941645393882, 'recall': 0.02153702711970195, 'f1-score': 0.041297662692659325, 'support': 519106}, 'accuracy': 0.34148208520391393, 'macro avg': {'precision': 0.4524836672158525, 'recall': 0.34007102027257113, 'f1-score': 0.19475027760846023, 'support': 1554553}, 'weighted avg': {'precision': 0.45220049904011994, 'recall': 0.34148208520391393, 'f1-score': 0.19542716948486838, 'support': 1554553}}
[[ 11374 498965   4625]
 [  5661 508298   6524]
 [  4829 503097  11180]]
Evaluating performance on  val set...
1786/1786 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2266219
{'0': {'precision': 0.524113294207706, 'recall': 0.025467756134455864, 'f1-score': 0.04857514485041977, 'support': 161302}, '1': {'precision': 0.29347781852382737, 'recall': 0.9740078486692528, 'f1-score': 0.451049989836286, 'support': 133271}, '2': {'precision': 0.5086549375709422, 'recall': 0.02204539444960306, 'f1-score': 0.04225924899951081, 'support': 162619}, 'accuracy': 0.3007489194911547, 'macro avg': {'precision': 0.44208201676749187, 'recall': 0.3405069997511039, 'f1-score': 0.18062812789540553, 'support': 457192}, 'weighted avg': {'precision': 0.45138489349688843, 'recall': 0.3007489194911547, 'f1-score': 0.1636496439639922, 'support': 457192}}
[[  4108 155400   1794]
 [  1795 129807   1669]
 [  1935 157099   3585]]
training model: results/universal/W1/deepLOB_L2/h10
Epoch 1/50
10622/10622 - 421s - loss: 2.8264 - accuracy10: 0.4995 - val_loss: 3.5661 - val_accuracy10: 0.5316 - 421s/epoch - 40ms/step
Epoch 2/50
10622/10622 - 417s - loss: 2.6496 - accuracy10: 0.5608 - val_loss: 3.3345 - val_accuracy10: 0.5344 - 417s/epoch - 39ms/step
Epoch 3/50
10622/10622 - 418s - loss: 2.5898 - accuracy10: 0.5726 - val_loss: 3.2556 - val_accuracy10: 0.5550 - 418s/epoch - 39ms/step
Epoch 4/50
10622/10622 - 416s - loss: 2.5637 - accuracy10: 0.5764 - val_loss: 3.2433 - val_accuracy10: 0.5651 - 416s/epoch - 39ms/step
Epoch 5/50
10622/10622 - 416s - loss: 2.5470 - accuracy10: 0.5792 - val_loss: 3.1908 - val_accuracy10: 0.5673 - 416s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 415s - loss: 2.5355 - accuracy10: 0.5812 - val_loss: 3.1418 - val_accuracy10: 0.5654 - 415s/epoch - 39ms/step
Epoch 7/50
10622/10622 - 418s - loss: 2.5259 - accuracy10: 0.5829 - val_loss: 3.1609 - val_accuracy10: 0.5711 - 418s/epoch - 39ms/step
Epoch 8/50
10622/10622 - 416s - loss: 2.5186 - accuracy10: 0.5842 - val_loss: 3.1654 - val_accuracy10: 0.5729 - 416s/epoch - 39ms/step
Epoch 9/50
10622/10622 - 416s - loss: 2.5128 - accuracy10: 0.5851 - val_loss: 3.1669 - val_accuracy10: 0.5730 - 416s/epoch - 39ms/step
Epoch 10/50
10622/10622 - 417s - loss: 2.5074 - accuracy10: 0.5861 - val_loss: 3.1423 - val_accuracy10: 0.5745 - 417s/epoch - 39ms/step
Epoch 11/50
10622/10622 - 417s - loss: 2.5031 - accuracy10: 0.5870 - val_loss: 3.1378 - val_accuracy10: 0.5750 - 417s/epoch - 39ms/step
Epoch 12/50
10622/10622 - 418s - loss: 2.4991 - accuracy10: 0.5876 - val_loss: 3.1819 - val_accuracy10: 0.5731 - 418s/epoch - 39ms/step
Epoch 13/50
10622/10622 - 419s - loss: 2.4955 - accuracy10: 0.5882 - val_loss: 3.1604 - val_accuracy10: 0.5753 - 419s/epoch - 39ms/step
Epoch 14/50
10622/10622 - 419s - loss: 2.4919 - accuracy10: 0.5887 - val_loss: 3.1422 - val_accuracy10: 0.5749 - 419s/epoch - 39ms/step
Epoch 15/50
10622/10622 - 417s - loss: 2.4888 - accuracy10: 0.5892 - val_loss: 3.1709 - val_accuracy10: 0.5755 - 417s/epoch - 39ms/step
Epoch 16/50
10622/10622 - 418s - loss: 2.4864 - accuracy10: 0.5898 - val_loss: 3.1663 - val_accuracy10: 0.5764 - 418s/epoch - 39ms/step
Epoch 17/50
10622/10622 - 418s - loss: 2.4833 - accuracy10: 0.5901 - val_loss: 3.1494 - val_accuracy10: 0.5754 - 418s/epoch - 39ms/step
Epoch 18/50
10622/10622 - 423s - loss: 2.4808 - accuracy10: 0.5906 - val_loss: 3.1728 - val_accuracy10: 0.5757 - 423s/epoch - 40ms/step
Epoch 19/50
10622/10622 - 422s - loss: 2.4787 - accuracy10: 0.5908 - val_loss: 3.2167 - val_accuracy10: 0.5744 - 422s/epoch - 40ms/step
Epoch 20/50
10622/10622 - 417s - loss: 2.4763 - accuracy10: 0.5914 - val_loss: 3.1873 - val_accuracy10: 0.5737 - 417s/epoch - 39ms/step
Epoch 21/50
10622/10622 - 418s - loss: 2.4737 - accuracy10: 0.5916 - val_loss: 3.1878 - val_accuracy10: 0.5754 - 418s/epoch - 39ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 471s - 471s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9667681
{'0': {'precision': 0.45870290468778613, 'recall': 0.5233655080556505, 'f1-score': 0.4889054074916946, 'support': 2450578}, '1': {'precision': 0.6017310193183947, 'recall': 0.663684140821815, 'f1-score': 0.6311910069386465, 'support': 4137768}, '2': {'precision': 0.46490677927922586, 'recall': 0.3190163661028256, 'f1-score': 0.3783862542544155, 'support': 2458435}, 'accuracy': 0.5320124362466605, 'macro avg': {'precision': 0.5084469010951356, 'recall': 0.5020220049934304, 'f1-score': 0.49949422289491885, 'support': 9046781}, 'weighted avg': {'precision': 0.5258062178165188, 'recall': 0.5320124362466605, 'f1-score': 0.5239499880738403, 'support': 9046781}}
[[1282548  792807  375223]
 [ 864137 2746171  527460]
 [ 649347 1024807  784281]]
Evaluating performance on  train set...
10622/10622 - 146s - 146s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86158884
{'0': {'precision': 0.4368402019136593, 'recall': 0.49352849149077066, 'f1-score': 0.4634573097769831, 'support': 587421}, '1': {'precision': 0.7079524255059108, 'recall': 0.7245452108753161, 'f1-score': 0.7161527201171077, 'support': 1544562}, '2': {'precision': 0.44870607739701035, 'recall': 0.3626952369098991, 'f1-score': 0.401141960642334, 'support': 586531}, 'accuracy': 0.5965560596708349, 'macro avg': {'precision': 0.5311662349388602, 'recall': 0.526922979758662, 'f1-score': 0.5269173301788083, 'support': 2718514}, 'weighted avg': {'precision': 0.5934365417188693, 'recall': 0.5965560596708349, 'f1-score': 0.5935849619952424, 'support': 2718514}}
[[ 289909  215548   81964]
 [ 246052 1119105  179405]
 [ 127689  246110  212732]]
Evaluating performance on  val set...
3064/3064 - 41s - 41s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90410995
{'0': {'precision': 0.45171835485159056, 'recall': 0.47223180791023345, 'f1-score': 0.4617473625204427, 'support': 179666}, '1': {'precision': 0.6694110735726718, 'recall': 0.7206242256540946, 'f1-score': 0.6940742250300025, 'support': 425359}, '2': {'precision': 0.43059137136731085, 'recall': 0.33254826492422507, 'f1-score': 0.3752718549265321, 'support': 178753}, 'accuracy': 0.575178175452743, 'macro avg': {'precision': 0.517240266597191, 'recall': 0.5084680994961844, 'f1-score': 0.5103644808256591, 'support': 783778}, 'weighted avg': {'precision': 0.565042593939336, 'recall': 0.575178175452743, 'f1-score': 0.568109834420993, 'support': 783778}}
[[ 84844  67941  26881]
 [ 67108 306524  51727]
 [ 35873  83436  59444]]
testing model out of sample: results/universal/W1/deepLOB_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 327s - 327s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71163344
{'0': {'precision': 0.4753359553634025, 'recall': 0.5667650356135859, 'f1-score': 0.51703971496541, 'support': 1125694}, '1': {'precision': 0.8151235278092956, 'recall': 0.7991820761035892, 'f1-score': 0.8070740901307912, 'support': 3856349}, '2': {'precision': 0.5075800497720914, 'recall': 0.44346924727409764, 'f1-score': 0.4733637747336378, 'support': 1117153}, 'accuracy': 0.6911324049923957, 'macro avg': {'precision': 0.5993465109815964, 'recall': 0.6031387863304243, 'f1-score': 0.599159193276613, 'support': 6099196}, 'weighted avg': {'precision': 0.6960799767090189, 'recall': 0.6911324049923957, 'f1-score': 0.6924203823479467, 'support': 6099196}}
[[ 638004  330220  157470]
 [ 451268 3081925  323156]
 [ 252945  368785  495423]]
Evaluating performance on  train set...
6711/6711 - 96s - 96s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.73877466
{'0': {'precision': 0.4487698016229052, 'recall': 0.5260524665655866, 'f1-score': 0.4843476985862832, 'support': 301411}, '1': {'precision': 0.8107103548564469, 'recall': 0.7812584054483444, 'f1-score': 0.7957119447423656, 'support': 1115348}, '2': {'precision': 0.45561888687519886, 'recall': 0.43835497921928396, 'f1-score': 0.44682023773384594, 'support': 300519}, 'accuracy': 0.676458325326476, 'macro avg': {'precision': 0.5716996811181837, 'recall': 0.5818886170777383, 'f1-score': 0.5756266270208316, 'support': 1717278}, 'weighted avg': {'precision': 0.6850436911264443, 'recall': 0.676458325326476, 'f1-score': 0.6800072098673807, 'support': 1717278}}
[[158558 101260  41593]
 [128168 871375 115805]
 [ 66591 102194 131734]]
Evaluating performance on  val set...
1720/1720 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6939433
{'0': {'precision': 0.4716036100651485, 'recall': 0.5324659549485107, 'f1-score': 0.5001901767375814, 'support': 74093}, '1': {'precision': 0.8281256500936135, 'recall': 0.8180846691327579, 'f1-score': 0.8230745373720665, 'support': 291960}, '2': {'precision': 0.4860574227625483, 'recall': 0.44639566395663954, 'f1-score': 0.4653830397378124, 'support': 73800}, 'accuracy': 0.7076091330512694, 'macro avg': {'precision': 0.5952622276404368, 'recall': 0.5989820960126361, 'f1-score': 0.5962159179491534, 'support': 439853}, 'weighted avg': {'precision': 0.7106763597878485, 'recall': 0.7076091330512694, 'f1-score': 0.7086701716910347, 'support': 439853}}
[[ 39452  24165  10476]
 [ 28754 238848  24358]
 [ 15449  25407  32944]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1257945
{'0': {'precision': 0.37921268378616435, 'recall': 0.5407222769694511, 'f1-score': 0.44578965813871985, 'support': 51753}, '1': {'precision': 0.5015055008685582, 'recall': 0.3905925859114278, 'f1-score': 0.4391542439914816, 'support': 66522}, '2': {'precision': 0.4050767869700338, 'recall': 0.3473246066170035, 'f1-score': 0.37398425064924185, 'support': 51413}, 'accuracy': 0.4232709443213427, 'macro avg': {'precision': 0.42859832387491875, 'recall': 0.42621315649929414, 'f1-score': 0.4196427175931478, 'support': 169688}, 'weighted avg': {'precision': 0.43499101763975023, 'recall': 0.4232709443213427, 'f1-score': 0.42143241169136286, 'support': 169688}}
[[27984 13101 10668]
 [24981 25983 15558]
 [20830 12726 17857]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.136412
{'0': {'precision': 0.30621578314861797, 'recall': 0.5733841730216277, 'f1-score': 0.3992253122687905, 'support': 15998}, '1': {'precision': 0.6157794774395565, 'recall': 0.35532122863659255, 'f1-score': 0.45062168964351457, 'support': 33761}, '2': {'precision': 0.35040383940067893, 'recall': 0.35713433548079215, 'f1-score': 0.35373707533234855, 'support': 16764}, 'accuracy': 0.4082197134825549, 'macro avg': {'precision': 0.4241330333296178, 'recall': 0.42861324571300413, 'f1-score': 0.40119469241488454, 'support': 66523}, 'weighted avg': {'precision': 0.4744575710710798, 'recall': 0.4082197134825549, 'f1-score': 0.4138462447665063, 'support': 66523}}
[[ 9173  3572  3253]
 [13919 11996  7846]
 [ 6864  3913  5987]]
Evaluating performance on  val set...
51/51 - 1s - 862ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1330893
{'0': {'precision': 0.30463458110516933, 'recall': 0.5394570707070707, 'f1-score': 0.3893825472772841, 'support': 3168}, '1': {'precision': 0.5940181417013974, 'recall': 0.3697543110025942, 'f1-score': 0.45579382994732875, 'support': 6553}, '2': {'precision': 0.32710576314122863, 'recall': 0.3304542546385157, 'f1-score': 0.32877148313176324, 'support': 3126}, 'accuracy': 0.40203938662722816, 'macro avg': {'precision': 0.4085861619825985, 'recall': 0.41322187878272687, 'f1-score': 0.39131595345212533, 'support': 12847}, 'weighted avg': {'precision': 0.45771120503541024, 'recall': 0.40203938662722816, 'f1-score': 0.4085094211636314, 'support': 12847}}
[[1709  820  639]
 [2644 2423 1486]
 [1257  836 1033]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66281533
{'0': {'precision': 0.2874138851462999, 'recall': 0.6620019322540036, 'f1-score': 0.4008118336272833, 'support': 34157}, '1': {'precision': 0.9458304126912642, 'recall': 0.7381507117225897, 'f1-score': 0.8291843443790844, 'support': 352806}, '2': {'precision': 0.3083421645745332, 'recall': 0.6067494933474314, 'f1-score': 0.40889117612129366, 'support': 34047}, 'accuracy': 0.721346286311489, 'macro avg': {'precision': 0.5138621541373658, 'recall': 0.6689673791080083, 'f1-score': 0.5462957847092205, 'support': 421010}, 'weighted avg': {'precision': 0.840858806993101, 'recall': 0.721346286311489, 'f1-score': 0.7604409859091614, 'support': 421010}}
[[ 22612   7556   3989]
 [ 50032 260424  42350]
 [  6030   7359  20658]]
Evaluating performance on  train set...
653/653 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6678737
{'0': {'precision': 0.3957513768686074, 'recall': 0.6021733124597108, 'f1-score': 0.4776130304579651, 'support': 21718}, '1': {'precision': 0.8958599020423251, 'recall': 0.7808565652009312, 'f1-score': 0.834414284915023, 'support': 124147}, '2': {'precision': 0.4071779284545242, 'recall': 0.49631881442074766, 'f1-score': 0.44735095793642304, 'support': 21053}, 'accuracy': 0.7217196467726669, 'macro avg': {'precision': 0.566263069121819, 'recall': 0.6264495640271299, 'f1-score': 0.5864594244364704, 'support': 166918}, 'weighted avg': {'precision': 0.7691535040524932, 'recall': 0.7217196467726669, 'f1-score': 0.7391707889039346, 'support': 166918}}
[[13078  5458  3182]
 [15175 96941 12031]
 [ 4793  5811 10449]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.59318215
{'0': {'precision': 0.4481549507430289, 'recall': 0.5249364365343243, 'f1-score': 0.4835164835164836, 'support': 5113}, '1': {'precision': 0.8987880200442839, 'recall': 0.8504010805744687, 'f1-score': 0.8739252985085197, 'support': 36277}, '2': {'precision': 0.41944119123306006, 'recall': 0.5116326530612245, 'f1-score': 0.4609726946768411, 'support': 4900}, 'accuracy': 0.7785914884424282, 'macro avg': {'precision': 0.5887947206734576, 'recall': 0.6289900567233392, 'f1-score': 0.6061381589006148, 'support': 46290}, 'weighted avg': {'precision': 0.798272004824748, 'recall': 0.7785914884424282, 'f1-score': 0.7870895233987876, 'support': 46290}}
[[ 2684  1749   680]
 [ 2637 30850  2790]
 [  668  1725  2507]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0241642
{'0': {'precision': 0.48332928704378086, 'recall': 0.5522269377640935, 'f1-score': 0.5154861623576427, 'support': 108153}, '1': {'precision': 0.519778275919911, 'recall': 0.5853396757796401, 'f1-score': 0.5506142525987611, 'support': 116464}, '2': {'precision': 0.5211733974319668, 'recall': 0.3806337775867011, 'f1-score': 0.43995258529212333, 'support': 111648}, 'accuracy': 0.5067223766969503, 'macro avg': {'precision': 0.5080936534652195, 'recall': 0.5060667970434782, 'f1-score': 0.502017666749509, 'support': 336265}, 'weighted avg': {'precision': 0.5085183916996023, 'recall': 0.5067223766969503, 'f1-score': 0.5025736828835092, 'support': 336265}}
[[59725 28729 19699]
 [28948 68171 19345]
 [34897 34254 42497]]
Evaluating performance on  train set...
524/524 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9044747
{'0': {'precision': 0.4645132743362832, 'recall': 0.5894110381225086, 'f1-score': 0.5195615055306724, 'support': 35622}, '1': {'precision': 0.6786456649267865, 'recall': 0.7076162342666324, 'f1-score': 0.6928282312256847, 'support': 62288}, '2': {'precision': 0.49956013572954633, 'recall': 0.330259222333001, 'f1-score': 0.3976391737107988, 'support': 36108}, 'accuracy': 0.5745273023026758, 'macro avg': {'precision': 0.5475730249975387, 'recall': 0.5424288315740473, 'f1-score': 0.536676303489052, 'support': 134018}, 'weighted avg': {'precision': 0.5734788641547346, 'recall': 0.5745273023026758, 'f1-score': 0.5672421622539403, 'support': 134018}}
[[20996  9630  4996]
 [11262 44076  6950]
 [12942 11241 11925]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0031992
{'0': {'precision': 0.48353202667205497, 'recall': 0.5511919843372106, 'f1-score': 0.5151498842904042, 'support': 8683}, '1': {'precision': 0.5335083114610674, 'recall': 0.6178944168608775, 'f1-score': 0.57260904267806, 'support': 9869}, '2': {'precision': 0.5112975008558712, 'recall': 0.34660013924344396, 'f1-score': 0.41313969571230974, 'support': 8618}, 'accuracy': 0.5105263157894737, 'macro avg': {'precision': 0.5094459463296644, 'recall': 0.5052288468138441, 'f1-score': 0.5002995408935913, 'support': 27170}, 'weighted avg': {'precision': 0.5104918651372332, 'recall': 0.5105263157894737, 'f1-score': 0.5036644455330158, 'support': 27170}}
[[4786 2522 1375]
 [2291 6098 1480]
 [2821 2810 2987]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.224787
{'0': {'precision': 0.38679896546359677, 'recall': 0.6798977969954367, 'f1-score': 0.4930806462608221, 'support': 117022}, '1': {'precision': 0.5515688757562967, 'recall': 0.07556772178740795, 'f1-score': 0.13292416201827706, 'support': 103748}, '2': {'precision': 0.3831118060985145, 'recall': 0.38602827274256224, 'f1-score': 0.38456451001313924, 'support': 112971}, 'accuracy': 0.39255890046473163, 'macro avg': {'precision': 0.4404932157728026, 'recall': 0.38049793050846903, 'f1-score': 0.3368564394307461, 'support': 333741}, 'weighted avg': {'precision': 0.4367718683206455, 'recall': 0.39255890046473163, 'f1-score': 0.3443884227844361, 'support': 333741}}
[[79563  3224 34235]
 [59922  7840 35986]
 [66211  3150 43610]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2555461
{'0': {'precision': 0.36347249151720795, 'recall': 0.707921522348429, 'f1-score': 0.48032749146740605, 'support': 33895}, '1': {'precision': 0.40264026402640263, 'recall': 0.04161240310077519, 'f1-score': 0.07542927802602367, 'support': 32250}, '2': {'precision': 0.3920476173997301, 'recall': 0.3529173545995452, 'f1-score': 0.37145480179678025, 'support': 32101}, 'accuracy': 0.37320603383343853, 'macro avg': {'precision': 0.38605345764778026, 'recall': 0.36748376001624977, 'f1-score': 0.3090705237634033, 'support': 98246}, 'weighted avg': {'precision': 0.38566627833169775, 'recall': 0.37320603383343853, 'f1-score': 0.3118433842813492, 'support': 98246}}
[[23995  1083  8817]
 [22157  1342  8751]
 [19864   908 11329]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2422878
{'0': {'precision': 0.37303761106286326, 'recall': 0.6845654039475297, 'f1-score': 0.48291965752832317, 'support': 8157}, '1': {'precision': 0.43654114365411434, 'recall': 0.04260242275758813, 'f1-score': 0.07762896825396826, 'support': 7347}, '2': {'precision': 0.39946956302096487, 'recall': 0.3904938271604938, 'f1-score': 0.3949307029591709, 'support': 8100}, 'accuracy': 0.38383324860193185, 'macro avg': {'precision': 0.4030161059126475, 'recall': 0.37255388462187056, 'f1-score': 0.31849310958048743, 'support': 23604}, 'weighted avg': {'precision': 0.40187421777395227, 'recall': 0.38383324860193185, 'f1-score': 0.32657407092822066, 'support': 23604}}
[[5584  236 2337]
 [4616  313 2418]
 [4769  168 3163]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98323965
{'0': {'precision': 0.5062651010811684, 'recall': 0.5579868804031453, 'f1-score': 0.530869172571849, 'support': 230190}, '1': {'precision': 0.5395059784571783, 'recall': 0.5394784976360597, 'f1-score': 0.5394922376966624, 'support': 215953}, '2': {'precision': 0.524210398506549, 'recall': 0.4684969412530689, 'f1-score': 0.4947902739045727, 'support': 221169}, 'accuracy': 0.5223373774186587, 'macro avg': {'precision': 0.5233271593482987, 'recall': 0.5219874397640912, 'f1-score': 0.5217172280576946, 'support': 667312}, 'weighted avg': {'precision': 0.5229700467111819, 'recall': 0.5223373774186587, 'f1-score': 0.5217020106499234, 'support': 667312}}
[[128443  50578  51169]
 [ 56574 116502  42877]
 [ 68690  48862 103617]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9515584
{'0': {'precision': 0.48391676866585065, 'recall': 0.5418364550022842, 'f1-score': 0.5112413793103449, 'support': 54725}, '1': {'precision': 0.6218330656442671, 'recall': 0.635001256563893, 'f1-score': 0.6283481777667252, 'support': 75603}, '2': {'precision': 0.5102919850219693, 'recall': 0.4337650868413306, 'f1-score': 0.46892683460463636, 'support': 54352}, 'accuracy': 0.5481698072341347, 'macro avg': {'precision': 0.538680606444029, 'recall': 0.5368675994691692, 'f1-score': 0.5361721305605688, 'support': 184680}, 'weighted avg': {'precision': 0.5481382954139933, 'recall': 0.5481698072341347, 'f1-score': 0.5467284117440305, 'support': 184680}}
[[29652 14634 10439]
 [15409 48008 12186]
 [16214 14562 23576]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9836137
{'0': {'precision': 0.4977828096990282, 'recall': 0.561934178293748, 'f1-score': 0.5279167500500299, 'support': 18778}, '1': {'precision': 0.5679270281288219, 'recall': 0.5411770418568516, 'f1-score': 0.5542294495002238, 'support': 20594}, '2': {'precision': 0.5091403447876894, 'recall': 0.46973740392826646, 'f1-score': 0.48864582754983066, 'support': 18736}, 'accuracy': 0.5248502787912164, 'macro avg': {'precision': 0.5249500608718466, 'recall': 0.5242828746929554, 'f1-score': 0.5235973423666948, 'support': 58108}, 'weighted avg': {'precision': 0.52630461068623, 'recall': 0.5248502787912164, 'f1-score': 0.5245799242861688, 'support': 58108}}
[[10552  4154  4072]
 [ 5036 11145  4413]
 [ 5610  4325  8801]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/EXC
Evaluating performance on  test set...
5343/5343 - 73s - 73s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6148663
{'0': {'precision': 0.38219766819344475, 'recall': 0.6639111874608474, 'f1-score': 0.4851221865938054, 'support': 154843}, '1': {'precision': 0.8763755053806087, 'recall': 0.8202466484279785, 'f1-score': 0.847382629584501, 'support': 1055997}, '2': {'precision': 0.4980669811406169, 'recall': 0.3505023924969258, 'f1-score': 0.4114540871659474, 'support': 156949}, 'accuracy': 0.7486469038718692, 'macro avg': {'precision': 0.5855467182382235, 'recall': 0.6115534094619172, 'f1-score': 0.5813196344480845, 'support': 1367789}, 'weighted avg': {'precision': 0.7770216405560529, 'recall': 0.7486469038718692, 'f1-score': 0.7563510139054321, 'support': 1367789}}
[[102802  41180  10861]
 [145242 866178  44577]
 [ 20932  81006  55011]]
Evaluating performance on  train set...
1290/1290 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60765374
{'0': {'precision': 0.3656972601852452, 'recall': 0.7100323828088156, 'f1-score': 0.4827549351773671, 'support': 31807}, '1': {'precision': 0.9420839173212764, 'recall': 0.7618626229001999, 'f1-score': 0.8424425383077949, 'support': 265561}, '2': {'precision': 0.39776750773359176, 'recall': 0.6505836813069584, 'f1-score': 0.49369152663898885, 'support': 32809}, 'accuracy': 0.7458120947249506, 'macro avg': {'precision': 0.5685162284133711, 'recall': 0.7074928956719914, 'f1-score': 0.606296333374717, 'support': 330177}, 'weighted avg': {'precision': 0.8324711717766501, 'recall': 0.7458120947249506, 'f1-score': 0.773138027289125, 'support': 330177}}
[[ 22584   5433   3790]
 [ 34713 202321  28527]
 [  4459   7005  21345]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6065731
{'0': {'precision': 0.3652732023173918, 'recall': 0.7084939958135948, 'f1-score': 0.48202975677397597, 'support': 9077}, '1': {'precision': 0.941398307863842, 'recall': 0.7675976309210263, 'f1-score': 0.8456604190448136, 'support': 74797}, '2': {'precision': 0.3992982456140351, 'recall': 0.6343366778149386, 'f1-score': 0.49009474590869945, 'support': 8970}, 'accuracy': 0.748944465985955, 'macro avg': {'precision': 0.5686565852650897, 'recall': 0.7034761015165198, 'f1-score': 0.6059283072424964, 'support': 92844}, 'weighted avg': {'precision': 0.8326984980600217, 'recall': 0.748944465985955, 'f1-score': 0.7757571446332917, 'support': 92844}}
[[ 6431  1620  1026]
 [ 9849 57414  7534]
 [ 1326  1954  5690]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/AAL
Evaluating performance on  test set...
7177/7177 - 96s - 96s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5911737
{'0': {'precision': 0.44395843907682203, 'recall': 0.5731907696607287, 'f1-score': 0.5003648967247627, 'support': 207533}, '1': {'precision': 0.8999203902571226, 'recall': 0.8212863610206065, 'f1-score': 0.8588071618634482, 'support': 1423193}, '2': {'precision': 0.4373513275547614, 'recall': 0.5728740132678823, 'f1-score': 0.4960224221267454, 'support': 206363}, 'accuracy': 0.7653548630469182, 'macro avg': {'precision': 0.5937433856295686, 'recall': 0.6557837146497393, 'f1-score': 0.6183981602383187, 'support': 1837089}, 'weighted avg': {'precision': 0.79645001342685, 'recall': 0.7653548630469182, 'f1-score': 0.7775623523537772, 'support': 1837089}}
[[ 118956   67343   21234]
 [ 123489 1168849  130855]
 [  25499   62644  118220]]
Evaluating performance on  train set...
2257/2257 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63288975
{'0': {'precision': 0.42245723453777145, 'recall': 0.5552915317670122, 'f1-score': 0.47985112936344965, 'support': 67334}, '1': {'precision': 0.8948199374024277, 'recall': 0.800908817972293, 'f1-score': 0.8452639327976138, 'support': 442993}, '2': {'precision': 0.3944667703742114, 'recall': 0.5429901261004044, 'f1-score': 0.4569630074585773, 'support': 67248}, 'accuracy': 0.7422447301216292, 'macro avg': {'precision': 0.5705813141048036, 'recall': 0.6330634919465699, 'f1-score': 0.594026023206547, 'support': 577575}, 'weighted avg': {'precision': 0.7814947068938318, 'recall': 0.7422447301216292, 'f1-score': 0.7574534037171732, 'support': 577575}}
[[ 37390  21001   8943]
 [ 41086 354797  47110]
 [ 10030  20703  36515]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56488967
{'0': {'precision': 0.47920166997607044, 'recall': 0.5298356226075208, 'f1-score': 0.5032482288464108, 'support': 17764}, '1': {'precision': 0.891710747052166, 'recall': 0.8718568513577146, 'f1-score': 0.8816720435867826, 'support': 127420}, '2': {'precision': 0.46152638190954776, 'recall': 0.4859457671957672, 'f1-score': 0.47342139175257736, 'support': 18144}, 'accuracy': 0.7917870787617555, 'macro avg': {'precision': 0.6108129329792614, 'recall': 0.6292127470536676, 'f1-score': 0.619447221395257, 'support': 163328}, 'weighted avg': {'precision': 0.7990562336415602, 'recall': 0.7917870787617555, 'f1-score': 0.7951613383070523, 'support': 163328}}
[[  9412   6486   1866]
 [  7907 111092   8421]
 [  2322   7005   8817]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/WBA
Evaluating performance on  test set...
5696/5696 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8744225
{'0': {'precision': 0.44375526420716616, 'recall': 0.5546669261779008, 'f1-score': 0.493050676844677, 'support': 339099}, '1': {'precision': 0.7369528600176869, 'recall': 0.6097175304584234, 'f1-score': 0.6673245079895106, 'support': 788616}, '2': {'precision': 0.4603494799717063, 'recall': 0.5319867154694543, 'f1-score': 0.4935823341792845, 'support': 330309}, 'accuracy': 0.5793045930656834, 'macro avg': {'precision': 0.5470192013988532, 'recall': 0.5654570573685929, 'f1-score': 0.5513191730044907, 'support': 1458024}, 'weighted avg': {'precision': 0.6060993230379391, 'recall': 0.5793045930656834, 'f1-score': 0.5874323487682195, 'support': 1458024}}
[[188087  90056  60956]
 [162749 480833 145034]
 [ 73017  81572 175720]]
Evaluating performance on  train set...
2222/2222 - 30s - 30s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75629437
{'0': {'precision': 0.46965463948166203, 'recall': 0.5185452568021152, 'f1-score': 0.49289053065916877, 'support': 106658}, '1': {'precision': 0.7995735155585038, 'recall': 0.7391833957318832, 'f1-score': 0.7681934190270264, 'support': 357113}, '2': {'precision': 0.4514360032141289, 'recall': 0.5197619410956814, 'f1-score': 0.48319553122159914, 'support': 104848}, 'accuracy': 0.6573382176817869, 'macro avg': {'precision': 0.5735547194180982, 'recall': 0.5924968645432266, 'f1-score': 0.5814264936359315, 'support': 568619}, 'weighted avg': {'precision': 0.6734961080520947, 'recall': 0.6573382176817869, 'f1-score': 0.6640028907327513, 'support': 568619}}
[[ 55307  33918  17433]
 [ 44353 263972  48788]
 [ 18101  32251  54496]]
Evaluating performance on  val set...
641/641 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77146935
{'0': {'precision': 0.45834214741168294, 'recall': 0.4979317137229153, 'f1-score': 0.47731743009551386, 'support': 30460}, '1': {'precision': 0.7974428418466964, 'recall': 0.73024570307994, 'f1-score': 0.7623664007225651, 'support': 104028}, '2': {'precision': 0.4240153265340621, 'recall': 0.5126196396335025, 'f1-score': 0.46412656315050965, 'support': 29359}, 'accuracy': 0.6480619114173589, 'macro avg': {'precision': 0.5599334385974805, 'recall': 0.5802656854787859, 'f1-score': 0.5679367979895296, 'support': 163847}, 'weighted avg': {'precision': 0.6674894977234953, 'recall': 0.6480619114173589, 'f1-score': 0.65593408864741, 'support': 163847}}
[[15167 10106  5187]
 [12805 75966 15257]
 [ 5119  9190 15050]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66790134
{'0': {'precision': 0.48633827223427156, 'recall': 0.574529650705879, 'f1-score': 0.5267682274665593, 'support': 528065}, '1': {'precision': 0.8172196292307626, 'recall': 0.8367175183375225, 'f1-score': 0.8268536456926554, 'support': 2034217}, '2': {'precision': 0.557362897234401, 'recall': 0.4046300516560316, 'f1-score': 0.46887199778175853, 'support': 526560}, 'accuracy': 0.7182355070282002, 'macro avg': {'precision': 0.6203069328998118, 'recall': 0.605292406899811, 'f1-score': 0.6074979569803244, 'support': 3088842}, 'weighted avg': {'precision': 0.7163543131730438, 'recall': 0.7182355070282002, 'f1-score': 0.7145256525808273, 'support': 3088842}}
[[ 303389  170173   54503]
 [ 217449 1702065  114703]
 [ 102985  210513  213062]]
Evaluating performance on  train set...
2948/2948 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7030529
{'0': {'precision': 0.4783744987595762, 'recall': 0.48005981273290954, 'f1-score': 0.47921567401548953, 'support': 127732}, '1': {'precision': 0.7989918816273911, 'recall': 0.8243689372741925, 'f1-score': 0.8114820570741044, 'support': 500703}, '2': {'precision': 0.49068317319087645, 'recall': 0.42702325323093765, 'f1-score': 0.4566452165724248, 'support': 126047}, 'accuracy': 0.6996959503341366, 'macro avg': {'precision': 0.5893498511926146, 'recall': 0.5771506677460132, 'f1-score': 0.5824476492206729, 'support': 754482}, 'weighted avg': {'precision': 0.6932047491036608, 'recall': 0.6996959503341366, 'f1-score': 0.6959495872795192, 'support': 754482}}
[[ 61319  52215  14198]
 [ 46268 412764  41671]
 [ 20595  51627  53825]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6390744
{'0': {'precision': 0.47671001395929763, 'recall': 0.5049416342412452, 'f1-score': 0.49041986319489056, 'support': 25700}, '1': {'precision': 0.8398032603459261, 'recall': 0.8475345817257928, 'f1-score': 0.8436512087174404, 'support': 127524}, '2': {'precision': 0.4976423487544484, 'recall': 0.44435176358436607, 'f1-score': 0.4694896760114151, 'support': 25176}, 'accuracy': 0.7412836322869956, 'macro avg': {'precision': 0.6047185410198906, 'recall': 0.598942659850468, 'f1-score': 0.6011869159745821, 'support': 178400}, 'weighted avg': {'precision': 0.7392105499066695, 'recall': 0.7412836322869956, 'f1-score': 0.7399632248198147, 'support': 178400}}
[[ 12977  10098   2625]
 [ 10775 108081   8668]
 [  3470  10519  11187]]
testing model on single stock: results/universal/W1/deepLOB_L2/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 282s - 282s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0871418
{'0': {'precision': 0.48896654172086546, 'recall': 0.49261322756509845, 'f1-score': 0.49078311070668934, 'support': 1805457}, '1': {'precision': 0.4294016246169458, 'recall': 0.6156279997669608, 'f1-score': 0.505921855402829, 'support': 1836601}, '2': {'precision': 0.48254849721253185, 'recall': 0.26828363097734353, 'f1-score': 0.34484369566588374, 'support': 1824159}, 'accuracy': 0.4590829452983663, 'macro avg': {'precision': 0.4669722211834477, 'recall': 0.45884161943646756, 'f1-score': 0.44718288725846733, 'support': 5466217}, 'weighted avg': {'precision': 0.4668114534815486, 'recall': 0.4590829452983663, 'f1-score': 0.4471674138264254, 'support': 5466217}}
[[ 889392  650769  265296]
 [ 446444 1130663  259494]
 [ 483086  851681  489392]]
Evaluating performance on  train set...
6073/6073 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94994944
{'0': {'precision': 0.45455655648893245, 'recall': 0.4447568661448151, 'f1-score': 0.4496033184015543, 'support': 393343}, '1': {'precision': 0.5997804562832222, 'recall': 0.7244814112772064, 'f1-score': 0.6562596146108951, 'support': 765491}, '2': {'precision': 0.47000971246214995, 'recall': 0.29104922672596784, 'f1-score': 0.35948848721686233, 'support': 395720}, 'accuracy': 0.5433712820526015, 'macro avg': {'precision': 0.5081155750781016, 'recall': 0.48676250138266314, 'f1-score': 0.4884504734097706, 'support': 1554554}, 'weighted avg': {'precision': 0.5300011606385163, 'recall': 0.5433712820526015, 'f1-score': 0.5284254717942175, 'support': 1554554}}
[[174942 169789  48612]
 [129647 554584  81260]
 [ 80274 200272 115174]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0260048
{'0': {'precision': 0.47389709986860523, 'recall': 0.43498687519214246, 'f1-score': 0.4536090948697504, 'support': 126859}, '1': {'precision': 0.5321041735425606, 'recall': 0.6992065447735449, 'f1-score': 0.6043165467625901, 'support': 202910}, '2': {'precision': 0.4445074071075852, 'recall': 0.2585541185334003, 'f1-score': 0.32693929801232496, 'support': 127424}, 'accuracy': 0.50307856856951, 'macro avg': {'precision': 0.48350289350625036, 'recall': 0.4642491794996959, 'f1-score': 0.46162164654822174, 'support': 457193}, 'weighted avg': {'precision': 0.49153920092614994, 'recall': 0.50307856856951, 'f1-score': 0.4851915488198667, 'support': 457193}}
[[ 55182  54167  17510]
 [ 37372 141876  23662]
 [ 23889  70589  32946]]
training model: results/universal/W1/deepLOB_L2/h20
Epoch 1/50
10622/10622 - 418s - loss: 2.8796 - accuracy20: 0.5123 - val_loss: 3.3039 - val_accuracy20: 0.4959 - 418s/epoch - 39ms/step
Epoch 2/50
10622/10622 - 414s - loss: 2.7257 - accuracy20: 0.5584 - val_loss: 3.1495 - val_accuracy20: 0.5215 - 414s/epoch - 39ms/step
Epoch 3/50
10622/10622 - 415s - loss: 2.6744 - accuracy20: 0.5687 - val_loss: 3.1451 - val_accuracy20: 0.5251 - 415s/epoch - 39ms/step
Epoch 4/50
10622/10622 - 415s - loss: 2.6503 - accuracy20: 0.5727 - val_loss: 3.1164 - val_accuracy20: 0.5285 - 415s/epoch - 39ms/step
Epoch 5/50
10622/10622 - 415s - loss: 2.6345 - accuracy20: 0.5756 - val_loss: 3.1483 - val_accuracy20: 0.5283 - 415s/epoch - 39ms/step
Epoch 6/50
10622/10622 - 415s - loss: 2.6231 - accuracy20: 0.5780 - val_loss: 3.1392 - val_accuracy20: 0.5301 - 415s/epoch - 39ms/step
Epoch 7/50
10622/10622 - 417s - loss: 2.6150 - accuracy20: 0.5793 - val_loss: 3.1148 - val_accuracy20: 0.5304 - 417s/epoch - 39ms/step
Epoch 8/50
10622/10622 - 417s - loss: 2.6086 - accuracy20: 0.5805 - val_loss: 3.1519 - val_accuracy20: 0.5295 - 417s/epoch - 39ms/step
Epoch 9/50
10622/10622 - 422s - loss: 2.6035 - accuracy20: 0.5815 - val_loss: 3.1175 - val_accuracy20: 0.5314 - 422s/epoch - 40ms/step
Epoch 10/50
10622/10622 - 421s - loss: 2.5987 - accuracy20: 0.5824 - val_loss: 3.1285 - val_accuracy20: 0.5322 - 421s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 422s - loss: 2.5949 - accuracy20: 0.5833 - val_loss: 3.1164 - val_accuracy20: 0.5315 - 422s/epoch - 40ms/step
Epoch 12/50
10622/10622 - 425s - loss: 2.5934 - accuracy20: 0.5836 - val_loss: 3.1273 - val_accuracy20: 0.5303 - 425s/epoch - 40ms/step
Epoch 13/50
10622/10622 - 419s - loss: 2.5888 - accuracy20: 0.5844 - val_loss: 3.1230 - val_accuracy20: 0.5321 - 419s/epoch - 39ms/step
Epoch 14/50
10622/10622 - 418s - loss: 2.5854 - accuracy20: 0.5849 - val_loss: 3.1154 - val_accuracy20: 0.5334 - 418s/epoch - 39ms/step
Epoch 15/50
10622/10622 - 432s - loss: 2.5824 - accuracy20: 0.5853 - val_loss: 3.1255 - val_accuracy20: 0.5339 - 432s/epoch - 41ms/step
Epoch 16/50
10622/10622 - 437s - loss: 2.5799 - accuracy20: 0.5861 - val_loss: 3.1182 - val_accuracy20: 0.5324 - 437s/epoch - 41ms/step
Epoch 17/50
10622/10622 - 434s - loss: 2.5773 - accuracy20: 0.5863 - val_loss: 3.1337 - val_accuracy20: 0.5319 - 434s/epoch - 41ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 489s - 489s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.004461
{'0': {'precision': 0.4980809325571162, 'recall': 0.49573179549727275, 'f1-score': 0.4969035876263847, 'support': 2931912}, '1': {'precision': 0.4936035033755174, 'recall': 0.6928029584855839, 'f1-score': 0.5764802847094466, 'support': 3175138}, '2': {'precision': 0.5145739581807146, 'recall': 0.2927029718025221, 'f1-score': 0.37314909215802683, 'support': 2939731}, 'accuracy': 0.4989238713748017, 'macro avg': {'precision': 0.502086131371116, 'recall': 0.4937459085951263, 'f1-score': 0.482177654831286, 'support': 9046781}, 'weighted avg': {'precision': 0.5018688658753521, 'recall': 0.4989238713748017, 'f1-score': 0.48461878357345445, 'support': 9046781}}
[[1453442 1036105  442365]
 [ 606031 2199745  369362]
 [ 858611 1220652  860468]]
Evaluating performance on  train set...
10622/10622 - 155s - 155s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93083316
{'0': {'precision': 0.4893689697374447, 'recall': 0.4341727254195828, 'f1-score': 0.46012142265120765, 'support': 735850}, '1': {'precision': 0.5919684750183634, 'recall': 0.7599919490254632, 'f1-score': 0.6655391194738893, 'support': 1247054}, '2': {'precision': 0.5050479398250277, 'recall': 0.319011432688517, 'f1-score': 0.39103023940745923, 'support': 735610}, 'accuracy': 0.5524727847640292, 'macro avg': {'precision': 0.528795128193612, 'recall': 0.5043920357111876, 'f1-score': 0.5055635938441854, 'support': 2718514}, 'weighted avg': {'precision': 0.5406766807312884, 'recall': 0.5524727847640292, 'f1-score': 0.5356563638682029, 'support': 2718514}}
[[319486 309754 106610]
 [175936 947751 123367]
 [157431 343511 234668]]
Evaluating performance on  val set...
3064/3064 - 44s - 44s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9678894
{'0': {'precision': 0.5015961220146606, 'recall': 0.41965100647000375, 'f1-score': 0.4569790470688173, 'support': 222411}, '1': {'precision': 0.5568393548415381, 'recall': 0.7485509531148247, 'f1-score': 0.6386176260968703, 'support': 339361}, '2': {'precision': 0.4839651175938489, 'recall': 0.3084736448564453, 'f1-score': 0.37678743363318745, 'support': 222006}, 'accuracy': 0.5305673290140831, 'macro avg': {'precision': 0.5141335314833492, 'recall': 0.49222520148042453, 'f1-score': 0.4907947022662917, 'support': 783778}, 'weighted avg': {'precision': 0.5205213916291628, 'recall': 0.5305673290140831, 'f1-score': 0.5129107400802934, 'support': 783778}}
[[ 93335  93451  35625]
 [ 47936 254029  37396]
 [ 44805 108718  68483]]
testing model out of sample: results/universal/W1/deepLOB_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 344s - 344s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7922706
{'0': {'precision': 0.5264489382144452, 'recall': 0.49102796959035605, 'f1-score': 0.5081219067313323, 'support': 1417182}, '1': {'precision': 0.7089724778514827, 'recall': 0.842829161228764, 'f1-score': 0.770127655227903, 'support': 3274087}, '2': {'precision': 0.5655465536272524, 'recall': 0.3555411608698462, 'f1-score': 0.43660353957138237, 'support': 1407927}, 'accuracy': 0.6486015533850691, 'macro avg': {'precision': 0.6003226565643934, 'recall': 0.563132763896322, 'f1-score': 0.5716177005102059, 'support': 6099196}, 'weighted avg': {'precision': 0.6334539494806705, 'recall': 0.6486015533850691, 'f1-score': 0.6322590839851023, 'support': 6099196}}
[[ 695876  535581  185725]
 [ 315773 2759496  198818]
 [ 310181  597170  500576]]
Evaluating performance on  train set...
6711/6711 - 99s - 99s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8107125
{'0': {'precision': 0.512635283064023, 'recall': 0.44932719400016574, 'f1-score': 0.4788980418188769, 'support': 386144}, '1': {'precision': 0.7078447765510821, 'recall': 0.8277864861065456, 'f1-score': 0.763131559689705, 'support': 946093}, '2': {'precision': 0.5219737460354752, 'recall': 0.3692957373370628, 'f1-score': 0.4325575665024481, 'support': 385041}, 'accuracy': 0.6398859124731116, 'macro avg': {'precision': 0.5808179352168601, 'recall': 0.5488031391479247, 'f1-score': 0.5581957226703433, 'support': 1717278}, 'weighted avg': {'precision': 0.6222750888745225, 'recall': 0.6398859124731116, 'f1-score': 0.6250993899213113, 'support': 1717278}}
[[173505 157967  54672]
 [ 87380 783163  75550]
 [ 77572 165275 142194]]
Evaluating performance on  val set...
1720/1720 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7710539
{'0': {'precision': 0.5313255880989084, 'recall': 0.4493994933059139, 'f1-score': 0.48694064136727006, 'support': 94337}, '1': {'precision': 0.7340590767889258, 'recall': 0.8547902172792106, 'f1-score': 0.7898376769738796, 'support': 252118}, '2': {'precision': 0.5265501368873913, 'recall': 0.374783185935459, 'f1-score': 0.4378893642572994, 'support': 93398}, 'accuracy': 0.665920205159451, 'macro avg': {'precision': 0.5973116005917418, 'recall': 0.5596576321735278, 'f1-score': 0.571555894199483, 'support': 439853}, 'weighted avg': {'precision': 0.646515763246734, 'recall': 0.665920205159451, 'f1-score': 0.6501417645687719, 'support': 439853}}
[[ 42395  37691  14251]
 [ 19387 215508  17223]
 [ 18009  40385  35004]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1330984
{'0': {'precision': 0.40855453170127903, 'recall': 0.492318401034157, 'f1-score': 0.446542251351006, 'support': 60339}, '1': {'precision': 0.37134730339325794, 'recall': 0.3382793522267207, 'f1-score': 0.3540428597154691, 'support': 49400}, '2': {'precision': 0.4183965984954884, 'recall': 0.36275834459290396, 'f1-score': 0.3885960366670836, 'support': 59949}, 'accuracy': 0.4017019471029183, 'macro avg': {'precision': 0.3994328111966752, 'recall': 0.3977853659512605, 'f1-score': 0.3963937159111863, 'support': 169688}, 'weighted avg': {'precision': 0.40119976874709146, 'recall': 0.4017019471029183, 'f1-score': 0.39914180128451926, 'support': 169688}}
[[29706 14776 15857]
 [18316 16711 14373]
 [24688 13514 21747]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1525747
{'0': {'precision': 0.3686665525504964, 'recall': 0.4402371097143441, 'f1-score': 0.40128560449029976, 'support': 19569}, '1': {'precision': 0.47629149704718765, 'recall': 0.31624029237094564, 'f1-score': 0.38010478391178015, 'support': 26268}, '2': {'precision': 0.369448549428327, 'recall': 0.4592478004447452, 'f1-score': 0.40948275862068967, 'support': 20686}, 'accuracy': 0.397185935691415, 'macro avg': {'precision': 0.40480219967533704, 'recall': 0.4052417341766783, 'f1-score': 0.39695771567425653, 'support': 66523}, 'weighted avg': {'precision': 0.41140768613517975, 'recall': 0.397185935691415, 'f1-score': 0.39547090183685196, 'support': 66523}}
[[8615 4492 6462]
 [8209 8307 9752]
 [6544 4642 9500]]
Evaluating performance on  val set...
51/51 - 1s - 979ms/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1609879
{'0': {'precision': 0.36964285714285716, 'recall': 0.4230965763924374, 'f1-score': 0.3945675482487491, 'support': 3914}, '1': {'precision': 0.45724305368222284, 'recall': 0.32836110034870203, 'f1-score': 0.3822302401623633, 'support': 5162}, '2': {'precision': 0.34506437768240344, 'recall': 0.42641209228321403, 'f1-score': 0.3814494128810343, 'support': 3771}, 'accuracy': 0.3860045146726862, 'macro avg': {'precision': 0.3906500961691612, 'recall': 0.3926232563414511, 'f1-score': 0.38608240043071557, 'support': 12847}, 'weighted avg': {'precision': 0.39762657073286534, 'recall': 0.3860045146726862, 'f1-score': 0.38575975866257517, 'support': 12847}}
[[1656 1043 1215]
 [1630 1695 1837]
 [1194  969 1608]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.681141
{'0': {'precision': 0.3632254397906451, 'recall': 0.5872347699737174, 'f1-score': 0.4488322717622081, 'support': 46799}, '1': {'precision': 0.8937137764958777, 'recall': 0.8010676471215904, 'f1-score': 0.844858436800162, 'support': 328011}, '2': {'precision': 0.4399018328431468, 'recall': 0.48885281385281387, 'f1-score': 0.4630873171281821, 'support': 46200}, 'accuracy': 0.7430369824944776, 'macro avg': {'precision': 0.5656136830432231, 'recall': 0.6257184103160406, 'f1-score': 0.585592675230184, 'support': 421010}, 'weighted avg': {'precision': 0.7849457294988363, 'recall': 0.7430369824944776, 'f1-score': 0.7589425340271717, 'support': 421010}}
[[ 27482  14789   4528]
 [ 41024 262759  24228]
 [  7155  16460  22585]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7194472
{'0': {'precision': 0.4789753504108265, 'recall': 0.5240798194894937, 'f1-score': 0.5005134766578562, 'support': 28364}, '1': {'precision': 0.8236988496228419, 'recall': 0.8254896123695344, 'f1-score': 0.824593258750963, 'support': 110853}, '2': {'precision': 0.4824317237484368, 'recall': 0.4317172665246742, 'f1-score': 0.4556677462373785, 'support': 27701}, 'accuracy': 0.7089229442001462, 'macro avg': {'precision': 0.5950353079273684, 'recall': 0.5937622327945674, 'f1-score': 0.5935914938820659, 'support': 166918}, 'weighted avg': {'precision': 0.7084855234057982, 'recall': 0.7089229442001462, 'f1-score': 0.7082978049267638, 'support': 166918}}
[[14865  9167  4332]
 [10847 91508  8498]
 [ 5323 10419 11959]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65375936
{'0': {'precision': 0.559166816304543, 'recall': 0.44935064935064933, 'f1-score': 0.4982798623889911, 'support': 6930}, '1': {'precision': 0.8299004074241738, 'recall': 0.8961808738160709, 'f1-score': 0.8617680759173841, 'support': 32730}, '2': {'precision': 0.5291054491352055, 'recall': 0.4291101055806938, 'f1-score': 0.4738902306987591, 'support': 6630}, 'accuracy': 0.7623892849427523, 'macro avg': {'precision': 0.6393908909546407, 'recall': 0.5915472095824713, 'f1-score': 0.6113127230017115, 'support': 46290}, 'weighted avg': {'precision': 0.7462872218567748, 'recall': 0.7623892849427523, 'f1-score': 0.7517960855619888, 'support': 46290}}
[[ 3114  2923   893]
 [ 1759 29332  1639]
 [  696  3089  2845]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0808157
{'0': {'precision': 0.51676348956282, 'recall': 0.49232729575284745, 'f1-score': 0.504249518601402, 'support': 127921}, '1': {'precision': 0.35018543966192356, 'recall': 0.6202109285041348, 'f1-score': 0.44762912106073344, 'support': 76424}, '2': {'precision': 0.5504244739938511, 'recall': 0.32978320194057004, 'f1-score': 0.4124498125228125, 'support': 131920}, 'accuracy': 0.457624195203188, 'macro avg': {'precision': 0.4724578010728649, 'recall': 0.48077380873251746, 'f1-score': 0.45477615072831595, 'support': 336265}, 'weighted avg': {'precision': 0.49211030288123114, 'recall': 0.457624195203188, 'f1-score': 0.45536731412714637, 'support': 336265}}
[[62979 40722 24220]
 [17711 47399 11314]
 [41182 47233 43505]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98307854
{'0': {'precision': 0.516667868387531, 'recall': 0.5013643678428995, 'f1-score': 0.5089010936982151, 'support': 42877}, '1': {'precision': 0.5240801373123134, 'recall': 0.7660440209141508, 'f1-score': 0.6223718129887037, 'support': 47432}, '2': {'precision': 0.5481802426343154, 'recall': 0.2894598366469148, 'f1-score': 0.3788647831229694, 'support': 43709}, 'accuracy': 0.525929352773508, 'macro avg': {'precision': 0.5296427494447199, 'recall': 0.518956075134655, 'f1-score': 0.5033792299366294, 'support': 134018}, 'weighted avg': {'precision': 0.52956877054689, 'recall': 0.525929352773508, 'f1-score': 0.5066505457005808, 'support': 134018}}
[[21497 15198  6182]
 [ 6851 36335  4246]
 [13259 17798 12652]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.061468
{'0': {'precision': 0.5182824905975763, 'recall': 0.48081023454157784, 'f1-score': 0.49884364002011056, 'support': 10318}, '1': {'precision': 0.3663003663003663, 'recall': 0.660420826293964, 'f1-score': 0.4712328767123288, 'support': 6511}, '2': {'precision': 0.5465096432838368, 'recall': 0.30964123392321824, 'f1-score': 0.39530864197530863, 'support': 10341}, 'accuracy': 0.45870445344129557, 'macro avg': {'precision': 0.47703083339392643, 'recall': 0.48362409825292, 'f1-score': 0.45512838623591595, 'support': 27170}, 'weighted avg': {'precision': 0.49260495561890444, 'recall': 0.45870445344129557, 'f1-score': 0.45282122210777104, 'support': 27170}}
[[4961 3594 1763]
 [1317 4300  894]
 [3294 3845 3202]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.188917
{'0': {'precision': 0.38363016802914074, 'recall': 0.591719959609559, 'f1-score': 0.4654772088476109, 'support': 115869}, '1': {'precision': 0.42268318061289567, 'recall': 0.11784688234028018, 'f1-score': 0.18430758422855137, 'support': 106859}, '2': {'precision': 0.3598687205040366, 'recall': 0.4059524560186645, 'f1-score': 0.381524030443359, 'support': 111013}, 'accuracy': 0.3782004608363971, 'macro avg': {'precision': 0.3887273563820243, 'recall': 0.3718397659895012, 'f1-score': 0.3437696078398404, 'support': 333741}, 'weighted avg': {'precision': 0.3882305506539399, 'recall': 0.3782004608363971, 'f1-score': 0.34752526673873213, 'support': 333741}}
[[68562  9398 37909]
 [52012 12593 42254]
 [58145  7802 45066]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2169151
{'0': {'precision': 0.3599949706320838, 'recall': 0.5940658624062601, 'f1-score': 0.4483167430936137, 'support': 33737}, '1': {'precision': 0.34167198468410975, 'recall': 0.08194061830425467, 'f1-score': 0.13218121219602516, 'support': 32670}, '2': {'precision': 0.3639818066670505, 'recall': 0.39712302522064136, 'f1-score': 0.3798308725235442, 'support': 31839}, 'accuracy': 0.3599434073651854, 'macro avg': {'precision': 0.35521625399441464, 'recall': 0.3577098353103854, 'f1-score': 0.320109609271061, 'support': 98246}, 'weighted avg': {'precision': 0.35519401101639453, 'recall': 0.3599434073651854, 'f1-score': 0.32099685803463257, 'support': 98246}}
[[20042  2905 10790]
 [18689  2677 11304]
 [16942  2253 12644]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1985279
{'0': {'precision': 0.36450351837372946, 'recall': 0.5736434108527132, 'f1-score': 0.44576182052875657, 'support': 8127}, '1': {'precision': 0.36693333333333333, 'recall': 0.09215108491829628, 'f1-score': 0.14730756878278556, 'support': 7466}, '2': {'precision': 0.37554536301599734, 'recall': 0.41904880788915244, 'f1-score': 0.3961061946902655, 'support': 8011}, 'accuracy': 0.36887815624470427, 'macro avg': {'precision': 0.3689940715743534, 'recall': 0.3616144345533873, 'f1-score': 0.32972519466726924, 'support': 23604}, 'weighted avg': {'precision': 0.36901958412180647, 'recall': 0.36887815624470427, 'f1-score': 0.33450734407868155, 'support': 23604}}
[[4662  687 2778]
 [3974  688 2804]
 [4154  500 3357]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0288045
{'0': {'precision': 0.5086497711149366, 'recall': 0.5190515577612351, 'f1-score': 0.5137980240636916, 'support': 253890}, '1': {'precision': 0.4081034652446608, 'recall': 0.5508955638489317, 'f1-score': 0.4688688554922802, 'support': 165594}, '2': {'precision': 0.5325778576688179, 'recall': 0.39690833965492195, 'f1-score': 0.45484181224625686, 'support': 247828}, 'accuracy': 0.4815918191190927, 'macro avg': {'precision': 0.4831103646761384, 'recall': 0.48895182042169627, 'f1-score': 0.4791695639340762, 'support': 667312}, 'weighted avg': {'precision': 0.49258559852429357, 'recall': 0.4815918191190927, 'f1-score': 0.48075350994929605, 'support': 667312}}
[[131782  65029  57079]
 [ 45117  91225  29252]
 [ 82183  67280  98365]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0123476
{'0': {'precision': 0.49732117835182404, 'recall': 0.48615721790698424, 'f1-score': 0.49167583425009165, 'support': 62054}, '1': {'precision': 0.4945255922425433, 'recall': 0.666021953316141, 'f1-score': 0.5676025978783056, 'support': 60492}, '2': {'precision': 0.526851394862394, 'recall': 0.36078475552837413, 'f1-score': 0.42828348442440506, 'support': 62134}, 'accuracy': 0.5028914879792072, 'macro avg': {'precision': 0.5062327218189204, 'recall': 0.5043213089171664, 'f1-score': 0.4958539721842674, 'support': 184680}, 'weighted avg': {'precision': 0.5063406708672299, 'recall': 0.5028914879792072, 'f1-score': 0.49521786111455296, 'support': 184680}}
[[30168 20095 11791]
 [11862 40289  8341]
 [18631 21086 22417]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0255164
{'0': {'precision': 0.5177202372341965, 'recall': 0.5044634467205412, 'f1-score': 0.511005877733622, 'support': 21284}, '1': {'precision': 0.42924528301886794, 'recall': 0.56280285641418, 'f1-score': 0.4870337673802692, 'support': 15684}, '2': {'precision': 0.5210949122285035, 'recall': 0.4142384105960265, 'f1-score': 0.46156278824614577, 'support': 21140}, 'accuracy': 0.4873855579266194, 'macro avg': {'precision': 0.48935347749385594, 'recall': 0.493834904576916, 'f1-score': 0.4865341444533457, 'support': 58108}, 'weighted avg': {'precision': 0.49506758092983966, 'recall': 0.4873855579266194, 'f1-score': 0.4865478772767618, 'support': 58108}}
[[10737  5633  4914]
 [ 3723  8827  3134]
 [ 6279  6104  8757]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/EXC
Evaluating performance on  test set...
5343/5343 - 79s - 79s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.680507
{'0': {'precision': 0.5005183446336435, 'recall': 0.5749325887296568, 'f1-score': 0.5351509746464517, 'support': 219177}, '1': {'precision': 0.7958209785953538, 'recall': 0.8575214709632324, 'f1-score': 0.8255199355350549, 'support': 927066}, '2': {'precision': 0.5905674558436678, 'recall': 0.3121067408122918, 'f1-score': 0.40838673478427784, 'support': 221546}, 'accuracy': 0.7238960102764388, 'macro avg': {'precision': 0.6289689263575551, 'recall': 0.5815202668350603, 'f1-score': 0.5896858816552614, 'support': 1367789}, 'weighted avg': {'precision': 0.715255451050264, 'recall': 0.7238960102764388, 'f1-score': 0.7114260293593121, 'support': 1367789}}
[[126012  78536  14629]
 [ 98778 794979  33309]
 [ 26973 125427  69146]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6275842
{'0': {'precision': 0.47168399168399167, 'recall': 0.6328803195643927, 'f1-score': 0.5405199359609668, 'support': 44811}, '1': {'precision': 0.8730556572926366, 'recall': 0.827201993469381, 'f1-score': 0.8495105195362818, 'support': 239181}, '2': {'precision': 0.5312780604609398, 'recall': 0.49962108909819203, 'f1-score': 0.5149635117945055, 'support': 46185}, 'accuracy': 0.755007162824788, 'macro avg': {'precision': 0.6253392364791893, 'recall': 0.6532344673773219, 'f1-score': 0.6349979890972514, 'support': 330177}, 'weighted avg': {'precision': 0.7707745655834597, 'recall': 0.755007162824788, 'f1-score': 0.7607786254517532, 'support': 330177}}
[[ 28360  12119   4332]
 [ 25304 197851  16026]
 [  6461  16649  23075]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63330334
{'0': {'precision': 0.46066835094166286, 'recall': 0.630293031659989, 'f1-score': 0.5322939127550175, 'support': 12729}, '1': {'precision': 0.8740443034993799, 'recall': 0.824470211915234, 'f1-score': 0.8485338047918063, 'support': 67527}, '2': {'precision': 0.5154718267837354, 'recall': 0.4803781379091198, 'f1-score': 0.49730663267404085, 'support': 12588}, 'accuracy': 0.7511955538322347, 'macro avg': {'precision': 0.6167281604082594, 'recall': 0.6450471271614476, 'f1-score': 0.6260447834069548, 'support': 92844}, 'weighted avg': {'precision': 0.7687540010888448, 'recall': 0.7511955538322347, 'f1-score': 0.7575568409777235, 'support': 92844}}
[[ 8023  3463  1243]
 [ 7412 55674  4441]
 [ 1981  4560  6047]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/AAL
Evaluating performance on  test set...
7177/7177 - 101s - 101s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6620525
{'0': {'precision': 0.5290147620981025, 'recall': 0.48653428165808876, 'f1-score': 0.5068860412923921, 'support': 283869}, '1': {'precision': 0.8181557638135063, 'recall': 0.8657910699188831, 'f1-score': 0.8412996656698093, 'support': 1272732}, '2': {'precision': 0.5394338972253372, 'recall': 0.4407603890362511, 'f1-score': 0.48513054551091006, 'support': 280488}, 'accuracy': 0.742293922613439, 'macro avg': {'precision': 0.6288681410456486, 'recall': 0.5976952468710743, 'f1-score': 0.6111054174910372, 'support': 1837089}, 'weighted avg': {'precision': 0.7309219357673244, 'recall': 0.742293922613439, 'f1-score': 0.7352455630577299, 'support': 1837089}}
[[ 138112  119895   25862]
 [  91121 1101920   79691]
 [  31841  125019  123628]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6906047
{'0': {'precision': 0.5033380242048973, 'recall': 0.4902625172708731, 'f1-score': 0.4967142357195629, 'support': 91194}, '1': {'precision': 0.8199055598758676, 'recall': 0.8487998526156929, 'f1-score': 0.8341025482050963, 'support': 396243}, '2': {'precision': 0.4961104108577467, 'recall': 0.4322927067385564, 'f1-score': 0.4620081692662481, 'support': 90138}, 'accuracy': 0.7271886767952214, 'macro avg': {'precision': 0.6064513316461705, 'recall': 0.5904516922083741, 'f1-score': 0.5976083177303024, 'support': 577575}, 'weighted avg': {'precision': 0.7193899437391341, 'recall': 0.7271886767952214, 'f1-score': 0.7227617995618973, 'support': 577575}}
[[ 44709  35804  10681]
 [ 31016 336331  28896]
 [ 13100  38072  38966]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64118695
{'0': {'precision': 0.5696296689867701, 'recall': 0.4420119562976706, 'f1-score': 0.49777138081530325, 'support': 24255}, '1': {'precision': 0.8207560650323892, 'recall': 0.9012762173753858, 'f1-score': 0.8591336286053798, 'support': 114714}, '2': {'precision': 0.5312584281784346, 'recall': 0.4043269428137444, 'f1-score': 0.45918224625856685, 'support': 24359}, 'accuracy': 0.7589574353448276, 'macro avg': {'precision': 0.6405480540658647, 'recall': 0.5825383721622669, 'f1-score': 0.60536241855975, 'support': 163328}, 'weighted avg': {'precision': 0.7402864353778782, 'recall': 0.7589574353448276, 'f1-score': 0.7458201915784505, 'support': 163328}}
[[ 10721  10819   2715]
 [  5350 103389   5975]
 [  2750  11760   9849]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/WBA
Evaluating performance on  test set...
5696/5696 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93170816
{'0': {'precision': 0.5019123791567857, 'recall': 0.4734482535036449, 'f1-score': 0.4872649794681011, 'support': 431836}, '1': {'precision': 0.5882922350733981, 'recall': 0.6789232179081984, 'f1-score': 0.6303667720697189, 'support': 607811}, '2': {'precision': 0.5200599033871758, 'recall': 0.43410608135724477, 'f1-score': 0.47321151736698247, 'support': 418377}, 'accuracy': 0.5478160853319287, 'macro avg': {'precision': 0.5367548392057865, 'recall': 0.5288258509230294, 'f1-score': 0.5302810896349341, 'support': 1458024}, 'weighted avg': {'precision': 0.5431292132757508, 'recall': 0.5478160853319287, 'f1-score': 0.542887656700782, 'support': 1458024}}
[[204452 147739  79645]
 [107190 412657  87964]
 [ 95704 141053 181620]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8283561
{'0': {'precision': 0.5267586358375643, 'recall': 0.45555766617473004, 'f1-score': 0.48857773059036935, 'support': 136874}, '1': {'precision': 0.6865727600519035, 'recall': 0.7893198456368155, 'f1-score': 0.734369835438973, 'support': 296962}, '2': {'precision': 0.5189309372215025, 'recall': 0.4190587833777257, 'f1-score': 0.46367793256877343, 'support': 134783}, 'accuracy': 0.621213853212784, 'macro avg': {'precision': 0.5774207777036567, 'recall': 0.554645431729757, 'f1-score': 0.5622084995327054, 'support': 568619}, 'weighted avg': {'precision': 0.6083663226232151, 'recall': 0.621213853212784, 'f1-score': 0.6110408307739832, 'support': 568619}}
[[ 62354  52390  22130]
 [ 32333 234398  30231]
 [ 23686  54615  56482]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.843331
{'0': {'precision': 0.5190756485720515, 'recall': 0.42307399416169567, 'f1-score': 0.46618371000223763, 'support': 39395}, '1': {'precision': 0.6878802203222624, 'recall': 0.7746134975004628, 'f1-score': 0.7286749978228686, 'support': 86416}, '2': {'precision': 0.4828327426944751, 'recall': 0.4370070459564623, 'f1-score': 0.4587783941928183, 'support': 38036}, 'accuracy': 0.6117170286914011, 'macro avg': {'precision': 0.5632628705295963, 'recall': 0.544898179206207, 'f1-score': 0.5512123673393082, 'support': 163847}, 'weighted avg': {'precision': 0.5996928140032569, 'recall': 0.6117170286914011, 'f1-score': 0.6029074738562025, 'support': 163847}}
[[16667 15436  7292]
 [ 8965 66939 10512]
 [ 6477 14937 16622]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 169s - 169s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7685147
{'0': {'precision': 0.5484834120102444, 'recall': 0.48212939639419355, 'f1-score': 0.5131703666173614, 'support': 691163}, '1': {'precision': 0.7014538663896508, 'recall': 0.8782493156180607, 'f1-score': 0.7799583935906083, 'support': 1709937}, '2': {'precision': 0.6271013155807299, 'recall': 0.31036929546254266, 'f1-score': 0.4152300695246877, 'support': 687742}, 'accuracy': 0.6631724769347218, 'macro avg': {'precision': 0.625679531326875, 'recall': 0.556916002491599, 'f1-score': 0.5694529432442191, 'support': 3088842}, 'weighted avg': {'precision': 0.6506701454487083, 'recall': 0.6631724769347218, 'f1-score': 0.6390534848459543, 'support': 3088842}}
[[ 333230  295221   62712]
 [ 143970 1501751   64216]
 [ 130348  343940  213454]]
Evaluating performance on  train set...
2948/2948 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7924967
{'0': {'precision': 0.5544386854429818, 'recall': 0.4035318275154004, 'f1-score': 0.46709925400754476, 'support': 170450}, '1': {'precision': 0.6855690224971196, 'recall': 0.8703862309879757, 'f1-score': 0.7670012826356573, 'support': 415658}, '2': {'precision': 0.5730822778031992, 'recall': 0.3495967310867474, 'f1-score': 0.43427386779889854, 'support': 168374}, 'accuracy': 0.6486940708989744, 'macro avg': {'precision': 0.6043633285811002, 'recall': 0.5411715965300411, 'f1-score': 0.5561248014807002, 'support': 754482}, 'weighted avg': {'precision': 0.6308413959904939, 'recall': 0.6486940708989744, 'f1-score': 0.6249953149314759, 'support': 754482}}
[[ 68782  82246  19422]
 [ 29447 361783  24428]
 [ 25828  83683  58863]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7342741
{'0': {'precision': 0.5468390696271723, 'recall': 0.41966093849447433, 'f1-score': 0.47488255610299057, 'support': 34566}, '1': {'precision': 0.740008669926762, 'recall': 0.8841949348914555, 'f1-score': 0.8057018415474299, 'support': 110047}, '2': {'precision': 0.5661302982731554, 'recall': 0.34155148429869475, 'f1-score': 0.4260582230344649, 'support': 33787}, 'accuracy': 0.6914181614349776, 'macro avg': {'precision': 0.6176593459423633, 'recall': 0.5484691192282082, 'f1-score': 0.5688808735616284, 'support': 178400}, 'weighted avg': {'precision': 0.6696503238112014, 'recall': 0.6914181614349776, 'f1-score': 0.6697034202505125, 'support': 178400}}
[[14506 16542  3518]
 [ 7418 97303  5326]
 [ 4603 17644 11540]]
testing model on single stock: results/universal/W1/deepLOB_L2/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 294s - 294s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1184776
{'0': {'precision': 0.5122633937012077, 'recall': 0.4847696025598719, 'f1-score': 0.4981374191260544, 'support': 2118231}, '1': {'precision': 0.29467195741743274, 'recall': 0.5945722176455607, 'f1-score': 0.39405095723506967, 'support': 1205391}, '2': {'precision': 0.5269542158610205, 'recall': 0.2531985746256292, 'f1-score': 0.3420459632420163, 'support': 2142595}, 'accuracy': 0.41821391283953785, 'macro avg': {'precision': 0.44462985565988694, 'recall': 0.44418013161035397, 'f1-score': 0.4114114465343801, 'support': 5466217}, 'weighted avg': {'precision': 0.47003926010606656, 'recall': 0.41821391283953785, 'f1-score': 0.4140014147733006, 'support': 5466217}}
[[1026854  785880  305497]
 [ 307193  716692  181506]
 [ 670496  929597  542502]]
Evaluating performance on  train set...
6073/6073 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0372669
{'0': {'precision': 0.5009909461796384, 'recall': 0.3950522696234636, 'f1-score': 0.4417590733538089, 'support': 492064}, '1': {'precision': 0.46126918539885275, 'recall': 0.7429290009658294, 'f1-score': 0.5691592280490455, 'support': 567388}, '2': {'precision': 0.5176200557984922, 'recall': 0.26418798550601696, 'f1-score': 0.34982756015335714, 'support': 495102}, 'accuracy': 0.4803435583453518, 'macro avg': {'precision': 0.4932933957923278, 'recall': 0.46738975203177, 'f1-score': 0.4535819538520705, 'support': 1554554}, 'weighted avg': {'precision': 0.4917892426843756, 'recall': 0.4803435583453518, 'f1-score': 0.45897934548565555, 'support': 1554554}}
[[194391 232979  64694]
 [ 88658 421529  57201]
 [104964 259338 130800]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1004444
{'0': {'precision': 0.5135460056215924, 'recall': 0.39076209495587194, 'f1-score': 0.44381845719344715, 'support': 155230}, '1': {'precision': 0.3922721431778421, 'recall': 0.697890126840286, 'f1-score': 0.5022423969116866, 'support': 145222}, '2': {'precision': 0.4886325622886028, 'recall': 0.2516189127286415, 'f1-score': 0.33218223319042844, 'support': 156741}, 'accuracy': 0.44061479506466633, 'macro avg': {'precision': 0.4648169036960124, 'recall': 0.4467570448415998, 'f1-score': 0.4260810290985207, 'support': 457193}, 'weighted avg': {'precision': 0.46648362524117876, 'recall': 0.44061479506466633, 'f1-score': 0.424103518398026, 'support': 457193}}
[[ 60658  71335  23237]
 [ 25836 101349  18037]
 [ 31622  85680  39439]]
training model: results/universal/W1/deepLOB_L2/h30
Epoch 1/50
10622/10622 - 439s - loss: 2.9648 - accuracy30: 0.4921 - val_loss: 3.4680 - val_accuracy30: 0.4496 - 439s/epoch - 41ms/step
Epoch 2/50
10622/10622 - 436s - loss: 2.8372 - accuracy30: 0.5308 - val_loss: 3.2511 - val_accuracy30: 0.4749 - 436s/epoch - 41ms/step
Epoch 3/50
10622/10622 - 432s - loss: 2.7711 - accuracy30: 0.5467 - val_loss: 3.1896 - val_accuracy30: 0.4892 - 432s/epoch - 41ms/step
Epoch 4/50
10622/10622 - 436s - loss: 2.7443 - accuracy30: 0.5522 - val_loss: 3.1478 - val_accuracy30: 0.4958 - 436s/epoch - 41ms/step
Epoch 5/50
10622/10622 - 433s - loss: 2.7297 - accuracy30: 0.5550 - val_loss: 3.1203 - val_accuracy30: 0.4985 - 433s/epoch - 41ms/step
Epoch 6/50
10622/10622 - 428s - loss: 2.7197 - accuracy30: 0.5570 - val_loss: 3.1067 - val_accuracy30: 0.5003 - 428s/epoch - 40ms/step
Epoch 7/50
10622/10622 - 427s - loss: 2.7119 - accuracy30: 0.5588 - val_loss: 3.1030 - val_accuracy30: 0.5005 - 427s/epoch - 40ms/step
Epoch 8/50
10622/10622 - 429s - loss: 2.7057 - accuracy30: 0.5600 - val_loss: 3.1351 - val_accuracy30: 0.4987 - 429s/epoch - 40ms/step
Epoch 9/50
10622/10622 - 428s - loss: 2.7007 - accuracy30: 0.5610 - val_loss: 3.1453 - val_accuracy30: 0.4994 - 428s/epoch - 40ms/step
Epoch 10/50
10622/10622 - 427s - loss: 2.6962 - accuracy30: 0.5618 - val_loss: 3.1879 - val_accuracy30: 0.4984 - 427s/epoch - 40ms/step
Epoch 11/50
10622/10622 - 431s - loss: 2.6923 - accuracy30: 0.5627 - val_loss: 3.1898 - val_accuracy30: 0.4976 - 431s/epoch - 41ms/step
Epoch 12/50
10622/10622 - 428s - loss: 2.6889 - accuracy30: 0.5633 - val_loss: 3.1962 - val_accuracy30: 0.4956 - 428s/epoch - 40ms/step
Epoch 13/50
10622/10622 - 428s - loss: 2.6861 - accuracy30: 0.5638 - val_loss: 3.2377 - val_accuracy30: 0.4950 - 428s/epoch - 40ms/step
Epoch 14/50
10622/10622 - 430s - loss: 2.6830 - accuracy30: 0.5646 - val_loss: 3.2059 - val_accuracy30: 0.4972 - 430s/epoch - 41ms/step
Epoch 15/50
10622/10622 - 428s - loss: 2.6802 - accuracy30: 0.5653 - val_loss: 3.2201 - val_accuracy30: 0.4953 - 428s/epoch - 40ms/step
Epoch 16/50
10622/10622 - 427s - loss: 2.6781 - accuracy30: 0.5655 - val_loss: 3.2469 - val_accuracy30: 0.4939 - 427s/epoch - 40ms/step
Epoch 17/50
10622/10622 - 429s - loss: 2.6760 - accuracy30: 0.5660 - val_loss: 3.2084 - val_accuracy30: 0.4980 - 429s/epoch - 40ms/step
testing model in sample: results/universal/W1/deepLOB_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 490s - 490s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0350213
{'0': {'precision': 0.4780833923935867, 'recall': 0.5280699379246506, 'f1-score': 0.5018349783014412, 'support': 3087538}, '1': {'precision': 0.4612309185410155, 'recall': 0.5889624624049014, 'f1-score': 0.5173289080845584, 'support': 2869390}, '2': {'precision': 0.5031940879966174, 'recall': 0.3212117210754039, 'f1-score': 0.39211717642382926, 'support': 3089853}, 'accuracy': 0.47673266325337155, 'macro avg': {'precision': 0.4808361329770732, 'recall': 0.4794147071349853, 'f1-score': 0.47042702093660954, 'support': 9046781}, 'weighted avg': {'precision': 0.4813146011730721, 'recall': 0.47673266325337155, 'f1-score': 0.4692760214631397, 'support': 9046781}}
[[1630436  895836  561266]
 [ 760796 1689963  418631]
 [1019127 1078229  992497]]
Evaluating performance on  train set...
10622/10622 - 151s - 151s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9762856
{'0': {'precision': 0.47562834483203303, 'recall': 0.4649872162744139, 'f1-score': 0.4702475893222563, 'support': 793196}, '1': {'precision': 0.5519443463521435, 'recall': 0.6909662234686859, 'f1-score': 0.6136803561318329, 'support': 1131022}, '2': {'precision': 0.4982889575160671, 'recall': 0.33070794766686473, 'f1-score': 0.39756027424212614, 'support': 794296}, 'accuracy': 0.5197707276843158, 'macro avg': {'precision': 0.5086205495667478, 'recall': 0.49555379580332143, 'f1-score': 0.4938294065654052, 'support': 2718514}, 'weighted avg': {'precision': 0.5140001577723953, 'recall': 0.5197707276843158, 'f1-score': 0.508684165762037, 'support': 2718514}}
[[368826 297341 127029]
 [212069 781498 137455]
 [194555 337061 262680]]
Evaluating performance on  val set...
3064/3064 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.003876
{'0': {'precision': 0.4911851834573488, 'recall': 0.44138324229377757, 'f1-score': 0.4649544266233307, 'support': 238541}, '1': {'precision': 0.515082543642717, 'recall': 0.6886091668915206, 'f1-score': 0.5893378813762096, 'support': 307607}, '2': {'precision': 0.47725462430303567, 'recall': 0.31769978538063376, 'f1-score': 0.3814651252096934, 'support': 237630}, 'accuracy': 0.5009122481110723, 'macro avg': {'precision': 0.4945074504677005, 'recall': 0.48256406485531067, 'f1-score': 0.47858581106974457, 'support': 783778}, 'weighted avg': {'precision': 0.4963405673832833, 'recall': 0.5009122481110723, 'f1-score': 0.4884580956102711, 'support': 783778}}
[[105288  91022  42231]
 [ 55326 211821  40460]
 [ 53741 108394  75495]]
testing model out of sample: results/universal/W1/deepLOB_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 334s - 334s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87245244
{'0': {'precision': 0.49597472047230257, 'recall': 0.5399188423109113, 'f1-score': 0.5170146943927371, 'support': 1593934}, '1': {'precision': 0.6627017885558619, 'recall': 0.750988416690007, 'f1-score': 0.7040883003623072, 'support': 2924121}, '2': {'precision': 0.5374472322769951, 'recall': 0.3570282473226613, 'f1-score': 0.4290421543006477, 'support': 1581141}, 'accuracy': 0.5936992351123, 'macro avg': {'precision': 0.5653745804350532, 'recall': 0.5493118354411932, 'f1-score': 0.550048383018564, 'support': 6099196}, 'weighted avg': {'precision': 0.5866594615166876, 'recall': 0.5936992351123, 'f1-score': 0.5838970949169371, 'support': 6099196}}
[[ 860595  524063  209276]
 [ 451570 2195981  276570]
 [ 422994  593635  564512]]
Evaluating performance on  train set...
6711/6711 - 95s - 95s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8890064
{'0': {'precision': 0.4892478298372149, 'recall': 0.4889371350492562, 'f1-score': 0.4890924331012119, 'support': 436189}, '1': {'precision': 0.6580511630721211, 'recall': 0.7450510719921384, 'f1-score': 0.6988538856544595, 'support': 846648}, '2': {'precision': 0.5127732477446217, 'recall': 0.3809838390023041, 'f1-score': 0.437162006008782, 'support': 434441}, 'accuracy': 0.5878954950800045, 'macro avg': {'precision': 0.5533574135513192, 'recall': 0.5383240153478995, 'f1-score': 0.5417027749214844, 'support': 1717278}, 'weighted avg': {'precision': 0.578422331902564, 'recall': 0.5878954950800045, 'f1-score': 0.5793710062878711, 'support': 1717278}}
[[213269 159002  63918]
 [122501 630796  93351]
 [100142 168784 165515]]
Evaluating performance on  val set...
1720/1720 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8513713
{'0': {'precision': 0.49612164606291137, 'recall': 0.5019288631497534, 'f1-score': 0.4990083597848867, 'support': 106021}, '1': {'precision': 0.698269684036183, 'recall': 0.7654969228754747, 'f1-score': 0.7303395116994742, 'support': 229110}, '2': {'precision': 0.4978691524507817, 'recall': 0.3871010866866561, 'f1-score': 0.4355529291681216, 'support': 104722}, 'accuracy': 0.611877149865978, 'macro avg': {'precision': 0.5640868275166253, 'recall': 0.5515089575706281, 'f1-score': 0.5549669335508275, 'support': 439853}, 'weighted avg': {'precision': 0.6018322797155335, 'recall': 0.611877149865978, 'f1-score': 0.6043960702474782, 'support': 439853}}
[[ 53215  36426  16380]
 [ 29222 175383  24505]
 [ 24825  39359  40538]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/LILAK
Evaluating performance on  test set...
663/663 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1134017
{'0': {'precision': 0.4219363707776905, 'recall': 0.5934991789567379, 'f1-score': 0.49322458662007307, 'support': 65161}, '1': {'precision': 0.3091887176504798, 'recall': 0.267786536378976, 'f1-score': 0.2870021728275099, 'support': 39707}, '2': {'precision': 0.44885660602172217, 'recall': 0.3022061092255477, 'f1-score': 0.36121406575574855, 'support': 64820}, 'accuracy': 0.40600985337796425, 'macro avg': {'precision': 0.39332723148329746, 'recall': 0.3878306081870872, 'f1-score': 0.38048027506777715, 'support': 169688}, 'weighted avg': {'precision': 0.4058368150388992, 'recall': 0.40600985337796425, 'f1-score': 0.3945411479155871, 'support': 169688}}
[[38673 11677 14811]
 [19832 10633  9242]
 [33151 12080 19589]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1363127
{'0': {'precision': 0.3925785091457418, 'recall': 0.5477998353307109, 'f1-score': 0.4573785517873511, 'support': 21862}, '1': {'precision': 0.39703520691785055, 'recall': 0.29717984281091075, 'f1-score': 0.3399259650978318, 'support': 21630}, '2': {'precision': 0.41968023402431026, 'recall': 0.3612956450002171, 'f1-score': 0.38830556722198883, 'support': 23031}, 'accuracy': 0.40174075131909265, 'macro avg': {'precision': 0.4030979833626342, 'recall': 0.40209177438061294, 'f1-score': 0.39520336136905726, 'support': 66523}, 'weighted avg': {'precision': 0.40341052511749625, 'recall': 0.40174075131909265, 'f1-score': 0.39527492811404774, 'support': 66523}}
[[11976  4594  5292]
 [ 8988  6428  6214]
 [ 9542  5168  8321]]
Evaluating performance on  val set...
51/51 - 1s - 876ms/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1435628
{'0': {'precision': 0.3869523504956828, 'recall': 0.5581180811808119, 'f1-score': 0.45703493862134087, 'support': 4336}, '1': {'precision': 0.38265149184866193, 'recall': 0.2878297084683017, 'f1-score': 0.3285355869536511, 'support': 4322}, '2': {'precision': 0.39587073608617596, 'recall': 0.31582716638815944, 'f1-score': 0.3513477625813305, 'support': 4189}, 'accuracy': 0.388184011831556, 'macro avg': {'precision': 0.3884915261435069, 'recall': 0.387258318679091, 'f1-score': 0.37897276271877417, 'support': 12847}, 'weighted avg': {'precision': 0.3884134547352836, 'recall': 0.388184011831556, 'f1-score': 0.37934382175830994, 'support': 12847}}
[[2420  989  927]
 [1986 1244 1092]
 [1848 1018 1323]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.83455276
{'0': {'precision': 0.3125411617492097, 'recall': 0.6712934311731943, 'f1-score': 0.4265083386227932, 'support': 56555}, '1': {'precision': 0.8740397833830369, 'recall': 0.6442051833196294, 'f1-score': 0.7417260998477442, 'support': 308914}, '2': {'precision': 0.38846287662653955, 'recall': 0.502565672206118, 'f1-score': 0.4382084209865302, 'support': 55541}, 'accuracy': 0.6291584522932947, 'macro avg': {'precision': 0.5250146072529288, 'recall': 0.6060214288996472, 'f1-score': 0.5354809531523559, 'support': 421010}, 'weighted avg': {'precision': 0.7345538293091105, 'recall': 0.6291584522932947, 'f1-score': 0.659341320655545, 'support': 421010}}
[[ 37965  13594   4996]
 [ 70964 199004  38946]
 [ 12543  15085  27913]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81434005
{'0': {'precision': 0.46133036684954365, 'recall': 0.5514521442171114, 'f1-score': 0.5023815423584153, 'support': 33089}, '1': {'precision': 0.7895786818820806, 'recall': 0.7528408810920022, 'f1-score': 0.7707722656387954, 'support': 101465}, '2': {'precision': 0.4625257176447536, 'recall': 0.4376158694846125, 'f1-score': 0.44972612526792094, 'support': 32364}, 'accuracy': 0.651799086976839, 'macro avg': {'precision': 0.5711449221254593, 'recall': 0.5806362982645754, 'f1-score': 0.5742933110883772, 'support': 166918}, 'weighted avg': {'precision': 0.6610955306899476, 'recall': 0.651799086976839, 'f1-score': 0.6553196605896846, 'support': 166918}}
[[18247  9291  5551]
 [14171 76387 10907]
 [ 7135 11066 14163]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7584427
{'0': {'precision': 0.521325159775662, 'recall': 0.4866082298514731, 'f1-score': 0.5033688054908382, 'support': 8214}, '1': {'precision': 0.7937177684013127, 'recall': 0.840671345338983, 'f1-score': 0.8165201035319839, 'support': 30208}, '2': {'precision': 0.5105612552806277, 'recall': 0.4300965937976614, 'f1-score': 0.46688741721854304, 'support': 7868}, 'accuracy': 0.7080578958738388, 'macro avg': {'precision': 0.6085347278192007, 'recall': 0.5857920563293725, 'f1-score': 0.5955921087471218, 'support': 46290}, 'weighted avg': {'precision': 0.6972539893456928, 'recall': 0.7080578958738388, 'f1-score': 0.7015247538231024, 'support': 46290}}
[[ 3997  3180  1037]
 [ 2606 25395  2207]
 [ 1064  3420  3384]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0869105
{'0': {'precision': 0.49099291924855615, 'recall': 0.5312367126283181, 'f1-score': 0.5103226441723833, 'support': 131704}, '1': {'precision': 0.3163132918281162, 'recall': 0.5200566912901563, 'f1-score': 0.3933685982988354, 'support': 69852}, '2': {'precision': 0.5318736457976965, 'recall': 0.3116050152551054, 'f1-score': 0.392978514253616, 'support': 134709}, 'accuracy': 0.440929029188289, 'macro avg': {'precision': 0.44639328562478964, 'recall': 0.45429947305785995, 'f1-score': 0.43222325224161157, 'support': 336265}, 'weighted avg': {'precision': 0.47108386079208747, 'recall': 0.440929029188289, 'f1-score': 0.4390194029501737, 'support': 336265}}
[[69966 36726 25012]
 [21592 36327 11933]
 [50941 41792 41976]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0403006
{'0': {'precision': 0.4994476383722241, 'recall': 0.4940895708805424, 'f1-score': 0.4967541568095435, 'support': 44836}, '1': {'precision': 0.46643920408224887, 'recall': 0.704487413352791, 'f1-score': 0.561265827383872, 'support': 43856}, '2': {'precision': 0.528068303094984, 'recall': 0.27291179455500153, 'f1-score': 0.359849311282745, 'support': 45326}, 'accuracy': 0.48813592204032297, 'macro avg': {'precision': 0.4979850485164857, 'recall': 0.4904962595961116, 'f1-score': 0.4726230984920535, 'support': 134018}, 'weighted avg': {'precision': 0.4983257171004746, 'recall': 0.48813592204032297, 'f1-score': 0.4715625765468928, 'support': 134018}}
[[22153 16443  6240]
 [ 8145 30896  4815]
 [14057 18899 12370]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0639507
{'0': {'precision': 0.49713983983103055, 'recall': 0.5320210962516482, 'f1-score': 0.5139893544424731, 'support': 10618}, '1': {'precision': 0.33544303797468356, 'recall': 0.5710620831195485, 'f1-score': 0.4226314790203152, 'support': 5847}, '2': {'precision': 0.5347684947889971, 'recall': 0.2923867351704811, 'f1-score': 0.37806498369368285, 'support': 10705}, 'accuracy': 0.4460066249539934, 'macro avg': {'precision': 0.4557837908649038, 'recall': 0.46515663818055925, 'f1-score': 0.43822860571882377, 'support': 27170}, 'weighted avg': {'precision': 0.47716831060287346, 'recall': 0.4460066249539934, 'f1-score': 0.4407747837225925, 'support': 27170}}
[[5649 3175 1794]
 [1579 3339  929]
 [4135 3440 3130]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1919365
{'0': {'precision': 0.37292816305002263, 'recall': 0.646970468651537, 'f1-score': 0.47313233084605383, 'support': 115843}, '1': {'precision': 0.3672388160562238, 'recall': 0.1272597838101126, 'f1-score': 0.18901866395831743, 'support': 106758}, '2': {'precision': 0.3614750931852115, 'recall': 0.3115080079179413, 'f1-score': 0.33463659341668395, 'support': 111140}, 'accuracy': 0.36901069991400515, 'macro avg': {'precision': 0.36721402409715265, 'recall': 0.3619127534598636, 'f1-score': 0.3322625294070184, 'support': 333741}, 'weighted avg': {'precision': 0.36729422088786967, 'recall': 0.36901069991400515, 'f1-score': 0.33612841730980525, 'support': 333741}}
[[74947 12569 28327]
 [60343 13586 32829]
 [65679 10840 34621]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2185881
{'0': {'precision': 0.3572866631790872, 'recall': 0.6685453251067869, 'f1-score': 0.4656948333040612, 'support': 33712}, '1': {'precision': 0.3360138348465197, 'recall': 0.11942224953902889, 'f1-score': 0.17621584854324904, 'support': 32540}, '2': {'precision': 0.36550847457627117, 'recall': 0.26961305244733386, 'f1-score': 0.3103212576896787, 'support': 31994}, 'accuracy': 0.356757527024001, 'macro avg': {'precision': 0.35293632420062604, 'recall': 0.3525268756977165, 'f1-score': 0.31741064651232964, 'support': 98246}, 'weighted avg': {'precision': 0.3529183509821505, 'recall': 0.356757527024001, 'f1-score': 0.31921896311775966, 'support': 98246}}
[[22538  4016  7158]
 [20838  3886  7816]
 [19705  3663  8626]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.20137
{'0': {'precision': 0.36126392056889844, 'recall': 0.6655543196143864, 'f1-score': 0.4683219550376136, 'support': 8091}, '1': {'precision': 0.3510565780504431, 'recall': 0.1374799786438868, 'f1-score': 0.19758296566276615, 'support': 7492}, '2': {'precision': 0.380117973629424, 'recall': 0.2731579603540706, 'f1-score': 0.3178817555313747, 'support': 8021}, 'accuracy': 0.3645992204711066, 'macro avg': {'precision': 0.36414615741625517, 'recall': 0.35873075287078127, 'f1-score': 0.32792889207725145, 'support': 23604}, 'weighted avg': {'precision': 0.3644309663852943, 'recall': 0.3645992204711066, 'f1-score': 0.3312664835651556, 'support': 23604}}
[[5385 1006 1700]
 [4589 1030 1873]
 [4932  898 2191]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0663466
{'0': {'precision': 0.45985232363507034, 'recall': 0.5724521419838584, 'f1-score': 0.5100112542927346, 'support': 246197}, '1': {'precision': 0.40097512741349295, 'recall': 0.42609546165884193, 'f1-score': 0.4131538088438121, 'support': 178920}, '2': {'precision': 0.4968307342620473, 'recall': 0.3501723817585004, 'f1-score': 0.41080463166358683, 'support': 242195}, 'accuracy': 0.45253644472150956, 'macro avg': {'precision': 0.4525527284368702, 'recall': 0.4495733284670669, 'f1-score': 0.44465656493337785, 'support': 667312}, 'weighted avg': {'precision': 0.4574871304628152, 'recall': 0.45253644472150956, 'f1-score': 0.44803562354221965, 'support': 667312}}
[[140936  54753  50508]
 [ 67299  76237  35384]
 [ 98246  59139  84810]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0542825
{'0': {'precision': 0.4597152283382532, 'recall': 0.5133135138628578, 'f1-score': 0.4850381679389313, 'support': 61892}, '1': {'precision': 0.47063169560398965, 'recall': 0.5891329479768787, 'f1-score': 0.523257007906356, 'support': 60550}, '2': {'precision': 0.5042487932421561, 'recall': 0.3222629261865741, 'f1-score': 0.3932205383574804, 'support': 62238}, 'accuracy': 0.473787091184752, 'macro avg': {'precision': 0.4781985723947996, 'recall': 0.47490312934210355, 'f1-score': 0.4671719047342558, 'support': 184680}, 'weighted avg': {'precision': 0.47830236341205357, 'recall': 0.473787091184752, 'f1-score': 0.46662580672026777, 'support': 184680}}
[[31770 19422 10700]
 [15859 35672  9019]
 [21479 20702 20057]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0593984
{'0': {'precision': 0.47404099857925713, 'recall': 0.5522296306804748, 'f1-score': 0.5101568301952732, 'support': 21147}, '1': {'precision': 0.41745216458768414, 'recall': 0.46052303860523036, 'f1-score': 0.43793113657222377, 'support': 16060}, '2': {'precision': 0.49485910129474486, 'recall': 0.373044351944883, 'f1-score': 0.42540306080694, 'support': 20901}, 'accuracy': 0.46243202312934534, 'macro avg': {'precision': 0.46211742148722873, 'recall': 0.46193234041019604, 'f1-score': 0.4578303425248123, 'support': 58108}, 'weighted avg': {'precision': 0.46588897976862426, 'recall': 0.46243202312934534, 'f1-score': 0.4597096770739865, 'support': 58108}}
[[11678  4899  4570]
 [ 5275  7396  3389]
 [ 7682  5422  7797]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/EXC
Evaluating performance on  test set...
5343/5343 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8125154
{'0': {'precision': 0.45701668913789784, 'recall': 0.6013499411124529, 'f1-score': 0.5193416935971881, 'support': 268308}, '1': {'precision': 0.7387824513413006, 'recall': 0.7604569801669643, 'f1-score': 0.7494630412463983, 'support': 828920}, '2': {'precision': 0.5617438361423105, 'recall': 0.3353217943458222, 'f1-score': 0.41995801577070224, 'support': 270561}, 'accuracy': 0.6451506774802254, 'macro avg': {'precision': 0.5858476588738363, 'recall': 0.5657095718750799, 'f1-score': 0.5629209168714295, 'support': 1367789}, 'weighted avg': {'precision': 0.648490927654442, 'recall': 0.6451506774802254, 'f1-score': 0.639142949665903, 'support': 1367789}}
[[161347  86575  20386]
 [148167 630358  50395]
 [ 43530 136306  90725]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7370188
{'0': {'precision': 0.445022423704712, 'recall': 0.6695558359390714, 'f1-score': 0.5346728385146678, 'support': 54687}, '1': {'precision': 0.8398716821027578, 'recall': 0.7401587728617873, 'f1-score': 0.7868688753856856, 'support': 219307}, '2': {'precision': 0.5210331698030314, 'recall': 0.506612320452806, 'f1-score': 0.5137215619387967, 'support': 56183}, 'accuracy': 0.6887245325991816, 'macro avg': {'precision': 0.6019757585368337, 'recall': 0.6387756430845549, 'f1-score': 0.6117544252797167, 'support': 330177}, 'weighted avg': {'precision': 0.7202194182244457, 'recall': 0.6887245325991816, 'f1-score': 0.6986189967455868, 'support': 330177}}
[[ 36616  13295   4776]
 [ 35596 162322  21389]
 [ 10067  17653  28463]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7353543
{'0': {'precision': 0.4405889884763124, 'recall': 0.6665160123966942, 'f1-score': 0.5305000256950511, 'support': 15488}, '1': {'precision': 0.84017465673096, 'recall': 0.7503585413410252, 'f1-score': 0.7927306775621382, 'support': 62057}, '2': {'precision': 0.5187620613251376, 'recall': 0.4744100921628865, 'f1-score': 0.4955957664731991, 'support': 15299}, 'accuracy': 0.6909008659687217, 'macro avg': {'precision': 0.59984190217747, 'recall': 0.630428215300202, 'f1-score': 0.6062754899101295, 'support': 92844}, 'weighted avg': {'precision': 0.7205538505717934, 'recall': 0.6909008659687217, 'f1-score': 0.7000236061211499, 'support': 92844}}
[[10323  3882  1283]
 [10042 46565  5450]
 [ 3065  4976  7258]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/AAL
Evaluating performance on  test set...
7177/7177 - 102s - 102s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77353305
{'0': {'precision': 0.49302545598556685, 'recall': 0.5240819619892358, 'f1-score': 0.5080795670491406, 'support': 342061}, '1': {'precision': 0.7826401472303879, 'recall': 0.7622669073898031, 'f1-score': 0.7723191927233123, 'support': 1158177}, '2': {'precision': 0.4872819167875225, 'recall': 0.49972539787621234, 'f1-score': 0.49342521808460743, 'support': 336851}, 'accuracy': 0.6697775665740745, 'macro avg': {'precision': 0.5876491733344924, 'recall': 0.5953580890850837, 'f1-score': 0.5912746592856868, 'support': 1837089}, 'weighted avg': {'precision': 0.6745574108007405, 'recall': 0.6697775665740745, 'f1-score': 0.6719801319327052, 'support': 1837089}}
[[179268 123038  39755]
 [137972 882840 137365]
 [ 46368 122150 168333]]
Evaluating performance on  train set...
2257/2257 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8054986
{'0': {'precision': 0.45549761754922236, 'recall': 0.561203673789634, 'f1-score': 0.5028555359350897, 'support': 108335}, '1': {'precision': 0.7956266122742816, 'recall': 0.7312914760868906, 'f1-score': 0.7621036965100726, 'support': 362709}, '2': {'precision': 0.4667220621573533, 'recall': 0.48507007349973247, 'f1-score': 0.47571921749136936, 'support': 106531}, 'accuracy': 0.6539739427779943, 'macro avg': {'precision': 0.5726154306602858, 'recall': 0.592521741125419, 'f1-score': 0.5802261499788439, 'support': 577575}, 'weighted avg': {'precision': 0.6711641523824133, 'recall': 0.6539739427779943, 'f1-score': 0.6606545783691692, 'support': 577575}}
[[ 60798  32921  14616]
 [ 53035 265246  44428]
 [ 19643  35213  51675]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7481572
{'0': {'precision': 0.5199821885784259, 'recall': 0.48481179075560477, 'f1-score': 0.5017814620521727, 'support': 28904}, '1': {'precision': 0.7945805097057803, 'recall': 0.8035126963214316, 'f1-score': 0.7990216407781632, 'support': 105503}, '2': {'precision': 0.4599528460761199, 'recall': 0.4721828429169116, 'f1-score': 0.4659876132466602, 'support': 28921}, 'accuracy': 0.6884428879310345, 'macro avg': {'precision': 0.5915051814534421, 'recall': 0.5868357766646493, 'f1-score': 0.5889302386923321, 'support': 163328}, 'weighted avg': {'precision': 0.6867315399412668, 'recall': 0.6884428879310345, 'f1-score': 0.6874479532528482, 'support': 163328}}
[[14013 10721  4170]
 [ 8866 84773 11864]
 [ 4070 11195 13656]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/WBA
Evaluating performance on  test set...
5696/5696 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96971226
{'0': {'precision': 0.4971920216283954, 'recall': 0.5297157303301335, 'f1-score': 0.5129388386617946, 'support': 485349}, '1': {'precision': 0.5315287821731999, 'recall': 0.5859799776906855, 'f1-score': 0.5574277985216795, 'support': 499343}, '2': {'precision': 0.5297890269421585, 'recall': 0.4369977098527038, 'f1-score': 0.47894035502876375, 'support': 473332}, 'accuracy': 0.518885148666963, 'macro avg': {'precision': 0.5195032769145845, 'recall': 0.5175644726245076, 'f1-score': 0.5164356640707459, 'support': 1458024}, 'weighted avg': {'precision': 0.5195339218576772, 'recall': 0.518885148666963, 'f1-score': 0.5171381388299159, 'support': 1458024}}
[[257097 130021  98231]
 [121385 292605  85353]
 [138616 127871 206845]]
Evaluating performance on  train set...
2222/2222 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89434224
{'0': {'precision': 0.5173072738153528, 'recall': 0.48583727718061226, 'f1-score': 0.5010786473926375, 'support': 156573}, '1': {'precision': 0.6328847627387664, 'recall': 0.718633231567581, 'f1-score': 0.6730387966314411, 'support': 257454}, '2': {'precision': 0.5154408635431578, 'recall': 0.4308955185261851, 'f1-score': 0.4693915659891412, 'support': 154592}, 'accuracy': 0.5763032891971601, 'macro avg': {'precision': 0.5552109666990923, 'recall': 0.5451220090914595, 'f1-score': 0.5478363366710733, 'support': 568619}, 'weighted avg': {'precision': 0.5691299437164453, 'recall': 0.5763032891971601, 'f1-score': 0.5703223043471143, 'support': 568619}}
[[ 76069  52497  28007]
 [ 37824 185015  34615]
 [ 33155  54824  66613]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90414494
{'0': {'precision': 0.5154654359780048, 'recall': 0.4622157652600762, 'f1-score': 0.4873904717692799, 'support': 45429}, '1': {'precision': 0.641464683744963, 'recall': 0.7115340733681427, 'f1-score': 0.6746849942726232, 'support': 74501}, '2': {'precision': 0.4880905317256375, 'recall': 0.4498030375481021, 'f1-score': 0.46816528220502673, 'support': 43917}, 'accuracy': 0.5722533827290094, 'macro avg': {'precision': 0.5483402171495351, 'recall': 0.5411842920587736, 'f1-score': 0.5434135827489767, 'support': 163847}, 'weighted avg': {'precision': 0.5654196389102216, 'recall': 0.5722533827290094, 'f1-score': 0.5673999719183719, 'support': 163847}}
[[20998 14946  9485]
 [10258 53010 11233]
 [ 9480 14683 19754]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 167s - 167s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8527789
{'0': {'precision': 0.5198584623603002, 'recall': 0.5342212210269148, 'f1-score': 0.5269419891119826, 'support': 808811}, '1': {'precision': 0.644607194090325, 'recall': 0.8056576636333179, 'f1-score': 0.7161901816571522, 'support': 1477465}, '2': {'precision': 0.6073911541623894, 'recall': 0.3111145999207542, 'f1-score': 0.4114688559817806, 'support': 802566}, 'accuracy': 0.6060863585770978, 'macro avg': {'precision': 0.5906189368710049, 'recall': 0.5503311615269957, 'f1-score': 0.5515336755836385, 'support': 3088842}, 'weighted avg': {'precision': 0.6022720812033283, 'recall': 0.6060863585770978, 'f1-score': 0.5874607110909558, 'support': 3088842}}
[[ 432084  297664   79063]
 [ 204801 1190331   82333]
 [ 194272  358604  249690]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86382836
{'0': {'precision': 0.5456083950399808, 'recall': 0.43522663401316847, 'f1-score': 0.4842064123501249, 'support': 199264}, '1': {'precision': 0.6263221452368514, 'recall': 0.8173164237237464, 'f1-score': 0.7091849537000559, 'support': 357903}, '2': {'precision': 0.5673492259917345, 'recall': 0.36944479639155664, 'f1-score': 0.4474926489094604, 'support': 197315}, 'accuracy': 0.5992747341884895, 'macro avg': {'precision': 0.5797599220895223, 'recall': 0.5406626180428238, 'f1-score': 0.5469613383198804, 'support': 754482}, 'weighted avg': {'precision': 0.5895822544507499, 'recall': 0.5992747341884895, 'f1-score': 0.5813277732990536, 'support': 754482}}
[[ 86725  85587  26952]
 [ 36745 292520  28638]
 [ 35481  88937  72897]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82436204
{'0': {'precision': 0.5146524007800559, 'recall': 0.47613126584747417, 'f1-score': 0.4946429928319952, 'support': 41016}, '1': {'precision': 0.693348593564291, 'recall': 0.8087453018135513, 'f1-score': 0.7466143352151798, 'support': 97378}, '2': {'precision': 0.5490714205962262, 'recall': 0.3687696845473179, 'f1-score': 0.44121121495327104, 'support': 40006}, 'accuracy': 0.633609865470852, 'macro avg': {'precision': 0.5856908049801911, 'recall': 0.5512154174027811, 'f1-score': 0.5608228476668153, 'support': 178400}, 'weighted avg': {'precision': 0.6199105014959133, 'recall': 0.633609865470852, 'f1-score': 0.6201972174551651, 'support': 178400}}
[[19529 16541  4946]
 [11454 78754  7170]
 [ 6963 18290 14753]]
testing model on single stock: results/universal/W1/deepLOB_L2/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 293s - 293s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1140546
{'0': {'precision': 0.49544321111716727, 'recall': 0.5084250026486444, 'f1-score': 0.5018501681202995, 'support': 2161483}, '1': {'precision': 0.2776776806886145, 'recall': 0.4921493973548476, 'f1-score': 0.35503792243088145, 'support': 1125455}, '2': {'precision': 0.5047272628629421, 'recall': 0.29028362132613583, 'f1-score': 0.36858377805815745, 'support': 2179279}, 'accuracy': 0.41810506242251266, 'macro avg': {'precision': 0.42594938488957457, 'recall': 0.43028600710987597, 'f1-score': 0.4084906228697795, 'support': 5466217}, 'weighted avg': {'precision': 0.4543082239690196, 'recall': 0.41810506242251266, 'f1-score': 0.41849174652075105, 'support': 5466217}}
[[1098952  653186  409345]
 [ 360149  553892  211414]
 [ 759018  787652  632609]]
Evaluating performance on  train set...
6073/6073 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.059179
{'0': {'precision': 0.4856350601920736, 'recall': 0.41817775922816347, 'f1-score': 0.44938902593575775, 'support': 515135}, '1': {'precision': 0.43059860919836684, 'recall': 0.6803189199163489, 'f1-score': 0.5273917695056279, 'support': 520256}, '2': {'precision': 0.5015916844866125, 'recall': 0.27922059160610446, 'f1-score': 0.3587410986617832, 'support': 519163}, 'accuracy': 0.4595009243808835, 'macro avg': {'precision': 0.472608451292351, 'recall': 0.45923909025020554, 'f1-score': 0.44517396470105625, 'support': 1554554}, 'weighted avg': {'precision': 0.47254516115379236, 'recall': 0.4595009243808835, 'f1-score': 0.4452208500418023, 'support': 1554554}}
[[215418 218577  81140]
 [103415 353940  62901]
 [124747 249455 144961]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1089125
{'0': {'precision': 0.5055128738356262, 'recall': 0.3993144018993423, 'f1-score': 0.44618144541260896, 'support': 161319}, '1': {'precision': 0.3601438161566892, 'recall': 0.6445042707481871, 'f1-score': 0.46208066410922966, 'support': 133349}, '2': {'precision': 0.4693940258543116, 'recall': 0.2631841255191509, 'f1-score': 0.337266559169883, 'support': 162525}, 'accuracy': 0.422436476498984, 'macro avg': {'precision': 0.445016905282209, 'recall': 0.43566759938889343, 'f1-score': 0.4151762228972406, 'support': 457193}, 'weighted avg': {'precision': 0.4502735454981588, 'recall': 0.422436476498984, 'f1-score': 0.4121012058362739, 'support': 457193}}
[[64417 68174 28728]
 [27781 85944 19624]
 [35231 84520 42774]]
training model: results/universal/W1/deepOF_L2/h10
Epoch 1/50
10622/10622 - 237s - loss: 2.6944 - accuracy10: 0.5512 - val_loss: 3.1566 - val_accuracy10: 0.5872 - 237s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 235s - loss: 2.6046 - accuracy10: 0.5727 - val_loss: 3.1471 - val_accuracy10: 0.5879 - 235s/epoch - 22ms/step
Epoch 3/50
10622/10622 - 233s - loss: 2.5791 - accuracy10: 0.5769 - val_loss: 3.1167 - val_accuracy10: 0.5911 - 233s/epoch - 22ms/step
Epoch 4/50
10622/10622 - 231s - loss: 2.5630 - accuracy10: 0.5792 - val_loss: 3.1214 - val_accuracy10: 0.5911 - 231s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 231s - loss: 2.5509 - accuracy10: 0.5809 - val_loss: 3.0867 - val_accuracy10: 0.5930 - 231s/epoch - 22ms/step
Epoch 6/50
10622/10622 - 232s - loss: 2.5410 - accuracy10: 0.5823 - val_loss: 3.0845 - val_accuracy10: 0.5916 - 232s/epoch - 22ms/step
Epoch 7/50
10622/10622 - 232s - loss: 2.5323 - accuracy10: 0.5836 - val_loss: 3.0648 - val_accuracy10: 0.5919 - 232s/epoch - 22ms/step
Epoch 8/50
10622/10622 - 231s - loss: 2.5255 - accuracy10: 0.5846 - val_loss: 3.0641 - val_accuracy10: 0.5926 - 231s/epoch - 22ms/step
Epoch 9/50
10622/10622 - 231s - loss: 2.5193 - accuracy10: 0.5857 - val_loss: 3.0316 - val_accuracy10: 0.5933 - 231s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 231s - loss: 2.5142 - accuracy10: 0.5864 - val_loss: 3.0027 - val_accuracy10: 0.5921 - 231s/epoch - 22ms/step
Epoch 11/50
10622/10622 - 232s - loss: 2.5095 - accuracy10: 0.5869 - val_loss: 2.9911 - val_accuracy10: 0.5923 - 232s/epoch - 22ms/step
Epoch 12/50
10622/10622 - 230s - loss: 2.5053 - accuracy10: 0.5880 - val_loss: 2.9840 - val_accuracy10: 0.5932 - 230s/epoch - 22ms/step
Epoch 13/50
10622/10622 - 231s - loss: 2.5011 - accuracy10: 0.5884 - val_loss: 3.0062 - val_accuracy10: 0.5927 - 231s/epoch - 22ms/step
Epoch 14/50
10622/10622 - 234s - loss: 2.4981 - accuracy10: 0.5890 - val_loss: 2.9686 - val_accuracy10: 0.5931 - 234s/epoch - 22ms/step
Epoch 15/50
10622/10622 - 234s - loss: 2.4949 - accuracy10: 0.5894 - val_loss: 2.9746 - val_accuracy10: 0.5936 - 234s/epoch - 22ms/step
Epoch 16/50
10622/10622 - 231s - loss: 2.4917 - accuracy10: 0.5899 - val_loss: 2.9457 - val_accuracy10: 0.5942 - 231s/epoch - 22ms/step
Epoch 17/50
10622/10622 - 235s - loss: 2.4893 - accuracy10: 0.5903 - val_loss: 2.9348 - val_accuracy10: 0.5938 - 235s/epoch - 22ms/step
Epoch 18/50
10622/10622 - 231s - loss: 2.4861 - accuracy10: 0.5907 - val_loss: 2.9410 - val_accuracy10: 0.5953 - 231s/epoch - 22ms/step
Epoch 19/50
10622/10622 - 231s - loss: 2.4842 - accuracy10: 0.5909 - val_loss: 2.9438 - val_accuracy10: 0.5945 - 231s/epoch - 22ms/step
Epoch 20/50
10622/10622 - 231s - loss: 2.4820 - accuracy10: 0.5913 - val_loss: 2.9357 - val_accuracy10: 0.5960 - 231s/epoch - 22ms/step
Epoch 21/50
10622/10622 - 234s - loss: 2.4795 - accuracy10: 0.5915 - val_loss: 2.9369 - val_accuracy10: 0.5951 - 234s/epoch - 22ms/step
Epoch 22/50
10622/10622 - 230s - loss: 2.4776 - accuracy10: 0.5919 - val_loss: 2.9479 - val_accuracy10: 0.5943 - 230s/epoch - 22ms/step
Epoch 23/50
10622/10622 - 233s - loss: 2.4756 - accuracy10: 0.5922 - val_loss: 2.9387 - val_accuracy10: 0.5947 - 233s/epoch - 22ms/step
Epoch 24/50
10622/10622 - 230s - loss: 2.4748 - accuracy10: 0.5922 - val_loss: 2.9281 - val_accuracy10: 0.5955 - 230s/epoch - 22ms/step
Epoch 25/50
10622/10622 - 231s - loss: 2.4724 - accuracy10: 0.5926 - val_loss: 2.9461 - val_accuracy10: 0.5952 - 231s/epoch - 22ms/step
Epoch 26/50
10622/10622 - 230s - loss: 2.4705 - accuracy10: 0.5929 - val_loss: 2.9386 - val_accuracy10: 0.5947 - 230s/epoch - 22ms/step
Epoch 27/50
10622/10622 - 231s - loss: 2.4689 - accuracy10: 0.5930 - val_loss: 2.9279 - val_accuracy10: 0.5960 - 231s/epoch - 22ms/step
Epoch 28/50
10622/10622 - 231s - loss: 2.4673 - accuracy10: 0.5933 - val_loss: 2.9491 - val_accuracy10: 0.5951 - 231s/epoch - 22ms/step
Epoch 29/50
10622/10622 - 230s - loss: 2.4660 - accuracy10: 0.5935 - val_loss: 2.9418 - val_accuracy10: 0.5939 - 230s/epoch - 22ms/step
Epoch 30/50
10622/10622 - 233s - loss: 2.4644 - accuracy10: 0.5937 - val_loss: 2.9278 - val_accuracy10: 0.5948 - 233s/epoch - 22ms/step
Epoch 31/50
10622/10622 - 231s - loss: 2.4630 - accuracy10: 0.5938 - val_loss: 2.9166 - val_accuracy10: 0.5956 - 231s/epoch - 22ms/step
Epoch 32/50
10622/10622 - 231s - loss: 2.4614 - accuracy10: 0.5940 - val_loss: 2.9223 - val_accuracy10: 0.5930 - 231s/epoch - 22ms/step
Epoch 33/50
10622/10622 - 233s - loss: 2.4603 - accuracy10: 0.5942 - val_loss: 2.9343 - val_accuracy10: 0.5956 - 233s/epoch - 22ms/step
Epoch 34/50
10622/10622 - 231s - loss: 2.4593 - accuracy10: 0.5946 - val_loss: 2.9314 - val_accuracy10: 0.5947 - 231s/epoch - 22ms/step
Epoch 35/50
10622/10622 - 229s - loss: 2.4577 - accuracy10: 0.5949 - val_loss: 2.9243 - val_accuracy10: 0.5935 - 229s/epoch - 22ms/step
Epoch 36/50
10622/10622 - 232s - loss: 2.4568 - accuracy10: 0.5949 - val_loss: 2.9260 - val_accuracy10: 0.5933 - 232s/epoch - 22ms/step
Epoch 37/50
10622/10622 - 233s - loss: 2.4564 - accuracy10: 0.5951 - val_loss: 2.9282 - val_accuracy10: 0.5942 - 233s/epoch - 22ms/step
Epoch 38/50
10622/10622 - 232s - loss: 2.4544 - accuracy10: 0.5953 - val_loss: 2.9214 - val_accuracy10: 0.5941 - 232s/epoch - 22ms/step
Epoch 39/50
10622/10622 - 231s - loss: 2.4532 - accuracy10: 0.5954 - val_loss: 2.9091 - val_accuracy10: 0.5933 - 231s/epoch - 22ms/step
Epoch 40/50
10622/10622 - 231s - loss: 2.4525 - accuracy10: 0.5956 - val_loss: 2.9320 - val_accuracy10: 0.5942 - 231s/epoch - 22ms/step
Epoch 41/50
10622/10622 - 232s - loss: 2.4513 - accuracy10: 0.5957 - val_loss: 2.9324 - val_accuracy10: 0.5917 - 232s/epoch - 22ms/step
Epoch 42/50
10622/10622 - 232s - loss: 2.4494 - accuracy10: 0.5960 - val_loss: 2.9314 - val_accuracy10: 0.5910 - 232s/epoch - 22ms/step
Epoch 43/50
10622/10622 - 230s - loss: 2.4490 - accuracy10: 0.5962 - val_loss: 2.9040 - val_accuracy10: 0.5928 - 230s/epoch - 22ms/step
Epoch 44/50
10622/10622 - 234s - loss: 2.4486 - accuracy10: 0.5962 - val_loss: 2.9086 - val_accuracy10: 0.5926 - 234s/epoch - 22ms/step
Epoch 45/50
10622/10622 - 232s - loss: 2.4469 - accuracy10: 0.5964 - val_loss: 2.9205 - val_accuracy10: 0.5921 - 232s/epoch - 22ms/step
Epoch 46/50
10622/10622 - 232s - loss: 2.4459 - accuracy10: 0.5966 - val_loss: 2.9182 - val_accuracy10: 0.5911 - 232s/epoch - 22ms/step
Epoch 47/50
10622/10622 - 231s - loss: 2.4451 - accuracy10: 0.5966 - val_loss: 2.9344 - val_accuracy10: 0.5926 - 231s/epoch - 22ms/step
Epoch 48/50
10622/10622 - 230s - loss: 2.4442 - accuracy10: 0.5970 - val_loss: 2.9303 - val_accuracy10: 0.5912 - 230s/epoch - 22ms/step
Epoch 49/50
10622/10622 - 233s - loss: 2.4428 - accuracy10: 0.5970 - val_loss: 2.9255 - val_accuracy10: 0.5936 - 233s/epoch - 22ms/step
Epoch 50/50
10622/10622 - 231s - loss: 2.4421 - accuracy10: 0.5972 - val_loss: 2.9394 - val_accuracy10: 0.5899 - 231s/epoch - 22ms/step
testing model in sample: results/universal/W1/deepOF_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 268s - 268s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9142097
{'0': {'precision': 0.4445619536200798, 'recall': 0.6207822585022021, 'f1-score': 0.5180976635948483, 'support': 2450571}, '1': {'precision': 0.7056206339252653, 'recall': 0.6175867534188771, 'f1-score': 0.6586752169302023, 'support': 4137762}, '2': {'precision': 0.4966754356626915, 'recall': 0.40472083119951285, 'f1-score': 0.4460078270737139, 'support': 2458423}, 'accuracy': 0.560606807567265, 'macro avg': {'precision': 0.5489526744026788, 'recall': 0.5476966143735308, 'f1-score': 0.5409269025329215, 'support': 9046756}, 'weighted avg': {'precision': 0.5781253734802583, 'recall': 0.560606807567265, 'f1-score': 0.5628042021678135, 'support': 9046756}}
[[1521271  489361  439939]
 [1013979 2555427  568356]
 [ 886705  576743  994975]]
Evaluating performance on  train set...
10622/10622 - 84s - 84s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83652174
{'0': {'precision': 0.42858814549651736, 'recall': 0.5483987327341838, 'f1-score': 0.481147088241002, 'support': 587722}, '1': {'precision': 0.7364076356726843, 'recall': 0.7315802356890583, 'f1-score': 0.7339859983569135, 'support': 1544238}, '2': {'precision': 0.48319063412107, 'recall': 0.3561855661315043, 'f1-score': 0.4100796031911939, 'support': 586551}, 'accuracy': 0.6109818941324865, 'macro avg': {'precision': 0.5493954717634238, 'recall': 0.5453881781849155, 'f1-score': 0.5417375632630365, 'support': 2718511}, 'weighted avg': {'precision': 0.6152247631801993, 'recall': 0.6109818941324865, 'f1-score': 0.6094374458875683, 'support': 2718511}}
[[ 322306  188809   76607]
 [ 267654 1129734  146850]
 [ 162058  215572  208921]]
Evaluating performance on  val set...
3064/3064 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86397415
{'0': {'precision': 0.43747662770183765, 'recall': 0.5544942034561788, 'f1-score': 0.489083441949684, 'support': 179331}, '1': {'precision': 0.7288139386268752, 'recall': 0.6886390602055801, 'f1-score': 0.7081571610122398, 'support': 425625}, '2': {'precision': 0.46577109011496043, 'recall': 0.4019404988256347, 'f1-score': 0.4315080418090018, 'support': 178820}, 'accuracy': 0.5925353672477851, 'macro avg': {'precision': 0.5440205521478911, 'recall': 0.5483579208291313, 'f1-score': 0.5429162149236418, 'support': 783776}, 'weighted avg': {'precision': 0.6021410965439349, 'recall': 0.5925353672477851, 'f1-score': 0.5949142132706271, 'support': 783776}}
[[ 99438  51330  28563]
 [ 78647 293102  53876]
 [ 49214  57731  71875]]
testing model out of sample: results/universal/W1/deepOF_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 187s - 187s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69652
{'0': {'precision': 0.4683167972465563, 'recall': 0.5502227086416639, 'f1-score': 0.5059765187186919, 'support': 1125686}, '1': {'precision': 0.8047429505361184, 'recall': 0.8430808670286849, 'f1-score': 0.8234659278998208, 'support': 3856343}, '2': {'precision': 0.5421152671237526, 'recall': 0.3574254660553448, 'f1-score': 0.4308105122102269, 'support': 1117142}, 'accuracy': 0.7000757971862077, 'macro avg': {'precision': 0.6050583383021425, 'recall': 0.5835763472418979, 'f1-score': 0.5867509862762464, 'support': 6099171}, 'weighted avg': {'precision': 0.694547216346247, 'recall': 0.7000757971862077, 'f1-score': 0.6929489708481538, 'support': 6099171}}
[[ 619378  374071  132237]
 [ 400116 3251209  205018]
 [ 303068  414779  399295]]
Evaluating performance on  train set...
6711/6711 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.709564
{'0': {'precision': 0.4380439724603793, 'recall': 0.5368457711442786, 'f1-score': 0.4824382567018974, 'support': 301500}, '1': {'precision': 0.805989019401973, 'recall': 0.826254919759044, 'f1-score': 0.8159961591218421, 'support': 1114892}, '2': {'precision': 0.5118357782713759, 'recall': 0.3484655113964943, 'f1-score': 0.4146387280093805, 'support': 300882}, 'accuracy': 0.6917306149164315, 'macro avg': {'precision': 0.5852895900445761, 'recall': 0.5705220674332723, 'f1-score': 0.5710243812777067, 'support': 1717274}, 'weighted avg': {'precision': 0.6898509732015723, 'recall': 0.6917306149164315, 'f1-score': 0.6871122802722275, 'support': 1717274}}
[[161859 105147  34494]
 [128203 921185  65504]
 [ 79442 116593 104847]]
Evaluating performance on  val set...
1720/1720 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6728845
{'0': {'precision': 0.4566201174776587, 'recall': 0.5398281499094815, 'f1-score': 0.49475000619103043, 'support': 74018}, '1': {'precision': 0.8232328953330312, 'recall': 0.8459347408566332, 'f1-score': 0.834429437618299, 'support': 292097}, '2': {'precision': 0.5139194911194988, 'recall': 0.36377074970163825, 'f1-score': 0.4260019534817238, 'support': 73736}, 'accuracy': 0.713593921577989, 'macro avg': {'precision': 0.5979241679767296, 'recall': 0.5831778801559176, 'f1-score': 0.5850604657636844, 'support': 439851}, 'weighted avg': {'precision': 0.7096865403983192, 'recall': 0.713593921577989, 'f1-score': 0.70880007420733, 'support': 439851}}
[[ 39957  24922   9139]
 [ 28771 247095  16231]
 [ 18778  28135  26823]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1338551
{'0': {'precision': 0.3629700631269122, 'recall': 0.724397124748802, 'f1-score': 0.4836167083774091, 'support': 51752}, '1': {'precision': 0.6043421298895751, 'recall': 0.242708959711365, 'f1-score': 0.3463291682308146, 'support': 66520}, '2': {'precision': 0.44499042435238384, 'recall': 0.3434868024352765, 'f1-score': 0.3877051429826006, 'support': 51411}, 'accuracy': 0.42015405196749234, 'macro avg': {'precision': 0.4707675391229571, 'recall': 0.4368642956318145, 'f1-score': 0.40588367319694146, 'support': 169683}, 'weighted avg': {'precision': 0.4824447227688036, 'recall': 0.42015405196749234, 'f1-score': 0.4007370052895102, 'support': 169683}}
[[37489  5082  9181]
 [37531 16145 12844]
 [28264  5488 17659]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1552001
{'0': {'precision': 0.3036721100756624, 'recall': 0.6520511855476101, 'f1-score': 0.41436629262750885, 'support': 15942}, '1': {'precision': 0.6634873895787992, 'recall': 0.30682928273289717, 'f1-score': 0.4196101451328867, 'support': 33781}, '2': {'precision': 0.36064787042591484, 'recall': 0.3578571428571429, 'f1-score': 0.3592470869435315, 'support': 16800}, 'accuracy': 0.4024472738752011, 'macro avg': {'precision': 0.4426024566934588, 'recall': 0.43891253704588334, 'f1-score': 0.39774117490130906, 'support': 66523}, 'weighted avg': {'precision': 0.5007785654486868, 'recall': 0.4024472738752011, 'f1-score': 0.40310913233698303, 'support': 66523}}
[[10395  2334  3213]
 [15971 10365  7445]
 [ 7865  2923  6012]]
Evaluating performance on  val set...
51/51 - 1s - 566ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1373599
{'0': {'precision': 0.31279761904761905, 'recall': 0.6694267515923567, 'f1-score': 0.42636916835699795, 'support': 3140}, '1': {'precision': 0.6712948014207297, 'recall': 0.3152388172858226, 'f1-score': 0.4290136194799835, 'support': 6595}, '2': {'precision': 0.366006600660066, 'recall': 0.3563624678663239, 'f1-score': 0.3611201563008792, 'support': 3112}, 'accuracy': 0.4117692846578968, 'macro avg': {'precision': 0.4500330070428049, 'recall': 0.447009345581501, 'f1-score': 0.4055009813792869, 'support': 12847}, 'weighted avg': {'precision': 0.5097210461923688, 'recall': 0.4117692846578968, 'f1-score': 0.41192106604808915, 'support': 12847}}
[[2102  446  592]
 [3187 2079 1329]
 [1431  572 1109]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48448962
{'0': {'precision': 0.3666016279390607, 'recall': 0.5446214206242315, 'f1-score': 0.4382222326929193, 'support': 34154}, '1': {'precision': 0.9210157313787409, 'recall': 0.9010816142582609, 'f1-score': 0.910939631162103, 'support': 352806}, '2': {'precision': 0.5055785782594836, 'recall': 0.3726832133940373, 'f1-score': 0.42907627534197934, 'support': 34045}, 'accuracy': 0.8294343297585539, 'macro avg': {'precision': 0.5977319791924285, 'recall': 0.60612874942551, 'f1-score': 0.5927460463990005, 'support': 421005}, 'weighted avg': {'precision': 0.8424441772004676, 'recall': 0.8294343297585539, 'f1-score': 0.8336240933983885, 'support': 421005}}
[[ 18601  13183   2370]
 [ 24861 317907  10038]
 [  7277  14080  12688]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.588635
{'0': {'precision': 0.42672501526562184, 'recall': 0.5816609636548599, 'f1-score': 0.4922902316844083, 'support': 21626}, '1': {'precision': 0.8760094503486257, 'recall': 0.8565966352732834, 'f1-score': 0.866194288319014, 'support': 124230}, '2': {'precision': 0.5019733132869761, 'recall': 0.3804482005507549, 'f1-score': 0.43284267386900743, 'support': 21062}, 'accuracy': 0.7608945709869517, 'macro avg': {'precision': 0.6015692596337412, 'recall': 0.6062352664929661, 'f1-score': 0.5971090646241433, 'support': 166918}, 'weighted avg': {'precision': 0.7706033568662122, 'recall': 0.7608945709869517, 'f1-score': 0.7630699947597452, 'support': 166918}}
[[ 12579   6773   2274]
 [ 12139 106415   5676]
 [  4760   8289   8013]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.54761606
{'0': {'precision': 0.47488667271078877, 'recall': 0.5162625665286813, 'f1-score': 0.4947109935776351, 'support': 5073}, '1': {'precision': 0.8927055298132682, 'recall': 0.8861163898757883, 'f1-score': 0.8893987560469937, 'support': 36309}, '2': {'precision': 0.4547950992817913, 'recall': 0.4386715566422168, 'f1-score': 0.44658784484546776, 'support': 4908}, 'accuracy': 0.7981421473320371, 'macro avg': {'precision': 0.6074624339352828, 'recall': 0.6136835043488954, 'f1-score': 0.6102325314900322, 'support': 46290}, 'weighted avg': {'precision': 0.8004856236752391, 'recall': 0.7981421473320371, 'f1-score': 0.7991942416554589, 'support': 46290}}
[[ 2619  1907   547]
 [ 2101 32174  2034]
 [  795  1960  2153]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0109311
{'0': {'precision': 0.45752345084911256, 'recall': 0.6065722316739404, 'f1-score': 0.5216091469644625, 'support': 108152}, '1': {'precision': 0.5578933612127548, 'recall': 0.5131714521225443, 'f1-score': 0.5345987334072775, 'support': 116464}, '2': {'precision': 0.5176041144296594, 'recall': 0.39754039625953924, 'f1-score': 0.4496962880779772, 'support': 111644}, 'accuracy': 0.5048206744780824, 'macro avg': {'precision': 0.5110069754971756, 'recall': 0.5057613600186747, 'f1-score': 0.5019680561499057, 'support': 336260}, 'weighted avg': {'precision': 0.5122344686489633, 'recall': 0.5048206744780824, 'f1-score': 0.5022318198305579, 'support': 336260}}
[[65602 22043 20507]
 [35841 59766 20857]
 [41942 25319 44383]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88416857
{'0': {'precision': 0.46094006074776567, 'recall': 0.5930445050465293, 'f1-score': 0.5187134215315005, 'support': 35569}, '1': {'precision': 0.7007912003087611, 'recall': 0.7005208333333334, 'f1-score': 0.7006559907389543, 'support': 62208}, '2': {'precision': 0.514096122128035, 'recall': 0.36982975083469, 'f1-score': 0.43019001155475667, 'support': 36241}, 'accuracy': 0.5825709979256518, 'macro avg': {'precision': 0.5586091277281873, 'recall': 0.5544650297381842, 'f1-score': 0.5498531412750705, 'support': 134018}, 'weighted avg': {'precision': 0.5866477157664404, 'recall': 0.5825709979256518, 'f1-score': 0.5792284750637879, 'support': 134018}}
[[21094  8315  6160]
 [12122 43578  6508]
 [12547 10291 13403]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.997594
{'0': {'precision': 0.4563845422322123, 'recall': 0.6091622432494808, 'f1-score': 0.5218207878218751, 'support': 8666}, '1': {'precision': 0.5792891319207109, 'recall': 0.5139478471801091, 'f1-score': 0.5446658097686374, 'support': 9894}, '2': {'precision': 0.4904029304029304, 'recall': 0.38873403019744485, 'f1-score': 0.4336896663427276, 'support': 8610}, 'accuracy': 0.5046374677953626, 'macro avg': {'precision': 0.5086922015186178, 'recall': 0.5039480402090116, 'f1-score': 0.5000587546444134, 'support': 27170}, 'weighted avg': {'precision': 0.5119206604702649, 'recall': 0.5046374677953626, 'f1-score': 0.5022116487422214, 'support': 27170}}
[[5279 1701 1686]
 [3017 5085 1792]
 [3271 1992 3347]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2179486
{'0': {'precision': 0.3808837762969061, 'recall': 0.5851342921355996, 'f1-score': 0.46141612897791406, 'support': 117021}, '1': {'precision': 0.7532610020724125, 'recall': 0.05955892275364833, 'f1-score': 0.11038955238546122, 'support': 103746}, '2': {'precision': 0.37089304948579505, 'recall': 0.4785472120670272, 'f1-score': 0.4178983333848675, 'support': 112969}, 'accuracy': 0.38567310688688067, 'macro avg': {'precision': 0.5016792759517045, 'recall': 0.37441347565209177, 'f1-score': 0.32990133824941426, 'support': 333736}, 'weighted avg': {'precision': 0.4932600415130688, 'recall': 0.38567310688688067, 'f1-score': 0.3375644466136756, 'support': 333736}}
[[68473   945 47603]
 [53472  6179 44095]
 [57829  1079 54061]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2584354
{'0': {'precision': 0.38378143972246315, 'recall': 0.6263269639065817, 'f1-score': 0.47593439096531326, 'support': 33912}, '1': {'precision': 0.6490020646937371, 'recall': 0.029160739687055477, 'f1-score': 0.05581367819833683, 'support': 32338}, '2': {'precision': 0.36875120633082414, 'recall': 0.4776996405688389, 'f1-score': 0.4162139346159607, 'support': 31995}, 'accuracy': 0.3813629192325309, 'macro avg': {'precision': 0.4671782369156747, 'recall': 0.3777291147208253, 'f1-score': 0.3159873345932036, 'support': 98245}, 'weighted avg': {'precision': 0.4661857580384647, 'recall': 0.3813629192325309, 'f1-score': 0.3181999555196823, 'support': 98245}}
[[21240   253 12419]
 [17650   943 13745]
 [16454   257 15284]]
Evaluating performance on  val set...
93/93 - 1s - 900ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2385427
{'0': {'precision': 0.37331915216895845, 'recall': 0.6090728805156173, 'f1-score': 0.4629080118694362, 'support': 8068}, '1': {'precision': 0.5704225352112676, 'recall': 0.022103970528039297, 'f1-score': 0.04255878103244451, 'support': 7329}, '2': {'precision': 0.3891897213744216, 'recall': 0.4816619958571951, 'f1-score': 0.4305162274014376, 'support': 8207}, 'accuracy': 0.3825199118793425, 'macro avg': {'precision': 0.4443104695848825, 'recall': 0.37094628230028387, 'f1-score': 0.3119943401011061, 'support': 23604}, 'weighted avg': {'precision': 0.4400375243002209, 'recall': 0.3825199118793425, 'f1-score': 0.32112785223830687, 'support': 23604}}
[[4914   59 3095]
 [4058  162 3109]
 [4191   63 3953]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9815296
{'0': {'precision': 0.4801024593594616, 'recall': 0.6229038872573722, 'f1-score': 0.5422592338368855, 'support': 230188}, '1': {'precision': 0.5678669021683694, 'recall': 0.4898125509372453, 'f1-score': 0.525959609269531, 'support': 215952}, '2': {'precision': 0.523409528300335, 'recall': 0.4316240668815872, 'f1-score': 0.47310618262916615, 'support': 221167}, 'accuracy': 0.5164369622977131, 'macro avg': {'precision': 0.5237929632760553, 'recall': 0.5147801683587349, 'f1-score': 0.5137750085785275, 'support': 667307}, 'weighted avg': {'precision': 0.5228578949684324, 'recall': 0.5164369622977131, 'f1-score': 0.5140648504405971, 'support': 667307}}
[[143385  40182  46621]
 [ 69875 105776  40301]
 [ 85395  40311  95461]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9497478
{'0': {'precision': 0.4591241085806303, 'recall': 0.5840405296656669, 'f1-score': 0.5141031007502335, 'support': 54676}, '1': {'precision': 0.639273716649546, 'recall': 0.6094355852577251, 'f1-score': 0.6239981572190267, 'support': 75565}, '2': {'precision': 0.504745990856135, 'recall': 0.3995187185421948, 'f1-score': 0.4460098229208322, 'support': 54438}, 'accuracy': 0.5400397446379935, 'macro avg': {'precision': 0.5343812720287704, 'recall': 0.5309982778218623, 'f1-score': 0.5280370269633642, 'support': 184679}, 'weighted avg': {'precision': 0.5462838244175231, 'recall': 0.5400397446379935, 'f1-score': 0.5389968790552244, 'support': 184679}}
[[31933 12707 10036]
 [18209 46052 11304]
 [19410 13279 21749]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98537093
{'0': {'precision': 0.47152383713705837, 'recall': 0.6063059224541969, 'f1-score': 0.5304876628066824, 'support': 18776}, '1': {'precision': 0.5856586632057106, 'recall': 0.526725353825203, 'f1-score': 0.5546308862315315, 'support': 20561}, '2': {'precision': 0.5096302998965874, 'recall': 0.420085242408098, 'f1-score': 0.4605455288826587, 'support': 18770}, 'accuracy': 0.517992668697403, 'macro avg': {'precision': 0.5222709334131188, 'recall': 0.517705506229166, 'f1-score': 0.5152213593069576, 'support': 58107}, 'weighted avg': {'precision': 0.5242194584011732, 'recall': 0.517992668697403, 'f1-score': 0.5164376337754881, 'support': 58107}}
[[11384  3563  3829]
 [ 5973 10830  3758]
 [ 6786  4099  7885]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/EXC
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5435636
{'0': {'precision': 0.43761616067039627, 'recall': 0.6036927965280737, 'f1-score': 0.5074108352083203, 'support': 154842}, '1': {'precision': 0.8807012817241187, 'recall': 0.8791433671560945, 'f1-score': 0.8799216348628184, 'support': 1055995}, '2': {'precision': 0.561298124975013, 'recall': 0.357821430164323, 'f1-score': 0.4370367199872373, 'support': 156947}, 'accuracy': 0.7881412562217426, 'macro avg': {'precision': 0.6265385224565093, 'recall': 0.6135525312828304, 'f1-score': 0.608123063352792, 'support': 1367784}, 'weighted avg': {'precision': 0.7938911175779506, 'recall': 0.7881412562217426, 'f1-score': 0.7869319698462078, 'support': 1367784}}
[[ 93477  51455   9910]
 [ 93641 928371  33983]
 [ 26487  74301  56159]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49560037
{'0': {'precision': 0.4021689163776171, 'recall': 0.604206560979438, 'f1-score': 0.4829074304065836, 'support': 31855}, '1': {'precision': 0.9036204947737628, 'recall': 0.8760939971379077, 'f1-score': 0.8896443724653006, 'support': 265540}, '2': {'precision': 0.5218755026540132, 'recall': 0.3958879873101092, 'f1-score': 0.45023417172593233, 'support': 32782}, 'accuracy': 0.8021848887112064, 'macro avg': {'precision': 0.6092216379351311, 'recall': 0.6253961818091517, 'f1-score': 0.6075953248659388, 'support': 330177}, 'weighted avg': {'precision': 0.8173391839572043, 'recall': 0.8021848887112064, 'f1-score': 0.8067756369388454, 'support': 330177}}
[[ 19247  10400   2208]
 [ 23220 232638   9682]
 [  5391  14413  12978]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49293903
{'0': {'precision': 0.4143355225816914, 'recall': 0.5683461239016795, 'f1-score': 0.479272181579441, 'support': 8991}, '1': {'precision': 0.9005034374492502, 'recall': 0.888657398132938, 'f1-score': 0.8945412014599815, 'support': 74877}, '2': {'precision': 0.5198670494032331, 'recall': 0.38335561497326204, 'f1-score': 0.44129528695094583, 'support': 8976}, 'accuracy': 0.8087867821291629, 'macro avg': {'precision': 0.6115686698113916, 'recall': 0.6134530456692932, 'f1-score': 0.6050362233301229, 'support': 92844}, 'weighted avg': {'precision': 0.8166237258720317, 'recall': 0.8087867821291629, 'f1-score': 0.8105075634609828, 'support': 92844}}
[[ 5110  3288   593]
 [ 5752 66540  2585]
 [ 1471  4064  3441]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/AAL
Evaluating performance on  test set...
7177/7177 - 56s - 56s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53421384
{'0': {'precision': 0.46326757889163755, 'recall': 0.48909073386980195, 'f1-score': 0.475829059508518, 'support': 207530}, '1': {'precision': 0.8696675080030379, 'recall': 0.9059472691999879, 'f1-score': 0.8874367504739734, 'support': 1423191}, '2': {'precision': 0.5419940335538752, 'recall': 0.35567907037598795, 'f1-score': 0.42950141462372765, 'support': 206363}, 'accuracy': 0.7970435755795597, 'macro avg': {'precision': 0.6249763734828502, 'recall': 0.5835723578152593, 'f1-score': 0.5975890748687397, 'support': 1837084}, 'weighted avg': {'precision': 0.7869495383858395, 'recall': 0.7970435755795597, 'f1-score': 0.7894979225172086, 'support': 1837084}}
[[ 101501   93152   12877]
 [  84707 1289336   49148]
 [  32890  100074   73399]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5479239
{'0': {'precision': 0.44378736426201143, 'recall': 0.5101147275776601, 'f1-score': 0.4746450864497597, 'support': 67377}, '1': {'precision': 0.8668045865226396, 'recall': 0.901756779035183, 'f1-score': 0.8839353015596827, 'support': 442799}, '2': {'precision': 0.5568363184961873, 'recall': 0.3261224368675628, 'f1-score': 0.4113370324971227, 'support': 67398}, 'accuracy': 0.788898045964673, 'macro avg': {'precision': 0.6224760897602795, 'recall': 0.5793313144934686, 'f1-score': 0.5899724735021884, 'support': 577574}, 'weighted avg': {'precision': 0.7812867607328686, 'recall': 0.788898045964673, 'f1-score': 0.7810412568801443, 'support': 577574}}
[[ 34370  28631   4376]
 [ 30385 399297  13117]
 [ 12692  32726  21980]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5329234
{'0': {'precision': 0.46483788106431445, 'recall': 0.5390019107564348, 'f1-score': 0.4991802638769615, 'support': 17794}, '1': {'precision': 0.881060792517844, 'recall': 0.8990393671124506, 'f1-score': 0.88995929022033, 'support': 127416}, '2': {'precision': 0.527922385234264, 'recall': 0.36943202516973006, 'f1-score': 0.4346809547004384, 'support': 18117}, 'accuracy': 0.8010677965063951, 'macro avg': {'precision': 0.6246070196054742, 'recall': 0.6024911010128718, 'f1-score': 0.6079401695992434, 'support': 163327}, 'weighted avg': {'precision': 0.7965427458313763, 'recall': 0.8010677965063951, 'f1-score': 0.7968834387115913, 'support': 163327}}
[[  9591   6964   1239]
 [  8118 114552   4746]
 [  2924   8500   6693]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/WBA
Evaluating performance on  test set...
5696/5696 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.867606
{'0': {'precision': 0.426926673281037, 'recall': 0.5291567629416865, 'f1-score': 0.4725761955240685, 'support': 339098}, '1': {'precision': 0.6970556917328888, 'recall': 0.7064144100733565, 'f1-score': 0.701703847670199, 'support': 788615}, '2': {'precision': 0.49560412378049545, 'recall': 0.357883296095136, 'f1-score': 0.4156322243220674, 'support': 330306}, 'accuracy': 0.5862310436283752, 'macro avg': {'precision': 0.5398621629314738, 'recall': 0.531151489703393, 'f1-score': 0.5299707558387783, 'support': 1458019}, 'weighted avg': {'precision': 0.5885928585989796, 'recall': 0.5862310436283752, 'f1-score': 0.5836066882991096, 'support': 1458019}}
[[179436 121728  37934]
 [149152 557089  82374]
 [ 91709 120386 118211]]
Evaluating performance on  train set...
2222/2222 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72978336
{'0': {'precision': 0.46166065217214214, 'recall': 0.5315867968596111, 'f1-score': 0.4941622705672058, 'support': 106611}, '1': {'precision': 0.7832706966415667, 'recall': 0.8063895239376009, 'f1-score': 0.7946619988376442, 'support': 356928}, '2': {'precision': 0.5027424868615745, 'recall': 0.37507970193854145, 'f1-score': 0.4296280147159013, 'support': 105079}, 'accuracy': 0.675161531995118, 'macro avg': {'precision': 0.5825579452250945, 'recall': 0.5710186742452511, 'f1-score': 0.5728174280402504, 'support': 568618}, 'weighted avg': {'precision': 0.671130749952574, 'recall': 0.675161531995118, 'f1-score': 0.6708636270868936, 'support': 568618}}
[[ 56673  37977  11961]
 [ 42083 287823  27022]
 [ 24003  41663  39413]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7650423
{'0': {'precision': 0.4402082633523682, 'recall': 0.5148469471271894, 'f1-score': 0.4746110549427334, 'support': 30545}, '1': {'precision': 0.7880773565522675, 'recall': 0.7596281412832394, 'f1-score': 0.7735912786798576, 'support': 104018}, '2': {'precision': 0.43809899852830325, 'recall': 0.41679472731619027, 'f1-score': 0.42718140772111585, 'support': 29283}, 'accuracy': 0.6527226786128437, 'macro avg': {'precision': 0.5554615394776463, 'recall': 0.5637566052422064, 'f1-score': 0.5584612471145689, 'support': 163846}, 'weighted avg': {'precision': 0.6606767626420917, 'recall': 0.6527226786128437, 'f1-score': 0.6559425647330095, 'support': 163846}}
[[15726 10748  4071]
 [13420 79015 11583]
 [ 6578 10500 12205]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 96s - 96s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67335844
{'0': {'precision': 0.4858940684495121, 'recall': 0.5135627499697006, 'f1-score': 0.4993454232101329, 'support': 528064}, '1': {'precision': 0.7955163492877971, 'recall': 0.8749297026471132, 'f1-score': 0.8333353622849118, 'support': 2034216}, '2': {'precision': 0.5739437459741871, 'recall': 0.3198248242830311, 'f1-score': 0.41075836365942414, 'support': 526557}, 'accuracy': 0.7185215665313515, 'macro avg': {'precision': 0.6184513879038321, 'recall': 0.5694390922999483, 'f1-score': 0.5811463830514896, 'support': 3088837}, 'weighted avg': {'precision': 0.7048119885877691, 'recall': 0.7185215665313515, 'f1-score': 0.7041997232554568, 'support': 3088837}}
[[ 271194  213753   43117]
 [ 172524 1779796   81896]
 [ 114416  243735  168406]]
Evaluating performance on  train set...
2948/2948 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70398724
{'0': {'precision': 0.45191155342187334, 'recall': 0.5040098174087043, 'f1-score': 0.47654099275370354, 'support': 127936}, '1': {'precision': 0.7929054219062898, 'recall': 0.8432529732947882, 'f1-score': 0.8173045550175677, 'support': 500539}, '2': {'precision': 0.5261283706416016, 'recall': 0.3318360382524503, 'f1-score': 0.4069827426780482, 'support': 126005}, 'accuracy': 0.7003167744671827, 'macro avg': {'precision': 0.5903151153232549, 'recall': 0.559699609651981, 'f1-score': 0.5669427634831065, 'support': 754480}, 'weighted avg': {'precision': 0.6905294359251778, 'recall': 0.7003167744671827, 'f1-score': 0.6909943452497397, 'support': 754480}}
[[ 64481  52996  10459]
 [ 51257 422081  27201]
 [ 26947  57245  41813]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.61647856
{'0': {'precision': 0.48042211628570264, 'recall': 0.4598315264019967, 'f1-score': 0.46990136494968615, 'support': 25642}, '1': {'precision': 0.820635795531822, 'recall': 0.8982300538270482, 'f1-score': 0.8576815172259006, 'support': 127631}, '2': {'precision': 0.5531854781748835, 'recall': 0.3116965813666574, 'f1-score': 0.3987272495863561, 'support': 25127}, 'accuracy': 0.7526065022421524, 'macro avg': {'precision': 0.6180811299974694, 'recall': 0.5565860538652342, 'f1-score': 0.5754367105873143, 'support': 178400}, 'weighted avg': {'precision': 0.7340663824855395, 'recall': 0.7526065022421524, 'f1-score': 0.7373025791785602, 'support': 178400}}
[[ 11791  12069   1782]
 [  8445 114642   4544]
 [  4307  12988   7832]]
testing model on single stock: results/universal/W1/deepOF_L2/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0339205
{'0': {'precision': 0.45409873049398874, 'recall': 0.6432762692638314, 'f1-score': 0.5323812503366326, 'support': 1805456}, '1': {'precision': 0.5272356568300169, 'recall': 0.40606446694979853, 'f1-score': 0.4587841799067763, 'support': 1836600}, '2': {'precision': 0.5046185087045888, 'recall': 0.413313883242442, 'f1-score': 0.45442526534293803, 'support': 1824156}, 'accuracy': 0.4868332951594267, 'macro avg': {'precision': 0.49531763200953155, 'recall': 0.48755153981869065, 'f1-score': 0.481863565195449, 'support': 5466212}, 'weighted avg': {'precision': 0.49553130490754693, 'recall': 0.4868332951594267, 'f1-score': 0.4816382024428385, 'support': 5466212}}
[[1161407  302043  342006]
 [ 692680  745778  398142]
 [ 703522  366685  753949]]
Evaluating performance on  train set...
6073/6073 - 49s - 49s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9479418
{'0': {'precision': 0.4278899429442535, 'recall': 0.5403893141791841, 'f1-score': 0.47760426779923926, 'support': 393718}, '1': {'precision': 0.6384914779274055, 'recall': 0.6553707387069035, 'f1-score': 0.6468210079367587, 'support': 765202}, '2': {'precision': 0.4908032322013763, 'recall': 0.3372923896641585, 'f1-score': 0.3998190321817109, 'support': 395633}, 'accuracy': 0.5452988736955253, 'macro avg': {'precision': 0.519061551024345, 'recall': 0.511017480850082, 'f1-score': 0.5080814359725697, 'support': 1554553}, 'weighted avg': {'precision': 0.5475663316816212, 'recall': 0.5452988736955253, 'f1-score': 0.5411019947108598, 'support': 1554553}}
[[212761 133207  47750]
 [173016 501491  90695]
 [111456 150733 133444]]
Evaluating performance on  val set...
1786/1786 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98730004
{'0': {'precision': 0.44236601054853636, 'recall': 0.5608981950826661, 'f1-score': 0.49463001966962, 'support': 126654}, '1': {'precision': 0.6009547161936561, 'recall': 0.5671862998050144, 'f1-score': 0.5835824222589241, 'support': 203092}, '2': {'precision': 0.4780453865289122, 'recall': 0.39355491737677134, 'f1-score': 0.43170501835458563, 'support': 127446}, 'accuracy': 0.5170431678594551, 'macro avg': {'precision': 0.5071220377570349, 'recall': 0.507213137421484, 'f1-score': 0.5033058200943766, 'support': 457192}, 'weighted avg': {'precision': 0.5227595676494341, 'recall': 0.5170431678594551, 'f1-score': 0.5166032423617736, 'support': 457192}}
[[ 71040  35361  20253]
 [ 53390 115191  34511]
 [ 36161  41128  50157]]
training model: results/universal/W1/deepOF_L2/h20
Epoch 1/50
10622/10622 - 233s - loss: 2.7568 - accuracy20: 0.5495 - val_loss: 3.0908 - val_accuracy20: 0.5386 - 233s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 231s - loss: 2.6796 - accuracy20: 0.5678 - val_loss: 3.0888 - val_accuracy20: 0.5368 - 231s/epoch - 22ms/step
Epoch 3/50
10622/10622 - 232s - loss: 2.6580 - accuracy20: 0.5720 - val_loss: 3.0982 - val_accuracy20: 0.5377 - 232s/epoch - 22ms/step
Epoch 4/50
10622/10622 - 231s - loss: 2.6452 - accuracy20: 0.5746 - val_loss: 3.0746 - val_accuracy20: 0.5394 - 231s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 230s - loss: 2.6352 - accuracy20: 0.5765 - val_loss: 3.0641 - val_accuracy20: 0.5414 - 230s/epoch - 22ms/step
Epoch 6/50
10622/10622 - 231s - loss: 2.6278 - accuracy20: 0.5779 - val_loss: 3.0358 - val_accuracy20: 0.5439 - 231s/epoch - 22ms/step
Epoch 7/50
10622/10622 - 232s - loss: 2.6214 - accuracy20: 0.5791 - val_loss: 3.0179 - val_accuracy20: 0.5459 - 232s/epoch - 22ms/step
Epoch 8/50
10622/10622 - 231s - loss: 2.6153 - accuracy20: 0.5801 - val_loss: 3.0017 - val_accuracy20: 0.5471 - 231s/epoch - 22ms/step
Epoch 9/50
10622/10622 - 231s - loss: 2.6100 - accuracy20: 0.5811 - val_loss: 3.0053 - val_accuracy20: 0.5472 - 231s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 231s - loss: 2.6061 - accuracy20: 0.5817 - val_loss: 2.9860 - val_accuracy20: 0.5480 - 231s/epoch - 22ms/step
Epoch 11/50
10622/10622 - 232s - loss: 2.6020 - accuracy20: 0.5825 - val_loss: 2.9854 - val_accuracy20: 0.5494 - 232s/epoch - 22ms/step
Epoch 12/50
10622/10622 - 232s - loss: 2.5985 - accuracy20: 0.5828 - val_loss: 2.9718 - val_accuracy20: 0.5498 - 232s/epoch - 22ms/step
Epoch 13/50
10622/10622 - 232s - loss: 2.5954 - accuracy20: 0.5833 - val_loss: 2.9707 - val_accuracy20: 0.5492 - 232s/epoch - 22ms/step
Epoch 14/50
10622/10622 - 234s - loss: 2.5930 - accuracy20: 0.5840 - val_loss: 2.9584 - val_accuracy20: 0.5513 - 234s/epoch - 22ms/step
Epoch 15/50
10622/10622 - 238s - loss: 2.5899 - accuracy20: 0.5844 - val_loss: 2.9587 - val_accuracy20: 0.5521 - 238s/epoch - 22ms/step
Epoch 16/50
10622/10622 - 239s - loss: 2.5873 - accuracy20: 0.5850 - val_loss: 2.9456 - val_accuracy20: 0.5529 - 239s/epoch - 23ms/step
Epoch 17/50
10622/10622 - 238s - loss: 2.5846 - accuracy20: 0.5854 - val_loss: 2.9350 - val_accuracy20: 0.5536 - 238s/epoch - 22ms/step
Epoch 18/50
10622/10622 - 234s - loss: 2.5830 - accuracy20: 0.5857 - val_loss: 2.9318 - val_accuracy20: 0.5543 - 234s/epoch - 22ms/step
Epoch 19/50
10622/10622 - 233s - loss: 2.5809 - accuracy20: 0.5860 - val_loss: 2.9384 - val_accuracy20: 0.5542 - 233s/epoch - 22ms/step
Epoch 20/50
10622/10622 - 232s - loss: 2.5790 - accuracy20: 0.5863 - val_loss: 2.9263 - val_accuracy20: 0.5558 - 232s/epoch - 22ms/step
Epoch 21/50
10622/10622 - 232s - loss: 2.5769 - accuracy20: 0.5866 - val_loss: 2.9288 - val_accuracy20: 0.5546 - 232s/epoch - 22ms/step
Epoch 22/50
10622/10622 - 235s - loss: 2.5750 - accuracy20: 0.5871 - val_loss: 2.9273 - val_accuracy20: 0.5572 - 235s/epoch - 22ms/step
Epoch 23/50
10622/10622 - 231s - loss: 2.5734 - accuracy20: 0.5875 - val_loss: 2.9286 - val_accuracy20: 0.5571 - 231s/epoch - 22ms/step
Epoch 24/50
10622/10622 - 232s - loss: 2.5718 - accuracy20: 0.5876 - val_loss: 2.9188 - val_accuracy20: 0.5570 - 232s/epoch - 22ms/step
Epoch 25/50
10622/10622 - 229s - loss: 2.5706 - accuracy20: 0.5877 - val_loss: 2.9228 - val_accuracy20: 0.5572 - 229s/epoch - 22ms/step
Epoch 26/50
10622/10622 - 231s - loss: 2.5689 - accuracy20: 0.5881 - val_loss: 2.9026 - val_accuracy20: 0.5590 - 231s/epoch - 22ms/step
Epoch 27/50
10622/10622 - 230s - loss: 2.5675 - accuracy20: 0.5884 - val_loss: 2.9176 - val_accuracy20: 0.5581 - 230s/epoch - 22ms/step
Epoch 28/50
10622/10622 - 230s - loss: 2.5658 - accuracy20: 0.5886 - val_loss: 2.9196 - val_accuracy20: 0.5583 - 230s/epoch - 22ms/step
Epoch 29/50
10622/10622 - 229s - loss: 2.5648 - accuracy20: 0.5888 - val_loss: 2.9076 - val_accuracy20: 0.5586 - 229s/epoch - 22ms/step
Epoch 30/50
10622/10622 - 231s - loss: 2.5632 - accuracy20: 0.5891 - val_loss: 2.8999 - val_accuracy20: 0.5590 - 231s/epoch - 22ms/step
Epoch 31/50
10622/10622 - 231s - loss: 2.5620 - accuracy20: 0.5896 - val_loss: 2.9096 - val_accuracy20: 0.5584 - 231s/epoch - 22ms/step
Epoch 32/50
10622/10622 - 230s - loss: 2.5607 - accuracy20: 0.5896 - val_loss: 2.9073 - val_accuracy20: 0.5588 - 230s/epoch - 22ms/step
Epoch 33/50
10622/10622 - 231s - loss: 2.5595 - accuracy20: 0.5898 - val_loss: 2.9074 - val_accuracy20: 0.5583 - 231s/epoch - 22ms/step
Epoch 34/50
10622/10622 - 230s - loss: 2.5583 - accuracy20: 0.5902 - val_loss: 2.9164 - val_accuracy20: 0.5576 - 230s/epoch - 22ms/step
Epoch 35/50
10622/10622 - 232s - loss: 2.5568 - accuracy20: 0.5905 - val_loss: 2.9124 - val_accuracy20: 0.5589 - 232s/epoch - 22ms/step
Epoch 36/50
10622/10622 - 230s - loss: 2.5560 - accuracy20: 0.5907 - val_loss: 2.9182 - val_accuracy20: 0.5579 - 230s/epoch - 22ms/step
Epoch 37/50
10622/10622 - 231s - loss: 2.5543 - accuracy20: 0.5909 - val_loss: 2.9140 - val_accuracy20: 0.5574 - 231s/epoch - 22ms/step
Epoch 38/50
10622/10622 - 231s - loss: 2.5533 - accuracy20: 0.5908 - val_loss: 2.9081 - val_accuracy20: 0.5589 - 231s/epoch - 22ms/step
Epoch 39/50
10622/10622 - 231s - loss: 2.5521 - accuracy20: 0.5910 - val_loss: 2.9146 - val_accuracy20: 0.5579 - 231s/epoch - 22ms/step
Epoch 40/50
10622/10622 - 231s - loss: 2.5514 - accuracy20: 0.5914 - val_loss: 2.9219 - val_accuracy20: 0.5574 - 231s/epoch - 22ms/step
testing model in sample: results/universal/W1/deepOF_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 286s - 286s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93993294
{'0': {'precision': 0.49135489253326203, 'recall': 0.5480067205520512, 'f1-score': 0.518136863810183, 'support': 2931902}, '1': {'precision': 0.618637617528584, 'recall': 0.6322831201086695, 'f1-score': 0.625385943743136, 'support': 3175133}, '2': {'precision': 0.5105911331995073, 'recall': 0.43971383678927356, 'f1-score': 0.472509338159915, 'support': 2939721}, 'accuracy': 0.542395638834517, 'macro avg': {'precision': 0.5401945477537845, 'recall': 0.5400012258166648, 'f1-score': 0.5386773819044114, 'support': 9046756}, 'weighted avg': {'precision': 0.5422779815510478, 'recall': 0.542395638834517, 'f1-score': 0.5409514392870307, 'support': 9046756}}
[[1606702  590072  735128]
 [ 663668 2007583  503882]
 [ 999572  647513 1292636]]
Evaluating performance on  train set...
10622/10622 - 87s - 87s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9028177
{'0': {'precision': 0.4910465531610906, 'recall': 0.44843788013259706, 'f1-score': 0.46877599573199363, 'support': 735763}, '1': {'precision': 0.627292317425171, 'recall': 0.7633791092462853, 'f1-score': 0.6886771976889051, 'support': 1246944}, '2': {'precision': 0.5109698732449999, 'recall': 0.3674483965838729, 'f1-score': 0.42748441619529864, 'support': 735804}, 'accuracy': 0.5709761704109345, 'macro avg': {'precision': 0.5431029146104205, 'recall': 0.5264217953209184, 'f1-score': 0.5283125365387324, 'support': 2718511}, 'weighted avg': {'precision': 0.55893316347296, 'recall': 0.5709761704109345, 'f1-score': 0.5584655261343134, 'support': 2718511}}
[[329944 273854 131965]
 [168257 951891 126796]
 [173719 291715 270370]]
Evaluating performance on  val set...
3064/3064 - 25s - 25s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91882205
{'0': {'precision': 0.4922738961203202, 'recall': 0.47277790023436694, 'f1-score': 0.48232896892597027, 'support': 222301}, '1': {'precision': 0.6265652037836482, 'recall': 0.7137380963605506, 'f1-score': 0.667316801721205, 'support': 339392}, '2': {'precision': 0.4946969531981619, 'recall': 0.4091263176380002, 'f1-score': 0.4478608801949964, 'support': 222083}, 'accuracy': 0.5590832074470257, 'macro avg': {'precision': 0.5378453510340434, 'recall': 0.5318807714109727, 'f1-score': 0.5325022169473905, 'support': 783776}, 'weighted avg': {'precision': 0.551111517169562, 'recall': 0.5590832074470257, 'f1-score': 0.5526661749623881, 'support': 783776}}
[[105099  70281  46921]
 [ 51268 242237  45887]
 [ 57130  74093  90860]]
testing model out of sample: results/universal/W1/deepOF_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 195s - 195s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7825684
{'0': {'precision': 0.5213793914946474, 'recall': 0.4439803750142008, 'f1-score': 0.47957709817886357, 'support': 1417173}, '1': {'precision': 0.7055741460989409, 'recall': 0.8690833033503742, 'f1-score': 0.7788394991745471, 'support': 3274082}, '2': {'precision': 0.567297568648255, 'recall': 0.3463473673145273, 'f1-score': 0.4301058576507214, 'support': 1407916}, 'accuracy': 0.6496415660423359, 'macro avg': {'precision': 0.5980837020806145, 'recall': 0.5531370152263674, 'f1-score': 0.5628408183347107, 'support': 6099171}, 'weighted avg': {'precision': 0.630856182168287, 'recall': 0.6496415660423359, 'f1-score': 0.6288036552465913, 'support': 6099171}}
[[ 629197  582985  204991]
 [ 261688 2845450  166944]
 [ 315908  604380  487628]]
Evaluating performance on  train set...
6711/6711 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7897979
{'0': {'precision': 0.5022727141128308, 'recall': 0.4490895818340901, 'f1-score': 0.4741946240850175, 'support': 386306}, '1': {'precision': 0.7128734485677927, 'recall': 0.8494863806810611, 'f1-score': 0.7752071889849187, 'support': 945642}, '2': {'precision': 0.543981878290682, 'recall': 0.3458915308076797, 'f1-score': 0.42288874505025886, 'support': 385326}, 'accuracy': 0.6464181021782197, 'macro avg': {'precision': 0.5863760136571018, 'recall': 0.5481558311076103, 'f1-score': 0.5574301860400651, 'support': 1717274}, 'weighted avg': {'precision': 0.6276018841389616, 'recall': 0.6464181021782197, 'f1-score': 0.6284394532457251, 'support': 1717274}}
[[173486 156946  55874]
 [ 86477 803310  55855]
 [ 85439 166606 133281]]
Evaluating performance on  val set...
1720/1720 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75346935
{'0': {'precision': 0.5158554843776845, 'recall': 0.44583859232311235, 'f1-score': 0.4782982209604651, 'support': 94283}, '1': {'precision': 0.7374690395686123, 'recall': 0.8667644959149678, 'f1-score': 0.7969063932351964, 'support': 252140}, '2': {'precision': 0.5396249536432384, 'recall': 0.3582116710193946, 'f1-score': 0.43059049064954613, 'support': 93428}, 'accuracy': 0.6685172933561593, 'macro avg': {'precision': 0.5976498258631784, 'recall': 0.5569382530858249, 'f1-score': 0.5685983682817358, 'support': 439851}, 'weighted avg': {'precision': 0.6479419768043988, 'recall': 0.6685172933561593, 'f1-score': 0.6508035164579454, 'support': 439851}}
[[ 42035  37832  14416]
 [ 19458 218546  14136]
 [ 19993  39968  33467]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1273543
{'0': {'precision': 0.41297449632665356, 'recall': 0.6363093955615957, 'f1-score': 0.5008740802588322, 'support': 60337}, '1': {'precision': 0.4950901708998206, 'recall': 0.21229174679649385, 'f1-score': 0.2971621257845596, 'support': 49399}, '2': {'precision': 0.45228148521626393, 'recall': 0.41898677164828935, 'f1-score': 0.4349979650332089, 'support': 59947}, 'accuracy': 0.43608964952293394, 'macro avg': {'precision': 0.4534487174809127, 'recall': 0.42252930466879296, 'f1-score': 0.41101139035886686, 'support': 169683}, 'weighted avg': {'precision': 0.45076713478310093, 'recall': 0.43608964952293394, 'f1-score': 0.4182951400084534, 'support': 169683}}
[[38393  5413 16531]
 [25026 10487 13886]
 [29548  5282 25117]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1745043
{'0': {'precision': 0.3617126746599746, 'recall': 0.5966373671300081, 'f1-score': 0.4503809431960652, 'support': 19568}, '1': {'precision': 0.5573705179282868, 'recall': 0.2666590423909729, 'f1-score': 0.3607343613016348, 'support': 26232}, '2': {'precision': 0.39426622418879054, 'recall': 0.41277807267287553, 'f1-score': 0.4033098375727858, 'support': 20723}, 'accuracy': 0.4092419163296905, 'macro avg': {'precision': 0.43778313892568405, 'recall': 0.4253581607312855, 'f1-score': 0.40480838069016195, 'support': 66523}, 'weighted avg': {'precision': 0.44900735095990124, 'recall': 0.4092419163296905, 'f1-score': 0.4003672087269956, 'support': 66523}}
[[11675  2523  5370]
 [11465  6995  7772]
 [ 9137  3032  8554]]
Evaluating performance on  val set...
51/51 - 1s - 668ms/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1720436
{'0': {'precision': 0.37670682730923694, 'recall': 0.6054737929253808, 'f1-score': 0.46444840562487627, 'support': 3873}, '1': {'precision': 0.5613382899628253, 'recall': 0.2616984402079723, 'f1-score': 0.35697399527186763, 'support': 5193}, '2': {'precision': 0.39276362770768863, 'recall': 0.4363924887595874, 'f1-score': 0.4134302179904786, 'support': 3781}, 'accuracy': 0.4167509924495991, 'macro avg': {'precision': 0.44360291499325033, 'recall': 0.4345215739643135, 'f1-score': 0.41161753962907416, 'support': 12847}, 'weighted avg': {'precision': 0.45606402726771983, 'recall': 0.4167509924495991, 'f1-score': 0.4059900588973265, 'support': 12847}}
[[2345  506 1022]
 [2305 1359 1529]
 [1575  556 1650]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5444984
{'0': {'precision': 0.46806092293703117, 'recall': 0.4399948713565262, 'f1-score': 0.45359416650144296, 'support': 46796}, '1': {'precision': 0.8672310645834108, 'recall': 0.9240909603641342, 'f1-score': 0.8947585930027985, 'support': 328011}, '2': {'precision': 0.6041166630300385, 'recall': 0.3595826659162734, 'f1-score': 0.450825010855406, 'support': 46198}, 'accuracy': 0.8083371931449745, 'macro avg': {'precision': 0.6464695501834935, 'recall': 0.574556165878978, 'f1-score': 0.5997259234532158, 'support': 421005}, 'weighted avg': {'precision': 0.7939898321243032, 'recall': 0.8083371931449745, 'f1-score': 0.7970077963837496, 'support': 421005}}
[[ 20590  23004   3202]
 [ 17215 303112   7684]
 [  6185  23401  16612]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6514076
{'0': {'precision': 0.5258654836409729, 'recall': 0.4690337396219749, 'f1-score': 0.4958264084704301, 'support': 28305}, '1': {'precision': 0.8003964033645944, 'recall': 0.8958446055621686, 'f1-score': 0.8454350490196079, 'support': 110892}, '2': {'precision': 0.5645363408521303, 'recall': 0.35752678474802496, 'f1-score': 0.4377940234556177, 'support': 27721}, 'accuracy': 0.7340670269233995, 'macro avg': {'precision': 0.6302660759525659, 'recall': 0.5741350433107228, 'f1-score': 0.5930184936485519, 'support': 166918}, 'weighted avg': {'precision': 0.7146724282649339, 'recall': 0.7340670269233995, 'f1-score': 0.718451204015451, 'support': 166918}}
[[13276 11678  3351]
 [ 7256 99342  4294]
 [ 4714 13096  9911]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60976726
{'0': {'precision': 0.6172734970364098, 'recall': 0.421875, 'f1-score': 0.5012031625988312, 'support': 6912}, '1': {'precision': 0.8244722973157478, 'recall': 0.9224024684569089, 'f1-score': 0.8706923897684344, 'support': 32733}, '2': {'precision': 0.5547017189079879, 'recall': 0.4127915726109857, 'f1-score': 0.4733390854184642, 'support': 6645}, 'accuracy': 0.7745085331605098, 'macro avg': {'precision': 0.6654825044200484, 'recall': 0.5856896803559648, 'f1-score': 0.6150782125952433, 'support': 46290}, 'weighted avg': {'precision': 0.7548074971202337, 'recall': 0.7745085331605098, 'f1-score': 0.7584797683469211, 'support': 46290}}
[[ 2916  3194   802]
 [ 1140 30193  1400]
 [  668  3234  2743]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0345215
{'0': {'precision': 0.4958086401941417, 'recall': 0.5238623838150108, 'f1-score': 0.5094495970807359, 'support': 127921}, '1': {'precision': 0.40057645539976583, 'recall': 0.5237359991625667, 'f1-score': 0.4539510618390088, 'support': 76424}, '2': {'precision': 0.5328918758647954, 'recall': 0.40873289618314823, 'f1-score': 0.4626268259722431, 'support': 131915}, 'accuracy': 0.4786682923927913, 'macro avg': {'precision': 0.476425657152901, 'recall': 0.4854437597202419, 'f1-score': 0.47534249496399594, 'support': 336260}, 'weighted avg': {'precision': 0.4887123770131773, 'recall': 0.4786682923927913, 'f1-score': 0.478467482324028, 'support': 336260}}
[[67013 29126 31782]
 [20918 40026 15480]
 [47228 30769 53918]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9313229
{'0': {'precision': 0.5099508917032824, 'recall': 0.5072216509301674, 'f1-score': 0.5085826098163967, 'support': 42788}, '1': {'precision': 0.574354189175916, 'recall': 0.7387715567160094, 'f1-score': 0.6462694677509969, 'support': 47491}, '2': {'precision': 0.5363645342903236, 'recall': 0.37245936121081874, 'f1-score': 0.43963190846286704, 'support': 43739}, 'accuracy': 0.5452924234058112, 'macro avg': {'precision': 0.5402232050565073, 'recall': 0.5394841896189985, 'f1-score': 0.5314946620100869, 'support': 134018}, 'weighted avg': {'precision': 0.5413935584598929, 'recall': 0.5452924234058112, 'f1-score': 0.5348705102750669, 'support': 134018}}
[[21703 12199  8886]
 [ 7210 35085  5196]
 [13646 13802 16291]]
Evaluating performance on  val set...
107/107 - 1s - 983ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0103945
{'0': {'precision': 0.5056714233443103, 'recall': 0.535036778939218, 'f1-score': 0.5199398043641836, 'support': 10332}, '1': {'precision': 0.4253348353986732, 'recall': 0.5229301323484149, 'f1-score': 0.4691102367639953, 'support': 6498}, '2': {'precision': 0.5218814401745666, 'recall': 0.41634429400386846, 'f1-score': 0.46317714777556623, 'support': 10340}, 'accuracy': 0.4869709238130291, 'macro avg': {'precision': 0.48429589963918335, 'recall': 0.49143706843050045, 'f1-score': 0.48407572963458173, 'support': 27170}, 'weighted avg': {'precision': 0.49262705181520094, 'recall': 0.4869709238130291, 'f1-score': 0.4861813796533876, 'support': 27170}}
[[5528 2226 2578]
 [1734 3398 1366]
 [3670 2365 4305]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3217642
{'0': {'precision': 0.36493161432978477, 'recall': 0.5298747702106725, 'f1-score': 0.4322008841832568, 'support': 115867}, '1': {'precision': 0.7453135100193924, 'recall': 0.05395060688583808, 'f1-score': 0.10061784417760403, 'support': 106857}, '2': {'precision': 0.3371428209223904, 'recall': 0.47912838251720535, 'f1-score': 0.39578682620472067, 'support': 111012}, 'accuracy': 0.36061138145120697, 'macro avg': {'precision': 0.48246264842385583, 'recall': 0.3543179198712387, 'f1-score': 0.3095351848551939, 'support': 333736}, 'weighted avg': {'precision': 0.47748039148886484, 'recall': 0.36061138145120697, 'f1-score': 0.3139206677541113, 'support': 333736}}
[[61395  1034 53438]
 [49955  5765 51137]
 [56887   936 53189]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3442621
{'0': {'precision': 0.3713116351588384, 'recall': 0.5645371577574967, 'f1-score': 0.4479766747395894, 'support': 33748}, '1': {'precision': 0.616414686825054, 'recall': 0.043785094044368075, 'f1-score': 0.08176244771672492, 'support': 32591}, '2': {'precision': 0.3491483639623487, 'recall': 0.48827806682128755, 'f1-score': 0.40715573791913856, 'support': 31906}, 'accuracy': 0.36702122245406893, 'macro avg': {'precision': 0.44562489531541366, 'recall': 0.3655334395410508, 'f1-score': 0.31229828679181765, 'support': 98245}, 'weighted avg': {'precision': 0.4454224013663648, 'recall': 0.36702122245406893, 'f1-score': 0.31323474707817683, 'support': 98245}}
[[19052   420 14276]
 [16399  1427 14765]
 [15859   468 15579]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.3301033
{'0': {'precision': 0.3588855421686747, 'recall': 0.5905092305786148, 'f1-score': 0.44644278956489153, 'support': 8071}, '1': {'precision': 0.4801864801864802, 'recall': 0.027785271108713244, 'f1-score': 0.05253091929108759, 'support': 7414}, '2': {'precision': 0.35907023749368366, 'recall': 0.43761546988545386, 'f1-score': 0.39447096702564666, 'support': 8119}, 'accuracy': 0.3611675987120827, 'macro avg': {'precision': 0.39938075328294614, 'recall': 0.35196999052426065, 'f1-score': 0.29781489196054195, 'support': 23604}, 'weighted avg': {'precision': 0.39704961164027947, 'recall': 0.3611675987120827, 'f1-score': 0.30483874646176873, 'support': 23604}}
[[4766   98 3207]
 [4073  206 3135]
 [4441  125 3553]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 22s - 22s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0128102
{'0': {'precision': 0.48831067716005216, 'recall': 0.5484032329216032, 'f1-score': 0.516615338948462, 'support': 253888}, '1': {'precision': 0.4459964631880554, 'recall': 0.481279288854534, 'f1-score': 0.4629666205806834, 'support': 165592}, '2': {'precision': 0.5190114161871017, 'recall': 0.426144044030715, 'f1-score': 0.4680153331412998, 'support': 247827}, 'accuracy': 0.48634136911496506, 'macro avg': {'precision': 0.4844395188450698, 'recall': 0.48527552193561735, 'f1-score': 0.4825324308901484, 'support': 667307}, 'weighted avg': {'precision': 0.4892121763662732, 'recall': 0.48634136911496506, 'f1-score': 0.4852531739912102, 'support': 667307}}
[[139233  50762  63893]
 [ 51916  79696  33980]
 [ 93983  48234 105610]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0036161
{'0': {'precision': 0.4759080567976779, 'recall': 0.48850880159765503, 'f1-score': 0.4821261106607537, 'support': 62091}, '1': {'precision': 0.523577776853431, 'recall': 0.6260174731851262, 'f1-score': 0.5702334571592523, 'support': 60321}, '2': {'precision': 0.5054177505581614, 'recall': 0.3962773218558787, 'f1-score': 0.4442424024197033, 'support': 62267}, 'accuracy': 0.5023256569507091, 'macro avg': {'precision': 0.5016345280697568, 'recall': 0.5036011988795533, 'f1-score': 0.49886732341323653, 'support': 184679}, 'weighted avg': {'precision': 0.5014278250705574, 'recall': 0.5023256569507091, 'f1-score': 0.4981312784767504, 'support': 184679}}
[[30332 17323 14436]
 [12849 37762  9710]
 [20554 17038 24675]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0190585
{'0': {'precision': 0.4961605042389809, 'recall': 0.5238787083470029, 'f1-score': 0.5096430036930653, 'support': 21337}, '1': {'precision': 0.4581151832460733, 'recall': 0.538737814263725, 'f1-score': 0.49516623437868423, 'support': 15592}, '2': {'precision': 0.5078877160422225, 'recall': 0.41349513646236663, 'f1-score': 0.45585632483081734, 'support': 21178}, 'accuracy': 0.48763488047911613, 'macro avg': {'precision': 0.4873878011757589, 'recall': 0.4920372196910315, 'f1-score': 0.4868885209675223, 'support': 58107}, 'weighted avg': {'precision': 0.49022587066036966, 'recall': 0.48763488047911613, 'f1-score': 0.486155023379256, 'support': 58107}}
[[11178  4791  5368]
 [ 4075  8400  3117]
 [ 7276  5145  8757]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/EXC
Evaluating performance on  test set...
5343/5343 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6254516
{'0': {'precision': 0.5372775134099806, 'recall': 0.4940207596669328, 'f1-score': 0.5147419563398493, 'support': 219175}, '1': {'precision': 0.7950715617981805, 'recall': 0.9012247266639628, 'f1-score': 0.8448266447714349, 'support': 927064}, '2': {'precision': 0.6469869601005068, 'recall': 0.33705116342052405, 'f1-score': 0.44320987654320987, 'support': 221545}, 'accuracy': 0.7445927134693782, 'macro avg': {'precision': 0.6597786784362226, 'recall': 0.5774322165838065, 'f1-score': 0.6009261592181647, 'support': 1367784}, 'weighted avg': {'precision': 0.7297765929737208, 'recall': 0.7445927134693782, 'f1-score': 0.7268822189672766, 'support': 1367784}}
[[108277  94995  15903]
 [ 66731 835493  24840]
 [ 26521 120352  74672]]
Evaluating performance on  train set...
1290/1290 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.556426
{'0': {'precision': 0.5202683682086892, 'recall': 0.49472439715362826, 'f1-score': 0.5071749545490927, 'support': 44829}, '1': {'precision': 0.8340614376470951, 'recall': 0.9067254187970585, 'f1-score': 0.8688768570987896, 'support': 239197}, '2': {'precision': 0.6211245592992404, 'recall': 0.3702845008775541, 'f1-score': 0.4639715464813206, 'support': 46151}, 'accuracy': 0.7758050984774832, 'macro avg': {'precision': 0.6584847883850081, 'recall': 0.5905781056094136, 'f1-score': 0.6133411193764009, 'support': 330177}, 'weighted avg': {'precision': 0.7616933460402111, 'recall': 0.7758050984774832, 'f1-score': 0.7631713731319865, 'support': 330177}}
[[ 22178  19360   3291]
 [ 15178 216886   7133]
 [  5272  23790  17089]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5613192
{'0': {'precision': 0.5227575192973117, 'recall': 0.4647054184083918, 'f1-score': 0.49202505219206677, 'support': 12679}, '1': {'precision': 0.8306144352025758, 'recall': 0.9164705359918291, 'f1-score': 0.8714328944312688, 'support': 67557}, '2': {'precision': 0.6085596473766529, 'recall': 0.33946700507614214, 'f1-score': 0.4358230232676544, 'support': 12608}, 'accuracy': 0.7764206626168627, 'macro avg': {'precision': 0.6539772006255135, 'recall': 0.5735476531587876, 'f1-score': 0.5997603232969967, 'support': 92844}, 'weighted avg': {'precision': 0.7584182286445638, 'recall': 0.7764206626168627, 'f1-score': 0.7604652359139528, 'support': 92844}}
[[ 5892  5867   920]
 [ 3810 61914  1833]
 [ 1569  6759  4280]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/AAL
Evaluating performance on  test set...
7177/7177 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.62650937
{'0': {'precision': 0.5501828363042157, 'recall': 0.3890427173384625, 'f1-score': 0.455789612705121, 'support': 283866}, '1': {'precision': 0.7898874779244807, 'recall': 0.9224800841654678, 'f1-score': 0.8510503039752731, 'support': 1272731}, '2': {'precision': 0.6072821586446464, 'recall': 0.32472806226313516, 'f1-score': 0.423174669547239, 'support': 280487}, 'accuracy': 0.7487882971056304, 'macro avg': {'precision': 0.6491174909577809, 'recall': 0.5454169545890218, 'f1-score': 0.5766715287425443, 'support': 1837084}, 'weighted avg': {'precision': 0.7249680643391351, 'recall': 0.7487882971056304, 'f1-score': 0.7246463809854102, 'support': 1837084}}
[[ 110436  154489   18941]
 [  58702 1174069   39960]
 [  31588  157817   91082]]
Evaluating performance on  train set...
2257/2257 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6362534
{'0': {'precision': 0.5198631515395452, 'recall': 0.42500822639026, 'f1-score': 0.4676744817597538, 'support': 91170}, '1': {'precision': 0.7938120612439856, 'recall': 0.9145892919802188, 'f1-score': 0.8499314399257746, 'support': 396133}, '2': {'precision': 0.6041170794467674, 'recall': 0.3120935848722181, 'f1-score': 0.4115670606109301, 'support': 90271}, 'accuracy': 0.7431428700045362, 'macro avg': {'precision': 0.6392640974100994, 'recall': 0.5505637010808989, 'f1-score': 0.5763909940988194, 'support': 577574}, 'weighted avg': {'precision': 0.7209211800762556, 'recall': 0.7431428700045362, 'f1-score': 0.7210787599901708, 'support': 577574}}
[[ 38748  44942   7480]
 [ 22852 362299  10982]
 [ 12935  49163  28173]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6118758
{'0': {'precision': 0.5463170781473169, 'recall': 0.44123099740452354, 'f1-score': 0.4881828748547075, 'support': 24273}, '1': {'precision': 0.8133484778938688, 'recall': 0.9113788323904004, 'f1-score': 0.8595777218686794, 'support': 114713}, '2': {'precision': 0.577054794520548, 'recall': 0.35996877696068363, 'f1-score': 0.44336495888678057, 'support': 24341}, 'accuracy': 0.7593294433865803, 'macro avg': {'precision': 0.6455734501872445, 'recall': 0.5708595355852025, 'f1-score': 0.5970418518700559, 'support': 163327}, 'weighted avg': {'precision': 0.7384479549366231, 'recall': 0.7593294433865803, 'f1-score': 0.7423533683612217, 'support': 163327}}
[[ 10710  11421   2142]
 [  5886 104547   4280]
 [  3008  12571   8762]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/WBA
Evaluating performance on  test set...
5696/5696 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94588935
{'0': {'precision': 0.4996235054834829, 'recall': 0.41639611517388625, 'f1-score': 0.45422888776898274, 'support': 431834}, '1': {'precision': 0.5634238492900604, 'recall': 0.7443827110730145, 'f1-score': 0.6413838026646593, 'support': 607811}, '2': {'precision': 0.5308613526537307, 'recall': 0.3744353138579357, 'f1-score': 0.43913392051220235, 'support': 418374}, 'accuracy': 0.5410848555471499, 'macro avg': {'precision': 0.531302902475758, 'recall': 0.5117380467016122, 'f1-score': 0.5115822036486147, 'support': 1458019}, 'weighted avg': {'precision': 0.5351838471809676, 'recall': 0.5410848555471499, 'f1-score': 0.5279175531063809, 'support': 1458019}}
[[179814 182712  69308]
 [ 86235 452444  69132]
 [ 93850 167870 156654]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81319225
{'0': {'precision': 0.5422709387296234, 'recall': 0.4229996272937875, 'f1-score': 0.47526654815520347, 'support': 136837}, '1': {'precision': 0.6720700944911676, 'recall': 0.85025833218182, 'f1-score': 0.7507357645553424, 'support': 296711}, '2': {'precision': 0.5526537879050625, 'recall': 0.3539201895313541, 'f1-score': 0.43150440720497907, 'support': 135070}, 'accuracy': 0.6295386357800844, 'macro avg': {'precision': 0.5889982737086178, 'recall': 0.5423927163356539, 'f1-score': 0.5525022399718417, 'support': 568618}, 'weighted avg': {'precision': 0.61246788772401, 'recall': 0.6295386357800844, 'f1-score': 0.6086140578878444, 'support': 568618}}
[[ 57882  60084  18871]
 [ 24606 252281  19824]
 [ 24252  63014  47804]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8452207
{'0': {'precision': 0.5133329150458025, 'recall': 0.4145260171251963, 'f1-score': 0.45866853538892777, 'support': 39474}, '1': {'precision': 0.6805268238863605, 'recall': 0.7998031837916064, 'f1-score': 0.735359707061084, 'support': 86375}, '2': {'precision': 0.4912989230365117, 'recall': 0.3937942469142301, 'f1-score': 0.4371758724964574, 'support': 37997}, 'accuracy': 0.6128254580520733, 'macro avg': {'precision': 0.5617195539895582, 'recall': 0.536041149277011, 'f1-score': 0.5437347049821564, 'support': 163846}, 'weighted avg': {'precision': 0.5963630059953904, 'recall': 0.6128254580520733, 'f1-score': 0.59954803956515, 'support': 163846}}
[[16363 16620  6491]
 [ 8290 69083  9002]
 [ 7223 15811 14963]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 93s - 93s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7792241
{'0': {'precision': 0.5566034288127472, 'recall': 0.3966441972275635, 'f1-score': 0.4632028743939518, 'support': 691161}, '1': {'precision': 0.6859404356211468, 'recall': 0.9014565457420629, 'f1-score': 0.7790685038960171, 'support': 1709936}, '2': {'precision': 0.6065741873208009, 'recall': 0.307920144240556, 'f1-score': 0.4084801945869415, 'support': 687740}, 'accuracy': 0.6563463853871214, 'macro avg': {'precision': 0.6163726839182316, 'recall': 0.5353402957367276, 'f1-score': 0.5502505242923035, 'support': 3088837}, 'weighted avg': {'precision': 0.6393287048730433, 'recall': 0.6563463853871214, 'f1-score': 0.6258773810894396, 'support': 3088837}}
[[ 274145  343271   73745]
 [ 104894 1541433   63609]
 [ 113493  362478  211769]]
Evaluating performance on  train set...
2948/2948 - 24s - 24s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79634523
{'0': {'precision': 0.5351762953153452, 'recall': 0.4166993772299328, 'f1-score': 0.46856461489306334, 'support': 170689}, '1': {'precision': 0.6880652787310303, 'recall': 0.8686748582913122, 'f1-score': 0.7678931046772023, 'support': 415465}, '2': {'precision': 0.5694327103381484, 'recall': 0.3283390563549303, 'f1-score': 0.4165134295963585, 'support': 168326}, 'accuracy': 0.6458726540133602, 'macro avg': {'precision': 0.5975580947948412, 'recall': 0.5379044306253918, 'f1-score': 0.5509903830555415, 'support': 754480}, 'weighted avg': {'precision': 0.6270094344441836, 'recall': 0.6458726540133602, 'f1-score': 0.6217813246692193, 'support': 754480}}
[[ 71126  80094  19469]
 [ 32240 360904  22321]
 [ 29536  83522  55268]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.727674
{'0': {'precision': 0.5579047017986747, 'recall': 0.35905767668562144, 'f1-score': 0.43692079574941306, 'support': 34468}, '1': {'precision': 0.7255389658469258, 'recall': 0.9163367954677513, 'f1-score': 0.809851837289822, 'support': 110144}, '2': {'precision': 0.5889642272620996, 'recall': 0.2982123830945898, 'f1-score': 0.39594467148695384, 'support': 33788}, 'accuracy': 0.691597533632287, 'macro avg': {'precision': 0.6241359649692334, 'recall': 0.5245356184159875, 'f1-score': 0.547572434842063, 'support': 178400}, 'weighted avg': {'precision': 0.6672844530637463, 'recall': 0.691597533632287, 'f1-score': 0.6594074288931734, 'support': 178400}}
[[ 12376  18858   3234]
 [  5417 100929   3798]
 [  4390  19322  10076]]
testing model on single stock: results/universal/W1/deepOF_L2/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 165s - 165s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0240835
{'0': {'precision': 0.49548515687492667, 'recall': 0.5839781326862522, 'f1-score': 0.5361043760982392, 'support': 2118230}, '1': {'precision': 0.39753217327030577, 'recall': 0.3408838633139482, 'f1-score': 0.36703510298292286, 'support': 1205390}, '2': {'precision': 0.5122721710784914, 'recall': 0.4628893415078559, 'f1-score': 0.4863303665757131, 'support': 2142592}, 'accuracy': 0.482908639474649, 'macro avg': {'precision': 0.4684298337412413, 'recall': 0.4625837791693521, 'f1-score': 0.4631566152189584, 'support': 5466212}, 'weighted avg': {'precision': 0.48046491533092334, 'recall': 0.482908639474649, 'f1-score': 0.47931188328395397, 'support': 5466212}}
[[1237000  288002  593228]
 [ 443456  410898  351036]
 [ 816087  334722  991783]]
Evaluating performance on  train set...
6073/6073 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0084405
{'0': {'precision': 0.4875747865641876, 'recall': 0.4422165497394542, 'f1-score': 0.46378930720419814, 'support': 492044}, '1': {'precision': 0.5052456204891501, 'recall': 0.6727177902328064, 'f1-score': 0.5770768671532029, 'support': 567553}, '2': {'precision': 0.5093206278980729, 'recall': 0.36283831290054064, 'f1-score': 0.4237783475171698, 'support': 494956}, 'accuracy': 0.501097099938053, 'macro avg': {'precision': 0.5007136783171369, 'recall': 0.49259088429093373, 'f1-score': 0.488214840624857, 'support': 1554553}, 'weighted avg': {'precision': 0.5009499300619447, 'recall': 0.501097099938053, 'f1-score': 0.49241041561856846, 'support': 1554553}}
[[217590 182321  92133]
 [104867 381803  80883]
 [123813 191554 179589]]
Evaluating performance on  val set...
1786/1786 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0274626
{'0': {'precision': 0.4932152811936383, 'recall': 0.48466471175845066, 'f1-score': 0.4889026134442855, 'support': 155165}, '1': {'precision': 0.46634287760311394, 'recall': 0.5557038943521915, 'f1-score': 0.5071168175438265, 'support': 145313}, '2': {'precision': 0.49789828137945713, 'recall': 0.41797797261252984, 'f1-score': 0.4544511626132174, 'support': 156714}, 'accuracy': 0.4843851161000193, 'macro avg': {'precision': 0.4858188133920698, 'recall': 0.4861155262410573, 'f1-score': 0.48349019786710984, 'support': 457192}, 'weighted avg': {'precision': 0.486279425159785, 'recall': 0.4843851161000193, 'f1-score': 0.4828826830316287, 'support': 457192}}
[[75203 44403 35559]
 [34065 80751 30497]
 [43207 48004 65503]]
training model: results/universal/W1/deepOF_L2/h30
Epoch 1/50
10622/10622 - 237s - loss: 2.8337 - accuracy30: 0.5300 - val_loss: 3.0927 - val_accuracy30: 0.5077 - 237s/epoch - 22ms/step
Epoch 2/50
10622/10622 - 231s - loss: 2.7651 - accuracy30: 0.5474 - val_loss: 3.0969 - val_accuracy30: 0.5072 - 231s/epoch - 22ms/step
Epoch 3/50
10622/10622 - 233s - loss: 2.7485 - accuracy30: 0.5507 - val_loss: 3.1090 - val_accuracy30: 0.5069 - 233s/epoch - 22ms/step
Epoch 4/50
10622/10622 - 233s - loss: 2.7379 - accuracy30: 0.5532 - val_loss: 3.1158 - val_accuracy30: 0.5074 - 233s/epoch - 22ms/step
Epoch 5/50
10622/10622 - 231s - loss: 2.7300 - accuracy30: 0.5549 - val_loss: 3.1055 - val_accuracy30: 0.5094 - 231s/epoch - 22ms/step
Epoch 6/50
10622/10622 - 231s - loss: 2.7232 - accuracy30: 0.5566 - val_loss: 3.0932 - val_accuracy30: 0.5117 - 231s/epoch - 22ms/step
Epoch 7/50
10622/10622 - 233s - loss: 2.7180 - accuracy30: 0.5580 - val_loss: 3.0910 - val_accuracy30: 0.5117 - 233s/epoch - 22ms/step
Epoch 8/50
10622/10622 - 233s - loss: 2.7133 - accuracy30: 0.5589 - val_loss: 3.0914 - val_accuracy30: 0.5120 - 233s/epoch - 22ms/step
Epoch 9/50
10622/10622 - 232s - loss: 2.7095 - accuracy30: 0.5598 - val_loss: 3.0922 - val_accuracy30: 0.5145 - 232s/epoch - 22ms/step
Epoch 10/50
10622/10622 - 233s - loss: 2.7060 - accuracy30: 0.5605 - val_loss: 3.0717 - val_accuracy30: 0.5153 - 233s/epoch - 22ms/step
Epoch 11/50
10622/10622 - 233s - loss: 2.7033 - accuracy30: 0.5610 - val_loss: 3.0750 - val_accuracy30: 0.5157 - 233s/epoch - 22ms/step
Epoch 12/50
10622/10622 - 231s - loss: 2.6999 - accuracy30: 0.5619 - val_loss: 3.0761 - val_accuracy30: 0.5150 - 231s/epoch - 22ms/step
Epoch 13/50
10622/10622 - 232s - loss: 2.6970 - accuracy30: 0.5625 - val_loss: 3.0636 - val_accuracy30: 0.5174 - 232s/epoch - 22ms/step
Epoch 14/50
10622/10622 - 235s - loss: 2.6945 - accuracy30: 0.5630 - val_loss: 3.0605 - val_accuracy30: 0.5169 - 235s/epoch - 22ms/step
Epoch 15/50
10622/10622 - 233s - loss: 2.6926 - accuracy30: 0.5636 - val_loss: 3.0574 - val_accuracy30: 0.5181 - 233s/epoch - 22ms/step
Epoch 16/50
10622/10622 - 232s - loss: 2.6903 - accuracy30: 0.5638 - val_loss: 3.0762 - val_accuracy30: 0.5147 - 232s/epoch - 22ms/step
Epoch 17/50
10622/10622 - 234s - loss: 2.6879 - accuracy30: 0.5643 - val_loss: 3.0704 - val_accuracy30: 0.5159 - 234s/epoch - 22ms/step
Epoch 18/50
10622/10622 - 237s - loss: 2.6858 - accuracy30: 0.5648 - val_loss: 3.0667 - val_accuracy30: 0.5176 - 237s/epoch - 22ms/step
Epoch 19/50
10622/10622 - 235s - loss: 2.6837 - accuracy30: 0.5650 - val_loss: 3.0574 - val_accuracy30: 0.5179 - 235s/epoch - 22ms/step
Epoch 20/50
10622/10622 - 233s - loss: 2.6837 - accuracy30: 0.5653 - val_loss: 3.0570 - val_accuracy30: 0.5173 - 233s/epoch - 22ms/step
Epoch 21/50
10622/10622 - 232s - loss: 2.6810 - accuracy30: 0.5653 - val_loss: 3.0589 - val_accuracy30: 0.5159 - 232s/epoch - 22ms/step
Epoch 22/50
10622/10622 - 233s - loss: 2.6787 - accuracy30: 0.5659 - val_loss: 3.0516 - val_accuracy30: 0.5176 - 233s/epoch - 22ms/step
Epoch 23/50
10622/10622 - 233s - loss: 2.6768 - accuracy30: 0.5664 - val_loss: 3.0521 - val_accuracy30: 0.5173 - 233s/epoch - 22ms/step
Epoch 24/50
10622/10622 - 232s - loss: 2.6754 - accuracy30: 0.5666 - val_loss: 3.0569 - val_accuracy30: 0.5159 - 232s/epoch - 22ms/step
Epoch 25/50
10622/10622 - 231s - loss: 2.6738 - accuracy30: 0.5667 - val_loss: 3.0524 - val_accuracy30: 0.5187 - 231s/epoch - 22ms/step
Epoch 26/50
10622/10622 - 231s - loss: 2.6723 - accuracy30: 0.5673 - val_loss: 3.0511 - val_accuracy30: 0.5195 - 231s/epoch - 22ms/step
Epoch 27/50
10622/10622 - 232s - loss: 2.6709 - accuracy30: 0.5674 - val_loss: 3.0329 - val_accuracy30: 0.5224 - 232s/epoch - 22ms/step
Epoch 28/50
10622/10622 - 232s - loss: 2.6691 - accuracy30: 0.5679 - val_loss: 3.0384 - val_accuracy30: 0.5202 - 232s/epoch - 22ms/step
Epoch 29/50
10622/10622 - 232s - loss: 2.6677 - accuracy30: 0.5680 - val_loss: 3.0353 - val_accuracy30: 0.5205 - 232s/epoch - 22ms/step
Epoch 30/50
10622/10622 - 232s - loss: 2.6665 - accuracy30: 0.5684 - val_loss: 3.0383 - val_accuracy30: 0.5207 - 232s/epoch - 22ms/step
Epoch 31/50
10622/10622 - 232s - loss: 2.6652 - accuracy30: 0.5684 - val_loss: 3.0315 - val_accuracy30: 0.5214 - 232s/epoch - 22ms/step
Epoch 32/50
10622/10622 - 232s - loss: 2.6640 - accuracy30: 0.5687 - val_loss: 3.0321 - val_accuracy30: 0.5216 - 232s/epoch - 22ms/step
Epoch 33/50
10622/10622 - 232s - loss: 2.6626 - accuracy30: 0.5689 - val_loss: 3.0366 - val_accuracy30: 0.5213 - 232s/epoch - 22ms/step
Epoch 34/50
10622/10622 - 232s - loss: 2.6616 - accuracy30: 0.5692 - val_loss: 3.0390 - val_accuracy30: 0.5212 - 232s/epoch - 22ms/step
Epoch 35/50
10622/10622 - 233s - loss: 2.6600 - accuracy30: 0.5696 - val_loss: 3.0571 - val_accuracy30: 0.5190 - 233s/epoch - 22ms/step
Epoch 36/50
10622/10622 - 230s - loss: 2.6590 - accuracy30: 0.5695 - val_loss: 3.0288 - val_accuracy30: 0.5231 - 230s/epoch - 22ms/step
Epoch 37/50
10622/10622 - 231s - loss: 2.6579 - accuracy30: 0.5698 - val_loss: 3.0381 - val_accuracy30: 0.5216 - 231s/epoch - 22ms/step
Epoch 38/50
10622/10622 - 232s - loss: 2.6568 - accuracy30: 0.5701 - val_loss: 3.0291 - val_accuracy30: 0.5228 - 232s/epoch - 22ms/step
Epoch 39/50
10622/10622 - 232s - loss: 2.6559 - accuracy30: 0.5703 - val_loss: 3.0266 - val_accuracy30: 0.5230 - 232s/epoch - 22ms/step
Epoch 40/50
10622/10622 - 234s - loss: 2.6543 - accuracy30: 0.5706 - val_loss: 3.0236 - val_accuracy30: 0.5231 - 234s/epoch - 22ms/step
Epoch 41/50
10622/10622 - 232s - loss: 2.6533 - accuracy30: 0.5707 - val_loss: 3.0200 - val_accuracy30: 0.5233 - 232s/epoch - 22ms/step
Epoch 42/50
10622/10622 - 233s - loss: 2.6520 - accuracy30: 0.5710 - val_loss: 3.0168 - val_accuracy30: 0.5239 - 233s/epoch - 22ms/step
Epoch 43/50
10622/10622 - 232s - loss: 2.6513 - accuracy30: 0.5711 - val_loss: 3.0289 - val_accuracy30: 0.5221 - 232s/epoch - 22ms/step
Epoch 44/50
10622/10622 - 230s - loss: 2.6495 - accuracy30: 0.5714 - val_loss: 3.0241 - val_accuracy30: 0.5234 - 230s/epoch - 22ms/step
Epoch 45/50
10622/10622 - 232s - loss: 2.6489 - accuracy30: 0.5714 - val_loss: 3.0297 - val_accuracy30: 0.5234 - 232s/epoch - 22ms/step
Epoch 46/50
10622/10622 - 233s - loss: 2.6481 - accuracy30: 0.5717 - val_loss: 3.0102 - val_accuracy30: 0.5259 - 233s/epoch - 22ms/step
Epoch 47/50
10622/10622 - 232s - loss: 2.6468 - accuracy30: 0.5718 - val_loss: 3.0193 - val_accuracy30: 0.5246 - 232s/epoch - 22ms/step
Epoch 48/50
10622/10622 - 234s - loss: 2.6459 - accuracy30: 0.5722 - val_loss: 3.0281 - val_accuracy30: 0.5238 - 234s/epoch - 22ms/step
Epoch 49/50
10622/10622 - 232s - loss: 2.6448 - accuracy30: 0.5725 - val_loss: 3.0269 - val_accuracy30: 0.5244 - 232s/epoch - 22ms/step
Epoch 50/50
10622/10622 - 231s - loss: 2.6444 - accuracy30: 0.5723 - val_loss: 3.0235 - val_accuracy30: 0.5248 - 231s/epoch - 22ms/step
testing model in sample: results/universal/W1/deepOF_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 276s - 276s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9906554
{'0': {'precision': 0.48240328288767426, 'recall': 0.5307956821106342, 'f1-score': 0.5054438238459902, 'support': 3087527}, '1': {'precision': 0.56289070920457, 'recall': 0.5969846521225614, 'f1-score': 0.5794365936578182, 'support': 2869387}, '2': {'precision': 0.49882804061973995, 'recall': 0.4207674696634974, 'f1-score': 0.45648463939133743, 'support': 3089842}, 'accuracy': 0.5142098449433145, 'macro avg': {'precision': 0.514707344237328, 'recall': 0.5161826012988976, 'f1-score': 0.5137883522983819, 'support': 9046756}, 'weighted avg': {'precision': 0.5135414589385724, 'recall': 0.5142098449433145, 'f1-score': 0.5121907447730406, 'support': 9046756}}
[[1638846  641079  807602]
 [ 657795 1712980  498612]
 [1100612  689125 1300105]]
Evaluating performance on  train set...
10622/10622 - 89s - 89s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96436405
{'0': {'precision': 0.4876425869254421, 'recall': 0.42539505193588373, 'f1-score': 0.4543969158818078, 'support': 792997}, '1': {'precision': 0.5752840115418814, 'recall': 0.737357143993903, 'f1-score': 0.6463149108908358, 'support': 1131034}, '2': {'precision': 0.4987860944125685, 'recall': 0.3622885409324338, 'f1-score': 0.4197185214025372, 'support': 794480}, 'accuracy': 0.5367438277792512, 'macro avg': {'precision': 0.5205708976266307, 'recall': 0.5083469122874068, 'f1-score': 0.5068101160583937, 'support': 2718511}, 'weighted avg': {'precision': 0.527362391214629, 'recall': 0.5367438277792512, 'f1-score': 0.5241095220552424, 'support': 2718511}}
[[337337 298962 156698]
 [164524 833976 132534]
 [189910 316739 287831]]
Evaluating performance on  val set...
3064/3064 - 28s - 28s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9813338
{'0': {'precision': 0.4896036989996147, 'recall': 0.4316358497133583, 'f1-score': 0.4587959970579713, 'support': 238451}, '1': {'precision': 0.5737854677337301, 'recall': 0.6822487958918856, 'f1-score': 0.6233340216876169, 'support': 307489}, '2': {'precision': 0.4768999196895303, 'recall': 0.4169595855967978, 'f1-score': 0.4449200164206928, 'support': 237836}, 'accuracy': 0.5255021842975544, 'macro avg': {'precision': 0.5134296954742917, 'recall': 0.5102814104006805, 'f1-score': 0.5090166783887603, 'support': 783776}, 'weighted avg': {'precision': 0.5187747272401977, 'recall': 0.5255021842975544, 'f1-score': 0.5191364832740551, 'support': 783776}}
[[102924  76460  59067]
 [ 47997 209784  49708]
 [ 59298  79370  99168]]
testing model out of sample: results/universal/W1/deepOF_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 207s - 207s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87180924
{'0': {'precision': 0.5186186751090275, 'recall': 0.39609266433489654, 'f1-score': 0.44914946156161, 'support': 1593925}, '1': {'precision': 0.6342776083206176, 'recall': 0.8446858694875277, 'f1-score': 0.7245146227340054, 'support': 2924119}, '2': {'precision': 0.5427484904078632, 'recall': 0.33903917901598035, 'f1-score': 0.4173635195426989, 'support': 1581127}, 'accuracy': 0.5963708838463456, 'macro avg': {'precision': 0.5652149246125028, 'recall': 0.5266059042794682, 'f1-score': 0.5303425346127715, 'support': 6099171}, 'weighted avg': {'precision': 0.580324239127112, 'recall': 0.5963708838463456, 'f1-score': 0.5729274124627617, 'support': 6099171}}
[[ 631342  709452  253131]
 [ 255668 2469962  198489]
 [ 330343  714720  536064]]
Evaluating performance on  train set...
6711/6711 - 60s - 60s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8654853
{'0': {'precision': 0.5109760844428671, 'recall': 0.4094314655854476, 'f1-score': 0.4546022837950874, 'support': 436051}, '1': {'precision': 0.6491456718893149, 'recall': 0.8377270998542498, 'f1-score': 0.7314774087322684, 'support': 846654}, '2': {'precision': 0.5298276206564583, 'recall': 0.3356037821381645, 'f1-score': 0.4109214266997636, 'support': 434569}, 'accuracy': 0.6019080239961707, 'macro avg': {'precision': 0.5633164589962134, 'recall': 0.5275874491926206, 'f1-score': 0.5323337064090398, 'support': 1717274}, 'weighted avg': {'precision': 0.5838672637949617, 'recall': 0.6019080239961707, 'f1-score': 0.5800540670524512, 'support': 1717274}}
[[178533 187165  70353]
 [ 78320 709265  59069]
 [ 92543 196183 145843]]
Evaluating performance on  val set...
1720/1720 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.830215
{'0': {'precision': 0.5180833486322747, 'recall': 0.39978089022789304, 'f1-score': 0.4513081860246924, 'support': 105883}, '1': {'precision': 0.6776258868316317, 'recall': 0.8536239782016348, 'f1-score': 0.7555105387546422, 'support': 229375}, '2': {'precision': 0.5225446557604486, 'recall': 0.34570191121776794, 'f1-score': 0.4161137931629735, 'support': 104593}, 'accuracy': 0.6235929894441526, 'macro avg': {'precision': 0.572751297074785, 'recall': 0.5330355932157652, 'f1-score': 0.5409775059807694, 'support': 439851}, 'weighted avg': {'precision': 0.6023429983680594, 'recall': 0.6235929894441526, 'f1-score': 0.6015757255434078, 'support': 439851}}
[[ 42330  45931  17622]
 [ 18159 195800  15416]
 [ 21216  47219  36158]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/LILAK
Evaluating performance on  test set...
663/663 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.150067
{'0': {'precision': 0.4262238858621095, 'recall': 0.6675516812719655, 'f1-score': 0.5202648151138383, 'support': 65159}, '1': {'precision': 0.4126301493888637, 'recall': 0.09182491311136856, 'f1-score': 0.15022042767088295, 'support': 39706}, '2': {'precision': 0.456977634152564, 'recall': 0.4145144867166528, 'f1-score': 0.4347115594638104, 'support': 64818}, 'accuracy': 0.43617215631501094, 'macro avg': {'precision': 0.4319438898011791, 'recall': 0.39129702703332897, 'f1-score': 0.3683989340828439, 'support': 169683}, 'weighted avg': {'precision': 0.43479070490870797, 'recall': 0.43617215631501094, 'f1-score': 0.4009931534121151, 'support': 169683}}
[[43497  2630 19032]
 [23165  3646 12895]
 [35390  2560 26868]]
Evaluating performance on  train set...
260/260 - 3s - 3s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2276074
{'0': {'precision': 0.3830797907522097, 'recall': 0.583051157682804, 'f1-score': 0.4623702736047608, 'support': 21854}, '1': {'precision': 0.4894600057753393, 'recall': 0.15690812311964822, 'f1-score': 0.2376362553012513, 'support': 21605}, '2': {'precision': 0.4062274539586102, 'recall': 0.4638397502601457, 'f1-score': 0.43312617664325187, 'support': 23064}, 'accuracy': 0.4033191527742285, 'macro avg': {'precision': 0.426255750162053, 'recall': 0.4012663436875326, 'f1-score': 0.37771090184975464, 'support': 66523}, 'weighted avg': {'precision': 0.4256548738026905, 'recall': 0.4033191527742285, 'f1-score': 0.3792431699298279, 'support': 66523}}
[[12742  1641  7471]
 [10049  3390  8166]
 [10471  1895 10698]]
Evaluating performance on  val set...
51/51 - 1s - 669ms/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2309927
{'0': {'precision': 0.3910228744065602, 'recall': 0.6328288707799767, 'f1-score': 0.4833718655521963, 'support': 4295}, '1': {'precision': 0.5051124744376279, 'recall': 0.17058011049723756, 'f1-score': 0.2550335570469799, 'support': 4344}, '2': {'precision': 0.40460600587039963, 'recall': 0.42585551330798477, 'f1-score': 0.41495889776542777, 'support': 4208}, 'accuracy': 0.4087335564723282, 'macro avg': {'precision': 0.4335804515715293, 'recall': 0.4097548315283997, 'f1-score': 0.384454773454868, 'support': 12847}, 'weighted avg': {'precision': 0.4340494985004961, 'recall': 0.4087335564723282, 'f1-score': 0.38375457119605233, 'support': 12847}}
[[2718  347 1230]
 [2196  741 1407]
 [2037  379 1792]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6092466
{'0': {'precision': 0.5026783850845257, 'recall': 0.3833109350686094, 'f1-score': 0.4349535991973915, 'support': 56552}, '1': {'precision': 0.8219573247928963, 'recall': 0.9205345176974822, 'f1-score': 0.868457540053384, 'support': 308914}, '2': {'precision': 0.5843358395989975, 'recall': 0.3358360791515872, 'f1-score': 0.4265312889468208, 'support': 55539}, 'accuracy': 0.771237871284189, 'macro avg': {'precision': 0.6363238498254732, 'recall': 0.5465605106392263, 'f1-score': 0.5766474760658654, 'support': 421005}, 'weighted avg': {'precision': 0.7477227616295805, 'recall': 0.771237871284189, 'f1-score': 0.7519276724188061, 'support': 421005}}
[[ 21677  31107   3768]
 [ 15048 284366   9500]
 [  6398  30489  18652]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71248484
{'0': {'precision': 0.5572164948453608, 'recall': 0.42511419669056477, 'f1-score': 0.4822828903340941, 'support': 33057}, '1': {'precision': 0.7472412629707956, 'recall': 0.8945532996424033, 'f1-score': 0.814288404458513, 'support': 101511}, '2': {'precision': 0.5680297397769517, 'recall': 0.35425038639876355, 'f1-score': 0.4363636363636364, 'support': 32350}, 'accuracy': 0.6968691213649816, 'macro avg': {'precision': 0.6241624991977027, 'recall': 0.5579726275772439, 'f1-score': 0.5776449770520812, 'support': 166918}, 'weighted avg': {'precision': 0.6748755412676638, 'recall': 0.6968691213649816, 'f1-score': 0.6752921756019477, 'support': 166918}}
[[14053 14841  4163]
 [ 6152 90807  4552]
 [ 5015 15875 11460]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69038075
{'0': {'precision': 0.6467040068935803, 'recall': 0.3665445665445665, 'f1-score': 0.46789276807980046, 'support': 8190}, '1': {'precision': 0.7663724649309687, 'recall': 0.9174284578696343, 'f1-score': 0.8351247456094067, 'support': 30192}, '2': {'precision': 0.5484105358764759, 'recall': 0.3817653009610521, 'f1-score': 0.4501602922537836, 'support': 7908}, 'accuracy': 0.728451069345431, 'macro avg': {'precision': 0.6538290025670083, 'recall': 0.5552461084584177, 'f1-score': 0.584392601980997, 'support': 46290}, 'weighted avg': {'precision': 0.7079640050845841, 'recall': 0.728451069345431, 'f1-score': 0.7043853031141866, 'support': 46290}}
[[ 3002  4290   898]
 [  905 27699  1588]
 [  735  4154  3019]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 13s - 13s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0699657
{'0': {'precision': 0.475752391103133, 'recall': 0.5151551965012452, 'f1-score': 0.4946703801455256, 'support': 131704}, '1': {'precision': 0.3555421322863183, 'recall': 0.4213193609345473, 'f1-score': 0.3856460521401848, 'support': 69852}, '2': {'precision': 0.5048388696977623, 'recall': 0.4155258938116166, 'f1-score': 0.4558488783558721, 'support': 134704}, 'accuracy': 0.4557515018140724, 'macro avg': {'precision': 0.4453777976957379, 'recall': 0.4506668170824697, 'f1-score': 0.4453884368805275, 'support': 336260}, 'weighted avg': {'precision': 0.462432751579368, 'recall': 0.4557515018140724, 'f1-score': 0.4564708353382261, 'support': 336260}}
[[67848 26508 37348]
 [22870 29430 17552]
 [51894 26837 55973]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98274416
{'0': {'precision': 0.49888137908296637, 'recall': 0.47339605354309594, 'f1-score': 0.48580470577443474, 'support': 44749}, '1': {'precision': 0.5282617486242726, 'recall': 0.6855350216746521, 'f1-score': 0.5967093308443139, 'support': 43830}, '2': {'precision': 0.5106990425654632, 'recall': 0.38973128810053037, 'f1-score': 0.4420894963489983, 'support': 45439}, 'accuracy': 0.514408512289394, 'macro avg': {'precision': 0.5126140567575673, 'recall': 0.5162207877727595, 'f1-score': 0.5082011776559157, 'support': 134018}, 'weighted avg': {'precision': 0.5124968964610546, 'recall': 0.514408512289394, 'f1-score': 0.5072538716755106, 'support': 134018}}
[[21184 12876 10689]
 [ 7505 30047  6278]
 [13774 13956 17709]]
Evaluating performance on  val set...
107/107 - 3s - 3s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0472711
{'0': {'precision': 0.4871888061057605, 'recall': 0.5043740005643872, 'f1-score': 0.495632481397606, 'support': 10631}, '1': {'precision': 0.37013356067064507, 'recall': 0.44145060159295035, 'f1-score': 0.4026586289512327, 'support': 5901}, '2': {'precision': 0.49539776462853385, 'recall': 0.42498589960518895, 'f1-score': 0.45749848208864596, 'support': 10638}, 'accuracy': 0.4596245859403754, 'macro avg': {'precision': 0.45090671046831315, 'recall': 0.45693683392084217, 'f1-score': 0.4519298641458282, 'support': 27170}, 'weighted avg': {'precision': 0.4649798954488833, 'recall': 0.4596245859403754, 'f1-score': 0.4605088822833342, 'support': 27170}}
[[5362 2191 3078]
 [1769 2605 1527]
 [3875 2242 4521]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3865342
{'0': {'precision': 0.3602266219649837, 'recall': 0.5593059392265194, 'f1-score': 0.4382158884541375, 'support': 115840}, '1': {'precision': 0.7711442786069652, 'recall': 0.04210457295940351, 'f1-score': 0.07984936093865189, 'support': 106758}, '2': {'precision': 0.33705284772506217, 'recall': 0.4489913440947291, 'f1-score': 0.3850516617409891, 'support': 111138}, 'accuracy': 0.3571235946976053, 'macro avg': {'precision': 0.48947458276567035, 'recall': 0.3501339520935507, 'f1-score': 0.30103897037792615, 'support': 333736}, 'weighted avg': {'precision': 0.48395693654389726, 'recall': 0.3571235946976053, 'f1-score': 0.30587457803828755, 'support': 333736}}
[[64790   691 50359]
 [54474  4495 47789]
 [60595   643 49900]]
Evaluating performance on  train set...
384/384 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.4269212
{'0': {'precision': 0.3640190799696455, 'recall': 0.5968420428960778, 'f1-score': 0.452223294651074, 'support': 33756}, '1': {'precision': 0.6556420233463035, 'recall': 0.020756983154199132, 'f1-score': 0.040240007164392966, 'support': 32471}, '2': {'precision': 0.3468749253660051, 'recall': 0.45361983884065216, 'f1-score': 0.3931302358943821, 'support': 32018}, 'accuracy': 0.35976385566695507, 'macro avg': {'precision': 0.45551200956065135, 'recall': 0.35707295496364305, 'f1-score': 0.2951978459032831, 'support': 98245}, 'weighted avg': {'precision': 0.4548162406626488, 'recall': 0.35976385566695507, 'f1-score': 0.2968001089087789, 'support': 98245}}
[[20147   172 13437]
 [17887   674 13910]
 [17312   182 14524]]
Evaluating performance on  val set...
93/93 - 1s - 972ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.404271
{'0': {'precision': 0.3560131304088332, 'recall': 0.5932371954251616, 'f1-score': 0.4449832152182022, 'support': 8044}, '1': {'precision': 0.5990783410138248, 'recall': 0.017351841964762412, 'f1-score': 0.03372681281618887, 'support': 7492}, '2': {'precision': 0.3582089552238806, 'recall': 0.44323252354982645, 'f1-score': 0.39621073624729936, 'support': 8068}, 'accuracy': 0.35917641077783424, 'macro avg': {'precision': 0.43776680888217956, 'recall': 0.3512738536465834, 'f1-score': 0.2916402547605635, 'support': 23604}, 'weighted avg': {'precision': 0.4339135062968352, 'recall': 0.35917641077783424, 'f1-score': 0.2977781090017504, 'support': 23604}}
[[4772   45 3227]
 [4182  130 3180]
 [4450   42 3576]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0907818
{'0': {'precision': 0.44898532781169503, 'recall': 0.5125977375657508, 'f1-score': 0.478687430182961, 'support': 246195}, '1': {'precision': 0.42461250616722307, 'recall': 0.37037782249049855, 'f1-score': 0.39564520414225035, 'support': 178920}, '2': {'precision': 0.4615187431570532, 'recall': 0.43859830217348217, 'f1-score': 0.4497667013862426, 'support': 242192}, 'accuracy': 0.4476080724464152, 'macro avg': {'precision': 0.44503885904532375, 'recall': 0.44052462074324383, 'f1-score': 0.4413664452371513, 'support': 667307}, 'weighted avg': {'precision': 0.446999296915412, 'recall': 0.4476080724464152, 'f1-score': 0.44592547169617935, 'support': 667307}}
[[126199  45909  74087]
 [ 62800  66268  49852]
 [ 92077  43890 106225]]
Evaluating performance on  train set...
722/722 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0741961
{'0': {'precision': 0.44518718641451177, 'recall': 0.4665879231117727, 'f1-score': 0.45563640098278546, 'support': 61804}, '1': {'precision': 0.49568195130743004, 'recall': 0.5441729323308271, 'f1-score': 0.5187968151915051, 'support': 60648}, '2': {'precision': 0.46479005307278287, 'recall': 0.39828370321564593, 'f1-score': 0.42897446992643884, 'support': 62227}, 'accuracy': 0.4690517059329973, 'macro avg': {'precision': 0.46855306359824156, 'recall': 0.46968151955274856, 'f1-score': 0.46780256203357645, 'support': 184679}, 'weighted avg': {'precision': 0.4683746310333907, 'recall': 0.4690517059329973, 'f1-score': 0.46739442878825954, 'support': 184679}}
[[28837 16670 16297]
 [15403 33003 12242]
 [20535 16908 24784]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0816573
{'0': {'precision': 0.4620991905549841, 'recall': 0.48948365703458074, 'f1-score': 0.4753973913643578, 'support': 21110}, '1': {'precision': 0.4343056747150386, 'recall': 0.4393676379417235, 'f1-score': 0.43682199211045364, 'support': 16130}, '2': {'precision': 0.46016059295861644, 'recall': 0.42842766089998563, 'f1-score': 0.44372750961657775, 'support': 20867}, 'accuracy': 0.453645860223381, 'macro avg': {'precision': 0.4521884860762131, 'recall': 0.45242631862543, 'f1-score': 0.4519822976971297, 'support': 58107}, 'weighted avg': {'precision': 0.453687774950294, 'recall': 0.453645860223381, 'f1-score': 0.4533161169499774, 'support': 58107}}
[[10333  4412  6365]
 [ 4920  7087  4123]
 [ 7108  4819  8940]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/EXC
Evaluating performance on  test set...
5343/5343 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69910425
{'0': {'precision': 0.5976136756726058, 'recall': 0.43141040453810203, 'f1-score': 0.5010898433526049, 'support': 268306}, '1': {'precision': 0.7206743702909443, 'recall': 0.9081297448846027, 'f1-score': 0.8036151504524544, 'support': 828919}, '2': {'precision': 0.6588020097710066, 'recall': 0.3154912606862089, 'f1-score': 0.42666060191039823, 'support': 270559}, 'accuracy': 0.6973871605458172, 'macro avg': {'precision': 0.6590300185781856, 'recall': 0.5516771367029712, 'f1-score': 0.5771218652384859, 'support': 1367784}, 'weighted avg': {'precision': 0.6842957851340907, 'recall': 0.6973871605458172, 'f1-score': 0.6697067257701051, 'support': 1367784}}
[[115750 134427  18129]
 [ 50074 752766  26079]
 [ 27863 157337  85359]]
Evaluating performance on  train set...
1290/1290 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6237932
{'0': {'precision': 0.5711773417252869, 'recall': 0.4517734909769757, 'f1-score': 0.5045067140842481, 'support': 54638}, '1': {'precision': 0.7785425196479835, 'recall': 0.9050578087387847, 'f1-score': 0.8370466255702756, 'support': 219344}, '2': {'precision': 0.6434178838394896, 'recall': 0.3660823916718569, 'f1-score': 0.4666545685509482, 'support': 56195}, 'accuracy': 0.7383161152957353, 'macro avg': {'precision': 0.6643792484042533, 'recall': 0.5743045637958725, 'f1-score': 0.6027359694018241, 'support': 330177}, 'weighted avg': {'precision': 0.7212297828413659, 'recall': 0.7383161152957353, 'f1-score': 0.7189781431260875, 'support': 330177}}
[[ 24684  26361   3593]
 [ 13017 198519   7808]
 [  5515  30108  20572]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.63481444
{'0': {'precision': 0.5665814752798096, 'recall': 0.4159011515073101, 'f1-score': 0.47968662562954667, 'support': 15458}, '1': {'precision': 0.7730653950953679, 'recall': 0.9144721998388396, 'f1-score': 0.837844222960502, 'support': 62050}, '2': {'precision': 0.6223292577497839, 'recall': 0.3285732916014606, 'f1-score': 0.4300772414970341, 'support': 15336}, 'accuracy': 0.7346839860411012, 'macro avg': {'precision': 0.6539920427083205, 'recall': 0.5529822143158701, 'f1-score': 0.5825360300290275, 'support': 92844}, 'weighted avg': {'precision': 0.7137883515078363, 'recall': 0.7346839860411012, 'f1-score': 0.710857938792805, 'support': 92844}}
[[ 6429  8008  1021]
 [ 3270 56743  2037]
 [ 1648  8649  5039]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/AAL
Evaluating performance on  test set...
7177/7177 - 64s - 64s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72186154
{'0': {'precision': 0.56431241078807, 'recall': 0.3513585415338919, 'f1-score': 0.43307256852733345, 'support': 342058}, '1': {'precision': 0.7248042563810558, 'recall': 0.9078214364656149, 'f1-score': 0.8060547424522712, 'support': 1158176}, '2': {'precision': 0.5895230739079811, 'recall': 0.30361882143387264, 'f1-score': 0.40081044645096564, 'support': 336850}, 'accuracy': 0.6934228374968157, 'macro avg': {'precision': 0.6262132470257024, 'recall': 0.5209329331444598, 'f1-score': 0.5466459191435235, 'support': 1837084}, 'weighted avg': {'precision': 0.670115964481556, 'recall': 0.6934228374968157, 'f1-score': 0.6623007945889965, 'support': 1837084}}
[[ 120185  198738   23135]
 [  58682 1051417   48077]
 [  34109  200467  102274]]
Evaluating performance on  train set...
2257/2257 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7092936
{'0': {'precision': 0.5539357029292086, 'recall': 0.37982612551852846, 'f1-score': 0.45064864598234106, 'support': 108239}, '1': {'precision': 0.7350366413561716, 'recall': 0.9179574543159033, 'f1-score': 0.816376012346118, 'support': 362763}, '2': {'precision': 0.6012997853565466, 'recall': 0.2838925796644522, 'f1-score': 0.3856891540461985, 'support': 106572}, 'accuracy': 0.7001146173477338, 'macro avg': {'precision': 0.6300907098806423, 'recall': 0.527225386499628, 'f1-score': 0.5509046041248858, 'support': 577574}, 'weighted avg': {'precision': 0.676421141537987, 'recall': 0.7001146173477338, 'f1-score': 0.6683687885607884, 'support': 577574}}
[[ 41112  57768   9359]
 [ 19060 333001  10702]
 [ 14046  62271  30255]]
Evaluating performance on  val set...
638/638 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6842315
{'0': {'precision': 0.5718469150762395, 'recall': 0.3915102492308756, 'f1-score': 0.46479942546424546, 'support': 28929}, '1': {'precision': 0.7584052082590824, 'recall': 0.9072966903857269, 'f1-score': 0.8261964952847689, 'support': 105541}, '2': {'precision': 0.5696407879490151, 'recall': 0.3407145579928614, 'f1-score': 0.4263937376672377, 'support': 28857}, 'accuracy': 0.7158338792728698, 'macro avg': {'precision': 0.633297637094779, 'recall': 0.5465071658698213, 'f1-score': 0.5724632194720841, 'support': 163327}, 'weighted avg': {'precision': 0.6920100639144604, 'recall': 0.7158338792728698, 'f1-score': 0.6915465965576324, 'support': 163327}}
[[11326 14785  2818]
 [ 5174 95757  4610]
 [ 3306 15719  9832]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/WBA
Evaluating performance on  test set...
5696/5696 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0088855
{'0': {'precision': 0.5074203160751344, 'recall': 0.39295390720453616, 'f1-score': 0.44291093778847596, 'support': 485347}, '1': {'precision': 0.4780261441478701, 'recall': 0.73606719229067, 'f1-score': 0.5796248957211366, 'support': 499343}, '2': {'precision': 0.5376706206826104, 'recall': 0.3558518493479166, 'f1-score': 0.42826250290809653, 'support': 473329}, 'accuracy': 0.4984187448860406, 'macro avg': {'precision': 0.5077056936352049, 'recall': 0.4949576496143742, 'f1-score': 0.48359944547256967, 'support': 1458019}, 'weighted avg': {'precision': 0.5071737983252806, 'recall': 0.4984187448860406, 'f1-score': 0.48497735040893797, 'support': 1458019}}
[[190719 209506  85122]
 [ 72082 367550  59711]
 [113059 191835 168435]]
Evaluating performance on  train set...
2222/2222 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8780091
{'0': {'precision': 0.5603622558660751, 'recall': 0.39120716302001507, 'f1-score': 0.4607498392234587, 'support': 156582}, '1': {'precision': 0.6011705086893057, 'recall': 0.8485916998736515, 'f1-score': 0.7037682467778467, 'support': 257225}, '2': {'precision': 0.5597788240674337, 'recall': 0.3478951754074323, 'f1-score': 0.4291063802664287, 'support': 154811}, 'accuracy': 0.5863215726551041, 'macro avg': {'precision': 0.5737705295409382, 'recall': 0.5292313461003663, 'f1-score': 0.531208155422578, 'support': 568618}, 'weighted avg': {'precision': 0.5786637890083183, 'recall': 0.5863215726551041, 'f1-score': 0.5620685705309105, 'support': 568618}}
[[ 61256  71545  23781]
 [ 20372 218279  18574]
 [ 27687  73266  53858]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91662514
{'0': {'precision': 0.5266690966526942, 'recall': 0.38143740238027146, 'f1-score': 0.4424399392694472, 'support': 45457}, '1': {'precision': 0.6092007339146928, 'recall': 0.7934724236077547, 'f1-score': 0.689232527493032, 'support': 74484}, '2': {'precision': 0.4995281627838396, 'recall': 0.38581027217856734, 'f1-score': 0.4353659320182484, 'support': 43905}, 'accuracy': 0.5699193144782295, 'macro avg': {'precision': 0.5451326644504088, 'recall': 0.5202400327221978, 'f1-score': 0.5223461329269091, 'support': 163846}, 'weighted avg': {'precision': 0.556914960258218, 'recall': 0.5699193144782295, 'f1-score': 0.5527356733910102, 'support': 163846}}
[[17339 19491  8627]
 [ 7039 59101  8344]
 [ 8544 18422 16939]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 99s - 99s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87692165
{'0': {'precision': 0.5717279390257152, 'recall': 0.33833080492427753, 'f1-score': 0.4251004126803874, 'support': 808809}, '1': {'precision': 0.6006786377144939, 'recall': 0.8926336664489514, 'f1-score': 0.7181163287086446, 'support': 1477465}, '2': {'precision': 0.5904822084054853, 'recall': 0.30506514753358926, 'f1-score': 0.4022914943102883, 'support': 802563}, 'accuracy': 0.5948238770773595, 'macro avg': {'precision': 0.5876295950485647, 'recall': 0.5120098729689394, 'f1-score': 0.5151694118997735, 'support': 3088837}, 'weighted avg': {'precision': 0.590448618276337, 'recall': 0.5948238770773595, 'f1-score': 0.5593305991294707, 'support': 3088837}}
[[ 273645  435588   99576]
 [  88406 1318835   70224]
 [ 116577  441152  244834]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8809062
{'0': {'precision': 0.5545192143593853, 'recall': 0.37477495549259043, 'f1-score': 0.44726400019151696, 'support': 199405}, '1': {'precision': 0.6087717643730328, 'recall': 0.865964427849573, 'f1-score': 0.7149410116961358, 'support': 357808}, '2': {'precision': 0.5651950116040709, 'recall': 0.31727557067324996, 'f1-score': 0.40641030635965764, 'support': 197267}, 'accuracy': 0.5926850280988231, 'macro avg': {'precision': 0.5761619967788297, 'recall': 0.5193383180051377, 'f1-score': 0.5228717727491035, 'support': 754480}, 'weighted avg': {'precision': 0.5830394917827109, 'recall': 0.5926850280988231, 'f1-score': 0.5635267116103951, 'support': 754480}}
[[ 74732  98121  26552]
 [ 26362 309849  21597]
 [ 33675 101004  62588]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8192757
{'0': {'precision': 0.5760974046779879, 'recall': 0.3075907913387751, 'f1-score': 0.4010515414641918, 'support': 40918}, '1': {'precision': 0.650363252360596, 'recall': 0.9194533085707836, 'f1-score': 0.7618452487225921, 'support': 97459}, '2': {'precision': 0.5851358550879062, 'recall': 0.27441721010419007, 'f1-score': 0.3736159066555542, 'support': 40023}, 'accuracy': 0.6344058295964126, 'macro avg': {'precision': 0.6038655040421633, 'recall': 0.5004871033379162, 'f1-score': 0.512170898947446, 'support': 178400}, 'weighted avg': {'precision': 0.6186961779406306, 'recall': 0.6344058295964126, 'f1-score': 0.5919962584134649, 'support': 178400}}
[[12586 24192  4140]
 [ 4203 89609  3647]
 [ 5058 23982 10983]]
testing model on single stock: results/universal/W1/deepOF_L2/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 165s - 165s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0638263
{'0': {'precision': 0.4783628914068036, 'recall': 0.5765530316699375, 'f1-score': 0.5228882591412477, 'support': 2161482}, '1': {'precision': 0.34605582614060226, 'recall': 0.27013744687694646, 'f1-score': 0.30341985686641026, 'support': 1125453}, '2': {'precision': 0.4929808641474011, 'recall': 0.4484693776881048, 'f1-score': 0.46967287602005486, 'support': 2179277}, 'accuracy': 0.4623997386124065, 'macro avg': {'precision': 0.439133193898269, 'recall': 0.43171995207832964, 'f1-score': 0.4319936640092376, 'support': 5466212}, 'weighted avg': {'precision': 0.4569497497751159, 'recall': 0.4623997386124065, 'f1-score': 0.45648534022269377, 'support': 5466212}}
[[1246209  265314  649959]
 [ 466215  304027  355211]
 [ 892730  309208  977339]]
Evaluating performance on  train set...
6073/6073 - 50s - 50s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0663145
{'0': {'precision': 0.47367088386550366, 'recall': 0.42138867959702037, 'f1-score': 0.446002828110099, 'support': 514964}, '1': {'precision': 0.4596735538588201, 'recall': 0.6264623436308199, 'f1-score': 0.5302617702279766, 'support': 520483}, '2': {'precision': 0.4846328918373621, 'recall': 0.36138669173540666, 'f1-score': 0.41403267935630034, 'support': 519106}, 'accuracy': 0.47001356660081706, 'macro avg': {'precision': 0.47265910985389525, 'recall': 0.469745904987749, 'f1-score': 0.4634324258981253, 'support': 1554553}, 'weighted avg': {'precision': 0.472644911638356, 'recall': 0.47001356660081706, 'f1-score': 0.46353806231012296, 'support': 1554553}}
[[217000 186242 111722]
 [106647 326063  87773]
 [134477 197031 187598]]
Evaluating performance on  val set...
1786/1786 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0819793
{'0': {'precision': 0.48387533050669806, 'recall': 0.4436088827168913, 'f1-score': 0.4628680287598526, 'support': 161302}, '1': {'precision': 0.41695002770641276, 'recall': 0.49684477493228085, 'f1-score': 0.45340472954234984, 'support': 133271}, '2': {'precision': 0.46999103019833227, 'recall': 0.43497992239529204, 'f1-score': 0.4518082293276785, 'support': 162619}, 'accuracy': 0.456057848781256, 'macro avg': {'precision': 0.45693879613714766, 'recall': 0.4584778600148214, 'f1-score': 0.456026995876627, 'support': 457192}, 'weighted avg': {'precision': 0.4594281550063767, 'recall': 0.456057848781256, 'f1-score': 0.45617561753245467, 'support': 457192}}
[[71555 44543 45204]
 [32491 66215 34565]
 [43833 48050 70736]]
training model: results/universal/W1/deepVOL_L2/h10
Epoch 1/50
10622/10622 - 342s - loss: 2.7797 - accuracy10: 0.5282 - val_loss: 3.1228 - val_accuracy10: 0.5699 - 342s/epoch - 32ms/step
Epoch 2/50
10622/10622 - 335s - loss: 2.6600 - accuracy10: 0.5596 - val_loss: 3.0271 - val_accuracy10: 0.5684 - 335s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 334s - loss: 2.6142 - accuracy10: 0.5693 - val_loss: 2.9764 - val_accuracy10: 0.5743 - 334s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 336s - loss: 2.5882 - accuracy10: 0.5741 - val_loss: 2.9342 - val_accuracy10: 0.5731 - 336s/epoch - 32ms/step
Epoch 5/50
10622/10622 - 337s - loss: 2.5712 - accuracy10: 0.5772 - val_loss: 2.9179 - val_accuracy10: 0.5765 - 337s/epoch - 32ms/step
Epoch 6/50
10622/10622 - 334s - loss: 2.5583 - accuracy10: 0.5792 - val_loss: 2.9110 - val_accuracy10: 0.5777 - 334s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 335s - loss: 2.5485 - accuracy10: 0.5808 - val_loss: 2.8962 - val_accuracy10: 0.5774 - 335s/epoch - 32ms/step
Epoch 8/50
10622/10622 - 333s - loss: 2.5402 - accuracy10: 0.5824 - val_loss: 2.9084 - val_accuracy10: 0.5779 - 333s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 340s - loss: 2.5336 - accuracy10: 0.5833 - val_loss: 2.9041 - val_accuracy10: 0.5780 - 340s/epoch - 32ms/step
Epoch 10/50
10622/10622 - 337s - loss: 2.5274 - accuracy10: 0.5844 - val_loss: 2.9077 - val_accuracy10: 0.5775 - 337s/epoch - 32ms/step
Epoch 11/50
10622/10622 - 337s - loss: 2.5220 - accuracy10: 0.5852 - val_loss: 2.9101 - val_accuracy10: 0.5794 - 337s/epoch - 32ms/step
Epoch 12/50
10622/10622 - 338s - loss: 2.5180 - accuracy10: 0.5858 - val_loss: 2.8952 - val_accuracy10: 0.5760 - 338s/epoch - 32ms/step
Epoch 13/50
10622/10622 - 333s - loss: 2.5136 - accuracy10: 0.5865 - val_loss: 2.8791 - val_accuracy10: 0.5804 - 333s/epoch - 31ms/step
Epoch 14/50
10622/10622 - 332s - loss: 2.5102 - accuracy10: 0.5871 - val_loss: 2.8706 - val_accuracy10: 0.5823 - 332s/epoch - 31ms/step
Epoch 15/50
10622/10622 - 337s - loss: 2.5063 - accuracy10: 0.5875 - val_loss: 2.8664 - val_accuracy10: 0.5808 - 337s/epoch - 32ms/step
Epoch 16/50
10622/10622 - 340s - loss: 2.5028 - accuracy10: 0.5881 - val_loss: 2.9017 - val_accuracy10: 0.5805 - 340s/epoch - 32ms/step
Epoch 17/50
10622/10622 - 337s - loss: 2.4997 - accuracy10: 0.5886 - val_loss: 2.8554 - val_accuracy10: 0.5807 - 337s/epoch - 32ms/step
Epoch 18/50
10622/10622 - 340s - loss: 2.4974 - accuracy10: 0.5889 - val_loss: 2.8458 - val_accuracy10: 0.5827 - 340s/epoch - 32ms/step
Epoch 19/50
10622/10622 - 333s - loss: 2.4943 - accuracy10: 0.5896 - val_loss: 2.8730 - val_accuracy10: 0.5811 - 333s/epoch - 31ms/step
Epoch 20/50
10622/10622 - 333s - loss: 2.4921 - accuracy10: 0.5898 - val_loss: 2.8698 - val_accuracy10: 0.5832 - 333s/epoch - 31ms/step
Epoch 21/50
10622/10622 - 336s - loss: 2.4899 - accuracy10: 0.5903 - val_loss: 2.8687 - val_accuracy10: 0.5829 - 336s/epoch - 32ms/step
Epoch 22/50
10622/10622 - 333s - loss: 2.4876 - accuracy10: 0.5904 - val_loss: 2.8611 - val_accuracy10: 0.5815 - 333s/epoch - 31ms/step
Epoch 23/50
10622/10622 - 336s - loss: 2.4855 - accuracy10: 0.5908 - val_loss: 2.8427 - val_accuracy10: 0.5852 - 336s/epoch - 32ms/step
Epoch 24/50
10622/10622 - 336s - loss: 2.4839 - accuracy10: 0.5913 - val_loss: 2.8484 - val_accuracy10: 0.5840 - 336s/epoch - 32ms/step
Epoch 25/50
10622/10622 - 337s - loss: 2.4818 - accuracy10: 0.5914 - val_loss: 2.8288 - val_accuracy10: 0.5842 - 337s/epoch - 32ms/step
Epoch 26/50
10622/10622 - 338s - loss: 2.4798 - accuracy10: 0.5918 - val_loss: 2.8385 - val_accuracy10: 0.5864 - 338s/epoch - 32ms/step
Epoch 27/50
10622/10622 - 338s - loss: 2.4784 - accuracy10: 0.5921 - val_loss: 2.8318 - val_accuracy10: 0.5854 - 338s/epoch - 32ms/step
Epoch 28/50
10622/10622 - 330s - loss: 2.4763 - accuracy10: 0.5924 - val_loss: 2.8320 - val_accuracy10: 0.5859 - 330s/epoch - 31ms/step
Epoch 29/50
10622/10622 - 334s - loss: 2.4750 - accuracy10: 0.5925 - val_loss: 2.8330 - val_accuracy10: 0.5863 - 334s/epoch - 31ms/step
Epoch 30/50
10622/10622 - 328s - loss: 2.4738 - accuracy10: 0.5928 - val_loss: 2.8383 - val_accuracy10: 0.5865 - 328s/epoch - 31ms/step
Epoch 31/50
10622/10622 - 332s - loss: 2.4720 - accuracy10: 0.5932 - val_loss: 2.8276 - val_accuracy10: 0.5872 - 332s/epoch - 31ms/step
Epoch 32/50
10622/10622 - 333s - loss: 2.4708 - accuracy10: 0.5934 - val_loss: 2.8314 - val_accuracy10: 0.5854 - 333s/epoch - 31ms/step
Epoch 33/50
10622/10622 - 342s - loss: 2.4696 - accuracy10: 0.5935 - val_loss: 2.8314 - val_accuracy10: 0.5876 - 342s/epoch - 32ms/step
Epoch 34/50
10622/10622 - 343s - loss: 2.4677 - accuracy10: 0.5935 - val_loss: 2.8358 - val_accuracy10: 0.5867 - 343s/epoch - 32ms/step
Epoch 35/50
10622/10622 - 346s - loss: 2.4668 - accuracy10: 0.5937 - val_loss: 2.8280 - val_accuracy10: 0.5865 - 346s/epoch - 33ms/step
Epoch 36/50
10622/10622 - 337s - loss: 2.4654 - accuracy10: 0.5941 - val_loss: 2.8276 - val_accuracy10: 0.5859 - 337s/epoch - 32ms/step
Epoch 37/50
10622/10622 - 336s - loss: 2.4639 - accuracy10: 0.5944 - val_loss: 2.8255 - val_accuracy10: 0.5865 - 336s/epoch - 32ms/step
Epoch 38/50
10622/10622 - 335s - loss: 2.4623 - accuracy10: 0.5943 - val_loss: 2.8295 - val_accuracy10: 0.5879 - 335s/epoch - 32ms/step
Epoch 39/50
10622/10622 - 334s - loss: 2.4612 - accuracy10: 0.5947 - val_loss: 2.8219 - val_accuracy10: 0.5884 - 334s/epoch - 31ms/step
Epoch 40/50
10622/10622 - 327s - loss: 2.4608 - accuracy10: 0.5950 - val_loss: 2.8304 - val_accuracy10: 0.5856 - 327s/epoch - 31ms/step
Epoch 41/50
10622/10622 - 329s - loss: 2.4592 - accuracy10: 0.5951 - val_loss: 2.8269 - val_accuracy10: 0.5866 - 329s/epoch - 31ms/step
Epoch 42/50
10622/10622 - 328s - loss: 2.4584 - accuracy10: 0.5951 - val_loss: 2.8257 - val_accuracy10: 0.5859 - 328s/epoch - 31ms/step
Epoch 43/50
10622/10622 - 327s - loss: 2.4573 - accuracy10: 0.5954 - val_loss: 2.8213 - val_accuracy10: 0.5868 - 327s/epoch - 31ms/step
Epoch 44/50
10622/10622 - 326s - loss: 2.4562 - accuracy10: 0.5958 - val_loss: 2.8226 - val_accuracy10: 0.5878 - 326s/epoch - 31ms/step
Epoch 45/50
10622/10622 - 327s - loss: 2.4554 - accuracy10: 0.5959 - val_loss: 2.8260 - val_accuracy10: 0.5873 - 327s/epoch - 31ms/step
Epoch 46/50
10622/10622 - 328s - loss: 2.4542 - accuracy10: 0.5960 - val_loss: 2.8268 - val_accuracy10: 0.5878 - 328s/epoch - 31ms/step
Epoch 47/50
10622/10622 - 325s - loss: 2.4529 - accuracy10: 0.5961 - val_loss: 2.8193 - val_accuracy10: 0.5864 - 325s/epoch - 31ms/step
Epoch 48/50
10622/10622 - 331s - loss: 2.4523 - accuracy10: 0.5963 - val_loss: 2.8202 - val_accuracy10: 0.5866 - 331s/epoch - 31ms/step
Epoch 49/50
10622/10622 - 327s - loss: 2.4515 - accuracy10: 0.5966 - val_loss: 2.8161 - val_accuracy10: 0.5852 - 327s/epoch - 31ms/step
Epoch 50/50
10622/10622 - 329s - loss: 2.4504 - accuracy10: 0.5965 - val_loss: 2.8209 - val_accuracy10: 0.5868 - 329s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 537s - 537s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9172795
{'0': {'precision': 0.4583525707964465, 'recall': 0.5432514288465823, 'f1-score': 0.4972038631822907, 'support': 2450578}, '1': {'precision': 0.7282388511324713, 'recall': 0.583504440074939, 'f1-score': 0.6478868326130136, 'support': 4137768}, '2': {'precision': 0.4592237117282326, 'recall': 0.5280489417047838, 'f1-score': 0.49123733781265594, 'support': 2458435}, 'accuracy': 0.5575309051915814, 'macro avg': {'precision': 0.5486050445523835, 'recall': 0.5516016035421016, 'f1-score': 0.5454426778693201, 'support': 9046781}, 'weighted avg': {'precision': 0.5820284349264688, 'recall': 0.5575309051915814, 'f1-score': 0.5645010437217914, 'support': 9046781}}
[[1331280  475622  643676]
 [ 838324 2414406  885038]
 [ 734885  425376 1298174]]
Evaluating performance on  train set...
10622/10622 - 174s - 174s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83793396
{'0': {'precision': 0.44650291899133054, 'recall': 0.49931820619283274, 'f1-score': 0.4714359420280537, 'support': 587421}, '1': {'precision': 0.7616712350994721, 'recall': 0.6807612773070941, 'f1-score': 0.7189470265465546, 'support': 1544562}, '2': {'precision': 0.4393140132223203, 'recall': 0.5101622932121235, 'f1-score': 0.47209486515226573, 'support': 586531}, 'accuracy': 0.6047472994437402, 'macro avg': {'precision': 0.5491627224377077, 'recall': 0.5634139255706835, 'f1-score': 0.554159277908958, 'support': 2718514}, 'weighted avg': {'precision': 0.6240191975814059, 'recall': 0.6047472994437402, 'f1-score': 0.6122050146041126, 'support': 2718514}}
[[ 293310  172024  122087]
 [ 233276 1051478  259808]
 [ 130319  156986  299226]]
Evaluating performance on  val set...
3064/3064 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87017864
{'0': {'precision': 0.44688081714476635, 'recall': 0.5211113955895941, 'f1-score': 0.48114991674717866, 'support': 179666}, '1': {'precision': 0.759464959273271, 'recall': 0.6352445816357477, 'f1-score': 0.6918229009978941, 'support': 425359}, '2': {'precision': 0.43496947116924967, 'recall': 0.5316442241528814, 'f1-score': 0.47847244074666134, 'support': 178753}, 'accuracy': 0.5854540443850171, 'macro avg': {'precision': 0.5471050825290956, 'recall': 0.562666733792741, 'f1-score': 0.550481752830578, 'support': 783778}, 'weighted avg': {'precision': 0.6138047283600302, 'recall': 0.5854540443850171, 'f1-score': 0.594872224646073, 'support': 783778}}
[[ 93626  44640  41400]
 [ 73103 270207  82049]
 [ 42781  40939  95033]]
testing model out of sample: results/universal/W1/deepVOL_L2/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 381s - 381s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.69022983
{'0': {'precision': 0.4962015869551442, 'recall': 0.5008608023139504, 'f1-score': 0.49852030851147544, 'support': 1125694}, '1': {'precision': 0.8105746636138381, 'recall': 0.8376949285451083, 'f1-score': 0.8239116806457356, 'support': 3856349}, '2': {'precision': 0.5149796891639056, 'recall': 0.4506294124439535, 'f1-score': 0.48066033006955616, 'support': 1117153}, 'accuracy': 0.7046309054504889, 'macro avg': {'precision': 0.6072519799109627, 'recall': 0.5963950477676706, 'f1-score': 0.6010307730755892, 'support': 6099196}, 'weighted avg': {'precision': 0.6984102572481634, 'recall': 0.7046309054504889, 'f1-score': 0.7009847585869045, 'support': 6099196}}
[[ 563816  389453  172425]
 [ 324195 3230444  301710]
 [ 248253  365478  503422]]
Evaluating performance on  train set...
6711/6711 - 110s - 110s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71942085
{'0': {'precision': 0.45319833849529906, 'recall': 0.5179970206794046, 'f1-score': 0.4834359779414725, 'support': 301411}, '1': {'precision': 0.8180676024145812, 'recall': 0.8009661558544956, 'f1-score': 0.8094265599942012, 'support': 1115348}, '2': {'precision': 0.4815825375170532, 'recall': 0.44988503222757964, 'f1-score': 0.46519445753864896, 'support': 300519}, 'accuracy': 0.6898620957119348, 'macro avg': {'precision': 0.5842828261423112, 'recall': 0.5896160695871598, 'f1-score': 0.5860189984914409, 'support': 1717278}, 'weighted avg': {'precision': 0.6951429711521327, 'recall': 0.6898620957119348, 'f1-score': 0.6919700768127156, 'support': 1717278}}
[[156130 102142  43139]
 [119591 893356 102401]
 [ 68786  96534 135199]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6766351
{'0': {'precision': 0.475079612862941, 'recall': 0.5134358171487186, 'f1-score': 0.4935135696123709, 'support': 74093}, '1': {'precision': 0.8316106760275215, 'recall': 0.8325250034251267, 'f1-score': 0.8320675885465073, 'support': 291960}, '2': {'precision': 0.4906588440967747, 'recall': 0.44875338753387534, 'f1-score': 0.46877145303863493, 'support': 73800}, 'accuracy': 0.7143841237868106, 'macro avg': {'precision': 0.5991163776624123, 'recall': 0.5982380693692402, 'f1-score': 0.5981175370658377, 'support': 439853}, 'weighted avg': {'precision': 0.714347178314553, 'recall': 0.7143841237868106, 'f1-score': 0.7140833126057544, 'support': 439853}}
[[ 38042  25013  11038]
 [ 25555 243064  23341]
 [ 16478  24204  33118]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2637972
{'0': {'precision': 0.3582526930801534, 'recall': 0.7582748826155006, 'f1-score': 0.48660512235496894, 'support': 51753}, '1': {'precision': 0.597916892698275, 'recall': 0.08284477315775232, 'f1-score': 0.1455260829955505, 'support': 66522}, '2': {'precision': 0.4019752213779427, 'recall': 0.39820667924454906, 'f1-score': 0.4000820761353866, 'support': 51413}, 'accuracy': 0.38439371081042856, 'macro avg': {'precision': 0.45271493571879035, 'recall': 0.4131087783392673, 'f1-score': 0.3440710938286354, 'support': 169688}, 'weighted avg': {'precision': 0.465454429410188, 'recall': 0.38439371081042856, 'f1-score': 0.32667826110635606, 'support': 169688}}
[[39243  2093 10417]
 [40970  5511 20041]
 [29327  1613 20473]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.345011
{'0': {'precision': 0.29144938745976695, 'recall': 0.7301537692211526, 'f1-score': 0.4166057385380815, 'support': 15998}, '1': {'precision': 0.6547694922455917, 'recall': 0.09128876514321259, 'f1-score': 0.16023708017053137, 'support': 33761}, '2': {'precision': 0.3321065464415513, 'recall': 0.4306251491290861, 'f1-score': 0.37500324666891777, 'support': 16764}, 'accuracy': 0.33044210273138613, 'macro avg': {'precision': 0.4261084753823033, 'recall': 0.4173558944978171, 'f1-score': 0.31728202179251025, 'support': 66523}, 'weighted avg': {'precision': 0.48608322343897503, 'recall': 0.33044210273138613, 'f1-score': 0.2760124632973149, 'support': 66523}}
[[11681   825  3492]
 [19653  3082 11026]
 [ 8745   800  7219]]
Evaluating performance on  val set...
51/51 - 1s - 562ms/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3305
{'0': {'precision': 0.2921755955980167, 'recall': 0.7626262626262627, 'f1-score': 0.4224884147940894, 'support': 3168}, '1': {'precision': 0.687847498014297, 'recall': 0.1321532122691897, 'f1-score': 0.22171018945212492, 'support': 6553}, '2': {'precision': 0.329617354624887, 'recall': 0.34996801023672425, 'f1-score': 0.3394879751745539, 'support': 3126}, 'accuracy': 0.3406242702576477, 'macro avg': {'precision': 0.4365468160790669, 'recall': 0.41491582837739216, 'f1-score': 0.32789552647358944, 'support': 12847}, 'weighted avg': {'precision': 0.5031105154432632, 'recall': 0.3406242702576477, 'f1-score': 0.2998793165675337, 'support': 12847}}
[[2416  191  561]
 [4023  866 1664]
 [1830  202 1094]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 13s - 13s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.45648625
{'0': {'precision': 0.394522091974752, 'recall': 0.5123693532804403, 'f1-score': 0.44578881006660975, 'support': 34157}, '1': {'precision': 0.9189692792180268, 'recall': 0.9156221832962025, 'f1-score': 0.9172926779748612, 'support': 352806}, '2': {'precision': 0.5252895061482749, 'recall': 0.38769935677152173, 'f1-score': 0.44612680816547245, 'support': 34047}, 'accuracy': 0.8402128215481818, 'macro avg': {'precision': 0.6129269591136847, 'recall': 0.6052302977827214, 'f1-score': 0.6030694320689811, 'support': 421010}, 'weighted avg': {'precision': 0.8445834978627756, 'recall': 0.8402128215481818, 'f1-score': 0.8409359596414668, 'support': 421010}}
[[ 17501  14114   2542]
 [ 20382 323037   9387]
 [  6477  14370  13200]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57688606
{'0': {'precision': 0.4640188596315979, 'recall': 0.5347177456487706, 'f1-score': 0.4968659749705851, 'support': 21718}, '1': {'precision': 0.8782285400064017, 'recall': 0.8619298090167302, 'f1-score': 0.870002845644132, 'support': 124147}, '2': {'precision': 0.47795291300877896, 'recall': 0.4551370351018857, 'f1-score': 0.46626602759056957, 'support': 21053}, 'accuracy': 0.7680477839418157, 'macro avg': {'precision': 0.6067334375489262, 'recall': 0.6172615299224622, 'f1-score': 0.6110449494017622, 'support': 166918}, 'weighted avg': {'precision': 0.7738490925318277, 'recall': 0.7680477839418157, 'f1-score': 0.7705309026076126, 'support': 166918}}
[[ 11613   7460   2645]
 [  9320 107006   7821]
 [  4094   7377   9582]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.51784754
{'0': {'precision': 0.48552298226565327, 'recall': 0.5247408566399374, 'f1-score': 0.5043707115330388, 'support': 5113}, '1': {'precision': 0.8934406042196864, 'recall': 0.8999917302974336, 'f1-score': 0.8967042021422688, 'support': 36277}, '2': {'precision': 0.5058043117744611, 'recall': 0.4357142857142857, 'f1-score': 0.46815042210283964, 'support': 4900}, 'accuracy': 0.8093972780298121, 'macro avg': {'precision': 0.6282559660866002, 'recall': 0.6201489575505522, 'f1-score': 0.623075111926049, 'support': 46290}, 'weighted avg': {'precision': 0.8073507223006419, 'recall': 0.8093972780298121, 'f1-score': 0.8080043823177236, 'support': 46290}}
[[ 2683  1901   529]
 [ 2071 32649  1557]
 [  772  1993  2135]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0427997
{'0': {'precision': 0.47137556425628463, 'recall': 0.5532440154225957, 'f1-score': 0.5090390914117997, 'support': 108153}, '1': {'precision': 0.565647351105849, 'recall': 0.5004636625910153, 'f1-score': 0.5310627907082689, 'support': 116464}, '2': {'precision': 0.49251540668956106, 'recall': 0.4688574806534824, 'f1-score': 0.48039535086471535, 'support': 111648}, 'accuracy': 0.5069454150744205, 'macro avg': {'precision': 0.5098461073505649, 'recall': 0.5075217195556978, 'f1-score': 0.5068324109949279, 'support': 336265}, 'weighted avg': {'precision': 0.5110451418562076, 'recall': 0.5069454150744205, 'f1-score': 0.5071565040781881, 'support': 336265}}
[[59835 21909 26409]
 [30649 58286 27529]
 [36453 22848 52347]]
Evaluating performance on  train set...
524/524 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89519554
{'0': {'precision': 0.4822242479489517, 'recall': 0.564314187861434, 'f1-score': 0.5200496714440939, 'support': 35622}, '1': {'precision': 0.705497679550839, 'recall': 0.6979996146930388, 'f1-score': 0.7017286182352276, 'support': 62288}, '2': {'precision': 0.5070995896567446, 'recall': 0.4312340755511244, 'f1-score': 0.46609991917861526, 'support': 36108}, 'accuracy': 0.5905923084958737, 'macro avg': {'precision': 0.564940505718845, 'recall': 0.5645159593685324, 'f1-score': 0.5626260696193123, 'support': 134018}, 'weighted avg': {'precision': 0.5926978734768907, 'recall': 0.5905923084958737, 'f1-score': 0.5899537185342179, 'support': 134018}}
[[20102  8676  6844]
 [10520 43477  8291]
 [11064  9473 15571]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.022275
{'0': {'precision': 0.47378510495542986, 'recall': 0.5692732926407924, 'f1-score': 0.5171584013391923, 'support': 8683}, '1': {'precision': 0.5848292469352014, 'recall': 0.5413922383220184, 'f1-score': 0.5622730860299922, 'support': 9869}, '2': {'precision': 0.4983554795421655, 'recall': 0.43954513808308193, 'f1-score': 0.46710648005425737, 'support': 8618}, 'accuracy': 0.5179977916820022, 'macro avg': {'precision': 0.5189899438109323, 'recall': 0.5167368896819643, 'f1-score': 0.515512655807814, 'support': 27170}, 'weighted avg': {'precision': 0.5219132656248024, 'recall': 0.5179977916820022, 'f1-score': 0.5176696036056603, 'support': 27170}}
[[4943 1917 1823]
 [2536 5343 1990]
 [2954 1876 3788]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2542368
{'0': {'precision': 0.36122911789335993, 'recall': 0.5049990600058109, 'f1-score': 0.42118317006332434, 'support': 117022}, '1': {'precision': 0.32086483343025674, 'recall': 0.14890889462929405, 'f1-score': 0.20341549481223997, 'support': 103748}, '2': {'precision': 0.34762615167710414, 'recall': 0.37539722583671914, 'f1-score': 0.3609783501512978, 'support': 112971}, 'accuracy': 0.35043341992742877, 'macro avg': {'precision': 0.3432400343335736, 'recall': 0.34310172682394136, 'f1-score': 0.3285256716756207, 'support': 333741}, 'weighted avg': {'precision': 0.34407673181884507, 'recall': 0.35043341992742877, 'f1-score': 0.33310780778469795, 'support': 333741}}
[[59096 16368 41558]
 [50270 15449 38029]
 [54231 16331 42409]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2613126
{'0': {'precision': 0.36065151994933503, 'recall': 0.5376309190146039, 'f1-score': 0.43170699927744804, 'support': 33895}, '1': {'precision': 0.3247306640939058, 'recall': 0.12524031007751937, 'f1-score': 0.1807644110275689, 'support': 32250}, '2': {'precision': 0.33778344671201815, 'recall': 0.3712345409800318, 'f1-score': 0.35371989136403437, 'support': 32101}, 'accuracy': 0.34789202613846876, 'macro avg': {'precision': 0.341055210251753, 'recall': 0.344701923357385, 'f1-score': 0.3220637672230171, 'support': 98246}, 'weighted avg': {'precision': 0.34138828663369164, 'recall': 0.34789202613846876, 'f1-score': 0.3238515891621549, 'support': 98246}}
[[18223  4156 11516]
 [16364  4039 11847]
 [15941  4243 11917]]
Evaluating performance on  val set...
93/93 - 1s - 801ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2762094
{'0': {'precision': 0.3548480046102867, 'recall': 0.6038984920926811, 'f1-score': 0.4470257271201053, 'support': 8157}, '1': {'precision': 0.27744270205066346, 'recall': 0.09391588403429972, 'f1-score': 0.1403294691885296, 'support': 7347}, '2': {'precision': 0.3697304768486524, 'recall': 0.33024691358024694, 'f1-score': 0.3488751222693186, 'support': 8100}, 'accuracy': 0.35125402474156925, 'macro avg': {'precision': 0.33400706116986756, 'recall': 0.34268709656907587, 'f1-score': 0.31207677285931784, 'support': 23604}, 'weighted avg': {'precision': 0.33586186951560826, 'recall': 0.35125402474156925, 'f1-score': 0.31788162839469186, 'support': 23604}}
[[4926  853 2378]
 [4475  690 2182]
 [4481  944 2675]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99941164
{'0': {'precision': 0.4987193938833965, 'recall': 0.586215734827751, 'f1-score': 0.5389394226832946, 'support': 230190}, '1': {'precision': 0.5624351026534662, 'recall': 0.50666117164383, 'f1-score': 0.5330932955899156, 'support': 215953}, '2': {'precision': 0.5224358181791205, 'recall': 0.47762570703850904, 'f1-score': 0.4990268513444569, 'support': 221169}, 'accuracy': 0.5244803030666315, 'macro avg': {'precision': 0.527863438238661, 'recall': 0.52350087117003, 'f1-score': 0.523686523205889, 'support': 667312}, 'weighted avg': {'precision': 0.5271992298538029, 'recall': 0.5244803030666315, 'f1-score': 0.5238191908057982, 'support': 667312}}
[[134941  44467  50782]
 [ 60757 109415  45781]
 [ 74877  40656 105636]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9599766
{'0': {'precision': 0.4807876965699624, 'recall': 0.55811786203746, 'f1-score': 0.5165747725197036, 'support': 54725}, '1': {'precision': 0.6450037881976597, 'recall': 0.6080711082893536, 'f1-score': 0.6259931779652361, 'support': 75603}, '2': {'precision': 0.5085707411936887, 'recall': 0.46671695613776865, 'f1-score': 0.4867457858026883, 'support': 54352}, 'accuracy': 0.551667749620966, 'macro avg': {'precision': 0.5447874086537703, 'recall': 0.544301975488194, 'f1-score': 0.5431045787625427, 'support': 184680}, 'weighted avg': {'precision': 0.5561899773622386, 'recall': 0.551667749620966, 'f1-score': 0.5525889300941859, 'support': 184680}}
[[30543 13201 10981]
 [16100 45972 13531]
 [16884 12101 25367]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.998345
{'0': {'precision': 0.492117479431907, 'recall': 0.5701885184790713, 'f1-score': 0.5282841988405083, 'support': 18778}, '1': {'precision': 0.5859685407935558, 'recall': 0.5227736233854521, 'f1-score': 0.5525701234377807, 'support': 20594}, '2': {'precision': 0.5062298364667928, 'recall': 0.4857493595217763, 'f1-score': 0.49577817726207984, 'support': 18736}, 'accuracy': 0.5261581882012804, 'macro avg': {'precision': 0.5281052855640852, 'recall': 0.5262371671287666, 'f1-score': 0.5255441665134563, 'support': 58108}, 'weighted avg': {'precision': 0.5299294481640507, 'recall': 0.5261581882012804, 'f1-score': 0.5264103004248476, 'support': 58108}}
[[10707  3796  4275]
 [ 5226 10766  4602]
 [ 5824  3811  9101]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/EXC
Evaluating performance on  test set...
5343/5343 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48940465
{'0': {'precision': 0.5250937007983726, 'recall': 0.4867704707348734, 'f1-score': 0.5052063609095632, 'support': 154843}, '1': {'precision': 0.8812034147972706, 'recall': 0.9058321188412467, 'f1-score': 0.8933480519334973, 'support': 1055997}, '2': {'precision': 0.5416258217045323, 'recall': 0.4787733594989455, 'f1-score': 0.5082638618800412, 'support': 156949}, 'accuracy': 0.8093879977101731, 'macro avg': {'precision': 0.6493076457667252, 'recall': 0.6237919830250219, 'f1-score': 0.6356060915743672, 'support': 1367789}, 'weighted avg': {'precision': 0.8019240375665402, 'recall': 0.8093879977101731, 'f1-score': 0.8052207147433905, 'support': 1367789}}
[[ 75373  65275  14195]
 [ 50043 956556  49398]
 [ 18126  63680  75143]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4735895
{'0': {'precision': 0.46497288038823864, 'recall': 0.5120885339705097, 'f1-score': 0.4873947065248291, 'support': 31807}, '1': {'precision': 0.903699476937708, 'recall': 0.8945590655254348, 'f1-score': 0.8991060412235351, 'support': 265561}, '2': {'precision': 0.5040592464055528, 'recall': 0.4958090767777134, 'f1-score': 0.4999001244602879, 'support': 32809}, 'accuracy': 0.818091508493929, 'macro avg': {'precision': 0.6242438679104998, 'recall': 0.6341522254245526, 'f1-score': 0.6288002907362173, 'support': 330177}, 'weighted avg': {'precision': 0.8217241328647458, 'recall': 0.818091508493929, 'f1-score': 0.8197763200562608, 'support': 330177}}
[[ 16288  12615   2904]
 [ 14900 237560  13101]
 [  3842  12700  16267]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46799225
{'0': {'precision': 0.4823273518216422, 'recall': 0.48859755425801477, 'f1-score': 0.48544220665499127, 'support': 9077}, '1': {'precision': 0.8999655373522083, 'recall': 0.9077503108413439, 'f1-score': 0.903841161866601, 'support': 74797}, '2': {'precision': 0.5055453991468617, 'recall': 0.46243032329988853, 'f1-score': 0.48302765647743817, 'support': 8970}, 'accuracy': 0.8237473611649649, 'macro avg': {'precision': 0.6292794294402374, 'recall': 0.6195927294664157, 'f1-score': 0.6241036749996768, 'support': 92844}, 'weighted avg': {'precision': 0.8210282829279815, 'recall': 0.8237473611649649, 'f1-score': 0.8222795697357517, 'support': 92844}}
[[ 4435  3811   831]
 [ 3674 67897  3226]
 [ 1086  3736  4148]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/AAL
Evaluating performance on  test set...
7177/7177 - 58s - 58s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5068331
{'0': {'precision': 0.5114642956376771, 'recall': 0.44348609618711243, 'f1-score': 0.47505567986208425, 'support': 207533}, '1': {'precision': 0.8706082450254128, 'recall': 0.9207437079861972, 'f1-score': 0.8949743933685365, 'support': 1423193}, '2': {'precision': 0.5475198863075618, 'recall': 0.4032554285409691, 'f1-score': 0.46444278251551546, 'support': 206363}, 'accuracy': 0.8086984354051436, 'macro avg': {'precision': 0.6431974756568839, 'recall': 0.5891617442380929, 'f1-score': 0.6114909519153787, 'support': 1837089}, 'weighted avg': {'precision': 0.7937433221945772, 'recall': 0.8086984354051436, 'f1-score': 0.7991745789988481, 'support': 1837089}}
[[  92038   99454   16041]
 [  60066 1310396   52731]
 [  27846   95300   83217]]
Evaluating performance on  train set...
2257/2257 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5435233
{'0': {'precision': 0.463771603278178, 'recall': 0.4866040930287819, 'f1-score': 0.47491357631012515, 'support': 67334}, '1': {'precision': 0.8752029027021866, 'recall': 0.889716090321969, 'f1-score': 0.88239982447735, 'support': 442993}, '2': {'precision': 0.5001855549861276, 'recall': 0.42088984059005474, 'f1-score': 0.4571243994024307, 'support': 67248}, 'accuracy': 0.7881348742587543, 'macro avg': {'precision': 0.6130533536554974, 'recall': 0.5990700079802685, 'f1-score': 0.604812600063302, 'support': 577575}, 'weighted avg': {'precision': 0.7835741415635886, 'recall': 0.7881348742587543, 'f1-score': 0.7853793495268586, 'support': 577575}}
[[ 32765  28388   6181]
 [ 26753 394138  22102]
 [ 11131  27813  28304]]
Evaluating performance on  val set...
638/638 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5125266
{'0': {'precision': 0.5037970212515454, 'recall': 0.48176086467011936, 'f1-score': 0.49253258899024494, 'support': 17764}, '1': {'precision': 0.8822386467540384, 'recall': 0.9086878041123843, 'f1-score': 0.89526791927627, 'support': 127420}, '2': {'precision': 0.5164558638500761, 'recall': 0.4298390652557319, 'f1-score': 0.46918333583997596, 'support': 18144}, 'accuracy': 0.8090590713166145, 'macro avg': {'precision': 0.6341638439518866, 'recall': 0.6067625780127451, 'f1-score': 0.6189946147021637, 'support': 163328}, 'weighted avg': {'precision': 0.8004437319296619, 'recall': 0.8090590713166145, 'f1-score': 0.8041318673496617, 'support': 163328}}
[[  8558   7587   1619]
 [  5952 115785   5683]
 [  2477   7868   7799]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/WBA
Evaluating performance on  test set...
5696/5696 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87976956
{'0': {'precision': 0.45535452824663464, 'recall': 0.4448052043798419, 'f1-score': 0.4500180504876615, 'support': 339099}, '1': {'precision': 0.69861156170161, 'recall': 0.6990296925246254, 'f1-score': 0.6988205645672446, 'support': 788616}, '2': {'precision': 0.46517102812317696, 'recall': 0.47556984520554996, 'f1-score': 0.47031296313484094, 'support': 330309}, 'accuracy': 0.5892797375077502, 'macro avg': {'precision': 0.5397123726904739, 'recall': 0.5398015807033391, 'f1-score': 0.5397171927299157, 'support': 1458024}, 'weighted avg': {'precision': 0.5891512743583925, 'recall': 0.5892797375077502, 'f1-score': 0.5891880749488239, 'support': 1458024}}
[[150833 130434  57832]
 [114574 551266 122776]
 [ 65836 107388 157085]]
Evaluating performance on  train set...
2222/2222 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7290715
{'0': {'precision': 0.49189651079990504, 'recall': 0.48574884209342006, 'f1-score': 0.48880334743823795, 'support': 106658}, '1': {'precision': 0.7817864890621733, 'recall': 0.8062966063962947, 'f1-score': 0.7938524059099394, 'support': 357113}, '2': {'precision': 0.4908564510185819, 'recall': 0.4446818251182664, 'f1-score': 0.4666296357458478, 'support': 104848}, 'accuracy': 0.6794918917588051, 'macro avg': {'precision': 0.5881798169602201, 'recall': 0.5789090912026604, 'f1-score': 0.5830951296980084, 'support': 568619}, 'weighted avg': {'precision': 0.6737659728108846, 'recall': 0.6794918917588051, 'f1-score': 0.6762964053460481, 'support': 568619}}
[[ 51809  40692  14157]
 [ 34970 287939  34204]
 [ 18546  39678  46624]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76903737
{'0': {'precision': 0.44996710329565165, 'recall': 0.49395929087327645, 'f1-score': 0.4709380575291871, 'support': 30460}, '1': {'precision': 0.7854110154499351, 'recall': 0.7681970238781867, 'f1-score': 0.7767086540704455, 'support': 104028}, '2': {'precision': 0.44604165939778795, 'recall': 0.43543717429067746, 'f1-score': 0.4406756290934161, 'support': 29359}, 'accuracy': 0.6575890922629039, 'macro avg': {'precision': 0.5604732593811249, 'recall': 0.5658644963473802, 'f1-score': 0.5627741135643496, 'support': 163847}, 'weighted avg': {'precision': 0.6622402128807428, 'recall': 0.6575890922629039, 'f1-score': 0.6596520955069849, 'support': 163847}}
[[15046 11080  4334]
 [12571 79914 11543]
 [ 5821 10754 12784]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 100s - 100s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6626541
{'0': {'precision': 0.5279314879216089, 'recall': 0.44932536714230253, 'f1-score': 0.48546706714243626, 'support': 528065}, '1': {'precision': 0.8034393050556046, 'recall': 0.8586886256480994, 'f1-score': 0.8301457185161106, 'support': 2034217}, '2': {'precision': 0.5181850028261276, 'recall': 0.45790033424491033, 'f1-score': 0.486181027381861, 'support': 526560}, 'accuracy': 0.7203812949966363, 'macro avg': {'precision': 0.6165185986011137, 'recall': 0.5886381090117708, 'f1-score': 0.6005979376801359, 'support': 3088842}, 'weighted avg': {'precision': 0.7077110221467291, 'recall': 0.7203812949966363, 'f1-score': 0.7125836095441108, 'support': 3088842}}
[[ 237273  222062   68730]
 [ 131999 1746759  155459]
 [  80167  205281  241112]]
Evaluating performance on  train set...
2948/2948 - 27s - 27s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7082232
{'0': {'precision': 0.47456114482608763, 'recall': 0.47874455892023926, 'f1-score': 0.47664367278537745, 'support': 127732}, '1': {'precision': 0.8065644246055768, 'recall': 0.811612872301544, 'f1-score': 0.8090807732892666, 'support': 500703}, '2': {'precision': 0.4822518002742493, 'recall': 0.46595317619618076, 'f1-score': 0.47396241032303876, 'support': 126047}, 'accuracy': 0.697511670258535, 'macro avg': {'precision': 0.5877924565686379, 'recall': 0.5854368691393214, 'f1-score': 0.5865622854658943, 'support': 754482}, 'weighted avg': {'precision': 0.6961760040841004, 'recall': 0.697511670258535, 'f1-score': 0.6968136548976193, 'support': 754482}}
[[ 61151  51102  15479]
 [ 46750 406377  47576]
 [ 20957  46358  58732]]
Evaluating performance on  val set...
697/697 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6227492
{'0': {'precision': 0.49735868991019544, 'recall': 0.43961089494163424, 'f1-score': 0.46670522141440846, 'support': 25700}, '1': {'precision': 0.8331442144759138, 'recall': 0.8636413537843857, 'f1-score': 0.8481187142879145, 'support': 127524}, '2': {'precision': 0.4843350927975481, 'recall': 0.45193835398792503, 'f1-score': 0.46757623078819754, 'support': 25176}, 'accuracy': 0.7444562780269058, 'macro avg': {'precision': 0.604945999061219, 'recall': 0.5850635342379816, 'f1-score': 0.5941333888301735, 'support': 178400}, 'weighted avg': {'precision': 0.7355472053463539, 'recall': 0.7444562780269058, 'f1-score': 0.7394703716229035, 'support': 178400}}
[[ 11298  11655   2747]
 [  8022 110135   9367]
 [  3396  10402  11378]]
testing model on single stock: results/universal/W1/deepVOL_L2/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 209s - 209s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0492811
{'0': {'precision': 0.46289787810351224, 'recall': 0.5694464060899816, 'f1-score': 0.5106736911487899, 'support': 1805457}, '1': {'precision': 0.5456590858676018, 'recall': 0.30939055352795736, 'f1-score': 0.3948817912688154, 'support': 1836601}, '2': {'precision': 0.458567055656844, 'recall': 0.5540098204158739, 'f1-score': 0.5017903492689273, 'support': 1824159}, 'accuracy': 0.4769184977471623, 'macro avg': {'precision': 0.489041339875986, 'recall': 0.4776155933446043, 'f1-score': 0.4691152772288442, 'support': 5466217}, 'weighted avg': {'precision': 0.4892596577762261, 'recall': 0.4769184977471623, 'f1-score': 0.4688041226425105, 'support': 5466217}}
[[1028111  249718  527628]
 [ 602778  568227  665596]
 [ 590143  223414 1010602]]
Evaluating performance on  train set...
6073/6073 - 55s - 55s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9562155
{'0': {'precision': 0.44320482905779407, 'recall': 0.4968996524661682, 'f1-score': 0.4685188292542608, 'support': 393343}, '1': {'precision': 0.6749986580543578, 'recall': 0.5421030423610467, 'f1-score': 0.6012953987263362, 'support': 765491}, '2': {'precision': 0.4311537397399244, 'recall': 0.5434398059233801, 'f1-score': 0.48082835288619985, 'support': 395720}, 'accuracy': 0.5310056775126499, 'macro avg': {'precision': 0.516452408950692, 'recall': 0.5274808335835317, 'f1-score': 0.5168808602889323, 'support': 1554554}, 'weighted avg': {'precision': 0.5542767074792199, 'recall': 0.5310056775126499, 'f1-score': 0.5370339105144675, 'support': 1554554}}
[[195452 106995  90896]
 [157684 414975 192832]
 [ 87861  92809 215050]]
Evaluating performance on  val set...
1786/1786 - 17s - 17s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0034941
{'0': {'precision': 0.4515504665661546, 'recall': 0.5241173271112022, 'f1-score': 0.48513525838638477, 'support': 126859}, '1': {'precision': 0.637527217510887, 'recall': 0.43866246118969, 'f1-score': 0.5197211306586946, 'support': 202910}, '2': {'precision': 0.4309197973357756, 'recall': 0.5760217855349071, 'f1-score': 0.49301607025910565, 'support': 127424}, 'accuracy': 0.5006572716555153, 'macro avg': {'precision': 0.5066658271376058, 'recall': 0.5129338579452664, 'f1-score': 0.49929081976806167, 'support': 457193}, 'weighted avg': {'precision': 0.5283401377513737, 'recall': 0.5006572716555153, 'f1-score': 0.502681511095512, 'support': 457193}}
[[66489 26991 33379]
 [50348 89009 63553]
 [30409 23616 73399]]
training model: results/universal/W1/deepVOL_L2/h20
Epoch 1/50
10622/10622 - 351s - loss: 2.8200 - accuracy20: 0.5338 - val_loss: 3.1218 - val_accuracy20: 0.5277 - 351s/epoch - 33ms/step
Epoch 2/50
10622/10622 - 335s - loss: 2.7214 - accuracy20: 0.5597 - val_loss: 3.1181 - val_accuracy20: 0.5384 - 335s/epoch - 32ms/step
Epoch 3/50
10622/10622 - 335s - loss: 2.6882 - accuracy20: 0.5666 - val_loss: 3.1107 - val_accuracy20: 0.5381 - 335s/epoch - 32ms/step
Epoch 4/50
10622/10622 - 327s - loss: 2.6695 - accuracy20: 0.5703 - val_loss: 3.0583 - val_accuracy20: 0.5450 - 327s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 328s - loss: 2.6541 - accuracy20: 0.5732 - val_loss: 3.0743 - val_accuracy20: 0.5433 - 328s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 330s - loss: 2.6423 - accuracy20: 0.5758 - val_loss: 3.0485 - val_accuracy20: 0.5451 - 330s/epoch - 31ms/step
Epoch 7/50
10622/10622 - 328s - loss: 2.6329 - accuracy20: 0.5773 - val_loss: 3.0247 - val_accuracy20: 0.5495 - 328s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 329s - loss: 2.6250 - accuracy20: 0.5788 - val_loss: 3.0009 - val_accuracy20: 0.5503 - 329s/epoch - 31ms/step
Epoch 9/50
10622/10622 - 338s - loss: 2.6188 - accuracy20: 0.5800 - val_loss: 2.9744 - val_accuracy20: 0.5543 - 338s/epoch - 32ms/step
Epoch 10/50
10622/10622 - 335s - loss: 2.6137 - accuracy20: 0.5809 - val_loss: 2.9869 - val_accuracy20: 0.5539 - 335s/epoch - 32ms/step
Epoch 11/50
10622/10622 - 338s - loss: 2.6093 - accuracy20: 0.5816 - val_loss: 2.9656 - val_accuracy20: 0.5555 - 338s/epoch - 32ms/step
Epoch 12/50
10622/10622 - 337s - loss: 2.6054 - accuracy20: 0.5822 - val_loss: 2.9648 - val_accuracy20: 0.5551 - 337s/epoch - 32ms/step
Epoch 13/50
10622/10622 - 339s - loss: 2.6019 - accuracy20: 0.5830 - val_loss: 2.9551 - val_accuracy20: 0.5563 - 339s/epoch - 32ms/step
Epoch 14/50
10622/10622 - 336s - loss: 2.5987 - accuracy20: 0.5835 - val_loss: 2.9595 - val_accuracy20: 0.5561 - 336s/epoch - 32ms/step
Epoch 15/50
10622/10622 - 327s - loss: 2.5958 - accuracy20: 0.5839 - val_loss: 2.9644 - val_accuracy20: 0.5555 - 327s/epoch - 31ms/step
Epoch 16/50
10622/10622 - 328s - loss: 2.5928 - accuracy20: 0.5845 - val_loss: 2.9562 - val_accuracy20: 0.5563 - 328s/epoch - 31ms/step
Epoch 17/50
10622/10622 - 325s - loss: 2.5905 - accuracy20: 0.5850 - val_loss: 2.9643 - val_accuracy20: 0.5560 - 325s/epoch - 31ms/step
Epoch 18/50
10622/10622 - 326s - loss: 2.5883 - accuracy20: 0.5853 - val_loss: 2.9626 - val_accuracy20: 0.5550 - 326s/epoch - 31ms/step
Epoch 19/50
10622/10622 - 331s - loss: 2.5864 - accuracy20: 0.5857 - val_loss: 2.9445 - val_accuracy20: 0.5572 - 331s/epoch - 31ms/step
Epoch 20/50
10622/10622 - 330s - loss: 2.5842 - accuracy20: 0.5861 - val_loss: 2.9521 - val_accuracy20: 0.5564 - 330s/epoch - 31ms/step
Epoch 21/50
10622/10622 - 333s - loss: 2.5822 - accuracy20: 0.5865 - val_loss: 2.9382 - val_accuracy20: 0.5593 - 333s/epoch - 31ms/step
Epoch 22/50
10622/10622 - 339s - loss: 2.5803 - accuracy20: 0.5868 - val_loss: 2.9314 - val_accuracy20: 0.5583 - 339s/epoch - 32ms/step
Epoch 23/50
10622/10622 - 327s - loss: 2.5788 - accuracy20: 0.5868 - val_loss: 2.9421 - val_accuracy20: 0.5576 - 327s/epoch - 31ms/step
Epoch 24/50
10622/10622 - 335s - loss: 2.5769 - accuracy20: 0.5875 - val_loss: 2.9259 - val_accuracy20: 0.5591 - 335s/epoch - 32ms/step
Epoch 25/50
10622/10622 - 327s - loss: 2.5754 - accuracy20: 0.5874 - val_loss: 2.9148 - val_accuracy20: 0.5605 - 327s/epoch - 31ms/step
Epoch 26/50
10622/10622 - 332s - loss: 2.5737 - accuracy20: 0.5878 - val_loss: 2.9247 - val_accuracy20: 0.5593 - 332s/epoch - 31ms/step
Epoch 27/50
10622/10622 - 327s - loss: 2.5725 - accuracy20: 0.5883 - val_loss: 2.9324 - val_accuracy20: 0.5582 - 327s/epoch - 31ms/step
Epoch 28/50
10622/10622 - 326s - loss: 2.5711 - accuracy20: 0.5884 - val_loss: 2.9212 - val_accuracy20: 0.5591 - 326s/epoch - 31ms/step
Epoch 29/50
10622/10622 - 332s - loss: 2.5697 - accuracy20: 0.5885 - val_loss: 2.9271 - val_accuracy20: 0.5588 - 332s/epoch - 31ms/step
Epoch 30/50
10622/10622 - 329s - loss: 2.5688 - accuracy20: 0.5886 - val_loss: 2.9307 - val_accuracy20: 0.5578 - 329s/epoch - 31ms/step
Epoch 31/50
10622/10622 - 331s - loss: 2.5672 - accuracy20: 0.5890 - val_loss: 2.9059 - val_accuracy20: 0.5616 - 331s/epoch - 31ms/step
Epoch 32/50
10622/10622 - 329s - loss: 2.5658 - accuracy20: 0.5891 - val_loss: 2.9106 - val_accuracy20: 0.5613 - 329s/epoch - 31ms/step
Epoch 33/50
10622/10622 - 326s - loss: 2.5650 - accuracy20: 0.5893 - val_loss: 2.9120 - val_accuracy20: 0.5600 - 326s/epoch - 31ms/step
Epoch 34/50
10622/10622 - 329s - loss: 2.5637 - accuracy20: 0.5896 - val_loss: 2.9092 - val_accuracy20: 0.5604 - 329s/epoch - 31ms/step
Epoch 35/50
10622/10622 - 336s - loss: 2.5625 - accuracy20: 0.5899 - val_loss: 2.9167 - val_accuracy20: 0.5589 - 336s/epoch - 32ms/step
Epoch 36/50
10622/10622 - 334s - loss: 2.5613 - accuracy20: 0.5899 - val_loss: 2.9135 - val_accuracy20: 0.5599 - 334s/epoch - 31ms/step
Epoch 37/50
10622/10622 - 332s - loss: 2.5600 - accuracy20: 0.5900 - val_loss: 2.9170 - val_accuracy20: 0.5591 - 332s/epoch - 31ms/step
Epoch 38/50
10622/10622 - 342s - loss: 2.5591 - accuracy20: 0.5903 - val_loss: 2.9113 - val_accuracy20: 0.5603 - 342s/epoch - 32ms/step
Epoch 39/50
10622/10622 - 335s - loss: 2.5582 - accuracy20: 0.5904 - val_loss: 2.9179 - val_accuracy20: 0.5594 - 335s/epoch - 32ms/step
Epoch 40/50
10622/10622 - 337s - loss: 2.5568 - accuracy20: 0.5905 - val_loss: 2.9153 - val_accuracy20: 0.5587 - 337s/epoch - 32ms/step
Epoch 41/50
10622/10622 - 330s - loss: 2.5559 - accuracy20: 0.5911 - val_loss: 2.9186 - val_accuracy20: 0.5593 - 330s/epoch - 31ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 620s - 620s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93940926
{'0': {'precision': 0.5062154325203037, 'recall': 0.4950455538911127, 'f1-score': 0.5005681886765773, 'support': 2931912}, '1': {'precision': 0.5716519094679652, 'recall': 0.693964797750523, 'f1-score': 0.6268980165558952, 'support': 3175138}, '2': {'precision': 0.5273494017358692, 'recall': 0.41708544081074084, 'f1-score': 0.4657806929087973, 'support': 2939731}, 'accuracy': 0.5395270428232981, 'macro avg': {'precision': 0.535072247908046, 'recall': 0.5353652641507921, 'f1-score': 0.5310822993804233, 'support': 9046781}, 'weighted avg': {'precision': 0.5360490306806535, 'recall': 0.5395270428232981, 'f1-score': 0.5336019005915855, 'support': 9046781}}
[[1451430  831715  648767]
 [ 521530 2203434  450174]
 [ 894258  819354 1226119]]
Evaluating performance on  train set...
10622/10622 - 175s - 175s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89317244
{'0': {'precision': 0.5057700875917412, 'recall': 0.42114561391587957, 'f1-score': 0.45959487727452375, 'support': 735850}, '1': {'precision': 0.6190692302396912, 'recall': 0.7788179180693058, 'f1-score': 0.6898156401527608, 'support': 1247054}, '2': {'precision': 0.5199084429528451, 'recall': 0.3794891314691209, 'f1-score': 0.4387372371699817, 'support': 735610}, 'accuracy': 0.5739473844902031, 'macro avg': {'precision': 0.5482492535947592, 'recall': 0.5264842211514354, 'f1-score': 0.5293825848657554, 'support': 2718514}, 'weighted avg': {'precision': 0.5615691250890203, 'recall': 0.5739473844902031, 'f1-score': 0.5595592823108984, 'support': 2718514}}
[[309900 299253 126697]
 [144746 971228 131080]
 [158083 298371 279156]]
Evaluating performance on  val set...
3064/3064 - 52s - 52s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91337484
{'0': {'precision': 0.5024689435533699, 'recall': 0.44974394252082855, 'f1-score': 0.4746467244308206, 'support': 222411}, '1': {'precision': 0.6119478819086517, 'recall': 0.7382050382925557, 'f1-score': 0.669173103043918, 'support': 339361}, '2': {'precision': 0.5110964084253994, 'recall': 0.4036332351377891, 'f1-score': 0.4510523918224764, 'support': 222006}, 'accuracy': 0.5615812130475721, 'macro avg': {'precision': 0.5418377446291404, 'recall': 0.5305274053170578, 'f1-score': 0.5316240730990717, 'support': 783778}, 'weighted avg': {'precision': 0.5523149853733323, 'recall': 0.5615812130475721, 'f1-score': 0.5521898335350202, 'support': 783778}}
[[100028  79432  42951]
 [ 46076 250518  42767]
 [ 52969  79428  89609]]
testing model out of sample: results/universal/W1/deepVOL_L2/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 412s - 412s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7775787
{'0': {'precision': 0.5499000433257666, 'recall': 0.40391354109775596, 'f1-score': 0.4657347669959274, 'support': 1417182}, '1': {'precision': 0.6935511643395056, 'recall': 0.8931396752743589, 'f1-score': 0.7807923840476515, 'support': 3274087}, '2': {'precision': 0.5883551141458687, 'recall': 0.351839974657777, 'f1-score': 0.44034871255126956, 'support': 1407927}, 'accuracy': 0.6545126603572011, 'macro avg': {'precision': 0.6106021072703803, 'recall': 0.5496310636766306, 'f1-score': 0.5622919545316162, 'support': 6099196}, 'weighted avg': {'precision': 0.6358897705522804, 'recall': 0.6545126603572011, 'f1-score': 0.6289996197345383, 'support': 6099196}}
[[ 572419  657626  187137]
 [ 190423 2924217  159447]
 [ 278109  634453  495365]]
Evaluating performance on  train set...
6711/6711 - 110s - 110s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7859095
{'0': {'precision': 0.5275335966861087, 'recall': 0.4267630728432916, 'f1-score': 0.47182782029588016, 'support': 386144}, '1': {'precision': 0.7072867717386784, 'recall': 0.862906712130837, 'f1-score': 0.7773850917157101, 'support': 946093}, '2': {'precision': 0.5588014682413023, 'recall': 0.363748276157604, 'f1-score': 0.4406549826092018, 'support': 385041}, 'accuracy': 0.6529170000430915, 'macro avg': {'precision': 0.5978739455553631, 'recall': 0.5511393537105777, 'f1-score': 0.5632892982069307, 'support': 1717278}, 'weighted avg': {'precision': 0.6335750373710147, 'recall': 0.6529170000430915, 'f1-score': 0.6331778026480007, 'support': 1717278}}
[[164792 170003  51349]
 [ 70470 816390  59233]
 [ 77120 167863 140058]]
Evaluating performance on  val set...
1720/1720 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7455984
{'0': {'precision': 0.5454370241881084, 'recall': 0.41998367554618016, 'f1-score': 0.4745592180912227, 'support': 94337}, '1': {'precision': 0.7290954548118054, 'recall': 0.8883340340634147, 'f1-score': 0.8008760951188987, 'support': 252118}, '2': {'precision': 0.5615505063965884, 'recall': 0.36093920640698945, 'f1-score': 0.4394316626474614, 'support': 93398}, 'accuracy': 0.6758985388300182, 'macro avg': {'precision': 0.612027661798834, 'recall': 0.556418972005528, 'f1-score': 0.5716223252858609, 'support': 439853}, 'weighted avg': {'precision': 0.6541291627509758, 'recall': 0.6758985388300182, 'f1-score': 0.6541408396309807, 'support': 439853}}
[[ 39620  41753  12964]
 [ 14796 223965  13357]
 [ 18223  41464  33711]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1584033
{'0': {'precision': 0.4197291675164172, 'recall': 0.6821790218598254, 'f1-score': 0.5196992557147097, 'support': 60339}, '1': {'precision': 0.48946675444371296, 'recall': 0.12040485829959514, 'f1-score': 0.19326748115414608, 'support': 49400}, '2': {'precision': 0.44538239052936035, 'recall': 0.4418088708735759, 'f1-score': 0.44358843380758184, 'support': 59949}, 'accuracy': 0.4337136391494979, 'macro avg': {'precision': 0.4515261041631635, 'recall': 0.41479758367766545, 'f1-score': 0.3855183902254791, 'support': 169688}, 'weighted avg': {'precision': 0.4490943663555298, 'recall': 0.4337136391494979, 'f1-score': 0.39777845208804047, 'support': 169688}}
[[41162  3334 15843]
 [26313  5948 17139]
 [30593  2870 26486]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2519968
{'0': {'precision': 0.3650705052878966, 'recall': 0.6350350043436047, 'f1-score': 0.46361618384972675, 'support': 19569}, '1': {'precision': 0.5273984151070645, 'recall': 0.11908024973351607, 'f1-score': 0.1942917481909376, 'support': 26268}, '2': {'precision': 0.3821181078638144, 'recall': 0.49047665087498793, 'f1-score': 0.4295694144544646, 'support': 20686}, 'accuracy': 0.3863475790328157, 'macro avg': {'precision': 0.4248623427529252, 'recall': 0.41486396831736955, 'f1-score': 0.3624924488317096, 'support': 66523}, 'weighted avg': {'precision': 0.4344702052715915, 'recall': 0.3863475790328157, 'f1-score': 0.3466806014557357, 'support': 66523}}
[[12427  1349  5793]
 [12527  3128 10613]
 [ 9086  1454 10146]]
Evaluating performance on  val set...
51/51 - 1s - 523ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2263768
{'0': {'precision': 0.3668789808917197, 'recall': 0.6622381195707716, 'f1-score': 0.4721741506512433, 'support': 3914}, '1': {'precision': 0.5703657780533168, 'recall': 0.17822549399457574, 'f1-score': 0.27158671586715866, 'support': 5162}, '2': {'precision': 0.37443031902134805, 'recall': 0.41394855476001063, 'f1-score': 0.39319899244332496, 'support': 3771}, 'accuracy': 0.394878181676656, 'macro avg': {'precision': 0.43722502598879487, 'recall': 0.41813738944178597, 'f1-score': 0.37898661965390895, 'support': 12847}, 'weighted avg': {'precision': 0.450857726360311, 'recall': 0.394878181676656, 'f1-score': 0.3683952404031305, 'support': 12847}}
[[2592  331  991]
 [2625  920 1617]
 [1848  362 1561]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.51083773
{'0': {'precision': 0.517953418158292, 'recall': 0.4105643282976132, 'f1-score': 0.4580487514154598, 'support': 46799}, '1': {'precision': 0.8640940435045519, 'recall': 0.9497181496961992, 'f1-score': 0.9048850804255474, 'support': 328011}, '2': {'precision': 0.6563675213675214, 'recall': 0.33244588744588743, 'f1-score': 0.4413505747126437, 'support': 46200}, 'accuracy': 0.8220493574974466, 'macro avg': {'precision': 0.6794716610101218, 'recall': 0.5642427884798998, 'f1-score': 0.6014281355178835, 'support': 421010}, 'weighted avg': {'precision': 0.8028223386797011, 'recall': 0.8220493574974466, 'f1-score': 0.8043487807526672, 'support': 421010}}
[[ 19214  24664   2921]
 [ 11373 311518   5120]
 [  6509  24332  15359]]
Evaluating performance on  train set...
653/653 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63640827
{'0': {'precision': 0.5523202514515214, 'recall': 0.4460583838668735, 'f1-score': 0.4935343566538589, 'support': 28364}, '1': {'precision': 0.8006395570828561, 'recall': 0.9079591891965034, 'f1-score': 0.8509289201699322, 'support': 110853}, '2': {'precision': 0.573255369145855, 'recall': 0.37868669001119093, 'f1-score': 0.45608695652173914, 'support': 27701}, 'accuracy': 0.7416336165063084, 'macro avg': {'precision': 0.6420717258934108, 'recall': 0.5775680876915227, 'f1-score': 0.6001834111151768, 'support': 166918}, 'weighted avg': {'precision': 0.7207075055667223, 'recall': 0.7416336165063084, 'f1-score': 0.7246713767378966, 'support': 166918}}
[[ 12652  12461   3251]
 [  5645 100650   4558]
 [  4610  12601  10490]]
Evaluating performance on  val set...
181/181 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.58598644
{'0': {'precision': 0.6044453591273925, 'recall': 0.4238095238095238, 'f1-score': 0.4982610908474001, 'support': 6930}, '1': {'precision': 0.8213693500936079, 'recall': 0.9383134738771769, 'f1-score': 0.8759555048488307, 'support': 32730}, '2': {'precision': 0.5968819599109132, 'recall': 0.36380090497737555, 'f1-score': 0.45206634804610624, 'support': 6630}, 'accuracy': 0.7790019442644199, 'macro avg': {'precision': 0.6742322230439712, 'recall': 0.575307967554692, 'f1-score': 0.6087609812474456, 'support': 46290}, 'weighted avg': {'precision': 0.7567412521392518, 'recall': 0.7790019442644199, 'f1-score': 0.7586989181425878, 'support': 46290}}
[[ 2937  3335   658]
 [ 1048 30711   971]
 [  874  3344  2412]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0693455
{'0': {'precision': 0.5039688955614582, 'recall': 0.5117064438207957, 'f1-score': 0.5078081968612058, 'support': 127921}, '1': {'precision': 0.3785923990626768, 'recall': 0.5517638438186957, 'f1-score': 0.44906152658342424, 'support': 76424}, '2': {'precision': 0.5387214602258971, 'recall': 0.3879472407519709, 'f1-score': 0.45106844292456777, 'support': 131920}, 'accuracy': 0.47225848661026276, 'macro avg': {'precision': 0.473760918283344, 'recall': 0.4838058427971541, 'f1-score': 0.46931272212306596, 'support': 336265}, 'weighted avg': {'precision': 0.48910795244251903, 'recall': 0.47225848661026276, 'f1-score': 0.47219710480990557, 'support': 336265}}
[[65458 33312 29151]
 [19586 42168 14670]
 [44841 35901 51178]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.953128
{'0': {'precision': 0.5247486088060138, 'recall': 0.5014343354245866, 'f1-score': 0.5128266288208566, 'support': 42877}, '1': {'precision': 0.5583764131985458, 'recall': 0.7674144037780402, 'f1-score': 0.6464158549471236, 'support': 47432}, '2': {'precision': 0.5622644218688301, 'recall': 0.35834725113820953, 'f1-score': 0.43772182321213987, 'support': 43709}, 'accuracy': 0.5489038785834739, 'macro avg': {'precision': 0.5484631479577966, 'recall': 0.5423986634469454, 'f1-score': 0.53232143566004, 'support': 134018}, 'weighted avg': {'precision': 0.5488857597193927, 'recall': 0.5489038785834739, 'f1-score': 0.5356119876925731, 'support': 134018}}
[[21500 13531  7846]
 [ 6684 36400  4348]
 [12788 15258 15663]]
Evaluating performance on  val set...
107/107 - 1s - 915ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0483544
{'0': {'precision': 0.5291738295075337, 'recall': 0.5071719325450669, 'f1-score': 0.517939327955659, 'support': 10318}, '1': {'precision': 0.3958624825104937, 'recall': 0.608355091383812, 'f1-score': 0.47962705091723684, 'support': 6511}, '2': {'precision': 0.5491408934707904, 'recall': 0.3863262740547336, 'f1-score': 0.4535649409627612, 'support': 10341}, 'accuracy': 0.4854251012145749, 'macro avg': {'precision': 0.4913924018296059, 'recall': 0.5006177659945376, 'f1-score': 0.483710439945219, 'support': 27170}, 'weighted avg': {'precision': 0.5048267271205742, 'recall': 0.4854251012145749, 'f1-score': 0.4842570765132327, 'support': 27170}}
[[5233 2921 2164]
 [1434 3961 1116]
 [3222 3124 3995]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.204153
{'0': {'precision': 0.38343126481459616, 'recall': 0.3643770119704149, 'f1-score': 0.37366138596335957, 'support': 115869}, '1': {'precision': 0.3315391221939229, 'recall': 0.4190475299226083, 'f1-score': 0.37019216858256554, 'support': 106859}, '2': {'precision': 0.35273129643429757, 'recall': 0.2814084836910992, 'f1-score': 0.3130589891722075, 'support': 111013}, 'accuracy': 0.3542837110214208, 'macro avg': {'precision': 0.35590056114760554, 'recall': 0.3549443418613742, 'f1-score': 0.3523041812393775, 'support': 333741}, 'weighted avg': {'precision': 0.35660435994493794, 'recall': 0.3542837110214208, 'f1-score': 0.3523922851484449, 'support': 333741}}
[[42220 46383 27266]
 [32020 44779 30060]
 [35871 43902 31240]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2003913
{'0': {'precision': 0.3783638928067701, 'recall': 0.39757536236179863, 'f1-score': 0.38773179932646307, 'support': 33737}, '1': {'precision': 0.3570566631689402, 'recall': 0.41662075298438933, 'f1-score': 0.3845458398078825, 'support': 32670}, '2': {'precision': 0.3727913762360188, 'recall': 0.2889223907786049, 'f1-score': 0.3255418915332213, 'support': 31839}, 'accuracy': 0.3686969444048613, 'macro avg': {'precision': 0.36940397740390973, 'recall': 0.3677061687082643, 'f1-score': 0.3659398435558556, 'support': 98246}, 'weighted avg': {'precision': 0.36947263466532865, 'recall': 0.3686969444048613, 'f1-score': 0.36651821534644297, 'support': 98246}}
[[13413 12885  7439]
 [11021 13611  8038]
 [11016 11624  9199]]
Evaluating performance on  val set...
93/93 - 1s - 840ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2262065
{'0': {'precision': 0.384271299282222, 'recall': 0.45453426848775685, 'f1-score': 0.4164599774520857, 'support': 8127}, '1': {'precision': 0.3072297389640563, 'recall': 0.3010983123493169, 'f1-score': 0.30413312588784414, 'support': 7466}, '2': {'precision': 0.36559784237338927, 'recall': 0.30458120084883283, 'f1-score': 0.33231188287368063, 'support': 8011}, 'accuracy': 0.35510930350788, 'macro avg': {'precision': 0.3523662935398892, 'recall': 0.35340459389530215, 'f1-score': 0.35096832873787015, 'support': 23604}, 'weighted avg': {'precision': 0.35356525994007304, 'recall': 0.35510930350788, 'f1-score': 0.352371574662464, 'support': 23604}}
[[3694 2494 1939]
 [2923 2248 2295]
 [2996 2575 2440]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0395902
{'0': {'precision': 0.5057875101737174, 'recall': 0.5409350506124699, 'f1-score': 0.5227711767471162, 'support': 253890}, '1': {'precision': 0.41356710860341, 'recall': 0.5479787915021076, 'f1-score': 0.4713784424698772, 'support': 165594}, '2': {'precision': 0.5486828527040359, 'recall': 0.39046838936681894, 'f1-score': 0.45624879182638134, 'support': 247828}, 'accuracy': 0.48680227539741533, 'macro avg': {'precision': 0.48934582382705444, 'recall': 0.4931274104937988, 'f1-score': 0.48346613701445823, 'support': 667312}, 'weighted avg': {'precision': 0.49883352428850974, 'recall': 0.48680227539741533, 'f1-score': 0.48531277940068607, 'support': 667312}}
[[137338  64782  51770]
 [ 47025  90742  27827]
 [ 87170  63889  96769]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0109828
{'0': {'precision': 0.49612794347270633, 'recall': 0.5069133335482, 'f1-score': 0.5014626525423055, 'support': 62054}, '1': {'precision': 0.5133088875405598, 'recall': 0.6433247371553263, 'f1-score': 0.5710093466171703, 'support': 60492}, '2': {'precision': 0.5351604601544113, 'recall': 0.3915730517912898, 'f1-score': 0.45224309227952453, 'support': 62134}, 'accuracy': 0.5127896902750704, 'macro avg': {'precision': 0.5148657637225592, 'recall': 0.5139370408316054, 'f1-score': 0.5082383638130001, 'support': 184680}, 'weighted avg': {'precision': 0.514887722875206, 'recall': 0.5127896902750704, 'f1-score': 0.5076831986794568, 'support': 184680}}
[[31456 18535 12063]
 [12506 38916  9070]
 [19441 18363 24330]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0255092
{'0': {'precision': 0.5177191458228543, 'recall': 0.5319488817891374, 'f1-score': 0.5247375616990707, 'support': 21284}, '1': {'precision': 0.4433760151462309, 'recall': 0.5673935220606988, 'f1-score': 0.4977765347503845, 'support': 15684}, '2': {'precision': 0.5397080653142009, 'recall': 0.4127719962157048, 'f1-score': 0.4677817090168328, 'support': 21140}, 'accuracy': 0.4981586012253046, 'macro avg': {'precision': 0.5002677420944287, 'recall': 0.5040381333551803, 'f1-score': 0.4967652684887627, 'support': 58108}, 'weighted avg': {'precision': 0.5056527882905851, 'recall': 0.4981586012253046, 'f1-score': 0.4967396358994269, 'support': 58108}}
[[11322  5453  4509]
 [ 3852  8899  2933]
 [ 6695  5719  8726]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/EXC
Evaluating performance on  test set...
5343/5343 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.58058774
{'0': {'precision': 0.6291582723207705, 'recall': 0.40892976909073486, 'f1-score': 0.4956834810886144, 'support': 219177}, '1': {'precision': 0.7872710421806232, 'recall': 0.948347798322881, 'f1-score': 0.8603349331224853, 'support': 927066}, '2': {'precision': 0.6842623886837282, 'recall': 0.3353795600010833, 'f1-score': 0.4501337339799414, 'support': 221546}, 'accuracy': 0.7626256681403345, 'macro avg': {'precision': 0.700230567728374, 'recall': 0.5642190424715664, 'f1-score': 0.6020507160636804, 'support': 1367789}, 'weighted avg': {'precision': 0.7452500596261532, 'recall': 0.7626256681403345, 'f1-score': 0.7354606680365241, 'support': 1367789}}
[[ 89628 114723  14826]
 [ 28426 879181  19459]
 [ 24403 122841  74302]]
Evaluating performance on  train set...
1290/1290 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54183894
{'0': {'precision': 0.5705818808209979, 'recall': 0.4361205953895249, 'f1-score': 0.49437150590675677, 'support': 44811}, '1': {'precision': 0.828714562559981, 'recall': 0.9350700933602586, 'f1-score': 0.8786857293275029, 'support': 239181}, '2': {'precision': 0.6478175745710008, 'recall': 0.36537836960051967, 'f1-score': 0.4672314976326938, 'support': 46185}, 'accuracy': 0.7876654037077083, 'macro avg': {'precision': 0.6823713393173265, 'recall': 0.5788563527834344, 'f1-score': 0.6134295776223179, 'support': 330177}, 'weighted avg': {'precision': 0.768377497919874, 'recall': 0.7876654037077083, 'f1-score': 0.7689733073340514, 'support': 330177}}
[[ 19543  22071   3197]
 [  9553 223651   5977]
 [  5155  24155  16875]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54249996
{'0': {'precision': 0.5936954751657555, 'recall': 0.40097415350773824, 'f1-score': 0.47866454093594674, 'support': 12729}, '1': {'precision': 0.824681279789199, 'recall': 0.9454884712781554, 'f1-score': 0.880962565369172, 'support': 67527}, '2': {'precision': 0.6391329818394845, 'recall': 0.3466793771846203, 'f1-score': 0.4495261639884631, 'support': 12588}, 'accuracy': 0.7896471500581621, 'macro avg': {'precision': 0.6858365789314796, 'recall': 0.5643806673235047, 'f1-score': 0.6030510900978606, 'support': 92844}, 'weighted avg': {'precision': 0.76785584915671, 'recall': 0.7896471500581621, 'f1-score': 0.7673120012660433, 'support': 92844}}
[[ 5104  6705   920]
 [ 2137 63846  1544]
 [ 1356  6868  4364]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/AAL
Evaluating performance on  test set...
7177/7177 - 68s - 68s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60261256
{'0': {'precision': 0.6154373730057496, 'recall': 0.33823700368832105, 'f1-score': 0.43655087751204874, 'support': 283869}, '1': {'precision': 0.7839640811909379, 'recall': 0.9562248768790287, 'f1-score': 0.8615684561587075, 'support': 1272732}, '2': {'precision': 0.6666433544697252, 'recall': 0.30585622201306295, 'f1-score': 0.41932566914970576, 'support': 280488}, 'accuracy': 0.7614339860507575, 'macro avg': {'precision': 0.6886816028888042, 'recall': 0.5334393675268042, 'f1-score': 0.5724816676068206, 'support': 1837089}, 'weighted avg': {'precision': 0.7400105415843099, 'recall': 0.7614339860507575, 'f1-score': 0.728372345422957, 'support': 1837089}}
[[  96015  169885   17969]
 [  30784 1217018   24930]
 [  29212  165487   85789]]
Evaluating performance on  train set...
2257/2257 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6178175
{'0': {'precision': 0.567084973224079, 'recall': 0.3855187841305349, 'f1-score': 0.458998629153339, 'support': 91194}, '1': {'precision': 0.7913003921166611, 'recall': 0.9350550041262559, 'f1-score': 0.8571924332915738, 'support': 396243}, '2': {'precision': 0.6133766974298325, 'recall': 0.32221704497548204, 'f1-score': 0.4224919811766759, 'support': 90138}, 'accuracy': 0.7526468424014198, 'macro avg': {'precision': 0.6572540209235241, 'recall': 0.5475969444107576, 'f1-score': 0.5795610145405296, 'support': 577575}, 'weighted avg': {'precision': 0.7281314756951203, 'recall': 0.7526468424014198, 'f1-score': 0.7264805514973222, 'support': 577575}}
[[ 35157  48762   7275]
 [ 14702 370509  11032]
 [ 12137  48957  29044]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5862938
{'0': {'precision': 0.6156997489097397, 'recall': 0.3841682127396413, 'f1-score': 0.4731270151565158, 'support': 24255}, '1': {'precision': 0.8031010951110588, 'recall': 0.9499799501368621, 'f1-score': 0.8703875275550301, 'support': 114714}, '2': {'precision': 0.62712, 'recall': 0.3218112401986945, 'f1-score': 0.4253506606256274, 'support': 24359}, 'accuracy': 0.7722680740595611, 'macro avg': {'precision': 0.6819736146735994, 'recall': 0.5519864676917327, 'f1-score': 0.5896217344457244, 'support': 163328}, 'weighted avg': {'precision': 0.7490249835568654, 'recall': 0.7722680740595611, 'f1-score': 0.745018902642221, 'support': 163328}}
[[  9318  12997   1940]
 [  3017 108976   2721]
 [  2799  13721   7839]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/WBA
Evaluating performance on  test set...
5696/5696 - 50s - 50s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96735907
{'0': {'precision': 0.5075876216904324, 'recall': 0.3850350596059615, 'f1-score': 0.4378984183753419, 'support': 431836}, '1': {'precision': 0.5519995531724754, 'recall': 0.7642194695390508, 'f1-score': 0.6410009252749088, 'support': 607811}, '2': {'precision': 0.5394046988714818, 'recall': 0.372553940584688, 'f1-score': 0.44071592162185086, 'support': 418377}, 'accuracy': 0.5395254124760634, 'macro avg': {'precision': 0.5329972912447966, 'recall': 0.5072694899099001, 'f1-score': 0.5065384217573672, 'support': 1458024}, 'weighted avg': {'precision': 0.5352316068277196, 'recall': 0.5395254124760634, 'f1-score': 0.5233748689529025, 'support': 1458024}}
[[166272 199762  65802]
 [ 76017 464501  67293]
 [ 85284 177225 155868]]
Evaluating performance on  train set...
2222/2222 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8182757
{'0': {'precision': 0.5601352308844667, 'recall': 0.404298844192469, 'f1-score': 0.4696267630734763, 'support': 136874}, '1': {'precision': 0.6635072928519706, 'recall': 0.8639657599288798, 'f1-score': 0.7505829074281569, 'support': 296962}, '2': {'precision': 0.5642552167899453, 'recall': 0.34807802170896923, 'f1-score': 0.43055504570316805, 'support': 134783}, 'accuracy': 0.6310341370935547, 'macro avg': {'precision': 0.5959659135087941, 'recall': 0.5387808752767727, 'f1-score': 0.5502549054016005, 'support': 568619}, 'weighted avg': {'precision': 0.6150980061809165, 'recall': 0.6310341370935547, 'f1-score': 0.6070950771071832, 'support': 568619}}
[[ 55338  64183  17353]
 [ 21520 256565  18877]
 [ 21936  65932  46915]]
Evaluating performance on  val set...
641/641 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8459674
{'0': {'precision': 0.5219992280972597, 'recall': 0.4119812158903414, 'f1-score': 0.4605104487352278, 'support': 39395}, '1': {'precision': 0.6702958979067893, 'recall': 0.8278328087391223, 'f1-score': 0.7407813940002691, 'support': 86416}, '2': {'precision': 0.5217641861001191, 'recall': 0.3570564728152277, 'f1-score': 0.42397564973074225, 'support': 38036}, 'accuracy': 0.6185587773959853, 'macro avg': {'precision': 0.5713531040347227, 'recall': 0.5322901658148972, 'f1-score': 0.5417558308220797, 'support': 163847}, 'weighted avg': {'precision': 0.6001591270325901, 'recall': 0.6185587773959853, 'f1-score': 0.5998493221420597, 'support': 163847}}
[[16230 17664  5501]
 [ 7931 71538  6947]
 [ 6931 17524 13581]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 104s - 104s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7722535
{'0': {'precision': 0.6032705407494643, 'recall': 0.33647923861665047, 'f1-score': 0.432004383907715, 'support': 691163}, '1': {'precision': 0.6758119277658245, 'recall': 0.9171694629685188, 'f1-score': 0.7782062822101964, 'support': 1709937}, '2': {'precision': 0.6154561678089261, 'recall': 0.34249471458773784, 'f1-score': 0.44008620568856655, 'support': 687742}, 'accuracy': 0.6592800797191958, 'macro avg': {'precision': 0.6315128787747383, 'recall': 0.532047805390969, 'f1-score': 0.5500989572688261, 'support': 3088842}, 'weighted avg': {'precision': 0.6461415484655348, 'recall': 0.6592800797191958, 'f1-score': 0.6254560540329129, 'support': 3088842}}
[[ 232562  386311   72290]
 [  66752 1568302   74883]
 [  86188  366006  235548]]
Evaluating performance on  train set...
2948/2948 - 26s - 26s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7888689
{'0': {'precision': 0.5720763659364448, 'recall': 0.3767380463479026, 'f1-score': 0.45429944923752824, 'support': 170450}, '1': {'precision': 0.6818078936725206, 'recall': 0.8841499501994428, 'f1-score': 0.7699063133725509, 'support': 415658}, '2': {'precision': 0.587750317286546, 'recall': 0.360310974378467, 'f1-score': 0.4467493639379513, 'support': 168374}, 'accuracy': 0.6526146415686525, 'macro avg': {'precision': 0.6138781922985038, 'recall': 0.5403996569752708, 'f1-score': 0.5569850421826769, 'support': 754482}, 'weighted avg': {'precision': 0.6360273591216286, 'recall': 0.6526146415686525, 'f1-score': 0.6264881560196706, 'support': 754482}}
[[ 64215  87724  18511]
 [ 24113 367504  24041]
 [ 23921  83786  60667]]
Evaluating performance on  val set...
697/697 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.718944
{'0': {'precision': 0.5971971546873341, 'recall': 0.3254643291095296, 'f1-score': 0.4213167552992285, 'support': 34566}, '1': {'precision': 0.7246330134054781, 'recall': 0.9200159931665561, 'f1-score': 0.8107188328275267, 'support': 110047}, '2': {'precision': 0.5861008920022174, 'recall': 0.3442152307100364, 'f1-score': 0.4337124743613649, 'support': 33787}, 'accuracy': 0.695767937219731, 'macro avg': {'precision': 0.6359770200316767, 'recall': 0.5298985176620407, 'f1-score': 0.5552493541627067, 'support': 178400}, 'weighted avg': {'precision': 0.6737051396481725, 'recall': 0.695767937219731, 'f1-score': 0.6638691352639653, 'support': 178400}}
[[ 11250  20007   3309]
 [  3898 101245   4904]
 [  3690  18467  11630]]
testing model on single stock: results/universal/W1/deepVOL_L2/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 187s - 187s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0385453
{'0': {'precision': 0.5040927124289355, 'recall': 0.5352995022733592, 'f1-score': 0.5192276298512111, 'support': 2118231}, '1': {'precision': 0.35938782531237556, 'recall': 0.41772005930026024, 'f1-score': 0.38636463912886176, 'support': 1205391}, '2': {'precision': 0.5227476367361212, 'recall': 0.4430202628121507, 'f1-score': 0.47959306893424375, 'support': 2142595}, 'accuracy': 0.47320056997371307, 'macro avg': {'precision': 0.4620760581591441, 'recall': 0.46534660812859, 'f1-score': 0.46172844597143886, 'support': 5466217}, 'weighted avg': {'precision': 0.4794950755183696, 'recall': 0.47320056997371307, 'f1-score': 0.4743935763736976, 'support': 5466217}}
[[1133888  446355  537988]
 [ 373261  503516  328614]
 [ 742215  451167  949213]]
Evaluating performance on  train set...
6073/6073 - 48s - 48s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.003204
{'0': {'precision': 0.496790854885876, 'recall': 0.42534304480717955, 'f1-score': 0.45829902776561277, 'support': 492064}, '1': {'precision': 0.5037959173867431, 'recall': 0.6652537593322383, 'f1-score': 0.5733753400768942, 'support': 567388}, '2': {'precision': 0.5096294058828431, 'recall': 0.39530036234957644, 'f1-score': 0.44524270475263156, 'support': 495102}, 'accuracy': 0.5033385781388102, 'macro avg': {'precision': 0.5034053927184874, 'recall': 0.4952990554963314, 'f1-score': 0.4923056908650461, 'support': 1554554}, 'weighted avg': {'precision': 0.5034364784396042, 'recall': 0.5033385781388102, 'f1-score': 0.4961418476697784, 'support': 1554554}}
[[209296 187559  95209]
 [ 96822 377457  93109]
 [115178 184210 195714]]
Evaluating performance on  val set...
1786/1786 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0298944
{'0': {'precision': 0.49738129694714356, 'recall': 0.46495522772659925, 'f1-score': 0.4806219617766532, 'support': 155230}, '1': {'precision': 0.4555378150328754, 'recall': 0.5658164740879481, 'f1-score': 0.5047235872235872, 'support': 145222}, '2': {'precision': 0.5060172354884022, 'recall': 0.425191877045572, 'f1-score': 0.4620968916192286, 'support': 156741}, 'accuracy': 0.48336041890405146, 'macro avg': {'precision': 0.48631211582280703, 'recall': 0.48532119295337317, 'f1-score': 0.48248081353982303, 'support': 457193}, 'weighted avg': {'precision': 0.4870508927466014, 'recall': 0.48336041890405146, 'f1-score': 0.4819265491809, 'support': 457193}}
[[72175 49158 33897]
 [31890 82169 31163]
 [41045 49051 66645]]
training model: results/universal/W1/deepVOL_L2/h30
Epoch 1/50
10622/10622 - 344s - loss: 2.8899 - accuracy30: 0.5167 - val_loss: 3.1807 - val_accuracy30: 0.5082 - 344s/epoch - 32ms/step
Epoch 2/50
10622/10622 - 325s - loss: 2.8097 - accuracy30: 0.5390 - val_loss: 3.1892 - val_accuracy30: 0.5011 - 325s/epoch - 31ms/step
Epoch 3/50
10622/10622 - 332s - loss: 2.7792 - accuracy30: 0.5450 - val_loss: 3.1609 - val_accuracy30: 0.5040 - 332s/epoch - 31ms/step
Epoch 4/50
10622/10622 - 330s - loss: 2.7598 - accuracy30: 0.5491 - val_loss: 3.1292 - val_accuracy30: 0.5059 - 330s/epoch - 31ms/step
Epoch 5/50
10622/10622 - 334s - loss: 2.7467 - accuracy30: 0.5519 - val_loss: 3.1072 - val_accuracy30: 0.5061 - 334s/epoch - 31ms/step
Epoch 6/50
10622/10622 - 338s - loss: 2.7373 - accuracy30: 0.5538 - val_loss: 3.0953 - val_accuracy30: 0.5056 - 338s/epoch - 32ms/step
Epoch 7/50
10622/10622 - 332s - loss: 2.7303 - accuracy30: 0.5552 - val_loss: 3.0828 - val_accuracy30: 0.5077 - 332s/epoch - 31ms/step
Epoch 8/50
10622/10622 - 336s - loss: 2.7239 - accuracy30: 0.5565 - val_loss: 3.0569 - val_accuracy30: 0.5118 - 336s/epoch - 32ms/step
Epoch 9/50
10622/10622 - 334s - loss: 2.7188 - accuracy30: 0.5575 - val_loss: 3.0647 - val_accuracy30: 0.5102 - 334s/epoch - 31ms/step
Epoch 10/50
10622/10622 - 335s - loss: 2.7154 - accuracy30: 0.5583 - val_loss: 3.0455 - val_accuracy30: 0.5122 - 335s/epoch - 32ms/step
Epoch 11/50
10622/10622 - 337s - loss: 2.7114 - accuracy30: 0.5591 - val_loss: 3.0279 - val_accuracy30: 0.5153 - 337s/epoch - 32ms/step
Epoch 12/50
10622/10622 - 333s - loss: 2.7081 - accuracy30: 0.5599 - val_loss: 3.0272 - val_accuracy30: 0.5148 - 333s/epoch - 31ms/step
Epoch 13/50
10622/10622 - 335s - loss: 2.7046 - accuracy30: 0.5605 - val_loss: 3.0216 - val_accuracy30: 0.5164 - 335s/epoch - 31ms/step
Epoch 14/50
10622/10622 - 338s - loss: 2.7018 - accuracy30: 0.5613 - val_loss: 3.0190 - val_accuracy30: 0.5166 - 338s/epoch - 32ms/step
Epoch 15/50
10622/10622 - 338s - loss: 2.6991 - accuracy30: 0.5620 - val_loss: 3.0134 - val_accuracy30: 0.5175 - 338s/epoch - 32ms/step
Epoch 16/50
10622/10622 - 338s - loss: 2.6968 - accuracy30: 0.5625 - val_loss: 3.0102 - val_accuracy30: 0.5185 - 338s/epoch - 32ms/step
Epoch 17/50
10622/10622 - 338s - loss: 2.6942 - accuracy30: 0.5630 - val_loss: 3.0073 - val_accuracy30: 0.5196 - 338s/epoch - 32ms/step
Epoch 18/50
10622/10622 - 339s - loss: 2.6924 - accuracy30: 0.5632 - val_loss: 3.0046 - val_accuracy30: 0.5195 - 339s/epoch - 32ms/step
Epoch 19/50
10622/10622 - 337s - loss: 2.6902 - accuracy30: 0.5637 - val_loss: 2.9976 - val_accuracy30: 0.5203 - 337s/epoch - 32ms/step
Epoch 20/50
10622/10622 - 338s - loss: 2.6881 - accuracy30: 0.5642 - val_loss: 3.0086 - val_accuracy30: 0.5202 - 338s/epoch - 32ms/step
Epoch 21/50
10622/10622 - 337s - loss: 2.6866 - accuracy30: 0.5645 - val_loss: 2.9961 - val_accuracy30: 0.5205 - 337s/epoch - 32ms/step
Epoch 22/50
10622/10622 - 336s - loss: 2.6848 - accuracy30: 0.5648 - val_loss: 3.0055 - val_accuracy30: 0.5206 - 336s/epoch - 32ms/step
Epoch 23/50
10622/10622 - 335s - loss: 2.6829 - accuracy30: 0.5652 - val_loss: 2.9990 - val_accuracy30: 0.5208 - 335s/epoch - 32ms/step
Epoch 24/50
10622/10622 - 339s - loss: 2.6815 - accuracy30: 0.5656 - val_loss: 2.9957 - val_accuracy30: 0.5220 - 339s/epoch - 32ms/step
Epoch 25/50
10622/10622 - 338s - loss: 2.6801 - accuracy30: 0.5660 - val_loss: 2.9947 - val_accuracy30: 0.5225 - 338s/epoch - 32ms/step
Epoch 26/50
10622/10622 - 339s - loss: 2.6788 - accuracy30: 0.5661 - val_loss: 2.9947 - val_accuracy30: 0.5225 - 339s/epoch - 32ms/step
Epoch 27/50
10622/10622 - 337s - loss: 2.6774 - accuracy30: 0.5664 - val_loss: 3.0041 - val_accuracy30: 0.5222 - 337s/epoch - 32ms/step
Epoch 28/50
10622/10622 - 338s - loss: 2.6758 - accuracy30: 0.5668 - val_loss: 2.9922 - val_accuracy30: 0.5221 - 338s/epoch - 32ms/step
Epoch 29/50
10622/10622 - 338s - loss: 2.6744 - accuracy30: 0.5669 - val_loss: 2.9903 - val_accuracy30: 0.5245 - 338s/epoch - 32ms/step
Epoch 30/50
10622/10622 - 338s - loss: 2.6732 - accuracy30: 0.5672 - val_loss: 2.9800 - val_accuracy30: 0.5238 - 338s/epoch - 32ms/step
Epoch 31/50
10622/10622 - 335s - loss: 2.6718 - accuracy30: 0.5675 - val_loss: 2.9942 - val_accuracy30: 0.5230 - 335s/epoch - 31ms/step
Epoch 32/50
10622/10622 - 339s - loss: 2.6709 - accuracy30: 0.5678 - val_loss: 2.9741 - val_accuracy30: 0.5254 - 339s/epoch - 32ms/step
Epoch 33/50
10622/10622 - 339s - loss: 2.6701 - accuracy30: 0.5678 - val_loss: 2.9821 - val_accuracy30: 0.5243 - 339s/epoch - 32ms/step
Epoch 34/50
10622/10622 - 341s - loss: 2.6686 - accuracy30: 0.5682 - val_loss: 2.9892 - val_accuracy30: 0.5237 - 341s/epoch - 32ms/step
Epoch 35/50
10622/10622 - 340s - loss: 2.6675 - accuracy30: 0.5683 - val_loss: 2.9807 - val_accuracy30: 0.5238 - 340s/epoch - 32ms/step
Epoch 36/50
10622/10622 - 342s - loss: 2.6663 - accuracy30: 0.5687 - val_loss: 2.9797 - val_accuracy30: 0.5244 - 342s/epoch - 32ms/step
Epoch 37/50
10622/10622 - 337s - loss: 2.6651 - accuracy30: 0.5688 - val_loss: 2.9835 - val_accuracy30: 0.5246 - 337s/epoch - 32ms/step
Epoch 38/50
10622/10622 - 343s - loss: 2.6639 - accuracy30: 0.5693 - val_loss: 2.9953 - val_accuracy30: 0.5238 - 343s/epoch - 32ms/step
Epoch 39/50
10622/10622 - 339s - loss: 2.6631 - accuracy30: 0.5692 - val_loss: 2.9802 - val_accuracy30: 0.5248 - 339s/epoch - 32ms/step
Epoch 40/50
10622/10622 - 343s - loss: 2.6625 - accuracy30: 0.5695 - val_loss: 2.9926 - val_accuracy30: 0.5242 - 343s/epoch - 32ms/step
Epoch 41/50
10622/10622 - 334s - loss: 2.6611 - accuracy30: 0.5700 - val_loss: 2.9843 - val_accuracy30: 0.5249 - 334s/epoch - 31ms/step
Epoch 42/50
10622/10622 - 338s - loss: 2.6601 - accuracy30: 0.5700 - val_loss: 2.9838 - val_accuracy30: 0.5241 - 338s/epoch - 32ms/step
testing model in sample: results/universal/W1/deepVOL_L2/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 551s - 551s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9831738
{'0': {'precision': 0.4970932694664757, 'recall': 0.4315052964530315, 'f1-score': 0.4619830063888585, 'support': 3087538}, '1': {'precision': 0.5199656994823831, 'recall': 0.6527732375173817, 'f1-score': 0.578849533072463, 'support': 2869390}, '2': {'precision': 0.4984104727920982, 'recall': 0.4459040608080708, 'f1-score': 0.4706975183786948, 'support': 3089853}, 'accuracy': 0.5066031774174704, 'macro avg': {'precision': 0.505156480580319, 'recall': 0.5100608649261613, 'f1-score': 0.5038433526133387, 'support': 9046781}, 'weighted avg': {'precision': 0.5047976547733191, 'recall': 0.5066031774174704, 'f1-score': 0.5020262222040749, 'support': 9046781}}
[[1332289  893084  862165]
 [ 471928 1873061  524401]
 [ 875942  836133 1377778]]
Evaluating performance on  train set...
10622/10622 - 171s - 171s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94680053
{'0': {'precision': 0.4986956668466523, 'recall': 0.3726027362719933, 'f1-score': 0.4265252165479898, 'support': 793196}, '1': {'precision': 0.5693572971255298, 'recall': 0.7477272767461641, 'f1-score': 0.6464641522962695, 'support': 1131022}, '2': {'precision': 0.49059673204042953, 'recall': 0.3956182581808293, 'f1-score': 0.4380179228306308, 'support': 794296}, 'accuracy': 0.5353958081510708, 'macro avg': {'precision': 0.5195498986708705, 'recall': 0.5053160903996622, 'f1-score': 0.5036690972249634, 'support': 2718514}, 'weighted avg': {'precision': 0.5257276802482508, 'recall': 0.5353958081510708, 'f1-score': 0.5213874779221698, 'support': 2718514}}
[[295547 326831 170818]
 [129860 845696 155466]
 [167233 312825 314238]]
Evaluating performance on  val set...
3064/3064 - 49s - 49s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9642532
{'0': {'precision': 0.4940069636309481, 'recall': 0.4032682012735756, 'f1-score': 0.444049512194559, 'support': 238541}, '1': {'precision': 0.5625305540820253, 'recall': 0.7032642300077696, 'f1-score': 0.6250738618058254, 'support': 307607}, '2': {'precision': 0.4878672587144478, 'recall': 0.4198249379287127, 'f1-score': 0.4512958079064865, 'support': 237630}, 'accuracy': 0.526026502402466, 'macro avg': {'precision': 0.5148015921424737, 'recall': 0.508785789736686, 'f1-score': 0.506806393968957, 'support': 783778}, 'weighted avg': {'precision': 0.5190387430488145, 'recall': 0.526026502402466, 'f1-score': 0.5172925661727238, 'support': 783778}}
[[ 96196  86361  55984]
 [ 42537 216329  48741]
 [ 55993  81874  99763]]
testing model out of sample: results/universal/W1/deepVOL_L2/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 381s - 381s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86376005
{'0': {'precision': 0.5401084277969443, 'recall': 0.34376580209720103, 'f1-score': 0.420129472319407, 'support': 1593934}, '1': {'precision': 0.6191545750400057, 'recall': 0.8832274724609549, 'f1-score': 0.7279830470350069, 'support': 2924121}, '2': {'precision': 0.5615428154158926, 'recall': 0.3244018085673574, 'f1-score': 0.411234517322079, 'support': 1581141}, 'accuracy': 0.5973785725200502, 'macro avg': {'precision': 0.5736019394176142, 'recall': 0.5171316943751711, 'f1-score': 0.519782345558831, 'support': 6099196}, 'weighted avg': {'precision': 0.5835619072714094, 'recall': 0.5973785725200502, 'f1-score': 0.5654169700013186, 'support': 6099196}}
[[ 547940  813104  232890]
 [ 173851 2582664  167606]
 [ 292709  775507  512925]]
Evaluating performance on  train set...
6711/6711 - 117s - 117s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8604759
{'0': {'precision': 0.5324558353615126, 'recall': 0.3686452432317184, 'f1-score': 0.4356610276028741, 'support': 436189}, '1': {'precision': 0.6376452086079479, 'recall': 0.8610426056637469, 'f1-score': 0.7326938761767451, 'support': 846648}, '2': {'precision': 0.5413287551376033, 'recall': 0.33893900437573804, 'f1-score': 0.416867316389579, 'support': 434441}, 'accuracy': 0.6038905756668402, 'macro avg': {'precision': 0.5704765997023546, 'recall': 0.5228756177570678, 'f1-score': 0.5284074067230661, 'support': 1717278}, 'weighted avg': {'precision': 0.5865607226428919, 'recall': 0.6038905756668402, 'f1-score': 0.5773489246621478, 'support': 1717278}}
[[160799 209536  65854]
 [ 58737 729000  58911]
 [ 82459 204733 147249]]
Evaluating performance on  val set...
1720/1720 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8251828
{'0': {'precision': 0.5384668950725606, 'recall': 0.3646730364739061, 'f1-score': 0.43484813550553075, 'support': 106021}, '1': {'precision': 0.666229633485087, 'recall': 0.8827288202173629, 'f1-score': 0.7593490928751653, 'support': 229110}, '2': {'precision': 0.5369597915923646, 'recall': 0.3306659536678062, 'f1-score': 0.40928781225806843, 'support': 104722}, 'accuracy': 0.6264206450791514, 'macro avg': {'precision': 0.5805521067166707, 'recall': 0.5260226034530251, 'f1-score': 0.5344950135462548, 'support': 439853}, 'weighted avg': {'precision': 0.6046569497204562, 'recall': 0.6264206450791514, 'f1-score': 0.597788222697925, 'support': 439853}}
[[ 38663  51313  16045]
 [ 13052 202242  13816]
 [ 20087  50007  34628]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/LILAK
Evaluating performance on  test set...
663/663 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1349999
{'0': {'precision': 0.44021361748330323, 'recall': 0.535105354429797, 'f1-score': 0.48304333370275965, 'support': 65161}, '1': {'precision': 0.39250542480387246, 'recall': 0.11844259198629964, 'f1-score': 0.1819729536264969, 'support': 39707}, '2': {'precision': 0.4474451903845909, 'recall': 0.541869793273681, 'f1-score': 0.4901513407154669, 'support': 64820}, 'accuracy': 0.44019023148366415, 'macro avg': {'precision': 0.42672141089058885, 'recall': 0.3984725798965926, 'f1-score': 0.3850558760149078, 'support': 169688}, 'weighted avg': {'precision': 0.431812324220016, 'recall': 0.44019023148366415, 'f1-score': 0.415308075068534, 'support': 169688}}
[[34868  3990 26303]
 [17932  4703 17072]
 [26407  3289 35124]]
Evaluating performance on  train set...
260/260 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2547437
{'0': {'precision': 0.3848358208955224, 'recall': 0.4422742658494191, 'f1-score': 0.4115606444335667, 'support': 21862}, '1': {'precision': 0.41390431822254076, 'recall': 0.10679611650485436, 'f1-score': 0.1697842784168167, 'support': 21630}, '2': {'precision': 0.38883770276684254, 'recall': 0.604706699665668, 'f1-score': 0.473321098423056, 'support': 23031}, 'accuracy': 0.3894292199690333, 'macro avg': {'precision': 0.3958592806283019, 'recall': 0.38459236067331376, 'f1-score': 0.3515553404244798, 'support': 66523}, 'weighted avg': {'precision': 0.39567295900657845, 'recall': 0.3894292199690333, 'f1-score': 0.3543290436171517, 'support': 66523}}
[[ 9669  1661 10532]
 [ 7962  2310 11358]
 [ 7494  1610 13927]]
Evaluating performance on  val set...
51/51 - 1s - 529ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2447789
{'0': {'precision': 0.3901363271852446, 'recall': 0.4488007380073801, 'f1-score': 0.4174174174174174, 'support': 4336}, '1': {'precision': 0.4784075573549258, 'recall': 0.16404442387783433, 'f1-score': 0.2443142660234321, 'support': 4322}, '2': {'precision': 0.36584600909518583, 'recall': 0.5569348293148723, 'f1-score': 0.44160514858981637, 'support': 4189}, 'accuracy': 0.38826185101580135, 'macro avg': {'precision': 0.41146329787845204, 'recall': 0.3899266637333622, 'f1-score': 0.36777894401022193, 'support': 12847}, 'weighted avg': {'precision': 0.41191231491110325, 'recall': 0.38826185101580135, 'f1-score': 0.3670687434512288, 'support': 12847}}
[[1946  419 1971]
 [1540  709 2073]
 [1502  354 2333]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.5929815
{'0': {'precision': 0.5433295324971493, 'recall': 0.3538679161877818, 'f1-score': 0.4285943740697512, 'support': 56555}, '1': {'precision': 0.8168646849173411, 'recall': 0.9563600225305425, 'f1-score': 0.8811254717923711, 'support': 308914}, '2': {'precision': 0.6817717357501444, 'recall': 0.276300390702364, 'f1-score': 0.3932351057014734, 'support': 55541}, 'accuracy': 0.7857105531935108, 'macro avg': {'precision': 0.6806553177215449, 'recall': 0.5288427764735627, 'f1-score': 0.5676516505211986, 'support': 421010}, 'weighted avg': {'precision': 0.7622983372419433, 'recall': 0.7857105531935108, 'f1-score': 0.7559721142598723, 'support': 421010}}
[[ 20013  33604   2938]
 [  9256 295433   4225]
 [  7565  32630  15346]]
Evaluating performance on  train set...
653/653 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70532787
{'0': {'precision': 0.5869603837271273, 'recall': 0.3994076581341231, 'f1-score': 0.4753529358870605, 'support': 33089}, '1': {'precision': 0.741482791154947, 'recall': 0.9217069925590105, 'f1-score': 0.821830292804668, 'support': 101465}, '2': {'precision': 0.5916826265389877, 'recall': 0.33410579656408357, 'f1-score': 0.4270621457769703, 'support': 32364}, 'accuracy': 0.7042380090823039, 'macro avg': {'precision': 0.6400419338070207, 'recall': 0.551740149085739, 'f1-score': 0.574748458156233, 'support': 166918}, 'weighted avg': {'precision': 0.6818060368983059, 'recall': 0.7042380090823039, 'f1-score': 0.6766041004620139, 'support': 166918}}
[[13216 16404  3469]
 [ 3951 93521  3993]
 [ 5349 16202 10813]]
Evaluating performance on  val set...
181/181 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6698769
{'0': {'precision': 0.6184615384615385, 'recall': 0.3915266617969321, 'f1-score': 0.4794990308632772, 'support': 8214}, '1': {'precision': 0.7648602334797044, 'recall': 0.9456435381355932, 'f1-score': 0.8456983835632661, 'support': 30208}, '2': {'precision': 0.6378941742383752, 'recall': 0.30338078291814946, 'f1-score': 0.41119724375538336, 'support': 7868}, 'accuracy': 0.738150788507237, 'macro avg': {'precision': 0.6737386487265393, 'recall': 0.5468503276168916, 'f1-score': 0.5787982193939755, 'support': 46290}, 'weighted avg': {'precision': 0.7173016282736124, 'recall': 0.738150788507237, 'f1-score': 0.7068645868234491, 'support': 46290}}
[[ 3216  4398   600]
 [  887 28566   755]
 [ 1097  4384  2387]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 12s - 12s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1022279
{'0': {'precision': 0.4865937936075487, 'recall': 0.44480046164125614, 'f1-score': 0.46475945671490226, 'support': 131704}, '1': {'precision': 0.31993092349143776, 'recall': 0.5065710359044837, 'f1-score': 0.39217750784133343, 'support': 69852}, '2': {'precision': 0.509665529918021, 'recall': 0.398288161889703, 'f1-score': 0.44714559546628885, 'support': 134709}, 'accuracy': 0.438999003761914, 'macro avg': {'precision': 0.4387300823390025, 'recall': 0.44988655314514764, 'f1-score': 0.43469418667417487, 'support': 336265}, 'weighted avg': {'precision': 0.461215701101034, 'recall': 0.438999003761914, 'f1-score': 0.44262590154961295, 'support': 336265}}
[[58582 37525 35597]
 [18446 35385 16021]
 [43364 37692 53653]]
Evaluating performance on  train set...
524/524 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9989127
{'0': {'precision': 0.5193323022772118, 'recall': 0.4343830850209653, 'f1-score': 0.4730744006412591, 'support': 44836}, '1': {'precision': 0.5020853384664742, 'recall': 0.7493843487778183, 'f1-score': 0.6013008516827825, 'support': 43856}, '2': {'precision': 0.5333397726906854, 'recall': 0.36546353086528705, 'f1-score': 0.43372389867120503, 'support': 45326}, 'accuracy': 0.5141548150248474, 'macro avg': {'precision': 0.5182524711447906, 'recall': 0.5164103215546901, 'f1-score': 0.5026997169984155, 'support': 134018}, 'weighted avg': {'precision': 0.518425855076667, 'recall': 0.5141548150248474, 'f1-score': 0.5017265099443556, 'support': 134018}}
[[19476 15910  9450]
 [ 5947 32865  5044]
 [12079 16682 16565]]
Evaluating performance on  val set...
107/107 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0830816
{'0': {'precision': 0.5097199341021417, 'recall': 0.43708796383499715, 'f1-score': 0.47061806013283985, 'support': 10618}, '1': {'precision': 0.3374300559552358, 'recall': 0.577561142466222, 'f1-score': 0.4259854935351624, 'support': 5847}, '2': {'precision': 0.5240163832692069, 'recall': 0.3943951424567959, 'f1-score': 0.45005862914401445, 'support': 10705}, 'accuracy': 0.45049687154950313, 'macro avg': {'precision': 0.45705545777552814, 'recall': 0.46968141625267174, 'f1-score': 0.4488873942706722, 'support': 27170}, 'weighted avg': {'precision': 0.4782758623615629, 'recall': 0.45049687154950313, 'f1-score': 0.452912674574062, 'support': 27170}}
[[4641 3325 2652]
 [1287 3377 1183]
 [3177 3306 4222]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2141747
{'0': {'precision': 0.386206763953779, 'recall': 0.17339847897585525, 'f1-score': 0.2393389493250086, 'support': 115843}, '1': {'precision': 0.32946488412289676, 'recall': 0.17497517750426198, 'f1-score': 0.2285630383711825, 'support': 106758}, '2': {'precision': 0.3402360553165772, 'recall': 0.6888968868094295, 'f1-score': 0.4555049201004248, 'support': 111140}, 'accuracy': 0.34557036744062014, 'macro avg': {'precision': 0.35196923446441764, 'recall': 0.3457568477631822, 'f1-score': 0.3078023025988719, 'support': 333741}, 'weighted avg': {'precision': 0.3527471825270921, 'recall': 0.34557036744062014, 'f1-score': 0.30787794001051383, 'support': 333741}}
[[20087 20125 75631]
 [15241 18680 72837]
 [16683 17893 76564]]
Evaluating performance on  train set...
384/384 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2227352
{'0': {'precision': 0.3876181584782355, 'recall': 0.1970514950166113, 'f1-score': 0.2612782694198623, 'support': 33712}, '1': {'precision': 0.34937340309040027, 'recall': 0.17649047326367548, 'f1-score': 0.23451345502062151, 'support': 32540}, '2': {'precision': 0.33486933663213236, 'recall': 0.676876914421454, 'f1-score': 0.44806753289745926, 'support': 31994}, 'accuracy': 0.34649756733098547, 'macro avg': {'precision': 0.3572869660669227, 'recall': 0.35013962756724687, 'f1-score': 0.314619752445981, 'support': 98246}, 'weighted avg': {'precision': 0.3577733795919258, 'recall': 0.34649756733098547, 'f1-score': 0.31324179602807983, 'support': 98246}}
[[ 6643  5550 21519]
 [ 5302  5743 21495]
 [ 5193  5145 21656]]
Evaluating performance on  val set...
93/93 - 1s - 852ms/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2264025
{'0': {'precision': 0.3882989380885594, 'recall': 0.23952539859102706, 'f1-score': 0.29628497171686285, 'support': 8091}, '1': {'precision': 0.32004759071980965, 'recall': 0.1436198611852643, 'f1-score': 0.19826791966095447, 'support': 7492}, '2': {'precision': 0.3563045046226477, 'recall': 0.6774716369529984, 'f1-score': 0.46699896871777236, 'support': 8021}, 'accuracy': 0.35790543975597355, 'macro avg': {'precision': 0.35488367781033886, 'recall': 0.3535389655764299, 'f1-score': 0.3205172866985299, 'support': 23604}, 'weighted avg': {'precision': 0.355763501496594, 'recall': 0.35790543975597355, 'f1-score': 0.3231852096401568, 'support': 23604}}
[[1938 1174 4979]
 [1578 1076 4838]
 [1475 1112 5434]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1016188
{'0': {'precision': 0.46982710182851456, 'recall': 0.47548914081000176, 'f1-score': 0.47264116472633094, 'support': 246197}, '1': {'precision': 0.3859593435843487, 'recall': 0.4757209926224011, 'f1-score': 0.4261649113408153, 'support': 178920}, '2': {'precision': 0.4892291655070161, 'recall': 0.3991824769297467, 'f1-score': 0.4396423926586815, 'support': 242195}, 'accuracy': 0.44785647493226555, 'macro avg': {'precision': 0.44833853697329307, 'recall': 0.4501308701207165, 'f1-score': 0.44614948957527595, 'support': 667312}, 'weighted avg': {'precision': 0.4543822477086554, 'recall': 0.44785647493226555, 'f1-score': 0.44820331727767004, 'support': 667312}}
[[117064  68608  60525]
 [ 53392  85116  40412]
 [ 78708  66807  96680]]
Evaluating performance on  train set...
722/722 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0731329
{'0': {'precision': 0.47009913111492746, 'recall': 0.4466974730175144, 'f1-score': 0.4580996329834387, 'support': 61892}, '1': {'precision': 0.47269419064324425, 'recall': 0.5963831544178365, 'f1-score': 0.5273834560112163, 'support': 60550}, '2': {'precision': 0.4929964628600303, 'recall': 0.39189883993701596, 'f1-score': 0.43667254482468465, 'support': 62238}, 'accuracy': 0.47730669265756986, 'macro avg': {'precision': 0.478596594872734, 'recall': 0.47832648912412234, 'f1-score': 0.47405187793977993, 'support': 184680}, 'weighted avg': {'precision': 0.47866646373129784, 'recall': 0.47730669265756986, 'f1-score': 0.4735943068599136, 'support': 184680}}
[[27647 20336 13909]
 [13264 36111 11175]
 [17900 19947 24391]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0796609
{'0': {'precision': 0.4852604464796795, 'recall': 0.4810611434245992, 'f1-score': 0.4831516705848828, 'support': 21147}, '1': {'precision': 0.41096584574845446, 'recall': 0.5049813200498132, 'f1-score': 0.4531485723864335, 'support': 16060}, '2': {'precision': 0.4920160827110856, 'recall': 0.4098368499114875, 'f1-score': 0.4471822714103, 'support': 20901}, 'accuracy': 0.4620534177738005, 'macro avg': {'precision': 0.4627474583130731, 'recall': 0.46529310446196664, 'f1-score': 0.46116083812720543, 'support': 58108}, 'weighted avg': {'precision': 0.46715671317495633, 'recall': 0.4620534177738005, 'f1-score': 0.4619214411979645, 'support': 58108}}
[[10173  5756  5218]
 [ 4324  8110  3626]
 [ 6467  5868  8566]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/EXC
Evaluating performance on  test set...
5343/5343 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68482494
{'0': {'precision': 0.6501378957045313, 'recall': 0.34528974164020454, 'f1-score': 0.4510341839355221, 'support': 268308}, '1': {'precision': 0.7091739362029599, 'recall': 0.9588657530280364, 'f1-score': 0.8153314393599402, 'support': 828920}, '2': {'precision': 0.7069089239071156, 'recall': 0.2730770510162219, 'f1-score': 0.39396605506054744, 'support': 270561}, 'accuracy': 0.7028503665404533, 'macro avg': {'precision': 0.6887402519382023, 'recall': 0.525744181894821, 'f1-score': 0.5534438927853366, 'support': 1367789}, 'weighted avg': {'precision': 0.6971452783136011, 'recall': 0.7028503665404533, 'f1-score': 0.6605203480660032, 'support': 1367789}}
[[ 92644 160256  15408]
 [ 18872 794823  15225]
 [ 30983 165694  73884]]
Evaluating performance on  train set...
1290/1290 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6248532
{'0': {'precision': 0.6186205230416139, 'recall': 0.3745862819317205, 'f1-score': 0.46662338697736927, 'support': 54687}, '1': {'precision': 0.7664529591547063, 'recall': 0.9479633573027765, 'f1-score': 0.8475996330649271, 'support': 219307}, '2': {'precision': 0.678853601859024, 'recall': 0.31198049231974084, 'f1-score': 0.42749655500408523, 'support': 56183}, 'accuracy': 0.744776286658368, 'macro avg': {'precision': 0.6879756946851147, 'recall': 0.544843377184746, 'f1-score': 0.5805731916821272, 'support': 330177}, 'weighted avg': {'precision': 0.7270616413928392, 'recall': 0.744776286658368, 'f1-score': 0.713013943557534, 'support': 330177}}
[[ 20485  31002   3200]
 [  6320 207895   5092]
 [  6309  32346  17528]]
Evaluating performance on  val set...
363/363 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6352812
{'0': {'precision': 0.6238061961332402, 'recall': 0.34581611570247933, 'f1-score': 0.444961369111905, 'support': 15488}, '1': {'precision': 0.7629364230387545, 'recall': 0.9539133377378861, 'f1-score': 0.8478030476626949, 'support': 62057}, '2': {'precision': 0.6526173691315434, 'recall': 0.28439767305052616, 'f1-score': 0.39615769826094877, 'support': 15299}, 'accuracy': 0.7421481194261341, 'macro avg': {'precision': 0.679786662767846, 'recall': 0.5280423754969639, 'f1-score': 0.5629740383451828, 'support': 92844}, 'weighted avg': {'precision': 0.7215485017940965, 'recall': 0.7421481194261341, 'f1-score': 0.706179096541546, 'support': 92844}}
[[ 5356  9190   942]
 [ 1486 59197  1374]
 [ 1744  9204  4351]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/AAL
Evaluating performance on  test set...
7177/7177 - 54s - 54s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70481795
{'0': {'precision': 0.6067955766973497, 'recall': 0.2871476140220604, 'f1-score': 0.3898232099235808, 'support': 342061}, '1': {'precision': 0.7164524130615466, 'recall': 0.9564013099897511, 'f1-score': 0.8192181025218896, 'support': 1158177}, '2': {'precision': 0.655148117750902, 'recall': 0.2511941481545253, 'f1-score': 0.36315060997199605, 'support': 336851}, 'accuracy': 0.7024803915324734, 'macro avg': {'precision': 0.6594653691699328, 'recall': 0.4982476907221123, 'f1-score': 0.5240639741391555, 'support': 1837089}, 'weighted avg': {'precision': 0.6847937725257536, 'recall': 0.7024803915324734, 'f1-score': 0.6556408140562822, 'support': 1837089}}
[[  98222  223954   19885]
 [  25841 1107682   24654]
 [  37807  214429   84615]]
Evaluating performance on  train set...
2257/2257 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70316744
{'0': {'precision': 0.5764640796649017, 'recall': 0.33664097475423455, 'f1-score': 0.4250582750582751, 'support': 108335}, '1': {'precision': 0.7300812240677254, 'recall': 0.9382287177875377, 'f1-score': 0.8211701597558961, 'support': 362709}, '2': {'precision': 0.6046439243027888, 'recall': 0.2735260159014747, 'f1-score': 0.37666022504734264, 'support': 106531}, 'accuracy': 0.7027883824611523, 'macro avg': {'precision': 0.6370630760118052, 'recall': 0.5161319028144157, 'f1-score': 0.5409628866205046, 'support': 577575}, 'weighted avg': {'precision': 0.678131132183315, 'recall': 0.7027883824611523, 'f1-score': 0.6648841901707276, 'support': 577575}}
[[ 36470  63183   8682]
 [ 12034 340304  10371]
 [ 14761  62631  29139]]
Evaluating performance on  val set...
638/638 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6744965
{'0': {'precision': 0.611208078793168, 'recall': 0.33922640464987547, 'f1-score': 0.4363013393850399, 'support': 28904}, '1': {'precision': 0.7454023883119483, 'recall': 0.9531482517084823, 'f1-score': 0.8365708581173829, 'support': 105503}, '2': {'precision': 0.6221827288149285, 'recall': 0.2663116766363542, 'f1-score': 0.3729782082324455, 'support': 28921}, 'accuracy': 0.7228827880094044, 'macro avg': {'precision': 0.6595977319733483, 'recall': 0.5195621109982373, 'f1-score': 0.5486168019116228, 'support': 163328}, 'weighted avg': {'precision': 0.6998352590099048, 'recall': 0.7228827880094044, 'f1-score': 0.6836457430314091, 'support': 163328}}
[[  9805  16977   2122]
 [  2388 100560   2555]
 [  3849  17370   7702]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/WBA
Evaluating performance on  test set...
5696/5696 - 52s - 52s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0197163
{'0': {'precision': 0.5143917502408069, 'recall': 0.3366917414066991, 'f1-score': 0.4069905146874778, 'support': 485349}, '1': {'precision': 0.46239009589353275, 'recall': 0.7760937872364286, 'f1-score': 0.5795119106365798, 'support': 499343}, '2': {'precision': 0.5481710646041856, 'recall': 0.35001014087363624, 'f1-score': 0.42723100945514, 'support': 473332}, 'accuracy': 0.49150151163492506, 'macro avg': {'precision': 0.5083176369128418, 'recall': 0.487598556505588, 'f1-score': 0.47124447825973254, 'support': 1458024}, 'weighted avg': {'precision': 0.5075483569492807, 'recall': 0.49150151163492506, 'f1-score': 0.47264637857365494, 'support': 1458024}}
[[163413 239972  81964]
 [ 57216 387537  54590]
 [ 97053 210608 165671]]
Evaluating performance on  train set...
2222/2222 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88705343
{'0': {'precision': 0.5660193687590948, 'recall': 0.3602217495992285, 'f1-score': 0.44025790537745196, 'support': 156573}, '1': {'precision': 0.5861776657955002, 'recall': 0.8729209878269516, 'f1-score': 0.7013738047087609, 'support': 257454}, '2': {'precision': 0.5710913764898341, 'recall': 0.31614831297867935, 'f1-score': 0.406991655979881, 'support': 154592}, 'accuracy': 0.5803745566011688, 'macro avg': {'precision': 0.574429470348143, 'recall': 0.5164303501349531, 'f1-score': 0.5162077886886979, 'support': 568619}, 'weighted avg': {'precision': 0.5765253948052191, 'recall': 0.5803745566011688, 'f1-score': 0.5494393374428129, 'support': 568619}}
[[ 56401  79326  20846]
 [ 16857 224737  15860]
 [ 26387  79331  48874]]
Evaluating performance on  val set...
641/641 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9137922
{'0': {'precision': 0.5284162667340238, 'recall': 0.3683990402606265, 'f1-score': 0.43413185302395557, 'support': 45429}, '1': {'precision': 0.5920076915022228, 'recall': 0.8347673185594824, 'f1-score': 0.6927352521832115, 'support': 74501}, '2': {'precision': 0.5276139212505531, 'recall': 0.3258646993191702, 'f1-score': 0.4028941034050759, 'support': 43917}, 'accuracy': 0.5690552771793197, 'macro avg': {'precision': 0.5493459598289332, 'recall': 0.5096770193797597, 'f1-score': 0.5099204028707477, 'support': 163847}, 'weighted avg': {'precision': 0.5571161399697743, 'recall': 0.5690552771793197, 'f1-score': 0.5433455926148629, 'support': 163847}}
[[16736 21735  6958]
 [ 6455 62191  5855]
 [ 8481 21125 14311]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 97s - 97s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8660192
{'0': {'precision': 0.5926467712672612, 'recall': 0.2960357858634465, 'f1-score': 0.39484212053851175, 'support': 808811}, '1': {'precision': 0.5914547494963986, 'recall': 0.9135492211321419, 'f1-score': 0.7180353491182935, 'support': 1477465}, '2': {'precision': 0.604209392053947, 'recall': 0.3032211681033086, 'f1-score': 0.40379745995294236, 'support': 802566}, 'accuracy': 0.5932737899834307, 'macro avg': {'precision': 0.5961036376058689, 'recall': 0.5042687250329656, 'f1-score': 0.5055583098699158, 'support': 3088842}, 'weighted avg': {'precision': 0.5950808860159598, 'recall': 0.5932737899834307, 'f1-score': 0.5517598050287217, 'support': 3088842}}
[[ 239437  479124   90250]
 [  58567 1349737   69161]
 [ 106009  453202  243355]]
Evaluating performance on  train set...
2948/2948 - 23s - 23s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8697842
{'0': {'precision': 0.5746605948969846, 'recall': 0.3381795005620684, 'f1-score': 0.42578855583076386, 'support': 199264}, '1': {'precision': 0.599083995982571, 'recall': 0.8866368820602231, 'f1-score': 0.7150333203769738, 'support': 357903}, '2': {'precision': 0.588071722188122, 'recall': 0.3204672731419304, 'f1-score': 0.41485889365275663, 'support': 197315}, 'accuracy': 0.5937186042874449, 'macro avg': {'precision': 0.5872721043558925, 'recall': 0.5150945519214073, 'f1-score': 0.5185602566201647, 'support': 754482}, 'weighted avg': {'precision': 0.5897536323719481, 'recall': 0.5937186042874449, 'f1-score': 0.5601389878791476, 'support': 754482}}
[[ 67387 108541  23336]
 [ 19616 317330  20957]
 [ 30261 103821  63233]]
Evaluating performance on  val set...
697/697 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8101491
{'0': {'precision': 0.5859851049424509, 'recall': 0.29542129900526626, 'f1-score': 0.39280967355010216, 'support': 41016}, '1': {'precision': 0.6505766517837664, 'recall': 0.9187496149027501, 'f1-score': 0.7617498807983106, 'support': 97378}, '2': {'precision': 0.5869134824787171, 'recall': 0.29640553916912465, 'f1-score': 0.39388805846204955, 'support': 40006}, 'accuracy': 0.6358800448430493, 'macro avg': {'precision': 0.6078250797349781, 'recall': 0.503525484359047, 'f1-score': 0.5161492042701541, 'support': 178400}, 'weighted avg': {'precision': 0.6214499946287149, 'recall': 0.6358800448430493, 'f1-score': 0.5944341206812872, 'support': 178400}}
[[12117 24914  3985]
 [ 3551 89466  4361]
 [ 5010 23138 11858]]
testing model on single stock: results/universal/W1/deepVOL_L2/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 219s - 219s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0640066
{'0': {'precision': 0.48626151012891344, 'recall': 0.4794657186755575, 'f1-score': 0.48283970351927596, 'support': 2161483}, '1': {'precision': 0.30751697456407395, 'recall': 0.33469485674682686, 'f1-score': 0.32053084272473853, 'support': 1125455}, '2': {'precision': 0.49592918743462744, 'recall': 0.48016844103026735, 'f1-score': 0.48792157228452193, 'support': 2179279}, 'accuracy': 0.4499385955588664, 'macro avg': {'precision': 0.42990255737587163, 'recall': 0.43144300548421727, 'f1-score': 0.4304307061761788, 'support': 5466217}, 'weighted avg': {'precision': 0.4533136112176541, 'recall': 0.4499385955588664, 'f1-score': 0.4514475160073898, 'support': 5466217}}
[[1036357  439182  685944]
 [ 371115  376684  377656]
 [ 723803  409055 1046421]]
Evaluating performance on  train set...
6073/6073 - 60s - 60s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0455264
{'0': {'precision': 0.4739535681610247, 'recall': 0.3861589680375047, 'f1-score': 0.42557552198381127, 'support': 515135}, '1': {'precision': 0.45646129505107147, 'recall': 0.6033414319104441, 'f1-score': 0.5197231604742036, 'support': 520256}, '2': {'precision': 0.483722365590436, 'recall': 0.4166514177628221, 'f1-score': 0.44768875583256845, 'support': 519163}, 'accuracy': 0.4690258427819169, 'macro avg': {'precision': 0.47137907626751074, 'recall': 0.468717272570257, 'f1-score': 0.4643291460968611, 'support': 1554554}, 'weighted avg': {'precision': 0.471361916884037, 'recall': 0.4690258427819169, 'f1-score': 0.4644685077759291, 'support': 1554554}}
[[198924 194366 121845]
 [ 97341 313892 109023]
 [123447 179406 216310]]
Evaluating performance on  val set...
1786/1786 - 15s - 15s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0653628
{'0': {'precision': 0.4778769049189433, 'recall': 0.4266763369472908, 'f1-score': 0.4508275640731741, 'support': 161319}, '1': {'precision': 0.4044531501822419, 'recall': 0.48930250695543276, 'f1-score': 0.44285021023303794, 'support': 133349}, '2': {'precision': 0.48197373447317465, 'recall': 0.45026918935548377, 'f1-score': 0.4655823437534793, 'support': 162525}, 'accuracy': 0.4533293379382449, 'macro avg': {'precision': 0.45476792985812, 'recall': 0.45541601108606916, 'f1-score': 0.4530867060198971, 'support': 457193}, 'weighted avg': {'precision': 0.4579178350139296, 'recall': 0.4533293379382449, 'f1-score': 0.45374591236440615, 'support': 457193}}
[[68831 50014 42474]
 [31921 65248 36180]
 [43283 46062 73180]]
training model: results/universal/W1/deepVOL_L3/h10
Epoch 1/50
10622/10622 - 567s - loss: 2.7789 - accuracy10: 0.5153 - val_loss: 3.0587 - val_accuracy10: 0.5673 - 567s/epoch - 53ms/step
Epoch 2/50
10622/10622 - 570s - loss: 2.6288 - accuracy10: 0.5620 - val_loss: 3.0244 - val_accuracy10: 0.5811 - 570s/epoch - 54ms/step
Epoch 3/50
10622/10622 - 567s - loss: 2.5861 - accuracy10: 0.5705 - val_loss: 2.9454 - val_accuracy10: 0.5829 - 567s/epoch - 53ms/step
Epoch 4/50
10622/10622 - 560s - loss: 2.5625 - accuracy10: 0.5754 - val_loss: 2.8917 - val_accuracy10: 0.5861 - 560s/epoch - 53ms/step
Epoch 5/50
10622/10622 - 553s - loss: 2.5462 - accuracy10: 0.5788 - val_loss: 2.8567 - val_accuracy10: 0.5866 - 553s/epoch - 52ms/step
Epoch 6/50
10622/10622 - 559s - loss: 2.5349 - accuracy10: 0.5810 - val_loss: 2.8351 - val_accuracy10: 0.5865 - 559s/epoch - 53ms/step
Epoch 7/50
10622/10622 - 551s - loss: 2.5262 - accuracy10: 0.5828 - val_loss: 2.8250 - val_accuracy10: 0.5861 - 551s/epoch - 52ms/step
Epoch 8/50
10622/10622 - 552s - loss: 2.5189 - accuracy10: 0.5841 - val_loss: 2.8111 - val_accuracy10: 0.5857 - 552s/epoch - 52ms/step
Epoch 9/50
10622/10622 - 551s - loss: 2.5125 - accuracy10: 0.5855 - val_loss: 2.8045 - val_accuracy10: 0.5865 - 551s/epoch - 52ms/step
Epoch 10/50
10622/10622 - 562s - loss: 2.5069 - accuracy10: 0.5860 - val_loss: 2.8081 - val_accuracy10: 0.5880 - 562s/epoch - 53ms/step
Epoch 11/50
10622/10622 - 581s - loss: 2.5021 - accuracy10: 0.5869 - val_loss: 2.8222 - val_accuracy10: 0.5886 - 581s/epoch - 55ms/step
Epoch 12/50
10622/10622 - 568s - loss: 2.4977 - accuracy10: 0.5876 - val_loss: 2.8045 - val_accuracy10: 0.5894 - 568s/epoch - 53ms/step
Epoch 13/50
10622/10622 - 545s - loss: 2.4941 - accuracy10: 0.5881 - val_loss: 2.8085 - val_accuracy10: 0.5900 - 545s/epoch - 51ms/step
Epoch 14/50
10622/10622 - 592s - loss: 2.4900 - accuracy10: 0.5887 - val_loss: 2.8037 - val_accuracy10: 0.5896 - 592s/epoch - 56ms/step
Epoch 15/50
10622/10622 - 581s - loss: 2.4867 - accuracy10: 0.5893 - val_loss: 2.7989 - val_accuracy10: 0.5887 - 581s/epoch - 55ms/step
Epoch 16/50
10622/10622 - 585s - loss: 2.4834 - accuracy10: 0.5900 - val_loss: 2.8101 - val_accuracy10: 0.5894 - 585s/epoch - 55ms/step
Epoch 17/50
10622/10622 - 586s - loss: 2.4805 - accuracy10: 0.5904 - val_loss: 2.8194 - val_accuracy10: 0.5911 - 586s/epoch - 55ms/step
Epoch 18/50
10622/10622 - 562s - loss: 2.4776 - accuracy10: 0.5907 - val_loss: 2.7934 - val_accuracy10: 0.5902 - 562s/epoch - 53ms/step
Epoch 19/50
10622/10622 - 578s - loss: 2.4755 - accuracy10: 0.5913 - val_loss: 2.8031 - val_accuracy10: 0.5912 - 578s/epoch - 54ms/step
Epoch 20/50
10622/10622 - 580s - loss: 2.4727 - accuracy10: 0.5918 - val_loss: 2.7892 - val_accuracy10: 0.5901 - 580s/epoch - 55ms/step
Epoch 21/50
10622/10622 - 614s - loss: 2.4709 - accuracy10: 0.5921 - val_loss: 2.7905 - val_accuracy10: 0.5900 - 614s/epoch - 58ms/step
Epoch 22/50
10622/10622 - 637s - loss: 2.4682 - accuracy10: 0.5924 - val_loss: 2.7671 - val_accuracy10: 0.5899 - 637s/epoch - 60ms/step
Epoch 23/50
10622/10622 - 632s - loss: 2.4663 - accuracy10: 0.5927 - val_loss: 2.7695 - val_accuracy10: 0.5910 - 632s/epoch - 59ms/step
Epoch 24/50
10622/10622 - 581s - loss: 2.4645 - accuracy10: 0.5930 - val_loss: 2.7614 - val_accuracy10: 0.5936 - 581s/epoch - 55ms/step
Epoch 25/50
10622/10622 - 591s - loss: 2.4623 - accuracy10: 0.5935 - val_loss: 2.7573 - val_accuracy10: 0.5904 - 591s/epoch - 56ms/step
Epoch 26/50
10622/10622 - 547s - loss: 2.4609 - accuracy10: 0.5940 - val_loss: 2.7530 - val_accuracy10: 0.5904 - 547s/epoch - 52ms/step
Epoch 27/50
10622/10622 - 544s - loss: 2.4588 - accuracy10: 0.5940 - val_loss: 2.7605 - val_accuracy10: 0.5902 - 544s/epoch - 51ms/step
Epoch 28/50
10622/10622 - 577s - loss: 2.4576 - accuracy10: 0.5942 - val_loss: 2.7476 - val_accuracy10: 0.5897 - 577s/epoch - 54ms/step
Epoch 29/50
10622/10622 - 577s - loss: 2.4555 - accuracy10: 0.5947 - val_loss: 2.7393 - val_accuracy10: 0.5882 - 577s/epoch - 54ms/step
Epoch 30/50
10622/10622 - 573s - loss: 2.4541 - accuracy10: 0.5947 - val_loss: 2.7457 - val_accuracy10: 0.5898 - 573s/epoch - 54ms/step
Epoch 31/50
10622/10622 - 575s - loss: 2.4529 - accuracy10: 0.5947 - val_loss: 2.7444 - val_accuracy10: 0.5892 - 575s/epoch - 54ms/step
Epoch 32/50
10622/10622 - 589s - loss: 2.4510 - accuracy10: 0.5953 - val_loss: 2.7473 - val_accuracy10: 0.5885 - 589s/epoch - 55ms/step
Epoch 33/50
10622/10622 - 580s - loss: 2.4499 - accuracy10: 0.5955 - val_loss: 2.7444 - val_accuracy10: 0.5915 - 580s/epoch - 55ms/step
Epoch 34/50
10622/10622 - 584s - loss: 2.4486 - accuracy10: 0.5959 - val_loss: 2.7374 - val_accuracy10: 0.5885 - 584s/epoch - 55ms/step
Epoch 35/50
10622/10622 - 579s - loss: 2.4476 - accuracy10: 0.5958 - val_loss: 2.7432 - val_accuracy10: 0.5875 - 579s/epoch - 55ms/step
Epoch 36/50
10622/10622 - 579s - loss: 2.4460 - accuracy10: 0.5962 - val_loss: 2.7477 - val_accuracy10: 0.5902 - 579s/epoch - 54ms/step
Epoch 37/50
10622/10622 - 582s - loss: 2.4449 - accuracy10: 0.5963 - val_loss: 2.7308 - val_accuracy10: 0.5879 - 582s/epoch - 55ms/step
Epoch 38/50
10622/10622 - 582s - loss: 2.4440 - accuracy10: 0.5965 - val_loss: 2.7560 - val_accuracy10: 0.5913 - 582s/epoch - 55ms/step
Epoch 39/50
10622/10622 - 579s - loss: 2.4426 - accuracy10: 0.5966 - val_loss: 2.7503 - val_accuracy10: 0.5908 - 579s/epoch - 55ms/step
Epoch 40/50
10622/10622 - 585s - loss: 2.4414 - accuracy10: 0.5970 - val_loss: 2.7449 - val_accuracy10: 0.5913 - 585s/epoch - 55ms/step
Epoch 41/50
10622/10622 - 590s - loss: 2.4404 - accuracy10: 0.5970 - val_loss: 2.7388 - val_accuracy10: 0.5897 - 590s/epoch - 56ms/step
Epoch 42/50
10622/10622 - 584s - loss: 2.4393 - accuracy10: 0.5975 - val_loss: 2.7451 - val_accuracy10: 0.5895 - 584s/epoch - 55ms/step
Epoch 43/50
10622/10622 - 594s - loss: 2.4380 - accuracy10: 0.5976 - val_loss: 2.7314 - val_accuracy10: 0.5895 - 594s/epoch - 56ms/step
Epoch 44/50
10622/10622 - 612s - loss: 2.4368 - accuracy10: 0.5979 - val_loss: 2.7324 - val_accuracy10: 0.5904 - 612s/epoch - 58ms/step
Epoch 45/50
10622/10622 - 605s - loss: 2.4363 - accuracy10: 0.5981 - val_loss: 2.7456 - val_accuracy10: 0.5884 - 605s/epoch - 57ms/step
Epoch 46/50
10622/10622 - 594s - loss: 2.4352 - accuracy10: 0.5981 - val_loss: 2.7415 - val_accuracy10: 0.5894 - 594s/epoch - 56ms/step
Epoch 47/50
10622/10622 - 577s - loss: 2.4343 - accuracy10: 0.5981 - val_loss: 2.7432 - val_accuracy10: 0.5887 - 577s/epoch - 54ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h10/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1101s - 1101s/epoch - 31ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90863466
{'0': {'precision': 0.44834821077944037, 'recall': 0.6266215562206141, 'f1-score': 0.5227024279043312, 'support': 2450578}, '1': {'precision': 0.7646752961172054, 'recall': 0.5647547180025559, 'f1-score': 0.6496829116771993, 'support': 4137768}, '2': {'precision': 0.47703256920083137, 'recall': 0.4978712066822999, 'f1-score': 0.48722917426313583, 'support': 2458435}, 'accuracy': 0.5633377220029975, 'macro avg': {'precision': 0.5633520253658256, 'recall': 0.5630824936351566, 'f1-score': 0.5532048379482221, 'support': 9046781}, 'weighted avg': {'precision': 0.6008230769157563, 'recall': 0.5633377220029975, 'f1-score': 0.571140330188525, 'support': 9046781}}
[[1535585  370815  544178]
 [1003277 2336824  797667]
 [ 886121  348330 1223984]]
Evaluating performance on  train set...
10622/10622 - 350s - 350s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8332666
{'0': {'precision': 0.4331294053696472, 'recall': 0.5751360608490333, 'f1-score': 0.49413244505223286, 'support': 587421}, '1': {'precision': 0.7789971909900819, 'recall': 0.6697089530883189, 'f1-score': 0.7202308009380205, 'support': 1544562}, '2': {'precision': 0.4588097538607667, 'recall': 0.47766102729438, 'f1-score': 0.4680456513367876, 'support': 586531}, 'accuracy': 0.6078383263797795, 'macro avg': {'precision': 0.5569787834068319, 'recall': 0.5741686804105774, 'f1-score': 0.5608029657756803, 'support': 2718514}, 'weighted avg': {'precision': 0.6351797016617813, 'recall': 0.6078383263797795, 'f1-score': 0.6169650718325069, 'support': 2718514}}
[[ 337847  149631   99943]
 [ 279631 1034407  230524]
 [ 162536  143832  280163]]
Evaluating performance on  val set...
3064/3064 - 99s - 99s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8673714
{'0': {'precision': 0.43502872796916287, 'recall': 0.5992619638662852, 'f1-score': 0.5041061897181384, 'support': 179666}, '1': {'precision': 0.7813534343932542, 'recall': 0.6182471747394553, 'f1-score': 0.6902962890048233, 'support': 425359}, '2': {'precision': 0.44969406863677786, 'recall': 0.5024363227470309, 'f1-score': 0.47460439505272534, 'support': 178753}, 'accuracy': 0.5874826800446045, 'macro avg': {'precision': 0.5553587436663984, 'recall': 0.573315153784257, 'f1-score': 0.5563356245918957, 'support': 783778}, 'weighted avg': {'precision': 0.6263249935446233, 'recall': 0.5874826800446045, 'f1-score': 0.5984238410692333, 'support': 783778}}
[[107667  37422  34577]
 [ 87053 262977  75329]
 [ 52774  36167  89812]]
testing model out of sample: results/universal/W1/deepVOL_L3/h10/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 751s - 751s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6787876
{'0': {'precision': 0.48465749926425133, 'recall': 0.5529895335677368, 'f1-score': 0.5165735861582506, 'support': 1125694}, '1': {'precision': 0.8254375996419593, 'recall': 0.8302619913291043, 'f1-score': 0.8278427668085672, 'support': 3856349}, '2': {'precision': 0.5217309077232445, 'recall': 0.43708337174943807, 'f1-score': 0.4756706469139891, 'support': 1117153}, 'accuracy': 0.7070712270928824, 'macro avg': {'precision': 0.610608668876485, 'recall': 0.606778298882093, 'f1-score': 0.6066956666269356, 'support': 6099196}, 'weighted avg': {'precision': 0.7069136242996926, 'recall': 0.7070712270928824, 'f1-score': 0.7058883339128929, 'support': 6099196}}
[[ 622497  341657  161540]
 [ 368496 3201780  286073]
 [ 293413  335451  488289]]
Evaluating performance on  train set...
6711/6711 - 224s - 224s/epoch - 33ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7091899
{'0': {'precision': 0.4452606672121664, 'recall': 0.5668903921887389, 'f1-score': 0.49876743578479094, 'support': 301411}, '1': {'precision': 0.831706852070817, 'recall': 0.793993444198582, 'f1-score': 0.8124127055333168, 'support': 1115348}, '2': {'precision': 0.4907705416376754, 'recall': 0.43890402936253614, 'f1-score': 0.4633904700339729, 'support': 300519}, 'accuracy': 0.6919933755629548, 'macro avg': {'precision': 0.5892460203068862, 'recall': 0.5999292885832858, 'f1-score': 0.5915235371173602, 'support': 1717278}, 'weighted avg': {'precision': 0.704216154525348, 'recall': 0.6919933755629548, 'f1-score': 0.696284770749199, 'support': 1717278}}
[[170867  90499  40045]
 [132954 885579  96815]
 [ 79925  88695 131899]]
Evaluating performance on  val set...
1720/1720 - 55s - 55s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6673099
{'0': {'precision': 0.4628210709621245, 'recall': 0.5739273615591216, 'f1-score': 0.5124206949323082, 'support': 74093}, '1': {'precision': 0.8488690349571013, 'recall': 0.8200849431428963, 'f1-score': 0.834228772516637, 'support': 291960}, '2': {'precision': 0.4958809339583997, 'recall': 0.4428861788617886, 'f1-score': 0.4678877412982328, 'support': 73800}, 'accuracy': 0.7153321677924216, 'macro avg': {'precision': 0.6025236799592085, 'recall': 0.6122994945212689, 'f1-score': 0.6048457362490592, 'support': 439853}, 'weighted avg': {'precision': 0.7246139459842309, 'recall': 0.7153321677924216, 'f1-score': 0.7185544586063672, 'support': 439853}}
[[ 42524  21187  10382]
 [ 29682 239432  22846]
 [ 19674  21441  32685]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3368355
{'0': {'precision': 0.3560443506755847, 'recall': 0.7662937414256178, 'f1-score': 0.486189606345548, 'support': 51753}, '1': {'precision': 0.7078239608801956, 'recall': 0.060927212050148824, 'f1-score': 0.11219687742221238, 'support': 66522}, '2': {'precision': 0.4118911311029538, 'recall': 0.42121642386166924, 'f1-score': 0.41650158669102805, 'support': 51413}, 'accuracy': 0.38521875441987646, 'macro avg': {'precision': 0.49191981421957803, 'recall': 0.416145792445812, 'f1-score': 0.3382960234862628, 'support': 169688}, 'weighted avg': {'precision': 0.5108716440147922, 'recall': 0.38521875441987646, 'f1-score': 0.3184605125502533, 'support': 169688}}
[[39658   835 11260]
 [42808  4053 19661]
 [28919   838 21656]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4655405
{'0': {'precision': 0.28741418764302057, 'recall': 0.7850981372671584, 'f1-score': 0.4207846159000302, 'support': 15998}, '1': {'precision': 0.7494078635717669, 'recall': 0.046858801575782705, 'f1-score': 0.08820249776984834, 'support': 33761}, '2': {'precision': 0.3391753572808034, 'recall': 0.41905273204485805, 'f1-score': 0.3749066068950795, 'support': 16764}, 'accuracy': 0.31819070096057, 'macro avg': {'precision': 0.4586658028318636, 'recall': 0.4170032236292664, 'f1-score': 0.2946312401883193, 'support': 66523}, 'weighted avg': {'precision': 0.5349239623200224, 'recall': 0.31819070096057, 'f1-score': 0.2404349047752754, 'support': 66523}}
[[12560   217  3221]
 [21713  1582 10466]
 [ 9427   312  7025]]
Evaluating performance on  val set...
51/51 - 1s - 858ms/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.4280951
{'0': {'precision': 0.28772702256466703, 'recall': 0.8251262626262627, 'f1-score': 0.4266710193422019, 'support': 3168}, '1': {'precision': 0.7417677642980935, 'recall': 0.06531359682588128, 'f1-score': 0.12005610098176718, 'support': 6553}, '2': {'precision': 0.34065934065934067, 'recall': 0.34708893154190656, 'f1-score': 0.3438440817620029, 'support': 3126}, 'accuracy': 0.32124231338055576, 'macro avg': {'precision': 0.4567180425073671, 'recall': 0.4125095969980168, 'f1-score': 0.29685706736199063, 'support': 12847}, 'weighted avg': {'precision': 0.5322039749226568, 'recall': 0.32124231338055576, 'f1-score': 0.2501189397211518, 'support': 12847}}
[[2614   69  485]
 [4510  428 1615]
 [1961   80 1085]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/QRTEA
Evaluating performance on  test set...
1645/1645 - 26s - 26s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46519405
{'0': {'precision': 0.39656758896663885, 'recall': 0.5425535029422959, 'f1-score': 0.4582138265255662, 'support': 34157}, '1': {'precision': 0.9237889062522401, 'recall': 0.9131817486097176, 'f1-score': 0.9184547031548219, 'support': 352806}, '2': {'precision': 0.5039178812098417, 'recall': 0.37777190354509943, 'f1-score': 0.4318208524281949, 'support': 34047}, 'accuracy': 0.839813781145341, 'macro avg': {'precision': 0.6080914588095735, 'recall': 0.6111690516990377, 'f1-score': 0.6028297940361943, 'support': 421010}, 'weighted avg': {'precision': 0.8470599750531169, 'recall': 0.839813781145341, 'f1-score': 0.8417608708498531, 'support': 421010}}
[[ 18532  13270   2355]
 [ 20323 322176  10307]
 [  7876  13309  12862]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6039341
{'0': {'precision': 0.4319343600429785, 'recall': 0.6108297264941523, 'f1-score': 0.5060365051210163, 'support': 21718}, '1': {'precision': 0.8936027872142628, 'recall': 0.8284614207350963, 'f1-score': 0.8598000367825317, 'support': 124147}, '2': {'precision': 0.455751373886678, 'recall': 0.45694200351493847, 'f1-score': 0.4563459120988591, 'support': 21053}, 'accuracy': 0.7532860446446759, 'macro avg': {'precision': 0.5937628403813064, 'recall': 0.632077716914729, 'f1-score': 0.6073941513341358, 'support': 166918}, 'weighted avg': {'precision': 0.7783090459395555, 'recall': 0.7532860446446759, 'f1-score': 0.7628844490832414, 'support': 166918}}
[[ 13266   5934   2518]
 [ 12326 102851   8970]
 [  5121   6312   9620]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.53403676
{'0': {'precision': 0.45870535714285715, 'recall': 0.5626833561509876, 'f1-score': 0.5054018445322793, 'support': 5113}, '1': {'precision': 0.9010571894505989, 'recall': 0.8833971938142625, 'f1-score': 0.8921398048522473, 'support': 36277}, '2': {'precision': 0.47124887690925427, 'recall': 0.4281632653061225, 'f1-score': 0.4486740804106074, 'support': 4900}, 'accuracy': 0.7997839706200043, 'macro avg': {'precision': 0.6103371411675701, 'recall': 0.6247479384237908, 'f1-score': 0.6154052432650446, 'support': 46290}, 'weighted avg': {'precision': 0.8066997547985775, 'recall': 0.7997839706200043, 'f1-score': 0.8024795490544502, 'support': 46290}}
[[ 2877  1749   487]
 [ 2363 32047  1867]
 [ 1032  1770  2098]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/XRAY
Evaluating performance on  test set...
1314/1314 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0202322
{'0': {'precision': 0.4576584673296472, 'recall': 0.6497554390539328, 'f1-score': 0.5370459530305463, 'support': 108153}, '1': {'precision': 0.6450744944254412, 'recall': 0.38700370930072814, 'f1-score': 0.4837738481766711, 'support': 116464}, '2': {'precision': 0.49052239797952946, 'recall': 0.49578138435081687, 'f1-score': 0.4931378706685732, 'support': 111648}, 'accuracy': 0.5076293994319956, 'macro avg': {'precision': 0.5310851199115393, 'recall': 0.5108468442351594, 'f1-score': 0.5046525572919301, 'support': 336265}, 'weighted avg': {'precision': 0.533480846432089, 'recall': 0.5076293994319956, 'f1-score': 0.5040168480114354, 'support': 336265}}
[[70273 12112 25768]
 [39668 45072 31724]
 [43608 12687 55353]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8824631
{'0': {'precision': 0.47009586943296483, 'recall': 0.6290775363539386, 'f1-score': 0.5380893493894899, 'support': 35622}, '1': {'precision': 0.7476595023263699, 'recall': 0.6372174415617775, 'f1-score': 0.6880346695557963, 'support': 62288}, '2': {'precision': 0.49777523901148457, 'recall': 0.4585410435360585, 'f1-score': 0.4773533227620009, 'support': 36108}, 'accuracy': 0.5869136981599486, 'macro avg': {'precision': 0.5718435369236065, 'recall': 0.574945340483925, 'f1-score': 0.5678257805690957, 'support': 134018}, 'weighted avg': {'precision': 0.6065576151865621, 'recall': 0.5869136981599486, 'f1-score': 0.5914160491839467, 'support': 134018}}
[[22409  6341  6872]
 [12764 39691  9833]
 [12496  7055 16557]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0083083
{'0': {'precision': 0.4599411249900549, 'recall': 0.6657837153057699, 'f1-score': 0.544042913608131, 'support': 8683}, '1': {'precision': 0.6497184231697506, 'recall': 0.40915999594690444, 'f1-score': 0.5021139020144242, 'support': 9869}, '2': {'precision': 0.48044359647030765, 'recall': 0.4675098630772801, 'f1-score': 0.47388849682427664, 'support': 8618}, 'accuracy': 0.5096797938903203, 'macro avg': {'precision': 0.5300343815433711, 'recall': 0.5141511914433181, 'f1-score': 0.5066817708156106, 'support': 27170}, 'weighted avg': {'precision': 0.5353773581498722, 'recall': 0.5096797938903203, 'f1-score': 0.506560831191438, 'support': 27170}}
[[5781 1067 1835]
 [3309 4038 2522]
 [3479 1110 4029]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2532622
{'0': {'precision': 0.3543813358202731, 'recall': 0.7988070619199809, 'f1-score': 0.49095588235294113, 'support': 117022}, '1': {'precision': 0.34811664641555284, 'recall': 0.01104599606739407, 'f1-score': 0.02141255605381166, 'support': 103748}, '2': {'precision': 0.36905101168424054, 'recall': 0.21779925821671048, 'f1-score': 0.2739337126061834, 'support': 112971}, 'accuracy': 0.35725008314830964, 'macro avg': {'precision': 0.35718299797335545, 'recall': 0.3425507720680285, 'f1-score': 0.2621007170043121, 'support': 333741}, 'weighted avg': {'precision': 0.35739954142182445, 'recall': 0.35725008314830964, 'f1-score': 0.27153006246463535, 'support': 333741}}
[[93478  1025 22519]
 [83055  1146 19547]
 [87245  1121 24605]]
Evaluating performance on  train set...
384/384 - 13s - 13s/epoch - 34ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.2750257
{'0': {'precision': 0.3515800986992018, 'recall': 0.7966071691989969, 'f1-score': 0.48784938659728616, 'support': 33895}, '1': {'precision': 0.37285607755406414, 'recall': 0.015503875968992248, 'f1-score': 0.02976987883659313, 'support': 32250}, '2': {'precision': 0.37138167711131004, 'recall': 0.23260957602566898, 'f1-score': 0.2860535943455858, 'support': 32101}, 'accuracy': 0.3559228874457993, 'macro avg': {'precision': 0.365272617788192, 'recall': 0.3482402070645527, 'f1-score': 0.2678909532598217, 'support': 98246}, 'weighted avg': {'precision': 0.3650340895657653, 'recall': 0.3559228874457993, 'f1-score': 0.27154632232643355, 'support': 98246}}
[[27001   430  6464]
 [25575   500  6175]
 [24223   411  7467]]
Evaluating performance on  val set...
93/93 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.3010677
{'0': {'precision': 0.35229805753104765, 'recall': 0.8137795758244453, 'f1-score': 0.4917219156265047, 'support': 8157}, '1': {'precision': 0.30994152046783624, 'recall': 0.007213828773649109, 'f1-score': 0.014099494546421919, 'support': 7347}, '2': {'precision': 0.38749727728163796, 'recall': 0.21962962962962962, 'f1-score': 0.28035615790717827, 'support': 8100}, 'accuracy': 0.35883748517200476, 'macro avg': {'precision': 0.34991228509350725, 'recall': 0.3468743447425746, 'f1-score': 0.26205918936003497, 'support': 23604}, 'weighted avg': {'precision': 0.3511931686213869, 'recall': 0.35883748517200476, 'f1-score': 0.27052404385892664, 'support': 23604}}
[[6638   64 1455]
 [5937   53 1357]
 [6267   54 1779]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/PCAR
Evaluating performance on  test set...
2607/2607 - 40s - 40s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0036567
{'0': {'precision': 0.47111666815859915, 'recall': 0.7087666710109041, 'f1-score': 0.5660081492184695, 'support': 230190}, '1': {'precision': 0.6780867399875493, 'recall': 0.30263066500581143, 'f1-score': 0.4184892406502035, 'support': 215953}, '2': {'precision': 0.5027134112409571, 'recall': 0.5105688410220239, 'f1-score': 0.5066106766802605, 'support': 221169}, 'accuracy': 0.5116452274198576, 'macro avg': {'precision': 0.5506389397957019, 'recall': 0.5073220590129132, 'f1-score': 0.4970360221829779, 'support': 667312}, 'weighted avg': {'precision': 0.5485677375121539, 'recall': 0.5116452274198576, 'f1-score': 0.4985823716723653, 'support': 667312}}
[[163151  16378  50661]
 [ 89557  65354  61042]
 [ 93599  14648 112922]]
Evaluating performance on  train set...
722/722 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97498494
{'0': {'precision': 0.45759164912368117, 'recall': 0.6712654179990863, 'f1-score': 0.5442060975971081, 'support': 54725}, '1': {'precision': 0.7158493510760637, 'recall': 0.46107958678888405, 'f1-score': 0.5608894681373142, 'support': 75603}, '2': {'precision': 0.48790952338210214, 'recall': 0.5000551957609656, 'f1-score': 0.493907702372407, 'support': 54352}, 'accuracy': 0.5348332250379034, 'macro avg': {'precision': 0.5537835078606156, 'recall': 0.5441334001829786, 'f1-score': 0.5330010893689431, 'support': 184680}, 'weighted avg': {'precision': 0.5722380328273832, 'recall': 0.5348332250379034, 'f1-score': 0.5362328167096176, 'support': 184680}}
[[36735  7242 10748]
 [22966 34859 17778]
 [20578  6595 27179]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0091194
{'0': {'precision': 0.4704596780068478, 'recall': 0.6878261795718393, 'f1-score': 0.558747188094826, 'support': 18778}, '1': {'precision': 0.6801414373088684, 'recall': 0.3455860930368068, 'f1-score': 0.45830381866185843, 'support': 20594}, '2': {'precision': 0.4888558692421991, 'recall': 0.5267933390264731, 'f1-score': 0.5071160663823665, 'support': 18736}, 'accuracy': 0.5146107248571625, 'macro avg': {'precision': 0.5464856615193051, 'recall': 0.5200685372117064, 'f1-score': 0.5080556910463504, 'support': 58108}, 'weighted avg': {'precision': 0.5507043463838587, 'recall': 0.5146107248571625, 'f1-score': 0.5065015171629892, 'support': 58108}}
[[12916  1637  4225]
 [ 7382  7117  6095]
 [ 7156  1710  9870]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/EXC
Evaluating performance on  test set...
5343/5343 - 80s - 80s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.48951036
{'0': {'precision': 0.49083345168773374, 'recall': 0.5356586994568692, 'f1-score': 0.5122673526296448, 'support': 154843}, '1': {'precision': 0.8828973846766228, 'recall': 0.9073936763077926, 'f1-score': 0.8949779408983265, 'support': 1055997}, '2': {'precision': 0.5565109374587037, 'recall': 0.4024810607267329, 'f1-score': 0.46712613418719356, 'support': 156949}, 'accuracy': 0.8073737981516155, 'macro avg': {'precision': 0.6434139246076868, 'recall': 0.6151778121637982, 'f1-score': 0.624790475905055, 'support': 1367789}, 'weighted avg': {'precision': 0.8010613835973601, 'recall': 0.8073737981516155, 'f1-score': 0.8025580070994781, 'support': 1367789}}
[[ 82943  60889  11011]
 [ 58463 958205  39329]
 [ 27578  66202  63169]]
Evaluating performance on  train set...
1290/1290 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.46886042
{'0': {'precision': 0.45428497004428237, 'recall': 0.5483069764517244, 'f1-score': 0.4968873313674374, 'support': 31807}, '1': {'precision': 0.9066082572847229, 'recall': 0.8993263318032392, 'f1-score': 0.9029526133813746, 'support': 265561}, '2': {'precision': 0.5132409464367573, 'recall': 0.44362827273004357, 'f1-score': 0.47590243264452, 'support': 32809}, 'accuracy': 0.8202297555553536, 'macro avg': {'precision': 0.6247113912552542, 'recall': 0.6304205269950024, 'f1-score': 0.6252474591311107, 'support': 330177}, 'weighted avg': {'precision': 0.8239464277240098, 'recall': 0.8202297555553536, 'f1-score': 0.8213999679675122, 'support': 330177}}
[[ 17440  11945   2422]
 [ 15353 238826  11382]
 [  5597  12657  14555]]
Evaluating performance on  val set...
363/363 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4701059
{'0': {'precision': 0.4637528691660291, 'recall': 0.5342073372259557, 'f1-score': 0.4964931142169662, 'support': 9077}, '1': {'precision': 0.9038676980528141, 'recall': 0.9060791208203538, 'f1-score': 0.9049720584602443, 'support': 74797}, '2': {'precision': 0.5121490280777538, 'recall': 0.4229654403567447, 'f1-score': 0.4633044327756747, 'support': 8970}, 'accuracy': 0.8230472620740167, 'macro avg': {'precision': 0.6265898650988656, 'recall': 0.6210839661343514, 'f1-score': 0.621589868484295, 'support': 92844}, 'weighted avg': {'precision': 0.8229939876193814, 'recall': 0.8230472620740167, 'f1-score': 0.8223655143724536, 'support': 92844}}
[[ 4849  3535   693]
 [ 4104 67772  2921]
 [ 1503  3673  3794]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/AAL
Evaluating performance on  test set...
7177/7177 - 108s - 108s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.49918053
{'0': {'precision': 0.4979653283733931, 'recall': 0.46699561033666936, 'f1-score': 0.4819834940906457, 'support': 207533}, '1': {'precision': 0.8721215675763181, 'recall': 0.9236273646652281, 'f1-score': 0.8971358196746765, 'support': 1423193}, '2': {'precision': 0.5558538371086903, 'recall': 0.36422226852681927, 'f1-score': 0.44008173732807937, 'support': 206363}, 'accuracy': 0.8092035824067315, 'macro avg': {'precision': 0.6419802443528005, 'recall': 0.5849484145095722, 'f1-score': 0.6064003503644672, 'support': 1837089}, 'weighted avg': {'precision': 0.7943269019651302, 'recall': 0.8092035824067315, 'f1-score': 0.7988951469687152, 'support': 1837089}}
[[  96917   96044   14572]
 [  63208 1314500   45485]
 [  34501   96700   75162]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5300106
{'0': {'precision': 0.4578354387162854, 'recall': 0.5178067543885704, 'f1-score': 0.4859779214986619, 'support': 67334}, '1': {'precision': 0.8788857775549057, 'recall': 0.8941405394667635, 'f1-score': 0.8864475340588022, 'support': 442993}, '2': {'precision': 0.5142789570153137, 'recall': 0.3880264097073519, 'f1-score': 0.44231991660098147, 'support': 67248}, 'accuracy': 0.791339652858936, 'macro avg': {'precision': 0.6170000577621683, 'recall': 0.5999912345208953, 'f1-score': 0.6049151240528151, 'support': 577575}, 'weighted avg': {'precision': 0.7873477383686422, 'recall': 0.791339652858936, 'f1-score': 0.7880500706801449, 'support': 577575}}
[[ 34866  26933   5535]
 [ 27785 396098  19110]
 [ 13503  27651  26094]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.4953179
{'0': {'precision': 0.4973830464576701, 'recall': 0.5189146588606169, 'f1-score': 0.5079207648014987, 'support': 17764}, '1': {'precision': 0.8854195156045827, 'recall': 0.9146601789358029, 'f1-score': 0.8998023532318336, 'support': 127420}, '2': {'precision': 0.533302954355586, 'recall': 0.38701499118165783, 'f1-score': 0.4485324646290441, 'support': 18144}, 'accuracy': 0.8130020572100314, 'macro avg': {'precision': 0.6387018388059462, 'recall': 0.6068632763260259, 'f1-score': 0.6187518608874588, 'support': 163328}, 'weighted avg': {'precision': 0.8040992109095667, 'recall': 0.8130020572100314, 'f1-score': 0.8070489649843472, 'support': 163328}}
[[  9218   7136   1410]
 [  6139 116546   4735]
 [  3176   7946   7022]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/WBA
Evaluating performance on  test set...
5696/5696 - 84s - 84s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8690215
{'0': {'precision': 0.4451142090621586, 'recall': 0.503463590278945, 'f1-score': 0.472494291842524, 'support': 339099}, '1': {'precision': 0.7184797420364549, 'recall': 0.6752716150826258, 'f1-score': 0.6962059241498596, 'support': 788616}, '2': {'precision': 0.47220830345382153, 'recall': 0.47645992086198075, 'f1-score': 0.47432458498595526, 'support': 330309}, 'accuracy': 0.5902735483092185, 'macro avg': {'precision': 0.545267418184145, 'recall': 0.5517317087411838, 'f1-score': 0.5476749336594463, 'support': 1458024}, 'weighted avg': {'precision': 0.599110203899331, 'recall': 0.5902735483092185, 'f1-score': 0.5939100812407749, 'support': 1458024}}
[[170724 114027  54348]
 [134530 532530 121556]
 [ 78297  94633 157379]]
Evaluating performance on  train set...
2222/2222 - 33s - 33s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72871095
{'0': {'precision': 0.4798287944274265, 'recall': 0.5360498040465788, 'f1-score': 0.5063836005898686, 'support': 106658}, '1': {'precision': 0.7983064642801045, 'recall': 0.782752238087104, 'f1-score': 0.7904528410729738, 'support': 357113}, '2': {'precision': 0.4888177305178785, 'recall': 0.462994048527392, 'f1-score': 0.47555557732529374, 'support': 104848}, 'accuracy': 0.6775169313723248, 'macro avg': {'precision': 0.5889843297418031, 'recall': 0.5939320302203582, 'f1-score': 0.5907973396627121, 'support': 568619}, 'weighted avg': {'precision': 0.6815015983353352, 'recall': 0.6775169313723248, 'f1-score': 0.6791048112659082, 'support': 568619}}
[[ 57174  35562  13922]
 [ 40739 279531  36843]
 [ 21242  35062  48544]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7683389
{'0': {'precision': 0.43632001668926673, 'recall': 0.5493105712409717, 'f1-score': 0.48633879781420764, 'support': 30460}, '1': {'precision': 0.8056724572561677, 'recall': 0.7342734648363902, 'f1-score': 0.7683177678198727, 'support': 104028}, '2': {'precision': 0.4402737047898338, 'recall': 0.46023365918457715, 'f1-score': 0.4500324734799913, 'support': 29359}, 'accuracy': 0.6507839630875145, 'macro avg': {'precision': 0.560755392911756, 'recall': 0.5812725650873131, 'f1-score': 0.5682296797046905, 'support': 163847}, 'weighted avg': {'precision': 0.6715337954965571, 'recall': 0.6507839630875145, 'f1-score': 0.6588643302659526, 'support': 163847}}
[[16732  9345  4383]
 [14848 76385 12795]
 [ 6768  9079 13512]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/ATVI
Evaluating performance on  test set...
12066/12066 - 185s - 185s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6420237
{'0': {'precision': 0.5283341857770634, 'recall': 0.4792591821082632, 'f1-score': 0.5026015808078802, 'support': 528065}, '1': {'precision': 0.8060849224949819, 'recall': 0.8715943284320208, 'f1-score': 0.8375606317989338, 'support': 2034217}, '2': {'precision': 0.5437468924570793, 'recall': 0.42368391066545125, 'f1-score': 0.4762651945024401, 'support': 526560}, 'accuracy': 0.7281651181899236, 'macro avg': {'precision': 0.6260553335763749, 'recall': 0.5915124737352451, 'f1-score': 0.6054758023697514, 'support': 3088842}, 'weighted avg': {'precision': 0.7138797673327218, 'recall': 0.7281651181899236, 'f1-score': 0.7187057739834701, 'support': 3088842}}
[[ 253080  216063   58922]
 [ 132930 1773012  128275]
 [  93005  210460  223095]]
Evaluating performance on  train set...
2948/2948 - 45s - 45s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6838393
{'0': {'precision': 0.47418579170680414, 'recall': 0.5048460839883506, 'f1-score': 0.489035844427676, 'support': 127732}, '1': {'precision': 0.8101642692361216, 'recall': 0.8255293057960508, 'f1-score': 0.8177746210809752, 'support': 500703}, '2': {'precision': 0.5077383370886123, 'recall': 0.436218236054805, 'f1-score': 0.469268879699922, 'support': 126047}, 'accuracy': 0.7061984248795863, 'macro avg': {'precision': 0.5973627993438461, 'recall': 0.5888645419464021, 'f1-score': 0.5920264484028578, 'support': 754482}, 'weighted avg': {'precision': 0.7027593419334532, 'recall': 0.7061984248795863, 'f1-score': 0.7038970672051547, 'support': 754482}}
[[ 64485  49571  13676]
 [ 47726 413345  39632]
 [ 23780  47283  54984]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6064264
{'0': {'precision': 0.49346418704383327, 'recall': 0.4656420233463035, 'f1-score': 0.4791495665752437, 'support': 25700}, '1': {'precision': 0.8352520305691593, 'recall': 0.8733258053386029, 'f1-score': 0.8538647018910455, 'support': 127524}, '2': {'precision': 0.5080242167980011, 'recall': 0.41996345726088335, 'f1-score': 0.4598156040706271, 'support': 25176}, 'accuracy': 0.7506165919282511, 'macro avg': {'precision': 0.6122468114703312, 'recall': 0.5863104286485966, 'f1-score': 0.5976099575123054, 'support': 178400}, 'weighted avg': {'precision': 0.7398359149968299, 'recall': 0.7506165919282511, 'f1-score': 0.7442752452523517, 'support': 178400}}
[[ 11967  11350   2383]
 [  8298 111370   7856]
 [  3986  10617  10573]]
testing model on single stock: results/universal/W1/deepVOL_L3/h10/AAPL
Evaluating performance on  test set...
21353/21353 - 317s - 317s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.037255
{'0': {'precision': 0.4566486421495759, 'recall': 0.6479218281022477, 'f1-score': 0.5357243036825136, 'support': 1805457}, '1': {'precision': 0.5958518211127781, 'recall': 0.28457732517841383, 'f1-score': 0.38518924133590443, 'support': 1836601}, '2': {'precision': 0.4766235976254892, 'recall': 0.5297180783034812, 'f1-score': 0.5017702083642734, 'support': 1824159}, 'accuracy': 0.48639488699405825, 'macro avg': {'precision': 0.5097080202959478, 'recall': 0.48740574386138097, 'f1-score': 0.4742279177942305, 'support': 5466217}, 'weighted avg': {'precision': 0.5100856338557198, 'recall': 0.48639488699405825, 'f1-score': 0.47381484882507374, 'support': 5466217}}
[[1169795  181452  454210]
 [ 707081  522655  606865]
 [ 684820  173049  966290]]
Evaluating performance on  train set...
6073/6073 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9457813
{'0': {'precision': 0.4334449902073554, 'recall': 0.5671436888415454, 'f1-score': 0.4913619268404157, 'support': 393343}, '1': {'precision': 0.6907097934114645, 'recall': 0.5390135220401023, 'f1-score': 0.6055051795412888, 'support': 765491}, '2': {'precision': 0.4531570966597441, 'recall': 0.5067396138683918, 'f1-score': 0.4784528369864632, 'support': 395720}, 'accuracy': 0.5379156980072741, 'macro avg': {'precision': 0.5257706267595214, 'recall': 0.5376322749166799, 'f1-score': 0.5251066477893892, 'support': 1554554}, 'weighted avg': {'precision': 0.5651447357516439, 'recall': 0.5379156980072741, 'f1-score': 0.5442820876172288, 'support': 1554554}}
[[223082  95643  74618]
 [185515 412610 167366]
 [106075  89118 200527]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9946621
{'0': {'precision': 0.4411610683025361, 'recall': 0.6043008379381833, 'f1-score': 0.5100023284436018, 'support': 126859}, '1': {'precision': 0.6619521364386576, 'recall': 0.4269429796461485, 'f1-score': 0.5190873084827821, 'support': 202910}, '2': {'precision': 0.4493215339233038, 'recall': 0.5379206428930186, 'f1-score': 0.4896454670790859, 'support': 127424}, 'accuracy': 0.5070856290450642, 'macro avg': {'precision': 0.5174782462214992, 'recall': 0.5230548201591169, 'f1-score': 0.50624503466849, 'support': 457193}, 'weighted avg': {'precision': 0.5414262841014681, 'recall': 0.5070856290450642, 'f1-score': 0.5083607473109905, 'support': 457193}}
[[76661 22624 27574]
 [59847 86631 56432]
 [37263 21617 68544]]
training model: results/universal/W1/deepVOL_L3/h20
Epoch 1/50
10622/10622 - 586s - loss: 2.8457 - accuracy20: 0.5195 - val_loss: 3.0510 - val_accuracy20: 0.5317 - 586s/epoch - 55ms/step
Epoch 2/50
10622/10622 - 590s - loss: 2.7189 - accuracy20: 0.5583 - val_loss: 3.0512 - val_accuracy20: 0.5295 - 590s/epoch - 56ms/step
Epoch 3/50
10622/10622 - 597s - loss: 2.6800 - accuracy20: 0.5666 - val_loss: 3.0519 - val_accuracy20: 0.5356 - 597s/epoch - 56ms/step
Epoch 4/50
10622/10622 - 590s - loss: 2.6603 - accuracy20: 0.5705 - val_loss: 3.0196 - val_accuracy20: 0.5345 - 590s/epoch - 55ms/step
Epoch 5/50
10622/10622 - 596s - loss: 2.6465 - accuracy20: 0.5732 - val_loss: 3.0168 - val_accuracy20: 0.5382 - 596s/epoch - 56ms/step
Epoch 6/50
10622/10622 - 644s - loss: 2.6366 - accuracy20: 0.5752 - val_loss: 3.0087 - val_accuracy20: 0.5391 - 644s/epoch - 61ms/step
Epoch 7/50
10622/10622 - 620s - loss: 2.6286 - accuracy20: 0.5767 - val_loss: 2.9961 - val_accuracy20: 0.5419 - 620s/epoch - 58ms/step
Epoch 8/50
10622/10622 - 605s - loss: 2.6216 - accuracy20: 0.5780 - val_loss: 2.9725 - val_accuracy20: 0.5452 - 605s/epoch - 57ms/step
Epoch 9/50
10622/10622 - 581s - loss: 2.6165 - accuracy20: 0.5792 - val_loss: 2.9808 - val_accuracy20: 0.5435 - 581s/epoch - 55ms/step
Epoch 10/50
10622/10622 - 578s - loss: 2.6111 - accuracy20: 0.5802 - val_loss: 2.9723 - val_accuracy20: 0.5472 - 578s/epoch - 54ms/step
Epoch 11/50
10622/10622 - 585s - loss: 2.6067 - accuracy20: 0.5809 - val_loss: 2.9335 - val_accuracy20: 0.5526 - 585s/epoch - 55ms/step
Epoch 12/50
10622/10622 - 581s - loss: 2.6028 - accuracy20: 0.5818 - val_loss: 2.9056 - val_accuracy20: 0.5566 - 581s/epoch - 55ms/step
Epoch 13/50
10622/10622 - 574s - loss: 2.5990 - accuracy20: 0.5824 - val_loss: 2.9521 - val_accuracy20: 0.5509 - 574s/epoch - 54ms/step
Epoch 14/50
10622/10622 - 579s - loss: 2.5956 - accuracy20: 0.5831 - val_loss: 2.9573 - val_accuracy20: 0.5501 - 579s/epoch - 55ms/step
Epoch 15/50
10622/10622 - 572s - loss: 2.5925 - accuracy20: 0.5836 - val_loss: 2.9179 - val_accuracy20: 0.5572 - 572s/epoch - 54ms/step
Epoch 16/50
10622/10622 - 573s - loss: 2.5897 - accuracy20: 0.5843 - val_loss: 2.9231 - val_accuracy20: 0.5559 - 573s/epoch - 54ms/step
Epoch 17/50
10622/10622 - 575s - loss: 2.5872 - accuracy20: 0.5847 - val_loss: 2.9226 - val_accuracy20: 0.5562 - 575s/epoch - 54ms/step
Epoch 18/50
10622/10622 - 575s - loss: 2.5843 - accuracy20: 0.5852 - val_loss: 2.9243 - val_accuracy20: 0.5570 - 575s/epoch - 54ms/step
Epoch 19/50
10622/10622 - 583s - loss: 2.5818 - accuracy20: 0.5858 - val_loss: 2.9539 - val_accuracy20: 0.5539 - 583s/epoch - 55ms/step
Epoch 20/50
10622/10622 - 576s - loss: 2.5799 - accuracy20: 0.5859 - val_loss: 2.9362 - val_accuracy20: 0.5544 - 576s/epoch - 54ms/step
Epoch 21/50
10622/10622 - 576s - loss: 2.5776 - accuracy20: 0.5864 - val_loss: 2.9320 - val_accuracy20: 0.5545 - 576s/epoch - 54ms/step
Epoch 22/50
10622/10622 - 577s - loss: 2.5755 - accuracy20: 0.5869 - val_loss: 2.9309 - val_accuracy20: 0.5570 - 577s/epoch - 54ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h20/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1070s - 1070s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9315835
{'0': {'precision': 0.5129909221213569, 'recall': 0.4394497515614384, 'f1-score': 0.4733811554011454, 'support': 2931912}, '1': {'precision': 0.5529666143598517, 'recall': 0.7153969370780104, 'f1-score': 0.6237811261147952, 'support': 3175138}, '2': {'precision': 0.5206600402823306, 'recall': 0.4299145057830121, 'f1-score': 0.4709558126197807, 'support': 2939731}, 'accuracy': 0.5332001515235087, 'macro avg': {'precision': 0.5288725255878464, 'recall': 0.5282537314741537, 'f1-score': 0.5227060313785737, 'support': 9046781}, 'weighted avg': {'precision': 0.5295132060036822, 'recall': 0.5332001515235087, 'f1-score': 0.5253787451351948, 'support': 9046781}}
[[1288428  931424  712060]
 [ 452180 2271484  451474]
 [ 770992  904906 1263833]]
Evaluating performance on  train set...
10622/10622 - 330s - 330s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8860546
{'0': {'precision': 0.5064750297671508, 'recall': 0.3826744581096691, 'f1-score': 0.43595606859096236, 'support': 735850}, '1': {'precision': 0.6078961778356891, 'recall': 0.8020903665759462, 'f1-score': 0.6916203137581103, 'support': 1247054}, '2': {'precision': 0.5163903516320733, 'recall': 0.36300077486711707, 'f1-score': 0.4263179195873277, 'support': 735610}, 'accuracy': 0.5697480314613057, 'macro avg': {'precision': 0.5435871864116377, 'recall': 0.5159218665175774, 'f1-score': 0.5179647673121335, 'support': 2718514}, 'weighted avg': {'precision': 0.5556825962172476, 'recall': 0.5697480314613057, 'f1-score': 0.5506279815566888, 'support': 2718514}}
[[ 281591  324634  129625]
 [ 126353 1000250  120451]
 [ 148038  320545  267027]]
Evaluating performance on  val set...
3064/3064 - 97s - 97s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.903061
{'0': {'precision': 0.5068160806835691, 'recall': 0.4066975104648601, 'f1-score': 0.4512704359842948, 'support': 222411}, '1': {'precision': 0.5968201645396104, 'recall': 0.760797498828681, 'f1-score': 0.6689059824188237, 'support': 339361}, '2': {'precision': 0.5059350789220739, 'recall': 0.39357494842481733, 'f1-score': 0.4427374160138634, 'support': 222006}, 'accuracy': 0.5562991051037411, 'macro avg': {'precision': 0.5365237747150844, 'recall': 0.5203566525727861, 'f1-score': 0.5209712781389939, 'support': 783778}, 'weighted avg': {'precision': 0.5455365962178245, 'recall': 0.5562991051037411, 'f1-score': 0.5430855099491325, 'support': 783778}}
[[ 90454  87777  44180]
 [ 40030 258185  41146]
 [ 47991  86639  87376]]
testing model out of sample: results/universal/W1/deepVOL_L3/h20/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 726s - 726s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77314323
{'0': {'precision': 0.5495676311764778, 'recall': 0.3783099136173053, 'f1-score': 0.4481343130756481, 'support': 1417182}, '1': {'precision': 0.6816067121923907, 'recall': 0.9161244035360087, 'f1-score': 0.781654105007169, 'support': 3274087}, '2': {'precision': 0.5964973425111092, 'recall': 0.30633548472328465, 'f1-score': 0.40478878712028, 'support': 1407927}, 'accuracy': 0.6503976917613403, 'macro avg': {'precision': 0.6092238952933259, 'recall': 0.5335899339588662, 'f1-score': 0.5448590684010324, 'support': 6099196}, 'weighted avg': {'precision': 0.6312802120373618, 'recall': 0.6503976917613403, 'f1-score': 0.6171640472707672, 'support': 6099196}}
[[ 536134  705153  175895]
 [ 158758 2999471  115858]
 [ 280664  695965  431298]]
Evaluating performance on  train set...
6711/6711 - 213s - 213s/epoch - 32ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77679706
{'0': {'precision': 0.5267854039361266, 'recall': 0.3924779356923842, 'f1-score': 0.4498202832134727, 'support': 386144}, '1': {'precision': 0.6950741170036825, 'recall': 0.8880036106387004, 'f1-score': 0.7797827166452416, 'support': 946093}, '2': {'precision': 0.5623961573112044, 'recall': 0.32263057700348796, 'f1-score': 0.4100355157708507, 'support': 385041}, 'accuracy': 0.6498149979211286, 'macro avg': {'precision': 0.5947518927503378, 'recall': 0.5343707077781908, 'f1-score': 0.5465461718765217, 'support': 1717278}, 'weighted avg': {'precision': 0.6274845181753567, 'recall': 0.6498149979211286, 'f1-score': 0.6226847710202739, 'support': 1717278}}
[[151553 184753  49838]
 [ 59136 840134  46823]
 [ 77005 183810 124226]]
Evaluating performance on  val set...
1720/1720 - 53s - 53s/epoch - 31ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7375012
{'0': {'precision': 0.540673294038298, 'recall': 0.39088586662709224, 'f1-score': 0.4537372569044968, 'support': 94337}, '1': {'precision': 0.7184859304198736, 'recall': 0.9075274276330925, 'f1-score': 0.8020176279551539, 'support': 252118}, '2': {'precision': 0.5612804992668897, 'recall': 0.31969635324096873, 'f1-score': 0.4073644574203934, 'support': 93398}, 'accuracy': 0.6719017489934137, 'macro avg': {'precision': 0.606813241241687, 'recall': 0.5393698825003844, 'f1-score': 0.554373114093348, 'support': 439853}, 'weighted avg': {'precision': 0.6469688928251429, 'recall': 0.6719017489934137, 'f1-score': 0.6435202613681091, 'support': 439853}}
[[ 36875  44747  12715]
 [ 12690 228804  10624]
 [ 18637  44902  29859]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0914448
{'0': {'precision': 0.42761587493114395, 'recall': 0.5403470392283598, 'f1-score': 0.4774169930812315, 'support': 60339}, '1': {'precision': 0.44159320625836523, 'recall': 0.1936842105263158, 'f1-score': 0.2692670297043635, 'support': 49400}, '2': {'precision': 0.44320445837687217, 'recall': 0.5306343725500008, 'f1-score': 0.4829947465913577, 'support': 59949}, 'accuracy': 0.4359942954127575, 'macro avg': {'precision': 0.43747117985546047, 'recall': 0.4215552074348921, 'f1-score': 0.4098929231256509, 'support': 169688}, 'weighted avg': {'precision': 0.43719227489197027, 'recall': 0.4359942954127575, 'f1-score': 0.4187904110858121, 'support': 169688}}
[[32604  6953 20782]
 [20650  9568 19182]
 [22992  5146 31811]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1543285
{'0': {'precision': 0.3709269804899417, 'recall': 0.5625223567887986, 'f1-score': 0.44706169028956666, 'support': 19569}, '1': {'precision': 0.49811234412538613, 'recall': 0.16575300746155017, 'f1-score': 0.24873603930417892, 'support': 26268}, '2': {'precision': 0.38573207614303506, 'recall': 0.5240742531180509, 'f1-score': 0.4443852349818614, 'support': 20686}, 'accuracy': 0.393893841227846, 'macro avg': {'precision': 0.41825713358612093, 'recall': 0.41744987245613324, 'f1-score': 0.380060988191869, 'support': 66523}, 'weighted avg': {'precision': 0.4257525797662182, 'recall': 0.393893841227846, 'f1-score': 0.3679163818311484, 'support': 66523}}
[[11008  2258  6303]
 [10953  4354 10961]
 [ 7716  2129 10841]]
Evaluating performance on  val set...
51/51 - 1s - 869ms/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1338125
{'0': {'precision': 0.3761969904240766, 'recall': 0.5620848237097599, 'f1-score': 0.4507273099774637, 'support': 3914}, '1': {'precision': 0.5347091932457786, 'recall': 0.22084463386284386, 'f1-score': 0.31258568686591726, 'support': 5162}, '2': {'precision': 0.36572837476885145, 'recall': 0.47202333598514984, 'f1-score': 0.4121324380643667, 'support': 3771}, 'accuracy': 0.39853662333618745, 'macro avg': {'precision': 0.4255448528129022, 'recall': 0.41831759785258454, 'f1-score': 0.39181514496924924, 'support': 12847}, 'weighted avg': {'precision': 0.4368152547137763, 'recall': 0.39853662333618745, 'f1-score': 0.3838923819408722, 'support': 12847}}
[[2200  546 1168]
 [2103 1140 1919]
 [1545  446 1780]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/QRTEA
Evaluating performance on  test set...
1645/1645 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5007518
{'0': {'precision': 0.5634225911689654, 'recall': 0.3727216393512682, 'f1-score': 0.44864837058566315, 'support': 46799}, '1': {'precision': 0.8593745782748811, 'recall': 0.9706991533820513, 'f1-score': 0.9116508926820259, 'support': 328011}, '2': {'precision': 0.6750217402424676, 'recall': 0.2856277056277056, 'f1-score': 0.4014053445679782, 'support': 46200}, 'accuracy': 0.8290515664711052, 'macro avg': {'precision': 0.699272969895438, 'recall': 0.5430161661203418, 'f1-score': 0.5872348692785557, 'support': 421010}, 'weighted avg': {'precision': 0.8062467234456199, 'recall': 0.8290515664711052, 'f1-score': 0.8041916889708156, 'support': 421010}}
[[ 17443  26564   2792]
 [  6050 318400   3561]
 [  7466  25538  13196]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6364676
{'0': {'precision': 0.5464893033461328, 'recall': 0.42148498096178255, 'f1-score': 0.4759156050955414, 'support': 28364}, '1': {'precision': 0.7922262796311197, 'recall': 0.9237458616365818, 'f1-score': 0.8529459537126889, 'support': 110853}, '2': {'precision': 0.5770936272646648, 'recall': 0.3288689938991372, 'f1-score': 0.4189757858670407, 'support': 27701}, 'accuracy': 0.739674570747313, 'macro avg': {'precision': 0.638603070080639, 'recall': 0.5580332788325005, 'f1-score': 0.5826124482250903, 'support': 166918}, 'weighted avg': {'precision': 0.7147662501642525, 'recall': 0.739674570747313, 'f1-score': 0.7168581954860802, 'support': 166918}}
[[ 11955  13537   2872]
 [  4649 102400   3804]
 [  5272  13319   9110]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5840925
{'0': {'precision': 0.6040312093628089, 'recall': 0.40216450216450217, 'f1-score': 0.48284823284823286, 'support': 6930}, '1': {'precision': 0.8163019263530337, 'recall': 0.9516040329972503, 'f1-score': 0.8787754814135572, 'support': 32730}, '2': {'precision': 0.61005396194263, 'recall': 0.3239819004524887, 'f1-score': 0.42320953600630484, 'support': 6630}, 'accuracy': 0.7794556059624109, 'macro avg': {'precision': 0.6767956992194909, 'recall': 0.559250145204747, 'f1-score': 0.5949444167560316, 'support': 46290}, 'weighted avg': {'precision': 0.7549828493864482, 'recall': 0.7794556059624109, 'f1-score': 0.754252300367807, 'support': 46290}}
[[ 2787  3544   599]
 [  810 31146   774]
 [ 1017  3465  2148]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0476098
{'0': {'precision': 0.5091043671354553, 'recall': 0.45702425715871514, 'f1-score': 0.48166059747235906, 'support': 127921}, '1': {'precision': 0.36690857038232993, 'recall': 0.5768737569349942, 'f1-score': 0.4485354712028568, 'support': 76424}, '2': {'precision': 0.5332174737341022, 'recall': 0.40933899332929047, 'f1-score': 0.4631376719613023, 'support': 131920}, 'accuracy': 0.4655554399060265, 'macro avg': {'precision': 0.4697434704172958, 'recall': 0.4810790024743333, 'f1-score': 0.46444458021217266, 'support': 336265}, 'weighted avg': {'precision': 0.48624688702730434, 'recall': 0.4655554399060265, 'f1-score': 0.46686542407209725, 'support': 336265}}
[[58463 37386 32072]
 [17137 44087 15200]
 [39235 38685 54000]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94459695
{'0': {'precision': 0.5330644244972162, 'recall': 0.4376705459803624, 'f1-score': 0.4806803191557485, 'support': 42877}, '1': {'precision': 0.5423969275304166, 'recall': 0.7979634002361276, 'f1-score': 0.6458157371622602, 'support': 47432}, '2': {'precision': 0.5529569799882892, 'recall': 0.3672927772312338, 'f1-score': 0.44139561738747907, 'support': 43709}, 'accuracy': 0.5422331328627498, 'macro avg': {'precision': 0.542806110671974, 'recall': 0.5343089078159079, 'f1-score': 0.5226305579018292, 'support': 134018}, 'weighted avg': {'precision': 0.5428552211948992, 'recall': 0.5422331328627498, 'f1-score': 0.5263130559321186, 'support': 134018}}
[[18766 15500  8611]
 [ 5215 37849  4368]
 [11223 16432 16054]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.032481
{'0': {'precision': 0.5258168841307015, 'recall': 0.45696840472959877, 'f1-score': 0.48898107337308794, 'support': 10318}, '1': {'precision': 0.3857858600853591, 'recall': 0.638611580402396, 'f1-score': 0.48099947943779275, 'support': 6511}, '2': {'precision': 0.5375084175084175, 'recall': 0.385939464268446, 'f1-score': 0.449285151412811, 'support': 10341}, 'accuracy': 0.4734633787265366, 'macro avg': {'precision': 0.4830370539081594, 'recall': 0.4938398164668136, 'f1-score': 0.47308856807456384, 'support': 27170}, 'weighted avg': {'precision': 0.4967097861954691, 'recall': 0.4734633787265366, 'f1-score': 0.47195995864714274, 'support': 27170}}
[[4715 3278 2325]
 [1244 4158 1109]
 [3008 3342 3991]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1414336
{'0': {'precision': 0.3565016805401029, 'recall': 0.5281913195073747, 'f1-score': 0.4256868609584754, 'support': 115869}, '1': {'precision': 0.3437566249735001, 'recall': 0.27313562732198504, 'f1-score': 0.30440382760149143, 'support': 106859}, '2': {'precision': 0.35590430770825776, 'recall': 0.24738544134470739, 'f1-score': 0.29188476806410985, 'support': 111013}, 'accuracy': 0.3531211328545189, 'macro avg': {'precision': 0.35205420440728696, 'recall': 0.3495707960580224, 'f1-score': 0.34065848554135886, 'support': 333741}, 'weighted avg': {'precision': 0.35222219422294904, 'recall': 0.3531211328545189, 'f1-score': 0.3423469195069422, 'support': 333741}}
[[61201 28279 26389]
 [54360 29187 23312]
 [56110 27440 27463]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1450149
{'0': {'precision': 0.3575528098844161, 'recall': 0.5318196638705279, 'f1-score': 0.4276129985580991, 'support': 33737}, '1': {'precision': 0.3552078279152515, 'recall': 0.2689011325374962, 'f1-score': 0.30608689592697125, 'support': 32670}, '2': {'precision': 0.3605468415188137, 'recall': 0.26423568579415185, 'f1-score': 0.3049680097148968, 'support': 31839}, 'accuracy': 0.3576735948537345, 'macro avg': {'precision': 0.35776915977282714, 'recall': 0.354985494067392, 'f1-score': 0.3462226347333224, 'support': 98246}, 'weighted avg': {'precision': 0.35774331547522875, 'recall': 0.3576735948537345, 'f1-score': 0.3474555206685396, 'support': 98246}}
[[17942  8306  7489]
 [16453  8785  7432]
 [15785  7641  8413]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1663064
{'0': {'precision': 0.35155041614495103, 'recall': 0.5873015873015873, 'f1-score': 0.43982676004423144, 'support': 8127}, '1': {'precision': 0.2956935403104657, 'recall': 0.15818376640771498, 'f1-score': 0.20610820244328099, 'support': 7466}, '2': {'precision': 0.3633349908834742, 'recall': 0.2736237673199351, 'f1-score': 0.31216177727143263, 'support': 8011}, 'accuracy': 0.3451109981359092, 'macro avg': {'precision': 0.3368596491129636, 'recall': 0.33970304034307913, 'f1-score': 0.31936557991964837, 'support': 23604}, 'weighted avg': {'precision': 0.33788234265105344, 'recall': 0.3451109981359092, 'f1-score': 0.3225726112541286, 'support': 23604}}
[[4773 1391 1963]
 [4407 1181 1878]
 [4397 1422 2192]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/PCAR
Evaluating performance on  test set...
2607/2607 - 40s - 40s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0134132
{'0': {'precision': 0.5044177484983531, 'recall': 0.5126826578439482, 'f1-score': 0.5085166230417627, 'support': 253890}, '1': {'precision': 0.4062185024049809, 'recall': 0.5768143773325121, 'f1-score': 0.4767138055204114, 'support': 165594}, '2': {'precision': 0.5500358937544867, 'recall': 0.3864575431347547, 'f1-score': 0.4539605121897462, 'support': 247828}, 'accuracy': 0.48171919581844774, 'macro avg': {'precision': 0.4868907148859402, 'recall': 0.49198485943707165, 'f1-score': 0.47973031358397344, 'support': 667312}, 'weighted avg': {'precision': 0.4969913089093021, 'recall': 0.48171919581844774, 'f1-score': 0.48036354381515783, 'support': 667312}}
[[130165  72553  51172]
 [ 42899  95517  27178]
 [ 84986  67067  95775]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98929226
{'0': {'precision': 0.49496842602910884, 'recall': 0.47241112579366357, 'f1-score': 0.48342678100263853, 'support': 62054}, '1': {'precision': 0.5050028246814388, 'recall': 0.6649804932883687, 'f1-score': 0.5740543857521032, 'support': 60492}, '2': {'precision': 0.5344003144173454, 'recall': 0.39390671773908004, 'f1-score': 0.45352209240917973, 'support': 62134}, 'accuracy': 0.5090751570283734, 'macro avg': {'precision': 0.5114571883759643, 'recall': 0.5104327789403708, 'f1-score': 0.5036677530546405, 'support': 184680}, 'weighted avg': {'precision': 0.5115217171076849, 'recall': 0.5090751570283734, 'f1-score': 0.5030507096653992, 'support': 184680}}
[[29315 20299 12440]
 [11382 40226  8884]
 [18529 19130 24475]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0069152
{'0': {'precision': 0.5155740136458025, 'recall': 0.4899454989663597, 'f1-score': 0.5024331486388822, 'support': 21284}, '1': {'precision': 0.43430981954534803, 'recall': 0.5907931650089263, 'f1-score': 0.5006077959966504, 'support': 15684}, '2': {'precision': 0.5325436635039584, 'recall': 0.41684011352885525, 'f1-score': 0.467641361742776, 'support': 21140}, 'accuracy': 0.49056928478006473, 'macro avg': {'precision': 0.49414249889836964, 'recall': 0.4991929258347138, 'f1-score': 0.4902274354594362, 'support': 58108}, 'weighted avg': {'precision': 0.4998135465454013, 'recall': 0.49056928478006473, 'f1-score': 0.4892830280733069, 'support': 58108}}
[[10428  6033  4823]
 [ 3506  9266  2912]
 [ 6292  6036  8812]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/EXC
Evaluating performance on  test set...
5343/5343 - 78s - 78s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5811125
{'0': {'precision': 0.6157075239339487, 'recall': 0.3934901928578272, 'f1-score': 0.480133611691023, 'support': 219177}, '1': {'precision': 0.7804735380678968, 'recall': 0.9614202225084298, 'f1-score': 0.8615485738727398, 'support': 927066}, '2': {'precision': 0.7042360325256367, 'recall': 0.27247163117366147, 'f1-score': 0.39292072263826106, 'support': 221546}, 'accuracy': 0.7588224499539037, 'macro avg': {'precision': 0.7001390315091607, 'recall': 0.5424606821799728, 'f1-score': 0.5782009694006746, 'support': 1367789}, 'weighted avg': {'precision': 0.7417226524541786, 'recall': 0.7588224499539037, 'f1-score': 0.7245245057630416, 'support': 1367789}}
[[ 86244 121007  11926]
 [ 22340 891300  13426]
 [ 31489 129692  60365]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.53694326
{'0': {'precision': 0.5856452360458188, 'recall': 0.3947691415054339, 'f1-score': 0.4716264313422291, 'support': 44811}, '1': {'precision': 0.8209765048237503, 'recall': 0.9577767464806988, 'f1-score': 0.884116113520012, 'support': 239181}, '2': {'precision': 0.6723668497731072, 'recall': 0.3047742773627801, 'f1-score': 0.41942789034564953, 'support': 46185}, 'accuracy': 0.7900247443038128, 'macro avg': {'precision': 0.6929961968808921, 'recall': 0.5524400551163043, 'f1-score': 0.5917234784026303, 'support': 330177}, 'weighted avg': {'precision': 0.7682503415727611, 'recall': 0.7900247443038128, 'f1-score': 0.7631334262481047, 'support': 330177}}
[[ 17690  24406   2715]
 [  5955 229082   4144]
 [  6561  25548  14076]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.54372245
{'0': {'precision': 0.5799457994579946, 'recall': 0.386676093958677, 'f1-score': 0.46398944193061836, 'support': 12729}, '1': {'precision': 0.8188669241838976, 'recall': 0.960637967035408, 'f1-score': 0.8841050802412348, 'support': 67527}, '2': {'precision': 0.6748394629305312, 'recall': 0.2755004766444233, 'f1-score': 0.3912675579624302, 'support': 12588}, 'accuracy': 0.7890547585196674, 'macro avg': {'precision': 0.6912173955241411, 'recall': 0.5409381792128362, 'f1-score': 0.5797873600447612, 'support': 92844}, 'weighted avg': {'precision': 0.7665830428464563, 'recall': 0.7890547585196674, 'f1-score': 0.7596868012948147, 'support': 92844}}
[[ 4922  7069   738]
 [ 1725 64869   933]
 [ 1840  7280  3468]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/AAL
Evaluating performance on  test set...
7177/7177 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6024376
{'0': {'precision': 0.6042600372703166, 'recall': 0.3186963000538981, 'f1-score': 0.4173012966285812, 'support': 283869}, '1': {'precision': 0.7756615276901206, 'recall': 0.9714338918169733, 'f1-score': 0.8625789847120063, 'support': 1272732}, '2': {'precision': 0.7085750990258002, 'recall': 0.23597444453951685, 'f1-score': 0.3540430812681533, 'support': 280488}, 'accuracy': 0.7582817163458058, 'macro avg': {'precision': 0.6961655546620792, 'recall': 0.5087015454701295, 'f1-score': 0.5446411208695804, 'support': 1837089}, 'weighted avg': {'precision': 0.7389335804392377, 'recall': 0.7582817163458058, 'f1-score': 0.7161305815460666, 'support': 1837089}}
[[  90468  179351   14050]
 [  23185 1236375   13172]
 [  36064  178236   66188]]
Evaluating performance on  train set...
2257/2257 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6122544
{'0': {'precision': 0.5641457653025777, 'recall': 0.35615281707129853, 'f1-score': 0.4366454700670852, 'support': 91194}, '1': {'precision': 0.7823299911554898, 'recall': 0.955428865620339, 'f1-score': 0.8602582033473498, 'support': 396243}, '2': {'precision': 0.6460498240363566, 'recall': 0.2586478510727995, 'f1-score': 0.36940384234501883, 'support': 90138}, 'accuracy': 0.75206683114747, 'macro avg': {'precision': 0.6641751934981414, 'recall': 0.5234098445881457, 'f1-score': 0.5554358385864846, 'support': 577575}, 'weighted avg': {'precision': 0.726612354491481, 'recall': 0.75206683114747, 'f1-score': 0.7167693577588313, 'support': 577575}}
[[ 32479  52490   6225]
 [ 11113 378582   6548]
 [ 13980  52844  23314]]
Evaluating performance on  val set...
638/638 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.5812103
{'0': {'precision': 0.6028893343471349, 'recall': 0.3595959595959596, 'f1-score': 0.45049325964567943, 'support': 24255}, '1': {'precision': 0.7940668058155631, 'recall': 0.9650783688128738, 'f1-score': 0.8712603243183688, 'support': 114714}, '2': {'precision': 0.6551578055496717, 'recall': 0.2539513116301983, 'f1-score': 0.36602467382621817, 'support': 24359}, 'accuracy': 0.7691026645768025, 'macro avg': {'precision': 0.6840379819041232, 'recall': 0.5262085466796772, 'f1-score': 0.5625927525967555, 'support': 163328}, 'weighted avg': {'precision': 0.7449589130602267, 'recall': 0.7691026645768025, 'f1-score': 0.7334227192293798, 'support': 163328}}
[[  8722  13909   1624]
 [  2374 110708   1632]
 [  3371  14802   6186]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/WBA
Evaluating performance on  test set...
5696/5696 - 83s - 83s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9599364
{'0': {'precision': 0.5040928807837771, 'recall': 0.33611834122213063, 'f1-score': 0.40331492480288983, 'support': 431836}, '1': {'precision': 0.5393634822072864, 'recall': 0.7907211287719373, 'f1-score': 0.6412916861812636, 'support': 607811}, '2': {'precision': 0.5199234457991958, 'recall': 0.3467399020500649, 'f1-score': 0.41602821930183037, 'support': 418377}, 'accuracy': 0.5286778544111757, 'macro avg': {'precision': 0.5211266029300864, 'recall': 0.49119312401471094, 'f1-score': 0.4868782767619946, 'support': 1458024}, 'weighted avg': {'precision': 0.5233387943087126, 'recall': 0.5286778544111757, 'f1-score': 0.5061690913479769, 'support': 1458024}}
[[145148 216463  70225]
 [ 63477 480609  63725]
 [ 79314 193995 145068]]
Evaluating performance on  train set...
2222/2222 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8211435
{'0': {'precision': 0.5579144551982517, 'recall': 0.3525066849803469, 'f1-score': 0.43203868281435387, 'support': 136874}, '1': {'precision': 0.6501086458441117, 'recall': 0.8886086435301487, 'f1-score': 0.7508749864839487, 'support': 296962}, '2': {'precision': 0.5533502990869976, 'recall': 0.3129697365394746, 'f1-score': 0.3998104400161126, 'support': 134783}, 'accuracy': 0.6231149504325392, 'macro avg': {'precision': 0.5871244667097869, 'recall': 0.5180283550166567, 'f1-score': 0.5275747031048051, 'support': 568619}, 'weighted avg': {'precision': 0.6049811212601186, 'recall': 0.6231149504325392, 'f1-score': 0.5909121062512332, 'support': 568619}}
[[ 48249  70546  18079]
 [ 17109 263883  15970]
 [ 21123  71477  42183]]
Evaluating performance on  val set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8388573
{'0': {'precision': 0.5245980056665562, 'recall': 0.3618987181114355, 'f1-score': 0.4283182118608424, 'support': 39395}, '1': {'precision': 0.6572434688569717, 'recall': 0.8509650990557304, 'f1-score': 0.7416630106453256, 'support': 86416}, '2': {'precision': 0.5076060202558205, 'recall': 0.33073929961089493, 'f1-score': 0.4005157675225648, 'support': 38036}, 'accuracy': 0.6126081039018109, 'macro avg': {'precision': 0.5631491649264495, 'recall': 0.5145343722593536, 'f1-score': 0.5234989966762443, 'support': 163847}, 'weighted avg': {'precision': 0.5906131490013758, 'recall': 0.6126081039018109, 'f1-score': 0.5871280183199731, 'support': 163847}}
[[14257 19349  5789]
 [ 6465 73537  6414]
 [ 6455 19001 12580]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/ATVI
Evaluating performance on  test set...
12066/12066 - 173s - 173s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7755063
{'0': {'precision': 0.5949578271709723, 'recall': 0.3245413889343035, 'f1-score': 0.4199860885260297, 'support': 691163}, '1': {'precision': 0.6644142122818184, 'recall': 0.9438347728600527, 'f1-score': 0.7798509346843229, 'support': 1709937}, '2': {'precision': 0.6503211112997227, 'recall': 0.2673822450860933, 'f1-score': 0.37895539458635147, 'support': 687742}, 'accuracy': 0.654646304343181, 'macro avg': {'precision': 0.6365643835841711, 'recall': 0.5119194689601497, 'f1-score': 0.526264139265568, 'support': 3088842}, 'weighted avg': {'precision': 0.6457346874119817, 'recall': 0.654646304343181, 'f1-score': 0.6100662816644004, 'support': 3088842}}
[[ 224311  408818   58034]
 [  55195 1613898   40844]
 [  97514  406338  183890]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78779167
{'0': {'precision': 0.5652108518678675, 'recall': 0.35274860662951013, 'f1-score': 0.434392474749664, 'support': 170450}, '1': {'precision': 0.6689939348553302, 'recall': 0.9112659927151648, 'f1-score': 0.7715584145750242, 'support': 415658}, '2': {'precision': 0.6062037647403501, 'recall': 0.29493270932566784, 'f1-score': 0.3968085276397168, 'support': 168374}, 'accuracy': 0.6475436127038153, 'macro avg': {'precision': 0.6134695171545159, 'recall': 0.5196491028901143, 'f1-score': 0.534253138988135, 'support': 754482}, 'weighted avg': {'precision': 0.6315350443872306, 'recall': 0.6475436127038153, 'f1-score': 0.6117559648067353, 'support': 754482}}
[[ 60126  94252  16072]
 [ 20696 378775  16187]
 [ 25556  93159  49659]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7188247
{'0': {'precision': 0.5772379332341059, 'recall': 0.3141526355378117, 'f1-score': 0.4068717449136348, 'support': 34566}, '1': {'precision': 0.7151321377519664, 'recall': 0.941043372377257, 'f1-score': 0.812680002197302, 'support': 110047}, '2': {'precision': 0.6150774852811802, 'recall': 0.26900879036315745, 'f1-score': 0.3743101886170826, 'support': 33787}, 'accuracy': 0.6923038116591929, 'macro avg': {'precision': 0.6358158520890841, 'recall': 0.5080682660927421, 'f1-score': 0.5312873119093398, 'support': 178400}, 'weighted avg': {'precision': 0.6694651107542375, 'recall': 0.6923038116591929, 'f1-score': 0.6510299511171331, 'support': 178400}}
[[ 10859  20934   2773]
 [  3573 103559   2915]
 [  4380  20318   9089]]
testing model on single stock: results/universal/W1/deepVOL_L3/h20/AAPL
Evaluating performance on  test set...
21353/21353 - 311s - 311s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0320647
{'0': {'precision': 0.5199920244583278, 'recall': 0.4616942155978267, 'f1-score': 0.4891121013078082, 'support': 2118231}, '1': {'precision': 0.34064866820567563, 'recall': 0.45772201717119176, 'f1-score': 0.3906015048239888, 'support': 1205391}, '2': {'precision': 0.5177133090176569, 'recall': 0.47499690795507316, 'f1-score': 0.4954360633871296, 'support': 2142595}, 'accuracy': 0.46603254133525984, 'macro avg': {'precision': 0.4594513338938868, 'recall': 0.4648043802413639, 'f1-score': 0.4583832231729755, 'support': 5466217}, 'weighted avg': {'precision': 0.4795506676943455, 'recall': 0.46603254133525984, 'f1-score': 0.4698676957390421, 'support': 5466217}}
[[ 977975  539423  600833]
 [ 306406  551734  347251]
 [ 596369  528500 1017726]]
Evaluating performance on  train set...
6073/6073 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99442333
{'0': {'precision': 0.5052801803346972, 'recall': 0.37718264290823955, 'f1-score': 0.4319341479506761, 'support': 492064}, '1': {'precision': 0.49102193837801894, 'recall': 0.6975843690737202, 'f1-score': 0.5763543856992247, 'support': 567388}, '2': {'precision': 0.5062532630568185, 'recall': 0.38974595133932, 'f1-score': 0.44042484961706707, 'support': 495102}, 'accuracy': 0.49812550738025185, 'macro avg': {'precision': 0.5008517939231782, 'recall': 0.48817098777375995, 'f1-score': 0.48290446108898927, 'support': 1554554}, 'weighted avg': {'precision': 0.5003860562415953, 'recall': 0.49812550738025185, 'f1-score': 0.48734944599249835, 'support': 1554554}}
[[185598 207732  98734]
 [ 82124 395801  89463]
 [ 99595 202543 192964]]
Evaluating performance on  val set...
1786/1786 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0177946
{'0': {'precision': 0.5116910884085812, 'recall': 0.41010114024350963, 'f1-score': 0.4552980428477942, 'support': 155230}, '1': {'precision': 0.43974978931738834, 'recall': 0.6036619795898693, 'f1-score': 0.5088311944604063, 'support': 145222}, '2': {'precision': 0.5049539084163981, 'recall': 0.42985562169438757, 'f1-score': 0.4643882400377708, 'support': 156741}, 'accuracy': 0.4783559678297787, 'macro avg': {'precision': 0.48546492871412256, 'recall': 0.4812062471759222, 'f1-score': 0.47617249244865706, 'support': 457193}, 'weighted avg': {'precision': 0.48653004774134445, 'recall': 0.4783559678297787, 'f1-score': 0.47541864386583443, 'support': 457193}}
[[63660 56425 35145]
 [26648 87665 30909]
 [34103 55262 67376]]
training model: results/universal/W1/deepVOL_L3/h30
Epoch 1/50
10622/10622 - 574s - loss: 2.9419 - accuracy30: 0.4920 - val_loss: 3.1489 - val_accuracy30: 0.4988 - 574s/epoch - 54ms/step
Epoch 2/50
10622/10622 - 572s - loss: 2.8167 - accuracy30: 0.5374 - val_loss: 3.1295 - val_accuracy30: 0.4952 - 572s/epoch - 54ms/step
Epoch 3/50
10622/10622 - 578s - loss: 2.7749 - accuracy30: 0.5452 - val_loss: 3.0888 - val_accuracy30: 0.4984 - 578s/epoch - 54ms/step
Epoch 4/50
10622/10622 - 573s - loss: 2.7544 - accuracy30: 0.5497 - val_loss: 3.0641 - val_accuracy30: 0.4983 - 573s/epoch - 54ms/step
Epoch 5/50
10622/10622 - 574s - loss: 2.7406 - accuracy30: 0.5524 - val_loss: 3.0648 - val_accuracy30: 0.4965 - 574s/epoch - 54ms/step
Epoch 6/50
10622/10622 - 571s - loss: 2.7310 - accuracy30: 0.5545 - val_loss: 3.0480 - val_accuracy30: 0.4974 - 571s/epoch - 54ms/step
Epoch 7/50
10622/10622 - 568s - loss: 2.7226 - accuracy30: 0.5560 - val_loss: 3.0391 - val_accuracy30: 0.4994 - 568s/epoch - 53ms/step
Epoch 8/50
10622/10622 - 568s - loss: 2.7164 - accuracy30: 0.5574 - val_loss: 3.0154 - val_accuracy30: 0.5049 - 568s/epoch - 53ms/step
Epoch 9/50
10622/10622 - 574s - loss: 2.7112 - accuracy30: 0.5582 - val_loss: 3.0232 - val_accuracy30: 0.5032 - 574s/epoch - 54ms/step
Epoch 10/50
10622/10622 - 574s - loss: 2.7063 - accuracy30: 0.5592 - val_loss: 2.9997 - val_accuracy30: 0.5096 - 574s/epoch - 54ms/step
Epoch 11/50
10622/10622 - 569s - loss: 2.7014 - accuracy30: 0.5604 - val_loss: 2.9916 - val_accuracy30: 0.5121 - 569s/epoch - 54ms/step
Epoch 12/50
10622/10622 - 575s - loss: 2.6981 - accuracy30: 0.5611 - val_loss: 2.9844 - val_accuracy30: 0.5141 - 575s/epoch - 54ms/step
Epoch 13/50
10622/10622 - 564s - loss: 2.6947 - accuracy30: 0.5615 - val_loss: 2.9665 - val_accuracy30: 0.5175 - 564s/epoch - 53ms/step
Epoch 14/50
10622/10622 - 567s - loss: 2.6920 - accuracy30: 0.5621 - val_loss: 2.9632 - val_accuracy30: 0.5207 - 567s/epoch - 53ms/step
Epoch 15/50
10622/10622 - 566s - loss: 2.6897 - accuracy30: 0.5625 - val_loss: 2.9712 - val_accuracy30: 0.5227 - 566s/epoch - 53ms/step
Epoch 16/50
10622/10622 - 571s - loss: 2.6871 - accuracy30: 0.5630 - val_loss: 2.9683 - val_accuracy30: 0.5230 - 571s/epoch - 54ms/step
Epoch 17/50
10622/10622 - 570s - loss: 2.6846 - accuracy30: 0.5638 - val_loss: 2.9580 - val_accuracy30: 0.5232 - 570s/epoch - 54ms/step
Epoch 18/50
10622/10622 - 569s - loss: 2.6825 - accuracy30: 0.5642 - val_loss: 2.9665 - val_accuracy30: 0.5250 - 569s/epoch - 54ms/step
Epoch 19/50
10622/10622 - 566s - loss: 2.6807 - accuracy30: 0.5646 - val_loss: 2.9510 - val_accuracy30: 0.5281 - 566s/epoch - 53ms/step
Epoch 20/50
10622/10622 - 571s - loss: 2.6781 - accuracy30: 0.5648 - val_loss: 2.9591 - val_accuracy30: 0.5265 - 571s/epoch - 54ms/step
Epoch 21/50
10622/10622 - 572s - loss: 2.6767 - accuracy30: 0.5654 - val_loss: 2.9501 - val_accuracy30: 0.5290 - 572s/epoch - 54ms/step
Epoch 22/50
10622/10622 - 566s - loss: 2.6751 - accuracy30: 0.5658 - val_loss: 2.9399 - val_accuracy30: 0.5303 - 566s/epoch - 53ms/step
Epoch 23/50
10622/10622 - 578s - loss: 2.6735 - accuracy30: 0.5661 - val_loss: 2.9322 - val_accuracy30: 0.5299 - 578s/epoch - 54ms/step
Epoch 24/50
10622/10622 - 576s - loss: 2.6719 - accuracy30: 0.5665 - val_loss: 2.9485 - val_accuracy30: 0.5282 - 576s/epoch - 54ms/step
Epoch 25/50
10622/10622 - 582s - loss: 2.6704 - accuracy30: 0.5668 - val_loss: 2.9576 - val_accuracy30: 0.5278 - 582s/epoch - 55ms/step
Epoch 26/50
10622/10622 - 576s - loss: 2.6692 - accuracy30: 0.5671 - val_loss: 2.9315 - val_accuracy30: 0.5291 - 576s/epoch - 54ms/step
Epoch 27/50
10622/10622 - 575s - loss: 2.6679 - accuracy30: 0.5674 - val_loss: 2.9115 - val_accuracy30: 0.5320 - 575s/epoch - 54ms/step
Epoch 28/50
10622/10622 - 572s - loss: 2.6666 - accuracy30: 0.5677 - val_loss: 2.9369 - val_accuracy30: 0.5289 - 572s/epoch - 54ms/step
Epoch 29/50
10622/10622 - 569s - loss: 2.6650 - accuracy30: 0.5680 - val_loss: 2.9392 - val_accuracy30: 0.5278 - 569s/epoch - 54ms/step
Epoch 30/50
10622/10622 - 574s - loss: 2.6642 - accuracy30: 0.5681 - val_loss: 2.9236 - val_accuracy30: 0.5303 - 574s/epoch - 54ms/step
Epoch 31/50
10622/10622 - 574s - loss: 2.6625 - accuracy30: 0.5687 - val_loss: 2.9355 - val_accuracy30: 0.5303 - 574s/epoch - 54ms/step
Epoch 32/50
10622/10622 - 591s - loss: 2.6617 - accuracy30: 0.5687 - val_loss: 2.9272 - val_accuracy30: 0.5289 - 591s/epoch - 56ms/step
Epoch 33/50
10622/10622 - 607s - loss: 2.6607 - accuracy30: 0.5689 - val_loss: 2.9501 - val_accuracy30: 0.5268 - 607s/epoch - 57ms/step
Epoch 34/50
10622/10622 - 605s - loss: 2.6595 - accuracy30: 0.5692 - val_loss: 2.9380 - val_accuracy30: 0.5285 - 605s/epoch - 57ms/step
Epoch 35/50
10622/10622 - 592s - loss: 2.6585 - accuracy30: 0.5694 - val_loss: 2.9450 - val_accuracy30: 0.5265 - 592s/epoch - 56ms/step
Epoch 36/50
10622/10622 - 562s - loss: 2.6573 - accuracy30: 0.5699 - val_loss: 2.9335 - val_accuracy30: 0.5279 - 562s/epoch - 53ms/step
Epoch 37/50
10622/10622 - 574s - loss: 2.6564 - accuracy30: 0.5701 - val_loss: 2.9339 - val_accuracy30: 0.5282 - 574s/epoch - 54ms/step
testing model in sample: results/universal/W1/deepVOL_L3/h30/TICKERS_in_sample
Evaluating performance on  test set...
35341/35341 - 1050s - 1050s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9684773
{'0': {'precision': 0.48761285603535187, 'recall': 0.44348344862476186, 'f1-score': 0.4645023933743704, 'support': 3087538}, '1': {'precision': 0.5677130228104817, 'recall': 0.6100045654302831, 'f1-score': 0.5880994547868186, 'support': 2869390}, '2': {'precision': 0.492618024771797, 'recall': 0.5030880109830468, 'f1-score': 0.49779797120333974, 'support': 3089853}, 'accuracy': 0.5166568086482916, 'macro avg': {'precision': 0.5159813012058769, 'recall': 0.5188586750126972, 'f1-score': 0.5167999397881763, 'support': 9046781}, 'weighted avg': {'precision': 0.5147278987426641, 'recall': 0.5166568086482916, 'f1-score': 0.5150758087237459, 'support': 9046781}}
[[1369272  692772 1025494]
 [ 543487 1750341  575562]
 [ 895354  640031 1554468]]
Evaluating performance on  train set...
10622/10622 - 328s - 328s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9411798
{'0': {'precision': 0.4826066197285116, 'recall': 0.4116006636442947, 'f1-score': 0.4442844710683689, 'support': 793196}, '1': {'precision': 0.598988953407741, 'recall': 0.702643273075148, 'f1-score': 0.6466889036629199, 'support': 1131022}, '2': {'precision': 0.4853686054493574, 'recall': 0.4370826492894337, 'f1-score': 0.4599618567634689, 'support': 794296}, 'accuracy': 0.5401325871413574, 'macro avg': {'precision': 0.5223213928618701, 'recall': 0.5171088620029588, 'f1-score': 0.5169784104982525, 'support': 2718514}, 'weighted avg': {'precision': 0.531833812971833, 'recall': 0.5401325871413574, 'f1-score': 0.5330742845142549, 'support': 2718514}}
[[326480 272573 194143]
 [162356 794705 173961]
 [187657 259466 347173]]
Evaluating performance on  val set...
3064/3064 - 93s - 93s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95536697
{'0': {'precision': 0.48515030527412806, 'recall': 0.4273856485887122, 'f1-score': 0.4544396897566194, 'support': 238541}, '1': {'precision': 0.6026809213511698, 'recall': 0.6476478103554211, 'f1-score': 0.6243557700594674, 'support': 307607}, '2': {'precision': 0.4768287114171819, 'recall': 0.48776669612422674, 'f1-score': 0.4822356883865773, 'support': 237630}, 'accuracy': 0.5321379268109082, 'macro avg': {'precision': 0.5215533126808266, 'recall': 0.5209333850227867, 'f1-score': 0.5203437160675547, 'support': 783778}, 'weighted avg': {'precision': 0.5287542082560751, 'recall': 0.5321379268109082, 'f1-score': 0.5295534832901903, 'support': 783778}}
[[101949  68395  68197]
 [ 49410 199221  58976]
 [ 58780  62942 115908]]
testing model out of sample: results/universal/W1/deepVOL_L3/h30/TICKERS_out_of_sample
Evaluating performance on  test set...
23827/23827 - 725s - 725s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8458589
{'0': {'precision': 0.533912532490347, 'recall': 0.3784943416728673, 'f1-score': 0.44296657164307596, 'support': 1593934}, '1': {'precision': 0.6394632334882059, 'recall': 0.8619065353314722, 'f1-score': 0.7342062581704701, 'support': 2924121}, '2': {'precision': 0.5410621815843516, 'recall': 0.3517586350616422, 'f1-score': 0.4263415254867421, 'support': 1581141}, 'accuracy': 0.6033244381718509, 'macro avg': {'precision': 0.5714793158543015, 'recall': 0.5307198373553272, 'f1-score': 0.534504785100096, 'support': 6099196}, 'weighted avg': {'precision': 0.586369876814206, 'recall': 0.6033244381718509, 'f1-score': 0.5782849875955226, 'support': 6099196}}
[[ 603295  712343  278296]
 [ 210337 2520319  193465]
 [ 316319  708642  556180]]
Evaluating performance on  train set...
6711/6711 - 211s - 211s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84420073
{'0': {'precision': 0.5242206826813692, 'recall': 0.39933836020624086, 'f1-score': 0.45333631762977455, 'support': 436189}, '1': {'precision': 0.6564478670315073, 'recall': 0.839301575152838, 'f1-score': 0.7366978897223102, 'support': 846648}, '2': {'precision': 0.5282991425303618, 'recall': 0.3678750394184711, 'f1-score': 0.4337283349548618, 'support': 434441}, 'accuracy': 0.6082882328894914, 'macro avg': {'precision': 0.5696558974144127, 'recall': 0.5355049915925166, 'f1-score': 0.5412541807689821, 'support': 1717278}, 'weighted avg': {'precision': 0.5904427686516851, 'recall': 0.6082882328894914, 'f1-score': 0.5880780406866875, 'support': 1717278}}
[[174187 185849  76153]
 [ 69510 710593  66545]
 [ 88581 186040 159820]]
Evaluating performance on  val set...
1720/1720 - 53s - 53s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80761576
{'0': {'precision': 0.5279513134198597, 'recall': 0.4009394365267258, 'f1-score': 0.4557618904661835, 'support': 106021}, '1': {'precision': 0.6893390289190204, 'recall': 0.8571952337305224, 'f1-score': 0.7641578260302835, 'support': 229110}, '2': {'precision': 0.517631886511103, 'recall': 0.3679456083726438, 'f1-score': 0.43013825553552393, 'support': 104722}, 'accuracy': 0.6307379965579409, 'macro avg': {'precision': 0.578307409616661, 'recall': 0.5420267595432974, 'f1-score': 0.5500193240106637, 'support': 439853}, 'weighted avg': {'precision': 0.6095578239433163, 'recall': 0.6307379965579409, 'f1-score': 0.6102981434868117, 'support': 439853}}
[[ 42508  43930  19583]
 [ 16394 196392  16324]
 [ 21613  44577  38532]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/LILAK
Evaluating performance on  test set...
663/663 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.138346
{'0': {'precision': 0.4247401908801697, 'recall': 0.6146774911373367, 'f1-score': 0.502354807758637, 'support': 65161}, '1': {'precision': 0.39802525089025576, 'recall': 0.0619286271941975, 'f1-score': 0.10718099596818131, 'support': 39707}, '2': {'precision': 0.4348649039156191, 'recall': 0.46431656896019746, 'f1-score': 0.4491084085652466, 'support': 64820}, 'accuracy': 0.42789708170289004, 'macro avg': {'precision': 0.4192101152286815, 'recall': 0.38030756243057723, 'f1-score': 0.35288140409735497, 'support': 169688}, 'weighted avg': {'precision': 0.422356485354607, 'recall': 0.42789708170289004, 'f1-score': 0.3895442487298359, 'support': 169688}}
[[40053  2098 23010]
 [21145  2459 16103]
 [33102  1621 30097]]
Evaluating performance on  train set...
260/260 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2704802
{'0': {'precision': 0.37654090399701157, 'recall': 0.5532888116366298, 'f1-score': 0.44811617826843997, 'support': 21862}, '1': {'precision': 0.47584789311408016, 'recall': 0.04281091077207582, 'f1-score': 0.07855446216491348, 'support': 21630}, '2': {'precision': 0.38421717560780205, 'recall': 0.541400720767661, 'f1-score': 0.44946290822579477, 'support': 23031}, 'accuracy': 0.3831907761225441, 'macro avg': {'precision': 0.41220199090629794, 'recall': 0.37916681439212213, 'f1-score': 0.32537784955304944, 'support': 66523}, 'weighted avg': {'precision': 0.4114882513215506, 'recall': 0.3831907761225441, 'f1-score': 0.32841918051320584, 'support': 66523}}
[[12096   518  9248]
 [ 9968   926 10736]
 [10060   502 12469]]
Evaluating performance on  val set...
51/51 - 1s - 822ms/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.27309
{'0': {'precision': 0.3716721507627879, 'recall': 0.5731088560885609, 'f1-score': 0.450916349119942, 'support': 4336}, '1': {'precision': 0.48932676518883417, 'recall': 0.06894956038870893, 'f1-score': 0.12086797809774893, 'support': 4322}, '2': {'precision': 0.3640129682997118, 'recall': 0.4824540463117689, 'f1-score': 0.4149471306847346, 'support': 4189}, 'accuracy': 0.3739394411146571, 'macro avg': {'precision': 0.4083372947504446, 'recall': 0.3748374875963463, 'f1-score': 0.3289104859674752, 'support': 12847}, 'weighted avg': {'precision': 0.40875621149381824, 'recall': 0.3739394411146571, 'f1-score': 0.32815273772560855, 'support': 12847}}
[[2485  173 1678]
 [2171  298 1853]
 [2030  138 2021]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/QRTEA
Evaluating performance on  test set...
1645/1645 - 24s - 24s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.58910227
{'0': {'precision': 0.5403177156645887, 'recall': 0.38009017770312087, 'f1-score': 0.4462574865838342, 'support': 56555}, '1': {'precision': 0.8252821899862787, 'recall': 0.9462504127362308, 'f1-score': 0.8816361738962583, 'support': 308914}, '2': {'precision': 0.6356540396567032, 'recall': 0.3093750562647414, 'f1-score': 0.41618931127608305, 'support': 55541}, 'accuracy': 0.7861784755706516, 'macro avg': {'precision': 0.6670846484358569, 'recall': 0.5452385489013644, 'f1-score': 0.5813609905853918, 'support': 421010}, 'weighted avg': {'precision': 0.7619860617643408, 'recall': 0.7861784755706516, 'f1-score': 0.7617477487810799, 'support': 421010}}
[[ 21496  31244   3815]
 [ 10570 292310   6034]
 [  7718  30640  17183]]
Evaluating performance on  train set...
653/653 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7096671
{'0': {'precision': 0.5525534441805225, 'recall': 0.44993804587627306, 'f1-score': 0.49599387003814566, 'support': 33089}, '1': {'precision': 0.7616657403052717, 'recall': 0.8778692159858079, 'f1-score': 0.8156494665995148, 'support': 101465}, '2': {'precision': 0.537756741499848, 'recall': 0.38264738598442716, 'f1-score': 0.4471323091365335, 'support': 32364}, 'accuracy': 0.6970188955055776, 'macro avg': {'precision': 0.6173253086618807, 'recall': 0.5701515492821693, 'f1-score': 0.586258548591398, 'support': 166918}, 'weighted avg': {'precision': 0.6767982748203596, 'recall': 0.6970188955055776, 'f1-score': 0.6808301342402062, 'support': 166918}}
[[14888 13721  4480]
 [ 6227 89073  6165]
 [ 5829 14151 12384]]
Evaluating performance on  val set...
181/181 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.66295576
{'0': {'precision': 0.6075061381971238, 'recall': 0.4217190163136109, 'f1-score': 0.4978442081057775, 'support': 8214}, '1': {'precision': 0.7767437984388456, 'recall': 0.9256488347457628, 'f1-score': 0.8446840968477654, 'support': 30208}, '2': {'precision': 0.5925038134669862, 'recall': 0.3455770208439248, 'f1-score': 0.436541703459902, 'support': 7868}, 'accuracy': 0.7376323179952473, 'macro avg': {'precision': 0.6589179167009852, 'recall': 0.5643149573010995, 'f1-score': 0.5930233361378149, 'support': 46290}, 'weighted avg': {'precision': 0.7153975391391245, 'recall': 0.7376323179952473, 'f1-score': 0.7137658164999062, 'support': 46290}}
[[ 3464  3988   762]
 [ 1138 27962  1108]
 [ 1100  4049  2719]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/XRAY
Evaluating performance on  test set...
1314/1314 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.04612
{'0': {'precision': 0.4888790715851358, 'recall': 0.43691915203790316, 'f1-score': 0.46144100076179784, 'support': 131704}, '1': {'precision': 0.369463061397427, 'recall': 0.4119567084693352, 'f1-score': 0.3895544815822605, 'support': 69852}, '2': {'precision': 0.49243991384274166, 'recall': 0.5142418101240451, 'f1-score': 0.5031047780900711, 'support': 134709}, 'accuracy': 0.46270947020950737, 'macro avg': {'precision': 0.4502606822751016, 'recall': 0.4543725568770945, 'f1-score': 0.4513667534780432, 'support': 336265}, 'weighted avg': {'precision': 0.4654993869793873, 'recall': 0.46270947020950737, 'f1-score': 0.4631987473080793, 'support': 336265}}
[[57544 25294 48866]
 [18542 28776 22534]
 [41620 23816 69273]]
Evaluating performance on  train set...
524/524 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96598893
{'0': {'precision': 0.5151150587452326, 'recall': 0.4488357569809974, 'f1-score': 0.4796967927249324, 'support': 44836}, '1': {'precision': 0.5378044922492882, 'recall': 0.6977380518059102, 'f1-score': 0.6074200528018738, 'support': 43856}, '2': {'precision': 0.5119175886263895, 'recall': 0.4297754048449014, 'f1-score': 0.46726393936123, 'support': 45326}, 'accuracy': 0.5238400811831246, 'macro avg': {'precision': 0.5216123798736367, 'recall': 0.5254497378772697, 'f1-score': 0.5181269282960121, 'support': 134018}, 'weighted avg': {'precision': 0.5214585295114519, 'recall': 0.5238400811831246, 'f1-score': 0.5172880101910278, 'support': 134018}}
[[20124 13023 11689]
 [ 6372 30600  6884]
 [12571 13275 19480]]
Evaluating performance on  val set...
107/107 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0295974
{'0': {'precision': 0.49776927979604846, 'recall': 0.44132605010359766, 'f1-score': 0.4678514376996805, 'support': 10618}, '1': {'precision': 0.38411739318083726, 'recall': 0.45664443304258595, 'f1-score': 0.4172526957337084, 'support': 5847}, '2': {'precision': 0.4958815363257751, 'recall': 0.5005137786081271, 'f1-score': 0.49818688981868897, 'support': 10705}, 'accuracy': 0.46794258373205744, 'macro avg': {'precision': 0.4592560697675536, 'recall': 0.4661614205847702, 'f1-score': 0.4610970077506926, 'support': 27170}, 'weighted avg': {'precision': 0.4725675545517195, 'recall': 0.46794258373205744, 'f1-score': 0.46891474909677094, 'support': 27170}}
[[4686 2254 3678]
 [1408 2670 1769]
 [3320 2027 5358]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/CHTR
Evaluating performance on  test set...
1304/1304 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2931452
{'0': {'precision': 0.34718011825794637, 'recall': 0.8986559395043291, 'f1-score': 0.5008612062661174, 'support': 115843}, '1': {'precision': 0.2588953401816287, 'recall': 0.01628917739185822, 'f1-score': 0.030649922890504517, 'support': 106758}, '2': {'precision': 0.3607522726436274, 'recall': 0.08819506928198668, 'f1-score': 0.14173854574111966, 'support': 111140}, 'accuracy': 0.34650822044639407, 'macro avg': {'precision': 0.3222759103610675, 'recall': 0.3343800620593913, 'f1-score': 0.2244165582992472, 'support': 333741}, 'weighted avg': {'precision': 0.32345903784095553, 'recall': 0.34650822044639407, 'f1-score': 0.23085629622700943, 'support': 333741}}
[[104103   2459   9281]
 [ 96931   1739   8088]
 [ 98819   2519   9802]]
Evaluating performance on  train set...
384/384 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2998636
{'0': {'precision': 0.3445480481525294, 'recall': 0.8812588989084006, 'f1-score': 0.4954059597458686, 'support': 33712}, '1': {'precision': 0.32271584241408213, 'recall': 0.02366318377381684, 'f1-score': 0.04409322567714597, 'support': 32540}, '2': {'precision': 0.35592692547228566, 'recall': 0.1071763455647934, 'f1-score': 0.16474488325165754, 'support': 31994}, 'accuracy': 0.34513364411782665, 'macro avg': {'precision': 0.34106360534629904, 'recall': 0.3373661427490036, 'f1-score': 0.23474802289155736, 'support': 98246}, 'weighted avg': {'precision': 0.3410225695197017, 'recall': 0.34513364411782665, 'f1-score': 0.2382465145984629, 'support': 98246}}
[[29709   831  3172]
 [28737   770  3033]
 [27780   785  3429]]
Evaluating performance on  val set...
93/93 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.3167853
{'0': {'precision': 0.34658274272686723, 'recall': 0.864293659621802, 'f1-score': 0.49476439790575916, 'support': 8091}, '1': {'precision': 0.2551546391752577, 'recall': 0.013214095034703685, 'f1-score': 0.025126903553299496, 'support': 7492}, '2': {'precision': 0.34781178019085224, 'recall': 0.13177907991522253, 'f1-score': 0.1911392405063291, 'support': 8021}, 'accuracy': 0.34523809523809523, 'macro avg': {'precision': 0.31651638736432575, 'recall': 0.3364289448572428, 'f1-score': 0.23701018065512927, 'support': 23604}, 'weighted avg': {'precision': 0.3179807582195789, 'recall': 0.34523809523809523, 'f1-score': 0.24252318899246242, 'support': 23604}}
[[6993  158  940]
 [6351   99 1042]
 [6833  131 1057]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/PCAR
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661527
{'0': {'precision': 0.4623636395992383, 'recall': 0.5276587448262976, 'f1-score': 0.492857982935037, 'support': 246197}, '1': {'precision': 0.4576734953010292, 'recall': 0.28606639839034204, 'f1-score': 0.35207203365055556, 'support': 178920}, '2': {'precision': 0.46022425085787977, 'recall': 0.5216375234831437, 'f1-score': 0.48901025528876024, 'support': 242195}, 'accuracy': 0.4606975447766562, 'macro avg': {'precision': 0.46008712858604905, 'recall': 0.4451208888999278, 'f1-score': 0.444646757291451, 'support': 667312}, 'weighted avg': {'precision': 0.46032964369619916, 'recall': 0.4606975447766562, 'f1-score': 0.45371389075136664, 'support': 667312}}
[[129908  31874  84415]
 [ 63976  51183  63761]
 [ 87081  28776 126338]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.048631
{'0': {'precision': 0.46072566234169837, 'recall': 0.4790602985846313, 'f1-score': 0.4697141318209542, 'support': 61892}, '1': {'precision': 0.5324599102595657, 'recall': 0.46447563996696944, 'f1-score': 0.4961497411108857, 'support': 60550}, '2': {'precision': 0.4624477824193405, 'recall': 0.5015906680805938, 'f1-score': 0.4812245652978172, 'support': 62238}, 'accuracy': 0.4818713450292398, 'macro avg': {'precision': 0.48521111834020153, 'recall': 0.4817088688773981, 'f1-score': 0.48236281274321896, 'support': 184680}, 'weighted avg': {'precision': 0.4848251318068227, 'recall': 0.4818713450292398, 'f1-score': 0.4822604958085996, 'support': 184680}}
[[29650 12854 19388]
 [15526 28124 16900]
 [19179 11841 31218]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0520458
{'0': {'precision': 0.47903743786019093, 'recall': 0.5149193739064643, 'f1-score': 0.4963307352203838, 'support': 21147}, '1': {'precision': 0.4785372144436256, 'recall': 0.3234744707347447, 'f1-score': 0.3860157527121415, 'support': 16060}, '2': {'precision': 0.4591166755026304, 'recall': 0.5386345150949715, 'f1-score': 0.4957069261591299, 'support': 20901}, 'accuracy': 0.47053761960487367, 'macro avg': {'precision': 0.472230442602149, 'recall': 0.4590094532453935, 'f1-score': 0.4593511380305517, 'support': 58108}, 'weighted avg': {'precision': 0.47173384038470717, 'recall': 0.47053761960487367, 'f1-score': 0.465617290388835, 'support': 58108}}
[[10889  2866  7392]
 [ 4994  5195  5871]
 [ 6848  2795 11258]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/EXC
Evaluating performance on  test set...
5343/5343 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67337745
{'0': {'precision': 0.6295547043332536, 'recall': 0.39203452748334006, 'f1-score': 0.48318281624665815, 'support': 268308}, '1': {'precision': 0.7147253306894431, 'recall': 0.9548919075423442, 'f1-score': 0.8175352035939245, 'support': 828920}, '2': {'precision': 0.7071099195710456, 'recall': 0.24370844282804988, 'f1-score': 0.36248491661879384, 'support': 270561}, 'accuracy': 0.7038022677474377, 'macro avg': {'precision': 0.6837966515312474, 'recall': 0.5302116259512447, 'f1-score': 0.5544009788197922, 'support': 1367789}, 'weighted avg': {'precision': 0.696511707342581, 'recall': 0.7038022677474377, 'f1-score': 0.6619349750216457, 'support': 1367789}}
[[105186 148493  14629]
 [ 24708 791529  12683]
 [ 37186 167437  65938]]
Evaluating performance on  train set...
1290/1290 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.61042875
{'0': {'precision': 0.6043546808741981, 'recall': 0.4065500027428822, 'f1-score': 0.48610002732987156, 'support': 54687}, '1': {'precision': 0.7712311133698608, 'recall': 0.9479861563926368, 'f1-score': 0.8505224228638756, 'support': 219307}, '2': {'precision': 0.6883291351805205, 'recall': 0.29183204884039654, 'f1-score': 0.4098846293264003, 'support': 56183}, 'accuracy': 0.7466570960424257, 'macro avg': {'precision': 0.6879716431415265, 'recall': 0.5487894026586385, 'f1-score': 0.5821690265067158, 'support': 330177}, 'weighted avg': {'precision': 0.7294848581658279, 'recall': 0.7466570960424257, 'f1-score': 0.7151843445032264, 'support': 330177}}
[[ 22233  29112   3342]
 [  7325 207900   4082]
 [  7230  32557  16396]]
Evaluating performance on  val set...
363/363 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.62386286
{'0': {'precision': 0.5774046934421668, 'recall': 0.40192407024793386, 'f1-score': 0.4739426700673798, 'support': 15488}, '1': {'precision': 0.7699982910252534, 'recall': 0.9438580659716067, 'f1-score': 0.8481096969433706, 'support': 62057}, '2': {'precision': 0.6646646646646647, 'recall': 0.26040917707039674, 'f1-score': 0.37420748602827214, 'support': 15299}, 'accuracy': 0.7408340872862005, 'macro avg': {'precision': 0.6706892163773617, 'recall': 0.5353971044299791, 'f1-score': 0.5654199510130075, 'support': 92844}, 'weighted avg': {'precision': 0.7205132538762993, 'recall': 0.7408340872862005, 'f1-score': 0.7076016529443461, 'support': 92844}}
[[ 6225  8332   931]
 [ 2405 58573  1079]
 [ 2151  9164  3984]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/AAL
Evaluating performance on  test set...
7177/7177 - 104s - 104s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68987095
{'0': {'precision': 0.593464200964705, 'recall': 0.3355892662419861, 'f1-score': 0.42873789888849057, 'support': 342061}, '1': {'precision': 0.7232483633552388, 'recall': 0.9474985257003031, 'f1-score': 0.8203238473562284, 'support': 1158177}, '2': {'precision': 0.6534368299032292, 'recall': 0.2451588387744136, 'f1-score': 0.35654704338214976, 'support': 336851}, 'accuracy': 0.7047807700116869, 'macro avg': {'precision': 0.6567164647410576, 'recall': 0.5094155435722343, 'f1-score': 0.535202929875623, 'support': 1837089}, 'weighted avg': {'precision': 0.686282171066073, 'recall': 0.7047807700116869, 'f1-score': 0.6623728927131517, 'support': 1837089}}
[[ 114792  206027   21242]
 [  38249 1097371   22557]
 [  40386  213883   82582]]
Evaluating performance on  train set...
2257/2257 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6853349
{'0': {'precision': 0.5669086069453783, 'recall': 0.38139105552222274, 'f1-score': 0.4560032667836528, 'support': 108335}, '1': {'precision': 0.7410135546285926, 'recall': 0.9266464300582561, 'f1-score': 0.8234982806166014, 'support': 362709}, '2': {'precision': 0.6003912363067293, 'recall': 0.2881039321887526, 'f1-score': 0.389366385243354, 'support': 106531}, 'accuracy': 0.7065974115915682, 'macro avg': {'precision': 0.6361044659602334, 'recall': 0.5320471392564105, 'f1-score': 0.5562893108812027, 'support': 577575}, 'weighted avg': {'precision': 0.6824197863726822, 'recall': 0.7065974115915682, 'f1-score': 0.6744941213825626, 'support': 577575}}
[[ 41318  57119   9898]
 [ 16076 336103  10530]
 [ 15489  60350  30692]]
Evaluating performance on  val set...
638/638 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6518745
{'0': {'precision': 0.5970486859112452, 'recall': 0.3835455300304456, 'f1-score': 0.46705426356589147, 'support': 28904}, '1': {'precision': 0.7559247458655742, 'recall': 0.9444849909481247, 'f1-score': 0.8397500452969159, 'support': 105503}, '2': {'precision': 0.6248840803709428, 'recall': 0.279589225822067, 'f1-score': 0.3863261747211008, 'support': 28921}, 'accuracy': 0.7274808973354232, 'macro avg': {'precision': 0.6592858373825874, 'recall': 0.5358732489335458, 'f1-score': 0.5643768278613027, 'support': 163328}, 'weighted avg': {'precision': 0.7046048207842032, 'recall': 0.7274808973354232, 'f1-score': 0.6935052456540092, 'support': 163328}}
[[11086 15352  2466]
 [ 3469 99646  2388]
 [ 4013 16822  8086]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/WBA
Evaluating performance on  test set...
5696/5696 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99765015
{'0': {'precision': 0.5117402594213664, 'recall': 0.3435177573251413, 'f1-score': 0.41108498910806995, 'support': 485349}, '1': {'precision': 0.4822609617895814, 'recall': 0.7521763597366941, 'f1-score': 0.5877095391663968, 'support': 499343}, '2': {'precision': 0.5244069801331624, 'recall': 0.39153701841413635, 'f1-score': 0.4483347142675706, 'support': 473332}, 'accuracy': 0.49906380141890666, 'macro avg': {'precision': 0.5061360671147034, 'recall': 0.4957437118253239, 'f1-score': 0.48237641418067917, 'support': 1458024}, 'weighted avg': {'precision': 0.5057563272848634, 'recall': 0.49906380141890666, 'f1-score': 0.48366796415441476, 'support': 1458024}}
[[166726 215122 103501]
 [ 59174 375594  64575]
 [ 99902 188103 185327]]
Evaluating performance on  train set...
2222/2222 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8769032
{'0': {'precision': 0.5566739313298157, 'recall': 0.3719479092819324, 'f1-score': 0.44593761605580634, 'support': 156573}, '1': {'precision': 0.6047081656725533, 'recall': 0.8423058099699364, 'f1-score': 0.7040003895692826, 'support': 257454}, '2': {'precision': 0.5400789433733111, 'recall': 0.3681949906851584, 'f1-score': 0.43787309988306977, 'support': 154592}, 'accuracy': 0.58389185025474, 'macro avg': {'precision': 0.5671536801252267, 'recall': 0.5274829033123424, 'f1-score': 0.5292703685027196, 'support': 568619}, 'weighted avg': {'precision': 0.5739106986385113, 'recall': 0.58389185025474, 'f1-score': 0.560588346347905, 'support': 568619}}
[[ 58237  71659  26677]
 [ 18804 216855  21795]
 [ 27575  70097  56920]]
Evaluating performance on  val set...
641/641 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90042216
{'0': {'precision': 0.52301775147929, 'recall': 0.3891346936978582, 'f1-score': 0.44625074152141264, 'support': 45429}, '1': {'precision': 0.6177664654283851, 'recall': 0.7883921021194347, 'f1-score': 0.6927272834490119, 'support': 74501}, '2': {'precision': 0.50044324973548, 'recall': 0.39847894892638386, 'f1-score': 0.44367821920239336, 'support': 43917}, 'accuracy': 0.573181077468614, 'macro avg': {'precision': 0.547075822214385, 'recall': 0.5253352482478922, 'f1-score': 0.5275520813909393, 'support': 163847}, 'weighted avg': {'precision': 0.5600490645020406, 'recall': 0.573181077468614, 'f1-score': 0.5576337475420521, 'support': 163847}}
[[17678 18712  9039]
 [ 7335 58736  8430]
 [ 8787 17630 17500]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/ATVI
Evaluating performance on  test set...
12066/12066 - 167s - 167s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85305166
{'0': {'precision': 0.5891318365672079, 'recall': 0.32306682278060017, 'f1-score': 0.41729715054557653, 'support': 808811}, '1': {'precision': 0.6015892759546291, 'recall': 0.9074184498448356, 'f1-score': 0.7235128076508888, 'support': 1477465}, '2': {'precision': 0.5943284398650497, 'recall': 0.3086151170121834, 'f1-score': 0.4062684530292493, 'support': 802566}, 'accuracy': 0.5988208526043093, 'macro avg': {'precision': 0.5950165174622956, 'recall': 0.5130334632125397, 'f1-score': 0.5156928037419048, 'support': 3088842}, 'weighted avg': {'precision': 0.596440739970772, 'recall': 0.5988208526043093, 'f1-score': 0.5609016658215963, 'support': 3088842}}
[[ 261300  447114  100397]
 [  68121 1340679   68665]
 [ 114113  440769  247684]]
Evaluating performance on  train set...
2948/2948 - 50s - 50s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8563672
{'0': {'precision': 0.5732451678535097, 'recall': 0.35631624377709975, 'f1-score': 0.43946868365509006, 'support': 199264}, '1': {'precision': 0.6090122745190578, 'recall': 0.8797439529704976, 'f1-score': 0.7197617123609427, 'support': 357903}, '2': {'precision': 0.5802073615096199, 'recall': 0.3340952284418316, 'f1-score': 0.42402704119537005, 'support': 197315}, 'accuracy': 0.5988028872789543, 'macro avg': {'precision': 0.5874882679607291, 'recall': 0.5233851417298095, 'f1-score': 0.5277524790704676, 'support': 754482}, 'weighted avg': {'precision': 0.5920327598943737, 'recall': 0.5988028872789543, 'f1-score': 0.5683926979734848, 'support': 754482}}
[[ 71001 102068  26195]
 [ 21539 314863  21501]
 [ 31318 100075  65922]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8028909
{'0': {'precision': 0.5751951431049436, 'recall': 0.3233859957089916, 'f1-score': 0.41400836506648353, 'support': 41016}, '1': {'precision': 0.6574579067037196, 'recall': 0.9086446630655794, 'f1-score': 0.7629073978272115, 'support': 97378}, '2': {'precision': 0.5672993544657482, 'recall': 0.29435584662300657, 'f1-score': 0.3875979198209466, 'support': 40006}, 'accuracy': 0.6363340807174888, 'macro avg': {'precision': 0.5999841347581372, 'recall': 0.5087955017991925, 'f1-score': 0.5215045609048805, 'support': 178400}, 'weighted avg': {'precision': 0.6183268946375778, 'recall': 0.6363340807174888, 'f1-score': 0.5985291819929478, 'support': 178400}}
[[13264 23334  4418]
 [ 4332 88482  4564]
 [ 5464 22766 11776]]
testing model on single stock: results/universal/W1/deepVOL_L3/h30/AAPL
Evaluating performance on  test set...
21353/21353 - 352s - 352s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0438795
{'0': {'precision': 0.49202855096995873, 'recall': 0.4498323604673273, 'f1-score': 0.46998524264561226, 'support': 2161483}, '1': {'precision': 0.346147451470101, 'recall': 0.25713156012457183, 'f1-score': 0.29507220546055385, 'support': 1125455}, '2': {'precision': 0.480859781068404, 'recall': 0.5856230432175045, 'f1-score': 0.528095834152296, 'support': 2179279}, 'accuracy': 0.464293861732895, 'macro avg': {'precision': 0.43967859450282126, 'recall': 0.43086232126980123, 'f1-score': 0.43105109408615405, 'support': 5466217}, 'weighted avg': {'precision': 0.4575398948225898, 'recall': 0.464293861732895, 'f1-score': 0.4571395103014672, 'support': 5466217}}
[[ 972305  295324  893854]
 [ 352084  289390  483981]
 [ 651726  251317 1276236]]
Evaluating performance on  train set...
6073/6073 - 102s - 102s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0370315
{'0': {'precision': 0.47726927963289534, 'recall': 0.39088394304405644, 'f1-score': 0.42977873730965155, 'support': 515135}, '1': {'precision': 0.48297875278796293, 'recall': 0.5377698671423299, 'f1-score': 0.5089037881571431, 'support': 520256}, '2': {'precision': 0.46556628151981816, 'recall': 0.49625262200888737, 'f1-score': 0.48041993576027114, 'support': 519163}, 'accuracy': 0.475230837912353, 'macro avg': {'precision': 0.4752714379802255, 'recall': 0.47496881073175795, 'f1-score': 0.47303415374235525, 'support': 1554554}, 'weighted avg': {'precision': 0.4752716803577227, 'recall': 0.475230837912353, 'f1-score': 0.47317145249672876, 'support': 1554554}}
[[201358 157163 156614]
 [101346 279778 139132]
 [119192 142335 257636]]
Evaluating performance on  val set...
1786/1786 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0530983
{'0': {'precision': 0.48370925525980807, 'recall': 0.41928725072682077, 'f1-score': 0.4492002404093601, 'support': 161319}, '1': {'precision': 0.43750761804929184, 'recall': 0.4037600581931623, 'f1-score': 0.4199569442927788, 'support': 133349}, '2': {'precision': 0.4660209165397126, 'recall': 0.5571204430087678, 'f1-score': 0.5075149724932109, 'support': 162525}, 'accuracy': 0.46375600676300816, 'macro avg': {'precision': 0.4624125966162709, 'recall': 0.4600559173095837, 'f1-score': 0.4588907190651166, 'support': 457193}, 'weighted avg': {'precision': 0.4639457431962624, 'recall': 0.46375600676300816, 'f1-score': 0.4614008592685243, 'support': 457193}}
[[67639 37256 56424]
 [32182 53841 47326]
 [40013 31966 90546]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        83 (peak)  23.56 (ave)

============================================
