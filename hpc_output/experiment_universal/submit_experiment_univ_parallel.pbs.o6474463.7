This machine has 1 visible gpus.
This machine has 1 physical gpus.
training model: results/universal/W2/deepLOB_L1/h50
Epoch 1/50
9940/9940 - 248s - loss: 3.0683 - accuracy50: 0.4653 - val_loss: 3.6529 - val_accuracy50: 0.4063 - 248s/epoch - 25ms/step
Epoch 2/50
9940/9940 - 212s - loss: 3.0135 - accuracy50: 0.4813 - val_loss: 3.7378 - val_accuracy50: 0.4198 - 212s/epoch - 21ms/step
Epoch 3/50
9940/9940 - 215s - loss: 2.9913 - accuracy50: 0.4873 - val_loss: 3.7989 - val_accuracy50: 0.4166 - 215s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 214s - loss: 2.9772 - accuracy50: 0.4908 - val_loss: 3.8546 - val_accuracy50: 0.4205 - 214s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 218s - loss: 2.9691 - accuracy50: 0.4927 - val_loss: 3.9325 - val_accuracy50: 0.4164 - 218s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 215s - loss: 2.9630 - accuracy50: 0.4938 - val_loss: 3.9265 - val_accuracy50: 0.4234 - 215s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 218s - loss: 2.9583 - accuracy50: 0.4952 - val_loss: 3.9275 - val_accuracy50: 0.4220 - 218s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 214s - loss: 2.9550 - accuracy50: 0.4959 - val_loss: 3.9681 - val_accuracy50: 0.4238 - 214s/epoch - 21ms/step
Epoch 9/50
9940/9940 - 216s - loss: 2.9512 - accuracy50: 0.4966 - val_loss: 4.0148 - val_accuracy50: 0.4243 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 216s - loss: 2.9478 - accuracy50: 0.4976 - val_loss: 3.9963 - val_accuracy50: 0.4235 - 216s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 217s - loss: 2.9447 - accuracy50: 0.4984 - val_loss: 4.0217 - val_accuracy50: 0.4256 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 330s - 330s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1263354
{'0': {'precision': 0.3368008358063378, 'recall': 0.5863081512673822, 'f1-score': 0.4278348020701332, 'support': 1771565}, '1': {'precision': 0.5232598943624335, 'recall': 0.4951086702433691, 'f1-score': 0.5087951837746545, 'support': 3144237}, '2': {'precision': 0.4700985155420017, 'recall': 0.17234387110678479, 'f1-score': 0.25222058710255446, 'support': 1804967}, 'accuracy': 0.43246494560369503, 'macro avg': {'precision': 0.4433864152369243, 'recall': 0.41792023087251207, 'f1-score': 0.39628352431578073, 'support': 6720769}, 'weighted avg': {'precision': 0.45983279598778204, 'recall': 0.43246494560369503, 'f1-score': 0.4185472882368342, 'support': 6720769}}
[[1038683  644906   87976]
 [1324826 1556739  262672]
 [ 720459  773433  311075]]
Evaluating performance on  train set...
9940/9940 - 125s - 125s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2089647
{'0': {'precision': 0.3779304650408422, 'recall': 0.520850557983411, 'f1-score': 0.4380272581481527, 'support': 787389}, '1': {'precision': 0.4040474044192583, 'recall': 0.5161573219520751, 'f1-score': 0.4532731037562041, 'support': 957832}, '2': {'precision': 0.47627015450903254, 'recall': 0.14010844147629706, 'f1-score': 0.21652104568382502, 'support': 798403}, 'accuracy': 0.3995743867804361, 'macro avg': {'precision': 0.41941600798971096, 'recall': 0.392372107137261, 'f1-score': 0.36927380252939396, 'support': 2543624}, 'weighted avg': {'precision': 0.41863237042040247, 'recall': 0.3995743867804361, 'f1-score': 0.3742409965938877, 'support': 2543624}}
[[410112 338428  38849]
 [379279 494392  84161]
 [295761 390779 111863]]
Evaluating performance on  val set...
3393/3393 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2013769
{'0': {'precision': 0.3751542618834844, 'recall': 0.5357225600376767, 'f1-score': 0.441286015295404, 'support': 263293}, '1': {'precision': 0.4230910251038056, 'recall': 0.5255973806643577, 'f1-score': 0.46880626605128234, 'support': 338101}, '2': {'precision': 0.4675322873749775, 'recall': 0.12637377059015423, 'f1-score': 0.1989668811618159, 'support': 266693}, 'accuracy': 0.40601921236005145, 'macro avg': {'precision': 0.42192585812075584, 'recall': 0.39589790376406286, 'f1-score': 0.36968638750283406, 'support': 868087}, 'weighted avg': {'precision': 0.42220489198617756, 'recall': 0.40601921236005145, 'f1-score': 0.3775594619215189, 'support': 868087}}
[[141052 111123  11118]
 [133130 177705  27266]
 [101802 131188  33703]]
testing model out of sample: results/universal/W2/deepLOB_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 181s - 181s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1640614
{'0': {'precision': 0.41072052936657255, 'recall': 0.5747537139495387, 'f1-score': 0.479085376913369, 'support': 1201753}, '1': {'precision': 0.4285036110073465, 'recall': 0.4418683968718276, 'f1-score': 0.43508339407875374, 'support': 1246095}, '2': {'precision': 0.4889388842464628, 'recall': 0.2808214064493369, 'f1-score': 0.3567461372104536, 'support': 1218885}, 'accuracy': 0.43188609587881094, 'macro avg': {'precision': 0.442721008206794, 'recall': 0.4324811724235677, 'f1-score': 0.4236383027341921, 'support': 3666733}, 'weighted avg': {'precision': 0.4427650192721466, 'recall': 0.43188609587881094, 'f1-score': 0.4234641699736797, 'support': 3666733}}
[[690712 349457 161584]
 [499293 550610 196192]
 [491703 384893 342289]]
Evaluating performance on  train set...
5373/5373 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1236038
{'0': {'precision': 0.3940103888928713, 'recall': 0.5451293054443507, 'f1-score': 0.45741141798209384, 'support': 413401}, '1': {'precision': 0.48986614682926466, 'recall': 0.4835173309000244, 'f1-score': 0.4866710340424313, 'support': 544663}, '2': {'precision': 0.4721913383660409, 'recall': 0.3005724183596112, 'f1-score': 0.3673249198500643, 'support': 416828}, 'accuracy': 0.4465790767565743, 'macro avg': {'precision': 0.45202262469605897, 'recall': 0.4430730182346621, 'f1-score': 0.43713579062486313, 'support': 1374892}, 'weighted avg': {'precision': 0.45568584666839995, 'recall': 0.4465790767565743, 'f1-score': 0.4416909507882299, 'support': 1374892}}
[[225357 134164  53880]
 [195145 263354  86164]
 [151455 140086 125287]]
Evaluating performance on  val set...
1685/1685 - 22s - 22s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1325045
{'0': {'precision': 0.3997110463550212, 'recall': 0.6072770564381116, 'f1-score': 0.48210171894382414, 'support': 134395}, '1': {'precision': 0.4762361614299961, 'recall': 0.4661415377011707, 'f1-score': 0.4711347834367264, 'support': 161865}, '2': {'precision': 0.48560680645967114, 'recall': 0.24586346457161562, 'f1-score': 0.3264465463166473, 'support': 134412}, 'accuracy': 0.441435709774492, 'macro avg': {'precision': 0.4538513380815628, 'recall': 0.439760686236966, 'f1-score': 0.4265610162323992, 'support': 430672}, 'weighted avg': {'precision': 0.45528038603532783, 'recall': 0.441435709774492, 'f1-score': 0.4294001593369296, 'support': 430672}}
[[81615 38798 13982]
 [65389 75452 21024]
 [57181 44184 33047]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2964542
{'0': {'precision': 0.33035959845984597, 'recall': 0.4902931197224419, 'f1-score': 0.39474197689345314, 'support': 78398}, '1': {'precision': 0.3523888114275958, 'recall': 0.4202239565659993, 'f1-score': 0.38332843235881325, 'support': 88410}, '2': {'precision': 0.4343947385557075, 'recall': 0.15570623315088636, 'f1-score': 0.22924201682116133, 'support': 85687}, 'accuracy': 0.35221291510722985, 'macro avg': {'precision': 0.3723810494810498, 'recall': 0.3554077698131091, 'f1-score': 0.33577080869114256, 'support': 252495}, 'weighted avg': {'precision': 0.3733785167270309, 'recall': 0.35221291510722985, 'f1-score': 0.33458131410400394, 'support': 252495}}
[[38438 31961  7999]
 [41885 37152  9373]
 [36029 36316 13342]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2967281
{'0': {'precision': 0.3525194118618867, 'recall': 0.5425650935720098, 'f1-score': 0.4273668609425384, 'support': 19664}, '1': {'precision': 0.3437529378584187, 'recall': 0.3645926812244491, 'f1-score': 0.35386625375012093, 'support': 20058}, '2': {'precision': 0.406, 'recall': 0.17552961521833116, 'f1-score': 0.24509507998792635, 'support': 20817}, 'accuracy': 0.3573894514280051, 'macro avg': {'precision': 0.3674241165734351, 'recall': 0.36089579667159666, 'f1-score': 0.3421093982268619, 'support': 60539}, 'weighted avg': {'precision': 0.36800475961638457, 'recall': 0.3573894514280051, 'f1-score': 0.3403382208395029, 'support': 60539}}
[[10669  6568  2427]
 [ 9826  7313  2919]
 [ 9770  7393  3654]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2849586
{'0': {'precision': 0.367007992007992, 'recall': 0.4225129384703853, 'f1-score': 0.392809409248864, 'support': 6956}, '1': {'precision': 0.38038167235180237, 'recall': 0.5632764505119454, 'f1-score': 0.45410521681708127, 'support': 7325}, '2': {'precision': 0.4145719489981785, 'recall': 0.15548572209318212, 'f1-score': 0.22615262321144672, 'support': 7319}, 'accuracy': 0.3797685185185185, 'macro avg': {'precision': 0.38732053778599096, 'recall': 0.38042503702517094, 'f1-score': 0.357689083092464, 'support': 21600}, 'weighted avg': {'precision': 0.3876599739399173, 'recall': 0.3797685185185185, 'f1-score': 0.35712564875948133, 'support': 21600}}
[[2939 3206  811]
 [2403 4126  796]
 [2666 3515 1138]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0565398
{'0': {'precision': 0.3717242244058893, 'recall': 0.6524992759918911, 'f1-score': 0.47362667855070756, 'support': 86325}, '1': {'precision': 0.578408195429472, 'recall': 0.45994887241602755, 'f1-score': 0.5124214117133734, 'support': 140433}, '2': {'precision': 0.5319608776878274, 'recall': 0.31902110038334375, 'f1-score': 0.3988492093463976, 'support': 91041}, 'accuracy': 0.47188002479554686, 'macro avg': {'precision': 0.4940310991743962, 'recall': 0.47715641626375405, 'f1-score': 0.46163243320349284, 'support': 317799}, 'weighted avg': {'precision': 0.5089598835936014, 'recall': 0.47188002479554686, 'f1-score': 0.46934801558576145, 'support': 317799}}
[[56327 21589  8409]
 [58696 64592 17145]
 [36506 25491 29044]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.019506
{'0': {'precision': 0.3384649743169806, 'recall': 0.7163384276035922, 'f1-score': 0.459716885743175, 'support': 31735}, '1': {'precision': 0.6886181956604491, 'recall': 0.45807132306393755, 'f1-score': 0.5501685379020199, 'support': 71085}, '2': {'precision': 0.49772760592288523, 'recall': 0.31734903720321556, 'f1-score': 0.3875791997260118, 'support': 32094}, 'accuracy': 0.48534622055531673, 'macro avg': {'precision': 0.5082702586334383, 'recall': 0.4972529292902484, 'f1-score': 0.4658215411237356, 'support': 134914}, 'weighted avg': {'precision': 0.5608437981451998, 'recall': 0.48534622055531673, 'f1-score': 0.49021460131514427, 'support': 134914}}
[[22733  6854  2148]
 [30393 32562  8130]
 [14039  7870 10185]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0369972
{'0': {'precision': 0.37283466652540126, 'recall': 0.6631489682464902, 'f1-score': 0.4773143438453713, 'support': 10613}, '1': {'precision': 0.6131455399061033, 'recall': 0.4895786474733843, 'f1-score': 0.5444388861097215, 'support': 20007}, '2': {'precision': 0.47954030994253877, 'recall': 0.2760902255639098, 'f1-score': 0.35042626288331846, 'support': 9975}, 'accuracy': 0.4824978445621382, 'macro avg': {'precision': 0.4885068387913478, 'recall': 0.4762726137612614, 'f1-score': 0.45739316427947035, 'support': 40595}, 'weighted avg': {'precision': 0.5174901274642768, 'recall': 0.4824978445621382, 'f1-score': 0.47921733952184326, 'support': 40595}}
[[7038 2978  597]
 [7820 9795 2392]
 [4019 3202 2754]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2733411
{'0': {'precision': 0.3745740460424842, 'recall': 0.5656328202017138, 'f1-score': 0.450690973750766, 'support': 92309}, '1': {'precision': 0.33761020046147483, 'recall': 0.31479523945728816, 'f1-score': 0.3258037943727958, 'support': 80411}, '2': {'precision': 0.4404859382049697, 'recall': 0.2597223453834255, 'f1-score': 0.3267714583230029, 'support': 101493}, 'accuracy': 0.37885147677170666, 'macro avg': {'precision': 0.38422339490297625, 'recall': 0.3800501350141425, 'f1-score': 0.36775540881552155, 'support': 274213}, 'weighted avg': {'precision': 0.3881302811014806, 'recall': 0.37885147677170666, 'f1-score': 0.36820303058150733, 'support': 274213}}
[[52213 23358 16738]
 [38353 25313 16745]
 [48827 26306 26360]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2854822
{'0': {'precision': 0.37199858275871467, 'recall': 0.5571930111038537, 'f1-score': 0.4461405200451076, 'support': 24496}, '1': {'precision': 0.3455297238258699, 'recall': 0.36431685448712675, 'f1-score': 0.35467467467467473, 'support': 24314}, '2': {'precision': 0.41992716406760666, 'recall': 0.1856270123008338, 'f1-score': 0.25744954916273083, 'support': 24226}, 'accuracy': 0.36973547291746534, 'macro avg': {'precision': 0.37915182355073035, 'recall': 0.3690456259639381, 'f1-score': 0.3527549146275044, 'support': 73036}, 'weighted avg': {'precision': 0.37908486862727303, 'recall': 0.36973547291746534, 'f1-score': 0.35310245628294695, 'support': 73036}}
[[13649  8135  2712]
 [11956  8858  3500]
 [11086  8643  4497]]
Evaluating performance on  val set...
117/117 - 1s - 1s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2928407
{'0': {'precision': 0.36451570160328606, 'recall': 0.5770925110132159, 'f1-score': 0.4468085106382979, 'support': 9534}, '1': {'precision': 0.36844147027446417, 'recall': 0.37106856807970306, 'f1-score': 0.3697503528152221, 'support': 10238}, '2': {'precision': 0.41757493188010897, 'recall': 0.18322207831025206, 'f1-score': 0.25469150335849317, 'support': 10037}, 'accuracy': 0.37371263712301656, 'macro avg': {'precision': 0.38351070125261977, 'recall': 0.3771277191343903, 'f1-score': 0.3570834556040044, 'support': 29809}, 'weighted avg': {'precision': 0.3837296139768643, 'recall': 0.37371263712301656, 'f1-score': 0.3556548381950743, 'support': 29809}}
[[5502 2917 1115]
 [4989 3799 1450]
 [4603 3595 1839]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/CHTR
Evaluating performance on  test set...
860/860 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3260568
{'0': {'precision': 0.3521379456631255, 'recall': 0.540544573932627, 'f1-score': 0.4264590190254475, 'support': 73709}, '1': {'precision': 0.32075734615317625, 'recall': 0.2713315357527001, 'f1-score': 0.29398148148148157, 'support': 67869}, '2': {'precision': 0.38279304270354547, 'recall': 0.2412398233927979, 'f1-score': 0.29596173866758513, 'support': 78366}, 'accuracy': 0.3508302113265195, 'macro avg': {'precision': 0.35189611150661576, 'recall': 0.351038644359375, 'f1-score': 0.33880074639150476, 'support': 219944}, 'weighted avg': {'precision': 0.3533771130263125, 'recall': 0.35083021132651954, 'f1-score': 0.3390837422818415, 'support': 219944}}
[[39843 19387 14479]
 [33451 18415 16003]
 [39852 19609 18905]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3436486
{'0': {'precision': 0.38113237262776595, 'recall': 0.5124042770935526, 'f1-score': 0.4371255682331336, 'support': 28337}, '1': {'precision': 0.3251119251119251, 'recall': 0.3002443149783875, 'f1-score': 0.3121836834391793, 'support': 26605}, '2': {'precision': 0.3661845911122798, 'recall': 0.2603964098728497, 'f1-score': 0.30436017921538633, 'support': 26740}, 'accuracy': 0.3608016454053525, 'macro avg': {'precision': 0.3574762962839903, 'recall': 0.35768166731492995, 'f1-score': 0.35122314362923307, 'support': 81682}, 'weighted avg': {'precision': 0.3579922966761115, 'recall': 0.3608016454053525, 'f1-score': 0.3529671814737776, 'support': 81682}}
[[14520  8418  5399]
 [11964  7988  6653]
 [11613  8164  6963]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3320367
{'0': {'precision': 0.37849326930646304, 'recall': 0.5579668097945921, 'f1-score': 0.451031894934334, 'support': 8617}, '1': {'precision': 0.3420936720011746, 'recall': 0.2821506418018891, 'f1-score': 0.3092441436060787, 'support': 8258}, '2': {'precision': 0.33541398935193684, 'recall': 0.22594607964382885, 'f1-score': 0.2700066504101087, 'support': 8086}, 'accuracy': 0.35916029005248185, 'macro avg': {'precision': 0.3520003102198581, 'recall': 0.35535451041343674, 'f1-score': 0.34342756298350713, 'support': 24961}, 'weighted avg': {'precision': 0.3524956357076741, 'recall': 0.35916029005248185, 'f1-score': 0.3454811005874882, 'support': 24961}}
[[4808 2191 1618]
 [3926 2330 2002]
 [3969 2290 1827]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2872677
{'0': {'precision': 0.40636828184782886, 'recall': 0.46968527774150276, 'f1-score': 0.4357386537291323, 'support': 168466}, '1': {'precision': 0.3312506661658791, 'recall': 0.4601370597027553, 'f1-score': 0.3851985634142815, 'support': 141836}, '2': {'precision': 0.445697232662124, 'recall': 0.2436239331466398, 'f1-score': 0.31504186495223147, 'support': 179617}, 'accuracy': 0.384041035354824, 'macro avg': {'precision': 0.39443872689194404, 'recall': 0.39114875686363265, 'f1-score': 0.37865969403188177, 'support': 489919}, 'weighted avg': {'precision': 0.39904006232694117, 'recall': 0.384041035354824, 'f1-score': 0.37685626835596286, 'support': 489919}}
[[79126 61585 27755]
 [49905 65264 26667]
 [65684 70174 43759]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2364619
{'0': {'precision': 0.4007169166008945, 'recall': 0.5891216760676874, 'f1-score': 0.4769889218001748, 'support': 62050}, '1': {'precision': 0.40001933550320645, 'recall': 0.40945375379337645, 'f1-score': 0.4046815655207263, 'support': 60632}, '2': {'precision': 0.428063227841729, 'recall': 0.2111720004635685, 'f1-score': 0.2828222355262866, 'support': 60401}, 'accuracy': 0.40493109682493733, 'macro avg': {'precision': 0.40959982664861, 'recall': 0.4032491434415441, 'f1-score': 0.3881642409490626, 'support': 183083}, 'weighted avg': {'precision': 0.40950773174016264, 'recall': 0.40493109682493733, 'f1-score': 0.38898511126853264, 'support': 183083}}
[[36555 17704  7791]
 [26555 24826  9251]
 [28114 19532 12755]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2605551
{'0': {'precision': 0.40243341006247946, 'recall': 0.6239420821861935, 'f1-score': 0.48928514313129695, 'support': 19614}, '1': {'precision': 0.31112582781456954, 'recall': 0.30885543356781275, 'f1-score': 0.3099864735574544, 'support': 15211}, '2': {'precision': 0.4553805774278215, 'recall': 0.20999546119320187, 'f1-score': 0.287440030373106, 'support': 19829}, 'accuracy': 0.3860650638562594, 'macro avg': {'precision': 0.38964660510162347, 'recall': 0.380930992315736, 'f1-score': 0.3622372156872858, 'support': 54654}, 'weighted avg': {'precision': 0.39623093170983203, 'recall': 0.3860650638562594, 'f1-score': 0.36615236595542905, 'support': 54654}}
[[12238  4763  2613]
 [ 8146  4698  2367]
 [10026  5639  4164]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/EXC
Evaluating performance on  test set...
4918/4918 - 60s - 60s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.015603
{'0': {'precision': 0.38520478777509864, 'recall': 0.7491819175398825, 'f1-score': 0.5088008528286843, 'support': 308343}, '1': {'precision': 0.6887612911449612, 'recall': 0.3754083735325001, 'f1-score': 0.48595024767830336, 'support': 633305}, '2': {'precision': 0.48600949793446996, 'recall': 0.4810634601864492, 'f1-score': 0.48352383095092477, 'support': 317191}, 'accuracy': 0.49358337325106705, 'macro avg': {'precision': 0.5199918589515099, 'recall': 0.5352179170862773, 'f1-score': 0.4927583104859708, 'support': 1258839}, 'weighted avg': {'precision': 0.5633198590326717, 'recall': 0.49358337325106705, 'f1-score': 0.490935942112389, 'support': 1258839}}
[[231005  49931  27407]
 [261590 237748 133967]
 [107099  57503 152589]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97555184
{'0': {'precision': 0.3767298150063497, 'recall': 0.7143211776679989, 'f1-score': 0.4932969896454775, 'support': 80566}, '1': {'precision': 0.7097033924299123, 'recall': 0.4673561210113568, 'f1-score': 0.5635810607144707, 'support': 198031}, '2': {'precision': 0.4977707426460889, 'recall': 0.46945249617456425, 'f1-score': 0.4831970702912422, 'support': 80383}, 'accuracy': 0.5232519917544153, 'macro avg': {'precision': 0.5280679833607836, 'recall': 0.5503765982846399, 'f1-score': 0.5133583735503968, 'support': 358980}, 'weighted avg': {'precision': 0.5875179463708566, 'recall': 0.5232519917544153, 'f1-score': 0.5298075558620141, 'support': 358980}}
[[57550 17136  5880]
 [73286 92551 32194]
 [21926 20721 37736]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98681456
{'0': {'precision': 0.38936512689975294, 'recall': 0.7151500567224724, 'f1-score': 0.5042112534386854, 'support': 29089}, '1': {'precision': 0.704148847269331, 'recall': 0.4446324088588146, 'f1-score': 0.5450774836138091, 'support': 64433}, '2': {'precision': 0.5001223647869104, 'recall': 0.4899811611577325, 'f1-score': 0.49499982698363265, 'support': 29195}, 'accuracy': 0.5195449693196542, 'macro avg': {'precision': 0.5312121129853314, 'recall': 0.5499212089130066, 'f1-score': 0.5147628546787091, 'support': 122717}, 'weighted avg': {'precision': 0.5809931573656916, 'recall': 0.5195449693196542, 'f1-score': 0.523476768514172, 'support': 122717}}
[[20803  5659  2627]
 [24113 28649 11671]
 [ 8512  6378 14305]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.102718
{'0': {'precision': 0.44358643813781584, 'recall': 0.5169665258031809, 'f1-score': 0.47747359786732285, 'support': 405357}, '1': {'precision': 0.45728858758202534, 'recall': 0.5293652434147262, 'f1-score': 0.4906942574410015, 'support': 445084}, '2': {'precision': 0.5072574484339191, 'recall': 0.32991561009417425, 'f1-score': 0.3998030009927145, 'support': 392464}, 'accuracy': 0.46234265692068177, 'macro avg': {'precision': 0.4693774913845868, 'recall': 0.45874912643736043, 'f1-score': 0.45599028543367964, 'support': 1242905}, 'weighted avg': {'precision': 0.46859815413226147, 'recall': 0.46234265692068177, 'f1-score': 0.4576823756209685, 'support': 1242905}}
[[209556 137672  58129]
 [141826 235612  67646]
 [121031 141953 129480]]
Evaluating performance on  train set...
2076/2076 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0352526
{'0': {'precision': 0.36367469163162275, 'recall': 0.48634191827559037, 'f1-score': 0.416157155271858, 'support': 138343}, '1': {'precision': 0.5732934857163218, 'recall': 0.5100995890416388, 'f1-score': 0.5398534996718107, 'support': 252337}, '2': {'precision': 0.4730641111895112, 'recall': 0.40970653023520215, 'f1-score': 0.4391116932965744, 'support': 140730}, 'accuracy': 0.47732823996537516, 'macro avg': {'precision': 0.4700107628458186, 'recall': 0.46871601251747713, 'f1-score': 0.4650407827467477, 'support': 531410}, 'weighted avg': {'precision': 0.4921798960074011, 'recall': 0.47732823996537516, 'f1-score': 0.48097256445322306, 'support': 531410}}
[[ 67282  49660  21401]
 [ 80797 128717  42823]
 [ 36927  46145  57658]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0086145
{'0': {'precision': 0.38730194694848596, 'recall': 0.6075399847677075, 'f1-score': 0.4730428250921634, 'support': 39390}, '1': {'precision': 0.5997653500195541, 'recall': 0.5333815611914136, 'f1-score': 0.5646289560107801, 'support': 71881}, '2': {'precision': 0.5033745324442999, 'recall': 0.31714439406747097, 'f1-score': 0.3891254812603127, 'support': 39039}, 'accuracy': 0.4966535825959683, 'macro avg': {'precision': 0.4968139431374466, 'recall': 0.48602198000886404, 'f1-score': 0.4755990874544187, 'support': 150310}, 'weighted avg': {'precision': 0.5190525925563799, 'recall': 0.4966535825959683, 'f1-score': 0.4950457090700056, 'support': 150310}}
[[23931 12167  3292]
 [24618 38340  8923]
 [13240 13418 12381]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/WBA
Evaluating performance on  test set...
4353/4353 - 54s - 54s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0625939
{'0': {'precision': 0.45939016740860733, 'recall': 0.45209970214015593, 'f1-score': 0.4557157787269004, 'support': 333714}, '1': {'precision': 0.49705245748616284, 'recall': 0.70920950895431, 'f1-score': 0.5844739187765655, 'support': 447494}, '2': {'precision': 0.5253847406562984, 'recall': 0.23245766782754892, 'f1-score': 0.32230899236552246, 'support': 333080}, 'accuracy': 0.48969925189897046, 'macro avg': {'precision': 0.4939424551836895, 'recall': 0.46458895964067165, 'f1-score': 0.45416622995632944, 'support': 1114288}, 'weighted avg': {'precision': 0.49424212784729693, 'recall': 0.48969925189897046, 'f1-score': 0.4675469774135389, 'support': 1114288}}
[[150872 154879  27963]
 [ 88145 317367  41982]
 [ 89401 166252  77427]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1751875
{'0': {'precision': 0.4472112029823639, 'recall': 0.36798307364380717, 'f1-score': 0.40374707664161136, 'support': 127139}, '1': {'precision': 0.41519420661085155, 'recall': 0.7360082405454457, 'f1-score': 0.5308994230288082, 'support': 142709}, '2': {'precision': 0.5180146064376522, 'recall': 0.153558112496492, 'f1-score': 0.23689272350558188, 'support': 124715}, 'accuracy': 0.4333173663014525, 'macro avg': {'precision': 0.4601400053436226, 'recall': 0.4191831422285816, 'f1-score': 0.39051307439200045, 'support': 394563}, 'weighted avg': {'precision': 0.45801082921884356, 'recall': 0.4333173663014525, 'f1-score': 0.39699668075859784, 'support': 394563}}
[[ 46785  72120   8234]
 [ 28089 105035   9585]
 [ 29741  75823  19151]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1418587
{'0': {'precision': 0.417811780435267, 'recall': 0.43438529654036245, 'f1-score': 0.4259373777401971, 'support': 38848}, '1': {'precision': 0.44058224508248967, 'recall': 0.650906622284513, 'f1-score': 0.5254802125045304, 'support': 45664}, '2': {'precision': 0.5081511191615992, 'recall': 0.20245888963348627, 'f1-score': 0.2895532291359481, 'support': 38798}, 'accuracy': 0.44159435568891414, 'macro avg': {'precision': 0.455515048226452, 'recall': 0.4292502694861206, 'f1-score': 0.41365693979355855, 'support': 123310}, 'weighted avg': {'precision': 0.4546682897334181, 'recall': 0.44159435568891414, 'f1-score': 0.41988832907529455, 'support': 123310}}
[[16875 18283  3690]
 [12028 29723  3913]
 [11486 19457  7855]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1295785
{'0': {'precision': 0.4105184187036302, 'recall': 0.6809674928864033, 'f1-score': 0.5122369338896274, 'support': 457223}, '1': {'precision': 0.47811716376832275, 'recall': 0.3826154166173825, 'f1-score': 0.42506813841103264, 'support': 490354}, '2': {'precision': 0.5042285607289976, 'recall': 0.2812298748542287, 'f1-score': 0.36107355553817444, 'support': 459624}, 'accuracy': 0.44644013186460213, 'macro avg': {'precision': 0.4642880477336502, 'recall': 0.4482709281193382, 'f1-score': 0.4327928759462782, 'support': 1407201}, 'weighted avg': {'precision': 0.4646817865208217, 'recall': 0.44644013186460213, 'f1-score': 0.43248863627647965, 'support': 1407201}}
[[311354  94793  51076]
 [226721 187617  76016]
 [220366 109998 129260]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1307977
{'0': {'precision': 0.42432724672561434, 'recall': 0.5763882308348337, 'f1-score': 0.48880473325230284, 'support': 168848}, '1': {'precision': 0.45805741142230677, 'recall': 0.49739486018727114, 'f1-score': 0.4769163439808974, 'support': 187322}, '2': {'precision': 0.4991335225762553, 'recall': 0.275106355549826, 'f1-score': 0.3547086844998168, 'support': 170654}, 'accuracy': 0.4507064978057188, 'macro avg': {'precision': 0.4605060602413921, 'recall': 0.4496298155239769, 'f1-score': 0.44014325391100567, 'support': 526824}, 'weighted avg': {'precision': 0.4605526125220266, 'recall': 0.4507064978057188, 'f1-score': 0.441139888904086, 'support': 526824}}
[[97322 52139 19387]
 [66425 93173 27724]
 [65609 58097 46948]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1531423
{'0': {'precision': 0.4158477072885511, 'recall': 0.6278840766710243, 'f1-score': 0.5003280684546961, 'support': 58901}, '1': {'precision': 0.4197092804004251, 'recall': 0.4279846180737633, 'f1-score': 0.42380655658254573, 'support': 57210}, '2': {'precision': 0.4982424982424982, 'recall': 0.2314222863820719, 'f1-score': 0.3160476441940973, 'support': 58188}, 'accuracy': 0.4299164080115204, 'macro avg': {'precision': 0.4445998286438248, 'recall': 0.4290969937089532, 'f1-score': 0.4133940897437797, 'support': 174299}, 'weighted avg': {'precision': 0.4446218752055133, 'recall': 0.4299164080115204, 'f1-score': 0.4136912832690012, 'support': 174299}}
[[36983 15757  6161]
 [25325 24485  7400]
 [26626 18096 13466]]
testing model on single stock: results/universal/W2/deepLOB_L1/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 184s - 184s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1758914
{'0': {'precision': 0.2963346083855174, 'recall': 0.5779835250867996, 'f1-score': 0.3917945082064357, 'support': 969474}, '1': {'precision': 0.5039464336166909, 'recall': 0.49515830645300396, 'f1-score': 0.4995137198433571, 'support': 1855136}, '2': {'precision': 0.34275706520044485, 'recall': 0.03346936787074655, 'f1-score': 0.06098381877022653, 'support': 985289}, 'accuracy': 0.3968354541682076, 'macro avg': {'precision': 0.3810127024008844, 'recall': 0.3688703998035167, 'f1-score': 0.31743068227333976, 'support': 3809899}, 'weighted avg': {'precision': 0.4094314928606128, 'recall': 0.3968354541682076, 'f1-score': 0.3586938023912313, 'support': 3809899}}
[[560340 399426   9708]
 [883024 918586  53526]
 [447539 504773  32977]]
Evaluating performance on  train set...
6147/6147 - 76s - 76s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2798531
{'0': {'precision': 0.3713043550476697, 'recall': 0.5162640585667767, 'f1-score': 0.4319466316287787, 'support': 519612}, '1': {'precision': 0.33327690097814633, 'recall': 0.49271469882672764, 'f1-score': 0.3976079851905137, 'support': 519402}, '2': {'precision': 0.4554924698070538, 'recall': 0.07084762316383864, 'f1-score': 0.12262246135462423, 'support': 534471}, 'accuracy': 0.3571943806264439, 'macro avg': {'precision': 0.38669124194429, 'recall': 0.35994212685244764, 'f1-score': 0.31739235939130556, 'support': 1573485}, 'weighted avg': {'precision': 0.3873480861191093, 'recall': 0.3571943806264439, 'f1-score': 0.3155423695939164, 'support': 1573485}}
[[268257 233931  17424]
 [235643 255917  27842]
 [218572 278033  37866]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.267598
{'0': {'precision': 0.36600122923667594, 'recall': 0.5206840557328276, 'f1-score': 0.429850382480876, 'support': 176126}, '1': {'precision': 0.37155777607855484, 'recall': 0.5376416223171239, 'f1-score': 0.4394303952860299, 'support': 199739}, '2': {'precision': 0.4099639501211512, 'recall': 0.03840255980159323, 'f1-score': 0.07022676655193359, 'support': 180639}, 'accuracy': 0.37022375400715896, 'macro avg': {'precision': 0.3825076518121273, 'recall': 0.3655760792838482, 'f1-score': 0.31316918143961314, 'support': 556504}, 'weighted avg': {'precision': 0.38226569642379554, 'recall': 0.37022375400715896, 'f1-score': 0.31655641122442574, 'support': 556504}}
[[ 91706  81787   2633]
 [ 85000 107388   7351]
 [ 73856  99846   6937]]
training model: results/universal/W2/deepLOB_L1/h100
Epoch 1/50
9940/9940 - 216s - loss: 3.1955 - accuracy100: 0.4199 - val_loss: 3.3984 - val_accuracy100: 0.3504 - 216s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 215s - loss: 3.1732 - accuracy100: 0.4296 - val_loss: 3.5226 - val_accuracy100: 0.3644 - 215s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 215s - loss: 3.1560 - accuracy100: 0.4373 - val_loss: 3.5592 - val_accuracy100: 0.3667 - 215s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 215s - loss: 3.1439 - accuracy100: 0.4413 - val_loss: 3.5603 - val_accuracy100: 0.3622 - 215s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 217s - loss: 3.1324 - accuracy100: 0.4450 - val_loss: 3.5599 - val_accuracy100: 0.3572 - 217s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 217s - loss: 3.1263 - accuracy100: 0.4471 - val_loss: 3.6651 - val_accuracy100: 0.3557 - 217s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 217s - loss: 3.1184 - accuracy100: 0.4498 - val_loss: 3.5672 - val_accuracy100: 0.3586 - 217s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 215s - loss: 3.1134 - accuracy100: 0.4513 - val_loss: 3.6615 - val_accuracy100: 0.3546 - 215s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 216s - loss: 3.1099 - accuracy100: 0.4525 - val_loss: 3.6858 - val_accuracy100: 0.3570 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 214s - loss: 3.1062 - accuracy100: 0.4539 - val_loss: 3.5652 - val_accuracy100: 0.3551 - 214s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 215s - loss: 3.1029 - accuracy100: 0.4547 - val_loss: 3.7291 - val_accuracy100: 0.3505 - 215s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 315s - 315s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1302203
{'0': {'precision': 0.3746133746032814, 'recall': 0.1559088142605371, 'f1-score': 0.2201812789984108, 'support': 2142528}, '1': {'precision': 0.35790367509354803, 'recall': 0.8270568617390517, 'f1-score': 0.49960598876814766, 'support': 2385576}, '2': {'precision': 0.4369490807609283, 'recall': 0.06305203941322546, 'f1-score': 0.11020187575625691, 'support': 2192665}, 'accuracy': 0.36384199486695645, 'macro avg': {'precision': 0.38982204348591926, 'recall': 0.3486725718042714, 'f1-score': 0.2766630478409385, 'support': 6720769}, 'weighted avg': {'precision': 0.38901932472960254, 'recall': 0.36384199486695645, 'f1-score': 0.28348369174666804, 'support': 6720769}}
[[ 334039 1736175   72314]
 [ 306732 1973007  105837]
 [ 250919 1803494  138252]]
Evaluating performance on  train set...
9940/9940 - 123s - 123s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1301949
{'0': {'precision': 0.38859498098527856, 'recall': 0.1710914701941956, 'f1-score': 0.2375804755207019, 'support': 833747}, '1': {'precision': 0.34017938196033304, 'recall': 0.8104624048572309, 'f1-score': 0.47921534424532614, 'support': 863702}, '2': {'precision': 0.4601373644872399, 'recall': 0.06460602121310603, 'f1-score': 0.11330355042524065, 'support': 846175}, 'accuracy': 0.352769513104138, 'macro avg': {'precision': 0.3963039091442839, 'recall': 0.3487199654215108, 'f1-score': 0.2766997900637562, 'support': 2543624}, 'weighted avg': {'precision': 0.39595484496310257, 'recall': 0.352769513104138, 'f1-score': 0.2782863708474261, 'support': 2543624}}
[[142647 666418  24682]
 [124246 699998  39458]
 [100191 691316  54668]]
Evaluating performance on  val set...
3393/3393 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1312248
{'0': {'precision': 0.38873642943305187, 'recall': 0.17918217421975724, 'f1-score': 0.24529796409635518, 'support': 287763}, '1': {'precision': 0.3343798621101888, 'recall': 0.7911203080751886, 'f1-score': 0.47007491697345716, 'support': 288501}, '2': {'precision': 0.45189416148128536, 'recall': 0.08187497215778057, 'f1-score': 0.13863230208647617, 'support': 291823}, 'accuracy': 0.3498428152938588, 'macro avg': {'precision': 0.3916701510081753, 'recall': 0.3507258181509088, 'f1-score': 0.2846683943854295, 'support': 868087}, 'weighted avg': {'precision': 0.3919031106646546, 'recall': 0.3498428152938588, 'f1-score': 0.2841430132645698, 'support': 868087}}
[[ 51562 224228  11973]
 [ 43255 228239  17007]
 [ 37823 230107  23893]]
testing model out of sample: results/universal/W2/deepLOB_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 178s - 178s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1439453
{'0': {'precision': 0.39619223258841396, 'recall': 0.14295813461183154, 'f1-score': 0.21010428987615, 'support': 1277332}, '1': {'precision': 0.29740797358938764, 'recall': 0.7820539127605611, 'f1-score': 0.4309352138744575, 'support': 1081896}, '2': {'precision': 0.4587660286604085, 'recall': 0.12663507978936983, 'f1-score': 0.19848227755464598, 'support': 1307505}, 'accuracy': 0.32570738038466396, 'macro avg': {'precision': 0.3841220782794033, 'recall': 0.35054904238725415, 'f1-score': 0.2798405937684178, 'support': 3666733}, 'weighted avg': {'precision': 0.3893581534665097, 'recall': 0.32570738038466396, 'f1-score': 0.2711178008489, 'support': 3666733}}
[[ 182605  988820  105907]
 [ 146362  846101   89433]
 [ 131933 1009996  165576]]
Evaluating performance on  train set...
5373/5373 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1309127
{'0': {'precision': 0.391621471993636, 'recall': 0.1592951310697654, 'f1-score': 0.22647127846238246, 'support': 457390}, '1': {'precision': 0.3363013597480608, 'recall': 0.7927526299185188, 'f1-score': 0.4722604761605417, 'support': 459615}, '2': {'precision': 0.43173732793215003, 'recall': 0.09938915059829172, 'f1-score': 0.16158112253593138, 'support': 457887}, 'accuracy': 0.3511039412550222, 'macro avg': {'precision': 0.3865533865579489, 'recall': 0.3504789705288587, 'f1-score': 0.28677095905295186, 'support': 1374892}, 'weighted avg': {'precision': 0.38648839647815425, 'recall': 0.3511039412550222, 'f1-score': 0.2870258844047725, 'support': 1374892}}
[[ 72860 357664  26866]
 [ 62220 364361  33034]
 [ 50967 361411  45509]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1216631
{'0': {'precision': 0.39802120141342756, 'recall': 0.17344410834781895, 'f1-score': 0.24160498005214565, 'support': 146122}, '1': {'precision': 0.32366894301081767, 'recall': 0.7693164026028125, 'f1-score': 0.45563982695767946, 'support': 139234}, '2': {'precision': 0.4523116177163935, 'recall': 0.11223127528971345, 'f1-score': 0.17983933661570356, 'support': 145316}, 'accuracy': 0.34543225470892003, 'macro avg': {'precision': 0.3913339207135462, 'recall': 0.3516639287467817, 'f1-score': 0.2923613812085096, 'support': 430672}, 'weighted avg': {'precision': 0.39230200859163467, 'recall': 0.34543225470892003, 'f1-score': 0.2899605537426458, 'support': 430672}}
[[ 25344 111513   9265]
 [ 21636 107115  10483]
 [ 16695 112312  16309]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063635
{'0': {'precision': 0.289844823405803, 'recall': 0.1942792908704308, 'f1-score': 0.23262979510090895, 'support': 73837}, '1': {'precision': 0.3742517346152102, 'recall': 0.6784187595051173, 'f1-score': 0.4823910216130117, 'support': 97316}, '2': {'precision': 0.45711599924797897, 'recall': 0.14945538590150229, 'f1-score': 0.2252610318982369, 'support': 81342}, 'accuracy': 0.3664349789104735, 'macro avg': {'precision': 0.37373751908966407, 'recall': 0.34071781209235014, 'f1-score': 0.31342728287071914, 'support': 252495}, 'weighted avg': {'precision': 0.37626362360623844, 'recall': 0.3664349789104735, 'f1-score': 0.3265182823296463, 'support': 252495}}
[[14345 52963  6529]
 [23386 66021  7909]
 [11761 57424 12157]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1342163
{'0': {'precision': 0.34893617021276596, 'recall': 0.12093165174938975, 'f1-score': 0.17961403376260435, 'support': 19664}, '1': {'precision': 0.33003972700417644, 'recall': 0.8078188889997008, 'f1-score': 0.46862118341312425, 'support': 20054}, '2': {'precision': 0.39987066178055614, 'recall': 0.08909274290379905, 'f1-score': 0.1457187745483111, 'support': 20821}, 'accuracy': 0.337517963626753, 'macro avg': {'precision': 0.35961551966583283, 'recall': 0.3392810945509632, 'f1-score': 0.2646513305746799, 'support': 60539}, 'weighted avg': {'precision': 0.3601943306849889, 'recall': 0.337517963626753, 'f1-score': 0.26369233348659593, 'support': 60539}}
[[ 2378 16077  1209]
 [ 2279 16200  1575]
 [ 2158 16808  1855]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1065406
{'0': {'precision': 0.37917860553963706, 'recall': 0.17306015693112467, 'f1-score': 0.2376533971864711, 'support': 6882}, '1': {'precision': 0.34812864397216475, 'recall': 0.7401039584166333, 'f1-score': 0.4735226400613968, 'support': 7503}, '2': {'precision': 0.4190590111642743, 'recall': 0.14566874566874566, 'f1-score': 0.21618841921217727, 'support': 7215}, 'accuracy': 0.3608796296296296, 'macro avg': {'precision': 0.38212208689202537, 'recall': 0.35294428700550123, 'f1-score': 0.3091214854866817, 'support': 21600}, 'weighted avg': {'precision': 0.3817142196572766, 'recall': 0.3608796296296296, 'f1-score': 0.31241530057563954, 'support': 21600}}
[[1191 5079  612]
 [1105 5553  845]
 [ 845 5319 1051]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1512672
{'0': {'precision': 0.39066224237042574, 'recall': 0.15945747450950468, 'f1-score': 0.2264743932753984, 'support': 104843}, '1': {'precision': 0.31444335308020505, 'recall': 0.825791239684411, 'f1-score': 0.4554581451893019, 'support': 99243}, '2': {'precision': 0.5638349683434217, 'recall': 0.07126713744250877, 'f1-score': 0.126539980950299, 'support': 113713}, 'accuracy': 0.33598595338563053, 'macro avg': {'precision': 0.42298018793135084, 'recall': 0.3521719505454748, 'f1-score': 0.26949083980499977, 'support': 317799}, 'weighted avg': {'precision': 0.42882409611678085, 'recall': 0.33598595338563053, 'f1-score': 0.2622240106828399, 'support': 317799}}
[[16718 84751  3374]
 [14394 81954  2895]
 [11682 93927  8104]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899985
{'0': {'precision': 0.4442096365173288, 'recall': 0.20263658930422, 'f1-score': 0.27831383128382514, 'support': 41493}, '1': {'precision': 0.39226164403562563, 'recall': 0.7883370175472916, 'f1-score': 0.5238602831255607, 'support': 51119}, '2': {'precision': 0.4691721379518527, 'recall': 0.14696704647534395, 'f1-score': 0.22382229582560798, 'support': 42302}, 'accuracy': 0.4071037846331737, 'macro avg': {'precision': 0.4352144728349357, 'recall': 0.3793135511089518, 'f1-score': 0.34199880341166455, 'support': 134914}, 'weighted avg': {'precision': 0.43235344893124467, 'recall': 0.4071037846331737, 'f1-score': 0.3542658313634624, 'support': 134914}}
[[ 8408 30382  2703]
 [ 6489 40299  4331]
 [ 4031 32054  6217]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0896689
{'0': {'precision': 0.44394934333958724, 'recall': 0.13737300435413644, 'f1-score': 0.20982043892706714, 'support': 13780}, '1': {'precision': 0.3590072742832692, 'recall': 0.7605466843316365, 'f1-score': 0.4877688833236439, 'support': 14341}, '2': {'precision': 0.45512605042016807, 'recall': 0.21709155042488376, 'f1-score': 0.29396439426834564, 'support': 12474}, 'accuracy': 0.3820174898386501, 'macro avg': {'precision': 0.4193608893476748, 'recall': 0.3716704130368856, 'f1-score': 0.33051790550635224, 'support': 40595}, 'weighted avg': {'precision': 0.4173762193535423, 'recall': 0.3820174898386501, 'f1-score': 0.3338670047607515, 'support': 40595}}
[[ 1893 10599  1288]
 [ 1480 10907  1954]
 [  891  8875  2708]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1633166
{'0': {'precision': 0.3612253786962203, 'recall': 0.16358914227477453, 'f1-score': 0.22519403525445206, 'support': 91253}, '1': {'precision': 0.29350268773708715, 'recall': 0.812375597133758, 'f1-score': 0.4312127735442887, 'support': 80384}, '2': {'precision': 0.42818662818662817, 'recall': 0.04339221650288567, 'f1-score': 0.07879898381000434, 'support': 102576}, 'accuracy': 0.3088146805585439, 'macro avg': {'precision': 0.3609715648733119, 'recall': 0.3397856519704727, 'f1-score': 0.2450685975362484, 'support': 274213}, 'weighted avg': {'precision': 0.366421326144624, 'recall': 0.3088146805585439, 'f1-score': 0.23082466349499703, 'support': 274213}}
[[14928 73439  2886]
 [12024 65302  3058]
 [14374 83751  4451]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1441438
{'0': {'precision': 0.36590642747678714, 'recall': 0.16426547956293, 'f1-score': 0.226740775912633, 'support': 24710}, '1': {'precision': 0.3283450264135851, 'recall': 0.8155890388277175, 'f1-score': 0.4681993702845601, 'support': 24158}, '2': {'precision': 0.39359504132231404, 'recall': 0.03152929493545184, 'f1-score': 0.05838185718663807, 'support': 24168}, 'accuracy': 0.33577961553206637, 'macro avg': {'precision': 0.36261549840422874, 'recall': 0.3371279377753664, 'f1-score': 0.25110733446127703, 'support': 73036}, 'weighted avg': {'precision': 0.3626446126530545, 'recall': 0.33577961553206637, 'f1-score': 0.25089678630568807, 'support': 73036}}
[[ 4059 20067   584]
 [ 3865 19703   590]
 [ 3169 20237   762]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129942
{'0': {'precision': 0.36906854130052724, 'recall': 0.15468799326528465, 'f1-score': 0.21800385585051163, 'support': 9503}, '1': {'precision': 0.3561519217648397, 'recall': 0.7513674311486421, 'f1-score': 0.48324384373264206, 'support': 10421}, '2': {'precision': 0.41812028117677685, 'recall': 0.16246838644410724, 'f1-score': 0.2340084511146729, 'support': 9885}, 'accuracy': 0.3658626589285115, 'macro avg': {'precision': 0.3811135814140479, 'recall': 0.35617460361934467, 'f1-score': 0.3117520502326088, 'support': 29809}, 'weighted avg': {'precision': 0.38081909839722045, 'recall': 0.3658626589285115, 'f1-score': 0.31603704508550484, 'support': 29809}}
[[1470 6960 1073]
 [1429 7830 1162]
 [1084 7195 1606]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1682855
{'0': {'precision': 0.37899901195870667, 'recall': 0.15161096876192554, 'f1-score': 0.21658245962442688, 'support': 73372}, '1': {'precision': 0.3046763825506649, 'recall': 0.8554043504217246, 'f1-score': 0.4493161479146733, 'support': 65327}, '2': {'precision': 0.4671400724032303, 'recall': 0.04129484891377931, 'f1-score': 0.07588180080744568, 'support': 81245}, 'accuracy': 0.3198996108100244, 'macro avg': {'precision': 0.383605155637534, 'recall': 0.3494367226991431, 'f1-score': 0.24726013611551526, 'support': 219944}, 'weighted avg': {'precision': 0.38948234428182604, 'recall': 0.3198996108100244, 'f1-score': 0.2337348649155523, 'support': 219944}}
[[11124 60223  2025]
 [ 7644 55881  1802]
 [10583 67307  3355]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1356065
{'0': {'precision': 0.3858612975391499, 'recall': 0.15519165017095554, 'f1-score': 0.2213552361396304, 'support': 27785}, '1': {'precision': 0.3266057146595574, 'recall': 0.742756183745583, 'f1-score': 0.45370685933701405, 'support': 26885}, '2': {'precision': 0.36258808456117875, 'recall': 0.1257219013771657, 'f1-score': 0.18670625103084282, 'support': 27012}, 'accuracy': 0.33883842217379595, 'macro avg': {'precision': 0.35835169891996205, 'recall': 0.3412232450979014, 'f1-score': 0.28725611550249575, 'support': 81682}, 'weighted avg': {'precision': 0.358661395789942, 'recall': 0.33883842217379595, 'f1-score': 0.2863736612994342, 'support': 81682}}
[[ 4312 20901  2572]
 [ 3518 19969  3398]
 [ 3345 20271  3396]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1517507
{'0': {'precision': 0.3751829089844893, 'recall': 0.15185974887467424, 'f1-score': 0.21620710009275654, 'support': 8442}, '1': {'precision': 0.3296329188869153, 'recall': 0.8173476877905554, 'f1-score': 0.4697981857815906, 'support': 8174}, '2': {'precision': 0.33072100313479624, 'recall': 0.0505692031156381, 'f1-score': 0.08772476873505872, 'support': 8345}, 'accuracy': 0.3359240415047474, 'macro avg': {'precision': 0.3451789436687336, 'recall': 0.3399255465936226, 'f1-score': 0.2579100182031353, 'support': 24961}, 'weighted avg': {'precision': 0.34540204189690227, 'recall': 0.3359240415047474, 'f1-score': 0.25629637853675086, 'support': 24961}}
[[1282 6802  358]
 [ 997 6681  496]
 [1138 6785  422]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1342995
{'0': {'precision': 0.38033927536016415, 'recall': 0.15644378126490624, 'f1-score': 0.22169743871948971, 'support': 163522}, '1': {'precision': 0.3095976159048539, 'recall': 0.740268106982495, 'f1-score': 0.4365991498834208, 'support': 153670}, '2': {'precision': 0.39510711116744834, 'recall': 0.12632072576956702, 'f1-score': 0.1914367185786357, 'support': 172727}, 'accuracy': 0.32894825471149314, 'macro avg': {'precision': 0.36168133414415554, 'recall': 0.34101087133898944, 'f1-score': 0.2832444357271821, 'support': 489919}, 'weighted avg': {'precision': 0.3633567398124251, 'recall': 0.32894825471149314, 'f1-score': 0.278435598592432, 'support': 489919}}
[[ 25582 122287  15653]
 [ 22162 113757  17751]
 [ 19517 131391  21819]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.144983
{'0': {'precision': 0.3694930845297152, 'recall': 0.1835405855282483, 'f1-score': 0.24525442393449418, 'support': 61278}, '1': {'precision': 0.3373873783619521, 'recall': 0.8205578025762227, 'f1-score': 0.4781674475838894, 'support': 61563}, '2': {'precision': 0.4154953719574906, 'recall': 0.020118853955711963, 'f1-score': 0.03837932836175367, 'support': 60242}, 'accuracy': 0.3439696749561674, 'macro avg': {'precision': 0.37412527828305264, 'recall': 0.3414057473533943, 'f1-score': 0.2539337332933791, 'support': 183083}, 'weighted avg': {'precision': 0.37383399116997146, 'recall': 0.3439696749561674, 'f1-score': 0.2555025352688872, 'support': 183083}}
[[11247 49297   734]
 [10076 50516   971]
 [ 9116 49914  1212]]
Evaluating performance on  val set...
214/214 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1635839
{'0': {'precision': 0.37617883339154734, 'recall': 0.16602435640511792, 'f1-score': 0.23037433155080214, 'support': 19461}, '1': {'precision': 0.2927428703918386, 'recall': 0.7969953288726171, 'f1-score': 0.42820321508512516, 'support': 15842}, '2': {'precision': 0.44599659284497445, 'recall': 0.06764508294145005, 'f1-score': 0.11747285291214214, 'support': 19351}, 'accuracy': 0.3140849709078933, 'macro avg': {'precision': 0.37163943220945345, 'recall': 0.3435549227397284, 'f1-score': 0.25868346651602314, 'support': 54654}, 'weighted avg': {'precision': 0.37671403552390514, 'recall': 0.3140849709078933, 'f1-score': 0.24774266067244075, 'support': 54654}}
[[ 3231 15187  1043]
 [ 2633 12626   583]
 [ 2725 15317  1309]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/EXC
Evaluating performance on  test set...
4918/4918 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1376609
{'0': {'precision': 0.38687451905681625, 'recall': 0.18545136530860518, 'f1-score': 0.25071872414698465, 'support': 409358}, '1': {'precision': 0.3334986103305476, 'recall': 0.810851711771372, 'f1-score': 0.4726138732817415, 'support': 428854}, '2': {'precision': 0.5747137979513959, 'recall': 0.02721175768555038, 'f1-score': 0.05196314548182583, 'support': 420627}, 'accuracy': 0.3456351447643424, 'macro avg': {'precision': 0.43169564244625325, 'recall': 0.3411716115885092, 'f1-score': 0.2584319143035173, 'support': 1258839}, 'weighted avg': {'precision': 0.43145512102632555, 'recall': 0.3456351447643424, 'f1-score': 0.25990072398957553, 'support': 1258839}}
[[ 75916 332100   1342]
 [ 73989 347737   7128]
 [ 46324 362857  11446]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0689386
{'0': {'precision': 0.43976850423772385, 'recall': 0.27072557601186387, 'f1-score': 0.33513743444508504, 'support': 110588}, '1': {'precision': 0.39203956256429534, 'recall': 0.6865485906117961, 'f1-score': 0.49908615879010054, 'support': 138216}, '2': {'precision': 0.49881278912678595, 'recall': 0.22118247168167296, 'f1-score': 0.3064704772684399, 'support': 110176}, 'accuracy': 0.4156220402250822, 'macro avg': {'precision': 0.4435402853096017, 'recall': 0.392818879435111, 'f1-score': 0.38023135683454184, 'support': 358980}, 'weighted avg': {'precision': 0.43951322463886794, 'recall': 0.4156220402250822, 'f1-score': 0.3894633751943653, 'support': 358980}}
[[29939 73446  7203]
 [26042 94892 17282]
 [12098 73709 24369]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0797648
{'0': {'precision': 0.458743565395572, 'recall': 0.23520217291036744, 'f1-score': 0.3109680697891081, 'support': 39026}, '1': {'precision': 0.36401374003180115, 'recall': 0.6823663253697383, 'f1-score': 0.47476194622319673, 'support': 43950}, '2': {'precision': 0.5066679789380444, 'recall': 0.2590775269872424, 'f1-score': 0.34284572608304753, 'support': 39741}, 'accuracy': 0.4030818875950357, 'macro avg': {'precision': 0.44314176145513917, 'recall': 0.3922153417557827, 'f1-score': 0.37619191403178415, 'support': 122717}, 'weighted avg': {'precision': 0.4403368922684068, 'recall': 0.4030818875950357, 'f1-score': 0.37995273212648306, 'support': 122717}}
[[ 9179 26597  3250]
 [ 7185 29990  6775]
 [ 3645 25800 10296]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/AAL
Evaluating performance on  test set...
4856/4856 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1234149
{'0': {'precision': 0.4724870495744184, 'recall': 0.1563725510668599, 'f1-score': 0.23497774451614523, 'support': 478882}, '1': {'precision': 0.2506054705631434, 'recall': 0.699902200168032, 'f1-score': 0.3690645023124613, 'support': 304704}, '2': {'precision': 0.4788690157438149, 'recall': 0.24336027902176918, 'f1-score': 0.3227166168166018, 'support': 459319}, 'accuracy': 0.321767954912081, 'macro avg': {'precision': 0.4006538452937922, 'recall': 0.3665450100855537, 'f1-score': 0.30891962121506944, 'support': 1242905}, 'weighted avg': {'precision': 0.42045021141535516, 'recall': 0.321767954912081, 'f1-score': 0.30027388745043393, 'support': 1242905}}
[[ 74884 330898  73100]
 [ 42896 213263  48545]
 [ 40709 306830 111780]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1346786
{'0': {'precision': 0.38818717482605153, 'recall': 0.14127087325485901, 'f1-score': 0.20715348977236614, 'support': 175344}, '1': {'precision': 0.34113566407865115, 'recall': 0.8294887118935645, 'f1-score': 0.48344830055763716, 'support': 179038}, '2': {'precision': 0.4656209312418625, 'recall': 0.08484533520121111, 'f1-score': 0.14353564022438195, 'support': 177028}, 'accuracy': 0.35434222163677764, 'macro avg': {'precision': 0.398314590048855, 'recall': 0.35186830678321157, 'f1-score': 0.2780458101847951, 'support': 531410}, 'weighted avg': {'precision': 0.39813041008618055, 'recall': 0.35434222163677764, 'f1-score': 0.2790473752159837, 'support': 531410}}
[[ 24771 141539   9034]
 [ 22324 148510   8204]
 [ 16717 145291  15020]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1102382
{'0': {'precision': 0.42248555479384975, 'recall': 0.170594748497311, 'f1-score': 0.24304909997464721, 'support': 50576}, '1': {'precision': 0.3335452763206697, 'recall': 0.7560199363478052, 'f1-score': 0.4628761558116877, 'support': 49959}, '2': {'precision': 0.4606006006006006, 'recall': 0.1540733299849322, 'f1-score': 0.2309070380127964, 'support': 49775}, 'accuracy': 0.359703279888231, 'macro avg': {'precision': 0.4055438105717067, 'recall': 0.3602293382766828, 'f1-score': 0.31227743126637714, 'support': 150310}, 'weighted avg': {'precision': 0.4055459568482002, 'recall': 0.359703279888231, 'f1-score': 0.31209286784379486, 'support': 150310}}
[[ 8628 38058  3890]
 [ 7098 37770  5091]
 [ 4696 37410  7669]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/WBA
Evaluating performance on  test set...
4353/4353 - 53s - 53s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883948
{'0': {'precision': 0.464473398684794, 'recall': 0.13118694472720682, 'f1-score': 0.20458923194883397, 'support': 375266}, '1': {'precision': 0.3492777580250582, 'recall': 0.6868642332186268, 'f1-score': 0.46307629933662303, 'support': 383297}, '2': {'precision': 0.4174664974679118, 'recall': 0.29871108299950805, 'f1-score': 0.34824287432528533, 'support': 355725}, 'accuracy': 0.37581128038711714, 'macro avg': {'precision': 0.4104058847259213, 'recall': 0.37225408698178053, 'f1-score': 0.33863613520358077, 'support': 1114288}, 'weighted avg': {'precision': 0.4098414961485285, 'recall': 0.37581128038711714, 'f1-score': 0.33936454084823925, 'support': 1114288}}
[[ 49230 264747  61289]
 [ 33039 263273  86985]
 [ 23722 225744 106259]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1189096
{'0': {'precision': 0.4225153629348981, 'recall': 0.13550418611543305, 'f1-score': 0.20519926397989408, 'support': 134970}, '1': {'precision': 0.3288449556896696, 'recall': 0.8270241194904816, 'f1-score': 0.47057701562912374, 'support': 128278}, '2': {'precision': 0.4444289402079118, 'recall': 0.09701861935041693, 'f1-score': 0.15926891318344055, 'support': 131315}, 'accuracy': 0.34751864721223225, 'macro avg': {'precision': 0.3985964196108265, 'recall': 0.3531823083187772, 'f1-score': 0.27834839759748614, 'support': 394563}, 'weighted avg': {'precision': 0.3993548762673757, 'recall': 0.34751864721223225, 'f1-score': 0.276191179621309, 'support': 394563}}
[[ 18289 109205   7476]
 [ 13739 106089   8450]
 [ 11258 107317  12740]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1148025
{'0': {'precision': 0.40379951495553756, 'recall': 0.09672500181540919, 'f1-score': 0.15606631646780836, 'support': 41313}, '1': {'precision': 0.33750984613768836, 'recall': 0.7881106533254856, 'f1-score': 0.47261951158532545, 'support': 40776}, '2': {'precision': 0.41683608989504917, 'recall': 0.18403241066446713, 'f1-score': 0.25533490407270276, 'support': 41221}, 'accuracy': 0.35453734490308975, 'macro avg': {'precision': 0.3860484836627584, 'recall': 0.356289355268454, 'f1-score': 0.29467357737527883, 'support': 123310}, 'weighted avg': {'precision': 0.38623689326925903, 'recall': 0.35453734490308975, 'f1-score': 0.29392799462670244, 'support': 123310}}
[[ 3996 31855  5462]
 [ 3489 32136  5151]
 [ 2411 31224  7586]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 65s - 65s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1685058
{'0': {'precision': 0.3643537716877245, 'recall': 0.11183003503335193, 'f1-score': 0.17113431610764052, 'support': 469838}, '1': {'precision': 0.31553050110529546, 'recall': 0.8689230230899327, 'f1-score': 0.46295056968787274, 'support': 445822}, '2': {'precision': 0.4350279282089087, 'recall': 0.031214079802091788, 'f1-score': 0.05824870446650594, 'support': 491541}, 'accuracy': 0.3235287638368648, 'macro avg': {'precision': 0.3716374003339762, 'recall': 0.33732237930845876, 'f1-score': 0.23077786342067308, 'support': 1407201}, 'weighted avg': {'precision': 0.3735726092475185, 'recall': 0.3235287638368648, 'f1-score': 0.22415460203122312, 'support': 1407201}}
[[ 52542 409719   7577]
 [ 46088 387385  12349]
 [ 45576 430622  15343]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1203269
{'0': {'precision': 0.4097109516464355, 'recall': 0.17316915541344943, 'f1-score': 0.2434438870049293, 'support': 176394}, '1': {'precision': 0.33128302711598545, 'recall': 0.73701101818057, 'f1-score': 0.45710119268317345, 'support': 174802}, '2': {'precision': 0.4151836425596365, 'recall': 0.14983943334775776, 'f1-score': 0.22020651682760697, 'support': 175628}, 'accuracy': 0.35247634883756246, 'macro avg': {'precision': 0.38539254044068577, 'recall': 0.35333986898059244, 'f1-score': 0.3069171988385699, 'support': 526824}, 'weighted avg': {'precision': 0.38551273686489923, 'recall': 0.35247634883756246, 'f1-score': 0.3065894375069293, 'support': 526824}}
[[ 30546 130626  15222]
 [ 24125 128831  21846]
 [ 19884 129428  26316]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1205645
{'0': {'precision': 0.4013936270595921, 'recall': 0.18525963149078728, 'f1-score': 0.25351273294061016, 'support': 59700}, '1': {'precision': 0.31797787293746255, 'recall': 0.7839089156713326, 'f1-score': 0.4524343011619142, 'support': 55509}, '2': {'precision': 0.4651985048994848, 'recall': 0.07793196818412591, 'f1-score': 0.13349954340547043, 'support': 59090}, 'accuracy': 0.33952575746275077, 'macro avg': {'precision': 0.3948566682988465, 'recall': 0.34903350511541525, 'f1-score': 0.2798155258359983, 'support': 174299}, 'weighted avg': {'precision': 0.3964590326901119, 'recall': 0.33952575746275077, 'f1-score': 0.276176993554641, 'support': 174299}}
[[11060 46094  2546]
 [ 9247 43514  2748]
 [ 7247 47238  4605]]
testing model on single stock: results/universal/W2/deepLOB_L1/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 183s - 183s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1359946
{'0': {'precision': 0.35025657949332545, 'recall': 0.15384563219628225, 'f1-score': 0.2137877741994002, 'support': 1179689}, '1': {'precision': 0.37409842771112145, 'recall': 0.8685847727409847, 'f1-score': 0.5229590255955946, 'support': 1408855}, '2': {'precision': 0.45323322838459673, 'recall': 0.007661163216263904, 'f1-score': 0.015067632850241545, 'support': 1221355}, 'accuracy': 0.37128464560346613, 'macro avg': {'precision': 0.39252941186301454, 'recall': 0.343363856051177, 'f1-score': 0.25060481088174547, 'support': 3809899}, 'weighted avg': {'precision': 0.3920846573708444, 'recall': 0.37128464560346613, 'f1-score': 0.26441106503946804, 'support': 3809899}}
[[ 181490  993925    4274]
 [ 178131 1223710    7014]
 [ 158542 1053456    9357]]
Evaluating performance on  train set...
6147/6147 - 77s - 77s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.150214
{'0': {'precision': 0.3614818934618712, 'recall': 0.1578170437705117, 'f1-score': 0.21971161391840466, 'support': 518911}, '1': {'precision': 0.3304199593587717, 'recall': 0.8455809277278296, 'f1-score': 0.4751642942490519, 'support': 519204}, '2': {'precision': 0.4228217360311455, 'recall': 0.014403123073762071, 'f1-score': 0.027857306717581243, 'support': 535370}, 'accuracy': 0.3359631645678224, 'macro avg': {'precision': 0.3715745296172628, 'recall': 0.3392670315240344, 'f1-score': 0.2409110716283459, 'support': 1573485}, 'weighted avg': {'precision': 0.37210292326657013, 'recall': 0.3359631645678224, 'f1-score': 0.23872610277103973, 'support': 1573485}}
[[ 81893 432383   4635]
 [ 74284 439029   5891]
 [ 70371 457288   7711]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1483837
{'0': {'precision': 0.37067260653246453, 'recall': 0.1922873403094999, 'f1-score': 0.2532174803395953, 'support': 185202}, '1': {'precision': 0.32734893514645735, 'recall': 0.8182224428997021, 'f1-score': 0.46761686007374736, 'support': 181260}, '2': {'precision': 0.41817194078500614, 'recall': 0.01620168173351154, 'f1-score': 0.03119475190598009, 'support': 190042}, 'accuracy': 0.3360299297040093, 'macro avg': {'precision': 0.3720644941546427, 'recall': 0.3422371549809045, 'f1-score': 0.2506763641064409, 'support': 556504}, 'weighted avg': {'precision': 0.37278224061343046, 'recall': 0.3360299297040093, 'f1-score': 0.24723079958551497, 'support': 556504}}
[[ 35612 147943   1647]
 [ 30312 148311   2637]
 [ 30150 156813   3079]]
training model: results/universal/W2/deepLOB_L1/h200
Epoch 1/50
9940/9940 - 219s - loss: 3.2312 - accuracy200: 0.4054 - val_loss: 3.3429 - val_accuracy200: 0.3595 - 219s/epoch - 22ms/step
Epoch 2/50
9940/9940 - 216s - loss: 3.2134 - accuracy200: 0.4158 - val_loss: 3.3961 - val_accuracy200: 0.3644 - 216s/epoch - 22ms/step
Epoch 3/50
9940/9940 - 217s - loss: 3.2056 - accuracy200: 0.4194 - val_loss: 3.3440 - val_accuracy200: 0.3685 - 217s/epoch - 22ms/step
Epoch 4/50
9940/9940 - 218s - loss: 3.1991 - accuracy200: 0.4227 - val_loss: 3.3488 - val_accuracy200: 0.3689 - 218s/epoch - 22ms/step
Epoch 5/50
9940/9940 - 218s - loss: 3.1960 - accuracy200: 0.4240 - val_loss: 3.4329 - val_accuracy200: 0.3681 - 218s/epoch - 22ms/step
Epoch 6/50
9940/9940 - 218s - loss: 3.1925 - accuracy200: 0.4256 - val_loss: 3.4023 - val_accuracy200: 0.3690 - 218s/epoch - 22ms/step
Epoch 7/50
9940/9940 - 217s - loss: 3.1905 - accuracy200: 0.4266 - val_loss: 3.3915 - val_accuracy200: 0.3537 - 217s/epoch - 22ms/step
Epoch 8/50
9940/9940 - 218s - loss: 3.1876 - accuracy200: 0.4279 - val_loss: 3.4420 - val_accuracy200: 0.3512 - 218s/epoch - 22ms/step
Epoch 9/50
9940/9940 - 216s - loss: 3.1852 - accuracy200: 0.4291 - val_loss: 3.4620 - val_accuracy200: 0.3466 - 216s/epoch - 22ms/step
Epoch 10/50
9940/9940 - 215s - loss: 3.1839 - accuracy200: 0.4295 - val_loss: 3.4602 - val_accuracy200: 0.3519 - 215s/epoch - 22ms/step
Epoch 11/50
9940/9940 - 217s - loss: 3.1818 - accuracy200: 0.4306 - val_loss: 3.4644 - val_accuracy200: 0.3355 - 217s/epoch - 22ms/step
testing model in sample: results/universal/W2/deepLOB_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 317s - 317s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042
{'0': {'precision': 0.31572807475083986, 'recall': 0.02710008313824489, 'f1-score': 0.04991571945262422, 'support': 2077263}, '1': {'precision': 0.379107486141357, 'recall': 0.9263767581669692, 'f1-score': 0.5380323286774418, 'support': 2539008}, '2': {'precision': 0.33606331991993355, 'recall': 0.05400955477268213, 'f1-score': 0.09306276576451551, 'support': 2104498}, 'accuracy': 0.37525988469474253, 'macro avg': {'precision': 0.34363296027071016, 'recall': 0.33582879869263205, 'f1-score': 0.22700360463152716, 'support': 6720769}, 'weighted avg': {'precision': 0.3460395339519642, 'recall': 0.37525988469474253, 'f1-score': 0.24782980464495385, 'support': 6720769}}
[[  56294 1915551  105418]
 [  67792 2352078  119138]
 [  54213 1936622  113663]]
Evaluating performance on  train set...
9940/9940 - 124s - 124s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1215657
{'0': {'precision': 0.3493309545049063, 'recall': 0.0694550369090735, 'f1-score': 0.11587204365026527, 'support': 845727}, '1': {'precision': 0.334482916970684, 'recall': 0.8594206059479244, 'f1-score': 0.4815489788981409, 'support': 839049}, '2': {'precision': 0.3780831523397125, 'recall': 0.09668183427102352, 'f1-score': 0.15398680907842507, 'support': 858848}, 'accuracy': 0.33922898981925004, 'macro avg': {'precision': 0.353965674605101, 'recall': 0.3418524923760071, 'f1-score': 0.2504692772089438, 'support': 2543624}, 'weighted avg': {'precision': 0.3541412317160727, 'recall': 0.33922898981925004, 'f1-score': 0.24936490930227947, 'support': 2543624}}
[[ 58740 715192  71795]
 [ 53162 721096  64791]
 [ 56248 719565  83035]]
Evaluating performance on  val set...
3393/3393 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155916
{'0': {'precision': 0.36825379249252577, 'recall': 0.11722966185039356, 'f1-score': 0.17784444426619178, 'support': 283691}, '1': {'precision': 0.35510707497125155, 'recall': 0.8594524558717125, 'f1-score': 0.502565152108502, 'support': 297145}, '2': {'precision': 0.39574802074802073, 'recall': 0.08074471455277789, 'f1-score': 0.13412402163887596, 'support': 287251}, 'accuracy': 0.35921860366530084, 'macro avg': {'precision': 0.37303629607059935, 'recall': 0.35247561075829464, 'f1-score': 0.2715112060045232, 'support': 868087}, 'weighted avg': {'precision': 0.37285156112949436, 'recall': 0.35921860366530084, 'f1-score': 0.2745287623261145, 'support': 868087}}
[[ 33257 231077  19357]
 [ 25706 255382  16057]
 [ 31347 232710  23194]]
testing model out of sample: results/universal/W2/deepLOB_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 176s - 176s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1285748
{'0': {'precision': 0.36809396655858606, 'recall': 0.055939658566552794, 'f1-score': 0.09711989611021377, 'support': 1241999}, '1': {'precision': 0.31276754550673386, 'recall': 0.8789451198811146, 'f1-score': 0.4613620644719234, 'support': 1139921}, '2': {'precision': 0.37399747958536994, 'recall': 0.07992135820543535, 'f1-score': 0.13169925566141732, 'support': 1284813}, 'accuracy': 0.3202002981946054, 'macro avg': {'precision': 0.3516196638835633, 'recall': 0.3382687122177009, 'f1-score': 0.2300604054145182, 'support': 3666733}, 'weighted avg': {'precision': 0.35296255695516876, 'recall': 0.3202002981946054, 'f1-score': 0.22247271222311563, 'support': 3666733}}
[[  69477 1080269   92253]
 [  58372 1001928   79621]
 [  60899 1121230  102684]]
Evaluating performance on  train set...
5373/5373 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1210685
{'0': {'precision': 0.34844850116045484, 'recall': 0.03877203795171833, 'f1-score': 0.06977965860069639, 'support': 460796}, '1': {'precision': 0.33452262625138157, 'recall': 0.9206493361548848, 'f1-score': 0.49073440613938546, 'support': 456959}, '2': {'precision': 0.36228393097910894, 'recall': 0.05231254525448607, 'f1-score': 0.0914238090322778, 'support': 457137}, 'accuracy': 0.33637478434669776, 'macro avg': {'precision': 0.3484183527969818, 'recall': 0.33724463978702973, 'f1-score': 0.2173126245907865, 'support': 1374892}, 'weighted avg': {'precision': 0.3484202320370872, 'recall': 0.33637478434669776, 'f1-score': 0.21688459664410176, 'support': 1374892}}
[[ 17866 421471  21459]
 [ 15624 420699  20636]
 [ 17783 415440  23914]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1169199
{'0': {'precision': 0.34890029325513194, 'recall': 0.06576928923838085, 'f1-score': 0.11067570553145965, 'support': 144718}, '1': {'precision': 0.33246049661399546, 'recall': 0.8787589498806683, 'f1-score': 0.4824107435309531, 'support': 142460}, '2': {'precision': 0.3887564264957902, 'recall': 0.07272081062622827, 'f1-score': 0.12252254367837685, 'support': 143494}, 'accuracy': 0.33701053237730805, 'macro avg': {'precision': 0.35670573878830586, 'recall': 0.33908301658175916, 'f1-score': 0.23853633091359652, 'support': 430672}, 'weighted avg': {'precision': 0.35674176554434206, 'recall': 0.33701053237730805, 'f1-score': 0.23758742420938989, 'support': 430672}}
[[  9518 126803   8397]
 [  9262 125188   8010]
 [  8500 124559  10435]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109943
{'0': {'precision': 0.3686651209009606, 'recall': 0.06883031749761907, 'f1-score': 0.1160027515477456, 'support': 80851}, '1': {'precision': 0.34250109046906585, 'recall': 0.8681360485989752, 'f1-score': 0.4912083624818382, 'support': 84117}, '2': {'precision': 0.4185786927942453, 'recall': 0.1156785906063272, 'f1-score': 0.1812632031222027, 'support': 87527}, 'accuracy': 0.35135349214835937, 'macro avg': {'precision': 0.3765816347214239, 'recall': 0.3508816522343072, 'f1-score': 0.2628247723839288, 'support': 252495}, 'weighted avg': {'precision': 0.37725121353354274, 'recall': 0.35135349214835937, 'f1-score': 0.26362239518385944, 'support': 252495}}
[[ 5565 67590  7696]
 [ 4724 73025  6368]
 [ 4806 72596 10125]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223485
{'0': {'precision': 0.34362377380265435, 'recall': 0.059798162373851486, 'f1-score': 0.101868879100201, 'support': 19917}, '1': {'precision': 0.3281659816010961, 'recall': 0.8458705413450381, 'f1-score': 0.4728744482520343, 'support': 19821}, '2': {'precision': 0.3434731739929801, 'recall': 0.09879332724388251, 'f1-score': 0.15344982078853048, 'support': 20801}, 'accuracy': 0.33056376881018845, 'macro avg': {'precision': 0.33842097646557684, 'recall': 0.3348206769875907, 'f1-score': 0.24273104938025525, 'support': 60539}, 'weighted avg': {'precision': 0.33851101135418116, 'recall': 0.33056376881018845, 'f1-score': 0.2410623998755265, 'support': 60539}}
[[ 1191 16775  1951]
 [ 1078 16766  1977]
 [ 1197 17549  2055]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155527
{'0': {'precision': 0.45717234262125905, 'recall': 0.0594311778910652, 'f1-score': 0.10518817523447703, 'support': 7454}, '1': {'precision': 0.30948955515911836, 'recall': 0.7907660638141449, 'f1-score': 0.44486723467615186, 'support': 6801}, '2': {'precision': 0.3405039950829748, 'recall': 0.1508509189925119, 'f1-score': 0.2090763279554675, 'support': 7345}, 'accuracy': 0.32078703703703704, 'macro avg': {'precision': 0.36905529762111744, 'recall': 0.33368272023257406, 'f1-score': 0.25304391262203213, 'support': 21600}, 'weighted avg': {'precision': 0.3710001365935407, 'recall': 0.32078703703703704, 'f1-score': 0.2474666828732967, 'support': 21600}}
[[ 443 6050  961]
 [ 238 5378 1185]
 [ 288 5949 1108]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164078
{'0': {'precision': 0.40226300784034213, 'recall': 0.04516535622111518, 'f1-score': 0.0812123392391402, 'support': 99966}, '1': {'precision': 0.3448728399362762, 'recall': 0.9487131771405177, 'f1-score': 0.5058579844961241, 'support': 107474}, '2': {'precision': 0.45056755767118273, 'recall': 0.04459989670076749, 'f1-score': 0.08116553845139055, 'support': 110359}, 'accuracy': 0.3505328839927124, 'macro avg': {'precision': 0.39923446848260036, 'recall': 0.34615947668746677, 'f1-score': 0.22274528739555158, 'support': 317799}, 'weighted avg': {'precision': 0.3996289243770844, 'recall': 0.3505328839927124, 'f1-score': 0.2248037325104023, 'support': 317799}}
[[  4515  92047   3404]
 [  2914 101962   2598]
 [  3795 101642   4922]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1185702
{'0': {'precision': 0.3764249333009944, 'recall': 0.06944226940200005, 'f1-score': 0.11725375389555198, 'support': 44699}, '1': {'precision': 0.33876151703449753, 'recall': 0.9200089525514772, 'f1-score': 0.4951873848044235, 'support': 44680}, '2': {'precision': 0.39898610589560646, 'recall': 0.0466673987042934, 'f1-score': 0.08356107823283067, 'support': 45535}, 'accuracy': 0.34344100686363166, 'macro avg': {'precision': 0.3713908520770328, 'recall': 0.3453728735525902, 'f1-score': 0.23200073897760207, 'support': 134914}, 'weighted avg': {'precision': 0.3715664423757278, 'recall': 0.34344100686363166, 'f1-score': 0.23104386198445576, 'support': 134914}}
[[ 3104 39936  1659]
 [ 2032 41106  1542]
 [ 3110 40300  2125]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104122
{'0': {'precision': 0.47401960784313724, 'recall': 0.06531136025935431, 'f1-score': 0.11480470141279828, 'support': 14806}, '1': {'precision': 0.3334201087585329, 'recall': 0.8765112919169645, 'f1-score': 0.48307943758774596, 'support': 13151}, '2': {'precision': 0.3896560381621893, 'recall': 0.12280424117740149, 'f1-score': 0.18675169965706034, 'support': 12638}, 'accuracy': 0.34600320236482324, 'macro avg': {'precision': 0.3990319182546198, 'recall': 0.3548756311179068, 'f1-score': 0.26154527955253487, 'support': 40595}, 'weighted avg': {'precision': 0.40220754216782123, 'recall': 0.34600320236482324, 'f1-score': 0.2565080446631424, 'support': 40595}}
[[  967 12507  1332]
 [  525 11527  1099]
 [  548 10538  1552]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1353257
{'0': {'precision': 0.3814102564102564, 'recall': 0.04864387118157212, 'f1-score': 0.08628342429379086, 'support': 90515}, '1': {'precision': 0.3040523147187046, 'recall': 0.8963292982950025, 'f1-score': 0.45407392939411134, 'support': 81701}, '2': {'precision': 0.3737109858380311, 'recall': 0.0799435277508162, 'f1-score': 0.1317115720100795, 'support': 101997}, 'accuracy': 0.31285168828611337, 'macro avg': {'precision': 0.35305785232233067, 'recall': 0.341638899075797, 'f1-score': 0.22402297523266057, 'support': 274213}, 'weighted avg': {'precision': 0.3554978317816037, 'recall': 0.31285168828611337, 'f1-score': 0.2127631566180044, 'support': 274213}}
[[ 4403 78265  7847]
 [ 2652 73231  5818]
 [ 4489 89354  8154]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1246263
{'0': {'precision': 0.3605846083580726, 'recall': 0.06298615820335873, 'f1-score': 0.10723988046726433, 'support': 25069}, '1': {'precision': 0.3280774135473708, 'recall': 0.9241041244083841, 'f1-score': 0.48423919662529485, 'support': 23664}, '2': {'precision': 0.3946053946053946, 'recall': 0.03250627494547998, 'f1-score': 0.06006462649686371, 'support': 24303}, 'accuracy': 0.33185004655238515, 'macro avg': {'precision': 0.361089138836946, 'recall': 0.3398655191857409, 'f1-score': 0.21718123452980764, 'support': 73036}, 'weighted avg': {'precision': 0.3613726705488856, 'recall': 0.33185004655238515, 'f1-score': 0.21369165247450717, 'support': 73036}}
[[ 1579 22821   669]
 [ 1253 21868   543]
 [ 1547 21966   790]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080194
{'0': {'precision': 0.37274633123689727, 'recall': 0.09076059213884635, 'f1-score': 0.14597701149425288, 'support': 9795}, '1': {'precision': 0.33311819281968535, 'recall': 0.8367615766541696, 'f1-score': 0.4765284630254768, 'support': 9869}, '2': {'precision': 0.38686408504176156, 'recall': 0.10044356826022671, 'f1-score': 0.15948039752719306, 'support': 10145}, 'accuracy': 0.3410379415612734, 'macro avg': {'precision': 0.364242869699448, 'recall': 0.34265524568441424, 'f1-score': 0.2606619573489743, 'support': 29809}, 'weighted avg': {'precision': 0.36443120876753854, 'recall': 0.3410379415612734, 'f1-score': 0.2600098246200145, 'support': 29809}}
[[ 889 8065  841]
 [ 837 8258  774]
 [ 659 8467 1019]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1405874
{'0': {'precision': 0.3929149018097805, 'recall': 0.0705993053537576, 'f1-score': 0.11969220663444846, 'support': 72267}, '1': {'precision': 0.2880360495681562, 'recall': 0.9065952249625719, 'f1-score': 0.4371760772095144, 'support': 63455}, '2': {'precision': 0.4332319601880011, 'recall': 0.03721117997672817, 'f1-score': 0.06853568929321202, 'support': 84222}, 'accuracy': 0.29900338267922744, 'macro avg': {'precision': 0.37139430385531264, 'recall': 0.3381352367643526, 'f1-score': 0.208467991045725, 'support': 219944}, 'weighted avg': {'precision': 0.3780952009847443, 'recall': 0.29900338267922744, 'f1-score': 0.1916988756221326, 'support': 219944}}
[[ 5102 65139  2026]
 [ 3853 57528  2074]
 [ 4030 77058  3134]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196767
{'0': {'precision': 0.34774609015639374, 'recall': 0.027751266426840906, 'f1-score': 0.05140059831384281, 'support': 27242}, '1': {'precision': 0.32950222913002575, 'recall': 0.8879418032184584, 'f1-score': 0.48064435936956196, 'support': 27218}, '2': {'precision': 0.3174809284207109, 'recall': 0.07185364778487988, 'f1-score': 0.1171853937632927, 'support': 27222}, 'accuracy': 0.32908107049288704, 'macro avg': {'precision': 0.3315764159023768, 'recall': 0.32918223914339306, 'f1-score': 0.21641011714889916, 'support': 81682}, 'weighted avg': {'precision': 0.3315804766529971, 'recall': 0.32908107049288704, 'f1-score': 0.21635677458449593, 'support': 81682}}
[[  756 24537  1949]
 [  794 24168  2256]
 [  624 24642  1956]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1272453
{'0': {'precision': 0.3408695652173913, 'recall': 0.023222748815165877, 'f1-score': 0.043483083749306706, 'support': 8440}, '1': {'precision': 0.32412950004215496, 'recall': 0.9459891732283464, 'f1-score': 0.4828257456828885, 'support': 8128}, '2': {'precision': 0.2786144578313253, 'recall': 0.022042178005480757, 'f1-score': 0.040852379375069005, 'support': 8393}, 'accuracy': 0.3233043547934778, 'macro avg': {'precision': 0.31453784103029053, 'recall': 0.33041803334966435, 'f1-score': 0.18905373626908806, 'support': 24961}, 'weighted avg': {'precision': 0.3144855915770895, 'recall': 0.3233043547934778, 'f1-score': 0.18566078714192624, 'support': 24961}}
[[ 196 8033  211]
 [ 171 7689  268]
 [ 208 8000  185]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1237714
{'0': {'precision': 0.2959860062603572, 'recall': 0.01984212702664338, 'f1-score': 0.03719106257699938, 'support': 162029}, '1': {'precision': 0.3184947870220519, 'recall': 0.9340315894150921, 'f1-score': 0.4750146547633316, 'support': 154862}, '2': {'precision': 0.37474901614328165, 'recall': 0.053933467415678386, 'f1-score': 0.09429596321931996, 'support': 173028}, 'accuracy': 0.32085508012549013, 'macro avg': {'precision': 0.3297432698085636, 'recall': 0.3359357279524713, 'f1-score': 0.20216722685321697, 'support': 489919}, 'weighted avg': {'precision': 0.33091823154727246, 'recall': 0.32085508012549013, 'f1-score': 0.1957539757963259, 'support': 489919}}
[[  3215 150233   8581]
 [  3227 144646   6989]
 [  4420 159276   9332]]
Evaluating performance on  train set...
716/716 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1291207
{'0': {'precision': 0.3301815747636181, 'recall': 0.06351199098664091, 'f1-score': 0.10653203925432972, 'support': 62130}, '1': {'precision': 0.33264665666769067, 'recall': 0.9163389583022218, 'f1-score': 0.4881034452281204, 'support': 60267}, '2': {'precision': 0.3964809384164223, 'recall': 0.033417921761196984, 'f1-score': 0.061640400601814575, 'support': 60686}, 'accuracy': 0.33426915661202844, 'macro avg': {'precision': 0.35310305661591035, 'recall': 0.3377562903500199, 'f1-score': 0.21875862836142154, 'support': 183083}, 'weighted avg': {'precision': 0.35296908793385684, 'recall': 0.33426915661202844, 'f1-score': 0.21725706528381314, 'support': 183083}}
[[ 3946 56626  1558]
 [ 3513 55225  1529]
 [ 4492 54166  2028]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1339463
{'0': {'precision': 0.35948116121062385, 'recall': 0.03061546554445029, 'f1-score': 0.05642542052450433, 'support': 19010}, '1': {'precision': 0.3097402862151914, 'recall': 0.9038129795966926, 'f1-score': 0.4613679495938662, 'support': 16811}, '2': {'precision': 0.351419241396634, 'recall': 0.07428450061063027, 'f1-score': 0.12264399053212939, 'support': 18833}, 'accuracy': 0.3142496432100121, 'macro avg': {'precision': 0.34021356294081645, 'recall': 0.3362376485839244, 'f1-score': 0.21347912021683332, 'support': 54654}, 'weighted avg': {'precision': 0.341403362963376, 'recall': 0.3142496432100121, 'f1-score': 0.20379950449161827, 'support': 54654}}
[[  582 16983  1445]
 [  480 15194  1137]
 [  557 16877  1399]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1364375
{'0': {'precision': 0.31999586968867777, 'recall': 0.028737017804154302, 'f1-score': 0.052737939748733254, 'support': 431360}, '1': {'precision': 0.3059748427672956, 'recall': 0.9611309161146472, 'f1-score': 0.4641789035770072, 'support': 385705}, '2': {'precision': 0.3564135664828072, 'recall': 0.006874555768334035, 'f1-score': 0.013488935031479366, 'support': 441774}, 'accuracy': 0.30674772548356066, 'macro avg': {'precision': 0.32746142631292685, 'recall': 0.3322474965623785, 'f1-score': 0.1768019261190733, 'support': 1258839}, 'weighted avg': {'precision': 0.32848020437708353, 'recall': 0.30674772548356066, 'f1-score': 0.16502842895618894, 'support': 1258839}}
[[ 12396 416031   2933]
 [ 12441 370713   2551]
 [ 13901 424836   3037]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1157508
{'0': {'precision': 0.3891102257636122, 'recall': 0.04823164357967687, 'f1-score': 0.08582496686365401, 'support': 121497}, '1': {'precision': 0.32366043225135505, 'recall': 0.8609569443965666, 'f1-score': 0.4704602553808698, 'support': 116036}, '2': {'precision': 0.40139546756672434, 'recall': 0.11652819748532281, 'f1-score': 0.18062078823769656, 'support': 121447}, 'accuracy': 0.3340408936430999, 'macro avg': {'precision': 0.37138870852723055, 'recall': 0.34190559515385543, 'f1-score': 0.2456353368274068, 'support': 358980}, 'weighted avg': {'precision': 0.3721105977098885, 'recall': 0.3340408936430999, 'f1-score': 0.24222423271912505, 'support': 358980}}
[[  5860 106050   9587]
 [  4616  99902  11518]
 [  4584 102711  14152]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1165262
{'0': {'precision': 0.3960546282245827, 'recall': 0.0812363827902411, 'f1-score': 0.1348194063654786, 'support': 41767}, '1': {'precision': 0.31618185778499436, 'recall': 0.8287701450704591, 'f1-score': 0.45773461855448455, 'support': 38533}, '2': {'precision': 0.42105263157894735, 'recall': 0.13051370912605795, 'f1-score': 0.1992621254386754, 'support': 42417}, 'accuracy': 0.33299379874019086, 'macro avg': {'precision': 0.3777630391961748, 'recall': 0.34684007899558605, 'f1-score': 0.26393871678621283, 'support': 122717}, 'weighted avg': {'precision': 0.37961520129052645, 'recall': 0.33299379874019086, 'f1-score': 0.2584889768912147, 'support': 122717}}
[[ 3393 34693  3681]
 [ 2667 31935  3931]
 [ 2507 34374  5536]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/AAL
Evaluating performance on  test set...
4856/4856 - 60s - 60s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1191913
{'0': {'precision': 0.39057557287246353, 'recall': 0.0466906780051835, 'f1-score': 0.08341022556886524, 'support': 433684}, '1': {'precision': 0.3134004016336984, 'recall': 0.8303047749271347, 'f1-score': 0.4550435816388048, 'support': 389074}, '2': {'precision': 0.3556351429765834, 'recall': 0.13566204209479063, 'f1-score': 0.19640328177279134, 'support': 420147}, 'accuracy': 0.3220656445987425, 'macro avg': {'precision': 0.3532037058275818, 'recall': 0.3375524983423696, 'f1-score': 0.24495236299348713, 'support': 1242905}, 'weighted avg': {'precision': 0.3546058331304755, 'recall': 0.3220656445987425, 'f1-score': 0.23794059592256614, 'support': 1242905}}
[[ 20249 360451  52984]
 [ 15735 323050  50289]
 [ 15860 347289  56998]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217383
{'0': {'precision': 0.345237474584224, 'recall': 0.03726673119780294, 'f1-score': 0.0672717945071188, 'support': 177692}, '1': {'precision': 0.3362051812238585, 'recall': 0.9255481954585755, 'f1-score': 0.49324076247569865, 'support': 177081}, '2': {'precision': 0.3839437302934756, 'recall': 0.05377129367006912, 'f1-score': 0.09433147113594041, 'support': 176637}, 'accuracy': 0.33875350482678157, 'macro avg': {'precision': 0.355128795367186, 'recall': 0.3388620734421492, 'f1-score': 0.21828134270625263, 'support': 531410}, 'weighted avg': {'precision': 0.35509334735509435, 'recall': 0.33875350482678157, 'f1-score': 0.21821127798979553, 'support': 531410}}
[[  6622 162878   8192]
 [  6136 163897   7048]
 [  6423 160716   9498]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1139189
{'0': {'precision': 0.3326251681892217, 'recall': 0.09484865006764807, 'f1-score': 0.14760692624367555, 'support': 49521}, '1': {'precision': 0.34308235765961714, 'recall': 0.8584772749203898, 'f1-score': 0.4902435126660752, 'support': 51815}, '2': {'precision': 0.372149961744453, 'recall': 0.04965900273614571, 'f1-score': 0.08762543011043254, 'support': 48974}, 'accuracy': 0.3433637149890227, 'macro avg': {'precision': 0.3492858291977639, 'recall': 0.3343283092413945, 'f1-score': 0.24182528967339445, 'support': 150310}, 'weighted avg': {'precision': 0.3491079471924979, 'recall': 0.3433637149890227, 'f1-score': 0.2461777527611873, 'support': 150310}}
[[ 4697 42982  1842]
 [ 5072 44482  2261]
 [ 4352 42190  2432]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/WBA
Evaluating performance on  test set...
4353/4353 - 54s - 54s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104431
{'0': {'precision': 0.32992225397036345, 'recall': 0.013038374575563486, 'f1-score': 0.025085386309896724, 'support': 380799}, '1': {'precision': 0.3448329261824475, 'recall': 0.9316750695592142, 'f1-score': 0.503361109462816, 'support': 382408}, '2': {'precision': 0.33122359674757357, 'recall': 0.0623075586545555, 'f1-score': 0.10488487835751478, 'support': 351081}, 'accuracy': 0.3438249357437215, 'macro avg': {'precision': 0.33532625896679485, 'recall': 0.3356736675964444, 'f1-score': 0.2111104580434092, 'support': 1114288}, 'weighted avg': {'precision': 0.33544940409927476, 'recall': 0.3438249357437215, 'f1-score': 0.2143654900236865, 'support': 1114288}}
[[  4965 352814  23020]
 [  4980 356280  21148]
 [  5104 324102  21875]]
Evaluating performance on  train set...
1542/1542 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1174443
{'0': {'precision': 0.3495403472931563, 'recall': 0.06402101356003233, 'f1-score': 0.10822059037462921, 'support': 133628}, '1': {'precision': 0.33347551005900333, 'recall': 0.8191895647156188, 'f1-score': 0.4739965908691526, 'support': 131707}, '2': {'precision': 0.3626442090789954, 'recall': 0.13062184665861887, 'f1-score': 0.1920637178210781, 'support': 129228}, 'accuracy': 0.3379130835886791, 'macro avg': {'precision': 0.3485533554770517, 'recall': 0.3379441416447566, 'f1-score': 0.25809363302162, 'support': 394563}, 'weighted avg': {'precision': 0.3484696293932565, 'recall': 0.3379130835886791, 'f1-score': 0.25777880888670934, 'support': 394563}}
[[  8555 110846  14227]
 [  8374 107893  15440]
 [  7546 104802  16880]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1266805
{'0': {'precision': 0.3238789981125338, 'recall': 0.1543229381881821, 'f1-score': 0.20904122217832213, 'support': 41141}, '1': {'precision': 0.3339624125186758, 'recall': 0.8273309469890666, 'f1-score': 0.4758443450067576, 'support': 41067}, '2': {'precision': 0.32318619989852865, 'recall': 0.015498029292978444, 'f1-score': 0.02957769368281754, 'support': 41102}, 'accuracy': 0.33218717054577895, 'macro avg': {'precision': 0.32700920350991275, 'recall': 0.33238397149007576, 'f1-score': 0.23815442028929912, 'support': 123310}, 'weighted avg': {'precision': 0.32700623991956485, 'recall': 0.33218717054577895, 'f1-score': 0.23807774717202201, 'support': 123310}}
[[ 6349 34088   704]
 [ 6461 33976   630]
 [ 6793 33672   637]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1408346
{'0': {'precision': 0.3640148057497668, 'recall': 0.07641076391813358, 'f1-score': 0.12630805884328702, 'support': 474920}, '1': {'precision': 0.3070041866833395, 'recall': 0.9017637336197337, 'f1-score': 0.45806186112392006, 'support': 430167}, '2': {'precision': 0.4124829467939973, 'recall': 0.03612924554981538, 'f1-score': 0.06643911121528527, 'support': 502114}, 'accuracy': 0.31433960038402475, 'macro avg': {'precision': 0.36116731307570116, 'recall': 0.3381012476958942, 'f1-score': 0.21693634372749745, 'support': 1407201}, 'weighted avg': {'precision': 0.36388152358207, 'recall': 0.31433960038402475, 'f1-score': 0.20635952348576994, 'support': 1407201}}
[[ 36289 423120  15511]
 [ 31930 387909  10328]
 [ 31472 452501  18141]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1169473
{'0': {'precision': 0.3618267918773577, 'recall': 0.02561538286701366, 'f1-score': 0.047843690799004496, 'support': 175988}, '1': {'precision': 0.3347923521894543, 'recall': 0.923713704961221, 'f1-score': 0.4914593494031589, 'support': 176126}, '2': {'precision': 0.3427978326648371, 'recall': 0.05576669910136798, 'f1-score': 0.09592777110450347, 'support': 174710}, 'accuracy': 0.33586359011738265, 'macro avg': {'precision': 0.34647232557721636, 'recall': 0.3350319289765342, 'f1-score': 0.21174360376888893, 'support': 526824}, 'weighted avg': {'precision': 0.34647817983900875, 'recall': 0.33586359011738265, 'f1-score': 0.21209782720412088, 'support': 526824}}
[[  4508 162468   9012]
 [  3769 162690   9667]
 [  4182 160785   9743]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147306
{'0': {'precision': 0.3509933774834437, 'recall': 0.04766025314737521, 'f1-score': 0.08392465006498259, 'support': 58938}, '1': {'precision': 0.3331279127989832, 'recall': 0.9078091106290672, 'f1-score': 0.48740032497111896, 'support': 57164}, '2': {'precision': 0.424605438296254, 'recall': 0.07673935082564394, 'f1-score': 0.12998617477988794, 'support': 58197}, 'accuracy': 0.3394683847870613, 'macro avg': {'precision': 0.36957557619289366, 'recall': 0.3440695715340288, 'f1-score': 0.2337703832719965, 'support': 174299}, 'weighted avg': {'precision': 0.369712588034856, 'recall': 0.3394683847870613, 'f1-score': 0.23163017926576818, 'support': 174299}}
[[ 2809 52739  3390]
 [ 2608 51894  2662]
 [ 2586 51145  4466]]
testing model on single stock: results/universal/W2/deepLOB_L1/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 184s - 184s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0886068
{'0': {'precision': 0.2918565997173398, 'recall': 0.0268320780769185, 'f1-score': 0.04914588823852281, 'support': 1092871}, '1': {'precision': 0.42302977437653866, 'recall': 0.9160082151745724, 'f1-score': 0.5787718520551569, 'support': 1599966}, '2': {'precision': 0.32878792827514125, 'recall': 0.07209268599236211, 'f1-score': 0.11825568025797394, 'support': 1117062}, 'accuracy': 0.4135117492615946, 'macro avg': {'precision': 0.3478914341230066, 'recall': 0.3383109930812844, 'f1-score': 0.2487244735172179, 'support': 3809899}, 'weighted avg': {'precision': 0.3577709988413624, 'recall': 0.4135117492615946, 'f1-score': 0.291825144910859, 'support': 3809899}}
[[  29324  989808   73739]
 [  43719 1465582   90665]
 [  27431 1009099   80532]]
Evaluating performance on  train set...
6147/6147 - 76s - 76s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1242371
{'0': {'precision': 0.34366304393792024, 'recall': 0.07834211556295924, 'f1-score': 0.12759697030598405, 'support': 518661}, '1': {'precision': 0.3371446762490847, 'recall': 0.8624857530111204, 'f1-score': 0.4847867691180584, 'support': 519408}, '2': {'precision': 0.38071258606923486, 'recall': 0.08994688242413376, 'f1-score': 0.14551459179680715, 'support': 535416}, 'accuracy': 0.3411370302227222, 'macro avg': {'precision': 0.3538401020854132, 'recall': 0.3435915836660712, 'f1-score': 0.25263277707361653, 'support': 1573485}, 'weighted avg': {'precision': 0.3541183233497083, 'recall': 0.3411370302227222, 'f1-score': 0.25160235977554524, 'support': 1573485}}
[[ 40633 433830  44198]
 [ 37286 447982  34140]
 [ 40316 446941  48159]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112624
{'0': {'precision': 0.3769791911789424, 'recall': 0.1263285962926038, 'f1-score': 0.1892410697334948, 'support': 177537}, '1': {'precision': 0.37194767886067054, 'recall': 0.8681432341821813, 'f1-score': 0.5207744972186564, 'support': 196266}, '2': {'precision': 0.39492753623188404, 'recall': 0.08412105024055698, 'f1-score': 0.13869874603482585, 'support': 182701}, 'accuracy': 0.37409254920000573, 'macro avg': {'precision': 0.38128480209049903, 'recall': 0.35953096023844733, 'f1-score': 0.2829047709956591, 'support': 556504}, 'weighted avg': {'precision': 0.38109715941072425, 'recall': 0.37409254920000573, 'f1-score': 0.28957207651283906, 'support': 556504}}
[[ 22428 141675  13434]
 [ 15766 170387  10113]
 [ 21300 146032  15369]]
training model: results/universal/W2/deepOF_L1/h50
Epoch 1/50
9940/9940 - 209s - loss: 3.1538 - accuracy50: 0.4444 - val_loss: 3.2588 - val_accuracy50: 0.4037 - 209s/epoch - 21ms/step
Epoch 2/50
9940/9940 - 205s - loss: 3.1431 - accuracy50: 0.4484 - val_loss: 3.2514 - val_accuracy50: 0.4102 - 205s/epoch - 21ms/step
Epoch 3/50
9940/9940 - 206s - loss: 3.1356 - accuracy50: 0.4502 - val_loss: 3.2601 - val_accuracy50: 0.4122 - 206s/epoch - 21ms/step
Epoch 4/50
9940/9940 - 207s - loss: 3.1288 - accuracy50: 0.4526 - val_loss: 3.2661 - val_accuracy50: 0.4126 - 207s/epoch - 21ms/step
Epoch 5/50
9940/9940 - 207s - loss: 3.1228 - accuracy50: 0.4542 - val_loss: 3.2644 - val_accuracy50: 0.4135 - 207s/epoch - 21ms/step
Epoch 6/50
9940/9940 - 207s - loss: 3.1174 - accuracy50: 0.4557 - val_loss: 3.2677 - val_accuracy50: 0.4130 - 207s/epoch - 21ms/step
Epoch 7/50
9940/9940 - 204s - loss: 3.1117 - accuracy50: 0.4575 - val_loss: 3.2706 - val_accuracy50: 0.4140 - 204s/epoch - 21ms/step
Epoch 8/50
9940/9940 - 205s - loss: 3.1063 - accuracy50: 0.4590 - val_loss: 3.2829 - val_accuracy50: 0.4137 - 205s/epoch - 21ms/step
Epoch 9/50
9940/9940 - 206s - loss: 3.1000 - accuracy50: 0.4606 - val_loss: 3.2962 - val_accuracy50: 0.4147 - 206s/epoch - 21ms/step
Epoch 10/50
9940/9940 - 203s - loss: 3.0944 - accuracy50: 0.4618 - val_loss: 3.3186 - val_accuracy50: 0.4149 - 203s/epoch - 20ms/step
Epoch 11/50
9940/9940 - 206s - loss: 3.0894 - accuracy50: 0.4627 - val_loss: 3.3378 - val_accuracy50: 0.4138 - 206s/epoch - 21ms/step
Epoch 12/50
9940/9940 - 204s - loss: 3.0847 - accuracy50: 0.4641 - val_loss: 3.3282 - val_accuracy50: 0.4154 - 204s/epoch - 21ms/step
testing model in sample: results/universal/W2/deepOF_L1/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 331s - 331s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0413359
{'0': {'precision': 0.42821428012947815, 'recall': 0.12366014754252898, 'f1-score': 0.19190249957405323, 'support': 1771557}, '1': {'precision': 0.48032097308040017, 'recall': 0.8178483069469132, 'f1-score': 0.6052056548690384, 'support': 3144231}, '2': {'precision': 0.41056097971551214, 'recall': 0.19457925844175702, 'f1-score': 0.26402690133920315, 'support': 1804956}, 'accuracy': 0.4674753271364004, 'macro avg': {'precision': 0.43969874430846345, 'recall': 0.37869590431039973, 'f1-score': 0.35371168526076496, 'support': 6720744}, 'weighted avg': {'precision': 0.4478508038211676, 'recall': 0.4674753271364004, 'f1-score': 0.40463221595496646, 'support': 6720744}}
[[ 219071 1406889  145597]
 [ 214099 2571504  358628]
 [  78422 1375327  351207]]
Evaluating performance on  train set...
9940/9940 - 132s - 132s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778167
{'0': {'precision': 0.47044091830829754, 'recall': 0.12287099060378134, 'f1-score': 0.19485043460221133, 'support': 787338}, '1': {'precision': 0.38645314882010506, 'recall': 0.8099341877815507, 'f1-score': 0.5232446175739659, 'support': 957421}, '2': {'precision': 0.4473918461812355, 'recall': 0.18559822747415067, 'f1-score': 0.2623584068486715, 'support': 798860}, 'accuracy': 0.40118272429951185, 'macro avg': {'precision': 0.43476197110321274, 'recall': 0.3728011352864942, 'f1-score': 0.32681781967494955, 'support': 2543619}, 'weighted avg': {'precision': 0.43158893772056817, 'recall': 0.40118272429951185, 'f1-score': 0.3396602138041309, 'support': 2543619}}
[[ 96741 622166  68431]
 [ 67268 775448 114705]
 [ 41630 608963 148267]]
Evaluating performance on  val set...
3393/3393 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072191
{'0': {'precision': 0.45793707859071237, 'recall': 0.12810878715078922, 'f1-score': 0.20020877941150303, 'support': 263487}, '1': {'precision': 0.3992829565071255, 'recall': 0.8015613948381636, 'f1-score': 0.5330412774884772, 'support': 337903}, '2': {'precision': 0.4442519671467108, 'recall': 0.19328216338636559, 'f1-score': 0.2693690492365255, 'support': 266693}, 'accuracy': 0.4102741327730183, 'macro avg': {'precision': 0.43382400074818284, 'recall': 0.37431744845843945, 'f1-score': 0.3342063687121686, 'support': 868083}, 'weighted avg': {'precision': 0.43090149876626543, 'recall': 0.4102741327730183, 'f1-score': 0.35101193929154734, 'support': 868083}}
[[ 33755 206345  23387]
 [ 25956 270850  41097]
 [ 14000 201146  51547]]
testing model out of sample: results/universal/W2/deepOF_L1/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 178s - 178s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.092663
{'0': {'precision': 0.47733719902246485, 'recall': 0.13343951244151203, 'f1-score': 0.20857259915847798, 'support': 1201743}, '1': {'precision': 0.35184657907415656, 'recall': 0.7794576965424703, 'f1-score': 0.4848377752519466, 'support': 1246092}, '2': {'precision': 0.46044461123259756, 'recall': 0.21541948997147364, 'f1-score': 0.2935168272294151, 'support': 1218873}, 'accuracy': 0.38023344100484685, 'macro avg': {'precision': 0.42987612977640627, 'recall': 0.37610556631848535, 'f1-score': 0.32897573387994655, 'support': 3666708}, 'weighted avg': {'precision': 0.4290751675899575, 'recall': 0.38023344100484685, 'f1-score': 0.3306952366606106, 'support': 3666708}}
[[160360 906276 135107]
 [102241 971276 172575]
 [ 73346 882958 262569]]
Evaluating performance on  train set...
5373/5373 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0715572
{'0': {'precision': 0.47102437623701454, 'recall': 0.11112992942326444, 'f1-score': 0.17983172220460358, 'support': 413309}, '1': {'precision': 0.4098466492017399, 'recall': 0.8260500114705207, 'f1-score': 0.5478675362551702, 'support': 544875}, '2': {'precision': 0.4365477133959168, 'recall': 0.18770638150821686, 'f1-score': 0.2625302494805984, 'support': 416704}, 'accuracy': 0.41766529346390396, 'macro avg': {'precision': 0.4391395796115571, 'recall': 0.374962107467334, 'f1-score': 0.33007650264679067, 'support': 1374888}, 'weighted avg': {'precision': 0.4363300758060834, 'recall': 0.41766529346390396, 'f1-score': 0.35075060526330987, 'support': 1374888}}
[[ 45931 329241  38137]
 [ 31962 450094  62819]
 [ 19620 318866  78218]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0793477
{'0': {'precision': 0.4748588410104012, 'recall': 0.11885422710164978, 'f1-score': 0.1901220760059967, 'support': 134442}, '1': {'precision': 0.38989986096689605, 'recall': 0.8214751413651392, 'f1-score': 0.5288090686854663, 'support': 161815}, '2': {'precision': 0.4522311161820548, 'recall': 0.18872570901407612, 'f1-score': 0.266313220125456, 'support': 134412}, 'accuracy': 0.40465647631940077, 'macro avg': {'precision': 0.4389966060531174, 'recall': 0.3763516924936217, 'f1-score': 0.32841478827230636, 'support': 430669}, 'weighted avg': {'precision': 0.4358751316991495, 'recall': 0.40465647631940077, 'f1-score': 0.3411560250104831, 'support': 430669}}
[[ 15979 105966  12497]
 [ 10659 132927  18229]
 [  7012 102033  25367]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1101487
{'0': {'precision': 0.35858850976961215, 'recall': 0.07842236848818818, 'f1-score': 0.1286986738677636, 'support': 78396}, '1': {'precision': 0.350114995504105, 'recall': 0.8764379192163694, 'f1-score': 0.5003519285036258, 'support': 88409}, '2': {'precision': 0.412984606613455, 'recall': 0.0676314407422536, 'f1-score': 0.11622892786586038, 'support': 85685}, 'accuracy': 0.3541843241316488, 'macro avg': {'precision': 0.37389603729572407, 'recall': 0.340830576148937, 'f1-score': 0.24842651007908323, 'support': 252490}, 'weighted avg': {'precision': 0.37408137933025004, 'recall': 0.3541843241316488, 'f1-score': 0.25460077851717094, 'support': 252490}}
[[ 6148 68342  3906]
 [ 6593 77485  4331]
 [ 4404 75486  5795]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1215063
{'0': {'precision': 0.4022636892015907, 'recall': 0.06674449294487869, 'f1-score': 0.11449218579948629, 'support': 19702}, '1': {'precision': 0.33525619273837803, 'recall': 0.8872923215087561, 'f1-score': 0.48663957640684646, 'support': 20043}, '2': {'precision': 0.40800378877575183, 'recall': 0.08286442552782186, 'f1-score': 0.13775183882315317, 'support': 20793}, 'accuracy': 0.34394925501338003, 'macro avg': {'precision': 0.38184122357190686, 'recall': 0.3456337466604856, 'f1-score': 0.24629453367649531, 'support': 60538}, 'weighted avg': {'precision': 0.3820503131210026, 'recall': 0.34394925501338003, 'f1-score': 0.2456922273480083, 'support': 60538}}
[[ 1315 17152  1235]
 [  994 17784  1265]
 [  960 18110  1723]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1103224
{'0': {'precision': 0.41106719367588934, 'recall': 0.08961654459284792, 'f1-score': 0.14715245843650512, 'support': 6963}, '1': {'precision': 0.3451497517484384, 'recall': 0.8825938566552901, 'f1-score': 0.49623887012588275, 'support': 7325}, '2': {'precision': 0.4629080118694362, 'recall': 0.0853741961964701, 'f1-score': 0.14416079473258633, 'support': 7309}, 'accuracy': 0.35713293512987915, 'macro avg': {'precision': 0.40637498576458797, 'recall': 0.3525281991482027, 'f1-score': 0.26251737443165807, 'support': 21597}, 'weighted avg': {'precision': 0.4062544547796564, 'recall': 0.35713293512987915, 'f1-score': 0.2645387572563759, 'support': 21597}}
[[ 624 5994  345]
 [ 481 6465  379]
 [ 413 6272  624]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0389493
{'0': {'precision': 0.5069375619425174, 'recall': 0.10665755360680236, 'f1-score': 0.1762358233239221, 'support': 86323}, '1': {'precision': 0.46844629359080225, 'recall': 0.8402298605028733, 'f1-score': 0.6015278305265331, 'support': 140433}, '2': {'precision': 0.4832020777479893, 'recall': 0.2534106636789033, 'f1-score': 0.33246386418988055, 'support': 91038}, 'accuracy': 0.47286292378081396, 'macro avg': {'precision': 0.4861953110937696, 'recall': 0.40009935926285967, 'f1-score': 0.3700758393467786, 'support': 317794}, 'weighted avg': {'precision': 0.4831288201206521, 'recall': 0.47286292378081396, 'f1-score': 0.40892656270804956, 'support': 317794}}
[[  9207  68545   8571]
 [  6334 117996  16103]
 [  2621  65347  23070]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9919698
{'0': {'precision': 0.5169203811192641, 'recall': 0.14874574561956386, 'f1-score': 0.2310158333945134, 'support': 31732}, '1': {'precision': 0.5568496582497471, 'recall': 0.8286626712810556, 'f1-score': 0.6660937120111273, 'support': 71082}, '2': {'precision': 0.44713293006049093, 'recall': 0.2786379637994953, 'f1-score': 0.3433265517638478, 'support': 32099}, 'accuracy': 0.5378799670899024, 'macro avg': {'precision': 0.5069676564765008, 'recall': 0.41868212690003825, 'f1-score': 0.4134786990564962, 'support': 134913}, 'weighted avg': {'precision': 0.521353945604921, 'recall': 0.5378799670899024, 'f1-score': 0.4869679471030768, 'support': 134913}}
[[ 4720 24566  2446]
 [ 3566 58903  8613]
 [  845 22310  8944]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0069692
{'0': {'precision': 0.5157556270096463, 'recall': 0.15056791514127477, 'f1-score': 0.2330887161229383, 'support': 10653}, '1': {'precision': 0.5216724909570228, 'recall': 0.8509425471273564, 'f1-score': 0.6468140096159327, 'support': 19999}, '2': {'precision': 0.493006993006993, 'recall': 0.2410983705491853, 'f1-score': 0.32383139691975144, 'support': 9942}, 'accuracy': 0.5177858796866532, 'macro avg': {'precision': 0.5101450369912207, 'recall': 0.41420294427260546, 'f1-score': 0.40124470755287417, 'support': 40594}, 'weighted avg': {'precision': 0.5130991862260134, 'recall': 0.5177858796866532, 'f1-score': 0.45913827706909566, 'support': 40594}}
[[ 1604  8395   654]
 [ 1170 17018  1811]
 [  336  7209  2397]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.110835
{'0': {'precision': 0.47393705553033744, 'recall': 0.13573038089873032, 'f1-score': 0.2110253991780637, 'support': 92308}, '1': {'precision': 0.2853740585275818, 'recall': 0.7152841686357418, 'f1-score': 0.4079785498446566, 'support': 80410}, '2': {'precision': 0.47812919136416737, 'recall': 0.21777515026110947, 'f1-score': 0.29924991199328443, 'support': 101490}, 'accuracy': 0.33604781771501924, 'macro avg': {'precision': 0.4124801018073622, 'recall': 0.3562632332651939, 'f1-score': 0.30608462033866823, 'support': 274208}, 'weighted avg': {'precision': 0.42019358078410035, 'recall': 0.33604781771501924, 'f1-score': 0.30143453622263383, 'support': 274208}}
[[12529 69850  9929]
 [ 8699 57516 14195]
 [ 5208 74180 22102]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1009065
{'0': {'precision': 0.4713727603394854, 'recall': 0.1429330065359477, 'f1-score': 0.2193524119988716, 'support': 24480}, '1': {'precision': 0.32998107395999554, 'recall': 0.7312800690817879, 'f1-score': 0.45475816040811634, 'support': 24319}, '2': {'precision': 0.4300955957664732, 'recall': 0.20793100602459355, 'f1-score': 0.2803337969401947, 'support': 24234}, 'accuracy': 0.360412416304958, 'macro avg': {'precision': 0.41048314335531805, 'recall': 0.36071469388077637, 'f1-score': 0.31814812311572754, 'support': 73033}, 'weighted avg': {'precision': 0.41059454737650714, 'recall': 0.360412416304958, 'f1-score': 0.3179743401441271, 'support': 73033}}
[[ 3499 18391  2590]
 [ 2448 17784  4087]
 [ 1476 17719  5039]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0992328
{'0': {'precision': 0.4391025641025641, 'recall': 0.12927238414762005, 'f1-score': 0.1997408067390248, 'support': 9538}, '1': {'precision': 0.34287622439893145, 'recall': 0.7530067468465825, 'f1-score': 0.47119650013766934, 'support': 10227}, '2': {'precision': 0.4457168024664171, 'recall': 0.20151334129828755, 'f1-score': 0.2775454233801851, 'support': 10044}, 'accuracy': 0.3676070985272904, 'macro avg': {'precision': 0.40923186365597086, 'recall': 0.36126415743083, 'f1-score': 0.3161609100856264, 'support': 29809}, 'weighted avg': {'precision': 0.40831745336344133, 'recall': 0.3676070985272904, 'f1-score': 0.31908888771898897, 'support': 29809}}
[[1233 7339  966]
 [ 975 7701 1551]
 [ 600 7420 2024]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1141521
{'0': {'precision': 0.43855421686746987, 'recall': 0.08148369240787974, 'f1-score': 0.1374323535805407, 'support': 73708}, '1': {'precision': 0.3162487549261617, 'recall': 0.8608012730782265, 'f1-score': 0.462558641303272, 'support': 67867}, '2': {'precision': 0.5142684513850158, 'recall': 0.14120004083507734, 'f1-score': 0.22156587905486583, 'support': 78364}, 'accuracy': 0.3432360790946581, 'macro avg': {'precision': 0.4230238077262158, 'recall': 0.36116166877372785, 'f1-score': 0.27385229131289285, 'support': 219939}, 'weighted avg': {'precision': 0.42779107566996605, 'recall': 0.3432360790946581, 'f1-score': 0.2677338706336719, 'support': 219939}}
[[ 6006 62623  5079]
 [ 4075 58420  5372]
 [ 3614 63685 11065]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1135731
{'0': {'precision': 0.4676074406670943, 'recall': 0.07717824752090906, 'f1-score': 0.1324892469861271, 'support': 28337}, '1': {'precision': 0.3285261582700038, 'recall': 0.8420953670276775, 'f1-score': 0.47265550794689404, 'support': 26592}, '2': {'precision': 0.42196335670662743, 'recall': 0.1394662081339713, 'f1-score': 0.2096420745069394, 'support': 26752}, 'accuracy': 0.3466044735005693, 'macro avg': {'precision': 0.4060323185479085, 'recall': 0.35291327422751934, 'f1-score': 0.27159560981332015, 'support': 81681}, 'weighted avg': {'precision': 0.4073789910201282, 'recall': 0.3466044735005693, 'f1-score': 0.2685024404253049, 'support': 81681}}
[[ 2187 23860  2290]
 [ 1378 22393  2821]
 [ 1112 21909  3731]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1100681
{'0': {'precision': 0.45871559633027525, 'recall': 0.06943640782316861, 'f1-score': 0.12061513719971856, 'support': 8641}, '1': {'precision': 0.3388125265693637, 'recall': 0.8736906211936663, 'f1-score': 0.4882747353732004, 'support': 8210}, '2': {'precision': 0.4701853344077357, 'recall': 0.14389642416769421, 'f1-score': 0.2203549848942598, 'support': 8110}, 'accuracy': 0.3581587276150795, 'macro avg': {'precision': 0.4225711524357916, 'recall': 0.3623411510615097, 'f1-score': 0.27641495248905956, 'support': 24961}, 'weighted avg': {'precision': 0.4230045019458804, 'recall': 0.3581587276150795, 'f1-score': 0.27394935721522334, 'support': 24961}}
[[ 600 7381  660]
 [ 382 7173  655]
 [ 326 6617 1167]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.129028
{'0': {'precision': 0.4506201583202811, 'recall': 0.12637864919091546, 'f1-score': 0.19739648042724425, 'support': 168462}, '1': {'precision': 0.28902148036592334, 'recall': 0.7455370991849742, 'f1-score': 0.4165568588058026, 'support': 141836}, '2': {'precision': 0.4374536126772484, 'recall': 0.1870434705148762, 'f1-score': 0.2620439521868846, 'support': 179616}, 'accuracy': 0.3278738717407545, 'macro avg': {'precision': 0.3923650837878176, 'recall': 0.35298640629692196, 'f1-score': 0.2919990971399771, 'support': 489914}, 'weighted avg': {'precision': 0.39900817673054645, 'recall': 0.3278738717407545, 'f1-score': 0.28454759616445685, 'support': 489914}}
[[ 21290 126418  20754]
 [ 13643 105744  22449]
 [ 12313 133707  33596]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114219
{'0': {'precision': 0.44216138501168156, 'recall': 0.1191848729997255, 'f1-score': 0.1877591513825647, 'support': 61929}, '1': {'precision': 0.33422869479099127, 'recall': 0.7724226507055705, 'f1-score': 0.46657118418173493, 'support': 60731}, '2': {'precision': 0.4025425356223835, 'recall': 0.17346043725071578, 'f1-score': 0.24244737450844317, 'support': 60423}, 'accuracy': 0.3537848953753216, 'macro avg': {'precision': 0.39297753847501876, 'recall': 0.35502265365200386, 'f1-score': 0.2989259033575809, 'support': 183083}, 'weighted avg': {'precision': 0.3932832808379336, 'recall': 0.3537848953753216, 'f1-score': 0.2982934995736111, 'support': 183083}}
[[ 7381 47378  7170]
 [ 5435 46910  8386]
 [ 3877 46065 10481]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.139027
{'0': {'precision': 0.43429179978700744, 'recall': 0.10408902955740466, 'f1-score': 0.1679295009059463, 'support': 19589}, '1': {'precision': 0.2792344678936024, 'recall': 0.77284646650059, 'f1-score': 0.4102448106067197, 'support': 15254}, '2': {'precision': 0.42790697674418604, 'recall': 0.16717984957851698, 'f1-score': 0.2404268447606257, 'support': 19811}, 'accuracy': 0.3136092509239946, 'macro avg': {'precision': 0.3804777481415986, 'recall': 0.34803844854550386, 'f1-score': 0.27286705209109724, 'support': 54654}, 'weighted avg': {'precision': 0.3887007310637056, 'recall': 0.3136092509239946, 'f1-score': 0.2618388691732397, 'support': 54654}}
[[ 2039 15230  2320]
 [ 1357 11789  2108]
 [ 1299 15200  3312]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/EXC
Evaluating performance on  test set...
4918/4918 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.000963
{'0': {'precision': 0.4808070664425954, 'recall': 0.15217292599078938, 'f1-score': 0.23117892828284817, 'support': 308340}, '1': {'precision': 0.5324941258232121, 'recall': 0.8130237405357608, 'f1-score': 0.6435148530010016, 'support': 633305}, '2': {'precision': 0.4737110271638995, 'recall': 0.2901834552900637, 'f1-score': 0.3599007607171974, 'support': 317189}, 'accuracy': 0.5194139973975918, 'macro avg': {'precision': 0.49567073980990234, 'recall': 0.41846004060553793, 'f1-score': 0.41153151400034904, 'support': 1258834}, 'weighted avg': {'precision': 0.5050222429776041, 'recall': 0.5194139973975918, 'f1-score': 0.47105452118203023, 'support': 1258834}}
[[ 46921 237652  23767]
 [ 39921 514892  78492]
 [ 10746 214400  92043]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9808332
{'0': {'precision': 0.4427061147039461, 'recall': 0.14182743006016996, 'f1-score': 0.21483068365467736, 'support': 80605}, '1': {'precision': 0.584332795440999, 'recall': 0.8122890689731828, 'f1-score': 0.679707449057242, 'support': 197932}, '2': {'precision': 0.4663759071868158, 'recall': 0.3363126685976406, 'f1-score': 0.3908069222546442, 'support': 80443}, 'accuracy': 0.5550838486823778, 'macro avg': {'precision': 0.497804939110587, 'recall': 0.4301430558769978, 'f1-score': 0.42844835165552125, 'support': 358980}, 'weighted avg': {'precision': 0.5260993992555808, 'recall': 0.5550838486823778, 'f1-score': 0.5105854457343407, 'support': 358980}}
[[ 11432  63251   5922]
 [ 12121 160778  25033]
 [  2270  51119  27054]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98779196
{'0': {'precision': 0.4671490593342981, 'recall': 0.1664489515297353, 'f1-score': 0.24544417691040424, 'support': 29090}, '1': {'precision': 0.5607903554229199, 'recall': 0.8076087631105319, 'f1-score': 0.6619402178405428, 'support': 64452}, '2': {'precision': 0.49109154208478395, 'recall': 0.3287859052581065, 'f1-score': 0.3938734447501334, 'support': 29174}, 'accuracy': 0.5417875419668177, 'macro avg': {'precision': 0.5063436522806674, 'recall': 0.43428120663279124, 'f1-score': 0.4337526131670268, 'support': 122716}, 'weighted avg': {'precision': 0.5220226439301661, 'recall': 0.5417875419668177, 'f1-score': 0.4994801485032328, 'support': 122716}}
[[ 4842 22238  2010]
 [ 4470 52052  7930]
 [ 1053 18529  9592]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/AAL
Evaluating performance on  test set...
4856/4856 - 58s - 58s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0823044
{'0': {'precision': 0.4942881339983062, 'recall': 0.12958485874145195, 'f1-score': 0.2053374926215634, 'support': 405356}, '1': {'precision': 0.3769491503558862, 'recall': 0.7878148570041992, 'f1-score': 0.5099164107217646, 'support': 445083}, '2': {'precision': 0.45521928910893966, 'recall': 0.2394250638916988, 'f1-score': 0.31380347917271967, 'support': 392461}, 'accuracy': 0.3999806903210234, 'macro avg': {'precision': 0.44215219115437737, 'recall': 0.3856082598791166, 'f1-score': 0.3430191275053492, 'support': 1242900}, 'weighted avg': {'precision': 0.4399325263141443, 'recall': 0.3999806903210234, 'f1-score': 0.3486568008142138, 'support': 1242900}}
[[ 52528 303215  49613]
 [ 31601 350643  62839]
 [ 22141 276355  93965]]
Evaluating performance on  train set...
2076/2076 - 24s - 24s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0328064
{'0': {'precision': 0.4558935889421407, 'recall': 0.09493744123815723, 'f1-score': 0.1571493559354499, 'support': 138270}, '1': {'precision': 0.49110549904949563, 'recall': 0.8410465406413745, 'f1-score': 0.6201132734989948, 'support': 252489}, '2': {'precision': 0.42792035776340903, 'recall': 0.21362094830466902, 'f1-score': 0.2849785407725322, 'support': 140651}, 'accuracy': 0.48084906192958354, 'macro avg': {'precision': 0.45830648191834844, 'recall': 0.38320164339473356, 'f1-score': 0.35408039006899233, 'support': 531410}, 'weighted avg': {'precision': 0.4652200168087148, 'recall': 0.48084906192958354, 'f1-score': 0.41095075082493704, 'support': 531410}}
[[ 13127 113724  11419]
 [ 11385 212355  28749]
 [  4282 106323  30046]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0245683
{'0': {'precision': 0.4868962935230251, 'recall': 0.13187983267841297, 'f1-score': 0.2075445350994434, 'support': 39445}, '1': {'precision': 0.5010284140859556, 'recall': 0.8412030912761957, 'f1-score': 0.6280088778464467, 'support': 71815}, '2': {'precision': 0.45045139617887886, 'recall': 0.2197695262483995, 'f1-score': 0.29541151767581153, 'support': 39050}, 'accuracy': 0.49361319938793163, 'macro avg': {'precision': 0.47945870126261986, 'recall': 0.3976174834010027, 'f1-score': 0.37698831020723383, 'support': 150310}, 'weighted avg': {'precision': 0.48418007369026583, 'recall': 0.49361319938793163, 'f1-score': 0.4312612036110741, 'support': 150310}}
[[ 5202 31160  3083]
 [ 4017 60411  7387]
 [ 1465 29003  8582]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/WBA
Evaluating performance on  test set...
4353/4353 - 54s - 54s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.051274
{'0': {'precision': 0.5518001287574902, 'recall': 0.1335574773608539, 'f1-score': 0.21506154610770933, 'support': 333714}, '1': {'precision': 0.4252707831882985, 'recall': 0.8212463658649409, 'f1-score': 0.5603646696191752, 'support': 447493}, '2': {'precision': 0.46916168195050517, 'recall': 0.23854315531590387, 'f1-score': 0.3162767924494504, 'support': 333076}, 'accuracy': 0.44111325399382384, 'macro avg': {'precision': 0.4820775312987646, 'recall': 0.3977823328472329, 'f1-score': 0.363901002725445, 'support': 1114283}, 'weighted avg': {'precision': 0.47628441170403285, 'recall': 0.44111325399382384, 'f1-score': 0.3839890986594741, 'support': 1114283}}
[[ 44570 254201  34943]
 [ 25036 367502  54955]
 [ 11166 242457  79453]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0717504
{'0': {'precision': 0.5416154521510097, 'recall': 0.14559257365377806, 'f1-score': 0.22949437331431935, 'support': 127115}, '1': {'precision': 0.3855756884006278, 'recall': 0.8336429728194954, 'f1-score': 0.5272761537352977, 'support': 142639}, '2': {'precision': 0.49363412570197707, 'recall': 0.20565188128966091, 'f1-score': 0.2903441098617678, 'support': 124808}, 'accuracy': 0.41332921061835654, 'macro avg': {'precision': 0.4736084220845382, 'recall': 0.39496247592097816, 'f1-score': 0.34903821230379495, 'support': 394562}, 'weighted avg': {'precision': 0.47002769343871204, 'recall': 0.41332921061835654, 'f1-score': 0.35639414900605315, 'support': 394562}}
[[ 18507  97119  11489]
 [  8889 118910  14840]
 [  6774  92367  25667]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.072147
{'0': {'precision': 0.5487804878048781, 'recall': 0.12165606735497825, 'f1-score': 0.19916120466184745, 'support': 38839}, '1': {'precision': 0.3936013057716346, 'recall': 0.8333187524605223, 'f1-score': 0.5346645804536813, 'support': 45722}, '2': {'precision': 0.4666443178008716, 'recall': 0.21554660885723134, 'f1-score': 0.29488401652367335, 'support': 38748}, 'accuracy': 0.41503864275924707, 'macro avg': {'precision': 0.4696753704591281, 'recall': 0.3901738095575773, 'f1-score': 0.3429032672130674, 'support': 123309}, 'weighted avg': {'precision': 0.46543121989873015, 'recall': 0.41503864275924707, 'f1-score': 0.3536426525851641, 'support': 123309}}
[[ 4725 29956  4158]
 [ 2233 38101  5388]
 [ 1652 28744  8352]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0825597
{'0': {'precision': 0.4894552290062538, 'recall': 0.14806625242497612, 'f1-score': 0.22735485344294887, 'support': 457221}, '1': {'precision': 0.3647981946611248, 'recall': 0.7753745253429155, 'f1-score': 0.4961620674985449, 'support': 490354}, '2': {'precision': 0.4737534140196524, 'recall': 0.23360768981399893, 'f1-score': 0.31291638737504734, 'support': 459621}, 'accuracy': 0.39459890448807416, 'macro avg': {'precision': 0.442668945895677, 'recall': 0.38568282252729685, 'f1-score': 0.34547776943884706, 'support': 1407196}, 'weighted avg': {'precision': 0.4408884626672164, 'recall': 0.39459890448807416, 'f1-score': 0.3489701582252413, 'support': 1407196}}
[[ 67699 338979  50543]
 [ 41421 380208  68725]
 [ 29195 323055 107371]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.085983
{'0': {'precision': 0.4991284137129576, 'recall': 0.12204015912104565, 'f1-score': 0.1961261844057993, 'support': 168928}, '1': {'precision': 0.3708726879533688, 'recall': 0.8295878650029632, 'f1-score': 0.5125890736342044, 'support': 187293}, '2': {'precision': 0.4605170264221231, 'recall': 0.1797037566748533, 'f1-score': 0.25852531453435423, 'support': 170603}, 'accuracy': 0.39225623737718857, 'macro avg': {'precision': 0.44350604269614985, 'recall': 0.3771105935996208, 'f1-score': 0.32241352419145264, 'support': 526824}, 'weighted avg': {'precision': 0.44102814085016295, 'recall': 0.39225623737718857, 'f1-score': 0.32883988520450536, 'support': 526824}}
[[ 20616 132581  15731]
 [ 11733 155376  20184]
 [  8955 130990  30658]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1003684
{'0': {'precision': 0.49097760707297633, 'recall': 0.11501179825827151, 'f1-score': 0.18636701235111272, 'support': 58907}, '1': {'precision': 0.3406466007524718, 'recall': 0.8168514179809071, 'f1-score': 0.4807915941999157, 'support': 57194}, '2': {'precision': 0.4638146625556698, 'recall': 0.18610605175435582, 'f1-score': 0.2656284488044145, 'support': 58198}, 'accuracy': 0.3690497363725552, 'macro avg': {'precision': 0.43181295679370596, 'recall': 0.3726564226645115, 'f1-score': 0.3109290184518143, 'support': 174299}, 'weighted avg': {'precision': 0.4325787601460683, 'recall': 0.3690497363725552, 'f1-score': 0.3094438895160402, 'support': 174299}}
[[ 6775 46328  5804]
 [ 3758 46719  6717]
 [ 3266 44101 10831]]
testing model on single stock: results/universal/W2/deepOF_L1/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 181s - 181s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0477937
{'0': {'precision': 0.37239585061689884, 'recall': 0.11575372986532875, 'f1-score': 0.17661065549905652, 'support': 969472}, '1': {'precision': 0.4901319882216324, 'recall': 0.8154197030617212, 'f1-score': 0.6122519437033805, 'support': 1855133}, '2': {'precision': 0.34390069443786536, 'recall': 0.1473669146818852, 'f1-score': 0.20632170065953773, 'support': 985289}, 'accuracy': 0.4646142386113629, 'macro avg': {'precision': 0.40214284442546555, 'recall': 0.35951344920297834, 'f1-score': 0.3317280999539916, 'support': 3809894}, 'weighted avg': {'precision': 0.4223553062412806, 'recall': 0.4646142386113629, 'f1-score': 0.3964190007930405, 'support': 3809894}}
[[ 112220  783791   73461]
 [ 138869 1512712  203552]
 [  50257  789833  145199]]
Evaluating performance on  train set...
6147/6147 - 75s - 75s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10703
{'0': {'precision': 0.45530181796118346, 'recall': 0.11554636810002522, 'f1-score': 0.18431685600245626, 'support': 519549}, '1': {'precision': 0.3318169995318146, 'recall': 0.7985866064687119, 'f1-score': 0.46883185831701707, 'support': 519176}, '2': {'precision': 0.4295387946514545, 'recall': 0.15432401198299045, 'f1-score': 0.22706755539046755, 'support': 534758}, 'accuracy': 0.35409661241970836, 'macro avg': {'precision': 0.40555253738148417, 'recall': 0.3561523288505759, 'f1-score': 0.2934054232366469, 'support': 1573483}, 'weighted avg': {'precision': 0.4058018634577347, 'recall': 0.35409661241970836, 'f1-score': 0.29272262800316967, 'support': 1573483}}
[[ 60032 413089  46428]
 [ 41396 414607  63173]
 [ 30423 421809  82526]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0937021
{'0': {'precision': 0.43962424939059436, 'recall': 0.12585099623292334, 'f1-score': 0.19568371978140728, 'support': 176264}, '1': {'precision': 0.35996872017203907, 'recall': 0.7844276263031275, 'f1-score': 0.49348184233137055, 'support': 199520}, '2': {'precision': 0.42102751933089155, 'recall': 0.16601464151528064, 'f1-score': 0.23813190040400353, 'support': 180719}, 'accuracy': 0.3750096585283458, 'macro avg': {'precision': 0.4068734962978417, 'recall': 0.3587644213504438, 'f1-score': 0.30909915417226047, 'support': 556503}, 'weighted avg': {'precision': 0.405026675524244, 'recall': 0.3750096585283458, 'f1-score': 0.31623630290333765, 'support': 556503}}
[[ 22183 138150  15931]
 [ 17685 156509  25326]
 [ 10591 140126  30002]]
training model: results/universal/W2/deepOF_L1/h100
Epoch 1/50
9940/9940 - 208s - loss: 3.2353 - accuracy100: 0.4057 - val_loss: 3.2704 - val_accuracy100: 0.3842 - 208s/epoch - 21ms/step
Epoch 2/50
9940/9940 - 200s - loss: 3.2319 - accuracy100: 0.4048 - val_loss: 3.2677 - val_accuracy100: 0.3861 - 200s/epoch - 20ms/step
Epoch 3/50
9940/9940 - 204s - loss: 3.2260 - accuracy100: 0.4077 - val_loss: 3.2665 - val_accuracy100: 0.3868 - 204s/epoch - 21ms/step
Epoch 4/50
9940/9940 - 206s - loss: 3.2210 - accuracy100: 0.4107 - val_loss: 3.2657 - val_accuracy100: 0.3872 - 206s/epoch - 21ms/step
Epoch 5/50
9940/9940 - 204s - loss: 3.2175 - accuracy100: 0.4126 - val_loss: 3.2647 - val_accuracy100: 0.3874 - 204s/epoch - 21ms/step
Epoch 6/50
9940/9940 - 203s - loss: 3.2123 - accuracy100: 0.4155 - val_loss: 3.2668 - val_accuracy100: 0.3858 - 203s/epoch - 20ms/step
Epoch 7/50
9940/9940 - 202s - loss: 3.2088 - accuracy100: 0.4176 - val_loss: 3.2670 - val_accuracy100: 0.3855 - 202s/epoch - 20ms/step
Epoch 8/50
9940/9940 - 202s - loss: 3.2049 - accuracy100: 0.4193 - val_loss: 3.2673 - val_accuracy100: 0.3847 - 202s/epoch - 20ms/step
Epoch 9/50
9940/9940 - 203s - loss: 3.2018 - accuracy100: 0.4213 - val_loss: 3.2728 - val_accuracy100: 0.3821 - 203s/epoch - 20ms/step
Epoch 10/50
9940/9940 - 205s - loss: 3.1990 - accuracy100: 0.4225 - val_loss: 3.2723 - val_accuracy100: 0.3822 - 205s/epoch - 21ms/step
Epoch 11/50
9940/9940 - 202s - loss: 3.1957 - accuracy100: 0.4242 - val_loss: 3.2775 - val_accuracy100: 0.3809 - 202s/epoch - 20ms/step
Epoch 12/50
9940/9940 - 203s - loss: 3.1936 - accuracy100: 0.4249 - val_loss: 3.2823 - val_accuracy100: 0.3779 - 203s/epoch - 20ms/step
Epoch 13/50
9940/9940 - 204s - loss: 3.1908 - accuracy100: 0.4261 - val_loss: 3.2900 - val_accuracy100: 0.3760 - 204s/epoch - 20ms/step
Epoch 14/50
9940/9940 - 203s - loss: 3.1876 - accuracy100: 0.4278 - val_loss: 3.2996 - val_accuracy100: 0.3748 - 203s/epoch - 20ms/step
Epoch 15/50
9940/9940 - 202s - loss: 3.1851 - accuracy100: 0.4285 - val_loss: 3.3037 - val_accuracy100: 0.3759 - 202s/epoch - 20ms/step
testing model in sample: results/universal/W2/deepOF_L1/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 314s - 314s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081427
{'0': {'precision': 0.4078007999350112, 'recall': 0.31865014966028304, 'f1-score': 0.3577551547100799, 'support': 2142519}, '1': {'precision': 0.3699709622307768, 'recall': 0.46241198135123873, 'f1-score': 0.41105841249305036, 'support': 2385574}, '2': {'precision': 0.41678636147476916, 'recall': 0.3925170946037468, 'f1-score': 0.4042878365285811, 'support': 2192651}, 'accuracy': 0.39377857570530883, 'macro avg': {'precision': 0.398186041213519, 'recall': 0.39119307520508956, 'f1-score': 0.3910338012439038, 'support': 6720744}, 'weighted avg': {'precision': 0.39730439109162585, 'recall': 0.39377857570530883, 'f1-score': 0.39185685493915723, 'support': 6720744}}
[[ 682714  954487  505318]
 [ 583453 1103118  699003]
 [ 407969  924029  860653]]
Evaluating performance on  train set...
9940/9940 - 123s - 123s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0879401
{'0': {'precision': 0.40937381816734214, 'recall': 0.32067822793342454, 'f1-score': 0.3596381142232247, 'support': 833761}, '1': {'precision': 0.3531230674087817, 'recall': 0.45354662936764967, 'f1-score': 0.397083905879276, 'support': 863651}, '2': {'precision': 0.4127796835799498, 'recall': 0.3810887879679558, 'f1-score': 0.39630169215956035, 'support': 846207}, 'accuracy': 0.38588916028697695, 'macro avg': {'precision': 0.39175885638535785, 'recall': 0.38510454842301, 'f1-score': 0.384341237420687, 'support': 2543619}, 'weighted avg': {'precision': 0.3914077037491942, 'recall': 0.38588916028697695, 'f1-score': 0.38454949902744, 'support': 2543619}}
[[267369 365815 200577]
 [213762 391706 258183]
 [171986 351741 322480]]
Evaluating performance on  val set...
3393/3393 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0874242
{'0': {'precision': 0.41745404493384247, 'recall': 0.32667264287302644, 'f1-score': 0.3665258036598392, 'support': 287808}, '1': {'precision': 0.34660295526211, 'recall': 0.44646533260322585, 'f1-score': 0.39024685785604146, 'support': 288542}, '2': {'precision': 0.41864101155291367, 'recall': 0.38915720881765176, 'f1-score': 0.40336104597456124, 'support': 291733}, 'accuracy': 0.38748944513370265, 'macro avg': {'precision': 0.39423267058295536, 'recall': 0.387431728097968, 'f1-score': 0.38671123583014727, 'support': 868083}, 'weighted avg': {'precision': 0.39430275895844663, 'recall': 0.38748944513370265, 'f1-score': 0.38678950674592827, 'support': 868083}}
[[ 94019 123622  70167]
 [ 72228 128824  87490]
 [ 58973 119230 113530]]
testing model out of sample: results/universal/W2/deepOF_L1/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 174s - 174s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0930699
{'0': {'precision': 0.4303154346523415, 'recall': 0.30302774085156287, 'f1-score': 0.35562481078972863, 'support': 1277322}, '1': {'precision': 0.30608313350798405, 'recall': 0.45907589752406197, 'f1-score': 0.36728414233738577, 'support': 1081893}, '2': {'precision': 0.4393605532994569, 'recall': 0.3846070304009276, 'f1-score': 0.41016457691437147, 'support': 1307493}, 'accuracy': 0.3781610098213438, 'macro avg': {'precision': 0.3919197071532608, 'recall': 0.38223688959218416, 'f1-score': 0.3776911766804953, 'support': 3666708}, 'weighted avg': {'precision': 0.39688500395900583, 'recall': 0.3781610098213438, 'f1-score': 0.37851305594470064, 'support': 3666708}}
[[387064 569638 320620]
 [264161 496671 321061]
 [248264 556358 502871]]
Evaluating performance on  train set...
5373/5373 - 68s - 68s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898861
{'0': {'precision': 0.4141197319322592, 'recall': 0.29028258002716234, 'f1-score': 0.3413155868017028, 'support': 457251}, '1': {'precision': 0.3491549420957187, 'recall': 0.4872825476686847, 'f1-score': 0.4068136873287108, 'support': 459526}, '2': {'precision': 0.4136761448233286, 'recall': 0.37299038879223595, 'f1-score': 0.3922811496316431, 'support': 458111}, 'accuracy': 0.38368361641093673, 'macro avg': {'precision': 0.3923169396171022, 'recall': 0.3835185054960277, 'f1-score': 0.38013680792068555, 'support': 1374888}, 'weighted avg': {'precision': 0.3922588806131078, 'recall': 0.38368361641093673, 'f1-score': 0.3801885459782762, 'support': 1374888}}
[[132732 215258 109261]
 [102684 223919 132923]
 [ 85100 202140 170871]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903431
{'0': {'precision': 0.41991322093728745, 'recall': 0.31236708038431293, 'f1-score': 0.35824278381441244, 'support': 146235}, '1': {'precision': 0.3376538299564831, 'recall': 0.46683678970635806, 'f1-score': 0.39187338212844014, 'support': 139115}, '2': {'precision': 0.4183005526908945, 'recall': 0.3729037496817347, 'f1-score': 0.3942997886250441, 'support': 145319}, 'accuracy': 0.38269065105684413, 'macro avg': {'precision': 0.39195586786155506, 'recall': 0.3840358732574685, 'f1-score': 0.38147198485596556, 'support': 430669}, 'weighted avg': {'precision': 0.3927975787313423, 'recall': 0.38269065105684413, 'f1-score': 0.3812727408499366, 'support': 430669}}
[[45679 65129 35427]
 [34240 64944 39931]
 [28863 62266 54190]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089354
{'0': {'precision': 0.31790757178507123, 'recall': 0.27260414973725555, 'f1-score': 0.29351804593510755, 'support': 73836}, '1': {'precision': 0.3731251760884337, 'recall': 0.4627083461783505, 'f1-score': 0.41311607765422587, 'support': 97314}, '2': {'precision': 0.39030336652165026, 'recall': 0.3286820752397345, 'f1-score': 0.3568520668989175, 'support': 81340}, 'accuracy': 0.3639391659075607, 'macro avg': {'precision': 0.36044537146505173, 'recall': 0.35466485705178014, 'f1-score': 0.35449539682941694, 'support': 252490}, 'weighted avg': {'precision': 0.362511793295035, 'recall': 0.3639391659075607, 'f1-score': 0.36001633150645923, 'support': 252490}}
[[20128 36643 17065]
 [27588 45028 24698]
 [15598 39007 26735]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007028
{'0': {'precision': 0.38144997974888617, 'recall': 0.23881732427223856, 'f1-score': 0.2937342107725416, 'support': 19718}, '1': {'precision': 0.3355689252720518, 'recall': 0.5113215108706542, 'f1-score': 0.4052085194227753, 'support': 19962}, '2': {'precision': 0.3899077407740774, 'recall': 0.33229456323712725, 'f1-score': 0.35880312677952064, 'support': 20858}, 'accuracy': 0.3608807691037035, 'macro avg': {'precision': 0.3689755485983384, 'recall': 0.36081113279334004, 'f1-score': 0.3525819523249458, 'support': 60538}, 'weighted avg': {'precision': 0.3692350795208785, 'recall': 0.3608807691037035, 'f1-score': 0.35291121693973465, 'support': 60538}}
[[ 4709  9988  5021]
 [ 3931 10207  5824]
 [ 3705 10222  6931]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0923613
{'0': {'precision': 0.37664748468535364, 'recall': 0.29512727272727274, 'f1-score': 0.33094111890393085, 'support': 6875}, '1': {'precision': 0.35272373540856033, 'recall': 0.48179643901142705, 'f1-score': 0.4072784454678199, 'support': 7526}, '2': {'precision': 0.4065767284991568, 'recall': 0.33504724847137296, 'f1-score': 0.3673624866676825, 'support': 7196}, 'accuracy': 0.3734777978422929, 'macro avg': {'precision': 0.37864931619769027, 'recall': 0.3706569867366909, 'f1-score': 0.3685273503464777, 'support': 21597}, 'weighted avg': {'precision': 0.37828292948912184, 'recall': 0.3734777978422929, 'f1-score': 0.3696781139563819, 'support': 21597}}
[[2029 3323 1523]
 [1904 3626 1996]
 [1454 3331 2411]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0774455
{'0': {'precision': 0.43301510700797313, 'recall': 0.23621709271270508, 'f1-score': 0.3056803594351733, 'support': 104840}, '1': {'precision': 0.33025923943623314, 'recall': 0.4849712322279657, 'f1-score': 0.39293484694481523, 'support': 99243}, '2': {'precision': 0.45425183689104015, 'recall': 0.45887381168048824, 'f1-score': 0.45655112674392656, 'support': 113711}, 'accuracy': 0.39356941918349625, 'macro avg': {'precision': 0.4058420611117488, 'recall': 0.39335404554038633, 'f1-score': 0.38505544437463834, 'support': 317794}, 'weighted avg': {'precision': 0.4085245540910246, 'recall': 0.39356941918349625, 'f1-score': 0.3869124246263507, 'support': 317794}}
[[24765 50382 29693]
 [18117 48130 32996]
 [14310 47222 52179]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.05306
{'0': {'precision': 0.45351700784977683, 'recall': 0.28395210446430724, 'f1-score': 0.3492406844951478, 'support': 41507}, '1': {'precision': 0.4059763502716523, 'recall': 0.49714308077645586, 'f1-score': 0.4469582351078428, 'support': 51104}, '2': {'precision': 0.44330564246412774, 'recall': 0.4856744361968701, 'f1-score': 0.4635238643157693, 'support': 42302}, 'accuracy': 0.42795727617056917, 'macro avg': {'precision': 0.4342663335285189, 'recall': 0.4222565404792111, 'f1-score': 0.41990759463958666, 'support': 134913}, 'weighted avg': {'precision': 0.4323071989846845, 'recall': 0.42795727617056917, 'f1-score': 0.4220888516790596, 'support': 134913}}
[[11786 20133  9588]
 [ 9486 25406 16212]
 [ 4716 17041 20545]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0609939
{'0': {'precision': 0.4570404505888377, 'recall': 0.3233823635968408, 'f1-score': 0.3787660188407027, 'support': 13801}, '1': {'precision': 0.38302668134402684, 'recall': 0.509305081201645, 'f1-score': 0.43723073240785065, 'support': 14347}, '2': {'precision': 0.4420524166099387, 'recall': 0.417403181745139, 'f1-score': 0.42937432845689727, 'support': 12446}, 'accuracy': 0.41791890427156725, 'macro avg': {'precision': 0.42737318284760106, 'recall': 0.41669687551454154, 'f1-score': 0.41512369323515025, 'support': 40594}, 'weighted avg': {'precision': 0.42628672791414, 'recall': 0.41791890427156725, 'f1-score': 0.4149453622666038, 'support': 40594}}
[[4463 6399 2939]
 [3422 7307 3618]
 [1880 5371 5195]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0971812
{'0': {'precision': 0.4102286889799841, 'recall': 0.2993939792440631, 'f1-score': 0.34615579544878616, 'support': 91251}, '1': {'precision': 0.2933724252242647, 'recall': 0.438171775477707, 'f1-score': 0.35144155695135276, 'support': 80384}, '2': {'precision': 0.44720851608187134, 'recall': 0.38171838593002055, 'f1-score': 0.41187639710716634, 'support': 102573}, 'accuracy': 0.37087174699498193, 'macro avg': {'precision': 0.3836032100953734, 'recall': 0.37309471355059687, 'f1-score': 0.3698245831691018, 'support': 274208}, 'weighted avg': {'precision': 0.38980535304369535, 'recall': 0.37087174699498193, 'f1-score': 0.3722894236672457, 'support': 274208}}
[[27320 41118 22813]
 [19577 35222 25585]
 [19700 43719 39154]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989434
{'0': {'precision': 0.4052106719573957, 'recall': 0.31384204779813174, 'f1-score': 0.3537213436032997, 'support': 24729}, '1': {'precision': 0.3313315134971186, 'recall': 0.4530900041476566, 'f1-score': 0.3827610371408549, 'support': 24110}, '2': {'precision': 0.3932089909134385, 'recall': 0.339836323055303, 'f1-score': 0.3645796381695637, 'support': 24194}, 'accuracy': 0.3684224939410951, 'macro avg': {'precision': 0.3765837254559843, 'recall': 0.3689227916670304, 'f1-score': 0.36702067297123947, 'support': 73033}, 'weighted avg': {'precision': 0.37684547839209254, 'recall': 0.3684224939410951, 'f1-score': 0.36690514530837337, 'support': 73033}}
[[ 7761 11273  5695]
 [ 6193 10924  6993]
 [ 5199 10773  8222]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0915278
{'0': {'precision': 0.3883601756954612, 'recall': 0.3343487394957983, 'f1-score': 0.35933619327161886, 'support': 9520}, '1': {'precision': 0.35126654932272133, 'recall': 0.4419836302359172, 'f1-score': 0.39143783046222064, 'support': 10385}, '2': {'precision': 0.4097823543178095, 'recall': 0.35359450726978997, 'f1-score': 0.37962059620596206, 'support': 9904}, 'accuracy': 0.37824147069676944, 'macro avg': {'precision': 0.38313635977866395, 'recall': 0.3766422923338351, 'f1-score': 0.3767982066466005, 'support': 29809}, 'weighted avg': {'precision': 0.382554813126936, 'recall': 0.37824147069676944, 'f1-score': 0.37725937851386565, 'support': 29809}}
[[3183 4281 2056]
 [2807 4590 2988]
 [2206 4196 3502]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0984267
{'0': {'precision': 0.4055765183948915, 'recall': 0.3047158239062287, 'f1-score': 0.3479851199277787, 'support': 73370}, '1': {'precision': 0.3171947182714343, 'recall': 0.5339374827786793, 'f1-score': 0.3979690798105996, 'support': 65326}, '2': {'precision': 0.47745711108275146, 'recall': 0.3223539258766909, 'f1-score': 0.38486634238100137, 'support': 81243}, 'accuracy': 0.37931426440967725, 'macro avg': {'precision': 0.40007611591635905, 'recall': 0.38700241085386633, 'f1-score': 0.37694018070645985, 'support': 219939}, 'weighted avg': {'precision': 0.40587735415787507, 'recall': 0.37931426440967725, 'f1-score': 0.37645480160802786, 'support': 219939}}
[[22357 36799 14214]
 [15998 34880 14448]
 [16769 38285 26189]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1022602
{'0': {'precision': 0.4005154368063956, 'recall': 0.27395042630499694, 'f1-score': 0.3253578295236061, 'support': 27797}, '1': {'precision': 0.32963352321345624, 'recall': 0.5029468815279021, 'f1-score': 0.3982513919451788, 'support': 26808}, '2': {'precision': 0.382127268550425, 'recall': 0.30717240360466835, 'f1-score': 0.34057451731127536, 'support': 27076}, 'accuracy': 0.3601204686524406, 'macro avg': {'precision': 0.37075874285675897, 'recall': 0.3613565704791892, 'f1-score': 0.3547279129266867, 'support': 81681}, 'weighted avg': {'precision': 0.3711563400360552, 'recall': 0.3601204686524406, 'f1-score': 0.3543258595420492, 'support': 81681}}
[[ 7615 14174  6008]
 [ 5885 13483  7440]
 [ 5513 13246  8317]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1003584
{'0': {'precision': 0.3967791673805037, 'recall': 0.2735971647962197, 'f1-score': 0.3238707873024752, 'support': 8465}, '1': {'precision': 0.33387685379299636, 'recall': 0.526702596766291, 'f1-score': 0.408686974290738, 'support': 8164}, '2': {'precision': 0.40512409927942356, 'recall': 0.30364858377340376, 'f1-score': 0.3471221787747822, 'support': 8332}, 'accuracy': 0.36641160209927487, 'macro avg': {'precision': 0.3785933734843079, 'recall': 0.36798278177863813, 'f1-score': 0.3598933134559985, 'support': 24961}, 'weighted avg': {'precision': 0.3789912375881632, 'recall': 0.36641160209927487, 'f1-score': 0.3593729684778864, 'support': 24961}}
[[2316 4421 1728]
 [1877 4300 1987]
 [1644 4158 2530]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1115935
{'0': {'precision': 0.3762196003708776, 'recall': 0.270476213773323, 'f1-score': 0.3147026803947659, 'support': 163519}, '1': {'precision': 0.3118060856290334, 'recall': 0.4678562364562794, 'f1-score': 0.3742143684368046, 'support': 153669}, '2': {'precision': 0.3916376896437413, 'recall': 0.32146868450609634, 'f1-score': 0.3531009045961113, 'support': 172726}, 'accuracy': 0.35036557436611326, 'macro avg': {'precision': 0.3598877918812174, 'recall': 0.3532670449118996, 'f1-score': 0.3473393178092273, 'support': 489914}, 'weighted avg': {'precision': 0.3614511807929113, 'recall': 0.35036557436611326, 'f1-score': 0.3469072576534963, 'support': 489914}}
[[44228 77703 41588]
 [37109 71895 44665]
 [36222 80978 55526]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.10812
{'0': {'precision': 0.37551385165326184, 'recall': 0.27464949834961927, 'f1-score': 0.3172577813850771, 'support': 61198}, '1': {'precision': 0.33306649894219226, 'recall': 0.4727930911334048, 'f1-score': 0.3908163196843949, 'support': 61602}, '2': {'precision': 0.36780140728802235, 'recall': 0.3104191894895742, 'f1-score': 0.33668282940959515, 'support': 60283}, 'accuracy': 0.3530966829252306, 'macro avg': {'precision': 0.35879391929449217, 'recall': 0.3526205929908661, 'f1-score': 0.34825231015968905, 'support': 183083}, 'weighted avg': {'precision': 0.35869213087428703, 'recall': 0.3530966829252306, 'f1-score': 0.3484040551864491, 'support': 183083}}
[[16808 29495 14895]
 [15207 29125 17270]
 [12745 28825 18713]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1153114
{'0': {'precision': 0.38353752475973885, 'recall': 0.26832272633956067, 'f1-score': 0.31574815038502196, 'support': 19484}, '1': {'precision': 0.28832357389382246, 'recall': 0.46944058593256727, 'f1-score': 0.3572372372372372, 'support': 15838}, '2': {'precision': 0.39406668416907326, 'recall': 0.31057314297537764, 'f1-score': 0.3473732932191622, 'support': 19332}, 'accuracy': 0.34154865151681485, 'macro avg': {'precision': 0.35530926094087817, 'recall': 0.3494454850825018, 'f1-score': 0.3401195602804738, 'support': 54654}, 'weighted avg': {'precision': 0.35967012540903937, 'recall': 0.34154865151681485, 'f1-score': 0.3389574565444062, 'support': 54654}}
[[5228 9321 4935]
 [4106 7435 4297]
 [4297 9031 6004]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/EXC
Evaluating performance on  test set...
4918/4918 - 61s - 61s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0659363
{'0': {'precision': 0.47974884103045595, 'recall': 0.2995705449535368, 'f1-score': 0.368831121958702, 'support': 409356}, '1': {'precision': 0.3703553402490679, 'recall': 0.5788310240781245, 'f1-score': 0.45169877892446003, 'support': 428854}, '2': {'precision': 0.4895753243632869, 'recall': 0.38754089162767696, 'f1-score': 0.43262330410412114, 'support': 420624}, 'accuracy': 0.42410198644142116, 'macro avg': {'precision': 0.4465598352142702, 'recall': 0.42198082021977945, 'f1-score': 0.41771773499576104, 'support': 1258834}, 'weighted avg': {'precision': 0.4457645463111262, 'recall': 0.42410198644142116, 'f1-score': 0.4183774870736639, 'support': 1258834}}
[[122631 215514  71211]
 [ 81880 248234  98740]
 [ 51104 206511 163009]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0558453
{'0': {'precision': 0.4456477319166326, 'recall': 0.27620081411126185, 'f1-score': 0.34103626595780323, 'support': 110550}, '1': {'precision': 0.41428002442845385, 'recall': 0.5644340899060133, 'f1-score': 0.47783875828443323, 'support': 138211}, '2': {'precision': 0.46860286416272673, 'recall': 0.4343352779466335, 'f1-score': 0.45081882304193466, 'support': 110219}, 'accuracy': 0.43572622430218955, 'macro avg': {'precision': 0.442843540169271, 'recall': 0.4249900606546362, 'f1-score': 0.423231282428057, 'support': 358980}, 'weighted avg': {'precision': 0.44061884312445365, 'recall': 0.43572622430218955, 'f1-score': 0.42741359317996525, 'support': 358980}}
[[30534 59965 20051]
 [25964 78011 34236]
 [12018 50329 47872]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.059459
{'0': {'precision': 0.4609040928527795, 'recall': 0.3091500422546032, 'f1-score': 0.3700740331999816, 'support': 39049}, '1': {'precision': 0.38855449722317026, 'recall': 0.5701051577366049, 'f1-score': 0.4621388243108602, 'support': 43934}, '2': {'precision': 0.49485372091572577, 'recall': 0.399315430498578, 'f1-score': 0.4419806393202869, 'support': 39733}, 'accuracy': 0.43176928843834544, 'macro avg': {'precision': 0.4481041036638918, 'recall': 0.426190210163262, 'f1-score': 0.42473116561037627, 'support': 122716}, 'weighted avg': {'precision': 0.44599416617193754, 'recall': 0.43176928843834544, 'f1-score': 0.4263164116481337, 'support': 122716}}
[[12072 20682  6295]
 [ 8986 25047  9901]
 [ 5134 18733 15866]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/AAL
Evaluating performance on  test set...
4856/4856 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965607
{'0': {'precision': 0.4803852671006867, 'recall': 0.28120614767791513, 'f1-score': 0.35475003457564164, 'support': 478880}, '1': {'precision': 0.26457537385280394, 'recall': 0.48431592627599246, 'f1-score': 0.3422073863998692, 'support': 304704}, '2': {'precision': 0.45663558974511, 'recall': 0.4024397147062153, 'f1-score': 0.42782814384146606, 'support': 459316}, 'accuracy': 0.37580175396250703, 'macro avg': {'precision': 0.4005320768995335, 'recall': 0.389320596220041, 'f1-score': 0.374928521605659, 'support': 1242900}, 'weighted avg': {'precision': 0.4187015077343202, 'recall': 0.37580175396250703, 'f1-score': 0.37868128388434774, 'support': 1242900}}
[[134664 215654 128562]
 [ 65738 147573  91393]
 [ 79923 194546 184847]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0826974
{'0': {'precision': 0.4269644750318952, 'recall': 0.2711699990870081, 'f1-score': 0.3316838248124237, 'support': 175248}, '1': {'precision': 0.3586540682990246, 'recall': 0.5117586255063556, 'f1-score': 0.4217408921796147, 'support': 178975}, '2': {'precision': 0.4327115114944971, 'recall': 0.4022924932416035, 'f1-score': 0.416947923186261, 'support': 177187}, 'accuracy': 0.3959184057507386, 'macro avg': {'precision': 0.40611001827513893, 'recall': 0.3950737059449891, 'f1-score': 0.3901242133927665, 'support': 531410}, 'weighted avg': {'precision': 0.405874252989938, 'recall': 0.3959184057507386, 'f1-score': 0.3904438282572368, 'support': 531410}}
[[47522 86329 41397]
 [35330 91592 52053]
 [28450 77456 71281]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0790873
{'0': {'precision': 0.444898753894081, 'recall': 0.3159318953938532, 'f1-score': 0.36948486948486947, 'support': 50628}, '1': {'precision': 0.3554022654661632, 'recall': 0.49021493099373037, 'f1-score': 0.4120623321519073, 'support': 49923}, '2': {'precision': 0.4345245944876698, 'recall': 0.397315058582367, 'f1-score': 0.4150876051103856, 'support': 49759}, 'accuracy': 0.4007584325726831, 'macro avg': {'precision': 0.4116085379493047, 'recall': 0.4011539616566502, 'f1-score': 0.3988782689157208, 'support': 150310}, 'weighted avg': {'precision': 0.41173967605700723, 'recall': 0.4007584325726831, 'f1-score': 0.398722719200235, 'support': 150310}}
[[15995 23009 11624]
 [11346 24473 14104]
 [ 8611 21378 19770]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/WBA
Evaluating performance on  test set...
4353/4353 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.07216
{'0': {'precision': 0.4619832369653242, 'recall': 0.2955237085160926, 'f1-score': 0.3604640202301899, 'support': 375266}, '1': {'precision': 0.3722945323134059, 'recall': 0.44670060031776926, 'f1-score': 0.4061176543141062, 'support': 383297}, '2': {'precision': 0.42062949974537145, 'recall': 0.48993309344428204, 'f1-score': 0.4526439226594671, 'support': 355720}, 'accuracy': 0.40958894643461313, 'macro avg': {'precision': 0.41830242300803383, 'recall': 0.4107191340927146, 'f1-score': 0.40640853240125446, 'support': 1114283}, 'weighted avg': {'precision': 0.4179300091669571, 'recall': 0.40958894643461313, 'f1-score': 0.40559540595141635, 'support': 1114283}}
[[110900 158799 105567]
 [ 77595 171219 134483]
 [ 51557 129884 174279]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0806593
{'0': {'precision': 0.4416863278282081, 'recall': 0.3272860613962309, 'f1-score': 0.37597651263722237, 'support': 134992}, '1': {'precision': 0.3468455163067086, 'recall': 0.46682724912887913, 'f1-score': 0.3979903104252647, 'support': 128283}, '2': {'precision': 0.4329271794871795, 'recall': 0.4018905146739586, 'f1-score': 0.4168319100022911, 'support': 131287}, 'accuracy': 0.3974787232424815, 'macro avg': {'precision': 0.407153007874032, 'recall': 0.39866794173302283, 'f1-score': 0.3969329110215927, 'support': 394562}, 'weighted avg': {'precision': 0.4079364326719053, 'recall': 0.3974787232424815, 'f1-score': 0.39672807658790993, 'support': 394562}}
[[44181 58878 31933]
 [31218 59886 37179]
 [24629 53895 52763]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.082594
{'0': {'precision': 0.43866198760546554, 'recall': 0.28467595396729256, 'f1-score': 0.34527850016896605, 'support': 41275}, '1': {'precision': 0.350529666933517, 'recall': 0.4607816744573065, 'f1-score': 0.3981644003637363, 'support': 40861}, '2': {'precision': 0.4147629058631161, 'recall': 0.43125349136570085, 'f1-score': 0.4228474810378291, 'support': 41173}, 'accuracy': 0.39197463283296435, 'macro avg': {'precision': 0.4013181868006996, 'recall': 0.3922370399301, 'f1-score': 0.38876346052351046, 'support': 123309}, 'weighted avg': {'precision': 0.4014775838104932, 'recall': 0.39197463283296435, 'f1-score': 0.388703703659159, 'support': 123309}}
[[11750 18196 11329]
 [ 8308 18828 13725]
 [ 6728 16689 17756]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0834967
{'0': {'precision': 0.4314466254369454, 'recall': 0.3415127831839195, 'f1-score': 0.3812478021612477, 'support': 469836}, '1': {'precision': 0.331332545161089, 'recall': 0.44066465988668124, 'f1-score': 0.3782566630244861, 'support': 445822}, '2': {'precision': 0.44504626291077687, 'recall': 0.40052244180510965, 'f1-score': 0.4216121409014446, 'support': 491538}, 'accuracy': 0.3935379293289634, 'macro avg': {'precision': 0.4026084778362704, 'recall': 0.3942332949585701, 'f1-score': 0.39370553536239283, 'support': 1407196}, 'weighted avg': {'precision': 0.4044792940260185, 'recall': 0.3935379293289634, 'f1-score': 0.39439955266611665, 'support': 1407196}}
[[160455 198657 110724]
 [114597 196458 134767]
 [ 96848 197818 196872]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0885663
{'0': {'precision': 0.4196655336915645, 'recall': 0.31574978169405415, 'f1-score': 0.3603658990380104, 'support': 176358}, '1': {'precision': 0.3482618786503099, 'recall': 0.46850071764726064, 'f1-score': 0.399530881596368, 'support': 174877}, '2': {'precision': 0.41424714094196285, 'recall': 0.3748298583624259, 'f1-score': 0.39355398092504557, 'support': 175589}, 'accuracy': 0.38614603738629977, 'macro avg': {'precision': 0.39405818442794577, 'recall': 0.38636011923458025, 'f1-score': 0.38448358718647463, 'support': 526824}, 'weighted avg': {'precision': 0.39415745671109415, 'recall': 0.38614603738629977, 'f1-score': 0.38442804648254697, 'support': 526824}}
[[55685 78489 42184]
 [42066 81930 50881]
 [34938 74835 65816]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0919931
{'0': {'precision': 0.42131791403011126, 'recall': 0.3232822126975623, 'f1-score': 0.36584626461281944, 'support': 59728}, '1': {'precision': 0.3351820365422503, 'recall': 0.4480096675865303, 'f1-score': 0.38346880330994454, 'support': 55443}, '2': {'precision': 0.41460184316538823, 'recall': 0.38118996076309025, 'f1-score': 0.3971944911931342, 'support': 59128}, 'accuracy': 0.3826011623704095, 'macro avg': {'precision': 0.3903672645792499, 'recall': 0.3841606136823943, 'f1-score': 0.38216985303863277, 'support': 174299}, 'weighted avg': {'precision': 0.39164052463803894, 'recall': 0.3826011623704095, 'f1-score': 0.38208619917483966, 'support': 174299}}
[[19309 25140 15279]
 [14059 24839 16545]
 [12462 24127 22539]]
testing model on single stock: results/universal/W2/deepOF_L1/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 175s - 175s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886129
{'0': {'precision': 0.3772239122094621, 'recall': 0.3408972040888812, 'f1-score': 0.3581417509362045, 'support': 1179687}, '1': {'precision': 0.37651657495427954, 'recall': 0.42656158835479047, 'f1-score': 0.39997976683271397, 'support': 1408854}, '2': {'precision': 0.3874277031065664, 'recall': 0.3640634607685084, 'f1-score': 0.37538237885127845, 'support': 1221353}, 'accuracy': 0.38000138586532856, 'macro avg': {'precision': 0.3803893967567693, 'recall': 0.37717408440406003, 'f1-score': 0.3778346322067323, 'support': 3809894}, 'weighted avg': {'precision': 0.3802334173826344, 'recall': 0.38000138586532856, 'f1-score': 0.3791398544723712, 'support': 3809894}}
[[402152 492842 284693]
 [389536 600963 418355]
 [274395 502308 444650]]
Evaluating performance on  train set...
6147/6147 - 74s - 74s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994251
{'0': {'precision': 0.3938207067316336, 'recall': 0.333476580942929, 'f1-score': 0.3611452565849749, 'support': 518915}, '1': {'precision': 0.33308170797301045, 'recall': 0.4138393244037015, 'f1-score': 0.36909473163492457, 'support': 519245}, '2': {'precision': 0.39445454564047605, 'recall': 0.36027781358170674, 'f1-score': 0.37659236290643816, 'support': 535323}, 'accuracy': 0.36911425163157147, 'macro avg': {'precision': 0.3737856534483734, 'recall': 0.36919790630944577, 'f1-score': 0.36894411704211255, 'support': 1573483}, 'weighted avg': {'precision': 0.3739926483006095, 'recall': 0.36911425163157147, 'f1-score': 0.3690239031732353, 'support': 1573483}}
[[173046 212944 132925]
 [141210 214884 163151]
 [125147 217311 192865]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.096011
{'0': {'precision': 0.4036371304242254, 'recall': 0.3410467665129739, 'f1-score': 0.36971160177340767, 'support': 185218}, '1': {'precision': 0.3303475941861567, 'recall': 0.40393740757906815, 'f1-score': 0.3634549268329009, 'support': 181236}, '2': {'precision': 0.40482743543893673, 'recall': 0.3800072612852475, 'f1-score': 0.3920248828865017, 'support': 190049}, 'accuracy': 0.37483355884873937, 'macro avg': {'precision': 0.37960405334977293, 'recall': 0.37499714512576315, 'f1-score': 0.3750638038309368, 'support': 556503}, 'weighted avg': {'precision': 0.38017546694370197, 'recall': 0.37483355884873937, 'f1-score': 0.3752941090065129, 'support': 556503}}
[[63168 74078 47972]
 [49823 73208 58205]
 [43506 74323 72220]]
training model: results/universal/W2/deepOF_L1/h200
Epoch 1/50
9940/9940 - 207s - loss: 3.2546 - accuracy200: 0.3914 - val_loss: 3.2795 - val_accuracy200: 0.3683 - 207s/epoch - 21ms/step
Epoch 2/50
9940/9940 - 208s - loss: 3.2569 - accuracy200: 0.3902 - val_loss: 3.2783 - val_accuracy200: 0.3688 - 208s/epoch - 21ms/step
Epoch 3/50
9940/9940 - 209s - loss: 3.2556 - accuracy200: 0.3905 - val_loss: 3.2795 - val_accuracy200: 0.3681 - 209s/epoch - 21ms/step
Epoch 4/50
9940/9940 - 212s - loss: 3.2526 - accuracy200: 0.3927 - val_loss: 3.2785 - val_accuracy200: 0.3682 - 212s/epoch - 21ms/step
Epoch 5/50
9940/9940 - 209s - loss: 3.2504 - accuracy200: 0.3941 - val_loss: 3.2802 - val_accuracy200: 0.3670 - 209s/epoch - 21ms/step
Epoch 6/50
9940/9940 - 209s - loss: 3.2477 - accuracy200: 0.3961 - val_loss: 3.2800 - val_accuracy200: 0.3669 - 209s/epoch - 21ms/step
Epoch 7/50
9940/9940 - 208s - loss: 3.2454 - accuracy200: 0.3978 - val_loss: 3.2798 - val_accuracy200: 0.3674 - 208s/epoch - 21ms/step
Epoch 8/50
9940/9940 - 209s - loss: 3.2426 - accuracy200: 0.3999 - val_loss: 3.2798 - val_accuracy200: 0.3675 - 209s/epoch - 21ms/step
Epoch 9/50
9940/9940 - 210s - loss: 3.2405 - accuracy200: 0.4010 - val_loss: 3.2774 - val_accuracy200: 0.3682 - 210s/epoch - 21ms/step
Epoch 10/50
9940/9940 - 207s - loss: 3.2390 - accuracy200: 0.4021 - val_loss: 3.2786 - val_accuracy200: 0.3683 - 207s/epoch - 21ms/step
Epoch 11/50
9940/9940 - 208s - loss: 3.2380 - accuracy200: 0.4025 - val_loss: 3.2782 - val_accuracy200: 0.3678 - 208s/epoch - 21ms/step
Epoch 12/50
9940/9940 - 209s - loss: 3.2365 - accuracy200: 0.4035 - val_loss: 3.2786 - val_accuracy200: 0.3675 - 209s/epoch - 21ms/step
Epoch 13/50
9940/9940 - 206s - loss: 3.2350 - accuracy200: 0.4047 - val_loss: 3.2791 - val_accuracy200: 0.3672 - 206s/epoch - 21ms/step
Epoch 14/50
9940/9940 - 207s - loss: 3.2338 - accuracy200: 0.4051 - val_loss: 3.2799 - val_accuracy200: 0.3665 - 207s/epoch - 21ms/step
Epoch 15/50
9940/9940 - 203s - loss: 3.2329 - accuracy200: 0.4057 - val_loss: 3.2818 - val_accuracy200: 0.3655 - 203s/epoch - 20ms/step
Epoch 16/50
9940/9940 - 203s - loss: 3.2316 - accuracy200: 0.4066 - val_loss: 3.2816 - val_accuracy200: 0.3654 - 203s/epoch - 20ms/step
Epoch 17/50
9940/9940 - 209s - loss: 3.2305 - accuracy200: 0.4070 - val_loss: 3.2816 - val_accuracy200: 0.3649 - 209s/epoch - 21ms/step
Epoch 18/50
9940/9940 - 207s - loss: 3.2294 - accuracy200: 0.4076 - val_loss: 3.2810 - val_accuracy200: 0.3649 - 207s/epoch - 21ms/step
Epoch 19/50
9940/9940 - 210s - loss: 3.2287 - accuracy200: 0.4082 - val_loss: 3.2827 - val_accuracy200: 0.3643 - 210s/epoch - 21ms/step
testing model in sample: results/universal/W2/deepOF_L1/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 348s - 348s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896971
{'0': {'precision': 0.35152495322776445, 'recall': 0.4317272401668355, 'f1-score': 0.38751987976965935, 'support': 2077256}, '1': {'precision': 0.3730475307131599, 'recall': 0.2840285277443657, 'f1-score': 0.32250799451089424, 'support': 2539002}, '2': {'precision': 0.36784694480737534, 'recall': 0.3909082787911157, 'f1-score': 0.37902715284452004, 'support': 2104486}, 'accuracy': 0.3631469968205901, 'macro avg': {'precision': 0.36413980958276654, 'recall': 0.368888015567439, 'f1-score': 0.36301834237502456, 'support': 6720744}, 'weighted avg': {'precision': 0.36476683092046974, 'recall': 0.3631469968205901, 'f1-score': 0.36029995715222984, 'support': 6720744}}
[[896808 606088 574360]
 [978452 721149 839401]
 [675933 605892 822661]]
Evaluating performance on  train set...
9940/9940 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953482
{'0': {'precision': 0.3760070835109199, 'recall': 0.4308309181828609, 'f1-score': 0.4015563884997856, 'support': 845703}, '1': {'precision': 0.33591585253769957, 'recall': 0.2939848136743663, 'f1-score': 0.3135547066886714, 'support': 839176}, '2': {'precision': 0.38930209252032, 'recall': 0.3808894426718215, 'f1-score': 0.38504982274064214, 'support': 858740}, 'accuracy': 0.3688229251314761, 'macro avg': {'precision': 0.36707500952297983, 'recall': 0.3685683915096829, 'f1-score': 0.3667203059763664, 'support': 2543619}, 'weighted avg': {'precision': 0.36726888694671317, 'recall': 0.3688229251314761, 'f1-score': 0.3669506760815616, 'support': 2543619}}
[[364355 243635 237713]
 [317086 246705 275385]
 [287570 244085 327085]]
Evaluating performance on  val set...
3393/3393 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0925994
{'0': {'precision': 0.3709788247861324, 'recall': 0.43583786908824274, 'f1-score': 0.40080137582483844, 'support': 283672}, '1': {'precision': 0.3423769624594131, 'recall': 0.2841312772485064, 'f1-score': 0.3105466057059657, 'support': 297264}, '2': {'precision': 0.3877927135285972, 'recall': 0.38911080387397395, 'f1-score': 0.3884506405687764, 'support': 287147}, 'accuracy': 0.36843135967413254, 'macro avg': {'precision': 0.3670495002580476, 'recall': 0.3696933167369077, 'f1-score': 0.36659954069986017, 'support': 868083}, 'weighted avg': {'precision': 0.3667462268756131, 'recall': 0.36843135967413254, 'f1-score': 0.36580936404579306, 'support': 868083}}
[[123635  81480  78557]
 [114968  84462  97834]
 [ 94664  80751 111732]]
testing model out of sample: results/universal/W2/deepOF_L1/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 183s - 183s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096111
{'0': {'precision': 0.3862624660413395, 'recall': 0.41017574992431516, 'f1-score': 0.39786010640894226, 'support': 1241992}, '1': {'precision': 0.32019894375745744, 'recall': 0.3314671155882402, 'f1-score': 0.32573560884312547, 'support': 1139917}, '2': {'precision': 0.40592981804138234, 'recall': 0.3689619932767694, 'f1-score': 0.38656409219307575, 'support': 1284799}, 'accuracy': 0.3712654511894593, 'macro avg': {'precision': 0.37079707594672645, 'recall': 0.37020161959644154, 'f1-score': 0.37005326914838116, 'support': 3666708}, 'weighted avg': {'precision': 0.37261580043585, 'recall': 0.3712654511894593, 'f1-score': 0.3714797541528411, 'support': 3666708}}
[[509435 396232 336325]
 [404646 377845 357426]
 [404802 405955 474042]]
Evaluating performance on  train set...
5373/5373 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955813
{'0': {'precision': 0.37408876589329826, 'recall': 0.44259915421385065, 'f1-score': 0.4054703573025891, 'support': 460873}, '1': {'precision': 0.344416140619102, 'recall': 0.3175425886081629, 'f1-score': 0.3304338715445044, 'support': 456871}, '2': {'precision': 0.38576060021352243, 'recall': 0.34461788845527885, 'f1-score': 0.3640304460147054, 'support': 457144}, 'accuracy': 0.36846492223366556, 'macro avg': {'precision': 0.36808850224197426, 'recall': 0.36825321042576414, 'f1-score': 0.3666448916205996, 'support': 1374888}, 'weighted avg': {'precision': 0.36810947670526056, 'recall': 0.36846492223366556, 'f1-score': 0.3667573849800652, 'support': 1374888}}
[[203982 140462 116429]
 [177376 145076 134419]
 [163919 135685 157540]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0957907
{'0': {'precision': 0.37575084953261406, 'recall': 0.4540282722151177, 'f1-score': 0.4111974006704919, 'support': 144665}, '1': {'precision': 0.33796021317277575, 'recall': 0.29130169505789283, 'f1-score': 0.3129011359869829, 'support': 142591}, '2': {'precision': 0.37975511800364015, 'recall': 0.3520810526242391, 'f1-score': 0.3653948439620081, 'support': 143413}, 'accuracy': 0.3662023502968637, 'macro avg': {'precision': 0.36448872690300993, 'recall': 0.3658036732990832, 'f1-score': 0.3631644602064943, 'support': 430669}, 'weighted avg': {'precision': 0.36457210094622766, 'recall': 0.3662023502968637, 'f1-score': 0.36340003252298175, 'support': 430669}}
[[65682 40629 38354]
 [56939 41537 44115]
 [52181 40739 50493]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096935
{'0': {'precision': 0.33309307213147094, 'recall': 0.5430122821556235, 'f1-score': 0.4129038325887609, 'support': 80849}, '1': {'precision': 0.3085787726250402, 'recall': 0.1712655293348392, 'f1-score': 0.2202752293577982, 'support': 84115}, '2': {'precision': 0.4274228420085401, 'recall': 0.3613897584717684, 'f1-score': 0.39164241936482386, 'support': 87526}, 'accuracy': 0.3562081666600658, 'macro avg': {'precision': 0.35636489558835044, 'recall': 0.358555856654077, 'f1-score': 0.34160716043712763, 'support': 252490}, 'weighted avg': {'precision': 0.3576258739663037, 'recall': 0.3562081666600658, 'f1-score': 0.34136087478999366, 'support': 252490}}
[[43902 15621 21326]
 [48662 14406 21047]
 [39237 16658 31631]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0973462
{'0': {'precision': 0.359383637368712, 'recall': 0.5208552400981423, 'f1-score': 0.42530920985382803, 'support': 19971}, '1': {'precision': 0.34290540540540543, 'recall': 0.225966403562032, 'f1-score': 0.2724167378309138, 'support': 19764}, '2': {'precision': 0.3938610662358643, 'recall': 0.3515839061673797, 'f1-score': 0.37152363294643537, 'support': 20803}, 'accuracy': 0.3664144834649311, 'macro avg': {'precision': 0.3653833696699939, 'recall': 0.3661351832758513, 'f1-score': 0.3564165268770591, 'support': 60538}, 'weighted avg': {'precision': 0.36585161081019635, 'recall': 0.3664144834649311, 'f1-score': 0.3569113742222352, 'support': 60538}}
[[10402  4148  5421]
 [ 9463  4466  5835]
 [ 9079  4410  7314]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0984856
{'0': {'precision': 0.3589721178218687, 'recall': 0.5498728076047664, 'f1-score': 0.43437334743521955, 'support': 7469}, '1': {'precision': 0.3164789101388525, 'recall': 0.17767318723341669, 'f1-score': 0.22758100979653353, 'support': 6799}, '2': {'precision': 0.39233317557974445, 'recall': 0.3393368808841588, 'f1-score': 0.36391571553994734, 'support': 7329}, 'accuracy': 0.36125387785340557, 'macro avg': {'precision': 0.3559280678468219, 'recall': 0.3556276252407806, 'f1-score': 0.3419566909239002, 'support': 21597}, 'weighted avg': {'precision': 0.35691590044309596, 'recall': 0.36125387785340557, 'f1-score': 0.3453626011387026, 'support': 21597}}
[[4107 1337 2025]
 [3764 1208 1827]
 [3570 1272 2487]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090989
{'0': {'precision': 0.3625385312783318, 'recall': 0.4000200070024509, 'f1-score': 0.380358119515849, 'support': 99965}, '1': {'precision': 0.3350346174329842, 'recall': 0.28096620515110915, 'f1-score': 0.30562753036437246, 'support': 107472}, '2': {'precision': 0.39708263040403524, 'recall': 0.4223021647924463, 'f1-score': 0.4093042863478875, 'support': 110357}, 'accuracy': 0.3674959250331976, 'macro avg': {'precision': 0.3648852597051171, 'recall': 0.3677627923153355, 'f1-score': 0.36509664540936965, 'support': 317794}, 'weighted avg': {'precision': 0.3652329890667987, 'recall': 0.3674959250331976, 'f1-score': 0.36513746165508315, 'support': 317794}}
[[39988 28928 31049]
 [37563 30196 39713]
 [32749 31004 46604]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.07681
{'0': {'precision': 0.40708239152594955, 'recall': 0.411265587570242, 'f1-score': 0.40916329780717875, 'support': 44667}, '1': {'precision': 0.33752075662407044, 'recall': 0.3134218289085546, 'f1-score': 0.32502520248896305, 'support': 44748}, '2': {'precision': 0.4390264129037608, 'recall': 0.46542705173853793, 'f1-score': 0.4518414202193487, 'support': 45498}, 'accuracy': 0.39707811700873896, 'macro avg': {'precision': 0.39454318701792696, 'recall': 0.3967048227391115, 'f1-score': 0.39534330683849683, 'support': 134913}, 'weighted avg': {'precision': 0.3947829470399354, 'recall': 0.39707811700873896, 'f1-score': 0.39564909031204776, 'support': 134913}}
[[18370 14446 11851]
 [15516 14025 15207]
 [11240 13082 21176]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0812134
{'0': {'precision': 0.4249025859015232, 'recall': 0.48507110601873693, 'f1-score': 0.45299763965381584, 'support': 14837}, '1': {'precision': 0.3290276917632487, 'recall': 0.28324447829398325, 'f1-score': 0.3044243441247493, 'support': 13130}, '2': {'precision': 0.40208856148304056, 'recall': 0.3933634275758296, 'f1-score': 0.39767814251401123, 'support': 12627}, 'accuracy': 0.3912647189239789, 'macro avg': {'precision': 0.3853396130492708, 'recall': 0.3872263372961833, 'f1-score': 0.3850333754308588, 'support': 40594}, 'weighted avg': {'precision': 0.38679572167607795, 'recall': 0.3912647189239789, 'f1-score': 0.3877346288472691, 'support': 40594}}
[[7197 3957 3683]
 [5708 3719 3703]
 [4033 3627 4967]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029799
{'0': {'precision': 0.36667589496773645, 'recall': 0.3804494332368473, 'f1-score': 0.3734357039061314, 'support': 90514}, '1': {'precision': 0.30412731912694224, 'recall': 0.34569956304084404, 'f1-score': 0.3235836627140975, 'support': 81701}, '2': {'precision': 0.41426365456105235, 'recall': 0.35509299657819654, 'f1-score': 0.3824029395305621, 'support': 101993}, 'accuracy': 0.3606641673474151, 'macro avg': {'precision': 0.361688956218577, 'recall': 0.3604139976186293, 'f1-score': 0.359807435383597, 'support': 274208}, 'weighted avg': {'precision': 0.36573987986034473, 'recall': 0.3606641673474151, 'f1-score': 0.36191756309919726, 'support': 274208}}
[[34436 30748 25330]
 [27579 28244 25878]
 [31899 33877 36217]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1016542
{'0': {'precision': 0.3796092980994927, 'recall': 0.4002794411177645, 'f1-score': 0.38967044924607497, 'support': 25050}, '1': {'precision': 0.3326627174844454, 'recall': 0.3773082611451511, 'f1-score': 0.35358175266305, 'support': 23665}, '2': {'precision': 0.36459702699969665, 'recall': 0.296529319845382, 'f1-score': 0.3270591436865022, 'support': 24318}, 'accuracy': 0.3582900880423918, 'macro avg': {'precision': 0.35895634752787825, 'recall': 0.35803900736943256, 'f1-score': 0.35677044853187573, 'support': 73033}, 'weighted avg': {'precision': 0.3593984449391414, 'recall': 0.3582900880423918, 'f1-score': 0.3571287114941686, 'support': 73033}}
[[10027  8982  6041]
 [ 8210  8929  6526]
 [ 8177  8930  7211]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953718
{'0': {'precision': 0.3746628382493692, 'recall': 0.43970182783620954, 'f1-score': 0.40458517335337774, 'support': 9793}, '1': {'precision': 0.3453038674033149, 'recall': 0.34184138559708294, 'f1-score': 0.34356390288593674, 'support': 9873}, '2': {'precision': 0.3947553266214001, 'recall': 0.33244602188701566, 'f1-score': 0.36093122825796087, 'support': 10143}, 'accuracy': 0.370794055486598, 'macro avg': {'precision': 0.3715740107580281, 'recall': 0.3713297451067694, 'f1-score': 0.36969343483242517, 'support': 29809}, 'weighted avg': {'precision': 0.37177568975040637, 'recall': 0.370794055486598, 'f1-score': 0.36952042886587866, 'support': 29809}}
[[4306 3151 2336]
 [3664 3375 2834]
 [3523 3248 3372]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993469
{'0': {'precision': 0.37093182690725607, 'recall': 0.46794437141077977, 'f1-score': 0.4138285504497339, 'support': 72265}, '1': {'precision': 0.3104098456501403, 'recall': 0.33468866720249635, 'f1-score': 0.32209237955850123, 'support': 63453}, '2': {'precision': 0.46920043739023826, 'recall': 0.33625817788912504, 'f1-score': 0.39175813914883906, 'support': 84221}, 'accuracy': 0.3790732885027212, 'macro avg': {'precision': 0.3835140366492116, 'recall': 0.37963040550080035, 'f1-score': 0.37589302305235806, 'support': 219939}, 'weighted avg': {'precision': 0.39110096183457443, 'recall': 0.3790732885027212, 'f1-score': 0.3789110171257939, 'support': 219939}}
[[33816 22144 16305]
 [26483 21237 15733]
 [30866 25035 28320]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013036
{'0': {'precision': 0.37324870091429324, 'recall': 0.41640066042927903, 'f1-score': 0.393645618355561, 'support': 27255}, '1': {'precision': 0.33494351679281886, 'recall': 0.3239405532666274, 'f1-score': 0.3293501636278635, 'support': 27184}, '2': {'precision': 0.3595501120717259, 'recall': 0.32974818295279346, 'f1-score': 0.3440049017730632, 'support': 27242}, 'accuracy': 0.356729227115241, 'macro avg': {'precision': 0.3559141099262793, 'recall': 0.35669646554956663, 'f1-score': 0.3556668945854959, 'support': 81681}, 'weighted avg': {'precision': 0.3559317596132883, 'recall': 0.356729227115241, 'f1-score': 0.3556916260873697, 'support': 81681}}
[[11349  8753  7153]
 [ 9530  8806  8848]
 [ 9527  8732  8983]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.10345
{'0': {'precision': 0.36745098039215685, 'recall': 0.44318316187773443, 'f1-score': 0.4017794929517072, 'support': 8457}, '1': {'precision': 0.3263450366254105, 'recall': 0.31897296630045674, 'f1-score': 0.32261689244022723, 'support': 8101}, '2': {'precision': 0.3723513079058892, 'recall': 0.3032250386766631, 'f1-score': 0.3342516069788797, 'support': 8403}, 'accuracy': 0.3557549777653139, 'macro avg': {'precision': 0.3553824416411522, 'recall': 0.3551270556182848, 'f1-score': 0.3528826641236047, 'support': 24961}, 'weighted avg': {'precision': 0.35575987032619316, 'recall': 0.3557549777653139, 'f1-score': 0.3533546280595487, 'support': 24961}}
[[3748 2621 2088]
 [3310 2584 2207]
 [3142 2713 2548]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091301
{'0': {'precision': 0.34482429639052314, 'recall': 0.33460472637276506, 'f1-score': 0.33963765301392007, 'support': 162027}, '1': {'precision': 0.31905469096459477, 'recall': 0.3995363614056386, 'f1-score': 0.3547885821759923, 'support': 154862}, '2': {'precision': 0.3737091299553916, 'recall': 0.29970813466262103, 'f1-score': 0.3326426931119864, 'support': 173025}, 'accuracy': 0.34280506374588193, 'macro avg': {'precision': 0.3458627057701698, 'recall': 0.34461640748034156, 'f1-score': 0.3423563094339663, 'support': 489914}, 'weighted avg': {'precision': 0.3468798932750605, 'recall': 0.34280506374588193, 'f1-score': 0.34195642784963565, 'support': 489914}}
[[54215 64590 43222]
 [49305 61873 43684]
 [53705 67463 51857]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035807
{'0': {'precision': 0.3644350050683014, 'recall': 0.36450538309274366, 'f1-score': 0.36447019068307995, 'support': 62139}, '1': {'precision': 0.3369623466365816, 'recall': 0.39660724363443217, 'f1-score': 0.3643599987800787, 'support': 60246}, '2': {'precision': 0.3592019511414977, 'recall': 0.29602293321031997, 'f1-score': 0.3245664739884393, 'support': 60698}, 'accuracy': 0.3523647744465625, 'macro avg': {'precision': 0.3535331009487936, 'recall': 0.3523785199791653, 'f1-score': 0.3511322211505326, 'support': 183083}, 'weighted avg': {'precision': 0.3536598173822436, 'recall': 0.3523647744465625, 'f1-score': 0.3512045438599477, 'support': 183083}}
[[22650 23952 15537]
 [19835 23894 16517]
 [19666 23064 17968]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058987
{'0': {'precision': 0.3711345564159867, 'recall': 0.375703688114905, 'f1-score': 0.3734051453670781, 'support': 19007}, '1': {'precision': 0.31301254816717716, 'recall': 0.3768064228367529, 'f1-score': 0.3419596837304693, 'support': 16815}, '2': {'precision': 0.37637598048909104, 'recall': 0.3032073067119796, 'f1-score': 0.3358527188777461, 'support': 18832}, 'accuracy': 0.35106305119478903, 'macro avg': {'precision': 0.35350769502408497, 'recall': 0.3519058058878792, 'f1-score': 0.35040584932509783, 'support': 54654}, 'weighted avg': {'precision': 0.3550586045998519, 'recall': 0.35106305119478903, 'f1-score': 0.3507911970180702, 'support': 54654}}
[[7141 7061 4805]
 [5823 6336 4656]
 [6277 6845 5710]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/EXC
Evaluating performance on  test set...
4918/4918 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951442
{'0': {'precision': 0.4026831052358186, 'recall': 0.3522402453640703, 'f1-score': 0.37577641671705725, 'support': 431359}, '1': {'precision': 0.3138040501648323, 'recall': 0.4664379939020596, 'f1-score': 0.3751916030422913, 'support': 385704}, '2': {'precision': 0.43764763140817653, 'recall': 0.30532334625858193, 'f1-score': 0.3597019084737943, 'support': 441771}, 'accuracy': 0.3707653272790535, 'macro avg': {'precision': 0.3847115956029425, 'recall': 0.3746671951749039, 'f1-score': 0.37022330941104764, 'support': 1258834}, 'weighted avg': {'precision': 0.3877210900968797, 'recall': 0.3707653272790535, 'f1-score': 0.36995609683791003, 'support': 1258834}}
[[151942 193564  85853]
 [118333 179907  87464]
 [107049 199839 134883]]
Evaluating performance on  train set...
1403/1403 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.090133
{'0': {'precision': 0.3971269858118388, 'recall': 0.3696665294359819, 'f1-score': 0.3829050498503211, 'support': 121450}, '1': {'precision': 0.3265474424884112, 'recall': 0.4229877927962853, 'f1-score': 0.36856327878696893, 'support': 116079}, '2': {'precision': 0.4287358607050551, 'recall': 0.3373623930638694, 'f1-score': 0.3776000147453207, 'support': 121451}, 'accuracy': 0.3759791631845785, 'macro avg': {'precision': 0.3841367630017684, 'recall': 0.3766722384320455, 'f1-score': 0.37635611446087025, 'support': 358980}, 'weighted avg': {'precision': 0.384998529227115, 'recall': 0.3759791631845785, 'f1-score': 0.3764727130577414, 'support': 358980}}
[[44896 51152 25402]
 [37787 49100 29192]
 [30369 50109 40973]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0905162
{'0': {'precision': 0.40984226447709593, 'recall': 0.3631533601378518, 'f1-score': 0.38508780834433054, 'support': 41784}, '1': {'precision': 0.32271670361758503, 'recall': 0.46470099667774084, 'f1-score': 0.38090780473794505, 'support': 38528}, '2': {'precision': 0.4437493794062159, 'recall': 0.31617300254692954, 'f1-score': 0.3692523789195368, 'support': 42404}, 'accuracy': 0.3788014602822778, 'macro avg': {'precision': 0.39210278250029895, 'recall': 0.38134245312084075, 'f1-score': 0.37841599733393744, 'support': 122716}, 'weighted avg': {'precision': 0.3942047248951275, 'recall': 0.3788014602822778, 'f1-score': 0.3783035851926977, 'support': 122716}}
[[15174 18682  7928]
 [11746 17904  8878]
 [10104 18893 13407]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/AAL
Evaluating performance on  test set...
4856/4856 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940074
{'0': {'precision': 0.41063130263957365, 'recall': 0.39426032378488435, 'f1-score': 0.40227932561323926, 'support': 433683}, '1': {'precision': 0.32464438234957355, 'recall': 0.34250898931562973, 'f1-score': 0.3333375023137842, 'support': 389073}, '2': {'precision': 0.3871411264734727, 'recall': 0.38334475798773754, 'f1-score': 0.3852335894222214, 'support': 420144}, 'accuracy': 0.3743704240083675, 'macro avg': {'precision': 0.3741389371542066, 'recall': 0.3733713570294172, 'f1-score': 0.3736168057830816, 'support': 1242900}, 'weighted avg': {'precision': 0.37577375528007445, 'recall': 0.3743704240083675, 'f1-score': 0.3749359626694562, 'support': 1242900}}
[[170984 140446 122253]
 [123101 133261 132711]
 [122308 136776 161060]]
Evaluating performance on  train set...
2076/2076 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936906
{'0': {'precision': 0.3756734527913059, 'recall': 0.4575634957707005, 'f1-score': 0.4125944213685992, 'support': 177689}, '1': {'precision': 0.344636790163404, 'recall': 0.3008587085475397, 'f1-score': 0.3212632150451687, 'support': 177010}, '2': {'precision': 0.3927509768607093, 'recall': 0.35663880573365553, 'f1-score': 0.3738247907608534, 'support': 176711}, 'accuracy': 0.3718051974934608, 'macro avg': {'precision': 0.37102040660513974, 'recall': 0.37168700335063193, 'f1-score': 0.36922747572487374, 'support': 531410}, 'weighted avg': {'precision': 0.3710141251611586, 'recall': 0.3718051974934608, 'f1-score': 0.36928030039677745, 'support': 531410}}
[[81304 51861 44524]
 [70838 53255 52917]
 [64280 49409 63022]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092434
{'0': {'precision': 0.37825598362992907, 'recall': 0.4555131390252277, 'f1-score': 0.41330523229176214, 'support': 49509}, '1': {'precision': 0.3528838968273738, 'recall': 0.30056320641901013, 'f1-score': 0.32462892557679285, 'support': 51846}, '2': {'precision': 0.37704706640876856, 'recall': 0.358369931569809, 'f1-score': 0.36747133057548304, 'support': 48955}, 'accuracy': 0.3704277825826625, 'macro avg': {'precision': 0.36939564895535715, 'recall': 0.3714820923380156, 'f1-score': 0.3684684961480127, 'support': 150310}, 'weighted avg': {'precision': 0.36911072546395746, 'recall': 0.3704277825826625, 'f1-score': 0.3677905595722841, 'support': 150310}}
[[22552 14284 12673]
 [19950 15583 16313]
 [17119 14292 17544]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/WBA
Evaluating performance on  test set...
4353/4353 - 57s - 57s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.081319
{'0': {'precision': 0.4110184913710305, 'recall': 0.4270415626091455, 'f1-score': 0.41887685251847206, 'support': 380799}, '1': {'precision': 0.3701979721261257, 'recall': 0.2834694880860233, 'f1-score': 0.3210801700761373, 'support': 382408}, '2': {'precision': 0.39126626274012494, 'recall': 0.4745667604735157, 'f1-score': 0.4289094035752533, 'support': 351076}, 'accuracy': 0.39274313616917783, 'macro avg': {'precision': 0.3908275754124271, 'recall': 0.3950259370562282, 'f1-score': 0.3896221420566209, 'support': 1114283}, 'weighted avg': {'precision': 0.3907860849336808, 'recall': 0.39274313616917783, 'f1-score': 0.38847519885903564, 'support': 1114283}}
[[162617 100921 117261]
 [132057 108401 141950]
 [100970  83497 166609]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876305
{'0': {'precision': 0.3956170015250978, 'recall': 0.4464389937295162, 'f1-score': 0.41949432593196745, 'support': 133642}, '1': {'precision': 0.3448345316180785, 'recall': 0.2990696084760567, 'f1-score': 0.32032571912013535, 'support': 131665}, '2': {'precision': 0.396647139185403, 'recall': 0.3975861668794244, 'f1-score': 0.39711609792284863, 'support': 129255}, 'accuracy': 0.381258205301068, 'macro avg': {'precision': 0.37903289077619307, 'recall': 0.381031589694999, 'f1-score': 0.3789787143249838, 'support': 394562}, 'weighted avg': {'precision': 0.37900839893025856, 'recall': 0.381258205301068, 'f1-score': 0.3790709387907868, 'support': 394562}}
[[59663 38101 35878]
 [49995 39377 42293]
 [41152 36713 51390]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0884789
{'0': {'precision': 0.38878740431454417, 'recall': 0.4347022637196975, 'f1-score': 0.4104648092663383, 'support': 41127}, '1': {'precision': 0.3452431417670926, 'recall': 0.27754247602356263, 'f1-score': 0.3077130674151239, 'support': 41082}, '2': {'precision': 0.3946364477753448, 'recall': 0.425352798053528, 'f1-score': 0.4094193140434899, 'support': 41100}, 'accuracy': 0.3792261716500823, 'macro avg': {'precision': 0.3762223312856605, 'recall': 0.379199179265596, 'f1-score': 0.37586573024165065, 'support': 123309}, 'weighted avg': {'precision': 0.376229604740016, 'recall': 0.3792261716500823, 'f1-score': 0.375883254696999, 'support': 123309}}
[[17878 10968 12281]
 [15144 11402 14536]
 [12962 10656 17482]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920074
{'0': {'precision': 0.39582560421668567, 'recall': 0.43358130544366513, 'f1-score': 0.41384411006312694, 'support': 474919}, '1': {'precision': 0.32035142118863047, 'recall': 0.32423064584369754, 'f1-score': 0.32227936053866885, 'support': 430166}, '2': {'precision': 0.42728774451840335, 'recall': 0.38430546233800894, 'f1-score': 0.4046584244945807, 'support': 502111}, 'accuracy': 0.3825714399415575, 'macro avg': {'precision': 0.3811549233079065, 'recall': 0.38070580454179054, 'f1-score': 0.3802606316987922, 'support': 1407196}, 'weighted avg': {'precision': 0.383980103883107, 'recall': 0.3825714399415575, 'f1-score': 0.38257605940746386, 'support': 1407196}}
[[205916 144673 124330]
 [156385 139473 134308]
 [157918 151229 192964]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937024
{'0': {'precision': 0.37624799471548553, 'recall': 0.45301777030404944, 'f1-score': 0.41107937849903603, 'support': 176024}, '1': {'precision': 0.34798426492518125, 'recall': 0.3072775362401099, 'f1-score': 0.32636649164159853, 'support': 176186}, '2': {'precision': 0.3875699902076481, 'recall': 0.35359707698122717, 'f1-score': 0.3698049245033271, 'support': 174614}, 'accuracy': 0.3713251484366695, 'macro avg': {'precision': 0.3706007499494383, 'recall': 0.3712974611751288, 'f1-score': 0.36908359821465386, 'support': 526824}, 'weighted avg': {'precision': 0.37054837857049955, 'recall': 0.3713251484366695, 'f1-score': 0.36906853200405626, 'support': 526824}}
[[79742 51541 44741]
 [69224 54138 52824]
 [62974 49897 61743]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950906
{'0': {'precision': 0.37700030089996445, 'recall': 0.4680829385093484, 'f1-score': 0.4176331997484868, 'support': 58887}, '1': {'precision': 0.33589612921808876, 'recall': 0.26476649551154424, 'f1-score': 0.2961197761522009, 'support': 57258}, '2': {'precision': 0.3785235138799686, 'recall': 0.3648416274031021, 'f1-score': 0.3715566607708877, 'support': 58154}, 'accuracy': 0.36684662562607934, 'macro avg': {'precision': 0.36380664799934054, 'recall': 0.36589702047466494, 'f1-score': 0.3617698788905252, 'support': 174299}, 'weighted avg': {'precision': 0.3640056093955859, 'recall': 0.36684662562607934, 'f1-score': 0.3623422878328738, 'support': 174299}}
[[27564 14942 16381]
 [23644 15160 18454]
 [21906 15031 21217]]
testing model on single stock: results/universal/W2/deepOF_L1/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 185s - 185s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896796
{'0': {'precision': 0.32232265317023595, 'recall': 0.46490793032644384, 'f1-score': 0.38070258123637696, 'support': 1092868}, '1': {'precision': 0.4199337440338295, 'recall': 0.23871209682711808, 'f1-score': 0.3043920065926324, 'support': 1599965}, '2': {'precision': 0.3368439655517483, 'recall': 0.3992673631968174, 'f1-score': 0.36540886325781385, 'support': 1117061}, 'accuracy': 0.35067117352871235, 'macro avg': {'precision': 0.3597001209186046, 'recall': 0.3676291301167931, 'f1-score': 0.35016781702894106, 'support': 3809894}, 'weighted avg': {'precision': 0.36757208024715043, 'recall': 0.35067117352871235, 'f1-score': 0.34417183669106144, 'support': 3809894}}
[[508083 261087 323698]
 [663665 381931 554369]
 [404570 266485 446006]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.099763
{'0': {'precision': 0.3652416297867207, 'recall': 0.44360300681140336, 'f1-score': 0.40062646855773804, 'support': 518689}, '1': {'precision': 0.33687425176527397, 'recall': 0.2605370548604427, 'f1-score': 0.29382847107119553, 'support': 519500}, '2': {'precision': 0.37709051708224733, 'recall': 0.3816257981595161, 'f1-score': 0.3793446026372623, 'support': 535294}, 'accuracy': 0.3620776328692461, 'macro avg': {'precision': 0.359735466211414, 'recall': 0.36192195327712073, 'f1-score': 0.35793318075539865, 'support': 1573483}, 'weighted avg': {'precision': 0.3599068313769699, 'recall': 0.3620776328692461, 'f1-score': 0.3581260952900929, 'support': 1573483}}
[[230092 131011 157586]
 [204287 135349 179864]
 [195593 135419 204282]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943387
{'0': {'precision': 0.3574368018812463, 'recall': 0.4488045664827827, 'f1-score': 0.3979435320686089, 'support': 177467}, '1': {'precision': 0.35321553244322884, 'recall': 0.24983835905163856, 'f1-score': 0.2926663446227613, 'support': 196423}, '2': {'precision': 0.3764513163908246, 'recall': 0.401444584996687, 'f1-score': 0.38854644229495167, 'support': 182613}, 'accuracy': 0.3630366772506168, 'macro avg': {'precision': 0.3623678835717666, 'recall': 0.36669583684370277, 'f1-score': 0.3597187729954406, 'support': 556503}, 'weighted avg': {'precision': 0.36218635962184054, 'recall': 0.3630366772506168, 'f1-score': 0.3577013559356634, 'support': 556503}}
[[79648 45084 52735]
 [78656 49074 68693]
 [64527 44777 73309]]
training model: results/universal/W2/deepLOB_L2/h50
Epoch 1/50
9940/9940 - 465s - loss: 3.0814 - accuracy50: 0.4586 - val_loss: 3.5291 - val_accuracy50: 0.4047 - 465s/epoch - 47ms/step
Epoch 2/50
9940/9940 - 457s - loss: 3.0299 - accuracy50: 0.4767 - val_loss: 3.9580 - val_accuracy50: 0.3783 - 457s/epoch - 46ms/step
Epoch 3/50
9940/9940 - 460s - loss: 2.9912 - accuracy50: 0.4885 - val_loss: 4.0273 - val_accuracy50: 0.3943 - 460s/epoch - 46ms/step
Epoch 4/50
9940/9940 - 456s - loss: 2.9621 - accuracy50: 0.4960 - val_loss: 4.3668 - val_accuracy50: 0.3858 - 456s/epoch - 46ms/step
Epoch 5/50
9940/9940 - 453s - loss: 2.9424 - accuracy50: 0.5010 - val_loss: 4.1513 - val_accuracy50: 0.3990 - 453s/epoch - 46ms/step
Epoch 6/50
9940/9940 - 452s - loss: 2.9285 - accuracy50: 0.5045 - val_loss: 4.1313 - val_accuracy50: 0.4030 - 452s/epoch - 45ms/step
Epoch 7/50
9940/9940 - 452s - loss: 2.9175 - accuracy50: 0.5071 - val_loss: 4.1568 - val_accuracy50: 0.4035 - 452s/epoch - 45ms/step
Epoch 8/50
9940/9940 - 456s - loss: 2.9103 - accuracy50: 0.5085 - val_loss: 4.0258 - val_accuracy50: 0.4157 - 456s/epoch - 46ms/step
Epoch 9/50
9940/9940 - 453s - loss: 2.9038 - accuracy50: 0.5101 - val_loss: 3.9292 - val_accuracy50: 0.4189 - 453s/epoch - 46ms/step
Epoch 10/50
9940/9940 - 454s - loss: 2.8982 - accuracy50: 0.5115 - val_loss: 3.9127 - val_accuracy50: 0.4275 - 454s/epoch - 46ms/step
Epoch 11/50
9940/9940 - 458s - loss: 2.8937 - accuracy50: 0.5125 - val_loss: 3.9818 - val_accuracy50: 0.4209 - 458s/epoch - 46ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 459s - 459s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059574
{'0': {'precision': 0.3366685163578477, 'recall': 0.5739828908338108, 'f1-score': 0.42440382070619753, 'support': 1771565}, '1': {'precision': 0.5344202230697562, 'recall': 0.4057235507374285, 'f1-score': 0.46126321639443074, 'support': 3144237}, '2': {'precision': 0.3963090904522575, 'recall': 0.28837535533890646, 'f1-score': 0.33383487966094955, 'support': 1804967}, 'accuracy': 0.41856028677670665, 'macro avg': {'precision': 0.4224659432932871, 'recall': 0.422693932303382, 'f1-score': 0.40650063892052596, 'support': 6720769}, 'weighted avg': {'precision': 0.44520185549778774, 'recall': 0.41856028677670665, 'f1-score': 0.4173243817177373, 'support': 6720769}}
[[1016848  485614  269103]
 [1344768 1275691  523778]
 [ 658708  625751  520508]]
Evaluating performance on  train set...
9940/9940 - 178s - 178s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1793021
{'0': {'precision': 0.38474371890774506, 'recall': 0.46802914442543647, 'f1-score': 0.4223194271910082, 'support': 787389}, '1': {'precision': 0.40029774182873457, 'recall': 0.4710596430271697, 'f1-score': 0.4328054473345826, 'support': 957832}, '2': {'precision': 0.41160130647700366, 'recall': 0.23644199733718435, 'f1-score': 0.30034978970455223, 'support': 798403}, 'accuracy': 0.39647880347095327, 'macro avg': {'precision': 0.3988809224044944, 'recall': 0.39184359492993015, 'f1-score': 0.3851582214100477, 'support': 2543624}, 'weighted avg': {'precision': 0.3990309403565583, 'recall': 0.39647880347095327, 'f1-score': 0.38798373967117866, 'support': 2543624}}
[[368521 312204 106664]
 [343438 451196 163198]
 [245876 363751 188776]]
Evaluating performance on  val set...
3393/3393 - 60s - 60s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1639289
{'0': {'precision': 0.3843719278394116, 'recall': 0.5212254028781623, 'f1-score': 0.44245804652362447, 'support': 263293}, '1': {'precision': 0.4293210362753663, 'recall': 0.44333202208807426, 'f1-score': 0.4362140516503792, 'support': 338101}, '2': {'precision': 0.3995367939968502, 'recall': 0.24256729647947264, 'f1-score': 0.30186557413767356, 'support': 266693}, 'accuracy': 0.4052785031915004, 'macro avg': {'precision': 0.40440991937054266, 'recall': 0.40237490714856977, 'f1-score': 0.39351255743722574, 'support': 868087}, 'weighted avg': {'precision': 0.40653756580130995, 'recall': 0.4052785031915004, 'f1-score': 0.39683343845016467, 'support': 868087}}
[[137235  89749  36309]
 [127295 149891  60915]
 [ 92507 109495  64691]]
testing model out of sample: results/universal/W2/deepLOB_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 255s - 255s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.086007
{'0': {'precision': 0.411261699924616, 'recall': 0.466677428722874, 'f1-score': 0.4372206372637488, 'support': 1201753}, '1': {'precision': 0.467136707664299, 'recall': 0.3220500844638651, 'f1-score': 0.3812568017104565, 'support': 1246095}, '2': {'precision': 0.44285254246091516, 'recall': 0.5246335790497053, 'f1-score': 0.4802866091345396, 'support': 1218885}, 'accuracy': 0.43679318892321856, 'macro avg': {'precision': 0.4404169833499434, 'recall': 0.4377870307454814, 'f1-score': 0.4329213493695816, 'support': 3666733}, 'weighted avg': {'precision': 0.4407514860296412, 'recall': 0.43679318892321856, 'f1-score': 0.4325178709210533, 'support': 3666733}}
[[560831 216687 424235]
 [464518 401305 380272]
 [338335 241082 639468]]
Evaluating performance on  train set...
5373/5373 - 97s - 97s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0806563
{'0': {'precision': 0.3968954675950682, 'recall': 0.5063025972360976, 'f1-score': 0.4449726231691644, 'support': 413401}, '1': {'precision': 0.5005491027015853, 'recall': 0.35565110903439373, 'f1-score': 0.41583928866601255, 'support': 544663}, '2': {'precision': 0.4168962889136425, 'recall': 0.46061445008492713, 'f1-score': 0.43766633575231345, 'support': 416828}, 'accuracy': 0.4327707194456001, 'macro avg': {'precision': 0.43811361973676527, 'recall': 0.44085605211847284, 'f1-score': 0.43282608252916344, 'support': 1374892}, 'weighted avg': {'precision': 0.44402149800807483, 'recall': 0.4327707194456001, 'f1-score': 0.43121640483210133, 'support': 1374892}}
[[209306  89366 114729]
 [197140 193710 153813]
 [120912 103919 191997]]
Evaluating performance on  val set...
1685/1685 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784993
{'0': {'precision': 0.404363992063448, 'recall': 0.5413594255738681, 'f1-score': 0.46293927882871705, 'support': 134395}, '1': {'precision': 0.4882275120037746, 'recall': 0.32603095171902513, 'f1-score': 0.390974825527123, 'support': 161865}, '2': {'precision': 0.42978815876175924, 'recall': 0.4561423087224355, 'f1-score': 0.44257324969501854, 'support': 134412}, 'accuracy': 0.4338336367351488, 'macro avg': {'precision': 0.4407932209429939, 'recall': 0.44117756200510955, 'f1-score': 0.4321624513502862, 'support': 430672}, 'weighted avg': {'precision': 0.4438183372481695, 'recall': 0.4338336367351488, 'f1-score': 0.42953574913191483, 'support': 430672}}
[[72756 25239 36400]
 [64149 52773 44943]
 [43022 30079 61311]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/LILAK
Evaluating performance on  test set...
987/987 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1591965
{'0': {'precision': 0.3378182679902051, 'recall': 0.4909564019490293, 'f1-score': 0.40023916603842247, 'support': 78398}, '1': {'precision': 0.3249237417386884, 'recall': 0.11566564868227576, 'f1-score': 0.17060109107288834, 'support': 88410}, '2': {'precision': 0.4047494537101022, 'recall': 0.5058293556782242, 'f1-score': 0.4496791563133842, 'support': 85687}, 'accuracy': 0.3645973187587873, 'macro avg': {'precision': 0.35583048781299853, 'recall': 0.37081713543650974, 'f1-score': 0.3401731378082317, 'support': 252495}, 'weighted avg': {'precision': 0.3560171528983586, 'recall': 0.3645973187587873, 'f1-score': 0.33661042978221056, 'support': 252495}}
[[38490 10411 29497]
 [43938 10226 34246]
 [31509 10835 43343]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1440264
{'0': {'precision': 0.37499526138216005, 'recall': 0.5030512611879577, 'f1-score': 0.429685294181526, 'support': 19664}, '1': {'precision': 0.35592343507501295, 'recall': 0.17150264233722207, 'f1-score': 0.23147057834000606, 'support': 20058}, '2': {'precision': 0.3925699122269851, 'recall': 0.46193015324014025, 'f1-score': 0.4244350282485876, 'support': 20817}, 'accuracy': 0.3790614314739259, 'macro avg': {'precision': 0.3744962028947194, 'recall': 0.37882801892177337, 'f1-score': 0.36186363359003987, 'support': 60539}, 'weighted avg': {'precision': 0.37471955174982335, 'recall': 0.3790614314739259, 'f1-score': 0.3622067174578406, 'support': 60539}}
[[9892 2835 6937]
 [8676 3440 7942]
 [7811 3390 9616]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1383545
{'0': {'precision': 0.3777191129883844, 'recall': 0.5142323174238068, 'f1-score': 0.4355290393278949, 'support': 6956}, '1': {'precision': 0.3945518453427065, 'recall': 0.18389078498293515, 'f1-score': 0.250861346494087, 'support': 7325}, '2': {'precision': 0.3849242771913722, 'recall': 0.4583959557316573, 'f1-score': 0.41845961958216404, 'support': 7319}, 'accuracy': 0.38328703703703704, 'macro avg': {'precision': 0.3857317451741544, 'recall': 0.38550635271279976, 'f1-score': 0.3682833351347153, 'support': 21600}, 'weighted avg': {'precision': 0.3858688519373231, 'recall': 0.38328703703703704, 'f1-score': 0.3671206164979576, 'support': 21600}}
[[3577  948 2431]
 [3048 1347 2930]
 [2845 1119 3355]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.070062
{'0': {'precision': 0.36133716291686613, 'recall': 0.5246452360266435, 'f1-score': 0.4279403774832873, 'support': 86325}, '1': {'precision': 0.6001847592473889, 'recall': 0.2266917320003133, 'f1-score': 0.32908644527716757, 'support': 140433}, '2': {'precision': 0.39613533500218767, 'recall': 0.6066277830867411, 'f1-score': 0.4792890678561821, 'support': 91041}, 'accuracy': 0.41646764149666926, 'macro avg': {'precision': 0.4525524190554809, 'recall': 0.4526549170378993, 'f1-score': 0.4121052968722123, 'support': 317799}, 'weighted avg': {'precision': 0.4768508834770443, 'recall': 0.41646764149666926, 'f1-score': 0.398967604940695, 'support': 317799}}
[[45290  8766 32269]
 [56678 31835 51920]
 [23372 12441 55228]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0492122
{'0': {'precision': 0.3383436866329782, 'recall': 0.6624862139593509, 'f1-score': 0.44792432328784637, 'support': 31735}, '1': {'precision': 0.6724553618225654, 'recall': 0.27073222198776115, 'f1-score': 0.3860426863516008, 'support': 71085}, '2': {'precision': 0.3796906492741808, 'recall': 0.5224029413597557, 'f1-score': 0.4397581671060052, 'support': 32094}, 'accuracy': 0.4227507893917607, 'macro avg': {'precision': 0.4634965659099081, 'recall': 0.4852071257689559, 'f1-score': 0.42457505891515074, 'support': 134914}, 'weighted avg': {'precision': 0.5242200067321419, 'recall': 0.4227507893917607, 'f1-score': 0.41337682800853487, 'support': 134914}}
[[21024  4310  6401]
 [30850 19245 20990]
 [10264  5064 16766]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0510681
{'0': {'precision': 0.3788527397260274, 'recall': 0.5837180815980402, 'f1-score': 0.459484516966438, 'support': 10613}, '1': {'precision': 0.6009467758444217, 'recall': 0.23476783125905934, 'f1-score': 0.3376343313086296, 'support': 20007}, '2': {'precision': 0.35727765264503564, 'recall': 0.5883709273182958, 'f1-score': 0.4445875312476328, 'support': 9975}, 'accuracy': 0.4128833600197069, 'macro avg': {'precision': 0.4456923894051616, 'recall': 0.4689522800584651, 'f1-score': 0.4139021265075668, 'support': 40595}, 'weighted avg': {'precision': 0.4830090123455082, 'recall': 0.4128833600197069, 'f1-score': 0.3957709045264613, 'support': 40595}}
[[6195 1739 2679]
 [7431 4697 7879]
 [2726 1380 5869]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1274985
{'0': {'precision': 0.39791153901838716, 'recall': 0.47637825130810646, 'f1-score': 0.43362373718697766, 'support': 92309}, '1': {'precision': 0.40545021751621113, 'recall': 0.3071470321224708, 'f1-score': 0.34951813537494875, 'support': 80411}, '2': {'precision': 0.44531356410406087, 'recall': 0.45098676756032435, 'f1-score': 0.4481322113384147, 'support': 101493}, 'accuracy': 0.4173543923883988, 'macro avg': {'precision': 0.41622510687955305, 'recall': 0.4115040169969672, 'f1-score': 0.41042469463344705, 'support': 274213}, 'weighted avg': {'precision': 0.41766686210193466, 'recall': 0.4173543923883988, 'f1-score': 0.4143303157217107, 'support': 274213}}
[[43974 17168 31167]
 [29866 24698 25847]
 [36672 19049 45772]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1715724
{'0': {'precision': 0.3865564431234132, 'recall': 0.5096750489875899, 'f1-score': 0.43965911892101284, 'support': 24496}, '1': {'precision': 0.38643318599115944, 'recall': 0.2804557045323682, 'f1-score': 0.325023832221163, 'support': 24314}, '2': {'precision': 0.3983630694612853, 'recall': 0.37971600759514573, 'f1-score': 0.3888160953548333, 'support': 24226}, 'accuracy': 0.3902595980064626, 'macro avg': {'precision': 0.39045089952528594, 'recall': 0.38994892037170126, 'f1-score': 0.38449968216566965, 'support': 73036}, 'weighted avg': {'precision': 0.3904316615875634, 'recall': 0.3902595980064626, 'f1-score': 0.3846319343855178, 'support': 73036}}
[[12485  4844  7167]
 [10769  6819  6726]
 [ 9044  5983  9199]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.161599
{'0': {'precision': 0.3820578231292517, 'recall': 0.47126075099643383, 'f1-score': 0.42199680661219124, 'support': 9534}, '1': {'precision': 0.3913665895826451, 'recall': 0.34713811291267826, 'f1-score': 0.367927946581086, 'support': 10238}, '2': {'precision': 0.41079393398751113, 'recall': 0.36704194480422436, 'f1-score': 0.38768745067087607, 'support': 10037}, 'accuracy': 0.3935388641014459, 'macro avg': {'precision': 0.3947394488998026, 'recall': 0.39514693623777886, 'f1-score': 0.39253740128805115, 'support': 29809}, 'weighted avg': {'precision': 0.3949306969470313, 'recall': 0.3935388641014459, 'f1-score': 0.3918743605528992, 'support': 29809}}
[[4493 2452 2589]
 [3989 3554 2695]
 [3278 3075 3684]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1790231
{'0': {'precision': 0.3818550419205571, 'recall': 0.4523056885861971, 'f1-score': 0.41410534291410217, 'support': 73709}, '1': {'precision': 0.3213620935070623, 'recall': 0.12973522521327852, 'f1-score': 0.18484695805517065, 'support': 67869}, '2': {'precision': 0.3819474139323622, 'recall': 0.5129137636219789, 'f1-score': 0.4378468761403681, 'support': 78366}, 'accuracy': 0.37436347433892264, 'macro avg': {'precision': 0.3617215164533272, 'recall': 0.36498489247381816, 'f1-score': 0.3455997257032137, 'support': 219944}, 'weighted avg': {'precision': 0.363221402945189, 'recall': 0.37436347433892264, 'f1-score': 0.3518212691081276, 'support': 219944}}
[[33339  8916 31454]
 [25476  8805 33588]
 [28493  9678 40195]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1778563
{'0': {'precision': 0.398534074052529, 'recall': 0.48353742456858523, 'f1-score': 0.4369399534423929, 'support': 28337}, '1': {'precision': 0.33709425446971014, 'recall': 0.14598759631648187, 'f1-score': 0.20374013166522412, 'support': 26605}, '2': {'precision': 0.3650185863215853, 'recall': 0.48840688107703817, 'f1-score': 0.41779299093075706, 'support': 26740}, 'accuracy': 0.37518669964006757, 'macro avg': {'precision': 0.3668823049479415, 'recall': 0.37264396732070176, 'f1-score': 0.352824358679458, 'support': 81682}, 'weighted avg': {'precision': 0.3675503745602745, 'recall': 0.37518669964006757, 'f1-score': 0.35471533803211014, 'support': 81682}}
[[13702  3875 10760]
 [10762  3884 11959]
 [ 9917  3763 13060]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1765889
{'0': {'precision': 0.39306885544915643, 'recall': 0.5001740745038876, 'f1-score': 0.44020018384230414, 'support': 8617}, '1': {'precision': 0.36675866298681387, 'recall': 0.14482925647856623, 'f1-score': 0.20765691466273115, 'support': 8258}, '2': {'precision': 0.3537959944108058, 'recall': 0.4697007172891417, 'f1-score': 0.40359173263907344, 'support': 8086}, 'accuracy': 0.3727414767036577, 'macro avg': {'precision': 0.37120783761559206, 'recall': 0.37156801609053186, 'f1-score': 0.35048294371470295, 'support': 24961}, 'weighted avg': {'precision': 0.3716422329696833, 'recall': 0.3727414767036577, 'f1-score': 0.35140733686845543, 'support': 24961}}
[[4310  999 3308]
 [3433 1196 3629]
 [3222 1066 3798]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1605607
{'0': {'precision': 0.42448376004418553, 'recall': 0.4242695855543552, 'f1-score': 0.424376645776866, 'support': 168466}, '1': {'precision': 0.3650199965454473, 'recall': 0.38738402098197916, 'f1-score': 0.3758696410614239, 'support': 141836}, '2': {'precision': 0.4488106097817697, 'recall': 0.42730921906055663, 'f1-score': 0.43779607505368917, 'support': 179617}, 'accuracy': 0.41470528801699874, 'macro avg': {'precision': 0.4127714554571342, 'recall': 0.412987608532297, 'f1-score': 0.4126807872973264, 'support': 489919}, 'weighted avg': {'precision': 0.41618731391678204, 'recall': 0.41470528801699874, 'f1-score': 0.41525333785779306, 'support': 489919}}
[[71475 45496 51495]
 [44126 54945 42765]
 [52780 50085 76752]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1421354
{'0': {'precision': 0.41164414270159483, 'recall': 0.5178887993553586, 'f1-score': 0.4586946436855441, 'support': 62050}, '1': {'precision': 0.43637740367683314, 'recall': 0.4087115714474205, 'f1-score': 0.42209163685913814, 'support': 60632}, '2': {'precision': 0.41528094546962474, 'recall': 0.3316004701908909, 'f1-score': 0.36875293424528904, 'support': 60401}, 'accuracy': 0.4202738648591076, 'macro avg': {'precision': 0.42110083061601755, 'recall': 0.4194002803312233, 'f1-score': 0.4165130715966571, 'support': 183083}, 'weighted avg': {'precision': 0.4210349305051726, 'recall': 0.4202738648591076, 'f1-score': 0.4169000330346399, 'support': 183083}}
[[32135 15176 14739]
 [22389 24781 13462]
 [23541 16831 20029]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.149792
{'0': {'precision': 0.40153684439450504, 'recall': 0.5648006525950852, 'f1-score': 0.4693769463805267, 'support': 19614}, '1': {'precision': 0.3346242284884425, 'recall': 0.18177634606534745, 'f1-score': 0.23557979040640709, 'support': 15211}, '2': {'precision': 0.43309222423146476, 'recall': 0.4106611528569267, 'f1-score': 0.4215785250187673, 'support': 19829}, 'accuracy': 0.40227613715373073, 'macro avg': {'precision': 0.3897510990381374, 'recall': 0.3857460505057864, 'f1-score': 0.3755117539352337, 'support': 54654}, 'weighted avg': {'precision': 0.3943626911072791, 'recall': 0.40227613715373073, 'f1-score': 0.386966080996389, 'support': 54654}}
[[11078  2506  6030]
 [ 7817  2765  4629]
 [ 8694  2992  8143]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/EXC
Evaluating performance on  test set...
4918/4918 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99232435
{'0': {'precision': 0.38888155869287944, 'recall': 0.5448412968674495, 'f1-score': 0.4538364494439086, 'support': 308343}, '1': {'precision': 0.674564778362902, 'recall': 0.33333228065466086, 'f1-score': 0.4461848836828361, 'support': 633305}, '2': {'precision': 0.4075973161675994, 'recall': 0.6603623684152451, 'f1-score': 0.5040675841041148, 'support': 317191}, 'accuracy': 0.46754191759232117, 'macro avg': {'precision': 0.4903478844077936, 'recall': 0.5128453153124518, 'f1-score': 0.46802963907695316, 'support': 1258839}, 'weighted avg': {'precision': 0.5373207802790294, 'recall': 0.46754191759232117, 'f1-score': 0.462643841794868, 'support': 1258839}}
[[167998  43079  97266]
 [215039 211101 207165]
 [ 48966  58764 209461]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9577673
{'0': {'precision': 0.3693181818181818, 'recall': 0.5744358662463074, 'f1-score': 0.44958664840342333, 'support': 80566}, '1': {'precision': 0.6915128168861747, 'recall': 0.4197070155682696, 'f1-score': 0.5223678917994872, 'support': 198031}, '2': {'precision': 0.4088037012557832, 'recall': 0.5770996354950674, 'f1-score': 0.4785874196576876, 'support': 80383}, 'accuracy': 0.48967630508663434, 'macro avg': {'precision': 0.4898782333200466, 'recall': 0.5237475057698814, 'f1-score': 0.48351398662019934, 'support': 358980}, 'weighted avg': {'precision': 0.5558981870722417, 'recall': 0.48967630508663434, 'f1-score': 0.49623022578015025, 'support': 358980}}
[[46280 16669 17617]
 [65447 83115 49469]
 [13585 20409 46389]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97374886
{'0': {'precision': 0.3807964669154039, 'recall': 0.5157619718794045, 'f1-score': 0.4381205466651092, 'support': 29089}, '1': {'precision': 0.6860052291179304, 'recall': 0.3868514581037667, 'f1-score': 0.49472054620514444, 'support': 64433}, '2': {'precision': 0.4031671029947002, 'recall': 0.6488097276930981, 'f1-score': 0.49730893433799783, 'support': 29195}, 'accuracy': 0.4797297847893935, 'macro avg': {'precision': 0.4899895996760115, 'recall': 0.5171410525587564, 'f1-score': 0.47671667573608384, 'support': 122717}, 'weighted avg': {'precision': 0.5463695081022846, 'recall': 0.4797297847893935, 'f1-score': 0.4819197981826094, 'support': 122717}}
[[15003  5389  8697]
 [20163 24926 19344]
 [ 4233  6020 18942]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/AAL
Evaluating performance on  test set...
4856/4856 - 85s - 85s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0448736
{'0': {'precision': 0.42448662680696486, 'recall': 0.49093515099036156, 'f1-score': 0.45529921022046105, 'support': 405357}, '1': {'precision': 0.517182651319994, 'recall': 0.35273566338039564, 'f1-score': 0.4194158520849641, 'support': 445084}, '2': {'precision': 0.458323769690478, 'recall': 0.5494924375229321, 'f1-score': 0.499784471770437, 'support': 392464}, 'accuracy': 0.45993619785904793, 'macro avg': {'precision': 0.46666434927247896, 'recall': 0.4643877506312298, 'f1-score': 0.4581665113586207, 'support': 1242905}, 'weighted avg': {'precision': 0.4683655860347354, 'recall': 0.45993619785904793, 'f1-score': 0.4564962084758146, 'support': 1242905}}
[[199004  72748 133605]
 [166816 156997 121271]
 [102991  73817 215656]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.046839
{'0': {'precision': 0.3563224723884896, 'recall': 0.5142146693363596, 'f1-score': 0.42094985620791275, 'support': 138343}, '1': {'precision': 0.5931801760505931, 'recall': 0.3025715610473296, 'f1-score': 0.40073481170450076, 'support': 252337}, '2': {'precision': 0.3907225735279633, 'recall': 0.5637532864350174, 'f1-score': 0.46155412441605437, 'support': 140730}, 'accuracy': 0.4268361528763102, 'macro avg': {'precision': 0.446741740655682, 'recall': 0.4601798389395689, 'f1-score': 0.4277462641094893, 'support': 531410}, 'weighted avg': {'precision': 0.4779029631627361, 'recall': 0.4268361528763102, 'f1-score': 0.4221038333255325, 'support': 531410}}
[[71138 24105 43100]
 [95372 76350 80615]
 [33135 28258 79337]]
Evaluating performance on  val set...
588/588 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0277244
{'0': {'precision': 0.37551740835038505, 'recall': 0.6103325717187104, 'f1-score': 0.46496020732804055, 'support': 39390}, '1': {'precision': 0.5988176810425904, 'recall': 0.3100262934572418, 'f1-score': 0.4085392681674854, 'support': 71881}, '2': {'precision': 0.399743244895464, 'recall': 0.5024975024975025, 'f1-score': 0.4452691430322427, 'support': 39039}, 'accuracy': 0.43871332579336036, 'macro avg': {'precision': 0.45802611142947985, 'recall': 0.47428545589115156, 'f1-score': 0.4395895395092562, 'support': 150310}, 'weighted avg': {'precision': 0.4885957087580209, 'recall': 0.43871332579336036, 'f1-score': 0.4328644519768096, 'support': 150310}}
[[24041  6831  8518]
 [28657 22285 20939]
 [11323  8099 19617]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/WBA
Evaluating performance on  test set...
4353/4353 - 76s - 76s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0345281
{'0': {'precision': 0.45489272713190304, 'recall': 0.4399815410800865, 'f1-score': 0.44731290242486926, 'support': 333714}, '1': {'precision': 0.5021785508685984, 'recall': 0.5965018525388049, 'f1-score': 0.5452913057689165, 'support': 447494}, '2': {'precision': 0.458415875861167, 'recall': 0.357790921100036, 'f1-score': 0.40190069252521304, 'support': 333080}, 'accuracy': 0.47827132662291977, 'macro avg': {'precision': 0.4718290512872228, 'recall': 0.4647581049063092, 'f1-score': 0.46483496690633297, 'support': 1114288}, 'weighted avg': {'precision': 0.47493567185173485, 'recall': 0.47827132662291977, 'f1-score': 0.47308617536028963, 'support': 1114288}}
[[146828 126955  59931]
 [ 99700 266931  80863]
 [ 76247 137660 119173]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0902311
{'0': {'precision': 0.4509524538117278, 'recall': 0.37090900510464925, 'f1-score': 0.4070328987402411, 'support': 127139}, '1': {'precision': 0.45296845735350955, 'recall': 0.6405972993994773, 'f1-score': 0.530686643582145, 'support': 142709}, '2': {'precision': 0.46303122412639364, 'recall': 0.32734634967726417, 'f1-score': 0.38354221078145845, 'support': 124715}, 'accuracy': 0.4546827756277198, 'macro avg': {'precision': 0.455650711763877, 'recall': 0.4462842180604636, 'f1-score': 0.4404205843679481, 'support': 394563}, 'weighted avg': {'precision': 0.455499524087546, 'recall': 0.4546827756277198, 'f1-score': 0.44433204012923017, 'support': 394563}}
[[47157 53604 26378]
 [30324 91419 20966]
 [27091 56799 40825]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0691508
{'0': {'precision': 0.4267645960413295, 'recall': 0.44123249588138386, 'f1-score': 0.4338779694480655, 'support': 38848}, '1': {'precision': 0.49148955536340055, 'recall': 0.47299842326559216, 'f1-score': 0.4820667336234795, 'support': 45664}, '2': {'precision': 0.4478430572208475, 'recall': 0.45247177689571627, 'f1-score': 0.45014551841737505, 'support': 38798}, 'accuracy': 0.4565323169248236, 'macro avg': {'precision': 0.4553657362085259, 'recall': 0.4555675653475641, 'f1-score': 0.45536340716297335, 'support': 123310}, 'weighted avg': {'precision': 0.4573655422689346, 'recall': 0.4565323169248236, 'f1-score': 0.45684155790169767, 'support': 123310}}
[[17141 10703 11004]
 [13425 21599 10640]
 [ 9599 11644 17555]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 96s - 96s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0752923
{'0': {'precision': 0.4140986002138203, 'recall': 0.4549158725610916, 'f1-score': 0.4335486506710689, 'support': 457223}, '1': {'precision': 0.49462369030409253, 'recall': 0.3153905137920767, 'f1-score': 0.38517749202387974, 'support': 490354}, '2': {'precision': 0.4354149148489975, 'recall': 0.5610477259673124, 'f1-score': 0.4903115035565367, 'support': 459624}, 'accuracy': 0.4409618810674523, 'macro avg': {'precision': 0.4480457351223035, 'recall': 0.44378470410682685, 'f1-score': 0.4363458820838284, 'support': 1407201}, 'weighted avg': {'precision': 0.44912081084613514, 'recall': 0.4409618810674523, 'f1-score': 0.4352332560453875, 'support': 1407201}}
[[207998  70668 178557]
 [179887 154653 155814]
 [114406  87347 257871]]
Evaluating performance on  train set...
2058/2058 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0734025
{'0': {'precision': 0.4378658944551309, 'recall': 0.49612077134464133, 'f1-score': 0.4651765881830298, 'support': 168848}, '1': {'precision': 0.4728186150955502, 'recall': 0.44062630123530605, 'f1-score': 0.4561551852772942, 'support': 187322}, '2': {'precision': 0.45845760015906156, 'recall': 0.43237193385446576, 'f1-score': 0.4450328409700903, 'support': 170654}, 'accuracy': 0.45573853886687016, 'macro avg': {'precision': 0.4563807032365809, 'recall': 0.4563730021448044, 'f1-score': 0.4554548714768048, 'support': 526824}, 'weighted avg': {'precision': 0.4569642469998198, 'recall': 0.45573853886687016, 'f1-score': 0.4554437015415989, 'support': 526824}}
[[83769 42667 42412]
 [60037 82539 44746]
 [47506 49362 73786]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777696
{'0': {'precision': 0.44056581227221125, 'recall': 0.5007555049999151, 'f1-score': 0.4687363427599742, 'support': 58901}, '1': {'precision': 0.4539316918189039, 'recall': 0.39958049292081804, 'f1-score': 0.42502556474853587, 'support': 57210}, '2': {'precision': 0.462967837026899, 'recall': 0.45344400907403587, 'f1-score': 0.45815643476675433, 'support': 58188}, 'accuracy': 0.451752448378935, 'macro avg': {'precision': 0.45248844703933805, 'recall': 0.45126000233158964, 'f1-score': 0.45063944742508816, 'support': 174299}, 'weighted avg': {'precision': 0.4524315773385172, 'recall': 0.451752448378935, 'f1-score': 0.4508571966011101, 'support': 174299}}
[[29495 12553 16853]
 [20597 22860 13753]
 [16856 14947 26385]]
testing model on single stock: results/universal/W2/deepLOB_L2/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 273s - 273s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1631302
{'0': {'precision': 0.3035865470144259, 'recall': 0.6428372498901466, 'f1-score': 0.4124087784451109, 'support': 969474}, '1': {'precision': 0.5179161608793651, 'recall': 0.4079981198143964, 'f1-score': 0.4564327913852752, 'support': 1855136}, '2': {'precision': 0.32864975663215434, 'recall': 0.09861370623238461, 'f1-score': 0.15170672604010205, 'support': 985289}, 'accuracy': 0.3877449244717511, 'macro avg': {'precision': 0.3833841548419818, 'recall': 0.38314969197897586, 'f1-score': 0.3401827652901628, 'support': 3809899}, 'weighted avg': {'precision': 0.41443071566246353, 'recall': 0.3877449244717511, 'f1-score': 0.3664242698682919, 'support': 3809899}}
[[623214 297922  48338]
 [948102 756892 150142]
 [481522 406604  97163]]
Evaluating performance on  train set...
6147/6147 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2630244
{'0': {'precision': 0.38074317908463634, 'recall': 0.46300701292502866, 'f1-score': 0.41786482233484906, 'support': 519612}, '1': {'precision': 0.3318323582664392, 'recall': 0.48835006411219056, 'f1-score': 0.3951568553833403, 'support': 519402}, '2': {'precision': 0.40568694170292247, 'recall': 0.13451244314471691, 'f1-score': 0.20203629700822273, 'support': 534471}, 'accuracy': 0.35979179973117, 'macro avg': {'precision': 0.372754159684666, 'recall': 0.36195650672731206, 'f1-score': 0.3383526582421374, 'support': 1573485}, 'weighted avg': {'precision': 0.3730706176021594, 'recall': 0.35979179973117, 'f1-score': 0.33705779131110564, 'support': 1573485}}
[[240584 233389  45639]
 [206071 253650  59681]
 [185225 277353  71893]]
Evaluating performance on  val set...
2174/2174 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2346249
{'0': {'precision': 0.37717151310194486, 'recall': 0.5363546551900344, 'f1-score': 0.44289414770795976, 'support': 176126}, '1': {'precision': 0.3767136595374285, 'recall': 0.4853583927024767, 'f1-score': 0.42418991736730527, 'support': 199739}, '2': {'precision': 0.37646044229071274, 'recall': 0.10149524742718903, 'f1-score': 0.15988488706723641, 'support': 180639}, 'accuracy': 0.37689756048474043, 'macro avg': {'precision': 0.376781871643362, 'recall': 0.3744027651065667, 'f1-score': 0.34232298404750044, 'support': 556504}, 'weighted avg': {'precision': 0.37677637068896475, 'recall': 0.37689756048474043, 'f1-score': 0.34431718492441893, 'support': 556504}}
[[94466 70938 10722]
 [83149 96945 19645]
 [72844 89461 18334]]
training model: results/universal/W2/deepLOB_L2/h100
Epoch 1/50
9940/9940 - 463s - loss: 3.1875 - accuracy100: 0.4227 - val_loss: 3.5296 - val_accuracy100: 0.3633 - 463s/epoch - 47ms/step
Epoch 2/50
9940/9940 - 464s - loss: 3.1561 - accuracy100: 0.4356 - val_loss: 3.4848 - val_accuracy100: 0.3680 - 464s/epoch - 47ms/step
Epoch 3/50
9940/9940 - 459s - loss: 3.1390 - accuracy100: 0.4440 - val_loss: 3.5070 - val_accuracy100: 0.3634 - 459s/epoch - 46ms/step
Epoch 4/50
9940/9940 - 468s - loss: 3.1272 - accuracy100: 0.4486 - val_loss: 3.5035 - val_accuracy100: 0.3654 - 468s/epoch - 47ms/step
Epoch 5/50
9940/9940 - 472s - loss: 3.1175 - accuracy100: 0.4518 - val_loss: 3.5385 - val_accuracy100: 0.3614 - 472s/epoch - 47ms/step
Epoch 6/50
9940/9940 - 460s - loss: 3.1088 - accuracy100: 0.4542 - val_loss: 3.4925 - val_accuracy100: 0.3740 - 460s/epoch - 46ms/step
Epoch 7/50
9940/9940 - 462s - loss: 3.1013 - accuracy100: 0.4564 - val_loss: 3.5011 - val_accuracy100: 0.3769 - 462s/epoch - 46ms/step
Epoch 8/50
9940/9940 - 459s - loss: 3.0958 - accuracy100: 0.4579 - val_loss: 3.4853 - val_accuracy100: 0.3825 - 459s/epoch - 46ms/step
Epoch 9/50
9940/9940 - 463s - loss: 3.0908 - accuracy100: 0.4594 - val_loss: 3.4490 - val_accuracy100: 0.3840 - 463s/epoch - 47ms/step
Epoch 10/50
9940/9940 - 458s - loss: 3.0863 - accuracy100: 0.4607 - val_loss: 3.4523 - val_accuracy100: 0.3825 - 458s/epoch - 46ms/step
Epoch 11/50
9940/9940 - 462s - loss: 3.0824 - accuracy100: 0.4618 - val_loss: 3.4927 - val_accuracy100: 0.3821 - 462s/epoch - 46ms/step
Epoch 12/50
9940/9940 - 459s - loss: 3.0790 - accuracy100: 0.4632 - val_loss: 3.4996 - val_accuracy100: 0.3829 - 459s/epoch - 46ms/step
Epoch 13/50
9940/9940 - 458s - loss: 3.0754 - accuracy100: 0.4642 - val_loss: 3.4908 - val_accuracy100: 0.3814 - 458s/epoch - 46ms/step
Epoch 14/50
9940/9940 - 456s - loss: 3.0725 - accuracy100: 0.4651 - val_loss: 3.5015 - val_accuracy100: 0.3802 - 456s/epoch - 46ms/step
Epoch 15/50
9940/9940 - 455s - loss: 3.0698 - accuracy100: 0.4657 - val_loss: 3.5334 - val_accuracy100: 0.3782 - 455s/epoch - 46ms/step
Epoch 16/50
9940/9940 - 454s - loss: 3.0672 - accuracy100: 0.4666 - val_loss: 3.5496 - val_accuracy100: 0.3726 - 454s/epoch - 46ms/step
Epoch 17/50
9940/9940 - 455s - loss: 3.0648 - accuracy100: 0.4672 - val_loss: 3.5467 - val_accuracy100: 0.3744 - 455s/epoch - 46ms/step
Epoch 18/50
9940/9940 - 454s - loss: 3.0622 - accuracy100: 0.4677 - val_loss: 3.5195 - val_accuracy100: 0.3766 - 454s/epoch - 46ms/step
Epoch 19/50
9940/9940 - 460s - loss: 3.0595 - accuracy100: 0.4684 - val_loss: 3.5404 - val_accuracy100: 0.3706 - 460s/epoch - 46ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 460s - 460s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1390544
{'0': {'precision': 0.38121556602738, 'recall': 0.3160724153896705, 'f1-score': 0.34560103701643435, 'support': 2142528}, '1': {'precision': 0.3880782437409731, 'recall': 0.6129534334684789, 'f1-score': 0.4752574716088128, 'support': 2385576}, '2': {'precision': 0.3757101910503177, 'recall': 0.20158209302378613, 'f1-score': 0.2623850994432059, 'support': 2192665}, 'accuracy': 0.3840993493452907, 'macro avg': {'precision': 0.3816680002728903, 'recall': 0.37686931396064516, 'f1-score': 0.36108120268948435, 'support': 6720769}, 'weighted avg': {'precision': 0.38185537320200574, 'recall': 0.3840993493452907, 'f1-score': 0.3644739673091054, 'support': 6720769}}
[[ 677194 1097653  367681]
 [ 556568 1462247  366761]
 [ 542645 1208018  442002]]
Evaluating performance on  train set...
9940/9940 - 184s - 184s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1572893
{'0': {'precision': 0.3931757181024612, 'recall': 0.3064154953481092, 'f1-score': 0.3444157962676481, 'support': 833747}, '1': {'precision': 0.3651550244406247, 'recall': 0.6328548503997906, 'f1-score': 0.463101887447868, 'support': 863702}, '2': {'precision': 0.39953849603111624, 'recall': 0.18743404142169173, 'f1-score': 0.2551639480089901, 'support': 846175}, 'accuracy': 0.37767885505090376, 'macro avg': {'precision': 0.3859564128580673, 'recall': 0.37556812905653053, 'f1-score': 0.3542272105748354, 'support': 2543624}, 'weighted avg': {'precision': 0.38577780648370946, 'recall': 0.37767885505090376, 'f1-score': 0.3550253563379527, 'support': 2543624}}
[[255473 459154 119120]
 [197863 546598 119241]
 [196432 491141 158602]]
Evaluating performance on  val set...
3393/3393 - 62s - 62s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1477492
{'0': {'precision': 0.4051729189372898, 'recall': 0.360432022184923, 'f1-score': 0.3814951724137931, 'support': 287763}, '1': {'precision': 0.36746852945778063, 'recall': 0.602445052183528, 'f1-score': 0.45649344765411703, 'support': 288501}, '2': {'precision': 0.40104803116778565, 'recall': 0.19118780904863564, 'f1-score': 0.25893567796983813, 'support': 291823}, 'accuracy': 0.38396842712769574, 'macro avg': {'precision': 0.391229826520952, 'recall': 0.3846882944723622, 'f1-score': 0.3656414326792494, 'support': 868087}, 'weighted avg': {'precision': 0.3912555452261435, 'recall': 0.38396842712769574, 'f1-score': 0.36521961254247887, 'support': 868087}}
[[103719 142813  41231]
 [ 72601 173806  42094]
 [ 79667 156363  55793]]
testing model out of sample: results/universal/W2/deepLOB_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 257s - 257s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1375709
{'0': {'precision': 0.39846864927528464, 'recall': 0.372425493137258, 'f1-score': 0.3850071625701082, 'support': 1277332}, '1': {'precision': 0.3447320921118983, 'recall': 0.4972862456280456, 'f1-score': 0.40718953531098406, 'support': 1081896}, '2': {'precision': 0.4181664909045864, 'recall': 0.29174572946183763, 'f1-score': 0.3436996418021528, 'support': 1307505}, 'accuracy': 0.38049729827614936, 'macro avg': {'precision': 0.3871224107639231, 'recall': 0.387152489409047, 'f1-score': 0.37863211322774837, 'support': 3666733}, 'weighted avg': {'precision': 0.3896372618169345, 'recall': 0.38049729827614936, 'f1-score': 0.3768225552908646, 'support': 3666733}}
[[475711 491192 310429]
 [323554 538012 220330]
 [394583 531463 381459]]
Evaluating performance on  train set...
5373/5373 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1384575
{'0': {'precision': 0.3918845105340739, 'recall': 0.3435164739062944, 'f1-score': 0.36610988585935195, 'support': 457390}, '1': {'precision': 0.37817098687509726, 'recall': 0.5709800593975393, 'f1-score': 0.4549920550503093, 'support': 459615}, '2': {'precision': 0.3897045431007082, 'recall': 0.23831207262927318, 'f1-score': 0.2957606377067709, 'support': 457887}, 'accuracy': 0.38451892948682515, 'macro avg': {'precision': 0.3865866801699598, 'recall': 0.38426953531103564, 'f1-score': 0.3722875262054774, 'support': 1374892}, 'weighted avg': {'precision': 0.3865741880326104, 'recall': 0.38451892948682515, 'f1-score': 0.37239370451846193, 'support': 1374892}}
[[157121 209905  90364]
 [116661 262431  80523]
 [127155 221612 109120]]
Evaluating performance on  val set...
1685/1685 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1307738
{'0': {'precision': 0.4016466953987195, 'recall': 0.4413435348544367, 'f1-score': 0.420560442928598, 'support': 146122}, '1': {'precision': 0.37711478988539204, 'recall': 0.4913239582285936, 'f1-score': 0.42670949833923305, 'support': 139234}, '2': {'precision': 0.4092348969077976, 'recall': 0.24981419802361748, 'f1-score': 0.3102430103024062, 'support': 145316}, 'accuracy': 0.39287671360106996, 'macro avg': {'precision': 0.39599879406396976, 'recall': 0.3941605637022159, 'f1-score': 0.38583765052341246, 'support': 430672}, 'weighted avg': {'precision': 0.39627604617669104, 'recall': 0.39287671360106996, 'f1-score': 0.3853254370344063, 'support': 430672}}
[[64490 53180 28452]
 [46872 68409 23953]
 [49202 59812 36302]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1888088
{'0': {'precision': 0.28482155256214414, 'recall': 0.44443842517978793, 'f1-score': 0.34716190697846633, 'support': 73837}, '1': {'precision': 0.37622665117526144, 'recall': 0.2162850918656747, 'f1-score': 0.274668702409615, 'support': 97316}, '2': {'precision': 0.36212408095015614, 'recall': 0.36208846598313293, 'f1-score': 0.3621062725909169, 'support': 81342}, 'accuracy': 0.32997485098714824, 'macro avg': {'precision': 0.3410574282291872, 'recall': 0.3409373276761985, 'f1-score': 0.3279789606596661, 'support': 252495}, 'weighted avg': {'precision': 0.3449539149486144, 'recall': 0.32997485098714824, 'f1-score': 0.32403612584151553, 'support': 252495}}
[[32816 16508 24513]
 [48900 21048 27368]
 [33500 18389 29453]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1845491
{'0': {'precision': 0.3503035964502569, 'recall': 0.34326688364524005, 'f1-score': 0.3467495440885624, 'support': 19664}, '1': {'precision': 0.3381947893619903, 'recall': 0.37349157275356537, 'f1-score': 0.3549678917561195, 'support': 20054}, '2': {'precision': 0.3551221042723422, 'recall': 0.32616108736371935, 'f1-score': 0.34002603645103147, 'support': 20821}, 'accuracy': 0.34739589355621997, 'macro avg': {'precision': 0.3478734966948631, 'recall': 0.34763984792084157, 'f1-score': 0.3472478240985711, 'support': 60539}, 'weighted avg': {'precision': 0.3479496780508043, 'recall': 0.34739589355621997, 'f1-score': 0.34715953750774936, 'support': 60539}}
[[6750 7008 5906]
 [6138 7490 6426]
 [6381 7649 6791]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1834786
{'0': {'precision': 0.35668789808917195, 'recall': 0.4149956408020924, 'f1-score': 0.38363892806770095, 'support': 6882}, '1': {'precision': 0.36215060332976934, 'recall': 0.3160069305611089, 'f1-score': 0.33750889679715296, 'support': 7503}, '2': {'precision': 0.35608856088560886, 'recall': 0.34774774774774775, 'f1-score': 0.35186873290793075, 'support': 7215}, 'accuracy': 0.35814814814814816, 'macro avg': {'precision': 0.3583090207681834, 'recall': 0.3595834397036497, 'f1-score': 0.3576721859242616, 'support': 21600}, 'weighted avg': {'precision': 0.3583852341769726, 'recall': 0.35814814814814816, 'f1-score': 0.3570030214611888, 'support': 21600}}
[[2856 2064 1962]
 [2557 2371 2575]
 [2594 2112 2509]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1031722
{'0': {'precision': 0.40404458874875954, 'recall': 0.39999809238575773, 'f1-score': 0.40201115818938243, 'support': 104843}, '1': {'precision': 0.3843073002002549, 'recall': 0.5530465624779581, 'f1-score': 0.45348899657524344, 'support': 99243}, '2': {'precision': 0.42244479406641566, 'recall': 0.26446404544775004, 'f1-score': 0.325287586329982, 'support': 113713}, 'accuracy': 0.3992964106243254, 'macro avg': {'precision': 0.40359889433847673, 'recall': 0.4058362334371553, 'f1-score': 0.3935959136982026, 'support': 317799}, 'weighted avg': {'precision': 0.4044648380883339, 'recall': 0.3992964106243254, 'f1-score': 0.39063399082283945, 'support': 317799}}
[[41937 39851 23055]
 [26297 54886 18060]
 [35559 48081 30073]]
Evaluating performance on  train set...
528/528 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.080465
{'0': {'precision': 0.40440819086663427, 'recall': 0.46121032463307066, 'f1-score': 0.4309455716441102, 'support': 41493}, '1': {'precision': 0.469318020027526, 'recall': 0.5803517283201941, 'f1-score': 0.5189623202602947, 'support': 51119}, '2': {'precision': 0.4127563576702215, 'recall': 0.23788473358233653, 'f1-score': 0.3018205812663088, 'support': 42302}, 'accuracy': 0.43632981010124966, 'macro avg': {'precision': 0.4288275228547939, 'recall': 0.42648226217853374, 'f1-score': 0.4172428243902379, 'support': 134914}, 'weighted avg': {'precision': 0.4316201163080337, 'recall': 0.43632981010124966, 'f1-score': 0.42380830515989787, 'support': 134914}}
[[19137 15680  6676]
 [13811 29667  7641]
 [14373 17866 10063]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946124
{'0': {'precision': 0.44087228413372886, 'recall': 0.39905660377358493, 'f1-score': 0.41892355159410355, 'support': 13780}, '1': {'precision': 0.42289488739793, 'recall': 0.5669758036399135, 'f1-score': 0.48444947569113445, 'support': 14341}, '2': {'precision': 0.40708263069139966, 'recall': 0.2902837902837903, 'f1-score': 0.3389021479713604, 'support': 12474}, 'accuracy': 0.42495381204581845, 'macro avg': {'precision': 0.42361660074101953, 'recall': 0.41877206589909627, 'f1-score': 0.41409172508553277, 'support': 40595}, 'weighted avg': {'precision': 0.42413854885530283, 'recall': 0.42495381204581845, 'f1-score': 0.4174829872065046, 'support': 40595}}
[[5499 5832 2449]
 [3385 8131 2825]
 [3589 5264 3621]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1465156
{'0': {'precision': 0.36478729325369463, 'recall': 0.48121157660570063, 'f1-score': 0.41498842319141904, 'support': 91253}, '1': {'precision': 0.3354832372970141, 'recall': 0.3824268511146497, 'f1-score': 0.35742023997767647, 'support': 80384}, '2': {'precision': 0.4047006623368272, 'recall': 0.24541803150834504, 'f1-score': 0.3055467896589392, 'support': 102576}, 'accuracy': 0.36404911510395205, 'macro avg': {'precision': 0.36832373096251203, 'recall': 0.3696854864095651, 'f1-score': 0.3593184842760116, 'support': 274213}, 'weighted avg': {'precision': 0.3711275342818356, 'recall': 0.36404911510395205, 'f1-score': 0.3571733457126666, 'support': 274213}}
[[43912 27903 19438]
 [32051 30741 17592]
 [44414 32988 25174]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1759245
{'0': {'precision': 0.36715220439320767, 'recall': 0.3815054633751518, 'f1-score': 0.3741912435994126, 'support': 24710}, '1': {'precision': 0.3402869079966109, 'recall': 0.4821177249772332, 'f1-score': 0.398972338785647, 'support': 24158}, '2': {'precision': 0.35429833244498593, 'recall': 0.19252730883813307, 'f1-score': 0.24948392804482455, 'support': 24168}, 'accuracy': 0.35225094473958046, 'macro avg': {'precision': 0.3539124816116015, 'recall': 0.3520501657301727, 'f1-score': 0.3408825034766281, 'support': 73036}, 'weighted avg': {'precision': 0.35401259916299777, 'recall': 0.35225094473958046, 'f1-score': 0.3411217339765659, 'support': 73036}}
[[ 9427 10927  4356]
 [ 8387 11647  4124]
 [ 7862 11653  4653]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1828734
{'0': {'precision': 0.36270535523789205, 'recall': 0.35778175313059035, 'f1-score': 0.36022673094241675, 'support': 9503}, '1': {'precision': 0.3767291730710114, 'recall': 0.4703963151329047, 'f1-score': 0.4183843297913199, 'support': 10421}, '2': {'precision': 0.3797655934258386, 'recall': 0.28517956499747094, 'f1-score': 0.32574532008319856, 'support': 9885}, 'accuracy': 0.373075245731155, 'macro avg': {'precision': 0.37306670724491403, 'recall': 0.3711192110869887, 'f1-score': 0.3681187936056451, 'support': 29809}, 'weighted avg': {'precision': 0.3732653424943176, 'recall': 0.373075245731155, 'f1-score': 0.3691237617472424, 'support': 29809}}
[[3400 3753 2350]
 [3265 4902 2254]
 [2709 4357 2819]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1656581
{'0': {'precision': 0.3598004238311113, 'recall': 0.36561631139944395, 'f1-score': 0.36268505374163457, 'support': 73372}, '1': {'precision': 0.315461528944675, 'recall': 0.42934774289344374, 'f1-score': 0.3636976620547466, 'support': 65327}, '2': {'precision': 0.37837981407702526, 'recall': 0.26301926272385995, 'f1-score': 0.3103252977054894, 'support': 81245}, 'accuracy': 0.3466473284108682, 'macro avg': {'precision': 0.35121392228427056, 'recall': 0.35266110567224923, 'f1-score': 0.3455693378339568, 'support': 219944}, 'weighted avg': {'precision': 0.3534940711880888, 'recall': 0.3466473284108682, 'f1-score': 0.34364467202680743, 'support': 219944}}
[[26826 28408 18138]
 [20311 28048 16968]
 [27421 32455 21369]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1899534
{'0': {'precision': 0.35864057672502575, 'recall': 0.31333453302141445, 'f1-score': 0.33446023818670767, 'support': 27785}, '1': {'precision': 0.3307409166468772, 'recall': 0.4144318393156035, 'f1-score': 0.36788668218513193, 'support': 26885}, '2': {'precision': 0.33972764450440573, 'recall': 0.2983118613949356, 'f1-score': 0.31767558297687803, 'support': 27012}, 'accuracy': 0.3416419774246468, 'macro avg': {'precision': 0.3430363792921029, 'recall': 0.3420260779106512, 'f1-score': 0.3400075011162392, 'support': 81682}, 'weighted avg': {'precision': 0.34320316718137583, 'recall': 0.3416419774246468, 'f1-score': 0.33991165759820247, 'support': 81682}}
[[ 8706 11321  7758]
 [ 7840 11142  7903]
 [ 7729 11225  8058]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1808379
{'0': {'precision': 0.363598615916955, 'recall': 0.3111821843165127, 'f1-score': 0.33535456692410803, 'support': 8442}, '1': {'precision': 0.33491399349139933, 'recall': 0.44066552483484217, 'f1-score': 0.3805800623382112, 'support': 8174}, '2': {'precision': 0.33190087380031513, 'recall': 0.27765128819652485, 'f1-score': 0.3023619992170168, 'support': 8345}, 'accuracy': 0.3423741036016185, 'macro avg': {'precision': 0.3434711610695565, 'recall': 0.34316633244929323, 'f1-score': 0.339432209493112, 'support': 24961}, 'weighted avg': {'precision': 0.34360800008947007, 'recall': 0.3423741036016185, 'f1-score': 0.33913447245670697, 'support': 24961}}
[[2627 3488 2327]
 [2235 3602 2337]
 [2363 3665 2317]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 35s - 35s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.213403
{'0': {'precision': 0.36956370419868584, 'recall': 0.3246841403603185, 'f1-score': 0.3456733054240753, 'support': 163522}, '1': {'precision': 0.3406423512331025, 'recall': 0.5649183314895555, 'f1-score': 0.4250076496579073, 'support': 153670}, '2': {'precision': 0.3979542719614922, 'recall': 0.21060401674318432, 'f1-score': 0.2754403964609275, 'support': 172727}, 'accuracy': 0.359816622747842, 'macro avg': {'precision': 0.3693867757977602, 'recall': 0.36673549619768614, 'f1-score': 0.3487071171809701, 'support': 489919}, 'weighted avg': {'precision': 0.3705015598191967, 'recall': 0.359816622747842, 'f1-score': 0.3457961604509988, 'support': 489919}}
[[53093 80775 29654]
 [41480 86811 25379]
 [49091 87259 36377]]
Evaluating performance on  train set...
716/716 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.162335
{'0': {'precision': 0.36882078614257163, 'recall': 0.4065406834426711, 'f1-score': 0.38676323327356144, 'support': 61278}, '1': {'precision': 0.36828478964401296, 'recall': 0.4990984844793139, 'f1-score': 0.4238273571827606, 'support': 61563}, '2': {'precision': 0.36679332253643954, 'recall': 0.1954948374887952, 'f1-score': 0.2550514347590688, 'support': 60242}, 'accuracy': 0.3682209708165149, 'macro avg': {'precision': 0.367966299441008, 'recall': 0.36704466847026, 'f1-score': 0.35521400840513023, 'support': 183083}, 'weighted avg': {'precision': 0.3679734326744649, 'recall': 0.3682209708165149, 'f1-score': 0.35588760033173705, 'support': 183083}}
[[24912 25807 10559]
 [21065 30726  9772]
 [21568 26897 11777]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1632007
{'0': {'precision': 0.3809283806259765, 'recall': 0.38836647654282924, 'f1-score': 0.3846114701541906, 'support': 19461}, '1': {'precision': 0.3105043495750993, 'recall': 0.3897866431006186, 'f1-score': 0.3456575890733018, 'support': 15842}, '2': {'precision': 0.380678011523516, 'recall': 0.2936282362668596, 'f1-score': 0.33153426495901034, 'support': 19351}, 'accuracy': 0.35523474951513156, 'macro avg': {'precision': 0.3573702472415306, 'recall': 0.35726045197010253, 'f1-score': 0.35393444139550095, 'support': 54654}, 'weighted avg': {'precision': 0.360426635238453, 'recall': 0.35523474951513156, 'f1-score': 0.3545275900755985, 'support': 54654}}
[[7558 6641 5262]
 [5685 6175 3982]
 [6598 7071 5682]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/EXC
Evaluating performance on  test set...
4918/4918 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978757
{'0': {'precision': 0.40924552408449066, 'recall': 0.4217530865403876, 'f1-score': 0.4154051781282369, 'support': 409358}, '1': {'precision': 0.40019172801625635, 'recall': 0.5529061172333708, 'f1-score': 0.4643142476697736, 'support': 428854}, '2': {'precision': 0.4056998167419334, 'recall': 0.23578847767737213, 'f1-score': 0.29824189471816637, 'support': 420627}, 'accuracy': 0.4042955453397932, 'macro avg': {'precision': 0.40504568961422677, 'recall': 0.40348256048371023, 'f1-score': 0.3926537735053923, 'support': 1258839}, 'weighted avg': {'precision': 0.40497637060146036, 'recall': 0.4042955453397932, 'f1-score': 0.39291843415084055, 'support': 1258839}}
[[172648 155974  80736]
 [127189 237116  64549]
 [122032 199416  99179]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0270411
{'0': {'precision': 0.45964531657094154, 'recall': 0.42913335985821244, 'f1-score': 0.44386559730633435, 'support': 110588}, '1': {'precision': 0.4835059517975191, 'recall': 0.6424147710829426, 'f1-score': 0.5517464223353156, 'support': 138216}, '2': {'precision': 0.4900611726845237, 'recall': 0.3206596717978507, 'f1-score': 0.38766205621423516, 'support': 110176}, 'accuracy': 0.4779597749178227, 'macro avg': {'precision': 0.4777374803509948, 'recall': 0.46406926757966865, 'f1-score': 0.4610913586186283, 'support': 358980}, 'weighted avg': {'precision': 0.4781672925073354, 'recall': 0.4779597749178227, 'f1-score': 0.4681526739369058, 'support': 358980}}
[[47457 45811 17320]
 [29982 88792 19442]
 [25808 49039 35329]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0316806
{'0': {'precision': 0.4644448156810335, 'recall': 0.4274329933890227, 'f1-score': 0.4451709321875583, 'support': 39026}, '1': {'precision': 0.4671813983345518, 'recall': 0.59613196814562, 'f1-score': 0.5238376103407943, 'support': 43950}, '2': {'precision': 0.48779296875, 'recall': 0.37706650562391486, 'f1-score': 0.4253416783752714, 'support': 39741}, 'accuracy': 0.4715402104027967, 'macro avg': {'precision': 0.47313972758852846, 'recall': 0.4668771557195192, 'f1-score': 0.4647834069678747, 'support': 122717}, 'weighted avg': {'precision': 0.4729860264239292, 'recall': 0.4715402104027967, 'f1-score': 0.4669231436096158, 'support': 122717}}
[[16681 14412  7933]
 [ 9948 26200  7802]
 [ 9287 15469 14985]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/AAL
Evaluating performance on  test set...
4856/4856 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0976199
{'0': {'precision': 0.47012206086119546, 'recall': 0.3712542964655176, 'f1-score': 0.41487934249183833, 'support': 478882}, '1': {'precision': 0.3232960702953381, 'recall': 0.543373240915774, 'f1-score': 0.4053920710454697, 'support': 304704}, '2': {'precision': 0.4741440920228696, 'recall': 0.3639888617714486, 'f1-score': 0.4118276643097224, 'support': 459319}, 'accuracy': 0.41076510272305605, 'macro avg': {'precision': 0.4225207410598011, 'recall': 0.4262054663842467, 'f1-score': 0.4106996926156768, 'support': 1242905}, 'weighted avg': {'precision': 0.43561333227917987, 'recall': 0.41076510272305605, 'f1-score': 0.41142573716421826, 'support': 1242905}}
[[177787 175600 125495]
 [ 79210 165568  59926]
 [121175 170957 167187]]
Evaluating performance on  train set...
2076/2076 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1258193
{'0': {'precision': 0.3946805830484074, 'recall': 0.31270531070353136, 'f1-score': 0.34894310288319874, 'support': 175344}, '1': {'precision': 0.3794982416705942, 'recall': 0.5846635909695148, 'f1-score': 0.46025220503530695, 'support': 179038}, '2': {'precision': 0.38784449873558785, 'recall': 0.2555753892039677, 'f1-score': 0.3081145316548795, 'support': 177028}, 'accuracy': 0.3852994862723697, 'macro avg': {'precision': 0.3873411078181965, 'recall': 0.38431476362567124, 'f1-score': 0.37243661319112836, 'support': 531410}, 'weighted avg': {'precision': 0.3872881847696194, 'recall': 0.3852994862723697, 'f1-score': 0.37284321527043696, 'support': 531410}}
[[ 54831  82650  37863]
 [ 40813 104677  33548]
 [ 43281  88503  45244]]
Evaluating performance on  val set...
588/588 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894938
{'0': {'precision': 0.4262620158259523, 'recall': 0.44627886744701045, 'f1-score': 0.4360408395877404, 'support': 50576}, '1': {'precision': 0.39694926755867643, 'recall': 0.5386016533557517, 'f1-score': 0.45705161958792656, 'support': 49959}, '2': {'precision': 0.4252671445962397, 'recall': 0.25265695630336515, 'f1-score': 0.31698740973193695, 'support': 49775}, 'accuracy': 0.4128467833144834, 'macro avg': {'precision': 0.41615947599362285, 'recall': 0.4125124923687091, 'f1-score': 0.4033599563025347, 'support': 150310}, 'weighted avg': {'precision': 0.41618979637186554, 'recall': 0.4128467833144834, 'f1-score': 0.40359983823691004, 'support': 150310}}
[[22571 18939  9066]
 [15121 26908  7930]
 [15259 21940 12576]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/WBA
Evaluating performance on  test set...
4353/4353 - 81s - 81s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1148505
{'0': {'precision': 0.4536122281244656, 'recall': 0.2191352267458283, 'f1-score': 0.2955118380459723, 'support': 375266}, '1': {'precision': 0.40267840056135573, 'recall': 0.7905123181240656, 'f1-score': 0.5335647200423328, 'support': 383297}, '2': {'precision': 0.46131263951433776, 'recall': 0.23412467495958958, 'f1-score': 0.3106093663172106, 'support': 355725}, 'accuracy': 0.42046490673865283, 'macro avg': {'precision': 0.43920108940005304, 'recall': 0.41459073994316115, 'f1-score': 0.3798953081351719, 'support': 1114288}, 'weighted avg': {'precision': 0.43855009476056406, 'recall': 0.42046490673865283, 'f1-score': 0.38221789945455364, 'support': 1114288}}
[[ 82234 233924  59108]
 [ 42151 303001  38145]
 [ 56902 215539  83284]]
Evaluating performance on  train set...
1542/1542 - 29s - 29s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1530021
{'0': {'precision': 0.43172274286884826, 'recall': 0.24984070534192784, 'f1-score': 0.3165132017383306, 'support': 134970}, '1': {'precision': 0.3647353327946512, 'recall': 0.7178471756653518, 'f1-score': 0.4837030461252384, 'support': 128278}, '2': {'precision': 0.4411364808476722, 'recall': 0.21495640254350226, 'f1-score': 0.28906001986666807, 'support': 131315}, 'accuracy': 0.3903863261380312, 'macro avg': {'precision': 0.41253151883705724, 'recall': 0.394214761183594, 'f1-score': 0.36309208924341235, 'support': 394563}, 'weighted avg': {'precision': 0.4130771881999904, 'recall': 0.3903863261380312, 'f1-score': 0.3617322523862281, 'support': 394563}}
[[33721 81151 20098]
 [20532 92084 15662]
 [23855 79233 28227]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1438446
{'0': {'precision': 0.4242727441171021, 'recall': 0.2771282647108658, 'f1-score': 0.3352660400011714, 'support': 41313}, '1': {'precision': 0.3709643769884734, 'recall': 0.6977143417696684, 'f1-score': 0.4843872373752852, 'support': 40776}, '2': {'precision': 0.4217898436306219, 'recall': 0.20089274884160985, 'f1-score': 0.27215959509646037, 'support': 41221}, 'accuracy': 0.39072256913470116, 'macro avg': {'precision': 0.40567565491206575, 'recall': 0.3919117851073814, 'f1-score': 0.36393762415763903, 'support': 123310}, 'weighted avg': {'precision': 0.4058147957026169, 'recall': 0.39072256913470116, 'f1-score': 0.3634815551962876, 'support': 123310}}
[[11449 23422  6442]
 [ 7416 28450  4910]
 [ 8120 24820  8281]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 100s - 100s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1356648
{'0': {'precision': 0.3855494420992951, 'recall': 0.3574955623001971, 'f1-score': 0.3709929110127235, 'support': 469838}, '1': {'precision': 0.3609726582991478, 'recall': 0.5232379738998972, 'f1-score': 0.42721631132611937, 'support': 445822}, '2': {'precision': 0.37974800274190723, 'recall': 0.2513320353744652, 'f1-score': 0.30247459179151437, 'support': 491541}, 'accuracy': 0.372921849828134, 'macro avg': {'precision': 0.37542336771345003, 'recall': 0.37735519052485317, 'f1-score': 0.3668946047101191, 'support': 1407201}, 'weighted avg': {'precision': 0.37573668883198, 'recall': 0.372921849828134, 'f1-score': 0.3648715862170521, 'support': 1407201}}
[[167965 190873 111000]
 [121770 233271  90781]
 [145916 222085 123540]]
Evaluating performance on  train set...
2058/2058 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1329054
{'0': {'precision': 0.4095410684552269, 'recall': 0.3472000181412066, 'f1-score': 0.37580268579510767, 'support': 176394}, '1': {'precision': 0.3866137949332052, 'recall': 0.6168808137206668, 'f1-score': 0.4753281788607851, 'support': 174802}, '2': {'precision': 0.40936492929539375, 'recall': 0.22928006923725147, 'f1-score': 0.2939323710286684, 'support': 175628}, 'accuracy': 0.3973698996249222, 'macro avg': {'precision': 0.4018399308946086, 'recall': 0.3977869670330416, 'f1-score': 0.38168774522818705, 'support': 526824}, 'weighted avg': {'precision': 0.4018750011641399, 'recall': 0.3973698996249222, 'f1-score': 0.38153237084564895, 'support': 526824}}
[[ 61244  83392  31758]
 [ 40629 107832  26341]
 [ 47670  87690  40268]]
Evaluating performance on  val set...
681/681 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.141192
{'0': {'precision': 0.3976682654894803, 'recall': 0.47078726968174206, 'f1-score': 0.43114966596869075, 'support': 59700}, '1': {'precision': 0.37538274769002494, 'recall': 0.501342124700499, 'f1-score': 0.429314121748789, 'support': 55509}, '2': {'precision': 0.4307661003153932, 'recall': 0.21496023015738705, 'f1-score': 0.28680131411088655, 'support': 59090}, 'accuracy': 0.3937888341298573, 'macro avg': {'precision': 0.4012723711649661, 'recall': 0.3956965415132094, 'f1-score': 0.38242170060945546, 'support': 174299}, 'weighted avg': {'precision': 0.40179166408805644, 'recall': 0.3937888341298573, 'f1-score': 0.38162882342008075, 'support': 174299}}
[[28106 21984  9610]
 [20505 27829  7175]
 [22066 24322 12702]]
testing model on single stock: results/universal/W2/deepLOB_L2/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 272s - 272s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1612669
{'0': {'precision': 0.3555655007341553, 'recall': 0.29970017521567127, 'f1-score': 0.3252514110897325, 'support': 1179689}, '1': {'precision': 0.3828743125179326, 'recall': 0.595768904535953, 'f1-score': 0.4661650043014706, 'support': 1408855}, '2': {'precision': 0.3330456266444202, 'recall': 0.16997023797339839, 'f1-score': 0.22507379348665751, 'support': 1221355}, 'accuracy': 0.36759478400870993, 'macro avg': {'precision': 0.35716181329883606, 'recall': 0.35514643924167427, 'f1-score': 0.3388300696259536, 'support': 3809899}, 'weighted avg': {'precision': 0.3584446834124271, 'recall': 0.36759478400870993, 'f1-score': 0.3452452183315307, 'support': 3809899}}
[[353553 639843 186293]
 [340070 839352 229433]
 [300717 713044 207594]]
Evaluating performance on  train set...
6147/6147 - 115s - 115s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1928734
{'0': {'precision': 0.36832650226821556, 'recall': 0.2821119613960776, 'f1-score': 0.3195054345453752, 'support': 518911}, '1': {'precision': 0.33718042169487866, 'recall': 0.6254323926626143, 'f1-score': 0.43814824559628135, 'support': 519204}, '2': {'precision': 0.3600178428886698, 'recall': 0.14321497282253395, 'f1-score': 0.20491487826389077, 'support': 535370}, 'accuracy': 0.3481386857834679, 'macro avg': {'precision': 0.35517492228392133, 'recall': 0.3502531089604086, 'f1-score': 0.32085618613518246, 'support': 1573485}, 'weighted avg': {'precision': 0.3552222295296599, 'recall': 0.3481386857834679, 'f1-score': 0.31966525554936087, 'support': 1573485}}
[[146391 305200  67320]
 [125500 324727  68977]
 [125558 333139  76673]]
Evaluating performance on  val set...
2174/2174 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1770713
{'0': {'precision': 0.38840859252115406, 'recall': 0.36533082796082117, 'f1-score': 0.37651641624930443, 'support': 185202}, '1': {'precision': 0.34666153711863806, 'recall': 0.5915756372062231, 'f1-score': 0.4371528336924328, 'support': 181260}, '2': {'precision': 0.36291394357899354, 'recall': 0.13937971606276509, 'f1-score': 0.2014074493687008, 'support': 190042}, 'accuracy': 0.36186083118899415, 'macro avg': {'precision': 0.36599469107292854, 'recall': 0.36542872707660307, 'f1-score': 0.33835889977014605, 'support': 556504}, 'weighted avg': {'precision': 0.36610484387509556, 'recall': 0.36186083118899415, 'f1-score': 0.336468004632888, 'support': 556504}}
[[ 67660  95243  22299]
 [ 49831 107229  24200]
 [ 56707 106847  26488]]
training model: results/universal/W2/deepLOB_L2/h200
Epoch 1/50
9940/9940 - 474s - loss: 3.2303 - accuracy200: 0.4070 - val_loss: 3.3673 - val_accuracy200: 0.3432 - 474s/epoch - 48ms/step
Epoch 2/50
9940/9940 - 473s - loss: 3.2086 - accuracy200: 0.4188 - val_loss: 3.3427 - val_accuracy200: 0.3653 - 473s/epoch - 48ms/step
Epoch 3/50
9940/9940 - 472s - loss: 3.1982 - accuracy200: 0.4236 - val_loss: 3.3867 - val_accuracy200: 0.3670 - 472s/epoch - 47ms/step
Epoch 4/50
9940/9940 - 472s - loss: 3.1908 - accuracy200: 0.4269 - val_loss: 3.4404 - val_accuracy200: 0.3679 - 472s/epoch - 47ms/step
Epoch 5/50
9940/9940 - 470s - loss: 3.1836 - accuracy200: 0.4298 - val_loss: 3.4801 - val_accuracy200: 0.3614 - 470s/epoch - 47ms/step
Epoch 6/50
9940/9940 - 469s - loss: 3.1779 - accuracy200: 0.4325 - val_loss: 3.4426 - val_accuracy200: 0.3599 - 469s/epoch - 47ms/step
Epoch 7/50
9940/9940 - 470s - loss: 3.1726 - accuracy200: 0.4346 - val_loss: 3.4531 - val_accuracy200: 0.3576 - 470s/epoch - 47ms/step
Epoch 8/50
9940/9940 - 471s - loss: 3.1683 - accuracy200: 0.4363 - val_loss: 3.4947 - val_accuracy200: 0.3616 - 471s/epoch - 47ms/step
Epoch 9/50
9940/9940 - 460s - loss: 3.1637 - accuracy200: 0.4384 - val_loss: 3.4935 - val_accuracy200: 0.3606 - 460s/epoch - 46ms/step
Epoch 10/50
9940/9940 - 461s - loss: 3.1604 - accuracy200: 0.4397 - val_loss: 3.5045 - val_accuracy200: 0.3630 - 461s/epoch - 46ms/step
Epoch 11/50
9940/9940 - 459s - loss: 3.1567 - accuracy200: 0.4411 - val_loss: 3.5099 - val_accuracy200: 0.3600 - 459s/epoch - 46ms/step
Epoch 12/50
9940/9940 - 456s - loss: 3.1536 - accuracy200: 0.4420 - val_loss: 3.5082 - val_accuracy200: 0.3543 - 456s/epoch - 46ms/step
testing model in sample: results/universal/W2/deepLOB_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 464s - 464s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.112451
{'0': {'precision': 0.31977870300420896, 'recall': 0.054204017498025045, 'f1-score': 0.09269567529675402, 'support': 2077263}, '1': {'precision': 0.37835651133317816, 'recall': 0.9238529378402904, 'f1-score': 0.5368503120109005, 'support': 2539008}, '2': {'precision': 0.3280050167421939, 'recall': 0.026345475262984332, 'f1-score': 0.048773450296718944, 'support': 2104498}, 'accuracy': 0.3740211871587909, 'macro avg': {'precision': 0.3420467436931937, 'recall': 0.33480081020043323, 'f1-score': 0.22610647920145785, 'support': 6720769}, 'weighted avg': {'precision': 0.3444844747363845, 'recall': 0.3740211871587909, 'f1-score': 0.24673726505920354, 'support': 6720769}}
[[ 112596 1914735   49932]
 [ 129680 2345670   63658]
 [ 109830 1939224   55444]]
Evaluating performance on  train set...
9940/9940 - 180s - 180s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1273481
{'0': {'precision': 0.34767086075035863, 'recall': 0.14013150815806993, 'f1-score': 0.19975155991383817, 'support': 845727}, '1': {'precision': 0.3346911529625777, 'recall': 0.8174778826981499, 'f1-score': 0.4749348517680817, 'support': 839049}, '2': {'precision': 0.37925976151203195, 'recall': 0.06773259063303402, 'f1-score': 0.11493819098604964, 'support': 858848}, 'accuracy': 0.33911812437687333, 'macro avg': {'precision': 0.3538739250749894, 'recall': 0.341780660496418, 'f1-score': 0.2632082008893232, 'support': 2543624}, 'weighted avg': {'precision': 0.3540552372941134, 'recall': 0.33911812437687333, 'f1-score': 0.261887502006741, 'support': 2543624}}
[[118513 677705  49509]
 [107443 685904  45702]
 [114921 685755  58172]]
Evaluating performance on  val set...
3393/3393 - 59s - 59s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115849
{'0': {'precision': 0.36651773736336807, 'recall': 0.2215015633206552, 'f1-score': 0.27612784721962835, 'support': 283691}, '1': {'precision': 0.3628766039486009, 'recall': 0.8057278433088223, 'f1-score': 0.5003913585523599, 'support': 297145}, '2': {'precision': 0.41220193690150014, 'recall': 0.0528979881706243, 'f1-score': 0.09376330550361911, 'support': 287251}, 'accuracy': 0.3656903052343832, 'macro avg': {'precision': 0.38053209273782307, 'recall': 0.36004246493336733, 'f1-score': 0.29009417042520247, 'support': 868087}, 'weighted avg': {'precision': 0.3803883372145316, 'recall': 0.3656903052343832, 'f1-score': 0.29254830289112116, 'support': 868087}}
[[ 62838 208814  12039]
 [ 48098 239418   9629]
 [ 60510 211546  15195]]
testing model out of sample: results/universal/W2/deepLOB_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 255s - 255s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.138567
{'0': {'precision': 0.34570247485132716, 'recall': 0.11790106111196547, 'f1-score': 0.17583424392704045, 'support': 1241999}, '1': {'precision': 0.31013285112534456, 'recall': 0.8476648820400712, 'f1-score': 0.4541185720707522, 'support': 1139921}, '2': {'precision': 0.3816322048257036, 'recall': 0.037866989203876364, 'f1-score': 0.06889768936703823, 'support': 1284813}, 'accuracy': 0.31672772465298127, 'macro avg': {'precision': 0.3458225102674584, 'recall': 0.3344776441186377, 'f1-score': 0.23295016845494362, 'support': 3666733}, 'weighted avg': {'precision': 0.34723419889838014, 'recall': 0.31672772465298127, 'f1-score': 0.22487754054776735, 'support': 3666733}}
[[ 146433 1055188   40378]
 [ 135196  966271   38454]
 [ 141952 1094209   48652]]
Evaluating performance on  train set...
5373/5373 - 98s - 98s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1310147
{'0': {'precision': 0.3584832774219782, 'recall': 0.0765284420871709, 'f1-score': 0.12613070179517352, 'support': 460796}, '1': {'precision': 0.3352109035535766, 'recall': 0.9138500390625854, 'f1-score': 0.4905004821702713, 'support': 456959}, '2': {'precision': 0.3620908233917368, 'recall': 0.024366874700582103, 'f1-score': 0.04566099610575938, 'support': 457137}, 'accuracy': 0.3374774164079797, 'macro avg': {'precision': 0.3519283347890972, 'recall': 0.3382484519501128, 'f1-score': 0.22076406002373472, 'support': 1374892}, 'weighted avg': {'precision': 0.35194794377500566, 'recall': 0.3374774164079797, 'f1-score': 0.22047729092412519, 'support': 1374892}}
[[ 35264 415782   9750]
 [ 29493 417592   9874]
 [ 33613 412385  11139]]
Evaluating performance on  val set...
1685/1685 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1290942
{'0': {'precision': 0.34116863905325445, 'recall': 0.1593651100761481, 'f1-score': 0.21724959730215998, 'support': 144718}, '1': {'precision': 0.3282215484644471, 'recall': 0.799417380317282, 'f1-score': 0.46537238780964213, 'support': 142460}, '2': {'precision': 0.3850646123260437, 'recall': 0.04319344362830502, 'f1-score': 0.07767403972679994, 'support': 143494}, 'accuracy': 0.33237823680202105, 'macro avg': {'precision': 0.3514849332812484, 'recall': 0.33399197800724506, 'f1-score': 0.253432008279534, 'support': 430672}, 'weighted avg': {'precision': 0.35151146668895894, 'recall': 0.33237823680202105, 'f1-score': 0.252820327874329, 'support': 430672}}
[[ 23063 117103   4552]
 [ 23229 113885   5346]
 [ 21308 115988   6198]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/LILAK
Evaluating performance on  test set...
987/987 - 18s - 18s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1309508
{'0': {'precision': 0.3027780734433209, 'recall': 0.17591619151278276, 'f1-score': 0.22253688607951433, 'support': 80851}, '1': {'precision': 0.32291155267305754, 'recall': 0.7428343854393286, 'f1-score': 0.4501444410025142, 'support': 84117}, '2': {'precision': 0.4186433624635872, 'recall': 0.057467981308624766, 'f1-score': 0.10106286793514295, 'support': 87527}, 'accuracy': 0.3237212618071645, 'macro avg': {'precision': 0.3481109961933219, 'recall': 0.325406186086912, 'f1-score': 0.2579147316723905, 'support': 252495}, 'weighted avg': {'precision': 0.34964992842834874, 'recall': 0.3237212618071645, 'f1-score': 0.25625402230532307, 'support': 252495}}
[[14223 63303  3325]
 [17972 62485  3660]
 [14780 67717  5030]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1277041
{'0': {'precision': 0.35096642929806715, 'recall': 0.13857508660942913, 'f1-score': 0.19869695115366617, 'support': 19917}, '1': {'precision': 0.3344185772844058, 'recall': 0.8602492306139953, 'f1-score': 0.4816122472037058, 'support': 19821}, '2': {'precision': 0.36492890995260663, 'recall': 0.029613960867265997, 'f1-score': 0.054782338031926725, 'support': 20801}, 'accuracy': 0.33741885396190885, 'macro avg': {'precision': 0.35010463884502646, 'recall': 0.3428127593635635, 'f1-score': 0.24503051212976623, 'support': 60539}, 'weighted avg': {'precision': 0.3503459794282691, 'recall': 0.33741885396190885, 'f1-score': 0.24187731778447494, 'support': 60539}}
[[ 2760 16619   538]
 [ 2236 17051   534]
 [ 2868 17317   616]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1204543
{'0': {'precision': 0.4302127659574468, 'recall': 0.13563187550308559, 'f1-score': 0.2062423500611995, 'support': 7454}, '1': {'precision': 0.3186104218362283, 'recall': 0.8495809439788267, 'f1-score': 0.46342637151106836, 'support': 6801}, '2': {'precision': 0.33004484304932735, 'recall': 0.05010211027910143, 'f1-score': 0.08699763593380615, 'support': 7345}, 'accuracy': 0.3313425925925926, 'macro avg': {'precision': 0.3596226769476674, 'recall': 0.3451049765870046, 'f1-score': 0.25222211916869136, 'support': 21600}, 'weighted avg': {'precision': 0.36101179669223643, 'recall': 0.3313425925925926, 'f1-score': 0.2466708734229983, 'support': 21600}}
[[1011 6118  325]
 [ 601 5778  422]
 [ 738 6239  368]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1283041
{'0': {'precision': 0.38178536720810774, 'recall': 0.08252805954024368, 'f1-score': 0.13571869216533006, 'support': 99966}, '1': {'precision': 0.34943016402150634, 'recall': 0.9548448927182388, 'f1-score': 0.5116276750881829, 'support': 107474}, '2': {'precision': 0.4950179354324432, 'recall': 0.011254179541315162, 'f1-score': 0.02200800935606195, 'support': 110359}, 'accuracy': 0.352779587097505, 'macro avg': {'precision': 0.4087444888873524, 'recall': 0.34954237726659926, 'f1-score': 0.22311812553652496, 'support': 317799}, 'weighted avg': {'precision': 0.41016459398161126, 'recall': 0.352779587097505, 'f1-score': 0.22335724605159993, 'support': 317799}}
[[  8250  90929    787]
 [  4373 102621    480]
 [  8986 100131   1242]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1276971
{'0': {'precision': 0.371765974127793, 'recall': 0.16973534083536546, 'f1-score': 0.23306249712012536, 'support': 44699}, '1': {'precision': 0.34965109371259345, 'recall': 0.8825872873769024, 'f1-score': 0.5008732321019174, 'support': 44680}, '2': {'precision': 0.44521739130434784, 'recall': 0.016866146919951686, 'f1-score': 0.032501057977147696, 'support': 45535}, 'accuracy': 0.3542182427324073, 'macro avg': {'precision': 0.38887815304824475, 'recall': 0.35639625837740646, 'f1-score': 0.2554789290663968, 'support': 134914}, 'weighted avg': {'precision': 0.38923278575729997, 'recall': 0.3542182427324073, 'f1-score': 0.25406267877370453, 'support': 134914}}
[[ 7587 36592   520]
 [ 4809 39434   437]
 [ 8012 36755   768]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189018
{'0': {'precision': 0.46258503401360546, 'recall': 0.14237471295420775, 'f1-score': 0.2177348551360843, 'support': 14806}, '1': {'precision': 0.336331040968671, 'recall': 0.870199984792031, 'f1-score': 0.485151662886576, 'support': 13151}, '2': {'precision': 0.4140159045725646, 'recall': 0.06591232789998418, 'f1-score': 0.11372013651877133, 'support': 12638}, 'accuracy': 0.3543539844808474, 'macro avg': {'precision': 0.4043106598516137, 'recall': 0.35949567521540765, 'f1-score': 0.27220221818047724, 'support': 40595}, 'weighted avg': {'precision': 0.40656377719848513, 'recall': 0.3543539844808474, 'f1-score': 0.2719844037218982, 'support': 40595}}
[[ 2108 12064   634]
 [ 1162 11444   545]
 [ 1287 10518   833]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 20s - 20s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1409835
{'0': {'precision': 0.40466382978723403, 'recall': 0.13132629950836877, 'f1-score': 0.19829844023688376, 'support': 90515}, '1': {'precision': 0.3126001368356327, 'recall': 0.8835877161846244, 'f1-score': 0.4618164952740416, 'support': 81701}, '2': {'precision': 0.36054372842347526, 'recall': 0.04914850436777552, 'f1-score': 0.0865048619080077, 'support': 101997}, 'accuracy': 0.32489342226663215, 'macro avg': {'precision': 0.359269231682114, 'recall': 0.3546875066869229, 'f1-score': 0.248873265806311, 'support': 274213}, 'weighted avg': {'precision': 0.36082267799414586, 'recall': 0.32489342226663215, 'f1-score': 0.23522987312219726, 'support': 274213}}
[[11887 73721  4907]
 [ 5527 72190  3984]
 [11961 85023  5013]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1331798
{'0': {'precision': 0.38587435477779175, 'recall': 0.12226255534724162, 'f1-score': 0.18569005210226586, 'support': 25069}, '1': {'precision': 0.3312478439489447, 'recall': 0.8927062204192021, 'f1-score': 0.48319952423431456, 'support': 23664}, '2': {'precision': 0.4336618650492798, 'recall': 0.023536188947866517, 'f1-score': 0.044649129654203416, 'support': 24303}, 'accuracy': 0.33903828249082646, 'macro avg': {'precision': 0.38359468792533874, 'recall': 0.3461683215714367, 'f1-score': 0.23784623533026128, 'support': 73036}, 'weighted avg': {'precision': 0.38407658531990985, 'recall': 0.33903828249082646, 'f1-score': 0.23515259947996367, 'support': 73036}}
[[ 3065 21636   368]
 [ 2160 21125   379]
 [ 2718 21013   572]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119017
{'0': {'precision': 0.3610321452000875, 'recall': 0.16855538540071466, 'f1-score': 0.2298162583518931, 'support': 9795}, '1': {'precision': 0.3253012048192771, 'recall': 0.7742425777687709, 'f1-score': 0.4581209904670543, 'support': 9869}, '2': {'precision': 0.42358328563251285, 'recall': 0.07294233612617053, 'f1-score': 0.12445341405987219, 'support': 10145}, 'accuracy': 0.33654265490288165, 'macro avg': {'precision': 0.3699722118839592, 'recall': 0.3385800997652187, 'f1-score': 0.2707968876262732, 'support': 29809}, 'weighted avg': {'precision': 0.37049078752518183, 'recall': 0.33654265490288165, 'f1-score': 0.2695436341746974, 'support': 29809}}
[[1651 7690  454]
 [1675 7641  553]
 [1247 8158  740]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/CHTR
Evaluating performance on  test set...
860/860 - 16s - 16s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1508334
{'0': {'precision': 0.39456887109566796, 'recall': 0.14456114132314887, 'f1-score': 0.2115976666936725, 'support': 72267}, '1': {'precision': 0.28964618942555626, 'recall': 0.85857694429123, 'f1-score': 0.4331623931623932, 'support': 63455}, '2': {'precision': 0.45085629188384213, 'recall': 0.028757331813540406, 'f1-score': 0.054066120499140564, 'support': 84222}, 'accuracy': 0.30621430909686104, 'macro avg': {'precision': 0.3783571174683555, 'recall': 0.3439651391426397, 'f1-score': 0.2329420601184021, 'support': 219944}, 'weighted avg': {'precision': 0.38585197219524175, 'recall': 0.30621430909686104, 'f1-score': 0.21519752772410208, 'support': 219944}}
[[10447 60398  1422]
 [ 7446 54481  1528]
 [ 8584 73216  2422]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1297944
{'0': {'precision': 0.34861907243355916, 'recall': 0.049115336612583514, 'f1-score': 0.08610038610038612, 'support': 27242}, '1': {'precision': 0.3307042553758427, 'recall': 0.9119700198398119, 'f1-score': 0.48539246744104186, 'support': 27218}, '2': {'precision': 0.3226848528356066, 'recall': 0.03302475938579091, 'f1-score': 0.059917355371900835, 'support': 27222}, 'accuracy': 0.33127249577630324, 'macro avg': {'precision': 0.3340027268816695, 'recall': 0.33137003861272873, 'f1-score': 0.21047006963777626, 'support': 81682}, 'weighted avg': {'precision': 0.33400646725038063, 'recall': 0.33127249577630324, 'f1-score': 0.21042615441456966, 'support': 81682}}
[[ 1338 24993   911]
 [ 1420 24822   976]
 [ 1080 25243   899]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1352978
{'0': {'precision': 0.316747572815534, 'recall': 0.030924170616113744, 'f1-score': 0.056347150259067356, 'support': 8440}, '1': {'precision': 0.32355514813117214, 'recall': 0.9553395669291339, 'f1-score': 0.4833940299436611, 'support': 8128}, '2': {'precision': 0.2826086956521739, 'recall': 0.0046467294173716195, 'f1-score': 0.009143125073262221, 'support': 8393}, 'accuracy': 0.3231040423059974, 'macro avg': {'precision': 0.30763713886629335, 'recall': 0.33030348898753975, 'f1-score': 0.1829614350919969, 'support': 24961}, 'weighted avg': {'precision': 0.3074852987132715, 'recall': 0.3231040423059974, 'f1-score': 0.17953346710101742, 'support': 24961}}
[[ 261 8133   46]
 [ 310 7765   53]
 [ 253 8101   39]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 34s - 34s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1416429
{'0': {'precision': 0.291667528385002, 'recall': 0.08703997432558369, 'f1-score': 0.13407040526280767, 'support': 162029}, '1': {'precision': 0.31768802164436544, 'recall': 0.8931952318838708, 'f1-score': 0.46867842185869374, 'support': 154862}, '2': {'precision': 0.3989292667099286, 'recall': 0.0142115726934369, 'f1-score': 0.027445421670610294, 'support': 173028}, 'accuracy': 0.3161420561358102, 'macro avg': {'precision': 0.3360949389130987, 'recall': 0.33148225963429717, 'f1-score': 0.21006474959737054, 'support': 489919}, 'weighted avg': {'precision': 0.3377748842663149, 'recall': 0.3161420561358102, 'f1-score': 0.20218158079403098, 'support': 489919}}
[[ 14103 146099   1827]
 [ 14662 138322   1878]
 [ 19588 150981   2459]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1317862
{'0': {'precision': 0.34014105201292977, 'recall': 0.14904233059713504, 'f1-score': 0.20726548335832756, 'support': 62130}, '1': {'precision': 0.3329975839208948, 'recall': 0.8392984552076592, 'f1-score': 0.4768153238501928, 'support': 60267}, '2': {'precision': 0.36035353535353537, 'recall': 0.023514484395082885, 'f1-score': 0.044148129814683044, 'support': 60686}, 'accuracy': 0.33465149686207896, 'macro avg': {'precision': 0.34449739042912, 'recall': 0.3372850900666257, 'f1-score': 0.24274297900773448, 'support': 183083}, 'weighted avg': {'precision': 0.34448934962934047, 'recall': 0.33465149686207896, 'f1-score': 0.2419274701062705, 'support': 183083}}
[[ 9260 51586  1284]
 [ 8436 50582  1249]
 [ 9528 49731  1427]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1411124
{'0': {'precision': 0.38058070558851076, 'recall': 0.06412414518674382, 'f1-score': 0.10975554855264935, 'support': 19010}, '1': {'precision': 0.308689284352868, 'recall': 0.9152340729284397, 'f1-score': 0.4616677168662046, 'support': 16811}, '2': {'precision': 0.3327114427860697, 'recall': 0.028407582435087345, 'f1-score': 0.052345775646984005, 'support': 18833}, 'accuracy': 0.3136092509239946, 'macro avg': {'precision': 0.34066047757581613, 'recall': 0.335921933516757, 'f1-score': 0.20792301368861268, 'support': 54654}, 'weighted avg': {'precision': 0.3419725797651353, 'recall': 0.3136092509239946, 'f1-score': 0.19821745817292932, 'support': 54654}}
[[ 1219 17245   546]
 [  898 15386   527]
 [ 1086 17212   535]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/EXC
Evaluating performance on  test set...
4918/4918 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1513321
{'0': {'precision': 0.29730769679232305, 'recall': 0.11822143916913946, 'f1-score': 0.16917294480216824, 'support': 431360}, '1': {'precision': 0.2931390052563849, 'recall': 0.8232820419750846, 'f1-score': 0.4323388195313824, 'support': 385705}, '2': {'precision': 0.34614437053461444, 'recall': 0.0031803591881821927, 'f1-score': 0.006302808450697907, 'support': 441774}, 'accuracy': 0.2938779303787061, 'macro avg': {'precision': 0.3121970241944408, 'recall': 0.3148946134441354, 'f1-score': 0.20260485759474953, 'support': 1258839}, 'weighted avg': {'precision': 0.31316904803498236, 'recall': 0.2938779303787061, 'f1-score': 0.19264902243870247, 'support': 1258839}}
[[ 50996 378967   1397]
 [ 66904 317544   1257]
 [ 53626 386743   1405]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1234685
{'0': {'precision': 0.37810118164612, 'recall': 0.121673786184021, 'f1-score': 0.18410286746162707, 'support': 121497}, '1': {'precision': 0.3261397548244173, 'recall': 0.8297597297390465, 'f1-score': 0.4682373137703555, 'support': 116036}, '2': {'precision': 0.399067504561119, 'recall': 0.08104769981967443, 'f1-score': 0.13473226018396847, 'support': 121447}, 'accuracy': 0.3368098501309265, 'macro avg': {'precision': 0.3677694803438854, 'recall': 0.3441604052475807, 'f1-score': 0.26235748047198365, 'support': 358980}, 'weighted avg': {'precision': 0.368398415186637, 'recall': 0.3368098501309265, 'f1-score': 0.25924329999221324, 'support': 358980}}
[[ 14783 100176   6538]
 [ 11470  96282   8284]
 [ 12845  98759   9843]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241833
{'0': {'precision': 0.37011005271432534, 'recall': 0.19163454401800464, 'f1-score': 0.25251999432113953, 'support': 41767}, '1': {'precision': 0.31621286472851373, 'recall': 0.7742714037318662, 'f1-score': 0.44903825893260285, 'support': 38533}, '2': {'precision': 0.43649851632047476, 'recall': 0.06935898342645637, 'f1-score': 0.11969811013690825, 'support': 42417}, 'accuracy': 0.33231744583065104, 'macro avg': {'precision': 0.3742738112544379, 'recall': 0.345088310392109, 'f1-score': 0.27375212113021685, 'support': 122717}, 'weighted avg': {'precision': 0.3761334978451937, 'recall': 0.33231744583065104, 'f1-score': 0.268316765989539, 'support': 122717}}
[[ 8004 32074  1689]
 [ 6589 29835  2109]
 [ 7033 32442  2942]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/AAL
Evaluating performance on  test set...
4856/4856 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1340841
{'0': {'precision': 0.35018214039578616, 'recall': 0.12302044806817868, 'f1-score': 0.18207661947413056, 'support': 433684}, '1': {'precision': 0.3102807218673717, 'recall': 0.8180474665487799, 'f1-score': 0.44991228801759614, 'support': 389074}, '2': {'precision': 0.3666738720933823, 'recall': 0.056523074066933715, 'f1-score': 0.09794746686519026, 'support': 420147}, 'accuracy': 0.31811039459974816, 'macro avg': {'precision': 0.34237891145218, 'recall': 0.3325303295612974, 'f1-score': 0.243312124785639, 'support': 1242905}, 'weighted avg': {'precision': 0.34326636411765193, 'recall': 0.31811039459974816, 'f1-score': 0.23748011678220474, 'support': 1242905}}
[[ 53352 360507  19825]
 [ 49600 318281  21193]
 [ 49403 346996  23748]]
Evaluating performance on  train set...
2076/2076 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.13088
{'0': {'precision': 0.3561914454188991, 'recall': 0.06696981293474101, 'f1-score': 0.11274224186526828, 'support': 177692}, '1': {'precision': 0.33606897600387947, 'recall': 0.9235999344932545, 'f1-score': 0.4928172500500947, 'support': 177081}, '2': {'precision': 0.37401887291648295, 'recall': 0.024009692193594775, 'f1-score': 0.04512278163169767, 'support': 176637}, 'accuracy': 0.33814380610075084, 'macro avg': {'precision': 0.35542643144642055, 'recall': 0.3381931465405301, 'f1-score': 0.21689409118235356, 'support': 531410}, 'weighted avg': {'precision': 0.3554117768097454, 'recall': 0.33814380610075084, 'f1-score': 0.21691785754261728, 'support': 531410}}
[[ 11900 161963   3829]
 [ 10260 163552   3269]
 [ 11249 161147   4241]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1265224
{'0': {'precision': 0.3317863261174272, 'recall': 0.215100664364613, 'f1-score': 0.26099527111459586, 'support': 49521}, '1': {'precision': 0.3386326665201143, 'recall': 0.743240374408955, 'f1-score': 0.4652772743747734, 'support': 51815}, '2': {'precision': 0.3515625, 'recall': 0.03215992159104831, 'f1-score': 0.05892917274666068, 'support': 48974}, 'accuracy': 0.33755571818242297, 'macro avg': {'precision': 0.34066049754584715, 'recall': 0.33016698678820544, 'f1-score': 0.26173390607867664, 'support': 150310}, 'weighted avg': {'precision': 0.3405898752338556, 'recall': 0.33755571818242297, 'f1-score': 0.265578378675336, 'support': 150310}}
[[10652 37822  1047]
 [11446 38511  1858]
 [10007 37392  1575]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/WBA
Evaluating performance on  test set...
4353/4353 - 78s - 78s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1249917
{'0': {'precision': 0.3346425136261622, 'recall': 0.0328913678869955, 'f1-score': 0.05989570257300462, 'support': 380799}, '1': {'precision': 0.34298627385336455, 'recall': 0.9591091190560866, 'f1-score': 0.5052798201348162, 'support': 382408}, '2': {'precision': 0.3179398456215065, 'recall': 0.006804697491462084, 'f1-score': 0.013324223706409738, 'support': 351081}, 'accuracy': 0.34253711787257873, 'macro avg': {'precision': 0.3318562110336778, 'recall': 0.3329350614781814, 'f1-score': 0.1928332488047435, 'support': 1114288}, 'weighted avg': {'precision': 0.33224343123024797, 'recall': 0.34253711787257873, 'f1-score': 0.19807190859569737, 'support': 1114288}}
[[ 12525 365554   2720]
 [ 13232 366771   2405]
 [ 11671 337021   2389]]
Evaluating performance on  train set...
1542/1542 - 27s - 27s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.126323
{'0': {'precision': 0.3407979453259684, 'recall': 0.1449771006076571, 'f1-score': 0.20341883931665214, 'support': 133628}, '1': {'precision': 0.33270092625168923, 'recall': 0.7682507383814072, 'f1-score': 0.4643214420102975, 'support': 131707}, '2': {'precision': 0.36373109443848994, 'recall': 0.09453833534528121, 'f1-score': 0.1500712460691824, 'support': 129228}, 'accuracy': 0.3365089985629671, 'macro avg': {'precision': 0.3457433220053825, 'recall': 0.33592205811144854, 'f1-score': 0.27260384246537733, 'support': 394563}, 'weighted avg': {'precision': 0.3456062291799964, 'recall': 0.3365089985629671, 'f1-score': 0.27303686308671654, 'support': 394563}}
[[ 19373 104192  10063]
 [ 19215 101184  11308]
 [ 18258  98753  12217]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1369544
{'0': {'precision': 0.3250420915530989, 'recall': 0.2487056707420821, 'f1-score': 0.28179564858165795, 'support': 41141}, '1': {'precision': 0.3355291907009264, 'recall': 0.7478754230890983, 'f1-score': 0.46323235522574907, 'support': 41067}, '2': {'precision': 0.3423728813559322, 'recall': 0.002457301347866284, 'f1-score': 0.004879580645940527, 'support': 41102}, 'accuracy': 0.33286838050441975, 'macro avg': {'precision': 0.3343147212033191, 'recall': 0.3330127983930155, 'f1-score': 0.24996919481778254, 'support': 123310}, 'weighted avg': {'precision': 0.3343114437806546, 'recall': 0.33286838050441975, 'f1-score': 0.24991872868431816, 'support': 123310}}
[[10232 30811    98]
 [10258 30713    96]
 [10989 30012   101]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1422508
{'0': {'precision': 0.36164147576956995, 'recall': 0.11139139223448159, 'f1-score': 0.17032113495910353, 'support': 474920}, '1': {'precision': 0.30496339743355244, 'recall': 0.8720729391143439, 'f1-score': 0.45189824317943084, 'support': 430167}, '2': {'precision': 0.4140460195372083, 'recall': 0.025408572555236462, 'f1-score': 0.04787897779620849, 'support': 502114}, 'accuracy': 0.31324380809848773, 'macro avg': {'precision': 0.36021696424677696, 'recall': 0.33629096796802066, 'f1-score': 0.2233661186449143, 'support': 1407201}, 'weighted avg': {'precision': 0.3630144254517933, 'recall': 0.31324380809848773, 'f1-score': 0.21270687701736218, 'support': 1407201}}
[[ 52902 411837  10181]
 [ 47156 375137   7874]
 [ 46225 443131  12758]]
Evaluating performance on  train set...
2058/2058 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1306928
{'0': {'precision': 0.38834068482561046, 'recall': 0.04852603586608178, 'f1-score': 0.08627177629950651, 'support': 175988}, '1': {'precision': 0.335826325180979, 'recall': 0.9382033317057107, 'f1-score': 0.494609172488521, 'support': 176126}, '2': {'precision': 0.34081489012278093, 'recall': 0.02494419323450289, 'f1-score': 0.046486077110567105, 'support': 174710}, 'accuracy': 0.3381394925060362, 'macro avg': {'precision': 0.3549939667097901, 'recall': 0.3372245202687651, 'f1-score': 0.2091223419661982, 'support': 526824}, 'weighted avg': {'precision': 0.3550233422229544, 'recall': 0.3381394925060362, 'f1-score': 0.20959165682105976, 'support': 526824}}
[[  8540 163662   3786]
 [  6241 165242   4643]
 [  7210 163142   4358]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1312629
{'0': {'precision': 0.34127518106621285, 'recall': 0.1463062879636228, 'f1-score': 0.20480969063594798, 'support': 58938}, '1': {'precision': 0.32892695995487875, 'recall': 0.8161605206073753, 'f1-score': 0.4688850475367329, 'support': 57164}, '2': {'precision': 0.4150444938820912, 'recall': 0.05129130367544719, 'f1-score': 0.09129975989845386, 'support': 58197}, 'accuracy': 0.33427042036959476, 'macro avg': {'precision': 0.36174887830106095, 'recall': 0.33791937074881506, 'f1-score': 0.25499816602371156, 'support': 174299}, 'weighted avg': {'precision': 0.36185636045529346, 'recall': 0.33427042036959476, 'f1-score': 0.2535171775563923, 'support': 174299}}
[[ 8623 48181  2134]
 [ 8436 46655  2073]
 [ 8208 47004  2985]]
testing model on single stock: results/universal/W2/deepLOB_L2/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 260s - 260s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923604
{'0': {'precision': 0.3181380350113075, 'recall': 0.027803830461234674, 'f1-score': 0.05113839561824765, 'support': 1092871}, '1': {'precision': 0.42189825825886484, 'recall': 0.9399549740431984, 'f1-score': 0.5823907554564184, 'support': 1599966}, '2': {'precision': 0.3206691901490724, 'recall': 0.043000298998623177, 'f1-score': 0.07583188289109645, 'support': 1117062}, 'accuracy': 0.41531704646238654, 'macro avg': {'precision': 0.35356849447308153, 'recall': 0.33691970116768544, 'f1-score': 0.2364536779885875, 'support': 3809899}, 'weighted avg': {'precision': 0.36245424564287626, 'recall': 0.41531704646238654, 'f1-score': 0.2814778007942961, 'support': 3809899}}
[[  30386 1018860   43625]
 [  37936 1503896   58134]
 [  27190 1041838   48034]]
Evaluating performance on  train set...
6147/6147 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1282375
{'0': {'precision': 0.34133239940143456, 'recall': 0.14468988414397843, 'f1-score': 0.20323078589611654, 'support': 518661}, '1': {'precision': 0.3360174078159383, 'recall': 0.8169878014970889, 'f1-score': 0.47618539978645436, 'support': 519408}, '2': {'precision': 0.3782687751391261, 'recall': 0.06411089694742032, 'f1-score': 0.10963953360238021, 'support': 535416}, 'accuracy': 0.33919675116064024, 'macro avg': {'precision': 0.3518728607854997, 'recall': 0.34192952752949585, 'f1-score': 0.2630185730949837, 'support': 1573485}, 'weighted avg': {'precision': 0.35214640614603804, 'recall': 0.33919675116064024, 'f1-score': 0.2614865405766184, 'support': 1573485}}
[[ 75045 411951  31665]
 [ 70304 424350  24754]
 [ 74510 426580  34326]]
Evaluating performance on  val set...
2174/2174 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1081749
{'0': {'precision': 0.37270991016481575, 'recall': 0.23742656460343478, 'f1-score': 0.29007029483919583, 'support': 177537}, '1': {'precision': 0.38395176341561965, 'recall': 0.8133910101596813, 'f1-score': 0.5216599950984396, 'support': 196266}, '2': {'precision': 0.4038155227338546, 'recall': 0.06105604238619384, 'f1-score': 0.1060739331986212, 'support': 182701}, 'accuracy': 0.3826531345686644, 'macro avg': {'precision': 0.3868257321047634, 'recall': 0.37062453904977, 'f1-score': 0.3059347410454189, 'support': 556504}, 'weighted avg': {'precision': 0.3868866637768262, 'recall': 0.3826531345686644, 'f1-score': 0.3113403393366049, 'support': 556504}}
[[ 42152 125754   9631]
 [ 29787 159641   6838]
 [ 41157 130389  11155]]
training model: results/universal/W2/deepOF_L2/h50
Epoch 1/50
9940/9940 - 277s - loss: 3.0010 - accuracy50: 0.4857 - val_loss: 3.7061 - val_accuracy50: 0.4364 - 277s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 275s - loss: 2.9445 - accuracy50: 0.5001 - val_loss: 3.6584 - val_accuracy50: 0.4379 - 275s/epoch - 28ms/step
Epoch 3/50
9940/9940 - 275s - loss: 2.9294 - accuracy50: 0.5038 - val_loss: 3.6652 - val_accuracy50: 0.4401 - 275s/epoch - 28ms/step
Epoch 4/50
9940/9940 - 275s - loss: 2.9197 - accuracy50: 0.5063 - val_loss: 3.6807 - val_accuracy50: 0.4388 - 275s/epoch - 28ms/step
Epoch 5/50
9940/9940 - 277s - loss: 2.9135 - accuracy50: 0.5079 - val_loss: 3.6733 - val_accuracy50: 0.4399 - 277s/epoch - 28ms/step
Epoch 6/50
9940/9940 - 276s - loss: 2.9084 - accuracy50: 0.5090 - val_loss: 3.6966 - val_accuracy50: 0.4408 - 276s/epoch - 28ms/step
Epoch 7/50
9940/9940 - 275s - loss: 2.9038 - accuracy50: 0.5104 - val_loss: 3.7054 - val_accuracy50: 0.4400 - 275s/epoch - 28ms/step
Epoch 8/50
9940/9940 - 276s - loss: 2.8998 - accuracy50: 0.5114 - val_loss: 3.6883 - val_accuracy50: 0.4401 - 276s/epoch - 28ms/step
Epoch 9/50
9940/9940 - 276s - loss: 2.8965 - accuracy50: 0.5121 - val_loss: 3.7146 - val_accuracy50: 0.4380 - 276s/epoch - 28ms/step
Epoch 10/50
9940/9940 - 276s - loss: 2.8933 - accuracy50: 0.5127 - val_loss: 3.7066 - val_accuracy50: 0.4407 - 276s/epoch - 28ms/step
Epoch 11/50
9940/9940 - 278s - loss: 2.8906 - accuracy50: 0.5134 - val_loss: 3.7154 - val_accuracy50: 0.4410 - 278s/epoch - 28ms/step
Epoch 12/50
9940/9940 - 275s - loss: 2.8878 - accuracy50: 0.5141 - val_loss: 3.7174 - val_accuracy50: 0.4414 - 275s/epoch - 28ms/step
testing model in sample: results/universal/W2/deepOF_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 328s - 328s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1951712
{'0': {'precision': 0.3923797203227992, 'recall': 0.30920653413917815, 'f1-score': 0.34586302857530715, 'support': 1771557}, '1': {'precision': 0.5182032612039791, 'recall': 0.6187220340999119, 'f1-score': 0.5640190735023338, 'support': 3144231}, '2': {'precision': 0.3637256768398245, 'recall': 0.3164935876553224, 'f1-score': 0.3384698152318142, 'support': 1804956}, 'accuracy': 0.4559672262475702, 'macro avg': {'precision': 0.4247695527888676, 'recall': 0.4148073852981375, 'f1-score': 0.41611730576981837, 'support': 6720744}, 'weighted avg': {'precision': 0.4435495000465199, 'recall': 0.4559672262475702, 'f1-score': 0.44593953416952886, 'support': 6720744}}
[[ 547777  864345  359435]
 [ 558947 1945405  639879]
 [ 289314  944385  571257]]
Evaluating performance on  train set...
9940/9940 - 125s - 125s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2145611
{'0': {'precision': 0.4433248039690069, 'recall': 0.2664814857151566, 'f1-score': 0.3328735012156861, 'support': 787338}, '1': {'precision': 0.4419423449051486, 'recall': 0.6977379856928143, 'f1-score': 0.5411341290143847, 'support': 957421}, '2': {'precision': 0.42472220581734754, 'recall': 0.29707958841348925, 'f1-score': 0.3496148086712428, 'support': 798860}, 'accuracy': 0.43841668111458515, 'macro avg': {'precision': 0.436663118230501, 'recall': 0.4204330199404867, 'f1-score': 0.40787414630043783, 'support': 2543619}, 'weighted avg': {'precision': 0.43696203230437747, 'recall': 0.43841668111458515, 'f1-score': 0.416520878987909, 'support': 2543619}}
[[209811 408028 169499]
 [137439 668029 151953]
 [126017 435518 237325]]
Evaluating performance on  val set...
3393/3393 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2063038
{'0': {'precision': 0.4358261733417696, 'recall': 0.27972158019181215, 'f1-score': 0.3407459119089779, 'support': 263487}, '1': {'precision': 0.454437872228808, 'recall': 0.6614117069099712, 'f1-score': 0.538729474607812, 'support': 337903}, '2': {'precision': 0.3990568177978578, 'recall': 0.309993138177605, 'f1-score': 0.348931338949572, 'support': 266693}, 'accuracy': 0.4375952529884815, 'macro avg': {'precision': 0.4297736211228118, 'recall': 0.4170421417597961, 'f1-score': 0.4094689084887873, 'support': 868083}, 'weighted avg': {'precision': 0.4317745091010858, 'recall': 0.4375952529884815, 'f1-score': 0.4203261316349272, 'support': 868083}}
[[ 73703 128607  61177]
 [ 51089 223493  63321]
 [ 44319 139701  82673]]
testing model out of sample: results/universal/W2/deepOF_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 173s - 173s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1977991
{'0': {'precision': 0.48767272693662134, 'recall': 0.21952197766078105, 'f1-score': 0.302759284741246, 'support': 1201743}, '1': {'precision': 0.41263097010633143, 'recall': 0.817546376993031, 'f1-score': 0.5484493035755816, 'support': 1246092}, '2': {'precision': 0.49552955003204596, 'recall': 0.2670483307120594, 'f1-score': 0.34706052324893294, 'support': 1218873}, 'accuracy': 0.4385527835868032, 'macro avg': {'precision': 0.4652777490249996, 'recall': 0.4347055617886238, 'f1-score': 0.3994230371885869, 'support': 3666708}, 'weighted avg': {'precision': 0.4647823131607275, 'recall': 0.4385527835868032, 'f1-score': 0.4009808912702892, 'support': 3666708}}
[[ 263809  730037  207897]
 [ 103880 1018738  123474]
 [ 173266  720109  325498]]
Evaluating performance on  train set...
5373/5373 - 67s - 67s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1106489
{'0': {'precision': 0.5434911543922502, 'recall': 0.21949437345908268, 'f1-score': 0.31270121400552886, 'support': 413309}, '1': {'precision': 0.4720177058979782, 'recall': 0.8544510208763478, 'f1-score': 0.6081048162469885, 'support': 544875}, '2': {'precision': 0.48986829459777737, 'recall': 0.2605446551988942, 'f1-score': 0.3401662136652384, 'support': 416704}, 'accuracy': 0.4835724800856506, 'macro avg': {'precision': 0.5017923849626685, 'recall': 0.44483001651144155, 'f1-score': 0.4203240813059186, 'support': 1374888}, 'weighted avg': {'precision': 0.49891373760185526, 'recall': 0.4835724800856506, 'f1-score': 0.4380952919155222, 'support': 1374888}}
[[ 90719 256009  66581]
 [ 32826 465569  46480]
 [ 43374 264760 108570]]
Evaluating performance on  val set...
1685/1685 - 21s - 21s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.136034
{'0': {'precision': 0.5203327834755791, 'recall': 0.21585516430877255, 'f1-score': 0.3051300114607758, 'support': 134442}, '1': {'precision': 0.45316121693873973, 'recall': 0.8469548558539073, 'f1-score': 0.5904197343649703, 'support': 161815}, '2': {'precision': 0.4922308392901499, 'recall': 0.2653780912418534, 'f1-score': 0.3448409207358926, 'support': 134412}, 'accuracy': 0.4684339945526611, 'macro avg': {'precision': 0.4885749465681563, 'recall': 0.4427293704681777, 'f1-score': 0.4134635555205462, 'support': 430669}, 'weighted avg': {'precision': 0.4863238216951617, 'recall': 0.4684339945526611, 'f1-score': 0.42471553827888725, 'support': 430669}}
[[ 29020  82793  22629]
 [ 10598 137050  14167]
 [ 16154  82588  35670]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/LILAK
Evaluating performance on  test set...
987/987 - 13s - 13s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2977281
{'0': {'precision': 0.32739660865185516, 'recall': 0.298497372314914, 'f1-score': 0.31227981210633077, 'support': 78396}, '1': {'precision': 0.3946734235785009, 'recall': 0.32417514053999025, 'f1-score': 0.3559673593084346, 'support': 88409}, '2': {'precision': 0.3500189119625082, 'recall': 0.4427962887319834, 'f1-score': 0.3909790707020744, 'support': 85685}, 'accuracy': 0.3564576814923363, 'macro avg': {'precision': 0.3573629813976214, 'recall': 0.3551562671956292, 'f1-score': 0.35307541403894654, 'support': 252490}, 'weighted avg': {'precision': 0.3586305901561647, 'recall': 0.3564576814923363, 'f1-score': 0.35428432053584125, 'support': 252490}}
[[23401 20185 34810]
 [24103 28660 35646]
 [23972 23772 37941]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3151625
{'0': {'precision': 0.3338798123127367, 'recall': 0.2997665211653639, 'f1-score': 0.3159048969003236, 'support': 19702}, '1': {'precision': 0.3439684329199549, 'recall': 0.304445442299057, 'f1-score': 0.32300240849059103, 'support': 20043}, '2': {'precision': 0.3501135051176869, 'recall': 0.42278651469244455, 'f1-score': 0.38303341902313626, 'support': 20793}, 'accuracy': 0.3435693283557435, 'macro avg': {'precision': 0.3426539167834595, 'recall': 0.3423328260522885, 'f1-score': 0.34064690813801696, 'support': 60538}, 'weighted avg': {'precision': 0.3427957559733103, 'recall': 0.3435693283557435, 'f1-score': 0.34131139835896734, 'support': 60538}}
[[5906 5598 8198]
 [5821 6102 8120]
 [5962 6040 8791]]
Evaluating performance on  val set...
85/85 - 4s - 4s/epoch - 50ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2692677
{'0': {'precision': 0.350702384841555, 'recall': 0.30834410455263533, 'f1-score': 0.3281620175773787, 'support': 6963}, '1': {'precision': 0.38910218546958064, 'recall': 0.3597269624573379, 'f1-score': 0.3738384053344684, 'support': 7325}, '2': {'precision': 0.3499942548546478, 'recall': 0.4167464769462307, 'f1-score': 0.38046465151136644, 'support': 7309}, 'accuracy': 0.362457748761402, 'macro avg': {'precision': 0.36326627505526116, 'recall': 0.36160584798540124, 'f1-score': 0.36082169147440446, 'support': 21597}, 'weighted avg': {'precision': 0.3634866982890701, 'recall': 0.362457748761402, 'f1-score': 0.36135456708630115, 'support': 21597}}
[[2147 1941 2875]
 [1908 2635 2782]
 [2067 2196 3046]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 16s - 16s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0129842
{'0': {'precision': 0.5582705669410871, 'recall': 0.2215284454896146, 'f1-score': 0.3171915041840484, 'support': 86323}, '1': {'precision': 0.5260753567743072, 'recall': 0.8930165986627074, 'f1-score': 0.6621051214432221, 'support': 140433}, '2': {'precision': 0.5704035079948621, 'recall': 0.2829148267756322, 'f1-score': 0.37823073308270677, 'support': 91038}, 'accuracy': 0.5358439743985097, 'macro avg': {'precision': 0.5515831439034188, 'recall': 0.4658199569759847, 'f1-score': 0.4525091195699924, 'support': 317794}, 'weighted avg': {'precision': 0.5475192271999408, 'recall': 0.5358439743985097, 'f1-score': 0.4870944706750256, 'support': 317794}}
[[ 19123  56193  11007]
 [  6633 125409   8391]
 [  8498  56784  25756]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88080424
{'0': {'precision': 0.6464204855960652, 'recall': 0.26093533341737046, 'f1-score': 0.3717922812689432, 'support': 31732}, '1': {'precision': 0.6119011035060763, 'recall': 0.9244112433527475, 'f1-score': 0.7363714300122712, 'support': 71082}, '2': {'precision': 0.6060873700659012, 'recall': 0.2779214305741612, 'f1-score': 0.38109274210773636, 'support': 32099}, 'accuracy': 0.6145441877358001, 'macro avg': {'precision': 0.6214696530560143, 'recall': 0.4877560024480931, 'f1-score': 0.4964188177963169, 'support': 134913}, 'weighted avg': {'precision': 0.6186369555202138, 'recall': 0.6145441877358001, 'f1-score': 0.5660919450777508, 'support': 134913}}
[[ 8280 20470  2982]
 [ 2557 65709  2816]
 [ 1972 21206  8921]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9337413
{'0': {'precision': 0.6182731403970342, 'recall': 0.24265465127194216, 'f1-score': 0.348523661857894, 'support': 10653}, '1': {'precision': 0.5768337830206438, 'recall': 0.9193459672983649, 'f1-score': 0.7088851618375649, 'support': 19999}, '2': {'precision': 0.6047587574355585, 'recall': 0.276101388050694, 'f1-score': 0.37911746426351767, 'support': 9942}, 'accuracy': 0.5842242695964921, 'macro avg': {'precision': 0.5999552269510788, 'recall': 0.47936733554033367, 'f1-score': 0.4788420959863255, 'support': 40594}, 'weighted avg': {'precision': 0.5945478188329256, 'recall': 0.5842242695964921, 'f1-score': 0.5335518241875523, 'support': 40594}}
[[ 2585  7076   992]
 [  811 18386   802]
 [  785  6412  2745]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 14s - 14s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4256897
{'0': {'precision': 0.3830519190717048, 'recall': 0.22315508948303506, 'f1-score': 0.2820158265107746, 'support': 92308}, '1': {'precision': 0.30972517286640233, 'recall': 0.5693073000870539, 'f1-score': 0.4011883687097962, 'support': 80410}, '2': {'precision': 0.4079443756023682, 'recall': 0.29194009261996257, 'f1-score': 0.3403285090742017, 'support': 101490}, 'accuracy': 0.35012107597152525, 'macro avg': {'precision': 0.3669071558468251, 'recall': 0.3614674940633505, 'f1-score': 0.34117756809825744, 'support': 274208}, 'weighted avg': {'precision': 0.37076245906663075, 'recall': 0.35012107597152525, 'f1-score': 0.33854524312730494, 'support': 274208}}
[[20599 47087 24622]
 [16253 45778 18379]
 [16924 54937 29629]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3924456
{'0': {'precision': 0.41855622397038406, 'recall': 0.22169117647058822, 'f1-score': 0.2898573946482935, 'support': 24480}, '1': {'precision': 0.3507320783418901, 'recall': 0.6067683704099676, 'f1-score': 0.4445180822701872, 'support': 24319}, '2': {'precision': 0.3768268963601, 'recall': 0.27981348518610216, 'f1-score': 0.3211537095361008, 'support': 24234}, 'accuracy': 0.3692029630441033, 'macro avg': {'precision': 0.38203839955745805, 'recall': 0.3694243440222193, 'f1-score': 0.35184306215152716, 'support': 73033}, 'weighted avg': {'precision': 0.3821249679238439, 'recall': 0.3692029630441033, 'f1-score': 0.3517421338383576, 'support': 73033}}
[[ 5427 13381  5672]
 [ 4021 14756  5542]
 [ 3518 13935  6781]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.396236
{'0': {'precision': 0.39409622388345794, 'recall': 0.21555881736213042, 'f1-score': 0.27868519146052184, 'support': 9538}, '1': {'precision': 0.36409666283084, 'recall': 0.6187542778918549, 'f1-score': 0.4584344550295215, 'support': 10227}, '2': {'precision': 0.3896283971159179, 'recall': 0.2797690163281561, 'f1-score': 0.32568382012053776, 'support': 10044}, 'accuracy': 0.3755241705525177, 'macro avg': {'precision': 0.3826070946100719, 'recall': 0.37136070386071385, 'f1-score': 0.354267822203527, 'support': 29809}, 'weighted avg': {'precision': 0.38229843251379453, 'recall': 0.3755241705525177, 'f1-score': 0.35619030551269937, 'support': 29809}}
[[2056 5309 2173]
 [1670 6328 2229]
 [1491 5743 2810]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3015691
{'0': {'precision': 0.3178701235764478, 'recall': 0.35595864763662016, 'f1-score': 0.33583789872510367, 'support': 73708}, '1': {'precision': 0.33669354838709675, 'recall': 0.24114812795614954, 'f1-score': 0.281021678471775, 'support': 67867}, '2': {'precision': 0.337613046367312, 'recall': 0.382535347863815, 'f1-score': 0.3586730878525919, 'support': 78364}, 'accuracy': 0.3300005910729793, 'macro avg': {'precision': 0.3307255727769522, 'recall': 0.32654737448552823, 'f1-score': 0.3251775550164902, 'support': 219939}, 'weighted avg': {'precision': 0.33071288349264083, 'recall': 0.3300005910729793, 'f1-score': 0.3270593025727788, 'support': 219939}}
[[26237 15162 32309]
 [24996 16366 26505]
 [31307 17080 29977]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3042876
{'0': {'precision': 0.3425688204250464, 'recall': 0.33902671418992836, 'f1-score': 0.3407885635231727, 'support': 28337}, '1': {'precision': 0.34863013698630135, 'recall': 0.2679753309265945, 'f1-score': 0.3030277258037081, 'support': 26592}, '2': {'precision': 0.30373226496370154, 'recall': 0.3769063995215311, 'f1-score': 0.336385928038833, 'support': 26752}, 'accuracy': 0.3283015633990769, 'macro avg': {'precision': 0.3316437407916831, 'recall': 0.32796948154601796, 'f1-score': 0.32673407245523794, 'support': 81681}, 'weighted avg': {'precision': 0.3318224656827562, 'recall': 0.3283015633990769, 'f1-score': 0.3270532333838128, 'support': 81681}}
[[ 9607  6416 12314]
 [ 8666  7126 10800]
 [ 9771  6898 10083]]
Evaluating performance on  val set...
98/98 - 3s - 3s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3164612
{'0': {'precision': 0.3387782204515272, 'recall': 0.2952204605948386, 'f1-score': 0.31550306103518644, 'support': 8641}, '1': {'precision': 0.3323436630172574, 'recall': 0.21814859926918392, 'f1-score': 0.2634017207147584, 'support': 8210}, '2': {'precision': 0.29363893041023087, 'recall': 0.43600493218249076, 'f1-score': 0.3509329098848749, 'support': 8110}, 'accuracy': 0.3156123552742278, 'macro avg': {'precision': 0.32158693795967186, 'recall': 0.3164579973488377, 'f1-score': 0.3099458972116066, 'support': 24961}, 'weighted avg': {'precision': 0.321995745439698, 'recall': 0.3156123552742278, 'f1-score': 0.3098776481967689, 'support': 24961}}
[[2551 1750 4340]
 [2253 1791 4166]
 [2726 1848 3536]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.351352
{'0': {'precision': 0.4410108709775218, 'recall': 0.24177559330887677, 'f1-score': 0.3123250695887554, 'support': 168462}, '1': {'precision': 0.32694436881749706, 'recall': 0.6349939366592402, 'f1-score': 0.43164450493756457, 'support': 141836}, '2': {'precision': 0.44392749195219644, 'recall': 0.30173258507037237, 'f1-score': 0.35927198963205054, 'support': 179616}, 'accuracy': 0.3775989255257045, 'macro avg': {'precision': 0.40396091058240513, 'recall': 0.3928340383461631, 'f1-score': 0.3677471880527901, 'support': 489914}, 'weighted avg': {'precision': 0.40905655938940205, 'recall': 0.3775989255257045, 'f1-score': 0.36408151954248236, 'support': 489914}}
[[40730 89759 37973]
 [21857 90065 29914]
 [29769 95651 54196]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2966315
{'0': {'precision': 0.4729259989249239, 'recall': 0.21309887128808797, 'f1-score': 0.2938085802702763, 'support': 61929}, '1': {'precision': 0.382078149072464, 'recall': 0.6982924700729446, 'f1-score': 0.49390883044885986, 'support': 60731}, '2': {'precision': 0.4152087812606088, 'recall': 0.3036261026430333, 'f1-score': 0.35075711226674827, 'support': 60423}, 'accuracy': 0.4039206261640895, 'macro avg': {'precision': 0.4234043097526656, 'recall': 0.405005814668022, 'f1-score': 0.37949150766196144, 'support': 183083}, 'weighted avg': {'precision': 0.42374214126298554, 'recall': 0.4039206261640895, 'f1-score': 0.37897918290633964, 'support': 183083}}
[[13197 34724 14008]
 [ 6492 42408 11831]
 [ 8216 33861 18346]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3568672
{'0': {'precision': 0.4360146252285192, 'recall': 0.24350400735106437, 'f1-score': 0.3124897638311114, 'support': 19589}, '1': {'precision': 0.3034112578571933, 'recall': 0.5632620951881474, 'f1-score': 0.3943817130267144, 'support': 15254}, '2': {'precision': 0.4154325798908807, 'recall': 0.322850941396194, 'f1-score': 0.36333683642457465, 'support': 19811}, 'accuracy': 0.361510593918103, 'macro avg': {'precision': 0.38495282099219774, 'recall': 0.3765390146451353, 'f1-score': 0.3567361044274668, 'support': 54654}, 'weighted avg': {'precision': 0.3915442723528621, 'recall': 0.361510593918103, 'f1-score': 0.35377697333414554, 'support': 54654}}
[[4770 9781 5038]
 [2700 8592 3962]
 [3470 9945 6396]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/EXC
Evaluating performance on  test set...
4918/4918 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8939172
{'0': {'precision': 0.6808790428630207, 'recall': 0.2737140818576896, 'f1-score': 0.39046202459905666, 'support': 308340}, '1': {'precision': 0.5886798992490946, 'recall': 0.9440127584655102, 'f1-score': 0.7251569096337572, 'support': 633305}, '2': {'precision': 0.7084747751598817, 'recall': 0.26648465110706865, 'f1-score': 0.3872933543491807, 'support': 317189}, 'accuracy': 0.6091120830864117, 'macro avg': {'precision': 0.659344572423999, 'recall': 0.4947371638100895, 'f1-score': 0.5009707628606649, 'support': 1258834}, 'weighted avg': {'precision': 0.6414480170765322, 'recall': 0.6091120830864117, 'f1-score': 0.558044785168769, 'support': 1258834}}
[[ 84397 203961  19982]
 [ 20658 597848  14799]
 [ 18898 213765  84526]]
Evaluating performance on  train set...
1403/1403 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8264492
{'0': {'precision': 0.6629363100634633, 'recall': 0.2902921654984182, 'f1-score': 0.40377563610322603, 'support': 80605}, '1': {'precision': 0.6365261647321535, 'recall': 0.9389638865873128, 'f1-score': 0.7587164146810937, 'support': 197932}, '2': {'precision': 0.7091809379632258, 'recall': 0.2795271185808585, 'f1-score': 0.4009986625055729, 'support': 80443}, 'accuracy': 0.645540141512062, 'macro avg': {'precision': 0.6695478042529475, 'recall': 0.5029277235555298, 'f1-score': 0.5211635710966309, 'support': 358980}, 'weighted avg': {'precision': 0.6587373121148974, 'recall': 0.645540141512062, 'f1-score': 0.5988582315078683, 'support': 358980}}
[[ 23399  52615   4591]
 [  7451 185851   4630]
 [  4446  53511  22486]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86694986
{'0': {'precision': 0.6815297696653629, 'recall': 0.26954279821244415, 'f1-score': 0.3863037319866979, 'support': 29090}, '1': {'precision': 0.6071950365255679, 'recall': 0.9414292807050207, 'f1-score': 0.7382438466498765, 'support': 64452}, '2': {'precision': 0.720148922967822, 'recall': 0.2784671282648934, 'f1-score': 0.40163144234334447, 'support': 29174}, 'accuracy': 0.6245477362365136, 'macro avg': {'precision': 0.669624576386251, 'recall': 0.4964797357274528, 'f1-score': 0.5087263403266397, 'support': 122716}, 'weighted avg': {'precision': 0.6516693843702088, 'recall': 0.6245477362365136, 'f1-score': 0.5747910921696895, 'support': 122716}}
[[ 7841 19707  1542]
 [ 2160 60677  1615]
 [ 1504 19546  8124]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/AAL
Evaluating performance on  test set...
4856/4856 - 59s - 59s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995988
{'0': {'precision': 0.5583395299214381, 'recall': 0.21302262702414668, 'f1-score': 0.30838679954500897, 'support': 405356}, '1': {'precision': 0.44378290146663824, 'recall': 0.9064983385121427, 'f1-score': 0.5958587750888508, 'support': 445083}, '2': {'precision': 0.5673707779843766, 'recall': 0.258907254478789, 'f1-score': 0.3555616986730867, 'support': 392461}, 'accuracy': 0.47584520074020437, 'macro avg': {'precision': 0.523164403124151, 'recall': 0.45947607333835944, 'f1-score': 0.4199357577689822, 'support': 1242900}, 'weighted avg': {'precision': 0.5201684821971492, 'recall': 0.47584520074020437, 'f1-score': 0.4262266880136582, 'support': 1242900}}
[[ 86350 262119  56887]
 [ 21023 403467  20593]
 [ 47282 243568 101611]]
Evaluating performance on  train set...
2076/2076 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93935555
{'0': {'precision': 0.6162829007577699, 'recall': 0.2435090764446373, 'f1-score': 0.34908555550947623, 'support': 138270}, '1': {'precision': 0.5583957604746086, 'recall': 0.9080950061190785, 'f1-score': 0.6915507592357725, 'support': 252489}, '2': {'precision': 0.5570551961791911, 'recall': 0.2620457728704382, 'f1-score': 0.3564248241181732, 'support': 140651}, 'accuracy': 0.5641801998456936, 'macro avg': {'precision': 0.5772446191371898, 'recall': 0.4712166184780513, 'f1-score': 0.4656870462878073, 'support': 531410}, 'weighted avg': {'precision': 0.5731028664346732, 'recall': 0.5641801998456936, 'f1-score': 0.513743676908642, 'support': 531410}}
[[ 33670  87972  16628]
 [ 10526 229284  12679]
 [ 10438  93356  36857]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9417092
{'0': {'precision': 0.6510224100203728, 'recall': 0.2187349473951071, 'f1-score': 0.32745075714448363, 'support': 39445}, '1': {'precision': 0.5532104613018546, 'recall': 0.941655642971524, 'f1-score': 0.6969637630374739, 'support': 71815}, '2': {'precision': 0.6182505399568035, 'recall': 0.23457106274007683, 'f1-score': 0.3401032190992463, 'support': 39050}, 'accuracy': 0.5682456257068724, 'macro avg': {'precision': 0.6074944704263436, 'recall': 0.464987217702236, 'f1-score': 0.4548392464270679, 'support': 150310}, 'weighted avg': {'precision': 0.5957758753706305, 'recall': 0.5682456257068724, 'f1-score': 0.5072834705869597, 'support': 150310}}
[[ 8628 27280  3537]
 [ 2071 67625  2119]
 [ 2554 27336  9160]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/WBA
Evaluating performance on  test set...
4353/4353 - 55s - 55s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0397922
{'0': {'precision': 0.6590904974917146, 'recall': 0.21810891961380105, 'f1-score': 0.3277556129938669, 'support': 333714}, '1': {'precision': 0.48627726952850103, 'recall': 0.9342157307488609, 'f1-score': 0.6396200116585246, 'support': 447493}, '2': {'precision': 0.566017316017316, 'recall': 0.2449531037961306, 'f1-score': 0.3419303465906709, 'support': 333076}, 'accuracy': 0.5137195847015524, 'macro avg': {'precision': 0.5704616943458438, 'recall': 0.4657592513862641, 'f1-score': 0.43643532374768745, 'support': 1114283}, 'weighted avg': {'precision': 0.5618682004507392, 'recall': 0.5137195847015524, 'f1-score': 0.4572365428107381, 'support': 1114283}}
[[ 72786 215673  45255]
 [ 12137 418055  17301]
 [ 25511 225977  81588]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1169127
{'0': {'precision': 0.6080438425653336, 'recall': 0.2112260551469142, 'f1-score': 0.31353453258832387, 'support': 127115}, '1': {'precision': 0.4429662007009628, 'recall': 0.9250555598398755, 'f1-score': 0.5990670011236847, 'support': 142639}, '2': {'precision': 0.5764544623819677, 'recall': 0.24261265303506185, 'f1-score': 0.34149862408084086, 'support': 124808}, 'accuracy': 0.47921239247570724, 'macro avg': {'precision': 0.5424881685494215, 'recall': 0.4596314226739506, 'f1-score': 0.4180333859309498, 'support': 394562}, 'weighted avg': {'precision': 0.5383738867160184, 'recall': 0.47921239247570724, 'f1-score': 0.4256036322745922, 'support': 394562}}
[[ 26850  83883  16382]
 [  4824 131949   5866]
 [ 12484  82044  30280]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.105362
{'0': {'precision': 0.616822429906542, 'recall': 0.20052009578001492, 'f1-score': 0.30265228796269306, 'support': 38839}, '1': {'precision': 0.44793301385012374, 'recall': 0.9301649096714929, 'f1-score': 0.6046762922362743, 'support': 45722}, '2': {'precision': 0.5660185538187825, 'recall': 0.22989573655414472, 'f1-score': 0.32698307822192857, 'support': 38748}, 'accuracy': 0.48029746409426727, 'macro avg': {'precision': 0.5435913325251495, 'recall': 0.4535269140018842, 'f1-score': 0.411437219473632, 'support': 123309}, 'weighted avg': {'precision': 0.538235218335772, 'recall': 0.48029746409426727, 'f1-score': 0.4222859804292733, 'support': 123309}}
[[ 7788 26150  4901]
 [ 1264 42529  1929]
 [ 3574 26266  8908]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1690059
{'0': {'precision': 0.5497149832308221, 'recall': 0.20290187896006526, 'f1-score': 0.2964010204749969, 'support': 457221}, '1': {'precision': 0.42365339798526536, 'recall': 0.9194072037752318, 'f1-score': 0.5800333737746974, 'support': 490354}, '2': {'precision': 0.5857844543649655, 'recall': 0.2221112612348, 'f1-score': 0.32209435316574514, 'support': 459621}, 'accuracy': 0.4588507926401155, 'macro avg': {'precision': 0.5197176118603509, 'recall': 0.448140114656699, 'f1-score': 0.3995095824718132, 'support': 1407196}, 'weighted avg': {'precision': 0.5175684192984675, 'recall': 0.4588507926401155, 'f1-score': 0.4036280551130827, 'support': 1407196}}
[[ 92771 311259  53191]
 [ 20523 450835  18996]
 [ 55468 302066 102087]]
Evaluating performance on  train set...
2058/2058 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1557465
{'0': {'precision': 0.6073906008815161, 'recall': 0.19333680621329796, 'f1-score': 0.2933107018890969, 'support': 168928}, '1': {'precision': 0.4274723347062006, 'recall': 0.9237878617994265, 'f1-score': 0.5844821820073575, 'support': 187293}, '2': {'precision': 0.553891426563598, 'recall': 0.22176046142213207, 'f1-score': 0.31671738375183645, 'support': 170603}, 'accuracy': 0.462226474116593, 'macro avg': {'precision': 0.5295847873837715, 'recall': 0.44629504314495216, 'f1-score': 0.3981700892160969, 'support': 526824}, 'weighted avg': {'precision': 0.5261024449453151, 'recall': 0.462226474116593, 'f1-score': 0.4044059256670917, 'support': 526824}}
[[ 32660 114095  22173]
 [  5976 173019   8298]
 [ 15135 117635  37833]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1726553
{'0': {'precision': 0.5634932422397149, 'recall': 0.19321982107389615, 'f1-score': 0.28776578262078734, 'support': 58907}, '1': {'precision': 0.4062117934731496, 'recall': 0.9062314228765255, 'f1-score': 0.5609719140646139, 'support': 57194}, '2': {'precision': 0.5384847570178086, 'recall': 0.24523179490704147, 'f1-score': 0.33699322330051235, 'support': 58198}, 'accuracy': 0.4445521775799058, 'macro avg': {'precision': 0.5027299309102243, 'recall': 0.4482276796191544, 'f1-score': 0.39524363999530454, 'support': 174299}, 'weighted avg': {'precision': 0.5035330645926863, 'recall': 0.4445521775799058, 'f1-score': 0.39385181911254485, 'support': 174299}}
[[11382 38464  9061]
 [ 2192 51831  3171]
 [ 6625 37301 14272]]
testing model on single stock: results/universal/W2/deepOF_L2/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 183s - 183s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3492196
{'0': {'precision': 0.33038572442679004, 'recall': 0.3562114222999736, 'f1-score': 0.3428128688466819, 'support': 969472}, '1': {'precision': 0.49502810393304303, 'recall': 0.4247991922951077, 'f1-score': 0.4572326556875223, 'support': 1855133}, '2': {'precision': 0.2979571788670853, 'recall': 0.35462894643094567, 'f1-score': 0.3238323228981163, 'support': 985289}, 'accuracy': 0.38919927956000877, 'macro avg': {'precision': 0.3744570024089728, 'recall': 0.3785465203420089, 'f1-score': 0.37462594914410685, 'support': 3809894}, 'weighted avg': {'precision': 0.402167779831638, 'recall': 0.38919927956000877, 'f1-score': 0.3936181141590955, 'support': 3809894}}
[[345337 373333 250802]
 [494596 788059 572478]
 [205321 430556 349412]]
Evaluating performance on  train set...
6147/6147 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3513062
{'0': {'precision': 0.4011714397226103, 'recall': 0.27301948420649447, 'f1-score': 0.3249157342941666, 'support': 519549}, '1': {'precision': 0.3493511318200422, 'recall': 0.5343293988936314, 'f1-score': 0.42247978490022087, 'support': 519176}, '2': {'precision': 0.38868927684077537, 'recall': 0.30951196616039406, 'f1-score': 0.3446111948564623, 'support': 534758}, 'accuracy': 0.37164176543375427, 'macro avg': {'precision': 0.379737282794476, 'recall': 0.3722869497535066, 'f1-score': 0.3640022380169499, 'support': 1573483}, 'weighted avg': {'precision': 0.3798310142880883, 'recall': 0.37164176543375427, 'f1-score': 0.36380094540659735, 'support': 1573483}}
[[141847 244762 132940]
 [114393 277411 127372]
 [ 97342 271902 165514]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3183076
{'0': {'precision': 0.3966835393604398, 'recall': 0.29966414015340626, 'f1-score': 0.341415173002217, 'support': 176264}, '1': {'precision': 0.385724296726399, 'recall': 0.5020950280673616, 'f1-score': 0.43628302782459477, 'support': 199520}, '2': {'precision': 0.3623063525529379, 'recall': 0.3280562641448879, 'f1-score': 0.34433170516387207, 'support': 180719}, 'accuracy': 0.38146065699555975, 'macro avg': {'precision': 0.3815713962132589, 'recall': 0.3766051441218852, 'f1-score': 0.37400996866356134, 'support': 556503}, 'weighted avg': {'precision': 0.3815907206101209, 'recall': 0.38146065699555975, 'f1-score': 0.3763747458524675, 'support': 556503}}
[[ 52820  73828  49616]
 [ 44609 100178  54733]
 [ 35725  85708  59286]]
training model: results/universal/W2/deepOF_L2/h100
Epoch 1/50
9940/9940 - 282s - loss: 3.1692 - accuracy100: 0.4304 - val_loss: 3.4281 - val_accuracy100: 0.3762 - 282s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 276s - loss: 3.1237 - accuracy100: 0.4463 - val_loss: 3.4879 - val_accuracy100: 0.3751 - 276s/epoch - 28ms/step
Epoch 3/50
9940/9940 - 275s - loss: 3.1081 - accuracy100: 0.4522 - val_loss: 3.4665 - val_accuracy100: 0.3808 - 275s/epoch - 28ms/step
Epoch 4/50
9940/9940 - 277s - loss: 3.0994 - accuracy100: 0.4554 - val_loss: 3.4488 - val_accuracy100: 0.3827 - 277s/epoch - 28ms/step
Epoch 5/50
9940/9940 - 276s - loss: 3.0938 - accuracy100: 0.4570 - val_loss: 3.4507 - val_accuracy100: 0.3816 - 276s/epoch - 28ms/step
Epoch 6/50
9940/9940 - 273s - loss: 3.0891 - accuracy100: 0.4585 - val_loss: 3.4394 - val_accuracy100: 0.3852 - 273s/epoch - 27ms/step
Epoch 7/50
9940/9940 - 277s - loss: 3.0853 - accuracy100: 0.4600 - val_loss: 3.4397 - val_accuracy100: 0.3846 - 277s/epoch - 28ms/step
Epoch 8/50
9940/9940 - 277s - loss: 3.0818 - accuracy100: 0.4608 - val_loss: 3.4307 - val_accuracy100: 0.3853 - 277s/epoch - 28ms/step
Epoch 9/50
9940/9940 - 278s - loss: 3.0789 - accuracy100: 0.4623 - val_loss: 3.4531 - val_accuracy100: 0.3824 - 278s/epoch - 28ms/step
Epoch 10/50
9940/9940 - 274s - loss: 3.0765 - accuracy100: 0.4628 - val_loss: 3.4413 - val_accuracy100: 0.3828 - 274s/epoch - 28ms/step
Epoch 11/50
9940/9940 - 274s - loss: 3.0743 - accuracy100: 0.4638 - val_loss: 3.4457 - val_accuracy100: 0.3843 - 274s/epoch - 28ms/step
testing model in sample: results/universal/W2/deepOF_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 321s - 321s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1261736
{'0': {'precision': 0.41121692455113595, 'recall': 0.20109739983636085, 'f1-score': 0.27010524171113776, 'support': 2142519}, '1': {'precision': 0.3797720391792418, 'recall': 0.7441282475412626, 'f1-score': 0.5028899900083372, 'support': 2385574}, '2': {'precision': 0.4180204590878323, 'recall': 0.19039372886975628, 'f1-score': 0.2616259631181637, 'support': 2192651}, 'accuracy': 0.3903578234790672, 'macro avg': {'precision': 0.4030031409394033, 'recall': 0.37853979208245997, 'f1-score': 0.34487373161254625, 'support': 6720744}, 'weighted avg': {'precision': 0.4022750091663588, 'recall': 0.3903578234790672, 'f1-score': 0.3499674034670654, 'support': 6720744}}
[[ 430855 1424348  287316]
 [ 316508 1775173  293893]
 [ 300393 1474791  417467]]
Evaluating performance on  train set...
9940/9940 - 125s - 125s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1434039
{'0': {'precision': 0.4105011179797448, 'recall': 0.1871663462311142, 'f1-score': 0.25710616346667914, 'support': 833761}, '1': {'precision': 0.3636286618503453, 'recall': 0.7404947137211675, 'f1-score': 0.4877445905323878, 'support': 863651}, '2': {'precision': 0.40909057216345834, 'recall': 0.19566134527367418, 'f1-score': 0.26471420554561637, 'support': 846207}, 'accuracy': 0.37786751868106033, 'macro avg': {'precision': 0.3944067839978495, 'recall': 0.3744408017419853, 'f1-score': 0.33652165318156113, 'support': 2543619}, 'weighted avg': {'precision': 0.39411695928609836, 'recall': 0.37786751868106033, 'f1-score': 0.3379473140624317, 'support': 2543619}}
[[156052 551037 126672]
 [111637 639529 112485]
 [112461 568176 165570]]
Evaluating performance on  val set...
3393/3393 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1401405
{'0': {'precision': 0.4202713913249585, 'recall': 0.1971453191016233, 'f1-score': 0.26839097858169986, 'support': 287808}, '1': {'precision': 0.3587712581368736, 'recall': 0.7355878866854738, 'f1-score': 0.482305635814343, 'support': 288542}, '2': {'precision': 0.4036316600460849, 'recall': 0.1957440536380869, 'f1-score': 0.26363596492240504, 'support': 291733}, 'accuracy': 0.3756472595362425, 'macro avg': {'precision': 0.3942247698359724, 'recall': 0.3761590864750614, 'f1-score': 0.33811085977281596, 'support': 868083}, 'weighted avg': {'precision': 0.39423732527881317, 'recall': 0.3756472595362425, 'f1-score': 0.33789604736815715, 'support': 868083}}
[[ 56740 185693  45375]
 [ 37296 212248  38998]
 [ 40972 193656  57105]]
testing model out of sample: results/universal/W2/deepOF_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 181s - 181s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1601324
{'0': {'precision': 0.43980945824404, 'recall': 0.15504626084886974, 'f1-score': 0.22926840844932642, 'support': 1277322}, '1': {'precision': 0.32465273403950756, 'recall': 0.7861304214002679, 'f1-score': 0.459530538196147, 'support': 1081893}, '2': {'precision': 0.44718207765522583, 'recall': 0.20406763171963443, 'f1-score': 0.2802469965696088, 'support': 1307493}, 'accuracy': 0.3587332288254205, 'macro avg': {'precision': 0.4038814233129244, 'recall': 0.38174810465625736, 'f1-score': 0.3230153144050274, 'support': 3666708}, 'weighted avg': {'precision': 0.4084604646650518, 'recall': 0.3587332288254205, 'f1-score': 0.3153873831414288, 'support': 3666708}}
[[198044 882611 196667]
 [ 98205 850509 133179]
 [154046 886630 266817]]
Evaluating performance on  train set...
5373/5373 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1366262
{'0': {'precision': 0.4812084582301577, 'recall': 0.12920037353663524, 'f1-score': 0.2037071199391744, 'support': 457251}, '1': {'precision': 0.36403766755274025, 'recall': 0.8404159938719463, 'f1-score': 0.5080196739512204, 'support': 459526}, '2': {'precision': 0.4394384607340793, 'recall': 0.18346426957658735, 'f1-score': 0.25885664743266945, 'support': 458111}, 'accuracy': 0.3849891773002601, 'macro avg': {'precision': 0.42822819550565905, 'recall': 0.3843602123283896, 'f1-score': 0.32352781377435474, 'support': 1374888}, 'weighted avg': {'precision': 0.4281289927902404, 'recall': 0.3849891773002601, 'f1-score': 0.32379263663908886, 'support': 1374888}}
[[ 59077 336141  62033]
 [ 28153 386193  45180]
 [ 35538 338526  84047]]
Evaluating performance on  val set...
1685/1685 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1386685
{'0': {'precision': 0.46319805448338947, 'recall': 0.14197011659315487, 'f1-score': 0.21732895067414792, 'support': 146235}, '1': {'precision': 0.3551412025896198, 'recall': 0.8221615210437407, 'f1-score': 0.4960209900904223, 'support': 139115}, '2': {'precision': 0.44134936435032057, 'recall': 0.19374617221423213, 'f1-score': 0.2692815333409847, 'support': 145319}, 'accuracy': 0.37915661447654697, 'macro avg': {'precision': 0.4198962071411099, 'recall': 0.38595926995037594, 'f1-score': 0.32754382470185167, 'support': 430669}, 'weighted avg': {'precision': 0.4209211347314472, 'recall': 0.37915661447654697, 'f1-score': 0.3248824091862699, 'support': 430669}}
[[ 20761 104584  20890]
 [  9992 114375  14748]
 [ 14068 103096  28155]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.128089
{'0': {'precision': 0.30455874426277707, 'recall': 0.2525326399046536, 'f1-score': 0.27611636395945477, 'support': 73836}, '1': {'precision': 0.4442880332775326, 'recall': 0.35999958895945083, 'f1-score': 0.3977271437167217, 'support': 97314}, '2': {'precision': 0.33355868878708356, 'recall': 0.4609909023850504, 'f1-score': 0.3870558179143764, 'support': 81340}, 'accuracy': 0.3611073705889342, 'macro avg': {'precision': 0.3608018221091311, 'recall': 0.3578410437497183, 'f1-score': 0.35363310853018426, 'support': 252490}, 'weighted avg': {'precision': 0.3677551937015232, 'recall': 0.3611073705889342, 'f1-score': 0.3587265529015594, 'support': 252490}}
[[18646 20502 34688]
 [22051 35033 40230]
 [20526 23317 37497]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1444366
{'0': {'precision': 0.32935189766061207, 'recall': 0.23633228522162492, 'f1-score': 0.275194141789943, 'support': 19718}, '1': {'precision': 0.3355656007589709, 'recall': 0.3012223224125839, 'f1-score': 0.3174678598769832, 'support': 19962}, '2': {'precision': 0.34337899543378997, 'recall': 0.4686930674081887, 'f1-score': 0.39636717482971134, 'support': 20858}, 'accuracy': 0.3377878357395355, 'macro avg': {'precision': 0.33609883128445767, 'recall': 0.3354158916807992, 'f1-score': 0.32967639216554584, 'support': 60538}, 'weighted avg': {'precision': 0.3362337759288466, 'recall': 0.3377878357395355, 'f1-score': 0.33088304931244106, 'support': 60538}}
[[4660 5799 9259]
 [4514 6013 9435]
 [4975 6107 9776]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1334062
{'0': {'precision': 0.3275, 'recall': 0.22865454545454544, 'f1-score': 0.2692933618843683, 'support': 6875}, '1': {'precision': 0.37722758808325396, 'recall': 0.36845601913366993, 'f1-score': 0.3727902130805942, 'support': 7526}, '2': {'precision': 0.34416684310819395, 'recall': 0.4517787659811006, 'f1-score': 0.39069823338541043, 'support': 7196}, 'accuracy': 0.351715516043895, 'macro avg': {'precision': 0.349631477063816, 'recall': 0.34962977685643865, 'f1-score': 0.3442606027834576, 'support': 21597}, 'weighted avg': {'precision': 0.3503820869065672, 'recall': 0.351715516043895, 'f1-score': 0.34581078362925394, 'support': 21597}}
[[1572 2292 3011]
 [1569 2773 3184]
 [1659 2286 3251]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1039202
{'0': {'precision': 0.5477186757272453, 'recall': 0.15606638687523847, 'f1-score': 0.24291642232004337, 'support': 104840}, '1': {'precision': 0.3618766417560936, 'recall': 0.8953477827151537, 'f1-score': 0.5154297713377495, 'support': 99243}, '2': {'precision': 0.5411317727015291, 'recall': 0.20166034948245992, 'f1-score': 0.2938233164837558, 'support': 113711}, 'accuracy': 0.4032486453488738, 'macro avg': {'precision': 0.4835756967282894, 'recall': 0.41769150635761737, 'f1-score': 0.3507231700471829, 'support': 317794}, 'weighted avg': {'precision': 0.4873257032124835, 'recall': 0.4032486453488738, 'f1-score': 0.3462340310188045, 'support': 317794}}
[[16362 75455 13023]
 [ 3964 88857  6422]
 [ 9547 81233 22931]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0418726
{'0': {'precision': 0.645024763619991, 'recall': 0.1725733008890067, 'f1-score': 0.27229529384931195, 'support': 41507}, '1': {'precision': 0.429926664765042, 'recall': 0.9142924232936757, 'f1-score': 0.5848431935812946, 'support': 51104}, '2': {'precision': 0.5671888426201335, 'recall': 0.20285092903408822, 'f1-score': 0.29882815900820114, 'support': 42302}, 'accuracy': 0.4630243193761906, 'macro avg': {'precision': 0.5473800903350555, 'recall': 0.42990555107225686, 'f1-score': 0.38532221547960255, 'support': 134913}, 'weighted avg': {'precision': 0.5391417992353928, 'recall': 0.4630243193761906, 'f1-score': 0.3990054042897778, 'support': 134913}}
[[ 7163 30604  3740]
 [ 1572 46724  2808]
 [ 2370 31351  8581]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0644153
{'0': {'precision': 0.5956924754634678, 'recall': 0.15832186073472937, 'f1-score': 0.2501574217184727, 'support': 13801}, '1': {'precision': 0.40403851547162756, 'recall': 0.9037429427754932, 'f1-score': 0.558421981997502, 'support': 14347}, '2': {'precision': 0.5398138572905895, 'recall': 0.20970592961594087, 'f1-score': 0.302065852670563, 'support': 12446}, 'accuracy': 0.4375277134551904, 'macro avg': {'precision': 0.5131816160752283, 'recall': 0.42392357770872113, 'f1-score': 0.3702150854621793, 'support': 40594}, 'weighted avg': {'precision': 0.5108246465778548, 'recall': 0.4375277134551904, 'f1-score': 0.3750212926834663, 'support': 40594}}
[[ 2185 10257  1359]
 [  515 12966   866]
 [  968  8868  2610]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1992266
{'0': {'precision': 0.3427783631105831, 'recall': 0.16757076634776605, 'f1-score': 0.22509936699543648, 'support': 91251}, '1': {'precision': 0.3007670518637355, 'recall': 0.5970591162420382, 'f1-score': 0.40002333761189546, 'support': 80384}, '2': {'precision': 0.3850943207619918, 'recall': 0.26290544295282386, 'f1-score': 0.3124797219003477, 'support': 102573}, 'accuracy': 0.3291370054848874, 'macro avg': {'precision': 0.3428799119121034, 'recall': 0.342511775180876, 'f1-score': 0.31253414216922654, 'support': 274208}, 'weighted avg': {'precision': 0.3462918910926673, 'recall': 0.3291370054848874, 'f1-score': 0.30906465465186844, 'support': 274208}}
[[15291 52074 23886]
 [13216 47994 19174]
 [16102 59504 26967]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1994896
{'0': {'precision': 0.3630150554675119, 'recall': 0.14820655910065106, 'f1-score': 0.21048097631012205, 'support': 24729}, '1': {'precision': 0.32753523842166143, 'recall': 0.634176690170054, 'f1-score': 0.4319697140919878, 'support': 24110}, '2': {'precision': 0.3445709012611504, 'recall': 0.2315036785979995, 'f1-score': 0.2769413335311133, 'support': 24194}, 'accuracy': 0.33623156655210656, 'macro avg': {'precision': 0.3450403983834412, 'recall': 0.3379623092895682, 'f1-score': 0.30646400797774104, 'support': 73033}, 'weighted avg': {'precision': 0.34519220475832335, 'recall': 0.33623156655210656, 'f1-score': 0.30561653626966695, 'support': 73033}}
[[ 3665 15684  5380]
 [ 3546 15290  5274]
 [ 2885 15708  5601]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1854907
{'0': {'precision': 0.3456876456876457, 'recall': 0.15577731092436975, 'f1-score': 0.21477190441708904, 'support': 9520}, '1': {'precision': 0.3518057285180573, 'recall': 0.6528647087144921, 'f1-score': 0.45722763597127153, 'support': 10385}, '2': {'precision': 0.35216904113974706, 'recall': 0.22213247172859452, 'f1-score': 0.27242895176769244, 'support': 9904}, 'accuracy': 0.3510013754235298, 'macro avg': {'precision': 0.34988747178181673, 'recall': 0.34359149712248543, 'f1-score': 0.31480949738535097, 'support': 29809}, 'weighted avg': {'precision': 0.34997252712450827, 'recall': 0.3510013754235298, 'f1-score': 0.3183962517333546, 'support': 29809}}
[[1483 6071 1966]
 [1524 6780 2081]
 [1283 6421 2200]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.125557
{'0': {'precision': 0.3049170036374379, 'recall': 0.22507836990595612, 'f1-score': 0.25898423103764634, 'support': 73370}, '1': {'precision': 0.33638693334118824, 'recall': 0.3496310810397085, 'f1-score': 0.3428811625532937, 'support': 65326}, '2': {'precision': 0.3804785353793343, 'recall': 0.45840257006757507, 'f1-score': 0.41582135380321, 'support': 81243}, 'accuracy': 0.3482601994189298, 'macro avg': {'precision': 0.3405941574526535, 'recall': 0.3443706736710799, 'f1-score': 0.33922891579805, 'support': 219939}, 'weighted avg': {'precision': 0.3421757442479439, 'recall': 0.3482601994189298, 'f1-score': 0.34183706438250044, 'support': 219939}}
[[16514 22810 34046]
 [15892 22840 26594]
 [21753 22248 37242]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1383114
{'0': {'precision': 0.32711174922230196, 'recall': 0.24588984422779436, 'f1-score': 0.28074427010597225, 'support': 27797}, '1': {'precision': 0.3332093253968254, 'recall': 0.30069382273948075, 'f1-score': 0.3161176470588235, 'support': 26808}, '2': {'precision': 0.32338634748865935, 'recall': 0.437066036342148, 'f1-score': 0.3717292288361866, 'support': 27076}, 'accuracy': 0.3272486869651449, 'macro avg': {'precision': 0.3279024740359289, 'recall': 0.3278832344364744, 'f1-score': 0.3228637153336608, 'support': 81681}, 'weighted avg': {'precision': 0.327878082209735, 'recall': 0.3272486869651449, 'f1-score': 0.32251406028889507, 'support': 81681}}
[[ 6835  8264 12698]
 [ 6685  8061 12062]
 [ 7375  7867 11834]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1381487
{'0': {'precision': 0.3198162205353576, 'recall': 0.1891317188422918, 'f1-score': 0.23769579095835497, 'support': 8465}, '1': {'precision': 0.3399894902785076, 'recall': 0.3170014698677119, 'f1-score': 0.3280933062880324, 'support': 8164}, '2': {'precision': 0.3265818682654136, 'recall': 0.4837974075852136, 'f1-score': 0.3899395405078597, 'support': 8332}, 'accuracy': 0.3293137294178919, 'macro avg': {'precision': 0.32879585969309294, 'recall': 0.3299768654317391, 'f1-score': 0.31857621258474905, 'support': 24961}, 'weighted avg': {'precision': 0.32867267464656724, 'recall': 0.3293137294178919, 'f1-score': 0.31808120165496007, 'support': 24961}}
[[1601 2630 4234]
 [1498 2588 4078]
 [1907 2394 4031]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2021692
{'0': {'precision': 0.36143397476601974, 'recall': 0.16012206532574197, 'f1-score': 0.22192650480375994, 'support': 163519}, '1': {'precision': 0.31252259773726804, 'recall': 0.6187324704397114, 'f1-score': 0.41528445980917356, 'support': 153669}, '2': {'precision': 0.3798371571380632, 'recall': 0.2490186769797251, 'f1-score': 0.30082108237400507, 'support': 172726}, 'accuracy': 0.33531395306114953, 'macro avg': {'precision': 0.351264576547117, 'recall': 0.3426244042483928, 'f1-score': 0.3126773489956462, 'support': 489914}, 'weighted avg': {'precision': 0.35258047329793013, 'recall': 0.33531395306114953, 'f1-score': 0.31039155865632406, 'support': 489914}}
[[ 26183 102243  35093]
 [ 23456  95080  35133]
 [ 22803 106911  43012]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1972725
{'0': {'precision': 0.36278130905342726, 'recall': 0.13802738651589921, 'f1-score': 0.19997159158163869, 'support': 61198}, '1': {'precision': 0.33676518869592303, 'recall': 0.6493945001785656, 'f1-score': 0.44352545304366625, 'support': 61602}, '2': {'precision': 0.3607900512070227, 'recall': 0.24544233034188742, 'f1-score': 0.2921425962307366, 'support': 60283}, 'accuracy': 0.3454553399277923, 'macro avg': {'precision': 0.353445516318791, 'recall': 0.3442880723454507, 'f1-score': 0.3118798802853472, 'support': 183083}, 'weighted avg': {'precision': 0.35337200265677776, 'recall': 0.3454553399277923, 'f1-score': 0.3122690175963172, 'support': 183083}}
[[ 8447 39976 12775]
 [ 8159 40004 13439]
 [ 6678 38809 14796]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1944724
{'0': {'precision': 0.3948021264028352, 'recall': 0.17152535413672756, 'f1-score': 0.23914988013882432, 'support': 19484}, '1': {'precision': 0.29184791112501957, 'recall': 0.5888369743654501, 'f1-score': 0.39026635699788675, 'support': 15838}, '2': {'precision': 0.372558662357735, 'recall': 0.2743120215187254, 'f1-score': 0.31597449800393257, 'support': 19332}, 'accuracy': 0.3288139934862956, 'macro avg': {'precision': 0.35306956662852995, 'recall': 0.3448914500069677, 'f1-score': 0.3151302450468812, 'support': 54654}, 'weighted avg': {'precision': 0.3570994969797386, 'recall': 0.3288139934862956, 'f1-score': 0.310115523514645, 'support': 54654}}
[[ 3342 11260  4882]
 [ 2463  9326  4049]
 [ 2660 11369  5303]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/EXC
Evaluating performance on  test set...
4918/4918 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0856487
{'0': {'precision': 0.6637832258064517, 'recall': 0.1570857639804962, 'f1-score': 0.25405002854428116, 'support': 409356}, '1': {'precision': 0.3877193348692626, 'recall': 0.9527834647688957, 'f1-score': 0.5511552401596523, 'support': 428854}, '2': {'precision': 0.6778825249095669, 'recall': 0.17420071132412795, 'f1-score': 0.2771739027642492, 'support': 420624}, 'accuracy': 0.43387928829377026, 'macro avg': {'precision': 0.5764616951950937, 'recall': 0.42802331335783994, 'f1-score': 0.3607930571560609, 'support': 1258834}, 'weighted avg': {'precision': 0.5744461088410467, 'recall': 0.43387928829377026, 'f1-score': 0.36299307813779247, 'support': 1258834}}
[[ 64304 320765  24287]
 [  9718 408605  10531]
 [ 22853 324498  73273]]
Evaluating performance on  train set...
1403/1403 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0419003
{'0': {'precision': 0.6780114438582151, 'recall': 0.16506558118498418, 'f1-score': 0.2654949659547227, 'support': 110550}, '1': {'precision': 0.43306712584983525, 'recall': 0.9498737437685857, 'f1-score': 0.5949048164981716, 'support': 138211}, '2': {'precision': 0.6829420104429613, 'recall': 0.1791887061214491, 'f1-score': 0.28389081343701933, 'support': 110219}, 'accuracy': 0.4715610897543039, 'macro avg': {'precision': 0.5980068600503372, 'recall': 0.4313760103583397, 'f1-score': 0.38143019862997124, 'support': 358980}, 'weighted avg': {'precision': 0.5852192074721991, 'recall': 0.4715610897543039, 'f1-score': 0.3979693009235563, 'support': 358980}}
[[ 18248  86576   5726]
 [  3485 131283   3443]
 [  5181  85288  19750]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0715609
{'0': {'precision': 0.6693886559258442, 'recall': 0.15534328663986274, 'f1-score': 0.25216686412670697, 'support': 39049}, '1': {'precision': 0.4037063848269871, 'recall': 0.9520189374971548, 'f1-score': 0.5669822894285579, 'support': 43934}, '2': {'precision': 0.688824758682456, 'recall': 0.17421287091334658, 'f1-score': 0.27809248322686914, 'support': 39733}, 'accuracy': 0.446673620391799, 'macro avg': {'precision': 0.5873065998117624, 'recall': 0.4271916983501214, 'f1-score': 0.36574721226071133, 'support': 122716}, 'weighted avg': {'precision': 0.5805638064552884, 'recall': 0.446673620391799, 'f1-score': 0.37326927553938555, 'support': 122716}}
[[ 6066 30972  2011]
 [  992 41826  1116]
 [ 2004 30807  6922]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/AAL
Evaluating performance on  test set...
4856/4856 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1565729
{'0': {'precision': 0.5390311418685121, 'recall': 0.146385315736719, 'f1-score': 0.23024321350565746, 'support': 478880}, '1': {'precision': 0.29168337719847937, 'recall': 0.9165649285864315, 'f1-score': 0.44253611200902565, 'support': 304704}, '2': {'precision': 0.545008688936088, 'recall': 0.1843567391512597, 'f1-score': 0.2755162798567073, 'support': 459316}, 'accuracy': 0.3492316356907233, 'macro avg': {'precision': 0.45857440266769317, 'recall': 0.41576899449147003, 'f1-score': 0.3160985351237968, 'support': 1242900}, 'weighted avg': {'precision': 0.480601444968418, 'recall': 0.3492316356907233, 'f1-score': 0.29901876993792803, 'support': 1242900}}
[[ 70101 351072  57707]
 [ 12438 279281  12985]
 [ 47511 327127  84678]]
Evaluating performance on  train set...
2076/2076 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017827
{'0': {'precision': 0.6247429641223952, 'recall': 0.11615539121701816, 'f1-score': 0.1958899297987307, 'support': 175248}, '1': {'precision': 0.37550889988246705, 'recall': 0.9389747171392653, 'f1-score': 0.5364743363622868, 'support': 178975}, '2': {'precision': 0.5456884955062095, 'recall': 0.1579686997353079, 'f1-score': 0.24501050420168066, 'support': 177187}, 'accuracy': 0.407216650044222, 'macro avg': {'precision': 0.5153134531703573, 'recall': 0.4043662693638637, 'f1-score': 0.32579159012089937, 'support': 531410}, 'weighted avg': {'precision': 0.5144437774717163, 'recall': 0.407216650044222, 'f1-score': 0.32697444341617854, 'support': 531410}}
[[ 20356 138217  16675]
 [  4294 168053   6628]
 [  7933 141264  27990]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101443
{'0': {'precision': 0.6202365308804205, 'recall': 0.1305206605040689, 'f1-score': 0.21565875787343758, 'support': 50628}, '1': {'precision': 0.3723772229094605, 'recall': 0.9466778839412695, 'f1-score': 0.5345057679258086, 'support': 49923}, '2': {'precision': 0.585995761048748, 'recall': 0.15002311139693322, 'f1-score': 0.23888764440462093, 'support': 49759}, 'accuracy': 0.4080500299381279, 'macro avg': {'precision': 0.5262031716128763, 'recall': 0.4090738852807572, 'f1-score': 0.32968405673462237, 'support': 150310}, 'weighted avg': {'precision': 0.5265789785027449, 'recall': 0.4080500299381279, 'f1-score': 0.32924830911919417, 'support': 150310}}
[[ 6608 40211  3809]
 [ 1197 47261  1465]
 [ 2849 39445  7465]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/WBA
Evaluating performance on  test set...
4353/4353 - 56s - 56s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964024
{'0': {'precision': 0.5851255811978514, 'recall': 0.14688247802891816, 'f1-score': 0.23481898659759556, 'support': 375266}, '1': {'precision': 0.38618365233135954, 'recall': 0.9036778268548932, 'f1-score': 0.5411210573182734, 'support': 383297}, '2': {'precision': 0.50680426768866, 'recall': 0.17546665917013382, 'f1-score': 0.2606801732382778, 'support': 355720}, 'accuracy': 0.41633409107022185, 'macro avg': {'precision': 0.492704500405957, 'recall': 0.4086756546846484, 'f1-score': 0.34554007238471557, 'support': 1114283}, 'weighted avg': {'precision': 0.4916894414108949, 'recall': 0.41633409107022185, 'f1-score': 0.34843824320731426, 'support': 1114283}}
[[ 55120 280137  40009]
 [ 16188 346377  20732]
 [ 22894 270409  62417]]
Evaluating performance on  train set...
1542/1542 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1275133
{'0': {'precision': 0.5244749574289808, 'recall': 0.14374185136897003, 'f1-score': 0.2256423375913576, 'support': 134992}, '1': {'precision': 0.3623092172373309, 'recall': 0.8804518135684385, 'f1-score': 0.5133662860064769, 'support': 128283}, '2': {'precision': 0.4993780415948323, 'recall': 0.1742975313625873, 'f1-score': 0.2584043814578511, 'support': 131287}, 'accuracy': 0.39343373158084155, 'macro avg': {'precision': 0.462054072087048, 'recall': 0.399497065433332, 'f1-score': 0.3324710016852286, 'support': 394562}, 'weighted avg': {'precision': 0.46339962215056246, 'recall': 0.39343373158084155, 'f1-score': 0.33009061625893604, 'support': 394562}}
[[ 19404 100825  14763]
 [  7159 112947   8177]
 [ 10434  97970  22883]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1255139
{'0': {'precision': 0.5266431489045674, 'recall': 0.13744397334948516, 'f1-score': 0.21799527350279557, 'support': 41275}, '1': {'precision': 0.36649700146147257, 'recall': 0.8898950099116517, 'f1-score': 0.5191753048345185, 'support': 40861}, '2': {'precision': 0.48896562077766104, 'recall': 0.15821047774026667, 'f1-score': 0.23906780438572345, 'support': 41173}, 'accuracy': 0.3937182200812593, 'macro avg': {'precision': 0.46070192371456703, 'recall': 0.39518315366713447, 'f1-score': 0.3254127942410125, 'support': 123309}, 'weighted avg': {'precision': 0.46099482967205874, 'recall': 0.3937182200812593, 'f1-score': 0.3248336760061677, 'support': 123309}}
[[ 5673 31325  4277]
 [ 1968 36362  2531]
 [ 3131 31528  6514]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1468785
{'0': {'precision': 0.47719298245614034, 'recall': 0.14357350224333598, 'f1-score': 0.22073442889024147, 'support': 469836}, '1': {'precision': 0.35108513310948286, 'recall': 0.8820740116010426, 'f1-score': 0.5022597011970638, 'support': 445822}, '2': {'precision': 0.5131086913265132, 'recall': 0.15213879700043537, 'f1-score': 0.23469081927752433, 'support': 491538}, 'accuracy': 0.38053405495751835, 'macro avg': {'precision': 0.44712893563071204, 'recall': 0.3925954369482713, 'f1-score': 0.3192283164549432, 'support': 1407196}, 'weighted avg': {'precision': 0.4497854870505961, 'recall': 0.38053405495751835, 'f1-score': 0.31480110913134246, 'support': 1407196}}
[[ 67456 357062  45318]
 [ 26931 393248  25643]
 [ 46973 369783  74782]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1411406
{'0': {'precision': 0.5116268210683601, 'recall': 0.12425861032672178, 'f1-score': 0.19995437748072448, 'support': 176358}, '1': {'precision': 0.36476841412018773, 'recall': 0.8963156961750258, 'f1-score': 0.5185183959985974, 'support': 174877}, '2': {'precision': 0.4772203901917798, 'recall': 0.1475263256809937, 'f1-score': 0.22537956236133466, 'support': 175589}, 'accuracy': 0.3882947625772554, 'macro avg': {'precision': 0.4512052084601092, 'recall': 0.38936687739424714, 'f1-score': 0.31461744528021884, 'support': 526824}, 'weighted avg': {'precision': 0.4514102242104656, 'recall': 0.3882947625772554, 'f1-score': 0.3141745015721697, 'support': 526824}}
[[ 21914 136365  18079]
 [  7834 156745  10298]
 [ 13084 136601  25904]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1444064
{'0': {'precision': 0.4775527375443236, 'recall': 0.13303643182427002, 'f1-score': 0.20810035748425365, 'support': 59728}, '1': {'precision': 0.35320224101944414, 'recall': 0.8698663492235269, 'f1-score': 0.502406400400025, 'support': 55443}, '2': {'precision': 0.47520719867392847, 'recall': 0.1696996346908402, 'f1-score': 0.2500903505601734, 'support': 59128}, 'accuracy': 0.3798530112048836, 'macro avg': {'precision': 0.4353207257458987, 'recall': 0.390867471912879, 'f1-score': 0.32019903614815076, 'support': 174299}, 'weighted avg': {'precision': 0.43720223868226693, 'recall': 0.3798530112048836, 'f1-score': 0.31596095477954567, 'support': 174299}}
[[ 7946 44704  7078]
 [ 3212 48228  4003]
 [ 5481 43613 10034]]
testing model on single stock: results/universal/W2/deepOF_L2/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 186s - 186s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1501611
{'0': {'precision': 0.36055083291789947, 'recall': 0.23603549077000932, 'f1-score': 0.2852991743734029, 'support': 1179687}, '1': {'precision': 0.3770542882664672, 'recall': 0.6450632925768035, 'f1-score': 0.4759215284580179, 'support': 1408854}, '2': {'precision': 0.35355768587031716, 'recall': 0.18160433551970642, 'f1-score': 0.23995577430398354, 'support': 1221353}, 'accuracy': 0.36983994830302364, 'macro avg': {'precision': 0.36372093568489455, 'recall': 0.3542343729555064, 'f1-score': 0.3337254923784681, 'support': 3809894}, 'weighted avg': {'precision': 0.3644117954422231, 'recall': 0.36983994830302364, 'f1-score': 0.34125316373282877, 'support': 3809894}}
[[278448 725162 176077]
 [270588 908800 229466]
 [223249 776301 221803]]
Evaluating performance on  train set...
6147/6147 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1794448
{'0': {'precision': 0.3677172706611934, 'recall': 0.20111193548076275, 'f1-score': 0.2600159457843333, 'support': 518915}, '1': {'precision': 0.33680931958632365, 'recall': 0.6558079519302064, 'f1-score': 0.4450501445163196, 'support': 519245}, '2': {'precision': 0.3698563769083353, 'recall': 0.1925174147197113, 'f1-score': 0.2532258599528974, 'support': 535323}, 'accuracy': 0.3482363648034329, 'macro avg': {'precision': 0.35812765571861743, 'recall': 0.34981243404356016, 'f1-score': 0.31943065008451677, 'support': 1573483}, 'weighted avg': {'precision': 0.35824548972531295, 'recall': 0.3482363648034329, 'f1-score': 0.3187666239950598, 'support': 1573483}}
[[104360 325132  89423]
 [ 92556 340525  86164]
 [ 86889 345375 103059]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1638256
{'0': {'precision': 0.38774798548607514, 'recall': 0.22212743901780604, 'f1-score': 0.2824493774950828, 'support': 185218}, '1': {'precision': 0.3397114115292211, 'recall': 0.6545774570173696, 'f1-score': 0.44728939227415054, 'support': 181236}, '2': {'precision': 0.36990146371354304, 'recall': 0.19693342243316198, 'f1-score': 0.25702709198914947, 'support': 190049}, 'accuracy': 0.35435927569123615, 'macro avg': {'precision': 0.3657869535762798, 'recall': 0.35787943948944584, 'f1-score': 0.32892195391946094, 'support': 556503}, 'weighted avg': {'precision': 0.3660092524801572, 'recall': 0.35435927569123615, 'f1-score': 0.32745086891630065, 'support': 556503}}
[[ 41142 110661  33415]
 [ 32264 118633  30339]
 [ 32699 119923  37427]]
training model: results/universal/W2/deepOF_L2/h200
Epoch 1/50
9940/9940 - 277s - loss: 3.2387 - accuracy200: 0.4001 - val_loss: 3.2981 - val_accuracy200: 0.3559 - 277s/epoch - 28ms/step
Epoch 2/50
9940/9940 - 276s - loss: 3.2170 - accuracy200: 0.4108 - val_loss: 3.3098 - val_accuracy200: 0.3578 - 276s/epoch - 28ms/step
Epoch 3/50
9940/9940 - 277s - loss: 3.2068 - accuracy200: 0.4156 - val_loss: 3.3216 - val_accuracy200: 0.3592 - 277s/epoch - 28ms/step
Epoch 4/50
9940/9940 - 278s - loss: 3.2011 - accuracy200: 0.4185 - val_loss: 3.3288 - val_accuracy200: 0.3601 - 278s/epoch - 28ms/step
Epoch 5/50
9940/9940 - 276s - loss: 3.1969 - accuracy200: 0.4202 - val_loss: 3.3327 - val_accuracy200: 0.3596 - 276s/epoch - 28ms/step
Epoch 6/50
9940/9940 - 276s - loss: 3.1940 - accuracy200: 0.4215 - val_loss: 3.3328 - val_accuracy200: 0.3598 - 276s/epoch - 28ms/step
Epoch 7/50
9940/9940 - 277s - loss: 3.1912 - accuracy200: 0.4228 - val_loss: 3.3395 - val_accuracy200: 0.3590 - 277s/epoch - 28ms/step
Epoch 8/50
9940/9940 - 279s - loss: 3.1891 - accuracy200: 0.4236 - val_loss: 3.3426 - val_accuracy200: 0.3607 - 279s/epoch - 28ms/step
Epoch 9/50
9940/9940 - 275s - loss: 3.1872 - accuracy200: 0.4246 - val_loss: 3.3493 - val_accuracy200: 0.3612 - 275s/epoch - 28ms/step
Epoch 10/50
9940/9940 - 279s - loss: 3.1852 - accuracy200: 0.4256 - val_loss: 3.3609 - val_accuracy200: 0.3598 - 279s/epoch - 28ms/step
Epoch 11/50
9940/9940 - 278s - loss: 3.1832 - accuracy200: 0.4263 - val_loss: 3.3574 - val_accuracy200: 0.3619 - 278s/epoch - 28ms/step
testing model in sample: results/universal/W2/deepOF_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 335s - 335s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918058
{'0': {'precision': 0.3697651408040298, 'recall': 0.28100965889615914, 'f1-score': 0.3193349715966283, 'support': 2077256}, '1': {'precision': 0.3772536048789227, 'recall': 0.6519136259049816, 'f1-score': 0.4779335332218394, 'support': 2539002}, '2': {'precision': 0.3991452085293611, 'recall': 0.14311475581210803, 'f1-score': 0.2106870239687505, 'support': 2104486}, 'accuracy': 0.37795250049696877, 'macro avg': {'precision': 0.38205465140410455, 'recall': 0.35867934687108294, 'f1-score': 0.33598517626240615, 'support': 6720744}, 'weighted avg': {'precision': 0.3817940421384792, 'recall': 0.37795250049696877, 'f1-score': 0.3452300184027457, 'support': 6720744}}
[[ 583729 1322859  170668]
 [ 601073 1655210  282719]
 [ 393846 1409457  301183]]
Evaluating performance on  train set...
9940/9940 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042424
{'0': {'precision': 0.3874366606397124, 'recall': 0.26427008063114354, 'f1-score': 0.31421469523871115, 'support': 845703}, '1': {'precision': 0.3272521996872593, 'recall': 0.6683591999771205, 'f1-score': 0.4393722660215835, 'support': 839176}, '2': {'precision': 0.41591468092342004, 'recall': 0.12248061112793163, 'f1-score': 0.18923450872865513, 'support': 858740}, 'accuracy': 0.3497158969169518, 'macro avg': {'precision': 0.3768678470834639, 'recall': 0.35170329724539856, 'f1-score': 0.3142738233296499, 'support': 2543619}, 'weighted avg': {'precision': 0.3771952919182943, 'recall': 0.3497158969169518, 'f1-score': 0.31331194378719357, 'support': 2543619}}
[[223494 559410  62799]
 [193397 560871  84908]
 [159962 593599 105179]]
Evaluating performance on  val set...
3393/3393 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003413
{'0': {'precision': 0.37983062201913753, 'recall': 0.26783045207140643, 'f1-score': 0.31414643021058597, 'support': 283672}, '1': {'precision': 0.33851462022986983, 'recall': 0.6528338446633296, 'f1-score': 0.4458448443216606, 'support': 297264}, '2': {'precision': 0.41036760361272895, 'recall': 0.13544630450605438, 'f1-score': 0.203669326015977, 'support': 287147}, 'accuracy': 0.3558795645116884, 'macro avg': {'precision': 0.3762376152872455, 'recall': 0.35203686708026344, 'f1-score': 0.32122020018274117, 'support': 868083}, 'weighted avg': {'precision': 0.37578359275784584, 'recall': 0.3558795645116884, 'f1-score': 0.32270094439200075, 'support': 868083}}
[[ 75976 184921  22775]
 [ 70092 194064  33108]
 [ 53958 194296  38893]]
testing model out of sample: results/universal/W2/deepOF_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 189s - 189s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105969
{'0': {'precision': 0.40829879028846966, 'recall': 0.2487101366192375, 'f1-score': 0.3091222775071352, 'support': 1241992}, '1': {'precision': 0.3100361669746324, 'recall': 0.6860639853603376, 'f1-score': 0.4270748233937239, 'support': 1139917}, '2': {'precision': 0.4377774395984493, 'recall': 0.13210237554668083, 'f1-score': 0.20296012666099053, 'support': 1284799}, 'accuracy': 0.3438171242433267, 'macro avg': {'precision': 0.38537079895385046, 'recall': 0.35562549917541864, 'f1-score': 0.3130524091872832, 'support': 3666708}, 'weighted avg': {'precision': 0.3880798103137275, 'recall': 0.3438171242433267, 'f1-score': 0.3085929435662887, 'support': 3666708}}
[[308896 835331  97765]
 [237654 782056 120207]
 [209994 905080 169725]]
Evaluating performance on  train set...
5373/5373 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978638
{'0': {'precision': 0.4102853315387556, 'recall': 0.2817674283370907, 'f1-score': 0.3340931485421581, 'support': 460873}, '1': {'precision': 0.333822133089599, 'recall': 0.6587198574652363, 'f1-score': 0.44309514362127767, 'support': 456871}, '2': {'precision': 0.41696259507430616, 'recall': 0.1430643298391754, 'f1-score': 0.21303430809697146, 'support': 457144}, 'accuracy': 0.3609093977109408, 'macro avg': {'precision': 0.38702335323422027, 'recall': 0.3611838718805008, 'f1-score': 0.3300742000868024, 'support': 1374888}, 'weighted avg': {'precision': 0.38709700857938084, 'recall': 0.3609093977109408, 'f1-score': 0.330062658740311, 'support': 1374888}}
[[129859 291752  39262]
 [103733 300950  52188]
 [ 82917 308826  65401]]
Evaluating performance on  val set...
1685/1685 - 23s - 23s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0979558
{'0': {'precision': 0.40747341590664704, 'recall': 0.2828949642276985, 'f1-score': 0.33394396595689124, 'support': 144665}, '1': {'precision': 0.332431330129626, 'recall': 0.6573626666479652, 'f1-score': 0.4415624793902335, 'support': 142591}, '2': {'precision': 0.4192425623601558, 'recall': 0.14110296835014957, 'f1-score': 0.21114247108477105, 'support': 143413}, 'accuracy': 0.359661364063817, 'macro avg': {'precision': 0.3863824361321429, 'recall': 0.360453533075271, 'f1-score': 0.3288829721439653, 'support': 430669}, 'weighted avg': {'precision': 0.3865467240558425, 'recall': 0.359661364063817, 'f1-score': 0.3286826182975016, 'support': 430669}}
[[40925 91478 12262]
 [33087 93734 15770]
 [26424 96753 20236]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189723
{'0': {'precision': 0.28472793029755056, 'recall': 0.10711326052270281, 'f1-score': 0.15566580385389706, 'support': 80849}, '1': {'precision': 0.3241912210112631, 'recall': 0.7825952564940855, 'f1-score': 0.4584633385335413, 'support': 84115}, '2': {'precision': 0.359268215750184, 'recall': 0.0780796563306903, 'f1-score': 0.1282802117355558, 'support': 87526}, 'accuracy': 0.3220800823795002, 'macro avg': {'precision': 0.3227291223529992, 'recall': 0.32259605778249284, 'f1-score': 0.24746978470766476, 'support': 252490}, 'weighted avg': {'precision': 0.32371429697706705, 'recall': 0.3220800823795002, 'f1-score': 0.24704709932630525, 'support': 252490}}
[[ 8660 66041  6148]
 [12247 65828  6040]
 [ 9508 71184  6834]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192763
{'0': {'precision': 0.33395710378580684, 'recall': 0.11616844424415403, 'f1-score': 0.17237536221115982, 'support': 19971}, '1': {'precision': 0.3281556143575656, 'recall': 0.821999595223639, 'f1-score': 0.46905631505247497, 'support': 19764}, '2': {'precision': 0.34573947110675807, 'recall': 0.06787482574628659, 'f1-score': 0.11347289749668503, 'support': 20803}, 'accuracy': 0.33000759853315276, 'macro avg': {'precision': 0.3359507297500435, 'recall': 0.3353476217380265, 'f1-score': 0.25163485825343995, 'support': 60538}, 'weighted avg': {'precision': 0.3361119148188437, 'recall': 0.33000759853315276, 'f1-score': 0.2489926006151463, 'support': 60538}}
[[ 2320 16268  1383]
 [ 2229 16246  1289]
 [ 2398 16993  1412]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142317
{'0': {'precision': 0.3705640642510273, 'recall': 0.13281563797027715, 'f1-score': 0.195545042381234, 'support': 7469}, '1': {'precision': 0.31769452449567726, 'recall': 0.8107074569789675, 'f1-score': 0.4564992339227297, 'support': 6799}, '2': {'precision': 0.3503184713375796, 'recall': 0.0750443443853186, 'f1-score': 0.12360939431396786, 'support': 7329}, 'accuracy': 0.3266194378848914, 'macro avg': {'precision': 0.346192353361428, 'recall': 0.3395224797781878, 'f1-score': 0.25855122353931054, 'support': 21597}, 'weighted avg': {'precision': 0.3470496895110503, 'recall': 0.3266194378848914, 'f1-score': 0.2532850610692757, 'support': 21597}}
[[ 992 5954  523]
 [ 790 5512  497]
 [ 895 5884  550]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954337
{'0': {'precision': 0.409824519338838, 'recall': 0.27357575151302954, 'f1-score': 0.3281182511877909, 'support': 99965}, '1': {'precision': 0.34006217485663237, 'recall': 0.7012896382313533, 'f1-score': 0.45802403488248433, 'support': 107472}, '2': {'precision': 0.46646279306829763, 'recall': 0.12439627753563436, 'f1-score': 0.19641311423809085, 'support': 110357}, 'accuracy': 0.3664166095017527, 'macro avg': {'precision': 0.4054498290879227, 'recall': 0.36642055576000576, 'f1-score': 0.32751846676945534, 'support': 317794}, 'weighted avg': {'precision': 0.40590037756073766, 'recall': 0.3664166095017527, 'f1-score': 0.32631409688304647, 'support': 317794}}
[[27348 66854  5763]
 [22164 75369  9939]
 [17219 79410 13728]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0882627
{'0': {'precision': 0.44125780691669514, 'recall': 0.31793046320549845, 'f1-score': 0.3695770982433312, 'support': 44667}, '1': {'precision': 0.32778844596626794, 'recall': 0.6332350049164208, 'f1-score': 0.4319709742823605, 'support': 44748}, '2': {'precision': 0.45633750921149596, 'recall': 0.16332586047738362, 'f1-score': 0.24055550160240846, 'support': 45498}, 'accuracy': 0.37037201752240334, 'macro avg': {'precision': 0.4084612540314863, 'recall': 0.371497109533101, 'f1-score': 0.34736785804270004, 'support': 134913}, 'weighted avg': {'precision': 0.40870771412503776, 'recall': 0.37037201752240334, 'f1-score': 0.3467607392640318, 'support': 134913}}
[[14201 27232  3234]
 [10793 28336  5619]
 [ 7189 30878  7431]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0892866
{'0': {'precision': 0.4600726844121403, 'recall': 0.3156972433780414, 'f1-score': 0.3744503957150851, 'support': 14837}, '1': {'precision': 0.31787527468364024, 'recall': 0.638994668697639, 'f1-score': 0.42455217083291164, 'support': 13130}, '2': {'precision': 0.4346852450858423, 'recall': 0.1383543201077057, 'f1-score': 0.2099002763426649, 'support': 12627}, 'accuracy': 0.36510321722422034, 'macro avg': {'precision': 0.4042110680605409, 'recall': 0.36434874406112866, 'f1-score': 0.33630094763022056, 'support': 40594}, 'weighted avg': {'precision': 0.40618247437843163, 'recall': 0.36510321722422034, 'f1-score': 0.33947138280631806, 'support': 40594}}
[[4684 9229  924]
 [3392 8390 1348]
 [2105 8775 1747]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1283177
{'0': {'precision': 0.3419547730346677, 'recall': 0.15921293943478357, 'f1-score': 0.21726708730033095, 'support': 90514}, '1': {'precision': 0.29223750623994676, 'recall': 0.7738583371072569, 'f1-score': 0.42425909833617964, 'support': 81701}, '2': {'precision': 0.41948208945727555, 'recall': 0.0646416910964478, 'f1-score': 0.1120210687282304, 'support': 101993}, 'accuracy': 0.3071719278795659, 'macro avg': {'precision': 0.35122478957729664, 'recall': 0.3325709892128294, 'f1-score': 0.2511824181215803, 'support': 274208}, 'weighted avg': {'precision': 0.3559780443086479, 'recall': 0.3071719278795659, 'f1-score': 0.2397941365527803, 'support': 274208}}
[[14411 71790  4313]
 [13665 63225  4811]
 [14067 81333  6593]]
Evaluating performance on  train set...
286/286 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144001
{'0': {'precision': 0.3786531130876747, 'recall': 0.19033932135728543, 'f1-score': 0.2533340417618617, 'support': 25050}, '1': {'precision': 0.3227141828653708, 'recall': 0.7576589900697233, 'f1-score': 0.45263490059955824, 'support': 23665}, '2': {'precision': 0.3695963941815202, 'recall': 0.0741837322148203, 'f1-score': 0.12356587554368301, 'support': 24318}, 'accuracy': 0.3354921747703093, 'macro avg': {'precision': 0.35698789671152187, 'recall': 0.34072734788060965, 'f1-score': 0.27651160596836766, 'support': 73033}, 'weighted avg': {'precision': 0.35751149116237124, 'recall': 0.3354921747703093, 'f1-score': 0.2747045531512394, 'support': 73033}}
[[ 4768 18845  1437]
 [ 4095 17930  1640]
 [ 3729 18785  1804]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130626
{'0': {'precision': 0.35615906886517945, 'recall': 0.1874808536709895, 'f1-score': 0.24565159218624563, 'support': 9793}, '1': {'precision': 0.3285601681555439, 'recall': 0.7599513825584928, 'f1-score': 0.4587728148216088, 'support': 9873}, '2': {'precision': 0.4053905390539054, 'recall': 0.07266094843734595, 'f1-score': 0.12323384332413678, 'support': 10143}, 'accuracy': 0.3380187191787715, 'macro avg': {'precision': 0.3633699253582096, 'recall': 0.3400310615556094, 'f1-score': 0.27588608344399707, 'support': 29809}, 'weighted avg': {'precision': 0.36376988624979534, 'recall': 0.3380187191787715, 'f1-score': 0.2745845521772071, 'support': 29809}}
[[1836 7495  462]
 [1751 7503  619]
 [1568 7838  737]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1311351
{'0': {'precision': 0.2824254073653401, 'recall': 0.08946239535044627, 'f1-score': 0.1358821303964017, 'support': 72265}, '1': {'precision': 0.288231756442407, 'recall': 0.800624083967661, 'f1-score': 0.4238674715381695, 'support': 63453}, '2': {'precision': 0.39174761950562664, 'recall': 0.09672172023604564, 'f1-score': 0.15513974194162738, 'support': 84221}, 'accuracy': 0.29741428305120965, 'macro avg': {'precision': 0.32080159443779127, 'recall': 0.328936066518051, 'f1-score': 0.23829644795873287, 'support': 219939}, 'weighted avg': {'precision': 0.32596318964430926, 'recall': 0.29741428305120965, 'f1-score': 0.22634098104780523, 'support': 219939}}
[[ 6465 58367  7433]
 [ 7436 50802  5215]
 [ 8990 67085  8146]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1145763
{'0': {'precision': 0.32943446279995175, 'recall': 0.10023848835076132, 'f1-score': 0.15370766287836163, 'support': 27255}, '1': {'precision': 0.33417015771315917, 'recall': 0.7981533254855797, 'f1-score': 0.4711003995136356, 'support': 27184}, '2': {'precision': 0.3355791962174941, 'recall': 0.10421408119814991, 'f1-score': 0.1590387093160047, 'support': 27242}, 'accuracy': 0.3338352860518358, 'macro avg': {'precision': 0.33306127224353504, 'recall': 0.33420196501149696, 'f1-score': 0.2612822572360006, 'support': 81681}, 'weighted avg': {'precision': 0.33305990761920373, 'recall': 0.3338352860518358, 'f1-score': 0.26111614856961857, 'support': 81681}}
[[ 2732 21715  2808]
 [ 2674 21697  2813]
 [ 2887 21516  2839]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200535
{'0': {'precision': 0.32113821138211385, 'recall': 0.06538961806787277, 'f1-score': 0.10865507417231555, 'support': 8457}, '1': {'precision': 0.32741558506141527, 'recall': 0.8127391680039501, 'f1-score': 0.4667848280751507, 'support': 8101}, '2': {'precision': 0.3389776357827476, 'recall': 0.12626442937046292, 'f1-score': 0.18399375704500126, 'support': 8403}, 'accuracy': 0.32843235447297786, 'macro avg': {'precision': 0.3291771440754256, 'recall': 0.33479773848076194, 'f1-score': 0.2531445530974892, 'support': 24961}, 'weighted avg': {'precision': 0.32918106573148076, 'recall': 0.32843235447297786, 'f1-score': 0.25024716137018604, 'support': 24961}}
[[ 553 6846 1058]
 [ 506 6584 1011]
 [ 663 6679 1061]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1151115
{'0': {'precision': 0.37865224335315195, 'recall': 0.1741253001043036, 'f1-score': 0.23855142557581085, 'support': 162027}, '1': {'precision': 0.3175402775478456, 'recall': 0.7803011713654737, 'f1-score': 0.45138949849554266, 'support': 154862}, '2': {'precision': 0.41867003270411385, 'recall': 0.0843461927467129, 'f1-score': 0.14040590139645856, 'support': 173025}, 'accuracy': 0.3340300542544202, 'macro avg': {'precision': 0.37162085120170385, 'recall': 0.3462575547388301, 'f1-score': 0.2767822751559374, 'support': 489914}, 'weighted avg': {'precision': 0.3734679798985637, 'recall': 0.3340300542544202, 'f1-score': 0.27116715063646046, 'support': 489914}}
[[ 28213 124076   9738]
 [ 23497 120839  10526]
 [ 22799 135632  14594]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076139
{'0': {'precision': 0.39221145501880245, 'recall': 0.1745602600621188, 'f1-score': 0.24159474358260485, 'support': 62139}, '1': {'precision': 0.3311321555970783, 'recall': 0.7765660790757892, 'f1-score': 0.4642889041055108, 'support': 60246}, '2': {'precision': 0.3883584411910319, 'recall': 0.09046426570891956, 'f1-score': 0.14674559375709875, 'support': 60698}, 'accuracy': 0.3447780514848457, 'macro avg': {'precision': 0.3705673506023042, 'recall': 0.34719686828227586, 'f1-score': 0.2842097471484048, 'support': 183083}, 'weighted avg': {'precision': 0.3708350644949461, 'recall': 0.3447780514848457, 'f1-score': 0.2834297511952965, 'support': 183083}}
[[10847 47243  4049]
 [ 8862 46785  4599]
 [ 7947 47260  5491]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1168703
{'0': {'precision': 0.38127010604074824, 'recall': 0.16835902562213922, 'f1-score': 0.23357664233576647, 'support': 19007}, '1': {'precision': 0.3073159201040066, 'recall': 0.7731787094855783, 'f1-score': 0.4398173207036536, 'support': 16815}, '2': {'precision': 0.40091001011122346, 'recall': 0.08421835174171623, 'f1-score': 0.13919606810602073, 'support': 18832}, 'accuracy': 0.32544735975408934, 'macro avg': {'precision': 0.3631653454186594, 'recall': 0.3419186956164779, 'f1-score': 0.2708633437151469, 'support': 54654}, 'weighted avg': {'precision': 0.3652844332067174, 'recall': 0.32544735975408934, 'f1-score': 0.26450872476086706, 'support': 54654}}
[[ 3200 14641  1166]
 [ 2610 13001  1204]
 [ 2583 14663  1586]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/EXC
Evaluating performance on  test set...
4918/4918 - 66s - 66s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073148
{'0': {'precision': 0.4227712866795454, 'recall': 0.32622247362405793, 'f1-score': 0.3682740824487574, 'support': 431359}, '1': {'precision': 0.29730051152524567, 'recall': 0.5444304440711012, 'f1-score': 0.38458713781669435, 'support': 385704}, '2': {'precision': 0.4581045769486402, 'recall': 0.2277876999621976, 'f1-score': 0.30427690014317316, 'support': 441771}, 'accuracy': 0.3585365504903744, 'macro avg': {'precision': 0.3927254583844771, 'recall': 0.3661468725524523, 'f1-score': 0.3523793734695417, 'support': 1258834}, 'weighted avg': {'precision': 0.3967270609240878, 'recall': 0.3585365504903744, 'f1-score': 0.350813409701846, 'support': 1258834}}
[[140719 240098  50542]
 [107221 209989  68494]
 [ 84909 256232 100630]]
Evaluating performance on  train set...
1403/1403 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983244
{'0': {'precision': 0.4315610974594342, 'recall': 0.3499464800329354, 'f1-score': 0.3864921884946256, 'support': 121450}, '1': {'precision': 0.31786292766786245, 'recall': 0.5511332799214328, 'f1-score': 0.4031889583891349, 'support': 116079}, '2': {'precision': 0.45548014586709884, 'recall': 0.22213896962561033, 'f1-score': 0.29863351837195534, 'support': 121451}, 'accuracy': 0.37176165803108807, 'macro avg': {'precision': 0.4016347236647985, 'recall': 0.37440624319332616, 'f1-score': 0.3627715550852386, 'support': 358980}, 'weighted avg': {'precision': 0.40288825355983926, 'recall': 0.37176165803108807, 'f1-score': 0.36216665784533125, 'support': 358980}}
[[42501 66259 12690]
 [32541 63975 19563]
 [23440 71032 26979]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013967
{'0': {'precision': 0.43264466672898944, 'recall': 0.33228029867892017, 'f1-score': 0.3758781725888325, 'support': 41784}, '1': {'precision': 0.30911067623396393, 'recall': 0.553467607973422, 'f1-score': 0.39667761107959043, 'support': 38528}, '2': {'precision': 0.4654343807763401, 'recall': 0.23752476181492313, 'f1-score': 0.3145337580413466, 'support': 42404}, 'accuracy': 0.3689820398318068, 'macro avg': {'precision': 0.40239657457976447, 'recall': 0.37442422282242177, 'f1-score': 0.36236318056992317, 'support': 122716}, 'weighted avg': {'precision': 0.4051901982706915, 'recall': 0.3689820398318068, 'f1-score': 0.3612110730394692, 'support': 122716}}
[[13884 23190  4710]
 [10346 21324  6858]
 [ 7861 24471 10072]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/AAL
Evaluating performance on  test set...
4856/4856 - 67s - 67s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990658
{'0': {'precision': 0.42851696794942884, 'recall': 0.28510686376915856, 'f1-score': 0.34240204257110296, 'support': 433683}, '1': {'precision': 0.30963837248765036, 'recall': 0.633143394684288, 'f1-score': 0.41588731795148415, 'support': 389073}, '2': {'precision': 0.43212877709621755, 'recall': 0.1633154347081001, 'f1-score': 0.23704420223515796, 'support': 420144}, 'accuracy': 0.35288518786708506, 'macro avg': {'precision': 0.39009470584443223, 'recall': 0.36052189772051557, 'f1-score': 0.3317778542525817, 'support': 1242900}, 'weighted avg': {'precision': 0.3925245535718183, 'recall': 0.35288518786708506, 'f1-score': 0.3297909492232598, 'support': 1242900}}
[[123646 271934  38103]
 [ 90667 246339  52067]
 [ 74231 277297  68616]]
Evaluating performance on  train set...
2076/2076 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935496
{'0': {'precision': 0.4195624916820184, 'recall': 0.33709458660918795, 'f1-score': 0.37383445882690697, 'support': 177689}, '1': {'precision': 0.3315983041488939, 'recall': 0.5801649624315011, 'f1-score': 0.421999272663019, 'support': 177010}, '2': {'precision': 0.41864471184293855, 'recall': 0.18703985603612677, 'f1-score': 0.2585611415116111, 'support': 176711}, 'accuracy': 0.3681620594268079, 'macro avg': {'precision': 0.38993516922461696, 'recall': 0.3680998016922719, 'f1-score': 0.35146495766717906, 'support': 531410}, 'weighted avg': {'precision': 0.38995687148597014, 'recall': 0.3681620594268079, 'f1-score': 0.3515458126234613, 'support': 531410}}
[[ 59898  98764  19027]
 [ 47444 102695  26871]
 [ 35421 108238  33052]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888045
{'0': {'precision': 0.41390743832313115, 'recall': 0.36056070613423824, 'f1-score': 0.3853967637121237, 'support': 49509}, '1': {'precision': 0.34900056571751836, 'recall': 0.5711530301276858, 'f1-score': 0.4332596895255095, 'support': 51846}, '2': {'precision': 0.42119638219754635, 'recall': 0.19215606168930652, 'f1-score': 0.2639116834294211, 'support': 48955}, 'accuracy': 0.3783514070920099, 'macro avg': {'precision': 0.39470146207939866, 'recall': 0.37462326598374357, 'f1-score': 0.3608560455556848, 'support': 150310}, 'weighted avg': {'precision': 0.3938932578312237, 'recall': 0.3783514070920099, 'f1-score': 0.3623390772407053, 'support': 150310}}
[[17851 26316  5342]
 [14649 29612  7585]
 [10628 28920  9407]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/WBA
Evaluating performance on  test set...
4353/4353 - 60s - 60s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0812861
{'0': {'precision': 0.4408817255632973, 'recall': 0.30558115961438975, 'f1-score': 0.3609694510621401, 'support': 380799}, '1': {'precision': 0.3509968775264753, 'recall': 0.6425806991485534, 'f1-score': 0.4540034402038256, 'support': 382408}, '2': {'precision': 0.41851457473712234, 'recall': 0.179123608563388, 'f1-score': 0.2508736655656087, 'support': 351076}, 'accuracy': 0.3813923392890316, 'macro avg': {'precision': 0.403464392608965, 'recall': 0.3757618224421104, 'f1-score': 0.3552821856105248, 'support': 1114283}, 'weighted avg': {'precision': 0.40298717380982424, 'recall': 0.3813923392890316, 'f1-score': 0.3582097874315484, 'support': 1114283}}
[[116365 226864  37570]
 [ 86876 245728  49804]
 [ 60696 227494  62886]]
Evaluating performance on  train set...
1542/1542 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912186
{'0': {'precision': 0.42124459707501927, 'recall': 0.2661738076353242, 'f1-score': 0.3262184357618748, 'support': 133642}, '1': {'precision': 0.33653504363015085, 'recall': 0.668727452246231, 'f1-score': 0.4477441926691347, 'support': 131665}, '2': {'precision': 0.4255661428041084, 'recall': 0.15963792503191365, 'f1-score': 0.23218053234762942, 'support': 129255}, 'accuracy': 0.36560540548760395, 'macro avg': {'precision': 0.39444859450309283, 'recall': 0.36484639497115623, 'f1-score': 0.3353810535928796, 'support': 394562}, 'weighted avg': {'precision': 0.3943927918806387, 'recall': 0.36560540548760395, 'f1-score': 0.33596549598912956, 'support': 394562}}
[[35572 85560 12510]
 [28275 88048 15342]
 [20598 88023 20634]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0894179
{'0': {'precision': 0.4149860096660489, 'recall': 0.2776764655822209, 'f1-score': 0.3327214987034933, 'support': 41127}, '1': {'precision': 0.33769432819314055, 'recall': 0.6540577381821723, 'f1-score': 0.4454169463991181, 'support': 41082}, '2': {'precision': 0.43178595647617285, 'recall': 0.17041362530413626, 'f1-score': 0.2443781511139024, 'support': 41100}, 'accuracy': 0.36732112011288715, 'macro avg': {'precision': 0.3948220981117874, 'recall': 0.3673826096895098, 'f1-score': 0.3408388654055046, 'support': 123309}, 'weighted avg': {'precision': 0.3948348524563244, 'recall': 0.36732112011288715, 'f1-score': 0.3408218222508376, 'support': 123309}}
[[11420 25487  4220]
 [ 9215 26870  4997]
 [ 6884 27212  7004]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101985
{'0': {'precision': 0.41740876277071415, 'recall': 0.28148168424510284, 'f1-score': 0.3362270068650864, 'support': 474919}, '1': {'precision': 0.30841463059652013, 'recall': 0.6650316389486849, 'f1-score': 0.42140073608209, 'support': 430166}, '2': {'precision': 0.4602651707672132, 'recall': 0.14608721975818095, 'f1-score': 0.22178145975690872, 'support': 502111}, 'accuracy': 0.3504181364927132, 'macro avg': {'precision': 0.39536285471148247, 'recall': 0.3642001809839896, 'f1-score': 0.326469734234695, 'support': 1407196}, 'weighted avg': {'precision': 0.399382207844951, 'recall': 0.3504181364927132, 'f1-score': 0.3214276998021949, 'support': 1407196}}
[[133681 302056  39182]
 [ 97257 286074  46835]
 [ 89326 339433  73352]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940158
{'0': {'precision': 0.40918839776819277, 'recall': 0.29372699177384903, 'f1-score': 0.34197480645150624, 'support': 176024}, '1': {'precision': 0.33962864506648693, 'recall': 0.6664093628324611, 'f1-score': 0.44994663657109796, 'support': 176186}, '2': {'precision': 0.428362733282203, 'recall': 0.13434203443022896, 'f1-score': 0.2045375279017857, 'support': 174614}, 'accuracy': 0.36553573869072026, 'macro avg': {'precision': 0.3923932587056275, 'recall': 0.36482612967884637, 'f1-score': 0.33215299030813, 'support': 526824}, 'weighted avg': {'precision': 0.3922807641598921, 'recall': 0.36553573869072026, 'f1-score': 0.3325307642377299, 'support': 526824}}
[[ 51703 110631  13690]
 [ 41160 117412  17614]
 [ 33492 117664  23458]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956631
{'0': {'precision': 0.41316594628721287, 'recall': 0.2889432302545553, 'f1-score': 0.34006535490511547, 'support': 58887}, '1': {'precision': 0.33279673843623414, 'recall': 0.6643438471479968, 'f1-score': 0.4434509410756649, 'support': 57258}, '2': {'precision': 0.422937925170068, 'recall': 0.136843553323933, 'f1-score': 0.20678186306353127, 'support': 58154}, 'accuracy': 0.361516704054527, 'macro avg': {'precision': 0.3896335366311717, 'recall': 0.36337687690882836, 'f1-score': 0.33009938634810393, 'support': 174299}, 'weighted avg': {'precision': 0.39002467500523313, 'recall': 0.361516704054527, 'f1-score': 0.32955860333682097, 'support': 174299}}
[[17015 36991  4881]
 [13242 38039  5977]
 [10925 39271  7958]]
testing model on single stock: results/universal/W2/deepOF_L2/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 203s - 203s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0872085
{'0': {'precision': 0.3280329641243736, 'recall': 0.2676315895423784, 'f1-score': 0.2947698770070507, 'support': 1092868}, '1': {'precision': 0.41554544061397575, 'recall': 0.671140306194198, 'f1-score': 0.5132841671484577, 'support': 1599965}, '2': {'precision': 0.3459581904471216, 'recall': 0.10349748133718749, 'f1-score': 0.15932962295080835, 'support': 1117061}, 'accuracy': 0.3889609527194195, 'macro avg': {'precision': 0.3631788650618237, 'recall': 0.3474231256912546, 'f1-score': 0.3224612223687722, 'support': 3809894}, 'weighted avg': {'precision': 0.37003950569429694, 'recall': 0.3889609527194195, 'f1-score': 0.34682386869022513, 'support': 3809894}}
[[ 292486  730798   69584]
 [ 377179 1073801  148985]
 [ 221971  779477  115613]]
Evaluating performance on  train set...
6147/6147 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096696
{'0': {'precision': 0.3647031206692724, 'recall': 0.24860947504188444, 'f1-score': 0.2956686427435636, 'support': 518689}, '1': {'precision': 0.3267138559804453, 'recall': 0.6915919153031761, 'f1-score': 0.4437815591063152, 'support': 519500}, '2': {'precision': 0.3918533367714459, 'recall': 0.0880058435177678, 'f1-score': 0.14373126473078418, 'support': 535294}, 'accuracy': 0.3402273809122819, 'macro avg': {'precision': 0.3610901044737212, 'recall': 0.34273574462094275, 'f1-score': 0.2943938221935543, 'support': 1573483}, 'weighted avg': {'precision': 0.36139703142162954, 'recall': 0.3402273809122819, 'f1-score': 0.292880873968481, 'support': 1573483}}
[[128951 357941  31797]
 [118903 359282  41315]
 [105724 382461  47109]]
Evaluating performance on  val set...
2174/2174 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024404
{'0': {'precision': 0.3533407606845542, 'recall': 0.2573436188136386, 'f1-score': 0.2977970063804329, 'support': 177467}, '1': {'precision': 0.3459480669604272, 'recall': 0.6643010238108572, 'f1-score': 0.45496433932297886, 'support': 196423}, '2': {'precision': 0.3824815768977293, 'recall': 0.10487752788684267, 'f1-score': 0.16461669374178078, 'support': 182613}, 'accuracy': 0.3509522859715042, 'macro avg': {'precision': 0.3605901348475702, 'recall': 0.34217405683711277, 'f1-score': 0.30579267981506414, 'support': 556503}, 'weighted avg': {'precision': 0.360293817167201, 'recall': 0.3509522859715042, 'f1-score': 0.3095684121171343, 'support': 556503}}
[[ 45670 119938  11859]
 [ 46877 130484  19062]
 [ 36705 126756  19152]]
training model: results/universal/W2/deepVOL_L2/h50
Epoch 1/50
9940/9940 - 649s - loss: 3.0331 - accuracy50: 0.4742 - val_loss: 3.5453 - val_accuracy50: 0.4534 - 649s/epoch - 65ms/step
Epoch 2/50
9940/9940 - 646s - loss: 2.9917 - accuracy50: 0.4862 - val_loss: 3.6197 - val_accuracy50: 0.4564 - 646s/epoch - 65ms/step
Epoch 3/50
9940/9940 - 656s - loss: 2.9699 - accuracy50: 0.4927 - val_loss: 3.5979 - val_accuracy50: 0.4559 - 656s/epoch - 66ms/step
Epoch 4/50
9940/9940 - 652s - loss: 2.9580 - accuracy50: 0.4962 - val_loss: 3.6136 - val_accuracy50: 0.4550 - 652s/epoch - 66ms/step
Epoch 5/50
9940/9940 - 648s - loss: 2.9481 - accuracy50: 0.4991 - val_loss: 3.6570 - val_accuracy50: 0.4589 - 648s/epoch - 65ms/step
Epoch 6/50
9940/9940 - 651s - loss: 2.9398 - accuracy50: 0.5010 - val_loss: 3.6138 - val_accuracy50: 0.4587 - 651s/epoch - 65ms/step
Epoch 7/50
9940/9940 - 654s - loss: 2.9308 - accuracy50: 0.5033 - val_loss: 3.5841 - val_accuracy50: 0.4596 - 654s/epoch - 66ms/step
Epoch 8/50
9940/9940 - 656s - loss: 2.9244 - accuracy50: 0.5048 - val_loss: 3.6263 - val_accuracy50: 0.4595 - 656s/epoch - 66ms/step
Epoch 9/50
9940/9940 - 660s - loss: 2.9190 - accuracy50: 0.5059 - val_loss: 3.6435 - val_accuracy50: 0.4612 - 660s/epoch - 66ms/step
Epoch 10/50
9940/9940 - 659s - loss: 2.9139 - accuracy50: 0.5069 - val_loss: 3.5969 - val_accuracy50: 0.4620 - 659s/epoch - 66ms/step
Epoch 11/50
9940/9940 - 654s - loss: 2.9098 - accuracy50: 0.5077 - val_loss: 3.6355 - val_accuracy50: 0.4602 - 654s/epoch - 66ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1078s - 1078s/epoch - 41ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3084292
{'0': {'precision': 0.35361833636920526, 'recall': 0.4923561935350947, 'f1-score': 0.4116109218528133, 'support': 1771565}, '1': {'precision': 0.5481577235431138, 'recall': 0.41538471813670536, 'f1-score': 0.4726233773189139, 'support': 3144237}, '2': {'precision': 0.3809667315343505, 'recall': 0.3950099918724276, 'f1-score': 0.38786128755607624, 'support': 1804967}, 'accuracy': 0.43020210931219327, 'macro avg': {'precision': 0.4275809304822232, 'recall': 0.43425030118140917, 'f1-score': 0.42403186224260114, 'support': 6720769}, 'weighted avg': {'precision': 0.4519762608694485, 'recall': 0.43020210931219327, 'f1-score': 0.43377658678932385, 'support': 6720769}}
[[ 872241  528862  370462]
 [1050109 1306068  788060]
 [ 544267  547720  712980]]
Evaluating performance on  train set...
9940/9940 - 397s - 397s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.197372
{'0': {'precision': 0.40854805738153316, 'recall': 0.5226120761148556, 'f1-score': 0.45859383532485015, 'support': 787389}, '1': {'precision': 0.5368079163875794, 'recall': 0.44345981341195534, 'f1-score': 0.48568922795811786, 'support': 957832}, '2': {'precision': 0.43817932685661987, 'recall': 0.40894260166858093, 'f1-score': 0.4230564406096659, 'support': 798403}, 'accuracy': 0.45712731126927564, 'macro avg': {'precision': 0.46117843354191085, 'recall': 0.4583381637317973, 'f1-score': 0.45577983463087796, 'support': 2543624}, 'weighted avg': {'precision': 0.4661466221514036, 'recall': 0.45712731126927564, 'f1-score': 0.4576423077264004, 'support': 2543624}}
[[411499 180855 195035]
 [309477 424760 223595]
 [286247 185655 326501]]
Evaluating performance on  val set...
3393/3393 - 145s - 145s/epoch - 43ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2030295
{'0': {'precision': 0.3980251865503099, 'recall': 0.5020148655680173, 'f1-score': 0.4440125971026664, 'support': 263293}, '1': {'precision': 0.5341705072371852, 'recall': 0.4483985554612379, 'f1-score': 0.4875408618247246, 'support': 338101}, '2': {'precision': 0.43571391751555355, 'recall': 0.41202431259913086, 'f1-score': 0.42353811819937326, 'support': 266693}, 'accuracy': 0.4534856529357081, 'macro avg': {'precision': 0.45596987043434956, 'recall': 0.45414591120946196, 'f1-score': 0.45169719237558814, 'support': 868087}, 'weighted avg': {'precision': 0.4626295289686009, 'recall': 0.4534856529357081, 'f1-score': 0.4546757560125874, 'support': 868087}}
[[132177  66210  64906]
 [109094 151604  77403]
 [ 90811  65998 109884]]
testing model out of sample: results/universal/W2/deepVOL_L2/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 563s - 563s/epoch - 39ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1228243
{'0': {'precision': 0.4400502255499233, 'recall': 0.4724298587147276, 'f1-score': 0.4556655415695366, 'support': 1201753}, '1': {'precision': 0.47773216026387805, 'recall': 0.6127670843715768, 'f1-score': 0.5368890338906956, 'support': 1246095}, '2': {'precision': 0.49178465741244015, 'recall': 0.3139968085586417, 'f1-score': 0.3832771525453602, 'support': 1218885}, 'accuracy': 0.46745590693404726, 'macro avg': {'precision': 0.4698556810754138, 'recall': 0.4663979172149821, 'f1-score': 0.45861057600186417, 'support': 3666733}, 'weighted avg': {'precision': 0.4700533900612551, 'recall': 0.46745590693404726, 'f1-score': 0.45920522283572135, 'support': 3666733}}
[[567744 414419 219590]
 [306606 763566 175923]
 [415830 420329 382726]]
Evaluating performance on  train set...
5373/5373 - 213s - 213s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0643784
{'0': {'precision': 0.46235062980434144, 'recall': 0.44288475354437945, 'f1-score': 0.452408397856676, 'support': 413401}, '1': {'precision': 0.522405882197213, 'recall': 0.6883632631553823, 'f1-score': 0.5940108717522976, 'support': 544663}, '2': {'precision': 0.4975747018625218, 'recall': 0.3118048691546633, 'f1-score': 0.3833707208941158, 'support': 416828}, 'accuracy': 0.500391303462381, 'macro avg': {'precision': 0.49411040462135875, 'recall': 0.48101762861814173, 'f1-score': 0.47659666350102975, 'support': 1374892}, 'weighted avg': {'precision': 0.49682043066282766, 'recall': 0.500391303462381, 'f1-score': 0.4875739173494513, 'support': 1374892}}
[[183089 165141  65171]
 [103672 374926  66065]
 [109235 177624 129969]]
Evaluating performance on  val set...
1685/1685 - 68s - 68s/epoch - 40ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0853432
{'0': {'precision': 0.45805956548846577, 'recall': 0.4263997916589159, 'f1-score': 0.4416630379073684, 'support': 134395}, '1': {'precision': 0.5018031308909106, 'recall': 0.680845148735057, 'f1-score': 0.5777714865406846, 'support': 161865}, '2': {'precision': 0.49176246102294413, 'recall': 0.3144510906764277, 'f1-score': 0.38360864040660736, 'support': 134412}, 'accuracy': 0.48709226511126796, 'macro avg': {'precision': 0.48387505246744017, 'recall': 0.47389867702346683, 'f1-score': 0.4676810549515535, 'support': 430672}, 'weighted avg': {'precision': 0.4850188890768277, 'recall': 0.48709226511126796, 'f1-score': 0.4746997488176654, 'support': 430672}}
[[ 57306  53830  23259]
 [ 31237 110205  20423]
 [ 36563  55583  42266]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/LILAK
Evaluating performance on  test set...
987/987 - 16s - 16s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5187739
{'0': {'precision': 0.31622790224222785, 'recall': 0.8638485675654991, 'f1-score': 0.46297511621547716, 'support': 78398}, '1': {'precision': 0.3790688092295014, 'recall': 0.06243637597556837, 'f1-score': 0.10721361146719495, 'support': 88410}, '2': {'precision': 0.4144966555887426, 'recall': 0.11498827126635312, 'f1-score': 0.18003252389044197, 'support': 85687}, 'accuracy': 0.3291035466048833, 'macro avg': {'precision': 0.3699311223534906, 'recall': 0.34709107160247354, 'f1-score': 0.25007375052437136, 'support': 252495}, 'weighted avg': {'precision': 0.37157996566822704, 'recall': 0.3291035466048833, 'f1-score': 0.24238707865690798, 'support': 252495}}
[[67724  4449  6225]
 [75197  5520  7693]
 [71241  4593  9853]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4912462
{'0': {'precision': 0.3364772703716755, 'recall': 0.8254678600488202, 'f1-score': 0.4780796701273838, 'support': 19664}, '1': {'precision': 0.36000688349681637, 'recall': 0.10429753714228737, 'f1-score': 0.16173798755266922, 'support': 20058}, '2': {'precision': 0.4129798057653769, 'recall': 0.12869289522986022, 'f1-score': 0.19623498388514504, 'support': 20817}, 'accuracy': 0.34693338178694727, 'macro avg': {'precision': 0.36982131987795624, 'recall': 0.35281943080698924, 'f1-score': 0.278684213855066, 'support': 60539}, 'weighted avg': {'precision': 0.37057942368366875, 'recall': 0.34693338178694727, 'f1-score': 0.2763528113654566, 'support': 60539}}
[[16232  1755  1677]
 [15835  2092  2131]
 [16174  1964  2679]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4763243
{'0': {'precision': 0.33037288989669944, 'recall': 0.7540253018976423, 'f1-score': 0.4594428871758935, 'support': 6956}, '1': {'precision': 0.3419425245543834, 'recall': 0.12832764505119454, 'f1-score': 0.18661901925749452, 'support': 7325}, '2': {'precision': 0.3842016806722689, 'recall': 0.15616887552944392, 'f1-score': 0.22207110938410726, 'support': 7319}, 'accuracy': 0.33925925925925926, 'macro avg': {'precision': 0.35217236504111726, 'recall': 0.3461739408260936, 'f1-score': 0.2893776719391651, 'support': 21600}, 'weighted avg': {'precision': 0.3525358757093813, 'recall': 0.33925925925925926, 'f1-score': 0.2864910874462474, 'support': 21600}}
[[5245  939  772]
 [5325  940 1060]
 [5306  870 1143]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0165894
{'0': {'precision': 0.477943400896565, 'recall': 0.40262959745149146, 'f1-score': 0.43706577301049376, 'support': 86325}, '1': {'precision': 0.5604346327947625, 'recall': 0.8454707939017183, 'f1-score': 0.6740583042379857, 'support': 140433}, '2': {'precision': 0.6020770620108369, 'recall': 0.21969222657923354, 'f1-score': 0.32191918622898574, 'support': 91041}, 'accuracy': 0.5459110947485675, 'macro avg': {'precision': 0.5468183652340548, 'recall': 0.48926420597748116, 'f1-score': 0.47768108782582175, 'support': 317799}, 'weighted avg': {'precision': 0.5499566665476967, 'recall': 0.5459110947485675, 'f1-score': 0.5088045504474747, 'support': 317799}}
[[ 34757  43972   7596]
 [ 16078 118732   5623]
 [ 21887  49153  20001]]
Evaluating performance on  train set...
528/528 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9033213
{'0': {'precision': 0.5714436694145001, 'recall': 0.34075941389632897, 'f1-score': 0.42693302276002293, 'support': 31735}, '1': {'precision': 0.6250529068181604, 'recall': 0.934866708869663, 'f1-score': 0.749193930238326, 'support': 71085}, '2': {'precision': 0.6361286319925551, 'recall': 0.19168691967345922, 'f1-score': 0.2946007422482941, 'support': 32094}, 'accuracy': 0.6183272306802852, 'macro avg': {'precision': 0.6108750694084052, 'recall': 0.48910434747981707, 'f1-score': 0.49024256508221437, 'support': 134914}, 'weighted avg': {'precision': 0.6150774793216949, 'recall': 0.6183272306802852, 'f1-score': 0.5652496125679877, 'support': 134914}}
[[10814 18639  2282]
 [ 3393 66455  1237]
 [ 4717 21225  6152]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9384837
{'0': {'precision': 0.5519774894481788, 'recall': 0.332705172901159, 'f1-score': 0.4151675485008819, 'support': 10613}, '1': {'precision': 0.6003944008017328, 'recall': 0.9282751037137003, 'f1-score': 0.7291715744012565, 'support': 20007}, '2': {'precision': 0.6398162327718223, 'recall': 0.2094235588972431, 'f1-score': 0.3155589123867069, 'support': 9975}, 'accuracy': 0.5959354600320237, 'macro avg': {'precision': 0.5973960410072446, 'recall': 0.49013461183736745, 'f1-score': 0.48663267842961505, 'support': 40595}, 'weighted avg': {'precision': 0.5974231997598896, 'recall': 0.5959354600320237, 'f1-score': 0.545446706055997, 'support': 40595}}
[[ 3531  6328   754]
 [ 1013 18572   422]
 [ 1853  6033  2089]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3433703
{'0': {'precision': 0.3832199763096557, 'recall': 0.4345946765754152, 'f1-score': 0.40729366018081853, 'support': 92309}, '1': {'precision': 0.35126749748368286, 'recall': 0.4209871783711184, 'f1-score': 0.38298016766412873, 'support': 80411}, '2': {'precision': 0.4468547527269745, 'recall': 0.32210103159823833, 'f1-score': 0.3743580053936136, 'support': 101493}, 'accuracy': 0.38896770029137934, 'macro avg': {'precision': 0.39378074217343767, 'recall': 0.3925609621815906, 'f1-score': 0.38821061107952026, 'support': 274213}, 'weighted avg': {'precision': 0.3974029420627296, 'recall': 0.38896770029137934, 'f1-score': 0.38797360366242833, 'support': 274213}}
[[40117 29783 22409]
 [28501 33852 18058]
 [36066 32736 32691]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.385392
{'0': {'precision': 0.39557858935946233, 'recall': 0.3988406270411496, 'f1-score': 0.3972029109240965, 'support': 24496}, '1': {'precision': 0.36379305038318305, 'recall': 0.4861396726165995, 'f1-score': 0.4161605492474254, 'support': 24314}, '2': {'precision': 0.4138322710923203, 'recall': 0.2707008998596549, 'f1-score': 0.327302672622464, 'support': 24226}, 'accuracy': 0.3853989813242784, 'macro avg': {'precision': 0.3910679702783219, 'recall': 0.38522706650580135, 'f1-score': 0.38022204426466194, 'support': 73036}, 'weighted avg': {'precision': 0.3910517820177536, 'recall': 0.3853989813242784, 'f1-score': 0.38032812102730684, 'support': 73036}}
[[ 9770 10054  4672]
 [ 7877 11820  4617]
 [ 7051 10617  6558]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4014776
{'0': {'precision': 0.3823997007388011, 'recall': 0.4288860918816866, 'f1-score': 0.4043110693627329, 'support': 9534}, '1': {'precision': 0.38129554655870446, 'recall': 0.4599531158429381, 'f1-score': 0.4169470515317868, 'support': 10238}, '2': {'precision': 0.4120603015075377, 'recall': 0.27777224270200257, 'f1-score': 0.331845503779087, 'support': 10037}, 'accuracy': 0.38867456137408163, 'macro avg': {'precision': 0.3919185162683478, 'recall': 0.3888704834755424, 'f1-score': 0.3843678748912023, 'support': 29809}, 'weighted avg': {'precision': 0.392007507757486, 'recall': 0.38867456137408163, 'f1-score': 0.38425103057188853, 'support': 29809}}
[[4089 3538 1907]
 [3458 4709 2071]
 [3146 4103 2788]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5579472
{'0': {'precision': 0.3312473971461763, 'recall': 0.41005847318509275, 'f1-score': 0.36646358097662995, 'support': 73709}, '1': {'precision': 0.2989243074983254, 'recall': 0.558900234274853, 'f1-score': 0.3895175699821322, 'support': 67869}, '2': {'precision': 0.3682750970604548, 'recall': 0.008473062297424904, 'f1-score': 0.01656500642392945, 'support': 78366}, 'accuracy': 0.3129023751500382, 'macro avg': {'precision': 0.3328156005683188, 'recall': 0.32581058991912354, 'f1-score': 0.25751538579423056, 'support': 219944}, 'weighted avg': {'precision': 0.33446629359332813, 'recall': 0.3129023751500382, 'f1-score': 0.24890865557024242, 'support': 219944}}
[[30225 42828   656]
 [29454 37932   483]
 [31567 46135   664]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5223619
{'0': {'precision': 0.3401483433574905, 'recall': 0.5648092599781205, 'f1-score': 0.42459212097095106, 'support': 28337}, '1': {'precision': 0.31013557515836837, 'recall': 0.3937981582409322, 'f1-score': 0.3469952142017322, 'support': 26605}, '2': {'precision': 0.35064935064935066, 'recall': 0.011106955871353777, 'f1-score': 0.021531880958422445, 'support': 26740}, 'accuracy': 0.327844567958669, 'macro avg': {'precision': 0.33364442305506986, 'recall': 0.3232381246968022, 'f1-score': 0.26437307204370186, 'support': 81682}, 'weighted avg': {'precision': 0.33381043827493495, 'recall': 0.327844567958669, 'f1-score': 0.2673690299284927, 'support': 81682}}
[[16005 12019   313]
 [15891 10477   237]
 [15157 11286   297]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5121502
{'0': {'precision': 0.34185613722793107, 'recall': 0.49030985261692006, 'f1-score': 0.40284134248665143, 'support': 8617}, '1': {'precision': 0.3243505705268269, 'recall': 0.48534754177767014, 'f1-score': 0.3888430754305118, 'support': 8258}, '2': {'precision': 0.2, 'recall': 0.0060598565421716545, 'f1-score': 0.011763293722242229, 'support': 8086}, 'accuracy': 0.33179760426264976, 'macro avg': {'precision': 0.288735569251586, 'recall': 0.3272390836455873, 'f1-score': 0.2678159038798018, 'support': 24961}, 'weighted avg': {'precision': 0.29011102703832453, 'recall': 0.33179760426264976, 'f1-score': 0.2715222931032688, 'support': 24961}}
[[4225 4293   99]
 [4153 4008   97]
 [3981 4056   49]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 27s - 27s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3213581
{'0': {'precision': 0.41310529830297726, 'recall': 0.42597912931986276, 'f1-score': 0.41944345406830286, 'support': 168466}, '1': {'precision': 0.3536414461792918, 'recall': 0.503496996531205, 'f1-score': 0.41546942040578866, 'support': 141836}, '2': {'precision': 0.45623293425750894, 'recall': 0.2902342205915921, 'f1-score': 0.35477625297314214, 'support': 179617}, 'accuracy': 0.39865365499194766, 'macro avg': {'precision': 0.4076598929132593, 'recall': 0.4065701154808867, 'f1-score': 0.3965630424824112, 'support': 489919}, 'weighted avg': {'precision': 0.41170168190400125, 'recall': 0.39865365499194766, 'f1-score': 0.39458426367628735, 'support': 489919}}
[[71763 63294 33409]
 [41698 71414 28724]
 [60255 67231 52131]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2710165
{'0': {'precision': 0.44068401096219545, 'recall': 0.3783561643835616, 'f1-score': 0.4071485553744234, 'support': 62050}, '1': {'precision': 0.4037575291021253, 'recall': 0.6401240269164797, 'f1-score': 0.4951805000031896, 'support': 60632}, '2': {'precision': 0.4372958850424559, 'recall': 0.24385357858313603, 'f1-score': 0.3131065123348533, 'support': 60401}, 'accuracy': 0.4206725911198746, 'macro avg': {'precision': 0.4272458083689256, 'recall': 0.42077792329439245, 'f1-score': 0.4051451892374887, 'support': 183083}, 'weighted avg': {'precision': 0.42733720846377693, 'recall': 0.4206725911198746, 'f1-score': 0.40527683285020366, 'support': 183083}}
[[23477 28389 10184]
 [13051 38812  8769]
 [16746 28926 14729]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3683568
{'0': {'precision': 0.4205218050097069, 'recall': 0.45278882430916695, 'f1-score': 0.43605921488719224, 'support': 19614}, '1': {'precision': 0.3145175915850562, 'recall': 0.45605154164749195, 'f1-score': 0.3722864732873588, 'support': 15211}, '2': {'precision': 0.44455091906960537, 'recall': 0.2573503454536285, 'f1-score': 0.3259869681870448, 'support': 19829}, 'accuracy': 0.38278991473634133, 'macro avg': {'precision': 0.3931967718881228, 'recall': 0.38873023713676247, 'f1-score': 0.3781108854538653, 'support': 54654}, 'weighted avg': {'precision': 0.39973729174976924, 'recall': 0.38278991473634133, 'f1-score': 0.3783750608949448, 'support': 54654}}
[[8881 7281 3452]
 [5350 6937 2924]
 [6888 7838 5103]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/EXC
Evaluating performance on  test set...
4918/4918 - 65s - 65s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8688897
{'0': {'precision': 0.6076015413964966, 'recall': 0.36255728198791604, 'f1-score': 0.4541325772040006, 'support': 308343}, '1': {'precision': 0.6082206877295702, 'recall': 0.908066413497446, 'f1-score': 0.728496309273623, 'support': 633305}, '2': {'precision': 0.6960868455846536, 'recall': 0.2838258336459736, 'f1-score': 0.4032347645367326, 'support': 317191}, 'accuracy': 0.6171575554935937, 'macro avg': {'precision': 0.6373030249035735, 'recall': 0.5181498430437785, 'f1-score': 0.5286212170047854, 'support': 1258839}, 'weighted avg': {'precision': 0.6302087616917152, 'recall': 0.6171575554935937, 'f1-score': 0.5793365113374432, 'support': 1258839}}
[[111792 178691  17860]
 [ 36776 575083  21446]
 [ 35421 191743  90027]]
Evaluating performance on  train set...
1403/1403 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82209086
{'0': {'precision': 0.592801472604081, 'recall': 0.37574162798202715, 'f1-score': 0.459948948583931, 'support': 80566}, '1': {'precision': 0.6521517872610729, 'recall': 0.9124480510627124, 'f1-score': 0.7606476911322386, 'support': 198031}, '2': {'precision': 0.7011542701510927, 'recall': 0.26902454499085626, 'f1-score': 0.38885142728703076, 'support': 80383}, 'accuracy': 0.6479191041283637, 'macro avg': {'precision': 0.6487025100054156, 'recall': 0.5190714080118654, 'f1-score': 0.5364826890010668, 'support': 358980}, 'weighted avg': {'precision': 0.6498044395856962, 'recall': 0.6479191041283637, 'f1-score': 0.6099089481136406, 'support': 358980}}
[[ 30272  46072   4222]
 [ 12343 180693   4995]
 [  8451  50307  21625]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8538581
{'0': {'precision': 0.6191925465838509, 'recall': 0.3427068651380247, 'f1-score': 0.44121356967403574, 'support': 29089}, '1': {'precision': 0.6240024522498335, 'recall': 0.9162230534043114, 'f1-score': 0.7423918511066399, 'support': 64433}, '2': {'precision': 0.7060782681099084, 'recall': 0.2904606953245419, 'f1-score': 0.4116005339157869, 'support': 29195}, 'accuracy': 0.6314039619612605, 'macro avg': {'precision': 0.6497577556478643, 'recall': 0.516463537955626, 'f1-score': 0.5317353182321541, 'support': 122717}, 'weighted avg': {'precision': 0.6423885609235879, 'recall': 0.6314039619612605, 'f1-score': 0.5923032119288569, 'support': 122717}}
[[ 9969 17380  1740]
 [ 3608 59035  1790]
 [ 2523 18192  8480]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/AAL
Evaluating performance on  test set...
4856/4856 - 64s - 64s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0274216
{'0': {'precision': 0.49205233494155864, 'recall': 0.4697316192886764, 'f1-score': 0.4806329717818171, 'support': 405357}, '1': {'precision': 0.5151981814088453, 'recall': 0.740374850590001, 'f1-score': 0.6075947266525307, 'support': 445084}, '2': {'precision': 0.5232248520710059, 'recall': 0.2883933303436748, 'f1-score': 0.3718363163289443, 'support': 392464}, 'accuracy': 0.5093888913472872, 'macro avg': {'precision': 0.51015845614047, 'recall': 0.49949993340745075, 'f1-score': 0.4866880049210973, 'support': 1242905}, 'weighted avg': {'precision': 0.5101839996236841, 'recall': 0.5093888913472872, 'f1-score': 0.4917439377198577, 'support': 1242905}}
[[190409 155852  59096]
 [ 71515 329529  44040]
 [125045 154235 113184]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93522465
{'0': {'precision': 0.48554561961996945, 'recall': 0.4619532610974173, 'f1-score': 0.47345572002192887, 'support': 138343}, '1': {'precision': 0.6069355027322922, 'recall': 0.7610259296100057, 'f1-score': 0.6753021602214024, 'support': 252337}, '2': {'precision': 0.5301722070321869, 'recall': 0.31414765863710653, 'f1-score': 0.3945243130850713, 'support': 140730}, 'accuracy': 0.5648237707231705, 'macro avg': {'precision': 0.5408844431281495, 'recall': 0.5123756164481765, 'f1-score': 0.5144273977761342, 'support': 531410}, 'weighted avg': {'precision': 0.5550050926849015, 'recall': 0.5648237707231705, 'f1-score': 0.5483984352180874, 'support': 531410}}
[[ 63908  58205  16230]
 [ 37354 192035  22948]
 [ 30359  66161  44210]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93339455
{'0': {'precision': 0.5159583785866938, 'recall': 0.3738766184310739, 'f1-score': 0.43357425698850344, 'support': 39390}, '1': {'precision': 0.5824443560050864, 'recall': 0.8347685758406255, 'f1-score': 0.6861442407748339, 'support': 71881}, '2': {'precision': 0.5538248159607383, 'recall': 0.2659391890161121, 'f1-score': 0.35933200657610104, 'support': 39039}, 'accuracy': 0.5662497505156011, 'macro avg': {'precision': 0.5507425168508395, 'recall': 0.4915281277626038, 'f1-score': 0.4930168347798128, 'support': 150310}, 'weighted avg': {'precision': 0.5575879866730273, 'recall': 0.5662497505156011, 'f1-score': 0.5350754198565457, 'support': 150310}}
[[14727 20846  3817]
 [ 7330 60004  4547]
 [ 6486 22171 10382]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/WBA
Evaluating performance on  test set...
4353/4353 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9970905
{'0': {'precision': 0.5266462714160425, 'recall': 0.3832772973264532, 'f1-score': 0.44366706499173575, 'support': 333714}, '1': {'precision': 0.5270623516701367, 'recall': 0.7925581125110057, 'f1-score': 0.6331025532777046, 'support': 447494}, '2': {'precision': 0.5149210123317483, 'recall': 0.3068872342980665, 'f1-score': 0.38457313127360837, 'support': 333080}, 'accuracy': 0.5248086670591445, 'macro avg': {'precision': 0.5228765451393091, 'recall': 0.4942408813785084, 'f1-score': 0.48711424984768287, 'support': 1114288}, 'weighted avg': {'precision': 0.5233084845256057, 'recall': 0.5248086670591445, 'f1-score': 0.5020794655131516, 'support': 1114288}}
[[127905 156350  49459]
 [ 45994 354665  46835]
 [ 68968 161894 102218]]
Evaluating performance on  train set...
1542/1542 - 21s - 21s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0616062
{'0': {'precision': 0.49855379868877747, 'recall': 0.4067202038713534, 'f1-score': 0.4479790694753074, 'support': 127139}, '1': {'precision': 0.48041228240053363, 'recall': 0.7822281706129256, 'f1-score': 0.5952478710867722, 'support': 142709}, '2': {'precision': 0.5421184035021718, 'recall': 0.25419556589022974, 'f1-score': 0.34610492759002803, 'support': 124715}, 'accuracy': 0.4943266347832919, 'macro avg': {'precision': 0.5070281615304942, 'recall': 0.48104798012483624, 'f1-score': 0.4631106227173692, 'support': 394563}, 'weighted avg': {'precision': 0.5057622851442319, 'recall': 0.4943266347832919, 'f1-score': 0.46904376587093477, 'support': 394563}}
[[ 51710  59869  15560]
 [ 19862 111631  11216]
 [ 32148  60865  31702]]
Evaluating performance on  val set...
482/482 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0438473
{'0': {'precision': 0.5083315221328697, 'recall': 0.3612283772652389, 'f1-score': 0.42233725584614923, 'support': 38848}, '1': {'precision': 0.4825180401068453, 'recall': 0.7951340224246671, 'f1-score': 0.6005805827330395, 'support': 45664}, '2': {'precision': 0.5306282082620386, 'recall': 0.27975668848909735, 'f1-score': 0.36636119690142266, 'support': 38798}, 'accuracy': 0.4962776741545698, 'macro avg': {'precision': 0.5071592568339178, 'recall': 0.47870636272633443, 'f1-score': 0.4630930118268705, 'support': 123310}, 'weighted avg': {'precision': 0.5057876893958907, 'recall': 0.4962776741545698, 'f1-score': 0.4707319046501834, 'support': 123310}}
[[14033 19342  5473]
 [ 5227 36309  4128]
 [ 8346 19598 10854]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.023941
{'0': {'precision': 0.48169527312355265, 'recall': 0.43309938476410853, 'f1-score': 0.456106569129548, 'support': 457223}, '1': {'precision': 0.5006065169197306, 'recall': 0.6589851413468637, 'f1-score': 0.5689800438969117, 'support': 490354}, '2': {'precision': 0.4985539735779314, 'recall': 0.3803130384836301, 'f1-score': 0.4314795616113744, 'support': 459624}, 'accuracy': 0.4945704273945229, 'macro avg': {'precision': 0.49361858787373825, 'recall': 0.49079918819820073, 'f1-score': 0.4855220582126114, 'support': 1407201}, 'weighted avg': {'precision': 0.49379153185139213, 'recall': 0.4945704273945229, 'f1-score': 0.4873947761039197, 'support': 1407201}}
[[198023 160831  98369]
 [ 89772 323136  77446]
 [123301 161522 174801]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0296671
{'0': {'precision': 0.5053560858706166, 'recall': 0.4146273571496257, 'f1-score': 0.45551788979185515, 'support': 168848}, '1': {'precision': 0.4873012007567952, 'recall': 0.6943551745123371, 'f1-score': 0.5726878259586956, 'support': 187322}, '2': {'precision': 0.5069577754891864, 'recall': 0.36056582324469394, 'f1-score': 0.42141020241140437, 'support': 170654}, 'accuracy': 0.49657760466493556, 'macro avg': {'precision': 0.4998716873721995, 'recall': 0.48984945163555227, 'f1-score': 0.483205306053985, 'support': 526824}, 'weighted avg': {'precision': 0.49945517313861537, 'recall': 0.49657760466493556, 'f1-score': 0.4861313271075838, 'support': 526824}}
[[ 70009  66573  32266]
 [ 29677 130068  27577]
 [ 38848  70274  61532]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0256459
{'0': {'precision': 0.5003572813948266, 'recall': 0.41608801208808, 'f1-score': 0.4543482694054616, 'support': 58901}, '1': {'precision': 0.47331999647705686, 'recall': 0.6575598671560916, 'f1-score': 0.550432002575189, 'support': 57210}, '2': {'precision': 0.4984838238181461, 'recall': 0.39269265140578813, 'f1-score': 0.439309025541446, 'support': 58188}, 'accuracy': 0.4875357862064613, 'macro avg': {'precision': 0.49072036723000984, 'recall': 0.48878017688331993, 'f1-score': 0.48136309917403225, 'support': 174299}, 'weighted avg': {'precision': 0.49085742299278473, 'recall': 0.4875357862064613, 'f1-score': 0.48086504146198955, 'support': 174299}}
[[24508 21233 13160]
 [ 9762 37619  9829]
 [14711 20627 22850]]
testing model on single stock: results/universal/W2/deepVOL_L2/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 205s - 205s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5546869
{'0': {'precision': 0.30242053092248916, 'recall': 0.5850223935866253, 'f1-score': 0.39872487116369043, 'support': 969474}, '1': {'precision': 0.5155516300964739, 'recall': 0.11830722922739896, 'f1-score': 0.19245131304291782, 'support': 1855136}, '2': {'precision': 0.33149453231201775, 'recall': 0.5076175619539038, 'f1-score': 0.4010726277053257, 'support': 985289}, 'accuracy': 0.3377491109344368, 'macro avg': {'precision': 0.3831555644436602, 'recall': 0.40364906158930935, 'f1-score': 0.3307496039706446, 'support': 3809899}, 'weighted avg': {'precision': 0.41371835497302606, 'recall': 0.3377491109344368, 'f1-score': 0.2988922286650871, 'support': 3809899}}
[[567164 107479 294831]
 [921868 219476 713792]
 [386383  98756 500150]]
Evaluating performance on  train set...
6147/6147 - 81s - 81s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3251244
{'0': {'precision': 0.3848675593535014, 'recall': 0.5824653780128249, 'f1-score': 0.4634847419835497, 'support': 519612}, '1': {'precision': 0.39050649433112977, 'recall': 0.10656485727817759, 'f1-score': 0.16743780827387802, 'support': 519402}, '2': {'precision': 0.4135113022889692, 'recall': 0.4993011781743069, 'f1-score': 0.45237479732198027, 'support': 534471}, 'accuracy': 0.39712358236653034, 'macro avg': {'precision': 0.39629511865786676, 'recall': 0.3961104711551031, 'f1-score': 0.36109911585980264, 'support': 1573485}, 'weighted avg': {'precision': 0.3964584699981612, 'recall': 0.39712358236653034, 'f1-score': 0.361986912200689, 'support': 1573485}}
[[302656  44559 172397]
 [257955  55350 206097]
 [225779  41830 266862]]
Evaluating performance on  val set...
2174/2174 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3210467
{'0': {'precision': 0.3722779044972621, 'recall': 0.5689790263788425, 'f1-score': 0.4500754527162978, 'support': 176126}, '1': {'precision': 0.4760505270297002, 'recall': 0.16868012756647424, 'f1-score': 0.2490970859071468, 'support': 199739}, '2': {'precision': 0.4085820895522388, 'recall': 0.4897945626359756, 'f1-score': 0.4455175573979753, 'support': 180639}, 'accuracy': 0.3996017998073689, 'macro avg': {'precision': 0.41897017369306705, 'recall': 0.40915123886043075, 'f1-score': 0.3815633653404733, 'support': 556504}, 'weighted avg': {'precision': 0.4213079052450601, 'recall': 0.3996017998073689, 'f1-score': 0.37646133375129576, 'support': 556504}}
[[100212  18997  56917]
 [ 94896  33692  71151]
 [ 74078  18085  88476]]
training model: results/universal/W2/deepVOL_L2/h100
Epoch 1/50
9940/9940 - 603s - loss: 3.1777 - accuracy100: 0.4263 - val_loss: 3.4512 - val_accuracy100: 0.3960 - 603s/epoch - 61ms/step
Epoch 2/50
9940/9940 - 581s - loss: 3.1418 - accuracy100: 0.4374 - val_loss: 3.5144 - val_accuracy100: 0.3987 - 581s/epoch - 58ms/step
Epoch 3/50
9940/9940 - 616s - loss: 3.1284 - accuracy100: 0.4421 - val_loss: 3.5598 - val_accuracy100: 0.3988 - 616s/epoch - 62ms/step
Epoch 4/50
9940/9940 - 622s - loss: 3.1188 - accuracy100: 0.4460 - val_loss: 3.6063 - val_accuracy100: 0.4006 - 622s/epoch - 63ms/step
Epoch 5/50
9940/9940 - 632s - loss: 3.1113 - accuracy100: 0.4485 - val_loss: 3.6181 - val_accuracy100: 0.4020 - 632s/epoch - 64ms/step
Epoch 6/50
9940/9940 - 634s - loss: 3.1057 - accuracy100: 0.4507 - val_loss: 3.5815 - val_accuracy100: 0.4001 - 634s/epoch - 64ms/step
Epoch 7/50
9940/9940 - 633s - loss: 3.1006 - accuracy100: 0.4525 - val_loss: 3.5790 - val_accuracy100: 0.4018 - 633s/epoch - 64ms/step
Epoch 8/50
9940/9940 - 635s - loss: 3.0965 - accuracy100: 0.4537 - val_loss: 3.5646 - val_accuracy100: 0.4032 - 635s/epoch - 64ms/step
Epoch 9/50
9940/9940 - 644s - loss: 3.0931 - accuracy100: 0.4552 - val_loss: 3.5663 - val_accuracy100: 0.4024 - 644s/epoch - 65ms/step
Epoch 10/50
9940/9940 - 642s - loss: 3.0902 - accuracy100: 0.4561 - val_loss: 3.5911 - val_accuracy100: 0.4022 - 642s/epoch - 65ms/step
Epoch 11/50
9940/9940 - 634s - loss: 3.0874 - accuracy100: 0.4573 - val_loss: 3.5615 - val_accuracy100: 0.4032 - 634s/epoch - 64ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1062s - 1062s/epoch - 40ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1689489
{'0': {'precision': 0.39794960201708524, 'recall': 0.2676287077695134, 'f1-score': 0.32003067461549994, 'support': 2142528}, '1': {'precision': 0.39974245389038326, 'recall': 0.3894652696036513, 'f1-score': 0.3945369462102586, 'support': 2385576}, '2': {'precision': 0.3807639917527001, 'recall': 0.5132562429737328, 'f1-score': 0.43719255622099645, 'support': 2192665}, 'accuracy': 0.39101180236963956, 'macro avg': {'precision': 0.39281868255338953, 'recall': 0.3901167401156325, 'f1-score': 0.38392005901558496, 'support': 6720769}, 'weighted avg': {'precision': 0.3929791437659739, 'recall': 0.39101180236963956, 'f1-score': 0.3847014184688379, 'support': 6720769}}
[[ 573402  724403  844723]
 [ 470965  929099  985512]
 [ 396524  670742 1125399]]
Evaluating performance on  train set...
9940/9940 - 407s - 407s/epoch - 41ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1584536
{'0': {'precision': 0.40320194103181345, 'recall': 0.27944328435364685, 'f1-score': 0.3301043366884295, 'support': 833747}, '1': {'precision': 0.4091969991304269, 'recall': 0.3655821104964444, 'f1-score': 0.3861619413640547, 'support': 863702}, '2': {'precision': 0.3837342900018758, 'recall': 0.5415357343339143, 'f1-score': 0.44917878037699005, 'support': 846175}, 'accuracy': 0.3958812308737455, 'macro avg': {'precision': 0.398711076721372, 'recall': 0.39552037639466847, 'f1-score': 0.3884816861431581, 'support': 2543624}, 'weighted avg': {'precision': 0.3987613885207627, 'recall': 0.3958812308737455, 'f1-score': 0.388750930155748, 'support': 2543624}}
[[232985 236018 364744]
 [176782 315754 371166]
 [168070 219871 458234]]
Evaluating performance on  val set...
3393/3393 - 146s - 146s/epoch - 43ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.151728
{'0': {'precision': 0.4037251681284284, 'recall': 0.27161935342625704, 'f1-score': 0.3247514879561248, 'support': 287763}, '1': {'precision': 0.39558488249736934, 'recall': 0.3752846610583672, 'f1-score': 0.3851674768808799, 'support': 288501}, '2': {'precision': 0.3911359842710254, 'recall': 0.537185211583734, 'f1-score': 0.4526719144340554, 'support': 291823}, 'accuracy': 0.39534631897494144, 'macro avg': {'precision': 0.3968153449656077, 'recall': 0.3946964086894528, 'f1-score': 0.3875302930903534, 'support': 868087}, 'weighted avg': {'precision': 0.3967877368045345, 'recall': 0.39534631897494144, 'f1-score': 0.3878329484973493, 'support': 868087}}
[[ 78162  85993 123608]
 [ 59813 108270 120418]
 [ 55627  79433 156763]]
testing model out of sample: results/universal/W2/deepVOL_L2/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 566s - 566s/epoch - 40ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1312877
{'0': {'precision': 0.42047923461203096, 'recall': 0.2733306610967235, 'f1-score': 0.33130074357485284, 'support': 1277332}, '1': {'precision': 0.3645358796216616, 'recall': 0.5383752227570857, 'f1-score': 0.4347207269402644, 'support': 1081896}, '2': {'precision': 0.4326971208965105, 'recall': 0.4098875338908838, 'f1-score': 0.4209835885290554, 'support': 1307505}, 'accuracy': 0.4002282140532185, 'macro avg': {'precision': 0.4059040783767343, 'recall': 0.4071978059148977, 'f1-score': 0.39566835301472425, 'support': 3666733}, 'weighted avg': {'precision': 0.4083294695257069, 'recall': 0.4002282140532185, 'f1-score': 0.3937951860431073, 'support': 3666733}}
[[349134 517067 411131]
 [207911 582466 291519]
 [273279 498296 535930]]
Evaluating performance on  train set...
5373/5373 - 211s - 211s/epoch - 39ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1153098
{'0': {'precision': 0.4311680780302395, 'recall': 0.2698375565709788, 'f1-score': 0.3319383893776272, 'support': 457390}, '1': {'precision': 0.3977544181725686, 'recall': 0.6260152518956082, 'f1-score': 0.4864381893015247, 'support': 459615}, '2': {'precision': 0.4375472255987385, 'recall': 0.3490424493379371, 'f1-score': 0.38831568781092257, 'support': 457887}, 'accuracy': 0.4152828003945037, 'macro avg': {'precision': 0.42215657393384887, 'recall': 0.41496508593484144, 'f1-score': 0.4022307554966915, 'support': 1374892}, 'weighted avg': {'precision': 0.4221226471652798, 'recall': 0.4152828003945037, 'f1-score': 0.40236199907915177, 'support': 1374892}}
[[123421 224432 109537]
 [ 75980 287726  95909]
 [ 86847 211218 159822]]
Evaluating performance on  val set...
1685/1685 - 69s - 69s/epoch - 41ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1249007
{'0': {'precision': 0.4259660729052589, 'recall': 0.2608642093593025, 'f1-score': 0.32357135581134766, 'support': 146122}, '1': {'precision': 0.3826869616734266, 'recall': 0.6031069997270782, 'f1-score': 0.4682544108134633, 'support': 139234}, '2': {'precision': 0.43240579519695127, 'recall': 0.36230009083652176, 'f1-score': 0.39426072369997606, 'support': 145316}, 'accuracy': 0.40573568748374633, 'macro avg': {'precision': 0.41368627659187895, 'recall': 0.4087570999743008, 'f1-score': 0.39536216344159564, 'support': 430672}, 'weighted avg': {'precision': 0.41414703408055387, 'recall': 0.40573568748374633, 'f1-score': 0.39419841460381266, 'support': 430672}}
[[38118 70012 37992]
 [24145 83973 31116]
 [27223 65445 52648]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/LILAK
Evaluating performance on  test set...
987/987 - 15s - 15s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2572172
{'0': {'precision': 0.32011291460832747, 'recall': 0.27644676788060185, 'f1-score': 0.2966817342771181, 'support': 73837}, '1': {'precision': 0.34207727756114853, 'recall': 0.04958074725636072, 'f1-score': 0.0866084490356396, 'support': 97316}, '2': {'precision': 0.33729992841803863, 'recall': 0.7241154631063903, 'f1-score': 0.46022338817113145, 'support': 81342}, 'accuracy': 0.33322640052278263, 'macro avg': {'precision': 0.3331633735291715, 'recall': 0.350047659414451, 'f1-score': 0.2811711904946297, 'support': 252495}, 'weighted avg': {'precision': 0.33411521177233566, 'recall': 0.33322640052278263, 'f1-score': 0.26840122727494825, 'support': 252495}}
[[20412  5174 48251]
 [25018  4825 67473]
 [18335  4106 58901]]
Evaluating performance on  train set...
237/237 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2077186
{'0': {'precision': 0.3467903255137298, 'recall': 0.29093775427176566, 'f1-score': 0.3164182406459998, 'support': 19664}, '1': {'precision': 0.34339080459770116, 'recall': 0.08342475316645058, 'f1-score': 0.13423734253390032, 'support': 20054}, '2': {'precision': 0.3618585652284912, 'recall': 0.6807550069641227, 'f1-score': 0.4725375472987614, 'support': 20821}, 'accuracy': 0.35626620855977137, 'macro avg': {'precision': 0.35067989844664066, 'recall': 0.351705838134113, 'f1-score': 0.3077310434928872, 'support': 60539}, 'weighted avg': {'precision': 0.35084658390337964, 'recall': 0.35626620855977137, 'f1-score': 0.3097630985570507, 'support': 60539}}
[[ 5721  1666 12277]
 [ 5662  1673 12719]
 [ 5114  1533 14174]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.210174
{'0': {'precision': 0.3673547400611621, 'recall': 0.27927927927927926, 'f1-score': 0.3173188046887898, 'support': 6882}, '1': {'precision': 0.33979057591623035, 'recall': 0.08649873383979742, 'f1-score': 0.13789440135982153, 'support': 7503}, '2': {'precision': 0.36118411951860563, 'recall': 0.7237699237699238, 'f1-score': 0.48188990910349283, 'support': 7215}, 'accuracy': 0.360787037037037, 'macro avg': {'precision': 0.35610981183199936, 'recall': 0.3631826456296668, 'f1-score': 0.3123677050507014, 'support': 21600}, 'weighted avg': {'precision': 0.3557188627095895, 'recall': 0.360787037037037, 'f1-score': 0.30996506488206915, 'support': 21600}}
[[1922  819 4141]
 [1759  649 5095]
 [1551  442 5222]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198606
{'0': {'precision': 0.47565184704234015, 'recall': 0.2655208263784897, 'f1-score': 0.3407990500033666, 'support': 104843}, '1': {'precision': 0.3915486341108214, 'recall': 0.8398274941305685, 'f1-score': 0.5340907634536762, 'support': 99243}, '2': {'precision': 0.56098086536804, 'recall': 0.22894479962713146, 'f1-score': 0.3251790833182406, 'support': 113713}, 'accuracy': 0.43177920635370154, 'macro avg': {'precision': 0.4760604488404005, 'recall': 0.44476437337872987, 'f1-score': 0.40002296559176115, 'support': 317799}, 'weighted avg': {'precision': 0.47991983876008504, 'recall': 0.43177920635370154, 'f1-score': 0.39557158310222257, 'support': 317799}}
[[27838 62567 14438]
 [ 9960 83347  5936]
 [20728 66951 26034]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0748507
{'0': {'precision': 0.5498039215686275, 'recall': 0.21962740703251152, 'f1-score': 0.3138733898188331, 'support': 41493}, '1': {'precision': 0.453298478812374, 'recall': 0.9192863710166475, 'f1-score': 0.6071917719719875, 'support': 51119}, '2': {'precision': 0.5894342194955692, 'recall': 0.20441113895324098, 'f1-score': 0.303552622340799, 'support': 42302}, 'accuracy': 0.4799576026209289, 'macro avg': {'precision': 0.5308455399588569, 'recall': 0.4477749723341333, 'f1-score': 0.4082059280438732, 'support': 134914}, 'weighted avg': {'precision': 0.5256639445065625, 'recall': 0.4799576026209289, 'f1-score': 0.4217758556224658, 'support': 134914}}
[[ 9113 28307  4073]
 [ 2176 46993  1950]
 [ 5286 28369  8647]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0798875
{'0': {'precision': 0.5343454915756342, 'recall': 0.20943396226415095, 'f1-score': 0.300922788175799, 'support': 13780}, '1': {'precision': 0.4307737821313523, 'recall': 0.913813541594031, 'f1-score': 0.5855282264370127, 'support': 14341}, '2': {'precision': 0.5712489522212909, 'recall': 0.2185345518678852, 'f1-score': 0.31613127681781283, 'support': 12474}, 'accuracy': 0.4610666338218993, 'macro avg': {'precision': 0.5121227419760924, 'recall': 0.4472606852420224, 'f1-score': 0.4008607638102082, 'support': 40595}, 'weighted avg': {'precision': 0.5090963693426862, 'recall': 0.4610666338218993, 'f1-score': 0.4061386343988449, 'support': 40595}}
[[ 2886  9505  1389]
 [  579 13105   657]
 [ 1936  7812  2726]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2002558
{'0': {'precision': 0.35352039037992333, 'recall': 0.2667528738781191, 'f1-score': 0.30406785377461604, 'support': 91253}, '1': {'precision': 0.32247236653624956, 'recall': 0.3752736863057325, 'f1-score': 0.34687517966998216, 'support': 80384}, '2': {'precision': 0.4081709313037179, 'recall': 0.44491888940882857, 'f1-score': 0.4257534272134038, 'support': 102576}, 'accuracy': 0.36521244434071326, 'macro avg': {'precision': 0.36138789607329697, 'recall': 0.3623151498642267, 'f1-score': 0.358898820219334, 'support': 274213}, 'weighted avg': {'precision': 0.36486219232640027, 'recall': 0.36521244434071326, 'f1-score': 0.3621360105207594, 'support': 274213}}
[[24342 30207 36704]
 [20749 30166 29469]
 [23765 33173 45638]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2425077
{'0': {'precision': 0.34978293125240423, 'recall': 0.2575880210441117, 'f1-score': 0.2966881860768639, 'support': 24710}, '1': {'precision': 0.3267444339536442, 'recall': 0.4440764963987085, 'f1-score': 0.3764804969205664, 'support': 24158}, '2': {'precision': 0.3592656548214123, 'recall': 0.3271267792121814, 'f1-score': 0.3424437995408671, 'support': 24168}, 'accuracy': 0.34228325757160855, 'macro avg': {'precision': 0.34526434000915357, 'recall': 0.3429304322183339, 'f1-score': 0.3385374941794325, 'support': 73036}, 'weighted avg': {'precision': 0.3453004081880571, 'recall': 0.34228325757160855, 'f1-score': 0.3382217354437542, 'support': 73036}}
[[ 6365 11092  7253]
 [ 6583 10728  6847]
 [ 5249 11013  7906]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2380909
{'0': {'precision': 0.3450588384157915, 'recall': 0.28696201199621174, 'f1-score': 0.3133402275077559, 'support': 9503}, '1': {'precision': 0.36148089799133515, 'recall': 0.4403608099030803, 'f1-score': 0.3970410105554594, 'support': 10421}, '2': {'precision': 0.36782108348713494, 'recall': 0.34274152756702075, 'f1-score': 0.3548387096774194, 'support': 9885}, 'accuracy': 0.35908618202556275, 'macro avg': {'precision': 0.3581202732980872, 'recall': 0.3566881164887709, 'f1-score': 0.3550733159135449, 'support': 29809}, 'weighted avg': {'precision': 0.3583480824483646, 'recall': 0.35908618202556275, 'f1-score': 0.3563627494436558, 'support': 29809}}
[[2727 3835 2941]
 [2950 4589 2882]
 [2226 4271 3388]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/CHTR
Evaluating performance on  test set...
860/860 - 13s - 13s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1505928
{'0': {'precision': 0.3222258521180442, 'recall': 0.20164367878754838, 'f1-score': 0.248057206569031, 'support': 73372}, '1': {'precision': 0.2780489481644438, 'recall': 0.12382322776187488, 'f1-score': 0.17134263230917507, 'support': 65327}, '2': {'precision': 0.3632750781373976, 'recall': 0.6480644962766939, 'f1-score': 0.46557197301288344, 'support': 81245}, 'accuracy': 0.34343287382242754, 'macro avg': {'precision': 0.32118329280662855, 'recall': 0.3245104676087057, 'f1-score': 0.29499060396369653, 'support': 219944}, 'weighted avg': {'precision': 0.32426773443065793, 'recall': 0.34343287382242754, 'f1-score': 0.3056193778810794, 'support': 219944}}
[[14795  9817 48760]
 [13713  8089 43525]
 [17407 11186 52652]]
Evaluating performance on  train set...
320/320 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1635484
{'0': {'precision': 0.32555309734513277, 'recall': 0.21184092136044627, 'f1-score': 0.25666630328136925, 'support': 27785}, '1': {'precision': 0.312010930319215, 'recall': 0.09343500092988655, 'f1-score': 0.14380581634989695, 'support': 26885}, '2': {'precision': 0.3282389155910785, 'recall': 0.6750333185251, 'f1-score': 0.44169906616765386, 'support': 27012}, 'accuracy': 0.326044905854411, 'macro avg': {'precision': 0.3219343144184754, 'recall': 0.3267697469384776, 'f1-score': 0.28072372859964, 'support': 81682}, 'weighted avg': {'precision': 0.32198398985471494, 'recall': 0.326044905854411, 'f1-score': 0.28070894180554457, 'support': 81682}}
[[ 5886  2880 19019]
 [ 6075  2512 18298]
 [ 6119  2659 18234]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1571718
{'0': {'precision': 0.33896731054977713, 'recall': 0.21618099976308933, 'f1-score': 0.2639953710400694, 'support': 8442}, '1': {'precision': 0.3100390209294076, 'recall': 0.10692439442133594, 'f1-score': 0.15901027926862552, 'support': 8174}, '2': {'precision': 0.3319608545172455, 'recall': 0.6666267225883763, 'f1-score': 0.443213958491017, 'support': 8345}, 'accuracy': 0.33099635431272784, 'macro avg': {'precision': 0.32698906199881006, 'recall': 0.3299107055909339, 'f1-score': 0.288739869599904, 'support': 24961}, 'weighted avg': {'precision': 0.32715172964563155, 'recall': 0.33099635431272784, 'f1-score': 0.2895324477652958, 'support': 24961}}
[[1825 1006 5611]
 [1716  874 5584]
 [1843  939 5563]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 30s - 30s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2307564
{'0': {'precision': 0.34097013493636885, 'recall': 0.26084563544966427, 'f1-score': 0.2955740806186724, 'support': 163522}, '1': {'precision': 0.31512924981705265, 'recall': 0.4147393765861912, 'f1-score': 0.3581370780581825, 'support': 153670}, '2': {'precision': 0.4014909674681232, 'recall': 0.37790270195163467, 'f1-score': 0.38933988655138885, 'support': 172727}, 'accuracy': 0.3503864924609987, 'macro avg': {'precision': 0.35253011740718154, 'recall': 0.35116257132916334, 'f1-score': 0.34768368174274794, 'support': 489919}, 'weighted avg': {'precision': 0.35420214476743683, 'recall': 0.3503864924609987, 'f1-score': 0.3482561406691498, 'support': 489919}}
[[42654 69529 51339]
 [43971 63733 45966]
 [38471 68982 65274]]
Evaluating performance on  train set...
716/716 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2180623
{'0': {'precision': 0.36018754313730156, 'recall': 0.24697281242860405, 'f1-score': 0.2930248317924391, 'support': 61278}, '1': {'precision': 0.3427037947817924, 'recall': 0.545554959959716, 'f1-score': 0.4209668726420416, 'support': 61563}, '2': {'precision': 0.38589972830504143, 'recall': 0.27585405531024865, 'f1-score': 0.32172692512463097, 'support': 60242}, 'accuracy': 0.35687638939715866, 'macro avg': {'precision': 0.36293035540804514, 'recall': 0.3561272758995229, 'f1-score': 0.34523954318637057, 'support': 183083}, 'weighted avg': {'precision': 0.36276889399382445, 'recall': 0.35687638939715866, 'f1-score': 0.3454904750653917, 'support': 183083}}
[[15134 33215 12929]
 [14461 33586 13516]
 [12422 31202 16618]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.227679
{'0': {'precision': 0.381262278978389, 'recall': 0.3190997379374133, 'f1-score': 0.3474223055190355, 'support': 19461}, '1': {'precision': 0.2867386725227446, 'recall': 0.40386314859234945, 'f1-score': 0.3353688900537282, 'support': 15842}, '2': {'precision': 0.39948919205133, 'recall': 0.33140406180559145, 'f1-score': 0.3622754491017964, 'support': 19351}, 'accuracy': 0.34802576206682034, 'macro avg': {'precision': 0.3558300478508212, 'recall': 0.35145564944511803, 'f1-score': 0.3483555482248533, 'support': 54654}, 'weighted avg': {'precision': 0.36031717013739223, 'recall': 0.34802576206682034, 'f1-score': 0.3491874640375083, 'support': 54654}}
[[6210 7950 5301]
 [5105 6398 4339]
 [4973 7965 6413]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/EXC
Evaluating performance on  test set...
4918/4918 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.080381
{'0': {'precision': 0.5625695914939082, 'recall': 0.213522149316735, 'f1-score': 0.30955378597522, 'support': 409358}, '1': {'precision': 0.39955927214289033, 'recall': 0.9229644587668531, 'f1-score': 0.5576898149191822, 'support': 428854}, '2': {'precision': 0.6457982522998387, 'recall': 0.1732366205688175, 'f1-score': 0.2731896052382461, 'support': 420627}, 'accuracy': 0.44174989812041093, 'macro avg': {'precision': 0.5359757053122124, 'recall': 0.4365744095508018, 'f1-score': 0.3801444020442161, 'support': 1258839}, 'weighted avg': {'precision': 0.5348461053402814, 'recall': 0.44174989812041093, 'f1-score': 0.381936650111049, 'support': 1258839}}
[[ 87407 297204  24747]
 [ 17818 395817  15219]
 [ 50146 297613  72868]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0436049
{'0': {'precision': 0.5724786406376784, 'recall': 0.21691322747495206, 'f1-score': 0.31461735195750545, 'support': 110588}, '1': {'precision': 0.44435736947673316, 'recall': 0.9312452972159518, 'f1-score': 0.6016355167489722, 'support': 138216}, '2': {'precision': 0.6565999197578145, 'recall': 0.16339311646819635, 'f1-score': 0.261670288459442, 'support': 110176}, 'accuracy': 0.47552231322079225, 'macro avg': {'precision': 0.5578119766240753, 'recall': 0.43718388038636674, 'f1-score': 0.3926410523886399, 'support': 358980}, 'weighted avg': {'precision': 0.5489668473164876, 'recall': 0.47552231322079225, 'f1-score': 0.40887610452548895, 'support': 358980}}
[[ 23988  80915   5685]
 [  5773 128713   3730]
 [ 12141  80033  18002]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.073898
{'0': {'precision': 0.5828402366863905, 'recall': 0.19686875416389074, 'f1-score': 0.29432270916334663, 'support': 39026}, '1': {'precision': 0.41371773206099915, 'recall': 0.9302389078498293, 'f1-score': 0.5727213509746376, 'support': 43950}, '2': {'precision': 0.6491506440171738, 'recall': 0.17500817795224075, 'f1-score': 0.2756912099890992, 'support': 39741}, 'accuracy': 0.4524393523309729, 'macro avg': {'precision': 0.5485695375881878, 'recall': 0.43403861332198695, 'f1-score': 0.3809117567090278, 'support': 122717}, 'weighted avg': {'precision': 0.5437446575852612, 'recall': 0.4524393523309729, 'f1-score': 0.38799502757825627, 'support': 122717}}
[[ 7683 29005  2338]
 [ 1645 40884  1421]
 [ 3854 28932  6955]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/AAL
Evaluating performance on  test set...
4856/4856 - 69s - 69s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861841
{'0': {'precision': 0.49476429173966646, 'recall': 0.25475378068083576, 'f1-score': 0.3363309798775394, 'support': 478882}, '1': {'precision': 0.34992126981112665, 'recall': 0.7256780350766646, 'f1-score': 0.4721650122943512, 'support': 304704}, '2': {'precision': 0.48591201457642746, 'recall': 0.3855229154465633, 'f1-score': 0.4299350646985771, 'support': 459319}, 'accuracy': 0.418529171577876, 'macro avg': {'precision': 0.4435325253757402, 'recall': 0.4553182437346879, 'f1-score': 0.4128103522901559, 'support': 1242905}, 'weighted avg': {'precision': 0.45598396078271036, 'recall': 0.418529171577876, 'f1-score': 0.40422298099544174, 'support': 1242905}}
[[121997 218267 138618]
 [ 34859 221117  48728]
 [ 89720 192521 177078]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.068581
{'0': {'precision': 0.47834548436172525, 'recall': 0.2761485993247559, 'f1-score': 0.3501536681491123, 'support': 175344}, '1': {'precision': 0.4170244375338361, 'recall': 0.7400216713770261, 'f1-score': 0.5334396250800207, 'support': 179038}, '2': {'precision': 0.4975105800348519, 'recall': 0.3160968886277877, 'f1-score': 0.38657842378689067, 'support': 177028}, 'accuracy': 0.4457405769556463, 'macro avg': {'precision': 0.464293500643471, 'recall': 0.44408905310985664, 'f1-score': 0.4233905723386746, 'support': 531410}, 'weighted avg': {'precision': 0.4640701808763762, 'recall': 0.4457405769556463, 'f1-score': 0.42403890327460975, 'support': 531410}}
[[ 48421  95631  31292]
 [ 21320 132492  25226]
 [ 31485  89585  55958]]
Evaluating performance on  val set...
588/588 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0865147
{'0': {'precision': 0.50570564712767, 'recall': 0.20503796267004112, 'f1-score': 0.2917756956754171, 'support': 50576}, '1': {'precision': 0.39343101997092356, 'recall': 0.8233551512240037, 'f1-score': 0.5324410559765972, 'support': 49959}, '2': {'precision': 0.5103358149849517, 'recall': 0.25890507282772474, 'f1-score': 0.34352966265477763, 'support': 49775}, 'accuracy': 0.42838799813718315, 'macro avg': {'precision': 0.46982416069451505, 'recall': 0.4290993955739231, 'f1-score': 0.38924880476893065, 'support': 150310}, 'weighted avg': {'precision': 0.4699218570070679, 'recall': 0.42838799813718315, 'f1-score': 0.3889046587629318, 'support': 150310}}
[[10370 33138  7068]
 [ 3528 41134  5297]
 [ 6608 30280 12887]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/WBA
Evaluating performance on  test set...
4353/4353 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0783256
{'0': {'precision': 0.48502688803239163, 'recall': 0.22568524726460698, 'f1-score': 0.3080386775999811, 'support': 375266}, '1': {'precision': 0.41924585859425384, 'recall': 0.7106551838391639, 'f1-score': 0.527372276905682, 'support': 383297}, '2': {'precision': 0.4442880988839686, 'recall': 0.3621449153137958, 'f1-score': 0.3990329589998777, 'support': 355725}, 'accuracy': 0.436070387547923, 'macro avg': {'precision': 0.4495202818368713, 'recall': 0.4328284488058555, 'f1-score': 0.4114813045018469, 'support': 1114288}, 'weighted avg': {'precision': 0.44939384073189775, 'recall': 0.436070387547923, 'f1-score': 0.41253486831912684, 'support': 1114288}}
[[ 84692 203585  86989]
 [ 36762 272392  74143]
 [ 53159 173742 128824]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1132269
{'0': {'precision': 0.45493051138747176, 'recall': 0.2490775727939542, 'f1-score': 0.32190819995499526, 'support': 134970}, '1': {'precision': 0.3910195109497579, 'recall': 0.7044465925567908, 'f1-score': 0.5028952721221885, 'support': 128278}, '2': {'precision': 0.45363702339083345, 'recall': 0.3094086737996421, 'f1-score': 0.3678920680912713, 'support': 131315}, 'accuracy': 0.41720333634932827, 'macro avg': {'precision': 0.4331956819093543, 'recall': 0.42097761305012904, 'f1-score': 0.39756518005615166, 'support': 394563}, 'weighted avg': {'precision': 0.4337216557917174, 'recall': 0.41720333634932827, 'f1-score': 0.3960535995180012, 'support': 394563}}
[[33618 73750 27602]
 [16580 90365 21333]
 [23699 66986 40630]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1106968
{'0': {'precision': 0.4477156898434656, 'recall': 0.23815748069614892, 'f1-score': 0.3109229091943308, 'support': 41313}, '1': {'precision': 0.39497477999570724, 'recall': 0.722066902099274, 'f1-score': 0.5106312868539715, 'support': 40776}, '2': {'precision': 0.45587905935050393, 'recall': 0.29628102180927196, 'f1-score': 0.3591477849171458, 'support': 41221}, 'accuracy': 0.4176060335739194, 'macro avg': {'precision': 0.43285650972989226, 'recall': 0.4188351348682316, 'f1-score': 0.39356732698848274, 'support': 123310}, 'weighted avg': {'precision': 0.43300430321219013, 'recall': 0.4176060335739194, 'f1-score': 0.39308320770718186, 'support': 123310}}
[[ 9839 23227  8247]
 [ 5003 29443  6330]
 [ 7134 21874 12213]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 86s - 86s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004679
{'0': {'precision': 0.42860878661087864, 'recall': 0.29651709738250204, 'f1-score': 0.35053177971965505, 'support': 469838}, '1': {'precision': 0.4004781500958282, 'recall': 0.5891544158879553, 'f1-score': 0.476830449412399, 'support': 445822}, '2': {'precision': 0.44550316678395496, 'recall': 0.3863726525355972, 'f1-score': 0.4138363834258875, 'support': 491541}, 'accuracy': 0.42061581820933897, 'macro avg': {'precision': 0.42486336783022055, 'recall': 0.42401472193535156, 'f1-score': 0.41373287085264715, 'support': 1407201}, 'weighted avg': {'precision': 0.42559786201108174, 'recall': 0.42061581820933897, 'f1-score': 0.4126576122980314, 'support': 1407201}}
[[139315 194049 136474]
 [ 83256 262658  99908]
 [102469 199154 189918]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988036
{'0': {'precision': 0.43940383642301856, 'recall': 0.2707631778858691, 'f1-score': 0.335060279421514, 'support': 176394}, '1': {'precision': 0.40378331262402406, 'recall': 0.6227731948147046, 'f1-score': 0.48992027578323477, 'support': 174802}, '2': {'precision': 0.43790902480407207, 'recall': 0.3703281936821008, 'f1-score': 0.4012932204644735, 'support': 175628}, 'accuracy': 0.4207534204971679, 'macro avg': {'precision': 0.4270320579503715, 'recall': 0.4212881887942248, 'f1-score': 0.40875792522307414, 'support': 526824}, 'weighted avg': {'precision': 0.42708649785050823, 'recall': 0.4207534204971679, 'f1-score': 0.40852351582212293, 'support': 526824}}
[[ 47761  82870  45763]
 [ 28219 108862  37721]
 [ 32715  77873  65040]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958407
{'0': {'precision': 0.42786864460504626, 'recall': 0.28262981574539364, 'f1-score': 0.34040449891562014, 'support': 59700}, '1': {'precision': 0.40035548508369245, 'recall': 0.5640346610459566, 'f1-score': 0.46830501376091904, 'support': 55509}, '2': {'precision': 0.43673779142620145, 'recall': 0.41878490438314436, 'f1-score': 0.4275729799310589, 'support': 59090}, 'accuracy': 0.4184074492682115, 'macro avg': {'precision': 0.42165397370498003, 'recall': 0.4218164603914982, 'f1-score': 0.41209416420253264, 'support': 174299}, 'weighted avg': {'precision': 0.42211330414865367, 'recall': 0.4184074492682115, 'f1-score': 0.41068840887350844, 'support': 174299}}
[[16873 24363 18464]
 [10749 31309 13451]
 [11813 22531 24746]]
testing model on single stock: results/universal/W2/deepVOL_L2/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 205s - 205s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2299523
{'0': {'precision': 0.3562845144075463, 'recall': 0.30413185169989715, 'f1-score': 0.32814895166040453, 'support': 1179689}, '1': {'precision': 0.38286439794136984, 'recall': 0.11986329324167498, 'f1-score': 0.182569563630958, 'support': 1408855}, '2': {'precision': 0.3576861423087769, 'recall': 0.6916834171882867, 'f1-score': 0.4715318277606716, 'support': 1221355}, 'accuracy': 0.3602305467940226, 'macro avg': {'precision': 0.3656116848858977, 'recall': 0.37189285404328626, 'f1-score': 0.32741678101734467, 'support': 3809899}, 'weighted avg': {'precision': 0.3665627624821941, 'recall': 0.3602305467940226, 'f1-score': 0.32028027690477867, 'support': 3809899}}
[[358781 150930 669978]
 [392932 168870 847053]
 [255294 121270 844791]]
Evaluating performance on  train set...
6147/6147 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.2027092
{'0': {'precision': 0.3749324373334332, 'recall': 0.3087986186455866, 'f1-score': 0.33866713445744023, 'support': 518911}, '1': {'precision': 0.3417606545418136, 'recall': 0.09203704131709309, 'f1-score': 0.1450198550287014, 'support': 519204}, '2': {'precision': 0.3703428763933732, 'recall': 0.6960961577974112, 'f1-score': 0.483467399560601, 'support': 535370}, 'accuracy': 0.36904959373619706, 'macro avg': {'precision': 0.3623453227562066, 'recall': 0.36564393925336364, 'f1-score': 0.3223847963489142, 'support': 1573485}, 'weighted avg': {'precision': 0.36242514584160457, 'recall': 0.36904959373619706, 'f1-score': 0.32403672861293603, 'support': 1573485}}
[[160239  50459 308213]
 [146019  47786 325399]
 [121123  41578 372669]]
Evaluating performance on  val set...
2174/2174 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1828249
{'0': {'precision': 0.37824525745257453, 'recall': 0.3014492284100604, 'f1-score': 0.33550880102884, 'support': 185202}, '1': {'precision': 0.35748214979237, 'recall': 0.13203133620214058, 'f1-score': 0.19283981853782745, 'support': 181260}, '2': {'precision': 0.37861374788716745, 'recall': 0.6812704560044621, 'f1-score': 0.4867293233082707, 'support': 190042}, 'accuracy': 0.37597393729425127, 'macro avg': {'precision': 0.37144705171070397, 'recall': 0.3715836735388877, 'f1-score': 0.33835931429164606, 'support': 556504}, 'weighted avg': {'precision': 0.37160830203928413, 'recall': 0.37597393729425127, 'f1-score': 0.3406804992173645, 'support': 556504}}
[[ 55829  23277 106096]
 [ 50936  23932 106392]
 [ 40835  19737 129470]]
training model: results/universal/W2/deepVOL_L2/h200
Epoch 1/50
9940/9940 - 652s - loss: 3.2429 - accuracy200: 0.3954 - val_loss: 3.3032 - val_accuracy200: 0.3487 - 652s/epoch - 66ms/step
Epoch 2/50
9940/9940 - 651s - loss: 3.2362 - accuracy200: 0.3991 - val_loss: 3.2955 - val_accuracy200: 0.3584 - 651s/epoch - 66ms/step
Epoch 3/50
9940/9940 - 653s - loss: 3.2245 - accuracy200: 0.4043 - val_loss: 3.3075 - val_accuracy200: 0.3493 - 653s/epoch - 66ms/step
Epoch 4/50
9940/9940 - 650s - loss: 3.2136 - accuracy200: 0.4101 - val_loss: 3.3295 - val_accuracy200: 0.3486 - 650s/epoch - 65ms/step
Epoch 5/50
9940/9940 - 647s - loss: 3.2054 - accuracy200: 0.4134 - val_loss: 3.3404 - val_accuracy200: 0.3496 - 647s/epoch - 65ms/step
Epoch 6/50
9940/9940 - 642s - loss: 3.2011 - accuracy200: 0.4152 - val_loss: 3.3480 - val_accuracy200: 0.3483 - 642s/epoch - 65ms/step
Epoch 7/50
9940/9940 - 637s - loss: 3.1983 - accuracy200: 0.4169 - val_loss: 3.3423 - val_accuracy200: 0.3498 - 637s/epoch - 64ms/step
Epoch 8/50
9940/9940 - 636s - loss: 3.1951 - accuracy200: 0.4183 - val_loss: 3.3598 - val_accuracy200: 0.3466 - 636s/epoch - 64ms/step
Epoch 9/50
9940/9940 - 644s - loss: 3.1922 - accuracy200: 0.4191 - val_loss: 3.3782 - val_accuracy200: 0.3442 - 644s/epoch - 65ms/step
Epoch 10/50
9940/9940 - 643s - loss: 3.1902 - accuracy200: 0.4201 - val_loss: 3.3711 - val_accuracy200: 0.3447 - 643s/epoch - 65ms/step
Epoch 11/50
9940/9940 - 639s - loss: 3.1885 - accuracy200: 0.4208 - val_loss: 3.3795 - val_accuracy200: 0.3396 - 639s/epoch - 64ms/step
Epoch 12/50
9940/9940 - 633s - loss: 3.1868 - accuracy200: 0.4214 - val_loss: 3.3954 - val_accuracy200: 0.3374 - 633s/epoch - 64ms/step
testing model in sample: results/universal/W2/deepVOL_L2/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1080s - 1080s/epoch - 41ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927815
{'0': {'precision': 0.3747468238625968, 'recall': 0.2267734032715164, 'f1-score': 0.28255945113401854, 'support': 2077263}, '1': {'precision': 0.37988763452031843, 'recall': 0.683325928866707, 'f1-score': 0.4883065447295825, 'support': 2539008}, '2': {'precision': 0.3907801908823457, 'recall': 0.16650241530284182, 'f1-score': 0.23351113030358767, 'support': 2104498}, 'accuracy': 0.38037938813251876, 'macro avg': {'precision': 0.38180488308842025, 'recall': 0.3588672491470217, 'f1-score': 0.3347923753890629, 'support': 6720769}, 'weighted avg': {'precision': 0.3817095312868169, 'recall': 0.38037938813251876, 'f1-score': 0.3449290138321094, 'support': 6720769}}
[[ 471068 1399957  206238]
 [ 464002 1734970  340036]
 [ 321960 1432134  350404]]
Evaluating performance on  train set...
9940/9940 - 398s - 398s/epoch - 40ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1045375
{'0': {'precision': 0.38595417176841, 'recall': 0.1982838433678953, 'f1-score': 0.2619770523636971, 'support': 845727}, '1': {'precision': 0.33017946713478535, 'recall': 0.7072530924892348, 'f1-score': 0.45018916563049777, 'support': 839049}, '2': {'precision': 0.4198103678811801, 'recall': 0.15244257423898058, 'f1-score': 0.22366673357734376, 'support': 858848}, 'accuracy': 0.35069609344777375, 'macro avg': {'precision': 0.3786480022614585, 'recall': 0.35265983669870354, 'f1-score': 0.3119443171905129, 'support': 2543624}, 'weighted avg': {'precision': 0.37898758243402814, 'recall': 0.35069609344777375, 'f1-score': 0.3111260007756376, 'support': 2543624}}
[[167694 595203  82830]
 [147517 593420  98112]
 [119281 608642 130925]]
Evaluating performance on  val set...
3393/3393 - 139s - 139s/epoch - 41ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994911
{'0': {'precision': 0.38287017224778, 'recall': 0.20183580021925263, 'f1-score': 0.2643274097908102, 'support': 283691}, '1': {'precision': 0.3414869616979556, 'recall': 0.689229164212758, 'f1-score': 0.4566975664471645, 'support': 297145}, '2': {'precision': 0.4157589939563307, 'recall': 0.17195066335713366, 'f1-score': 0.2432835122508638, 'support': 287251}, 'accuracy': 0.35878085952214467, 'macro avg': {'precision': 0.3800387093006888, 'recall': 0.3543385425963814, 'f1-score': 0.3214361628296129, 'support': 868087}, 'weighted avg': {'precision': 0.3795877049671679, 'recall': 0.35878085952214467, 'f1-score': 0.3232120026800082, 'support': 868087}}
[[ 57259 196163  30269]
 [ 53204 204801  39140]
 [ 39089 198769  49393]]
testing model out of sample: results/universal/W2/deepVOL_L2/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 568s - 568s/epoch - 40ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.107835
{'0': {'precision': 0.3759965948657833, 'recall': 0.21692932119913141, 'f1-score': 0.27512606174728016, 'support': 1241999}, '1': {'precision': 0.3056640094323311, 'recall': 0.651348646090387, 'f1-score': 0.4160735755235411, 'support': 1139921}, '2': {'precision': 0.42364261643215195, 'recall': 0.17181488668000713, 'f1-score': 0.24447792749166755, 'support': 1284813}, 'accuracy': 0.336174463752883, 'macro avg': {'precision': 0.3684344069100887, 'recall': 0.34669761798984183, 'f1-score': 0.31189252158749625, 'support': 3666733}, 'weighted avg': {'precision': 0.3708264984303091, 'recall': 0.336174463752883, 'f1-score': 0.30820507500894734, 'support': 3666733}}
[[269426 826754 145819]
 [242928 742486 154507]
 [204211 859852 220750]]
Evaluating performance on  train set...
5373/5373 - 211s - 211s/epoch - 39ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100578
{'0': {'precision': 0.388159404985997, 'recall': 0.25686637904842924, 'f1-score': 0.30915074504068013, 'support': 460796}, '1': {'precision': 0.3281065245601621, 'recall': 0.6230318256123635, 'f1-score': 0.42984452672939955, 'support': 456959}, '2': {'precision': 0.412806795482863, 'recall': 0.18263890256093906, 'f1-score': 0.2532374668063919, 'support': 457137}, 'accuracy': 0.3538852506233217, 'macro avg': {'precision': 0.376357575009674, 'recall': 0.35417903574057724, 'f1-score': 0.3307442461921572, 'support': 1374892}, 'weighted avg': {'precision': 0.3763952300275688, 'recall': 0.3538852506233217, 'f1-score': 0.33067394941928424, 'support': 1374892}}
[[118363 289586  52847]
 [106345 284700  65914]
 [ 80226 293420  83491]]
Evaluating performance on  val set...
1685/1685 - 67s - 67s/epoch - 40ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0998416
{'0': {'precision': 0.3869552434583984, 'recall': 0.23645987368537433, 'f1-score': 0.2935424101015647, 'support': 144718}, '1': {'precision': 0.3297200927081476, 'recall': 0.6490944826617998, 'f1-score': 0.4373034451774609, 'support': 142460}, '2': {'precision': 0.42226645950670033, 'recall': 0.1818264178293169, 'f1-score': 0.2541966660496293, 'support': 143494}, 'accuracy': 0.3547502507708883, 'macro avg': {'precision': 0.37964726522441544, 'recall': 0.3557935913921637, 'f1-score': 0.32834750710955163, 'support': 430672}, 'weighted avg': {'precision': 0.37978790511217275, 'recall': 0.3547502507708883, 'f1-score': 0.327986996375861, 'support': 430672}}
[[34220 94123 16375]
 [30668 92470 19322]
 [23546 93857 26091]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/LILAK
Evaluating performance on  test set...
987/987 - 14s - 14s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1062193
{'0': {'precision': 0.3331534149885821, 'recall': 0.09924428887707017, 'f1-score': 0.15293131051307463, 'support': 80851}, '1': {'precision': 0.33014628002175594, 'recall': 0.8226398944327544, 'f1-score': 0.47119146111026, 'support': 84117}, '2': {'precision': 0.40564533276631937, 'recall': 0.08718452591771682, 'f1-score': 0.14352213204938924, 'support': 87527}, 'accuracy': 0.33605813976514387, 'macro avg': {'precision': 0.3563150092588858, 'recall': 0.3363562364091805, 'f1-score': 0.2558816345575746, 'support': 252495}, 'weighted avg': {'precision': 0.3572808191562983, 'recall': 0.33605813976514387, 'f1-score': 0.2556958481252746, 'support': 252495}}
[[ 8024 67339  5488]
 [ 9226 69198  5693]
 [ 6835 73061  7631]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1139588
{'0': {'precision': 0.3464809118870997, 'recall': 0.09614901842646985, 'f1-score': 0.15052664675365507, 'support': 19917}, '1': {'precision': 0.3268187188369811, 'recall': 0.8234196054689471, 'f1-score': 0.4679185779816513, 'support': 19821}, '2': {'precision': 0.36566134437216635, 'recall': 0.08917840488438056, 'f1-score': 0.1433871840457602, 'support': 20801}, 'accuracy': 0.33186871273063645, 'macro avg': {'precision': 0.3463203250320824, 'recall': 0.3362490095932658, 'f1-score': 0.25394413626035556, 'support': 60539}, 'weighted avg': {'precision': 0.34663367040104065, 'recall': 0.33186871273063645, 'f1-score': 0.2519904552916751, 'support': 60539}}
[[ 1915 16440  1562]
 [ 1844 16321  1656]
 [ 1768 17178  1855]]
Evaluating performance on  val set...
85/85 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1080371
{'0': {'precision': 0.35913978494623655, 'recall': 0.08961631338878455, 'f1-score': 0.14343998282155895, 'support': 7454}, '1': {'precision': 0.30946748975941846, 'recall': 0.7887075430083811, 'f1-score': 0.44451810723460683, 'support': 6801}, '2': {'precision': 0.3614457831325301, 'recall': 0.11844792375765827, 'f1-score': 0.17842493847415913, 'support': 7345}, 'accuracy': 0.31953703703703706, 'macro avg': {'precision': 0.3433510192793951, 'recall': 0.33225726005160794, 'f1-score': 0.25546100951010836, 'support': 21600}, 'weighted avg': {'precision': 0.34428405703479104, 'recall': 0.31953703703703706, 'f1-score': 0.25013428020125744, 'support': 21600}}
[[ 668 5978  808]
 [ 708 5364  729]
 [ 484 5991  870]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1097208
{'0': {'precision': 0.3540361641889692, 'recall': 0.3590120641017946, 'f1-score': 0.35650675236047025, 'support': 99966}, '1': {'precision': 0.3340272293151874, 'recall': 0.5942181364795206, 'f1-score': 0.4276564043326134, 'support': 107474}, '2': {'precision': 0.473828109521734, 'recall': 0.10835545809585082, 'f1-score': 0.17637688427387238, 'support': 110359}, 'accuracy': 0.35151148996692877, 'macro avg': {'precision': 0.3872971676752969, 'recall': 0.35386188622572196, 'f1-score': 0.320180013655652, 'support': 317799}, 'weighted avg': {'precision': 0.388868492259082, 'recall': 0.35151148996692877, 'f1-score': 0.31801634044566013, 'support': 317799}}
[[35889 58243  5834]
 [36166 63863  7445]
 [29316 69085 11958]]
Evaluating performance on  train set...
528/528 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0940735
{'0': {'precision': 0.4140722291407223, 'recall': 0.3868095483120428, 'f1-score': 0.3999768665779886, 'support': 44699}, '1': {'precision': 0.34474454851279074, 'recall': 0.6376230975828111, 'f1-score': 0.44752509464490486, 'support': 44680}, '2': {'precision': 0.5214828897338403, 'recall': 0.12047875260788404, 'f1-score': 0.19573633038979577, 'support': 45535}, 'accuracy': 0.3799828038602369, 'macro avg': {'precision': 0.42676655579578443, 'recall': 0.381637132834246, 'f1-score': 0.3477460972042297, 'support': 134914}, 'weighted avg': {'precision': 0.42736502054600006, 'recall': 0.3799828038602369, 'f1-score': 0.3467901106794196, 'support': 134914}}
[[17290 25023  2386]
 [13543 28489  2648]
 [10923 29126  5486]]
Evaluating performance on  val set...
159/159 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0895635
{'0': {'precision': 0.42543898743203495, 'recall': 0.3223693097392949, 'f1-score': 0.3668011527377522, 'support': 14806}, '1': {'precision': 0.33514711026468186, 'recall': 0.6556915823891719, 'f1-score': 0.4435699588477366, 'support': 13151}, '2': {'precision': 0.4743624897175761, 'recall': 0.13688874821965502, 'f1-score': 0.21246545901136016, 'support': 12638}, 'accuracy': 0.3726074639733957, 'macro avg': {'precision': 0.41164952913809766, 'recall': 0.3716498801160406, 'f1-score': 0.34094552353228297, 'support': 40595}, 'weighted avg': {'precision': 0.41141920039562185, 'recall': 0.3726074639733957, 'f1-score': 0.34362322619109037, 'support': 40595}}
[[4773 9010 1023]
 [3634 8623  894]
 [2812 8096 1730]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1160942
{'0': {'precision': 0.35608866442199777, 'recall': 0.14020880517041373, 'f1-score': 0.20119694027188773, 'support': 90515}, '1': {'precision': 0.2880879266313058, 'recall': 0.6820724348539186, 'f1-score': 0.40508114198484385, 'support': 81701}, '2': {'precision': 0.4050820797979574, 'recall': 0.17926997852878027, 'f1-score': 0.24854556328838628, 'support': 101997}, 'accuracy': 0.3161848635914417, 'macro avg': {'precision': 0.3497528902837536, 'recall': 0.33385040618437084, 'f1-score': 0.28494121518170595, 'support': 274213}, 'weighted avg': {'precision': 0.354051755558685, 'recall': 0.3161848635914417, 'f1-score': 0.2795555909046587, 'support': 274213}}
[[12691 64879 12945]
 [12066 55726 13909]
 [10883 72829 18285]]
Evaluating performance on  train set...
286/286 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093189
{'0': {'precision': 0.3534466050778474, 'recall': 0.21823766404722963, 'f1-score': 0.2698530137121436, 'support': 25069}, '1': {'precision': 0.3165521549031855, 'recall': 0.6424949290060852, 'f1-score': 0.42413591095489167, 'support': 23664}, '2': {'precision': 0.37955284979531856, 'recall': 0.1487882154466527, 'f1-score': 0.21377475613360925, 'support': 24303}, 'accuracy': 0.33258940796319625, 'macro avg': {'precision': 0.3498505365921171, 'recall': 0.3365069361666559, 'f1-score': 0.3025878936002148, 'support': 73036}, 'weighted avg': {'precision': 0.35017958328634047, 'recall': 0.33258940796319625, 'f1-score': 0.30118113390521645, 'support': 73036}}
[[ 5471 16507  3091]
 [ 5640 15204  2820]
 [ 4368 16319  3616]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132989
{'0': {'precision': 0.3413715146948003, 'recall': 0.23124042879019907, 'f1-score': 0.2757151552038953, 'support': 9795}, '1': {'precision': 0.3203785233540813, 'recall': 0.6415036984496909, 'f1-score': 0.4273371582855215, 'support': 9869}, '2': {'precision': 0.4022853794315851, 'recall': 0.13533760473139478, 'f1-score': 0.20253724738161974, 'support': 10145}, 'accuracy': 0.3344291992351303, 'macro avg': {'precision': 0.3546784724934889, 'recall': 0.3360272439904282, 'f1-score': 0.30186318695701214, 'support': 29809}, 'weighted avg': {'precision': 0.35515229654635944, 'recall': 0.3344291992351303, 'f1-score': 0.3010084449336944, 'support': 29809}}
[[2265 6590  940]
 [2438 6331 1100]
 [1932 6840 1373]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/CHTR
Evaluating performance on  test set...
860/860 - 12s - 12s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1406735
{'0': {'precision': 0.2977416440831075, 'recall': 0.0228043228582894, 'f1-score': 0.04236394951286599, 'support': 72267}, '1': {'precision': 0.2878231395282965, 'recall': 0.9608226302103853, 'f1-score': 0.44295506805723556, 'support': 63455}, '2': {'precision': 0.33475397132894225, 'recall': 0.010258602265441334, 'f1-score': 0.019907146066380194, 'support': 84222}, 'accuracy': 0.28862346779180154, 'macro avg': {'precision': 0.3067729183134487, 'recall': 0.33129518511137196, 'f1-score': 0.16840872121216058, 'support': 219944}, 'weighted avg': {'precision': 0.3090530393417786, 'recall': 0.28862346779180154, 'f1-score': 0.14933732695150057, 'support': 219944}}
[[ 1648 69791   828]
 [ 1597 60969   889]
 [ 2290 81068   864]]
Evaluating performance on  train set...
320/320 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156535
{'0': {'precision': 0.3495850622406639, 'recall': 0.024741208428162395, 'f1-score': 0.04621186150154268, 'support': 27242}, '1': {'precision': 0.33341400965568196, 'recall': 0.9616430303475642, 'f1-score': 0.49515233491926863, 'support': 27218}, '2': {'precision': 0.31974420463629094, 'recall': 0.014693997502020424, 'f1-score': 0.028096793453447122, 'support': 27222}, 'accuracy': 0.33358634705320633, 'macro avg': {'precision': 0.3342477588442123, 'recall': 0.3336927454259157, 'f1-score': 0.18982032995808615, 'support': 81682}, 'weighted avg': {'precision': 0.33425155504245274, 'recall': 0.33358634705320633, 'f1-score': 0.18977021490961798, 'support': 81682}}
[[  674 26133   435]
 [  628 26174   416]
 [  626 26196   400]]
Evaluating performance on  val set...
98/98 - 1s - 1s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1189734
{'0': {'precision': 0.3815580286168522, 'recall': 0.02843601895734597, 'f1-score': 0.05292755540853456, 'support': 8440}, '1': {'precision': 0.326, 'recall': 0.9625984251968503, 'f1-score': 0.48705179282868527, 'support': 8128}, '2': {'precision': 0.2740963855421687, 'recall': 0.010842368640533779, 'f1-score': 0.0208595988538682, 'support': 8393}, 'accuracy': 0.3267096670806458, 'macro avg': {'precision': 0.327218138053007, 'recall': 0.3339589375982433, 'f1-score': 0.18694631569702935, 'support': 24961}, 'weighted avg': {'precision': 0.32733338910226567, 'recall': 0.3267096670806458, 'f1-score': 0.18350787840792038, 'support': 24961}}
[[ 240 8072  128]
 [ 191 7824  113]
 [ 198 8104   91]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1137767
{'0': {'precision': 0.37082639638485887, 'recall': 0.2501897808417012, 'f1-score': 0.29879084714406273, 'support': 162029}, '1': {'precision': 0.3087464693631064, 'recall': 0.6289147757358164, 'f1-score': 0.41416922700743125, 'support': 154862}, '2': {'precision': 0.39201510407073126, 'recall': 0.14760038837644773, 'f1-score': 0.21445485691253524, 'support': 173028}, 'accuracy': 0.33367148446988176, 'macro avg': {'precision': 0.35719598993956553, 'recall': 0.34223498165132177, 'f1-score': 0.30913831035467637, 'support': 489919}, 'weighted avg': {'precision': 0.3586864672435692, 'recall': 0.33367148446988176, 'f1-score': 0.3054761133709701, 'support': 489919}}
[[ 40538 102821  18670]
 [ 36528  97395  20939]
 [ 32252 115237  25539]]
Evaluating performance on  train set...
716/716 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1059294
{'0': {'precision': 0.3759491293498967, 'recall': 0.22552712055367777, 'f1-score': 0.2819287532318588, 'support': 62130}, '1': {'precision': 0.32498967439939425, 'recall': 0.6266945426186802, 'f1-score': 0.42801856269442384, 'support': 60267}, '2': {'precision': 0.3782267874037032, 'recall': 0.18445770029331313, 'f1-score': 0.24797855607983876, 'support': 60686}, 'accuracy': 0.3439696749561674, 'macro avg': {'precision': 0.35972186371766474, 'recall': 0.34555978782189034, 'f1-score': 0.31930862400204046, 'support': 183083}, 'weighted avg': {'precision': 0.3599293376988497, 'recall': 0.3439696749561674, 'f1-score': 0.318765012647058, 'support': 183083}}
[[14012 39762  8356]
 [12452 37769 10046]
 [10807 38685 11194]]
Evaluating performance on  val set...
214/214 - 3s - 3s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130816
{'0': {'precision': 0.3795021186440678, 'recall': 0.22614413466596528, 'f1-score': 0.28340694838156766, 'support': 19010}, '1': {'precision': 0.3067391544320565, 'recall': 0.6611742311581702, 'f1-score': 0.41906234094293743, 'support': 16811}, '2': {'precision': 0.385049365303244, 'recall': 0.14495831784633356, 'f1-score': 0.2106237703969448, 'support': 18833}, 'accuracy': 0.3319793610714678, 'macro avg': {'precision': 0.35709687945978946, 'recall': 0.34409222789015637, 'f1-score': 0.3043643532404833, 'support': 54654}, 'weighted avg': {'precision': 0.3590324934558683, 'recall': 0.3319793610714678, 'f1-score': 0.3000530715082333, 'support': 54654}}
[[ 4299 12567  2144]
 [ 3480 11115  2216]
 [ 3549 12554  2730]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/EXC
Evaluating performance on  test set...
4918/4918 - 68s - 68s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096262
{'0': {'precision': 0.39696854732354164, 'recall': 0.5093981824925816, 'f1-score': 0.44621023667617704, 'support': 431360}, '1': {'precision': 0.28347723513741163, 'recall': 0.40748240235413075, 'f1-score': 0.3343523370072777, 'support': 385705}, '2': {'precision': 0.5141238069989396, 'recall': 0.17558978120034224, 'f1-score': 0.26177499856577363, 'support': 441774}, 'accuracy': 0.361025516368654, 'macro avg': {'precision': 0.39818986315329763, 'recall': 0.3641567886823515, 'f1-score': 0.34744585741640943, 'support': 1258839}, 'weighted avg': {'precision': 0.4033092955217528, 'recall': 0.361025516368654, 'f1-score': 0.34721199776494366, 'support': 1258839}}
[[219734 183370  28256]
 [183484 157168  45053]
 [150312 213891  77571]]
Evaluating performance on  train set...
1403/1403 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930626
{'0': {'precision': 0.3913498731183326, 'recall': 0.5229594146357524, 'f1-score': 0.4476824271718108, 'support': 121497}, '1': {'precision': 0.30441934354047834, 'recall': 0.41946464890206486, 'f1-score': 0.3528000463895855, 'support': 116036}, '2': {'precision': 0.515897212543554, 'recall': 0.1560516109908026, 'f1-score': 0.23962119823242706, 'support': 121447}, 'accuracy': 0.3653769012201237, 'macro avg': {'precision': 0.4038888097341216, 'recall': 0.36615855817620657, 'f1-score': 0.3467012239312744, 'support': 358980}, 'weighted avg': {'precision': 0.40538639270460197, 'recall': 0.3653769012201237, 'f1-score': 0.3466233597935512, 'support': 358980}}
[[63538 51222  6737]
 [56316 48673 11047]
 [42502 59993 18952]]
Evaluating performance on  val set...
480/480 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924814
{'0': {'precision': 0.39833806471019534, 'recall': 0.5072904446093807, 'f1-score': 0.4462604519893006, 'support': 41767}, '1': {'precision': 0.2990016821472976, 'recall': 0.4243894843380998, 'f1-score': 0.3508286403861625, 'support': 38533}, '2': {'precision': 0.5165161116354321, 'recall': 0.1806351227102341, 'f1-score': 0.26766344692669125, 'support': 42417}, 'accuracy': 0.36835157313167693, 'macro avg': {'precision': 0.4046186194976416, 'recall': 0.3707716838859048, 'f1-score': 0.3549175131007181, 'support': 122717}, 'weighted avg': {'precision': 0.4079946680099144, 'recall': 0.36835157313167693, 'f1-score': 0.35456310638726973, 'support': 122717}}
[[21188 17712  2867]
 [17875 16353  4305]
 [14128 20627  7662]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/AAL
Evaluating performance on  test set...
4856/4856 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033064
{'0': {'precision': 0.3860476197351892, 'recall': 0.24659890611597385, 'f1-score': 0.3009545357331802, 'support': 433684}, '1': {'precision': 0.30423249248451145, 'recall': 0.6237425271285154, 'f1-score': 0.4089824395834036, 'support': 389074}, '2': {'precision': 0.4234293154806143, 'recall': 0.16950495897864318, 'f1-score': 0.24209553012044094, 'support': 420147}, 'accuracy': 0.3385978815758244, 'macro avg': {'precision': 0.371236475900105, 'recall': 0.3466154640743775, 'f1-score': 0.31734416847900826, 'support': 1242905}, 'weighted avg': {'precision': 0.3730729100851539, 'recall': 0.3385978815758244, 'f1-score': 0.3148746776840503, 'support': 1242905}}
[[106946 280665  46073]
 [ 95491 242682  50901]
 [ 74591 274339  71217]]
Evaluating performance on  train set...
2076/2076 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968981
{'0': {'precision': 0.3979903696048899, 'recall': 0.30560182788195306, 'f1-score': 0.3457303388670476, 'support': 177692}, '1': {'precision': 0.32748162818736615, 'recall': 0.5966704502459327, 'f1-score': 0.4228711163406854, 'support': 177081}, '2': {'precision': 0.4371733539805879, 'recall': 0.17900553111748954, 'f1-score': 0.2540056152922322, 'support': 176637}, 'accuracy': 0.3605144803447432, 'macro avg': {'precision': 0.38754845059094806, 'recall': 0.36042593641512516, 'f1-score': 0.34086902349998843, 'support': 531410}, 'weighted avg': {'precision': 0.38751899415507457, 'recall': 0.3605144803447432, 'f1-score': 0.3409471884139598, 'support': 531410}}
[[ 54303 106154  17235]
 [ 47950 105659  23472]
 [ 34190 110828  31619]]
Evaluating performance on  val set...
588/588 - 7s - 7s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0915936
{'0': {'precision': 0.3929136766568172, 'recall': 0.30074109973546576, 'f1-score': 0.3407034601086646, 'support': 49521}, '1': {'precision': 0.3432415726616482, 'recall': 0.6001543954453343, 'f1-score': 0.4367157492644632, 'support': 51815}, '2': {'precision': 0.43617021276595747, 'recall': 0.1942255074120962, 'f1-score': 0.26876889604701765, 'support': 48974}, 'accuracy': 0.3692502162198124, 'macro avg': {'precision': 0.39077515402814095, 'recall': 0.3650403341976321, 'f1-score': 0.3487293684733818, 'support': 150310}, 'weighted avg': {'precision': 0.38988450714646755, 'recall': 0.3692502162198124, 'f1-score': 0.35036318615651635, 'support': 150310}}
[[14893 29481  5147]
 [13569 31097  7149]
 [ 9442 30020  9512]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/WBA
Evaluating performance on  test set...
4353/4353 - 59s - 59s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0903298
{'0': {'precision': 0.4222624036468382, 'recall': 0.24714613221148166, 'f1-score': 0.3117991906267756, 'support': 380799}, '1': {'precision': 0.3412828114005478, 'recall': 0.6252850358779105, 'f1-score': 0.44156038414058196, 'support': 382408}, '2': {'precision': 0.40709833994663924, 'recall': 0.22121675624713386, 'f1-score': 0.2866618191481901, 'support': 351081}, 'accuracy': 0.3687484743621039, 'macro avg': {'precision': 0.39021451833134174, 'recall': 0.36454930811217534, 'f1-score': 0.3466737979718492, 'support': 1114288}, 'weighted avg': {'precision': 0.3896935717473212, 'recall': 0.3687484743621039, 'f1-score': 0.348411327680351, 'support': 1114288}}
[[ 94113 240796  45890]
 [ 76072 239114  67222]
 [ 52693 220723  77665]]
Evaluating performance on  train set...
1542/1542 - 20s - 20s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970306
{'0': {'precision': 0.39454575324461966, 'recall': 0.2695842188762834, 'f1-score': 0.32030871415043594, 'support': 133628}, '1': {'precision': 0.33768258592857986, 'recall': 0.6512030491925258, 'f1-score': 0.4447428940333992, 'support': 131707}, '2': {'precision': 0.42583421287651213, 'recall': 0.1623487169963166, 'f1-score': 0.235075295804948, 'support': 129228}, 'accuracy': 0.36184842471291023, 'macro avg': {'precision': 0.3860208506832372, 'recall': 0.36104532835504194, 'f1-score': 0.33337563466292774, 'support': 394563}, 'weighted avg': {'precision': 0.3858122122983489, 'recall': 0.36184842471291023, 'f1-score': 0.33392962727177455, 'support': 394563}}
[[36024 84760 12844]
 [30495 85768 15444]
 [24786 83462 20980]]
Evaluating performance on  val set...
482/482 - 6s - 6s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982445
{'0': {'precision': 0.39117731127131833, 'recall': 0.29938504168590946, 'f1-score': 0.33918048135705237, 'support': 41141}, '1': {'precision': 0.334095656082278, 'recall': 0.6154089658363162, 'f1-score': 0.43307943416757344, 'support': 41067}, '2': {'precision': 0.43160042034987944, 'recall': 0.1698700793148752, 'f1-score': 0.2437891722970024, 'support': 41102}, 'accuracy': 0.3614629794826048, 'macro avg': {'precision': 0.3856244625678252, 'recall': 0.3615546956123669, 'f1-score': 0.33868302927387606, 'support': 123310}, 'weighted avg': {'precision': 0.38564084460761466, 'recall': 0.3614629794826048, 'f1-score': 0.33865639336810976, 'support': 123310}}
[[12317 24682  4142]
 [10741 25273  5053]
 [ 8429 25691  6982]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082698
{'0': {'precision': 0.3736899635885581, 'recall': 0.2130737808473006, 'f1-score': 0.27139895455898644, 'support': 474920}, '1': {'precision': 0.3032097813563703, 'recall': 0.6436012060432343, 'f1-score': 0.4122178207944755, 'support': 430167}, '2': {'precision': 0.4378635429400465, 'recall': 0.19474661132730814, 'f1-score': 0.2695892269073676, 'support': 502114}, 'accuracy': 0.3381421701661667, 'macro avg': {'precision': 0.371587762628325, 'recall': 0.3504738660726144, 'f1-score': 0.31773533408694316, 'support': 1407201}, 'weighted avg': {'precision': 0.37504314914784903, 'recall': 0.3381421701661667, 'f1-score': 0.3138001038204329, 'support': 1407201}}
[[101193 311214  62513]
 [ 90286 276856  63025]
 [ 79315 325014  97785]]
Evaluating performance on  train set...
2058/2058 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0996685
{'0': {'precision': 0.38557051247116103, 'recall': 0.24120394572357207, 'f1-score': 0.2967610685048343, 'support': 175988}, '1': {'precision': 0.3311671219946087, 'recall': 0.6214925678207647, 'f1-score': 0.4320911385809334, 'support': 176126}, '2': {'precision': 0.41145488926785695, 'recall': 0.2030049796806136, 'f1-score': 0.27187256859671377, 'support': 174710}, 'accuracy': 0.3556728622841784, 'macro avg': {'precision': 0.3760641745778755, 'recall': 0.35523383107498346, 'f1-score': 0.3335749252274938, 'support': 526824}, 'weighted avg': {'precision': 0.3759665610928591, 'recall': 0.3556728622841784, 'f1-score': 0.33375041239060127, 'support': 526824}}
[[ 42449 110880  22659]
 [ 38592 109461  28073]
 [ 29053 110190  35467]]
Evaluating performance on  val set...
681/681 - 8s - 8s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1004373
{'0': {'precision': 0.3870670354273673, 'recall': 0.19946384336081985, 'f1-score': 0.26326279252043444, 'support': 58938}, '1': {'precision': 0.3300202718307088, 'recall': 0.6749527674760338, 'f1-score': 0.44329168461869883, 'support': 57164}, '2': {'precision': 0.42278649689073144, 'recall': 0.19626441225492722, 'f1-score': 0.2680811613251499, 'support': 58197}, 'accuracy': 0.3543393823257735, 'macro avg': {'precision': 0.3799579347162692, 'recall': 0.356893674363927, 'f1-score': 0.324878546154761, 'support': 174299}, 'weighted avg': {'precision': 0.38028411816762403, 'recall': 0.3543393823257735, 'f1-score': 0.3239148111621548, 'support': 174299}}
[[11756 39722  7460]
 [10447 38583  8134]
 [ 8169 38606 11422]]
testing model on single stock: results/universal/W2/deepVOL_L2/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 195s - 195s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0881549
{'0': {'precision': 0.3199246261376241, 'recall': 0.10952344787262175, 'f1-score': 0.16318270000259033, 'support': 1092871}, '1': {'precision': 0.417353900389379, 'recall': 0.7588823762504954, 'f1-score': 0.5385355407838261, 'support': 1599966}, '2': {'precision': 0.3463427512174369, 'recall': 0.1632451914038791, 'f1-score': 0.22190002543231901, 'support': 1117062}, 'accuracy': 0.3979727546583256, 'macro avg': {'precision': 0.36120709258148004, 'recall': 0.3438836718423321, 'f1-score': 0.30787275540624515, 'support': 3809899}, 'weighted avg': {'precision': 0.3685858137033283, 'recall': 0.3979727546583256, 'f1-score': 0.338027932443811, 'support': 3809899}}
[[ 119695  847973  125203]
 [ 166822 1214186  218958]
 [  87618  847089  182355]]
Evaluating performance on  train set...
6147/6147 - 79s - 79s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109205
{'0': {'precision': 0.3654330358120288, 'recall': 0.09654090051112384, 'f1-score': 0.15273257463221498, 'support': 518661}, '1': {'precision': 0.33107859788413924, 'recall': 0.7787461879678403, 'f1-score': 0.4646250458753008, 'support': 519408}, '2': {'precision': 0.39849305435901256, 'recall': 0.15982338966336457, 'f1-score': 0.22814485006432006, 'support': 535416}, 'accuracy': 0.3432705109994693, 'macro avg': {'precision': 0.36500156268506023, 'recall': 0.34503682604744296, 'f1-score': 0.2818341568572786, 'support': 1573485}, 'weighted avg': {'precision': 0.36534208673726964, 'recall': 0.3432705109994693, 'f1-score': 0.28134923355567765, 'support': 1573485}}
[[ 50072 407932  60657]
 [ 46411 404487  68510]
 [ 40538 409306  85572]]
Evaluating performance on  val set...
2174/2174 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101149
{'0': {'precision': 0.35807316244478843, 'recall': 0.10685096627745203, 'f1-score': 0.1645879877665228, 'support': 177537}, '1': {'precision': 0.34957617018030646, 'recall': 0.7472002282616449, 'f1-score': 0.47631111414252625, 'support': 196266}, '2': {'precision': 0.390344926087267, 'recall': 0.1795064066425471, 'f1-score': 0.24592173785894514, 'support': 182701}, 'accuracy': 0.3565401147161566, 'macro avg': {'precision': 0.36599808623745395, 'recall': 0.34451920039388134, 'f1-score': 0.2956069465893314, 'support': 556504}, 'weighted avg': {'precision': 0.36567133389632095, 'recall': 0.3565401147161566, 'f1-score': 0.30122745234709786, 'support': 556504}}
[[ 18970 136460  22107]
 [ 20501 146650  29115]
 [ 13507 136398  32796]]
training model: results/universal/W2/deepVOL_L3/h50
Epoch 1/50
9940/9940 - 769s - loss: 3.0755 - accuracy50: 0.4581 - val_loss: 3.6322 - val_accuracy50: 0.4489 - 769s/epoch - 77ms/step
Epoch 2/50
9940/9940 - 782s - loss: 2.9778 - accuracy50: 0.4897 - val_loss: 3.8339 - val_accuracy50: 0.4458 - 782s/epoch - 79ms/step
Epoch 3/50
9940/9940 - 784s - loss: 2.9546 - accuracy50: 0.4951 - val_loss: 3.8192 - val_accuracy50: 0.4504 - 784s/epoch - 79ms/step
Epoch 4/50
9940/9940 - 780s - loss: 2.9403 - accuracy50: 0.4992 - val_loss: 3.7053 - val_accuracy50: 0.4577 - 780s/epoch - 78ms/step
Epoch 5/50
9940/9940 - 772s - loss: 2.9295 - accuracy50: 0.5019 - val_loss: 3.6798 - val_accuracy50: 0.4601 - 772s/epoch - 78ms/step
Epoch 6/50
9940/9940 - 791s - loss: 2.9206 - accuracy50: 0.5039 - val_loss: 3.6694 - val_accuracy50: 0.4592 - 791s/epoch - 80ms/step
Epoch 7/50
9940/9940 - 776s - loss: 2.9149 - accuracy50: 0.5056 - val_loss: 3.7084 - val_accuracy50: 0.4593 - 776s/epoch - 78ms/step
Epoch 8/50
9940/9940 - 795s - loss: 2.9101 - accuracy50: 0.5065 - val_loss: 3.6197 - val_accuracy50: 0.4592 - 795s/epoch - 80ms/step
Epoch 9/50
9940/9940 - 790s - loss: 2.9051 - accuracy50: 0.5084 - val_loss: 3.6048 - val_accuracy50: 0.4594 - 790s/epoch - 79ms/step
Epoch 10/50
9940/9940 - 812s - loss: 2.9023 - accuracy50: 0.5087 - val_loss: 3.6424 - val_accuracy50: 0.4569 - 812s/epoch - 82ms/step
Epoch 11/50
9940/9940 - 819s - loss: 2.8978 - accuracy50: 0.5102 - val_loss: 3.6617 - val_accuracy50: 0.4553 - 819s/epoch - 82ms/step
Epoch 12/50
9940/9940 - 827s - loss: 2.8945 - accuracy50: 0.5109 - val_loss: 3.6687 - val_accuracy50: 0.4536 - 827s/epoch - 83ms/step
Epoch 13/50
9940/9940 - 796s - loss: 2.8916 - accuracy50: 0.5117 - val_loss: 3.6333 - val_accuracy50: 0.4577 - 796s/epoch - 80ms/step
Epoch 14/50
9940/9940 - 813s - loss: 2.8885 - accuracy50: 0.5123 - val_loss: 3.6589 - val_accuracy50: 0.4539 - 813s/epoch - 82ms/step
Epoch 15/50
9940/9940 - 816s - loss: 2.8860 - accuracy50: 0.5131 - val_loss: 3.6588 - val_accuracy50: 0.4513 - 816s/epoch - 82ms/step
Epoch 16/50
9940/9940 - 798s - loss: 2.8837 - accuracy50: 0.5136 - val_loss: 3.6546 - val_accuracy50: 0.4531 - 798s/epoch - 80ms/step
Epoch 17/50
9940/9940 - 815s - loss: 2.8817 - accuracy50: 0.5141 - val_loss: 3.7051 - val_accuracy50: 0.4489 - 815s/epoch - 82ms/step
Epoch 18/50
9940/9940 - 821s - loss: 2.8798 - accuracy50: 0.5148 - val_loss: 3.7241 - val_accuracy50: 0.4463 - 821s/epoch - 83ms/step
Epoch 19/50
9940/9940 - 786s - loss: 2.8781 - accuracy50: 0.5152 - val_loss: 3.6723 - val_accuracy50: 0.4462 - 786s/epoch - 79ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h50/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1190s - 1190s/epoch - 45ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3976713
{'0': {'precision': 0.3685850297512002, 'recall': 0.5651556674465797, 'f1-score': 0.4461793710502357, 'support': 1771565}, '1': {'precision': 0.602747432598851, 'recall': 0.3226903697144967, 'f1-score': 0.42034330429033007, 'support': 3144237}, '2': {'precision': 0.38082565483214575, 'recall': 0.4897214187295391, 'f1-score': 0.42846271186687146, 'support': 1804967}, 'accuracy': 0.43146193538269206, 'macro avg': {'precision': 0.4507193723940657, 'recall': 0.4591891519635385, 'f1-score': 0.4316617957358124, 'support': 6720769}, 'weighted avg': {'precision': 0.4814227147501889, 'recall': 0.43146193538269206, 'f1-score': 0.42933417041662, 'support': 6720769}}
[[1001210  317259  453096]
 [1145558 1014615  984064]
 [ 569593  351443  883931]]
Evaluating performance on  train set...
9940/9940 - 466s - 466s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2259766
{'0': {'precision': 0.42156036856196116, 'recall': 0.5923311095278192, 'f1-score': 0.4925641969369656, 'support': 787389}, '1': {'precision': 0.6250156457539758, 'recall': 0.349292986661544, 'f1-score': 0.44814050569243885, 'support': 957832}, '2': {'precision': 0.44283748770761244, 'recall': 0.5002874488197063, 'f1-score': 0.46981270113103857, 'support': 798403}, 'accuracy': 0.47192116444883364, 'macro avg': {'precision': 0.4964711673411832, 'recall': 0.4806371816696899, 'f1-score': 0.4701724679201476, 'support': 2543624}, 'weighted avg': {'precision': 0.504852431705188, 'recall': 0.47192116444883364, 'f1-score': 0.46869459374951844, 'support': 2543624}}
[[466395  94729 226265]
 [346983 334564 276285]
 [292976 105996 399431]]
Evaluating performance on  val set...
3393/3393 - 158s - 158s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2493104
{'0': {'precision': 0.4074341845500432, 'recall': 0.5800420064338968, 'f1-score': 0.4786524354793466, 'support': 263293}, '1': {'precision': 0.6149831406283037, 'recall': 0.3269023161717948, 'f1-score': 0.4268871795961169, 'support': 338101}, '2': {'precision': 0.43259475200061237, 'recall': 0.5085660291046259, 'f1-score': 0.4675141583738638, 'support': 266693}, 'accuracy': 0.45949081140484765, 'macro avg': {'precision': 0.48500402572631973, 'recall': 0.4718367839034392, 'f1-score': 0.4576845911497758, 'support': 868087}, 'weighted avg': {'precision': 0.4959997969991533, 'recall': 0.45949081140484765, 'f1-score': 0.4550691018786034, 'support': 868087}}
[[152721  33277  77295]
 [126972 110526 100603]
 [ 95143  35919 135631]]
testing model out of sample: results/universal/W2/deepVOL_L3/h50/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 668s - 668s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0778446
{'0': {'precision': 0.4453994264486194, 'recall': 0.5713636662442282, 'f1-score': 0.5005788488344287, 'support': 1201753}, '1': {'precision': 0.5615356504791295, 'recall': 0.443930839943985, 'f1-score': 0.49585539717149624, 'support': 1246095}, '2': {'precision': 0.4846121457205765, 'recall': 0.45324456367910015, 'f1-score': 0.4684037941815484, 'support': 1218885}, 'accuracy': 0.4887923391204105, 'macro avg': {'precision': 0.4971824075494418, 'recall': 0.4895130232891045, 'f1-score': 0.4882793467291578, 'support': 3666733}, 'weighted avg': {'precision': 0.4979019030164791, 'recall': 0.4887923391204105, 'f1-score': 0.48827810018692763, 'support': 3666733}}
[[686638 206453 308662]
 [414040 553180 278875]
 [440945 225487 552453]]
Evaluating performance on  train set...
5373/5373 - 254s - 254s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0183287
{'0': {'precision': 0.4622729642373058, 'recall': 0.5362420506965392, 'f1-score': 0.4965177260566369, 'support': 413401}, '1': {'precision': 0.5907270238522847, 'recall': 0.558604127689966, 'f1-score': 0.574216671007485, 'support': 544663}, '2': {'precision': 0.4861647607001896, 'recall': 0.4435570547084169, 'f1-score': 0.4638845852281638, 'support': 416828}, 'accuracy': 0.5170013353776152, 'macro avg': {'precision': 0.5130549162632599, 'recall': 0.5128010776983073, 'f1-score': 0.5115396607640953, 'support': 1374892}, 'weighted avg': {'precision': 0.5204033069901215, 'recall': 0.5170013353776152, 'f1-score': 0.5174047001815231, 'support': 1374892}}
[[221683  98064  93654]
 [138656 304251 101756]
 [119211 112730 184887]]
Evaluating performance on  val set...
1685/1685 - 79s - 79s/epoch - 47ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0388899
{'0': {'precision': 0.4591592245698105, 'recall': 0.5332936493173109, 'f1-score': 0.4934575835918056, 'support': 134395}, '1': {'precision': 0.5762349074233608, 'recall': 0.5372069317023446, 'f1-score': 0.5560369220537973, 'support': 161865}, '2': {'precision': 0.4843785374688703, 'recall': 0.44568937297265127, 'f1-score': 0.46422925513778246, 'support': 134412}, 'accuracy': 0.5074232826838058, 'macro avg': {'precision': 0.5065908898206805, 'recall': 0.5053966513307689, 'f1-score': 0.5045745869277951, 'support': 430672}, 'weighted avg': {'precision': 0.5110321898205775, 'recall': 0.5074232826838058, 'f1-score': 0.5078554700018534, 'support': 430672}}
[[71672 30292 32431]
 [43571 86955 31339]
 [40851 33655 59906]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/LILAK
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.6227076
{'0': {'precision': 0.32897280577393995, 'recall': 0.7813974846297099, 'f1-score': 0.46301405065491624, 'support': 78398}, '1': {'precision': 0.3076923076923077, 'recall': 0.007827168872299513, 'f1-score': 0.015265996757078723, 'support': 88410}, '2': {'precision': 0.39796970170232704, 'recall': 0.2973846674524724, 'f1-score': 0.3404022255321707, 'support': 85687}, 'accuracy': 0.3462801243588982, 'macro avg': {'precision': 0.34487827172285823, 'recall': 0.36220310698482727, 'f1-score': 0.27289409098138856, 'support': 252495}, 'weighted avg': {'precision': 0.344936401829381, 'recall': 0.3462801243588982, 'f1-score': 0.2646273701091608, 'support': 252495}}
[[61260   787 16351]
 [65521   692 22197]
 [59435   770 25482]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5509477
{'0': {'precision': 0.3460616079536194, 'recall': 0.7558482506102523, 'f1-score': 0.47475763819015226, 'support': 19664}, '1': {'precision': 0.3617494440326168, 'recall': 0.024329444610629174, 'f1-score': 0.04559256318026813, 'support': 20058}, '2': {'precision': 0.4154916569176775, 'recall': 0.3241581399817457, 'f1-score': 0.36418587079712883, 'support': 20817}, 'accuracy': 0.36503741389847866, 'macro avg': {'precision': 0.3744342363013045, 'recall': 0.36811194506754236, 'f1-score': 0.2948453573891831, 'support': 60539}, 'weighted avg': {'precision': 0.37513364325908083, 'recall': 0.36503741389847866, 'f1-score': 0.2945437998979964, 'support': 60539}}
[[14863   433  4368]
 [14445   488  5125]
 [13641   428  6748]]
Evaluating performance on  val set...
85/85 - 4s - 4s/epoch - 43ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.565115
{'0': {'precision': 0.3429140391636243, 'recall': 0.7426682001150087, 'f1-score': 0.4691885018845648, 'support': 6956}, '1': {'precision': 0.28361344537815125, 'recall': 0.018430034129692834, 'f1-score': 0.03461094731444687, 'support': 7325}, '2': {'precision': 0.404192110909391, 'recall': 0.334608553081022, 'f1-score': 0.36612348632082525, 'support': 7319}, 'accuracy': 0.3587962962962963, 'macro avg': {'precision': 0.3435731984837222, 'recall': 0.3652355957752412, 'f1-score': 0.28997431183994565, 'support': 21600}, 'weighted avg': {'precision': 0.34356762053532225, 'recall': 0.3587962962962963, 'f1-score': 0.2868915835448832, 'support': 21600}}
[[5166  170 1620]
 [5200  135 1990]
 [4699  171 2449]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/QRTEA
Evaluating performance on  test set...
1242/1242 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0349971
{'0': {'precision': 0.372577425009739, 'recall': 0.7090645815233131, 'f1-score': 0.4884822415437348, 'support': 86325}, '1': {'precision': 0.6555332859752385, 'recall': 0.367983308766458, 'f1-score': 0.47136569903997444, 'support': 140433}, '2': {'precision': 0.5248329516999424, 'recall': 0.4305093309607759, 'f1-score': 0.4730147236302197, 'support': 91041}, 'accuracy': 0.47854461467783094, 'macro avg': {'precision': 0.5176478875616399, 'recall': 0.5025190737501823, 'f1-score': 0.4776208880713096, 'support': 317799}, 'weighted avg': {'precision': 0.5412306801438672, 'recall': 0.47854461467783094, 'f1-score': 0.47648753510414593, 'support': 317799}}
[[61210 11738 13377]
 [66648 51677 22108]
 [36430 15417 39194]]
Evaluating performance on  train set...
528/528 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8496107
{'0': {'precision': 0.4720021200477011, 'recall': 0.5612415314321727, 'f1-score': 0.5127681013387074, 'support': 31735}, '1': {'precision': 0.6942840071698865, 'recall': 0.7355982274741507, 'f1-score': 0.714344262295082, 'support': 71085}, '2': {'precision': 0.5741401390413465, 'recall': 0.3911322988720633, 'f1-score': 0.4652878164498313, 'support': 32094}, 'accuracy': 0.612642127577568, 'macro avg': {'precision': 0.580142088752978, 'recall': 0.5626573525927956, 'f1-score': 0.5641333933612068, 'support': 134914}, 'weighted avg': {'precision': 0.6134175812130555, 'recall': 0.612642127577568, 'f1-score': 0.6076819660107229, 'support': 134914}}
[[17811 10161  3763]
 [13247 52290  5548]
 [ 6677 12864 12553]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9026814
{'0': {'precision': 0.45038710135663046, 'recall': 0.597474795062659, 'f1-score': 0.5136076462011988, 'support': 10613}, '1': {'precision': 0.6818619582664527, 'recall': 0.6369770580296896, 'f1-score': 0.6586557097449415, 'support': 20007}, '2': {'precision': 0.5189113212369026, 'recall': 0.40711779448621555, 'f1-score': 0.45626650188191675, 'support': 9975}, 'accuracy': 0.57016873999261, 'macro avg': {'precision': 0.5503867936199952, 'recall': 0.547189882526188, 'f1-score': 0.5428432859426856, 'support': 40595}, 'weighted avg': {'precision': 0.5813058488748108, 'recall': 0.57016873999261, 'f1-score': 0.571003845061522, 'support': 40595}}
[[ 6341  2766  1506]
 [ 5004 12744  2259]
 [ 2734  3180  4061]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/XRAY
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2905277
{'0': {'precision': 0.3911041205072557, 'recall': 0.5602920625291141, 'f1-score': 0.4606546426185705, 'support': 92309}, '1': {'precision': 0.4734874705800914, 'recall': 0.12759448334183135, 'f1-score': 0.20101880877742945, 'support': 80411}, '2': {'precision': 0.43204242620716027, 'recall': 0.5121141359502626, 'f1-score': 0.4686829338671572, 'support': 101493}, 'accuracy': 0.4155747539321622, 'macro avg': {'precision': 0.43221133909816906, 'recall': 0.400000227273736, 'f1-score': 0.3767854617543857, 'support': 274213}, 'weighted avg': {'precision': 0.43041472585093815, 'recall': 0.4155747539321622, 'f1-score': 0.3874897610436372, 'support': 274213}}
[[51720  5448 35141]
 [36965 10260 33186]
 [43556  5961 51976]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3209933
{'0': {'precision': 0.39867437596953886, 'recall': 0.5770329849771392, 'f1-score': 0.4715517672766093, 'support': 24496}, '1': {'precision': 0.46410835214446955, 'recall': 0.16912067121822819, 'f1-score': 0.24790498583227832, 'support': 24314}, '2': {'precision': 0.4053131854740434, 'recall': 0.48051680013208947, 'f1-score': 0.439722741609534, 'support': 24226}, 'accuracy': 0.40922284900596967, 'macro avg': {'precision': 0.42269863786268386, 'recall': 0.4088901521091523, 'f1-score': 0.3863931649061405, 'support': 73036}, 'weighted avg': {'precision': 0.4226597187562932, 'recall': 0.40922284900596967, 'f1-score': 0.3865411174621612, 'support': 73036}}
[[14135  2165  8196]
 [11318  4112  8884]
 [10002  2583 11641]]
Evaluating performance on  val set...
117/117 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.3501408
{'0': {'precision': 0.3801755765199161, 'recall': 0.6086637298091042, 'f1-score': 0.4680216146463424, 'support': 9534}, '1': {'precision': 0.4860386621663087, 'recall': 0.15471771830435632, 'f1-score': 0.23471882640586794, 'support': 10238}, '2': {'precision': 0.4049264575580365, 'recall': 0.4553153332669124, 'f1-score': 0.42864512498241336, 'support': 10037}, 'accuracy': 0.4011204669730618, 'macro avg': {'precision': 0.42371356541475375, 'recall': 0.4062322604601243, 'f1-score': 0.37712852201154123, 'support': 29809}, 'weighted avg': {'precision': 0.424868483488529, 'recall': 0.4011204669730618, 'f1-score': 0.3746345244130963, 'support': 29809}}
[[5803  689 3042]
 [4980 1584 3674]
 [4481  986 4570]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/CHTR
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4573625
{'0': {'precision': 0.33616116986083233, 'recall': 0.8133742148177292, 'f1-score': 0.4757136339291028, 'support': 73709}, '1': {'precision': 0.30164551942902457, 'recall': 0.04483637595956917, 'f1-score': 0.07806867888707877, 'support': 67869}, '2': {'precision': 0.3614408124404951, 'recall': 0.14533088329122323, 'f1-score': 0.2073064181440897, 'support': 78366}, 'accuracy': 0.33819972356599864, 'macro avg': {'precision': 0.33308250057678396, 'recall': 0.3345138246895072, 'f1-score': 0.25369624365342375, 'support': 219944}, 'weighted avg': {'precision': 0.33451766874801037, 'recall': 0.33819972356599864, 'f1-score': 0.25737730592763214, 'support': 219944}}
[[59953  3644 10112]
 [54817  3043 10009]
 [63576  3401 11389]]
Evaluating performance on  train set...
320/320 - 7s - 7s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5079651
{'0': {'precision': 0.3535153346876084, 'recall': 0.7553728341038218, 'f1-score': 0.48162815291496974, 'support': 28337}, '1': {'precision': 0.31186715269339815, 'recall': 0.028941928208983274, 'f1-score': 0.0529682878172938, 'support': 26605}, '2': {'precision': 0.33529789969995716, 'recall': 0.23403141361256544, 'f1-score': 0.2756585322879042, 'support': 26740}, 'accuracy': 0.34809382728140836, 'macro avg': {'precision': 0.3335601290269879, 'recall': 0.3394487253084568, 'f1-score': 0.2700849910067226, 'support': 81682}, 'weighted avg': {'precision': 0.33398613494316337, 'recall': 0.34809382728140836, 'f1-score': 0.27457980240333435, 'support': 81682}}
[[21405   865  6067]
 [19496   770  6339]
 [19648   834  6258]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.5084795
{'0': {'precision': 0.3456929222575028, 'recall': 0.7833352674944877, 'f1-score': 0.4796929964822514, 'support': 8617}, '1': {'precision': 0.28331332533013204, 'recall': 0.028578348268345845, 'f1-score': 0.05191948080519195, 'support': 8258}, '2': {'precision': 0.31051716644936983, 'recall': 0.17672520405639378, 'f1-score': 0.22525220680958385, 'support': 8086}, 'accuracy': 0.33712591642963025, 'macro avg': {'precision': 0.31317447134566817, 'recall': 0.3295462732730758, 'f1-score': 0.2522882280323424, 'support': 24961}, 'weighted avg': {'precision': 0.31366047672684333, 'recall': 0.33712591642963025, 'f1-score': 0.2557451611489576, 'support': 24961}}
[[6750  302 1565]
 [6414  236 1608]
 [6362  295 1429]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/PCAR
Evaluating performance on  test set...
1914/1914 - 36s - 36s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2257578
{'0': {'precision': 0.4145391860073999, 'recall': 0.5852456875571332, 'f1-score': 0.4853189468036406, 'support': 168466}, '1': {'precision': 0.4523533764437152, 'recall': 0.19826419244761556, 'f1-score': 0.2756933755551417, 'support': 141836}, '2': {'precision': 0.4530232264247313, 'recall': 0.47899140949910085, 'f1-score': 0.46564554975238814, 'support': 179617}, 'accuracy': 0.4342554585553938, 'macro avg': {'precision': 0.43997192962528214, 'recall': 0.4208337631679499, 'f1-score': 0.4088859573703902, 'support': 489919}, 'weighted avg': {'precision': 0.4395959839727065, 'recall': 0.4342554585553938, 'f1-score': 0.41741766295517396, 'support': 489919}}
[[98594 16217 53655]
 [63492 28121 50223]
 [75754 17828 86035]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1742145
{'0': {'precision': 0.4315784229471036, 'recall': 0.558436744560838, 'f1-score': 0.4868799134460689, 'support': 62050}, '1': {'precision': 0.5257962898144907, 'recall': 0.24775696002111097, 'f1-score': 0.3368085917356113, 'support': 60632}, '2': {'precision': 0.41529693899547315, 'recall': 0.510339232794159, 'f1-score': 0.45793871866295266, 'support': 60401}, 'accuracy': 0.43968036355095774, 'macro avg': {'precision': 0.4575572172523558, 'recall': 0.43884431245870265, 'f1-score': 0.4272090746148776, 'support': 183083}, 'weighted avg': {'precision': 0.45740932910300547, 'recall': 0.43968036355095774, 'f1-score': 0.4276324601923891, 'support': 183083}}
[[34651  6764 20635]
 [22846 15022 22764]
 [22792  6784 30825]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.244522
{'0': {'precision': 0.4232449131777991, 'recall': 0.6076781890486387, 'f1-score': 0.49896389324960755, 'support': 19614}, '1': {'precision': 0.4028175214615893, 'recall': 0.12030767207941621, 'f1-score': 0.18527893084944821, 'support': 15211}, '2': {'precision': 0.4382687927107061, 'recall': 0.4851480155328055, 'f1-score': 0.46051844227961414, 'support': 19829}, 'accuracy': 0.4275807809126505, 'macro avg': {'precision': 0.42144374245003147, 'recall': 0.40437795888695344, 'f1-score': 0.38158708879289, 'support': 54654}, 'weighted avg': {'precision': 0.4230104829780469, 'recall': 0.4275807809126505, 'f1-score': 0.39771244211423185, 'support': 54654}}
[[11919  1203  6492]
 [ 7543  1830  5838]
 [ 8699  1510  9620]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/EXC
Evaluating performance on  test set...
4918/4918 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81230414
{'0': {'precision': 0.621540371858968, 'recall': 0.4318145701378011, 'f1-score': 0.509591169694047, 'support': 308343}, '1': {'precision': 0.634060828869364, 'recall': 0.8758260237958014, 'f1-score': 0.7355875357323549, 'support': 633305}, '2': {'precision': 0.6788902235097388, 'recall': 0.36350337809080335, 'f1-score': 0.4734850429236983, 'support': 317191}, 'accuracy': 0.6379783276495247, 'macro avg': {'precision': 0.6448304747460236, 'recall': 0.5570479906748019, 'f1-score': 0.5728879161167001, 'support': 1258839}, 'weighted avg': {'precision': 0.642289748722831, 'recall': 0.6379783276495247, 'f1-score': 0.6141892081544672, 'support': 1258839}}
[[133147 149912  25284]
 [ 49388 554665  29252]
 [ 31686 170205 115300]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7702213
{'0': {'precision': 0.5799978505519475, 'recall': 0.468895067398158, 'f1-score': 0.5185622413331593, 'support': 80566}, '1': {'precision': 0.6829727187206021, 'recall': 0.8578656876953609, 'f1-score': 0.7604935839900798, 'support': 198031}, '2': {'precision': 0.6651147322913202, 'recall': 0.37321324160581215, 'f1-score': 0.47813336733392825, 'support': 80383}, 'accuracy': 0.6620452392890969, 'macro avg': {'precision': 0.64269510052129, 'recall': 0.566657998899777, 'f1-score': 0.5857297308857224, 'support': 358980}, 'weighted avg': {'precision': 0.6558632648456765, 'recall': 0.6620452392890969, 'f1-score': 0.6429705970605325, 'support': 358980}}
[[ 37777  36560   6229]
 [ 19271 169884   8876]
 [  8085  42298  30000]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7947007
{'0': {'precision': 0.6048723101808735, 'recall': 0.4242153391316305, 'f1-score': 0.498686603354213, 'support': 29089}, '1': {'precision': 0.6528775723753052, 'recall': 0.8715099405584095, 'f1-score': 0.7465152915057531, 'support': 64433}, '2': {'precision': 0.6771740463633018, 'recall': 0.37821544785065936, 'f1-score': 0.48535197028636734, 'support': 29195}, 'accuracy': 0.6481253616043416, 'macro avg': {'precision': 0.6449746429731602, 'recall': 0.5579802425135665, 'f1-score': 0.5768512883821112, 'support': 122717}, 'weighted avg': {'precision': 0.6472785965700437, 'recall': 0.6481253616043416, 'f1-score': 0.6256375657412697, 'support': 122717}}
[[12340 14302  2447]
 [ 5462 56154  2817]
 [ 2599 15554 11042]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/AAL
Evaluating performance on  test set...
4856/4856 - 90s - 90s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95490324
{'0': {'precision': 0.48829012396458876, 'recall': 0.5710817871653876, 'f1-score': 0.5264508030073547, 'support': 405357}, '1': {'precision': 0.5983568740718669, 'recall': 0.559469673140351, 'f1-score': 0.5782602334767696, 'support': 445084}, '2': {'precision': 0.5140390177508082, 'recall': 0.4619047861714705, 'f1-score': 0.48657941496985735, 'support': 392464}, 'accuracy': 0.5324493826961836, 'macro avg': {'precision': 0.5335620052624214, 'recall': 0.5308187488257363, 'f1-score': 0.5304301504846606, 'support': 1242905}, 'weighted avg': {'precision': 0.5358355624781216, 'recall': 0.5324493826961836, 'f1-score': 0.5324138203870423, 'support': 1242905}}
[[231492  81267  92598]
 [117292 249011  78781]
 [125303  85880 181281]]
Evaluating performance on  train set...
2076/2076 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88941115
{'0': {'precision': 0.48682503438075714, 'recall': 0.5424705261560036, 'f1-score': 0.513143634679093, 'support': 138343}, '1': {'precision': 0.6471078402454132, 'recall': 0.6955222579328437, 'f1-score': 0.6704421519884328, 'support': 252337}, '2': {'precision': 0.5425036307738735, 'recall': 0.40876856391671995, 'f1-score': 0.4662354924463463, 'support': 140730}, 'accuracy': 0.5797388080766264, 'macro avg': {'precision': 0.5588121684666812, 'recall': 0.5489204493351891, 'f1-score': 0.5499404263712907, 'support': 531410}, 'weighted avg': {'precision': 0.5776794241247835, 'recall': 0.5797388080766264, 'f1-score': 0.575413545117121, 'support': 531410}}
[[ 75047  42802  20494]
 [ 48813 175506  28018]
 [ 30296  52908  57526]]
Evaluating performance on  val set...
588/588 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87642634
{'0': {'precision': 0.5089302350342038, 'recall': 0.4854023863924854, 'f1-score': 0.4968879533257968, 'support': 39390}, '1': {'precision': 0.6262149698474636, 'recall': 0.7367593661746498, 'f1-score': 0.6770043016663364, 'support': 71881}, '2': {'precision': 0.5498207376379965, 'recall': 0.39675708906478135, 'f1-score': 0.4609135545305758, 'support': 39039}, 'accuracy': 0.5825826624975051, 'macro avg': {'precision': 0.5616553141732212, 'recall': 0.5396396138773055, 'f1-score': 0.544935269840903, 'support': 150310}, 'weighted avg': {'precision': 0.5756381610155848, 'recall': 0.5825826624975051, 'f1-score': 0.5736795086481287, 'support': 150310}}
[[19120 14807  5463]
 [11703 52959  7219]
 [ 6746 16804 15489]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/WBA
Evaluating performance on  test set...
4353/4353 - 82s - 82s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9411172
{'0': {'precision': 0.553787566982214, 'recall': 0.4152867425400193, 'f1-score': 0.47463983410021454, 'support': 333714}, '1': {'precision': 0.5583055765442757, 'recall': 0.7644996357493061, 'f1-score': 0.6453322166229508, 'support': 447494}, '2': {'precision': 0.5279617307141266, 'recall': 0.39828869941155276, 'f1-score': 0.45404824489348883, 'support': 333080}, 'accuracy': 0.5504483580546502, 'macro avg': {'precision': 0.5466849580802053, 'recall': 0.5260250259002928, 'f1-score': 0.524673431872218, 'support': 1114288}, 'weighted avg': {'precision': 0.5478821929916394, 'recall': 0.5504483580546502, 'f1-score': 0.5370340898865581, 'support': 1114288}}
[[138587 129870  65257]
 [ 52032 342109  53353]
 [ 59634 140784 132662]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96722746
{'0': {'precision': 0.49988763087128696, 'recall': 0.5073580883914456, 'f1-score': 0.5035951564927511, 'support': 127139}, '1': {'precision': 0.5460847195222741, 'recall': 0.6574567826836429, 'f1-score': 0.5966177354279337, 'support': 142709}, '2': {'precision': 0.5344893821363782, 'recall': 0.40161167461812936, 'f1-score': 0.45861966350005723, 'support': 124715}, 'accuracy': 0.5282223624617615, 'macro avg': {'precision': 0.5268205775099798, 'recall': 0.5221421818977393, 'f1-score': 0.519610851806914, 'support': 394563}, 'weighted avg': {'precision': 0.5275336537708482, 'recall': 0.5282223624617615, 'f1-score': 0.5230243493179201, 'support': 394563}}
[[64505 37684 24950]
 [30211 93825 18673]
 [34323 40305 50087]]
Evaluating performance on  val set...
482/482 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95942366
{'0': {'precision': 0.5105652330443934, 'recall': 0.47456754530477757, 'f1-score': 0.49190869431807566, 'support': 38848}, '1': {'precision': 0.5558975643801786, 'recall': 0.6802514015416958, 'f1-score': 0.6118196232138108, 'support': 45664}, '2': {'precision': 0.5213268629078603, 'recall': 0.4208722099077272, 'f1-score': 0.46574443810610383, 'support': 38798}, 'accuracy': 0.5338415375881923, 'macro avg': {'precision': 0.5292632201108107, 'recall': 0.5252303855847336, 'f1-score': 0.5231575852126634, 'support': 123310}, 'weighted avg': {'precision': 0.5307386601270314, 'recall': 0.5338415375881923, 'f1-score': 0.5280816879486228, 'support': 123310}}
[[18436 11975  8437]
 [ 8045 31063  6556]
 [ 9628 12841 16329]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/ATVI
Evaluating performance on  test set...
5497/5497 - 99s - 99s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99585444
{'0': {'precision': 0.47589361070301023, 'recall': 0.5327575384440415, 'f1-score': 0.5027226882431669, 'support': 457223}, '1': {'precision': 0.5490179022624284, 'recall': 0.5406094372636912, 'f1-score': 0.5447812264307982, 'support': 490354}, '2': {'precision': 0.5023309034402341, 'recall': 0.4508293735749221, 'f1-score': 0.4751887630786871, 'support': 459624}, 'accuracy': 0.508734004594937, 'macro avg': {'precision': 0.5090808054685576, 'recall': 0.5080654497608849, 'f1-score': 0.5075642259175507, 'support': 1407201}, 'weighted avg': {'precision': 0.5100095636481693, 'recall': 0.508734004594937, 'f1-score': 0.5083852194769131, 'support': 1407201}}
[[243589 102808 110826]
 [130801 265090  94463]
 [137466 114946 207212]]
Evaluating performance on  train set...
2058/2058 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9912772
{'0': {'precision': 0.4989974650618079, 'recall': 0.49081422344357056, 'f1-score': 0.494872016887262, 'support': 168848}, '1': {'precision': 0.5326218147131538, 'recall': 0.5842399718132414, 'f1-score': 0.5572380714769424, 'support': 187322}, '2': {'precision': 0.5058704570777167, 'recall': 0.46026462901543475, 'f1-score': 0.4819911451477803, 'support': 170654}, 'accuracy': 0.5141375487828952, 'macro avg': {'precision': 0.5124965789508927, 'recall': 0.5117729414240823, 'f1-score': 0.5113670778373282, 'support': 526824}, 'weighted avg': {'precision': 0.5131795904108284, 'recall': 0.5141375487828952, 'f1-score': 0.5128749206881872, 'support': 526824}}
[[ 82873  46035  39940]
 [ 41098 109441  36783]
 [ 42108  50000  78546]]
Evaluating performance on  val set...
681/681 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9958754
{'0': {'precision': 0.4960777113863204, 'recall': 0.5046094293815045, 'f1-score': 0.5003072002693262, 'support': 58901}, '1': {'precision': 0.5255260405055476, 'recall': 0.5356581017304667, 'f1-score': 0.5305437012542956, 'support': 57210}, '2': {'precision': 0.4952917677272079, 'recall': 0.4772805389427373, 'f1-score': 0.48611937685979345, 'support': 58188}, 'accuracy': 0.5056770262594736, 'macro avg': {'precision': 0.5056318398730254, 'recall': 0.5058493566849028, 'f1-score': 0.5056567594611384, 'support': 174299}, 'weighted avg': {'precision': 0.5054811297609213, 'recall': 0.5056770262594736, 'f1-score': 0.5054952343532636, 'support': 174299}}
[[29722 13458 15721]
 [13986 30645 12579]
 [16206 14210 27772]]
testing model on single stock: results/universal/W2/deepVOL_L3/h50/AAPL
Evaluating performance on  test set...
14883/14883 - 276s - 276s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.7514651
{'0': {'precision': 0.31868740775811233, 'recall': 0.6276558216104816, 'f1-score': 0.4227345862384225, 'support': 969474}, '1': {'precision': 0.5920514647961289, 'recall': 0.03403200627878495, 'f1-score': 0.06436425843574074, 'support': 1855136}, '2': {'precision': 0.3264263348572174, 'recall': 0.5943129376254074, 'f1-score': 0.4213991947236045, 'support': 985289}, 'accuracy': 0.3299825008484477, 'macro avg': {'precision': 0.41238840247048625, 'recall': 0.4186669218382247, 'f1-score': 0.30283267979925593, 'support': 3809899}, 'weighted avg': {'precision': 0.45379665423940435, 'recall': 0.3299825008484477, 'f1-score': 0.24788967748656338, 'support': 3809899}}
[[608496  21920 339058]
 [922749  63134 869253]
 [378137  21582 585570]]
Evaluating performance on  train set...
6147/6147 - 107s - 107s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.412174
{'0': {'precision': 0.3986492133726647, 'recall': 0.6241984403747411, 'f1-score': 0.4865557765756684, 'support': 519612}, '1': {'precision': 0.4848468579711701, 'recall': 0.034774606181724364, 'f1-score': 0.0648947732437506, 'support': 519402}, '2': {'precision': 0.4160070409281626, 'recall': 0.5624626967599738, 'f1-score': 0.47827425437692855, 'support': 534471}, 'accuracy': 0.4086616650301719, 'macro avg': {'precision': 0.4331677040906658, 'recall': 0.40714524777214645, 'f1-score': 0.3432416013987825, 'support': 1573485}, 'weighted avg': {'precision': 0.43299875242207886, 'recall': 0.4086616650301719, 'f1-score': 0.3445539132571827, 'support': 1573485}}
[[324341   9519 185752]
 [265080  18062 236260]
 [224179   9672 300620]]
Evaluating performance on  val set...
2174/2174 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.4276597
{'0': {'precision': 0.38210622781361153, 'recall': 0.6178815166414953, 'f1-score': 0.472198538169653, 'support': 176126}, '1': {'precision': 0.5638904109589041, 'recall': 0.051522236518656846, 'f1-score': 0.0944176082279381, 'support': 199739}, '2': {'precision': 0.4052223112159747, 'recall': 0.5685593919364036, 'f1-score': 0.47319219516690086, 'support': 180639}, 'accuracy': 0.3985955177321277, 'macro avg': {'precision': 0.4504063166628301, 'recall': 0.41265438169885194, 'f1-score': 0.34660278052149734, 'support': 556504}, 'weighted avg': {'precision': 0.45485513374596254, 'recall': 0.3985955177321277, 'f1-score': 0.33692890496072314, 'support': 556504}}
[[108825   3912  63389]
 [102090  10291  87358]
 [ 73888   4047 102704]]
training model: results/universal/W2/deepVOL_L3/h100
Epoch 1/50
9940/9940 - 785s - loss: 3.2066 - accuracy100: 0.4151 - val_loss: 3.3318 - val_accuracy100: 0.3973 - 785s/epoch - 79ms/step
Epoch 2/50
9940/9940 - 823s - loss: 3.1531 - accuracy100: 0.4354 - val_loss: 3.4323 - val_accuracy100: 0.4075 - 823s/epoch - 83ms/step
Epoch 3/50
9940/9940 - 857s - loss: 3.1307 - accuracy100: 0.4418 - val_loss: 3.4546 - val_accuracy100: 0.4068 - 857s/epoch - 86ms/step
Epoch 4/50
9940/9940 - 870s - loss: 3.1201 - accuracy100: 0.4463 - val_loss: 3.3852 - val_accuracy100: 0.4124 - 870s/epoch - 87ms/step
Epoch 5/50
9940/9940 - 859s - loss: 3.1100 - accuracy100: 0.4497 - val_loss: 3.3378 - val_accuracy100: 0.4077 - 859s/epoch - 86ms/step
Epoch 6/50
9940/9940 - 833s - loss: 3.1024 - accuracy100: 0.4527 - val_loss: 3.3317 - val_accuracy100: 0.4008 - 833s/epoch - 84ms/step
Epoch 7/50
9940/9940 - 831s - loss: 3.0962 - accuracy100: 0.4548 - val_loss: 3.3317 - val_accuracy100: 0.3999 - 831s/epoch - 84ms/step
Epoch 8/50
9940/9940 - 828s - loss: 3.0913 - accuracy100: 0.4569 - val_loss: 3.3290 - val_accuracy100: 0.3988 - 828s/epoch - 83ms/step
Epoch 9/50
9940/9940 - 811s - loss: 3.0876 - accuracy100: 0.4582 - val_loss: 3.3286 - val_accuracy100: 0.4012 - 811s/epoch - 82ms/step
Epoch 10/50
9940/9940 - 815s - loss: 3.0839 - accuracy100: 0.4594 - val_loss: 3.3179 - val_accuracy100: 0.4026 - 815s/epoch - 82ms/step
Epoch 11/50
9940/9940 - 821s - loss: 3.0807 - accuracy100: 0.4605 - val_loss: 3.2951 - val_accuracy100: 0.4009 - 821s/epoch - 83ms/step
Epoch 12/50
9940/9940 - 833s - loss: 3.0773 - accuracy100: 0.4614 - val_loss: 3.3186 - val_accuracy100: 0.3997 - 833s/epoch - 84ms/step
Epoch 13/50
9940/9940 - 836s - loss: 3.0745 - accuracy100: 0.4624 - val_loss: 3.3074 - val_accuracy100: 0.4002 - 836s/epoch - 84ms/step
Epoch 14/50
9940/9940 - 842s - loss: 3.0725 - accuracy100: 0.4631 - val_loss: 3.3377 - val_accuracy100: 0.3994 - 842s/epoch - 85ms/step
Epoch 15/50
9940/9940 - 828s - loss: 3.0707 - accuracy100: 0.4637 - val_loss: 3.3008 - val_accuracy100: 0.4034 - 828s/epoch - 83ms/step
Epoch 16/50
9940/9940 - 826s - loss: 3.0682 - accuracy100: 0.4643 - val_loss: 3.3210 - val_accuracy100: 0.4027 - 826s/epoch - 83ms/step
Epoch 17/50
9940/9940 - 805s - loss: 3.0662 - accuracy100: 0.4652 - val_loss: 3.3199 - val_accuracy100: 0.4009 - 805s/epoch - 81ms/step
Epoch 18/50
9940/9940 - 829s - loss: 3.0640 - accuracy100: 0.4658 - val_loss: 3.3332 - val_accuracy100: 0.4047 - 829s/epoch - 83ms/step
Epoch 19/50
9940/9940 - 805s - loss: 3.0619 - accuracy100: 0.4664 - val_loss: 3.3383 - val_accuracy100: 0.4043 - 805s/epoch - 81ms/step
Epoch 20/50
9940/9940 - 811s - loss: 3.0607 - accuracy100: 0.4667 - val_loss: 3.3568 - val_accuracy100: 0.4020 - 811s/epoch - 82ms/step
Epoch 21/50
9940/9940 - 816s - loss: 3.0584 - accuracy100: 0.4673 - val_loss: 3.3730 - val_accuracy100: 0.4025 - 816s/epoch - 82ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h100/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1270s - 1270s/epoch - 48ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1127304
{'0': {'precision': 0.39611819880791505, 'recall': 0.3501060429548645, 'f1-score': 0.37169356706890294, 'support': 2142528}, '1': {'precision': 0.4020931764787475, 'recall': 0.3888524197091185, 'f1-score': 0.39536197021861674, 'support': 2385576}, '2': {'precision': 0.39457091249049636, 'recall': 0.4534915274335113, 'f1-score': 0.42198441379430346, 'support': 2192665}, 'accuracy': 0.3975890258986732, 'macro avg': {'precision': 0.3975940959257196, 'recall': 0.3974833300324981, 'f1-score': 0.3963466503606077, 'support': 6720769}, 'weighted avg': {'precision': 0.3977342464326572, 'recall': 0.3975890258986732, 'f1-score': 0.39650229862141306, 'support': 6720769}}
[[750112 703135 689281]
 [621483 927637 836456]
 [522062 676248 994355]]
Evaluating performance on  train set...
9940/9940 - 513s - 513s/epoch - 52ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991114
{'0': {'precision': 0.39759531918062146, 'recall': 0.3650531875976765, 'f1-score': 0.38062996872291704, 'support': 833747}, '1': {'precision': 0.40690085064317694, 'recall': 0.37411283058277045, 'f1-score': 0.3898185977016625, 'support': 863702}, '2': {'precision': 0.40065669930854503, 'recall': 0.4659213519662008, 'f1-score': 0.43083138498962126, 'support': 846175}, 'accuracy': 0.4016847615842593, 'macro avg': {'precision': 0.40171762304411446, 'recall': 0.4016957900488826, 'f1-score': 0.40042665047140025, 'support': 2543624}, 'weighted avg': {'precision': 0.40177347973619804, 'recall': 0.4016847615842593, 'f1-score': 0.4004502804654068, 'support': 2543624}}
[[304362 241841 287544]
 [238363 323122 302217]
 [222782 229142 394251]]
Evaluating performance on  val set...
3393/3393 - 170s - 170s/epoch - 50ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0991188
{'0': {'precision': 0.4019906957477655, 'recall': 0.3507295934501656, 'f1-score': 0.37461467510221197, 'support': 287763}, '1': {'precision': 0.3968107216825063, 'recall': 0.377873906849543, 'f1-score': 0.3871108633356652, 'support': 288501}, '2': {'precision': 0.402970030909824, 'recall': 0.47265294373644295, 'f1-score': 0.43503877093685783, 'support': 291823}, 'accuracy': 0.40073748368539097, 'macro avg': {'precision': 0.4005904827800319, 'recall': 0.40041881467871715, 'f1-score': 0.398921436458245, 'support': 868087}, 'weighted avg': {'precision': 0.40059839846327217, 'recall': 0.40073748368539097, 'f1-score': 0.3990803147446595, 'support': 868087}}
[[100927  85616 101220]
 [ 76349 109017 103135]
 [ 73792  80100 137931]]
testing model out of sample: results/universal/W2/deepVOL_L3/h100/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 714s - 714s/epoch - 50ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0806291
{'0': {'precision': 0.42967916176529175, 'recall': 0.32085158752775317, 'f1-score': 0.36737533088377006, 'support': 1277332}, '1': {'precision': 0.3640076515512057, 'recall': 0.5104261407750837, 'f1-score': 0.4249584643786355, 'support': 1081896}, '2': {'precision': 0.4444152692540229, 'recall': 0.4064611607603795, 'f1-score': 0.4245917264333416, 'support': 1307505}, 'accuracy': 0.40731408586335577, 'macro avg': {'precision': 0.4127006941901734, 'recall': 0.41257962968773887, 'f1-score': 0.40564184056524905, 'support': 3666733}, 'weighted avg': {'precision': 0.41555699634105026, 'recall': 0.40731408586335577, 'f1-score': 0.40476820488321413, 'support': 3666733}}
[[409834 487684 379814]
 [245091 552228 284577]
 [298889 477166 531450]]
Evaluating performance on  train set...
5373/5373 - 275s - 275s/epoch - 51ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0665096
{'0': {'precision': 0.4536062487061275, 'recall': 0.30180152604997923, 'f1-score': 0.36245075219014083, 'support': 457390}, '1': {'precision': 0.4027092968951184, 'recall': 0.6022366545913428, 'f1-score': 0.48266536001506605, 'support': 459615}, '2': {'precision': 0.4462863614065484, 'recall': 0.37352665614005204, 'f1-score': 0.4066777391653777, 'support': 457887}, 'accuracy': 0.42612146990454525, 'macro avg': {'precision': 0.43420063566926476, 'recall': 0.4258549455937914, 'f1-score': 0.4172646171235282, 'support': 1374892}, 'weighted avg': {'precision': 0.43415404173819167, 'recall': 0.42612146990454525, 'f1-score': 0.4173666287539606, 'support': 1374892}}
[[138041 207524 111825]
 [ 82440 276797 100378]
 [ 83838 203016 171033]]
Evaluating performance on  val set...
1685/1685 - 85s - 85s/epoch - 50ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0738013
{'0': {'precision': 0.44191706639353406, 'recall': 0.2982234023624095, 'f1-score': 0.35612161924725516, 'support': 146122}, '1': {'precision': 0.3872540987556746, 'recall': 0.5771291494893489, 'f1-score': 0.46349960777075355, 'support': 139234}, '2': {'precision': 0.43964804393028317, 'recall': 0.3768545789864846, 'f1-score': 0.4058367330302323, 'support': 145316}, 'accuracy': 0.41492365419623284, 'macro avg': {'precision': 0.4229397363598306, 'recall': 0.417402376946081, 'f1-score': 0.40848598668274705, 'support': 430672}, 'weighted avg': {'precision': 0.4234792090348957, 'recall': 0.41492365419623284, 'f1-score': 0.40761107834505556, 'support': 430672}}
[[43577 64851 37694]
 [26774 80356 32104]
 [28258 62295 54763]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/LILAK
Evaluating performance on  test set...
987/987 - 20s - 20s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1743662
{'0': {'precision': 0.3089126126463, 'recall': 0.44753985129406665, 'f1-score': 0.3655238400743326, 'support': 73837}, '1': {'precision': 0.3371724398685397, 'recall': 0.11912737884828806, 'f1-score': 0.1760529692708373, 'support': 97316}, '2': {'precision': 0.3288644952312399, 'recall': 0.44933736569054117, 'f1-score': 0.3797757712409472, 'support': 81342}, 'accuracy': 0.321543000851502, 'macro avg': {'precision': 0.32498318258202646, 'recall': 0.33866819861096537, 'f1-score': 0.307117526862039, 'support': 252495}, 'weighted avg': {'precision': 0.32623200265078983, 'recall': 0.321543000851502, 'f1-score': 0.29708974562431106, 'support': 252495}}
[[33045 12063 28729]
 [39862 11593 45861]
 [34065 10727 36550]]
Evaluating performance on  train set...
237/237 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1516412
{'0': {'precision': 0.3379546631608302, 'recall': 0.43139747762408465, 'f1-score': 0.3790014520272534, 'support': 19664}, '1': {'precision': 0.3222838021541357, 'recall': 0.15368505036401717, 'f1-score': 0.20812371273255223, 'support': 20054}, '2': {'precision': 0.36092753623188406, 'recall': 0.4485375342202584, 'f1-score': 0.39999143395579917, 'support': 20821}, 'accuracy': 0.34529807231701876, 'macro avg': {'precision': 0.34038866718228333, 'recall': 0.34454002073612006, 'f1-score': 0.3290388662385349, 'support': 60539}, 'weighted avg': {'precision': 0.34066456493628344, 'recall': 0.34529807231701876, 'f1-score': 0.32961593574714165, 'support': 60539}}
[[8483 3336 7845]
 [8281 3082 8691]
 [8337 3145 9339]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1687859
{'0': {'precision': 0.32469352014010505, 'recall': 0.4040976460331299, 'f1-score': 0.3600699164886386, 'support': 6882}, '1': {'precision': 0.3327239488117002, 'recall': 0.14554178328668532, 'f1-score': 0.20250347705146035, 'support': 7503}, '2': {'precision': 0.36327283912642266, 'recall': 0.4910602910602911, 'f1-score': 0.4176096181046676, 'support': 7215}, 'accuracy': 0.3433333333333333, 'macro avg': {'precision': 0.3402301026927426, 'recall': 0.34689990679336874, 'f1-score': 0.3267276705482555, 'support': 21600}, 'weighted avg': {'precision': 0.34036954295534855, 'recall': 0.3433333333333333, 'f1-score': 0.3245573216767173, 'support': 21600}}
[[2781 1255 2846]
 [3047 1092 3364]
 [2737  935 3543]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/QRTEA
Evaluating performance on  test set...
1242/1242 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0378778
{'0': {'precision': 0.4746359642944047, 'recall': 0.35349045715975314, 'f1-score': 0.40520210358286957, 'support': 104843}, '1': {'precision': 0.40176418665545044, 'recall': 0.6833630583517225, 'f1-score': 0.5060250852465621, 'support': 99243}, '2': {'precision': 0.5300438565566257, 'recall': 0.3305426820152489, 'f1-score': 0.40716908777745275, 'support': 113713}, 'accuracy': 0.44829278883822793, 'macro avg': {'precision': 0.4688146691688269, 'recall': 0.4557987325089081, 'f1-score': 0.4394654255356281, 'support': 317799}, 'weighted avg': {'precision': 0.4717051301023248, 'recall': 0.44829278883822793, 'f1-score': 0.4373911502537794, 'support': 317799}}
[[37061 47752 20030]
 [18128 67819 13296]
 [22894 53232 37587]]
Evaluating performance on  train set...
528/528 - 10s - 10s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9872572
{'0': {'precision': 0.5610871010638298, 'recall': 0.32540428506013064, 'f1-score': 0.41191634760590023, 'support': 41493}, '1': {'precision': 0.4696830475262651, 'recall': 0.8299458127115162, 'f1-score': 0.5998812284373056, 'support': 51119}, '2': {'precision': 0.5840845962672384, 'recall': 0.2833435771358328, 'f1-score': 0.3815799945879693, 'support': 42302}, 'accuracy': 0.503387343048164, 'macro avg': {'precision': 0.5382849149524445, 'recall': 0.4795645583024932, 'f1-score': 0.4644591902103918, 'support': 134914}, 'weighted avg': {'precision': 0.5336648634110126, 'recall': 0.503387343048164, 'f1-score': 0.4736244604619129, 'support': 134914}}
[[13502 22767  5224]
 [ 5382 42426  3311]
 [ 5180 25136 11986]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0074434
{'0': {'precision': 0.536451921761729, 'recall': 0.2846153846153846, 'f1-score': 0.37191219003366366, 'support': 13780}, '1': {'precision': 0.44408703878902556, 'recall': 0.8182832438463148, 'f1-score': 0.5757248687631851, 'support': 14341}, '2': {'precision': 0.541624143461146, 'recall': 0.29781946448613117, 'f1-score': 0.3843169709822583, 'support': 12474}, 'accuracy': 0.4772016258159872, 'macro avg': {'precision': 0.5073877013373002, 'recall': 0.46690603098261013, 'f1-score': 0.4439846765930357, 'support': 40595}, 'weighted avg': {'precision': 0.5054114859141366, 'recall': 0.4772016258159872, 'f1-score': 0.4477248483219463, 'support': 40595}}
[[ 3922  7829  2029]
 [ 1491 11735  1115]
 [ 1898  6861  3715]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/XRAY
Evaluating performance on  test set...
1072/1072 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1287754
{'0': {'precision': 0.36326338444982514, 'recall': 0.35512257131272396, 'f1-score': 0.3591468516743229, 'support': 91253}, '1': {'precision': 0.3231949619811074, 'recall': 0.29240893710191085, 'f1-score': 0.3070321531437976, 'support': 80384}, '2': {'precision': 0.40690072854878073, 'recall': 0.44538683512712524, 'f1-score': 0.4252748377968295, 'support': 102576}, 'accuracy': 0.37050395130792485, 'macro avg': {'precision': 0.3644530249932378, 'recall': 0.36430611451392, 'f1-score': 0.3638179475383167, 'support': 274213}, 'weighted avg': {'precision': 0.36784115478372276, 'recall': 0.37050395130792485, 'f1-score': 0.3686064920918979, 'support': 274213}}
[[32406 23437 35410]
 [25697 23505 31182]
 [31105 25785 45686]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1529404
{'0': {'precision': 0.3723801188447188, 'recall': 0.3271549979765277, 'f1-score': 0.34830565070337577, 'support': 24710}, '1': {'precision': 0.32592275346519234, 'recall': 0.34651047272125174, 'f1-score': 0.33590144857750487, 'support': 24158}, '2': {'precision': 0.3603322544164099, 'recall': 0.38232373386295926, 'f1-score': 0.3710023890305354, 'support': 24168}, 'accuracy': 0.351812804644285, 'macro avg': {'precision': 0.3528783755754404, 'recall': 0.3519964015202462, 'f1-score': 0.35173649610380536, 'support': 73036}, 'weighted avg': {'precision': 0.35302678870147475, 'recall': 0.351812804644285, 'f1-score': 0.35171320392280186, 'support': 73036}}
[[8084 8654 7972]
 [7356 8371 8431]
 [6269 8659 9240]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1554954
{'0': {'precision': 0.35948465486540276, 'recall': 0.36114911080711354, 'f1-score': 0.36031496062992124, 'support': 9503}, '1': {'precision': 0.36236376362363765, 'recall': 0.347759332117839, 'f1-score': 0.3549113700910783, 'support': 10421}, '2': {'precision': 0.369067342364292, 'recall': 0.3831057157309054, 'f1-score': 0.37595552466990967, 'support': 9885}, 'accuracy': 0.36374920326076016, 'macro avg': {'precision': 0.3636385869511108, 'recall': 0.3640047195519527, 'f1-score': 0.3637272851303031, 'support': 29809}, 'weighted avg': {'precision': 0.36366889648022, 'recall': 0.36374920326076016, 'f1-score': 0.3636124935404517, 'support': 29809}}
[[3432 3035 3036]
 [3359 3624 3438]
 [2756 3342 3787]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/CHTR
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1560093
{'0': {'precision': 0.33138845341149203, 'recall': 0.6626233440549528, 'f1-score': 0.4418171408838523, 'support': 73372}, '1': {'precision': 0.28947626760909045, 'recall': 0.18055321689347437, 'f1-score': 0.22239401167120756, 'support': 65327}, '2': {'precision': 0.35954814085200687, 'recall': 0.1437750015385562, 'f1-score': 0.20541091855486093, 'support': 81245}, 'accuracy': 0.32778343578365404, 'macro avg': {'precision': 0.32680428729086314, 'recall': 0.3289838541623278, 'f1-score': 0.28987402370330695, 'support': 219944}, 'weighted avg': {'precision': 0.3293417344475337, 'recall': 0.32778343578365404, 'f1-score': 0.28931887634745507, 'support': 219944}}
[[48618 13889 10865]
 [43590 11795  9942]
 [54502 15062 11681]]
Evaluating performance on  train set...
320/320 - 8s - 8s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1449195
{'0': {'precision': 0.33694908814589664, 'recall': 0.6383660248335433, 'f1-score': 0.4410817531861983, 'support': 27785}, '1': {'precision': 0.3148389196225187, 'recall': 0.1439464385344988, 'f1-score': 0.19756489777165173, 'support': 26885}, '2': {'precision': 0.31713432835820893, 'recall': 0.19665333925662667, 'f1-score': 0.2427676980028335, 'support': 27012}, 'accuracy': 0.3295585318674861, 'macro avg': {'precision': 0.32297411204220805, 'recall': 0.3263219342082229, 'f1-score': 0.2938047829868945, 'support': 81682}, 'weighted avg': {'precision': 0.32311901331746395, 'recall': 0.3295585318674861, 'f1-score': 0.2953481776563002, 'support': 81682}}
[[17737  4300  5748]
 [17325  3870  5690]
 [17578  4122  5312]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1452534
{'0': {'precision': 0.33876822740417156, 'recall': 0.652215114901682, 'f1-score': 0.44592022676655196, 'support': 8442}, '1': {'precision': 0.332076361065284, 'recall': 0.17237582578908736, 'f1-score': 0.2269469275992591, 'support': 8174}, '2': {'precision': 0.3173572228443449, 'recall': 0.16980227681246254, 'f1-score': 0.2212334113973458, 'support': 8345}, 'accuracy': 0.33380072913745445, 'macro avg': {'precision': 0.32940060377126684, 'recall': 0.33146440583441067, 'f1-score': 0.2980335219210523, 'support': 24961}, 'weighted avg': {'precision': 0.3294186761640041, 'recall': 0.33380072913745445, 'f1-score': 0.2990952108757833, 'support': 24961}}
[[5506 1413 1523]
 [5240 1409 1525]
 [5507 1421 1417]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/PCAR
Evaluating performance on  test set...
1914/1914 - 37s - 37s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1511234
{'0': {'precision': 0.36733226576031897, 'recall': 0.3436846418218955, 'f1-score': 0.35511520708208405, 'support': 163522}, '1': {'precision': 0.31121026556297504, 'recall': 0.3290622763063708, 'f1-score': 0.31988739700463387, 'support': 153670}, '2': {'precision': 0.3951868561502875, 'recall': 0.39910378805861274, 'f1-score': 0.39713566420674834, 'support': 172727}, 'accuracy': 0.3586368358851157, 'macro avg': {'precision': 0.35790979582452714, 'recall': 0.3572835687289597, 'f1-score': 0.3573794227644887, 'support': 489919}, 'weighted avg': {'precision': 0.3595492895213126, 'recall': 0.3586368358851157, 'f1-score': 0.3588803395288153, 'support': 489919}}
[[56200 55879 51443]
 [49043 50567 54060]
 [47752 56039 68936]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1398144
{'0': {'precision': 0.3798622583621189, 'recall': 0.28892914259603775, 'f1-score': 0.32821377923197426, 'support': 61278}, '1': {'precision': 0.34807201309328967, 'recall': 0.4318178126472069, 'f1-score': 0.3854485348489901, 'support': 61563}, '2': {'precision': 0.3800396013244813, 'recall': 0.37913747883536403, 'f1-score': 0.37958800408838217, 'support': 60242}, 'accuracy': 0.3666588377948799, 'macro avg': {'precision': 0.36932462425996326, 'recall': 0.3666281446928696, 'f1-score': 0.3644167727231155, 'support': 183083}, 'weighted avg': {'precision': 0.369230908784352, 'recall': 0.3666588377948799, 'f1-score': 0.36436366378624785, 'support': 183083}}
[[17705 25976 17597]
 [15317 26584 19662]
 [13587 23815 22840]]
Evaluating performance on  val set...
214/214 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.139289
{'0': {'precision': 0.3883088572739789, 'recall': 0.34782385283387285, 'f1-score': 0.3669530805301819, 'support': 19461}, '1': {'precision': 0.2835323840146991, 'recall': 0.3117030677944704, 'f1-score': 0.2969511095074869, 'support': 15842}, '2': {'precision': 0.3871049177017066, 'recall': 0.3962069143713503, 'f1-score': 0.3916030339402916, 'support': 19351}, 'accuracy': 0.3544845756943682, 'macro avg': {'precision': 0.35298205299679486, 'recall': 0.35191127833323116, 'f1-score': 0.3518357413259868, 'support': 54654}, 'weighted avg': {'precision': 0.35751209355976676, 'recall': 0.3544845756943682, 'f1-score': 0.3553899748745574, 'support': 54654}}
[[6769 6351 6341]
 [5106 4938 5798]
 [5557 6127 7667]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/EXC
Evaluating performance on  test set...
4918/4918 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0271976
{'0': {'precision': 0.5968431922112406, 'recall': 0.30639684579268023, 'f1-score': 0.4049219782827313, 'support': 409358}, '1': {'precision': 0.40961085372890454, 'recall': 0.8557830870179595, 'f1-score': 0.554037805291352, 'support': 428854}, '2': {'precision': 0.6549380169348343, 'recall': 0.23776647718762703, 'f1-score': 0.3488776097535451, 'support': 420627}, 'accuracy': 0.4706265058518206, 'macro avg': {'precision': 0.5537973542916599, 'recall': 0.4666488033327556, 'f1-score': 0.4359457977758761, 'support': 1258839}, 'weighted avg': {'precision': 0.5524696977067863, 'recall': 0.4706265058518206, 'f1-score': 0.43699529685216626, 'support': 1258839}}
[[125426 251218  32714]
 [ 41870 367006  19978]
 [ 42853 277763 100011]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98393565
{'0': {'precision': 0.5908049820279194, 'recall': 0.3195554671392918, 'f1-score': 0.4147696930218364, 'support': 110588}, '1': {'precision': 0.45748135861224365, 'recall': 0.8540472883023673, 'f1-score': 0.5958096526382733, 'support': 138216}, '2': {'precision': 0.6553467681162943, 'recall': 0.2446903136799303, 'f1-score': 0.3563342211178154, 'support': 110176}, 'accuracy': 0.5023706056047691, 'macro avg': {'precision': 0.5678777029188191, 'recall': 0.4727643563738631, 'f1-score': 0.4556378555926417, 'support': 358980}, 'weighted avg': {'precision': 0.5592809358137898, 'recall': 0.5023706056047691, 'f1-score': 0.4665397986150394, 'support': 358980}}
[[ 35339  67134   8115]
 [ 14110 118043   6063]
 [ 10366  72851  26959]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0155448
{'0': {'precision': 0.5894495412844036, 'recall': 0.2963409009378363, 'f1-score': 0.394400300105719, 'support': 39026}, '1': {'precision': 0.423690694152483, 'recall': 0.8529920364050056, 'f1-score': 0.566162256856349, 'support': 43950}, '2': {'precision': 0.653917208347588, 'recall': 0.2404821217382552, 'f1-score': 0.3516447126352196, 'support': 39741}, 'accuracy': 0.4776110889281844, 'macro avg': {'precision': 0.5556858145948249, 'recall': 0.4632716863603657, 'f1-score': 0.4374024231990959, 'support': 122717}, 'weighted avg': {'precision': 0.5509618682261485, 'recall': 0.4776110889281844, 'f1-score': 0.4420692310405127, 'support': 122717}}
[[11565 24449  3012]
 [ 4415 37489  2046]
 [ 3640 26544  9557]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/AAL
Evaluating performance on  test set...
4856/4856 - 91s - 91s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0404092
{'0': {'precision': 0.517273063392527, 'recall': 0.29507060194369383, 'f1-score': 0.375782026000827, 'support': 478882}, '1': {'precision': 0.3496767666375156, 'recall': 0.6692429374081076, 'f1-score': 0.4593467091051207, 'support': 304704}, '2': {'precision': 0.4951832038161857, 'recall': 0.41674740213228717, 'f1-score': 0.45259214335788756, 'support': 459319}, 'accuracy': 0.4317667078336639, 'macro avg': {'precision': 0.45404434461540943, 'recall': 0.4603536471613629, 'f1-score': 0.4292402928212784, 'support': 1242905}, 'weighted avg': {'precision': 0.46802267481320314, 'recall': 0.4317667078336639, 'f1-score': 0.4246536931796849, 'support': 1242905}}
[[141304 199533 138045]
 [ 43684 203921  57099]
 [ 88183 179716 191420]]
Evaluating performance on  train set...
2076/2076 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0224733
{'0': {'precision': 0.5199850435749691, 'recall': 0.30931198102016605, 'f1-score': 0.38788901722528757, 'support': 175344}, '1': {'precision': 0.42348864449795015, 'recall': 0.7269685765033121, 'f1-score': 0.5352010164933447, 'support': 179038}, '2': {'precision': 0.5165613232359498, 'recall': 0.34947578914070093, 'f1-score': 0.4169005542546202, 'support': 177028}, 'accuracy': 0.4634049039348149, 'macro avg': {'precision': 0.4866783371029564, 'recall': 0.46191878222139304, 'f1-score': 0.4466635293244175, 'support': 531410}, 'weighted avg': {'precision': 0.486333782473132, 'recall': 0.4634049039348149, 'f1-score': 0.4471846648461135, 'support': 531410}}
[[ 54236  88090  33018]
 [ 24001 130155  24882]
 [ 26066  89095  61867]]
Evaluating performance on  val set...
588/588 - 11s - 11s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0310153
{'0': {'precision': 0.5369254889017245, 'recall': 0.2573157228725087, 'f1-score': 0.3479027989413746, 'support': 50576}, '1': {'precision': 0.4022099333084794, 'recall': 0.7774174823355151, 'f1-score': 0.5301420254840538, 'support': 49959}, '2': {'precision': 0.5256879490307713, 'recall': 0.3116423907584129, 'f1-score': 0.39130708979226314, 'support': 49775}, 'accuracy': 0.4481737741999867, 'macro avg': {'precision': 0.4882744570803251, 'recall': 0.4487918653221456, 'f1-score': 0.42311730473923054, 'support': 150310}, 'weighted avg': {'precision': 0.4884283630354506, 'recall': 0.4481737741999867, 'f1-score': 0.42284750053108044, 'support': 150310}}
[[13014 29440  8122]
 [ 5246 38839  5874]
 [ 5978 28285 15512]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/WBA
Evaluating performance on  test set...
4353/4353 - 84s - 84s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0426948
{'0': {'precision': 0.5180820038640565, 'recall': 0.2636769651393945, 'f1-score': 0.3494844213846363, 'support': 375266}, '1': {'precision': 0.4242018414076867, 'recall': 0.7197786572814293, 'f1-score': 0.5338053090496088, 'support': 383297}, '2': {'precision': 0.46240175872492445, 'recall': 0.35477124183006536, 'f1-score': 0.4014984490575042, 'support': 355725}, 'accuracy': 0.44964946225751334, 'macro avg': {'precision': 0.46822853466555586, 'recall': 0.44607562141696305, 'f1-score': 0.4282627264972498, 'support': 1114288}, 'weighted avg': {'precision': 0.46801340415629966, 'recall': 0.44964946225751334, 'f1-score': 0.4294927614845493, 'support': 1114288}}
[[ 98949 194563  81754]
 [ 42438 275889  64970]
 [ 49604 179920 126201]]
Evaluating performance on  train set...
1542/1542 - 29s - 29s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0591599
{'0': {'precision': 0.46974093264248706, 'recall': 0.30226717048232943, 'f1-score': 0.36783878820665405, 'support': 134970}, '1': {'precision': 0.3968494367316412, 'recall': 0.6618282168415472, 'f1-score': 0.49617776323171875, 'support': 128278}, '2': {'precision': 0.4651376048964098, 'recall': 0.3321935803221262, 'f1-score': 0.38758229748820516, 'support': 131315}, 'accuracy': 0.42912538682035567, 'macro avg': {'precision': 0.443909324756846, 'recall': 0.43209632254866764, 'f1-score': 0.4171996163088593, 'support': 394563}, 'weighted avg': {'precision': 0.44451083936098923, 'recall': 0.42912538682035567, 'f1-score': 0.41613446205233173, 'support': 394563}}
[[40797 65668 28505]
 [21724 84898 21656]
 [24329 63364 43622]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0574208
{'0': {'precision': 0.4768177028451001, 'recall': 0.2847771887783506, 'f1-score': 0.3565853880309758, 'support': 41313}, '1': {'precision': 0.4049383435002257, 'recall': 0.68211693152835, 'f1-score': 0.5081899820030513, 'support': 40776}, '2': {'precision': 0.46682693912985407, 'recall': 0.33917178137357173, 'f1-score': 0.39289026275115924, 'support': 41221}, 'accuracy': 0.43435244505717296, 'macro avg': {'precision': 0.44952766182505993, 'recall': 0.43535530056009075, 'f1-score': 0.4192218775950621, 'support': 123310}, 'weighted avg': {'precision': 0.44970893609663887, 'recall': 0.43435244505717296, 'f1-score': 0.41885407803702585, 'support': 123310}}
[[11765 20672  8876]
 [ 5870 27814  7092]
 [ 7039 20201 13981]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/ATVI
Evaluating performance on  test set...
5497/5497 - 104s - 104s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649589
{'0': {'precision': 0.4441062051356169, 'recall': 0.3139230968972284, 'f1-score': 0.36783589999376526, 'support': 469838}, '1': {'precision': 0.3957128648661662, 'recall': 0.5898946216202879, 'f1-score': 0.47367515748616507, 'support': 445822}, '2': {'precision': 0.4598022879638291, 'recall': 0.38399034871963883, 'f1-score': 0.41849059406654054, 'support': 491541}, 'accuracy': 0.425829714447332, 'macro avg': {'precision': 0.4332071193218707, 'recall': 0.4292693557457184, 'f1-score': 0.4200005505154903, 'support': 1407201}, 'weighted avg': {'precision': 0.4342571874784771, 'recall': 0.425829714447332, 'f1-score': 0.419061224899733, 'support': 1407201}}
[[147493 196699 125646]
 [ 86731 262988  96103]
 [ 97888 204906 188747]]
Evaluating performance on  train set...
2058/2058 - 43s - 43s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.063899
{'0': {'precision': 0.46438317493177755, 'recall': 0.27977142079662576, 'f1-score': 0.3491778224322872, 'support': 176394}, '1': {'precision': 0.4036258190519497, 'recall': 0.6195123625587808, 'f1-score': 0.4887925976077635, 'support': 174802}, '2': {'precision': 0.4442977616645649, 'recall': 0.38517206823513334, 'f1-score': 0.41262763660318885, 'support': 175628}, 'accuracy': 0.4276361745098933, 'macro avg': {'precision': 0.4374355852160974, 'recall': 0.42815195053018, 'f1-score': 0.4168660188810798, 'support': 526824}, 'weighted avg': {'precision': 0.437527776765028, 'recall': 0.42763617450989333, 'f1-score': 0.4166548278333902, 'support': 526824}}
[[ 49350  81445  45599]
 [ 27500 108292  39010]
 [ 29420  78561  67647]]
Evaluating performance on  val set...
681/681 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0647546
{'0': {'precision': 0.4485301755479381, 'recall': 0.2893132328308208, 'f1-score': 0.351743238840013, 'support': 59700}, '1': {'precision': 0.396057838281775, 'recall': 0.5733844962078222, 'f1-score': 0.4685032126060749, 'support': 55509}, '2': {'precision': 0.4403471107182161, 'recall': 0.4130648163817905, 'f1-score': 0.4262698766143609, 'support': 59090}, 'accuracy': 0.42173506445820114, 'macro avg': {'precision': 0.4283117081826431, 'recall': 0.4252541818068112, 'f1-score': 0.4155054426868163, 'support': 174299}, 'weighted avg': {'precision': 0.4290451281862451, 'recall': 0.42173506445820114, 'f1-score': 0.4141934445776624, 'support': 174299}}
[[17272 24915 17513]
 [10173 31828 13508]
 [11063 23619 24408]]
testing model on single stock: results/universal/W2/deepVOL_L3/h100/AAPL
Evaluating performance on  test set...
14883/14883 - 268s - 268s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1651347
{'0': {'precision': 0.3468996789492828, 'recall': 0.3726922943250297, 'f1-score': 0.35933373925764883, 'support': 1179689}, '1': {'precision': 0.37123470099562433, 'recall': 0.14543015427421557, 'f1-score': 0.20898932562207703, 'support': 1408855}, '2': {'precision': 0.36092340786593674, 'recall': 0.5882384728436859, 'f1-score': 0.44736106363198785, 'support': 1221355}, 'accuracy': 0.3577520033995652, 'macro avg': {'precision': 0.35968592927028126, 'recall': 0.3687869738143104, 'f1-score': 0.33856137617057125, 'support': 3809899}, 'weighted avg': {'precision': 0.3603941230056996, 'recall': 0.3577520033995652, 'f1-score': 0.33195745812491473, 'support': 3809899}}
[[439661 196230 543798]
 [475628 204890 728337]
 [352112 150795 718448]]
Evaluating performance on  train set...
6147/6147 - 113s - 113s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1426696
{'0': {'precision': 0.3627178952996377, 'recall': 0.37914016083682944, 'f1-score': 0.3707472609477291, 'support': 518911}, '1': {'precision': 0.3362530924494025, 'recall': 0.14188450011941356, 'f1-score': 0.1995622292715831, 'support': 519204}, '2': {'precision': 0.3768950169828004, 'recall': 0.5716383062181295, 'f1-score': 0.4542752982110307, 'support': 535370}, 'accuracy': 0.36634921845457696, 'macro avg': {'precision': 0.35862200157728025, 'recall': 0.3642209890581241, 'f1-score': 0.34152826281011434, 'support': 1573485}, 'weighted avg': {'precision': 0.35880897601312484, 'recall': 0.36634921845457696, 'f1-score': 0.3426811860396569, 'support': 1573485}}
[[196740  81680 240491]
 [180068  73667 265469]
 [165597  63735 306038]]
Evaluating performance on  val set...
2174/2174 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1314846
{'0': {'precision': 0.3733851325948488, 'recall': 0.3700122028919774, 'f1-score': 0.3716910159438724, 'support': 185202}, '1': {'precision': 0.3508161874285186, 'recall': 0.16753282577512965, 'f1-score': 0.22677086561546708, 'support': 181260}, '2': {'precision': 0.3825511322770535, 'recall': 0.5765462371475779, 'f1-score': 0.4599291435095791, 'support': 190042}, 'accuracy': 0.3745920963730719, 'macro avg': {'precision': 0.3689174841001403, 'recall': 0.3713637552715617, 'f1-score': 0.3527970083563062, 'support': 556504}, 'weighted avg': {'precision': 0.36916427867602075, 'recall': 0.3745920963730719, 'f1-score': 0.3546214599124967, 'support': 556504}}
[[ 68527  31106  85569]
 [ 59616  30367  91277]
 [ 55386  25088 109568]]
training model: results/universal/W2/deepVOL_L3/h200
Epoch 1/50
9940/9940 - 830s - loss: 3.2586 - accuracy200: 0.3854 - val_loss: 3.2823 - val_accuracy200: 0.3577 - 830s/epoch - 83ms/step
Epoch 2/50
9940/9940 - 824s - loss: 3.2494 - accuracy200: 0.3933 - val_loss: 3.2866 - val_accuracy200: 0.3526 - 824s/epoch - 83ms/step
Epoch 3/50
9940/9940 - 839s - loss: 3.2436 - accuracy200: 0.3972 - val_loss: 3.2786 - val_accuracy200: 0.3629 - 839s/epoch - 84ms/step
Epoch 4/50
9940/9940 - 854s - loss: 3.2420 - accuracy200: 0.3981 - val_loss: 3.2807 - val_accuracy200: 0.3558 - 854s/epoch - 86ms/step
Epoch 5/50
9940/9940 - 847s - loss: 3.2357 - accuracy200: 0.4020 - val_loss: 3.2816 - val_accuracy200: 0.3587 - 847s/epoch - 85ms/step
Epoch 6/50
9940/9940 - 832s - loss: 3.2309 - accuracy200: 0.4041 - val_loss: 3.2765 - val_accuracy200: 0.3594 - 832s/epoch - 84ms/step
Epoch 7/50
9940/9940 - 790s - loss: 3.2220 - accuracy200: 0.4079 - val_loss: 3.3118 - val_accuracy200: 0.3378 - 790s/epoch - 79ms/step
Epoch 8/50
9940/9940 - 794s - loss: 3.2202 - accuracy200: 0.4097 - val_loss: 3.3058 - val_accuracy200: 0.3520 - 794s/epoch - 80ms/step
Epoch 9/50
9940/9940 - 783s - loss: 3.2136 - accuracy200: 0.4129 - val_loss: 3.3159 - val_accuracy200: 0.3498 - 783s/epoch - 79ms/step
Epoch 10/50
9940/9940 - 791s - loss: 3.2048 - accuracy200: 0.4162 - val_loss: 3.3215 - val_accuracy200: 0.3510 - 791s/epoch - 80ms/step
Epoch 11/50
9940/9940 - 804s - loss: 3.2038 - accuracy200: 0.4173 - val_loss: 3.3325 - val_accuracy200: 0.3435 - 804s/epoch - 81ms/step
Epoch 12/50
9940/9940 - 804s - loss: 3.1971 - accuracy200: 0.4201 - val_loss: 3.3081 - val_accuracy200: 0.3589 - 804s/epoch - 81ms/step
Epoch 13/50
9940/9940 - 810s - loss: 3.1927 - accuracy200: 0.4219 - val_loss: 3.3060 - val_accuracy200: 0.3555 - 810s/epoch - 82ms/step
Epoch 14/50
9940/9940 - 825s - loss: 3.1889 - accuracy200: 0.4230 - val_loss: 3.2985 - val_accuracy200: 0.3587 - 825s/epoch - 83ms/step
Epoch 15/50
9940/9940 - 817s - loss: 3.1858 - accuracy200: 0.4246 - val_loss: 3.2954 - val_accuracy200: 0.3574 - 817s/epoch - 82ms/step
Epoch 16/50
9940/9940 - 811s - loss: 3.1828 - accuracy200: 0.4264 - val_loss: 3.2874 - val_accuracy200: 0.3683 - 811s/epoch - 82ms/step
testing model in sample: results/universal/W2/deepVOL_L3/h200/TICKERS_in_sample
Evaluating performance on  test set...
26256/26256 - 1281s - 1281s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0900257
{'0': {'precision': 0.34093355448972607, 'recall': 0.565996217137647, 'f1-score': 0.4255392383695184, 'support': 2077263}, '1': {'precision': 0.37122991467377936, 'recall': 0.2823071057672918, 'f1-score': 0.32071891723918994, 'support': 2539008}, '2': {'precision': 0.38313811498996575, 'recall': 0.24421168373645402, 'f1-score': 0.2982922903785424, 'support': 2104498}, 'accuracy': 0.3580611087808553, 'macro avg': {'precision': 0.36510052805115706, 'recall': 0.3641716688804643, 'f1-score': 0.3481834819957503, 'support': 6720769}, 'weighted avg': {'precision': 0.3655947374647437, 'recall': 0.3580611087808553, 'f1-score': 0.34609437402950227, 'support': 6720769}}
[[1175723  572787  328753]
 [1323520  716780  498708]
 [ 949297  641258  513943]]
Evaluating performance on  train set...
9940/9940 - 486s - 486s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938822
{'0': {'precision': 0.3590758927776845, 'recall': 0.5486510422393988, 'f1-score': 0.43406746063299656, 'support': 845727}, '1': {'precision': 0.3227660767905456, 'recall': 0.28735389709063475, 'f1-score': 0.30403230179276464, 'support': 839049}, '2': {'precision': 0.40882831086439336, 'recall': 0.24010418607250641, 'f1-score': 0.30253189441686323, 'support': 858848}, 'accuracy': 0.3582785820545804, 'macro avg': {'precision': 0.3635567601442078, 'recall': 0.3587030418008466, 'f1-score': 0.34687721894754153, 'support': 2543624}, 'weighted avg': {'precision': 0.3638973797485343, 'recall': 0.3582785820545804, 'f1-score': 0.34676095308182886, 'support': 2543624}}
[[464009 242047 139671]
 [439429 241104 158516]
 [388793 263842 206213]]
Evaluating performance on  val set...
3393/3393 - 166s - 166s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0923992
{'0': {'precision': 0.3542068407919743, 'recall': 0.5374051344596762, 'f1-score': 0.42698523614742284, 'support': 283691}, '1': {'precision': 0.33736105123062216, 'recall': 0.3028353160914705, 'f1-score': 0.31916719869475774, 'support': 297145}, '2': {'precision': 0.40467080861619104, 'recall': 0.24080682051585547, 'f1-score': 0.301939173041457, 'support': 287251}, 'accuracy': 0.35896747676212176, 'macro avg': {'precision': 0.36541290021292916, 'recall': 0.3603490903556674, 'f1-score': 0.3493638692945458, 'support': 868087}, 'weighted avg': {'precision': 0.36513913569129436, 'recall': 0.35896747676212176, 'f1-score': 0.34870138048304367, 'support': 868087}}
[[152457  84684  46550]
 [151947  89986  55212]
 [126014  92065  69172]]
testing model out of sample: results/universal/W2/deepVOL_L3/h200/TICKERS_out_of_sample
Evaluating performance on  test set...
14326/14326 - 696s - 696s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971636
{'0': {'precision': 0.36256553200447406, 'recall': 0.5754827499861112, 'f1-score': 0.44486027726706345, 'support': 1241999}, '1': {'precision': 0.28945424702503075, 'recall': 0.2568081472312555, 'f1-score': 0.2721556880660594, 'support': 1139921}, '2': {'precision': 0.4185549105060869, 'recall': 0.22283164943069536, 'f1-score': 0.29083016985756993, 'support': 1284813}, 'accuracy': 0.3528446167201157, 'macro avg': {'precision': 0.3568582298451972, 'recall': 0.35170751554935403, 'f1-score': 0.3359487117302309, 'support': 3666733}, 'weighted avg': {'precision': 0.35945507707790614, 'recall': 0.3528446167201157, 'f1-score': 0.33719782341026194, 'support': 3666733}}
[[714749 340547 186703]
 [636167 292741 211013]
 [620449 378067 286297]]
Evaluating performance on  train set...
5373/5373 - 266s - 266s/epoch - 49ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0926887
{'0': {'precision': 0.36536039706644935, 'recall': 0.6314898566827837, 'f1-score': 0.4629007895885978, 'support': 460796}, '1': {'precision': 0.32355060616930836, 'recall': 0.22304408054114264, 'f1-score': 0.26405689340259336, 'support': 456959}, '2': {'precision': 0.4079600668083814, 'recall': 0.23510019972130894, 'f1-score': 0.2982970591623102, 'support': 457137}, 'accuracy': 0.36394349519816827, 'macro avg': {'precision': 0.365623690014713, 'recall': 0.3632113789817451, 'f1-score': 0.3417515807178338, 'support': 1374892}, 'weighted avg': {'precision': 0.36562843629298564, 'recall': 0.36394349519816827, 'f1-score': 0.34208405382088497, 'support': 1374892}}
[[290988  99584  70224]
 [269294 101922  85743]
 [236159 113505 107473]]
Evaluating performance on  val set...
1685/1685 - 81s - 81s/epoch - 48ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0916939
{'0': {'precision': 0.3694265637638177, 'recall': 0.6059577937782445, 'f1-score': 0.4590127036802462, 'support': 144718}, '1': {'precision': 0.3246800521112729, 'recall': 0.23791941597641444, 'f1-score': 0.27460988770599387, 'support': 142460}, '2': {'precision': 0.40991406460901647, 'recall': 0.25396880705813485, 'f1-score': 0.3136257627001954, 'support': 143494}, 'accuracy': 0.3669381803321321, 'macro avg': {'precision': 0.36800689349470234, 'recall': 0.3659486722709313, 'f1-score': 0.3490827846954785, 'support': 430672}, 'weighted avg': {'precision': 0.368114951669833, 'recall': 0.3669381803321321, 'f1-score': 0.3495740151361026, 'support': 430672}}
[[87693 33439 23586]
 [79691 33894 28875]
 [69992 37059 36443]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/LILAK
Evaluating performance on  test set...
987/987 - 19s - 19s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102111
{'0': {'precision': 0.30418870366651046, 'recall': 0.3371881609380218, 'f1-score': 0.3198395053762179, 'support': 80851}, '1': {'precision': 0.28700138480764686, 'recall': 0.40406814318152096, 'f1-score': 0.3356192451060258, 'support': 84117}, '2': {'precision': 0.3791427607154911, 'recall': 0.19252344990688589, 'f1-score': 0.255372351710969, 'support': 87527}, 'accuracy': 0.309320976653003, 'macro avg': {'precision': 0.3234442830632161, 'recall': 0.31125991800880953, 'f1-score': 0.30361036739773756, 'support': 252495}, 'weighted avg': {'precision': 0.32444557232084065, 'recall': 0.309320976653003, 'f1-score': 0.30274898005094025, 'support': 252495}}
[[27262 39951 13638]
 [36172 33989 13956]
 [26188 44488 16851]]
Evaluating performance on  train set...
237/237 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029521
{'0': {'precision': 0.3459445316588174, 'recall': 0.3319274991213536, 'f1-score': 0.3387910933456325, 'support': 19917}, '1': {'precision': 0.31929473909629524, 'recall': 0.4513394884213713, 'f1-score': 0.37400447333765335, 'support': 19821}, '2': {'precision': 0.3639549623443442, 'recall': 0.234652180183645, 'f1-score': 0.2853384777271133, 'support': 20801}, 'accuracy': 0.3376005550141231, 'macro avg': {'precision': 0.34306474436648565, 'recall': 0.3393063892421233, 'f1-score': 0.33271134813679976, 'support': 60539}, 'weighted avg': {'precision': 0.3434074800112496, 'recall': 0.3376005550141231, 'f1-score': 0.3319541212671546, 'support': 60539}}
[[6611 9108 4198]
 [6543 8946 4332]
 [5956 9964 4881]]
Evaluating performance on  val set...
85/85 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991622
{'0': {'precision': 0.37698675496688744, 'recall': 0.30547357123691976, 'f1-score': 0.3374833259226323, 'support': 7454}, '1': {'precision': 0.31052473161432725, 'recall': 0.45508013527422436, 'f1-score': 0.369155534351145, 'support': 6801}, '2': {'precision': 0.3665295905596281, 'recall': 0.27910142954390743, 'f1-score': 0.3168959653733189, 'support': 7345}, 'accuracy': 0.3436111111111111, 'macro avg': {'precision': 0.35134702571361426, 'recall': 0.3465517120183505, 'f1-score': 0.3411782752156987, 'support': 21600}, 'weighted avg': {'precision': 0.35250452842095775, 'recall': 0.3436111111111111, 'f1-score': 0.34045501695446595, 'support': 21600}}
[[2277 3354 1823]
 [1986 3095 1720]
 [1777 3518 2050]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/QRTEA
Evaluating performance on  test set...
1242/1242 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974685
{'0': {'precision': 0.3354450234406316, 'recall': 0.7701618550307104, 'f1-score': 0.46733964222628255, 'support': 99966}, '1': {'precision': 0.30846833578792343, 'recall': 0.15590747529635074, 'f1-score': 0.2071275819869711, 'support': 107474}, '2': {'precision': 0.4808173600683096, 'recall': 0.14797161989506974, 'f1-score': 0.2262995246739929, 'support': 110359}, 'accuracy': 0.34636987529853774, 'macro avg': {'precision': 0.3749102397656216, 'recall': 0.3580136500740436, 'f1-score': 0.30025558296241556, 'support': 317799}, 'weighted avg': {'precision': 0.37680403705963844, 'recall': 0.34636987529853774, 'f1-score': 0.29563684487603004, 'support': 317799}}
[[76990 15669  7307]
 [80392 16756 10326]
 [72134 21895 16330]]
Evaluating performance on  train set...
528/528 - 11s - 11s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0832694
{'0': {'precision': 0.3646044733075559, 'recall': 0.7636636166357189, 'f1-score': 0.49356207661887924, 'support': 44699}, '1': {'precision': 0.2962844476943467, 'recall': 0.14509847806624887, 'f1-score': 0.19479875602830488, 'support': 44680}, '2': {'precision': 0.507907887280408, 'recall': 0.21651476885911936, 'f1-score': 0.303606072737351, 'support': 45535}, 'accuracy': 0.37414204604414664, 'macro avg': {'precision': 0.3895989360941036, 'recall': 0.3750922878536957, 'f1-score': 0.3306556351281784, 'support': 134914}, 'weighted avg': {'precision': 0.3903451837664826, 'recall': 0.37414204604414664, 'f1-score': 0.3305071542184445, 'support': 134914}}
[[34135  6329  4235]
 [32880  6483  5317]
 [26607  9069  9859]]
Evaluating performance on  val set...
159/159 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0813463
{'0': {'precision': 0.3949992502624082, 'recall': 0.711670944211806, 'f1-score': 0.5080275782267007, 'support': 14806}, '1': {'precision': 0.27334915538182325, 'recall': 0.14888601627252682, 'f1-score': 0.19277345672934923, 'support': 13151}, '2': {'precision': 0.4652161042036708, 'recall': 0.24869441367304954, 'f1-score': 0.3241208621223059, 'support': 12638}, 'accuracy': 0.38521985466190417, 'macro avg': {'precision': 0.37785483661596747, 'recall': 0.3697504580524608, 'f1-score': 0.3416406323594519, 'support': 40595}, 'weighted avg': {'precision': 0.3774498033437016, 'recall': 0.38521985466190417, 'f1-score': 0.3486453875643283, 'support': 40595}}
[[10537  2441  1828]
 [ 9408  1958  1785]
 [ 6731  2764  3143]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/XRAY
Evaluating performance on  test set...
1072/1072 - 22s - 22s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.104057
{'0': {'precision': 0.34978331933157547, 'recall': 0.4645859802242722, 'f1-score': 0.3990927122778047, 'support': 90515}, '1': {'precision': 0.2751760203336352, 'recall': 0.3458586798203204, 'f1-score': 0.3064949996745992, 'support': 81701}, '2': {'precision': 0.4078903767810849, 'recall': 0.20516289694794945, 'f1-score': 0.2730071754729289, 'support': 101997}, 'accuracy': 0.33271580851381954, 'macro avg': {'precision': 0.3442832388154318, 'recall': 0.33853585233084743, 'f1-score': 0.3261982958084442, 'support': 274213}, 'weighted avg': {'precision': 0.3491679385992502, 'recall': 0.33271580851381954, 'f1-score': 0.3246043684907435, 'support': 274213}}
[[42052 33542 14921]
 [37988 28257 15456]
 [40183 40888 20926]]
Evaluating performance on  train set...
286/286 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011509
{'0': {'precision': 0.3480400907908495, 'recall': 0.5443775180501815, 'f1-score': 0.4246110765401369, 'support': 25069}, '1': {'precision': 0.294187534271614, 'recall': 0.27205882352941174, 'f1-score': 0.28269078774040574, 'support': 23664}, '2': {'precision': 0.3719956452558412, 'recall': 0.18277578899724314, 'f1-score': 0.24511643306478312, 'support': 24303}, 'accuracy': 0.33582069116600033, 'macro avg': {'precision': 0.3380744234394349, 'recall': 0.3330707101922788, 'f1-score': 0.31747276578177525, 'support': 73036}, 'weighted avg': {'precision': 0.3385629143667778, 'recall': 0.33582069116600033, 'f1-score': 0.3189007414377441, 'support': 73036}}
[[13647  7536  3886]
 [13613  6438  3613]
 [11951  7910  4442]]
Evaluating performance on  val set...
117/117 - 2s - 2s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.102683
{'0': {'precision': 0.33648917566182235, 'recall': 0.5696784073506891, 'f1-score': 0.4230798392599894, 'support': 9795}, '1': {'precision': 0.29888492930221866, 'recall': 0.26345121086229606, 'f1-score': 0.2800517018526497, 'support': 9869}, '2': {'precision': 0.3801634636624696, 'recall': 0.16964021685559388, 'f1-score': 0.23459651035986911, 'support': 10145}, 'accuracy': 0.33214800899057334, 'macro avg': {'precision': 0.33851252287550354, 'recall': 0.3342566116895263, 'f1-score': 0.3125760171575027, 'support': 29809}, 'weighted avg': {'precision': 0.33890318969931565, 'recall': 0.33214800899057334, 'f1-score': 0.31157968629394706, 'support': 29809}}
[[5580 2945 1270]
 [5733 2600 1536]
 [5270 3154 1721]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/CHTR
Evaluating performance on  test set...
860/860 - 17s - 17s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1201601
{'0': {'precision': 0.32001644060830253, 'recall': 0.10773935544577747, 'f1-score': 0.16120583454972723, 'support': 72267}, '1': {'precision': 0.28485145540499945, 'recall': 0.8517532109368844, 'f1-score': 0.4269261757689695, 'support': 63455}, '2': {'precision': 0.3107440830921165, 'recall': 0.021668922609294483, 'f1-score': 0.04051279205283312, 'support': 84222}, 'accuracy': 0.2894327647037428, 'macro avg': {'precision': 0.3052039930351395, 'recall': 0.3270538296639855, 'f1-score': 0.2095482674571766, 'support': 219944}, 'weighted avg': {'precision': 0.30632054242147394, 'recall': 0.2894327647037428, 'f1-score': 0.19165119712789985, 'support': 219944}}
[[ 7786 62611  1870]
 [ 7229 54048  2178]
 [ 9315 73082  1825]]
Evaluating performance on  train set...
320/320 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065309
{'0': {'precision': 0.326713583341367, 'recall': 0.12440349460392042, 'f1-score': 0.18019407151402367, 'support': 27242}, '1': {'precision': 0.3299499057995356, 'recall': 0.8300389448159307, 'f1-score': 0.47219638620949117, 'support': 27218}, '2': {'precision': 0.2783650458069063, 'recall': 0.02902064506649034, 'f1-score': 0.05256154357950765, 'support': 27222}, 'accuracy': 0.3277466271638794, 'macro avg': {'precision': 0.3116761783159363, 'recall': 0.32782102816211384, 'f1-score': 0.23498400043434087, 'support': 81682}, 'weighted avg': {'precision': 0.3116789653827389, 'recall': 0.3277466271638794, 'f1-score': 0.23495896862658017, 'support': 81682}}
[[ 3389 22866   987]
 [ 3565 22592  1061]
 [ 3419 23013   790]]
Evaluating performance on  val set...
98/98 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1070395
{'0': {'precision': 0.34951456310679613, 'recall': 0.11943127962085308, 'f1-score': 0.17802896503002472, 'support': 8440}, '1': {'precision': 0.32748235294117645, 'recall': 0.8561761811023622, 'f1-score': 0.47375587174075834, 'support': 8128}, '2': {'precision': 0.28536880290205563, 'recall': 0.028118670320505183, 'f1-score': 0.05119305856832972, 'support': 8393}, 'accuracy': 0.32863266696045834, 'macro avg': {'precision': 0.3207885729833427, 'recall': 0.33457537701457346, 'f1-score': 0.23432596511303758, 'support': 24961}, 'weighted avg': {'precision': 0.3207715972951482, 'recall': 0.32863266696045834, 'f1-score': 0.23167803897785683, 'support': 24961}}
[[1008 7122  310]
 [ 888 6959  281]
 [ 988 7169  236]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/PCAR
Evaluating performance on  test set...
1914/1914 - 36s - 36s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005827
{'0': {'precision': 0.3532622367227461, 'recall': 0.5720210579587605, 'f1-score': 0.43678177169853555, 'support': 162029}, '1': {'precision': 0.30332478971878274, 'recall': 0.27128669395978355, 'f1-score': 0.2864125821922711, 'support': 154862}, '2': {'precision': 0.39854909711616204, 'recall': 0.2051113114640405, 'f1-score': 0.270837466994307, 'support': 173028}, 'accuracy': 0.3473757906919307, 'macro avg': {'precision': 0.35171204118589694, 'recall': 0.34947302112752815, 'f1-score': 0.3313439402950379, 'support': 489919}, 'weighted avg': {'precision': 0.35347141816340105, 'recall': 0.3473757906919307, 'f1-score': 0.3306428291801144, 'support': 489919}}
[[92684 44526 24819]
 [84111 42012 28739]
 [85571 51967 35490]]
Evaluating performance on  train set...
716/716 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0967462
{'0': {'precision': 0.367562182923573, 'recall': 0.5760663125704168, 'f1-score': 0.44877871401344166, 'support': 62130}, '1': {'precision': 0.32141366355920414, 'recall': 0.26830603813032006, 'f1-score': 0.29246852843293303, 'support': 60267}, '2': {'precision': 0.3824858757062147, 'recall': 0.2231157103780114, 'f1-score': 0.28183085985471346, 'support': 60686}, 'accuracy': 0.3577666959794192, 'macro avg': {'precision': 0.35715390739633057, 'recall': 0.3558293536929161, 'f1-score': 0.34102603410036275, 'support': 183083}, 'weighted avg': {'precision': 0.35731779324061486, 'recall': 0.3577666959794192, 'f1-score': 0.3419870215468714, 'support': 183083}}
[[35791 16557  9782]
 [32019 16170 12078]
 [29564 17582 13540]]
Evaluating performance on  val set...
214/214 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992746
{'0': {'precision': 0.37297500085263124, 'recall': 0.5752761704366123, 'f1-score': 0.4525459849785852, 'support': 19010}, '1': {'precision': 0.3065837469353585, 'recall': 0.30497888287430847, 'f1-score': 0.30577920916085166, 'support': 16811}, '2': {'precision': 0.4008130081300813, 'recall': 0.18324218127754474, 'f1-score': 0.2515031155485916, 'support': 18833}, 'accuracy': 0.35704614483843816, 'macro avg': {'precision': 0.360123918639357, 'recall': 0.35449907819615517, 'f1-score': 0.33660943656267617, 'support': 54654}, 'weighted avg': {'precision': 0.362146329967663, 'recall': 0.35704614483843816, 'f1-score': 0.3381255102055222, 'support': 54654}}
[[10936  5602  2472]
 [ 8997  5127  2687]
 [ 9388  5994  3451]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/EXC
Evaluating performance on  test set...
4918/4918 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0875604
{'0': {'precision': 0.37830346907312556, 'recall': 0.7764929525222551, 'f1-score': 0.5087476409810481, 'support': 431360}, '1': {'precision': 0.26153041837216123, 'recall': 0.10635070844298103, 'f1-score': 0.15121159116838784, 'support': 385705}, '2': {'precision': 0.4954154701336116, 'recall': 0.242897952346675, 'f1-score': 0.32597376559148933, 'support': 441774}, 'accuracy': 0.3839045342573594, 'macro avg': {'precision': 0.37841645252629946, 'recall': 0.3752472044373037, 'f1-score': 0.3286443325803084, 'support': 1258839}, 'weighted avg': {'precision': 0.3836235200374504, 'recall': 0.3839045342573594, 'f1-score': 0.33505728969757254, 'support': 1258839}}
[[334948  49116  47296]
 [282689  41020  61996]
 [267758  66710 107306]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0859903
{'0': {'precision': 0.37117417918753476, 'recall': 0.7960278854621925, 'f1-score': 0.5062790855934377, 'support': 121497}, '1': {'precision': 0.28174934912938593, 'recall': 0.1016581061050019, 'f1-score': 0.14940818097186248, 'support': 116036}, '2': {'precision': 0.49292636344344626, 'recall': 0.22951575584411307, 'f1-score': 0.31319980898339844, 'support': 121447}, 'accuracy': 0.3799236726280016, 'macro avg': {'precision': 0.3819499639201223, 'recall': 0.37573391580376914, 'f1-score': 0.3229623585162329, 'support': 358980}, 'weighted avg': {'precision': 0.3834588132638074, 'recall': 0.3799236726280016, 'f1-score': 0.32560391930247845, 'support': 358980}}
[[96715 12871 11911]
 [87477 11796 16763]
 [76373 17200 27874]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0860127
{'0': {'precision': 0.3747878305453779, 'recall': 0.7665621184188474, 'f1-score': 0.5034356966523578, 'support': 41767}, '1': {'precision': 0.2738147429072462, 'recall': 0.11346118911063245, 'f1-score': 0.16044036697247707, 'support': 38533}, '2': {'precision': 0.4935984617549125, 'recall': 0.24813164533088147, 'f1-score': 0.3302478820207091, 'support': 42417}, 'accuracy': 0.38229422166448007, 'macro avg': {'precision': 0.3807336784025122, 'recall': 0.3760516509534537, 'f1-score': 0.33137464854851467, 'support': 122717}, 'weighted avg': {'precision': 0.38414916237433966, 'recall': 0.38229422166448007, 'f1-score': 0.3358733656649193, 'support': 122717}}
[[32017  5121  4629]
 [27992  4372  6169]
 [25418  6474 10525]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/AAL
Evaluating performance on  test set...
4856/4856 - 90s - 90s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0934246
{'0': {'precision': 0.37556403512021636, 'recall': 0.5843886331983656, 'f1-score': 0.45726286390096976, 'support': 433684}, '1': {'precision': 0.2788624726832056, 'recall': 0.24958748207281906, 'f1-score': 0.2634140916285435, 'support': 389074}, '2': {'precision': 0.4208304715466384, 'recall': 0.22020864126127285, 'f1-score': 0.28912590351844847, 'support': 420147}, 'accuracy': 0.35647776781009005, 'macro avg': {'precision': 0.3584189931166868, 'recall': 0.3513949188441525, 'f1-score': 0.33660095301598725, 'support': 1242905}, 'weighted avg': {'precision': 0.36059466397892587, 'recall': 0.35647776781009005, 'f1-score': 0.33974482614510176, 'support': 1242905}}
[[253440 123048  57196]
 [221831  97108  70135]
 [199554 128073  92520]]
Evaluating performance on  train set...
2076/2076 - 44s - 44s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0898744
{'0': {'precision': 0.36662706726436406, 'recall': 0.7051358530490962, 'f1-score': 0.4824236497204725, 'support': 177692}, '1': {'precision': 0.3163688101441055, 'recall': 0.18584150755868784, 'f1-score': 0.2341427666825565, 'support': 177081}, '2': {'precision': 0.43971366178926347, 'recall': 0.21317164580467285, 'f1-score': 0.28713920768673507, 'support': 176637}, 'accuracy': 0.3685666434579703, 'macro avg': {'precision': 0.37423651306591105, 'recall': 0.3680496688041523, 'f1-score': 0.33456854136325465, 'support': 531410}, 'weighted avg': {'precision': 0.3741730569295607, 'recall': 0.3685666434579703, 'f1-score': 0.3347781687608547, 'support': 531410}}
[[125297  31744  20651]
 [116844  32909  27328]
 [ 99615  39368  37654]]
Evaluating performance on  val set...
588/588 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857149
{'0': {'precision': 0.3725285001781261, 'recall': 0.6757133337372024, 'f1-score': 0.48027557501166174, 'support': 49521}, '1': {'precision': 0.3480144165592038, 'recall': 0.20312650776802085, 'f1-score': 0.2565258719442346, 'support': 51815}, '2': {'precision': 0.4282643917600767, 'recall': 0.26446685996651287, 'f1-score': 0.32700051756567405, 'support': 48974}, 'accuracy': 0.37881045838600225, 'macro avg': {'precision': 0.3829357694991355, 'recall': 0.38110223382391206, 'f1-score': 0.35460065484052344, 'support': 150310}, 'weighted avg': {'precision': 0.3822378496001206, 'recall': 0.37881045838600225, 'f1-score': 0.3532042987971814, 'support': 150310}}
[[33462  8893  7166]
 [31165 10525 10125]
 [25197 10825 12952]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/WBA
Evaluating performance on  test set...
4353/4353 - 80s - 80s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0841714
{'0': {'precision': 0.39332270706004185, 'recall': 0.6104243971228916, 'f1-score': 0.4783949569195719, 'support': 380799}, '1': {'precision': 0.34664259975362155, 'recall': 0.2752034476266187, 'f1-score': 0.3068194738821526, 'support': 382408}, '2': {'precision': 0.4068875112652593, 'recall': 0.2546250010681296, 'f1-score': 0.31323287484035084, 'support': 351081}, 'accuracy': 0.3832788291716325, 'macro avg': {'precision': 0.3822842726929742, 'recall': 0.38008428193921323, 'f1-score': 0.3661491018806918, 'support': 1114288}, 'weighted avg': {'precision': 0.38157664010997006, 'recall': 0.3832788291716325, 'f1-score': 0.36747470447511554, 'support': 1114288}}
[[232449  96269  52081]
 [198941 105240  78227]
 [159598 102089  89394]]
Evaluating performance on  train set...
1542/1542 - 28s - 28s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0897894
{'0': {'precision': 0.37151685344566077, 'recall': 0.6415496752177687, 'f1-score': 0.4705446481988682, 'support': 133628}, '1': {'precision': 0.3318352210891209, 'recall': 0.25002467598533107, 'f1-score': 0.28517859385216265, 'support': 131707}, '2': {'precision': 0.4211512551685689, 'recall': 0.21044200947163152, 'f1-score': 0.28064870666302033, 'support': 129228}, 'accuracy': 0.3696595980869975, 'macro avg': {'precision': 0.3748344432344502, 'recall': 0.3673387868915771, 'f1-score': 0.34545731623801706, 'support': 394563}, 'weighted avg': {'precision': 0.37452728704705057, 'recall': 0.3696595980869975, 'f1-score': 0.34647351215054106, 'support': 394563}}
[[85729 31554 16345]
 [77744 32930 21033]
 [67281 34752 27195]]
Evaluating performance on  val set...
482/482 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910324
{'0': {'precision': 0.3687554602493845, 'recall': 0.6771347317760871, 'f1-score': 0.4774824959078561, 'support': 41141}, '1': {'precision': 0.3398191598947007, 'recall': 0.2168894732997297, 'f1-score': 0.26478194952287526, 'support': 41067}, '2': {'precision': 0.4187816081287988, 'recall': 0.21960001946377306, 'f1-score': 0.2881174686776794, 'support': 41102}, 'accuracy': 0.37134863352526154, 'macro avg': {'precision': 0.37578540942429467, 'recall': 0.3712080748465299, 'f1-score': 0.3434606380361369, 'support': 123310}, 'weighted avg': {'precision': 0.3757933945894533, 'recall': 0.37134863352526154, 'f1-score': 0.3435253579011516, 'support': 123310}}
[[27858  7822  5461]
 [25094  8907  7066]
 [22594  9482  9026]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/ATVI
Evaluating performance on  test set...
5497/5497 - 116s - 116s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970924
{'0': {'precision': 0.3630763185946309, 'recall': 0.6304135433336141, 'f1-score': 0.4607761735213296, 'support': 474920}, '1': {'precision': 0.29978416673531594, 'recall': 0.2114922809048579, 'f1-score': 0.24801469926749012, 'support': 430167}, '2': {'precision': 0.4304288165894589, 'recall': 0.23926837331761314, 'f1-score': 0.30756588000220164, 'support': 502114}, 'accuracy': 0.3627861265021841, 'macro avg': {'precision': 0.36442976730646864, 'recall': 0.3603913991853617, 'f1-score': 0.3387855842636738, 'support': 1407201}, 'weighted avg': {'precision': 0.3677611056927847, 'recall': 0.3627861265021841, 'f1-score': 0.34106903970362, 'support': 1407201}}
[[299396  99234  76290]
 [256503  90977  82687]
 [268710 113264 120140]]
Evaluating performance on  train set...
2058/2058 - 44s - 44s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.091832
{'0': {'precision': 0.3662520168984287, 'recall': 0.6216844330295247, 'f1-score': 0.4609470123063571, 'support': 175988}, '1': {'precision': 0.3358907625295957, 'recall': 0.21103641711047771, 'f1-score': 0.2592125083686677, 'support': 176126}, '2': {'precision': 0.4016433923705722, 'recall': 0.2699845458187854, 'f1-score': 0.3229094643162759, 'support': 174710}, 'accuracy': 0.3677641869011283, 'macro avg': {'precision': 0.3679287239328655, 'recall': 0.3675684653195959, 'f1-score': 0.34768966166376697, 'support': 526824}, 'weighted avg': {'precision': 0.3678385446985538, 'recall': 0.3677641869011283, 'f1-score': 0.3477265985631021, 'support': 526824}}
[[109409  34730  31849]
 [100535  37169  38422]
 [ 88782  38759  47169]]
Evaluating performance on  val set...
681/681 - 14s - 14s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0914881
{'0': {'precision': 0.3709238846242339, 'recall': 0.6017679595507143, 'f1-score': 0.458953389062864, 'support': 58938}, '1': {'precision': 0.3266891017344033, 'recall': 0.22076831572318242, 'f1-score': 0.26348205524354346, 'support': 57164}, '2': {'precision': 0.4041596963871064, 'recall': 0.2781414849562692, 'f1-score': 0.329513068968325, 'support': 58197}, 'accuracy': 0.3687571357265389, 'macro avg': {'precision': 0.3672575609152479, 'recall': 0.3668925867433887, 'f1-score': 0.3506495044249108, 'support': 174299}, 'weighted avg': {'precision': 0.36751358053786287, 'recall': 0.3687571357265389, 'f1-score': 0.35162654476089145, 'support': 174299}}
[[35467 12405 11066]
 [31746 12620 12798]
 [28405 13605 16187]]
testing model on single stock: results/universal/W2/deepVOL_L3/h200/AAPL
Evaluating performance on  test set...
14883/14883 - 272s - 272s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0902413
{'0': {'precision': 0.3046789399960644, 'recall': 0.4788607255568132, 'f1-score': 0.37240942528531146, 'support': 1092871}, '1': {'precision': 0.4072906601401655, 'recall': 0.31245101458405994, 'f1-score': 0.35362237441694977, 'support': 1599966}, '2': {'precision': 0.34568515064653654, 'recall': 0.2676324143154095, 'f1-score': 0.30169216323116044, 'support': 1117062}, 'accuracy': 0.34704489541586275, 'macro avg': {'precision': 0.3525515835942555, 'recall': 0.3529813848187609, 'f1-score': 0.34257465431114054, 'support': 3809899}, 'weighted avg': {'precision': 0.3597937194465733, 'recall': 0.34704489541586275, 'f1-score': 0.3437855145689426, 'support': 3809899}}
[[523333 349315 220223]
 [754401 499911 345654]
 [439920 378180 298962]]
Evaluating performance on  train set...
6147/6147 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970179
{'0': {'precision': 0.3501839343001601, 'recall': 0.4705848328677113, 'f1-score': 0.4015534089198444, 'support': 518661}, '1': {'precision': 0.3241329308884223, 'recall': 0.3219107137356375, 'f1-score': 0.32301800039603773, 'support': 519408}, '2': {'precision': 0.3887785942049078, 'recall': 0.2618767463056763, 'f1-score': 0.3129523941316822, 'support': 535416}, 'accuracy': 0.35048951848921345, 'macro avg': {'precision': 0.3543651531311634, 'recall': 0.351457430969675, 'f1-score': 0.3458412678158547, 'support': 1573485}, 'weighted avg': {'precision': 0.35471724656400533, 'recall': 0.35048951848921345, 'f1-score': 0.3454802208027972, 'support': 1573485}}
[[244074 168450 106137]
 [237905 167203 114300]
 [215009 180194 140213]]
Evaluating performance on  val set...
2174/2174 - 39s - 39s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0943083
{'0': {'precision': 0.33746520891318477, 'recall': 0.45620349560936596, 'f1-score': 0.3879523208499285, 'support': 177537}, '1': {'precision': 0.3464779118102535, 'recall': 0.3465449950577278, 'f1-score': 0.3465114501872278, 'support': 196266}, '2': {'precision': 0.3837898099770375, 'recall': 0.252489039468859, 'f1-score': 0.30459199001640824, 'support': 182701}, 'accuracy': 0.35064977071144143, 'macro avg': {'precision': 0.35591097690015855, 'recall': 0.3517458433786509, 'f1-score': 0.34635192035118817, 'support': 556504}, 'weighted avg': {'precision': 0.35585220718411015, 'recall': 0.35064977071144143, 'f1-score': 0.3459697839317741, 'support': 556504}}
[[80993 62197 34347]
 [88532 68015 39719]
 [70479 66092 46130]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       128            32
 Used       :        76 (peak)  17.15 (ave)

============================================
