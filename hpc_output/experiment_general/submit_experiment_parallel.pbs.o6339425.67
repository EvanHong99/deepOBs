This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-09-04.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-27.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-14.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-15.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-23.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-19.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-21.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-16.csv
data/WBA_orderbooks/WBA_orderbooks_2019-09-06.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-20.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-22.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-13.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-29.csv
data/WBA_orderbooks/WBA_orderbooks_2019-08-28.csv
training model: results/WBA/W6/deepLOB_L1/h10
Epoch 1/50
1489/1489 - 33s - loss: 3.0498 - accuracy10: 0.4403 - val_loss: 3.2442 - val_accuracy10: 0.4839 - 33s/epoch - 22ms/step
Epoch 2/50
1489/1489 - 24s - loss: 2.9982 - accuracy10: 0.4383 - val_loss: 3.3127 - val_accuracy10: 0.5364 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 2.9167 - accuracy10: 0.4706 - val_loss: 3.4260 - val_accuracy10: 0.5494 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 25s - loss: 2.8470 - accuracy10: 0.5054 - val_loss: 3.5028 - val_accuracy10: 0.5970 - 25s/epoch - 17ms/step
Epoch 5/50
1489/1489 - 24s - loss: 2.8020 - accuracy10: 0.5210 - val_loss: 3.5737 - val_accuracy10: 0.5979 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 25s - loss: 2.7734 - accuracy10: 0.5297 - val_loss: 3.6118 - val_accuracy10: 0.6008 - 25s/epoch - 17ms/step
Epoch 7/50
1489/1489 - 24s - loss: 2.7553 - accuracy10: 0.5345 - val_loss: 3.5891 - val_accuracy10: 0.5992 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 2.7397 - accuracy10: 0.5382 - val_loss: 3.5844 - val_accuracy10: 0.5986 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 24s - loss: 2.7283 - accuracy10: 0.5411 - val_loss: 3.5922 - val_accuracy10: 0.6026 - 24s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 24s - loss: 2.7169 - accuracy10: 0.5439 - val_loss: 3.5692 - val_accuracy10: 0.5985 - 24s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 24s - loss: 2.7083 - accuracy10: 0.5458 - val_loss: 3.5092 - val_accuracy10: 0.5991 - 24s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h10
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0855433
{'0': {'precision': 0.24849467651318677, 'recall': 0.4327538703752296, 'f1-score': 0.31570572449627854, 'support': 304880}, '1': {'precision': 0.5389999845819393, 'recall': 0.5914069295499049, 'f1-score': 0.5639886344004996, 'support': 709339}, '2': {'precision': 0.31177842233976, 'recall': 0.01753561021172602, 'f1-score': 0.03320371649041198, 'support': 312621}, 'accuracy': 0.41974013445479486, 'macro avg': {'precision': 0.366424361144962, 'recall': 0.34723213671228687, 'f1-score': 0.3042993584623967, 'support': 1326840}, 'weighted avg': {'precision': 0.4187115622147258, 'recall': 0.41974013445479486, 'f1-score': 0.38187850402037204, 'support': 1326840}}
[[131938 170310   2632]
 [280362 419508   9469]
 [118649 188490   5482]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0099171
{'0': {'precision': 0.28725480207835363, 'recall': 0.45679320056828093, 'f1-score': 0.352708534807523, 'support': 80242}, '1': {'precision': 0.612193618962544, 'recall': 0.5802826339930541, 'f1-score': 0.5958111532113717, 'support': 220851}, '2': {'precision': 0.33890815147188796, 'recall': 0.18699827443919273, 'f1-score': 0.2410133681436894, 'support': 79974}, 'accuracy': 0.47174118986949803, 'macro avg': {'precision': 0.41278552417092856, 'recall': 0.40802470300017596, 'f1-score': 0.39651101872086136, 'support': 381067}, 'weighted avg': {'precision': 0.48641659675511345, 'recall': 0.47174118986949803, 'f1-score': 0.47015965788649594, 'support': 381067}}
[[ 36654  38534   5054]
 [ 68577 128156  24118]
 [ 22370  42649  14955]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9981109
{'0': {'precision': 0.2513960616366461, 'recall': 0.46537385356754235, 'f1-score': 0.3264454924624485, 'support': 25732}, '1': {'precision': 0.6389543823680164, 'recall': 0.6109960667066939, 'f1-score': 0.6246625451766665, 'support': 81611}, '2': {'precision': 0.323537722520486, 'recall': 0.09012554606635444, 'f1-score': 0.14097946871056113, 'support': 25409}, 'accuracy': 0.48307370133783295, 'macro avg': {'precision': 0.4046293888417161, 'recall': 0.38883182211353023, 'f1-score': 0.3640291687832254, 'support': 132752}, 'weighted avg': {'precision': 0.5034605847670347, 'recall': 0.48307370133783295, 'f1-score': 0.47427969226017913, 'support': 132752}}
[[11975 13107   650]
 [27609 49864  4138]
 [ 8050 15069  2290]]
training model: results/WBA/W6/deepLOB_L1/h20
Epoch 1/50
1489/1489 - 26s - loss: 3.0991 - accuracy20: 0.4495 - val_loss: 3.3990 - val_accuracy20: 0.4928 - 26s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.0480 - accuracy20: 0.4546 - val_loss: 3.4956 - val_accuracy20: 0.4973 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 2.9907 - accuracy20: 0.4808 - val_loss: 3.5486 - val_accuracy20: 0.5035 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 23s - loss: 2.9395 - accuracy20: 0.5009 - val_loss: 3.5813 - val_accuracy20: 0.5128 - 23s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 2.9106 - accuracy20: 0.5118 - val_loss: 3.6629 - val_accuracy20: 0.5159 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 2.8867 - accuracy20: 0.5188 - val_loss: 3.6700 - val_accuracy20: 0.5139 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 2.8706 - accuracy20: 0.5238 - val_loss: 3.6419 - val_accuracy20: 0.5189 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 2.8559 - accuracy20: 0.5279 - val_loss: 3.5841 - val_accuracy20: 0.5205 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 24s - loss: 2.8435 - accuracy20: 0.5310 - val_loss: 3.5702 - val_accuracy20: 0.5201 - 24s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 24s - loss: 2.8328 - accuracy20: 0.5334 - val_loss: 3.5082 - val_accuracy20: 0.5182 - 24s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 24s - loss: 2.8224 - accuracy20: 0.5362 - val_loss: 3.3789 - val_accuracy20: 0.5172 - 24s/epoch - 16ms/step
Epoch 12/50
1489/1489 - 24s - loss: 2.8144 - accuracy20: 0.5370 - val_loss: 3.4059 - val_accuracy20: 0.5198 - 24s/epoch - 16ms/step
Epoch 13/50
1489/1489 - 24s - loss: 2.8051 - accuracy20: 0.5399 - val_loss: 3.4614 - val_accuracy20: 0.5223 - 24s/epoch - 16ms/step
Epoch 14/50
1489/1489 - 24s - loss: 2.7976 - accuracy20: 0.5408 - val_loss: 3.4121 - val_accuracy20: 0.5228 - 24s/epoch - 16ms/step
Epoch 15/50
1489/1489 - 23s - loss: 2.7900 - accuracy20: 0.5427 - val_loss: 3.3321 - val_accuracy20: 0.5189 - 23s/epoch - 16ms/step
Epoch 16/50
1489/1489 - 24s - loss: 2.7846 - accuracy20: 0.5438 - val_loss: 3.3750 - val_accuracy20: 0.5226 - 24s/epoch - 16ms/step
Epoch 17/50
1489/1489 - 33s - loss: 2.7780 - accuracy20: 0.5446 - val_loss: 3.2941 - val_accuracy20: 0.5226 - 33s/epoch - 22ms/step
Epoch 18/50
1489/1489 - 24s - loss: 2.7731 - accuracy20: 0.5453 - val_loss: 3.2892 - val_accuracy20: 0.4977 - 24s/epoch - 16ms/step
Epoch 19/50
1489/1489 - 24s - loss: 2.7692 - accuracy20: 0.5465 - val_loss: 3.3190 - val_accuracy20: 0.5200 - 24s/epoch - 16ms/step
Epoch 20/50
1489/1489 - 24s - loss: 2.7641 - accuracy20: 0.5481 - val_loss: 3.3059 - val_accuracy20: 0.5236 - 24s/epoch - 16ms/step
Epoch 21/50
1489/1489 - 24s - loss: 2.7606 - accuracy20: 0.5480 - val_loss: 3.2958 - val_accuracy20: 0.5246 - 24s/epoch - 16ms/step
Epoch 22/50
1489/1489 - 24s - loss: 2.7557 - accuracy20: 0.5500 - val_loss: 3.3338 - val_accuracy20: 0.5207 - 24s/epoch - 16ms/step
Epoch 23/50
1489/1489 - 24s - loss: 2.7524 - accuracy20: 0.5500 - val_loss: 3.4666 - val_accuracy20: 0.5190 - 24s/epoch - 16ms/step
Epoch 24/50
1489/1489 - 24s - loss: 2.7481 - accuracy20: 0.5511 - val_loss: 3.3994 - val_accuracy20: 0.5195 - 24s/epoch - 16ms/step
Epoch 25/50
1489/1489 - 24s - loss: 2.7440 - accuracy20: 0.5518 - val_loss: 3.2362 - val_accuracy20: 0.5110 - 24s/epoch - 16ms/step
Epoch 26/50
1489/1489 - 24s - loss: 2.7416 - accuracy20: 0.5520 - val_loss: 3.2842 - val_accuracy20: 0.5042 - 24s/epoch - 16ms/step
Epoch 27/50
1489/1489 - 24s - loss: 2.7384 - accuracy20: 0.5532 - val_loss: 3.3160 - val_accuracy20: 0.4999 - 24s/epoch - 16ms/step
Epoch 28/50
1489/1489 - 24s - loss: 2.7360 - accuracy20: 0.5529 - val_loss: 3.2732 - val_accuracy20: 0.4819 - 24s/epoch - 16ms/step
Epoch 29/50
1489/1489 - 24s - loss: 2.7331 - accuracy20: 0.5535 - val_loss: 3.2757 - val_accuracy20: 0.4813 - 24s/epoch - 16ms/step
Epoch 30/50
1489/1489 - 24s - loss: 2.7282 - accuracy20: 0.5547 - val_loss: 3.3015 - val_accuracy20: 0.4875 - 24s/epoch - 16ms/step
Epoch 31/50
1489/1489 - 24s - loss: 2.7256 - accuracy20: 0.5554 - val_loss: 3.2652 - val_accuracy20: 0.4898 - 24s/epoch - 16ms/step
Epoch 32/50
1489/1489 - 24s - loss: 2.7216 - accuracy20: 0.5568 - val_loss: 3.3633 - val_accuracy20: 0.4790 - 24s/epoch - 16ms/step
Epoch 33/50
1489/1489 - 24s - loss: 2.7198 - accuracy20: 0.5569 - val_loss: 3.4013 - val_accuracy20: 0.4715 - 24s/epoch - 16ms/step
Epoch 34/50
1489/1489 - 24s - loss: 2.7162 - accuracy20: 0.5583 - val_loss: 3.3569 - val_accuracy20: 0.4733 - 24s/epoch - 16ms/step
Epoch 35/50
1489/1489 - 24s - loss: 2.7141 - accuracy20: 0.5582 - val_loss: 3.3266 - val_accuracy20: 0.4773 - 24s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h20
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1040503
{'0': {'precision': 0.3897046545325268, 'recall': 0.3805910280521325, 'f1-score': 0.38509392810710613, 'support': 380185}, '1': {'precision': 0.466807770503734, 'recall': 0.7471214007491037, 'f1-score': 0.5746003698376824, 'support': 561471}, '2': {'precision': 0.43097844229316373, 'recall': 0.06368384979646091, 'f1-score': 0.1109701176880396, 'support': 385184}, 'accuracy': 0.4436947936450514, 'macro avg': {'precision': 0.4291636224431415, 'recall': 0.397132092865899, 'f1-score': 0.356888138544276, 'support': 1326840}, 'weighted avg': {'precision': 0.4343137756716716, 'recall': 0.4436947936450514, 'f1-score': 0.3857076159311472, 'support': 1326840}}
[[144695 220269  15221]
 [124818 419487  17166]
 [101781 258873  24530]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0770386
{'0': {'precision': 0.42388369678089305, 'recall': 0.2806297325699021, 'f1-score': 0.3376922667832726, 'support': 101821}, '1': {'precision': 0.5237403157561622, 'recall': 0.754160243932626, 'f1-score': 0.6181766199151049, 'support': 177754}, '2': {'precision': 0.4676256499133449, 'recall': 0.2658534662830568, 'f1-score': 0.3389868837630032, 'support': 101492}, 'accuracy': 0.49757916586846934, 'macro avg': {'precision': 0.4717498874834667, 'recall': 0.4335478142618616, 'f1-score': 0.4316185901537935, 'support': 381067}, 'weighted avg': {'precision': 0.4821132778169019, 'recall': 0.49757916586846934, 'f1-score': 0.4688728963657411, 'support': 381067}}
[[ 28574  62199  11048]
 [ 24029 134055  19670]
 [ 14807  59703  26982]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0081708
{'0': {'precision': 0.38652200488997557, 'recall': 0.3841620849913429, 'f1-score': 0.38533843177282484, 'support': 32921}, '1': {'precision': 0.5744362672946718, 'recall': 0.7260712318980785, 'f1-score': 0.6414136765846667, 'support': 67189}, '2': {'precision': 0.43430197921493346, 'recall': 0.20099871331413516, 'f1-score': 0.27481203794843867, 'support': 32642}, 'accuracy': 0.512173074605279, 'macro avg': {'precision': 0.465086750466527, 'recall': 0.4370773434011855, 'f1-score': 0.43385471543531007, 'support': 132752}, 'weighted avg': {'precision': 0.4933784386809874, 'recall': 0.512173074605279, 'f1-score': 0.48776729971038685, 'support': 132752}}
[[12647 17499  2775]
 [12634 48784  5771]
 [ 7439 18642  6561]]
training model: results/WBA/W6/deepLOB_L1/h30
Epoch 1/50
1489/1489 - 26s - loss: 3.1198 - accuracy30: 0.4536 - val_loss: 3.3577 - val_accuracy30: 0.4029 - 26s/epoch - 18ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.0812 - accuracy30: 0.4643 - val_loss: 3.3839 - val_accuracy30: 0.4312 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.0105 - accuracy30: 0.4902 - val_loss: 3.5909 - val_accuracy30: 0.4357 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 2.9654 - accuracy30: 0.5028 - val_loss: 3.4614 - val_accuracy30: 0.4452 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 2.9450 - accuracy30: 0.5088 - val_loss: 3.3071 - val_accuracy30: 0.4636 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 2.9246 - accuracy30: 0.5148 - val_loss: 3.2849 - val_accuracy30: 0.4628 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 2.9102 - accuracy30: 0.5186 - val_loss: 3.2737 - val_accuracy30: 0.4611 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 2.8976 - accuracy30: 0.5211 - val_loss: 3.2686 - val_accuracy30: 0.4632 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 24s - loss: 2.8869 - accuracy30: 0.5240 - val_loss: 3.3114 - val_accuracy30: 0.4615 - 24s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 25s - loss: 2.8779 - accuracy30: 0.5252 - val_loss: 3.3014 - val_accuracy30: 0.4586 - 25s/epoch - 17ms/step
Epoch 11/50
1489/1489 - 25s - loss: 2.8701 - accuracy30: 0.5268 - val_loss: 3.3182 - val_accuracy30: 0.4518 - 25s/epoch - 17ms/step
Epoch 12/50
1489/1489 - 25s - loss: 2.8634 - accuracy30: 0.5290 - val_loss: 3.2859 - val_accuracy30: 0.4603 - 25s/epoch - 17ms/step
Epoch 13/50
1489/1489 - 25s - loss: 2.8587 - accuracy30: 0.5300 - val_loss: 3.3526 - val_accuracy30: 0.4614 - 25s/epoch - 17ms/step
Epoch 14/50
1489/1489 - 24s - loss: 2.8524 - accuracy30: 0.5305 - val_loss: 3.3585 - val_accuracy30: 0.4637 - 24s/epoch - 16ms/step
Epoch 15/50
1489/1489 - 25s - loss: 2.8465 - accuracy30: 0.5324 - val_loss: 3.3352 - val_accuracy30: 0.4608 - 25s/epoch - 17ms/step
Epoch 16/50
1489/1489 - 25s - loss: 2.8418 - accuracy30: 0.5335 - val_loss: 3.3835 - val_accuracy30: 0.4610 - 25s/epoch - 17ms/step
Epoch 17/50
1489/1489 - 26s - loss: 2.8358 - accuracy30: 0.5351 - val_loss: 3.3412 - val_accuracy30: 0.4545 - 26s/epoch - 17ms/step
Epoch 18/50
1489/1489 - 25s - loss: 2.8320 - accuracy30: 0.5360 - val_loss: 3.4403 - val_accuracy30: 0.4631 - 25s/epoch - 17ms/step
testing model: results/WBA/W6/deepLOB_L1/h30
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1242541
{'0': {'precision': 0.42429490025096583, 'recall': 0.2261034535255472, 'f1-score': 0.2950024141450565, 'support': 426955}, '1': {'precision': 0.38164419681014045, 'recall': 0.8101077873008673, 'f1-score': 0.5188544931095012, 'support': 467402}, '2': {'precision': 0.4389363191042687, 'recall': 0.10877421771491597, 'f1-score': 0.1743437510423268, 'support': 432483}, 'accuracy': 0.3935855114407163, 'macro avg': {'precision': 0.414958472055125, 'recall': 0.38166181951377687, 'f1-score': 0.3294002194322948, 'support': 1326840}, 'weighted avg': {'precision': 0.41404282815507204, 'recall': 0.3935855114407163, 'f1-score': 0.3345294775569837, 'support': 1326840}}
[[ 96536 306245  24174]
 [ 52798 378646  35958]
 [ 78187 307253  47043]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1015915
{'0': {'precision': 0.45656725261702547, 'recall': 0.1988661292681458, 'f1-score': 0.2770556544355153, 'support': 116239}, '1': {'precision': 0.4317201098406149, 'recall': 0.7976216840141465, 'f1-score': 0.5602173825947809, 'support': 149013}, '2': {'precision': 0.4811805039090134, 'recall': 0.2290463238785995, 'f1-score': 0.3103589479595657, 'support': 115815}, 'accuracy': 0.4421768350447559, 'macro avg': {'precision': 0.45648928878888456, 'recall': 0.4085113790536306, 'f1-score': 0.3825439949966207, 'support': 381067}, 'weighted avg': {'precision': 0.45433152087389456, 'recall': 0.4421768350447559, 'f1-score': 0.397905267594578, 'support': 381067}}
[[ 23116  81118  12005]
 [ 13560 118856  16597]
 [ 13954  75334  26527]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0567299
{'0': {'precision': 0.44957812341160924, 'recall': 0.23300842992623816, 'f1-score': 0.30693687753756466, 'support': 37960}, '1': {'precision': 0.4696598501720996, 'recall': 0.813042182927043, 'f1-score': 0.595388889958355, 'support': 57061}, '2': {'precision': 0.44369841935935095, 'recall': 0.1681376056823302, 'f1-score': 0.2438639989236772, 'support': 37731}, 'accuracy': 0.4638875497167651, 'macro avg': {'precision': 0.4543121309810199, 'recall': 0.40472940617853714, 'f1-score': 0.382063255473199, 'support': 132752}, 'weighted avg': {'precision': 0.4565387439452704, 'recall': 0.4638875497167651, 'f1-score': 0.41299597644200403, 'support': 132752}}
[[ 8845 26342  2773]
 [ 5487 46393  5181]
 [ 5342 26045  6344]]
training model: results/WBA/W6/deepLOB_L1/h50
Epoch 1/50
1489/1489 - 27s - loss: 3.1845 - accuracy50: 0.4278 - val_loss: 3.4702 - val_accuracy50: 0.3712 - 27s/epoch - 18ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.1507 - accuracy50: 0.4445 - val_loss: 3.3273 - val_accuracy50: 0.3741 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.0945 - accuracy50: 0.4639 - val_loss: 3.3072 - val_accuracy50: 0.3790 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 3.0606 - accuracy50: 0.4742 - val_loss: 3.3525 - val_accuracy50: 0.3935 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.0440 - accuracy50: 0.4783 - val_loss: 3.3668 - val_accuracy50: 0.3906 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.0304 - accuracy50: 0.4816 - val_loss: 3.3280 - val_accuracy50: 0.4079 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 3.0204 - accuracy50: 0.4846 - val_loss: 3.3783 - val_accuracy50: 0.4024 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 3.0111 - accuracy50: 0.4879 - val_loss: 3.3927 - val_accuracy50: 0.4038 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 24s - loss: 3.0037 - accuracy50: 0.4892 - val_loss: 3.4603 - val_accuracy50: 0.3957 - 24s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 24s - loss: 2.9975 - accuracy50: 0.4914 - val_loss: 3.4332 - val_accuracy50: 0.3994 - 24s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 24s - loss: 2.9921 - accuracy50: 0.4923 - val_loss: 3.5068 - val_accuracy50: 0.3988 - 24s/epoch - 16ms/step
Epoch 12/50
1489/1489 - 24s - loss: 2.9866 - accuracy50: 0.4938 - val_loss: 3.4988 - val_accuracy50: 0.3989 - 24s/epoch - 16ms/step
Epoch 13/50
1489/1489 - 25s - loss: 2.9826 - accuracy50: 0.4951 - val_loss: 3.5531 - val_accuracy50: 0.3974 - 25s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h50
Evaluating performance on  test set...
5183/5183 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1485164
{'0': {'precision': 0.465158908424341, 'recall': 0.03947322297101894, 'f1-score': 0.07277111450837997, 'support': 456436}, '1': {'precision': 0.3050665606018198, 'recall': 0.9130901261270972, 'f1-score': 0.4573356897872751, 'support': 408239}, '2': {'precision': 0.49654901605424917, 'recall': 0.07113909534473618, 'f1-score': 0.12444878477150828, 'support': 462165}, 'accuracy': 0.31929546893370714, 'macro avg': {'precision': 0.42225816169346997, 'recall': 0.3412341481476175, 'f1-score': 0.21818519635572117, 'support': 1326840}, 'weighted avg': {'precision': 0.4268358770943074, 'recall': 0.31929546893370714, 'f1-score': 0.20909340515716926, 'support': 1326840}}
[[ 18017 427108  11311]
 [ 13456 372759  22024]
 [  7260 422027  32878]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1241533
{'0': {'precision': 0.5173360361501753, 'recall': 0.09537230232630563, 'f1-score': 0.16105388402805626, 'support': 128444}, '1': {'precision': 0.34322964923891464, 'recall': 0.8275080777055327, 'f1-score': 0.4852074050684724, 'support': 125345}, '2': {'precision': 0.46028122055519316, 'recall': 0.1995788745894813, 'f1-score': 0.2784299540736356, 'support': 127278}, 'accuracy': 0.371000375262093, 'macro avg': {'precision': 0.4402823019814277, 'recall': 0.37415308487377325, 'f1-score': 0.3082304143900548, 'support': 381067}, 'weighted avg': {'precision': 0.44101038242867724, 'recall': 0.371000375262093, 'f1-score': 0.30688234605198433, 'support': 381067}}
[[ 12250 101690  14504]
 [  6339 103724  15282]
 [  5090  96786  25402]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1045073
{'0': {'precision': 0.4797031202665859, 'recall': 0.07468282790171202, 'f1-score': 0.12924420502775058, 'support': 42406}, '1': {'precision': 0.3652566213805407, 'recall': 0.8814969675643228, 'f1-score': 0.5164975773636623, 'support': 48311}, '2': {'precision': 0.48451558903536307, 'recall': 0.11017009634828119, 'f1-score': 0.1795204775841684, 'support': 42035}, 'accuracy': 0.3795347716041943, 'macro avg': {'precision': 0.44315844356082995, 'recall': 0.3554499639381053, 'f1-score': 0.2750874199918604, 'support': 132752}, 'weighted avg': {'precision': 0.4395776782168377, 'recall': 0.3795347716041943, 'f1-score': 0.2860927706827257, 'support': 132752}}
[[ 3167 37735  1504]
 [ 2302 42586  3423]
 [ 1133 36271  4631]]
training model: results/WBA/W6/deepLOB_L1/h100
Epoch 1/50
1489/1489 - 26s - loss: 3.2404 - accuracy100: 0.4067 - val_loss: 3.3140 - val_accuracy100: 0.3545 - 26s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.2148 - accuracy100: 0.4156 - val_loss: 3.4961 - val_accuracy100: 0.3501 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.1966 - accuracy100: 0.4232 - val_loss: 3.4515 - val_accuracy100: 0.3537 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 3.1821 - accuracy100: 0.4310 - val_loss: 3.5000 - val_accuracy100: 0.3542 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.1727 - accuracy100: 0.4340 - val_loss: 3.5264 - val_accuracy100: 0.3615 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.1668 - accuracy100: 0.4364 - val_loss: 3.5604 - val_accuracy100: 0.3548 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 3.1603 - accuracy100: 0.4387 - val_loss: 3.6008 - val_accuracy100: 0.3522 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 25s - loss: 3.1564 - accuracy100: 0.4405 - val_loss: 3.6314 - val_accuracy100: 0.3545 - 25s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 25s - loss: 3.1519 - accuracy100: 0.4414 - val_loss: 3.6279 - val_accuracy100: 0.3595 - 25s/epoch - 17ms/step
Epoch 10/50
1489/1489 - 25s - loss: 3.1503 - accuracy100: 0.4421 - val_loss: 3.5713 - val_accuracy100: 0.3528 - 25s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 25s - loss: 3.1469 - accuracy100: 0.4430 - val_loss: 3.5594 - val_accuracy100: 0.3523 - 25s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h100
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1097187
{'0': {'precision': 0.29835112581539575, 'recall': 0.16481028393283478, 'f1-score': 0.2123291479920371, 'support': 405448}, '1': {'precision': 0.36795734802885516, 'recall': 0.6004145006619095, 'f1-score': 0.45628531577062664, 'support': 495536}, '2': {'precision': 0.3495402306662408, 'recall': 0.24154174180943794, 'f1-score': 0.2856746105585905, 'support': 425856}, 'accuracy': 0.35212308944560006, 'macro avg': {'precision': 0.3386162348368305, 'recall': 0.33558884213472745, 'f1-score': 0.31809635810708475, 'support': 1326840}, 'weighted avg': {'precision': 0.34077641926911306, 'recall': 0.35212308944560006, 'f1-score': 0.32698025050859775, 'support': 1326840}}
[[ 66822 256237  82389]
 [ 88982 297527 109027]
 [ 68167 254827 102862]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.110445
{'0': {'precision': 0.36948315911730545, 'recall': 0.05901266820735977, 'f1-score': 0.10177082569663363, 'support': 129379}, '1': {'precision': 0.3327284419673876, 'recall': 0.71883009557573, 'f1-score': 0.4548966304795446, 'support': 125241}, '2': {'precision': 0.38281884872705413, 'recall': 0.27196374765712117, 'f1-score': 0.31800737939133894, 'support': 126447}, 'accuracy': 0.3465296129027179, 'macro avg': {'precision': 0.3616768166039157, 'recall': 0.3499355038134036, 'f1-score': 0.2915582785225057, 'support': 381067}, 'weighted avg': {'precision': 0.36182849579959764, 'recall': 0.3465296129027179, 'f1-score': 0.2895810858919561, 'support': 381067}}
[[ 7635 93433 28311]
 [ 8083 90027 27131]
 [ 4946 87112 34389]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1051116
{'0': {'precision': 0.3339483394833948, 'recall': 0.1385171957978711, 'f1-score': 0.19581359516121102, 'support': 43121}, '1': {'precision': 0.3505848611621375, 'recall': 0.6325400389163299, 'f1-score': 0.45113080078690926, 'support': 46767}, '2': {'precision': 0.3764883392921573, 'recall': 0.2677771556550952, 'f1-score': 0.3129609684939537, 'support': 42864}, 'accuracy': 0.35429221405327227, 'macro avg': {'precision': 0.35367384664589646, 'recall': 0.34627813012309877, 'f1-score': 0.31996845481402464, 'support': 132752}, 'weighted avg': {'precision': 0.35354484093838273, 'recall': 0.35429221405327227, 'f1-score': 0.3235843614474569, 'support': 132752}}
[[ 5973 28457  8691]
 [ 6867 29582 10318]
 [ 5046 26340 11478]]
training model: results/WBA/W6/deepLOB_L1/h200
Epoch 1/50
1489/1489 - 27s - loss: 3.2829 - accuracy200: 0.3766 - val_loss: 3.3363 - val_accuracy200: 0.3510 - 27s/epoch - 18ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.2622 - accuracy200: 0.3836 - val_loss: 3.3510 - val_accuracy200: 0.3423 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.2509 - accuracy200: 0.3920 - val_loss: 3.3654 - val_accuracy200: 0.3368 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 3.2423 - accuracy200: 0.3989 - val_loss: 3.3587 - val_accuracy200: 0.3463 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.2370 - accuracy200: 0.4013 - val_loss: 3.3851 - val_accuracy200: 0.3511 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.2329 - accuracy200: 0.4035 - val_loss: 3.4022 - val_accuracy200: 0.3517 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 3.2297 - accuracy200: 0.4057 - val_loss: 3.4298 - val_accuracy200: 0.3484 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 25s - loss: 3.2267 - accuracy200: 0.4070 - val_loss: 3.4162 - val_accuracy200: 0.3511 - 25s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 25s - loss: 3.2229 - accuracy200: 0.4086 - val_loss: 3.4476 - val_accuracy200: 0.3484 - 25s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 25s - loss: 3.2197 - accuracy200: 0.4100 - val_loss: 3.4457 - val_accuracy200: 0.3490 - 25s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 24s - loss: 3.2185 - accuracy200: 0.4106 - val_loss: 3.4470 - val_accuracy200: 0.3473 - 24s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h200
Evaluating performance on  test set...
5183/5183 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1293002
{'0': {'precision': 0.3727571714847664, 'recall': 0.3583844546575596, 'f1-score': 0.36542954427890106, 'support': 448443}, '1': {'precision': 0.30342280604532695, 'recall': 0.5937476135443767, 'f1-score': 0.40161058155872065, 'support': 392842}, '2': {'precision': 0.39869409744648004, 'recall': 0.10424977602949202, 'f1-score': 0.16528194319504602, 'support': 485555}, 'accuracy': 0.3350690362063248, 'macro avg': {'precision': 0.3582913583255245, 'recall': 0.3521272814104761, 'f1-score': 0.31077402301088924, 'support': 1326840}, 'weighted avg': {'precision': 0.3617206887870633, 'recall': 0.3350690362063248, 'f1-score': 0.30289808803911905, 'support': 1326840}}
[[160715 250052  37676]
 [120926 233249  38667]
 [149511 285425  50619]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1098946
{'0': {'precision': 0.35826211636719507, 'recall': 0.2427707777486467, 'f1-score': 0.2894203411488378, 'support': 129682}, '1': {'precision': 0.3363371221672955, 'recall': 0.5639579410919999, 'f1-score': 0.42137294465125014, 'support': 125348}, '2': {'precision': 0.3663369914830565, 'recall': 0.24127835476883772, 'f1-score': 0.29093796640006125, 'support': 126037}, 'accuracy': 0.3479283170676023, 'macro avg': {'precision': 0.35364541000584904, 'recall': 0.3493356912031615, 'f1-score': 0.33391041740004973, 'support': 381067}, 'weighted avg': {'precision': 0.35372086472905484, 'recall': 0.3479283170676023, 'f1-score': 0.33332671949597575, 'support': 381067}}
[[31483 71245 26954]
 [29010 70691 25647]
 [27384 68243 30410]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1136196
{'0': {'precision': 0.36962597144060333, 'recall': 0.2175823680533646, 'f1-score': 0.27392013617987093, 'support': 44374}, '1': {'precision': 0.33978767763425916, 'recall': 0.6421212327061114, 'f1-score': 0.44440961910657334, 'support': 44163}, '2': {'precision': 0.3609804513873905, 'recall': 0.1891891891891892, 'f1-score': 0.24826378583724107, 'support': 44215}, 'accuracy': 0.3493582017596722, 'macro avg': {'precision': 0.3567980334874177, 'recall': 0.3496309299828884, 'f1-score': 0.32219784704122845, 'support': 132752}, 'weighted avg': {'precision': 0.3568200608816484, 'recall': 0.3493582017596722, 'f1-score': 0.32209215245150963, 'support': 132752}}
[[ 9655 27594  7125]
 [ 8122 28358  7683]
 [ 8344 27506  8365]]
training model: results/WBA/W6/deepLOB_L1/h300
Epoch 1/50
1489/1489 - 26s - loss: 3.2735 - accuracy300: 0.3844 - val_loss: 3.3532 - val_accuracy300: 0.3368 - 26s/epoch - 18ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.2490 - accuracy300: 0.3971 - val_loss: 3.4169 - val_accuracy300: 0.3306 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.2453 - accuracy300: 0.4011 - val_loss: 3.4448 - val_accuracy300: 0.3503 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 3.2462 - accuracy300: 0.3990 - val_loss: 3.4712 - val_accuracy300: 0.3431 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.2305 - accuracy300: 0.4079 - val_loss: 3.4955 - val_accuracy300: 0.3401 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.2257 - accuracy300: 0.4111 - val_loss: 3.4889 - val_accuracy300: 0.3495 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 25s - loss: 3.2167 - accuracy300: 0.4163 - val_loss: 3.5031 - val_accuracy300: 0.3480 - 25s/epoch - 17ms/step
Epoch 8/50
1489/1489 - 25s - loss: 3.2080 - accuracy300: 0.4206 - val_loss: 3.5010 - val_accuracy300: 0.3402 - 25s/epoch - 17ms/step
Epoch 9/50
1489/1489 - 25s - loss: 3.2056 - accuracy300: 0.4215 - val_loss: 3.4555 - val_accuracy300: 0.3413 - 25s/epoch - 17ms/step
Epoch 10/50
1489/1489 - 25s - loss: 3.1996 - accuracy300: 0.4236 - val_loss: 3.4595 - val_accuracy300: 0.3471 - 25s/epoch - 17ms/step
Epoch 11/50
1489/1489 - 25s - loss: 3.1991 - accuracy300: 0.4229 - val_loss: 3.4855 - val_accuracy300: 0.3493 - 25s/epoch - 17ms/step
testing model: results/WBA/W6/deepLOB_L1/h300
Evaluating performance on  test set...
5183/5183 - 34s - 34s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1133616
{'0': {'precision': 0.2695251253941769, 'recall': 0.29274046293967787, 'f1-score': 0.2806535260874522, 'support': 365836}, '1': {'precision': 0.43549383874759223, 'recall': 0.5363576061189684, 'f1-score': 0.4806916408140756, 'support': 562317}, '2': {'precision': 0.31375164071765305, 'recall': 0.18646206171758797, 'f1-score': 0.23391113642299088, 'support': 398687}, 'accuracy': 0.36405143046637123, 'macro avg': {'precision': 0.33959020161980735, 'recall': 0.3385200435920781, 'f1-score': 0.33175210110817294, 'support': 1326840}, 'weighted avg': {'precision': 0.35315206285575723, 'recall': 0.36405143046637123, 'f1-score': 0.3513849250885191, 'support': 1326840}}
[[107095 190993  67748]
 [165863 301603  94851]
 [124389 199958  74340]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1190197
{'0': {'precision': 0.3453429726490999, 'recall': 0.20191404505628185, 'f1-score': 0.2548330831159114, 'support': 129882}, '1': {'precision': 0.33210938067672635, 'recall': 0.5445685327571964, 'f1-score': 0.412594672179243, 'support': 125896}, '2': {'precision': 0.3403787502659763, 'recall': 0.2681240970875336, 'f1-score': 0.2999616040574689, 'support': 125289}, 'accuracy': 0.3368882637436461, 'macro avg': {'precision': 0.3392770345306009, 'recall': 0.338202224967004, 'f1-score': 0.3224631197842078, 'support': 381067}, 'weighted avg': {'precision': 0.33933872994870046, 'recall': 0.3368882637436461, 'f1-score': 0.32179154521565767, 'support': 381067}}
[[26225 70134 33523]
 [25760 68559 31577]
 [23954 67742 33593]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.11568
{'0': {'precision': 0.3117729679115497, 'recall': 0.20333529066353495, 'f1-score': 0.2461402860311052, 'support': 42575}, '1': {'precision': 0.34754501893962025, 'recall': 0.6153732227488151, 'f1-score': 0.4442119571442753, 'support': 47264}, '2': {'precision': 0.33552446239083483, 'recall': 0.16652296506886025, 'f1-score': 0.22257868589494012, 'support': 42913}, 'accuracy': 0.3381342653971315, 'macro avg': {'precision': 0.3316141497473349, 'recall': 0.3284104928270701, 'f1-score': 0.30431030969010686, 'support': 132752}, 'weighted avg': {'precision': 0.3321868080222847, 'recall': 0.3381342653971315, 'f1-score': 0.3090437490060481, 'support': 132752}}
[[ 8657 27331  6587]
 [10614 29085  7565]
 [ 8496 27271  7146]]
training model: results/WBA/W6/deepLOB_L1/h500
Epoch 1/50
1489/1489 - 26s - loss: 3.2391 - accuracy500: 0.4130 - val_loss: 3.3793 - val_accuracy500: 0.3419 - 26s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.2121 - accuracy500: 0.4254 - val_loss: 3.3460 - val_accuracy500: 0.3378 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 23s - loss: 3.2058 - accuracy500: 0.4283 - val_loss: 3.4074 - val_accuracy500: 0.3415 - 23s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 24s - loss: 3.1896 - accuracy500: 0.4356 - val_loss: 3.3977 - val_accuracy500: 0.3345 - 24s/epoch - 16ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.1751 - accuracy500: 0.4422 - val_loss: 3.4292 - val_accuracy500: 0.3293 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.1722 - accuracy500: 0.4454 - val_loss: 3.3422 - val_accuracy500: 0.3253 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 24s - loss: 3.1683 - accuracy500: 0.4452 - val_loss: 3.3739 - val_accuracy500: 0.3184 - 24s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 3.1583 - accuracy500: 0.4500 - val_loss: 3.4151 - val_accuracy500: 0.3294 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 24s - loss: 3.1535 - accuracy500: 0.4506 - val_loss: 3.3983 - val_accuracy500: 0.3356 - 24s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 25s - loss: 3.1511 - accuracy500: 0.4517 - val_loss: 3.4546 - val_accuracy500: 0.3338 - 25s/epoch - 17ms/step
Epoch 11/50
1489/1489 - 24s - loss: 3.1476 - accuracy500: 0.4533 - val_loss: 3.4541 - val_accuracy500: 0.3233 - 24s/epoch - 16ms/step
Epoch 12/50
1489/1489 - 24s - loss: 3.1412 - accuracy500: 0.4562 - val_loss: 3.3873 - val_accuracy500: 0.3428 - 24s/epoch - 16ms/step
Epoch 13/50
1489/1489 - 24s - loss: 3.1421 - accuracy500: 0.4567 - val_loss: 3.4182 - val_accuracy500: 0.3368 - 24s/epoch - 16ms/step
Epoch 14/50
1489/1489 - 24s - loss: 3.1440 - accuracy500: 0.4553 - val_loss: 3.4109 - val_accuracy500: 0.3333 - 24s/epoch - 16ms/step
Epoch 15/50
1489/1489 - 24s - loss: 3.1337 - accuracy500: 0.4601 - val_loss: 3.3863 - val_accuracy500: 0.3402 - 24s/epoch - 16ms/step
Epoch 16/50
1489/1489 - 25s - loss: 3.1274 - accuracy500: 0.4629 - val_loss: 3.4364 - val_accuracy500: 0.3520 - 25s/epoch - 17ms/step
testing model: results/WBA/W6/deepLOB_L1/h500
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108473
{'0': {'precision': 0.31833290918700935, 'recall': 0.19453855503555467, 'f1-score': 0.24149530045458392, 'support': 417948}, '1': {'precision': 0.3384538240089903, 'recall': 0.42599000040284857, 'f1-score': 0.37721004479790404, 'support': 446818}, '2': {'precision': 0.35091858464101333, 'recall': 0.3865895938745742, 'f1-score': 0.36789144058703477, 'support': 462074}, 'accuracy': 0.33936269633113264, 'macro avg': {'precision': 0.33590177261233767, 'recall': 0.3357060497709925, 'f1-score': 0.32886559527984094, 'support': 1326840}, 'weighted avg': {'precision': 0.33645670732292726, 'recall': 0.33936269633113264, 'f1-score': 0.3312153576533085, 'support': 1326840}}
[[ 81307 177683 158958]
 [ 85025 190340 171453]
 [ 89083 194358 178633]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1129333
{'0': {'precision': 0.33323871700255464, 'recall': 0.1810610734114744, 'f1-score': 0.23463575497151992, 'support': 129680}, '1': {'precision': 0.3609108545191159, 'recall': 0.33264882253732275, 'f1-score': 0.3462040103203786, 'support': 128072}, '2': {'precision': 0.342774350345859, 'recall': 0.5352633499574261, 'f1-score': 0.41791951981613207, 'support': 123315}, 'accuracy': 0.34662933289946385, 'macro avg': {'precision': 0.3456413072891766, 'recall': 0.3496577486354077, 'f1-score': 0.33291976170267684, 'support': 381067}, 'weighted avg': {'precision': 0.3456247609836671, 'recall': 0.34662933289946385, 'f1-score': 0.33144394634167884, 'support': 381067}}
[[23480 38600 67600]
 [26511 42603 58958]
 [20469 36840 66006]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1133358
{'0': {'precision': 0.2841055824149425, 'recall': 0.22248612548208072, 'f1-score': 0.24954830201121, 'support': 42524}, '1': {'precision': 0.35638367099041257, 'recall': 0.3423772609819121, 'f1-score': 0.34924008927622485, 'support': 47988}, '2': {'precision': 0.329715646028979, 'recall': 0.41642992424242425, 'f1-score': 0.36803397880509264, 'support': 42240}, 'accuracy': 0.3275355550198867, 'macro avg': {'precision': 0.323401633144778, 'recall': 0.3270977702354723, 'f1-score': 0.3222741233641759, 'support': 132752}, 'weighted avg': {'precision': 0.3247456481135124, 'recall': 0.3275355550198867, 'f1-score': 0.3232861325150603, 'support': 132752}}
[[ 9461 15108 17955]
 [13754 16430 17804]
 [10086 14564 17590]]
training model: results/WBA/W6/deepLOB_L1/h1000
Epoch 1/50
1489/1489 - 26s - loss: 3.2684 - accuracy1000: 0.3953 - val_loss: 3.4990 - val_accuracy1000: 0.3309 - 26s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 24s - loss: 3.2040 - accuracy1000: 0.4257 - val_loss: 3.4914 - val_accuracy1000: 0.3233 - 24s/epoch - 16ms/step
Epoch 3/50
1489/1489 - 24s - loss: 3.1871 - accuracy1000: 0.4288 - val_loss: 3.5721 - val_accuracy1000: 0.3299 - 24s/epoch - 16ms/step
Epoch 4/50
1489/1489 - 25s - loss: 3.1670 - accuracy1000: 0.4382 - val_loss: 3.5260 - val_accuracy1000: 0.3249 - 25s/epoch - 17ms/step
Epoch 5/50
1489/1489 - 24s - loss: 3.1517 - accuracy1000: 0.4461 - val_loss: 3.5423 - val_accuracy1000: 0.3272 - 24s/epoch - 16ms/step
Epoch 6/50
1489/1489 - 24s - loss: 3.1425 - accuracy1000: 0.4499 - val_loss: 3.4900 - val_accuracy1000: 0.3305 - 24s/epoch - 16ms/step
Epoch 7/50
1489/1489 - 25s - loss: 3.1304 - accuracy1000: 0.4551 - val_loss: 3.4911 - val_accuracy1000: 0.3295 - 25s/epoch - 16ms/step
Epoch 8/50
1489/1489 - 24s - loss: 3.1199 - accuracy1000: 0.4577 - val_loss: 3.4718 - val_accuracy1000: 0.3290 - 24s/epoch - 16ms/step
Epoch 9/50
1489/1489 - 25s - loss: 3.1140 - accuracy1000: 0.4608 - val_loss: 3.4850 - val_accuracy1000: 0.3284 - 25s/epoch - 16ms/step
Epoch 10/50
1489/1489 - 24s - loss: 3.1046 - accuracy1000: 0.4634 - val_loss: 3.4792 - val_accuracy1000: 0.3278 - 24s/epoch - 16ms/step
Epoch 11/50
1489/1489 - 25s - loss: 3.0974 - accuracy1000: 0.4671 - val_loss: 3.4666 - val_accuracy1000: 0.3268 - 25s/epoch - 16ms/step
Epoch 12/50
1489/1489 - 24s - loss: 3.0919 - accuracy1000: 0.4681 - val_loss: 3.4947 - val_accuracy1000: 0.3289 - 24s/epoch - 16ms/step
Epoch 13/50
1489/1489 - 24s - loss: 3.0867 - accuracy1000: 0.4703 - val_loss: 3.5146 - val_accuracy1000: 0.3282 - 24s/epoch - 16ms/step
Epoch 14/50
1489/1489 - 24s - loss: 3.0857 - accuracy1000: 0.4714 - val_loss: 3.5086 - val_accuracy1000: 0.3274 - 24s/epoch - 16ms/step
Epoch 15/50
1489/1489 - 24s - loss: 3.0738 - accuracy1000: 0.4743 - val_loss: 3.5682 - val_accuracy1000: 0.3297 - 24s/epoch - 16ms/step
Epoch 16/50
1489/1489 - 24s - loss: 3.0707 - accuracy1000: 0.4757 - val_loss: 3.6147 - val_accuracy1000: 0.3292 - 24s/epoch - 16ms/step
Epoch 17/50
1489/1489 - 25s - loss: 3.0668 - accuracy1000: 0.4769 - val_loss: 3.6610 - val_accuracy1000: 0.3306 - 25s/epoch - 16ms/step
Epoch 18/50
1489/1489 - 24s - loss: 3.0632 - accuracy1000: 0.4783 - val_loss: 3.6403 - val_accuracy1000: 0.3307 - 24s/epoch - 16ms/step
Epoch 19/50
1489/1489 - 24s - loss: 3.0602 - accuracy1000: 0.4793 - val_loss: 3.7888 - val_accuracy1000: 0.3310 - 24s/epoch - 16ms/step
Epoch 20/50
1489/1489 - 24s - loss: 3.0570 - accuracy1000: 0.4802 - val_loss: 3.6609 - val_accuracy1000: 0.3288 - 24s/epoch - 16ms/step
Epoch 21/50
1489/1489 - 24s - loss: 3.0528 - accuracy1000: 0.4809 - val_loss: 3.7553 - val_accuracy1000: 0.3284 - 24s/epoch - 16ms/step
testing model: results/WBA/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
5183/5183 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1516937
{'0': {'precision': 0.3388638920134983, 'recall': 0.18303595997842623, 'f1-score': 0.23768651223022816, 'support': 454255}, '1': {'precision': 0.2681937502919333, 'recall': 0.8069846017191655, 'f1-score': 0.40259037276574744, 'support': 355754}, '2': {'precision': 0.38599673499002357, 'recall': 0.00823480015711132, 'f1-score': 0.016125579465650734, 'support': 516831}, 'accuracy': 0.28224126496035695, 'macro avg': {'precision': 0.3310181257651517, 'recall': 0.332751787284901, 'f1-score': 0.21880082148720878, 'support': 1326840}, 'weighted avg': {'precision': 0.338274920299039, 'recall': 0.28224126496035695, 'f1-score': 0.19559827970731944, 'support': 1326840}}
[[ 83145 367299   3811]
 [ 65707 287088   2959]
 [ 96512 416063   4256]]
Evaluating performance on  train set...
1489/1489 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2099398
{'0': {'precision': 0.3544271791099669, 'recall': 0.11586438028825201, 'f1-score': 0.174638411616133, 'support': 133078}, '1': {'precision': 0.3417379962044662, 'recall': 0.5009272631786253, 'f1-score': 0.40629627780828304, 'support': 121864}, '2': {'precision': 0.3403405229909647, 'recall': 0.42886818632309215, 'f1-score': 0.37951006289970074, 'support': 126125}, 'accuracy': 0.34260379408345515, 'macro avg': {'precision': 0.3455018994351326, 'recall': 0.3485532765966565, 'f1-score': 0.3201482507747056, 'support': 381067}, 'weighted avg': {'precision': 0.34570683835990174, 'recall': 0.34260379408345515, 'f1-score': 0.3165299719553389, 'support': 381067}}
[[15419 59494 58165]
 [14143 61045 46676]
 [13942 58092 54091]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1577243
{'0': {'precision': 0.3269893807750655, 'recall': 0.16111350200457542, 'f1-score': 0.21586598282297956, 'support': 44149}, '1': {'precision': 0.3297217059971715, 'recall': 0.6326672497701227, 'f1-score': 0.4335131314062668, 'support': 44589}, '2': {'precision': 0.32469931609150227, 'recall': 0.1876902803653383, 'f1-score': 0.23787721723105276, 'support': 44014}, 'accuracy': 0.3283114378691093, 'macro avg': {'precision': 0.32713680095457975, 'recall': 0.32715701071334546, 'f1-score': 0.29575211048676636, 'support': 132752}, 'weighted avg': {'precision': 0.32714784725652063, 'recall': 0.3283114378691093, 'f1-score': 0.29626756757814054, 'support': 132752}}
[[ 7113 28832  8204]
 [ 7402 28210  8977]
 [ 7238 28515  8261]]
training model: results/WBA/W6/deepOF_L1/h10
Epoch 1/50
1489/1489 - 24s - loss: 3.2111 - accuracy10: 0.4059 - val_loss: 3.0839 - val_accuracy10: 0.5431 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 22s - loss: 3.1687 - accuracy10: 0.4166 - val_loss: 3.0545 - val_accuracy10: 0.5349 - 22s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.1547 - accuracy10: 0.4208 - val_loss: 3.0444 - val_accuracy10: 0.5318 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.1440 - accuracy10: 0.4240 - val_loss: 3.0376 - val_accuracy10: 0.5343 - 22s/epoch - 15ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.1343 - accuracy10: 0.4285 - val_loss: 3.0379 - val_accuracy10: 0.5409 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.1271 - accuracy10: 0.4331 - val_loss: 3.0356 - val_accuracy10: 0.5511 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 22s - loss: 3.1185 - accuracy10: 0.4384 - val_loss: 3.0400 - val_accuracy10: 0.5585 - 22s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.1094 - accuracy10: 0.4419 - val_loss: 3.0447 - val_accuracy10: 0.5662 - 22s/epoch - 15ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.1004 - accuracy10: 0.4455 - val_loss: 3.0600 - val_accuracy10: 0.5776 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.0922 - accuracy10: 0.4483 - val_loss: 3.0641 - val_accuracy10: 0.5761 - 22s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.0840 - accuracy10: 0.4516 - val_loss: 3.0822 - val_accuracy10: 0.5851 - 22s/epoch - 15ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.0753 - accuracy10: 0.4550 - val_loss: 3.0817 - val_accuracy10: 0.5849 - 22s/epoch - 15ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.0687 - accuracy10: 0.4559 - val_loss: 3.1102 - val_accuracy10: 0.5895 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 21s - loss: 3.0624 - accuracy10: 0.4578 - val_loss: 3.1143 - val_accuracy10: 0.5921 - 21s/epoch - 14ms/step
Epoch 15/50
1489/1489 - 22s - loss: 3.0546 - accuracy10: 0.4594 - val_loss: 3.1351 - val_accuracy10: 0.5963 - 22s/epoch - 15ms/step
Epoch 16/50
1489/1489 - 22s - loss: 3.0480 - accuracy10: 0.4606 - val_loss: 3.1569 - val_accuracy10: 0.5994 - 22s/epoch - 15ms/step
testing model: results/WBA/W6/deepOF_L1/h10
Evaluating performance on  test set...
5183/5183 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0085862
{'0': {'precision': 0.36796527531045464, 'recall': 0.2819497699072085, 'f1-score': 0.3192654962246001, 'support': 304877}, '1': {'precision': 0.5727474993451134, 'recall': 0.7181907637825691, 'f1-score': 0.6372759654867228, 'support': 709338}, '2': {'precision': 0.3900784750612243, 'recall': 0.2542447700083168, 'f1-score': 0.30784365746864223, 'support': 312620}, 'accuracy': 0.5086404865714275, 'macro avg': {'precision': 0.4435970832389307, 'recall': 0.41812843456603144, 'f1-score': 0.4214617063933217, 'support': 1326835}, 'weighted avg': {'precision': 0.4826538701533571, 'recall': 0.5086404865714275, 'f1-score': 0.4865856340062897, 'support': 1326835}}
[[ 85960 184001  34916]
 [110537 509440  89361]
 [ 37112 196026  79482]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9906094
{'0': {'precision': 0.35653345307588685, 'recall': 0.28643578643578643, 'f1-score': 0.3176635327065413, 'support': 80388}, '1': {'precision': 0.6171071868708905, 'recall': 0.7305965246154195, 'f1-score': 0.6690734205159168, 'support': 220695}, '2': {'precision': 0.3645289855072464, 'recall': 0.2515816058613188, 'f1-score': 0.2977023568226539, 'support': 79982}, 'accuracy': 0.5363573143689396, 'macro avg': {'precision': 0.44605654181800797, 'recall': 0.4228713056375082, 'f1-score': 0.42814643668170405, 'support': 381065}, 'weighted avg': {'precision': 0.5091237430652938, 'recall': 0.5363573143689396, 'f1-score': 0.5169940154865003, 'support': 381065}}
[[ 23026  48981   8381]
 [ 32759 161239  26697]
 [  8798  51062  20122]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9819417
{'0': {'precision': 0.32763403210404257, 'recall': 0.2812804997072028, 'f1-score': 0.302692937864975, 'support': 25615}, '1': {'precision': 0.6506862787952966, 'recall': 0.7287826491395559, 'f1-score': 0.6875238150222273, 'support': 81702}, '2': {'precision': 0.3378869727820486, 'recall': 0.2557600062907919, 'f1-score': 0.29114263975294274, 'support': 25434}, 'accuracy': 0.5518075193407206, 'macro avg': {'precision': 0.43873576122712926, 'recall': 0.42194105171251683, 'f1-score': 0.427119797546715, 'support': 132751}, 'weighted avg': {'precision': 0.5284218826842509, 'recall': 0.5518075193407206, 'f1-score': 0.5373253100755074, 'support': 132751}}
[[ 7205 15745  2665]
 [12077 59543 10082]
 [ 2709 16220  6505]]
training model: results/WBA/W6/deepOF_L1/h20
Epoch 1/50
1489/1489 - 25s - loss: 3.2418 - accuracy20: 0.3978 - val_loss: 3.1604 - val_accuracy20: 0.4830 - 25s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 23s - loss: 3.2040 - accuracy20: 0.4085 - val_loss: 3.1376 - val_accuracy20: 0.4815 - 23s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.1906 - accuracy20: 0.4137 - val_loss: 3.1255 - val_accuracy20: 0.4818 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.1781 - accuracy20: 0.4211 - val_loss: 3.1230 - val_accuracy20: 0.4891 - 22s/epoch - 15ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.1686 - accuracy20: 0.4253 - val_loss: 3.1288 - val_accuracy20: 0.4983 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.1593 - accuracy20: 0.4308 - val_loss: 3.1324 - val_accuracy20: 0.5038 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 22s - loss: 3.1485 - accuracy20: 0.4376 - val_loss: 3.1548 - val_accuracy20: 0.5088 - 22s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.1387 - accuracy20: 0.4413 - val_loss: 3.1761 - val_accuracy20: 0.5094 - 22s/epoch - 15ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.1288 - accuracy20: 0.4450 - val_loss: 3.1945 - val_accuracy20: 0.5118 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.1202 - accuracy20: 0.4493 - val_loss: 3.2106 - val_accuracy20: 0.5138 - 22s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.1115 - accuracy20: 0.4524 - val_loss: 3.2405 - val_accuracy20: 0.5142 - 22s/epoch - 15ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.1052 - accuracy20: 0.4542 - val_loss: 3.2508 - val_accuracy20: 0.5149 - 22s/epoch - 15ms/step
Epoch 13/50
1489/1489 - 21s - loss: 3.0992 - accuracy20: 0.4567 - val_loss: 3.2545 - val_accuracy20: 0.5159 - 21s/epoch - 14ms/step
Epoch 14/50
1489/1489 - 21s - loss: 3.0931 - accuracy20: 0.4579 - val_loss: 3.2733 - val_accuracy20: 0.5173 - 21s/epoch - 14ms/step
testing model: results/WBA/W6/deepOF_L1/h20
Evaluating performance on  test set...
5183/5183 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0544865
{'0': {'precision': 0.4304790985721658, 'recall': 0.21062543729056082, 'f1-score': 0.2828551142886411, 'support': 380182}, '1': {'precision': 0.4463353082251878, 'recall': 0.7610366341271411, 'f1-score': 0.5626725431468973, 'support': 561471}, '2': {'precision': 0.4380896837033363, 'recall': 0.20866759090507864, 'f1-score': 0.2826875629782168, 'support': 385182}, 'accuracy': 0.4429721856900067, 'macro avg': {'precision': 0.43830136350022997, 'recall': 0.3934432207742602, 'f1-score': 0.3760717401379184, 'support': 1326835}, 'weighted avg': {'precision': 0.43939826507899327, 'recall': 0.4429721856900067, 'f1-score': 0.4012155990886518, 'support': 1326835}}
[[ 80076 262659  37447]
 [ 68526 427300  65645]
 [ 37414 267393  80375]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0394498
{'0': {'precision': 0.4133174749698218, 'recall': 0.22840353940630578, 'f1-score': 0.29421874012763, 'support': 101938}, '1': {'precision': 0.4921200412820955, 'recall': 0.753986832479883, 'f1-score': 0.5955380536598048, 'support': 177710}, '2': {'precision': 0.41080823484559664, 'recall': 0.2124988907185186, 'f1-score': 0.2801068385788649, 'support': 101417}, 'accuracy': 0.4692768950179103, 'macro avg': {'precision': 0.4387485836991713, 'recall': 0.3982964208682358, 'f1-score': 0.38995454412209996, 'support': 381065}, 'weighted avg': {'precision': 0.44939930996824884, 'recall': 0.4692768950179103, 'f1-score': 0.43098351382353933, 'support': 381065}}
[[ 23283  68604  10051]
 [ 22861 133991  20858]
 [ 10188  69678  21551]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0304052
{'0': {'precision': 0.38187652020907725, 'recall': 0.22435390696260263, 'f1-score': 0.2826499147721832, 'support': 32890}, '1': {'precision': 0.5298780809626854, 'recall': 0.7473610552801226, 'f1-score': 0.6201035194129783, 'support': 67167}, '2': {'precision': 0.38800620553148235, 'recall': 0.22184498684773965, 'f1-score': 0.2822892949578687, 'support': 32694}, 'accuracy': 0.4883579031419726, 'macro avg': {'precision': 0.43325360223441506, 'recall': 0.3978533163634883, 'f1-score': 0.3950142430476767, 'support': 132751}, 'weighted avg': {'precision': 0.45826935162329113, 'recall': 0.4883579031419726, 'f1-score': 0.45329989977191265, 'support': 132751}}
[[ 7379 22252  3259]
 [ 8788 50198  8181]
 [ 3156 22285  7253]]
training model: results/WBA/W6/deepOF_L1/h30
Epoch 1/50
1489/1489 - 24s - loss: 3.2586 - accuracy30: 0.3950 - val_loss: 3.2202 - val_accuracy30: 0.4339 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 22s - loss: 3.2247 - accuracy30: 0.4058 - val_loss: 3.1952 - val_accuracy30: 0.4353 - 22s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.2183 - accuracy30: 0.4082 - val_loss: 3.1935 - val_accuracy30: 0.4373 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.2068 - accuracy30: 0.4143 - val_loss: 3.1926 - val_accuracy30: 0.4431 - 22s/epoch - 14ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.1966 - accuracy30: 0.4195 - val_loss: 3.2210 - val_accuracy30: 0.4432 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 23s - loss: 3.1893 - accuracy30: 0.4229 - val_loss: 3.1951 - val_accuracy30: 0.4465 - 23s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 23s - loss: 3.1774 - accuracy30: 0.4294 - val_loss: 3.2531 - val_accuracy30: 0.4452 - 23s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 23s - loss: 3.1675 - accuracy30: 0.4341 - val_loss: 3.2248 - val_accuracy30: 0.4463 - 23s/epoch - 15ms/step
Epoch 9/50
1489/1489 - 23s - loss: 3.1560 - accuracy30: 0.4387 - val_loss: 3.2579 - val_accuracy30: 0.4465 - 23s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.1474 - accuracy30: 0.4428 - val_loss: 3.2726 - val_accuracy30: 0.4473 - 22s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 23s - loss: 3.1409 - accuracy30: 0.4453 - val_loss: 3.2970 - val_accuracy30: 0.4473 - 23s/epoch - 15ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.1330 - accuracy30: 0.4488 - val_loss: 3.3213 - val_accuracy30: 0.4461 - 22s/epoch - 15ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.1273 - accuracy30: 0.4519 - val_loss: 3.3285 - val_accuracy30: 0.4467 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 22s - loss: 3.1218 - accuracy30: 0.4539 - val_loss: 3.3602 - val_accuracy30: 0.4464 - 22s/epoch - 15ms/step
testing model: results/WBA/W6/deepOF_L1/h30
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0827253
{'0': {'precision': 0.46191314287198737, 'recall': 0.166585861140974, 'f1-score': 0.24486339098821194, 'support': 426951}, '1': {'precision': 0.3675719148944427, 'recall': 0.810610566493083, 'f1-score': 0.5057920701870083, 'support': 467402}, '2': {'precision': 0.4898832438366962, 'recall': 0.16095005110039262, 'f1-score': 0.24229471276930872, 'support': 432482}, 'accuracy': 0.39161840017786687, 'macro avg': {'precision': 0.4397894338677088, 'recall': 0.3793821595781499, 'f1-score': 0.330983391314843, 'support': 1326835}, 'weighted avg': {'precision': 0.43779656964793073, 'recall': 0.39161840017786687, 'f1-score': 0.3359430500425843, 'support': 1326835}}
[[ 71124 324859  30968]
 [ 47006 378881  41515]
 [ 35847 327027  69608]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0687004
{'0': {'precision': 0.4479232420148971, 'recall': 0.18288188448751322, 'f1-score': 0.25972219680471426, 'support': 116403}, '1': {'precision': 0.4093546399318706, 'recall': 0.7938171321160042, 'f1-score': 0.5401601564105961, 'support': 148960}, '2': {'precision': 0.45732703628265103, 'recall': 0.1765915887365819, 'f1-score': 0.2547964509069142, 'support': 115702}, 'accuracy': 0.41978927479563855, 'macro avg': {'precision': 0.4382016394098063, 'recall': 0.3844302017800331, 'f1-score': 0.3515596013740749, 'support': 381065}, 'weighted avg': {'precision': 0.43570185941108946, 'recall': 0.41978927479563855, 'f1-score': 0.3678510457176947, 'support': 381065}}
[[ 21288  85607   9508]
 [ 15976 118247  14737]
 [ 10262  85008  20432]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0563209
{'0': {'precision': 0.42217431475207884, 'recall': 0.1807108205020038, 'f1-score': 0.2530879013348596, 'support': 37928}, '1': {'precision': 0.4477862488633979, 'recall': 0.7857969489742241, 'f1-score': 0.5704829131367394, 'support': 57030}, '2': {'precision': 0.43639350246395325, 'recall': 0.18979705236419442, 'f1-score': 0.26453992255209297, 'support': 37793}, 'accuracy': 0.4432433653983774, 'macro avg': {'precision': 0.43545135535981006, 'recall': 0.3854349406134741, 'f1-score': 0.36270357900789735, 'support': 132751}, 'weighted avg': {'precision': 0.4372253076904627, 'recall': 0.4432433653983774, 'f1-score': 0.39270149189857745, 'support': 132751}}
[[ 6854 27817  3257]
 [ 6209 44814  6007]
 [ 3172 27448  7173]]
training model: results/WBA/W6/deepOF_L1/h50
Epoch 1/50
1489/1489 - 24s - loss: 3.2748 - accuracy50: 0.3889 - val_loss: 3.2741 - val_accuracy50: 0.3780 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 22s - loss: 3.2464 - accuracy50: 0.3962 - val_loss: 3.2512 - val_accuracy50: 0.3868 - 22s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 21s - loss: 3.2361 - accuracy50: 0.4012 - val_loss: 3.2465 - val_accuracy50: 0.3892 - 21s/epoch - 14ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.2277 - accuracy50: 0.4041 - val_loss: 3.2408 - val_accuracy50: 0.3916 - 22s/epoch - 15ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.2181 - accuracy50: 0.4100 - val_loss: 3.2422 - val_accuracy50: 0.3900 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.2107 - accuracy50: 0.4142 - val_loss: 3.2513 - val_accuracy50: 0.3859 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 22s - loss: 3.2019 - accuracy50: 0.4198 - val_loss: 3.2713 - val_accuracy50: 0.3840 - 22s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.1939 - accuracy50: 0.4238 - val_loss: 3.2857 - val_accuracy50: 0.3804 - 22s/epoch - 15ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.1869 - accuracy50: 0.4282 - val_loss: 3.3232 - val_accuracy50: 0.3779 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.1786 - accuracy50: 0.4319 - val_loss: 3.3462 - val_accuracy50: 0.3775 - 22s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.1730 - accuracy50: 0.4354 - val_loss: 3.3591 - val_accuracy50: 0.3758 - 22s/epoch - 14ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.1690 - accuracy50: 0.4356 - val_loss: 3.3735 - val_accuracy50: 0.3757 - 22s/epoch - 15ms/step
Epoch 13/50
1489/1489 - 21s - loss: 3.1630 - accuracy50: 0.4397 - val_loss: 3.4036 - val_accuracy50: 0.3755 - 21s/epoch - 14ms/step
Epoch 14/50
1489/1489 - 22s - loss: 3.1589 - accuracy50: 0.4416 - val_loss: 3.4178 - val_accuracy50: 0.3761 - 22s/epoch - 15ms/step
testing model: results/WBA/W6/deepOF_L1/h50
Evaluating performance on  test set...
5183/5183 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943477
{'0': {'precision': 0.4766863271575095, 'recall': 0.14041491303214274, 'f1-score': 0.2169299454036508, 'support': 456433}, '1': {'precision': 0.31659943537704466, 'recall': 0.7763192059533899, 'f1-score': 0.44977222088188124, 'support': 408238}, '2': {'precision': 0.46939340732844215, 'recall': 0.1943574142512182, 'f1-score': 0.274892583026282, 'support': 462164}, 'accuracy': 0.3548579891244955, 'macro avg': {'precision': 0.4208930566209988, 'recall': 0.3703638444122503, 'f1-score': 0.3138649164372713, 'support': 1326835}, 'weighted avg': {'precision': 0.42489083071179135, 'recall': 0.3548579891244955, 'f1-score': 0.3087599840376238, 'support': 1326835}}
[[ 64090 343387  48956]
 [ 38732 316923  52583]
 [ 31627 340712  89825]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088906
{'0': {'precision': 0.4721223241590214, 'recall': 0.15023978574987543, 'f1-score': 0.22794304376841892, 'support': 128448}, '1': {'precision': 0.3411844916779127, 'recall': 0.7740304885827274, 'f1-score': 0.47360769621043586, 'support': 125424}, '2': {'precision': 0.44739963339683, 'recall': 0.19573404196771835, 'f1-score': 0.2723270199465103, 'support': 127193}, 'accuracy': 0.3707399000170575, 'macro avg': {'precision': 0.42023548307792136, 'recall': 0.373334772100107, 'f1-score': 0.3246259199751217, 'support': 381065}, 'weighted avg': {'precision': 0.42077334194542004, 'recall': 0.3707399000170575, 'f1-score': 0.32361589341324987, 'support': 381065}}
[[19298 94583 14567]
 [12159 97082 16183]
 [ 9418 92879 24896]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0807339
{'0': {'precision': 0.44368131868131866, 'recall': 0.1444645841670394, 'f1-score': 0.21796032887610323, 'support': 42481}, '1': {'precision': 0.37411843385214005, 'recall': 0.767014292836962, 'f1-score': 0.5029286765106522, 'support': 48136}, '2': {'precision': 0.43636004152043895, 'recall': 0.20952200123415768, 'f1-score': 0.28310751222640906, 'support': 42134}, 'accuracy': 0.39085204631226883, 'macro avg': {'precision': 0.4180532646846326, 'recall': 0.3736669594127197, 'f1-score': 0.3346655058710548, 'support': 132751}, 'weighted avg': {'precision': 0.4161338522514323, 'recall': 0.39085204631226883, 'f1-score': 0.3419680410968656, 'support': 132751}}
[[ 6137 31366  4978]
 [ 4790 36921  6425]
 [ 2905 30401  8828]]
training model: results/WBA/W6/deepOF_L1/h100
Epoch 1/50
1489/1489 - 24s - loss: 3.2814 - accuracy100: 0.3804 - val_loss: 3.2962 - val_accuracy100: 0.3540 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 22s - loss: 3.2608 - accuracy100: 0.3857 - val_loss: 3.2740 - val_accuracy100: 0.3613 - 22s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 21s - loss: 3.2559 - accuracy100: 0.3862 - val_loss: 3.2682 - val_accuracy100: 0.3693 - 21s/epoch - 14ms/step
Epoch 4/50
1489/1489 - 21s - loss: 3.2534 - accuracy100: 0.3867 - val_loss: 3.2669 - val_accuracy100: 0.3709 - 21s/epoch - 14ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.2509 - accuracy100: 0.3869 - val_loss: 3.2659 - val_accuracy100: 0.3713 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 21s - loss: 3.2468 - accuracy100: 0.3890 - val_loss: 3.2649 - val_accuracy100: 0.3721 - 21s/epoch - 14ms/step
Epoch 7/50
1489/1489 - 21s - loss: 3.2445 - accuracy100: 0.3909 - val_loss: 3.2648 - val_accuracy100: 0.3718 - 21s/epoch - 14ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.2404 - accuracy100: 0.3938 - val_loss: 3.2675 - val_accuracy100: 0.3678 - 22s/epoch - 14ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.2382 - accuracy100: 0.3960 - val_loss: 3.2668 - val_accuracy100: 0.3676 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.2348 - accuracy100: 0.3979 - val_loss: 3.2732 - val_accuracy100: 0.3648 - 22s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 23s - loss: 3.2328 - accuracy100: 0.3994 - val_loss: 3.2850 - val_accuracy100: 0.3607 - 23s/epoch - 15ms/step
Epoch 12/50
1489/1489 - 21s - loss: 3.2299 - accuracy100: 0.4010 - val_loss: 3.2835 - val_accuracy100: 0.3619 - 21s/epoch - 14ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.2269 - accuracy100: 0.4028 - val_loss: 3.2778 - val_accuracy100: 0.3629 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 22s - loss: 3.2252 - accuracy100: 0.4042 - val_loss: 3.2852 - val_accuracy100: 0.3622 - 22s/epoch - 15ms/step
Epoch 15/50
1489/1489 - 21s - loss: 3.2239 - accuracy100: 0.4041 - val_loss: 3.2945 - val_accuracy100: 0.3624 - 21s/epoch - 14ms/step
Epoch 16/50
1489/1489 - 21s - loss: 3.2202 - accuracy100: 0.4066 - val_loss: 3.3012 - val_accuracy100: 0.3603 - 21s/epoch - 14ms/step
Epoch 17/50
1489/1489 - 21s - loss: 3.2185 - accuracy100: 0.4081 - val_loss: 3.2929 - val_accuracy100: 0.3623 - 21s/epoch - 14ms/step
testing model: results/WBA/W6/deepOF_L1/h100
Evaluating performance on  test set...
5183/5183 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0815346
{'0': {'precision': 0.3913512178141107, 'recall': 0.2578722144803858, 'f1-score': 0.31089021177394127, 'support': 405445}, '1': {'precision': 0.37405903794156825, 'recall': 0.4732097631852442, 'f1-score': 0.41783289677660773, 'support': 495535}, '2': {'precision': 0.38877656882883427, 'recall': 0.39510866374705006, 'f1-score': 0.39191704148158846, 'support': 425855}, 'accuracy': 0.3823414365765148, 'macro avg': {'precision': 0.3847289415281711, 'recall': 0.37539688047089337, 'f1-score': 0.37354671667737915, 'support': 1326835}, 'weighted avg': {'precision': 0.3840667344406956, 'recall': 0.3823414365765148, 'f1-score': 0.37683625930656317, 'support': 1326835}}
[[104553 198412 102480]
 [ 98991 234492 162052]
 [ 63615 193981 168259]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0916686
{'0': {'precision': 0.41199118377367966, 'recall': 0.2280336020260045, 'f1-score': 0.29357561058041176, 'support': 129516}, '1': {'precision': 0.3339040650321882, 'recall': 0.5127672327672328, 'f1-score': 0.40444281950100225, 'support': 125125}, '2': {'precision': 0.38888320196540077, 'recall': 0.3605960893501234, 'f1-score': 0.3742058345509169, 'support': 126424}, 'accuracy': 0.36550719693490613, 'macro avg': {'precision': 0.3782594835904229, 'recall': 0.3671323080477869, 'f1-score': 0.357408088210777, 'support': 381065}, 'weighted avg': {'precision': 0.3786843877555227, 'recall': 0.36550719693490613, 'f1-score': 0.356729809867767, 'support': 381065}}
[[29534 65886 34096]
 [23421 64160 37544]
 [18731 62105 45588]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.088327
{'0': {'precision': 0.3937014522120905, 'recall': 0.21640561550063814, 'f1-score': 0.2792926343530539, 'support': 43095}, '1': {'precision': 0.3544666448950509, 'recall': 0.510300465871693, 'f1-score': 0.4183426769446391, 'support': 46794}, '2': {'precision': 0.3841043720171715, 'recall': 0.373664318043955, 'f1-score': 0.37881242682623967, 'support': 42862}, 'accuracy': 0.37077686797086273, 'macro avg': {'precision': 0.37742415637477095, 'recall': 0.366790133138762, 'f1-score': 0.3588159127079775, 'support': 132751}, 'weighted avg': {'precision': 0.3767727388697566, 'recall': 0.37077686797086273, 'f1-score': 0.360439480990867, 'support': 132751}}
[[ 9326 22269 11500]
 [ 8734 23879 14181]
 [ 5628 21218 16016]]
training model: results/WBA/W6/deepOF_L1/h200
Epoch 1/50
1489/1489 - 24s - loss: 3.3095 - accuracy200: 0.3531 - val_loss: 3.3464 - val_accuracy200: 0.3328 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 21s - loss: 3.2915 - accuracy200: 0.3577 - val_loss: 3.3258 - val_accuracy200: 0.3338 - 21s/epoch - 14ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.2862 - accuracy200: 0.3604 - val_loss: 3.3136 - val_accuracy200: 0.3344 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.2829 - accuracy200: 0.3635 - val_loss: 3.3081 - val_accuracy200: 0.3347 - 22s/epoch - 14ms/step
Epoch 5/50
1489/1489 - 21s - loss: 3.2811 - accuracy200: 0.3658 - val_loss: 3.3048 - val_accuracy200: 0.3350 - 21s/epoch - 14ms/step
Epoch 6/50
1489/1489 - 21s - loss: 3.2794 - accuracy200: 0.3667 - val_loss: 3.3029 - val_accuracy200: 0.3364 - 21s/epoch - 14ms/step
Epoch 7/50
1489/1489 - 21s - loss: 3.2776 - accuracy200: 0.3676 - val_loss: 3.3032 - val_accuracy200: 0.3372 - 21s/epoch - 14ms/step
Epoch 8/50
1489/1489 - 21s - loss: 3.2764 - accuracy200: 0.3693 - val_loss: 3.3039 - val_accuracy200: 0.3368 - 21s/epoch - 14ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.2749 - accuracy200: 0.3703 - val_loss: 3.3082 - val_accuracy200: 0.3363 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.2732 - accuracy200: 0.3718 - val_loss: 3.3104 - val_accuracy200: 0.3356 - 22s/epoch - 14ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.2726 - accuracy200: 0.3730 - val_loss: 3.3092 - val_accuracy200: 0.3358 - 22s/epoch - 14ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.2711 - accuracy200: 0.3737 - val_loss: 3.3116 - val_accuracy200: 0.3361 - 22s/epoch - 15ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.2703 - accuracy200: 0.3737 - val_loss: 3.3145 - val_accuracy200: 0.3360 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 22s - loss: 3.2681 - accuracy200: 0.3760 - val_loss: 3.3210 - val_accuracy200: 0.3353 - 22s/epoch - 14ms/step
Epoch 15/50
1489/1489 - 22s - loss: 3.2677 - accuracy200: 0.3760 - val_loss: 3.3200 - val_accuracy200: 0.3363 - 22s/epoch - 15ms/step
Epoch 16/50
1489/1489 - 22s - loss: 3.2662 - accuracy200: 0.3774 - val_loss: 3.3226 - val_accuracy200: 0.3357 - 22s/epoch - 15ms/step
testing model: results/WBA/W6/deepOF_L1/h200
Evaluating performance on  test set...
5183/5183 - 32s - 32s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.106977
{'0': {'precision': 0.4129787381397604, 'recall': 0.013297178447108985, 'f1-score': 0.02576477704804701, 'support': 448441}, '1': {'precision': 0.2956399057945354, 'recall': 0.937223806129722, 'f1-score': 0.449491302359964, 'support': 392840}, '2': {'precision': 0.4512105977652798, 'recall': 0.062291732742393226, 'f1-score': 0.10947054490967033, 'support': 485554}, 'accuracy': 0.3047764039989901, 'macro avg': {'precision': 0.3866097472331919, 'recall': 0.3376042391064081, 'f1-score': 0.19490887477256044, 'support': 1326835}, 'weighted avg': {'precision': 0.39222879219328716, 'recall': 0.3047764039989901, 'f1-score': 0.1818508002625508, 'support': 1326835}}
[[  5963 425892  16586]
 [  4460 368179  20201]
 [  4016 451292  30246]]
Evaluating performance on  train set...
1489/1489 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028366
{'0': {'precision': 0.4065662799308813, 'recall': 0.012702942424125565, 'f1-score': 0.024636141983157077, 'support': 129655}, '1': {'precision': 0.33021500814932236, 'recall': 0.9430593636421603, 'f1-score': 0.48915200423336413, 'support': 125464}, '2': {'precision': 0.403432787937119, 'recall': 0.05990662664951646, 'f1-score': 0.10432221669155467, 'support': 125946}, 'accuracy': 0.33462007793945914, 'macro avg': {'precision': 0.38007135867244085, 'recall': 0.33855631090526744, 'f1-score': 0.20603678763602531, 'support': 381065}, 'weighted avg': {'precision': 0.3803923024061863, 'recall': 0.33462007793945914, 'f1-score': 0.20391306457269906, 'support': 381065}}
[[  1647 122718   5290]
 [  1277 118320   5867]
 [  1127 117274   7545]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021339
{'0': {'precision': 0.3836431226765799, 'recall': 0.01163052788171122, 'f1-score': 0.022576622694756184, 'support': 44366}, '1': {'precision': 0.3326909797498033, 'recall': 0.9376117308954312, 'f1-score': 0.4911191053320927, 'support': 44191}, '2': {'precision': 0.3868006993006993, 'recall': 0.06007602842014753, 'f1-score': 0.10399937326178073, 'support': 44194}, 'accuracy': 0.3360050018455605, 'macro avg': {'precision': 0.3677116005756942, 'recall': 0.3364394290657633, 'f1-score': 0.20589836709620987, 'support': 132751}, 'weighted avg': {'precision': 0.3677330338128361, 'recall': 0.3360050018455605, 'f1-score': 0.20565439904887492, 'support': 132751}}
[[  516 41917  1933]
 [  481 41434  2276]
 [  348 41191  2655]]
training model: results/WBA/W6/deepOF_L1/h300
Epoch 1/50
1489/1489 - 24s - loss: 3.3012 - accuracy300: 0.3652 - val_loss: 3.3107 - val_accuracy300: 0.3550 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 22s - loss: 3.2861 - accuracy300: 0.3665 - val_loss: 3.3077 - val_accuracy300: 0.3563 - 22s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.2870 - accuracy300: 0.3648 - val_loss: 3.2893 - val_accuracy300: 0.3559 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 22s - loss: 3.2851 - accuracy300: 0.3669 - val_loss: 3.2868 - val_accuracy300: 0.3573 - 22s/epoch - 15ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.2837 - accuracy300: 0.3671 - val_loss: 3.2864 - val_accuracy300: 0.3569 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.2826 - accuracy300: 0.3676 - val_loss: 3.2859 - val_accuracy300: 0.3568 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 22s - loss: 3.2814 - accuracy300: 0.3687 - val_loss: 3.2858 - val_accuracy300: 0.3567 - 22s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.2804 - accuracy300: 0.3702 - val_loss: 3.2853 - val_accuracy300: 0.3571 - 22s/epoch - 15ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.2791 - accuracy300: 0.3707 - val_loss: 3.2858 - val_accuracy300: 0.3564 - 22s/epoch - 15ms/step
Epoch 10/50
1489/1489 - 23s - loss: 3.2787 - accuracy300: 0.3703 - val_loss: 3.2855 - val_accuracy300: 0.3578 - 23s/epoch - 15ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.2775 - accuracy300: 0.3713 - val_loss: 3.2850 - val_accuracy300: 0.3576 - 22s/epoch - 15ms/step
Epoch 12/50
1489/1489 - 22s - loss: 3.2764 - accuracy300: 0.3723 - val_loss: 3.2852 - val_accuracy300: 0.3573 - 22s/epoch - 14ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.2753 - accuracy300: 0.3733 - val_loss: 3.2855 - val_accuracy300: 0.3578 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 23s - loss: 3.2742 - accuracy300: 0.3741 - val_loss: 3.2849 - val_accuracy300: 0.3588 - 23s/epoch - 15ms/step
Epoch 15/50
1489/1489 - 22s - loss: 3.2732 - accuracy300: 0.3750 - val_loss: 3.2858 - val_accuracy300: 0.3585 - 22s/epoch - 15ms/step
Epoch 16/50
1489/1489 - 23s - loss: 3.2727 - accuracy300: 0.3753 - val_loss: 3.2846 - val_accuracy300: 0.3589 - 23s/epoch - 16ms/step
Epoch 17/50
1489/1489 - 21s - loss: 3.2717 - accuracy300: 0.3755 - val_loss: 3.2853 - val_accuracy300: 0.3594 - 21s/epoch - 14ms/step
Epoch 18/50
1489/1489 - 21s - loss: 3.2701 - accuracy300: 0.3772 - val_loss: 3.2857 - val_accuracy300: 0.3596 - 21s/epoch - 14ms/step
Epoch 19/50
1489/1489 - 21s - loss: 3.2699 - accuracy300: 0.3763 - val_loss: 3.2852 - val_accuracy300: 0.3591 - 21s/epoch - 14ms/step
Epoch 20/50
1489/1489 - 21s - loss: 3.2690 - accuracy300: 0.3773 - val_loss: 3.2851 - val_accuracy300: 0.3587 - 21s/epoch - 14ms/step
Epoch 21/50
1489/1489 - 20s - loss: 3.2675 - accuracy300: 0.3788 - val_loss: 3.2853 - val_accuracy300: 0.3597 - 20s/epoch - 14ms/step
Epoch 22/50
1489/1489 - 21s - loss: 3.2664 - accuracy300: 0.3801 - val_loss: 3.2861 - val_accuracy300: 0.3584 - 21s/epoch - 14ms/step
Epoch 23/50
1489/1489 - 21s - loss: 3.2653 - accuracy300: 0.3802 - val_loss: 3.2857 - val_accuracy300: 0.3594 - 21s/epoch - 14ms/step
Epoch 24/50
1489/1489 - 21s - loss: 3.2642 - accuracy300: 0.3810 - val_loss: 3.2866 - val_accuracy300: 0.3585 - 21s/epoch - 14ms/step
Epoch 25/50
1489/1489 - 21s - loss: 3.2627 - accuracy300: 0.3801 - val_loss: 3.2876 - val_accuracy300: 0.3601 - 21s/epoch - 14ms/step
Epoch 26/50
1489/1489 - 21s - loss: 3.2617 - accuracy300: 0.3815 - val_loss: 3.2878 - val_accuracy300: 0.3596 - 21s/epoch - 14ms/step
testing model: results/WBA/W6/deepOF_L1/h300
Evaluating performance on  test set...
5183/5183 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0804464
{'0': {'precision': 0.3426590230338814, 'recall': 0.054571348128791004, 'f1-score': 0.09414871667904598, 'support': 365833}, '1': {'precision': 0.4244265582294771, 'recall': 0.7818081260214435, 'f1-score': 0.5501750802816302, 'support': 562317}, '2': {'precision': 0.3543129151164689, 'recall': 0.20686005242233843, 'f1-score': 0.26121425098701245, 'support': 398685}, 'accuracy': 0.4085361028311734, 'macro avg': {'precision': 0.37379949879327584, 'recall': 0.3477465088575243, 'f1-score': 0.3018460159825629, 'support': 1326835}, 'weighted avg': {'precision': 0.3808141116873524, 'recall': 0.4085361028311734, 'f1-score': 0.3376137287170808, 'support': 1326835}}
[[ 19964 293989  51880]
 [ 24279 439624  98414]
 [ 14019 302194  82472]]
Evaluating performance on  train set...
1489/1489 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0984786
{'0': {'precision': 0.39714080697687254, 'recall': 0.0553840706329718, 'f1-score': 0.09721133839543869, 'support': 129911}, '1': {'precision': 0.3322778220328619, 'recall': 0.798631965298632, 'f1-score': 0.4692994843760577, 'support': 125874}, '2': {'precision': 0.3738681322319522, 'recall': 0.18027618135376755, 'f1-score': 0.24325619718992506, 'support': 125280}, 'accuracy': 0.3419547846167977, 'macro avg': {'precision': 0.3677622537472289, 'recall': 0.3447640724284571, 'f1-score': 0.2699223399871405, 'support': 381065}, 'weighted avg': {'precision': 0.368063972161589, 'recall': 0.3419547846167977, 'f1-score': 0.26813420771415775, 'support': 381065}}
[[  7195 104362  18354]
 [  5877 100527  19470]
 [  5045  97650  22585]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950915
{'0': {'precision': 0.35070140280561124, 'recall': 0.049332832174403304, 'f1-score': 0.08649806409094653, 'support': 42568}, '1': {'precision': 0.35691367310603533, 'recall': 0.7926543040196223, 'f1-score': 0.49220083506210444, 'support': 47293}, '2': {'precision': 0.36457758144671454, 'recall': 0.18472837491256702, 'f1-score': 0.24521060938999104, 'support': 42890}, 'accuracy': 0.3578880761726842, 'macro avg': {'precision': 0.35739755245278704, 'recall': 0.34223850370219755, 'f1-score': 0.27463650284768065, 'support': 132751}, 'weighted avg': {'precision': 0.35739774559199233, 'recall': 0.3578880761726842, 'f1-score': 0.2823088844645406, 'support': 132751}}
[[ 2100 34206  6262]
 [ 2259 37487  7547]
 [ 1629 33338  7923]]
training model: results/WBA/W6/deepOF_L1/h500
Epoch 1/50
1489/1489 - 24s - loss: 3.2888 - accuracy500: 0.3835 - val_loss: 3.3169 - val_accuracy500: 0.3306 - 24s/epoch - 16ms/step
Epoch 2/50
1489/1489 - 21s - loss: 3.2769 - accuracy500: 0.3807 - val_loss: 3.3162 - val_accuracy500: 0.3326 - 21s/epoch - 14ms/step
Epoch 3/50
1489/1489 - 21s - loss: 3.2789 - accuracy500: 0.3768 - val_loss: 3.3136 - val_accuracy500: 0.3330 - 21s/epoch - 14ms/step
Epoch 4/50
1489/1489 - 21s - loss: 3.2800 - accuracy500: 0.3755 - val_loss: 3.3113 - val_accuracy500: 0.3345 - 21s/epoch - 14ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.2791 - accuracy500: 0.3756 - val_loss: 3.3103 - val_accuracy500: 0.3345 - 22s/epoch - 14ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.2794 - accuracy500: 0.3745 - val_loss: 3.3088 - val_accuracy500: 0.3351 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 21s - loss: 3.2783 - accuracy500: 0.3759 - val_loss: 3.3091 - val_accuracy500: 0.3354 - 21s/epoch - 14ms/step
Epoch 8/50
1489/1489 - 22s - loss: 3.2767 - accuracy500: 0.3770 - val_loss: 3.3085 - val_accuracy500: 0.3372 - 22s/epoch - 14ms/step
Epoch 9/50
1489/1489 - 21s - loss: 3.2758 - accuracy500: 0.3769 - val_loss: 3.3064 - val_accuracy500: 0.3373 - 21s/epoch - 14ms/step
Epoch 10/50
1489/1489 - 21s - loss: 3.2750 - accuracy500: 0.3778 - val_loss: 3.3083 - val_accuracy500: 0.3377 - 21s/epoch - 14ms/step
Epoch 11/50
1489/1489 - 21s - loss: 3.2738 - accuracy500: 0.3784 - val_loss: 3.3085 - val_accuracy500: 0.3361 - 21s/epoch - 14ms/step
Epoch 12/50
1489/1489 - 21s - loss: 3.2727 - accuracy500: 0.3793 - val_loss: 3.3075 - val_accuracy500: 0.3381 - 21s/epoch - 14ms/step
Epoch 13/50
1489/1489 - 22s - loss: 3.2714 - accuracy500: 0.3801 - val_loss: 3.3081 - val_accuracy500: 0.3378 - 22s/epoch - 15ms/step
Epoch 14/50
1489/1489 - 22s - loss: 3.2709 - accuracy500: 0.3805 - val_loss: 3.3084 - val_accuracy500: 0.3378 - 22s/epoch - 15ms/step
Epoch 15/50
1489/1489 - 21s - loss: 3.2688 - accuracy500: 0.3824 - val_loss: 3.3070 - val_accuracy500: 0.3381 - 21s/epoch - 14ms/step
Epoch 16/50
1489/1489 - 21s - loss: 3.2670 - accuracy500: 0.3837 - val_loss: 3.3066 - val_accuracy500: 0.3390 - 21s/epoch - 14ms/step
Epoch 17/50
1489/1489 - 22s - loss: 3.2659 - accuracy500: 0.3848 - val_loss: 3.3063 - val_accuracy500: 0.3387 - 22s/epoch - 15ms/step
Epoch 18/50
1489/1489 - 22s - loss: 3.2650 - accuracy500: 0.3847 - val_loss: 3.3072 - val_accuracy500: 0.3390 - 22s/epoch - 15ms/step
Epoch 19/50
1489/1489 - 21s - loss: 3.2632 - accuracy500: 0.3857 - val_loss: 3.3043 - val_accuracy500: 0.3404 - 21s/epoch - 14ms/step
Epoch 20/50
1489/1489 - 21s - loss: 3.2612 - accuracy500: 0.3871 - val_loss: 3.3061 - val_accuracy500: 0.3394 - 21s/epoch - 14ms/step
Epoch 21/50
1489/1489 - 22s - loss: 3.2604 - accuracy500: 0.3871 - val_loss: 3.3066 - val_accuracy500: 0.3405 - 22s/epoch - 15ms/step
Epoch 22/50
1489/1489 - 22s - loss: 3.2591 - accuracy500: 0.3876 - val_loss: 3.3035 - val_accuracy500: 0.3408 - 22s/epoch - 15ms/step
Epoch 23/50
1489/1489 - 22s - loss: 3.2590 - accuracy500: 0.3878 - val_loss: 3.3057 - val_accuracy500: 0.3411 - 22s/epoch - 15ms/step
Epoch 24/50
1489/1489 - 22s - loss: 3.2578 - accuracy500: 0.3883 - val_loss: 3.3058 - val_accuracy500: 0.3411 - 22s/epoch - 15ms/step
Epoch 25/50
1489/1489 - 22s - loss: 3.2567 - accuracy500: 0.3886 - val_loss: 3.3043 - val_accuracy500: 0.3405 - 22s/epoch - 15ms/step
Epoch 26/50
1489/1489 - 22s - loss: 3.2553 - accuracy500: 0.3893 - val_loss: 3.3065 - val_accuracy500: 0.3407 - 22s/epoch - 15ms/step
Epoch 27/50
1489/1489 - 22s - loss: 3.2533 - accuracy500: 0.3910 - val_loss: 3.3037 - val_accuracy500: 0.3427 - 22s/epoch - 15ms/step
Epoch 28/50
1489/1489 - 22s - loss: 3.2524 - accuracy500: 0.3926 - val_loss: 3.3050 - val_accuracy500: 0.3427 - 22s/epoch - 15ms/step
Epoch 29/50
1489/1489 - 21s - loss: 3.2520 - accuracy500: 0.3917 - val_loss: 3.3059 - val_accuracy500: 0.3410 - 21s/epoch - 14ms/step
Epoch 30/50
1489/1489 - 21s - loss: 3.2504 - accuracy500: 0.3929 - val_loss: 3.3062 - val_accuracy500: 0.3404 - 21s/epoch - 14ms/step
Epoch 31/50
1489/1489 - 22s - loss: 3.2504 - accuracy500: 0.3919 - val_loss: 3.3066 - val_accuracy500: 0.3416 - 22s/epoch - 15ms/step
Epoch 32/50
1489/1489 - 22s - loss: 3.2485 - accuracy500: 0.3930 - val_loss: 3.3054 - val_accuracy500: 0.3426 - 22s/epoch - 15ms/step
testing model: results/WBA/W6/deepOF_L1/h500
Evaluating performance on  test set...
5183/5183 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0974227
{'0': {'precision': 0.35305606642360104, 'recall': 0.3927158053911271, 'f1-score': 0.37183139432808404, 'support': 417946}, '1': {'precision': 0.35541747253199457, 'recall': 0.0579901839007916, 'f1-score': 0.09971138305241285, 'support': 446817}, '2': {'precision': 0.36966073834306884, 'recall': 0.6312349590540003, 'f1-score': 0.4662679270950813, 'support': 462072}, 'accuracy': 0.3630602147214989, 'macro avg': {'precision': 0.35937809243288815, 'recall': 0.360646982781973, 'f1-score': 0.312603568158526, 'support': 1326835}, 'weighted avg': {'precision': 0.3596338777990218, 'recall': 0.3630602147214989, 'f1-score': 0.313081535069435, 'support': 1326835}}
[[164134  22540 231272]
 [154817  25911 266089]
 [145944  24452 291676]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.099351
{'0': {'precision': 0.3679651998291063, 'recall': 0.36516269281468977, 'f1-score': 0.3665585897902173, 'support': 129723}, '1': {'precision': 0.3797267867748961, 'recall': 0.05988276341156911, 'f1-score': 0.10345129819782768, 'support': 128117}, '2': {'precision': 0.33879013983784667, 'recall': 0.6381984175289105, 'f1-score': 0.4426158924556283, 'support': 123225}, 'accuracy': 0.35081678978651937, 'macro avg': {'precision': 0.36216070881394974, 'recall': 0.3544146245850565, 'f1-score': 0.3042085934812244, 'support': 381065}, 'weighted avg': {'precision': 0.36248519633183096, 'recall': 0.35081678978651937, 'f1-score': 0.3026945357417035, 'support': 381065}}
[[47370  6561 75792]
 [42753  7672 77692]
 [38612  5971 78642]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.102392
{'0': {'precision': 0.33994032888498277, 'recall': 0.3453964374676881, 'f1-score': 0.34264666456854453, 'support': 42554}, '1': {'precision': 0.3872103256086829, 'recall': 0.05508952047076499, 'f1-score': 0.09645597369382536, 'support': 47922}, '2': {'precision': 0.3360138338009094, 'recall': 0.6572915434654051, 'f1-score': 0.44469516927927283, 'support': 42275}, 'accuracy': 0.33992210981461535, 'macro avg': {'precision': 0.35438816276485835, 'recall': 0.3525925004679527, 'f1-score': 0.2945992691805476, 'support': 132751}, 'weighted avg': {'precision': 0.35575399660359847, 'recall': 0.33992210981461535, 'f1-score': 0.28627157322119307, 'support': 132751}}
[[14698  2132 25724]
 [16097  2640 29185]
 [12442  2046 27787]]
training model: results/WBA/W6/deepOF_L1/h1000
Epoch 1/50
1489/1489 - 25s - loss: 3.3238 - accuracy1000: 0.3496 - val_loss: 3.3528 - val_accuracy1000: 0.3333 - 25s/epoch - 17ms/step
Epoch 2/50
1489/1489 - 23s - loss: 3.3037 - accuracy1000: 0.3473 - val_loss: 3.3178 - val_accuracy1000: 0.3346 - 23s/epoch - 15ms/step
Epoch 3/50
1489/1489 - 22s - loss: 3.2967 - accuracy1000: 0.3493 - val_loss: 3.3109 - val_accuracy1000: 0.3341 - 22s/epoch - 15ms/step
Epoch 4/50
1489/1489 - 21s - loss: 3.2936 - accuracy1000: 0.3524 - val_loss: 3.3116 - val_accuracy1000: 0.3346 - 21s/epoch - 14ms/step
Epoch 5/50
1489/1489 - 22s - loss: 3.2917 - accuracy1000: 0.3544 - val_loss: 3.3113 - val_accuracy1000: 0.3354 - 22s/epoch - 15ms/step
Epoch 6/50
1489/1489 - 22s - loss: 3.2898 - accuracy1000: 0.3565 - val_loss: 3.3164 - val_accuracy1000: 0.3351 - 22s/epoch - 15ms/step
Epoch 7/50
1489/1489 - 22s - loss: 3.2874 - accuracy1000: 0.3594 - val_loss: 3.3209 - val_accuracy1000: 0.3349 - 22s/epoch - 15ms/step
Epoch 8/50
1489/1489 - 21s - loss: 3.2850 - accuracy1000: 0.3634 - val_loss: 3.3319 - val_accuracy1000: 0.3354 - 21s/epoch - 14ms/step
Epoch 9/50
1489/1489 - 22s - loss: 3.2832 - accuracy1000: 0.3657 - val_loss: 3.3369 - val_accuracy1000: 0.3350 - 22s/epoch - 14ms/step
Epoch 10/50
1489/1489 - 22s - loss: 3.2813 - accuracy1000: 0.3668 - val_loss: 3.3443 - val_accuracy1000: 0.3351 - 22s/epoch - 14ms/step
Epoch 11/50
1489/1489 - 22s - loss: 3.2792 - accuracy1000: 0.3689 - val_loss: 3.3519 - val_accuracy1000: 0.3353 - 22s/epoch - 14ms/step
Epoch 12/50
1489/1489 - 21s - loss: 3.2780 - accuracy1000: 0.3700 - val_loss: 3.3564 - val_accuracy1000: 0.3347 - 21s/epoch - 14ms/step
Epoch 13/50
1489/1489 - 21s - loss: 3.2765 - accuracy1000: 0.3719 - val_loss: 3.3581 - val_accuracy1000: 0.3348 - 21s/epoch - 14ms/step
testing model: results/WBA/W6/deepOF_L1/h1000
Evaluating performance on  test set...
5183/5183 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1205717
{'0': {'precision': 0.3496838892522346, 'recall': 0.0035310718916550907, 'f1-score': 0.006991543893296139, 'support': 454253}, '1': {'precision': 0.2676483963298826, 'recall': 0.9562422348027008, 'f1-score': 0.4182345940682676, 'support': 355754}, '2': {'precision': 0.4122320696521298, 'recall': 0.04085885439643363, 'f1-score': 0.07434856545328437, 'support': 516828}, 'accuracy': 0.27351403904780924, 'macro avg': {'precision': 0.34318811841141567, 'recall': 0.33354405369692985, 'f1-score': 0.1665249011382827, 'support': 1326835}, 'weighted avg': {'precision': 0.3520520783869941, 'recall': 0.27351403904780924, 'f1-score': 0.1434918282623039, 'support': 1326835}}
[[  1604 436734  15915]
 [  1373 340187  14194]
 [  1610 494101  21117]]
Evaluating performance on  train set...
1489/1489 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108319
{'0': {'precision': 0.3840749414519906, 'recall': 0.003697385527591364, 'f1-score': 0.007324262363414417, 'support': 133067}, '1': {'precision': 0.3199604884859254, 'recall': 0.9516392433630134, 'f1-score': 0.47890377693942143, 'support': 121855}, '2': {'precision': 0.35891231708722204, 'recall': 0.0493883925386268, 'f1-score': 0.0868286632148905, 'support': 126143}, 'accuracy': 0.32195032343563434, 'macro avg': {'precision': 0.354315915675046, 'recall': 0.33490834047641055, 'f1-score': 0.1910189008392421, 'support': 381065}, 'weighted avg': {'precision': 0.3552432313987848, 'recall': 0.32195032343563434, 'f1-score': 0.1844416711657633, 'support': 381065}}
[[   492 126911   5664]
 [   429 115962   5464]
 [   360 119553   6230]]
Evaluating performance on  val set...
519/519 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1064825
{'0': {'precision': 0.39615384615384613, 'recall': 0.004661582675205359, 'f1-score': 0.0092147346290622, 'support': 44191}, '1': {'precision': 0.3350217422468581, 'recall': 0.9450697580373391, 'f1-score': 0.4946816955072233, 'support': 44511}, '2': {'precision': 0.3471285050232419, 'recall': 0.052555109083066584, 'f1-score': 0.09128908868646239, 'support': 44049}, 'accuracy': 0.33586940964663164, 'macro avg': {'precision': 0.35943469780798204, 'recall': 0.33409548326520366, 'f1-score': 0.19839517294091594, 'support': 132751}, 'weighted avg': {'precision': 0.3593890132827873, 'recall': 0.33586940964663164, 'f1-score': 0.19922394825097278, 'support': 132751}}
[[  206 41892  2093]
 [  184 42066  2261]
 [  130 41604  2315]]
training model: results/WBA/W6/deepLOB_L2/h10
Epoch 1/50
1489/1489 - 64s - loss: 3.0289 - accuracy10: 0.4528 - val_loss: 3.0143 - val_accuracy10: 0.5648 - 64s/epoch - 43ms/step
Epoch 2/50
1489/1489 - 61s - loss: 2.8772 - accuracy10: 0.4886 - val_loss: 2.9631 - val_accuracy10: 0.5934 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 62s - loss: 2.8151 - accuracy10: 0.5116 - val_loss: 2.9311 - val_accuracy10: 0.6061 - 62s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 2.7719 - accuracy10: 0.5279 - val_loss: 2.9254 - val_accuracy10: 0.6127 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 62s - loss: 2.7380 - accuracy10: 0.5383 - val_loss: 2.9990 - val_accuracy10: 0.6240 - 62s/epoch - 42ms/step
Epoch 6/50
1489/1489 - 62s - loss: 2.7073 - accuracy10: 0.5483 - val_loss: 2.8737 - val_accuracy10: 0.6281 - 62s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 62s - loss: 2.6836 - accuracy10: 0.5547 - val_loss: 2.7879 - val_accuracy10: 0.6262 - 62s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 62s - loss: 2.6610 - accuracy10: 0.5600 - val_loss: 2.8133 - val_accuracy10: 0.6219 - 62s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 62s - loss: 2.6409 - accuracy10: 0.5641 - val_loss: 2.7762 - val_accuracy10: 0.6282 - 62s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 62s - loss: 2.6256 - accuracy10: 0.5679 - val_loss: 2.7263 - val_accuracy10: 0.6209 - 62s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 62s - loss: 2.6100 - accuracy10: 0.5711 - val_loss: 2.7028 - val_accuracy10: 0.6142 - 62s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 62s - loss: 2.5983 - accuracy10: 0.5737 - val_loss: 2.7043 - val_accuracy10: 0.6177 - 62s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 62s - loss: 2.5868 - accuracy10: 0.5741 - val_loss: 2.6905 - val_accuracy10: 0.6194 - 62s/epoch - 42ms/step
Epoch 14/50
1489/1489 - 62s - loss: 2.5755 - accuracy10: 0.5768 - val_loss: 2.6897 - val_accuracy10: 0.6193 - 62s/epoch - 41ms/step
Epoch 15/50
1489/1489 - 61s - loss: 2.5677 - accuracy10: 0.5774 - val_loss: 2.6905 - val_accuracy10: 0.6229 - 61s/epoch - 41ms/step
Epoch 16/50
1489/1489 - 61s - loss: 2.5574 - accuracy10: 0.5793 - val_loss: 2.7069 - val_accuracy10: 0.6150 - 61s/epoch - 41ms/step
Epoch 17/50
1489/1489 - 61s - loss: 2.5506 - accuracy10: 0.5801 - val_loss: 2.7181 - val_accuracy10: 0.6217 - 61s/epoch - 41ms/step
Epoch 18/50
1489/1489 - 62s - loss: 2.5409 - accuracy10: 0.5818 - val_loss: 2.7006 - val_accuracy10: 0.6243 - 62s/epoch - 41ms/step
Epoch 19/50
1489/1489 - 61s - loss: 2.5339 - accuracy10: 0.5826 - val_loss: 2.7011 - val_accuracy10: 0.6273 - 61s/epoch - 41ms/step
Epoch 20/50
1489/1489 - 62s - loss: 2.5287 - accuracy10: 0.5835 - val_loss: 2.6685 - val_accuracy10: 0.6196 - 62s/epoch - 41ms/step
Epoch 21/50
1489/1489 - 61s - loss: 2.5208 - accuracy10: 0.5845 - val_loss: 2.7071 - val_accuracy10: 0.6268 - 61s/epoch - 41ms/step
Epoch 22/50
1489/1489 - 61s - loss: 2.5163 - accuracy10: 0.5852 - val_loss: 2.7321 - val_accuracy10: 0.6209 - 61s/epoch - 41ms/step
Epoch 23/50
1489/1489 - 62s - loss: 2.5091 - accuracy10: 0.5861 - val_loss: 2.7141 - val_accuracy10: 0.6159 - 62s/epoch - 41ms/step
Epoch 24/50
1489/1489 - 61s - loss: 2.5042 - accuracy10: 0.5874 - val_loss: 2.7477 - val_accuracy10: 0.6127 - 61s/epoch - 41ms/step
Epoch 25/50
1489/1489 - 61s - loss: 2.4970 - accuracy10: 0.5878 - val_loss: 2.7600 - val_accuracy10: 0.6146 - 61s/epoch - 41ms/step
Epoch 26/50
1489/1489 - 61s - loss: 2.4920 - accuracy10: 0.5883 - val_loss: 2.7276 - val_accuracy10: 0.6197 - 61s/epoch - 41ms/step
Epoch 27/50
1489/1489 - 61s - loss: 2.4855 - accuracy10: 0.5893 - val_loss: 2.7569 - val_accuracy10: 0.6209 - 61s/epoch - 41ms/step
Epoch 28/50
1489/1489 - 61s - loss: 2.4812 - accuracy10: 0.5897 - val_loss: 2.7756 - val_accuracy10: 0.6125 - 61s/epoch - 41ms/step
Epoch 29/50
1489/1489 - 61s - loss: 2.4771 - accuracy10: 0.5903 - val_loss: 2.7655 - val_accuracy10: 0.6127 - 61s/epoch - 41ms/step
Epoch 30/50
1489/1489 - 61s - loss: 2.4710 - accuracy10: 0.5909 - val_loss: 2.7447 - val_accuracy10: 0.6065 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h10
Evaluating performance on  test set...
5183/5183 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8911287
{'0': {'precision': 0.4315178518795072, 'recall': 0.5762365520860666, 'f1-score': 0.49348602824687365, 'support': 304880}, '1': {'precision': 0.6989170187060405, 'recall': 0.7225712952481113, 'f1-score': 0.7105473474805658, 'support': 709339}, '2': {'precision': 0.49245570543983347, 'recall': 0.2935727286394708, 'f1-score': 0.36785327072649193, 'support': 312621}, 'accuracy': 0.5878689216484279, 'macro avg': {'precision': 0.5409635253417938, 'recall': 0.5307935253245496, 'f1-score': 0.5239622154846438, 'support': 1326840}, 'weighted avg': {'precision': 0.5888292913261993, 'recall': 0.5878689216484279, 'f1-score': 0.5799279661106166, 'support': 1326840}}
[[175683  95785  33412]
 [135614 512548  61177]
 [ 95831 125013  91777]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8323625
{'0': {'precision': 0.453132139631263, 'recall': 0.5314174621769149, 'f1-score': 0.4891624174777886, 'support': 80242}, '1': {'precision': 0.7585438335809807, 'recall': 0.6842079048770437, 'f1-score': 0.7194608376442356, 'support': 220851}, '2': {'precision': 0.4531987145885088, 'recall': 0.49728661815089903, 'f1-score': 0.47422016598302014, 'support': 79974}, 'accuracy': 0.6128056221084481, 'macro avg': {'precision': 0.5549582292669175, 'recall': 0.5709706617349525, 'f1-score': 0.5609478070350148, 'support': 381067}, 'weighted avg': {'precision': 0.6301503602751914, 'recall': 0.6128056221084481, 'f1-score': 0.6194981452399337, 'support': 381067}}
[[ 42642  24654  12946]
 [ 34705 151108  35038]
 [ 16758  23446  39770]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.81941515
{'0': {'precision': 0.41415077939386913, 'recall': 0.5554951033732318, 'f1-score': 0.47452113003352925, 'support': 25732}, '1': {'precision': 0.7783283508743192, 'recall': 0.6986558184558455, 'f1-score': 0.7363432084097425, 'support': 81611}, '2': {'precision': 0.44077498899163364, 'recall': 0.4333503876579165, 'f1-score': 0.4370311569755904, 'support': 25409}, 'accuracy': 0.6201262504519706, 'macro avg': {'precision': 0.544418039753274, 'recall': 0.5625004364956646, 'f1-score': 0.5492984984729541, 'support': 132752}, 'weighted avg': {'precision': 0.6431295543107111, 'recall': 0.6201262504519706, 'f1-score': 0.6283039650411523, 'support': 132752}}
[[14294  7858  3580]
 [14203 57018 10390]
 [ 6017  8381 11011]]
training model: results/WBA/W6/deepLOB_L2/h20
Epoch 1/50
1489/1489 - 63s - loss: 3.0814 - accuracy20: 0.4549 - val_loss: 3.1058 - val_accuracy20: 0.5214 - 63s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 61s - loss: 2.9517 - accuracy20: 0.4903 - val_loss: 3.1408 - val_accuracy20: 0.5253 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 2.8911 - accuracy20: 0.5109 - val_loss: 3.0396 - val_accuracy20: 0.5397 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 2.8559 - accuracy20: 0.5234 - val_loss: 3.0257 - val_accuracy20: 0.5513 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 2.8225 - accuracy20: 0.5337 - val_loss: 3.0098 - val_accuracy20: 0.5578 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 2.7962 - accuracy20: 0.5407 - val_loss: 2.9825 - val_accuracy20: 0.5605 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 2.7749 - accuracy20: 0.5455 - val_loss: 2.9621 - val_accuracy20: 0.5618 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 62s - loss: 2.7552 - accuracy20: 0.5511 - val_loss: 2.9367 - val_accuracy20: 0.5630 - 62s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 62s - loss: 2.7368 - accuracy20: 0.5556 - val_loss: 2.9179 - val_accuracy20: 0.5716 - 62s/epoch - 42ms/step
Epoch 10/50
1489/1489 - 61s - loss: 2.7229 - accuracy20: 0.5587 - val_loss: 2.8857 - val_accuracy20: 0.5743 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 2.7108 - accuracy20: 0.5612 - val_loss: 2.9222 - val_accuracy20: 0.5668 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 2.6992 - accuracy20: 0.5631 - val_loss: 2.8783 - val_accuracy20: 0.5766 - 61s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 61s - loss: 2.6892 - accuracy20: 0.5650 - val_loss: 2.8838 - val_accuracy20: 0.5745 - 61s/epoch - 41ms/step
Epoch 14/50
1489/1489 - 62s - loss: 2.6788 - accuracy20: 0.5674 - val_loss: 2.8995 - val_accuracy20: 0.5761 - 62s/epoch - 42ms/step
Epoch 15/50
1489/1489 - 62s - loss: 2.6689 - accuracy20: 0.5695 - val_loss: 2.9320 - val_accuracy20: 0.5767 - 62s/epoch - 42ms/step
Epoch 16/50
1489/1489 - 62s - loss: 2.6626 - accuracy20: 0.5703 - val_loss: 2.9859 - val_accuracy20: 0.5748 - 62s/epoch - 42ms/step
Epoch 17/50
1489/1489 - 61s - loss: 2.6555 - accuracy20: 0.5722 - val_loss: 2.9712 - val_accuracy20: 0.5706 - 61s/epoch - 41ms/step
Epoch 18/50
1489/1489 - 61s - loss: 2.6493 - accuracy20: 0.5729 - val_loss: 2.9692 - val_accuracy20: 0.5750 - 61s/epoch - 41ms/step
Epoch 19/50
1489/1489 - 61s - loss: 2.6445 - accuracy20: 0.5734 - val_loss: 2.9873 - val_accuracy20: 0.5710 - 61s/epoch - 41ms/step
Epoch 20/50
1489/1489 - 61s - loss: 2.6366 - accuracy20: 0.5742 - val_loss: 3.0078 - val_accuracy20: 0.5692 - 61s/epoch - 41ms/step
Epoch 21/50
1489/1489 - 61s - loss: 2.6319 - accuracy20: 0.5753 - val_loss: 3.0141 - val_accuracy20: 0.5685 - 61s/epoch - 41ms/step
Epoch 22/50
1489/1489 - 61s - loss: 2.6266 - accuracy20: 0.5771 - val_loss: 3.0428 - val_accuracy20: 0.5651 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h20
Evaluating performance on  test set...
5183/5183 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9786762
{'0': {'precision': 0.48304510653527105, 'recall': 0.49702118705367127, 'f1-score': 0.48993349495054256, 'support': 380185}, '1': {'precision': 0.5619929860706089, 'recall': 0.7928744316269228, 'f1-score': 0.657761584032021, 'support': 561471}, '2': {'precision': 0.5447856351512365, 'recall': 0.20298350918002825, 'f1-score': 0.29576641617852056, 'support': 385184}, 'accuracy': 0.5368559886647976, 'macro avg': {'precision': 0.5299412425857054, 'recall': 0.4976263759535408, 'f1-score': 0.48115383172036136, 'support': 1326840}, 'weighted avg': {'precision': 0.5343763964006637, 'recall': 0.5368559886647976, 'f1-score': 0.5045852637658814, 'support': 1326840}}
[[188960 156222  35003]
 [ 85967 445176  30328]
 [116258 190740  78186]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92491895
{'0': {'precision': 0.5087758775877588, 'recall': 0.39970143683523046, 'f1-score': 0.44769075918663687, 'support': 101821}, '1': {'precision': 0.6207969818439047, 'recall': 0.7405740517794255, 'f1-score': 0.6754163630952992, 'support': 177754}, '2': {'precision': 0.4879865206402696, 'recall': 0.4280435896425334, 'f1-score': 0.4560537904753907, 'support': 101492}, 'accuracy': 0.5662547531011607, 'macro avg': {'precision': 0.5391864600239777, 'recall': 0.5227730260857298, 'f1-score': 0.5263869709191089, 'support': 381067}, 'weighted avg': {'precision': 0.5554927172790267, 'recall': 0.5662547531011607, 'f1-score': 0.5561439124870763, 'support': 381067}}
[[ 40698  42662  18461]
 [ 18993 131640  27121]
 [ 20301  37748  43443]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90439373
{'0': {'precision': 0.46933317123579116, 'recall': 0.4690623006591537, 'f1-score': 0.4691976968536834, 'support': 32921}, '1': {'precision': 0.6505092074076003, 'recall': 0.7434252630638943, 'f1-score': 0.6938704636221567, 'support': 67189}, '2': {'precision': 0.48365417967395075, 'recall': 0.3417376386250843, 'f1-score': 0.4004954582989266, 'support': 32642}, 'accuracy': 0.5766165481499337, 'macro avg': {'precision': 0.5344988527724475, 'recall': 0.5180750674493775, 'f1-score': 0.5211878729249223, 'support': 132752}, 'weighted avg': {'precision': 0.5645520986477027, 'recall': 0.5766165481499337, 'f1-score': 0.5660170295605548, 'support': 132752}}
[[15442 13194  4285]
 [ 9615 49950  7624]
 [ 7845 13642 11155]]
training model: results/WBA/W6/deepLOB_L2/h30
Epoch 1/50
1489/1489 - 64s - loss: 3.1217 - accuracy30: 0.4498 - val_loss: 3.3556 - val_accuracy30: 0.4327 - 64s/epoch - 43ms/step
Epoch 2/50
1489/1489 - 62s - loss: 2.9891 - accuracy30: 0.4882 - val_loss: 3.4063 - val_accuracy30: 0.4502 - 62s/epoch - 42ms/step
Epoch 3/50
1489/1489 - 62s - loss: 2.9395 - accuracy30: 0.5035 - val_loss: 3.3357 - val_accuracy30: 0.4683 - 62s/epoch - 42ms/step
Epoch 4/50
1489/1489 - 61s - loss: 2.9102 - accuracy30: 0.5126 - val_loss: 3.1521 - val_accuracy30: 0.4899 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 2.8873 - accuracy30: 0.5193 - val_loss: 3.1746 - val_accuracy30: 0.4960 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 62s - loss: 2.8675 - accuracy30: 0.5242 - val_loss: 3.1250 - val_accuracy30: 0.5010 - 62s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 2.8507 - accuracy30: 0.5284 - val_loss: 3.0992 - val_accuracy30: 0.5050 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 62s - loss: 2.8356 - accuracy30: 0.5319 - val_loss: 3.0981 - val_accuracy30: 0.5042 - 62s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 62s - loss: 2.8224 - accuracy30: 0.5351 - val_loss: 3.0627 - val_accuracy30: 0.5097 - 62s/epoch - 42ms/step
Epoch 10/50
1489/1489 - 61s - loss: 2.8090 - accuracy30: 0.5383 - val_loss: 3.0584 - val_accuracy30: 0.5039 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 2.7973 - accuracy30: 0.5413 - val_loss: 3.1044 - val_accuracy30: 0.4968 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 2.7844 - accuracy30: 0.5449 - val_loss: 3.0946 - val_accuracy30: 0.5011 - 61s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 61s - loss: 2.7742 - accuracy30: 0.5477 - val_loss: 3.0707 - val_accuracy30: 0.5063 - 61s/epoch - 41ms/step
Epoch 14/50
1489/1489 - 61s - loss: 2.7640 - accuracy30: 0.5499 - val_loss: 3.0647 - val_accuracy30: 0.5027 - 61s/epoch - 41ms/step
Epoch 15/50
1489/1489 - 61s - loss: 2.7554 - accuracy30: 0.5514 - val_loss: 3.0505 - val_accuracy30: 0.5063 - 61s/epoch - 41ms/step
Epoch 16/50
1489/1489 - 61s - loss: 2.7481 - accuracy30: 0.5534 - val_loss: 3.0700 - val_accuracy30: 0.5017 - 61s/epoch - 41ms/step
Epoch 17/50
1489/1489 - 61s - loss: 2.7410 - accuracy30: 0.5546 - val_loss: 3.0769 - val_accuracy30: 0.5062 - 61s/epoch - 41ms/step
Epoch 18/50
1489/1489 - 61s - loss: 2.7328 - accuracy30: 0.5562 - val_loss: 3.0478 - val_accuracy30: 0.5064 - 61s/epoch - 41ms/step
Epoch 19/50
1489/1489 - 61s - loss: 2.7269 - accuracy30: 0.5573 - val_loss: 3.0837 - val_accuracy30: 0.5065 - 61s/epoch - 41ms/step
Epoch 20/50
1489/1489 - 62s - loss: 2.7205 - accuracy30: 0.5588 - val_loss: 3.1223 - val_accuracy30: 0.5049 - 62s/epoch - 42ms/step
Epoch 21/50
1489/1489 - 62s - loss: 2.7139 - accuracy30: 0.5607 - val_loss: 3.1386 - val_accuracy30: 0.4933 - 62s/epoch - 42ms/step
Epoch 22/50
1489/1489 - 62s - loss: 2.7076 - accuracy30: 0.5612 - val_loss: 3.1697 - val_accuracy30: 0.4922 - 62s/epoch - 41ms/step
Epoch 23/50
1489/1489 - 61s - loss: 2.7027 - accuracy30: 0.5622 - val_loss: 3.1985 - val_accuracy30: 0.4966 - 61s/epoch - 41ms/step
Epoch 24/50
1489/1489 - 61s - loss: 2.6960 - accuracy30: 0.5639 - val_loss: 3.2619 - val_accuracy30: 0.4920 - 61s/epoch - 41ms/step
Epoch 25/50
1489/1489 - 61s - loss: 2.6922 - accuracy30: 0.5647 - val_loss: 3.2372 - val_accuracy30: 0.4944 - 61s/epoch - 41ms/step
Epoch 26/50
1489/1489 - 61s - loss: 2.6858 - accuracy30: 0.5664 - val_loss: 3.2992 - val_accuracy30: 0.4933 - 61s/epoch - 41ms/step
Epoch 27/50
1489/1489 - 61s - loss: 2.6823 - accuracy30: 0.5669 - val_loss: 3.3183 - val_accuracy30: 0.4911 - 61s/epoch - 41ms/step
Epoch 28/50
1489/1489 - 61s - loss: 2.6752 - accuracy30: 0.5680 - val_loss: 3.3486 - val_accuracy30: 0.4873 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h30
Evaluating performance on  test set...
5183/5183 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0692868
{'0': {'precision': 0.4276275322305118, 'recall': 0.6431825368013022, 'f1-score': 0.5137093289284892, 'support': 426955}, '1': {'precision': 0.4992022881376155, 'recall': 0.6265933821421389, 'f1-score': 0.555690270188221, 'support': 467402}, '2': {'precision': 0.5561633211213275, 'recall': 0.12601420171428704, 'f1-score': 0.20547284127026022, 'support': 432483}, 'accuracy': 0.4687678996713997, 'macro avg': {'precision': 0.4943310471631516, 'recall': 0.465263373552576, 'f1-score': 0.42495748012899015, 'support': 1326840}, 'weighted avg': {'precision': 0.4947371518133995, 'recall': 0.4687678996713997, 'f1-score': 0.4280282634004582, 'support': 1326840}}
[[274610 129502  22843]
 [153882 292871  20649]
 [213679 164305  54499]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0292825
{'0': {'precision': 0.47872804678181097, 'recall': 0.42468534657042817, 'f1-score': 0.4500902642280129, 'support': 116239}, '1': {'precision': 0.5181225341862336, 'recall': 0.7261983853757726, 'f1-score': 0.6047631954709685, 'support': 149013}, '2': {'precision': 0.5251396648044693, 'recall': 0.31329275137072055, 'f1-score': 0.39245250366396445, 'support': 115815}, 'accuracy': 0.5087346844518156, 'macro avg': {'precision': 0.5073300819241713, 'recall': 0.4880588277723071, 'f1-score': 0.482435321120982, 'support': 381067}, 'weighted avg': {'precision': 0.5082384800990214, 'recall': 0.5087346844518156, 'f1-score': 0.4930563574966016, 'support': 381067}}
[[ 49365  51991  14883]
 [ 22873 108213  17927]
 [ 30879  48652  36284]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0028977
{'0': {'precision': 0.42602698650674664, 'recall': 0.5614330874604847, 'f1-score': 0.4844462124225721, 'support': 37960}, '1': {'precision': 0.5716890011833563, 'recall': 0.6265224934718985, 'f1-score': 0.5978510807307998, 'support': 57061}, '2': {'precision': 0.49913336304660033, 'recall': 0.26712782592563145, 'f1-score': 0.34800773427249504, 'support': 37731}, 'accuracy': 0.5057626250451971, 'macro avg': {'precision': 0.49894978357890113, 'recall': 0.48502780228600484, 'f1-score': 0.47676834247528893, 'support': 132752}, 'weighted avg': {'precision': 0.5094155374339435, 'recall': 0.5057626250451971, 'f1-score': 0.49441242740581315, 'support': 132752}}
[[21312 12828  3820]
 [15017 35750  6294]
 [13696 13956 10079]]
training model: results/WBA/W6/deepLOB_L2/h50
Epoch 1/50
1489/1489 - 63s - loss: 3.1577 - accuracy50: 0.4366 - val_loss: 3.4728 - val_accuracy50: 0.3770 - 63s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.0680 - accuracy50: 0.4686 - val_loss: 3.2706 - val_accuracy50: 0.4187 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.0336 - accuracy50: 0.4761 - val_loss: 3.3234 - val_accuracy50: 0.4228 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 3.0127 - accuracy50: 0.4821 - val_loss: 3.3139 - val_accuracy50: 0.4298 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 2.9979 - accuracy50: 0.4876 - val_loss: 3.3513 - val_accuracy50: 0.4281 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 62s - loss: 2.9860 - accuracy50: 0.4915 - val_loss: 3.3323 - val_accuracy50: 0.4317 - 62s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 2.9756 - accuracy50: 0.4950 - val_loss: 3.3486 - val_accuracy50: 0.4331 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 2.9660 - accuracy50: 0.4975 - val_loss: 3.2899 - val_accuracy50: 0.4376 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 2.9546 - accuracy50: 0.5010 - val_loss: 3.2924 - val_accuracy50: 0.4394 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 2.9439 - accuracy50: 0.5038 - val_loss: 3.2864 - val_accuracy50: 0.4367 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 2.9332 - accuracy50: 0.5072 - val_loss: 3.2704 - val_accuracy50: 0.4365 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 2.9226 - accuracy50: 0.5101 - val_loss: 3.2564 - val_accuracy50: 0.4439 - 61s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 61s - loss: 2.9136 - accuracy50: 0.5127 - val_loss: 3.2359 - val_accuracy50: 0.4480 - 61s/epoch - 41ms/step
Epoch 14/50
1489/1489 - 61s - loss: 2.9049 - accuracy50: 0.5149 - val_loss: 3.2467 - val_accuracy50: 0.4480 - 61s/epoch - 41ms/step
Epoch 15/50
1489/1489 - 61s - loss: 2.8945 - accuracy50: 0.5178 - val_loss: 3.3211 - val_accuracy50: 0.4444 - 61s/epoch - 41ms/step
Epoch 16/50
1489/1489 - 61s - loss: 2.8872 - accuracy50: 0.5193 - val_loss: 3.3855 - val_accuracy50: 0.4379 - 61s/epoch - 41ms/step
Epoch 17/50
1489/1489 - 62s - loss: 2.8800 - accuracy50: 0.5209 - val_loss: 3.4035 - val_accuracy50: 0.4420 - 62s/epoch - 41ms/step
Epoch 18/50
1489/1489 - 61s - loss: 2.8729 - accuracy50: 0.5234 - val_loss: 3.4261 - val_accuracy50: 0.4399 - 61s/epoch - 41ms/step
Epoch 19/50
1489/1489 - 61s - loss: 2.8674 - accuracy50: 0.5251 - val_loss: 3.3599 - val_accuracy50: 0.4409 - 61s/epoch - 41ms/step
Epoch 20/50
1489/1489 - 61s - loss: 2.8599 - accuracy50: 0.5270 - val_loss: 3.4581 - val_accuracy50: 0.4359 - 61s/epoch - 41ms/step
Epoch 21/50
1489/1489 - 62s - loss: 2.8535 - accuracy50: 0.5284 - val_loss: 3.4660 - val_accuracy50: 0.4346 - 62s/epoch - 41ms/step
Epoch 22/50
1489/1489 - 61s - loss: 2.8485 - accuracy50: 0.5293 - val_loss: 3.5013 - val_accuracy50: 0.4308 - 61s/epoch - 41ms/step
Epoch 23/50
1489/1489 - 61s - loss: 2.8410 - accuracy50: 0.5304 - val_loss: 3.5104 - val_accuracy50: 0.4387 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h50
Evaluating performance on  test set...
5183/5183 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.139856
{'0': {'precision': 0.4251608848960212, 'recall': 0.4802579112953404, 'f1-score': 0.4510330013106699, 'support': 456436}, '1': {'precision': 0.38688828306233886, 'recall': 0.7181920394670769, 'f1-score': 0.5028776268904392, 'support': 408239}, '2': {'precision': 0.5207569064909785, 'recall': 0.060201443207512466, 'f1-score': 0.10792621311771106, 'support': 462165}, 'accuracy': 0.40715082451539, 'macro avg': {'precision': 0.4442686914831129, 'recall': 0.41955046465664325, 'f1-score': 0.35394561377294004, 'support': 1326840}, 'weighted avg': {'precision': 0.4466832738957897, 'recall': 0.40715082451539, 'f1-score': 0.3474734533145744, 'support': 1326840}}
[[219207 221953  15276]
 [104716 293194  10329]
 [191663 242679  27823]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1162184
{'0': {'precision': 0.4794477753613611, 'recall': 0.31066456977359785, 'f1-score': 0.37702850177870373, 'support': 128444}, '1': {'precision': 0.4164322033898305, 'recall': 0.7840599944154134, 'f1-score': 0.5439566065671312, 'support': 125345}, '2': {'precision': 0.5013906856403623, 'recall': 0.24360847907729538, 'f1-score': 0.32790109878488566, 'support': 127278}, 'accuracy': 0.44398229182794624, 'macro avg': {'precision': 0.4657568881305179, 'recall': 0.44611101442210227, 'f1-score': 0.4162954023769068, 'support': 381067}, 'weighted avg': {'precision': 0.46604898424515107, 'recall': 0.44398229182794624, 'f1-score': 0.41552767829217313, 'support': 381067}}
[[39903 69911 18630]
 [14863 98278 12204]
 [28461 67811 31006]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0798928
{'0': {'precision': 0.4356029131433599, 'recall': 0.4203178795453474, 'f1-score': 0.4278239162786232, 'support': 42406}, '1': {'precision': 0.4490958020775101, 'recall': 0.7150338432241105, 'f1-score': 0.5516888924379143, 'support': 48311}, '2': {'precision': 0.48394233992624874, 'recall': 0.1717140478172951, 'f1-score': 0.25348551360842847, 'support': 42035}, 'accuracy': 0.44885199469687836, 'macro avg': {'precision': 0.45621368504903964, 'recall': 0.4356885901955843, 'f1-score': 0.4109994407749886, 'support': 132752}, 'weighted avg': {'precision': 0.45581957852027677, 'recall': 0.44885199469687836, 'f1-score': 0.4176977118296497, 'support': 132752}}
[[17824 20922  3660]
 [ 9730 34544  4037]
 [13364 21453  7218]]
training model: results/WBA/W6/deepLOB_L2/h100
Epoch 1/50
1489/1489 - 63s - loss: 3.2501 - accuracy100: 0.4006 - val_loss: 3.3872 - val_accuracy100: 0.3547 - 63s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.1932 - accuracy100: 0.4219 - val_loss: 3.2985 - val_accuracy100: 0.3766 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.1681 - accuracy100: 0.4330 - val_loss: 3.3693 - val_accuracy100: 0.3671 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 60s - loss: 3.1562 - accuracy100: 0.4365 - val_loss: 3.3918 - val_accuracy100: 0.3584 - 60s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 3.1477 - accuracy100: 0.4412 - val_loss: 3.3735 - val_accuracy100: 0.3613 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 3.1386 - accuracy100: 0.4448 - val_loss: 3.3831 - val_accuracy100: 0.3647 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 3.1335 - accuracy100: 0.4465 - val_loss: 3.3674 - val_accuracy100: 0.3624 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 3.1265 - accuracy100: 0.4490 - val_loss: 3.3776 - val_accuracy100: 0.3614 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 3.1203 - accuracy100: 0.4519 - val_loss: 3.3971 - val_accuracy100: 0.3621 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 3.1152 - accuracy100: 0.4533 - val_loss: 3.3567 - val_accuracy100: 0.3629 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 3.1085 - accuracy100: 0.4559 - val_loss: 3.3746 - val_accuracy100: 0.3621 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 3.1031 - accuracy100: 0.4566 - val_loss: 3.3810 - val_accuracy100: 0.3622 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h100
Evaluating performance on  test set...
5183/5183 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0903
{'0': {'precision': 0.4128584543092315, 'recall': 0.06544365738639726, 'f1-score': 0.11297866587753902, 'support': 405448}, '1': {'precision': 0.3907108973462808, 'recall': 0.90801475573924, 'f1-score': 0.5463374950293384, 'support': 495536}, '2': {'precision': 0.39932577382776585, 'recall': 0.10403047039374812, 'f1-score': 0.16506022749712182, 'support': 425856}, 'accuracy': 0.39250399445298606, 'macro avg': {'precision': 0.4009650418277593, 'recall': 0.3591629611731284, 'f1-score': 0.27479212946799975, 'support': 1326840}, 'weighted avg': {'precision': 0.4002436062745719, 'recall': 0.39250399445298606, 'f1-score': 0.2915413759764471, 'support': 1326840}}
[[ 26534 341868  37046]
 [ 15988 449954  29594]
 [ 21747 359807  44302]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0943375
{'0': {'precision': 0.4305836555945399, 'recall': 0.12995153773023443, 'f1-score': 0.1996485103250092, 'support': 129379}, '1': {'precision': 0.3638333814932539, 'recall': 0.7841761084628835, 'f1-score': 0.49705067375213513, 'support': 125241}, '2': {'precision': 0.41496268346142107, 'recall': 0.2365655175686256, 'f1-score': 0.3013403313303078, 'support': 126447}, 'accuracy': 0.3803451886413675, 'macro avg': {'precision': 0.40312657351640496, 'recall': 0.38356438792058123, 'f1-score': 0.3326798384691507, 'support': 381067}, 'weighted avg': {'precision': 0.40346218839314063, 'recall': 0.3803451886413675, 'f1-score': 0.3311360703615216, 'support': 381067}}
[[16813 87747 24819]
 [ 9676 98211 17354]
 [12558 83976 29913]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1012506
{'0': {'precision': 0.4194856201697707, 'recall': 0.0767839335822453, 'f1-score': 0.1298075038224801, 'support': 43121}, '1': {'precision': 0.3707613079122252, 'recall': 0.837449483610238, 'f1-score': 0.5139730054264736, 'support': 46767}, '2': {'precision': 0.3954226267880364, 'recall': 0.17735162374020158, 'f1-score': 0.24487429335308994, 'support': 42864}, 'accuracy': 0.37722972158611545, 'macro avg': {'precision': 0.39522318495667746, 'recall': 0.36386168031089494, 'f1-score': 0.29621826753401453, 'support': 132752}, 'weighted avg': {'precision': 0.39455095960222153, 'recall': 0.37722972158611545, 'f1-score': 0.3022982450539043, 'support': 132752}}
[[ 3311 33737  6073]
 [ 2052 39165  5550]
 [ 2530 32732  7602]]
training model: results/WBA/W6/deepLOB_L2/h200
Epoch 1/50
1489/1489 - 63s - loss: 3.2827 - accuracy200: 0.3768 - val_loss: 3.4128 - val_accuracy200: 0.3368 - 63s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.2481 - accuracy200: 0.3914 - val_loss: 3.4366 - val_accuracy200: 0.3370 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.2343 - accuracy200: 0.3992 - val_loss: 3.5898 - val_accuracy200: 0.3406 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 3.2250 - accuracy200: 0.4052 - val_loss: 3.5949 - val_accuracy200: 0.3363 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 3.2167 - accuracy200: 0.4103 - val_loss: 3.6398 - val_accuracy200: 0.3359 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 3.2088 - accuracy200: 0.4148 - val_loss: 3.6972 - val_accuracy200: 0.3360 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 3.2021 - accuracy200: 0.4169 - val_loss: 3.7884 - val_accuracy200: 0.3358 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 3.1961 - accuracy200: 0.4206 - val_loss: 3.7858 - val_accuracy200: 0.3378 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 3.1901 - accuracy200: 0.4229 - val_loss: 3.8313 - val_accuracy200: 0.3346 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 3.1848 - accuracy200: 0.4264 - val_loss: 3.8482 - val_accuracy200: 0.3347 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 3.1786 - accuracy200: 0.4280 - val_loss: 3.9566 - val_accuracy200: 0.3345 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h200
Evaluating performance on  test set...
5183/5183 - 70s - 70s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1671637
{'0': {'precision': 0.33251546615045147, 'recall': 0.2190980793545668, 'f1-score': 0.26414688537988273, 'support': 448443}, '1': {'precision': 0.2966836920178255, 'recall': 0.7166901706029396, 'f1-score': 0.41964825360201335, 'support': 392842}, '2': {'precision': 0.38738027895458793, 'recall': 0.06572272965987375, 'f1-score': 0.11237925533600734, 'support': 485555}, 'accuracy': 0.31029438364836753, 'macro avg': {'precision': 0.3388598123742883, 'recall': 0.3338369932057934, 'f1-score': 0.2653914647726345, 'support': 1326840}, 'weighted avg': {'precision': 0.3419843232600528, 'recall': 0.31029438364836753, 'f1-score': 0.2546475764120828, 'support': 1326840}}
[[ 98253 324983  25207]
 [ 86036 281546  25260]
 [111195 342448  31912]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1328193
{'0': {'precision': 0.3473040094218854, 'recall': 0.1046020264955815, 'f1-score': 0.16077989806803364, 'support': 129682}, '1': {'precision': 0.3398086168912719, 'recall': 0.6411031687781217, 'f1-score': 0.4441834306607671, 'support': 125348}, '2': {'precision': 0.35296626231993933, 'recall': 0.29550846180089974, 'f1-score': 0.321691851250448, 'support': 126037}, 'accuracy': 0.3442203077149163, 'macro avg': {'precision': 0.3466929628776989, 'recall': 0.34707121902486765, 'f1-score': 0.30888505999308297, 'support': 381067}, 'weighted avg': {'precision': 0.34671125514398854, 'recall': 0.3442203077149163, 'f1-score': 0.30722376711648425, 'support': 381067}}
[[13565 80440 35677]
 [12389 80361 32598]
 [13104 75688 37245]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1397275
{'0': {'precision': 0.33899533920248576, 'recall': 0.14751881732546085, 'f1-score': 0.2055775390993028, 'support': 44374}, '1': {'precision': 0.3310031252202928, 'recall': 0.637932205692548, 'f1-score': 0.4358547924224727, 'support': 44163}, '2': {'precision': 0.3472182999152782, 'recall': 0.22245844170530363, 'f1-score': 0.271177094964366, 'support': 44215}, 'accuracy': 0.3356258286127516, 'macro avg': {'precision': 0.33907225477935227, 'recall': 0.33596982157443755, 'f1-score': 0.3042031421620472, 'support': 132752}, 'weighted avg': {'precision': 0.3390753233972288, 'recall': 0.3356258286127516, 'f1-score': 0.30403344711639424, 'support': 132752}}
[[ 6546 28994  8834]
 [ 6332 28173  9658]
 [ 6432 27947  9836]]
training model: results/WBA/W6/deepLOB_L2/h300
Epoch 1/50
1489/1489 - 64s - loss: 3.2724 - accuracy300: 0.3829 - val_loss: 3.4197 - val_accuracy300: 0.3455 - 64s/epoch - 43ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.2391 - accuracy300: 0.3975 - val_loss: 3.4982 - val_accuracy300: 0.3604 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.2289 - accuracy300: 0.4059 - val_loss: 3.7493 - val_accuracy300: 0.3558 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 3.2146 - accuracy300: 0.4112 - val_loss: 3.6801 - val_accuracy300: 0.3309 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 3.2051 - accuracy300: 0.4172 - val_loss: 3.9697 - val_accuracy300: 0.3547 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 3.2004 - accuracy300: 0.4197 - val_loss: 3.8856 - val_accuracy300: 0.3543 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 62s - loss: 3.1933 - accuracy300: 0.4229 - val_loss: 3.9259 - val_accuracy300: 0.3551 - 62s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 3.1861 - accuracy300: 0.4263 - val_loss: 3.8570 - val_accuracy300: 0.3522 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 3.1770 - accuracy300: 0.4301 - val_loss: 3.7752 - val_accuracy300: 0.3411 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 3.1715 - accuracy300: 0.4315 - val_loss: 3.8334 - val_accuracy300: 0.3469 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 3.1636 - accuracy300: 0.4349 - val_loss: 3.7091 - val_accuracy300: 0.3544 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h300
Evaluating performance on  test set...
5183/5183 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204106
{'0': {'precision': 0.26365811965811964, 'recall': 0.10540242075684186, 'f1-score': 0.15059970395597613, 'support': 365836}, '1': {'precision': 0.42179960501937575, 'recall': 0.8842236674331383, 'f1-score': 0.5711463211091321, 'support': 562317}, '2': {'precision': 0.27196885428253614, 'recall': 0.0012265260718307845, 'f1-score': 0.002442039027678939, 'support': 398687}, 'accuracy': 0.40416553616110457, 'macro avg': {'precision': 0.3191421929866772, 'recall': 0.330284204753937, 'f1-score': 0.2413960213642624, 'support': 1326840}, 'weighted avg': {'precision': 0.3331759420625468, 'recall': 0.40416553616110457, 'f1-score': 0.28430985526317454, 'support': 1326840}}
[[ 38560 326920    356]
 [ 64150 497214    953]
 [ 43540 354658    489]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1332952
{'0': {'precision': 0.3205766710353866, 'recall': 0.03766495742289155, 'f1-score': 0.06740984690854473, 'support': 129882}, '1': {'precision': 0.34334545426911517, 'recall': 0.717751159687361, 'f1-score': 0.4644941746749358, 'support': 125896}, '2': {'precision': 0.3525324966382788, 'recall': 0.28876437676092875, 'f1-score': 0.3174780071517891, 'support': 125289}, 'accuracy': 0.3449078508503754, 'macro avg': {'precision': 0.3388182073142602, 'recall': 0.34806016462372713, 'f1-score': 0.2831273429117565, 'support': 381067}, 'weighted avg': {'precision': 0.33860555353624405, 'recall': 0.3449078508503754, 'f1-score': 0.2808161986975829, 'support': 381067}}
[[ 4892 88425 36565]
 [ 5652 90362 29882]
 [ 4716 84394 36179]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1390607
{'0': {'precision': 0.2924237910833085, 'recall': 0.06917204932472108, 'f1-score': 0.11187934505945371, 'support': 42575}, '1': {'precision': 0.3542723142312766, 'recall': 0.7671377792823291, 'f1-score': 0.48470346035332096, 'support': 47264}, '2': {'precision': 0.333743115656963, 'recall': 0.15815720178034628, 'f1-score': 0.21461208872867554, 'support': 42913}, 'accuracy': 0.3464354585994938, 'macro avg': {'precision': 0.3268130736571827, 'recall': 0.3314890101291322, 'f1-score': 0.27039829804715004, 'support': 132752}, 'weighted avg': {'precision': 0.3278006198579771, 'recall': 0.3464354585994938, 'f1-score': 0.2778258408887193, 'support': 132752}}
[[ 2945 33030  6600]
 [ 4057 36258  6949]
 [ 3069 33057  6787]]
training model: results/WBA/W6/deepLOB_L2/h500
Epoch 1/50
1489/1489 - 63s - loss: 3.2351 - accuracy500: 0.4141 - val_loss: 3.3458 - val_accuracy500: 0.3507 - 63s/epoch - 43ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.2018 - accuracy500: 0.4279 - val_loss: 3.5946 - val_accuracy500: 0.3280 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.1792 - accuracy500: 0.4388 - val_loss: 3.4805 - val_accuracy500: 0.3322 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 3.1614 - accuracy500: 0.4491 - val_loss: 3.5050 - val_accuracy500: 0.3390 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 61s - loss: 3.1562 - accuracy500: 0.4482 - val_loss: 3.4789 - val_accuracy500: 0.3456 - 61s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 3.1390 - accuracy500: 0.4572 - val_loss: 3.4529 - val_accuracy500: 0.3424 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 3.1311 - accuracy500: 0.4613 - val_loss: 3.4040 - val_accuracy500: 0.3485 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 3.1207 - accuracy500: 0.4644 - val_loss: 3.3754 - val_accuracy500: 0.3439 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 3.1144 - accuracy500: 0.4659 - val_loss: 3.3474 - val_accuracy500: 0.3596 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 3.1040 - accuracy500: 0.4700 - val_loss: 3.3238 - val_accuracy500: 0.3575 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 3.0999 - accuracy500: 0.4709 - val_loss: 3.3215 - val_accuracy500: 0.3688 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 3.0925 - accuracy500: 0.4724 - val_loss: 3.3211 - val_accuracy500: 0.3548 - 61s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 61s - loss: 3.0841 - accuracy500: 0.4749 - val_loss: 3.3286 - val_accuracy500: 0.3744 - 61s/epoch - 41ms/step
Epoch 14/50
1489/1489 - 61s - loss: 3.0755 - accuracy500: 0.4787 - val_loss: 3.3256 - val_accuracy500: 0.3672 - 61s/epoch - 41ms/step
Epoch 15/50
1489/1489 - 61s - loss: 3.0619 - accuracy500: 0.4822 - val_loss: 3.3746 - val_accuracy500: 0.3704 - 61s/epoch - 41ms/step
Epoch 16/50
1489/1489 - 61s - loss: 3.0534 - accuracy500: 0.4842 - val_loss: 3.3695 - val_accuracy500: 0.3662 - 61s/epoch - 41ms/step
Epoch 17/50
1489/1489 - 61s - loss: 3.0443 - accuracy500: 0.4871 - val_loss: 3.4007 - val_accuracy500: 0.3645 - 61s/epoch - 41ms/step
Epoch 18/50
1489/1489 - 61s - loss: 3.0336 - accuracy500: 0.4906 - val_loss: 3.4432 - val_accuracy500: 0.3466 - 61s/epoch - 41ms/step
Epoch 19/50
1489/1489 - 61s - loss: 3.0266 - accuracy500: 0.4934 - val_loss: 3.4466 - val_accuracy500: 0.3495 - 61s/epoch - 41ms/step
Epoch 20/50
1489/1489 - 61s - loss: 3.0186 - accuracy500: 0.4959 - val_loss: 3.4757 - val_accuracy500: 0.3330 - 61s/epoch - 41ms/step
Epoch 21/50
1489/1489 - 61s - loss: 3.0087 - accuracy500: 0.4987 - val_loss: 3.5838 - val_accuracy500: 0.3317 - 61s/epoch - 41ms/step
Epoch 22/50
1489/1489 - 62s - loss: 2.9984 - accuracy500: 0.5011 - val_loss: 3.6646 - val_accuracy500: 0.3291 - 62s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h500
Evaluating performance on  test set...
5183/5183 - 71s - 71s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054425
{'0': {'precision': 0.33180958993943604, 'recall': 0.2881243599682257, 'f1-score': 0.3084277792718379, 'support': 417948}, '1': {'precision': 0.3572321041759539, 'recall': 0.509343849173489, 'f1-score': 0.41993774298962816, 'support': 446818}, '2': {'precision': 0.3536632378947626, 'recall': 0.25015906543107813, 'f1-score': 0.2930400701722363, 'support': 462074}, 'accuracy': 0.3493993247113443, 'macro avg': {'precision': 0.3475683106700509, 'recall': 0.34920909152426427, 'f1-score': 0.34046853081123407, 'support': 1326840}, 'weighted avg': {'precision': 0.3479812756675133, 'recall': 0.3493993247113443, 'f1-score': 0.34062035612659536, 'support': 1326840}}
[[120421 190201 107326]
 [115310 227584 103924]
 [127191 219291 115592]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1091714
{'0': {'precision': 0.35986667716452775, 'recall': 0.4229487970388649, 'f1-score': 0.3888660437020547, 'support': 129680}, '1': {'precision': 0.41004934948407357, 'recall': 0.3211474795427572, 'f1-score': 0.3601938899276197, 'support': 128072}, '2': {'precision': 0.3469653291780288, 'recall': 0.3611320601711065, 'f1-score': 0.3539069795164206, 'support': 123315}, 'accuracy': 0.36873043323090166, 'macro avg': {'precision': 0.3722937852755434, 'recall': 0.3684094455842429, 'f1-score': 0.367655637715365, 'support': 381067}, 'weighted avg': {'precision': 0.3725575306951503, 'recall': 0.36873043323090166, 'f1-score': 0.3679167694845263, 'support': 381067}}
[[54848 29705 45127]
 [48252 41130 38690]
 [49312 29470 44533]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1073799
{'0': {'precision': 0.3191851799276031, 'recall': 0.3172561377104694, 'f1-score': 0.31821773537285797, 'support': 42524}, '1': {'precision': 0.40391900200313363, 'recall': 0.42439776610819374, 'f1-score': 0.41390523224501824, 'support': 47988}, '2': {'precision': 0.3231329872204473, 'recall': 0.3064867424242424, 'f1-score': 0.31458981337480557, 'support': 42240}, 'accuracy': 0.35255966011811496, 'macro avg': {'precision': 0.3487457230503947, 'recall': 0.3493802154143018, 'f1-score': 0.3489042603308939, 'support': 132752}, 'weighted avg': {'precision': 0.35107141918433965, 'recall': 0.35255966011811496, 'f1-score': 0.35165307476287466, 'support': 132752}}
[[13491 14972 14061]
 [14565 20366 13057]
 [14211 15083 12946]]
training model: results/WBA/W6/deepLOB_L2/h1000
Epoch 1/50
1489/1489 - 63s - loss: 3.2739 - accuracy1000: 0.3912 - val_loss: 3.4655 - val_accuracy1000: 0.3300 - 63s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 61s - loss: 3.2181 - accuracy1000: 0.4156 - val_loss: 3.5194 - val_accuracy1000: 0.3272 - 61s/epoch - 41ms/step
Epoch 3/50
1489/1489 - 61s - loss: 3.1790 - accuracy1000: 0.4352 - val_loss: 3.4864 - val_accuracy1000: 0.3252 - 61s/epoch - 41ms/step
Epoch 4/50
1489/1489 - 61s - loss: 3.1633 - accuracy1000: 0.4404 - val_loss: 3.4206 - val_accuracy1000: 0.3293 - 61s/epoch - 41ms/step
Epoch 5/50
1489/1489 - 62s - loss: 3.1499 - accuracy1000: 0.4440 - val_loss: 3.4007 - val_accuracy1000: 0.3290 - 62s/epoch - 41ms/step
Epoch 6/50
1489/1489 - 61s - loss: 3.1350 - accuracy1000: 0.4515 - val_loss: 3.4373 - val_accuracy1000: 0.3291 - 61s/epoch - 41ms/step
Epoch 7/50
1489/1489 - 61s - loss: 3.1256 - accuracy1000: 0.4539 - val_loss: 3.4499 - val_accuracy1000: 0.3265 - 61s/epoch - 41ms/step
Epoch 8/50
1489/1489 - 61s - loss: 3.1125 - accuracy1000: 0.4579 - val_loss: 3.4822 - val_accuracy1000: 0.3256 - 61s/epoch - 41ms/step
Epoch 9/50
1489/1489 - 61s - loss: 3.1032 - accuracy1000: 0.4620 - val_loss: 3.5098 - val_accuracy1000: 0.3334 - 61s/epoch - 41ms/step
Epoch 10/50
1489/1489 - 61s - loss: 3.0946 - accuracy1000: 0.4659 - val_loss: 3.4768 - val_accuracy1000: 0.3208 - 61s/epoch - 41ms/step
Epoch 11/50
1489/1489 - 61s - loss: 3.0863 - accuracy1000: 0.4678 - val_loss: 3.4648 - val_accuracy1000: 0.3254 - 61s/epoch - 41ms/step
Epoch 12/50
1489/1489 - 61s - loss: 3.0769 - accuracy1000: 0.4717 - val_loss: 3.5043 - val_accuracy1000: 0.3281 - 61s/epoch - 41ms/step
Epoch 13/50
1489/1489 - 61s - loss: 3.0658 - accuracy1000: 0.4759 - val_loss: 3.5216 - val_accuracy1000: 0.3240 - 61s/epoch - 41ms/step
Epoch 14/50
1489/1489 - 61s - loss: 3.0582 - accuracy1000: 0.4774 - val_loss: 3.5577 - val_accuracy1000: 0.3253 - 61s/epoch - 41ms/step
Epoch 15/50
1489/1489 - 61s - loss: 3.0468 - accuracy1000: 0.4820 - val_loss: 3.5392 - val_accuracy1000: 0.3318 - 61s/epoch - 41ms/step
testing model: results/WBA/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
5183/5183 - 69s - 69s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1698202
{'0': {'precision': 0.32616074486967894, 'recall': 0.023057533764075246, 'f1-score': 0.04307026778077505, 'support': 454255}, '1': {'precision': 0.26800760591374534, 'recall': 0.9710670856828033, 'f1-score': 0.42007695997752853, 'support': 355754}, '2': {'precision': 0.3968586387434555, 'recall': 0.004399890873418971, 'f1-score': 0.008703290142203494, 'support': 516831}, 'accuracy': 0.2699715112598354, 'macro avg': {'precision': 0.3303423298422933, 'recall': 0.33284150344009916, 'f1-score': 0.15728350596683568, 'support': 1326840}, 'weighted avg': {'precision': 0.33810691124433495, 'recall': 0.2699715112598354, 'f1-score': 0.13076714107057885, 'support': 1326840}}
[[ 10474 441788   1993]
 [  8830 345461   1463]
 [ 12809 501748   2274]]
Evaluating performance on  train set...
1489/1489 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1428787
{'0': {'precision': 0.3986616478460895, 'recall': 0.03581358301146696, 'f1-score': 0.06572297339226245, 'support': 133078}, '1': {'precision': 0.33052253818173644, 'recall': 0.7240202192608154, 'f1-score': 0.4538554721960027, 'support': 121864}, '2': {'precision': 0.3447462438212695, 'recall': 0.27925470763131816, 'f1-score': 0.3085636690174777, 'support': 126125}, 'accuracy': 0.3364736384940181, 'macro avg': {'precision': 0.35797680994969844, 'recall': 0.3463628366345335, 'f1-score': 0.2760473715352476, 'support': 381067}, 'weighted avg': {'precision': 0.35902613809907086, 'recall': 0.3364736384940181, 'f1-score': 0.27022155650218616, 'support': 381067}}
[[ 4766 91384 36928]
 [ 3616 88232 30016]
 [ 3573 87331 35221]]
Evaluating performance on  val set...
519/519 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1369189
{'0': {'precision': 0.2866900498430866, 'recall': 0.035176334684817324, 'f1-score': 0.06266392285034096, 'support': 44149}, '1': {'precision': 0.3318106123340401, 'recall': 0.8177577429410842, 'f1-score': 0.4720740548938373, 'support': 44589}, '2': {'precision': 0.32102728731942215, 'recall': 0.12723224428590904, 'f1-score': 0.1822382765465847, 'support': 44014}, 'accuracy': 0.32855248885139204, 'macro avg': {'precision': 0.3131759831655163, 'recall': 0.32672210730393686, 'f1-score': 0.23899208476358766, 'support': 132752}, 'weighted avg': {'precision': 0.313229762474102, 'recall': 0.32855248885139204, 'f1-score': 0.23982233840169934, 'support': 132752}}
[[ 1553 36930  5666]
 [ 1948 36463  6178]
 [ 1916 36498  5600]]
training model: results/WBA/W6/deepOF_L2/h10
Epoch 1/50
1489/1489 - 36s - loss: 2.9820 - accuracy10: 0.4798 - val_loss: 2.9505 - val_accuracy10: 0.6392 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 34s - loss: 2.7632 - accuracy10: 0.5477 - val_loss: 2.8043 - val_accuracy10: 0.6424 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 34s - loss: 2.6871 - accuracy10: 0.5625 - val_loss: 2.7791 - val_accuracy10: 0.6380 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 34s - loss: 2.6523 - accuracy10: 0.5676 - val_loss: 2.7514 - val_accuracy10: 0.6394 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 34s - loss: 2.6302 - accuracy10: 0.5719 - val_loss: 2.7518 - val_accuracy10: 0.6432 - 34s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 34s - loss: 2.6132 - accuracy10: 0.5743 - val_loss: 2.7396 - val_accuracy10: 0.6435 - 34s/epoch - 23ms/step
Epoch 7/50
1489/1489 - 33s - loss: 2.6010 - accuracy10: 0.5762 - val_loss: 2.7292 - val_accuracy10: 0.6400 - 33s/epoch - 22ms/step
Epoch 8/50
1489/1489 - 34s - loss: 2.5913 - accuracy10: 0.5780 - val_loss: 2.7390 - val_accuracy10: 0.6432 - 34s/epoch - 23ms/step
Epoch 9/50
1489/1489 - 34s - loss: 2.5802 - accuracy10: 0.5794 - val_loss: 2.7349 - val_accuracy10: 0.6403 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 2.5714 - accuracy10: 0.5810 - val_loss: 2.7252 - val_accuracy10: 0.6404 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 34s - loss: 2.5643 - accuracy10: 0.5817 - val_loss: 2.7309 - val_accuracy10: 0.6416 - 34s/epoch - 23ms/step
Epoch 12/50
1489/1489 - 34s - loss: 2.5567 - accuracy10: 0.5833 - val_loss: 2.7329 - val_accuracy10: 0.6437 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 33s - loss: 2.5499 - accuracy10: 0.5830 - val_loss: 2.7302 - val_accuracy10: 0.6383 - 33s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 34s - loss: 2.5446 - accuracy10: 0.5846 - val_loss: 2.7188 - val_accuracy10: 0.6417 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 34s - loss: 2.5379 - accuracy10: 0.5851 - val_loss: 2.7184 - val_accuracy10: 0.6406 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 33s - loss: 2.5329 - accuracy10: 0.5856 - val_loss: 2.7327 - val_accuracy10: 0.6412 - 33s/epoch - 22ms/step
Epoch 17/50
1489/1489 - 34s - loss: 2.5278 - accuracy10: 0.5859 - val_loss: 2.7248 - val_accuracy10: 0.6390 - 34s/epoch - 23ms/step
Epoch 18/50
1489/1489 - 34s - loss: 2.5220 - accuracy10: 0.5864 - val_loss: 2.7340 - val_accuracy10: 0.6383 - 34s/epoch - 23ms/step
Epoch 19/50
1489/1489 - 33s - loss: 2.5187 - accuracy10: 0.5870 - val_loss: 2.7201 - val_accuracy10: 0.6398 - 33s/epoch - 22ms/step
Epoch 20/50
1489/1489 - 34s - loss: 2.5111 - accuracy10: 0.5885 - val_loss: 2.7331 - val_accuracy10: 0.6408 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 34s - loss: 2.5066 - accuracy10: 0.5889 - val_loss: 2.7295 - val_accuracy10: 0.6416 - 34s/epoch - 23ms/step
Epoch 22/50
1489/1489 - 33s - loss: 2.5019 - accuracy10: 0.5891 - val_loss: 2.7167 - val_accuracy10: 0.6351 - 33s/epoch - 22ms/step
Epoch 23/50
1489/1489 - 34s - loss: 2.4980 - accuracy10: 0.5894 - val_loss: 2.7468 - val_accuracy10: 0.6415 - 34s/epoch - 23ms/step
Epoch 24/50
1489/1489 - 33s - loss: 2.4930 - accuracy10: 0.5903 - val_loss: 2.7687 - val_accuracy10: 0.6393 - 33s/epoch - 22ms/step
Epoch 25/50
1489/1489 - 33s - loss: 2.4884 - accuracy10: 0.5907 - val_loss: 2.7455 - val_accuracy10: 0.6391 - 33s/epoch - 22ms/step
Epoch 26/50
1489/1489 - 33s - loss: 2.4841 - accuracy10: 0.5915 - val_loss: 2.7323 - val_accuracy10: 0.6387 - 33s/epoch - 22ms/step
Epoch 27/50
1489/1489 - 33s - loss: 2.4821 - accuracy10: 0.5917 - val_loss: 2.7381 - val_accuracy10: 0.6421 - 33s/epoch - 22ms/step
Epoch 28/50
1489/1489 - 34s - loss: 2.4758 - accuracy10: 0.5926 - val_loss: 2.7508 - val_accuracy10: 0.6406 - 34s/epoch - 23ms/step
Epoch 29/50
1489/1489 - 33s - loss: 2.4737 - accuracy10: 0.5931 - val_loss: 2.7500 - val_accuracy10: 0.6453 - 33s/epoch - 22ms/step
Epoch 30/50
1489/1489 - 34s - loss: 2.4680 - accuracy10: 0.5931 - val_loss: 2.7676 - val_accuracy10: 0.6431 - 34s/epoch - 23ms/step
Epoch 31/50
1489/1489 - 34s - loss: 2.4638 - accuracy10: 0.5937 - val_loss: 2.7450 - val_accuracy10: 0.6407 - 34s/epoch - 23ms/step
Epoch 32/50
1489/1489 - 34s - loss: 2.4598 - accuracy10: 0.5947 - val_loss: 2.7727 - val_accuracy10: 0.6419 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h10
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90062326
{'0': {'precision': 0.4669444768556332, 'recall': 0.459421340409411, 'f1-score': 0.46315236045115915, 'support': 304877}, '1': {'precision': 0.7247527560700717, 'recall': 0.6844423955857434, 'f1-score': 0.7040210321318598, 'support': 709338}, '2': {'precision': 0.4364665182010449, 'recall': 0.49840701170750434, 'f1-score': 0.4653848164216217, 'support': 312620}, 'accuracy': 0.588905176604476, 'macro avg': {'precision': 0.5427212503755833, 'recall': 0.547423582567553, 'f1-score': 0.5441860696682136, 'support': 1326835}, 'weighted avg': {'precision': 0.5975901032724928, 'recall': 0.588905176604476, 'f1-score': 0.5924489287645748, 'support': 1326835}}
[[140067  89411  75399]
 [ 98063 485501 125774]
 [ 61835  94973 155812]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83630407
{'0': {'precision': 0.46084889066802526, 'recall': 0.47259541225058466, 'f1-score': 0.4666482419775833, 'support': 80388}, '1': {'precision': 0.7502539968561899, 'recall': 0.7093545390697569, 'f1-score': 0.7292312493740668, 'support': 220695}, '2': {'precision': 0.45141389889289046, 'recall': 0.5077517441424321, 'f1-score': 0.4779282831016911, 'support': 79982}, 'accuracy': 0.6170941965281513, 'macro avg': {'precision': 0.5541722621390351, 'recall': 0.5632338984875912, 'f1-score': 0.5579359248177804, 'support': 381065}, 'weighted avg': {'precision': 0.6264784562225584, 'recall': 0.6170941965281513, 'f1-score': 0.6210915969604742, 'support': 381065}}
[[ 37991  26864  15533]
 [ 30324 156551  33820]
 [ 14122  25249  40611]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8118996
{'0': {'precision': 0.44521201480859507, 'recall': 0.4553972281866094, 'f1-score': 0.4502470279450363, 'support': 25615}, '1': {'precision': 0.7711540687579581, 'recall': 0.7338620841595065, 'f1-score': 0.7520460574589377, 'support': 81702}, '2': {'precision': 0.43532761554220634, 'recall': 0.49292285916489736, 'f1-score': 0.46233842863201374, 'support': 25434}, 'accuracy': 0.633968858991646, 'macro avg': {'precision': 0.5505645663695865, 'recall': 0.560727390503671, 'f1-score': 0.5548771713453292, 'support': 132751}, 'weighted avg': {'precision': 0.6439202571633007, 'recall': 0.633968858991646, 'f1-score': 0.6383067562666109, 'support': 132751}}
[[11665  9220  4730]
 [10212 59958 11532]
 [ 4324  8573 12537]]
training model: results/WBA/W6/deepOF_L2/h20
Epoch 1/50
1489/1489 - 35s - loss: 3.0396 - accuracy20: 0.4725 - val_loss: 3.0641 - val_accuracy20: 0.5641 - 35s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 33s - loss: 2.8565 - accuracy20: 0.5304 - val_loss: 2.9392 - val_accuracy20: 0.5784 - 33s/epoch - 22ms/step
Epoch 3/50
1489/1489 - 34s - loss: 2.7859 - accuracy20: 0.5493 - val_loss: 2.9121 - val_accuracy20: 0.5837 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 34s - loss: 2.7516 - accuracy20: 0.5566 - val_loss: 2.8912 - val_accuracy20: 0.5871 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 33s - loss: 2.7318 - accuracy20: 0.5590 - val_loss: 2.8855 - val_accuracy20: 0.5907 - 33s/epoch - 22ms/step
Epoch 6/50
1489/1489 - 33s - loss: 2.7162 - accuracy20: 0.5635 - val_loss: 2.8856 - val_accuracy20: 0.5916 - 33s/epoch - 22ms/step
Epoch 7/50
1489/1489 - 34s - loss: 2.7048 - accuracy20: 0.5653 - val_loss: 2.8858 - val_accuracy20: 0.5943 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 34s - loss: 2.6959 - accuracy20: 0.5662 - val_loss: 2.8841 - val_accuracy20: 0.5945 - 34s/epoch - 23ms/step
Epoch 9/50
1489/1489 - 33s - loss: 2.6888 - accuracy20: 0.5674 - val_loss: 2.8827 - val_accuracy20: 0.5951 - 33s/epoch - 22ms/step
Epoch 10/50
1489/1489 - 34s - loss: 2.6807 - accuracy20: 0.5689 - val_loss: 2.8809 - val_accuracy20: 0.5932 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 33s - loss: 2.6737 - accuracy20: 0.5696 - val_loss: 2.8945 - val_accuracy20: 0.5939 - 33s/epoch - 22ms/step
Epoch 12/50
1489/1489 - 33s - loss: 2.6676 - accuracy20: 0.5719 - val_loss: 2.8818 - val_accuracy20: 0.5938 - 33s/epoch - 22ms/step
Epoch 13/50
1489/1489 - 34s - loss: 2.6622 - accuracy20: 0.5716 - val_loss: 2.8898 - val_accuracy20: 0.5955 - 34s/epoch - 23ms/step
Epoch 14/50
1489/1489 - 34s - loss: 2.6577 - accuracy20: 0.5727 - val_loss: 2.8806 - val_accuracy20: 0.5944 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 34s - loss: 2.6505 - accuracy20: 0.5739 - val_loss: 2.8900 - val_accuracy20: 0.5940 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 34s - loss: 2.6461 - accuracy20: 0.5746 - val_loss: 2.8936 - val_accuracy20: 0.5947 - 34s/epoch - 23ms/step
Epoch 17/50
1489/1489 - 33s - loss: 2.6407 - accuracy20: 0.5756 - val_loss: 2.8802 - val_accuracy20: 0.5943 - 33s/epoch - 22ms/step
Epoch 18/50
1489/1489 - 33s - loss: 2.6363 - accuracy20: 0.5762 - val_loss: 2.8928 - val_accuracy20: 0.5939 - 33s/epoch - 22ms/step
Epoch 19/50
1489/1489 - 34s - loss: 2.6320 - accuracy20: 0.5772 - val_loss: 2.8828 - val_accuracy20: 0.5914 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 33s - loss: 2.6266 - accuracy20: 0.5784 - val_loss: 2.8879 - val_accuracy20: 0.5928 - 33s/epoch - 22ms/step
Epoch 21/50
1489/1489 - 34s - loss: 2.6232 - accuracy20: 0.5785 - val_loss: 2.9062 - val_accuracy20: 0.5933 - 34s/epoch - 23ms/step
Epoch 22/50
1489/1489 - 34s - loss: 2.6196 - accuracy20: 0.5790 - val_loss: 2.9129 - val_accuracy20: 0.5928 - 34s/epoch - 23ms/step
Epoch 23/50
1489/1489 - 34s - loss: 2.6147 - accuracy20: 0.5802 - val_loss: 2.9053 - val_accuracy20: 0.5929 - 34s/epoch - 23ms/step
Epoch 24/50
1489/1489 - 33s - loss: 2.6104 - accuracy20: 0.5805 - val_loss: 2.9246 - val_accuracy20: 0.5914 - 33s/epoch - 22ms/step
Epoch 25/50
1489/1489 - 33s - loss: 2.6064 - accuracy20: 0.5816 - val_loss: 2.9335 - val_accuracy20: 0.5921 - 33s/epoch - 22ms/step
Epoch 26/50
1489/1489 - 33s - loss: 2.6019 - accuracy20: 0.5825 - val_loss: 2.9279 - val_accuracy20: 0.5901 - 33s/epoch - 22ms/step
Epoch 27/50
1489/1489 - 33s - loss: 2.5977 - accuracy20: 0.5835 - val_loss: 2.9176 - val_accuracy20: 0.5906 - 33s/epoch - 22ms/step
testing model: results/WBA/W6/deepOF_L2/h20
Evaluating performance on  test set...
5183/5183 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9750494
{'0': {'precision': 0.5238898026315789, 'recall': 0.43566765391312584, 'f1-score': 0.4757231360452192, 'support': 380182}, '1': {'precision': 0.5905419784493514, 'recall': 0.7334394830721445, 'f1-score': 0.6542792569142957, 'support': 561471}, '2': {'precision': 0.4975442090246728, 'recall': 0.4047463277100176, 'f1-score': 0.44637327618417716, 'support': 385182}, 'accuracy': 0.5526979616907904, 'macro avg': {'precision': 0.537325330035201, 'recall': 0.524617821565096, 'f1-score': 0.5254585563812307, 'support': 1326835}, 'weighted avg': {'precision': 0.5444465526207526, 'recall': 0.5526979616907904, 'f1-score': 0.5427616495148558, 'support': 1326835}}
[[165633 137732  76817]
 [ 69043 411805  80623]
 [ 81484 147797 155901]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92188376
{'0': {'precision': 0.5261265310709068, 'recall': 0.41336891051423413, 'f1-score': 0.46298117332952443, 'support': 101938}, '1': {'precision': 0.6222597275636592, 'recall': 0.7593382477069383, 'f1-score': 0.6839987023782974, 'support': 177710}, '2': {'precision': 0.512054781492225, 'recall': 0.4247019730419949, 'f1-score': 0.46430554133226976, 'support': 101417}, 'accuracy': 0.5777282090981853, 'macro avg': {'precision': 0.5534803467089304, 'recall': 0.5324697104210557, 'f1-score': 0.5370951390133638, 'support': 381065}, 'weighted avg': {'precision': 0.5672132635750882, 'recall': 0.5777282090981853, 'f1-score': 0.5664053621608048, 'support': 381065}}
[[ 42138  41882  17918]
 [ 19642 134942  23126]
 [ 18311  40034  43072]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8955445
{'0': {'precision': 0.5107735782409043, 'recall': 0.39568257829127396, 'f1-score': 0.44592163648512056, 'support': 32890}, '1': {'precision': 0.651177214875828, 'recall': 0.7815445084639778, 'f1-score': 0.7104296222112451, 'support': 67167}, '2': {'precision': 0.5025883412108936, 'recall': 0.40979996329601764, 'f1-score': 0.45147594015365955, 'support': 32694}, 'accuracy': 0.5943910027043111, 'macro avg': {'precision': 0.5548463781092087, 'recall': 0.5290090166837564, 'f1-score': 0.5359423996166751, 'support': 132751}, 'weighted avg': {'precision': 0.5797966584617594, 'recall': 0.5943910027043111, 'f1-score': 0.5811206201568505, 'support': 132751}}
[[13014 14448  5428]
 [ 6841 52494  7832]
 [ 5624 13672 13398]]
training model: results/WBA/W6/deepOF_L2/h30
Epoch 1/50
1489/1489 - 37s - loss: 3.0836 - accuracy30: 0.4613 - val_loss: 3.2318 - val_accuracy30: 0.5004 - 37s/epoch - 25ms/step
Epoch 2/50
1489/1489 - 34s - loss: 2.9099 - accuracy30: 0.5165 - val_loss: 3.0897 - val_accuracy30: 0.5205 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 34s - loss: 2.8468 - accuracy30: 0.5340 - val_loss: 3.0444 - val_accuracy30: 0.5305 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 33s - loss: 2.8141 - accuracy30: 0.5417 - val_loss: 3.0346 - val_accuracy30: 0.5349 - 33s/epoch - 22ms/step
Epoch 5/50
1489/1489 - 33s - loss: 2.7956 - accuracy30: 0.5452 - val_loss: 3.0290 - val_accuracy30: 0.5361 - 33s/epoch - 22ms/step
Epoch 6/50
1489/1489 - 33s - loss: 2.7813 - accuracy30: 0.5477 - val_loss: 3.0295 - val_accuracy30: 0.5369 - 33s/epoch - 22ms/step
Epoch 7/50
1489/1489 - 34s - loss: 2.7717 - accuracy30: 0.5502 - val_loss: 3.0232 - val_accuracy30: 0.5397 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 33s - loss: 2.7636 - accuracy30: 0.5520 - val_loss: 3.0286 - val_accuracy30: 0.5400 - 33s/epoch - 22ms/step
Epoch 9/50
1489/1489 - 34s - loss: 2.7550 - accuracy30: 0.5531 - val_loss: 3.0393 - val_accuracy30: 0.5403 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 2.7482 - accuracy30: 0.5551 - val_loss: 3.0335 - val_accuracy30: 0.5418 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 34s - loss: 2.7414 - accuracy30: 0.5565 - val_loss: 3.0384 - val_accuracy30: 0.5432 - 34s/epoch - 23ms/step
Epoch 12/50
1489/1489 - 33s - loss: 2.7363 - accuracy30: 0.5577 - val_loss: 3.0161 - val_accuracy30: 0.5449 - 33s/epoch - 22ms/step
Epoch 13/50
1489/1489 - 33s - loss: 2.7313 - accuracy30: 0.5587 - val_loss: 3.0293 - val_accuracy30: 0.5446 - 33s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 33s - loss: 2.7260 - accuracy30: 0.5595 - val_loss: 3.0269 - val_accuracy30: 0.5458 - 33s/epoch - 22ms/step
Epoch 15/50
1489/1489 - 33s - loss: 2.7219 - accuracy30: 0.5605 - val_loss: 3.0381 - val_accuracy30: 0.5441 - 33s/epoch - 22ms/step
Epoch 16/50
1489/1489 - 33s - loss: 2.7153 - accuracy30: 0.5625 - val_loss: 3.0334 - val_accuracy30: 0.5446 - 33s/epoch - 22ms/step
Epoch 17/50
1489/1489 - 33s - loss: 2.7116 - accuracy30: 0.5625 - val_loss: 3.0398 - val_accuracy30: 0.5445 - 33s/epoch - 22ms/step
Epoch 18/50
1489/1489 - 34s - loss: 2.7070 - accuracy30: 0.5637 - val_loss: 3.0380 - val_accuracy30: 0.5453 - 34s/epoch - 23ms/step
Epoch 19/50
1489/1489 - 34s - loss: 2.7023 - accuracy30: 0.5646 - val_loss: 3.0613 - val_accuracy30: 0.5456 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 34s - loss: 2.6987 - accuracy30: 0.5656 - val_loss: 3.0484 - val_accuracy30: 0.5442 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 33s - loss: 2.6946 - accuracy30: 0.5671 - val_loss: 3.0549 - val_accuracy30: 0.5468 - 33s/epoch - 22ms/step
Epoch 22/50
1489/1489 - 33s - loss: 2.6890 - accuracy30: 0.5681 - val_loss: 3.0575 - val_accuracy30: 0.5453 - 33s/epoch - 22ms/step
testing model: results/WBA/W6/deepOF_L2/h30
Evaluating performance on  test set...
5183/5183 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0373769
{'0': {'precision': 0.5309547202309475, 'recall': 0.41010326711964606, 'f1-score': 0.4627690713775054, 'support': 426951}, '1': {'precision': 0.4900033989406864, 'recall': 0.761836705876312, 'f1-score': 0.5964061606282225, 'support': 467402}, '2': {'precision': 0.5283171700583653, 'recall': 0.33027732946111055, 'f1-score': 0.40645772627936627, 'support': 432482}, 'accuracy': 0.5079885592405988, 'macro avg': {'precision': 0.5164250964099998, 'recall': 0.5007391008190228, 'f1-score': 0.48854431942836474, 'support': 1326835}, 'weighted avg': {'precision': 0.5156691553736372, 'recall': 0.5079885592405988, 'f1-score': 0.4914905021803032, 'support': 1326835}}
[[175094 182188  69669]
 [ 53460 356084  57858]
 [101218 188425 142839]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.99927056
{'0': {'precision': 0.535638272142408, 'recall': 0.38051424791457267, 'f1-score': 0.44494336874356466, 'support': 116403}, '1': {'precision': 0.5203178196623495, 'recall': 0.7961533297529538, 'f1-score': 0.6293381588164123, 'support': 148960}, '2': {'precision': 0.5456171481297466, 'recall': 0.3321982333926812, 'f1-score': 0.4129639478476687, 'support': 115702}, 'accuracy': 0.528319315602325, 'macro avg': {'precision': 0.5338577466448347, 'recall': 0.5029552703534025, 'f1-score': 0.4957484918025486, 'support': 381065}, 'weighted avg': {'precision': 0.5326793053206258, 'recall': 0.528319315602325, 'f1-score': 0.5073142634013118, 'support': 381065}}
[[ 44293  55466  16644]
 [ 15000 118595  15365]
 [ 23399  53867  38436]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9738424
{'0': {'precision': 0.5265650265650266, 'recall': 0.3606043028896857, 'f1-score': 0.4280617195079966, 'support': 37928}, '1': {'precision': 0.5525686977299881, 'recall': 0.8109766789409083, 'f1-score': 0.6572870034818447, 'support': 57030}, '2': {'precision': 0.5388482038393205, 'recall': 0.3290291852988649, 'f1-score': 0.4085756530310498, 'support': 37793}, 'accuracy': 0.545095705493744, 'macro avg': {'precision': 0.5393273093781118, 'recall': 0.500203389043153, 'f1-score': 0.4979747920069637, 'support': 132751}, 'weighted avg': {'precision': 0.5412331457149022, 'recall': 0.545095705493744, 'f1-score': 0.5209896901798959, 'support': 132751}}
[[13677 19069  5182]
 [ 5320 46250  5460]
 [ 6977 18381 12435]]
training model: results/WBA/W6/deepOF_L2/h50
Epoch 1/50
1489/1489 - 36s - loss: 3.1430 - accuracy50: 0.4413 - val_loss: 3.2667 - val_accuracy50: 0.4317 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 33s - loss: 3.0174 - accuracy50: 0.4841 - val_loss: 3.1992 - val_accuracy50: 0.4496 - 33s/epoch - 22ms/step
Epoch 3/50
1489/1489 - 33s - loss: 2.9683 - accuracy50: 0.4971 - val_loss: 3.1457 - val_accuracy50: 0.4634 - 33s/epoch - 22ms/step
Epoch 4/50
1489/1489 - 33s - loss: 2.9400 - accuracy50: 0.5048 - val_loss: 3.1419 - val_accuracy50: 0.4669 - 33s/epoch - 22ms/step
Epoch 5/50
1489/1489 - 33s - loss: 2.9215 - accuracy50: 0.5088 - val_loss: 3.1380 - val_accuracy50: 0.4700 - 33s/epoch - 22ms/step
Epoch 6/50
1489/1489 - 33s - loss: 2.9086 - accuracy50: 0.5124 - val_loss: 3.1395 - val_accuracy50: 0.4697 - 33s/epoch - 22ms/step
Epoch 7/50
1489/1489 - 33s - loss: 2.9006 - accuracy50: 0.5140 - val_loss: 3.1258 - val_accuracy50: 0.4723 - 33s/epoch - 22ms/step
Epoch 8/50
1489/1489 - 33s - loss: 2.8919 - accuracy50: 0.5165 - val_loss: 3.1199 - val_accuracy50: 0.4775 - 33s/epoch - 22ms/step
Epoch 9/50
1489/1489 - 33s - loss: 2.8863 - accuracy50: 0.5181 - val_loss: 3.1239 - val_accuracy50: 0.4776 - 33s/epoch - 22ms/step
Epoch 10/50
1489/1489 - 33s - loss: 2.8802 - accuracy50: 0.5196 - val_loss: 3.1249 - val_accuracy50: 0.4766 - 33s/epoch - 22ms/step
Epoch 11/50
1489/1489 - 33s - loss: 2.8748 - accuracy50: 0.5210 - val_loss: 3.1250 - val_accuracy50: 0.4777 - 33s/epoch - 22ms/step
Epoch 12/50
1489/1489 - 33s - loss: 2.8696 - accuracy50: 0.5221 - val_loss: 3.1217 - val_accuracy50: 0.4790 - 33s/epoch - 22ms/step
Epoch 13/50
1489/1489 - 33s - loss: 2.8651 - accuracy50: 0.5241 - val_loss: 3.1270 - val_accuracy50: 0.4779 - 33s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 33s - loss: 2.8613 - accuracy50: 0.5243 - val_loss: 3.1183 - val_accuracy50: 0.4787 - 33s/epoch - 22ms/step
Epoch 15/50
1489/1489 - 34s - loss: 2.8556 - accuracy50: 0.5263 - val_loss: 3.1219 - val_accuracy50: 0.4807 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 33s - loss: 2.8519 - accuracy50: 0.5269 - val_loss: 3.1212 - val_accuracy50: 0.4815 - 33s/epoch - 22ms/step
Epoch 17/50
1489/1489 - 33s - loss: 2.8491 - accuracy50: 0.5275 - val_loss: 3.1310 - val_accuracy50: 0.4793 - 33s/epoch - 22ms/step
Epoch 18/50
1489/1489 - 33s - loss: 2.8448 - accuracy50: 0.5294 - val_loss: 3.1337 - val_accuracy50: 0.4797 - 33s/epoch - 22ms/step
Epoch 19/50
1489/1489 - 34s - loss: 2.8401 - accuracy50: 0.5303 - val_loss: 3.1410 - val_accuracy50: 0.4806 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 34s - loss: 2.8342 - accuracy50: 0.5321 - val_loss: 3.1308 - val_accuracy50: 0.4811 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 34s - loss: 2.8307 - accuracy50: 0.5333 - val_loss: 3.1239 - val_accuracy50: 0.4822 - 34s/epoch - 23ms/step
Epoch 22/50
1489/1489 - 34s - loss: 2.8253 - accuracy50: 0.5340 - val_loss: 3.1355 - val_accuracy50: 0.4812 - 34s/epoch - 23ms/step
Epoch 23/50
1489/1489 - 34s - loss: 2.8212 - accuracy50: 0.5355 - val_loss: 3.1411 - val_accuracy50: 0.4805 - 34s/epoch - 23ms/step
Epoch 24/50
1489/1489 - 33s - loss: 2.8180 - accuracy50: 0.5361 - val_loss: 3.1637 - val_accuracy50: 0.4796 - 33s/epoch - 22ms/step
testing model: results/WBA/W6/deepOF_L2/h50
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0835347
{'0': {'precision': 0.5021323988001545, 'recall': 0.3704223840081677, 'f1-score': 0.42633673877220124, 'support': 456433}, '1': {'precision': 0.4056612044402615, 'recall': 0.7707342285627502, 'f1-score': 0.5315508147867837, 'support': 408238}, '2': {'precision': 0.5294062798666636, 'recall': 0.2457028241057287, 'f1-score': 0.33563434462557945, 'support': 462164}, 'accuracy': 0.45014715469519573, 'macro avg': {'precision': 0.47906662770235986, 'recall': 0.46228647889221547, 'f1-score': 0.4311739660615215, 'support': 1326835}, 'weighted avg': {'precision': 0.48195038560795506, 'recall': 0.45014715469519573, 'f1-score': 0.42711528521969605, 'support': 1326835}}
[[169073 229689  57671]
 [ 50326 314643  43269]
 [117311 231298 113555]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0580747
{'0': {'precision': 0.5215941388239752, 'recall': 0.3214686098654709, 'f1-score': 0.39777855914610355, 'support': 128448}, '1': {'precision': 0.42450754141597297, 'recall': 0.8213021431305013, 'f1-score': 0.5597146303561144, 'support': 125424}, '2': {'precision': 0.549291019581364, 'recall': 0.25583168885080154, 'f1-score': 0.3490798302875564, 'support': 127193}, 'accuracy': 0.4640756826263236, 'macro avg': {'precision': 0.49846423327377076, 'recall': 0.4662008139489246, 'f1-score': 0.43552433992992473, 'support': 381065}, 'weighted avg': {'precision': 0.4988837349844026, 'recall': 0.4640756826263236, 'f1-score': 0.43482350522023583, 'support': 381065}}
[[ 41292  71305  15851]
 [ 11564 103011  10849]
 [ 26309  68344  32540]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0415032
{'0': {'precision': 0.5173588578844905, 'recall': 0.3002754172453567, 'f1-score': 0.37999910630501804, 'support': 42481}, '1': {'precision': 0.45353777315766874, 'recall': 0.8338665447897623, 'f1-score': 0.5875232365813317, 'support': 48136}, '2': {'precision': 0.5486653396621243, 'recall': 0.2551383680637965, 'f1-score': 0.3483078717579017, 'support': 42134}, 'accuracy': 0.4794314167124918, 'macro avg': {'precision': 0.5065206569014279, 'recall': 0.46309344336630515, 'f1-score': 0.4386100715480838, 'support': 132751}, 'weighted avg': {'precision': 0.5041535002510906, 'recall': 0.4794314167124918, 'f1-score': 0.4451895987199334, 'support': 132751}}
[[12756 24866  4859]
 [ 4013 40139  3984]
 [ 7887 23497 10750]]
training model: results/WBA/W6/deepOF_L2/h100
Epoch 1/50
1489/1489 - 36s - loss: 3.2444 - accuracy100: 0.3975 - val_loss: 3.2767 - val_accuracy100: 0.3718 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 33s - loss: 3.1908 - accuracy100: 0.4231 - val_loss: 3.2672 - val_accuracy100: 0.3765 - 33s/epoch - 22ms/step
Epoch 3/50
1489/1489 - 34s - loss: 3.1739 - accuracy100: 0.4303 - val_loss: 3.2618 - val_accuracy100: 0.3800 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 34s - loss: 3.1649 - accuracy100: 0.4341 - val_loss: 3.2565 - val_accuracy100: 0.3825 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 33s - loss: 3.1566 - accuracy100: 0.4374 - val_loss: 3.2501 - val_accuracy100: 0.3865 - 33s/epoch - 22ms/step
Epoch 6/50
1489/1489 - 33s - loss: 3.1495 - accuracy100: 0.4400 - val_loss: 3.2490 - val_accuracy100: 0.3880 - 33s/epoch - 22ms/step
Epoch 7/50
1489/1489 - 34s - loss: 3.1442 - accuracy100: 0.4419 - val_loss: 3.2514 - val_accuracy100: 0.3900 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 33s - loss: 3.1387 - accuracy100: 0.4442 - val_loss: 3.2509 - val_accuracy100: 0.3910 - 33s/epoch - 22ms/step
Epoch 9/50
1489/1489 - 34s - loss: 3.1336 - accuracy100: 0.4458 - val_loss: 3.2524 - val_accuracy100: 0.3929 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 3.1300 - accuracy100: 0.4478 - val_loss: 3.2548 - val_accuracy100: 0.3942 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 33s - loss: 3.1250 - accuracy100: 0.4485 - val_loss: 3.2595 - val_accuracy100: 0.3937 - 33s/epoch - 22ms/step
Epoch 12/50
1489/1489 - 34s - loss: 3.1211 - accuracy100: 0.4501 - val_loss: 3.2605 - val_accuracy100: 0.3947 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 33s - loss: 3.1162 - accuracy100: 0.4522 - val_loss: 3.2661 - val_accuracy100: 0.3943 - 33s/epoch - 22ms/step
Epoch 14/50
1489/1489 - 34s - loss: 3.1127 - accuracy100: 0.4531 - val_loss: 3.2624 - val_accuracy100: 0.3952 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 33s - loss: 3.1093 - accuracy100: 0.4545 - val_loss: 3.2645 - val_accuracy100: 0.3963 - 33s/epoch - 22ms/step
Epoch 16/50
1489/1489 - 34s - loss: 3.1059 - accuracy100: 0.4553 - val_loss: 3.2670 - val_accuracy100: 0.3966 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h100
Evaluating performance on  test set...
5183/5183 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0823683
{'0': {'precision': 0.39092847839466416, 'recall': 0.20209646191221992, 'f1-score': 0.2664483632118573, 'support': 405445}, '1': {'precision': 0.3833108646185554, 'recall': 0.6673090699950559, 'f1-score': 0.48692549638643634, 'support': 495535}, '2': {'precision': 0.40293769863250484, 'recall': 0.24085428138685702, 'f1-score': 0.3014926338314658, 'support': 425855}, 'accuracy': 0.38827962783616654, 'macro avg': {'precision': 0.39239234721524147, 'recall': 0.3700866044313776, 'f1-score': 0.35162216447658645, 'support': 1326835}, 'weighted avg': {'precision': 0.3919379424514923, 'recall': 0.38827962783616654, 'f1-score': 0.3600379309066938, 'support': 1326835}}
[[ 81939 262476  61030]
 [ 73906 330675  90954]
 [ 53756 269530 102569]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897706
{'0': {'precision': 0.4568260245822186, 'recall': 0.18193891102257637, 'f1-score': 0.2602347900032027, 'support': 129516}, '1': {'precision': 0.34966973544611385, 'recall': 0.7348891108891109, 'f1-score': 0.4738672905672824, 'support': 125125}, '2': {'precision': 0.44748316093336543, 'recall': 0.23542207175852686, 'f1-score': 0.30852717999751217, 'support': 126424}, 'accuracy': 0.3812472937687796, 'macro avg': {'precision': 0.41799297365389926, 'recall': 0.3840833645567381, 'f1-score': 0.34754308685599905, 'support': 381065}, 'weighted avg': {'precision': 0.4185409738110963, 'recall': 0.3812472937687796, 'f1-score': 0.3464040360523572, 'support': 381065}}
[[23564 87820 18132]
 [14555 91953 18617]
 [13463 83198 29763]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0839288
{'0': {'precision': 0.43332055424722055, 'recall': 0.18359438449936188, 'f1-score': 0.25791309450076605, 'support': 43095}, '1': {'precision': 0.36589968477258594, 'recall': 0.7292815318203189, 'f1-score': 0.48730544052548913, 'support': 46794}, '2': {'precision': 0.444643361914633, 'recall': 0.22019504456161634, 'f1-score': 0.2945325177880414, 'support': 42862}, 'accuracy': 0.3877635573366679, 'macro avg': {'precision': 0.4146212003114798, 'recall': 0.37769032029376565, 'f1-score': 0.3465836842714322, 'support': 132751}, 'weighted avg': {'precision': 0.41321092054234887, 'recall': 0.3877635573366679, 'f1-score': 0.3505961414143116, 'support': 132751}}
[[ 7912 29956  5227]
 [ 6107 34126  6561]
 [ 4240 29184  9438]]
training model: results/WBA/W6/deepOF_L2/h200
Epoch 1/50
1489/1489 - 36s - loss: 3.2907 - accuracy200: 0.3681 - val_loss: 3.3321 - val_accuracy200: 0.3384 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 34s - loss: 3.2555 - accuracy200: 0.3867 - val_loss: 3.3216 - val_accuracy200: 0.3444 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 34s - loss: 3.2432 - accuracy200: 0.3921 - val_loss: 3.3179 - val_accuracy200: 0.3488 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 33s - loss: 3.2372 - accuracy200: 0.3941 - val_loss: 3.3234 - val_accuracy200: 0.3453 - 33s/epoch - 22ms/step
Epoch 5/50
1489/1489 - 34s - loss: 3.2325 - accuracy200: 0.3972 - val_loss: 3.3239 - val_accuracy200: 0.3472 - 34s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 34s - loss: 3.2282 - accuracy200: 0.4003 - val_loss: 3.3260 - val_accuracy200: 0.3475 - 34s/epoch - 23ms/step
Epoch 7/50
1489/1489 - 34s - loss: 3.2238 - accuracy200: 0.4019 - val_loss: 3.3286 - val_accuracy200: 0.3488 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 33s - loss: 3.2203 - accuracy200: 0.4036 - val_loss: 3.3296 - val_accuracy200: 0.3507 - 33s/epoch - 22ms/step
Epoch 9/50
1489/1489 - 33s - loss: 3.2168 - accuracy200: 0.4051 - val_loss: 3.3303 - val_accuracy200: 0.3534 - 33s/epoch - 22ms/step
Epoch 10/50
1489/1489 - 34s - loss: 3.2125 - accuracy200: 0.4074 - val_loss: 3.3308 - val_accuracy200: 0.3574 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 33s - loss: 3.2097 - accuracy200: 0.4096 - val_loss: 3.3350 - val_accuracy200: 0.3600 - 33s/epoch - 22ms/step
Epoch 12/50
1489/1489 - 34s - loss: 3.2060 - accuracy200: 0.4113 - val_loss: 3.3356 - val_accuracy200: 0.3646 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 34s - loss: 3.2020 - accuracy200: 0.4141 - val_loss: 3.3372 - val_accuracy200: 0.3675 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h200
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192129
{'0': {'precision': 0.42960587223912183, 'recall': 0.08692113343784355, 'f1-score': 0.1445881006652781, 'support': 448441}, '1': {'precision': 0.2996247296610557, 'recall': 0.8509825883311272, 'f1-score': 0.44320147106297425, 'support': 392840}, '2': {'precision': 0.45410138401980493, 'recall': 0.11257656203017584, 'f1-score': 0.1804240767880012, 'support': 485554}, 'accuracy': 0.3225276692278995, 'macro avg': {'precision': 0.3944439953066608, 'recall': 0.3501600945997155, 'f1-score': 0.25607121617208456, 'support': 1326835}, 'weighted avg': {'precision': 0.4000860763917032, 'recall': 0.3225276692278995, 'f1-score': 0.2461135940215158, 'support': 1326835}}
[[ 38979 377498  31964]
 [ 24792 334300  33748]
 [ 26961 403931  54662]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1091963
{'0': {'precision': 0.42755106135387827, 'recall': 0.08217963055801936, 'f1-score': 0.1378609874754166, 'support': 129655}, '1': {'precision': 0.33366561702286235, 'recall': 0.856381113307403, 'f1-score': 0.4802247261317875, 'support': 125464}, '2': {'precision': 0.4116026955757398, 'recall': 0.11153986629190288, 'f1-score': 0.17551662960093956, 'support': 125946}, 'accuracy': 0.3467859813942503, 'macro avg': {'precision': 0.3909397913174935, 'recall': 0.35003353671910836, 'f1-score': 0.2645341144027145, 'support': 381065}, 'weighted avg': {'precision': 0.3913685826065779, 'recall': 0.3467859813942503, 'f1-score': 0.26302835159944804, 'support': 381065}}
[[ 10655 109228   9772]
 [  7709 107445  10310]
 [  6557 105341  14048]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1079122
{'0': {'precision': 0.4156405271116872, 'recall': 0.08673308389307127, 'f1-score': 0.14351782783828135, 'support': 44366}, '1': {'precision': 0.3352128356842077, 'recall': 0.8448552872756896, 'f1-score': 0.4799830299290343, 'support': 44191}, '2': {'precision': 0.4184549356223176, 'recall': 0.11472145540118568, 'f1-score': 0.18007458710708577, 'support': 44194}, 'accuracy': 0.3484192209474882, 'macro avg': {'precision': 0.3897694328060708, 'recall': 0.3487699421899822, 'f1-score': 0.26785848162480047, 'support': 132751}, 'weighted avg': {'precision': 0.3898041858249703, 'recall': 0.3484192209474882, 'f1-score': 0.267692584824805, 'support': 132751}}
[[ 3848 37296  3222]
 [ 3032 37335  3824]
 [ 2378 36746  5070]]
training model: results/WBA/W6/deepOF_L2/h300
Epoch 1/50
1489/1489 - 35s - loss: 3.2912 - accuracy300: 0.3724 - val_loss: 3.2957 - val_accuracy300: 0.3583 - 35s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 34s - loss: 3.2653 - accuracy300: 0.3828 - val_loss: 3.2895 - val_accuracy300: 0.3598 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 34s - loss: 3.2545 - accuracy300: 0.3883 - val_loss: 3.2885 - val_accuracy300: 0.3613 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 34s - loss: 3.2495 - accuracy300: 0.3895 - val_loss: 3.2882 - val_accuracy300: 0.3611 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 34s - loss: 3.2450 - accuracy300: 0.3910 - val_loss: 3.2913 - val_accuracy300: 0.3611 - 34s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 34s - loss: 3.2442 - accuracy300: 0.3920 - val_loss: 3.2865 - val_accuracy300: 0.3630 - 34s/epoch - 23ms/step
Epoch 7/50
1489/1489 - 34s - loss: 3.2415 - accuracy300: 0.3927 - val_loss: 3.2891 - val_accuracy300: 0.3634 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 34s - loss: 3.2376 - accuracy300: 0.3948 - val_loss: 3.2837 - val_accuracy300: 0.3651 - 34s/epoch - 23ms/step
Epoch 9/50
1489/1489 - 34s - loss: 3.2380 - accuracy300: 0.3950 - val_loss: 3.2854 - val_accuracy300: 0.3647 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 3.2361 - accuracy300: 0.3976 - val_loss: 3.2831 - val_accuracy300: 0.3665 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 34s - loss: 3.2355 - accuracy300: 0.3970 - val_loss: 3.2813 - val_accuracy300: 0.3691 - 34s/epoch - 23ms/step
Epoch 12/50
1489/1489 - 34s - loss: 3.2336 - accuracy300: 0.3984 - val_loss: 3.2816 - val_accuracy300: 0.3696 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 34s - loss: 3.2326 - accuracy300: 0.3995 - val_loss: 3.2818 - val_accuracy300: 0.3689 - 34s/epoch - 23ms/step
Epoch 14/50
1489/1489 - 34s - loss: 3.2294 - accuracy300: 0.4017 - val_loss: 3.2828 - val_accuracy300: 0.3712 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 34s - loss: 3.2290 - accuracy300: 0.4026 - val_loss: 3.2890 - val_accuracy300: 0.3693 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 33s - loss: 3.2272 - accuracy300: 0.4031 - val_loss: 3.2873 - val_accuracy300: 0.3708 - 33s/epoch - 22ms/step
Epoch 17/50
1489/1489 - 34s - loss: 3.2249 - accuracy300: 0.4055 - val_loss: 3.2913 - val_accuracy300: 0.3706 - 34s/epoch - 23ms/step
Epoch 18/50
1489/1489 - 34s - loss: 3.2211 - accuracy300: 0.4072 - val_loss: 3.2922 - val_accuracy300: 0.3727 - 34s/epoch - 23ms/step
Epoch 19/50
1489/1489 - 34s - loss: 3.2194 - accuracy300: 0.4081 - val_loss: 3.2987 - val_accuracy300: 0.3719 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 34s - loss: 3.2166 - accuracy300: 0.4103 - val_loss: 3.3022 - val_accuracy300: 0.3715 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 34s - loss: 3.2127 - accuracy300: 0.4123 - val_loss: 3.3061 - val_accuracy300: 0.3724 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h300
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0710828
{'0': {'precision': 0.35848726254048846, 'recall': 0.055968160335453605, 'f1-score': 0.09682041291127987, 'support': 365833}, '1': {'precision': 0.4401775749010636, 'recall': 0.843031599613741, 'f1-score': 0.5783680672689262, 'support': 562317}, '2': {'precision': 0.36706161875019455, 'recall': 0.17747595219283394, 'f1-score': 0.23926580562041488, 'support': 398685}, 'accuracy': 0.42603865589918866, 'macro avg': {'precision': 0.3885754853972489, 'recall': 0.3588252373806762, 'f1-score': 0.30481809526687365, 'support': 1326835}, 'weighted avg': {'precision': 0.39568429049130993, 'recall': 0.42603865589918866, 'f1-score': 0.34370361522933, 'support': 1326835}}
[[ 20475 293380  51978]
 [ 18235 474051  70031]
 [ 18405 309523  70757]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983846
{'0': {'precision': 0.41994629842731107, 'recall': 0.04213653963097813, 'f1-score': 0.07658836203881185, 'support': 129911}, '1': {'precision': 0.3419913556388536, 'recall': 0.8618141951475284, 'f1-score': 0.4896687919652428, 'support': 125874}, '2': {'precision': 0.4138385567294261, 'recall': 0.16790389527458494, 'f1-score': 0.2388861443764941, 'support': 125280}, 'accuracy': 0.3542414023854198, 'macro avg': {'precision': 0.39192540359853023, 'recall': 0.3572848766843639, 'f1-score': 0.2683810994601829, 'support': 381065}, 'weighted avg': {'precision': 0.3921880987803602, 'recall': 0.3542414023854198, 'f1-score': 0.26639522493050855, 'support': 381065}}
[[  5474 108595  15842]
 [  3442 108480  13952]
 [  4119 100126  21035]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941248
{'0': {'precision': 0.37001209189842804, 'recall': 0.035942492012779555, 'f1-score': 0.06552041624735028, 'support': 42568}, '1': {'precision': 0.36366205392230455, 'recall': 0.8707419702704418, 'f1-score': 0.5130505201519966, 'support': 47293}, '2': {'precision': 0.4080889524676507, 'recall': 0.14632781534157147, 'f1-score': 0.21541471451372082, 'support': 42890}, 'accuracy': 0.36900663648484755, 'macro avg': {'precision': 0.3805876994294611, 'recall': 0.3510040925415976, 'f1-score': 0.2646618836376892, 'support': 132751}, 'weighted avg': {'precision': 0.38005197260598694, 'recall': 0.36900663648484755, 'f1-score': 0.2733833148816888, 'support': 132751}}
[[ 1530 36646  4392]
 [ 1402 41180  4711]
 [ 1203 35411  6276]]
training model: results/WBA/W6/deepOF_L2/h500
Epoch 1/50
1489/1489 - 36s - loss: 3.2692 - accuracy500: 0.3925 - val_loss: 3.2995 - val_accuracy500: 0.3428 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 34s - loss: 3.2355 - accuracy500: 0.4043 - val_loss: 3.2908 - val_accuracy500: 0.3510 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 34s - loss: 3.2236 - accuracy500: 0.4088 - val_loss: 3.2905 - val_accuracy500: 0.3521 - 34s/epoch - 23ms/step
Epoch 4/50
1489/1489 - 34s - loss: 3.2186 - accuracy500: 0.4093 - val_loss: 3.2896 - val_accuracy500: 0.3513 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 34s - loss: 3.2154 - accuracy500: 0.4107 - val_loss: 3.2900 - val_accuracy500: 0.3524 - 34s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 35s - loss: 3.2146 - accuracy500: 0.4102 - val_loss: 3.2902 - val_accuracy500: 0.3519 - 35s/epoch - 23ms/step
Epoch 7/50
1489/1489 - 33s - loss: 3.2132 - accuracy500: 0.4107 - val_loss: 3.2904 - val_accuracy500: 0.3516 - 33s/epoch - 22ms/step
Epoch 8/50
1489/1489 - 34s - loss: 3.2113 - accuracy500: 0.4112 - val_loss: 3.2891 - val_accuracy500: 0.3538 - 34s/epoch - 23ms/step
Epoch 9/50
1489/1489 - 34s - loss: 3.2103 - accuracy500: 0.4129 - val_loss: 3.2895 - val_accuracy500: 0.3548 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 3.2088 - accuracy500: 0.4134 - val_loss: 3.2886 - val_accuracy500: 0.3574 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 35s - loss: 3.2075 - accuracy500: 0.4138 - val_loss: 3.2884 - val_accuracy500: 0.3575 - 35s/epoch - 23ms/step
Epoch 12/50
1489/1489 - 34s - loss: 3.2051 - accuracy500: 0.4151 - val_loss: 3.2922 - val_accuracy500: 0.3564 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 34s - loss: 3.2043 - accuracy500: 0.4162 - val_loss: 3.2903 - val_accuracy500: 0.3573 - 34s/epoch - 23ms/step
Epoch 14/50
1489/1489 - 34s - loss: 3.2023 - accuracy500: 0.4183 - val_loss: 3.2881 - val_accuracy500: 0.3594 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 34s - loss: 3.2007 - accuracy500: 0.4188 - val_loss: 3.2908 - val_accuracy500: 0.3587 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 34s - loss: 3.1991 - accuracy500: 0.4197 - val_loss: 3.2907 - val_accuracy500: 0.3601 - 34s/epoch - 23ms/step
Epoch 17/50
1489/1489 - 34s - loss: 3.1980 - accuracy500: 0.4201 - val_loss: 3.2908 - val_accuracy500: 0.3596 - 34s/epoch - 23ms/step
Epoch 18/50
1489/1489 - 34s - loss: 3.1946 - accuracy500: 0.4217 - val_loss: 3.2880 - val_accuracy500: 0.3629 - 34s/epoch - 23ms/step
Epoch 19/50
1489/1489 - 34s - loss: 3.1928 - accuracy500: 0.4223 - val_loss: 3.2907 - val_accuracy500: 0.3588 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 34s - loss: 3.1904 - accuracy500: 0.4236 - val_loss: 3.2877 - val_accuracy500: 0.3632 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 34s - loss: 3.1878 - accuracy500: 0.4246 - val_loss: 3.2896 - val_accuracy500: 0.3613 - 34s/epoch - 23ms/step
Epoch 22/50
1489/1489 - 34s - loss: 3.1858 - accuracy500: 0.4250 - val_loss: 3.2957 - val_accuracy500: 0.3612 - 34s/epoch - 23ms/step
Epoch 23/50
1489/1489 - 34s - loss: 3.1842 - accuracy500: 0.4263 - val_loss: 3.2944 - val_accuracy500: 0.3607 - 34s/epoch - 23ms/step
Epoch 24/50
1489/1489 - 34s - loss: 3.1816 - accuracy500: 0.4273 - val_loss: 3.2926 - val_accuracy500: 0.3613 - 34s/epoch - 23ms/step
Epoch 25/50
1489/1489 - 34s - loss: 3.1794 - accuracy500: 0.4290 - val_loss: 3.2977 - val_accuracy500: 0.3607 - 34s/epoch - 23ms/step
Epoch 26/50
1489/1489 - 34s - loss: 3.1772 - accuracy500: 0.4298 - val_loss: 3.2999 - val_accuracy500: 0.3605 - 34s/epoch - 23ms/step
Epoch 27/50
1489/1489 - 34s - loss: 3.1736 - accuracy500: 0.4318 - val_loss: 3.3031 - val_accuracy500: 0.3601 - 34s/epoch - 23ms/step
Epoch 28/50
1489/1489 - 34s - loss: 3.1710 - accuracy500: 0.4334 - val_loss: 3.3044 - val_accuracy500: 0.3602 - 34s/epoch - 23ms/step
Epoch 29/50
1489/1489 - 34s - loss: 3.1666 - accuracy500: 0.4350 - val_loss: 3.3077 - val_accuracy500: 0.3621 - 34s/epoch - 23ms/step
Epoch 30/50
1489/1489 - 34s - loss: 3.1632 - accuracy500: 0.4364 - val_loss: 3.3157 - val_accuracy500: 0.3598 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h500
Evaluating performance on  test set...
5183/5183 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0935035
{'0': {'precision': 0.3479012730297838, 'recall': 0.3687222751264517, 'f1-score': 0.3580093041624802, 'support': 417946}, '1': {'precision': 0.37660115346426587, 'recall': 0.23938211840641693, 'f1-score': 0.2927078900593981, 'support': 446817}, '2': {'precision': 0.3774201399655254, 'recall': 0.48996693156044946, 'f1-score': 0.4263918473276117, 'support': 462072}, 'accuracy': 0.36739006734070173, 'macro avg': {'precision': 0.3673075221531917, 'recall': 0.366023775031106, 'f1-score': 0.3590363471831634, 'support': 1326835}, 'weighted avg': {'precision': 0.36784605618580996, 'recall': 0.36739006734070173, 'f1-score': 0.3598331002939524, 'support': 1326835}}
[[154106  83894 179946]
 [146341 106960 193516]
 [142512  93160 226400]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0879053
{'0': {'precision': 0.38307819858628855, 'recall': 0.3454977143605991, 'f1-score': 0.36331874189364466, 'support': 129723}, '1': {'precision': 0.3957049581718017, 'recall': 0.3027467080871391, 'f1-score': 0.34303983868186094, 'support': 128117}, '2': {'precision': 0.36535218731932934, 'recall': 0.49231892878880096, 'f1-score': 0.4194376938048141, 'support': 123225}, 'accuracy': 0.3786020757613531, 'macro avg': {'precision': 0.3813784480258065, 'recall': 0.38018778374551304, 'f1-score': 0.3752654247934399, 'support': 381065}, 'weighted avg': {'precision': 0.38159135203634603, 'recall': 0.3786020757613531, 'f1-score': 0.3746480048972523, 'support': 381065}}
[[44819 31332 53572]
 [37520 38787 51810]
 [34658 27901 60666]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0963743
{'0': {'precision': 0.3538146685069725, 'recall': 0.34939136156413025, 'f1-score': 0.35158910329171394, 'support': 42554}, '1': {'precision': 0.3861904761904762, 'recall': 0.28769667376152913, 'f1-score': 0.3297457606849872, 'support': 47922}, '2': {'precision': 0.3513238474259027, 'recall': 0.4573151981076286, 'f1-score': 0.39737318095864516, 'support': 42275}, 'accuracy': 0.36148880234423847, 'macro avg': {'precision': 0.36377633070778376, 'recall': 0.364801077811096, 'f1-score': 0.3595693483117821, 'support': 132751}, 'weighted avg': {'precision': 0.3647088538208808, 'recall': 0.36148880234423847, 'f1-score': 0.3582839320988036, 'support': 132751}}
[[14868 11011 16675]
 [15114 13787 19021]
 [12040 10902 19333]]
training model: results/WBA/W6/deepOF_L2/h1000
Epoch 1/50
1489/1489 - 36s - loss: 3.3009 - accuracy1000: 0.3678 - val_loss: 3.3553 - val_accuracy1000: 0.3467 - 36s/epoch - 24ms/step
Epoch 2/50
1489/1489 - 34s - loss: 3.2650 - accuracy1000: 0.3838 - val_loss: 3.3612 - val_accuracy1000: 0.3439 - 34s/epoch - 23ms/step
Epoch 3/50
1489/1489 - 33s - loss: 3.2551 - accuracy1000: 0.3865 - val_loss: 3.3657 - val_accuracy1000: 0.3431 - 33s/epoch - 22ms/step
Epoch 4/50
1489/1489 - 34s - loss: 3.2503 - accuracy1000: 0.3883 - val_loss: 3.3634 - val_accuracy1000: 0.3444 - 34s/epoch - 23ms/step
Epoch 5/50
1489/1489 - 34s - loss: 3.2474 - accuracy1000: 0.3890 - val_loss: 3.3581 - val_accuracy1000: 0.3450 - 34s/epoch - 23ms/step
Epoch 6/50
1489/1489 - 34s - loss: 3.2445 - accuracy1000: 0.3904 - val_loss: 3.3563 - val_accuracy1000: 0.3458 - 34s/epoch - 23ms/step
Epoch 7/50
1489/1489 - 34s - loss: 3.2429 - accuracy1000: 0.3905 - val_loss: 3.3572 - val_accuracy1000: 0.3452 - 34s/epoch - 23ms/step
Epoch 8/50
1489/1489 - 34s - loss: 3.2399 - accuracy1000: 0.3915 - val_loss: 3.3514 - val_accuracy1000: 0.3477 - 34s/epoch - 23ms/step
Epoch 9/50
1489/1489 - 34s - loss: 3.2382 - accuracy1000: 0.3919 - val_loss: 3.3485 - val_accuracy1000: 0.3478 - 34s/epoch - 23ms/step
Epoch 10/50
1489/1489 - 34s - loss: 3.2363 - accuracy1000: 0.3937 - val_loss: 3.3468 - val_accuracy1000: 0.3483 - 34s/epoch - 23ms/step
Epoch 11/50
1489/1489 - 34s - loss: 3.2340 - accuracy1000: 0.3944 - val_loss: 3.3466 - val_accuracy1000: 0.3491 - 34s/epoch - 23ms/step
Epoch 12/50
1489/1489 - 34s - loss: 3.2320 - accuracy1000: 0.3959 - val_loss: 3.3421 - val_accuracy1000: 0.3504 - 34s/epoch - 23ms/step
Epoch 13/50
1489/1489 - 34s - loss: 3.2305 - accuracy1000: 0.3970 - val_loss: 3.3466 - val_accuracy1000: 0.3488 - 34s/epoch - 23ms/step
Epoch 14/50
1489/1489 - 34s - loss: 3.2290 - accuracy1000: 0.3981 - val_loss: 3.3429 - val_accuracy1000: 0.3507 - 34s/epoch - 23ms/step
Epoch 15/50
1489/1489 - 34s - loss: 3.2272 - accuracy1000: 0.3989 - val_loss: 3.3463 - val_accuracy1000: 0.3480 - 34s/epoch - 23ms/step
Epoch 16/50
1489/1489 - 34s - loss: 3.2260 - accuracy1000: 0.4002 - val_loss: 3.3432 - val_accuracy1000: 0.3501 - 34s/epoch - 23ms/step
Epoch 17/50
1489/1489 - 34s - loss: 3.2248 - accuracy1000: 0.4005 - val_loss: 3.3403 - val_accuracy1000: 0.3509 - 34s/epoch - 23ms/step
Epoch 18/50
1489/1489 - 34s - loss: 3.2232 - accuracy1000: 0.4013 - val_loss: 3.3451 - val_accuracy1000: 0.3511 - 34s/epoch - 23ms/step
Epoch 19/50
1489/1489 - 34s - loss: 3.2218 - accuracy1000: 0.4026 - val_loss: 3.3465 - val_accuracy1000: 0.3511 - 34s/epoch - 23ms/step
Epoch 20/50
1489/1489 - 34s - loss: 3.2203 - accuracy1000: 0.4038 - val_loss: 3.3404 - val_accuracy1000: 0.3533 - 34s/epoch - 23ms/step
Epoch 21/50
1489/1489 - 34s - loss: 3.2190 - accuracy1000: 0.4048 - val_loss: 3.3430 - val_accuracy1000: 0.3526 - 34s/epoch - 23ms/step
Epoch 22/50
1489/1489 - 34s - loss: 3.2172 - accuracy1000: 0.4059 - val_loss: 3.3445 - val_accuracy1000: 0.3522 - 34s/epoch - 23ms/step
Epoch 23/50
1489/1489 - 34s - loss: 3.2155 - accuracy1000: 0.4062 - val_loss: 3.3404 - val_accuracy1000: 0.3550 - 34s/epoch - 23ms/step
Epoch 24/50
1489/1489 - 34s - loss: 3.2137 - accuracy1000: 0.4072 - val_loss: 3.3433 - val_accuracy1000: 0.3542 - 34s/epoch - 23ms/step
Epoch 25/50
1489/1489 - 34s - loss: 3.2127 - accuracy1000: 0.4079 - val_loss: 3.3470 - val_accuracy1000: 0.3533 - 34s/epoch - 23ms/step
Epoch 26/50
1489/1489 - 34s - loss: 3.2123 - accuracy1000: 0.4089 - val_loss: 3.3440 - val_accuracy1000: 0.3568 - 34s/epoch - 23ms/step
Epoch 27/50
1489/1489 - 34s - loss: 3.2099 - accuracy1000: 0.4102 - val_loss: 3.3515 - val_accuracy1000: 0.3580 - 34s/epoch - 23ms/step
testing model: results/WBA/W6/deepOF_L2/h1000
Evaluating performance on  test set...
5183/5183 - 40s - 40s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1377043
{'0': {'precision': 0.3672176308539945, 'recall': 0.00880346414883336, 'f1-score': 0.01719471216378619, 'support': 454253}, '1': {'precision': 0.285089526110777, 'recall': 0.8967769863444964, 'f1-score': 0.43264061274209004, 'support': 355754}, '2': {'precision': 0.43599849659193646, 'recall': 0.1660939422786691, 'f1-score': 0.24055013632911781, 'support': 516828}, 'accuracy': 0.3081566283675061, 'macro avg': {'precision': 0.36276855118556933, 'recall': 0.35722479759066633, 'f1-score': 0.23012848707833133, 'support': 1326835}, 'weighted avg': {'precision': 0.3719887406775901, 'recall': 0.3081566283675061, 'f1-score': 0.2155862816316205, 'support': 1326835}}
[[  3999 373478  76776]
 [  2454 319032  34268]
 [  4437 426549  85842]]
Evaluating performance on  train set...
1489/1489 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1217271
{'0': {'precision': 0.43071643071643073, 'recall': 0.007545071279881564, 'f1-score': 0.014830351999290978, 'support': 133067}, '1': {'precision': 0.3359350645880526, 'recall': 0.9285790488695581, 'f1-score': 0.4933788550673451, 'support': 121855}, '2': {'precision': 0.4250841148256854, 'recall': 0.14122067811927733, 'f1-score': 0.21200833085391252, 'support': 126143}, 'accuracy': 0.34631886948420876, 'macro avg': {'precision': 0.3972452033767229, 'recall': 0.359114932756239, 'f1-score': 0.2400725126401829, 'support': 381065}, 'weighted avg': {'precision': 0.39854328284669777, 'recall': 0.34631886948420876, 'f1-score': 0.23312946009900168, 'support': 381065}}
[[  1004 116116  15947]
 [   557 113152   8146]
 [   770 107559  17814]]
Evaluating performance on  val set...
519/519 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1196324
{'0': {'precision': 0.37897310513447435, 'recall': 0.007015003054920685, 'f1-score': 0.013775022773223131, 'support': 44191}, '1': {'precision': 0.34713381075525496, 'recall': 0.9409134820606142, 'f1-score': 0.507159767254585, 'support': 44511}, '2': {'precision': 0.3984935755427559, 'recall': 0.10209085336784036, 'f1-score': 0.16254021035891134, 'support': 44049}, 'accuracy': 0.35169603242160136, 'macro avg': {'precision': 0.3748668304774951, 'recall': 0.35000644616112503, 'f1-score': 0.2278250001289065, 'support': 132751}, 'weighted avg': {'precision': 0.37477470639473576, 'recall': 0.35169603242160136, 'f1-score': 0.22856817769915122, 'support': 132751}}
[[  310 39503  4378]
 [  220 41881  2410]
 [  288 39264  4497]]
training model: results/WBA/W6/deepVOL_L2/h10
Epoch 1/50
1489/1489 - 40s - loss: 3.0369 - accuracy10: 0.4597 - val_loss: 2.8756 - val_accuracy10: 0.5929 - 40s/epoch - 27ms/step
Epoch 2/50
1489/1489 - 37s - loss: 2.8232 - accuracy10: 0.5224 - val_loss: 2.8776 - val_accuracy10: 0.6096 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 37s - loss: 2.7577 - accuracy10: 0.5407 - val_loss: 2.7607 - val_accuracy10: 0.6108 - 37s/epoch - 25ms/step
Epoch 4/50
1489/1489 - 37s - loss: 2.7197 - accuracy10: 0.5519 - val_loss: 2.7380 - val_accuracy10: 0.6207 - 37s/epoch - 25ms/step
Epoch 5/50
1489/1489 - 37s - loss: 2.6911 - accuracy10: 0.5585 - val_loss: 2.7210 - val_accuracy10: 0.6208 - 37s/epoch - 25ms/step
Epoch 6/50
1489/1489 - 36s - loss: 2.6731 - accuracy10: 0.5628 - val_loss: 2.7143 - val_accuracy10: 0.6253 - 36s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 36s - loss: 2.6570 - accuracy10: 0.5661 - val_loss: 2.7098 - val_accuracy10: 0.6339 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 37s - loss: 2.6437 - accuracy10: 0.5677 - val_loss: 2.7009 - val_accuracy10: 0.6335 - 37s/epoch - 25ms/step
Epoch 9/50
1489/1489 - 37s - loss: 2.6319 - accuracy10: 0.5709 - val_loss: 2.7107 - val_accuracy10: 0.6370 - 37s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 38s - loss: 2.6213 - accuracy10: 0.5718 - val_loss: 2.7092 - val_accuracy10: 0.6332 - 38s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 37s - loss: 2.6125 - accuracy10: 0.5729 - val_loss: 2.6995 - val_accuracy10: 0.6409 - 37s/epoch - 25ms/step
Epoch 12/50
1489/1489 - 36s - loss: 2.6038 - accuracy10: 0.5745 - val_loss: 2.7080 - val_accuracy10: 0.6401 - 36s/epoch - 24ms/step
Epoch 13/50
1489/1489 - 37s - loss: 2.5962 - accuracy10: 0.5756 - val_loss: 2.6932 - val_accuracy10: 0.6348 - 37s/epoch - 25ms/step
Epoch 14/50
1489/1489 - 37s - loss: 2.5895 - accuracy10: 0.5766 - val_loss: 2.6929 - val_accuracy10: 0.6332 - 37s/epoch - 25ms/step
Epoch 15/50
1489/1489 - 36s - loss: 2.5831 - accuracy10: 0.5775 - val_loss: 2.6969 - val_accuracy10: 0.6385 - 36s/epoch - 24ms/step
Epoch 16/50
1489/1489 - 36s - loss: 2.5756 - accuracy10: 0.5790 - val_loss: 2.6947 - val_accuracy10: 0.6394 - 36s/epoch - 24ms/step
Epoch 17/50
1489/1489 - 37s - loss: 2.5710 - accuracy10: 0.5794 - val_loss: 2.6769 - val_accuracy10: 0.6409 - 37s/epoch - 25ms/step
Epoch 18/50
1489/1489 - 38s - loss: 2.5654 - accuracy10: 0.5810 - val_loss: 2.6852 - val_accuracy10: 0.6408 - 38s/epoch - 25ms/step
Epoch 19/50
1489/1489 - 36s - loss: 2.5610 - accuracy10: 0.5813 - val_loss: 2.6823 - val_accuracy10: 0.6377 - 36s/epoch - 24ms/step
Epoch 20/50
1489/1489 - 36s - loss: 2.5548 - accuracy10: 0.5817 - val_loss: 2.6694 - val_accuracy10: 0.6395 - 36s/epoch - 24ms/step
Epoch 21/50
1489/1489 - 37s - loss: 2.5487 - accuracy10: 0.5829 - val_loss: 2.7042 - val_accuracy10: 0.6369 - 37s/epoch - 25ms/step
Epoch 22/50
1489/1489 - 36s - loss: 2.5445 - accuracy10: 0.5840 - val_loss: 2.6813 - val_accuracy10: 0.6447 - 36s/epoch - 24ms/step
Epoch 23/50
1489/1489 - 36s - loss: 2.5402 - accuracy10: 0.5841 - val_loss: 2.6716 - val_accuracy10: 0.6378 - 36s/epoch - 24ms/step
Epoch 24/50
1489/1489 - 37s - loss: 2.5361 - accuracy10: 0.5852 - val_loss: 2.6838 - val_accuracy10: 0.6423 - 37s/epoch - 25ms/step
Epoch 25/50
1489/1489 - 37s - loss: 2.5324 - accuracy10: 0.5854 - val_loss: 2.6582 - val_accuracy10: 0.6401 - 37s/epoch - 25ms/step
Epoch 26/50
1489/1489 - 36s - loss: 2.5276 - accuracy10: 0.5866 - val_loss: 2.6665 - val_accuracy10: 0.6420 - 36s/epoch - 24ms/step
Epoch 27/50
1489/1489 - 37s - loss: 2.5245 - accuracy10: 0.5867 - val_loss: 2.6631 - val_accuracy10: 0.6424 - 37s/epoch - 25ms/step
Epoch 28/50
1489/1489 - 36s - loss: 2.5192 - accuracy10: 0.5873 - val_loss: 2.6746 - val_accuracy10: 0.6406 - 36s/epoch - 24ms/step
Epoch 29/50
1489/1489 - 36s - loss: 2.5157 - accuracy10: 0.5869 - val_loss: 2.6600 - val_accuracy10: 0.6399 - 36s/epoch - 24ms/step
Epoch 30/50
1489/1489 - 37s - loss: 2.5125 - accuracy10: 0.5876 - val_loss: 2.6641 - val_accuracy10: 0.6399 - 37s/epoch - 25ms/step
Epoch 31/50
1489/1489 - 37s - loss: 2.5088 - accuracy10: 0.5881 - val_loss: 2.6974 - val_accuracy10: 0.6422 - 37s/epoch - 25ms/step
Epoch 32/50
1489/1489 - 36s - loss: 2.5066 - accuracy10: 0.5877 - val_loss: 2.6784 - val_accuracy10: 0.6421 - 36s/epoch - 24ms/step
Epoch 33/50
1489/1489 - 36s - loss: 2.5013 - accuracy10: 0.5891 - val_loss: 2.6754 - val_accuracy10: 0.6425 - 36s/epoch - 24ms/step
Epoch 34/50
1489/1489 - 37s - loss: 2.4967 - accuracy10: 0.5900 - val_loss: 2.6741 - val_accuracy10: 0.6435 - 37s/epoch - 25ms/step
Epoch 35/50
1489/1489 - 36s - loss: 2.4938 - accuracy10: 0.5908 - val_loss: 2.6899 - val_accuracy10: 0.6467 - 36s/epoch - 24ms/step
testing model: results/WBA/W6/deepVOL_L2/h10
Evaluating performance on  test set...
5183/5183 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8926782
{'0': {'precision': 0.4948168087578341, 'recall': 0.39672986092889007, 'f1-score': 0.4403776277752292, 'support': 304880}, '1': {'precision': 0.7117514251848507, 'recall': 0.7110901839599966, 'f1-score': 0.7114206509221667, 'support': 709339}, '2': {'precision': 0.4393898040223057, 'recall': 0.5252590197075693, 'f1-score': 0.47850254321127966, 'support': 312621}, 'accuracy': 0.5950725030900486, 'macro avg': {'precision': 0.5486526793216635, 'recall': 0.5443596881988186, 'f1-score': 0.5434336073028919, 'support': 1326840}, 'weighted avg': {'precision': 0.5977324114185151, 'recall': 0.5950725030900486, 'f1-score': 0.5942620721577916, 'support': 1326840}}
[[120955  99067  84858]
 [ 80284 504404 124651]
 [ 43205 105209 164207]]
Evaluating performance on  train set...
1489/1489 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8473956
{'0': {'precision': 0.47893739214077574, 'recall': 0.4219486054684579, 'f1-score': 0.44864048338368584, 'support': 80242}, '1': {'precision': 0.7454207541385653, 'recall': 0.7046379685851547, 'f1-score': 0.7244558550715867, 'support': 220851}, '2': {'precision': 0.43428965109984746, 'recall': 0.55175432015405, 'f1-score': 0.486025366369459, 'support': 79974}, 'accuracy': 0.6130260557854655, 'macro avg': {'precision': 0.5528825991263963, 'recall': 0.5594469647358876, 'f1-score': 0.5530405682749105, 'support': 381067}, 'weighted avg': {'precision': 0.6240101970243438, 'recall': 0.6130260557854655, 'f1-score': 0.6163378155708047, 'support': 381067}}
[[ 33858  28002  18382]
 [ 26134 155620  39097]
 [ 10702  25146  44126]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8001509
{'0': {'precision': 0.4650844765979973, 'recall': 0.409723301725478, 'f1-score': 0.43565215594719114, 'support': 25732}, '1': {'precision': 0.7742873614758824, 'recall': 0.7405496808028329, 'f1-score': 0.7570428269011562, 'support': 81611}, '2': {'precision': 0.435712501561134, 'recall': 0.5492148451336141, 'f1-score': 0.4859237077145394, 'support': 25409}, 'accuracy': 0.6398020368808003, 'macro avg': {'precision': 0.5583614465450045, 'recall': 0.566495942553975, 'f1-score': 0.5595395635209622, 'support': 132752}, 'weighted avg': {'precision': 0.6495490731694796, 'recall': 0.6398020368808003, 'f1-score': 0.6428532821530532, 'support': 132752}}
[[10543  9524  5665]
 [ 8766 60437 12408]
 [ 3360  8094 13955]]
training model: results/WBA/W6/deepVOL_L2/h20
Epoch 1/50
1489/1489 - 39s - loss: 3.0779 - accuracy20: 0.4639 - val_loss: 2.9588 - val_accuracy20: 0.5567 - 39s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 37s - loss: 2.8833 - accuracy20: 0.5233 - val_loss: 2.9557 - val_accuracy20: 0.5714 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 36s - loss: 2.8382 - accuracy20: 0.5370 - val_loss: 2.9477 - val_accuracy20: 0.5739 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 37s - loss: 2.8161 - accuracy20: 0.5424 - val_loss: 2.9053 - val_accuracy20: 0.5822 - 37s/epoch - 25ms/step
Epoch 5/50
1489/1489 - 36s - loss: 2.7930 - accuracy20: 0.5482 - val_loss: 2.9152 - val_accuracy20: 0.5816 - 36s/epoch - 24ms/step
Epoch 6/50
1489/1489 - 37s - loss: 2.7751 - accuracy20: 0.5521 - val_loss: 2.8998 - val_accuracy20: 0.5845 - 37s/epoch - 25ms/step
Epoch 7/50
1489/1489 - 36s - loss: 2.7590 - accuracy20: 0.5548 - val_loss: 2.8823 - val_accuracy20: 0.5842 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 36s - loss: 2.7470 - accuracy20: 0.5579 - val_loss: 2.8795 - val_accuracy20: 0.5859 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 36s - loss: 2.7361 - accuracy20: 0.5591 - val_loss: 2.8938 - val_accuracy20: 0.5863 - 36s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 37s - loss: 2.7269 - accuracy20: 0.5617 - val_loss: 2.8713 - val_accuracy20: 0.5891 - 37s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 36s - loss: 2.7180 - accuracy20: 0.5631 - val_loss: 2.8529 - val_accuracy20: 0.5913 - 36s/epoch - 24ms/step
Epoch 12/50
1489/1489 - 37s - loss: 2.7106 - accuracy20: 0.5645 - val_loss: 2.8456 - val_accuracy20: 0.5934 - 37s/epoch - 25ms/step
Epoch 13/50
1489/1489 - 37s - loss: 2.7048 - accuracy20: 0.5660 - val_loss: 2.8627 - val_accuracy20: 0.5869 - 37s/epoch - 25ms/step
Epoch 14/50
1489/1489 - 37s - loss: 2.7006 - accuracy20: 0.5663 - val_loss: 2.8499 - val_accuracy20: 0.5959 - 37s/epoch - 25ms/step
Epoch 15/50
1489/1489 - 36s - loss: 2.6952 - accuracy20: 0.5672 - val_loss: 2.8519 - val_accuracy20: 0.5909 - 36s/epoch - 24ms/step
Epoch 16/50
1489/1489 - 36s - loss: 2.6899 - accuracy20: 0.5677 - val_loss: 2.8447 - val_accuracy20: 0.5955 - 36s/epoch - 25ms/step
Epoch 17/50
1489/1489 - 36s - loss: 2.6848 - accuracy20: 0.5695 - val_loss: 2.8539 - val_accuracy20: 0.5926 - 36s/epoch - 24ms/step
Epoch 18/50
1489/1489 - 37s - loss: 2.6806 - accuracy20: 0.5707 - val_loss: 2.8344 - val_accuracy20: 0.5917 - 37s/epoch - 25ms/step
Epoch 19/50
1489/1489 - 36s - loss: 2.6766 - accuracy20: 0.5713 - val_loss: 2.8439 - val_accuracy20: 0.5916 - 36s/epoch - 24ms/step
Epoch 20/50
1489/1489 - 36s - loss: 2.6723 - accuracy20: 0.5710 - val_loss: 2.8586 - val_accuracy20: 0.5904 - 36s/epoch - 24ms/step
Epoch 21/50
1489/1489 - 36s - loss: 2.6684 - accuracy20: 0.5724 - val_loss: 2.8296 - val_accuracy20: 0.5908 - 36s/epoch - 24ms/step
Epoch 22/50
1489/1489 - 37s - loss: 2.6650 - accuracy20: 0.5730 - val_loss: 2.8119 - val_accuracy20: 0.5952 - 37s/epoch - 25ms/step
Epoch 23/50
1489/1489 - 36s - loss: 2.6611 - accuracy20: 0.5739 - val_loss: 2.8180 - val_accuracy20: 0.5919 - 36s/epoch - 24ms/step
Epoch 24/50
1489/1489 - 36s - loss: 2.6576 - accuracy20: 0.5745 - val_loss: 2.8211 - val_accuracy20: 0.5924 - 36s/epoch - 24ms/step
Epoch 25/50
1489/1489 - 36s - loss: 2.6546 - accuracy20: 0.5749 - val_loss: 2.8169 - val_accuracy20: 0.5945 - 36s/epoch - 24ms/step
Epoch 26/50
1489/1489 - 36s - loss: 2.6517 - accuracy20: 0.5754 - val_loss: 2.8326 - val_accuracy20: 0.5919 - 36s/epoch - 24ms/step
Epoch 27/50
1489/1489 - 36s - loss: 2.6480 - accuracy20: 0.5765 - val_loss: 2.8526 - val_accuracy20: 0.5919 - 36s/epoch - 24ms/step
Epoch 28/50
1489/1489 - 37s - loss: 2.6454 - accuracy20: 0.5766 - val_loss: 2.8540 - val_accuracy20: 0.5934 - 37s/epoch - 25ms/step
Epoch 29/50
1489/1489 - 36s - loss: 2.6414 - accuracy20: 0.5772 - val_loss: 2.8294 - val_accuracy20: 0.5920 - 36s/epoch - 24ms/step
Epoch 30/50
1489/1489 - 36s - loss: 2.6394 - accuracy20: 0.5781 - val_loss: 2.8436 - val_accuracy20: 0.5916 - 36s/epoch - 24ms/step
Epoch 31/50
1489/1489 - 36s - loss: 2.6358 - accuracy20: 0.5784 - val_loss: 2.8426 - val_accuracy20: 0.5907 - 36s/epoch - 24ms/step
Epoch 32/50
1489/1489 - 36s - loss: 2.6324 - accuracy20: 0.5791 - val_loss: 2.8262 - val_accuracy20: 0.5932 - 36s/epoch - 24ms/step
testing model: results/WBA/W6/deepVOL_L2/h20
Evaluating performance on  test set...
5183/5183 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9608365
{'0': {'precision': 0.5361865611977048, 'recall': 0.398663808409064, 'f1-score': 0.45730992564029455, 'support': 380185}, '1': {'precision': 0.5952605306286438, 'recall': 0.7335748417994874, 'f1-score': 0.6572193345327328, 'support': 561471}, '2': {'precision': 0.5009226873197211, 'recall': 0.45806939021350834, 'f1-score': 0.4785385725289389, 'support': 385184}, 'accuracy': 0.5576316662144645, 'macro avg': {'precision': 0.5441232597153566, 'recall': 0.5301026801406866, 'f1-score': 0.5310226109006554, 'support': 1326840}, 'weighted avg': {'precision': 0.5509473768910375, 'recall': 0.5576316662144645, 'f1-score': 0.5480671162913163, 'support': 1326840}}
[[151566 142350  86269]
 [ 60068 411881  89522]
 [ 71040 137703 176441]]
Evaluating performance on  train set...
1489/1489 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93053746
{'0': {'precision': 0.5049106714052445, 'recall': 0.41300910421229414, 'f1-score': 0.4543593234256574, 'support': 101821}, '1': {'precision': 0.6324586434461997, 'recall': 0.7256939365640155, 'f1-score': 0.6758760531500189, 'support': 177754}, '2': {'precision': 0.4951556687735155, 'recall': 0.4577306585740748, 'f1-score': 0.47570822218695125, 'support': 101492}, 'accuracy': 0.5707762676904586, 'macro avg': {'precision': 0.5441749945416532, 'recall': 0.5321445664501282, 'f1-score': 0.5353145329208758, 'support': 381067}, 'weighted avg': {'precision': 0.5618090842698287, 'recall': 0.5707762676904586, 'f1-score': 0.56337486979547, 'support': 381067}}
[[ 42053  40520  19248]
 [ 20642 128995  28117]
 [ 20593  34443  46456]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8928068
{'0': {'precision': 0.5051834595224228, 'recall': 0.3952188572643601, 'f1-score': 0.4434862635489808, 'support': 32921}, '1': {'precision': 0.6654428097316225, 'recall': 0.7579961005521737, 'f1-score': 0.7087105056254044, 'support': 67189}, '2': {'precision': 0.4906279749203952, 'recall': 0.45787635561546475, 'f1-score': 0.4736867126218207, 'support': 32642}, 'accuracy': 0.5942358683861637, 'macro avg': {'precision': 0.5537514147248135, 'recall': 0.5370304378106662, 'f1-score': 0.5419611605987352, 'support': 132752}, 'weighted avg': {'precision': 0.5827155897564421, 'recall': 0.5942358683861637, 'f1-score': 0.5851485711564628, 'support': 132752}}
[[13011 14029  5881]
 [ 6624 50929  9636]
 [ 6120 11576 14946]]
training model: results/WBA/W6/deepVOL_L2/h30
Epoch 1/50
1489/1489 - 39s - loss: 3.0791 - accuracy30: 0.4654 - val_loss: 3.0951 - val_accuracy30: 0.5046 - 39s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 37s - loss: 2.9284 - accuracy30: 0.5117 - val_loss: 3.1119 - val_accuracy30: 0.5169 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 36s - loss: 2.8911 - accuracy30: 0.5234 - val_loss: 3.0749 - val_accuracy30: 0.5259 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 38s - loss: 2.8734 - accuracy30: 0.5272 - val_loss: 3.0942 - val_accuracy30: 0.5291 - 38s/epoch - 26ms/step
Epoch 5/50
1489/1489 - 37s - loss: 2.8581 - accuracy30: 0.5302 - val_loss: 3.0475 - val_accuracy30: 0.5336 - 37s/epoch - 25ms/step
Epoch 6/50
1489/1489 - 36s - loss: 2.8465 - accuracy30: 0.5331 - val_loss: 3.0195 - val_accuracy30: 0.5390 - 36s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 36s - loss: 2.8360 - accuracy30: 0.5361 - val_loss: 3.0297 - val_accuracy30: 0.5359 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 37s - loss: 2.8267 - accuracy30: 0.5376 - val_loss: 3.0240 - val_accuracy30: 0.5354 - 37s/epoch - 25ms/step
Epoch 9/50
1489/1489 - 37s - loss: 2.8177 - accuracy30: 0.5404 - val_loss: 3.0217 - val_accuracy30: 0.5390 - 37s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 37s - loss: 2.8089 - accuracy30: 0.5430 - val_loss: 3.0390 - val_accuracy30: 0.5386 - 37s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 37s - loss: 2.8012 - accuracy30: 0.5444 - val_loss: 3.0185 - val_accuracy30: 0.5408 - 37s/epoch - 25ms/step
Epoch 12/50
1489/1489 - 37s - loss: 2.7945 - accuracy30: 0.5461 - val_loss: 3.0059 - val_accuracy30: 0.5416 - 37s/epoch - 25ms/step
Epoch 13/50
1489/1489 - 36s - loss: 2.7883 - accuracy30: 0.5473 - val_loss: 3.0250 - val_accuracy30: 0.5426 - 36s/epoch - 24ms/step
Epoch 14/50
1489/1489 - 37s - loss: 2.7831 - accuracy30: 0.5484 - val_loss: 3.0122 - val_accuracy30: 0.5441 - 37s/epoch - 25ms/step
Epoch 15/50
1489/1489 - 36s - loss: 2.7785 - accuracy30: 0.5486 - val_loss: 3.0018 - val_accuracy30: 0.5462 - 36s/epoch - 24ms/step
Epoch 16/50
1489/1489 - 37s - loss: 2.7729 - accuracy30: 0.5502 - val_loss: 3.0042 - val_accuracy30: 0.5475 - 37s/epoch - 25ms/step
Epoch 17/50
1489/1489 - 36s - loss: 2.7682 - accuracy30: 0.5510 - val_loss: 3.0138 - val_accuracy30: 0.5451 - 36s/epoch - 24ms/step
Epoch 18/50
1489/1489 - 36s - loss: 2.7641 - accuracy30: 0.5519 - val_loss: 3.0028 - val_accuracy30: 0.5453 - 36s/epoch - 24ms/step
Epoch 19/50
1489/1489 - 36s - loss: 2.7600 - accuracy30: 0.5528 - val_loss: 2.9994 - val_accuracy30: 0.5472 - 36s/epoch - 24ms/step
Epoch 20/50
1489/1489 - 37s - loss: 2.7561 - accuracy30: 0.5535 - val_loss: 2.9656 - val_accuracy30: 0.5472 - 37s/epoch - 25ms/step
Epoch 21/50
1489/1489 - 36s - loss: 2.7525 - accuracy30: 0.5548 - val_loss: 2.9902 - val_accuracy30: 0.5466 - 36s/epoch - 24ms/step
Epoch 22/50
1489/1489 - 36s - loss: 2.7488 - accuracy30: 0.5553 - val_loss: 2.9954 - val_accuracy30: 0.5493 - 36s/epoch - 24ms/step
Epoch 23/50
1489/1489 - 38s - loss: 2.7443 - accuracy30: 0.5556 - val_loss: 2.9652 - val_accuracy30: 0.5499 - 38s/epoch - 25ms/step
Epoch 24/50
1489/1489 - 37s - loss: 2.7423 - accuracy30: 0.5565 - val_loss: 2.9698 - val_accuracy30: 0.5497 - 37s/epoch - 25ms/step
Epoch 25/50
1489/1489 - 37s - loss: 2.7387 - accuracy30: 0.5568 - val_loss: 2.9977 - val_accuracy30: 0.5449 - 37s/epoch - 25ms/step
Epoch 26/50
1489/1489 - 37s - loss: 2.7354 - accuracy30: 0.5579 - val_loss: 2.9749 - val_accuracy30: 0.5496 - 37s/epoch - 25ms/step
Epoch 27/50
1489/1489 - 37s - loss: 2.7311 - accuracy30: 0.5586 - val_loss: 2.9661 - val_accuracy30: 0.5507 - 37s/epoch - 25ms/step
Epoch 28/50
1489/1489 - 37s - loss: 2.7294 - accuracy30: 0.5588 - val_loss: 3.0098 - val_accuracy30: 0.5488 - 37s/epoch - 25ms/step
Epoch 29/50
1489/1489 - 37s - loss: 2.7256 - accuracy30: 0.5602 - val_loss: 2.9857 - val_accuracy30: 0.5499 - 37s/epoch - 25ms/step
Epoch 30/50
1489/1489 - 37s - loss: 2.7240 - accuracy30: 0.5599 - val_loss: 2.9948 - val_accuracy30: 0.5497 - 37s/epoch - 25ms/step
Epoch 31/50
1489/1489 - 37s - loss: 2.7198 - accuracy30: 0.5615 - val_loss: 2.9810 - val_accuracy30: 0.5497 - 37s/epoch - 25ms/step
Epoch 32/50
1489/1489 - 36s - loss: 2.7169 - accuracy30: 0.5623 - val_loss: 2.9814 - val_accuracy30: 0.5491 - 36s/epoch - 24ms/step
Epoch 33/50
1489/1489 - 35s - loss: 2.7140 - accuracy30: 0.5619 - val_loss: 2.9989 - val_accuracy30: 0.5493 - 35s/epoch - 24ms/step
testing model: results/WBA/W6/deepVOL_L2/h30
Evaluating performance on  test set...
5183/5183 - 52s - 52s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0238007
{'0': {'precision': 0.5486860740172608, 'recall': 0.338461898794955, 'f1-score': 0.41866596361718955, 'support': 426955}, '1': {'precision': 0.49920368382785724, 'recall': 0.7403562671961181, 'f1-score': 0.5963222281004382, 'support': 467402}, '2': {'precision': 0.5112712914925853, 'recall': 0.43773281261922437, 'f1-score': 0.47165279784742636, 'support': 432483}, 'accuracy': 0.5123933556419764, 'macro avg': {'precision': 0.5197203497792344, 'recall': 0.5055169928700992, 'f1-score': 0.4955469965216847, 'support': 1326840}, 'weighted avg': {'precision': 0.5190597245479, 'recall': 0.5123933556419764, 'f1-score': 0.4985194488606212, 'support': 1326840}}
[[144508 177525 104922]
 [ 45315 346044  76043]
 [ 73548 169623 189312]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9918664
{'0': {'precision': 0.5401563899975564, 'recall': 0.3423033577370762, 'f1-score': 0.41904992601408103, 'support': 116239}, '1': {'precision': 0.5378989394273398, 'recall': 0.7368753061813399, 'f1-score': 0.6218582577276383, 'support': 149013}, '2': {'precision': 0.5041928924179335, 'recall': 0.44957907006864395, 'f1-score': 0.4753223634662346, 'support': 115815}, 'accuracy': 0.5292009016787074, 'macro avg': {'precision': 0.5274160739476099, 'recall': 0.50958591132902, 'f1-score': 0.5054101824026512, 'support': 381067}, 'weighted avg': {'precision': 0.528343501571102, 'recall': 0.5292009016787074, 'f1-score': 0.5154588784480453, 'support': 381067}}
[[ 39789  50948  25502]
 [ 13509 109804  25700]
 [ 20364  43383  52068]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.966561
{'0': {'precision': 0.5404519428296691, 'recall': 0.3257376185458377, 'f1-score': 0.40648268380479624, 'support': 37960}, '1': {'precision': 0.5726704345215564, 'recall': 0.7688964441562538, 'f1-score': 0.6564328141598216, 'support': 57061}, '2': {'precision': 0.5055622369212267, 'recall': 0.4456547666375129, 'f1-score': 0.4737220211012664, 'support': 37731}, 'accuracy': 0.550304326865132, 'macro avg': {'precision': 0.5395615380908174, 'recall': 0.5134296097798682, 'f1-score': 0.5122125063552948, 'support': 132752}, 'weighted avg': {'precision': 0.5443840557982069, 'recall': 0.550304326865132, 'f1-score': 0.5330300188635616, 'support': 132752}}
[[12365 17879  7716]
 [ 4458 43874  8729]
 [ 6056 14860 16815]]
training model: results/WBA/W6/deepVOL_L2/h50
Epoch 1/50
1489/1489 - 39s - loss: 3.1666 - accuracy50: 0.4329 - val_loss: 3.2193 - val_accuracy50: 0.4268 - 39s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 37s - loss: 3.0315 - accuracy50: 0.4797 - val_loss: 3.2158 - val_accuracy50: 0.4581 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 36s - loss: 2.9978 - accuracy50: 0.4897 - val_loss: 3.2131 - val_accuracy50: 0.4585 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 36s - loss: 2.9788 - accuracy50: 0.4945 - val_loss: 3.1646 - val_accuracy50: 0.4681 - 36s/epoch - 24ms/step
Epoch 5/50
1489/1489 - 36s - loss: 2.9658 - accuracy50: 0.4973 - val_loss: 3.1635 - val_accuracy50: 0.4728 - 36s/epoch - 24ms/step
Epoch 6/50
1489/1489 - 36s - loss: 2.9581 - accuracy50: 0.4990 - val_loss: 3.1278 - val_accuracy50: 0.4784 - 36s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 36s - loss: 2.9503 - accuracy50: 0.5007 - val_loss: 3.1411 - val_accuracy50: 0.4792 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 37s - loss: 2.9442 - accuracy50: 0.5021 - val_loss: 3.1050 - val_accuracy50: 0.4841 - 37s/epoch - 25ms/step
Epoch 9/50
1489/1489 - 36s - loss: 2.9379 - accuracy50: 0.5037 - val_loss: 3.1077 - val_accuracy50: 0.4834 - 36s/epoch - 24ms/step
Epoch 10/50
1489/1489 - 36s - loss: 2.9331 - accuracy50: 0.5053 - val_loss: 3.1154 - val_accuracy50: 0.4826 - 36s/epoch - 24ms/step
Epoch 11/50
1489/1489 - 36s - loss: 2.9285 - accuracy50: 0.5065 - val_loss: 3.1109 - val_accuracy50: 0.4828 - 36s/epoch - 24ms/step
Epoch 12/50
1489/1489 - 37s - loss: 2.9235 - accuracy50: 0.5085 - val_loss: 3.1035 - val_accuracy50: 0.4850 - 37s/epoch - 25ms/step
Epoch 13/50
1489/1489 - 35s - loss: 2.9187 - accuracy50: 0.5093 - val_loss: 3.1054 - val_accuracy50: 0.4838 - 35s/epoch - 24ms/step
Epoch 14/50
1489/1489 - 36s - loss: 2.9138 - accuracy50: 0.5110 - val_loss: 3.1085 - val_accuracy50: 0.4840 - 36s/epoch - 24ms/step
Epoch 15/50
1489/1489 - 37s - loss: 2.9100 - accuracy50: 0.5119 - val_loss: 3.1162 - val_accuracy50: 0.4840 - 37s/epoch - 25ms/step
Epoch 16/50
1489/1489 - 37s - loss: 2.9056 - accuracy50: 0.5131 - val_loss: 3.1040 - val_accuracy50: 0.4860 - 37s/epoch - 25ms/step
Epoch 17/50
1489/1489 - 36s - loss: 2.9020 - accuracy50: 0.5140 - val_loss: 3.1029 - val_accuracy50: 0.4854 - 36s/epoch - 25ms/step
Epoch 18/50
1489/1489 - 36s - loss: 2.8975 - accuracy50: 0.5152 - val_loss: 3.1014 - val_accuracy50: 0.4861 - 36s/epoch - 24ms/step
Epoch 19/50
1489/1489 - 36s - loss: 2.8947 - accuracy50: 0.5159 - val_loss: 3.0909 - val_accuracy50: 0.4903 - 36s/epoch - 24ms/step
Epoch 20/50
1489/1489 - 37s - loss: 2.8896 - accuracy50: 0.5173 - val_loss: 3.1022 - val_accuracy50: 0.4902 - 37s/epoch - 25ms/step
Epoch 21/50
1489/1489 - 37s - loss: 2.8875 - accuracy50: 0.5180 - val_loss: 3.0976 - val_accuracy50: 0.4898 - 37s/epoch - 25ms/step
Epoch 22/50
1489/1489 - 36s - loss: 2.8829 - accuracy50: 0.5188 - val_loss: 3.0863 - val_accuracy50: 0.4920 - 36s/epoch - 24ms/step
Epoch 23/50
1489/1489 - 36s - loss: 2.8793 - accuracy50: 0.5203 - val_loss: 3.0896 - val_accuracy50: 0.4911 - 36s/epoch - 24ms/step
Epoch 24/50
1489/1489 - 36s - loss: 2.8763 - accuracy50: 0.5206 - val_loss: 3.0758 - val_accuracy50: 0.4924 - 36s/epoch - 24ms/step
Epoch 25/50
1489/1489 - 36s - loss: 2.8729 - accuracy50: 0.5210 - val_loss: 3.0953 - val_accuracy50: 0.4910 - 36s/epoch - 24ms/step
Epoch 26/50
1489/1489 - 37s - loss: 2.8700 - accuracy50: 0.5226 - val_loss: 3.0815 - val_accuracy50: 0.4932 - 37s/epoch - 25ms/step
Epoch 27/50
1489/1489 - 37s - loss: 2.8660 - accuracy50: 0.5238 - val_loss: 3.0768 - val_accuracy50: 0.4940 - 37s/epoch - 25ms/step
Epoch 28/50
1489/1489 - 37s - loss: 2.8643 - accuracy50: 0.5237 - val_loss: 3.0715 - val_accuracy50: 0.4940 - 37s/epoch - 25ms/step
Epoch 29/50
1489/1489 - 37s - loss: 2.8590 - accuracy50: 0.5247 - val_loss: 3.0883 - val_accuracy50: 0.4909 - 37s/epoch - 25ms/step
Epoch 30/50
1489/1489 - 36s - loss: 2.8566 - accuracy50: 0.5262 - val_loss: 3.0851 - val_accuracy50: 0.4931 - 36s/epoch - 24ms/step
Epoch 31/50
1489/1489 - 37s - loss: 2.8543 - accuracy50: 0.5266 - val_loss: 3.0955 - val_accuracy50: 0.4941 - 37s/epoch - 25ms/step
Epoch 32/50
1489/1489 - 36s - loss: 2.8507 - accuracy50: 0.5270 - val_loss: 3.1026 - val_accuracy50: 0.4941 - 36s/epoch - 24ms/step
Epoch 33/50
1489/1489 - 37s - loss: 2.8471 - accuracy50: 0.5281 - val_loss: 3.0922 - val_accuracy50: 0.4957 - 37s/epoch - 25ms/step
Epoch 34/50
1489/1489 - 37s - loss: 2.8445 - accuracy50: 0.5295 - val_loss: 3.1089 - val_accuracy50: 0.4942 - 37s/epoch - 25ms/step
Epoch 35/50
1489/1489 - 36s - loss: 2.8411 - accuracy50: 0.5298 - val_loss: 3.0969 - val_accuracy50: 0.4939 - 36s/epoch - 24ms/step
Epoch 36/50
1489/1489 - 36s - loss: 2.8386 - accuracy50: 0.5300 - val_loss: 3.1023 - val_accuracy50: 0.4935 - 36s/epoch - 24ms/step
Epoch 37/50
1489/1489 - 36s - loss: 2.8371 - accuracy50: 0.5309 - val_loss: 3.1116 - val_accuracy50: 0.4932 - 36s/epoch - 24ms/step
Epoch 38/50
1489/1489 - 37s - loss: 2.8339 - accuracy50: 0.5306 - val_loss: 3.1033 - val_accuracy50: 0.4918 - 37s/epoch - 25ms/step
testing model: results/WBA/W6/deepVOL_L2/h50
Evaluating performance on  test set...
5183/5183 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0749819
{'0': {'precision': 0.4977442251195609, 'recall': 0.3381569376648643, 'f1-score': 0.4027166617309978, 'support': 456436}, '1': {'precision': 0.4219606014687026, 'recall': 0.7005210183250498, 'f1-score': 0.5266763660472569, 'support': 408239}, '2': {'precision': 0.5062506268325634, 'recall': 0.37134356777341426, 'f1-score': 0.4284278886779476, 'support': 462165}, 'accuracy': 0.46120783214253414, 'macro avg': {'precision': 0.4753184844736089, 'recall': 0.47000717458777613, 'f1-score': 0.4526069721520674, 'support': 1326840}, 'weighted avg': {'precision': 0.47739024906524163, 'recall': 0.46120783214253414, 'f1-score': 0.4498120273608419, 'support': 1326840}}
[[154347 205033  97056]
 [ 51931 285980  70328]
 [103815 186728 171622]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0359191
{'0': {'precision': 0.5188925754426903, 'recall': 0.3324016692099281, 'f1-score': 0.40522007355558193, 'support': 128444}, '1': {'precision': 0.44983274320702676, 'recall': 0.7338146715066417, 'f1-score': 0.5577570864196034, 'support': 125345}, '2': {'precision': 0.5110168592938182, 'recall': 0.3786514558682569, 'f1-score': 0.43498745419427043, 'support': 127278}, 'accuracy': 0.4798867390773801, 'macro avg': {'precision': 0.4932473926478451, 'recall': 0.48162259886160896, 'f1-score': 0.4659882047231519, 'support': 381067}, 'weighted avg': {'precision': 0.4935460876293258, 'recall': 0.4798867390773801, 'f1-score': 0.4653367578929078, 'support': 381067}}
[[42695 60317 25432]
 [12681 91980 20684]
 [26905 52179 48194]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0250641
{'0': {'precision': 0.5196657598134473, 'recall': 0.31530915436494833, 'f1-score': 0.3924797463895737, 'support': 42406}, '1': {'precision': 0.4807171942729542, 'recall': 0.7575293411438389, 'f1-score': 0.5881823514757998, 'support': 48311}, '2': {'precision': 0.506150459665933, 'recall': 0.3719757345069585, 'f1-score': 0.4288123740178535, 'support': 42035}, 'accuracy': 0.4941846450524286, 'macro avg': {'precision': 0.5021778045841115, 'recall': 0.48160474333858194, 'f1-score': 0.46982482396107567, 'support': 132752}, 'weighted avg': {'precision': 0.5012121034351815, 'recall': 0.4941846450524286, 'f1-score': 0.4752041539817411, 'support': 132752}}
[[13371 21212  7823]
 [ 4281 36597  7433]
 [ 8078 18321 15636]]
training model: results/WBA/W6/deepVOL_L2/h100
Epoch 1/50
1489/1489 - 39s - loss: 3.2491 - accuracy100: 0.3990 - val_loss: 3.2901 - val_accuracy100: 0.3657 - 39s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 37s - loss: 3.1992 - accuracy100: 0.4185 - val_loss: 3.2996 - val_accuracy100: 0.3672 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 37s - loss: 3.1857 - accuracy100: 0.4251 - val_loss: 3.2836 - val_accuracy100: 0.3771 - 37s/epoch - 25ms/step
Epoch 4/50
1489/1489 - 39s - loss: 3.1783 - accuracy100: 0.4284 - val_loss: 3.2895 - val_accuracy100: 0.3931 - 39s/epoch - 26ms/step
Epoch 5/50
1489/1489 - 37s - loss: 3.1721 - accuracy100: 0.4310 - val_loss: 3.3006 - val_accuracy100: 0.3937 - 37s/epoch - 25ms/step
Epoch 6/50
1489/1489 - 36s - loss: 3.1677 - accuracy100: 0.4331 - val_loss: 3.2928 - val_accuracy100: 0.3973 - 36s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 36s - loss: 3.1664 - accuracy100: 0.4347 - val_loss: 3.3010 - val_accuracy100: 0.3989 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 36s - loss: 3.1630 - accuracy100: 0.4362 - val_loss: 3.3020 - val_accuracy100: 0.4001 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 36s - loss: 3.1592 - accuracy100: 0.4368 - val_loss: 3.3280 - val_accuracy100: 0.3987 - 36s/epoch - 24ms/step
Epoch 10/50
1489/1489 - 37s - loss: 3.1551 - accuracy100: 0.4388 - val_loss: 3.3087 - val_accuracy100: 0.3993 - 37s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 36s - loss: 3.1526 - accuracy100: 0.4395 - val_loss: 3.3129 - val_accuracy100: 0.3996 - 36s/epoch - 24ms/step
Epoch 12/50
1489/1489 - 36s - loss: 3.1498 - accuracy100: 0.4408 - val_loss: 3.3144 - val_accuracy100: 0.4006 - 36s/epoch - 24ms/step
Epoch 13/50
1489/1489 - 36s - loss: 3.1468 - accuracy100: 0.4415 - val_loss: 3.3203 - val_accuracy100: 0.3990 - 36s/epoch - 24ms/step
testing model: results/WBA/W6/deepVOL_L2/h100
Evaluating performance on  test set...
5183/5183 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0910052
{'0': {'precision': 0.4039071806356316, 'recall': 0.10453621672816243, 'f1-score': 0.1660870365980058, 'support': 405448}, '1': {'precision': 0.37825585699221603, 'recall': 0.6826224532627296, 'f1-score': 0.48677767952286966, 'support': 495536}, '2': {'precision': 0.3851882599990233, 'recall': 0.29634430417793806, 'f1-score': 0.33497547406196243, 'support': 425856}, 'accuracy': 0.3819963220885713, 'macro avg': {'precision': 0.389117099208957, 'recall': 0.36116765805627676, 'f1-score': 0.32928006339427934, 'support': 1326840}, 'weighted avg': {'precision': 0.38831922807195624, 'recall': 0.3819963220885713, 'f1-score': 0.3400612255409575, 'support': 1326840}}
[[ 42384 286974  76090]
 [ 31930 338264 125342]
 [ 30621 269035 126200]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063912
{'0': {'precision': 0.44651384909264563, 'recall': 0.08672195642260336, 'f1-score': 0.14523613816849723, 'support': 129379}, '1': {'precision': 0.3384816405730426, 'recall': 0.6908440526664591, 'f1-score': 0.45435187300286983, 'support': 125241}, '2': {'precision': 0.4023883334496267, 'recall': 0.3192483807445016, 'f1-score': 0.3560290693572285, 'support': 126447}, 'accuracy': 0.3624297039628202, 'macro avg': {'precision': 0.39579460770510494, 'recall': 0.365604796611188, 'f1-score': 0.31853902684286517, 'support': 381067}, 'weighted avg': {'precision': 0.3963662348838151, 'recall': 0.3624297039628202, 'f1-score': 0.3167757821586962, 'support': 381067}}
[[11220 90607 27552]
 [ 6318 86522 32401]
 [ 7590 78489 40368]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965817
{'0': {'precision': 0.44648318042813456, 'recall': 0.08464553233923147, 'f1-score': 0.14231129132875858, 'support': 43121}, '1': {'precision': 0.363857135043483, 'recall': 0.7112280026514423, 'f1-score': 0.48142305075914366, 'support': 46767}, '2': {'precision': 0.40299137567094867, 'recall': 0.31177678238148565, 'f1-score': 0.35156393865256624, 'support': 42864}, 'accuracy': 0.37872122453899, 'macro avg': {'precision': 0.4044438970475221, 'recall': 0.36921677245738643, 'f1-score': 0.3250994269134895, 'support': 132752}, 'weighted avg': {'precision': 0.40333200392144525, 'recall': 0.37872122453899, 'f1-score': 0.32934158185672435, 'support': 132752}}
[[ 3650 30923  8548]
 [ 2255 33262 11250]
 [ 2270 27230 13364]]
training model: results/WBA/W6/deepVOL_L2/h200
Epoch 1/50
1489/1489 - 39s - loss: 3.3012 - accuracy200: 0.3609 - val_loss: 3.3412 - val_accuracy200: 0.3354 - 39s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 36s - loss: 3.2673 - accuracy200: 0.3793 - val_loss: 3.3605 - val_accuracy200: 0.3420 - 36s/epoch - 24ms/step
Epoch 3/50
1489/1489 - 36s - loss: 3.2544 - accuracy200: 0.3876 - val_loss: 3.3690 - val_accuracy200: 0.3472 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 36s - loss: 3.2486 - accuracy200: 0.3911 - val_loss: 3.3917 - val_accuracy200: 0.3499 - 36s/epoch - 24ms/step
Epoch 5/50
1489/1489 - 37s - loss: 3.2427 - accuracy200: 0.3946 - val_loss: 3.3920 - val_accuracy200: 0.3509 - 37s/epoch - 25ms/step
Epoch 6/50
1489/1489 - 38s - loss: 3.2387 - accuracy200: 0.3977 - val_loss: 3.4113 - val_accuracy200: 0.3495 - 38s/epoch - 25ms/step
Epoch 7/50
1489/1489 - 37s - loss: 3.2361 - accuracy200: 0.3987 - val_loss: 3.4339 - val_accuracy200: 0.3494 - 37s/epoch - 25ms/step
Epoch 8/50
1489/1489 - 36s - loss: 3.2300 - accuracy200: 0.4021 - val_loss: 3.4445 - val_accuracy200: 0.3516 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 37s - loss: 3.2262 - accuracy200: 0.4040 - val_loss: 3.4597 - val_accuracy200: 0.3516 - 37s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 36s - loss: 3.2221 - accuracy200: 0.4065 - val_loss: 3.4436 - val_accuracy200: 0.3556 - 36s/epoch - 24ms/step
Epoch 11/50
1489/1489 - 37s - loss: 3.2173 - accuracy200: 0.4097 - val_loss: 3.4518 - val_accuracy200: 0.3557 - 37s/epoch - 25ms/step
testing model: results/WBA/W6/deepVOL_L2/h200
Evaluating performance on  test set...
5183/5183 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1256461
{'0': {'precision': 0.3857866372313486, 'recall': 0.026498350960991696, 'f1-score': 0.04959050172667425, 'support': 448443}, '1': {'precision': 0.29663143053902646, 'recall': 0.9276095733144623, 'f1-score': 0.4495163188422244, 'support': 392842}, '2': {'precision': 0.3856343614942869, 'recall': 0.053660244462522266, 'f1-score': 0.0942111914434326, 'support': 485555}, 'accuracy': 0.3032332459075699, 'macro avg': {'precision': 0.356017476421554, 'recall': 0.33592272291265873, 'f1-score': 0.19777267067077708, 'support': 1326840}, 'weighted avg': {'precision': 0.3593344290126228, 'recall': 0.3032332459075699, 'f1-score': 0.18432675993620032, 'support': 1326840}}
[[ 11883 415275  21285]
 [  8214 364404  20224]
 [ 10705 448795  26055]]
Evaluating performance on  train set...
1489/1489 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1171889
{'0': {'precision': 0.38237711655433176, 'recall': 0.017936182353757654, 'f1-score': 0.03426509041358229, 'support': 129682}, '1': {'precision': 0.32914307349766614, 'recall': 0.929324759868526, 'f1-score': 0.4861162115243374, 'support': 125348}, '2': {'precision': 0.3489652553635846, 'recall': 0.05833207708847402, 'f1-score': 0.09995581387444342, 'support': 126037}, 'accuracy': 0.33108875866973525, 'macro avg': {'precision': 0.35349514847186086, 'recall': 0.3351976731035859, 'f1-score': 0.20677903860412106, 'support': 381067}, 'weighted avg': {'precision': 0.3538154421559579, 'recall': 0.33108875866973525, 'f1-score': 0.2046238358358505, 'support': 381067}}
[[  2326 120714   6642]
 [  1785 116489   7074]
 [  1972 116713   7352]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154176
{'0': {'precision': 0.39009661835748793, 'recall': 0.02183711182223825, 'f1-score': 0.0413589995304964, 'support': 44374}, '1': {'precision': 0.33271467358268836, 'recall': 0.9295564160043476, 'f1-score': 0.4900327070451453, 'support': 44163}, '2': {'precision': 0.35420601481911956, 'recall': 0.055139658486938824, 'f1-score': 0.09542447845316843, 'support': 44215}, 'accuracy': 0.3349026756659033, 'macro avg': {'precision': 0.35900576891976527, 'recall': 0.33551106210450826, 'f1-score': 0.2089387283429367, 'support': 132752}, 'weighted avg': {'precision': 0.3590533055445855, 'recall': 0.3349026756659033, 'f1-score': 0.20862790768657224, 'support': 132752}}
[[  969 41217  2188]
 [  854 41052  2257]
 [  661 41116  2438]]
training model: results/WBA/W6/deepVOL_L2/h300
Epoch 1/50
1489/1489 - 38s - loss: 3.2879 - accuracy300: 0.3719 - val_loss: 3.3455 - val_accuracy300: 0.3548 - 38s/epoch - 26ms/step
Epoch 2/50
1489/1489 - 36s - loss: 3.2679 - accuracy300: 0.3735 - val_loss: 3.3304 - val_accuracy300: 0.3572 - 36s/epoch - 24ms/step
Epoch 3/50
1489/1489 - 36s - loss: 3.2539 - accuracy300: 0.3842 - val_loss: 3.3306 - val_accuracy300: 0.3534 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 36s - loss: 3.2485 - accuracy300: 0.3872 - val_loss: 3.3566 - val_accuracy300: 0.3527 - 36s/epoch - 24ms/step
Epoch 5/50
1489/1489 - 38s - loss: 3.2459 - accuracy300: 0.3885 - val_loss: 3.3568 - val_accuracy300: 0.3538 - 38s/epoch - 25ms/step
Epoch 6/50
1489/1489 - 37s - loss: 3.2427 - accuracy300: 0.3884 - val_loss: 3.3633 - val_accuracy300: 0.3560 - 37s/epoch - 25ms/step
Epoch 7/50
1489/1489 - 38s - loss: 3.2421 - accuracy300: 0.3897 - val_loss: 3.3818 - val_accuracy300: 0.3545 - 38s/epoch - 25ms/step
Epoch 8/50
1489/1489 - 36s - loss: 3.2408 - accuracy300: 0.3911 - val_loss: 3.3496 - val_accuracy300: 0.3536 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 37s - loss: 3.2417 - accuracy300: 0.3921 - val_loss: 3.3626 - val_accuracy300: 0.3444 - 37s/epoch - 25ms/step
Epoch 10/50
1489/1489 - 37s - loss: 3.2385 - accuracy300: 0.3961 - val_loss: 3.3617 - val_accuracy300: 0.3515 - 37s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 37s - loss: 3.2396 - accuracy300: 0.3949 - val_loss: 3.3739 - val_accuracy300: 0.3547 - 37s/epoch - 25ms/step
Epoch 12/50
1489/1489 - 37s - loss: 3.2343 - accuracy300: 0.3989 - val_loss: 3.3971 - val_accuracy300: 0.3536 - 37s/epoch - 25ms/step
testing model: results/WBA/W6/deepVOL_L2/h300
Evaluating performance on  test set...
5183/5183 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871404
{'0': {'precision': 0.28424242424242424, 'recall': 0.008973966476781945, 'f1-score': 0.01739863163975346, 'support': 365836}, '1': {'precision': 0.42050231522079123, 'recall': 0.827188223012998, 'f1-score': 0.5575654414959768, 'support': 562317}, '2': {'precision': 0.31466250980242144, 'recall': 0.16505679894252884, 'f1-score': 0.216531566140578, 'support': 398687}, 'accuracy': 0.40263407795966355, 'macro avg': {'precision': 0.33980241642187897, 'recall': 0.3337396628107696, 'f1-score': 0.26383187975876937, 'support': 1326840}, 'weighted avg': {'precision': 0.35113017692318527, 'recall': 0.40263407795966355, 'f1-score': 0.30615740607770536, 'support': 1326840}}
[[  3283 311214  51339]
 [  5188 465142  91987]
 [  3079 329802  65806]]
Evaluating performance on  train set...
1489/1489 - 16s - 16s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1248009
{'0': {'precision': 0.3906158357771261, 'recall': 0.005127731325356862, 'f1-score': 0.010122580498073517, 'support': 129882}, '1': {'precision': 0.32839409320082374, 'recall': 0.7713906716655017, 'f1-score': 0.4606722119049483, 'support': 125896}, '2': {'precision': 0.3504513660548813, 'recall': 0.23393913272513947, 'f1-score': 0.2805804981715839, 'support': 125289}, 'accuracy': 0.33351352911692694, 'macro avg': {'precision': 0.3564870983442771, 'recall': 0.33681917857199933, 'f1-score': 0.25045843019153524, 'support': 381067}, 'weighted avg': {'precision': 0.3568537027390606, 'recall': 0.33351352911692694, 'f1-score': 0.24789651117954517, 'support': 381067}}
[[   666 103158  26058]
 [   514  97115  28267]
 [   525  95454  29310]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1124178
{'0': {'precision': 0.3141809290953545, 'recall': 0.0060364063417498535, 'f1-score': 0.01184522849307492, 'support': 42575}, '1': {'precision': 0.35991424288993873, 'recall': 0.8027251184834123, 'f1-score': 0.49699367295877606, 'support': 47264}, '2': {'precision': 0.3526395173453997, 'recall': 0.21792929881387924, 'f1-score': 0.26938199415263636, 'support': 42913}, 'accuracy': 0.35817916114258164, 'macro avg': {'precision': 0.3422448964435643, 'recall': 0.3422302745463471, 'f1-score': 0.2594069652014958, 'support': 132752}, 'weighted avg': {'precision': 0.34289547004962573, 'recall': 0.35817916114258164, 'f1-score': 0.2678242819459468, 'support': 132752}}
[[  257 34135  8183]
 [  339 37940  8985]
 [  222 33339  9352]]
training model: results/WBA/W6/deepVOL_L2/h500
Epoch 1/50
1489/1489 - 40s - loss: 3.2596 - accuracy500: 0.3969 - val_loss: 3.3446 - val_accuracy500: 0.3200 - 40s/epoch - 27ms/step
Epoch 2/50
1489/1489 - 37s - loss: 3.2392 - accuracy500: 0.4043 - val_loss: 3.3056 - val_accuracy500: 0.3437 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 37s - loss: 3.2226 - accuracy500: 0.4088 - val_loss: 3.3281 - val_accuracy500: 0.3330 - 37s/epoch - 25ms/step
Epoch 4/50
1489/1489 - 38s - loss: 3.2225 - accuracy500: 0.4070 - val_loss: 3.3125 - val_accuracy500: 0.3428 - 38s/epoch - 26ms/step
Epoch 5/50
1489/1489 - 36s - loss: 3.2173 - accuracy500: 0.4107 - val_loss: 3.3244 - val_accuracy500: 0.3271 - 36s/epoch - 24ms/step
Epoch 6/50
1489/1489 - 37s - loss: 3.2220 - accuracy500: 0.4066 - val_loss: 3.3001 - val_accuracy500: 0.3594 - 37s/epoch - 25ms/step
Epoch 7/50
1489/1489 - 36s - loss: 3.2189 - accuracy500: 0.4108 - val_loss: 3.3228 - val_accuracy500: 0.3380 - 36s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 36s - loss: 3.2108 - accuracy500: 0.4126 - val_loss: 3.3288 - val_accuracy500: 0.3408 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 36s - loss: 3.2105 - accuracy500: 0.4128 - val_loss: 3.3549 - val_accuracy500: 0.3263 - 36s/epoch - 24ms/step
Epoch 10/50
1489/1489 - 37s - loss: 3.2032 - accuracy500: 0.4146 - val_loss: 3.3662 - val_accuracy500: 0.3374 - 37s/epoch - 25ms/step
Epoch 11/50
1489/1489 - 36s - loss: 3.1999 - accuracy500: 0.4162 - val_loss: 3.3920 - val_accuracy500: 0.3393 - 36s/epoch - 24ms/step
Epoch 12/50
1489/1489 - 37s - loss: 3.1953 - accuracy500: 0.4191 - val_loss: 3.3628 - val_accuracy500: 0.3417 - 37s/epoch - 25ms/step
Epoch 13/50
1489/1489 - 36s - loss: 3.1883 - accuracy500: 0.4214 - val_loss: 3.3717 - val_accuracy500: 0.3379 - 36s/epoch - 24ms/step
Epoch 14/50
1489/1489 - 36s - loss: 3.1832 - accuracy500: 0.4238 - val_loss: 3.3818 - val_accuracy500: 0.3349 - 36s/epoch - 24ms/step
Epoch 15/50
1489/1489 - 36s - loss: 3.1809 - accuracy500: 0.4240 - val_loss: 3.3913 - val_accuracy500: 0.3400 - 36s/epoch - 24ms/step
Epoch 16/50
1489/1489 - 37s - loss: 3.1763 - accuracy500: 0.4267 - val_loss: 3.3676 - val_accuracy500: 0.3393 - 37s/epoch - 25ms/step
testing model: results/WBA/W6/deepVOL_L2/h500
Evaluating performance on  test set...
5183/5183 - 54s - 54s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037515
{'0': {'precision': 0.33406465858906126, 'recall': 0.22587498923311033, 'f1-score': 0.26951780055385843, 'support': 417948}, '1': {'precision': 0.3461064419521608, 'recall': 0.6944662032415883, 'f1-score': 0.46197490923897705, 'support': 446818}, '2': {'precision': 0.31658124750343597, 'recall': 0.10119591234304462, 'f1-score': 0.15336754256064103, 'support': 462074}, 'accuracy': 0.3402550420548069, 'macro avg': {'precision': 0.33225078268155267, 'recall': 0.3405123682725811, 'f1-score': 0.29495341745115883, 'support': 1326840}, 'weighted avg': {'precision': 0.3320311472875887, 'recall': 0.3402550420548069, 'f1-score': 0.29387890368348174, 'support': 1326840}}
[[ 94404 278389  45155]
 [ 80730 310300  55788]
 [107458 307856  46760]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022519
{'0': {'precision': 0.3756723568377177, 'recall': 0.16749691548426898, 'f1-score': 0.23169190235681258, 'support': 129680}, '1': {'precision': 0.34618387457534133, 'recall': 0.7685989131113748, 'f1-score': 0.4773603479964502, 'support': 128072}, '2': {'precision': 0.302503727314791, 'recall': 0.09543040181648624, 'f1-score': 0.14508960219952288, 'support': 123315}, 'accuracy': 0.3461989623871918, 'macro avg': {'precision': 0.34145331957595, 'recall': 0.34384207680404333, 'f1-score': 0.2847139508509286, 'support': 381067}, 'weighted avg': {'precision': 0.342083936822532, 'recall': 0.3461989623871918, 'f1-score': 0.2862331943764928, 'support': 381067}}
[[21721 95378 12581]
 [15083 98436 14553]
 [21015 90532 11768]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0997806
{'0': {'precision': 0.36646485031954257, 'recall': 0.15372495531934907, 'f1-score': 0.2165932209005666, 'support': 42524}, '1': {'precision': 0.36937703987512416, 'recall': 0.7593981828790531, 'f1-score': 0.49700639635585014, 'support': 47988}, '2': {'precision': 0.2943528543307087, 'recall': 0.11328125, 'f1-score': 0.16360092997811818, 'support': 42240}, 'accuracy': 0.3597987224297939, 'macro avg': {'precision': 0.34339824817512515, 'recall': 0.34213479606613406, 'f1-score': 0.2924001824115116, 'support': 132752}, 'weighted avg': {'precision': 0.3445724452471136, 'recall': 0.3597987224297939, 'f1-score': 0.3010972064916231, 'support': 132752}}
[[ 6537 30991  4996]
 [ 5071 36442  6475]
 [ 6230 31225  4785]]
training model: results/WBA/W6/deepVOL_L2/h1000
Epoch 1/50
1489/1489 - 39s - loss: 3.2973 - accuracy1000: 0.3709 - val_loss: 3.3574 - val_accuracy1000: 0.3412 - 39s/epoch - 27ms/step
Epoch 2/50
1489/1489 - 37s - loss: 3.2632 - accuracy1000: 0.3841 - val_loss: 3.3758 - val_accuracy1000: 0.3363 - 37s/epoch - 25ms/step
Epoch 3/50
1489/1489 - 36s - loss: 3.2606 - accuracy1000: 0.3823 - val_loss: 3.3968 - val_accuracy1000: 0.3360 - 36s/epoch - 24ms/step
Epoch 4/50
1489/1489 - 37s - loss: 3.2545 - accuracy1000: 0.3860 - val_loss: 3.4109 - val_accuracy1000: 0.3360 - 37s/epoch - 25ms/step
Epoch 5/50
1489/1489 - 36s - loss: 3.2495 - accuracy1000: 0.3861 - val_loss: 3.3922 - val_accuracy1000: 0.3364 - 36s/epoch - 24ms/step
Epoch 6/50
1489/1489 - 35s - loss: 3.2450 - accuracy1000: 0.3891 - val_loss: 3.4094 - val_accuracy1000: 0.3387 - 35s/epoch - 24ms/step
Epoch 7/50
1489/1489 - 35s - loss: 3.2404 - accuracy1000: 0.3905 - val_loss: 3.3894 - val_accuracy1000: 0.3462 - 35s/epoch - 24ms/step
Epoch 8/50
1489/1489 - 36s - loss: 3.2353 - accuracy1000: 0.3936 - val_loss: 3.3876 - val_accuracy1000: 0.3480 - 36s/epoch - 24ms/step
Epoch 9/50
1489/1489 - 36s - loss: 3.2310 - accuracy1000: 0.3969 - val_loss: 3.4158 - val_accuracy1000: 0.3420 - 36s/epoch - 24ms/step
Epoch 10/50
1489/1489 - 36s - loss: 3.2276 - accuracy1000: 0.3969 - val_loss: 3.4017 - val_accuracy1000: 0.3400 - 36s/epoch - 24ms/step
Epoch 11/50
1489/1489 - 35s - loss: 3.2245 - accuracy1000: 0.3995 - val_loss: 3.4224 - val_accuracy1000: 0.3412 - 35s/epoch - 24ms/step
testing model: results/WBA/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
5183/5183 - 52s - 52s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1521332
{'0': {'precision': 0.3675291886707165, 'recall': 0.07338609371388317, 'f1-score': 0.12234337325078262, 'support': 454255}, '1': {'precision': 0.2732020508875663, 'recall': 0.9424124535493628, 'f1-score': 0.4236030652018725, 'support': 355754}, '2': {'precision': 0.42707287133132465, 'recall': 0.007404741588643096, 'f1-score': 0.014557087213194571, 'support': 516831}, 'accuracy': 0.2806894576587983, 'macro avg': {'precision': 0.3559347036298692, 'recall': 0.34106776295062974, 'f1-score': 0.18683450855528325, 'support': 1326840}, 'weighted avg': {'precision': 0.36543154651209747, 'recall': 0.2806894576587983, 'f1-score': 0.1611325614356997, 'support': 1326840}}
[[ 33336 417689   3230]
 [ 18583 335267   1904]
 [ 38784 474220   3827]]
Evaluating performance on  train set...
1489/1489 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1305888
{'0': {'precision': 0.3885942369730439, 'recall': 0.053404770134808155, 'f1-score': 0.09390421954587196, 'support': 133078}, '1': {'precision': 0.325218592957852, 'recall': 0.9617278277424014, 'f1-score': 0.48606805367485284, 'support': 121864}, '2': {'precision': 0.382952182952183, 'recall': 0.007302279484638256, 'f1-score': 0.014331284525013616, 'support': 126125}, 'accuracy': 0.32862462506593326, 'macro avg': {'precision': 0.36558833762769294, 'recall': 0.3408116257872826, 'f1-score': 0.19810118591524614, 'support': 381067}, 'weighted avg': {'precision': 0.36645951120133324, 'recall': 0.32862462506593326, 'f1-score': 0.19298001737876846, 'support': 381067}}
[[  7107 125059    912]
 [  4092 117200    572]
 [  7090 118114    921]]
Evaluating performance on  val set...
519/519 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1239244
{'0': {'precision': 0.3863080684596577, 'recall': 0.05368185009852998, 'f1-score': 0.0942645772014955, 'support': 44149}, '1': {'precision': 0.3408941041876872, 'recall': 0.9623001188633968, 'f1-score': 0.5034436635417522, 'support': 44589}, '2': {'precision': 0.3770053475935829, 'recall': 0.006407052301540419, 'f1-score': 0.012599973191546402, 'support': 44014}, 'accuracy': 0.3431963360250693, 'macro avg': {'precision': 0.3680691734136426, 'recall': 0.34079634042115575, 'f1-score': 0.20343607131159802, 'support': 132752}, 'weighted avg': {'precision': 0.36797001548025016, 'recall': 0.3431963360250693, 'f1-score': 0.20462449946204, 'support': 132752}}
[[ 2370 41494   285]
 [ 1500 42908   181]
 [ 2265 41467   282]]
training model: results/WBA/W6/deepVOL_L3/h10
Epoch 1/50
1489/1489 - 57s - loss: 3.2685 - accuracy10: 0.4177 - val_loss: 3.0869 - val_accuracy10: 0.5777 - 57s/epoch - 39ms/step
Epoch 2/50
1489/1489 - 54s - loss: 3.0016 - accuracy10: 0.4710 - val_loss: 2.7718 - val_accuracy10: 0.5764 - 54s/epoch - 37ms/step
Epoch 3/50
1489/1489 - 55s - loss: 2.8017 - accuracy10: 0.5221 - val_loss: 2.6804 - val_accuracy10: 0.6081 - 55s/epoch - 37ms/step
Epoch 4/50
1489/1489 - 55s - loss: 2.7375 - accuracy10: 0.5447 - val_loss: 2.6728 - val_accuracy10: 0.6005 - 55s/epoch - 37ms/step
Epoch 5/50
1489/1489 - 55s - loss: 2.6992 - accuracy10: 0.5547 - val_loss: 2.6462 - val_accuracy10: 0.6067 - 55s/epoch - 37ms/step
Epoch 6/50
1489/1489 - 54s - loss: 2.6766 - accuracy10: 0.5599 - val_loss: 2.6602 - val_accuracy10: 0.6167 - 54s/epoch - 37ms/step
Epoch 7/50
1489/1489 - 55s - loss: 2.6610 - accuracy10: 0.5629 - val_loss: 2.6661 - val_accuracy10: 0.6164 - 55s/epoch - 37ms/step
Epoch 8/50
1489/1489 - 55s - loss: 2.6438 - accuracy10: 0.5660 - val_loss: 2.6582 - val_accuracy10: 0.6175 - 55s/epoch - 37ms/step
Epoch 9/50
1489/1489 - 55s - loss: 2.6301 - accuracy10: 0.5686 - val_loss: 2.6342 - val_accuracy10: 0.6219 - 55s/epoch - 37ms/step
Epoch 10/50
1489/1489 - 55s - loss: 2.6206 - accuracy10: 0.5701 - val_loss: 2.6360 - val_accuracy10: 0.6291 - 55s/epoch - 37ms/step
Epoch 11/50
1489/1489 - 55s - loss: 2.6079 - accuracy10: 0.5722 - val_loss: 2.6703 - val_accuracy10: 0.6242 - 55s/epoch - 37ms/step
Epoch 12/50
1489/1489 - 55s - loss: 2.6023 - accuracy10: 0.5730 - val_loss: 2.6136 - val_accuracy10: 0.6254 - 55s/epoch - 37ms/step
Epoch 13/50
1489/1489 - 55s - loss: 2.5923 - accuracy10: 0.5746 - val_loss: 2.6011 - val_accuracy10: 0.6282 - 55s/epoch - 37ms/step
Epoch 14/50
1489/1489 - 55s - loss: 2.5845 - accuracy10: 0.5762 - val_loss: 2.5924 - val_accuracy10: 0.6305 - 55s/epoch - 37ms/step
Epoch 15/50
1489/1489 - 55s - loss: 2.5797 - accuracy10: 0.5778 - val_loss: 2.5916 - val_accuracy10: 0.6336 - 55s/epoch - 37ms/step
Epoch 16/50
1489/1489 - 55s - loss: 2.5725 - accuracy10: 0.5786 - val_loss: 2.5696 - val_accuracy10: 0.6344 - 55s/epoch - 37ms/step
Epoch 17/50
1489/1489 - 55s - loss: 2.5677 - accuracy10: 0.5793 - val_loss: 2.5771 - val_accuracy10: 0.6326 - 55s/epoch - 37ms/step
Epoch 18/50
1489/1489 - 55s - loss: 2.5627 - accuracy10: 0.5808 - val_loss: 2.5706 - val_accuracy10: 0.6343 - 55s/epoch - 37ms/step
Epoch 19/50
1489/1489 - 55s - loss: 2.5570 - accuracy10: 0.5812 - val_loss: 2.5985 - val_accuracy10: 0.6370 - 55s/epoch - 37ms/step
Epoch 20/50
1489/1489 - 56s - loss: 2.5521 - accuracy10: 0.5822 - val_loss: 2.5597 - val_accuracy10: 0.6369 - 56s/epoch - 37ms/step
Epoch 21/50
1489/1489 - 56s - loss: 2.5489 - accuracy10: 0.5818 - val_loss: 2.5636 - val_accuracy10: 0.6368 - 56s/epoch - 38ms/step
Epoch 22/50
1489/1489 - 56s - loss: 2.5430 - accuracy10: 0.5825 - val_loss: 2.5841 - val_accuracy10: 0.6386 - 56s/epoch - 38ms/step
Epoch 23/50
1489/1489 - 55s - loss: 2.5389 - accuracy10: 0.5833 - val_loss: 2.5631 - val_accuracy10: 0.6370 - 55s/epoch - 37ms/step
Epoch 24/50
1489/1489 - 56s - loss: 2.5360 - accuracy10: 0.5839 - val_loss: 2.5753 - val_accuracy10: 0.6375 - 56s/epoch - 37ms/step
Epoch 25/50
1489/1489 - 56s - loss: 2.5320 - accuracy10: 0.5844 - val_loss: 2.5834 - val_accuracy10: 0.6396 - 56s/epoch - 38ms/step
Epoch 26/50
1489/1489 - 56s - loss: 2.5289 - accuracy10: 0.5854 - val_loss: 2.5584 - val_accuracy10: 0.6350 - 56s/epoch - 38ms/step
Epoch 27/50
1489/1489 - 56s - loss: 2.5251 - accuracy10: 0.5849 - val_loss: 2.5741 - val_accuracy10: 0.6403 - 56s/epoch - 37ms/step
Epoch 28/50
1489/1489 - 55s - loss: 2.5215 - accuracy10: 0.5860 - val_loss: 2.5833 - val_accuracy10: 0.6387 - 55s/epoch - 37ms/step
Epoch 29/50
1489/1489 - 55s - loss: 2.5180 - accuracy10: 0.5861 - val_loss: 2.5569 - val_accuracy10: 0.6403 - 55s/epoch - 37ms/step
Epoch 30/50
1489/1489 - 55s - loss: 2.5139 - accuracy10: 0.5875 - val_loss: 2.5745 - val_accuracy10: 0.6392 - 55s/epoch - 37ms/step
Epoch 31/50
1489/1489 - 55s - loss: 2.5121 - accuracy10: 0.5872 - val_loss: 2.5652 - val_accuracy10: 0.6426 - 55s/epoch - 37ms/step
Epoch 32/50
1489/1489 - 55s - loss: 2.5095 - accuracy10: 0.5886 - val_loss: 2.5744 - val_accuracy10: 0.6400 - 55s/epoch - 37ms/step
Epoch 33/50
1489/1489 - 55s - loss: 2.5050 - accuracy10: 0.5886 - val_loss: 2.5505 - val_accuracy10: 0.6351 - 55s/epoch - 37ms/step
Epoch 34/50
1489/1489 - 55s - loss: 2.5041 - accuracy10: 0.5882 - val_loss: 2.5940 - val_accuracy10: 0.6404 - 55s/epoch - 37ms/step
Epoch 35/50
1489/1489 - 55s - loss: 2.4991 - accuracy10: 0.5895 - val_loss: 2.5818 - val_accuracy10: 0.6429 - 55s/epoch - 37ms/step
Epoch 36/50
1489/1489 - 55s - loss: 2.4954 - accuracy10: 0.5902 - val_loss: 2.5698 - val_accuracy10: 0.6415 - 55s/epoch - 37ms/step
Epoch 37/50
1489/1489 - 55s - loss: 2.4940 - accuracy10: 0.5906 - val_loss: 2.5695 - val_accuracy10: 0.6387 - 55s/epoch - 37ms/step
Epoch 38/50
1489/1489 - 55s - loss: 2.4900 - accuracy10: 0.5912 - val_loss: 2.5865 - val_accuracy10: 0.6382 - 55s/epoch - 37ms/step
Epoch 39/50
1489/1489 - 55s - loss: 2.4866 - accuracy10: 0.5913 - val_loss: 2.5669 - val_accuracy10: 0.6341 - 55s/epoch - 37ms/step
Epoch 40/50
1489/1489 - 55s - loss: 2.4833 - accuracy10: 0.5919 - val_loss: 2.5792 - val_accuracy10: 0.6358 - 55s/epoch - 37ms/step
Epoch 41/50
1489/1489 - 55s - loss: 2.4796 - accuracy10: 0.5918 - val_loss: 2.5679 - val_accuracy10: 0.6371 - 55s/epoch - 37ms/step
Epoch 42/50
1489/1489 - 55s - loss: 2.4763 - accuracy10: 0.5927 - val_loss: 2.5753 - val_accuracy10: 0.6344 - 55s/epoch - 37ms/step
Epoch 43/50
1489/1489 - 55s - loss: 2.4733 - accuracy10: 0.5930 - val_loss: 2.5743 - val_accuracy10: 0.6344 - 55s/epoch - 37ms/step
testing model: results/WBA/W6/deepVOL_L3/h10
Evaluating performance on  test set...
5183/5183 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.877406
{'0': {'precision': 0.4792816396603579, 'recall': 0.4908062188401994, 'f1-score': 0.4849754736335484, 'support': 304880}, '1': {'precision': 0.7389643204827899, 'recall': 0.666674185403594, 'f1-score': 0.7009603597754663, 'support': 709339}, '2': {'precision': 0.44321050917845, 'recall': 0.5311959209394123, 'f1-score': 0.4832308312345501, 'support': 312621}, 'accuracy': 0.5943429501673149, 'macro avg': {'precision': 0.5538188231071993, 'recall': 0.562892108394402, 'f1-score': 0.5563888882145217, 'support': 1326840}, 'weighted avg': {'precision': 0.6096111897564649, 'recall': 0.5943429501673149, 'f1-score': 0.6000316155192352, 'support': 1326840}}
[[149637  81555  73688]
 [101510 472898 134931]
 [ 61064  85494 166063]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83788216
{'0': {'precision': 0.4641101833753262, 'recall': 0.5119139602701827, 'f1-score': 0.48684140350461336, 'support': 80242}, '1': {'precision': 0.7681633159721324, 'recall': 0.6724850691189987, 'f1-score': 0.7171470373786197, 'support': 220851}, '2': {'precision': 0.43813056230283115, 'recall': 0.5435516542876435, 'f1-score': 0.4851806173301115, 'support': 79974}, 'accuracy': 0.6116142305683777, 'macro avg': {'precision': 0.5568013538834299, 'recall': 0.5759835612256082, 'f1-score': 0.5630563527377815, 'support': 381067}, 'weighted avg': {'precision': 0.6348747580340752, 'recall': 0.6116142305683777, 'f1-score': 0.6199686746490278, 'support': 381067}}
[[ 41077  23491  15674]
 [ 32259 148519  40073]
 [ 15171  21333  43470]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7970962
{'0': {'precision': 0.44881889763779526, 'recall': 0.49840665319446603, 'f1-score': 0.47231480287992333, 'support': 25732}, '1': {'precision': 0.7914325459603949, 'recall': 0.7110683608827242, 'f1-score': 0.7491012360021945, 'support': 81611}, '2': {'precision': 0.43746151103620395, 'recall': 0.5311897359203431, 'f1-score': 0.47979097792470937, 'support': 25409}, 'accuracy': 0.6354179221405327, 'macro avg': {'precision': 0.559237651544798, 'recall': 0.5802215833325111, 'f1-score': 0.5670690056022757, 'support': 132752}, 'weighted avg': {'precision': 0.6572712193888487, 'recall': 0.6354179221405327, 'f1-score': 0.6439037787541448, 'support': 132752}}
[[12825  8202  4705]
 [10929 58031 12651]
 [ 4821  7091 13497]]
training model: results/WBA/W6/deepVOL_L3/h20
Epoch 1/50
1489/1489 - 57s - loss: 3.2887 - accuracy20: 0.3911 - val_loss: 3.2107 - val_accuracy20: 0.4658 - 57s/epoch - 38ms/step
Epoch 2/50
1489/1489 - 55s - loss: 3.1492 - accuracy20: 0.4056 - val_loss: 3.0360 - val_accuracy20: 0.5044 - 55s/epoch - 37ms/step
Epoch 3/50
1489/1489 - 55s - loss: 2.9278 - accuracy20: 0.5034 - val_loss: 2.8864 - val_accuracy20: 0.5503 - 55s/epoch - 37ms/step
Epoch 4/50
1489/1489 - 55s - loss: 2.8504 - accuracy20: 0.5327 - val_loss: 2.8201 - val_accuracy20: 0.5584 - 55s/epoch - 37ms/step
Epoch 5/50
1489/1489 - 55s - loss: 2.8153 - accuracy20: 0.5440 - val_loss: 2.8182 - val_accuracy20: 0.5640 - 55s/epoch - 37ms/step
Epoch 6/50
1489/1489 - 55s - loss: 2.7886 - accuracy20: 0.5505 - val_loss: 2.7920 - val_accuracy20: 0.5783 - 55s/epoch - 37ms/step
Epoch 7/50
1489/1489 - 55s - loss: 2.7699 - accuracy20: 0.5544 - val_loss: 2.7697 - val_accuracy20: 0.5816 - 55s/epoch - 37ms/step
Epoch 8/50
1489/1489 - 55s - loss: 2.7534 - accuracy20: 0.5575 - val_loss: 2.7529 - val_accuracy20: 0.5814 - 55s/epoch - 37ms/step
Epoch 9/50
1489/1489 - 55s - loss: 2.7418 - accuracy20: 0.5598 - val_loss: 2.7369 - val_accuracy20: 0.5847 - 55s/epoch - 37ms/step
Epoch 10/50
1489/1489 - 56s - loss: 2.7283 - accuracy20: 0.5626 - val_loss: 2.7253 - val_accuracy20: 0.5868 - 56s/epoch - 38ms/step
Epoch 11/50
1489/1489 - 55s - loss: 2.7185 - accuracy20: 0.5638 - val_loss: 2.7135 - val_accuracy20: 0.5870 - 55s/epoch - 37ms/step
Epoch 12/50
1489/1489 - 55s - loss: 2.7096 - accuracy20: 0.5653 - val_loss: 2.7079 - val_accuracy20: 0.5945 - 55s/epoch - 37ms/step
Epoch 13/50
1489/1489 - 55s - loss: 2.7008 - accuracy20: 0.5671 - val_loss: 2.6918 - val_accuracy20: 0.5937 - 55s/epoch - 37ms/step
Epoch 14/50
1489/1489 - 54s - loss: 2.6958 - accuracy20: 0.5683 - val_loss: 2.6979 - val_accuracy20: 0.5951 - 54s/epoch - 37ms/step
Epoch 15/50
1489/1489 - 55s - loss: 2.6870 - accuracy20: 0.5692 - val_loss: 2.6940 - val_accuracy20: 0.5980 - 55s/epoch - 37ms/step
Epoch 16/50
1489/1489 - 55s - loss: 2.6809 - accuracy20: 0.5710 - val_loss: 2.6876 - val_accuracy20: 0.5990 - 55s/epoch - 37ms/step
Epoch 17/50
1489/1489 - 56s - loss: 2.6760 - accuracy20: 0.5712 - val_loss: 2.6752 - val_accuracy20: 0.5979 - 56s/epoch - 37ms/step
Epoch 18/50
1489/1489 - 56s - loss: 2.6706 - accuracy20: 0.5722 - val_loss: 2.6652 - val_accuracy20: 0.5953 - 56s/epoch - 38ms/step
Epoch 19/50
1489/1489 - 55s - loss: 2.6665 - accuracy20: 0.5727 - val_loss: 2.6607 - val_accuracy20: 0.5946 - 55s/epoch - 37ms/step
Epoch 20/50
1489/1489 - 55s - loss: 2.6626 - accuracy20: 0.5733 - val_loss: 2.6842 - val_accuracy20: 0.5966 - 55s/epoch - 37ms/step
Epoch 21/50
1489/1489 - 54s - loss: 2.6574 - accuracy20: 0.5748 - val_loss: 2.6691 - val_accuracy20: 0.5978 - 54s/epoch - 36ms/step
Epoch 22/50
1489/1489 - 55s - loss: 2.6555 - accuracy20: 0.5746 - val_loss: 2.6833 - val_accuracy20: 0.5974 - 55s/epoch - 37ms/step
Epoch 23/50
1489/1489 - 55s - loss: 2.6502 - accuracy20: 0.5760 - val_loss: 2.6925 - val_accuracy20: 0.5963 - 55s/epoch - 37ms/step
Epoch 24/50
1489/1489 - 55s - loss: 2.6473 - accuracy20: 0.5766 - val_loss: 2.6688 - val_accuracy20: 0.5968 - 55s/epoch - 37ms/step
Epoch 25/50
1489/1489 - 55s - loss: 2.6460 - accuracy20: 0.5766 - val_loss: 2.6759 - val_accuracy20: 0.5991 - 55s/epoch - 37ms/step
Epoch 26/50
1489/1489 - 55s - loss: 2.6414 - accuracy20: 0.5775 - val_loss: 2.6633 - val_accuracy20: 0.5951 - 55s/epoch - 37ms/step
Epoch 27/50
1489/1489 - 55s - loss: 2.6378 - accuracy20: 0.5780 - val_loss: 2.6675 - val_accuracy20: 0.5980 - 55s/epoch - 37ms/step
Epoch 28/50
1489/1489 - 55s - loss: 2.6341 - accuracy20: 0.5784 - val_loss: 2.6689 - val_accuracy20: 0.6009 - 55s/epoch - 37ms/step
Epoch 29/50
1489/1489 - 55s - loss: 2.6299 - accuracy20: 0.5796 - val_loss: 2.6635 - val_accuracy20: 0.5999 - 55s/epoch - 37ms/step
testing model: results/WBA/W6/deepVOL_L3/h20
Evaluating performance on  test set...
5183/5183 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92145246
{'0': {'precision': 0.5084210638026914, 'recall': 0.5040440838013073, 'f1-score': 0.5062231127583389, 'support': 380185}, '1': {'precision': 0.6325050125377107, 'recall': 0.6635427297224612, 'f1-score': 0.6476522259133902, 'support': 561471}, '2': {'precision': 0.5023482633934138, 'recall': 0.47068414056658636, 'f1-score': 0.48600099988071127, 'support': 385184}, 'accuracy': 0.5618537276536734, 'macro avg': {'precision': 0.5477581132446053, 'recall': 0.5460903180301182, 'f1-score': 0.5466254461841468, 'support': 1326840}, 'weighted avg': {'precision': 0.559165986496726, 'recall': 0.5618537276536734, 'f1-score': 0.5602003151833665, 'support': 1326840}}
[[191630 104870  83685]
 [ 92991 372560  95920]
 [ 92291 111593 181300]]
Evaluating performance on  train set...
1489/1489 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90325826
{'0': {'precision': 0.48743811594873454, 'recall': 0.5173294310603903, 'f1-score': 0.5019391479183938, 'support': 101821}, '1': {'precision': 0.6683653139223599, 'recall': 0.6699708586023381, 'f1-score': 0.6691671232106986, 'support': 177754}, '2': {'precision': 0.49922485525358307, 'recall': 0.4664111457060655, 'f1-score': 0.48226047179758863, 'support': 101492}, 'accuracy': 0.5749697559746711, 'macro avg': {'precision': 0.5516760950415591, 'recall': 0.5512371451229313, 'f1-score': 0.5511222476422271, 'support': 381067}, 'weighted avg': {'precision': 0.5749733601292369, 'recall': 0.5749697559746711, 'f1-score': 0.5747038148227849, 'support': 381067}}
[[ 52675  30365  18781]
 [ 29961 119090  28703]
 [ 25429  28726  47337]]
Evaluating performance on  val set...
519/519 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.87114304
{'0': {'precision': 0.48158558972005505, 'recall': 0.5100088089669208, 'f1-score': 0.49538983550933097, 'support': 32921}, '1': {'precision': 0.697596943987918, 'recall': 0.7012308562413491, 'f1-score': 0.699409179977436, 'support': 67189}, '2': {'precision': 0.4949092227091502, 'recall': 0.4601433735677961, 'f1-score': 0.47689352447175, 'support': 32642}, 'accuracy': 0.5945296492708207, 'macro avg': {'precision': 0.5580305854723745, 'recall': 0.557127679592022, 'f1-score': 0.557230846652839, 'support': 132752}, 'weighted avg': {'precision': 0.5941902729634977, 'recall': 0.5945296492708207, 'f1-score': 0.5941009596398811, 'support': 132752}}
[[16790 10473  5658]
 [10403 47115  9671]
 [ 7671  9951 15020]]
training model: results/WBA/W6/deepVOL_L3/h30
Epoch 1/50
1489/1489 - 57s - loss: 3.2848 - accuracy30: 0.3805 - val_loss: 3.2778 - val_accuracy30: 0.4298 - 57s/epoch - 38ms/step
Epoch 2/50
1489/1489 - 54s - loss: 3.1659 - accuracy30: 0.4358 - val_loss: 3.1066 - val_accuracy30: 0.4831 - 54s/epoch - 37ms/step
Epoch 3/50
1489/1489 - 56s - loss: 3.0296 - accuracy30: 0.4772 - val_loss: 2.9873 - val_accuracy30: 0.5180 - 56s/epoch - 37ms/step
Epoch 4/50
1489/1489 - 58s - loss: 2.9299 - accuracy30: 0.5078 - val_loss: 2.9682 - val_accuracy30: 0.5008 - 58s/epoch - 39ms/step
Epoch 5/50
1489/1489 - 56s - loss: 2.8853 - accuracy30: 0.5228 - val_loss: 2.9562 - val_accuracy30: 0.5304 - 56s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 55s - loss: 2.8570 - accuracy30: 0.5294 - val_loss: 2.9786 - val_accuracy30: 0.5325 - 55s/epoch - 37ms/step
Epoch 7/50
1489/1489 - 55s - loss: 2.8404 - accuracy30: 0.5340 - val_loss: 2.9398 - val_accuracy30: 0.5360 - 55s/epoch - 37ms/step
Epoch 8/50
1489/1489 - 55s - loss: 2.8279 - accuracy30: 0.5379 - val_loss: 2.9149 - val_accuracy30: 0.5395 - 55s/epoch - 37ms/step
Epoch 9/50
1489/1489 - 55s - loss: 2.8168 - accuracy30: 0.5402 - val_loss: 2.8967 - val_accuracy30: 0.5400 - 55s/epoch - 37ms/step
Epoch 10/50
1489/1489 - 55s - loss: 2.8082 - accuracy30: 0.5425 - val_loss: 2.8728 - val_accuracy30: 0.5447 - 55s/epoch - 37ms/step
Epoch 11/50
1489/1489 - 55s - loss: 2.8006 - accuracy30: 0.5444 - val_loss: 2.8642 - val_accuracy30: 0.5457 - 55s/epoch - 37ms/step
Epoch 12/50
1489/1489 - 55s - loss: 2.7945 - accuracy30: 0.5446 - val_loss: 2.8790 - val_accuracy30: 0.5470 - 55s/epoch - 37ms/step
Epoch 13/50
1489/1489 - 55s - loss: 2.7868 - accuracy30: 0.5475 - val_loss: 2.8743 - val_accuracy30: 0.5485 - 55s/epoch - 37ms/step
Epoch 14/50
1489/1489 - 55s - loss: 2.7826 - accuracy30: 0.5482 - val_loss: 2.8665 - val_accuracy30: 0.5502 - 55s/epoch - 37ms/step
Epoch 15/50
1489/1489 - 55s - loss: 2.7773 - accuracy30: 0.5489 - val_loss: 2.8813 - val_accuracy30: 0.5493 - 55s/epoch - 37ms/step
Epoch 16/50
1489/1489 - 55s - loss: 2.7716 - accuracy30: 0.5501 - val_loss: 2.8717 - val_accuracy30: 0.5507 - 55s/epoch - 37ms/step
Epoch 17/50
1489/1489 - 55s - loss: 2.7671 - accuracy30: 0.5511 - val_loss: 2.8716 - val_accuracy30: 0.5484 - 55s/epoch - 37ms/step
Epoch 18/50
1489/1489 - 55s - loss: 2.7634 - accuracy30: 0.5525 - val_loss: 2.8746 - val_accuracy30: 0.5519 - 55s/epoch - 37ms/step
Epoch 19/50
1489/1489 - 56s - loss: 2.7585 - accuracy30: 0.5521 - val_loss: 2.8762 - val_accuracy30: 0.5515 - 56s/epoch - 37ms/step
Epoch 20/50
1489/1489 - 55s - loss: 2.7543 - accuracy30: 0.5533 - val_loss: 2.9213 - val_accuracy30: 0.5485 - 55s/epoch - 37ms/step
Epoch 21/50
1489/1489 - 56s - loss: 2.7512 - accuracy30: 0.5540 - val_loss: 2.8623 - val_accuracy30: 0.5516 - 56s/epoch - 38ms/step
Epoch 22/50
1489/1489 - 55s - loss: 2.7473 - accuracy30: 0.5549 - val_loss: 2.8725 - val_accuracy30: 0.5519 - 55s/epoch - 37ms/step
Epoch 23/50
1489/1489 - 56s - loss: 2.7433 - accuracy30: 0.5555 - val_loss: 2.8519 - val_accuracy30: 0.5543 - 56s/epoch - 38ms/step
Epoch 24/50
1489/1489 - 56s - loss: 2.7402 - accuracy30: 0.5566 - val_loss: 2.8574 - val_accuracy30: 0.5540 - 56s/epoch - 37ms/step
Epoch 25/50
1489/1489 - 56s - loss: 2.7368 - accuracy30: 0.5567 - val_loss: 2.8659 - val_accuracy30: 0.5525 - 56s/epoch - 38ms/step
Epoch 26/50
1489/1489 - 55s - loss: 2.7330 - accuracy30: 0.5579 - val_loss: 2.8885 - val_accuracy30: 0.5540 - 55s/epoch - 37ms/step
Epoch 27/50
1489/1489 - 55s - loss: 2.7303 - accuracy30: 0.5582 - val_loss: 2.8587 - val_accuracy30: 0.5543 - 55s/epoch - 37ms/step
Epoch 28/50
1489/1489 - 55s - loss: 2.7275 - accuracy30: 0.5591 - val_loss: 2.8510 - val_accuracy30: 0.5550 - 55s/epoch - 37ms/step
Epoch 29/50
1489/1489 - 55s - loss: 2.7239 - accuracy30: 0.5597 - val_loss: 2.8446 - val_accuracy30: 0.5553 - 55s/epoch - 37ms/step
Epoch 30/50
1489/1489 - 55s - loss: 2.7203 - accuracy30: 0.5597 - val_loss: 2.8281 - val_accuracy30: 0.5554 - 55s/epoch - 37ms/step
Epoch 31/50
1489/1489 - 55s - loss: 2.7183 - accuracy30: 0.5610 - val_loss: 2.8525 - val_accuracy30: 0.5554 - 55s/epoch - 37ms/step
Epoch 32/50
1489/1489 - 55s - loss: 2.7163 - accuracy30: 0.5609 - val_loss: 2.8595 - val_accuracy30: 0.5530 - 55s/epoch - 37ms/step
Epoch 33/50
1489/1489 - 55s - loss: 2.7112 - accuracy30: 0.5628 - val_loss: 2.8669 - val_accuracy30: 0.5555 - 55s/epoch - 37ms/step
Epoch 34/50
1489/1489 - 55s - loss: 2.7090 - accuracy30: 0.5630 - val_loss: 2.8773 - val_accuracy30: 0.5521 - 55s/epoch - 37ms/step
Epoch 35/50
1489/1489 - 55s - loss: 2.7055 - accuracy30: 0.5643 - val_loss: 2.8618 - val_accuracy30: 0.5532 - 55s/epoch - 37ms/step
Epoch 36/50
1489/1489 - 55s - loss: 2.7029 - accuracy30: 0.5644 - val_loss: 2.8479 - val_accuracy30: 0.5535 - 55s/epoch - 37ms/step
Epoch 37/50
1489/1489 - 55s - loss: 2.7010 - accuracy30: 0.5652 - val_loss: 2.8388 - val_accuracy30: 0.5541 - 55s/epoch - 37ms/step
Epoch 38/50
1489/1489 - 54s - loss: 2.6979 - accuracy30: 0.5655 - val_loss: 2.8560 - val_accuracy30: 0.5520 - 54s/epoch - 37ms/step
Epoch 39/50
1489/1489 - 55s - loss: 2.6950 - accuracy30: 0.5657 - val_loss: 2.8558 - val_accuracy30: 0.5537 - 55s/epoch - 37ms/step
Epoch 40/50
1489/1489 - 55s - loss: 2.6917 - accuracy30: 0.5665 - val_loss: 2.8540 - val_accuracy30: 0.5536 - 55s/epoch - 37ms/step
testing model: results/WBA/W6/deepVOL_L3/h30
Evaluating performance on  test set...
5183/5183 - 83s - 83s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97175527
{'0': {'precision': 0.5016234351076285, 'recall': 0.5217903526132731, 'f1-score': 0.511508193898344, 'support': 426955}, '1': {'precision': 0.5524960416073058, 'recall': 0.6554721631486387, 'f1-score': 0.599594880225458, 'support': 467402}, '2': {'precision': 0.5141163064210456, 'recall': 0.3901517516295438, 'f1-score': 0.4436369850858108, 'support': 432483}, 'accuracy': 0.5259744957945193, 'macro avg': {'precision': 0.5227452610453266, 'recall': 0.5224714224638185, 'f1-score': 0.5182466864032044, 'support': 1326840}, 'weighted avg': {'precision': 0.5236162243568241, 'recall': 0.5259744957945193, 'f1-score': 0.5204156351586278, 'support': 1326840}}
[[222781 123431  80743]
 [ 82308 306369  78725]
 [139031 124718 168734]]
Evaluating performance on  train set...
1489/1489 - 35s - 35s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9548098
{'0': {'precision': 0.4946640434030883, 'recall': 0.4996515799344454, 'f1-score': 0.4971453028033384, 'support': 116239}, '1': {'precision': 0.5811915095619151, 'recall': 0.690161261098025, 'f1-score': 0.6310063963922506, 'support': 149013}, '2': {'precision': 0.5217983022697915, 'recall': 0.3906402452186677, 'f1-score': 0.4467926466158731, 'support': 115815}, 'accuracy': 0.541017721293106, 'macro avg': {'precision': 0.5325512850782649, 'recall': 0.526817695417046, 'f1-score': 0.5249814486038208, 'support': 381067}, 'weighted avg': {'precision': 0.5367465945171246, 'recall': 0.541017721293106, 'f1-score': 0.5341872147574391, 'support': 381067}}
[[ 58079  39554  18606]
 [ 23314 102843  22856]
 [ 36018  34555  45242]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93447983
{'0': {'precision': 0.4903955399371152, 'recall': 0.48893572181243417, 'f1-score': 0.4896645428522432, 'support': 37960}, '1': {'precision': 0.604503582395087, 'recall': 0.7245228790242022, 'f1-score': 0.6590939888880917, 'support': 57061}, '2': {'precision': 0.5164623797850273, 'recall': 0.362937637486417, 'f1-score': 0.42629891355103816, 'support': 37731}, 'accuracy': 0.5543871278775461, 'macro avg': {'precision': 0.5371205007057432, 'recall': 0.5254654127743511, 'f1-score': 0.5250191484304577, 'support': 132752}, 'weighted avg': {'precision': 0.5468515401856682, 'recall': 0.5543871278775461, 'f1-score': 0.5444807796026332, 'support': 132752}}
[[18560 14284  5116]
 [ 8014 41342  7705]
 [11273 12764 13694]]
training model: results/WBA/W6/deepVOL_L3/h50
Epoch 1/50
1489/1489 - 67s - loss: 3.2837 - accuracy50: 0.3714 - val_loss: 3.4191 - val_accuracy50: 0.3639 - 67s/epoch - 45ms/step
Epoch 2/50
1489/1489 - 55s - loss: 3.2660 - accuracy50: 0.3798 - val_loss: 3.2969 - val_accuracy50: 0.3733 - 55s/epoch - 37ms/step
Epoch 3/50
1489/1489 - 55s - loss: 3.2075 - accuracy50: 0.4109 - val_loss: 3.2159 - val_accuracy50: 0.4271 - 55s/epoch - 37ms/step
Epoch 4/50
1489/1489 - 55s - loss: 3.1305 - accuracy50: 0.4406 - val_loss: 3.2164 - val_accuracy50: 0.4370 - 55s/epoch - 37ms/step
Epoch 5/50
1489/1489 - 55s - loss: 3.0954 - accuracy50: 0.4516 - val_loss: 3.2072 - val_accuracy50: 0.4372 - 55s/epoch - 37ms/step
Epoch 6/50
1489/1489 - 54s - loss: 3.0333 - accuracy50: 0.4762 - val_loss: 3.0980 - val_accuracy50: 0.4689 - 54s/epoch - 36ms/step
Epoch 7/50
1489/1489 - 55s - loss: 3.0027 - accuracy50: 0.4865 - val_loss: 3.0899 - val_accuracy50: 0.4784 - 55s/epoch - 37ms/step
Epoch 8/50
1489/1489 - 55s - loss: 2.9836 - accuracy50: 0.4907 - val_loss: 3.0859 - val_accuracy50: 0.4795 - 55s/epoch - 37ms/step
Epoch 9/50
1489/1489 - 55s - loss: 2.9689 - accuracy50: 0.4941 - val_loss: 3.0658 - val_accuracy50: 0.4816 - 55s/epoch - 37ms/step
Epoch 10/50
1489/1489 - 55s - loss: 2.9585 - accuracy50: 0.4967 - val_loss: 3.0693 - val_accuracy50: 0.4835 - 55s/epoch - 37ms/step
Epoch 11/50
1489/1489 - 55s - loss: 2.9478 - accuracy50: 0.4996 - val_loss: 3.0569 - val_accuracy50: 0.4850 - 55s/epoch - 37ms/step
Epoch 12/50
1489/1489 - 56s - loss: 2.9425 - accuracy50: 0.5014 - val_loss: 3.0331 - val_accuracy50: 0.4866 - 56s/epoch - 37ms/step
Epoch 13/50
1489/1489 - 55s - loss: 2.9354 - accuracy50: 0.5024 - val_loss: 3.0372 - val_accuracy50: 0.4846 - 55s/epoch - 37ms/step
Epoch 14/50
1489/1489 - 55s - loss: 2.9314 - accuracy50: 0.5037 - val_loss: 3.0323 - val_accuracy50: 0.4861 - 55s/epoch - 37ms/step
Epoch 15/50
1489/1489 - 55s - loss: 2.9255 - accuracy50: 0.5061 - val_loss: 3.0290 - val_accuracy50: 0.4886 - 55s/epoch - 37ms/step
Epoch 16/50
1489/1489 - 55s - loss: 2.9211 - accuracy50: 0.5067 - val_loss: 3.0212 - val_accuracy50: 0.4901 - 55s/epoch - 37ms/step
Epoch 17/50
1489/1489 - 55s - loss: 2.9184 - accuracy50: 0.5073 - val_loss: 3.0092 - val_accuracy50: 0.4900 - 55s/epoch - 37ms/step
Epoch 18/50
1489/1489 - 55s - loss: 2.9149 - accuracy50: 0.5085 - val_loss: 3.0076 - val_accuracy50: 0.4920 - 55s/epoch - 37ms/step
Epoch 19/50
1489/1489 - 55s - loss: 2.9109 - accuracy50: 0.5092 - val_loss: 3.0190 - val_accuracy50: 0.4894 - 55s/epoch - 37ms/step
Epoch 20/50
1489/1489 - 55s - loss: 2.9063 - accuracy50: 0.5099 - val_loss: 3.0127 - val_accuracy50: 0.4897 - 55s/epoch - 37ms/step
Epoch 21/50
1489/1489 - 55s - loss: 2.9032 - accuracy50: 0.5120 - val_loss: 3.0130 - val_accuracy50: 0.4898 - 55s/epoch - 37ms/step
Epoch 22/50
1489/1489 - 54s - loss: 2.8986 - accuracy50: 0.5133 - val_loss: 3.0078 - val_accuracy50: 0.4907 - 54s/epoch - 37ms/step
Epoch 23/50
1489/1489 - 55s - loss: 2.8966 - accuracy50: 0.5139 - val_loss: 3.0429 - val_accuracy50: 0.4873 - 55s/epoch - 37ms/step
Epoch 24/50
1489/1489 - 55s - loss: 2.8929 - accuracy50: 0.5142 - val_loss: 3.0238 - val_accuracy50: 0.4887 - 55s/epoch - 37ms/step
Epoch 25/50
1489/1489 - 56s - loss: 2.8898 - accuracy50: 0.5155 - val_loss: 3.0285 - val_accuracy50: 0.4887 - 56s/epoch - 37ms/step
Epoch 26/50
1489/1489 - 55s - loss: 2.8870 - accuracy50: 0.5163 - val_loss: 3.0209 - val_accuracy50: 0.4911 - 55s/epoch - 37ms/step
Epoch 27/50
1489/1489 - 56s - loss: 2.8850 - accuracy50: 0.5167 - val_loss: 3.0344 - val_accuracy50: 0.4882 - 56s/epoch - 38ms/step
Epoch 28/50
1489/1489 - 56s - loss: 2.8817 - accuracy50: 0.5185 - val_loss: 3.0235 - val_accuracy50: 0.4899 - 56s/epoch - 37ms/step
testing model: results/WBA/W6/deepVOL_L3/h50
Evaluating performance on  test set...
5183/5183 - 84s - 84s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0341126
{'0': {'precision': 0.4707604758089798, 'recall': 0.4737597384956489, 'f1-score': 0.4722553451702374, 'support': 456436}, '1': {'precision': 0.4312884565220727, 'recall': 0.6885059977121245, 'f1-score': 0.5303557057933921, 'support': 408239}, '2': {'precision': 0.5281621606591715, 'recall': 0.24660024017396384, 'f1-score': 0.3362189892779861, 'support': 462165}, 'accuracy': 0.46070814868409155, 'macro avg': {'precision': 0.47673703099674136, 'recall': 0.46962199212724576, 'f1-score': 0.4462766800805385, 'support': 1326840}, 'weighted avg': {'precision': 0.47860997687702206, 'recall': 0.46070814868409155, 'f1-score': 0.4427473341813418, 'support': 1326840}}
[[216241 184716  55479]
 [ 80827 281075  46337]
 [162276 185919 113970]]
Evaluating performance on  train set...
1489/1489 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0182109
{'0': {'precision': 0.47876951563354797, 'recall': 0.4428778300270935, 'f1-score': 0.4601248083992898, 'support': 128444}, '1': {'precision': 0.4570027134209977, 'recall': 0.7336471339104073, 'f1-score': 0.5631861149473156, 'support': 125345}, '2': {'precision': 0.5259052924791087, 'recall': 0.2521724100001571, 'f1-score': 0.3408883318818106, 'support': 127278}, 'accuracy': 0.47482463713730133, 'macro avg': {'precision': 0.48722584051121814, 'recall': 0.47623245797921926, 'f1-score': 0.45473308507613863, 'support': 381067}, 'weighted avg': {'precision': 0.487353275397624, 'recall': 0.47482463713730133, 'f1-score': 0.4541994441223269, 'support': 381067}}
[[56885 55645 15914]
 [20366 91959 13020]
 [41564 53618 32096]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0034858
{'0': {'precision': 0.47889271550824464, 'recall': 0.43283969249634485, 'f1-score': 0.4547030990660688, 'support': 42406}, '1': {'precision': 0.4874581278189539, 'recall': 0.765084556312227, 'f1-score': 0.5955033551640526, 'support': 48311}, '2': {'precision': 0.5361329175180127, 'recall': 0.23720708933031998, 'f1-score': 0.32889680537001303, 'support': 42035}, 'accuracy': 0.4918042666023864, 'macro avg': {'precision': 0.5008279202817371, 'recall': 0.47837711271296396, 'f1-score': 0.45970108653337816, 'support': 132752}, 'weighted avg': {'precision': 0.5001345463328144, 'recall': 0.4918042666023864, 'f1-score': 0.4661073236113562, 'support': 132752}}
[[18355 19543  4508]
 [ 7230 36962  4119]
 [12743 19321  9971]]
training model: results/WBA/W6/deepVOL_L3/h100
Epoch 1/50
1489/1489 - 59s - loss: 3.2763 - accuracy100: 0.3798 - val_loss: 3.3243 - val_accuracy100: 0.3524 - 59s/epoch - 40ms/step
Epoch 2/50
1489/1489 - 57s - loss: 3.2561 - accuracy100: 0.3863 - val_loss: 3.3199 - val_accuracy100: 0.3547 - 57s/epoch - 38ms/step
Epoch 3/50
1489/1489 - 57s - loss: 3.2399 - accuracy100: 0.3970 - val_loss: 3.3314 - val_accuracy100: 0.3528 - 57s/epoch - 38ms/step
Epoch 4/50
1489/1489 - 57s - loss: 3.2242 - accuracy100: 0.4058 - val_loss: 3.3042 - val_accuracy100: 0.3577 - 57s/epoch - 39ms/step
Epoch 5/50
1489/1489 - 57s - loss: 3.2007 - accuracy100: 0.4162 - val_loss: 3.2811 - val_accuracy100: 0.3701 - 57s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 57s - loss: 3.1869 - accuracy100: 0.4232 - val_loss: 3.2759 - val_accuracy100: 0.3782 - 57s/epoch - 38ms/step
Epoch 7/50
1489/1489 - 57s - loss: 3.1776 - accuracy100: 0.4279 - val_loss: 3.2753 - val_accuracy100: 0.3873 - 57s/epoch - 38ms/step
Epoch 8/50
1489/1489 - 57s - loss: 3.1703 - accuracy100: 0.4310 - val_loss: 3.2793 - val_accuracy100: 0.3882 - 57s/epoch - 38ms/step
Epoch 9/50
1489/1489 - 58s - loss: 3.1660 - accuracy100: 0.4332 - val_loss: 3.2708 - val_accuracy100: 0.3933 - 58s/epoch - 39ms/step
Epoch 10/50
1489/1489 - 57s - loss: 3.1623 - accuracy100: 0.4341 - val_loss: 3.2501 - val_accuracy100: 0.3987 - 57s/epoch - 38ms/step
Epoch 11/50
1489/1489 - 57s - loss: 3.1571 - accuracy100: 0.4373 - val_loss: 3.2555 - val_accuracy100: 0.3951 - 57s/epoch - 38ms/step
Epoch 12/50
1489/1489 - 58s - loss: 3.1550 - accuracy100: 0.4371 - val_loss: 3.2649 - val_accuracy100: 0.3968 - 58s/epoch - 39ms/step
Epoch 13/50
1489/1489 - 57s - loss: 3.1517 - accuracy100: 0.4380 - val_loss: 3.2600 - val_accuracy100: 0.4023 - 57s/epoch - 38ms/step
Epoch 14/50
1489/1489 - 57s - loss: 3.1466 - accuracy100: 0.4404 - val_loss: 3.2738 - val_accuracy100: 0.3990 - 57s/epoch - 38ms/step
Epoch 15/50
1489/1489 - 56s - loss: 3.1445 - accuracy100: 0.4411 - val_loss: 3.2879 - val_accuracy100: 0.3959 - 56s/epoch - 38ms/step
Epoch 16/50
1489/1489 - 58s - loss: 3.1426 - accuracy100: 0.4416 - val_loss: 3.2902 - val_accuracy100: 0.3965 - 58s/epoch - 39ms/step
Epoch 17/50
1489/1489 - 58s - loss: 3.1405 - accuracy100: 0.4429 - val_loss: 3.2885 - val_accuracy100: 0.3967 - 58s/epoch - 39ms/step
Epoch 18/50
1489/1489 - 58s - loss: 3.1390 - accuracy100: 0.4444 - val_loss: 3.2933 - val_accuracy100: 0.3968 - 58s/epoch - 39ms/step
Epoch 19/50
1489/1489 - 58s - loss: 3.1355 - accuracy100: 0.4454 - val_loss: 3.3126 - val_accuracy100: 0.3924 - 58s/epoch - 39ms/step
Epoch 20/50
1489/1489 - 57s - loss: 3.1322 - accuracy100: 0.4459 - val_loss: 3.3030 - val_accuracy100: 0.3963 - 57s/epoch - 38ms/step
testing model: results/WBA/W6/deepVOL_L3/h100
Evaluating performance on  test set...
5183/5183 - 88s - 88s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891849
{'0': {'precision': 0.37791925056076, 'recall': 0.31083394171385725, 'f1-score': 0.34110950517238575, 'support': 405448}, '1': {'precision': 0.42197105985224115, 'recall': 0.4037607762100029, 'f1-score': 0.41266511771324144, 'support': 495536}, '2': {'precision': 0.3599043167255057, 'recall': 0.43880325743913434, 'f1-score': 0.39545683965932643, 'support': 425856}, 'accuracy': 0.3866117994633867, 'macro avg': {'precision': 0.3865982090461689, 'recall': 0.3844659917876648, 'f1-score': 0.3830771541816513, 'support': 1326840}, 'weighted avg': {'precision': 0.38858933113243205, 'recall': 0.3866117994633867, 'f1-score': 0.3852764887509002, 'support': 1326840}}
[[126027 143387 136034]
 [ 99146 200078 196312]
 [108303 130686 186867]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.087188
{'0': {'precision': 0.4270135452458973, 'recall': 0.248780714026233, 'f1-score': 0.31439371740022265, 'support': 129379}, '1': {'precision': 0.3900406622319622, 'recall': 0.4817511837177921, 'f1-score': 0.4310720537277177, 'support': 125241}, '2': {'precision': 0.39166628035575923, 'recall': 0.46772165413177064, 'f1-score': 0.4263285372394106, 'support': 126447}, 'accuracy': 0.3979982522758465, 'macro avg': {'precision': 0.40290682927787297, 'recall': 0.39941785062526525, 'f1-score': 0.390598102789117, 'support': 381067}, 'weighted avg': {'precision': 0.40313302962761616, 'recall': 0.3979982522758465, 'f1-score': 0.3898836802786603, 'support': 381067}}
[[32187 51986 45206]
 [18253 60335 46653]
 [24937 42368 59142]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0855268
{'0': {'precision': 0.41524047470331044, 'recall': 0.23125623246214141, 'f1-score': 0.2970686367969495, 'support': 43121}, '1': {'precision': 0.39846755948940665, 'recall': 0.5159621100348536, 'f1-score': 0.44966643062129624, 'support': 46767}, '2': {'precision': 0.38765047737650477, 'recall': 0.43572695035460995, 'f1-score': 0.4102851368569044, 'support': 42864}, 'accuracy': 0.3975759310594191, 'macro avg': {'precision': 0.4004528371897406, 'recall': 0.3943150976172016, 'f1-score': 0.3856734014250501, 'support': 132752}, 'weighted avg': {'precision': 0.40042309665081527, 'recall': 0.3975759310594191, 'f1-score': 0.3873833068761433, 'support': 132752}}
[[ 9972 19774 13375]
 [ 6509 24130 16128]
 [ 7534 16653 18677]]
training model: results/WBA/W6/deepVOL_L3/h200
Epoch 1/50
1489/1489 - 58s - loss: 3.3063 - accuracy200: 0.3522 - val_loss: 3.3278 - val_accuracy200: 0.3324 - 58s/epoch - 39ms/step
Epoch 2/50
1489/1489 - 56s - loss: 3.2928 - accuracy200: 0.3504 - val_loss: 3.3359 - val_accuracy200: 0.3331 - 56s/epoch - 37ms/step
Epoch 3/50
1489/1489 - 58s - loss: 3.2802 - accuracy200: 0.3672 - val_loss: 3.3269 - val_accuracy200: 0.3335 - 58s/epoch - 39ms/step
Epoch 4/50
1489/1489 - 57s - loss: 3.2715 - accuracy200: 0.3733 - val_loss: 3.3309 - val_accuracy200: 0.3377 - 57s/epoch - 38ms/step
Epoch 5/50
1489/1489 - 57s - loss: 3.2678 - accuracy200: 0.3767 - val_loss: 3.3335 - val_accuracy200: 0.3400 - 57s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 58s - loss: 3.2607 - accuracy200: 0.3809 - val_loss: 3.3367 - val_accuracy200: 0.3436 - 58s/epoch - 39ms/step
Epoch 7/50
1489/1489 - 58s - loss: 3.2542 - accuracy200: 0.3869 - val_loss: 3.3492 - val_accuracy200: 0.3416 - 58s/epoch - 39ms/step
Epoch 8/50
1489/1489 - 57s - loss: 3.2498 - accuracy200: 0.3886 - val_loss: 3.3506 - val_accuracy200: 0.3415 - 57s/epoch - 38ms/step
Epoch 9/50
1489/1489 - 58s - loss: 3.2441 - accuracy200: 0.3926 - val_loss: 3.3603 - val_accuracy200: 0.3433 - 58s/epoch - 39ms/step
Epoch 10/50
1489/1489 - 58s - loss: 3.2410 - accuracy200: 0.3938 - val_loss: 3.3708 - val_accuracy200: 0.3445 - 58s/epoch - 39ms/step
Epoch 11/50
1489/1489 - 57s - loss: 3.2369 - accuracy200: 0.3971 - val_loss: 3.3503 - val_accuracy200: 0.3490 - 57s/epoch - 38ms/step
Epoch 12/50
1489/1489 - 57s - loss: 3.2331 - accuracy200: 0.3989 - val_loss: 3.3490 - val_accuracy200: 0.3555 - 57s/epoch - 38ms/step
Epoch 13/50
1489/1489 - 58s - loss: 3.2305 - accuracy200: 0.4015 - val_loss: 3.3587 - val_accuracy200: 0.3526 - 58s/epoch - 39ms/step
testing model: results/WBA/W6/deepVOL_L3/h200
Evaluating performance on  test set...
5183/5183 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205664
{'0': {'precision': 0.3359442993907746, 'recall': 0.0008607559935153409, 'f1-score': 0.0017171124041353053, 'support': 448443}, '1': {'precision': 0.2948899184132434, 'recall': 0.8618324924524363, 'f1-score': 0.4394238600339402, 'support': 392842}, '2': {'precision': 0.37406806766222944, 'recall': 0.1368125135154617, 'f1-score': 0.20034894434533732, 'support': 485555}, 'accuracy': 0.30552289650598413, 'macro avg': {'precision': 0.33496742848874916, 'recall': 0.3331685873204711, 'f1-score': 0.21382997226113762, 'support': 1326840}, 'weighted avg': {'precision': 0.337740522877458, 'recall': 0.30552289650598413, 'f1-score': 0.20399943228490328, 'support': 1326840}}
[[   386 390891  57166]
 [   286 338564  53992]
 [   477 418648  66430]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120876
{'0': {'precision': 0.34050179211469533, 'recall': 0.0007325611881371355, 'f1-score': 0.001461977054654858, 'support': 129682}, '1': {'precision': 0.32867820553804933, 'recall': 0.8612502792226442, 'f1-score': 0.4757835448421452, 'support': 125348}, '2': {'precision': 0.33886840043567157, 'recall': 0.14070471369518475, 'f1-score': 0.19884509726972024, 'support': 126037}, 'accuracy': 0.33008631028139407, 'macro avg': {'precision': 0.33601613269613867, 'recall': 0.3342291847019887, 'f1-score': 0.2253635397221734, 'support': 381067}, 'weighted avg': {'precision': 0.3360723067033148, 'recall': 0.33008631028139407, 'f1-score': 0.2227690863072864, 'support': 381067}}
[[    95 112297  17290]
 [    83 107956  17309]
 [   101 108202  17734]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104506
{'0': {'precision': 0.39285714285714285, 'recall': 0.0007436787307882995, 'f1-score': 0.0014845472131000043, 'support': 44374}, '1': {'precision': 0.3339962154396047, 'recall': 0.8632792156329959, 'f1-score': 0.4816468849290322, 'support': 44163}, '2': {'precision': 0.33731101511879047, 'recall': 0.14128689358814883, 'f1-score': 0.1991551765362238, 'support': 44215}, 'accuracy': 0.3344959021333012, 'macro avg': {'precision': 0.35472145780517933, 'recall': 0.33510326265064433, 'f1-score': 0.227428869559452, 'support': 132752}, 'weighted avg': {'precision': 0.3547752519968019, 'recall': 0.3344959021333012, 'f1-score': 0.22705867186712125, 'support': 132752}}
[[   33 38083  6258]
 [   23 38125  6015]
 [   28 37940  6247]]
training model: results/WBA/W6/deepVOL_L3/h300
Epoch 1/50
1489/1489 - 62s - loss: 3.2851 - accuracy300: 0.3733 - val_loss: 3.3067 - val_accuracy300: 0.3559 - 62s/epoch - 42ms/step
Epoch 2/50
1489/1489 - 57s - loss: 3.2819 - accuracy300: 0.3628 - val_loss: 3.3125 - val_accuracy300: 0.3548 - 57s/epoch - 38ms/step
Epoch 3/50
1489/1489 - 57s - loss: 3.2671 - accuracy300: 0.3752 - val_loss: 3.3165 - val_accuracy300: 0.3559 - 57s/epoch - 38ms/step
Epoch 4/50
1489/1489 - 60s - loss: 3.2603 - accuracy300: 0.3758 - val_loss: 3.2998 - val_accuracy300: 0.3579 - 60s/epoch - 40ms/step
Epoch 5/50
1489/1489 - 57s - loss: 3.2561 - accuracy300: 0.3783 - val_loss: 3.3059 - val_accuracy300: 0.3353 - 57s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 57s - loss: 3.2585 - accuracy300: 0.3785 - val_loss: 3.2929 - val_accuracy300: 0.3568 - 57s/epoch - 39ms/step
Epoch 7/50
1489/1489 - 59s - loss: 3.2582 - accuracy300: 0.3763 - val_loss: 3.3128 - val_accuracy300: 0.3468 - 59s/epoch - 40ms/step
Epoch 8/50
1489/1489 - 57s - loss: 3.2606 - accuracy300: 0.3761 - val_loss: 3.2952 - val_accuracy300: 0.3587 - 57s/epoch - 39ms/step
Epoch 9/50
1489/1489 - 57s - loss: 3.2606 - accuracy300: 0.3751 - val_loss: 3.3324 - val_accuracy300: 0.3508 - 57s/epoch - 39ms/step
Epoch 10/50
1489/1489 - 59s - loss: 3.2562 - accuracy300: 0.3775 - val_loss: 3.2974 - val_accuracy300: 0.3511 - 59s/epoch - 40ms/step
Epoch 11/50
1489/1489 - 57s - loss: 3.2567 - accuracy300: 0.3788 - val_loss: 3.3002 - val_accuracy300: 0.3541 - 57s/epoch - 39ms/step
Epoch 12/50
1489/1489 - 57s - loss: 3.2529 - accuracy300: 0.3785 - val_loss: 3.2999 - val_accuracy300: 0.3492 - 57s/epoch - 39ms/step
Epoch 13/50
1489/1489 - 59s - loss: 3.2537 - accuracy300: 0.3777 - val_loss: 3.3081 - val_accuracy300: 0.3453 - 59s/epoch - 40ms/step
Epoch 14/50
1489/1489 - 58s - loss: 3.2538 - accuracy300: 0.3783 - val_loss: 3.3005 - val_accuracy300: 0.3434 - 58s/epoch - 39ms/step
Epoch 15/50
1489/1489 - 57s - loss: 3.2517 - accuracy300: 0.3799 - val_loss: 3.2981 - val_accuracy300: 0.3503 - 57s/epoch - 38ms/step
Epoch 16/50
1489/1489 - 59s - loss: 3.2531 - accuracy300: 0.3810 - val_loss: 3.2930 - val_accuracy300: 0.3597 - 59s/epoch - 40ms/step
testing model: results/WBA/W6/deepVOL_L3/h300
Evaluating performance on  test set...
5183/5183 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0873145
{'0': {'precision': 0.3190373139222244, 'recall': 0.013298308531691796, 'f1-score': 0.02553236154663658, 'support': 365836}, '1': {'precision': 0.4464553073390726, 'recall': 0.6957410144100213, 'f1-score': 0.5438947096960752, 'support': 562317}, '2': {'precision': 0.3167805740934309, 'recall': 0.3458678110899026, 'f1-score': 0.33068579417781196, 'support': 398687}, 'accuracy': 0.4024486750474812, 'macro avg': {'precision': 0.36075773178490933, 'recall': 0.3516357113438719, 'f1-score': 0.3000376218068413, 'support': 1326840}, 'weighted avg': {'precision': 0.3723591695883633, 'recall': 0.4024486750474812, 'f1-score': 0.3369072576303945, 'support': 1326840}}
[[  4865 229314 131657]
 [  5345 391227 165745]
 [  5039 255755 137893]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1029296
{'0': {'precision': 0.3416988416988417, 'recall': 0.010902203538596573, 'f1-score': 0.02113022846313402, 'support': 129882}, '1': {'precision': 0.3378194246740098, 'recall': 0.7050104848446337, 'f1-score': 0.45676909380033653, 'support': 125896}, '2': {'precision': 0.33987826772343127, 'recall': 0.3097558444875448, 'f1-score': 0.3241186934698547, 'support': 125289}, 'accuracy': 0.33847853527070043, 'macro avg': {'precision': 0.3397988446987609, 'recall': 0.34188951095692505, 'f1-score': 0.2673393385777751, 'support': 381067}, 'weighted avg': {'precision': 0.33981859235013545, 'recall': 0.33847853527070043, 'f1-score': 0.26467352237921565, 'support': 381067}}
[[ 1416 88895 39571]
 [ 1333 88758 35805]
 [ 1395 85085 38809]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0983026
{'0': {'precision': 0.32364192807957154, 'recall': 0.009935408103347034, 'f1-score': 0.019278975434118772, 'support': 42575}, '1': {'precision': 0.3656604332374344, 'recall': 0.7314446513202437, 'f1-score': 0.4875747489563353, 'support': 47264}, '2': {'precision': 0.3305330478848812, 'recall': 0.284226225153217, 'f1-score': 0.3056356027764553, 'support': 42913}, 'accuracy': 0.35548240327829334, 'macro avg': {'precision': 0.339945136400629, 'recall': 0.3418687615256026, 'f1-score': 0.2708297757223031, 'support': 132752}, 'weighted avg': {'precision': 0.3408294751748054, 'recall': 0.35548240327829334, 'f1-score': 0.2785741528242578, 'support': 132752}}
[[  423 29731 12421]
 [  410 34571 12283]
 [  474 30242 12197]]
training model: results/WBA/W6/deepVOL_L3/h500
Epoch 1/50
1489/1489 - 59s - loss: 3.2577 - accuracy500: 0.4007 - val_loss: 3.3063 - val_accuracy500: 0.3229 - 59s/epoch - 40ms/step
Epoch 2/50
1489/1489 - 57s - loss: 3.2692 - accuracy500: 0.3852 - val_loss: 3.3181 - val_accuracy500: 0.3182 - 57s/epoch - 38ms/step
Epoch 3/50
1489/1489 - 58s - loss: 3.2809 - accuracy500: 0.3744 - val_loss: 3.2978 - val_accuracy500: 0.3357 - 58s/epoch - 39ms/step
Epoch 4/50
1489/1489 - 57s - loss: 3.2517 - accuracy500: 0.3987 - val_loss: 3.2972 - val_accuracy500: 0.3420 - 57s/epoch - 38ms/step
Epoch 5/50
1489/1489 - 57s - loss: 3.2438 - accuracy500: 0.3993 - val_loss: 3.2996 - val_accuracy500: 0.3392 - 57s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 57s - loss: 3.2346 - accuracy500: 0.4012 - val_loss: 3.2927 - val_accuracy500: 0.3472 - 57s/epoch - 38ms/step
Epoch 7/50
1489/1489 - 57s - loss: 3.2324 - accuracy500: 0.4065 - val_loss: 3.3492 - val_accuracy500: 0.3162 - 57s/epoch - 38ms/step
Epoch 8/50
1489/1489 - 58s - loss: 3.2301 - accuracy500: 0.4046 - val_loss: 3.3133 - val_accuracy500: 0.3327 - 58s/epoch - 39ms/step
Epoch 9/50
1489/1489 - 58s - loss: 3.2302 - accuracy500: 0.4018 - val_loss: 3.3252 - val_accuracy500: 0.3204 - 58s/epoch - 39ms/step
Epoch 10/50
1489/1489 - 57s - loss: 3.2250 - accuracy500: 0.4049 - val_loss: 3.3113 - val_accuracy500: 0.3386 - 57s/epoch - 38ms/step
Epoch 11/50
1489/1489 - 57s - loss: 3.2190 - accuracy500: 0.4076 - val_loss: 3.3090 - val_accuracy500: 0.3484 - 57s/epoch - 38ms/step
Epoch 12/50
1489/1489 - 57s - loss: 3.2169 - accuracy500: 0.4085 - val_loss: 3.3119 - val_accuracy500: 0.3357 - 57s/epoch - 38ms/step
Epoch 13/50
1489/1489 - 57s - loss: 3.2133 - accuracy500: 0.4129 - val_loss: 3.3020 - val_accuracy500: 0.3413 - 57s/epoch - 38ms/step
Epoch 14/50
1489/1489 - 57s - loss: 3.2093 - accuracy500: 0.4132 - val_loss: 3.3157 - val_accuracy500: 0.3444 - 57s/epoch - 38ms/step
Epoch 15/50
1489/1489 - 58s - loss: 3.2110 - accuracy500: 0.4133 - val_loss: 3.2938 - val_accuracy500: 0.3529 - 58s/epoch - 39ms/step
Epoch 16/50
1489/1489 - 58s - loss: 3.2079 - accuracy500: 0.4141 - val_loss: 3.2970 - val_accuracy500: 0.3426 - 58s/epoch - 39ms/step
testing model: results/WBA/W6/deepVOL_L3/h500
Evaluating performance on  test set...
5183/5183 - 87s - 87s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959889
{'0': {'precision': 0.2937660479016711, 'recall': 0.05009474862901605, 'f1-score': 0.08559356852452583, 'support': 417948}, '1': {'precision': 0.41072040982552405, 'recall': 0.17153964253902035, 'f1-score': 0.24200469188581603, 'support': 446818}, '2': {'precision': 0.35615317043873773, 'recall': 0.8239178140297875, 'f1-score': 0.4973276108128727, 'support': 462074}, 'accuracy': 0.360476771879051, 'macro avg': {'precision': 0.35354654272197766, 'recall': 0.348517401732608, 'f1-score': 0.2749752904077382, 'support': 1326840}, 'weighted avg': {'precision': 0.3548772454426592, 'recall': 0.360476771879051, 'f1-score': 0.28165255165315517, 'support': 1326840}}
[[ 20937  53135 343876]
 [ 25805  76647 344366]
 [ 24529  56834 380711]]
Evaluating performance on  train set...
1489/1489 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0958989
{'0': {'precision': 0.34525690753244265, 'recall': 0.05559839605181986, 'f1-score': 0.09577386210423543, 'support': 129680}, '1': {'precision': 0.39766936598854435, 'recall': 0.2358126678743207, 'f1-score': 0.29606356333050676, 'support': 128072}, '2': {'precision': 0.33302256199888125, 'recall': 0.7676114016948465, 'f1-score': 0.46451758539972626, 'support': 123315}, 'accuracy': 0.3465768486906502, 'macro avg': {'precision': 0.3586496118399561, 'recall': 0.3530074885403291, 'f1-score': 0.28545167027815616, 'support': 381067}, 'weighted avg': {'precision': 0.35891301015985133, 'recall': 0.3465768486906502, 'f1-score': 0.2824159351612949, 'support': 381067}}
[[ 7210 23523 98947]
 [ 7237 30201 90634]
 [ 6436 22221 94658]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981878
{'0': {'precision': 0.3202247191011236, 'recall': 0.05629762016743486, 'f1-score': 0.09576, 'support': 42524}, '1': {'precision': 0.41724853093674386, 'recall': 0.2515420521797116, 'f1-score': 0.3138667152032034, 'support': 47988}, '2': {'precision': 0.3268843543063542, 'recall': 0.7455965909090909, 'f1-score': 0.45450478403301925, 'support': 42240}, 'accuracy': 0.34620194046040736, 'macro avg': {'precision': 0.3547858681147405, 'recall': 0.3511454210854124, 'f1-score': 0.2880438330787409, 'support': 132752}, 'weighted avg': {'precision': 0.3574164877632657, 'recall': 0.34620194046040736, 'f1-score': 0.2887505743546317, 'support': 132752}}
[[ 2394  8404 31726]
 [ 2791 12071 33126]
 [ 2291  8455 31494]]
training model: results/WBA/W6/deepVOL_L3/h1000
Epoch 1/50
1489/1489 - 60s - loss: 3.3035 - accuracy1000: 0.3587 - val_loss: 3.3194 - val_accuracy1000: 0.3421 - 60s/epoch - 40ms/step
Epoch 2/50
1489/1489 - 57s - loss: 3.2920 - accuracy1000: 0.3574 - val_loss: 3.3145 - val_accuracy1000: 0.3522 - 57s/epoch - 39ms/step
Epoch 3/50
1489/1489 - 58s - loss: 3.2904 - accuracy1000: 0.3611 - val_loss: 3.3310 - val_accuracy1000: 0.3477 - 58s/epoch - 39ms/step
Epoch 4/50
1489/1489 - 57s - loss: 3.2816 - accuracy1000: 0.3695 - val_loss: 3.3884 - val_accuracy1000: 0.3367 - 57s/epoch - 39ms/step
Epoch 5/50
1489/1489 - 57s - loss: 3.2632 - accuracy1000: 0.3841 - val_loss: 3.3741 - val_accuracy1000: 0.3364 - 57s/epoch - 38ms/step
Epoch 6/50
1489/1489 - 56s - loss: 3.2507 - accuracy1000: 0.3912 - val_loss: 3.3828 - val_accuracy1000: 0.3440 - 56s/epoch - 38ms/step
Epoch 7/50
1489/1489 - 58s - loss: 3.2408 - accuracy1000: 0.3963 - val_loss: 3.3822 - val_accuracy1000: 0.3517 - 58s/epoch - 39ms/step
Epoch 8/50
1489/1489 - 57s - loss: 3.2331 - accuracy1000: 0.4008 - val_loss: 3.3688 - val_accuracy1000: 0.3506 - 57s/epoch - 38ms/step
Epoch 9/50
1489/1489 - 57s - loss: 3.2344 - accuracy1000: 0.4024 - val_loss: 3.3847 - val_accuracy1000: 0.3530 - 57s/epoch - 38ms/step
Epoch 10/50
1489/1489 - 57s - loss: 3.2218 - accuracy1000: 0.4090 - val_loss: 3.4090 - val_accuracy1000: 0.3499 - 57s/epoch - 38ms/step
Epoch 11/50
1489/1489 - 58s - loss: 3.2246 - accuracy1000: 0.4096 - val_loss: 3.3423 - val_accuracy1000: 0.3508 - 58s/epoch - 39ms/step
Epoch 12/50
1489/1489 - 58s - loss: 3.2148 - accuracy1000: 0.4144 - val_loss: 3.3893 - val_accuracy1000: 0.3497 - 58s/epoch - 39ms/step
testing model: results/WBA/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
5183/5183 - 89s - 89s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204062
{'0': {'precision': 0.3303437967115097, 'recall': 0.0009730217609052184, 'f1-score': 0.0019403283193552138, 'support': 454255}, '1': {'precision': 0.2864893199911355, 'recall': 0.5668776738982555, 'f1-score': 0.38062029695589067, 'support': 355754}, '2': {'precision': 0.39481796096980226, 'recall': 0.47483026366452474, 'f1-score': 0.43114333174338393, 'support': 516831}, 'accuracy': 0.3372810587561424, 'macro avg': {'precision': 0.33721702589081587, 'recall': 0.3475603197745618, 'f1-score': 0.27123465233954325, 'support': 1326840}, 'weighted avg': {'precision': 0.34369946979688365, 'recall': 0.3372810587561424, 'f1-score': 0.27065572054823456, 'support': 1326840}}
[[   442 231299 222514]
 [   436 201669 153649]
 [   460 270964 245407]]
Evaluating performance on  train set...
1489/1489 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1124313
{'0': {'precision': 0.34980988593155893, 'recall': 0.000691323885240235, 'f1-score': 0.0013799206545623626, 'support': 133078}, '1': {'precision': 0.33261901434331825, 'recall': 0.5273009256220048, 'f1-score': 0.40792242624303693, 'support': 121864}, '2': {'precision': 0.3526674590779957, 'recall': 0.5245986124876115, 'f1-score': 0.4217850563208792, 'support': 126125}, 'accuracy': 0.34250144987626846, 'macro avg': {'precision': 0.34503211978429094, 'recall': 0.3508636206649522, 'f1-score': 0.2770291344061595, 'support': 381067}, 'weighted avg': {'precision': 0.3452580959257725, 'recall': 0.34250144987626846, 'f1-score': 0.27053598412095564, 'support': 381067}}
[[   92 69040 63946]
 [  103 64259 57502]
 [   68 59892 66165]]
Evaluating performance on  val set...
519/519 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076258
{'0': {'precision': 0.38202247191011235, 'recall': 0.0007701193685021178, 'f1-score': 0.0015371400153714, 'support': 44149}, '1': {'precision': 0.3545794055172222, 'recall': 0.5727870102491646, 'f1-score': 0.438011284707335, 'support': 44589}, '2': {'precision': 0.3491275521984365, 'recall': 0.4809606034443586, 'f1-score': 0.40457533827689013, 'support': 44014}, 'accuracy': 0.3521076895263348, 'macro avg': {'precision': 0.36190980987525706, 'recall': 0.3515059110206751, 'f1-score': 0.28137458766653217, 'support': 132752}, 'weighted avg': {'precision': 0.36189851231942993, 'recall': 0.3521076895263348, 'f1-score': 0.28176846531331384, 'support': 132752}}
[[   34 23670 20445]
 [   29 25540 19020]
 [   26 22819 21169]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        18 (peak)  16.71 (ave)

============================================
