This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-09-04.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-27.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-14.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-23.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-19.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-21.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-16.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-06.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-22.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-13.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-08-28.csv
training model: results/EXC/W6/deepLOB_L1/h10
Epoch 1/50
1504/1504 - 32s - loss: 2.6957 - accuracy10: 0.4639 - val_loss: 2.7288 - val_accuracy10: 0.5772 - 32s/epoch - 22ms/step
Epoch 2/50
1504/1504 - 24s - loss: 2.4282 - accuracy10: 0.5550 - val_loss: 2.6691 - val_accuracy10: 0.6576 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 2.2631 - accuracy10: 0.6134 - val_loss: 2.5619 - val_accuracy10: 0.6559 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 2.2146 - accuracy10: 0.6247 - val_loss: 2.5004 - val_accuracy10: 0.6695 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 2.1837 - accuracy10: 0.6319 - val_loss: 2.4823 - val_accuracy10: 0.6669 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 2.1570 - accuracy10: 0.6367 - val_loss: 2.4833 - val_accuracy10: 0.6662 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 2.1410 - accuracy10: 0.6378 - val_loss: 2.4849 - val_accuracy10: 0.6706 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 2.1292 - accuracy10: 0.6376 - val_loss: 2.4805 - val_accuracy10: 0.6727 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 2.1162 - accuracy10: 0.6399 - val_loss: 2.4903 - val_accuracy10: 0.6716 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 25s - loss: 2.1028 - accuracy10: 0.6410 - val_loss: 2.4453 - val_accuracy10: 0.6775 - 25s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 2.0930 - accuracy10: 0.6431 - val_loss: 2.4522 - val_accuracy10: 0.6805 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 2.0869 - accuracy10: 0.6439 - val_loss: 2.4438 - val_accuracy10: 0.6777 - 24s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 25s - loss: 2.0803 - accuracy10: 0.6455 - val_loss: 2.4416 - val_accuracy10: 0.6714 - 25s/epoch - 17ms/step
Epoch 14/50
1504/1504 - 25s - loss: 2.0752 - accuracy10: 0.6463 - val_loss: 2.4809 - val_accuracy10: 0.6846 - 25s/epoch - 17ms/step
Epoch 15/50
1504/1504 - 25s - loss: 2.0702 - accuracy10: 0.6475 - val_loss: 2.4652 - val_accuracy10: 0.6814 - 25s/epoch - 16ms/step
Epoch 16/50
1504/1504 - 25s - loss: 2.0641 - accuracy10: 0.6483 - val_loss: 2.4461 - val_accuracy10: 0.6776 - 25s/epoch - 17ms/step
Epoch 17/50
1504/1504 - 25s - loss: 2.0606 - accuracy10: 0.6488 - val_loss: 2.4433 - val_accuracy10: 0.6750 - 25s/epoch - 16ms/step
Epoch 18/50
1504/1504 - 24s - loss: 2.0550 - accuracy10: 0.6486 - val_loss: 2.4342 - val_accuracy10: 0.6687 - 24s/epoch - 16ms/step
Epoch 19/50
1504/1504 - 24s - loss: 2.0506 - accuracy10: 0.6498 - val_loss: 2.4420 - val_accuracy10: 0.6661 - 24s/epoch - 16ms/step
Epoch 20/50
1504/1504 - 25s - loss: 2.0469 - accuracy10: 0.6501 - val_loss: 2.4099 - val_accuracy10: 0.6662 - 25s/epoch - 16ms/step
Epoch 21/50
1504/1504 - 24s - loss: 2.0446 - accuracy10: 0.6509 - val_loss: 2.3956 - val_accuracy10: 0.6679 - 24s/epoch - 16ms/step
Epoch 22/50
1504/1504 - 24s - loss: 2.0397 - accuracy10: 0.6510 - val_loss: 2.4274 - val_accuracy10: 0.6700 - 24s/epoch - 16ms/step
Epoch 23/50
1504/1504 - 24s - loss: 2.0357 - accuracy10: 0.6516 - val_loss: 2.3881 - val_accuracy10: 0.6600 - 24s/epoch - 16ms/step
Epoch 24/50
1504/1504 - 24s - loss: 2.0317 - accuracy10: 0.6528 - val_loss: 2.3868 - val_accuracy10: 0.6621 - 24s/epoch - 16ms/step
Epoch 25/50
1504/1504 - 24s - loss: 2.0284 - accuracy10: 0.6524 - val_loss: 2.4225 - val_accuracy10: 0.6679 - 24s/epoch - 16ms/step
Epoch 26/50
1504/1504 - 24s - loss: 2.0254 - accuracy10: 0.6529 - val_loss: 2.3872 - val_accuracy10: 0.6677 - 24s/epoch - 16ms/step
Epoch 27/50
1504/1504 - 24s - loss: 2.0206 - accuracy10: 0.6548 - val_loss: 2.4108 - val_accuracy10: 0.6626 - 24s/epoch - 16ms/step
Epoch 28/50
1504/1504 - 24s - loss: 2.0177 - accuracy10: 0.6548 - val_loss: 2.4066 - val_accuracy10: 0.6680 - 24s/epoch - 16ms/step
Epoch 29/50
1504/1504 - 24s - loss: 2.0141 - accuracy10: 0.6556 - val_loss: 2.4355 - val_accuracy10: 0.6646 - 24s/epoch - 16ms/step
Epoch 30/50
1504/1504 - 24s - loss: 2.0112 - accuracy10: 0.6552 - val_loss: 2.4201 - val_accuracy10: 0.6604 - 24s/epoch - 16ms/step
Epoch 31/50
1504/1504 - 24s - loss: 2.0096 - accuracy10: 0.6551 - val_loss: 2.3928 - val_accuracy10: 0.6597 - 24s/epoch - 16ms/step
Epoch 32/50
1504/1504 - 24s - loss: 2.0055 - accuracy10: 0.6560 - val_loss: 2.4340 - val_accuracy10: 0.6673 - 24s/epoch - 16ms/step
Epoch 33/50
1504/1504 - 24s - loss: 2.0028 - accuracy10: 0.6567 - val_loss: 2.4140 - val_accuracy10: 0.6548 - 24s/epoch - 16ms/step
Epoch 34/50
1504/1504 - 25s - loss: 1.9982 - accuracy10: 0.6565 - val_loss: 2.4387 - val_accuracy10: 0.6624 - 25s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h10
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79055953
{'0': {'precision': 0.3593692264220662, 'recall': 0.6878175360502545, 'f1-score': 0.4720847602510542, 'support': 192301}, '1': {'precision': 0.825169670898791, 'recall': 0.6693651221977068, 'f1-score': 0.739146121115894, 'support': 755988}, '2': {'precision': 0.449470596062578, 'recall': 0.37171438752410496, 'f1-score': 0.40691120920347285, 'support': 190832}, 'accuracy': 0.6226160346442564, 'macro avg': {'precision': 0.5446698311278118, 'recall': 0.5762990152573554, 'f1-score': 0.539380696856807, 'support': 1139121}, 'weighted avg': {'precision': 0.6835962145912847, 'recall': 0.6226160346442564, 'f1-score': 0.638404216203474, 'support': 1139121}}
[[132268  38424  21609]
 [184681 506032  65275]
 [ 51107  68790  70935]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7657163
{'0': {'precision': 0.3168928805691508, 'recall': 0.713436452791609, 'f1-score': 0.43885566548071714, 'support': 52819}, '1': {'precision': 0.8797614079874322, 'recall': 0.6431021984252873, 'f1-score': 0.7430429004724795, 'support': 278654}, '2': {'precision': 0.42785725767561483, 'recall': 0.4989502493157875, 'f1-score': 0.46067707431894495, 'support': 53346}, 'accuracy': 0.6327728100743466, 'macro avg': {'precision': 0.5415038487440659, 'recall': 0.6184963001775613, 'f1-score': 0.5475252134240473, 'support': 384819}, 'weighted avg': {'precision': 0.739858150735996, 'recall': 0.6327728100743466, 'f1-score': 0.6621478487026439, 'support': 384819}}
[[ 37683   8654   6482]
 [ 70340 179203  29111]
 [ 10891  15838  26617]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7090673
{'0': {'precision': 0.34569328598563054, 'recall': 0.7160043332002964, 'f1-score': 0.46626814688300594, 'support': 17539}, '1': {'precision': 0.8767755250698069, 'recall': 0.6840742611770649, 'f1-score': 0.7685295213096146, 'support': 95016}, '2': {'precision': 0.4365368310807441, 'recall': 0.48746936957006015, 'f1-score': 0.46059936327518614, 'support': 17956}, 'accuracy': 0.6613159044065251, 'macro avg': {'precision': 0.5530018807120606, 'recall': 0.6291826546491405, 'f1-score': 0.5651323438226022, 'support': 130511}, 'weighted avg': {'precision': 0.7448358618953238, 'recall': 0.6613159044065251, 'f1-score': 0.6855437487407545, 'support': 130511}}
[[12558  2994  1987]
 [20707 64998  9311]
 [ 3062  6141  8753]]
training model: results/EXC/W6/deepLOB_L1/h20
Epoch 1/50
1504/1504 - 26s - loss: 2.7757 - accuracy20: 0.4740 - val_loss: 2.8434 - val_accuracy20: 0.5487 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 2.5449 - accuracy20: 0.5550 - val_loss: 2.7678 - val_accuracy20: 0.6330 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 2.4107 - accuracy20: 0.5964 - val_loss: 2.6467 - val_accuracy20: 0.6408 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 2.3578 - accuracy20: 0.6113 - val_loss: 2.6618 - val_accuracy20: 0.6448 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 2.3251 - accuracy20: 0.6164 - val_loss: 2.6331 - val_accuracy20: 0.6486 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 25s - loss: 2.3037 - accuracy20: 0.6191 - val_loss: 2.5839 - val_accuracy20: 0.6429 - 25s/epoch - 17ms/step
Epoch 7/50
1504/1504 - 25s - loss: 2.2856 - accuracy20: 0.6214 - val_loss: 2.5688 - val_accuracy20: 0.6502 - 25s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 25s - loss: 2.2730 - accuracy20: 0.6216 - val_loss: 2.5507 - val_accuracy20: 0.6477 - 25s/epoch - 17ms/step
Epoch 9/50
1504/1504 - 25s - loss: 2.2607 - accuracy20: 0.6236 - val_loss: 2.5401 - val_accuracy20: 0.6506 - 25s/epoch - 17ms/step
Epoch 10/50
1504/1504 - 25s - loss: 2.2530 - accuracy20: 0.6253 - val_loss: 2.5212 - val_accuracy20: 0.6459 - 25s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 2.2434 - accuracy20: 0.6265 - val_loss: 2.5056 - val_accuracy20: 0.6465 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 2.2352 - accuracy20: 0.6279 - val_loss: 2.4975 - val_accuracy20: 0.6467 - 24s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 24s - loss: 2.2296 - accuracy20: 0.6287 - val_loss: 2.4889 - val_accuracy20: 0.6477 - 24s/epoch - 16ms/step
Epoch 14/50
1504/1504 - 24s - loss: 2.2234 - accuracy20: 0.6294 - val_loss: 2.4726 - val_accuracy20: 0.6455 - 24s/epoch - 16ms/step
Epoch 15/50
1504/1504 - 25s - loss: 2.2180 - accuracy20: 0.6307 - val_loss: 2.4709 - val_accuracy20: 0.6477 - 25s/epoch - 16ms/step
Epoch 16/50
1504/1504 - 24s - loss: 2.2135 - accuracy20: 0.6304 - val_loss: 2.4596 - val_accuracy20: 0.6470 - 24s/epoch - 16ms/step
Epoch 17/50
1504/1504 - 24s - loss: 2.2075 - accuracy20: 0.6322 - val_loss: 2.4606 - val_accuracy20: 0.6539 - 24s/epoch - 16ms/step
Epoch 18/50
1504/1504 - 24s - loss: 2.2043 - accuracy20: 0.6320 - val_loss: 2.4590 - val_accuracy20: 0.6484 - 24s/epoch - 16ms/step
Epoch 19/50
1504/1504 - 24s - loss: 2.1995 - accuracy20: 0.6331 - val_loss: 2.4380 - val_accuracy20: 0.6431 - 24s/epoch - 16ms/step
Epoch 20/50
1504/1504 - 24s - loss: 2.1964 - accuracy20: 0.6334 - val_loss: 2.4399 - val_accuracy20: 0.6442 - 24s/epoch - 16ms/step
Epoch 21/50
1504/1504 - 24s - loss: 2.1912 - accuracy20: 0.6342 - val_loss: 2.4406 - val_accuracy20: 0.6508 - 24s/epoch - 16ms/step
Epoch 22/50
1504/1504 - 24s - loss: 2.1878 - accuracy20: 0.6341 - val_loss: 2.4296 - val_accuracy20: 0.6388 - 24s/epoch - 16ms/step
Epoch 23/50
1504/1504 - 24s - loss: 2.1845 - accuracy20: 0.6344 - val_loss: 2.4403 - val_accuracy20: 0.6480 - 24s/epoch - 16ms/step
Epoch 24/50
1504/1504 - 24s - loss: 2.1808 - accuracy20: 0.6360 - val_loss: 2.4445 - val_accuracy20: 0.6476 - 24s/epoch - 16ms/step
Epoch 25/50
1504/1504 - 24s - loss: 2.1776 - accuracy20: 0.6354 - val_loss: 2.4297 - val_accuracy20: 0.6408 - 24s/epoch - 16ms/step
Epoch 26/50
1504/1504 - 24s - loss: 2.1734 - accuracy20: 0.6370 - val_loss: 2.4310 - val_accuracy20: 0.6491 - 24s/epoch - 16ms/step
Epoch 27/50
1504/1504 - 24s - loss: 2.1696 - accuracy20: 0.6367 - val_loss: 2.4269 - val_accuracy20: 0.6423 - 24s/epoch - 16ms/step
Epoch 28/50
1504/1504 - 24s - loss: 2.1660 - accuracy20: 0.6373 - val_loss: 2.4212 - val_accuracy20: 0.6453 - 24s/epoch - 16ms/step
Epoch 29/50
1504/1504 - 24s - loss: 2.1631 - accuracy20: 0.6379 - val_loss: 2.4264 - val_accuracy20: 0.6467 - 24s/epoch - 16ms/step
Epoch 30/50
1504/1504 - 24s - loss: 2.1614 - accuracy20: 0.6381 - val_loss: 2.4177 - val_accuracy20: 0.6435 - 24s/epoch - 16ms/step
Epoch 31/50
1504/1504 - 24s - loss: 2.1595 - accuracy20: 0.6380 - val_loss: 2.4358 - val_accuracy20: 0.6421 - 24s/epoch - 16ms/step
Epoch 32/50
1504/1504 - 24s - loss: 2.1535 - accuracy20: 0.6392 - val_loss: 2.4243 - val_accuracy20: 0.6427 - 24s/epoch - 16ms/step
Epoch 33/50
1504/1504 - 24s - loss: 2.1522 - accuracy20: 0.6387 - val_loss: 2.4385 - val_accuracy20: 0.6455 - 24s/epoch - 16ms/step
Epoch 34/50
1504/1504 - 24s - loss: 2.1482 - accuracy20: 0.6390 - val_loss: 2.4428 - val_accuracy20: 0.6480 - 24s/epoch - 16ms/step
Epoch 35/50
1504/1504 - 24s - loss: 2.1462 - accuracy20: 0.6401 - val_loss: 2.4366 - val_accuracy20: 0.6416 - 24s/epoch - 16ms/step
Epoch 36/50
1504/1504 - 24s - loss: 2.1415 - accuracy20: 0.6404 - val_loss: 2.4472 - val_accuracy20: 0.6434 - 24s/epoch - 16ms/step
Epoch 37/50
1504/1504 - 24s - loss: 2.1394 - accuracy20: 0.6406 - val_loss: 2.4442 - val_accuracy20: 0.6407 - 24s/epoch - 16ms/step
Epoch 38/50
1504/1504 - 24s - loss: 2.1371 - accuracy20: 0.6414 - val_loss: 2.4378 - val_accuracy20: 0.6420 - 24s/epoch - 16ms/step
Epoch 39/50
1504/1504 - 24s - loss: 2.1346 - accuracy20: 0.6413 - val_loss: 2.4295 - val_accuracy20: 0.6368 - 24s/epoch - 16ms/step
Epoch 40/50
1504/1504 - 24s - loss: 2.1322 - accuracy20: 0.6419 - val_loss: 2.4419 - val_accuracy20: 0.6406 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h20
Evaluating performance on  test set...
4450/4450 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.858211
{'0': {'precision': 0.41089673180942116, 'recall': 0.7208245473714826, 'f1-score': 0.5234229596483586, 'support': 247554}, '1': {'precision': 0.7836045675696041, 'recall': 0.5948969210836351, 'f1-score': 0.6763343361343208, 'support': 646786}, '2': {'precision': 0.506914791620872, 'recall': 0.44279171994558403, 'f1-score': 0.4726884984234559, 'support': 244781}, 'accuracy': 0.5895782800949153, 'macro avg': {'precision': 0.5671386969999658, 'recall': 0.5861710628002339, 'f1-score': 0.557481931402045, 'support': 1139121}, 'weighted avg': {'precision': 0.6431509058249053, 'recall': 0.5895782800949153, 'f1-score': 0.5993429939544215, 'support': 1139121}}
[[178443  37069  32042]
 [188627 384771  73388]
 [ 67207  69187 108387]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8204262
{'0': {'precision': 0.3922293003686425, 'recall': 0.7082199005116948, 'f1-score': 0.5048567364356839, 'support': 70159}, '1': {'precision': 0.8431905380066349, 'recall': 0.598669495899524, 'f1-score': 0.7001961944504999, 'support': 244118}, '2': {'precision': 0.4702227252897551, 'recall': 0.5653511383289388, 'f1-score': 0.5134176563354896, 'support': 70542}, 'accuracy': 0.6125347241170525, 'macro avg': {'precision': 0.5685475212216775, 'recall': 0.6240801782467192, 'f1-score': 0.5728235290738911, 'support': 384819}, 'weighted avg': {'precision': 0.6926031581836063, 'recall': 0.6125347241170525, 'f1-score': 0.6303437373977802, 'support': 384819}}
[[ 49688  10304  10167]
 [ 63207 146146  34765]
 [ 13786  16875  39881]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7702757
{'0': {'precision': 0.42510606178912574, 'recall': 0.6962953489363516, 'f1-score': 0.5279097579107276, 'support': 23457}, '1': {'precision': 0.8261700095510984, 'recall': 0.6664018393461173, 'f1-score': 0.7377349564568466, 'support': 83073}, '2': {'precision': 0.4879196236344789, 'recall': 0.510320670530837, 'f1-score': 0.4988688013370564, 'support': 23981}, 'accuracy': 0.6430952180275992, 'macro avg': {'precision': 0.579731898324901, 'recall': 0.624339286271102, 'f1-score': 0.5881711719015436, 'support': 130511}, 'weighted avg': {'precision': 0.6919335120350342, 'recall': 0.6430952180275992, 'f1-score': 0.6561317280069535, 'support': 130511}}
[[16333  4149  2975]
 [17844 55360  9869]
 [ 4244  7499 12238]]
training model: results/EXC/W6/deepLOB_L1/h30
Epoch 1/50
1504/1504 - 26s - loss: 2.8539 - accuracy30: 0.4716 - val_loss: 3.0292 - val_accuracy30: 0.5375 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 2.6762 - accuracy30: 0.5357 - val_loss: 2.7752 - val_accuracy30: 0.6022 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 23s - loss: 2.5444 - accuracy30: 0.5819 - val_loss: 2.7789 - val_accuracy30: 0.6169 - 23s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 2.4907 - accuracy30: 0.5945 - val_loss: 2.7723 - val_accuracy30: 0.6218 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 2.4545 - accuracy30: 0.5994 - val_loss: 2.7543 - val_accuracy30: 0.6215 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 2.4248 - accuracy30: 0.6014 - val_loss: 2.7176 - val_accuracy30: 0.6276 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 2.4056 - accuracy30: 0.6039 - val_loss: 2.7220 - val_accuracy30: 0.6296 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 2.3921 - accuracy30: 0.6059 - val_loss: 2.6848 - val_accuracy30: 0.6284 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 2.3839 - accuracy30: 0.6067 - val_loss: 2.7066 - val_accuracy30: 0.6307 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 25s - loss: 2.3731 - accuracy30: 0.6094 - val_loss: 2.6798 - val_accuracy30: 0.6285 - 25s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 25s - loss: 2.3645 - accuracy30: 0.6100 - val_loss: 2.7017 - val_accuracy30: 0.6258 - 25s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 25s - loss: 2.3601 - accuracy30: 0.6119 - val_loss: 2.6762 - val_accuracy30: 0.6286 - 25s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 24s - loss: 2.3549 - accuracy30: 0.6128 - val_loss: 2.6915 - val_accuracy30: 0.6269 - 24s/epoch - 16ms/step
Epoch 14/50
1504/1504 - 24s - loss: 2.3492 - accuracy30: 0.6131 - val_loss: 2.6757 - val_accuracy30: 0.6240 - 24s/epoch - 16ms/step
Epoch 15/50
1504/1504 - 24s - loss: 2.3453 - accuracy30: 0.6132 - val_loss: 2.6866 - val_accuracy30: 0.6278 - 24s/epoch - 16ms/step
Epoch 16/50
1504/1504 - 24s - loss: 2.3403 - accuracy30: 0.6142 - val_loss: 2.6777 - val_accuracy30: 0.6259 - 24s/epoch - 16ms/step
Epoch 17/50
1504/1504 - 24s - loss: 2.3354 - accuracy30: 0.6154 - val_loss: 2.6619 - val_accuracy30: 0.6253 - 24s/epoch - 16ms/step
Epoch 18/50
1504/1504 - 24s - loss: 2.3307 - accuracy30: 0.6161 - val_loss: 2.6349 - val_accuracy30: 0.6235 - 24s/epoch - 16ms/step
Epoch 19/50
1504/1504 - 24s - loss: 2.3288 - accuracy30: 0.6162 - val_loss: 2.6486 - val_accuracy30: 0.6230 - 24s/epoch - 16ms/step
Epoch 20/50
1504/1504 - 24s - loss: 2.3249 - accuracy30: 0.6174 - val_loss: 2.6595 - val_accuracy30: 0.6226 - 24s/epoch - 16ms/step
Epoch 21/50
1504/1504 - 24s - loss: 2.3221 - accuracy30: 0.6180 - val_loss: 2.6559 - val_accuracy30: 0.6234 - 24s/epoch - 16ms/step
Epoch 22/50
1504/1504 - 24s - loss: 2.3183 - accuracy30: 0.6179 - val_loss: 2.6666 - val_accuracy30: 0.6222 - 24s/epoch - 16ms/step
Epoch 23/50
1504/1504 - 24s - loss: 2.3145 - accuracy30: 0.6186 - val_loss: 2.6318 - val_accuracy30: 0.6217 - 24s/epoch - 16ms/step
Epoch 24/50
1504/1504 - 24s - loss: 2.3106 - accuracy30: 0.6203 - val_loss: 2.6433 - val_accuracy30: 0.6212 - 24s/epoch - 16ms/step
Epoch 25/50
1504/1504 - 24s - loss: 2.3076 - accuracy30: 0.6199 - val_loss: 2.6532 - val_accuracy30: 0.6188 - 24s/epoch - 16ms/step
Epoch 26/50
1504/1504 - 24s - loss: 2.3055 - accuracy30: 0.6201 - val_loss: 2.6847 - val_accuracy30: 0.6185 - 24s/epoch - 16ms/step
Epoch 27/50
1504/1504 - 24s - loss: 2.3023 - accuracy30: 0.6216 - val_loss: 2.6463 - val_accuracy30: 0.6129 - 24s/epoch - 16ms/step
Epoch 28/50
1504/1504 - 24s - loss: 2.2980 - accuracy30: 0.6220 - val_loss: 2.6849 - val_accuracy30: 0.6099 - 24s/epoch - 16ms/step
Epoch 29/50
1504/1504 - 24s - loss: 2.2954 - accuracy30: 0.6221 - val_loss: 2.6715 - val_accuracy30: 0.6109 - 24s/epoch - 16ms/step
Epoch 30/50
1504/1504 - 24s - loss: 2.2935 - accuracy30: 0.6225 - val_loss: 2.6537 - val_accuracy30: 0.6162 - 24s/epoch - 16ms/step
Epoch 31/50
1504/1504 - 24s - loss: 2.2903 - accuracy30: 0.6230 - val_loss: 2.6496 - val_accuracy30: 0.6164 - 24s/epoch - 16ms/step
Epoch 32/50
1504/1504 - 24s - loss: 2.2852 - accuracy30: 0.6245 - val_loss: 2.6575 - val_accuracy30: 0.6139 - 24s/epoch - 16ms/step
Epoch 33/50
1504/1504 - 24s - loss: 2.2845 - accuracy30: 0.6244 - val_loss: 2.6887 - val_accuracy30: 0.6172 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h30
Evaluating performance on  test set...
4450/4450 - 32s - 32s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93434215
{'0': {'precision': 0.4579695603095229, 'recall': 0.5876812405530986, 'f1-score': 0.5147801141953456, 'support': 285808}, '1': {'precision': 0.6354948846563778, 'recall': 0.7399414558903438, 'f1-score': 0.6837524882854195, 'support': 570510}, '2': {'precision': 0.6070017670950253, 'recall': 0.23199541730462547, 'f1-score': 0.3356903476681419, 'support': 282803}, 'accuracy': 0.5756341951381811, 'macro avg': {'precision': 0.5668220706869754, 'recall': 0.5198727045826893, 'f1-score': 0.5114076500496356, 'support': 1139121}, 'weighted avg': {'precision': 0.583879562819076, 'recall': 0.5756341951381811, 'f1-score': 0.554945562728851, 'support': 1139121}}
[[167964 102843  15001]
 [120889 422144  27477]
 [ 77905 139289  65609]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86190706
{'0': {'precision': 0.44369197056851134, 'recall': 0.5673994443773402, 'f1-score': 0.49797787589511455, 'support': 82790}, '1': {'precision': 0.7051849833072154, 'recall': 0.7089008725987552, 'f1-score': 0.7070380457058539, 'support': 219001}, '2': {'precision': 0.5354901260396999, 'recall': 0.37917329093799684, 'f1-score': 0.4439743616863749, 'support': 83028}, 'accuracy': 0.6073166865461425, 'macro avg': {'precision': 0.5614556933051422, 'recall': 0.5518245359713642, 'f1-score': 0.5496634277624478, 'support': 384819}, 'weighted avg': {'precision': 0.6123142281370065, 'recall': 0.6073166865461425, 'f1-score': 0.6053025726252617, 'support': 384819}}
[[ 46975  28447   7368]
 [ 43810 155250  19941]
 [ 15088  36458  31482]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.80026674
{'0': {'precision': 0.4531300519809983, 'recall': 0.6584387423202024, 'f1-score': 0.5368239609882581, 'support': 27670}, '1': {'precision': 0.7264817079951073, 'recall': 0.7023961511066912, 'f1-score': 0.7142359331761811, 'support': 74411}, '2': {'precision': 0.5813725490196079, 'recall': 0.37544846992613434, 'f1-score': 0.4562513357555033, 'support': 28430}, 'accuracy': 0.6218556290274383, 'macro avg': {'precision': 0.5869947696652379, 'recall': 0.578761121117676, 'f1-score': 0.5691037433066475, 'support': 130511}, 'weighted avg': {'precision': 0.6369176581327674, 'recall': 0.6218556290274383, 'f1-score': 0.6204239834163164, 'support': 130511}}
[[18219  7433  2018]
 [16477 52266  5668]
 [ 5511 12245 10674]]
training model: results/EXC/W6/deepLOB_L1/h50
Epoch 1/50
1504/1504 - 26s - loss: 2.9798 - accuracy50: 0.4725 - val_loss: 3.2512 - val_accuracy50: 0.4809 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 2.8934 - accuracy50: 0.4957 - val_loss: 3.0908 - val_accuracy50: 0.5063 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 2.7852 - accuracy50: 0.5360 - val_loss: 3.1165 - val_accuracy50: 0.5294 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 2.7139 - accuracy50: 0.5553 - val_loss: 3.0642 - val_accuracy50: 0.5383 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 2.6708 - accuracy50: 0.5641 - val_loss: 2.9826 - val_accuracy50: 0.5466 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 2.6477 - accuracy50: 0.5687 - val_loss: 2.9622 - val_accuracy50: 0.5522 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 2.6328 - accuracy50: 0.5711 - val_loss: 2.9710 - val_accuracy50: 0.5530 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 2.6195 - accuracy50: 0.5734 - val_loss: 2.9739 - val_accuracy50: 0.5548 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 2.6101 - accuracy50: 0.5748 - val_loss: 2.9779 - val_accuracy50: 0.5528 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 2.6013 - accuracy50: 0.5766 - val_loss: 2.9748 - val_accuracy50: 0.5535 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 2.5935 - accuracy50: 0.5774 - val_loss: 2.9840 - val_accuracy50: 0.5545 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 2.5862 - accuracy50: 0.5788 - val_loss: 2.9649 - val_accuracy50: 0.5539 - 24s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 24s - loss: 2.5813 - accuracy50: 0.5794 - val_loss: 2.9679 - val_accuracy50: 0.5541 - 24s/epoch - 16ms/step
Epoch 14/50
1504/1504 - 24s - loss: 2.5751 - accuracy50: 0.5814 - val_loss: 2.9598 - val_accuracy50: 0.5554 - 24s/epoch - 16ms/step
Epoch 15/50
1504/1504 - 24s - loss: 2.5716 - accuracy50: 0.5813 - val_loss: 2.9615 - val_accuracy50: 0.5544 - 24s/epoch - 16ms/step
Epoch 16/50
1504/1504 - 24s - loss: 2.5689 - accuracy50: 0.5815 - val_loss: 2.9404 - val_accuracy50: 0.5569 - 24s/epoch - 16ms/step
Epoch 17/50
1504/1504 - 24s - loss: 2.5629 - accuracy50: 0.5837 - val_loss: 2.9459 - val_accuracy50: 0.5551 - 24s/epoch - 16ms/step
Epoch 18/50
1504/1504 - 24s - loss: 2.5603 - accuracy50: 0.5841 - val_loss: 2.9643 - val_accuracy50: 0.5539 - 24s/epoch - 16ms/step
Epoch 19/50
1504/1504 - 24s - loss: 2.5563 - accuracy50: 0.5845 - val_loss: 2.9555 - val_accuracy50: 0.5546 - 24s/epoch - 16ms/step
Epoch 20/50
1504/1504 - 24s - loss: 2.5528 - accuracy50: 0.5852 - val_loss: 2.9496 - val_accuracy50: 0.5528 - 24s/epoch - 16ms/step
Epoch 21/50
1504/1504 - 24s - loss: 2.5507 - accuracy50: 0.5859 - val_loss: 2.9438 - val_accuracy50: 0.5528 - 24s/epoch - 16ms/step
Epoch 22/50
1504/1504 - 25s - loss: 2.5471 - accuracy50: 0.5862 - val_loss: 2.9592 - val_accuracy50: 0.5529 - 25s/epoch - 17ms/step
Epoch 23/50
1504/1504 - 25s - loss: 2.5439 - accuracy50: 0.5873 - val_loss: 2.9645 - val_accuracy50: 0.5509 - 25s/epoch - 17ms/step
Epoch 24/50
1504/1504 - 25s - loss: 2.5414 - accuracy50: 0.5872 - val_loss: 2.9598 - val_accuracy50: 0.5550 - 25s/epoch - 17ms/step
Epoch 25/50
1504/1504 - 25s - loss: 2.5405 - accuracy50: 0.5877 - val_loss: 2.9560 - val_accuracy50: 0.5522 - 25s/epoch - 17ms/step
Epoch 26/50
1504/1504 - 24s - loss: 2.5359 - accuracy50: 0.5884 - val_loss: 2.9757 - val_accuracy50: 0.5514 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h50
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98272836
{'0': {'precision': 0.4824321452508487, 'recall': 0.5192502250673736, 'f1-score': 0.50016453802947, 'support': 341009}, '1': {'precision': 0.5449407359885574, 'recall': 0.5631936035755978, 'f1-score': 0.5539168418104342, 'support': 460007}, '2': {'precision': 0.48565081976054364, 'recall': 0.4261368509782464, 'f1-score': 0.4539515451883102, 'support': 338105}, 'accuracy': 0.5093585317099764, 'macro avg': {'precision': 0.5043412336666498, 'recall': 0.502860226540406, 'f1-score': 0.5026776416760715, 'support': 1139121}, 'weighted avg': {'precision': 0.5086300989753271, 'recall': 0.5093585317099764, 'f1-score': 0.5081545514352537, 'support': 1139121}}
[[177069  97149  66791]
 [115132 259073  85802]
 [ 74833 119193 144079]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9660064
{'0': {'precision': 0.4408277870216306, 'recall': 0.5381332760439045, 'f1-score': 0.4846446097831249, 'support': 102404}, '1': {'precision': 0.6196029500784463, 'recall': 0.5571972937242399, 'f1-score': 0.5867454375292466, 'support': 180026}, '2': {'precision': 0.48192857215805224, 'recall': 0.4608795866743498, 'f1-score': 0.47116911125977257, 'support': 102389}, 'accuracy': 0.526496872555669, 'macro avg': {'precision': 0.5141197697527097, 'recall': 0.5187367188141647, 'f1-score': 0.5141863861907147, 'support': 384819}, 'weighted avg': {'precision': 0.5353980805721035, 'recall': 0.526496872555669, 'f1-score': 0.5288239792984445, 'support': 384819}}
[[ 55107  27518  19779]
 [ 48767 100310  30949]
 [ 21134  34066  47189]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9283307
{'0': {'precision': 0.49112273040680304, 'recall': 0.5029864359902315, 'f1-score': 0.4969837924267752, 'support': 33987}, '1': {'precision': 0.5922175133469095, 'recall': 0.7011713340827265, 'f1-score': 0.6421053416779179, 'support': 61383}, '2': {'precision': 0.5424501671950319, 'recall': 0.3554537434905097, 'f1-score': 0.4294801265300509, 'support': 35141}, 'accuracy': 0.5564741669284582, 'macro avg': {'precision': 0.5419301369829148, 'recall': 0.5198705045211559, 'f1-score': 0.5228564202115814, 'support': 130511}, 'weighted avg': {'precision': 0.552490726341151, 'recall': 0.5564741669284582, 'f1-score': 0.5470627109425026, 'support': 130511}}
[[17095 12560  4332]
 [12139 43040  6204]
 [ 5574 17076 12491]]
training model: results/EXC/W6/deepLOB_L1/h100
Epoch 1/50
1504/1504 - 26s - loss: 3.1364 - accuracy100: 0.4464 - val_loss: 3.3832 - val_accuracy100: 0.3775 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 3.0972 - accuracy100: 0.4627 - val_loss: 3.2706 - val_accuracy100: 0.4122 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 3.0577 - accuracy100: 0.4760 - val_loss: 3.2561 - val_accuracy100: 0.4247 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 3.0315 - accuracy100: 0.4829 - val_loss: 3.2541 - val_accuracy100: 0.4198 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 3.0066 - accuracy100: 0.4887 - val_loss: 3.2429 - val_accuracy100: 0.4332 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 2.9848 - accuracy100: 0.4938 - val_loss: 3.2312 - val_accuracy100: 0.4301 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 2.9689 - accuracy100: 0.4965 - val_loss: 3.2436 - val_accuracy100: 0.4283 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 2.9576 - accuracy100: 0.4986 - val_loss: 3.2314 - val_accuracy100: 0.4345 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 2.9500 - accuracy100: 0.5000 - val_loss: 3.2159 - val_accuracy100: 0.4343 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 2.9424 - accuracy100: 0.5019 - val_loss: 3.2207 - val_accuracy100: 0.4350 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 2.9364 - accuracy100: 0.5036 - val_loss: 3.2241 - val_accuracy100: 0.4352 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 2.9310 - accuracy100: 0.5045 - val_loss: 3.2174 - val_accuracy100: 0.4381 - 24s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 24s - loss: 2.9283 - accuracy100: 0.5047 - val_loss: 3.2367 - val_accuracy100: 0.4329 - 24s/epoch - 16ms/step
Epoch 14/50
1504/1504 - 25s - loss: 2.9241 - accuracy100: 0.5059 - val_loss: 3.2430 - val_accuracy100: 0.4345 - 25s/epoch - 16ms/step
Epoch 15/50
1504/1504 - 24s - loss: 2.9193 - accuracy100: 0.5067 - val_loss: 3.2400 - val_accuracy100: 0.4337 - 24s/epoch - 16ms/step
Epoch 16/50
1504/1504 - 24s - loss: 2.9157 - accuracy100: 0.5077 - val_loss: 3.2248 - val_accuracy100: 0.4419 - 24s/epoch - 16ms/step
Epoch 17/50
1504/1504 - 24s - loss: 2.9127 - accuracy100: 0.5082 - val_loss: 3.2311 - val_accuracy100: 0.4418 - 24s/epoch - 16ms/step
Epoch 18/50
1504/1504 - 24s - loss: 2.9095 - accuracy100: 0.5090 - val_loss: 3.2293 - val_accuracy100: 0.4415 - 24s/epoch - 16ms/step
Epoch 19/50
1504/1504 - 24s - loss: 2.9065 - accuracy100: 0.5100 - val_loss: 3.2128 - val_accuracy100: 0.4482 - 24s/epoch - 16ms/step
Epoch 20/50
1504/1504 - 24s - loss: 2.9029 - accuracy100: 0.5111 - val_loss: 3.2249 - val_accuracy100: 0.4425 - 24s/epoch - 16ms/step
Epoch 21/50
1504/1504 - 24s - loss: 2.9005 - accuracy100: 0.5115 - val_loss: 3.2389 - val_accuracy100: 0.4410 - 24s/epoch - 16ms/step
Epoch 22/50
1504/1504 - 24s - loss: 2.8978 - accuracy100: 0.5121 - val_loss: 3.2395 - val_accuracy100: 0.4424 - 24s/epoch - 16ms/step
Epoch 23/50
1504/1504 - 24s - loss: 2.8941 - accuracy100: 0.5131 - val_loss: 3.2301 - val_accuracy100: 0.4449 - 24s/epoch - 16ms/step
Epoch 24/50
1504/1504 - 24s - loss: 2.8926 - accuracy100: 0.5137 - val_loss: 3.2456 - val_accuracy100: 0.4424 - 24s/epoch - 16ms/step
Epoch 25/50
1504/1504 - 24s - loss: 2.8894 - accuracy100: 0.5144 - val_loss: 3.2354 - val_accuracy100: 0.4425 - 24s/epoch - 16ms/step
Epoch 26/50
1504/1504 - 24s - loss: 2.8879 - accuracy100: 0.5151 - val_loss: 3.2644 - val_accuracy100: 0.4404 - 24s/epoch - 16ms/step
Epoch 27/50
1504/1504 - 24s - loss: 2.8855 - accuracy100: 0.5159 - val_loss: 3.2394 - val_accuracy100: 0.4429 - 24s/epoch - 16ms/step
Epoch 28/50
1504/1504 - 24s - loss: 2.8828 - accuracy100: 0.5160 - val_loss: 3.2615 - val_accuracy100: 0.4391 - 24s/epoch - 16ms/step
Epoch 29/50
1504/1504 - 24s - loss: 2.8808 - accuracy100: 0.5164 - val_loss: 3.2617 - val_accuracy100: 0.4374 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h100
Evaluating performance on  test set...
4450/4450 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1673037
{'0': {'precision': 0.4953958622901743, 'recall': 0.3637295836011363, 'f1-score': 0.4194733878975972, 'support': 407638}, '1': {'precision': 0.34721829202907184, 'recall': 0.5713493609773432, 'f1-score': 0.4319397675743526, 'support': 326436}, '2': {'precision': 0.44309204983596157, 'recall': 0.3311023165212926, 'f1-score': 0.37899734358220766, 'support': 405047}, 'accuracy': 0.4116252794918187, 'macro avg': {'precision': 0.42856873471840257, 'recall': 0.4220604203665907, 'f1-score': 0.4101368330180524, 'support': 1139121}, 'weighted avg': {'precision': 0.4343347496876547, 'recall': 0.4116252794918187, 'f1-score': 0.40865344409386234, 'support': 1139121}}
[[148270 166849  92519]
 [ 63885 186509  76042]
 [ 87141 183794 134112]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0993024
{'0': {'precision': 0.4758722340727449, 'recall': 0.40343987209139875, 'f1-score': 0.4366727852381412, 'support': 128842}, '1': {'precision': 0.3998004784339124, 'recall': 0.6050653323531504, 'f1-score': 0.4814680861101064, 'support': 126507}, '2': {'precision': 0.4977653631284916, 'recall': 0.32344944774851314, 'f1-score': 0.3921067415730337, 'support': 129470}, 'accuracy': 0.44281077597519874, 'macro avg': {'precision': 0.45781269187838297, 'recall': 0.4439848840643541, 'f1-score': 0.43674920430709374, 'support': 384819}, 'weighted avg': {'precision': 0.4582298978789648, 'recall': 0.44281077597519874, 'f1-score': 0.4364050059811093, 'support': 384819}}
[[51980 54624 22238]
 [29947 76545 20015]
 [27304 60289 41877]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0729072
{'0': {'precision': 0.4924709476785422, 'recall': 0.43135334034215805, 'f1-score': 0.4598904598140364, 'support': 41852}, '1': {'precision': 0.40093334026622296, 'recall': 0.6940056703118671, 'f1-score': 0.5082475076213232, 'support': 44442}, '2': {'precision': 0.5651994091580502, 'recall': 0.21634213085464865, 'f1-score': 0.3129109286578784, 'support': 44217}, 'accuracy': 0.4479469163518784, 'macro avg': {'precision': 0.4862012323676052, 'recall': 0.4472337138362246, 'f1-score': 0.427016298697746, 'support': 130511}, 'weighted avg': {'precision': 0.48594061715177517, 'recall': 0.4479469163518784, 'f1-score': 0.4265606254668902, 'support': 130511}}
[[18053 19917  3882]
 [10122 30843  3477]
 [ 8483 26168  9566]]
training model: results/EXC/W6/deepLOB_L1/h200
Epoch 1/50
1504/1504 - 26s - loss: 3.2322 - accuracy200: 0.4089 - val_loss: 3.3798 - val_accuracy200: 0.3739 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 3.2065 - accuracy200: 0.4183 - val_loss: 3.3465 - val_accuracy200: 0.3555 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 3.1899 - accuracy200: 0.4248 - val_loss: 3.4149 - val_accuracy200: 0.3428 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 3.1796 - accuracy200: 0.4286 - val_loss: 3.4850 - val_accuracy200: 0.3388 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 3.1725 - accuracy200: 0.4313 - val_loss: 3.4320 - val_accuracy200: 0.3478 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 3.1672 - accuracy200: 0.4338 - val_loss: 3.4322 - val_accuracy200: 0.3431 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 3.1623 - accuracy200: 0.4365 - val_loss: 3.4686 - val_accuracy200: 0.3471 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 3.1587 - accuracy200: 0.4376 - val_loss: 3.4275 - val_accuracy200: 0.3502 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 3.1546 - accuracy200: 0.4391 - val_loss: 3.5038 - val_accuracy200: 0.3428 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 3.1516 - accuracy200: 0.4402 - val_loss: 3.4758 - val_accuracy200: 0.3443 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 3.1492 - accuracy200: 0.4409 - val_loss: 3.4579 - val_accuracy200: 0.3493 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 25s - loss: 3.1465 - accuracy200: 0.4420 - val_loss: 3.4379 - val_accuracy200: 0.3507 - 25s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h200
Evaluating performance on  test set...
4450/4450 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1241899
{'0': {'precision': 0.3865842531933351, 'recall': 0.2717725611839857, 'f1-score': 0.3191673278361082, 'support': 380410}, '1': {'precision': 0.3483146239560719, 'recall': 0.5880499728408474, 'f1-score': 0.43749284383049186, 'support': 386610}, '2': {'precision': 0.35236955787127944, 'recall': 0.20737380442406766, 'f1-score': 0.261091852806778, 'support': 372101}, 'accuracy': 0.35807872912535194, 'macro avg': {'precision': 0.36242281167356216, 'recall': 0.35573211281630024, 'f1-score': 0.3392506748244593, 'support': 1139121}, 'weighted avg': {'precision': 0.3624193543779761, 'recall': 0.35807872912535194, 'f1-score': 0.34035549433000994, 'support': 1139121}}
[[103385 212520  64505]
 [ 81947 227346  77317]
 [ 82100 212837  77164]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1273775
{'0': {'precision': 0.37812496944691587, 'recall': 0.29915455480697084, 'f1-score': 0.33403580898420293, 'support': 129281}, '1': {'precision': 0.3201978683745161, 'recall': 0.533166209064502, 'f1-score': 0.4001074995894112, 'support': 125655}, '2': {'precision': 0.3973645441152398, 'recall': 0.2242787739734992, 'f1-score': 0.2867252978724451, 'support': 129883}, 'accuracy': 0.350294554063079, 'macro avg': {'precision': 0.3652291273122239, 'recall': 0.352199845948324, 'f1-score': 0.34028953548201973, 'support': 384819}, 'weighted avg': {'precision': 0.365703711118698, 'recall': 0.350294554063079, 'f1-score': 0.3396420996514231, 'support': 384819}}
[[38675 69513 21093]
 [35575 66995 23085]
 [28031 72722 29130]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164795
{'0': {'precision': 0.3475383911107412, 'recall': 0.417967967967968, 'f1-score': 0.3795132813742643, 'support': 39960}, '1': {'precision': 0.34730085142424105, 'recall': 0.4971497851703748, 'f1-score': 0.40892986799401637, 'support': 47014}, '2': {'precision': 0.42213277022568296, 'recall': 0.14693249420033536, 'f1-score': 0.2179891295087833, 'support': 43537}, 'accuracy': 0.3560772655178491, 'macro avg': {'precision': 0.3723240042535551, 'recall': 0.3540167491128927, 'f1-score': 0.3354774262923546, 'support': 130511}, 'weighted avg': {'precision': 0.3723366670622403, 'recall': 0.3560772655178491, 'f1-score': 0.33622738519366324, 'support': 130511}}
[[16702 19231  4027]
 [18911 23373  4730]
 [12445 24695  6397]]
training model: results/EXC/W6/deepLOB_L1/h300
Epoch 1/50
1504/1504 - 26s - loss: 3.2650 - accuracy300: 0.3911 - val_loss: 3.3658 - val_accuracy300: 0.3600 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 3.2359 - accuracy300: 0.4047 - val_loss: 3.4025 - val_accuracy300: 0.3459 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 3.2235 - accuracy300: 0.4115 - val_loss: 3.4533 - val_accuracy300: 0.3451 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 3.2167 - accuracy300: 0.4153 - val_loss: 3.4071 - val_accuracy300: 0.3534 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 3.2096 - accuracy300: 0.4197 - val_loss: 3.4505 - val_accuracy300: 0.3395 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 3.2051 - accuracy300: 0.4210 - val_loss: 3.4435 - val_accuracy300: 0.3452 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 3.2002 - accuracy300: 0.4243 - val_loss: 3.4211 - val_accuracy300: 0.3478 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 3.1959 - accuracy300: 0.4253 - val_loss: 3.4721 - val_accuracy300: 0.3463 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 3.1928 - accuracy300: 0.4274 - val_loss: 3.4607 - val_accuracy300: 0.3471 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 3.1891 - accuracy300: 0.4288 - val_loss: 3.4599 - val_accuracy300: 0.3506 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 3.1853 - accuracy300: 0.4312 - val_loss: 3.4510 - val_accuracy300: 0.3571 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h300
Evaluating performance on  test set...
4450/4450 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1372448
{'0': {'precision': 0.39075125128720933, 'recall': 0.20769074107074667, 'f1-score': 0.2712223339622171, 'support': 392810}, '1': {'precision': 0.33447687968258766, 'recall': 0.17666870452680336, 'f1-score': 0.23121239370223468, 'support': 363126}, '2': {'precision': 0.3525113907939366, 'recall': 0.6794159479102784, 'f1-score': 0.4641835752237635, 'support': 383185}, 'accuracy': 0.3564836395782362, 'macro avg': {'precision': 0.35924650725457785, 'recall': 0.3545917978359428, 'f1-score': 0.32220610096273844, 'support': 1139121}, 'weighted avg': {'precision': 0.3599488796283473, 'recall': 0.3564836395782362, 'f1-score': 0.3233776393827644, 'support': 1139121}}
[[ 81583  69415 241812]
 [ 62592  64153 236381]
 [ 64610  58233 260342]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1293105
{'0': {'precision': 0.37248477058573276, 'recall': 0.31966659157467897, 'f1-score': 0.34406039931774857, 'support': 128731}, '1': {'precision': 0.35422084327193815, 'recall': 0.15547683709213997, 'f1-score': 0.2161011849404247, 'support': 127035}, '2': {'precision': 0.35718697245439945, 'recall': 0.6049839988221893, 'f1-score': 0.44917672508025636, 'support': 129053}, 'accuracy': 0.3611490077153155, 'macro avg': {'precision': 0.3612975287706901, 'recall': 0.3600424758296694, 'f1-score': 0.33644610311280987, 'support': 384819}, 'weighted avg': {'precision': 0.3613252780748358, 'recall': 0.3611490077153155, 'f1-score': 0.33707082341376665, 'support': 384819}}
[[41151 18090 69490]
 [36266 19751 71018]
 [33060 17918 78075]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1213142
{'0': {'precision': 0.32957030256801423, 'recall': 0.48978512230143334, 'f1-score': 0.3940136991853443, 'support': 39697}, '1': {'precision': 0.4039515528790852, 'recall': 0.12908945445109954, 'f1-score': 0.19565431127716054, 'support': 46247}, '2': {'precision': 0.3798755662089994, 'recall': 0.48360894832499385, 'f1-score': 0.4255113322277501, 'support': 44567}, 'accuracy': 0.3598623870784838, 'macro avg': {'precision': 0.3711324738853663, 'recall': 0.3674945083591756, 'f1-score': 0.33839311423008495, 'support': 130511}, 'weighted avg': {'precision': 0.37310582346528637, 'recall': 0.3598623870784838, 'f1-score': 0.33448023763199725, 'support': 130511}}
[[19443  3887 16367]
 [21460  5970 18817]
 [18092  4922 21553]]
training model: results/EXC/W6/deepLOB_L1/h500
Epoch 1/50
1504/1504 - 26s - loss: 3.2250 - accuracy500: 0.4216 - val_loss: 3.4033 - val_accuracy500: 0.2887 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 3.1959 - accuracy500: 0.4340 - val_loss: 3.4402 - val_accuracy500: 0.2822 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 3.1906 - accuracy500: 0.4357 - val_loss: 3.3608 - val_accuracy500: 0.3546 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 3.1847 - accuracy500: 0.4373 - val_loss: 3.4560 - val_accuracy500: 0.2957 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 3.1753 - accuracy500: 0.4390 - val_loss: 3.4923 - val_accuracy500: 0.2933 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 3.1655 - accuracy500: 0.4438 - val_loss: 3.4304 - val_accuracy500: 0.3525 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 3.1588 - accuracy500: 0.4472 - val_loss: 3.5821 - val_accuracy500: 0.2809 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 3.1512 - accuracy500: 0.4497 - val_loss: 3.6240 - val_accuracy500: 0.2761 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 3.1473 - accuracy500: 0.4509 - val_loss: 3.6722 - val_accuracy500: 0.2741 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 3.1424 - accuracy500: 0.4541 - val_loss: 3.7551 - val_accuracy500: 0.2728 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 3.1393 - accuracy500: 0.4552 - val_loss: 3.8082 - val_accuracy500: 0.2725 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 3.1341 - accuracy500: 0.4559 - val_loss: 3.8015 - val_accuracy500: 0.2734 - 24s/epoch - 16ms/step
Epoch 13/50
1504/1504 - 25s - loss: 3.1267 - accuracy500: 0.4596 - val_loss: 3.8037 - val_accuracy500: 0.2736 - 25s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h500
Evaluating performance on  test set...
4450/4450 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273886
{'0': {'precision': 0.3130445057109098, 'recall': 0.14337045575072785, 'f1-score': 0.19666898433962407, 'support': 277191}, '1': {'precision': 0.49231840918337183, 'recall': 0.28751540511389956, 'f1-score': 0.3630238244771197, 'support': 585033}, '2': {'precision': 0.24178312031140475, 'recall': 0.5854812439282477, 'f1-score': 0.3422351745342815, 'support': 276897}, 'accuracy': 0.32486891208221075, 'macro avg': {'precision': 0.3490486784018954, 'recall': 0.33878903493095835, 'f1-score': 0.3006426611170084, 'support': 1139121}, 'weighted avg': {'precision': 0.38779432222490445, 'recall': 0.32486891208221075, 'f1-score': 0.31749013727815256, 'support': 1139121}}
[[ 39741  88415 149035]
 [ 57470 168206 359357]
 [ 29739  85040 162118]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1750793
{'0': {'precision': 0.33192343843458944, 'recall': 0.18187564378687143, 'f1-score': 0.23498986721514775, 'support': 128148}, '1': {'precision': 0.33540956728605414, 'recall': 0.327081635212239, 'f1-score': 0.33119325757094786, 'support': 127592}, '2': {'precision': 0.3543751347428974, 'recall': 0.522114364071615, 'f1-score': 0.4221941012854888, 'support': 129079}, 'accuracy': 0.344146208996957, 'macro avg': {'precision': 0.3405693801545137, 'recall': 0.3436905476902418, 'f1-score': 0.3294590753571948, 'support': 384819}, 'weighted avg': {'precision': 0.3406102357605951, 'recall': 0.344146208996957, 'f1-score': 0.3296809253797467, 'support': 384819}}
[[23307 41558 63283]
 [26359 41733 59500]
 [20552 41133 67394]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1191343
{'0': {'precision': 0.21347671423314388, 'recall': 0.32617998937931464, 'f1-score': 0.258059732845651, 'support': 32013}, '1': {'precision': 0.5475309920411846, 'recall': 0.2970751597264584, 'f1-score': 0.3851685346487257, 'support': 62294}, '2': {'precision': 0.36150048119168166, 'recall': 0.47726770522594186, 'f1-score': 0.4113949667865051, 'support': 36204}, 'accuracy': 0.3542000291163197, 'macro avg': {'precision': 0.37416939582200337, 'recall': 0.366840951443905, 'f1-score': 0.3515410780936272, 'support': 130511}, 'weighted avg': {'precision': 0.41398571072187657, 'recall': 0.3542000291163197, 'f1-score': 0.36126532095022007, 'support': 130511}}
[[10442  7406 14165]
 [27434 18506 16354]
 [11038  7887 17279]]
training model: results/EXC/W6/deepLOB_L1/h1000
Epoch 1/50
1504/1504 - 26s - loss: 3.2096 - accuracy1000: 0.4300 - val_loss: 3.3877 - val_accuracy1000: 0.3717 - 26s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 24s - loss: 3.1522 - accuracy1000: 0.4469 - val_loss: 3.3707 - val_accuracy1000: 0.3946 - 24s/epoch - 16ms/step
Epoch 3/50
1504/1504 - 24s - loss: 3.1363 - accuracy1000: 0.4521 - val_loss: 3.4092 - val_accuracy1000: 0.3487 - 24s/epoch - 16ms/step
Epoch 4/50
1504/1504 - 24s - loss: 3.1176 - accuracy1000: 0.4596 - val_loss: 3.4533 - val_accuracy1000: 0.3267 - 24s/epoch - 16ms/step
Epoch 5/50
1504/1504 - 24s - loss: 3.1081 - accuracy1000: 0.4635 - val_loss: 3.4863 - val_accuracy1000: 0.3493 - 24s/epoch - 16ms/step
Epoch 6/50
1504/1504 - 24s - loss: 3.0949 - accuracy1000: 0.4667 - val_loss: 3.5729 - val_accuracy1000: 0.3192 - 24s/epoch - 16ms/step
Epoch 7/50
1504/1504 - 24s - loss: 3.0917 - accuracy1000: 0.4685 - val_loss: 3.5733 - val_accuracy1000: 0.3462 - 24s/epoch - 16ms/step
Epoch 8/50
1504/1504 - 24s - loss: 3.0885 - accuracy1000: 0.4700 - val_loss: 3.5473 - val_accuracy1000: 0.3382 - 24s/epoch - 16ms/step
Epoch 9/50
1504/1504 - 24s - loss: 3.0742 - accuracy1000: 0.4754 - val_loss: 3.6658 - val_accuracy1000: 0.3260 - 24s/epoch - 16ms/step
Epoch 10/50
1504/1504 - 24s - loss: 3.0649 - accuracy1000: 0.4801 - val_loss: 3.6364 - val_accuracy1000: 0.3371 - 24s/epoch - 16ms/step
Epoch 11/50
1504/1504 - 24s - loss: 3.0608 - accuracy1000: 0.4805 - val_loss: 3.6845 - val_accuracy1000: 0.3330 - 24s/epoch - 16ms/step
Epoch 12/50
1504/1504 - 24s - loss: 3.0592 - accuracy1000: 0.4819 - val_loss: 3.6655 - val_accuracy1000: 0.3386 - 24s/epoch - 16ms/step
testing model: results/EXC/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232003
{'0': {'precision': 0.3323853005014595, 'recall': 0.02606511289404335, 'f1-score': 0.04833951954370803, 'support': 340762}, '1': {'precision': 0.40915221631017745, 'recall': 0.6675161521119333, 'f1-score': 0.5073348880114277, 'support': 462633}, '2': {'precision': 0.28750583702195837, 'recall': 0.30626463246814367, 'f1-score': 0.2965889145130142, 'support': 335726}, 'accuracy': 0.36916008044799453, 'macro avg': {'precision': 0.34301445127786506, 'recall': 0.33328196582470676, 'f1-score': 0.2840877740227166, 'support': 1139121}, 'weighted avg': {'precision': 0.350335725263373, 'recall': 0.36916008044799453, 'f1-score': 0.30791701892769957, 'support': 1139121}}
[[  8882 219935 111945]
 [ 10953 308815 142865]
 [  6887 226018 102821]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1369302
{'0': {'precision': 0.315535139004892, 'recall': 0.041594576740381896, 'f1-score': 0.07350018760683166, 'support': 127156}, '1': {'precision': 0.35650610532624166, 'recall': 0.6717797906128691, 'f1-score': 0.4658113035179732, 'support': 127515}, '2': {'precision': 0.3632557229504989, 'recall': 0.3566324492116667, 'f1-score': 0.35991361763006785, 'support': 130148}, 'accuracy': 0.35696262398686135, 'macro avg': {'precision': 0.34509898909387754, 'recall': 0.3566689388549726, 'f1-score': 0.2997417029182909, 'support': 384819}, 'weighted avg': {'precision': 0.34525080099096794, 'recall': 0.35696262398686135, 'f1-score': 0.3003644719484919, 'support': 384819}}
[[ 5289 76205 45662]
 [ 6155 85662 35698]
 [ 5318 78415 46415]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1253979
{'0': {'precision': 0.22404554588077696, 'recall': 0.01943919802411739, 'f1-score': 0.03577444453356862, 'support': 34415}, '1': {'precision': 0.40096876946972154, 'recall': 0.8704945515507125, 'f1-score': 0.5490384557617557, 'support': 52492}, '2': {'precision': 0.36790505675954593, 'recall': 0.11446197596550775, 'f1-score': 0.1746020640195907, 'support': 43604}, 'accuracy': 0.39348407413934455, 'macro avg': {'precision': 0.3309731240366815, 'recall': 0.3347985751801126, 'f1-score': 0.253138321438305, 'support': 130511}, 'weighted avg': {'precision': 0.3432684770129323, 'recall': 0.39348407413934455, 'f1-score': 0.2885937011284802, 'support': 130511}}
[[  669 30458  3288]
 [ 1511 45694  5287]
 [  806 37807  4991]]
training model: results/EXC/W6/deepOF_L1/h10
Epoch 1/50
1504/1504 - 25s - loss: 3.0961 - accuracy10: 0.3745 - val_loss: 3.1667 - val_accuracy10: 0.5870 - 25s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 22s - loss: 3.0225 - accuracy10: 0.3919 - val_loss: 3.1118 - val_accuracy10: 0.5900 - 22s/epoch - 15ms/step
Epoch 3/50
1504/1504 - 22s - loss: 2.9825 - accuracy10: 0.4109 - val_loss: 3.0632 - val_accuracy10: 0.5583 - 22s/epoch - 15ms/step
Epoch 4/50
1504/1504 - 21s - loss: 2.9538 - accuracy10: 0.4191 - val_loss: 3.0559 - val_accuracy10: 0.5628 - 21s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 22s - loss: 2.9314 - accuracy10: 0.4250 - val_loss: 3.0455 - val_accuracy10: 0.5647 - 22s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 21s - loss: 2.9158 - accuracy10: 0.4306 - val_loss: 3.0516 - val_accuracy10: 0.5768 - 21s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 22s - loss: 2.8992 - accuracy10: 0.4379 - val_loss: 3.0592 - val_accuracy10: 0.5874 - 22s/epoch - 15ms/step
Epoch 8/50
1504/1504 - 22s - loss: 2.8843 - accuracy10: 0.4449 - val_loss: 3.0497 - val_accuracy10: 0.5927 - 22s/epoch - 15ms/step
Epoch 9/50
1504/1504 - 22s - loss: 2.8727 - accuracy10: 0.4497 - val_loss: 3.0863 - val_accuracy10: 0.5804 - 22s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 22s - loss: 2.8602 - accuracy10: 0.4568 - val_loss: 3.0883 - val_accuracy10: 0.5894 - 22s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 22s - loss: 2.8490 - accuracy10: 0.4603 - val_loss: 3.0571 - val_accuracy10: 0.5925 - 22s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 22s - loss: 2.8342 - accuracy10: 0.4678 - val_loss: 3.0649 - val_accuracy10: 0.5809 - 22s/epoch - 15ms/step
Epoch 13/50
1504/1504 - 21s - loss: 2.8277 - accuracy10: 0.4686 - val_loss: 3.0861 - val_accuracy10: 0.5799 - 21s/epoch - 14ms/step
Epoch 14/50
1504/1504 - 22s - loss: 2.8139 - accuracy10: 0.4767 - val_loss: 3.0634 - val_accuracy10: 0.5687 - 22s/epoch - 15ms/step
Epoch 15/50
1504/1504 - 22s - loss: 2.8009 - accuracy10: 0.4816 - val_loss: 3.0716 - val_accuracy10: 0.5771 - 22s/epoch - 15ms/step
testing model: results/EXC/W6/deepOF_L1/h10
Evaluating performance on  test set...
4450/4450 - 31s - 31s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9662038
{'0': {'precision': 0.2636616693202825, 'recall': 0.5132529368632895, 'f1-score': 0.34836550900148067, 'support': 192297}, '1': {'precision': 0.6830869946261879, 'recall': 0.579420572813325, 'f1-score': 0.6269976797213948, 'support': 755988}, '2': {'precision': 0.29614008386898305, 'recall': 0.19169317354098653, 'f1-score': 0.23273539319945158, 'support': 190831}, 'accuracy': 0.5032964158171775, 'macro avg': {'precision': 0.4142962492718178, 'recall': 0.42812222773920044, 'f1-score': 0.4026995273074423, 'support': 1139116}, 'weighted avg': {'precision': 0.5474592818146237, 'recall': 0.5032964158171775, 'f1-score': 0.5139120967498657, 'support': 1139116}}
[[ 98697  87658   5942]
 [236950 438035  81003]
 [ 38685 115565  36581]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.92030483
{'0': {'precision': 0.24708582783045127, 'recall': 0.5452672563695471, 'f1-score': 0.3400701382135384, 'support': 52908}, '1': {'precision': 0.7695287711839962, 'recall': 0.6223433653218108, 'f1-score': 0.6881539081210106, 'support': 278642}, '2': {'precision': 0.313456946200309, 'recall': 0.25135165577832846, 'f1-score': 0.2789898105894855, 'support': 53268}, 'accuracy': 0.560392185396733, 'macro avg': {'precision': 0.44335718173825217, 'recall': 0.4729874258232287, 'f1-score': 0.43573795230801143, 'support': 384818}, 'weighted avg': {'precision': 0.6345677110979805, 'recall': 0.560392185396733, 'f1-score': 0.5836583563391974, 'support': 384818}}
[[ 28849  22098   1961]
 [ 77867 173411  27364]
 [ 10041  29838  13389]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91770583
{'0': {'precision': 0.24609873259695497, 'recall': 0.5177276620039966, 'f1-score': 0.33361539310547805, 'support': 17515}, '1': {'precision': 0.76628464210553, 'recall': 0.6354795298273651, 'f1-score': 0.694779070302083, 'support': 95114}, '2': {'precision': 0.2843906397944001, 'recall': 0.23515266748685829, 'f1-score': 0.2574384718991061, 'support': 17882}, 'accuracy': 0.5648259533679153, 'macro avg': {'precision': 0.43225800483229504, 'recall': 0.46278661977273994, 'f1-score': 0.4286109784355557, 'support': 130511}, 'weighted avg': {'precision': 0.6304471666868273, 'recall': 0.5648259533679153, 'f1-score': 0.5863873915413612, 'support': 130511}}
[[ 9068  7903   544]
 [24634 60443 10037]
 [ 3145 10532  4205]]
training model: results/EXC/W6/deepOF_L1/h20
Epoch 1/50
1504/1504 - 24s - loss: 3.1066 - accuracy20: 0.3946 - val_loss: 3.1938 - val_accuracy20: 0.5414 - 24s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 22s - loss: 3.0279 - accuracy20: 0.4216 - val_loss: 3.1476 - val_accuracy20: 0.5328 - 22s/epoch - 14ms/step
Epoch 3/50
1504/1504 - 22s - loss: 2.9899 - accuracy20: 0.4373 - val_loss: 3.1401 - val_accuracy20: 0.5315 - 22s/epoch - 15ms/step
Epoch 4/50
1504/1504 - 22s - loss: 2.9660 - accuracy20: 0.4455 - val_loss: 3.1145 - val_accuracy20: 0.5379 - 22s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 21s - loss: 2.9498 - accuracy20: 0.4488 - val_loss: 3.0949 - val_accuracy20: 0.5409 - 21s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 21s - loss: 2.9368 - accuracy20: 0.4507 - val_loss: 3.0815 - val_accuracy20: 0.5288 - 21s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 22s - loss: 2.9245 - accuracy20: 0.4555 - val_loss: 3.0946 - val_accuracy20: 0.5504 - 22s/epoch - 15ms/step
Epoch 8/50
1504/1504 - 22s - loss: 2.9130 - accuracy20: 0.4597 - val_loss: 3.0960 - val_accuracy20: 0.5422 - 22s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 21s - loss: 2.9021 - accuracy20: 0.4632 - val_loss: 3.0840 - val_accuracy20: 0.5516 - 21s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 21s - loss: 2.8873 - accuracy20: 0.4715 - val_loss: 3.0851 - val_accuracy20: 0.5525 - 21s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 21s - loss: 2.8767 - accuracy20: 0.4747 - val_loss: 3.1091 - val_accuracy20: 0.5574 - 21s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 22s - loss: 2.8654 - accuracy20: 0.4803 - val_loss: 3.1133 - val_accuracy20: 0.5677 - 22s/epoch - 15ms/step
Epoch 13/50
1504/1504 - 21s - loss: 2.8560 - accuracy20: 0.4840 - val_loss: 3.1163 - val_accuracy20: 0.5609 - 21s/epoch - 14ms/step
Epoch 14/50
1504/1504 - 22s - loss: 2.8475 - accuracy20: 0.4857 - val_loss: 3.0932 - val_accuracy20: 0.5575 - 22s/epoch - 15ms/step
Epoch 15/50
1504/1504 - 21s - loss: 2.8347 - accuracy20: 0.4913 - val_loss: 3.0973 - val_accuracy20: 0.5627 - 21s/epoch - 14ms/step
Epoch 16/50
1504/1504 - 22s - loss: 2.8236 - accuracy20: 0.4952 - val_loss: 3.0971 - val_accuracy20: 0.5556 - 22s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h20
Evaluating performance on  test set...
4450/4450 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99621195
{'0': {'precision': 0.3303041670409096, 'recall': 0.5050858412441931, 'f1-score': 0.3994109491895759, 'support': 247550}, '1': {'precision': 0.5933403834247125, 'recall': 0.573401403246205, 'f1-score': 0.583200520192446, 'support': 646786}, '2': {'precision': 0.3991425809641168, 'recall': 0.220986191682327, 'f1-score': 0.28447317007754347, 'support': 244780}, 'accuracy': 0.4828261564230509, 'macro avg': {'precision': 0.440929043809913, 'recall': 0.43315781205757503, 'f1-score': 0.4223615464865218, 'support': 1139116}, 'weighted avg': {'precision': 0.4944475986230636, 'recall': 0.4828261564230509, 'f1-score': 0.4790675003218742, 'support': 1139116}}
[[125034 112299  10217]
 [204705 370868  71213]
 [ 48803 141884  54093]]
Evaluating performance on  train set...
1504/1504 - 11s - 11s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9478095
{'0': {'precision': 0.31575558887561733, 'recall': 0.531082140058417, 'f1-score': 0.39604318075566325, 'support': 70185}, '1': {'precision': 0.6868195356845269, 'recall': 0.6111111111111112, 'f1-score': 0.6467572834052588, 'support': 244134}, '2': {'precision': 0.39480907402922416, 'recall': 0.27747911317891033, 'f1-score': 0.32590568693928207, 'support': 70499}, 'accuracy': 0.5353933547807015, 'macro avg': {'precision': 0.46579473286312273, 'recall': 0.47322412144947945, 'f1-score': 0.45623538370006805, 'support': 384818}, 'weighted avg': {'precision': 0.5656464911725225, 'recall': 0.5353933547807015, 'f1-score': 0.5422505139877245, 'support': 384818}}
[[ 37274  29748   3163]
 [ 68118 149193  26823]
 [ 12655  38282  19562]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95433706
{'0': {'precision': 0.30976161939006525, 'recall': 0.4968174633687898, 'f1-score': 0.3815992387702202, 'support': 23409}, '1': {'precision': 0.6790631767505281, 'recall': 0.6108685979532691, 'f1-score': 0.6431632724118939, 'support': 83157}, '2': {'precision': 0.3626101321585903, 'recall': 0.27500522029651286, 'f1-score': 0.3127894549340933, 'support': 23945}, 'accuracy': 0.5287906766479454, 'macro avg': {'precision': 0.45047830943306116, 'recall': 0.4608970938728573, 'f1-score': 0.4458506553720691, 'support': 130511}, 'weighted avg': {'precision': 0.5547637053725981, 'recall': 0.5287906766479454, 'f1-score': 0.5356339950098061, 'support': 130511}}
[[11630 10709  1070]
 [21854 50798 10505]
 [ 4061 13299  6585]]
training model: results/EXC/W6/deepOF_L1/h30
Epoch 1/50
1504/1504 - 25s - loss: 3.1305 - accuracy30: 0.4027 - val_loss: 3.2456 - val_accuracy30: 0.5044 - 25s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 22s - loss: 3.0580 - accuracy30: 0.4249 - val_loss: 3.1822 - val_accuracy30: 0.5061 - 22s/epoch - 15ms/step
Epoch 3/50
1504/1504 - 22s - loss: 3.0215 - accuracy30: 0.4403 - val_loss: 3.1780 - val_accuracy30: 0.5001 - 22s/epoch - 15ms/step
Epoch 4/50
1504/1504 - 22s - loss: 3.0011 - accuracy30: 0.4473 - val_loss: 3.1870 - val_accuracy30: 0.5025 - 22s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 22s - loss: 2.9845 - accuracy30: 0.4550 - val_loss: 3.1509 - val_accuracy30: 0.5136 - 22s/epoch - 15ms/step
Epoch 6/50
1504/1504 - 22s - loss: 2.9709 - accuracy30: 0.4590 - val_loss: 3.1507 - val_accuracy30: 0.5194 - 22s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 22s - loss: 2.9598 - accuracy30: 0.4624 - val_loss: 3.1499 - val_accuracy30: 0.5178 - 22s/epoch - 15ms/step
Epoch 8/50
1504/1504 - 22s - loss: 2.9475 - accuracy30: 0.4673 - val_loss: 3.1636 - val_accuracy30: 0.5231 - 22s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 22s - loss: 2.9384 - accuracy30: 0.4689 - val_loss: 3.1487 - val_accuracy30: 0.5252 - 22s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 22s - loss: 2.9292 - accuracy30: 0.4721 - val_loss: 3.1748 - val_accuracy30: 0.5262 - 22s/epoch - 15ms/step
Epoch 11/50
1504/1504 - 21s - loss: 2.9197 - accuracy30: 0.4763 - val_loss: 3.1751 - val_accuracy30: 0.5328 - 21s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 22s - loss: 2.9093 - accuracy30: 0.4799 - val_loss: 3.1987 - val_accuracy30: 0.5326 - 22s/epoch - 14ms/step
Epoch 13/50
1504/1504 - 22s - loss: 2.9004 - accuracy30: 0.4831 - val_loss: 3.2155 - val_accuracy30: 0.5338 - 22s/epoch - 15ms/step
Epoch 14/50
1504/1504 - 22s - loss: 2.8918 - accuracy30: 0.4861 - val_loss: 3.2062 - val_accuracy30: 0.5352 - 22s/epoch - 15ms/step
Epoch 15/50
1504/1504 - 22s - loss: 2.8805 - accuracy30: 0.4907 - val_loss: 3.2054 - val_accuracy30: 0.5380 - 22s/epoch - 15ms/step
Epoch 16/50
1504/1504 - 22s - loss: 2.8718 - accuracy30: 0.4944 - val_loss: 3.1824 - val_accuracy30: 0.5347 - 22s/epoch - 15ms/step
Epoch 17/50
1504/1504 - 22s - loss: 2.8624 - accuracy30: 0.4977 - val_loss: 3.2046 - val_accuracy30: 0.5373 - 22s/epoch - 15ms/step
Epoch 18/50
1504/1504 - 22s - loss: 2.8522 - accuracy30: 0.5020 - val_loss: 3.2203 - val_accuracy30: 0.5404 - 22s/epoch - 15ms/step
Epoch 19/50
1504/1504 - 22s - loss: 2.8410 - accuracy30: 0.5048 - val_loss: 3.2002 - val_accuracy30: 0.5370 - 22s/epoch - 15ms/step
testing model: results/EXC/W6/deepOF_L1/h30
Evaluating performance on  test set...
4450/4450 - 30s - 30s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0156124
{'0': {'precision': 0.38952356904430513, 'recall': 0.4426005234356412, 'f1-score': 0.41436929205047235, 'support': 285804}, '1': {'precision': 0.5200204366838475, 'recall': 0.6065765718392315, 'f1-score': 0.5599734623537597, 'support': 570510}, '2': {'precision': 0.4206906741527757, 'recall': 0.22149772632442485, 'f1-score': 0.2902015288394718, 'support': 282802}, 'accuracy': 0.4698336253726574, 'macro avg': {'precision': 0.44341155996030945, 'recall': 0.4235582738664325, 'f1-score': 0.42151476108123465, 'support': 1139116}, 'weighted avg': {'precision': 0.46261874777581363, 'recall': 0.4698336253726574, 'f1-score': 0.4564666231634855, 'support': 1139116}}
[[126497 146158  13149]
 [151343 346058  73109]
 [ 46908 173254  62640]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9535191
{'0': {'precision': 0.37787258136946716, 'recall': 0.4671768071162179, 'f1-score': 0.4178058903215012, 'support': 82853}, '1': {'precision': 0.6201285587838476, 'recall': 0.6589430430316174, 'f1-score': 0.6389468721154421, 'support': 219025}, '2': {'precision': 0.44845921450151055, 'recall': 0.26845912707981673, 'f1-score': 0.33586243306433367, 'support': 82940}, 'accuracy': 0.5334937554896081, 'macro avg': {'precision': 0.48215345155160844, 'recall': 0.464859659075884, 'f1-score': 0.4642050651670923, 'support': 384818}, 'weighted avg': {'precision': 0.5309698138408078, 'recall': 0.5334937554896081, 'f1-score': 0.5260103225271372, 'support': 384818}}
[[ 38707  40274   3872]
 [ 51188 144325  23512]
 [ 12539  48135  22266]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9613473
{'0': {'precision': 0.3744521577785598, 'recall': 0.4232813799587748, 'f1-score': 0.39737235198261817, 'support': 27653}, '1': {'precision': 0.6101976127977812, 'recall': 0.6616010417645558, 'f1-score': 0.6348605179932111, 'support': 74489}, '2': {'precision': 0.41259195153613154, 'recall': 0.26888505058338324, 'f1-score': 0.3255863584949954, 'support': 28369}, 'accuracy': 0.5257411252691344, 'macro avg': {'precision': 0.46574724070415746, 'recall': 0.45125582410223797, 'f1-score': 0.45260640949027486, 'support': 130511}, 'weighted avg': {'precision': 0.5172939949266573, 'recall': 0.5257411252691344, 'f1-score': 0.5173144193080749, 'support': 130511}}
[[11705 14636  1312]
 [15659 49282  9548]
 [ 3895 16846  7628]]
training model: results/EXC/W6/deepOF_L1/h50
Epoch 1/50
1504/1504 - 25s - loss: 3.1765 - accuracy50: 0.4133 - val_loss: 3.3083 - val_accuracy50: 0.4513 - 25s/epoch - 17ms/step
Epoch 2/50
1504/1504 - 23s - loss: 3.1152 - accuracy50: 0.4293 - val_loss: 3.2629 - val_accuracy50: 0.4543 - 23s/epoch - 15ms/step
Epoch 3/50
1504/1504 - 22s - loss: 3.0851 - accuracy50: 0.4416 - val_loss: 3.2453 - val_accuracy50: 0.4591 - 22s/epoch - 14ms/step
Epoch 4/50
1504/1504 - 21s - loss: 3.0691 - accuracy50: 0.4480 - val_loss: 3.2356 - val_accuracy50: 0.4578 - 21s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 22s - loss: 3.0556 - accuracy50: 0.4524 - val_loss: 3.2422 - val_accuracy50: 0.4566 - 22s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 22s - loss: 3.0437 - accuracy50: 0.4590 - val_loss: 3.2334 - val_accuracy50: 0.4590 - 22s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 21s - loss: 3.0361 - accuracy50: 0.4623 - val_loss: 3.2440 - val_accuracy50: 0.4614 - 21s/epoch - 14ms/step
Epoch 8/50
1504/1504 - 22s - loss: 3.0273 - accuracy50: 0.4657 - val_loss: 3.2251 - val_accuracy50: 0.4707 - 22s/epoch - 15ms/step
Epoch 9/50
1504/1504 - 22s - loss: 3.0185 - accuracy50: 0.4688 - val_loss: 3.2330 - val_accuracy50: 0.4704 - 22s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 22s - loss: 3.0113 - accuracy50: 0.4722 - val_loss: 3.2411 - val_accuracy50: 0.4749 - 22s/epoch - 15ms/step
Epoch 11/50
1504/1504 - 22s - loss: 3.0047 - accuracy50: 0.4737 - val_loss: 3.2408 - val_accuracy50: 0.4781 - 22s/epoch - 15ms/step
Epoch 12/50
1504/1504 - 22s - loss: 2.9988 - accuracy50: 0.4772 - val_loss: 3.2680 - val_accuracy50: 0.4771 - 22s/epoch - 15ms/step
Epoch 13/50
1504/1504 - 22s - loss: 2.9908 - accuracy50: 0.4785 - val_loss: 3.2790 - val_accuracy50: 0.4794 - 22s/epoch - 15ms/step
Epoch 14/50
1504/1504 - 21s - loss: 2.9850 - accuracy50: 0.4815 - val_loss: 3.2773 - val_accuracy50: 0.4817 - 21s/epoch - 14ms/step
Epoch 15/50
1504/1504 - 22s - loss: 2.9791 - accuracy50: 0.4835 - val_loss: 3.2816 - val_accuracy50: 0.4825 - 22s/epoch - 14ms/step
Epoch 16/50
1504/1504 - 22s - loss: 2.9714 - accuracy50: 0.4864 - val_loss: 3.2952 - val_accuracy50: 0.4835 - 22s/epoch - 14ms/step
Epoch 17/50
1504/1504 - 21s - loss: 2.9659 - accuracy50: 0.4875 - val_loss: 3.3058 - val_accuracy50: 0.4808 - 21s/epoch - 14ms/step
Epoch 18/50
1504/1504 - 22s - loss: 2.9595 - accuracy50: 0.4901 - val_loss: 3.3401 - val_accuracy50: 0.4773 - 22s/epoch - 15ms/step
testing model: results/EXC/W6/deepOF_L1/h50
Evaluating performance on  test set...
4450/4450 - 25s - 25s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0663671
{'0': {'precision': 0.4413287552561066, 'recall': 0.4496724397811182, 'f1-score': 0.4454615307520129, 'support': 341006}, '1': {'precision': 0.42532388793158465, 'recall': 0.5795042249357075, 'f1-score': 0.49058537846658945, 'support': 460007}, '2': {'precision': 0.4683723158462854, 'recall': 0.22843926259157712, 'f1-score': 0.3070977284565194, 'support': 338103}, 'accuracy': 0.43643755333082845, 'macro avg': {'precision': 0.4450083196779922, 'recall': 0.41920530910280096, 'f1-score': 0.4143815458917072, 'support': 1139116}, 'weighted avg': {'precision': 0.442892387022204, 'recall': 0.43643755333082845, 'f1-score': 0.42261580579347136, 'support': 1139116}}
[[153341 164594  23071]
 [128835 266576  64596]
 [ 65277 195590  77236]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.015747
{'0': {'precision': 0.4275406342589564, 'recall': 0.44642996564647097, 'f1-score': 0.4367811701797522, 'support': 102464}, '1': {'precision': 0.5143000681810026, 'recall': 0.6369919331540701, 'f1-score': 0.5691084351702024, 'support': 179996}, '2': {'precision': 0.4964019602484925, 'recall': 0.26620293479747553, 'f1-score': 0.3465586426622745, 'support': 102358}, 'accuracy': 0.4876253189819603, 'macro avg': {'precision': 0.4794142208961505, 'recall': 0.4498749445326722, 'f1-score': 0.450816082670743, 'support': 384818}, 'weighted avg': {'precision': 0.4864382395525486, 'recall': 0.4876253189819603, 'f1-score': 0.47467799651736403, 'support': 384818}}
[[ 45743  50036   6685]
 [ 44382 114656  20958]
 [ 16866  58244  27248]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0298449
{'0': {'precision': 0.4115381323290251, 'recall': 0.4242602506029766, 'f1-score': 0.41780236650397556, 'support': 33998}, '1': {'precision': 0.5028420814419403, 'recall': 0.6154422666471153, 'f1-score': 0.5534733109642631, 'support': 61377}, '2': {'precision': 0.44889631778182, 'recall': 0.2598759107468124, 'f1-score': 0.32918146258809955, 'support': 35136}, 'accuracy': 0.46991441334446904, 'macro avg': {'precision': 0.4544255105175951, 'recall': 0.4331928093323015, 'f1-score': 0.4334857133521128, 'support': 130511}, 'weighted avg': {'precision': 0.46453427586307816, 'recall': 0.46991441334446904, 'f1-score': 0.4577475931756802, 'support': 130511}}
[[14424 17184  2390]
 [14783 37774  8820]
 [ 5842 20163  9131]]
training model: results/EXC/W6/deepOF_L1/h100
Epoch 1/50
1504/1504 - 24s - loss: 3.2465 - accuracy100: 0.4024 - val_loss: 3.3265 - val_accuracy100: 0.3617 - 24s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 22s - loss: 3.2101 - accuracy100: 0.4211 - val_loss: 3.2936 - val_accuracy100: 0.3761 - 22s/epoch - 15ms/step
Epoch 3/50
1504/1504 - 22s - loss: 3.1944 - accuracy100: 0.4270 - val_loss: 3.2873 - val_accuracy100: 0.3816 - 22s/epoch - 15ms/step
Epoch 4/50
1504/1504 - 22s - loss: 3.1837 - accuracy100: 0.4320 - val_loss: 3.3041 - val_accuracy100: 0.3853 - 22s/epoch - 15ms/step
Epoch 5/50
1504/1504 - 21s - loss: 3.1752 - accuracy100: 0.4361 - val_loss: 3.3036 - val_accuracy100: 0.3890 - 21s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 22s - loss: 3.1685 - accuracy100: 0.4392 - val_loss: 3.3080 - val_accuracy100: 0.3906 - 22s/epoch - 15ms/step
Epoch 7/50
1504/1504 - 23s - loss: 3.1609 - accuracy100: 0.4430 - val_loss: 3.3208 - val_accuracy100: 0.3897 - 23s/epoch - 15ms/step
Epoch 8/50
1504/1504 - 22s - loss: 3.1567 - accuracy100: 0.4446 - val_loss: 3.3253 - val_accuracy100: 0.3893 - 22s/epoch - 15ms/step
Epoch 9/50
1504/1504 - 22s - loss: 3.1512 - accuracy100: 0.4466 - val_loss: 3.3349 - val_accuracy100: 0.3885 - 22s/epoch - 15ms/step
Epoch 10/50
1504/1504 - 22s - loss: 3.1457 - accuracy100: 0.4498 - val_loss: 3.3452 - val_accuracy100: 0.3883 - 22s/epoch - 15ms/step
Epoch 11/50
1504/1504 - 22s - loss: 3.1410 - accuracy100: 0.4518 - val_loss: 3.3606 - val_accuracy100: 0.3875 - 22s/epoch - 15ms/step
Epoch 12/50
1504/1504 - 22s - loss: 3.1363 - accuracy100: 0.4536 - val_loss: 3.3524 - val_accuracy100: 0.3902 - 22s/epoch - 15ms/step
Epoch 13/50
1504/1504 - 22s - loss: 3.1318 - accuracy100: 0.4561 - val_loss: 3.3641 - val_accuracy100: 0.3894 - 22s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h100
Evaluating performance on  test set...
4450/4450 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1159979
{'0': {'precision': 0.4973602450735438, 'recall': 0.2807911018217322, 'f1-score': 0.3589387380070213, 'support': 407634}, '1': {'precision': 0.27950946339448046, 'recall': 0.6466137313286525, 'f1-score': 0.3903037049432836, 'support': 326436}, '2': {'precision': 0.47461770519088736, 'recall': 0.18022644341630334, 'f1-score': 0.2612489129540095, 'support': 405046}, 'accuracy': 0.34986603647038583, 'macro avg': {'precision': 0.4171624712196372, 'recall': 0.36921042552222944, 'f1-score': 0.33683045196810474, 'support': 1139116}, 'weighted avg': {'precision': 0.4268440618424267, 'recall': 0.34986603647038583, 'f1-score': 0.333190509967369, 'support': 1139116}}
[[114460 263483  29691]
 [ 64241 211078  51117]
 [ 51434 280612  73000]]
Evaluating performance on  train set...
1504/1504 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0899827
{'0': {'precision': 0.474397153775201, 'recall': 0.2793971565158006, 'f1-score': 0.35167475799283016, 'support': 128856}, '1': {'precision': 0.3445232692322586, 'recall': 0.7034623990891337, 'f1-score': 0.4625238165791985, 'support': 126473}, '2': {'precision': 0.5239297691852436, 'recall': 0.20509850257550835, 'f1-score': 0.2947957309120375, 'support': 129489}, 'accuracy': 0.39376796303707207, 'macro avg': {'precision': 0.4476167307309011, 'recall': 0.3959860193934808, 'f1-score': 0.3696647684946887, 'support': 384818}, 'weighted avg': {'precision': 0.448380670754738, 'recall': 0.39376796303707207, 'f1-score': 0.36896658074781824, 'support': 384818}}
[[36002 83114  9740]
 [23112 88969 14392]
 [16776 86155 26558]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968016
{'0': {'precision': 0.4483971213608113, 'recall': 0.2622127639224313, 'f1-score': 0.33091419346077827, 'support': 41821}, '1': {'precision': 0.3443568132326891, 'recall': 0.6867223184753505, 'f1-score': 0.45869905013827095, 'support': 44443}, '2': {'precision': 0.47974291288878684, 'recall': 0.18893936312066356, 'f1-score': 0.27110729168355685, 'support': 44247}, 'accuracy': 0.3819294925331964, 'macro avg': {'precision': 0.4241656158274291, 'recall': 0.37929148183948175, 'f1-score': 0.3535735117608687, 'support': 130511}, 'weighted avg': {'precision': 0.4235953331866359, 'recall': 0.3819294925331964, 'f1-score': 0.35415259024251383, 'support': 130511}}
[[10966 27677  3178]
 [ 8035 30520  5888]
 [ 5455 30432  8360]]
training model: results/EXC/W6/deepOF_L1/h200
Epoch 1/50
1504/1504 - 24s - loss: 3.2851 - accuracy200: 0.3742 - val_loss: 3.2826 - val_accuracy200: 0.3621 - 24s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 22s - loss: 3.2617 - accuracy200: 0.3855 - val_loss: 3.2733 - val_accuracy200: 0.3659 - 22s/epoch - 14ms/step
Epoch 3/50
1504/1504 - 21s - loss: 3.2547 - accuracy200: 0.3888 - val_loss: 3.2721 - val_accuracy200: 0.3669 - 21s/epoch - 14ms/step
Epoch 4/50
1504/1504 - 21s - loss: 3.2495 - accuracy200: 0.3933 - val_loss: 3.2722 - val_accuracy200: 0.3680 - 21s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 22s - loss: 3.2454 - accuracy200: 0.3950 - val_loss: 3.2765 - val_accuracy200: 0.3697 - 22s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 22s - loss: 3.2423 - accuracy200: 0.3970 - val_loss: 3.2763 - val_accuracy200: 0.3726 - 22s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 21s - loss: 3.2394 - accuracy200: 0.3986 - val_loss: 3.2795 - val_accuracy200: 0.3727 - 21s/epoch - 14ms/step
Epoch 8/50
1504/1504 - 22s - loss: 3.2367 - accuracy200: 0.4009 - val_loss: 3.2854 - val_accuracy200: 0.3716 - 22s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 21s - loss: 3.2343 - accuracy200: 0.4013 - val_loss: 3.2883 - val_accuracy200: 0.3724 - 21s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 21s - loss: 3.2326 - accuracy200: 0.4030 - val_loss: 3.2914 - val_accuracy200: 0.3726 - 21s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 22s - loss: 3.2301 - accuracy200: 0.4043 - val_loss: 3.2968 - val_accuracy200: 0.3732 - 22s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 21s - loss: 3.2281 - accuracy200: 0.4059 - val_loss: 3.3007 - val_accuracy200: 0.3730 - 21s/epoch - 14ms/step
Epoch 13/50
1504/1504 - 22s - loss: 3.2262 - accuracy200: 0.4074 - val_loss: 3.3035 - val_accuracy200: 0.3731 - 22s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h200
Evaluating performance on  test set...
4450/4450 - 29s - 29s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961157
{'0': {'precision': 0.42805426724187784, 'recall': 0.19458055561397236, 'f1-score': 0.2675437803842191, 'support': 380408}, '1': {'precision': 0.3266156614979971, 'recall': 0.6693843133501807, 'f1-score': 0.43901888719340226, 'support': 386609}, '2': {'precision': 0.3801306828639794, 'recall': 0.17760864716110497, 'f1-score': 0.24210053942174722, 'support': 372099}, 'accuracy': 0.3501820710094494, 'macro avg': {'precision': 0.3782668705346181, 'recall': 0.34719117204175265, 'f1-score': 0.3162210689997895, 'support': 1139116}, 'weighted avg': {'precision': 0.3779721019913962, 'recall': 0.3501820710094494, 'f1-score': 0.3174301967364577, 'support': 1139116}}
[[ 74020 266202  40186]
 [ 60237 258790  67582]
 [ 38665 267346  66088]]
Evaluating performance on  train set...
1504/1504 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990055
{'0': {'precision': 0.4304564973000866, 'recall': 0.18051208334299382, 'f1-score': 0.25435873980419704, 'support': 129393}, '1': {'precision': 0.3269163842842751, 'recall': 0.7107585459874478, 'f1-score': 0.4478447096963598, 'support': 125556}, '2': {'precision': 0.43381612309402245, 'recall': 0.1923476734247588, 'f1-score': 0.26652298467332797, 'support': 129869}, 'accuracy': 0.3575118627507029, 'macro avg': {'precision': 0.3970630015594614, 'recall': 0.36120610091840016, 'f1-score': 0.32290881139129496, 'support': 384818}, 'weighted avg': {'precision': 0.39780789149791373, 'recall': 0.3575118627507029, 'f1-score': 0.3215933357760319, 'support': 384818}}
[[23357 91943 14093]
 [17807 89240 18509]
 [13097 91792 24980]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918244
{'0': {'precision': 0.39388006265383757, 'recall': 0.17617034053093802, 'f1-score': 0.24345210310668536, 'support': 39967}, '1': {'precision': 0.3559162449311492, 'recall': 0.7078713850999085, 'f1-score': 0.47367147006891835, 'support': 46993}, '2': {'precision': 0.4017838514500313, 'recall': 0.17687309131822462, 'f1-score': 0.2456196291631459, 'support': 43551}, 'accuracy': 0.3678540506164231, 'macro avg': {'precision': 0.3838600530116727, 'recall': 0.3536382723163571, 'f1-score': 0.3209144007795832, 'support': 130511}, 'weighted avg': {'precision': 0.38284792145210544, 'recall': 0.3678540506164231, 'f1-score': 0.32707031642924916, 'support': 130511}}
[[ 7041 28579  4347]
 [ 6606 33265  7122]
 [ 4229 31619  7703]]
training model: results/EXC/W6/deepOF_L1/h300
Epoch 1/50
1504/1504 - 24s - loss: 3.3039 - accuracy300: 0.3571 - val_loss: 3.2803 - val_accuracy300: 0.3664 - 24s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 21s - loss: 3.2815 - accuracy300: 0.3673 - val_loss: 3.2745 - val_accuracy300: 0.3661 - 21s/epoch - 14ms/step
Epoch 3/50
1504/1504 - 21s - loss: 3.2738 - accuracy300: 0.3723 - val_loss: 3.2738 - val_accuracy300: 0.3676 - 21s/epoch - 14ms/step
Epoch 4/50
1504/1504 - 21s - loss: 3.2699 - accuracy300: 0.3758 - val_loss: 3.2718 - val_accuracy300: 0.3687 - 21s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 21s - loss: 3.2664 - accuracy300: 0.3779 - val_loss: 3.2742 - val_accuracy300: 0.3684 - 21s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 22s - loss: 3.2642 - accuracy300: 0.3799 - val_loss: 3.2726 - val_accuracy300: 0.3681 - 22s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 22s - loss: 3.2624 - accuracy300: 0.3812 - val_loss: 3.2732 - val_accuracy300: 0.3704 - 22s/epoch - 14ms/step
Epoch 8/50
1504/1504 - 21s - loss: 3.2602 - accuracy300: 0.3833 - val_loss: 3.2736 - val_accuracy300: 0.3705 - 21s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 21s - loss: 3.2585 - accuracy300: 0.3844 - val_loss: 3.2762 - val_accuracy300: 0.3696 - 21s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 21s - loss: 3.2568 - accuracy300: 0.3858 - val_loss: 3.2778 - val_accuracy300: 0.3692 - 21s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 22s - loss: 3.2546 - accuracy300: 0.3875 - val_loss: 3.2804 - val_accuracy300: 0.3698 - 22s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 21s - loss: 3.2529 - accuracy300: 0.3894 - val_loss: 3.2824 - val_accuracy300: 0.3702 - 21s/epoch - 14ms/step
Epoch 13/50
1504/1504 - 21s - loss: 3.2515 - accuracy300: 0.3899 - val_loss: 3.2859 - val_accuracy300: 0.3679 - 21s/epoch - 14ms/step
Epoch 14/50
1504/1504 - 21s - loss: 3.2495 - accuracy300: 0.3923 - val_loss: 3.2927 - val_accuracy300: 0.3657 - 21s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h300
Evaluating performance on  test set...
4450/4450 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957618
{'0': {'precision': 0.4059347904899692, 'recall': 0.3050031949369795, 'f1-score': 0.3483043825859437, 'support': 392809}, '1': {'precision': 0.32581968849043197, 'recall': 0.2247854727310781, 'f1-score': 0.2660328593358386, 'support': 363124}, '2': {'precision': 0.3724962212677331, 'recall': 0.5769018980487131, 'f1-score': 0.45269476038155465, 'support': 383183}, 'accuracy': 0.37089462355019154, 'macro avg': {'precision': 0.36808356674937803, 'recall': 0.36889685523892357, 'f1-score': 0.3556773341011123, 'support': 1139116}, 'weighted avg': {'precision': 0.36914766119956854, 'recall': 0.37089462355019154, 'f1-score': 0.35719360328531446, 'support': 1139116}}
[[119808  88258 184743]
 [ 93848  81625 187651]
 [ 81485  80639 221059]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935634
{'0': {'precision': 0.3941968530503328, 'recall': 0.2997644241609069, 'f1-score': 0.34055558009097736, 'support': 128621}, '1': {'precision': 0.33416173876382677, 'recall': 0.2369037880694689, 'f1-score': 0.2772507812895535, 'support': 127136}, '2': {'precision': 0.3762520571324082, 'recall': 0.5739534018797313, 'f1-score': 0.45453569248044867, 'support': 129061}, 'accuracy': 0.37095458112666246, 'macro avg': {'precision': 0.3682035496488559, 'recall': 0.37020720470336904, 'f1-score': 0.3574473512869932, 'support': 384818}, 'weighted avg': {'precision': 0.36834411852156207, 'recall': 0.37095458112666246, 'f1-score': 0.3578678377937868, 'support': 384818}}
[[38556 31266 58799]
 [33015 30119 64002]
 [26238 28748 74075]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0907968
{'0': {'precision': 0.3620577382244411, 'recall': 0.2937654103557591, 'f1-score': 0.32435585804569766, 'support': 39746}, '1': {'precision': 0.35660773149535513, 'recall': 0.23171787105149286, 'f1-score': 0.2809069807089557, 'support': 46220}, '2': {'precision': 0.37632091925720734, 'recall': 0.5764058816926704, 'f1-score': 0.4553531842445954, 'support': 44545}, 'accuracy': 0.368260146654305, 'macro avg': {'precision': 0.3649954629923345, 'recall': 0.36729638769997414, 'f1-score': 0.3535386743330829, 'support': 130511}, 'weighted avg': {'precision': 0.36499583607126024, 'recall': 0.368260146654305, 'f1-score': 0.35367958390042015, 'support': 130511}}
[[11676  9457 18613]
 [11570 10710 23940]
 [ 9003  9866 25676]]
training model: results/EXC/W6/deepOF_L1/h500
Epoch 1/50
1504/1504 - 23s - loss: 3.2823 - accuracy500: 0.3857 - val_loss: 3.3455 - val_accuracy500: 0.3001 - 23s/epoch - 15ms/step
Epoch 2/50
1504/1504 - 21s - loss: 3.2696 - accuracy500: 0.3870 - val_loss: 3.3127 - val_accuracy500: 0.2953 - 21s/epoch - 14ms/step
Epoch 3/50
1504/1504 - 25s - loss: 3.2713 - accuracy500: 0.3833 - val_loss: 3.2925 - val_accuracy500: 0.2971 - 25s/epoch - 17ms/step
Epoch 4/50
1504/1504 - 22s - loss: 3.2715 - accuracy500: 0.3820 - val_loss: 3.2877 - val_accuracy500: 0.2991 - 22s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 21s - loss: 3.2705 - accuracy500: 0.3820 - val_loss: 3.2848 - val_accuracy500: 0.2998 - 21s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 27s - loss: 3.2696 - accuracy500: 0.3823 - val_loss: 3.2843 - val_accuracy500: 0.2997 - 27s/epoch - 18ms/step
Epoch 7/50
1504/1504 - 22s - loss: 3.2688 - accuracy500: 0.3823 - val_loss: 3.2820 - val_accuracy500: 0.3022 - 22s/epoch - 15ms/step
Epoch 8/50
1504/1504 - 21s - loss: 3.2680 - accuracy500: 0.3828 - val_loss: 3.2803 - val_accuracy500: 0.3030 - 21s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 21s - loss: 3.2671 - accuracy500: 0.3835 - val_loss: 3.2822 - val_accuracy500: 0.3010 - 21s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 21s - loss: 3.2661 - accuracy500: 0.3841 - val_loss: 3.2815 - val_accuracy500: 0.3035 - 21s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 21s - loss: 3.2655 - accuracy500: 0.3847 - val_loss: 3.2808 - val_accuracy500: 0.3033 - 21s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 21s - loss: 3.2644 - accuracy500: 0.3854 - val_loss: 3.2814 - val_accuracy500: 0.3039 - 21s/epoch - 14ms/step
Epoch 13/50
1504/1504 - 21s - loss: 3.2640 - accuracy500: 0.3856 - val_loss: 3.2816 - val_accuracy500: 0.3051 - 21s/epoch - 14ms/step
Epoch 14/50
1504/1504 - 21s - loss: 3.2625 - accuracy500: 0.3869 - val_loss: 3.2802 - val_accuracy500: 0.3063 - 21s/epoch - 14ms/step
Epoch 15/50
1504/1504 - 22s - loss: 3.2620 - accuracy500: 0.3871 - val_loss: 3.2840 - val_accuracy500: 0.3051 - 22s/epoch - 14ms/step
Epoch 16/50
1504/1504 - 21s - loss: 3.2605 - accuracy500: 0.3878 - val_loss: 3.2849 - val_accuracy500: 0.3066 - 21s/epoch - 14ms/step
Epoch 17/50
1504/1504 - 21s - loss: 3.2590 - accuracy500: 0.3895 - val_loss: 3.2816 - val_accuracy500: 0.3088 - 21s/epoch - 14ms/step
Epoch 18/50
1504/1504 - 21s - loss: 3.2580 - accuracy500: 0.3899 - val_loss: 3.2858 - val_accuracy500: 0.3086 - 21s/epoch - 14ms/step
Epoch 19/50
1504/1504 - 21s - loss: 3.2566 - accuracy500: 0.3909 - val_loss: 3.2838 - val_accuracy500: 0.3094 - 21s/epoch - 14ms/step
Epoch 20/50
1504/1504 - 21s - loss: 3.2548 - accuracy500: 0.3924 - val_loss: 3.2910 - val_accuracy500: 0.3084 - 21s/epoch - 14ms/step
Epoch 21/50
1504/1504 - 21s - loss: 3.2540 - accuracy500: 0.3936 - val_loss: 3.2888 - val_accuracy500: 0.3112 - 21s/epoch - 14ms/step
Epoch 22/50
1504/1504 - 21s - loss: 3.2523 - accuracy500: 0.3941 - val_loss: 3.2866 - val_accuracy500: 0.3111 - 21s/epoch - 14ms/step
Epoch 23/50
1504/1504 - 22s - loss: 3.2504 - accuracy500: 0.3956 - val_loss: 3.2915 - val_accuracy500: 0.3145 - 22s/epoch - 14ms/step
Epoch 24/50
1504/1504 - 21s - loss: 3.2488 - accuracy500: 0.3966 - val_loss: 3.3077 - val_accuracy500: 0.3078 - 21s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h500
Evaluating performance on  test set...
4450/4450 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954508
{'0': {'precision': 0.2676027592962978, 'recall': 0.3547759831739355, 'f1-score': 0.30508443027018306, 'support': 277189}, '1': {'precision': 0.5222593074336761, 'recall': 0.07274974232222797, 'f1-score': 0.12770975519371308, 'support': 585033}, '2': {'precision': 0.26111192415418966, 'recall': 0.6508013897014742, 'f1-score': 0.372693326273925, 'support': 276894}, 'accuracy': 0.28188876286523934, 'macro avg': {'precision': 0.35032466362805453, 'recall': 0.3594423717325459, 'f1-score': 0.26849583724594034, 'support': 1139116}, 'weighted avg': {'precision': 0.39681278796819414, 'recall': 0.28188876286523934, 'f1-score': 0.23042167368178265, 'support': 1139116}}
[[ 98340  20211 158638]
 [191176  42561 351296]
 [ 77969  18722 180203]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971755
{'0': {'precision': 0.38164642152288625, 'recall': 0.3606645648645274, 'f1-score': 0.3708589609337073, 'support': 128144}, '1': {'precision': 0.3371410822749862, 'recall': 0.07651278998731183, 'f1-score': 0.12472072210093582, 'support': 127678}, '2': {'precision': 0.3626774813306467, 'recall': 0.6599894570374275, 'f1-score': 0.46811587429448037, 'support': 128996}, 'accuracy': 0.36672400979164177, 'macro avg': {'precision': 0.36048832837617306, 'recall': 0.3657222706297556, 'f1-score': 0.32123185244304114, 'support': 384818}, 'weighted avg': {'precision': 0.36052144786382784, 'recall': 0.36672400979164177, 'f1-score': 0.3217950261338687, 'support': 384818}}
[[46217  9838 72089]
 [40391  9769 77518]
 [34491  9369 85136]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0918958
{'0': {'precision': 0.27875085549162254, 'recall': 0.3436669895934248, 'f1-score': 0.3078236529041288, 'support': 31999}, '1': {'precision': 0.4844363856149894, 'recall': 0.07723564178337403, 'f1-score': 0.13322990400465434, 'support': 62264}, '2': {'precision': 0.2979182330247865, 'recall': 0.6668229971308762, 'f1-score': 0.4118383724793621, 'support': 36248}, 'accuracy': 0.3063113454038357, 'macro avg': {'precision': 0.3537018247104662, 'recall': 0.36257520950255834, 'f1-score': 0.2842973097960484, 'support': 130511}, 'weighted avg': {'precision': 0.38220254116120933, 'recall': 0.3063113454038357, 'f1-score': 0.2534176670001527, 'support': 130511}}
[[10997  2496 18506]
 [18999  4809 38456]
 [ 9455  2622 24171]]
training model: results/EXC/W6/deepOF_L1/h1000
Epoch 1/50
1504/1504 - 23s - loss: 3.2867 - accuracy1000: 0.3797 - val_loss: 3.2824 - val_accuracy1000: 0.4023 - 23s/epoch - 16ms/step
Epoch 2/50
1504/1504 - 21s - loss: 3.2726 - accuracy1000: 0.3767 - val_loss: 3.2613 - val_accuracy1000: 0.4024 - 21s/epoch - 14ms/step
Epoch 3/50
1504/1504 - 21s - loss: 3.2700 - accuracy1000: 0.3784 - val_loss: 3.2569 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 4/50
1504/1504 - 21s - loss: 3.2695 - accuracy1000: 0.3789 - val_loss: 3.2559 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 5/50
1504/1504 - 21s - loss: 3.2698 - accuracy1000: 0.3788 - val_loss: 3.2560 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 6/50
1504/1504 - 22s - loss: 3.2696 - accuracy1000: 0.3790 - val_loss: 3.2552 - val_accuracy1000: 0.4027 - 22s/epoch - 14ms/step
Epoch 7/50
1504/1504 - 21s - loss: 3.2693 - accuracy1000: 0.3800 - val_loss: 3.2547 - val_accuracy1000: 0.4027 - 21s/epoch - 14ms/step
Epoch 8/50
1504/1504 - 21s - loss: 3.2688 - accuracy1000: 0.3802 - val_loss: 3.2549 - val_accuracy1000: 0.4027 - 21s/epoch - 14ms/step
Epoch 9/50
1504/1504 - 21s - loss: 3.2671 - accuracy1000: 0.3798 - val_loss: 3.2552 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 10/50
1504/1504 - 21s - loss: 3.2669 - accuracy1000: 0.3810 - val_loss: 3.2542 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 11/50
1504/1504 - 21s - loss: 3.2661 - accuracy1000: 0.3809 - val_loss: 3.2555 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 12/50
1504/1504 - 21s - loss: 3.2656 - accuracy1000: 0.3819 - val_loss: 3.2560 - val_accuracy1000: 0.4026 - 21s/epoch - 14ms/step
Epoch 13/50
1504/1504 - 21s - loss: 3.2658 - accuracy1000: 0.3813 - val_loss: 3.2567 - val_accuracy1000: 0.4025 - 21s/epoch - 14ms/step
Epoch 14/50
1504/1504 - 21s - loss: 3.2649 - accuracy1000: 0.3818 - val_loss: 3.2592 - val_accuracy1000: 0.4025 - 21s/epoch - 14ms/step
Epoch 15/50
1504/1504 - 21s - loss: 3.2641 - accuracy1000: 0.3819 - val_loss: 3.2606 - val_accuracy1000: 0.4024 - 21s/epoch - 14ms/step
Epoch 16/50
1504/1504 - 21s - loss: 3.2640 - accuracy1000: 0.3827 - val_loss: 3.2615 - val_accuracy1000: 0.4024 - 21s/epoch - 14ms/step
Epoch 17/50
1504/1504 - 21s - loss: 3.2631 - accuracy1000: 0.3832 - val_loss: 3.2622 - val_accuracy1000: 0.4023 - 21s/epoch - 14ms/step
Epoch 18/50
1504/1504 - 21s - loss: 3.2629 - accuracy1000: 0.3822 - val_loss: 3.2632 - val_accuracy1000: 0.4022 - 21s/epoch - 14ms/step
Epoch 19/50
1504/1504 - 21s - loss: 3.2624 - accuracy1000: 0.3834 - val_loss: 3.2634 - val_accuracy1000: 0.4021 - 21s/epoch - 14ms/step
Epoch 20/50
1504/1504 - 21s - loss: 3.2622 - accuracy1000: 0.3829 - val_loss: 3.2633 - val_accuracy1000: 0.4021 - 21s/epoch - 14ms/step
testing model: results/EXC/W6/deepOF_L1/h1000
Evaluating performance on  test set...
4450/4450 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0887325
{'0': {'precision': 0.3617021276595745, 'recall': 0.0002993309073834957, 'f1-score': 0.0005981667947056375, 'support': 340760}, '1': {'precision': 0.4061151208648774, 'recall': 0.9996368603987619, 'f1-score': 0.5775807536360759, 'support': 462632}, '2': {'precision': 0.30120481927710846, 'recall': 7.446593034754739e-05, 'f1-score': 0.00014889504983517317, 'support': 335724}, 'accuracy': 0.40609648183328123, 'macro avg': {'precision': 0.35634068926718676, 'recall': 0.3333368857454977, 'f1-score': 0.19277593849353888, 'support': 1139116}, 'weighted avg': {'precision': 0.3619097215421647, 'recall': 0.40609648183328123, 'f1-score': 0.23479712178113538, 'support': 1139116}}
[[   102 340635     23]
 [   133 462464     35]
 [    47 335652     25]]
Evaluating performance on  train set...
1504/1504 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1194448
{'0': {'precision': 0.5714285714285714, 'recall': 0.00018878313537324, 'f1-score': 0.00037744157518950714, 'support': 127130}, '1': {'precision': 0.3314672010354695, 'recall': 0.9999529555665326, 'f1-score': 0.49789182731723314, 'support': 127539}, '2': {'precision': 0.4782608695652174, 'recall': 8.451851339618438e-05, 'f1-score': 0.00016900715975785884, 'support': 130149}, 'accuracy': 0.3315021646596573, 'macro avg': {'precision': 0.4603855473430862, 'recall': 0.33340875240510065, 'f1-score': 0.1661460920173935, 'support': 384818}, 'weighted avg': {'precision': 0.46038876443310994, 'recall': 0.3315021646596573, 'f1-score': 0.1651965501211008, 'support': 384818}}
[[    24 127094     12]
 [     6 127533      0]
 [    12 130126     11]]
Evaluating performance on  val set...
510/510 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.085438
{'0': {'precision': 0.2857142857142857, 'recall': 0.0002905540866432286, 'f1-score': 0.0005805178218971322, 'support': 34417}, '1': {'precision': 0.40269804162035794, 'recall': 0.9996955512425315, 'f1-score': 0.5741261836202798, 'support': 52554}, '2': {'precision': 0.2727272727272727, 'recall': 6.890215893431327e-05, 'f1-score': 0.00013776951160708137, 'support': 43540}, 'accuracy': 0.4026557148439595, 'macro avg': {'precision': 0.32037986668730545, 'recall': 0.33335166916270303, 'f1-score': 0.19161482365126134, 'support': 130511}, 'weighted avg': {'precision': 0.32848853280788837, 'recall': 0.4026557148439595, 'f1-score': 0.2313874356980775, 'support': 130511}}
[[   10 34402     5]
 [   13 52538     3]
 [   12 43525     3]]
training model: results/EXC/W6/deepLOB_L2/h10
Epoch 1/50
1504/1504 - 63s - loss: 2.7547 - accuracy10: 0.4531 - val_loss: 2.7053 - val_accuracy10: 0.6229 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 60s - loss: 2.4682 - accuracy10: 0.5407 - val_loss: 2.5131 - val_accuracy10: 0.6217 - 60s/epoch - 40ms/step
Epoch 3/50
1504/1504 - 60s - loss: 2.3211 - accuracy10: 0.5980 - val_loss: 2.4177 - val_accuracy10: 0.6583 - 60s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 2.2166 - accuracy10: 0.6266 - val_loss: 2.3455 - val_accuracy10: 0.6658 - 61s/epoch - 41ms/step
Epoch 5/50
1504/1504 - 61s - loss: 2.1682 - accuracy10: 0.6399 - val_loss: 2.3352 - val_accuracy10: 0.6833 - 61s/epoch - 40ms/step
Epoch 6/50
1504/1504 - 60s - loss: 2.1416 - accuracy10: 0.6470 - val_loss: 2.3058 - val_accuracy10: 0.6802 - 60s/epoch - 40ms/step
Epoch 7/50
1504/1504 - 61s - loss: 2.1238 - accuracy10: 0.6505 - val_loss: 2.2841 - val_accuracy10: 0.6888 - 61s/epoch - 40ms/step
Epoch 8/50
1504/1504 - 61s - loss: 2.1065 - accuracy10: 0.6525 - val_loss: 2.2752 - val_accuracy10: 0.6809 - 61s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 61s - loss: 2.0918 - accuracy10: 0.6536 - val_loss: 2.2778 - val_accuracy10: 0.6825 - 61s/epoch - 40ms/step
Epoch 10/50
1504/1504 - 61s - loss: 2.0787 - accuracy10: 0.6559 - val_loss: 2.2744 - val_accuracy10: 0.6791 - 61s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 61s - loss: 2.0664 - accuracy10: 0.6562 - val_loss: 2.2495 - val_accuracy10: 0.6810 - 61s/epoch - 40ms/step
Epoch 12/50
1504/1504 - 61s - loss: 2.0516 - accuracy10: 0.6583 - val_loss: 2.2416 - val_accuracy10: 0.6739 - 61s/epoch - 40ms/step
Epoch 13/50
1504/1504 - 60s - loss: 2.0415 - accuracy10: 0.6591 - val_loss: 2.2353 - val_accuracy10: 0.6841 - 60s/epoch - 40ms/step
Epoch 14/50
1504/1504 - 61s - loss: 2.0314 - accuracy10: 0.6607 - val_loss: 2.2232 - val_accuracy10: 0.6725 - 61s/epoch - 41ms/step
Epoch 15/50
1504/1504 - 61s - loss: 2.0227 - accuracy10: 0.6613 - val_loss: 2.2363 - val_accuracy10: 0.6782 - 61s/epoch - 41ms/step
Epoch 16/50
1504/1504 - 60s - loss: 2.0118 - accuracy10: 0.6631 - val_loss: 2.2259 - val_accuracy10: 0.6763 - 60s/epoch - 40ms/step
Epoch 17/50
1504/1504 - 60s - loss: 2.0030 - accuracy10: 0.6638 - val_loss: 2.2303 - val_accuracy10: 0.6848 - 60s/epoch - 40ms/step
Epoch 18/50
1504/1504 - 60s - loss: 1.9958 - accuracy10: 0.6640 - val_loss: 2.2230 - val_accuracy10: 0.6790 - 60s/epoch - 40ms/step
Epoch 19/50
1504/1504 - 60s - loss: 1.9865 - accuracy10: 0.6655 - val_loss: 2.2154 - val_accuracy10: 0.6762 - 60s/epoch - 40ms/step
Epoch 20/50
1504/1504 - 60s - loss: 1.9800 - accuracy10: 0.6657 - val_loss: 2.2240 - val_accuracy10: 0.6846 - 60s/epoch - 40ms/step
Epoch 21/50
1504/1504 - 60s - loss: 1.9724 - accuracy10: 0.6670 - val_loss: 2.2259 - val_accuracy10: 0.6761 - 60s/epoch - 40ms/step
Epoch 22/50
1504/1504 - 60s - loss: 1.9655 - accuracy10: 0.6672 - val_loss: 2.2306 - val_accuracy10: 0.6824 - 60s/epoch - 40ms/step
Epoch 23/50
1504/1504 - 60s - loss: 1.9587 - accuracy10: 0.6676 - val_loss: 2.2302 - val_accuracy10: 0.6800 - 60s/epoch - 40ms/step
Epoch 24/50
1504/1504 - 60s - loss: 1.9527 - accuracy10: 0.6682 - val_loss: 2.2330 - val_accuracy10: 0.6807 - 60s/epoch - 40ms/step
Epoch 25/50
1504/1504 - 60s - loss: 1.9463 - accuracy10: 0.6695 - val_loss: 2.2243 - val_accuracy10: 0.6859 - 60s/epoch - 40ms/step
Epoch 26/50
1504/1504 - 60s - loss: 1.9388 - accuracy10: 0.6697 - val_loss: 2.2521 - val_accuracy10: 0.6789 - 60s/epoch - 40ms/step
Epoch 27/50
1504/1504 - 60s - loss: 1.9338 - accuracy10: 0.6702 - val_loss: 2.2549 - val_accuracy10: 0.6793 - 60s/epoch - 40ms/step
Epoch 28/50
1504/1504 - 60s - loss: 1.9288 - accuracy10: 0.6707 - val_loss: 2.2607 - val_accuracy10: 0.6759 - 60s/epoch - 40ms/step
Epoch 29/50
1504/1504 - 60s - loss: 1.9217 - accuracy10: 0.6719 - val_loss: 2.2611 - val_accuracy10: 0.6768 - 60s/epoch - 40ms/step
testing model: results/EXC/W6/deepLOB_L2/h10
Evaluating performance on  test set...
4450/4450 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90802985
{'0': {'precision': 0.3324525255326947, 'recall': 0.6980878934586924, 'f1-score': 0.4504065613482369, 'support': 192301}, '1': {'precision': 0.881727892287234, 'recall': 0.5613290158044837, 'f1-score': 0.6859597112347527, 'support': 755988}, '2': {'precision': 0.40479048987384125, 'recall': 0.5388771275257819, 'f1-score': 0.46230755916803973, 'support': 190832}, 'accuracy': 0.5806547329037038, 'macro avg': {'precision': 0.5396569692312566, 'recall': 0.5994313455963193, 'f1-score': 0.5328912772503431, 'support': 1139121}, 'weighted avg': {'precision': 0.7091025779618751, 'recall': 0.5806547329037038, 'f1-score': 0.6087272716962648, 'support': 1139121}}
[[134243  18307  39751]
 [220171 424358 111459]
 [ 49382  38615 102835]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7701214
{'0': {'precision': 0.33402769809255645, 'recall': 0.7164656657642137, 'f1-score': 0.455632344442304, 'support': 52819}, '1': {'precision': 0.9189667959683486, 'recall': 0.6180783337041635, 'f1-score': 0.7390719439742013, 'support': 278654}, '2': {'precision': 0.40825595358403977, 'recall': 0.6436846249015858, 'f1-score': 0.4996253319268123, 'support': 53346}, 'accuracy': 0.6351323609281246, 'macro avg': {'precision': 0.5537501492149816, 'recall': 0.6594095414566543, 'f1-score': 0.5647765401144392, 'support': 384819}, 'weighted avg': {'precision': 0.7678820553278531, 'recall': 0.6351323609281246, 'f1-score': 0.666974372976004, 'support': 384819}}
[[ 37843   5252   9724]
 [ 66377 172230  40047]
 [  9073   9935  34338]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.701483
{'0': {'precision': 0.36792452830188677, 'recall': 0.6737556303095957, 'f1-score': 0.4759449825805022, 'support': 17539}, '1': {'precision': 0.9048091361188026, 'recall': 0.6912625242064494, 'f1-score': 0.7837500820371464, 'support': 95016}, '2': {'precision': 0.4152391287497093, 'recall': 0.596680775228336, 'f1-score': 0.48969331322272497, 'support': 17956}, 'accuracy': 0.6758970508233022, 'macro avg': {'precision': 0.5626575977234662, 'recall': 0.6538996432481271, 'f1-score': 0.5831294592801245, 'support': 130511}, 'weighted avg': {'precision': 0.7653025949933777, 'recall': 0.6758970508233022, 'f1-score': 0.7019280365375191, 'support': 130511}}
[[11817  2580  3142]
 [17389 65681 11946]
 [ 2912  4330 10714]]
training model: results/EXC/W6/deepLOB_L2/h20
Epoch 1/50
1504/1504 - 63s - loss: 2.8275 - accuracy20: 0.4656 - val_loss: 2.8658 - val_accuracy20: 0.6166 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 61s - loss: 2.5736 - accuracy20: 0.5408 - val_loss: 2.6591 - val_accuracy20: 0.6271 - 61s/epoch - 40ms/step
Epoch 3/50
1504/1504 - 60s - loss: 2.4249 - accuracy20: 0.5932 - val_loss: 2.5481 - val_accuracy20: 0.6567 - 60s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 60s - loss: 2.3299 - accuracy20: 0.6157 - val_loss: 2.4499 - val_accuracy20: 0.6612 - 60s/epoch - 40ms/step
Epoch 5/50
1504/1504 - 60s - loss: 2.2809 - accuracy20: 0.6263 - val_loss: 2.4386 - val_accuracy20: 0.6657 - 60s/epoch - 40ms/step
Epoch 6/50
1504/1504 - 60s - loss: 2.2501 - accuracy20: 0.6310 - val_loss: 2.4102 - val_accuracy20: 0.6606 - 60s/epoch - 40ms/step
Epoch 7/50
1504/1504 - 60s - loss: 2.2276 - accuracy20: 0.6339 - val_loss: 2.4068 - val_accuracy20: 0.6706 - 60s/epoch - 40ms/step
Epoch 8/50
1504/1504 - 61s - loss: 2.2076 - accuracy20: 0.6372 - val_loss: 2.3751 - val_accuracy20: 0.6633 - 61s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 61s - loss: 2.1951 - accuracy20: 0.6391 - val_loss: 2.3623 - val_accuracy20: 0.6639 - 61s/epoch - 41ms/step
Epoch 10/50
1504/1504 - 60s - loss: 2.1822 - accuracy20: 0.6401 - val_loss: 2.3647 - val_accuracy20: 0.6671 - 60s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 61s - loss: 2.1711 - accuracy20: 0.6422 - val_loss: 2.3738 - val_accuracy20: 0.6643 - 61s/epoch - 40ms/step
Epoch 12/50
1504/1504 - 60s - loss: 2.1622 - accuracy20: 0.6429 - val_loss: 2.3669 - val_accuracy20: 0.6647 - 60s/epoch - 40ms/step
Epoch 13/50
1504/1504 - 61s - loss: 2.1548 - accuracy20: 0.6442 - val_loss: 2.3654 - val_accuracy20: 0.6617 - 61s/epoch - 40ms/step
Epoch 14/50
1504/1504 - 60s - loss: 2.1482 - accuracy20: 0.6445 - val_loss: 2.3644 - val_accuracy20: 0.6630 - 60s/epoch - 40ms/step
Epoch 15/50
1504/1504 - 60s - loss: 2.1400 - accuracy20: 0.6460 - val_loss: 2.3583 - val_accuracy20: 0.6616 - 60s/epoch - 40ms/step
Epoch 16/50
1504/1504 - 61s - loss: 2.1323 - accuracy20: 0.6467 - val_loss: 2.3544 - val_accuracy20: 0.6598 - 61s/epoch - 40ms/step
Epoch 17/50
1504/1504 - 61s - loss: 2.1264 - accuracy20: 0.6475 - val_loss: 2.3640 - val_accuracy20: 0.6639 - 61s/epoch - 41ms/step
Epoch 18/50
1504/1504 - 60s - loss: 2.1208 - accuracy20: 0.6478 - val_loss: 2.3547 - val_accuracy20: 0.6599 - 60s/epoch - 40ms/step
Epoch 19/50
1504/1504 - 61s - loss: 2.1141 - accuracy20: 0.6491 - val_loss: 2.3706 - val_accuracy20: 0.6554 - 61s/epoch - 40ms/step
Epoch 20/50
1504/1504 - 60s - loss: 2.1084 - accuracy20: 0.6501 - val_loss: 2.3799 - val_accuracy20: 0.6592 - 60s/epoch - 40ms/step
Epoch 21/50
1504/1504 - 61s - loss: 2.1030 - accuracy20: 0.6503 - val_loss: 2.3779 - val_accuracy20: 0.6525 - 61s/epoch - 40ms/step
Epoch 22/50
1504/1504 - 60s - loss: 2.0978 - accuracy20: 0.6511 - val_loss: 2.3746 - val_accuracy20: 0.6521 - 60s/epoch - 40ms/step
Epoch 23/50
1504/1504 - 60s - loss: 2.0900 - accuracy20: 0.6518 - val_loss: 2.3906 - val_accuracy20: 0.6589 - 60s/epoch - 40ms/step
Epoch 24/50
1504/1504 - 60s - loss: 2.0853 - accuracy20: 0.6533 - val_loss: 2.3846 - val_accuracy20: 0.6577 - 60s/epoch - 40ms/step
Epoch 25/50
1504/1504 - 60s - loss: 2.0811 - accuracy20: 0.6534 - val_loss: 2.3961 - val_accuracy20: 0.6577 - 60s/epoch - 40ms/step
Epoch 26/50
1504/1504 - 61s - loss: 2.0741 - accuracy20: 0.6541 - val_loss: 2.4055 - val_accuracy20: 0.6488 - 61s/epoch - 40ms/step
testing model: results/EXC/W6/deepLOB_L2/h20
Evaluating performance on  test set...
4450/4450 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81890374
{'0': {'precision': 0.4082717495760633, 'recall': 0.7362312869111386, 'f1-score': 0.5252628014381129, 'support': 247554}, '1': {'precision': 0.796403429147756, 'recall': 0.6104291063813997, 'f1-score': 0.6911239558315886, 'support': 646786}, '2': {'precision': 0.5310367587327376, 'recall': 0.4272921509430879, 'f1-score': 0.47354898005845053, 'support': 244781}, 'accuracy': 0.5984149181693604, 'macro avg': {'precision': 0.5785706458188523, 'recall': 0.5913175147452088, 'f1-score': 0.5633119124427174, 'support': 1139121}, 'weighted avg': {'precision': 0.655031029942097, 'recall': 0.5984149181693604, 'f1-score': 0.6083251905033689, 'support': 1139121}}
[[182257  36136  29161]
 [188763 394817  63206]
 [ 75391  64797 104593]]
Evaluating performance on  train set...
1504/1504 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7654967
{'0': {'precision': 0.40645912132673845, 'recall': 0.716828917173848, 'f1-score': 0.5187656982531423, 'support': 70159}, '1': {'precision': 0.8476132792037716, 'recall': 0.6363193209841143, 'f1-score': 0.7269234548951523, 'support': 244118}, '2': {'precision': 0.4972437454223045, 'recall': 0.5485668112613762, 'f1-score': 0.521645940754221, 'support': 70542}, 'accuracy': 0.634911477863619, 'macro avg': {'precision': 0.5837720486509381, 'recall': 0.6339050164731128, 'f1-score': 0.5891116979675052, 'support': 384819}, 'weighted avg': {'precision': 0.7029564347794915, 'recall': 0.634911477863619, 'f1-score': 0.6513429184591231, 'support': 384819}}
[[ 50292  10794   9073]
 [ 58728 155337  30053]
 [ 14712  17133  38697]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7303132
{'0': {'precision': 0.42978904751757935, 'recall': 0.687897003026815, 'f1-score': 0.5290405075326633, 'support': 23457}, '1': {'precision': 0.8291685016550411, 'recall': 0.7025868814175484, 'f1-score': 0.7606474482614815, 'support': 83073}, '2': {'precision': 0.5182937632884479, 'recall': 0.48792794295483927, 'f1-score': 0.5026526623278991, 'support': 23981}, 'accuracy': 0.6605037123307614, 'macro avg': {'precision': 0.5924171041536894, 'recall': 0.6261372757997342, 'f1-score': 0.597446872707348, 'support': 130511}, 'weighted avg': {'precision': 0.7002649536286547, 'recall': 0.6605037123307614, 'f1-score': 0.6716145164001891, 'support': 130511}}
[[16136  4600  2721]
 [16553 58366  8154]
 [ 4855  7425 11701]]
training model: results/EXC/W6/deepLOB_L2/h30
Epoch 1/50
1504/1504 - 62s - loss: 2.8741 - accuracy30: 0.4700 - val_loss: 2.9198 - val_accuracy30: 0.5796 - 62s/epoch - 41ms/step
Epoch 2/50
1504/1504 - 61s - loss: 2.6901 - accuracy30: 0.5254 - val_loss: 2.8282 - val_accuracy30: 0.5975 - 61s/epoch - 40ms/step
Epoch 3/50
1504/1504 - 60s - loss: 2.5865 - accuracy30: 0.5632 - val_loss: 2.7357 - val_accuracy30: 0.6195 - 60s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 2.4989 - accuracy30: 0.5876 - val_loss: 2.6385 - val_accuracy30: 0.6364 - 61s/epoch - 40ms/step
Epoch 5/50
1504/1504 - 61s - loss: 2.4395 - accuracy30: 0.6031 - val_loss: 2.5609 - val_accuracy30: 0.6410 - 61s/epoch - 40ms/step
Epoch 6/50
1504/1504 - 60s - loss: 2.4064 - accuracy30: 0.6101 - val_loss: 2.5419 - val_accuracy30: 0.6358 - 60s/epoch - 40ms/step
Epoch 7/50
1504/1504 - 60s - loss: 2.3801 - accuracy30: 0.6144 - val_loss: 2.5121 - val_accuracy30: 0.6434 - 60s/epoch - 40ms/step
Epoch 8/50
1504/1504 - 60s - loss: 2.3599 - accuracy30: 0.6167 - val_loss: 2.5075 - val_accuracy30: 0.6417 - 60s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 61s - loss: 2.3421 - accuracy30: 0.6190 - val_loss: 2.4939 - val_accuracy30: 0.6455 - 61s/epoch - 40ms/step
Epoch 10/50
1504/1504 - 60s - loss: 2.3296 - accuracy30: 0.6205 - val_loss: 2.4859 - val_accuracy30: 0.6454 - 60s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 61s - loss: 2.3185 - accuracy30: 0.6216 - val_loss: 2.4736 - val_accuracy30: 0.6441 - 61s/epoch - 40ms/step
Epoch 12/50
1504/1504 - 61s - loss: 2.3095 - accuracy30: 0.6234 - val_loss: 2.4639 - val_accuracy30: 0.6477 - 61s/epoch - 41ms/step
Epoch 13/50
1504/1504 - 61s - loss: 2.3010 - accuracy30: 0.6239 - val_loss: 2.4685 - val_accuracy30: 0.6467 - 61s/epoch - 40ms/step
Epoch 14/50
1504/1504 - 61s - loss: 2.2915 - accuracy30: 0.6254 - val_loss: 2.4637 - val_accuracy30: 0.6430 - 61s/epoch - 40ms/step
Epoch 15/50
1504/1504 - 61s - loss: 2.2865 - accuracy30: 0.6261 - val_loss: 2.4660 - val_accuracy30: 0.6448 - 61s/epoch - 40ms/step
Epoch 16/50
1504/1504 - 61s - loss: 2.2791 - accuracy30: 0.6275 - val_loss: 2.4711 - val_accuracy30: 0.6430 - 61s/epoch - 40ms/step
Epoch 17/50
1504/1504 - 60s - loss: 2.2721 - accuracy30: 0.6282 - val_loss: 2.4649 - val_accuracy30: 0.6453 - 60s/epoch - 40ms/step
Epoch 18/50
1504/1504 - 60s - loss: 2.2688 - accuracy30: 0.6288 - val_loss: 2.4698 - val_accuracy30: 0.6451 - 60s/epoch - 40ms/step
Epoch 19/50
1504/1504 - 61s - loss: 2.2609 - accuracy30: 0.6305 - val_loss: 2.4754 - val_accuracy30: 0.6438 - 61s/epoch - 40ms/step
Epoch 20/50
1504/1504 - 61s - loss: 2.2560 - accuracy30: 0.6314 - val_loss: 2.4840 - val_accuracy30: 0.6435 - 61s/epoch - 40ms/step
Epoch 21/50
1504/1504 - 61s - loss: 2.2499 - accuracy30: 0.6320 - val_loss: 2.4878 - val_accuracy30: 0.6424 - 61s/epoch - 40ms/step
Epoch 22/50
1504/1504 - 61s - loss: 2.2452 - accuracy30: 0.6327 - val_loss: 2.4852 - val_accuracy30: 0.6400 - 61s/epoch - 40ms/step
Epoch 23/50
1504/1504 - 61s - loss: 2.2395 - accuracy30: 0.6338 - val_loss: 2.4858 - val_accuracy30: 0.6381 - 61s/epoch - 41ms/step
Epoch 24/50
1504/1504 - 61s - loss: 2.2338 - accuracy30: 0.6339 - val_loss: 2.4841 - val_accuracy30: 0.6368 - 61s/epoch - 40ms/step
testing model: results/EXC/W6/deepLOB_L2/h30
Evaluating performance on  test set...
4450/4450 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85149765
{'0': {'precision': 0.45988629471035025, 'recall': 0.7109598051838997, 'f1-score': 0.558503240560048, 'support': 285808}, '1': {'precision': 0.7297870547541192, 'recall': 0.6223957511700058, 'f1-score': 0.6718268567649922, 'support': 570510}, '2': {'precision': 0.5403521260440395, 'recall': 0.40262302733705085, 'f1-score': 0.46142935587601785, 'support': 282803}, 'accuracy': 0.5900549634323308, 'macro avg': {'precision': 0.5766751585028363, 'recall': 0.5786595278969854, 'f1-score': 0.563919817733686, 'support': 1139121}, 'weighted avg': {'precision': 0.615038434923051, 'recall': 0.5900549634323308, 'f1-score': 0.591159534729662, 'support': 1139121}}
[[203198  54436  28174]
 [146744 355083  68683]
 [ 91902  77038 113863]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7968935
{'0': {'precision': 0.4525143649692887, 'recall': 0.6896485082739461, 'f1-score': 0.5464647189720767, 'support': 82790}, '1': {'precision': 0.7815880309559405, 'recall': 0.649307537408505, 'f1-score': 0.7093333865420253, 'support': 219001}, '2': {'precision': 0.5340903165250039, 'recall': 0.49343594931830226, 'f1-score': 0.5129588821555567, 'support': 83028}, 'accuracy': 0.6243558660045372, 'macro avg': {'precision': 0.5893975708167444, 'recall': 0.6107973316669179, 'f1-score': 0.5895856625565529, 'support': 384819}, 'weighted avg': {'precision': 0.6573913331816448, 'recall': 0.6243558660045372, 'f1-score': 0.6319243206219024, 'support': 384819}}
[[ 57096  16796   8898]
 [ 49961 142199  26841]
 [ 19118  22941  40969]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7694642
{'0': {'precision': 0.4714048471638383, 'recall': 0.6565594506685941, 'f1-score': 0.548785645239246, 'support': 27670}, '1': {'precision': 0.7628671478596442, 'recall': 0.7172864227063203, 'f1-score': 0.7393749653682052, 'support': 74411}, '2': {'precision': 0.5647037440930571, 'recall': 0.4371438621174815, 'f1-score': 0.4928030453229708, 'support': 28430}, 'accuracy': 0.6433863812245711, 'macro avg': {'precision': 0.5996585797055132, 'recall': 0.603663245164132, 'f1-score': 0.5936545519768074, 'support': 130511}, 'weighted avg': {'precision': 0.6579062830334071, 'recall': 0.6433863812245711, 'f1-score': 0.6452553419276192, 'support': 130511}}
[[18167  6889  2614]
 [14071 53374  6966]
 [ 6300  9702 12428]]
training model: results/EXC/W6/deepLOB_L2/h50
Epoch 1/50
1504/1504 - 63s - loss: 2.9997 - accuracy50: 0.4670 - val_loss: 3.0669 - val_accuracy50: 0.5279 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 60s - loss: 2.8457 - accuracy50: 0.5153 - val_loss: 3.0349 - val_accuracy50: 0.5397 - 60s/epoch - 40ms/step
Epoch 3/50
1504/1504 - 61s - loss: 2.7737 - accuracy50: 0.5406 - val_loss: 2.9221 - val_accuracy50: 0.5601 - 61s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 2.7141 - accuracy50: 0.5561 - val_loss: 2.8712 - val_accuracy50: 0.5716 - 61s/epoch - 40ms/step
Epoch 5/50
1504/1504 - 61s - loss: 2.6713 - accuracy50: 0.5669 - val_loss: 2.8182 - val_accuracy50: 0.5819 - 61s/epoch - 40ms/step
Epoch 6/50
1504/1504 - 61s - loss: 2.6404 - accuracy50: 0.5738 - val_loss: 2.8053 - val_accuracy50: 0.5869 - 61s/epoch - 40ms/step
Epoch 7/50
1504/1504 - 60s - loss: 2.6171 - accuracy50: 0.5788 - val_loss: 2.7907 - val_accuracy50: 0.5880 - 60s/epoch - 40ms/step
Epoch 8/50
1504/1504 - 61s - loss: 2.6000 - accuracy50: 0.5820 - val_loss: 2.7760 - val_accuracy50: 0.5904 - 61s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 60s - loss: 2.5858 - accuracy50: 0.5832 - val_loss: 2.7759 - val_accuracy50: 0.5911 - 60s/epoch - 40ms/step
Epoch 10/50
1504/1504 - 61s - loss: 2.5741 - accuracy50: 0.5849 - val_loss: 2.7742 - val_accuracy50: 0.5910 - 61s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 60s - loss: 2.5638 - accuracy50: 0.5874 - val_loss: 2.7584 - val_accuracy50: 0.5922 - 60s/epoch - 40ms/step
Epoch 12/50
1504/1504 - 61s - loss: 2.5531 - accuracy50: 0.5893 - val_loss: 2.7560 - val_accuracy50: 0.5929 - 61s/epoch - 41ms/step
Epoch 13/50
1504/1504 - 60s - loss: 2.5464 - accuracy50: 0.5894 - val_loss: 2.7582 - val_accuracy50: 0.5909 - 60s/epoch - 40ms/step
Epoch 14/50
1504/1504 - 61s - loss: 2.5386 - accuracy50: 0.5913 - val_loss: 2.7464 - val_accuracy50: 0.5915 - 61s/epoch - 40ms/step
Epoch 15/50
1504/1504 - 60s - loss: 2.5291 - accuracy50: 0.5926 - val_loss: 2.7408 - val_accuracy50: 0.5899 - 60s/epoch - 40ms/step
Epoch 16/50
1504/1504 - 61s - loss: 2.5230 - accuracy50: 0.5938 - val_loss: 2.7573 - val_accuracy50: 0.5911 - 61s/epoch - 40ms/step
Epoch 17/50
1504/1504 - 61s - loss: 2.5162 - accuracy50: 0.5950 - val_loss: 2.7580 - val_accuracy50: 0.5912 - 61s/epoch - 40ms/step
Epoch 18/50
1504/1504 - 60s - loss: 2.5096 - accuracy50: 0.5962 - val_loss: 2.7690 - val_accuracy50: 0.5895 - 60s/epoch - 40ms/step
Epoch 19/50
1504/1504 - 61s - loss: 2.5036 - accuracy50: 0.5973 - val_loss: 2.7808 - val_accuracy50: 0.5903 - 61s/epoch - 40ms/step
Epoch 20/50
1504/1504 - 61s - loss: 2.4978 - accuracy50: 0.5988 - val_loss: 2.7765 - val_accuracy50: 0.5892 - 61s/epoch - 40ms/step
Epoch 21/50
1504/1504 - 62s - loss: 2.4906 - accuracy50: 0.5998 - val_loss: 2.7829 - val_accuracy50: 0.5883 - 62s/epoch - 41ms/step
Epoch 22/50
1504/1504 - 61s - loss: 2.4839 - accuracy50: 0.6015 - val_loss: 2.8045 - val_accuracy50: 0.5833 - 61s/epoch - 41ms/step
Epoch 23/50
1504/1504 - 62s - loss: 2.4786 - accuracy50: 0.6022 - val_loss: 2.8027 - val_accuracy50: 0.5850 - 62s/epoch - 41ms/step
Epoch 24/50
1504/1504 - 61s - loss: 2.4737 - accuracy50: 0.6032 - val_loss: 2.7878 - val_accuracy50: 0.5864 - 61s/epoch - 41ms/step
Epoch 25/50
1504/1504 - 61s - loss: 2.4667 - accuracy50: 0.6041 - val_loss: 2.7888 - val_accuracy50: 0.5837 - 61s/epoch - 40ms/step
testing model: results/EXC/W6/deepLOB_L2/h50
Evaluating performance on  test set...
4450/4450 - 63s - 63s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9387041
{'0': {'precision': 0.5209201870111226, 'recall': 0.476708825866766, 'f1-score': 0.4978348614862589, 'support': 341009}, '1': {'precision': 0.5856217892910063, 'recall': 0.6624160067129413, 'f1-score': 0.6216562484699123, 'support': 460007}, '2': {'precision': 0.48127801776835927, 'recall': 0.436609928868251, 'f1-score': 0.45785710962579285, 'support': 338105}, 'accuracy': 0.5398004250645893, 'macro avg': {'precision': 0.5292733313568294, 'recall': 0.5252449204826527, 'f1-score': 0.5257827398606547, 'support': 1139121}, 'weighted avg': {'precision': 0.5352821154876742, 'recall': 0.5398004250645893, 'f1-score': 0.5359713078948551, 'support': 1139121}}
[[162562  98046  80401]
 [ 76587 304716  78704]
 [ 72918 117567 147620]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86537707
{'0': {'precision': 0.5142519113567899, 'recall': 0.505107222374126, 'f1-score': 0.5096385482814171, 'support': 102404}, '1': {'precision': 0.6427874430574305, 'recall': 0.7062035483763457, 'f1-score': 0.6730048992490996, 'support': 180026}, '2': {'precision': 0.5490289072169718, 'recall': 0.46355565539266913, 'f1-score': 0.5026848409748037, 'support': 102389}, 'accuracy': 0.5881284448013222, 'macro avg': {'precision': 0.5686894205437307, 'recall': 0.5582888087143802, 'f1-score': 0.5617760961684402, 'support': 384819}, 'weighted avg': {'precision': 0.5836365297333973, 'recall': 0.5881284448013222, 'f1-score': 0.5842144074824731, 'support': 384819}}
[[ 51725  33489  17190]
 [ 31095 127135  21796]
 [ 17763  37163  47463]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86189747
{'0': {'precision': 0.5167014307118305, 'recall': 0.5174919822284991, 'f1-score': 0.5170964043159968, 'support': 33987}, '1': {'precision': 0.6245727458201955, 'recall': 0.7680302363846667, 'f1-score': 0.6889124319584992, 'support': 61383}, '2': {'precision': 0.5950452596474511, 'recall': 0.3554252867021428, 'f1-score': 0.4450303753718979, 'support': 35141}, 'accuracy': 0.5916895893832704, 'macro avg': {'precision': 0.578773145393159, 'recall': 0.5469825017717695, 'f1-score': 0.5503464038821313, 'support': 130511}, 'weighted avg': {'precision': 0.5885309732632126, 'recall': 0.5916895893832704, 'f1-score': 0.5785020398689781, 'support': 130511}}
[[17588 12467  3932]
 [ 9671 47144  4568]
 [ 6780 15871 12490]]
training model: results/EXC/W6/deepLOB_L2/h100
Epoch 1/50
1504/1504 - 64s - loss: 3.1459 - accuracy100: 0.4408 - val_loss: 3.2147 - val_accuracy100: 0.4256 - 64s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 61s - loss: 3.0537 - accuracy100: 0.4737 - val_loss: 3.2441 - val_accuracy100: 0.4212 - 61s/epoch - 41ms/step
Epoch 3/50
1504/1504 - 61s - loss: 3.0289 - accuracy100: 0.4811 - val_loss: 3.2129 - val_accuracy100: 0.4346 - 61s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 3.0082 - accuracy100: 0.4869 - val_loss: 3.2047 - val_accuracy100: 0.4365 - 61s/epoch - 41ms/step
Epoch 5/50
1504/1504 - 61s - loss: 2.9907 - accuracy100: 0.4919 - val_loss: 3.2035 - val_accuracy100: 0.4378 - 61s/epoch - 40ms/step
Epoch 6/50
1504/1504 - 61s - loss: 2.9739 - accuracy100: 0.4964 - val_loss: 3.1652 - val_accuracy100: 0.4423 - 61s/epoch - 41ms/step
Epoch 7/50
1504/1504 - 61s - loss: 2.9589 - accuracy100: 0.4996 - val_loss: 3.1383 - val_accuracy100: 0.4538 - 61s/epoch - 41ms/step
Epoch 8/50
1504/1504 - 62s - loss: 2.9445 - accuracy100: 0.5033 - val_loss: 3.1488 - val_accuracy100: 0.4536 - 62s/epoch - 41ms/step
Epoch 9/50
1504/1504 - 62s - loss: 2.9332 - accuracy100: 0.5052 - val_loss: 3.1408 - val_accuracy100: 0.4563 - 62s/epoch - 41ms/step
Epoch 10/50
1504/1504 - 61s - loss: 2.9199 - accuracy100: 0.5084 - val_loss: 3.1630 - val_accuracy100: 0.4555 - 61s/epoch - 41ms/step
Epoch 11/50
1504/1504 - 61s - loss: 2.9097 - accuracy100: 0.5107 - val_loss: 3.1590 - val_accuracy100: 0.4552 - 61s/epoch - 41ms/step
Epoch 12/50
1504/1504 - 61s - loss: 2.8984 - accuracy100: 0.5140 - val_loss: 3.1490 - val_accuracy100: 0.4594 - 61s/epoch - 41ms/step
Epoch 13/50
1504/1504 - 61s - loss: 2.8881 - accuracy100: 0.5166 - val_loss: 3.1574 - val_accuracy100: 0.4569 - 61s/epoch - 41ms/step
Epoch 14/50
1504/1504 - 61s - loss: 2.8802 - accuracy100: 0.5184 - val_loss: 3.1519 - val_accuracy100: 0.4600 - 61s/epoch - 41ms/step
Epoch 15/50
1504/1504 - 62s - loss: 2.8715 - accuracy100: 0.5206 - val_loss: 3.1622 - val_accuracy100: 0.4612 - 62s/epoch - 41ms/step
Epoch 16/50
1504/1504 - 61s - loss: 2.8611 - accuracy100: 0.5239 - val_loss: 3.1616 - val_accuracy100: 0.4614 - 61s/epoch - 41ms/step
Epoch 17/50
1504/1504 - 62s - loss: 2.8548 - accuracy100: 0.5254 - val_loss: 3.1666 - val_accuracy100: 0.4583 - 62s/epoch - 41ms/step
testing model: results/EXC/W6/deepLOB_L2/h100
Evaluating performance on  test set...
4450/4450 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0965116
{'0': {'precision': 0.5180201644673212, 'recall': 0.26935172873971513, 'f1-score': 0.3544186121579419, 'support': 407638}, '1': {'precision': 0.3513501056270405, 'recall': 0.5604406376747663, 'f1-score': 0.43192120273486195, 'support': 326436}, '2': {'precision': 0.45806516690284993, 'recall': 0.45966764350803735, 'f1-score': 0.4588650061428619, 'support': 405047}, 'accuracy': 0.42044084868947196, 'macro avg': {'precision': 0.44247847899907056, 'recall': 0.4298200033075063, 'f1-score': 0.4150682736785552, 'support': 1139121}, 'weighted avg': {'precision': 0.4489390929866951, 'recall': 0.42044084868947196, 'f1-score': 0.4137672978568074, 'support': 1139121}}
[[109798 174438 123402]
 [ 46613 182948  96875]
 [ 55546 163314 186187]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0772294
{'0': {'precision': 0.4701471111774636, 'recall': 0.3177457661321619, 'f1-score': 0.3792070174463572, 'support': 128842}, '1': {'precision': 0.4047762680908764, 'recall': 0.5781261115985676, 'f1-score': 0.47616474387353835, 'support': 126507}, '2': {'precision': 0.4748797594334384, 'recall': 0.42935042867073453, 'f1-score': 0.45096885939471126, 'support': 129470}, 'accuracy': 0.440892991250432, 'macro avg': {'precision': 0.44993437956725946, 'recall': 0.441740768800488, 'f1-score': 0.4354468735715356, 'support': 384819}, 'weighted avg': {'precision': 0.4502490986659873, 'recall': 0.440892991250432, 'f1-score': 0.4352251370666899, 'support': 384819}}
[[40939 54685 33218]
 [25119 73137 28251]
 [21019 52863 55588]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0481739
{'0': {'precision': 0.5147216372972774, 'recall': 0.33291121093376663, 'f1-score': 0.4043179872607769, 'support': 41852}, '1': {'precision': 0.41198364916221547, 'recall': 0.7098240403222177, 'f1-score': 0.5213654731309859, 'support': 44442}, '2': {'precision': 0.5100293997246101, 'recall': 0.30994866227921386, 'f1-score': 0.3855784379923475, 'support': 44217}, 'accuracy': 0.4534790170943445, 'macro avg': {'precision': 0.4789115620613677, 'recall': 0.45089463784506606, 'f1-score': 0.4370872994613701, 'support': 130511}, 'weighted avg': {'precision': 0.478147261670326, 'recall': 0.4534790170943445, 'f1-score': 0.43782640966993536, 'support': 130511}}
[[13933 20287  7632]
 [ 7362 31546  5534]
 [ 5774 24738 13705]]
training model: results/EXC/W6/deepLOB_L2/h200
Epoch 1/50
1504/1504 - 63s - loss: 3.2486 - accuracy200: 0.3953 - val_loss: 3.3144 - val_accuracy200: 0.3818 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 61s - loss: 3.2023 - accuracy200: 0.4192 - val_loss: 3.3254 - val_accuracy200: 0.3633 - 61s/epoch - 41ms/step
Epoch 3/50
1504/1504 - 61s - loss: 3.1868 - accuracy200: 0.4262 - val_loss: 3.3925 - val_accuracy200: 0.3515 - 61s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 3.1737 - accuracy200: 0.4316 - val_loss: 3.4544 - val_accuracy200: 0.3438 - 61s/epoch - 40ms/step
Epoch 5/50
1504/1504 - 62s - loss: 3.1634 - accuracy200: 0.4355 - val_loss: 3.4759 - val_accuracy200: 0.3402 - 62s/epoch - 41ms/step
Epoch 6/50
1504/1504 - 62s - loss: 3.1526 - accuracy200: 0.4400 - val_loss: 3.4976 - val_accuracy200: 0.3378 - 62s/epoch - 41ms/step
Epoch 7/50
1504/1504 - 61s - loss: 3.1430 - accuracy200: 0.4426 - val_loss: 3.5368 - val_accuracy200: 0.3263 - 61s/epoch - 41ms/step
Epoch 8/50
1504/1504 - 61s - loss: 3.1347 - accuracy200: 0.4465 - val_loss: 3.5318 - val_accuracy200: 0.3273 - 61s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 61s - loss: 3.1271 - accuracy200: 0.4493 - val_loss: 3.5245 - val_accuracy200: 0.3328 - 61s/epoch - 40ms/step
Epoch 10/50
1504/1504 - 61s - loss: 3.1193 - accuracy200: 0.4530 - val_loss: 3.5379 - val_accuracy200: 0.3248 - 61s/epoch - 41ms/step
Epoch 11/50
1504/1504 - 61s - loss: 3.1089 - accuracy200: 0.4564 - val_loss: 3.5276 - val_accuracy200: 0.3364 - 61s/epoch - 41ms/step
testing model: results/EXC/W6/deepLOB_L2/h200
Evaluating performance on  test set...
4450/4450 - 60s - 60s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1356518
{'0': {'precision': 0.3957358721126401, 'recall': 0.11407691701059383, 'f1-score': 0.17710159181666255, 'support': 380410}, '1': {'precision': 0.35518496718602033, 'recall': 0.6664856056491038, 'f1-score': 0.4634089975118316, 'support': 386610}, '2': {'precision': 0.36799239496199126, 'recall': 0.3006522422675564, 'f1-score': 0.3309313573235125, 'support': 372101}, 'accuracy': 0.3625067047311041, 'macro avg': {'precision': 0.37297107808688384, 'recall': 0.36040492164241805, 'f1-score': 0.32381398221733554, 'support': 1139121}, 'weighted avg': {'precision': 0.37291058757753454, 'recall': 0.3625067047311041, 'f1-score': 0.32452185330835104, 'support': 1139121}}
[[ 43396 240774  96240]
 [ 33044 257670  95896]
 [ 33219 227009 111873]]
Evaluating performance on  train set...
1504/1504 - 22s - 22s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1345556
{'0': {'precision': 0.3768503469127388, 'recall': 0.16679171726703845, 'f1-score': 0.23123860589812334, 'support': 129281}, '1': {'precision': 0.34340591738214227, 'recall': 0.6108392025784887, 'f1-score': 0.43964761746561803, 'support': 125655}, '2': {'precision': 0.40144491733036153, 'recall': 0.3217203175165341, 'f1-score': 0.3571880395944814, 'support': 129883}, 'accuracy': 0.3640776572882316, 'macro avg': {'precision': 0.3739003938750809, 'recall': 0.36645041245402044, 'f1-score': 0.3426914209860743, 'support': 384819}, 'weighted avg': {'precision': 0.3742308213614666, 'recall': 0.3640776572882316, 'f1-score': 0.34180051849936605, 'support': 384819}}
[[21563 74421 33297]
 [19894 76755 29006]
 [15762 72335 41786]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1065404
{'0': {'precision': 0.3749948421704147, 'recall': 0.22742742742742741, 'f1-score': 0.2831373159903419, 'support': 39960}, '1': {'precision': 0.37429651210408693, 'recall': 0.6804356149232144, 'f1-score': 0.482937175896921, 'support': 47014}, '2': {'precision': 0.42986207890816475, 'recall': 0.20545742701610126, 'f1-score': 0.27802816025860194, 'support': 43537}, 'accuracy': 0.383285700055934, 'macro avg': {'precision': 0.3930511443942222, 'recall': 0.3711068231222477, 'f1-score': 0.3480342173819549, 'support': 130511}, 'weighted avg': {'precision': 0.39304637496162065, 'recall': 0.383285700055934, 'f1-score': 0.3534068971027014, 'support': 130511}}
[[ 9088 24782  6090]
 [ 9250 31990  5774]
 [ 5897 28695  8945]]
training model: results/EXC/W6/deepLOB_L2/h300
Epoch 1/50
1504/1504 - 63s - loss: 3.2753 - accuracy300: 0.3846 - val_loss: 3.3626 - val_accuracy300: 0.3569 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 62s - loss: 3.2348 - accuracy300: 0.4025 - val_loss: 3.4326 - val_accuracy300: 0.3307 - 62s/epoch - 41ms/step
Epoch 3/50
1504/1504 - 61s - loss: 3.2124 - accuracy300: 0.4156 - val_loss: 3.4442 - val_accuracy300: 0.3376 - 61s/epoch - 41ms/step
Epoch 4/50
1504/1504 - 62s - loss: 3.1981 - accuracy300: 0.4231 - val_loss: 3.4077 - val_accuracy300: 0.3417 - 62s/epoch - 41ms/step
Epoch 5/50
1504/1504 - 62s - loss: 3.1856 - accuracy300: 0.4287 - val_loss: 3.4419 - val_accuracy300: 0.3366 - 62s/epoch - 41ms/step
Epoch 6/50
1504/1504 - 61s - loss: 3.1740 - accuracy300: 0.4334 - val_loss: 3.4060 - val_accuracy300: 0.3450 - 61s/epoch - 41ms/step
Epoch 7/50
1504/1504 - 62s - loss: 3.1624 - accuracy300: 0.4395 - val_loss: 3.4114 - val_accuracy300: 0.3472 - 62s/epoch - 41ms/step
Epoch 8/50
1504/1504 - 61s - loss: 3.1533 - accuracy300: 0.4429 - val_loss: 3.4223 - val_accuracy300: 0.3479 - 61s/epoch - 41ms/step
Epoch 9/50
1504/1504 - 61s - loss: 3.1438 - accuracy300: 0.4459 - val_loss: 3.4085 - val_accuracy300: 0.3525 - 61s/epoch - 40ms/step
Epoch 10/50
1504/1504 - 61s - loss: 3.1323 - accuracy300: 0.4501 - val_loss: 3.4554 - val_accuracy300: 0.3459 - 61s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 61s - loss: 3.1232 - accuracy300: 0.4540 - val_loss: 3.4841 - val_accuracy300: 0.3386 - 61s/epoch - 41ms/step
testing model: results/EXC/W6/deepLOB_L2/h300
Evaluating performance on  test set...
4450/4450 - 59s - 59s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1332982
{'0': {'precision': 0.40073415342932683, 'recall': 0.23345128688169853, 'f1-score': 0.2950301216932493, 'support': 392810}, '1': {'precision': 0.3093314712043809, 'recall': 0.2317818057643903, 'f1-score': 0.26499962217576384, 'support': 363126}, '2': {'precision': 0.35473428225811504, 'recall': 0.5908112269530383, 'f1-score': 0.4433017649633193, 'support': 383185}, 'accuracy': 0.353130176688868, 'macro avg': {'precision': 0.35493330229727427, 'recall': 0.35201477319970903, 'f1-score': 0.3344438362774442, 'support': 1139121}, 'weighted avg': {'precision': 0.35612330785597995, 'recall': 0.353130176688868, 'f1-score': 0.3353336666710483, 'support': 1139121}}
[[ 91702  98970 202138]
 [ 69292  84166 209668]
 [ 67841  88954 226390]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1228757
{'0': {'precision': 0.38503859954332936, 'recall': 0.27508525529981126, 'f1-score': 0.32090475349001596, 'support': 128731}, '1': {'precision': 0.3424499931653529, 'recall': 0.23665131656630062, 'f1-score': 0.279886231921163, 'support': 127035}, '2': {'precision': 0.36212151506137197, 'recall': 0.5753992545698279, 'f1-score': 0.4445009787078662, 'support': 129053}, 'accuracy': 0.36311096905298335, 'macro avg': {'precision': 0.3632033692566847, 'recall': 0.36237860881197986, 'f1-score': 0.34843065470634843, 'support': 384819}, 'weighted avg': {'precision': 0.36329392967288043, 'recall': 0.36311096905298335, 'f1-score': 0.3488131357828341, 'support': 384819}}
[[35412 29822 63497]
 [29665 30063 67307]
 [26893 27903 74257]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1209297
{'0': {'precision': 0.33631601475713907, 'recall': 0.415648537672872, 'f1-score': 0.3717974717771919, 'support': 39697}, '1': {'precision': 0.36890832328106155, 'recall': 0.26451445499167514, 'f1-score': 0.3081088569017845, 'support': 46247}, '2': {'precision': 0.36792296541727065, 'recall': 0.39865820001346286, 'f1-score': 0.382674434883746, 'support': 44567}, 'accuracy': 0.356291806820881, 'macro avg': {'precision': 0.3577157678184904, 'recall': 0.35960706422600336, 'f1-score': 0.3541935878542408, 'support': 130511}, 'weighted avg': {'precision': 0.3586583725842642, 'recall': 0.356291806820881, 'f1-score': 0.35294347665514725, 'support': 130511}}
[[16500  9121 14076]
 [17567 12233 16447]
 [14994 11806 17767]]
training model: results/EXC/W6/deepLOB_L2/h500
Epoch 1/50
1504/1504 - 64s - loss: 3.2314 - accuracy500: 0.4190 - val_loss: 3.4787 - val_accuracy500: 0.2771 - 64s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 61s - loss: 3.1984 - accuracy500: 0.4331 - val_loss: 3.4227 - val_accuracy500: 0.2752 - 61s/epoch - 41ms/step
Epoch 3/50
1504/1504 - 61s - loss: 3.1719 - accuracy500: 0.4459 - val_loss: 3.4367 - val_accuracy500: 0.3127 - 61s/epoch - 40ms/step
Epoch 4/50
1504/1504 - 61s - loss: 3.1556 - accuracy500: 0.4525 - val_loss: 3.4864 - val_accuracy500: 0.3047 - 61s/epoch - 41ms/step
Epoch 5/50
1504/1504 - 61s - loss: 3.1390 - accuracy500: 0.4596 - val_loss: 3.4962 - val_accuracy500: 0.3392 - 61s/epoch - 41ms/step
Epoch 6/50
1504/1504 - 61s - loss: 3.1234 - accuracy500: 0.4651 - val_loss: 3.5821 - val_accuracy500: 0.3127 - 61s/epoch - 41ms/step
Epoch 7/50
1504/1504 - 61s - loss: 3.1117 - accuracy500: 0.4680 - val_loss: 3.5922 - val_accuracy500: 0.3288 - 61s/epoch - 41ms/step
Epoch 8/50
1504/1504 - 61s - loss: 3.0975 - accuracy500: 0.4723 - val_loss: 3.5827 - val_accuracy500: 0.3301 - 61s/epoch - 41ms/step
Epoch 9/50
1504/1504 - 61s - loss: 3.0851 - accuracy500: 0.4770 - val_loss: 3.5920 - val_accuracy500: 0.3485 - 61s/epoch - 41ms/step
Epoch 10/50
1504/1504 - 61s - loss: 3.0759 - accuracy500: 0.4800 - val_loss: 3.5965 - val_accuracy500: 0.3379 - 61s/epoch - 40ms/step
Epoch 11/50
1504/1504 - 61s - loss: 3.0627 - accuracy500: 0.4844 - val_loss: 3.5201 - val_accuracy500: 0.3699 - 61s/epoch - 41ms/step
Epoch 12/50
1504/1504 - 61s - loss: 3.0492 - accuracy500: 0.4887 - val_loss: 3.4621 - val_accuracy500: 0.3946 - 61s/epoch - 41ms/step
testing model: results/EXC/W6/deepLOB_L2/h500
Evaluating performance on  test set...
4450/4450 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1680127
{'0': {'precision': 0.2738077922077922, 'recall': 0.19015047386098394, 'f1-score': 0.22443691703694557, 'support': 277191}, '1': {'precision': 0.4974373644186989, 'recall': 0.03566807342491791, 'f1-score': 0.06656331441731979, 'support': 585033}, '2': {'precision': 0.24290792685083654, 'recall': 0.7936236217799398, 'f1-score': 0.3719664276906384, 'support': 276897}, 'accuracy': 0.2575029342800282, 'macro avg': {'precision': 0.33805102782577584, 'recall': 0.33981405635528056, 'f1-score': 0.22098888638163458, 'support': 1139121}, 'weighted avg': {'precision': 0.38114897852734775, 'recall': 0.2575029342800282, 'f1-score': 0.17921714806605318, 'support': 1139121}}
[[ 52708  11474 213009]
 [ 92255  20867 471911]
 [ 47537   9608 219752]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145854
{'0': {'precision': 0.306731724250986, 'recall': 0.24822080719168463, 'f1-score': 0.27439174297285757, 'support': 128148}, '1': {'precision': 0.3649975793623349, 'recall': 0.08272462223336886, 'f1-score': 0.1348795604114753, 'support': 127592}, '2': {'precision': 0.35809958841862344, 'recall': 0.6996645465180239, 'f1-score': 0.47373431914330005, 'support': 129079}, 'accuracy': 0.344775076074726, 'macro avg': {'precision': 0.3432762973439815, 'recall': 0.34353665864769245, 'f1-score': 0.294335207509211, 'support': 384819}, 'weighted avg': {'precision': 0.343280775946099, 'recall': 0.344775076074726, 'f1-score': 0.29499961834318145, 'support': 384819}}
[[31809  9373 86966]
 [42117 10555 74920]
 [29777  8990 90312]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1400185
{'0': {'precision': 0.19151411613967392, 'recall': 0.4062099771967638, 'f1-score': 0.26030386132073585, 'support': 32013}, '1': {'precision': 0.4105004605465152, 'recall': 0.0429254823899573, 'f1-score': 0.07772352052086966, 'support': 62294}, '2': {'precision': 0.3620222475755847, 'recall': 0.5609324936471108, 'f1-score': 0.4400433369447454, 'support': 36204}, 'accuracy': 0.27573154753239193, 'macro avg': {'precision': 0.32134560808725793, 'recall': 0.33668931774461064, 'f1-score': 0.259356906262117, 'support': 130511}, 'weighted avg': {'precision': 0.34333742397568384, 'recall': 0.27573154753239193, 'f1-score': 0.22301679912448247, 'support': 130511}}
[[13004  1957 17052]
 [40884  2674 18736]
 [14013  1883 20308]]
training model: results/EXC/W6/deepLOB_L2/h1000
Epoch 1/50
1504/1504 - 63s - loss: 3.2122 - accuracy1000: 0.4272 - val_loss: 3.3270 - val_accuracy1000: 0.4299 - 63s/epoch - 42ms/step
Epoch 2/50
1504/1504 - 62s - loss: 3.1593 - accuracy1000: 0.4404 - val_loss: 3.4352 - val_accuracy1000: 0.3468 - 62s/epoch - 41ms/step
Epoch 3/50
1504/1504 - 61s - loss: 3.1245 - accuracy1000: 0.4577 - val_loss: 3.3884 - val_accuracy1000: 0.3735 - 61s/epoch - 41ms/step
Epoch 4/50
1504/1504 - 62s - loss: 3.1030 - accuracy1000: 0.4661 - val_loss: 3.4585 - val_accuracy1000: 0.3018 - 62s/epoch - 41ms/step
Epoch 5/50
1504/1504 - 62s - loss: 3.0808 - accuracy1000: 0.4750 - val_loss: 3.4307 - val_accuracy1000: 0.3106 - 62s/epoch - 41ms/step
Epoch 6/50
1504/1504 - 61s - loss: 3.0595 - accuracy1000: 0.4816 - val_loss: 3.4514 - val_accuracy1000: 0.3073 - 61s/epoch - 41ms/step
Epoch 7/50
1504/1504 - 62s - loss: 3.0431 - accuracy1000: 0.4894 - val_loss: 3.4750 - val_accuracy1000: 0.3029 - 62s/epoch - 41ms/step
Epoch 8/50
1504/1504 - 61s - loss: 3.0254 - accuracy1000: 0.4949 - val_loss: 3.4644 - val_accuracy1000: 0.3115 - 61s/epoch - 40ms/step
Epoch 9/50
1504/1504 - 61s - loss: 3.0149 - accuracy1000: 0.4987 - val_loss: 3.5005 - val_accuracy1000: 0.3044 - 61s/epoch - 41ms/step
Epoch 10/50
1504/1504 - 61s - loss: 2.9992 - accuracy1000: 0.5029 - val_loss: 3.5096 - val_accuracy1000: 0.2987 - 61s/epoch - 41ms/step
Epoch 11/50
1504/1504 - 61s - loss: 2.9803 - accuracy1000: 0.5099 - val_loss: 3.5650 - val_accuracy1000: 0.2924 - 61s/epoch - 40ms/step
testing model: results/EXC/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
4450/4450 - 62s - 62s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1257184
{'0': {'precision': 0.3179200129796382, 'recall': 0.011500695500085104, 'f1-score': 0.02219836924967926, 'support': 340762}, '1': {'precision': 0.38975962786174906, 'recall': 0.5129076395328479, 'f1-score': 0.4429332887826558, 'support': 462633}, '2': {'precision': 0.2974663505718279, 'recall': 0.4589576023304719, 'f1-score': 0.36097334704596623, 'support': 335726}, 'accuracy': 0.3470140573301695, 'macro avg': {'precision': 0.33504866380440507, 'recall': 0.32778864578780165, 'f1-score': 0.2753683350261004, 'support': 1139121}, 'weighted avg': {'precision': 0.34106816869464224, 'recall': 0.3470140573301695, 'f1-score': 0.29291713066653996, 'support': 1139121}}
[[  3919 193415 143428]
 [  4869 237288 220476]
 [  3539 178103 154084]]
Evaluating performance on  train set...
1504/1504 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371635
{'0': {'precision': 0.30804298274177794, 'recall': 0.029758721570354526, 'f1-score': 0.05427423981640849, 'support': 127156}, '1': {'precision': 0.383091646119771, 'recall': 0.6470062345606399, 'f1-score': 0.4812410317432541, 'support': 127515}, '2': {'precision': 0.38463740822273407, 'recall': 0.4645096351845591, 'f1-score': 0.4208170623899319, 'support': 130148}, 'accuracy': 0.3813273253139788, 'macro avg': {'precision': 0.35859067902809433, 'recall': 0.3804248637718512, 'f1-score': 0.31877744464986485, 'support': 384819}, 'weighted avg': {'precision': 0.3588160516342709, 'recall': 0.3813273253139788, 'f1-score': 0.31972237451051305, 'support': 384819}}
[[ 3784 66922 56450]
 [ 4743 82503 40269]
 [ 3757 65936 60455]]
Evaluating performance on  val set...
510/510 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.110603
{'0': {'precision': 0.24358974358974358, 'recall': 0.01435420601481912, 'f1-score': 0.0271108306121889, 'support': 34415}, '1': {'precision': 0.44044843809604545, 'recall': 0.7918539967995123, 'f1-score': 0.5660474997276391, 'support': 52492}, '2': {'precision': 0.40942804373955616, 'recall': 0.3202917163562976, 'f1-score': 0.3594158141928842, 'support': 43604}, 'accuracy': 0.42928182298810064, 'macro avg': {'precision': 0.36448874180844837, 'recall': 0.37549997305687627, 'f1-score': 0.31752471484423744, 'support': 130511}, 'weighted avg': {'precision': 0.3781739535931703, 'recall': 0.42928182298810064, 'f1-score': 0.3548969186757303, 'support': 130511}}
[[  494 23794 10127]
 [  908 41566 10018]
 [  626 29012 13966]]
training model: results/EXC/W6/deepOF_L2/h10
Epoch 1/50
1504/1504 - 35s - loss: 2.6511 - accuracy10: 0.5267 - val_loss: 2.6136 - val_accuracy10: 0.6820 - 35s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 33s - loss: 2.2570 - accuracy10: 0.6137 - val_loss: 2.5254 - val_accuracy10: 0.6921 - 33s/epoch - 22ms/step
Epoch 3/50
1504/1504 - 34s - loss: 2.1867 - accuracy10: 0.6289 - val_loss: 2.4601 - val_accuracy10: 0.7008 - 34s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 34s - loss: 2.1500 - accuracy10: 0.6348 - val_loss: 2.3883 - val_accuracy10: 0.6935 - 34s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 34s - loss: 2.1286 - accuracy10: 0.6383 - val_loss: 2.3764 - val_accuracy10: 0.7011 - 34s/epoch - 23ms/step
Epoch 6/50
1504/1504 - 34s - loss: 2.1132 - accuracy10: 0.6400 - val_loss: 2.4076 - val_accuracy10: 0.7012 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 34s - loss: 2.0994 - accuracy10: 0.6417 - val_loss: 2.3931 - val_accuracy10: 0.7022 - 34s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 34s - loss: 2.0891 - accuracy10: 0.6436 - val_loss: 2.4103 - val_accuracy10: 0.7070 - 34s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 34s - loss: 2.0815 - accuracy10: 0.6436 - val_loss: 2.3897 - val_accuracy10: 0.7080 - 34s/epoch - 23ms/step
Epoch 10/50
1504/1504 - 34s - loss: 2.0726 - accuracy10: 0.6459 - val_loss: 2.4204 - val_accuracy10: 0.6954 - 34s/epoch - 23ms/step
Epoch 11/50
1504/1504 - 34s - loss: 2.0644 - accuracy10: 0.6467 - val_loss: 2.3892 - val_accuracy10: 0.7065 - 34s/epoch - 23ms/step
Epoch 12/50
1504/1504 - 33s - loss: 2.0598 - accuracy10: 0.6459 - val_loss: 2.4200 - val_accuracy10: 0.7032 - 33s/epoch - 22ms/step
Epoch 13/50
1504/1504 - 34s - loss: 2.0547 - accuracy10: 0.6479 - val_loss: 2.4095 - val_accuracy10: 0.7009 - 34s/epoch - 22ms/step
Epoch 14/50
1504/1504 - 33s - loss: 2.0469 - accuracy10: 0.6483 - val_loss: 2.4156 - val_accuracy10: 0.7085 - 33s/epoch - 22ms/step
Epoch 15/50
1504/1504 - 34s - loss: 2.0410 - accuracy10: 0.6489 - val_loss: 2.4095 - val_accuracy10: 0.7023 - 34s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h10
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72555035
{'0': {'precision': 0.39376846032556795, 'recall': 0.6454442867023407, 'f1-score': 0.48913103448275863, 'support': 192297}, '1': {'precision': 0.8505137405768007, 'recall': 0.7302192627396202, 'f1-score': 0.7857892702827158, 'support': 755988}, '2': {'precision': 0.5123763225621961, 'recall': 0.4694677489506422, 'f1-score': 0.489984439990046, 'support': 190831}, 'accuracy': 0.6722256556838812, 'macro avg': {'precision': 0.585552841154855, 'recall': 0.6150437661308678, 'f1-score': 0.5883015815851734, 'support': 1139116}, 'weighted avg': {'precision': 0.7167627891604249, 'recall': 0.6722256556838812, 'f1-score': 0.6861547990443128, 'support': 1139116}}
[[124117  36893  31287]
 [149977 552037  53974]
 [ 41109  60133  89589]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6573744
{'0': {'precision': 0.3904666332162569, 'recall': 0.6618847811295078, 'f1-score': 0.4911741810607814, 'support': 52908}, '1': {'precision': 0.8727752842976153, 'recall': 0.7662663920012058, 'f1-score': 0.8160602354380064, 'support': 278642}, '2': {'precision': 0.48969204871769484, 'recall': 0.46419989487121727, 'f1-score': 0.47660534101751106, 'support': 53268}, 'accuracy': 0.7101019183094346, 'macro avg': {'precision': 0.584311322077189, 'recall': 0.630783689333977, 'f1-score': 0.594613252505433, 'support': 384818}, 'weighted avg': {'precision': 0.753435586299383, 'recall': 0.7101019183094346, 'f1-score': 0.724403518026188, 'support': 384818}}
[[ 35019  11266   6623]
 [ 45983 213514  19145]
 [  8683  19858  24727]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6802929
{'0': {'precision': 0.38043370956596134, 'recall': 0.6600628033114473, 'f1-score': 0.4826736806947227, 'support': 17515}, '1': {'precision': 0.8698002321756796, 'recall': 0.7562398805643754, 'f1-score': 0.8090546088521455, 'support': 95114}, '2': {'precision': 0.45833811545965797, 'recall': 0.4466502628341349, 'f1-score': 0.4524187153053132, 'support': 17882}, 'accuracy': 0.7009140991947039, 'macro avg': {'precision': 0.5695240190670996, 'recall': 0.6209843155699858, 'f1-score': 0.5813823349507271, 'support': 130511}, 'weighted avg': {'precision': 0.7477490624304082, 'recall': 0.7009140991947039, 'f1-score': 0.716388664946408, 'support': 130511}}
[[11561  3880  2074]
 [15820 71929  7365]
 [ 3008  6887  7987]]
training model: results/EXC/W6/deepOF_L2/h20
Epoch 1/50
1504/1504 - 37s - loss: 2.7301 - accuracy20: 0.5172 - val_loss: 2.8315 - val_accuracy20: 0.6477 - 37s/epoch - 25ms/step
Epoch 2/50
1504/1504 - 34s - loss: 2.3770 - accuracy20: 0.5988 - val_loss: 2.6834 - val_accuracy20: 0.6585 - 34s/epoch - 23ms/step
Epoch 3/50
1504/1504 - 34s - loss: 2.3086 - accuracy20: 0.6145 - val_loss: 2.6321 - val_accuracy20: 0.6618 - 34s/epoch - 23ms/step
Epoch 4/50
1504/1504 - 34s - loss: 2.2745 - accuracy20: 0.6208 - val_loss: 2.6140 - val_accuracy20: 0.6607 - 34s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 34s - loss: 2.2560 - accuracy20: 0.6243 - val_loss: 2.5794 - val_accuracy20: 0.6576 - 34s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 34s - loss: 2.2414 - accuracy20: 0.6266 - val_loss: 2.6059 - val_accuracy20: 0.6590 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 34s - loss: 2.2296 - accuracy20: 0.6279 - val_loss: 2.5798 - val_accuracy20: 0.6561 - 34s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 34s - loss: 2.2199 - accuracy20: 0.6294 - val_loss: 2.6373 - val_accuracy20: 0.6512 - 34s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 34s - loss: 2.2128 - accuracy20: 0.6303 - val_loss: 2.6106 - val_accuracy20: 0.6556 - 34s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 2.2065 - accuracy20: 0.6321 - val_loss: 2.6187 - val_accuracy20: 0.6548 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 33s - loss: 2.1990 - accuracy20: 0.6330 - val_loss: 2.6049 - val_accuracy20: 0.6572 - 33s/epoch - 22ms/step
Epoch 12/50
1504/1504 - 34s - loss: 2.1920 - accuracy20: 0.6345 - val_loss: 2.5935 - val_accuracy20: 0.6558 - 34s/epoch - 23ms/step
Epoch 13/50
1504/1504 - 34s - loss: 2.1861 - accuracy20: 0.6349 - val_loss: 2.6856 - val_accuracy20: 0.6528 - 34s/epoch - 23ms/step
Epoch 14/50
1504/1504 - 34s - loss: 2.1804 - accuracy20: 0.6356 - val_loss: 2.6656 - val_accuracy20: 0.6515 - 34s/epoch - 23ms/step
Epoch 15/50
1504/1504 - 34s - loss: 2.1757 - accuracy20: 0.6357 - val_loss: 2.6287 - val_accuracy20: 0.6598 - 34s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h20
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7835332
{'0': {'precision': 0.4470840881201426, 'recall': 0.6181337103615431, 'f1-score': 0.5188755700988453, 'support': 247550}, '1': {'precision': 0.7556218159785061, 'recall': 0.7326874731364006, 'f1-score': 0.7439779393237206, 'support': 646786}, '2': {'precision': 0.5750820560868822, 'recall': 0.3986927036522592, 'f1-score': 0.47091181501685236, 'support': 244780}, 'accuracy': 0.6360221434867037, 'macro avg': {'precision': 0.5925959867285103, 'recall': 0.5831712957167343, 'f1-score': 0.5779217748131394, 'support': 1139116}, 'weighted avg': {'precision': 0.6497756712859466, 'recall': 0.6360221434867037, 'f1-score': 0.6363811560203054, 'support': 1139116}}
[[153019  60592  33939]
 [134724 473892  38170]
 [ 54517  92671  97592]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7182755
{'0': {'precision': 0.4430246858034134, 'recall': 0.631331481085702, 'f1-score': 0.5206754327211196, 'support': 70185}, '1': {'precision': 0.7911694510739857, 'recall': 0.7604020742706874, 'f1-score': 0.775480706972392, 'support': 244134}, '2': {'precision': 0.559777516397201, 'recall': 0.39828933743741046, 'f1-score': 0.46542350406099786, 'support': 70499}, 'accuracy': 0.6705221689214123, 'macro avg': {'precision': 0.5979905510915334, 'recall': 0.5966742975979332, 'f1-score': 0.5871932145848365, 'support': 384818}, 'weighted avg': {'precision': 0.685281887723795, 'recall': 0.6705221689214123, 'f1-score': 0.6722053120548571, 'support': 384818}}
[[ 44310  18532   7343]
 [ 43755 185640  14739]
 [ 11952  30468  28079]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74116063
{'0': {'precision': 0.43506455399061034, 'recall': 0.6333888675295827, 'f1-score': 0.5158204178190611, 'support': 23409}, '1': {'precision': 0.7847802814029364, 'recall': 0.7404908786993277, 'f1-score': 0.7619925628476498, 'support': 83157}, '2': {'precision': 0.5166137919519118, 'recall': 0.38763833785759033, 'f1-score': 0.44292803970223327, 'support': 23945}, 'accuracy': 0.6565423604140647, 'macro avg': {'precision': 0.5788195424484862, 'recall': 0.5871726946955002, 'f1-score': 0.5735803401229814, 'support': 130511}, 'weighted avg': {'precision': 0.6728529951749562, 'recall': 0.6565423604140647, 'f1-score': 0.6592989680572395, 'support': 130511}}
[[14827  6330  2252]
 [15147 61577  6433]
 [ 4106 10557  9282]]
training model: results/EXC/W6/deepOF_L2/h30
Epoch 1/50
1504/1504 - 36s - loss: 2.8012 - accuracy30: 0.5132 - val_loss: 2.9778 - val_accuracy30: 0.6167 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 34s - loss: 2.4974 - accuracy30: 0.5840 - val_loss: 2.8423 - val_accuracy30: 0.6297 - 34s/epoch - 23ms/step
Epoch 3/50
1504/1504 - 34s - loss: 2.4347 - accuracy30: 0.5983 - val_loss: 2.7728 - val_accuracy30: 0.6358 - 34s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 34s - loss: 2.4052 - accuracy30: 0.6046 - val_loss: 2.7688 - val_accuracy30: 0.6334 - 34s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 34s - loss: 2.3879 - accuracy30: 0.6077 - val_loss: 2.7803 - val_accuracy30: 0.6324 - 34s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 34s - loss: 2.3739 - accuracy30: 0.6102 - val_loss: 2.7904 - val_accuracy30: 0.6278 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 33s - loss: 2.3624 - accuracy30: 0.6118 - val_loss: 2.7941 - val_accuracy30: 0.6274 - 33s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 34s - loss: 2.3555 - accuracy30: 0.6131 - val_loss: 2.7954 - val_accuracy30: 0.6313 - 34s/epoch - 23ms/step
Epoch 9/50
1504/1504 - 34s - loss: 2.3474 - accuracy30: 0.6146 - val_loss: 2.8245 - val_accuracy30: 0.6309 - 34s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 2.3406 - accuracy30: 0.6150 - val_loss: 2.8053 - val_accuracy30: 0.6311 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 34s - loss: 2.3335 - accuracy30: 0.6160 - val_loss: 2.8199 - val_accuracy30: 0.6321 - 34s/epoch - 22ms/step
Epoch 12/50
1504/1504 - 33s - loss: 2.3268 - accuracy30: 0.6164 - val_loss: 2.8177 - val_accuracy30: 0.6337 - 33s/epoch - 22ms/step
Epoch 13/50
1504/1504 - 33s - loss: 2.3214 - accuracy30: 0.6177 - val_loss: 2.8499 - val_accuracy30: 0.6342 - 33s/epoch - 22ms/step
Epoch 14/50
1504/1504 - 33s - loss: 2.3151 - accuracy30: 0.6189 - val_loss: 2.8361 - val_accuracy30: 0.6281 - 33s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h30
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84218407
{'0': {'precision': 0.4951097517208824, 'recall': 0.5357937607591217, 'f1-score': 0.5146489708331302, 'support': 285804}, '1': {'precision': 0.6636534755857123, 'recall': 0.7817654379414909, 'f1-score': 0.7178837154089759, 'support': 570510}, '2': {'precision': 0.6024388079755613, 'recall': 0.3361150204029674, 'f1-score': 0.43149093021989, 'support': 282802}, 'accuracy': 0.6094120352975465, 'macro avg': {'precision': 0.5870673450940519, 'recall': 0.5512247397011933, 'f1-score': 0.5546745388206654, 'support': 1139116}, 'weighted avg': {'precision': 0.6061684601132321, 'recall': 0.6094120352975465, 'f1-score': 0.5957910089806587, 'support': 1139116}}
[[153132  98254  34418]
 [ 96195 446005  28310]
 [ 59962 127786  95054]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.776732
{'0': {'precision': 0.4994321375718432, 'recall': 0.5254486862274148, 'f1-score': 0.5121101975038524, 'support': 82853}, '1': {'precision': 0.7076679867143587, 'recall': 0.8093505307613286, 'f1-score': 0.7551014757593376, 'support': 219025}, '2': {'precision': 0.6002799397705342, 'recall': 0.3412707981673499, 'f1-score': 0.43515023867540914, 'support': 82940}, 'accuracy': 0.6473397814031568, 'macro avg': {'precision': 0.6024600213522454, 'recall': 0.558690005052031, 'f1-score': 0.5674539706461997, 'support': 384818}, 'weighted avg': {'precision': 0.6396885018084405, 'recall': 0.6473397814031568, 'f1-score': 0.633825152975469, 'support': 384818}}
[[ 43535  31710   7608]
 [ 30517 177268  11240]
 [ 13117  41518  28305]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.800067
{'0': {'precision': 0.49255308271701714, 'recall': 0.5226196072758833, 'f1-score': 0.5071411025722006, 'support': 27653}, '1': {'precision': 0.6990976482012173, 'recall': 0.7925465504973889, 'f1-score': 0.7428948941391135, 'support': 74489}, '2': {'precision': 0.5494498923702463, 'recall': 0.32390990165321304, 'f1-score': 0.40755771405761426, 'support': 28369}, 'accuracy': 0.6334868325275265, 'macro avg': {'precision': 0.5803668744294935, 'recall': 0.5463586864754951, 'f1-score': 0.5525312369229761, 'support': 130511}, 'weighted avg': {'precision': 0.6228057336920694, 'recall': 0.6334868325275265, 'f1-score': 0.6200509954644279, 'support': 130511}}
[[14452 10774  2427]
 [10345 59036  5108]
 [ 4544 14636  9189]]
training model: results/EXC/W6/deepOF_L2/h50
Epoch 1/50
1504/1504 - 36s - loss: 2.9234 - accuracy50: 0.4941 - val_loss: 3.1123 - val_accuracy50: 0.5408 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 34s - loss: 2.6928 - accuracy50: 0.5544 - val_loss: 3.0073 - val_accuracy50: 0.5557 - 34s/epoch - 23ms/step
Epoch 3/50
1504/1504 - 34s - loss: 2.6397 - accuracy50: 0.5672 - val_loss: 2.9747 - val_accuracy50: 0.5606 - 34s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 34s - loss: 2.6149 - accuracy50: 0.5730 - val_loss: 2.9493 - val_accuracy50: 0.5600 - 34s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 34s - loss: 2.6004 - accuracy50: 0.5767 - val_loss: 2.9420 - val_accuracy50: 0.5603 - 34s/epoch - 23ms/step
Epoch 6/50
1504/1504 - 34s - loss: 2.5888 - accuracy50: 0.5798 - val_loss: 2.9562 - val_accuracy50: 0.5622 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 34s - loss: 2.5802 - accuracy50: 0.5810 - val_loss: 2.9432 - val_accuracy50: 0.5661 - 34s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 34s - loss: 2.5724 - accuracy50: 0.5828 - val_loss: 2.9517 - val_accuracy50: 0.5650 - 34s/epoch - 23ms/step
Epoch 9/50
1504/1504 - 34s - loss: 2.5661 - accuracy50: 0.5841 - val_loss: 2.9667 - val_accuracy50: 0.5644 - 34s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 2.5613 - accuracy50: 0.5852 - val_loss: 2.9547 - val_accuracy50: 0.5665 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 34s - loss: 2.5546 - accuracy50: 0.5861 - val_loss: 2.9623 - val_accuracy50: 0.5647 - 34s/epoch - 23ms/step
Epoch 12/50
1504/1504 - 34s - loss: 2.5485 - accuracy50: 0.5873 - val_loss: 2.9898 - val_accuracy50: 0.5613 - 34s/epoch - 23ms/step
Epoch 13/50
1504/1504 - 34s - loss: 2.5427 - accuracy50: 0.5882 - val_loss: 2.9965 - val_accuracy50: 0.5631 - 34s/epoch - 22ms/step
Epoch 14/50
1504/1504 - 34s - loss: 2.5357 - accuracy50: 0.5898 - val_loss: 2.9795 - val_accuracy50: 0.5623 - 34s/epoch - 23ms/step
Epoch 15/50
1504/1504 - 34s - loss: 2.5323 - accuracy50: 0.5897 - val_loss: 2.9826 - val_accuracy50: 0.5614 - 34s/epoch - 23ms/step
testing model: results/EXC/W6/deepOF_L2/h50
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9388097
{'0': {'precision': 0.5327330675110968, 'recall': 0.4568394691002504, 'f1-score': 0.4918760024754038, 'support': 341006}, '1': {'precision': 0.5326610856515659, 'recall': 0.8007291193394883, 'f1-score': 0.6397485753587873, 'support': 460007}, '2': {'precision': 0.6100567731458509, 'recall': 0.27999751554999514, 'f1-score': 0.3838291281660389, 'support': 338103}, 'accuracy': 0.5432229904592684, 'macro avg': {'precision': 0.5584836421028379, 'recall': 0.5125220346632446, 'f1-score': 0.50515123533341, 'support': 1139116}, 'weighted avg': {'precision': 0.5556545826921407, 'recall': 0.5432229904592684, 'f1-score': 0.5195215155660349, 'support': 1139116}}
[[155785 146434  38787]
 [ 69942 368341  21724]
 [ 66699 176736  94668]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88791335
{'0': {'precision': 0.538538307065052, 'recall': 0.43184923485321675, 'f1-score': 0.4793288161664743, 'support': 102464}, '1': {'precision': 0.5801704075098012, 'recall': 0.8254461210249117, 'f1-score': 0.6814083396011814, 'support': 179996}, '2': {'precision': 0.6365413113979511, 'recall': 0.28955235545829344, 'f1-score': 0.3980418885434364, 'support': 102358}, 'accuracy': 0.5781018559422896, 'macro avg': {'precision': 0.5850833419909348, 'recall': 0.5156159037788073, 'f1-score': 0.5195930147703641, 'support': 384818}, 'weighted avg': {'precision': 0.584079324037127, 'recall': 0.5781018559422896, 'f1-score': 0.5522285728371982, 'support': 384818}}
[[ 44249  49604   8611]
 [ 23107 148577   8312]
 [ 14809  57911  29638]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9044505
{'0': {'precision': 0.5218996237665933, 'recall': 0.43249602917818697, 'f1-score': 0.4730103583606768, 'support': 33998}, '1': {'precision': 0.5703640745613524, 'recall': 0.7981491438160875, 'f1-score': 0.6652995260277321, 'support': 61377}, '2': {'precision': 0.5853599221789884, 'recall': 0.2740209471766849, 'f1-score': 0.3732940446650125, 'support': 35136}, 'accuracy': 0.5617917263678923, 'macro avg': {'precision': 0.5592078735023113, 'recall': 0.5015553733903197, 'f1-score': 0.5038679763511404, 'support': 130511}, 'weighted avg': {'precision': 0.5617762904188129, 'recall': 0.5617917263678923, 'f1-score': 0.5365950358659446, 'support': 130511}}
[[14704 16573  2721]
 [ 8290 48988  4099]
 [ 5180 20328  9628]]
training model: results/EXC/W6/deepOF_L2/h100
Epoch 1/50
1504/1504 - 36s - loss: 3.1079 - accuracy100: 0.4463 - val_loss: 3.2196 - val_accuracy100: 0.4227 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 34s - loss: 2.9738 - accuracy100: 0.4901 - val_loss: 3.1952 - val_accuracy100: 0.4306 - 34s/epoch - 22ms/step
Epoch 3/50
1504/1504 - 34s - loss: 2.9352 - accuracy100: 0.5006 - val_loss: 3.1714 - val_accuracy100: 0.4407 - 34s/epoch - 23ms/step
Epoch 4/50
1504/1504 - 34s - loss: 2.9171 - accuracy100: 0.5049 - val_loss: 3.1702 - val_accuracy100: 0.4400 - 34s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 34s - loss: 2.9076 - accuracy100: 0.5062 - val_loss: 3.1690 - val_accuracy100: 0.4410 - 34s/epoch - 23ms/step
Epoch 6/50
1504/1504 - 35s - loss: 2.8986 - accuracy100: 0.5087 - val_loss: 3.1747 - val_accuracy100: 0.4426 - 35s/epoch - 23ms/step
Epoch 7/50
1504/1504 - 35s - loss: 2.8925 - accuracy100: 0.5100 - val_loss: 3.1564 - val_accuracy100: 0.4431 - 35s/epoch - 23ms/step
Epoch 8/50
1504/1504 - 35s - loss: 2.8878 - accuracy100: 0.5108 - val_loss: 3.1657 - val_accuracy100: 0.4437 - 35s/epoch - 23ms/step
Epoch 9/50
1504/1504 - 34s - loss: 2.8825 - accuracy100: 0.5123 - val_loss: 3.1597 - val_accuracy100: 0.4452 - 34s/epoch - 23ms/step
Epoch 10/50
1504/1504 - 34s - loss: 2.8782 - accuracy100: 0.5138 - val_loss: 3.1568 - val_accuracy100: 0.4456 - 34s/epoch - 23ms/step
Epoch 11/50
1504/1504 - 34s - loss: 2.8730 - accuracy100: 0.5159 - val_loss: 3.1569 - val_accuracy100: 0.4464 - 34s/epoch - 23ms/step
Epoch 12/50
1504/1504 - 34s - loss: 2.8692 - accuracy100: 0.5169 - val_loss: 3.1576 - val_accuracy100: 0.4486 - 34s/epoch - 23ms/step
Epoch 13/50
1504/1504 - 34s - loss: 2.8648 - accuracy100: 0.5182 - val_loss: 3.1587 - val_accuracy100: 0.4480 - 34s/epoch - 23ms/step
Epoch 14/50
1504/1504 - 34s - loss: 2.8603 - accuracy100: 0.5190 - val_loss: 3.1669 - val_accuracy100: 0.4486 - 34s/epoch - 23ms/step
Epoch 15/50
1504/1504 - 34s - loss: 2.8557 - accuracy100: 0.5207 - val_loss: 3.1513 - val_accuracy100: 0.4505 - 34s/epoch - 23ms/step
Epoch 16/50
1504/1504 - 34s - loss: 2.8515 - accuracy100: 0.5221 - val_loss: 3.1789 - val_accuracy100: 0.4503 - 34s/epoch - 23ms/step
Epoch 17/50
1504/1504 - 34s - loss: 2.8458 - accuracy100: 0.5226 - val_loss: 3.1790 - val_accuracy100: 0.4485 - 34s/epoch - 23ms/step
Epoch 18/50
1504/1504 - 34s - loss: 2.8408 - accuracy100: 0.5243 - val_loss: 3.1868 - val_accuracy100: 0.4495 - 34s/epoch - 22ms/step
Epoch 19/50
1504/1504 - 34s - loss: 2.8345 - accuracy100: 0.5257 - val_loss: 3.1886 - val_accuracy100: 0.4512 - 34s/epoch - 22ms/step
Epoch 20/50
1504/1504 - 34s - loss: 2.8284 - accuracy100: 0.5279 - val_loss: 3.2471 - val_accuracy100: 0.4493 - 34s/epoch - 22ms/step
Epoch 21/50
1504/1504 - 34s - loss: 2.8233 - accuracy100: 0.5300 - val_loss: 3.2107 - val_accuracy100: 0.4485 - 34s/epoch - 23ms/step
Epoch 22/50
1504/1504 - 33s - loss: 2.8157 - accuracy100: 0.5313 - val_loss: 3.2133 - val_accuracy100: 0.4554 - 33s/epoch - 22ms/step
Epoch 23/50
1504/1504 - 33s - loss: 2.8094 - accuracy100: 0.5326 - val_loss: 3.2646 - val_accuracy100: 0.4490 - 33s/epoch - 22ms/step
Epoch 24/50
1504/1504 - 34s - loss: 2.8028 - accuracy100: 0.5353 - val_loss: 3.2361 - val_accuracy100: 0.4508 - 34s/epoch - 22ms/step
Epoch 25/50
1504/1504 - 34s - loss: 2.7938 - accuracy100: 0.5374 - val_loss: 3.3065 - val_accuracy100: 0.4469 - 34s/epoch - 23ms/step
testing model: results/EXC/W6/deepOF_L2/h100
Evaluating performance on  test set...
4450/4450 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0684115
{'0': {'precision': 0.548401075969876, 'recall': 0.34459343430626493, 'f1-score': 0.42323980264396815, 'support': 407634}, '1': {'precision': 0.3620708943515358, 'recall': 0.8129924395593623, 'f1-score': 0.5010128240706655, 'support': 326436}, '2': {'precision': 0.5882584318353034, 'recall': 0.21784439298252545, 'f1-score': 0.3179465374754749, 'support': 405046}, 'accuracy': 0.4337530154962269, 'macro avg': {'precision': 0.49957680071890503, 'recall': 0.4584767556160509, 'f1-score': 0.4140663880633695, 'support': 1139116}, 'weighted avg': {'precision': 0.5091769613029794, 'recall': 0.4337530154962269, 'f1-score': 0.4080870860979868, 'support': 1139116}}
[[140468 225603  41563]
 [ 40849 265390  20197]
 [ 74824 241985  88237]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0354849
{'0': {'precision': 0.5762603886137897, 'recall': 0.3088719190414106, 'f1-score': 0.4021786360283344, 'support': 128856}, '1': {'precision': 0.40035936949035555, 'recall': 0.8438718145374902, 'f1-score': 0.5430694744447921, 'support': 126473}, '2': {'precision': 0.6264692723797128, 'recall': 0.2379043779780522, 'f1-score': 0.3448503607350151, 'support': 129489}, 'accuracy': 0.4608230384233586, 'macro avg': {'precision': 0.5343630101612861, 'recall': 0.46354937051898437, 'f1-score': 0.4300328237360472, 'support': 384818}, 'weighted avg': {'precision': 0.5353443414391968, 'recall': 0.4608230384233586, 'f1-score': 0.4291927205243508, 'support': 384818}}
[[ 39800  78301  10755]
 [ 12133 106727   7613]
 [ 17133  81550  30806]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0534075
{'0': {'precision': 0.5446614909424827, 'recall': 0.3120202768943832, 'f1-score': 0.39675276303987594, 'support': 41821}, '1': {'precision': 0.4006153846153846, 'recall': 0.8056386832572059, 'f1-score': 0.5351298031654934, 'support': 44443}, '2': {'precision': 0.5748049831179416, 'recall': 0.22315637218342488, 'f1-score': 0.32149776149776155, 'support': 44247}, 'accuracy': 0.44998505873068173, 'macro avg': {'precision': 0.5066939528919363, 'recall': 0.44693844411167133, 'f1-score': 0.4177934425677103, 'support': 130511}, 'weighted avg': {'precision': 0.5058288867542712, 'recall': 0.44998505873068173, 'f1-score': 0.4183607711086892, 'support': 130511}}
[[13049 25356  3416]
 [ 4750 35805  3888]
 [ 6159 28214  9874]]
training model: results/EXC/W6/deepOF_L2/h200
Epoch 1/50
1504/1504 - 36s - loss: 3.2509 - accuracy200: 0.3909 - val_loss: 3.2496 - val_accuracy200: 0.3790 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 33s - loss: 3.2082 - accuracy200: 0.4134 - val_loss: 3.2404 - val_accuracy200: 0.3799 - 33s/epoch - 22ms/step
Epoch 3/50
1504/1504 - 33s - loss: 3.1911 - accuracy200: 0.4216 - val_loss: 3.2353 - val_accuracy200: 0.3832 - 33s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 33s - loss: 3.1791 - accuracy200: 0.4270 - val_loss: 3.2362 - val_accuracy200: 0.3814 - 33s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 33s - loss: 3.1706 - accuracy200: 0.4302 - val_loss: 3.2371 - val_accuracy200: 0.3861 - 33s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 33s - loss: 3.1666 - accuracy200: 0.4316 - val_loss: 3.2361 - val_accuracy200: 0.3868 - 33s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 33s - loss: 3.1617 - accuracy200: 0.4338 - val_loss: 3.2333 - val_accuracy200: 0.3895 - 33s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 33s - loss: 3.1581 - accuracy200: 0.4353 - val_loss: 3.2359 - val_accuracy200: 0.3883 - 33s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 34s - loss: 3.1539 - accuracy200: 0.4374 - val_loss: 3.2394 - val_accuracy200: 0.3877 - 34s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 3.1505 - accuracy200: 0.4387 - val_loss: 3.2357 - val_accuracy200: 0.3910 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 33s - loss: 3.1463 - accuracy200: 0.4396 - val_loss: 3.2382 - val_accuracy200: 0.3920 - 33s/epoch - 22ms/step
Epoch 12/50
1504/1504 - 34s - loss: 3.1433 - accuracy200: 0.4402 - val_loss: 3.2458 - val_accuracy200: 0.3908 - 34s/epoch - 22ms/step
Epoch 13/50
1504/1504 - 34s - loss: 3.1400 - accuracy200: 0.4420 - val_loss: 3.2454 - val_accuracy200: 0.3898 - 34s/epoch - 23ms/step
Epoch 14/50
1504/1504 - 34s - loss: 3.1363 - accuracy200: 0.4434 - val_loss: 3.2454 - val_accuracy200: 0.3927 - 34s/epoch - 22ms/step
Epoch 15/50
1504/1504 - 33s - loss: 3.1328 - accuracy200: 0.4453 - val_loss: 3.2505 - val_accuracy200: 0.3904 - 33s/epoch - 22ms/step
Epoch 16/50
1504/1504 - 34s - loss: 3.1277 - accuracy200: 0.4468 - val_loss: 3.2569 - val_accuracy200: 0.3903 - 34s/epoch - 23ms/step
Epoch 17/50
1504/1504 - 34s - loss: 3.1237 - accuracy200: 0.4485 - val_loss: 3.2583 - val_accuracy200: 0.3930 - 34s/epoch - 23ms/step
testing model: results/EXC/W6/deepOF_L2/h200
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0874398
{'0': {'precision': 0.4630901922650065, 'recall': 0.23034478770162561, 'f1-score': 0.3076580071836609, 'support': 380408}, '1': {'precision': 0.3408076859235917, 'recall': 0.7116544105284668, 'f1-score': 0.46089506433939775, 'support': 386609}, '2': {'precision': 0.449019662842557, 'recall': 0.17208323591302316, 'f1-score': 0.24881145048697986, 'support': 372099}, 'accuracy': 0.37466684692340374, 'macro avg': {'precision': 0.41763918034371833, 'recall': 0.3713608113810385, 'f1-score': 0.3391215073366795, 'support': 1139116}, 'weighted avg': {'precision': 0.416992035956332, 'recall': 0.37466684692340374, 'f1-score': 0.34044314981149154, 'support': 1139116}}
[[ 87625 267417  25366]
 [ 58271 275132  53206]
 [ 43322 264745  64032]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0974008
{'0': {'precision': 0.4779465688842326, 'recall': 0.21154158262038905, 'f1-score': 0.2932771893733627, 'support': 129393}, '1': {'precision': 0.33008487442344675, 'recall': 0.7272930007327407, 'f1-score': 0.45408254599701636, 'support': 125556}, '2': {'precision': 0.5018466132327518, 'recall': 0.19670591134142867, 'f1-score': 0.2826307025938608, 'support': 129869}, 'accuracy': 0.37481094959175504, 'macro avg': {'precision': 0.43662601884681046, 'recall': 0.3785134982315195, 'f1-score': 0.34333014598808, 'support': 384818}, 'weighted avg': {'precision': 0.4377690094919469, 'recall': 0.37481094959175504, 'f1-score': 0.34215075756578706, 'support': 384818}}
[[27372 92769  9252]
 [18134 91316 16106]
 [11764 92559 25546]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079141
{'0': {'precision': 0.44421041816500567, 'recall': 0.21635349163059525, 'f1-score': 0.2909831238537513, 'support': 39967}, '1': {'precision': 0.3598444983784016, 'recall': 0.7130423680122572, 'f1-score': 0.47830648557215355, 'support': 46993}, '2': {'precision': 0.47079823729569925, 'recall': 0.19379577966062778, 'f1-score': 0.27456976479391004, 'support': 43551}, 'accuracy': 0.3876684723893005, 'macro avg': {'precision': 0.4249510512797022, 'recall': 0.3743972131011601, 'f1-score': 0.34795312473993834, 'support': 130511}, 'weighted avg': {'precision': 0.4227050925022566, 'recall': 0.3876684723893005, 'f1-score': 0.35295543681448055, 'support': 130511}}
[[ 8647 28474  2846]
 [ 6844 33508  6641]
 [ 3975 31136  8440]]
training model: results/EXC/W6/deepOF_L2/h300
Epoch 1/50
1504/1504 - 37s - loss: 3.2729 - accuracy300: 0.3801 - val_loss: 3.2499 - val_accuracy300: 0.3854 - 37s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 34s - loss: 3.2430 - accuracy300: 0.3981 - val_loss: 3.2397 - val_accuracy300: 0.3912 - 34s/epoch - 23ms/step
Epoch 3/50
1504/1504 - 34s - loss: 3.2298 - accuracy300: 0.4064 - val_loss: 3.2323 - val_accuracy300: 0.3964 - 34s/epoch - 23ms/step
Epoch 4/50
1504/1504 - 34s - loss: 3.2201 - accuracy300: 0.4120 - val_loss: 3.2275 - val_accuracy300: 0.3989 - 34s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 34s - loss: 3.2133 - accuracy300: 0.4146 - val_loss: 3.2243 - val_accuracy300: 0.4013 - 34s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 34s - loss: 3.2081 - accuracy300: 0.4182 - val_loss: 3.2238 - val_accuracy300: 0.4032 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 34s - loss: 3.2034 - accuracy300: 0.4206 - val_loss: 3.2234 - val_accuracy300: 0.4043 - 34s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 33s - loss: 3.1998 - accuracy300: 0.4223 - val_loss: 3.2235 - val_accuracy300: 0.4054 - 33s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 34s - loss: 3.1951 - accuracy300: 0.4246 - val_loss: 3.2293 - val_accuracy300: 0.4034 - 34s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 3.1926 - accuracy300: 0.4262 - val_loss: 3.2259 - val_accuracy300: 0.4047 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 34s - loss: 3.1867 - accuracy300: 0.4294 - val_loss: 3.2462 - val_accuracy300: 0.4011 - 34s/epoch - 23ms/step
Epoch 12/50
1504/1504 - 34s - loss: 3.1838 - accuracy300: 0.4307 - val_loss: 3.2560 - val_accuracy300: 0.3959 - 34s/epoch - 22ms/step
Epoch 13/50
1504/1504 - 34s - loss: 3.1785 - accuracy300: 0.4329 - val_loss: 3.2759 - val_accuracy300: 0.3954 - 34s/epoch - 22ms/step
Epoch 14/50
1504/1504 - 34s - loss: 3.1755 - accuracy300: 0.4348 - val_loss: 3.2813 - val_accuracy300: 0.3929 - 34s/epoch - 22ms/step
Epoch 15/50
1504/1504 - 33s - loss: 3.1694 - accuracy300: 0.4371 - val_loss: 3.2800 - val_accuracy300: 0.3970 - 33s/epoch - 22ms/step
Epoch 16/50
1504/1504 - 33s - loss: 3.1650 - accuracy300: 0.4396 - val_loss: 3.3043 - val_accuracy300: 0.3909 - 33s/epoch - 22ms/step
Epoch 17/50
1504/1504 - 34s - loss: 3.1593 - accuracy300: 0.4416 - val_loss: 3.3392 - val_accuracy300: 0.3894 - 34s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h300
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0878813
{'0': {'precision': 0.4297507331860927, 'recall': 0.3323829138334407, 'f1-score': 0.3748471189457667, 'support': 392809}, '1': {'precision': 0.3512395218440534, 'recall': 0.37917625934942334, 'f1-score': 0.36467363235469386, 'support': 363124}, '2': {'precision': 0.40588180889196684, 'recall': 0.4695589313722164, 'f1-score': 0.435404521816567, 'support': 383183}, 'accuracy': 0.39344368791238116, 'macro avg': {'precision': 0.39562402130737095, 'recall': 0.3937060348516935, 'f1-score': 0.3916417577056759, 'support': 1139116}, 'weighted avg': {'precision': 0.3966939846853581, 'recall': 0.39344368791238116, 'f1-score': 0.3919747250537883, 'support': 1139116}}
[[130563 132485 129761]
 [ 91825 137688 133611]
 [ 81423 121833 179927]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0780244
{'0': {'precision': 0.43713829887071043, 'recall': 0.3259343342067003, 'f1-score': 0.3734333383810941, 'support': 128621}, '1': {'precision': 0.3727813882365791, 'recall': 0.3758337528316134, 'f1-score': 0.37430134775745855, 'support': 127136}, '2': {'precision': 0.4143337066069429, 'recall': 0.5160350531919015, 'f1-score': 0.45962574318239063, 'support': 129061}, 'accuracy': 0.40617642625864697, 'macro avg': {'precision': 0.4080844645714108, 'recall': 0.4059343800767384, 'f1-score': 0.40245347644031443, 'support': 384818}, 'weighted avg': {'precision': 0.40822784335008766, 'recall': 0.40617642625864697, 'f1-score': 0.4026274852144896, 'support': 384818}}
[[41922 42002 44697]
 [29911 47782 49443]
 [24068 38393 66600]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0745162
{'0': {'precision': 0.4039890981169475, 'recall': 0.3281839681980577, 'f1-score': 0.3621623122414415, 'support': 39746}, '1': {'precision': 0.3896748805396796, 'recall': 0.35993076590220685, 'f1-score': 0.37421270469677886, 'support': 46220}, '2': {'precision': 0.41636203201815203, 'recall': 0.5190481535525873, 'f1-score': 0.46206882769095486, 'support': 44545}, 'accuracy': 0.40457126219245887, 'macro avg': {'precision': 0.4033420035582597, 'recall': 0.4023876292176172, 'f1-score': 0.3994812815430584, 'support': 130511}, 'weighted avg': {'precision': 0.40314280320087015, 'recall': 0.40457126219245887, 'f1-score': 0.40052923050874667, 'support': 130511}}
[[13044 12969 13733]
 [10907 16636 18677]
 [ 8337 13087 23121]]
training model: results/EXC/W6/deepOF_L2/h500
Epoch 1/50
1504/1504 - 36s - loss: 3.2605 - accuracy500: 0.3981 - val_loss: 3.3549 - val_accuracy500: 0.3037 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 34s - loss: 3.2456 - accuracy500: 0.4041 - val_loss: 3.3529 - val_accuracy500: 0.3063 - 34s/epoch - 22ms/step
Epoch 3/50
1504/1504 - 34s - loss: 3.2430 - accuracy500: 0.4037 - val_loss: 3.3262 - val_accuracy500: 0.3073 - 34s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 33s - loss: 3.2419 - accuracy500: 0.4044 - val_loss: 3.3035 - val_accuracy500: 0.3106 - 33s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 33s - loss: 3.2379 - accuracy500: 0.4062 - val_loss: 3.2932 - val_accuracy500: 0.3115 - 33s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 34s - loss: 3.2339 - accuracy500: 0.4073 - val_loss: 3.2909 - val_accuracy500: 0.3126 - 34s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 34s - loss: 3.2317 - accuracy500: 0.4093 - val_loss: 3.2941 - val_accuracy500: 0.3119 - 34s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 34s - loss: 3.2293 - accuracy500: 0.4105 - val_loss: 3.2844 - val_accuracy500: 0.3137 - 34s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 33s - loss: 3.2268 - accuracy500: 0.4114 - val_loss: 3.2847 - val_accuracy500: 0.3146 - 33s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 34s - loss: 3.2239 - accuracy500: 0.4129 - val_loss: 3.2895 - val_accuracy500: 0.3142 - 34s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 34s - loss: 3.2225 - accuracy500: 0.4132 - val_loss: 3.2815 - val_accuracy500: 0.3186 - 34s/epoch - 22ms/step
Epoch 12/50
1504/1504 - 33s - loss: 3.2188 - accuracy500: 0.4166 - val_loss: 3.2873 - val_accuracy500: 0.3151 - 33s/epoch - 22ms/step
Epoch 13/50
1504/1504 - 33s - loss: 3.2175 - accuracy500: 0.4169 - val_loss: 3.2906 - val_accuracy500: 0.3163 - 33s/epoch - 22ms/step
Epoch 14/50
1504/1504 - 33s - loss: 3.2169 - accuracy500: 0.4166 - val_loss: 3.2808 - val_accuracy500: 0.3170 - 33s/epoch - 22ms/step
Epoch 15/50
1504/1504 - 33s - loss: 3.2139 - accuracy500: 0.4188 - val_loss: 3.2778 - val_accuracy500: 0.3184 - 33s/epoch - 22ms/step
Epoch 16/50
1504/1504 - 33s - loss: 3.2129 - accuracy500: 0.4194 - val_loss: 3.2867 - val_accuracy500: 0.3175 - 33s/epoch - 22ms/step
Epoch 17/50
1504/1504 - 33s - loss: 3.2097 - accuracy500: 0.4209 - val_loss: 3.2858 - val_accuracy500: 0.3191 - 33s/epoch - 22ms/step
Epoch 18/50
1504/1504 - 33s - loss: 3.2059 - accuracy500: 0.4232 - val_loss: 3.2906 - val_accuracy500: 0.3168 - 33s/epoch - 22ms/step
Epoch 19/50
1504/1504 - 33s - loss: 3.2030 - accuracy500: 0.4251 - val_loss: 3.2985 - val_accuracy500: 0.3141 - 33s/epoch - 22ms/step
Epoch 20/50
1504/1504 - 33s - loss: 3.1997 - accuracy500: 0.4279 - val_loss: 3.3142 - val_accuracy500: 0.3134 - 33s/epoch - 22ms/step
Epoch 21/50
1504/1504 - 33s - loss: 3.1955 - accuracy500: 0.4292 - val_loss: 3.3133 - val_accuracy500: 0.3145 - 33s/epoch - 22ms/step
Epoch 22/50
1504/1504 - 33s - loss: 3.1923 - accuracy500: 0.4307 - val_loss: 3.3140 - val_accuracy500: 0.3148 - 33s/epoch - 22ms/step
Epoch 23/50
1504/1504 - 33s - loss: 3.1892 - accuracy500: 0.4326 - val_loss: 3.3175 - val_accuracy500: 0.3180 - 33s/epoch - 22ms/step
Epoch 24/50
1504/1504 - 34s - loss: 3.1849 - accuracy500: 0.4346 - val_loss: 3.3225 - val_accuracy500: 0.3170 - 34s/epoch - 22ms/step
Epoch 25/50
1504/1504 - 33s - loss: 3.1820 - accuracy500: 0.4356 - val_loss: 3.3304 - val_accuracy500: 0.3170 - 33s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h500
Evaluating performance on  test set...
4450/4450 - 34s - 34s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978914
{'0': {'precision': 0.28648553432770446, 'recall': 0.4341875038331247, 'f1-score': 0.34520075664683264, 'support': 277189}, '1': {'precision': 0.45085500973631176, 'recall': 0.09062907562479382, 'f1-score': 0.15092067847556478, 'support': 585033}, '2': {'precision': 0.2556046802800719, 'recall': 0.5551763490722081, 'f1-score': 0.35004685128616175, 'support': 276894}, 'accuracy': 0.2871507379406487, 'macro avg': {'precision': 0.33098174144802933, 'recall': 0.35999764284337554, 'f1-score': 0.2820560954695197, 'support': 1139116}, 'weighted avg': {'precision': 0.36339679192224145, 'recall': 0.2871507379406487, 'f1-score': 0.24659938291166522, 'support': 1139116}}
[[120352  31988 124849]
 [209169  53021 322843]
 [ 90577  32592 153725]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0902596
{'0': {'precision': 0.4002576414100012, 'recall': 0.4000733549756524, 'f1-score': 0.4001654769756741, 'support': 128144}, '1': {'precision': 0.3966810887781368, 'recall': 0.11345729099766601, 'f1-score': 0.1764476601135229, 'support': 127678}, '2': {'precision': 0.37583270894353243, 'recall': 0.6416012899624794, 'f1-score': 0.4740056871060762, 'support': 128996}, 'accuracy': 0.38594088634107554, 'macro avg': {'precision': 0.3909238130438901, 'recall': 0.38504397864526596, 'f1-score': 0.35020627473175775, 'support': 384818}, 'weighted avg': {'precision': 0.39088342898912753, 'recall': 0.38594088634107554, 'f1-score': 0.35069078588704417, 'support': 384818}}
[[51267 11037 65840]
 [41581 14486 71611]
 [35237 10995 82764]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0912347
{'0': {'precision': 0.2912151103640465, 'recall': 0.411481608800275, 'f1-score': 0.34105655783352545, 'support': 31999}, '1': {'precision': 0.46920797629534716, 'recall': 0.09409931902865219, 'f1-score': 0.1567604446763254, 'support': 62264}, '2': {'precision': 0.3086114544705398, 'recall': 0.6198962701390421, 'f1-score': 0.4120743090832401, 'support': 36248}, 'accuracy': 0.3179502110933178, 'macro avg': {'precision': 0.3563448470433112, 'recall': 0.3751590659893231, 'f1-score': 0.30329710386436365, 'support': 130511}, 'weighted avg': {'precision': 0.38096333454069575, 'recall': 0.3179502110933178, 'f1-score': 0.27285723561302105, 'support': 130511}}
[[13167  3161 15671]
 [21736  5859 34669]
 [10311  3467 22470]]
training model: results/EXC/W6/deepOF_L2/h1000
Epoch 1/50
1504/1504 - 36s - loss: 3.2666 - accuracy1000: 0.3921 - val_loss: 3.2762 - val_accuracy1000: 0.4050 - 36s/epoch - 24ms/step
Epoch 2/50
1504/1504 - 33s - loss: 3.2526 - accuracy1000: 0.3905 - val_loss: 3.2663 - val_accuracy1000: 0.4057 - 33s/epoch - 22ms/step
Epoch 3/50
1504/1504 - 33s - loss: 3.2475 - accuracy1000: 0.3891 - val_loss: 3.2744 - val_accuracy1000: 0.4058 - 33s/epoch - 22ms/step
Epoch 4/50
1504/1504 - 33s - loss: 3.2423 - accuracy1000: 0.3921 - val_loss: 3.2774 - val_accuracy1000: 0.4065 - 33s/epoch - 22ms/step
Epoch 5/50
1504/1504 - 33s - loss: 3.2377 - accuracy1000: 0.3952 - val_loss: 3.2795 - val_accuracy1000: 0.4063 - 33s/epoch - 22ms/step
Epoch 6/50
1504/1504 - 33s - loss: 3.2328 - accuracy1000: 0.3985 - val_loss: 3.2782 - val_accuracy1000: 0.4069 - 33s/epoch - 22ms/step
Epoch 7/50
1504/1504 - 33s - loss: 3.2296 - accuracy1000: 0.4014 - val_loss: 3.2776 - val_accuracy1000: 0.4069 - 33s/epoch - 22ms/step
Epoch 8/50
1504/1504 - 33s - loss: 3.2280 - accuracy1000: 0.4028 - val_loss: 3.2797 - val_accuracy1000: 0.4064 - 33s/epoch - 22ms/step
Epoch 9/50
1504/1504 - 33s - loss: 3.2269 - accuracy1000: 0.4041 - val_loss: 3.2791 - val_accuracy1000: 0.4059 - 33s/epoch - 22ms/step
Epoch 10/50
1504/1504 - 33s - loss: 3.2243 - accuracy1000: 0.4061 - val_loss: 3.2750 - val_accuracy1000: 0.4058 - 33s/epoch - 22ms/step
Epoch 11/50
1504/1504 - 33s - loss: 3.2213 - accuracy1000: 0.4083 - val_loss: 3.2748 - val_accuracy1000: 0.4058 - 33s/epoch - 22ms/step
Epoch 12/50
1504/1504 - 33s - loss: 3.2187 - accuracy1000: 0.4103 - val_loss: 3.2727 - val_accuracy1000: 0.4064 - 33s/epoch - 22ms/step
testing model: results/EXC/W6/deepOF_L2/h1000
Evaluating performance on  test set...
4450/4450 - 33s - 33s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0879935
{'0': {'precision': 0.3703985041486502, 'recall': 0.037205071017725085, 'f1-score': 0.067618163781241, 'support': 340760}, '1': {'precision': 0.41762796580467215, 'recall': 0.9478289439554549, 'f1-score': 0.5797910881925162, 'support': 462632}, '2': {'precision': 0.37884195193008013, 'recall': 0.06197352587244284, 'f1-score': 0.10652153879235315, 'support': 335724}, 'accuracy': 0.4143388381868045, 'macro avg': {'precision': 0.3889561406278008, 'recall': 0.34900251361520757, 'f1-score': 0.25131026358870345, 'support': 1139116}, 'weighted avg': {'precision': 0.3920684028840042, 'recall': 0.4143388381868045, 'f1-score': 0.28709395117994996, 'support': 1139116}}
[[ 12678 308494  19588]
 [  9610 438496  14526]
 [ 11940 302978  20806]]
Evaluating performance on  train set...
1504/1504 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1377536
{'0': {'precision': 0.37203670660209026, 'recall': 0.022960748839770315, 'f1-score': 0.043252133712660026, 'support': 127130}, '1': {'precision': 0.33489000184269946, 'recall': 0.9547275735265291, 'f1-score': 0.4958504365389627, 'support': 127539}, '2': {'precision': 0.38586915887850465, 'recall': 0.03965454978524614, 'f1-score': 0.07191828544354952, 'support': 130149}, 'accuracy': 0.3374192475403957, 'macro avg': {'precision': 0.36426528910776473, 'recall': 0.33911429071718185, 'f1-score': 0.20367361856505742, 'support': 384818}, 'weighted avg': {'precision': 0.3644035560036648, 'recall': 0.3374192475403957, 'f1-score': 0.20295050002033624, 'support': 384818}}
[[  2919 119545   4666]
 [  2226 121765   3548]
 [  2701 122287   5161]]
Evaluating performance on  val set...
510/510 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0898162
{'0': {'precision': 0.32445690259285215, 'recall': 0.026905308423162973, 'f1-score': 0.04969010759035175, 'support': 34417}, '1': {'precision': 0.4075793731041456, 'recall': 0.9587662214103588, 'f1-score': 0.5719977976943904, 'support': 52554}, '2': {'precision': 0.4020337301587302, 'recall': 0.03723013321084061, 'f1-score': 0.06814933153956108, 'support': 43540}, 'accuracy': 0.4055903333818605, 'macro avg': {'precision': 0.3780233352852427, 'recall': 0.34096722101478744, 'f1-score': 0.22994574560810108, 'support': 130511}, 'weighted avg': {'precision': 0.3838090904350176, 'recall': 0.4055903333818605, 'f1-score': 0.2661705035452998, 'support': 130511}}
[[  926 32343  1148]
 [  904 50387  1263]
 [ 1024 40895  1621]]
training model: results/EXC/W6/deepVOL_L2/h10
Epoch 1/50
1504/1504 - 39s - loss: 2.4184 - accuracy10: 0.5734 - val_loss: 2.3126 - val_accuracy10: 0.6766 - 39s/epoch - 26ms/step
Epoch 2/50
1504/1504 - 36s - loss: 2.2185 - accuracy10: 0.6240 - val_loss: 2.2831 - val_accuracy10: 0.7115 - 36s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 38s - loss: 2.1600 - accuracy10: 0.6412 - val_loss: 2.2973 - val_accuracy10: 0.7201 - 38s/epoch - 25ms/step
Epoch 4/50
1504/1504 - 36s - loss: 2.1332 - accuracy10: 0.6480 - val_loss: 2.3101 - val_accuracy10: 0.7175 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 36s - loss: 2.1153 - accuracy10: 0.6529 - val_loss: 2.2849 - val_accuracy10: 0.7114 - 36s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 36s - loss: 2.1027 - accuracy10: 0.6545 - val_loss: 2.2860 - val_accuracy10: 0.7128 - 36s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 36s - loss: 2.0932 - accuracy10: 0.6557 - val_loss: 2.3088 - val_accuracy10: 0.7167 - 36s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 36s - loss: 2.0835 - accuracy10: 0.6581 - val_loss: 2.2972 - val_accuracy10: 0.7207 - 36s/epoch - 24ms/step
Epoch 9/50
1504/1504 - 36s - loss: 2.0758 - accuracy10: 0.6588 - val_loss: 2.2847 - val_accuracy10: 0.7089 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 36s - loss: 2.0645 - accuracy10: 0.6597 - val_loss: 2.2679 - val_accuracy10: 0.7121 - 36s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 36s - loss: 2.0559 - accuracy10: 0.6610 - val_loss: 2.2648 - val_accuracy10: 0.7101 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 36s - loss: 2.0485 - accuracy10: 0.6615 - val_loss: 2.2573 - val_accuracy10: 0.7163 - 36s/epoch - 24ms/step
Epoch 13/50
1504/1504 - 37s - loss: 2.0424 - accuracy10: 0.6617 - val_loss: 2.2456 - val_accuracy10: 0.7102 - 37s/epoch - 24ms/step
Epoch 14/50
1504/1504 - 36s - loss: 2.0361 - accuracy10: 0.6621 - val_loss: 2.2426 - val_accuracy10: 0.7091 - 36s/epoch - 24ms/step
Epoch 15/50
1504/1504 - 37s - loss: 2.0300 - accuracy10: 0.6630 - val_loss: 2.2345 - val_accuracy10: 0.7122 - 37s/epoch - 25ms/step
Epoch 16/50
1504/1504 - 37s - loss: 2.0220 - accuracy10: 0.6638 - val_loss: 2.2587 - val_accuracy10: 0.7204 - 37s/epoch - 25ms/step
Epoch 17/50
1504/1504 - 37s - loss: 2.0179 - accuracy10: 0.6631 - val_loss: 2.2375 - val_accuracy10: 0.7148 - 37s/epoch - 24ms/step
Epoch 18/50
1504/1504 - 36s - loss: 2.0118 - accuracy10: 0.6649 - val_loss: 2.2418 - val_accuracy10: 0.7141 - 36s/epoch - 24ms/step
Epoch 19/50
1504/1504 - 36s - loss: 2.0070 - accuracy10: 0.6656 - val_loss: 2.2308 - val_accuracy10: 0.7134 - 36s/epoch - 24ms/step
Epoch 20/50
1504/1504 - 37s - loss: 2.0023 - accuracy10: 0.6661 - val_loss: 2.2198 - val_accuracy10: 0.7160 - 37s/epoch - 24ms/step
Epoch 21/50
1504/1504 - 38s - loss: 1.9945 - accuracy10: 0.6663 - val_loss: 2.2332 - val_accuracy10: 0.7147 - 38s/epoch - 25ms/step
Epoch 22/50
1504/1504 - 38s - loss: 1.9941 - accuracy10: 0.6658 - val_loss: 2.2387 - val_accuracy10: 0.7111 - 38s/epoch - 25ms/step
Epoch 23/50
1504/1504 - 38s - loss: 1.9908 - accuracy10: 0.6665 - val_loss: 2.2245 - val_accuracy10: 0.7125 - 38s/epoch - 25ms/step
Epoch 24/50
1504/1504 - 37s - loss: 1.9853 - accuracy10: 0.6667 - val_loss: 2.2330 - val_accuracy10: 0.7132 - 37s/epoch - 24ms/step
Epoch 25/50
1504/1504 - 37s - loss: 1.9824 - accuracy10: 0.6669 - val_loss: 2.2393 - val_accuracy10: 0.7117 - 37s/epoch - 25ms/step
Epoch 26/50
1504/1504 - 38s - loss: 1.9750 - accuracy10: 0.6681 - val_loss: 2.2377 - val_accuracy10: 0.7154 - 38s/epoch - 25ms/step
Epoch 27/50
1504/1504 - 39s - loss: 1.9732 - accuracy10: 0.6676 - val_loss: 2.2567 - val_accuracy10: 0.7181 - 39s/epoch - 26ms/step
Epoch 28/50
1504/1504 - 38s - loss: 1.9685 - accuracy10: 0.6682 - val_loss: 2.2381 - val_accuracy10: 0.7128 - 38s/epoch - 26ms/step
Epoch 29/50
1504/1504 - 37s - loss: 1.9658 - accuracy10: 0.6692 - val_loss: 2.2518 - val_accuracy10: 0.7137 - 37s/epoch - 24ms/step
Epoch 30/50
1504/1504 - 37s - loss: 1.9613 - accuracy10: 0.6695 - val_loss: 2.2589 - val_accuracy10: 0.7188 - 37s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h10
Evaluating performance on  test set...
4450/4450 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7022837
{'0': {'precision': 0.42880975946253974, 'recall': 0.5947914987441563, 'f1-score': 0.4983432708038786, 'support': 192301}, '1': {'precision': 0.8575765719419213, 'recall': 0.7386902966713758, 'f1-score': 0.7937062464956335, 'support': 755988}, '2': {'precision': 0.4948508137432188, 'recall': 0.5735987675023057, 'f1-score': 0.5313228098788444, 'support': 190832}, 'accuracy': 0.6867409168999605, 'macro avg': {'precision': 0.5937457150492266, 'recall': 0.6356935209726126, 'f1-score': 0.6077907757261188, 'support': 1139121}, 'weighted avg': {'precision': 0.7244283210579745, 'recall': 0.6867409168999605, 'f1-score': 0.6998885119749326, 'support': 1139121}}
[[114379  37124  40798]
 [126606 558441  70941]
 [ 25751  55620 109461]]
Evaluating performance on  train set...
1504/1504 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6343356
{'0': {'precision': 0.410819846884388, 'recall': 0.642079554705693, 'f1-score': 0.5010526626825539, 'support': 52819}, '1': {'precision': 0.8852025358245817, 'recall': 0.7601577583670072, 'f1-score': 0.8179285445365819, 'support': 278654}, '2': {'precision': 0.4798018292682927, 'recall': 0.566415476324373, 'f1-score': 0.519523391963687, 'support': 53346}, 'accuracy': 0.7170929709811625, 'macro avg': {'precision': 0.5919414039924208, 'recall': 0.656217596465691, 'f1-score': 0.6128348663942743, 'support': 384819}, 'weighted avg': {'precision': 0.76389115218946, 'recall': 0.7170929709811625, 'f1-score': 0.7330684194575148, 'support': 384819}}
[[ 33914  10283   8622]
 [ 42695 211821  24138]
 [  5943  17187  30216]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.64521825
{'0': {'precision': 0.4145715364288411, 'recall': 0.6261474428416671, 'f1-score': 0.49885302868563897, 'support': 17539}, '1': {'precision': 0.8863236157307768, 'recall': 0.7628188936600152, 'f1-score': 0.8199466039187294, 'support': 95016}, '2': {'precision': 0.45736120476511577, 'recall': 0.5666072621964803, 'f1-score': 0.5061565632695704, 'support': 17956}, 'accuracy': 0.7174567660963443, 'macro avg': {'precision': 0.5860854523082445, 'recall': 0.6518578662327209, 'f1-score': 0.6083187319579796, 'support': 130511}, 'weighted avg': {'precision': 0.7639085796788267, 'recall': 0.7174567660963443, 'f1-score': 0.7336238097794656, 'support': 130511}}
[[10982  3492  3065]
 [13530 72480  9006]
 [ 1978  5804 10174]]
training model: results/EXC/W6/deepVOL_L2/h20
Epoch 1/50
1504/1504 - 40s - loss: 2.5639 - accuracy20: 0.5623 - val_loss: 2.4765 - val_accuracy20: 0.6585 - 40s/epoch - 27ms/step
Epoch 2/50
1504/1504 - 37s - loss: 2.3634 - accuracy20: 0.6107 - val_loss: 2.4561 - val_accuracy20: 0.6771 - 37s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 35s - loss: 2.3050 - accuracy20: 0.6255 - val_loss: 2.4298 - val_accuracy20: 0.6793 - 35s/epoch - 23ms/step
Epoch 4/50
1504/1504 - 35s - loss: 2.2811 - accuracy20: 0.6304 - val_loss: 2.4449 - val_accuracy20: 0.6780 - 35s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 36s - loss: 2.2651 - accuracy20: 0.6330 - val_loss: 2.4414 - val_accuracy20: 0.6747 - 36s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 35s - loss: 2.2532 - accuracy20: 0.6352 - val_loss: 2.4146 - val_accuracy20: 0.6692 - 35s/epoch - 23ms/step
Epoch 7/50
1504/1504 - 36s - loss: 2.2405 - accuracy20: 0.6368 - val_loss: 2.4161 - val_accuracy20: 0.6699 - 36s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 36s - loss: 2.2285 - accuracy20: 0.6368 - val_loss: 2.4096 - val_accuracy20: 0.6755 - 36s/epoch - 24ms/step
Epoch 9/50
1504/1504 - 36s - loss: 2.2193 - accuracy20: 0.6379 - val_loss: 2.4098 - val_accuracy20: 0.6748 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 37s - loss: 2.2110 - accuracy20: 0.6386 - val_loss: 2.4323 - val_accuracy20: 0.6766 - 37s/epoch - 25ms/step
Epoch 11/50
1504/1504 - 36s - loss: 2.2053 - accuracy20: 0.6394 - val_loss: 2.4057 - val_accuracy20: 0.6806 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 36s - loss: 2.1982 - accuracy20: 0.6398 - val_loss: 2.4067 - val_accuracy20: 0.6833 - 36s/epoch - 24ms/step
Epoch 13/50
1504/1504 - 36s - loss: 2.1916 - accuracy20: 0.6409 - val_loss: 2.4102 - val_accuracy20: 0.6814 - 36s/epoch - 24ms/step
Epoch 14/50
1504/1504 - 36s - loss: 2.1867 - accuracy20: 0.6413 - val_loss: 2.4034 - val_accuracy20: 0.6788 - 36s/epoch - 24ms/step
Epoch 15/50
1504/1504 - 37s - loss: 2.1824 - accuracy20: 0.6423 - val_loss: 2.3886 - val_accuracy20: 0.6834 - 37s/epoch - 25ms/step
Epoch 16/50
1504/1504 - 36s - loss: 2.1768 - accuracy20: 0.6428 - val_loss: 2.4086 - val_accuracy20: 0.6826 - 36s/epoch - 24ms/step
Epoch 17/50
1504/1504 - 36s - loss: 2.1734 - accuracy20: 0.6437 - val_loss: 2.3970 - val_accuracy20: 0.6832 - 36s/epoch - 24ms/step
Epoch 18/50
1504/1504 - 36s - loss: 2.1689 - accuracy20: 0.6439 - val_loss: 2.3854 - val_accuracy20: 0.6771 - 36s/epoch - 24ms/step
Epoch 19/50
1504/1504 - 36s - loss: 2.1637 - accuracy20: 0.6449 - val_loss: 2.4056 - val_accuracy20: 0.6806 - 36s/epoch - 24ms/step
Epoch 20/50
1504/1504 - 36s - loss: 2.1606 - accuracy20: 0.6446 - val_loss: 2.3657 - val_accuracy20: 0.6792 - 36s/epoch - 24ms/step
Epoch 21/50
1504/1504 - 36s - loss: 2.1574 - accuracy20: 0.6455 - val_loss: 2.3846 - val_accuracy20: 0.6843 - 36s/epoch - 24ms/step
Epoch 22/50
1504/1504 - 37s - loss: 2.1534 - accuracy20: 0.6454 - val_loss: 2.3890 - val_accuracy20: 0.6846 - 37s/epoch - 25ms/step
Epoch 23/50
1504/1504 - 36s - loss: 2.1500 - accuracy20: 0.6468 - val_loss: 2.3805 - val_accuracy20: 0.6795 - 36s/epoch - 24ms/step
Epoch 24/50
1504/1504 - 35s - loss: 2.1466 - accuracy20: 0.6463 - val_loss: 2.3831 - val_accuracy20: 0.6845 - 35s/epoch - 23ms/step
Epoch 25/50
1504/1504 - 35s - loss: 2.1450 - accuracy20: 0.6468 - val_loss: 2.3694 - val_accuracy20: 0.6796 - 35s/epoch - 23ms/step
Epoch 26/50
1504/1504 - 36s - loss: 2.1416 - accuracy20: 0.6480 - val_loss: 2.3847 - val_accuracy20: 0.6782 - 36s/epoch - 24ms/step
Epoch 27/50
1504/1504 - 37s - loss: 2.1376 - accuracy20: 0.6478 - val_loss: 2.3616 - val_accuracy20: 0.6785 - 37s/epoch - 24ms/step
Epoch 28/50
1504/1504 - 38s - loss: 2.1343 - accuracy20: 0.6480 - val_loss: 2.3759 - val_accuracy20: 0.6788 - 38s/epoch - 25ms/step
Epoch 29/50
1504/1504 - 36s - loss: 2.1315 - accuracy20: 0.6483 - val_loss: 2.3900 - val_accuracy20: 0.6822 - 36s/epoch - 24ms/step
Epoch 30/50
1504/1504 - 37s - loss: 2.1276 - accuracy20: 0.6492 - val_loss: 2.3624 - val_accuracy20: 0.6786 - 37s/epoch - 24ms/step
Epoch 31/50
1504/1504 - 37s - loss: 2.1247 - accuracy20: 0.6497 - val_loss: 2.3886 - val_accuracy20: 0.6798 - 37s/epoch - 25ms/step
Epoch 32/50
1504/1504 - 36s - loss: 2.1217 - accuracy20: 0.6491 - val_loss: 2.3899 - val_accuracy20: 0.6783 - 36s/epoch - 24ms/step
Epoch 33/50
1504/1504 - 37s - loss: 2.1182 - accuracy20: 0.6505 - val_loss: 2.3784 - val_accuracy20: 0.6749 - 37s/epoch - 24ms/step
Epoch 34/50
1504/1504 - 37s - loss: 2.1154 - accuracy20: 0.6508 - val_loss: 2.3816 - val_accuracy20: 0.6742 - 37s/epoch - 25ms/step
Epoch 35/50
1504/1504 - 38s - loss: 2.1130 - accuracy20: 0.6511 - val_loss: 2.3901 - val_accuracy20: 0.6745 - 38s/epoch - 25ms/step
Epoch 36/50
1504/1504 - 38s - loss: 2.1087 - accuracy20: 0.6513 - val_loss: 2.3762 - val_accuracy20: 0.6722 - 38s/epoch - 25ms/step
Epoch 37/50
1504/1504 - 39s - loss: 2.1050 - accuracy20: 0.6517 - val_loss: 2.3827 - val_accuracy20: 0.6722 - 39s/epoch - 26ms/step
testing model: results/EXC/W6/deepVOL_L2/h20
Evaluating performance on  test set...
4450/4450 - 47s - 47s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7600066
{'0': {'precision': 0.47816326200527276, 'recall': 0.5971101254675748, 'f1-score': 0.5310577360069986, 'support': 247554}, '1': {'precision': 0.7837466811489259, 'recall': 0.7229238109668422, 'f1-score': 0.7521075650365375, 'support': 646786}, '2': {'precision': 0.5435529619441802, 'recall': 0.5182673491815133, 'f1-score': 0.5306090866314633, 'support': 244781}, 'accuracy': 0.6516041755002322, 'macro avg': {'precision': 0.6018209683661263, 'recall': 0.6127670952053101, 'f1-score': 0.6045914625583332, 'support': 1139121}, 'weighted avg': {'precision': 0.6657229975162434, 'recall': 0.6516041755002322, 'f1-score': 0.6564720808183984, 'support': 1139121}}
[[147817  55094  44643]
 [117320 467577  61889]
 [ 43998  73921 126862]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69940996
{'0': {'precision': 0.4719252079100185, 'recall': 0.6058096609130689, 'f1-score': 0.5305513599880166, 'support': 70159}, '1': {'precision': 0.813507809202195, 'recall': 0.7499815662917114, 'f1-score': 0.780454118203733, 'support': 244118}, '2': {'precision': 0.5341530250642028, 'recall': 0.5277848657537354, 'f1-score': 0.5309498513294781, 'support': 70542}, 'accuracy': 0.6829652382028953, 'macro avg': {'precision': 0.6065286807254721, 'recall': 0.6278586976528385, 'f1-score': 0.6139851098404092, 'support': 384819}, 'weighted avg': {'precision': 0.7000224072165341, 'recall': 0.6829652382028953, 'f1-score': 0.6891554619328624, 'support': 384819}}
[[ 42503  17621  10035]
 [ 38599 183084  22435]
 [  8961  24350  37231]]
Evaluating performance on  val set...
510/510 - 6s - 6s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.718007
{'0': {'precision': 0.46977958428340105, 'recall': 0.606045103806966, 'f1-score': 0.5292825496109311, 'support': 23457}, '1': {'precision': 0.813318791637649, 'recall': 0.745079628760247, 'f1-score': 0.7777051816856813, 'support': 83073}, '2': {'precision': 0.5169172153890752, 'recall': 0.5204953921854801, 'f1-score': 0.5187001329787233, 'support': 23981}, 'accuracy': 0.6788240071718092, 'macro avg': {'precision': 0.6000051971033752, 'recall': 0.6238733749175643, 'f1-score': 0.608562621425112, 'support': 130511}, 'weighted avg': {'precision': 0.6971109211368817, 'recall': 0.6788240071718092, 'f1-score': 0.6854642996633309, 'support': 130511}}
[[14216  5801  3440]
 [12952 61896  8225]
 [ 3093  8406 12482]]
training model: results/EXC/W6/deepVOL_L2/h30
Epoch 1/50
1504/1504 - 38s - loss: 2.6893 - accuracy30: 0.5464 - val_loss: 2.6619 - val_accuracy30: 0.6373 - 38s/epoch - 25ms/step
Epoch 2/50
1504/1504 - 36s - loss: 2.4899 - accuracy30: 0.5961 - val_loss: 2.6354 - val_accuracy30: 0.6527 - 36s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 35s - loss: 2.4471 - accuracy30: 0.6057 - val_loss: 2.6141 - val_accuracy30: 0.6539 - 35s/epoch - 23ms/step
Epoch 4/50
1504/1504 - 36s - loss: 2.4261 - accuracy30: 0.6095 - val_loss: 2.6080 - val_accuracy30: 0.6517 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 36s - loss: 2.4129 - accuracy30: 0.6108 - val_loss: 2.6115 - val_accuracy30: 0.6520 - 36s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 37s - loss: 2.3988 - accuracy30: 0.6137 - val_loss: 2.6115 - val_accuracy30: 0.6545 - 37s/epoch - 25ms/step
Epoch 7/50
1504/1504 - 35s - loss: 2.3888 - accuracy30: 0.6144 - val_loss: 2.6256 - val_accuracy30: 0.6557 - 35s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 36s - loss: 2.3774 - accuracy30: 0.6157 - val_loss: 2.5986 - val_accuracy30: 0.6554 - 36s/epoch - 24ms/step
Epoch 9/50
1504/1504 - 36s - loss: 2.3668 - accuracy30: 0.6166 - val_loss: 2.5912 - val_accuracy30: 0.6572 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 36s - loss: 2.3582 - accuracy30: 0.6168 - val_loss: 2.6230 - val_accuracy30: 0.6574 - 36s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 36s - loss: 2.3522 - accuracy30: 0.6173 - val_loss: 2.6098 - val_accuracy30: 0.6557 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 36s - loss: 2.3468 - accuracy30: 0.6178 - val_loss: 2.6183 - val_accuracy30: 0.6596 - 36s/epoch - 24ms/step
Epoch 13/50
1504/1504 - 36s - loss: 2.3419 - accuracy30: 0.6184 - val_loss: 2.6180 - val_accuracy30: 0.6580 - 36s/epoch - 24ms/step
Epoch 14/50
1504/1504 - 36s - loss: 2.3355 - accuracy30: 0.6198 - val_loss: 2.6017 - val_accuracy30: 0.6567 - 36s/epoch - 24ms/step
Epoch 15/50
1504/1504 - 36s - loss: 2.3310 - accuracy30: 0.6206 - val_loss: 2.6185 - val_accuracy30: 0.6589 - 36s/epoch - 24ms/step
Epoch 16/50
1504/1504 - 36s - loss: 2.3262 - accuracy30: 0.6213 - val_loss: 2.6074 - val_accuracy30: 0.6578 - 36s/epoch - 24ms/step
Epoch 17/50
1504/1504 - 36s - loss: 2.3223 - accuracy30: 0.6218 - val_loss: 2.5950 - val_accuracy30: 0.6567 - 36s/epoch - 24ms/step
Epoch 18/50
1504/1504 - 36s - loss: 2.3182 - accuracy30: 0.6228 - val_loss: 2.6055 - val_accuracy30: 0.6574 - 36s/epoch - 24ms/step
Epoch 19/50
1504/1504 - 36s - loss: 2.3137 - accuracy30: 0.6223 - val_loss: 2.6074 - val_accuracy30: 0.6563 - 36s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h30
Evaluating performance on  test set...
4450/4450 - 49s - 49s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8068908
{'0': {'precision': 0.5150874520296811, 'recall': 0.5583748530482002, 'f1-score': 0.5358583696391246, 'support': 285808}, '1': {'precision': 0.6830605562169252, 'recall': 0.7904997283132635, 'f1-score': 0.7328633782813165, 'support': 570510}, '2': {'precision': 0.597422033978515, 'recall': 0.3571143163262059, 'f1-score': 0.4470190394621236, 'support': 282803}, 'accuracy': 0.624664982912263, 'macro avg': {'precision': 0.5985233474083738, 'recall': 0.5686629658958898, 'f1-score': 0.5719135957941882, 'support': 1139121}, 'weighted avg': {'precision': 0.619654747732895, 'recall': 0.624664982912263, 'f1-score': 0.6124694569497883, 'support': 1139121}}
[[159588  91057  35163]
 [ 86630 450988  32892]
 [ 63609 118201 100993]]
Evaluating performance on  train set...
1504/1504 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75770605
{'0': {'precision': 0.5132642793725954, 'recall': 0.5237105930667955, 'f1-score': 0.5184348189997908, 'support': 82790}, '1': {'precision': 0.7164490588646865, 'recall': 0.813571627526815, 'f1-score': 0.7619277726699311, 'support': 219001}, '2': {'precision': 0.6033491433549512, 'recall': 0.37536734595558124, 'f1-score': 0.46280525381822496, 'support': 83028}, 'accuracy': 0.6566645617809932, 'macro avg': {'precision': 0.611020827197411, 'recall': 0.5708831888497307, 'f1-score': 0.5810559484959823, 'support': 384819}, 'weighted avg': {'precision': 0.6483335872297296, 'recall': 0.6566645617809932, 'f1-score': 0.6450044239538584, 'support': 384819}}
[[ 43358  30438   8994]
 [ 29333 178173  11495]
 [ 11784  40078  31166]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76172495
{'0': {'precision': 0.5125389168291765, 'recall': 0.5414166967835201, 'f1-score': 0.5265821894936642, 'support': 27670}, '1': {'precision': 0.7217256028241489, 'recall': 0.8105118866834204, 'f1-score': 0.7635463614726287, 'support': 74411}, '2': {'precision': 0.5924253541796015, 'recall': 0.36918747801618007, 'f1-score': 0.454894142631157, 'support': 28430}, 'accuracy': 0.6573239037322525, 'macro avg': {'precision': 0.6088966246109756, 'recall': 0.5737053538277069, 'f1-score': 0.58167423119915, 'support': 130511}, 'weighted avg': {'precision': 0.6492090971622096, 'recall': 0.6573239037322525, 'f1-score': 0.6460713500151961, 'support': 130511}}
[[14981  9754  2935]
 [ 9814 60311  4286]
 [ 4434 13500 10496]]
training model: results/EXC/W6/deepVOL_L2/h50
Epoch 1/50
1504/1504 - 38s - loss: 2.8556 - accuracy50: 0.5232 - val_loss: 2.8324 - val_accuracy50: 0.5696 - 38s/epoch - 25ms/step
Epoch 2/50
1504/1504 - 36s - loss: 2.6929 - accuracy50: 0.5608 - val_loss: 2.8181 - val_accuracy50: 0.5828 - 36s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 37s - loss: 2.6563 - accuracy50: 0.5708 - val_loss: 2.7913 - val_accuracy50: 0.5857 - 37s/epoch - 25ms/step
Epoch 4/50
1504/1504 - 35s - loss: 2.6377 - accuracy50: 0.5751 - val_loss: 2.7991 - val_accuracy50: 0.5824 - 35s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 36s - loss: 2.6252 - accuracy50: 0.5780 - val_loss: 2.8039 - val_accuracy50: 0.5835 - 36s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 35s - loss: 2.6155 - accuracy50: 0.5793 - val_loss: 2.8048 - val_accuracy50: 0.5835 - 35s/epoch - 23ms/step
Epoch 7/50
1504/1504 - 37s - loss: 2.6060 - accuracy50: 0.5808 - val_loss: 2.8040 - val_accuracy50: 0.5870 - 37s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 36s - loss: 2.5984 - accuracy50: 0.5821 - val_loss: 2.7919 - val_accuracy50: 0.5850 - 36s/epoch - 24ms/step
Epoch 9/50
1504/1504 - 36s - loss: 2.5900 - accuracy50: 0.5828 - val_loss: 2.8051 - val_accuracy50: 0.5856 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 37s - loss: 2.5838 - accuracy50: 0.5834 - val_loss: 2.7885 - val_accuracy50: 0.5861 - 37s/epoch - 25ms/step
Epoch 11/50
1504/1504 - 36s - loss: 2.5771 - accuracy50: 0.5842 - val_loss: 2.8028 - val_accuracy50: 0.5854 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 36s - loss: 2.5726 - accuracy50: 0.5846 - val_loss: 2.7950 - val_accuracy50: 0.5882 - 36s/epoch - 24ms/step
Epoch 13/50
1504/1504 - 37s - loss: 2.5672 - accuracy50: 0.5853 - val_loss: 2.7800 - val_accuracy50: 0.5873 - 37s/epoch - 25ms/step
Epoch 14/50
1504/1504 - 36s - loss: 2.5623 - accuracy50: 0.5856 - val_loss: 2.7988 - val_accuracy50: 0.5873 - 36s/epoch - 24ms/step
Epoch 15/50
1504/1504 - 37s - loss: 2.5580 - accuracy50: 0.5865 - val_loss: 2.7968 - val_accuracy50: 0.5873 - 37s/epoch - 25ms/step
Epoch 16/50
1504/1504 - 38s - loss: 2.5540 - accuracy50: 0.5870 - val_loss: 2.7892 - val_accuracy50: 0.5884 - 38s/epoch - 25ms/step
Epoch 17/50
1504/1504 - 36s - loss: 2.5503 - accuracy50: 0.5878 - val_loss: 2.7927 - val_accuracy50: 0.5891 - 36s/epoch - 24ms/step
Epoch 18/50
1504/1504 - 36s - loss: 2.5448 - accuracy50: 0.5898 - val_loss: 2.8019 - val_accuracy50: 0.5879 - 36s/epoch - 24ms/step
Epoch 19/50
1504/1504 - 35s - loss: 2.5432 - accuracy50: 0.5892 - val_loss: 2.7921 - val_accuracy50: 0.5897 - 35s/epoch - 23ms/step
Epoch 20/50
1504/1504 - 36s - loss: 2.5394 - accuracy50: 0.5902 - val_loss: 2.7937 - val_accuracy50: 0.5886 - 36s/epoch - 24ms/step
Epoch 21/50
1504/1504 - 36s - loss: 2.5347 - accuracy50: 0.5907 - val_loss: 2.7916 - val_accuracy50: 0.5885 - 36s/epoch - 24ms/step
Epoch 22/50
1504/1504 - 35s - loss: 2.5331 - accuracy50: 0.5913 - val_loss: 2.8222 - val_accuracy50: 0.5870 - 35s/epoch - 24ms/step
Epoch 23/50
1504/1504 - 36s - loss: 2.5305 - accuracy50: 0.5916 - val_loss: 2.8092 - val_accuracy50: 0.5870 - 36s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h50
Evaluating performance on  test set...
4450/4450 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.904052
{'0': {'precision': 0.545945796153633, 'recall': 0.4621813500523447, 'f1-score': 0.5005836140238876, 'support': 341009}, '1': {'precision': 0.5506822490520854, 'recall': 0.7678404893838572, 'f1-score': 0.6413785902679735, 'support': 460007}, '2': {'precision': 0.592091855041263, 'recall': 0.36604605078304076, 'f1-score': 0.45240436459342387, 'support': 338105}, 'accuracy': 0.5570804155133652, 'macro avg': {'precision': 0.5629066334156605, 'recall': 0.5320226300730809, 'f1-score': 0.5314555229617617, 'support': 1139121}, 'weighted avg': {'precision': 0.5615552131766364, 'recall': 0.5570804155133652, 'f1-score': 0.543140137438368, 'support': 1139121}}
[[157608 132533  50868]
 [ 72400 353212  34395]
 [ 58680 155663 123762]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8696596
{'0': {'precision': 0.5460009900289937, 'recall': 0.4523846724737315, 'f1-score': 0.49480373831775704, 'support': 102404}, '1': {'precision': 0.5931513950552253, 'recall': 0.7881250486040905, 'f1-score': 0.6768774986403581, 'support': 180026}, '2': {'precision': 0.6092215036777411, 'recall': 0.3615915772202092, 'f1-score': 0.4538244667810738, 'support': 102389}, 'accuracy': 0.5852933457027849, 'macro avg': {'precision': 0.5827912962539866, 'recall': 0.5340337660993437, 'f1-score': 0.5418352345797296, 'support': 384819}, 'weighted avg': {'precision': 0.5848800058448291, 'recall': 0.5852933457027849, 'f1-score': 0.5690780962430858, 'support': 384819}}
[[ 46326  44570  11508]
 [ 25903 141883  12240]
 [ 12617  52749  37023]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8711457
{'0': {'precision': 0.5414812239221141, 'recall': 0.4582046076440992, 'f1-score': 0.4963743286531627, 'support': 33987}, '1': {'precision': 0.5996940651098528, 'recall': 0.7919619438606781, 'f1-score': 0.6825463684483946, 'support': 61383}, '2': {'precision': 0.6027165506573859, 'recall': 0.3548276941464386, 'f1-score': 0.4466854143903706, 'support': 35141}, 'accuracy': 0.5873451279968738, 'macro avg': {'precision': 0.581297279896451, 'recall': 0.5349980818837387, 'f1-score': 0.5418687038306427, 'support': 130511}, 'weighted avg': {'precision': 0.5853484032972713, 'recall': 0.5873451279968738, 'f1-score': 0.570557195864677, 'support': 130511}}
[[15573 14387  4027]
 [ 8578 48613  4192]
 [ 4609 18063 12469]]
training model: results/EXC/W6/deepVOL_L2/h100
Epoch 1/50
1504/1504 - 38s - loss: 3.0755 - accuracy100: 0.4648 - val_loss: 3.0899 - val_accuracy100: 0.4596 - 38s/epoch - 26ms/step
Epoch 2/50
1504/1504 - 37s - loss: 2.9822 - accuracy100: 0.4866 - val_loss: 3.0736 - val_accuracy100: 0.4600 - 37s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 36s - loss: 2.9480 - accuracy100: 0.4946 - val_loss: 3.0805 - val_accuracy100: 0.4595 - 36s/epoch - 24ms/step
Epoch 4/50
1504/1504 - 36s - loss: 2.9334 - accuracy100: 0.4988 - val_loss: 3.0836 - val_accuracy100: 0.4561 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 37s - loss: 2.9241 - accuracy100: 0.5018 - val_loss: 3.0966 - val_accuracy100: 0.4535 - 37s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 36s - loss: 2.9184 - accuracy100: 0.5025 - val_loss: 3.0880 - val_accuracy100: 0.4547 - 36s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 36s - loss: 2.9124 - accuracy100: 0.5042 - val_loss: 3.0937 - val_accuracy100: 0.4532 - 36s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 37s - loss: 2.9074 - accuracy100: 0.5059 - val_loss: 3.0897 - val_accuracy100: 0.4537 - 37s/epoch - 25ms/step
Epoch 9/50
1504/1504 - 36s - loss: 2.9032 - accuracy100: 0.5074 - val_loss: 3.1023 - val_accuracy100: 0.4528 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 35s - loss: 2.8986 - accuracy100: 0.5088 - val_loss: 3.1022 - val_accuracy100: 0.4539 - 35s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 36s - loss: 2.8954 - accuracy100: 0.5095 - val_loss: 3.1074 - val_accuracy100: 0.4544 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 35s - loss: 2.8931 - accuracy100: 0.5108 - val_loss: 3.1127 - val_accuracy100: 0.4544 - 35s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h100
Evaluating performance on  test set...
4450/4450 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0429912
{'0': {'precision': 0.5394123664469197, 'recall': 0.3259779510251743, 'f1-score': 0.40637509900884117, 'support': 407638}, '1': {'precision': 0.37095026031123707, 'recall': 0.7999607886385081, 'f1-score': 0.5068628621284336, 'support': 326436}, '2': {'precision': 0.5448011778912357, 'recall': 0.25395818263065767, 'f1-score': 0.3464290345014557, 'support': 405047}, 'accuracy': 0.4361977349201709, 'macro avg': {'precision': 0.48505460154979757, 'recall': 0.45996564076478, 'f1-score': 0.41988899854624345, 'support': 1139121}, 'weighted avg': {'precision': 0.49305260820400976, 'recall': 0.4361977349201709, 'f1-score': 0.413856174198557, 'support': 1139121}}
[[132881 209868  64889]
 [ 44242 261136  21058]
 [ 69221 232961 102865]]
Evaluating performance on  train set...
1504/1504 - 16s - 16s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0412412
{'0': {'precision': 0.5505074160811866, 'recall': 0.30103537666288943, 'f1-score': 0.3892281369012078, 'support': 128842}, '1': {'precision': 0.3943085036992862, 'recall': 0.8362462156244318, 'f1-score': 0.5359192709256791, 'support': 126507}, '2': {'precision': 0.5749202283531225, 'recall': 0.2045724878350197, 'f1-score': 0.30176769834623646, 'support': 129470}, 'accuracy': 0.4445284666297662, 'macro avg': {'precision': 0.5065787160445318, 'recall': 0.44728469337411364, 'f1-score': 0.4089717020577078, 'support': 384819}, 'weighted avg': {'precision': 0.5073714768374135, 'recall': 0.4445284666297662, 'f1-score': 0.4080264610804236, 'support': 384819}}
[[ 38786  76120  13936]
 [ 15069 105791   5647]
 [ 16600  86384  26486]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0267171
{'0': {'precision': 0.5404564315352697, 'recall': 0.3112157125107522, 'f1-score': 0.39498423095584667, 'support': 41852}, '1': {'precision': 0.4148242725623278, 'recall': 0.8334008370460375, 'f1-score': 0.5539303661162958, 'support': 44442}, '2': {'precision': 0.577051094890511, 'recall': 0.22348870343985344, 'f1-score': 0.322193603077826, 'support': 44217}, 'accuracy': 0.4593099432231766, 'macro avg': {'precision': 0.5107772663293695, 'recall': 0.45603508433221435, 'f1-score': 0.4237027333833228, 'support': 130511}, 'weighted avg': {'precision': 0.5100740256116557, 'recall': 0.4593099432231766, 'f1-score': 0.42444765508038973, 'support': 130511}}
[[13025 23811  5016]
 [ 5177 37038  2227]
 [ 5898 28437  9882]]
training model: results/EXC/W6/deepVOL_L2/h200
Epoch 1/50
1504/1504 - 38s - loss: 3.2439 - accuracy200: 0.4030 - val_loss: 3.2544 - val_accuracy200: 0.3856 - 38s/epoch - 25ms/step
Epoch 2/50
1504/1504 - 36s - loss: 3.2133 - accuracy200: 0.4134 - val_loss: 3.2534 - val_accuracy200: 0.3870 - 36s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 36s - loss: 3.1987 - accuracy200: 0.4194 - val_loss: 3.2450 - val_accuracy200: 0.3931 - 36s/epoch - 24ms/step
Epoch 4/50
1504/1504 - 36s - loss: 3.1876 - accuracy200: 0.4234 - val_loss: 3.2311 - val_accuracy200: 0.3946 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 35s - loss: 3.1764 - accuracy200: 0.4286 - val_loss: 3.2404 - val_accuracy200: 0.3982 - 35s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 36s - loss: 3.1686 - accuracy200: 0.4308 - val_loss: 3.2594 - val_accuracy200: 0.3960 - 36s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 37s - loss: 3.1624 - accuracy200: 0.4339 - val_loss: 3.2600 - val_accuracy200: 0.3966 - 37s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 37s - loss: 3.1568 - accuracy200: 0.4351 - val_loss: 3.2764 - val_accuracy200: 0.3938 - 37s/epoch - 25ms/step
Epoch 9/50
1504/1504 - 36s - loss: 3.1529 - accuracy200: 0.4371 - val_loss: 3.2730 - val_accuracy200: 0.3951 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 36s - loss: 3.1491 - accuracy200: 0.4384 - val_loss: 3.2775 - val_accuracy200: 0.3972 - 36s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 37s - loss: 3.1451 - accuracy200: 0.4388 - val_loss: 3.2862 - val_accuracy200: 0.3929 - 37s/epoch - 25ms/step
Epoch 12/50
1504/1504 - 37s - loss: 3.1423 - accuracy200: 0.4412 - val_loss: 3.2902 - val_accuracy200: 0.3927 - 37s/epoch - 25ms/step
Epoch 13/50
1504/1504 - 36s - loss: 3.1409 - accuracy200: 0.4415 - val_loss: 3.2886 - val_accuracy200: 0.3959 - 36s/epoch - 24ms/step
Epoch 14/50
1504/1504 - 37s - loss: 3.1381 - accuracy200: 0.4429 - val_loss: 3.2858 - val_accuracy200: 0.3951 - 37s/epoch - 25ms/step
testing model: results/EXC/W6/deepVOL_L2/h200
Evaluating performance on  test set...
4450/4450 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930073
{'0': {'precision': 0.43981685363418466, 'recall': 0.3439210325701217, 'f1-score': 0.38600218033655076, 'support': 380410}, '1': {'precision': 0.35074709800190296, 'recall': 0.5959416466206254, 'f1-score': 0.44159139805555425, 'support': 386610}, '2': {'precision': 0.40828773832524257, 'recall': 0.20274871607439915, 'f1-score': 0.2709488579227122, 'support': 372101}, 'accuracy': 0.38334031239877064, 'macro avg': {'precision': 0.3996172299871101, 'recall': 0.3808704650883821, 'f1-score': 0.3661808121049391, 'support': 1139121}, 'weighted avg': {'precision': 0.3992879953648971, 'recall': 0.38334031239877064, 'f1-score': 0.36728589922052557, 'support': 1139121}}
[[130831 205336  44243]
 [ 91120 230397  65093]
 [ 75516 221142  75443]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970865
{'0': {'precision': 0.4509412435824301, 'recall': 0.3424169058098251, 'f1-score': 0.3892564926642895, 'support': 129281}, '1': {'precision': 0.32675406474293245, 'recall': 0.5680951812502487, 'f1-score': 0.4148797363702672, 'support': 125655}, '2': {'precision': 0.44133045888512473, 'recall': 0.2316931392099043, 'f1-score': 0.3038622709143233, 'support': 129883}, 'accuracy': 0.3787364968985419, 'macro avg': {'precision': 0.4063419224034958, 'recall': 0.380735075423326, 'f1-score': 0.3693328333162933, 'support': 384819}, 'weighted avg': {'precision': 0.40714658296037864, 'recall': 0.3787364968985419, 'f1-score': 0.36880124223310956, 'support': 384819}}
[[44268 69876 15137]
 [31314 71384 22957]
 [22586 77204 30093]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0785804
{'0': {'precision': 0.4218863142650253, 'recall': 0.34992492492492494, 'f1-score': 0.3825508864084044, 'support': 39960}, '1': {'precision': 0.36931123756455914, 'recall': 0.5977368443442379, 'f1-score': 0.4565459315879682, 'support': 47014}, '2': {'precision': 0.4437811412992385, 'recall': 0.21685003560190183, 'f1-score': 0.29133943312092087, 'support': 43537}, 'accuracy': 0.39480197071511214, 'macro avg': {'precision': 0.4116595643762743, 'recall': 0.38817060162368827, 'f1-score': 0.37681208370576447, 'support': 130511}, 'weighted avg': {'precision': 0.41025105308851767, 'recall': 0.39480197071511214, 'f1-score': 0.37877902052962664, 'support': 130511}}
[[13983 21562  4415]
 [11494 28102  7418]
 [ 7667 26429  9441]]
training model: results/EXC/W6/deepVOL_L2/h300
Epoch 1/50
1504/1504 - 39s - loss: 3.2814 - accuracy300: 0.3810 - val_loss: 3.2612 - val_accuracy300: 0.3842 - 39s/epoch - 26ms/step
Epoch 2/50
1504/1504 - 36s - loss: 3.2426 - accuracy300: 0.3985 - val_loss: 3.2434 - val_accuracy300: 0.3990 - 36s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 36s - loss: 3.2248 - accuracy300: 0.4086 - val_loss: 3.2373 - val_accuracy300: 0.4021 - 36s/epoch - 24ms/step
Epoch 4/50
1504/1504 - 36s - loss: 3.2150 - accuracy300: 0.4153 - val_loss: 3.2400 - val_accuracy300: 0.4017 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 37s - loss: 3.2074 - accuracy300: 0.4181 - val_loss: 3.2413 - val_accuracy300: 0.4024 - 37s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 37s - loss: 3.2010 - accuracy300: 0.4210 - val_loss: 3.2470 - val_accuracy300: 0.4011 - 37s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 36s - loss: 3.1962 - accuracy300: 0.4239 - val_loss: 3.2502 - val_accuracy300: 0.4029 - 36s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 36s - loss: 3.1917 - accuracy300: 0.4261 - val_loss: 3.2501 - val_accuracy300: 0.4028 - 36s/epoch - 24ms/step
Epoch 9/50
1504/1504 - 35s - loss: 3.1881 - accuracy300: 0.4274 - val_loss: 3.2524 - val_accuracy300: 0.4016 - 35s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 35s - loss: 3.1831 - accuracy300: 0.4306 - val_loss: 3.2574 - val_accuracy300: 0.4025 - 35s/epoch - 23ms/step
Epoch 11/50
1504/1504 - 36s - loss: 3.1796 - accuracy300: 0.4322 - val_loss: 3.2605 - val_accuracy300: 0.4025 - 36s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 35s - loss: 3.1754 - accuracy300: 0.4345 - val_loss: 3.2674 - val_accuracy300: 0.3997 - 35s/epoch - 23ms/step
Epoch 13/50
1504/1504 - 37s - loss: 3.1711 - accuracy300: 0.4359 - val_loss: 3.2764 - val_accuracy300: 0.3977 - 37s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h300
Evaluating performance on  test set...
4450/4450 - 43s - 43s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0885736
{'0': {'precision': 0.42465915216561784, 'recall': 0.3569792011405005, 'f1-score': 0.38788906469566375, 'support': 392810}, '1': {'precision': 0.3747555524514597, 'recall': 0.23642482223801106, 'f1-score': 0.28993573269122314, 'support': 363126}, '2': {'precision': 0.3830763313885004, 'recall': 0.5796625650795307, 'f1-score': 0.46129850926052846, 'support': 383185}, 'accuracy': 0.39345688473832013, 'macro avg': {'precision': 0.3941636786685259, 'recall': 0.39102219615268075, 'f1-score': 0.37970776888247176, 'support': 1139121}, 'weighted avg': {'precision': 0.3947631115085821, 'recall': 0.39345688473832013, 'f1-score': 0.3813577097106737, 'support': 1139121}}
[[140225  73289 179296]
 [ 98861  85852 178413]
 [ 91120  69947 222118]]
Evaluating performance on  train set...
1504/1504 - 14s - 14s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0836453
{'0': {'precision': 0.42095919402515175, 'recall': 0.3739192579875865, 'f1-score': 0.39604734302299266, 'support': 128731}, '1': {'precision': 0.3971731448763251, 'recall': 0.24774274806155783, 'f1-score': 0.30514604290389047, 'support': 127035}, '2': {'precision': 0.39251593605706125, 'recall': 0.5816370018519523, 'f1-score': 0.4687185827666523, 'support': 129053}, 'accuracy': 0.4019266200473469, 'macro avg': {'precision': 0.40354942498617935, 'recall': 0.4010996693003655, 'f1-score': 0.38997065623117844, 'support': 384819}, 'weighted avg': {'precision': 0.4035682946044445, 'recall': 0.4019266200473469, 'f1-score': 0.3904103938131261, 'support': 384819}}
[[48135 24114 56482]
 [35874 31472 59689]
 [30337 23654 75062]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0787609
{'0': {'precision': 0.3897546674895849, 'recall': 0.3817920749678817, 'f1-score': 0.38573228306376695, 'support': 39697}, '1': {'precision': 0.4192895922784855, 'recall': 0.25549765390187473, 'f1-score': 0.3175149137421401, 'support': 46247}, '2': {'precision': 0.40273311897106107, 'recall': 0.5733165795319407, 'f1-score': 0.4731184786734684, 'support': 44567}, 'accuracy': 0.40244117354092757, 'macro avg': {'precision': 0.4039257929130438, 'recall': 0.40353543613389903, 'f1-score': 0.39212189182645846, 'support': 130511}, 'weighted avg': {'precision': 0.4046523566796703, 'recall': 0.40244117354092757, 'f1-score': 0.39139994250029175, 'support': 130511}}
[[15156  7864 16677]
 [13215 11816 21216]
 [10515  8501 25551]]
training model: results/EXC/W6/deepVOL_L2/h500
Epoch 1/50
1504/1504 - 38s - loss: 3.2497 - accuracy500: 0.4061 - val_loss: 3.3177 - val_accuracy500: 0.3042 - 38s/epoch - 25ms/step
Epoch 2/50
1504/1504 - 35s - loss: 3.2413 - accuracy500: 0.4091 - val_loss: 3.3263 - val_accuracy500: 0.2988 - 35s/epoch - 24ms/step
Epoch 3/50
1504/1504 - 37s - loss: 3.2374 - accuracy500: 0.4113 - val_loss: 3.3379 - val_accuracy500: 0.3021 - 37s/epoch - 24ms/step
Epoch 4/50
1504/1504 - 36s - loss: 3.2266 - accuracy500: 0.4158 - val_loss: 3.3515 - val_accuracy500: 0.3050 - 36s/epoch - 24ms/step
Epoch 5/50
1504/1504 - 36s - loss: 3.2189 - accuracy500: 0.4190 - val_loss: 3.3350 - val_accuracy500: 0.3234 - 36s/epoch - 24ms/step
Epoch 6/50
1504/1504 - 37s - loss: 3.2075 - accuracy500: 0.4233 - val_loss: 3.3608 - val_accuracy500: 0.3099 - 37s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 37s - loss: 3.2088 - accuracy500: 0.4244 - val_loss: 3.3509 - val_accuracy500: 0.3150 - 37s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 37s - loss: 3.2065 - accuracy500: 0.4249 - val_loss: 3.3440 - val_accuracy500: 0.3102 - 37s/epoch - 25ms/step
Epoch 9/50
1504/1504 - 36s - loss: 3.1988 - accuracy500: 0.4286 - val_loss: 3.4199 - val_accuracy500: 0.3154 - 36s/epoch - 24ms/step
Epoch 10/50
1504/1504 - 36s - loss: 3.2082 - accuracy500: 0.4246 - val_loss: 3.4174 - val_accuracy500: 0.3090 - 36s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 36s - loss: 3.2043 - accuracy500: 0.4269 - val_loss: 3.3625 - val_accuracy500: 0.3180 - 36s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h500
Evaluating performance on  test set...
4450/4450 - 47s - 47s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126505
{'0': {'precision': 0.2752446853294043, 'recall': 0.2264467461064753, 'f1-score': 0.24847250509164973, 'support': 277191}, '1': {'precision': 0.5427936518465697, 'recall': 0.055947271350505014, 'f1-score': 0.10143894479447851, 'support': 585033}, '2': {'precision': 0.25258000968532107, 'recall': 0.7760575231945452, 'f1-score': 0.38111892762858607, 'support': 276897}, 'accuracy': 0.272480272069429, 'macro avg': {'precision': 0.35687278228709834, 'recall': 0.3528171802171752, 'f1-score': 0.24367679250490473, 'support': 1139121}, 'weighted avg': {'precision': 0.40714392503845814, 'recall': 0.272480272069429, 'f1-score': 0.20520222175904074, 'support': 1139121}}
[[ 62769  14643 199779]
 [116197  32731 436105]
 [ 49082  12927 214888]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044722
{'0': {'precision': 0.3894701729026519, 'recall': 0.2733323969160658, 'f1-score': 0.3212263220883792, 'support': 128148}, '1': {'precision': 0.3357420789327404, 'recall': 0.04733839112170042, 'f1-score': 0.082977291148631, 'support': 127592}, '2': {'precision': 0.35463751471682303, 'recall': 0.7607511678894321, 'f1-score': 0.48376123535308996, 'support': 129079}, 'accuracy': 0.3618948128860581, 'macro avg': {'precision': 0.3599499221840718, 'recall': 0.3604739853090661, 'f1-score': 0.2959882828633667, 'support': 384819}, 'weighted avg': {'precision': 0.3599720461163509, 'recall': 0.3618948128860581, 'f1-score': 0.2967503313333262, 'support': 384819}}
[[35027  6145 86976]
 [29831  6040 91721]
 [25077  5805 98197]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038636
{'0': {'precision': 0.28099255256046923, 'recall': 0.26636054103020645, 'f1-score': 0.2734809730752578, 'support': 32013}, '1': {'precision': 0.49168497019140256, 'recall': 0.05030982117057822, 'f1-score': 0.09127978097512668, 'support': 62294}, '2': {'precision': 0.29810962672324637, 'recall': 0.772290354656944, 'f1-score': 0.4301703911688911, 'support': 36204}, 'accuracy': 0.3035836059795726, 'macro avg': {'precision': 0.3569290498250394, 'recall': 0.3629869056192429, 'f1-score': 0.26497704840642516, 'support': 130511}, 'weighted avg': {'precision': 0.3863061277908371, 'recall': 0.3035836059795726, 'f1-score': 0.22998075188299305, 'support': 130511}}
[[ 8527  1515 21971]
 [15300  3134 43860]
 [ 6519  1725 27960]]
training model: results/EXC/W6/deepVOL_L2/h1000
Epoch 1/50
1504/1504 - 39s - loss: 3.2636 - accuracy1000: 0.3974 - val_loss: 3.2894 - val_accuracy1000: 0.4020 - 39s/epoch - 26ms/step
Epoch 2/50
1504/1504 - 37s - loss: 3.2450 - accuracy1000: 0.4018 - val_loss: 3.3093 - val_accuracy1000: 0.4021 - 37s/epoch - 25ms/step
Epoch 3/50
1504/1504 - 36s - loss: 3.2361 - accuracy1000: 0.4033 - val_loss: 3.2908 - val_accuracy1000: 0.4023 - 36s/epoch - 24ms/step
Epoch 4/50
1504/1504 - 34s - loss: 3.2218 - accuracy1000: 0.4124 - val_loss: 3.2849 - val_accuracy1000: 0.4040 - 34s/epoch - 23ms/step
Epoch 5/50
1504/1504 - 35s - loss: 3.2180 - accuracy1000: 0.4164 - val_loss: 3.2751 - val_accuracy1000: 0.4028 - 35s/epoch - 23ms/step
Epoch 6/50
1504/1504 - 36s - loss: 3.2068 - accuracy1000: 0.4232 - val_loss: 3.3071 - val_accuracy1000: 0.4024 - 36s/epoch - 24ms/step
Epoch 7/50
1504/1504 - 36s - loss: 3.2015 - accuracy1000: 0.4266 - val_loss: 3.3257 - val_accuracy1000: 0.4019 - 36s/epoch - 24ms/step
Epoch 8/50
1504/1504 - 37s - loss: 3.1962 - accuracy1000: 0.4289 - val_loss: 3.3257 - val_accuracy1000: 0.4000 - 37s/epoch - 25ms/step
Epoch 9/50
1504/1504 - 37s - loss: 3.1956 - accuracy1000: 0.4301 - val_loss: 3.3426 - val_accuracy1000: 0.3986 - 37s/epoch - 25ms/step
Epoch 10/50
1504/1504 - 35s - loss: 3.1897 - accuracy1000: 0.4316 - val_loss: 3.3809 - val_accuracy1000: 0.3950 - 35s/epoch - 24ms/step
Epoch 11/50
1504/1504 - 35s - loss: 3.1843 - accuracy1000: 0.4344 - val_loss: 3.3943 - val_accuracy1000: 0.3977 - 35s/epoch - 24ms/step
Epoch 12/50
1504/1504 - 35s - loss: 3.1784 - accuracy1000: 0.4378 - val_loss: 3.4226 - val_accuracy1000: 0.3942 - 35s/epoch - 23ms/step
Epoch 13/50
1504/1504 - 36s - loss: 3.1698 - accuracy1000: 0.4425 - val_loss: 3.4618 - val_accuracy1000: 0.3961 - 36s/epoch - 24ms/step
Epoch 14/50
1504/1504 - 37s - loss: 3.1648 - accuracy1000: 0.4444 - val_loss: 3.4379 - val_accuracy1000: 0.3966 - 37s/epoch - 24ms/step
Epoch 15/50
1504/1504 - 36s - loss: 3.1535 - accuracy1000: 0.4489 - val_loss: 3.4574 - val_accuracy1000: 0.3917 - 36s/epoch - 24ms/step
testing model: results/EXC/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
4450/4450 - 44s - 44s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1105654
{'0': {'precision': 0.4153225806451613, 'recall': 0.0003022637500660285, 'f1-score': 0.0006040878566610949, 'support': 340762}, '1': {'precision': 0.40614230029807574, 'recall': 0.9954780571208712, 'f1-score': 0.5769119232255587, 'support': 462633}, '2': {'precision': 0.28238394486113927, 'recall': 0.004149216920941482, 'f1-score': 0.00817826624278237, 'support': 335726}, 'accuracy': 0.4056083594280151, 'macro avg': {'precision': 0.3679496086014587, 'recall': 0.33330984593062624, 'f1-score': 0.19523142577500074, 'support': 1139121}, 'weighted avg': {'precision': 0.37241400721438456, 'recall': 0.4056083594280151, 'f1-score': 0.23689318393431932, 'support': 1139121}}
[[   103 339171   1488]
 [    40 460541   2052]
 [   105 334228   1393]]
Evaluating performance on  train set...
1504/1504 - 15s - 15s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1472639
{'0': {'precision': 0.475, 'recall': 0.00014942275629934882, 'f1-score': 0.00029875153306707755, 'support': 127156}, '1': {'precision': 0.33166937755696135, 'recall': 0.9962514214014038, 'f1-score': 0.49765933192044476, 'support': 127515}, '2': {'precision': 0.4083143507972665, 'recall': 0.005509112702461813, 'f1-score': 0.010871542940320235, 'support': 130148}, 'accuracy': 0.33203402118918246, 'macro avg': {'precision': 0.40499457611807593, 'recall': 0.33396998562005503, 'f1-score': 0.1696098754646107, 'support': 384819}, 'weighted avg': {'precision': 0.40495198211818695, 'recall': 0.33203402118918246, 'f1-score': 0.16868171096118173, 'support': 384819}}
[[    19 126569    568]
 [     7 127037    471]
 [    14 129417    717]]
Evaluating performance on  val set...
510/510 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0922961
{'0': {'precision': 0.16666666666666666, 'recall': 8.717129158797036e-05, 'f1-score': 0.00017425144483489675, 'support': 34415}, '1': {'precision': 0.4025691486908258, 'recall': 0.9976186847519622, 'f1-score': 0.5736523272755156, 'support': 52492}, '2': {'precision': 0.46715328467153283, 'recall': 0.004403265755435281, 'f1-score': 0.008724298534590481, 'support': 43604}, 'accuracy': 0.4027399989272935, 'macro avg': {'precision': 0.34546303334300843, 'recall': 0.3340363739329952, 'f1-score': 0.19418362575164697, 'support': 130511}, 'weighted avg': {'precision': 0.3619407169604836, 'recall': 0.4027399989272935, 'f1-score': 0.23368581299754537, 'support': 130511}}
[[    3 34310   102]
 [    8 52367   117]
 [    7 43405   192]]
training model: results/EXC/W6/deepVOL_L3/h10
Epoch 1/50
1504/1504 - 57s - loss: 2.5631 - accuracy10: 0.5316 - val_loss: 2.3221 - val_accuracy10: 0.6805 - 57s/epoch - 38ms/step
Epoch 2/50
1504/1504 - 56s - loss: 2.2065 - accuracy10: 0.6286 - val_loss: 2.2559 - val_accuracy10: 0.6866 - 56s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 55s - loss: 2.1425 - accuracy10: 0.6453 - val_loss: 2.2553 - val_accuracy10: 0.7073 - 55s/epoch - 36ms/step
Epoch 4/50
1504/1504 - 56s - loss: 2.1144 - accuracy10: 0.6494 - val_loss: 2.2571 - val_accuracy10: 0.7058 - 56s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 56s - loss: 2.0954 - accuracy10: 0.6529 - val_loss: 2.2569 - val_accuracy10: 0.7101 - 56s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 58s - loss: 2.0801 - accuracy10: 0.6555 - val_loss: 2.2804 - val_accuracy10: 0.7248 - 58s/epoch - 38ms/step
Epoch 7/50
1504/1504 - 56s - loss: 2.0689 - accuracy10: 0.6568 - val_loss: 2.3291 - val_accuracy10: 0.7371 - 56s/epoch - 37ms/step
Epoch 8/50
1504/1504 - 55s - loss: 2.0588 - accuracy10: 0.6581 - val_loss: 2.3388 - val_accuracy10: 0.7398 - 55s/epoch - 37ms/step
Epoch 9/50
1504/1504 - 55s - loss: 2.0492 - accuracy10: 0.6585 - val_loss: 2.2724 - val_accuracy10: 0.7229 - 55s/epoch - 36ms/step
Epoch 10/50
1504/1504 - 57s - loss: 2.0412 - accuracy10: 0.6604 - val_loss: 2.2894 - val_accuracy10: 0.7300 - 57s/epoch - 38ms/step
Epoch 11/50
1504/1504 - 55s - loss: 2.0322 - accuracy10: 0.6610 - val_loss: 2.2882 - val_accuracy10: 0.7304 - 55s/epoch - 37ms/step
Epoch 12/50
1504/1504 - 55s - loss: 2.0241 - accuracy10: 0.6622 - val_loss: 2.2874 - val_accuracy10: 0.7281 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 2.0182 - accuracy10: 0.6615 - val_loss: 2.2587 - val_accuracy10: 0.7243 - 55s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h10
Evaluating performance on  test set...
4450/4450 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70806605
{'0': {'precision': 0.4374935720577911, 'recall': 0.5087753053806272, 'f1-score': 0.47044963864459266, 'support': 192301}, '1': {'precision': 0.8688210604822394, 'recall': 0.7242416546294386, 'f1-score': 0.7899706602278359, 'support': 755988}, '2': {'precision': 0.4413272906348689, 'recall': 0.659805483357089, 'f1-score': 0.5288920159198547, 'support': 190832}, 'accuracy': 0.6770729360621041, 'macro avg': {'precision': 0.5825473077249664, 'recall': 0.6309408144557183, 'f1-score': 0.5964374382640943, 'support': 1139121}, 'weighted avg': {'precision': 0.7243902243910574, 'recall': 0.6770729360621041, 'f1-score': 0.6922932652697411, 'support': 1139121}}
[[ 97838  39330  55133]
 [104212 547518 104258]
 [ 21583  43337 125912]]
Evaluating performance on  train set...
1504/1504 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6434668
{'0': {'precision': 0.4250491902527622, 'recall': 0.5316836744353358, 'f1-score': 0.4724238575477967, 'support': 52819}, '1': {'precision': 0.8884062445808255, 'recall': 0.7537842629210418, 'f1-score': 0.8155772953096879, 'support': 278654}, '2': {'precision': 0.4178328474246842, 'recall': 0.6447718666816631, 'f1-score': 0.5070688308050655, 'support': 53346}, 'accuracy': 0.7081874855451524, 'macro avg': {'precision': 0.5770960940860906, 'recall': 0.6434132680126802, 'f1-score': 0.5983566612208501, 'support': 384819}, 'weighted avg': {'precision': 0.7595735603909974, 'recall': 0.7081874855451524, 'f1-score': 0.7257098148146788, 'support': 384819}}
[[ 28083  12645  12091]
 [ 32776 210045  35833]
 [  5211  13739  34396]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.65525675
{'0': {'precision': 0.43072054304453516, 'recall': 0.5354353155824163, 'f1-score': 0.47740328402216464, 'support': 17539}, '1': {'precision': 0.8885221901016142, 'recall': 0.7537046392186579, 'f1-score': 0.8155795347777809, 'support': 95016}, '2': {'precision': 0.4049948415098367, 'recall': 0.6339942080641569, 'f1-score': 0.494258113535222, 'support': 17956}, 'accuracy': 0.7079020159220296, 'macro avg': {'precision': 0.5747458582186621, 'recall': 0.641044720955077, 'f1-score': 0.5957469774450558, 'support': 130511}, 'weighted avg': {'precision': 0.7604747446062301, 'recall': 0.7079020159220296, 'f1-score': 0.7259248642761823, 'support': 130511}}
[[ 9391  4158  3990]
 [10667 71614 12735]
 [ 1745  4827 11384]]
training model: results/EXC/W6/deepVOL_L3/h20
Epoch 1/50
1504/1504 - 59s - loss: 2.8875 - accuracy20: 0.4325 - val_loss: 2.6525 - val_accuracy20: 0.6389 - 59s/epoch - 39ms/step
Epoch 2/50
1504/1504 - 56s - loss: 2.4169 - accuracy20: 0.5944 - val_loss: 2.4645 - val_accuracy20: 0.6636 - 56s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 56s - loss: 2.3135 - accuracy20: 0.6225 - val_loss: 2.4440 - val_accuracy20: 0.6815 - 56s/epoch - 37ms/step
Epoch 4/50
1504/1504 - 56s - loss: 2.2777 - accuracy20: 0.6296 - val_loss: 2.4266 - val_accuracy20: 0.6793 - 56s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 58s - loss: 2.2568 - accuracy20: 0.6331 - val_loss: 2.4293 - val_accuracy20: 0.6838 - 58s/epoch - 38ms/step
Epoch 6/50
1504/1504 - 56s - loss: 2.2375 - accuracy20: 0.6354 - val_loss: 2.4250 - val_accuracy20: 0.6822 - 56s/epoch - 37ms/step
Epoch 7/50
1504/1504 - 56s - loss: 2.2236 - accuracy20: 0.6378 - val_loss: 2.4103 - val_accuracy20: 0.6786 - 56s/epoch - 37ms/step
Epoch 8/50
1504/1504 - 57s - loss: 2.2125 - accuracy20: 0.6379 - val_loss: 2.4066 - val_accuracy20: 0.6854 - 57s/epoch - 38ms/step
Epoch 9/50
1504/1504 - 56s - loss: 2.2028 - accuracy20: 0.6393 - val_loss: 2.4170 - val_accuracy20: 0.6878 - 56s/epoch - 37ms/step
Epoch 10/50
1504/1504 - 58s - loss: 2.1947 - accuracy20: 0.6393 - val_loss: 2.3866 - val_accuracy20: 0.6815 - 58s/epoch - 38ms/step
Epoch 11/50
1504/1504 - 58s - loss: 2.1877 - accuracy20: 0.6394 - val_loss: 2.3628 - val_accuracy20: 0.6841 - 58s/epoch - 38ms/step
Epoch 12/50
1504/1504 - 56s - loss: 2.1818 - accuracy20: 0.6409 - val_loss: 2.3628 - val_accuracy20: 0.6813 - 56s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 56s - loss: 2.1760 - accuracy20: 0.6415 - val_loss: 2.3705 - val_accuracy20: 0.6780 - 56s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 56s - loss: 2.1701 - accuracy20: 0.6423 - val_loss: 2.3478 - val_accuracy20: 0.6854 - 56s/epoch - 37ms/step
Epoch 15/50
1504/1504 - 56s - loss: 2.1652 - accuracy20: 0.6423 - val_loss: 2.3540 - val_accuracy20: 0.6888 - 56s/epoch - 37ms/step
Epoch 16/50
1504/1504 - 56s - loss: 2.1601 - accuracy20: 0.6436 - val_loss: 2.3521 - val_accuracy20: 0.6786 - 56s/epoch - 37ms/step
Epoch 17/50
1504/1504 - 56s - loss: 2.1557 - accuracy20: 0.6443 - val_loss: 2.3561 - val_accuracy20: 0.6786 - 56s/epoch - 37ms/step
Epoch 18/50
1504/1504 - 57s - loss: 2.1519 - accuracy20: 0.6448 - val_loss: 2.3422 - val_accuracy20: 0.6787 - 57s/epoch - 38ms/step
Epoch 19/50
1504/1504 - 56s - loss: 2.1474 - accuracy20: 0.6444 - val_loss: 2.3450 - val_accuracy20: 0.6835 - 56s/epoch - 37ms/step
Epoch 20/50
1504/1504 - 57s - loss: 2.1442 - accuracy20: 0.6453 - val_loss: 2.3515 - val_accuracy20: 0.6797 - 57s/epoch - 38ms/step
Epoch 21/50
1504/1504 - 57s - loss: 2.1385 - accuracy20: 0.6457 - val_loss: 2.3502 - val_accuracy20: 0.6843 - 57s/epoch - 38ms/step
Epoch 22/50
1504/1504 - 57s - loss: 2.1369 - accuracy20: 0.6459 - val_loss: 2.3451 - val_accuracy20: 0.6849 - 57s/epoch - 38ms/step
Epoch 23/50
1504/1504 - 57s - loss: 2.1327 - accuracy20: 0.6466 - val_loss: 2.3542 - val_accuracy20: 0.6859 - 57s/epoch - 38ms/step
Epoch 24/50
1504/1504 - 56s - loss: 2.1280 - accuracy20: 0.6480 - val_loss: 2.3469 - val_accuracy20: 0.6847 - 56s/epoch - 38ms/step
Epoch 25/50
1504/1504 - 57s - loss: 2.1241 - accuracy20: 0.6477 - val_loss: 2.3435 - val_accuracy20: 0.6822 - 57s/epoch - 38ms/step
Epoch 26/50
1504/1504 - 56s - loss: 2.1217 - accuracy20: 0.6482 - val_loss: 2.3460 - val_accuracy20: 0.6840 - 56s/epoch - 37ms/step
Epoch 27/50
1504/1504 - 56s - loss: 2.1190 - accuracy20: 0.6483 - val_loss: 2.3401 - val_accuracy20: 0.6828 - 56s/epoch - 37ms/step
Epoch 28/50
1504/1504 - 56s - loss: 2.1151 - accuracy20: 0.6484 - val_loss: 2.3401 - val_accuracy20: 0.6840 - 56s/epoch - 37ms/step
Epoch 29/50
1504/1504 - 56s - loss: 2.1117 - accuracy20: 0.6486 - val_loss: 2.3541 - val_accuracy20: 0.6884 - 56s/epoch - 38ms/step
Epoch 30/50
1504/1504 - 56s - loss: 2.1094 - accuracy20: 0.6487 - val_loss: 2.3418 - val_accuracy20: 0.6824 - 56s/epoch - 37ms/step
Epoch 31/50
1504/1504 - 57s - loss: 2.1056 - accuracy20: 0.6490 - val_loss: 2.3547 - val_accuracy20: 0.6849 - 57s/epoch - 38ms/step
Epoch 32/50
1504/1504 - 57s - loss: 2.1034 - accuracy20: 0.6494 - val_loss: 2.3519 - val_accuracy20: 0.6848 - 57s/epoch - 38ms/step
Epoch 33/50
1504/1504 - 56s - loss: 2.0994 - accuracy20: 0.6493 - val_loss: 2.3707 - val_accuracy20: 0.6864 - 56s/epoch - 37ms/step
Epoch 34/50
1504/1504 - 56s - loss: 2.0970 - accuracy20: 0.6498 - val_loss: 2.3527 - val_accuracy20: 0.6804 - 56s/epoch - 37ms/step
Epoch 35/50
1504/1504 - 56s - loss: 2.0934 - accuracy20: 0.6505 - val_loss: 2.3586 - val_accuracy20: 0.6827 - 56s/epoch - 37ms/step
Epoch 36/50
1504/1504 - 56s - loss: 2.0905 - accuracy20: 0.6502 - val_loss: 2.3710 - val_accuracy20: 0.6861 - 56s/epoch - 38ms/step
Epoch 37/50
1504/1504 - 56s - loss: 2.0881 - accuracy20: 0.6512 - val_loss: 2.3590 - val_accuracy20: 0.6822 - 56s/epoch - 37ms/step
Epoch 38/50
1504/1504 - 56s - loss: 2.0865 - accuracy20: 0.6514 - val_loss: 2.3689 - val_accuracy20: 0.6815 - 56s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h20
Evaluating performance on  test set...
4450/4450 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73931915
{'0': {'precision': 0.4865835823742608, 'recall': 0.6182489477043392, 'f1-score': 0.5445708369062825, 'support': 247554}, '1': {'precision': 0.7892905584714277, 'recall': 0.7242581008246932, 'f1-score': 0.7553772088744405, 'support': 646786}, '2': {'precision': 0.5473503371039353, 'recall': 0.5167271969638166, 'f1-score': 0.5315981145992473, 'support': 244781}, 'accuracy': 0.6566247132657549, 'macro avg': {'precision': 0.6077414926498745, 'recall': 0.6197447484976163, 'f1-score': 0.6105153867933234, 'support': 1139121}, 'weighted avg': {'precision': 0.6715166853821649, 'recall': 0.6566247132657549, 'f1-score': 0.6614777626505701, 'support': 1139121}}
[[153050  53923  40581]
 [114326 468440  64020]
 [ 47164  71132 126485]]
Evaluating performance on  train set...
1504/1504 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6831746
{'0': {'precision': 0.4839351946663026, 'recall': 0.6062657677560969, 'f1-score': 0.538237173606322, 'support': 70159}, '1': {'precision': 0.8172493131101034, 'recall': 0.749346627450659, 'f1-score': 0.7818263799997006, 'support': 244118}, '2': {'precision': 0.5262416199206458, 'recall': 0.5452496385132262, 'f1-score': 0.5355770301882589, 'support': 70542}, 'accuracy': 0.6858471125386221, 'macro avg': {'precision': 0.6091420425656838, 'recall': 0.6336206779066608, 'f1-score': 0.6185468612647606, 'support': 384819}, 'weighted avg': {'precision': 0.7031352752666774, 'recall': 0.6858471125386221, 'f1-score': 0.6922754566675581, 'support': 384819}}
[[ 42535  17795   9829]
 [ 36391 182929  24798]
 [  8968  23111  38463]]
Evaluating performance on  val set...
510/510 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6973877
{'0': {'precision': 0.4804843840864776, 'recall': 0.5987978002302085, 'f1-score': 0.5331561966217498, 'support': 23457}, '1': {'precision': 0.8155636934344755, 'recall': 0.7506410024917843, 'f1-score': 0.781756752521422, 'support': 83073}, '2': {'precision': 0.5110403739221533, 'recall': 0.5288770276468872, 'f1-score': 0.5198057337240517, 'support': 23981}, 'accuracy': 0.68260146654305, 'macro avg': {'precision': 0.6023628171477021, 'recall': 0.6261052767896267, 'f1-score': 0.6115728942890745, 'support': 130511}, 'weighted avg': {'precision': 0.6993839914583894, 'recall': 0.68260146654305, 'f1-score': 0.6889425788386033, 'support': 130511}}
[[14046  5949  3462]
 [12042 62358  8673]
 [ 3145  8153 12683]]
training model: results/EXC/W6/deepVOL_L3/h30
Epoch 1/50
1504/1504 - 58s - loss: 2.9203 - accuracy30: 0.4611 - val_loss: 2.6962 - val_accuracy30: 0.6185 - 58s/epoch - 39ms/step
Epoch 2/50
1504/1504 - 57s - loss: 2.5463 - accuracy30: 0.5867 - val_loss: 2.5962 - val_accuracy30: 0.6385 - 57s/epoch - 38ms/step
Epoch 3/50
1504/1504 - 57s - loss: 2.4484 - accuracy30: 0.6054 - val_loss: 2.5695 - val_accuracy30: 0.6533 - 57s/epoch - 38ms/step
Epoch 4/50
1504/1504 - 55s - loss: 2.4102 - accuracy30: 0.6110 - val_loss: 2.5689 - val_accuracy30: 0.6557 - 55s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 56s - loss: 2.3904 - accuracy30: 0.6148 - val_loss: 2.5649 - val_accuracy30: 0.6567 - 56s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 56s - loss: 2.3742 - accuracy30: 0.6166 - val_loss: 2.5453 - val_accuracy30: 0.6520 - 56s/epoch - 37ms/step
Epoch 7/50
1504/1504 - 55s - loss: 2.3610 - accuracy30: 0.6187 - val_loss: 2.5428 - val_accuracy30: 0.6545 - 55s/epoch - 37ms/step
Epoch 8/50
1504/1504 - 55s - loss: 2.3497 - accuracy30: 0.6194 - val_loss: 2.5304 - val_accuracy30: 0.6566 - 55s/epoch - 37ms/step
Epoch 9/50
1504/1504 - 55s - loss: 2.3415 - accuracy30: 0.6205 - val_loss: 2.5450 - val_accuracy30: 0.6563 - 55s/epoch - 37ms/step
Epoch 10/50
1504/1504 - 55s - loss: 2.3324 - accuracy30: 0.6209 - val_loss: 2.5275 - val_accuracy30: 0.6574 - 55s/epoch - 37ms/step
Epoch 11/50
1504/1504 - 56s - loss: 2.3250 - accuracy30: 0.6211 - val_loss: 2.5360 - val_accuracy30: 0.6539 - 56s/epoch - 37ms/step
Epoch 12/50
1504/1504 - 55s - loss: 2.3188 - accuracy30: 0.6220 - val_loss: 2.5393 - val_accuracy30: 0.6605 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 2.3137 - accuracy30: 0.6222 - val_loss: 2.5379 - val_accuracy30: 0.6600 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 56s - loss: 2.3084 - accuracy30: 0.6234 - val_loss: 2.5230 - val_accuracy30: 0.6577 - 56s/epoch - 37ms/step
Epoch 15/50
1504/1504 - 56s - loss: 2.3030 - accuracy30: 0.6236 - val_loss: 2.5209 - val_accuracy30: 0.6606 - 56s/epoch - 37ms/step
Epoch 16/50
1504/1504 - 55s - loss: 2.2976 - accuracy30: 0.6244 - val_loss: 2.5303 - val_accuracy30: 0.6590 - 55s/epoch - 37ms/step
Epoch 17/50
1504/1504 - 55s - loss: 2.2949 - accuracy30: 0.6252 - val_loss: 2.5317 - val_accuracy30: 0.6595 - 55s/epoch - 37ms/step
Epoch 18/50
1504/1504 - 56s - loss: 2.2903 - accuracy30: 0.6262 - val_loss: 2.5371 - val_accuracy30: 0.6599 - 56s/epoch - 37ms/step
Epoch 19/50
1504/1504 - 56s - loss: 2.2861 - accuracy30: 0.6264 - val_loss: 2.5380 - val_accuracy30: 0.6608 - 56s/epoch - 37ms/step
Epoch 20/50
1504/1504 - 56s - loss: 2.2825 - accuracy30: 0.6265 - val_loss: 2.5226 - val_accuracy30: 0.6581 - 56s/epoch - 37ms/step
Epoch 21/50
1504/1504 - 56s - loss: 2.2791 - accuracy30: 0.6273 - val_loss: 2.5418 - val_accuracy30: 0.6607 - 56s/epoch - 37ms/step
Epoch 22/50
1504/1504 - 56s - loss: 2.2760 - accuracy30: 0.6274 - val_loss: 2.5299 - val_accuracy30: 0.6591 - 56s/epoch - 37ms/step
Epoch 23/50
1504/1504 - 56s - loss: 2.2733 - accuracy30: 0.6282 - val_loss: 2.5570 - val_accuracy30: 0.6634 - 56s/epoch - 37ms/step
Epoch 24/50
1504/1504 - 56s - loss: 2.2699 - accuracy30: 0.6276 - val_loss: 2.5399 - val_accuracy30: 0.6601 - 56s/epoch - 37ms/step
Epoch 25/50
1504/1504 - 55s - loss: 2.2660 - accuracy30: 0.6285 - val_loss: 2.5518 - val_accuracy30: 0.6617 - 55s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h30
Evaluating performance on  test set...
4450/4450 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7894692
{'0': {'precision': 0.5227499657380034, 'recall': 0.5605266472596988, 'f1-score': 0.5409796207810627, 'support': 285808}, '1': {'precision': 0.7101279593501867, 'recall': 0.7505740477818093, 'f1-score': 0.7297910378572391, 'support': 570510}, '2': {'precision': 0.5735690492260129, 'recall': 0.46577652995194535, 'f1-score': 0.5140831053471699, 'support': 282803}, 'accuracy': 0.6321856940570844, 'macro avg': {'precision': 0.6021489914380677, 'recall': 0.5922924083311512, 'f1-score': 0.594951254661824, 'support': 1139121}, 'weighted avg': {'precision': 0.6292117098401192, 'recall': 0.6321856940570844, 'f1-score': 0.6288652679615451, 'support': 1139121}}
[[160203  82351  43254]
 [ 87622 428210  54678]
 [ 58637  92443 131723]]
Evaluating performance on  train set...
1504/1504 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7377397
{'0': {'precision': 0.5291397321034791, 'recall': 0.5072110158231671, 'f1-score': 0.5179433730704476, 'support': 82790}, '1': {'precision': 0.7394314837536143, 'recall': 0.7870283697334716, 'f1-score': 0.7624878621717809, 'support': 219001}, '2': {'precision': 0.5641773306431552, 'recall': 0.49170159464277113, 'f1-score': 0.52545208829397, 'support': 83028}, 'accuracy': 0.6631091500159816, 'macro avg': {'precision': 0.6109161821667496, 'recall': 0.59531366006647, 'f1-score': 0.6019611078453995, 'support': 384819}, 'weighted avg': {'precision': 0.6563767074988818, 'recall': 0.6631091500159816, 'f1-score': 0.6587340337843409, 'support': 384819}}
[[ 41992  29259  11539]
 [ 26643 172360  19998]
 [ 10724  31479  40825]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7454757
{'0': {'precision': 0.5260185847033595, 'recall': 0.5319118178532707, 'f1-score': 0.5289487870619947, 'support': 27670}, '1': {'precision': 0.7422865419865919, 'recall': 0.7782182741798928, 'f1-score': 0.7598278486327613, 'support': 74411}, '2': {'precision': 0.556815400929929, 'recall': 0.4801969750263806, 'f1-score': 0.5156757573468309, 'support': 28430}, 'accuracy': 0.6610783765353112, 'macro avg': {'precision': 0.6083735092066268, 'recall': 0.596775689019848, 'f1-score': 0.6014841310138622, 'support': 130511}, 'weighted avg': {'precision': 0.6560326712916469, 'recall': 0.6610783765353112, 'f1-score': 0.6576934110074109, 'support': 130511}}
[[14718  9298  3654]
 [ 9291 57908  7212]
 [ 3971 10807 13652]]
training model: results/EXC/W6/deepVOL_L3/h50
Epoch 1/50
1504/1504 - 58s - loss: 3.0672 - accuracy50: 0.4385 - val_loss: 3.0309 - val_accuracy50: 0.5365 - 58s/epoch - 38ms/step
Epoch 2/50
1504/1504 - 55s - loss: 2.7731 - accuracy50: 0.5478 - val_loss: 2.8178 - val_accuracy50: 0.5760 - 55s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 56s - loss: 2.6799 - accuracy50: 0.5662 - val_loss: 2.7992 - val_accuracy50: 0.5848 - 56s/epoch - 37ms/step
Epoch 4/50
1504/1504 - 55s - loss: 2.6394 - accuracy50: 0.5760 - val_loss: 2.8082 - val_accuracy50: 0.5864 - 55s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 55s - loss: 2.6205 - accuracy50: 0.5790 - val_loss: 2.8023 - val_accuracy50: 0.5892 - 55s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 55s - loss: 2.6087 - accuracy50: 0.5812 - val_loss: 2.8068 - val_accuracy50: 0.5890 - 55s/epoch - 37ms/step
Epoch 7/50
1504/1504 - 56s - loss: 2.5997 - accuracy50: 0.5826 - val_loss: 2.7952 - val_accuracy50: 0.5895 - 56s/epoch - 37ms/step
Epoch 8/50
1504/1504 - 55s - loss: 2.5902 - accuracy50: 0.5842 - val_loss: 2.8074 - val_accuracy50: 0.5907 - 55s/epoch - 37ms/step
Epoch 9/50
1504/1504 - 55s - loss: 2.5828 - accuracy50: 0.5849 - val_loss: 2.7904 - val_accuracy50: 0.5912 - 55s/epoch - 37ms/step
Epoch 10/50
1504/1504 - 55s - loss: 2.5752 - accuracy50: 0.5860 - val_loss: 2.8090 - val_accuracy50: 0.5918 - 55s/epoch - 36ms/step
Epoch 11/50
1504/1504 - 55s - loss: 2.5690 - accuracy50: 0.5860 - val_loss: 2.8189 - val_accuracy50: 0.5917 - 55s/epoch - 37ms/step
Epoch 12/50
1504/1504 - 55s - loss: 2.5626 - accuracy50: 0.5874 - val_loss: 2.8193 - val_accuracy50: 0.5934 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 2.5569 - accuracy50: 0.5879 - val_loss: 2.8005 - val_accuracy50: 0.5933 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 55s - loss: 2.5507 - accuracy50: 0.5889 - val_loss: 2.8162 - val_accuracy50: 0.5918 - 55s/epoch - 37ms/step
Epoch 15/50
1504/1504 - 55s - loss: 2.5479 - accuracy50: 0.5888 - val_loss: 2.8137 - val_accuracy50: 0.5915 - 55s/epoch - 36ms/step
Epoch 16/50
1504/1504 - 54s - loss: 2.5409 - accuracy50: 0.5902 - val_loss: 2.8073 - val_accuracy50: 0.5900 - 54s/epoch - 36ms/step
Epoch 17/50
1504/1504 - 55s - loss: 2.5368 - accuracy50: 0.5911 - val_loss: 2.8179 - val_accuracy50: 0.5919 - 55s/epoch - 37ms/step
Epoch 18/50
1504/1504 - 55s - loss: 2.5323 - accuracy50: 0.5912 - val_loss: 2.8096 - val_accuracy50: 0.5918 - 55s/epoch - 37ms/step
Epoch 19/50
1504/1504 - 55s - loss: 2.5281 - accuracy50: 0.5923 - val_loss: 2.8267 - val_accuracy50: 0.5922 - 55s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h50
Evaluating performance on  test set...
4450/4450 - 71s - 71s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90313727
{'0': {'precision': 0.5536710849084348, 'recall': 0.46927500447202275, 'f1-score': 0.507991581460166, 'support': 341009}, '1': {'precision': 0.554569965330271, 'recall': 0.7695252463549468, 'f1-score': 0.6445995505847133, 'support': 460007}, '2': {'precision': 0.5924602069099031, 'recall': 0.37110660889368685, 'f1-score': 0.45635838570763504, 'support': 338105}, 'accuracy': 0.5613863672076979, 'macro avg': {'precision': 0.5669004190495363, 'recall': 0.5366356199068855, 'f1-score': 0.5363165059175047, 'support': 1139121}, 'weighted avg': {'precision': 0.5655471607427967, 'recall': 0.5613863672076979, 'f1-score': 0.5478321079741765, 'support': 1139121}}
[[160027 134793  46189]
 [ 65899 353987  40121]
 [ 63103 149529 125473]]
Evaluating performance on  train set...
1504/1504 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8685835
{'0': {'precision': 0.557573313505816, 'recall': 0.4320534354126792, 'f1-score': 0.48685318148056456, 'support': 102404}, '1': {'precision': 0.5989258176908854, 'recall': 0.7934853854443247, 'f1-score': 0.6826128405645433, 'support': 180026}, '2': {'precision': 0.5995878197756903, 'recall': 0.39212220062702047, 'f1-score': 0.4741541186891054, 'support': 102389}, 'accuracy': 0.5905139818979832, 'macro avg': {'precision': 0.5853623169907972, 'recall': 0.5392203404946748, 'f1-score': 0.5478733802447378, 'support': 384819}, 'weighted avg': {'precision': 0.5880976618381163, 'recall': 0.5905139818979832, 'f1-score': 0.5750546061661899, 'support': 384819}}
[[ 44244  46160  12000]
 [ 22366 142848  14812]
 [ 12741  49499  40149]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8690489
{'0': {'precision': 0.5500780484263259, 'recall': 0.44584694147762377, 'f1-score': 0.49250820684499624, 'support': 33987}, '1': {'precision': 0.6043231200560729, 'recall': 0.7865858625352297, 'f1-score': 0.6835127655207073, 'support': 61383}, '2': {'precision': 0.5924224033292873, 'recall': 0.38889046982157593, 'f1-score': 0.469549382397911, 'support': 35141}, 'accuracy': 0.5907701266559907, 'macro avg': {'precision': 0.5822745239372287, 'recall': 0.5404410912781431, 'f1-score': 0.5485234515878715, 'support': 130511}, 'weighted avg': {'precision': 0.5869925476447346, 'recall': 0.5907701266559907, 'f1-score': 0.5761612075521868, 'support': 130511}}
[[15153 14898  3936]
 [ 7634 48283  5466]
 [ 4760 16715 13666]]
training model: results/EXC/W6/deepVOL_L3/h100
Epoch 1/50
1504/1504 - 58s - loss: 3.1998 - accuracy100: 0.4090 - val_loss: 3.2558 - val_accuracy100: 0.3712 - 58s/epoch - 38ms/step
Epoch 2/50
1504/1504 - 55s - loss: 3.0652 - accuracy100: 0.4700 - val_loss: 3.0681 - val_accuracy100: 0.4750 - 55s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 55s - loss: 2.9775 - accuracy100: 0.4907 - val_loss: 3.0524 - val_accuracy100: 0.4680 - 55s/epoch - 36ms/step
Epoch 4/50
1504/1504 - 55s - loss: 2.9418 - accuracy100: 0.4980 - val_loss: 3.0437 - val_accuracy100: 0.4697 - 55s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 55s - loss: 2.9253 - accuracy100: 0.5019 - val_loss: 3.0433 - val_accuracy100: 0.4724 - 55s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 55s - loss: 2.9136 - accuracy100: 0.5046 - val_loss: 3.0477 - val_accuracy100: 0.4740 - 55s/epoch - 36ms/step
Epoch 7/50
1504/1504 - 55s - loss: 2.9065 - accuracy100: 0.5068 - val_loss: 3.0499 - val_accuracy100: 0.4702 - 55s/epoch - 36ms/step
Epoch 8/50
1504/1504 - 55s - loss: 2.9013 - accuracy100: 0.5085 - val_loss: 3.0661 - val_accuracy100: 0.4648 - 55s/epoch - 36ms/step
Epoch 9/50
1504/1504 - 55s - loss: 2.8953 - accuracy100: 0.5095 - val_loss: 3.0658 - val_accuracy100: 0.4666 - 55s/epoch - 37ms/step
Epoch 10/50
1504/1504 - 55s - loss: 2.8904 - accuracy100: 0.5113 - val_loss: 3.0705 - val_accuracy100: 0.4640 - 55s/epoch - 37ms/step
Epoch 11/50
1504/1504 - 55s - loss: 2.8860 - accuracy100: 0.5128 - val_loss: 3.0853 - val_accuracy100: 0.4602 - 55s/epoch - 36ms/step
Epoch 12/50
1504/1504 - 55s - loss: 2.8814 - accuracy100: 0.5144 - val_loss: 3.0815 - val_accuracy100: 0.4612 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 2.8778 - accuracy100: 0.5150 - val_loss: 3.0904 - val_accuracy100: 0.4603 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 56s - loss: 2.8738 - accuracy100: 0.5166 - val_loss: 3.0920 - val_accuracy100: 0.4630 - 56s/epoch - 37ms/step
Epoch 15/50
1504/1504 - 56s - loss: 2.8686 - accuracy100: 0.5176 - val_loss: 3.0963 - val_accuracy100: 0.4623 - 56s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h100
Evaluating performance on  test set...
4450/4450 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0335782
{'0': {'precision': 0.5474968969797269, 'recall': 0.29216363538237355, 'f1-score': 0.3810079850536176, 'support': 407638}, '1': {'precision': 0.3773990287370786, 'recall': 0.7441918170789986, 'f1-score': 0.5008194744231209, 'support': 326436}, '2': {'precision': 0.523007056672892, 'recall': 0.35882255639469, 'f1-score': 0.4256303628430023, 'support': 405047}, 'accuracy': 0.44540307833847326, 'macro avg': {'precision': 0.48263432746323254, 'recall': 0.4650593362853541, 'f1-score': 0.4358192741065803, 'support': 1139121}, 'weighted avg': {'precision': 0.4900441732880211, 'recall': 0.44540307833847326, 'f1-score': 0.43120892384789855, 'support': 1139121}}
[[119097 201005  87536]
 [ 38488 242931  45017]
 [ 59945 199762 145340]]
Evaluating performance on  train set...
1504/1504 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0274571
{'0': {'precision': 0.5651344775432366, 'recall': 0.2668074075223918, 'f1-score': 0.36248220593662683, 'support': 128842}, '1': {'precision': 0.4076295585412668, 'recall': 0.7789450386144641, 'f1-score': 0.5351893138104173, 'support': 126507}, '2': {'precision': 0.5486157549819446, 'recall': 0.3485131690739167, 'f1-score': 0.42624824647997084, 'support': 129470}, 'accuracy': 0.4626590682892477, 'macro avg': {'precision': 0.5071265970221494, 'recall': 0.4647552050702575, 'f1-score': 0.44130658874233836, 'support': 384819}, 'weighted avg': {'precision': 0.5077980315824273, 'recall': 0.4626590682892477, 'f1-score': 0.44071235404505277, 'support': 384819}}
[[34376 72252 22214]
 [13054 98542 14911]
 [13398 70950 45122]]
Evaluating performance on  val set...
510/510 - 9s - 9s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0161215
{'0': {'precision': 0.5557379423550427, 'recall': 0.2750406193252413, 'f1-score': 0.3679693119156078, 'support': 41852}, '1': {'precision': 0.42596336532372, 'recall': 0.7869807839431169, 'f1-score': 0.5527459502173054, 'support': 44442}, '2': {'precision': 0.5509570241964609, 'recall': 0.34502566886039304, 'f1-score': 0.4243258653538598, 'support': 44217}, 'accuracy': 0.47307889756418997, 'macro avg': {'precision': 0.5108861106250745, 'recall': 0.4690156907095837, 'f1-score': 0.44834704249559104, 'support': 130511}, 'weighted avg': {'precision': 0.509926940901954, 'recall': 0.47307889756418997, 'f1-score': 0.44998355655999206, 'support': 130511}}
[[11511 23088  7253]
 [ 4286 34975  5181]
 [ 4916 24045 15256]]
training model: results/EXC/W6/deepVOL_L3/h200
Epoch 1/50
1504/1504 - 58s - loss: 3.2640 - accuracy200: 0.3914 - val_loss: 3.2854 - val_accuracy200: 0.3816 - 58s/epoch - 39ms/step
Epoch 2/50
1504/1504 - 55s - loss: 3.2228 - accuracy200: 0.4084 - val_loss: 3.2488 - val_accuracy200: 0.3895 - 55s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 55s - loss: 3.2081 - accuracy200: 0.4149 - val_loss: 3.2574 - val_accuracy200: 0.3903 - 55s/epoch - 37ms/step
Epoch 4/50
1504/1504 - 55s - loss: 3.1934 - accuracy200: 0.4226 - val_loss: 3.2404 - val_accuracy200: 0.3981 - 55s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 55s - loss: 3.1850 - accuracy200: 0.4263 - val_loss: 3.2504 - val_accuracy200: 0.3983 - 55s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 55s - loss: 3.1786 - accuracy200: 0.4294 - val_loss: 3.2441 - val_accuracy200: 0.4003 - 55s/epoch - 37ms/step
Epoch 7/50
1504/1504 - 55s - loss: 3.1741 - accuracy200: 0.4313 - val_loss: 3.2494 - val_accuracy200: 0.3968 - 55s/epoch - 37ms/step
Epoch 8/50
1504/1504 - 55s - loss: 3.1691 - accuracy200: 0.4337 - val_loss: 3.2579 - val_accuracy200: 0.3969 - 55s/epoch - 37ms/step
Epoch 9/50
1504/1504 - 55s - loss: 3.1632 - accuracy200: 0.4357 - val_loss: 3.2650 - val_accuracy200: 0.3932 - 55s/epoch - 36ms/step
Epoch 10/50
1504/1504 - 55s - loss: 3.1584 - accuracy200: 0.4377 - val_loss: 3.2694 - val_accuracy200: 0.3902 - 55s/epoch - 36ms/step
Epoch 11/50
1504/1504 - 55s - loss: 3.1534 - accuracy200: 0.4404 - val_loss: 3.2959 - val_accuracy200: 0.3886 - 55s/epoch - 37ms/step
Epoch 12/50
1504/1504 - 55s - loss: 3.1472 - accuracy200: 0.4423 - val_loss: 3.3355 - val_accuracy200: 0.3878 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 3.1394 - accuracy200: 0.4450 - val_loss: 3.3234 - val_accuracy200: 0.3914 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 55s - loss: 3.1329 - accuracy200: 0.4472 - val_loss: 3.3462 - val_accuracy200: 0.3918 - 55s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h200
Evaluating performance on  test set...
4450/4450 - 72s - 72s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.100598
{'0': {'precision': 0.46503282117867706, 'recall': 0.20336216187797376, 'f1-score': 0.28297662985628225, 'support': 380410}, '1': {'precision': 0.3351918445448847, 'recall': 0.5781536949380512, 'f1-score': 0.4243572559547089, 'support': 386610}, '2': {'precision': 0.3861494559088398, 'recall': 0.31747294417375926, 'f1-score': 0.3484596415466119, 'support': 372101}, 'accuracy': 0.3678388862991728, 'macro avg': {'precision': 0.39545804054413386, 'recall': 0.36632960032992806, 'f1-score': 0.3519311757858677, 'support': 1139121}, 'weighted avg': {'precision': 0.3951979229750076, 'recall': 0.3678388862991728, 'f1-score': 0.35235069809740516, 'support': 1139121}}
[[ 77361 225151  77898]
 [ 53197 223520 109893]
 [ 35798 218171 118132]]
Evaluating performance on  train set...
1504/1504 - 26s - 26s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983933
{'0': {'precision': 0.4656911883589329, 'recall': 0.22279375933045073, 'f1-score': 0.30139537803914596, 'support': 129281}, '1': {'precision': 0.3315564211146086, 'recall': 0.582595201145995, 'f1-score': 0.4226064367152547, 'support': 125655}, '2': {'precision': 0.42551921232407464, 'recall': 0.33473972729302526, 'f1-score': 0.37470966185032123, 'support': 129883}, 'accuracy': 0.37806345320787177, 'macro avg': {'precision': 0.4075889405992054, 'recall': 0.380042895923157, 'f1-score': 0.36623715886824065, 'support': 384819}, 'weighted avg': {'precision': 0.4083334151163927, 'recall': 0.37806345320787177, 'f1-score': 0.36571926719792797, 'support': 384819}}
[[28803 73986 26492]
 [20244 73206 32205]
 [12803 73603 43477]]
Evaluating performance on  val set...
510/510 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0811538
{'0': {'precision': 0.4379587732528909, 'recall': 0.217992992992993, 'f1-score': 0.29109440267335, 'support': 39960}, '1': {'precision': 0.3727779251790926, 'recall': 0.6275790190156124, 'f1-score': 0.4677282563033535, 'support': 47014}, '2': {'precision': 0.43321047280122016, 'recall': 0.31315892229597814, 'f1-score': 0.3635297097681611, 'support': 43537}, 'accuracy': 0.3972845200787673, 'macro avg': {'precision': 0.41464905707773453, 'recall': 0.3862436447681945, 'f1-score': 0.37411745624828824, 'support': 130511}, 'weighted avg': {'precision': 0.41289468556598374, 'recall': 0.3972845200787673, 'f1-score': 0.3788868489770928, 'support': 130511}}
[[ 8711 24057  7192]
 [ 6863 29505 10646]
 [ 4316 25587 13634]]
training model: results/EXC/W6/deepVOL_L3/h300
Epoch 1/50
1504/1504 - 58s - loss: 3.2871 - accuracy300: 0.3746 - val_loss: 3.3142 - val_accuracy300: 0.3642 - 58s/epoch - 39ms/step
Epoch 2/50
1504/1504 - 55s - loss: 3.2559 - accuracy300: 0.3890 - val_loss: 3.2748 - val_accuracy300: 0.3873 - 55s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 57s - loss: 3.2405 - accuracy300: 0.3989 - val_loss: 3.2698 - val_accuracy300: 0.3904 - 57s/epoch - 38ms/step
Epoch 4/50
1504/1504 - 55s - loss: 3.2304 - accuracy300: 0.4053 - val_loss: 3.2679 - val_accuracy300: 0.3914 - 55s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 55s - loss: 3.2174 - accuracy300: 0.4133 - val_loss: 3.2715 - val_accuracy300: 0.3965 - 55s/epoch - 37ms/step
Epoch 6/50
1504/1504 - 57s - loss: 3.2062 - accuracy300: 0.4197 - val_loss: 3.2659 - val_accuracy300: 0.3968 - 57s/epoch - 38ms/step
Epoch 7/50
1504/1504 - 55s - loss: 3.1966 - accuracy300: 0.4248 - val_loss: 3.2748 - val_accuracy300: 0.3940 - 55s/epoch - 36ms/step
Epoch 8/50
1504/1504 - 55s - loss: 3.1897 - accuracy300: 0.4278 - val_loss: 3.2744 - val_accuracy300: 0.3957 - 55s/epoch - 36ms/step
Epoch 9/50
1504/1504 - 55s - loss: 3.1833 - accuracy300: 0.4309 - val_loss: 3.2868 - val_accuracy300: 0.3945 - 55s/epoch - 36ms/step
Epoch 10/50
1504/1504 - 55s - loss: 3.1754 - accuracy300: 0.4340 - val_loss: 3.2966 - val_accuracy300: 0.3948 - 55s/epoch - 37ms/step
Epoch 11/50
1504/1504 - 55s - loss: 3.1696 - accuracy300: 0.4365 - val_loss: 3.2882 - val_accuracy300: 0.3973 - 55s/epoch - 37ms/step
Epoch 12/50
1504/1504 - 55s - loss: 3.1639 - accuracy300: 0.4401 - val_loss: 3.2996 - val_accuracy300: 0.3935 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 3.1577 - accuracy300: 0.4421 - val_loss: 3.3063 - val_accuracy300: 0.3914 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 55s - loss: 3.1522 - accuracy300: 0.4444 - val_loss: 3.3350 - val_accuracy300: 0.3877 - 55s/epoch - 37ms/step
Epoch 15/50
1504/1504 - 57s - loss: 3.1481 - accuracy300: 0.4457 - val_loss: 3.3430 - val_accuracy300: 0.3877 - 57s/epoch - 38ms/step
Epoch 16/50
1504/1504 - 55s - loss: 3.1438 - accuracy300: 0.4475 - val_loss: 3.3436 - val_accuracy300: 0.3903 - 55s/epoch - 37ms/step
testing model: results/EXC/W6/deepVOL_L3/h300
Evaluating performance on  test set...
4450/4450 - 73s - 73s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1109205
{'0': {'precision': 0.442389049435169, 'recall': 0.2486392912604058, 'f1-score': 0.31835249941328325, 'support': 392810}, '1': {'precision': 0.3306717893445367, 'recall': 0.37259243348038973, 'f1-score': 0.35038269451641685, 'support': 363126}, '2': {'precision': 0.3827540427270192, 'recall': 0.5086133329853726, 'f1-score': 0.4367981478555444, 'support': 383185}, 'accuracy': 0.3756045231366993, 'macro avg': {'precision': 0.3852716271689083, 'recall': 0.37661501924205604, 'f1-score': 0.3685111139284148, 'support': 1139121}, 'weighted avg': {'precision': 0.3867156996916972, 'recall': 0.3756045231366993, 'f1-score': 0.36840652565401477, 'support': 1139121}}
[[ 97668 142705 152437]
 [ 65972 135298 161856]
 [ 57134 131158 194893]]
Evaluating performance on  train set...
1504/1504 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0975538
{'0': {'precision': 0.4427800486557911, 'recall': 0.27852653983888886, 'f1-score': 0.3419516661262327, 'support': 128731}, '1': {'precision': 0.36460454522878694, 'recall': 0.40451056795371354, 'f1-score': 0.38352228201243405, 'support': 127035}, '2': {'precision': 0.39885084989226716, 'recall': 0.5034675675885102, 'f1-score': 0.4450944662894409, 'support': 129053}, 'accuracy': 0.3955521946681427, 'macro avg': {'precision': 0.4020784812589484, 'recall': 0.3955015584603709, 'f1-score': 0.3901894714760359, 'support': 384819}, 'weighted avg': {'precision': 0.4022409381496089, 'recall': 0.3955521946681427, 'f1-score': 0.3902647976986501, 'support': 384819}}
[[35855 45526 47350]
 [25069 51387 50579]
 [20053 44026 64974]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088361
{'0': {'precision': 0.4037910513555213, 'recall': 0.27689749855152784, 'f1-score': 0.3285165648022236, 'support': 39697}, '1': {'precision': 0.3842914645474249, 'recall': 0.4025558414599866, 'f1-score': 0.39321167574874333, 'support': 46247}, '2': {'precision': 0.40606082707315294, 'recall': 0.4996970852873202, 'f1-score': 0.4480389494120369, 'support': 44567}, 'accuracy': 0.3975067235711932, 'macro avg': {'precision': 0.39804778099203303, 'recall': 0.39305014176627817, 'f1-score': 0.3899223966543346, 'support': 130511}, 'weighted avg': {'precision': 0.39765639376569095, 'recall': 0.3975067235711932, 'f1-score': 0.3922560879906847, 'support': 130511}}
[[10992 14621 14084]
 [ 9140 18617 18490]
 [ 7090 15207 22270]]
training model: results/EXC/W6/deepVOL_L3/h500
Epoch 1/50
1504/1504 - 58s - loss: 3.2618 - accuracy500: 0.3931 - val_loss: 3.2838 - val_accuracy500: 0.3481 - 58s/epoch - 39ms/step
Epoch 2/50
1504/1504 - 55s - loss: 3.2510 - accuracy500: 0.4030 - val_loss: 3.3525 - val_accuracy500: 0.2917 - 55s/epoch - 37ms/step
Epoch 3/50
1504/1504 - 54s - loss: 3.2478 - accuracy500: 0.4077 - val_loss: 3.3375 - val_accuracy500: 0.3195 - 54s/epoch - 36ms/step
Epoch 4/50
1504/1504 - 54s - loss: 3.2351 - accuracy500: 0.4130 - val_loss: 3.2779 - val_accuracy500: 0.3516 - 54s/epoch - 36ms/step
Epoch 5/50
1504/1504 - 55s - loss: 3.2211 - accuracy500: 0.4207 - val_loss: 3.3023 - val_accuracy500: 0.3343 - 55s/epoch - 36ms/step
Epoch 6/50
1504/1504 - 55s - loss: 3.2183 - accuracy500: 0.4205 - val_loss: 3.3424 - val_accuracy500: 0.2948 - 55s/epoch - 36ms/step
Epoch 7/50
1504/1504 - 55s - loss: 3.2152 - accuracy500: 0.4214 - val_loss: 3.3274 - val_accuracy500: 0.3168 - 55s/epoch - 36ms/step
Epoch 8/50
1504/1504 - 55s - loss: 3.2063 - accuracy500: 0.4274 - val_loss: 3.3722 - val_accuracy500: 0.2976 - 55s/epoch - 37ms/step
Epoch 9/50
1504/1504 - 54s - loss: 3.2002 - accuracy500: 0.4277 - val_loss: 3.3712 - val_accuracy500: 0.2990 - 54s/epoch - 36ms/step
Epoch 10/50
1504/1504 - 55s - loss: 3.2006 - accuracy500: 0.4289 - val_loss: 3.3780 - val_accuracy500: 0.3001 - 55s/epoch - 36ms/step
Epoch 11/50
1504/1504 - 55s - loss: 3.1880 - accuracy500: 0.4363 - val_loss: 3.3831 - val_accuracy500: 0.3042 - 55s/epoch - 36ms/step
Epoch 12/50
1504/1504 - 55s - loss: 3.1836 - accuracy500: 0.4369 - val_loss: 3.4117 - val_accuracy500: 0.2973 - 55s/epoch - 37ms/step
Epoch 13/50
1504/1504 - 55s - loss: 3.1802 - accuracy500: 0.4377 - val_loss: 3.4501 - val_accuracy500: 0.2974 - 55s/epoch - 37ms/step
Epoch 14/50
1504/1504 - 54s - loss: 3.1682 - accuracy500: 0.4427 - val_loss: 3.4258 - val_accuracy500: 0.2990 - 54s/epoch - 36ms/step
testing model: results/EXC/W6/deepVOL_L3/h500
Evaluating performance on  test set...
4450/4450 - 71s - 71s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933553
{'0': {'precision': 0.2731957409951093, 'recall': 0.1126515651662572, 'f1-score': 0.15952387034151574, 'support': 277191}, '1': {'precision': 0.48919990091652216, 'recall': 0.3038136310259421, 'f1-score': 0.3748374831156424, 'support': 585033}, '2': {'precision': 0.25715201393214127, 'recall': 0.6143222931270472, 'f1-score': 0.36254474423719796, 'support': 276897}, 'accuracy': 0.33277500809834953, 'macro avg': {'precision': 0.33984921861459094, 'recall': 0.3435958297730822, 'f1-score': 0.29896869923145203, 'support': 1139121}, 'weighted avg': {'precision': 0.38023186955278604, 'recall': 0.33277500809834953, 'f1-score': 0.31945546649431983, 'support': 1139121}}
[[ 31226  99319 146646]
 [ 62550 177741 344742]
 [ 20523  86270 170104]]
Evaluating performance on  train set...
1504/1504 - 24s - 24s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1085435
{'0': {'precision': 0.407214284101939, 'recall': 0.14077472921934014, 'f1-score': 0.2092212770152335, 'support': 128148}, '1': {'precision': 0.33277296582327087, 'recall': 0.3056304470499718, 'f1-score': 0.3186247073867234, 'support': 127592}, '2': {'precision': 0.3584244155588292, 'recall': 0.620147351621875, 'f1-score': 0.45428646016594215, 'support': 129079}, 'accuracy': 0.35622981193756026, 'macro avg': {'precision': 0.366137221828013, 'recall': 0.35551750929706233, 'f1-score': 0.32737748152263296, 'support': 384819}, 'weighted avg': {'precision': 0.3661667679359288, 'recall': 0.35622981193756026, 'f1-score': 0.3276971611682235, 'support': 384819}}
[[18040 40332 69776]
 [15087 38996 73509]
 [11174 37857 80048]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0912554
{'0': {'precision': 0.2842748940309916, 'recall': 0.12779183456720708, 'f1-score': 0.1763210068097578, 'support': 32013}, '1': {'precision': 0.48141392863565136, 'recall': 0.3008315407583395, 'f1-score': 0.37027889469576475, 'support': 62294}, '2': {'precision': 0.29884834117083153, 'recall': 0.6371947851066181, 'f1-score': 0.4068714339885535, 'support': 36204}, 'accuracy': 0.35169449318448254, 'macro avg': {'precision': 0.3548457212791582, 'recall': 0.35527272014405487, 'f1-score': 0.31782377849802534, 'support': 130511}, 'weighted avg': {'precision': 0.3824137183593121, 'recall': 0.35169449318448254, 'f1-score': 0.33285386866471284, 'support': 130511}}
[[ 4091  9919 18003]
 [ 7433 18740 36121]
 [ 2867 10268 23069]]
training model: results/EXC/W6/deepVOL_L3/h1000
Epoch 1/50
1504/1504 - 61s - loss: 3.2462 - accuracy1000: 0.4036 - val_loss: 3.3017 - val_accuracy1000: 0.4015 - 61s/epoch - 40ms/step
Epoch 2/50
1504/1504 - 57s - loss: 3.2495 - accuracy1000: 0.3952 - val_loss: 3.2898 - val_accuracy1000: 0.3955 - 57s/epoch - 38ms/step
Epoch 3/50
1504/1504 - 57s - loss: 3.2533 - accuracy1000: 0.3942 - val_loss: 3.2634 - val_accuracy1000: 0.3986 - 57s/epoch - 38ms/step
Epoch 4/50
1504/1504 - 56s - loss: 3.2454 - accuracy1000: 0.4006 - val_loss: 3.2631 - val_accuracy1000: 0.3893 - 56s/epoch - 37ms/step
Epoch 5/50
1504/1504 - 57s - loss: 3.2481 - accuracy1000: 0.3990 - val_loss: 3.2654 - val_accuracy1000: 0.3995 - 57s/epoch - 38ms/step
Epoch 6/50
1504/1504 - 56s - loss: 3.2398 - accuracy1000: 0.4040 - val_loss: 3.2604 - val_accuracy1000: 0.4109 - 56s/epoch - 37ms/step
Epoch 7/50
1504/1504 - 57s - loss: 3.2313 - accuracy1000: 0.4073 - val_loss: 3.2612 - val_accuracy1000: 0.4023 - 57s/epoch - 38ms/step
Epoch 8/50
1504/1504 - 57s - loss: 3.2251 - accuracy1000: 0.4121 - val_loss: 3.2747 - val_accuracy1000: 0.4002 - 57s/epoch - 38ms/step
Epoch 9/50
1504/1504 - 57s - loss: 3.2182 - accuracy1000: 0.4130 - val_loss: 3.3039 - val_accuracy1000: 0.3954 - 57s/epoch - 38ms/step
Epoch 10/50
1504/1504 - 57s - loss: 3.2058 - accuracy1000: 0.4186 - val_loss: 3.3367 - val_accuracy1000: 0.3941 - 57s/epoch - 38ms/step
Epoch 11/50
1504/1504 - 57s - loss: 3.1985 - accuracy1000: 0.4210 - val_loss: 3.3565 - val_accuracy1000: 0.3912 - 57s/epoch - 38ms/step
Epoch 12/50
1504/1504 - 57s - loss: 3.1886 - accuracy1000: 0.4244 - val_loss: 3.3638 - val_accuracy1000: 0.3943 - 57s/epoch - 38ms/step
Epoch 13/50
1504/1504 - 57s - loss: 3.1875 - accuracy1000: 0.4289 - val_loss: 3.3275 - val_accuracy1000: 0.3987 - 57s/epoch - 38ms/step
Epoch 14/50
1504/1504 - 57s - loss: 3.1865 - accuracy1000: 0.4248 - val_loss: 3.3760 - val_accuracy1000: 0.3950 - 57s/epoch - 38ms/step
Epoch 15/50
1504/1504 - 57s - loss: 3.1753 - accuracy1000: 0.4303 - val_loss: 3.3740 - val_accuracy1000: 0.3966 - 57s/epoch - 38ms/step
Epoch 16/50
1504/1504 - 57s - loss: 3.1647 - accuracy1000: 0.4379 - val_loss: 3.4357 - val_accuracy1000: 0.4017 - 57s/epoch - 38ms/step
testing model: results/EXC/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
4450/4450 - 71s - 71s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1105087
{'0': {'precision': 0.2738927738927739, 'recall': 0.0006896308860729776, 'f1-score': 0.0013757976699256484, 'support': 340762}, '1': {'precision': 0.41574138986531856, 'recall': 0.7280868420540688, 'f1-score': 0.5292679918387293, 'support': 462633}, '2': {'precision': 0.3105576808766823, 'recall': 0.3034617515473928, 'f1-score': 0.3069687140788905, 'support': 335726}, 'accuracy': 0.38534273356386195, 'macro avg': {'precision': 0.33339728154492493, 'recall': 0.34407940816251154, 'f1-score': 0.2792041678625152, 'support': 1139121}, 'weighted avg': {'precision': 0.342307993448296, 'recall': 0.38534273356386195, 'f1-score': 0.30583497006619637, 'support': 1139121}}
[[   235 239779 100748]
 [   369 336837 125427]
 [   254 233592 101880]]
Evaluating performance on  train set...
1504/1504 - 25s - 25s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1413615
{'0': {'precision': 0.38966202783300197, 'recall': 0.0015414136965617037, 'f1-score': 0.003070680484728848, 'support': 127156}, '1': {'precision': 0.33948262897699627, 'recall': 0.7824726502764381, 'f1-score': 0.47352310262348607, 'support': 127515}, '2': {'precision': 0.3629696815512073, 'recall': 0.2521360297507453, 'f1-score': 0.2975675001700256, 'support': 130148}, 'accuracy': 0.34506612199501585, 'macro avg': {'precision': 0.3640381127870685, 'recall': 0.3453833645745817, 'f1-score': 0.25805376109274686, 'support': 384819}, 'weighted avg': {'precision': 0.364006897683486, 'recall': 0.34506612199501585, 'f1-score': 0.25856199639539235, 'support': 384819}}
[[  196 96951 30009]
 [  155 99777 27583]
 [  152 97181 32815]]
Evaluating performance on  val set...
510/510 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0871567
{'0': {'precision': 0.32142857142857145, 'recall': 0.0015690832485834665, 'f1-score': 0.00312292166671486, 'support': 34415}, '1': {'precision': 0.4116072550175384, 'recall': 0.8114760344433437, 'f1-score': 0.5461760878066919, 'support': 52492}, '2': {'precision': 0.4094429550193625, 'recall': 0.2521786992019081, 'f1-score': 0.3121203519727505, 'support': 43604}, 'accuracy': 0.4110458122303867, 'macro avg': {'precision': 0.38082626048849083, 'recall': 0.3550746056312784, 'f1-score': 0.28713978714871913, 'support': 130511}, 'weighted avg': {'precision': 0.38710455767528557, 'recall': 0.4110458122303867, 'f1-score': 0.3247775771983103, 'support': 130511}}
[[   54 28344  6017]
 [   53 42596  9843]
 [   61 32547 10996]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  14.64 (ave)

============================================
