This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-06.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-29.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-16.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-17.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-25.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-23.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-18.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-08.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-04.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-24.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-31.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-01-30.csv
training model: results/PCAR/W0/deepLOB_L1/h10
Epoch 1/50
765/765 - 70s - loss: 3.2242 - accuracy10: 0.4165 - val_loss: 3.2873 - val_accuracy10: 0.3987 - 70s/epoch - 91ms/step
Epoch 2/50
765/765 - 36s - loss: 3.1629 - accuracy10: 0.4434 - val_loss: 3.2653 - val_accuracy10: 0.4040 - 36s/epoch - 47ms/step
Epoch 3/50
765/765 - 35s - loss: 3.1205 - accuracy10: 0.4623 - val_loss: 3.2285 - val_accuracy10: 0.4215 - 35s/epoch - 46ms/step
Epoch 4/50
765/765 - 30s - loss: 3.0979 - accuracy10: 0.4678 - val_loss: 3.1913 - val_accuracy10: 0.4358 - 30s/epoch - 39ms/step
Epoch 5/50
765/765 - 32s - loss: 3.0804 - accuracy10: 0.4731 - val_loss: 3.1918 - val_accuracy10: 0.4391 - 32s/epoch - 42ms/step
Epoch 6/50
765/765 - 31s - loss: 3.0722 - accuracy10: 0.4763 - val_loss: 3.1737 - val_accuracy10: 0.4470 - 31s/epoch - 41ms/step
Epoch 7/50
765/765 - 29s - loss: 3.0615 - accuracy10: 0.4791 - val_loss: 3.1706 - val_accuracy10: 0.4480 - 29s/epoch - 38ms/step
Epoch 8/50
765/765 - 28s - loss: 3.0565 - accuracy10: 0.4808 - val_loss: 3.1769 - val_accuracy10: 0.4480 - 28s/epoch - 36ms/step
Epoch 9/50
765/765 - 27s - loss: 3.0504 - accuracy10: 0.4830 - val_loss: 3.1789 - val_accuracy10: 0.4484 - 27s/epoch - 36ms/step
Epoch 10/50
765/765 - 28s - loss: 3.0449 - accuracy10: 0.4841 - val_loss: 3.1769 - val_accuracy10: 0.4494 - 28s/epoch - 37ms/step
Epoch 11/50
765/765 - 30s - loss: 3.0400 - accuracy10: 0.4859 - val_loss: 3.2003 - val_accuracy10: 0.4423 - 30s/epoch - 39ms/step
Epoch 12/50
765/765 - 30s - loss: 3.0357 - accuracy10: 0.4875 - val_loss: 3.1772 - val_accuracy10: 0.4494 - 30s/epoch - 40ms/step
Epoch 13/50
765/765 - 28s - loss: 3.0314 - accuracy10: 0.4884 - val_loss: 3.1932 - val_accuracy10: 0.4447 - 28s/epoch - 36ms/step
Epoch 14/50
765/765 - 28s - loss: 3.0276 - accuracy10: 0.4896 - val_loss: 3.1892 - val_accuracy10: 0.4460 - 28s/epoch - 36ms/step
Epoch 15/50
765/765 - 29s - loss: 3.0233 - accuracy10: 0.4915 - val_loss: 3.2047 - val_accuracy10: 0.4469 - 29s/epoch - 38ms/step
Epoch 16/50
765/765 - 30s - loss: 3.0199 - accuracy10: 0.4917 - val_loss: 3.2082 - val_accuracy10: 0.4430 - 30s/epoch - 39ms/step
Epoch 17/50
765/765 - 31s - loss: 3.0164 - accuracy10: 0.4927 - val_loss: 3.2071 - val_accuracy10: 0.4439 - 31s/epoch - 40ms/step
testing model: results/PCAR/W0/deepLOB_L1/h10
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639646
{'0': {'precision': 0.44998052551157985, 'recall': 0.41636172100243957, 'f1-score': 0.4325188267649643, 'support': 144288}, '1': {'precision': 0.43729277306453607, 'recall': 0.3001232338117066, 'f1-score': 0.35595029115402166, 'support': 153367}, '2': {'precision': 0.4275366919827102, 'recall': 0.6001494614588261, 'f1-score': 0.4993468377248276, 'support': 145857}, 'accuracy': 0.4366082541171378, 'macro avg': {'precision': 0.43826999685294205, 'recall': 0.4388781387576574, 'f1-score': 0.4292719852146045, 'support': 443512}, 'weighted avg': {'precision': 0.43821202148786437, 'recall': 0.4366082541171378, 'f1-score': 0.4280189408397342, 'support': 443512}}
[[60076 30667 53545]
 [43674 46029 63664]
 [29758 28563 87536]]
Evaluating performance on  train set...
765/765 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0574973
{'0': {'precision': 0.45643316710975473, 'recall': 0.44474930639648064, 'f1-score': 0.4505154959319297, 'support': 65239}, '1': {'precision': 0.45473942842363896, 'recall': 0.2181654620467165, 'f1-score': 0.29486615097582963, 'support': 64474}, '2': {'precision': 0.42633538409883176, 'recall': 0.6536161450999984, 'f1-score': 0.5160596244187575, 'support': 66051}, 'accuracy': 0.44059684109437897, 'macro avg': {'precision': 0.44583599321074185, 'recall': 0.43884363784773184, 'f1-score': 0.4204804237755056, 'support': 195764}, 'weighted avg': {'precision': 0.44572031503428067, 'recall': 0.44059684109437897, 'f1-score': 0.4213677433522106, 'support': 195764}}
[[29015  8759 27465]
 [19782 14066 30626]
 [14772  8107 43172]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0550677
{'0': {'precision': 0.4506209343583678, 'recall': 0.4258569299552906, 'f1-score': 0.4378890910832296, 'support': 21472}, '1': {'precision': 0.5752066115702479, 'recall': 0.16534422958141304, 'f1-score': 0.25685500239878956, 'support': 21047}, '2': {'precision': 0.42638628309360016, 'recall': 0.737105275012388, 'f1-score': 0.5402558811390838, 'support': 22199}, 'accuracy': 0.4478970301925276, 'macro avg': {'precision': 0.4840712763407386, 'recall': 0.44276881151636394, 'f1-score': 0.41166665820703435, 'support': 64718}, 'weighted avg': {'precision': 0.4828247992004807, 'recall': 0.4478970301925276, 'f1-score': 0.4141277867769856, 'support': 64718}}
[[ 9144  1335 10993]
 [ 6547  3480 11020]
 [ 4601  1235 16363]]
training model: results/PCAR/W0/deepLOB_L1/h20
Epoch 1/50
765/765 - 32s - loss: 3.2558 - accuracy20: 0.3975 - val_loss: 3.3171 - val_accuracy20: 0.3742 - 32s/epoch - 42ms/step
Epoch 2/50
765/765 - 28s - loss: 3.2062 - accuracy20: 0.4237 - val_loss: 3.2663 - val_accuracy20: 0.3930 - 28s/epoch - 37ms/step
Epoch 3/50
765/765 - 29s - loss: 3.1794 - accuracy20: 0.4359 - val_loss: 3.2612 - val_accuracy20: 0.3982 - 29s/epoch - 38ms/step
Epoch 4/50
765/765 - 27s - loss: 3.1627 - accuracy20: 0.4437 - val_loss: 3.2581 - val_accuracy20: 0.3952 - 27s/epoch - 36ms/step
Epoch 5/50
765/765 - 27s - loss: 3.1540 - accuracy20: 0.4452 - val_loss: 3.2698 - val_accuracy20: 0.3891 - 27s/epoch - 35ms/step
Epoch 6/50
765/765 - 25s - loss: 3.1464 - accuracy20: 0.4484 - val_loss: 3.2675 - val_accuracy20: 0.3902 - 25s/epoch - 32ms/step
Epoch 7/50
765/765 - 27s - loss: 3.1409 - accuracy20: 0.4495 - val_loss: 3.2518 - val_accuracy20: 0.3992 - 27s/epoch - 35ms/step
Epoch 8/50
765/765 - 28s - loss: 3.1363 - accuracy20: 0.4515 - val_loss: 3.2532 - val_accuracy20: 0.3983 - 28s/epoch - 37ms/step
Epoch 9/50
765/765 - 26s - loss: 3.1328 - accuracy20: 0.4529 - val_loss: 3.2453 - val_accuracy20: 0.4021 - 26s/epoch - 34ms/step
Epoch 10/50
765/765 - 27s - loss: 3.1286 - accuracy20: 0.4533 - val_loss: 3.2505 - val_accuracy20: 0.4012 - 27s/epoch - 35ms/step
Epoch 11/50
765/765 - 28s - loss: 3.1261 - accuracy20: 0.4549 - val_loss: 3.2547 - val_accuracy20: 0.3984 - 28s/epoch - 36ms/step
Epoch 12/50
765/765 - 28s - loss: 3.1217 - accuracy20: 0.4555 - val_loss: 3.2559 - val_accuracy20: 0.3981 - 28s/epoch - 36ms/step
Epoch 13/50
765/765 - 29s - loss: 3.1195 - accuracy20: 0.4568 - val_loss: 3.2587 - val_accuracy20: 0.3964 - 29s/epoch - 39ms/step
Epoch 14/50
765/765 - 26s - loss: 3.1172 - accuracy20: 0.4575 - val_loss: 3.2866 - val_accuracy20: 0.3906 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 29s - loss: 3.1135 - accuracy20: 0.4588 - val_loss: 3.2734 - val_accuracy20: 0.3929 - 29s/epoch - 38ms/step
Epoch 16/50
765/765 - 28s - loss: 3.1106 - accuracy20: 0.4594 - val_loss: 3.2557 - val_accuracy20: 0.4004 - 28s/epoch - 37ms/step
Epoch 17/50
765/765 - 27s - loss: 3.1087 - accuracy20: 0.4589 - val_loss: 3.2722 - val_accuracy20: 0.3940 - 27s/epoch - 35ms/step
Epoch 18/50
765/765 - 27s - loss: 3.1077 - accuracy20: 0.4605 - val_loss: 3.2590 - val_accuracy20: 0.3990 - 27s/epoch - 35ms/step
Epoch 19/50
765/765 - 26s - loss: 3.1053 - accuracy20: 0.4606 - val_loss: 3.2790 - val_accuracy20: 0.3931 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepLOB_L1/h20
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0830767
{'0': {'precision': 0.3838936931921796, 'recall': 0.5633887132101782, 'f1-score': 0.45663547080632594, 'support': 141989}, '1': {'precision': 0.43929845131662515, 'recall': 0.17151903965614806, 'f1-score': 0.24671215086608989, 'support': 157277}, '2': {'precision': 0.40836484829646513, 'recall': 0.49182646312549394, 'f1-score': 0.44622656640658165, 'support': 144246}, 'accuracy': 0.4011503634625444, 'macro avg': {'precision': 0.41051899760175664, 'recall': 0.4089114053306068, 'f1-score': 0.3831913960263325, 'support': 443512}, 'weighted avg': {'precision': 0.4115000722365148, 'recall': 0.4011503634625444, 'f1-score': 0.3788076942990702, 'support': 443512}}
[[79995 15866 46128]
 [73646 26976 56655]
 [54737 18565 70944]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0813469
{'0': {'precision': 0.38816798514691636, 'recall': 0.5903231746616334, 'f1-score': 0.46836306081451273, 'support': 65166}, '1': {'precision': 0.48343364338257644, 'recall': 0.12383592363036099, 'f1-score': 0.19716598688370132, 'support': 64214}, '2': {'precision': 0.4109411427360337, 'recall': 0.4965353097131839, 'f1-score': 0.44970155871619083, 'support': 66384}, 'accuracy': 0.40550356551766414, 'macro avg': {'precision': 0.4275142570885088, 'recall': 0.40356480266839273, 'f1-score': 0.37174353547146827, 'support': 195764}, 'weighted avg': {'precision': 0.4271392069820885, 'recall': 0.40550356551766414, 'f1-score': 0.37307754324903525, 'support': 195764}}
[[38469  4134 22563]
 [31576  7952 24686]
 [29059  4363 32962]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0799719
{'0': {'precision': 0.3834397540498995, 'recall': 0.6048778213019959, 'f1-score': 0.46935157041540015, 'support': 21444}, '1': {'precision': 0.5574742268041237, 'recall': 0.10117404930071565, 'f1-score': 0.17126568747773072, 'support': 21379}, '2': {'precision': 0.4037393557941503, 'recall': 0.498058917561087, 'f1-score': 0.44596667007463453, 'support': 21895}, 'accuracy': 0.40234556074044314, 'macro avg': {'precision': 0.44821777888272446, 'recall': 0.40137026272126614, 'f1-score': 0.3621946426559218, 'support': 64718}, 'weighted avg': {'precision': 0.44779808980197666, 'recall': 0.40234556074044314, 'f1-score': 0.3629701852631165, 'support': 64718}}
[[12971   839  7634]
 [10745  2163  8471]
 [10112   878 10905]]
training model: results/PCAR/W0/deepLOB_L1/h30
Epoch 1/50
765/765 - 31s - loss: 3.2716 - accuracy30: 0.3880 - val_loss: 3.3506 - val_accuracy30: 0.3532 - 31s/epoch - 40ms/step
Epoch 2/50
765/765 - 28s - loss: 3.2314 - accuracy30: 0.4040 - val_loss: 3.3212 - val_accuracy30: 0.3703 - 28s/epoch - 36ms/step
Epoch 3/50
765/765 - 29s - loss: 3.2127 - accuracy30: 0.4167 - val_loss: 3.3285 - val_accuracy30: 0.3672 - 29s/epoch - 38ms/step
Epoch 4/50
765/765 - 27s - loss: 3.2030 - accuracy30: 0.4208 - val_loss: 3.3082 - val_accuracy30: 0.3746 - 27s/epoch - 36ms/step
Epoch 5/50
765/765 - 30s - loss: 3.1942 - accuracy30: 0.4273 - val_loss: 3.3082 - val_accuracy30: 0.3766 - 30s/epoch - 39ms/step
Epoch 6/50
765/765 - 27s - loss: 3.1888 - accuracy30: 0.4283 - val_loss: 3.3022 - val_accuracy30: 0.3771 - 27s/epoch - 36ms/step
Epoch 7/50
765/765 - 28s - loss: 3.1851 - accuracy30: 0.4290 - val_loss: 3.3190 - val_accuracy30: 0.3739 - 28s/epoch - 37ms/step
Epoch 8/50
765/765 - 31s - loss: 3.1807 - accuracy30: 0.4313 - val_loss: 3.3069 - val_accuracy30: 0.3771 - 31s/epoch - 41ms/step
Epoch 9/50
765/765 - 28s - loss: 3.1786 - accuracy30: 0.4316 - val_loss: 3.2968 - val_accuracy30: 0.3817 - 28s/epoch - 37ms/step
Epoch 10/50
765/765 - 26s - loss: 3.1742 - accuracy30: 0.4327 - val_loss: 3.3209 - val_accuracy30: 0.3728 - 26s/epoch - 34ms/step
Epoch 11/50
765/765 - 25s - loss: 3.1714 - accuracy30: 0.4355 - val_loss: 3.2994 - val_accuracy30: 0.3806 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 27s - loss: 3.1699 - accuracy30: 0.4343 - val_loss: 3.3134 - val_accuracy30: 0.3772 - 27s/epoch - 35ms/step
Epoch 13/50
765/765 - 27s - loss: 3.1677 - accuracy30: 0.4354 - val_loss: 3.3237 - val_accuracy30: 0.3771 - 27s/epoch - 35ms/step
Epoch 14/50
765/765 - 26s - loss: 3.1652 - accuracy30: 0.4368 - val_loss: 3.3348 - val_accuracy30: 0.3757 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 30s - loss: 3.1623 - accuracy30: 0.4377 - val_loss: 3.3245 - val_accuracy30: 0.3751 - 30s/epoch - 40ms/step
Epoch 16/50
765/765 - 28s - loss: 3.1602 - accuracy30: 0.4388 - val_loss: 3.3516 - val_accuracy30: 0.3712 - 28s/epoch - 37ms/step
Epoch 17/50
765/765 - 27s - loss: 3.1590 - accuracy30: 0.4385 - val_loss: 3.3350 - val_accuracy30: 0.3755 - 27s/epoch - 36ms/step
Epoch 18/50
765/765 - 27s - loss: 3.1552 - accuracy30: 0.4410 - val_loss: 3.3442 - val_accuracy30: 0.3753 - 27s/epoch - 36ms/step
Epoch 19/50
765/765 - 28s - loss: 3.1544 - accuracy30: 0.4413 - val_loss: 3.3696 - val_accuracy30: 0.3747 - 28s/epoch - 36ms/step
testing model: results/PCAR/W0/deepLOB_L1/h30
Evaluating performance on  test set...
1733/1733 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.092483
{'0': {'precision': 0.3821918128928793, 'recall': 0.46168258659332423, 'f1-score': 0.4181932876707943, 'support': 141437}, '1': {'precision': 0.4160339368602256, 'recall': 0.17233848837727536, 'f1-score': 0.24371862689926843, 'support': 157063}, '2': {'precision': 0.37629819457022295, 'recall': 0.5387002454969244, 'f1-score': 0.443086940738724, 'support': 145012}, 'accuracy': 0.38439771640902615, 'macro avg': {'precision': 0.39150798144110927, 'recall': 0.390907106822508, 'f1-score': 0.3683329517695955, 'support': 443512}, 'weighted avg': {'precision': 0.39224948920485797, 'recall': 0.38439771640902615, 'f1-score': 0.3645450544187706, 'support': 443512}}
[[65299 17282 58856]
 [59373 27068 70622]
 [46182 20712 78118]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0952111
{'0': {'precision': 0.400888265544647, 'recall': 0.3708279920305188, 'f1-score': 0.385272667463635, 'support': 64747}, '1': {'precision': 0.410172807303554, 'recall': 0.09721342132513175, 'f1-score': 0.15717534171268646, 'support': 64703}, '2': {'precision': 0.3678206691721214, 'recall': 0.6685767711192206, 'f1-score': 0.4745599434843806, 'support': 66314}, 'accuracy': 0.3812549804867085, 'macro avg': {'precision': 0.39296058067344086, 'recall': 0.37887272815829043, 'f1-score': 0.3390026508869006, 'support': 195764}, 'weighted avg': {'precision': 0.3927554787175434, 'recall': 0.3812549804867085, 'f1-score': 0.34012859170903303, 'support': 195764}}
[[24010  4333 36404]
 [18616  6290 39797]
 [17266  4712 44336]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0975149
{'0': {'precision': 0.3987014707830926, 'recall': 0.28474095102909863, 'f1-score': 0.3322200447155593, 'support': 21135}, '1': {'precision': 0.5536113179448995, 'recall': 0.06743458346560247, 'f1-score': 0.12022476452277964, 'support': 22051}, '2': {'precision': 0.3661212663513571, 'recall': 0.798114434330299, 'f1-score': 0.5019716664232511, 'support': 21532}, 'accuracy': 0.38150128248709786, 'macro avg': {'precision': 0.43947801835978306, 'recall': 0.38342998960833335, 'f1-score': 0.31813882522053, 'support': 64718}, 'weighted avg': {'precision': 0.44064343558331626, 'recall': 0.38150128248709786, 'f1-score': 0.31646529325659944, 'support': 64718}}
[[ 6018   614 14503]
 [ 5314  1487 15250]
 [ 3762   585 17185]]
training model: results/PCAR/W0/deepLOB_L1/h50
Epoch 1/50
765/765 - 33s - loss: 3.2834 - accuracy50: 0.3825 - val_loss: 3.3307 - val_accuracy50: 0.3391 - 33s/epoch - 44ms/step
Epoch 2/50
765/765 - 27s - loss: 3.2564 - accuracy50: 0.3960 - val_loss: 3.3119 - val_accuracy50: 0.3477 - 27s/epoch - 36ms/step
Epoch 3/50
765/765 - 29s - loss: 3.2442 - accuracy50: 0.4013 - val_loss: 3.3145 - val_accuracy50: 0.3523 - 29s/epoch - 38ms/step
Epoch 4/50
765/765 - 29s - loss: 3.2372 - accuracy50: 0.4033 - val_loss: 3.3245 - val_accuracy50: 0.3467 - 29s/epoch - 38ms/step
Epoch 5/50
765/765 - 28s - loss: 3.2294 - accuracy50: 0.4081 - val_loss: 3.3237 - val_accuracy50: 0.3531 - 28s/epoch - 36ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2242 - accuracy50: 0.4109 - val_loss: 3.3273 - val_accuracy50: 0.3506 - 27s/epoch - 36ms/step
Epoch 7/50
765/765 - 29s - loss: 3.2206 - accuracy50: 0.4130 - val_loss: 3.3225 - val_accuracy50: 0.3552 - 29s/epoch - 38ms/step
Epoch 8/50
765/765 - 27s - loss: 3.2168 - accuracy50: 0.4157 - val_loss: 3.3218 - val_accuracy50: 0.3574 - 27s/epoch - 36ms/step
Epoch 9/50
765/765 - 29s - loss: 3.2135 - accuracy50: 0.4164 - val_loss: 3.3081 - val_accuracy50: 0.3675 - 29s/epoch - 38ms/step
Epoch 10/50
765/765 - 26s - loss: 3.2117 - accuracy50: 0.4170 - val_loss: 3.3175 - val_accuracy50: 0.3638 - 26s/epoch - 34ms/step
Epoch 11/50
765/765 - 29s - loss: 3.2109 - accuracy50: 0.4177 - val_loss: 3.3135 - val_accuracy50: 0.3677 - 29s/epoch - 38ms/step
Epoch 12/50
765/765 - 27s - loss: 3.2089 - accuracy50: 0.4189 - val_loss: 3.3090 - val_accuracy50: 0.3673 - 27s/epoch - 36ms/step
Epoch 13/50
765/765 - 27s - loss: 3.2071 - accuracy50: 0.4194 - val_loss: 3.3103 - val_accuracy50: 0.3683 - 27s/epoch - 35ms/step
Epoch 14/50
765/765 - 29s - loss: 3.2046 - accuracy50: 0.4209 - val_loss: 3.3209 - val_accuracy50: 0.3631 - 29s/epoch - 37ms/step
Epoch 15/50
765/765 - 28s - loss: 3.2039 - accuracy50: 0.4210 - val_loss: 3.3191 - val_accuracy50: 0.3656 - 28s/epoch - 37ms/step
Epoch 16/50
765/765 - 27s - loss: 3.2007 - accuracy50: 0.4231 - val_loss: 3.3568 - val_accuracy50: 0.3611 - 27s/epoch - 36ms/step
Epoch 17/50
765/765 - 29s - loss: 3.1997 - accuracy50: 0.4226 - val_loss: 3.3472 - val_accuracy50: 0.3626 - 29s/epoch - 37ms/step
Epoch 18/50
765/765 - 28s - loss: 3.1976 - accuracy50: 0.4231 - val_loss: 3.3416 - val_accuracy50: 0.3635 - 28s/epoch - 37ms/step
Epoch 19/50
765/765 - 28s - loss: 3.1975 - accuracy50: 0.4237 - val_loss: 3.3702 - val_accuracy50: 0.3601 - 28s/epoch - 37ms/step
testing model: results/PCAR/W0/deepLOB_L1/h50
Evaluating performance on  test set...
1733/1733 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0981361
{'0': {'precision': 0.34836033409944506, 'recall': 0.23329604240654117, 'f1-score': 0.27944707755124065, 'support': 133187}, '1': {'precision': 0.42750912349086345, 'recall': 0.37628441660862205, 'f1-score': 0.4002645283954699, 'support': 173717}, '2': {'precision': 0.3424521510314525, 'recall': 0.504911864605294, 'f1-score': 0.40810832398978764, 'support': 136608}, 'accuracy': 0.3729639784267393, 'macro avg': {'precision': 0.37277386954058694, 'recall': 0.3714974412068191, 'f1-score': 0.362606643312166, 'support': 443512}, 'weighted avg': {'precision': 0.3775419237163138, 'recall': 0.3729639784267393, 'f1-score': 0.36639895407720613, 'support': 443512}}
[[31072 43497 58618]
 [34528 65367 73822]
 [23595 44038 68975]]
Evaluating performance on  train set...
765/765 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1013027
{'0': {'precision': 0.37336088373201937, 'recall': 0.21776212107166032, 'f1-score': 0.275082706326668, 'support': 64722}, '1': {'precision': 0.3547992567678811, 'recall': 0.2332467452144602, 'f1-score': 0.28146019721805005, 'support': 64674}, '2': {'precision': 0.36306256385391955, 'recall': 0.6318255785920925, 'f1-score': 0.4611417197277116, 'support': 66368}, 'accuracy': 0.3632537136552175, 'macro avg': {'precision': 0.36374090145127336, 'recall': 0.36094481495940434, 'f1-score': 0.3392282077574766, 'support': 195764}, 'weighted avg': {'precision': 0.36373739036271546, 'recall': 0.3632537136552175, 'f1-score': 0.34026743103248575, 'support': 195764}}
[[14094 13766 36862]
 [12886 15085 36703]
 [10769 13666 41933]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008688
{'0': {'precision': 0.3708873379860419, 'recall': 0.19268258228563356, 'f1-score': 0.2536101642392315, 'support': 21237}, '1': {'precision': 0.4440172993753003, 'recall': 0.12530512611879577, 'f1-score': 0.19545214172395559, 'support': 22122}, '2': {'precision': 0.355128367269508, 'recall': 0.7888009738283628, 'f1-score': 0.4897603232511155, 'support': 21359}, 'accuracy': 0.3663895670447171, 'macro avg': {'precision': 0.39001100154361673, 'recall': 0.36892956074426403, 'f1-score': 0.31294087640476753, 'support': 64718}, 'weighted avg': {'precision': 0.39068376479649225, 'recall': 0.3663895670447171, 'f1-score': 0.31166757442267196, 'support': 64718}}
[[ 4092  1697 15448]
 [ 4204  2772 15146]
 [ 2737  1774 16848]]
training model: results/PCAR/W0/deepLOB_L1/h100
Epoch 1/50
765/765 - 32s - loss: 3.3136 - accuracy100: 0.3634 - val_loss: 3.3453 - val_accuracy100: 0.3392 - 32s/epoch - 41ms/step
Epoch 2/50
765/765 - 28s - loss: 3.2824 - accuracy100: 0.3700 - val_loss: 3.3365 - val_accuracy100: 0.3450 - 28s/epoch - 37ms/step
Epoch 3/50
765/765 - 28s - loss: 3.2730 - accuracy100: 0.3756 - val_loss: 3.3492 - val_accuracy100: 0.3306 - 28s/epoch - 36ms/step
Epoch 4/50
765/765 - 32s - loss: 3.2642 - accuracy100: 0.3863 - val_loss: 3.3364 - val_accuracy100: 0.3340 - 32s/epoch - 42ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2564 - accuracy100: 0.3902 - val_loss: 3.3172 - val_accuracy100: 0.3384 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 30s - loss: 3.2507 - accuracy100: 0.3949 - val_loss: 3.3086 - val_accuracy100: 0.3458 - 30s/epoch - 39ms/step
Epoch 7/50
765/765 - 28s - loss: 3.2469 - accuracy100: 0.3958 - val_loss: 3.3206 - val_accuracy100: 0.3462 - 28s/epoch - 37ms/step
Epoch 8/50
765/765 - 30s - loss: 3.2432 - accuracy100: 0.4000 - val_loss: 3.3081 - val_accuracy100: 0.3454 - 30s/epoch - 39ms/step
Epoch 9/50
765/765 - 29s - loss: 3.2384 - accuracy100: 0.4019 - val_loss: 3.3046 - val_accuracy100: 0.3461 - 29s/epoch - 38ms/step
Epoch 10/50
765/765 - 28s - loss: 3.2369 - accuracy100: 0.4022 - val_loss: 3.3184 - val_accuracy100: 0.3497 - 28s/epoch - 37ms/step
Epoch 11/50
765/765 - 28s - loss: 3.2346 - accuracy100: 0.4043 - val_loss: 3.3048 - val_accuracy100: 0.3466 - 28s/epoch - 37ms/step
Epoch 12/50
765/765 - 29s - loss: 3.2307 - accuracy100: 0.4064 - val_loss: 3.3044 - val_accuracy100: 0.3492 - 29s/epoch - 38ms/step
Epoch 13/50
765/765 - 32s - loss: 3.2288 - accuracy100: 0.4084 - val_loss: 3.3114 - val_accuracy100: 0.3491 - 32s/epoch - 42ms/step
Epoch 14/50
765/765 - 29s - loss: 3.2268 - accuracy100: 0.4076 - val_loss: 3.3056 - val_accuracy100: 0.3481 - 29s/epoch - 38ms/step
Epoch 15/50
765/765 - 28s - loss: 3.2255 - accuracy100: 0.4082 - val_loss: 3.3087 - val_accuracy100: 0.3511 - 28s/epoch - 36ms/step
Epoch 16/50
765/765 - 27s - loss: 3.2240 - accuracy100: 0.4097 - val_loss: 3.3099 - val_accuracy100: 0.3475 - 27s/epoch - 35ms/step
Epoch 17/50
765/765 - 26s - loss: 3.2217 - accuracy100: 0.4099 - val_loss: 3.3160 - val_accuracy100: 0.3493 - 26s/epoch - 35ms/step
Epoch 18/50
765/765 - 28s - loss: 3.2207 - accuracy100: 0.4107 - val_loss: 3.3161 - val_accuracy100: 0.3452 - 28s/epoch - 36ms/step
Epoch 19/50
765/765 - 28s - loss: 3.2191 - accuracy100: 0.4112 - val_loss: 3.3210 - val_accuracy100: 0.3463 - 28s/epoch - 37ms/step
Epoch 20/50
765/765 - 31s - loss: 3.2165 - accuracy100: 0.4123 - val_loss: 3.3255 - val_accuracy100: 0.3448 - 31s/epoch - 40ms/step
Epoch 21/50
765/765 - 27s - loss: 3.2164 - accuracy100: 0.4122 - val_loss: 3.3242 - val_accuracy100: 0.3489 - 27s/epoch - 36ms/step
Epoch 22/50
765/765 - 29s - loss: 3.2137 - accuracy100: 0.4142 - val_loss: 3.3257 - val_accuracy100: 0.3489 - 29s/epoch - 38ms/step
testing model: results/PCAR/W0/deepLOB_L1/h100
Evaluating performance on  test set...
1733/1733 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1126283
{'0': {'precision': 0.32950236603538324, 'recall': 0.44931535486568414, 'f1-score': 0.3801928706834793, 'support': 143505}, '1': {'precision': 0.35333601055590613, 'recall': 0.24457784278556916, 'f1-score': 0.2890655861451273, 'support': 151093}, '2': {'precision': 0.35470538955598996, 'recall': 0.34119021717232767, 'f1-score': 0.34781656249786075, 'support': 148914}, 'accuracy': 0.34326241454571693, 'macro avg': {'precision': 0.3458479220490931, 'recall': 0.34502780494119367, 'f1-score': 0.3390250064421558, 'support': 443512}, 'weighted avg': {'precision': 0.3460840591938254, 'recall': 0.34326241454571693, 'f1-score': 0.33827747637643363, 'support': 443512}}
[[64479 35050 43976]
 [65683 36954 48456]
 [65524 32582 50808]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1051273
{'0': {'precision': 0.3510546574287914, 'recall': 0.3546640949462583, 'f1-score': 0.35285014585380575, 'support': 64289}, '1': {'precision': 0.35522069410654883, 'recall': 0.22154613157446545, 'f1-score': 0.2728928472665897, 'support': 64587}, '2': {'precision': 0.3468607785092564, 'recall': 0.46947135510106447, 'f1-score': 0.39895820099097956, 'support': 66888}, 'accuracy': 0.34997241576592225, 'macro avg': {'precision': 0.3510453766815322, 'recall': 0.3485605272072627, 'f1-score': 0.34156706470379167, 'support': 195764}, 'weighted avg': {'precision': 0.350996177002035, 'recall': 0.34997241576592225, 'f1-score': 0.3422244616021699, 'support': 195764}}
[[22801 13298 28190]
 [19338 14309 30940]
 [22811 12675 31402]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0998763
{'0': {'precision': 0.34429835780426665, 'recall': 0.31472128694350915, 'f1-score': 0.328846106862769, 'support': 21384}, '1': {'precision': 0.36220276898243, 'recall': 0.2667459192538064, 'f1-score': 0.3072305018695034, 'support': 21871}, '2': {'precision': 0.3496077621800165, 'recall': 0.47341937287424873, 'f1-score': 0.40220080353078547, 'support': 21463}, 'accuracy': 0.3511387867363021, 'macro avg': {'precision': 0.3520362963222377, 'recall': 0.35162885969052143, 'f1-score': 0.3460924707543526, 'support': 64718}, 'weighted avg': {'precision': 0.35210983410134516, 'recall': 0.3511387867363021, 'f1-score': 0.34586852655710326, 'support': 64718}}
[[ 6730  5270  9384]
 [ 6518  5834  9519]
 [ 6299  5003 10161]]
training model: results/PCAR/W0/deepLOB_L1/h200
Epoch 1/50
765/765 - 32s - loss: 3.2884 - accuracy200: 0.3837 - val_loss: 3.3933 - val_accuracy200: 0.3311 - 32s/epoch - 42ms/step
Epoch 2/50
765/765 - 27s - loss: 3.2635 - accuracy200: 0.3940 - val_loss: 3.3482 - val_accuracy200: 0.3343 - 27s/epoch - 35ms/step
Epoch 3/50
765/765 - 28s - loss: 3.2560 - accuracy200: 0.3996 - val_loss: 3.4027 - val_accuracy200: 0.3452 - 28s/epoch - 36ms/step
Epoch 4/50
765/765 - 29s - loss: 3.2568 - accuracy200: 0.3956 - val_loss: 3.3713 - val_accuracy200: 0.3387 - 29s/epoch - 38ms/step
Epoch 5/50
765/765 - 29s - loss: 3.2743 - accuracy200: 0.3837 - val_loss: 3.3443 - val_accuracy200: 0.3447 - 29s/epoch - 37ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2567 - accuracy200: 0.3942 - val_loss: 3.4101 - val_accuracy200: 0.3365 - 27s/epoch - 36ms/step
Epoch 7/50
765/765 - 29s - loss: 3.2566 - accuracy200: 0.3965 - val_loss: 3.3598 - val_accuracy200: 0.3326 - 29s/epoch - 38ms/step
Epoch 8/50
765/765 - 29s - loss: 3.2490 - accuracy200: 0.4019 - val_loss: 3.3690 - val_accuracy200: 0.3432 - 29s/epoch - 38ms/step
Epoch 9/50
765/765 - 29s - loss: 3.2357 - accuracy200: 0.4108 - val_loss: 3.3680 - val_accuracy200: 0.3417 - 29s/epoch - 38ms/step
Epoch 10/50
765/765 - 28s - loss: 3.2257 - accuracy200: 0.4164 - val_loss: 3.3787 - val_accuracy200: 0.3414 - 28s/epoch - 36ms/step
Epoch 11/50
765/765 - 29s - loss: 3.2214 - accuracy200: 0.4186 - val_loss: 3.3902 - val_accuracy200: 0.3387 - 29s/epoch - 37ms/step
Epoch 12/50
765/765 - 29s - loss: 3.2110 - accuracy200: 0.4257 - val_loss: 3.3998 - val_accuracy200: 0.3337 - 29s/epoch - 38ms/step
Epoch 13/50
765/765 - 28s - loss: 3.2103 - accuracy200: 0.4251 - val_loss: 3.3606 - val_accuracy200: 0.3459 - 28s/epoch - 37ms/step
Epoch 14/50
765/765 - 27s - loss: 3.2050 - accuracy200: 0.4275 - val_loss: 3.3567 - val_accuracy200: 0.3420 - 27s/epoch - 35ms/step
Epoch 15/50
765/765 - 28s - loss: 3.1988 - accuracy200: 0.4296 - val_loss: 3.3642 - val_accuracy200: 0.3440 - 28s/epoch - 36ms/step
testing model: results/PCAR/W0/deepLOB_L1/h200
Evaluating performance on  test set...
1733/1733 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1130109
{'0': {'precision': 0.29788357492115847, 'recall': 0.3011818221708669, 'f1-score': 0.29952361904069236, 'support': 136738}, '1': {'precision': 0.36470428187599907, 'recall': 0.32964445346170634, 'f1-score': 0.3462892277486066, 'support': 162651}, '2': {'precision': 0.3413946728174666, 'recall': 0.37484648529381154, 'f1-score': 0.3573394009948142, 'support': 144123}, 'accuracy': 0.33555800068543806, 'macro avg': {'precision': 0.3346608432048747, 'recall': 0.3352242536421283, 'f1-score': 0.3343840825947044, 'support': 443512}, 'weighted avg': {'precision': 0.33652831231049946, 'recall': 0.33555800068543806, 'f1-score': 0.3354618957153367, 'support': 443512}}
[[41183 45345 50210]
 [55023 53617 54011]
 [42046 48053 54024]]
Evaluating performance on  train set...
765/765 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1208149
{'0': {'precision': 0.3382655393053016, 'recall': 0.18566657782098117, 'f1-score': 0.2397432912571238, 'support': 63781}, '1': {'precision': 0.33230680898817755, 'recall': 0.39473602628886756, 'f1-score': 0.36084110295576277, 'support': 64514}, '2': {'precision': 0.3340743206295618, 'recall': 0.41653203693548146, 'f1-score': 0.3707739905403355, 'support': 67469}, 'accuracy': 0.33413191393718966, 'macro avg': {'precision': 0.33488222297434694, 'recall': 0.33231154701511006, 'f1-score': 0.32378612825107406, 'support': 195764}, 'weighted avg': {'precision': 0.3348573597599694, 'recall': 0.33413191393718966, 'f1-score': 0.3248100781733342, 'support': 195764}}
[[11842 24847 27092]
 [10121 25466 28927]
 [13045 26321 28103]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1118709
{'0': {'precision': 0.3451808488396404, 'recall': 0.0783578547698149, 'f1-score': 0.1277221212238425, 'support': 21070}, '1': {'precision': 0.3536788761306049, 'recall': 0.4948837626783951, 'f1-score': 0.412532734754957, 'support': 22282}, '2': {'precision': 0.3338665368432034, 'recall': 0.44935879434615744, 'f1-score': 0.38309757995331484, 'support': 21366}, 'accuracy': 0.34424735004171947, 'macro avg': {'precision': 0.3442420872711496, 'recall': 0.3408668039314558, 'f1-score': 0.3077841453107048, 'support': 64718}, 'weighted avg': {'precision': 0.3443713592692179, 'recall': 0.34424735004171947, 'f1-score': 0.3100902744719991, 'support': 64718}}
[[ 1651  9895  9524]
 [ 1623 11027  9632]
 [ 1509 10256  9601]]
training model: results/PCAR/W0/deepLOB_L1/h300
Epoch 1/50
765/765 - 31s - loss: 3.3004 - accuracy300: 0.3751 - val_loss: 3.4337 - val_accuracy300: 0.3243 - 31s/epoch - 41ms/step
Epoch 2/50
765/765 - 29s - loss: 3.2731 - accuracy300: 0.3853 - val_loss: 3.3734 - val_accuracy300: 0.3300 - 29s/epoch - 38ms/step
Epoch 3/50
765/765 - 28s - loss: 3.2628 - accuracy300: 0.3911 - val_loss: 3.4074 - val_accuracy300: 0.3383 - 28s/epoch - 36ms/step
Epoch 4/50
765/765 - 27s - loss: 3.2480 - accuracy300: 0.4003 - val_loss: 3.3981 - val_accuracy300: 0.3362 - 27s/epoch - 35ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2442 - accuracy300: 0.4030 - val_loss: 3.4207 - val_accuracy300: 0.3378 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2345 - accuracy300: 0.4094 - val_loss: 3.3975 - val_accuracy300: 0.3364 - 27s/epoch - 35ms/step
Epoch 7/50
765/765 - 24s - loss: 3.2245 - accuracy300: 0.4165 - val_loss: 3.3935 - val_accuracy300: 0.3313 - 24s/epoch - 32ms/step
Epoch 8/50
765/765 - 27s - loss: 3.2203 - accuracy300: 0.4172 - val_loss: 3.4139 - val_accuracy300: 0.3344 - 27s/epoch - 36ms/step
Epoch 9/50
765/765 - 27s - loss: 3.2091 - accuracy300: 0.4248 - val_loss: 3.3982 - val_accuracy300: 0.3331 - 27s/epoch - 35ms/step
Epoch 10/50
765/765 - 27s - loss: 3.2027 - accuracy300: 0.4267 - val_loss: 3.4063 - val_accuracy300: 0.3303 - 27s/epoch - 35ms/step
Epoch 11/50
765/765 - 25s - loss: 3.2007 - accuracy300: 0.4277 - val_loss: 3.3737 - val_accuracy300: 0.3324 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 25s - loss: 3.1908 - accuracy300: 0.4330 - val_loss: 3.3752 - val_accuracy300: 0.3355 - 25s/epoch - 33ms/step
testing model: results/PCAR/W0/deepLOB_L1/h300
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.14045
{'0': {'precision': 0.3258975286788652, 'recall': 0.4509336941813261, 'f1-score': 0.3783529091187775, 'support': 147800}, '1': {'precision': 0.34272240451129954, 'recall': 0.17299033525481086, 'f1-score': 0.22992514663350436, 'support': 139476}, '2': {'precision': 0.37062957800776963, 'recall': 0.3999718374766379, 'f1-score': 0.3847420738145739, 'support': 156236}, 'accuracy': 0.34557351323075813, 'macro avg': {'precision': 0.3464165037326448, 'recall': 0.3412986223042583, 'f1-score': 0.3310067098556186, 'support': 443512}, 'weighted avg': {'precision': 0.34694639058238824, 'recall': 0.34557351323075813, 'f1-score': 0.33392594194543496, 'support': 443512}}
[[66648 24204 56948]
 [66181 24128 49167]
 [71677 22069 62490]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369942
{'0': {'precision': 0.33167313730646086, 'recall': 0.33856477461119444, 'f1-score': 0.33508352476052067, 'support': 63335}, '1': {'precision': 0.3478865059941096, 'recall': 0.258878547946474, 'f1-score': 0.2968541214990487, 'support': 64791}, '2': {'precision': 0.3387133741058396, 'recall': 0.4151364617522694, 'f1-score': 0.3730511435726765, 'support': 67638}, 'accuracy': 0.3386475552195501, 'macro avg': {'precision': 0.33942433913547004, 'recall': 0.3375265947699793, 'f1-score': 0.3349962632774153, 'support': 195764}, 'weighted avg': {'precision': 0.33947164932745466, 'recall': 0.3386475552195501, 'f1-score': 0.3355490471982649, 'support': 195764}}
[[21443 15052 26840]
 [20038 16773 27980]
 [23170 16389 28079]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1214595
{'0': {'precision': 0.32347653586262476, 'recall': 0.24762718299164768, 'f1-score': 0.2805150122301965, 'support': 21072}, '1': {'precision': 0.33223931623931624, 'recall': 0.2214272694130514, 'f1-score': 0.26574420957641715, 'support': 21944}, '2': {'precision': 0.3381720746716919, 'recall': 0.529213897336651, 'f1-score': 0.4126544984190859, 'support': 21702}, 'accuracy': 0.33316851571432987, 'macro avg': {'precision': 0.331295975591211, 'recall': 0.33275611658045007, 'f1-score': 0.3196379067418998, 'support': 64718}, 'weighted avg': {'precision': 0.3313756216783251, 'recall': 0.33316851571432987, 'f1-score': 0.31981722546046853, 'support': 64718}}
[[ 5218  4648 11206]
 [ 5814  4859 11271]
 [ 5099  5118 11485]]
training model: results/PCAR/W0/deepLOB_L1/h500
Epoch 1/50
765/765 - 32s - loss: 3.3003 - accuracy500: 0.3776 - val_loss: 3.3877 - val_accuracy500: 0.3303 - 32s/epoch - 41ms/step
Epoch 2/50
765/765 - 26s - loss: 3.2634 - accuracy500: 0.3915 - val_loss: 3.4343 - val_accuracy500: 0.3457 - 26s/epoch - 35ms/step
Epoch 3/50
765/765 - 25s - loss: 3.2573 - accuracy500: 0.3904 - val_loss: 3.5022 - val_accuracy500: 0.3336 - 25s/epoch - 33ms/step
Epoch 4/50
765/765 - 29s - loss: 3.2404 - accuracy500: 0.3994 - val_loss: 3.4450 - val_accuracy500: 0.3385 - 29s/epoch - 38ms/step
Epoch 5/50
765/765 - 29s - loss: 3.2343 - accuracy500: 0.4042 - val_loss: 3.4851 - val_accuracy500: 0.3322 - 29s/epoch - 37ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2233 - accuracy500: 0.4124 - val_loss: 3.5645 - val_accuracy500: 0.3366 - 27s/epoch - 35ms/step
Epoch 7/50
765/765 - 26s - loss: 3.2130 - accuracy500: 0.4179 - val_loss: 3.5347 - val_accuracy500: 0.3373 - 26s/epoch - 34ms/step
Epoch 8/50
765/765 - 29s - loss: 3.2036 - accuracy500: 0.4245 - val_loss: 3.5311 - val_accuracy500: 0.3332 - 29s/epoch - 38ms/step
Epoch 9/50
765/765 - 28s - loss: 3.1995 - accuracy500: 0.4253 - val_loss: 3.5018 - val_accuracy500: 0.3317 - 28s/epoch - 37ms/step
Epoch 10/50
765/765 - 28s - loss: 3.1966 - accuracy500: 0.4268 - val_loss: 3.5173 - val_accuracy500: 0.3360 - 28s/epoch - 36ms/step
Epoch 11/50
765/765 - 26s - loss: 3.1881 - accuracy500: 0.4314 - val_loss: 3.5303 - val_accuracy500: 0.3373 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepLOB_L1/h500
Evaluating performance on  test set...
1733/1733 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1568927
{'0': {'precision': 0.3218318670652941, 'recall': 0.5736269844026818, 'f1-score': 0.4123281445857742, 'support': 143935}, '1': {'precision': 0.36117461202490475, 'recall': 0.1334033541336299, 'f1-score': 0.19484048206300505, 'support': 145671}, '2': {'precision': 0.3600405527185341, 'recall': 0.311508323262251, 'f1-score': 0.3340207478419597, 'support': 153906}, 'accuracy': 0.33807653456952685, 'macro avg': {'precision': 0.34768234393624436, 'recall': 0.3395128872661875, 'f1-score': 0.313729791496913, 'support': 443512}, 'weighted avg': {'precision': 0.34801299175900924, 'recall': 0.33807653456952685, 'f1-score': 0.31372061313091437, 'support': 443512}}
[[82565 17886 43484]
 [84505 19433 41733]
 [89477 16486 47943]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1503059
{'0': {'precision': 0.3261042666607684, 'recall': 0.47886386150673144, 'f1-score': 0.38798939466707016, 'support': 61577}, '1': {'precision': 0.35738162229757353, 'recall': 0.2238506959088992, 'f1-score': 0.2752776208426337, 'support': 66388}, '2': {'precision': 0.33182766354553866, 'recall': 0.31205475007006, 'f1-score': 0.32163760470666924, 'support': 67799}, 'accuracy': 0.3346120839378027, 'macro avg': {'precision': 0.33843785083462685, 'recall': 0.3382564358285635, 'f1-score': 0.32830154007212436, 'support': 195764}, 'weighted avg': {'precision': 0.3386933109764074, 'recall': 0.3346120839378027, 'f1-score': 0.3267866492788379, 'support': 195764}}
[[29487 12581 19509]
 [28434 14861 23093]
 [32501 14141 21157]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1294539
{'0': {'precision': 0.32709202537227366, 'recall': 0.4658454106280193, 'f1-score': 0.38432872999740936, 'support': 20700}, '1': {'precision': 0.3553314771615622, 'recall': 0.20969890754063417, 'f1-score': 0.26374731197810486, 'support': 22518}, '2': {'precision': 0.3296427920539457, 'recall': 0.33651162790697675, 'f1-score': 0.3330417970907752, 'support': 21500}, 'accuracy': 0.33375567848202975, 'macro avg': {'precision': 0.33735543152926056, 'recall': 0.33735198202521005, 'f1-score': 0.3270392796887632, 'support': 64718}, 'weighted avg': {'precision': 0.33776506006196044, 'recall': 0.33375567848202975, 'f1-score': 0.3253355375555642, 'support': 64718}}
[[ 9643  4024  7033]
 [10116  4722  7680]
 [ 9722  4543  7235]]
training model: results/PCAR/W0/deepLOB_L1/h1000
Epoch 1/50
765/765 - 31s - loss: 3.2961 - accuracy1000: 0.3840 - val_loss: 3.4963 - val_accuracy1000: 0.3342 - 31s/epoch - 40ms/step
Epoch 2/50
765/765 - 27s - loss: 3.2364 - accuracy1000: 0.4067 - val_loss: 3.4668 - val_accuracy1000: 0.3285 - 27s/epoch - 35ms/step
Epoch 3/50
765/765 - 27s - loss: 3.2205 - accuracy1000: 0.4152 - val_loss: 3.4881 - val_accuracy1000: 0.3298 - 27s/epoch - 35ms/step
Epoch 4/50
765/765 - 27s - loss: 3.2001 - accuracy1000: 0.4244 - val_loss: 3.4147 - val_accuracy1000: 0.3370 - 27s/epoch - 35ms/step
Epoch 5/50
765/765 - 27s - loss: 3.1773 - accuracy1000: 0.4364 - val_loss: 3.4497 - val_accuracy1000: 0.3337 - 27s/epoch - 35ms/step
Epoch 6/50
765/765 - 26s - loss: 3.1729 - accuracy1000: 0.4347 - val_loss: 3.4525 - val_accuracy1000: 0.3366 - 26s/epoch - 35ms/step
Epoch 7/50
765/765 - 28s - loss: 3.1592 - accuracy1000: 0.4436 - val_loss: 3.4572 - val_accuracy1000: 0.3354 - 28s/epoch - 36ms/step
Epoch 8/50
765/765 - 27s - loss: 3.1481 - accuracy1000: 0.4493 - val_loss: 3.5981 - val_accuracy1000: 0.3297 - 27s/epoch - 35ms/step
Epoch 9/50
765/765 - 28s - loss: 3.1360 - accuracy1000: 0.4540 - val_loss: 3.6135 - val_accuracy1000: 0.3262 - 28s/epoch - 37ms/step
Epoch 10/50
765/765 - 29s - loss: 3.1311 - accuracy1000: 0.4563 - val_loss: 3.6525 - val_accuracy1000: 0.3284 - 29s/epoch - 38ms/step
Epoch 11/50
765/765 - 25s - loss: 3.1214 - accuracy1000: 0.4596 - val_loss: 3.6859 - val_accuracy1000: 0.3281 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 28s - loss: 3.1178 - accuracy1000: 0.4606 - val_loss: 3.6224 - val_accuracy1000: 0.3356 - 28s/epoch - 36ms/step
Epoch 13/50
765/765 - 27s - loss: 3.1182 - accuracy1000: 0.4596 - val_loss: 3.5945 - val_accuracy1000: 0.3296 - 27s/epoch - 36ms/step
Epoch 14/50
765/765 - 27s - loss: 3.1073 - accuracy1000: 0.4661 - val_loss: 3.6975 - val_accuracy1000: 0.3260 - 27s/epoch - 35ms/step
testing model: results/PCAR/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
1733/1733 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1597034
{'0': {'precision': 0.30635352409882294, 'recall': 0.3501148885616521, 'f1-score': 0.326775600719735, 'support': 140571}, '1': {'precision': 0.3157743055120478, 'recall': 0.17241945525824262, 'f1-score': 0.2230492813141684, 'support': 146161}, '2': {'precision': 0.3601505018369498, 'recall': 0.46644980227069777, 'f1-score': 0.4064652033993453, 'support': 156780}, 'accuracy': 0.33267870993344034, 'macro avg': {'precision': 0.32742611048260684, 'recall': 0.3296613820301975, 'f1-score': 0.31876336181108283, 'support': 443512}, 'weighted avg': {'precision': 0.3284752276872758, 'recall': 0.33267870993344034, 'f1-score': 0.320762219655575, 'support': 443512}}
[[49216 25824 65531]
 [56567 25201 64393]
 [54868 28782 73130]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1477578
{'0': {'precision': 0.3352020555944873, 'recall': 0.2128869548017011, 'f1-score': 0.26039618932405867, 'support': 60666}, '1': {'precision': 0.3451440809224238, 'recall': 0.2740079545799557, 'f1-score': 0.3054895025006135, 'support': 65874}, '2': {'precision': 0.33963864377060743, 'recall': 0.5148647867791517, 'f1-score': 0.4092856076526452, 'support': 69224}, 'accuracy': 0.3402362027747696, 'macro avg': {'precision': 0.3399949267625062, 'recall': 0.33391989872026945, 'f1-score': 0.32505709982577247, 'support': 195764}, 'weighted avg': {'precision': 0.34011633685333076, 'recall': 0.3402362027747696, 'f1-score': 0.32821865927037386, 'support': 195764}}
[[12915 15801 31950]
 [10477 18050 37347]
 [15137 18446 35641]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250188
{'0': {'precision': 0.34836918806384454, 'recall': 0.048234446312755225, 'f1-score': 0.08473646453137529, 'support': 20815}, '1': {'precision': 0.34222711401244876, 'recall': 0.4025985623074519, 'f1-score': 0.3699661503743974, 'support': 22397}, '2': {'precision': 0.3338875112714157, 'recall': 0.5509625220868595, 'f1-score': 0.41579815419166927, 'support': 21506}, 'accuracy': 0.3379276244630551, 'macro avg': {'precision': 0.34149460444923635, 'recall': 0.3339318435690222, 'f1-score': 0.29016692303248065, 'support': 64718}, 'weighted avg': {'precision': 0.3414312886598598, 'recall': 0.3379276244630551, 'f1-score': 0.29345895242748526, 'support': 64718}}
[[ 1004  8440 11371]
 [ 1112  9017 12268]
 [  766  8891 11849]]
training model: results/PCAR/W0/deepOF_L1/h10
Epoch 1/50
765/765 - 28s - loss: 3.2904 - accuracy10: 0.3742 - val_loss: 3.2994 - val_accuracy10: 0.3873 - 28s/epoch - 37ms/step
Epoch 2/50
765/765 - 26s - loss: 3.2545 - accuracy10: 0.3935 - val_loss: 3.2790 - val_accuracy10: 0.3913 - 26s/epoch - 34ms/step
Epoch 3/50
765/765 - 25s - loss: 3.2410 - accuracy10: 0.4007 - val_loss: 3.2716 - val_accuracy10: 0.3933 - 25s/epoch - 33ms/step
Epoch 4/50
765/765 - 26s - loss: 3.2333 - accuracy10: 0.4042 - val_loss: 3.2646 - val_accuracy10: 0.3969 - 26s/epoch - 34ms/step
Epoch 5/50
765/765 - 24s - loss: 3.2275 - accuracy10: 0.4065 - val_loss: 3.2623 - val_accuracy10: 0.3976 - 24s/epoch - 32ms/step
Epoch 6/50
765/765 - 22s - loss: 3.2229 - accuracy10: 0.4093 - val_loss: 3.2607 - val_accuracy10: 0.3973 - 22s/epoch - 29ms/step
Epoch 7/50
765/765 - 25s - loss: 3.2197 - accuracy10: 0.4111 - val_loss: 3.2586 - val_accuracy10: 0.3988 - 25s/epoch - 32ms/step
Epoch 8/50
765/765 - 29s - loss: 3.2156 - accuracy10: 0.4133 - val_loss: 3.2569 - val_accuracy10: 0.3982 - 29s/epoch - 38ms/step
Epoch 9/50
765/765 - 25s - loss: 3.2131 - accuracy10: 0.4130 - val_loss: 3.2560 - val_accuracy10: 0.3995 - 25s/epoch - 32ms/step
Epoch 10/50
765/765 - 25s - loss: 3.2094 - accuracy10: 0.4155 - val_loss: 3.2544 - val_accuracy10: 0.4005 - 25s/epoch - 33ms/step
Epoch 11/50
765/765 - 24s - loss: 3.2063 - accuracy10: 0.4180 - val_loss: 3.2537 - val_accuracy10: 0.4003 - 24s/epoch - 32ms/step
Epoch 12/50
765/765 - 25s - loss: 3.2039 - accuracy10: 0.4190 - val_loss: 3.2534 - val_accuracy10: 0.4018 - 25s/epoch - 33ms/step
Epoch 13/50
765/765 - 25s - loss: 3.2007 - accuracy10: 0.4191 - val_loss: 3.2528 - val_accuracy10: 0.4006 - 25s/epoch - 33ms/step
Epoch 14/50
765/765 - 24s - loss: 3.1986 - accuracy10: 0.4200 - val_loss: 3.2518 - val_accuracy10: 0.4024 - 24s/epoch - 32ms/step
Epoch 15/50
765/765 - 26s - loss: 3.1951 - accuracy10: 0.4226 - val_loss: 3.2530 - val_accuracy10: 0.4009 - 26s/epoch - 34ms/step
Epoch 16/50
765/765 - 27s - loss: 3.1925 - accuracy10: 0.4244 - val_loss: 3.2538 - val_accuracy10: 0.4022 - 27s/epoch - 35ms/step
Epoch 17/50
765/765 - 26s - loss: 3.1898 - accuracy10: 0.4257 - val_loss: 3.2542 - val_accuracy10: 0.4005 - 26s/epoch - 34ms/step
Epoch 18/50
765/765 - 27s - loss: 3.1874 - accuracy10: 0.4263 - val_loss: 3.2531 - val_accuracy10: 0.4018 - 27s/epoch - 35ms/step
Epoch 19/50
765/765 - 27s - loss: 3.1852 - accuracy10: 0.4273 - val_loss: 3.2518 - val_accuracy10: 0.4030 - 27s/epoch - 35ms/step
Epoch 20/50
765/765 - 28s - loss: 3.1814 - accuracy10: 0.4280 - val_loss: 3.2528 - val_accuracy10: 0.4043 - 28s/epoch - 36ms/step
Epoch 21/50
765/765 - 26s - loss: 3.1798 - accuracy10: 0.4284 - val_loss: 3.2537 - val_accuracy10: 0.4020 - 26s/epoch - 34ms/step
Epoch 22/50
765/765 - 26s - loss: 3.1769 - accuracy10: 0.4302 - val_loss: 3.2568 - val_accuracy10: 0.4013 - 26s/epoch - 34ms/step
Epoch 23/50
765/765 - 26s - loss: 3.1743 - accuracy10: 0.4311 - val_loss: 3.2519 - val_accuracy10: 0.4021 - 26s/epoch - 34ms/step
Epoch 24/50
765/765 - 25s - loss: 3.1722 - accuracy10: 0.4324 - val_loss: 3.2543 - val_accuracy10: 0.4031 - 25s/epoch - 33ms/step
testing model: results/PCAR/W0/deepOF_L1/h10
Evaluating performance on  test set...
1733/1733 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0878109
{'0': {'precision': 0.4068142606909086, 'recall': 0.4281635085871117, 'f1-score': 0.41721594899778486, 'support': 144286}, '1': {'precision': 0.42843790890398153, 'recall': 0.08966785337036892, 'f1-score': 0.14829832204632704, 'support': 153366}, '2': {'precision': 0.3694495494141806, 'recall': 0.6574406088238319, 'f1-score': 0.4730615728430265, 'support': 145855}, 'accuracy': 0.38651250149377575, 'macro avg': {'precision': 0.40156723966969027, 'recall': 0.39175732359377086, 'f1-score': 0.34619194796237945, 'support': 443507}, 'weighted avg': {'precision': 0.4020037446642822, 'recall': 0.38651250149377575, 'f1-score': 0.3425892637164036, 'support': 443507}}
[[61778  9357 73151]
 [49105 13752 90509]
 [40975  8989 95891]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0725384
{'0': {'precision': 0.4251676332666209, 'recall': 0.44641460234680574, 'f1-score': 0.43553214413983005, 'support': 65195}, '1': {'precision': 0.5395654931810974, 'recall': 0.10586825974672516, 'f1-score': 0.17700611262843022, 'support': 64278}, '2': {'precision': 0.3936913137865195, 'recall': 0.6811784405122867, 'f1-score': 0.49898889441405603, 'support': 66291}, 'accuracy': 0.414095543613739, 'macro avg': {'precision': 0.45280814674474595, 'recall': 0.41115376753527255, 'f1-score': 0.37050905039410537, 'support': 195764}, 'weighted avg': {'precision': 0.4520707867827286, 'recall': 0.414095543613739, 'f1-score': 0.3721347635128453, 'support': 195764}}
[[29104  2858 33233]
 [21163  6805 36310]
 [18186  2949 45156]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0829003
{'0': {'precision': 0.4128041200497247, 'recall': 0.4333721743183407, 'f1-score': 0.4228381727642738, 'support': 21455}, '1': {'precision': 0.48191802839539244, 'recall': 0.08552819245031854, 'f1-score': 0.1452739532442363, 'support': 21034}, '2': {'precision': 0.39133147864070095, 'recall': 0.6770884880111566, 'f1-score': 0.4959960454770142, 'support': 22229}, 'accuracy': 0.40402979078463486, 'macro avg': {'precision': 0.42868454236193937, 'recall': 0.398662951593272, 'f1-score': 0.3547027238285081, 'support': 64718}, 'weighted avg': {'precision': 0.42789152389813756, 'recall': 0.40402979078463486, 'f1-score': 0.3577548970009164, 'support': 64718}}
[[ 9298   983 11174]
 [ 6999  1799 12236]
 [ 6227   951 15051]]
training model: results/PCAR/W0/deepOF_L1/h20
Epoch 1/50
765/765 - 30s - loss: 3.3026 - accuracy20: 0.3666 - val_loss: 3.3031 - val_accuracy20: 0.3756 - 30s/epoch - 40ms/step
Epoch 2/50
765/765 - 26s - loss: 3.2710 - accuracy20: 0.3828 - val_loss: 3.2891 - val_accuracy20: 0.3794 - 26s/epoch - 33ms/step
Epoch 3/50
765/765 - 25s - loss: 3.2603 - accuracy20: 0.3886 - val_loss: 3.2818 - val_accuracy20: 0.3821 - 25s/epoch - 33ms/step
Epoch 4/50
765/765 - 24s - loss: 3.2539 - accuracy20: 0.3926 - val_loss: 3.2759 - val_accuracy20: 0.3839 - 24s/epoch - 32ms/step
Epoch 5/50
765/765 - 24s - loss: 3.2495 - accuracy20: 0.3951 - val_loss: 3.2747 - val_accuracy20: 0.3836 - 24s/epoch - 32ms/step
Epoch 6/50
765/765 - 25s - loss: 3.2469 - accuracy20: 0.3973 - val_loss: 3.2716 - val_accuracy20: 0.3854 - 25s/epoch - 33ms/step
Epoch 7/50
765/765 - 25s - loss: 3.2438 - accuracy20: 0.3993 - val_loss: 3.2711 - val_accuracy20: 0.3852 - 25s/epoch - 33ms/step
Epoch 8/50
765/765 - 25s - loss: 3.2414 - accuracy20: 0.4006 - val_loss: 3.2685 - val_accuracy20: 0.3850 - 25s/epoch - 32ms/step
Epoch 9/50
765/765 - 25s - loss: 3.2384 - accuracy20: 0.4022 - val_loss: 3.2702 - val_accuracy20: 0.3850 - 25s/epoch - 33ms/step
Epoch 10/50
765/765 - 25s - loss: 3.2366 - accuracy20: 0.4030 - val_loss: 3.2713 - val_accuracy20: 0.3844 - 25s/epoch - 32ms/step
Epoch 11/50
765/765 - 28s - loss: 3.2343 - accuracy20: 0.4049 - val_loss: 3.2690 - val_accuracy20: 0.3847 - 28s/epoch - 37ms/step
Epoch 12/50
765/765 - 26s - loss: 3.2323 - accuracy20: 0.4063 - val_loss: 3.2679 - val_accuracy20: 0.3864 - 26s/epoch - 34ms/step
Epoch 13/50
765/765 - 26s - loss: 3.2305 - accuracy20: 0.4074 - val_loss: 3.2692 - val_accuracy20: 0.3844 - 26s/epoch - 34ms/step
Epoch 14/50
765/765 - 26s - loss: 3.2280 - accuracy20: 0.4082 - val_loss: 3.2694 - val_accuracy20: 0.3869 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 25s - loss: 3.2262 - accuracy20: 0.4084 - val_loss: 3.2708 - val_accuracy20: 0.3860 - 25s/epoch - 33ms/step
Epoch 16/50
765/765 - 25s - loss: 3.2243 - accuracy20: 0.4097 - val_loss: 3.2706 - val_accuracy20: 0.3866 - 25s/epoch - 32ms/step
Epoch 17/50
765/765 - 25s - loss: 3.2225 - accuracy20: 0.4112 - val_loss: 3.2699 - val_accuracy20: 0.3882 - 25s/epoch - 33ms/step
Epoch 18/50
765/765 - 25s - loss: 3.2199 - accuracy20: 0.4123 - val_loss: 3.2713 - val_accuracy20: 0.3867 - 25s/epoch - 33ms/step
Epoch 19/50
765/765 - 23s - loss: 3.2191 - accuracy20: 0.4128 - val_loss: 3.2705 - val_accuracy20: 0.3877 - 23s/epoch - 30ms/step
Epoch 20/50
765/765 - 25s - loss: 3.2176 - accuracy20: 0.4133 - val_loss: 3.2723 - val_accuracy20: 0.3865 - 25s/epoch - 33ms/step
Epoch 21/50
765/765 - 25s - loss: 3.2149 - accuracy20: 0.4153 - val_loss: 3.2726 - val_accuracy20: 0.3853 - 25s/epoch - 33ms/step
Epoch 22/50
765/765 - 24s - loss: 3.2126 - accuracy20: 0.4166 - val_loss: 3.2733 - val_accuracy20: 0.3862 - 24s/epoch - 32ms/step
testing model: results/PCAR/W0/deepOF_L1/h20
Evaluating performance on  test set...
1733/1733 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.09238
{'0': {'precision': 0.38379065353585684, 'recall': 0.4827940782894088, 'f1-score': 0.42763701695888007, 'support': 141986}, '1': {'precision': 0.4100581812385431, 'recall': 0.0654263841908492, 'f1-score': 0.11284750781378515, 'support': 157276}, '2': {'precision': 0.369070058381985, 'recall': 0.613560262054144, 'f1-score': 0.46089911338515016, 'support': 144245}, 'accuracy': 0.37731760716290835, 'macro avg': {'precision': 0.38763963105212834, 'recall': 0.3872602415114674, 'f1-score': 0.3337945460526051, 'support': 443507}, 'weighted avg': {'precision': 0.3883179314345088, 'recall': 0.37731760716290835, 'f1-score': 0.32682475527801236, 'support': 443507}}
[[68550  7133 66303]
 [61992 10290 84994]
 [48071  7671 88503]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0788277
{'0': {'precision': 0.40337660676600373, 'recall': 0.48344472377215036, 'f1-score': 0.43979612469582563, 'support': 65236}, '1': {'precision': 0.49608310626702995, 'recall': 0.09100991955010544, 'f1-score': 0.1538035084940403, 'support': 64015}, '2': {'precision': 0.3939906458166013, 'recall': 0.6269150391652759, 'f1-score': 0.48388144916099984, 'support': 66513}, 'accuracy': 0.40386383604748577, 'macro avg': {'precision': 0.43115011961654504, 'recall': 0.40045656082917724, 'f1-score': 0.35916036078362196, 'support': 195764}, 'weighted avg': {'precision': 0.43050272875437023, 'recall': 0.40386383604748577, 'f1-score': 0.36125476806230183, 'support': 195764}}
[[31538  2758 30940]
 [24992  5826 33197]
 [21655  3160 41698]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0883203
{'0': {'precision': 0.3877017503978177, 'recall': 0.4784234887091496, 'f1-score': 0.4283113241110855, 'support': 21389}, '1': {'precision': 0.45693531649948116, 'recall': 0.061516252211977276, 'f1-score': 0.10843422942745741, 'support': 21474}, '2': {'precision': 0.3801823159201874, 'recall': 0.6163806909174102, 'f1-score': 0.47029046222594606, 'support': 21855}, 'accuracy': 0.38667758583392564, 'macro avg': {'precision': 0.40827312760582873, 'recall': 0.385440143946179, 'f1-score': 0.33567867192149636, 'support': 64718}, 'weighted avg': {'precision': 0.40813477301839485, 'recall': 0.38667758583392564, 'f1-score': 0.3363494793733626, 'support': 64718}}
[[10233   756 10400]
 [ 8591  1321 11562]
 [ 7570   814 13471]]
training model: results/PCAR/W0/deepOF_L1/h30
Epoch 1/50
765/765 - 32s - loss: 3.3077 - accuracy30: 0.3622 - val_loss: 3.3266 - val_accuracy30: 0.3640 - 32s/epoch - 42ms/step
Epoch 2/50
765/765 - 26s - loss: 3.2798 - accuracy30: 0.3742 - val_loss: 3.3144 - val_accuracy30: 0.3673 - 26s/epoch - 34ms/step
Epoch 3/50
765/765 - 24s - loss: 3.2707 - accuracy30: 0.3792 - val_loss: 3.3052 - val_accuracy30: 0.3703 - 24s/epoch - 32ms/step
Epoch 4/50
765/765 - 24s - loss: 3.2651 - accuracy30: 0.3840 - val_loss: 3.2991 - val_accuracy30: 0.3720 - 24s/epoch - 31ms/step
Epoch 5/50
765/765 - 23s - loss: 3.2620 - accuracy30: 0.3863 - val_loss: 3.2957 - val_accuracy30: 0.3735 - 23s/epoch - 31ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2588 - accuracy30: 0.3894 - val_loss: 3.2936 - val_accuracy30: 0.3726 - 27s/epoch - 35ms/step
Epoch 7/50
765/765 - 28s - loss: 3.2561 - accuracy30: 0.3918 - val_loss: 3.2927 - val_accuracy30: 0.3737 - 28s/epoch - 36ms/step
Epoch 8/50
765/765 - 27s - loss: 3.2543 - accuracy30: 0.3918 - val_loss: 3.2925 - val_accuracy30: 0.3720 - 27s/epoch - 36ms/step
Epoch 9/50
765/765 - 26s - loss: 3.2531 - accuracy30: 0.3936 - val_loss: 3.2933 - val_accuracy30: 0.3721 - 26s/epoch - 34ms/step
Epoch 10/50
765/765 - 27s - loss: 3.2509 - accuracy30: 0.3946 - val_loss: 3.2935 - val_accuracy30: 0.3718 - 27s/epoch - 36ms/step
Epoch 11/50
765/765 - 25s - loss: 3.2491 - accuracy30: 0.3961 - val_loss: 3.2913 - val_accuracy30: 0.3723 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 27s - loss: 3.2475 - accuracy30: 0.3979 - val_loss: 3.2929 - val_accuracy30: 0.3727 - 27s/epoch - 35ms/step
Epoch 13/50
765/765 - 27s - loss: 3.2463 - accuracy30: 0.3979 - val_loss: 3.2927 - val_accuracy30: 0.3711 - 27s/epoch - 35ms/step
Epoch 14/50
765/765 - 25s - loss: 3.2437 - accuracy30: 0.4003 - val_loss: 3.2940 - val_accuracy30: 0.3725 - 25s/epoch - 33ms/step
Epoch 15/50
765/765 - 24s - loss: 3.2424 - accuracy30: 0.3991 - val_loss: 3.2935 - val_accuracy30: 0.3730 - 24s/epoch - 32ms/step
Epoch 16/50
765/765 - 26s - loss: 3.2413 - accuracy30: 0.4006 - val_loss: 3.2951 - val_accuracy30: 0.3722 - 26s/epoch - 34ms/step
Epoch 17/50
765/765 - 25s - loss: 3.2400 - accuracy30: 0.4023 - val_loss: 3.2960 - val_accuracy30: 0.3714 - 25s/epoch - 33ms/step
Epoch 18/50
765/765 - 26s - loss: 3.2379 - accuracy30: 0.4029 - val_loss: 3.2954 - val_accuracy30: 0.3707 - 26s/epoch - 34ms/step
Epoch 19/50
765/765 - 28s - loss: 3.2361 - accuracy30: 0.4044 - val_loss: 3.2931 - val_accuracy30: 0.3735 - 28s/epoch - 36ms/step
Epoch 20/50
765/765 - 26s - loss: 3.2354 - accuracy30: 0.4044 - val_loss: 3.2945 - val_accuracy30: 0.3726 - 26s/epoch - 34ms/step
Epoch 21/50
765/765 - 25s - loss: 3.2325 - accuracy30: 0.4062 - val_loss: 3.2961 - val_accuracy30: 0.3724 - 25s/epoch - 32ms/step
testing model: results/PCAR/W0/deepOF_L1/h30
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0970751
{'0': {'precision': 0.37139545572630445, 'recall': 0.5256161884695335, 'f1-score': 0.43524844993237666, 'support': 141434}, '1': {'precision': 0.4110691823899371, 'recall': 0.052017343359034275, 'f1-score': 0.09234873232431699, 'support': 157063}, '2': {'precision': 0.3732167469167845, 'recall': 0.5751465416178194, 'f1-score': 0.4526837423129739, 'support': 145010}, 'accuracy': 0.37409105155048283, 'macro avg': {'precision': 0.38522712834434203, 'recall': 0.38426002448212904, 'f1-score': 0.32676030818988916, 'support': 443507}, 'weighted avg': {'precision': 0.38604095166323815, 'recall': 0.37409105155048283, 'f1-score': 0.319515064442262, 'support': 443507}}
[[74340  5887 61207]
 [70034  8170 78859]
 [55790  5818 83402]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0860869
{'0': {'precision': 0.3892372484791764, 'recall': 0.5134092522297318, 'f1-score': 0.4427824281702886, 'support': 64806}, '1': {'precision': 0.4738406027804309, 'recall': 0.0692366139961854, 'f1-score': 0.12081935274380345, 'support': 64489}, '2': {'precision': 0.38891147222415007, 'recall': 0.5901397644014503, 'f1-score': 0.4688459929480667, 'support': 66469}, 'accuracy': 0.39314174209762776, 'macro avg': {'precision': 0.4173297744945858, 'recall': 0.3909285435424558, 'f1-score': 0.3441492579540529, 'support': 195764}, 'weighted avg': {'precision': 0.41699685542242576, 'recall': 0.39314174209762776, 'f1-score': 0.3455701844280047, 'support': 195764}}
[[33272  2296 29238]
 [27627  4465 32397]
 [24581  2662 39226]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.096101
{'0': {'precision': 0.36960440831320795, 'recall': 0.5132977467050877, 'f1-score': 0.4297579496915045, 'support': 21169}, '1': {'precision': 0.44036697247706424, 'recall': 0.04360663184192596, 'f1-score': 0.07935523868567886, 'support': 22015}, '2': {'precision': 0.37043966323666977, 'recall': 0.5700752298690444, 'f1-score': 0.4490699248257824, 'support': 21534}, 'accuracy': 0.3724157112395315, 'macro avg': {'precision': 0.3934703480089807, 'recall': 0.3756598694720193, 'f1-score': 0.3193943710676552, 'support': 64718}, 'weighted avg': {'precision': 0.39395349557778847, 'recall': 0.3724157112395315, 'f1-score': 0.31698790719557274, 'support': 64718}}
[[10866   610  9693]
 [ 9885   960 11170]
 [ 8648   610 12276]]
training model: results/PCAR/W0/deepOF_L1/h50
Epoch 1/50
765/765 - 27s - loss: 3.3118 - accuracy50: 0.3615 - val_loss: 3.3145 - val_accuracy50: 0.3520 - 27s/epoch - 35ms/step
Epoch 2/50
765/765 - 26s - loss: 3.2856 - accuracy50: 0.3731 - val_loss: 3.3046 - val_accuracy50: 0.3578 - 26s/epoch - 34ms/step
Epoch 3/50
765/765 - 26s - loss: 3.2789 - accuracy50: 0.3750 - val_loss: 3.2988 - val_accuracy50: 0.3597 - 26s/epoch - 35ms/step
Epoch 4/50
765/765 - 26s - loss: 3.2746 - accuracy50: 0.3769 - val_loss: 3.2970 - val_accuracy50: 0.3606 - 26s/epoch - 34ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2710 - accuracy50: 0.3792 - val_loss: 3.2948 - val_accuracy50: 0.3613 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 23s - loss: 3.2705 - accuracy50: 0.3787 - val_loss: 3.2946 - val_accuracy50: 0.3610 - 23s/epoch - 31ms/step
Epoch 7/50
765/765 - 26s - loss: 3.2677 - accuracy50: 0.3819 - val_loss: 3.2947 - val_accuracy50: 0.3612 - 26s/epoch - 33ms/step
Epoch 8/50
765/765 - 26s - loss: 3.2666 - accuracy50: 0.3830 - val_loss: 3.2936 - val_accuracy50: 0.3618 - 26s/epoch - 35ms/step
Epoch 9/50
765/765 - 27s - loss: 3.2648 - accuracy50: 0.3842 - val_loss: 3.2934 - val_accuracy50: 0.3630 - 27s/epoch - 35ms/step
Epoch 10/50
765/765 - 27s - loss: 3.2641 - accuracy50: 0.3850 - val_loss: 3.2938 - val_accuracy50: 0.3615 - 27s/epoch - 35ms/step
Epoch 11/50
765/765 - 26s - loss: 3.2622 - accuracy50: 0.3857 - val_loss: 3.2936 - val_accuracy50: 0.3635 - 26s/epoch - 34ms/step
Epoch 12/50
765/765 - 26s - loss: 3.2608 - accuracy50: 0.3868 - val_loss: 3.2936 - val_accuracy50: 0.3619 - 26s/epoch - 34ms/step
Epoch 13/50
765/765 - 25s - loss: 3.2598 - accuracy50: 0.3884 - val_loss: 3.2929 - val_accuracy50: 0.3636 - 25s/epoch - 32ms/step
Epoch 14/50
765/765 - 26s - loss: 3.2592 - accuracy50: 0.3887 - val_loss: 3.2943 - val_accuracy50: 0.3627 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 26s - loss: 3.2573 - accuracy50: 0.3896 - val_loss: 3.2943 - val_accuracy50: 0.3635 - 26s/epoch - 34ms/step
Epoch 16/50
765/765 - 26s - loss: 3.2561 - accuracy50: 0.3913 - val_loss: 3.2955 - val_accuracy50: 0.3616 - 26s/epoch - 35ms/step
Epoch 17/50
765/765 - 28s - loss: 3.2545 - accuracy50: 0.3932 - val_loss: 3.2940 - val_accuracy50: 0.3629 - 28s/epoch - 36ms/step
Epoch 18/50
765/765 - 25s - loss: 3.2534 - accuracy50: 0.3930 - val_loss: 3.2943 - val_accuracy50: 0.3638 - 25s/epoch - 33ms/step
Epoch 19/50
765/765 - 23s - loss: 3.2525 - accuracy50: 0.3932 - val_loss: 3.2950 - val_accuracy50: 0.3616 - 23s/epoch - 31ms/step
Epoch 20/50
765/765 - 25s - loss: 3.2509 - accuracy50: 0.3949 - val_loss: 3.2944 - val_accuracy50: 0.3634 - 25s/epoch - 33ms/step
Epoch 21/50
765/765 - 23s - loss: 3.2505 - accuracy50: 0.3948 - val_loss: 3.2961 - val_accuracy50: 0.3627 - 23s/epoch - 30ms/step
Epoch 22/50
765/765 - 25s - loss: 3.2491 - accuracy50: 0.3958 - val_loss: 3.2970 - val_accuracy50: 0.3634 - 25s/epoch - 33ms/step
Epoch 23/50
765/765 - 26s - loss: 3.2471 - accuracy50: 0.3967 - val_loss: 3.2958 - val_accuracy50: 0.3624 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepOF_L1/h50
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0984002
{'0': {'precision': 0.3424084341356153, 'recall': 0.5179601153291686, 'f1-score': 0.41227427977206105, 'support': 133184}, '1': {'precision': 0.45817405550315243, 'recall': 0.10625388565244422, 'f1-score': 0.1725030607190587, 'support': 173716}, '2': {'precision': 0.3493561465943674, 'recall': 0.5159618467574868, 'f1-score': 0.4166201187489102, 'support': 136607}, 'accuracy': 0.35608457138218785, 'macro avg': {'precision': 0.3833128787443784, 'recall': 0.3800586159130332, 'f1-score': 0.33379915308000996, 'support': 443507}, 'weighted avg': {'precision': 0.3898923449585242, 'recall': 0.35608457138218785, 'f1-score': 0.3196975559235064, 'support': 443507}}
[[68984 11391 52809]
 [76797 18458 78461]
 [55686 10437 70484]]
Evaluating performance on  train set...
765/765 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0872211
{'0': {'precision': 0.37798402310361695, 'recall': 0.501832068149843, 'f1-score': 0.4311912590083358, 'support': 64681}, '1': {'precision': 0.43990520257307303, 'recall': 0.120649364718263, 'f1-score': 0.1893634851042641, 'support': 64617}, '2': {'precision': 0.38590400138876835, 'recall': 0.5351307435380496, 'f1-score': 0.4484284579598321, 'support': 66466}, 'accuracy': 0.38731840379232135, 'macro avg': {'precision': 0.4012644090218194, 'recall': 0.3858707254687186, 'f1-score': 0.35632773402414397, 'support': 195764}, 'weighted avg': {'precision': 0.4011117183411413, 'recall': 0.38731840379232135, 'f1-score': 0.35722210430752643, 'support': 195764}}
[[32459  5072 27150]
 [27371  7796 29450]
 [26044  4854 35568]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973234
{'0': {'precision': 0.3562110783349721, 'recall': 0.5128834355828221, 'f1-score': 0.4204255319148936, 'support': 21190}, '1': {'precision': 0.3979785217940619, 'recall': 0.0854932826706473, 'f1-score': 0.14075067024128687, 'support': 22107}, '2': {'precision': 0.36301300112020096, 'recall': 0.4992297278371691, 'f1-score': 0.4203616352201258, 'support': 21421}, 'accuracy': 0.36237213758150744, 'macro avg': {'precision': 0.37240086708307835, 'recall': 0.36586881536354615, 'f1-score': 0.32717927912543543, 'support': 64718}, 'weighted avg': {'precision': 0.3727297726786244, 'recall': 0.36237213758150744, 'f1-score': 0.32487034018898975, 'support': 64718}}
[[10868  1527  8795]
 [10247  1890  9970]
 [ 9395  1332 10694]]
training model: results/PCAR/W0/deepOF_L1/h100
Epoch 1/50
765/765 - 31s - loss: 3.3237 - accuracy100: 0.3479 - val_loss: 3.3463 - val_accuracy100: 0.3432 - 31s/epoch - 40ms/step
Epoch 2/50
765/765 - 27s - loss: 3.3006 - accuracy100: 0.3573 - val_loss: 3.3322 - val_accuracy100: 0.3496 - 27s/epoch - 36ms/step
Epoch 3/50
765/765 - 24s - loss: 3.2940 - accuracy100: 0.3586 - val_loss: 3.3233 - val_accuracy100: 0.3478 - 24s/epoch - 31ms/step
Epoch 4/50
765/765 - 25s - loss: 3.2895 - accuracy100: 0.3616 - val_loss: 3.3198 - val_accuracy100: 0.3491 - 25s/epoch - 33ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2867 - accuracy100: 0.3628 - val_loss: 3.3148 - val_accuracy100: 0.3506 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 27s - loss: 3.2850 - accuracy100: 0.3652 - val_loss: 3.3129 - val_accuracy100: 0.3499 - 27s/epoch - 35ms/step
Epoch 7/50
765/765 - 25s - loss: 3.2826 - accuracy100: 0.3673 - val_loss: 3.3115 - val_accuracy100: 0.3499 - 25s/epoch - 33ms/step
Epoch 8/50
765/765 - 26s - loss: 3.2817 - accuracy100: 0.3686 - val_loss: 3.3119 - val_accuracy100: 0.3505 - 26s/epoch - 34ms/step
Epoch 9/50
765/765 - 25s - loss: 3.2808 - accuracy100: 0.3708 - val_loss: 3.3114 - val_accuracy100: 0.3495 - 25s/epoch - 32ms/step
Epoch 10/50
765/765 - 24s - loss: 3.2795 - accuracy100: 0.3709 - val_loss: 3.3098 - val_accuracy100: 0.3508 - 24s/epoch - 32ms/step
Epoch 11/50
765/765 - 26s - loss: 3.2786 - accuracy100: 0.3716 - val_loss: 3.3091 - val_accuracy100: 0.3502 - 26s/epoch - 33ms/step
Epoch 12/50
765/765 - 28s - loss: 3.2771 - accuracy100: 0.3731 - val_loss: 3.3089 - val_accuracy100: 0.3512 - 28s/epoch - 37ms/step
Epoch 13/50
765/765 - 27s - loss: 3.2767 - accuracy100: 0.3744 - val_loss: 3.3082 - val_accuracy100: 0.3513 - 27s/epoch - 36ms/step
Epoch 14/50
765/765 - 28s - loss: 3.2754 - accuracy100: 0.3752 - val_loss: 3.3092 - val_accuracy100: 0.3507 - 28s/epoch - 36ms/step
Epoch 15/50
765/765 - 27s - loss: 3.2746 - accuracy100: 0.3745 - val_loss: 3.3084 - val_accuracy100: 0.3502 - 27s/epoch - 35ms/step
Epoch 16/50
765/765 - 28s - loss: 3.2735 - accuracy100: 0.3780 - val_loss: 3.3108 - val_accuracy100: 0.3505 - 28s/epoch - 36ms/step
Epoch 17/50
765/765 - 25s - loss: 3.2720 - accuracy100: 0.3781 - val_loss: 3.3109 - val_accuracy100: 0.3510 - 25s/epoch - 33ms/step
Epoch 18/50
765/765 - 26s - loss: 3.2712 - accuracy100: 0.3788 - val_loss: 3.3130 - val_accuracy100: 0.3500 - 26s/epoch - 34ms/step
Epoch 19/50
765/765 - 26s - loss: 3.2699 - accuracy100: 0.3802 - val_loss: 3.3125 - val_accuracy100: 0.3506 - 26s/epoch - 35ms/step
Epoch 20/50
765/765 - 29s - loss: 3.2690 - accuracy100: 0.3809 - val_loss: 3.3121 - val_accuracy100: 0.3520 - 29s/epoch - 37ms/step
Epoch 21/50
765/765 - 23s - loss: 3.2683 - accuracy100: 0.3809 - val_loss: 3.3140 - val_accuracy100: 0.3495 - 23s/epoch - 30ms/step
Epoch 22/50
765/765 - 22s - loss: 3.2666 - accuracy100: 0.3816 - val_loss: 3.3143 - val_accuracy100: 0.3505 - 22s/epoch - 29ms/step
Epoch 23/50
765/765 - 24s - loss: 3.2659 - accuracy100: 0.3816 - val_loss: 3.3161 - val_accuracy100: 0.3471 - 24s/epoch - 31ms/step
testing model: results/PCAR/W0/deepOF_L1/h100
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100796
{'0': {'precision': 0.3457164908669925, 'recall': 0.6086814121057547, 'f1-score': 0.44097163498310016, 'support': 143502}, '1': {'precision': 0.3863150867823765, 'recall': 0.038301167500595666, 'f1-score': 0.0696926634230936, 'support': 151092}, '2': {'precision': 0.3672273016739447, 'recall': 0.4337096156816396, 'f1-score': 0.39770925381406164, 'support': 148913}, 'accuracy': 0.35561783692252885, 'macro avg': {'precision': 0.3664196264411046, 'recall': 0.36023073176266335, 'f1-score': 0.3027911840734185, 'support': 443507}, 'weighted avg': {'precision': 0.3667699633572641, 'recall': 0.35561783692252885, 'f1-score': 0.29996007634260624, 'support': 443507}}
[[87347  4883 51272]
 [85290  5787 60015]
 [80018  4310 64585]]
Evaluating performance on  train set...
765/765 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944192
{'0': {'precision': 0.35884172158609773, 'recall': 0.6067765482249303, 'f1-score': 0.4509789178403077, 'support': 64251}, '1': {'precision': 0.42714216556398255, 'recall': 0.04097015849430411, 'f1-score': 0.0747687310218205, 'support': 64608}, '2': {'precision': 0.37819902870630107, 'recall': 0.4574396532396682, 'f1-score': 0.4140622886056769, 'support': 66905}, 'accuracy': 0.3690055372795815, 'macro avg': {'precision': 0.3880609719521271, 'recall': 0.36839545331963414, 'f1-score': 0.313269979155935, 'support': 195764}, 'weighted avg': {'precision': 0.38799854162144837, 'recall': 0.3690055372795815, 'f1-score': 0.3142014979423091, 'support': 195764}}
[[38986  1694 23571]
 [35214  2647 26747]
 [34444  1856 30605]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101913
{'0': {'precision': 0.3458654501599287, 'recall': 0.6163333956269856, 'f1-score': 0.4430860175326638, 'support': 21404}, '1': {'precision': 0.3599740090968161, 'recall': 0.025322241521162813, 'f1-score': 0.047316052440534655, 'support': 21878}, '2': {'precision': 0.35635259815473097, 'recall': 0.416215711886546, 'f1-score': 0.38396488283519464, 'support': 21436}, 'accuracy': 0.3502580425847523, 'macro avg': {'precision': 0.3540640191371585, 'recall': 0.35262378301156483, 'f1-score': 0.291455650936131, 'support': 64718}, 'weighted avg': {'precision': 0.35410843598825786, 'recall': 0.3502580425847523, 'f1-score': 0.2897132937207328, 'support': 64718}}
[[13192   534  7678]
 [12887   554  8437]
 [12063   451  8922]]
training model: results/PCAR/W0/deepOF_L1/h200
Epoch 1/50
765/765 - 28s - loss: 3.3301 - accuracy200: 0.3478 - val_loss: 3.3470 - val_accuracy200: 0.3336 - 28s/epoch - 37ms/step
Epoch 2/50
765/765 - 27s - loss: 3.3086 - accuracy200: 0.3535 - val_loss: 3.3243 - val_accuracy200: 0.3361 - 27s/epoch - 35ms/step
Epoch 3/50
765/765 - 24s - loss: 3.3021 - accuracy200: 0.3518 - val_loss: 3.3142 - val_accuracy200: 0.3356 - 24s/epoch - 32ms/step
Epoch 4/50
765/765 - 25s - loss: 3.2986 - accuracy200: 0.3486 - val_loss: 3.3098 - val_accuracy200: 0.3367 - 25s/epoch - 32ms/step
Epoch 5/50
765/765 - 27s - loss: 3.2962 - accuracy200: 0.3489 - val_loss: 3.3058 - val_accuracy200: 0.3392 - 27s/epoch - 36ms/step
Epoch 6/50
765/765 - 25s - loss: 3.2947 - accuracy200: 0.3478 - val_loss: 3.3038 - val_accuracy200: 0.3384 - 25s/epoch - 32ms/step
Epoch 7/50
765/765 - 29s - loss: 3.2932 - accuracy200: 0.3486 - val_loss: 3.3032 - val_accuracy200: 0.3403 - 29s/epoch - 38ms/step
Epoch 8/50
765/765 - 26s - loss: 3.2923 - accuracy200: 0.3508 - val_loss: 3.3023 - val_accuracy200: 0.3397 - 26s/epoch - 34ms/step
Epoch 9/50
765/765 - 26s - loss: 3.2916 - accuracy200: 0.3508 - val_loss: 3.3034 - val_accuracy200: 0.3402 - 26s/epoch - 34ms/step
Epoch 10/50
765/765 - 27s - loss: 3.2908 - accuracy200: 0.3514 - val_loss: 3.3032 - val_accuracy200: 0.3390 - 27s/epoch - 35ms/step
Epoch 11/50
765/765 - 24s - loss: 3.2895 - accuracy200: 0.3542 - val_loss: 3.3029 - val_accuracy200: 0.3395 - 24s/epoch - 32ms/step
Epoch 12/50
765/765 - 28s - loss: 3.2891 - accuracy200: 0.3543 - val_loss: 3.3032 - val_accuracy200: 0.3402 - 28s/epoch - 37ms/step
Epoch 13/50
765/765 - 25s - loss: 3.2887 - accuracy200: 0.3550 - val_loss: 3.3031 - val_accuracy200: 0.3415 - 25s/epoch - 33ms/step
Epoch 14/50
765/765 - 26s - loss: 3.2875 - accuracy200: 0.3563 - val_loss: 3.3038 - val_accuracy200: 0.3414 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 25s - loss: 3.2870 - accuracy200: 0.3577 - val_loss: 3.3038 - val_accuracy200: 0.3396 - 25s/epoch - 32ms/step
Epoch 16/50
765/765 - 25s - loss: 3.2862 - accuracy200: 0.3581 - val_loss: 3.3047 - val_accuracy200: 0.3418 - 25s/epoch - 32ms/step
Epoch 17/50
765/765 - 25s - loss: 3.2855 - accuracy200: 0.3598 - val_loss: 3.3041 - val_accuracy200: 0.3418 - 25s/epoch - 33ms/step
Epoch 18/50
765/765 - 25s - loss: 3.2846 - accuracy200: 0.3598 - val_loss: 3.3056 - val_accuracy200: 0.3416 - 25s/epoch - 33ms/step
testing model: results/PCAR/W0/deepOF_L1/h200
Evaluating performance on  test set...
1733/1733 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012365
{'0': {'precision': 0.32079213760662967, 'recall': 0.6364041919890008, 'f1-score': 0.4265654909400176, 'support': 136737}, '1': {'precision': 0.4130948363145461, 'recall': 0.0526775284352905, 'f1-score': 0.09343969987622075, 'support': 162650}, '2': {'precision': 0.34756435643564354, 'recall': 0.36536219816819315, 'f1-score': 0.35624112035721534, 'support': 144120}, 'accuracy': 0.3342540253028701, 'macro avg': {'precision': 0.3604837767856064, 'recall': 0.3514813061974948, 'f1-score': 0.29208210372448457, 'support': 443507}, 'weighted avg': {'precision': 0.36334264103155883, 'recall': 0.3342540253028701, 'f1-score': 0.28154397334295594, 'support': 443507}}
[[87020  6291 43426]
 [98664  8568 55418]
 [85582  5882 52656]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0960168
{'0': {'precision': 0.3432934244557491, 'recall': 0.628675836326281, 'f1-score': 0.44408869587374744, 'support': 63761}, '1': {'precision': 0.41716287215411557, 'recall': 0.05534386617100372, 'f1-score': 0.09772307692307693, 'support': 64560}, '2': {'precision': 0.3715729842545398, 'recall': 0.3880462019779666, 'f1-score': 0.37963097275813046, 'support': 67443}, 'accuracy': 0.3566999039659999, 'macro avg': {'precision': 0.3773430936214681, 'recall': 0.3573553014917505, 'f1-score': 0.3071475818516516, 'support': 195764}, 'weighted avg': {'precision': 0.3773970895571793, 'recall': 0.3566999039659999, 'f1-score': 0.3076561210410824, 'support': 195764}}
[[40085  2356 21320]
 [38045  3573 22942]
 [38636  2636 26171]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001614
{'0': {'precision': 0.33725413636585483, 'recall': 0.6566568469067756, 'f1-score': 0.4456339481491035, 'support': 21046}, '1': {'precision': 0.38844899860270143, 'recall': 0.03732211581491095, 'f1-score': 0.06810109010737762, 'support': 22346}, '2': {'precision': 0.34529708701894135, 'recall': 0.349620181937541, 'f1-score': 0.3474451874461194, 'support': 21326}, 'accuracy': 0.3416360208906332, 'macro avg': {'precision': 0.35700007399583256, 'recall': 0.34786638155307587, 'f1-score': 0.2870600752342002, 'support': 64718}, 'weighted avg': {'precision': 0.35758116064306206, 'recall': 0.3416360208906332, 'f1-score': 0.28292306776725845, 'support': 64718}}
[[13820   659  6567]
 [13942   834  7570]
 [13216   654  7456]]
training model: results/PCAR/W0/deepOF_L1/h300
Epoch 1/50
765/765 - 33s - loss: 3.3345 - accuracy300: 0.3413 - val_loss: 3.3709 - val_accuracy300: 0.3355 - 33s/epoch - 43ms/step
Epoch 2/50
765/765 - 26s - loss: 3.3109 - accuracy300: 0.3450 - val_loss: 3.3438 - val_accuracy300: 0.3354 - 26s/epoch - 35ms/step
Epoch 3/50
765/765 - 24s - loss: 3.3029 - accuracy300: 0.3470 - val_loss: 3.3276 - val_accuracy300: 0.3356 - 24s/epoch - 32ms/step
Epoch 4/50
765/765 - 25s - loss: 3.2981 - accuracy300: 0.3487 - val_loss: 3.3181 - val_accuracy300: 0.3385 - 25s/epoch - 33ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2953 - accuracy300: 0.3511 - val_loss: 3.3142 - val_accuracy300: 0.3376 - 25s/epoch - 33ms/step
Epoch 6/50
765/765 - 25s - loss: 3.2937 - accuracy300: 0.3539 - val_loss: 3.3111 - val_accuracy300: 0.3377 - 25s/epoch - 33ms/step
Epoch 7/50
765/765 - 27s - loss: 3.2919 - accuracy300: 0.3551 - val_loss: 3.3092 - val_accuracy300: 0.3396 - 27s/epoch - 35ms/step
Epoch 8/50
765/765 - 25s - loss: 3.2910 - accuracy300: 0.3571 - val_loss: 3.3084 - val_accuracy300: 0.3385 - 25s/epoch - 32ms/step
Epoch 9/50
765/765 - 24s - loss: 3.2901 - accuracy300: 0.3584 - val_loss: 3.3079 - val_accuracy300: 0.3386 - 24s/epoch - 31ms/step
Epoch 10/50
765/765 - 27s - loss: 3.2892 - accuracy300: 0.3591 - val_loss: 3.3082 - val_accuracy300: 0.3408 - 27s/epoch - 35ms/step
Epoch 11/50
765/765 - 26s - loss: 3.2880 - accuracy300: 0.3607 - val_loss: 3.3078 - val_accuracy300: 0.3400 - 26s/epoch - 34ms/step
Epoch 12/50
765/765 - 24s - loss: 3.2869 - accuracy300: 0.3609 - val_loss: 3.3085 - val_accuracy300: 0.3396 - 24s/epoch - 31ms/step
Epoch 13/50
765/765 - 27s - loss: 3.2864 - accuracy300: 0.3627 - val_loss: 3.3096 - val_accuracy300: 0.3402 - 27s/epoch - 35ms/step
Epoch 14/50
765/765 - 26s - loss: 3.2855 - accuracy300: 0.3629 - val_loss: 3.3106 - val_accuracy300: 0.3365 - 26s/epoch - 34ms/step
Epoch 15/50
765/765 - 26s - loss: 3.2846 - accuracy300: 0.3646 - val_loss: 3.3105 - val_accuracy300: 0.3396 - 26s/epoch - 34ms/step
Epoch 16/50
765/765 - 28s - loss: 3.2838 - accuracy300: 0.3654 - val_loss: 3.3118 - val_accuracy300: 0.3404 - 28s/epoch - 36ms/step
Epoch 17/50
765/765 - 27s - loss: 3.2829 - accuracy300: 0.3673 - val_loss: 3.3118 - val_accuracy300: 0.3389 - 27s/epoch - 36ms/step
Epoch 18/50
765/765 - 26s - loss: 3.2815 - accuracy300: 0.3678 - val_loss: 3.3139 - val_accuracy300: 0.3405 - 26s/epoch - 34ms/step
Epoch 19/50
765/765 - 24s - loss: 3.2810 - accuracy300: 0.3683 - val_loss: 3.3127 - val_accuracy300: 0.3421 - 24s/epoch - 32ms/step
Epoch 20/50
765/765 - 26s - loss: 3.2791 - accuracy300: 0.3690 - val_loss: 3.3145 - val_accuracy300: 0.3401 - 26s/epoch - 34ms/step
Epoch 21/50
765/765 - 25s - loss: 3.2792 - accuracy300: 0.3695 - val_loss: 3.3142 - val_accuracy300: 0.3386 - 25s/epoch - 32ms/step
testing model: results/PCAR/W0/deepOF_L1/h300
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991457
{'0': {'precision': 0.34202313693839115, 'recall': 0.6021123425215497, 'f1-score': 0.4362432228398874, 'support': 147798}, '1': {'precision': 0.33661614954343355, 'recall': 0.05048180332100146, 'f1-score': 0.08779684898966912, 'support': 139476}, '2': {'precision': 0.3671243842364532, 'recall': 0.38161591981207554, 'f1-score': 0.37422991341135414, 'support': 156233}, 'accuracy': 0.3509595113493135, 'macro avg': {'precision': 0.34858789023942593, 'recall': 0.3447366885515422, 'f1-score': 0.2994233284136369, 'support': 443507}, 'weighted avg': {'precision': 0.34916507200417146, 'recall': 0.3509595113493135, 'f1-score': 0.3048170405900445, 'support': 443507}}
[[88991  7182 51625]
 [81281  7041 51154]
 [89918  6694 59621]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968006
{'0': {'precision': 0.34239532997072414, 'recall': 0.6117597012809, 'f1-score': 0.4390558303886926, 'support': 63471}, '1': {'precision': 0.42958338335934687, 'recall': 0.055342448802821256, 'f1-score': 0.09805291788273661, 'support': 64652}, '2': {'precision': 0.370398886952763, 'recall': 0.40539022190683166, 'f1-score': 0.38710542661923314, 'support': 67641}, 'accuracy': 0.35669479577450397, 'macro avg': {'precision': 0.3807925334276114, 'recall': 0.3574974573301843, 'f1-score': 0.30807139163022074, 'support': 195764}, 'weighted avg': {'precision': 0.380865480894813, 'recall': 0.35669479577450397, 'f1-score': 0.30848791411856596, 'support': 195764}}
[[38829  2240 22402]
 [36866  3578 24208]
 [37709  2511 27421]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024966
{'0': {'precision': 0.33332492877133707, 'recall': 0.6271644764931923, 'f1-score': 0.43529799143891995, 'support': 21079}, '1': {'precision': 0.3808125305922663, 'recall': 0.03543127789416158, 'f1-score': 0.06483063205699763, 'support': 21958}, '2': {'precision': 0.3453115494916138, 'recall': 0.3665421336654213, 'f1-score': 0.3556102472312339, 'support': 21681}, 'accuracy': 0.33908649834667326, 'macro avg': {'precision': 0.35314966961840577, 'recall': 0.3430459626842584, 'f1-score': 0.28524629024238385, 'support': 64718}, 'weighted avg': {'precision': 0.3534524772836564, 'recall': 0.33908649834667326, 'f1-score': 0.2829071224461345, 'support': 64718}}
[[13220   607  7252]
 [13365   778  7815]
 [13076   658  7947]]
training model: results/PCAR/W0/deepOF_L1/h500
Epoch 1/50
765/765 - 31s - loss: 3.3381 - accuracy500: 0.3367 - val_loss: 3.3420 - val_accuracy500: 0.3300 - 31s/epoch - 40ms/step
Epoch 2/50
765/765 - 27s - loss: 3.3156 - accuracy500: 0.3381 - val_loss: 3.3248 - val_accuracy500: 0.3319 - 27s/epoch - 35ms/step
Epoch 3/50
765/765 - 29s - loss: 3.3067 - accuracy500: 0.3398 - val_loss: 3.3145 - val_accuracy500: 0.3297 - 29s/epoch - 38ms/step
Epoch 4/50
765/765 - 26s - loss: 3.3009 - accuracy500: 0.3427 - val_loss: 3.3096 - val_accuracy500: 0.3324 - 26s/epoch - 34ms/step
Epoch 5/50
765/765 - 25s - loss: 3.2983 - accuracy500: 0.3452 - val_loss: 3.3070 - val_accuracy500: 0.3336 - 25s/epoch - 32ms/step
Epoch 6/50
765/765 - 25s - loss: 3.2966 - accuracy500: 0.3459 - val_loss: 3.3050 - val_accuracy500: 0.3344 - 25s/epoch - 33ms/step
Epoch 7/50
765/765 - 25s - loss: 3.2950 - accuracy500: 0.3480 - val_loss: 3.3042 - val_accuracy500: 0.3345 - 25s/epoch - 33ms/step
Epoch 8/50
765/765 - 25s - loss: 3.2942 - accuracy500: 0.3479 - val_loss: 3.3046 - val_accuracy500: 0.3312 - 25s/epoch - 32ms/step
Epoch 9/50
765/765 - 24s - loss: 3.2938 - accuracy500: 0.3491 - val_loss: 3.3033 - val_accuracy500: 0.3342 - 24s/epoch - 31ms/step
Epoch 10/50
765/765 - 28s - loss: 3.2920 - accuracy500: 0.3523 - val_loss: 3.3033 - val_accuracy500: 0.3360 - 28s/epoch - 37ms/step
Epoch 11/50
765/765 - 29s - loss: 3.2915 - accuracy500: 0.3516 - val_loss: 3.3045 - val_accuracy500: 0.3343 - 29s/epoch - 38ms/step
Epoch 12/50
765/765 - 25s - loss: 3.2908 - accuracy500: 0.3537 - val_loss: 3.3039 - val_accuracy500: 0.3337 - 25s/epoch - 33ms/step
Epoch 13/50
765/765 - 28s - loss: 3.2898 - accuracy500: 0.3557 - val_loss: 3.3047 - val_accuracy500: 0.3351 - 28s/epoch - 36ms/step
Epoch 14/50
765/765 - 27s - loss: 3.2890 - accuracy500: 0.3560 - val_loss: 3.3045 - val_accuracy500: 0.3354 - 27s/epoch - 36ms/step
Epoch 15/50
765/765 - 27s - loss: 3.2883 - accuracy500: 0.3572 - val_loss: 3.3041 - val_accuracy500: 0.3350 - 27s/epoch - 35ms/step
Epoch 16/50
765/765 - 25s - loss: 3.2869 - accuracy500: 0.3595 - val_loss: 3.3067 - val_accuracy500: 0.3345 - 25s/epoch - 33ms/step
Epoch 17/50
765/765 - 26s - loss: 3.2866 - accuracy500: 0.3590 - val_loss: 3.3053 - val_accuracy500: 0.3349 - 26s/epoch - 34ms/step
Epoch 18/50
765/765 - 26s - loss: 3.2859 - accuracy500: 0.3615 - val_loss: 3.3059 - val_accuracy500: 0.3349 - 26s/epoch - 34ms/step
Epoch 19/50
765/765 - 24s - loss: 3.2852 - accuracy500: 0.3607 - val_loss: 3.3077 - val_accuracy500: 0.3330 - 24s/epoch - 32ms/step
testing model: results/PCAR/W0/deepOF_L1/h500
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993359
{'0': {'precision': 0.33041889679106484, 'recall': 0.37572342687222526, 'f1-score': 0.35161784259479, 'support': 143933}, '1': {'precision': 0.3348629937133611, 'recall': 0.08666163245692318, 'f1-score': 0.13768957675506763, 'support': 145670}, '2': {'precision': 0.353440158585942, 'recall': 0.556073916207506, 'f1-score': 0.4321843027542394, 'support': 153904}, 'accuracy': 0.34336549366751823, 'macro avg': {'precision': 0.339574016363456, 'recall': 0.33948632517888483, 'f1-score': 0.30716390736803234, 'support': 443507}, 'weighted avg': {'precision': 0.33986730656576886, 'recall': 0.34336549366751823, 'f1-score': 0.30931088915213306, 'support': 443507}}
[[54079 12946 76908]
 [53396 12624 79650]
 [56193 12129 85582]]
Evaluating performance on  train set...
765/765 - 12s - 12s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962652
{'0': {'precision': 0.33542802087976875, 'recall': 0.378724164244776, 'f1-score': 0.3557636579934722, 'support': 61591}, '1': {'precision': 0.39620418036345595, 'recall': 0.09633539435982506, 'f1-score': 0.15498647386362258, 'support': 66310}, '2': {'precision': 0.360299727520436, 'recall': 0.5845453339816984, 'f1-score': 0.4458117698622747, 'support': 67863}, 'accuracy': 0.3544216505588362, 'macro avg': {'precision': 0.3639773095878869, 'recall': 0.3532016308620998, 'f1-score': 0.31885396723978987, 'support': 195764}, 'weighted avg': {'precision': 0.3646363317189368, 'recall': 0.3544216505588362, 'f1-score': 0.31897139759882465, 'support': 195764}}
[[23326  4714 33551]
 [23042  6388 36880]
 [23173  5021 39669]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1001295
{'0': {'precision': 0.3281935713438501, 'recall': 0.40091765274088387, 'f1-score': 0.3609287360320014, 'support': 20705}, '1': {'precision': 0.3596001859600186, 'recall': 0.06870059507949196, 'f1-score': 0.11536167039522743, 'support': 22518}, '2': {'precision': 0.3347948637644848, 'recall': 0.5470574552221447, 'f1-score': 0.4153802677593698, 'support': 21495}, 'accuracy': 0.33386384004450076, 'macro avg': {'precision': 0.3408628736894512, 'recall': 0.3388919010141735, 'f1-score': 0.2972235580621995, 'support': 64718}, 'weighted avg': {'precision': 0.3413137068317889, 'recall': 0.33386384004450076, 'f1-score': 0.293571223291665, 'support': 64718}}
[[ 8301  1307 11097]
 [ 8704  1547 12267]
 [ 8288  1448 11759]]
training model: results/PCAR/W0/deepOF_L1/h1000
Epoch 1/50
765/765 - 29s - loss: 3.3438 - accuracy1000: 0.3354 - val_loss: 3.3867 - val_accuracy1000: 0.3329 - 29s/epoch - 38ms/step
Epoch 2/50
765/765 - 25s - loss: 3.3192 - accuracy1000: 0.3385 - val_loss: 3.3477 - val_accuracy1000: 0.3332 - 25s/epoch - 33ms/step
Epoch 3/50
765/765 - 24s - loss: 3.3103 - accuracy1000: 0.3380 - val_loss: 3.3294 - val_accuracy1000: 0.3349 - 24s/epoch - 31ms/step
Epoch 4/50
765/765 - 27s - loss: 3.3045 - accuracy1000: 0.3401 - val_loss: 3.3231 - val_accuracy1000: 0.3350 - 27s/epoch - 35ms/step
Epoch 5/50
765/765 - 26s - loss: 3.3015 - accuracy1000: 0.3436 - val_loss: 3.3174 - val_accuracy1000: 0.3359 - 26s/epoch - 34ms/step
Epoch 6/50
765/765 - 25s - loss: 3.2993 - accuracy1000: 0.3445 - val_loss: 3.3163 - val_accuracy1000: 0.3342 - 25s/epoch - 33ms/step
Epoch 7/50
765/765 - 27s - loss: 3.2984 - accuracy1000: 0.3457 - val_loss: 3.3141 - val_accuracy1000: 0.3342 - 27s/epoch - 35ms/step
Epoch 8/50
765/765 - 25s - loss: 3.2969 - accuracy1000: 0.3479 - val_loss: 3.3138 - val_accuracy1000: 0.3357 - 25s/epoch - 33ms/step
Epoch 9/50
765/765 - 24s - loss: 3.2962 - accuracy1000: 0.3492 - val_loss: 3.3131 - val_accuracy1000: 0.3348 - 24s/epoch - 31ms/step
Epoch 10/50
765/765 - 24s - loss: 3.2951 - accuracy1000: 0.3504 - val_loss: 3.3129 - val_accuracy1000: 0.3368 - 24s/epoch - 31ms/step
Epoch 11/50
765/765 - 25s - loss: 3.2954 - accuracy1000: 0.3494 - val_loss: 3.3118 - val_accuracy1000: 0.3364 - 25s/epoch - 33ms/step
Epoch 12/50
765/765 - 26s - loss: 3.2945 - accuracy1000: 0.3505 - val_loss: 3.3126 - val_accuracy1000: 0.3372 - 26s/epoch - 35ms/step
Epoch 13/50
765/765 - 27s - loss: 3.2936 - accuracy1000: 0.3520 - val_loss: 3.3135 - val_accuracy1000: 0.3361 - 27s/epoch - 35ms/step
Epoch 14/50
765/765 - 25s - loss: 3.2932 - accuracy1000: 0.3514 - val_loss: 3.3135 - val_accuracy1000: 0.3367 - 25s/epoch - 33ms/step
Epoch 15/50
765/765 - 28s - loss: 3.2923 - accuracy1000: 0.3540 - val_loss: 3.3137 - val_accuracy1000: 0.3372 - 28s/epoch - 37ms/step
Epoch 16/50
765/765 - 25s - loss: 3.2923 - accuracy1000: 0.3540 - val_loss: 3.3138 - val_accuracy1000: 0.3367 - 25s/epoch - 32ms/step
Epoch 17/50
765/765 - 26s - loss: 3.2918 - accuracy1000: 0.3553 - val_loss: 3.3122 - val_accuracy1000: 0.3382 - 26s/epoch - 33ms/step
Epoch 18/50
765/765 - 25s - loss: 3.2910 - accuracy1000: 0.3553 - val_loss: 3.3138 - val_accuracy1000: 0.3362 - 25s/epoch - 33ms/step
Epoch 19/50
765/765 - 25s - loss: 3.2903 - accuracy1000: 0.3561 - val_loss: 3.3144 - val_accuracy1000: 0.3362 - 25s/epoch - 33ms/step
Epoch 20/50
765/765 - 26s - loss: 3.2894 - accuracy1000: 0.3576 - val_loss: 3.3156 - val_accuracy1000: 0.3383 - 26s/epoch - 34ms/step
Epoch 21/50
765/765 - 26s - loss: 3.2890 - accuracy1000: 0.3571 - val_loss: 3.3150 - val_accuracy1000: 0.3368 - 26s/epoch - 34ms/step
testing model: results/PCAR/W0/deepOF_L1/h1000
Evaluating performance on  test set...
1733/1733 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0987895
{'0': {'precision': 0.3278448662673872, 'recall': 0.11954897915629224, 'f1-score': 0.1752081280723978, 'support': 140570}, '1': {'precision': 0.3173309693477446, 'recall': 0.0636767925561029, 'f1-score': 0.10606932628255902, 'support': 146160}, '2': {'precision': 0.3569832386841141, 'recall': 0.8263712151654898, 'f1-score': 0.4985837874449678, 'support': 156777}, 'accuracy': 0.35099333268696997, 'macro avg': {'precision': 0.3340530247664153, 'recall': 0.33653232895929497, 'f1-score': 0.25995374726664155, 'support': 443507}, 'weighted avg': {'precision': 0.3346801934180347, 'recall': 0.35099333268696997, 'f1-score': 0.2667343914230339, 'support': 443507}}
[[ 16805  10164 113601]
 [ 17091   9307 119762]
 [ 17363   9858 129556]]
Evaluating performance on  train set...
765/765 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959927
{'0': {'precision': 0.330720762256032, 'recall': 0.10644507097986843, 'f1-score': 0.16105373447088758, 'support': 60651}, '1': {'precision': 0.38416607467045544, 'recall': 0.07381847964569556, 'f1-score': 0.12384066360478874, 'support': 65932}, '2': {'precision': 0.3595070121168401, 'recall': 0.8500310778971105, 'f1-score': 0.505303860282271, 'support': 69181}, 'accuracy': 0.3582323614147647, 'macro avg': {'precision': 0.35813128301444247, 'recall': 0.34343154284089145, 'f1-score': 0.2633994194526491, 'support': 195764}, 'weighted avg': {'precision': 0.3588935513782829, 'recall': 0.3582323614147647, 'f1-score': 0.2701751039025179, 'support': 195764}}
[[ 6456  3845 50350]
 [ 6647  4867 54418]
 [ 6418  3957 58806]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000608
{'0': {'precision': 0.3326729871232489, 'recall': 0.11293111730233452, 'f1-score': 0.1686211224672763, 'support': 20818}, '1': {'precision': 0.3545994065281899, 'recall': 0.06403786897691242, 'f1-score': 0.1084843212164769, 'support': 22393}, '2': {'precision': 0.334508552987483, 'recall': 0.8337750499837262, 'f1-score': 0.47746092605905693, 'support': 21507}, 'accuracy': 0.33556352174047405, 'macro avg': {'precision': 0.3405936488796406, 'recall': 0.3369146787543244, 'f1-score': 0.2515221232476034, 'support': 64718}, 'weighted avg': {'precision': 0.340869714846246, 'recall': 0.33556352174047405, 'f1-score': 0.2504464920003162, 'support': 64718}}
[[ 2351  1324 17143]
 [ 2427  1434 18532]
 [ 2289  1286 17932]]
training model: results/PCAR/W0/deepLOB_L2/h10
Epoch 1/50
765/765 - 49s - loss: 3.2676 - accuracy10: 0.3907 - val_loss: 3.2550 - val_accuracy10: 0.3983 - 49s/epoch - 63ms/step
Epoch 2/50
765/765 - 46s - loss: 3.1438 - accuracy10: 0.4443 - val_loss: 3.1901 - val_accuracy10: 0.4312 - 46s/epoch - 60ms/step
Epoch 3/50
765/765 - 43s - loss: 3.0839 - accuracy10: 0.4671 - val_loss: 3.1856 - val_accuracy10: 0.4315 - 43s/epoch - 57ms/step
Epoch 4/50
765/765 - 43s - loss: 3.0627 - accuracy10: 0.4744 - val_loss: 3.1812 - val_accuracy10: 0.4334 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 45s - loss: 3.0489 - accuracy10: 0.4795 - val_loss: 3.1579 - val_accuracy10: 0.4428 - 45s/epoch - 59ms/step
Epoch 6/50
765/765 - 43s - loss: 3.0371 - accuracy10: 0.4834 - val_loss: 3.1473 - val_accuracy10: 0.4464 - 43s/epoch - 56ms/step
Epoch 7/50
765/765 - 46s - loss: 3.0278 - accuracy10: 0.4877 - val_loss: 3.1428 - val_accuracy10: 0.4492 - 46s/epoch - 61ms/step
Epoch 8/50
765/765 - 44s - loss: 3.0187 - accuracy10: 0.4902 - val_loss: 3.1337 - val_accuracy10: 0.4530 - 44s/epoch - 57ms/step
Epoch 9/50
765/765 - 44s - loss: 3.0101 - accuracy10: 0.4921 - val_loss: 3.1101 - val_accuracy10: 0.4616 - 44s/epoch - 57ms/step
Epoch 10/50
765/765 - 42s - loss: 3.0024 - accuracy10: 0.4947 - val_loss: 3.1230 - val_accuracy10: 0.4578 - 42s/epoch - 55ms/step
Epoch 11/50
765/765 - 43s - loss: 2.9945 - accuracy10: 0.4980 - val_loss: 3.1328 - val_accuracy10: 0.4552 - 43s/epoch - 56ms/step
Epoch 12/50
765/765 - 44s - loss: 2.9875 - accuracy10: 0.4994 - val_loss: 3.1275 - val_accuracy10: 0.4576 - 44s/epoch - 58ms/step
Epoch 13/50
765/765 - 43s - loss: 2.9810 - accuracy10: 0.5017 - val_loss: 3.1340 - val_accuracy10: 0.4582 - 43s/epoch - 57ms/step
Epoch 14/50
765/765 - 43s - loss: 2.9746 - accuracy10: 0.5029 - val_loss: 3.1498 - val_accuracy10: 0.4549 - 43s/epoch - 56ms/step
Epoch 15/50
765/765 - 44s - loss: 2.9683 - accuracy10: 0.5043 - val_loss: 3.1418 - val_accuracy10: 0.4541 - 44s/epoch - 58ms/step
Epoch 16/50
765/765 - 43s - loss: 2.9623 - accuracy10: 0.5072 - val_loss: 3.1286 - val_accuracy10: 0.4562 - 43s/epoch - 56ms/step
Epoch 17/50
765/765 - 43s - loss: 2.9554 - accuracy10: 0.5090 - val_loss: 3.1332 - val_accuracy10: 0.4564 - 43s/epoch - 56ms/step
Epoch 18/50
765/765 - 42s - loss: 2.9504 - accuracy10: 0.5098 - val_loss: 3.1564 - val_accuracy10: 0.4510 - 42s/epoch - 54ms/step
Epoch 19/50
765/765 - 42s - loss: 2.9441 - accuracy10: 0.5119 - val_loss: 3.1545 - val_accuracy10: 0.4535 - 42s/epoch - 54ms/step
testing model: results/PCAR/W0/deepLOB_L2/h10
Evaluating performance on  test set...
1733/1733 - 37s - 37s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.072066
{'0': {'precision': 0.4371226718047527, 'recall': 0.4952802727877578, 'f1-score': 0.46438771432191905, 'support': 144288}, '1': {'precision': 0.4390945108263298, 'recall': 0.36348758207437065, 'f1-score': 0.39772978603483095, 'support': 153367}, '2': {'precision': 0.4402487783207463, 'recall': 0.46201416455843736, 'f1-score': 0.45086894706029934, 'support': 145857}, 'accuracy': 0.4387660311333177, 'macro avg': {'precision': 0.4388219869839429, 'recall': 0.44026067314018863, 'f1-score': 0.43766214913901647, 'support': 443512}, 'weighted avg': {'precision': 0.43883261325690165, 'recall': 0.4387660311333177, 'f1-score': 0.43689142713220624, 'support': 443512}}
[[71463 33312 39513]
 [51453 55747 46167]
 [40569 37900 67388]]
Evaluating performance on  train set...
765/765 - 18s - 18s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0317503
{'0': {'precision': 0.4726025115752307, 'recall': 0.43495455172519504, 'f1-score': 0.45299766125749313, 'support': 65239}, '1': {'precision': 0.48622164373373, 'recall': 0.40557434004404874, 'f1-score': 0.4422514248989463, 'support': 64474}, '2': {'precision': 0.4467672255985941, 'recall': 0.5542535313621293, 'f1-score': 0.4947396160629219, 'support': 66051}, 'accuracy': 0.4655299237857829, 'macro avg': {'precision': 0.46853046030251827, 'recall': 0.46492747437712434, 'f1-score': 0.46332956740645376, 'support': 195764}, 'weighted avg': {'precision': 0.4683710566230651, 'recall': 0.4655299237857829, 'f1-score': 0.46354222008277474, 'support': 195764}}
[[28376 14743 22120]
 [15112 26149 23213]
 [16554 12888 36609]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.035124
{'0': {'precision': 0.4596206240682671, 'recall': 0.4164027570789866, 'f1-score': 0.4369456322541234, 'support': 21472}, '1': {'precision': 0.5628140703517588, 'recall': 0.2713925975198366, 'f1-score': 0.3662007949737146, 'support': 21047}, '2': {'precision': 0.4296901697232031, 'recall': 0.6797153024911032, 'f1-score': 0.5265288318939196, 'support': 22199}, 'accuracy': 0.45956302728761705, 'macro avg': {'precision': 0.48404162138107637, 'recall': 0.4558368856966421, 'f1-score': 0.4432250863739193, 'support': 64718}, 'weighted avg': {'precision': 0.4829137775637795, 'recall': 0.45956302728761705, 'f1-score': 0.44466668139907645, 'support': 64718}}
[[ 8941  2258 10273]
 [ 5581  5712  9754]
 [ 4931  2179 15089]]
training model: results/PCAR/W0/deepLOB_L2/h20
Epoch 1/50
765/765 - 52s - loss: 3.2819 - accuracy20: 0.3831 - val_loss: 3.3189 - val_accuracy20: 0.3660 - 52s/epoch - 68ms/step
Epoch 2/50
765/765 - 48s - loss: 3.1995 - accuracy20: 0.4209 - val_loss: 3.2255 - val_accuracy20: 0.4136 - 48s/epoch - 63ms/step
Epoch 3/50
765/765 - 44s - loss: 3.1633 - accuracy20: 0.4390 - val_loss: 3.2241 - val_accuracy20: 0.4172 - 44s/epoch - 58ms/step
Epoch 4/50
765/765 - 45s - loss: 3.1470 - accuracy20: 0.4445 - val_loss: 3.2073 - val_accuracy20: 0.4203 - 45s/epoch - 59ms/step
Epoch 5/50
765/765 - 46s - loss: 3.1352 - accuracy20: 0.4506 - val_loss: 3.2068 - val_accuracy20: 0.4242 - 46s/epoch - 60ms/step
Epoch 6/50
765/765 - 44s - loss: 3.1249 - accuracy20: 0.4543 - val_loss: 3.2029 - val_accuracy20: 0.4262 - 44s/epoch - 57ms/step
Epoch 7/50
765/765 - 43s - loss: 3.1184 - accuracy20: 0.4550 - val_loss: 3.2141 - val_accuracy20: 0.4226 - 43s/epoch - 57ms/step
Epoch 8/50
765/765 - 44s - loss: 3.1122 - accuracy20: 0.4580 - val_loss: 3.2035 - val_accuracy20: 0.4257 - 44s/epoch - 57ms/step
Epoch 9/50
765/765 - 43s - loss: 3.1041 - accuracy20: 0.4607 - val_loss: 3.2130 - val_accuracy20: 0.4234 - 43s/epoch - 56ms/step
Epoch 10/50
765/765 - 44s - loss: 3.0995 - accuracy20: 0.4625 - val_loss: 3.2064 - val_accuracy20: 0.4254 - 44s/epoch - 58ms/step
Epoch 11/50
765/765 - 45s - loss: 3.0927 - accuracy20: 0.4653 - val_loss: 3.2010 - val_accuracy20: 0.4283 - 45s/epoch - 58ms/step
Epoch 12/50
765/765 - 42s - loss: 3.0875 - accuracy20: 0.4684 - val_loss: 3.2112 - val_accuracy20: 0.4250 - 42s/epoch - 55ms/step
Epoch 13/50
765/765 - 44s - loss: 3.0830 - accuracy20: 0.4693 - val_loss: 3.1955 - val_accuracy20: 0.4315 - 44s/epoch - 57ms/step
Epoch 14/50
765/765 - 44s - loss: 3.0774 - accuracy20: 0.4713 - val_loss: 3.1847 - val_accuracy20: 0.4344 - 44s/epoch - 57ms/step
Epoch 15/50
765/765 - 43s - loss: 3.0712 - accuracy20: 0.4728 - val_loss: 3.1977 - val_accuracy20: 0.4332 - 43s/epoch - 57ms/step
Epoch 16/50
765/765 - 43s - loss: 3.0652 - accuracy20: 0.4751 - val_loss: 3.2144 - val_accuracy20: 0.4279 - 43s/epoch - 56ms/step
Epoch 17/50
765/765 - 43s - loss: 3.0589 - accuracy20: 0.4779 - val_loss: 3.2105 - val_accuracy20: 0.4299 - 43s/epoch - 56ms/step
Epoch 18/50
765/765 - 45s - loss: 3.0522 - accuracy20: 0.4807 - val_loss: 3.2237 - val_accuracy20: 0.4264 - 45s/epoch - 59ms/step
Epoch 19/50
765/765 - 44s - loss: 3.0489 - accuracy20: 0.4819 - val_loss: 3.2103 - val_accuracy20: 0.4269 - 44s/epoch - 58ms/step
Epoch 20/50
765/765 - 44s - loss: 3.0416 - accuracy20: 0.4841 - val_loss: 3.2364 - val_accuracy20: 0.4250 - 44s/epoch - 58ms/step
Epoch 21/50
765/765 - 45s - loss: 3.0376 - accuracy20: 0.4846 - val_loss: 3.2351 - val_accuracy20: 0.4252 - 45s/epoch - 58ms/step
Epoch 22/50
765/765 - 44s - loss: 3.0314 - accuracy20: 0.4872 - val_loss: 3.2360 - val_accuracy20: 0.4242 - 44s/epoch - 57ms/step
Epoch 23/50
765/765 - 44s - loss: 3.0276 - accuracy20: 0.4890 - val_loss: 3.2528 - val_accuracy20: 0.4236 - 44s/epoch - 58ms/step
Epoch 24/50
765/765 - 43s - loss: 3.0211 - accuracy20: 0.4903 - val_loss: 3.2204 - val_accuracy20: 0.4260 - 43s/epoch - 56ms/step
testing model: results/PCAR/W0/deepLOB_L2/h20
Evaluating performance on  test set...
1733/1733 - 37s - 37s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0808465
{'0': {'precision': 0.4052760488056985, 'recall': 0.5080956975540358, 'f1-score': 0.4508985909419033, 'support': 141989}, '1': {'precision': 0.4379826841445855, 'recall': 0.2978439314076438, 'f1-score': 0.3545685404059327, 'support': 157277}, '2': {'precision': 0.4205467183025747, 'recall': 0.462238120987757, 'f1-score': 0.4404079368015007, 'support': 144246}, 'accuracy': 0.41862226952145604, 'macro avg': {'precision': 0.4212684837509529, 'recall': 0.42272591664981224, 'f1-score': 0.41529168938311223, 'support': 443512}, 'weighted avg': {'precision': 0.4218409545544506, 'recall': 0.41862226952145604, 'f1-score': 0.4133263578224333, 'support': 443512}}
[[72144 28395 41450]
 [60013 46844 50420]
 [45855 31715 66676]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.059014
{'0': {'precision': 0.4355153450416888, 'recall': 0.3767301967283553, 'f1-score': 0.40399552395997895, 'support': 65166}, '1': {'precision': 0.4343446384931752, 'recall': 0.4539197059831189, 'f1-score': 0.44391648010234386, 'support': 64214}, '2': {'precision': 0.4369725811360429, 'recall': 0.4758224873463485, 'f1-score': 0.45557077954856856, 'support': 66384}, 'accuracy': 0.4356521117263644, 'macro avg': {'precision': 0.4356108548903023, 'recall': 0.43549079668594093, 'f1-score': 0.43449426120363044, 'support': 195764}, 'weighted avg': {'precision': 0.43562548485585967, 'recall': 0.4356521117263644, 'f1-score': 0.43457957437128414, 'support': 195764}}
[[24550 19715 20901]
 [15268 29148 19798]
 [16552 18245 31587]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0603955
{'0': {'precision': 0.42805069537909374, 'recall': 0.3559503823913449, 'f1-score': 0.3886852021590793, 'support': 21444}, '1': {'precision': 0.4876101528959855, 'recall': 0.3028205248140699, 'f1-score': 0.3736149584487535, 'support': 21379}, '2': {'precision': 0.41289535541075306, 'recall': 0.6337976707010733, 'f1-score': 0.5000360334390314, 'support': 21895}, 'accuracy': 0.4323990234556074, 'macro avg': {'precision': 0.4428520678952774, 'recall': 0.43085619263549607, 'f1-score': 0.42077873134895477, 'support': 64718}, 'weighted avg': {'precision': 0.4425983555918137, 'recall': 0.4323990234556074, 'f1-score': 0.4213784205927684, 'support': 64718}}
[[ 7633  3475 10336]
 [ 5509  6474  9396]
 [ 4690  3328 13877]]
training model: results/PCAR/W0/deepLOB_L2/h30
Epoch 1/50
765/765 - 53s - loss: 3.2954 - accuracy30: 0.3723 - val_loss: 3.3291 - val_accuracy30: 0.3507 - 53s/epoch - 70ms/step
Epoch 2/50
765/765 - 42s - loss: 3.2382 - accuracy30: 0.4005 - val_loss: 3.2573 - val_accuracy30: 0.3924 - 42s/epoch - 55ms/step
Epoch 3/50
765/765 - 45s - loss: 3.2050 - accuracy30: 0.4186 - val_loss: 3.2360 - val_accuracy30: 0.4042 - 45s/epoch - 58ms/step
Epoch 4/50
765/765 - 45s - loss: 3.1873 - accuracy30: 0.4265 - val_loss: 3.2358 - val_accuracy30: 0.4049 - 45s/epoch - 58ms/step
Epoch 5/50
765/765 - 43s - loss: 3.1795 - accuracy30: 0.4319 - val_loss: 3.2248 - val_accuracy30: 0.4080 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 45s - loss: 3.1714 - accuracy30: 0.4342 - val_loss: 3.2207 - val_accuracy30: 0.4080 - 45s/epoch - 58ms/step
Epoch 7/50
765/765 - 45s - loss: 3.1670 - accuracy30: 0.4351 - val_loss: 3.2222 - val_accuracy30: 0.4111 - 45s/epoch - 58ms/step
Epoch 8/50
765/765 - 44s - loss: 3.1607 - accuracy30: 0.4373 - val_loss: 3.2295 - val_accuracy30: 0.4088 - 44s/epoch - 57ms/step
Epoch 9/50
765/765 - 43s - loss: 3.1560 - accuracy30: 0.4411 - val_loss: 3.2276 - val_accuracy30: 0.4089 - 43s/epoch - 56ms/step
Epoch 10/50
765/765 - 44s - loss: 3.1511 - accuracy30: 0.4428 - val_loss: 3.2222 - val_accuracy30: 0.4112 - 44s/epoch - 57ms/step
Epoch 11/50
765/765 - 45s - loss: 3.1469 - accuracy30: 0.4439 - val_loss: 3.2187 - val_accuracy30: 0.4110 - 45s/epoch - 59ms/step
Epoch 12/50
765/765 - 43s - loss: 3.1433 - accuracy30: 0.4455 - val_loss: 3.2221 - val_accuracy30: 0.4128 - 43s/epoch - 56ms/step
Epoch 13/50
765/765 - 42s - loss: 3.1377 - accuracy30: 0.4485 - val_loss: 3.2276 - val_accuracy30: 0.4080 - 42s/epoch - 55ms/step
Epoch 14/50
765/765 - 42s - loss: 3.1344 - accuracy30: 0.4508 - val_loss: 3.2296 - val_accuracy30: 0.4110 - 42s/epoch - 55ms/step
Epoch 15/50
765/765 - 43s - loss: 3.1287 - accuracy30: 0.4522 - val_loss: 3.2287 - val_accuracy30: 0.4075 - 43s/epoch - 56ms/step
Epoch 16/50
765/765 - 45s - loss: 3.1238 - accuracy30: 0.4539 - val_loss: 3.2257 - val_accuracy30: 0.4093 - 45s/epoch - 59ms/step
Epoch 17/50
765/765 - 44s - loss: 3.1199 - accuracy30: 0.4560 - val_loss: 3.2252 - val_accuracy30: 0.4095 - 44s/epoch - 57ms/step
Epoch 18/50
765/765 - 47s - loss: 3.1153 - accuracy30: 0.4572 - val_loss: 3.2376 - val_accuracy30: 0.4078 - 47s/epoch - 61ms/step
Epoch 19/50
765/765 - 43s - loss: 3.1102 - accuracy30: 0.4601 - val_loss: 3.2408 - val_accuracy30: 0.4045 - 43s/epoch - 56ms/step
Epoch 20/50
765/765 - 43s - loss: 3.1063 - accuracy30: 0.4617 - val_loss: 3.2240 - val_accuracy30: 0.4102 - 43s/epoch - 56ms/step
Epoch 21/50
765/765 - 45s - loss: 3.1025 - accuracy30: 0.4627 - val_loss: 3.2491 - val_accuracy30: 0.4031 - 45s/epoch - 58ms/step
testing model: results/PCAR/W0/deepLOB_L2/h30
Evaluating performance on  test set...
1733/1733 - 44s - 44s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0857083
{'0': {'precision': 0.365762894615058, 'recall': 0.5420434539759752, 'f1-score': 0.43678783044667274, 'support': 141437}, '1': {'precision': 0.4439186531849841, 'recall': 0.2227832143789435, 'f1-score': 0.2966772084820634, 'support': 157063}, '2': {'precision': 0.40317630218072553, 'recall': 0.43118500537886517, 'f1-score': 0.4167105412232004, 'support': 145012}, 'accuracy': 0.39273570951856995, 'macro avg': {'precision': 0.4042859499935892, 'recall': 0.39867055791126127, 'f1-score': 0.38339186005064557, 'support': 443512}, 'weighted avg': {'precision': 0.40567336144838134, 'recall': 0.39273570951856995, 'f1-score': 0.38060526383629556, 'support': 443512}}
[[76665 21304 43468]
 [72981 34991 49091]
 [59957 22528 62527]]
Evaluating performance on  train set...
765/765 - 18s - 18s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0709703
{'0': {'precision': 0.4068676382511479, 'recall': 0.37771634206990284, 'f1-score': 0.39175043049937924, 'support': 64747}, '1': {'precision': 0.4230331033609722, 'recall': 0.4131802234826824, 'f1-score': 0.4180486164864463, 'support': 64703}, '2': {'precision': 0.4169334805409881, 'recall': 0.4555749917061254, 'f1-score': 0.43539856169023017, 'support': 66314}, 'accuracy': 0.4158118959563556, 'macro avg': {'precision': 0.41561140738436936, 'recall': 0.41549051908623685, 'f1-score': 0.4150658695586853, 'support': 195764}, 'weighted avg': {'precision': 0.41562032186309616, 'recall': 0.4158118959563556, 'f1-score': 0.41522795292286513, 'support': 195764}}
[[24456 18989 21302]
 [17022 26734 20947]
 [18630 17473 30211]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0715343
{'0': {'precision': 0.4116199848599546, 'recall': 0.30872959545777146, 'f1-score': 0.3528266688295888, 'support': 21135}, '1': {'precision': 0.4601542416452442, 'recall': 0.2841140991338261, 'f1-score': 0.3513149778500533, 'support': 22051}, '2': {'precision': 0.3901449604266546, 'recall': 0.6387237599851384, 'f1-score': 0.48440554391279084, 'support': 21532}, 'accuracy': 0.4101331932383572, 'macro avg': {'precision': 0.42063972897728447, 'recall': 0.41052248485891196, 'f1-score': 0.3961823968641443, 'support': 64718}, 'weighted avg': {'precision': 0.42101194181589585, 'recall': 0.4101331932383572, 'f1-score': 0.39608854404980215, 'support': 64718}}
[[ 6525  3768 10842]
 [ 5130  6265 10656]
 [ 4197  3582 13753]]
training model: results/PCAR/W0/deepLOB_L2/h50
Epoch 1/50
765/765 - 48s - loss: 3.2946 - accuracy50: 0.3770 - val_loss: 3.3954 - val_accuracy50: 0.3455 - 48s/epoch - 63ms/step
Epoch 2/50
765/765 - 44s - loss: 3.2462 - accuracy50: 0.4000 - val_loss: 3.3027 - val_accuracy50: 0.3635 - 44s/epoch - 58ms/step
Epoch 3/50
765/765 - 44s - loss: 3.2235 - accuracy50: 0.4131 - val_loss: 3.2789 - val_accuracy50: 0.3775 - 44s/epoch - 57ms/step
Epoch 4/50
765/765 - 44s - loss: 3.2118 - accuracy50: 0.4175 - val_loss: 3.2867 - val_accuracy50: 0.3758 - 44s/epoch - 58ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2035 - accuracy50: 0.4220 - val_loss: 3.2815 - val_accuracy50: 0.3822 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 45s - loss: 3.1954 - accuracy50: 0.4266 - val_loss: 3.2867 - val_accuracy50: 0.3825 - 45s/epoch - 58ms/step
Epoch 7/50
765/765 - 44s - loss: 3.1893 - accuracy50: 0.4294 - val_loss: 3.3037 - val_accuracy50: 0.3784 - 44s/epoch - 58ms/step
Epoch 8/50
765/765 - 43s - loss: 3.1836 - accuracy50: 0.4323 - val_loss: 3.3041 - val_accuracy50: 0.3792 - 43s/epoch - 56ms/step
Epoch 9/50
765/765 - 43s - loss: 3.1776 - accuracy50: 0.4334 - val_loss: 3.3180 - val_accuracy50: 0.3722 - 43s/epoch - 56ms/step
Epoch 10/50
765/765 - 46s - loss: 3.1728 - accuracy50: 0.4363 - val_loss: 3.3145 - val_accuracy50: 0.3733 - 46s/epoch - 60ms/step
Epoch 11/50
765/765 - 46s - loss: 3.1678 - accuracy50: 0.4386 - val_loss: 3.3048 - val_accuracy50: 0.3776 - 46s/epoch - 60ms/step
Epoch 12/50
765/765 - 42s - loss: 3.1626 - accuracy50: 0.4401 - val_loss: 3.3225 - val_accuracy50: 0.3735 - 42s/epoch - 55ms/step
Epoch 13/50
765/765 - 44s - loss: 3.1578 - accuracy50: 0.4425 - val_loss: 3.3251 - val_accuracy50: 0.3770 - 44s/epoch - 58ms/step
testing model: results/PCAR/W0/deepLOB_L2/h50
Evaluating performance on  test set...
1733/1733 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0902623
{'0': {'precision': 0.3376656453896459, 'recall': 0.33844143947982913, 'f1-score': 0.3380530973451327, 'support': 133187}, '1': {'precision': 0.4630023493688116, 'recall': 0.4072715969076141, 'f1-score': 0.4333525253886391, 'support': 173717}, '2': {'precision': 0.3582550950309137, 'recall': 0.41228917779339425, 'f1-score': 0.3833775781090463, 'support': 136608}, 'accuracy': 0.388147333104854, 'macro avg': {'precision': 0.3863076965964571, 'recall': 0.3860007380602792, 'f1-score': 0.3849277336142727, 'support': 443512}, 'weighted avg': {'precision': 0.3930999960763083, 'recall': 0.388147333104854, 'f1-score': 0.389341038617591, 'support': 443512}}
[[45076 40954 47157]
 [49234 70750 53733]
 [39183 41103 56322]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0869577
{'0': {'precision': 0.378947147562997, 'recall': 0.27905503538209575, 'f1-score': 0.3214187199131541, 'support': 64722}, '1': {'precision': 0.39743955893857175, 'recall': 0.49489748585211984, 'f1-score': 0.44084651566384536, 'support': 64674}, '2': {'precision': 0.3868432736421489, 'recall': 0.3938494455159113, 'f1-score': 0.3903149218295032, 'support': 66368}, 'accuracy': 0.38927994932674037, 'macro avg': {'precision': 0.3877433267145725, 'recall': 0.3892673222500423, 'f1-score': 0.38419338580216755, 'support': 195764}, 'weighted avg': {'precision': 0.3877333815433257, 'recall': 0.38927994932674037, 'f1-score': 0.3842309652246744, 'support': 195764}}
[[18061 24099 22562]
 [13798 32007 18869]
 [15802 24427 26139]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0923611
{'0': {'precision': 0.3694904657705533, 'recall': 0.22263031501624522, 'f1-score': 0.27784797108688625, 'support': 21237}, '1': {'precision': 0.39933505725895824, 'recall': 0.3420576801374198, 'f1-score': 0.36848384504881787, 'support': 22122}, '2': {'precision': 0.3672095350741516, 'recall': 0.5668804719322066, 'f1-score': 0.44570418905985426, 'support': 21359}, 'accuracy': 0.37706665842578574, 'macro avg': {'precision': 0.378678352701221, 'recall': 0.3771894890286238, 'f1-score': 0.36401200173185283, 'support': 64718}, 'weighted avg': {'precision': 0.3789392072978262, 'recall': 0.37706665842578574, 'f1-score': 0.3642271509668343, 'support': 64718}}
[[ 4728  5589 10920]
 [ 4610  7567  9945]
 [ 3458  5793 12108]]
training model: results/PCAR/W0/deepLOB_L2/h100
Epoch 1/50
765/765 - 47s - loss: 3.3077 - accuracy100: 0.3659 - val_loss: 3.3339 - val_accuracy100: 0.3348 - 47s/epoch - 61ms/step
Epoch 2/50
765/765 - 42s - loss: 3.2735 - accuracy100: 0.3778 - val_loss: 3.2983 - val_accuracy100: 0.3516 - 42s/epoch - 55ms/step
Epoch 3/50
765/765 - 44s - loss: 3.2509 - accuracy100: 0.3923 - val_loss: 3.3114 - val_accuracy100: 0.3455 - 44s/epoch - 57ms/step
Epoch 4/50
765/765 - 43s - loss: 3.2394 - accuracy100: 0.3978 - val_loss: 3.3096 - val_accuracy100: 0.3498 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2308 - accuracy100: 0.4036 - val_loss: 3.3216 - val_accuracy100: 0.3484 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 43s - loss: 3.2258 - accuracy100: 0.4066 - val_loss: 3.3292 - val_accuracy100: 0.3475 - 43s/epoch - 57ms/step
Epoch 7/50
765/765 - 43s - loss: 3.2201 - accuracy100: 0.4094 - val_loss: 3.3271 - val_accuracy100: 0.3491 - 43s/epoch - 57ms/step
Epoch 8/50
765/765 - 44s - loss: 3.2138 - accuracy100: 0.4126 - val_loss: 3.3345 - val_accuracy100: 0.3472 - 44s/epoch - 57ms/step
Epoch 9/50
765/765 - 45s - loss: 3.2095 - accuracy100: 0.4138 - val_loss: 3.3253 - val_accuracy100: 0.3502 - 45s/epoch - 59ms/step
Epoch 10/50
765/765 - 43s - loss: 3.2043 - accuracy100: 0.4179 - val_loss: 3.3181 - val_accuracy100: 0.3520 - 43s/epoch - 57ms/step
Epoch 11/50
765/765 - 43s - loss: 3.1974 - accuracy100: 0.4223 - val_loss: 3.3270 - val_accuracy100: 0.3507 - 43s/epoch - 56ms/step
Epoch 12/50
765/765 - 43s - loss: 3.1932 - accuracy100: 0.4231 - val_loss: 3.3413 - val_accuracy100: 0.3483 - 43s/epoch - 56ms/step
testing model: results/PCAR/W0/deepLOB_L2/h100
Evaluating performance on  test set...
1733/1733 - 38s - 38s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015109
{'0': {'precision': 0.32773882354164174, 'recall': 0.43938538726873627, 'f1-score': 0.3754376354585943, 'support': 143505}, '1': {'precision': 0.3864148376949998, 'recall': 0.18049810381685452, 'f1-score': 0.246059457752515, 'support': 151093}, '2': {'precision': 0.351570808224034, 'recall': 0.4262460211934405, 'f1-score': 0.3853237741988356, 'support': 148914}, 'accuracy': 0.346777539277404, 'macro avg': {'precision': 0.3552414898202252, 'recall': 0.34870983742634376, 'f1-score': 0.335606955803315, 'support': 443512}, 'weighted avg': {'precision': 0.3557300643050644, 'recall': 0.346777539277404, 'f1-score': 0.33468123531659066, 'support': 443512}}
[[63054 21047 59404]
 [66155 27272 57666]
 [63182 22258 63474]]
Evaluating performance on  train set...
765/765 - 18s - 18s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1006967
{'0': {'precision': 0.3503935624428983, 'recall': 0.3102085893387671, 'f1-score': 0.3290788333814612, 'support': 64289}, '1': {'precision': 0.37204749434288475, 'recall': 0.22656262096087448, 'f1-score': 0.2816258973421351, 'support': 64587}, '2': {'precision': 0.34324788729563793, 'recall': 0.5106895108240641, 'f1-score': 0.4105525675310237, 'support': 66888}, 'accuracy': 0.3511115424695041, 'macro avg': {'precision': 0.35522964802714035, 'recall': 0.3491535737079019, 'f1-score': 0.34041909941820664, 'support': 195764}, 'weighted avg': {'precision': 0.35509617671505495, 'recall': 0.3511115424695041, 'f1-score': 0.34126070721844853, 'support': 195764}}
[[19943 12169 32177]
 [16773 14633 33181]
 [20200 12529 34159]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0984219
{'0': {'precision': 0.3499658236500342, 'recall': 0.21548821548821548, 'f1-score': 0.2667361292003126, 'support': 21384}, '1': {'precision': 0.3792085949912991, 'recall': 0.22916190389099722, 'f1-score': 0.28568171454628366, 'support': 21871}, '2': {'precision': 0.34243752282569, 'recall': 0.6116106788426594, 'f1-score': 0.4390521263608542, 'support': 21463}, 'accuracy': 0.35147872307549677, 'macro avg': {'precision': 0.35720398048900776, 'recall': 0.352086932740624, 'f1-score': 0.33048999003581686, 'support': 64718}, 'weighted avg': {'precision': 0.35735153908332795, 'recall': 0.35147872307549677, 'f1-score': 0.33028532948707107, 'support': 64718}}
[[ 4608  4035 12741]
 [ 4393  5012 12466]
 [ 4166  4170 13127]]
training model: results/PCAR/W0/deepLOB_L2/h200
Epoch 1/50
765/765 - 50s - loss: 3.2882 - accuracy200: 0.3833 - val_loss: 3.3395 - val_accuracy200: 0.3312 - 50s/epoch - 66ms/step
Epoch 2/50
765/765 - 44s - loss: 3.2570 - accuracy200: 0.3937 - val_loss: 3.3366 - val_accuracy200: 0.3375 - 44s/epoch - 58ms/step
Epoch 3/50
765/765 - 44s - loss: 3.2370 - accuracy200: 0.4047 - val_loss: 3.3251 - val_accuracy200: 0.3439 - 44s/epoch - 57ms/step
Epoch 4/50
765/765 - 44s - loss: 3.2264 - accuracy200: 0.4095 - val_loss: 3.3412 - val_accuracy200: 0.3458 - 44s/epoch - 57ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2238 - accuracy200: 0.4133 - val_loss: 3.3911 - val_accuracy200: 0.3344 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 44s - loss: 3.2214 - accuracy200: 0.4120 - val_loss: 3.3974 - val_accuracy200: 0.3437 - 44s/epoch - 57ms/step
Epoch 7/50
765/765 - 42s - loss: 3.2092 - accuracy200: 0.4178 - val_loss: 3.4044 - val_accuracy200: 0.3491 - 42s/epoch - 56ms/step
Epoch 8/50
765/765 - 42s - loss: 3.2002 - accuracy200: 0.4219 - val_loss: 3.3995 - val_accuracy200: 0.3498 - 42s/epoch - 55ms/step
Epoch 9/50
765/765 - 44s - loss: 3.1926 - accuracy200: 0.4244 - val_loss: 3.4047 - val_accuracy200: 0.3517 - 44s/epoch - 57ms/step
Epoch 10/50
765/765 - 46s - loss: 3.1856 - accuracy200: 0.4294 - val_loss: 3.4002 - val_accuracy200: 0.3539 - 46s/epoch - 60ms/step
Epoch 11/50
765/765 - 43s - loss: 3.1758 - accuracy200: 0.4358 - val_loss: 3.4137 - val_accuracy200: 0.3523 - 43s/epoch - 57ms/step
Epoch 12/50
765/765 - 44s - loss: 3.1677 - accuracy200: 0.4395 - val_loss: 3.4295 - val_accuracy200: 0.3547 - 44s/epoch - 57ms/step
Epoch 13/50
765/765 - 43s - loss: 3.1634 - accuracy200: 0.4415 - val_loss: 3.4509 - val_accuracy200: 0.3478 - 43s/epoch - 57ms/step
testing model: results/PCAR/W0/deepLOB_L2/h200
Evaluating performance on  test set...
1733/1733 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1043687
{'0': {'precision': 0.3068630846769918, 'recall': 0.31747575655633403, 'f1-score': 0.3120792221563236, 'support': 136738}, '1': {'precision': 0.4061357428031099, 'recall': 0.4159089092597033, 'f1-score': 0.4109642301710731, 'support': 162651}, '2': {'precision': 0.34047091821671094, 'recall': 0.32005301027594485, 'f1-score': 0.32994638827194267, 'support': 144123}, 'accuracy': 0.3544120564945255, 'macro avg': {'precision': 0.3511565818989375, 'recall': 0.3511458920306607, 'f1-score': 0.3509966135331131, 'support': 443512}, 'weighted avg': {'precision': 0.3541909110043881, 'recall': 0.3544120564945255, 'f1-score': 0.3541498200672897, 'support': 443512}}
[[43411 47889 45438]
 [51088 67648 43915]
 [46968 51028 46127]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1060116
{'0': {'precision': 0.34902408501108745, 'recall': 0.24924350511907936, 'f1-score': 0.29081296648617005, 'support': 63781}, '1': {'precision': 0.3594370146678171, 'recall': 0.5165855473230616, 'f1-score': 0.42391594693259727, 'support': 64514}, '2': {'precision': 0.34855731603388, 'recall': 0.2970401221301635, 'f1-score': 0.32074324216186806, 'support': 67469}, 'accuracy': 0.353818883962322, 'macro avg': {'precision': 0.35233947190426146, 'recall': 0.3542897248574348, 'f1-score': 0.34515738519354516, 'support': 195764}, 'weighted avg': {'precision': 0.352294795191463, 'recall': 0.353818883962322, 'f1-score': 0.3449923429296657, 'support': 195764}}
[[15897 28618 19266]
 [12997 33327 18190]
 [16653 30775 20041]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1077415
{'0': {'precision': 0.3345375722543353, 'recall': 0.13184622686283815, 'f1-score': 0.18914686457411317, 'support': 21070}, '1': {'precision': 0.35396032850399717, 'recall': 0.5822188313436855, 'f1-score': 0.44026267116895457, 'support': 22282}, '2': {'precision': 0.3290998330213024, 'recall': 0.30440887391182253, 'f1-score': 0.31627318923387393, 'support': 21366}, 'accuracy': 0.34387651039896167, 'macro avg': {'precision': 0.33919924459321166, 'recall': 0.3394913107061153, 'f1-score': 0.3152275749923139, 'support': 64718}, 'weighted avg': {'precision': 0.3394294897780843, 'recall': 0.34387651039896167, 'f1-score': 0.3175739398117086, 'support': 64718}}
[[ 2778 11626  6666]
 [ 2716 12973  6593]
 [ 2810 12052  6504]]
training model: results/PCAR/W0/deepLOB_L2/h300
Epoch 1/50
765/765 - 47s - loss: 3.2937 - accuracy300: 0.3806 - val_loss: 3.3125 - val_accuracy300: 0.3589 - 47s/epoch - 61ms/step
Epoch 2/50
765/765 - 43s - loss: 3.2420 - accuracy300: 0.4030 - val_loss: 3.3310 - val_accuracy300: 0.3603 - 43s/epoch - 56ms/step
Epoch 3/50
765/765 - 42s - loss: 3.2249 - accuracy300: 0.4118 - val_loss: 3.3340 - val_accuracy300: 0.3689 - 42s/epoch - 54ms/step
Epoch 4/50
765/765 - 43s - loss: 3.2068 - accuracy300: 0.4211 - val_loss: 3.3733 - val_accuracy300: 0.3621 - 43s/epoch - 57ms/step
Epoch 5/50
765/765 - 43s - loss: 3.1938 - accuracy300: 0.4276 - val_loss: 3.3470 - val_accuracy300: 0.3731 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 46s - loss: 3.1856 - accuracy300: 0.4302 - val_loss: 3.3557 - val_accuracy300: 0.3665 - 46s/epoch - 61ms/step
Epoch 7/50
765/765 - 44s - loss: 3.1778 - accuracy300: 0.4343 - val_loss: 3.3616 - val_accuracy300: 0.3614 - 44s/epoch - 57ms/step
Epoch 8/50
765/765 - 43s - loss: 3.1707 - accuracy300: 0.4374 - val_loss: 3.3754 - val_accuracy300: 0.3652 - 43s/epoch - 56ms/step
Epoch 9/50
765/765 - 43s - loss: 3.1606 - accuracy300: 0.4412 - val_loss: 3.3597 - val_accuracy300: 0.3684 - 43s/epoch - 56ms/step
Epoch 10/50
765/765 - 45s - loss: 3.1512 - accuracy300: 0.4460 - val_loss: 3.3714 - val_accuracy300: 0.3605 - 45s/epoch - 59ms/step
Epoch 11/50
765/765 - 46s - loss: 3.1422 - accuracy300: 0.4497 - val_loss: 3.3592 - val_accuracy300: 0.3614 - 46s/epoch - 60ms/step
testing model: results/PCAR/W0/deepLOB_L2/h300
Evaluating performance on  test set...
1733/1733 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1122178
{'0': {'precision': 0.33990048591276883, 'recall': 0.4339986468200271, 'f1-score': 0.3812288829390491, 'support': 147800}, '1': {'precision': 0.3688351635288349, 'recall': 0.3559250336975537, 'f1-score': 0.3622651147517057, 'support': 139476}, '2': {'precision': 0.3614113027345862, 'recall': 0.27805371361273973, 'f1-score': 0.3142994606366008, 'support': 156236}, 'accuracy': 0.35451126463320043, 'macro avg': {'precision': 0.3567156507253966, 'recall': 0.35599246471010687, 'f1-score': 0.3525978194424519, 'support': 443512}, 'weighted avg': {'precision': 0.35657750270634353, 'recall': 0.35451126463320043, 'f1-score': 0.35168791053121523, 'support': 443512}}
[[64145 40848 42807]
 [55881 49643 33952]
 [68691 44103 43442]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106581
{'0': {'precision': 0.34571263870874763, 'recall': 0.3787637167442962, 'f1-score': 0.3614842719909587, 'support': 63335}, '1': {'precision': 0.38016100698876487, 'recall': 0.46427744594156595, 'f1-score': 0.41802971136341527, 'support': 64791}, '2': {'precision': 0.35900692107435395, 'recall': 0.2507761908986073, 'f1-score': 0.29528659093876486, 'support': 67638}, 'accuracy': 0.36284505833554687, 'macro avg': {'precision': 0.36162685559062213, 'recall': 0.3646057845281565, 'f1-score': 0.358266858097713, 'support': 195764}, 'weighted avg': {'precision': 0.3617071162422854, 'recall': 0.36284505833554687, 'f1-score': 0.3573270051358298, 'support': 195764}}
[[23989 23426 15920]
 [20345 30081 14365]
 [25056 25620 16962]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1036165
{'0': {'precision': 0.3378692154003996, 'recall': 0.2969343204252088, 'f1-score': 0.3160819378141497, 'support': 21072}, '1': {'precision': 0.38643835616438355, 'recall': 0.38566350710900477, 'f1-score': 0.3860505428336831, 'support': 21944}, '2': {'precision': 0.34063130169965844, 'recall': 0.3813934199612939, 'f1-score': 0.35986174213604055, 'support': 21702}, 'accuracy': 0.35534163602089064, 'macro avg': {'precision': 0.3549796244214805, 'recall': 0.35466374916516913, 'f1-score': 0.35399807426129115, 'support': 64718}, 'weighted avg': {'precision': 0.3552638200203102, 'recall': 0.35534163602089064, 'f1-score': 0.35448702421889516, 'support': 64718}}
[[6257 6378 8437]
 [5896 8463 7585]
 [6366 7059 8277]]
training model: results/PCAR/W0/deepLOB_L2/h500
Epoch 1/50
765/765 - 48s - loss: 3.3034 - accuracy500: 0.3760 - val_loss: 3.3768 - val_accuracy500: 0.3323 - 48s/epoch - 63ms/step
Epoch 2/50
765/765 - 43s - loss: 3.2605 - accuracy500: 0.3977 - val_loss: 3.3336 - val_accuracy500: 0.3347 - 43s/epoch - 57ms/step
Epoch 3/50
765/765 - 44s - loss: 3.2358 - accuracy500: 0.4072 - val_loss: 3.3337 - val_accuracy500: 0.3478 - 44s/epoch - 58ms/step
Epoch 4/50
765/765 - 43s - loss: 3.2217 - accuracy500: 0.4165 - val_loss: 3.3298 - val_accuracy500: 0.3454 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 45s - loss: 3.2142 - accuracy500: 0.4191 - val_loss: 3.3448 - val_accuracy500: 0.3475 - 45s/epoch - 59ms/step
Epoch 6/50
765/765 - 47s - loss: 3.2045 - accuracy500: 0.4248 - val_loss: 3.3685 - val_accuracy500: 0.3442 - 47s/epoch - 61ms/step
Epoch 7/50
765/765 - 45s - loss: 3.1946 - accuracy500: 0.4302 - val_loss: 3.3988 - val_accuracy500: 0.3401 - 45s/epoch - 59ms/step
Epoch 8/50
765/765 - 44s - loss: 3.1853 - accuracy500: 0.4354 - val_loss: 3.4146 - val_accuracy500: 0.3525 - 44s/epoch - 58ms/step
Epoch 9/50
765/765 - 43s - loss: 3.1740 - accuracy500: 0.4382 - val_loss: 3.4443 - val_accuracy500: 0.3535 - 43s/epoch - 57ms/step
Epoch 10/50
765/765 - 44s - loss: 3.1639 - accuracy500: 0.4437 - val_loss: 3.4769 - val_accuracy500: 0.3466 - 44s/epoch - 58ms/step
Epoch 11/50
765/765 - 43s - loss: 3.1553 - accuracy500: 0.4470 - val_loss: 3.4787 - val_accuracy500: 0.3484 - 43s/epoch - 57ms/step
Epoch 12/50
765/765 - 46s - loss: 3.1455 - accuracy500: 0.4495 - val_loss: 3.5023 - val_accuracy500: 0.3523 - 46s/epoch - 59ms/step
Epoch 13/50
765/765 - 46s - loss: 3.1370 - accuracy500: 0.4540 - val_loss: 3.5263 - val_accuracy500: 0.3499 - 46s/epoch - 61ms/step
Epoch 14/50
765/765 - 42s - loss: 3.1267 - accuracy500: 0.4555 - val_loss: 3.5584 - val_accuracy500: 0.3521 - 42s/epoch - 55ms/step
testing model: results/PCAR/W0/deepLOB_L2/h500
Evaluating performance on  test set...
1733/1733 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1400753
{'0': {'precision': 0.3128241065171689, 'recall': 0.3256469934345364, 'f1-score': 0.3191067842189468, 'support': 143935}, '1': {'precision': 0.32486258693853975, 'recall': 0.45563633118465585, 'f1-score': 0.37929379225217297, 'support': 145671}, '2': {'precision': 0.3530425441443054, 'recall': 0.20499525684508726, 'f1-score': 0.2593804465783156, 'support': 153906}, 'accuracy': 0.32647369180540775, 'macro avg': {'precision': 0.3302430792000047, 'recall': 0.3287595271547598, 'f1-score': 0.31926034101647843, 'support': 443512}, 'weighted avg': {'precision': 0.33073459449247417, 'recall': 0.32647369180540775, 'f1-score': 0.318149109852276, 'support': 443512}}
[[46872 66125 30938]
 [52420 66373 26878]
 [50543 71813 31550]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1213826
{'0': {'precision': 0.33950965992543214, 'recall': 0.1952027542751352, 'f1-score': 0.24788360606716775, 'support': 61577}, '1': {'precision': 0.35551639661322904, 'recall': 0.6229890944146532, 'f1-score': 0.4526961575718437, 'support': 66388}, '2': {'precision': 0.329290176036343, 'recall': 0.2138232127317512, 'f1-score': 0.25928244384032056, 'support': 67799}, 'accuracy': 0.34672360597454077, 'macro avg': {'precision': 0.34143874419166803, 'recall': 0.34400502047384657, 'f1-score': 0.3199540691597773, 'support': 195764}, 'weighted avg': {'precision': 0.34139858969307635, 'recall': 0.34672360597454077, 'f1-score': 0.321287937157023, 'support': 195764}}
[[12020 35409 14148]
 [ 9649 41359 15380]
 [13735 39567 14497]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1050425
{'0': {'precision': 0.33218440327445065, 'recall': 0.037246376811594206, 'f1-score': 0.06698232048998741, 'support': 20700}, '1': {'precision': 0.34943254857310757, 'recall': 0.84501287858602, 'f1-score': 0.49441355298030454, 'support': 22518}, '2': {'precision': 0.3194007302026942, 'recall': 0.118, 'f1-score': 0.17233298237272018, 'support': 21500}, 'accuracy': 0.3451280941932693, 'macro avg': {'precision': 0.33367256068341744, 'recall': 0.3334197517992048, 'f1-score': 0.24457628528100406, 'support': 64718}, 'weighted avg': {'precision': 0.3339388574416436, 'recall': 0.3451280941932693, 'f1-score': 0.2507014669978479, 'support': 64718}}
[[  771 17210  2719]
 [  803 19028  2687]
 [  747 18216  2537]]
training model: results/PCAR/W0/deepLOB_L2/h1000
Epoch 1/50
765/765 - 49s - loss: 3.3025 - accuracy1000: 0.3777 - val_loss: 3.5413 - val_accuracy1000: 0.3304 - 49s/epoch - 63ms/step
Epoch 2/50
765/765 - 45s - loss: 3.2568 - accuracy1000: 0.3985 - val_loss: 3.4019 - val_accuracy1000: 0.3279 - 45s/epoch - 59ms/step
Epoch 3/50
765/765 - 48s - loss: 3.2235 - accuracy1000: 0.4097 - val_loss: 3.4072 - val_accuracy1000: 0.3288 - 48s/epoch - 62ms/step
Epoch 4/50
765/765 - 46s - loss: 3.1971 - accuracy1000: 0.4205 - val_loss: 3.3928 - val_accuracy1000: 0.3319 - 46s/epoch - 60ms/step
Epoch 5/50
765/765 - 44s - loss: 3.1746 - accuracy1000: 0.4348 - val_loss: 3.4335 - val_accuracy1000: 0.3304 - 44s/epoch - 57ms/step
Epoch 6/50
765/765 - 45s - loss: 3.1760 - accuracy1000: 0.4339 - val_loss: 3.3959 - val_accuracy1000: 0.3314 - 45s/epoch - 59ms/step
Epoch 7/50
765/765 - 44s - loss: 3.1459 - accuracy1000: 0.4480 - val_loss: 3.4246 - val_accuracy1000: 0.3312 - 44s/epoch - 58ms/step
Epoch 8/50
765/765 - 47s - loss: 3.1298 - accuracy1000: 0.4570 - val_loss: 3.4757 - val_accuracy1000: 0.3289 - 47s/epoch - 62ms/step
Epoch 9/50
765/765 - 45s - loss: 3.1175 - accuracy1000: 0.4626 - val_loss: 3.5252 - val_accuracy1000: 0.3339 - 45s/epoch - 59ms/step
Epoch 10/50
765/765 - 43s - loss: 3.1056 - accuracy1000: 0.4657 - val_loss: 3.4803 - val_accuracy1000: 0.3320 - 43s/epoch - 56ms/step
Epoch 11/50
765/765 - 43s - loss: 3.0942 - accuracy1000: 0.4692 - val_loss: 3.4518 - val_accuracy1000: 0.3309 - 43s/epoch - 56ms/step
Epoch 12/50
765/765 - 44s - loss: 3.0813 - accuracy1000: 0.4753 - val_loss: 3.5078 - val_accuracy1000: 0.3322 - 44s/epoch - 57ms/step
Epoch 13/50
765/765 - 44s - loss: 3.0721 - accuracy1000: 0.4783 - val_loss: 3.5249 - val_accuracy1000: 0.3325 - 44s/epoch - 57ms/step
Epoch 14/50
765/765 - 45s - loss: 3.0631 - accuracy1000: 0.4808 - val_loss: 3.5748 - val_accuracy1000: 0.3357 - 45s/epoch - 59ms/step
testing model: results/PCAR/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
1733/1733 - 46s - 46s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1536891
{'0': {'precision': 0.3090055027682811, 'recall': 0.39028675900434656, 'f1-score': 0.3449223244204981, 'support': 140571}, '1': {'precision': 0.31686432754293586, 'recall': 0.04405415945430039, 'f1-score': 0.07735370790836245, 'support': 146161}, '2': {'precision': 0.36257755125303287, 'recall': 0.5680890419696389, 'f1-score': 0.44264258592926864, 'support': 156780}, 'accuracy': 0.3390370497303342, 'macro avg': {'precision': 0.3294824605214166, 'recall': 0.334143320142762, 'f1-score': 0.28830620608604307, 'support': 443512}, 'weighted avg': {'precision': 0.3305329461053897, 'recall': 0.3390370497303342, 'f1-score': 0.2912878929762864, 'support': 443512}}
[[54863  6602 79106]
 [62249  6439 77473]
 [60435  7280 89065]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1536638
{'0': {'precision': 0.3237277001797815, 'recall': 0.30869020538687236, 'f1-score': 0.31603017365037034, 'support': 60666}, '1': {'precision': 0.340037153703255, 'recall': 0.06390988857515864, 'f1-score': 0.10759695866078847, 'support': 65874}, '2': {'precision': 0.34325885211295654, 'recall': 0.6224864208944875, 'f1-score': 0.4425058662244106, 'support': 69224}, 'accuracy': 0.33728366809014937, 'macro avg': {'precision': 0.335674568665331, 'recall': 0.3316955049521728, 'f1-score': 0.28871099951185647, 'support': 195764}, 'weighted avg': {'precision': 0.3361221823257705, 'recall': 0.33728366809014937, 'f1-score': 0.2906160205809687, 'support': 195764}}
[[18727  3856 38083]
 [17303  4210 44361]
 [21818  4315 43091]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1231583
{'0': {'precision': 0.32488695503796605, 'recall': 0.1829449915926015, 'f1-score': 0.23407917383821, 'support': 20815}, '1': {'precision': 0.35004516711833783, 'recall': 0.10380854578738224, 'f1-score': 0.16012948104273564, 'support': 22397}, '2': {'precision': 0.33241290044223926, 'recall': 0.7164977215660746, 'f1-score': 0.45413418605679257, 'support': 21506}, 'accuracy': 0.33285948267869836, 'macro avg': {'precision': 0.3357816741995143, 'recall': 0.33441708631535283, 'f1-score': 0.2827809469792461, 'support': 64718}, 'weighted avg': {'precision': 0.3360943696340349, 'recall': 0.33285948267869836, 'f1-score': 0.28161234580323674, 'support': 64718}}
[[ 3808  2114 14893]
 [ 4019  2325 16053]
 [ 3894  2203 15409]]
training model: results/PCAR/W0/deepOF_L2/h10
Epoch 1/50
765/765 - 39s - loss: 3.2142 - accuracy10: 0.4118 - val_loss: 3.1884 - val_accuracy10: 0.4187 - 39s/epoch - 51ms/step
Epoch 2/50
765/765 - 32s - loss: 3.0821 - accuracy10: 0.4684 - val_loss: 3.1365 - val_accuracy10: 0.4412 - 32s/epoch - 41ms/step
Epoch 3/50
765/765 - 34s - loss: 3.0390 - accuracy10: 0.4824 - val_loss: 3.0958 - val_accuracy10: 0.4626 - 34s/epoch - 44ms/step
Epoch 4/50
765/765 - 31s - loss: 3.0125 - accuracy10: 0.4914 - val_loss: 3.0762 - val_accuracy10: 0.4752 - 31s/epoch - 41ms/step
Epoch 5/50
765/765 - 29s - loss: 2.9929 - accuracy10: 0.4975 - val_loss: 3.0573 - val_accuracy10: 0.4802 - 29s/epoch - 38ms/step
Epoch 6/50
765/765 - 30s - loss: 2.9795 - accuracy10: 0.5007 - val_loss: 3.0396 - val_accuracy10: 0.4849 - 30s/epoch - 39ms/step
Epoch 7/50
765/765 - 30s - loss: 2.9676 - accuracy10: 0.5049 - val_loss: 3.0312 - val_accuracy10: 0.4885 - 30s/epoch - 39ms/step
Epoch 8/50
765/765 - 31s - loss: 2.9588 - accuracy10: 0.5080 - val_loss: 3.0273 - val_accuracy10: 0.4889 - 31s/epoch - 40ms/step
Epoch 9/50
765/765 - 30s - loss: 2.9508 - accuracy10: 0.5101 - val_loss: 3.0184 - val_accuracy10: 0.4908 - 30s/epoch - 39ms/step
Epoch 10/50
765/765 - 33s - loss: 2.9432 - accuracy10: 0.5111 - val_loss: 3.0167 - val_accuracy10: 0.4911 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 30s - loss: 2.9374 - accuracy10: 0.5143 - val_loss: 3.0163 - val_accuracy10: 0.4910 - 30s/epoch - 39ms/step
Epoch 12/50
765/765 - 32s - loss: 2.9322 - accuracy10: 0.5145 - val_loss: 3.0095 - val_accuracy10: 0.4926 - 32s/epoch - 42ms/step
Epoch 13/50
765/765 - 31s - loss: 2.9262 - accuracy10: 0.5171 - val_loss: 3.0105 - val_accuracy10: 0.4931 - 31s/epoch - 41ms/step
Epoch 14/50
765/765 - 31s - loss: 2.9219 - accuracy10: 0.5175 - val_loss: 3.0064 - val_accuracy10: 0.4950 - 31s/epoch - 40ms/step
Epoch 15/50
765/765 - 31s - loss: 2.9166 - accuracy10: 0.5201 - val_loss: 3.0040 - val_accuracy10: 0.4960 - 31s/epoch - 41ms/step
Epoch 16/50
765/765 - 31s - loss: 2.9111 - accuracy10: 0.5210 - val_loss: 3.0049 - val_accuracy10: 0.4952 - 31s/epoch - 40ms/step
Epoch 17/50
765/765 - 32s - loss: 2.9066 - accuracy10: 0.5223 - val_loss: 3.0022 - val_accuracy10: 0.4943 - 32s/epoch - 41ms/step
Epoch 18/50
765/765 - 31s - loss: 2.9016 - accuracy10: 0.5242 - val_loss: 3.0062 - val_accuracy10: 0.4938 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 30s - loss: 2.8976 - accuracy10: 0.5251 - val_loss: 3.0027 - val_accuracy10: 0.4955 - 30s/epoch - 39ms/step
Epoch 20/50
765/765 - 32s - loss: 2.8923 - accuracy10: 0.5264 - val_loss: 3.0018 - val_accuracy10: 0.4934 - 32s/epoch - 42ms/step
Epoch 21/50
765/765 - 32s - loss: 2.8888 - accuracy10: 0.5268 - val_loss: 3.0032 - val_accuracy10: 0.4955 - 32s/epoch - 42ms/step
Epoch 22/50
765/765 - 31s - loss: 2.8844 - accuracy10: 0.5280 - val_loss: 3.0033 - val_accuracy10: 0.4947 - 31s/epoch - 41ms/step
Epoch 23/50
765/765 - 33s - loss: 2.8799 - accuracy10: 0.5297 - val_loss: 3.0038 - val_accuracy10: 0.4948 - 33s/epoch - 44ms/step
Epoch 24/50
765/765 - 33s - loss: 2.8759 - accuracy10: 0.5317 - val_loss: 3.0029 - val_accuracy10: 0.4938 - 33s/epoch - 43ms/step
Epoch 25/50
765/765 - 31s - loss: 2.8719 - accuracy10: 0.5323 - val_loss: 3.0026 - val_accuracy10: 0.4944 - 31s/epoch - 40ms/step
Epoch 26/50
765/765 - 32s - loss: 2.8649 - accuracy10: 0.5345 - val_loss: 3.0031 - val_accuracy10: 0.4942 - 32s/epoch - 42ms/step
Epoch 27/50
765/765 - 31s - loss: 2.8643 - accuracy10: 0.5342 - val_loss: 3.0049 - val_accuracy10: 0.4936 - 31s/epoch - 40ms/step
Epoch 28/50
765/765 - 31s - loss: 2.8580 - accuracy10: 0.5360 - val_loss: 3.0093 - val_accuracy10: 0.4931 - 31s/epoch - 41ms/step
Epoch 29/50
765/765 - 33s - loss: 2.8562 - accuracy10: 0.5370 - val_loss: 3.0096 - val_accuracy10: 0.4938 - 33s/epoch - 43ms/step
Epoch 30/50
765/765 - 35s - loss: 2.8496 - accuracy10: 0.5375 - val_loss: 3.0100 - val_accuracy10: 0.4931 - 35s/epoch - 45ms/step
testing model: results/PCAR/W0/deepOF_L2/h10
Evaluating performance on  test set...
1733/1733 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0206877
{'0': {'precision': 0.45337200956228235, 'recall': 0.5297048916734818, 'f1-score': 0.48857494446486505, 'support': 144286}, '1': {'precision': 0.5199953447149086, 'recall': 0.37872801011958324, 'f1-score': 0.4382590062135234, 'support': 153366}, '2': {'precision': 0.469713956637076, 'recall': 0.5256590449418943, 'f1-score': 0.49611429976511084, 'support': 145855}, 'accuracy': 0.47616610335349835, 'macro avg': {'precision': 0.48102710363808904, 'recall': 0.4780306489116531, 'f1-score': 0.47431608348116644, 'support': 443507}, 'weighted avg': {'precision': 0.48178488491624905, 'recall': 0.47616610335349835, 'f1-score': 0.47365499614716566, 'support': 443507}}
[[76429 26079 41778]
 [50503 58084 44779]
 [41647 27538 76670]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9738702
{'0': {'precision': 0.5009018294254058, 'recall': 0.5069100391134289, 'f1-score': 0.5038880248833592, 'support': 65195}, '1': {'precision': 0.5508026722504736, 'recall': 0.5156352095584803, 'f1-score': 0.5326390897695497, 'support': 64278}, '2': {'precision': 0.5073908609024177, 'recall': 0.532817426196618, 'f1-score': 0.5197933835648694, 'support': 66291}, 'accuracy': 0.5185478433215505, 'macro avg': {'precision': 0.5196984541927657, 'recall': 0.5184542249561758, 'f1-score': 0.5187734994059261, 'support': 195764}, 'weighted avg': {'precision': 0.5194838504341323, 'recall': 0.5185478433215505, 'f1-score': 0.5187142599475719, 'support': 195764}}
[[33048 13311 18836]
 [15678 33144 15456]
 [17251 13719 35321]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0003328
{'0': {'precision': 0.4635433322673489, 'recall': 0.5404800745746912, 'f1-score': 0.49906393234490315, 'support': 21455}, '1': {'precision': 0.5536308716557761, 'recall': 0.42697537320528667, 'f1-score': 0.4821236847756066, 'support': 21034}, '2': {'precision': 0.4895655877342419, 'recall': 0.5171172792298349, 'f1-score': 0.502964405259358, 'support': 22229}, 'accuracy': 0.4955653759386878, 'macro avg': {'precision': 0.5022465972191222, 'recall': 0.4948575756699376, 'f1-score': 0.4947173407932892, 'support': 64718}, 'weighted avg': {'precision': 0.5017606755145095, 'recall': 0.4955653759386878, 'f1-score': 0.4948978957715053, 'support': 64718}}
[[11596  3398  6461]
 [ 6529  8981  5524]
 [ 6891  3843 11495]]
training model: results/PCAR/W0/deepOF_L2/h20
Epoch 1/50
765/765 - 34s - loss: 3.2633 - accuracy20: 0.3876 - val_loss: 3.2705 - val_accuracy20: 0.3910 - 34s/epoch - 44ms/step
Epoch 2/50
765/765 - 31s - loss: 3.1716 - accuracy20: 0.4341 - val_loss: 3.2353 - val_accuracy20: 0.4063 - 31s/epoch - 41ms/step
Epoch 3/50
765/765 - 32s - loss: 3.1425 - accuracy20: 0.4454 - val_loss: 3.2132 - val_accuracy20: 0.4133 - 32s/epoch - 42ms/step
Epoch 4/50
765/765 - 35s - loss: 3.1241 - accuracy20: 0.4532 - val_loss: 3.1968 - val_accuracy20: 0.4205 - 35s/epoch - 46ms/step
Epoch 5/50
765/765 - 32s - loss: 3.1116 - accuracy20: 0.4596 - val_loss: 3.1851 - val_accuracy20: 0.4257 - 32s/epoch - 41ms/step
Epoch 6/50
765/765 - 33s - loss: 3.1011 - accuracy20: 0.4638 - val_loss: 3.1758 - val_accuracy20: 0.4306 - 33s/epoch - 43ms/step
Epoch 7/50
765/765 - 32s - loss: 3.0906 - accuracy20: 0.4677 - val_loss: 3.1675 - val_accuracy20: 0.4363 - 32s/epoch - 42ms/step
Epoch 8/50
765/765 - 32s - loss: 3.0826 - accuracy20: 0.4701 - val_loss: 3.1610 - val_accuracy20: 0.4394 - 32s/epoch - 41ms/step
Epoch 9/50
765/765 - 31s - loss: 3.0744 - accuracy20: 0.4737 - val_loss: 3.1600 - val_accuracy20: 0.4392 - 31s/epoch - 40ms/step
Epoch 10/50
765/765 - 32s - loss: 3.0689 - accuracy20: 0.4752 - val_loss: 3.1533 - val_accuracy20: 0.4434 - 32s/epoch - 42ms/step
Epoch 11/50
765/765 - 30s - loss: 3.0625 - accuracy20: 0.4780 - val_loss: 3.1505 - val_accuracy20: 0.4441 - 30s/epoch - 40ms/step
Epoch 12/50
765/765 - 30s - loss: 3.0575 - accuracy20: 0.4793 - val_loss: 3.1492 - val_accuracy20: 0.4474 - 30s/epoch - 39ms/step
Epoch 13/50
765/765 - 30s - loss: 3.0529 - accuracy20: 0.4809 - val_loss: 3.1451 - val_accuracy20: 0.4478 - 30s/epoch - 39ms/step
Epoch 14/50
765/765 - 31s - loss: 3.0491 - accuracy20: 0.4814 - val_loss: 3.1469 - val_accuracy20: 0.4471 - 31s/epoch - 40ms/step
Epoch 15/50
765/765 - 28s - loss: 3.0440 - accuracy20: 0.4832 - val_loss: 3.1447 - val_accuracy20: 0.4466 - 28s/epoch - 36ms/step
Epoch 16/50
765/765 - 36s - loss: 3.0394 - accuracy20: 0.4858 - val_loss: 3.1399 - val_accuracy20: 0.4519 - 36s/epoch - 47ms/step
Epoch 17/50
765/765 - 33s - loss: 3.0358 - accuracy20: 0.4870 - val_loss: 3.1371 - val_accuracy20: 0.4516 - 33s/epoch - 43ms/step
Epoch 18/50
765/765 - 31s - loss: 3.0311 - accuracy20: 0.4875 - val_loss: 3.1349 - val_accuracy20: 0.4537 - 31s/epoch - 40ms/step
Epoch 19/50
765/765 - 29s - loss: 3.0270 - accuracy20: 0.4884 - val_loss: 3.1364 - val_accuracy20: 0.4522 - 29s/epoch - 38ms/step
Epoch 20/50
765/765 - 31s - loss: 3.0227 - accuracy20: 0.4909 - val_loss: 3.1389 - val_accuracy20: 0.4542 - 31s/epoch - 40ms/step
Epoch 21/50
765/765 - 29s - loss: 3.0192 - accuracy20: 0.4926 - val_loss: 3.1360 - val_accuracy20: 0.4522 - 29s/epoch - 38ms/step
Epoch 22/50
765/765 - 29s - loss: 3.0153 - accuracy20: 0.4935 - val_loss: 3.1373 - val_accuracy20: 0.4515 - 29s/epoch - 38ms/step
Epoch 23/50
765/765 - 30s - loss: 3.0103 - accuracy20: 0.4942 - val_loss: 3.1362 - val_accuracy20: 0.4544 - 30s/epoch - 39ms/step
Epoch 24/50
765/765 - 29s - loss: 3.0064 - accuracy20: 0.4950 - val_loss: 3.1402 - val_accuracy20: 0.4534 - 29s/epoch - 38ms/step
Epoch 25/50
765/765 - 29s - loss: 3.0019 - accuracy20: 0.4966 - val_loss: 3.1444 - val_accuracy20: 0.4532 - 29s/epoch - 38ms/step
Epoch 26/50
765/765 - 33s - loss: 2.9984 - accuracy20: 0.4979 - val_loss: 3.1420 - val_accuracy20: 0.4518 - 33s/epoch - 43ms/step
Epoch 27/50
765/765 - 31s - loss: 2.9946 - accuracy20: 0.4986 - val_loss: 3.1446 - val_accuracy20: 0.4527 - 31s/epoch - 40ms/step
Epoch 28/50
765/765 - 30s - loss: 2.9900 - accuracy20: 0.5010 - val_loss: 3.1480 - val_accuracy20: 0.4523 - 30s/epoch - 39ms/step
testing model: results/PCAR/W0/deepOF_L2/h20
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0553569
{'0': {'precision': 0.41325475488882935, 'recall': 0.5432507430310031, 'f1-score': 0.4694190532990908, 'support': 141986}, '1': {'precision': 0.4851495853560964, 'recall': 0.28530099951677307, 'f1-score': 0.35930574740255844, 'support': 157276}, '2': {'precision': 0.44058454200330965, 'recall': 0.5020485978716767, 'f1-score': 0.4693126990761893, 'support': 144245}, 'accuracy': 0.43837639541202283, 'macro avg': {'precision': 0.44632962741607846, 'recall': 0.44353344680648427, 'f1-score': 0.43267916659261285, 'support': 443507}, 'weighted avg': {'precision': 0.44763869132928713, 'recall': 0.43837639541202283, 'f1-score': 0.4303361947127202, 'support': 443507}}
[[77134 22771 42081]
 [62536 44871 49869]
 [46980 24847 72418]]
Evaluating performance on  train set...
765/765 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0216134
{'0': {'precision': 0.4607000628798994, 'recall': 0.5053957937335214, 'f1-score': 0.48201402036534824, 'support': 65236}, '1': {'precision': 0.5050219240715063, 'recall': 0.4210107006170429, 'f1-score': 0.45920549322292364, 'support': 64015}, '2': {'precision': 0.479169313737947, 'recall': 0.5102912212650159, 'f1-score': 0.494240822448415, 'support': 66513}, 'accuracy': 0.47946507018655116, 'macro avg': {'precision': 0.4816304335631176, 'recall': 0.47889923853852673, 'f1-score': 0.4784867786788956, 'support': 195764}, 'weighted avg': {'precision': 0.48146848417544935, 'recall': 0.47946507018655116, 'f1-score': 0.47870980417610365, 'support': 195764}}
[[32970 12963 19303]
 [19475 26951 17589]
 [19120 13452 33941]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0445367
{'0': {'precision': 0.4243418705857173, 'recall': 0.5561737341624199, 'f1-score': 0.48139530178257084, 'support': 21389}, '1': {'precision': 0.5184262196042894, 'recall': 0.319688926143243, 'f1-score': 0.39549487268118444, 'support': 21474}, '2': {'precision': 0.4541421380428291, 'recall': 0.4871196522534889, 'f1-score': 0.4700532044064728, 'support': 21855}, 'accuracy': 0.45438672394078927, 'macro avg': {'precision': 0.46563674274427863, 'recall': 0.45432743751971727, 'f1-score': 0.448981126290076, 'support': 64718}, 'weighted avg': {'precision': 0.4656233093832697, 'recall': 0.45438672394078927, 'f1-score': 0.44906260681860727, 'support': 64718}}
[[11896  2973  6520]
 [ 8333  6865  6276]
 [ 7805  3404 10646]]
training model: results/PCAR/W0/deepOF_L2/h30
Epoch 1/50
765/765 - 39s - loss: 3.2857 - accuracy30: 0.3729 - val_loss: 3.2989 - val_accuracy30: 0.3769 - 39s/epoch - 50ms/step
Epoch 2/50
765/765 - 32s - loss: 3.2166 - accuracy30: 0.4117 - val_loss: 3.2789 - val_accuracy30: 0.3850 - 32s/epoch - 41ms/step
Epoch 3/50
765/765 - 30s - loss: 3.1938 - accuracy30: 0.4230 - val_loss: 3.2625 - val_accuracy30: 0.3900 - 30s/epoch - 39ms/step
Epoch 4/50
765/765 - 31s - loss: 3.1815 - accuracy30: 0.4296 - val_loss: 3.2578 - val_accuracy30: 0.3951 - 31s/epoch - 41ms/step
Epoch 5/50
765/765 - 34s - loss: 3.1719 - accuracy30: 0.4340 - val_loss: 3.2528 - val_accuracy30: 0.3968 - 34s/epoch - 44ms/step
Epoch 6/50
765/765 - 32s - loss: 3.1643 - accuracy30: 0.4381 - val_loss: 3.2452 - val_accuracy30: 0.4012 - 32s/epoch - 42ms/step
Epoch 7/50
765/765 - 33s - loss: 3.1565 - accuracy30: 0.4413 - val_loss: 3.2394 - val_accuracy30: 0.4048 - 33s/epoch - 43ms/step
Epoch 8/50
765/765 - 31s - loss: 3.1518 - accuracy30: 0.4435 - val_loss: 3.2340 - val_accuracy30: 0.4064 - 31s/epoch - 41ms/step
Epoch 9/50
765/765 - 30s - loss: 3.1455 - accuracy30: 0.4457 - val_loss: 3.2362 - val_accuracy30: 0.4056 - 30s/epoch - 39ms/step
Epoch 10/50
765/765 - 29s - loss: 3.1402 - accuracy30: 0.4486 - val_loss: 3.2284 - val_accuracy30: 0.4101 - 29s/epoch - 38ms/step
Epoch 11/50
765/765 - 30s - loss: 3.1352 - accuracy30: 0.4496 - val_loss: 3.2308 - val_accuracy30: 0.4094 - 30s/epoch - 40ms/step
Epoch 12/50
765/765 - 32s - loss: 3.1299 - accuracy30: 0.4518 - val_loss: 3.2303 - val_accuracy30: 0.4085 - 32s/epoch - 42ms/step
Epoch 13/50
765/765 - 31s - loss: 3.1260 - accuracy30: 0.4544 - val_loss: 3.2255 - val_accuracy30: 0.4123 - 31s/epoch - 41ms/step
Epoch 14/50
765/765 - 33s - loss: 3.1224 - accuracy30: 0.4556 - val_loss: 3.2306 - val_accuracy30: 0.4093 - 33s/epoch - 44ms/step
Epoch 15/50
765/765 - 32s - loss: 3.1178 - accuracy30: 0.4574 - val_loss: 3.2236 - val_accuracy30: 0.4140 - 32s/epoch - 42ms/step
Epoch 16/50
765/765 - 30s - loss: 3.1127 - accuracy30: 0.4588 - val_loss: 3.2207 - val_accuracy30: 0.4156 - 30s/epoch - 40ms/step
Epoch 17/50
765/765 - 32s - loss: 3.1087 - accuracy30: 0.4599 - val_loss: 3.2247 - val_accuracy30: 0.4129 - 32s/epoch - 42ms/step
Epoch 18/50
765/765 - 33s - loss: 3.1041 - accuracy30: 0.4618 - val_loss: 3.2248 - val_accuracy30: 0.4138 - 33s/epoch - 43ms/step
Epoch 19/50
765/765 - 33s - loss: 3.1002 - accuracy30: 0.4625 - val_loss: 3.2261 - val_accuracy30: 0.4157 - 33s/epoch - 43ms/step
Epoch 20/50
765/765 - 31s - loss: 3.0939 - accuracy30: 0.4653 - val_loss: 3.2270 - val_accuracy30: 0.4171 - 31s/epoch - 41ms/step
Epoch 21/50
765/765 - 30s - loss: 3.0915 - accuracy30: 0.4674 - val_loss: 3.2249 - val_accuracy30: 0.4168 - 30s/epoch - 40ms/step
Epoch 22/50
765/765 - 29s - loss: 3.0857 - accuracy30: 0.4692 - val_loss: 3.2248 - val_accuracy30: 0.4135 - 29s/epoch - 37ms/step
Epoch 23/50
765/765 - 31s - loss: 3.0814 - accuracy30: 0.4701 - val_loss: 3.2279 - val_accuracy30: 0.4143 - 31s/epoch - 40ms/step
Epoch 24/50
765/765 - 33s - loss: 3.0766 - accuracy30: 0.4711 - val_loss: 3.2283 - val_accuracy30: 0.4142 - 33s/epoch - 43ms/step
Epoch 25/50
765/765 - 31s - loss: 3.0719 - accuracy30: 0.4737 - val_loss: 3.2277 - val_accuracy30: 0.4152 - 31s/epoch - 40ms/step
Epoch 26/50
765/765 - 31s - loss: 3.0680 - accuracy30: 0.4755 - val_loss: 3.2298 - val_accuracy30: 0.4170 - 31s/epoch - 40ms/step
testing model: results/PCAR/W0/deepOF_L2/h30
Evaluating performance on  test set...
1733/1733 - 30s - 30s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754063
{'0': {'precision': 0.3936829138664958, 'recall': 0.5603956615806666, 'f1-score': 0.46247385204267694, 'support': 141434}, '1': {'precision': 0.4690840361493623, 'recall': 0.1880391944633682, 'f1-score': 0.2684616223684689, 'support': 157063}, '2': {'precision': 0.4176231314760154, 'recall': 0.5161437142266051, 'f1-score': 0.4616860305524799, 'support': 145010}, 'accuracy': 0.4140611083928777, 'macro avg': {'precision': 0.42679669383062446, 'recall': 0.42152619009021325, 'f1-score': 0.3975405016545419, 'support': 443507}, 'weighted avg': {'precision': 0.42821291547790286, 'recall': 0.4140611083928777, 'f1-score': 0.3935090221220362, 'support': 443507}}
[[79259 16047 46128]
 [69284 29534 58245]
 [52784 17380 74846]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0492172
{'0': {'precision': 0.4255690241562745, 'recall': 0.5271116871894578, 'f1-score': 0.4709288299155609, 'support': 64806}, '1': {'precision': 0.48571663334337595, 'recall': 0.2749926344027664, 'f1-score': 0.3511683168316832, 'support': 64489}, '2': {'precision': 0.4471791755292211, 'recall': 0.53137552844183, 'f1-score': 0.4856551600860759, 'support': 66469}, 'accuracy': 0.44550581312192233, 'macro avg': {'precision': 0.45282161100962387, 'recall': 0.4444932833446847, 'f1-score': 0.43591743561110663, 'support': 195764}, 'weighted avg': {'precision': 0.45272041215649605, 'recall': 0.44550581312192233, 'f1-score': 0.4364771876924646, 'support': 195764}}
[[34160  9137 21509]
 [24600 17734 22155]
 [21509  9640 35320]]
Evaluating performance on  val set...
253/253 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0730519
{'0': {'precision': 0.39116144358749066, 'recall': 0.5678114223628892, 'f1-score': 0.4632163089136383, 'support': 21169}, '1': {'precision': 0.49023529411764705, 'recall': 0.18928003633885987, 'f1-score': 0.27311158446665573, 'support': 22015}, '2': {'precision': 0.4216328612342579, 'recall': 0.4990712361846382, 'f1-score': 0.4570954639219105, 'support': 21534}, 'accuracy': 0.4161747890849532, 'macro avg': {'precision': 0.43434319964646523, 'recall': 0.41872089829546244, 'f1-score': 0.39780778576740156, 'support': 64718}, 'weighted avg': {'precision': 0.435002142110728, 'recall': 0.4161747890849532, 'f1-score': 0.396512118661279, 'support': 64718}}
[[12020  2076  7073]
 [10179  4167  7669]
 [ 8530  2257 10747]]
training model: results/PCAR/W0/deepOF_L2/h50
Epoch 1/50
765/765 - 35s - loss: 3.3002 - accuracy50: 0.3656 - val_loss: 3.3054 - val_accuracy50: 0.3599 - 35s/epoch - 46ms/step
Epoch 2/50
765/765 - 30s - loss: 3.2496 - accuracy50: 0.3951 - val_loss: 3.2909 - val_accuracy50: 0.3702 - 30s/epoch - 39ms/step
Epoch 3/50
765/765 - 32s - loss: 3.2311 - accuracy50: 0.4048 - val_loss: 3.2771 - val_accuracy50: 0.3741 - 32s/epoch - 42ms/step
Epoch 4/50
765/765 - 30s - loss: 3.2216 - accuracy50: 0.4108 - val_loss: 3.2756 - val_accuracy50: 0.3750 - 30s/epoch - 40ms/step
Epoch 5/50
765/765 - 31s - loss: 3.2149 - accuracy50: 0.4137 - val_loss: 3.2693 - val_accuracy50: 0.3778 - 31s/epoch - 40ms/step
Epoch 6/50
765/765 - 32s - loss: 3.2107 - accuracy50: 0.4170 - val_loss: 3.2648 - val_accuracy50: 0.3812 - 32s/epoch - 41ms/step
Epoch 7/50
765/765 - 31s - loss: 3.2052 - accuracy50: 0.4192 - val_loss: 3.2654 - val_accuracy50: 0.3816 - 31s/epoch - 41ms/step
Epoch 8/50
765/765 - 31s - loss: 3.2019 - accuracy50: 0.4206 - val_loss: 3.2620 - val_accuracy50: 0.3837 - 31s/epoch - 41ms/step
Epoch 9/50
765/765 - 32s - loss: 3.1971 - accuracy50: 0.4223 - val_loss: 3.2619 - val_accuracy50: 0.3843 - 32s/epoch - 41ms/step
Epoch 10/50
765/765 - 31s - loss: 3.1945 - accuracy50: 0.4245 - val_loss: 3.2609 - val_accuracy50: 0.3831 - 31s/epoch - 41ms/step
Epoch 11/50
765/765 - 31s - loss: 3.1915 - accuracy50: 0.4260 - val_loss: 3.2600 - val_accuracy50: 0.3851 - 31s/epoch - 40ms/step
Epoch 12/50
765/765 - 31s - loss: 3.1873 - accuracy50: 0.4284 - val_loss: 3.2588 - val_accuracy50: 0.3881 - 31s/epoch - 40ms/step
Epoch 13/50
765/765 - 30s - loss: 3.1839 - accuracy50: 0.4293 - val_loss: 3.2606 - val_accuracy50: 0.3849 - 30s/epoch - 39ms/step
Epoch 14/50
765/765 - 30s - loss: 3.1806 - accuracy50: 0.4312 - val_loss: 3.2616 - val_accuracy50: 0.3859 - 30s/epoch - 39ms/step
Epoch 15/50
765/765 - 32s - loss: 3.1763 - accuracy50: 0.4328 - val_loss: 3.2643 - val_accuracy50: 0.3858 - 32s/epoch - 42ms/step
Epoch 16/50
765/765 - 32s - loss: 3.1735 - accuracy50: 0.4338 - val_loss: 3.2632 - val_accuracy50: 0.3868 - 32s/epoch - 41ms/step
Epoch 17/50
765/765 - 34s - loss: 3.1701 - accuracy50: 0.4353 - val_loss: 3.2681 - val_accuracy50: 0.3869 - 34s/epoch - 45ms/step
Epoch 18/50
765/765 - 31s - loss: 3.1666 - accuracy50: 0.4368 - val_loss: 3.2681 - val_accuracy50: 0.3847 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 31s - loss: 3.1633 - accuracy50: 0.4383 - val_loss: 3.2703 - val_accuracy50: 0.3842 - 31s/epoch - 40ms/step
Epoch 20/50
765/765 - 30s - loss: 3.1579 - accuracy50: 0.4406 - val_loss: 3.2714 - val_accuracy50: 0.3842 - 30s/epoch - 39ms/step
Epoch 21/50
765/765 - 32s - loss: 3.1551 - accuracy50: 0.4419 - val_loss: 3.2716 - val_accuracy50: 0.3845 - 32s/epoch - 42ms/step
Epoch 22/50
765/765 - 30s - loss: 3.1501 - accuracy50: 0.4440 - val_loss: 3.2753 - val_accuracy50: 0.3859 - 30s/epoch - 40ms/step
testing model: results/PCAR/W0/deepOF_L2/h50
Evaluating performance on  test set...
1733/1733 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0784185
{'0': {'precision': 0.3515753314906061, 'recall': 0.527172933685728, 'f1-score': 0.421829564297902, 'support': 133184}, '1': {'precision': 0.4924441661448549, 'recall': 0.27162725367841767, 'f1-score': 0.3501276267363173, 'support': 173716}, '2': {'precision': 0.3886459931208314, 'recall': 0.4210106363509923, 'f1-score': 0.40418145402157485, 'support': 136607}, 'accuracy': 0.39437934463266644, 'macro avg': {'precision': 0.4108884969187641, 'recall': 0.40660360790504596, 'f1-score': 0.3920462150185981, 'support': 443507}, 'weighted avg': {'precision': 0.41817018197575667, 'recall': 0.39437934463266644, 'f1-score': 0.38830894526377974, 'support': 443507}}
[[70211 24757 38216]
 [74276 47186 52254]
 [55217 23877 57513]]
Evaluating performance on  train set...
765/765 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0723147
{'0': {'precision': 0.39183417872127246, 'recall': 0.483696912540004, 'f1-score': 0.43294632107717645, 'support': 64681}, '1': {'precision': 0.41931476657984373, 'recall': 0.32387761734528064, 'f1-score': 0.365468404830302, 'support': 64617}, '2': {'precision': 0.4305624990531594, 'recall': 0.4276020822676255, 'f1-score': 0.4290771843744102, 'support': 66466}, 'accuracy': 0.41189902127050937, 'macro avg': {'precision': 0.4139038147847585, 'recall': 0.4117255373843034, 'f1-score': 0.4091639700939629, 'support': 195764}, 'weighted avg': {'precision': 0.4140539417258928, 'recall': 0.41189902127050937, 'f1-score': 0.40935982634775564, 'support': 195764}}
[[31286 14646 18749]
 [24850 20928 18839]
 [23709 14336 28421]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856146
{'0': {'precision': 0.36746143057503505, 'recall': 0.5193015573383671, 'f1-score': 0.4303817271589486, 'support': 21190}, '1': {'precision': 0.4126580265564125, 'recall': 0.23476726828606323, 'f1-score': 0.2992734402029754, 'support': 22107}, '2': {'precision': 0.4009912142374409, 'recall': 0.4154801363148312, 'f1-score': 0.4081071166544388, 'support': 21421}, 'accuracy': 0.38774374980685433, 'macro avg': {'precision': 0.3937035571229628, 'recall': 0.38984965397975385, 'f1-score': 0.37925409467212096, 'support': 64718}, 'weighted avg': {'precision': 0.393998138186406, 'recall': 0.38774374980685433, 'f1-score': 0.37822382160944457, 'support': 64718}}
[[11004  3746  6440]
 [10062  5190  6855]
 [ 8880  3641  8900]]
training model: results/PCAR/W0/deepOF_L2/h100
Epoch 1/50
765/765 - 36s - loss: 3.3127 - accuracy100: 0.3546 - val_loss: 3.3380 - val_accuracy100: 0.3446 - 36s/epoch - 47ms/step
Epoch 2/50
765/765 - 33s - loss: 3.2696 - accuracy100: 0.3812 - val_loss: 3.3152 - val_accuracy100: 0.3542 - 33s/epoch - 43ms/step
Epoch 3/50
765/765 - 31s - loss: 3.2530 - accuracy100: 0.3896 - val_loss: 3.3073 - val_accuracy100: 0.3541 - 31s/epoch - 40ms/step
Epoch 4/50
765/765 - 30s - loss: 3.2435 - accuracy100: 0.3953 - val_loss: 3.3026 - val_accuracy100: 0.3562 - 30s/epoch - 40ms/step
Epoch 5/50
765/765 - 33s - loss: 3.2386 - accuracy100: 0.3975 - val_loss: 3.2969 - val_accuracy100: 0.3600 - 33s/epoch - 43ms/step
Epoch 6/50
765/765 - 30s - loss: 3.2352 - accuracy100: 0.3993 - val_loss: 3.2942 - val_accuracy100: 0.3611 - 30s/epoch - 40ms/step
Epoch 7/50
765/765 - 32s - loss: 3.2313 - accuracy100: 0.4022 - val_loss: 3.2933 - val_accuracy100: 0.3624 - 32s/epoch - 41ms/step
Epoch 8/50
765/765 - 31s - loss: 3.2281 - accuracy100: 0.4040 - val_loss: 3.2899 - val_accuracy100: 0.3645 - 31s/epoch - 41ms/step
Epoch 9/50
765/765 - 33s - loss: 3.2254 - accuracy100: 0.4048 - val_loss: 3.2890 - val_accuracy100: 0.3646 - 33s/epoch - 43ms/step
Epoch 10/50
765/765 - 33s - loss: 3.2226 - accuracy100: 0.4067 - val_loss: 3.2873 - val_accuracy100: 0.3638 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 31s - loss: 3.2204 - accuracy100: 0.4085 - val_loss: 3.2873 - val_accuracy100: 0.3655 - 31s/epoch - 40ms/step
Epoch 12/50
765/765 - 29s - loss: 3.2182 - accuracy100: 0.4101 - val_loss: 3.2884 - val_accuracy100: 0.3654 - 29s/epoch - 38ms/step
Epoch 13/50
765/765 - 32s - loss: 3.2153 - accuracy100: 0.4106 - val_loss: 3.2929 - val_accuracy100: 0.3661 - 32s/epoch - 42ms/step
Epoch 14/50
765/765 - 32s - loss: 3.2131 - accuracy100: 0.4128 - val_loss: 3.2926 - val_accuracy100: 0.3673 - 32s/epoch - 42ms/step
Epoch 15/50
765/765 - 31s - loss: 3.2104 - accuracy100: 0.4140 - val_loss: 3.2941 - val_accuracy100: 0.3669 - 31s/epoch - 40ms/step
Epoch 16/50
765/765 - 32s - loss: 3.2082 - accuracy100: 0.4153 - val_loss: 3.2948 - val_accuracy100: 0.3657 - 32s/epoch - 42ms/step
Epoch 17/50
765/765 - 33s - loss: 3.2046 - accuracy100: 0.4161 - val_loss: 3.2927 - val_accuracy100: 0.3660 - 33s/epoch - 43ms/step
Epoch 18/50
765/765 - 33s - loss: 3.2019 - accuracy100: 0.4180 - val_loss: 3.2961 - val_accuracy100: 0.3644 - 33s/epoch - 44ms/step
Epoch 19/50
765/765 - 32s - loss: 3.1999 - accuracy100: 0.4181 - val_loss: 3.2934 - val_accuracy100: 0.3668 - 32s/epoch - 42ms/step
Epoch 20/50
765/765 - 31s - loss: 3.1968 - accuracy100: 0.4204 - val_loss: 3.2986 - val_accuracy100: 0.3655 - 31s/epoch - 40ms/step
Epoch 21/50
765/765 - 30s - loss: 3.1939 - accuracy100: 0.4224 - val_loss: 3.3032 - val_accuracy100: 0.3650 - 30s/epoch - 39ms/step
testing model: results/PCAR/W0/deepOF_L2/h100
Evaluating performance on  test set...
1733/1733 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0947912
{'0': {'precision': 0.348658622911182, 'recall': 0.610953157447283, 'f1-score': 0.4439588819120924, 'support': 143502}, '1': {'precision': 0.41419986645893614, 'recall': 0.1724379848039605, 'f1-score': 0.24350215426600744, 'support': 151092}, '2': {'precision': 0.3887198308903807, 'recall': 0.33712301813810747, 'f1-score': 0.3610875350643746, 'support': 148913}, 'accuracy': 0.3696198707122999, 'macro avg': {'precision': 0.3838594400868329, 'recall': 0.37350472012978364, 'f1-score': 0.34951619041415816, 'support': 443507}, 'weighted avg': {'precision': 0.3844379730317521, 'recall': 0.3696198707122999, 'f1-score': 0.347843084942402, 'support': 443507}}
[[87673 18254 37575]
 [83668 26054 41370]
 [80117 18594 50202]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0839517
{'0': {'precision': 0.3616868449157428, 'recall': 0.5956171888375278, 'f1-score': 0.4500699761257924, 'support': 64251}, '1': {'precision': 0.4287764950216847, 'recall': 0.21729507181773156, 'f1-score': 0.2884232152028762, 'support': 64608}, '2': {'precision': 0.4090710478021498, 'recall': 0.3498243778491891, 'f1-score': 0.37713503061553333, 'support': 66905}, 'accuracy': 0.38675650272777423, 'macro avg': {'precision': 0.3998447959131924, 'recall': 0.3875788795014828, 'f1-score': 0.37187607398140066, 'support': 195764}, 'weighted avg': {'precision': 0.400022638055236, 'recall': 0.38675650272777423, 'f1-score': 0.371795183727437, 'support': 195764}}
[[38269  9127 16855]
 [33614 14039 16955]
 [33924  9576 23405]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0957516
{'0': {'precision': 0.3512783865332698, 'recall': 0.6200710147635956, 'f1-score': 0.4484844388875748, 'support': 21404}, '1': {'precision': 0.4072164948453608, 'recall': 0.15165920102385957, 'f1-score': 0.2210084593352428, 'support': 21878}, '2': {'precision': 0.3814136682989142, 'recall': 0.33429744355290164, 'f1-score': 0.35630469371519496, 'support': 21436}, 'accuracy': 0.3670694397231064, 'macro avg': {'precision': 0.37996951655918165, 'recall': 0.3686758864467856, 'f1-score': 0.34193253064600415, 'support': 64718}, 'weighted avg': {'precision': 0.38016978975308935, 'recall': 0.3670694397231064, 'f1-score': 0.34105397907483254, 'support': 64718}}
[[13272  2377  5755]
 [12693  3318  5867]
 [11817  2453  7166]]
training model: results/PCAR/W0/deepOF_L2/h200
Epoch 1/50
765/765 - 34s - loss: 3.3158 - accuracy200: 0.3583 - val_loss: 3.3382 - val_accuracy200: 0.3343 - 34s/epoch - 44ms/step
Epoch 2/50
765/765 - 30s - loss: 3.2697 - accuracy200: 0.3761 - val_loss: 3.3262 - val_accuracy200: 0.3413 - 30s/epoch - 40ms/step
Epoch 3/50
765/765 - 32s - loss: 3.2494 - accuracy200: 0.3860 - val_loss: 3.3134 - val_accuracy200: 0.3438 - 32s/epoch - 42ms/step
Epoch 4/50
765/765 - 32s - loss: 3.2421 - accuracy200: 0.3921 - val_loss: 3.3040 - val_accuracy200: 0.3449 - 32s/epoch - 41ms/step
Epoch 5/50
765/765 - 33s - loss: 3.2386 - accuracy200: 0.3944 - val_loss: 3.2957 - val_accuracy200: 0.3457 - 33s/epoch - 44ms/step
Epoch 6/50
765/765 - 35s - loss: 3.2370 - accuracy200: 0.3949 - val_loss: 3.2894 - val_accuracy200: 0.3517 - 35s/epoch - 45ms/step
Epoch 7/50
765/765 - 34s - loss: 3.2354 - accuracy200: 0.3953 - val_loss: 3.2863 - val_accuracy200: 0.3511 - 34s/epoch - 44ms/step
Epoch 8/50
765/765 - 35s - loss: 3.2342 - accuracy200: 0.3960 - val_loss: 3.2851 - val_accuracy200: 0.3526 - 35s/epoch - 45ms/step
Epoch 9/50
765/765 - 34s - loss: 3.2339 - accuracy200: 0.3970 - val_loss: 3.2836 - val_accuracy200: 0.3557 - 34s/epoch - 45ms/step
Epoch 10/50
765/765 - 33s - loss: 3.2317 - accuracy200: 0.3973 - val_loss: 3.2825 - val_accuracy200: 0.3584 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 35s - loss: 3.2316 - accuracy200: 0.3974 - val_loss: 3.2838 - val_accuracy200: 0.3567 - 35s/epoch - 46ms/step
Epoch 12/50
765/765 - 29s - loss: 3.2306 - accuracy200: 0.3981 - val_loss: 3.2835 - val_accuracy200: 0.3586 - 29s/epoch - 38ms/step
Epoch 13/50
765/765 - 31s - loss: 3.2281 - accuracy200: 0.4004 - val_loss: 3.2809 - val_accuracy200: 0.3598 - 31s/epoch - 40ms/step
Epoch 14/50
765/765 - 35s - loss: 3.2276 - accuracy200: 0.4024 - val_loss: 3.2830 - val_accuracy200: 0.3624 - 35s/epoch - 46ms/step
Epoch 15/50
765/765 - 32s - loss: 3.2260 - accuracy200: 0.4013 - val_loss: 3.2810 - val_accuracy200: 0.3643 - 32s/epoch - 41ms/step
Epoch 16/50
765/765 - 34s - loss: 3.2235 - accuracy200: 0.4038 - val_loss: 3.2805 - val_accuracy200: 0.3664 - 34s/epoch - 45ms/step
Epoch 17/50
765/765 - 32s - loss: 3.2213 - accuracy200: 0.4050 - val_loss: 3.2806 - val_accuracy200: 0.3652 - 32s/epoch - 42ms/step
Epoch 18/50
765/765 - 31s - loss: 3.2180 - accuracy200: 0.4077 - val_loss: 3.2778 - val_accuracy200: 0.3679 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 30s - loss: 3.2163 - accuracy200: 0.4082 - val_loss: 3.2789 - val_accuracy200: 0.3694 - 30s/epoch - 40ms/step
Epoch 20/50
765/765 - 33s - loss: 3.2150 - accuracy200: 0.4098 - val_loss: 3.2794 - val_accuracy200: 0.3692 - 33s/epoch - 43ms/step
Epoch 21/50
765/765 - 31s - loss: 3.2121 - accuracy200: 0.4105 - val_loss: 3.2805 - val_accuracy200: 0.3690 - 31s/epoch - 41ms/step
Epoch 22/50
765/765 - 30s - loss: 3.2093 - accuracy200: 0.4127 - val_loss: 3.2821 - val_accuracy200: 0.3680 - 30s/epoch - 40ms/step
Epoch 23/50
765/765 - 32s - loss: 3.2062 - accuracy200: 0.4148 - val_loss: 3.2817 - val_accuracy200: 0.3706 - 32s/epoch - 41ms/step
Epoch 24/50
765/765 - 32s - loss: 3.2039 - accuracy200: 0.4163 - val_loss: 3.2852 - val_accuracy200: 0.3682 - 32s/epoch - 42ms/step
Epoch 25/50
765/765 - 33s - loss: 3.2003 - accuracy200: 0.4187 - val_loss: 3.2866 - val_accuracy200: 0.3706 - 33s/epoch - 43ms/step
Epoch 26/50
765/765 - 31s - loss: 3.1983 - accuracy200: 0.4198 - val_loss: 3.2873 - val_accuracy200: 0.3704 - 31s/epoch - 40ms/step
Epoch 27/50
765/765 - 33s - loss: 3.1953 - accuracy200: 0.4210 - val_loss: 3.2892 - val_accuracy200: 0.3707 - 33s/epoch - 43ms/step
Epoch 28/50
765/765 - 37s - loss: 3.1921 - accuracy200: 0.4235 - val_loss: 3.2900 - val_accuracy200: 0.3700 - 37s/epoch - 48ms/step
testing model: results/PCAR/W0/deepOF_L2/h200
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0920283
{'0': {'precision': 0.3268184702423335, 'recall': 0.4934436180404719, 'f1-score': 0.39320722169772837, 'support': 136737}, '1': {'precision': 0.4353187315114265, 'recall': 0.34923455272056564, 'f1-score': 0.38755389989629385, 'support': 162650}, '2': {'precision': 0.3764567889649995, 'recall': 0.2783721898417985, 'f1-score': 0.32006861063464837, 'support': 144120}, 'accuracy': 0.37066833217964995, 'macro avg': {'precision': 0.37953133023958646, 'recall': 0.37368345353427873, 'f1-score': 0.36694324407622353, 'support': 443507}, 'weighted avg': {'precision': 0.3827396665024345, 'recall': 0.37066833217964995, 'f1-score': 0.36736715735282643, 'support': 443507}}
[[67472 36721 32544]
 [71940 56803 33907]
 [67039 36962 40119]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.08124
{'0': {'precision': 0.36796123543912224, 'recall': 0.4775803390787472, 'f1-score': 0.4156650764075159, 'support': 63761}, '1': {'precision': 0.4135444812090913, 'recall': 0.44332403965303596, 'f1-score': 0.42791678191509247, 'support': 64560}, '2': {'precision': 0.41841137925523414, 'recall': 0.27172575359933576, 'f1-score': 0.32947987270994766, 'support': 67443}, 'accuracy': 0.39536380539833677, 'macro avg': {'precision': 0.39997236530114927, 'recall': 0.3975433774437063, 'f1-score': 0.39102057701085197, 'support': 195764}, 'weighted avg': {'precision': 0.400374566778384, 'recall': 0.39536380539833677, 'f1-score': 0.39001368705397815, 'support': 195764}}
[[30451 19272 14038]
 [24504 28621 11435]
 [27801 21316 18326]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0930283
{'0': {'precision': 0.34273473759371653, 'recall': 0.5017580537869429, 'f1-score': 0.40727384923925414, 'support': 21046}, '1': {'precision': 0.4016384548611111, 'recall': 0.3312897162803186, 'f1-score': 0.3630879395752612, 'support': 22346}, '2': {'precision': 0.3711793214862682, 'recall': 0.26934258651411425, 'f1-score': 0.3121654302872205, 'support': 21326}, 'accuracy': 0.3663123087858092, 'macro avg': {'precision': 0.3718508379803653, 'recall': 0.3674634521937919, 'f1-score': 0.3608424063672453, 'support': 64718}, 'weighted avg': {'precision': 0.37244628093791377, 'recall': 0.3663123087858092, 'f1-score': 0.3606769136120306, 'support': 64718}}
[[10560  5419  5067]
 [10279  7403  4664]
 [ 9972  5610  5744]]
training model: results/PCAR/W0/deepOF_L2/h300
Epoch 1/50
765/765 - 35s - loss: 3.3151 - accuracy300: 0.3566 - val_loss: 3.3680 - val_accuracy300: 0.3348 - 35s/epoch - 46ms/step
Epoch 2/50
765/765 - 32s - loss: 3.2608 - accuracy300: 0.3853 - val_loss: 3.3536 - val_accuracy300: 0.3369 - 32s/epoch - 42ms/step
Epoch 3/50
765/765 - 31s - loss: 3.2456 - accuracy300: 0.3911 - val_loss: 3.3316 - val_accuracy300: 0.3400 - 31s/epoch - 40ms/step
Epoch 4/50
765/765 - 32s - loss: 3.2362 - accuracy300: 0.3962 - val_loss: 3.3220 - val_accuracy300: 0.3431 - 32s/epoch - 42ms/step
Epoch 5/50
765/765 - 35s - loss: 3.2327 - accuracy300: 0.3975 - val_loss: 3.3143 - val_accuracy300: 0.3436 - 35s/epoch - 46ms/step
Epoch 6/50
765/765 - 34s - loss: 3.2296 - accuracy300: 0.3998 - val_loss: 3.3116 - val_accuracy300: 0.3449 - 34s/epoch - 44ms/step
Epoch 7/50
765/765 - 32s - loss: 3.2266 - accuracy300: 0.4029 - val_loss: 3.3081 - val_accuracy300: 0.3479 - 32s/epoch - 41ms/step
Epoch 8/50
765/765 - 32s - loss: 3.2238 - accuracy300: 0.4039 - val_loss: 3.3054 - val_accuracy300: 0.3495 - 32s/epoch - 42ms/step
Epoch 9/50
765/765 - 33s - loss: 3.2213 - accuracy300: 0.4052 - val_loss: 3.3063 - val_accuracy300: 0.3489 - 33s/epoch - 43ms/step
Epoch 10/50
765/765 - 31s - loss: 3.2193 - accuracy300: 0.4060 - val_loss: 3.3011 - val_accuracy300: 0.3516 - 31s/epoch - 41ms/step
Epoch 11/50
765/765 - 31s - loss: 3.2160 - accuracy300: 0.4087 - val_loss: 3.3022 - val_accuracy300: 0.3513 - 31s/epoch - 41ms/step
Epoch 12/50
765/765 - 32s - loss: 3.2146 - accuracy300: 0.4097 - val_loss: 3.2968 - val_accuracy300: 0.3546 - 32s/epoch - 41ms/step
Epoch 13/50
765/765 - 32s - loss: 3.2116 - accuracy300: 0.4109 - val_loss: 3.2965 - val_accuracy300: 0.3566 - 32s/epoch - 42ms/step
Epoch 14/50
765/765 - 32s - loss: 3.2093 - accuracy300: 0.4122 - val_loss: 3.2996 - val_accuracy300: 0.3530 - 32s/epoch - 41ms/step
Epoch 15/50
765/765 - 35s - loss: 3.2072 - accuracy300: 0.4146 - val_loss: 3.2994 - val_accuracy300: 0.3553 - 35s/epoch - 45ms/step
Epoch 16/50
765/765 - 31s - loss: 3.2051 - accuracy300: 0.4155 - val_loss: 3.2993 - val_accuracy300: 0.3540 - 31s/epoch - 41ms/step
Epoch 17/50
765/765 - 32s - loss: 3.2029 - accuracy300: 0.4155 - val_loss: 3.3051 - val_accuracy300: 0.3540 - 32s/epoch - 42ms/step
Epoch 18/50
765/765 - 32s - loss: 3.2009 - accuracy300: 0.4184 - val_loss: 3.2959 - val_accuracy300: 0.3581 - 32s/epoch - 42ms/step
Epoch 19/50
765/765 - 30s - loss: 3.1997 - accuracy300: 0.4176 - val_loss: 3.2981 - val_accuracy300: 0.3582 - 30s/epoch - 40ms/step
Epoch 20/50
765/765 - 32s - loss: 3.1963 - accuracy300: 0.4203 - val_loss: 3.2989 - val_accuracy300: 0.3589 - 32s/epoch - 42ms/step
Epoch 21/50
765/765 - 33s - loss: 3.1941 - accuracy300: 0.4202 - val_loss: 3.2983 - val_accuracy300: 0.3602 - 33s/epoch - 43ms/step
Epoch 22/50
765/765 - 31s - loss: 3.1917 - accuracy300: 0.4206 - val_loss: 3.2969 - val_accuracy300: 0.3606 - 31s/epoch - 40ms/step
Epoch 23/50
765/765 - 33s - loss: 3.1899 - accuracy300: 0.4227 - val_loss: 3.2984 - val_accuracy300: 0.3620 - 33s/epoch - 43ms/step
Epoch 24/50
765/765 - 32s - loss: 3.1875 - accuracy300: 0.4244 - val_loss: 3.2945 - val_accuracy300: 0.3663 - 32s/epoch - 41ms/step
Epoch 25/50
765/765 - 34s - loss: 3.1847 - accuracy300: 0.4230 - val_loss: 3.2987 - val_accuracy300: 0.3635 - 34s/epoch - 44ms/step
Epoch 26/50
765/765 - 34s - loss: 3.1810 - accuracy300: 0.4263 - val_loss: 3.2977 - val_accuracy300: 0.3652 - 34s/epoch - 45ms/step
Epoch 27/50
765/765 - 34s - loss: 3.1792 - accuracy300: 0.4267 - val_loss: 3.2986 - val_accuracy300: 0.3642 - 34s/epoch - 45ms/step
Epoch 28/50
765/765 - 33s - loss: 3.1747 - accuracy300: 0.4284 - val_loss: 3.3084 - val_accuracy300: 0.3615 - 33s/epoch - 43ms/step
Epoch 29/50
765/765 - 39s - loss: 3.1731 - accuracy300: 0.4299 - val_loss: 3.2996 - val_accuracy300: 0.3665 - 39s/epoch - 51ms/step
Epoch 30/50
765/765 - 34s - loss: 3.1697 - accuracy300: 0.4319 - val_loss: 3.3111 - val_accuracy300: 0.3646 - 34s/epoch - 44ms/step
Epoch 31/50
765/765 - 34s - loss: 3.1678 - accuracy300: 0.4306 - val_loss: 3.3080 - val_accuracy300: 0.3623 - 34s/epoch - 44ms/step
Epoch 32/50
765/765 - 31s - loss: 3.1657 - accuracy300: 0.4324 - val_loss: 3.3113 - val_accuracy300: 0.3680 - 31s/epoch - 41ms/step
Epoch 33/50
765/765 - 30s - loss: 3.1682 - accuracy300: 0.4318 - val_loss: 3.3065 - val_accuracy300: 0.3656 - 30s/epoch - 39ms/step
Epoch 34/50
765/765 - 33s - loss: 3.1603 - accuracy300: 0.4354 - val_loss: 3.3156 - val_accuracy300: 0.3649 - 33s/epoch - 43ms/step
testing model: results/PCAR/W0/deepOF_L2/h300
Evaluating performance on  test set...
1733/1733 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.099802
{'0': {'precision': 0.3453862569355527, 'recall': 0.5475310897305782, 'f1-score': 0.4235771974728996, 'support': 147798}, '1': {'precision': 0.3730127956572315, 'recall': 0.26209527087097423, 'f1-score': 0.30786851834696266, 'support': 139476}, '2': {'precision': 0.38931702711209026, 'recall': 0.2771117497583737, 'f1-score': 0.323768499614864, 'support': 156233}, 'accuracy': 0.3625061160252262, 'macro avg': {'precision': 0.3692386932349581, 'recall': 0.362246036786642, 'f1-score': 0.35173807181157546, 'support': 443507}, 'weighted avg': {'precision': 0.36954974281454867, 'recall': 0.3625061160252262, 'f1-score': 0.352029294007512, 'support': 443507}}
[[80924 30843 36031]
 [71040 36556 31880]
 [82336 30603 43294]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0734628
{'0': {'precision': 0.37012655354406676, 'recall': 0.5137779458335303, 'f1-score': 0.4302791998733309, 'support': 63471}, '1': {'precision': 0.438624889814889, 'recall': 0.4233125038668564, 'f1-score': 0.43083268396735075, 'support': 64652}, '2': {'precision': 0.4215933191940615, 'recall': 0.28212179003858606, 'f1-score': 0.33803640228510695, 'support': 67641}, 'accuracy': 0.40385872785598986, 'macro avg': {'precision': 0.41011492085100576, 'recall': 0.40640407991299093, 'f1-score': 0.3997160953752629, 'support': 195764}, 'weighted avg': {'precision': 0.41053141823784345, 'recall': 0.40385872785598986, 'f1-score': 0.3985899658056858, 'support': 195764}}
[[32610 16537 14324]
 [25427 27368 11857]
 [30068 18490 19083]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980607
{'0': {'precision': 0.3425176210170676, 'recall': 0.5579012287110394, 'f1-score': 0.4244491364842185, 'support': 21079}, '1': {'precision': 0.4190880643719267, 'recall': 0.256170871664086, 'f1-score': 0.31797625777275296, 'support': 21958}, '2': {'precision': 0.3680580120268836, 'recall': 0.2879479728794797, 'f1-score': 0.32311155966151694, 'support': 21681}, 'accuracy': 0.36509162829506475, 'macro avg': {'precision': 0.3765545658052926, 'recall': 0.3673400244182017, 'f1-score': 0.35517898463949615, 'support': 64718}, 'weighted avg': {'precision': 0.377053221818542, 'recall': 0.36509162829506475, 'f1-score': 0.35437540933196787, 'support': 64718}}
[[11760  3669  5650]
 [11264  5625  5069]
 [11310  4128  6243]]
training model: results/PCAR/W0/deepOF_L2/h500
Epoch 1/50
765/765 - 38s - loss: 3.3262 - accuracy500: 0.3474 - val_loss: 3.3321 - val_accuracy500: 0.3306 - 38s/epoch - 50ms/step
Epoch 2/50
765/765 - 33s - loss: 3.2830 - accuracy500: 0.3687 - val_loss: 3.3247 - val_accuracy500: 0.3319 - 33s/epoch - 44ms/step
Epoch 3/50
765/765 - 33s - loss: 3.2669 - accuracy500: 0.3777 - val_loss: 3.3147 - val_accuracy500: 0.3359 - 33s/epoch - 43ms/step
Epoch 4/50
765/765 - 33s - loss: 3.2597 - accuracy500: 0.3819 - val_loss: 3.3064 - val_accuracy500: 0.3373 - 33s/epoch - 43ms/step
Epoch 5/50
765/765 - 34s - loss: 3.2557 - accuracy500: 0.3840 - val_loss: 3.3012 - val_accuracy500: 0.3414 - 34s/epoch - 44ms/step
Epoch 6/50
765/765 - 32s - loss: 3.2520 - accuracy500: 0.3878 - val_loss: 3.3048 - val_accuracy500: 0.3410 - 32s/epoch - 42ms/step
Epoch 7/50
765/765 - 33s - loss: 3.2493 - accuracy500: 0.3890 - val_loss: 3.2979 - val_accuracy500: 0.3438 - 33s/epoch - 43ms/step
Epoch 8/50
765/765 - 31s - loss: 3.2472 - accuracy500: 0.3907 - val_loss: 3.2969 - val_accuracy500: 0.3446 - 31s/epoch - 41ms/step
Epoch 9/50
765/765 - 35s - loss: 3.2456 - accuracy500: 0.3916 - val_loss: 3.2923 - val_accuracy500: 0.3481 - 35s/epoch - 46ms/step
Epoch 10/50
765/765 - 34s - loss: 3.2433 - accuracy500: 0.3935 - val_loss: 3.2922 - val_accuracy500: 0.3506 - 34s/epoch - 44ms/step
Epoch 11/50
765/765 - 35s - loss: 3.2418 - accuracy500: 0.3954 - val_loss: 3.2909 - val_accuracy500: 0.3518 - 35s/epoch - 45ms/step
Epoch 12/50
765/765 - 32s - loss: 3.2396 - accuracy500: 0.3958 - val_loss: 3.2919 - val_accuracy500: 0.3508 - 32s/epoch - 42ms/step
Epoch 13/50
765/765 - 31s - loss: 3.2371 - accuracy500: 0.3981 - val_loss: 3.2923 - val_accuracy500: 0.3495 - 31s/epoch - 40ms/step
Epoch 14/50
765/765 - 30s - loss: 3.2359 - accuracy500: 0.3981 - val_loss: 3.2910 - val_accuracy500: 0.3515 - 30s/epoch - 39ms/step
Epoch 15/50
765/765 - 31s - loss: 3.2340 - accuracy500: 0.4005 - val_loss: 3.2914 - val_accuracy500: 0.3545 - 31s/epoch - 41ms/step
Epoch 16/50
765/765 - 32s - loss: 3.2326 - accuracy500: 0.4007 - val_loss: 3.2914 - val_accuracy500: 0.3540 - 32s/epoch - 42ms/step
Epoch 17/50
765/765 - 32s - loss: 3.2302 - accuracy500: 0.4034 - val_loss: 3.2919 - val_accuracy500: 0.3544 - 32s/epoch - 42ms/step
Epoch 18/50
765/765 - 31s - loss: 3.2266 - accuracy500: 0.4062 - val_loss: 3.2924 - val_accuracy500: 0.3546 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 31s - loss: 3.2261 - accuracy500: 0.4052 - val_loss: 3.2960 - val_accuracy500: 0.3530 - 31s/epoch - 40ms/step
Epoch 20/50
765/765 - 36s - loss: 3.2242 - accuracy500: 0.4072 - val_loss: 3.2953 - val_accuracy500: 0.3549 - 36s/epoch - 47ms/step
Epoch 21/50
765/765 - 33s - loss: 3.2226 - accuracy500: 0.4072 - val_loss: 3.2950 - val_accuracy500: 0.3552 - 33s/epoch - 43ms/step
testing model: results/PCAR/W0/deepOF_L2/h500
Evaluating performance on  test set...
1733/1733 - 27s - 27s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098389
{'0': {'precision': 0.3370030235738392, 'recall': 0.3732500538444971, 'f1-score': 0.35420162388288007, 'support': 143933}, '1': {'precision': 0.3566581938113144, 'recall': 0.2331022173405643, 'f1-score': 0.28193759444693534, 'support': 145670}, '2': {'precision': 0.3602947794183824, 'recall': 0.4421912360952282, 'f1-score': 0.39706410028267947, 'support': 153904}, 'accuracy': 0.35114214657265835, 'macro avg': {'precision': 0.35131866560117864, 'recall': 0.3495145024267632, 'f1-score': 0.344401106204165, 'support': 443507}, 'weighted avg': {'precision': 0.3515413804430466, 'recall': 0.35114214657265835, 'f1-score': 0.3453404455923472, 'support': 443507}}
[[53723 30104 60106]
 [50988 33956 60726]
 [54703 31146 68055]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0873891
{'0': {'precision': 0.3518847823649092, 'recall': 0.35662677988667174, 'f1-score': 0.3542399122665548, 'support': 61591}, '1': {'precision': 0.4051674565247566, 'recall': 0.3081435680892776, 'f1-score': 0.35005696370598166, 'support': 66310}, '2': {'precision': 0.37733983018139716, 'recall': 0.4610170490547132, 'f1-score': 0.41500248714972643, 'support': 67863}, 'accuracy': 0.37639198218262804, 'macro avg': {'precision': 0.3781306896903544, 'recall': 0.3752624656768875, 'f1-score': 0.37309978770742097, 'support': 195764}, 'weighted avg': {'precision': 0.3787570879650696, 'recall': 0.37639198218262804, 'f1-score': 0.37388683049587723, 'support': 195764}}
[[21965 14431 25195]
 [19446 20433 26431]
 [21010 15567 31286]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967262
{'0': {'precision': 0.33364810919860927, 'recall': 0.3754165660468486, 'f1-score': 0.3533021226307895, 'support': 20705}, '1': {'precision': 0.4004428407413482, 'recall': 0.2168487432276401, 'f1-score': 0.28134362756395487, 'support': 22518}, '2': {'precision': 0.3422178122968488, 'recall': 0.4653175157013259, 'f1-score': 0.39438507945270296, 'support': 21495}, 'accuracy': 0.35010352606693657, 'macro avg': {'precision': 0.3587695874122687, 'recall': 0.3525276083252715, 'f1-score': 0.3430102765491491, 'support': 64718}, 'weighted avg': {'precision': 0.3597349711686339, 'recall': 0.35010352606693657, 'f1-score': 0.34190987881874413, 'support': 64718}}
[[ 7773  3519  9413]
 [ 7823  4883  9812]
 [ 7701  3792 10002]]
training model: results/PCAR/W0/deepOF_L2/h1000
Epoch 1/50
765/765 - 36s - loss: 3.3331 - accuracy1000: 0.3459 - val_loss: 3.3877 - val_accuracy1000: 0.3297 - 36s/epoch - 47ms/step
Epoch 2/50
765/765 - 32s - loss: 3.2888 - accuracy1000: 0.3681 - val_loss: 3.3705 - val_accuracy1000: 0.3326 - 32s/epoch - 42ms/step
Epoch 3/50
765/765 - 36s - loss: 3.2699 - accuracy1000: 0.3788 - val_loss: 3.3619 - val_accuracy1000: 0.3332 - 36s/epoch - 47ms/step
Epoch 4/50
765/765 - 34s - loss: 3.2620 - accuracy1000: 0.3831 - val_loss: 3.3505 - val_accuracy1000: 0.3329 - 34s/epoch - 45ms/step
Epoch 5/50
765/765 - 33s - loss: 3.2572 - accuracy1000: 0.3847 - val_loss: 3.3356 - val_accuracy1000: 0.3357 - 33s/epoch - 43ms/step
Epoch 6/50
765/765 - 33s - loss: 3.2538 - accuracy1000: 0.3877 - val_loss: 3.3314 - val_accuracy1000: 0.3358 - 33s/epoch - 44ms/step
Epoch 7/50
765/765 - 30s - loss: 3.2512 - accuracy1000: 0.3886 - val_loss: 3.3247 - val_accuracy1000: 0.3358 - 30s/epoch - 40ms/step
Epoch 8/50
765/765 - 31s - loss: 3.2485 - accuracy1000: 0.3900 - val_loss: 3.3256 - val_accuracy1000: 0.3372 - 31s/epoch - 40ms/step
Epoch 9/50
765/765 - 32s - loss: 3.2471 - accuracy1000: 0.3911 - val_loss: 3.3208 - val_accuracy1000: 0.3375 - 32s/epoch - 42ms/step
Epoch 10/50
765/765 - 33s - loss: 3.2448 - accuracy1000: 0.3928 - val_loss: 3.3213 - val_accuracy1000: 0.3373 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 34s - loss: 3.2437 - accuracy1000: 0.3931 - val_loss: 3.3200 - val_accuracy1000: 0.3382 - 34s/epoch - 45ms/step
Epoch 12/50
765/765 - 37s - loss: 3.2412 - accuracy1000: 0.3954 - val_loss: 3.3175 - val_accuracy1000: 0.3395 - 37s/epoch - 48ms/step
Epoch 13/50
765/765 - 32s - loss: 3.2399 - accuracy1000: 0.3967 - val_loss: 3.3172 - val_accuracy1000: 0.3406 - 32s/epoch - 42ms/step
Epoch 14/50
765/765 - 31s - loss: 3.2380 - accuracy1000: 0.3972 - val_loss: 3.3167 - val_accuracy1000: 0.3418 - 31s/epoch - 41ms/step
Epoch 15/50
765/765 - 33s - loss: 3.2364 - accuracy1000: 0.3987 - val_loss: 3.3161 - val_accuracy1000: 0.3428 - 33s/epoch - 43ms/step
Epoch 16/50
765/765 - 34s - loss: 3.2343 - accuracy1000: 0.4003 - val_loss: 3.3189 - val_accuracy1000: 0.3414 - 34s/epoch - 44ms/step
Epoch 17/50
765/765 - 34s - loss: 3.2329 - accuracy1000: 0.4018 - val_loss: 3.3187 - val_accuracy1000: 0.3413 - 34s/epoch - 44ms/step
Epoch 18/50
765/765 - 33s - loss: 3.2307 - accuracy1000: 0.4030 - val_loss: 3.3192 - val_accuracy1000: 0.3442 - 33s/epoch - 43ms/step
Epoch 19/50
765/765 - 32s - loss: 3.2286 - accuracy1000: 0.4037 - val_loss: 3.3188 - val_accuracy1000: 0.3475 - 32s/epoch - 42ms/step
Epoch 20/50
765/765 - 32s - loss: 3.2256 - accuracy1000: 0.4045 - val_loss: 3.3199 - val_accuracy1000: 0.3455 - 32s/epoch - 42ms/step
Epoch 21/50
765/765 - 32s - loss: 3.2245 - accuracy1000: 0.4057 - val_loss: 3.3215 - val_accuracy1000: 0.3476 - 32s/epoch - 42ms/step
Epoch 22/50
765/765 - 32s - loss: 3.2220 - accuracy1000: 0.4076 - val_loss: 3.3212 - val_accuracy1000: 0.3491 - 32s/epoch - 41ms/step
Epoch 23/50
765/765 - 32s - loss: 3.2207 - accuracy1000: 0.4082 - val_loss: 3.3230 - val_accuracy1000: 0.3486 - 32s/epoch - 41ms/step
Epoch 24/50
765/765 - 31s - loss: 3.2176 - accuracy1000: 0.4100 - val_loss: 3.3231 - val_accuracy1000: 0.3515 - 31s/epoch - 40ms/step
Epoch 25/50
765/765 - 31s - loss: 3.2150 - accuracy1000: 0.4106 - val_loss: 3.3243 - val_accuracy1000: 0.3505 - 31s/epoch - 41ms/step
testing model: results/PCAR/W0/deepOF_L2/h1000
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014737
{'0': {'precision': 0.3361040149464293, 'recall': 0.12541794123924024, 'f1-score': 0.18267158488063662, 'support': 140570}, '1': {'precision': 0.3474835886214442, 'recall': 0.16840448823207443, 'f1-score': 0.22686237010069357, 'support': 146160}, '2': {'precision': 0.3526004159666227, 'recall': 0.720188548065086, 'f1-score': 0.47341796035597855, 'support': 156777}, 'accuracy': 0.3498321334274318, 'macro avg': {'precision': 0.3453960065114987, 'recall': 0.3380036591788002, 'f1-score': 0.2943173051124362, 'support': 443507}, 'weighted avg': {'precision': 0.3456855880694759, 'recall': 0.3498321334274318, 'f1-score': 0.3000119417987038, 'support': 443507}}
[[ 17630  22046 100894]
 [ 15131  24614 106415]
 [ 19693  24175 112909]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0851773
{'0': {'precision': 0.38645356101624323, 'recall': 0.12238874874280721, 'f1-score': 0.1859026534266645, 'support': 60651}, '1': {'precision': 0.4144735162731334, 'recall': 0.2462688830916702, 'f1-score': 0.3089613441540525, 'support': 65932}, '2': {'precision': 0.3677000458578697, 'recall': 0.730186033737587, 'f1-score': 0.4891025454827122, 'support': 69181}, 'accuracy': 0.3789001042071065, 'macro avg': {'precision': 0.3895423743824154, 'recall': 0.3662812218573548, 'f1-score': 0.3279888476878097, 'support': 195764}, 'weighted avg': {'precision': 0.38926319280669414, 'recall': 0.3789001042071065, 'f1-score': 0.33449574168276663, 'support': 195764}}
[[ 7423 10985 42243]
 [ 5072 16237 44623]
 [ 6713 11953 50515]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015053
{'0': {'precision': 0.35344464711659884, 'recall': 0.12100105677778845, 'f1-score': 0.1802826981570943, 'support': 20818}, '1': {'precision': 0.3825753424657534, 'recall': 0.15589693207698835, 'f1-score': 0.2215242083888572, 'support': 22393}, '2': {'precision': 0.3327693640902901, 'recall': 0.7498953828985911, 'f1-score': 0.4609778057250654, 'support': 21507}, 'accuracy': 0.3420686671405173, 'macro avg': {'precision': 0.35626311789088083, 'recall': 0.34226445725112264, 'f1-score': 0.287594904090339, 'support': 64718}, 'weighted avg': {'precision': 0.35665334251674713, 'recall': 0.3420686671405173, 'f1-score': 0.28783285139242637, 'support': 64718}}
[[ 2519  2702 15597]
 [ 2161  3491 16741]
 [ 2447  2932 16128]]
training model: results/PCAR/W0/deepVOL_L2/h10
Epoch 1/50
765/765 - 39s - loss: 3.2446 - accuracy10: 0.4039 - val_loss: 3.2318 - val_accuracy10: 0.4081 - 39s/epoch - 51ms/step
Epoch 2/50
765/765 - 32s - loss: 3.1103 - accuracy10: 0.4599 - val_loss: 3.1770 - val_accuracy10: 0.4340 - 32s/epoch - 41ms/step
Epoch 3/50
765/765 - 33s - loss: 3.0685 - accuracy10: 0.4784 - val_loss: 3.1635 - val_accuracy10: 0.4397 - 33s/epoch - 44ms/step
Epoch 4/50
765/765 - 30s - loss: 3.0503 - accuracy10: 0.4831 - val_loss: 3.1607 - val_accuracy10: 0.4406 - 30s/epoch - 40ms/step
Epoch 5/50
765/765 - 32s - loss: 3.0349 - accuracy10: 0.4886 - val_loss: 3.1406 - val_accuracy10: 0.4495 - 32s/epoch - 42ms/step
Epoch 6/50
765/765 - 32s - loss: 3.0226 - accuracy10: 0.4922 - val_loss: 3.1320 - val_accuracy10: 0.4535 - 32s/epoch - 42ms/step
Epoch 7/50
765/765 - 32s - loss: 3.0136 - accuracy10: 0.4950 - val_loss: 3.1045 - val_accuracy10: 0.4650 - 32s/epoch - 41ms/step
Epoch 8/50
765/765 - 31s - loss: 3.0022 - accuracy10: 0.4983 - val_loss: 3.0934 - val_accuracy10: 0.4690 - 31s/epoch - 40ms/step
Epoch 9/50
765/765 - 35s - loss: 2.9928 - accuracy10: 0.5011 - val_loss: 3.0872 - val_accuracy10: 0.4679 - 35s/epoch - 45ms/step
Epoch 10/50
765/765 - 34s - loss: 2.9819 - accuracy10: 0.5042 - val_loss: 3.0714 - val_accuracy10: 0.4760 - 34s/epoch - 45ms/step
Epoch 11/50
765/765 - 34s - loss: 2.9747 - accuracy10: 0.5060 - val_loss: 3.0720 - val_accuracy10: 0.4743 - 34s/epoch - 44ms/step
Epoch 12/50
765/765 - 33s - loss: 2.9693 - accuracy10: 0.5076 - val_loss: 3.0545 - val_accuracy10: 0.4808 - 33s/epoch - 43ms/step
Epoch 13/50
765/765 - 35s - loss: 2.9624 - accuracy10: 0.5087 - val_loss: 3.0554 - val_accuracy10: 0.4809 - 35s/epoch - 46ms/step
Epoch 14/50
765/765 - 33s - loss: 2.9568 - accuracy10: 0.5107 - val_loss: 3.0540 - val_accuracy10: 0.4807 - 33s/epoch - 44ms/step
Epoch 15/50
765/765 - 32s - loss: 2.9530 - accuracy10: 0.5113 - val_loss: 3.0485 - val_accuracy10: 0.4834 - 32s/epoch - 42ms/step
Epoch 16/50
765/765 - 31s - loss: 2.9468 - accuracy10: 0.5123 - val_loss: 3.0485 - val_accuracy10: 0.4825 - 31s/epoch - 41ms/step
Epoch 17/50
765/765 - 33s - loss: 2.9419 - accuracy10: 0.5148 - val_loss: 3.0477 - val_accuracy10: 0.4828 - 33s/epoch - 43ms/step
Epoch 18/50
765/765 - 31s - loss: 2.9375 - accuracy10: 0.5160 - val_loss: 3.0457 - val_accuracy10: 0.4848 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 31s - loss: 2.9340 - accuracy10: 0.5159 - val_loss: 3.0447 - val_accuracy10: 0.4847 - 31s/epoch - 41ms/step
Epoch 20/50
765/765 - 32s - loss: 2.9300 - accuracy10: 0.5168 - val_loss: 3.0431 - val_accuracy10: 0.4839 - 32s/epoch - 42ms/step
Epoch 21/50
765/765 - 34s - loss: 2.9252 - accuracy10: 0.5186 - val_loss: 3.0428 - val_accuracy10: 0.4862 - 34s/epoch - 45ms/step
Epoch 22/50
765/765 - 31s - loss: 2.9218 - accuracy10: 0.5197 - val_loss: 3.0427 - val_accuracy10: 0.4850 - 31s/epoch - 40ms/step
Epoch 23/50
765/765 - 31s - loss: 2.9202 - accuracy10: 0.5200 - val_loss: 3.0428 - val_accuracy10: 0.4864 - 31s/epoch - 41ms/step
Epoch 24/50
765/765 - 33s - loss: 2.9146 - accuracy10: 0.5210 - val_loss: 3.0407 - val_accuracy10: 0.4863 - 33s/epoch - 43ms/step
Epoch 25/50
765/765 - 33s - loss: 2.9108 - accuracy10: 0.5220 - val_loss: 3.0388 - val_accuracy10: 0.4870 - 33s/epoch - 43ms/step
Epoch 26/50
765/765 - 32s - loss: 2.9079 - accuracy10: 0.5230 - val_loss: 3.0373 - val_accuracy10: 0.4862 - 32s/epoch - 42ms/step
Epoch 27/50
765/765 - 32s - loss: 2.9043 - accuracy10: 0.5248 - val_loss: 3.0376 - val_accuracy10: 0.4886 - 32s/epoch - 42ms/step
Epoch 28/50
765/765 - 33s - loss: 2.9007 - accuracy10: 0.5251 - val_loss: 3.0339 - val_accuracy10: 0.4886 - 33s/epoch - 43ms/step
Epoch 29/50
765/765 - 32s - loss: 2.8968 - accuracy10: 0.5261 - val_loss: 3.0346 - val_accuracy10: 0.4890 - 32s/epoch - 42ms/step
Epoch 30/50
765/765 - 36s - loss: 2.8935 - accuracy10: 0.5269 - val_loss: 3.0337 - val_accuracy10: 0.4889 - 36s/epoch - 47ms/step
Epoch 31/50
765/765 - 33s - loss: 2.8901 - accuracy10: 0.5278 - val_loss: 3.0339 - val_accuracy10: 0.4892 - 33s/epoch - 43ms/step
Epoch 32/50
765/765 - 33s - loss: 2.8860 - accuracy10: 0.5271 - val_loss: 3.0331 - val_accuracy10: 0.4901 - 33s/epoch - 43ms/step
Epoch 33/50
765/765 - 32s - loss: 2.8829 - accuracy10: 0.5294 - val_loss: 3.0372 - val_accuracy10: 0.4885 - 32s/epoch - 42ms/step
Epoch 34/50
765/765 - 34s - loss: 2.8787 - accuracy10: 0.5299 - val_loss: 3.0328 - val_accuracy10: 0.4894 - 34s/epoch - 45ms/step
Epoch 35/50
765/765 - 32s - loss: 2.8771 - accuracy10: 0.5298 - val_loss: 3.0412 - val_accuracy10: 0.4866 - 32s/epoch - 42ms/step
Epoch 36/50
765/765 - 32s - loss: 2.8714 - accuracy10: 0.5319 - val_loss: 3.0377 - val_accuracy10: 0.4889 - 32s/epoch - 42ms/step
Epoch 37/50
765/765 - 33s - loss: 2.8688 - accuracy10: 0.5324 - val_loss: 3.0378 - val_accuracy10: 0.4872 - 33s/epoch - 43ms/step
Epoch 38/50
765/765 - 32s - loss: 2.8661 - accuracy10: 0.5331 - val_loss: 3.0416 - val_accuracy10: 0.4879 - 32s/epoch - 42ms/step
Epoch 39/50
765/765 - 32s - loss: 2.8622 - accuracy10: 0.5348 - val_loss: 3.0379 - val_accuracy10: 0.4892 - 32s/epoch - 41ms/step
Epoch 40/50
765/765 - 33s - loss: 2.8579 - accuracy10: 0.5354 - val_loss: 3.0430 - val_accuracy10: 0.4865 - 33s/epoch - 43ms/step
Epoch 41/50
765/765 - 33s - loss: 2.8574 - accuracy10: 0.5370 - val_loss: 3.0405 - val_accuracy10: 0.4858 - 33s/epoch - 43ms/step
Epoch 42/50
765/765 - 33s - loss: 2.8514 - accuracy10: 0.5363 - val_loss: 3.0421 - val_accuracy10: 0.4868 - 33s/epoch - 44ms/step
Epoch 43/50
765/765 - 35s - loss: 2.8496 - accuracy10: 0.5379 - val_loss: 3.0439 - val_accuracy10: 0.4865 - 35s/epoch - 46ms/step
Epoch 44/50
765/765 - 35s - loss: 2.8455 - accuracy10: 0.5384 - val_loss: 3.0486 - val_accuracy10: 0.4866 - 35s/epoch - 46ms/step
testing model: results/PCAR/W0/deepVOL_L2/h10
Evaluating performance on  test set...
1733/1733 - 37s - 37s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0348709
{'0': {'precision': 0.4515262500813566, 'recall': 0.52888667110224, 'f1-score': 0.4871543615163886, 'support': 144288}, '1': {'precision': 0.5321664212879655, 'recall': 0.31817144496534455, 'f1-score': 0.39824207751507784, 'support': 153367}, '2': {'precision': 0.4518073607281957, 'recall': 0.5662669601047602, 'f1-score': 0.5026029543760364, 'support': 145857}, 'accuracy': 0.4683142733454788, 'macro avg': {'precision': 0.4785000106991726, 'recall': 0.47110835872411494, 'f1-score': 0.4626664644691676, 'support': 443512}, 'weighted avg': {'precision': 0.4795041697161354, 'recall': 0.4683142733454788, 'f1-score': 0.46148893453425643, 'support': 443512}}
[[76312 22498 45478]
 [49834 48797 54736]
 [42863 20400 82594]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9947205
{'0': {'precision': 0.49202924781003404, 'recall': 0.5208847468538758, 'f1-score': 0.5060459852275435, 'support': 65239}, '1': {'precision': 0.5906964856230031, 'recall': 0.35845457083475507, 'f1-score': 0.44616260774717903, 'support': 64474}, '2': {'precision': 0.4694886610181104, 'recall': 0.6224735431711859, 'f1-score': 0.5352644426362897, 'support': 66051}, 'accuracy': 0.5016652704276577, 'macro avg': {'precision': 0.5174047981503825, 'recall': 0.5006042869532722, 'f1-score': 0.4958243452036708, 'support': 195764}, 'weighted avg': {'precision': 0.5169196423287403, 'recall': 0.5016652704276577, 'f1-score': 0.49618200334443974, 'support': 195764}}
[[33982  8237 23020]
 [17924 23111 23439]
 [17159  7777 41115]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0108721
{'0': {'precision': 0.46941059973306926, 'recall': 0.5077775707898659, 'f1-score': 0.48784089129510727, 'support': 21472}, '1': {'precision': 0.5571740713765477, 'recall': 0.36347222882120966, 'f1-score': 0.4399459412830319, 'support': 21047}, '2': {'precision': 0.4683188645942149, 'recall': 0.585657011577098, 'f1-score': 0.5204563650920737, 'support': 22199}, 'accuracy': 0.4875614203158318, 'macro avg': {'precision': 0.4983011785679439, 'recall': 0.4856356037293912, 'f1-score': 0.4827477325567376, 'support': 64718}, 'weighted avg': {'precision': 0.4975777612543286, 'recall': 0.4875614203158318, 'f1-score': 0.48345240416501534, 'support': 64718}}
[[10903  2987  7582]
 [ 6219  7650  7178]
 [ 6105  3093 13001]]
training model: results/PCAR/W0/deepVOL_L2/h20
Epoch 1/50
765/765 - 40s - loss: 3.2812 - accuracy20: 0.3870 - val_loss: 3.2922 - val_accuracy20: 0.3836 - 40s/epoch - 52ms/step
Epoch 2/50
765/765 - 34s - loss: 3.1925 - accuracy20: 0.4298 - val_loss: 3.2555 - val_accuracy20: 0.3993 - 34s/epoch - 44ms/step
Epoch 3/50
765/765 - 34s - loss: 3.1616 - accuracy20: 0.4415 - val_loss: 3.2381 - val_accuracy20: 0.4098 - 34s/epoch - 45ms/step
Epoch 4/50
765/765 - 35s - loss: 3.1437 - accuracy20: 0.4499 - val_loss: 3.2140 - val_accuracy20: 0.4203 - 35s/epoch - 46ms/step
Epoch 5/50
765/765 - 36s - loss: 3.1330 - accuracy20: 0.4551 - val_loss: 3.2007 - val_accuracy20: 0.4260 - 36s/epoch - 47ms/step
Epoch 6/50
765/765 - 34s - loss: 3.1227 - accuracy20: 0.4586 - val_loss: 3.1843 - val_accuracy20: 0.4341 - 34s/epoch - 45ms/step
Epoch 7/50
765/765 - 34s - loss: 3.1166 - accuracy20: 0.4605 - val_loss: 3.1874 - val_accuracy20: 0.4350 - 34s/epoch - 45ms/step
Epoch 8/50
765/765 - 34s - loss: 3.1105 - accuracy20: 0.4627 - val_loss: 3.1802 - val_accuracy20: 0.4362 - 34s/epoch - 45ms/step
Epoch 9/50
765/765 - 33s - loss: 3.1025 - accuracy20: 0.4650 - val_loss: 3.1819 - val_accuracy20: 0.4384 - 33s/epoch - 43ms/step
Epoch 10/50
765/765 - 36s - loss: 3.0978 - accuracy20: 0.4666 - val_loss: 3.1640 - val_accuracy20: 0.4435 - 36s/epoch - 47ms/step
Epoch 11/50
765/765 - 34s - loss: 3.0921 - accuracy20: 0.4686 - val_loss: 3.1628 - val_accuracy20: 0.4443 - 34s/epoch - 44ms/step
Epoch 12/50
765/765 - 33s - loss: 3.0874 - accuracy20: 0.4706 - val_loss: 3.1692 - val_accuracy20: 0.4432 - 33s/epoch - 43ms/step
Epoch 13/50
765/765 - 33s - loss: 3.0827 - accuracy20: 0.4720 - val_loss: 3.1646 - val_accuracy20: 0.4445 - 33s/epoch - 43ms/step
Epoch 14/50
765/765 - 32s - loss: 3.0795 - accuracy20: 0.4728 - val_loss: 3.1607 - val_accuracy20: 0.4455 - 32s/epoch - 41ms/step
Epoch 15/50
765/765 - 34s - loss: 3.0749 - accuracy20: 0.4753 - val_loss: 3.1567 - val_accuracy20: 0.4472 - 34s/epoch - 44ms/step
Epoch 16/50
765/765 - 30s - loss: 3.0701 - accuracy20: 0.4767 - val_loss: 3.1632 - val_accuracy20: 0.4457 - 30s/epoch - 40ms/step
Epoch 17/50
765/765 - 32s - loss: 3.0669 - accuracy20: 0.4774 - val_loss: 3.1566 - val_accuracy20: 0.4473 - 32s/epoch - 41ms/step
Epoch 18/50
765/765 - 31s - loss: 3.0622 - accuracy20: 0.4787 - val_loss: 3.1510 - val_accuracy20: 0.4507 - 31s/epoch - 41ms/step
Epoch 19/50
765/765 - 31s - loss: 3.0602 - accuracy20: 0.4796 - val_loss: 3.1516 - val_accuracy20: 0.4498 - 31s/epoch - 40ms/step
Epoch 20/50
765/765 - 33s - loss: 3.0567 - accuracy20: 0.4809 - val_loss: 3.1556 - val_accuracy20: 0.4477 - 33s/epoch - 43ms/step
Epoch 21/50
765/765 - 32s - loss: 3.0532 - accuracy20: 0.4814 - val_loss: 3.1537 - val_accuracy20: 0.4489 - 32s/epoch - 42ms/step
Epoch 22/50
765/765 - 30s - loss: 3.0499 - accuracy20: 0.4827 - val_loss: 3.1502 - val_accuracy20: 0.4495 - 30s/epoch - 40ms/step
Epoch 23/50
765/765 - 35s - loss: 3.0474 - accuracy20: 0.4837 - val_loss: 3.1519 - val_accuracy20: 0.4498 - 35s/epoch - 46ms/step
Epoch 24/50
765/765 - 32s - loss: 3.0440 - accuracy20: 0.4850 - val_loss: 3.1460 - val_accuracy20: 0.4510 - 32s/epoch - 42ms/step
Epoch 25/50
765/765 - 31s - loss: 3.0395 - accuracy20: 0.4867 - val_loss: 3.1495 - val_accuracy20: 0.4514 - 31s/epoch - 40ms/step
Epoch 26/50
765/765 - 35s - loss: 3.0376 - accuracy20: 0.4880 - val_loss: 3.1558 - val_accuracy20: 0.4476 - 35s/epoch - 46ms/step
Epoch 27/50
765/765 - 32s - loss: 3.0338 - accuracy20: 0.4874 - val_loss: 3.1559 - val_accuracy20: 0.4477 - 32s/epoch - 42ms/step
Epoch 28/50
765/765 - 31s - loss: 3.0315 - accuracy20: 0.4888 - val_loss: 3.1504 - val_accuracy20: 0.4502 - 31s/epoch - 40ms/step
Epoch 29/50
765/765 - 32s - loss: 3.0273 - accuracy20: 0.4898 - val_loss: 3.1533 - val_accuracy20: 0.4490 - 32s/epoch - 42ms/step
Epoch 30/50
765/765 - 33s - loss: 3.0244 - accuracy20: 0.4912 - val_loss: 3.1534 - val_accuracy20: 0.4469 - 33s/epoch - 43ms/step
Epoch 31/50
765/765 - 32s - loss: 3.0210 - accuracy20: 0.4923 - val_loss: 3.1524 - val_accuracy20: 0.4479 - 32s/epoch - 42ms/step
Epoch 32/50
765/765 - 32s - loss: 3.0193 - accuracy20: 0.4925 - val_loss: 3.1605 - val_accuracy20: 0.4466 - 32s/epoch - 42ms/step
Epoch 33/50
765/765 - 33s - loss: 3.0153 - accuracy20: 0.4942 - val_loss: 3.1541 - val_accuracy20: 0.4480 - 33s/epoch - 43ms/step
Epoch 34/50
765/765 - 33s - loss: 3.0132 - accuracy20: 0.4943 - val_loss: 3.1581 - val_accuracy20: 0.4482 - 33s/epoch - 44ms/step
testing model: results/PCAR/W0/deepVOL_L2/h20
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0587058
{'0': {'precision': 0.42185305787049815, 'recall': 0.48448823500412, 'f1-score': 0.4510063594047073, 'support': 141989}, '1': {'precision': 0.4798430634694947, 'recall': 0.28538820043617313, 'f1-score': 0.35790892200719254, 'support': 157277}, '2': {'precision': 0.42464954521134296, 'recall': 0.5502197634596453, 'f1-score': 0.4793474781516309, 'support': 144246}, 'accuracy': 0.4352621800537528, 'macro avg': {'precision': 0.4421152221837786, 'recall': 0.4400320662999795, 'f1-score': 0.42942091985451025, 'support': 443512}, 'weighted avg': {'precision': 0.44332683135027073, 'recall': 0.4352621800537528, 'f1-score': 0.42720995108475157, 'support': 443512}}
[[68792 23953 49244]
 [54103 44885 58289]
 [40176 24703 79367]]
Evaluating performance on  train set...
765/765 - 14s - 14s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0362039
{'0': {'precision': 0.4550298051085647, 'recall': 0.4521529632016696, 'f1-score': 0.45358682266009853, 'support': 65166}, '1': {'precision': 0.5125748502994012, 'recall': 0.333260659669231, 'f1-score': 0.40391076214563437, 'support': 64214}, '2': {'precision': 0.4419784898050639, 'recall': 0.5942847674138346, 'f1-score': 0.5069389118758191, 'support': 66384}, 'accuracy': 0.4613514231421508, 'macro avg': {'precision': 0.4698610484043433, 'recall': 0.459899463428245, 'f1-score': 0.4548121655605173, 'support': 195764}, 'weighted avg': {'precision': 0.4694798521896254, 'recall': 0.4613514231421508, 'f1-score': 0.45538402000292255, 'support': 195764}}
[[29465 10006 25695]
 [18700 21400 24114]
 [16589 10344 39451]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0483475
{'0': {'precision': 0.4424450912939931, 'recall': 0.46782316731952994, 'f1-score': 0.4547803617571059, 'support': 21444}, '1': {'precision': 0.49714874613534865, 'recall': 0.3384629776883858, 'f1-score': 0.4027383536483553, 'support': 21379}, '2': {'precision': 0.43475572047000616, 'recall': 0.5458323818223338, 'f1-score': 0.484002915924186, 'support': 21895}, 'accuracy': 0.4514818134058531, 'macro avg': {'precision': 0.45811651929978264, 'recall': 0.4507061756100832, 'f1-score': 0.4471738771098824, 'support': 64718}, 'weighted avg': {'precision': 0.45791452271434213, 'recall': 0.4514818134058531, 'f1-score': 0.4474751565921014, 'support': 64718}}
[[10032  3360  8052]
 [ 6657  7236  7486]
 [ 5985  3959 11951]]
training model: results/PCAR/W0/deepVOL_L2/h30
Epoch 1/50
765/765 - 37s - loss: 3.3042 - accuracy30: 0.3708 - val_loss: 3.3221 - val_accuracy30: 0.3531 - 37s/epoch - 48ms/step
Epoch 2/50
765/765 - 33s - loss: 3.2442 - accuracy30: 0.3997 - val_loss: 3.2884 - val_accuracy30: 0.3781 - 33s/epoch - 43ms/step
Epoch 3/50
765/765 - 34s - loss: 3.2147 - accuracy30: 0.4149 - val_loss: 3.2736 - val_accuracy30: 0.3830 - 34s/epoch - 44ms/step
Epoch 4/50
765/765 - 33s - loss: 3.2002 - accuracy30: 0.4220 - val_loss: 3.2588 - val_accuracy30: 0.3898 - 33s/epoch - 44ms/step
Epoch 5/50
765/765 - 34s - loss: 3.1911 - accuracy30: 0.4251 - val_loss: 3.2474 - val_accuracy30: 0.3991 - 34s/epoch - 44ms/step
Epoch 6/50
765/765 - 33s - loss: 3.1854 - accuracy30: 0.4273 - val_loss: 3.2355 - val_accuracy30: 0.4043 - 33s/epoch - 43ms/step
Epoch 7/50
765/765 - 33s - loss: 3.1789 - accuracy30: 0.4318 - val_loss: 3.2352 - val_accuracy30: 0.4055 - 33s/epoch - 43ms/step
Epoch 8/50
765/765 - 35s - loss: 3.1736 - accuracy30: 0.4340 - val_loss: 3.2291 - val_accuracy30: 0.4108 - 35s/epoch - 46ms/step
Epoch 9/50
765/765 - 31s - loss: 3.1687 - accuracy30: 0.4358 - val_loss: 3.2284 - val_accuracy30: 0.4083 - 31s/epoch - 41ms/step
Epoch 10/50
765/765 - 34s - loss: 3.1655 - accuracy30: 0.4373 - val_loss: 3.2193 - val_accuracy30: 0.4144 - 34s/epoch - 44ms/step
Epoch 11/50
765/765 - 33s - loss: 3.1614 - accuracy30: 0.4400 - val_loss: 3.2200 - val_accuracy30: 0.4145 - 33s/epoch - 43ms/step
Epoch 12/50
765/765 - 33s - loss: 3.1564 - accuracy30: 0.4411 - val_loss: 3.2175 - val_accuracy30: 0.4145 - 33s/epoch - 43ms/step
Epoch 13/50
765/765 - 33s - loss: 3.1553 - accuracy30: 0.4414 - val_loss: 3.2152 - val_accuracy30: 0.4150 - 33s/epoch - 43ms/step
Epoch 14/50
765/765 - 33s - loss: 3.1525 - accuracy30: 0.4429 - val_loss: 3.2185 - val_accuracy30: 0.4146 - 33s/epoch - 43ms/step
Epoch 15/50
765/765 - 31s - loss: 3.1487 - accuracy30: 0.4445 - val_loss: 3.2153 - val_accuracy30: 0.4171 - 31s/epoch - 40ms/step
Epoch 16/50
765/765 - 34s - loss: 3.1462 - accuracy30: 0.4467 - val_loss: 3.2145 - val_accuracy30: 0.4140 - 34s/epoch - 44ms/step
Epoch 17/50
765/765 - 31s - loss: 3.1427 - accuracy30: 0.4484 - val_loss: 3.2126 - val_accuracy30: 0.4183 - 31s/epoch - 41ms/step
Epoch 18/50
765/765 - 33s - loss: 3.1391 - accuracy30: 0.4487 - val_loss: 3.2149 - val_accuracy30: 0.4178 - 33s/epoch - 43ms/step
Epoch 19/50
765/765 - 34s - loss: 3.1367 - accuracy30: 0.4496 - val_loss: 3.2127 - val_accuracy30: 0.4157 - 34s/epoch - 45ms/step
Epoch 20/50
765/765 - 35s - loss: 3.1324 - accuracy30: 0.4503 - val_loss: 3.2147 - val_accuracy30: 0.4171 - 35s/epoch - 45ms/step
Epoch 21/50
765/765 - 34s - loss: 3.1311 - accuracy30: 0.4522 - val_loss: 3.2156 - val_accuracy30: 0.4156 - 34s/epoch - 44ms/step
Epoch 22/50
765/765 - 34s - loss: 3.1269 - accuracy30: 0.4544 - val_loss: 3.2152 - val_accuracy30: 0.4154 - 34s/epoch - 44ms/step
Epoch 23/50
765/765 - 33s - loss: 3.1236 - accuracy30: 0.4548 - val_loss: 3.2189 - val_accuracy30: 0.4150 - 33s/epoch - 43ms/step
Epoch 24/50
765/765 - 33s - loss: 3.1205 - accuracy30: 0.4572 - val_loss: 3.2182 - val_accuracy30: 0.4155 - 33s/epoch - 43ms/step
Epoch 25/50
765/765 - 36s - loss: 3.1182 - accuracy30: 0.4570 - val_loss: 3.2158 - val_accuracy30: 0.4186 - 36s/epoch - 47ms/step
Epoch 26/50
765/765 - 34s - loss: 3.1159 - accuracy30: 0.4580 - val_loss: 3.2190 - val_accuracy30: 0.4150 - 34s/epoch - 45ms/step
Epoch 27/50
765/765 - 33s - loss: 3.1119 - accuracy30: 0.4597 - val_loss: 3.2237 - val_accuracy30: 0.4157 - 33s/epoch - 43ms/step
testing model: results/PCAR/W0/deepVOL_L2/h30
Evaluating performance on  test set...
1733/1733 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0728408
{'0': {'precision': 0.39379451653819886, 'recall': 0.48510644315136775, 'f1-score': 0.4347071308645104, 'support': 141437}, '1': {'precision': 0.44233292150144565, 'recall': 0.2211087270713026, 'f1-score': 0.2948372910423052, 'support': 157063}, '2': {'precision': 0.4130881489557997, 'recall': 0.5434308884781949, 'f1-score': 0.469378759902317, 'support': 145012}, 'accuracy': 0.4106856184274608, 'macro avg': {'precision': 0.41640519566514805, 'recall': 0.4165486862336218, 'f1-score': 0.3996410606030442, 'support': 443512}, 'weighted avg': {'precision': 0.4172919545396138, 'recall': 0.4106856184274608, 'f1-score': 0.39651070239816766, 'support': 443512}}
[[68612 22721 50104]
 [60475 34728 61860]
 [45146 21062 78804]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0616995
{'0': {'precision': 0.42520678125183314, 'recall': 0.4478045314840842, 'f1-score': 0.43621318689585137, 'support': 64747}, '1': {'precision': 0.462340031509992, 'recall': 0.2585196976956246, 'f1-score': 0.33161515433873234, 'support': 64703}, '2': {'precision': 0.4223771020930665, 'recall': 0.582139518050487, 'f1-score': 0.48955367729581317, 'support': 66314}, 'accuracy': 0.4307482478903169, 'macro avg': {'precision': 0.4366413049516305, 'recall': 0.4294879157433986, 'f1-score': 0.41912733951013226, 'support': 195764}, 'weighted avg': {'precision': 0.43652135056855734, 'recall': 0.4307482478903169, 'f1-score': 0.4197107389475043, 'support': 195764}}
[[28994  9864 25889]
 [21072 16727 26904]
 [18122  9588 38604]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0703961
{'0': {'precision': 0.4115336469978849, 'recall': 0.4511000709723208, 'f1-score': 0.43040946232675725, 'support': 21135}, '1': {'precision': 0.4523305914610262, 'recall': 0.2618475352591719, 'f1-score': 0.331686580882353, 'support': 22051}, '2': {'precision': 0.4091572292086431, 'recall': 0.5469998142299832, 'f1-score': 0.468142612981438, 'support': 21532}, 'accuracy': 0.41852344015575266, 'macro avg': {'precision': 0.42434048922251805, 'recall': 0.41998247348715867, 'f1-score': 0.41007955206351604, 'support': 64718}, 'weighted avg': {'precision': 0.42464351433801867, 'recall': 0.41852344015575266, 'f1-score': 0.40932617701457247, 'support': 64718}}
[[ 9534  3422  8179]
 [ 7448  5774  8829]
 [ 6185  3569 11778]]
training model: results/PCAR/W0/deepVOL_L2/h50
Epoch 1/50
765/765 - 41s - loss: 3.3038 - accuracy50: 0.3750 - val_loss: 3.3183 - val_accuracy50: 0.3497 - 41s/epoch - 54ms/step
Epoch 2/50
765/765 - 33s - loss: 3.2652 - accuracy50: 0.3888 - val_loss: 3.2842 - val_accuracy50: 0.3663 - 33s/epoch - 43ms/step
Epoch 3/50
765/765 - 34s - loss: 3.2434 - accuracy50: 0.4015 - val_loss: 3.2802 - val_accuracy50: 0.3669 - 34s/epoch - 44ms/step
Epoch 4/50
765/765 - 34s - loss: 3.2328 - accuracy50: 0.4072 - val_loss: 3.2656 - val_accuracy50: 0.3799 - 34s/epoch - 44ms/step
Epoch 5/50
765/765 - 34s - loss: 3.2265 - accuracy50: 0.4111 - val_loss: 3.2577 - val_accuracy50: 0.3831 - 34s/epoch - 45ms/step
Epoch 6/50
765/765 - 35s - loss: 3.2216 - accuracy50: 0.4137 - val_loss: 3.2552 - val_accuracy50: 0.3836 - 35s/epoch - 46ms/step
Epoch 7/50
765/765 - 31s - loss: 3.2166 - accuracy50: 0.4152 - val_loss: 3.2547 - val_accuracy50: 0.3847 - 31s/epoch - 40ms/step
Epoch 8/50
765/765 - 33s - loss: 3.2124 - accuracy50: 0.4172 - val_loss: 3.2517 - val_accuracy50: 0.3878 - 33s/epoch - 43ms/step
Epoch 9/50
765/765 - 33s - loss: 3.2080 - accuracy50: 0.4184 - val_loss: 3.2486 - val_accuracy50: 0.3899 - 33s/epoch - 44ms/step
Epoch 10/50
765/765 - 34s - loss: 3.2036 - accuracy50: 0.4223 - val_loss: 3.2497 - val_accuracy50: 0.3909 - 34s/epoch - 44ms/step
Epoch 11/50
765/765 - 33s - loss: 3.2005 - accuracy50: 0.4238 - val_loss: 3.2494 - val_accuracy50: 0.3880 - 33s/epoch - 43ms/step
Epoch 12/50
765/765 - 32s - loss: 3.1982 - accuracy50: 0.4244 - val_loss: 3.2509 - val_accuracy50: 0.3891 - 32s/epoch - 42ms/step
Epoch 13/50
765/765 - 33s - loss: 3.1958 - accuracy50: 0.4272 - val_loss: 3.2498 - val_accuracy50: 0.3895 - 33s/epoch - 43ms/step
Epoch 14/50
765/765 - 32s - loss: 3.1927 - accuracy50: 0.4272 - val_loss: 3.2534 - val_accuracy50: 0.3872 - 32s/epoch - 42ms/step
Epoch 15/50
765/765 - 34s - loss: 3.1908 - accuracy50: 0.4278 - val_loss: 3.2519 - val_accuracy50: 0.3894 - 34s/epoch - 44ms/step
Epoch 16/50
765/765 - 36s - loss: 3.1877 - accuracy50: 0.4305 - val_loss: 3.2531 - val_accuracy50: 0.3900 - 36s/epoch - 47ms/step
Epoch 17/50
765/765 - 32s - loss: 3.1827 - accuracy50: 0.4315 - val_loss: 3.2556 - val_accuracy50: 0.3867 - 32s/epoch - 41ms/step
Epoch 18/50
765/765 - 31s - loss: 3.1797 - accuracy50: 0.4327 - val_loss: 3.2556 - val_accuracy50: 0.3870 - 31s/epoch - 40ms/step
Epoch 19/50
765/765 - 32s - loss: 3.1776 - accuracy50: 0.4338 - val_loss: 3.2530 - val_accuracy50: 0.3886 - 32s/epoch - 42ms/step
testing model: results/PCAR/W0/deepVOL_L2/h50
Evaluating performance on  test set...
1733/1733 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0820563
{'0': {'precision': 0.3585918028247023, 'recall': 0.38888930601334964, 'f1-score': 0.37312653308215704, 'support': 133187}, '1': {'precision': 0.45067292529979097, 'recall': 0.35371897971988925, 'f1-score': 0.39635298746702274, 'support': 173717}, '2': {'precision': 0.379009015098908, 'recall': 0.4514742914031389, 'f1-score': 0.4120801109125227, 'support': 136608}, 'accuracy': 0.39439068165010194, 'macro avg': {'precision': 0.3960912477411338, 'recall': 0.3980275257121259, 'f1-score': 0.39385321048723415, 'support': 443512}, 'weighted avg': {'precision': 0.4009473893417744, 'recall': 0.39439068165010194, 'f1-score': 0.39422224263821487, 'support': 443512}}
[[51795 36969 44423]
 [55641 61447 56629]
 [37004 37929 61675]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.079999
{'0': {'precision': 0.4013893751497172, 'recall': 0.33656252897005656, 'f1-score': 0.3661285307292148, 'support': 64722}, '1': {'precision': 0.3912270206470598, 'recall': 0.37413798435228995, 'f1-score': 0.38249172087288485, 'support': 64674}, '2': {'precision': 0.4010622002360445, 'recall': 0.4813012295081967, 'f1-score': 0.4375333872094457, 'support': 66368}, 'accuracy': 0.3980456059336752, 'macro avg': {'precision': 0.39789286534427376, 'recall': 0.3973339142768477, 'f1-score': 0.39538454627051517, 'support': 195764}, 'weighted avg': {'precision': 0.3979211477954769, 'recall': 0.3980456059336752, 'f1-score': 0.3957420984650175, 'support': 195764}}
[[21783 18556 24383]
 [17157 24197 23320]
 [15329 19096 31943]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0830723
{'0': {'precision': 0.39120298414672056, 'recall': 0.3555586947308942, 'f1-score': 0.37253015614593354, 'support': 21237}, '1': {'precision': 0.38997484033288177, 'recall': 0.3643431877768737, 'f1-score': 0.37672353353587285, 'support': 22122}, '2': {'precision': 0.38657669306610637, 'recall': 0.44791422819420385, 'f1-score': 0.41499121608432565, 'support': 21359}, 'accuracy': 0.38904168855650667, 'macro avg': {'precision': 0.38925150584856955, 'recall': 0.38927203690065726, 'f1-score': 0.3880816352553773, 'support': 64718}, 'weighted avg': {'precision': 0.389256354945562, 'recall': 0.38904168855650667, 'f1-score': 0.3879770437791168, 'support': 64718}}
[[7551 6121 7565]
 [6446 8060 7616]
 [5305 6487 9567]]
training model: results/PCAR/W0/deepVOL_L2/h100
Epoch 1/50
765/765 - 40s - loss: 3.3129 - accuracy100: 0.3591 - val_loss: 3.3255 - val_accuracy100: 0.3425 - 40s/epoch - 52ms/step
Epoch 2/50
765/765 - 35s - loss: 3.2714 - accuracy100: 0.3774 - val_loss: 3.2985 - val_accuracy100: 0.3530 - 35s/epoch - 45ms/step
Epoch 3/50
765/765 - 32s - loss: 3.2584 - accuracy100: 0.3870 - val_loss: 3.2877 - val_accuracy100: 0.3590 - 32s/epoch - 42ms/step
Epoch 4/50
765/765 - 33s - loss: 3.2520 - accuracy100: 0.3910 - val_loss: 3.2793 - val_accuracy100: 0.3641 - 33s/epoch - 43ms/step
Epoch 5/50
765/765 - 31s - loss: 3.2468 - accuracy100: 0.3940 - val_loss: 3.2778 - val_accuracy100: 0.3642 - 31s/epoch - 41ms/step
Epoch 6/50
765/765 - 32s - loss: 3.2435 - accuracy100: 0.3944 - val_loss: 3.2792 - val_accuracy100: 0.3649 - 32s/epoch - 41ms/step
Epoch 7/50
765/765 - 32s - loss: 3.2402 - accuracy100: 0.3975 - val_loss: 3.2744 - val_accuracy100: 0.3687 - 32s/epoch - 42ms/step
Epoch 8/50
765/765 - 33s - loss: 3.2372 - accuracy100: 0.3985 - val_loss: 3.2762 - val_accuracy100: 0.3663 - 33s/epoch - 43ms/step
Epoch 9/50
765/765 - 34s - loss: 3.2353 - accuracy100: 0.4011 - val_loss: 3.2782 - val_accuracy100: 0.3655 - 34s/epoch - 44ms/step
Epoch 10/50
765/765 - 33s - loss: 3.2316 - accuracy100: 0.4028 - val_loss: 3.2748 - val_accuracy100: 0.3690 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 32s - loss: 3.2302 - accuracy100: 0.4037 - val_loss: 3.2784 - val_accuracy100: 0.3684 - 32s/epoch - 42ms/step
Epoch 12/50
765/765 - 32s - loss: 3.2272 - accuracy100: 0.4059 - val_loss: 3.2762 - val_accuracy100: 0.3687 - 32s/epoch - 42ms/step
Epoch 13/50
765/765 - 33s - loss: 3.2244 - accuracy100: 0.4078 - val_loss: 3.2767 - val_accuracy100: 0.3688 - 33s/epoch - 43ms/step
Epoch 14/50
765/765 - 35s - loss: 3.2226 - accuracy100: 0.4095 - val_loss: 3.2761 - val_accuracy100: 0.3711 - 35s/epoch - 45ms/step
Epoch 15/50
765/765 - 34s - loss: 3.2200 - accuracy100: 0.4096 - val_loss: 3.2794 - val_accuracy100: 0.3665 - 34s/epoch - 44ms/step
Epoch 16/50
765/765 - 31s - loss: 3.2169 - accuracy100: 0.4116 - val_loss: 3.2771 - val_accuracy100: 0.3716 - 31s/epoch - 41ms/step
Epoch 17/50
765/765 - 34s - loss: 3.2146 - accuracy100: 0.4133 - val_loss: 3.2777 - val_accuracy100: 0.3706 - 34s/epoch - 45ms/step
testing model: results/PCAR/W0/deepVOL_L2/h100
Evaluating performance on  test set...
1733/1733 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933009
{'0': {'precision': 0.34463784871646647, 'recall': 0.6730218459287133, 'f1-score': 0.4558474750263719, 'support': 143505}, '1': {'precision': 0.38159188923356285, 'recall': 0.06676020728955015, 'f1-score': 0.11363905208785142, 'support': 151093}, '2': {'precision': 0.38222397614662806, 'recall': 0.35122285345904347, 'f1-score': 0.36606824146981626, 'support': 148914}, 'accuracy': 0.3584367503021339, 'macro avg': {'precision': 0.3694845713655524, 'recall': 0.36366830222576896, 'f1-score': 0.3118515895280132, 'support': 443512}, 'weighted avg': {'precision': 0.3698470818916336, 'recall': 0.3584367503021339, 'f1-score': 0.3091216095866751, 'support': 443512}}
[[96582  7512 39411]
 [95883 10087 45123]
 [87777  8835 52302]]
Evaluating performance on  train set...
765/765 - 17s - 17s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0889183
{'0': {'precision': 0.35921646876475355, 'recall': 0.6272612733126973, 'f1-score': 0.45682242990654204, 'support': 64289}, '1': {'precision': 0.3997635409739156, 'recall': 0.0837629863594841, 'f1-score': 0.13850486431131592, 'support': 64587}, '2': {'precision': 0.3827783335715307, 'recall': 0.40041562014113147, 'f1-score': 0.39139838372619795, 'support': 66888}, 'accuracy': 0.3704409390899246, 'macro avg': {'precision': 0.3805861144367333, 'recall': 0.370479959937771, 'f1-score': 0.3289085593146853, 'support': 195764}, 'weighted avg': {'precision': 0.38064441142003674, 'recall': 0.3704409390899246, 'f1-score': 0.32944834575414567, 'support': 195764}}
[[40326  3701 20262]
 [36252  5410 22925]
 [35683  4422 26783]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0914383
{'0': {'precision': 0.35682114969485385, 'recall': 0.6261223344556678, 'f1-score': 0.4545809496324716, 'support': 21384}, '1': {'precision': 0.4132762312633833, 'recall': 0.0882447076036761, 'f1-score': 0.14543536415357372, 'support': 21871}, '2': {'precision': 0.3728745837957825, 'recall': 0.39132460513441736, 'f1-score': 0.3818768755115031, 'support': 21463}, 'accuracy': 0.3664822769554065, 'macro avg': {'precision': 0.3809906549180066, 'recall': 0.36856388239792043, 'f1-score': 0.3272977297658495, 'support': 64718}, 'weighted avg': {'precision': 0.381223695278672, 'recall': 0.3664822769554065, 'f1-score': 0.32599584745274846, 'support': 64718}}
[[13389  1290  6705]
 [12520  1930  7421]
 [11614  1450  8399]]
training model: results/PCAR/W0/deepVOL_L2/h200
Epoch 1/50
765/765 - 42s - loss: 3.2964 - accuracy200: 0.3745 - val_loss: 3.3373 - val_accuracy200: 0.3300 - 42s/epoch - 55ms/step
Epoch 2/50
765/765 - 33s - loss: 3.2589 - accuracy200: 0.3851 - val_loss: 3.3220 - val_accuracy200: 0.3378 - 33s/epoch - 43ms/step
Epoch 3/50
765/765 - 34s - loss: 3.2506 - accuracy200: 0.3884 - val_loss: 3.3213 - val_accuracy200: 0.3327 - 34s/epoch - 45ms/step
Epoch 4/50
765/765 - 32s - loss: 3.2532 - accuracy200: 0.3837 - val_loss: 3.3122 - val_accuracy200: 0.3389 - 32s/epoch - 42ms/step
Epoch 5/50
765/765 - 34s - loss: 3.2488 - accuracy200: 0.3869 - val_loss: 3.2954 - val_accuracy200: 0.3478 - 34s/epoch - 44ms/step
Epoch 6/50
765/765 - 33s - loss: 3.2503 - accuracy200: 0.3873 - val_loss: 3.2927 - val_accuracy200: 0.3500 - 33s/epoch - 43ms/step
Epoch 7/50
765/765 - 32s - loss: 3.2489 - accuracy200: 0.3861 - val_loss: 3.2926 - val_accuracy200: 0.3503 - 32s/epoch - 42ms/step
Epoch 8/50
765/765 - 32s - loss: 3.2501 - accuracy200: 0.3862 - val_loss: 3.2911 - val_accuracy200: 0.3540 - 32s/epoch - 42ms/step
Epoch 9/50
765/765 - 32s - loss: 3.2471 - accuracy200: 0.3873 - val_loss: 3.2919 - val_accuracy200: 0.3507 - 32s/epoch - 42ms/step
Epoch 10/50
765/765 - 33s - loss: 3.2428 - accuracy200: 0.3911 - val_loss: 3.2938 - val_accuracy200: 0.3524 - 33s/epoch - 43ms/step
Epoch 11/50
765/765 - 33s - loss: 3.2407 - accuracy200: 0.3953 - val_loss: 3.2935 - val_accuracy200: 0.3525 - 33s/epoch - 43ms/step
Epoch 12/50
765/765 - 33s - loss: 3.2357 - accuracy200: 0.3970 - val_loss: 3.2966 - val_accuracy200: 0.3508 - 33s/epoch - 43ms/step
Epoch 13/50
765/765 - 33s - loss: 3.2328 - accuracy200: 0.3992 - val_loss: 3.2950 - val_accuracy200: 0.3488 - 33s/epoch - 43ms/step
Epoch 14/50
765/765 - 32s - loss: 3.2270 - accuracy200: 0.4050 - val_loss: 3.2983 - val_accuracy200: 0.3471 - 32s/epoch - 42ms/step
Epoch 15/50
765/765 - 33s - loss: 3.2245 - accuracy200: 0.4047 - val_loss: 3.2948 - val_accuracy200: 0.3489 - 33s/epoch - 43ms/step
Epoch 16/50
765/765 - 32s - loss: 3.2203 - accuracy200: 0.4084 - val_loss: 3.2965 - val_accuracy200: 0.3484 - 32s/epoch - 42ms/step
Epoch 17/50
765/765 - 32s - loss: 3.2162 - accuracy200: 0.4107 - val_loss: 3.3005 - val_accuracy200: 0.3476 - 32s/epoch - 42ms/step
Epoch 18/50
765/765 - 32s - loss: 3.2123 - accuracy200: 0.4136 - val_loss: 3.3026 - val_accuracy200: 0.3474 - 32s/epoch - 42ms/step
testing model: results/PCAR/W0/deepVOL_L2/h200
Evaluating performance on  test set...
1733/1733 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.101604
{'0': {'precision': 0.3164065759826421, 'recall': 0.7209334639968407, 'f1-score': 0.43979424308938736, 'support': 136738}, '1': {'precision': 0.43962862741438835, 'recall': 0.11586771676780346, 'f1-score': 0.18339910178620952, 'support': 162651}, '2': {'precision': 0.3598096221628539, 'recall': 0.22240724936339099, 'f1-score': 0.2748950512201501, 'support': 144123}, 'accuracy': 0.33703484911344, 'macro avg': {'precision': 0.3719482751866281, 'recall': 0.353069476709345, 'f1-score': 0.29936279869858234, 'support': 443512}, 'weighted avg': {'precision': 0.3757005006386956, 'recall': 0.33703484911344, 'f1-score': 0.2921799905824129, 'support': 443512}}
[[ 98579  12714  25445]
 [112218  18846  31587]
 [100761  11308  32054]]
Evaluating performance on  train set...
765/765 - 16s - 16s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948187
{'0': {'precision': 0.3430460650105507, 'recall': 0.7060409839920979, 'f1-score': 0.461743535057318, 'support': 63781}, '1': {'precision': 0.4062215675230709, 'recall': 0.14533279598226742, 'f1-score': 0.21407614589873852, 'support': 64514}, '2': {'precision': 0.36573939920795906, 'recall': 0.22448828350798145, 'f1-score': 0.2782119929096904, 'support': 67469}, 'accuracy': 0.35529515130463213, 'macro avg': {'precision': 0.3716690105805269, 'recall': 0.35862068782744894, 'f1-score': 0.318010557955249, 'support': 195764}, 'weighted avg': {'precision': 0.37168667786101184, 'recall': 0.35529515130463213, 'f1-score': 0.3168716303080542, 'support': 195764}}
[[45032  6475 12274]
 [41146  9376 13992]
 [45093  7230 15146]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976385
{'0': {'precision': 0.34524810765349034, 'recall': 0.7013763644992881, 'f1-score': 0.462723486864765, 'support': 21070}, '1': {'precision': 0.3994264645637034, 'recall': 0.13127187864644108, 'f1-score': 0.19760175646005745, 'support': 22282}, '2': {'precision': 0.34589815639777943, 'recall': 0.23621641860900497, 'f1-score': 0.2807241983480268, 'support': 21366}, 'accuracy': 0.3515250780308415, 'macro avg': {'precision': 0.3635242428716577, 'recall': 0.3562882205849114, 'f1-score': 0.3136831472242831, 'support': 64718}, 'weighted avg': {'precision': 0.3641159819719774, 'recall': 0.3515250780308415, 'f1-score': 0.31135850037991813, 'support': 64718}}
[[14778  1934  4358]
 [14171  2925  5186]
 [13855  2464  5047]]
training model: results/PCAR/W0/deepVOL_L2/h300
Epoch 1/50
765/765 - 40s - loss: 3.3115 - accuracy300: 0.3667 - val_loss: 3.3694 - val_accuracy300: 0.3290 - 40s/epoch - 52ms/step
Epoch 2/50
765/765 - 32s - loss: 3.2684 - accuracy300: 0.3780 - val_loss: 3.3385 - val_accuracy300: 0.3335 - 32s/epoch - 42ms/step
Epoch 3/50
765/765 - 33s - loss: 3.2454 - accuracy300: 0.3923 - val_loss: 3.3129 - val_accuracy300: 0.3455 - 33s/epoch - 43ms/step
Epoch 4/50
765/765 - 35s - loss: 3.2387 - accuracy300: 0.3963 - val_loss: 3.3121 - val_accuracy300: 0.3450 - 35s/epoch - 45ms/step
Epoch 5/50
765/765 - 36s - loss: 3.2361 - accuracy300: 0.3979 - val_loss: 3.3116 - val_accuracy300: 0.3473 - 36s/epoch - 47ms/step
Epoch 6/50
765/765 - 33s - loss: 3.2309 - accuracy300: 0.4006 - val_loss: 3.3113 - val_accuracy300: 0.3472 - 33s/epoch - 43ms/step
Epoch 7/50
765/765 - 34s - loss: 3.2271 - accuracy300: 0.4041 - val_loss: 3.3100 - val_accuracy300: 0.3489 - 34s/epoch - 44ms/step
Epoch 8/50
765/765 - 32s - loss: 3.2226 - accuracy300: 0.4080 - val_loss: 3.3106 - val_accuracy300: 0.3505 - 32s/epoch - 42ms/step
Epoch 9/50
765/765 - 34s - loss: 3.2195 - accuracy300: 0.4101 - val_loss: 3.3078 - val_accuracy300: 0.3530 - 34s/epoch - 45ms/step
Epoch 10/50
765/765 - 35s - loss: 3.2151 - accuracy300: 0.4120 - val_loss: 3.3119 - val_accuracy300: 0.3523 - 35s/epoch - 46ms/step
Epoch 11/50
765/765 - 35s - loss: 3.2105 - accuracy300: 0.4138 - val_loss: 3.3112 - val_accuracy300: 0.3536 - 35s/epoch - 46ms/step
Epoch 12/50
765/765 - 35s - loss: 3.2073 - accuracy300: 0.4150 - val_loss: 3.3110 - val_accuracy300: 0.3597 - 35s/epoch - 46ms/step
Epoch 13/50
765/765 - 38s - loss: 3.2035 - accuracy300: 0.4175 - val_loss: 3.3170 - val_accuracy300: 0.3539 - 38s/epoch - 49ms/step
Epoch 14/50
765/765 - 38s - loss: 3.1995 - accuracy300: 0.4185 - val_loss: 3.3152 - val_accuracy300: 0.3522 - 38s/epoch - 50ms/step
Epoch 15/50
765/765 - 38s - loss: 3.1970 - accuracy300: 0.4204 - val_loss: 3.3152 - val_accuracy300: 0.3532 - 38s/epoch - 50ms/step
Epoch 16/50
765/765 - 40s - loss: 3.1944 - accuracy300: 0.4212 - val_loss: 3.3175 - val_accuracy300: 0.3530 - 40s/epoch - 52ms/step
Epoch 17/50
765/765 - 40s - loss: 3.1896 - accuracy300: 0.4247 - val_loss: 3.3206 - val_accuracy300: 0.3506 - 40s/epoch - 53ms/step
Epoch 18/50
765/765 - 42s - loss: 3.1869 - accuracy300: 0.4251 - val_loss: 3.3251 - val_accuracy300: 0.3495 - 42s/epoch - 55ms/step
Epoch 19/50
765/765 - 42s - loss: 3.1824 - accuracy300: 0.4276 - val_loss: 3.3294 - val_accuracy300: 0.3505 - 42s/epoch - 55ms/step
testing model: results/PCAR/W0/deepVOL_L2/h300
Evaluating performance on  test set...
1733/1733 - 49s - 49s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009015
{'0': {'precision': 0.33631809245988964, 'recall': 0.538234100135318, 'f1-score': 0.41396698192982684, 'support': 147800}, '1': {'precision': 0.39124098229250165, 'recall': 0.11548223350253807, 'f1-score': 0.17832765922112429, 'support': 139476}, '2': {'precision': 0.37147785390330984, 'recall': 0.3942369236283571, 'f1-score': 0.38251915887270066, 'support': 156236}, 'accuracy': 0.35456086870253795, 'macro avg': {'precision': 0.3663456428852337, 'recall': 0.349317752422071, 'f1-score': 0.32493793334121723, 'support': 443512}, 'weighted avg': {'precision': 0.36597601709590305, 'recall': 0.35456086870253795, 'f1-score': 0.32878481716929686, 'support': 443512}}
[[79551 13524 54725]
 [73880 16107 49489]
 [83104 11538 61594]]
Evaluating performance on  train set...
765/765 - 24s - 24s/epoch - 32ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952512
{'0': {'precision': 0.3380330804391876, 'recall': 0.5663061498381622, 'f1-score': 0.42335930122757315, 'support': 63335}, '1': {'precision': 0.44823148271424135, 'recall': 0.15588584834313407, 'f1-score': 0.23132243140488298, 'support': 64791}, '2': {'precision': 0.3714209099305783, 'recall': 0.3686093616014666, 'f1-score': 0.37000979490071534, 'support': 67638}, 'accuracy': 0.36216566886659446, 'macro avg': {'precision': 0.38589515769466914, 'recall': 0.363600453260921, 'f1-score': 0.34156384251105715, 'support': 195764}, 'weighted avg': {'precision': 0.38604063388589743, 'recall': 0.36216566886659446, 'f1-score': 0.34136917668159983, 'support': 195764}}
[[35867  5703 21765]
 [34262 10100 20429]
 [35976  6730 24932]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017873
{'0': {'precision': 0.33503603028368145, 'recall': 0.5229214123006833, 'f1-score': 0.4084060710513148, 'support': 21072}, '1': {'precision': 0.4386673397274104, 'recall': 0.15840320816624134, 'f1-score': 0.23275746618454535, 'support': 21944}, '2': {'precision': 0.34565990378581885, 'recall': 0.38074831812736154, 'f1-score': 0.36235665577652554, 'support': 21702}, 'accuracy': 0.3516486912450941, 'macro avg': {'precision': 0.37312109126563686, 'recall': 0.35402431286476205, 'f1-score': 0.33450673100412853, 'support': 64718}, 'weighted avg': {'precision': 0.3737369289081225, 'recall': 0.3516486912450941, 'f1-score': 0.3334068838778875, 'support': 64718}}
[[11019  2112  7941]
 [10767  3476  7701]
 [11103  2336  8263]]
training model: results/PCAR/W0/deepVOL_L2/h500
Epoch 1/50
765/765 - 46s - loss: 3.3153 - accuracy500: 0.3685 - val_loss: 3.3496 - val_accuracy500: 0.3281 - 46s/epoch - 61ms/step
Epoch 2/50
765/765 - 39s - loss: 3.2835 - accuracy500: 0.3643 - val_loss: 3.3026 - val_accuracy500: 0.3398 - 39s/epoch - 51ms/step
Epoch 3/50
765/765 - 41s - loss: 3.2717 - accuracy500: 0.3742 - val_loss: 3.2990 - val_accuracy500: 0.3439 - 41s/epoch - 54ms/step
Epoch 4/50
765/765 - 40s - loss: 3.2609 - accuracy500: 0.3835 - val_loss: 3.2928 - val_accuracy500: 0.3487 - 40s/epoch - 53ms/step
Epoch 5/50
765/765 - 40s - loss: 3.2550 - accuracy500: 0.3872 - val_loss: 3.2875 - val_accuracy500: 0.3558 - 40s/epoch - 52ms/step
Epoch 6/50
765/765 - 38s - loss: 3.2501 - accuracy500: 0.3916 - val_loss: 3.2864 - val_accuracy500: 0.3589 - 38s/epoch - 49ms/step
Epoch 7/50
765/765 - 34s - loss: 3.2472 - accuracy500: 0.3935 - val_loss: 3.2859 - val_accuracy500: 0.3567 - 34s/epoch - 44ms/step
Epoch 8/50
765/765 - 33s - loss: 3.2415 - accuracy500: 0.3985 - val_loss: 3.2890 - val_accuracy500: 0.3563 - 33s/epoch - 44ms/step
Epoch 9/50
765/765 - 33s - loss: 3.2384 - accuracy500: 0.4006 - val_loss: 3.2903 - val_accuracy500: 0.3554 - 33s/epoch - 43ms/step
Epoch 10/50
765/765 - 32s - loss: 3.2349 - accuracy500: 0.4015 - val_loss: 3.2923 - val_accuracy500: 0.3567 - 32s/epoch - 42ms/step
Epoch 11/50
765/765 - 33s - loss: 3.2313 - accuracy500: 0.4040 - val_loss: 3.2967 - val_accuracy500: 0.3510 - 33s/epoch - 44ms/step
Epoch 12/50
765/765 - 36s - loss: 3.2275 - accuracy500: 0.4063 - val_loss: 3.2971 - val_accuracy500: 0.3527 - 36s/epoch - 47ms/step
Epoch 13/50
765/765 - 32s - loss: 3.2219 - accuracy500: 0.4089 - val_loss: 3.2934 - val_accuracy500: 0.3547 - 32s/epoch - 42ms/step
Epoch 14/50
765/765 - 33s - loss: 3.2182 - accuracy500: 0.4115 - val_loss: 3.2941 - val_accuracy500: 0.3560 - 33s/epoch - 43ms/step
Epoch 15/50
765/765 - 35s - loss: 3.2159 - accuracy500: 0.4124 - val_loss: 3.2909 - val_accuracy500: 0.3580 - 35s/epoch - 46ms/step
Epoch 16/50
765/765 - 32s - loss: 3.2135 - accuracy500: 0.4129 - val_loss: 3.2968 - val_accuracy500: 0.3535 - 32s/epoch - 42ms/step
Epoch 17/50
765/765 - 33s - loss: 3.2097 - accuracy500: 0.4156 - val_loss: 3.2970 - val_accuracy500: 0.3571 - 33s/epoch - 43ms/step
testing model: results/PCAR/W0/deepVOL_L2/h500
Evaluating performance on  test set...
1733/1733 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0975207
{'0': {'precision': 0.33913666466685694, 'recall': 0.40451592732830793, 'f1-score': 0.3689523411212288, 'support': 143935}, '1': {'precision': 0.36247252747252745, 'recall': 0.13586094692835224, 'f1-score': 0.19764219482601075, 'support': 145671}, '2': {'precision': 0.35887933931473237, 'recall': 0.5065364573181033, 'f1-score': 0.4201112802618993, 'support': 153906}, 'accuracy': 0.3516793232201158, 'macro avg': {'precision': 0.3534961771513722, 'recall': 0.34897111052492114, 'f1-score': 0.32890193873637963, 'support': 443512}, 'weighted avg': {'precision': 0.3536523362949544, 'recall': 0.3516793232201158, 'f1-score': 0.33043872112089806, 'support': 443512}}
[[58224 17568 68143]
 [54753 19791 71127]
 [58706 17241 77959]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0908263
{'0': {'precision': 0.3470884073121804, 'recall': 0.3989963785179531, 'f1-score': 0.37123667490159634, 'support': 61577}, '1': {'precision': 0.41211085801063024, 'recall': 0.19621015846237272, 'f1-score': 0.2658475856157394, 'support': 66388}, '2': {'precision': 0.3640034272250187, 'recall': 0.5012905795070723, 'f1-score': 0.42175604489697144, 'support': 67799}, 'accuracy': 0.3656545636582824, 'macro avg': {'precision': 0.37440089751594313, 'recall': 0.36549903882913276, 'f1-score': 0.35294676847143575, 'support': 195764}, 'weighted avg': {'precision': 0.37499717446057956, 'recall': 0.3656545636582824, 'f1-score': 0.3529932384516207, 'support': 195764}}
[[24569  8704 28304]
 [22283 13026 31079]
 [23934  9878 33987]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942773
{'0': {'precision': 0.34976808905380335, 'recall': 0.36429951690821255, 'f1-score': 0.35688594415522956, 'support': 20700}, '1': {'precision': 0.41379310344827586, 'recall': 0.2035704769517719, 'f1-score': 0.27288962971782355, 'support': 22518}, '2': {'precision': 0.3480985037406484, 'recall': 0.5193953488372093, 'f1-score': 0.4168346397909668, 'support': 21500}, 'accuracy': 0.3598998732964554, 'macro avg': {'precision': 0.37055323208090923, 'recall': 0.36242178089906457, 'f1-score': 0.34887007122133995, 'support': 64718}, 'weighted avg': {'precision': 0.371490317644024, 'recall': 0.3598998732964554, 'f1-score': 0.3475758286953396, 'support': 64718}}
[[ 7541  3079 10080]
 [ 7101  4584 10833]
 [ 6918  3415 11167]]
training model: results/PCAR/W0/deepVOL_L2/h1000
Epoch 1/50
765/765 - 40s - loss: 3.3231 - accuracy1000: 0.3577 - val_loss: 3.3489 - val_accuracy1000: 0.3311 - 40s/epoch - 52ms/step
Epoch 2/50
765/765 - 35s - loss: 3.2931 - accuracy1000: 0.3591 - val_loss: 3.3560 - val_accuracy1000: 0.3321 - 35s/epoch - 46ms/step
Epoch 3/50
765/765 - 33s - loss: 3.2756 - accuracy1000: 0.3710 - val_loss: 3.3526 - val_accuracy1000: 0.3344 - 33s/epoch - 44ms/step
Epoch 4/50
765/765 - 35s - loss: 3.2648 - accuracy1000: 0.3794 - val_loss: 3.3547 - val_accuracy1000: 0.3372 - 35s/epoch - 45ms/step
Epoch 5/50
765/765 - 32s - loss: 3.2568 - accuracy1000: 0.3843 - val_loss: 3.3469 - val_accuracy1000: 0.3358 - 32s/epoch - 42ms/step
Epoch 6/50
765/765 - 35s - loss: 3.2538 - accuracy1000: 0.3850 - val_loss: 3.3443 - val_accuracy1000: 0.3330 - 35s/epoch - 46ms/step
Epoch 7/50
765/765 - 33s - loss: 3.2511 - accuracy1000: 0.3881 - val_loss: 3.3327 - val_accuracy1000: 0.3327 - 33s/epoch - 43ms/step
Epoch 8/50
765/765 - 38s - loss: 3.2458 - accuracy1000: 0.3903 - val_loss: 3.3469 - val_accuracy1000: 0.3296 - 38s/epoch - 50ms/step
Epoch 9/50
765/765 - 31s - loss: 3.2386 - accuracy1000: 0.3964 - val_loss: 3.3523 - val_accuracy1000: 0.3278 - 31s/epoch - 40ms/step
Epoch 10/50
765/765 - 35s - loss: 3.2302 - accuracy1000: 0.4029 - val_loss: 3.3611 - val_accuracy1000: 0.3293 - 35s/epoch - 45ms/step
Epoch 11/50
765/765 - 33s - loss: 3.2267 - accuracy1000: 0.4061 - val_loss: 3.3700 - val_accuracy1000: 0.3273 - 33s/epoch - 43ms/step
Epoch 12/50
765/765 - 34s - loss: 3.2224 - accuracy1000: 0.4089 - val_loss: 3.3685 - val_accuracy1000: 0.3290 - 34s/epoch - 44ms/step
Epoch 13/50
765/765 - 35s - loss: 3.2192 - accuracy1000: 0.4108 - val_loss: 3.3673 - val_accuracy1000: 0.3296 - 35s/epoch - 45ms/step
Epoch 14/50
765/765 - 34s - loss: 3.2129 - accuracy1000: 0.4142 - val_loss: 3.3690 - val_accuracy1000: 0.3313 - 34s/epoch - 44ms/step
Epoch 15/50
765/765 - 33s - loss: 3.2170 - accuracy1000: 0.4119 - val_loss: 3.3769 - val_accuracy1000: 0.3302 - 33s/epoch - 43ms/step
Epoch 16/50
765/765 - 31s - loss: 3.2117 - accuracy1000: 0.4148 - val_loss: 3.3704 - val_accuracy1000: 0.3323 - 31s/epoch - 41ms/step
Epoch 17/50
765/765 - 35s - loss: 3.2088 - accuracy1000: 0.4174 - val_loss: 3.3668 - val_accuracy1000: 0.3364 - 35s/epoch - 46ms/step
testing model: results/PCAR/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
1733/1733 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.105225
{'0': {'precision': 0.34516855724566897, 'recall': 0.36950722410739056, 'f1-score': 0.3569234575027315, 'support': 140571}, '1': {'precision': 0.3235858539705748, 'recall': 0.024226708903195792, 'f1-score': 0.04507841939097668, 'support': 146161}, '2': {'precision': 0.3497621292797232, 'recall': 0.6293085852787346, 'f1-score': 0.44962699320521526, 'support': 156780}, 'accuracy': 0.3475576760042569, 'macro avg': {'precision': 0.3395055134986557, 'recall': 0.341014172763107, 'f1-score': 0.2838762900329745, 'support': 443512}, 'weighted avg': {'precision': 0.33967971078854486, 'recall': 0.3475576760042569, 'f1-score': 0.2869241738576062, 'support': 443512}}
[[51942  3937 84692]
 [43889  3541 98731]
 [54652  3465 98663]]
Evaluating performance on  train set...
765/765 - 15s - 15s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036195
{'0': {'precision': 0.34309827152479105, 'recall': 0.27877229420103516, 'f1-score': 0.3076083595554666, 'support': 60666}, '1': {'precision': 0.43758700696055686, 'recall': 0.02863041564198318, 'f1-score': 0.05374444317793229, 'support': 65874}, '2': {'precision': 0.35179583855038615, 'recall': 0.722466196694788, 'f1-score': 0.4731817622737551, 'support': 69224}, 'accuracy': 0.3514946568316953, 'macro avg': {'precision': 0.37749370567857804, 'recall': 0.34328963551260205, 'f1-score': 0.278178188335718, 'support': 195764}, 'weighted avg': {'precision': 0.3779689900321542, 'recall': 0.3514946568316953, 'f1-score': 0.28073223116780144, 'support': 195764}}
[[16912  1159 42595]
 [14433  1886 49555]
 [17947  1265 50012]]
Evaluating performance on  val set...
253/253 - 5s - 5s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079444
{'0': {'precision': 0.34328891004283674, 'recall': 0.2772039394667307, 'f1-score': 0.30672726789463894, 'support': 20815}, '1': {'precision': 0.4115, 'recall': 0.036745992766888426, 'f1-score': 0.06746731155469934, 'support': 22397}, '2': {'precision': 0.3283598344587236, 'recall': 0.7009671719520134, 'f1-score': 0.4472232111071556, 'support': 21506}, 'accuracy': 0.33480639080317687, 'macro avg': {'precision': 0.3610495815005201, 'recall': 0.3383057013952109, 'f1-score': 0.273805930185498, 'support': 64718}, 'weighted avg': {'precision': 0.3619337860009728, 'recall': 0.33480639080317687, 'f1-score': 0.27061367527099106, 'support': 64718}}
[[ 5770   622 14423]
 [ 5162   823 16412]
 [ 5876   555 15075]]
training model: results/PCAR/W0/deepVOL_L3/h10
Epoch 1/50
765/765 - 49s - loss: 3.3099 - accuracy10: 0.3679 - val_loss: 3.3453 - val_accuracy10: 0.3423 - 49s/epoch - 64ms/step
Epoch 2/50
765/765 - 44s - loss: 3.2682 - accuracy10: 0.3728 - val_loss: 3.2733 - val_accuracy10: 0.3875 - 44s/epoch - 58ms/step
Epoch 3/50
765/765 - 43s - loss: 3.1689 - accuracy10: 0.4248 - val_loss: 3.2470 - val_accuracy10: 0.3987 - 43s/epoch - 57ms/step
Epoch 4/50
765/765 - 45s - loss: 3.1272 - accuracy10: 0.4450 - val_loss: 3.1932 - val_accuracy10: 0.4278 - 45s/epoch - 58ms/step
Epoch 5/50
765/765 - 44s - loss: 3.0727 - accuracy10: 0.4719 - val_loss: 3.1349 - val_accuracy10: 0.4507 - 44s/epoch - 57ms/step
Epoch 6/50
765/765 - 46s - loss: 3.0388 - accuracy10: 0.4835 - val_loss: 3.0844 - val_accuracy10: 0.4697 - 46s/epoch - 60ms/step
Epoch 7/50
765/765 - 43s - loss: 3.0201 - accuracy10: 0.4902 - val_loss: 3.0738 - val_accuracy10: 0.4733 - 43s/epoch - 56ms/step
Epoch 8/50
765/765 - 42s - loss: 3.0054 - accuracy10: 0.4950 - val_loss: 3.0616 - val_accuracy10: 0.4770 - 42s/epoch - 55ms/step
Epoch 9/50
765/765 - 44s - loss: 2.9948 - accuracy10: 0.4976 - val_loss: 3.0635 - val_accuracy10: 0.4746 - 44s/epoch - 58ms/step
Epoch 10/50
765/765 - 43s - loss: 2.9869 - accuracy10: 0.5000 - val_loss: 3.0485 - val_accuracy10: 0.4811 - 43s/epoch - 56ms/step
Epoch 11/50
765/765 - 43s - loss: 2.9807 - accuracy10: 0.5017 - val_loss: 3.0498 - val_accuracy10: 0.4808 - 43s/epoch - 56ms/step
Epoch 12/50
765/765 - 42s - loss: 2.9744 - accuracy10: 0.5032 - val_loss: 3.0433 - val_accuracy10: 0.4815 - 42s/epoch - 54ms/step
Epoch 13/50
765/765 - 43s - loss: 2.9695 - accuracy10: 0.5048 - val_loss: 3.0437 - val_accuracy10: 0.4794 - 43s/epoch - 56ms/step
Epoch 14/50
765/765 - 42s - loss: 2.9644 - accuracy10: 0.5060 - val_loss: 3.0366 - val_accuracy10: 0.4847 - 42s/epoch - 54ms/step
Epoch 15/50
765/765 - 43s - loss: 2.9591 - accuracy10: 0.5076 - val_loss: 3.0374 - val_accuracy10: 0.4841 - 43s/epoch - 56ms/step
Epoch 16/50
765/765 - 42s - loss: 2.9546 - accuracy10: 0.5086 - val_loss: 3.0304 - val_accuracy10: 0.4866 - 42s/epoch - 55ms/step
Epoch 17/50
765/765 - 45s - loss: 2.9491 - accuracy10: 0.5102 - val_loss: 3.0383 - val_accuracy10: 0.4832 - 45s/epoch - 59ms/step
Epoch 18/50
765/765 - 43s - loss: 2.9461 - accuracy10: 0.5118 - val_loss: 3.0297 - val_accuracy10: 0.4853 - 43s/epoch - 57ms/step
Epoch 19/50
765/765 - 43s - loss: 2.9421 - accuracy10: 0.5124 - val_loss: 3.0269 - val_accuracy10: 0.4865 - 43s/epoch - 56ms/step
Epoch 20/50
765/765 - 46s - loss: 2.9370 - accuracy10: 0.5137 - val_loss: 3.0408 - val_accuracy10: 0.4833 - 46s/epoch - 60ms/step
Epoch 21/50
765/765 - 44s - loss: 2.9343 - accuracy10: 0.5150 - val_loss: 3.0187 - val_accuracy10: 0.4901 - 44s/epoch - 57ms/step
Epoch 22/50
765/765 - 43s - loss: 2.9302 - accuracy10: 0.5145 - val_loss: 3.0248 - val_accuracy10: 0.4875 - 43s/epoch - 56ms/step
Epoch 23/50
765/765 - 43s - loss: 2.9268 - accuracy10: 0.5160 - val_loss: 3.0273 - val_accuracy10: 0.4884 - 43s/epoch - 57ms/step
Epoch 24/50
765/765 - 43s - loss: 2.9227 - accuracy10: 0.5181 - val_loss: 3.0208 - val_accuracy10: 0.4892 - 43s/epoch - 56ms/step
Epoch 25/50
765/765 - 42s - loss: 2.9188 - accuracy10: 0.5192 - val_loss: 3.0220 - val_accuracy10: 0.4894 - 42s/epoch - 55ms/step
Epoch 26/50
765/765 - 42s - loss: 2.9155 - accuracy10: 0.5197 - val_loss: 3.0157 - val_accuracy10: 0.4919 - 42s/epoch - 55ms/step
Epoch 27/50
765/765 - 41s - loss: 2.9113 - accuracy10: 0.5205 - val_loss: 3.0218 - val_accuracy10: 0.4902 - 41s/epoch - 54ms/step
Epoch 28/50
765/765 - 45s - loss: 2.9075 - accuracy10: 0.5217 - val_loss: 3.0333 - val_accuracy10: 0.4857 - 45s/epoch - 59ms/step
Epoch 29/50
765/765 - 42s - loss: 2.9059 - accuracy10: 0.5213 - val_loss: 3.0199 - val_accuracy10: 0.4906 - 42s/epoch - 54ms/step
Epoch 30/50
765/765 - 46s - loss: 2.9016 - accuracy10: 0.5230 - val_loss: 3.0254 - val_accuracy10: 0.4907 - 46s/epoch - 60ms/step
Epoch 31/50
765/765 - 43s - loss: 2.8988 - accuracy10: 0.5230 - val_loss: 3.0287 - val_accuracy10: 0.4897 - 43s/epoch - 56ms/step
Epoch 32/50
765/765 - 45s - loss: 2.8953 - accuracy10: 0.5254 - val_loss: 3.0147 - val_accuracy10: 0.4956 - 45s/epoch - 59ms/step
Epoch 33/50
765/765 - 45s - loss: 2.8921 - accuracy10: 0.5246 - val_loss: 3.0198 - val_accuracy10: 0.4929 - 45s/epoch - 59ms/step
Epoch 34/50
765/765 - 44s - loss: 2.8910 - accuracy10: 0.5258 - val_loss: 3.0242 - val_accuracy10: 0.4923 - 44s/epoch - 57ms/step
Epoch 35/50
765/765 - 43s - loss: 2.8866 - accuracy10: 0.5271 - val_loss: 3.0255 - val_accuracy10: 0.4926 - 43s/epoch - 57ms/step
Epoch 36/50
765/765 - 46s - loss: 2.8842 - accuracy10: 0.5274 - val_loss: 3.0167 - val_accuracy10: 0.4953 - 46s/epoch - 60ms/step
Epoch 37/50
765/765 - 45s - loss: 2.8818 - accuracy10: 0.5285 - val_loss: 3.0186 - val_accuracy10: 0.4934 - 45s/epoch - 59ms/step
Epoch 38/50
765/765 - 44s - loss: 2.8782 - accuracy10: 0.5281 - val_loss: 3.0141 - val_accuracy10: 0.4930 - 44s/epoch - 57ms/step
Epoch 39/50
765/765 - 41s - loss: 2.8754 - accuracy10: 0.5295 - val_loss: 3.0098 - val_accuracy10: 0.4999 - 41s/epoch - 54ms/step
Epoch 40/50
765/765 - 43s - loss: 2.8724 - accuracy10: 0.5308 - val_loss: 3.0213 - val_accuracy10: 0.4936 - 43s/epoch - 56ms/step
Epoch 41/50
765/765 - 41s - loss: 2.8698 - accuracy10: 0.5313 - val_loss: 3.0270 - val_accuracy10: 0.4927 - 41s/epoch - 54ms/step
Epoch 42/50
765/765 - 44s - loss: 2.8652 - accuracy10: 0.5315 - val_loss: 3.0342 - val_accuracy10: 0.4919 - 44s/epoch - 57ms/step
Epoch 43/50
765/765 - 41s - loss: 2.8632 - accuracy10: 0.5322 - val_loss: 3.0269 - val_accuracy10: 0.4934 - 41s/epoch - 54ms/step
Epoch 44/50
765/765 - 42s - loss: 2.8598 - accuracy10: 0.5333 - val_loss: 3.0306 - val_accuracy10: 0.4924 - 42s/epoch - 54ms/step
Epoch 45/50
765/765 - 44s - loss: 2.8589 - accuracy10: 0.5332 - val_loss: 3.0218 - val_accuracy10: 0.4921 - 44s/epoch - 57ms/step
Epoch 46/50
765/765 - 45s - loss: 2.8551 - accuracy10: 0.5346 - val_loss: 3.0254 - val_accuracy10: 0.4924 - 45s/epoch - 59ms/step
Epoch 47/50
765/765 - 43s - loss: 2.8527 - accuracy10: 0.5343 - val_loss: 3.0215 - val_accuracy10: 0.4935 - 43s/epoch - 56ms/step
Epoch 48/50
765/765 - 41s - loss: 2.8484 - accuracy10: 0.5360 - val_loss: 3.0224 - val_accuracy10: 0.4919 - 41s/epoch - 54ms/step
Epoch 49/50
765/765 - 43s - loss: 2.8460 - accuracy10: 0.5365 - val_loss: 3.0268 - val_accuracy10: 0.4934 - 43s/epoch - 57ms/step
testing model: results/PCAR/W0/deepVOL_L3/h10
Evaluating performance on  test set...
1733/1733 - 43s - 43s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0313808
{'0': {'precision': 0.45996378440160784, 'recall': 0.496451541361721, 'f1-score': 0.4775116491457293, 'support': 144288}, '1': {'precision': 0.5524184043031952, 'recall': 0.33615445304400554, 'f1-score': 0.4179688925101239, 'support': 153367}, '2': {'precision': 0.44788945343838066, 'recall': 0.5971122400707543, 'f1-score': 0.5118465864846361, 'support': 145857}, 'accuracy': 0.4741247136492361, 'macro avg': {'precision': 0.48675721404772787, 'recall': 0.47657274482549355, 'f1-score': 0.46910904271349646, 'support': 443512}, 'weighted avg': {'precision': 0.4879638430226673, 'recall': 0.4741247136492361, 'f1-score': 0.46821335958086524, 'support': 443512}}
[[71632 22302 50354]
 [44807 51555 57005]
 [39295 19469 87093]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9857775
{'0': {'precision': 0.5054701384246654, 'recall': 0.475206548230353, 'f1-score': 0.4898713775558575, 'support': 65239}, '1': {'precision': 0.581554106064903, 'recall': 0.4452802680150138, 'f1-score': 0.5043745607870695, 'support': 64474}, '2': {'precision': 0.47294421912655027, 'recall': 0.6090899456480598, 'f1-score': 0.5324518912623415, 'support': 66051}, 'accuracy': 0.5105228744815186, 'macro avg': {'precision': 0.5199894878720396, 'recall': 0.5098589206311422, 'f1-score': 0.5088992765350895, 'support': 195764}, 'weighted avg': {'precision': 0.5195537709315455, 'recall': 0.5105228744815186, 'f1-score': 0.5090146508158857, 'support': 195764}}
[[31002 10774 23463]
 [14394 28709 21371]
 [15937  9883 40231]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 26ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0028808
{'0': {'precision': 0.48233907097382694, 'recall': 0.4763412816691505, 'f1-score': 0.47932141434496334, 'support': 21472}, '1': {'precision': 0.5766624169630276, 'recall': 0.40832422673065044, 'f1-score': 0.4781084840055632, 'support': 21047}, '2': {'precision': 0.46508213911219853, 'recall': 0.5993963692058201, 'f1-score': 0.523765474620638, 'support': 22199}, 'accuracy': 0.49643066843845607, 'macro avg': {'precision': 0.5080278756830178, 'recall': 0.49468729253520705, 'f1-score': 0.4937317909903882, 'support': 64718}, 'weighted avg': {'precision': 0.507094731418192, 'recall': 0.49643066843845607, 'f1-score': 0.49417176740294333, 'support': 64718}}
[[10228  3142  8102]
 [ 5251  8594  7202]
 [ 5726  3167 13306]]
training model: results/PCAR/W0/deepVOL_L3/h20
Epoch 1/50
765/765 - 50s - loss: 3.3056 - accuracy20: 0.3645 - val_loss: 3.3203 - val_accuracy20: 0.3403 - 50s/epoch - 65ms/step
Epoch 2/50
765/765 - 43s - loss: 3.2392 - accuracy20: 0.3981 - val_loss: 3.2970 - val_accuracy20: 0.3741 - 43s/epoch - 56ms/step
Epoch 3/50
765/765 - 42s - loss: 3.2003 - accuracy20: 0.4185 - val_loss: 3.2547 - val_accuracy20: 0.4025 - 42s/epoch - 55ms/step
Epoch 4/50
765/765 - 43s - loss: 3.1603 - accuracy20: 0.4395 - val_loss: 3.1994 - val_accuracy20: 0.4286 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 45s - loss: 3.1294 - accuracy20: 0.4530 - val_loss: 3.1818 - val_accuracy20: 0.4366 - 45s/epoch - 59ms/step
Epoch 6/50
765/765 - 43s - loss: 3.1137 - accuracy20: 0.4595 - val_loss: 3.1579 - val_accuracy20: 0.4430 - 43s/epoch - 56ms/step
Epoch 7/50
765/765 - 46s - loss: 3.0997 - accuracy20: 0.4655 - val_loss: 3.1656 - val_accuracy20: 0.4383 - 46s/epoch - 60ms/step
Epoch 8/50
765/765 - 43s - loss: 3.0916 - accuracy20: 0.4682 - val_loss: 3.1550 - val_accuracy20: 0.4442 - 43s/epoch - 57ms/step
Epoch 9/50
765/765 - 43s - loss: 3.0852 - accuracy20: 0.4705 - val_loss: 3.1475 - val_accuracy20: 0.4467 - 43s/epoch - 56ms/step
Epoch 10/50
765/765 - 42s - loss: 3.0801 - accuracy20: 0.4719 - val_loss: 3.1404 - val_accuracy20: 0.4480 - 42s/epoch - 55ms/step
Epoch 11/50
765/765 - 43s - loss: 3.0746 - accuracy20: 0.4737 - val_loss: 3.1455 - val_accuracy20: 0.4493 - 43s/epoch - 56ms/step
Epoch 12/50
765/765 - 44s - loss: 3.0702 - accuracy20: 0.4757 - val_loss: 3.1318 - val_accuracy20: 0.4538 - 44s/epoch - 57ms/step
Epoch 13/50
765/765 - 43s - loss: 3.0655 - accuracy20: 0.4767 - val_loss: 3.1280 - val_accuracy20: 0.4550 - 43s/epoch - 57ms/step
Epoch 14/50
765/765 - 42s - loss: 3.0611 - accuracy20: 0.4784 - val_loss: 3.1270 - val_accuracy20: 0.4561 - 42s/epoch - 54ms/step
Epoch 15/50
765/765 - 42s - loss: 3.0574 - accuracy20: 0.4795 - val_loss: 3.1298 - val_accuracy20: 0.4542 - 42s/epoch - 55ms/step
Epoch 16/50
765/765 - 46s - loss: 3.0518 - accuracy20: 0.4810 - val_loss: 3.1355 - val_accuracy20: 0.4523 - 46s/epoch - 60ms/step
Epoch 17/50
765/765 - 43s - loss: 3.0479 - accuracy20: 0.4816 - val_loss: 3.1295 - val_accuracy20: 0.4562 - 43s/epoch - 56ms/step
Epoch 18/50
765/765 - 41s - loss: 3.0453 - accuracy20: 0.4834 - val_loss: 3.1316 - val_accuracy20: 0.4546 - 41s/epoch - 54ms/step
Epoch 19/50
765/765 - 41s - loss: 3.0411 - accuracy20: 0.4845 - val_loss: 3.1264 - val_accuracy20: 0.4549 - 41s/epoch - 53ms/step
Epoch 20/50
765/765 - 44s - loss: 3.0386 - accuracy20: 0.4859 - val_loss: 3.1269 - val_accuracy20: 0.4552 - 44s/epoch - 58ms/step
Epoch 21/50
765/765 - 42s - loss: 3.0350 - accuracy20: 0.4862 - val_loss: 3.1275 - val_accuracy20: 0.4551 - 42s/epoch - 55ms/step
Epoch 22/50
765/765 - 42s - loss: 3.0307 - accuracy20: 0.4876 - val_loss: 3.1279 - val_accuracy20: 0.4560 - 42s/epoch - 54ms/step
Epoch 23/50
765/765 - 43s - loss: 3.0275 - accuracy20: 0.4883 - val_loss: 3.1297 - val_accuracy20: 0.4555 - 43s/epoch - 57ms/step
Epoch 24/50
765/765 - 44s - loss: 3.0237 - accuracy20: 0.4902 - val_loss: 3.1368 - val_accuracy20: 0.4546 - 44s/epoch - 58ms/step
Epoch 25/50
765/765 - 43s - loss: 3.0221 - accuracy20: 0.4907 - val_loss: 3.1291 - val_accuracy20: 0.4568 - 43s/epoch - 56ms/step
Epoch 26/50
765/765 - 43s - loss: 3.0175 - accuracy20: 0.4916 - val_loss: 3.1388 - val_accuracy20: 0.4542 - 43s/epoch - 56ms/step
Epoch 27/50
765/765 - 42s - loss: 3.0162 - accuracy20: 0.4928 - val_loss: 3.1396 - val_accuracy20: 0.4539 - 42s/epoch - 55ms/step
Epoch 28/50
765/765 - 43s - loss: 3.0120 - accuracy20: 0.4931 - val_loss: 3.1330 - val_accuracy20: 0.4554 - 43s/epoch - 56ms/step
Epoch 29/50
765/765 - 42s - loss: 3.0082 - accuracy20: 0.4951 - val_loss: 3.1328 - val_accuracy20: 0.4559 - 42s/epoch - 55ms/step
testing model: results/PCAR/W0/deepVOL_L3/h20
Evaluating performance on  test set...
1733/1733 - 43s - 43s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0546432
{'0': {'precision': 0.41422289100410603, 'recall': 0.5001866341758868, 'f1-score': 0.4531640319673308, 'support': 141989}, '1': {'precision': 0.5124380403458213, 'recall': 0.28264781245827425, 'f1-score': 0.3643367332303392, 'support': 157277}, '2': {'precision': 0.4283779262409204, 'recall': 0.5503168198771543, 'f1-score': 0.48175098315288634, 'support': 144246}, 'accuracy': 0.43934775158282074, 'macro avg': {'precision': 0.4516796191969492, 'recall': 0.44438375550377174, 'f1-score': 0.4330839161168521, 'support': 443512}, 'weighted avg': {'precision': 0.45365540073504107, 'recall': 0.43934775158282074, 'f1-score': 0.43096184194147763, 'support': 443512}}
[[71021 20335 50633]
 [57531 44454 55292]
 [42904 21961 79381]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0282011
{'0': {'precision': 0.4509465144230769, 'recall': 0.46059294724242705, 'f1-score': 0.4557186887934045, 'support': 65166}, '1': {'precision': 0.5360006954556321, 'recall': 0.38407512380477776, 'f1-score': 0.4474947154508423, 'support': 64214}, '2': {'precision': 0.44810135711795746, 'recall': 0.5615509761388287, 'f1-score': 0.49845228146414844, 'support': 66384}, 'accuracy': 0.46972885719539853, 'macro avg': {'precision': 0.4783495223322222, 'recall': 0.46873968239534447, 'f1-score': 0.4672218952361318, 'support': 195764}, 'weighted avg': {'precision': 0.47788096742915287, 'recall': 0.46972885719539853, 'f1-score': 0.46751213698426375, 'support': 195764}}
[[30015  9997 25154]
 [18792 24663 20759]
 [17753 11353 37278]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 29ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0417669
{'0': {'precision': 0.43737166324435317, 'recall': 0.47677672076105204, 'f1-score': 0.4562248995983936, 'support': 21444}, '1': {'precision': 0.5293152319856781, 'recall': 0.3319144955329997, 'f1-score': 0.4079919505533995, 'support': 21379}, '2': {'precision': 0.4378937571592211, 'recall': 0.5587120347111213, 'f1-score': 0.49097951074632257, 'support': 21895}, 'accuracy': 0.4566426651008993, 'macro avg': {'precision': 0.46819355079641745, 'recall': 0.455801083668391, 'f1-score': 0.4517321202993719, 'support': 64718}, 'weighted avg': {'precision': 0.46792101276669346, 'recall': 0.4566426651008993, 'f1-score': 0.45204955415278303, 'support': 64718}}
[[10224  2818  8402]
 [ 6982  7096  7301]
 [ 6170  3492 12233]]
training model: results/PCAR/W0/deepVOL_L3/h30
Epoch 1/50
765/765 - 53s - loss: 3.3197 - accuracy30: 0.3610 - val_loss: 3.3161 - val_accuracy30: 0.3466 - 53s/epoch - 69ms/step
Epoch 2/50
765/765 - 43s - loss: 3.2802 - accuracy30: 0.3700 - val_loss: 3.3287 - val_accuracy30: 0.3481 - 43s/epoch - 57ms/step
Epoch 3/50
765/765 - 43s - loss: 3.2468 - accuracy30: 0.3946 - val_loss: 3.2859 - val_accuracy30: 0.3794 - 43s/epoch - 56ms/step
Epoch 4/50
765/765 - 41s - loss: 3.2194 - accuracy30: 0.4117 - val_loss: 3.2724 - val_accuracy30: 0.3912 - 41s/epoch - 54ms/step
Epoch 5/50
765/765 - 42s - loss: 3.2002 - accuracy30: 0.4203 - val_loss: 3.2576 - val_accuracy30: 0.4013 - 42s/epoch - 55ms/step
Epoch 6/50
765/765 - 43s - loss: 3.1868 - accuracy30: 0.4252 - val_loss: 3.2523 - val_accuracy30: 0.4015 - 43s/epoch - 56ms/step
Epoch 7/50
765/765 - 45s - loss: 3.1789 - accuracy30: 0.4299 - val_loss: 3.2457 - val_accuracy30: 0.4017 - 45s/epoch - 59ms/step
Epoch 8/50
765/765 - 43s - loss: 3.1723 - accuracy30: 0.4325 - val_loss: 3.2253 - val_accuracy30: 0.4132 - 43s/epoch - 57ms/step
Epoch 9/50
765/765 - 44s - loss: 3.1671 - accuracy30: 0.4352 - val_loss: 3.2203 - val_accuracy30: 0.4127 - 44s/epoch - 58ms/step
Epoch 10/50
765/765 - 45s - loss: 3.1610 - accuracy30: 0.4378 - val_loss: 3.2143 - val_accuracy30: 0.4151 - 45s/epoch - 59ms/step
Epoch 11/50
765/765 - 45s - loss: 3.1565 - accuracy30: 0.4395 - val_loss: 3.2070 - val_accuracy30: 0.4174 - 45s/epoch - 59ms/step
Epoch 12/50
765/765 - 45s - loss: 3.1522 - accuracy30: 0.4412 - val_loss: 3.2136 - val_accuracy30: 0.4156 - 45s/epoch - 58ms/step
Epoch 13/50
765/765 - 45s - loss: 3.1479 - accuracy30: 0.4424 - val_loss: 3.2206 - val_accuracy30: 0.4126 - 45s/epoch - 59ms/step
Epoch 14/50
765/765 - 54s - loss: 3.1443 - accuracy30: 0.4437 - val_loss: 3.2090 - val_accuracy30: 0.4166 - 54s/epoch - 70ms/step
Epoch 15/50
765/765 - 47s - loss: 3.1414 - accuracy30: 0.4454 - val_loss: 3.2058 - val_accuracy30: 0.4170 - 47s/epoch - 62ms/step
Epoch 16/50
765/765 - 46s - loss: 3.1362 - accuracy30: 0.4470 - val_loss: 3.2073 - val_accuracy30: 0.4171 - 46s/epoch - 60ms/step
Epoch 17/50
765/765 - 45s - loss: 3.1337 - accuracy30: 0.4487 - val_loss: 3.2126 - val_accuracy30: 0.4166 - 45s/epoch - 58ms/step
Epoch 18/50
765/765 - 46s - loss: 3.1300 - accuracy30: 0.4494 - val_loss: 3.2100 - val_accuracy30: 0.4175 - 46s/epoch - 61ms/step
Epoch 19/50
765/765 - 48s - loss: 3.1257 - accuracy30: 0.4517 - val_loss: 3.2105 - val_accuracy30: 0.4165 - 48s/epoch - 63ms/step
Epoch 20/50
765/765 - 45s - loss: 3.1219 - accuracy30: 0.4518 - val_loss: 3.2086 - val_accuracy30: 0.4184 - 45s/epoch - 58ms/step
Epoch 21/50
765/765 - 45s - loss: 3.1210 - accuracy30: 0.4517 - val_loss: 3.2025 - val_accuracy30: 0.4202 - 45s/epoch - 59ms/step
Epoch 22/50
765/765 - 45s - loss: 3.1167 - accuracy30: 0.4537 - val_loss: 3.2086 - val_accuracy30: 0.4184 - 45s/epoch - 59ms/step
Epoch 23/50
765/765 - 48s - loss: 3.1127 - accuracy30: 0.4569 - val_loss: 3.2105 - val_accuracy30: 0.4168 - 48s/epoch - 63ms/step
Epoch 24/50
765/765 - 43s - loss: 3.1092 - accuracy30: 0.4560 - val_loss: 3.2120 - val_accuracy30: 0.4181 - 43s/epoch - 57ms/step
Epoch 25/50
765/765 - 44s - loss: 3.1058 - accuracy30: 0.4588 - val_loss: 3.2187 - val_accuracy30: 0.4149 - 44s/epoch - 58ms/step
Epoch 26/50
765/765 - 43s - loss: 3.1026 - accuracy30: 0.4600 - val_loss: 3.2168 - val_accuracy30: 0.4155 - 43s/epoch - 57ms/step
Epoch 27/50
765/765 - 46s - loss: 3.1006 - accuracy30: 0.4605 - val_loss: 3.2228 - val_accuracy30: 0.4150 - 46s/epoch - 60ms/step
Epoch 28/50
765/765 - 43s - loss: 3.0974 - accuracy30: 0.4618 - val_loss: 3.2119 - val_accuracy30: 0.4181 - 43s/epoch - 56ms/step
Epoch 29/50
765/765 - 45s - loss: 3.0929 - accuracy30: 0.4638 - val_loss: 3.2253 - val_accuracy30: 0.4141 - 45s/epoch - 58ms/step
Epoch 30/50
765/765 - 45s - loss: 3.0899 - accuracy30: 0.4649 - val_loss: 3.2158 - val_accuracy30: 0.4191 - 45s/epoch - 59ms/step
Epoch 31/50
765/765 - 45s - loss: 3.0875 - accuracy30: 0.4651 - val_loss: 3.2242 - val_accuracy30: 0.4153 - 45s/epoch - 59ms/step
testing model: results/PCAR/W0/deepVOL_L3/h30
Evaluating performance on  test set...
1733/1733 - 41s - 41s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0724305
{'0': {'precision': 0.40156484015906624, 'recall': 0.43980005232011427, 'f1-score': 0.4198136606139548, 'support': 141437}, '1': {'precision': 0.48658967261620695, 'recall': 0.19474987743771607, 'f1-score': 0.27816755712174607, 'support': 157063}, '2': {'precision': 0.40156193243734106, 'recall': 0.6251275756489119, 'f1-score': 0.48900360882300586, 'support': 145012}, 'accuracy': 0.413614513248796, 'macro avg': {'precision': 0.42990548173753806, 'recall': 0.4198925018022474, 'f1-score': 0.3956616088529022, 'support': 443512}, 'weighted avg': {'precision': 0.43167413507255914, 'recall': 0.413614513248796, 'f1-score': 0.3922744075991415, 'support': 443512}}
[[62204 16561 62672]
 [54052 30588 72423]
 [38648 15713 90651]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.053582
{'0': {'precision': 0.43227544700654325, 'recall': 0.3816084142894651, 'f1-score': 0.40536483327180994, 'support': 64747}, '1': {'precision': 0.5103362174089774, 'recall': 0.27165664652334515, 'f1-score': 0.35457158706944375, 'support': 64703}, '2': {'precision': 0.41313697630659346, 'recall': 0.6489429079832313, 'f1-score': 0.5048627975457244, 'support': 66314}, 'accuracy': 0.4358257902372244, 'macro avg': {'precision': 0.45191621357403805, 'recall': 0.4340693229320139, 'f1-score': 0.4215997392956594, 'support': 195764}, 'weighted avg': {'precision': 0.4515926732654684, 'recall': 0.4358257902372244, 'f1-score': 0.4222812867250938, 'support': 195764}}
[[24708  8496 31543]
 [17539 17577 29587]
 [14911  8369 43034]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0655178
{'0': {'precision': 0.415036346782456, 'recall': 0.4025076886680861, 'f1-score': 0.40867601844734824, 'support': 21135}, '1': {'precision': 0.4991936248932739, 'recall': 0.23862863362205797, 'f1-score': 0.3229013254786451, 'support': 22051}, '2': {'precision': 0.4, 'recall': 0.6256734163106075, 'f1-score': 0.4880098529305223, 'support': 21532}, 'accuracy': 0.42091844618189683, 'macro avg': {'precision': 0.43807665722524325, 'recall': 0.4222699128669172, 'f1-score': 0.40652906561883856, 'support': 64718}, 'weighted avg': {'precision': 0.43870811538936294, 'recall': 0.42091844618189683, 'f1-score': 0.4058452506461002, 'support': 64718}}
[[ 8507  2519 10109]
 [ 6690  5262 10099]
 [ 5300  2760 13472]]
training model: results/PCAR/W0/deepVOL_L3/h50
Epoch 1/50
765/765 - 48s - loss: 3.3134 - accuracy50: 0.3620 - val_loss: 3.3222 - val_accuracy50: 0.3334 - 48s/epoch - 63ms/step
Epoch 2/50
765/765 - 41s - loss: 3.2947 - accuracy50: 0.3596 - val_loss: 3.3082 - val_accuracy50: 0.3300 - 41s/epoch - 54ms/step
Epoch 3/50
765/765 - 41s - loss: 3.2818 - accuracy50: 0.3654 - val_loss: 3.3189 - val_accuracy50: 0.3319 - 41s/epoch - 54ms/step
Epoch 4/50
765/765 - 40s - loss: 3.2645 - accuracy50: 0.3798 - val_loss: 3.3034 - val_accuracy50: 0.3364 - 40s/epoch - 53ms/step
Epoch 5/50
765/765 - 40s - loss: 3.2592 - accuracy50: 0.3832 - val_loss: 3.3060 - val_accuracy50: 0.3404 - 40s/epoch - 52ms/step
Epoch 6/50
765/765 - 42s - loss: 3.2483 - accuracy50: 0.3947 - val_loss: 3.2935 - val_accuracy50: 0.3509 - 42s/epoch - 54ms/step
Epoch 7/50
765/765 - 42s - loss: 3.2381 - accuracy50: 0.4043 - val_loss: 3.2798 - val_accuracy50: 0.3639 - 42s/epoch - 55ms/step
Epoch 8/50
765/765 - 42s - loss: 3.2279 - accuracy50: 0.4109 - val_loss: 3.2746 - val_accuracy50: 0.3717 - 42s/epoch - 55ms/step
Epoch 9/50
765/765 - 42s - loss: 3.2196 - accuracy50: 0.4164 - val_loss: 3.2614 - val_accuracy50: 0.3802 - 42s/epoch - 54ms/step
Epoch 10/50
765/765 - 43s - loss: 3.2119 - accuracy50: 0.4205 - val_loss: 3.2519 - val_accuracy50: 0.3871 - 43s/epoch - 56ms/step
Epoch 11/50
765/765 - 46s - loss: 3.2086 - accuracy50: 0.4215 - val_loss: 3.2563 - val_accuracy50: 0.3877 - 46s/epoch - 60ms/step
Epoch 12/50
765/765 - 41s - loss: 3.2048 - accuracy50: 0.4227 - val_loss: 3.2540 - val_accuracy50: 0.3869 - 41s/epoch - 53ms/step
Epoch 13/50
765/765 - 42s - loss: 3.2003 - accuracy50: 0.4259 - val_loss: 3.2497 - val_accuracy50: 0.3911 - 42s/epoch - 54ms/step
Epoch 14/50
765/765 - 41s - loss: 3.1967 - accuracy50: 0.4260 - val_loss: 3.2467 - val_accuracy50: 0.3947 - 41s/epoch - 54ms/step
Epoch 15/50
765/765 - 42s - loss: 3.1928 - accuracy50: 0.4272 - val_loss: 3.2435 - val_accuracy50: 0.3977 - 42s/epoch - 55ms/step
Epoch 16/50
765/765 - 41s - loss: 3.1888 - accuracy50: 0.4286 - val_loss: 3.2482 - val_accuracy50: 0.3928 - 41s/epoch - 54ms/step
Epoch 17/50
765/765 - 40s - loss: 3.1859 - accuracy50: 0.4305 - val_loss: 3.2424 - val_accuracy50: 0.3986 - 40s/epoch - 53ms/step
Epoch 18/50
765/765 - 41s - loss: 3.1814 - accuracy50: 0.4334 - val_loss: 3.2431 - val_accuracy50: 0.3948 - 41s/epoch - 53ms/step
Epoch 19/50
765/765 - 43s - loss: 3.1798 - accuracy50: 0.4328 - val_loss: 3.2378 - val_accuracy50: 0.3994 - 43s/epoch - 56ms/step
Epoch 20/50
765/765 - 47s - loss: 3.1760 - accuracy50: 0.4349 - val_loss: 3.2402 - val_accuracy50: 0.3998 - 47s/epoch - 62ms/step
Epoch 21/50
765/765 - 44s - loss: 3.1744 - accuracy50: 0.4365 - val_loss: 3.2394 - val_accuracy50: 0.4012 - 44s/epoch - 58ms/step
Epoch 22/50
765/765 - 41s - loss: 3.1722 - accuracy50: 0.4359 - val_loss: 3.2344 - val_accuracy50: 0.4025 - 41s/epoch - 53ms/step
Epoch 23/50
765/765 - 45s - loss: 3.1687 - accuracy50: 0.4379 - val_loss: 3.2353 - val_accuracy50: 0.4016 - 45s/epoch - 59ms/step
Epoch 24/50
765/765 - 43s - loss: 3.1661 - accuracy50: 0.4380 - val_loss: 3.2390 - val_accuracy50: 0.4000 - 43s/epoch - 57ms/step
Epoch 25/50
765/765 - 42s - loss: 3.1623 - accuracy50: 0.4402 - val_loss: 3.2354 - val_accuracy50: 0.4053 - 42s/epoch - 55ms/step
Epoch 26/50
765/765 - 45s - loss: 3.1605 - accuracy50: 0.4410 - val_loss: 3.2344 - val_accuracy50: 0.4049 - 45s/epoch - 59ms/step
Epoch 27/50
765/765 - 44s - loss: 3.1555 - accuracy50: 0.4425 - val_loss: 3.2440 - val_accuracy50: 0.4004 - 44s/epoch - 58ms/step
Epoch 28/50
765/765 - 44s - loss: 3.1523 - accuracy50: 0.4449 - val_loss: 3.2443 - val_accuracy50: 0.4031 - 44s/epoch - 58ms/step
Epoch 29/50
765/765 - 43s - loss: 3.1505 - accuracy50: 0.4459 - val_loss: 3.2469 - val_accuracy50: 0.4024 - 43s/epoch - 57ms/step
Epoch 30/50
765/765 - 41s - loss: 3.1477 - accuracy50: 0.4472 - val_loss: 3.2475 - val_accuracy50: 0.4006 - 41s/epoch - 54ms/step
Epoch 31/50
765/765 - 42s - loss: 3.1435 - accuracy50: 0.4488 - val_loss: 3.2499 - val_accuracy50: 0.3994 - 42s/epoch - 55ms/step
Epoch 32/50
765/765 - 41s - loss: 3.1421 - accuracy50: 0.4482 - val_loss: 3.2540 - val_accuracy50: 0.3964 - 41s/epoch - 53ms/step
testing model: results/PCAR/W0/deepVOL_L3/h50
Evaluating performance on  test set...
1733/1733 - 44s - 44s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0807427
{'0': {'precision': 0.35619520222147943, 'recall': 0.41606162763633087, 'f1-score': 0.3838079505747007, 'support': 133187}, '1': {'precision': 0.48799447717579414, 'recall': 0.29704634549295694, 'f1-score': 0.36929793172547054, 'support': 173717}, '2': {'precision': 0.38006663117394907, 'recall': 0.5069029632232372, 'f1-score': 0.4344160223334013, 'support': 136608}, 'accuracy': 0.3974255488013853, 'macro avg': {'precision': 0.40808543685707427, 'recall': 0.40667031211750837, 'f1-score': 0.39584063487785753, 'support': 443512}, 'weighted avg': {'precision': 0.41517174133108115, 'recall': 0.3974255488013853, 'f1-score': 0.39371259920287954, 'support': 443512}}
[[55414 26756 51017]
 [60182 51602 61933]
 [39976 27385 69247]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0712659
{'0': {'precision': 0.40344342670366007, 'recall': 0.3280182936250425, 'f1-score': 0.36184210526315785, 'support': 64722}, '1': {'precision': 0.4230130135070661, 'recall': 0.3975631629402851, 'f1-score': 0.40989342962130454, 'support': 64674}, '2': {'precision': 0.4104348037251545, 'recall': 0.5093267839922855, 'f1-score': 0.45456440323545827, 'support': 66368}, 'accuracy': 0.4124609223350565, 'macro avg': {'precision': 0.41229708131196025, 'recall': 0.411636080185871, 'f1-score': 0.40876664603997354, 'support': 195764}, 'weighted avg': {'precision': 0.4122787956534466, 'recall': 0.4124609223350565, 'f1-score': 0.40915144111328566, 'support': 195764}}
[[21230 17387 26105]
 [16511 25712 22451]
 [14881 17684 33803]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0779171
{'0': {'precision': 0.3834470081749141, 'recall': 0.37326364364081555, 'f1-score': 0.37828680505845863, 'support': 21237}, '1': {'precision': 0.4378395061728395, 'recall': 0.3206310460175391, 'f1-score': 0.37017900944627113, 'support': 22122}, '2': {'precision': 0.3938588615550368, 'recall': 0.5134603679947564, 'f1-score': 0.4457767661165759, 'support': 21359}, 'accuracy': 0.40154207484780124, 'macro avg': {'precision': 0.4050484586342635, 'recall': 0.4024516858843703, 'f1-score': 0.3980808602071019, 'support': 64718}, 'weighted avg': {'precision': 0.40547577323341627, 'recall': 0.40154207484780124, 'f1-score': 0.3977892220631175, 'support': 64718}}
[[ 7927  4534  8776]
 [ 6927  7093  8102]
 [ 5819  4573 10967]]
training model: results/PCAR/W0/deepVOL_L3/h100
Epoch 1/50
765/765 - 48s - loss: 3.3177 - accuracy100: 0.3520 - val_loss: 3.3366 - val_accuracy100: 0.3320 - 48s/epoch - 63ms/step
Epoch 2/50
765/765 - 44s - loss: 3.3007 - accuracy100: 0.3432 - val_loss: 3.3282 - val_accuracy100: 0.3333 - 44s/epoch - 58ms/step
Epoch 3/50
765/765 - 43s - loss: 3.2991 - accuracy100: 0.3443 - val_loss: 3.3086 - val_accuracy100: 0.3333 - 43s/epoch - 57ms/step
Epoch 4/50
765/765 - 44s - loss: 3.2936 - accuracy100: 0.3466 - val_loss: 3.3074 - val_accuracy100: 0.3369 - 44s/epoch - 57ms/step
Epoch 5/50
765/765 - 44s - loss: 3.2828 - accuracy100: 0.3621 - val_loss: 3.3125 - val_accuracy100: 0.3370 - 44s/epoch - 58ms/step
Epoch 6/50
765/765 - 43s - loss: 3.2683 - accuracy100: 0.3776 - val_loss: 3.3247 - val_accuracy100: 0.3366 - 43s/epoch - 57ms/step
Epoch 7/50
765/765 - 43s - loss: 3.2626 - accuracy100: 0.3816 - val_loss: 3.3045 - val_accuracy100: 0.3462 - 43s/epoch - 57ms/step
Epoch 8/50
765/765 - 41s - loss: 3.2576 - accuracy100: 0.3825 - val_loss: 3.2993 - val_accuracy100: 0.3547 - 41s/epoch - 53ms/step
Epoch 9/50
765/765 - 41s - loss: 3.2551 - accuracy100: 0.3846 - val_loss: 3.2967 - val_accuracy100: 0.3542 - 41s/epoch - 54ms/step
Epoch 10/50
765/765 - 43s - loss: 3.2538 - accuracy100: 0.3854 - val_loss: 3.2913 - val_accuracy100: 0.3589 - 43s/epoch - 56ms/step
Epoch 11/50
765/765 - 44s - loss: 3.2508 - accuracy100: 0.3872 - val_loss: 3.2894 - val_accuracy100: 0.3626 - 44s/epoch - 58ms/step
Epoch 12/50
765/765 - 44s - loss: 3.2480 - accuracy100: 0.3892 - val_loss: 3.2862 - val_accuracy100: 0.3647 - 44s/epoch - 58ms/step
Epoch 13/50
765/765 - 41s - loss: 3.2455 - accuracy100: 0.3925 - val_loss: 3.2785 - val_accuracy100: 0.3707 - 41s/epoch - 54ms/step
Epoch 14/50
765/765 - 43s - loss: 3.2409 - accuracy100: 0.3969 - val_loss: 3.2799 - val_accuracy100: 0.3691 - 43s/epoch - 56ms/step
Epoch 15/50
765/765 - 42s - loss: 3.2374 - accuracy100: 0.3981 - val_loss: 3.2834 - val_accuracy100: 0.3684 - 42s/epoch - 55ms/step
Epoch 16/50
765/765 - 43s - loss: 3.2356 - accuracy100: 0.3992 - val_loss: 3.2740 - val_accuracy100: 0.3723 - 43s/epoch - 56ms/step
Epoch 17/50
765/765 - 41s - loss: 3.2321 - accuracy100: 0.4010 - val_loss: 3.2751 - val_accuracy100: 0.3720 - 41s/epoch - 53ms/step
Epoch 18/50
765/765 - 41s - loss: 3.2305 - accuracy100: 0.4014 - val_loss: 3.2738 - val_accuracy100: 0.3708 - 41s/epoch - 54ms/step
Epoch 19/50
765/765 - 42s - loss: 3.2259 - accuracy100: 0.4051 - val_loss: 3.2716 - val_accuracy100: 0.3726 - 42s/epoch - 54ms/step
Epoch 20/50
765/765 - 42s - loss: 3.2240 - accuracy100: 0.4063 - val_loss: 3.2730 - val_accuracy100: 0.3702 - 42s/epoch - 56ms/step
Epoch 21/50
765/765 - 43s - loss: 3.2204 - accuracy100: 0.4065 - val_loss: 3.2757 - val_accuracy100: 0.3684 - 43s/epoch - 56ms/step
Epoch 22/50
765/765 - 43s - loss: 3.2186 - accuracy100: 0.4088 - val_loss: 3.2748 - val_accuracy100: 0.3690 - 43s/epoch - 57ms/step
Epoch 23/50
765/765 - 41s - loss: 3.2158 - accuracy100: 0.4094 - val_loss: 3.2793 - val_accuracy100: 0.3646 - 41s/epoch - 54ms/step
Epoch 24/50
765/765 - 41s - loss: 3.2156 - accuracy100: 0.4097 - val_loss: 3.2778 - val_accuracy100: 0.3692 - 41s/epoch - 53ms/step
Epoch 25/50
765/765 - 41s - loss: 3.2107 - accuracy100: 0.4127 - val_loss: 3.2807 - val_accuracy100: 0.3666 - 41s/epoch - 54ms/step
Epoch 26/50
765/765 - 41s - loss: 3.2068 - accuracy100: 0.4144 - val_loss: 3.2812 - val_accuracy100: 0.3695 - 41s/epoch - 54ms/step
Epoch 27/50
765/765 - 42s - loss: 3.2047 - accuracy100: 0.4158 - val_loss: 3.2865 - val_accuracy100: 0.3662 - 42s/epoch - 55ms/step
Epoch 28/50
765/765 - 42s - loss: 3.2027 - accuracy100: 0.4175 - val_loss: 3.2866 - val_accuracy100: 0.3648 - 42s/epoch - 55ms/step
Epoch 29/50
765/765 - 42s - loss: 3.2000 - accuracy100: 0.4178 - val_loss: 3.2845 - val_accuracy100: 0.3664 - 42s/epoch - 55ms/step
testing model: results/PCAR/W0/deepVOL_L3/h100
Evaluating performance on  test set...
1733/1733 - 43s - 43s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093848
{'0': {'precision': 0.3390315477396029, 'recall': 0.5482457057245392, 'f1-score': 0.41897296347379687, 'support': 143505}, '1': {'precision': 0.4199382443758271, 'recall': 0.14491736877287498, 'f1-score': 0.21547575700916183, 'support': 151093}, '2': {'precision': 0.3820601343292951, 'recall': 0.4087325570463489, 'f1-score': 0.3949465323920266, 'support': 148914}, 'accuracy': 0.3639991702592038, 'macro avg': {'precision': 0.38034330881490835, 'recall': 0.36729854384792104, 'f1-score': 0.3431317509583285, 'support': 443512}, 'weighted avg': {'precision': 0.381041672512494, 'recall': 0.3639991702592038, 'f1-score': 0.34157962265219155, 'support': 443512}}
[[78676 14522 50307]
 [81060 21896 48137]
 [72325 15723 60866]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 27ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0843034
{'0': {'precision': 0.3570421449185962, 'recall': 0.5041764532035029, 'f1-score': 0.4180407684222066, 'support': 64289}, '1': {'precision': 0.418159509202454, 'recall': 0.2110641460355799, 'f1-score': 0.28053134678506386, 'support': 64587}, '2': {'precision': 0.3913403884943771, 'recall': 0.42348403301040544, 'f1-score': 0.4067782006175056, 'support': 66888}, 'accuracy': 0.37990130974029956, 'macro avg': {'precision': 0.3888473475384758, 'recall': 0.37957487741649604, 'f1-score': 0.3684501052749254, 'support': 195764}, 'weighted avg': {'precision': 0.38892506579934216, 'recall': 0.37990130974029956, 'f1-score': 0.36882512279482377, 'support': 195764}}
[[32413  8966 22910]
 [29809 13632 21146]
 [28560 10002 28326]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.089943
{'0': {'precision': 0.3555697952851506, 'recall': 0.49303217358772916, 'f1-score': 0.41316743411384343, 'support': 21384}, '1': {'precision': 0.41924398625429554, 'recall': 0.1785012116501303, 'f1-score': 0.25039284225379216, 'support': 21871}, '2': {'precision': 0.3722772277227723, 'recall': 0.4467222662255975, 'f1-score': 0.40611631157609385, 'support': 21463}, 'accuracy': 0.37138045057016594, 'macro avg': {'precision': 0.3823636697540728, 'recall': 0.3727518838211523, 'f1-score': 0.35655886264790987, 'support': 64718}, 'weighted avg': {'precision': 0.38262888013163604, 'recall': 0.37138045057016594, 'f1-score': 0.35582046199482087, 'support': 64718}}
[[10543  2713  8128]
 [ 9928  3904  8039]
 [ 9180  2695  9588]]
training model: results/PCAR/W0/deepVOL_L3/h200
Epoch 1/50
765/765 - 47s - loss: 3.2939 - accuracy200: 0.3777 - val_loss: 3.3285 - val_accuracy200: 0.3276 - 47s/epoch - 61ms/step
Epoch 2/50
765/765 - 45s - loss: 3.2875 - accuracy200: 0.3683 - val_loss: 3.3170 - val_accuracy200: 0.3245 - 45s/epoch - 58ms/step
Epoch 3/50
765/765 - 44s - loss: 3.3009 - accuracy200: 0.3430 - val_loss: 3.3039 - val_accuracy200: 0.3301 - 44s/epoch - 58ms/step
Epoch 4/50
765/765 - 43s - loss: 3.2982 - accuracy200: 0.3383 - val_loss: 3.3031 - val_accuracy200: 0.3255 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2925 - accuracy200: 0.3512 - val_loss: 3.3013 - val_accuracy200: 0.3335 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 40s - loss: 3.2728 - accuracy200: 0.3698 - val_loss: 3.3237 - val_accuracy200: 0.3290 - 40s/epoch - 53ms/step
Epoch 7/50
765/765 - 40s - loss: 3.2570 - accuracy200: 0.3803 - val_loss: 3.3193 - val_accuracy200: 0.3317 - 40s/epoch - 52ms/step
Epoch 8/50
765/765 - 42s - loss: 3.2506 - accuracy200: 0.3844 - val_loss: 3.3182 - val_accuracy200: 0.3292 - 42s/epoch - 55ms/step
Epoch 9/50
765/765 - 41s - loss: 3.2443 - accuracy200: 0.3879 - val_loss: 3.3156 - val_accuracy200: 0.3288 - 41s/epoch - 53ms/step
Epoch 10/50
765/765 - 41s - loss: 3.2369 - accuracy200: 0.3899 - val_loss: 3.3096 - val_accuracy200: 0.3287 - 41s/epoch - 54ms/step
Epoch 11/50
765/765 - 42s - loss: 3.2372 - accuracy200: 0.3912 - val_loss: 3.3153 - val_accuracy200: 0.3324 - 42s/epoch - 55ms/step
Epoch 12/50
765/765 - 40s - loss: 3.2360 - accuracy200: 0.3906 - val_loss: 3.3119 - val_accuracy200: 0.3336 - 40s/epoch - 52ms/step
Epoch 13/50
765/765 - 42s - loss: 3.2330 - accuracy200: 0.3915 - val_loss: 3.2984 - val_accuracy200: 0.3407 - 42s/epoch - 55ms/step
Epoch 14/50
765/765 - 41s - loss: 3.2302 - accuracy200: 0.3929 - val_loss: 3.2902 - val_accuracy200: 0.3480 - 41s/epoch - 54ms/step
Epoch 15/50
765/765 - 41s - loss: 3.2316 - accuracy200: 0.3940 - val_loss: 3.2902 - val_accuracy200: 0.3486 - 41s/epoch - 54ms/step
Epoch 16/50
765/765 - 44s - loss: 3.2284 - accuracy200: 0.3949 - val_loss: 3.2919 - val_accuracy200: 0.3456 - 44s/epoch - 57ms/step
Epoch 17/50
765/765 - 45s - loss: 3.2264 - accuracy200: 0.3971 - val_loss: 3.2922 - val_accuracy200: 0.3467 - 45s/epoch - 59ms/step
Epoch 18/50
765/765 - 43s - loss: 3.2264 - accuracy200: 0.3964 - val_loss: 3.2882 - val_accuracy200: 0.3538 - 43s/epoch - 56ms/step
Epoch 19/50
765/765 - 44s - loss: 3.2229 - accuracy200: 0.3994 - val_loss: 3.2869 - val_accuracy200: 0.3503 - 44s/epoch - 58ms/step
Epoch 20/50
765/765 - 43s - loss: 3.2231 - accuracy200: 0.3987 - val_loss: 3.2891 - val_accuracy200: 0.3511 - 43s/epoch - 56ms/step
Epoch 21/50
765/765 - 42s - loss: 3.2201 - accuracy200: 0.4010 - val_loss: 3.2859 - val_accuracy200: 0.3505 - 42s/epoch - 55ms/step
Epoch 22/50
765/765 - 43s - loss: 3.2184 - accuracy200: 0.4015 - val_loss: 3.2859 - val_accuracy200: 0.3494 - 43s/epoch - 56ms/step
Epoch 23/50
765/765 - 42s - loss: 3.2152 - accuracy200: 0.4043 - val_loss: 3.2888 - val_accuracy200: 0.3470 - 42s/epoch - 55ms/step
Epoch 24/50
765/765 - 44s - loss: 3.2134 - accuracy200: 0.4038 - val_loss: 3.2853 - val_accuracy200: 0.3488 - 44s/epoch - 58ms/step
Epoch 25/50
765/765 - 44s - loss: 3.2135 - accuracy200: 0.4052 - val_loss: 3.2780 - val_accuracy200: 0.3615 - 44s/epoch - 57ms/step
Epoch 26/50
765/765 - 45s - loss: 3.2098 - accuracy200: 0.4068 - val_loss: 3.2807 - val_accuracy200: 0.3608 - 45s/epoch - 59ms/step
Epoch 27/50
765/765 - 43s - loss: 3.2075 - accuracy200: 0.4078 - val_loss: 3.2781 - val_accuracy200: 0.3628 - 43s/epoch - 57ms/step
Epoch 28/50
765/765 - 41s - loss: 3.2052 - accuracy200: 0.4094 - val_loss: 3.2760 - val_accuracy200: 0.3657 - 41s/epoch - 53ms/step
Epoch 29/50
765/765 - 42s - loss: 3.2064 - accuracy200: 0.4090 - val_loss: 3.2797 - val_accuracy200: 0.3598 - 42s/epoch - 54ms/step
Epoch 30/50
765/765 - 41s - loss: 3.2032 - accuracy200: 0.4112 - val_loss: 3.2861 - val_accuracy200: 0.3567 - 41s/epoch - 54ms/step
Epoch 31/50
765/765 - 42s - loss: 3.2039 - accuracy200: 0.4097 - val_loss: 3.2794 - val_accuracy200: 0.3616 - 42s/epoch - 55ms/step
Epoch 32/50
765/765 - 42s - loss: 3.2019 - accuracy200: 0.4114 - val_loss: 3.2756 - val_accuracy200: 0.3622 - 42s/epoch - 55ms/step
Epoch 33/50
765/765 - 42s - loss: 3.1978 - accuracy200: 0.4128 - val_loss: 3.2748 - val_accuracy200: 0.3653 - 42s/epoch - 55ms/step
Epoch 34/50
765/765 - 42s - loss: 3.1947 - accuracy200: 0.4142 - val_loss: 3.2778 - val_accuracy200: 0.3661 - 42s/epoch - 55ms/step
Epoch 35/50
765/765 - 42s - loss: 3.1912 - accuracy200: 0.4171 - val_loss: 3.2771 - val_accuracy200: 0.3634 - 42s/epoch - 54ms/step
Epoch 36/50
765/765 - 45s - loss: 3.1886 - accuracy200: 0.4200 - val_loss: 3.2719 - val_accuracy200: 0.3708 - 45s/epoch - 59ms/step
Epoch 37/50
765/765 - 46s - loss: 3.1862 - accuracy200: 0.4193 - val_loss: 3.2721 - val_accuracy200: 0.3714 - 46s/epoch - 60ms/step
Epoch 38/50
765/765 - 43s - loss: 3.1823 - accuracy200: 0.4234 - val_loss: 3.2748 - val_accuracy200: 0.3673 - 43s/epoch - 56ms/step
Epoch 39/50
765/765 - 42s - loss: 3.1806 - accuracy200: 0.4230 - val_loss: 3.2804 - val_accuracy200: 0.3652 - 42s/epoch - 54ms/step
Epoch 40/50
765/765 - 41s - loss: 3.1780 - accuracy200: 0.4247 - val_loss: 3.2719 - val_accuracy200: 0.3686 - 41s/epoch - 54ms/step
Epoch 41/50
765/765 - 42s - loss: 3.1778 - accuracy200: 0.4239 - val_loss: 3.2757 - val_accuracy200: 0.3643 - 42s/epoch - 55ms/step
Epoch 42/50
765/765 - 41s - loss: 3.1718 - accuracy200: 0.4275 - val_loss: 3.2825 - val_accuracy200: 0.3620 - 41s/epoch - 53ms/step
Epoch 43/50
765/765 - 44s - loss: 3.1669 - accuracy200: 0.4314 - val_loss: 3.2707 - val_accuracy200: 0.3713 - 44s/epoch - 57ms/step
Epoch 44/50
765/765 - 43s - loss: 3.1631 - accuracy200: 0.4308 - val_loss: 3.2705 - val_accuracy200: 0.3735 - 43s/epoch - 57ms/step
Epoch 45/50
765/765 - 43s - loss: 3.1598 - accuracy200: 0.4339 - val_loss: 3.2737 - val_accuracy200: 0.3702 - 43s/epoch - 56ms/step
Epoch 46/50
765/765 - 40s - loss: 3.1609 - accuracy200: 0.4342 - val_loss: 3.2795 - val_accuracy200: 0.3695 - 40s/epoch - 52ms/step
Epoch 47/50
765/765 - 44s - loss: 3.1556 - accuracy200: 0.4353 - val_loss: 3.2777 - val_accuracy200: 0.3698 - 44s/epoch - 58ms/step
Epoch 48/50
765/765 - 42s - loss: 3.1524 - accuracy200: 0.4368 - val_loss: 3.2772 - val_accuracy200: 0.3703 - 42s/epoch - 55ms/step
Epoch 49/50
765/765 - 44s - loss: 3.1537 - accuracy200: 0.4356 - val_loss: 3.2739 - val_accuracy200: 0.3726 - 44s/epoch - 57ms/step
Epoch 50/50
765/765 - 43s - loss: 3.1496 - accuracy200: 0.4386 - val_loss: 3.2736 - val_accuracy200: 0.3735 - 43s/epoch - 56ms/step
testing model: results/PCAR/W0/deepVOL_L3/h200
Evaluating performance on  test set...
1733/1733 - 51s - 51s/epoch - 30ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941409
{'0': {'precision': 0.32246100243983533, 'recall': 0.5035761821878336, 'f1-score': 0.3931631251837831, 'support': 136738}, '1': {'precision': 0.4414620619228298, 'recall': 0.3083104315374636, 'f1-score': 0.36306308915306756, 'support': 162651}, '2': {'precision': 0.35128888125107405, 'recall': 0.2836674229651062, 'f1-score': 0.3138773833698652, 'support': 144123}, 'accuracy': 0.3605043381013366, 'macro avg': {'precision': 0.37173731520457975, 'recall': 0.3651846788968012, 'f1-score': 0.356701199235572, 'support': 443512}, 'weighted avg': {'precision': 0.37547062045215673, 'recall': 0.3605043381013366, 'f1-score': 0.3563598370475451, 'support': 443512}}
[[68858 31961 35919]
 [72926 50147 39578]
 [71755 31485 40883]]
Evaluating performance on  train set...
765/765 - 19s - 19s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0819548
{'0': {'precision': 0.36573375459775537, 'recall': 0.48639877079381005, 'f1-score': 0.4175229635611184, 'support': 63781}, '1': {'precision': 0.41670034758709884, 'recall': 0.39952568434758345, 'f1-score': 0.40793232517468675, 'support': 64514}, '2': {'precision': 0.3787715187939289, 'recall': 0.27556359216825504, 'f1-score': 0.3190280899840417, 'support': 67469}, 'accuracy': 0.3851065568746041, 'macro avg': {'precision': 0.38706854032626103, 'recall': 0.3871626824365495, 'f1-score': 0.38149445957328226, 'support': 195764}, 'weighted avg': {'precision': 0.38702318315799183, 'recall': 0.3851065568746041, 'f1-score': 0.3804166464127457, 'support': 195764}}
[[31023 17134 15624]
 [23870 25775 14869]
 [29931 18946 18592]]
Evaluating performance on  val set...
253/253 - 8s - 8s/epoch - 32ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0899163
{'0': {'precision': 0.3530828516377649, 'recall': 0.4870431893687708, 'f1-score': 0.4093828539514103, 'support': 21070}, '1': {'precision': 0.4230043658707487, 'recall': 0.35221254824522036, 'f1-score': 0.3843761479123301, 'support': 22282}, '2': {'precision': 0.3493947722355418, 'recall': 0.27964991107366843, 'f1-score': 0.31065588686406526, 'support': 21366}, 'accuracy': 0.37215303315924475, 'macro avg': {'precision': 0.37516066324801844, 'recall': 0.37296854956255315, 'f1-score': 0.36813829624260186, 'support': 64718}, 'weighted avg': {'precision': 0.3759388063278271, 'recall': 0.37215303315924475, 'f1-score': 0.3681794823584841, 'support': 64718}}
[[10262  5193  5615]
 [ 8923  7848  5511]
 [ 9879  5512  5975]]
training model: results/PCAR/W0/deepVOL_L3/h300
Epoch 1/50
765/765 - 50s - loss: 3.3130 - accuracy300: 0.3620 - val_loss: 3.3506 - val_accuracy300: 0.3281 - 50s/epoch - 65ms/step
Epoch 2/50
765/765 - 44s - loss: 3.2985 - accuracy300: 0.3452 - val_loss: 3.3129 - val_accuracy300: 0.3324 - 44s/epoch - 58ms/step
Epoch 3/50
765/765 - 45s - loss: 3.2764 - accuracy300: 0.3710 - val_loss: 3.3124 - val_accuracy300: 0.3486 - 45s/epoch - 59ms/step
Epoch 4/50
765/765 - 45s - loss: 3.2529 - accuracy300: 0.3866 - val_loss: 3.3052 - val_accuracy300: 0.3608 - 45s/epoch - 58ms/step
Epoch 5/50
765/765 - 45s - loss: 3.2410 - accuracy300: 0.3927 - val_loss: 3.3235 - val_accuracy300: 0.3506 - 45s/epoch - 58ms/step
Epoch 6/50
765/765 - 44s - loss: 3.2350 - accuracy300: 0.3955 - val_loss: 3.3038 - val_accuracy300: 0.3695 - 44s/epoch - 57ms/step
Epoch 7/50
765/765 - 42s - loss: 3.2330 - accuracy300: 0.3967 - val_loss: 3.3046 - val_accuracy300: 0.3645 - 42s/epoch - 55ms/step
Epoch 8/50
765/765 - 44s - loss: 3.2313 - accuracy300: 0.3959 - val_loss: 3.2711 - val_accuracy300: 0.3800 - 44s/epoch - 58ms/step
Epoch 9/50
765/765 - 42s - loss: 3.2254 - accuracy300: 0.4023 - val_loss: 3.2693 - val_accuracy300: 0.3775 - 42s/epoch - 54ms/step
Epoch 10/50
765/765 - 47s - loss: 3.2245 - accuracy300: 0.4009 - val_loss: 3.2656 - val_accuracy300: 0.3801 - 47s/epoch - 62ms/step
Epoch 11/50
765/765 - 41s - loss: 3.2220 - accuracy300: 0.4039 - val_loss: 3.2647 - val_accuracy300: 0.3787 - 41s/epoch - 54ms/step
Epoch 12/50
765/765 - 41s - loss: 3.2182 - accuracy300: 0.4052 - val_loss: 3.2658 - val_accuracy300: 0.3797 - 41s/epoch - 53ms/step
Epoch 13/50
765/765 - 41s - loss: 3.2157 - accuracy300: 0.4059 - val_loss: 3.2638 - val_accuracy300: 0.3766 - 41s/epoch - 54ms/step
Epoch 14/50
765/765 - 43s - loss: 3.2120 - accuracy300: 0.4068 - val_loss: 3.2596 - val_accuracy300: 0.3809 - 43s/epoch - 56ms/step
Epoch 15/50
765/765 - 43s - loss: 3.2091 - accuracy300: 0.4085 - val_loss: 3.2634 - val_accuracy300: 0.3800 - 43s/epoch - 56ms/step
Epoch 16/50
765/765 - 41s - loss: 3.2086 - accuracy300: 0.4095 - val_loss: 3.2637 - val_accuracy300: 0.3801 - 41s/epoch - 53ms/step
Epoch 17/50
765/765 - 42s - loss: 3.2049 - accuracy300: 0.4101 - val_loss: 3.2639 - val_accuracy300: 0.3813 - 42s/epoch - 54ms/step
Epoch 18/50
765/765 - 41s - loss: 3.2026 - accuracy300: 0.4119 - val_loss: 3.2687 - val_accuracy300: 0.3805 - 41s/epoch - 54ms/step
Epoch 19/50
765/765 - 42s - loss: 3.1984 - accuracy300: 0.4132 - val_loss: 3.2675 - val_accuracy300: 0.3809 - 42s/epoch - 55ms/step
Epoch 20/50
765/765 - 43s - loss: 3.1957 - accuracy300: 0.4151 - val_loss: 3.2709 - val_accuracy300: 0.3775 - 43s/epoch - 56ms/step
Epoch 21/50
765/765 - 42s - loss: 3.1922 - accuracy300: 0.4167 - val_loss: 3.2742 - val_accuracy300: 0.3789 - 42s/epoch - 55ms/step
Epoch 22/50
765/765 - 41s - loss: 3.1891 - accuracy300: 0.4162 - val_loss: 3.2886 - val_accuracy300: 0.3694 - 41s/epoch - 54ms/step
Epoch 23/50
765/765 - 45s - loss: 3.1865 - accuracy300: 0.4180 - val_loss: 3.2805 - val_accuracy300: 0.3779 - 45s/epoch - 58ms/step
Epoch 24/50
765/765 - 45s - loss: 3.1799 - accuracy300: 0.4211 - val_loss: 3.2881 - val_accuracy300: 0.3729 - 45s/epoch - 58ms/step
testing model: results/PCAR/W0/deepVOL_L3/h300
Evaluating performance on  test set...
1733/1733 - 44s - 44s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0913795
{'0': {'precision': 0.3493120849933599, 'recall': 0.44491204330175915, 'f1-score': 0.39135842880523736, 'support': 147800}, '1': {'precision': 0.3788042980143519, 'recall': 0.5037497490607703, 'f1-score': 0.4324325987746071, 'support': 139476}, '2': {'precision': 0.3734397615396741, 'recall': 0.16679254461199725, 'f1-score': 0.2305932739572687, 'support': 156236}, 'accuracy': 0.3654421977308393, 'macro avg': {'precision': 0.3671853815157953, 'recall': 0.37181811232484224, 'f1-score': 0.35146143384570444, 'support': 443512}, 'weighted avg': {'precision': 0.36708627729527243, 'recall': 0.3654421977308393, 'f1-score': 0.3476427146821034, 'support': 443512}}
[[65758 58801 23241]
 [48734 70261 20481]
 [73758 56419 26059]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0783042
{'0': {'precision': 0.3685695046183948, 'recall': 0.4580247888213468, 'f1-score': 0.4084566536658171, 'support': 63335}, '1': {'precision': 0.421497822423566, 'recall': 0.5945115833989288, 'f1-score': 0.49327365745276186, 'support': 64791}, '2': {'precision': 0.36924934751275756, 'recall': 0.14014311481711464, 'f1-score': 0.20317439903974963, 'support': 67638}, 'accuracy': 0.3933665025234466, 'macro avg': {'precision': 0.38643889151823946, 'recall': 0.3975598290124634, 'f1-score': 0.36830157005277625, 'support': 195764}, 'weighted avg': {'precision': 0.38632180765983126, 'recall': 0.3933665025234466, 'f1-score': 0.36560146759463946, 'support': 195764}}
[[29009 25254  9072]
 [19152 38519  7120]
 [30546 27613  9479]]
Evaluating performance on  val set...
253/253 - 6s - 6s/epoch - 25ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.086075
{'0': {'precision': 0.3605312446790397, 'recall': 0.5024202733485194, 'f1-score': 0.41981085314352556, 'support': 21072}, '1': {'precision': 0.4223490897476844, 'recall': 0.4820907765220561, 'f1-score': 0.4502468505277494, 'support': 21944}, '2': {'precision': 0.3416787967006308, 'recall': 0.16224311123398766, 'f1-score': 0.22001437185615647, 'support': 21702}, 'accuracy': 0.38145492753175314, 'macro avg': {'precision': 0.37485304370911826, 'recall': 0.38225138703485434, 'f1-score': 0.3633573585091438, 'support': 64718}, 'weighted avg': {'precision': 0.37517006179574464, 'recall': 0.38145492753175314, 'f1-score': 0.3631327155264935, 'support': 64718}}
[[10587  6943  3542]
 [ 8123 10579  3242]
 [10655  7526  3521]]
training model: results/PCAR/W0/deepVOL_L3/h500
Epoch 1/50
765/765 - 49s - loss: 3.3201 - accuracy500: 0.3575 - val_loss: 3.3463 - val_accuracy500: 0.3201 - 49s/epoch - 64ms/step
Epoch 2/50
765/765 - 41s - loss: 3.3063 - accuracy500: 0.3432 - val_loss: 3.3194 - val_accuracy500: 0.3283 - 41s/epoch - 53ms/step
Epoch 3/50
765/765 - 42s - loss: 3.2975 - accuracy500: 0.3455 - val_loss: 3.3179 - val_accuracy500: 0.3264 - 42s/epoch - 55ms/step
Epoch 4/50
765/765 - 43s - loss: 3.2790 - accuracy500: 0.3676 - val_loss: 3.3264 - val_accuracy500: 0.3291 - 43s/epoch - 56ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2649 - accuracy500: 0.3789 - val_loss: 3.3236 - val_accuracy500: 0.3317 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 42s - loss: 3.2610 - accuracy500: 0.3825 - val_loss: 3.3207 - val_accuracy500: 0.3390 - 42s/epoch - 55ms/step
Epoch 7/50
765/765 - 41s - loss: 3.2564 - accuracy500: 0.3855 - val_loss: 3.3048 - val_accuracy500: 0.3510 - 41s/epoch - 53ms/step
Epoch 8/50
765/765 - 41s - loss: 3.2505 - accuracy500: 0.3897 - val_loss: 3.2940 - val_accuracy500: 0.3605 - 41s/epoch - 54ms/step
Epoch 9/50
765/765 - 42s - loss: 3.2464 - accuracy500: 0.3938 - val_loss: 3.2909 - val_accuracy500: 0.3580 - 42s/epoch - 56ms/step
Epoch 10/50
765/765 - 41s - loss: 3.2417 - accuracy500: 0.3954 - val_loss: 3.2887 - val_accuracy500: 0.3592 - 41s/epoch - 53ms/step
Epoch 11/50
765/765 - 44s - loss: 3.2406 - accuracy500: 0.3958 - val_loss: 3.3006 - val_accuracy500: 0.3565 - 44s/epoch - 58ms/step
Epoch 12/50
765/765 - 42s - loss: 3.2365 - accuracy500: 0.3996 - val_loss: 3.3050 - val_accuracy500: 0.3508 - 42s/epoch - 54ms/step
Epoch 13/50
765/765 - 42s - loss: 3.2307 - accuracy500: 0.4040 - val_loss: 3.2989 - val_accuracy500: 0.3519 - 42s/epoch - 55ms/step
Epoch 14/50
765/765 - 41s - loss: 3.2305 - accuracy500: 0.4030 - val_loss: 3.2945 - val_accuracy500: 0.3578 - 41s/epoch - 54ms/step
Epoch 15/50
765/765 - 44s - loss: 3.2289 - accuracy500: 0.4037 - val_loss: 3.2998 - val_accuracy500: 0.3537 - 44s/epoch - 58ms/step
Epoch 16/50
765/765 - 43s - loss: 3.2246 - accuracy500: 0.4077 - val_loss: 3.2959 - val_accuracy500: 0.3642 - 43s/epoch - 56ms/step
Epoch 17/50
765/765 - 45s - loss: 3.2207 - accuracy500: 0.4085 - val_loss: 3.2978 - val_accuracy500: 0.3604 - 45s/epoch - 59ms/step
Epoch 18/50
765/765 - 44s - loss: 3.2169 - accuracy500: 0.4117 - val_loss: 3.2999 - val_accuracy500: 0.3581 - 44s/epoch - 58ms/step
Epoch 19/50
765/765 - 43s - loss: 3.2143 - accuracy500: 0.4121 - val_loss: 3.2943 - val_accuracy500: 0.3679 - 43s/epoch - 56ms/step
Epoch 20/50
765/765 - 42s - loss: 3.2064 - accuracy500: 0.4157 - val_loss: 3.2960 - val_accuracy500: 0.3665 - 42s/epoch - 55ms/step
testing model: results/PCAR/W0/deepVOL_L3/h500
Evaluating performance on  test set...
1733/1733 - 44s - 44s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0981101
{'0': {'precision': 0.32798577392621425, 'recall': 0.4754090388022371, 'f1-score': 0.3881712927508608, 'support': 143935}, '1': {'precision': 0.3844474840662379, 'recall': 0.1813676023367726, 'f1-score': 0.2464632707224583, 'support': 145671}, '2': {'precision': 0.37367220553806896, 'recall': 0.40342156900965526, 'f1-score': 0.3879774420820771, 'support': 153906}, 'accuracy': 0.3538506286188423, 'macro avg': {'precision': 0.3620351545101737, 'recall': 0.3533994033828883, 'f1-score': 0.3408706685184654, 'support': 443512}, 'weighted avg': {'precision': 0.3623845043359022, 'recall': 0.3538506286188423, 'f1-score': 0.3415601885238517, 'support': 443512}}
[[68428 21268 54239]
 [69420 26420 49831]
 [70783 21034 62089]]
Evaluating performance on  train set...
765/765 - 20s - 20s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0915029
{'0': {'precision': 0.32370012091898426, 'recall': 0.4347402439222437, 'f1-score': 0.37109171940087476, 'support': 61577}, '1': {'precision': 0.4223173923388056, 'recall': 0.26736759655359404, 'f1-score': 0.32743640354922615, 'support': 66388}, '2': {'precision': 0.3723287439817552, 'recall': 0.3900942491777165, 'f1-score': 0.38100451621732584, 'support': 67799}, 'accuracy': 0.3625181340798104, 'macro avg': {'precision': 0.372782085746515, 'recall': 0.36406736321785144, 'f1-score': 0.3598442130558089, 'support': 195764}, 'weighted avg': {'precision': 0.3739850324964546, 'recall': 0.3625181340798104, 'f1-score': 0.35972031609178484, 'support': 195764}}
[[26770 11139 23668]
 [27720 17750 20918]
 [28210 13141 26448]]
Evaluating performance on  val set...
253/253 - 7s - 7s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0962682
{'0': {'precision': 0.3391038696537678, 'recall': 0.4504347826086956, 'f1-score': 0.3869200763548842, 'support': 20700}, '1': {'precision': 0.4353495415159418, 'recall': 0.22981614708233414, 'f1-score': 0.3008283679697718, 'support': 22518}, '2': {'precision': 0.35591079534241166, 'recall': 0.4193953488372093, 'f1-score': 0.3850539126721469, 'support': 21500}, 'accuracy': 0.3633610432955283, 'macro avg': {'precision': 0.37678806883737376, 'recall': 0.366548759509413, 'f1-score': 0.35760078566560094, 'support': 64718}, 'weighted avg': {'precision': 0.3781750545064869, 'recall': 0.3633610432955283, 'f1-score': 0.3563453427630734, 'support': 64718}}
[[9324 3095 8281]
 [9306 5175 8037]
 [8866 3617 9017]]
training model: results/PCAR/W0/deepVOL_L3/h1000
Epoch 1/50
765/765 - 56s - loss: 3.3152 - accuracy1000: 0.3538 - val_loss: 3.3600 - val_accuracy1000: 0.3331 - 56s/epoch - 73ms/step
Epoch 2/50
765/765 - 47s - loss: 3.3059 - accuracy1000: 0.3389 - val_loss: 3.3493 - val_accuracy1000: 0.3315 - 47s/epoch - 61ms/step
Epoch 3/50
765/765 - 45s - loss: 3.3011 - accuracy1000: 0.3435 - val_loss: 3.3859 - val_accuracy1000: 0.3320 - 45s/epoch - 59ms/step
Epoch 4/50
765/765 - 44s - loss: 3.2821 - accuracy1000: 0.3683 - val_loss: 3.4132 - val_accuracy1000: 0.3298 - 44s/epoch - 57ms/step
Epoch 5/50
765/765 - 43s - loss: 3.2652 - accuracy1000: 0.3800 - val_loss: 3.3556 - val_accuracy1000: 0.3316 - 43s/epoch - 56ms/step
Epoch 6/50
765/765 - 46s - loss: 3.2606 - accuracy1000: 0.3835 - val_loss: 3.3388 - val_accuracy1000: 0.3340 - 46s/epoch - 60ms/step
Epoch 7/50
765/765 - 45s - loss: 3.2536 - accuracy1000: 0.3854 - val_loss: 3.4752 - val_accuracy1000: 0.3316 - 45s/epoch - 58ms/step
Epoch 8/50
765/765 - 45s - loss: 3.2488 - accuracy1000: 0.3871 - val_loss: 3.3711 - val_accuracy1000: 0.3320 - 45s/epoch - 58ms/step
Epoch 9/50
765/765 - 42s - loss: 3.2449 - accuracy1000: 0.3943 - val_loss: 3.3696 - val_accuracy1000: 0.3305 - 42s/epoch - 55ms/step
Epoch 10/50
765/765 - 43s - loss: 3.2415 - accuracy1000: 0.3964 - val_loss: 3.3544 - val_accuracy1000: 0.3336 - 43s/epoch - 56ms/step
Epoch 11/50
765/765 - 43s - loss: 3.2386 - accuracy1000: 0.3978 - val_loss: 3.3905 - val_accuracy1000: 0.3341 - 43s/epoch - 57ms/step
Epoch 12/50
765/765 - 43s - loss: 3.2358 - accuracy1000: 0.3998 - val_loss: 3.3687 - val_accuracy1000: 0.3333 - 43s/epoch - 57ms/step
Epoch 13/50
765/765 - 41s - loss: 3.2322 - accuracy1000: 0.4006 - val_loss: 3.3542 - val_accuracy1000: 0.3358 - 41s/epoch - 54ms/step
Epoch 14/50
765/765 - 45s - loss: 3.2282 - accuracy1000: 0.4043 - val_loss: 3.3420 - val_accuracy1000: 0.3347 - 45s/epoch - 59ms/step
Epoch 15/50
765/765 - 44s - loss: 3.2224 - accuracy1000: 0.4076 - val_loss: 3.3628 - val_accuracy1000: 0.3343 - 44s/epoch - 57ms/step
Epoch 16/50
765/765 - 44s - loss: 3.2177 - accuracy1000: 0.4091 - val_loss: 3.3497 - val_accuracy1000: 0.3371 - 44s/epoch - 57ms/step
testing model: results/PCAR/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
1733/1733 - 42s - 42s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1076428
{'0': {'precision': 0.3272296098232546, 'recall': 0.2925212170362308, 'f1-score': 0.308903512725743, 'support': 140571}, '1': {'precision': 0.4293628808864266, 'recall': 0.0010604744083579068, 'f1-score': 0.0021157232361010635, 'support': 146161}, '2': {'precision': 0.3501275630728527, 'recall': 0.7090317642556448, 'f1-score': 0.46877095325447526, 'support': 156780}, 'accuracy': 0.3437043417089053, 'macro avg': {'precision': 0.36890668459417797, 'recall': 0.3342044852334112, 'f1-score': 0.2599300630721064, 'support': 443512}, 'weighted avg': {'precision': 0.3689823518963806, 'recall': 0.3437043417089053, 'f1-score': 0.26431307825384387, 'support': 443512}}
[[ 41120     84  99367]
 [ 39045    155 106961]
 [ 45496    122 111162]]
Evaluating performance on  train set...
765/765 - 21s - 21s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1044518
{'0': {'precision': 0.3276334803067917, 'recall': 0.29151419246365345, 'f1-score': 0.3085202888943163, 'support': 60666}, '1': {'precision': 0.4068965517241379, 'recall': 0.0008956492698181377, 'f1-score': 0.001787364243626835, 'support': 65874}, '2': {'precision': 0.34905147520844954, 'recall': 0.7142031665318387, 'f1-score': 0.4689256159153961, 'support': 69224}, 'accuracy': 0.3431887374593899, 'macro avg': {'precision': 0.3611938357464597, 'recall': 0.33553766942177005, 'f1-score': 0.2597444230177797, 'support': 195764}, 'weighted avg': {'precision': 0.3618788719294528, 'recall': 0.3431887374593899, 'f1-score': 0.2620264170857494, 'support': 195764}}
[[17685    40 42941]
 [16555    59 49260]
 [19738    46 49440]]
Evaluating performance on  val set...
253/253 - 8s - 8s/epoch - 30ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1111373
{'0': {'precision': 0.3485842751245595, 'recall': 0.27561854431900074, 'f1-score': 0.30783677192605907, 'support': 20815}, '1': {'precision': 0.35294117647058826, 'recall': 0.0008036790641603786, 'f1-score': 0.0016037063435495364, 'support': 22397}, '2': {'precision': 0.3297724491277562, 'recall': 0.7392355621686971, 'f1-score': 0.45608549092734707, 'support': 21506}, 'accuracy': 0.3345746160264532, 'macro avg': {'precision': 0.34376596690763467, 'recall': 0.33855259518395275, 'f1-score': 0.2551753230656519, 'support': 64718}, 'weighted avg': {'precision': 0.34384084037008245, 'recall': 0.3345746160264532, 'f1-score': 0.25112202457586646, 'support': 64718}}
[[ 5737    15 15063]
 [ 5131    18 17248]
 [ 5590    18 15898]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        18 (peak)  15.54 (ave)

============================================
