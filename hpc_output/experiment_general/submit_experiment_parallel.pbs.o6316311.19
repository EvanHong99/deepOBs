This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-13.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-05.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-21.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-01.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-25.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-27.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-15.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-26.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-28.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-02-19.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-03-06.csv
training model: results/AAPL/W1/deepLOB_L1/h10
Epoch 1/50
6073/6073 - 284s - loss: 3.0211 - accuracy10: 0.4551 - val_loss: 3.3822 - val_accuracy10: 0.4510 - 284s/epoch - 47ms/step
Epoch 2/50
6073/6073 - 261s - loss: 2.9612 - accuracy10: 0.4733 - val_loss: 3.3245 - val_accuracy10: 0.4589 - 261s/epoch - 43ms/step
Epoch 3/50
6073/6073 - 261s - loss: 2.9286 - accuracy10: 0.4845 - val_loss: 3.3860 - val_accuracy10: 0.4570 - 261s/epoch - 43ms/step
Epoch 4/50
6073/6073 - 270s - loss: 2.9062 - accuracy10: 0.4926 - val_loss: 3.4492 - val_accuracy10: 0.4555 - 270s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 293s - loss: 2.8893 - accuracy10: 0.4980 - val_loss: 3.3938 - val_accuracy10: 0.4640 - 293s/epoch - 48ms/step
Epoch 6/50
6073/6073 - 275s - loss: 2.8773 - accuracy10: 0.5020 - val_loss: 3.4164 - val_accuracy10: 0.4594 - 275s/epoch - 45ms/step
Epoch 7/50
6073/6073 - 273s - loss: 2.8677 - accuracy10: 0.5050 - val_loss: 3.4110 - val_accuracy10: 0.4597 - 273s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 278s - loss: 2.8597 - accuracy10: 0.5077 - val_loss: 3.3605 - val_accuracy10: 0.4598 - 278s/epoch - 46ms/step
Epoch 9/50
6073/6073 - 268s - loss: 2.8532 - accuracy10: 0.5095 - val_loss: 3.3825 - val_accuracy10: 0.4601 - 268s/epoch - 44ms/step
Epoch 10/50
6073/6073 - 269s - loss: 2.8481 - accuracy10: 0.5111 - val_loss: 3.3778 - val_accuracy10: 0.4597 - 269s/epoch - 44ms/step
Epoch 11/50
6073/6073 - 286s - loss: 2.8427 - accuracy10: 0.5124 - val_loss: 3.3982 - val_accuracy10: 0.4564 - 286s/epoch - 47ms/step
Epoch 12/50
6073/6073 - 269s - loss: 2.8380 - accuracy10: 0.5136 - val_loss: 3.3846 - val_accuracy10: 0.4537 - 269s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L1/h10
Evaluating performance on  test set...
21353/21353 - 489s - 489s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1063192
{'0': {'precision': 0.46310374693361644, 'recall': 0.34620542056664877, 'f1-score': 0.39621206310650375, 'support': 1805457}, '1': {'precision': 0.3522316225526185, 'recall': 0.6225070115936995, 'f1-score': 0.4498983564677633, 'support': 1836601}, '2': {'precision': 0.4837020880210146, 'recall': 0.23086090631353956, 'f1-score': 0.31254879782929446, 'support': 1824159}, 'accuracy': 0.40054813045292564, 'macro avg': {'precision': 0.4330124858357498, 'recall': 0.3998577794912959, 'f1-score': 0.3862197391345205, 'support': 5466217}, 'weighted avg': {'precision': 0.43272566182821026, 'recall': 0.40054813045292564, 'f1-score': 0.38633049450956986, 'support': 5466217}}
[[ 625059  980567  199831]
 [ 443629 1143297  249675]
 [ 281029 1122003  421127]]
Evaluating performance on  train set...
6073/6073 - 132s - 132s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0293274
{'0': {'precision': 0.42461523833169135, 'recall': 0.40871198928161934, 'f1-score': 0.4165118646966011, 'support': 393343}, '1': {'precision': 0.5589293148080509, 'recall': 0.45778199874329023, 'f1-score': 0.5033243468006843, 'support': 765491}, '2': {'precision': 0.37370942475135704, 'recall': 0.5184448600020216, 'f1-score': 0.434336826505769, 'support': 395720}, 'accuracy': 0.46080805169842926, 'macro avg': {'precision': 0.4524179926303664, 'recall': 0.4616462826756438, 'f1-score': 0.4513910126676848, 'support': 1554554}, 'weighted avg': {'precision': 0.4777956155755536, 'recall': 0.46080805169842926, 'f1-score': 0.4637973675646009, 'support': 1554554}}
[[160764 137720  94859]
 [166101 350428 248962]
 [ 51746 138815 205159]]
Evaluating performance on  val set...
1786/1786 - 43s - 43s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0276114
{'0': {'precision': 0.42765321804576073, 'recall': 0.46941092078606955, 'f1-score': 0.44756017361567796, 'support': 126859}, '1': {'precision': 0.48111064155617017, 'recall': 0.5666748804888867, 'f1-score': 0.5203990884959957, 'support': 202910}, '2': {'precision': 0.44713109563014564, 'recall': 0.2770357232546459, 'f1-score': 0.342107048368496, 'support': 127424}, 'accuracy': 0.4589615326568867, 'macro avg': {'precision': 0.4519649850773589, 'recall': 0.4377071748432007, 'f1-score': 0.4366887701600566, 'support': 457193}, 'weighted avg': {'precision': 0.4568071965139565, 'recall': 0.4589615326568867, 'f1-score': 0.45049653787949734, 'support': 457193}}
[[ 59549  54336  12974]
 [ 57251 114984  30675]
 [ 22446  69677  35301]]
training model: results/AAPL/W1/deepLOB_L1/h20
Epoch 1/50
6073/6073 - 284s - loss: 3.0871 - accuracy20: 0.4645 - val_loss: 3.3451 - val_accuracy20: 0.3862 - 284s/epoch - 47ms/step
Epoch 2/50
6073/6073 - 265s - loss: 3.0472 - accuracy20: 0.4792 - val_loss: 3.3614 - val_accuracy20: 0.3981 - 265s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 284s - loss: 3.0169 - accuracy20: 0.4888 - val_loss: 3.3930 - val_accuracy20: 0.3883 - 284s/epoch - 47ms/step
Epoch 4/50
6073/6073 - 309s - loss: 2.9988 - accuracy20: 0.4938 - val_loss: 3.3698 - val_accuracy20: 0.3939 - 309s/epoch - 51ms/step
Epoch 5/50
6073/6073 - 289s - loss: 2.9850 - accuracy20: 0.4980 - val_loss: 3.3746 - val_accuracy20: 0.4044 - 289s/epoch - 48ms/step
Epoch 6/50
6073/6073 - 275s - loss: 2.9733 - accuracy20: 0.5016 - val_loss: 3.3768 - val_accuracy20: 0.4071 - 275s/epoch - 45ms/step
Epoch 7/50
6073/6073 - 294s - loss: 2.9646 - accuracy20: 0.5040 - val_loss: 3.4218 - val_accuracy20: 0.4120 - 294s/epoch - 48ms/step
Epoch 8/50
6073/6073 - 282s - loss: 2.9567 - accuracy20: 0.5060 - val_loss: 3.3438 - val_accuracy20: 0.4210 - 282s/epoch - 46ms/step
Epoch 9/50
6073/6073 - 271s - loss: 2.9504 - accuracy20: 0.5079 - val_loss: 3.4123 - val_accuracy20: 0.4164 - 271s/epoch - 45ms/step
Epoch 10/50
6073/6073 - 275s - loss: 2.9446 - accuracy20: 0.5096 - val_loss: 3.4368 - val_accuracy20: 0.4160 - 275s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 282s - loss: 2.9396 - accuracy20: 0.5108 - val_loss: 3.4722 - val_accuracy20: 0.4164 - 282s/epoch - 47ms/step
Epoch 12/50
6073/6073 - 267s - loss: 2.9351 - accuracy20: 0.5121 - val_loss: 3.5451 - val_accuracy20: 0.4105 - 267s/epoch - 44ms/step
Epoch 13/50
6073/6073 - 277s - loss: 2.9313 - accuracy20: 0.5131 - val_loss: 3.5518 - val_accuracy20: 0.4112 - 277s/epoch - 46ms/step
Epoch 14/50
6073/6073 - 295s - loss: 2.9277 - accuracy20: 0.5139 - val_loss: 3.5183 - val_accuracy20: 0.4078 - 295s/epoch - 49ms/step
Epoch 15/50
6073/6073 - 286s - loss: 2.9247 - accuracy20: 0.5146 - val_loss: 3.5332 - val_accuracy20: 0.4042 - 286s/epoch - 47ms/step
Epoch 16/50
6073/6073 - 280s - loss: 2.9215 - accuracy20: 0.5155 - val_loss: 3.5684 - val_accuracy20: 0.4041 - 280s/epoch - 46ms/step
Epoch 17/50
6073/6073 - 272s - loss: 2.9191 - accuracy20: 0.5161 - val_loss: 3.5287 - val_accuracy20: 0.4037 - 272s/epoch - 45ms/step
Epoch 18/50
6073/6073 - 283s - loss: 2.9160 - accuracy20: 0.5173 - val_loss: 3.5463 - val_accuracy20: 0.3979 - 283s/epoch - 47ms/step
testing model: results/AAPL/W1/deepLOB_L1/h20
Evaluating performance on  test set...
21353/21353 - 446s - 446s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1962917
{'0': {'precision': 0.5022275279197916, 'recall': 0.43853196369989866, 'f1-score': 0.46822344287725104, 'support': 2118231}, '1': {'precision': 0.23294889080608167, 'recall': 0.6010008370727838, 'f1-score': 0.33575759710534375, 'support': 1205391}, '2': {'precision': 0.5524111910522099, 'recall': 0.13065511680928968, 'f1-score': 0.2113275032394653, 'support': 2142595}, 'accuracy': 0.35368043383568565, 'macro avg': {'precision': 0.4291958699260278, 'recall': 0.39006263919399076, 'f1-score': 0.33843618107402, 'support': 5466217}, 'weighted avg': {'precision': 0.4625176554504169, 'recall': 0.35368043383568565, 'f1-score': 0.3383169473815423, 'support': 5466217}}
[[ 928912 1055021  134298]
 [ 388427  724441   92523]
 [ 532245 1330409  279941]]
Evaluating performance on  train set...
6073/6073 - 146s - 146s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0567111
{'0': {'precision': 0.4731591459595608, 'recall': 0.42834468687000066, 'f1-score': 0.44963803554686127, 'support': 492064}, '1': {'precision': 0.4424208772903942, 'recall': 0.4844938560561732, 'f1-score': 0.4625025131799992, 'support': 567388}, '2': {'precision': 0.44848590466427474, 'recall': 0.4418261287573066, 'f1-score': 0.44513110824417107, 'support': 495102}, 'accuracy': 0.45313189506443646, 'macro avg': {'precision': 0.45468864263807657, 'recall': 0.45155489056116016, 'f1-score': 0.45242388565701047, 'support': 1554554}, 'weighted avg': {'precision': 0.45408210142110167, 'recall': 0.45313189506443646, 'f1-score': 0.45289798117364194, 'support': 1554554}}
[[210773 163982 117309]
 [140800 274896 151692]
 [ 93886 182467 218749]]
Evaluating performance on  val set...
1786/1786 - 42s - 42s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1002586
{'0': {'precision': 0.4742051938977524, 'recall': 0.49840881272949816, 'f1-score': 0.48600584830220206, 'support': 155230}, '1': {'precision': 0.3554644141544199, 'recall': 0.44104199088292406, 'f1-score': 0.39365592521342563, 'support': 145222}, '2': {'precision': 0.4490057616638561, 'recall': 0.32615588773837095, 'f1-score': 0.3778460219440718, 'support': 156741}, 'accuracy': 0.42113286948837797, 'macro avg': {'precision': 0.4262251232386762, 'recall': 0.4218688971169311, 'f1-score': 0.4191692651532331, 'support': 457193}, 'weighted avg': {'precision': 0.42784937103156817, 'recall': 0.42113286948837797, 'f1-score': 0.41959118343638396, 'support': 457193}}
[[77368 49442 28420]
 [46859 64049 34314]
 [38926 66693 51122]]
training model: results/AAPL/W1/deepLOB_L1/h30
Epoch 1/50
6073/6073 - 256s - loss: 3.1273 - accuracy30: 0.4531 - val_loss: 3.3860 - val_accuracy30: 0.3701 - 256s/epoch - 42ms/step
Epoch 2/50
6073/6073 - 286s - loss: 3.0987 - accuracy30: 0.4653 - val_loss: 3.3614 - val_accuracy30: 0.3991 - 286s/epoch - 47ms/step
Epoch 3/50
6073/6073 - 294s - loss: 3.0791 - accuracy30: 0.4719 - val_loss: 3.4371 - val_accuracy30: 0.3982 - 294s/epoch - 48ms/step
Epoch 4/50
6073/6073 - 270s - loss: 3.0649 - accuracy30: 0.4766 - val_loss: 3.4066 - val_accuracy30: 0.3912 - 270s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 280s - loss: 3.0543 - accuracy30: 0.4800 - val_loss: 3.4641 - val_accuracy30: 0.3885 - 280s/epoch - 46ms/step
Epoch 6/50
6073/6073 - 273s - loss: 3.0451 - accuracy30: 0.4831 - val_loss: 3.4723 - val_accuracy30: 0.3845 - 273s/epoch - 45ms/step
Epoch 7/50
6073/6073 - 281s - loss: 3.0371 - accuracy30: 0.4856 - val_loss: 3.4445 - val_accuracy30: 0.3888 - 281s/epoch - 46ms/step
Epoch 8/50
6073/6073 - 274s - loss: 3.0315 - accuracy30: 0.4875 - val_loss: 3.4305 - val_accuracy30: 0.3972 - 274s/epoch - 45ms/step
Epoch 9/50
6073/6073 - 285s - loss: 3.0255 - accuracy30: 0.4893 - val_loss: 3.4765 - val_accuracy30: 0.3850 - 285s/epoch - 47ms/step
Epoch 10/50
6073/6073 - 276s - loss: 3.0206 - accuracy30: 0.4904 - val_loss: 3.5183 - val_accuracy30: 0.3916 - 276s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 276s - loss: 3.0160 - accuracy30: 0.4916 - val_loss: 3.4819 - val_accuracy30: 0.3856 - 276s/epoch - 45ms/step
Epoch 12/50
6073/6073 - 272s - loss: 3.0124 - accuracy30: 0.4926 - val_loss: 3.5199 - val_accuracy30: 0.3790 - 272s/epoch - 45ms/step
testing model: results/AAPL/W1/deepLOB_L1/h30
Evaluating performance on  test set...
21353/21353 - 483s - 483s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1905773
{'0': {'precision': 0.49165368694136785, 'recall': 0.36859554296749036, 'f1-score': 0.42132291756732426, 'support': 2161483}, '1': {'precision': 0.20599853813879562, 'recall': 0.6042507252622272, 'f1-score': 0.3072505504067792, 'support': 1125455}, '2': {'precision': 0.5450474773633074, 'recall': 0.13617439529312217, 'f1-score': 0.2179070097868783, 'support': 2179279}, 'accuracy': 0.32445327362598303, 'macro avg': {'precision': 0.41423323414782365, 'recall': 0.3696735545076133, 'f1-score': 0.3154934925869939, 'support': 5466217}, 'weighted avg': {'precision': 0.4541264447373601, 'recall': 0.32445327362598303, 'f1-score': 0.3167380955460738, 'support': 5466217}}
[[ 796713 1222441  142329]
 [ 340019  680057  105379]
 [ 483744 1398773  296762]]
Evaluating performance on  train set...
6073/6073 - 130s - 130s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0819796
{'0': {'precision': 0.46328608308014035, 'recall': 0.40167528900191213, 'f1-score': 0.43028643201450667, 'support': 515135}, '1': {'precision': 0.3745709440288254, 'recall': 0.4427935477918563, 'f1-score': 0.40583509282821956, 'support': 520256}, '2': {'precision': 0.4459010939072289, 'recall': 0.42335451486334735, 'f1-score': 0.4343354000444631, 'support': 519163}, 'accuracy': 0.42267621452841136, 'macro avg': {'precision': 0.42791937367206484, 'recall': 0.42260778388570525, 'f1-score': 0.4234856416290631, 'support': 1554554}, 'weighted avg': {'precision': 0.4277902260586042, 'recall': 0.42267621452841136, 'f1-score': 0.4234556101000767, 'support': 1554554}}
[[206917 190878 117340]
 [134108 230366 155782]
 [105604 193769 219790]]
Evaluating performance on  val set...
1786/1786 - 46s - 46s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1206702
{'0': {'precision': 0.4410461300524453, 'recall': 0.551540736057129, 'f1-score': 0.49014331240893205, 'support': 161319}, '1': {'precision': 0.31116802595613235, 'recall': 0.42001814786762554, 'f1-score': 0.3574909444861095, 'support': 133349}, '2': {'precision': 0.4954878549752859, 'recall': 0.23006306722042763, 'f1-score': 0.3142259273576819, 'support': 162525}, 'accuracy': 0.3988993707252736, 'macro avg': {'precision': 0.41590067032795447, 'recall': 0.4005406503817274, 'f1-score': 0.38728672808424114, 'support': 457193}, 'weighted avg': {'precision': 0.42251790682931073, 'recall': 0.3988993707252736, 'f1-score': 0.3889168421532743, 'support': 457193}}
[[88974 55411 16934]
 [56202 56009 21138]
 [56558 68576 37391]]
training model: results/AAPL/W1/deepLOB_L1/h50
Epoch 1/50
6073/6073 - 308s - loss: 3.1881 - accuracy50: 0.4282 - val_loss: 3.3774 - val_accuracy50: 0.3649 - 308s/epoch - 51ms/step
Epoch 2/50
6073/6073 - 282s - loss: 3.1732 - accuracy50: 0.4342 - val_loss: 3.4099 - val_accuracy50: 0.3485 - 282s/epoch - 46ms/step
Epoch 3/50
6073/6073 - 296s - loss: 3.1596 - accuracy50: 0.4401 - val_loss: 3.4480 - val_accuracy50: 0.3427 - 296s/epoch - 49ms/step
Epoch 4/50
6073/6073 - 289s - loss: 3.1475 - accuracy50: 0.4463 - val_loss: 3.3708 - val_accuracy50: 0.3406 - 289s/epoch - 48ms/step
Epoch 5/50
6073/6073 - 285s - loss: 3.1384 - accuracy50: 0.4504 - val_loss: 3.4357 - val_accuracy50: 0.3382 - 285s/epoch - 47ms/step
Epoch 6/50
6073/6073 - 294s - loss: 3.1335 - accuracy50: 0.4529 - val_loss: 3.4222 - val_accuracy50: 0.3488 - 294s/epoch - 48ms/step
Epoch 7/50
6073/6073 - 275s - loss: 3.1285 - accuracy50: 0.4545 - val_loss: 3.4320 - val_accuracy50: 0.3332 - 275s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 277s - loss: 3.1238 - accuracy50: 0.4561 - val_loss: 3.4285 - val_accuracy50: 0.3428 - 277s/epoch - 46ms/step
Epoch 9/50
6073/6073 - 295s - loss: 3.1204 - accuracy50: 0.4572 - val_loss: 3.4300 - val_accuracy50: 0.3373 - 295s/epoch - 49ms/step
Epoch 10/50
6073/6073 - 297s - loss: 3.1177 - accuracy50: 0.4584 - val_loss: 3.4281 - val_accuracy50: 0.3432 - 297s/epoch - 49ms/step
Epoch 11/50
6073/6073 - 283s - loss: 3.1149 - accuracy50: 0.4598 - val_loss: 3.4329 - val_accuracy50: 0.3416 - 283s/epoch - 47ms/step
Epoch 12/50
6073/6073 - 275s - loss: 3.1125 - accuracy50: 0.4606 - val_loss: 3.5200 - val_accuracy50: 0.3358 - 275s/epoch - 45ms/step
Epoch 13/50
6073/6073 - 284s - loss: 3.1097 - accuracy50: 0.4613 - val_loss: 3.4826 - val_accuracy50: 0.3386 - 284s/epoch - 47ms/step
Epoch 14/50
6073/6073 - 280s - loss: 3.1073 - accuracy50: 0.4624 - val_loss: 3.4905 - val_accuracy50: 0.3388 - 280s/epoch - 46ms/step
testing model: results/AAPL/W1/deepLOB_L1/h50
Evaluating performance on  test set...
21353/21353 - 485s - 485s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1321338
{'0': {'precision': 0.3909522812369724, 'recall': 0.6842174277039772, 'f1-score': 0.49758910058291933, 'support': 2081961}, '1': {'precision': 0.2339607968862193, 'recall': 0.2744531412084936, 'f1-score': 0.25259447396622414, 'support': 1286941}, '2': {'precision': 0.43343519649147483, 'recall': 0.06465170944755556, 'f1-score': 0.11251982757941094, 'support': 2097315}, 'accuracy': 0.3500252551261686, 'macro avg': {'precision': 0.35278275820488886, 'recall': 0.3411074261200088, 'f1-score': 0.2875678007095181, 'support': 5466217}, 'weighted avg': {'precision': 0.3702910593252104, 'recall': 0.3500252551261686, 'f1-score': 0.29216271665376514, 'support': 5466217}}
[[1424514  554516  102931]
 [ 859424  353205   74312]
 [1359765  601955  135595]]
Evaluating performance on  train set...
6073/6073 - 145s - 145s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1132679
{'0': {'precision': 0.3572919633155367, 'recall': 0.4972659511834718, 'f1-score': 0.4158153004585311, 'support': 519742}, '1': {'precision': 0.31877389066253664, 'recall': 0.3359502362872845, 'f1-score': 0.3271367572452507, 'support': 509126}, '2': {'precision': 0.43032273611257243, 'recall': 0.24118770520805197, 'f1-score': 0.30911970041069187, 'support': 525686}, 'accuracy': 0.3578389686045001, 'macro avg': {'precision': 0.36879619669688185, 'recall': 0.35813463089293607, 'f1-score': 0.3506905860381579, 'support': 1554554}, 'weighted avg': {'precision': 0.3693730506055577, 'recall': 0.3578389686045001, 'f1-score': 0.350692483754349, 'support': 1554554}}
[[258450 185234  76058]
 [246295 171041  91790]
 [218613 180284 126789]]
Evaluating performance on  val set...
1786/1786 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1258696
{'0': {'precision': 0.3594693177863609, 'recall': 0.5185302247177085, 'f1-score': 0.4245918069598975, 'support': 161358}, '1': {'precision': 0.28266263495759997, 'recall': 0.3491520828940631, 'f1-score': 0.3124088279783983, 'support': 132796}, '2': {'precision': 0.42736287932718575, 'recall': 0.15833021546991824, 'f1-score': 0.23105772415212897, 'support': 163039}, 'accuracy': 0.3408822969730508, 'macro avg': {'precision': 0.35649827735704886, 'recall': 0.3420041743605633, 'f1-score': 0.32268611969680827, 'support': 457193}, 'weighted avg': {'precision': 0.36137153004054323, 'recall': 0.3408822969730508, 'f1-score': 0.3229912701981297, 'support': 457193}}
[[83669 59407 18282]
 [70123 46366 16307]
 [78965 58260 25814]]
training model: results/AAPL/W1/deepLOB_L1/h100
Epoch 1/50
6073/6073 - 309s - loss: 3.2151 - accuracy100: 0.4125 - val_loss: 3.4169 - val_accuracy100: 0.3295 - 309s/epoch - 51ms/step
Epoch 2/50
6073/6073 - 296s - loss: 3.2026 - accuracy100: 0.4192 - val_loss: 3.5539 - val_accuracy100: 0.3394 - 296s/epoch - 49ms/step
Epoch 3/50
6073/6073 - 302s - loss: 3.1927 - accuracy100: 0.4244 - val_loss: 3.6699 - val_accuracy100: 0.3271 - 302s/epoch - 50ms/step
Epoch 4/50
6073/6073 - 253s - loss: 3.1859 - accuracy100: 0.4275 - val_loss: 3.6781 - val_accuracy100: 0.3247 - 253s/epoch - 42ms/step
Epoch 5/50
6073/6073 - 293s - loss: 3.1821 - accuracy100: 0.4294 - val_loss: 3.7573 - val_accuracy100: 0.3157 - 293s/epoch - 48ms/step
Epoch 6/50
6073/6073 - 253s - loss: 3.1780 - accuracy100: 0.4314 - val_loss: 3.7285 - val_accuracy100: 0.3065 - 253s/epoch - 42ms/step
Epoch 7/50
6073/6073 - 255s - loss: 3.1761 - accuracy100: 0.4325 - val_loss: 3.7734 - val_accuracy100: 0.3045 - 255s/epoch - 42ms/step
Epoch 8/50
6073/6073 - 252s - loss: 3.1732 - accuracy100: 0.4340 - val_loss: 3.8284 - val_accuracy100: 0.3009 - 252s/epoch - 41ms/step
Epoch 9/50
6073/6073 - 254s - loss: 3.1704 - accuracy100: 0.4351 - val_loss: 3.8000 - val_accuracy100: 0.3131 - 254s/epoch - 42ms/step
Epoch 10/50
6073/6073 - 278s - loss: 3.1682 - accuracy100: 0.4364 - val_loss: 3.8288 - val_accuracy100: 0.3102 - 278s/epoch - 46ms/step
Epoch 11/50
6073/6073 - 266s - loss: 3.1666 - accuracy100: 0.4373 - val_loss: 3.7529 - val_accuracy100: 0.3127 - 266s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L1/h100
Evaluating performance on  test set...
21353/21353 - 495s - 495s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1662457
{'0': {'precision': 0.35802090015248866, 'recall': 0.5000762322950495, 'f1-score': 0.417290155300885, 'support': 1967670}, '1': {'precision': 0.27510566236534034, 'recall': 0.48254093885029953, 'f1-score': 0.3504265560957011, 'support': 1523736}, '2': {'precision': 0.37349397590361444, 'recall': 0.008539551379853566, 'f1-score': 0.01669733554525504, 'support': 1974811}, 'accuracy': 0.31760795445918083, 'macro avg': {'precision': 0.3355401794738145, 'recall': 0.33038557417506753, 'f1-score': 0.2614713489806137, 'support': 5466217}, 'weighted avg': {'precision': 0.3404978979431578, 'recall': 0.31760795445918083, 'f1-score': 0.2539271603497249, 'support': 5466217}}
[[983985 968100  15585]
 [775768 735265  12703]
 [988648 969299  16864]]
Evaluating performance on  train set...
6073/6073 - 155s - 155s/epoch - 26ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1439846
{'0': {'precision': 0.3230078663936022, 'recall': 0.3621369534991503, 'f1-score': 0.34145506554468225, 'support': 517840}, '1': {'precision': 0.3312298300312255, 'recall': 0.5370353233312898, 'f1-score': 0.4097414670597026, 'support': 518694}, '2': {'precision': 0.41681891658208337, 'recall': 0.10702096444152735, 'f1-score': 0.17031296801198112, 'support': 518020}, 'accuracy': 0.33548207395818996, 'macro avg': {'precision': 0.3570188710023037, 'recall': 0.3353977470906558, 'f1-score': 0.30716983353878863, 'support': 1554554}, 'weighted avg': {'precision': 0.35701162787483115, 'recall': 0.33548207395818996, 'f1-score': 0.3072103351484028, 'support': 1554554}}
[[187529 285174  45137]
 [207708 278557  32429]
 [185334 277247  55439]]
Evaluating performance on  val set...
1786/1786 - 41s - 41s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1386976
{'0': {'precision': 0.3131946568777404, 'recall': 0.35983364357028497, 'f1-score': 0.3348981742849182, 'support': 153646}, '1': {'precision': 0.3139635896661127, 'recall': 0.45366479288326145, 'f1-score': 0.3711020335275341, 'support': 146584}, '2': {'precision': 0.4220799024092711, 'recall': 0.1851646566388257, 'f1-score': 0.2574062757392991, 'support': 156963}, 'accuracy': 0.3299503710686734, 'macro avg': {'precision': 0.3497460496510414, 'recall': 0.33288769769745735, 'f1-score': 0.3211354945172505, 'support': 457193}, 'weighted avg': {'precision': 0.3508235532917634, 'recall': 0.3299503710686734, 'f1-score': 0.3199013253213593, 'support': 457193}}
[[55287 73337 25022]
 [65311 66500 14773]
 [55928 71971 29064]]
training model: results/AAPL/W1/deepLOB_L1/h200
Epoch 1/50
6073/6073 - 303s - loss: 3.2635 - accuracy200: 0.3855 - val_loss: 3.5615 - val_accuracy200: 0.3410 - 303s/epoch - 50ms/step
Epoch 2/50
6073/6073 - 286s - loss: 3.2453 - accuracy200: 0.3969 - val_loss: 3.4282 - val_accuracy200: 0.3404 - 286s/epoch - 47ms/step
Epoch 3/50
6073/6073 - 278s - loss: 3.2360 - accuracy200: 0.4032 - val_loss: 3.4015 - val_accuracy200: 0.3408 - 278s/epoch - 46ms/step
Epoch 4/50
6073/6073 - 265s - loss: 3.2308 - accuracy200: 0.4068 - val_loss: 3.3633 - val_accuracy200: 0.3384 - 265s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 282s - loss: 3.2266 - accuracy200: 0.4089 - val_loss: 3.4107 - val_accuracy200: 0.3367 - 282s/epoch - 46ms/step
Epoch 6/50
6073/6073 - 262s - loss: 3.2228 - accuracy200: 0.4109 - val_loss: 3.4140 - val_accuracy200: 0.3390 - 262s/epoch - 43ms/step
Epoch 7/50
6073/6073 - 260s - loss: 3.2198 - accuracy200: 0.4121 - val_loss: 3.4844 - val_accuracy200: 0.3354 - 260s/epoch - 43ms/step
Epoch 8/50
6073/6073 - 277s - loss: 3.2183 - accuracy200: 0.4129 - val_loss: 3.4730 - val_accuracy200: 0.3337 - 277s/epoch - 46ms/step
Epoch 9/50
6073/6073 - 285s - loss: 3.2158 - accuracy200: 0.4139 - val_loss: 3.4768 - val_accuracy200: 0.3355 - 285s/epoch - 47ms/step
Epoch 10/50
6073/6073 - 272s - loss: 3.2134 - accuracy200: 0.4152 - val_loss: 3.5379 - val_accuracy200: 0.3363 - 272s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 282s - loss: 3.2120 - accuracy200: 0.4157 - val_loss: 3.5555 - val_accuracy200: 0.3351 - 282s/epoch - 46ms/step
Epoch 12/50
6073/6073 - 271s - loss: 3.2102 - accuracy200: 0.4166 - val_loss: 3.5443 - val_accuracy200: 0.3355 - 271s/epoch - 45ms/step
Epoch 13/50
6073/6073 - 287s - loss: 3.2083 - accuracy200: 0.4174 - val_loss: 3.6454 - val_accuracy200: 0.3362 - 287s/epoch - 47ms/step
Epoch 14/50
6073/6073 - 276s - loss: 3.2068 - accuracy200: 0.4180 - val_loss: 3.7889 - val_accuracy200: 0.3349 - 276s/epoch - 45ms/step
testing model: results/AAPL/W1/deepLOB_L1/h200
Evaluating performance on  test set...
21353/21353 - 428s - 428s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.125835
{'0': {'precision': 0.3664209032892513, 'recall': 0.4296640669613878, 'f1-score': 0.3955303803244957, 'support': 1998047}, '1': {'precision': 0.2707172192261704, 'recall': 0.33742712076195464, 'f1-score': 0.30041332564553097, 'support': 1466124}, '2': {'precision': 0.3659966602567466, 'recall': 0.23690664450267376, 'f1-score': 0.287631664965612, 'support': 2002046}, 'accuracy': 0.33432573203734867, 'macro avg': {'precision': 0.33437826092405615, 'recall': 0.33466594407533873, 'f1-score': 0.3278584569785462, 'support': 5466217}, 'weighted avg': {'precision': 0.340596311590906, 'recall': 0.33432573203734867, 'f1-score': 0.3304997406401337, 'support': 5466217}}
[[858489 668484 471074]
 [620878 494710 350536]
 [863537 664211 474298]]
Evaluating performance on  train set...
6073/6073 - 134s - 134s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1240945
{'0': {'precision': 0.33334165031859253, 'recall': 0.4116311537757922, 'f1-score': 0.368372663721519, 'support': 519295}, '1': {'precision': 0.33858775615899805, 'recall': 0.2803257248996728, 'f1-score': 0.30671446362767846, 'support': 513071}, '2': {'precision': 0.34854281684547533, 'recall': 0.32606455912430005, 'f1-score': 0.33692919454753595, 'support': 522188}, 'accuracy': 0.3395520515852135, 'macro avg': {'precision': 0.34015740777435527, 'recall': 0.33934047926658834, 'f1-score': 0.33733877396557777, 'support': 1554554}, 'weighted avg': {'precision': 0.34017929733245156, 'recall': 0.3395520515852135, 'f1-score': 0.3374606229295165, 'support': 1554554}}
[[213758 140365 165172]
 [216172 143827 153072]
 [211328 140593 170267]]
Evaluating performance on  val set...
1786/1786 - 36s - 36s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1217812
{'0': {'precision': 0.3379266927811975, 'recall': 0.31239694004901614, 'f1-score': 0.32466070570525163, 'support': 154643}, '1': {'precision': 0.3209486108799328, 'recall': 0.3078658549283944, 'f1-score': 0.31427113671634177, 'support': 144053}, '2': {'precision': 0.3522595596755504, 'recall': 0.3912755446475328, 'f1-score': 0.37074389700761323, 'support': 158497}, 'accuracy': 0.3383144536333671, 'macro avg': {'precision': 0.33704495444556026, 'recall': 0.3371794465416478, 'f1-score': 0.3365585798097355, 'support': 457193}, 'weighted avg': {'precision': 0.33754604997177434, 'recall': 0.3383144536333671, 'f1-score': 0.33736299771385847, 'support': 457193}}
[[48310 46683 59650]
 [45318 44349 54386]
 [49332 47149 62016]]
training model: results/AAPL/W1/deepLOB_L1/h300
Epoch 1/50
6073/6073 - 302s - loss: 3.2414 - accuracy300: 0.4028 - val_loss: 3.3403 - val_accuracy300: 0.3344 - 302s/epoch - 50ms/step
Epoch 2/50
6073/6073 - 303s - loss: 3.2185 - accuracy300: 0.4147 - val_loss: 3.3571 - val_accuracy300: 0.3109 - 303s/epoch - 50ms/step
Epoch 3/50
6073/6073 - 326s - loss: 3.2091 - accuracy300: 0.4194 - val_loss: 3.4727 - val_accuracy300: 0.3036 - 326s/epoch - 54ms/step
Epoch 4/50
6073/6073 - 293s - loss: 3.2016 - accuracy300: 0.4231 - val_loss: 3.4290 - val_accuracy300: 0.3166 - 293s/epoch - 48ms/step
Epoch 5/50
6073/6073 - 301s - loss: 3.1955 - accuracy300: 0.4259 - val_loss: 3.4055 - val_accuracy300: 0.3139 - 301s/epoch - 50ms/step
Epoch 6/50
6073/6073 - 280s - loss: 3.1910 - accuracy300: 0.4279 - val_loss: 3.4121 - val_accuracy300: 0.3101 - 280s/epoch - 46ms/step
Epoch 7/50
6073/6073 - 314s - loss: 3.1876 - accuracy300: 0.4295 - val_loss: 3.4264 - val_accuracy300: 0.3101 - 314s/epoch - 52ms/step
Epoch 8/50
6073/6073 - 299s - loss: 3.1841 - accuracy300: 0.4308 - val_loss: 3.4096 - val_accuracy300: 0.3236 - 299s/epoch - 49ms/step
Epoch 9/50
6073/6073 - 276s - loss: 3.1805 - accuracy300: 0.4325 - val_loss: 3.4127 - val_accuracy300: 0.3274 - 276s/epoch - 45ms/step
Epoch 10/50
6073/6073 - 290s - loss: 3.1770 - accuracy300: 0.4338 - val_loss: 3.5677 - val_accuracy300: 0.3256 - 290s/epoch - 48ms/step
Epoch 11/50
6073/6073 - 298s - loss: 3.1762 - accuracy300: 0.4342 - val_loss: 3.5609 - val_accuracy300: 0.3204 - 298s/epoch - 49ms/step
testing model: results/AAPL/W1/deepLOB_L1/h300
Evaluating performance on  test set...
21353/21353 - 516s - 516s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1146708
{'0': {'precision': 0.34792303599368524, 'recall': 0.5204230657293224, 'f1-score': 0.4170391798164492, 'support': 1903534}, '1': {'precision': 0.30355687366002165, 'recall': 0.44092228478076956, 'f1-score': 0.35956678915069695, 'support': 1645392}, '2': {'precision': 0.3553426979052012, 'recall': 0.04243226510738328, 'f1-score': 0.07581168732839166, 'support': 1917291}, 'accuracy': 0.3288358292398564, 'macro avg': {'precision': 0.3356075358529694, 'recall': 0.3345925385391584, 'f1-score': 0.2841392187651793, 'support': 5466217}, 'weighted avg': {'precision': 0.3371707959035975, 'recall': 0.3288358292398564, 'f1-score': 0.2800528486623396, 'support': 5466217}}
[[ 990643  834128   78763]
 [ 851072  725490   68830]
 [1005590  830346   81355]]
Evaluating performance on  train set...
6073/6073 - 125s - 125s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.112906
{'0': {'precision': 0.3340374166191024, 'recall': 0.485467052107672, 'f1-score': 0.3957615025374658, 'support': 519578}, '1': {'precision': 0.3378669071035603, 'recall': 0.3814719433513226, 'f1-score': 0.35834779552193735, 'support': 511786}, '2': {'precision': 0.36283269704600224, 'recall': 0.15367839599380723, 'f1-score': 0.21590841957711457, 'support': 523190}, 'accuracy': 0.339565560282885, 'macro avg': {'precision': 0.3449123402562217, 'recall': 0.34020579715093396, 'f1-score': 0.32333923921217256, 'support': 1554554}, 'weighted avg': {'precision': 0.34498929245206056, 'recall': 0.339565560282885, 'f1-score': 0.3229141482913763, 'support': 1554554}}
[[252238 189902  77438]
 [252797 195232  63757]
 [250084 192703  80403]]
Evaluating performance on  val set...
1786/1786 - 40s - 40s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1139588
{'0': {'precision': 0.31636161952301717, 'recall': 0.3883098581961019, 'f1-score': 0.34866271588939857, 'support': 146893}, '1': {'precision': 0.34563059350707975, 'recall': 0.5214791394597567, 'f1-score': 0.41572395654318034, 'support': 160039}, '2': {'precision': 0.35585661868473045, 'recall': 0.08390733457117948, 'f1-score': 0.1357954882035209, 'support': 150261}, 'accuracy': 0.3348804553000593, 'macro avg': {'precision': 0.33928294390494246, 'recall': 0.33123211074234604, 'f1-score': 0.3000607202120333, 'support': 457193}, 'weighted avg': {'precision': 0.33958755560793885, 'recall': 0.3348804553000593, 'f1-score': 0.3021763772833458, 'support': 457193}}
[[57040 77895 11958]
 [65718 83457 10864]
 [57542 80111 12608]]
training model: results/AAPL/W1/deepLOB_L1/h500
Epoch 1/50
6073/6073 - 300s - loss: 3.2298 - accuracy500: 0.4098 - val_loss: 3.3513 - val_accuracy500: 0.3343 - 300s/epoch - 49ms/step
Epoch 2/50
6073/6073 - 313s - loss: 3.2005 - accuracy500: 0.4234 - val_loss: 3.3253 - val_accuracy500: 0.3367 - 313s/epoch - 52ms/step
Epoch 3/50
6073/6073 - 271s - loss: 3.1881 - accuracy500: 0.4300 - val_loss: 3.3409 - val_accuracy500: 0.3364 - 271s/epoch - 45ms/step
Epoch 4/50
6073/6073 - 301s - loss: 3.1782 - accuracy500: 0.4347 - val_loss: 3.3608 - val_accuracy500: 0.3373 - 301s/epoch - 49ms/step
Epoch 5/50
6073/6073 - 311s - loss: 3.1710 - accuracy500: 0.4372 - val_loss: 3.4125 - val_accuracy500: 0.3391 - 311s/epoch - 51ms/step
Epoch 6/50
6073/6073 - 296s - loss: 3.1642 - accuracy500: 0.4395 - val_loss: 3.3892 - val_accuracy500: 0.3341 - 296s/epoch - 49ms/step
Epoch 7/50
6073/6073 - 289s - loss: 3.1571 - accuracy500: 0.4421 - val_loss: 3.4299 - val_accuracy500: 0.3343 - 289s/epoch - 48ms/step
Epoch 8/50
6073/6073 - 295s - loss: 3.1522 - accuracy500: 0.4443 - val_loss: 3.3770 - val_accuracy500: 0.3366 - 295s/epoch - 49ms/step
Epoch 9/50
6073/6073 - 298s - loss: 3.1478 - accuracy500: 0.4457 - val_loss: 3.3747 - val_accuracy500: 0.3345 - 298s/epoch - 49ms/step
Epoch 10/50
6073/6073 - 273s - loss: 3.1448 - accuracy500: 0.4468 - val_loss: 3.3664 - val_accuracy500: 0.3356 - 273s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 300s - loss: 3.1413 - accuracy500: 0.4476 - val_loss: 3.3775 - val_accuracy500: 0.3349 - 300s/epoch - 49ms/step
Epoch 12/50
6073/6073 - 291s - loss: 3.1386 - accuracy500: 0.4487 - val_loss: 3.3834 - val_accuracy500: 0.3389 - 291s/epoch - 48ms/step
testing model: results/AAPL/W1/deepLOB_L1/h500
Evaluating performance on  test set...
21353/21353 - 470s - 470s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943863
{'0': {'precision': 0.37664685942678594, 'recall': 0.6644061935215636, 'f1-score': 0.4807564906800536, 'support': 2058861}, '1': {'precision': 0.2365344104516553, 'recall': 0.03740442792755967, 'f1-score': 0.06459423103692372, 'support': 1308829}, '2': {'precision': 0.3821690688505894, 'recall': 0.29637216962183477, 'f1-score': 0.3338464036543848, 'support': 2098527}, 'accuracy': 0.3729857413271372, 'macro avg': {'precision': 0.3317834462430102, 'recall': 0.3327275970236527, 'f1-score': 0.2930657084571207, 'support': 5466217}, 'weighted avg': {'precision': 0.3452184088357894, 'recall': 0.3729857413271372, 'f1-score': 0.32471072478342455, 'support': 5466217}}
[[1367920   78516  612425]
 [ 866835   48956  393038]
 [1397082   79500  621945]]
Evaluating performance on  train set...
6073/6073 - 137s - 137s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1281831
{'0': {'precision': 0.3261907796662769, 'recall': 0.5707437215165325, 'f1-score': 0.4151280595530699, 'support': 515650}, '1': {'precision': 0.2686244617617723, 'recall': 0.12900757264501256, 'f1-score': 0.17430481835629447, 'support': 513559}, '2': {'precision': 0.34121739044693855, 'recall': 0.26348780325310034, 'f1-score': 0.29735686604741485, 'support': 525345}, 'accuracy': 0.32097887882955495, 'macro avg': {'precision': 0.3120108772916626, 'recall': 0.32107969913821516, 'f1-score': 0.2955965813189264, 'support': 1554554}, 'weighted avg': {'precision': 0.3122513823753801, 'recall': 0.32097887882955495, 'f1-score': 0.29577070652576876, 'support': 1554554}}
[[294304  89489 131857]
 [311914  66253 135392]
 [296027  90896 138422]]
Evaluating performance on  val set...
1786/1786 - 46s - 46s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1087401
{'0': {'precision': 0.3466273514823196, 'recall': 0.4845291651756045, 'f1-score': 0.4041382287805177, 'support': 156488}, '1': {'precision': 0.304559969851439, 'recall': 0.215946727046431, 'f1-score': 0.2527104034232344, 'support': 142211}, '2': {'precision': 0.3449140349092389, 'recall': 0.29947505899276944, 'f1-score': 0.3205924865251868, 'support': 158494}, 'accuracy': 0.3368336785558834, 'macro avg': {'precision': 0.33203378541433254, 'recall': 0.33331698373826835, 'f1-score': 0.3258137062429796, 'support': 457193}, 'weighted avg': {'precision': 0.3329482382718308, 'recall': 0.3368336785558834, 'f1-score': 0.3280736316740418, 'support': 457193}}
[[75823 34002 46663]
 [68015 30710 43486]
 [74907 36122 47465]]
training model: results/AAPL/W1/deepLOB_L1/h1000
Epoch 1/50
6073/6073 - 308s - loss: 3.1963 - accuracy1000: 0.4258 - val_loss: 3.4727 - val_accuracy1000: 0.3262 - 308s/epoch - 51ms/step
Epoch 2/50
6073/6073 - 274s - loss: 3.1458 - accuracy1000: 0.4476 - val_loss: 3.3584 - val_accuracy1000: 0.3348 - 274s/epoch - 45ms/step
Epoch 3/50
6073/6073 - 299s - loss: 3.1225 - accuracy1000: 0.4565 - val_loss: 3.3723 - val_accuracy1000: 0.3226 - 299s/epoch - 49ms/step
Epoch 4/50
6073/6073 - 304s - loss: 3.1075 - accuracy1000: 0.4618 - val_loss: 3.3819 - val_accuracy1000: 0.3359 - 304s/epoch - 50ms/step
Epoch 5/50
6073/6073 - 308s - loss: 3.0948 - accuracy1000: 0.4664 - val_loss: 3.3640 - val_accuracy1000: 0.3345 - 308s/epoch - 51ms/step
Epoch 6/50
6073/6073 - 310s - loss: 3.0872 - accuracy1000: 0.4685 - val_loss: 3.3508 - val_accuracy1000: 0.3328 - 310s/epoch - 51ms/step
Epoch 7/50
6073/6073 - 317s - loss: 3.0781 - accuracy1000: 0.4710 - val_loss: 3.3689 - val_accuracy1000: 0.3360 - 317s/epoch - 52ms/step
Epoch 8/50
6073/6073 - 295s - loss: 3.0736 - accuracy1000: 0.4726 - val_loss: 3.3949 - val_accuracy1000: 0.3379 - 295s/epoch - 49ms/step
Epoch 9/50
6073/6073 - 292s - loss: 3.0683 - accuracy1000: 0.4740 - val_loss: 3.5080 - val_accuracy1000: 0.3420 - 292s/epoch - 48ms/step
Epoch 10/50
6073/6073 - 300s - loss: 3.0651 - accuracy1000: 0.4747 - val_loss: 3.4679 - val_accuracy1000: 0.3383 - 300s/epoch - 49ms/step
Epoch 11/50
6073/6073 - 296s - loss: 3.0597 - accuracy1000: 0.4766 - val_loss: 3.5438 - val_accuracy1000: 0.3390 - 296s/epoch - 49ms/step
Epoch 12/50
6073/6073 - 313s - loss: 3.0562 - accuracy1000: 0.4774 - val_loss: 3.4939 - val_accuracy1000: 0.3413 - 313s/epoch - 52ms/step
Epoch 13/50
6073/6073 - 301s - loss: 3.0535 - accuracy1000: 0.4780 - val_loss: 3.6187 - val_accuracy1000: 0.3444 - 301s/epoch - 50ms/step
Epoch 14/50
6073/6073 - 305s - loss: 3.0508 - accuracy1000: 0.4787 - val_loss: 3.6029 - val_accuracy1000: 0.3446 - 305s/epoch - 50ms/step
Epoch 15/50
6073/6073 - 277s - loss: 3.0484 - accuracy1000: 0.4795 - val_loss: 3.6413 - val_accuracy1000: 0.3450 - 277s/epoch - 46ms/step
Epoch 16/50
6073/6073 - 286s - loss: 3.0456 - accuracy1000: 0.4801 - val_loss: 3.7073 - val_accuracy1000: 0.3434 - 286s/epoch - 47ms/step
testing model: results/AAPL/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
21353/21353 - 466s - 466s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999925
{'0': {'precision': 0.3675195526772127, 'recall': 0.10157964416313192, 'f1-score': 0.15916678448993635, 'support': 2044701}, '1': {'precision': 0.21930738676694908, 'recall': 0.04341917398617081, 'f1-score': 0.07248711782463768, 'support': 1337750}, '2': {'precision': 0.37715943466937, 'recall': 0.8391518049531473, 'f1-score': 0.5204161731764224, 'support': 2083766}, 'accuracy': 0.36851445890274753, 'macro avg': {'precision': 0.32132879137117726, 'recall': 0.32805020770081667, 'f1-score': 0.2506900251636655, 'support': 5466217}, 'weighted avg': {'precision': 0.3349223164886045, 'recall': 0.36851445890274753, 'f1-score': 0.27566480672070054, 'support': 5466217}}
[[ 207700   97246 1739755]
 [ 131792   58084 1147874]
 [ 225648  109522 1748596]]
Evaluating performance on  train set...
6073/6073 - 134s - 134s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1398362
{'0': {'precision': 0.3392212843429328, 'recall': 0.16031529998865826, 'f1-score': 0.2177312479915439, 'support': 511386}, '1': {'precision': 0.29185390889485924, 'recall': 0.188789416773012, 'f1-score': 0.22927158789367272, 'support': 513265}, '2': {'precision': 0.33681088675063364, 'recall': 0.6234442907475519, 'f1-score': 0.43734796609664645, 'support': 529903}, 'accuracy': 0.32758398871959415, 'macro avg': {'precision': 0.32262869332947525, 'recall': 0.3241830025030741, 'f1-score': 0.29478360066062104, 'support': 1554554}, 'weighted avg': {'precision': 0.3227604261966686, 'recall': 0.32758398871959415, 'f1-score': 0.2964025648669399, 'support': 1554554}}
[[ 81983 116683 312720]
 [ 78589  96899 337777]
 [ 81108 118430 330365]]
Evaluating performance on  val set...
1786/1786 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161647
{'0': {'precision': 0.35046277894497757, 'recall': 0.07818645925043863, 'f1-score': 0.12785019238636774, 'support': 157879}, '1': {'precision': 0.3028428389619803, 'recall': 0.2560371671452697, 'f1-score': 0.2774800376851437, 'support': 140339}, '2': {'precision': 0.34187431178747335, 'recall': 0.652291240761126, 'f1-score': 0.44862069189287407, 'support': 158975}, 'accuracy': 0.3324066641440267, 'macro avg': {'precision': 0.3317266432314771, 'recall': 0.32883828905227813, 'f1-score': 0.28465030732146185, 'support': 457193}, 'weighted avg': {'precision': 0.33285908351736143, 'recall': 0.3324066641440267, 'f1-score': 0.2853184673127812, 'support': 457193}}
[[ 12344  40033 105502]
 [ 10285  35932  94122]
 [ 12593  42684 103698]]
training model: results/AAPL/W1/deepOF_L1/h10
Epoch 1/50
6073/6073 - 297s - loss: 3.1602 - accuracy10: 0.4366 - val_loss: 3.3703 - val_accuracy10: 0.4582 - 297s/epoch - 49ms/step
Epoch 2/50
6073/6073 - 258s - loss: 3.1355 - accuracy10: 0.4376 - val_loss: 3.3521 - val_accuracy10: 0.4614 - 258s/epoch - 42ms/step
Epoch 3/50
6073/6073 - 271s - loss: 3.1188 - accuracy10: 0.4429 - val_loss: 3.3385 - val_accuracy10: 0.4625 - 271s/epoch - 45ms/step
Epoch 4/50
6073/6073 - 264s - loss: 3.1062 - accuracy10: 0.4473 - val_loss: 3.3257 - val_accuracy10: 0.4632 - 264s/epoch - 43ms/step
Epoch 5/50
6073/6073 - 266s - loss: 3.0956 - accuracy10: 0.4512 - val_loss: 3.3142 - val_accuracy10: 0.4647 - 266s/epoch - 44ms/step
Epoch 6/50
6073/6073 - 262s - loss: 3.0883 - accuracy10: 0.4536 - val_loss: 3.3079 - val_accuracy10: 0.4650 - 262s/epoch - 43ms/step
Epoch 7/50
6073/6073 - 270s - loss: 3.0816 - accuracy10: 0.4560 - val_loss: 3.3041 - val_accuracy10: 0.4661 - 270s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 275s - loss: 3.0765 - accuracy10: 0.4575 - val_loss: 3.3021 - val_accuracy10: 0.4645 - 275s/epoch - 45ms/step
Epoch 9/50
6073/6073 - 283s - loss: 3.0711 - accuracy10: 0.4589 - val_loss: 3.3024 - val_accuracy10: 0.4648 - 283s/epoch - 47ms/step
Epoch 10/50
6073/6073 - 272s - loss: 3.0668 - accuracy10: 0.4605 - val_loss: 3.2979 - val_accuracy10: 0.4655 - 272s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 278s - loss: 3.0636 - accuracy10: 0.4613 - val_loss: 3.2947 - val_accuracy10: 0.4651 - 278s/epoch - 46ms/step
Epoch 12/50
6073/6073 - 268s - loss: 3.0590 - accuracy10: 0.4630 - val_loss: 3.2947 - val_accuracy10: 0.4659 - 268s/epoch - 44ms/step
Epoch 13/50
6073/6073 - 255s - loss: 3.0562 - accuracy10: 0.4641 - val_loss: 3.2972 - val_accuracy10: 0.4670 - 255s/epoch - 42ms/step
Epoch 14/50
6073/6073 - 231s - loss: 3.0525 - accuracy10: 0.4653 - val_loss: 3.2947 - val_accuracy10: 0.4661 - 231s/epoch - 38ms/step
Epoch 15/50
6073/6073 - 260s - loss: 3.0498 - accuracy10: 0.4663 - val_loss: 3.2925 - val_accuracy10: 0.4673 - 260s/epoch - 43ms/step
Epoch 16/50
6073/6073 - 271s - loss: 3.0475 - accuracy10: 0.4671 - val_loss: 3.2846 - val_accuracy10: 0.4667 - 271s/epoch - 45ms/step
Epoch 17/50
6073/6073 - 271s - loss: 3.0448 - accuracy10: 0.4679 - val_loss: 3.2921 - val_accuracy10: 0.4681 - 271s/epoch - 45ms/step
Epoch 18/50
6073/6073 - 274s - loss: 3.0418 - accuracy10: 0.4688 - val_loss: 3.2947 - val_accuracy10: 0.4678 - 274s/epoch - 45ms/step
Epoch 19/50
6073/6073 - 241s - loss: 3.0404 - accuracy10: 0.4690 - val_loss: 3.2884 - val_accuracy10: 0.4674 - 241s/epoch - 40ms/step
Epoch 20/50
6073/6073 - 267s - loss: 3.0377 - accuracy10: 0.4700 - val_loss: 3.2770 - val_accuracy10: 0.4669 - 267s/epoch - 44ms/step
Epoch 21/50
6073/6073 - 260s - loss: 3.0350 - accuracy10: 0.4707 - val_loss: 3.2814 - val_accuracy10: 0.4667 - 260s/epoch - 43ms/step
Epoch 22/50
6073/6073 - 280s - loss: 3.0329 - accuracy10: 0.4713 - val_loss: 3.2806 - val_accuracy10: 0.4667 - 280s/epoch - 46ms/step
Epoch 23/50
6073/6073 - 247s - loss: 3.0316 - accuracy10: 0.4716 - val_loss: 3.2825 - val_accuracy10: 0.4671 - 247s/epoch - 41ms/step
Epoch 24/50
6073/6073 - 273s - loss: 3.0293 - accuracy10: 0.4721 - val_loss: 3.2778 - val_accuracy10: 0.4667 - 273s/epoch - 45ms/step
Epoch 25/50
6073/6073 - 276s - loss: 3.0274 - accuracy10: 0.4727 - val_loss: 3.2770 - val_accuracy10: 0.4668 - 276s/epoch - 45ms/step
Epoch 26/50
6073/6073 - 269s - loss: 3.0253 - accuracy10: 0.4733 - val_loss: 3.2843 - val_accuracy10: 0.4668 - 269s/epoch - 44ms/step
Epoch 27/50
6073/6073 - 256s - loss: 3.0237 - accuracy10: 0.4739 - val_loss: 3.2824 - val_accuracy10: 0.4664 - 256s/epoch - 42ms/step
Epoch 28/50
6073/6073 - 266s - loss: 3.0221 - accuracy10: 0.4741 - val_loss: 3.2777 - val_accuracy10: 0.4661 - 266s/epoch - 44ms/step
Epoch 29/50
6073/6073 - 266s - loss: 3.0203 - accuracy10: 0.4746 - val_loss: 3.2822 - val_accuracy10: 0.4666 - 266s/epoch - 44ms/step
Epoch 30/50
6073/6073 - 255s - loss: 3.0188 - accuracy10: 0.4751 - val_loss: 3.2819 - val_accuracy10: 0.4687 - 255s/epoch - 42ms/step
Epoch 31/50
6073/6073 - 260s - loss: 3.0165 - accuracy10: 0.4765 - val_loss: 3.2923 - val_accuracy10: 0.4676 - 260s/epoch - 43ms/step
Epoch 32/50
6073/6073 - 250s - loss: 3.0152 - accuracy10: 0.4758 - val_loss: 3.2798 - val_accuracy10: 0.4677 - 250s/epoch - 41ms/step
Epoch 33/50
6073/6073 - 247s - loss: 3.0132 - accuracy10: 0.4769 - val_loss: 3.2802 - val_accuracy10: 0.4677 - 247s/epoch - 41ms/step
Epoch 34/50
6073/6073 - 253s - loss: 3.0119 - accuracy10: 0.4772 - val_loss: 3.2893 - val_accuracy10: 0.4667 - 253s/epoch - 42ms/step
Epoch 35/50
6073/6073 - 265s - loss: 3.0099 - accuracy10: 0.4778 - val_loss: 3.2832 - val_accuracy10: 0.4680 - 265s/epoch - 44ms/step
testing model: results/AAPL/W1/deepOF_L1/h10
Evaluating performance on  test set...
21353/21353 - 476s - 476s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0898707
{'0': {'precision': 0.46286595884086706, 'recall': 0.372891391426875, 'f1-score': 0.4130355093640806, 'support': 1805456}, '1': {'precision': 0.38556353841062335, 'recall': 0.5188892518784711, 'f1-score': 0.44239959928379874, 'support': 1836600}, '2': {'precision': 0.44142335351698836, 'recall': 0.3726671403103682, 'f1-score': 0.40414175099377825, 'support': 1824156}, 'accuracy': 0.421870575089294, 'macro avg': {'precision': 0.4299509502561596, 'recall': 0.4214825945385714, 'f1-score': 0.41985895321388583, 'support': 5466212}, 'weighted avg': {'precision': 0.429737298167009, 'recall': 0.421870575089294, 'f1-score': 0.4199336108012032, 'support': 5466212}}
[[673239 735333 396884]
 [420270 952992 463338]
 [360992 783361 679803]]
Evaluating performance on  train set...
6073/6073 - 135s - 135s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.007294
{'0': {'precision': 0.3906302421503424, 'recall': 0.4021888763023281, 'f1-score': 0.3963253016571433, 'support': 393718}, '1': {'precision': 0.5715753447068601, 'recall': 0.5707185814987416, 'f1-score': 0.5711466418005607, 'support': 765202}, '2': {'precision': 0.3935346506374471, 'recall': 0.38308735621143836, 'f1-score': 0.38824073374378654, 'support': 395633}, 'accuracy': 0.4802833997940244, 'macro avg': {'precision': 0.45191341249821654, 'recall': 0.45199827133750264, 'f1-score': 0.45190422573383016, 'support': 1554553}, 'weighted avg': {'precision': 0.48043653000893016, 'recall': 0.4802833997940244, 'f1-score': 0.48032058342827505, 'support': 1554553}}
[[158349 160066  75303]
 [170222 436715 158265]
 [ 76797 167274 151562]]
Evaluating performance on  val set...
1786/1786 - 41s - 41s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.024909
{'0': {'precision': 0.4221787447174832, 'recall': 0.42593206689089963, 'f1-score': 0.42404710062334433, 'support': 126654}, '1': {'precision': 0.5311283758054706, 'recall': 0.528824375160026, 'f1-score': 0.5299738713999157, 'support': 203092}, '2': {'precision': 0.40926565042727653, 'recall': 0.4084788851748976, 'f1-score': 0.40887188932129576, 'support': 127446}, 'accuracy': 0.4667732593746172, 'macro avg': {'precision': 0.45419092365007674, 'recall': 0.4544117757419411, 'f1-score': 0.4542976204481852, 'support': 457192}, 'weighted avg': {'precision': 0.46697628330523594, 'recall': 0.4667732593746172, 'f1-score': 0.4668712527322057, 'support': 457192}}
[[ 53946  45656  27052]
 [ 47602 107400  48090]
 [ 26232  49155  52059]]
training model: results/AAPL/W1/deepOF_L1/h20
Epoch 1/50
6073/6073 - 268s - loss: 3.1774 - accuracy20: 0.4403 - val_loss: 3.3141 - val_accuracy20: 0.3932 - 268s/epoch - 44ms/step
Epoch 2/50
6073/6073 - 267s - loss: 3.1622 - accuracy20: 0.4448 - val_loss: 3.3075 - val_accuracy20: 0.3996 - 267s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 256s - loss: 3.1499 - accuracy20: 0.4492 - val_loss: 3.3011 - val_accuracy20: 0.4056 - 256s/epoch - 42ms/step
Epoch 4/50
6073/6073 - 278s - loss: 3.1382 - accuracy20: 0.4531 - val_loss: 3.2895 - val_accuracy20: 0.4122 - 278s/epoch - 46ms/step
Epoch 5/50
6073/6073 - 243s - loss: 3.1304 - accuracy20: 0.4550 - val_loss: 3.2809 - val_accuracy20: 0.4170 - 243s/epoch - 40ms/step
Epoch 6/50
6073/6073 - 258s - loss: 3.1231 - accuracy20: 0.4570 - val_loss: 3.2783 - val_accuracy20: 0.4192 - 258s/epoch - 43ms/step
Epoch 7/50
6073/6073 - 258s - loss: 3.1176 - accuracy20: 0.4583 - val_loss: 3.2724 - val_accuracy20: 0.4226 - 258s/epoch - 42ms/step
Epoch 8/50
6073/6073 - 272s - loss: 3.1120 - accuracy20: 0.4599 - val_loss: 3.2658 - val_accuracy20: 0.4240 - 272s/epoch - 45ms/step
Epoch 9/50
6073/6073 - 260s - loss: 3.1070 - accuracy20: 0.4613 - val_loss: 3.2666 - val_accuracy20: 0.4247 - 260s/epoch - 43ms/step
Epoch 10/50
6073/6073 - 237s - loss: 3.1031 - accuracy20: 0.4629 - val_loss: 3.2655 - val_accuracy20: 0.4261 - 237s/epoch - 39ms/step
Epoch 11/50
6073/6073 - 274s - loss: 3.0995 - accuracy20: 0.4640 - val_loss: 3.2601 - val_accuracy20: 0.4264 - 274s/epoch - 45ms/step
Epoch 12/50
6073/6073 - 265s - loss: 3.0962 - accuracy20: 0.4652 - val_loss: 3.2614 - val_accuracy20: 0.4283 - 265s/epoch - 44ms/step
Epoch 13/50
6073/6073 - 242s - loss: 3.0941 - accuracy20: 0.4656 - val_loss: 3.2590 - val_accuracy20: 0.4289 - 242s/epoch - 40ms/step
Epoch 14/50
6073/6073 - 284s - loss: 3.0916 - accuracy20: 0.4666 - val_loss: 3.2582 - val_accuracy20: 0.4292 - 284s/epoch - 47ms/step
Epoch 15/50
6073/6073 - 258s - loss: 3.0888 - accuracy20: 0.4675 - val_loss: 3.2586 - val_accuracy20: 0.4298 - 258s/epoch - 43ms/step
Epoch 16/50
6073/6073 - 271s - loss: 3.0865 - accuracy20: 0.4683 - val_loss: 3.2531 - val_accuracy20: 0.4309 - 271s/epoch - 45ms/step
Epoch 17/50
6073/6073 - 252s - loss: 3.0840 - accuracy20: 0.4691 - val_loss: 3.2553 - val_accuracy20: 0.4312 - 252s/epoch - 42ms/step
Epoch 18/50
6073/6073 - 252s - loss: 3.0819 - accuracy20: 0.4701 - val_loss: 3.2548 - val_accuracy20: 0.4315 - 252s/epoch - 41ms/step
Epoch 19/50
6073/6073 - 273s - loss: 3.0792 - accuracy20: 0.4708 - val_loss: 3.2548 - val_accuracy20: 0.4309 - 273s/epoch - 45ms/step
Epoch 20/50
6073/6073 - 287s - loss: 3.0773 - accuracy20: 0.4716 - val_loss: 3.2546 - val_accuracy20: 0.4317 - 287s/epoch - 47ms/step
Epoch 21/50
6073/6073 - 255s - loss: 3.0754 - accuracy20: 0.4720 - val_loss: 3.2563 - val_accuracy20: 0.4308 - 255s/epoch - 42ms/step
Epoch 22/50
6073/6073 - 272s - loss: 3.0730 - accuracy20: 0.4728 - val_loss: 3.2560 - val_accuracy20: 0.4316 - 272s/epoch - 45ms/step
Epoch 23/50
6073/6073 - 278s - loss: 3.0716 - accuracy20: 0.4737 - val_loss: 3.2587 - val_accuracy20: 0.4309 - 278s/epoch - 46ms/step
Epoch 24/50
6073/6073 - 276s - loss: 3.0694 - accuracy20: 0.4743 - val_loss: 3.2549 - val_accuracy20: 0.4316 - 276s/epoch - 45ms/step
Epoch 25/50
6073/6073 - 284s - loss: 3.0673 - accuracy20: 0.4747 - val_loss: 3.2527 - val_accuracy20: 0.4325 - 284s/epoch - 47ms/step
Epoch 26/50
6073/6073 - 265s - loss: 3.0659 - accuracy20: 0.4752 - val_loss: 3.2574 - val_accuracy20: 0.4312 - 265s/epoch - 44ms/step
Epoch 27/50
6073/6073 - 261s - loss: 3.0644 - accuracy20: 0.4760 - val_loss: 3.2509 - val_accuracy20: 0.4334 - 261s/epoch - 43ms/step
Epoch 28/50
6073/6073 - 267s - loss: 3.0625 - accuracy20: 0.4762 - val_loss: 3.2565 - val_accuracy20: 0.4324 - 267s/epoch - 44ms/step
Epoch 29/50
6073/6073 - 253s - loss: 3.0609 - accuracy20: 0.4772 - val_loss: 3.2555 - val_accuracy20: 0.4328 - 253s/epoch - 42ms/step
Epoch 30/50
6073/6073 - 275s - loss: 3.0596 - accuracy20: 0.4772 - val_loss: 3.2599 - val_accuracy20: 0.4320 - 275s/epoch - 45ms/step
Epoch 31/50
6073/6073 - 263s - loss: 3.0580 - accuracy20: 0.4776 - val_loss: 3.2597 - val_accuracy20: 0.4316 - 263s/epoch - 43ms/step
Epoch 32/50
6073/6073 - 263s - loss: 3.0566 - accuracy20: 0.4785 - val_loss: 3.2492 - val_accuracy20: 0.4340 - 263s/epoch - 43ms/step
Epoch 33/50
6073/6073 - 256s - loss: 3.0546 - accuracy20: 0.4787 - val_loss: 3.2584 - val_accuracy20: 0.4319 - 256s/epoch - 42ms/step
Epoch 34/50
6073/6073 - 263s - loss: 3.0525 - accuracy20: 0.4797 - val_loss: 3.2560 - val_accuracy20: 0.4328 - 263s/epoch - 43ms/step
Epoch 35/50
6073/6073 - 274s - loss: 3.0517 - accuracy20: 0.4795 - val_loss: 3.2547 - val_accuracy20: 0.4342 - 274s/epoch - 45ms/step
Epoch 36/50
6073/6073 - 259s - loss: 3.0504 - accuracy20: 0.4802 - val_loss: 3.2584 - val_accuracy20: 0.4330 - 259s/epoch - 43ms/step
Epoch 37/50
6073/6073 - 278s - loss: 3.0489 - accuracy20: 0.4808 - val_loss: 3.2663 - val_accuracy20: 0.4324 - 278s/epoch - 46ms/step
Epoch 38/50
6073/6073 - 256s - loss: 3.0475 - accuracy20: 0.4812 - val_loss: 3.2637 - val_accuracy20: 0.4323 - 256s/epoch - 42ms/step
Epoch 39/50
6073/6073 - 271s - loss: 3.0465 - accuracy20: 0.4816 - val_loss: 3.2559 - val_accuracy20: 0.4341 - 271s/epoch - 45ms/step
Epoch 40/50
6073/6073 - 277s - loss: 3.0451 - accuracy20: 0.4820 - val_loss: 3.2667 - val_accuracy20: 0.4321 - 277s/epoch - 46ms/step
Epoch 41/50
6073/6073 - 268s - loss: 3.0440 - accuracy20: 0.4821 - val_loss: 3.2667 - val_accuracy20: 0.4327 - 268s/epoch - 44ms/step
Epoch 42/50
6073/6073 - 280s - loss: 3.0427 - accuracy20: 0.4825 - val_loss: 3.2620 - val_accuracy20: 0.4335 - 280s/epoch - 46ms/step
testing model: results/AAPL/W1/deepOF_L1/h20
Evaluating performance on  test set...
21353/21353 - 481s - 481s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1311885
{'0': {'precision': 0.5131804715284004, 'recall': 0.3264442482638807, 'f1-score': 0.3990468820242389, 'support': 2118230}, '1': {'precision': 0.24459299095363374, 'recall': 0.5240926173271722, 'f1-score': 0.3335287650186962, 'support': 1205390}, '2': {'precision': 0.4900684197950596, 'recall': 0.35131513605950176, 'f1-score': 0.40925081642200967, 'support': 2142592}, 'accuracy': 0.3797776229681542, 'macro avg': {'precision': 0.4159472940923646, 'recall': 0.40061733388351817, 'f1-score': 0.38060882115498157, 'support': 5466212}, 'weighted avg': {'precision': 0.44489326269759394, 'recall': 0.3797776229681542, 'f1-score': 0.3885986932514429, 'support': 5466212}}
[[691484 963804 462942]
 [253362 631736 320292]
 [402602 987265 752725]]
Evaluating performance on  train set...
6073/6073 - 137s - 137s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0582899
{'0': {'precision': 0.4567352149972679, 'recall': 0.35334035167586636, 'f1-score': 0.39843932622894457, 'support': 492044}, '1': {'precision': 0.4318506569513008, 'recall': 0.5948078857833542, 'f1-score': 0.500396510705789, 'support': 567553}, '2': {'precision': 0.4527869855678515, 'recall': 0.35876724395703863, 'f1-score': 0.4003309526386034, 'support': 494956}, 'accuracy': 0.44322580188645866, 'macro avg': {'precision': 0.4471242858388067, 'recall': 0.4356384938054197, 'f1-score': 0.43305559652444564, 'support': 1554553}, 'weighted avg': {'precision': 0.446393010248939, 'recall': 0.44322580188645866, 'f1-score': 0.43626523358791247, 'support': 1554553}}
[[173859 220521  97664]
 [113026 337585 116942]
 [ 93771 223611 177574]]
Evaluating performance on  val set...
1786/1786 - 41s - 41s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0693686
{'0': {'precision': 0.48279511246062046, 'recall': 0.38222537299004283, 'f1-score': 0.42666398089263613, 'support': 155165}, '1': {'precision': 0.38504199017588336, 'recall': 0.535120739369499, 'f1-score': 0.4478424258131398, 'support': 145313}, '2': {'precision': 0.46330354917407496, 'recall': 0.39141365800119965, 'f1-score': 0.4243352899059531, 'support': 156714}, 'accuracy': 0.43397084813382564, 'macro avg': {'precision': 0.4437135506035263, 'recall': 0.4362532567869139, 'f1-score': 0.4329472322039097, 'support': 457192}, 'weighted avg': {'precision': 0.44504423250766917, 'recall': 0.43397084813382564, 'f1-score': 0.43259707877590203, 'support': 457192}}
[[59308 61040 34817]
 [31313 77760 36240]
 [32222 63152 61340]]
training model: results/AAPL/W1/deepOF_L1/h30
Epoch 1/50
6073/6073 - 279s - loss: 3.1932 - accuracy30: 0.4340 - val_loss: 3.2845 - val_accuracy30: 0.3773 - 279s/epoch - 46ms/step
Epoch 2/50
6073/6073 - 273s - loss: 3.1815 - accuracy30: 0.4383 - val_loss: 3.2746 - val_accuracy30: 0.3901 - 273s/epoch - 45ms/step
Epoch 3/50
6073/6073 - 273s - loss: 3.1747 - accuracy30: 0.4405 - val_loss: 3.2731 - val_accuracy30: 0.3919 - 273s/epoch - 45ms/step
Epoch 4/50
6073/6073 - 254s - loss: 3.1673 - accuracy30: 0.4429 - val_loss: 3.2666 - val_accuracy30: 0.3956 - 254s/epoch - 42ms/step
Epoch 5/50
6073/6073 - 256s - loss: 3.1606 - accuracy30: 0.4449 - val_loss: 3.2647 - val_accuracy30: 0.3973 - 256s/epoch - 42ms/step
Epoch 6/50
6073/6073 - 261s - loss: 3.1544 - accuracy30: 0.4464 - val_loss: 3.2624 - val_accuracy30: 0.4000 - 261s/epoch - 43ms/step
Epoch 7/50
6073/6073 - 285s - loss: 3.1489 - accuracy30: 0.4480 - val_loss: 3.2583 - val_accuracy30: 0.4025 - 285s/epoch - 47ms/step
Epoch 8/50
6073/6073 - 278s - loss: 3.1446 - accuracy30: 0.4493 - val_loss: 3.2575 - val_accuracy30: 0.4038 - 278s/epoch - 46ms/step
Epoch 9/50
6073/6073 - 293s - loss: 3.1400 - accuracy30: 0.4511 - val_loss: 3.2533 - val_accuracy30: 0.4070 - 293s/epoch - 48ms/step
Epoch 10/50
6073/6073 - 274s - loss: 3.1368 - accuracy30: 0.4521 - val_loss: 3.2605 - val_accuracy30: 0.4062 - 274s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 275s - loss: 3.1338 - accuracy30: 0.4534 - val_loss: 3.2569 - val_accuracy30: 0.4077 - 275s/epoch - 45ms/step
Epoch 12/50
6073/6073 - 274s - loss: 3.1310 - accuracy30: 0.4543 - val_loss: 3.2525 - val_accuracy30: 0.4099 - 274s/epoch - 45ms/step
Epoch 13/50
6073/6073 - 265s - loss: 3.1281 - accuracy30: 0.4551 - val_loss: 3.2594 - val_accuracy30: 0.4083 - 265s/epoch - 44ms/step
Epoch 14/50
6073/6073 - 279s - loss: 3.1261 - accuracy30: 0.4559 - val_loss: 3.2579 - val_accuracy30: 0.4094 - 279s/epoch - 46ms/step
Epoch 15/50
6073/6073 - 264s - loss: 3.1234 - accuracy30: 0.4572 - val_loss: 3.2564 - val_accuracy30: 0.4101 - 264s/epoch - 44ms/step
Epoch 16/50
6073/6073 - 271s - loss: 3.1210 - accuracy30: 0.4578 - val_loss: 3.2633 - val_accuracy30: 0.4092 - 271s/epoch - 45ms/step
Epoch 17/50
6073/6073 - 304s - loss: 3.1189 - accuracy30: 0.4589 - val_loss: 3.2551 - val_accuracy30: 0.4110 - 304s/epoch - 50ms/step
Epoch 18/50
6073/6073 - 288s - loss: 3.1169 - accuracy30: 0.4596 - val_loss: 3.2510 - val_accuracy30: 0.4124 - 288s/epoch - 47ms/step
Epoch 19/50
6073/6073 - 285s - loss: 3.1149 - accuracy30: 0.4601 - val_loss: 3.2569 - val_accuracy30: 0.4119 - 285s/epoch - 47ms/step
Epoch 20/50
6073/6073 - 286s - loss: 3.1134 - accuracy30: 0.4609 - val_loss: 3.2511 - val_accuracy30: 0.4130 - 286s/epoch - 47ms/step
Epoch 21/50
6073/6073 - 280s - loss: 3.1117 - accuracy30: 0.4616 - val_loss: 3.2556 - val_accuracy30: 0.4116 - 280s/epoch - 46ms/step
Epoch 22/50
6073/6073 - 262s - loss: 3.1101 - accuracy30: 0.4621 - val_loss: 3.2559 - val_accuracy30: 0.4115 - 262s/epoch - 43ms/step
Epoch 23/50
6073/6073 - 283s - loss: 3.1080 - accuracy30: 0.4629 - val_loss: 3.2522 - val_accuracy30: 0.4127 - 283s/epoch - 47ms/step
Epoch 24/50
6073/6073 - 275s - loss: 3.1071 - accuracy30: 0.4630 - val_loss: 3.2553 - val_accuracy30: 0.4119 - 275s/epoch - 45ms/step
Epoch 25/50
6073/6073 - 271s - loss: 3.1048 - accuracy30: 0.4641 - val_loss: 3.2497 - val_accuracy30: 0.4139 - 271s/epoch - 45ms/step
Epoch 26/50
6073/6073 - 279s - loss: 3.1036 - accuracy30: 0.4643 - val_loss: 3.2523 - val_accuracy30: 0.4133 - 279s/epoch - 46ms/step
Epoch 27/50
6073/6073 - 255s - loss: 3.1024 - accuracy30: 0.4647 - val_loss: 3.2543 - val_accuracy30: 0.4133 - 255s/epoch - 42ms/step
Epoch 28/50
6073/6073 - 276s - loss: 3.1006 - accuracy30: 0.4656 - val_loss: 3.2496 - val_accuracy30: 0.4150 - 276s/epoch - 45ms/step
Epoch 29/50
6073/6073 - 275s - loss: 3.0994 - accuracy30: 0.4657 - val_loss: 3.2471 - val_accuracy30: 0.4157 - 275s/epoch - 45ms/step
Epoch 30/50
6073/6073 - 294s - loss: 3.0980 - accuracy30: 0.4663 - val_loss: 3.2524 - val_accuracy30: 0.4133 - 294s/epoch - 48ms/step
Epoch 31/50
6073/6073 - 281s - loss: 3.0964 - accuracy30: 0.4669 - val_loss: 3.2511 - val_accuracy30: 0.4148 - 281s/epoch - 46ms/step
Epoch 32/50
6073/6073 - 264s - loss: 3.0949 - accuracy30: 0.4674 - val_loss: 3.2560 - val_accuracy30: 0.4128 - 264s/epoch - 44ms/step
Epoch 33/50
6073/6073 - 268s - loss: 3.0938 - accuracy30: 0.4679 - val_loss: 3.2575 - val_accuracy30: 0.4136 - 268s/epoch - 44ms/step
Epoch 34/50
6073/6073 - 271s - loss: 3.0921 - accuracy30: 0.4683 - val_loss: 3.2578 - val_accuracy30: 0.4149 - 271s/epoch - 45ms/step
Epoch 35/50
6073/6073 - 269s - loss: 3.0914 - accuracy30: 0.4687 - val_loss: 3.2508 - val_accuracy30: 0.4159 - 269s/epoch - 44ms/step
Epoch 36/50
6073/6073 - 278s - loss: 3.0902 - accuracy30: 0.4691 - val_loss: 3.2527 - val_accuracy30: 0.4159 - 278s/epoch - 46ms/step
Epoch 37/50
6073/6073 - 274s - loss: 3.0890 - accuracy30: 0.4694 - val_loss: 3.2534 - val_accuracy30: 0.4146 - 274s/epoch - 45ms/step
Epoch 38/50
6073/6073 - 288s - loss: 3.0873 - accuracy30: 0.4699 - val_loss: 3.2544 - val_accuracy30: 0.4168 - 288s/epoch - 47ms/step
Epoch 39/50
6073/6073 - 289s - loss: 3.0865 - accuracy30: 0.4703 - val_loss: 3.2542 - val_accuracy30: 0.4159 - 289s/epoch - 48ms/step
testing model: results/AAPL/W1/deepOF_L1/h30
Evaluating performance on  test set...
21353/21353 - 509s - 509s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.135619
{'0': {'precision': 0.5158195594799382, 'recall': 0.2943202858039068, 'f1-score': 0.3747900095351799, 'support': 2161482}, '1': {'precision': 0.21703327787566445, 'recall': 0.5300505663053011, 'f1-score': 0.30796707154391634, 'support': 1125453}, '2': {'precision': 0.49414116451766343, 'recall': 0.3365478550913904, 'f1-score': 0.4003956838361679, 'support': 2179277}, 'accuracy': 0.3596907694030162, 'macro avg': {'precision': 0.40899800062442204, 'recall': 0.3869729024001994, 'f1-score': 0.3610509216384214, 'support': 5466212}, 'weighted avg': {'precision': 0.44565888065361825, 'recall': 0.3596907694030162, 'f1-score': 0.371240162043453, 'support': 5466212}}
[[ 636168 1070096  455218]
 [ 233301  596547  295605]
 [ 363846 1082000  733431]]
Evaluating performance on  train set...
6073/6073 - 138s - 138s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0754424
{'0': {'precision': 0.46854866584692795, 'recall': 0.3211447790525163, 'f1-score': 0.3810895449130221, 'support': 514964}, '1': {'precision': 0.3809524396315045, 'recall': 0.5939656050245637, 'f1-score': 0.46418803617720433, 'support': 520483}, '2': {'precision': 0.4581738570904868, 'recall': 0.344291917257747, 'f1-score': 0.3931521087567437, 'support': 519106}, 'accuracy': 0.4202179018663243, 'macro avg': {'precision': 0.43589165418963977, 'recall': 0.419800767111609, 'f1-score': 0.41280989661565676, 'support': 1554553}, 'weighted avg': {'precision': 0.43575597747695705, 'recall': 0.4202179018663243, 'f1-score': 0.412939923314604, 'support': 1554553}}
[[165378 249651  99935]
 [ 99914 309149 111420]
 [ 87666 252716 178724]]
Evaluating performance on  val set...
1786/1786 - 47s - 47s/epoch - 26ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0819424
{'0': {'precision': 0.4928124809767721, 'recall': 0.3513223642608275, 'f1-score': 0.4102094515604811, 'support': 161302}, '1': {'precision': 0.3400765131456096, 'recall': 0.5329441513907752, 'f1-score': 0.415206182553694, 'support': 133271}, '2': {'precision': 0.467116117227105, 'recall': 0.38303642255824966, 'f1-score': 0.4209185483516743, 'support': 162619}, 'accuracy': 0.4155453288771457, 'macro avg': {'precision': 0.4333350371164955, 'recall': 0.42243431273661747, 'f1-score': 0.41544472748861655, 'support': 457192}, 'weighted avg': {'precision': 0.4391501418600903, 'recall': 0.4155453288771457, 'f1-score': 0.4154751210106979, 'support': 457192}}
[[56669 67935 36698]
 [27884 71026 34361]
 [30438 69892 62289]]
training model: results/AAPL/W1/deepOF_L1/h50
Epoch 1/50
6073/6073 - 277s - loss: 3.2222 - accuracy50: 0.4176 - val_loss: 3.2698 - val_accuracy50: 0.3823 - 277s/epoch - 46ms/step
Epoch 2/50
6073/6073 - 283s - loss: 3.2146 - accuracy50: 0.4205 - val_loss: 3.2632 - val_accuracy50: 0.3892 - 283s/epoch - 47ms/step
Epoch 3/50
6073/6073 - 281s - loss: 3.2108 - accuracy50: 0.4221 - val_loss: 3.2607 - val_accuracy50: 0.3917 - 281s/epoch - 46ms/step
Epoch 4/50
6073/6073 - 269s - loss: 3.2075 - accuracy50: 0.4235 - val_loss: 3.2610 - val_accuracy50: 0.3914 - 269s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 301s - loss: 3.2042 - accuracy50: 0.4255 - val_loss: 3.2586 - val_accuracy50: 0.3928 - 301s/epoch - 50ms/step
Epoch 6/50
6073/6073 - 299s - loss: 3.2006 - accuracy50: 0.4272 - val_loss: 3.2586 - val_accuracy50: 0.3926 - 299s/epoch - 49ms/step
Epoch 7/50
6073/6073 - 265s - loss: 3.1973 - accuracy50: 0.4288 - val_loss: 3.2575 - val_accuracy50: 0.3943 - 265s/epoch - 44ms/step
Epoch 8/50
6073/6073 - 304s - loss: 3.1947 - accuracy50: 0.4296 - val_loss: 3.2569 - val_accuracy50: 0.3966 - 304s/epoch - 50ms/step
Epoch 9/50
6073/6073 - 285s - loss: 3.1917 - accuracy50: 0.4308 - val_loss: 3.2566 - val_accuracy50: 0.3971 - 285s/epoch - 47ms/step
Epoch 10/50
6073/6073 - 296s - loss: 3.1896 - accuracy50: 0.4316 - val_loss: 3.2524 - val_accuracy50: 0.3995 - 296s/epoch - 49ms/step
Epoch 11/50
6073/6073 - 266s - loss: 3.1873 - accuracy50: 0.4325 - val_loss: 3.2530 - val_accuracy50: 0.4000 - 266s/epoch - 44ms/step
Epoch 12/50
6073/6073 - 301s - loss: 3.1855 - accuracy50: 0.4331 - val_loss: 3.2526 - val_accuracy50: 0.4007 - 301s/epoch - 50ms/step
Epoch 13/50
6073/6073 - 293s - loss: 3.1832 - accuracy50: 0.4343 - val_loss: 3.2527 - val_accuracy50: 0.4010 - 293s/epoch - 48ms/step
Epoch 14/50
6073/6073 - 291s - loss: 3.1816 - accuracy50: 0.4348 - val_loss: 3.2519 - val_accuracy50: 0.4015 - 291s/epoch - 48ms/step
Epoch 15/50
6073/6073 - 288s - loss: 3.1800 - accuracy50: 0.4354 - val_loss: 3.2516 - val_accuracy50: 0.4011 - 288s/epoch - 47ms/step
Epoch 16/50
6073/6073 - 300s - loss: 3.1782 - accuracy50: 0.4362 - val_loss: 3.2509 - val_accuracy50: 0.4027 - 300s/epoch - 49ms/step
Epoch 17/50
6073/6073 - 269s - loss: 3.1766 - accuracy50: 0.4367 - val_loss: 3.2505 - val_accuracy50: 0.4031 - 269s/epoch - 44ms/step
Epoch 18/50
6073/6073 - 281s - loss: 3.1749 - accuracy50: 0.4377 - val_loss: 3.2519 - val_accuracy50: 0.4031 - 281s/epoch - 46ms/step
Epoch 19/50
6073/6073 - 275s - loss: 3.1736 - accuracy50: 0.4383 - val_loss: 3.2501 - val_accuracy50: 0.4042 - 275s/epoch - 45ms/step
Epoch 20/50
6073/6073 - 270s - loss: 3.1716 - accuracy50: 0.4391 - val_loss: 3.2521 - val_accuracy50: 0.4034 - 270s/epoch - 44ms/step
Epoch 21/50
6073/6073 - 247s - loss: 3.1703 - accuracy50: 0.4398 - val_loss: 3.2524 - val_accuracy50: 0.4038 - 247s/epoch - 41ms/step
Epoch 22/50
6073/6073 - 247s - loss: 3.1692 - accuracy50: 0.4402 - val_loss: 3.2503 - val_accuracy50: 0.4045 - 247s/epoch - 41ms/step
Epoch 23/50
6073/6073 - 255s - loss: 3.1675 - accuracy50: 0.4410 - val_loss: 3.2503 - val_accuracy50: 0.4047 - 255s/epoch - 42ms/step
Epoch 24/50
6073/6073 - 277s - loss: 3.1664 - accuracy50: 0.4417 - val_loss: 3.2525 - val_accuracy50: 0.4039 - 277s/epoch - 46ms/step
Epoch 25/50
6073/6073 - 284s - loss: 3.1650 - accuracy50: 0.4418 - val_loss: 3.2531 - val_accuracy50: 0.4039 - 284s/epoch - 47ms/step
Epoch 26/50
6073/6073 - 258s - loss: 3.1641 - accuracy50: 0.4424 - val_loss: 3.2512 - val_accuracy50: 0.4049 - 258s/epoch - 42ms/step
Epoch 27/50
6073/6073 - 254s - loss: 3.1625 - accuracy50: 0.4434 - val_loss: 3.2538 - val_accuracy50: 0.4029 - 254s/epoch - 42ms/step
Epoch 28/50
6073/6073 - 261s - loss: 3.1611 - accuracy50: 0.4433 - val_loss: 3.2520 - val_accuracy50: 0.4042 - 261s/epoch - 43ms/step
Epoch 29/50
6073/6073 - 248s - loss: 3.1605 - accuracy50: 0.4437 - val_loss: 3.2478 - val_accuracy50: 0.4055 - 248s/epoch - 41ms/step
Epoch 30/50
6073/6073 - 256s - loss: 3.1591 - accuracy50: 0.4447 - val_loss: 3.2514 - val_accuracy50: 0.4057 - 256s/epoch - 42ms/step
Epoch 31/50
6073/6073 - 252s - loss: 3.1576 - accuracy50: 0.4454 - val_loss: 3.2549 - val_accuracy50: 0.4031 - 252s/epoch - 42ms/step
Epoch 32/50
6073/6073 - 259s - loss: 3.1570 - accuracy50: 0.4458 - val_loss: 3.2522 - val_accuracy50: 0.4041 - 259s/epoch - 43ms/step
Epoch 33/50
6073/6073 - 275s - loss: 3.1561 - accuracy50: 0.4459 - val_loss: 3.2518 - val_accuracy50: 0.4043 - 275s/epoch - 45ms/step
Epoch 34/50
6073/6073 - 272s - loss: 3.1546 - accuracy50: 0.4461 - val_loss: 3.2539 - val_accuracy50: 0.4031 - 272s/epoch - 45ms/step
Epoch 35/50
6073/6073 - 262s - loss: 3.1532 - accuracy50: 0.4468 - val_loss: 3.2517 - val_accuracy50: 0.4049 - 262s/epoch - 43ms/step
Epoch 36/50
6073/6073 - 268s - loss: 3.1525 - accuracy50: 0.4474 - val_loss: 3.2525 - val_accuracy50: 0.4054 - 268s/epoch - 44ms/step
Epoch 37/50
6073/6073 - 254s - loss: 3.1507 - accuracy50: 0.4482 - val_loss: 3.2535 - val_accuracy50: 0.4066 - 254s/epoch - 42ms/step
Epoch 38/50
6073/6073 - 263s - loss: 3.1504 - accuracy50: 0.4482 - val_loss: 3.2538 - val_accuracy50: 0.4050 - 263s/epoch - 43ms/step
Epoch 39/50
6073/6073 - 248s - loss: 3.1492 - accuracy50: 0.4489 - val_loss: 3.2510 - val_accuracy50: 0.4067 - 248s/epoch - 41ms/step
testing model: results/AAPL/W1/deepOF_L1/h50
Evaluating performance on  test set...
21353/21353 - 565s - 565s/epoch - 26ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109587
{'0': {'precision': 0.47909379529576746, 'recall': 0.34196895422482104, 'f1-score': 0.3990808357791315, 'support': 2081958}, '1': {'precision': 0.23570233786036968, 'recall': 0.41125725461735174, 'f1-score': 0.29966105303148477, 'support': 1286939}, '2': {'precision': 0.4681404113971847, 'recall': 0.38719553333667095, 'f1-score': 0.42383785548444947, 'support': 2097315}, 'accuracy': 0.3756347174240589, 'macro avg': {'precision': 0.3943121815177739, 'recall': 0.38014058072628126, 'f1-score': 0.37419324809835525, 'support': 5466212}, 'weighted avg': {'precision': 0.41758819412411335, 'recall': 0.3756347174240589, 'f1-score': 0.3851728631270985, 'support': 5466212}}
[[711965 857118 512875]
 [347948 529263 409728]
 [426153 859091 812071]]
Evaluating performance on  train set...
6073/6073 - 153s - 153s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0770701
{'0': {'precision': 0.44580576993752297, 'recall': 0.37345129678339223, 'f1-score': 0.4064334618755295, 'support': 519709}, '1': {'precision': 0.35676675746008907, 'recall': 0.4498250464382911, 'f1-score': 0.3979277311435259, 'support': 509278}, '2': {'precision': 0.4414474842582733, 'recall': 0.40071846352313506, 'f1-score': 0.4200981008176398, 'support': 525566}, 'accuracy': 0.4076901848955938, 'macro avg': {'precision': 0.4146733372186285, 'recall': 0.40799826891493945, 'f1-score': 0.40815309794556504, 'support': 1554553}, 'weighted avg': {'precision': 0.4151627638979842, 'recall': 0.4076901848955938, 'f1-score': 0.40826671432463596, 'support': 1554553}}
[[194086 205719 119904]
 [133624 229086 146568]
 [107650 207312 210604]]
Evaluating performance on  val set...
1786/1786 - 52s - 52s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0844991
{'0': {'precision': 0.4646451862660433, 'recall': 0.3868126828300858, 'f1-score': 0.4221715661737848, 'support': 161352}, '1': {'precision': 0.3173141622693629, 'recall': 0.4048589093811894, 'f1-score': 0.35578027126922096, 'support': 132787}, '2': {'precision': 0.4484118191415873, 'recall': 0.4219916223559211, 'f1-score': 0.43480074186648304, 'support': 163053}, 'accuracy': 0.4046002554725367, 'macro avg': {'precision': 0.4101237225589978, 'recall': 0.4045544048557321, 'f1-score': 0.4042508597698296, 'support': 457192}, 'weighted avg': {'precision': 0.4160648438864935, 'recall': 0.4046002554725367, 'f1-score': 0.4073929263632221, 'support': 457192}}
[[62413 57357 41582]
 [35970 53760 43057]
 [35941 58305 68807]]
training model: results/AAPL/W1/deepOF_L1/h100
Epoch 1/50
6073/6073 - 278s - loss: 3.2353 - accuracy100: 0.4068 - val_loss: 3.3442 - val_accuracy100: 0.3228 - 278s/epoch - 46ms/step
Epoch 2/50
6073/6073 - 277s - loss: 3.2319 - accuracy100: 0.4086 - val_loss: 3.3421 - val_accuracy100: 0.3228 - 277s/epoch - 46ms/step
Epoch 3/50
6073/6073 - 276s - loss: 3.2304 - accuracy100: 0.4092 - val_loss: 3.3422 - val_accuracy100: 0.3230 - 276s/epoch - 46ms/step
Epoch 4/50
6073/6073 - 267s - loss: 3.2289 - accuracy100: 0.4096 - val_loss: 3.3400 - val_accuracy100: 0.3228 - 267s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 277s - loss: 3.2284 - accuracy100: 0.4102 - val_loss: 3.3389 - val_accuracy100: 0.3232 - 277s/epoch - 46ms/step
Epoch 6/50
6073/6073 - 289s - loss: 3.2268 - accuracy100: 0.4109 - val_loss: 3.3385 - val_accuracy100: 0.3255 - 289s/epoch - 48ms/step
Epoch 7/50
6073/6073 - 291s - loss: 3.2252 - accuracy100: 0.4115 - val_loss: 3.3385 - val_accuracy100: 0.3245 - 291s/epoch - 48ms/step
Epoch 8/50
6073/6073 - 271s - loss: 3.2239 - accuracy100: 0.4127 - val_loss: 3.3364 - val_accuracy100: 0.3255 - 271s/epoch - 45ms/step
Epoch 9/50
6073/6073 - 280s - loss: 3.2225 - accuracy100: 0.4135 - val_loss: 3.3374 - val_accuracy100: 0.3261 - 280s/epoch - 46ms/step
Epoch 10/50
6073/6073 - 295s - loss: 3.2214 - accuracy100: 0.4141 - val_loss: 3.3355 - val_accuracy100: 0.3263 - 295s/epoch - 49ms/step
Epoch 11/50
6073/6073 - 295s - loss: 3.2206 - accuracy100: 0.4148 - val_loss: 3.3345 - val_accuracy100: 0.3299 - 295s/epoch - 49ms/step
Epoch 12/50
6073/6073 - 295s - loss: 3.2194 - accuracy100: 0.4155 - val_loss: 3.3359 - val_accuracy100: 0.3298 - 295s/epoch - 49ms/step
Epoch 13/50
6073/6073 - 289s - loss: 3.2174 - accuracy100: 0.4161 - val_loss: 3.3394 - val_accuracy100: 0.3255 - 289s/epoch - 48ms/step
Epoch 14/50
6073/6073 - 298s - loss: 3.2196 - accuracy100: 0.4152 - val_loss: 3.3354 - val_accuracy100: 0.3298 - 298s/epoch - 49ms/step
Epoch 15/50
6073/6073 - 289s - loss: 3.2178 - accuracy100: 0.4161 - val_loss: 3.3363 - val_accuracy100: 0.3293 - 289s/epoch - 48ms/step
Epoch 16/50
6073/6073 - 304s - loss: 3.2162 - accuracy100: 0.4169 - val_loss: 3.3371 - val_accuracy100: 0.3298 - 304s/epoch - 50ms/step
Epoch 17/50
6073/6073 - 282s - loss: 3.2150 - accuracy100: 0.4176 - val_loss: 3.3371 - val_accuracy100: 0.3294 - 282s/epoch - 46ms/step
Epoch 18/50
6073/6073 - 292s - loss: 3.2139 - accuracy100: 0.4178 - val_loss: 3.3361 - val_accuracy100: 0.3314 - 292s/epoch - 48ms/step
Epoch 19/50
6073/6073 - 270s - loss: 3.2135 - accuracy100: 0.4180 - val_loss: 3.3369 - val_accuracy100: 0.3310 - 270s/epoch - 44ms/step
Epoch 20/50
6073/6073 - 281s - loss: 3.2121 - accuracy100: 0.4188 - val_loss: 3.3344 - val_accuracy100: 0.3351 - 281s/epoch - 46ms/step
Epoch 21/50
6073/6073 - 288s - loss: 3.2107 - accuracy100: 0.4197 - val_loss: 3.3388 - val_accuracy100: 0.3323 - 288s/epoch - 47ms/step
Epoch 22/50
6073/6073 - 276s - loss: 3.2100 - accuracy100: 0.4201 - val_loss: 3.3387 - val_accuracy100: 0.3348 - 276s/epoch - 45ms/step
Epoch 23/50
6073/6073 - 295s - loss: 3.2091 - accuracy100: 0.4205 - val_loss: 3.3397 - val_accuracy100: 0.3337 - 295s/epoch - 49ms/step
Epoch 24/50
6073/6073 - 272s - loss: 3.2078 - accuracy100: 0.4210 - val_loss: 3.3409 - val_accuracy100: 0.3339 - 272s/epoch - 45ms/step
Epoch 25/50
6073/6073 - 278s - loss: 3.2070 - accuracy100: 0.4214 - val_loss: 3.3421 - val_accuracy100: 0.3332 - 278s/epoch - 46ms/step
Epoch 26/50
6073/6073 - 301s - loss: 3.2056 - accuracy100: 0.4222 - val_loss: 3.3501 - val_accuracy100: 0.3300 - 301s/epoch - 50ms/step
Epoch 27/50
6073/6073 - 268s - loss: 3.2050 - accuracy100: 0.4228 - val_loss: 3.3439 - val_accuracy100: 0.3352 - 268s/epoch - 44ms/step
Epoch 28/50
6073/6073 - 291s - loss: 3.2032 - accuracy100: 0.4235 - val_loss: 3.3434 - val_accuracy100: 0.3358 - 291s/epoch - 48ms/step
Epoch 29/50
6073/6073 - 274s - loss: 3.2024 - accuracy100: 0.4241 - val_loss: 3.3457 - val_accuracy100: 0.3344 - 274s/epoch - 45ms/step
Epoch 30/50
6073/6073 - 270s - loss: 3.2012 - accuracy100: 0.4247 - val_loss: 3.3521 - val_accuracy100: 0.3346 - 270s/epoch - 44ms/step
testing model: results/AAPL/W1/deepOF_L1/h100
Evaluating performance on  test set...
21353/21353 - 498s - 498s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1282072
{'0': {'precision': 0.4582015483358698, 'recall': 0.10557889397895781, 'f1-score': 0.17161436992783316, 'support': 1967666}, '1': {'precision': 0.28181752262266063, 'recall': 0.895279691022389, 'f1-score': 0.4286910233981622, 'support': 1523735}, '2': {'precision': 0.46229915626760193, 'recall': 0.04031423766628806, 'f1-score': 0.07416132671206907, 'support': 1974811}, 'accuracy': 0.3021335433020161, 'macro avg': {'precision': 0.4007727424087108, 'recall': 0.3470576075558784, 'f1-score': 0.22482224001268813, 'support': 5466212}, 'weighted avg': {'precision': 0.41051395184256784, 'recall': 0.3021335433020161, 'f1-score': 0.20806838101442213, 'support': 5466212}}
[[ 207744 1711795   48127]
 [ 115095 1364169   44471]
 [ 130551 1764647   79613]]
Evaluating performance on  train set...
6073/6073 - 139s - 139s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1022015
{'0': {'precision': 0.4500629543885301, 'recall': 0.10698403687333577, 'f1-score': 0.17287429054612738, 'support': 517881}, '1': {'precision': 0.3371906348240873, 'recall': 0.9011718606879981, 'f1-score': 0.4907556759708483, 'support': 518577}, '2': {'precision': 0.4592682122843644, 'recall': 0.04033816192011118, 'f1-score': 0.0741625266146203, 'support': 518095}, 'accuracy': 0.3497024546606002, 'macro avg': {'precision': 0.41550726716566055, 'recall': 0.3494980198271483, 'f1-score': 0.24593083104386534, 'support': 1554553}, 'weighted avg': {'precision': 0.4154782276064727, 'recall': 0.3497024546606002, 'f1-score': 0.24601679766894746, 'support': 1554553}}
[[ 55405 451514  10962]
 [ 37606 467327  13644]
 [ 30094 467102  20899]]
Evaluating performance on  val set...
1786/1786 - 44s - 44s/epoch - 25ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1112801
{'0': {'precision': 0.4636066897735303, 'recall': 0.08961816171209264, 'f1-score': 0.1502014205737897, 'support': 153730}, '1': {'precision': 0.3230240137756044, 'recall': 0.919091355733275, 'f1-score': 0.478037042360745, 'support': 146548}, '2': {'precision': 0.4496478202931658, 'recall': 0.03010566297462304, 'f1-score': 0.05643292318719388, 'support': 156914}, 'accuracy': 0.3350714798159198, 'macro avg': {'precision': 0.4120928412807668, 'recall': 0.34627172680666357, 'f1-score': 0.22822379537390955, 'support': 457192}, 'weighted avg': {'precision': 0.4137535601304352, 'recall': 0.3350714798159198, 'f1-score': 0.2231031001804198, 'support': 457192}}
[[ 13777 137335   2618]
 [  8693 134691   3164]
 [  7247 144943   4724]]
training model: results/AAPL/W1/deepOF_L1/h200
Epoch 1/50
6073/6073 - 288s - loss: 3.2776 - accuracy200: 0.3765 - val_loss: 3.2975 - val_accuracy200: 0.3386 - 288s/epoch - 47ms/step
Epoch 2/50
6073/6073 - 283s - loss: 3.2715 - accuracy200: 0.3796 - val_loss: 3.2948 - val_accuracy200: 0.3395 - 283s/epoch - 47ms/step
Epoch 3/50
6073/6073 - 281s - loss: 3.2708 - accuracy200: 0.3799 - val_loss: 3.2940 - val_accuracy200: 0.3425 - 281s/epoch - 46ms/step
Epoch 4/50
6073/6073 - 273s - loss: 3.2697 - accuracy200: 0.3804 - val_loss: 3.2933 - val_accuracy200: 0.3459 - 273s/epoch - 45ms/step
Epoch 5/50
6073/6073 - 262s - loss: 3.2680 - accuracy200: 0.3821 - val_loss: 3.2938 - val_accuracy200: 0.3471 - 262s/epoch - 43ms/step
Epoch 6/50
6073/6073 - 296s - loss: 3.2669 - accuracy200: 0.3831 - val_loss: 3.2929 - val_accuracy200: 0.3489 - 296s/epoch - 49ms/step
Epoch 7/50
6073/6073 - 286s - loss: 3.2658 - accuracy200: 0.3837 - val_loss: 3.2930 - val_accuracy200: 0.3501 - 286s/epoch - 47ms/step
Epoch 8/50
6073/6073 - 283s - loss: 3.2647 - accuracy200: 0.3849 - val_loss: 3.2926 - val_accuracy200: 0.3511 - 283s/epoch - 47ms/step
Epoch 9/50
6073/6073 - 299s - loss: 3.2642 - accuracy200: 0.3855 - val_loss: 3.2932 - val_accuracy200: 0.3501 - 299s/epoch - 49ms/step
Epoch 10/50
6073/6073 - 294s - loss: 3.2631 - accuracy200: 0.3861 - val_loss: 3.2941 - val_accuracy200: 0.3488 - 294s/epoch - 48ms/step
Epoch 11/50
6073/6073 - 289s - loss: 3.2625 - accuracy200: 0.3866 - val_loss: 3.2948 - val_accuracy200: 0.3481 - 289s/epoch - 48ms/step
Epoch 12/50
6073/6073 - 291s - loss: 3.2618 - accuracy200: 0.3873 - val_loss: 3.2942 - val_accuracy200: 0.3499 - 291s/epoch - 48ms/step
Epoch 13/50
6073/6073 - 269s - loss: 3.2611 - accuracy200: 0.3879 - val_loss: 3.2941 - val_accuracy200: 0.3512 - 269s/epoch - 44ms/step
Epoch 14/50
6073/6073 - 297s - loss: 3.2604 - accuracy200: 0.3880 - val_loss: 3.2942 - val_accuracy200: 0.3525 - 297s/epoch - 49ms/step
Epoch 15/50
6073/6073 - 270s - loss: 3.2596 - accuracy200: 0.3888 - val_loss: 3.2945 - val_accuracy200: 0.3506 - 270s/epoch - 44ms/step
Epoch 16/50
6073/6073 - 301s - loss: 3.2590 - accuracy200: 0.3894 - val_loss: 3.2944 - val_accuracy200: 0.3521 - 301s/epoch - 50ms/step
Epoch 17/50
6073/6073 - 299s - loss: 3.2583 - accuracy200: 0.3902 - val_loss: 3.2955 - val_accuracy200: 0.3520 - 299s/epoch - 49ms/step
Epoch 18/50
6073/6073 - 306s - loss: 3.2579 - accuracy200: 0.3898 - val_loss: 3.2960 - val_accuracy200: 0.3525 - 306s/epoch - 50ms/step
testing model: results/AAPL/W1/deepOF_L1/h200
Evaluating performance on  test set...
21353/21353 - 507s - 507s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1026378
{'0': {'precision': 0.41184399985297476, 'recall': 0.2579607856483641, 'f1-score': 0.31722556800521917, 'support': 1998044}, '1': {'precision': 0.27355208486019666, 'recall': 0.49898098660140616, 'f1-score': 0.35337591161544685, 'support': 1466124}, '2': {'precision': 0.4122927970563452, 'recall': 0.31722329778965896, 'f1-score': 0.35856338650004715, 'support': 2002044}, 'accuracy': 0.3443115634739377, 'macro avg': {'precision': 0.36589629392317224, 'recall': 0.3580550233464764, 'f1-score': 0.34305495537357106, 'support': 5466212}, 'weighted avg': {'precision': 0.37491630955690736, 'recall': 0.3443115634739377, 'f1-score': 0.3420619662030682, 'support': 5466212}}
[[515417 981496 501131]
 [330384 731568 404172]
 [405685 961264 635095]]
Evaluating performance on  train set...
6073/6073 - 161s - 161s/epoch - 26ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094381
{'0': {'precision': 0.3844311918315713, 'recall': 0.2621980929857234, 'f1-score': 0.3117617087538714, 'support': 519241}, '1': {'precision': 0.33863173589887563, 'recall': 0.5253310832404455, 'f1-score': 0.4118088711654661, 'support': 513164}, '2': {'precision': 0.39046547289275824, 'recall': 0.30235297272037814, 'f1-score': 0.3408061584426014, 'support': 522148}, 'accuracy': 0.36254666132322283, 'macro avg': {'precision': 0.37117613354106843, 'recall': 0.36329404964884904, 'f1-score': 0.3547922461206463, 'support': 1554553}, 'weighted avg': {'precision': 0.3713394257633129, 'recall': 0.36254666132322283, 'f1-score': 0.3545432050218369, 'support': 1554553}}
[[136144 265908 117189]
 [114325 269581 129258]
 [103675 260600 157873]]
Evaluating performance on  val set...
1786/1786 - 43s - 43s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0982727
{'0': {'precision': 0.3855376467399237, 'recall': 0.2392118558001436, 'f1-score': 0.2952388936126047, 'support': 154591}, '1': {'precision': 0.3183114591151591, 'recall': 0.5446877343034073, 'f1-score': 0.40180882853770145, 'support': 144044}, '2': {'precision': 0.38923590239482875, 'recall': 0.28179140624507276, 'f1-score': 0.32691167970264795, 'support': 158557}, 'accuracy': 0.3502226635636669, 'macro avg': {'precision': 0.3643616694166372, 'recall': 0.35523033211620786, 'f1-score': 0.3413198006176514, 'support': 457192}, 'weighted avg': {'precision': 0.3656397818421416, 'recall': 0.3502226635636669, 'f1-score': 0.3397993882197492, 'support': 457192}}
[[36980 83300 34311]
 [29787 78459 35798]
 [29151 84726 44680]]
training model: results/AAPL/W1/deepOF_L1/h300
Epoch 1/50
6073/6073 - 268s - loss: 3.2627 - accuracy300: 0.3861 - val_loss: 3.2948 - val_accuracy300: 0.3441 - 268s/epoch - 44ms/step
Epoch 2/50
6073/6073 - 269s - loss: 3.2601 - accuracy300: 0.3878 - val_loss: 3.2926 - val_accuracy300: 0.3487 - 269s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 276s - loss: 3.2616 - accuracy300: 0.3874 - val_loss: 3.2930 - val_accuracy300: 0.3491 - 276s/epoch - 45ms/step
Epoch 4/50
6073/6073 - 266s - loss: 3.2622 - accuracy300: 0.3869 - val_loss: 3.2930 - val_accuracy300: 0.3489 - 266s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 268s - loss: 3.2621 - accuracy300: 0.3871 - val_loss: 3.2932 - val_accuracy300: 0.3494 - 268s/epoch - 44ms/step
Epoch 6/50
6073/6073 - 252s - loss: 3.2617 - accuracy300: 0.3875 - val_loss: 3.2929 - val_accuracy300: 0.3495 - 252s/epoch - 42ms/step
Epoch 7/50
6073/6073 - 270s - loss: 3.2613 - accuracy300: 0.3875 - val_loss: 3.2933 - val_accuracy300: 0.3498 - 270s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 300s - loss: 3.2605 - accuracy300: 0.3883 - val_loss: 3.2930 - val_accuracy300: 0.3499 - 300s/epoch - 49ms/step
Epoch 9/50
6073/6073 - 309s - loss: 3.2596 - accuracy300: 0.3886 - val_loss: 3.2929 - val_accuracy300: 0.3500 - 309s/epoch - 51ms/step
Epoch 10/50
6073/6073 - 298s - loss: 3.2591 - accuracy300: 0.3890 - val_loss: 3.2928 - val_accuracy300: 0.3501 - 298s/epoch - 49ms/step
Epoch 11/50
6073/6073 - 294s - loss: 3.2588 - accuracy300: 0.3890 - val_loss: 3.2927 - val_accuracy300: 0.3502 - 294s/epoch - 48ms/step
Epoch 12/50
6073/6073 - 283s - loss: 3.2581 - accuracy300: 0.3898 - val_loss: 3.2926 - val_accuracy300: 0.3502 - 283s/epoch - 47ms/step
Epoch 13/50
6073/6073 - 298s - loss: 3.2576 - accuracy300: 0.3900 - val_loss: 3.2928 - val_accuracy300: 0.3495 - 298s/epoch - 49ms/step
Epoch 14/50
6073/6073 - 285s - loss: 3.2572 - accuracy300: 0.3902 - val_loss: 3.2926 - val_accuracy300: 0.3503 - 285s/epoch - 47ms/step
Epoch 15/50
6073/6073 - 283s - loss: 3.2565 - accuracy300: 0.3905 - val_loss: 3.2926 - val_accuracy300: 0.3503 - 283s/epoch - 47ms/step
Epoch 16/50
6073/6073 - 289s - loss: 3.2560 - accuracy300: 0.3910 - val_loss: 3.2928 - val_accuracy300: 0.3500 - 289s/epoch - 48ms/step
Epoch 17/50
6073/6073 - 293s - loss: 3.2556 - accuracy300: 0.3915 - val_loss: 3.2921 - val_accuracy300: 0.3503 - 293s/epoch - 48ms/step
Epoch 18/50
6073/6073 - 299s - loss: 3.2549 - accuracy300: 0.3918 - val_loss: 3.2925 - val_accuracy300: 0.3504 - 299s/epoch - 49ms/step
Epoch 19/50
6073/6073 - 271s - loss: 3.2543 - accuracy300: 0.3923 - val_loss: 3.2926 - val_accuracy300: 0.3497 - 271s/epoch - 45ms/step
Epoch 20/50
6073/6073 - 283s - loss: 3.2538 - accuracy300: 0.3927 - val_loss: 3.2928 - val_accuracy300: 0.3501 - 283s/epoch - 47ms/step
Epoch 21/50
6073/6073 - 290s - loss: 3.2534 - accuracy300: 0.3932 - val_loss: 3.2918 - val_accuracy300: 0.3507 - 290s/epoch - 48ms/step
Epoch 22/50
6073/6073 - 294s - loss: 3.2528 - accuracy300: 0.3934 - val_loss: 3.2925 - val_accuracy300: 0.3506 - 294s/epoch - 48ms/step
Epoch 23/50
6073/6073 - 284s - loss: 3.2522 - accuracy300: 0.3938 - val_loss: 3.2922 - val_accuracy300: 0.3506 - 284s/epoch - 47ms/step
Epoch 24/50
6073/6073 - 288s - loss: 3.2514 - accuracy300: 0.3948 - val_loss: 3.2930 - val_accuracy300: 0.3501 - 288s/epoch - 48ms/step
Epoch 25/50
6073/6073 - 276s - loss: 3.2512 - accuracy300: 0.3949 - val_loss: 3.2926 - val_accuracy300: 0.3506 - 276s/epoch - 45ms/step
Epoch 26/50
6073/6073 - 283s - loss: 3.2507 - accuracy300: 0.3952 - val_loss: 3.2928 - val_accuracy300: 0.3508 - 283s/epoch - 47ms/step
Epoch 27/50
6073/6073 - 260s - loss: 3.2503 - accuracy300: 0.3954 - val_loss: 3.2930 - val_accuracy300: 0.3506 - 260s/epoch - 43ms/step
Epoch 28/50
6073/6073 - 267s - loss: 3.2497 - accuracy300: 0.3964 - val_loss: 3.2924 - val_accuracy300: 0.3506 - 267s/epoch - 44ms/step
Epoch 29/50
6073/6073 - 292s - loss: 3.2498 - accuracy300: 0.3963 - val_loss: 3.2946 - val_accuracy300: 0.3496 - 292s/epoch - 48ms/step
Epoch 30/50
6073/6073 - 254s - loss: 3.2485 - accuracy300: 0.3970 - val_loss: 3.2940 - val_accuracy300: 0.3505 - 254s/epoch - 42ms/step
Epoch 31/50
6073/6073 - 261s - loss: 3.2494 - accuracy300: 0.3970 - val_loss: 3.2931 - val_accuracy300: 0.3500 - 261s/epoch - 43ms/step
testing model: results/AAPL/W1/deepOF_L1/h300
Evaluating performance on  test set...
21353/21353 - 475s - 475s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0955379
{'0': {'precision': 0.37516530187170744, 'recall': 0.49450599675340023, 'f1-score': 0.4266473823906943, 'support': 1903530}, '1': {'precision': 0.30671345438197756, 'recall': 0.05970860421626228, 'f1-score': 0.09995813202706613, 'support': 1645391}, '2': {'precision': 0.3767516138549954, 'recall': 0.5181472191753886, 'f1-score': 0.43627903810704316, 'support': 1917291}, 'accuracy': 0.3719193474384089, 'macro avg': {'precision': 0.3528767900362268, 'recall': 0.35745394004835035, 'f1-score': 0.32096151750826785, 'support': 5466212}, 'weighted avg': {'precision': 0.3551169334395603, 'recall': 0.3719193474384089, 'f1-score': 0.3316885945637666, 'support': 5466212}}
[[941307 114401 847822]
 [751554  98244 795593]
 [816185 107667 993439]]
Evaluating performance on  train set...
6073/6073 - 127s - 127s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952325
{'0': {'precision': 0.36489339841094054, 'recall': 0.5092200356060241, 'f1-score': 0.42514168550718345, 'support': 519575}, '1': {'precision': 0.3454146018498084, 'recall': 0.06728835717761367, 'f1-score': 0.11263491378111869, 'support': 511723}, '2': {'precision': 0.3646640649836116, 'recall': 0.5085971467066727, 'f1-score': 0.42476890184583244, 'support': 523255}, 'accuracy': 0.363536656517983, 'macro avg': {'precision': 0.3583240217481201, 'recall': 0.36170184649677023, 'f1-score': 0.32084850037804485, 'support': 1554553}, 'weighted avg': {'precision': 0.3584042352398108, 'recall': 0.363536656517983, 'f1-score': 0.3221461854099225, 'support': 1554553}}
[[264578  33253 221744]
 [235376  34433 241914]
 [225129  32000 266126]]
Evaluating performance on  val set...
1786/1786 - 38s - 38s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968051
{'0': {'precision': 0.3466024941912846, 'recall': 0.49756645451141895, 'f1-score': 0.408585922106234, 'support': 146905}, '1': {'precision': 0.3493213239693887, 'recall': 0.0693011777201587, 'f1-score': 0.11565732399065733, 'support': 160055}, '2': {'precision': 0.3538259325375555, 'recall': 0.5053051280685873, 'f1-score': 0.4162113706580112, 'support': 150232}, 'accuracy': 0.3501811055311554, 'macro avg': {'precision': 0.34991658356607624, 'recall': 0.35739092010005497, 'f1-score': 0.3134848722516342, 'support': 457192}, 'weighted avg': {'precision': 0.34992791084286956, 'recall': 0.3501811055311554, 'f1-score': 0.3085423946942101, 'support': 457192}}
[[73095 10427 63383]
 [73710 11092 75253]
 [64085 10234 75913]]
training model: results/AAPL/W1/deepOF_L1/h500
Epoch 1/50
6073/6073 - 240s - loss: 3.2737 - accuracy500: 0.3800 - val_loss: 3.3463 - val_accuracy500: 0.3118 - 240s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 203s - loss: 3.2766 - accuracy500: 0.3733 - val_loss: 3.3389 - val_accuracy500: 0.3112 - 203s/epoch - 34ms/step
Epoch 3/50
6073/6073 - 216s - loss: 3.2767 - accuracy500: 0.3725 - val_loss: 3.3354 - val_accuracy500: 0.3112 - 216s/epoch - 36ms/step
Epoch 4/50
6073/6073 - 227s - loss: 3.2754 - accuracy500: 0.3738 - val_loss: 3.3344 - val_accuracy500: 0.3113 - 227s/epoch - 37ms/step
Epoch 5/50
6073/6073 - 214s - loss: 3.2737 - accuracy500: 0.3754 - val_loss: 3.3355 - val_accuracy500: 0.3113 - 214s/epoch - 35ms/step
Epoch 6/50
6073/6073 - 219s - loss: 3.2720 - accuracy500: 0.3766 - val_loss: 3.3356 - val_accuracy500: 0.3112 - 219s/epoch - 36ms/step
Epoch 7/50
6073/6073 - 219s - loss: 3.2705 - accuracy500: 0.3781 - val_loss: 3.3369 - val_accuracy500: 0.3113 - 219s/epoch - 36ms/step
Epoch 8/50
6073/6073 - 220s - loss: 3.2690 - accuracy500: 0.3797 - val_loss: 3.3365 - val_accuracy500: 0.3115 - 220s/epoch - 36ms/step
Epoch 9/50
6073/6073 - 218s - loss: 3.2679 - accuracy500: 0.3806 - val_loss: 3.3377 - val_accuracy500: 0.3114 - 218s/epoch - 36ms/step
Epoch 10/50
6073/6073 - 213s - loss: 3.2668 - accuracy500: 0.3818 - val_loss: 3.3398 - val_accuracy500: 0.3119 - 213s/epoch - 35ms/step
Epoch 11/50
6073/6073 - 212s - loss: 3.2655 - accuracy500: 0.3828 - val_loss: 3.3390 - val_accuracy500: 0.3117 - 212s/epoch - 35ms/step
Epoch 12/50
6073/6073 - 237s - loss: 3.2644 - accuracy500: 0.3840 - val_loss: 3.3397 - val_accuracy500: 0.3117 - 237s/epoch - 39ms/step
Epoch 13/50
6073/6073 - 208s - loss: 3.2633 - accuracy500: 0.3850 - val_loss: 3.3415 - val_accuracy500: 0.3119 - 208s/epoch - 34ms/step
Epoch 14/50
6073/6073 - 209s - loss: 3.2624 - accuracy500: 0.3859 - val_loss: 3.3401 - val_accuracy500: 0.3121 - 209s/epoch - 34ms/step
testing model: results/AAPL/W1/deepOF_L1/h500
Evaluating performance on  test set...
21353/21353 - 354s - 354s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1334655
{'0': {'precision': 0.4168693009118541, 'recall': 0.0013322932735460858, 'f1-score': 0.002656097792427362, 'support': 2058856}, '1': {'precision': 0.23942918845533706, 'recall': 0.998193805302297, 'f1-score': 0.38621895994197547, 'support': 1308829}, '2': {'precision': 0.41114754098360656, 'recall': 0.0005975620042058072, 'f1-score': 0.0011933895355725724, 'support': 2098527}, 'accuracy': 0.23973859777118048, 'macro avg': {'precision': 0.35581534345026594, 'recall': 0.333374553526683, 'f1-score': 0.13002281575665847, 'support': 5466212}, 'weighted avg': {'precision': 0.3721864322921781, 'recall': 0.23973859777118048, 'f1-score': 0.09393478667866123, 'support': 5466212}}
[[   2743 2055105    1008]
 [   1576 1306465     788]
 [   2261 2095012    1254]]
Evaluating performance on  train set...
6073/6073 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1077032
{'0': {'precision': 0.36342155009451793, 'recall': 0.0014911799324799932, 'f1-score': 0.0029701727450923594, 'support': 515699}, '1': {'precision': 0.3303976712376449, 'recall': 0.9978935277569575, 'f1-score': 0.49642984605118456, 'support': 513655}, '2': {'precision': 0.36113744075829385, 'recall': 0.0007254393096711913, 'f1-score': 0.001447969991677023, 'support': 525199}, 'accuracy': 0.33046348371525447, 'macro avg': {'precision': 0.3516522206968189, 'recall': 0.3333700489997029, 'f1-score': 0.16694932959598466, 'support': 1554553}, 'weighted avg': {'precision': 0.3517381321386793, 'recall': 0.33046348371525447, 'f1-score': 0.16550472070077468, 'support': 1554553}}
[[   769 514619    311]
 [   719 512573    363]
 [   628 524190    381]]
Evaluating performance on  val set...
1786/1786 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126559
{'0': {'precision': 0.37961595273264404, 'recall': 0.0016427603487509908, 'f1-score': 0.003271364107916829, 'support': 156444}, '1': {'precision': 0.31109966238435566, 'recall': 0.9977851216425256, 'f1-score': 0.47431312253492874, 'support': 142220}, '2': {'precision': 0.36533333333333334, 'recall': 0.0008642006459426726, 'f1-score': 0.0017243223853545874, 'support': 158528}, 'accuracy': 0.3112456035976133, 'macro avg': {'precision': 0.35201631615011103, 'recall': 0.3334306942124064, 'f1-score': 0.15976960300940005, 'support': 457192}, 'weighted avg': {'precision': 0.35335000341273576, 'recall': 0.3112456035976133, 'f1-score': 0.1492632219122863, 'support': 457192}}
[[   257 156062    125]
 [   202 141905    113]
 [   218 158173    137]]
training model: results/AAPL/W1/deepOF_L1/h1000
Epoch 1/50
6073/6073 - 232s - loss: 3.2805 - accuracy1000: 0.3752 - val_loss: 3.3499 - val_accuracy1000: 0.3073 - 232s/epoch - 38ms/step
Epoch 2/50
6073/6073 - 233s - loss: 3.2817 - accuracy1000: 0.3671 - val_loss: 3.3479 - val_accuracy1000: 0.3073 - 233s/epoch - 38ms/step
Epoch 3/50
6073/6073 - 215s - loss: 3.2824 - accuracy1000: 0.3652 - val_loss: 3.3419 - val_accuracy1000: 0.3072 - 215s/epoch - 35ms/step
Epoch 4/50
6073/6073 - 208s - loss: 3.2824 - accuracy1000: 0.3651 - val_loss: 3.3423 - val_accuracy1000: 0.3071 - 208s/epoch - 34ms/step
Epoch 5/50
6073/6073 - 221s - loss: 3.2811 - accuracy1000: 0.3661 - val_loss: 3.3438 - val_accuracy1000: 0.3073 - 221s/epoch - 36ms/step
Epoch 6/50
6073/6073 - 220s - loss: 3.2791 - accuracy1000: 0.3687 - val_loss: 3.3466 - val_accuracy1000: 0.3072 - 220s/epoch - 36ms/step
Epoch 7/50
6073/6073 - 214s - loss: 3.2773 - accuracy1000: 0.3701 - val_loss: 3.3474 - val_accuracy1000: 0.3073 - 214s/epoch - 35ms/step
Epoch 8/50
6073/6073 - 208s - loss: 3.2760 - accuracy1000: 0.3721 - val_loss: 3.3472 - val_accuracy1000: 0.3073 - 208s/epoch - 34ms/step
Epoch 9/50
6073/6073 - 205s - loss: 3.2753 - accuracy1000: 0.3729 - val_loss: 3.3476 - val_accuracy1000: 0.3074 - 205s/epoch - 34ms/step
Epoch 10/50
6073/6073 - 215s - loss: 3.2738 - accuracy1000: 0.3741 - val_loss: 3.3456 - val_accuracy1000: 0.3073 - 215s/epoch - 35ms/step
Epoch 11/50
6073/6073 - 224s - loss: 3.2729 - accuracy1000: 0.3752 - val_loss: 3.3462 - val_accuracy1000: 0.3073 - 224s/epoch - 37ms/step
Epoch 12/50
6073/6073 - 228s - loss: 3.2718 - accuracy1000: 0.3764 - val_loss: 3.3461 - val_accuracy1000: 0.3073 - 228s/epoch - 38ms/step
Epoch 13/50
6073/6073 - 208s - loss: 3.2709 - accuracy1000: 0.3771 - val_loss: 3.3472 - val_accuracy1000: 0.3073 - 208s/epoch - 34ms/step
testing model: results/AAPL/W1/deepOF_L1/h1000
Evaluating performance on  test set...
21353/21353 - 346s - 346s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1338754
{'0': {'precision': 0.3667676606601818, 'recall': 0.0011248610429809404, 'f1-score': 0.0022428433793213742, 'support': 2044697}, '1': {'precision': 0.24470759117255678, 'recall': 0.9986895907307045, 'f1-score': 0.393095509035553, 'support': 1337750}, '2': {'precision': 0.4308510638297872, 'recall': 7.774389146568831e-05, 'f1-score': 0.00015545973137134198, 'support': 2083765}, 'accuracy': 0.24486042619642268, 'macro avg': {'precision': 0.3474421052208419, 'recall': 0.33329739855505036, 'f1-score': 0.13183127071541523, 'support': 5466212}, 'weighted avg': {'precision': 0.3613249326153571, 'recall': 0.24486042619642268, 'f1-score': 0.09710076994610169, 'support': 5466212}}
[[   2300 2042268     129]
 [   1668 1335997      85]
 [   2303 2081300     162]]
Evaluating performance on  train set...
6073/6073 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093831
{'0': {'precision': 0.3504117108874657, 'recall': 0.0014975942692580652, 'f1-score': 0.0029824421373130378, 'support': 511487}, '1': {'precision': 0.3301169705547549, 'recall': 0.9985307442735076, 'f1-score': 0.49619164000588734, 'support': 513185}, '2': {'precision': 0.3645833333333333, 'recall': 6.605256651965253e-05, 'f1-score': 0.00013208120352392654, 'support': 529881}, 'accuracy': 0.33014763729509383, 'macro avg': {'precision': 0.3483706715918513, 'recall': 0.33336479703642846, 'f1-score': 0.16643538778224143, 'support': 1554553}, 'weighted avg': {'precision': 0.3485425672529911, 'recall': 0.33014763729509383, 'f1-score': 0.16482781511991781, 'support': 1554553}}
[[   766 510688     33]
 [   726 512431     28]
 [   694 529152     35]]
Evaluating performance on  val set...
1786/1786 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1154578
{'0': {'precision': 0.37676609105180536, 'recall': 0.0015207872608720447, 'f1-score': 0.0030293467970968755, 'support': 157813}, '1': {'precision': 0.30715210405609356, 'recall': 0.9985899444523572, 'f1-score': 0.46980029919104505, 'support': 140420}, '2': {'precision': 0.34375, 'recall': 6.92002340226096e-05, 'f1-score': 0.00013837261228623004, 'support': 158959}, 'accuracy': 0.30725165794677073, 'macro avg': {'precision': 0.3425560650359663, 'recall': 0.3333933106490839, 'f1-score': 0.15765600620014272, 'support': 457192}, 'weighted avg': {'precision': 0.34390593411239745, 'recall': 0.30725165794677073, 'f1-score': 0.1453862357402868, 'support': 457192}}
[[   240 157564      9]
 [   186 140222     12]
 [   211 158737     11]]
training model: results/AAPL/W1/deepLOB_L2/h10
Epoch 1/50
6073/6073 - 371s - loss: 3.0092 - accuracy10: 0.4559 - val_loss: 3.4302 - val_accuracy10: 0.4691 - 371s/epoch - 61ms/step
Epoch 2/50
6073/6073 - 356s - loss: 2.8910 - accuracy10: 0.4972 - val_loss: 3.2441 - val_accuracy10: 0.4709 - 356s/epoch - 59ms/step
Epoch 3/50
6073/6073 - 387s - loss: 2.8295 - accuracy10: 0.5187 - val_loss: 3.3423 - val_accuracy10: 0.4953 - 387s/epoch - 64ms/step
Epoch 4/50
6073/6073 - 401s - loss: 2.7906 - accuracy10: 0.5296 - val_loss: 3.2146 - val_accuracy10: 0.4883 - 401s/epoch - 66ms/step
Epoch 5/50
6073/6073 - 384s - loss: 2.7677 - accuracy10: 0.5348 - val_loss: 3.2555 - val_accuracy10: 0.4762 - 384s/epoch - 63ms/step
Epoch 6/50
6073/6073 - 373s - loss: 2.7513 - accuracy10: 0.5384 - val_loss: 3.2205 - val_accuracy10: 0.4749 - 373s/epoch - 61ms/step
Epoch 7/50
6073/6073 - 374s - loss: 2.7388 - accuracy10: 0.5411 - val_loss: 3.2743 - val_accuracy10: 0.4650 - 374s/epoch - 62ms/step
Epoch 8/50
6073/6073 - 384s - loss: 2.7285 - accuracy10: 0.5433 - val_loss: 3.2911 - val_accuracy10: 0.4557 - 384s/epoch - 63ms/step
Epoch 9/50
6073/6073 - 394s - loss: 2.7209 - accuracy10: 0.5451 - val_loss: 3.2714 - val_accuracy10: 0.4624 - 394s/epoch - 65ms/step
Epoch 10/50
6073/6073 - 379s - loss: 2.7137 - accuracy10: 0.5464 - val_loss: 3.1302 - val_accuracy10: 0.4847 - 379s/epoch - 62ms/step
Epoch 11/50
6073/6073 - 369s - loss: 2.7080 - accuracy10: 0.5476 - val_loss: 3.2041 - val_accuracy10: 0.4627 - 369s/epoch - 61ms/step
Epoch 12/50
6073/6073 - 361s - loss: 2.7030 - accuracy10: 0.5483 - val_loss: 3.1605 - val_accuracy10: 0.4690 - 361s/epoch - 59ms/step
Epoch 13/50
6073/6073 - 382s - loss: 2.6986 - accuracy10: 0.5495 - val_loss: 3.1019 - val_accuracy10: 0.4874 - 382s/epoch - 63ms/step
Epoch 14/50
6073/6073 - 376s - loss: 2.6949 - accuracy10: 0.5501 - val_loss: 3.1572 - val_accuracy10: 0.4796 - 376s/epoch - 62ms/step
Epoch 15/50
6073/6073 - 379s - loss: 2.6909 - accuracy10: 0.5512 - val_loss: 3.0993 - val_accuracy10: 0.4861 - 379s/epoch - 62ms/step
Epoch 16/50
6073/6073 - 396s - loss: 2.6877 - accuracy10: 0.5516 - val_loss: 3.1256 - val_accuracy10: 0.4798 - 396s/epoch - 65ms/step
Epoch 17/50
6073/6073 - 372s - loss: 2.6848 - accuracy10: 0.5523 - val_loss: 3.1055 - val_accuracy10: 0.4868 - 372s/epoch - 61ms/step
Epoch 18/50
6073/6073 - 374s - loss: 2.6819 - accuracy10: 0.5528 - val_loss: 3.1046 - val_accuracy10: 0.4885 - 374s/epoch - 62ms/step
Epoch 19/50
6073/6073 - 369s - loss: 2.6792 - accuracy10: 0.5535 - val_loss: 3.1186 - val_accuracy10: 0.4751 - 369s/epoch - 61ms/step
Epoch 20/50
6073/6073 - 373s - loss: 2.6764 - accuracy10: 0.5540 - val_loss: 3.1543 - val_accuracy10: 0.4710 - 373s/epoch - 61ms/step
Epoch 21/50
6073/6073 - 370s - loss: 2.6740 - accuracy10: 0.5542 - val_loss: 3.1875 - val_accuracy10: 0.4631 - 370s/epoch - 61ms/step
Epoch 22/50
6073/6073 - 357s - loss: 2.6712 - accuracy10: 0.5550 - val_loss: 3.1941 - val_accuracy10: 0.4683 - 357s/epoch - 59ms/step
Epoch 23/50
6073/6073 - 372s - loss: 2.6693 - accuracy10: 0.5556 - val_loss: 3.1652 - val_accuracy10: 0.4807 - 372s/epoch - 61ms/step
Epoch 24/50
6073/6073 - 383s - loss: 2.6675 - accuracy10: 0.5557 - val_loss: 3.1810 - val_accuracy10: 0.4605 - 383s/epoch - 63ms/step
Epoch 25/50
6073/6073 - 368s - loss: 2.6652 - accuracy10: 0.5559 - val_loss: 3.1891 - val_accuracy10: 0.4631 - 368s/epoch - 61ms/step
testing model: results/AAPL/W1/deepLOB_L2/h10
Evaluating performance on  test set...
21353/21353 - 531s - 531s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0199623
{'0': {'precision': 0.45917170956751696, 'recall': 0.658770051017554, 'f1-score': 0.5411526453387058, 'support': 1805457}, '1': {'precision': 0.5532236499122726, 'recall': 0.2813839260677741, 'f1-score': 0.3730333802040175, 'support': 1836601}, '2': {'precision': 0.4967429687624723, 'recall': 0.5287779190300845, 'f1-score': 0.5122600942442799, 'support': 1824159}, 'accuracy': 0.4885912871735608, 'macro avg': {'precision': 0.5030461094140873, 'recall': 0.48964396537180427, 'f1-score': 0.475482039929001, 'support': 5466217}, 'weighted avg': {'precision': 0.5033104326169182, 'recall': 0.4885912871735608, 'f1-score': 0.47502416606730286, 'support': 5466217}}
[[1189381  166585  449491]
 [ 792078  516790  527733]
 [ 608816  250768  964575]]
Evaluating performance on  train set...
6073/6073 - 140s - 140s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9667239
{'0': {'precision': 0.43157705088681586, 'recall': 0.6029063692502472, 'f1-score': 0.5030540803977782, 'support': 393343}, '1': {'precision': 0.6860534164676033, 'recall': 0.398446226017027, 'f1-score': 0.5041133882005466, 'support': 765491}, '2': {'precision': 0.4278151863231028, 'recall': 0.6059360153643991, 'f1-score': 0.5015300178414931, 'support': 395720}, 'accuracy': 0.5029976443404346, 'macro avg': {'precision': 0.5151485512258407, 'recall': 0.5357628702105578, 'f1-score': 0.502899162146606, 'support': 1554554}, 'weighted avg': {'precision': 0.5559282940856047, 'recall': 0.5029976443404346, 'f1-score': 0.5031877448150168, 'support': 1554554}}
[[237149  68766  87428]
 [227215 305007 233269]
 [ 85130  70809 239781]]
Evaluating performance on  val set...
1786/1786 - 43s - 43s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0032339
{'0': {'precision': 0.4294196607380625, 'recall': 0.6253951237200356, 'f1-score': 0.5092021192954082, 'support': 126859}, '1': {'precision': 0.5981403007848203, 'recall': 0.3902518357892662, 'f1-score': 0.47233348344900195, 'support': 202910}, '2': {'precision': 0.4547810813126553, 'recall': 0.4998508915118031, 'f1-score': 0.4762520749525191, 'support': 127424}, 'accuracy': 0.4860441870282353, 'macro avg': {'precision': 0.4941136809451794, 'recall': 0.5051659503403684, 'f1-score': 0.4859292258989764, 'support': 457193}, 'weighted avg': {'precision': 0.5113692066129655, 'recall': 0.4860441870282353, 'f1-score': 0.483655705964621, 'support': 457193}}
[[79337 24506 23016]
 [70381 79186 53343]
 [35036 28695 63693]]
training model: results/AAPL/W1/deepLOB_L2/h20
Epoch 1/50
6073/6073 - 377s - loss: 3.0836 - accuracy20: 0.4626 - val_loss: 3.3967 - val_accuracy20: 0.4039 - 377s/epoch - 62ms/step
Epoch 2/50
6073/6073 - 375s - loss: 2.9902 - accuracy20: 0.4957 - val_loss: 3.2542 - val_accuracy20: 0.4495 - 375s/epoch - 62ms/step
Epoch 3/50
6073/6073 - 373s - loss: 2.9401 - accuracy20: 0.5108 - val_loss: 3.2195 - val_accuracy20: 0.4537 - 373s/epoch - 61ms/step
Epoch 4/50
6073/6073 - 380s - loss: 2.9026 - accuracy20: 0.5204 - val_loss: 3.2364 - val_accuracy20: 0.4517 - 380s/epoch - 63ms/step
Epoch 5/50
6073/6073 - 370s - loss: 2.8789 - accuracy20: 0.5262 - val_loss: 3.2590 - val_accuracy20: 0.4472 - 370s/epoch - 61ms/step
Epoch 6/50
6073/6073 - 342s - loss: 2.8641 - accuracy20: 0.5295 - val_loss: 3.2647 - val_accuracy20: 0.4504 - 342s/epoch - 56ms/step
Epoch 7/50
6073/6073 - 355s - loss: 2.8533 - accuracy20: 0.5321 - val_loss: 3.2484 - val_accuracy20: 0.4569 - 355s/epoch - 58ms/step
Epoch 8/50
6073/6073 - 356s - loss: 2.8456 - accuracy20: 0.5335 - val_loss: 3.2687 - val_accuracy20: 0.4529 - 356s/epoch - 59ms/step
Epoch 9/50
6073/6073 - 369s - loss: 2.8389 - accuracy20: 0.5352 - val_loss: 3.2855 - val_accuracy20: 0.4517 - 369s/epoch - 61ms/step
Epoch 10/50
6073/6073 - 366s - loss: 2.8337 - accuracy20: 0.5365 - val_loss: 3.3699 - val_accuracy20: 0.4512 - 366s/epoch - 60ms/step
Epoch 11/50
6073/6073 - 359s - loss: 2.8291 - accuracy20: 0.5377 - val_loss: 3.3675 - val_accuracy20: 0.4553 - 359s/epoch - 59ms/step
Epoch 12/50
6073/6073 - 356s - loss: 2.8248 - accuracy20: 0.5381 - val_loss: 3.3562 - val_accuracy20: 0.4571 - 356s/epoch - 59ms/step
Epoch 13/50
6073/6073 - 370s - loss: 2.8212 - accuracy20: 0.5392 - val_loss: 3.4023 - val_accuracy20: 0.4533 - 370s/epoch - 61ms/step
testing model: results/AAPL/W1/deepLOB_L2/h20
Evaluating performance on  test set...
21353/21353 - 495s - 495s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0758331
{'0': {'precision': 0.49668022358308145, 'recall': 0.6302041656457676, 'f1-score': 0.5555316035749301, 'support': 2118231}, '1': {'precision': 0.3246325493130601, 'recall': 0.4149690847202277, 'f1-score': 0.3642838675847805, 'support': 1205391}, '2': {'precision': 0.5422418856653015, 'recall': 0.31323791943881135, 'f1-score': 0.39708878943718806, 'support': 2142595}, 'accuracy': 0.45849990953524167, 'macro avg': {'precision': 0.45451821952048105, 'recall': 0.4528037232682689, 'f1-score': 0.43896808686563293, 'support': 5466217}, 'weighted avg': {'precision': 0.47659969462366386, 'recall': 0.45849990953524167, 'f1-score': 0.4512534380556399, 'support': 5466217}}
[[1334918  411448  371865]
 [ 510481  500200  194710]
 [ 842282  629171  671142]]
Evaluating performance on  train set...
6073/6073 - 133s - 133s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0255778
{'0': {'precision': 0.49057001415035506, 'recall': 0.46359416661247316, 'f1-score': 0.47670076378948245, 'support': 492064}, '1': {'precision': 0.4744428111198475, 'recall': 0.5136608458409413, 'f1-score': 0.49327354260089684, 'support': 567388}, '2': {'precision': 0.4804538157089082, 'recall': 0.4611978945752592, 'f1-score': 0.4706289721041963, 'support': 495102}, 'accuracy': 0.48110454831417887, 'macro avg': {'precision': 0.4818222136597036, 'recall': 0.47948430234289124, 'f1-score': 0.48020109283152523, 'support': 1554554}, 'weighted avg': {'precision': 0.48146197959264214, 'recall': 0.48110454831417887, 'f1-score': 0.4808157958934057, 'support': 1554554}}
[[228118 156497 107449]
 [136473 291445 139470]
 [100415 166347 228340]]
Evaluating performance on  val set...
1786/1786 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0582255
{'0': {'precision': 0.48188760416493864, 'recall': 0.5613992140694454, 'f1-score': 0.5186135155159742, 'support': 155230}, '1': {'precision': 0.39949388211670966, 'recall': 0.6000605968792607, 'f1-score': 0.47965477098028636, 'support': 145222}, '2': {'precision': 0.5716518662292379, 'recall': 0.2123311705297274, 'f1-score': 0.3096483066617045, 'support': 156741}, 'accuracy': 0.45400738856456685, 'macro avg': {'precision': 0.4843444508369621, 'recall': 0.4579303271594779, 'f1-score': 0.43597219771932166, 'support': 457193}, 'weighted avg': {'precision': 0.486490384821975, 'recall': 0.45400738856456685, 'f1-score': 0.4345984877268595, 'support': 457193}}
[[87146 55460 12624]
 [45766 87142 12314]
 [47931 75529 33281]]
training model: results/AAPL/W1/deepLOB_L2/h30
Epoch 1/50
6073/6073 - 363s - loss: 3.1223 - accuracy30: 0.4518 - val_loss: 3.4552 - val_accuracy30: 0.3603 - 363s/epoch - 60ms/step
Epoch 2/50
6073/6073 - 355s - loss: 3.0613 - accuracy30: 0.4769 - val_loss: 3.4504 - val_accuracy30: 0.3787 - 355s/epoch - 58ms/step
Epoch 3/50
6073/6073 - 360s - loss: 3.0252 - accuracy30: 0.4882 - val_loss: 3.5566 - val_accuracy30: 0.3635 - 360s/epoch - 59ms/step
Epoch 4/50
6073/6073 - 361s - loss: 3.0008 - accuracy30: 0.4950 - val_loss: 3.4635 - val_accuracy30: 0.3951 - 361s/epoch - 59ms/step
Epoch 5/50
6073/6073 - 351s - loss: 2.9819 - accuracy30: 0.5002 - val_loss: 3.4180 - val_accuracy30: 0.4089 - 351s/epoch - 58ms/step
Epoch 6/50
6073/6073 - 359s - loss: 2.9677 - accuracy30: 0.5036 - val_loss: 3.4693 - val_accuracy30: 0.4150 - 359s/epoch - 59ms/step
Epoch 7/50
6073/6073 - 365s - loss: 2.9577 - accuracy30: 0.5065 - val_loss: 3.4418 - val_accuracy30: 0.4190 - 365s/epoch - 60ms/step
Epoch 8/50
6073/6073 - 379s - loss: 2.9496 - accuracy30: 0.5086 - val_loss: 3.4266 - val_accuracy30: 0.4239 - 379s/epoch - 62ms/step
Epoch 9/50
6073/6073 - 378s - loss: 2.9439 - accuracy30: 0.5101 - val_loss: 3.4324 - val_accuracy30: 0.4244 - 378s/epoch - 62ms/step
Epoch 10/50
6073/6073 - 377s - loss: 2.9387 - accuracy30: 0.5113 - val_loss: 3.4334 - val_accuracy30: 0.4203 - 377s/epoch - 62ms/step
Epoch 11/50
6073/6073 - 376s - loss: 2.9341 - accuracy30: 0.5122 - val_loss: 3.4876 - val_accuracy30: 0.4218 - 376s/epoch - 62ms/step
Epoch 12/50
6073/6073 - 364s - loss: 2.9303 - accuracy30: 0.5135 - val_loss: 3.4902 - val_accuracy30: 0.4220 - 364s/epoch - 60ms/step
Epoch 13/50
6073/6073 - 364s - loss: 2.9269 - accuracy30: 0.5146 - val_loss: 3.5234 - val_accuracy30: 0.4229 - 364s/epoch - 60ms/step
Epoch 14/50
6073/6073 - 350s - loss: 2.9236 - accuracy30: 0.5152 - val_loss: 3.5097 - val_accuracy30: 0.4249 - 350s/epoch - 58ms/step
Epoch 15/50
6073/6073 - 370s - loss: 2.9205 - accuracy30: 0.5161 - val_loss: 3.5152 - val_accuracy30: 0.4215 - 370s/epoch - 61ms/step
testing model: results/AAPL/W1/deepLOB_L2/h30
Evaluating performance on  test set...
21353/21353 - 478s - 478s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1647433
{'0': {'precision': 0.5056442010238399, 'recall': 0.4720994798478637, 'f1-score': 0.4882964092974113, 'support': 2161483}, '1': {'precision': 0.2451820721143371, 'recall': 0.5549124576282481, 'f1-score': 0.3400962789912489, 'support': 1125455}, '2': {'precision': 0.5196104439558098, 'recall': 0.21480911806152403, 'f1-score': 0.30395993509516583, 'support': 2179279}, 'accuracy': 0.3865732004419144, 'macro avg': {'precision': 0.42347890569799557, 'recall': 0.4139403518458786, 'f1-score': 0.3774508744612753, 'support': 5466217}, 'weighted avg': {'precision': 0.45758499200207875, 'recall': 0.3865732004419144, 'f1-score': 0.38429153996699184, 'support': 5466217}}
[[1020435  845568  295480]
 [ 363612  624529  137314]
 [ 634042 1077108  468129]]
Evaluating performance on  train set...
6073/6073 - 137s - 137s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0662727
{'0': {'precision': 0.49149105239950025, 'recall': 0.4154386714162307, 'f1-score': 0.45027610069443347, 'support': 515135}, '1': {'precision': 0.3998309531114019, 'recall': 0.6137420808217493, 'f1-score': 0.4842139104417405, 'support': 520256}, '2': {'precision': 0.49155942408785314, 'recall': 0.3034923521129202, 'f1-score': 0.37528254205678707, 'support': 519163}, 'accuracy': 0.44441814179501, 'macro avg': {'precision': 0.46096047653291844, 'recall': 0.4442243681169668, 'f1-score': 0.4365908510643204, 'support': 1554554}, 'weighted avg': {'precision': 0.46083838895751716, 'recall': 0.44441814179501, 'f1-score': 0.4365888748180075, 'support': 1554554}}
[[214007 222919  78209]
 [116189 319303  84764]
 [105228 256373 157562]]
Evaluating performance on  val set...
1786/1786 - 41s - 41s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1394219
{'0': {'precision': 0.46925978624135534, 'recall': 0.527458017964406, 'f1-score': 0.49665980825635864, 'support': 161319}, '1': {'precision': 0.33126716032947834, 'recall': 0.537439350876272, 'f1-score': 0.4098875864691971, 'support': 133349}, '2': {'precision': 0.5041243175136497, 'recall': 0.1846362098138748, 'f1-score': 0.2702814681378068, 'support': 162525}, 'accuracy': 0.408501442498026, 'macro avg': {'precision': 0.4348837546948278, 'recall': 0.4165111928848509, 'f1-score': 0.3922762876211208, 'support': 457193}, 'weighted avg': {'precision': 0.44140542117519455, 'recall': 0.408501442498026, 'f1-score': 0.3908770672020034, 'support': 457193}}
[[85089 61760 14470]
 [46635 71667 15047]
 [49602 82915 30008]]
training model: results/AAPL/W1/deepLOB_L2/h50
Epoch 1/50
6073/6073 - 383s - loss: 3.1933 - accuracy50: 0.4222 - val_loss: 3.3644 - val_accuracy50: 0.3568 - 383s/epoch - 63ms/step
Epoch 2/50
6073/6073 - 386s - loss: 3.1524 - accuracy50: 0.4427 - val_loss: 3.4329 - val_accuracy50: 0.3697 - 386s/epoch - 64ms/step
Epoch 3/50
6073/6073 - 363s - loss: 3.1311 - accuracy50: 0.4511 - val_loss: 3.5853 - val_accuracy50: 0.3688 - 363s/epoch - 60ms/step
Epoch 4/50
6073/6073 - 362s - loss: 3.1177 - accuracy50: 0.4567 - val_loss: 3.5623 - val_accuracy50: 0.3796 - 362s/epoch - 60ms/step
Epoch 5/50
6073/6073 - 369s - loss: 3.1088 - accuracy50: 0.4599 - val_loss: 3.5657 - val_accuracy50: 0.3726 - 369s/epoch - 61ms/step
Epoch 6/50
6073/6073 - 375s - loss: 3.1019 - accuracy50: 0.4631 - val_loss: 3.5061 - val_accuracy50: 0.3762 - 375s/epoch - 62ms/step
Epoch 7/50
6073/6073 - 367s - loss: 3.0952 - accuracy50: 0.4650 - val_loss: 3.5325 - val_accuracy50: 0.3742 - 367s/epoch - 61ms/step
Epoch 8/50
6073/6073 - 367s - loss: 3.0890 - accuracy50: 0.4677 - val_loss: 3.4645 - val_accuracy50: 0.3767 - 367s/epoch - 60ms/step
Epoch 9/50
6073/6073 - 378s - loss: 3.0829 - accuracy50: 0.4701 - val_loss: 3.5192 - val_accuracy50: 0.3730 - 378s/epoch - 62ms/step
Epoch 10/50
6073/6073 - 365s - loss: 3.0775 - accuracy50: 0.4718 - val_loss: 3.5484 - val_accuracy50: 0.3674 - 365s/epoch - 60ms/step
Epoch 11/50
6073/6073 - 376s - loss: 3.0725 - accuracy50: 0.4737 - val_loss: 3.4922 - val_accuracy50: 0.3679 - 376s/epoch - 62ms/step
testing model: results/AAPL/W1/deepLOB_L2/h50
Evaluating performance on  test set...
21353/21353 - 482s - 482s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.132866
{'0': {'precision': 0.4086081609837898, 'recall': 0.6562269898427492, 'f1-score': 0.5036266943281132, 'support': 2081961}, '1': {'precision': 0.23806674801554853, 'recall': 0.3676283528149309, 'f1-score': 0.2889905707111151, 'support': 1286941}, '2': {'precision': 0.49906470192456986, 'recall': 0.032183529894174216, 'f1-score': 0.060467641270179694, 'support': 2097315}, 'accuracy': 0.3488434505984669, 'macro avg': {'precision': 0.3819132036413027, 'recall': 0.3520129575172848, 'f1-score': 0.28436163543646936, 'support': 5466217}, 'weighted avg': {'precision': 0.40316365038650664, 'recall': 0.3488434505984669, 'f1-score': 0.28305949823473037, 'support': 5466217}}
[[1366239  675284   40438]
 [ 786511  473116   27314]
 [1190891  838925   67499]]
Evaluating performance on  train set...
6073/6073 - 140s - 140s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008123
{'0': {'precision': 0.38999870013686794, 'recall': 0.49067806719487744, 'f1-score': 0.43458352823695506, 'support': 519742}, '1': {'precision': 0.33087783042957863, 'recall': 0.41102988258309336, 'f1-score': 0.36662424019979273, 'support': 509126}, '2': {'precision': 0.433272926594626, 'recall': 0.2210368927458597, 'f1-score': 0.2927338046123537, 'support': 525686}, 'accuracy': 0.37341128066313556, 'macro avg': {'precision': 0.38471648572035755, 'recall': 0.3742482808412768, 'f1-score': 0.36464719101636717, 'support': 1554554}, 'weighted avg': {'precision': 0.38526980882725737, 'recall': 0.37341128066313556, 'f1-score': 0.3643587214470137, 'support': 1554554}}
[[255026 192170  72546]
 [220420 209266  79440]
 [178469 231021 116196]]
Evaluating performance on  val set...
1786/1786 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1243721
{'0': {'precision': 0.38720738323784953, 'recall': 0.5059866879857212, 'f1-score': 0.4386992429086493, 'support': 161358}, '1': {'precision': 0.2934301006159814, 'recall': 0.3884906171872647, 'f1-score': 0.3343345873310587, 'support': 132796}, '2': {'precision': 0.4215825297787862, 'recall': 0.182349008519434, 'f1-score': 0.25458235392341977, 'support': 163039}, 'accuracy': 0.3564468397372663, 'macro avg': {'precision': 0.3674066712108724, 'recall': 0.35894210456413994, 'f1-score': 0.3425387280543759, 'support': 457193}, 'weighted avg': {'precision': 0.3722273671261291, 'recall': 0.3564468397372663, 'f1-score': 0.34272786481374284, 'support': 457193}}
[[81645 58526 21187]
 [61603 51590 19603]
 [67608 65701 29730]]
training model: results/AAPL/W1/deepLOB_L2/h100
Epoch 1/50
6073/6073 - 390s - loss: 3.2173 - accuracy100: 0.4118 - val_loss: 3.3563 - val_accuracy100: 0.3390 - 390s/epoch - 64ms/step
Epoch 2/50
6073/6073 - 380s - loss: 3.1937 - accuracy100: 0.4250 - val_loss: 3.3843 - val_accuracy100: 0.3739 - 380s/epoch - 63ms/step
Epoch 3/50
6073/6073 - 385s - loss: 3.1814 - accuracy100: 0.4309 - val_loss: 3.4532 - val_accuracy100: 0.3725 - 385s/epoch - 63ms/step
Epoch 4/50
6073/6073 - 369s - loss: 3.1730 - accuracy100: 0.4342 - val_loss: 3.5183 - val_accuracy100: 0.3727 - 369s/epoch - 61ms/step
Epoch 5/50
6073/6073 - 379s - loss: 3.1673 - accuracy100: 0.4367 - val_loss: 3.4784 - val_accuracy100: 0.3690 - 379s/epoch - 62ms/step
Epoch 6/50
6073/6073 - 373s - loss: 3.1624 - accuracy100: 0.4392 - val_loss: 3.4576 - val_accuracy100: 0.3561 - 373s/epoch - 61ms/step
Epoch 7/50
6073/6073 - 379s - loss: 3.1589 - accuracy100: 0.4407 - val_loss: 3.4270 - val_accuracy100: 0.3174 - 379s/epoch - 62ms/step
Epoch 8/50
6073/6073 - 332s - loss: 3.1557 - accuracy100: 0.4422 - val_loss: 3.4200 - val_accuracy100: 0.3090 - 332s/epoch - 55ms/step
Epoch 9/50
6073/6073 - 268s - loss: 3.1533 - accuracy100: 0.4430 - val_loss: 3.4297 - val_accuracy100: 0.3093 - 268s/epoch - 44ms/step
Epoch 10/50
6073/6073 - 269s - loss: 3.1509 - accuracy100: 0.4443 - val_loss: 3.4424 - val_accuracy100: 0.3111 - 269s/epoch - 44ms/step
Epoch 11/50
6073/6073 - 269s - loss: 3.1488 - accuracy100: 0.4453 - val_loss: 3.4091 - val_accuracy100: 0.3116 - 269s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L2/h100
Evaluating performance on  test set...
21353/21353 - 368s - 368s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1412251
{'0': {'precision': 0.39181057667499003, 'recall': 0.18213724862400707, 'f1-score': 0.24867521844931342, 'support': 1967670}, '1': {'precision': 0.2824752164823346, 'recall': 0.840801162406086, 'f1-score': 0.42287988038044566, 'support': 1523736}, '2': {'precision': 0.40383776711731356, 'recall': 0.003282339423873981, 'f1-score': 0.006511752195782532, 'support': 1974811}, 'accuracy': 0.3011272695540627, 'macro avg': {'precision': 0.3593745200915461, 'recall': 0.3420735834846557, 'f1-score': 0.2260222836751805, 'support': 5466217}, 'weighted avg': {'precision': 0.3656779155651364, 'recall': 0.3011272695540627, 'f1-score': 0.2097479014029346, 'support': 5466217}}
[[ 358386 1604014    5270]
 [ 238278 1281159    4299]
 [ 318028 1650301    6482]]
Evaluating performance on  train set...
6073/6073 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103992
{'0': {'precision': 0.3825174676436494, 'recall': 0.13891742623204079, 'f1-score': 0.203815827126145, 'support': 517840}, '1': {'precision': 0.3460307004295809, 'recall': 0.8061381084030276, 'f1-score': 0.48421469519958815, 'support': 518694}, '2': {'precision': 0.408361531893362, 'recall': 0.12463611443573608, 'f1-score': 0.19098243667960804, 'support': 518020}, 'accuracy': 0.3567840036434887, 'macro avg': {'precision': 0.37896989998886416, 'recall': 0.3565638830236015, 'f1-score': 0.29300431966844703, 'support': 1554554}, 'weighted avg': {'precision': 0.37895520794041754, 'recall': 0.3567840036434887, 'f1-score': 0.29309754880153965, 'support': 1554554}}
[[ 71937 389754  56149]
 [ 63163 418139  37392]
 [ 52962 400494  64564]]
Evaluating performance on  val set...
1786/1786 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1187596
{'0': {'precision': 0.36035061628247594, 'recall': 0.10408341251968811, 'f1-score': 0.1615149602322939, 'support': 153646}, '1': {'precision': 0.3293901617071863, 'recall': 0.8468318506794739, 'f1-score': 0.474294949927212, 'support': 146584}, '2': {'precision': 0.4086206896551724, 'recall': 0.09361441868465817, 'f1-score': 0.15233020427839086, 'support': 156963}, 'accuracy': 0.33862723182550913, 'macro avg': {'precision': 0.36612048921494483, 'recall': 0.34817656062794006, 'f1-score': 0.2627133714792989, 'support': 457193}, 'weighted avg': {'precision': 0.36699618665064493, 'recall': 0.33862723182550913, 'f1-score': 0.2586443457667343, 'support': 457193}}
[[ 15992 123771  13883]
 [ 15069 124132   7383]
 [ 13318 128951  14694]]
training model: results/AAPL/W1/deepLOB_L2/h200
Epoch 1/50
6073/6073 - 272s - loss: 3.2606 - accuracy200: 0.3878 - val_loss: 3.4034 - val_accuracy200: 0.3379 - 272s/epoch - 45ms/step
Epoch 2/50
6073/6073 - 269s - loss: 3.2369 - accuracy200: 0.4035 - val_loss: 3.4889 - val_accuracy200: 0.3397 - 269s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 269s - loss: 3.2256 - accuracy200: 0.4101 - val_loss: 3.4890 - val_accuracy200: 0.3374 - 269s/epoch - 44ms/step
Epoch 4/50
6073/6073 - 269s - loss: 3.2185 - accuracy200: 0.4141 - val_loss: 3.5377 - val_accuracy200: 0.3368 - 269s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 269s - loss: 3.2138 - accuracy200: 0.4164 - val_loss: 3.5882 - val_accuracy200: 0.3336 - 269s/epoch - 44ms/step
Epoch 6/50
6073/6073 - 272s - loss: 3.2095 - accuracy200: 0.4182 - val_loss: 3.5164 - val_accuracy200: 0.3343 - 272s/epoch - 45ms/step
Epoch 7/50
6073/6073 - 273s - loss: 3.2062 - accuracy200: 0.4195 - val_loss: 3.5188 - val_accuracy200: 0.3364 - 273s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 270s - loss: 3.2034 - accuracy200: 0.4208 - val_loss: 3.4945 - val_accuracy200: 0.3352 - 270s/epoch - 44ms/step
Epoch 9/50
6073/6073 - 269s - loss: 3.1999 - accuracy200: 0.4226 - val_loss: 3.5786 - val_accuracy200: 0.3367 - 269s/epoch - 44ms/step
Epoch 10/50
6073/6073 - 271s - loss: 3.1967 - accuracy200: 0.4238 - val_loss: 3.4949 - val_accuracy200: 0.3354 - 271s/epoch - 45ms/step
Epoch 11/50
6073/6073 - 272s - loss: 3.1940 - accuracy200: 0.4253 - val_loss: 3.5372 - val_accuracy200: 0.3359 - 272s/epoch - 45ms/step
testing model: results/AAPL/W1/deepLOB_L2/h200
Evaluating performance on  test set...
21353/21353 - 363s - 363s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.150054
{'0': {'precision': 0.3657526992819135, 'recall': 0.9638041547571203, 'f1-score': 0.5302728801865747, 'support': 1998047}, '1': {'precision': 0.2680930401764398, 'recall': 0.02412688149160644, 'f1-score': 0.04426973337162961, 'support': 1466124}, '2': {'precision': 0.3775769842417233, 'recall': 0.013045154806632814, 'f1-score': 0.025219001784458985, 'support': 2002046}, 'accuracy': 0.36354502574632513, 'macro avg': {'precision': 0.33714090790002554, 'recall': 0.33365873035178656, 'f1-score': 0.19992053844755445, 'support': 5466217}, 'weighted avg': {'precision': 0.34388960682881364, 'recall': 0.36354502574632513, 'f1-score': 0.2149392637823308, 'support': 5466217}}
[[1925726   47605   24716]
 [1412414   35373   18337]
 [1926964   48965   26117]]
Evaluating performance on  train set...
6073/6073 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1390519
{'0': {'precision': 0.33348969403793377, 'recall': 0.7885729691215976, 'f1-score': 0.4687455822804733, 'support': 519295}, '1': {'precision': 0.30938476417199823, 'recall': 0.09726723981671152, 'f1-score': 0.14800370713623726, 'support': 513071}, '2': {'precision': 0.3640333897894992, 'recall': 0.11524968019180831, 'f1-score': 0.17507287187930903, 'support': 522188}, 'accuracy': 0.3342367006871424, 'macro avg': {'precision': 0.3356359493331437, 'recall': 0.33369662971003916, 'f1-score': 0.26394072043200656, 'support': 1554554}, 'weighted avg': {'precision': 0.3357938989261995, 'recall': 0.3342367006871424, 'f1-score': 0.26423951821252106, 'support': 1554554}}
[[409502  54668  55125]
 [413153  49905  50013]
 [405275  56731  60182]]
Evaluating performance on  val set...
1786/1786 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.134829
{'0': {'precision': 0.33919306048039743, 'recall': 0.8759012693752708, 'f1-score': 0.48901492655858797, 'support': 154643}, '1': {'precision': 0.3122799804712593, 'recall': 0.0843647824064754, 'f1-score': 0.13284144941793735, 'support': 144053}, '2': {'precision': 0.370168954593453, 'recall': 0.0442342757276163, 'f1-score': 0.07902523149061356, 'support': 158497}, 'accuracy': 0.33818540528835744, 'macro avg': {'precision': 0.3405473318483699, 'recall': 0.3348334425031208, 'f1-score': 0.2336272024890463, 'support': 457193}, 'weighted avg': {'precision': 0.34145179229536526, 'recall': 0.33818540528835744, 'f1-score': 0.23465846309188815, 'support': 457193}}
[[135452  12890   6301]
 [126272  12153   5628]
 [137612  13874   7011]]
training model: results/AAPL/W1/deepLOB_L2/h300
Epoch 1/50
6073/6073 - 271s - loss: 3.2384 - accuracy300: 0.4048 - val_loss: 3.3611 - val_accuracy300: 0.3312 - 271s/epoch - 45ms/step
Epoch 2/50
6073/6073 - 268s - loss: 3.2117 - accuracy300: 0.4188 - val_loss: 3.4248 - val_accuracy300: 0.3437 - 268s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 268s - loss: 3.2003 - accuracy300: 0.4243 - val_loss: 3.4207 - val_accuracy300: 0.3190 - 268s/epoch - 44ms/step
Epoch 4/50
6073/6073 - 271s - loss: 3.1905 - accuracy300: 0.4286 - val_loss: 3.4644 - val_accuracy300: 0.3159 - 271s/epoch - 45ms/step
Epoch 5/50
6073/6073 - 272s - loss: 3.1837 - accuracy300: 0.4317 - val_loss: 3.5433 - val_accuracy300: 0.3383 - 272s/epoch - 45ms/step
Epoch 6/50
6073/6073 - 268s - loss: 3.1784 - accuracy300: 0.4337 - val_loss: 3.4947 - val_accuracy300: 0.3324 - 268s/epoch - 44ms/step
Epoch 7/50
6073/6073 - 270s - loss: 3.1733 - accuracy300: 0.4363 - val_loss: 3.5149 - val_accuracy300: 0.3313 - 270s/epoch - 45ms/step
Epoch 8/50
6073/6073 - 269s - loss: 3.1691 - accuracy300: 0.4376 - val_loss: 3.5509 - val_accuracy300: 0.3267 - 269s/epoch - 44ms/step
Epoch 9/50
6073/6073 - 268s - loss: 3.1651 - accuracy300: 0.4394 - val_loss: 3.6216 - val_accuracy300: 0.3289 - 268s/epoch - 44ms/step
Epoch 10/50
6073/6073 - 270s - loss: 3.1608 - accuracy300: 0.4413 - val_loss: 3.5778 - val_accuracy300: 0.3345 - 270s/epoch - 44ms/step
Epoch 11/50
6073/6073 - 269s - loss: 3.1577 - accuracy300: 0.4425 - val_loss: 3.6650 - val_accuracy300: 0.3250 - 269s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L2/h300
Evaluating performance on  test set...
21353/21353 - 377s - 377s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1303859
{'0': {'precision': 0.34878656622993287, 'recall': 0.5989196935804666, 'f1-score': 0.44084365004238046, 'support': 1903534}, '1': {'precision': 0.306183172530957, 'recall': 0.30757229888075305, 'f1-score': 0.30687616368564047, 'support': 1645392}, '2': {'precision': 0.35326472089325905, 'recall': 0.1003624384613499, 'f1-score': 0.15631563534096157, 'support': 1917291}, 'accuracy': 0.33635053273589394, 'macro avg': {'precision': 0.3360781532180497, 'recall': 0.3356181436408565, 'f1-score': 0.30134514968966086, 'support': 5466217}, 'weighted avg': {'precision': 0.3375331971206308, 'recall': 0.33635053273589394, 'f1-score': 0.30071894731901855, 'support': 5466217}}
[[1140064  574881  188589]
 [ 975626  506077  163689]
 [1152968  571899  192424]]
Evaluating performance on  train set...
6073/6073 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1282479
{'0': {'precision': 0.3315954609697154, 'recall': 0.5152258178752757, 'f1-score': 0.40350082561665, 'support': 519578}, '1': {'precision': 0.33516440164369654, 'recall': 0.3071068767023717, 'f1-score': 0.3205227947781701, 'support': 511786}, '2': {'precision': 0.35883320996615187, 'recall': 0.19087520785947742, 'f1-score': 0.2491952508571514, 'support': 523190}, 'accuracy': 0.3375482614306097, 'macro avg': {'precision': 0.3418643575265213, 'recall': 0.3377359674790416, 'f1-score': 0.32440629041732383, 'support': 1554554}, 'weighted avg': {'precision': 0.34193736724586904, 'recall': 0.3375482614306097, 'f1-score': 0.32425100338524193, 'support': 1554554}}
[[267700 155360  96518]
 [272693 157173  81920]
 [266916 156410  99864]]
Evaluating performance on  val set...
1786/1786 - 31s - 31s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1204981
{'0': {'precision': 0.3112672874934546, 'recall': 0.4127698392707617, 'f1-score': 0.3549037569471476, 'support': 146893}, '1': {'precision': 0.34151496364763567, 'recall': 0.37862645980042364, 'f1-score': 0.3591144668102848, 'support': 160039}, '2': {'precision': 0.3521872682978498, 'recall': 0.1991534729570547, 'f1-score': 0.2544318326744037, 'support': 150261}, 'accuracy': 0.33061092361431604, 'macro avg': {'precision': 0.33498983981298003, 'recall': 0.3301832573427467, 'f1-score': 0.3228166854772787, 'support': 457193}, 'weighted avg': {'precision': 0.3353041495619644, 'recall': 0.33061092361431604, 'f1-score': 0.3233566116116763, 'support': 457193}}
[[60633 57706 28554]
 [72954 60595 26490]
 [61207 59129 29925]]
training model: results/AAPL/W1/deepLOB_L2/h500
Epoch 1/50
6073/6073 - 273s - loss: 3.2292 - accuracy500: 0.4102 - val_loss: 3.3493 - val_accuracy500: 0.3205 - 273s/epoch - 45ms/step
Epoch 2/50
6073/6073 - 268s - loss: 3.1979 - accuracy500: 0.4241 - val_loss: 3.3803 - val_accuracy500: 0.3224 - 268s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 267s - loss: 3.1861 - accuracy500: 0.4304 - val_loss: 3.3763 - val_accuracy500: 0.3289 - 267s/epoch - 44ms/step
Epoch 4/50
6073/6073 - 267s - loss: 3.1746 - accuracy500: 0.4349 - val_loss: 3.3956 - val_accuracy500: 0.3214 - 267s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 267s - loss: 3.1655 - accuracy500: 0.4390 - val_loss: 3.4067 - val_accuracy500: 0.3270 - 267s/epoch - 44ms/step
Epoch 6/50
6073/6073 - 266s - loss: 3.1563 - accuracy500: 0.4423 - val_loss: 3.3806 - val_accuracy500: 0.3254 - 266s/epoch - 44ms/step
Epoch 7/50
6073/6073 - 267s - loss: 3.1492 - accuracy500: 0.4456 - val_loss: 3.3802 - val_accuracy500: 0.3311 - 267s/epoch - 44ms/step
Epoch 8/50
6073/6073 - 267s - loss: 3.1428 - accuracy500: 0.4482 - val_loss: 3.3725 - val_accuracy500: 0.3315 - 267s/epoch - 44ms/step
Epoch 9/50
6073/6073 - 266s - loss: 3.1374 - accuracy500: 0.4499 - val_loss: 3.4027 - val_accuracy500: 0.3307 - 266s/epoch - 44ms/step
Epoch 10/50
6073/6073 - 266s - loss: 3.1339 - accuracy500: 0.4509 - val_loss: 3.4357 - val_accuracy500: 0.3372 - 266s/epoch - 44ms/step
Epoch 11/50
6073/6073 - 267s - loss: 3.1294 - accuracy500: 0.4525 - val_loss: 3.5094 - val_accuracy500: 0.3379 - 267s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L2/h500
Evaluating performance on  test set...
21353/21353 - 361s - 361s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1333318
{'0': {'precision': 0.37591727915312234, 'recall': 0.2517493895896809, 'f1-score': 0.3015516046202265, 'support': 2058861}, '1': {'precision': 0.24051212345578962, 'recall': 0.7482879734480211, 'f1-score': 0.36402166628816696, 'support': 1308829}, '2': {'precision': 0.46513749511273295, 'recall': 0.00340143348167548, 'f1-score': 0.006753480459800565, 'support': 2098527}, 'accuracy': 0.2752975229486864, 'macro avg': {'precision': 0.36052229924054835, 'recall': 0.33447959883979245, 'f1-score': 0.22410891712273137, 'support': 5466217}, 'weighted avg': {'precision': 0.37774831469578185, 'recall': 0.2752975229486864, 'f1-score': 0.2033339168194646, 'support': 5466217}}
[[ 518317 1535260    5284]
 [ 326524  979381    2924]
 [ 533965 1557424    7138]]
Evaluating performance on  train set...
6073/6073 - 104s - 104s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202439
{'0': {'precision': 0.3297989993364374, 'recall': 0.2284340153204693, 'f1-score': 0.26991348662313686, 'support': 515650}, '1': {'precision': 0.334779401792134, 'recall': 0.7017382618160718, 'f1-score': 0.45330151864008533, 'support': 513559}, '2': {'precision': 0.38061682753144926, 'recall': 0.0875995774205522, 'f1-score': 0.1424207819216593, 'support': 525345}, 'accuracy': 0.3372002516477395, 'macro avg': {'precision': 0.34839840955334017, 'recall': 0.33925728485236445, 'f1-score': 0.28854526239496053, 'support': 1554554}, 'weighted avg': {'precision': 0.34861765887341944, 'recall': 0.3372002516477395, 'f1-score': 0.28741234441977453, 'support': 1554554}}
[[117792 354940  42918]
 [121204 360384  31971]
 [118167 361158  46020]]
Evaluating performance on  val set...
1786/1786 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1179233
{'0': {'precision': 0.34353833969668673, 'recall': 0.18572031082255508, 'f1-score': 0.2410996860054669, 'support': 156488}, '1': {'precision': 0.3121653004889035, 'recall': 0.7816765229131362, 'f1-score': 0.4461564395140414, 'support': 142211}, '2': {'precision': 0.37541689406342854, 'recall': 0.03906141557409113, 'f1-score': 0.0707603508872189, 'support': 158494}, 'accuracy': 0.32025205985218497, 'macro avg': {'precision': 0.34370684474967295, 'recall': 0.33548608310326083, 'f1-score': 0.2526721588022424, 'support': 457193}, 'weighted avg': {'precision': 0.3448309411079601, 'recall': 0.32025205985218497, 'f1-score': 0.24583196185609515, 'support': 457193}}
[[ 29063 121813   5612]
 [ 26360 111163   4688]
 [ 29176 123127   6191]]
training model: results/AAPL/W1/deepLOB_L2/h1000
Epoch 1/50
6073/6073 - 272s - loss: 3.1894 - accuracy1000: 0.4284 - val_loss: 3.4563 - val_accuracy1000: 0.3318 - 272s/epoch - 45ms/step
Epoch 2/50
6073/6073 - 267s - loss: 3.1364 - accuracy1000: 0.4522 - val_loss: 3.4714 - val_accuracy1000: 0.3370 - 267s/epoch - 44ms/step
Epoch 3/50
6073/6073 - 266s - loss: 3.1139 - accuracy1000: 0.4603 - val_loss: 3.4928 - val_accuracy1000: 0.3409 - 266s/epoch - 44ms/step
Epoch 4/50
6073/6073 - 267s - loss: 3.0984 - accuracy1000: 0.4654 - val_loss: 3.4948 - val_accuracy1000: 0.3493 - 267s/epoch - 44ms/step
Epoch 5/50
6073/6073 - 267s - loss: 3.0921 - accuracy1000: 0.4676 - val_loss: 3.5038 - val_accuracy1000: 0.3507 - 267s/epoch - 44ms/step
Epoch 6/50
6073/6073 - 268s - loss: 3.0833 - accuracy1000: 0.4705 - val_loss: 3.6149 - val_accuracy1000: 0.3482 - 268s/epoch - 44ms/step
Epoch 7/50
6073/6073 - 268s - loss: 3.0765 - accuracy1000: 0.4725 - val_loss: 3.7090 - val_accuracy1000: 0.3469 - 268s/epoch - 44ms/step
Epoch 8/50
6073/6073 - 269s - loss: 3.0706 - accuracy1000: 0.4738 - val_loss: 3.5709 - val_accuracy1000: 0.3468 - 269s/epoch - 44ms/step
Epoch 9/50
6073/6073 - 271s - loss: 3.0633 - accuracy1000: 0.4759 - val_loss: 3.6639 - val_accuracy1000: 0.3471 - 271s/epoch - 45ms/step
Epoch 10/50
6073/6073 - 270s - loss: 3.0585 - accuracy1000: 0.4774 - val_loss: 3.7213 - val_accuracy1000: 0.3486 - 270s/epoch - 44ms/step
Epoch 11/50
6073/6073 - 269s - loss: 3.0586 - accuracy1000: 0.4765 - val_loss: 3.7260 - val_accuracy1000: 0.3496 - 269s/epoch - 44ms/step
testing model: results/AAPL/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
21353/21353 - 388s - 388s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1889235
{'0': {'precision': 0.3742028706700848, 'recall': 0.6012326496636916, 'f1-score': 0.46129749994699737, 'support': 2044701}, '1': {'precision': 0.24766383716020443, 'recall': 0.3814569239394506, 'f1-score': 0.30033370804371756, 'support': 1337750}, '2': {'precision': 0.39202561358980104, 'recall': 0.02268152949995345, 'f1-score': 0.042882022494847634, 'support': 2083766}, 'accuracy': 0.32689847475868594, 'macro avg': {'precision': 0.3379641071400301, 'recall': 0.33512370103436523, 'f1-score': 0.26817107682852087, 'support': 5466217}, 'weighted avg': {'precision': 0.3500290835052143, 'recall': 0.32689847475868594, 'f1-score': 0.26240139713820493, 'support': 5466217}}
[[1229341  771061   44299]
 [ 798457  510294   28999]
 [1257428  779075   47263]]
Evaluating performance on  train set...
6073/6073 - 111s - 111s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1738005
{'0': {'precision': 0.3253136704528861, 'recall': 0.5097010868502462, 'f1-score': 0.39714922388343965, 'support': 511386}, '1': {'precision': 0.3239894207263656, 'recall': 0.3782880188596534, 'f1-score': 0.3490395937261247, 'support': 513265}, '2': {'precision': 0.37468025709277414, 'recall': 0.10891049871391556, 'f1-score': 0.1687650690930252, 'support': 529903}, 'accuracy': 0.3296945619129345, 'macro avg': {'precision': 0.34132778275734194, 'recall': 0.3322998681412717, 'f1-score': 0.30498462890086314, 'support': 1554554}, 'weighted avg': {'precision': 0.3417041022579917, 'recall': 0.3296945619129345, 'f1-score': 0.30341530528132016, 'support': 1554554}}
[[260654 198697  52035]
 [274820 194162  44283]
 [265765 206426  57712]]
Evaluating performance on  val set...
1786/1786 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1558698
{'0': {'precision': 0.3505457807905099, 'recall': 0.4454677316172512, 'f1-score': 0.39234719351536507, 'support': 157879}, '1': {'precision': 0.3093779410700065, 'recall': 0.4872131054090452, 'f1-score': 0.3784450957113245, 'support': 140339}, '2': {'precision': 0.359893123330052, 'recall': 0.0804906431828904, 'f1-score': 0.13155811442965096, 'support': 158975}, 'accuracy': 0.33137209012386454, 'macro avg': {'precision': 0.3399389483968562, 'recall': 0.3377238267363956, 'f1-score': 0.30078346788544685, 'support': 457193}, 'weighted avg': {'precision': 0.3411592423301397, 'recall': 0.33137209012386454, 'f1-score': 0.29739834182390734, 'support': 457193}}
[[70330 75448 12101]
 [61306 68375 10658]
 [68994 77185 12796]]
training model: results/AAPL/W1/deepOF_L2/h10
Epoch 1/50
6073/6073 - 180s - loss: 2.9110 - accuracy10: 0.5033 - val_loss: 3.1364 - val_accuracy10: 0.5081 - 180s/epoch - 30ms/step
Epoch 2/50
6073/6073 - 166s - loss: 2.8124 - accuracy10: 0.5293 - val_loss: 3.1246 - val_accuracy10: 0.5130 - 166s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 171s - loss: 2.7870 - accuracy10: 0.5336 - val_loss: 3.1144 - val_accuracy10: 0.5164 - 171s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 198s - loss: 2.7712 - accuracy10: 0.5367 - val_loss: 3.0961 - val_accuracy10: 0.5195 - 198s/epoch - 33ms/step
Epoch 5/50
6073/6073 - 200s - loss: 2.7594 - accuracy10: 0.5388 - val_loss: 3.1018 - val_accuracy10: 0.5235 - 200s/epoch - 33ms/step
Epoch 6/50
6073/6073 - 200s - loss: 2.7501 - accuracy10: 0.5405 - val_loss: 3.0914 - val_accuracy10: 0.5230 - 200s/epoch - 33ms/step
Epoch 7/50
6073/6073 - 203s - loss: 2.7423 - accuracy10: 0.5421 - val_loss: 3.0930 - val_accuracy10: 0.5268 - 203s/epoch - 33ms/step
Epoch 8/50
6073/6073 - 199s - loss: 2.7354 - accuracy10: 0.5434 - val_loss: 3.0793 - val_accuracy10: 0.5264 - 199s/epoch - 33ms/step
Epoch 9/50
6073/6073 - 203s - loss: 2.7294 - accuracy10: 0.5447 - val_loss: 3.0768 - val_accuracy10: 0.5305 - 203s/epoch - 33ms/step
Epoch 10/50
6073/6073 - 204s - loss: 2.7242 - accuracy10: 0.5457 - val_loss: 3.0749 - val_accuracy10: 0.5299 - 204s/epoch - 34ms/step
Epoch 11/50
6073/6073 - 199s - loss: 2.7199 - accuracy10: 0.5466 - val_loss: 3.0592 - val_accuracy10: 0.5314 - 199s/epoch - 33ms/step
Epoch 12/50
6073/6073 - 206s - loss: 2.7152 - accuracy10: 0.5473 - val_loss: 3.0520 - val_accuracy10: 0.5316 - 206s/epoch - 34ms/step
Epoch 13/50
6073/6073 - 206s - loss: 2.7111 - accuracy10: 0.5482 - val_loss: 3.0474 - val_accuracy10: 0.5311 - 206s/epoch - 34ms/step
Epoch 14/50
6073/6073 - 205s - loss: 2.7072 - accuracy10: 0.5492 - val_loss: 3.0518 - val_accuracy10: 0.5311 - 205s/epoch - 34ms/step
Epoch 15/50
6073/6073 - 202s - loss: 2.7038 - accuracy10: 0.5496 - val_loss: 3.0420 - val_accuracy10: 0.5315 - 202s/epoch - 33ms/step
Epoch 16/50
6073/6073 - 198s - loss: 2.7001 - accuracy10: 0.5506 - val_loss: 3.0345 - val_accuracy10: 0.5328 - 198s/epoch - 33ms/step
Epoch 17/50
6073/6073 - 203s - loss: 2.6974 - accuracy10: 0.5509 - val_loss: 3.0299 - val_accuracy10: 0.5303 - 203s/epoch - 33ms/step
Epoch 18/50
6073/6073 - 206s - loss: 2.6940 - accuracy10: 0.5515 - val_loss: 3.0340 - val_accuracy10: 0.5328 - 206s/epoch - 34ms/step
Epoch 19/50
6073/6073 - 199s - loss: 2.6914 - accuracy10: 0.5519 - val_loss: 3.0216 - val_accuracy10: 0.5317 - 199s/epoch - 33ms/step
Epoch 20/50
6073/6073 - 187s - loss: 2.6889 - accuracy10: 0.5529 - val_loss: 3.0298 - val_accuracy10: 0.5308 - 187s/epoch - 31ms/step
Epoch 21/50
6073/6073 - 195s - loss: 2.6861 - accuracy10: 0.5532 - val_loss: 3.0253 - val_accuracy10: 0.5292 - 195s/epoch - 32ms/step
Epoch 22/50
6073/6073 - 198s - loss: 2.6835 - accuracy10: 0.5537 - val_loss: 3.0226 - val_accuracy10: 0.5305 - 198s/epoch - 33ms/step
Epoch 23/50
6073/6073 - 196s - loss: 2.6815 - accuracy10: 0.5540 - val_loss: 3.0166 - val_accuracy10: 0.5313 - 196s/epoch - 32ms/step
Epoch 24/50
6073/6073 - 200s - loss: 2.6790 - accuracy10: 0.5544 - val_loss: 3.0128 - val_accuracy10: 0.5329 - 200s/epoch - 33ms/step
Epoch 25/50
6073/6073 - 178s - loss: 2.6776 - accuracy10: 0.5545 - val_loss: 3.0352 - val_accuracy10: 0.5312 - 178s/epoch - 29ms/step
Epoch 26/50
6073/6073 - 170s - loss: 2.6747 - accuracy10: 0.5552 - val_loss: 3.0089 - val_accuracy10: 0.5330 - 170s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 168s - loss: 2.6730 - accuracy10: 0.5554 - val_loss: 3.0143 - val_accuracy10: 0.5320 - 168s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 166s - loss: 2.6708 - accuracy10: 0.5556 - val_loss: 3.0233 - val_accuracy10: 0.5302 - 166s/epoch - 27ms/step
Epoch 29/50
6073/6073 - 166s - loss: 2.6689 - accuracy10: 0.5563 - val_loss: 3.0154 - val_accuracy10: 0.5323 - 166s/epoch - 27ms/step
Epoch 30/50
6073/6073 - 165s - loss: 2.6671 - accuracy10: 0.5567 - val_loss: 3.0193 - val_accuracy10: 0.5318 - 165s/epoch - 27ms/step
Epoch 31/50
6073/6073 - 166s - loss: 2.6652 - accuracy10: 0.5568 - val_loss: 3.0088 - val_accuracy10: 0.5321 - 166s/epoch - 27ms/step
Epoch 32/50
6073/6073 - 187s - loss: 2.6634 - accuracy10: 0.5573 - val_loss: 3.0118 - val_accuracy10: 0.5299 - 187s/epoch - 31ms/step
Epoch 33/50
6073/6073 - 188s - loss: 2.6621 - accuracy10: 0.5576 - val_loss: 3.0182 - val_accuracy10: 0.5326 - 188s/epoch - 31ms/step
Epoch 34/50
6073/6073 - 189s - loss: 2.6603 - accuracy10: 0.5574 - val_loss: 3.0134 - val_accuracy10: 0.5312 - 189s/epoch - 31ms/step
Epoch 35/50
6073/6073 - 191s - loss: 2.6585 - accuracy10: 0.5580 - val_loss: 3.0092 - val_accuracy10: 0.5315 - 191s/epoch - 31ms/step
Epoch 36/50
6073/6073 - 189s - loss: 2.6571 - accuracy10: 0.5584 - val_loss: 3.0050 - val_accuracy10: 0.5329 - 189s/epoch - 31ms/step
Epoch 37/50
6073/6073 - 192s - loss: 2.6554 - accuracy10: 0.5587 - val_loss: 3.0110 - val_accuracy10: 0.5319 - 192s/epoch - 32ms/step
Epoch 38/50
6073/6073 - 188s - loss: 2.6544 - accuracy10: 0.5589 - val_loss: 3.0054 - val_accuracy10: 0.5337 - 188s/epoch - 31ms/step
Epoch 39/50
6073/6073 - 191s - loss: 2.6526 - accuracy10: 0.5591 - val_loss: 3.0240 - val_accuracy10: 0.5312 - 191s/epoch - 31ms/step
Epoch 40/50
6073/6073 - 193s - loss: 2.6512 - accuracy10: 0.5595 - val_loss: 3.0088 - val_accuracy10: 0.5339 - 193s/epoch - 32ms/step
Epoch 41/50
6073/6073 - 193s - loss: 2.6494 - accuracy10: 0.5598 - val_loss: 3.0246 - val_accuracy10: 0.5326 - 193s/epoch - 32ms/step
Epoch 42/50
6073/6073 - 196s - loss: 2.6484 - accuracy10: 0.5599 - val_loss: 3.0111 - val_accuracy10: 0.5332 - 196s/epoch - 32ms/step
Epoch 43/50
6073/6073 - 183s - loss: 2.6471 - accuracy10: 0.5602 - val_loss: 3.0234 - val_accuracy10: 0.5289 - 183s/epoch - 30ms/step
Epoch 44/50
6073/6073 - 191s - loss: 2.6459 - accuracy10: 0.5602 - val_loss: 3.0245 - val_accuracy10: 0.5329 - 191s/epoch - 32ms/step
Epoch 45/50
6073/6073 - 180s - loss: 2.6441 - accuracy10: 0.5606 - val_loss: 3.0227 - val_accuracy10: 0.5331 - 180s/epoch - 30ms/step
Epoch 46/50
6073/6073 - 185s - loss: 2.6427 - accuracy10: 0.5609 - val_loss: 3.0181 - val_accuracy10: 0.5327 - 185s/epoch - 30ms/step
testing model: results/AAPL/W1/deepOF_L2/h10
Evaluating performance on  test set...
21353/21353 - 319s - 319s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99075377
{'0': {'precision': 0.5140748734866174, 'recall': 0.5482520759298481, 'f1-score': 0.5306136999108, 'support': 1805456}, '1': {'precision': 0.5334282209182528, 'recall': 0.3842475225961015, 'f1-score': 0.4467121939732919, 'support': 1836600}, '2': {'precision': 0.4889237088857877, 'recall': 0.5944190080234366, 'f1-score': 0.5365348222660025, 'support': 1824156}, 'accuracy': 0.508554552951843, 'macro avg': {'precision': 0.5121422677635526, 'recall': 0.5089728688497954, 'f1-score': 0.5046202387166981, 'support': 5466212}, 'weighted avg': {'precision': 0.512184114416049, 'recall': 0.508554552951843, 'f1-score': 0.5043994852162638, 'support': 5466212}}
[[ 989845  307012  508599]
 [ 506048  705709  624843]
 [ 429595  310248 1084313]]
Evaluating performance on  train set...
6073/6073 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90826166
{'0': {'precision': 0.4906792456554133, 'recall': 0.5051534346918353, 'f1-score': 0.49781115074150556, 'support': 393718}, '1': {'precision': 0.6448231802819223, 'recall': 0.6133556890860191, 'f1-score': 0.6286959282333888, 'support': 765202}, '2': {'precision': 0.4868817949454268, 'recall': 0.5185437008540743, 'f1-score': 0.5022142145474752, 'support': 395633}, 'accuracy': 0.5618219513905284, 'macro avg': {'precision': 0.5407947402942542, 'recall': 0.5456842748773095, 'f1-score': 0.5429070978407898, 'support': 1554553}, 'weighted avg': {'precision': 0.56558749918381, 'recall': 0.5618219513905284, 'f1-score': 0.5633575109164827, 'support': 1554553}}
[[198888 130173  64657]
 [144310 469341 151551]
 [ 62134 128346 205153]]
Evaluating performance on  val set...
1786/1786 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9471979
{'0': {'precision': 0.5051561822980265, 'recall': 0.506276943483822, 'f1-score': 0.5057159419375445, 'support': 126654}, '1': {'precision': 0.6013877966927687, 'recall': 0.5347084080121325, 'f1-score': 0.5660913398633186, 'support': 203092}, '2': {'precision': 0.47286599012579916, 'recall': 0.5553724714781162, 'f1-score': 0.5108090456069195, 'support': 127446}, 'accuracy': 0.5325924338133651, 'macro avg': {'precision': 0.5264699897055315, 'recall': 0.5321192743246903, 'f1-score': 0.5275387758025943, 'support': 457192}, 'weighted avg': {'precision': 0.5389026503006934, 'recall': 0.5325924338133651, 'f1-score': 0.5339554037080665, 'support': 457192}}
[[ 64122  36642  25890]
 [ 41484 108595  53013]
 [ 21329  35337  70780]]
training model: results/AAPL/W1/deepOF_L2/h20
Epoch 1/50
6073/6073 - 171s - loss: 3.0005 - accuracy20: 0.4928 - val_loss: 3.1766 - val_accuracy20: 0.4579 - 171s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 164s - loss: 2.9112 - accuracy20: 0.5190 - val_loss: 3.1667 - val_accuracy20: 0.4626 - 164s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 165s - loss: 2.8887 - accuracy20: 0.5240 - val_loss: 3.1706 - val_accuracy20: 0.4651 - 165s/epoch - 27ms/step
Epoch 4/50
6073/6073 - 167s - loss: 2.8756 - accuracy20: 0.5269 - val_loss: 3.1547 - val_accuracy20: 0.4700 - 167s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 166s - loss: 2.8664 - accuracy20: 0.5288 - val_loss: 3.1513 - val_accuracy20: 0.4715 - 166s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 167s - loss: 2.8592 - accuracy20: 0.5306 - val_loss: 3.1450 - val_accuracy20: 0.4735 - 167s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 167s - loss: 2.8528 - accuracy20: 0.5317 - val_loss: 3.1441 - val_accuracy20: 0.4746 - 167s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 166s - loss: 2.8474 - accuracy20: 0.5332 - val_loss: 3.1378 - val_accuracy20: 0.4774 - 166s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 164s - loss: 2.8425 - accuracy20: 0.5344 - val_loss: 3.1271 - val_accuracy20: 0.4795 - 164s/epoch - 27ms/step
Epoch 10/50
6073/6073 - 164s - loss: 2.8383 - accuracy20: 0.5355 - val_loss: 3.1208 - val_accuracy20: 0.4804 - 164s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 169s - loss: 2.8346 - accuracy20: 0.5361 - val_loss: 3.1113 - val_accuracy20: 0.4823 - 169s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 164s - loss: 2.8314 - accuracy20: 0.5369 - val_loss: 3.1169 - val_accuracy20: 0.4832 - 164s/epoch - 27ms/step
Epoch 13/50
6073/6073 - 166s - loss: 2.8280 - accuracy20: 0.5378 - val_loss: 3.1186 - val_accuracy20: 0.4826 - 166s/epoch - 27ms/step
Epoch 14/50
6073/6073 - 166s - loss: 2.8250 - accuracy20: 0.5387 - val_loss: 3.1047 - val_accuracy20: 0.4859 - 166s/epoch - 27ms/step
Epoch 15/50
6073/6073 - 167s - loss: 2.8223 - accuracy20: 0.5394 - val_loss: 3.1117 - val_accuracy20: 0.4856 - 167s/epoch - 28ms/step
Epoch 16/50
6073/6073 - 166s - loss: 2.8196 - accuracy20: 0.5400 - val_loss: 3.1083 - val_accuracy20: 0.4865 - 166s/epoch - 27ms/step
Epoch 17/50
6073/6073 - 166s - loss: 2.8173 - accuracy20: 0.5402 - val_loss: 3.1020 - val_accuracy20: 0.4869 - 166s/epoch - 27ms/step
Epoch 18/50
6073/6073 - 167s - loss: 2.8146 - accuracy20: 0.5410 - val_loss: 3.1017 - val_accuracy20: 0.4875 - 167s/epoch - 27ms/step
Epoch 19/50
6073/6073 - 166s - loss: 2.8125 - accuracy20: 0.5417 - val_loss: 3.0944 - val_accuracy20: 0.4888 - 166s/epoch - 27ms/step
Epoch 20/50
6073/6073 - 168s - loss: 2.8102 - accuracy20: 0.5419 - val_loss: 3.0913 - val_accuracy20: 0.4900 - 168s/epoch - 28ms/step
Epoch 21/50
6073/6073 - 168s - loss: 2.8085 - accuracy20: 0.5423 - val_loss: 3.0852 - val_accuracy20: 0.4908 - 168s/epoch - 28ms/step
Epoch 22/50
6073/6073 - 165s - loss: 2.8057 - accuracy20: 0.5431 - val_loss: 3.0883 - val_accuracy20: 0.4912 - 165s/epoch - 27ms/step
Epoch 23/50
6073/6073 - 167s - loss: 2.8039 - accuracy20: 0.5433 - val_loss: 3.0848 - val_accuracy20: 0.4915 - 167s/epoch - 27ms/step
Epoch 24/50
6073/6073 - 167s - loss: 2.8023 - accuracy20: 0.5438 - val_loss: 3.0808 - val_accuracy20: 0.4922 - 167s/epoch - 27ms/step
Epoch 25/50
6073/6073 - 166s - loss: 2.8002 - accuracy20: 0.5443 - val_loss: 3.0761 - val_accuracy20: 0.4936 - 166s/epoch - 27ms/step
Epoch 26/50
6073/6073 - 165s - loss: 2.7983 - accuracy20: 0.5447 - val_loss: 3.0808 - val_accuracy20: 0.4927 - 165s/epoch - 27ms/step
Epoch 27/50
6073/6073 - 166s - loss: 2.7967 - accuracy20: 0.5452 - val_loss: 3.0803 - val_accuracy20: 0.4937 - 166s/epoch - 27ms/step
Epoch 28/50
6073/6073 - 167s - loss: 2.7952 - accuracy20: 0.5455 - val_loss: 3.0770 - val_accuracy20: 0.4939 - 167s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 166s - loss: 2.7933 - accuracy20: 0.5459 - val_loss: 3.0725 - val_accuracy20: 0.4948 - 166s/epoch - 27ms/step
Epoch 30/50
6073/6073 - 165s - loss: 2.7919 - accuracy20: 0.5462 - val_loss: 3.0757 - val_accuracy20: 0.4938 - 165s/epoch - 27ms/step
Epoch 31/50
6073/6073 - 165s - loss: 2.7901 - accuracy20: 0.5468 - val_loss: 3.0779 - val_accuracy20: 0.4939 - 165s/epoch - 27ms/step
Epoch 32/50
6073/6073 - 168s - loss: 2.7883 - accuracy20: 0.5468 - val_loss: 3.0687 - val_accuracy20: 0.4956 - 168s/epoch - 28ms/step
Epoch 33/50
6073/6073 - 167s - loss: 2.7869 - accuracy20: 0.5471 - val_loss: 3.0814 - val_accuracy20: 0.4941 - 167s/epoch - 27ms/step
Epoch 34/50
6073/6073 - 165s - loss: 2.7854 - accuracy20: 0.5477 - val_loss: 3.0737 - val_accuracy20: 0.4946 - 165s/epoch - 27ms/step
Epoch 35/50
6073/6073 - 165s - loss: 2.7838 - accuracy20: 0.5482 - val_loss: 3.0717 - val_accuracy20: 0.4957 - 165s/epoch - 27ms/step
Epoch 36/50
6073/6073 - 166s - loss: 2.7822 - accuracy20: 0.5483 - val_loss: 3.0712 - val_accuracy20: 0.4961 - 166s/epoch - 27ms/step
Epoch 37/50
6073/6073 - 170s - loss: 2.7807 - accuracy20: 0.5489 - val_loss: 3.0768 - val_accuracy20: 0.4968 - 170s/epoch - 28ms/step
Epoch 38/50
6073/6073 - 172s - loss: 2.7791 - accuracy20: 0.5489 - val_loss: 3.0797 - val_accuracy20: 0.4956 - 172s/epoch - 28ms/step
Epoch 39/50
6073/6073 - 172s - loss: 2.7778 - accuracy20: 0.5493 - val_loss: 3.0728 - val_accuracy20: 0.4966 - 172s/epoch - 28ms/step
Epoch 40/50
6073/6073 - 164s - loss: 2.7765 - accuracy20: 0.5494 - val_loss: 3.0657 - val_accuracy20: 0.4976 - 164s/epoch - 27ms/step
Epoch 41/50
6073/6073 - 167s - loss: 2.7754 - accuracy20: 0.5498 - val_loss: 3.0649 - val_accuracy20: 0.4986 - 167s/epoch - 28ms/step
Epoch 42/50
6073/6073 - 164s - loss: 2.7739 - accuracy20: 0.5501 - val_loss: 3.0563 - val_accuracy20: 0.4993 - 164s/epoch - 27ms/step
Epoch 43/50
6073/6073 - 165s - loss: 2.7725 - accuracy20: 0.5503 - val_loss: 3.0644 - val_accuracy20: 0.4983 - 165s/epoch - 27ms/step
Epoch 44/50
6073/6073 - 168s - loss: 2.7712 - accuracy20: 0.5507 - val_loss: 3.0742 - val_accuracy20: 0.4968 - 168s/epoch - 28ms/step
Epoch 45/50
6073/6073 - 167s - loss: 2.7695 - accuracy20: 0.5508 - val_loss: 3.0658 - val_accuracy20: 0.4978 - 167s/epoch - 27ms/step
Epoch 46/50
6073/6073 - 165s - loss: 2.7682 - accuracy20: 0.5512 - val_loss: 3.0635 - val_accuracy20: 0.4988 - 165s/epoch - 27ms/step
Epoch 47/50
6073/6073 - 164s - loss: 2.7668 - accuracy20: 0.5519 - val_loss: 3.0610 - val_accuracy20: 0.4987 - 164s/epoch - 27ms/step
Epoch 48/50
6073/6073 - 166s - loss: 2.7656 - accuracy20: 0.5520 - val_loss: 3.0614 - val_accuracy20: 0.4989 - 166s/epoch - 27ms/step
Epoch 49/50
6073/6073 - 165s - loss: 2.7643 - accuracy20: 0.5524 - val_loss: 3.0611 - val_accuracy20: 0.4994 - 165s/epoch - 27ms/step
Epoch 50/50
6073/6073 - 166s - loss: 2.7637 - accuracy20: 0.5523 - val_loss: 3.0721 - val_accuracy20: 0.4980 - 166s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h20
Evaluating performance on  test set...
21353/21353 - 292s - 292s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0091691
{'0': {'precision': 0.5317880707388628, 'recall': 0.5522119883109955, 'f1-score': 0.5418076234427012, 'support': 2118230}, '1': {'precision': 0.385590157917628, 'recall': 0.3956935099843204, 'f1-score': 0.39057650702352315, 'support': 1205390}, '2': {'precision': 0.5382826145330117, 'recall': 0.5099094928012426, 'f1-score': 0.5237120429351377, 'support': 2142592}, 'accuracy': 0.5011157635305765, 'macro avg': {'precision': 0.48522028106316756, 'recall': 0.48593833036551953, 'f1-score': 0.4853653911337874, 'support': 5466212}, 'weighted avg': {'precision': 0.5020946844306489, 'recall': 0.5011157635305765, 'f1-score': 0.501365737644753, 'support': 5466212}}
[[1169712  370648  577870]
 [ 369168  476965  359257]
 [ 660703  389361 1092528]]
Evaluating performance on  train set...
6073/6073 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97942686
{'0': {'precision': 0.5287159774693053, 'recall': 0.46375527391859267, 'f1-score': 0.49410967343089734, 'support': 492044}, '1': {'precision': 0.498620201311636, 'recall': 0.6637794179574419, 'f1-score': 0.5694665096614158, 'support': 567553}, '2': {'precision': 0.5555836796681718, 'recall': 0.4124245387468785, 'f1-score': 0.4734181765473257, 'support': 494956}, 'accuracy': 0.5204389943604367, 'macro avg': {'precision': 0.527639952816371, 'recall': 0.513319743540971, 'f1-score': 0.5123314532132129, 'support': 1554553}, 'weighted avg': {'precision': 0.5262827264729922, 'recall': 0.5204389943604367, 'f1-score': 0.5150337705453953, 'support': 1554553}}
[[228188 188991  74865]
 [102401 376730  88422]
 [101000 189824 204132]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0062983
{'0': {'precision': 0.5290957923008057, 'recall': 0.48372377791383364, 'f1-score': 0.5053935035552682, 'support': 155165}, '1': {'precision': 0.45139225214537976, 'recall': 0.5708436272047236, 'f1-score': 0.5041388112313115, 'support': 145313}, '2': {'precision': 0.5312846784123558, 'recall': 0.4460290720675881, 'f1-score': 0.4849382544748162, 'support': 156714}, 'accuracy': 0.49849297450524066, 'macro avg': {'precision': 0.503924240952847, 'recall': 0.5001988257287151, 'f1-score': 0.4981568564204653, 'support': 457192}, 'weighted avg': {'precision': 0.5051489484528819, 'recall': 0.49849297450524066, 'f1-score': 0.4979831660820292, 'support': 457192}}
[[75057 49839 30269]
 [30964 82951 31398]
 [35838 50977 69899]]
training model: results/AAPL/W1/deepOF_L2/h30
Epoch 1/50
6073/6073 - 171s - loss: 3.0677 - accuracy30: 0.4736 - val_loss: 3.2173 - val_accuracy30: 0.4178 - 171s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 168s - loss: 2.9937 - accuracy30: 0.4972 - val_loss: 3.2023 - val_accuracy30: 0.4257 - 168s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 165s - loss: 2.9741 - accuracy30: 0.5025 - val_loss: 3.1968 - val_accuracy30: 0.4276 - 165s/epoch - 27ms/step
Epoch 4/50
6073/6073 - 171s - loss: 2.9636 - accuracy30: 0.5045 - val_loss: 3.1929 - val_accuracy30: 0.4295 - 171s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 166s - loss: 2.9563 - accuracy30: 0.5065 - val_loss: 3.1881 - val_accuracy30: 0.4327 - 166s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 166s - loss: 2.9505 - accuracy30: 0.5081 - val_loss: 3.1899 - val_accuracy30: 0.4335 - 166s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 168s - loss: 2.9458 - accuracy30: 0.5092 - val_loss: 3.1921 - val_accuracy30: 0.4356 - 168s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 167s - loss: 2.9419 - accuracy30: 0.5102 - val_loss: 3.1834 - val_accuracy30: 0.4381 - 167s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 168s - loss: 2.9380 - accuracy30: 0.5115 - val_loss: 3.1807 - val_accuracy30: 0.4389 - 168s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 169s - loss: 2.9347 - accuracy30: 0.5124 - val_loss: 3.1804 - val_accuracy30: 0.4399 - 169s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 165s - loss: 2.9319 - accuracy30: 0.5131 - val_loss: 3.1792 - val_accuracy30: 0.4417 - 165s/epoch - 27ms/step
Epoch 12/50
6073/6073 - 167s - loss: 2.9290 - accuracy30: 0.5138 - val_loss: 3.1743 - val_accuracy30: 0.4436 - 167s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 168s - loss: 2.9266 - accuracy30: 0.5144 - val_loss: 3.1731 - val_accuracy30: 0.4436 - 168s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 167s - loss: 2.9243 - accuracy30: 0.5148 - val_loss: 3.1728 - val_accuracy30: 0.4439 - 167s/epoch - 27ms/step
Epoch 15/50
6073/6073 - 166s - loss: 2.9221 - accuracy30: 0.5155 - val_loss: 3.1610 - val_accuracy30: 0.4471 - 166s/epoch - 27ms/step
Epoch 16/50
6073/6073 - 164s - loss: 2.9200 - accuracy30: 0.5163 - val_loss: 3.1654 - val_accuracy30: 0.4470 - 164s/epoch - 27ms/step
Epoch 17/50
6073/6073 - 166s - loss: 2.9182 - accuracy30: 0.5165 - val_loss: 3.1630 - val_accuracy30: 0.4485 - 166s/epoch - 27ms/step
Epoch 18/50
6073/6073 - 167s - loss: 2.9160 - accuracy30: 0.5175 - val_loss: 3.1690 - val_accuracy30: 0.4463 - 167s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 166s - loss: 2.9144 - accuracy30: 0.5176 - val_loss: 3.1657 - val_accuracy30: 0.4486 - 166s/epoch - 27ms/step
Epoch 20/50
6073/6073 - 166s - loss: 2.9125 - accuracy30: 0.5182 - val_loss: 3.1634 - val_accuracy30: 0.4489 - 166s/epoch - 27ms/step
Epoch 21/50
6073/6073 - 167s - loss: 2.9108 - accuracy30: 0.5187 - val_loss: 3.1649 - val_accuracy30: 0.4492 - 167s/epoch - 27ms/step
Epoch 22/50
6073/6073 - 166s - loss: 2.9090 - accuracy30: 0.5191 - val_loss: 3.1577 - val_accuracy30: 0.4514 - 166s/epoch - 27ms/step
Epoch 23/50
6073/6073 - 165s - loss: 2.9074 - accuracy30: 0.5194 - val_loss: 3.1555 - val_accuracy30: 0.4523 - 165s/epoch - 27ms/step
Epoch 24/50
6073/6073 - 167s - loss: 2.9057 - accuracy30: 0.5199 - val_loss: 3.1512 - val_accuracy30: 0.4523 - 167s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 168s - loss: 2.9042 - accuracy30: 0.5203 - val_loss: 3.1529 - val_accuracy30: 0.4531 - 168s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 170s - loss: 2.9029 - accuracy30: 0.5208 - val_loss: 3.1532 - val_accuracy30: 0.4535 - 170s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 171s - loss: 2.9009 - accuracy30: 0.5209 - val_loss: 3.1487 - val_accuracy30: 0.4537 - 171s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 172s - loss: 2.8997 - accuracy30: 0.5215 - val_loss: 3.1509 - val_accuracy30: 0.4544 - 172s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 163s - loss: 2.8981 - accuracy30: 0.5222 - val_loss: 3.1532 - val_accuracy30: 0.4536 - 163s/epoch - 27ms/step
Epoch 30/50
6073/6073 - 164s - loss: 2.8964 - accuracy30: 0.5225 - val_loss: 3.1480 - val_accuracy30: 0.4550 - 164s/epoch - 27ms/step
Epoch 31/50
6073/6073 - 166s - loss: 2.8947 - accuracy30: 0.5229 - val_loss: 3.1555 - val_accuracy30: 0.4541 - 166s/epoch - 27ms/step
Epoch 32/50
6073/6073 - 165s - loss: 2.8935 - accuracy30: 0.5237 - val_loss: 3.1459 - val_accuracy30: 0.4564 - 165s/epoch - 27ms/step
Epoch 33/50
6073/6073 - 168s - loss: 2.8918 - accuracy30: 0.5238 - val_loss: 3.1438 - val_accuracy30: 0.4567 - 168s/epoch - 28ms/step
Epoch 34/50
6073/6073 - 170s - loss: 2.8906 - accuracy30: 0.5243 - val_loss: 3.1499 - val_accuracy30: 0.4565 - 170s/epoch - 28ms/step
Epoch 35/50
6073/6073 - 166s - loss: 2.8891 - accuracy30: 0.5246 - val_loss: 3.1470 - val_accuracy30: 0.4575 - 166s/epoch - 27ms/step
Epoch 36/50
6073/6073 - 165s - loss: 2.8877 - accuracy30: 0.5249 - val_loss: 3.1450 - val_accuracy30: 0.4582 - 165s/epoch - 27ms/step
Epoch 37/50
6073/6073 - 166s - loss: 2.8867 - accuracy30: 0.5253 - val_loss: 3.1548 - val_accuracy30: 0.4566 - 166s/epoch - 27ms/step
Epoch 38/50
6073/6073 - 168s - loss: 2.8848 - accuracy30: 0.5258 - val_loss: 3.1526 - val_accuracy30: 0.4569 - 168s/epoch - 28ms/step
Epoch 39/50
6073/6073 - 167s - loss: 2.8837 - accuracy30: 0.5257 - val_loss: 3.1448 - val_accuracy30: 0.4601 - 167s/epoch - 28ms/step
Epoch 40/50
6073/6073 - 165s - loss: 2.8821 - accuracy30: 0.5264 - val_loss: 3.1490 - val_accuracy30: 0.4582 - 165s/epoch - 27ms/step
Epoch 41/50
6073/6073 - 166s - loss: 2.8804 - accuracy30: 0.5267 - val_loss: 3.1564 - val_accuracy30: 0.4560 - 166s/epoch - 27ms/step
Epoch 42/50
6073/6073 - 165s - loss: 2.8796 - accuracy30: 0.5273 - val_loss: 3.1573 - val_accuracy30: 0.4566 - 165s/epoch - 27ms/step
Epoch 43/50
6073/6073 - 166s - loss: 2.8782 - accuracy30: 0.5275 - val_loss: 3.1578 - val_accuracy30: 0.4582 - 166s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h30
Evaluating performance on  test set...
21353/21353 - 298s - 298s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0487386
{'0': {'precision': 0.5130748524087912, 'recall': 0.5451352359168385, 'f1-score': 0.5286193805871116, 'support': 2161482}, '1': {'precision': 0.3149698976499364, 'recall': 0.4049293928755799, 'f1-score': 0.35432892102552144, 'support': 1125453}, '2': {'precision': 0.5362703879626346, 'recall': 0.42393417633462843, 'f1-score': 0.47353106549743396, 'support': 2179277}, 'accuracy': 0.46794727317564705, 'macro avg': {'precision': 0.4547717126737874, 'recall': 0.4579996017090156, 'f1-score': 0.452159789036689, 'support': 5466212}, 'weighted avg': {'precision': 0.48153412209810365, 'recall': 0.46794727317564705, 'f1-score': 0.47077156593435804, 'support': 5466212}}
[[1178300  482422  500760]
 [ 371585  455729  298139]
 [ 746661  508746  923870]]
Evaluating performance on  train set...
6073/6073 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0229231
{'0': {'precision': 0.5162611561678332, 'recall': 0.4060652783495545, 'f1-score': 0.45458033562715144, 'support': 514964}, '1': {'precision': 0.4318407935634068, 'recall': 0.6721487541379834, 'f1-score': 0.5258405788061185, 'support': 520483}, '2': {'precision': 0.544521052476502, 'recall': 0.3560062877331412, 'f1-score': 0.4305320001490979, 'support': 519106}, 'accuracy': 0.4784372099246536, 'macro avg': {'precision': 0.497541000735914, 'recall': 0.47807344007355973, 'f1-score': 0.4703176381941226, 'support': 1554553}, 'weighted avg': {'precision': 0.4974329258944158, 'recall': 0.4784372099246536, 'f1-score': 0.47040875055661846, 'support': 1554553}}
[[209109 229455  76400]
 [ 92456 349842  78185]
 [103480 230821 184805]]
Evaluating performance on  val set...
1786/1786 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475376
{'0': {'precision': 0.5187280069003947, 'recall': 0.4213028976702087, 'f1-score': 0.4649668672534886, 'support': 161302}, '1': {'precision': 0.38072876362045843, 'recall': 0.5943603634699222, 'f1-score': 0.4641423641019331, 'support': 133271}, '2': {'precision': 0.5224998730255472, 'recall': 0.37956819313856316, 'f1-score': 0.4397103503791589, 'support': 162619}, 'accuracy': 0.4569043202855693, 'macro avg': {'precision': 0.47398554784880015, 'recall': 0.46507715142623135, 'f1-score': 0.4562731939115268, 'support': 457192}, 'weighted avg': {'precision': 0.479842986922455, 'recall': 0.4569043202855693, 'f1-score': 0.4557430140865531, 'support': 457192}}
[[67957 63699 29646]
 [27297 79211 26763]
 [35753 65141 61725]]
training model: results/AAPL/W1/deepOF_L2/h50
Epoch 1/50
6073/6073 - 169s - loss: 3.1567 - accuracy50: 0.4424 - val_loss: 3.2370 - val_accuracy50: 0.3850 - 169s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 164s - loss: 3.1083 - accuracy50: 0.4626 - val_loss: 3.2329 - val_accuracy50: 0.3941 - 164s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 166s - loss: 3.0920 - accuracy50: 0.4678 - val_loss: 3.2254 - val_accuracy50: 0.3977 - 166s/epoch - 27ms/step
Epoch 4/50
6073/6073 - 165s - loss: 3.0835 - accuracy50: 0.4706 - val_loss: 3.2284 - val_accuracy50: 0.3992 - 165s/epoch - 27ms/step
Epoch 5/50
6073/6073 - 166s - loss: 3.0777 - accuracy50: 0.4727 - val_loss: 3.2271 - val_accuracy50: 0.4005 - 166s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 165s - loss: 3.0731 - accuracy50: 0.4737 - val_loss: 3.2260 - val_accuracy50: 0.4025 - 165s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 168s - loss: 3.0699 - accuracy50: 0.4747 - val_loss: 3.2236 - val_accuracy50: 0.4020 - 168s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 165s - loss: 3.0668 - accuracy50: 0.4754 - val_loss: 3.2303 - val_accuracy50: 0.4026 - 165s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 167s - loss: 3.0640 - accuracy50: 0.4764 - val_loss: 3.2278 - val_accuracy50: 0.4033 - 167s/epoch - 27ms/step
Epoch 10/50
6073/6073 - 166s - loss: 3.0620 - accuracy50: 0.4769 - val_loss: 3.2304 - val_accuracy50: 0.4033 - 166s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 164s - loss: 3.0598 - accuracy50: 0.4778 - val_loss: 3.2252 - val_accuracy50: 0.4050 - 164s/epoch - 27ms/step
Epoch 12/50
6073/6073 - 167s - loss: 3.0577 - accuracy50: 0.4784 - val_loss: 3.2260 - val_accuracy50: 0.4069 - 167s/epoch - 27ms/step
Epoch 13/50
6073/6073 - 165s - loss: 3.0557 - accuracy50: 0.4790 - val_loss: 3.2302 - val_accuracy50: 0.4066 - 165s/epoch - 27ms/step
Epoch 14/50
6073/6073 - 166s - loss: 3.0540 - accuracy50: 0.4795 - val_loss: 3.2283 - val_accuracy50: 0.4073 - 166s/epoch - 27ms/step
Epoch 15/50
6073/6073 - 165s - loss: 3.0526 - accuracy50: 0.4801 - val_loss: 3.2295 - val_accuracy50: 0.4078 - 165s/epoch - 27ms/step
Epoch 16/50
6073/6073 - 167s - loss: 3.0506 - accuracy50: 0.4804 - val_loss: 3.2273 - val_accuracy50: 0.4081 - 167s/epoch - 27ms/step
Epoch 17/50
6073/6073 - 168s - loss: 3.0490 - accuracy50: 0.4810 - val_loss: 3.2306 - val_accuracy50: 0.4068 - 168s/epoch - 28ms/step
testing model: results/AAPL/W1/deepOF_L2/h50
Evaluating performance on  test set...
21353/21353 - 311s - 311s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868887
{'0': {'precision': 0.4966763539694, 'recall': 0.3803117065762133, 'f1-score': 0.430774010028451, 'support': 2081958}, '1': {'precision': 0.2682473804507809, 'recall': 0.45898135032041143, 'f1-score': 0.3386019822639541, 'support': 1286939}, '2': {'precision': 0.49583120762047106, 'recall': 0.3948152757215774, 'f1-score': 0.43959469578427024, 'support': 2097315}, 'accuracy': 0.40439814628484955, 'macro avg': {'precision': 0.420251647346884, 'recall': 0.4113694442060674, 'f1-score': 0.4029902293588918, 'support': 5466212}, 'weighted avg': {'precision': 0.4425718492656157, 'recall': 0.40439814628484955, 'f1-score': 0.4124578487282219, 'support': 5466212}}
[[791793 804219 485946]
 [340228 590681 356030]
 [462162 807101 828052]]
Evaluating performance on  train set...
6073/6073 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0638032
{'0': {'precision': 0.4832106681115576, 'recall': 0.3088747741524584, 'f1-score': 0.3768572884117411, 'support': 519709}, '1': {'precision': 0.3698529744002874, 'recall': 0.6589760405907972, 'f1-score': 0.47378960958472366, 'support': 509278}, '2': {'precision': 0.501843120445778, 'recall': 0.3007386322555112, 'f1-score': 0.3760953027943383, 'support': 525566}, 'accuracy': 0.4208187176635341, 'macro avg': {'precision': 0.451635587652541, 'recall': 0.42286314899958893, 'f1-score': 0.4089140669302677, 'support': 1554553}, 'weighted avg': {'precision': 0.45237351035984286, 'recall': 0.4208187176635341, 'f1-score': 0.4083551047803939, 'support': 1554553}}
[[160525 286262  72922]
 [ 89701 335602  83975]
 [ 81979 285529 158058]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0770481
{'0': {'precision': 0.5001713640579009, 'recall': 0.30752020427388566, 'f1-score': 0.3808701392407007, 'support': 161352}, '1': {'precision': 0.32410382009605904, 'recall': 0.6138853954076829, 'f1-score': 0.4242321733858272, 'support': 132787}, '2': {'precision': 0.49403621473383674, 'recall': 0.3226128927403973, 'f1-score': 0.3903327656764207, 'support': 163053}, 'accuracy': 0.4018836725052057, 'macro avg': {'precision': 0.43943713296259884, 'recall': 0.414672830807322, 'f1-score': 0.3984783594343162, 'support': 457192}, 'weighted avg': {'precision': 0.446846206437475, 'recall': 0.4018836725052057, 'f1-score': 0.3968389752138856, 'support': 457192}}
[[49619 84953 26780]
 [24178 81516 27093]
 [25407 85043 52603]]
training model: results/AAPL/W1/deepOF_L2/h100
Epoch 1/50
6073/6073 - 170s - loss: 3.2089 - accuracy100: 0.4177 - val_loss: 3.3352 - val_accuracy100: 0.3320 - 170s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 164s - loss: 3.1844 - accuracy100: 0.4301 - val_loss: 3.3480 - val_accuracy100: 0.3326 - 164s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 167s - loss: 3.1729 - accuracy100: 0.4357 - val_loss: 3.3354 - val_accuracy100: 0.3397 - 167s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 164s - loss: 3.1667 - accuracy100: 0.4383 - val_loss: 3.3401 - val_accuracy100: 0.3394 - 164s/epoch - 27ms/step
Epoch 5/50
6073/6073 - 164s - loss: 3.1612 - accuracy100: 0.4406 - val_loss: 3.3415 - val_accuracy100: 0.3428 - 164s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 167s - loss: 3.1565 - accuracy100: 0.4424 - val_loss: 3.3394 - val_accuracy100: 0.3459 - 167s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 165s - loss: 3.1527 - accuracy100: 0.4442 - val_loss: 3.3511 - val_accuracy100: 0.3461 - 165s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 167s - loss: 3.1498 - accuracy100: 0.4453 - val_loss: 3.3568 - val_accuracy100: 0.3471 - 167s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 167s - loss: 3.1479 - accuracy100: 0.4460 - val_loss: 3.3483 - val_accuracy100: 0.3476 - 167s/epoch - 27ms/step
Epoch 10/50
6073/6073 - 165s - loss: 3.1457 - accuracy100: 0.4469 - val_loss: 3.3541 - val_accuracy100: 0.3476 - 165s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 166s - loss: 3.1433 - accuracy100: 0.4478 - val_loss: 3.3529 - val_accuracy100: 0.3483 - 166s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h100
Evaluating performance on  test set...
21353/21353 - 316s - 316s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1360282
{'0': {'precision': 0.5035800324007622, 'recall': 0.030489422493451632, 'f1-score': 0.05749763153998061, 'support': 1967666}, '1': {'precision': 0.279179365895161, 'recall': 0.9290224350034619, 'f1-score': 0.4293386984090541, 'support': 1523735}, '2': {'precision': 0.4867642219980402, 'recall': 0.06816854878770677, 'f1-score': 0.1195892993250338, 'support': 1974811}, 'accuracy': 0.29457273153694, 'macro avg': {'precision': 0.42317454009798783, 'recall': 0.3425601354282068, 'f1-score': 0.2021418764246895, 'support': 5466212}, 'weighted avg': {'precision': 0.4349520324375112, 'recall': 0.29457273153694, 'f1-score': 0.18358248821513634, 'support': 5466212}}
[[  59993 1841138   66535]
 [  32745 1415584   75406]
 [  26395 1813796  134620]]
Evaluating performance on  train set...
6073/6073 - 94s - 94s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050358
{'0': {'precision': 0.4916094683821802, 'recall': 0.03637322087506589, 'f1-score': 0.06773487139471915, 'support': 517881}, '1': {'precision': 0.3344247637245863, 'recall': 0.9260842652103738, 'f1-score': 0.49139752984350354, 'support': 518577}, '2': {'precision': 0.48407730673316707, 'recall': 0.0749341337013482, 'f1-score': 0.1297787880560593, 'support': 518095}, 'accuracy': 0.3460197239978309, 'macro avg': {'precision': 0.4367038462799779, 'recall': 0.34579720659559593, 'f1-score': 0.22963706309809404, 'support': 1554553}, 'weighted avg': {'precision': 0.4366645756208742, 'recall': 0.3460197239978309, 'f1-score': 0.2297405112365594, 'support': 1554553}}
[[ 18837 483421  15623]
 [ 12577 480246  25754]
 [  6903 472369  38823]]
Evaluating performance on  val set...
1786/1786 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1113914
{'0': {'precision': 0.5105030403537866, 'recall': 0.036043713003317504, 'f1-score': 0.06733339814319739, 'support': 153730}, '1': {'precision': 0.3208319447247739, 'recall': 0.9328138220924203, 'f1-score': 0.47744981960554217, 'support': 146548}, '2': {'precision': 0.4836559352162749, 'recall': 0.06242272837350396, 'f1-score': 0.1105742636849057, 'support': 156914}, 'accuracy': 0.3325473761570631, 'macro avg': {'precision': 0.4383303067649451, 'recall': 0.3437600878230806, 'f1-score': 0.21845249381121504, 'support': 457192}, 'weighted avg': {'precision': 0.4404917401171506, 'recall': 0.3325473761570631, 'f1-score': 0.21363263021216472, 'support': 457192}}
[[  5541 144293   3896]
 [  3285 136702   6561]
 [  2028 145091   9795]]
training model: results/AAPL/W1/deepOF_L2/h200
Epoch 1/50
6073/6073 - 167s - loss: 3.2639 - accuracy200: 0.3852 - val_loss: 3.2913 - val_accuracy200: 0.3487 - 167s/epoch - 27ms/step
Epoch 2/50
6073/6073 - 166s - loss: 3.2474 - accuracy200: 0.3964 - val_loss: 3.2891 - val_accuracy200: 0.3509 - 166s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 165s - loss: 3.2411 - accuracy200: 0.3999 - val_loss: 3.2898 - val_accuracy200: 0.3503 - 165s/epoch - 27ms/step
Epoch 4/50
6073/6073 - 167s - loss: 3.2367 - accuracy200: 0.4029 - val_loss: 3.2902 - val_accuracy200: 0.3514 - 167s/epoch - 27ms/step
Epoch 5/50
6073/6073 - 164s - loss: 3.2328 - accuracy200: 0.4058 - val_loss: 3.2915 - val_accuracy200: 0.3528 - 164s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 167s - loss: 3.2301 - accuracy200: 0.4074 - val_loss: 3.2927 - val_accuracy200: 0.3529 - 167s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 164s - loss: 3.2277 - accuracy200: 0.4089 - val_loss: 3.2922 - val_accuracy200: 0.3547 - 164s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 166s - loss: 3.2258 - accuracy200: 0.4099 - val_loss: 3.2916 - val_accuracy200: 0.3543 - 166s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 166s - loss: 3.2239 - accuracy200: 0.4110 - val_loss: 3.2937 - val_accuracy200: 0.3552 - 166s/epoch - 27ms/step
Epoch 10/50
6073/6073 - 167s - loss: 3.2223 - accuracy200: 0.4117 - val_loss: 3.2932 - val_accuracy200: 0.3551 - 167s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 169s - loss: 3.2208 - accuracy200: 0.4131 - val_loss: 3.2955 - val_accuracy200: 0.3562 - 169s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 169s - loss: 3.2192 - accuracy200: 0.4134 - val_loss: 3.2960 - val_accuracy200: 0.3556 - 169s/epoch - 28ms/step
testing model: results/AAPL/W1/deepOF_L2/h200
Evaluating performance on  test set...
21353/21353 - 308s - 308s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036106
{'0': {'precision': 0.4313280203448203, 'recall': 0.18403398523756234, 'f1-score': 0.25799127605728867, 'support': 1998044}, '1': {'precision': 0.2762724832183819, 'recall': 0.5721350990775678, 'f1-score': 0.3726161525591288, 'support': 1466124}, '2': {'precision': 0.4196783393481209, 'recall': 0.3306835414206681, 'f1-score': 0.36990343744805554, 'support': 2002044}, 'accuracy': 0.341840382334238, 'macro avg': {'precision': 0.3757596143037744, 'recall': 0.3622842085785994, 'f1-score': 0.3335036220214909, 'support': 5466212}, 'weighted avg': {'precision': 0.385472898323333, 'recall': 0.341840382334238, 'f1-score': 0.3297241970775126, 'support': 5466212}}
[[ 367708 1120742  509594]
 [ 221439  838821  405864]
 [ 263355 1076646  662043]]
Evaluating performance on  train set...
6073/6073 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929674
{'0': {'precision': 0.4106036421056245, 'recall': 0.18429207246731286, 'f1-score': 0.25440087838116265, 'support': 519241}, '1': {'precision': 0.336264610237213, 'recall': 0.6212360960628571, 'f1-score': 0.43634372765130386, 'support': 513164}, '2': {'precision': 0.4055054224126389, 'recall': 0.29002505036886095, 'f1-score': 0.3381785131275416, 'support': 522148}, 'accuracy': 0.3640429113706641, 'macro avg': {'precision': 0.3841245582518255, 'recall': 0.36518440629967697, 'f1-score': 0.34297437305333606, 'support': 1554553}, 'weighted avg': {'precision': 0.3843516325787865, 'recall': 0.3640429113706641, 'f1-score': 0.34260040887669096, 'support': 1554553}}
[[ 95692 320603 102946]
 [ 75300 318796 119068]
 [ 62060 308652 151436]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0970578
{'0': {'precision': 0.41203823695324054, 'recall': 0.17482259639953165, 'f1-score': 0.2454878237094767, 'support': 154591}, '1': {'precision': 0.3176989953565149, 'recall': 0.6360001110771709, 'f1-score': 0.4237323805228895, 'support': 144044}, '2': {'precision': 0.4060635412630763, 'recall': 0.26439703072081333, 'f1-score': 0.3202634101995057, 'support': 158557}, 'accuracy': 0.3511872473709076, 'macro avg': {'precision': 0.3786002578576106, 'recall': 0.358406579399172, 'f1-score': 0.32982787147729065, 'support': 457192}, 'weighted avg': {'precision': 0.38024342964886054, 'recall': 0.3511872473709076, 'f1-score': 0.3275786118438508, 'support': 457192}}
[[27026 98311 29254]
 [20368 91612 32064]
 [18197 98438 41922]]
training model: results/AAPL/W1/deepOF_L2/h300
Epoch 1/50
6073/6073 - 169s - loss: 3.2535 - accuracy300: 0.3926 - val_loss: 3.2890 - val_accuracy300: 0.3545 - 169s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 164s - loss: 3.2392 - accuracy300: 0.4000 - val_loss: 3.2877 - val_accuracy300: 0.3538 - 164s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 164s - loss: 3.2341 - accuracy300: 0.4026 - val_loss: 3.2863 - val_accuracy300: 0.3539 - 164s/epoch - 27ms/step
Epoch 4/50
6073/6073 - 165s - loss: 3.2311 - accuracy300: 0.4043 - val_loss: 3.2853 - val_accuracy300: 0.3539 - 165s/epoch - 27ms/step
Epoch 5/50
6073/6073 - 165s - loss: 3.2293 - accuracy300: 0.4056 - val_loss: 3.2845 - val_accuracy300: 0.3553 - 165s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 166s - loss: 3.2275 - accuracy300: 0.4065 - val_loss: 3.2865 - val_accuracy300: 0.3536 - 166s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 166s - loss: 3.2263 - accuracy300: 0.4077 - val_loss: 3.2869 - val_accuracy300: 0.3538 - 166s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 169s - loss: 3.2252 - accuracy300: 0.4087 - val_loss: 3.2865 - val_accuracy300: 0.3544 - 169s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 169s - loss: 3.2236 - accuracy300: 0.4095 - val_loss: 3.2870 - val_accuracy300: 0.3541 - 169s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 170s - loss: 3.2223 - accuracy300: 0.4104 - val_loss: 3.2885 - val_accuracy300: 0.3534 - 170s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 173s - loss: 3.2212 - accuracy300: 0.4113 - val_loss: 3.2880 - val_accuracy300: 0.3541 - 173s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 163s - loss: 3.2197 - accuracy300: 0.4120 - val_loss: 3.2898 - val_accuracy300: 0.3537 - 163s/epoch - 27ms/step
Epoch 13/50
6073/6073 - 166s - loss: 3.2187 - accuracy300: 0.4127 - val_loss: 3.2900 - val_accuracy300: 0.3536 - 166s/epoch - 27ms/step
Epoch 14/50
6073/6073 - 178s - loss: 3.2175 - accuracy300: 0.4134 - val_loss: 3.2905 - val_accuracy300: 0.3544 - 178s/epoch - 29ms/step
Epoch 15/50
6073/6073 - 163s - loss: 3.2158 - accuracy300: 0.4147 - val_loss: 3.2934 - val_accuracy300: 0.3539 - 163s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h300
Evaluating performance on  test set...
21353/21353 - 334s - 334s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953633
{'0': {'precision': 0.3826894045871464, 'recall': 0.38620562849022605, 'f1-score': 0.3844394765397236, 'support': 1903530}, '1': {'precision': 0.3129854228087206, 'recall': 0.21143485043980428, 'f1-score': 0.252377832960091, 'support': 1645391}, '2': {'precision': 0.3811348417055621, 'recall': 0.48378310856307155, 'f1-score': 0.4263678385787754, 'support': 1917291}, 'accuracy': 0.3678232750577548, 'macro avg': {'precision': 0.3589365563671431, 'recall': 0.36047452916436734, 'f1-score': 0.35439504935953003, 'support': 5466212}, 'weighted avg': {'precision': 0.36116245800984914, 'recall': 0.3678232750577548, 'f1-score': 0.3593939480075482, 'support': 5466212}}
[[735154 386397 781979]
 [573369 347893 724129]
 [612497 377241 927553]]
Evaluating performance on  train set...
6073/6073 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0937595
{'0': {'precision': 0.3743545280057057, 'recall': 0.4121714863109272, 'f1-score': 0.3923538685478781, 'support': 519575}, '1': {'precision': 0.33600316552269915, 'recall': 0.25388931120938474, 'f1-score': 0.28923105692522943, 'support': 511723}, '2': {'precision': 0.3760382662694583, 'recall': 0.4281908438524238, 'f1-score': 0.4004235622118168, 'support': 523255}, 'accuracy': 0.36546068226686385, 'macro avg': {'precision': 0.36213198659928775, 'recall': 0.3647505471242452, 'f1-score': 0.36066949589497477, 'support': 1554553}, 'weighted avg': {'precision': 0.3622968819822561, 'recall': 0.36546068226686385, 'f1-score': 0.36112443669585864, 'support': 1554553}}
[[214154 128752 176669]
 [186699 129921 195103]
 [171209 127993 224053]]
Evaluating performance on  val set...
1786/1786 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0945975
{'0': {'precision': 0.35496777475202995, 'recall': 0.3895306490589156, 'f1-score': 0.3714469319797218, 'support': 146905}, '1': {'precision': 0.3494616174091534, 'recall': 0.2510324575927025, 'f1-score': 0.2921800973715499, 'support': 160055}, '2': {'precision': 0.359827411896646, 'recall': 0.4335427871558656, 'f1-score': 0.3932604961342346, 'support': 150232}, 'accuracy': 0.35550709548723514, 'macro avg': {'precision': 0.35475226801927645, 'recall': 0.3580352979358279, 'f1-score': 0.35229584182850204, 'support': 457192}, 'weighted avg': {'precision': 0.3546370274817275, 'recall': 0.35550709548723514, 'f1-score': 0.35086486177037823, 'support': 457192}}
[[57224 37178 52503]
 [56502 40179 63374]
 [47483 37617 65132]]
training model: results/AAPL/W1/deepOF_L2/h500
Epoch 1/50
6073/6073 - 169s - loss: 3.2642 - accuracy500: 0.3863 - val_loss: 3.3425 - val_accuracy500: 0.3148 - 169s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 167s - loss: 3.2456 - accuracy500: 0.3970 - val_loss: 3.3515 - val_accuracy500: 0.3145 - 167s/epoch - 27ms/step
Epoch 3/50
6073/6073 - 168s - loss: 3.2398 - accuracy500: 0.4000 - val_loss: 3.3521 - val_accuracy500: 0.3129 - 168s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 170s - loss: 3.2379 - accuracy500: 0.4013 - val_loss: 3.3495 - val_accuracy500: 0.3128 - 170s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 170s - loss: 3.2363 - accuracy500: 0.4019 - val_loss: 3.3500 - val_accuracy500: 0.3124 - 170s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 166s - loss: 3.2350 - accuracy500: 0.4029 - val_loss: 3.3475 - val_accuracy500: 0.3126 - 166s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 166s - loss: 3.2341 - accuracy500: 0.4034 - val_loss: 3.3508 - val_accuracy500: 0.3123 - 166s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 169s - loss: 3.2331 - accuracy500: 0.4039 - val_loss: 3.3507 - val_accuracy500: 0.3124 - 169s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 167s - loss: 3.2322 - accuracy500: 0.4044 - val_loss: 3.3518 - val_accuracy500: 0.3123 - 167s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 168s - loss: 3.2311 - accuracy500: 0.4052 - val_loss: 3.3520 - val_accuracy500: 0.3126 - 168s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 164s - loss: 3.2301 - accuracy500: 0.4055 - val_loss: 3.3544 - val_accuracy500: 0.3128 - 164s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h500
Evaluating performance on  test set...
21353/21353 - 287s - 287s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1364554
{'0': {'precision': 0.4046632975132729, 'recall': 0.03231891885590833, 'f1-score': 0.05985726551968728, 'support': 2058856}, '1': {'precision': 0.24130070335519072, 'recall': 0.9552195130150692, 'f1-score': 0.3852757975930644, 'support': 1308829}, '2': {'precision': 0.4083473589082437, 'recall': 0.023469795718615964, 'f1-score': 0.04438836666456375, 'support': 2098527}, 'accuracy': 0.24990084541177693, 'macro avg': {'precision': 0.3514371199255691, 'recall': 0.3370027425298645, 'f1-score': 0.16317380992577182, 'support': 5466212}, 'weighted avg': {'precision': 0.36696212557879165, 'recall': 0.24990084541177693, 'f1-score': 0.13183678442735502, 'support': 5466212}}
[[  66540 1945449   46867]
 [  34116 1250219   24494]
 [  63777 1985498   49252]]
Evaluating performance on  train set...
6073/6073 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1098742
{'0': {'precision': 0.3823201959474505, 'recall': 0.019976769394549922, 'f1-score': 0.0379695749523169, 'support': 515699}, '1': {'precision': 0.3320881625722367, 'recall': 0.9808100768025231, 'f1-score': 0.4961777028397866, 'support': 513655}, '2': {'precision': 0.3765408685757633, 'recall': 0.00756094356615302, 'f1-score': 0.014824216744906625, 'support': 525199}, 'accuracy': 0.3332604292037647, 'macro avg': {'precision': 0.3636497423651502, 'recall': 0.33611592992107536, 'f1-score': 0.18299049817900337, 'support': 1554553}, 'weighted avg': {'precision': 0.36377001974912976, 'recall': 0.3332604292037647, 'f1-score': 0.18155102694839845, 'support': 1554553}}
[[ 10302 501586   3811]
 [  7093 503798   2764]
 [  9551 511677   3971]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1152585
{'0': {'precision': 0.3735300406243318, 'recall': 0.022333870266676895, 'f1-score': 0.04214767367519512, 'support': 156444}, '1': {'precision': 0.3128669281446715, 'recall': 0.9753761777527774, 'f1-score': 0.4737660882825562, 'support': 142220}, '2': {'precision': 0.38511544496749606, 'recall': 0.010837202260799353, 'f1-score': 0.021081177257360927, 'support': 158528}, 'accuracy': 0.3148130325989956, 'macro avg': {'precision': 0.3571708045788331, 'recall': 0.3361824167600846, 'f1-score': 0.17899831307170408, 'support': 457192}, 'weighted avg': {'precision': 0.3586765504557721, 'recall': 0.3148130325989956, 'f1-score': 0.16910777223626458, 'support': 457192}}
[[  3494 151363   1587]
 [  2346 138718   1156]
 [  3514 153296   1718]]
training model: results/AAPL/W1/deepOF_L2/h1000
Epoch 1/50
6073/6073 - 180s - loss: 3.2750 - accuracy1000: 0.3801 - val_loss: 3.3556 - val_accuracy1000: 0.3076 - 180s/epoch - 30ms/step
Epoch 2/50
6073/6073 - 169s - loss: 3.2609 - accuracy1000: 0.3869 - val_loss: 3.3660 - val_accuracy1000: 0.3073 - 169s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 170s - loss: 3.2543 - accuracy1000: 0.3909 - val_loss: 3.3659 - val_accuracy1000: 0.3072 - 170s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 165s - loss: 3.2521 - accuracy1000: 0.3921 - val_loss: 3.3651 - val_accuracy1000: 0.3072 - 165s/epoch - 27ms/step
Epoch 5/50
6073/6073 - 166s - loss: 3.2508 - accuracy1000: 0.3927 - val_loss: 3.3635 - val_accuracy1000: 0.3072 - 166s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 165s - loss: 3.2499 - accuracy1000: 0.3934 - val_loss: 3.3634 - val_accuracy1000: 0.3072 - 165s/epoch - 27ms/step
Epoch 7/50
6073/6073 - 166s - loss: 3.2487 - accuracy1000: 0.3943 - val_loss: 3.3642 - val_accuracy1000: 0.3072 - 166s/epoch - 27ms/step
Epoch 8/50
6073/6073 - 166s - loss: 3.2477 - accuracy1000: 0.3951 - val_loss: 3.3644 - val_accuracy1000: 0.3072 - 166s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 170s - loss: 3.2468 - accuracy1000: 0.3958 - val_loss: 3.3646 - val_accuracy1000: 0.3072 - 170s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 166s - loss: 3.2458 - accuracy1000: 0.3966 - val_loss: 3.3664 - val_accuracy1000: 0.3072 - 166s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 167s - loss: 3.2448 - accuracy1000: 0.3974 - val_loss: 3.3679 - val_accuracy1000: 0.3072 - 167s/epoch - 27ms/step
testing model: results/AAPL/W1/deepOF_L2/h1000
Evaluating performance on  test set...
21353/21353 - 310s - 310s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1409202
{'0': {'precision': 0.35557177454135286, 'recall': 0.005241852460291183, 'f1-score': 0.010331399047637408, 'support': 2044697}, '1': {'precision': 0.24459573825413738, 'recall': 0.9927295832554662, 'f1-score': 0.39248760383702896, 'support': 1337750}, '2': {'precision': 0.37886129618413084, 'recall': 0.0012007112126367417, 'f1-score': 0.0023938357294812545, 'support': 2083765}, 'accuracy': 0.24536991979088993, 'macro avg': {'precision': 0.3263429363265404, 'recall': 0.33305738230946474, 'f1-score': 0.13507094620471588, 'support': 5466212}, 'weighted avg': {'precision': 0.3372906865635614, 'recall': 0.24536991979088993, 'f1-score': 0.10083089784668707, 'support': 5466212}}
[[  10718 2031679    2300]
 [   7924 1328024    1802]
 [  11501 2069762    2502]]
Evaluating performance on  train set...
6073/6073 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1125289
{'0': {'precision': 0.33754257705408325, 'recall': 0.007943505895555508, 'f1-score': 0.015521733483087689, 'support': 511487}, '1': {'precision': 0.33007810851571745, 'recall': 0.9907090035757086, 'f1-score': 0.49517647620281297, 'support': 513185}, '2': {'precision': 0.3355825461088619, 'recall': 0.0014078632749617366, 'f1-score': 0.0028039631350262354, 'support': 529881}, 'accuracy': 0.33014377766470493, 'macro avg': {'precision': 0.33440107722622087, 'recall': 0.3333534575820753, 'f1-score': 0.17116739094030897, 'support': 1554553}, 'weighted avg': {'precision': 0.3344103348956325, 'recall': 0.33014377766470493, 'f1-score': 0.1695291647336279, 'support': 1554553}}
[[  4063 506719    705]
 [  3996 508417    772]
 [  3978 525157    746]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1200945
{'0': {'precision': 0.34736523319200485, 'recall': 0.007268095784250981, 'f1-score': 0.014238277007106726, 'support': 157813}, '1': {'precision': 0.3070959061231692, 'recall': 0.9914898162654893, 'f1-score': 0.46894472700326717, 'support': 140420}, '2': {'precision': 0.3490566037735849, 'recall': 0.0011638221176529797, 'f1-score': 0.002319909210039564, 'support': 158959}, 'accuracy': 0.30743538819576893, 'macro avg': {'precision': 0.33450591436291965, 'recall': 0.3333072447224644, 'f1-score': 0.1618343044068045, 'support': 457192}, 'weighted avg': {'precision': 0.33558514882760543, 'recall': 0.30743538819576893, 'f1-score': 0.14975103287730315, 'support': 457192}}
[[  1147 156481    185]
 [  1035 139225    160]
 [  1120 157654    185]]
training model: results/AAPL/W1/deepVOL_L2/h10
Epoch 1/50
6073/6073 - 176s - loss: 2.9959 - accuracy10: 0.4722 - val_loss: 3.1721 - val_accuracy10: 0.4704 - 176s/epoch - 29ms/step
Epoch 2/50
6073/6073 - 170s - loss: 2.8885 - accuracy10: 0.5077 - val_loss: 3.1001 - val_accuracy10: 0.4885 - 170s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 169s - loss: 2.8356 - accuracy10: 0.5204 - val_loss: 3.0777 - val_accuracy10: 0.5003 - 169s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 168s - loss: 2.8057 - accuracy10: 0.5278 - val_loss: 3.0465 - val_accuracy10: 0.5103 - 168s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 168s - loss: 2.7851 - accuracy10: 0.5324 - val_loss: 3.0338 - val_accuracy10: 0.5146 - 168s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 168s - loss: 2.7698 - accuracy10: 0.5360 - val_loss: 3.0144 - val_accuracy10: 0.5188 - 168s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 168s - loss: 2.7567 - accuracy10: 0.5386 - val_loss: 2.9997 - val_accuracy10: 0.5153 - 168s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 169s - loss: 2.7479 - accuracy10: 0.5403 - val_loss: 2.9848 - val_accuracy10: 0.5196 - 169s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 169s - loss: 2.7399 - accuracy10: 0.5420 - val_loss: 2.9853 - val_accuracy10: 0.5233 - 169s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 171s - loss: 2.7336 - accuracy10: 0.5433 - val_loss: 2.9815 - val_accuracy10: 0.5224 - 171s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 170s - loss: 2.7278 - accuracy10: 0.5442 - val_loss: 2.9692 - val_accuracy10: 0.5233 - 170s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 170s - loss: 2.7223 - accuracy10: 0.5454 - val_loss: 2.9679 - val_accuracy10: 0.5229 - 170s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 167s - loss: 2.7183 - accuracy10: 0.5461 - val_loss: 2.9644 - val_accuracy10: 0.5243 - 167s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 169s - loss: 2.7140 - accuracy10: 0.5469 - val_loss: 2.9702 - val_accuracy10: 0.5244 - 169s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 167s - loss: 2.7101 - accuracy10: 0.5477 - val_loss: 2.9631 - val_accuracy10: 0.5245 - 167s/epoch - 28ms/step
Epoch 16/50
6073/6073 - 169s - loss: 2.7065 - accuracy10: 0.5485 - val_loss: 2.9570 - val_accuracy10: 0.5240 - 169s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 168s - loss: 2.7029 - accuracy10: 0.5489 - val_loss: 2.9628 - val_accuracy10: 0.5262 - 168s/epoch - 28ms/step
Epoch 18/50
6073/6073 - 169s - loss: 2.6998 - accuracy10: 0.5495 - val_loss: 2.9615 - val_accuracy10: 0.5257 - 169s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 169s - loss: 2.6970 - accuracy10: 0.5503 - val_loss: 2.9598 - val_accuracy10: 0.5285 - 169s/epoch - 28ms/step
Epoch 20/50
6073/6073 - 171s - loss: 2.6943 - accuracy10: 0.5510 - val_loss: 2.9613 - val_accuracy10: 0.5271 - 171s/epoch - 28ms/step
Epoch 21/50
6073/6073 - 169s - loss: 2.6916 - accuracy10: 0.5514 - val_loss: 2.9579 - val_accuracy10: 0.5284 - 169s/epoch - 28ms/step
Epoch 22/50
6073/6073 - 169s - loss: 2.6890 - accuracy10: 0.5517 - val_loss: 2.9639 - val_accuracy10: 0.5275 - 169s/epoch - 28ms/step
Epoch 23/50
6073/6073 - 169s - loss: 2.6866 - accuracy10: 0.5524 - val_loss: 2.9599 - val_accuracy10: 0.5279 - 169s/epoch - 28ms/step
Epoch 24/50
6073/6073 - 168s - loss: 2.6845 - accuracy10: 0.5527 - val_loss: 2.9560 - val_accuracy10: 0.5271 - 168s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 171s - loss: 2.6825 - accuracy10: 0.5530 - val_loss: 2.9538 - val_accuracy10: 0.5286 - 171s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 170s - loss: 2.6805 - accuracy10: 0.5535 - val_loss: 2.9516 - val_accuracy10: 0.5293 - 170s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 167s - loss: 2.6782 - accuracy10: 0.5538 - val_loss: 2.9587 - val_accuracy10: 0.5273 - 167s/epoch - 27ms/step
Epoch 28/50
6073/6073 - 170s - loss: 2.6768 - accuracy10: 0.5541 - val_loss: 2.9506 - val_accuracy10: 0.5280 - 170s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 168s - loss: 2.6752 - accuracy10: 0.5544 - val_loss: 2.9502 - val_accuracy10: 0.5269 - 168s/epoch - 28ms/step
Epoch 30/50
6073/6073 - 170s - loss: 2.6730 - accuracy10: 0.5547 - val_loss: 2.9506 - val_accuracy10: 0.5291 - 170s/epoch - 28ms/step
Epoch 31/50
6073/6073 - 167s - loss: 2.6714 - accuracy10: 0.5552 - val_loss: 2.9491 - val_accuracy10: 0.5285 - 167s/epoch - 27ms/step
Epoch 32/50
6073/6073 - 167s - loss: 2.6696 - accuracy10: 0.5558 - val_loss: 2.9530 - val_accuracy10: 0.5285 - 167s/epoch - 28ms/step
Epoch 33/50
6073/6073 - 167s - loss: 2.6684 - accuracy10: 0.5557 - val_loss: 2.9485 - val_accuracy10: 0.5284 - 167s/epoch - 28ms/step
Epoch 34/50
6073/6073 - 167s - loss: 2.6662 - accuracy10: 0.5565 - val_loss: 2.9440 - val_accuracy10: 0.5292 - 167s/epoch - 28ms/step
Epoch 35/50
6073/6073 - 171s - loss: 2.6646 - accuracy10: 0.5566 - val_loss: 2.9433 - val_accuracy10: 0.5286 - 171s/epoch - 28ms/step
Epoch 36/50
6073/6073 - 172s - loss: 2.6629 - accuracy10: 0.5572 - val_loss: 2.9400 - val_accuracy10: 0.5272 - 172s/epoch - 28ms/step
Epoch 37/50
6073/6073 - 173s - loss: 2.6616 - accuracy10: 0.5574 - val_loss: 2.9446 - val_accuracy10: 0.5292 - 173s/epoch - 28ms/step
Epoch 38/50
6073/6073 - 174s - loss: 2.6606 - accuracy10: 0.5573 - val_loss: 2.9422 - val_accuracy10: 0.5278 - 174s/epoch - 29ms/step
Epoch 39/50
6073/6073 - 164s - loss: 2.6587 - accuracy10: 0.5580 - val_loss: 2.9420 - val_accuracy10: 0.5272 - 164s/epoch - 27ms/step
Epoch 40/50
6073/6073 - 170s - loss: 2.6571 - accuracy10: 0.5581 - val_loss: 2.9414 - val_accuracy10: 0.5282 - 170s/epoch - 28ms/step
Epoch 41/50
6073/6073 - 168s - loss: 2.6561 - accuracy10: 0.5585 - val_loss: 2.9451 - val_accuracy10: 0.5275 - 168s/epoch - 28ms/step
Epoch 42/50
6073/6073 - 173s - loss: 2.6547 - accuracy10: 0.5586 - val_loss: 2.9431 - val_accuracy10: 0.5264 - 173s/epoch - 29ms/step
Epoch 43/50
6073/6073 - 168s - loss: 2.6533 - accuracy10: 0.5589 - val_loss: 2.9436 - val_accuracy10: 0.5288 - 168s/epoch - 28ms/step
Epoch 44/50
6073/6073 - 167s - loss: 2.6517 - accuracy10: 0.5591 - val_loss: 2.9438 - val_accuracy10: 0.5273 - 167s/epoch - 28ms/step
Epoch 45/50
6073/6073 - 167s - loss: 2.6512 - accuracy10: 0.5593 - val_loss: 2.9367 - val_accuracy10: 0.5281 - 167s/epoch - 28ms/step
Epoch 46/50
6073/6073 - 169s - loss: 2.6499 - accuracy10: 0.5594 - val_loss: 2.9485 - val_accuracy10: 0.5269 - 169s/epoch - 28ms/step
Epoch 47/50
6073/6073 - 167s - loss: 2.6483 - accuracy10: 0.5599 - val_loss: 2.9365 - val_accuracy10: 0.5276 - 167s/epoch - 28ms/step
Epoch 48/50
6073/6073 - 167s - loss: 2.6470 - accuracy10: 0.5601 - val_loss: 2.9419 - val_accuracy10: 0.5283 - 167s/epoch - 28ms/step
Epoch 49/50
6073/6073 - 170s - loss: 2.6460 - accuracy10: 0.5605 - val_loss: 2.9372 - val_accuracy10: 0.5261 - 170s/epoch - 28ms/step
Epoch 50/50
6073/6073 - 168s - loss: 2.6446 - accuracy10: 0.5605 - val_loss: 2.9406 - val_accuracy10: 0.5277 - 168s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h10
Evaluating performance on  test set...
21353/21353 - 314s - 314s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0105729
{'0': {'precision': 0.49375710816128, 'recall': 0.5785549032737971, 'f1-score': 0.5328031261548444, 'support': 1805457}, '1': {'precision': 0.5410202179025144, 'recall': 0.338725722135619, 'f1-score': 0.41661451484744716, 'support': 1836601}, '2': {'precision': 0.48815418260202226, 'recall': 0.5889503053187798, 'f1-score': 0.533835961339416, 'support': 1824159}, 'accuracy': 0.5014435028832555, 'macro avg': {'precision': 0.507643836221939, 'recall': 0.5020769769093986, 'f1-score': 0.49441786744723587, 'support': 5466217}, 'weighted avg': {'precision': 0.5077673180612182, 'recall': 0.5014435028832555, 'f1-score': 0.49410944382969635, 'support': 5466217}}
[[1044556  259942  500959]
 [ 588976  622104  625521]
 [ 481994  267826 1074339]]
Evaluating performance on  train set...
6073/6073 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9053689
{'0': {'precision': 0.4768386311244586, 'recall': 0.5505932481320375, 'f1-score': 0.5110686869783346, 'support': 393343}, '1': {'precision': 0.6796244419082251, 'recall': 0.5390919031053272, 'f1-score': 0.6012556330835569, 'support': 765491}, '2': {'precision': 0.46922346948707133, 'recall': 0.58477206105327, 'f1-score': 0.5206640206640207, 'support': 395720}, 'accuracy': 0.553630173027119, 'macro avg': {'precision': 0.5418955141732517, 'recall': 0.5581524040968783, 'f1-score': 0.5443294469086374, 'support': 1554554}, 'weighted avg': {'precision': 0.5747556165231834, 'recall': 0.553630173027119, 'f1-score': 0.5579209423564897, 'support': 1554554}}
[[216572  99249  77522]
 [168581 412670 184240]
 [ 69030  95284 231406]]
Evaluating performance on  val set...
1786/1786 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94944465
{'0': {'precision': 0.4821255973795844, 'recall': 0.5662113054651227, 'f1-score': 0.5207962500407841, 'support': 126859}, '1': {'precision': 0.6385870875732877, 'recall': 0.4567985806515204, 'f1-score': 0.5326081647546235, 'support': 202910}, '2': {'precision': 0.4685702370877335, 'recall': 0.5996201657458563, 'f1-score': 0.526056333179568, 'support': 127424}, 'accuracy': 0.5269634486967211, 'macro avg': {'precision': 0.5297609740135352, 'recall': 0.5408766839541664, 'f1-score': 0.5264869159916585, 'support': 457193}, 'weighted avg': {'precision': 0.5477878510566432, 'recall': 0.5269634486967211, 'f1-score': 0.5275046126982648, 'support': 457193}}
[[71829 26293 28737]
 [52302 92689 57919]
 [24853 26165 76406]]
training model: results/AAPL/W1/deepVOL_L2/h20
Epoch 1/50
6073/6073 - 174s - loss: 3.0535 - accuracy20: 0.4766 - val_loss: 3.1729 - val_accuracy20: 0.4654 - 174s/epoch - 29ms/step
Epoch 2/50
6073/6073 - 169s - loss: 2.9824 - accuracy20: 0.5012 - val_loss: 3.1381 - val_accuracy20: 0.4722 - 169s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 169s - loss: 2.9451 - accuracy20: 0.5112 - val_loss: 3.1205 - val_accuracy20: 0.4755 - 169s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 169s - loss: 2.9142 - accuracy20: 0.5187 - val_loss: 3.0898 - val_accuracy20: 0.4806 - 169s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 169s - loss: 2.8944 - accuracy20: 0.5234 - val_loss: 3.0785 - val_accuracy20: 0.4845 - 169s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 169s - loss: 2.8812 - accuracy20: 0.5263 - val_loss: 3.0670 - val_accuracy20: 0.4870 - 169s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 167s - loss: 2.8718 - accuracy20: 0.5285 - val_loss: 3.0629 - val_accuracy20: 0.4916 - 167s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 170s - loss: 2.8630 - accuracy20: 0.5307 - val_loss: 3.0556 - val_accuracy20: 0.4939 - 170s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 175s - loss: 2.8559 - accuracy20: 0.5323 - val_loss: 3.0444 - val_accuracy20: 0.4969 - 175s/epoch - 29ms/step
Epoch 10/50
6073/6073 - 170s - loss: 2.8503 - accuracy20: 0.5336 - val_loss: 3.0455 - val_accuracy20: 0.4975 - 170s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 169s - loss: 2.8456 - accuracy20: 0.5347 - val_loss: 3.0388 - val_accuracy20: 0.4989 - 169s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 169s - loss: 2.8408 - accuracy20: 0.5358 - val_loss: 3.0381 - val_accuracy20: 0.5000 - 169s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 170s - loss: 2.8378 - accuracy20: 0.5365 - val_loss: 3.0346 - val_accuracy20: 0.5013 - 170s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 169s - loss: 2.8344 - accuracy20: 0.5370 - val_loss: 3.0406 - val_accuracy20: 0.4999 - 169s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 170s - loss: 2.8306 - accuracy20: 0.5382 - val_loss: 3.0304 - val_accuracy20: 0.5019 - 170s/epoch - 28ms/step
Epoch 16/50
6073/6073 - 169s - loss: 2.8278 - accuracy20: 0.5386 - val_loss: 3.0323 - val_accuracy20: 0.5020 - 169s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 168s - loss: 2.8251 - accuracy20: 0.5395 - val_loss: 3.0321 - val_accuracy20: 0.5027 - 168s/epoch - 28ms/step
Epoch 18/50
6073/6073 - 170s - loss: 2.8228 - accuracy20: 0.5395 - val_loss: 3.0223 - val_accuracy20: 0.5047 - 170s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 170s - loss: 2.8202 - accuracy20: 0.5404 - val_loss: 3.0243 - val_accuracy20: 0.5045 - 170s/epoch - 28ms/step
Epoch 20/50
6073/6073 - 172s - loss: 2.8179 - accuracy20: 0.5407 - val_loss: 3.0274 - val_accuracy20: 0.5043 - 172s/epoch - 28ms/step
Epoch 21/50
6073/6073 - 171s - loss: 2.8158 - accuracy20: 0.5413 - val_loss: 3.0240 - val_accuracy20: 0.5044 - 171s/epoch - 28ms/step
Epoch 22/50
6073/6073 - 168s - loss: 2.8141 - accuracy20: 0.5418 - val_loss: 3.0233 - val_accuracy20: 0.5043 - 168s/epoch - 28ms/step
Epoch 23/50
6073/6073 - 171s - loss: 2.8120 - accuracy20: 0.5422 - val_loss: 3.0170 - val_accuracy20: 0.5046 - 171s/epoch - 28ms/step
Epoch 24/50
6073/6073 - 170s - loss: 2.8100 - accuracy20: 0.5423 - val_loss: 3.0187 - val_accuracy20: 0.5049 - 170s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 168s - loss: 2.8084 - accuracy20: 0.5430 - val_loss: 3.0116 - val_accuracy20: 0.5064 - 168s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 166s - loss: 2.8069 - accuracy20: 0.5431 - val_loss: 3.0118 - val_accuracy20: 0.5059 - 166s/epoch - 27ms/step
Epoch 27/50
6073/6073 - 168s - loss: 2.8052 - accuracy20: 0.5436 - val_loss: 3.0142 - val_accuracy20: 0.5057 - 168s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 166s - loss: 2.8037 - accuracy20: 0.5438 - val_loss: 3.0156 - val_accuracy20: 0.5062 - 166s/epoch - 27ms/step
Epoch 29/50
6073/6073 - 167s - loss: 2.8025 - accuracy20: 0.5441 - val_loss: 3.0108 - val_accuracy20: 0.5068 - 167s/epoch - 28ms/step
Epoch 30/50
6073/6073 - 169s - loss: 2.8008 - accuracy20: 0.5446 - val_loss: 3.0104 - val_accuracy20: 0.5073 - 169s/epoch - 28ms/step
Epoch 31/50
6073/6073 - 175s - loss: 2.7989 - accuracy20: 0.5451 - val_loss: 3.0135 - val_accuracy20: 0.5067 - 175s/epoch - 29ms/step
Epoch 32/50
6073/6073 - 178s - loss: 2.7977 - accuracy20: 0.5451 - val_loss: 3.0165 - val_accuracy20: 0.5063 - 178s/epoch - 29ms/step
Epoch 33/50
6073/6073 - 173s - loss: 2.7966 - accuracy20: 0.5453 - val_loss: 3.0113 - val_accuracy20: 0.5067 - 173s/epoch - 29ms/step
Epoch 34/50
6073/6073 - 171s - loss: 2.7952 - accuracy20: 0.5461 - val_loss: 3.0085 - val_accuracy20: 0.5074 - 171s/epoch - 28ms/step
Epoch 35/50
6073/6073 - 167s - loss: 2.7942 - accuracy20: 0.5460 - val_loss: 3.0081 - val_accuracy20: 0.5072 - 167s/epoch - 27ms/step
Epoch 36/50
6073/6073 - 173s - loss: 2.7926 - accuracy20: 0.5462 - val_loss: 3.0054 - val_accuracy20: 0.5075 - 173s/epoch - 29ms/step
Epoch 37/50
6073/6073 - 171s - loss: 2.7916 - accuracy20: 0.5469 - val_loss: 3.0050 - val_accuracy20: 0.5074 - 171s/epoch - 28ms/step
Epoch 38/50
6073/6073 - 180s - loss: 2.7904 - accuracy20: 0.5469 - val_loss: 3.0059 - val_accuracy20: 0.5075 - 180s/epoch - 30ms/step
Epoch 39/50
6073/6073 - 170s - loss: 2.7888 - accuracy20: 0.5472 - val_loss: 3.0068 - val_accuracy20: 0.5067 - 170s/epoch - 28ms/step
Epoch 40/50
6073/6073 - 175s - loss: 2.7882 - accuracy20: 0.5475 - val_loss: 3.0079 - val_accuracy20: 0.5067 - 175s/epoch - 29ms/step
Epoch 41/50
6073/6073 - 172s - loss: 2.7864 - accuracy20: 0.5477 - val_loss: 3.0073 - val_accuracy20: 0.5068 - 172s/epoch - 28ms/step
Epoch 42/50
6073/6073 - 169s - loss: 2.7859 - accuracy20: 0.5480 - val_loss: 3.0073 - val_accuracy20: 0.5065 - 169s/epoch - 28ms/step
Epoch 43/50
6073/6073 - 167s - loss: 2.7847 - accuracy20: 0.5483 - val_loss: 3.0069 - val_accuracy20: 0.5077 - 167s/epoch - 28ms/step
Epoch 44/50
6073/6073 - 169s - loss: 2.7839 - accuracy20: 0.5485 - val_loss: 3.0115 - val_accuracy20: 0.5069 - 169s/epoch - 28ms/step
Epoch 45/50
6073/6073 - 168s - loss: 2.7828 - accuracy20: 0.5481 - val_loss: 3.0079 - val_accuracy20: 0.5068 - 168s/epoch - 28ms/step
Epoch 46/50
6073/6073 - 170s - loss: 2.7820 - accuracy20: 0.5488 - val_loss: 3.0124 - val_accuracy20: 0.5068 - 170s/epoch - 28ms/step
Epoch 47/50
6073/6073 - 171s - loss: 2.7810 - accuracy20: 0.5490 - val_loss: 3.0096 - val_accuracy20: 0.5071 - 171s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h20
Evaluating performance on  test set...
21353/21353 - 325s - 325s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0209147
{'0': {'precision': 0.5485108350784348, 'recall': 0.49165034408428543, 'f1-score': 0.5185264480209636, 'support': 2118231}, '1': {'precision': 0.36746759185213435, 'recall': 0.3716818857947338, 'f1-score': 0.3695627248303436, 'support': 1205391}, '2': {'precision': 0.5224403986792451, 'recall': 0.572611716166611, 'f1-score': 0.5463767234942992, 'support': 2142595}, 'accuracy': 0.49692977794331983, 'macro avg': {'precision': 0.4794729418699381, 'recall': 0.4786479820152101, 'f1-score': 0.47815529878186885, 'support': 5466217}, 'weighted avg': {'precision': 0.49836897596956387, 'recall': 0.49692977794331983, 'f1-score': 0.49659397254794946, 'support': 5466217}}
[[1041429  383036  693766]
 [ 329656  448022  427713]
 [ 527563  388157 1226875]]
Evaluating performance on  train set...
6073/6073 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96725965
{'0': {'precision': 0.546033493401373, 'recall': 0.4314357481953567, 'f1-score': 0.4820169448616518, 'support': 492064}, '1': {'precision': 0.5223712078619235, 'recall': 0.5976968141730175, 'f1-score': 0.5575011528095264, 'support': 567388}, '2': {'precision': 0.5107345573374426, 'recall': 0.532865954894143, 'f1-score': 0.5215655883707734, 'support': 495102}, 'accuracy': 0.5244224388474121, 'macro avg': {'precision': 0.5263797528669131, 'recall': 0.5206661724208391, 'f1-score': 0.5203612286806506, 'support': 1554554}, 'weighted avg': {'precision': 0.5261549490016408, 'recall': 0.5244224388474121, 'f1-score': 0.5221631516050533, 'support': 1554554}}
[[212294 159244 120526]
 [ 96055 339126 132207]
 [ 80444 150835 263823]]
Evaluating performance on  val set...
1786/1786 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9931333
{'0': {'precision': 0.5462234491219998, 'recall': 0.45888681311602136, 'f1-score': 0.49876067777622174, 'support': 155230}, '1': {'precision': 0.47193913795998504, 'recall': 0.5032019941882084, 'f1-score': 0.48706942518929297, 'support': 145222}, '2': {'precision': 0.5084360332904891, 'recall': 0.5577417523175174, 'f1-score': 0.5319488137470261, 'support': 156741}, 'accuracy': 0.5068537794760637, 'macro avg': {'precision': 0.5088662067908246, 'recall': 0.5066101865405824, 'f1-score': 0.505926305570847, 'support': 457193}, 'weighted avg': {'precision': 0.5096731222788133, 'recall': 0.5068537794760637, 'f1-score': 0.5064250876359984, 'support': 457193}}
[[71233 41297 42700]
 [30326 73076 41820]
 [28851 40469 87421]]
training model: results/AAPL/W1/deepVOL_L2/h30
Epoch 1/50
6073/6073 - 186s - loss: 3.1073 - accuracy30: 0.4595 - val_loss: 3.1927 - val_accuracy30: 0.4494 - 186s/epoch - 31ms/step
Epoch 2/50
6073/6073 - 172s - loss: 3.0579 - accuracy30: 0.4804 - val_loss: 3.1806 - val_accuracy30: 0.4479 - 172s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 170s - loss: 3.0283 - accuracy30: 0.4902 - val_loss: 3.1721 - val_accuracy30: 0.4462 - 170s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 168s - loss: 3.0084 - accuracy30: 0.4959 - val_loss: 3.1697 - val_accuracy30: 0.4459 - 168s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 170s - loss: 2.9907 - accuracy30: 0.5000 - val_loss: 3.1647 - val_accuracy30: 0.4478 - 170s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 169s - loss: 2.9786 - accuracy30: 0.5027 - val_loss: 3.1536 - val_accuracy30: 0.4507 - 169s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 169s - loss: 2.9687 - accuracy30: 0.5051 - val_loss: 3.1431 - val_accuracy30: 0.4538 - 169s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 169s - loss: 2.9601 - accuracy30: 0.5070 - val_loss: 3.1414 - val_accuracy30: 0.4533 - 169s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 170s - loss: 2.9536 - accuracy30: 0.5085 - val_loss: 3.1395 - val_accuracy30: 0.4545 - 170s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 168s - loss: 2.9484 - accuracy30: 0.5097 - val_loss: 3.1345 - val_accuracy30: 0.4551 - 168s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 169s - loss: 2.9434 - accuracy30: 0.5111 - val_loss: 3.1217 - val_accuracy30: 0.4580 - 169s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 169s - loss: 2.9397 - accuracy30: 0.5119 - val_loss: 3.1252 - val_accuracy30: 0.4583 - 169s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 170s - loss: 2.9359 - accuracy30: 0.5129 - val_loss: 3.1178 - val_accuracy30: 0.4591 - 170s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 167s - loss: 2.9328 - accuracy30: 0.5134 - val_loss: 3.1204 - val_accuracy30: 0.4595 - 167s/epoch - 27ms/step
Epoch 15/50
6073/6073 - 165s - loss: 2.9301 - accuracy30: 0.5145 - val_loss: 3.1148 - val_accuracy30: 0.4611 - 165s/epoch - 27ms/step
Epoch 16/50
6073/6073 - 170s - loss: 2.9274 - accuracy30: 0.5153 - val_loss: 3.1185 - val_accuracy30: 0.4602 - 170s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 169s - loss: 2.9247 - accuracy30: 0.5160 - val_loss: 3.1143 - val_accuracy30: 0.4618 - 169s/epoch - 28ms/step
Epoch 18/50
6073/6073 - 170s - loss: 2.9233 - accuracy30: 0.5162 - val_loss: 3.1137 - val_accuracy30: 0.4619 - 170s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 173s - loss: 2.9212 - accuracy30: 0.5166 - val_loss: 3.1079 - val_accuracy30: 0.4639 - 173s/epoch - 28ms/step
Epoch 20/50
6073/6073 - 172s - loss: 2.9191 - accuracy30: 0.5172 - val_loss: 3.1126 - val_accuracy30: 0.4633 - 172s/epoch - 28ms/step
Epoch 21/50
6073/6073 - 177s - loss: 2.9171 - accuracy30: 0.5176 - val_loss: 3.1095 - val_accuracy30: 0.4638 - 177s/epoch - 29ms/step
Epoch 22/50
6073/6073 - 181s - loss: 2.9154 - accuracy30: 0.5182 - val_loss: 3.1086 - val_accuracy30: 0.4639 - 181s/epoch - 30ms/step
Epoch 23/50
6073/6073 - 176s - loss: 2.9136 - accuracy30: 0.5184 - val_loss: 3.1147 - val_accuracy30: 0.4641 - 176s/epoch - 29ms/step
Epoch 24/50
6073/6073 - 167s - loss: 2.9123 - accuracy30: 0.5189 - val_loss: 3.1152 - val_accuracy30: 0.4631 - 167s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 169s - loss: 2.9109 - accuracy30: 0.5193 - val_loss: 3.1096 - val_accuracy30: 0.4637 - 169s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 169s - loss: 2.9091 - accuracy30: 0.5197 - val_loss: 3.1142 - val_accuracy30: 0.4637 - 169s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 168s - loss: 2.9077 - accuracy30: 0.5201 - val_loss: 3.1090 - val_accuracy30: 0.4657 - 168s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 171s - loss: 2.9059 - accuracy30: 0.5207 - val_loss: 3.1119 - val_accuracy30: 0.4639 - 171s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 170s - loss: 2.9051 - accuracy30: 0.5208 - val_loss: 3.1097 - val_accuracy30: 0.4647 - 170s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h30
Evaluating performance on  test set...
21353/21353 - 332s - 332s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0646904
{'0': {'precision': 0.539966507323448, 'recall': 0.41634655465714976, 'f1-score': 0.4701665257792606, 'support': 2161483}, '1': {'precision': 0.2801143856531336, 'recall': 0.4235140454305148, 'f1-score': 0.3372017713057384, 'support': 1125455}, '2': {'precision': 0.5161913505042012, 'recall': 0.4969327011364768, 'f1-score': 0.5063789803310584, 'support': 2179279}, 'accuracy': 0.44995048678089433, 'macro avg': {'precision': 0.44542408116026094, 'recall': 0.44559776707471377, 'f1-score': 0.4379157591386858, 'support': 5466217}, 'weighted avg': {'precision': 0.47698610065968855, 'recall': 0.44995048678089433, 'f1-score': 0.4572272652261558, 'support': 5466217}}
[[ 899926  617023  644534]
 [ 278326  476646  370483]
 [ 488381  607943 1082955]]
Evaluating performance on  train set...
6073/6073 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0147654
{'0': {'precision': 0.5440290670680216, 'recall': 0.33891310044939676, 'f1-score': 0.4176458767917632, 'support': 515135}, '1': {'precision': 0.4382007223834478, 'recall': 0.64548222413581, 'f1-score': 0.5220175842214566, 'support': 520256}, '2': {'precision': 0.506757060405873, 'recall': 0.4561226435628117, 'f1-score': 0.4801085100947638, 'support': 519163}, 'accuracy': 0.48065490166311364, 'macro avg': {'precision': 0.4963289499524475, 'recall': 0.4801726560493395, 'f1-score': 0.47325732370266116, 'support': 1554554}, 'weighted avg': {'precision': 0.49616448463025575, 'recall': 0.48065490166311364, 'f1-score': 0.47343570147075686, 'support': 1554554}}
[[174586 221394 119155]
 [ 73108 335816 111332]
 [ 73219 209142 236802]]
Evaluating performance on  val set...
1786/1786 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0352694
{'0': {'precision': 0.5508631891590867, 'recall': 0.3679045865645088, 'f1-score': 0.4411671789458818, 'support': 161319}, '1': {'precision': 0.3842587801899874, 'recall': 0.5569445590143158, 'f1-score': 0.45476004592422503, 'support': 133349}, '2': {'precision': 0.5019240989390243, 'recall': 0.48231964313182585, 'f1-score': 0.4919266273823195, 'support': 162525}, 'accuracy': 0.4637144488213949, 'macro avg': {'precision': 0.4790153560960328, 'recall': 0.4690562629035502, 'f1-score': 0.4626179507508088, 'support': 457193}, 'weighted avg': {'precision': 0.48487277161193254, 'recall': 0.4637144488213949, 'f1-score': 0.46317599048898755, 'support': 457193}}
[[59350 60249 41720]
 [23013 74268 36068]
 [25377 58759 78389]]
training model: results/AAPL/W1/deepVOL_L2/h50
Epoch 1/50
6073/6073 - 170s - loss: 3.1857 - accuracy50: 0.4280 - val_loss: 3.2540 - val_accuracy50: 0.3980 - 170s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 169s - loss: 3.1576 - accuracy50: 0.4425 - val_loss: 3.2299 - val_accuracy50: 0.4240 - 169s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 169s - loss: 3.1387 - accuracy50: 0.4511 - val_loss: 3.2260 - val_accuracy50: 0.4209 - 169s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 174s - loss: 3.1245 - accuracy50: 0.4572 - val_loss: 3.2263 - val_accuracy50: 0.4160 - 174s/epoch - 29ms/step
Epoch 5/50
6073/6073 - 176s - loss: 3.1118 - accuracy50: 0.4614 - val_loss: 3.2235 - val_accuracy50: 0.4159 - 176s/epoch - 29ms/step
Epoch 6/50
6073/6073 - 177s - loss: 3.1023 - accuracy50: 0.4648 - val_loss: 3.2219 - val_accuracy50: 0.4172 - 177s/epoch - 29ms/step
Epoch 7/50
6073/6073 - 172s - loss: 3.0955 - accuracy50: 0.4671 - val_loss: 3.2134 - val_accuracy50: 0.4209 - 172s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 166s - loss: 3.0900 - accuracy50: 0.4690 - val_loss: 3.2093 - val_accuracy50: 0.4235 - 166s/epoch - 27ms/step
Epoch 9/50
6073/6073 - 168s - loss: 3.0856 - accuracy50: 0.4705 - val_loss: 3.2067 - val_accuracy50: 0.4225 - 168s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 168s - loss: 3.0820 - accuracy50: 0.4716 - val_loss: 3.2061 - val_accuracy50: 0.4246 - 168s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 168s - loss: 3.0786 - accuracy50: 0.4729 - val_loss: 3.2068 - val_accuracy50: 0.4245 - 168s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 168s - loss: 3.0762 - accuracy50: 0.4735 - val_loss: 3.2026 - val_accuracy50: 0.4253 - 168s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 169s - loss: 3.0738 - accuracy50: 0.4741 - val_loss: 3.2050 - val_accuracy50: 0.4239 - 169s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 169s - loss: 3.0714 - accuracy50: 0.4749 - val_loss: 3.1993 - val_accuracy50: 0.4264 - 169s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 170s - loss: 3.0694 - accuracy50: 0.4755 - val_loss: 3.2006 - val_accuracy50: 0.4251 - 170s/epoch - 28ms/step
Epoch 16/50
6073/6073 - 169s - loss: 3.0677 - accuracy50: 0.4759 - val_loss: 3.2004 - val_accuracy50: 0.4259 - 169s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 166s - loss: 3.0657 - accuracy50: 0.4766 - val_loss: 3.2009 - val_accuracy50: 0.4264 - 166s/epoch - 27ms/step
Epoch 18/50
6073/6073 - 169s - loss: 3.0638 - accuracy50: 0.4771 - val_loss: 3.1981 - val_accuracy50: 0.4266 - 169s/epoch - 28ms/step
Epoch 19/50
6073/6073 - 180s - loss: 3.0622 - accuracy50: 0.4773 - val_loss: 3.2021 - val_accuracy50: 0.4258 - 180s/epoch - 30ms/step
Epoch 20/50
6073/6073 - 181s - loss: 3.0608 - accuracy50: 0.4778 - val_loss: 3.2039 - val_accuracy50: 0.4255 - 181s/epoch - 30ms/step
Epoch 21/50
6073/6073 - 176s - loss: 3.0593 - accuracy50: 0.4781 - val_loss: 3.1999 - val_accuracy50: 0.4272 - 176s/epoch - 29ms/step
Epoch 22/50
6073/6073 - 166s - loss: 3.0577 - accuracy50: 0.4789 - val_loss: 3.2001 - val_accuracy50: 0.4276 - 166s/epoch - 27ms/step
Epoch 23/50
6073/6073 - 168s - loss: 3.0564 - accuracy50: 0.4792 - val_loss: 3.2001 - val_accuracy50: 0.4285 - 168s/epoch - 28ms/step
Epoch 24/50
6073/6073 - 168s - loss: 3.0552 - accuracy50: 0.4796 - val_loss: 3.1982 - val_accuracy50: 0.4287 - 168s/epoch - 28ms/step
Epoch 25/50
6073/6073 - 170s - loss: 3.0540 - accuracy50: 0.4798 - val_loss: 3.1982 - val_accuracy50: 0.4288 - 170s/epoch - 28ms/step
Epoch 26/50
6073/6073 - 170s - loss: 3.0527 - accuracy50: 0.4803 - val_loss: 3.1954 - val_accuracy50: 0.4290 - 170s/epoch - 28ms/step
Epoch 27/50
6073/6073 - 169s - loss: 3.0515 - accuracy50: 0.4807 - val_loss: 3.1952 - val_accuracy50: 0.4289 - 169s/epoch - 28ms/step
Epoch 28/50
6073/6073 - 169s - loss: 3.0501 - accuracy50: 0.4812 - val_loss: 3.1997 - val_accuracy50: 0.4287 - 169s/epoch - 28ms/step
Epoch 29/50
6073/6073 - 169s - loss: 3.0488 - accuracy50: 0.4814 - val_loss: 3.1963 - val_accuracy50: 0.4288 - 169s/epoch - 28ms/step
Epoch 30/50
6073/6073 - 170s - loss: 3.0479 - accuracy50: 0.4816 - val_loss: 3.1967 - val_accuracy50: 0.4292 - 170s/epoch - 28ms/step
Epoch 31/50
6073/6073 - 170s - loss: 3.0466 - accuracy50: 0.4821 - val_loss: 3.1980 - val_accuracy50: 0.4291 - 170s/epoch - 28ms/step
Epoch 32/50
6073/6073 - 169s - loss: 3.0458 - accuracy50: 0.4825 - val_loss: 3.1955 - val_accuracy50: 0.4300 - 169s/epoch - 28ms/step
Epoch 33/50
6073/6073 - 168s - loss: 3.0442 - accuracy50: 0.4828 - val_loss: 3.1982 - val_accuracy50: 0.4292 - 168s/epoch - 28ms/step
Epoch 34/50
6073/6073 - 175s - loss: 3.0433 - accuracy50: 0.4833 - val_loss: 3.1971 - val_accuracy50: 0.4289 - 175s/epoch - 29ms/step
Epoch 35/50
6073/6073 - 173s - loss: 3.0422 - accuracy50: 0.4838 - val_loss: 3.1973 - val_accuracy50: 0.4294 - 173s/epoch - 28ms/step
Epoch 36/50
6073/6073 - 185s - loss: 3.0416 - accuracy50: 0.4839 - val_loss: 3.1960 - val_accuracy50: 0.4285 - 185s/epoch - 30ms/step
Epoch 37/50
6073/6073 - 170s - loss: 3.0405 - accuracy50: 0.4844 - val_loss: 3.1982 - val_accuracy50: 0.4297 - 170s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h50
Evaluating performance on  test set...
21353/21353 - 300s - 300s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0885519
{'0': {'precision': 0.4804654667171439, 'recall': 0.43463254114750466, 'f1-score': 0.45640122683729273, 'support': 2081961}, '1': {'precision': 0.2671764246590803, 'recall': 0.33661683014217436, 'f1-score': 0.2979035636529678, 'support': 1286941}, '2': {'precision': 0.483034632261959, 'recall': 0.45174043956201143, 'f1-score': 0.4668637058879182, 'support': 2097315}, 'accuracy': 0.418120246598333, 'macro avg': {'precision': 0.4102255078793944, 'recall': 0.4076632702838969, 'f1-score': 0.4070561654593929, 'support': 5466217}, 'weighted avg': {'precision': 0.431235429995107, 'recall': 0.418120246598333, 'f1-score': 0.42309958021293886, 'support': 5466217}}
[[904888 606798 570275]
 [410015 433206 443720]
 [568454 581419 947442]]
Evaluating performance on  train set...
6073/6073 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0520382
{'0': {'precision': 0.4916320406278855, 'recall': 0.3442073182463607, 'f1-score': 0.4049183481774046, 'support': 519742}, '1': {'precision': 0.3920844525641415, 'recall': 0.5323966955134878, 'f1-score': 0.4515926957330132, 'support': 509126}, '2': {'precision': 0.4740168581516112, 'recall': 0.4502630848072804, 'f1-score': 0.4618347383342325, 'support': 525686}, 'accuracy': 0.44170418010567664, 'macro avg': {'precision': 0.4525777837812128, 'recall': 0.44228903285570964, 'f1-score': 0.43944859408155007, 'support': 1554554}, 'weighted avg': {'precision': 0.45307286536876656, 'recall': 0.44170418010567664, 'f1-score': 0.4394512581628917, 'support': 1554554}}
[[178899 218155 122688]
 [ 98111 271057 139958]
 [ 86878 202111 236697]]
Evaluating performance on  val set...
1786/1786 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0666186
{'0': {'precision': 0.4974853903256108, 'recall': 0.37088957473444145, 'f1-score': 0.42495961371181057, 'support': 161358}, '1': {'precision': 0.34038856243146737, 'recall': 0.4558345130877436, 'f1-score': 0.3897421699701575, 'support': 132796}, '2': {'precision': 0.4777035225479533, 'recall': 0.46604800078508823, 'f1-score': 0.4718037876435889, 'support': 163039}, 'accuracy': 0.4294969520530717, 'macro avg': {'precision': 0.4385258251016772, 'recall': 0.43092402953575776, 'f1-score': 0.42883519044185237, 'support': 457193}, 'weighted avg': {'precision': 0.4448007553954343, 'recall': 0.4294969520530717, 'f1-score': 0.43143541630403454, 'support': 457193}}
[[59846 60498 41014]
 [30200 60533 42063]
 [30251 56804 75984]]
training model: results/AAPL/W1/deepVOL_L2/h100
Epoch 1/50
6073/6073 - 172s - loss: 3.2290 - accuracy100: 0.4085 - val_loss: 3.3846 - val_accuracy100: 0.3338 - 172s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 171s - loss: 3.2178 - accuracy100: 0.4149 - val_loss: 3.3565 - val_accuracy100: 0.3426 - 171s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 169s - loss: 3.2106 - accuracy100: 0.4181 - val_loss: 3.4323 - val_accuracy100: 0.3348 - 169s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 169s - loss: 3.1985 - accuracy100: 0.4240 - val_loss: 3.4612 - val_accuracy100: 0.3392 - 169s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 170s - loss: 3.1910 - accuracy100: 0.4276 - val_loss: 3.4233 - val_accuracy100: 0.3350 - 170s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 171s - loss: 3.1842 - accuracy100: 0.4309 - val_loss: 3.4530 - val_accuracy100: 0.3355 - 171s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 170s - loss: 3.1784 - accuracy100: 0.4338 - val_loss: 3.4808 - val_accuracy100: 0.3393 - 170s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 172s - loss: 3.1741 - accuracy100: 0.4359 - val_loss: 3.4919 - val_accuracy100: 0.3363 - 172s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 174s - loss: 3.1728 - accuracy100: 0.4361 - val_loss: 3.5224 - val_accuracy100: 0.3351 - 174s/epoch - 29ms/step
Epoch 10/50
6073/6073 - 169s - loss: 3.1704 - accuracy100: 0.4373 - val_loss: 3.4448 - val_accuracy100: 0.3426 - 169s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 167s - loss: 3.1676 - accuracy100: 0.4386 - val_loss: 3.3751 - val_accuracy100: 0.3462 - 167s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 169s - loss: 3.1649 - accuracy100: 0.4397 - val_loss: 3.5432 - val_accuracy100: 0.3425 - 169s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h100
Evaluating performance on  test set...
21353/21353 - 323s - 323s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1473409
{'0': {'precision': 0.4537466532717423, 'recall': 0.047973999705235124, 'f1-score': 0.08677355289700965, 'support': 1967670}, '1': {'precision': 0.27776118480369866, 'recall': 0.9112234665322602, 'f1-score': 0.42574562993819093, 'support': 1523736}, '2': {'precision': 0.462736450932697, 'recall': 0.06078455102792115, 'f1-score': 0.10745405555406361, 'support': 1974811}, 'accuracy': 0.2932373522675737, 'macro avg': {'precision': 0.3980814296693793, 'recall': 0.3399940057551388, 'f1-score': 0.20665774612975474, 'support': 5466217}, 'weighted avg': {'precision': 0.40793759694028026, 'recall': 0.2932373522675737, 'f1-score': 0.18873511807363927, 'support': 5466217}}
[[  94397 1807499   65774]
 [  61675 1388464   73597]
 [  51967 1802806  120038]]
Evaluating performance on  train set...
6073/6073 - 91s - 91s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.112841
{'0': {'precision': 0.4625415899867156, 'recall': 0.07328904680982543, 'f1-score': 0.12652965288694112, 'support': 517840}, '1': {'precision': 0.3356320252256407, 'recall': 0.8811746424674278, 'f1-score': 0.48610915387163833, 'support': 518694}, '2': {'precision': 0.4611611900933938, 'recall': 0.09856183158951391, 'f1-score': 0.1624120852379544, 'support': 518020}, 'accuracy': 0.3512705251795692, 'macro avg': {'precision': 0.41977826843525, 'recall': 0.35100850695558905, 'f1-score': 0.25835029733217796, 'support': 1554554}, 'weighted avg': {'precision': 0.41973683406513324, 'recall': 0.3512705251795692, 'f1-score': 0.2584643089299145, 'support': 1554554}}
[[ 37952 455754  24134]
 [ 26111 457060  35523]
 [ 17988 448975  51057]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1186607
{'0': {'precision': 0.47413994851392466, 'recall': 0.07911693112739675, 'f1-score': 0.13560607750831086, 'support': 153646}, '1': {'precision': 0.3242418028687459, 'recall': 0.8845644817988321, 'f1-score': 0.4745388669301713, 'support': 146584}, '2': {'precision': 0.46599703086010297, 'recall': 0.09399030344730924, 'f1-score': 0.15642926063767748, 'support': 156963}, 'accuracy': 0.34246368601444027, 'macro avg': {'precision': 0.4214595940809245, 'recall': 0.35255723879117934, 'f1-score': 0.25552473502538653, 'support': 457193}, 'weighted avg': {'precision': 0.4232843873724599, 'recall': 0.34246368601444027, 'f1-score': 0.25142279670162476, 'support': 457193}}
[[ 12156 133942   7548]
 [  7563 129663   9358]
 [  5919 136291  14753]]
training model: results/AAPL/W1/deepVOL_L2/h200
Epoch 1/50
6073/6073 - 172s - loss: 3.2748 - accuracy200: 0.3751 - val_loss: 3.3030 - val_accuracy200: 0.3388 - 172s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 170s - loss: 3.2673 - accuracy200: 0.3817 - val_loss: 3.3027 - val_accuracy200: 0.3452 - 170s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 174s - loss: 3.2591 - accuracy200: 0.3892 - val_loss: 3.3191 - val_accuracy200: 0.3434 - 174s/epoch - 29ms/step
Epoch 4/50
6073/6073 - 174s - loss: 3.2515 - accuracy200: 0.3947 - val_loss: 3.3387 - val_accuracy200: 0.3396 - 174s/epoch - 29ms/step
Epoch 5/50
6073/6073 - 178s - loss: 3.2481 - accuracy200: 0.3966 - val_loss: 3.3337 - val_accuracy200: 0.3433 - 178s/epoch - 29ms/step
Epoch 6/50
6073/6073 - 172s - loss: 3.2438 - accuracy200: 0.3991 - val_loss: 3.3502 - val_accuracy200: 0.3422 - 172s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 169s - loss: 3.2411 - accuracy200: 0.4010 - val_loss: 3.3422 - val_accuracy200: 0.3428 - 169s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 170s - loss: 3.2385 - accuracy200: 0.4025 - val_loss: 3.3482 - val_accuracy200: 0.3432 - 170s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 168s - loss: 3.2365 - accuracy200: 0.4036 - val_loss: 3.3438 - val_accuracy200: 0.3432 - 168s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 170s - loss: 3.2345 - accuracy200: 0.4041 - val_loss: 3.3461 - val_accuracy200: 0.3426 - 170s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 172s - loss: 3.2328 - accuracy200: 0.4051 - val_loss: 3.3461 - val_accuracy200: 0.3422 - 172s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 170s - loss: 3.2311 - accuracy200: 0.4059 - val_loss: 3.3489 - val_accuracy200: 0.3440 - 170s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h200
Evaluating performance on  test set...
21353/21353 - 333s - 333s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134683
{'0': {'precision': 0.4187755542453285, 'recall': 0.0543886104781319, 'f1-score': 0.09627364959442652, 'support': 1998047}, '1': {'precision': 0.26728471226368106, 'recall': 0.7759964368634577, 'f1-score': 0.3976147455903373, 'support': 1466124}, '2': {'precision': 0.4111993045557492, 'recall': 0.19515785351585327, 'f1-score': 0.264691436642809, 'support': 2002046}, 'accuracy': 0.29949286682178916, 'macro avg': {'precision': 0.3657531903549196, 'recall': 0.3418476336191476, 'f1-score': 0.25285994394252426, 'support': 5466217}, 'weighted avg': {'precision': 0.3753685033368987, 'recall': 0.29949286682178916, 'f1-score': 0.238782366301973, 'support': 5466217}}
[[ 108671 1584200  305176]
 [  74124 1137707  254293]
 [  76702 1534629  390715]]
Evaluating performance on  train set...
6073/6073 - 92s - 92s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985471
{'0': {'precision': 0.4141431952113591, 'recall': 0.08593573980107647, 'f1-score': 0.142336336815246, 'support': 519295}, '1': {'precision': 0.332592974722131, 'recall': 0.6911207220832984, 'f1-score': 0.4490745753760873, 'support': 513071}, '2': {'precision': 0.39011793016663643, 'recall': 0.2843765080775506, 'f1-score': 0.3289586049309011, 'support': 522188}, 'accuracy': 0.3523312795824397, 'macro avg': {'precision': 0.37895136670004215, 'recall': 0.35381098998730853, 'f1-score': 0.3067898390407448, 'support': 1554554}, 'weighted avg': {'precision': 0.37915775354783215, 'recall': 0.3523312795824397, 'f1-score': 0.3062614264161393, 'support': 1554554}}
[[ 44626 366830 107839]
 [ 34165 354594 124312]
 [ 28964 344726 148498]]
Evaluating performance on  val set...
1786/1786 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1015601
{'0': {'precision': 0.4087626529687264, 'recall': 0.08747890302179859, 'f1-score': 0.14411573575940936, 'support': 154643}, '1': {'precision': 0.31977068237917033, 'recall': 0.6969657001242598, 'f1-score': 0.43840114578148065, 'support': 144053}, '2': {'precision': 0.39866331284109585, 'recall': 0.27698946983223655, 'f1-score': 0.32687067232521777, 'support': 158497}, 'accuracy': 0.34521525920125634, 'macro avg': {'precision': 0.3757322160629975, 'recall': 0.35381135765943167, 'f1-score': 0.3031291846220359, 'support': 457193}, 'weighted avg': {'precision': 0.3772217600601596, 'recall': 0.34521525920125634, 'f1-score': 0.30019600240999317, 'support': 457193}}
[[ 13528 108140  32975]
 [ 10407 100400  33246]
 [  9160 105435  43902]]
training model: results/AAPL/W1/deepVOL_L2/h300
Epoch 1/50
6073/6073 - 190s - loss: 3.2594 - accuracy300: 0.3860 - val_loss: 3.2956 - val_accuracy300: 0.3419 - 190s/epoch - 31ms/step
Epoch 2/50
6073/6073 - 171s - loss: 3.2560 - accuracy300: 0.3898 - val_loss: 3.2944 - val_accuracy300: 0.3468 - 171s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 173s - loss: 3.2560 - accuracy300: 0.3908 - val_loss: 3.2939 - val_accuracy300: 0.3500 - 173s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 173s - loss: 3.2513 - accuracy300: 0.3935 - val_loss: 3.2941 - val_accuracy300: 0.3482 - 173s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 167s - loss: 3.2475 - accuracy300: 0.3960 - val_loss: 3.2961 - val_accuracy300: 0.3435 - 167s/epoch - 27ms/step
Epoch 6/50
6073/6073 - 171s - loss: 3.2407 - accuracy300: 0.4002 - val_loss: 3.2979 - val_accuracy300: 0.3460 - 171s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 169s - loss: 3.2361 - accuracy300: 0.4023 - val_loss: 3.3030 - val_accuracy300: 0.3447 - 169s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 171s - loss: 3.2320 - accuracy300: 0.4043 - val_loss: 3.3050 - val_accuracy300: 0.3451 - 171s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 172s - loss: 3.2295 - accuracy300: 0.4052 - val_loss: 3.3044 - val_accuracy300: 0.3450 - 172s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 167s - loss: 3.2274 - accuracy300: 0.4062 - val_loss: 3.3067 - val_accuracy300: 0.3435 - 167s/epoch - 27ms/step
Epoch 11/50
6073/6073 - 174s - loss: 3.2256 - accuracy300: 0.4075 - val_loss: 3.3065 - val_accuracy300: 0.3443 - 174s/epoch - 29ms/step
Epoch 12/50
6073/6073 - 171s - loss: 3.2237 - accuracy300: 0.4085 - val_loss: 3.3087 - val_accuracy300: 0.3457 - 171s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 167s - loss: 3.2223 - accuracy300: 0.4094 - val_loss: 3.3108 - val_accuracy300: 0.3454 - 167s/epoch - 27ms/step
testing model: results/AAPL/W1/deepVOL_L2/h300
Evaluating performance on  test set...
21353/21353 - 335s - 335s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979925
{'0': {'precision': 0.36621470868675565, 'recall': 0.29438192330685975, 'f1-score': 0.3263927942263879, 'support': 1903534}, '1': {'precision': 0.29365255034082893, 'recall': 0.1822246613572936, 'f1-score': 0.22489304058757173, 'support': 1645392}, '2': {'precision': 0.36914909674719215, 'recall': 0.5612486576111816, 'f1-score': 0.44536744427252306, 'support': 1917291}, 'accuracy': 0.3542256006301982, 'macro avg': {'precision': 0.34300545192492554, 'recall': 0.34595174742511164, 'f1-score': 0.3322177596954942, 'support': 5466217}, 'weighted avg': {'precision': 0.34540193835101185, 'recall': 0.3542256006301982, 'f1-score': 0.3375709349994903, 'support': 5466217}}
[[ 560366  365422  977746]
 [ 484364  299831  861197]
 [ 485427  355787 1076077]]
Evaluating performance on  train set...
6073/6073 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963947
{'0': {'precision': 0.3686728189604632, 'recall': 0.30378691938457747, 'f1-score': 0.33309943643157036, 'support': 519578}, '1': {'precision': 0.332732239314835, 'recall': 0.15827318449508193, 'f1-score': 0.21450920314446836, 'support': 511786}, '2': {'precision': 0.3588172271953032, 'recall': 0.6055677669680231, 'f1-score': 0.4506253173522899, 'support': 523190}, 'accuracy': 0.35744657310070926, 'macro avg': {'precision': 0.35340742849020046, 'recall': 0.3558759569492275, 'f1-score': 0.33274465230944283, 'support': 1554554}, 'weighted avg': {'precision': 0.35352362983603813, 'recall': 0.35744657310070926, 'f1-score': 0.333611187394122, 'support': 1554554}}
[[157841  83301 278436]
 [143071  81002 287713]
 [127221  79142 316827]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974414
{'0': {'precision': 0.34508657956384187, 'recall': 0.2918246614882942, 'f1-score': 0.31622859756412436, 'support': 146893}, '1': {'precision': 0.3546420458708874, 'recall': 0.15120689331975332, 'f1-score': 0.21201713729991153, 'support': 160039}, '2': {'precision': 0.35117871699082487, 'recall': 0.6187234212470302, 'f1-score': 0.4480503520498894, 'support': 150261}, 'accuracy': 0.35004035494856656, 'macro avg': {'precision': 0.35030244747518474, 'recall': 0.3539183253516926, 'f1-score': 0.32543202897130846, 'support': 457193}, 'weighted avg': {'precision': 0.35043368228463845, 'recall': 0.35004035494856656, 'f1-score': 0.3230742202258038, 'support': 457193}}
[[42867 22373 81653]
 [45726 24199 90114]
 [35628 21663 92970]]
training model: results/AAPL/W1/deepVOL_L2/h500
Epoch 1/50
6073/6073 - 176s - loss: 3.2749 - accuracy500: 0.3774 - val_loss: 3.3234 - val_accuracy500: 0.3111 - 176s/epoch - 29ms/step
Epoch 2/50
6073/6073 - 169s - loss: 3.2718 - accuracy500: 0.3769 - val_loss: 3.3230 - val_accuracy500: 0.3115 - 169s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 169s - loss: 3.2640 - accuracy500: 0.3837 - val_loss: 3.3235 - val_accuracy500: 0.3112 - 169s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 168s - loss: 3.2633 - accuracy500: 0.3835 - val_loss: 3.3273 - val_accuracy500: 0.3138 - 168s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 168s - loss: 3.2553 - accuracy500: 0.3897 - val_loss: 3.3207 - val_accuracy500: 0.3250 - 168s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 170s - loss: 3.2490 - accuracy500: 0.3940 - val_loss: 3.3202 - val_accuracy500: 0.3256 - 170s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 169s - loss: 3.2445 - accuracy500: 0.3970 - val_loss: 3.3180 - val_accuracy500: 0.3289 - 169s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 168s - loss: 3.2397 - accuracy500: 0.3994 - val_loss: 3.3217 - val_accuracy500: 0.3263 - 168s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 168s - loss: 3.2355 - accuracy500: 0.4022 - val_loss: 3.3250 - val_accuracy500: 0.3303 - 168s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 168s - loss: 3.2317 - accuracy500: 0.4044 - val_loss: 3.3270 - val_accuracy500: 0.3235 - 168s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 168s - loss: 3.2287 - accuracy500: 0.4059 - val_loss: 3.3257 - val_accuracy500: 0.3309 - 168s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 169s - loss: 3.2255 - accuracy500: 0.4073 - val_loss: 3.3247 - val_accuracy500: 0.3356 - 169s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 169s - loss: 3.2217 - accuracy500: 0.4094 - val_loss: 3.3286 - val_accuracy500: 0.3349 - 169s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 168s - loss: 3.2184 - accuracy500: 0.4108 - val_loss: 3.3279 - val_accuracy500: 0.3330 - 168s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 169s - loss: 3.2161 - accuracy500: 0.4115 - val_loss: 3.3314 - val_accuracy500: 0.3307 - 169s/epoch - 28ms/step
Epoch 16/50
6073/6073 - 170s - loss: 3.2135 - accuracy500: 0.4126 - val_loss: 3.3319 - val_accuracy500: 0.3327 - 170s/epoch - 28ms/step
Epoch 17/50
6073/6073 - 172s - loss: 3.2114 - accuracy500: 0.4138 - val_loss: 3.3320 - val_accuracy500: 0.3350 - 172s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h500
Evaluating performance on  test set...
21353/21353 - 301s - 301s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1172782
{'0': {'precision': 0.3626700918355919, 'recall': 0.05033122682881457, 'f1-score': 0.08839502360541655, 'support': 2058861}, '1': {'precision': 0.2486430206413191, 'recall': 0.7033821836160415, 'f1-score': 0.3674084888036247, 'support': 1308829}, '2': {'precision': 0.4101358355142615, 'recall': 0.28885308599794046, 'f1-score': 0.33897247329854874, 'support': 2098527}, 'accuracy': 0.29826807095290947, 'macro avg': {'precision': 0.3404829826637242, 'recall': 0.3475221654809322, 'f1-score': 0.26492532856919665, 'support': 5466217}, 'weighted avg': {'precision': 0.3535899925860814, 'recall': 0.29826807095290947, 'f1-score': 0.25140071079531134, 'support': 5466217}}
[[ 103625 1396561  558675]
 [  75099  920607  313123]
 [ 107004 1385357  606166]]
Evaluating performance on  train set...
6073/6073 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019596
{'0': {'precision': 0.339594208302262, 'recall': 0.042391156792397945, 'f1-score': 0.07537352289066891, 'support': 515650}, '1': {'precision': 0.3360306917254023, 'recall': 0.8055179638561489, 'f1-score': 0.47423078686720466, 'support': 513559}, '2': {'precision': 0.37424596206171246, 'recall': 0.18458156068869028, 'f1-score': 0.2472279941360189, 'support': 525345}, 'accuracy': 0.3425477661116951, 'macro avg': {'precision': 0.3499569540297922, 'recall': 0.34416356044574575, 'f1-score': 0.26561076796463085, 'support': 1554554}, 'weighted avg': {'precision': 0.3501271647444718, 'recall': 0.3425477661116951, 'f1-score': 0.265215512829207, 'support': 1554554}}
[[ 21859 409066  84725]
 [ 22467 413681  77411]
 [ 20042 408334  96969]]
Evaluating performance on  val set...
1786/1786 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065171
{'0': {'precision': 0.33140084441363665, 'recall': 0.03360641071519861, 'f1-score': 0.06102450147078448, 'support': 156488}, '1': {'precision': 0.3163264720566041, 'recall': 0.7752424214723193, 'f1-score': 0.44931602874859644, 'support': 142211}, '2': {'precision': 0.3773572706308326, 'recall': 0.22094211768268832, 'f1-score': 0.27870365948776726, 'support': 158494}, 'accuracy': 0.32923732428099295, 'macro avg': {'precision': 0.3416948623670244, 'recall': 0.3432636499567354, 'f1-score': 0.2630147299023828, 'support': 457193}, 'weighted avg': {'precision': 0.34264352802778275, 'recall': 0.32923732428099295, 'f1-score': 0.25726584124730906, 'support': 457193}}
[[  5259 119879  31350]
 [  5533 110248  26430]
 [  5077 118399  35018]]
training model: results/AAPL/W1/deepVOL_L2/h1000
Epoch 1/50
6073/6073 - 171s - loss: 3.2731 - accuracy1000: 0.3807 - val_loss: 3.3640 - val_accuracy1000: 0.3070 - 171s/epoch - 28ms/step
Epoch 2/50
6073/6073 - 170s - loss: 3.2710 - accuracy1000: 0.3802 - val_loss: 3.3444 - val_accuracy1000: 0.3070 - 170s/epoch - 28ms/step
Epoch 3/50
6073/6073 - 168s - loss: 3.2749 - accuracy1000: 0.3752 - val_loss: 3.3453 - val_accuracy1000: 0.3070 - 168s/epoch - 28ms/step
Epoch 4/50
6073/6073 - 169s - loss: 3.2737 - accuracy1000: 0.3773 - val_loss: 3.3490 - val_accuracy1000: 0.3100 - 169s/epoch - 28ms/step
Epoch 5/50
6073/6073 - 170s - loss: 3.2693 - accuracy1000: 0.3811 - val_loss: 3.3366 - val_accuracy1000: 0.3068 - 170s/epoch - 28ms/step
Epoch 6/50
6073/6073 - 169s - loss: 3.2628 - accuracy1000: 0.3857 - val_loss: 3.3594 - val_accuracy1000: 0.3066 - 169s/epoch - 28ms/step
Epoch 7/50
6073/6073 - 168s - loss: 3.2559 - accuracy1000: 0.3895 - val_loss: 3.3525 - val_accuracy1000: 0.3061 - 168s/epoch - 28ms/step
Epoch 8/50
6073/6073 - 168s - loss: 3.2489 - accuracy1000: 0.3953 - val_loss: 3.3633 - val_accuracy1000: 0.3067 - 168s/epoch - 28ms/step
Epoch 9/50
6073/6073 - 169s - loss: 3.2427 - accuracy1000: 0.3985 - val_loss: 3.3685 - val_accuracy1000: 0.3078 - 169s/epoch - 28ms/step
Epoch 10/50
6073/6073 - 170s - loss: 3.2375 - accuracy1000: 0.4013 - val_loss: 3.3737 - val_accuracy1000: 0.3097 - 170s/epoch - 28ms/step
Epoch 11/50
6073/6073 - 167s - loss: 3.2333 - accuracy1000: 0.4035 - val_loss: 3.3892 - val_accuracy1000: 0.3111 - 167s/epoch - 28ms/step
Epoch 12/50
6073/6073 - 168s - loss: 3.2301 - accuracy1000: 0.4052 - val_loss: 3.3891 - val_accuracy1000: 0.3099 - 168s/epoch - 28ms/step
Epoch 13/50
6073/6073 - 168s - loss: 3.2260 - accuracy1000: 0.4071 - val_loss: 3.3870 - val_accuracy1000: 0.3095 - 168s/epoch - 28ms/step
Epoch 14/50
6073/6073 - 168s - loss: 3.2230 - accuracy1000: 0.4084 - val_loss: 3.3919 - val_accuracy1000: 0.3090 - 168s/epoch - 28ms/step
Epoch 15/50
6073/6073 - 168s - loss: 3.2204 - accuracy1000: 0.4098 - val_loss: 3.3752 - val_accuracy1000: 0.3091 - 168s/epoch - 28ms/step
testing model: results/AAPL/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
21353/21353 - 315s - 315s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1306239
{'0': {'precision': 0.3677166090288812, 'recall': 0.009620477517250689, 'f1-score': 0.018750393194916014, 'support': 2044701}, '1': {'precision': 0.24454572407072336, 'recall': 0.9883857222948982, 'f1-score': 0.39208263011258104, 'support': 1337750}, '2': {'precision': 0.38822135725165, 'recall': 0.0011008913668809261, 'f1-score': 0.0021955567253281014, 'support': 2083766}, 'accuracy': 0.24590644681687537, 'macro avg': {'precision': 0.3334945634504182, 'recall': 0.3330356970596766, 'f1-score': 0.13767619334427506, 'support': 5466217}, 'weighted avg': {'precision': 0.3453895125803484, 'recall': 0.24590644681687537, 'f1-score': 0.10380533970833089, 'support': 5466217}}
[[  19671 2022748    2282]
 [  14204 1322213    1333]
 [  19620 2061852    2294]]
Evaluating performance on  train set...
6073/6073 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1063429
{'0': {'precision': 0.3690548913517759, 'recall': 0.008269682783650706, 'f1-score': 0.016176878424772157, 'support': 511386}, '1': {'precision': 0.33020844077786926, 'recall': 0.9917177286586851, 'f1-score': 0.4954490991153216, 'support': 513265}, '2': {'precision': 0.3620474406991261, 'recall': 0.0010945399441029773, 'f1-score': 0.00218248182049087, 'support': 529903}, 'accuracy': 0.33052759826934286, 'macro avg': {'precision': 0.3537702576095904, 'recall': 0.3336939837954796, 'f1-score': 0.1712694864535282, 'support': 1554554}, 'weighted avg': {'precision': 0.3538403715750378, 'recall': 0.33052759826934286, 'f1-score': 0.16964725231267597, 'support': 1554554}}
[[  4229 506658    499]
 [  3728 509014    523]
 [  3502 525821    580]]
Evaluating performance on  val set...
1786/1786 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1130874
{'0': {'precision': 0.31991786447638604, 'recall': 0.004934158437790967, 'f1-score': 0.009718427585862745, 'support': 157879}, '1': {'precision': 0.30668377520611684, 'recall': 0.9929028994078624, 'f1-score': 0.4686216249392544, 'support': 140339}, '2': {'precision': 0.35148514851485146, 'recall': 0.0008932222047491744, 'f1-score': 0.0017819160617145295, 'support': 158975}, 'accuracy': 0.3067938485497372, 'macro avg': {'precision': 0.32602892939911815, 'recall': 0.33291009335013416, 'f1-score': 0.16004065619561056, 'support': 457193}, 'weighted avg': {'precision': 0.32683212196920575, 'recall': 0.3067938485497372, 'f1-score': 0.147822704978181, 'support': 457193}}
[[   779 156966    134]
 [   868 139343    128]
 [   788 158045    142]]
training model: results/AAPL/W1/deepVOL_L3/h10
Epoch 1/50
6073/6073 - 244s - loss: 3.0824 - accuracy10: 0.4374 - val_loss: 3.2088 - val_accuracy10: 0.4373 - 244s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 245s - loss: 2.9064 - accuracy10: 0.4978 - val_loss: 3.0799 - val_accuracy10: 0.4778 - 245s/epoch - 40ms/step
Epoch 3/50
6073/6073 - 238s - loss: 2.8446 - accuracy10: 0.5156 - val_loss: 3.0827 - val_accuracy10: 0.5065 - 238s/epoch - 39ms/step
Epoch 4/50
6073/6073 - 241s - loss: 2.8126 - accuracy10: 0.5228 - val_loss: 3.0452 - val_accuracy10: 0.5079 - 241s/epoch - 40ms/step
Epoch 5/50
6073/6073 - 259s - loss: 2.7901 - accuracy10: 0.5276 - val_loss: 3.0199 - val_accuracy10: 0.5122 - 259s/epoch - 43ms/step
Epoch 6/50
6073/6073 - 247s - loss: 2.7740 - accuracy10: 0.5321 - val_loss: 2.9980 - val_accuracy10: 0.5160 - 247s/epoch - 41ms/step
Epoch 7/50
6073/6073 - 248s - loss: 2.7613 - accuracy10: 0.5347 - val_loss: 2.9768 - val_accuracy10: 0.5178 - 248s/epoch - 41ms/step
Epoch 8/50
6073/6073 - 251s - loss: 2.7504 - accuracy10: 0.5370 - val_loss: 2.9572 - val_accuracy10: 0.5205 - 251s/epoch - 41ms/step
Epoch 9/50
6073/6073 - 260s - loss: 2.7416 - accuracy10: 0.5393 - val_loss: 2.9437 - val_accuracy10: 0.5171 - 260s/epoch - 43ms/step
Epoch 10/50
6073/6073 - 243s - loss: 2.7342 - accuracy10: 0.5407 - val_loss: 2.9296 - val_accuracy10: 0.5176 - 243s/epoch - 40ms/step
Epoch 11/50
6073/6073 - 240s - loss: 2.7280 - accuracy10: 0.5420 - val_loss: 2.9488 - val_accuracy10: 0.5279 - 240s/epoch - 40ms/step
Epoch 12/50
6073/6073 - 237s - loss: 2.7220 - accuracy10: 0.5434 - val_loss: 2.9259 - val_accuracy10: 0.5246 - 237s/epoch - 39ms/step
Epoch 13/50
6073/6073 - 238s - loss: 2.7164 - accuracy10: 0.5443 - val_loss: 2.9183 - val_accuracy10: 0.5216 - 238s/epoch - 39ms/step
Epoch 14/50
6073/6073 - 237s - loss: 2.7121 - accuracy10: 0.5453 - val_loss: 2.9153 - val_accuracy10: 0.5297 - 237s/epoch - 39ms/step
Epoch 15/50
6073/6073 - 238s - loss: 2.7084 - accuracy10: 0.5459 - val_loss: 2.9035 - val_accuracy10: 0.5263 - 238s/epoch - 39ms/step
Epoch 16/50
6073/6073 - 240s - loss: 2.7039 - accuracy10: 0.5471 - val_loss: 2.9113 - val_accuracy10: 0.5302 - 240s/epoch - 40ms/step
Epoch 17/50
6073/6073 - 238s - loss: 2.7004 - accuracy10: 0.5475 - val_loss: 2.9030 - val_accuracy10: 0.5276 - 238s/epoch - 39ms/step
Epoch 18/50
6073/6073 - 236s - loss: 2.6968 - accuracy10: 0.5490 - val_loss: 2.8993 - val_accuracy10: 0.5291 - 236s/epoch - 39ms/step
Epoch 19/50
6073/6073 - 236s - loss: 2.6932 - accuracy10: 0.5495 - val_loss: 2.9034 - val_accuracy10: 0.5305 - 236s/epoch - 39ms/step
Epoch 20/50
6073/6073 - 240s - loss: 2.6905 - accuracy10: 0.5500 - val_loss: 2.8995 - val_accuracy10: 0.5307 - 240s/epoch - 40ms/step
Epoch 21/50
6073/6073 - 240s - loss: 2.6881 - accuracy10: 0.5503 - val_loss: 2.8996 - val_accuracy10: 0.5335 - 240s/epoch - 40ms/step
Epoch 22/50
6073/6073 - 243s - loss: 2.6842 - accuracy10: 0.5514 - val_loss: 2.8957 - val_accuracy10: 0.5310 - 243s/epoch - 40ms/step
Epoch 23/50
6073/6073 - 243s - loss: 2.6821 - accuracy10: 0.5516 - val_loss: 2.8873 - val_accuracy10: 0.5287 - 243s/epoch - 40ms/step
Epoch 24/50
6073/6073 - 238s - loss: 2.6800 - accuracy10: 0.5522 - val_loss: 2.8892 - val_accuracy10: 0.5304 - 238s/epoch - 39ms/step
Epoch 25/50
6073/6073 - 238s - loss: 2.6773 - accuracy10: 0.5528 - val_loss: 2.8841 - val_accuracy10: 0.5304 - 238s/epoch - 39ms/step
Epoch 26/50
6073/6073 - 240s - loss: 2.6750 - accuracy10: 0.5534 - val_loss: 2.8879 - val_accuracy10: 0.5281 - 240s/epoch - 39ms/step
Epoch 27/50
6073/6073 - 240s - loss: 2.6735 - accuracy10: 0.5535 - val_loss: 2.8832 - val_accuracy10: 0.5306 - 240s/epoch - 40ms/step
Epoch 28/50
6073/6073 - 240s - loss: 2.6707 - accuracy10: 0.5543 - val_loss: 2.8815 - val_accuracy10: 0.5300 - 240s/epoch - 39ms/step
Epoch 29/50
6073/6073 - 239s - loss: 2.6688 - accuracy10: 0.5546 - val_loss: 2.8807 - val_accuracy10: 0.5289 - 239s/epoch - 39ms/step
Epoch 30/50
6073/6073 - 239s - loss: 2.6670 - accuracy10: 0.5552 - val_loss: 2.8794 - val_accuracy10: 0.5300 - 239s/epoch - 39ms/step
Epoch 31/50
6073/6073 - 237s - loss: 2.6655 - accuracy10: 0.5555 - val_loss: 2.8865 - val_accuracy10: 0.5302 - 237s/epoch - 39ms/step
Epoch 32/50
6073/6073 - 241s - loss: 2.6636 - accuracy10: 0.5559 - val_loss: 2.8773 - val_accuracy10: 0.5290 - 241s/epoch - 40ms/step
Epoch 33/50
6073/6073 - 239s - loss: 2.6621 - accuracy10: 0.5559 - val_loss: 2.8785 - val_accuracy10: 0.5267 - 239s/epoch - 39ms/step
Epoch 34/50
6073/6073 - 233s - loss: 2.6598 - accuracy10: 0.5563 - val_loss: 2.8799 - val_accuracy10: 0.5287 - 233s/epoch - 38ms/step
Epoch 35/50
6073/6073 - 235s - loss: 2.6585 - accuracy10: 0.5568 - val_loss: 2.8776 - val_accuracy10: 0.5273 - 235s/epoch - 39ms/step
Epoch 36/50
6073/6073 - 236s - loss: 2.6571 - accuracy10: 0.5573 - val_loss: 2.8816 - val_accuracy10: 0.5288 - 236s/epoch - 39ms/step
Epoch 37/50
6073/6073 - 237s - loss: 2.6552 - accuracy10: 0.5577 - val_loss: 2.8759 - val_accuracy10: 0.5290 - 237s/epoch - 39ms/step
Epoch 38/50
6073/6073 - 235s - loss: 2.6540 - accuracy10: 0.5578 - val_loss: 2.8774 - val_accuracy10: 0.5293 - 235s/epoch - 39ms/step
Epoch 39/50
6073/6073 - 245s - loss: 2.6523 - accuracy10: 0.5582 - val_loss: 2.8767 - val_accuracy10: 0.5279 - 245s/epoch - 40ms/step
Epoch 40/50
6073/6073 - 242s - loss: 2.6507 - accuracy10: 0.5586 - val_loss: 2.8822 - val_accuracy10: 0.5276 - 242s/epoch - 40ms/step
Epoch 41/50
6073/6073 - 238s - loss: 2.6502 - accuracy10: 0.5588 - val_loss: 2.8868 - val_accuracy10: 0.5281 - 238s/epoch - 39ms/step
Epoch 42/50
6073/6073 - 243s - loss: 2.6485 - accuracy10: 0.5587 - val_loss: 2.8839 - val_accuracy10: 0.5256 - 243s/epoch - 40ms/step
Epoch 43/50
6073/6073 - 237s - loss: 2.6469 - accuracy10: 0.5595 - val_loss: 2.8802 - val_accuracy10: 0.5265 - 237s/epoch - 39ms/step
Epoch 44/50
6073/6073 - 244s - loss: 2.6451 - accuracy10: 0.5594 - val_loss: 2.8787 - val_accuracy10: 0.5231 - 244s/epoch - 40ms/step
Epoch 45/50
6073/6073 - 242s - loss: 2.6442 - accuracy10: 0.5600 - val_loss: 2.8749 - val_accuracy10: 0.5257 - 242s/epoch - 40ms/step
Epoch 46/50
6073/6073 - 243s - loss: 2.6434 - accuracy10: 0.5599 - val_loss: 2.8831 - val_accuracy10: 0.5248 - 243s/epoch - 40ms/step
Epoch 47/50
6073/6073 - 245s - loss: 2.6423 - accuracy10: 0.5602 - val_loss: 2.8817 - val_accuracy10: 0.5276 - 245s/epoch - 40ms/step
Epoch 48/50
6073/6073 - 241s - loss: 2.6410 - accuracy10: 0.5605 - val_loss: 2.8795 - val_accuracy10: 0.5226 - 241s/epoch - 40ms/step
Epoch 49/50
6073/6073 - 245s - loss: 2.6394 - accuracy10: 0.5611 - val_loss: 2.8849 - val_accuracy10: 0.5251 - 245s/epoch - 40ms/step
Epoch 50/50
6073/6073 - 244s - loss: 2.6381 - accuracy10: 0.5609 - val_loss: 2.8885 - val_accuracy10: 0.5252 - 244s/epoch - 40ms/step
testing model: results/AAPL/W1/deepVOL_L3/h10
Evaluating performance on  test set...
21353/21353 - 393s - 393s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9892633
{'0': {'precision': 0.4945094511075397, 'recall': 0.6070529511364713, 'f1-score': 0.5450320763457059, 'support': 1805457}, '1': {'precision': 0.5774835940966082, 'recall': 0.2990807475330788, 'f1-score': 0.3940708441080242, 'support': 1836601}, '2': {'precision': 0.4895142040152592, 'recall': 0.6168524783201464, 'f1-score': 0.5458552842215559, 'support': 1824159}, 'accuracy': 0.5068472400565144, 'macro avg': {'precision': 0.520502416406469, 'recall': 0.5076620589965656, 'f1-score': 0.49498606822509533, 'support': 5466217}, 'weighted avg': {'precision': 0.5207210466309627, 'recall': 0.5068472400565144, 'f1-score': 0.49458514238143847, 'support': 5466217}}
[[1096008  197479  511970]
 [ 625835  549292  661474]
 [ 494511  204411 1125237]]
Evaluating performance on  train set...
6073/6073 - 113s - 113s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9015807
{'0': {'precision': 0.47421077099798403, 'recall': 0.5782942622596563, 'f1-score': 0.5211060456805113, 'support': 393343}, '1': {'precision': 0.697234598469744, 'recall': 0.5061718557109097, 'f1-score': 0.5865358779608163, 'support': 765491}, '2': {'precision': 0.4659666803427891, 'recall': 0.6113110279995957, 'f1-score': 0.5288340567488602, 'support': 395720}, 'accuracy': 0.5511844554772622, 'macro avg': {'precision': 0.5458040166035057, 'recall': 0.5652590486567206, 'f1-score': 0.5454919934633958, 'support': 1554554}, 'weighted avg': {'precision': 0.5819332310483338, 'recall': 0.5511844554772622, 'f1-score': 0.5552921056578747, 'support': 1554554}}
[[227468  85595  80280]
 [181056 387470 196965]
 [ 71153  82659 241908]]
Evaluating performance on  val set...
1786/1786 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9420336
{'0': {'precision': 0.47927530878882163, 'recall': 0.6034889128875366, 'f1-score': 0.5342572820276626, 'support': 126859}, '1': {'precision': 0.6637411900270712, 'recall': 0.4144596126361441, 'f1-score': 0.5102832715942637, 'support': 202910}, '2': {'precision': 0.4669903310629974, 'recall': 0.6257847815168257, 'f1-score': 0.5348501058096365, 'support': 127424}, 'accuracy': 0.5258085753718889, 'macro avg': {'precision': 0.5366689432929634, 'recall': 0.5479111023468355, 'f1-score': 0.5264635531438543, 'support': 457193}, 'weighted avg': {'precision': 0.5577204533127268, 'recall': 0.5258085753718889, 'f1-score': 0.5237824355635945, 'support': 457193}}
[[76558 21058 29243]
 [57042 84098 61770]
 [26137 21547 79740]]
training model: results/AAPL/W1/deepVOL_L3/h20
Epoch 1/50
6073/6073 - 241s - loss: 3.1856 - accuracy20: 0.4237 - val_loss: 3.2013 - val_accuracy20: 0.4480 - 241s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 245s - loss: 2.9974 - accuracy20: 0.4957 - val_loss: 3.1164 - val_accuracy20: 0.4759 - 245s/epoch - 40ms/step
Epoch 3/50
6073/6073 - 238s - loss: 2.9448 - accuracy20: 0.5113 - val_loss: 3.1049 - val_accuracy20: 0.4779 - 238s/epoch - 39ms/step
Epoch 4/50
6073/6073 - 237s - loss: 2.9150 - accuracy20: 0.5185 - val_loss: 3.0946 - val_accuracy20: 0.4811 - 237s/epoch - 39ms/step
Epoch 5/50
6073/6073 - 232s - loss: 2.8952 - accuracy20: 0.5228 - val_loss: 3.0774 - val_accuracy20: 0.4847 - 232s/epoch - 38ms/step
Epoch 6/50
6073/6073 - 250s - loss: 2.8800 - accuracy20: 0.5261 - val_loss: 3.0785 - val_accuracy20: 0.4861 - 250s/epoch - 41ms/step
Epoch 7/50
6073/6073 - 253s - loss: 2.8692 - accuracy20: 0.5286 - val_loss: 3.0621 - val_accuracy20: 0.4905 - 253s/epoch - 42ms/step
Epoch 8/50
6073/6073 - 236s - loss: 2.8605 - accuracy20: 0.5305 - val_loss: 3.0523 - val_accuracy20: 0.4921 - 236s/epoch - 39ms/step
Epoch 9/50
6073/6073 - 241s - loss: 2.8537 - accuracy20: 0.5323 - val_loss: 3.0440 - val_accuracy20: 0.4951 - 241s/epoch - 40ms/step
Epoch 10/50
6073/6073 - 236s - loss: 2.8489 - accuracy20: 0.5331 - val_loss: 3.0409 - val_accuracy20: 0.4957 - 236s/epoch - 39ms/step
Epoch 11/50
6073/6073 - 238s - loss: 2.8442 - accuracy20: 0.5340 - val_loss: 3.0300 - val_accuracy20: 0.4985 - 238s/epoch - 39ms/step
Epoch 12/50
6073/6073 - 237s - loss: 2.8396 - accuracy20: 0.5350 - val_loss: 3.0200 - val_accuracy20: 0.4995 - 237s/epoch - 39ms/step
Epoch 13/50
6073/6073 - 238s - loss: 2.8361 - accuracy20: 0.5358 - val_loss: 3.0217 - val_accuracy20: 0.4998 - 238s/epoch - 39ms/step
Epoch 14/50
6073/6073 - 236s - loss: 2.8328 - accuracy20: 0.5369 - val_loss: 3.0106 - val_accuracy20: 0.5025 - 236s/epoch - 39ms/step
Epoch 15/50
6073/6073 - 237s - loss: 2.8291 - accuracy20: 0.5377 - val_loss: 3.0125 - val_accuracy20: 0.5020 - 237s/epoch - 39ms/step
Epoch 16/50
6073/6073 - 236s - loss: 2.8260 - accuracy20: 0.5381 - val_loss: 3.0034 - val_accuracy20: 0.5038 - 236s/epoch - 39ms/step
Epoch 17/50
6073/6073 - 241s - loss: 2.8226 - accuracy20: 0.5394 - val_loss: 3.0097 - val_accuracy20: 0.5031 - 241s/epoch - 40ms/step
Epoch 18/50
6073/6073 - 241s - loss: 2.8202 - accuracy20: 0.5397 - val_loss: 3.0017 - val_accuracy20: 0.5050 - 241s/epoch - 40ms/step
Epoch 19/50
6073/6073 - 239s - loss: 2.8180 - accuracy20: 0.5401 - val_loss: 2.9985 - val_accuracy20: 0.5055 - 239s/epoch - 39ms/step
Epoch 20/50
6073/6073 - 238s - loss: 2.8149 - accuracy20: 0.5408 - val_loss: 2.9944 - val_accuracy20: 0.5062 - 238s/epoch - 39ms/step
Epoch 21/50
6073/6073 - 241s - loss: 2.8129 - accuracy20: 0.5414 - val_loss: 2.9967 - val_accuracy20: 0.5063 - 241s/epoch - 40ms/step
Epoch 22/50
6073/6073 - 237s - loss: 2.8105 - accuracy20: 0.5420 - val_loss: 2.9895 - val_accuracy20: 0.5071 - 237s/epoch - 39ms/step
Epoch 23/50
6073/6073 - 238s - loss: 2.8087 - accuracy20: 0.5425 - val_loss: 2.9868 - val_accuracy20: 0.5073 - 238s/epoch - 39ms/step
Epoch 24/50
6073/6073 - 242s - loss: 2.8060 - accuracy20: 0.5429 - val_loss: 2.9870 - val_accuracy20: 0.5080 - 242s/epoch - 40ms/step
Epoch 25/50
6073/6073 - 238s - loss: 2.8045 - accuracy20: 0.5433 - val_loss: 2.9810 - val_accuracy20: 0.5094 - 238s/epoch - 39ms/step
Epoch 26/50
6073/6073 - 244s - loss: 2.8028 - accuracy20: 0.5437 - val_loss: 2.9898 - val_accuracy20: 0.5078 - 244s/epoch - 40ms/step
Epoch 27/50
6073/6073 - 240s - loss: 2.8008 - accuracy20: 0.5442 - val_loss: 2.9894 - val_accuracy20: 0.5081 - 240s/epoch - 40ms/step
Epoch 28/50
6073/6073 - 247s - loss: 2.7993 - accuracy20: 0.5446 - val_loss: 2.9870 - val_accuracy20: 0.5075 - 247s/epoch - 41ms/step
Epoch 29/50
6073/6073 - 247s - loss: 2.7977 - accuracy20: 0.5449 - val_loss: 2.9876 - val_accuracy20: 0.5077 - 247s/epoch - 41ms/step
Epoch 30/50
6073/6073 - 249s - loss: 2.7958 - accuracy20: 0.5454 - val_loss: 2.9849 - val_accuracy20: 0.5085 - 249s/epoch - 41ms/step
Epoch 31/50
6073/6073 - 248s - loss: 2.7940 - accuracy20: 0.5454 - val_loss: 2.9840 - val_accuracy20: 0.5094 - 248s/epoch - 41ms/step
Epoch 32/50
6073/6073 - 250s - loss: 2.7933 - accuracy20: 0.5459 - val_loss: 2.9846 - val_accuracy20: 0.5091 - 250s/epoch - 41ms/step
Epoch 33/50
6073/6073 - 248s - loss: 2.7913 - accuracy20: 0.5462 - val_loss: 2.9836 - val_accuracy20: 0.5085 - 248s/epoch - 41ms/step
Epoch 34/50
6073/6073 - 247s - loss: 2.7900 - accuracy20: 0.5466 - val_loss: 2.9817 - val_accuracy20: 0.5095 - 247s/epoch - 41ms/step
Epoch 35/50
6073/6073 - 245s - loss: 2.7883 - accuracy20: 0.5469 - val_loss: 2.9807 - val_accuracy20: 0.5106 - 245s/epoch - 40ms/step
Epoch 36/50
6073/6073 - 249s - loss: 2.7871 - accuracy20: 0.5471 - val_loss: 2.9816 - val_accuracy20: 0.5095 - 249s/epoch - 41ms/step
Epoch 37/50
6073/6073 - 248s - loss: 2.7857 - accuracy20: 0.5477 - val_loss: 2.9797 - val_accuracy20: 0.5093 - 248s/epoch - 41ms/step
Epoch 38/50
6073/6073 - 246s - loss: 2.7846 - accuracy20: 0.5476 - val_loss: 2.9837 - val_accuracy20: 0.5090 - 246s/epoch - 40ms/step
Epoch 39/50
6073/6073 - 246s - loss: 2.7833 - accuracy20: 0.5480 - val_loss: 2.9791 - val_accuracy20: 0.5099 - 246s/epoch - 40ms/step
Epoch 40/50
6073/6073 - 246s - loss: 2.7824 - accuracy20: 0.5481 - val_loss: 2.9780 - val_accuracy20: 0.5100 - 246s/epoch - 41ms/step
Epoch 41/50
6073/6073 - 241s - loss: 2.7802 - accuracy20: 0.5490 - val_loss: 2.9793 - val_accuracy20: 0.5111 - 241s/epoch - 40ms/step
Epoch 42/50
6073/6073 - 238s - loss: 2.7798 - accuracy20: 0.5488 - val_loss: 2.9746 - val_accuracy20: 0.5107 - 238s/epoch - 39ms/step
Epoch 43/50
6073/6073 - 243s - loss: 2.7781 - accuracy20: 0.5492 - val_loss: 2.9756 - val_accuracy20: 0.5109 - 243s/epoch - 40ms/step
Epoch 44/50
6073/6073 - 243s - loss: 2.7772 - accuracy20: 0.5494 - val_loss: 2.9772 - val_accuracy20: 0.5106 - 243s/epoch - 40ms/step
Epoch 45/50
6073/6073 - 243s - loss: 2.7760 - accuracy20: 0.5496 - val_loss: 2.9858 - val_accuracy20: 0.5096 - 243s/epoch - 40ms/step
Epoch 46/50
6073/6073 - 239s - loss: 2.7750 - accuracy20: 0.5502 - val_loss: 2.9808 - val_accuracy20: 0.5095 - 239s/epoch - 39ms/step
Epoch 47/50
6073/6073 - 239s - loss: 2.7734 - accuracy20: 0.5502 - val_loss: 2.9738 - val_accuracy20: 0.5110 - 239s/epoch - 39ms/step
Epoch 48/50
6073/6073 - 241s - loss: 2.7726 - accuracy20: 0.5505 - val_loss: 2.9861 - val_accuracy20: 0.5086 - 241s/epoch - 40ms/step
Epoch 49/50
6073/6073 - 237s - loss: 2.7714 - accuracy20: 0.5509 - val_loss: 2.9767 - val_accuracy20: 0.5109 - 237s/epoch - 39ms/step
Epoch 50/50
6073/6073 - 234s - loss: 2.7702 - accuracy20: 0.5509 - val_loss: 2.9780 - val_accuracy20: 0.5103 - 234s/epoch - 39ms/step
testing model: results/AAPL/W1/deepVOL_L3/h20
Evaluating performance on  test set...
21353/21353 - 399s - 399s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0075299
{'0': {'precision': 0.5382755938433748, 'recall': 0.5311946619608532, 'f1-score': 0.5347116865786865, 'support': 2118231}, '1': {'precision': 0.38306493670980385, 'recall': 0.34124114084143653, 'f1-score': 0.3609455175666634, 'support': 1205391}, '2': {'precision': 0.5293186514554095, 'recall': 0.5687155061969248, 'f1-score': 0.5483103102103153, 'support': 2142595}, 'accuracy': 0.504013836260068, 'macro avg': {'precision': 0.48355306066952936, 'recall': 0.48038376966640484, 'f1-score': 0.4813225047852217, 'support': 5466217}, 'weighted avg': {'precision': 0.5005382282780058, 'recall': 0.504013836260068, 'f1-score': 0.5017236377632879, 'support': 5466217}}
[[1125193  329534  663504]
 [ 374026  411329  420036]
 [ 591147  332921 1218527]]
Evaluating performance on  train set...
6073/6073 - 117s - 117s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9568048
{'0': {'precision': 0.5332550239690149, 'recall': 0.47790124861806593, 'f1-score': 0.5040630191308075, 'support': 492064}, '1': {'precision': 0.5349220332571832, 'recall': 0.5682672174949065, 'f1-score': 0.5510906767964654, 'support': 567388}, '2': {'precision': 0.5196129292438887, 'recall': 0.5360996319950232, 'f1-score': 0.5277275470145032, 'support': 495102}, 'accuracy': 0.5294187271719091, 'macro avg': {'precision': 0.5292633288233622, 'recall': 0.5274226993693318, 'f1-score': 0.527627080980592, 'support': 1554554}, 'weighted avg': {'precision': 0.52951865500621, 'recall': 0.5294187271719091, 'f1-score': 0.5287641769624916, 'support': 1554554}}
[[235158 144367 112539]
 [112112 322428 132848]
 [ 93716 135962 265424]]
Evaluating performance on  val set...
1786/1786 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9840987
{'0': {'precision': 0.5325883660414182, 'recall': 0.50630032854474, 'f1-score': 0.5191117510683689, 'support': 155230}, '1': {'precision': 0.48348489711493886, 'recall': 0.46678189255071545, 'f1-score': 0.47498659902532, 'support': 145222}, '2': {'precision': 0.5164797544563806, 'recall': 0.5582585284003547, 'f1-score': 0.5365570991013641, 'support': 156741}, 'accuracy': 0.5115607631787888, 'macro avg': {'precision': 0.5108510058709126, 'recall': 0.5104469164986034, 'f1-score': 0.5102184830650177, 'support': 457193}, 'weighted avg': {'precision': 0.5114686554314755, 'recall': 0.5115607631787888, 'f1-score': 0.5110767603008901, 'support': 457193}}
[[78593 36533 40104]
 [35621 67787 41814]
 [33354 35885 87502]]
training model: results/AAPL/W1/deepVOL_L3/h30
Epoch 1/50
6073/6073 - 246s - loss: 3.1896 - accuracy30: 0.4199 - val_loss: 3.2735 - val_accuracy30: 0.3506 - 246s/epoch - 41ms/step
Epoch 2/50
6073/6073 - 240s - loss: 3.1034 - accuracy30: 0.4586 - val_loss: 3.1747 - val_accuracy30: 0.4431 - 240s/epoch - 40ms/step
Epoch 3/50
6073/6073 - 244s - loss: 3.0431 - accuracy30: 0.4846 - val_loss: 3.1660 - val_accuracy30: 0.4493 - 244s/epoch - 40ms/step
Epoch 4/50
6073/6073 - 243s - loss: 3.0187 - accuracy30: 0.4922 - val_loss: 3.1699 - val_accuracy30: 0.4428 - 243s/epoch - 40ms/step
Epoch 5/50
6073/6073 - 245s - loss: 3.0027 - accuracy30: 0.4963 - val_loss: 3.1691 - val_accuracy30: 0.4423 - 245s/epoch - 40ms/step
Epoch 6/50
6073/6073 - 246s - loss: 2.9904 - accuracy30: 0.4996 - val_loss: 3.1618 - val_accuracy30: 0.4423 - 246s/epoch - 40ms/step
Epoch 7/50
6073/6073 - 248s - loss: 2.9811 - accuracy30: 0.5020 - val_loss: 3.1639 - val_accuracy30: 0.4404 - 248s/epoch - 41ms/step
Epoch 8/50
6073/6073 - 243s - loss: 2.9728 - accuracy30: 0.5040 - val_loss: 3.1473 - val_accuracy30: 0.4469 - 243s/epoch - 40ms/step
Epoch 9/50
6073/6073 - 245s - loss: 2.9663 - accuracy30: 0.5055 - val_loss: 3.1387 - val_accuracy30: 0.4514 - 245s/epoch - 40ms/step
Epoch 10/50
6073/6073 - 244s - loss: 2.9603 - accuracy30: 0.5068 - val_loss: 3.1336 - val_accuracy30: 0.4555 - 244s/epoch - 40ms/step
Epoch 11/50
6073/6073 - 246s - loss: 2.9545 - accuracy30: 0.5083 - val_loss: 3.1283 - val_accuracy30: 0.4570 - 246s/epoch - 40ms/step
Epoch 12/50
6073/6073 - 244s - loss: 2.9504 - accuracy30: 0.5093 - val_loss: 3.1173 - val_accuracy30: 0.4608 - 244s/epoch - 40ms/step
Epoch 13/50
6073/6073 - 250s - loss: 2.9455 - accuracy30: 0.5105 - val_loss: 3.1195 - val_accuracy30: 0.4607 - 250s/epoch - 41ms/step
Epoch 14/50
6073/6073 - 245s - loss: 2.9419 - accuracy30: 0.5113 - val_loss: 3.1087 - val_accuracy30: 0.4640 - 245s/epoch - 40ms/step
Epoch 15/50
6073/6073 - 246s - loss: 2.9384 - accuracy30: 0.5122 - val_loss: 3.1131 - val_accuracy30: 0.4609 - 246s/epoch - 41ms/step
Epoch 16/50
6073/6073 - 245s - loss: 2.9351 - accuracy30: 0.5128 - val_loss: 3.1098 - val_accuracy30: 0.4648 - 245s/epoch - 40ms/step
Epoch 17/50
6073/6073 - 247s - loss: 2.9318 - accuracy30: 0.5138 - val_loss: 3.1023 - val_accuracy30: 0.4677 - 247s/epoch - 41ms/step
Epoch 18/50
6073/6073 - 245s - loss: 2.9293 - accuracy30: 0.5145 - val_loss: 3.0988 - val_accuracy30: 0.4697 - 245s/epoch - 40ms/step
Epoch 19/50
6073/6073 - 249s - loss: 2.9270 - accuracy30: 0.5155 - val_loss: 3.0942 - val_accuracy30: 0.4697 - 249s/epoch - 41ms/step
Epoch 20/50
6073/6073 - 250s - loss: 2.9245 - accuracy30: 0.5159 - val_loss: 3.0900 - val_accuracy30: 0.4706 - 250s/epoch - 41ms/step
Epoch 21/50
6073/6073 - 250s - loss: 2.9226 - accuracy30: 0.5162 - val_loss: 3.0878 - val_accuracy30: 0.4733 - 250s/epoch - 41ms/step
Epoch 22/50
6073/6073 - 251s - loss: 2.9206 - accuracy30: 0.5166 - val_loss: 3.0871 - val_accuracy30: 0.4737 - 251s/epoch - 41ms/step
Epoch 23/50
6073/6073 - 249s - loss: 2.9183 - accuracy30: 0.5172 - val_loss: 3.0854 - val_accuracy30: 0.4731 - 249s/epoch - 41ms/step
Epoch 24/50
6073/6073 - 244s - loss: 2.9168 - accuracy30: 0.5175 - val_loss: 3.0780 - val_accuracy30: 0.4762 - 244s/epoch - 40ms/step
Epoch 25/50
6073/6073 - 242s - loss: 2.9147 - accuracy30: 0.5182 - val_loss: 3.0810 - val_accuracy30: 0.4743 - 242s/epoch - 40ms/step
Epoch 26/50
6073/6073 - 246s - loss: 2.9125 - accuracy30: 0.5187 - val_loss: 3.0746 - val_accuracy30: 0.4775 - 246s/epoch - 40ms/step
Epoch 27/50
6073/6073 - 246s - loss: 2.9116 - accuracy30: 0.5187 - val_loss: 3.0713 - val_accuracy30: 0.4777 - 246s/epoch - 41ms/step
Epoch 28/50
6073/6073 - 247s - loss: 2.9095 - accuracy30: 0.5195 - val_loss: 3.0779 - val_accuracy30: 0.4756 - 247s/epoch - 41ms/step
Epoch 29/50
6073/6073 - 244s - loss: 2.9083 - accuracy30: 0.5195 - val_loss: 3.0694 - val_accuracy30: 0.4778 - 244s/epoch - 40ms/step
Epoch 30/50
6073/6073 - 243s - loss: 2.9066 - accuracy30: 0.5200 - val_loss: 3.0725 - val_accuracy30: 0.4783 - 243s/epoch - 40ms/step
Epoch 31/50
6073/6073 - 245s - loss: 2.9053 - accuracy30: 0.5202 - val_loss: 3.0668 - val_accuracy30: 0.4795 - 245s/epoch - 40ms/step
Epoch 32/50
6073/6073 - 244s - loss: 2.9036 - accuracy30: 0.5210 - val_loss: 3.0744 - val_accuracy30: 0.4781 - 244s/epoch - 40ms/step
Epoch 33/50
6073/6073 - 245s - loss: 2.9026 - accuracy30: 0.5211 - val_loss: 3.0698 - val_accuracy30: 0.4775 - 245s/epoch - 40ms/step
Epoch 34/50
6073/6073 - 248s - loss: 2.9009 - accuracy30: 0.5214 - val_loss: 3.0708 - val_accuracy30: 0.4773 - 248s/epoch - 41ms/step
Epoch 35/50
6073/6073 - 246s - loss: 2.8998 - accuracy30: 0.5216 - val_loss: 3.0715 - val_accuracy30: 0.4771 - 246s/epoch - 41ms/step
Epoch 36/50
6073/6073 - 245s - loss: 2.8978 - accuracy30: 0.5223 - val_loss: 3.0763 - val_accuracy30: 0.4755 - 245s/epoch - 40ms/step
Epoch 37/50
6073/6073 - 245s - loss: 2.8969 - accuracy30: 0.5227 - val_loss: 3.0758 - val_accuracy30: 0.4760 - 245s/epoch - 40ms/step
Epoch 38/50
6073/6073 - 244s - loss: 2.8960 - accuracy30: 0.5227 - val_loss: 3.0765 - val_accuracy30: 0.4754 - 244s/epoch - 40ms/step
Epoch 39/50
6073/6073 - 247s - loss: 2.8948 - accuracy30: 0.5232 - val_loss: 3.0767 - val_accuracy30: 0.4765 - 247s/epoch - 41ms/step
Epoch 40/50
6073/6073 - 245s - loss: 2.8935 - accuracy30: 0.5233 - val_loss: 3.0782 - val_accuracy30: 0.4749 - 245s/epoch - 40ms/step
Epoch 41/50
6073/6073 - 244s - loss: 2.8921 - accuracy30: 0.5238 - val_loss: 3.0753 - val_accuracy30: 0.4753 - 244s/epoch - 40ms/step
testing model: results/AAPL/W1/deepVOL_L3/h30
Evaluating performance on  test set...
21353/21353 - 397s - 397s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0420243
{'0': {'precision': 0.5446425859702302, 'recall': 0.4231224580531052, 'f1-score': 0.47625301442602364, 'support': 2161483}, '1': {'precision': 0.3055463980112119, 'recall': 0.3532846715328467, 'f1-score': 0.32768599979396307, 'support': 1125455}, '2': {'precision': 0.5070750494728462, 'recall': 0.5783747744093345, 'f1-score': 0.5403831865733358, 'support': 2179279}, 'accuracy': 0.47063956663264556, 'macro avg': {'precision': 0.45242134448476273, 'recall': 0.4515939679984288, 'f1-score': 0.4481074002644408, 'support': 5466217}, 'weighted avg': {'precision': 0.48043691254198917, 'recall': 0.47063956663264556, 'f1-score': 0.47123163455294076, 'support': 5466217}}
[[ 914572  463936  782975]
 [ 285557  397606  442292]
 [ 479086  439753 1260440]]
Evaluating performance on  train set...
6073/6073 - 134s - 134s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0027628
{'0': {'precision': 0.5450823784391242, 'recall': 0.36909547982567675, 'f1-score': 0.44014945274737477, 'support': 515135}, '1': {'precision': 0.4586777233730401, 'recall': 0.5841066705621848, 'f1-score': 0.5138487292649522, 'support': 520256}, '2': {'precision': 0.49852451984764723, 'recall': 0.5216184512378579, 'f1-score': 0.5098100860712214, 'support': 519163}, 'accuracy': 0.49198934228080854, 'macro avg': {'precision': 0.5007615405532705, 'recall': 0.49160686720857316, 'f1-score': 0.48793608936118277, 'support': 1554554}, 'weighted avg': {'precision': 0.5006171120244562, 'recall': 0.49198934228080854, 'f1-score': 0.48807812822743973, 'support': 1554554}}
[[190134 185693 139308]
 [ 83271 303885 133100]
 [ 75412 172946 270805]]
Evaluating performance on  val set...
1786/1786 - 40s - 40s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0218098
{'0': {'precision': 0.5483253830465049, 'recall': 0.40330649210570363, 'f1-score': 0.46476624531651267, 'support': 161319}, '1': {'precision': 0.4068460705016756, 'recall': 0.4843380902743928, 'f1-score': 0.44222296018103574, 'support': 133349}, '2': {'precision': 0.49783359567497815, 'recall': 0.5507214274726965, 'f1-score': 0.5229437128267449, 'support': 162525}, 'accuracy': 0.47934460938815776, 'macro avg': {'precision': 0.4843350164077196, 'recall': 0.4794553366175977, 'f1-score': 0.47664430610809777, 'support': 457193}, 'weighted avg': {'precision': 0.48911121618240627, 'recall': 0.47934460938815776, 'f1-score': 0.4788722538896312, 'support': 457193}}
[[65061 48224 48034]
 [26512 64586 42251]
 [27081 45938 89506]]
training model: results/AAPL/W1/deepVOL_L3/h50
Epoch 1/50
6073/6073 - 245s - loss: 3.2182 - accuracy50: 0.4095 - val_loss: 3.2620 - val_accuracy50: 0.3785 - 245s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 240s - loss: 3.1698 - accuracy50: 0.4327 - val_loss: 3.2478 - val_accuracy50: 0.4042 - 240s/epoch - 40ms/step
Epoch 3/50
6073/6073 - 238s - loss: 3.1382 - accuracy50: 0.4500 - val_loss: 3.2173 - val_accuracy50: 0.4252 - 238s/epoch - 39ms/step
Epoch 4/50
6073/6073 - 241s - loss: 3.1151 - accuracy50: 0.4600 - val_loss: 3.2151 - val_accuracy50: 0.4217 - 241s/epoch - 40ms/step
Epoch 5/50
6073/6073 - 235s - loss: 3.1059 - accuracy50: 0.4637 - val_loss: 3.2111 - val_accuracy50: 0.4216 - 235s/epoch - 39ms/step
Epoch 6/50
6073/6073 - 240s - loss: 3.0985 - accuracy50: 0.4664 - val_loss: 3.2063 - val_accuracy50: 0.4247 - 240s/epoch - 40ms/step
Epoch 7/50
6073/6073 - 238s - loss: 3.0925 - accuracy50: 0.4685 - val_loss: 3.2069 - val_accuracy50: 0.4215 - 238s/epoch - 39ms/step
Epoch 8/50
6073/6073 - 237s - loss: 3.0874 - accuracy50: 0.4700 - val_loss: 3.1997 - val_accuracy50: 0.4231 - 237s/epoch - 39ms/step
Epoch 9/50
6073/6073 - 237s - loss: 3.0827 - accuracy50: 0.4718 - val_loss: 3.1986 - val_accuracy50: 0.4215 - 237s/epoch - 39ms/step
Epoch 10/50
6073/6073 - 237s - loss: 3.0789 - accuracy50: 0.4724 - val_loss: 3.1972 - val_accuracy50: 0.4237 - 237s/epoch - 39ms/step
Epoch 11/50
6073/6073 - 249s - loss: 3.0752 - accuracy50: 0.4739 - val_loss: 3.1954 - val_accuracy50: 0.4240 - 249s/epoch - 41ms/step
Epoch 12/50
6073/6073 - 249s - loss: 3.0722 - accuracy50: 0.4747 - val_loss: 3.1946 - val_accuracy50: 0.4242 - 249s/epoch - 41ms/step
Epoch 13/50
6073/6073 - 235s - loss: 3.0698 - accuracy50: 0.4752 - val_loss: 3.1930 - val_accuracy50: 0.4265 - 235s/epoch - 39ms/step
Epoch 14/50
6073/6073 - 236s - loss: 3.0670 - accuracy50: 0.4760 - val_loss: 3.1918 - val_accuracy50: 0.4263 - 236s/epoch - 39ms/step
Epoch 15/50
6073/6073 - 236s - loss: 3.0647 - accuracy50: 0.4771 - val_loss: 3.1919 - val_accuracy50: 0.4273 - 236s/epoch - 39ms/step
Epoch 16/50
6073/6073 - 236s - loss: 3.0625 - accuracy50: 0.4774 - val_loss: 3.1936 - val_accuracy50: 0.4276 - 236s/epoch - 39ms/step
Epoch 17/50
6073/6073 - 235s - loss: 3.0602 - accuracy50: 0.4783 - val_loss: 3.1908 - val_accuracy50: 0.4285 - 235s/epoch - 39ms/step
Epoch 18/50
6073/6073 - 235s - loss: 3.0578 - accuracy50: 0.4792 - val_loss: 3.1897 - val_accuracy50: 0.4288 - 235s/epoch - 39ms/step
Epoch 19/50
6073/6073 - 236s - loss: 3.0564 - accuracy50: 0.4797 - val_loss: 3.1888 - val_accuracy50: 0.4304 - 236s/epoch - 39ms/step
Epoch 20/50
6073/6073 - 235s - loss: 3.0550 - accuracy50: 0.4798 - val_loss: 3.1902 - val_accuracy50: 0.4289 - 235s/epoch - 39ms/step
Epoch 21/50
6073/6073 - 245s - loss: 3.0535 - accuracy50: 0.4801 - val_loss: 3.1879 - val_accuracy50: 0.4305 - 245s/epoch - 40ms/step
Epoch 22/50
6073/6073 - 245s - loss: 3.0519 - accuracy50: 0.4808 - val_loss: 3.1882 - val_accuracy50: 0.4303 - 245s/epoch - 40ms/step
Epoch 23/50
6073/6073 - 248s - loss: 3.0505 - accuracy50: 0.4811 - val_loss: 3.1887 - val_accuracy50: 0.4319 - 248s/epoch - 41ms/step
Epoch 24/50
6073/6073 - 247s - loss: 3.0489 - accuracy50: 0.4813 - val_loss: 3.1877 - val_accuracy50: 0.4319 - 247s/epoch - 41ms/step
Epoch 25/50
6073/6073 - 238s - loss: 3.0475 - accuracy50: 0.4820 - val_loss: 3.1850 - val_accuracy50: 0.4327 - 238s/epoch - 39ms/step
Epoch 26/50
6073/6073 - 242s - loss: 3.0468 - accuracy50: 0.4823 - val_loss: 3.1867 - val_accuracy50: 0.4320 - 242s/epoch - 40ms/step
Epoch 27/50
6073/6073 - 237s - loss: 3.0452 - accuracy50: 0.4825 - val_loss: 3.1805 - val_accuracy50: 0.4331 - 237s/epoch - 39ms/step
Epoch 28/50
6073/6073 - 237s - loss: 3.0439 - accuracy50: 0.4829 - val_loss: 3.1819 - val_accuracy50: 0.4334 - 237s/epoch - 39ms/step
Epoch 29/50
6073/6073 - 236s - loss: 3.0429 - accuracy50: 0.4834 - val_loss: 3.1829 - val_accuracy50: 0.4342 - 236s/epoch - 39ms/step
Epoch 30/50
6073/6073 - 240s - loss: 3.0420 - accuracy50: 0.4835 - val_loss: 3.1849 - val_accuracy50: 0.4330 - 240s/epoch - 40ms/step
Epoch 31/50
6073/6073 - 237s - loss: 3.0403 - accuracy50: 0.4840 - val_loss: 3.1819 - val_accuracy50: 0.4348 - 237s/epoch - 39ms/step
Epoch 32/50
6073/6073 - 237s - loss: 3.0395 - accuracy50: 0.4844 - val_loss: 3.1812 - val_accuracy50: 0.4347 - 237s/epoch - 39ms/step
Epoch 33/50
6073/6073 - 236s - loss: 3.0381 - accuracy50: 0.4849 - val_loss: 3.1856 - val_accuracy50: 0.4335 - 236s/epoch - 39ms/step
Epoch 34/50
6073/6073 - 235s - loss: 3.0372 - accuracy50: 0.4850 - val_loss: 3.1833 - val_accuracy50: 0.4344 - 235s/epoch - 39ms/step
Epoch 35/50
6073/6073 - 236s - loss: 3.0365 - accuracy50: 0.4852 - val_loss: 3.1816 - val_accuracy50: 0.4350 - 236s/epoch - 39ms/step
Epoch 36/50
6073/6073 - 238s - loss: 3.0351 - accuracy50: 0.4856 - val_loss: 3.1852 - val_accuracy50: 0.4351 - 238s/epoch - 39ms/step
Epoch 37/50
6073/6073 - 236s - loss: 3.0337 - accuracy50: 0.4862 - val_loss: 3.1826 - val_accuracy50: 0.4349 - 236s/epoch - 39ms/step
testing model: results/AAPL/W1/deepVOL_L3/h50
Evaluating performance on  test set...
21353/21353 - 397s - 397s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0829394
{'0': {'precision': 0.4796070696225369, 'recall': 0.4188075569138903, 'f1-score': 0.44715003334621367, 'support': 2081961}, '1': {'precision': 0.27257746248399733, 'recall': 0.3300594199734098, 'f1-score': 0.2985770097523053, 'support': 1286941}, '2': {'precision': 0.47806971792233893, 'recall': 0.4763681182845686, 'f1-score': 0.47721740127269885, 'support': 2097315}, 'accuracy': 0.419998327911241, 'macro avg': {'precision': 0.41008475000962435, 'recall': 0.4084116983906229, 'f1-score': 0.4076481481237393, 'support': 5466217}, 'weighted avg': {'precision': 0.43027510925184903, 'recall': 0.419998327911241, 'f1-score': 0.4237071342087971, 'support': 5466217}}
[[871941 583648 626372]
 [397790 424767 464384]
 [548301 549920 999094]]
Evaluating performance on  train set...
6073/6073 - 117s - 117s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.046773
{'0': {'precision': 0.49237829380940645, 'recall': 0.3536235285968808, 'f1-score': 0.4116221621512668, 'support': 519742}, '1': {'precision': 0.39705613807728557, 'recall': 0.5295683190408661, 'f1-score': 0.4538372584302193, 'support': 509126}, '2': {'precision': 0.47620849079520067, 'recall': 0.4549674140076015, 'f1-score': 0.4653456870352283, 'support': 525686}, 'accuracy': 0.44551684920562423, 'macro avg': {'precision': 0.4552143075606309, 'recall': 0.4460530872151161, 'f1-score': 0.4436017025389048, 'support': 1554554}, 'weighted avg': {'precision': 0.45569174131486617, 'recall': 0.44551684920562423, 'f1-score': 0.4436149446536875, 'support': 1554554}}
[[183793 211643 124306]
 [100747 269617 138762]
 [ 88736 197780 239170]]
Evaluating performance on  val set...
1786/1786 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0616941
{'0': {'precision': 0.49591717227581045, 'recall': 0.3778864388502584, 'f1-score': 0.4289301893694251, 'support': 161358}, '1': {'precision': 0.3467632360059015, 'recall': 0.4477845718244525, 'f1-score': 0.3908518169180259, 'support': 132796}, '2': {'precision': 0.4787841922878419, 'recall': 0.477953127779243, 'f1-score': 0.47836829908377965, 'support': 163039}, 'accuracy': 0.43387365948297546, 'macro avg': {'precision': 0.4404882001898513, 'recall': 0.4345413794846513, 'f1-score': 0.4327167684570769, 'support': 457193}, 'weighted avg': {'precision': 0.4464842412266535, 'recall': 0.43387365948297546, 'f1-score': 0.4355000284125921, 'support': 457193}}
[[60975 57629 42754]
 [31255 59464 42077]
 [30724 54390 77925]]
training model: results/AAPL/W1/deepVOL_L3/h100
Epoch 1/50
6073/6073 - 250s - loss: 3.2339 - accuracy100: 0.4014 - val_loss: 3.3813 - val_accuracy100: 0.3279 - 250s/epoch - 41ms/step
Epoch 2/50
6073/6073 - 241s - loss: 3.2118 - accuracy100: 0.4171 - val_loss: 3.3773 - val_accuracy100: 0.3285 - 241s/epoch - 40ms/step
Epoch 3/50
6073/6073 - 240s - loss: 3.2062 - accuracy100: 0.4199 - val_loss: 3.3662 - val_accuracy100: 0.3298 - 240s/epoch - 40ms/step
Epoch 4/50
6073/6073 - 235s - loss: 3.2009 - accuracy100: 0.4229 - val_loss: 3.3639 - val_accuracy100: 0.3335 - 235s/epoch - 39ms/step
Epoch 5/50
6073/6073 - 235s - loss: 3.1945 - accuracy100: 0.4264 - val_loss: 3.3690 - val_accuracy100: 0.3344 - 235s/epoch - 39ms/step
Epoch 6/50
6073/6073 - 235s - loss: 3.1853 - accuracy100: 0.4307 - val_loss: 3.3842 - val_accuracy100: 0.3316 - 235s/epoch - 39ms/step
Epoch 7/50
6073/6073 - 237s - loss: 3.1810 - accuracy100: 0.4331 - val_loss: 3.3956 - val_accuracy100: 0.3326 - 237s/epoch - 39ms/step
Epoch 8/50
6073/6073 - 240s - loss: 3.1754 - accuracy100: 0.4357 - val_loss: 3.4149 - val_accuracy100: 0.3334 - 240s/epoch - 40ms/step
Epoch 9/50
6073/6073 - 235s - loss: 3.1711 - accuracy100: 0.4379 - val_loss: 3.4427 - val_accuracy100: 0.3330 - 235s/epoch - 39ms/step
Epoch 10/50
6073/6073 - 235s - loss: 3.1669 - accuracy100: 0.4399 - val_loss: 3.4736 - val_accuracy100: 0.3331 - 235s/epoch - 39ms/step
Epoch 11/50
6073/6073 - 236s - loss: 3.1642 - accuracy100: 0.4406 - val_loss: 3.4974 - val_accuracy100: 0.3334 - 236s/epoch - 39ms/step
Epoch 12/50
6073/6073 - 237s - loss: 3.1614 - accuracy100: 0.4416 - val_loss: 3.5153 - val_accuracy100: 0.3343 - 237s/epoch - 39ms/step
Epoch 13/50
6073/6073 - 236s - loss: 3.1588 - accuracy100: 0.4429 - val_loss: 3.5242 - val_accuracy100: 0.3338 - 236s/epoch - 39ms/step
Epoch 14/50
6073/6073 - 236s - loss: 3.1568 - accuracy100: 0.4438 - val_loss: 3.5179 - val_accuracy100: 0.3351 - 236s/epoch - 39ms/step
testing model: results/AAPL/W1/deepVOL_L3/h100
Evaluating performance on  test set...
21353/21353 - 404s - 404s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1557373
{'0': {'precision': 0.49338362505650024, 'recall': 0.016087555331940822, 'f1-score': 0.031159118213196085, 'support': 1967670}, '1': {'precision': 0.27841862791294264, 'recall': 0.9601354827870445, 'f1-score': 0.4316639885471295, 'support': 1523736}, '2': {'precision': 0.4747025222853887, 'recall': 0.035433264246553214, 'f1-score': 0.06594424604081486, 'support': 1974811}, 'accuracy': 0.28623488602812514, 'macro avg': {'precision': 0.4155015917516105, 'recall': 0.3372187674551795, 'f1-score': 0.1762557842670468, 'support': 5466217}, 'weighted avg': {'precision': 0.426712003323946, 'recall': 0.28623488602812514, 'f1-score': 0.15536892220991522, 'support': 5466217}}
[[  31655 1899982   36033]
 [  19344 1462993   41399]
 [  13160 1891677   69974]]
Evaluating performance on  train set...
6073/6073 - 116s - 116s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1143503
{'0': {'precision': 0.4802871978973011, 'recall': 0.0434033678356249, 'f1-score': 0.07961221103115806, 'support': 517840}, '1': {'precision': 0.33407607202969075, 'recall': 0.9145623431155941, 'f1-score': 0.4893865053459496, 'support': 518694}, '2': {'precision': 0.4776675361955643, 'recall': 0.08094861202270183, 'f1-score': 0.13843682889104947, 'support': 518020}, 'accuracy': 0.34658622344415185, 'macro avg': {'precision': 0.43067693537418533, 'recall': 0.3463047743246403, 'f1-score': 0.23581184842271904, 'support': 1554554}, 'weighted avg': {'precision': 0.4306293083189989, 'recall': 0.34658622344415185, 'f1-score': 0.23593987565978944, 'support': 1554554}}
[[ 22476 478227  17137]
 [ 15599 474378  28717]
 [  8722 467365  41933]]
Evaluating performance on  val set...
1786/1786 - 33s - 33s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1210281
{'0': {'precision': 0.502984220423514, 'recall': 0.04004009215990003, 'f1-score': 0.07417544325011906, 'support': 153646}, '1': {'precision': 0.32194031534707923, 'recall': 0.9343789226655024, 'f1-score': 0.47888185727771754, 'support': 146584}, '2': {'precision': 0.478592645703165, 'recall': 0.059536323847021275, 'f1-score': 0.10589895120942382, 'support': 156963}, 'accuracy': 0.3334740470654625, 'macro avg': {'precision': 0.4345057271579194, 'recall': 0.34465177955747456, 'f1-score': 0.21965208391242017, 'support': 457193}, 'weighted avg': {'precision': 0.43656431783411687, 'recall': 0.3334740470654625, 'f1-score': 0.2148226140809013, 'support': 457193}}
[[  6152 143334   4160]
 [  3598 136965   6021]
 [  2481 145137   9345]]
training model: results/AAPL/W1/deepVOL_L3/h200
Epoch 1/50
6073/6073 - 244s - loss: 3.2858 - accuracy200: 0.3648 - val_loss: 3.3151 - val_accuracy200: 0.3157 - 244s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 239s - loss: 3.2751 - accuracy200: 0.3725 - val_loss: 3.3192 - val_accuracy200: 0.3347 - 239s/epoch - 39ms/step
Epoch 3/50
6073/6073 - 242s - loss: 3.2622 - accuracy200: 0.3863 - val_loss: 3.3161 - val_accuracy200: 0.3381 - 242s/epoch - 40ms/step
Epoch 4/50
6073/6073 - 243s - loss: 3.2518 - accuracy200: 0.3941 - val_loss: 3.3172 - val_accuracy200: 0.3385 - 243s/epoch - 40ms/step
Epoch 5/50
6073/6073 - 243s - loss: 3.2441 - accuracy200: 0.3988 - val_loss: 3.3301 - val_accuracy200: 0.3384 - 243s/epoch - 40ms/step
Epoch 6/50
6073/6073 - 238s - loss: 3.2384 - accuracy200: 0.4025 - val_loss: 3.3417 - val_accuracy200: 0.3422 - 238s/epoch - 39ms/step
Epoch 7/50
6073/6073 - 236s - loss: 3.2331 - accuracy200: 0.4054 - val_loss: 3.3523 - val_accuracy200: 0.3423 - 236s/epoch - 39ms/step
Epoch 8/50
6073/6073 - 237s - loss: 3.2292 - accuracy200: 0.4080 - val_loss: 3.3557 - val_accuracy200: 0.3470 - 237s/epoch - 39ms/step
Epoch 9/50
6073/6073 - 237s - loss: 3.2255 - accuracy200: 0.4102 - val_loss: 3.3625 - val_accuracy200: 0.3476 - 237s/epoch - 39ms/step
Epoch 10/50
6073/6073 - 236s - loss: 3.2224 - accuracy200: 0.4117 - val_loss: 3.3677 - val_accuracy200: 0.3488 - 236s/epoch - 39ms/step
Epoch 11/50
6073/6073 - 233s - loss: 3.2195 - accuracy200: 0.4133 - val_loss: 3.3677 - val_accuracy200: 0.3499 - 233s/epoch - 38ms/step
testing model: results/AAPL/W1/deepVOL_L3/h200
Evaluating performance on  test set...
21353/21353 - 385s - 385s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158389
{'0': {'precision': 0.34112679606755736, 'recall': 0.0027091454805617684, 'f1-score': 0.005375599268092247, 'support': 1998047}, '1': {'precision': 0.26824407065263767, 'recall': 0.9841582294539889, 'f1-score': 0.42158116383618055, 'support': 1466124}, '2': {'precision': 0.3364796633941094, 'recall': 0.011983241144309372, 'f1-score': 0.023142302346062838, 'support': 2002046}, 'accuracy': 0.2693456919108773, 'macro avg': {'precision': 0.31528351003810146, 'recall': 0.33295020535962, 'f1-score': 0.15003302181677855, 'support': 5466217}, 'weighted avg': {'precision': 0.31987647133720554, 'recall': 0.2693456919108773, 'f1-score': 0.12351557138724935, 'support': 5466217}}
[[   5413 1964074   28560]
 [   4477 1442898   18749]
 [   5978 1972077   23991]]
Evaluating performance on  train set...
6073/6073 - 116s - 116s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1032767
{'0': {'precision': 0.33661265432098764, 'recall': 0.0033603250560856547, 'f1-score': 0.0066542225713517615, 'support': 519295}, '1': {'precision': 0.3300894021233004, 'recall': 0.9809928840257977, 'f1-score': 0.4939664855459164, 'support': 513071}, '2': {'precision': 0.34320826890209166, 'recall': 0.016151271189686473, 'f1-score': 0.030850717496826774, 'support': 522188}, 'accuracy': 0.33031853509109366, 'macro avg': {'precision': 0.3366367751154599, 'recall': 0.33350149342385654, 'f1-score': 0.17715714187136497, 'support': 1554554}, 'weighted avg': {'precision': 0.3366752184123978, 'recall': 0.33031853509109366, 'f1-score': 0.17561645184660804, 'support': 1554554}}
[[  1745 509467   8083]
 [  1695 503319   8057]
 [  1744 512010   8434]]
Evaluating performance on  val set...
1786/1786 - 33s - 33s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058303
{'0': {'precision': 0.35348837209302325, 'recall': 0.0034401815795089335, 'f1-score': 0.006814048210671927, 'support': 154643}, '1': {'precision': 0.3150615415433239, 'recall': 0.9826522182807716, 'f1-score': 0.4771405409687145, 'support': 144053}, '2': {'precision': 0.34557674273210376, 'recall': 0.013949790847776299, 'f1-score': 0.02681706540525789, 'support': 158497}, 'accuracy': 0.31561506847217696, 'macro avg': {'precision': 0.3380422187894836, 'recall': 0.33334739690268567, 'f1-score': 0.17025721819488146, 'support': 457193}, 'weighted avg': {'precision': 0.33863803593303504, 'recall': 0.31561506847217696, 'f1-score': 0.16193969641080752, 'support': 457193}}
[[   532 151943   2168]
 [   480 141554   2019]
 [   493 155793   2211]]
training model: results/AAPL/W1/deepVOL_L3/h300
Epoch 1/50
6073/6073 - 244s - loss: 3.2612 - accuracy300: 0.3839 - val_loss: 3.3047 - val_accuracy300: 0.3230 - 244s/epoch - 40ms/step
Epoch 2/50
6073/6073 - 234s - loss: 3.2588 - accuracy300: 0.3836 - val_loss: 3.3047 - val_accuracy300: 0.3292 - 234s/epoch - 39ms/step
Epoch 3/50
6073/6073 - 239s - loss: 3.2535 - accuracy300: 0.3897 - val_loss: 3.3106 - val_accuracy300: 0.3310 - 239s/epoch - 39ms/step
Epoch 4/50
6073/6073 - 233s - loss: 3.2449 - accuracy300: 0.3967 - val_loss: 3.3095 - val_accuracy300: 0.3336 - 233s/epoch - 38ms/step
Epoch 5/50
6073/6073 - 230s - loss: 3.2359 - accuracy300: 0.4028 - val_loss: 3.3076 - val_accuracy300: 0.3394 - 230s/epoch - 38ms/step
Epoch 6/50
6073/6073 - 230s - loss: 3.2262 - accuracy300: 0.4083 - val_loss: 3.3041 - val_accuracy300: 0.3419 - 230s/epoch - 38ms/step
Epoch 7/50
6073/6073 - 228s - loss: 3.2197 - accuracy300: 0.4115 - val_loss: 3.3116 - val_accuracy300: 0.3405 - 228s/epoch - 38ms/step
Epoch 8/50
6073/6073 - 231s - loss: 3.2151 - accuracy300: 0.4137 - val_loss: 3.3093 - val_accuracy300: 0.3451 - 231s/epoch - 38ms/step
Epoch 9/50
6073/6073 - 229s - loss: 3.2122 - accuracy300: 0.4153 - val_loss: 3.3111 - val_accuracy300: 0.3456 - 229s/epoch - 38ms/step
Epoch 10/50
6073/6073 - 229s - loss: 3.2095 - accuracy300: 0.4170 - val_loss: 3.3160 - val_accuracy300: 0.3443 - 229s/epoch - 38ms/step
Epoch 11/50
6073/6073 - 230s - loss: 3.2073 - accuracy300: 0.4181 - val_loss: 3.3147 - val_accuracy300: 0.3440 - 230s/epoch - 38ms/step
Epoch 12/50
6073/6073 - 227s - loss: 3.2049 - accuracy300: 0.4199 - val_loss: 3.3192 - val_accuracy300: 0.3453 - 227s/epoch - 37ms/step
Epoch 13/50
6073/6073 - 229s - loss: 3.2025 - accuracy300: 0.4212 - val_loss: 3.3175 - val_accuracy300: 0.3452 - 229s/epoch - 38ms/step
Epoch 14/50
6073/6073 - 229s - loss: 3.2004 - accuracy300: 0.4225 - val_loss: 3.3201 - val_accuracy300: 0.3450 - 229s/epoch - 38ms/step
Epoch 15/50
6073/6073 - 230s - loss: 3.1982 - accuracy300: 0.4235 - val_loss: 3.3223 - val_accuracy300: 0.3429 - 230s/epoch - 38ms/step
Epoch 16/50
6073/6073 - 233s - loss: 3.1964 - accuracy300: 0.4250 - val_loss: 3.3250 - val_accuracy300: 0.3426 - 233s/epoch - 38ms/step
testing model: results/AAPL/W1/deepVOL_L3/h300
Evaluating performance on  test set...
21353/21353 - 375s - 375s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1096554
{'0': {'precision': 0.33143738355955105, 'recall': 0.3510286656292979, 'f1-score': 0.34095182501417237, 'support': 1903534}, '1': {'precision': 0.3137685328916287, 'recall': 0.16670373989906356, 'f1-score': 0.2177290589189234, 'support': 1645392}, '2': {'precision': 0.3515079333037264, 'recall': 0.47226842456361606, 'f1-score': 0.4030368104098866, 'support': 1917291}, 'accuracy': 0.3380700034411367, 'macro avg': {'precision': 0.3322379499183021, 'recall': 0.33000027669732585, 'f1-score': 0.3205725647809941, 'support': 5466217}, 'weighted avg': {'precision': 0.3331586651792463, 'recall': 0.3380700034411367, 'f1-score': 0.3256368878617213, 'support': 5466217}}
[[668195 298832 936507]
 [637106 274293 733993]
 [710751 301064 905476]]
Evaluating performance on  train set...
6073/6073 - 126s - 126s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1001505
{'0': {'precision': 0.3479508856374213, 'recall': 0.34949516723186896, 'f1-score': 0.34872131676431783, 'support': 519578}, '1': {'precision': 0.3410810460555655, 'recall': 0.17484847182220695, 'f1-score': 0.2311846777662525, 'support': 511786}, '2': {'precision': 0.358090802050595, 'recall': 0.5272310250578184, 'f1-score': 0.42650384266600083, 'support': 523190}, 'accuracy': 0.35181601925697015, 'macro avg': {'precision': 0.3490409112478606, 'recall': 0.35052488803729814, 'f1-score': 0.3354699457321904, 'support': 1554554}, 'weighted avg': {'precision': 0.3491018364232858, 'recall': 0.35181601925697015, 'f1-score': 0.33620417898733335, 'support': 1554554}}
[[181590  86790 251198]
 [179028  89485 243273]
 [161266  86082 275842]]
Evaluating performance on  val set...
1786/1786 - 37s - 37s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009276
{'0': {'precision': 0.3217391898914203, 'recall': 0.3203352099827766, 'f1-score': 0.32103566494396973, 'support': 146893}, '1': {'precision': 0.36304052326285613, 'recall': 0.16855266528783608, 'f1-score': 0.23021908151334375, 'support': 160039}, '2': {'precision': 0.348405581521142, 'recall': 0.5486852875995767, 'f1-score': 0.4261887469339543, 'support': 150261}, 'accuracy': 0.342253709046289, 'macro avg': {'precision': 0.3443950982251394, 'recall': 0.3458577209567298, 'f1-score': 0.3258144977970892, 'support': 457193}, 'weighted avg': {'precision': 0.34496076757109784, 'recall': 0.342253709046289, 'f1-score': 0.32380520003580865, 'support': 457193}}
[[47055 23926 75912]
 [54784 26975 78280]
 [44413 23402 82446]]
training model: results/AAPL/W1/deepVOL_L3/h500
Epoch 1/50
6073/6073 - 237s - loss: 3.2690 - accuracy500: 0.3824 - val_loss: 3.3500 - val_accuracy500: 0.3110 - 237s/epoch - 39ms/step
Epoch 2/50
6073/6073 - 237s - loss: 3.2717 - accuracy500: 0.3765 - val_loss: 3.3479 - val_accuracy500: 0.3107 - 237s/epoch - 39ms/step
Epoch 3/50
6073/6073 - 236s - loss: 3.2668 - accuracy500: 0.3802 - val_loss: 3.3438 - val_accuracy500: 0.3115 - 236s/epoch - 39ms/step
Epoch 4/50
6073/6073 - 236s - loss: 3.2530 - accuracy500: 0.3917 - val_loss: 3.3729 - val_accuracy500: 0.3113 - 236s/epoch - 39ms/step
Epoch 5/50
6073/6073 - 236s - loss: 3.2394 - accuracy500: 0.4009 - val_loss: 3.3686 - val_accuracy500: 0.3118 - 236s/epoch - 39ms/step
Epoch 6/50
6073/6073 - 234s - loss: 3.2306 - accuracy500: 0.4062 - val_loss: 3.3845 - val_accuracy500: 0.3143 - 234s/epoch - 39ms/step
Epoch 7/50
6073/6073 - 234s - loss: 3.2229 - accuracy500: 0.4110 - val_loss: 3.3958 - val_accuracy500: 0.3131 - 234s/epoch - 39ms/step
Epoch 8/50
6073/6073 - 232s - loss: 3.2169 - accuracy500: 0.4152 - val_loss: 3.3748 - val_accuracy500: 0.3126 - 232s/epoch - 38ms/step
Epoch 9/50
6073/6073 - 230s - loss: 3.2127 - accuracy500: 0.4164 - val_loss: 3.3793 - val_accuracy500: 0.3113 - 230s/epoch - 38ms/step
Epoch 10/50
6073/6073 - 232s - loss: 3.2081 - accuracy500: 0.4189 - val_loss: 3.3915 - val_accuracy500: 0.3116 - 232s/epoch - 38ms/step
Epoch 11/50
6073/6073 - 231s - loss: 3.2049 - accuracy500: 0.4203 - val_loss: 3.3904 - val_accuracy500: 0.3105 - 231s/epoch - 38ms/step
Epoch 12/50
6073/6073 - 231s - loss: 3.2027 - accuracy500: 0.4210 - val_loss: 3.3869 - val_accuracy500: 0.3109 - 231s/epoch - 38ms/step
Epoch 13/50
6073/6073 - 229s - loss: 3.1997 - accuracy500: 0.4226 - val_loss: 3.3876 - val_accuracy500: 0.3118 - 229s/epoch - 38ms/step
testing model: results/AAPL/W1/deepVOL_L3/h500
Evaluating performance on  test set...
21353/21353 - 381s - 381s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.136088
{'0': {'precision': 0.3642547928262214, 'recall': 0.0002860805076204756, 'f1-score': 0.0005717120008075795, 'support': 2058861}, '1': {'precision': 0.23958136619028214, 'recall': 0.994512652149364, 'f1-score': 0.38614027189926786, 'support': 1308829}, '2': {'precision': 0.36608216750015826, 'recall': 0.00551148496064144, 'f1-score': 0.010859476996846655, 'support': 2098527}, 'accuracy': 0.24034940435039442, 'macro avg': {'precision': 0.3233061088388873, 'recall': 0.3334367392058753, 'f1-score': 0.13252382029897403, 'support': 5466217}, 'weighted avg': {'precision': 0.3351045777472889, 'recall': 0.24034940435039442, 'f1-score': 0.09684166712647946, 'support': 5466217}}
[[    589 2045029   13243]
 [    397 1301647    6785]
 [    631 2086330   11566]]
Evaluating performance on  train set...
6073/6073 - 110s - 110s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095555
{'0': {'precision': 0.32181425485961124, 'recall': 0.0002889556869969941, 'f1-score': 0.0005773929352680518, 'support': 515650}, '1': {'precision': 0.33047422562955936, 'recall': 0.994057157989637, 'f1-score': 0.49603999358703416, 'support': 513559}, '2': {'precision': 0.34763948497854075, 'recall': 0.006167375724523885, 'f1-score': 0.012119738527863242, 'support': 525345}, 'accuracy': 0.3305745570755342, 'macro avg': {'precision': 0.33330932182257045, 'recall': 0.3335044964670526, 'f1-score': 0.16957904168338847, 'support': 1554554}, 'weighted avg': {'precision': 0.33340250553824496, 'recall': 0.3305745570755342, 'f1-score': 0.16815792810706798, 'support': 1554554}}
[[   149 512308   3193]
 [   165 510507   2887]
 [   149 521956   3240]]
Evaluating performance on  val set...
1786/1786 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1157904
{'0': {'precision': 0.3493150684931507, 'recall': 0.000325903583661367, 'f1-score': 0.0006511996118339569, 'support': 156488}, '1': {'precision': 0.3112796425606504, 'recall': 0.994001870460091, 'f1-score': 0.4740932034276324, 'support': 142211}, '2': {'precision': 0.3524590163934426, 'recall': 0.006511287493532878, 'f1-score': 0.012786361214704316, 'support': 158494}, 'accuracy': 0.31155551375458507, 'macro avg': {'precision': 0.3376845758157479, 'recall': 0.3336130205124284, 'f1-score': 0.16251025475139022, 'support': 457193}, 'weighted avg': {'precision': 0.33857396117353306, 'recall': 0.31155551375458507, 'f1-score': 0.1521233593074851, 'support': 457193}}
[[    51 155346   1091]
 [    48 141358    805]
 [    47 157415   1032]]
training model: results/AAPL/W1/deepVOL_L3/h1000
Epoch 1/50
6073/6073 - 235s - loss: 3.2687 - accuracy1000: 0.3834 - val_loss: 3.3620 - val_accuracy1000: 0.3079 - 235s/epoch - 39ms/step
Epoch 2/50
6073/6073 - 230s - loss: 3.2665 - accuracy1000: 0.3837 - val_loss: 3.3672 - val_accuracy1000: 0.3069 - 230s/epoch - 38ms/step
Epoch 3/50
6073/6073 - 230s - loss: 3.2579 - accuracy1000: 0.3884 - val_loss: 3.3644 - val_accuracy1000: 0.3140 - 230s/epoch - 38ms/step
Epoch 4/50
6073/6073 - 230s - loss: 3.2445 - accuracy1000: 0.3982 - val_loss: 3.3744 - val_accuracy1000: 0.3137 - 230s/epoch - 38ms/step
Epoch 5/50
6073/6073 - 229s - loss: 3.2347 - accuracy1000: 0.4045 - val_loss: 3.3889 - val_accuracy1000: 0.3050 - 229s/epoch - 38ms/step
Epoch 6/50
6073/6073 - 230s - loss: 3.2221 - accuracy1000: 0.4118 - val_loss: 3.3978 - val_accuracy1000: 0.3026 - 230s/epoch - 38ms/step
Epoch 7/50
6073/6073 - 230s - loss: 3.2103 - accuracy1000: 0.4193 - val_loss: 3.4256 - val_accuracy1000: 0.3007 - 230s/epoch - 38ms/step
Epoch 8/50
6073/6073 - 229s - loss: 3.2031 - accuracy1000: 0.4224 - val_loss: 3.4378 - val_accuracy1000: 0.3012 - 229s/epoch - 38ms/step
Epoch 9/50
6073/6073 - 232s - loss: 3.1980 - accuracy1000: 0.4250 - val_loss: 3.4436 - val_accuracy1000: 0.3011 - 232s/epoch - 38ms/step
Epoch 10/50
6073/6073 - 228s - loss: 3.1927 - accuracy1000: 0.4273 - val_loss: 3.4445 - val_accuracy1000: 0.3025 - 228s/epoch - 38ms/step
Epoch 11/50
6073/6073 - 229s - loss: 3.1886 - accuracy1000: 0.4296 - val_loss: 3.4504 - val_accuracy1000: 0.3010 - 229s/epoch - 38ms/step
testing model: results/AAPL/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
21353/21353 - 383s - 383s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.145993
{'0': {'precision': 0.4666666666666667, 'recall': 6.846966867038261e-06, 'f1-score': 1.3693732818644604e-05, 'support': 2044701}, '1': {'precision': 0.24483709507169368, 'recall': 0.9860676509063726, 'f1-score': 0.39227395942851817, 'support': 1337750}, '2': {'precision': 0.37059408211636974, 'recall': 0.013956461522071096, 'f1-score': 0.026899881604262245, 'support': 2083766}, 'accuracy': 0.2466437025826088, 'macro avg': {'precision': 0.3606992812849101, 'recall': 0.3333436531317702, 'f1-score': 0.13972917825519968, 'support': 5466217}, 'weighted avg': {'precision': 0.3757545615271874, 'recall': 0.2466437025826088, 'f1-score': 0.10626097491293802, 'support': 5466217}}
[[     14 2013928   30759]
 [      5 1319112   18633]
 [     11 2054673   29082]]
Evaluating performance on  train set...
6073/6073 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1143621
{'0': {'precision': 0.6, 'recall': 5.8664101089979e-06, 'f1-score': 1.1732705503225515e-05, 'support': 511386}, '1': {'precision': 0.3302452828823091, 'recall': 0.9778944599768151, 'f1-score': 0.49374699351040924, 'support': 513265}, '2': {'precision': 0.34457824383498503, 'recall': 0.022572055640371916, 'f1-score': 0.042368693711644215, 'support': 529903}, 'accuracy': 0.33056619454840425, 'macro avg': {'precision': 0.42494117557243144, 'recall': 0.3334907940090987, 'f1-score': 0.17870913997585222, 'support': 1554554}, 'weighted avg': {'precision': 0.42386947655821433, 'recall': 0.33056619454840425, 'f1-score': 0.1774659152846013, 'support': 1554554}}
[[     3 499977  11406]
 [     1 501919  11345]
 [     1 517941  11961]]
Evaluating performance on  val set...
1786/1786 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1219745
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 157879}, '1': {'precision': 0.30708370718260475, 'recall': 0.9779462587021427, 'f1-score': 0.4673997813597245, 'support': 140339}, '2': {'precision': 0.3370677057963955, 'recall': 0.021764428369240446, 'f1-score': 0.04088867879933821, 'support': 158975}, 'accuracy': 0.30775624298709736, 'macro avg': {'precision': 0.21471713765966674, 'recall': 0.33323689569046105, 'f1-score': 0.16942948671968758, 'support': 457193}, 'weighted avg': {'precision': 0.21146683984943243, 'recall': 0.30775624298709736, 'f1-score': 0.15768985008162234, 'support': 457193}}
[[     0 154168   3711]
 [     1 137244   3094]
 [     0 155515   3460]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :       232 (peak)  32.00 (ave)

============================================
