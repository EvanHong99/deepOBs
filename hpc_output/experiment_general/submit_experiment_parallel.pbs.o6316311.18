This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-13.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-05.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-20.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-21.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-01.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-25.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-27.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-22.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-15.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-26.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-11.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-28.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-02-19.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-07.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-06.csv
training model: results/ATVI/W1/deepLOB_L1/h10
Epoch 1/50
2948/2948 - 81s - loss: 2.8871 - accuracy10: 0.4493 - val_loss: 3.0302 - val_accuracy10: 0.5462 - 81s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 68s - loss: 2.7574 - accuracy10: 0.5016 - val_loss: 2.8211 - val_accuracy10: 0.6727 - 68s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 70s - loss: 2.6501 - accuracy10: 0.5467 - val_loss: 2.6550 - val_accuracy10: 0.6550 - 70s/epoch - 24ms/step
Epoch 4/50
2948/2948 - 70s - loss: 2.6011 - accuracy10: 0.5627 - val_loss: 2.6830 - val_accuracy10: 0.6680 - 70s/epoch - 24ms/step
Epoch 5/50
2948/2948 - 67s - loss: 2.5731 - accuracy10: 0.5712 - val_loss: 2.7164 - val_accuracy10: 0.6817 - 67s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 69s - loss: 2.5512 - accuracy10: 0.5773 - val_loss: 2.7032 - val_accuracy10: 0.6967 - 69s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 67s - loss: 2.5344 - accuracy10: 0.5811 - val_loss: 2.7391 - val_accuracy10: 0.6946 - 67s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 66s - loss: 2.5212 - accuracy10: 0.5835 - val_loss: 2.7779 - val_accuracy10: 0.6943 - 66s/epoch - 22ms/step
Epoch 9/50
2948/2948 - 67s - loss: 2.5102 - accuracy10: 0.5857 - val_loss: 2.7537 - val_accuracy10: 0.7004 - 67s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 69s - loss: 2.4998 - accuracy10: 0.5873 - val_loss: 2.7966 - val_accuracy10: 0.7043 - 69s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 67s - loss: 2.4907 - accuracy10: 0.5891 - val_loss: 2.7366 - val_accuracy10: 0.7061 - 67s/epoch - 23ms/step
Epoch 12/50
2948/2948 - 67s - loss: 2.4842 - accuracy10: 0.5898 - val_loss: 2.7621 - val_accuracy10: 0.7059 - 67s/epoch - 23ms/step
Epoch 13/50
2948/2948 - 68s - loss: 2.4774 - accuracy10: 0.5915 - val_loss: 2.7840 - val_accuracy10: 0.7043 - 68s/epoch - 23ms/step
testing model: results/ATVI/W1/deepLOB_L1/h10
Evaluating performance on  test set...
12066/12066 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8356363
{'0': {'precision': 0.3849177885899792, 'recall': 0.45019268461268974, 'f1-score': 0.41500418965156066, 'support': 528065}, '1': {'precision': 0.7398159953370536, 'recall': 0.7524944487240054, 'f1-score': 0.7461013648787135, 'support': 2034217}, '2': {'precision': 0.4254915466655394, 'recall': 0.32496011850501366, 'f1-score': 0.36849217569766207, 'support': 526560}, 'accuracy': 0.6279307908918618, 'macro avg': {'precision': 0.5167417768641908, 'recall': 0.5092157506139029, 'f1-score': 0.5098659100759787, 'support': 3088842}, 'weighted avg': {'precision': 0.6255595836337788, 'recall': 0.6279307908918618, 'f1-score': 0.6251256968155685, 'support': 3088842}}
[[ 237731  247159   43175]
 [ 315617 1530737  187863]
 [  64267  291182  171111]]
Evaluating performance on  train set...
2948/2948 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90642476
{'0': {'precision': 0.3673711676451403, 'recall': 0.22045376256537125, 'f1-score': 0.27555264162206067, 'support': 127732}, '1': {'precision': 0.7060870128739198, 'recall': 0.6963369502479514, 'f1-score': 0.7011780889137368, 'support': 500703}, '2': {'precision': 0.3035757947870878, 'recall': 0.4432552936603013, 'f1-score': 0.3603534457738076, 'support': 126047}, 'accuracy': 0.5734901561601204, 'macro avg': {'precision': 0.45901132510204934, 'recall': 0.45334866882454133, 'f1-score': 0.44569472543653504, 'support': 754482}, 'weighted avg': {'precision': 0.5814979784781975, 'recall': 0.5734901561601204, 'f1-score': 0.5721810904070541, 'support': 754482}}
[[ 28159  81320  18253]
 [ 42126 348658 109919]
 [  6365  63811  55871]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7906882
{'0': {'precision': 0.4180975455598862, 'recall': 0.3088715953307393, 'f1-score': 0.3552790583180414, 'support': 25700}, '1': {'precision': 0.7843096318304091, 'recall': 0.7659264138515103, 'f1-score': 0.7750090256646261, 'support': 127524}, '2': {'precision': 0.3222282748932022, 'recall': 0.44641722275182716, 'f1-score': 0.37429023395221045, 'support': 25176}, 'accuracy': 0.6549943946188341, 'macro avg': {'precision': 0.5082118174278325, 'recall': 0.5070717439780256, 'f1-score': 0.5015261059782927, 'support': 178400}, 'weighted avg': {'precision': 0.6663443243225416, 'recall': 0.6549943946188341, 'f1-score': 0.657993574650282, 'support': 178400}}
[[ 7938 14279  3483]
 [ 9693 97674 20157]
 [ 1355 12582 11239]]
training model: results/ATVI/W1/deepLOB_L1/h20
Epoch 1/50
2948/2948 - 70s - loss: 2.9558 - accuracy20: 0.4696 - val_loss: 2.9085 - val_accuracy20: 0.5819 - 70s/epoch - 24ms/step
Epoch 2/50
2948/2948 - 69s - loss: 2.9223 - accuracy20: 0.4773 - val_loss: 2.8647 - val_accuracy20: 0.5688 - 69s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 70s - loss: 2.8058 - accuracy20: 0.5246 - val_loss: 2.8603 - val_accuracy20: 0.6375 - 70s/epoch - 24ms/step
Epoch 4/50
2948/2948 - 69s - loss: 2.7277 - accuracy20: 0.5540 - val_loss: 2.9486 - val_accuracy20: 0.6463 - 69s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 69s - loss: 2.6896 - accuracy20: 0.5646 - val_loss: 2.9427 - val_accuracy20: 0.6466 - 69s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 70s - loss: 2.6650 - accuracy20: 0.5705 - val_loss: 2.8988 - val_accuracy20: 0.6451 - 70s/epoch - 24ms/step
Epoch 7/50
2948/2948 - 70s - loss: 2.6436 - accuracy20: 0.5755 - val_loss: 2.9212 - val_accuracy20: 0.6475 - 70s/epoch - 24ms/step
Epoch 8/50
2948/2948 - 69s - loss: 2.6298 - accuracy20: 0.5776 - val_loss: 2.9027 - val_accuracy20: 0.6425 - 69s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 70s - loss: 2.6197 - accuracy20: 0.5795 - val_loss: 2.8807 - val_accuracy20: 0.6506 - 70s/epoch - 24ms/step
Epoch 10/50
2948/2948 - 70s - loss: 2.6109 - accuracy20: 0.5815 - val_loss: 2.8769 - val_accuracy20: 0.6510 - 70s/epoch - 24ms/step
Epoch 11/50
2948/2948 - 69s - loss: 2.6014 - accuracy20: 0.5833 - val_loss: 2.8581 - val_accuracy20: 0.6507 - 69s/epoch - 23ms/step
Epoch 12/50
2948/2948 - 70s - loss: 2.5944 - accuracy20: 0.5848 - val_loss: 2.8604 - val_accuracy20: 0.6509 - 70s/epoch - 24ms/step
Epoch 13/50
2948/2948 - 68s - loss: 2.5890 - accuracy20: 0.5859 - val_loss: 2.8712 - val_accuracy20: 0.6514 - 68s/epoch - 23ms/step
Epoch 14/50
2948/2948 - 70s - loss: 2.5822 - accuracy20: 0.5866 - val_loss: 2.8854 - val_accuracy20: 0.6523 - 70s/epoch - 24ms/step
Epoch 15/50
2948/2948 - 70s - loss: 2.5772 - accuracy20: 0.5878 - val_loss: 2.8670 - val_accuracy20: 0.6545 - 70s/epoch - 24ms/step
Epoch 16/50
2948/2948 - 68s - loss: 2.5716 - accuracy20: 0.5896 - val_loss: 2.8803 - val_accuracy20: 0.6471 - 68s/epoch - 23ms/step
Epoch 17/50
2948/2948 - 68s - loss: 2.5678 - accuracy20: 0.5902 - val_loss: 2.8697 - val_accuracy20: 0.6483 - 68s/epoch - 23ms/step
Epoch 18/50
2948/2948 - 68s - loss: 2.5628 - accuracy20: 0.5910 - val_loss: 2.8566 - val_accuracy20: 0.6539 - 68s/epoch - 23ms/step
Epoch 19/50
2948/2948 - 68s - loss: 2.5589 - accuracy20: 0.5920 - val_loss: 2.8690 - val_accuracy20: 0.6518 - 68s/epoch - 23ms/step
Epoch 20/50
2948/2948 - 68s - loss: 2.5545 - accuracy20: 0.5927 - val_loss: 2.8715 - val_accuracy20: 0.6533 - 68s/epoch - 23ms/step
Epoch 21/50
2948/2948 - 65s - loss: 2.5515 - accuracy20: 0.5931 - val_loss: 2.8774 - val_accuracy20: 0.6513 - 65s/epoch - 22ms/step
Epoch 22/50
2948/2948 - 65s - loss: 2.5472 - accuracy20: 0.5936 - val_loss: 2.8798 - val_accuracy20: 0.6537 - 65s/epoch - 22ms/step
Epoch 23/50
2948/2948 - 65s - loss: 2.5442 - accuracy20: 0.5943 - val_loss: 2.8732 - val_accuracy20: 0.6504 - 65s/epoch - 22ms/step
Epoch 24/50
2948/2948 - 66s - loss: 2.5401 - accuracy20: 0.5950 - val_loss: 2.8882 - val_accuracy20: 0.6528 - 66s/epoch - 22ms/step
Epoch 25/50
2948/2948 - 67s - loss: 2.5377 - accuracy20: 0.5955 - val_loss: 2.9064 - val_accuracy20: 0.6495 - 67s/epoch - 23ms/step
Epoch 26/50
2948/2948 - 66s - loss: 2.5347 - accuracy20: 0.5958 - val_loss: 2.8883 - val_accuracy20: 0.6486 - 66s/epoch - 23ms/step
Epoch 27/50
2948/2948 - 66s - loss: 2.5310 - accuracy20: 0.5966 - val_loss: 2.9080 - val_accuracy20: 0.6492 - 66s/epoch - 22ms/step
Epoch 28/50
2948/2948 - 65s - loss: 2.5292 - accuracy20: 0.5969 - val_loss: 2.8766 - val_accuracy20: 0.6502 - 65s/epoch - 22ms/step
testing model: results/ATVI/W1/deepLOB_L1/h20
Evaluating performance on  test set...
12066/12066 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.873461
{'0': {'precision': 0.5224958552607467, 'recall': 0.35064811050360045, 'f1-score': 0.4196608842913098, 'support': 691163}, '1': {'precision': 0.6227704111000975, 'recall': 0.8763194199552381, 'f1-score': 0.7281028716422232, 'support': 1709937}, '2': {'precision': 0.6114227761128572, 'recall': 0.19460495360178673, 'f1-score': 0.29524021715392473, 'support': 687742}, 'accuracy': 0.6069083494720675, 'macro avg': {'precision': 0.5855630141579005, 'recall': 0.47385749468687505, 'f1-score': 0.48100132436248594, 'support': 3088842}, 'weighted avg': {'precision': 0.5978062633648012, 'recall': 0.6069083494720675, 'f1-score': 0.5627070640785762, 'support': 3088842}}
[[ 242355  415550   33258]
 [ 159686 1498451   51800]
 [  61800  492104  133838]]
Evaluating performance on  train set...
2948/2948 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.923261
{'0': {'precision': 0.5444293277820578, 'recall': 0.19486066295101204, 'f1-score': 0.28699931304734794, 'support': 170450}, '1': {'precision': 0.6056579274062045, 'recall': 0.8685578047336994, 'f1-score': 0.713666132274829, 'support': 415658}, '2': {'precision': 0.5061761353718516, 'recall': 0.2927827336762208, 'f1-score': 0.3709818824901699, 'support': 168374}, 'accuracy': 0.5878655819489398, 'macro avg': {'precision': 0.5520877968533712, 'recall': 0.4520670671203107, 'f1-score': 0.45721577593744894, 'support': 754482}, 'weighted avg': {'precision': 0.569624513676085, 'recall': 0.5878655819489398, 'f1-score': 0.5407998780625796, 'support': 754482}}
[[ 33214 123376  13860]
 [ 20401 361023  34234]
 [  7392 111685  49297]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.80180097
{'0': {'precision': 0.5527868397306864, 'recall': 0.23039981484695943, 'f1-score': 0.3252404386090295, 'support': 34566}, '1': {'precision': 0.6809980567215994, 'recall': 0.8948267558406863, 'f1-score': 0.7734048569005058, 'support': 110047}, '2': {'precision': 0.520730198019802, 'recall': 0.29887234735253204, 'f1-score': 0.37977397092837395, 'support': 33787}, 'accuracy': 0.6532230941704036, 'macro avg': {'precision': 0.5848383648240293, 'recall': 0.47469963934672593, 'f1-score': 0.49280642214596976, 'support': 178400}, 'weighted avg': {'precision': 0.6258034431091245, 'recall': 0.6532230941704036, 'f1-score': 0.6120211235652838, 'support': 178400}}
[[ 7964 23869  2733]
 [ 5013 98473  6561]
 [ 1430 22259 10098]]
training model: results/ATVI/W1/deepLOB_L1/h30
Epoch 1/50
2948/2948 - 68s - loss: 3.0080 - accuracy30: 0.4716 - val_loss: 2.9987 - val_accuracy30: 0.5237 - 68s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 67s - loss: 2.9630 - accuracy30: 0.4854 - val_loss: 3.1869 - val_accuracy30: 0.5453 - 67s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 68s - loss: 2.8859 - accuracy30: 0.5174 - val_loss: 3.2849 - val_accuracy30: 0.5639 - 68s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 66s - loss: 2.8248 - accuracy30: 0.5382 - val_loss: 3.1675 - val_accuracy30: 0.5622 - 66s/epoch - 22ms/step
Epoch 5/50
2948/2948 - 66s - loss: 2.7877 - accuracy30: 0.5491 - val_loss: 3.2736 - val_accuracy30: 0.5640 - 66s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 65s - loss: 2.7642 - accuracy30: 0.5548 - val_loss: 3.2331 - val_accuracy30: 0.5634 - 65s/epoch - 22ms/step
Epoch 7/50
2948/2948 - 67s - loss: 2.7492 - accuracy30: 0.5583 - val_loss: 3.3256 - val_accuracy30: 0.5648 - 67s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 69s - loss: 2.7352 - accuracy30: 0.5612 - val_loss: 3.1323 - val_accuracy30: 0.5599 - 69s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 68s - loss: 2.7232 - accuracy30: 0.5637 - val_loss: 3.1067 - val_accuracy30: 0.5628 - 68s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 68s - loss: 2.7146 - accuracy30: 0.5646 - val_loss: 3.0977 - val_accuracy30: 0.5601 - 68s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 66s - loss: 2.7049 - accuracy30: 0.5665 - val_loss: 3.0859 - val_accuracy30: 0.5582 - 66s/epoch - 23ms/step
testing model: results/ATVI/W1/deepLOB_L1/h30
Evaluating performance on  test set...
12066/12066 - 191s - 191s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0415832
{'0': {'precision': 0.368642834852868, 'recall': 0.4323272062323584, 'f1-score': 0.3979532784361882, 'support': 808811}, '1': {'precision': 0.4836280932398948, 'recall': 0.6305340566443198, 'f1-score': 0.5473960564346912, 'support': 1477465}, '2': {'precision': 0.44338913052618795, 'recall': 0.11825444885529664, 'f1-score': 0.18671178371359856, 'support': 802566}, 'accuracy': 0.4455294249430693, 'macro avg': {'precision': 0.43188668620631687, 'recall': 0.3937052372439916, 'f1-score': 0.377353706194826, 'support': 3088842}, 'weighted avg': {'precision': 0.44306410027082793, 'recall': 0.4455294249430693, 'f1-score': 0.4145488934084103, 'support': 3088842}}
[[349671 441615  17525]
 [444256 931592 101617]
 [154609 553050  94907]]
Evaluating performance on  train set...
2948/2948 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0432566
{'0': {'precision': 0.36609607951408063, 'recall': 0.17967118997912318, 'f1-score': 0.24104383655717063, 'support': 199264}, '1': {'precision': 0.4796955226669254, 'recall': 0.7460429222442952, 'f1-score': 0.5839311820620232, 'support': 357903}, '2': {'precision': 0.3882292978353421, 'recall': 0.19687808833590958, 'f1-score': 0.26126432104702113, 'support': 197315}, 'accuracy': 0.4528404918871491, 'macro avg': {'precision': 0.4113403000054494, 'recall': 0.3741974001864427, 'f1-score': 0.36207977988873835, 'support': 754482}, 'weighted avg': {'precision': 0.4257725164281386, 'recall': 0.4528404918871491, 'f1-score': 0.40898715994372997, 'support': 754482}}
[[ 35802 146242  17220]
 [ 46897 267011  43995]
 [ 15095 143373  38847]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9774675
{'0': {'precision': 0.3912685694486552, 'recall': 0.22025551004486055, 'f1-score': 0.28185008969659153, 'support': 41016}, '1': {'precision': 0.5602472727272727, 'recall': 0.791082174618497, 'f1-score': 0.6559490458876523, 'support': 97378}, '2': {'precision': 0.4011004435461232, 'recall': 0.1785732140178973, 'f1-score': 0.24712454814327964, 'support': 40006}, 'accuracy': 0.5224887892376682, 'macro avg': {'precision': 0.4508720952406837, 'recall': 0.39663696622708494, 'f1-score': 0.3949745612425078, 'support': 178400}, 'weighted avg': {'precision': 0.4857088279856985, 'recall': 0.5224887892376682, 'f1-score': 0.4782614021438524, 'support': 178400}}
[[ 9034 29427  2555]
 [12232 77034  8112]
 [ 1823 31039  7144]]
training model: results/ATVI/W1/deepLOB_L1/h50
Epoch 1/50
2948/2948 - 67s - loss: 3.0737 - accuracy50: 0.4692 - val_loss: 3.2989 - val_accuracy50: 0.4528 - 67s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 68s - loss: 3.0608 - accuracy50: 0.4756 - val_loss: 3.1721 - val_accuracy50: 0.4560 - 68s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 67s - loss: 3.0021 - accuracy50: 0.4968 - val_loss: 3.2441 - val_accuracy50: 0.4877 - 67s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 66s - loss: 2.9433 - accuracy50: 0.5148 - val_loss: 3.3786 - val_accuracy50: 0.4818 - 66s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 66s - loss: 2.9129 - accuracy50: 0.5222 - val_loss: 3.4474 - val_accuracy50: 0.4874 - 66s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 67s - loss: 2.8931 - accuracy50: 0.5269 - val_loss: 3.4637 - val_accuracy50: 0.4897 - 67s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 67s - loss: 2.8778 - accuracy50: 0.5300 - val_loss: 3.4738 - val_accuracy50: 0.4929 - 67s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 67s - loss: 2.8671 - accuracy50: 0.5318 - val_loss: 3.4654 - val_accuracy50: 0.4972 - 67s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 69s - loss: 2.8581 - accuracy50: 0.5335 - val_loss: 3.4700 - val_accuracy50: 0.4965 - 69s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 66s - loss: 2.8501 - accuracy50: 0.5354 - val_loss: 3.5543 - val_accuracy50: 0.4925 - 66s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 66s - loss: 2.8429 - accuracy50: 0.5363 - val_loss: 3.4812 - val_accuracy50: 0.4953 - 66s/epoch - 22ms/step
Epoch 12/50
2948/2948 - 66s - loss: 2.8368 - accuracy50: 0.5377 - val_loss: 3.4847 - val_accuracy50: 0.4933 - 66s/epoch - 22ms/step
testing model: results/ATVI/W1/deepLOB_L1/h50
Evaluating performance on  test set...
12066/12066 - 175s - 175s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024197
{'0': {'precision': 0.39779944465307265, 'recall': 0.44919971482134546, 'f1-score': 0.42193996321113664, 'support': 969217}, '1': {'precision': 0.37622597641902084, 'recall': 0.5849257753138447, 'f1-score': 0.4579178481511353, 'support': 1157499}, '2': {'precision': 0.5273221939888607, 'recall': 0.10676876001687928, 'f1-score': 0.1775818955495185, 'support': 962126}, 'accuracy': 0.3933992091534627, 'macro avg': {'precision': 0.4337825383536514, 'recall': 0.3802980833840231, 'f1-score': 0.35247990230393017, 'support': 3088842}, 'weighted avg': {'precision': 0.43005941030362965, 'recall': 0.3933992091534627, 'f1-score': 0.35930843839800647, 'support': 3088842}}
[[435372 506042  27803]
 [416171 677051  64277]
 [242908 616493 102725]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1305234
{'0': {'precision': 0.39794938545578695, 'recall': 0.15709472265509836, 'f1-score': 0.22526407334263404, 'support': 237430}, '1': {'precision': 0.39034921818811436, 'recall': 0.522509769803463, 'f1-score': 0.44686262132813714, 'support': 280456}, '2': {'precision': 0.40486570595491755, 'recall': 0.488283825592994, 'f1-score': 0.44267923516112967, 'support': 236596}, 'accuracy': 0.3967834885391567, 'macro avg': {'precision': 0.3977214365329396, 'recall': 0.3892961060171851, 'f1-score': 0.3716019766106336, 'support': 754482}, 'weighted avg': {'precision': 0.39729312228925673, 'recall': 0.3967834885391567, 'f1-score': 0.37581531247018246, 'support': 754482}}
[[ 37299 129711  70420]
 [ 34517 146541  99398]
 [ 21912  99158 115526]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.048515
{'0': {'precision': 0.475075251449967, 'recall': 0.12903032840820722, 'f1-score': 0.2029417299128144, 'support': 50151}, '1': {'precision': 0.47344192634560905, 'recall': 0.7231663291362156, 'f1-score': 0.5722461939670832, 'support': 79499}, '2': {'precision': 0.4000738228712483, 'recall': 0.35573333333333335, 'f1-score': 0.3766029295199627, 'support': 48750}, 'accuracy': 0.4557399103139013, 'macro avg': {'precision': 0.4495303335556082, 'recall': 0.4026433302925854, 'f1-score': 0.3839302844666201, 'support': 178400}, 'weighted avg': {'precision': 0.4538523402633981, 'recall': 0.4557399103139013, 'f1-score': 0.4149670610153861, 'support': 178400}}
[[ 6471 34262  9418]
 [ 5421 57491 16587]
 [ 1729 29679 17342]]
training model: results/ATVI/W1/deepLOB_L1/h100
Epoch 1/50
2948/2948 - 69s - loss: 3.1939 - accuracy100: 0.4269 - val_loss: 3.3020 - val_accuracy100: 0.3897 - 69s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 69s - loss: 3.1702 - accuracy100: 0.4365 - val_loss: 3.3536 - val_accuracy100: 0.3940 - 69s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 67s - loss: 3.1568 - accuracy100: 0.4443 - val_loss: 3.3713 - val_accuracy100: 0.3772 - 67s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 68s - loss: 3.1447 - accuracy100: 0.4484 - val_loss: 3.3263 - val_accuracy100: 0.3832 - 68s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 68s - loss: 3.1357 - accuracy100: 0.4518 - val_loss: 3.3511 - val_accuracy100: 0.3915 - 68s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 68s - loss: 3.1276 - accuracy100: 0.4542 - val_loss: 3.3510 - val_accuracy100: 0.3882 - 68s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 72s - loss: 3.1212 - accuracy100: 0.4567 - val_loss: 3.3838 - val_accuracy100: 0.3942 - 72s/epoch - 24ms/step
Epoch 8/50
2948/2948 - 69s - loss: 3.1156 - accuracy100: 0.4586 - val_loss: 3.4107 - val_accuracy100: 0.3971 - 69s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 71s - loss: 3.1108 - accuracy100: 0.4603 - val_loss: 3.4179 - val_accuracy100: 0.3986 - 71s/epoch - 24ms/step
Epoch 10/50
2948/2948 - 70s - loss: 3.1067 - accuracy100: 0.4616 - val_loss: 3.4465 - val_accuracy100: 0.3984 - 70s/epoch - 24ms/step
Epoch 11/50
2948/2948 - 69s - loss: 3.1041 - accuracy100: 0.4622 - val_loss: 3.4814 - val_accuracy100: 0.4018 - 69s/epoch - 23ms/step
testing model: results/ATVI/W1/deepLOB_L1/h100
Evaluating performance on  test set...
12066/12066 - 184s - 184s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1198299
{'0': {'precision': 0.40173341922031236, 'recall': 0.2296489606880519, 'f1-score': 0.29224021807828093, 'support': 996669}, '1': {'precision': 0.3567520204442561, 'recall': 0.8050702087711088, 'f1-score': 0.4944137172733204, 'support': 1072658}, '2': {'precision': 0.4492231136386717, 'recall': 0.04338827775952291, 'f1-score': 0.07913344096745485, 'support': 1019515}, 'accuracy': 0.3679968091601966, 'macro avg': {'precision': 0.4025695177677467, 'recall': 0.3593691490728945, 'f1-score': 0.28859579210635206, 'support': 3088842}, 'weighted avg': {'precision': 0.40178741957274433, 'recall': 0.3679968091601966, 'f1-score': 0.2921098991540396, 'support': 3088842}}
[[228884 750683  17102]
 [171960 863565  37133]
 [168897 806383  44235]]
Evaluating performance on  train set...
2948/2948 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1547245
{'0': {'precision': 0.3905151533053701, 'recall': 0.10480482623033993, 'f1-score': 0.16525831572894661, 'support': 252288}, '1': {'precision': 0.3274031466181088, 'recall': 0.7721547945865241, 'f1-score': 0.459831901440179, 'support': 249156}, '2': {'precision': 0.39137143375790395, 'recall': 0.1533682687975719, 'f1-score': 0.2203766641964582, 'support': 253038}, 'accuracy': 0.3414740179354842, 'macro avg': {'precision': 0.369763244560461, 'recall': 0.3434426298714786, 'f1-score': 0.2818222937885279, 'support': 754482}, 'weighted avg': {'precision': 0.3699605693059864, 'recall': 0.3414740179354842, 'f1-score': 0.2810222610331289, 'support': 754482}}
[[ 26441 199584  26263]
 [ 22681 192387  34088]
 [ 18586 195644  38808]]
Evaluating performance on  val set...
697/697 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1015443
{'0': {'precision': 0.4944965348552792, 'recall': 0.021856249662156074, 'f1-score': 0.041862230811706244, 'support': 55499}, '1': {'precision': 0.38706868333775946, 'recall': 0.9157899351218657, 'f1-score': 0.5441474606365013, 'support': 68436}, '2': {'precision': 0.4069137562366358, 'recall': 0.10481960892316167, 'f1-score': 0.16669829914592305, 'support': 54465}, 'accuracy': 0.3901065022421525, 'macro avg': {'precision': 0.4294929914765582, 'recall': 0.3474885979023945, 'f1-score': 0.25090266353137686, 'support': 178400}, 'weighted avg': {'precision': 0.4265473841606749, 'recall': 0.3901065022421525, 'f1-score': 0.27265588804328017, 'support': 178400}}
[[ 1213 50921  3365]
 [  807 62673  4956]
 [  433 48323  5709]]
training model: results/ATVI/W1/deepLOB_L1/h200
Epoch 1/50
2948/2948 - 71s - loss: 3.2533 - accuracy200: 0.3964 - val_loss: 3.3469 - val_accuracy200: 0.3621 - 71s/epoch - 24ms/step
Epoch 2/50
2948/2948 - 69s - loss: 3.2387 - accuracy200: 0.4032 - val_loss: 3.3706 - val_accuracy200: 0.3588 - 69s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 68s - loss: 3.2258 - accuracy200: 0.4126 - val_loss: 3.3803 - val_accuracy200: 0.3678 - 68s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 68s - loss: 3.2170 - accuracy200: 0.4160 - val_loss: 3.4036 - val_accuracy200: 0.3639 - 68s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 69s - loss: 3.2102 - accuracy200: 0.4184 - val_loss: 3.3753 - val_accuracy200: 0.3632 - 69s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 69s - loss: 3.2062 - accuracy200: 0.4197 - val_loss: 3.3734 - val_accuracy200: 0.3620 - 69s/epoch - 24ms/step
Epoch 7/50
2948/2948 - 68s - loss: 3.2018 - accuracy200: 0.4213 - val_loss: 3.3843 - val_accuracy200: 0.3631 - 68s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 68s - loss: 3.1993 - accuracy200: 0.4223 - val_loss: 3.3870 - val_accuracy200: 0.3573 - 68s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 69s - loss: 3.1968 - accuracy200: 0.4240 - val_loss: 3.3764 - val_accuracy200: 0.3550 - 69s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 69s - loss: 3.1956 - accuracy200: 0.4242 - val_loss: 3.4032 - val_accuracy200: 0.3576 - 69s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 68s - loss: 3.1928 - accuracy200: 0.4253 - val_loss: 3.4199 - val_accuracy200: 0.3561 - 68s/epoch - 23ms/step
testing model: results/ATVI/W1/deepLOB_L1/h200
Evaluating performance on  test set...
12066/12066 - 185s - 185s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1292604
{'0': {'precision': 0.3703487937531052, 'recall': 0.16774453721267157, 'f1-score': 0.23090413294617446, 'support': 1004295}, '1': {'precision': 0.3339898117822007, 'recall': 0.8318538698174138, 'f1-score': 0.47661744330837086, 'support': 1045424}, '2': {'precision': 0.4099708300185627, 'recall': 0.011902344573260336, 'f1-score': 0.02313308538087387, 'support': 1039123}, 'accuracy': 0.340086349512212, 'macro avg': {'precision': 0.3714364785179562, 'recall': 0.3371669172011152, 'f1-score': 0.24355155387847305, 'support': 3088842}, 'weighted avg': {'precision': 0.3713723543050273, 'recall': 0.340086349512212, 'f1-score': 0.2441695953793099, 'support': 3088842}}
[[168465 829421   6409]
 [164393 869640  11391]
 [122024 904731  12368]]
Evaluating performance on  train set...
2948/2948 - 46s - 46s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1462841
{'0': {'precision': 0.3760321012423798, 'recall': 0.03869241396833463, 'f1-score': 0.07016508160488405, 'support': 251884}, '1': {'precision': 0.3331174180727362, 'recall': 0.8476420604567058, 'f1-score': 0.47827578734469806, 'support': 249964}, '2': {'precision': 0.3750864752680733, 'recall': 0.1373528503685173, 'f1-score': 0.20107432796555658, 'support': 252634}, 'accuracy': 0.3397377273414077, 'macro avg': {'precision': 0.36141199819439646, 'recall': 0.3412291082645192, 'f1-score': 0.2498383989717129, 'support': 754482}, 'weighted avg': {'precision': 0.361497595268467, 'recall': 0.3397377273414077, 'f1-score': 0.24920859887186855, 'support': 754482}}
[[  9746 213507  28631]
 [  8903 211880  29181]
 [  7269 210665  34700]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1162182
{'0': {'precision': 0.4429164743885556, 'recall': 0.08155184719437175, 'f1-score': 0.13774199566596348, 'support': 58846}, '1': {'precision': 0.35333060681969225, 'recall': 0.8875120385232744, 'f1-score': 0.5054390551584182, 'support': 62300}, '2': {'precision': 0.3963166922451927, 'recall': 0.07667586544171587, 'f1-score': 0.12849219241632642, 'support': 57254}, 'accuracy': 0.36144058295964127, 'macro avg': {'precision': 0.39752125781781356, 'recall': 0.3485799170531207, 'f1-score': 0.25722441441356936, 'support': 178400}, 'weighted avg': {'precision': 0.3966764324806168, 'recall': 0.36144058295964127, 'f1-score': 0.2631788710646474, 'support': 178400}}
[[ 4799 50425  3622]
 [ 3943 55292  3065]
 [ 2093 50771  4390]]
training model: results/ATVI/W1/deepLOB_L1/h300
Epoch 1/50
2948/2948 - 70s - loss: 3.2735 - accuracy300: 0.3838 - val_loss: 3.4562 - val_accuracy300: 0.3249 - 70s/epoch - 24ms/step
Epoch 2/50
2948/2948 - 71s - loss: 3.2496 - accuracy300: 0.3975 - val_loss: 3.5337 - val_accuracy300: 0.3403 - 71s/epoch - 24ms/step
Epoch 3/50
2948/2948 - 69s - loss: 3.2402 - accuracy300: 0.4031 - val_loss: 3.5210 - val_accuracy300: 0.3507 - 69s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 69s - loss: 3.2341 - accuracy300: 0.4068 - val_loss: 3.5474 - val_accuracy300: 0.3533 - 69s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 71s - loss: 3.2277 - accuracy300: 0.4104 - val_loss: 3.6079 - val_accuracy300: 0.3508 - 71s/epoch - 24ms/step
Epoch 6/50
2948/2948 - 70s - loss: 3.2229 - accuracy300: 0.4126 - val_loss: 3.6228 - val_accuracy300: 0.3501 - 70s/epoch - 24ms/step
Epoch 7/50
2948/2948 - 70s - loss: 3.2182 - accuracy300: 0.4147 - val_loss: 3.6753 - val_accuracy300: 0.3512 - 70s/epoch - 24ms/step
Epoch 8/50
2948/2948 - 68s - loss: 3.2140 - accuracy300: 0.4166 - val_loss: 3.6574 - val_accuracy300: 0.3504 - 68s/epoch - 23ms/step
Epoch 9/50
2948/2948 - 68s - loss: 3.2103 - accuracy300: 0.4188 - val_loss: 3.6689 - val_accuracy300: 0.3483 - 68s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 67s - loss: 3.2071 - accuracy300: 0.4202 - val_loss: 3.6368 - val_accuracy300: 0.3489 - 67s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 70s - loss: 3.2038 - accuracy300: 0.4216 - val_loss: 3.7003 - val_accuracy300: 0.3495 - 70s/epoch - 24ms/step
testing model: results/ATVI/W1/deepLOB_L1/h300
Evaluating performance on  test set...
12066/12066 - 185s - 185s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109766
{'0': {'precision': 0.3423613491916981, 'recall': 0.01385833159864, 'f1-score': 0.026638377156083408, 'support': 936765}, '1': {'precision': 0.39954662803633945, 'recall': 0.865042329896527, 'f1-score': 0.5466199018277438, 'support': 1192774}, '2': {'precision': 0.34809688876746014, 'recall': 0.17000051078751968, 'f1-score': 0.22843831659778444, 'support': 959303}, 'accuracy': 0.39104104386044997, 'macro avg': {'precision': 0.3633349553318325, 'recall': 0.3496337240942289, 'f1-score': 0.26723219852720387, 'support': 3088842}, 'weighted avg': {'precision': 0.36622506061179844, 'recall': 0.39104104386044997, 'f1-score': 0.29010531085322855, 'support': 3088842}}
[[  12982  765826  157957]
 [  13517 1031800  147457]
 [  11420  784801  163082]]
Evaluating performance on  train set...
2948/2948 - 49s - 49s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1700728
{'0': {'precision': 0.36854166666666666, 'recall': 0.006964265327092134, 'f1-score': 0.01367020721684936, 'support': 254011}, '1': {'precision': 0.32633062166969573, 'recall': 0.6846185081414707, 'f1-score': 0.44198461976047515, 'support': 246270}, '2': {'precision': 0.3424439437828559, 'recall': 0.3139169397445329, 'f1-score': 0.3275605160644136, 'support': 254201}, 'accuracy': 0.33157583613658115, 'macro avg': {'precision': 0.34577207737307275, 'recall': 0.3351665710710319, 'f1-score': 0.2610717810139127, 'support': 754482}, 'weighted avg': {'precision': 0.34597070896828336, 'recall': 0.33157583613658115, 'f1-score': 0.25923235552055757, 'support': 754482}}
[[  1769 175241  77001]
 [  1443 168601  76226]
 [  1588 172815  79798]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1548718
{'0': {'precision': 0.4270752521334368, 'recall': 0.03598803667445699, 'f1-score': 0.06638228599852282, 'support': 61187}, '1': {'precision': 0.31939766046055856, 'recall': 0.7169665412177141, 'f1-score': 0.4419246352249557, 'support': 58191}, '2': {'precision': 0.32691224777099953, 'recall': 0.2360645183152045, 'f1-score': 0.2741583203793707, 'support': 59022}, 'accuracy': 0.324304932735426, 'macro avg': {'precision': 0.3577950534549983, 'recall': 0.3296730320691252, 'f1-score': 0.26082174720094975, 'support': 178400}, 'weighted avg': {'precision': 0.35881467152516194, 'recall': 0.324304932735426, 'f1-score': 0.2576185076636672, 'support': 178400}}
[[ 2202 45151 13834]
 [ 1617 41721 14853]
 [ 1337 43752 13933]]
training model: results/ATVI/W1/deepLOB_L1/h500
Epoch 1/50
2948/2948 - 71s - loss: 3.2429 - accuracy500: 0.4057 - val_loss: 3.3210 - val_accuracy500: 0.3446 - 71s/epoch - 24ms/step
Epoch 2/50
2948/2948 - 67s - loss: 3.2110 - accuracy500: 0.4224 - val_loss: 3.4017 - val_accuracy500: 0.3112 - 67s/epoch - 23ms/step
Epoch 3/50
2948/2948 - 69s - loss: 3.1931 - accuracy500: 0.4307 - val_loss: 3.3700 - val_accuracy500: 0.3179 - 69s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 69s - loss: 3.1811 - accuracy500: 0.4356 - val_loss: 3.5407 - val_accuracy500: 0.3081 - 69s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 68s - loss: 3.1703 - accuracy500: 0.4404 - val_loss: 3.4692 - val_accuracy500: 0.3004 - 68s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 68s - loss: 3.1654 - accuracy500: 0.4407 - val_loss: 3.5300 - val_accuracy500: 0.2992 - 68s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 67s - loss: 3.1551 - accuracy500: 0.4453 - val_loss: 3.4709 - val_accuracy500: 0.3071 - 67s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 71s - loss: 3.1495 - accuracy500: 0.4478 - val_loss: 3.4887 - val_accuracy500: 0.3121 - 71s/epoch - 24ms/step
Epoch 9/50
2948/2948 - 69s - loss: 3.1433 - accuracy500: 0.4496 - val_loss: 3.5088 - val_accuracy500: 0.3010 - 69s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 68s - loss: 3.1384 - accuracy500: 0.4522 - val_loss: 3.5595 - val_accuracy500: 0.3007 - 68s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 68s - loss: 3.1326 - accuracy500: 0.4541 - val_loss: 3.5614 - val_accuracy500: 0.3136 - 68s/epoch - 23ms/step
testing model: results/ATVI/W1/deepLOB_L1/h500
Evaluating performance on  test set...
12066/12066 - 185s - 185s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1225903
{'0': {'precision': 0.23472090234730153, 'recall': 0.5891484868539023, 'f1-score': 0.33569754202173285, 'support': 775173}, '1': {'precision': 0.4325805322449698, 'recall': 0.1577095177738743, 'f1-score': 0.23114761001491446, 'support': 1496663}, '2': {'precision': 0.28089739083864707, 'recall': 0.20543178385470853, 'f1-score': 0.23730944011944724, 'support': 817006}, 'accuracy': 0.2786057040146437, 'macro avg': {'precision': 0.31606627514363944, 'recall': 0.3174299294941617, 'f1-score': 0.2680515307186982, 'support': 3088842}, 'weighted avg': {'precision': 0.3428053091955295, 'recall': 0.2786057040146437, 'f1-score': 0.2590151851805932, 'support': 3088842}}
[[ 456692  146503  171978]
 [1002932  236038  257693]
 [ 486057  163110  167839]]
Evaluating performance on  train set...
2948/2948 - 48s - 48s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118532
{'0': {'precision': 0.32135579818132054, 'recall': 0.25182616570740834, 'f1-score': 0.28237384838423046, 'support': 251757}, '1': {'precision': 0.3126602869411023, 'recall': 0.42689466396676884, 'f1-score': 0.3609549444990534, 'support': 249886}, '2': {'precision': 0.33021003560003886, 'recall': 0.28211233235379035, 'f1-score': 0.3042721552735416, 'support': 252839}, 'accuracy': 0.3199585941082756, 'macro avg': {'precision': 0.3214087069074872, 'recall': 0.3202777206759892, 'f1-score': 0.3158669827189418, 'support': 754482}, 'weighted avg': {'precision': 0.32144302360609955, 'recall': 0.3199585941082756, 'f1-score': 0.3157385433661322, 'support': 754482}}
[[ 63399 117485  70873]
 [ 69402 106675  73809]
 [ 64485 117025  71329]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065228
{'0': {'precision': 0.33405872309082996, 'recall': 0.33721991280543445, 'f1-score': 0.3356318746005584, 'support': 59178}, '1': {'precision': 0.3523722908233847, 'recall': 0.43733108645194113, 'f1-score': 0.39028162020288, 'support': 62902}, '2': {'precision': 0.35197319800955806, 'recall': 0.25369318181818185, 'f1-score': 0.2948593598448109, 'support': 56320}, 'accuracy': 0.3461491031390134, 'macro avg': {'precision': 0.3461347373079242, 'recall': 0.3427480603585191, 'f1-score': 0.3402576182160831, 'support': 178400}, 'weighted avg': {'precision': 0.3461714095534753, 'recall': 0.3461491031390134, 'f1-score': 0.34202912945949077, 'support': 178400}}
[[19956 24523 14699]
 [23786 27509 11607]
 [15996 26036 14288]]
training model: results/ATVI/W1/deepLOB_L1/h1000
Epoch 1/50
2948/2948 - 73s - loss: 3.2340 - accuracy1000: 0.4117 - val_loss: 3.3847 - val_accuracy1000: 0.3606 - 73s/epoch - 25ms/step
Epoch 2/50
2948/2948 - 70s - loss: 3.1756 - accuracy1000: 0.4390 - val_loss: 3.4404 - val_accuracy1000: 0.3391 - 70s/epoch - 24ms/step
Epoch 3/50
2948/2948 - 69s - loss: 3.1473 - accuracy1000: 0.4498 - val_loss: 3.4858 - val_accuracy1000: 0.3395 - 69s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 69s - loss: 3.1313 - accuracy1000: 0.4551 - val_loss: 3.4893 - val_accuracy1000: 0.3361 - 69s/epoch - 23ms/step
Epoch 5/50
2948/2948 - 68s - loss: 3.1209 - accuracy1000: 0.4564 - val_loss: 3.4649 - val_accuracy1000: 0.3366 - 68s/epoch - 23ms/step
Epoch 6/50
2948/2948 - 69s - loss: 3.1068 - accuracy1000: 0.4631 - val_loss: 3.5274 - val_accuracy1000: 0.3347 - 69s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 68s - loss: 3.0980 - accuracy1000: 0.4660 - val_loss: 3.5454 - val_accuracy1000: 0.3380 - 68s/epoch - 23ms/step
Epoch 8/50
2948/2948 - 70s - loss: 3.0906 - accuracy1000: 0.4698 - val_loss: 3.5551 - val_accuracy1000: 0.3370 - 70s/epoch - 24ms/step
Epoch 9/50
2948/2948 - 68s - loss: 3.0865 - accuracy1000: 0.4721 - val_loss: 3.5227 - val_accuracy1000: 0.3407 - 68s/epoch - 23ms/step
Epoch 10/50
2948/2948 - 68s - loss: 3.0816 - accuracy1000: 0.4717 - val_loss: 3.5650 - val_accuracy1000: 0.3423 - 68s/epoch - 23ms/step
Epoch 11/50
2948/2948 - 71s - loss: 3.0722 - accuracy1000: 0.4759 - val_loss: 3.5884 - val_accuracy1000: 0.3407 - 71s/epoch - 24ms/step
testing model: results/ATVI/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
12066/12066 - 177s - 177s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302787
{'0': {'precision': 0.2986356740390444, 'recall': 0.28803281667834985, 'f1-score': 0.2932384326586885, 'support': 962925}, '1': {'precision': 0.3546806207802543, 'recall': 0.6128631657653456, 'f1-score': 0.4493247563773386, 'support': 1080636}, '2': {'precision': 0.36889858695132527, 'recall': 0.10334924293084825, 'f1-score': 0.1614634828038977, 'support': 1045281}, 'accuracy': 0.33917727096432904, 'macro avg': {'precision': 0.3407382939235413, 'recall': 0.33474840845818127, 'f1-score': 0.3013422239466416, 'support': 3088842}, 'weighted avg': {'precision': 0.3420204360108435, 'recall': 0.33917727096432904, 'f1-score': 0.30325210417664294, 'support': 3088842}}
[[277354 581837 103734]
 [337275 662282  81079]
 [314108 623144 108029]]
Evaluating performance on  train set...
2948/2948 - 49s - 49s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1344889
{'0': {'precision': 0.3373814041745731, 'recall': 0.08807386712635479, 'f1-score': 0.13968323801143862, 'support': 252345}, '1': {'precision': 0.33210201237807097, 'recall': 0.8488925256512078, 'f1-score': 0.47742628265141074, 'support': 249306}, '2': {'precision': 0.32924383166832194, 'recall': 0.06687075556399334, 'f1-score': 0.11116371119921625, 'support': 252831}, 'accuracy': 0.332368432911587, 'macro avg': {'precision': 0.332909082740322, 'recall': 0.3346123827805186, 'f1-score': 0.24275774395402192, 'support': 754482}, 'weighted avg': {'precision': 0.33290997258899946, 'recall': 0.332368432911587, 'f1-score': 0.24172774934975008, 'support': 754482}}
[[ 22225 213083  17037]
 [ 20265 211634  17407]
 [ 23385 212539  16907]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.129739
{'0': {'precision': 0.36799189423911993, 'recall': 0.12978813919850252, 'f1-score': 0.19189593790492007, 'support': 58765}, '1': {'precision': 0.358861786490094, 'recall': 0.8657227641506455, 'f1-score': 0.5073962717979555, 'support': 63354}, '2': {'precision': 0.3600661430343117, 'recall': 0.03095183099092056, 'f1-score': 0.05700355045075999, 'support': 56281}, 'accuracy': 0.35995515695067265, 'macro avg': {'precision': 0.3623066079211752, 'recall': 0.3421542447800228, 'f1-score': 0.25209858671787855, 'support': 178400}, 'weighted avg': {'precision': 0.36224919216574775, 'recall': 0.35995515695067265, 'f1-score': 0.2613820909046498, 'support': 178400}}
[[ 7627 49471  1667]
 [ 7078 54847  1429]
 [ 6021 48518  1742]]
training model: results/ATVI/W1/deepOF_L1/h10
Epoch 1/50
2948/2948 - 67s - loss: 3.0648 - accuracy10: 0.4157 - val_loss: 2.8389 - val_accuracy10: 0.6289 - 67s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 65s - loss: 3.0304 - accuracy10: 0.4176 - val_loss: 2.8286 - val_accuracy10: 0.6447 - 65s/epoch - 22ms/step
Epoch 3/50
2948/2948 - 64s - loss: 3.0070 - accuracy10: 0.4326 - val_loss: 2.8128 - val_accuracy10: 0.6486 - 64s/epoch - 22ms/step
Epoch 4/50
2948/2948 - 65s - loss: 2.9877 - accuracy10: 0.4470 - val_loss: 2.8106 - val_accuracy10: 0.6567 - 65s/epoch - 22ms/step
Epoch 5/50
2948/2948 - 65s - loss: 2.9700 - accuracy10: 0.4575 - val_loss: 2.8102 - val_accuracy10: 0.6589 - 65s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 67s - loss: 2.9569 - accuracy10: 0.4636 - val_loss: 2.7989 - val_accuracy10: 0.6543 - 67s/epoch - 23ms/step
Epoch 7/50
2948/2948 - 65s - loss: 2.9444 - accuracy10: 0.4690 - val_loss: 2.7949 - val_accuracy10: 0.6603 - 65s/epoch - 22ms/step
Epoch 8/50
2948/2948 - 66s - loss: 2.9325 - accuracy10: 0.4738 - val_loss: 2.7955 - val_accuracy10: 0.6627 - 66s/epoch - 22ms/step
Epoch 9/50
2948/2948 - 65s - loss: 2.9220 - accuracy10: 0.4781 - val_loss: 2.7901 - val_accuracy10: 0.6627 - 65s/epoch - 22ms/step
Epoch 10/50
2948/2948 - 66s - loss: 2.9114 - accuracy10: 0.4816 - val_loss: 2.7879 - val_accuracy10: 0.6659 - 66s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 66s - loss: 2.9027 - accuracy10: 0.4847 - val_loss: 2.8028 - val_accuracy10: 0.6701 - 66s/epoch - 22ms/step
Epoch 12/50
2948/2948 - 64s - loss: 2.8942 - accuracy10: 0.4872 - val_loss: 2.7919 - val_accuracy10: 0.6596 - 64s/epoch - 22ms/step
Epoch 13/50
2948/2948 - 63s - loss: 2.8860 - accuracy10: 0.4901 - val_loss: 2.7857 - val_accuracy10: 0.6636 - 63s/epoch - 22ms/step
Epoch 14/50
2948/2948 - 65s - loss: 2.8774 - accuracy10: 0.4929 - val_loss: 2.7874 - val_accuracy10: 0.6621 - 65s/epoch - 22ms/step
Epoch 15/50
2948/2948 - 62s - loss: 2.8712 - accuracy10: 0.4951 - val_loss: 2.7887 - val_accuracy10: 0.6651 - 62s/epoch - 21ms/step
Epoch 16/50
2948/2948 - 64s - loss: 2.8643 - accuracy10: 0.4966 - val_loss: 2.7862 - val_accuracy10: 0.6648 - 64s/epoch - 22ms/step
Epoch 17/50
2948/2948 - 66s - loss: 2.8579 - accuracy10: 0.4983 - val_loss: 2.8069 - val_accuracy10: 0.6658 - 66s/epoch - 22ms/step
Epoch 18/50
2948/2948 - 65s - loss: 2.8515 - accuracy10: 0.5012 - val_loss: 2.8294 - val_accuracy10: 0.6734 - 65s/epoch - 22ms/step
Epoch 19/50
2948/2948 - 65s - loss: 2.8452 - accuracy10: 0.5031 - val_loss: 2.8176 - val_accuracy10: 0.6718 - 65s/epoch - 22ms/step
Epoch 20/50
2948/2948 - 65s - loss: 2.8393 - accuracy10: 0.5057 - val_loss: 2.8288 - val_accuracy10: 0.6729 - 65s/epoch - 22ms/step
Epoch 21/50
2948/2948 - 66s - loss: 2.8354 - accuracy10: 0.5061 - val_loss: 2.8159 - val_accuracy10: 0.6691 - 66s/epoch - 22ms/step
Epoch 22/50
2948/2948 - 66s - loss: 2.8285 - accuracy10: 0.5082 - val_loss: 2.8118 - val_accuracy10: 0.6686 - 66s/epoch - 23ms/step
Epoch 23/50
2948/2948 - 66s - loss: 2.8228 - accuracy10: 0.5108 - val_loss: 2.8286 - val_accuracy10: 0.6694 - 66s/epoch - 22ms/step
testing model: results/ATVI/W1/deepOF_L1/h10
Evaluating performance on  test set...
12066/12066 - 177s - 177s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.90488505
{'0': {'precision': 0.3494853490967189, 'recall': 0.29120712640892016, 'f1-score': 0.3176957062033673, 'support': 528064}, '1': {'precision': 0.6992011444978822, 'recall': 0.7524918691033794, 'f1-score': 0.724868372545533, 'support': 2034216}, '2': {'precision': 0.33859691496236727, 'recall': 0.2955235615517408, 'f1-score': 0.3155973350369627, 'support': 526557}, 'accuracy': 0.5957313383645689, 'macro avg': {'precision': 0.4624278028523228, 'recall': 0.4464075190213468, 'f1-score': 0.45272047126195436, 'support': 3088837}, 'weighted avg': {'precision': 0.5779415885309431, 'recall': 0.5957313383645689, 'f1-score': 0.5854897790565565, 'support': 3088837}}
[[ 153776  333545   40743]
 [ 240265 1530731  263220]
 [  45966  324981  155610]]
Evaluating performance on  train set...
2948/2948 - 47s - 47s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.88512784
{'0': {'precision': 0.3750478732664075, 'recall': 0.2525950475237619, 'f1-score': 0.301876217299312, 'support': 127936}, '1': {'precision': 0.6999354529168723, 'recall': 0.8102425585219134, 'f1-score': 0.7510604549608737, 'support': 500539}, '2': {'precision': 0.3635381863588809, 'recall': 0.2564660132534423, 'f1-score': 0.30075663803292724, 'support': 126005}, 'accuracy': 0.6231974339942742, 'macro avg': {'precision': 0.47950717084738687, 'recall': 0.43976787309970583, 'f1-score': 0.4512311034310376, 'support': 754480}, 'weighted avg': {'precision': 0.5886633781596864, 'recall': 0.6231974339942742, 'f1-score': 0.599688162678142, 'support': 754480}}
[[ 32316  87742   7878]
 [ 46282 405558  48699]
 [  7567  86122  32316]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8526242
{'0': {'precision': 0.3431692873187666, 'recall': 0.26214803837454176, 'f1-score': 0.29723634755693124, 'support': 25642}, '1': {'precision': 0.7563840283218711, 'recall': 0.8169096849511482, 'f1-score': 0.7854826254826255, 'support': 127631}, '2': {'precision': 0.348244944677604, 'recall': 0.2906037330361762, 'f1-score': 0.3168239505369346, 'support': 25127}, 'accuracy': 0.6630437219730941, 'macro avg': {'precision': 0.4825994201060806, 'recall': 0.4565538187872887, 'f1-score': 0.46651430785883047, 'support': 178400}, 'weighted avg': {'precision': 0.6395064322258447, 'recall': 0.6630437219730941, 'f1-score': 0.6492965403709045, 'support': 178400}}
[[  6722  17261   1659]
 [ 11361 104263  12007]
 [  1505  16320   7302]]
training model: results/ATVI/W1/deepOF_L1/h20
Epoch 1/50
2948/2948 - 67s - loss: 3.1009 - accuracy20: 0.4396 - val_loss: 2.9437 - val_accuracy20: 0.5839 - 67s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 65s - loss: 3.0884 - accuracy20: 0.4230 - val_loss: 2.9233 - val_accuracy20: 0.6019 - 65s/epoch - 22ms/step
Epoch 3/50
2948/2948 - 65s - loss: 3.0587 - accuracy20: 0.4459 - val_loss: 2.9207 - val_accuracy20: 0.6060 - 65s/epoch - 22ms/step
Epoch 4/50
2948/2948 - 65s - loss: 3.0397 - accuracy20: 0.4610 - val_loss: 2.9189 - val_accuracy20: 0.6067 - 65s/epoch - 22ms/step
Epoch 5/50
2948/2948 - 65s - loss: 3.0227 - accuracy20: 0.4701 - val_loss: 2.9199 - val_accuracy20: 0.6128 - 65s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 65s - loss: 3.0073 - accuracy20: 0.4762 - val_loss: 2.9214 - val_accuracy20: 0.6134 - 65s/epoch - 22ms/step
Epoch 7/50
2948/2948 - 65s - loss: 2.9947 - accuracy20: 0.4822 - val_loss: 2.9215 - val_accuracy20: 0.6152 - 65s/epoch - 22ms/step
Epoch 8/50
2948/2948 - 64s - loss: 2.9847 - accuracy20: 0.4859 - val_loss: 2.9112 - val_accuracy20: 0.6149 - 64s/epoch - 22ms/step
Epoch 9/50
2948/2948 - 65s - loss: 2.9746 - accuracy20: 0.4896 - val_loss: 2.9183 - val_accuracy20: 0.6170 - 65s/epoch - 22ms/step
Epoch 10/50
2948/2948 - 64s - loss: 2.9652 - accuracy20: 0.4936 - val_loss: 2.9164 - val_accuracy20: 0.6185 - 64s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 65s - loss: 2.9563 - accuracy20: 0.4966 - val_loss: 2.9108 - val_accuracy20: 0.6175 - 65s/epoch - 22ms/step
Epoch 12/50
2948/2948 - 64s - loss: 2.9463 - accuracy20: 0.4999 - val_loss: 2.9116 - val_accuracy20: 0.6182 - 64s/epoch - 22ms/step
Epoch 13/50
2948/2948 - 64s - loss: 2.9378 - accuracy20: 0.5026 - val_loss: 2.9126 - val_accuracy20: 0.6189 - 64s/epoch - 22ms/step
Epoch 14/50
2948/2948 - 65s - loss: 2.9285 - accuracy20: 0.5052 - val_loss: 2.9099 - val_accuracy20: 0.6191 - 65s/epoch - 22ms/step
Epoch 15/50
2948/2948 - 65s - loss: 2.9204 - accuracy20: 0.5082 - val_loss: 2.9108 - val_accuracy20: 0.6193 - 65s/epoch - 22ms/step
Epoch 16/50
2948/2948 - 64s - loss: 2.9130 - accuracy20: 0.5097 - val_loss: 2.9052 - val_accuracy20: 0.6193 - 64s/epoch - 22ms/step
Epoch 17/50
2948/2948 - 64s - loss: 2.9054 - accuracy20: 0.5115 - val_loss: 2.9080 - val_accuracy20: 0.6199 - 64s/epoch - 22ms/step
Epoch 18/50
2948/2948 - 64s - loss: 2.8985 - accuracy20: 0.5133 - val_loss: 2.9091 - val_accuracy20: 0.6202 - 64s/epoch - 22ms/step
Epoch 19/50
2948/2948 - 65s - loss: 2.8923 - accuracy20: 0.5159 - val_loss: 2.9121 - val_accuracy20: 0.6193 - 65s/epoch - 22ms/step
Epoch 20/50
2948/2948 - 66s - loss: 2.8865 - accuracy20: 0.5172 - val_loss: 2.9161 - val_accuracy20: 0.6220 - 66s/epoch - 22ms/step
Epoch 21/50
2948/2948 - 65s - loss: 2.8816 - accuracy20: 0.5183 - val_loss: 2.9193 - val_accuracy20: 0.6223 - 65s/epoch - 22ms/step
Epoch 22/50
2948/2948 - 65s - loss: 2.8761 - accuracy20: 0.5196 - val_loss: 2.9176 - val_accuracy20: 0.6199 - 65s/epoch - 22ms/step
Epoch 23/50
2948/2948 - 69s - loss: 2.8719 - accuracy20: 0.5199 - val_loss: 2.9007 - val_accuracy20: 0.6201 - 69s/epoch - 23ms/step
Epoch 24/50
2948/2948 - 62s - loss: 2.8666 - accuracy20: 0.5220 - val_loss: 2.9186 - val_accuracy20: 0.6224 - 62s/epoch - 21ms/step
Epoch 25/50
2948/2948 - 63s - loss: 2.8628 - accuracy20: 0.5229 - val_loss: 2.9214 - val_accuracy20: 0.6220 - 63s/epoch - 21ms/step
Epoch 26/50
2948/2948 - 63s - loss: 2.8577 - accuracy20: 0.5243 - val_loss: 2.9253 - val_accuracy20: 0.6219 - 63s/epoch - 21ms/step
Epoch 27/50
2948/2948 - 66s - loss: 2.8544 - accuracy20: 0.5247 - val_loss: 2.9239 - val_accuracy20: 0.6212 - 66s/epoch - 22ms/step
Epoch 28/50
2948/2948 - 66s - loss: 2.8493 - accuracy20: 0.5262 - val_loss: 2.9062 - val_accuracy20: 0.6201 - 66s/epoch - 22ms/step
Epoch 29/50
2948/2948 - 66s - loss: 2.8461 - accuracy20: 0.5266 - val_loss: 2.9101 - val_accuracy20: 0.6197 - 66s/epoch - 22ms/step
Epoch 30/50
2948/2948 - 66s - loss: 2.8422 - accuracy20: 0.5272 - val_loss: 2.9054 - val_accuracy20: 0.6176 - 66s/epoch - 23ms/step
Epoch 31/50
2948/2948 - 66s - loss: 2.8380 - accuracy20: 0.5285 - val_loss: 2.9023 - val_accuracy20: 0.6186 - 66s/epoch - 22ms/step
Epoch 32/50
2948/2948 - 65s - loss: 2.8343 - accuracy20: 0.5298 - val_loss: 2.9067 - val_accuracy20: 0.6176 - 65s/epoch - 22ms/step
Epoch 33/50
2948/2948 - 64s - loss: 2.8306 - accuracy20: 0.5303 - val_loss: 2.9097 - val_accuracy20: 0.6185 - 64s/epoch - 22ms/step
testing model: results/ATVI/W1/deepOF_L1/h20
Evaluating performance on  test set...
12066/12066 - 178s - 178s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9446177
{'0': {'precision': 0.4210201309126837, 'recall': 0.24661403059489756, 'f1-score': 0.3110370242634426, 'support': 691161}, '1': {'precision': 0.5914437198326538, 'recall': 0.8196464663004931, 'f1-score': 0.6870925185935797, 'support': 1709936}, '2': {'precision': 0.4620015336203303, 'recall': 0.21112920580451916, 'f1-score': 0.28981596341024063, 'support': 687740}, 'accuracy': 0.5559357777700799, 'macro avg': {'precision': 0.49148846145522257, 'recall': 0.4257965675666366, 'f1-score': 0.4293151687557543, 'support': 3088837}, 'weighted avg': {'precision': 0.5244888409293064, 'recall': 0.5559357777700799, 'f1-score': 0.5144910282661517, 'support': 3088837}}
[[ 170450  483683   37028]
 [ 176334 1401543  132059]
 [  58066  484472  145202]]
Evaluating performance on  train set...
2948/2948 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.933689
{'0': {'precision': 0.4778450665370519, 'recall': 0.21310687859205923, 'f1-score': 0.294758763755409, 'support': 170689}, '1': {'precision': 0.5871855736077735, 'recall': 0.8657215409240249, 'f1-score': 0.6997545741331058, 'support': 415465}, '2': {'precision': 0.4913163052892286, 'recall': 0.19209747751387188, 'f1-score': 0.27620345179572814, 'support': 168326}, 'accuracy': 0.5677910613932775, 'macro avg': {'precision': 0.5187823151446846, 'recall': 0.4236419656766521, 'f1-score': 0.423572263228081, 'support': 754480}, 'weighted avg': {'precision': 0.541060411548631, 'recall': 0.5677910613932775, 'f1-score': 0.5136356629676406, 'support': 754480}}
[[ 36375 126466   7848]
 [ 30158 359677  25630]
 [  9590 126401  32335]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8834862
{'0': {'precision': 0.43970633221168554, 'recall': 0.20851224324010675, 'f1-score': 0.2828803652608584, 'support': 34468}, '1': {'precision': 0.656386464741428, 'recall': 0.8747548663567694, 'f1-score': 0.7499990269761142, 'support': 110144}, '2': {'precision': 0.4722949960702122, 'recall': 0.21341896531312893, 'f1-score': 0.2939905414220482, 'support': 33788}, 'accuracy': 0.6207791479820628, 'macro avg': {'precision': 0.5227959310077752, 'recall': 0.4322286916366684, 'f1-score': 0.4422899778863403, 'support': 178400}, 'weighted avg': {'precision': 0.5796565692733887, 'recall': 0.6207791479820628, 'f1-score': 0.5733832156425815, 'support': 178400}}
[[ 7187 25753  1528]
 [ 7266 96349  6529]
 [ 1892 24685  7211]]
training model: results/ATVI/W1/deepOF_L1/h30
Epoch 1/50
2948/2948 - 67s - loss: 3.1381 - accuracy30: 0.4427 - val_loss: 3.0291 - val_accuracy30: 0.5391 - 67s/epoch - 23ms/step
Epoch 2/50
2948/2948 - 64s - loss: 3.1180 - accuracy30: 0.4425 - val_loss: 3.0221 - val_accuracy30: 0.5451 - 64s/epoch - 22ms/step
Epoch 3/50
2948/2948 - 66s - loss: 3.0956 - accuracy30: 0.4556 - val_loss: 3.0182 - val_accuracy30: 0.5527 - 66s/epoch - 23ms/step
Epoch 4/50
2948/2948 - 64s - loss: 3.0759 - accuracy30: 0.4660 - val_loss: 3.0151 - val_accuracy30: 0.5560 - 64s/epoch - 22ms/step
Epoch 5/50
2948/2948 - 64s - loss: 3.0607 - accuracy30: 0.4727 - val_loss: 3.0082 - val_accuracy30: 0.5587 - 64s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 65s - loss: 3.0465 - accuracy30: 0.4785 - val_loss: 3.0092 - val_accuracy30: 0.5598 - 65s/epoch - 22ms/step
Epoch 7/50
2948/2948 - 63s - loss: 3.0327 - accuracy30: 0.4836 - val_loss: 3.0137 - val_accuracy30: 0.5601 - 63s/epoch - 22ms/step
Epoch 8/50
2948/2948 - 64s - loss: 3.0213 - accuracy30: 0.4873 - val_loss: 3.0137 - val_accuracy30: 0.5608 - 64s/epoch - 22ms/step
Epoch 9/50
2948/2948 - 63s - loss: 3.0125 - accuracy30: 0.4903 - val_loss: 3.0112 - val_accuracy30: 0.5615 - 63s/epoch - 22ms/step
Epoch 10/50
2948/2948 - 64s - loss: 3.0034 - accuracy30: 0.4936 - val_loss: 3.0066 - val_accuracy30: 0.5605 - 64s/epoch - 22ms/step
Epoch 11/50
2948/2948 - 63s - loss: 2.9955 - accuracy30: 0.4952 - val_loss: 3.0083 - val_accuracy30: 0.5608 - 63s/epoch - 21ms/step
Epoch 12/50
2948/2948 - 64s - loss: 2.9869 - accuracy30: 0.4981 - val_loss: 3.0077 - val_accuracy30: 0.5615 - 64s/epoch - 22ms/step
Epoch 13/50
2948/2948 - 65s - loss: 2.9794 - accuracy30: 0.5005 - val_loss: 3.0136 - val_accuracy30: 0.5630 - 65s/epoch - 22ms/step
Epoch 14/50
2948/2948 - 63s - loss: 2.9720 - accuracy30: 0.5027 - val_loss: 3.0075 - val_accuracy30: 0.5618 - 63s/epoch - 21ms/step
Epoch 15/50
2948/2948 - 61s - loss: 2.9651 - accuracy30: 0.5049 - val_loss: 3.0056 - val_accuracy30: 0.5626 - 61s/epoch - 21ms/step
Epoch 16/50
2948/2948 - 63s - loss: 2.9577 - accuracy30: 0.5068 - val_loss: 3.0062 - val_accuracy30: 0.5613 - 63s/epoch - 21ms/step
Epoch 17/50
2948/2948 - 62s - loss: 2.9516 - accuracy30: 0.5088 - val_loss: 3.0091 - val_accuracy30: 0.5621 - 62s/epoch - 21ms/step
Epoch 18/50
2948/2948 - 63s - loss: 2.9465 - accuracy30: 0.5103 - val_loss: 3.0130 - val_accuracy30: 0.5628 - 63s/epoch - 21ms/step
Epoch 19/50
2948/2948 - 64s - loss: 2.9406 - accuracy30: 0.5123 - val_loss: 3.0150 - val_accuracy30: 0.5631 - 64s/epoch - 22ms/step
Epoch 20/50
2948/2948 - 64s - loss: 2.9335 - accuracy30: 0.5141 - val_loss: 3.0095 - val_accuracy30: 0.5622 - 64s/epoch - 22ms/step
Epoch 21/50
2948/2948 - 64s - loss: 2.9294 - accuracy30: 0.5148 - val_loss: 3.0047 - val_accuracy30: 0.5633 - 64s/epoch - 22ms/step
Epoch 22/50
2948/2948 - 63s - loss: 2.9245 - accuracy30: 0.5162 - val_loss: 3.0052 - val_accuracy30: 0.5626 - 63s/epoch - 21ms/step
Epoch 23/50
2948/2948 - 65s - loss: 2.9196 - accuracy30: 0.5181 - val_loss: 3.0042 - val_accuracy30: 0.5610 - 65s/epoch - 22ms/step
Epoch 24/50
2948/2948 - 64s - loss: 2.9144 - accuracy30: 0.5195 - val_loss: 3.0111 - val_accuracy30: 0.5633 - 64s/epoch - 22ms/step
Epoch 25/50
2948/2948 - 64s - loss: 2.9104 - accuracy30: 0.5203 - val_loss: 3.0080 - val_accuracy30: 0.5624 - 64s/epoch - 22ms/step
Epoch 26/50
2948/2948 - 64s - loss: 2.9065 - accuracy30: 0.5214 - val_loss: 3.0047 - val_accuracy30: 0.5626 - 64s/epoch - 22ms/step
Epoch 27/50
2948/2948 - 64s - loss: 2.9014 - accuracy30: 0.5218 - val_loss: 2.9980 - val_accuracy30: 0.5623 - 64s/epoch - 22ms/step
Epoch 28/50
2948/2948 - 65s - loss: 2.8985 - accuracy30: 0.5233 - val_loss: 3.0134 - val_accuracy30: 0.5650 - 65s/epoch - 22ms/step
Epoch 29/50
2948/2948 - 64s - loss: 2.8944 - accuracy30: 0.5240 - val_loss: 2.9896 - val_accuracy30: 0.5638 - 64s/epoch - 22ms/step
Epoch 30/50
2948/2948 - 63s - loss: 2.8905 - accuracy30: 0.5251 - val_loss: 3.0011 - val_accuracy30: 0.5621 - 63s/epoch - 22ms/step
Epoch 31/50
2948/2948 - 64s - loss: 2.8864 - accuracy30: 0.5260 - val_loss: 3.0072 - val_accuracy30: 0.5632 - 64s/epoch - 22ms/step
Epoch 32/50
2948/2948 - 66s - loss: 2.8824 - accuracy30: 0.5269 - val_loss: 3.0061 - val_accuracy30: 0.5619 - 66s/epoch - 22ms/step
Epoch 33/50
2948/2948 - 64s - loss: 2.8793 - accuracy30: 0.5277 - val_loss: 3.0125 - val_accuracy30: 0.5634 - 64s/epoch - 22ms/step
Epoch 34/50
2948/2948 - 62s - loss: 2.8749 - accuracy30: 0.5289 - val_loss: 2.9972 - val_accuracy30: 0.5598 - 62s/epoch - 21ms/step
Epoch 35/50
2948/2948 - 63s - loss: 2.8720 - accuracy30: 0.5294 - val_loss: 3.0159 - val_accuracy30: 0.5637 - 63s/epoch - 21ms/step
Epoch 36/50
2948/2948 - 62s - loss: 2.8679 - accuracy30: 0.5303 - val_loss: 2.9907 - val_accuracy30: 0.5614 - 62s/epoch - 21ms/step
Epoch 37/50
2948/2948 - 64s - loss: 2.8650 - accuracy30: 0.5312 - val_loss: 2.9980 - val_accuracy30: 0.5628 - 64s/epoch - 22ms/step
Epoch 38/50
2948/2948 - 63s - loss: 2.8619 - accuracy30: 0.5315 - val_loss: 3.0055 - val_accuracy30: 0.5604 - 63s/epoch - 21ms/step
Epoch 39/50
2948/2948 - 64s - loss: 2.8598 - accuracy30: 0.5315 - val_loss: 2.9931 - val_accuracy30: 0.5615 - 64s/epoch - 22ms/step
testing model: results/ATVI/W1/deepOF_L1/h30
Evaluating performance on  test set...
12066/12066 - 198s - 198s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9999486
{'0': {'precision': 0.46638233933291495, 'recall': 0.25174794049027643, 'f1-score': 0.32699023201474225, 'support': 808809}, '1': {'precision': 0.5161509127706392, 'recall': 0.823032694513914, 'f1-score': 0.6344299231302805, 'support': 1477465}, '2': {'precision': 0.49868228799346714, 'recall': 0.18413881527057688, 'f1-score': 0.26896288140066066, 'support': 802563}, 'accuracy': 0.5074405026875811, 'macro avg': {'precision': 0.49373851336567376, 'recall': 0.4196398167582558, 'f1-score': 0.4101276788485611, 'support': 3088837}, 'weighted avg': {'precision': 0.49858024069547496, 'recall': 0.5074405026875811, 'f1-score': 0.458968960138994, 'support': 3088837}}
[[ 203616  563497   41696]
 [ 154595 1216002  106868]
 [  78375  576405  147783]]
Evaluating performance on  train set...
2948/2948 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9945411
{'0': {'precision': 0.5105532405054715, 'recall': 0.22672450540357564, 'f1-score': 0.31400630651905154, 'support': 199405}, '1': {'precision': 0.5106884220382711, 'recall': 0.8596929079282744, 'f1-score': 0.6407489725478106, 'support': 357808}, '2': {'precision': 0.5275886469062033, 'recall': 0.17008420060121562, 'f1-score': 0.2572394599443384, 'support': 197267}, 'accuracy': 0.512097073481073, 'macro avg': {'precision': 0.5162767698166486, 'recall': 0.41883387131102184, 'f1-score': 0.4039982463370668, 'support': 754480}, 'weighted avg': {'precision': 0.5150714418472447, 'recall': 0.512097073481073, 'f1-score': 0.45411991366988963, 'support': 754480}}
[[ 45210 145173   9022]
 [ 29182 307605  21021]
 [ 14159 149556  33552]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9453884
{'0': {'precision': 0.4578788925627992, 'recall': 0.22674617527738403, 'f1-score': 0.3032967751426096, 'support': 40918}, '1': {'precision': 0.5853144225148234, 'recall': 0.8629782780451267, 'f1-score': 0.6975297635091707, 'support': 97459}, '2': {'precision': 0.504257528556594, 'recall': 0.18199535267221348, 'f1-score': 0.2674597929059264, 'support': 40023}, 'accuracy': 0.5642769058295964, 'macro avg': {'precision': 0.5158169478780722, 'recall': 0.42390660199824143, 'f1-score': 0.42276211051923557, 'support': 178400}, 'weighted avg': {'precision': 0.5379010420133259, 'recall': 0.5642769058295964, 'f1-score': 0.5106244055975305, 'support': 178400}}
[[ 9278 29854  1786]
 [ 7979 84105  5375]
 [ 3006 29733  7284]]
training model: results/ATVI/W1/deepOF_L1/h50
Epoch 1/50
2948/2948 - 65s - loss: 3.1814 - accuracy50: 0.4378 - val_loss: 3.1615 - val_accuracy50: 0.4518 - 65s/epoch - 22ms/step
Epoch 2/50
2948/2948 - 62s - loss: 3.1760 - accuracy50: 0.4372 - val_loss: 3.1480 - val_accuracy50: 0.4586 - 62s/epoch - 21ms/step
Epoch 3/50
2948/2948 - 62s - loss: 3.1548 - accuracy50: 0.4479 - val_loss: 3.1416 - val_accuracy50: 0.4616 - 62s/epoch - 21ms/step
Epoch 4/50
2948/2948 - 61s - loss: 3.1410 - accuracy50: 0.4537 - val_loss: 3.1504 - val_accuracy50: 0.4652 - 61s/epoch - 21ms/step
Epoch 5/50
2948/2948 - 61s - loss: 3.1229 - accuracy50: 0.4618 - val_loss: 3.1555 - val_accuracy50: 0.4655 - 61s/epoch - 21ms/step
Epoch 6/50
2948/2948 - 61s - loss: 3.1106 - accuracy50: 0.4668 - val_loss: 3.1610 - val_accuracy50: 0.4672 - 61s/epoch - 21ms/step
Epoch 7/50
2948/2948 - 62s - loss: 3.0984 - accuracy50: 0.4707 - val_loss: 3.1682 - val_accuracy50: 0.4678 - 62s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 62s - loss: 3.0890 - accuracy50: 0.4737 - val_loss: 3.1657 - val_accuracy50: 0.4678 - 62s/epoch - 21ms/step
Epoch 9/50
2948/2948 - 61s - loss: 3.0810 - accuracy50: 0.4757 - val_loss: 3.1646 - val_accuracy50: 0.4687 - 61s/epoch - 21ms/step
Epoch 10/50
2948/2948 - 59s - loss: 3.0746 - accuracy50: 0.4781 - val_loss: 3.1735 - val_accuracy50: 0.4675 - 59s/epoch - 20ms/step
Epoch 11/50
2948/2948 - 60s - loss: 3.0676 - accuracy50: 0.4800 - val_loss: 3.1681 - val_accuracy50: 0.4682 - 60s/epoch - 20ms/step
Epoch 12/50
2948/2948 - 62s - loss: 3.0617 - accuracy50: 0.4816 - val_loss: 3.1677 - val_accuracy50: 0.4699 - 62s/epoch - 21ms/step
Epoch 13/50
2948/2948 - 61s - loss: 3.0562 - accuracy50: 0.4835 - val_loss: 3.1636 - val_accuracy50: 0.4706 - 61s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h50
Evaluating performance on  test set...
12066/12066 - 175s - 175s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777854
{'0': {'precision': 0.444728214197923, 'recall': 0.14373266640253565, 'f1-score': 0.21725138971304345, 'support': 969216}, '1': {'precision': 0.38359262219663004, 'recall': 0.8229923507427227, 'f1-score': 0.523284809523378, 'support': 1157498}, '2': {'precision': 0.4796765218224566, 'recall': 0.14567887889594158, 'f1-score': 0.22348487868346403, 'support': 962123}, 'accuracy': 0.39888184452594944, 'macro avg': {'precision': 0.4359991194056699, 'recall': 0.37080129868039996, 'f1-score': 0.32134035930662846, 'support': 3088837}, 'weighted avg': {'precision': 0.43270435055808915, 'recall': 0.39888184452594944, 'f1-score': 0.3338747189700779, 'support': 3088837}}
[[139308 777177  52731]
 [105579 952612  99307]
 [ 68356 753606 140161]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0747962
{'0': {'precision': 0.4968869112295407, 'recall': 0.1212496159657252, 'f1-score': 0.1949321695591867, 'support': 237609}, '1': {'precision': 0.3814929610194667, 'recall': 0.8668533813796672, 'f1-score': 0.5298184518195705, 'support': 280285}, '2': {'precision': 0.49928711609104787, 'recall': 0.12581471431107505, 'f1-score': 0.20098378476922918, 'support': 236586}, 'accuracy': 0.3996686459548298, 'macro avg': {'precision': 0.4592223294466851, 'recall': 0.3713059038854891, 'f1-score': 0.30857813538266216, 'support': 754480}, 'weighted avg': {'precision': 0.4547713634784193, 'recall': 0.3996686459548298, 'f1-score': 0.3212381406378565, 'support': 754480}}
[[ 28810 197549  11250]
 [ 18718 242966  18601]
 [ 10453 196367  29766]]
Evaluating performance on  val set...
697/697 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0453326
{'0': {'precision': 0.45466437740168425, 'recall': 0.11101129875833433, 'f1-score': 0.17845166466105095, 'support': 50094}, '1': {'precision': 0.46078571987378414, 'recall': 0.8881614496286708, 'f1-score': 0.6067726330338631, 'support': 79579}, '2': {'precision': 0.48556450981926297, 'recall': 0.12736265314917808, 'f1-score': 0.20179488846979254, 'support': 48727}, 'accuracy': 0.46214125560538116, 'macro avg': {'precision': 0.4670048690315771, 'recall': 0.37551180051206107, 'f1-score': 0.3290063953882355, 'support': 178400}, 'weighted avg': {'precision': 0.4658347869582907, 'recall': 0.46214125560538116, 'f1-score': 0.3758888821984308, 'support': 178400}}
[[ 5561 42392  2141]
 [ 4466 70679  4434]
 [ 2204 40317  6206]]
training model: results/ATVI/W1/deepOF_L1/h100
Epoch 1/50
2948/2948 - 62s - loss: 3.2422 - accuracy100: 0.4078 - val_loss: 3.2738 - val_accuracy100: 0.3881 - 62s/epoch - 21ms/step
Epoch 2/50
2948/2948 - 60s - loss: 3.2293 - accuracy100: 0.4150 - val_loss: 3.2631 - val_accuracy100: 0.3882 - 60s/epoch - 20ms/step
Epoch 3/50
2948/2948 - 60s - loss: 3.2239 - accuracy100: 0.4181 - val_loss: 3.2631 - val_accuracy100: 0.3895 - 60s/epoch - 20ms/step
Epoch 4/50
2948/2948 - 60s - loss: 3.2166 - accuracy100: 0.4211 - val_loss: 3.2642 - val_accuracy100: 0.3901 - 60s/epoch - 20ms/step
Epoch 5/50
2948/2948 - 61s - loss: 3.2105 - accuracy100: 0.4240 - val_loss: 3.2650 - val_accuracy100: 0.3914 - 61s/epoch - 21ms/step
Epoch 6/50
2948/2948 - 60s - loss: 3.2053 - accuracy100: 0.4262 - val_loss: 3.2681 - val_accuracy100: 0.3927 - 60s/epoch - 20ms/step
Epoch 7/50
2948/2948 - 59s - loss: 3.2009 - accuracy100: 0.4282 - val_loss: 3.2678 - val_accuracy100: 0.3935 - 59s/epoch - 20ms/step
Epoch 8/50
2948/2948 - 59s - loss: 3.1973 - accuracy100: 0.4299 - val_loss: 3.2671 - val_accuracy100: 0.3936 - 59s/epoch - 20ms/step
Epoch 9/50
2948/2948 - 61s - loss: 3.1936 - accuracy100: 0.4308 - val_loss: 3.2657 - val_accuracy100: 0.3944 - 61s/epoch - 21ms/step
Epoch 10/50
2948/2948 - 59s - loss: 3.1904 - accuracy100: 0.4322 - val_loss: 3.2650 - val_accuracy100: 0.3948 - 59s/epoch - 20ms/step
Epoch 11/50
2948/2948 - 60s - loss: 3.1879 - accuracy100: 0.4333 - val_loss: 3.2642 - val_accuracy100: 0.3952 - 60s/epoch - 20ms/step
Epoch 12/50
2948/2948 - 59s - loss: 3.1851 - accuracy100: 0.4341 - val_loss: 3.2699 - val_accuracy100: 0.3948 - 59s/epoch - 20ms/step
Epoch 13/50
2948/2948 - 61s - loss: 3.1824 - accuracy100: 0.4350 - val_loss: 3.2674 - val_accuracy100: 0.3957 - 61s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h100
Evaluating performance on  test set...
12066/12066 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1103988
{'0': {'precision': 0.4174017103210886, 'recall': 0.06229356214908074, 'f1-score': 0.10840815357268827, 'support': 996668}, '1': {'precision': 0.34834036951149416, 'recall': 0.933920101132143, 'f1-score': 0.5074196398790732, 'support': 1072656}, '2': {'precision': 0.47772485289997196, 'recall': 0.030102607813730673, 'f1-score': 0.05663641690234417, 'support': 1019513}, 'accuracy': 0.3543569958531318, 'macro avg': {'precision': 0.41448897757751824, 'recall': 0.34210542369831815, 'f1-score': 0.22415473678470188, 'support': 3088837}, 'weighted avg': {'precision': 0.4133293576759243, 'recall': 0.3543569958531318, 'f1-score': 0.2298843293266918, 'support': 3088837}}
[[  62086  921429   13153]
 [  50482 1001775   20399]
 [  36176  952647   30690]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1156547
{'0': {'precision': 0.46803563123814973, 'recall': 0.051844043859197234, 'f1-score': 0.09334798398892637, 'support': 252353}, '1': {'precision': 0.3314491364640992, 'recall': 0.9520797800830708, 'f1-score': 0.4917162626960826, 'support': 249185}, '2': {'precision': 0.48423109126430364, 'recall': 0.02057783997912565, 'f1-score': 0.03947802541611204, 'support': 252942}, 'accuracy': 0.3386862474817093, 'macro avg': {'precision': 0.42790528632218416, 'recall': 0.3415005546404646, 'f1-score': 0.20818075736704034, 'support': 754480}, 'weighted avg': {'precision': 0.42835426970393226, 'recall': 0.3386862474817093, 'f1-score': 0.20685851371578187, 'support': 754480}}
[[ 13083 236922   2348]
 [  8745 237244   3196]
 [  6125 241612   5205]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0884877
{'0': {'precision': 0.43833167825223435, 'recall': 0.0397879896879338, 'f1-score': 0.07295385429062541, 'support': 55469}, '1': {'precision': 0.38597577357520824, 'recall': 0.9646042241391893, 'f1-score': 0.5513392205365225, 'support': 68511}, '2': {'precision': 0.4988355845365626, 'recall': 0.01968026460859978, 'f1-score': 0.037866600668234135, 'support': 54420}, 'accuracy': 0.3888116591928251, 'macro avg': {'precision': 0.4410476787880017, 'recall': 0.34135749281190764, 'f1-score': 0.220719891831794, 'support': 178400}, 'weighted avg': {'precision': 0.43668183068869965, 'recall': 0.3888116591928251, 'f1-score': 0.2459651294293144, 'support': 178400}}
[[ 2207 52860   402]
 [ 1751 66086   674]
 [ 1077 52272  1071]]
training model: results/ATVI/W1/deepOF_L1/h200
Epoch 1/50
2948/2948 - 63s - loss: 3.2797 - accuracy200: 0.3772 - val_loss: 3.3464 - val_accuracy200: 0.3482 - 63s/epoch - 21ms/step
Epoch 2/50
2948/2948 - 60s - loss: 3.2667 - accuracy200: 0.3839 - val_loss: 3.3321 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 3/50
2948/2948 - 60s - loss: 3.2635 - accuracy200: 0.3864 - val_loss: 3.3294 - val_accuracy200: 0.3486 - 60s/epoch - 20ms/step
Epoch 4/50
2948/2948 - 58s - loss: 3.2612 - accuracy200: 0.3873 - val_loss: 3.3281 - val_accuracy200: 0.3487 - 58s/epoch - 20ms/step
Epoch 5/50
2948/2948 - 60s - loss: 3.2590 - accuracy200: 0.3895 - val_loss: 3.3268 - val_accuracy200: 0.3486 - 60s/epoch - 20ms/step
Epoch 6/50
2948/2948 - 60s - loss: 3.2571 - accuracy200: 0.3905 - val_loss: 3.3260 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 7/50
2948/2948 - 61s - loss: 3.2556 - accuracy200: 0.3918 - val_loss: 3.3250 - val_accuracy200: 0.3487 - 61s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 60s - loss: 3.2541 - accuracy200: 0.3924 - val_loss: 3.3249 - val_accuracy200: 0.3486 - 60s/epoch - 21ms/step
Epoch 9/50
2948/2948 - 60s - loss: 3.2531 - accuracy200: 0.3930 - val_loss: 3.3223 - val_accuracy200: 0.3486 - 60s/epoch - 20ms/step
Epoch 10/50
2948/2948 - 61s - loss: 3.2521 - accuracy200: 0.3933 - val_loss: 3.3233 - val_accuracy200: 0.3486 - 61s/epoch - 21ms/step
Epoch 11/50
2948/2948 - 61s - loss: 3.2512 - accuracy200: 0.3943 - val_loss: 3.3224 - val_accuracy200: 0.3487 - 61s/epoch - 21ms/step
Epoch 12/50
2948/2948 - 60s - loss: 3.2503 - accuracy200: 0.3944 - val_loss: 3.3238 - val_accuracy200: 0.3489 - 60s/epoch - 20ms/step
Epoch 13/50
2948/2948 - 60s - loss: 3.2489 - accuracy200: 0.3956 - val_loss: 3.3248 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 14/50
2948/2948 - 61s - loss: 3.2480 - accuracy200: 0.3955 - val_loss: 3.3247 - val_accuracy200: 0.3484 - 61s/epoch - 21ms/step
Epoch 15/50
2948/2948 - 60s - loss: 3.2472 - accuracy200: 0.3962 - val_loss: 3.3211 - val_accuracy200: 0.3488 - 60s/epoch - 20ms/step
Epoch 16/50
2948/2948 - 60s - loss: 3.2461 - accuracy200: 0.3970 - val_loss: 3.3232 - val_accuracy200: 0.3488 - 60s/epoch - 20ms/step
Epoch 17/50
2948/2948 - 60s - loss: 3.2450 - accuracy200: 0.3971 - val_loss: 3.3230 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 18/50
2948/2948 - 59s - loss: 3.2440 - accuracy200: 0.3976 - val_loss: 3.3243 - val_accuracy200: 0.3486 - 59s/epoch - 20ms/step
Epoch 19/50
2948/2948 - 60s - loss: 3.2431 - accuracy200: 0.3982 - val_loss: 3.3234 - val_accuracy200: 0.3488 - 60s/epoch - 20ms/step
Epoch 20/50
2948/2948 - 60s - loss: 3.2423 - accuracy200: 0.3983 - val_loss: 3.3233 - val_accuracy200: 0.3490 - 60s/epoch - 20ms/step
Epoch 21/50
2948/2948 - 61s - loss: 3.2410 - accuracy200: 0.3992 - val_loss: 3.3241 - val_accuracy200: 0.3488 - 61s/epoch - 21ms/step
Epoch 22/50
2948/2948 - 60s - loss: 3.2399 - accuracy200: 0.3998 - val_loss: 3.3248 - val_accuracy200: 0.3484 - 60s/epoch - 20ms/step
Epoch 23/50
2948/2948 - 60s - loss: 3.2384 - accuracy200: 0.4004 - val_loss: 3.3263 - val_accuracy200: 0.3486 - 60s/epoch - 20ms/step
Epoch 24/50
2948/2948 - 60s - loss: 3.2376 - accuracy200: 0.4007 - val_loss: 3.3218 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 25/50
2948/2948 - 62s - loss: 3.2360 - accuracy200: 0.4023 - val_loss: 3.3210 - val_accuracy200: 0.3487 - 62s/epoch - 21ms/step
Epoch 26/50
2948/2948 - 60s - loss: 3.2353 - accuracy200: 0.4020 - val_loss: 3.3168 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 27/50
2948/2948 - 59s - loss: 3.2341 - accuracy200: 0.4033 - val_loss: 3.3236 - val_accuracy200: 0.3489 - 59s/epoch - 20ms/step
Epoch 28/50
2948/2948 - 60s - loss: 3.2326 - accuracy200: 0.4042 - val_loss: 3.3204 - val_accuracy200: 0.3487 - 60s/epoch - 20ms/step
Epoch 29/50
2948/2948 - 60s - loss: 3.2313 - accuracy200: 0.4046 - val_loss: 3.3192 - val_accuracy200: 0.3489 - 60s/epoch - 20ms/step
Epoch 30/50
2948/2948 - 60s - loss: 3.2297 - accuracy200: 0.4056 - val_loss: 3.3213 - val_accuracy200: 0.3490 - 60s/epoch - 20ms/step
Epoch 31/50
2948/2948 - 60s - loss: 3.2282 - accuracy200: 0.4066 - val_loss: 3.3311 - val_accuracy200: 0.3491 - 60s/epoch - 20ms/step
Epoch 32/50
2948/2948 - 61s - loss: 3.2268 - accuracy200: 0.4069 - val_loss: 3.3356 - val_accuracy200: 0.3487 - 61s/epoch - 21ms/step
Epoch 33/50
2948/2948 - 61s - loss: 3.2257 - accuracy200: 0.4075 - val_loss: 3.3322 - val_accuracy200: 0.3491 - 61s/epoch - 21ms/step
Epoch 34/50
2948/2948 - 61s - loss: 3.2249 - accuracy200: 0.4077 - val_loss: 3.3336 - val_accuracy200: 0.3491 - 61s/epoch - 21ms/step
Epoch 35/50
2948/2948 - 60s - loss: 3.2230 - accuracy200: 0.4088 - val_loss: 3.3387 - val_accuracy200: 0.3491 - 60s/epoch - 21ms/step
Epoch 36/50
2948/2948 - 61s - loss: 3.2220 - accuracy200: 0.4093 - val_loss: 3.3456 - val_accuracy200: 0.3489 - 61s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h200
Evaluating performance on  test set...
12066/12066 - 168s - 168s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1142881
{'0': {'precision': 0.36349393628749926, 'recall': 0.0187126665226184, 'f1-score': 0.035593005263287486, 'support': 1004293}, '1': {'precision': 0.3373383559078502, 'recall': 0.9735427922067984, 'f1-score': 0.5010573619146386, 'support': 1045424}, '2': {'precision': 0.37504355183913196, 'recall': 0.0072513280468088385, 'f1-score': 0.014227571277110983, 'support': 1039120}, 'accuracy': 0.33802139769758005, 'macro avg': {'precision': 0.35862528134482713, 'recall': 0.33316892892540856, 'f1-score': 0.18362597948501233, 'support': 3088837}, 'weighted avg': {'precision': 0.358526942253563, 'recall': 0.33802139769758005, 'f1-score': 0.18594291360230517, 'support': 3088837}}
[[  18793  980868    4632]
 [  19735 1017765    7924]
 [  13173 1018412    7535]]
Evaluating performance on  train set...
2948/2948 - 43s - 43s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1118966
{'0': {'precision': 0.4318798449612403, 'recall': 0.017698447365286106, 'f1-score': 0.034003433148960524, 'support': 251830}, '1': {'precision': 0.33127336527431, 'recall': 0.981690563321135, 'f1-score': 0.4953798493418165, 'support': 250035}, '2': {'precision': 0.41806853582554515, 'recall': 0.005312431961680819, 'f1-score': 0.010491546955926903, 'support': 252615}, 'accuracy': 0.33301876789311846, 'macro avg': {'precision': 0.39374058202036516, 'recall': 0.3349004808827007, 'f1-score': 0.17995827648223464, 'support': 754480}, 'weighted avg': {'precision': 0.39391451121371185, 'recall': 0.33301876789311846, 'f1-score': 0.17903152811784978, 'support': 754480}}
[[  4457 246607    766]
 [  3476 245457   1102]
 [  2387 248886   1342]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064144
{'0': {'precision': 0.39768864717878993, 'recall': 0.009929728078215704, 'f1-score': 0.0193756727664155, 'support': 58914}, '1': {'precision': 0.34825811425138026, 'recall': 0.9875271236839991, 'f1-score': 0.514924591318049, 'support': 62215}, '2': {'precision': 0.3385518590998043, 'recall': 0.0030207260218958983, 'f1-score': 0.005988023952095808, 'support': 57271}, 'accuracy': 0.34863789237668164, 'macro avg': {'precision': 0.36149954017665814, 'recall': 0.33349252592803685, 'f1-score': 0.1800960960121868, 'support': 178400}, 'weighted avg': {'precision': 0.3614658691734627, 'recall': 0.34863789237668164, 'f1-score': 0.1878950221635286, 'support': 178400}}
[[  585 58200   129]
 [  567 61439   209]
 [  319 56779   173]]
training model: results/ATVI/W1/deepOF_L1/h300
Epoch 1/50
2948/2948 - 64s - loss: 3.2899 - accuracy300: 0.3685 - val_loss: 3.3815 - val_accuracy300: 0.3258 - 64s/epoch - 22ms/step
Epoch 2/50
2948/2948 - 62s - loss: 3.2773 - accuracy300: 0.3735 - val_loss: 3.3552 - val_accuracy300: 0.3257 - 62s/epoch - 21ms/step
Epoch 3/50
2948/2948 - 63s - loss: 3.2744 - accuracy300: 0.3750 - val_loss: 3.3389 - val_accuracy300: 0.3260 - 63s/epoch - 21ms/step
Epoch 4/50
2948/2948 - 60s - loss: 3.2723 - accuracy300: 0.3775 - val_loss: 3.3388 - val_accuracy300: 0.3258 - 60s/epoch - 21ms/step
Epoch 5/50
2948/2948 - 62s - loss: 3.2705 - accuracy300: 0.3787 - val_loss: 3.3417 - val_accuracy300: 0.3259 - 62s/epoch - 21ms/step
Epoch 6/50
2948/2948 - 62s - loss: 3.2694 - accuracy300: 0.3798 - val_loss: 3.3430 - val_accuracy300: 0.3258 - 62s/epoch - 21ms/step
Epoch 7/50
2948/2948 - 61s - loss: 3.2682 - accuracy300: 0.3806 - val_loss: 3.3404 - val_accuracy300: 0.3258 - 61s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 60s - loss: 3.2674 - accuracy300: 0.3813 - val_loss: 3.3399 - val_accuracy300: 0.3259 - 60s/epoch - 21ms/step
Epoch 9/50
2948/2948 - 60s - loss: 3.2668 - accuracy300: 0.3819 - val_loss: 3.3389 - val_accuracy300: 0.3260 - 60s/epoch - 20ms/step
Epoch 10/50
2948/2948 - 59s - loss: 3.2660 - accuracy300: 0.3828 - val_loss: 3.3341 - val_accuracy300: 0.3257 - 59s/epoch - 20ms/step
Epoch 11/50
2948/2948 - 61s - loss: 3.2654 - accuracy300: 0.3826 - val_loss: 3.3437 - val_accuracy300: 0.3258 - 61s/epoch - 21ms/step
Epoch 12/50
2948/2948 - 62s - loss: 3.2647 - accuracy300: 0.3830 - val_loss: 3.3451 - val_accuracy300: 0.3259 - 62s/epoch - 21ms/step
Epoch 13/50
2948/2948 - 60s - loss: 3.2639 - accuracy300: 0.3839 - val_loss: 3.3372 - val_accuracy300: 0.3260 - 60s/epoch - 20ms/step
Epoch 14/50
2948/2948 - 62s - loss: 3.2636 - accuracy300: 0.3835 - val_loss: 3.3466 - val_accuracy300: 0.3258 - 62s/epoch - 21ms/step
Epoch 15/50
2948/2948 - 62s - loss: 3.2630 - accuracy300: 0.3837 - val_loss: 3.3408 - val_accuracy300: 0.3257 - 62s/epoch - 21ms/step
Epoch 16/50
2948/2948 - 60s - loss: 3.2625 - accuracy300: 0.3849 - val_loss: 3.3445 - val_accuracy300: 0.3259 - 60s/epoch - 20ms/step
Epoch 17/50
2948/2948 - 61s - loss: 3.2619 - accuracy300: 0.3849 - val_loss: 3.3508 - val_accuracy300: 0.3259 - 61s/epoch - 21ms/step
Epoch 18/50
2948/2948 - 62s - loss: 3.2612 - accuracy300: 0.3853 - val_loss: 3.3488 - val_accuracy300: 0.3259 - 62s/epoch - 21ms/step
Epoch 19/50
2948/2948 - 63s - loss: 3.2608 - accuracy300: 0.3856 - val_loss: 3.3495 - val_accuracy300: 0.3256 - 63s/epoch - 21ms/step
Epoch 20/50
2948/2948 - 61s - loss: 3.2600 - accuracy300: 0.3861 - val_loss: 3.3510 - val_accuracy300: 0.3257 - 61s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h300
Evaluating performance on  test set...
12066/12066 - 166s - 166s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930331
{'0': {'precision': 0.3140267648516604, 'recall': 0.004734388527300929, 'f1-score': 0.009328142385101894, 'support': 936763}, '1': {'precision': 0.3858301170126044, 'recall': 0.9928184095535442, 'f1-score': 0.5557025387528056, 'support': 1192772}, '2': {'precision': 0.33516081871345027, 'recall': 0.001911806709461671, 'f1-score': 0.003801926668836432, 'support': 959302}, 'accuracy': 0.3854120499074571, 'macro avg': {'precision': 0.34500590019257166, 'recall': 0.3331548682634356, 'f1-score': 0.18961086926891466, 'support': 3088837}, 'weighted avg': {'precision': 0.34831765430339784, 'recall': 0.3854120499074571, 'f1-score': 0.21859744721253493, 'support': 3088837}}
[[   4435  931148    1180]
 [   6108 1184206    2458]
 [   3580  953888    1834]]
Evaluating performance on  train set...
2948/2948 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135411
{'0': {'precision': 0.3932530120481928, 'recall': 0.0032134966860815424, 'f1-score': 0.006374900392181372, 'support': 253929}, '1': {'precision': 0.3264723763557729, 'recall': 0.9958931738218239, 'f1-score': 0.4917424096694559, 'support': 246419}, '2': {'precision': 0.36657303370786515, 'recall': 0.0010270253254214346, 'f1-score': 0.002048311908461647, 'support': 254132}, 'accuracy': 0.32669388187890996, 'macro avg': {'precision': 0.36209947403727694, 'recall': 0.33337789861110895, 'f1-score': 0.166721873990033, 'support': 754480}, 'weighted avg': {'precision': 0.3624553053862872, 'recall': 0.32669388187890996, 'f1-score': 0.16344235305368607, 'support': 754480}}
[[   816 252918    195]
 [   756 245407    256]
 [   503 253368    261]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114035
{'0': {'precision': 0.4007936507936508, 'recall': 0.0016499493579900024, 'f1-score': 0.003286369700322129, 'support': 61214}, '1': {'precision': 0.3258004718570947, 'recall': 0.9976434567221687, 'f1-score': 0.4911922627415776, 'support': 58136}, '2': {'precision': 0.390625, 'recall': 0.000846740050804403, 'f1-score': 0.0016898171617830949, 'support': 59050}, 'accuracy': 0.32595291479820626, 'macro avg': {'precision': 0.3724063742169152, 'recall': 0.33338004871032106, 'f1-score': 0.16538948320122762, 'support': 178400}, 'weighted avg': {'precision': 0.37298949003120285, 'recall': 0.32595291479820626, 'f1-score': 0.1617539737947487, 'support': 178400}}
[[  101 61078    35]
 [   94 57999    43]
 [   57 58943    50]]
training model: results/ATVI/W1/deepOF_L1/h500
Epoch 1/50
2948/2948 - 64s - loss: 3.2689 - accuracy500: 0.3835 - val_loss: 3.2970 - val_accuracy500: 0.3401 - 64s/epoch - 22ms/step
Epoch 2/50
2948/2948 - 61s - loss: 3.2651 - accuracy500: 0.3805 - val_loss: 3.2984 - val_accuracy500: 0.3316 - 61s/epoch - 21ms/step
Epoch 3/50
2948/2948 - 63s - loss: 3.2667 - accuracy500: 0.3804 - val_loss: 3.2998 - val_accuracy500: 0.3353 - 63s/epoch - 22ms/step
Epoch 4/50
2948/2948 - 62s - loss: 3.2661 - accuracy500: 0.3819 - val_loss: 3.2977 - val_accuracy500: 0.3388 - 62s/epoch - 21ms/step
Epoch 5/50
2948/2948 - 64s - loss: 3.2634 - accuracy500: 0.3843 - val_loss: 3.2945 - val_accuracy500: 0.3435 - 64s/epoch - 22ms/step
Epoch 6/50
2948/2948 - 63s - loss: 3.2587 - accuracy500: 0.3866 - val_loss: 3.2954 - val_accuracy500: 0.3428 - 63s/epoch - 21ms/step
Epoch 7/50
2948/2948 - 62s - loss: 3.2560 - accuracy500: 0.3878 - val_loss: 3.2947 - val_accuracy500: 0.3442 - 62s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 62s - loss: 3.2546 - accuracy500: 0.3887 - val_loss: 3.2969 - val_accuracy500: 0.3425 - 62s/epoch - 21ms/step
Epoch 9/50
2948/2948 - 63s - loss: 3.2523 - accuracy500: 0.3895 - val_loss: 3.2964 - val_accuracy500: 0.3443 - 63s/epoch - 21ms/step
Epoch 10/50
2948/2948 - 63s - loss: 3.2504 - accuracy500: 0.3912 - val_loss: 3.2973 - val_accuracy500: 0.3428 - 63s/epoch - 21ms/step
Epoch 11/50
2948/2948 - 63s - loss: 3.2487 - accuracy500: 0.3915 - val_loss: 3.2973 - val_accuracy500: 0.3445 - 63s/epoch - 21ms/step
Epoch 12/50
2948/2948 - 63s - loss: 3.2470 - accuracy500: 0.3923 - val_loss: 3.2967 - val_accuracy500: 0.3456 - 63s/epoch - 21ms/step
Epoch 13/50
2948/2948 - 62s - loss: 3.2463 - accuracy500: 0.3922 - val_loss: 3.2970 - val_accuracy500: 0.3424 - 62s/epoch - 21ms/step
Epoch 14/50
2948/2948 - 62s - loss: 3.2457 - accuracy500: 0.3929 - val_loss: 3.2931 - val_accuracy500: 0.3467 - 62s/epoch - 21ms/step
Epoch 15/50
2948/2948 - 62s - loss: 3.2458 - accuracy500: 0.3926 - val_loss: 3.2932 - val_accuracy500: 0.3460 - 62s/epoch - 21ms/step
Epoch 16/50
2948/2948 - 64s - loss: 3.2456 - accuracy500: 0.3931 - val_loss: 3.2928 - val_accuracy500: 0.3492 - 64s/epoch - 22ms/step
Epoch 17/50
2948/2948 - 62s - loss: 3.2439 - accuracy500: 0.3936 - val_loss: 3.2916 - val_accuracy500: 0.3478 - 62s/epoch - 21ms/step
Epoch 18/50
2948/2948 - 63s - loss: 3.2431 - accuracy500: 0.3949 - val_loss: 3.2938 - val_accuracy500: 0.3465 - 63s/epoch - 21ms/step
Epoch 19/50
2948/2948 - 63s - loss: 3.2429 - accuracy500: 0.3950 - val_loss: 3.2926 - val_accuracy500: 0.3476 - 63s/epoch - 21ms/step
Epoch 20/50
2948/2948 - 64s - loss: 3.2422 - accuracy500: 0.3956 - val_loss: 3.2920 - val_accuracy500: 0.3480 - 64s/epoch - 22ms/step
Epoch 21/50
2948/2948 - 62s - loss: 3.2415 - accuracy500: 0.3957 - val_loss: 3.2934 - val_accuracy500: 0.3477 - 62s/epoch - 21ms/step
Epoch 22/50
2948/2948 - 62s - loss: 3.2406 - accuracy500: 0.3962 - val_loss: 3.2910 - val_accuracy500: 0.3493 - 62s/epoch - 21ms/step
Epoch 23/50
2948/2948 - 63s - loss: 3.2400 - accuracy500: 0.3965 - val_loss: 3.2904 - val_accuracy500: 0.3497 - 63s/epoch - 21ms/step
Epoch 24/50
2948/2948 - 62s - loss: 3.2393 - accuracy500: 0.3972 - val_loss: 3.2910 - val_accuracy500: 0.3483 - 62s/epoch - 21ms/step
Epoch 25/50
2948/2948 - 63s - loss: 3.2387 - accuracy500: 0.3977 - val_loss: 3.2892 - val_accuracy500: 0.3519 - 63s/epoch - 21ms/step
Epoch 26/50
2948/2948 - 63s - loss: 3.2382 - accuracy500: 0.3977 - val_loss: 3.2902 - val_accuracy500: 0.3496 - 63s/epoch - 21ms/step
Epoch 27/50
2948/2948 - 62s - loss: 3.2386 - accuracy500: 0.3974 - val_loss: 3.2888 - val_accuracy500: 0.3515 - 62s/epoch - 21ms/step
Epoch 28/50
2948/2948 - 63s - loss: 3.2375 - accuracy500: 0.3985 - val_loss: 3.2887 - val_accuracy500: 0.3515 - 63s/epoch - 21ms/step
Epoch 29/50
2948/2948 - 62s - loss: 3.2369 - accuracy500: 0.3989 - val_loss: 3.2901 - val_accuracy500: 0.3501 - 62s/epoch - 21ms/step
Epoch 30/50
2948/2948 - 62s - loss: 3.2358 - accuracy500: 0.3993 - val_loss: 3.2889 - val_accuracy500: 0.3511 - 62s/epoch - 21ms/step
Epoch 31/50
2948/2948 - 65s - loss: 3.2353 - accuracy500: 0.4000 - val_loss: 3.2904 - val_accuracy500: 0.3492 - 65s/epoch - 22ms/step
Epoch 32/50
2948/2948 - 62s - loss: 3.2350 - accuracy500: 0.3998 - val_loss: 3.2902 - val_accuracy500: 0.3501 - 62s/epoch - 21ms/step
Epoch 33/50
2948/2948 - 63s - loss: 3.2342 - accuracy500: 0.4001 - val_loss: 3.2895 - val_accuracy500: 0.3499 - 63s/epoch - 21ms/step
Epoch 34/50
2948/2948 - 62s - loss: 3.2339 - accuracy500: 0.4003 - val_loss: 3.2901 - val_accuracy500: 0.3502 - 62s/epoch - 21ms/step
Epoch 35/50
2948/2948 - 64s - loss: 3.2333 - accuracy500: 0.4013 - val_loss: 3.2916 - val_accuracy500: 0.3486 - 64s/epoch - 22ms/step
Epoch 36/50
2948/2948 - 63s - loss: 3.2323 - accuracy500: 0.4016 - val_loss: 3.2893 - val_accuracy500: 0.3530 - 63s/epoch - 21ms/step
Epoch 37/50
2948/2948 - 63s - loss: 3.2325 - accuracy500: 0.4019 - val_loss: 3.2925 - val_accuracy500: 0.3477 - 63s/epoch - 21ms/step
Epoch 38/50
2948/2948 - 62s - loss: 3.2329 - accuracy500: 0.4014 - val_loss: 3.2940 - val_accuracy500: 0.3482 - 62s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h500
Evaluating performance on  test set...
12066/12066 - 163s - 163s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0857959
{'0': {'precision': 0.2803984444150903, 'recall': 0.347776616742134, 'f1-score': 0.31047403301491583, 'support': 775170}, '1': {'precision': 0.5012098686058182, 'recall': 0.4781627381466223, 'f1-score': 0.48941512455278735, 'support': 1496662}, '2': {'precision': 0.2974596780533966, 'recall': 0.2546985636562812, 'f1-score': 0.27442333383007095, 'support': 817005}, 'accuracy': 0.3863344035311672, 'macro avg': {'precision': 0.3596893303581017, 'recall': 0.36021263951501253, 'f1-score': 0.3581041637992581, 'support': 3088837}, 'weighted avg': {'precision': 0.3919029300648049, 'recall': 0.3863344035311672, 'f1-score': 0.3876424722869588, 'support': 3088837}}
[[269586 342858 162726]
 [452273 715648 328741]
 [239580 369335 208090]]
Evaluating performance on  train set...
2948/2948 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964383
{'0': {'precision': 0.3607044667028752, 'recall': 0.34031532157795846, 'f1-score': 0.35021338522164264, 'support': 251743}, '1': {'precision': 0.3363521989862872, 'recall': 0.4471685580293548, 'f1-score': 0.38392378622765194, 'support': 249908}, '2': {'precision': 0.3683298777087856, 'recall': 0.2691107428340894, 'f1-score': 0.31099846418254284, 'support': 252829}, 'accuracy': 0.35184763015586895, 'macro avg': {'precision': 0.35512884779931597, 'recall': 0.35219820748046754, 'f1-score': 0.3483785452106125, 'support': 754480}, 'weighted avg': {'precision': 0.35519351680187883, 'recall': 0.35184763015586895, 'f1-score': 0.34823828929228096, 'support': 754480}}
[[ 85672 109488  56583]
 [ 78056 111751  60101]
 [ 73785 111005  68039]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961316
{'0': {'precision': 0.3579856115107914, 'recall': 0.3576223894478735, 'f1-score': 0.3578039082987903, 'support': 59135}, '1': {'precision': 0.3488198285116387, 'recall': 0.4078228266395526, 'f1-score': 0.37602080052733733, 'support': 62944}, '2': {'precision': 0.3457384003148642, 'recall': 0.28074785603948793, 'f1-score': 0.3098721277742394, 'support': 56321}, 'accuracy': 0.35106502242152465, 'macro avg': {'precision': 0.3508479467790981, 'recall': 0.34873102404230466, 'f1-score': 0.34789894553345563, 'support': 178400}, 'weighted avg': {'precision': 0.3508852402839726, 'recall': 0.35106502242152465, 'f1-score': 0.3490991899888712, 'support': 178400}}
[[21148 24061 13926]
 [21278 25670 15996]
 [16649 23860 15812]]
training model: results/ATVI/W1/deepOF_L1/h1000
Epoch 1/50
2948/2948 - 64s - loss: 3.2852 - accuracy1000: 0.3755 - val_loss: 3.3196 - val_accuracy1000: 0.3546 - 64s/epoch - 22ms/step
Epoch 2/50
2948/2948 - 63s - loss: 3.2828 - accuracy1000: 0.3680 - val_loss: 3.3244 - val_accuracy1000: 0.3546 - 63s/epoch - 21ms/step
Epoch 3/50
2948/2948 - 62s - loss: 3.2835 - accuracy1000: 0.3650 - val_loss: 3.3030 - val_accuracy1000: 0.3550 - 62s/epoch - 21ms/step
Epoch 4/50
2948/2948 - 62s - loss: 3.2821 - accuracy1000: 0.3666 - val_loss: 3.3002 - val_accuracy1000: 0.3549 - 62s/epoch - 21ms/step
Epoch 5/50
2948/2948 - 62s - loss: 3.2783 - accuracy1000: 0.3698 - val_loss: 3.3047 - val_accuracy1000: 0.3548 - 62s/epoch - 21ms/step
Epoch 6/50
2948/2948 - 62s - loss: 3.2747 - accuracy1000: 0.3716 - val_loss: 3.3180 - val_accuracy1000: 0.3547 - 62s/epoch - 21ms/step
Epoch 7/50
2948/2948 - 63s - loss: 3.2716 - accuracy1000: 0.3752 - val_loss: 3.3105 - val_accuracy1000: 0.3549 - 63s/epoch - 21ms/step
Epoch 8/50
2948/2948 - 61s - loss: 3.2709 - accuracy1000: 0.3757 - val_loss: 3.3148 - val_accuracy1000: 0.3549 - 61s/epoch - 21ms/step
Epoch 9/50
2948/2948 - 59s - loss: 3.2683 - accuracy1000: 0.3775 - val_loss: 3.3138 - val_accuracy1000: 0.3547 - 59s/epoch - 20ms/step
Epoch 10/50
2948/2948 - 63s - loss: 3.2658 - accuracy1000: 0.3783 - val_loss: 3.3165 - val_accuracy1000: 0.3548 - 63s/epoch - 21ms/step
Epoch 11/50
2948/2948 - 62s - loss: 3.2643 - accuracy1000: 0.3797 - val_loss: 3.3200 - val_accuracy1000: 0.3548 - 62s/epoch - 21ms/step
Epoch 12/50
2948/2948 - 62s - loss: 3.2638 - accuracy1000: 0.3802 - val_loss: 3.3195 - val_accuracy1000: 0.3548 - 62s/epoch - 21ms/step
Epoch 13/50
2948/2948 - 62s - loss: 3.2618 - accuracy1000: 0.3812 - val_loss: 3.3165 - val_accuracy1000: 0.3547 - 62s/epoch - 21ms/step
Epoch 14/50
2948/2948 - 61s - loss: 3.2605 - accuracy1000: 0.3821 - val_loss: 3.3186 - val_accuracy1000: 0.3548 - 61s/epoch - 21ms/step
testing model: results/ATVI/W1/deepOF_L1/h1000
Evaluating performance on  test set...
12066/12066 - 167s - 167s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004897
{'0': {'precision': 0.32212482009682064, 'recall': 0.0025568010700762886, 'f1-score': 0.00507333357374313, 'support': 962922}, '1': {'precision': 0.3496720703932937, 'recall': 0.991868662285288, 'f1-score': 0.5170603623894878, 'support': 1080634}, '2': {'precision': 0.357062004779273, 'recall': 0.005432032152119861, 'f1-score': 0.01070126453213065, 'support': 1045281}, 'accuracy': 0.3496419526184127, 'macro avg': {'precision': 0.3429529650897958, 'recall': 0.33328583183582805, 'f1-score': 0.17761165349845387, 'support': 3088837}, 'weighted avg': {'precision': 0.3435852178513597, 'recall': 0.3496419526184127, 'f1-score': 0.1860972465213631, 'support': 3088837}}
[[   2462  956200    4260]
 [   2823 1071847    5964]
 [   2358 1037245    5678]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1058048
{'0': {'precision': 0.36486486486486486, 'recall': 0.0021394357436322073, 'f1-score': 0.004253927990452295, 'support': 252403}, '1': {'precision': 0.330316180863776, 'recall': 0.9939882091846358, 'f1-score': 0.49585335750414655, 'support': 249177}, '2': {'precision': 0.38350125944584385, 'recall': 0.004816132858837485, 'f1-score': 0.009512800887236602, 'support': 252900}, 'accuracy': 0.33060783586046016, 'macro avg': {'precision': 0.3595607683914949, 'recall': 0.3336479259290352, 'f1-score': 0.16987336212727847, 'support': 754480}, 'weighted avg': {'precision': 0.35970158254616885, 'recall': 0.33060783586046016, 'f1-score': 0.16837390466780697, 'support': 754480}}
[[   540 250911    952]
 [   492 247679   1006]
 [   448 251234   1218]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004049
{'0': {'precision': 0.33460076045627374, 'recall': 0.001497056922187064, 'f1-score': 0.00298077737318994, 'support': 58782}, '1': {'precision': 0.3548089213218692, 'recall': 0.9955132154762469, 'f1-score': 0.5231595639575913, 'support': 63297}, '2': {'precision': 0.3685185185185185, 'recall': 0.0035333179453489816, 'f1-score': 0.0069995251578410505, 'support': 56321}, 'accuracy': 0.3548206278026906, 'macro avg': {'precision': 0.35264273343222047, 'recall': 0.3335145301145943, 'f1-score': 0.17771328882954077, 'support': 178400}, 'weighted avg': {'precision': 0.3524785519928953, 'recall': 0.3548206278026906, 'f1-score': 0.1888109149763973, 'support': 178400}}
[[   88 58547   147]
 [   90 63013   194]
 [   85 56037   199]]
training model: results/ATVI/W1/deepLOB_L2/h10
Epoch 1/50
2948/2948 - 138s - loss: 2.8923 - accuracy10: 0.4586 - val_loss: 2.6849 - val_accuracy10: 0.5935 - 138s/epoch - 47ms/step
Epoch 2/50
2948/2948 - 134s - loss: 2.6996 - accuracy10: 0.5244 - val_loss: 2.6390 - val_accuracy10: 0.6876 - 134s/epoch - 45ms/step
Epoch 3/50
2948/2948 - 133s - loss: 2.5647 - accuracy10: 0.5773 - val_loss: 2.5501 - val_accuracy10: 0.7036 - 133s/epoch - 45ms/step
Epoch 4/50
2948/2948 - 133s - loss: 2.4894 - accuracy10: 0.6008 - val_loss: 2.4483 - val_accuracy10: 0.6954 - 133s/epoch - 45ms/step
Epoch 5/50
2948/2948 - 134s - loss: 2.4526 - accuracy10: 0.6099 - val_loss: 2.3955 - val_accuracy10: 0.7069 - 134s/epoch - 46ms/step
Epoch 6/50
2948/2948 - 133s - loss: 2.4290 - accuracy10: 0.6138 - val_loss: 2.3861 - val_accuracy10: 0.7139 - 133s/epoch - 45ms/step
Epoch 7/50
2948/2948 - 133s - loss: 2.4102 - accuracy10: 0.6161 - val_loss: 2.3734 - val_accuracy10: 0.7128 - 133s/epoch - 45ms/step
Epoch 8/50
2948/2948 - 133s - loss: 2.3949 - accuracy10: 0.6177 - val_loss: 2.3346 - val_accuracy10: 0.7130 - 133s/epoch - 45ms/step
Epoch 9/50
2948/2948 - 133s - loss: 2.3829 - accuracy10: 0.6194 - val_loss: 2.3147 - val_accuracy10: 0.7090 - 133s/epoch - 45ms/step
Epoch 10/50
2948/2948 - 133s - loss: 2.3728 - accuracy10: 0.6203 - val_loss: 2.3003 - val_accuracy10: 0.7099 - 133s/epoch - 45ms/step
Epoch 11/50
2948/2948 - 133s - loss: 2.3631 - accuracy10: 0.6214 - val_loss: 2.3371 - val_accuracy10: 0.7061 - 133s/epoch - 45ms/step
Epoch 12/50
2948/2948 - 133s - loss: 2.3561 - accuracy10: 0.6226 - val_loss: 2.3058 - val_accuracy10: 0.7114 - 133s/epoch - 45ms/step
Epoch 13/50
2948/2948 - 133s - loss: 2.3495 - accuracy10: 0.6233 - val_loss: 2.3070 - val_accuracy10: 0.7104 - 133s/epoch - 45ms/step
Epoch 14/50
2948/2948 - 132s - loss: 2.3462 - accuracy10: 0.6234 - val_loss: 2.3419 - val_accuracy10: 0.7074 - 132s/epoch - 45ms/step
Epoch 15/50
2948/2948 - 132s - loss: 2.3378 - accuracy10: 0.6241 - val_loss: 2.3323 - val_accuracy10: 0.7064 - 132s/epoch - 45ms/step
Epoch 16/50
2948/2948 - 132s - loss: 2.3322 - accuracy10: 0.6252 - val_loss: 2.3395 - val_accuracy10: 0.7050 - 132s/epoch - 45ms/step
Epoch 17/50
2948/2948 - 135s - loss: 2.3279 - accuracy10: 0.6258 - val_loss: 2.3479 - val_accuracy10: 0.7032 - 135s/epoch - 46ms/step
Epoch 18/50
2948/2948 - 131s - loss: 2.3217 - accuracy10: 0.6263 - val_loss: 2.3567 - val_accuracy10: 0.6996 - 131s/epoch - 45ms/step
Epoch 19/50
2948/2948 - 131s - loss: 2.3182 - accuracy10: 0.6263 - val_loss: 2.3790 - val_accuracy10: 0.7031 - 131s/epoch - 45ms/step
Epoch 20/50
2948/2948 - 132s - loss: 2.3145 - accuracy10: 0.6262 - val_loss: 2.4034 - val_accuracy10: 0.7027 - 132s/epoch - 45ms/step
testing model: results/ATVI/W1/deepLOB_L2/h10
Evaluating performance on  test set...
12066/12066 - 223s - 223s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72057694
{'0': {'precision': 0.425937834079528, 'recall': 0.6020906517190119, 'f1-score': 0.49892233854497264, 'support': 528065}, '1': {'precision': 0.8428243757700123, 'recall': 0.7321170750219863, 'f1-score': 0.7835797533116876, 'support': 2034217}, '2': {'precision': 0.4769340130107357, 'recall': 0.5211447888179884, 'f1-score': 0.4980602233715178, 'support': 526560}, 'accuracy': 0.67392310775365, 'macro avg': {'precision': 0.5818987409534254, 'recall': 0.6184508385196622, 'f1-score': 0.593520771742726, 'support': 3088842}, 'weighted avg': {'precision': 0.7091799805395957, 'recall': 0.67392310775365, 'f1-score': 0.6862420515405768, 'support': 3088842}}
[[ 317943  127489   82633]
 [ 326608 1489285  218324]
 [ 101903  150243  274414]]
Evaluating performance on  train set...
2948/2948 - 55s - 55s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72608584
{'0': {'precision': 0.49071132132101053, 'recall': 0.37119907305921773, 'f1-score': 0.42266943014419117, 'support': 127732}, '1': {'precision': 0.7956793067811432, 'recall': 0.7995837851980115, 'f1-score': 0.797626767796004, 'support': 500703}, '2': {'precision': 0.4360338463726333, 'recall': 0.5351495870587956, 'f1-score': 0.48053400582733147, 'support': 126047}, 'accuracy': 0.6828817652376067, 'macro avg': {'precision': 0.5741414914915958, 'recall': 0.568644148438675, 'f1-score': 0.5669434012558422, 'support': 754482}, 'weighted avg': {'precision': 0.683965041806094, 'recall': 0.6828817652376067, 'f1-score': 0.6811725090849855, 'support': 754482}}
[[ 47414  56242  24076]
 [ 37180 400354  63169]
 [ 12029  46564  67454]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67419153
{'0': {'precision': 0.4363595063224048, 'recall': 0.4484824902723735, 'f1-score': 0.4423379514142073, 'support': 25700}, '1': {'precision': 0.8437440210293395, 'recall': 0.7953718515730372, 'f1-score': 0.8188441774946817, 'support': 127524}, '2': {'precision': 0.4277531237213987, 'recall': 0.5398395297108357, 'f1-score': 0.47730425468401555, 'support': 25176}, 'accuracy': 0.7093385650224215, 'macro avg': {'precision': 0.5692855503577143, 'recall': 0.5945646238520822, 'f1-score': 0.579495461197635, 'support': 178400}, 'weighted avg': {'precision': 0.7263518189071818, 'recall': 0.7093385650224215, 'f1-score': 0.716406850662005, 'support': 178400}}
[[ 11526   9900   4274]
 [ 12187 101429  13908]
 [  2701   8884  13591]]
training model: results/ATVI/W1/deepLOB_L2/h20
Epoch 1/50
2948/2948 - 135s - loss: 2.9703 - accuracy20: 0.4712 - val_loss: 3.0966 - val_accuracy20: 0.6016 - 135s/epoch - 46ms/step
Epoch 2/50
2948/2948 - 131s - loss: 2.8599 - accuracy20: 0.5057 - val_loss: 2.9347 - val_accuracy20: 0.5989 - 131s/epoch - 44ms/step
Epoch 3/50
2948/2948 - 132s - loss: 2.7647 - accuracy20: 0.5425 - val_loss: 2.7783 - val_accuracy20: 0.6188 - 132s/epoch - 45ms/step
Epoch 4/50
2948/2948 - 132s - loss: 2.6647 - accuracy20: 0.5746 - val_loss: 2.6605 - val_accuracy20: 0.6319 - 132s/epoch - 45ms/step
Epoch 5/50
2948/2948 - 132s - loss: 2.6041 - accuracy20: 0.5928 - val_loss: 2.5804 - val_accuracy20: 0.6404 - 132s/epoch - 45ms/step
Epoch 6/50
2948/2948 - 132s - loss: 2.5711 - accuracy20: 0.6000 - val_loss: 2.5684 - val_accuracy20: 0.6370 - 132s/epoch - 45ms/step
Epoch 7/50
2948/2948 - 134s - loss: 2.5480 - accuracy20: 0.6038 - val_loss: 2.5310 - val_accuracy20: 0.6515 - 134s/epoch - 45ms/step
Epoch 8/50
2948/2948 - 132s - loss: 2.5294 - accuracy20: 0.6063 - val_loss: 2.5288 - val_accuracy20: 0.6503 - 132s/epoch - 45ms/step
Epoch 9/50
2948/2948 - 132s - loss: 2.5156 - accuracy20: 0.6081 - val_loss: 2.5057 - val_accuracy20: 0.6483 - 132s/epoch - 45ms/step
Epoch 10/50
2948/2948 - 132s - loss: 2.5037 - accuracy20: 0.6104 - val_loss: 2.5154 - val_accuracy20: 0.6511 - 132s/epoch - 45ms/step
Epoch 11/50
2948/2948 - 132s - loss: 2.4940 - accuracy20: 0.6113 - val_loss: 2.5231 - val_accuracy20: 0.6599 - 132s/epoch - 45ms/step
Epoch 12/50
2948/2948 - 132s - loss: 2.4846 - accuracy20: 0.6123 - val_loss: 2.5196 - val_accuracy20: 0.6572 - 132s/epoch - 45ms/step
Epoch 13/50
2948/2948 - 132s - loss: 2.4771 - accuracy20: 0.6134 - val_loss: 2.5114 - val_accuracy20: 0.6571 - 132s/epoch - 45ms/step
Epoch 14/50
2948/2948 - 133s - loss: 2.4700 - accuracy20: 0.6140 - val_loss: 2.5105 - val_accuracy20: 0.6574 - 133s/epoch - 45ms/step
Epoch 15/50
2948/2948 - 132s - loss: 2.4645 - accuracy20: 0.6148 - val_loss: 2.4877 - val_accuracy20: 0.6575 - 132s/epoch - 45ms/step
Epoch 16/50
2948/2948 - 132s - loss: 2.4588 - accuracy20: 0.6160 - val_loss: 2.5034 - val_accuracy20: 0.6595 - 132s/epoch - 45ms/step
Epoch 17/50
2948/2948 - 132s - loss: 2.4527 - accuracy20: 0.6161 - val_loss: 2.5358 - val_accuracy20: 0.6523 - 132s/epoch - 45ms/step
Epoch 18/50
2948/2948 - 134s - loss: 2.4482 - accuracy20: 0.6171 - val_loss: 2.5264 - val_accuracy20: 0.6535 - 134s/epoch - 46ms/step
Epoch 19/50
2948/2948 - 131s - loss: 2.4438 - accuracy20: 0.6177 - val_loss: 2.5171 - val_accuracy20: 0.6496 - 131s/epoch - 45ms/step
Epoch 20/50
2948/2948 - 132s - loss: 2.4391 - accuracy20: 0.6185 - val_loss: 2.5345 - val_accuracy20: 0.6546 - 132s/epoch - 45ms/step
Epoch 21/50
2948/2948 - 132s - loss: 2.4352 - accuracy20: 0.6188 - val_loss: 2.5239 - val_accuracy20: 0.6526 - 132s/epoch - 45ms/step
Epoch 22/50
2948/2948 - 132s - loss: 2.4314 - accuracy20: 0.6195 - val_loss: 2.5075 - val_accuracy20: 0.6525 - 132s/epoch - 45ms/step
Epoch 23/50
2948/2948 - 132s - loss: 2.4261 - accuracy20: 0.6203 - val_loss: 2.5086 - val_accuracy20: 0.6522 - 132s/epoch - 45ms/step
Epoch 24/50
2948/2948 - 132s - loss: 2.4233 - accuracy20: 0.6206 - val_loss: 2.5134 - val_accuracy20: 0.6535 - 132s/epoch - 45ms/step
Epoch 25/50
2948/2948 - 132s - loss: 2.4198 - accuracy20: 0.6212 - val_loss: 2.5314 - val_accuracy20: 0.6508 - 132s/epoch - 45ms/step
testing model: results/ATVI/W1/deepLOB_L2/h20
Evaluating performance on  test set...
12066/12066 - 218s - 218s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.791439
{'0': {'precision': 0.48938181316406787, 'recall': 0.5131278728751394, 'f1-score': 0.5009736111474061, 'support': 691163}, '1': {'precision': 0.735656107563486, 'recall': 0.7532277504960709, 'f1-score': 0.7443382397347139, 'support': 1709937}, '2': {'precision': 0.5213299813160907, 'recall': 0.46494761116814154, 'f1-score': 0.4915271953663965, 'support': 687742}, 'accuracy': 0.6353160828556462, 'macro avg': {'precision': 0.5821226340145481, 'recall': 0.577101078179784, 'f1-score': 0.5789463487495055, 'support': 3088842}, 'weighted avg': {'precision': 0.6328289772481053, 'recall': 0.6353160828556462, 'f1-score': 0.6335933715723914, 'support': 3088842}}
[[ 354655  224141  112367]
 [ 240734 1287972  181231]
 [ 129311  238667  319764]]
Evaluating performance on  train set...
2948/2948 - 55s - 55s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.83566755
{'0': {'precision': 0.5445369547579493, 'recall': 0.33075388677031387, 'f1-score': 0.4115379842471403, 'support': 170450}, '1': {'precision': 0.6908814134030914, 'recall': 0.7872505761948525, 'f1-score': 0.7359245244828768, 'support': 415658}, '2': {'precision': 0.48329225719490393, 'recall': 0.5089503129936926, 'f1-score': 0.4957895437201862, 'support': 168374}, 'accuracy': 0.6220135139075551, 'macro avg': {'precision': 0.5729035417853149, 'recall': 0.542318258652953, 'f1-score': 0.5477506841500678, 'support': 754482}, 'weighted avg': {'precision': 0.6114931316899932, 'recall': 0.6220135139075551, 'f1-score': 0.6090504929829622, 'support': 754482}}
[[ 56377  80838  33235]
 [ 30047 327227  58384]
 [ 17108  65572  85694]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7703421
{'0': {'precision': 0.50381765951013, 'recall': 0.3856101371289707, 'f1-score': 0.4368588377962047, 'support': 34566}, '1': {'precision': 0.751092078560864, 'recall': 0.7937154125055658, 'f1-score': 0.7718157277358298, 'support': 110047}, '2': {'precision': 0.46608885897004376, 'recall': 0.4918163790807115, 'f1-score': 0.4786071227984274, 'support': 33787}, 'accuracy': 0.6574663677130045, 'macro avg': {'precision': 0.5736661990136793, 'recall': 0.5570473095717493, 'f1-score': 0.5624272294434873, 'support': 178400}, 'weighted avg': {'precision': 0.6492047952132031, 'recall': 0.6574663677130045, 'f1-score': 0.6513854643239851, 'support': 178400}}
[[13329 15462  5775]
 [ 9441 87346 13260]
 [ 3686 13484 16617]]
training model: results/ATVI/W1/deepLOB_L2/h30
Epoch 1/50
2948/2948 - 137s - loss: 3.0153 - accuracy30: 0.4751 - val_loss: 3.1079 - val_accuracy30: 0.5384 - 137s/epoch - 46ms/step
Epoch 2/50
2948/2948 - 133s - loss: 2.9065 - accuracy30: 0.5105 - val_loss: 2.9778 - val_accuracy30: 0.5642 - 133s/epoch - 45ms/step
Epoch 3/50
2948/2948 - 133s - loss: 2.8020 - accuracy30: 0.5462 - val_loss: 2.8811 - val_accuracy30: 0.5854 - 133s/epoch - 45ms/step
Epoch 4/50
2948/2948 - 138s - loss: 2.7196 - accuracy30: 0.5675 - val_loss: 2.7660 - val_accuracy30: 0.5966 - 138s/epoch - 47ms/step
Epoch 5/50
2948/2948 - 131s - loss: 2.6698 - accuracy30: 0.5794 - val_loss: 2.6700 - val_accuracy30: 0.6064 - 131s/epoch - 44ms/step
Epoch 6/50
2948/2948 - 134s - loss: 2.6412 - accuracy30: 0.5845 - val_loss: 2.6299 - val_accuracy30: 0.6096 - 134s/epoch - 45ms/step
Epoch 7/50
2948/2948 - 131s - loss: 2.6243 - accuracy30: 0.5876 - val_loss: 2.6389 - val_accuracy30: 0.6156 - 131s/epoch - 44ms/step
Epoch 8/50
2948/2948 - 135s - loss: 2.6116 - accuracy30: 0.5897 - val_loss: 2.6267 - val_accuracy30: 0.6164 - 135s/epoch - 46ms/step
Epoch 9/50
2948/2948 - 133s - loss: 2.6022 - accuracy30: 0.5914 - val_loss: 2.6394 - val_accuracy30: 0.6153 - 133s/epoch - 45ms/step
Epoch 10/50
2948/2948 - 135s - loss: 2.5932 - accuracy30: 0.5927 - val_loss: 2.6212 - val_accuracy30: 0.6164 - 135s/epoch - 46ms/step
Epoch 11/50
2948/2948 - 130s - loss: 2.5859 - accuracy30: 0.5940 - val_loss: 2.6307 - val_accuracy30: 0.6161 - 130s/epoch - 44ms/step
Epoch 12/50
2948/2948 - 132s - loss: 2.5797 - accuracy30: 0.5951 - val_loss: 2.6267 - val_accuracy30: 0.6167 - 132s/epoch - 45ms/step
Epoch 13/50
2948/2948 - 132s - loss: 2.5749 - accuracy30: 0.5963 - val_loss: 2.6244 - val_accuracy30: 0.6156 - 132s/epoch - 45ms/step
Epoch 14/50
2948/2948 - 132s - loss: 2.5692 - accuracy30: 0.5975 - val_loss: 2.6251 - val_accuracy30: 0.6176 - 132s/epoch - 45ms/step
Epoch 15/50
2948/2948 - 132s - loss: 2.5649 - accuracy30: 0.5980 - val_loss: 2.6475 - val_accuracy30: 0.6151 - 132s/epoch - 45ms/step
Epoch 16/50
2948/2948 - 132s - loss: 2.5602 - accuracy30: 0.5991 - val_loss: 2.6455 - val_accuracy30: 0.6155 - 132s/epoch - 45ms/step
Epoch 17/50
2948/2948 - 133s - loss: 2.5553 - accuracy30: 0.5994 - val_loss: 2.6555 - val_accuracy30: 0.6123 - 133s/epoch - 45ms/step
Epoch 18/50
2948/2948 - 133s - loss: 2.5509 - accuracy30: 0.5999 - val_loss: 2.6315 - val_accuracy30: 0.6134 - 133s/epoch - 45ms/step
Epoch 19/50
2948/2948 - 134s - loss: 2.5474 - accuracy30: 0.6011 - val_loss: 2.6460 - val_accuracy30: 0.6132 - 134s/epoch - 45ms/step
Epoch 20/50
2948/2948 - 131s - loss: 2.5428 - accuracy30: 0.6012 - val_loss: 2.6551 - val_accuracy30: 0.6127 - 131s/epoch - 44ms/step
testing model: results/ATVI/W1/deepLOB_L2/h30
Evaluating performance on  test set...
12066/12066 - 223s - 223s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.868592
{'0': {'precision': 0.4839209741970391, 'recall': 0.5739189996179577, 'f1-score': 0.5250915985027504, 'support': 808811}, '1': {'precision': 0.6551448040589548, 'recall': 0.7648099954990474, 'f1-score': 0.7057425980031503, 'support': 1477465}, '2': {'precision': 0.6070246423207651, 'recall': 0.30619662432746964, 'f1-score': 0.407062128643579, 'support': 802566}, 'accuracy': 0.5956649773604477, 'macro avg': {'precision': 0.582030140192253, 'recall': 0.5483085398148249, 'f1-score': 0.5459654417164932, 'support': 3088842}, 'weighted avg': {'precision': 0.5978070306215248, 'recall': 0.5956649773604477, 'f1-score': 0.5808338765052713, 'support': 3088842}}
[[ 464192  272297   72322]
 [ 260718 1129980   86767]
 [ 234321  322502  245743]]
Evaluating performance on  train set...
2948/2948 - 72s - 72s/epoch - 25ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8847439
{'0': {'precision': 0.5431148197003157, 'recall': 0.3677984984743857, 'f1-score': 0.4385857824216202, 'support': 199264}, '1': {'precision': 0.6081153574250426, 'recall': 0.8171683389074693, 'f1-score': 0.6973104621484593, 'support': 357903}, '2': {'precision': 0.5561399711399712, 'recall': 0.39064946912297593, 'f1-score': 0.4589315749519968, 'support': 197315}, 'accuracy': 0.5869417693198777, 'macro avg': {'precision': 0.5691233827551098, 'recall': 0.5252054355016104, 'f1-score': 0.5316092731740255, 'support': 754482}, 'weighted avg': {'precision': 0.5773554579257585, 'recall': 0.5869417693198777, 'f1-score': 0.5666377029464388, 'support': 754482}}
[[ 73289  97283  28692]
 [ 32609 292467  32827]
 [ 29044  91190  77081]]
Evaluating performance on  val set...
697/697 - 17s - 17s/epoch - 24ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8376438
{'0': {'precision': 0.4780901198842497, 'recall': 0.4511410181392627, 'f1-score': 0.4642247867536377, 'support': 41016}, '1': {'precision': 0.6839232697470177, 'recall': 0.7901168641787673, 'f1-score': 0.7331948388572299, 'support': 97378}, '2': {'precision': 0.5355540848591808, 'recall': 0.36409538569214617, 'f1-score': 0.43348610201773696, 'support': 40006}, 'accuracy': 0.6166479820627803, 'macro avg': {'precision': 0.5658558248301494, 'recall': 0.5351177560033921, 'f1-score': 0.5436352425428682, 'support': 178400}, 'weighted avg': {'precision': 0.6033284822728355, 'recall': 0.6166479820627803, 'f1-score': 0.6041465015081172, 'support': 178400}}
[[18504 17633  4879]
 [12685 76940  7753]
 [ 7515 17925 14566]]
training model: results/ATVI/W1/deepLOB_L2/h50
Epoch 1/50
2948/2948 - 176s - loss: 3.0882 - accuracy50: 0.4634 - val_loss: 3.2137 - val_accuracy50: 0.4659 - 176s/epoch - 60ms/step
Epoch 2/50
2948/2948 - 171s - loss: 3.0063 - accuracy50: 0.4908 - val_loss: 3.1712 - val_accuracy50: 0.4845 - 171s/epoch - 58ms/step
Epoch 3/50
2948/2948 - 169s - loss: 2.9678 - accuracy50: 0.5033 - val_loss: 3.1101 - val_accuracy50: 0.4949 - 169s/epoch - 57ms/step
Epoch 4/50
2948/2948 - 173s - loss: 2.9291 - accuracy50: 0.5148 - val_loss: 3.0811 - val_accuracy50: 0.5005 - 173s/epoch - 59ms/step
Epoch 5/50
2948/2948 - 175s - loss: 2.8910 - accuracy50: 0.5248 - val_loss: 3.0782 - val_accuracy50: 0.5060 - 175s/epoch - 59ms/step
Epoch 6/50
2948/2948 - 177s - loss: 2.8540 - accuracy50: 0.5332 - val_loss: 3.0490 - val_accuracy50: 0.5149 - 177s/epoch - 60ms/step
Epoch 7/50
2948/2948 - 177s - loss: 2.8203 - accuracy50: 0.5411 - val_loss: 2.9771 - val_accuracy50: 0.5256 - 177s/epoch - 60ms/step
Epoch 8/50
2948/2948 - 178s - loss: 2.7961 - accuracy50: 0.5458 - val_loss: 2.9483 - val_accuracy50: 0.5250 - 178s/epoch - 60ms/step
Epoch 9/50
2948/2948 - 178s - loss: 2.7812 - accuracy50: 0.5488 - val_loss: 2.9773 - val_accuracy50: 0.5173 - 178s/epoch - 60ms/step
Epoch 10/50
2948/2948 - 180s - loss: 2.7726 - accuracy50: 0.5504 - val_loss: 2.9324 - val_accuracy50: 0.5291 - 180s/epoch - 61ms/step
Epoch 11/50
2948/2948 - 181s - loss: 2.7608 - accuracy50: 0.5526 - val_loss: 2.9392 - val_accuracy50: 0.5206 - 181s/epoch - 61ms/step
Epoch 12/50
2948/2948 - 181s - loss: 2.7527 - accuracy50: 0.5542 - val_loss: 2.9528 - val_accuracy50: 0.5202 - 181s/epoch - 61ms/step
Epoch 13/50
2948/2948 - 183s - loss: 2.7461 - accuracy50: 0.5554 - val_loss: 2.9412 - val_accuracy50: 0.5236 - 183s/epoch - 62ms/step
Epoch 14/50
2948/2948 - 180s - loss: 2.7395 - accuracy50: 0.5565 - val_loss: 2.9629 - val_accuracy50: 0.5235 - 180s/epoch - 61ms/step
Epoch 15/50
2948/2948 - 181s - loss: 2.7345 - accuracy50: 0.5573 - val_loss: 2.9337 - val_accuracy50: 0.5268 - 181s/epoch - 62ms/step
Epoch 16/50
2948/2948 - 177s - loss: 2.7290 - accuracy50: 0.5585 - val_loss: 2.9410 - val_accuracy50: 0.5324 - 177s/epoch - 60ms/step
Epoch 17/50
2948/2948 - 186s - loss: 2.7247 - accuracy50: 0.5597 - val_loss: 2.9463 - val_accuracy50: 0.5269 - 186s/epoch - 63ms/step
Epoch 18/50
2948/2948 - 183s - loss: 2.7197 - accuracy50: 0.5605 - val_loss: 2.9552 - val_accuracy50: 0.5301 - 183s/epoch - 62ms/step
Epoch 19/50
2948/2948 - 185s - loss: 2.7153 - accuracy50: 0.5615 - val_loss: 2.9501 - val_accuracy50: 0.5327 - 185s/epoch - 63ms/step
Epoch 20/50
2948/2948 - 182s - loss: 2.7115 - accuracy50: 0.5620 - val_loss: 2.9298 - val_accuracy50: 0.5333 - 182s/epoch - 62ms/step
Epoch 21/50
2948/2948 - 187s - loss: 2.7074 - accuracy50: 0.5630 - val_loss: 2.9308 - val_accuracy50: 0.5342 - 187s/epoch - 64ms/step
Epoch 22/50
2948/2948 - 188s - loss: 2.7036 - accuracy50: 0.5641 - val_loss: 2.9307 - val_accuracy50: 0.5328 - 188s/epoch - 64ms/step
Epoch 23/50
2948/2948 - 191s - loss: 2.7001 - accuracy50: 0.5649 - val_loss: 2.9157 - val_accuracy50: 0.5342 - 191s/epoch - 65ms/step
Epoch 24/50
2948/2948 - 189s - loss: 2.6954 - accuracy50: 0.5657 - val_loss: 2.9233 - val_accuracy50: 0.5326 - 189s/epoch - 64ms/step
Epoch 25/50
2948/2948 - 190s - loss: 2.6917 - accuracy50: 0.5667 - val_loss: 2.9270 - val_accuracy50: 0.5342 - 190s/epoch - 64ms/step
Epoch 26/50
2948/2948 - 191s - loss: 2.6875 - accuracy50: 0.5675 - val_loss: 2.9256 - val_accuracy50: 0.5315 - 191s/epoch - 65ms/step
Epoch 27/50
2948/2948 - 190s - loss: 2.6853 - accuracy50: 0.5679 - val_loss: 2.9146 - val_accuracy50: 0.5322 - 190s/epoch - 65ms/step
Epoch 28/50
2948/2948 - 192s - loss: 2.6813 - accuracy50: 0.5689 - val_loss: 2.9077 - val_accuracy50: 0.5322 - 192s/epoch - 65ms/step
Epoch 29/50
2948/2948 - 199s - loss: 2.6773 - accuracy50: 0.5695 - val_loss: 2.9225 - val_accuracy50: 0.5307 - 199s/epoch - 67ms/step
Epoch 30/50
2948/2948 - 194s - loss: 2.6739 - accuracy50: 0.5704 - val_loss: 2.9426 - val_accuracy50: 0.5268 - 194s/epoch - 66ms/step
Epoch 31/50
2948/2948 - 200s - loss: 2.6708 - accuracy50: 0.5718 - val_loss: 2.9240 - val_accuracy50: 0.5304 - 200s/epoch - 68ms/step
Epoch 32/50
2948/2948 - 205s - loss: 2.6672 - accuracy50: 0.5716 - val_loss: 2.9317 - val_accuracy50: 0.5282 - 205s/epoch - 69ms/step
Epoch 33/50
2948/2948 - 209s - loss: 2.6635 - accuracy50: 0.5733 - val_loss: 2.9445 - val_accuracy50: 0.5274 - 209s/epoch - 71ms/step
Epoch 34/50
2948/2948 - 212s - loss: 2.6600 - accuracy50: 0.5739 - val_loss: 2.9399 - val_accuracy50: 0.5260 - 212s/epoch - 72ms/step
Epoch 35/50
2948/2948 - 216s - loss: 2.6567 - accuracy50: 0.5745 - val_loss: 2.9641 - val_accuracy50: 0.5249 - 216s/epoch - 73ms/step
Epoch 36/50
2948/2948 - 219s - loss: 2.6528 - accuracy50: 0.5753 - val_loss: 2.9733 - val_accuracy50: 0.5243 - 219s/epoch - 74ms/step
Epoch 37/50
2948/2948 - 216s - loss: 2.6505 - accuracy50: 0.5760 - val_loss: 3.0045 - val_accuracy50: 0.5194 - 216s/epoch - 73ms/step
Epoch 38/50
2948/2948 - 225s - loss: 2.6474 - accuracy50: 0.5760 - val_loss: 2.9896 - val_accuracy50: 0.5237 - 225s/epoch - 76ms/step
testing model: results/ATVI/W1/deepLOB_L2/h50
Evaluating performance on  test set...
12066/12066 - 431s - 431s/epoch - 36ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0112048
{'0': {'precision': 0.4802195729233438, 'recall': 0.5279364683037957, 'f1-score': 0.5029487796966688, 'support': 969217}, '1': {'precision': 0.5189952817025147, 'recall': 0.6940939041847984, 'f1-score': 0.593907629416211, 'support': 1157499}, '2': {'precision': 0.5387615899752368, 'recall': 0.2661553684236784, 'f1-score': 0.35629585878676434, 'support': 962126}, 'accuracy': 0.5086608508949308, 'macro avg': {'precision': 0.5126588148670318, 'recall': 0.4960619136374242, 'f1-score': 0.4843840892998814, 'support': 3088842}, 'weighted avg': {'precision': 0.5129851338792784, 'recall': 0.5086608508949308, 'f1-score': 0.49135420458021983, 'support': 3088842}}
[[511685 345076 112456]
 [247314 803413 106772]
 [306524 399527 256075]]
Evaluating performance on  train set...
2948/2948 - 106s - 106s/epoch - 36ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0342306
{'0': {'precision': 0.5399120777417862, 'recall': 0.27518847660363055, 'f1-score': 0.3645625840433427, 'support': 237430}, '1': {'precision': 0.47434665600041737, 'recall': 0.7780471803063582, 'f1-score': 0.5893738335174497, 'support': 280456}, '2': {'precision': 0.5078697938286979, 'recall': 0.37231821332566906, 'f1-score': 0.42965632956463207, 'support': 236596}, 'accuracy': 0.49256973658748654, 'macro avg': {'precision': 0.5073761758569671, 'recall': 0.47518462341188594, 'f1-score': 0.46119758237514147, 'support': 754482}, 'weighted avg': {'precision': 0.5054920490007448, 'recall': 0.49256973658748654, 'f1-score': 0.46854198129584856, 'support': 754482}}
[[ 65338 124161  47931]
 [ 24820 218208  37428]
 [ 30858 117649  88089]]
Evaluating performance on  val set...
697/697 - 26s - 26s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9619815
{'0': {'precision': 0.495794647733479, 'recall': 0.36202667942812705, 'f1-score': 0.418480828848348, 'support': 50151}, '1': {'precision': 0.5645249115164716, 'recall': 0.7302984943206833, 'f1-score': 0.6367998771545932, 'support': 79499}, '2': {'precision': 0.48289500719128825, 'recall': 0.3856820512820513, 'f1-score': 0.4288483908491663, 'support': 48750}, 'accuracy': 0.5326008968609866, 'macro avg': {'precision': 0.5144048554804129, 'recall': 0.49266907501028717, 'f1-score': 0.4947096989507025, 'support': 178400}, 'weighted avg': {'precision': 0.5228973930476737, 'recall': 0.5326008968609866, 'f1-score': 0.5186017070369022, 'support': 178400}}
[[18156 23051  8944]
 [10251 58058 11190]
 [ 8213 21735 18802]]
training model: results/ATVI/W1/deepLOB_L2/h100
Epoch 1/50
2948/2948 - 242s - loss: 3.2035 - accuracy100: 0.4209 - val_loss: 3.3038 - val_accuracy100: 0.3903 - 242s/epoch - 82ms/step
Epoch 2/50
2948/2948 - 239s - loss: 3.1627 - accuracy100: 0.4386 - val_loss: 3.2773 - val_accuracy100: 0.4005 - 239s/epoch - 81ms/step
Epoch 3/50
2948/2948 - 243s - loss: 3.1429 - accuracy100: 0.4463 - val_loss: 3.2757 - val_accuracy100: 0.4016 - 243s/epoch - 82ms/step
Epoch 4/50
2948/2948 - 247s - loss: 3.1303 - accuracy100: 0.4518 - val_loss: 3.2661 - val_accuracy100: 0.4104 - 247s/epoch - 84ms/step
Epoch 5/50
2948/2948 - 243s - loss: 3.1186 - accuracy100: 0.4561 - val_loss: 3.3215 - val_accuracy100: 0.4149 - 243s/epoch - 82ms/step
Epoch 6/50
2948/2948 - 254s - loss: 3.1089 - accuracy100: 0.4607 - val_loss: 3.2538 - val_accuracy100: 0.4214 - 254s/epoch - 86ms/step
Epoch 7/50
2948/2948 - 253s - loss: 3.0995 - accuracy100: 0.4635 - val_loss: 3.2874 - val_accuracy100: 0.4236 - 253s/epoch - 86ms/step
Epoch 8/50
2948/2948 - 248s - loss: 3.0918 - accuracy100: 0.4665 - val_loss: 3.3081 - val_accuracy100: 0.4220 - 248s/epoch - 84ms/step
Epoch 9/50
2948/2948 - 249s - loss: 3.0843 - accuracy100: 0.4685 - val_loss: 3.3727 - val_accuracy100: 0.4199 - 249s/epoch - 84ms/step
Epoch 10/50
2948/2948 - 255s - loss: 3.0774 - accuracy100: 0.4705 - val_loss: 3.3012 - val_accuracy100: 0.4253 - 255s/epoch - 86ms/step
Epoch 11/50
2948/2948 - 251s - loss: 3.0710 - accuracy100: 0.4727 - val_loss: 3.3175 - val_accuracy100: 0.4203 - 251s/epoch - 85ms/step
Epoch 12/50
2948/2948 - 256s - loss: 3.0645 - accuracy100: 0.4747 - val_loss: 3.3867 - val_accuracy100: 0.4188 - 256s/epoch - 87ms/step
Epoch 13/50
2948/2948 - 252s - loss: 3.0588 - accuracy100: 0.4768 - val_loss: 3.3584 - val_accuracy100: 0.4220 - 252s/epoch - 86ms/step
Epoch 14/50
2948/2948 - 239s - loss: 3.0534 - accuracy100: 0.4779 - val_loss: 3.3479 - val_accuracy100: 0.4197 - 239s/epoch - 81ms/step
Epoch 15/50
2948/2948 - 254s - loss: 3.0480 - accuracy100: 0.4801 - val_loss: 3.3130 - val_accuracy100: 0.4255 - 254s/epoch - 86ms/step
Epoch 16/50
2948/2948 - 258s - loss: 3.0434 - accuracy100: 0.4813 - val_loss: 3.3150 - val_accuracy100: 0.4242 - 258s/epoch - 88ms/step
testing model: results/ATVI/W1/deepLOB_L2/h100
Evaluating performance on  test set...
12066/12066 - 488s - 488s/epoch - 40ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1518633
{'0': {'precision': 0.38733499593330967, 'recall': 0.46157450467507266, 'f1-score': 0.4212085240254957, 'support': 996669}, '1': {'precision': 0.3860298697148964, 'recall': 0.5980573491271216, 'f1-score': 0.46920231488676983, 'support': 1072658}, '2': {'precision': 0.4447053612839337, 'recall': 0.10439277499595395, 'f1-score': 0.16909191145513097, 'support': 1019515}, 'accuracy': 0.3910779508955136, 'macro avg': {'precision': 0.40602340897737993, 'recall': 0.3880082095993827, 'f1-score': 0.35316758345579885, 'support': 3088842}, 'weighted avg': {'precision': 0.4058176486398096, 'recall': 0.3910779508955136, 'f1-score': 0.35466069006474177, 'support': 3088842}}
[[460037 475718  60914]
 [359164 641511  71983]
 [368497 544588 106430]]
Evaluating performance on  train set...
2948/2948 - 120s - 120s/epoch - 41ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1426396
{'0': {'precision': 0.4072298976587208, 'recall': 0.28121829020801625, 'f1-score': 0.33269168997606147, 'support': 252288}, '1': {'precision': 0.36265621956003663, 'recall': 0.5454093018028865, 'f1-score': 0.4356427391006766, 'support': 249156}, '2': {'precision': 0.4187586354525464, 'recall': 0.34016629913293656, 'f1-score': 0.37539305604619416, 'support': 253038}, 'accuracy': 0.3882332514228305, 'macro avg': {'precision': 0.39621491755710125, 'recall': 0.38893129704794643, 'f1-score': 0.3812424950409774, 'support': 754482}, 'weighted avg': {'precision': 0.39637663596860534, 'recall': 0.3882332514228305, 'f1-score': 0.3810108544668602, 'support': 754482}}
[[ 70948 120961  60379]
 [ 54170 135892  59094]
 [ 49103 117860  86075]]
Evaluating performance on  val set...
697/697 - 30s - 30s/epoch - 44ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0853351
{'0': {'precision': 0.4392813133521485, 'recall': 0.19912070487756536, 'f1-score': 0.27402797064074585, 'support': 55499}, '1': {'precision': 0.42088652630697754, 'recall': 0.7346571979659828, 'f1-score': 0.5351719880143274, 'support': 68436}, '2': {'precision': 0.41559133420149164, 'recall': 0.2578169466629946, 'f1-score': 0.318221476890304, 'support': 54465}, 'accuracy': 0.42247757847533635, 'macro avg': {'precision': 0.42525305795353924, 'recall': 0.3971982831688476, 'f1-score': 0.3758071451817924, 'support': 178400}, 'weighted avg': {'precision': 0.42499240998519866, 'recall': 0.42247757847533635, 'f1-score': 0.3876975406567807, 'support': 178400}}
[[11051 35481  8967]
 [ 7380 50277 10779]
 [ 6726 33697 14042]]
training model: results/ATVI/W1/deepLOB_L2/h200
Epoch 1/50
2948/2948 - 275s - loss: 3.2691 - accuracy200: 0.3840 - val_loss: 3.3702 - val_accuracy200: 0.3501 - 275s/epoch - 93ms/step
Epoch 2/50
2948/2948 - 260s - loss: 3.2365 - accuracy200: 0.4043 - val_loss: 3.3803 - val_accuracy200: 0.3642 - 260s/epoch - 88ms/step
Epoch 3/50
2948/2948 - 264s - loss: 3.2207 - accuracy200: 0.4139 - val_loss: 3.3863 - val_accuracy200: 0.3722 - 264s/epoch - 90ms/step
Epoch 4/50
2948/2948 - 266s - loss: 3.2081 - accuracy200: 0.4197 - val_loss: 3.3978 - val_accuracy200: 0.3693 - 266s/epoch - 90ms/step
Epoch 5/50
2948/2948 - 269s - loss: 3.1987 - accuracy200: 0.4239 - val_loss: 3.4280 - val_accuracy200: 0.3687 - 269s/epoch - 91ms/step
Epoch 6/50
2948/2948 - 274s - loss: 3.1915 - accuracy200: 0.4265 - val_loss: 3.3949 - val_accuracy200: 0.3764 - 274s/epoch - 93ms/step
Epoch 7/50
2948/2948 - 267s - loss: 3.1856 - accuracy200: 0.4288 - val_loss: 3.4056 - val_accuracy200: 0.3630 - 267s/epoch - 90ms/step
Epoch 8/50
2948/2948 - 270s - loss: 3.1800 - accuracy200: 0.4311 - val_loss: 3.4661 - val_accuracy200: 0.3637 - 270s/epoch - 92ms/step
Epoch 9/50
2948/2948 - 272s - loss: 3.1734 - accuracy200: 0.4344 - val_loss: 3.4771 - val_accuracy200: 0.3514 - 272s/epoch - 92ms/step
Epoch 10/50
2948/2948 - 276s - loss: 3.1681 - accuracy200: 0.4359 - val_loss: 3.4691 - val_accuracy200: 0.3573 - 276s/epoch - 94ms/step
Epoch 11/50
2948/2948 - 275s - loss: 3.1618 - accuracy200: 0.4387 - val_loss: 3.4991 - val_accuracy200: 0.3491 - 275s/epoch - 93ms/step
testing model: results/ATVI/W1/deepLOB_L2/h200
Evaluating performance on  test set...
12066/12066 - 538s - 538s/epoch - 45ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1384991
{'0': {'precision': 0.3717289331985943, 'recall': 0.024540598131027238, 'f1-score': 0.04604164409357031, 'support': 1004295}, '1': {'precision': 0.33870637775830803, 'recall': 0.9581318201992685, 'f1-score': 0.500487044175244, 'support': 1045424}, '2': {'precision': 0.3755057626287396, 'recall': 0.02357853690082887, 'f1-score': 0.04437095867240265, 'support': 1039123}, 'accuracy': 0.34019253817450035, 'macro avg': {'precision': 0.3619803578618807, 'recall': 0.3354169850770415, 'f1-score': 0.19696654898040564, 'support': 3088842}, 'weighted avg': {'precision': 0.3618229614231959, 'recall': 0.34019253817450035, 'f1-score': 0.1992874495728029, 'support': 3088842}}
[[  24646  959859   19790]
 [  22813 1001654   20957]
 [  18842  995780   24501]]
Evaluating performance on  train set...
2948/2948 - 141s - 141s/epoch - 48ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1506356
{'0': {'precision': 0.38568437083571294, 'recall': 0.008043385050261231, 'f1-score': 0.015758136713114018, 'support': 251884}, '1': {'precision': 0.3320399548697453, 'recall': 0.9465883087164552, 'f1-score': 0.4916286433789613, 'support': 249964}, '2': {'precision': 0.3748532423208191, 'recall': 0.05434343754205689, 'f1-score': 0.09492530915200563, 'support': 252634}, 'accuracy': 0.3344917440044958, 'macro avg': {'precision': 0.36419252267542573, 'recall': 0.3363250437695911, 'f1-score': 0.2007706964146936, 'support': 754482}, 'weighted avg': {'precision': 0.36428494167272585, 'recall': 0.3344917440044958, 'f1-score': 0.19992530673194653, 'support': 754482}}
[[  2026 238632  11226]
 [  1681 236613  11670]
 [  1546 237359  13729]]
Evaluating performance on  val set...
697/697 - 32s - 32s/epoch - 46ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1238321
{'0': {'precision': 0.4344911639244363, 'recall': 0.012116371546069402, 'f1-score': 0.02357531370377106, 'support': 58846}, '1': {'precision': 0.350202119908811, 'recall': 0.9567094703049759, 'f1-score': 0.5127227995320349, 'support': 62300}, '2': {'precision': 0.35029712021941184, 'recall': 0.040154399692597896, 'f1-score': 0.07204976730338311, 'support': 57254}, 'accuracy': 0.3509809417040359, 'macro avg': {'precision': 0.37833013468421967, 'recall': 0.33632674718121436, 'f1-score': 0.20278262684639636, 'support': 178400}, 'weighted avg': {'precision': 0.37803570865279434, 'recall': 0.3509809417040359, 'f1-score': 0.20995000391393379, 'support': 178400}}
[[  713 56034  2099]
 [  532 59603  2165]
 [  396 54559  2299]]
training model: results/ATVI/W1/deepLOB_L2/h300
Epoch 1/50
2948/2948 - 299s - loss: 3.2837 - accuracy300: 0.3737 - val_loss: 3.4114 - val_accuracy300: 0.3300 - 299s/epoch - 101ms/step
Epoch 2/50
2948/2948 - 284s - loss: 3.2493 - accuracy300: 0.3960 - val_loss: 3.4501 - val_accuracy300: 0.3423 - 284s/epoch - 96ms/step
Epoch 3/50
2948/2948 - 277s - loss: 3.2312 - accuracy300: 0.4069 - val_loss: 3.4783 - val_accuracy300: 0.3512 - 277s/epoch - 94ms/step
Epoch 4/50
2948/2948 - 287s - loss: 3.2185 - accuracy300: 0.4134 - val_loss: 3.4912 - val_accuracy300: 0.3530 - 287s/epoch - 97ms/step
Epoch 5/50
2948/2948 - 273s - loss: 3.2102 - accuracy300: 0.4179 - val_loss: 3.5174 - val_accuracy300: 0.3526 - 273s/epoch - 93ms/step
Epoch 6/50
2948/2948 - 286s - loss: 3.2034 - accuracy300: 0.4212 - val_loss: 3.4587 - val_accuracy300: 0.3538 - 286s/epoch - 97ms/step
Epoch 7/50
2948/2948 - 295s - loss: 3.1972 - accuracy300: 0.4232 - val_loss: 3.5127 - val_accuracy300: 0.3524 - 295s/epoch - 100ms/step
Epoch 8/50
2948/2948 - 291s - loss: 3.1909 - accuracy300: 0.4264 - val_loss: 3.4896 - val_accuracy300: 0.3515 - 291s/epoch - 99ms/step
Epoch 9/50
2948/2948 - 292s - loss: 3.1854 - accuracy300: 0.4291 - val_loss: 3.5090 - val_accuracy300: 0.3533 - 292s/epoch - 99ms/step
Epoch 10/50
2948/2948 - 291s - loss: 3.1801 - accuracy300: 0.4305 - val_loss: 3.4929 - val_accuracy300: 0.3527 - 291s/epoch - 99ms/step
Epoch 11/50
2948/2948 - 286s - loss: 3.1747 - accuracy300: 0.4337 - val_loss: 3.5079 - val_accuracy300: 0.3539 - 286s/epoch - 97ms/step
testing model: results/ATVI/W1/deepLOB_L2/h300
Evaluating performance on  test set...
12066/12066 - 569s - 569s/epoch - 47ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1606411
{'0': {'precision': 0.30739606454178664, 'recall': 0.09653968711469792, 'f1-score': 0.14693386148394508, 'support': 936765}, '1': {'precision': 0.40252154761587994, 'recall': 0.7736360785865554, 'f1-score': 0.5295296900800659, 'support': 1192774}, '2': {'precision': 0.3419679626576178, 'recall': 0.17900913475721436, 'f1-score': 0.23500222721416217, 'support': 959303}, 'accuracy': 0.3836169023860722, 'macro avg': {'precision': 0.35062852493842817, 'recall': 0.3497283001528226, 'f1-score': 0.30382192625939103, 'support': 3088842}, 'weighted avg': {'precision': 0.3548663231456355, 'recall': 0.3836169023860722, 'f1-score': 0.32202685889462646, 'support': 3088842}}
[[ 90435 671238 175092]
 [114653 922773 155348]
 [ 89109 698470 171724]]
Evaluating performance on  train set...
2948/2948 - 148s - 148s/epoch - 50ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1545119
{'0': {'precision': 0.35032899118250355, 'recall': 0.05177334839829771, 'f1-score': 0.09021437146287085, 'support': 254011}, '1': {'precision': 0.3326724639303209, 'recall': 0.6758963738985666, 'f1-score': 0.44588352055460534, 'support': 246270}, '2': {'precision': 0.3497959296742262, 'recall': 0.2980436741004166, 'f1-score': 0.32185270384224063, 'support': 254201}, 'accuracy': 0.33846665659353037, 'macro avg': {'precision': 0.3442657949290169, 'recall': 0.3419044654657603, 'f1-score': 0.28598353195323895, 'support': 754482}, 'weighted avg': {'precision': 0.34438613537565776, 'recall': 0.33846665659353037, 'f1-score': 0.2843519878354147, 'support': 754482}}
[[ 13151 168697  72163]
 [ 11151 166453  68666]
 [ 13237 165201  75763]]
Evaluating performance on  val set...
697/697 - 34s - 34s/epoch - 49ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.139273
{'0': {'precision': 0.39012530390873384, 'recall': 0.03409220912939023, 'f1-score': 0.06270478251720925, 'support': 61187}, '1': {'precision': 0.32642143913584154, 'recall': 0.7623343816054029, 'f1-score': 0.45711312161243123, 'support': 58191}, '2': {'precision': 0.34035852713178294, 'recall': 0.2142421469960354, 'f1-score': 0.2629608833988396, 'support': 59022}, 'accuracy': 0.33123318385650224, 'macro avg': {'precision': 0.3523017567254527, 'recall': 0.3368895792436095, 'f1-score': 0.26092626250949336, 'support': 178400}, 'weighted avg': {'precision': 0.35288132244052434, 'recall': 0.33123318385650224, 'f1-score': 0.25760686349549206, 'support': 178400}}
[[ 2086 46893 12208]
 [ 1531 44361 12299]
 [ 1730 44647 12645]]
training model: results/ATVI/W1/deepLOB_L2/h500
Epoch 1/50
2948/2948 - 306s - loss: 3.2527 - accuracy500: 0.3913 - val_loss: 3.3164 - val_accuracy500: 0.3469 - 306s/epoch - 104ms/step
Epoch 2/50
2948/2948 - 296s - loss: 3.2138 - accuracy500: 0.4199 - val_loss: 3.5473 - val_accuracy500: 0.2917 - 296s/epoch - 100ms/step
Epoch 3/50
2948/2948 - 287s - loss: 3.1902 - accuracy500: 0.4327 - val_loss: 3.5524 - val_accuracy500: 0.2980 - 287s/epoch - 97ms/step
Epoch 4/50
2948/2948 - 299s - loss: 3.1850 - accuracy500: 0.4364 - val_loss: 3.5149 - val_accuracy500: 0.3114 - 299s/epoch - 101ms/step
Epoch 5/50
2948/2948 - 302s - loss: 3.1760 - accuracy500: 0.4383 - val_loss: 3.5703 - val_accuracy500: 0.3020 - 302s/epoch - 103ms/step
Epoch 6/50
2948/2948 - 299s - loss: 3.1635 - accuracy500: 0.4430 - val_loss: 3.6156 - val_accuracy500: 0.2969 - 299s/epoch - 102ms/step
Epoch 7/50
2948/2948 - 293s - loss: 3.1545 - accuracy500: 0.4461 - val_loss: 3.5909 - val_accuracy500: 0.2952 - 293s/epoch - 99ms/step
Epoch 8/50
2948/2948 - 299s - loss: 3.1474 - accuracy500: 0.4479 - val_loss: 3.5512 - val_accuracy500: 0.2928 - 299s/epoch - 101ms/step
Epoch 9/50
2948/2948 - 300s - loss: 3.1409 - accuracy500: 0.4507 - val_loss: 3.5542 - val_accuracy500: 0.2916 - 300s/epoch - 102ms/step
Epoch 10/50
2948/2948 - 307s - loss: 3.1343 - accuracy500: 0.4529 - val_loss: 3.5891 - val_accuracy500: 0.3017 - 307s/epoch - 104ms/step
Epoch 11/50
2948/2948 - 302s - loss: 3.1301 - accuracy500: 0.4539 - val_loss: 3.5653 - val_accuracy500: 0.2996 - 302s/epoch - 102ms/step
testing model: results/ATVI/W1/deepLOB_L2/h500
Evaluating performance on  test set...
12066/12066 - 588s - 588s/epoch - 49ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0895557
{'0': {'precision': 0.24149586454649252, 'recall': 0.0894961511817362, 'f1-score': 0.1305949955056497, 'support': 775173}, '1': {'precision': 0.48680110688512995, 'recall': 0.6623368119610092, 'f1-score': 0.561162046618632, 'support': 1496663}, '2': {'precision': 0.2689627233820118, 'recall': 0.251916142598708, 'f1-score': 0.2601604948961309, 'support': 817006}, 'accuracy': 0.4100200010230371, 'macro avg': {'precision': 0.33241989827121143, 'recall': 0.3345830352471511, 'f1-score': 0.31730584567347087, 'support': 3088842}, 'weighted avg': {'precision': 0.3676207580774806, 'recall': 0.4100200010230371, 'f1-score': 0.3734917072231571, 'support': 3088842}}
[[ 69375 509008 196790]
 [142750 991295 362618]
 [ 75147 536042 205817]]
Evaluating performance on  train set...
2948/2948 - 154s - 154s/epoch - 52ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1078242
{'0': {'precision': 0.3380092600561111, 'recall': 0.07800378936831945, 'f1-score': 0.12675565423938862, 'support': 251757}, '1': {'precision': 0.3270485590147537, 'recall': 0.6699334896712901, 'f1-score': 0.43952803908852944, 'support': 249886}, '2': {'precision': 0.3273300778815355, 'recall': 0.23887137664679894, 'f1-score': 0.27619069395221213, 'support': 252839}, 'accuracy': 0.32796143579303416, 'macro avg': {'precision': 0.3307959656508001, 'recall': 0.3289362185621361, 'f1-score': 0.2808247957600434, 'support': 754482}, 'weighted avg': {'precision': 0.3308002882287406, 'recall': 0.32796143579303416, 'f1-score': 0.2804245902330412, 'support': 754482}}
[[ 19638 171902  60217]
 [ 18581 167407  63898]
 [ 19880 172563  60396]]
Evaluating performance on  val set...
697/697 - 33s - 33s/epoch - 47ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055943
{'0': {'precision': 0.3314987065881446, 'recall': 0.10177768765419581, 'f1-score': 0.1557397184118324, 'support': 59178}, '1': {'precision': 0.3559887800487596, 'recall': 0.6476582620584401, 'f1-score': 0.4594425428975816, 'support': 62902}, '2': {'precision': 0.3243798043326345, 'recall': 0.2637428977272727, 'f1-score': 0.29093544343466, 'support': 56320}, 'accuracy': 0.34538116591928253, 'macro avg': {'precision': 0.33728909698984627, 'recall': 0.33772628247996955, 'f1-score': 0.30203923491469137, 'support': 178400}, 'weighted avg': {'precision': 0.3378862515757527, 'recall': 0.34538116591928253, 'f1-score': 0.3055028254695019, 'support': 178400}}
[[ 6023 37715 15440]
 [ 6665 40739 15498]
 [ 5481 35985 14854]]
training model: results/ATVI/W1/deepLOB_L2/h1000
Epoch 1/50
2948/2948 - 311s - loss: 3.2516 - accuracy1000: 0.4007 - val_loss: 3.3805 - val_accuracy1000: 0.3575 - 311s/epoch - 105ms/step
Epoch 2/50
2948/2948 - 298s - loss: 3.1717 - accuracy1000: 0.4392 - val_loss: 3.4348 - val_accuracy1000: 0.3450 - 298s/epoch - 101ms/step
Epoch 3/50
2948/2948 - 307s - loss: 3.1470 - accuracy1000: 0.4478 - val_loss: 3.5027 - val_accuracy1000: 0.3341 - 307s/epoch - 104ms/step
Epoch 4/50
2948/2948 - 300s - loss: 3.1230 - accuracy1000: 0.4596 - val_loss: 3.6152 - val_accuracy1000: 0.3326 - 300s/epoch - 102ms/step
Epoch 5/50
2948/2948 - 297s - loss: 3.1086 - accuracy1000: 0.4649 - val_loss: 3.5952 - val_accuracy1000: 0.3309 - 297s/epoch - 101ms/step
Epoch 6/50
2948/2948 - 295s - loss: 3.0971 - accuracy1000: 0.4683 - val_loss: 3.5650 - val_accuracy1000: 0.3364 - 295s/epoch - 100ms/step
Epoch 7/50
2948/2948 - 303s - loss: 3.0856 - accuracy1000: 0.4719 - val_loss: 3.5823 - val_accuracy1000: 0.3345 - 303s/epoch - 103ms/step
Epoch 8/50
2948/2948 - 297s - loss: 3.0779 - accuracy1000: 0.4741 - val_loss: 3.5431 - val_accuracy1000: 0.3325 - 297s/epoch - 101ms/step
Epoch 9/50
2948/2948 - 295s - loss: 3.0702 - accuracy1000: 0.4764 - val_loss: 3.6086 - val_accuracy1000: 0.3353 - 295s/epoch - 100ms/step
Epoch 10/50
2948/2948 - 293s - loss: 3.0633 - accuracy1000: 0.4787 - val_loss: 3.6033 - val_accuracy1000: 0.3327 - 293s/epoch - 99ms/step
Epoch 11/50
2948/2948 - 295s - loss: 3.0550 - accuracy1000: 0.4822 - val_loss: 3.6920 - val_accuracy1000: 0.3338 - 295s/epoch - 100ms/step
testing model: results/ATVI/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
12066/12066 - 582s - 582s/epoch - 48ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1352872
{'0': {'precision': 0.29637161334623013, 'recall': 0.1864651971856583, 'f1-score': 0.22890960306841268, 'support': 962925}, '1': {'precision': 0.34942541280817774, 'recall': 0.6932574891082659, 'f1-score': 0.46465091902586675, 'support': 1080636}, '2': {'precision': 0.3549260546139915, 'recall': 0.11511928371414003, 'f1-score': 0.17385060481176612, 'support': 1045281}, 'accuracy': 0.33962339284430865, 'macro avg': {'precision': 0.33357436025613313, 'recall': 0.3316139900026881, 'f1-score': 0.2891370423020152, 'support': 3088842}, 'weighted avg': {'precision': 0.33474770722159447, 'recall': 0.33962339284430865, 'f1-score': 0.29275178986666706, 'support': 3088842}}
[[179552 669023 114350]
 [227125 749159 104352]
 [199157 725792 120332]]
Evaluating performance on  train set...
2948/2948 - 140s - 140s/epoch - 48ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1290272
{'0': {'precision': 0.33104444262786453, 'recall': 0.09628881095325843, 'f1-score': 0.1491850937702422, 'support': 252345}, '1': {'precision': 0.3368774169807167, 'recall': 0.4112656735096628, 'f1-score': 0.3703733137305545, 'support': 249306}, '2': {'precision': 0.3351206576645688, 'recall': 0.4993414573371145, 'f1-score': 0.40107186311666276, 'support': 252831}, 'accuracy': 0.3354327869982319, 'macro avg': {'precision': 0.3343475057577166, 'recall': 0.3356319806000119, 'f1-score': 0.30687675687248644, 'support': 754482}, 'weighted avg': {'precision': 0.33433781348092284, 'recall': 0.3354327869982319, 'f1-score': 0.30668167307372524, 'support': 754482}}
[[ 24298 100173 127874]
 [ 24171 102531 122604]
 [ 24929 101653 126249]]
Evaluating performance on  val set...
697/697 - 34s - 34s/epoch - 49ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1274793
{'0': {'precision': 0.32358782272053094, 'recall': 0.2190419467370033, 'f1-score': 0.26124370839421984, 'support': 58765}, '1': {'precision': 0.37453960796834557, 'recall': 0.5184518735991414, 'f1-score': 0.4348994710395827, 'support': 63354}, '2': {'precision': 0.3571596889482366, 'recall': 0.3231641228833887, 'f1-score': 0.3393125320647358, 'support': 56281}, 'accuracy': 0.35821748878923765, 'macro avg': {'precision': 0.35176237321237097, 'recall': 0.35355264773984446, 'f1-score': 0.3451519038328461, 'support': 178400}, 'weighted avg': {'precision': 0.3522731232012011, 'recall': 0.35821748878923765, 'f1-score': 0.34754179500652155, 'support': 178400}}
[[12872 28791 17102]
 [14874 32846 15634]
 [12033 26060 18188]]
training model: results/ATVI/W1/deepOF_L2/h10
Epoch 1/50
2948/2948 - 226s - loss: 2.7370 - accuracy10: 0.5383 - val_loss: 2.4707 - val_accuracy10: 0.7205 - 226s/epoch - 77ms/step
Epoch 2/50
2948/2948 - 226s - loss: 2.5182 - accuracy10: 0.6010 - val_loss: 2.3644 - val_accuracy10: 0.7009 - 226s/epoch - 77ms/step
Epoch 3/50
2948/2948 - 222s - loss: 2.4760 - accuracy10: 0.6072 - val_loss: 2.3147 - val_accuracy10: 0.6902 - 222s/epoch - 75ms/step
Epoch 4/50
2948/2948 - 213s - loss: 2.4549 - accuracy10: 0.6092 - val_loss: 2.3054 - val_accuracy10: 0.6897 - 213s/epoch - 72ms/step
Epoch 5/50
2948/2948 - 211s - loss: 2.4414 - accuracy10: 0.6106 - val_loss: 2.2976 - val_accuracy10: 0.7004 - 211s/epoch - 72ms/step
Epoch 6/50
2948/2948 - 216s - loss: 2.4300 - accuracy10: 0.6113 - val_loss: 2.2875 - val_accuracy10: 0.6958 - 216s/epoch - 73ms/step
Epoch 7/50
2948/2948 - 216s - loss: 2.4199 - accuracy10: 0.6128 - val_loss: 2.2898 - val_accuracy10: 0.6984 - 216s/epoch - 73ms/step
Epoch 8/50
2948/2948 - 220s - loss: 2.4127 - accuracy10: 0.6130 - val_loss: 2.2725 - val_accuracy10: 0.6956 - 220s/epoch - 75ms/step
Epoch 9/50
2948/2948 - 212s - loss: 2.4059 - accuracy10: 0.6142 - val_loss: 2.2753 - val_accuracy10: 0.7038 - 212s/epoch - 72ms/step
Epoch 10/50
2948/2948 - 222s - loss: 2.3979 - accuracy10: 0.6148 - val_loss: 2.2686 - val_accuracy10: 0.6968 - 222s/epoch - 75ms/step
Epoch 11/50
2948/2948 - 210s - loss: 2.3926 - accuracy10: 0.6155 - val_loss: 2.2612 - val_accuracy10: 0.6974 - 210s/epoch - 71ms/step
Epoch 12/50
2948/2948 - 219s - loss: 2.3867 - accuracy10: 0.6169 - val_loss: 2.2657 - val_accuracy10: 0.7050 - 219s/epoch - 74ms/step
Epoch 13/50
2948/2948 - 222s - loss: 2.3815 - accuracy10: 0.6171 - val_loss: 2.2547 - val_accuracy10: 0.7003 - 222s/epoch - 75ms/step
Epoch 14/50
2948/2948 - 220s - loss: 2.3774 - accuracy10: 0.6174 - val_loss: 2.2593 - val_accuracy10: 0.7001 - 220s/epoch - 75ms/step
Epoch 15/50
2948/2948 - 225s - loss: 2.3711 - accuracy10: 0.6183 - val_loss: 2.2507 - val_accuracy10: 0.6955 - 225s/epoch - 76ms/step
Epoch 16/50
2948/2948 - 221s - loss: 2.3658 - accuracy10: 0.6189 - val_loss: 2.2488 - val_accuracy10: 0.6986 - 221s/epoch - 75ms/step
Epoch 17/50
2948/2948 - 221s - loss: 2.3614 - accuracy10: 0.6187 - val_loss: 2.2434 - val_accuracy10: 0.6979 - 221s/epoch - 75ms/step
Epoch 18/50
2948/2948 - 219s - loss: 2.3563 - accuracy10: 0.6194 - val_loss: 2.2361 - val_accuracy10: 0.6917 - 219s/epoch - 74ms/step
Epoch 19/50
2948/2948 - 219s - loss: 2.3515 - accuracy10: 0.6198 - val_loss: 2.2421 - val_accuracy10: 0.6934 - 219s/epoch - 74ms/step
Epoch 20/50
2948/2948 - 216s - loss: 2.3467 - accuracy10: 0.6199 - val_loss: 2.2350 - val_accuracy10: 0.6918 - 216s/epoch - 73ms/step
Epoch 21/50
2948/2948 - 224s - loss: 2.3425 - accuracy10: 0.6207 - val_loss: 2.2356 - val_accuracy10: 0.6947 - 224s/epoch - 76ms/step
Epoch 22/50
2948/2948 - 221s - loss: 2.3392 - accuracy10: 0.6210 - val_loss: 2.2344 - val_accuracy10: 0.6900 - 221s/epoch - 75ms/step
Epoch 23/50
2948/2948 - 229s - loss: 2.3337 - accuracy10: 0.6218 - val_loss: 2.2270 - val_accuracy10: 0.6927 - 229s/epoch - 78ms/step
Epoch 24/50
2948/2948 - 224s - loss: 2.3324 - accuracy10: 0.6213 - val_loss: 2.2352 - val_accuracy10: 0.6880 - 224s/epoch - 76ms/step
Epoch 25/50
2948/2948 - 230s - loss: 2.3279 - accuracy10: 0.6220 - val_loss: 2.2276 - val_accuracy10: 0.6846 - 230s/epoch - 78ms/step
Epoch 26/50
2948/2948 - 233s - loss: 2.3241 - accuracy10: 0.6223 - val_loss: 2.2331 - val_accuracy10: 0.6896 - 233s/epoch - 79ms/step
Epoch 27/50
2948/2948 - 225s - loss: 2.3214 - accuracy10: 0.6227 - val_loss: 2.2314 - val_accuracy10: 0.6835 - 225s/epoch - 76ms/step
Epoch 28/50
2948/2948 - 220s - loss: 2.3172 - accuracy10: 0.6231 - val_loss: 2.2369 - val_accuracy10: 0.6794 - 220s/epoch - 75ms/step
Epoch 29/50
2948/2948 - 226s - loss: 2.3134 - accuracy10: 0.6234 - val_loss: 2.2390 - val_accuracy10: 0.6806 - 226s/epoch - 77ms/step
Epoch 30/50
2948/2948 - 219s - loss: 2.3107 - accuracy10: 0.6235 - val_loss: 2.2337 - val_accuracy10: 0.6837 - 219s/epoch - 74ms/step
Epoch 31/50
2948/2948 - 214s - loss: 2.3070 - accuracy10: 0.6245 - val_loss: 2.2347 - val_accuracy10: 0.6823 - 214s/epoch - 73ms/step
Epoch 32/50
2948/2948 - 218s - loss: 2.3039 - accuracy10: 0.6246 - val_loss: 2.2317 - val_accuracy10: 0.6838 - 218s/epoch - 74ms/step
Epoch 33/50
2948/2948 - 220s - loss: 2.3014 - accuracy10: 0.6246 - val_loss: 2.2389 - val_accuracy10: 0.6800 - 220s/epoch - 74ms/step
testing model: results/ATVI/W1/deepOF_L2/h10
Evaluating performance on  test set...
12066/12066 - 428s - 428s/epoch - 35ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72281665
{'0': {'precision': 0.44179708935430767, 'recall': 0.5854574445521755, 'f1-score': 0.5035818999218139, 'support': 528064}, '1': {'precision': 0.8308182071312215, 'recall': 0.7451362097240412, 'f1-score': 0.7856480152094881, 'support': 2034216}, '2': {'precision': 0.48111959449766484, 'recall': 0.515909958466035, 'f1-score': 0.49790778874439834, 'support': 526557}, 'accuracy': 0.6787612942994402, 'macro avg': {'precision': 0.584578296994398, 'recall': 0.6155012042474173, 'f1-score': 0.5957125679585668, 'support': 3088837}, 'weighted avg': {'precision': 0.7046981496758634, 'recall': 0.6787612942994402, 'f1-score': 0.6883749666381169, 'support': 3088837}}
[[ 309159  146442   72463]
 [ 297934 1515768  220514]
 [  92683  162218  271656]]
Evaluating performance on  train set...
2948/2948 - 106s - 106s/epoch - 36ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7698322
{'0': {'precision': 0.4234990532683188, 'recall': 0.5926557028514257, 'f1-score': 0.4939978434585452, 'support': 127936}, '1': {'precision': 0.8347934103572204, 'recall': 0.6914486183893762, 'f1-score': 0.7563895363385927, 'support': 500539}, '2': {'precision': 0.4374553163447371, 'recall': 0.5584381572159834, 'f1-score': 0.4905981356629412, 'support': 126005}, 'accuracy': 0.652482504506415, 'macro avg': {'precision': 0.5652492599900921, 'recall': 0.6141808261522618, 'f1-score': 0.5803285051533597, 'support': 754480}, 'weighted avg': {'precision': 0.6986918020911714, 'recall': 0.652482504506415, 'f1-score': 0.667506611592493, 'support': 754480}}
[[ 75822  34241  17873]
 [ 81828 346097  72614]
 [ 21387  34252  70366]]
Evaluating performance on  val set...
697/697 - 24s - 24s/epoch - 34ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70381796
{'0': {'precision': 0.40768621236133123, 'recall': 0.5618126511192575, 'f1-score': 0.4724982780674998, 'support': 25642}, '1': {'precision': 0.854512645054091, 'recall': 0.7494652553063127, 'f1-score': 0.7985490791912243, 'support': 127631}, '2': {'precision': 0.43485525174308387, 'recall': 0.5386237911410037, 'f1-score': 0.48120888888888885, 'support': 25127}, 'accuracy': 0.6927970852017937, 'macro avg': {'precision': 0.5656847030528354, 'recall': 0.6166338991888579, 'f1-score': 0.5840854153825377, 'support': 178400}, 'weighted avg': {'precision': 0.7311816209014372, 'recall': 0.6927970852017937, 'f1-score': 0.7069885320828088, 'support': 178400}}
[[14406  7958  3278]
 [17665 95655 14311]
 [ 3265  8328 13534]]
training model: results/ATVI/W1/deepOF_L2/h20
Epoch 1/50
2948/2948 - 230s - loss: 2.8150 - accuracy20: 0.5363 - val_loss: 2.6292 - val_accuracy20: 0.6603 - 230s/epoch - 78ms/step
Epoch 2/50
2948/2948 - 224s - loss: 2.6141 - accuracy20: 0.5903 - val_loss: 2.5137 - val_accuracy20: 0.6534 - 224s/epoch - 76ms/step
Epoch 3/50
2948/2948 - 217s - loss: 2.5746 - accuracy20: 0.5985 - val_loss: 2.4786 - val_accuracy20: 0.6502 - 217s/epoch - 74ms/step
Epoch 4/50
2948/2948 - 224s - loss: 2.5558 - accuracy20: 0.6006 - val_loss: 2.4635 - val_accuracy20: 0.6540 - 224s/epoch - 76ms/step
Epoch 5/50
2948/2948 - 225s - loss: 2.5431 - accuracy20: 0.6022 - val_loss: 2.4626 - val_accuracy20: 0.6553 - 225s/epoch - 76ms/step
Epoch 6/50
2948/2948 - 222s - loss: 2.5325 - accuracy20: 0.6033 - val_loss: 2.4594 - val_accuracy20: 0.6525 - 222s/epoch - 75ms/step
Epoch 7/50
2948/2948 - 222s - loss: 2.5235 - accuracy20: 0.6049 - val_loss: 2.4422 - val_accuracy20: 0.6541 - 222s/epoch - 75ms/step
Epoch 8/50
2948/2948 - 226s - loss: 2.5162 - accuracy20: 0.6060 - val_loss: 2.4351 - val_accuracy20: 0.6555 - 226s/epoch - 77ms/step
Epoch 9/50
2948/2948 - 220s - loss: 2.5100 - accuracy20: 0.6065 - val_loss: 2.4497 - val_accuracy20: 0.6590 - 220s/epoch - 75ms/step
Epoch 10/50
2948/2948 - 218s - loss: 2.5032 - accuracy20: 0.6075 - val_loss: 2.4442 - val_accuracy20: 0.6588 - 218s/epoch - 74ms/step
Epoch 11/50
2948/2948 - 226s - loss: 2.4984 - accuracy20: 0.6085 - val_loss: 2.4306 - val_accuracy20: 0.6590 - 226s/epoch - 77ms/step
Epoch 12/50
2948/2948 - 213s - loss: 2.4930 - accuracy20: 0.6092 - val_loss: 2.4250 - val_accuracy20: 0.6597 - 213s/epoch - 72ms/step
Epoch 13/50
2948/2948 - 227s - loss: 2.4875 - accuracy20: 0.6097 - val_loss: 2.4253 - val_accuracy20: 0.6615 - 227s/epoch - 77ms/step
Epoch 14/50
2948/2948 - 221s - loss: 2.4832 - accuracy20: 0.6106 - val_loss: 2.4221 - val_accuracy20: 0.6640 - 221s/epoch - 75ms/step
Epoch 15/50
2948/2948 - 208s - loss: 2.4784 - accuracy20: 0.6112 - val_loss: 2.4210 - val_accuracy20: 0.6616 - 208s/epoch - 71ms/step
Epoch 16/50
2948/2948 - 221s - loss: 2.4742 - accuracy20: 0.6119 - val_loss: 2.4095 - val_accuracy20: 0.6629 - 221s/epoch - 75ms/step
Epoch 17/50
2948/2948 - 218s - loss: 2.4702 - accuracy20: 0.6117 - val_loss: 2.4108 - val_accuracy20: 0.6631 - 218s/epoch - 74ms/step
Epoch 18/50
2948/2948 - 222s - loss: 2.4652 - accuracy20: 0.6129 - val_loss: 2.4044 - val_accuracy20: 0.6613 - 222s/epoch - 75ms/step
Epoch 19/50
2948/2948 - 217s - loss: 2.4614 - accuracy20: 0.6131 - val_loss: 2.3980 - val_accuracy20: 0.6579 - 217s/epoch - 74ms/step
Epoch 20/50
2948/2948 - 220s - loss: 2.4571 - accuracy20: 0.6139 - val_loss: 2.4138 - val_accuracy20: 0.6585 - 220s/epoch - 75ms/step
Epoch 21/50
2948/2948 - 224s - loss: 2.4533 - accuracy20: 0.6145 - val_loss: 2.3978 - val_accuracy20: 0.6565 - 224s/epoch - 76ms/step
Epoch 22/50
2948/2948 - 214s - loss: 2.4493 - accuracy20: 0.6151 - val_loss: 2.4003 - val_accuracy20: 0.6567 - 214s/epoch - 73ms/step
Epoch 23/50
2948/2948 - 216s - loss: 2.4452 - accuracy20: 0.6154 - val_loss: 2.4007 - val_accuracy20: 0.6560 - 216s/epoch - 73ms/step
Epoch 24/50
2948/2948 - 220s - loss: 2.4418 - accuracy20: 0.6161 - val_loss: 2.4040 - val_accuracy20: 0.6569 - 220s/epoch - 75ms/step
Epoch 25/50
2948/2948 - 211s - loss: 2.4383 - accuracy20: 0.6167 - val_loss: 2.4052 - val_accuracy20: 0.6568 - 211s/epoch - 72ms/step
Epoch 26/50
2948/2948 - 226s - loss: 2.4345 - accuracy20: 0.6168 - val_loss: 2.4112 - val_accuracy20: 0.6569 - 226s/epoch - 77ms/step
Epoch 27/50
2948/2948 - 219s - loss: 2.4327 - accuracy20: 0.6171 - val_loss: 2.4054 - val_accuracy20: 0.6565 - 219s/epoch - 74ms/step
Epoch 28/50
2948/2948 - 224s - loss: 2.4284 - accuracy20: 0.6181 - val_loss: 2.4134 - val_accuracy20: 0.6571 - 224s/epoch - 76ms/step
Epoch 29/50
2948/2948 - 223s - loss: 2.4259 - accuracy20: 0.6182 - val_loss: 2.4148 - val_accuracy20: 0.6618 - 223s/epoch - 75ms/step
Epoch 30/50
2948/2948 - 231s - loss: 2.4221 - accuracy20: 0.6187 - val_loss: 2.4173 - val_accuracy20: 0.6555 - 231s/epoch - 78ms/step
Epoch 31/50
2948/2948 - 223s - loss: 2.4195 - accuracy20: 0.6194 - val_loss: 2.4134 - val_accuracy20: 0.6557 - 223s/epoch - 76ms/step
testing model: results/ATVI/W1/deepOF_L2/h20
Evaluating performance on  test set...
12066/12066 - 453s - 453s/epoch - 38ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7973402
{'0': {'precision': 0.5104194674002003, 'recall': 0.49989221035330406, 'f1-score': 0.5051009928607296, 'support': 691161}, '1': {'precision': 0.7229883714791797, 'recall': 0.7528755462192737, 'f1-score': 0.7376293417843222, 'support': 1709936}, '2': {'precision': 0.5287331560297731, 'recall': 0.48534911449094137, 'f1-score': 0.5061131163436688, 'support': 687740}, 'accuracy': 0.6367020985568355, 'macro avg': {'precision': 0.5873803316363843, 'recall': 0.5793722903545063, 'f1-score': 0.5829478169962402, 'support': 3088837}, 'weighted avg': {'precision': 0.6321721781399694, 'recall': 0.6367020985568355, 'f1-score': 0.6340507149241368, 'support': 3088837}}
[[ 345506  236910  108745]
 [ 233797 1287369  188770]
 [  97603  256343  333794]]
Evaluating performance on  train set...
2948/2948 - 106s - 106s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.819586
{'0': {'precision': 0.5033244225101103, 'recall': 0.5162371330314197, 'f1-score': 0.5096990082630287, 'support': 170689}, '1': {'precision': 0.7293691416950893, 'recall': 0.7113378984992719, 'f1-score': 0.7202406846205306, 'support': 415465}, '2': {'precision': 0.5012168662250743, 'recall': 0.51876121335979, 'f1-score': 0.5098381521789902, 'support': 168326}, 'accuracy': 0.6242352348637472, 'macro avg': {'precision': 0.577970143476758, 'recall': 0.5821120816301605, 'f1-score': 0.5799259483541831, 'support': 754480}, 'weighted avg': {'precision': 0.6273289192985637, 'recall': 0.6242352348637472, 'f1-score': 0.6256677802737747, 'support': 754480}}
[[ 88116  54412  28161]
 [ 61193 295536  58736]
 [ 25759  55246  87321]]
Evaluating performance on  val set...
697/697 - 26s - 26s/epoch - 37ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.772486
{'0': {'precision': 0.48467830194113243, 'recall': 0.48824997098758266, 'f1-score': 0.48645758057522764, 'support': 34468}, '1': {'precision': 0.7617284622783616, 'recall': 0.762129575828007, 'f1-score': 0.7619289662621513, 'support': 110144}, '2': {'precision': 0.4902616800095591, 'recall': 0.4857345803243755, 'f1-score': 0.48798763082778307, 'support': 33788}, 'accuracy': 0.6568665919282511, 'macro avg': {'precision': 0.5788894814096844, 'recall': 0.578704709046655, 'f1-score': 0.578791392555054, 'support': 178400}, 'weighted avg': {'precision': 0.6567862842189338, 'recall': 0.6568665919282511, 'f1-score': 0.6568231503231753, 'support': 178400}}
[[16829 12860  4779]
 [13915 83944 12285]
 [ 3978 13398 16412]]
training model: results/ATVI/W1/deepOF_L2/h30
Epoch 1/50
2948/2948 - 241s - loss: 2.8796 - accuracy30: 0.5261 - val_loss: 2.7109 - val_accuracy30: 0.6162 - 241s/epoch - 82ms/step
Epoch 2/50
2948/2948 - 232s - loss: 2.6947 - accuracy30: 0.5744 - val_loss: 2.6661 - val_accuracy30: 0.6148 - 232s/epoch - 79ms/step
Epoch 3/50
2948/2948 - 228s - loss: 2.6628 - accuracy30: 0.5807 - val_loss: 2.6292 - val_accuracy30: 0.6111 - 228s/epoch - 77ms/step
Epoch 4/50
2948/2948 - 230s - loss: 2.6464 - accuracy30: 0.5819 - val_loss: 2.6526 - val_accuracy30: 0.6007 - 230s/epoch - 78ms/step
Epoch 5/50
2948/2948 - 226s - loss: 2.6349 - accuracy30: 0.5840 - val_loss: 2.6325 - val_accuracy30: 0.6055 - 226s/epoch - 77ms/step
Epoch 6/50
2948/2948 - 238s - loss: 2.6258 - accuracy30: 0.5850 - val_loss: 2.6014 - val_accuracy30: 0.6051 - 238s/epoch - 81ms/step
Epoch 7/50
2948/2948 - 220s - loss: 2.6182 - accuracy30: 0.5867 - val_loss: 2.6058 - val_accuracy30: 0.6051 - 220s/epoch - 74ms/step
Epoch 8/50
2948/2948 - 237s - loss: 2.6118 - accuracy30: 0.5876 - val_loss: 2.6156 - val_accuracy30: 0.5984 - 237s/epoch - 80ms/step
Epoch 9/50
2948/2948 - 225s - loss: 2.6062 - accuracy30: 0.5889 - val_loss: 2.6061 - val_accuracy30: 0.6026 - 225s/epoch - 76ms/step
Epoch 10/50
2948/2948 - 236s - loss: 2.6002 - accuracy30: 0.5894 - val_loss: 2.6020 - val_accuracy30: 0.6052 - 236s/epoch - 80ms/step
Epoch 11/50
2948/2948 - 229s - loss: 2.5959 - accuracy30: 0.5905 - val_loss: 2.6066 - val_accuracy30: 0.6033 - 229s/epoch - 78ms/step
Epoch 12/50
2948/2948 - 238s - loss: 2.5910 - accuracy30: 0.5913 - val_loss: 2.6021 - val_accuracy30: 0.6029 - 238s/epoch - 81ms/step
Epoch 13/50
2948/2948 - 232s - loss: 2.5863 - accuracy30: 0.5921 - val_loss: 2.5985 - val_accuracy30: 0.6019 - 232s/epoch - 79ms/step
Epoch 14/50
2948/2948 - 235s - loss: 2.5825 - accuracy30: 0.5926 - val_loss: 2.5809 - val_accuracy30: 0.6047 - 235s/epoch - 80ms/step
Epoch 15/50
2948/2948 - 233s - loss: 2.5776 - accuracy30: 0.5934 - val_loss: 2.5719 - val_accuracy30: 0.6079 - 233s/epoch - 79ms/step
Epoch 16/50
2948/2948 - 234s - loss: 2.5735 - accuracy30: 0.5939 - val_loss: 2.5749 - val_accuracy30: 0.6063 - 234s/epoch - 79ms/step
Epoch 17/50
2948/2948 - 237s - loss: 2.5699 - accuracy30: 0.5947 - val_loss: 2.5792 - val_accuracy30: 0.6065 - 237s/epoch - 80ms/step
Epoch 18/50
2948/2948 - 230s - loss: 2.5656 - accuracy30: 0.5955 - val_loss: 2.5666 - val_accuracy30: 0.6068 - 230s/epoch - 78ms/step
Epoch 19/50
2948/2948 - 236s - loss: 2.5626 - accuracy30: 0.5959 - val_loss: 2.5737 - val_accuracy30: 0.6041 - 236s/epoch - 80ms/step
Epoch 20/50
2948/2948 - 242s - loss: 2.5574 - accuracy30: 0.5967 - val_loss: 2.5713 - val_accuracy30: 0.6043 - 242s/epoch - 82ms/step
Epoch 21/50
2948/2948 - 242s - loss: 2.5541 - accuracy30: 0.5969 - val_loss: 2.5662 - val_accuracy30: 0.6042 - 242s/epoch - 82ms/step
Epoch 22/50
2948/2948 - 232s - loss: 2.5498 - accuracy30: 0.5980 - val_loss: 2.5702 - val_accuracy30: 0.6032 - 232s/epoch - 79ms/step
Epoch 23/50
2948/2948 - 238s - loss: 2.5455 - accuracy30: 0.5987 - val_loss: 2.5627 - val_accuracy30: 0.6061 - 238s/epoch - 81ms/step
Epoch 24/50
2948/2948 - 231s - loss: 2.5414 - accuracy30: 0.5991 - val_loss: 2.5691 - val_accuracy30: 0.6024 - 231s/epoch - 78ms/step
Epoch 25/50
2948/2948 - 236s - loss: 2.5387 - accuracy30: 0.5996 - val_loss: 2.5694 - val_accuracy30: 0.6040 - 236s/epoch - 80ms/step
Epoch 26/50
2948/2948 - 237s - loss: 2.5349 - accuracy30: 0.6003 - val_loss: 2.5702 - val_accuracy30: 0.6014 - 237s/epoch - 81ms/step
Epoch 27/50
2948/2948 - 235s - loss: 2.5317 - accuracy30: 0.6005 - val_loss: 2.5761 - val_accuracy30: 0.6003 - 235s/epoch - 80ms/step
Epoch 28/50
2948/2948 - 237s - loss: 2.5276 - accuracy30: 0.6015 - val_loss: 2.5827 - val_accuracy30: 0.6010 - 237s/epoch - 81ms/step
Epoch 29/50
2948/2948 - 241s - loss: 2.5240 - accuracy30: 0.6015 - val_loss: 2.5718 - val_accuracy30: 0.6025 - 241s/epoch - 82ms/step
Epoch 30/50
2948/2948 - 239s - loss: 2.5204 - accuracy30: 0.6022 - val_loss: 2.5864 - val_accuracy30: 0.6010 - 239s/epoch - 81ms/step
Epoch 31/50
2948/2948 - 237s - loss: 2.5171 - accuracy30: 0.6027 - val_loss: 2.5791 - val_accuracy30: 0.6004 - 237s/epoch - 80ms/step
Epoch 32/50
2948/2948 - 241s - loss: 2.5138 - accuracy30: 0.6025 - val_loss: 2.5858 - val_accuracy30: 0.6053 - 241s/epoch - 82ms/step
Epoch 33/50
2948/2948 - 236s - loss: 2.5100 - accuracy30: 0.6033 - val_loss: 2.5863 - val_accuracy30: 0.5985 - 236s/epoch - 80ms/step
testing model: results/ATVI/W1/deepOF_L2/h30
Evaluating performance on  test set...
12066/12066 - 448s - 448s/epoch - 37ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8646499
{'0': {'precision': 0.530124287361223, 'recall': 0.45653300099281785, 'f1-score': 0.49058418696108524, 'support': 808809}, '1': {'precision': 0.6437531845143676, 'recall': 0.7251616789568619, 'f1-score': 0.682036776096524, 'support': 1477465}, '2': {'precision': 0.5300493679962418, 'recall': 0.480805868199755, 'f1-score': 0.5042281771764022, 'support': 802563}, 'accuracy': 0.5913313004214855, 'macro avg': {'precision': 0.5679756132906109, 'recall': 0.554166849383145, 'f1-score': 0.5589497134113371, 'support': 3088837}, 'weighted avg': {'precision': 0.5844562547075263, 'recall': 0.5913313004214855, 'f1-score': 0.5857056392507873, 'support': 3088837}}
[[ 369248  298808  140753]
 [ 204692 1071401  201372]
 [ 122591  294095  385877]]
Evaluating performance on  train set...
2948/2948 - 96s - 96s/epoch - 33ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8716882
{'0': {'precision': 0.5312212706920664, 'recall': 0.4781324440209624, 'f1-score': 0.5032807048104687, 'support': 199405}, '1': {'precision': 0.6565262048274184, 'recall': 0.6788417251710415, 'f1-score': 0.6674975061076318, 'support': 357808}, '2': {'precision': 0.5102007969448821, 'recall': 0.5302863631524786, 'f1-score': 0.5200497141436738, 'support': 197267}, 'accuracy': 0.5869539285335595, 'macro avg': {'precision': 0.5659827574881223, 'recall': 0.5624201774481609, 'f1-score': 0.5636093083539248, 'support': 754480}, 'weighted avg': {'precision': 0.5851504166978138, 'recall': 0.5869539285335595, 'f1-score': 0.5855440615630252, 'support': 754480}}
[[ 95342  65619  38444]
 [ 52932 242895  61981]
 [ 31203  61456 104608]]
Evaluating performance on  val set...
697/697 - 25s - 25s/epoch - 36ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84573245
{'0': {'precision': 0.5039798097456805, 'recall': 0.4441077276504228, 'f1-score': 0.4721532965248457, 'support': 40918}, '1': {'precision': 0.689375697421742, 'recall': 0.7226423419078792, 'f1-score': 0.7056171444888064, 'support': 97459}, '2': {'precision': 0.48664791817027947, 'recall': 0.4885690727831497, 'f1-score': 0.48760660316193705, 'support': 40023}, 'accuracy': 0.6062443946188341, 'macro avg': {'precision': 0.560001141779234, 'recall': 0.5517730474471506, 'f1-score': 0.555125681391863, 'support': 178400}, 'weighted avg': {'precision': 0.601372318268657, 'recall': 0.6062443946188341, 'f1-score': 0.6031602519635002, 'support': 178400}}
[[18172 16250  6496]
 [12900 70428 14131]
 [ 4985 15484 19554]]
training model: results/ATVI/W1/deepOF_L2/h50
Epoch 1/50
2948/2948 - 243s - loss: 2.9849 - accuracy50: 0.4974 - val_loss: 2.9330 - val_accuracy50: 0.5281 - 243s/epoch - 83ms/step
Epoch 2/50
2948/2948 - 233s - loss: 2.8414 - accuracy50: 0.5326 - val_loss: 2.8710 - val_accuracy50: 0.5400 - 233s/epoch - 79ms/step
Epoch 3/50
2948/2948 - 231s - loss: 2.8084 - accuracy50: 0.5394 - val_loss: 2.8514 - val_accuracy50: 0.5439 - 231s/epoch - 78ms/step
Epoch 4/50
2948/2948 - 237s - loss: 2.7938 - accuracy50: 0.5425 - val_loss: 2.8534 - val_accuracy50: 0.5437 - 237s/epoch - 80ms/step
Epoch 5/50
2948/2948 - 231s - loss: 2.7829 - accuracy50: 0.5451 - val_loss: 2.8461 - val_accuracy50: 0.5431 - 231s/epoch - 78ms/step
Epoch 6/50
2948/2948 - 235s - loss: 2.7747 - accuracy50: 0.5468 - val_loss: 2.8488 - val_accuracy50: 0.5410 - 235s/epoch - 80ms/step
Epoch 7/50
2948/2948 - 225s - loss: 2.7686 - accuracy50: 0.5487 - val_loss: 2.8374 - val_accuracy50: 0.5446 - 225s/epoch - 76ms/step
Epoch 8/50
2948/2948 - 231s - loss: 2.7632 - accuracy50: 0.5495 - val_loss: 2.8400 - val_accuracy50: 0.5418 - 231s/epoch - 78ms/step
Epoch 9/50
2948/2948 - 223s - loss: 2.7583 - accuracy50: 0.5505 - val_loss: 2.8350 - val_accuracy50: 0.5422 - 223s/epoch - 76ms/step
Epoch 10/50
2948/2948 - 229s - loss: 2.7534 - accuracy50: 0.5519 - val_loss: 2.8277 - val_accuracy50: 0.5433 - 229s/epoch - 78ms/step
Epoch 11/50
2948/2948 - 233s - loss: 2.7488 - accuracy50: 0.5525 - val_loss: 2.8442 - val_accuracy50: 0.5409 - 233s/epoch - 79ms/step
Epoch 12/50
2948/2948 - 228s - loss: 2.7447 - accuracy50: 0.5540 - val_loss: 2.8455 - val_accuracy50: 0.5409 - 228s/epoch - 77ms/step
Epoch 13/50
2948/2948 - 231s - loss: 2.7406 - accuracy50: 0.5552 - val_loss: 2.8520 - val_accuracy50: 0.5377 - 231s/epoch - 78ms/step
Epoch 14/50
2948/2948 - 226s - loss: 2.7370 - accuracy50: 0.5554 - val_loss: 2.8560 - val_accuracy50: 0.5357 - 226s/epoch - 77ms/step
Epoch 15/50
2948/2948 - 230s - loss: 2.7332 - accuracy50: 0.5561 - val_loss: 2.8665 - val_accuracy50: 0.5330 - 230s/epoch - 78ms/step
Epoch 16/50
2948/2948 - 230s - loss: 2.7292 - accuracy50: 0.5575 - val_loss: 2.8372 - val_accuracy50: 0.5399 - 230s/epoch - 78ms/step
Epoch 17/50
2948/2948 - 227s - loss: 2.7261 - accuracy50: 0.5581 - val_loss: 2.8486 - val_accuracy50: 0.5371 - 227s/epoch - 77ms/step
Epoch 18/50
2948/2948 - 239s - loss: 2.7223 - accuracy50: 0.5592 - val_loss: 2.8325 - val_accuracy50: 0.5409 - 239s/epoch - 81ms/step
Epoch 19/50
2948/2948 - 233s - loss: 2.7188 - accuracy50: 0.5597 - val_loss: 2.8575 - val_accuracy50: 0.5357 - 233s/epoch - 79ms/step
Epoch 20/50
2948/2948 - 239s - loss: 2.7150 - accuracy50: 0.5603 - val_loss: 2.8523 - val_accuracy50: 0.5363 - 239s/epoch - 81ms/step
testing model: results/ATVI/W1/deepOF_L2/h50
Evaluating performance on  test set...
12066/12066 - 459s - 459s/epoch - 38ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96599853
{'0': {'precision': 0.5701518372194923, 'recall': 0.3248976492340201, 'f1-score': 0.4139234632781209, 'support': 969216}, '1': {'precision': 0.4877733550905917, 'recall': 0.784807403554909, 'f1-score': 0.6016249070736606, 'support': 1157498}, '2': {'precision': 0.5576696016423206, 'recall': 0.39076396676932157, 'f1-score': 0.4595307313919101, 'support': 962123}, 'accuracy': 0.5177586256574885, 'macro avg': {'precision': 0.5385315979841349, 'recall': 0.5001563398527503, 'f1-score': 0.4916930339145639, 'support': 3088837}, 'weighted avg': {'precision': 0.5353936501583254, 'recall': 0.5177586256574885, 'f1-score': 0.49846785568532553, 'support': 3088837}}
[[314896 494877 159443]
 [110323 908413 138762]
 [127083 459077 375963]]
Evaluating performance on  train set...
2948/2948 - 109s - 109s/epoch - 37ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96029586
{'0': {'precision': 0.576014282462729, 'recall': 0.3408246320636003, 'f1-score': 0.42825375924442294, 'support': 237609}, '1': {'precision': 0.5024963582109878, 'recall': 0.7371996360846995, 'f1-score': 0.597630603166523, 'support': 280285}, '2': {'precision': 0.52840558688434, 'recall': 0.45269796184051464, 'f1-score': 0.487630755221672, 'support': 236586}, 'accuracy': 0.5231563460926731, 'macro avg': {'precision': 0.5356387425193523, 'recall': 0.5102407433296049, 'f1-score': 0.5045050392108726, 'support': 754480}, 'weighted avg': {'precision': 0.5337739020006783, 'recall': 0.5231563460926731, 'f1-score': 0.5097954232633224, 'support': 754480}}
[[ 80983 106866  49760]
 [ 27832 206626  45827]
 [ 31777  97707 107102]]
Evaluating performance on  val set...
697/697 - 25s - 25s/epoch - 36ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9364385
{'0': {'precision': 0.5648133748055988, 'recall': 0.2899948097576556, 'f1-score': 0.38322737225314585, 'support': 50094}, '1': {'precision': 0.5509333475829148, 'recall': 0.7773533218562686, 'f1-score': 0.644845540828612, 'support': 79579}, '2': {'precision': 0.5064115258936528, 'recall': 0.41982884232561, 'f1-score': 0.45907341539221075, 'support': 48727}, 'accuracy': 0.5428531390134529, 'macro avg': {'precision': 0.5407194160940555, 'recall': 0.49572565797984475, 'f1-score': 0.4957154428246562, 'support': 178400}, 'weighted avg': {'precision': 0.5426704063174466, 'recall': 0.5428531390134529, 'f1-score': 0.5206436412055239, 'support': 178400}}
[[14527 27045  8522]
 [ 6301 61861 11417]
 [ 4892 23378 20457]]
training model: results/ATVI/W1/deepOF_L2/h100
Epoch 1/50
2948/2948 - 242s - loss: 3.1713 - accuracy100: 0.4344 - val_loss: 3.1657 - val_accuracy100: 0.4327 - 242s/epoch - 82ms/step
Epoch 2/50
2948/2948 - 230s - loss: 3.1090 - accuracy100: 0.4577 - val_loss: 3.1382 - val_accuracy100: 0.4396 - 230s/epoch - 78ms/step
Epoch 3/50
2948/2948 - 236s - loss: 3.0876 - accuracy100: 0.4639 - val_loss: 3.1299 - val_accuracy100: 0.4450 - 236s/epoch - 80ms/step
Epoch 4/50
2948/2948 - 238s - loss: 3.0765 - accuracy100: 0.4666 - val_loss: 3.1323 - val_accuracy100: 0.4477 - 238s/epoch - 81ms/step
Epoch 5/50
2948/2948 - 228s - loss: 3.0692 - accuracy100: 0.4693 - val_loss: 3.1307 - val_accuracy100: 0.4480 - 228s/epoch - 77ms/step
Epoch 6/50
2948/2948 - 238s - loss: 3.0626 - accuracy100: 0.4711 - val_loss: 3.1326 - val_accuracy100: 0.4487 - 238s/epoch - 81ms/step
Epoch 7/50
2948/2948 - 231s - loss: 3.0584 - accuracy100: 0.4724 - val_loss: 3.1383 - val_accuracy100: 0.4484 - 231s/epoch - 78ms/step
Epoch 8/50
2948/2948 - 233s - loss: 3.0546 - accuracy100: 0.4739 - val_loss: 3.1367 - val_accuracy100: 0.4476 - 233s/epoch - 79ms/step
Epoch 9/50
2948/2948 - 232s - loss: 3.0510 - accuracy100: 0.4746 - val_loss: 3.1225 - val_accuracy100: 0.4530 - 232s/epoch - 79ms/step
Epoch 10/50
2948/2948 - 232s - loss: 3.0468 - accuracy100: 0.4758 - val_loss: 3.1174 - val_accuracy100: 0.4540 - 232s/epoch - 79ms/step
Epoch 11/50
2948/2948 - 225s - loss: 3.0436 - accuracy100: 0.4771 - val_loss: 3.1192 - val_accuracy100: 0.4539 - 225s/epoch - 76ms/step
Epoch 12/50
2948/2948 - 220s - loss: 3.0404 - accuracy100: 0.4779 - val_loss: 3.1160 - val_accuracy100: 0.4551 - 220s/epoch - 75ms/step
Epoch 13/50
2948/2948 - 227s - loss: 3.0366 - accuracy100: 0.4791 - val_loss: 3.1200 - val_accuracy100: 0.4542 - 227s/epoch - 77ms/step
Epoch 14/50
2948/2948 - 223s - loss: 3.0341 - accuracy100: 0.4802 - val_loss: 3.1277 - val_accuracy100: 0.4503 - 223s/epoch - 76ms/step
Epoch 15/50
2948/2948 - 225s - loss: 3.0315 - accuracy100: 0.4810 - val_loss: 3.1222 - val_accuracy100: 0.4508 - 225s/epoch - 76ms/step
Epoch 16/50
2948/2948 - 224s - loss: 3.0281 - accuracy100: 0.4823 - val_loss: 3.1306 - val_accuracy100: 0.4512 - 224s/epoch - 76ms/step
Epoch 17/50
2948/2948 - 231s - loss: 3.0250 - accuracy100: 0.4831 - val_loss: 3.1321 - val_accuracy100: 0.4480 - 231s/epoch - 78ms/step
Epoch 18/50
2948/2948 - 225s - loss: 3.0214 - accuracy100: 0.4846 - val_loss: 3.1292 - val_accuracy100: 0.4501 - 225s/epoch - 76ms/step
Epoch 19/50
2948/2948 - 229s - loss: 3.0181 - accuracy100: 0.4857 - val_loss: 3.1227 - val_accuracy100: 0.4511 - 229s/epoch - 78ms/step
Epoch 20/50
2948/2948 - 222s - loss: 3.0149 - accuracy100: 0.4864 - val_loss: 3.1245 - val_accuracy100: 0.4516 - 222s/epoch - 75ms/step
Epoch 21/50
2948/2948 - 224s - loss: 3.0119 - accuracy100: 0.4877 - val_loss: 3.1270 - val_accuracy100: 0.4509 - 224s/epoch - 76ms/step
Epoch 22/50
2948/2948 - 223s - loss: 3.0072 - accuracy100: 0.4889 - val_loss: 3.1269 - val_accuracy100: 0.4508 - 223s/epoch - 76ms/step
testing model: results/ATVI/W1/deepOF_L2/h100
Evaluating performance on  test set...
12066/12066 - 435s - 435s/epoch - 36ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0614383
{'0': {'precision': 0.47700802922870306, 'recall': 0.2651344279138088, 'f1-score': 0.3408274239606254, 'support': 996668}, '1': {'precision': 0.39983172770323644, 'recall': 0.6809387166062558, 'f1-score': 0.5038274407932244, 'support': 1072656}, '2': {'precision': 0.4800242917266898, 'recall': 0.3333807415893667, 'f1-score': 0.39348380647301157, 'support': 1019513}, 'accuracy': 0.43205581906717644, 'macro avg': {'precision': 0.4522880162195431, 'recall': 0.4264846287031438, 'f1-score': 0.4127128904089538, 'support': 3088837}, 'weighted avg': {'precision': 0.4512026843493873, 'recall': 0.43205581906717644, 'f1-score': 0.414812167266905, 'support': 3088837}}
[[264251 557463 174954]
 [149023 730413 193220]
 [140702 538925 339886]]
Evaluating performance on  train set...
2948/2948 - 107s - 107s/epoch - 36ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0515261
{'0': {'precision': 0.5090484197326798, 'recall': 0.2831272067302548, 'f1-score': 0.3638724857337112, 'support': 252353}, '1': {'precision': 0.397393823108892, 'recall': 0.6458213776912736, 'f1-score': 0.49202777361628747, 'support': 249185}, '2': {'precision': 0.4784928500738658, 'recall': 0.39567568849775836, 'f1-score': 0.4331612945109877, 'support': 252942}, 'accuracy': 0.4406478634291167, 'macro avg': {'precision': 0.46164503097181253, 'recall': 0.4415414243064289, 'f1-score': 0.4296871846203288, 'support': 754480}, 'weighted avg': {'precision': 0.4619279691437466, 'recall': 0.4406478634291167, 'f1-score': 0.4294281337041831, 'support': 754480}}
[[ 71448 126357  54548]
 [ 33724 160929  54532]
 [ 35184 117675 100083]]
Evaluating performance on  val set...
697/697 - 28s - 28s/epoch - 41ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0393677
{'0': {'precision': 0.5062329963048686, 'recall': 0.2247561701130361, 'f1-score': 0.31130143827407114, 'support': 55469}, '1': {'precision': 0.44045847798534193, 'recall': 0.7000043788588693, 'f1-score': 0.5406977727418782, 'support': 68511}, '2': {'precision': 0.45998084248513066, 'recall': 0.37943770672546856, 'f1-score': 0.4158451732436487, 'support': 54420}, 'accuracy': 0.4544506726457399, 'macro avg': {'precision': 0.46889077225844705, 'recall': 0.4347327518991247, 'f1-score': 0.42261479475319935, 'support': 178400}, 'weighted avg': {'precision': 0.4668646093348056, 'recall': 0.4544506726457399, 'f1-score': 0.4312871015463152, 'support': 178400}}
[[12467 32566 10436]
 [ 6747 47958 13806]
 [ 5413 28358 20649]]
training model: results/ATVI/W1/deepOF_L2/h200
Epoch 1/50
2948/2948 - 222s - loss: 3.2568 - accuracy200: 0.3900 - val_loss: 3.3073 - val_accuracy200: 0.3503 - 222s/epoch - 75ms/step
Epoch 2/50
2948/2948 - 232s - loss: 3.2318 - accuracy200: 0.4027 - val_loss: 3.2971 - val_accuracy200: 0.3523 - 232s/epoch - 79ms/step
Epoch 3/50
2948/2948 - 220s - loss: 3.2206 - accuracy200: 0.4082 - val_loss: 3.2980 - val_accuracy200: 0.3523 - 220s/epoch - 75ms/step
Epoch 4/50
2948/2948 - 225s - loss: 3.2135 - accuracy200: 0.4122 - val_loss: 3.2844 - val_accuracy200: 0.3612 - 225s/epoch - 76ms/step
Epoch 5/50
2948/2948 - 227s - loss: 3.2087 - accuracy200: 0.4145 - val_loss: 3.2935 - val_accuracy200: 0.3540 - 227s/epoch - 77ms/step
Epoch 6/50
2948/2948 - 222s - loss: 3.2045 - accuracy200: 0.4170 - val_loss: 3.2906 - val_accuracy200: 0.3563 - 222s/epoch - 75ms/step
Epoch 7/50
2948/2948 - 226s - loss: 3.2010 - accuracy200: 0.4189 - val_loss: 3.2903 - val_accuracy200: 0.3581 - 226s/epoch - 77ms/step
Epoch 8/50
2948/2948 - 224s - loss: 3.1986 - accuracy200: 0.4198 - val_loss: 3.2904 - val_accuracy200: 0.3582 - 224s/epoch - 76ms/step
Epoch 9/50
2948/2948 - 233s - loss: 3.1953 - accuracy200: 0.4214 - val_loss: 3.2930 - val_accuracy200: 0.3574 - 233s/epoch - 79ms/step
Epoch 10/50
2948/2948 - 227s - loss: 3.1926 - accuracy200: 0.4231 - val_loss: 3.2890 - val_accuracy200: 0.3594 - 227s/epoch - 77ms/step
Epoch 11/50
2948/2948 - 220s - loss: 3.1909 - accuracy200: 0.4239 - val_loss: 3.2907 - val_accuracy200: 0.3605 - 220s/epoch - 75ms/step
Epoch 12/50
2948/2948 - 221s - loss: 3.1887 - accuracy200: 0.4245 - val_loss: 3.2854 - val_accuracy200: 0.3623 - 221s/epoch - 75ms/step
Epoch 13/50
2948/2948 - 222s - loss: 3.1870 - accuracy200: 0.4257 - val_loss: 3.2860 - val_accuracy200: 0.3629 - 222s/epoch - 75ms/step
Epoch 14/50
2948/2948 - 222s - loss: 3.1840 - accuracy200: 0.4276 - val_loss: 3.2887 - val_accuracy200: 0.3648 - 222s/epoch - 75ms/step
testing model: results/ATVI/W1/deepOF_L2/h200
Evaluating performance on  test set...
12066/12066 - 419s - 419s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011013
{'0': {'precision': 0.42912802100993985, 'recall': 0.06426710133397326, 'f1-score': 0.11179200102537633, 'support': 1004293}, '1': {'precision': 0.34003852951078706, 'recall': 0.9071706790737538, 'f1-score': 0.4946611708834762, 'support': 1045424}, '2': {'precision': 0.45074664828214, 'recall': 0.06480675956578644, 'f1-score': 0.11332067334106843, 'support': 1039120}, 'accuracy': 0.34973130663741725, 'macro avg': {'precision': 0.40663773293428895, 'recall': 0.3454148466578379, 'f1-score': 0.23992461508330698, 'support': 3088837}, 'weighted avg': {'precision': 0.40624823014045675, 'recall': 0.34973130663741725, 'f1-score': 0.24188921658139828, 'support': 3088837}}
[[ 64543 905590  34160]
 [ 49147 948378  47899]
 [ 36715 935063  67342]]
Evaluating performance on  train set...
2948/2948 - 123s - 123s/epoch - 42ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035175
{'0': {'precision': 0.46723778652465847, 'recall': 0.056093396338799985, 'f1-score': 0.10016202054151023, 'support': 251830}, '1': {'precision': 0.3326104751136551, 'recall': 0.9035734997100406, 'f1-score': 0.4862350866205451, 'support': 250035}, '2': {'precision': 0.4442765394786551, 'recall': 0.07914019357520337, 'f1-score': 0.1343485185508746, 'support': 252615}, 'accuracy': 0.34466519987276006, 'macro avg': {'precision': 0.4147082670389895, 'recall': 0.34626902987468133, 'f1-score': 0.24024854190430997, 'support': 754480}, 'weighted avg': {'precision': 0.4149343520649294, 'recall': 0.34466519987276006, 'f1-score': 0.23955312603364662, 'support': 754480}}
[[ 14126 227237  10467]
 [  9570 225925  14540]
 [  6537 226086  19992]]
Evaluating performance on  val set...
697/697 - 27s - 27s/epoch - 38ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954933
{'0': {'precision': 0.47258572138479377, 'recall': 0.048426520012221204, 'f1-score': 0.08785084140351958, 'support': 58914}, '1': {'precision': 0.3510800893525652, 'recall': 0.9119504942537973, 'f1-score': 0.5069832277434747, 'support': 62215}, '2': {'precision': 0.447192264782447, 'recall': 0.0839866599151403, 'f1-score': 0.141414438384759, 'support': 57271}, 'accuracy': 0.3609865470852018, 'macro avg': {'precision': 0.423619358506602, 'recall': 0.3481212247270529, 'f1-score': 0.2454161691772511, 'support': 178400}, 'weighted avg': {'precision': 0.42206004005094794, 'recall': 0.3609865470852018, 'f1-score': 0.2512138581011254, 'support': 178400}}
[[ 2853 53639  2422]
 [ 1954 56737  3524]
 [ 1230 51231  4810]]
training model: results/ATVI/W1/deepOF_L2/h300
Epoch 1/50
2948/2948 - 238s - loss: 3.2758 - accuracy300: 0.3783 - val_loss: 3.3460 - val_accuracy300: 0.3284 - 238s/epoch - 81ms/step
Epoch 2/50
2948/2948 - 228s - loss: 3.2555 - accuracy300: 0.3888 - val_loss: 3.3325 - val_accuracy300: 0.3289 - 228s/epoch - 77ms/step
Epoch 3/50
2948/2948 - 227s - loss: 3.2477 - accuracy300: 0.3942 - val_loss: 3.3296 - val_accuracy300: 0.3290 - 227s/epoch - 77ms/step
Epoch 4/50
2948/2948 - 235s - loss: 3.2422 - accuracy300: 0.3983 - val_loss: 3.3236 - val_accuracy300: 0.3309 - 235s/epoch - 80ms/step
Epoch 5/50
2948/2948 - 243s - loss: 3.2378 - accuracy300: 0.4002 - val_loss: 3.3260 - val_accuracy300: 0.3333 - 243s/epoch - 82ms/step
Epoch 6/50
2948/2948 - 238s - loss: 3.2346 - accuracy300: 0.4021 - val_loss: 3.3191 - val_accuracy300: 0.3372 - 238s/epoch - 81ms/step
Epoch 7/50
2948/2948 - 237s - loss: 3.2317 - accuracy300: 0.4046 - val_loss: 3.3166 - val_accuracy300: 0.3407 - 237s/epoch - 80ms/step
Epoch 8/50
2948/2948 - 239s - loss: 3.2292 - accuracy300: 0.4060 - val_loss: 3.3157 - val_accuracy300: 0.3432 - 239s/epoch - 81ms/step
Epoch 9/50
2948/2948 - 234s - loss: 3.2266 - accuracy300: 0.4076 - val_loss: 3.3099 - val_accuracy300: 0.3481 - 234s/epoch - 79ms/step
Epoch 10/50
2948/2948 - 230s - loss: 3.2242 - accuracy300: 0.4091 - val_loss: 3.3126 - val_accuracy300: 0.3509 - 230s/epoch - 78ms/step
Epoch 11/50
2948/2948 - 228s - loss: 3.2220 - accuracy300: 0.4105 - val_loss: 3.3111 - val_accuracy300: 0.3555 - 228s/epoch - 77ms/step
Epoch 12/50
2948/2948 - 236s - loss: 3.2196 - accuracy300: 0.4123 - val_loss: 3.3102 - val_accuracy300: 0.3561 - 236s/epoch - 80ms/step
Epoch 13/50
2948/2948 - 231s - loss: 3.2174 - accuracy300: 0.4131 - val_loss: 3.3184 - val_accuracy300: 0.3578 - 231s/epoch - 78ms/step
Epoch 14/50
2948/2948 - 225s - loss: 3.2156 - accuracy300: 0.4139 - val_loss: 3.3140 - val_accuracy300: 0.3579 - 225s/epoch - 76ms/step
Epoch 15/50
2948/2948 - 225s - loss: 3.2135 - accuracy300: 0.4158 - val_loss: 3.3204 - val_accuracy300: 0.3572 - 225s/epoch - 76ms/step
Epoch 16/50
2948/2948 - 231s - loss: 3.2116 - accuracy300: 0.4163 - val_loss: 3.3190 - val_accuracy300: 0.3638 - 231s/epoch - 78ms/step
Epoch 17/50
2948/2948 - 232s - loss: 3.2095 - accuracy300: 0.4179 - val_loss: 3.3122 - val_accuracy300: 0.3633 - 232s/epoch - 79ms/step
Epoch 18/50
2948/2948 - 233s - loss: 3.2074 - accuracy300: 0.4196 - val_loss: 3.3189 - val_accuracy300: 0.3630 - 233s/epoch - 79ms/step
Epoch 19/50
2948/2948 - 233s - loss: 3.2046 - accuracy300: 0.4210 - val_loss: 3.3185 - val_accuracy300: 0.3649 - 233s/epoch - 79ms/step
testing model: results/ATVI/W1/deepOF_L2/h300
Evaluating performance on  test set...
12066/12066 - 494s - 494s/epoch - 41ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0890738
{'0': {'precision': 0.38134613160633746, 'recall': 0.07040201203506116, 'f1-score': 0.11886063207903377, 'support': 936763}, '1': {'precision': 0.3886444080129937, 'recall': 0.8574052710828222, 'f1-score': 0.5348514904301503, 'support': 1192772}, '2': {'precision': 0.39409641053042316, 'recall': 0.1168651790572729, 'f1-score': 0.18027244521307348, 'support': 959302}, 'accuracy': 0.38873789714381174, 'macro avg': {'precision': 0.3880289833832515, 'recall': 0.3482241540583854, 'f1-score': 0.2779948559074192, 'support': 3088837}, 'weighted avg': {'precision': 0.38812426454716714, 'recall': 0.38873789714381174, 'f1-score': 0.2985705757440082, 'support': 3088837}}
[[  65950  805474   65339]
 [  63060 1022689  107023]
 [  43930  803263  112109]]
Evaluating performance on  train set...
2948/2948 - 126s - 126s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1059755
{'0': {'precision': 0.44475342061226497, 'recall': 0.07117343824454868, 'f1-score': 0.12270975845738633, 'support': 253929}, '1': {'precision': 0.33086621559931667, 'recall': 0.8559039684439917, 'f1-score': 0.47724439114349393, 'support': 246419}, '2': {'precision': 0.4441244616653358, 'recall': 0.13350542237892118, 'f1-score': 0.20529763255426972, 'support': 254132}, 'accuracy': 0.34846781889513306, 'macro avg': {'precision': 0.40658136595897254, 'recall': 0.3535276096891539, 'f1-score': 0.2684172607183833, 'support': 754480}, 'weighted avg': {'precision': 0.4073451264663808, 'recall': 0.34846781889513306, 'f1-score': 0.2663216385229509, 'support': 754480}}
[[ 18073 216818  19038]
 [ 12081 210911  23427]
 [ 10482 209722  33928]]
Evaluating performance on  val set...
697/697 - 30s - 30s/epoch - 43ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062154
{'0': {'precision': 0.4545699649501213, 'recall': 0.05508543797170582, 'f1-score': 0.09826320083925867, 'support': 61214}, '1': {'precision': 0.3299658873559743, 'recall': 0.8635269024356681, 'f1-score': 0.47747991953547436, 'support': 58136}, '2': {'precision': 0.44736981793088804, 'recall': 0.14272650296359018, 'f1-score': 0.21641053293789878, 'support': 59050}, 'accuracy': 0.34754484304932737, 'macro avg': {'precision': 0.4106352234123279, 'recall': 0.353779614456988, 'f1-score': 0.2640512177708773, 'support': 178400}, 'weighted avg': {'precision': 0.41158144848992484, 'recall': 0.34754484304932737, 'f1-score': 0.2609467384992805, 'support': 178400}}
[[ 3372 53121  4721]
 [ 2244 50202  5690]
 [ 1802 48820  8428]]
training model: results/ATVI/W1/deepOF_L2/h500
Epoch 1/50
2948/2948 - 224s - loss: 3.2608 - accuracy500: 0.3898 - val_loss: 3.2869 - val_accuracy500: 0.3573 - 224s/epoch - 76ms/step
Epoch 2/50
2948/2948 - 244s - loss: 3.2473 - accuracy500: 0.3954 - val_loss: 3.2850 - val_accuracy500: 0.3566 - 244s/epoch - 83ms/step
Epoch 3/50
2948/2948 - 218s - loss: 3.2408 - accuracy500: 0.3986 - val_loss: 3.2829 - val_accuracy500: 0.3593 - 218s/epoch - 74ms/step
Epoch 4/50
2948/2948 - 217s - loss: 3.2372 - accuracy500: 0.4008 - val_loss: 3.2827 - val_accuracy500: 0.3585 - 217s/epoch - 74ms/step
Epoch 5/50
2948/2948 - 221s - loss: 3.2355 - accuracy500: 0.4017 - val_loss: 3.2823 - val_accuracy500: 0.3583 - 221s/epoch - 75ms/step
Epoch 6/50
2948/2948 - 215s - loss: 3.2351 - accuracy500: 0.4018 - val_loss: 3.2822 - val_accuracy500: 0.3589 - 215s/epoch - 73ms/step
Epoch 7/50
2948/2948 - 218s - loss: 3.2339 - accuracy500: 0.4025 - val_loss: 3.2827 - val_accuracy500: 0.3595 - 218s/epoch - 74ms/step
Epoch 8/50
2948/2948 - 214s - loss: 3.2326 - accuracy500: 0.4037 - val_loss: 3.2833 - val_accuracy500: 0.3597 - 214s/epoch - 72ms/step
Epoch 9/50
2948/2948 - 217s - loss: 3.2311 - accuracy500: 0.4052 - val_loss: 3.2834 - val_accuracy500: 0.3616 - 217s/epoch - 74ms/step
Epoch 10/50
2948/2948 - 217s - loss: 3.2295 - accuracy500: 0.4062 - val_loss: 3.2860 - val_accuracy500: 0.3598 - 217s/epoch - 74ms/step
Epoch 11/50
2948/2948 - 215s - loss: 3.2286 - accuracy500: 0.4071 - val_loss: 3.2852 - val_accuracy500: 0.3619 - 215s/epoch - 73ms/step
Epoch 12/50
2948/2948 - 215s - loss: 3.2272 - accuracy500: 0.4083 - val_loss: 3.2882 - val_accuracy500: 0.3598 - 215s/epoch - 73ms/step
Epoch 13/50
2948/2948 - 222s - loss: 3.2258 - accuracy500: 0.4091 - val_loss: 3.2884 - val_accuracy500: 0.3607 - 222s/epoch - 75ms/step
Epoch 14/50
2948/2948 - 217s - loss: 3.2235 - accuracy500: 0.4104 - val_loss: 3.2911 - val_accuracy500: 0.3594 - 217s/epoch - 73ms/step
Epoch 15/50
2948/2948 - 219s - loss: 3.2224 - accuracy500: 0.4116 - val_loss: 3.2885 - val_accuracy500: 0.3610 - 219s/epoch - 74ms/step
Epoch 16/50
2948/2948 - 218s - loss: 3.2216 - accuracy500: 0.4119 - val_loss: 3.2926 - val_accuracy500: 0.3592 - 218s/epoch - 74ms/step
testing model: results/ATVI/W1/deepOF_L2/h500
Evaluating performance on  test set...
12066/12066 - 429s - 429s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0867462
{'0': {'precision': 0.2676727867865608, 'recall': 0.3671181805281422, 'f1-score': 0.3096060010988234, 'support': 775170}, '1': {'precision': 0.4871683153479298, 'recall': 0.23458269134914897, 'f1-score': 0.31667778359556203, 'support': 1496662}, '2': {'precision': 0.30136934865900383, 'recall': 0.4813764909639476, 'f1-score': 0.3706749041590383, 'support': 817005}, 'accuracy': 0.33312117149593845, 'macro avg': {'precision': 0.3520701502644981, 'recall': 0.3610257876137462, 'f1-score': 0.33231956295114123, 'support': 3088837}, 'weighted avg': {'precision': 0.38293975500155925, 'recall': 0.33312117149593845, 'f1-score': 0.32918543092300795, 'support': 3088837}}
[[284579 180669 309922]
 [543780 351091 601791]
 [234801 188917 393287]]
Evaluating performance on  train set...
2948/2948 - 106s - 106s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0933512
{'0': {'precision': 0.3749183721123516, 'recall': 0.3763004333784852, 'f1-score': 0.37560813141586075, 'support': 251743}, '1': {'precision': 0.34855854142325354, 'recall': 0.20532355906973768, 'f1-score': 0.2584206285253828, 'support': 249908}, '2': {'precision': 0.3717938956054338, 'recall': 0.5214473023268692, 'f1-score': 0.4340841518143775, 'support': 252829}, 'accuracy': 0.3683066482875623, 'macro avg': {'precision': 0.3650902697136797, 'recall': 0.36769043159169734, 'f1-score': 0.35603763725187365, 'support': 754480}, 'weighted avg': {'precision': 0.3651401263820226, 'recall': 0.3683066482875623, 'f1-score': 0.35638739566273675, 'support': 754480}}
[[ 94731  48448 108564]
 [ 84400  51312 114196]
 [ 73540  47452 131837]]
Evaluating performance on  val set...
697/697 - 23s - 23s/epoch - 33ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0941007
{'0': {'precision': 0.3708628649457052, 'recall': 0.38579521434006936, 'f1-score': 0.37818169762372467, 'support': 59135}, '1': {'precision': 0.35528075778669505, 'recall': 0.20677109811896288, 'f1-score': 0.2614057463068781, 'support': 62944}, '2': {'precision': 0.35266850257317667, 'recall': 0.5025123843681752, 'f1-score': 0.4144627009928828, 'support': 56321}, 'accuracy': 0.3594786995515695, 'macro avg': {'precision': 0.3596040417685256, 'recall': 0.36502623227573583, 'f1-score': 0.3513500483078285, 'support': 178400}, 'weighted avg': {'precision': 0.35962113380108685, 'recall': 0.3594786995515695, 'f1-score': 0.3484341466767895, 'support': 178400}}
[[22814 12473 23848]
 [21828 13015 28101]
 [16874 11145 28302]]
training model: results/ATVI/W1/deepOF_L2/h1000
Epoch 1/50
2948/2948 - 215s - loss: 3.2715 - accuracy1000: 0.3857 - val_loss: 3.3460 - val_accuracy1000: 0.3597 - 215s/epoch - 73ms/step
Epoch 2/50
2948/2948 - 106s - loss: 3.2479 - accuracy1000: 0.3957 - val_loss: 3.3400 - val_accuracy1000: 0.3608 - 106s/epoch - 36ms/step
Epoch 3/50
2948/2948 - 80s - loss: 3.2400 - accuracy1000: 0.3993 - val_loss: 3.3349 - val_accuracy1000: 0.3609 - 80s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 78s - loss: 3.2377 - accuracy1000: 0.4006 - val_loss: 3.3291 - val_accuracy1000: 0.3602 - 78s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 79s - loss: 3.2356 - accuracy1000: 0.4027 - val_loss: 3.3237 - val_accuracy1000: 0.3606 - 79s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 79s - loss: 3.2335 - accuracy1000: 0.4033 - val_loss: 3.3228 - val_accuracy1000: 0.3610 - 79s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 79s - loss: 3.2318 - accuracy1000: 0.4046 - val_loss: 3.3200 - val_accuracy1000: 0.3613 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 77s - loss: 3.2311 - accuracy1000: 0.4050 - val_loss: 3.3170 - val_accuracy1000: 0.3611 - 77s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 78s - loss: 3.2303 - accuracy1000: 0.4054 - val_loss: 3.3206 - val_accuracy1000: 0.3617 - 78s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 77s - loss: 3.2292 - accuracy1000: 0.4060 - val_loss: 3.3093 - val_accuracy1000: 0.3621 - 77s/epoch - 26ms/step
Epoch 11/50
2948/2948 - 77s - loss: 3.2283 - accuracy1000: 0.4064 - val_loss: 3.3059 - val_accuracy1000: 0.3625 - 77s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 77s - loss: 3.2275 - accuracy1000: 0.4074 - val_loss: 3.3033 - val_accuracy1000: 0.3619 - 77s/epoch - 26ms/step
Epoch 13/50
2948/2948 - 78s - loss: 3.2262 - accuracy1000: 0.4076 - val_loss: 3.3014 - val_accuracy1000: 0.3627 - 78s/epoch - 26ms/step
Epoch 14/50
2948/2948 - 77s - loss: 3.2252 - accuracy1000: 0.4084 - val_loss: 3.3021 - val_accuracy1000: 0.3627 - 77s/epoch - 26ms/step
Epoch 15/50
2948/2948 - 78s - loss: 3.2240 - accuracy1000: 0.4092 - val_loss: 3.3031 - val_accuracy1000: 0.3629 - 78s/epoch - 26ms/step
Epoch 16/50
2948/2948 - 78s - loss: 3.2229 - accuracy1000: 0.4094 - val_loss: 3.3006 - val_accuracy1000: 0.3631 - 78s/epoch - 27ms/step
Epoch 17/50
2948/2948 - 78s - loss: 3.2223 - accuracy1000: 0.4105 - val_loss: 3.2992 - val_accuracy1000: 0.3636 - 78s/epoch - 26ms/step
Epoch 18/50
2948/2948 - 77s - loss: 3.2209 - accuracy1000: 0.4113 - val_loss: 3.3002 - val_accuracy1000: 0.3634 - 77s/epoch - 26ms/step
Epoch 19/50
2948/2948 - 77s - loss: 3.2195 - accuracy1000: 0.4120 - val_loss: 3.3024 - val_accuracy1000: 0.3646 - 77s/epoch - 26ms/step
Epoch 20/50
2948/2948 - 77s - loss: 3.2184 - accuracy1000: 0.4127 - val_loss: 3.3062 - val_accuracy1000: 0.3642 - 77s/epoch - 26ms/step
Epoch 21/50
2948/2948 - 77s - loss: 3.2168 - accuracy1000: 0.4133 - val_loss: 3.3134 - val_accuracy1000: 0.3635 - 77s/epoch - 26ms/step
Epoch 22/50
2948/2948 - 77s - loss: 3.2157 - accuracy1000: 0.4142 - val_loss: 3.3298 - val_accuracy1000: 0.3623 - 77s/epoch - 26ms/step
Epoch 23/50
2948/2948 - 77s - loss: 3.2142 - accuracy1000: 0.4152 - val_loss: 3.3323 - val_accuracy1000: 0.3623 - 77s/epoch - 26ms/step
Epoch 24/50
2948/2948 - 77s - loss: 3.2126 - accuracy1000: 0.4154 - val_loss: 3.3245 - val_accuracy1000: 0.3637 - 77s/epoch - 26ms/step
Epoch 25/50
2948/2948 - 78s - loss: 3.2117 - accuracy1000: 0.4157 - val_loss: 3.3260 - val_accuracy1000: 0.3650 - 78s/epoch - 27ms/step
Epoch 26/50
2948/2948 - 78s - loss: 3.2090 - accuracy1000: 0.4178 - val_loss: 3.3309 - val_accuracy1000: 0.3646 - 78s/epoch - 26ms/step
Epoch 27/50
2948/2948 - 78s - loss: 3.2070 - accuracy1000: 0.4183 - val_loss: 3.3352 - val_accuracy1000: 0.3650 - 78s/epoch - 26ms/step
testing model: results/ATVI/W1/deepOF_L2/h1000
Evaluating performance on  test set...
12066/12066 - 151s - 151s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000193
{'0': {'precision': 0.38420864594498033, 'recall': 0.005584045229000895, 'f1-score': 0.011008099971645494, 'support': 962922}, '1': {'precision': 0.36484076187995124, 'recall': 0.912366259066437, 'f1-score': 0.5212442393633416, 'support': 1080634}, '2': {'precision': 0.4057732888738543, 'recall': 0.14459269804004857, 'f1-score': 0.2132103219526646, 'support': 1045281}, 'accuracy': 0.369864450600663, 'macro avg': {'precision': 0.38494089889959526, 'recall': 0.3541810007784955, 'f1-score': 0.2484875537625506, 'support': 3088837}, 'weighted avg': {'precision': 0.3847303690066399, 'recall': 0.369864450600663, 'f1-score': 0.2579413829677854, 'support': 3088837}}
[[  5377 827080 130465]
 [  3831 985934  90869]
 [  4787 889354 151140]]
Evaluating performance on  train set...
2948/2948 - 38s - 38s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015766
{'0': {'precision': 0.40965092402464065, 'recall': 0.006323221197846301, 'f1-score': 0.012454203879063125, 'support': 252403}, '1': {'precision': 0.34386415651984625, 'recall': 0.9002275490916096, 'f1-score': 0.49764175011868894, 'support': 249177}, '2': {'precision': 0.39732301898315436, 'recall': 0.15434954527481218, 'f1-score': 0.22232980677497902, 'support': 252900}, 'accuracy': 0.35116504082281835, 'macro avg': {'precision': 0.3836126998425471, 'recall': 0.35363343852142276, 'f1-score': 0.24414192025757706, 'support': 754480}, 'weighted avg': {'precision': 0.38379168779368145, 'recall': 0.35116504082281835, 'f1-score': 0.24304363922755262, 'support': 754480}}
[[  1596 215351  35456]
 [  1107 224316  23754]
 [  1193 212672  39035]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100387
{'0': {'precision': 0.37808641975308643, 'recall': 0.004167942567452621, 'f1-score': 0.008244994110718492, 'support': 58782}, '1': {'precision': 0.36362905370717435, 'recall': 0.9287801949539473, 'f1-score': 0.5226385740320931, 'support': 63297}, '2': {'precision': 0.3718514833012003, 'recall': 0.10615933665950533, 'f1-score': 0.1651657458563536, 'support': 56321}, 'accuracy': 0.3644226457399103, 'macro avg': {'precision': 0.37118898558715374, 'recall': 0.3463691580603017, 'f1-score': 0.23201643799972171, 'support': 178400}, 'weighted avg': {'precision': 0.3709885175416807, 'recall': 0.3644226457399103, 'f1-score': 0.24029378383801206, 'support': 178400}}
[[  245 52741  5796]
 [  204 58789  4304]
 [  199 50143  5979]]
training model: results/ATVI/W1/deepVOL_L2/h10
Epoch 1/50
2948/2948 - 83s - loss: 2.7560 - accuracy10: 0.5284 - val_loss: 2.5227 - val_accuracy10: 0.6977 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 79s - loss: 2.6037 - accuracy10: 0.5745 - val_loss: 2.3733 - val_accuracy10: 0.6923 - 79s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 79s - loss: 2.5529 - accuracy10: 0.5877 - val_loss: 2.3691 - val_accuracy10: 0.6970 - 79s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 79s - loss: 2.5160 - accuracy10: 0.5960 - val_loss: 2.3568 - val_accuracy10: 0.7020 - 79s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 79s - loss: 2.4906 - accuracy10: 0.6027 - val_loss: 2.3526 - val_accuracy10: 0.7073 - 79s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 81s - loss: 2.4701 - accuracy10: 0.6065 - val_loss: 2.3464 - val_accuracy10: 0.7116 - 81s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 79s - loss: 2.4544 - accuracy10: 0.6091 - val_loss: 2.3383 - val_accuracy10: 0.7110 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 77s - loss: 2.4425 - accuracy10: 0.6109 - val_loss: 2.3403 - val_accuracy10: 0.7113 - 77s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 78s - loss: 2.4327 - accuracy10: 0.6129 - val_loss: 2.3432 - val_accuracy10: 0.7156 - 78s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 79s - loss: 2.4244 - accuracy10: 0.6140 - val_loss: 2.3359 - val_accuracy10: 0.7185 - 79s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 78s - loss: 2.4160 - accuracy10: 0.6157 - val_loss: 2.3283 - val_accuracy10: 0.7167 - 78s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 78s - loss: 2.4083 - accuracy10: 0.6167 - val_loss: 2.3448 - val_accuracy10: 0.7210 - 78s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 78s - loss: 2.4012 - accuracy10: 0.6174 - val_loss: 2.3529 - val_accuracy10: 0.7204 - 78s/epoch - 26ms/step
Epoch 14/50
2948/2948 - 78s - loss: 2.3958 - accuracy10: 0.6184 - val_loss: 2.3345 - val_accuracy10: 0.7183 - 78s/epoch - 26ms/step
Epoch 15/50
2948/2948 - 78s - loss: 2.3897 - accuracy10: 0.6192 - val_loss: 2.3468 - val_accuracy10: 0.7194 - 78s/epoch - 26ms/step
Epoch 16/50
2948/2948 - 78s - loss: 2.3843 - accuracy10: 0.6195 - val_loss: 2.3452 - val_accuracy10: 0.7183 - 78s/epoch - 27ms/step
Epoch 17/50
2948/2948 - 78s - loss: 2.3784 - accuracy10: 0.6203 - val_loss: 2.3250 - val_accuracy10: 0.7173 - 78s/epoch - 26ms/step
Epoch 18/50
2948/2948 - 78s - loss: 2.3735 - accuracy10: 0.6221 - val_loss: 2.3480 - val_accuracy10: 0.7191 - 78s/epoch - 26ms/step
Epoch 19/50
2948/2948 - 78s - loss: 2.3684 - accuracy10: 0.6220 - val_loss: 2.3241 - val_accuracy10: 0.7188 - 78s/epoch - 26ms/step
Epoch 20/50
2948/2948 - 78s - loss: 2.3641 - accuracy10: 0.6228 - val_loss: 2.3205 - val_accuracy10: 0.7161 - 78s/epoch - 27ms/step
Epoch 21/50
2948/2948 - 79s - loss: 2.3603 - accuracy10: 0.6232 - val_loss: 2.3386 - val_accuracy10: 0.7159 - 79s/epoch - 27ms/step
Epoch 22/50
2948/2948 - 79s - loss: 2.3555 - accuracy10: 0.6235 - val_loss: 2.3088 - val_accuracy10: 0.7122 - 79s/epoch - 27ms/step
Epoch 23/50
2948/2948 - 78s - loss: 2.3527 - accuracy10: 0.6240 - val_loss: 2.3181 - val_accuracy10: 0.7161 - 78s/epoch - 26ms/step
Epoch 24/50
2948/2948 - 77s - loss: 2.3490 - accuracy10: 0.6240 - val_loss: 2.3108 - val_accuracy10: 0.7152 - 77s/epoch - 26ms/step
Epoch 25/50
2948/2948 - 78s - loss: 2.3467 - accuracy10: 0.6241 - val_loss: 2.2966 - val_accuracy10: 0.7122 - 78s/epoch - 27ms/step
Epoch 26/50
2948/2948 - 78s - loss: 2.3431 - accuracy10: 0.6252 - val_loss: 2.2897 - val_accuracy10: 0.7095 - 78s/epoch - 26ms/step
Epoch 27/50
2948/2948 - 78s - loss: 2.3400 - accuracy10: 0.6255 - val_loss: 2.2832 - val_accuracy10: 0.7080 - 78s/epoch - 27ms/step
Epoch 28/50
2948/2948 - 78s - loss: 2.3364 - accuracy10: 0.6262 - val_loss: 2.2841 - val_accuracy10: 0.7079 - 78s/epoch - 26ms/step
Epoch 29/50
2948/2948 - 78s - loss: 2.3317 - accuracy10: 0.6261 - val_loss: 2.2777 - val_accuracy10: 0.7081 - 78s/epoch - 26ms/step
Epoch 30/50
2948/2948 - 78s - loss: 2.3293 - accuracy10: 0.6266 - val_loss: 2.2703 - val_accuracy10: 0.7055 - 78s/epoch - 26ms/step
Epoch 31/50
2948/2948 - 78s - loss: 2.3271 - accuracy10: 0.6265 - val_loss: 2.2884 - val_accuracy10: 0.7060 - 78s/epoch - 26ms/step
Epoch 32/50
2948/2948 - 77s - loss: 2.3234 - accuracy10: 0.6267 - val_loss: 2.2749 - val_accuracy10: 0.7051 - 77s/epoch - 26ms/step
Epoch 33/50
2948/2948 - 77s - loss: 2.3193 - accuracy10: 0.6273 - val_loss: 2.2946 - val_accuracy10: 0.7048 - 77s/epoch - 26ms/step
Epoch 34/50
2948/2948 - 78s - loss: 2.3184 - accuracy10: 0.6271 - val_loss: 2.2881 - val_accuracy10: 0.7060 - 78s/epoch - 26ms/step
Epoch 35/50
2948/2948 - 78s - loss: 2.3149 - accuracy10: 0.6278 - val_loss: 2.2943 - val_accuracy10: 0.7081 - 78s/epoch - 27ms/step
Epoch 36/50
2948/2948 - 78s - loss: 2.3129 - accuracy10: 0.6276 - val_loss: 2.2800 - val_accuracy10: 0.7027 - 78s/epoch - 26ms/step
Epoch 37/50
2948/2948 - 77s - loss: 2.3107 - accuracy10: 0.6281 - val_loss: 2.2812 - val_accuracy10: 0.7027 - 77s/epoch - 26ms/step
Epoch 38/50
2948/2948 - 78s - loss: 2.3073 - accuracy10: 0.6285 - val_loss: 2.2805 - val_accuracy10: 0.7037 - 78s/epoch - 26ms/step
Epoch 39/50
2948/2948 - 78s - loss: 2.3049 - accuracy10: 0.6282 - val_loss: 2.2827 - val_accuracy10: 0.7052 - 78s/epoch - 26ms/step
Epoch 40/50
2948/2948 - 78s - loss: 2.3026 - accuracy10: 0.6287 - val_loss: 2.2936 - val_accuracy10: 0.7065 - 78s/epoch - 26ms/step
testing model: results/ATVI/W1/deepVOL_L2/h10
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70252544
{'0': {'precision': 0.49598742847546273, 'recall': 0.4697944381846932, 'f1-score': 0.482535743010164, 'support': 528065}, '1': {'precision': 0.8173333552071018, 'recall': 0.7837310375441755, 'f1-score': 0.8001795822779696, 'support': 2034217}, '2': {'precision': 0.46297317882766686, 'recall': 0.561024384685506, 'f1-score': 0.5073044156209913, 'support': 526560}, 'accuracy': 0.6920956138255049, 'macro avg': {'precision': 0.5920979875034105, 'recall': 0.6048499534714583, 'f1-score': 0.5966732469697082, 'support': 3088842}, 'weighted avg': {'precision': 0.7019880473946923, 'recall': 0.6920956138255049, 'f1-score': 0.6959486304397557, 'support': 3088842}}
[[ 248082  184275   95708]
 [ 192981 1594279  246957]
 [  59115  172032  295413]]
Evaluating performance on  train set...
2948/2948 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74557644
{'0': {'precision': 0.4527534332596172, 'recall': 0.5193060470359816, 'f1-score': 0.48375145857642937, 'support': 127732}, '1': {'precision': 0.8208808617086497, 'recall': 0.7327158015829743, 'f1-score': 0.7742966920598674, 'support': 500703}, '2': {'precision': 0.43825443346083154, 'recall': 0.5599498599728673, 'f1-score': 0.4916839373726467, 'support': 126047}, 'accuracy': 0.6677230205624521, 'macro avg': {'precision': 0.5706295761430328, 'recall': 0.6039905695306077, 'f1-score': 0.5832440293363145, 'support': 754482}, 'weighted avg': {'precision': 0.694634554849103, 'recall': 0.6677230205624521, 'f1-score': 0.6778935788598618, 'support': 754482}}
[[ 66332  41448  19952]
 [ 63314 366873  70516]
 [ 16862  38605  70580]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6796041
{'0': {'precision': 0.4534491075735649, 'recall': 0.4754863813229572, 'f1-score': 0.46420634769891167, 'support': 25700}, '1': {'precision': 0.8480056785140081, 'recall': 0.7775712807001035, 'f1-score': 0.8112625584972346, 'support': 127524}, '2': {'precision': 0.4155392682290912, 'recall': 0.5697489672704162, 'f1-score': 0.4805762626685652, 'support': 25176}, 'accuracy': 0.7047253363228699, 'macro avg': {'precision': 0.572331351438888, 'recall': 0.6076022097644923, 'f1-score': 0.5853483896215704, 'support': 178400}, 'weighted avg': {'precision': 0.7301364059887702, 'recall': 0.7047253363228699, 'f1-score': 0.714599426202955, 'support': 178400}}
[[12220  9434  4046]
 [12236 99159 16129]
 [ 2493  8339 14344]]
training model: results/ATVI/W1/deepVOL_L2/h20
Epoch 1/50
2948/2948 - 82s - loss: 2.8406 - accuracy20: 0.5344 - val_loss: 2.6195 - val_accuracy20: 0.6393 - 82s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 79s - loss: 2.7062 - accuracy20: 0.5700 - val_loss: 2.5576 - val_accuracy20: 0.6564 - 79s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 79s - loss: 2.6515 - accuracy20: 0.5835 - val_loss: 2.5381 - val_accuracy20: 0.6574 - 79s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 79s - loss: 2.6207 - accuracy20: 0.5898 - val_loss: 2.5414 - val_accuracy20: 0.6611 - 79s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 80s - loss: 2.5959 - accuracy20: 0.5948 - val_loss: 2.5184 - val_accuracy20: 0.6615 - 80s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 77s - loss: 2.5793 - accuracy20: 0.5976 - val_loss: 2.5320 - val_accuracy20: 0.6620 - 77s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 77s - loss: 2.5658 - accuracy20: 0.5998 - val_loss: 2.5230 - val_accuracy20: 0.6673 - 77s/epoch - 26ms/step
Epoch 8/50
2948/2948 - 79s - loss: 2.5543 - accuracy20: 0.6016 - val_loss: 2.5416 - val_accuracy20: 0.6663 - 79s/epoch - 27ms/step
Epoch 9/50
2948/2948 - 79s - loss: 2.5463 - accuracy20: 0.6029 - val_loss: 2.5318 - val_accuracy20: 0.6691 - 79s/epoch - 27ms/step
Epoch 10/50
2948/2948 - 78s - loss: 2.5378 - accuracy20: 0.6044 - val_loss: 2.5079 - val_accuracy20: 0.6690 - 78s/epoch - 26ms/step
Epoch 11/50
2948/2948 - 78s - loss: 2.5309 - accuracy20: 0.6058 - val_loss: 2.5007 - val_accuracy20: 0.6673 - 78s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 79s - loss: 2.5246 - accuracy20: 0.6070 - val_loss: 2.5034 - val_accuracy20: 0.6686 - 79s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 78s - loss: 2.5183 - accuracy20: 0.6077 - val_loss: 2.4916 - val_accuracy20: 0.6658 - 78s/epoch - 27ms/step
Epoch 14/50
2948/2948 - 78s - loss: 2.5128 - accuracy20: 0.6082 - val_loss: 2.4743 - val_accuracy20: 0.6684 - 78s/epoch - 26ms/step
Epoch 15/50
2948/2948 - 78s - loss: 2.5069 - accuracy20: 0.6092 - val_loss: 2.4723 - val_accuracy20: 0.6661 - 78s/epoch - 27ms/step
Epoch 16/50
2948/2948 - 78s - loss: 2.5021 - accuracy20: 0.6097 - val_loss: 2.4709 - val_accuracy20: 0.6633 - 78s/epoch - 26ms/step
Epoch 17/50
2948/2948 - 78s - loss: 2.4985 - accuracy20: 0.6101 - val_loss: 2.4786 - val_accuracy20: 0.6672 - 78s/epoch - 26ms/step
Epoch 18/50
2948/2948 - 78s - loss: 2.4927 - accuracy20: 0.6110 - val_loss: 2.4670 - val_accuracy20: 0.6701 - 78s/epoch - 26ms/step
Epoch 19/50
2948/2948 - 78s - loss: 2.4888 - accuracy20: 0.6113 - val_loss: 2.4563 - val_accuracy20: 0.6660 - 78s/epoch - 26ms/step
Epoch 20/50
2948/2948 - 78s - loss: 2.4848 - accuracy20: 0.6123 - val_loss: 2.4523 - val_accuracy20: 0.6670 - 78s/epoch - 26ms/step
Epoch 21/50
2948/2948 - 78s - loss: 2.4803 - accuracy20: 0.6124 - val_loss: 2.4599 - val_accuracy20: 0.6688 - 78s/epoch - 26ms/step
Epoch 22/50
2948/2948 - 78s - loss: 2.4777 - accuracy20: 0.6133 - val_loss: 2.4510 - val_accuracy20: 0.6685 - 78s/epoch - 26ms/step
Epoch 23/50
2948/2948 - 78s - loss: 2.4739 - accuracy20: 0.6136 - val_loss: 2.4456 - val_accuracy20: 0.6688 - 78s/epoch - 26ms/step
Epoch 24/50
2948/2948 - 78s - loss: 2.4698 - accuracy20: 0.6142 - val_loss: 2.4484 - val_accuracy20: 0.6648 - 78s/epoch - 26ms/step
Epoch 25/50
2948/2948 - 78s - loss: 2.4675 - accuracy20: 0.6146 - val_loss: 2.4506 - val_accuracy20: 0.6628 - 78s/epoch - 26ms/step
Epoch 26/50
2948/2948 - 78s - loss: 2.4635 - accuracy20: 0.6149 - val_loss: 2.4442 - val_accuracy20: 0.6654 - 78s/epoch - 26ms/step
Epoch 27/50
2948/2948 - 78s - loss: 2.4603 - accuracy20: 0.6156 - val_loss: 2.4466 - val_accuracy20: 0.6682 - 78s/epoch - 26ms/step
Epoch 28/50
2948/2948 - 78s - loss: 2.4565 - accuracy20: 0.6164 - val_loss: 2.4302 - val_accuracy20: 0.6656 - 78s/epoch - 26ms/step
Epoch 29/50
2948/2948 - 77s - loss: 2.4540 - accuracy20: 0.6165 - val_loss: 2.4428 - val_accuracy20: 0.6653 - 77s/epoch - 26ms/step
Epoch 30/50
2948/2948 - 78s - loss: 2.4513 - accuracy20: 0.6166 - val_loss: 2.4480 - val_accuracy20: 0.6667 - 78s/epoch - 26ms/step
Epoch 31/50
2948/2948 - 78s - loss: 2.4488 - accuracy20: 0.6170 - val_loss: 2.4389 - val_accuracy20: 0.6656 - 78s/epoch - 26ms/step
Epoch 32/50
2948/2948 - 78s - loss: 2.4447 - accuracy20: 0.6176 - val_loss: 2.4338 - val_accuracy20: 0.6661 - 78s/epoch - 26ms/step
Epoch 33/50
2948/2948 - 78s - loss: 2.4429 - accuracy20: 0.6180 - val_loss: 2.4351 - val_accuracy20: 0.6665 - 78s/epoch - 26ms/step
Epoch 34/50
2948/2948 - 78s - loss: 2.4397 - accuracy20: 0.6180 - val_loss: 2.4315 - val_accuracy20: 0.6652 - 78s/epoch - 26ms/step
Epoch 35/50
2948/2948 - 78s - loss: 2.4373 - accuracy20: 0.6184 - val_loss: 2.4447 - val_accuracy20: 0.6631 - 78s/epoch - 26ms/step
Epoch 36/50
2948/2948 - 78s - loss: 2.4341 - accuracy20: 0.6192 - val_loss: 2.4387 - val_accuracy20: 0.6579 - 78s/epoch - 27ms/step
Epoch 37/50
2948/2948 - 78s - loss: 2.4320 - accuracy20: 0.6191 - val_loss: 2.4333 - val_accuracy20: 0.6639 - 78s/epoch - 26ms/step
Epoch 38/50
2948/2948 - 78s - loss: 2.4301 - accuracy20: 0.6198 - val_loss: 2.4359 - val_accuracy20: 0.6594 - 78s/epoch - 26ms/step
testing model: results/ATVI/W1/deepVOL_L2/h20
Evaluating performance on  test set...
12066/12066 - 160s - 160s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7918097
{'0': {'precision': 0.5442806326036698, 'recall': 0.4363384614049074, 'f1-score': 0.4843686508937132, 'support': 691163}, '1': {'precision': 0.7085989842089138, 'recall': 0.7925818319622302, 'f1-score': 0.7482412178212219, 'support': 1709937}, '2': {'precision': 0.5333430844181415, 'recall': 0.4824788947017922, 'f1-score': 0.5066375549185239, 'support': 687742}, 'accuracy': 0.6438228306918904, 'macro avg': {'precision': 0.5954075670769083, 'recall': 0.5704663960229767, 'f1-score': 0.5797491412111531, 'support': 3088842}, 'weighted avg': {'precision': 0.6328095434138066, 'recall': 0.6438228306918904, 'f1-score': 0.6354028333045179, 'support': 3088842}}
[[ 301581  281237  108345]
 [ 172685 1355265  181987]
 [  79825  276096  331821]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8110286
{'0': {'precision': 0.5277638493647558, 'recall': 0.4754766793781168, 'f1-score': 0.5002577057093389, 'support': 170450}, '1': {'precision': 0.713853054105175, 'recall': 0.7581569463356894, 'f1-score': 0.7353382809501198, 'support': 415658}, '2': {'precision': 0.5205626348266693, 'recall': 0.49301554871892334, 'f1-score': 0.5064147536283164, 'support': 168374}, 'accuracy': 0.6351244960118333, 'macro avg': {'precision': 0.5873931794322002, 'recall': 0.5755497248109099, 'f1-score': 0.5806702467625917, 'support': 754482}, 'weighted avg': {'precision': 0.6286767530090541, 'recall': 0.6351244960118333, 'f1-score': 0.6311419528215859, 'support': 754482}}
[[ 81045  63913  25492]
 [ 49563 315134  50961]
 [ 22955  62408  83011]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76025
{'0': {'precision': 0.52242492677935, 'recall': 0.42831105710814094, 'f1-score': 0.47070980049280664, 'support': 34566}, '1': {'precision': 0.755707405282284, 'recall': 0.7898988613955855, 'f1-score': 0.7724249465728897, 'support': 110047}, '2': {'precision': 0.48500071357214214, 'recall': 0.5029153224613017, 'f1-score': 0.493795588619918, 'support': 33787}, 'accuracy': 0.665487668161435, 'macro avg': {'precision': 0.5877110152112587, 'recall': 0.5737084136550094, 'f1-score': 0.5789767785618715, 'support': 178400}, 'weighted avg': {'precision': 0.6592387441570431, 'recall': 0.665487668161435, 'f1-score': 0.6611966065697439, 'support': 178400}}
[[14805 14687  5074]
 [10152 86926 12969]
 [ 3382 13413 16992]]
training model: results/ATVI/W1/deepVOL_L2/h30
Epoch 1/50
2948/2948 - 81s - loss: 2.9112 - accuracy30: 0.5200 - val_loss: 2.7524 - val_accuracy30: 0.6060 - 81s/epoch - 27ms/step
Epoch 2/50
2948/2948 - 80s - loss: 2.7795 - accuracy30: 0.5556 - val_loss: 2.6640 - val_accuracy30: 0.5851 - 80s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 79s - loss: 2.7326 - accuracy30: 0.5664 - val_loss: 2.6590 - val_accuracy30: 0.6049 - 79s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 79s - loss: 2.7090 - accuracy30: 0.5720 - val_loss: 2.6670 - val_accuracy30: 0.6130 - 79s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 79s - loss: 2.6903 - accuracy30: 0.5759 - val_loss: 2.6611 - val_accuracy30: 0.6138 - 79s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 78s - loss: 2.6730 - accuracy30: 0.5791 - val_loss: 2.6548 - val_accuracy30: 0.6144 - 78s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 77s - loss: 2.6605 - accuracy30: 0.5811 - val_loss: 2.6478 - val_accuracy30: 0.6147 - 77s/epoch - 26ms/step
Epoch 8/50
2948/2948 - 78s - loss: 2.6501 - accuracy30: 0.5829 - val_loss: 2.6465 - val_accuracy30: 0.6180 - 78s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 78s - loss: 2.6416 - accuracy30: 0.5837 - val_loss: 2.6376 - val_accuracy30: 0.6175 - 78s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 79s - loss: 2.6343 - accuracy30: 0.5852 - val_loss: 2.6504 - val_accuracy30: 0.6200 - 79s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 78s - loss: 2.6279 - accuracy30: 0.5862 - val_loss: 2.6340 - val_accuracy30: 0.6220 - 78s/epoch - 27ms/step
Epoch 12/50
2948/2948 - 78s - loss: 2.6212 - accuracy30: 0.5875 - val_loss: 2.6249 - val_accuracy30: 0.6194 - 78s/epoch - 26ms/step
Epoch 13/50
2948/2948 - 78s - loss: 2.6157 - accuracy30: 0.5888 - val_loss: 2.6317 - val_accuracy30: 0.6216 - 78s/epoch - 27ms/step
Epoch 14/50
2948/2948 - 78s - loss: 2.6096 - accuracy30: 0.5898 - val_loss: 2.6324 - val_accuracy30: 0.6227 - 78s/epoch - 27ms/step
Epoch 15/50
2948/2948 - 80s - loss: 2.6049 - accuracy30: 0.5906 - val_loss: 2.6170 - val_accuracy30: 0.6193 - 80s/epoch - 27ms/step
Epoch 16/50
2948/2948 - 79s - loss: 2.6002 - accuracy30: 0.5917 - val_loss: 2.6202 - val_accuracy30: 0.6224 - 79s/epoch - 27ms/step
Epoch 17/50
2948/2948 - 79s - loss: 2.5959 - accuracy30: 0.5921 - val_loss: 2.6180 - val_accuracy30: 0.6244 - 79s/epoch - 27ms/step
Epoch 18/50
2948/2948 - 79s - loss: 2.5926 - accuracy30: 0.5929 - val_loss: 2.6270 - val_accuracy30: 0.6233 - 79s/epoch - 27ms/step
Epoch 19/50
2948/2948 - 78s - loss: 2.5884 - accuracy30: 0.5935 - val_loss: 2.6286 - val_accuracy30: 0.6189 - 78s/epoch - 26ms/step
Epoch 20/50
2948/2948 - 78s - loss: 2.5845 - accuracy30: 0.5942 - val_loss: 2.6090 - val_accuracy30: 0.6227 - 78s/epoch - 26ms/step
Epoch 21/50
2948/2948 - 78s - loss: 2.5810 - accuracy30: 0.5945 - val_loss: 2.6151 - val_accuracy30: 0.6249 - 78s/epoch - 26ms/step
Epoch 22/50
2948/2948 - 78s - loss: 2.5781 - accuracy30: 0.5946 - val_loss: 2.6134 - val_accuracy30: 0.6251 - 78s/epoch - 26ms/step
Epoch 23/50
2948/2948 - 78s - loss: 2.5749 - accuracy30: 0.5961 - val_loss: 2.6155 - val_accuracy30: 0.6255 - 78s/epoch - 26ms/step
Epoch 24/50
2948/2948 - 78s - loss: 2.5713 - accuracy30: 0.5964 - val_loss: 2.6261 - val_accuracy30: 0.6242 - 78s/epoch - 27ms/step
Epoch 25/50
2948/2948 - 78s - loss: 2.5672 - accuracy30: 0.5967 - val_loss: 2.6199 - val_accuracy30: 0.6191 - 78s/epoch - 26ms/step
Epoch 26/50
2948/2948 - 77s - loss: 2.5655 - accuracy30: 0.5975 - val_loss: 2.6126 - val_accuracy30: 0.6225 - 77s/epoch - 26ms/step
Epoch 27/50
2948/2948 - 78s - loss: 2.5628 - accuracy30: 0.5977 - val_loss: 2.6018 - val_accuracy30: 0.6248 - 78s/epoch - 26ms/step
Epoch 28/50
2948/2948 - 78s - loss: 2.5598 - accuracy30: 0.5983 - val_loss: 2.5967 - val_accuracy30: 0.6236 - 78s/epoch - 26ms/step
Epoch 29/50
2948/2948 - 79s - loss: 2.5570 - accuracy30: 0.5987 - val_loss: 2.6149 - val_accuracy30: 0.6228 - 79s/epoch - 27ms/step
Epoch 30/50
2948/2948 - 78s - loss: 2.5543 - accuracy30: 0.5994 - val_loss: 2.6086 - val_accuracy30: 0.6209 - 78s/epoch - 27ms/step
Epoch 31/50
2948/2948 - 79s - loss: 2.5516 - accuracy30: 0.5992 - val_loss: 2.5910 - val_accuracy30: 0.6192 - 79s/epoch - 27ms/step
Epoch 32/50
2948/2948 - 78s - loss: 2.5489 - accuracy30: 0.5998 - val_loss: 2.6090 - val_accuracy30: 0.6246 - 78s/epoch - 26ms/step
Epoch 33/50
2948/2948 - 80s - loss: 2.5469 - accuracy30: 0.6000 - val_loss: 2.5937 - val_accuracy30: 0.6245 - 80s/epoch - 27ms/step
Epoch 34/50
2948/2948 - 78s - loss: 2.5447 - accuracy30: 0.6004 - val_loss: 2.5936 - val_accuracy30: 0.6239 - 78s/epoch - 27ms/step
Epoch 35/50
2948/2948 - 78s - loss: 2.5411 - accuracy30: 0.6012 - val_loss: 2.5924 - val_accuracy30: 0.6229 - 78s/epoch - 26ms/step
Epoch 36/50
2948/2948 - 79s - loss: 2.5391 - accuracy30: 0.6014 - val_loss: 2.5873 - val_accuracy30: 0.6234 - 79s/epoch - 27ms/step
Epoch 37/50
2948/2948 - 77s - loss: 2.5369 - accuracy30: 0.6019 - val_loss: 2.5950 - val_accuracy30: 0.6228 - 77s/epoch - 26ms/step
Epoch 38/50
2948/2948 - 78s - loss: 2.5342 - accuracy30: 0.6025 - val_loss: 2.5922 - val_accuracy30: 0.6217 - 78s/epoch - 27ms/step
Epoch 39/50
2948/2948 - 79s - loss: 2.5326 - accuracy30: 0.6025 - val_loss: 2.5973 - val_accuracy30: 0.6272 - 79s/epoch - 27ms/step
Epoch 40/50
2948/2948 - 79s - loss: 2.5298 - accuracy30: 0.6029 - val_loss: 2.6084 - val_accuracy30: 0.6226 - 79s/epoch - 27ms/step
Epoch 41/50
2948/2948 - 78s - loss: 2.5266 - accuracy30: 0.6037 - val_loss: 2.5895 - val_accuracy30: 0.6240 - 78s/epoch - 26ms/step
Epoch 42/50
2948/2948 - 78s - loss: 2.5250 - accuracy30: 0.6037 - val_loss: 2.5947 - val_accuracy30: 0.6241 - 78s/epoch - 26ms/step
Epoch 43/50
2948/2948 - 78s - loss: 2.5232 - accuracy30: 0.6041 - val_loss: 2.5982 - val_accuracy30: 0.6250 - 78s/epoch - 27ms/step
Epoch 44/50
2948/2948 - 78s - loss: 2.5214 - accuracy30: 0.6040 - val_loss: 2.5832 - val_accuracy30: 0.6250 - 78s/epoch - 27ms/step
Epoch 45/50
2948/2948 - 78s - loss: 2.5192 - accuracy30: 0.6044 - val_loss: 2.5850 - val_accuracy30: 0.6239 - 78s/epoch - 27ms/step
Epoch 46/50
2948/2948 - 78s - loss: 2.5171 - accuracy30: 0.6051 - val_loss: 2.5860 - val_accuracy30: 0.6209 - 78s/epoch - 26ms/step
Epoch 47/50
2948/2948 - 78s - loss: 2.5147 - accuracy30: 0.6050 - val_loss: 2.5781 - val_accuracy30: 0.6228 - 78s/epoch - 26ms/step
Epoch 48/50
2948/2948 - 78s - loss: 2.5114 - accuracy30: 0.6055 - val_loss: 2.5918 - val_accuracy30: 0.6233 - 78s/epoch - 26ms/step
Epoch 49/50
2948/2948 - 78s - loss: 2.5101 - accuracy30: 0.6058 - val_loss: 2.6025 - val_accuracy30: 0.6198 - 78s/epoch - 26ms/step
Epoch 50/50
2948/2948 - 78s - loss: 2.5084 - accuracy30: 0.6063 - val_loss: 2.5945 - val_accuracy30: 0.6209 - 78s/epoch - 27ms/step
testing model: results/ATVI/W1/deepVOL_L2/h30
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8665366
{'0': {'precision': 0.5450260156545832, 'recall': 0.4324360079177954, 'f1-score': 0.48224661160671206, 'support': 808811}, '1': {'precision': 0.6227947196042973, 'recall': 0.7862528046349659, 'f1-score': 0.6950426959730804, 'support': 1477465}, '2': {'precision': 0.569298507924396, 'recall': 0.4127511008440427, 'f1-score': 0.47854728265580304, 'support': 802566}, 'accuracy': 0.5965601348337014, 'macro avg': {'precision': 0.5790397477277588, 'recall': 0.5438133044656014, 'f1-score': 0.5519455300785319, 'support': 3088842}, 'weighted avg': {'precision': 0.5885312565222219, 'recall': 0.5965601348337014, 'f1-score': 0.583070742834383, 'support': 3088842}}
[[ 349759  344016  115036]
 [ 180226 1161661  135578]
 [ 111744  359562  331260]]
Evaluating performance on  train set...
2948/2948 - 39s - 39s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8678275
{'0': {'precision': 0.5406423450838262, 'recall': 0.47611711096836357, 'f1-score': 0.5063322890704638, 'support': 199264}, '1': {'precision': 0.634790393064537, 'recall': 0.7528827643244119, 'f1-score': 0.6888116893408386, 'support': 357903}, '2': {'precision': 0.5597773678930849, 'recall': 0.4383549147302537, 'f1-score': 0.4916806412187704, 'support': 197315}, 'accuracy': 0.5975304911184097, 'macro avg': {'precision': 0.5784033686804827, 'recall': 0.5557849300076764, 'f1-score': 0.5622748732100243, 'support': 754482}, 'weighted avg': {'precision': 0.5903075403330823, 'recall': 0.5975304911184097, 'f1-score': 0.5890631360609965, 'support': 754482}}
[[ 94873  76469  27922]
 [ 48345 269459  40099]
 [ 32264  78557  86494]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82585585
{'0': {'precision': 0.5238996544990235, 'recall': 0.42515116052272284, 'f1-score': 0.4693880297707972, 'support': 41016}, '1': {'precision': 0.6803479931682322, 'recall': 0.7854135431000842, 'f1-score': 0.7291152273182263, 'support': 97378}, '2': {'precision': 0.5226459524756109, 'recall': 0.42718592211168327, 'f1-score': 0.4701189739357678, 'support': 40006}, 'accuracy': 0.6222533632286995, 'macro avg': {'precision': 0.5756312000476222, 'recall': 0.54591687524483, 'f1-score': 0.5562074103415972, 'support': 178400}, 'weighted avg': {'precision': 0.6090144006861399, 'recall': 0.6222533632286995, 'f1-score': 0.611321646334908, 'support': 178400}}
[[17438 17995  5583]
 [10870 76482 10026]
 [ 4977 17939 17090]]
training model: results/ATVI/W1/deepVOL_L2/h50
Epoch 1/50
2948/2948 - 83s - loss: 3.0281 - accuracy50: 0.4856 - val_loss: 2.9583 - val_accuracy50: 0.5190 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 79s - loss: 2.9222 - accuracy50: 0.5154 - val_loss: 2.9657 - val_accuracy50: 0.5288 - 79s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 78s - loss: 2.8777 - accuracy50: 0.5267 - val_loss: 2.8726 - val_accuracy50: 0.5392 - 78s/epoch - 26ms/step
Epoch 4/50
2948/2948 - 78s - loss: 2.8546 - accuracy50: 0.5315 - val_loss: 2.8622 - val_accuracy50: 0.5423 - 78s/epoch - 26ms/step
Epoch 5/50
2948/2948 - 78s - loss: 2.8403 - accuracy50: 0.5353 - val_loss: 2.8678 - val_accuracy50: 0.5400 - 78s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 79s - loss: 2.8297 - accuracy50: 0.5379 - val_loss: 2.8477 - val_accuracy50: 0.5438 - 79s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 78s - loss: 2.8194 - accuracy50: 0.5393 - val_loss: 2.8392 - val_accuracy50: 0.5441 - 78s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 78s - loss: 2.8107 - accuracy50: 0.5412 - val_loss: 2.8375 - val_accuracy50: 0.5450 - 78s/epoch - 27ms/step
Epoch 9/50
2948/2948 - 78s - loss: 2.8021 - accuracy50: 0.5424 - val_loss: 2.8388 - val_accuracy50: 0.5437 - 78s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 80s - loss: 2.7955 - accuracy50: 0.5435 - val_loss: 2.8298 - val_accuracy50: 0.5440 - 80s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 80s - loss: 2.7899 - accuracy50: 0.5446 - val_loss: 2.8416 - val_accuracy50: 0.5439 - 80s/epoch - 27ms/step
Epoch 12/50
2948/2948 - 79s - loss: 2.7857 - accuracy50: 0.5451 - val_loss: 2.8322 - val_accuracy50: 0.5435 - 79s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 79s - loss: 2.7805 - accuracy50: 0.5468 - val_loss: 2.8332 - val_accuracy50: 0.5439 - 79s/epoch - 27ms/step
Epoch 14/50
2948/2948 - 79s - loss: 2.7771 - accuracy50: 0.5473 - val_loss: 2.8388 - val_accuracy50: 0.5427 - 79s/epoch - 27ms/step
Epoch 15/50
2948/2948 - 78s - loss: 2.7728 - accuracy50: 0.5480 - val_loss: 2.8298 - val_accuracy50: 0.5439 - 78s/epoch - 26ms/step
Epoch 16/50
2948/2948 - 80s - loss: 2.7685 - accuracy50: 0.5495 - val_loss: 2.8227 - val_accuracy50: 0.5456 - 80s/epoch - 27ms/step
Epoch 17/50
2948/2948 - 79s - loss: 2.7655 - accuracy50: 0.5498 - val_loss: 2.8266 - val_accuracy50: 0.5475 - 79s/epoch - 27ms/step
Epoch 18/50
2948/2948 - 81s - loss: 2.7631 - accuracy50: 0.5504 - val_loss: 2.8283 - val_accuracy50: 0.5465 - 81s/epoch - 27ms/step
Epoch 19/50
2948/2948 - 78s - loss: 2.7591 - accuracy50: 0.5512 - val_loss: 2.8275 - val_accuracy50: 0.5471 - 78s/epoch - 27ms/step
Epoch 20/50
2948/2948 - 79s - loss: 2.7574 - accuracy50: 0.5516 - val_loss: 2.8216 - val_accuracy50: 0.5479 - 79s/epoch - 27ms/step
Epoch 21/50
2948/2948 - 80s - loss: 2.7546 - accuracy50: 0.5517 - val_loss: 2.8242 - val_accuracy50: 0.5471 - 80s/epoch - 27ms/step
Epoch 22/50
2948/2948 - 80s - loss: 2.7513 - accuracy50: 0.5526 - val_loss: 2.8346 - val_accuracy50: 0.5445 - 80s/epoch - 27ms/step
Epoch 23/50
2948/2948 - 79s - loss: 2.7492 - accuracy50: 0.5531 - val_loss: 2.8160 - val_accuracy50: 0.5474 - 79s/epoch - 27ms/step
Epoch 24/50
2948/2948 - 79s - loss: 2.7472 - accuracy50: 0.5536 - val_loss: 2.8260 - val_accuracy50: 0.5457 - 79s/epoch - 27ms/step
Epoch 25/50
2948/2948 - 80s - loss: 2.7440 - accuracy50: 0.5542 - val_loss: 2.8275 - val_accuracy50: 0.5472 - 80s/epoch - 27ms/step
Epoch 26/50
2948/2948 - 79s - loss: 2.7419 - accuracy50: 0.5543 - val_loss: 2.8248 - val_accuracy50: 0.5468 - 79s/epoch - 27ms/step
Epoch 27/50
2948/2948 - 79s - loss: 2.7391 - accuracy50: 0.5547 - val_loss: 2.8284 - val_accuracy50: 0.5461 - 79s/epoch - 27ms/step
Epoch 28/50
2948/2948 - 79s - loss: 2.7372 - accuracy50: 0.5558 - val_loss: 2.8200 - val_accuracy50: 0.5458 - 79s/epoch - 27ms/step
Epoch 29/50
2948/2948 - 85s - loss: 2.7353 - accuracy50: 0.5556 - val_loss: 2.8128 - val_accuracy50: 0.5485 - 85s/epoch - 29ms/step
Epoch 30/50
2948/2948 - 79s - loss: 2.7328 - accuracy50: 0.5566 - val_loss: 2.8141 - val_accuracy50: 0.5471 - 79s/epoch - 27ms/step
Epoch 31/50
2948/2948 - 79s - loss: 2.7307 - accuracy50: 0.5571 - val_loss: 2.8354 - val_accuracy50: 0.5448 - 79s/epoch - 27ms/step
Epoch 32/50
2948/2948 - 79s - loss: 2.7277 - accuracy50: 0.5577 - val_loss: 2.8252 - val_accuracy50: 0.5457 - 79s/epoch - 27ms/step
Epoch 33/50
2948/2948 - 78s - loss: 2.7253 - accuracy50: 0.5580 - val_loss: 2.8232 - val_accuracy50: 0.5481 - 78s/epoch - 27ms/step
Epoch 34/50
2948/2948 - 80s - loss: 2.7232 - accuracy50: 0.5582 - val_loss: 2.8304 - val_accuracy50: 0.5466 - 80s/epoch - 27ms/step
Epoch 35/50
2948/2948 - 79s - loss: 2.7221 - accuracy50: 0.5588 - val_loss: 2.8357 - val_accuracy50: 0.5460 - 79s/epoch - 27ms/step
Epoch 36/50
2948/2948 - 78s - loss: 2.7193 - accuracy50: 0.5590 - val_loss: 2.8228 - val_accuracy50: 0.5484 - 78s/epoch - 27ms/step
Epoch 37/50
2948/2948 - 78s - loss: 2.7173 - accuracy50: 0.5599 - val_loss: 2.8252 - val_accuracy50: 0.5478 - 78s/epoch - 27ms/step
Epoch 38/50
2948/2948 - 78s - loss: 2.7148 - accuracy50: 0.5599 - val_loss: 2.8247 - val_accuracy50: 0.5471 - 78s/epoch - 26ms/step
Epoch 39/50
2948/2948 - 80s - loss: 2.7127 - accuracy50: 0.5604 - val_loss: 2.8361 - val_accuracy50: 0.5486 - 80s/epoch - 27ms/step
testing model: results/ATVI/W1/deepVOL_L2/h50
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9746656
{'0': {'precision': 0.5760080965917259, 'recall': 0.31004821417701095, 'f1-score': 0.40311271310695823, 'support': 969217}, '1': {'precision': 0.4846575059950524, 'recall': 0.7958581389703144, 'f1-score': 0.6024426523420551, 'support': 1157499}, '2': {'precision': 0.5587306255786629, 'recall': 0.3869992080039413, 'f1-score': 0.45727289529902065, 'support': 962126}, 'accuracy': 0.5160675100895417, 'macro avg': {'precision': 0.5397987427218137, 'recall': 0.49763518705042226, 'f1-score': 0.4876094202493446, 'support': 3088842}, 'weighted avg': {'precision': 0.5363941178446832, 'recall': 0.5160675100895417, 'f1-score': 0.4946787837529821, 'support': 3088842}}
[[300504 511683 157030]
 [ 99259 921205 137035]
 [121938 467846 372342]]
Evaluating performance on  train set...
2948/2948 - 42s - 42s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.967306
{'0': {'precision': 0.5677003011549789, 'recall': 0.36124752558648865, 'f1-score': 0.4415325019626012, 'support': 237430}, '1': {'precision': 0.49555903501046167, 'recall': 0.7583613828907209, 'f1-score': 0.5994205528985037, 'support': 280456}, '2': {'precision': 0.5516414003708147, 'recall': 0.4061860724610729, 'f1-score': 0.46786934010374703, 'support': 236596}, 'accuracy': 0.5229548219838247, 'macro avg': {'precision': 0.538300245512085, 'recall': 0.5085983269794274, 'f1-score': 0.5029407983216173, 'support': 754482}, 'weighted avg': {'precision': 0.5358480864861639, 'recall': 0.5229548219838247, 'f1-score': 0.5084815368900375, 'support': 754482}}
[[ 85771 112052  39607]
 [ 29267 212687  38502]
 [ 36047 104447  96102]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9309512
{'0': {'precision': 0.5542398642677884, 'recall': 0.3126557795457718, 'f1-score': 0.3997858290201678, 'support': 50151}, '1': {'precision': 0.5575158341730243, 'recall': 0.7794940816865621, 'f1-score': 0.6500778910155204, 'support': 79499}, '2': {'precision': 0.5182893960007188, 'recall': 0.41417435897435895, 'f1-score': 0.4604193507929812, 'support': 48750}, 'accuracy': 0.5484304932735427, 'macro avg': {'precision': 0.5433483648138439, 'recall': 0.502108073402231, 'f1-score': 0.5034276902762231, 'support': 178400}, 'weighted avg': {'precision': 0.5458758003859313, 'recall': 0.5484304932735427, 'f1-score': 0.5278903852028649, 'support': 178400}}
[[15680 26196  8275]
 [ 7039 61969 10491]
 [ 5572 22987 20191]]
training model: results/ATVI/W1/deepVOL_L2/h100
Epoch 1/50
2948/2948 - 83s - loss: 3.1880 - accuracy100: 0.4293 - val_loss: 3.1650 - val_accuracy100: 0.4367 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 80s - loss: 3.1362 - accuracy100: 0.4475 - val_loss: 3.1442 - val_accuracy100: 0.4424 - 80s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 80s - loss: 3.1121 - accuracy100: 0.4564 - val_loss: 3.1405 - val_accuracy100: 0.4406 - 80s/epoch - 27ms/step
Epoch 4/50
2948/2948 - 79s - loss: 3.1027 - accuracy100: 0.4595 - val_loss: 3.1323 - val_accuracy100: 0.4456 - 79s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 79s - loss: 3.0962 - accuracy100: 0.4616 - val_loss: 3.1242 - val_accuracy100: 0.4486 - 79s/epoch - 27ms/step
Epoch 6/50
2948/2948 - 79s - loss: 3.0908 - accuracy100: 0.4633 - val_loss: 3.1174 - val_accuracy100: 0.4512 - 79s/epoch - 27ms/step
Epoch 7/50
2948/2948 - 79s - loss: 3.0858 - accuracy100: 0.4646 - val_loss: 3.1217 - val_accuracy100: 0.4488 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 80s - loss: 3.0831 - accuracy100: 0.4654 - val_loss: 3.1195 - val_accuracy100: 0.4489 - 80s/epoch - 27ms/step
Epoch 9/50
2948/2948 - 79s - loss: 3.0795 - accuracy100: 0.4670 - val_loss: 3.1241 - val_accuracy100: 0.4473 - 79s/epoch - 27ms/step
Epoch 10/50
2948/2948 - 80s - loss: 3.0763 - accuracy100: 0.4682 - val_loss: 3.1308 - val_accuracy100: 0.4470 - 80s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 81s - loss: 3.0737 - accuracy100: 0.4688 - val_loss: 3.1273 - val_accuracy100: 0.4488 - 81s/epoch - 27ms/step
Epoch 12/50
2948/2948 - 80s - loss: 3.0709 - accuracy100: 0.4693 - val_loss: 3.1324 - val_accuracy100: 0.4476 - 80s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 78s - loss: 3.0685 - accuracy100: 0.4705 - val_loss: 3.1279 - val_accuracy100: 0.4508 - 78s/epoch - 27ms/step
Epoch 14/50
2948/2948 - 78s - loss: 3.0649 - accuracy100: 0.4717 - val_loss: 3.1276 - val_accuracy100: 0.4510 - 78s/epoch - 27ms/step
Epoch 15/50
2948/2948 - 79s - loss: 3.0627 - accuracy100: 0.4718 - val_loss: 3.1251 - val_accuracy100: 0.4507 - 79s/epoch - 27ms/step
Epoch 16/50
2948/2948 - 79s - loss: 3.0602 - accuracy100: 0.4733 - val_loss: 3.1235 - val_accuracy100: 0.4528 - 79s/epoch - 27ms/step
testing model: results/ATVI/W1/deepVOL_L2/h100
Evaluating performance on  test set...
12066/12066 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0613278
{'0': {'precision': 0.4854003411695719, 'recall': 0.21926537295732085, 'f1-score': 0.30207652992463113, 'support': 996669}, '1': {'precision': 0.4129591122488414, 'recall': 0.638563269933194, 'f1-score': 0.5015595017941867, 'support': 1072658}, '2': {'precision': 0.4492526758663337, 'recall': 0.43182395550825636, 'f1-score': 0.4403659355091678, 'support': 1019515}, 'accuracy': 0.43503228718076226, 'macro avg': {'precision': 0.44920404309491574, 'recall': 0.42988419946625706, 'f1-score': 0.4146673224093285, 'support': 3088842}, 'weighted avg': {'precision': 0.4483127365840075, 'recall': 0.43503228718076226, 'f1-score': 0.4169950427440543, 'support': 3088842}}
[[218535 515878 262256]
 [110242 684960 277456]
 [121439 457825 440251]]
Evaluating performance on  train set...
2948/2948 - 41s - 41s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0565525
{'0': {'precision': 0.4963390166798694, 'recall': 0.26573598427194317, 'f1-score': 0.3461473922258565, 'support': 252288}, '1': {'precision': 0.4076280991050941, 'recall': 0.59250830804797, 'f1-score': 0.4829801886746156, 'support': 249156}, '2': {'precision': 0.4534923497947506, 'recall': 0.461037472632569, 'f1-score': 0.45723378654323266, 'support': 253038}, 'accuracy': 0.4391476536219552, 'macro avg': {'precision': 0.4524864885265714, 'recall': 0.43976058831749404, 'f1-score': 0.4287871224812349, 'support': 754482}, 'weighted avg': {'precision': 0.4526737042210733, 'recall': 0.4391476536219552, 'f1-score': 0.4285904343093883, 'support': 754482}}
[[ 67042 115129  70117]
 [ 31058 147627  70471]
 [ 36973  99405 116660]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0387871
{'0': {'precision': 0.4870803506488535, 'recall': 0.22926539216922828, 'f1-score': 0.31177868711866896, 'support': 55499}, '1': {'precision': 0.4568272665419289, 'recall': 0.62790052019405, 'f1-score': 0.5288738461538461, 'support': 68436}, '2': {'precision': 0.42554068678817447, 'recall': 0.454824199026898, 'f1-score': 0.43969541525408684, 'support': 54465}, 'accuracy': 0.4510482062780269, 'macro avg': {'precision': 0.45648276799298565, 'recall': 0.43733003713005875, 'f1-score': 0.42678264950886735, 'support': 178400}, 'weighted avg': {'precision': 0.4566870891235543, 'recall': 0.4510482062780269, 'f1-score': 0.4341111361188199, 'support': 178400}}
[[12724 27892 14883]
 [ 6907 42971 18558]
 [ 6492 23201 24772]]
training model: results/ATVI/W1/deepVOL_L2/h200
Epoch 1/50
2948/2948 - 83s - loss: 3.2707 - accuracy200: 0.3827 - val_loss: 3.3102 - val_accuracy200: 0.3588 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 81s - loss: 3.2499 - accuracy200: 0.3948 - val_loss: 3.3034 - val_accuracy200: 0.3690 - 81s/epoch - 27ms/step
Epoch 3/50
2948/2948 - 78s - loss: 3.2346 - accuracy200: 0.4042 - val_loss: 3.2972 - val_accuracy200: 0.3712 - 78s/epoch - 26ms/step
Epoch 4/50
2948/2948 - 79s - loss: 3.2261 - accuracy200: 0.4087 - val_loss: 3.2817 - val_accuracy200: 0.3814 - 79s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 78s - loss: 3.2217 - accuracy200: 0.4108 - val_loss: 3.2863 - val_accuracy200: 0.3815 - 78s/epoch - 26ms/step
Epoch 6/50
2948/2948 - 78s - loss: 3.2155 - accuracy200: 0.4150 - val_loss: 3.2927 - val_accuracy200: 0.3814 - 78s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 78s - loss: 3.2120 - accuracy200: 0.4166 - val_loss: 3.2997 - val_accuracy200: 0.3788 - 78s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 80s - loss: 3.2085 - accuracy200: 0.4183 - val_loss: 3.3046 - val_accuracy200: 0.3815 - 80s/epoch - 27ms/step
Epoch 9/50
2948/2948 - 78s - loss: 3.2058 - accuracy200: 0.4196 - val_loss: 3.3072 - val_accuracy200: 0.3788 - 78s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 78s - loss: 3.2030 - accuracy200: 0.4215 - val_loss: 3.3062 - val_accuracy200: 0.3749 - 78s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 78s - loss: 3.2011 - accuracy200: 0.4221 - val_loss: 3.2933 - val_accuracy200: 0.3811 - 78s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 77s - loss: 3.1976 - accuracy200: 0.4238 - val_loss: 3.3002 - val_accuracy200: 0.3827 - 77s/epoch - 26ms/step
Epoch 13/50
2948/2948 - 78s - loss: 3.1955 - accuracy200: 0.4245 - val_loss: 3.2944 - val_accuracy200: 0.3846 - 78s/epoch - 26ms/step
Epoch 14/50
2948/2948 - 79s - loss: 3.1924 - accuracy200: 0.4260 - val_loss: 3.3181 - val_accuracy200: 0.3757 - 79s/epoch - 27ms/step
testing model: results/ATVI/W1/deepVOL_L2/h200
Evaluating performance on  test set...
12066/12066 - 172s - 172s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021754
{'0': {'precision': 0.4069934663882351, 'recall': 0.2381172862555325, 'f1-score': 0.3004512925662365, 'support': 1004295}, '1': {'precision': 0.35303206489765143, 'recall': 0.6113031650316044, 'f1-score': 0.44758215179053246, 'support': 1045424}, '2': {'precision': 0.40375960522698, 'recall': 0.2685052683849746, 'f1-score': 0.32252638928464705, 'support': 1039123}, 'accuracy': 0.3746455791523166, 'macro avg': {'precision': 0.3879283788376222, 'recall': 0.3726419065573705, 'f1-score': 0.356853277880472, 'support': 3088842}, 'weighted avg': {'precision': 0.387642226116522, 'recall': 0.3746455791523166, 'f1-score': 0.3576743140419304, 'support': 3088842}}
[[239140 572214 192941]
 [187274 639071 219079]
 [161163 598950 279010]]
Evaluating performance on  train set...
2948/2948 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012617
{'0': {'precision': 0.4232477299009847, 'recall': 0.24556144892093185, 'f1-score': 0.310801134607799, 'support': 251884}, '1': {'precision': 0.34604515886341325, 'recall': 0.6035509113312317, 'f1-score': 0.43988360430127593, 'support': 249964}, '2': {'precision': 0.4164563644696614, 'recall': 0.28414623526524535, 'f1-score': 0.3378077904965823, 'support': 252634}, 'accuracy': 0.3770852054787258, 'macro avg': {'precision': 0.3952497510780198, 'recall': 0.3777528651724696, 'f1-score': 0.3628308431352191, 'support': 754482}, 'weighted avg': {'precision': 0.39539604718196364, 'recall': 0.3770852054787258, 'f1-score': 0.3626098854570799, 'support': 754482}}
[[ 61853 143365  46666]
 [ 45178 150866  53920]
 [ 39108 141741  71785]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0941541
{'0': {'precision': 0.4198338860681478, 'recall': 0.24309213880297725, 'f1-score': 0.30790258181857316, 'support': 58846}, '1': {'precision': 0.36231416868932037, 'recall': 0.61338683788122, 'f1-score': 0.4555468135326515, 'support': 62300}, '2': {'precision': 0.4001029468536868, 'recall': 0.27152688021797605, 'f1-score': 0.3235076839838101, 'support': 57254}, 'accuracy': 0.38153026905829596, 'macro avg': {'precision': 0.3940836672037183, 'recall': 0.37600195230072436, 'f1-score': 0.36231902644501157, 'support': 178400}, 'weighted avg': {'precision': 0.39341486372237594, 'recall': 0.38153026905829596, 'f1-score': 0.36447035174657516, 'support': 178400}}
[[14305 34125 10416]
 [11193 38214 12893]
 [ 8575 33133 15546]]
training model: results/ATVI/W1/deepVOL_L2/h300
Epoch 1/50
2948/2948 - 82s - loss: 3.2845 - accuracy300: 0.3716 - val_loss: 3.3470 - val_accuracy300: 0.3361 - 82s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 77s - loss: 3.2621 - accuracy300: 0.3863 - val_loss: 3.3186 - val_accuracy300: 0.3536 - 77s/epoch - 26ms/step
Epoch 3/50
2948/2948 - 78s - loss: 3.2538 - accuracy300: 0.3919 - val_loss: 3.3142 - val_accuracy300: 0.3609 - 78s/epoch - 26ms/step
Epoch 4/50
2948/2948 - 78s - loss: 3.2467 - accuracy300: 0.3968 - val_loss: 3.3153 - val_accuracy300: 0.3643 - 78s/epoch - 27ms/step
Epoch 5/50
2948/2948 - 78s - loss: 3.2425 - accuracy300: 0.3994 - val_loss: 3.3136 - val_accuracy300: 0.3725 - 78s/epoch - 26ms/step
Epoch 6/50
2948/2948 - 78s - loss: 3.2387 - accuracy300: 0.4019 - val_loss: 3.3259 - val_accuracy300: 0.3703 - 78s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 79s - loss: 3.2361 - accuracy300: 0.4037 - val_loss: 3.3253 - val_accuracy300: 0.3739 - 79s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 78s - loss: 3.2334 - accuracy300: 0.4060 - val_loss: 3.3311 - val_accuracy300: 0.3729 - 78s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 79s - loss: 3.2301 - accuracy300: 0.4079 - val_loss: 3.3323 - val_accuracy300: 0.3735 - 79s/epoch - 27ms/step
Epoch 10/50
2948/2948 - 78s - loss: 3.2277 - accuracy300: 0.4093 - val_loss: 3.3383 - val_accuracy300: 0.3712 - 78s/epoch - 27ms/step
Epoch 11/50
2948/2948 - 77s - loss: 3.2252 - accuracy300: 0.4106 - val_loss: 3.3318 - val_accuracy300: 0.3743 - 77s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 78s - loss: 3.2231 - accuracy300: 0.4117 - val_loss: 3.3442 - val_accuracy300: 0.3735 - 78s/epoch - 27ms/step
Epoch 13/50
2948/2948 - 79s - loss: 3.2209 - accuracy300: 0.4134 - val_loss: 3.3503 - val_accuracy300: 0.3742 - 79s/epoch - 27ms/step
Epoch 14/50
2948/2948 - 78s - loss: 3.2178 - accuracy300: 0.4143 - val_loss: 3.3381 - val_accuracy300: 0.3777 - 78s/epoch - 27ms/step
Epoch 15/50
2948/2948 - 78s - loss: 3.2144 - accuracy300: 0.4159 - val_loss: 3.3514 - val_accuracy300: 0.3781 - 78s/epoch - 27ms/step
testing model: results/ATVI/W1/deepVOL_L2/h300
Evaluating performance on  test set...
12066/12066 - 186s - 186s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977776
{'0': {'precision': 0.3528079540404662, 'recall': 0.21102944708651583, 'f1-score': 0.26409339756486616, 'support': 936765}, '1': {'precision': 0.392827343189717, 'recall': 0.5731135990556467, 'f1-score': 0.4661458741765162, 'support': 1192774}, '2': {'precision': 0.3552213473781952, 'recall': 0.29191194023160566, 'f1-score': 0.3204698466612575, 'support': 959303}, 'accuracy': 0.3759700237176262, 'macro avg': {'precision': 0.3669522148694595, 'recall': 0.35868499545792276, 'f1-score': 0.35023637280087994, 'support': 3088842}, 'weighted avg': {'precision': 0.36901119860337095, 'recall': 0.3759700237176262, 'f1-score': 0.3596259749791527, 'support': 3088842}}
[[197685 521041 218039]
 [218919 683595 290260]
 [143715 535556 280032]]
Evaluating performance on  train set...
2948/2948 - 44s - 44s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109935
{'0': {'precision': 0.4121261530564488, 'recall': 0.21493557365625898, 'f1-score': 0.28252584188260865, 'support': 254011}, '1': {'precision': 0.34277277491631636, 'recall': 0.617476753157104, 'f1-score': 0.44083170871351857, 'support': 246270}, '2': {'precision': 0.40491554215043757, 'recall': 0.2841294880822656, 'f1-score': 0.3339359277256609, 'support': 254201}, 'accuracy': 0.36964168793954, 'macro avg': {'precision': 0.3866048233744009, 'recall': 0.3721806049652095, 'f1-score': 0.352431159440596, 'support': 754482}, 'weighted avg': {'precision': 0.38705915220355985, 'recall': 0.36964168793954, 'f1-score': 0.3515195104603055, 'support': 754482}}
[[ 54596 146849  52566]
 [ 40623 152066  53581]
 [ 37255 144720  72226]]
Evaluating performance on  val set...
697/697 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1067374
{'0': {'precision': 0.41538072350113836, 'recall': 0.2146861261379051, 'f1-score': 0.2830698947323054, 'support': 61187}, '1': {'precision': 0.3459605172483684, 'recall': 0.5866542936192882, 'f1-score': 0.4352476939063028, 'support': 58191}, '2': {'precision': 0.3973180873180873, 'recall': 0.3237945172986344, 'f1-score': 0.35680812531506134, 'support': 59022}, 'accuracy': 0.37211322869955155, 'macro avg': {'precision': 0.3862197760225314, 'recall': 0.3750449790186092, 'f1-score': 0.35837523798455645, 'support': 178400}, 'weighted avg': {'precision': 0.38676119359726513, 'recall': 0.37211322869955155, 'f1-score': 0.3571032812636367, 'support': 178400}}
[[13136 33327 14724]
 [ 9788 34138 14265]
 [ 8700 31211 19111]]
training model: results/ATVI/W1/deepVOL_L2/h500
Epoch 1/50
2948/2948 - 83s - loss: 3.2693 - accuracy500: 0.3794 - val_loss: 3.3018 - val_accuracy500: 0.3497 - 83s/epoch - 28ms/step
Epoch 2/50
2948/2948 - 77s - loss: 3.2668 - accuracy500: 0.3836 - val_loss: 3.3087 - val_accuracy500: 0.3446 - 77s/epoch - 26ms/step
Epoch 3/50
2948/2948 - 77s - loss: 3.2590 - accuracy500: 0.3882 - val_loss: 3.2914 - val_accuracy500: 0.3487 - 77s/epoch - 26ms/step
Epoch 4/50
2948/2948 - 78s - loss: 3.2553 - accuracy500: 0.3904 - val_loss: 3.3275 - val_accuracy500: 0.3394 - 78s/epoch - 26ms/step
Epoch 5/50
2948/2948 - 76s - loss: 3.2533 - accuracy500: 0.3933 - val_loss: 3.3496 - val_accuracy500: 0.3421 - 76s/epoch - 26ms/step
Epoch 6/50
2948/2948 - 76s - loss: 3.2482 - accuracy500: 0.3929 - val_loss: 3.3218 - val_accuracy500: 0.3348 - 76s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 80s - loss: 3.2458 - accuracy500: 0.3956 - val_loss: 3.3165 - val_accuracy500: 0.3315 - 80s/epoch - 27ms/step
Epoch 8/50
2948/2948 - 76s - loss: 3.2443 - accuracy500: 0.3967 - val_loss: 3.3222 - val_accuracy500: 0.3396 - 76s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 77s - loss: 3.2421 - accuracy500: 0.3975 - val_loss: 3.3019 - val_accuracy500: 0.3424 - 77s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 76s - loss: 3.2396 - accuracy500: 0.3991 - val_loss: 3.3061 - val_accuracy500: 0.3434 - 76s/epoch - 26ms/step
Epoch 11/50
2948/2948 - 76s - loss: 3.2339 - accuracy500: 0.4034 - val_loss: 3.3154 - val_accuracy500: 0.3389 - 76s/epoch - 26ms/step
Epoch 12/50
2948/2948 - 77s - loss: 3.2320 - accuracy500: 0.4032 - val_loss: 3.3142 - val_accuracy500: 0.3396 - 77s/epoch - 26ms/step
Epoch 13/50
2948/2948 - 76s - loss: 3.2289 - accuracy500: 0.4049 - val_loss: 3.3142 - val_accuracy500: 0.3409 - 76s/epoch - 26ms/step
testing model: results/ATVI/W1/deepVOL_L2/h500
Evaluating performance on  test set...
12066/12066 - 161s - 161s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0909138
{'0': {'precision': 0.2739757072846086, 'recall': 0.31970282762686525, 'f1-score': 0.2950782390440334, 'support': 775173}, '1': {'precision': 0.47883889443311495, 'recall': 0.2949441524244269, 'f1-score': 0.36503961269243507, 'support': 1496663}, '2': {'precision': 0.27513701956019077, 'recall': 0.4251327407632257, 'f1-score': 0.33407055920000656, 'support': 817006}, 'accuracy': 0.3355927561202548, 'macro avg': {'precision': 0.34265054042597143, 'recall': 0.34659324027150595, 'f1-score': 0.33139613697882503, 'support': 3088842}, 'weighted avg': {'precision': 0.3735469871895922, 'recall': 0.3355927561202548, 'f1-score': 0.3392907817671927, 'support': 3088842}}
[[247825 231707 295641]
 [435797 441432 619434]
 [220929 248741 347336]]
Evaluating performance on  train set...
2948/2948 - 38s - 38s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972445
{'0': {'precision': 0.36465219536260485, 'recall': 0.3523159236883185, 'f1-score': 0.35837792956320946, 'support': 251757}, '1': {'precision': 0.3270738460834344, 'recall': 0.2859864098028701, 'f1-score': 0.3051532833313051, 'support': 249886}, '2': {'precision': 0.3610318807707679, 'recall': 0.41801699895981237, 'f1-score': 0.38744029355591963, 'support': 252839}, 'accuracy': 0.3523649338221455, 'macro avg': {'precision': 0.35091930740560245, 'recall': 0.35210644415033365, 'f1-score': 0.35032383548347806, 'support': 754482}, 'weighted avg': {'precision': 0.35099294290984884, 'recall': 0.3523649338221455, 'f1-score': 0.35048908012909064, 'support': 754482}}
[[ 88698  73486  89573]
 [ 80939  71464  97483]
 [ 73603  73545 105691]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971636
{'0': {'precision': 0.3591175846708619, 'recall': 0.3433032545878536, 'f1-score': 0.35103239740820735, 'support': 59178}, '1': {'precision': 0.35234491147452357, 'recall': 0.2901179612730915, 'f1-score': 0.31821788220933783, 'support': 62902}, '2': {'precision': 0.33871635610766043, 'recall': 0.4212002840909091, 'f1-score': 0.3754817775315579, 'support': 56320}, 'accuracy': 0.34914237668161435, 'macro avg': {'precision': 0.350059617417682, 'recall': 0.35154049998395137, 'f1-score': 0.3482440190497011, 'support': 178400}, 'weighted avg': {'precision': 0.3502890427309764, 'recall': 0.34914237668161435, 'f1-score': 0.3471808864973767, 'support': 178400}}
[[20316 17001 21861]
 [20201 18249 24452]
 [16055 16543 23722]]
training model: results/ATVI/W1/deepVOL_L2/h1000
Epoch 1/50
2948/2948 - 79s - loss: 3.2815 - accuracy1000: 0.3763 - val_loss: 3.3049 - val_accuracy1000: 0.3552 - 79s/epoch - 27ms/step
Epoch 2/50
2948/2948 - 76s - loss: 3.2542 - accuracy1000: 0.3898 - val_loss: 3.3093 - val_accuracy1000: 0.3554 - 76s/epoch - 26ms/step
Epoch 3/50
2948/2948 - 76s - loss: 3.2482 - accuracy1000: 0.3933 - val_loss: 3.3246 - val_accuracy1000: 0.3556 - 76s/epoch - 26ms/step
Epoch 4/50
2948/2948 - 76s - loss: 3.2427 - accuracy1000: 0.3978 - val_loss: 3.3306 - val_accuracy1000: 0.3556 - 76s/epoch - 26ms/step
Epoch 5/50
2948/2948 - 76s - loss: 3.2387 - accuracy1000: 0.3999 - val_loss: 3.3443 - val_accuracy1000: 0.3573 - 76s/epoch - 26ms/step
Epoch 6/50
2948/2948 - 76s - loss: 3.2349 - accuracy1000: 0.4020 - val_loss: 3.3316 - val_accuracy1000: 0.3588 - 76s/epoch - 26ms/step
Epoch 7/50
2948/2948 - 76s - loss: 3.2324 - accuracy1000: 0.4042 - val_loss: 3.3380 - val_accuracy1000: 0.3602 - 76s/epoch - 26ms/step
Epoch 8/50
2948/2948 - 75s - loss: 3.2290 - accuracy1000: 0.4070 - val_loss: 3.3557 - val_accuracy1000: 0.3599 - 75s/epoch - 26ms/step
Epoch 9/50
2948/2948 - 76s - loss: 3.2242 - accuracy1000: 0.4115 - val_loss: 3.3834 - val_accuracy1000: 0.3536 - 76s/epoch - 26ms/step
Epoch 10/50
2948/2948 - 76s - loss: 3.2225 - accuracy1000: 0.4136 - val_loss: 3.3711 - val_accuracy1000: 0.3571 - 76s/epoch - 26ms/step
Epoch 11/50
2948/2948 - 75s - loss: 3.2153 - accuracy1000: 0.4173 - val_loss: 3.3721 - val_accuracy1000: 0.3550 - 75s/epoch - 26ms/step
testing model: results/ATVI/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
12066/12066 - 164s - 164s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030548
{'0': {'precision': 0.35910224438902744, 'recall': 0.00044863307111145726, 'f1-score': 0.0008961465697500745, 'support': 962925}, '1': {'precision': 0.34998770412291463, 'recall': 0.9982815675213486, 'f1-score': 0.5182737324554345, 'support': 1080636}, '2': {'precision': 0.4071630537229029, 'recall': 0.0020664299838990662, 'f1-score': 0.004111990831783405, 'support': 1045281}, 'accuracy': 0.35008945099814104, 'macro avg': {'precision': 0.3720843340782816, 'recall': 0.33359887685878636, 'f1-score': 0.17442728995232268, 'support': 3088842}, 'weighted avg': {'precision': 0.37217754914929413, 'recall': 0.35008945099814104, 'f1-score': 0.1829897291509326, 'support': 3088842}}
[[    432  960814    1679]
 [    391 1078779    1466]
 [    380 1042741    2160]]
Evaluating performance on  train set...
2948/2948 - 38s - 38s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1082437
{'0': {'precision': 0.379182156133829, 'recall': 0.0004042085240444629, 'f1-score': 0.0008075561924517247, 'support': 252345}, '1': {'precision': 0.330559880541813, 'recall': 0.9980626218382229, 'f1-score': 0.49663386019292677, 'support': 249306}, '2': {'precision': 0.3639432815665091, 'recall': 0.00213185883060226, 'f1-score': 0.0042388876655446855, 'support': 252831}, 'accuracy': 0.33064274561884843, 'macro avg': {'precision': 0.357895106080717, 'recall': 0.3335328963976232, 'f1-score': 0.16722676801697436, 'support': 754482}, 'weighted avg': {'precision': 0.358009106366607, 'recall': 0.33064274561884843, 'f1-score': 0.16579495087226648, 'support': 754482}}
[[   102 251711    532]
 [    73 248823    410]
 [    94 252198    539]]
Evaluating performance on  val set...
697/697 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019536
{'0': {'precision': 0.35384615384615387, 'recall': 0.0003913894324853229, 'f1-score': 0.0007819139894611592, 'support': 58765}, '1': {'precision': 0.3553276110012583, 'recall': 0.9984215676989614, 'f1-score': 0.5241247876703816, 'support': 63354}, '2': {'precision': 0.3573667711598746, 'recall': 0.0020255503633553064, 'f1-score': 0.004028268551236749, 'support': 56281}, 'accuracy': 0.35533071748878925, 'macro avg': {'precision': 0.3555135120024289, 'recall': 0.3336128358316007, 'f1-score': 0.1763116567370265, 'support': 178400}, 'weighted avg': {'precision': 0.3554829257051113, 'recall': 0.35533071748878925, 'f1-score': 0.18765732038112218, 'support': 178400}}
[[   23 58619   123]
 [   18 63254    82]
 [   24 56143   114]]
training model: results/ATVI/W1/deepVOL_L3/h10
Epoch 1/50
2948/2948 - 114s - loss: 2.8487 - accuracy10: 0.4818 - val_loss: 2.4856 - val_accuracy10: 0.6726 - 114s/epoch - 39ms/step
Epoch 2/50
2948/2948 - 110s - loss: 2.5794 - accuracy10: 0.5768 - val_loss: 2.3892 - val_accuracy10: 0.6867 - 110s/epoch - 37ms/step
Epoch 3/50
2948/2948 - 109s - loss: 2.5118 - accuracy10: 0.5932 - val_loss: 2.3750 - val_accuracy10: 0.6993 - 109s/epoch - 37ms/step
Epoch 4/50
2948/2948 - 111s - loss: 2.4823 - accuracy10: 0.6009 - val_loss: 2.3468 - val_accuracy10: 0.7102 - 111s/epoch - 38ms/step
Epoch 5/50
2948/2948 - 111s - loss: 2.4616 - accuracy10: 0.6067 - val_loss: 2.3130 - val_accuracy10: 0.6986 - 111s/epoch - 38ms/step
Epoch 6/50
2948/2948 - 110s - loss: 2.4446 - accuracy10: 0.6099 - val_loss: 2.3378 - val_accuracy10: 0.7086 - 110s/epoch - 37ms/step
Epoch 7/50
2948/2948 - 110s - loss: 2.4308 - accuracy10: 0.6124 - val_loss: 2.3319 - val_accuracy10: 0.7121 - 110s/epoch - 37ms/step
Epoch 8/50
2948/2948 - 110s - loss: 2.4162 - accuracy10: 0.6152 - val_loss: 2.3081 - val_accuracy10: 0.7020 - 110s/epoch - 37ms/step
Epoch 9/50
2948/2948 - 108s - loss: 2.4050 - accuracy10: 0.6164 - val_loss: 2.3178 - val_accuracy10: 0.7098 - 108s/epoch - 37ms/step
Epoch 10/50
2948/2948 - 109s - loss: 2.3955 - accuracy10: 0.6180 - val_loss: 2.3002 - val_accuracy10: 0.7096 - 109s/epoch - 37ms/step
Epoch 11/50
2948/2948 - 110s - loss: 2.3856 - accuracy10: 0.6194 - val_loss: 2.2941 - val_accuracy10: 0.7125 - 110s/epoch - 37ms/step
Epoch 12/50
2948/2948 - 112s - loss: 2.3783 - accuracy10: 0.6204 - val_loss: 2.2815 - val_accuracy10: 0.7154 - 112s/epoch - 38ms/step
Epoch 13/50
2948/2948 - 110s - loss: 2.3727 - accuracy10: 0.6216 - val_loss: 2.2685 - val_accuracy10: 0.7088 - 110s/epoch - 37ms/step
Epoch 14/50
2948/2948 - 110s - loss: 2.3661 - accuracy10: 0.6227 - val_loss: 2.2550 - val_accuracy10: 0.6992 - 110s/epoch - 37ms/step
Epoch 15/50
2948/2948 - 109s - loss: 2.3605 - accuracy10: 0.6233 - val_loss: 2.2519 - val_accuracy10: 0.7118 - 109s/epoch - 37ms/step
Epoch 16/50
2948/2948 - 110s - loss: 2.3542 - accuracy10: 0.6241 - val_loss: 2.2454 - val_accuracy10: 0.7122 - 110s/epoch - 37ms/step
Epoch 17/50
2948/2948 - 110s - loss: 2.3492 - accuracy10: 0.6242 - val_loss: 2.2471 - val_accuracy10: 0.7086 - 110s/epoch - 37ms/step
Epoch 18/50
2948/2948 - 110s - loss: 2.3452 - accuracy10: 0.6245 - val_loss: 2.2405 - val_accuracy10: 0.7096 - 110s/epoch - 37ms/step
Epoch 19/50
2948/2948 - 110s - loss: 2.3410 - accuracy10: 0.6255 - val_loss: 2.2433 - val_accuracy10: 0.7068 - 110s/epoch - 37ms/step
Epoch 20/50
2948/2948 - 110s - loss: 2.3392 - accuracy10: 0.6250 - val_loss: 2.2298 - val_accuracy10: 0.7027 - 110s/epoch - 37ms/step
Epoch 21/50
2948/2948 - 109s - loss: 2.3334 - accuracy10: 0.6263 - val_loss: 2.2360 - val_accuracy10: 0.7052 - 109s/epoch - 37ms/step
Epoch 22/50
2948/2948 - 109s - loss: 2.3287 - accuracy10: 0.6265 - val_loss: 2.2417 - val_accuracy10: 0.7098 - 109s/epoch - 37ms/step
Epoch 23/50
2948/2948 - 109s - loss: 2.3251 - accuracy10: 0.6268 - val_loss: 2.2260 - val_accuracy10: 0.7068 - 109s/epoch - 37ms/step
Epoch 24/50
2948/2948 - 110s - loss: 2.3217 - accuracy10: 0.6273 - val_loss: 2.2435 - val_accuracy10: 0.7122 - 110s/epoch - 37ms/step
Epoch 25/50
2948/2948 - 109s - loss: 2.3181 - accuracy10: 0.6282 - val_loss: 2.2377 - val_accuracy10: 0.7116 - 109s/epoch - 37ms/step
Epoch 26/50
2948/2948 - 109s - loss: 2.3150 - accuracy10: 0.6279 - val_loss: 2.2393 - val_accuracy10: 0.7019 - 109s/epoch - 37ms/step
Epoch 27/50
2948/2948 - 110s - loss: 2.3130 - accuracy10: 0.6284 - val_loss: 2.2465 - val_accuracy10: 0.7120 - 110s/epoch - 37ms/step
Epoch 28/50
2948/2948 - 112s - loss: 2.3098 - accuracy10: 0.6284 - val_loss: 2.2546 - val_accuracy10: 0.7051 - 112s/epoch - 38ms/step
Epoch 29/50
2948/2948 - 111s - loss: 2.3083 - accuracy10: 0.6288 - val_loss: 2.2348 - val_accuracy10: 0.7032 - 111s/epoch - 38ms/step
Epoch 30/50
2948/2948 - 110s - loss: 2.3041 - accuracy10: 0.6292 - val_loss: 2.2396 - val_accuracy10: 0.7035 - 110s/epoch - 37ms/step
Epoch 31/50
2948/2948 - 109s - loss: 2.3011 - accuracy10: 0.6299 - val_loss: 2.2398 - val_accuracy10: 0.7046 - 109s/epoch - 37ms/step
Epoch 32/50
2948/2948 - 110s - loss: 2.2989 - accuracy10: 0.6295 - val_loss: 2.2473 - val_accuracy10: 0.7059 - 110s/epoch - 37ms/step
Epoch 33/50
2948/2948 - 110s - loss: 2.2964 - accuracy10: 0.6296 - val_loss: 2.2300 - val_accuracy10: 0.6993 - 110s/epoch - 37ms/step
testing model: results/ATVI/W1/deepVOL_L3/h10
Evaluating performance on  test set...
12066/12066 - 234s - 234s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6820904
{'0': {'precision': 0.49210560292606487, 'recall': 0.5268991506727392, 'f1-score': 0.5089083702648276, 'support': 528065}, '1': {'precision': 0.8230825434891637, 'recall': 0.794669398594152, 'f1-score': 0.8086264560258436, 'support': 2034217}, '2': {'precision': 0.4874572344783947, 'recall': 0.5179010938924339, 'f1-score': 0.502218219788841, 'support': 526560}, 'accuracy': 0.7017105439514226, 'macro avg': {'precision': 0.6008817936312078, 'recall': 0.613156547719775, 'f1-score': 0.6065843486931707, 'support': 3088842}, 'weighted avg': {'precision': 0.7092844920410276, 'recall': 0.7017105439514226, 'f1-score': 0.7051530663767948, 'support': 3088842}}
[[ 278237  179761   70067]
 [ 201014 1616530  216673]
 [  86150  167704  272706]]
Evaluating performance on  train set...
2948/2948 - 59s - 59s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74090785
{'0': {'precision': 0.44510013759364014, 'recall': 0.569825885447656, 'f1-score': 0.4997991464582825, 'support': 127732}, '1': {'precision': 0.8303617388610761, 'recall': 0.7281102769506075, 'f1-score': 0.7758816449924396, 'support': 500703}, '2': {'precision': 0.44896024646009836, 'recall': 0.5410838814093156, 'f1-score': 0.4907360104764029, 'support': 126047}, 'accuracy': 0.670067675570789, 'macro avg': {'precision': 0.5748073743049382, 'recall': 0.613006681269193, 'f1-score': 0.5888056006423751, 'support': 754482}, 'weighted avg': {'precision': 0.7014193005182684, 'recall': 0.670067675570789, 'f1-score': 0.6815038844937029, 'support': 754482}}
[[ 72785  39585  15362]
 [ 67789 364567  68347]
 [ 22951  34894  68202]]
Evaluating performance on  val set...
697/697 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67234325
{'0': {'precision': 0.4434502505368647, 'recall': 0.5303112840466926, 'f1-score': 0.483006698089804, 'support': 25700}, '1': {'precision': 0.8552144152272549, 'recall': 0.7730152755559738, 'f1-score': 0.8120399850076815, 'support': 127524}, '2': {'precision': 0.43127874317108555, 'recall': 0.5550127105179536, 'f1-score': 0.4853842813721233, 'support': 25176}, 'accuracy': 0.7072869955156951, 'macro avg': {'precision': 0.5766478029784018, 'recall': 0.6194464233735401, 'f1-score': 0.5934769881565362, 'support': 178400}, 'weighted avg': {'precision': 0.736070113028661, 'recall': 0.7072869955156951, 'f1-score': 0.7185420059240589, 'support': 178400}}
[[13629  8967  3104]
 [13624 98578 15322]
 [ 3481  7722 13973]]
training model: results/ATVI/W1/deepVOL_L3/h20
Epoch 1/50
2948/2948 - 122s - loss: 3.0003 - accuracy20: 0.4519 - val_loss: 2.7303 - val_accuracy20: 0.6123 - 122s/epoch - 41ms/step
Epoch 2/50
2948/2948 - 128s - loss: 2.7383 - accuracy20: 0.5609 - val_loss: 2.5678 - val_accuracy20: 0.6409 - 128s/epoch - 43ms/step
Epoch 3/50
2948/2948 - 129s - loss: 2.6728 - accuracy20: 0.5757 - val_loss: 2.5040 - val_accuracy20: 0.6247 - 129s/epoch - 44ms/step
Epoch 4/50
2948/2948 - 119s - loss: 2.6240 - accuracy20: 0.5838 - val_loss: 2.4940 - val_accuracy20: 0.6385 - 119s/epoch - 40ms/step
Epoch 5/50
2948/2948 - 117s - loss: 2.5961 - accuracy20: 0.5901 - val_loss: 2.4794 - val_accuracy20: 0.6537 - 117s/epoch - 40ms/step
Epoch 6/50
2948/2948 - 117s - loss: 2.5706 - accuracy20: 0.5953 - val_loss: 2.4674 - val_accuracy20: 0.6660 - 117s/epoch - 40ms/step
Epoch 7/50
2948/2948 - 118s - loss: 2.5513 - accuracy20: 0.5997 - val_loss: 2.4430 - val_accuracy20: 0.6629 - 118s/epoch - 40ms/step
Epoch 8/50
2948/2948 - 118s - loss: 2.5366 - accuracy20: 0.6020 - val_loss: 2.4656 - val_accuracy20: 0.6695 - 118s/epoch - 40ms/step
Epoch 9/50
2948/2948 - 118s - loss: 2.5249 - accuracy20: 0.6042 - val_loss: 2.4416 - val_accuracy20: 0.6677 - 118s/epoch - 40ms/step
Epoch 10/50
2948/2948 - 119s - loss: 2.5139 - accuracy20: 0.6065 - val_loss: 2.4331 - val_accuracy20: 0.6659 - 119s/epoch - 40ms/step
Epoch 11/50
2948/2948 - 122s - loss: 2.5067 - accuracy20: 0.6077 - val_loss: 2.4193 - val_accuracy20: 0.6669 - 122s/epoch - 41ms/step
Epoch 12/50
2948/2948 - 119s - loss: 2.4985 - accuracy20: 0.6090 - val_loss: 2.4287 - val_accuracy20: 0.6730 - 119s/epoch - 40ms/step
Epoch 13/50
2948/2948 - 119s - loss: 2.4926 - accuracy20: 0.6103 - val_loss: 2.4057 - val_accuracy20: 0.6622 - 119s/epoch - 40ms/step
Epoch 14/50
2948/2948 - 121s - loss: 2.4867 - accuracy20: 0.6115 - val_loss: 2.4194 - val_accuracy20: 0.6688 - 121s/epoch - 41ms/step
Epoch 15/50
2948/2948 - 119s - loss: 2.4821 - accuracy20: 0.6118 - val_loss: 2.4082 - val_accuracy20: 0.6645 - 119s/epoch - 40ms/step
Epoch 16/50
2948/2948 - 120s - loss: 2.4772 - accuracy20: 0.6128 - val_loss: 2.4335 - val_accuracy20: 0.6719 - 120s/epoch - 41ms/step
Epoch 17/50
2948/2948 - 120s - loss: 2.4725 - accuracy20: 0.6141 - val_loss: 2.4001 - val_accuracy20: 0.6638 - 120s/epoch - 41ms/step
Epoch 18/50
2948/2948 - 120s - loss: 2.4689 - accuracy20: 0.6145 - val_loss: 2.4181 - val_accuracy20: 0.6706 - 120s/epoch - 41ms/step
Epoch 19/50
2948/2948 - 121s - loss: 2.4643 - accuracy20: 0.6145 - val_loss: 2.4105 - val_accuracy20: 0.6607 - 121s/epoch - 41ms/step
Epoch 20/50
2948/2948 - 117s - loss: 2.4613 - accuracy20: 0.6151 - val_loss: 2.4335 - val_accuracy20: 0.6737 - 117s/epoch - 40ms/step
Epoch 21/50
2948/2948 - 120s - loss: 2.4578 - accuracy20: 0.6160 - val_loss: 2.4288 - val_accuracy20: 0.6686 - 120s/epoch - 41ms/step
Epoch 22/50
2948/2948 - 121s - loss: 2.4550 - accuracy20: 0.6163 - val_loss: 2.4151 - val_accuracy20: 0.6545 - 121s/epoch - 41ms/step
Epoch 23/50
2948/2948 - 120s - loss: 2.4510 - accuracy20: 0.6164 - val_loss: 2.4230 - val_accuracy20: 0.6683 - 120s/epoch - 41ms/step
Epoch 24/50
2948/2948 - 111s - loss: 2.4470 - accuracy20: 0.6173 - val_loss: 2.4313 - val_accuracy20: 0.6661 - 111s/epoch - 38ms/step
Epoch 25/50
2948/2948 - 111s - loss: 2.4434 - accuracy20: 0.6181 - val_loss: 2.4310 - val_accuracy20: 0.6696 - 111s/epoch - 38ms/step
Epoch 26/50
2948/2948 - 112s - loss: 2.4413 - accuracy20: 0.6175 - val_loss: 2.4378 - val_accuracy20: 0.6657 - 112s/epoch - 38ms/step
Epoch 27/50
2948/2948 - 110s - loss: 2.4378 - accuracy20: 0.6187 - val_loss: 2.4402 - val_accuracy20: 0.6724 - 110s/epoch - 37ms/step
testing model: results/ATVI/W1/deepVOL_L3/h20
Evaluating performance on  test set...
12066/12066 - 219s - 219s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77457917
{'0': {'precision': 0.5732146247552707, 'recall': 0.4062370236832701, 'f1-score': 0.4754925951955563, 'support': 691163}, '1': {'precision': 0.7116538750816347, 'recall': 0.80678469440687, 'f1-score': 0.7562392916884454, 'support': 1709937}, '2': {'precision': 0.5241793729305482, 'recall': 0.5034169790415592, 'f1-score': 0.5135884258253149, 'support': 687742}, 'accuracy': 0.6496117315162122, 'macro avg': {'precision': 0.6030159575891513, 'recall': 0.5721462323772332, 'f1-score': 0.5817734375697722, 'support': 3088842}, 'weighted avg': {'precision': 0.6389346564774738, 'recall': 0.6496117315162122, 'f1-score': 0.6393919680705472, 'support': 3088842}}
[[ 280776  297031  113356]
 [ 129462 1379551  200924]
 [  79589  261932  346221]]
Evaluating performance on  train set...
2948/2948 - 54s - 54s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8043572
{'0': {'precision': 0.5425205098102623, 'recall': 0.4527603402757407, 'f1-score': 0.4935928800539816, 'support': 170450}, '1': {'precision': 0.721358719088932, 'recall': 0.7485360560845695, 'f1-score': 0.7346961425117123, 'support': 415658}, '2': {'precision': 0.5006605311886798, 'recall': 0.5379512276242175, 'f1-score': 0.518636430004953, 'support': 168374}, 'accuracy': 0.6347202451483269, 'macro avg': {'precision': 0.5881799200292914, 'recall': 0.5797492079948426, 'f1-score': 0.5823084841902156, 'support': 754482}, 'weighted avg': {'precision': 0.6317040825819427, 'recall': 0.6347202451483269, 'f1-score': 0.6320099430801377, 'support': 754482}}
[[ 77173  65021  28256]
 [ 42441 311135  62082]
 [ 22635  55162  90577]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7566104
{'0': {'precision': 0.5398203136896604, 'recall': 0.41022970549094484, 'f1-score': 0.466186671926883, 'support': 34566}, '1': {'precision': 0.7596235418875927, 'recall': 0.7811117068161786, 'f1-score': 0.7702177799083362, 'support': 110047}, '2': {'precision': 0.4681566252694242, 'recall': 0.5400005919436469, 'f1-score': 0.5015187124616886, 'support': 33787}, 'accuracy': 0.6635874439461883, 'macro avg': {'precision': 0.5892001602822258, 'recall': 0.5771140014169235, 'f1-score': 0.5793077214323027, 'support': 178400}, 'weighted avg': {'precision': 0.6618348025508899, 'recall': 0.6635874439461883, 'f1-score': 0.6604213972272442, 'support': 178400}}
[[14180 14868  5518]
 [ 8879 85959 15209]
 [ 3209 12333 18245]]
training model: results/ATVI/W1/deepVOL_L3/h30
Epoch 1/50
2948/2948 - 115s - loss: 3.0973 - accuracy30: 0.4568 - val_loss: 3.0768 - val_accuracy30: 0.5307 - 115s/epoch - 39ms/step
Epoch 2/50
2948/2948 - 118s - loss: 2.8735 - accuracy30: 0.5293 - val_loss: 2.7453 - val_accuracy30: 0.6007 - 118s/epoch - 40ms/step
Epoch 3/50
2948/2948 - 118s - loss: 2.7547 - accuracy30: 0.5607 - val_loss: 2.6642 - val_accuracy30: 0.6015 - 118s/epoch - 40ms/step
Epoch 4/50
2948/2948 - 110s - loss: 2.7109 - accuracy30: 0.5678 - val_loss: 2.6271 - val_accuracy30: 0.5963 - 110s/epoch - 37ms/step
Epoch 5/50
2948/2948 - 110s - loss: 2.6841 - accuracy30: 0.5745 - val_loss: 2.6316 - val_accuracy30: 0.6103 - 110s/epoch - 37ms/step
Epoch 6/50
2948/2948 - 111s - loss: 2.6630 - accuracy30: 0.5786 - val_loss: 2.6217 - val_accuracy30: 0.6135 - 111s/epoch - 38ms/step
Epoch 7/50
2948/2948 - 118s - loss: 2.6467 - accuracy30: 0.5807 - val_loss: 2.6168 - val_accuracy30: 0.6196 - 118s/epoch - 40ms/step
Epoch 8/50
2948/2948 - 118s - loss: 2.6321 - accuracy30: 0.5839 - val_loss: 2.5993 - val_accuracy30: 0.6217 - 118s/epoch - 40ms/step
Epoch 9/50
2948/2948 - 111s - loss: 2.6209 - accuracy30: 0.5863 - val_loss: 2.6088 - val_accuracy30: 0.6215 - 111s/epoch - 38ms/step
Epoch 10/50
2948/2948 - 111s - loss: 2.6125 - accuracy30: 0.5883 - val_loss: 2.6066 - val_accuracy30: 0.6240 - 111s/epoch - 38ms/step
Epoch 11/50
2948/2948 - 111s - loss: 2.6061 - accuracy30: 0.5892 - val_loss: 2.6026 - val_accuracy30: 0.6232 - 111s/epoch - 38ms/step
Epoch 12/50
2948/2948 - 111s - loss: 2.5991 - accuracy30: 0.5912 - val_loss: 2.5997 - val_accuracy30: 0.6200 - 111s/epoch - 38ms/step
Epoch 13/50
2948/2948 - 113s - loss: 2.5941 - accuracy30: 0.5913 - val_loss: 2.5903 - val_accuracy30: 0.6210 - 113s/epoch - 38ms/step
Epoch 14/50
2948/2948 - 114s - loss: 2.5896 - accuracy30: 0.5927 - val_loss: 2.5925 - val_accuracy30: 0.6242 - 114s/epoch - 39ms/step
Epoch 15/50
2948/2948 - 112s - loss: 2.5859 - accuracy30: 0.5929 - val_loss: 2.5901 - val_accuracy30: 0.6233 - 112s/epoch - 38ms/step
Epoch 16/50
2948/2948 - 111s - loss: 2.5811 - accuracy30: 0.5943 - val_loss: 2.5875 - val_accuracy30: 0.6241 - 111s/epoch - 38ms/step
Epoch 17/50
2948/2948 - 112s - loss: 2.5770 - accuracy30: 0.5950 - val_loss: 2.6064 - val_accuracy30: 0.6232 - 112s/epoch - 38ms/step
Epoch 18/50
2948/2948 - 114s - loss: 2.5733 - accuracy30: 0.5953 - val_loss: 2.5858 - val_accuracy30: 0.6243 - 114s/epoch - 39ms/step
Epoch 19/50
2948/2948 - 109s - loss: 2.5706 - accuracy30: 0.5958 - val_loss: 2.6008 - val_accuracy30: 0.6211 - 109s/epoch - 37ms/step
Epoch 20/50
2948/2948 - 110s - loss: 2.5671 - accuracy30: 0.5968 - val_loss: 2.5972 - val_accuracy30: 0.6222 - 110s/epoch - 37ms/step
Epoch 21/50
2948/2948 - 111s - loss: 2.5647 - accuracy30: 0.5970 - val_loss: 2.5887 - val_accuracy30: 0.6215 - 111s/epoch - 37ms/step
Epoch 22/50
2948/2948 - 110s - loss: 2.5619 - accuracy30: 0.5975 - val_loss: 2.5921 - val_accuracy30: 0.6227 - 110s/epoch - 37ms/step
Epoch 23/50
2948/2948 - 110s - loss: 2.5585 - accuracy30: 0.5976 - val_loss: 2.5883 - val_accuracy30: 0.6210 - 110s/epoch - 37ms/step
Epoch 24/50
2948/2948 - 117s - loss: 2.5556 - accuracy30: 0.5988 - val_loss: 2.5803 - val_accuracy30: 0.6205 - 117s/epoch - 40ms/step
Epoch 25/50
2948/2948 - 110s - loss: 2.5525 - accuracy30: 0.5985 - val_loss: 2.5920 - val_accuracy30: 0.6151 - 110s/epoch - 37ms/step
Epoch 26/50
2948/2948 - 110s - loss: 2.5491 - accuracy30: 0.5992 - val_loss: 2.5968 - val_accuracy30: 0.6167 - 110s/epoch - 37ms/step
Epoch 27/50
2948/2948 - 109s - loss: 2.5489 - accuracy30: 0.5991 - val_loss: 2.5960 - val_accuracy30: 0.6197 - 109s/epoch - 37ms/step
Epoch 28/50
2948/2948 - 110s - loss: 2.5445 - accuracy30: 0.6000 - val_loss: 2.5951 - val_accuracy30: 0.6213 - 110s/epoch - 37ms/step
Epoch 29/50
2948/2948 - 109s - loss: 2.5420 - accuracy30: 0.6006 - val_loss: 2.6111 - val_accuracy30: 0.6198 - 109s/epoch - 37ms/step
Epoch 30/50
2948/2948 - 110s - loss: 2.5392 - accuracy30: 0.6007 - val_loss: 2.5948 - val_accuracy30: 0.6204 - 110s/epoch - 37ms/step
Epoch 31/50
2948/2948 - 110s - loss: 2.5367 - accuracy30: 0.6010 - val_loss: 2.5866 - val_accuracy30: 0.6189 - 110s/epoch - 37ms/step
Epoch 32/50
2948/2948 - 110s - loss: 2.5347 - accuracy30: 0.6014 - val_loss: 2.6075 - val_accuracy30: 0.6128 - 110s/epoch - 37ms/step
Epoch 33/50
2948/2948 - 110s - loss: 2.5324 - accuracy30: 0.6017 - val_loss: 2.5995 - val_accuracy30: 0.6166 - 110s/epoch - 37ms/step
Epoch 34/50
2948/2948 - 110s - loss: 2.5298 - accuracy30: 0.6023 - val_loss: 2.6096 - val_accuracy30: 0.6169 - 110s/epoch - 37ms/step
testing model: results/ATVI/W1/deepVOL_L3/h30
Evaluating performance on  test set...
12066/12066 - 220s - 220s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8565726
{'0': {'precision': 0.5886835905552821, 'recall': 0.3577572510759621, 'f1-score': 0.44504804494191924, 'support': 808811}, '1': {'precision': 0.6178472913115794, 'recall': 0.8133383870345491, 'f1-score': 0.7022414029879528, 'support': 1477465}, '2': {'precision': 0.5496541036202237, 'recall': 0.44678443891218916, 'f1-score': 0.4929092759852886, 'support': 802566}, 'accuracy': 0.5988040178163856, 'macro avg': {'precision': 0.5853949951623618, 'recall': 0.5392933590075668, 'f1-score': 0.5467329079717203, 'support': 3088842}, 'weighted avg': {'precision': 0.5924923343907974, 'recall': 0.5988040178163856, 'f1-score': 0.5805052750297761, 'support': 3088842}}
[[ 289358  392805  126648]
 [ 108645 1201679  167141]
 [  93531  350461  358574]]
Evaluating performance on  train set...
2948/2948 - 53s - 53s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86608934
{'0': {'precision': 0.5619043077195588, 'recall': 0.4139132005781275, 'f1-score': 0.47668669284808135, 'support': 199264}, '1': {'precision': 0.6297899832442092, 'recall': 0.7571828121027205, 'f1-score': 0.6876359105914474, 'support': 357903}, '2': {'precision': 0.5338726042841038, 'recall': 0.4799888503154854, 'f1-score': 0.5054988457894667, 'support': 197315}, 'accuracy': 0.5940300762642449, 'macro avg': {'precision': 0.575188965082624, 'recall': 0.5503616209987778, 'f1-score': 0.5566071497429984, 'support': 754482}, 'weighted avg': {'precision': 0.5867762216471702, 'recall': 0.5940300762642449, 'f1-score': 0.5842895618835697, 'support': 754482}}
[[ 82478  84145  32641]
 [ 36855 270998  50050]
 [ 27450  75156  94709]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8248819
{'0': {'precision': 0.5583682805947389, 'recall': 0.35708016383850205, 'f1-score': 0.4355946822115814, 'support': 41016}, '1': {'precision': 0.6760267313638075, 'recall': 0.7926225636180657, 'f1-score': 0.7296963852688004, 'support': 97378}, '2': {'precision': 0.5000921125352001, 'recall': 0.47497875318702193, 'f1-score': 0.4872120303065267, 'support': 40006}, 'accuracy': 0.6212556053811659, 'macro avg': {'precision': 0.5781623748312489, 'recall': 0.5415604935478633, 'f1-score': 0.5508343659289695, 'support': 178400}, 'weighted avg': {'precision': 0.6095226989781496, 'recall': 0.6212556053811659, 'f1-score': 0.6077025256431523, 'support': 178400}}
[[14646 20101  6269]
 [ 7468 77184 12726]
 [ 4116 16888 19002]]
training model: results/ATVI/W1/deepVOL_L3/h50
Epoch 1/50
2948/2948 - 115s - loss: 3.1786 - accuracy50: 0.4286 - val_loss: 3.1196 - val_accuracy50: 0.4719 - 115s/epoch - 39ms/step
Epoch 2/50
2948/2948 - 110s - loss: 3.1148 - accuracy50: 0.4574 - val_loss: 3.1835 - val_accuracy50: 0.4601 - 110s/epoch - 37ms/step
Epoch 3/50
2948/2948 - 113s - loss: 3.0770 - accuracy50: 0.4699 - val_loss: 3.0111 - val_accuracy50: 0.5070 - 113s/epoch - 38ms/step
Epoch 4/50
2948/2948 - 115s - loss: 2.9262 - accuracy50: 0.5162 - val_loss: 2.8963 - val_accuracy50: 0.5384 - 115s/epoch - 39ms/step
Epoch 5/50
2948/2948 - 114s - loss: 2.8692 - accuracy50: 0.5276 - val_loss: 2.8820 - val_accuracy50: 0.5378 - 114s/epoch - 39ms/step
Epoch 6/50
2948/2948 - 115s - loss: 2.8430 - accuracy50: 0.5326 - val_loss: 2.8744 - val_accuracy50: 0.5384 - 115s/epoch - 39ms/step
Epoch 7/50
2948/2948 - 116s - loss: 2.8281 - accuracy50: 0.5361 - val_loss: 2.8651 - val_accuracy50: 0.5411 - 116s/epoch - 39ms/step
Epoch 8/50
2948/2948 - 116s - loss: 2.8152 - accuracy50: 0.5388 - val_loss: 2.8575 - val_accuracy50: 0.5402 - 116s/epoch - 40ms/step
Epoch 9/50
2948/2948 - 120s - loss: 2.8048 - accuracy50: 0.5409 - val_loss: 2.8566 - val_accuracy50: 0.5403 - 120s/epoch - 41ms/step
Epoch 10/50
2948/2948 - 119s - loss: 2.7978 - accuracy50: 0.5423 - val_loss: 2.8436 - val_accuracy50: 0.5440 - 119s/epoch - 40ms/step
Epoch 11/50
2948/2948 - 118s - loss: 2.7890 - accuracy50: 0.5444 - val_loss: 2.8428 - val_accuracy50: 0.5427 - 118s/epoch - 40ms/step
Epoch 12/50
2948/2948 - 118s - loss: 2.7840 - accuracy50: 0.5455 - val_loss: 2.8434 - val_accuracy50: 0.5430 - 118s/epoch - 40ms/step
Epoch 13/50
2948/2948 - 119s - loss: 2.7795 - accuracy50: 0.5466 - val_loss: 2.8391 - val_accuracy50: 0.5411 - 119s/epoch - 40ms/step
Epoch 14/50
2948/2948 - 116s - loss: 2.7751 - accuracy50: 0.5476 - val_loss: 2.8406 - val_accuracy50: 0.5401 - 116s/epoch - 40ms/step
Epoch 15/50
2948/2948 - 116s - loss: 2.7701 - accuracy50: 0.5481 - val_loss: 2.8209 - val_accuracy50: 0.5419 - 116s/epoch - 40ms/step
Epoch 16/50
2948/2948 - 117s - loss: 2.7659 - accuracy50: 0.5491 - val_loss: 2.8267 - val_accuracy50: 0.5416 - 117s/epoch - 40ms/step
Epoch 17/50
2948/2948 - 115s - loss: 2.7628 - accuracy50: 0.5499 - val_loss: 2.8285 - val_accuracy50: 0.5401 - 115s/epoch - 39ms/step
Epoch 18/50
2948/2948 - 115s - loss: 2.7582 - accuracy50: 0.5507 - val_loss: 2.8272 - val_accuracy50: 0.5429 - 115s/epoch - 39ms/step
Epoch 19/50
2948/2948 - 116s - loss: 2.7545 - accuracy50: 0.5514 - val_loss: 2.8261 - val_accuracy50: 0.5420 - 116s/epoch - 39ms/step
Epoch 20/50
2948/2948 - 115s - loss: 2.7512 - accuracy50: 0.5526 - val_loss: 2.8194 - val_accuracy50: 0.5453 - 115s/epoch - 39ms/step
Epoch 21/50
2948/2948 - 115s - loss: 2.7479 - accuracy50: 0.5532 - val_loss: 2.8221 - val_accuracy50: 0.5437 - 115s/epoch - 39ms/step
Epoch 22/50
2948/2948 - 115s - loss: 2.7452 - accuracy50: 0.5538 - val_loss: 2.8098 - val_accuracy50: 0.5464 - 115s/epoch - 39ms/step
Epoch 23/50
2948/2948 - 116s - loss: 2.7419 - accuracy50: 0.5548 - val_loss: 2.8053 - val_accuracy50: 0.5479 - 116s/epoch - 39ms/step
Epoch 24/50
2948/2948 - 117s - loss: 2.7396 - accuracy50: 0.5551 - val_loss: 2.8067 - val_accuracy50: 0.5482 - 117s/epoch - 40ms/step
Epoch 25/50
2948/2948 - 116s - loss: 2.7364 - accuracy50: 0.5558 - val_loss: 2.8181 - val_accuracy50: 0.5463 - 116s/epoch - 39ms/step
Epoch 26/50
2948/2948 - 116s - loss: 2.7338 - accuracy50: 0.5563 - val_loss: 2.8214 - val_accuracy50: 0.5466 - 116s/epoch - 39ms/step
Epoch 27/50
2948/2948 - 117s - loss: 2.7309 - accuracy50: 0.5571 - val_loss: 2.8137 - val_accuracy50: 0.5476 - 117s/epoch - 40ms/step
Epoch 28/50
2948/2948 - 115s - loss: 2.7283 - accuracy50: 0.5574 - val_loss: 2.8209 - val_accuracy50: 0.5470 - 115s/epoch - 39ms/step
Epoch 29/50
2948/2948 - 115s - loss: 2.7258 - accuracy50: 0.5577 - val_loss: 2.8108 - val_accuracy50: 0.5477 - 115s/epoch - 39ms/step
Epoch 30/50
2948/2948 - 116s - loss: 2.7233 - accuracy50: 0.5581 - val_loss: 2.8317 - val_accuracy50: 0.5454 - 116s/epoch - 39ms/step
Epoch 31/50
2948/2948 - 115s - loss: 2.7212 - accuracy50: 0.5592 - val_loss: 2.8287 - val_accuracy50: 0.5454 - 115s/epoch - 39ms/step
Epoch 32/50
2948/2948 - 118s - loss: 2.7189 - accuracy50: 0.5593 - val_loss: 2.8166 - val_accuracy50: 0.5493 - 118s/epoch - 40ms/step
Epoch 33/50
2948/2948 - 116s - loss: 2.7159 - accuracy50: 0.5602 - val_loss: 2.8221 - val_accuracy50: 0.5475 - 116s/epoch - 39ms/step
testing model: results/ATVI/W1/deepVOL_L3/h50
Evaluating performance on  test set...
12066/12066 - 240s - 240s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9694899
{'0': {'precision': 0.6062414176822154, 'recall': 0.25463131579408943, 'f1-score': 0.35863152326811515, 'support': 969217}, '1': {'precision': 0.474608379991081, 'recall': 0.8265864592539605, 'f1-score': 0.6029917250159135, 'support': 1157499}, '2': {'precision': 0.5626928033113359, 'recall': 0.3894084558571331, 'f1-score': 0.4602815793999852, 'support': 962126}, 'accuracy': 0.5109442308800515, 'macro avg': {'precision': 0.5478475336615442, 'recall': 0.490208743635061, 'f1-score': 0.4739682758946713, 'support': 3088842}, 'weighted avg': {'precision': 0.5433491222379527, 'recall': 0.5109442308800515, 'f1-score': 0.48186438887561667, 'support': 3088842}}
[[246793 565820 156604]
 [ 66156 956773 134570]
 [ 94138 493328 374660]]
Evaluating performance on  train set...
2948/2948 - 64s - 64s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96230483
{'0': {'precision': 0.5947013342684903, 'recall': 0.2999831529292844, 'f1-score': 0.39880065846202084, 'support': 237430}, '1': {'precision': 0.4873267710139251, 'recall': 0.7807713152865333, 'f1-score': 0.6000967402906867, 'support': 280456}, '2': {'precision': 0.5462474984221855, 'recall': 0.42800808128624324, 'f1-score': 0.4799527938594101, 'support': 236596}, 'accuracy': 0.5188486935407339, 'macro avg': {'precision': 0.5427585345682003, 'recall': 0.5029208498340203, 'f1-score': 0.4929500642040392, 'support': 754482}, 'weighted avg': {'precision': 0.5395935593208908, 'recall': 0.5188486935407339, 'f1-score': 0.49907470681813937, 'support': 754482}}
[[ 71225 123313  42892]
 [ 20258 218972  41226]
 [ 28283 107048 101265]]
Evaluating performance on  val set...
697/697 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.92543334
{'0': {'precision': 0.6001532346885026, 'recall': 0.24990528603617077, 'f1-score': 0.3528732719542754, 'support': 50151}, '1': {'precision': 0.5482713081168941, 'recall': 0.8146517566258695, 'f1-score': 0.6554297829706056, 'support': 79499}, '2': {'precision': 0.5202447135277841, 'recall': 0.42038974358974357, 'f1-score': 0.46501707452662155, 'support': 48750}, 'accuracy': 0.5481558295964125, 'macro avg': {'precision': 0.5562230854443936, 'recall': 0.494982262083928, 'f1-score': 0.49110670981716753, 'support': 178400}, 'weighted avg': {'precision': 0.5551975077428672, 'recall': 0.5481558295964125, 'f1-score': 0.5183438461958063, 'support': 178400}}
[[12533 29234  8384]
 [ 4220 64764 10515]
 [ 4130 24126 20494]]
training model: results/ATVI/W1/deepVOL_L3/h100
Epoch 1/50
2948/2948 - 118s - loss: 3.2272 - accuracy100: 0.4058 - val_loss: 3.2419 - val_accuracy100: 0.3799 - 118s/epoch - 40ms/step
Epoch 2/50
2948/2948 - 113s - loss: 3.2001 - accuracy100: 0.4167 - val_loss: 3.2490 - val_accuracy100: 0.3831 - 113s/epoch - 38ms/step
Epoch 3/50
2948/2948 - 115s - loss: 3.1788 - accuracy100: 0.4289 - val_loss: 3.2169 - val_accuracy100: 0.3957 - 115s/epoch - 39ms/step
Epoch 4/50
2948/2948 - 115s - loss: 3.1387 - accuracy100: 0.4498 - val_loss: 3.1469 - val_accuracy100: 0.4411 - 115s/epoch - 39ms/step
Epoch 5/50
2948/2948 - 114s - loss: 3.1088 - accuracy100: 0.4588 - val_loss: 3.1178 - val_accuracy100: 0.4517 - 114s/epoch - 39ms/step
Epoch 6/50
2948/2948 - 114s - loss: 3.0931 - accuracy100: 0.4629 - val_loss: 3.1157 - val_accuracy100: 0.4481 - 114s/epoch - 39ms/step
Epoch 7/50
2948/2948 - 116s - loss: 3.0823 - accuracy100: 0.4660 - val_loss: 3.1198 - val_accuracy100: 0.4471 - 116s/epoch - 39ms/step
Epoch 8/50
2948/2948 - 115s - loss: 3.0749 - accuracy100: 0.4685 - val_loss: 3.1140 - val_accuracy100: 0.4489 - 115s/epoch - 39ms/step
Epoch 9/50
2948/2948 - 115s - loss: 3.0698 - accuracy100: 0.4692 - val_loss: 3.1110 - val_accuracy100: 0.4495 - 115s/epoch - 39ms/step
Epoch 10/50
2948/2948 - 114s - loss: 3.0649 - accuracy100: 0.4710 - val_loss: 3.1127 - val_accuracy100: 0.4492 - 114s/epoch - 39ms/step
Epoch 11/50
2948/2948 - 114s - loss: 3.0611 - accuracy100: 0.4722 - val_loss: 3.1002 - val_accuracy100: 0.4528 - 114s/epoch - 39ms/step
Epoch 12/50
2948/2948 - 117s - loss: 3.0574 - accuracy100: 0.4733 - val_loss: 3.1012 - val_accuracy100: 0.4528 - 117s/epoch - 40ms/step
Epoch 13/50
2948/2948 - 115s - loss: 3.0545 - accuracy100: 0.4741 - val_loss: 3.1004 - val_accuracy100: 0.4527 - 115s/epoch - 39ms/step
Epoch 14/50
2948/2948 - 117s - loss: 3.0515 - accuracy100: 0.4758 - val_loss: 3.1046 - val_accuracy100: 0.4497 - 117s/epoch - 40ms/step
Epoch 15/50
2948/2948 - 116s - loss: 3.0488 - accuracy100: 0.4756 - val_loss: 3.1003 - val_accuracy100: 0.4495 - 116s/epoch - 39ms/step
Epoch 16/50
2948/2948 - 116s - loss: 3.0459 - accuracy100: 0.4768 - val_loss: 3.1052 - val_accuracy100: 0.4487 - 116s/epoch - 39ms/step
Epoch 17/50
2948/2948 - 117s - loss: 3.0431 - accuracy100: 0.4778 - val_loss: 3.1011 - val_accuracy100: 0.4484 - 117s/epoch - 40ms/step
Epoch 18/50
2948/2948 - 117s - loss: 3.0409 - accuracy100: 0.4781 - val_loss: 3.1081 - val_accuracy100: 0.4481 - 117s/epoch - 40ms/step
Epoch 19/50
2948/2948 - 117s - loss: 3.0383 - accuracy100: 0.4790 - val_loss: 3.1160 - val_accuracy100: 0.4444 - 117s/epoch - 40ms/step
Epoch 20/50
2948/2948 - 118s - loss: 3.0358 - accuracy100: 0.4794 - val_loss: 3.1132 - val_accuracy100: 0.4456 - 118s/epoch - 40ms/step
Epoch 21/50
2948/2948 - 117s - loss: 3.0334 - accuracy100: 0.4802 - val_loss: 3.1090 - val_accuracy100: 0.4473 - 117s/epoch - 40ms/step
testing model: results/ATVI/W1/deepVOL_L3/h100
Evaluating performance on  test set...
12066/12066 - 240s - 240s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0610723
{'0': {'precision': 0.4997337962962963, 'recall': 0.17328521304465175, 'f1-score': 0.2573373891522489, 'support': 996669}, '1': {'precision': 0.3969572042663693, 'recall': 0.7567276802112136, 'f1-score': 0.5207461905226259, 'support': 1072658}, '2': {'precision': 0.47750897750897753, 'recall': 0.3271143632021108, 'f1-score': 0.38825631124023313, 'support': 1019515}, 'accuracy': 0.4266699300255565, 'macro avg': {'precision': 0.4580666593572144, 'recall': 0.41904241881932536, 'f1-score': 0.3887799636383693, 'support': 3088842}, 'weighted avg': {'precision': 0.4567070989839732, 'recall': 0.4266699300255565, 'f1-score': 0.3920226086982397, 'support': 3088842}}
[[172708 647053 176908]
 [ 72942 811710 188006]
 [ 99950 586067 333498]]
Evaluating performance on  train set...
2948/2948 - 58s - 58s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0526717
{'0': {'precision': 0.5140077598995778, 'recall': 0.21424324581430745, 'f1-score': 0.3024305905260684, 'support': 252288}, '1': {'precision': 0.3893779996244328, 'recall': 0.7157162580873028, 'f1-score': 0.504362705584546, 'support': 249156}, '2': {'precision': 0.4837211003804507, 'recall': 0.365798812826532, 'f1-score': 0.4165755305024866, 'support': 253038}, 'accuracy': 0.43067561585299585, 'macro avg': {'precision': 0.46236895330148714, 'recall': 0.4319194389093807, 'f1-score': 0.4077896088710336, 'support': 754482}, 'weighted avg': {'precision': 0.46269317810370336, 'recall': 0.43067561585299585, 'f1-score': 0.4073974490876549, 'support': 754482}}
[[ 54051 148881  49356]
 [ 21396 178325  49435]
 [ 29709 130768  92561]]
Evaluating performance on  val set...
697/697 - 14s - 14s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0339131
{'0': {'precision': 0.5082981291490646, 'recall': 0.1821113893944035, 'f1-score': 0.2681506440444132, 'support': 55499}, '1': {'precision': 0.44067855198458306, 'recall': 0.7451341399263546, 'f1-score': 0.5538220935852253, 'support': 68436}, '2': {'precision': 0.4583051005864623, 'recall': 0.3601395391535849, 'f1-score': 0.40333525250863633, 'support': 54465}, 'accuracy': 0.45244394618834083, 'macro avg': {'precision': 0.4690939272400367, 'recall': 0.42912835615811434, 'f1-score': 0.40843599671275826, 'support': 178400}, 'weighted avg': {'precision': 0.46709586634922945, 'recall': 0.45244394618834083, 'f1-score': 0.4190084972999004, 'support': 178400}}
[[10107 34921 10471]
 [ 4729 50994 12713]
 [ 5048 29802 19615]]
training model: results/ATVI/W1/deepVOL_L3/h200
Epoch 1/50
2948/2948 - 123s - loss: 3.2878 - accuracy200: 0.3677 - val_loss: 3.3339 - val_accuracy200: 0.3497 - 123s/epoch - 42ms/step
Epoch 2/50
2948/2948 - 121s - loss: 3.2647 - accuracy200: 0.3822 - val_loss: 3.3069 - val_accuracy200: 0.3552 - 121s/epoch - 41ms/step
Epoch 3/50
2948/2948 - 125s - loss: 3.2525 - accuracy200: 0.3931 - val_loss: 3.3430 - val_accuracy200: 0.3549 - 125s/epoch - 42ms/step
Epoch 4/50
2948/2948 - 126s - loss: 3.2398 - accuracy200: 0.4010 - val_loss: 3.3213 - val_accuracy200: 0.3591 - 126s/epoch - 43ms/step
Epoch 5/50
2948/2948 - 121s - loss: 3.2289 - accuracy200: 0.4078 - val_loss: 3.3304 - val_accuracy200: 0.3619 - 121s/epoch - 41ms/step
Epoch 6/50
2948/2948 - 119s - loss: 3.2211 - accuracy200: 0.4119 - val_loss: 3.3211 - val_accuracy200: 0.3626 - 119s/epoch - 40ms/step
Epoch 7/50
2948/2948 - 118s - loss: 3.2111 - accuracy200: 0.4165 - val_loss: 3.3076 - val_accuracy200: 0.3695 - 118s/epoch - 40ms/step
Epoch 8/50
2948/2948 - 113s - loss: 3.2046 - accuracy200: 0.4196 - val_loss: 3.3023 - val_accuracy200: 0.3652 - 113s/epoch - 38ms/step
Epoch 9/50
2948/2948 - 117s - loss: 3.1998 - accuracy200: 0.4220 - val_loss: 3.3173 - val_accuracy200: 0.3642 - 117s/epoch - 40ms/step
Epoch 10/50
2948/2948 - 116s - loss: 3.1957 - accuracy200: 0.4234 - val_loss: 3.3132 - val_accuracy200: 0.3667 - 116s/epoch - 39ms/step
Epoch 11/50
2948/2948 - 117s - loss: 3.1921 - accuracy200: 0.4253 - val_loss: 3.3168 - val_accuracy200: 0.3656 - 117s/epoch - 40ms/step
Epoch 12/50
2948/2948 - 117s - loss: 3.1892 - accuracy200: 0.4267 - val_loss: 3.3293 - val_accuracy200: 0.3643 - 117s/epoch - 40ms/step
Epoch 13/50
2948/2948 - 116s - loss: 3.1859 - accuracy200: 0.4280 - val_loss: 3.3290 - val_accuracy200: 0.3635 - 116s/epoch - 39ms/step
Epoch 14/50
2948/2948 - 116s - loss: 3.1834 - accuracy200: 0.4293 - val_loss: 3.3378 - val_accuracy200: 0.3651 - 116s/epoch - 39ms/step
Epoch 15/50
2948/2948 - 123s - loss: 3.1795 - accuracy200: 0.4312 - val_loss: 3.3308 - val_accuracy200: 0.3663 - 123s/epoch - 42ms/step
Epoch 16/50
2948/2948 - 122s - loss: 3.1774 - accuracy200: 0.4320 - val_loss: 3.3323 - val_accuracy200: 0.3650 - 122s/epoch - 41ms/step
Epoch 17/50
2948/2948 - 122s - loss: 3.1750 - accuracy200: 0.4331 - val_loss: 3.3327 - val_accuracy200: 0.3656 - 122s/epoch - 41ms/step
Epoch 18/50
2948/2948 - 122s - loss: 3.1727 - accuracy200: 0.4344 - val_loss: 3.3389 - val_accuracy200: 0.3635 - 122s/epoch - 41ms/step
testing model: results/ATVI/W1/deepVOL_L3/h200
Evaluating performance on  test set...
12066/12066 - 234s - 234s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1088438
{'0': {'precision': 0.396486799742434, 'recall': 0.15327767239705464, 'f1-score': 0.22108585359898603, 'support': 1004295}, '1': {'precision': 0.3427662277723084, 'recall': 0.74734174841978, 'f1-score': 0.46997823620633855, 'support': 1045424}, '2': {'precision': 0.3767769474014073, 'recall': 0.15273360324042487, 'f1-score': 0.21735733395601473, 'support': 1039123}, 'accuracy': 0.3541566710113369, 'macro avg': {'precision': 0.37200999163871656, 'recall': 0.35111767468575317, 'f1-score': 0.3028071412537798, 'support': 3088842}, 'weighted avg': {'precision': 0.37167435024664847, 'recall': 0.3541566710113369, 'f1-score': 0.3040695995069818, 'support': 3088842}}
[[153936 720489 129870]
 [131486 781289 132649]
 [102828 777586 158709]]
Evaluating performance on  train set...
2948/2948 - 56s - 56s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024543
{'0': {'precision': 0.4341767013935868, 'recall': 0.1528798970954884, 'f1-score': 0.22613454852954992, 'support': 251884}, '1': {'precision': 0.3369773771808487, 'recall': 0.7553087644620825, 'f1-score': 0.46603533031611655, 'support': 249964}, '2': {'precision': 0.41209306733639767, 'recall': 0.1721146005684112, 'f1-score': 0.24281514118425568, 'support': 252634}, 'accuracy': 0.3589084961602795, 'macro avg': {'precision': 0.394415715303611, 'recall': 0.36010108737532737, 'f1-score': 0.31166167334330735, 'support': 754482}, 'weighted avg': {'precision': 0.3945794562851326, 'recall': 0.3589084961602795, 'f1-score': 0.3112003868971005, 'support': 754482}}
[[ 38508 183750  29626]
 [ 28757 188800  32407]
 [ 21427 187725  43482]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011391
{'0': {'precision': 0.42665822538229276, 'recall': 0.14888012779118376, 'f1-score': 0.2207357016880826, 'support': 58846}, '1': {'precision': 0.3568857780034887, 'recall': 0.778314606741573, 'f1-score': 0.48937512300231617, 'support': 62300}, '2': {'precision': 0.3685622073730624, 'recall': 0.14161455968141964, 'f1-score': 0.20461055102015066, 'support': 57254}, 'accuracy': 0.3663565022421525, 'macro avg': {'precision': 0.38403540358628124, 'recall': 0.3562697647380588, 'f1-score': 0.3049071252368498, 'support': 178400}, 'weighted avg': {'precision': 0.38364783924552165, 'recall': 0.3663565022421525, 'f1-score': 0.3093736309007226, 'support': 178400}}
[[ 8761 43136  6949]
 [ 6869 48489  6942]
 [ 4904 44242  8108]]
training model: results/ATVI/W1/deepVOL_L3/h300
Epoch 1/50
2948/2948 - 120s - loss: 3.2901 - accuracy300: 0.3670 - val_loss: 3.3892 - val_accuracy300: 0.3266 - 120s/epoch - 41ms/step
Epoch 2/50
2948/2948 - 117s - loss: 3.2775 - accuracy300: 0.3728 - val_loss: 3.3423 - val_accuracy300: 0.3278 - 117s/epoch - 40ms/step
Epoch 3/50
2948/2948 - 116s - loss: 3.2668 - accuracy300: 0.3832 - val_loss: 3.3364 - val_accuracy300: 0.3387 - 116s/epoch - 39ms/step
Epoch 4/50
2948/2948 - 117s - loss: 3.2552 - accuracy300: 0.3926 - val_loss: 3.3615 - val_accuracy300: 0.3392 - 117s/epoch - 40ms/step
Epoch 5/50
2948/2948 - 116s - loss: 3.2449 - accuracy300: 0.4000 - val_loss: 3.3549 - val_accuracy300: 0.3374 - 116s/epoch - 39ms/step
Epoch 6/50
2948/2948 - 116s - loss: 3.2369 - accuracy300: 0.4048 - val_loss: 3.3734 - val_accuracy300: 0.3438 - 116s/epoch - 40ms/step
Epoch 7/50
2948/2948 - 116s - loss: 3.2301 - accuracy300: 0.4087 - val_loss: 3.3700 - val_accuracy300: 0.3448 - 116s/epoch - 39ms/step
Epoch 8/50
2948/2948 - 115s - loss: 3.2252 - accuracy300: 0.4114 - val_loss: 3.3780 - val_accuracy300: 0.3462 - 115s/epoch - 39ms/step
Epoch 9/50
2948/2948 - 115s - loss: 3.2211 - accuracy300: 0.4141 - val_loss: 3.3771 - val_accuracy300: 0.3488 - 115s/epoch - 39ms/step
Epoch 10/50
2948/2948 - 115s - loss: 3.2160 - accuracy300: 0.4167 - val_loss: 3.4013 - val_accuracy300: 0.3507 - 115s/epoch - 39ms/step
Epoch 11/50
2948/2948 - 115s - loss: 3.2115 - accuracy300: 0.4193 - val_loss: 3.3707 - val_accuracy300: 0.3570 - 115s/epoch - 39ms/step
Epoch 12/50
2948/2948 - 115s - loss: 3.2073 - accuracy300: 0.4212 - val_loss: 3.3844 - val_accuracy300: 0.3575 - 115s/epoch - 39ms/step
Epoch 13/50
2948/2948 - 113s - loss: 3.2031 - accuracy300: 0.4228 - val_loss: 3.3615 - val_accuracy300: 0.3635 - 113s/epoch - 38ms/step
testing model: results/ATVI/W1/deepVOL_L3/h300
Evaluating performance on  test set...
12066/12066 - 231s - 231s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021897
{'0': {'precision': 0.3107386709267355, 'recall': 0.11669522238768527, 'f1-score': 0.16967170304192514, 'support': 936765}, '1': {'precision': 0.3804079876510408, 'recall': 0.7946216131471678, 'f1-score': 0.5145068832240414, 'support': 1192774}, '2': {'precision': 0.34055934371206753, 'recall': 0.08715494478803881, 'f1-score': 0.13879092467245738, 'support': 959303}, 'accuracy': 0.3693060376671905, 'macro avg': {'precision': 0.3439020007632813, 'recall': 0.33282392677429734, 'f1-score': 0.27432317031280795, 'support': 3088842}, 'weighted avg': {'precision': 0.3469032952265552, 'recall': 0.3693060376671905, 'f1-score': 0.29324112286798876, 'support': 3088842}}
[[109316 765918  61531]
 [144607 947804 100363]
 [ 97871 777824  83608]]
Evaluating performance on  train set...
2948/2948 - 65s - 65s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1135602
{'0': {'precision': 0.3860598789028712, 'recall': 0.1089401640086453, 'f1-score': 0.16992898132881368, 'support': 254011}, '1': {'precision': 0.325854399513415, 'recall': 0.8397125106590327, 'f1-score': 0.46951232663977743, 'support': 246270}, '2': {'precision': 0.41972310438591026, 'recall': 0.0795472873828191, 'f1-score': 0.13374650272175886, 'support': 254201}, 'accuracy': 0.3375680268051458, 'macro avg': {'precision': 0.37721246093406546, 'recall': 0.34273332068349904, 'f1-score': 0.25772927023011666, 'support': 754482}, 'weighted avg': {'precision': 0.37775010103112955, 'recall': 0.3375680268051458, 'f1-score': 0.25552514956786926, 'support': 754482}}
[[ 27672 213905  12434]
 [ 23952 206796  15522]
 [ 20054 213926  20221]]
Evaluating performance on  val set...
697/697 - 16s - 16s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1142792
{'0': {'precision': 0.3864329637340822, 'recall': 0.1304362037687744, 'f1-score': 0.19503910068426197, 'support': 61187}, '1': {'precision': 0.3267279938079223, 'recall': 0.8197143888230138, 'f1-score': 0.4672256396191669, 'support': 58191}, '2': {'precision': 0.40837161817253703, 'recall': 0.08132560740063027, 'f1-score': 0.1356391997287216, 'support': 59022}, 'accuracy': 0.3390190582959641, 'macro avg': {'precision': 0.3738441919048472, 'recall': 0.3438253999974728, 'f1-score': 0.2659679800107168, 'support': 178400}, 'weighted avg': {'precision': 0.3742164354677891, 'recall': 0.3390190582959641, 'f1-score': 0.2641697393219478, 'support': 178400}}
[[ 7981 50087  3119]
 [ 6656 47700  3835]
 [ 6016 48206  4800]]
training model: results/ATVI/W1/deepVOL_L3/h500
Epoch 1/50
2948/2948 - 120s - loss: 3.2645 - accuracy500: 0.3885 - val_loss: 3.3122 - val_accuracy500: 0.3265 - 120s/epoch - 41ms/step
Epoch 2/50
2948/2948 - 113s - loss: 3.2550 - accuracy500: 0.3896 - val_loss: 3.3225 - val_accuracy500: 0.3238 - 113s/epoch - 38ms/step
Epoch 3/50
2948/2948 - 114s - loss: 3.2545 - accuracy500: 0.3944 - val_loss: 3.3380 - val_accuracy500: 0.3433 - 114s/epoch - 39ms/step
Epoch 4/50
2948/2948 - 113s - loss: 3.2472 - accuracy500: 0.4014 - val_loss: 3.3251 - val_accuracy500: 0.3370 - 113s/epoch - 38ms/step
Epoch 5/50
2948/2948 - 114s - loss: 3.2339 - accuracy500: 0.4107 - val_loss: 3.3341 - val_accuracy500: 0.3365 - 114s/epoch - 39ms/step
Epoch 6/50
2948/2948 - 114s - loss: 3.2301 - accuracy500: 0.4123 - val_loss: 3.3604 - val_accuracy500: 0.3403 - 114s/epoch - 39ms/step
Epoch 7/50
2948/2948 - 116s - loss: 3.2184 - accuracy500: 0.4179 - val_loss: 3.3713 - val_accuracy500: 0.3392 - 116s/epoch - 39ms/step
Epoch 8/50
2948/2948 - 118s - loss: 3.2115 - accuracy500: 0.4195 - val_loss: 3.3766 - val_accuracy500: 0.3373 - 118s/epoch - 40ms/step
Epoch 9/50
2948/2948 - 119s - loss: 3.2037 - accuracy500: 0.4225 - val_loss: 3.3502 - val_accuracy500: 0.3336 - 119s/epoch - 40ms/step
Epoch 10/50
2948/2948 - 118s - loss: 3.1964 - accuracy500: 0.4270 - val_loss: 3.3695 - val_accuracy500: 0.3363 - 118s/epoch - 40ms/step
Epoch 11/50
2948/2948 - 118s - loss: 3.1944 - accuracy500: 0.4282 - val_loss: 3.3726 - val_accuracy500: 0.3359 - 118s/epoch - 40ms/step
testing model: results/ATVI/W1/deepVOL_L3/h500
Evaluating performance on  test set...
12066/12066 - 235s - 235s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024344
{'0': {'precision': 0.24542298170120283, 'recall': 0.34131477747547967, 'f1-score': 0.285532979858862, 'support': 775173}, '1': {'precision': 0.501180692466163, 'recall': 0.1511682990760111, 'f1-score': 0.23227638516231, 'support': 1496663}, '2': {'precision': 0.25914940908563305, 'recall': 0.4946206025414746, 'f1-score': 0.34010542975438585, 'support': 817006}, 'accuracy': 0.2897312326107972, 'macro avg': {'precision': 0.33525102775099963, 'recall': 0.3290345596976551, 'f1-score': 0.2859715982585193, 'support': 3088842}, 'weighted avg': {'precision': 0.3729781224945038, 'recall': 0.2897312326107972, 'f1-score': 0.2741626489099228, 'support': 3088842}}
[[264578 109053 401542]
 [516702 226248 753713]
 [296769 116129 404108]]
Evaluating performance on  train set...
2948/2948 - 60s - 60s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003417
{'0': {'precision': 0.34243703465485587, 'recall': 0.3341317222559849, 'f1-score': 0.33823340195573853, 'support': 251757}, '1': {'precision': 0.34839301962823344, 'recall': 0.17161025427594984, 'f1-score': 0.2299516856402859, 'support': 249886}, '2': {'precision': 0.34749820476327503, 'recall': 0.5301595086201101, 'f1-score': 0.419820790438816, 'support': 252839}, 'accuracy': 0.3459963259560864, 'macro avg': {'precision': 0.34610941968212144, 'recall': 0.34530049505068156, 'f1-score': 0.32933529267828016, 'support': 754482}, 'weighted avg': {'precision': 0.34610574835524904, 'recall': 0.3459963259560864, 'f1-score': 0.3297115137641974, 'support': 754482}}
[[ 84120  40859 126778]
 [ 82083  42883 124920]
 [ 79448  39346 134045]]
Evaluating performance on  val set...
697/697 - 16s - 16s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037779
{'0': {'precision': 0.32171338908749736, 'recall': 0.33607083713542196, 'f1-score': 0.3287354231923105, 'support': 59178}, '1': {'precision': 0.3602072457510696, 'recall': 0.14589361228577788, 'f1-score': 0.20767376865544981, 'support': 62902}, '2': {'precision': 0.3202823147172462, 'recall': 0.5180930397727272, 'f1-score': 0.3958514217495116, 'support': 56320}, 'accuracy': 0.3264798206278027, 'macro avg': {'precision': 0.3340676498519377, 'recall': 0.3333524963979757, 'f1-score': 0.3107535378657573, 'support': 178400}, 'weighted avg': {'precision': 0.3348341428056559, 'recall': 0.3264798206278027, 'f1-score': 0.30723852209961966, 'support': 178400}}
[[19888  8288 31002]
 [22802  9177 30923]
 [19129  8012 29179]]
training model: results/ATVI/W1/deepVOL_L3/h1000
Epoch 1/50
2948/2948 - 122s - loss: 3.2640 - accuracy1000: 0.3915 - val_loss: 3.3855 - val_accuracy1000: 0.3539 - 122s/epoch - 42ms/step
Epoch 2/50
2948/2948 - 119s - loss: 3.2661 - accuracy1000: 0.3870 - val_loss: 3.3478 - val_accuracy1000: 0.3381 - 119s/epoch - 40ms/step
Epoch 3/50
2948/2948 - 120s - loss: 3.2666 - accuracy1000: 0.3828 - val_loss: 3.3636 - val_accuracy1000: 0.3301 - 120s/epoch - 41ms/step
Epoch 4/50
2948/2948 - 121s - loss: 3.2559 - accuracy1000: 0.3928 - val_loss: 3.4070 - val_accuracy1000: 0.3391 - 121s/epoch - 41ms/step
Epoch 5/50
2948/2948 - 119s - loss: 3.2439 - accuracy1000: 0.4000 - val_loss: 3.4111 - val_accuracy1000: 0.3386 - 119s/epoch - 40ms/step
Epoch 6/50
2948/2948 - 118s - loss: 3.2343 - accuracy1000: 0.4085 - val_loss: 3.4742 - val_accuracy1000: 0.3414 - 118s/epoch - 40ms/step
Epoch 7/50
2948/2948 - 119s - loss: 3.2140 - accuracy1000: 0.4147 - val_loss: 3.4237 - val_accuracy1000: 0.3336 - 119s/epoch - 40ms/step
Epoch 8/50
2948/2948 - 120s - loss: 3.1939 - accuracy1000: 0.4242 - val_loss: 3.4422 - val_accuracy1000: 0.3279 - 120s/epoch - 41ms/step
Epoch 9/50
2948/2948 - 119s - loss: 3.1817 - accuracy1000: 0.4304 - val_loss: 3.4094 - val_accuracy1000: 0.3333 - 119s/epoch - 40ms/step
Epoch 10/50
2948/2948 - 121s - loss: 3.1710 - accuracy1000: 0.4365 - val_loss: 3.4225 - val_accuracy1000: 0.3275 - 121s/epoch - 41ms/step
Epoch 11/50
2948/2948 - 118s - loss: 3.1644 - accuracy1000: 0.4397 - val_loss: 3.4059 - val_accuracy1000: 0.3229 - 118s/epoch - 40ms/step
Epoch 12/50
2948/2948 - 117s - loss: 3.1572 - accuracy1000: 0.4429 - val_loss: 3.3864 - val_accuracy1000: 0.3258 - 117s/epoch - 40ms/step
testing model: results/ATVI/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
12066/12066 - 239s - 239s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1208866
{'0': {'precision': 0.2945645964318139, 'recall': 0.38714645481216087, 'f1-score': 0.33456884412730004, 'support': 962925}, '1': {'precision': 0.352154726652578, 'recall': 0.5073290173564456, 'f1-score': 0.4157340093408547, 'support': 1080636}, '2': {'precision': 0.3118791258692707, 'recall': 0.07950302358887228, 'f1-score': 0.12670651196121183, 'support': 1045281}, 'accuracy': 0.3250842872506914, 'macro avg': {'precision': 0.31953281631788755, 'recall': 0.32465949858582627, 'f1-score': 0.2923364551431222, 'support': 3088842}, 'weighted avg': {'precision': 0.32057192105578625, 'recall': 0.3250842872506914, 'f1-score': 0.29262285046586123, 'support': 3088842}}
[[372793 501757  88375]
 [437417 548238  94981]
 [455363 506815  83103]]
Evaluating performance on  train set...
2948/2948 - 59s - 59s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1117034
{'0': {'precision': 0.34950483954560096, 'recall': 0.39551407794883986, 'f1-score': 0.3710887901113385, 'support': 252345}, '1': {'precision': 0.33621271619141796, 'recall': 0.5673429440125789, 'f1-score': 0.42221618571995734, 'support': 249306}, '2': {'precision': 0.37081657197362417, 'recall': 0.07073104168397072, 'f1-score': 0.11880142298634479, 'support': 252831}, 'accuracy': 0.34345550987299894, 'macro avg': {'precision': 0.35217804257021434, 'recall': 0.3445293545484632, 'f1-score': 0.30403546627254685, 'support': 754482}, 'weighted avg': {'precision': 0.3522543557919416, 'recall': 0.34345550987299894, 'f1-score': 0.3034401241021071, 'support': 754482}}
[[ 99806 136873  15666]
 [ 93187 141442  14677]
 [ 92571 142377  17883]]
Evaluating performance on  val set...
697/697 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1160794
{'0': {'precision': 0.328208447968927, 'recall': 0.37961371564706886, 'f1-score': 0.35204443953477366, 'support': 58765}, '1': {'precision': 0.34881713554987215, 'recall': 0.5166682450989677, 'f1-score': 0.41646627733882974, 'support': 63354}, '2': {'precision': 0.3081791332650232, 'recall': 0.09084771059504984, 'f1-score': 0.14032824678889014, 'support': 56281}, 'accuracy': 0.3371860986547085, 'macro avg': {'precision': 0.32840157226127414, 'recall': 0.32904322378036216, 'f1-score': 0.30294632122083115, 'support': 178400}, 'weighted avg': {'precision': 0.32920829624332604, 'recall': 0.3371860986547085, 'f1-score': 0.30813066189075516, 'support': 178400}}
[[22308 30700  5757]
 [24900 32733  5721]
 [20761 30407  5113]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        37 (peak)  17.13 (ave)

============================================
