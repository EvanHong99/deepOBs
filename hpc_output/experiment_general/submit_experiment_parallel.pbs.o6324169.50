This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-31.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-23.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-10.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-19.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-15.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-17.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-12.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-08-02.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-16.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-29.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-18.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-09.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-25.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-07-24.csv
training model: results/LILAK/W5/deepLOB_L1/h10
Epoch 1/50
273/273 - 14s - loss: 3.3008 - accuracy10: 0.3714 - val_loss: 3.4712 - val_accuracy10: 0.4233 - 14s/epoch - 52ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2434 - accuracy10: 0.3912 - val_loss: 3.3980 - val_accuracy10: 0.4322 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.1980 - accuracy10: 0.4053 - val_loss: 3.4086 - val_accuracy10: 0.4583 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.1634 - accuracy10: 0.4154 - val_loss: 3.3219 - val_accuracy10: 0.4350 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.1469 - accuracy10: 0.4273 - val_loss: 3.3168 - val_accuracy10: 0.4346 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.1310 - accuracy10: 0.4339 - val_loss: 3.3337 - val_accuracy10: 0.4481 - 5s/epoch - 19ms/step
Epoch 7/50
273/273 - 5s - loss: 3.1245 - accuracy10: 0.4360 - val_loss: 3.2637 - val_accuracy10: 0.4400 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.1112 - accuracy10: 0.4401 - val_loss: 3.2499 - val_accuracy10: 0.4331 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.1058 - accuracy10: 0.4443 - val_loss: 3.2196 - val_accuracy10: 0.4447 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.0970 - accuracy10: 0.4496 - val_loss: 3.2124 - val_accuracy10: 0.4417 - 5s/epoch - 19ms/step
Epoch 11/50
273/273 - 5s - loss: 3.0845 - accuracy10: 0.4545 - val_loss: 3.2068 - val_accuracy10: 0.4521 - 5s/epoch - 19ms/step
Epoch 12/50
273/273 - 5s - loss: 3.0781 - accuracy10: 0.4578 - val_loss: 3.2326 - val_accuracy10: 0.4507 - 5s/epoch - 19ms/step
Epoch 13/50
273/273 - 5s - loss: 3.0741 - accuracy10: 0.4583 - val_loss: 3.2204 - val_accuracy10: 0.4505 - 5s/epoch - 19ms/step
Epoch 14/50
273/273 - 5s - loss: 3.0645 - accuracy10: 0.4639 - val_loss: 3.2332 - val_accuracy10: 0.4493 - 5s/epoch - 19ms/step
Epoch 15/50
273/273 - 5s - loss: 3.0585 - accuracy10: 0.4668 - val_loss: 3.1982 - val_accuracy10: 0.4463 - 5s/epoch - 19ms/step
Epoch 16/50
273/273 - 5s - loss: 3.0519 - accuracy10: 0.4692 - val_loss: 3.2373 - val_accuracy10: 0.4458 - 5s/epoch - 19ms/step
Epoch 17/50
273/273 - 5s - loss: 3.0508 - accuracy10: 0.4701 - val_loss: 3.2274 - val_accuracy10: 0.4419 - 5s/epoch - 19ms/step
Epoch 18/50
273/273 - 5s - loss: 3.0448 - accuracy10: 0.4709 - val_loss: 3.2464 - val_accuracy10: 0.4435 - 5s/epoch - 19ms/step
Epoch 19/50
273/273 - 5s - loss: 3.0416 - accuracy10: 0.4729 - val_loss: 3.2280 - val_accuracy10: 0.4414 - 5s/epoch - 19ms/step
Epoch 20/50
273/273 - 5s - loss: 3.0343 - accuracy10: 0.4736 - val_loss: 3.2552 - val_accuracy10: 0.4306 - 5s/epoch - 19ms/step
Epoch 21/50
273/273 - 5s - loss: 3.0279 - accuracy10: 0.4788 - val_loss: 3.2693 - val_accuracy10: 0.4408 - 5s/epoch - 19ms/step
Epoch 22/50
273/273 - 5s - loss: 3.0264 - accuracy10: 0.4777 - val_loss: 3.2528 - val_accuracy10: 0.4293 - 5s/epoch - 19ms/step
Epoch 23/50
273/273 - 5s - loss: 3.0224 - accuracy10: 0.4800 - val_loss: 3.2520 - val_accuracy10: 0.4323 - 5s/epoch - 19ms/step
Epoch 24/50
273/273 - 5s - loss: 3.0164 - accuracy10: 0.4823 - val_loss: 3.2666 - val_accuracy10: 0.4293 - 5s/epoch - 19ms/step
Epoch 25/50
273/273 - 5s - loss: 3.0120 - accuracy10: 0.4831 - val_loss: 3.2853 - val_accuracy10: 0.4206 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h10
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1001289
{'0': {'precision': 0.3934439468011753, 'recall': 0.710390542632181, 'f1-score': 0.5064144335749324, 'support': 89158}, '1': {'precision': 0.43956010664081435, 'recall': 0.2988373170756825, 'f1-score': 0.355789331714883, 'support': 97103}, '2': {'precision': 0.4502177199196805, 'recall': 0.23460186458810944, 'f1-score': 0.3084664018178726, 'support': 85059}, 'accuracy': 0.4139392599144921, 'macro avg': {'precision': 0.4277405911205567, 'recall': 0.41460990809865766, 'f1-score': 0.390223389035896, 'support': 271320}, 'weighted avg': {'precision': 0.4277471232592152, 'recall': 0.4139392599144921, 'f1-score': 0.3904502182603956, 'support': 271320}}
[[63337 15350 10471]
 [54188 29018 13897]
 [43456 21648 19955]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0306115
{'0': {'precision': 0.3638947623834448, 'recall': 0.5742260146592276, 'f1-score': 0.4454817423776283, 'support': 18282}, '1': {'precision': 0.5648138036474828, 'recall': 0.4720413751140858, 'f1-score': 0.5142771912961337, 'support': 32870}, '2': {'precision': 0.4297700202262342, 'recall': 0.3098234055192526, 'f1-score': 0.36007029435762256, 'support': 18517}, 'accuracy': 0.455740716818097, 'macro avg': {'precision': 0.45282619541905395, 'recall': 0.45203026509752203, 'f1-score': 0.4399430760104615, 'support': 69669}, 'weighted avg': {'precision': 0.4761975230922803, 'recall': 0.455740716818097, 'f1-score': 0.4552384867397524, 'support': 69669}}
[[10498  5383  2401]
 [12143 15516  5211]
 [ 6208  6572  5737]]
Evaluating performance on  val set...
96/96 - 1s - 839ms/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0416456
{'0': {'precision': 0.3756112469437653, 'recall': 0.5438053097345132, 'f1-score': 0.44432393347794646, 'support': 6780}, '1': {'precision': 0.5414268650233467, 'recall': 0.442374234761778, 'f1-score': 0.48691406249999997, 'support': 11271}, '2': {'precision': 0.40905770635500366, 'recall': 0.34728682170542635, 'f1-score': 0.37564984068421936, 'support': 6450}, 'accuracy': 0.4454103914125954, 'macro avg': {'precision': 0.44203193944070523, 'recall': 0.4444887887339059, 'f1-score': 0.4356292788873886, 'support': 24501}, 'weighted avg': {'precision': 0.4606950188133807, 'recall': 0.4454103914125954, 'f1-score': 0.4458375633578707, 'support': 24501}}
[[3687 2017 1076]
 [4125 4986 2160]
 [2004 2206 2240]]
training model: results/LILAK/W5/deepLOB_L1/h20
Epoch 1/50
273/273 - 7s - loss: 3.3065 - accuracy20: 0.3752 - val_loss: 3.4033 - val_accuracy20: 0.3603 - 7s/epoch - 27ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2422 - accuracy20: 0.4062 - val_loss: 3.3880 - val_accuracy20: 0.3660 - 5s/epoch - 20ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2112 - accuracy20: 0.4191 - val_loss: 3.3235 - val_accuracy20: 0.3919 - 5s/epoch - 20ms/step
Epoch 4/50
273/273 - 5s - loss: 3.1936 - accuracy20: 0.4273 - val_loss: 3.2907 - val_accuracy20: 0.3993 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.1786 - accuracy20: 0.4350 - val_loss: 3.2440 - val_accuracy20: 0.4217 - 5s/epoch - 20ms/step
Epoch 6/50
273/273 - 5s - loss: 3.1612 - accuracy20: 0.4404 - val_loss: 3.2793 - val_accuracy20: 0.4003 - 5s/epoch - 20ms/step
Epoch 7/50
273/273 - 5s - loss: 3.1536 - accuracy20: 0.4451 - val_loss: 3.2534 - val_accuracy20: 0.4000 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.1467 - accuracy20: 0.4470 - val_loss: 3.2749 - val_accuracy20: 0.4004 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.1374 - accuracy20: 0.4510 - val_loss: 3.2779 - val_accuracy20: 0.4037 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.1319 - accuracy20: 0.4523 - val_loss: 3.2503 - val_accuracy20: 0.4151 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.1190 - accuracy20: 0.4571 - val_loss: 3.2612 - val_accuracy20: 0.4066 - 5s/epoch - 17ms/step
Epoch 12/50
273/273 - 5s - loss: 3.1139 - accuracy20: 0.4589 - val_loss: 3.2729 - val_accuracy20: 0.4048 - 5s/epoch - 18ms/step
Epoch 13/50
273/273 - 5s - loss: 3.1110 - accuracy20: 0.4615 - val_loss: 3.2677 - val_accuracy20: 0.4143 - 5s/epoch - 18ms/step
Epoch 14/50
273/273 - 5s - loss: 3.1027 - accuracy20: 0.4641 - val_loss: 3.2691 - val_accuracy20: 0.4072 - 5s/epoch - 18ms/step
Epoch 15/50
273/273 - 5s - loss: 3.1024 - accuracy20: 0.4623 - val_loss: 3.2837 - val_accuracy20: 0.4052 - 5s/epoch - 18ms/step
testing model: results/LILAK/W5/deepLOB_L1/h20
Evaluating performance on  test set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1335537
{'0': {'precision': 0.4219116175473708, 'recall': 0.635812618572749, 'f1-score': 0.5072337783297113, 'support': 102785}, '1': {'precision': 0.28523023752244775, 'recall': 0.35198684265544206, 'f1-score': 0.3151117377687384, 'support': 71747}, '2': {'precision': 0.4747902173133472, 'recall': 0.13679381741538207, 'f1-score': 0.2123939233521023, 'support': 96788}, 'accuracy': 0.3827436237652956, 'macro avg': {'precision': 0.3939773574610552, 'recall': 0.37486442621452437, 'f1-score': 0.34491314648351734, 'support': 271320}, 'weighted avg': {'precision': 0.4046314131448246, 'recall': 0.3827436237652956, 'f1-score': 0.351251396169528, 'support': 271320}}
[[65352 29590  7843]
 [39690 25254  6803]
 [49853 33695 13240]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769087
{'0': {'precision': 0.4101210521525439, 'recall': 0.41111263172300533, 'f1-score': 0.41061624330789387, 'support': 21921}, '1': {'precision': 0.41798617305976804, 'recall': 0.5866885784716516, 'f1-score': 0.48817333832554655, 'support': 25557}, '2': {'precision': 0.4547915080774761, 'recall': 0.2423054391419945, 'f1-score': 0.31616393249838304, 'support': 22191}, 'accuracy': 0.4217514245934347, 'macro avg': {'precision': 0.427632911096596, 'recall': 0.41336888311221714, 'f1-score': 0.40498450471060776, 'support': 69669}, 'weighted avg': {'precision': 0.4272347035966022, 'recall': 0.4217514245934347, 'f1-score': 0.40898187864344193, 'support': 69669}}
[[ 9012 10191  2718]
 [ 6835 14994  3728]
 [ 6127 10687  5377]]
Evaluating performance on  val set...
96/96 - 1s - 722ms/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0711516
{'0': {'precision': 0.4257595772787318, 'recall': 0.403227824346303, 'f1-score': 0.41418749598406474, 'support': 7993}, '1': {'precision': 0.42451268848841484, 'recall': 0.5213414634146342, 'f1-score': 0.467970808838435, 'support': 8856}, '2': {'precision': 0.42658959537572255, 'recall': 0.33755880815473077, 'f1-score': 0.3768877216021011, 'support': 7652}, 'accuracy': 0.4254112077058079, 'macro avg': {'precision': 0.42562062038095644, 'recall': 0.4207093653052227, 'f1-score': 0.4196820088082003, 'support': 24501}, 'weighted avg': {'precision': 0.4255681096386814, 'recall': 0.4254112077058079, 'f1-score': 0.42197849002788, 'support': 24501}}
[[3223 3211 1559]
 [2326 4617 1913]
 [2021 3048 2583]]
training model: results/LILAK/W5/deepLOB_L1/h30
Epoch 1/50
273/273 - 7s - loss: 3.3089 - accuracy30: 0.3743 - val_loss: 3.4966 - val_accuracy30: 0.3390 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2647 - accuracy30: 0.3957 - val_loss: 3.3971 - val_accuracy30: 0.3455 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2306 - accuracy30: 0.4133 - val_loss: 3.3577 - val_accuracy30: 0.3709 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2130 - accuracy30: 0.4263 - val_loss: 3.3095 - val_accuracy30: 0.3760 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.1932 - accuracy30: 0.4371 - val_loss: 3.2821 - val_accuracy30: 0.3844 - 5s/epoch - 18ms/step
Epoch 6/50
273/273 - 5s - loss: 3.1865 - accuracy30: 0.4391 - val_loss: 3.3146 - val_accuracy30: 0.3776 - 5s/epoch - 19ms/step
Epoch 7/50
273/273 - 5s - loss: 3.1780 - accuracy30: 0.4402 - val_loss: 3.2807 - val_accuracy30: 0.3934 - 5s/epoch - 18ms/step
Epoch 8/50
273/273 - 5s - loss: 3.1722 - accuracy30: 0.4424 - val_loss: 3.2803 - val_accuracy30: 0.3933 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.1692 - accuracy30: 0.4462 - val_loss: 3.2739 - val_accuracy30: 0.3968 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.1631 - accuracy30: 0.4458 - val_loss: 3.2886 - val_accuracy30: 0.3781 - 5s/epoch - 18ms/step
Epoch 11/50
273/273 - 5s - loss: 3.1577 - accuracy30: 0.4474 - val_loss: 3.2912 - val_accuracy30: 0.3841 - 5s/epoch - 18ms/step
Epoch 12/50
273/273 - 5s - loss: 3.1453 - accuracy30: 0.4521 - val_loss: 3.2753 - val_accuracy30: 0.3944 - 5s/epoch - 18ms/step
Epoch 13/50
273/273 - 5s - loss: 3.1401 - accuracy30: 0.4539 - val_loss: 3.2786 - val_accuracy30: 0.3932 - 5s/epoch - 18ms/step
Epoch 14/50
273/273 - 5s - loss: 3.1315 - accuracy30: 0.4566 - val_loss: 3.2872 - val_accuracy30: 0.3936 - 5s/epoch - 18ms/step
Epoch 15/50
273/273 - 5s - loss: 3.1246 - accuracy30: 0.4576 - val_loss: 3.2731 - val_accuracy30: 0.3962 - 5s/epoch - 19ms/step
Epoch 16/50
273/273 - 5s - loss: 3.1222 - accuracy30: 0.4567 - val_loss: 3.2675 - val_accuracy30: 0.4055 - 5s/epoch - 19ms/step
Epoch 17/50
273/273 - 5s - loss: 3.1184 - accuracy30: 0.4588 - val_loss: 3.2678 - val_accuracy30: 0.4041 - 5s/epoch - 18ms/step
Epoch 18/50
273/273 - 5s - loss: 3.1166 - accuracy30: 0.4596 - val_loss: 3.2730 - val_accuracy30: 0.3963 - 5s/epoch - 18ms/step
Epoch 19/50
273/273 - 5s - loss: 3.1121 - accuracy30: 0.4606 - val_loss: 3.2642 - val_accuracy30: 0.4118 - 5s/epoch - 19ms/step
Epoch 20/50
273/273 - 5s - loss: 3.1054 - accuracy30: 0.4626 - val_loss: 3.2701 - val_accuracy30: 0.4009 - 5s/epoch - 18ms/step
Epoch 21/50
273/273 - 5s - loss: 3.1057 - accuracy30: 0.4646 - val_loss: 3.2738 - val_accuracy30: 0.4027 - 5s/epoch - 19ms/step
Epoch 22/50
273/273 - 5s - loss: 3.0944 - accuracy30: 0.4664 - val_loss: 3.2937 - val_accuracy30: 0.3948 - 5s/epoch - 19ms/step
Epoch 23/50
273/273 - 5s - loss: 3.0916 - accuracy30: 0.4688 - val_loss: 3.2785 - val_accuracy30: 0.3985 - 5s/epoch - 19ms/step
Epoch 24/50
273/273 - 5s - loss: 3.0888 - accuracy30: 0.4693 - val_loss: 3.2807 - val_accuracy30: 0.4065 - 5s/epoch - 18ms/step
Epoch 25/50
273/273 - 5s - loss: 3.0870 - accuracy30: 0.4707 - val_loss: 3.3047 - val_accuracy30: 0.3986 - 5s/epoch - 18ms/step
Epoch 26/50
273/273 - 5s - loss: 3.0818 - accuracy30: 0.4707 - val_loss: 3.3105 - val_accuracy30: 0.3974 - 5s/epoch - 19ms/step
Epoch 27/50
273/273 - 5s - loss: 3.0763 - accuracy30: 0.4710 - val_loss: 3.3087 - val_accuracy30: 0.4058 - 5s/epoch - 19ms/step
Epoch 28/50
273/273 - 5s - loss: 3.0738 - accuracy30: 0.4739 - val_loss: 3.3043 - val_accuracy30: 0.4000 - 5s/epoch - 18ms/step
Epoch 29/50
273/273 - 5s - loss: 3.0676 - accuracy30: 0.4754 - val_loss: 3.3196 - val_accuracy30: 0.3952 - 5s/epoch - 18ms/step
testing model: results/LILAK/W5/deepLOB_L1/h30
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.116833
{'0': {'precision': 0.44112408095202, 'recall': 0.6582310693886784, 'f1-score': 0.5282398057591504, 'support': 106098}, '1': {'precision': 0.2766036038929753, 'recall': 0.26583626597518056, 'f1-score': 0.2711130700332142, 'support': 64788}, '2': {'precision': 0.46174464898103984, 'recall': 0.2332676185355557, 'f1-score': 0.30995157833461223, 'support': 100434}, 'accuracy': 0.4072239422084623, 'macro avg': {'precision': 0.39315744460867835, 'recall': 0.38577831796647155, 'f1-score': 0.369768151375659, 'support': 271320}, 'weighted avg': {'precision': 0.40947161693066214, 'recall': 0.4072239422084623, 'f1-score': 0.3860376577886063, 'support': 271320}}
[[69837 20407 15854]
 [36109 17223 11456]
 [52370 24636 23428]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0746449
{'0': {'precision': 0.432430387409201, 'recall': 0.48850329087956235, 'f1-score': 0.4587597832630945, 'support': 23398}, '1': {'precision': 0.4068347572410919, 'recall': 0.42870317509112466, 'f1-score': 0.4174827866398666, 'support': 22771}, '2': {'precision': 0.4493815611682777, 'recall': 0.3679574468085106, 'f1-score': 0.4046137288849375, 'support': 23500}, 'accuracy': 0.42829665992048116, 'macro avg': {'precision': 0.42954890193952355, 'recall': 0.4283879709263992, 'f1-score': 0.4269520995959662, 'support': 69669}, 'weighted avg': {'precision': 0.42978235871322845, 'recall': 0.42829665992048116, 'f1-score': 0.42700461571376536, 'support': 69669}}
[[11430  7048  4920]
 [ 7334  9762  5675]
 [ 7668  7185  8647]]
Evaluating performance on  val set...
96/96 - 1s - 696ms/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892266
{'0': {'precision': 0.4188956491791987, 'recall': 0.4338882282996433, 'f1-score': 0.4262601483558203, 'support': 8410}, '1': {'precision': 0.3952403173121792, 'recall': 0.31874059207225286, 'f1-score': 0.3528921602666481, 'support': 7972}, '2': {'precision': 0.40433714346757826, 'recall': 0.4661904175391058, 'f1-score': 0.43306636155606404, 'support': 8119}, 'accuracy': 0.40712623974531653, 'macro avg': {'precision': 0.406157703319652, 'recall': 0.4062730793036673, 'f1-score': 0.4040728900595108, 'support': 24501}, 'weighted avg': {'precision': 0.40637449438892376, 'recall': 0.40712623974531653, 'f1-score': 0.4046434814412412, 'support': 24501}}
[[3649 1936 2825]
 [2680 2541 2751]
 [2382 1952 3785]]
training model: results/LILAK/W5/deepLOB_L1/h50
Epoch 1/50
273/273 - 7s - loss: 3.3114 - accuracy50: 0.3741 - val_loss: 3.4178 - val_accuracy50: 0.3390 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2730 - accuracy50: 0.3911 - val_loss: 3.4047 - val_accuracy50: 0.3490 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2551 - accuracy50: 0.4029 - val_loss: 3.3860 - val_accuracy50: 0.3513 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2365 - accuracy50: 0.4094 - val_loss: 3.3637 - val_accuracy50: 0.3525 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2250 - accuracy50: 0.4160 - val_loss: 3.3724 - val_accuracy50: 0.3507 - 5s/epoch - 18ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2135 - accuracy50: 0.4211 - val_loss: 3.3550 - val_accuracy50: 0.3548 - 5s/epoch - 19ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2076 - accuracy50: 0.4232 - val_loss: 3.3523 - val_accuracy50: 0.3598 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.1993 - accuracy50: 0.4255 - val_loss: 3.3525 - val_accuracy50: 0.3532 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.1945 - accuracy50: 0.4293 - val_loss: 3.3550 - val_accuracy50: 0.3567 - 5s/epoch - 18ms/step
Epoch 10/50
273/273 - 5s - loss: 3.1872 - accuracy50: 0.4311 - val_loss: 3.3386 - val_accuracy50: 0.3623 - 5s/epoch - 18ms/step
Epoch 11/50
273/273 - 5s - loss: 3.1833 - accuracy50: 0.4338 - val_loss: 3.3700 - val_accuracy50: 0.3606 - 5s/epoch - 18ms/step
Epoch 12/50
273/273 - 5s - loss: 3.1770 - accuracy50: 0.4361 - val_loss: 3.3604 - val_accuracy50: 0.3538 - 5s/epoch - 19ms/step
Epoch 13/50
273/273 - 5s - loss: 3.1740 - accuracy50: 0.4372 - val_loss: 3.3613 - val_accuracy50: 0.3533 - 5s/epoch - 18ms/step
Epoch 14/50
273/273 - 5s - loss: 3.1678 - accuracy50: 0.4389 - val_loss: 3.3620 - val_accuracy50: 0.3517 - 5s/epoch - 18ms/step
Epoch 15/50
273/273 - 5s - loss: 3.1638 - accuracy50: 0.4399 - val_loss: 3.3653 - val_accuracy50: 0.3510 - 5s/epoch - 18ms/step
Epoch 16/50
273/273 - 5s - loss: 3.1597 - accuracy50: 0.4436 - val_loss: 3.3548 - val_accuracy50: 0.3530 - 5s/epoch - 18ms/step
Epoch 17/50
273/273 - 5s - loss: 3.1596 - accuracy50: 0.4422 - val_loss: 3.3499 - val_accuracy50: 0.3613 - 5s/epoch - 18ms/step
Epoch 18/50
273/273 - 5s - loss: 3.1547 - accuracy50: 0.4451 - val_loss: 3.3437 - val_accuracy50: 0.3588 - 5s/epoch - 18ms/step
Epoch 19/50
273/273 - 5s - loss: 3.1523 - accuracy50: 0.4454 - val_loss: 3.3705 - val_accuracy50: 0.3563 - 5s/epoch - 18ms/step
Epoch 20/50
273/273 - 5s - loss: 3.1512 - accuracy50: 0.4469 - val_loss: 3.3781 - val_accuracy50: 0.3541 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h50
Evaluating performance on  test set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1696055
{'0': {'precision': 0.39225551823730054, 'recall': 0.589905858768499, 'f1-score': 0.47119309262166403, 'support': 101762}, '1': {'precision': 0.26255005348504784, 'recall': 0.39453469515491196, 'f1-score': 0.3152868957285361, 'support': 70298}, '2': {'precision': 0.47718465796757614, 'recall': 0.06078984485190409, 'f1-score': 0.10784147267771771, 'support': 99260}, 'accuracy': 0.34571354857732567, 'macro avg': {'precision': 0.37733007656330814, 'recall': 0.34841013292510503, 'f1-score': 0.29810715367597257, 'support': 271320}, 'weighted avg': {'precision': 0.3897198837410352, 'recall': 0.34571354857732567, 'f1-score': 0.2978694319080077, 'support': 271320}}
[[60030 37926  3806]
 [39758 27735  2805]
 [53250 39976  6034]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1080675
{'0': {'precision': 0.41560744900975466, 'recall': 0.36029725805073887, 'f1-score': 0.3859809663250366, 'support': 23414}, '1': {'precision': 0.3497236379297969, 'recall': 0.6363082281236395, 'f1-score': 0.45136883714466597, 'support': 22970}, '2': {'precision': 0.480865663763526, 'recall': 0.15649559802447927, 'f1-score': 0.2361403622460551, 'support': 23285}, 'accuracy': 0.3831833383570885, 'macro avg': {'precision': 0.41539891690102587, 'recall': 0.38436702806628587, 'f1-score': 0.35783005523858585, 'support': 69669}, 'weighted avg': {'precision': 0.4156962458926572, 'recall': 0.3831833383570885, 'f1-score': 0.35745925547441154, 'support': 69669}}
[[ 8436 13317  1661]
 [ 6081 14616  2273]
 [ 5781 13860  3644]]
Evaluating performance on  val set...
96/96 - 1s - 688ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1167792
{'0': {'precision': 0.4009070294784581, 'recall': 0.3185968284478616, 'f1-score': 0.35504384496954283, 'support': 8324}, '1': {'precision': 0.32513284786459357, 'recall': 0.6204306459689535, 'f1-score': 0.4266712582325341, 'support': 7988}, '2': {'precision': 0.45743473325766176, 'recall': 0.14763707412382465, 'f1-score': 0.22322747415066468, 'support': 8189}, 'accuracy': 0.35986286274029633, 'macro avg': {'precision': 0.39449153686690447, 'recall': 0.3622215161802132, 'f1-score': 0.3349808591175805, 'support': 24501}, 'weighted avg': {'precision': 0.39509588721962574, 'recall': 0.35986286274029633, 'f1-score': 0.33433920093497205, 'support': 24501}}
[[2652 5078  594]
 [2192 4956  840]
 [1771 5209 1209]]
training model: results/LILAK/W5/deepLOB_L1/h100
Epoch 1/50
273/273 - 7s - loss: 3.3306 - accuracy100: 0.3610 - val_loss: 3.3722 - val_accuracy100: 0.3430 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2854 - accuracy100: 0.3791 - val_loss: 3.4016 - val_accuracy100: 0.3437 - 5s/epoch - 18ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2754 - accuracy100: 0.3800 - val_loss: 3.3834 - val_accuracy100: 0.3415 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2636 - accuracy100: 0.3875 - val_loss: 3.3293 - val_accuracy100: 0.3693 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2620 - accuracy100: 0.3881 - val_loss: 3.3577 - val_accuracy100: 0.3592 - 5s/epoch - 18ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2441 - accuracy100: 0.3971 - val_loss: 3.3320 - val_accuracy100: 0.3661 - 5s/epoch - 18ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2387 - accuracy100: 0.3989 - val_loss: 3.3403 - val_accuracy100: 0.3536 - 5s/epoch - 18ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2319 - accuracy100: 0.4043 - val_loss: 3.3194 - val_accuracy100: 0.3650 - 5s/epoch - 18ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2301 - accuracy100: 0.4059 - val_loss: 3.2978 - val_accuracy100: 0.3782 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2210 - accuracy100: 0.4094 - val_loss: 3.3107 - val_accuracy100: 0.3800 - 5s/epoch - 18ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2120 - accuracy100: 0.4149 - val_loss: 3.3178 - val_accuracy100: 0.3767 - 5s/epoch - 18ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2072 - accuracy100: 0.4176 - val_loss: 3.3076 - val_accuracy100: 0.3859 - 5s/epoch - 18ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2057 - accuracy100: 0.4189 - val_loss: 3.3167 - val_accuracy100: 0.3790 - 5s/epoch - 19ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2009 - accuracy100: 0.4202 - val_loss: 3.3065 - val_accuracy100: 0.3866 - 5s/epoch - 19ms/step
Epoch 15/50
273/273 - 5s - loss: 3.1963 - accuracy100: 0.4222 - val_loss: 3.3054 - val_accuracy100: 0.3742 - 5s/epoch - 19ms/step
Epoch 16/50
273/273 - 5s - loss: 3.1905 - accuracy100: 0.4258 - val_loss: 3.3073 - val_accuracy100: 0.3821 - 5s/epoch - 19ms/step
Epoch 17/50
273/273 - 5s - loss: 3.1950 - accuracy100: 0.4247 - val_loss: 3.2852 - val_accuracy100: 0.3924 - 5s/epoch - 20ms/step
Epoch 18/50
273/273 - 5s - loss: 3.1901 - accuracy100: 0.4279 - val_loss: 3.2849 - val_accuracy100: 0.3981 - 5s/epoch - 19ms/step
Epoch 19/50
273/273 - 5s - loss: 3.1902 - accuracy100: 0.4260 - val_loss: 3.2998 - val_accuracy100: 0.3921 - 5s/epoch - 18ms/step
Epoch 20/50
273/273 - 5s - loss: 3.1883 - accuracy100: 0.4255 - val_loss: 3.2956 - val_accuracy100: 0.3925 - 5s/epoch - 20ms/step
Epoch 21/50
273/273 - 5s - loss: 3.1816 - accuracy100: 0.4317 - val_loss: 3.3039 - val_accuracy100: 0.3958 - 5s/epoch - 19ms/step
Epoch 22/50
273/273 - 5s - loss: 3.1774 - accuracy100: 0.4334 - val_loss: 3.3055 - val_accuracy100: 0.3939 - 5s/epoch - 17ms/step
Epoch 23/50
273/273 - 5s - loss: 3.1708 - accuracy100: 0.4364 - val_loss: 3.3103 - val_accuracy100: 0.3945 - 5s/epoch - 17ms/step
Epoch 24/50
273/273 - 5s - loss: 3.1691 - accuracy100: 0.4348 - val_loss: 3.3259 - val_accuracy100: 0.3867 - 5s/epoch - 17ms/step
Epoch 25/50
273/273 - 5s - loss: 3.1673 - accuracy100: 0.4348 - val_loss: 3.3182 - val_accuracy100: 0.3885 - 5s/epoch - 18ms/step
Epoch 26/50
273/273 - 5s - loss: 3.1633 - accuracy100: 0.4367 - val_loss: 3.3361 - val_accuracy100: 0.3886 - 5s/epoch - 18ms/step
Epoch 27/50
273/273 - 5s - loss: 3.1611 - accuracy100: 0.4378 - val_loss: 3.3498 - val_accuracy100: 0.3821 - 5s/epoch - 18ms/step
Epoch 28/50
273/273 - 5s - loss: 3.1595 - accuracy100: 0.4391 - val_loss: 3.3338 - val_accuracy100: 0.3870 - 5s/epoch - 18ms/step
testing model: results/LILAK/W5/deepLOB_L1/h100
Evaluating performance on  test set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1260802
{'0': {'precision': 0.3867015299507304, 'recall': 0.7174573264240395, 'f1-score': 0.5025397282297726, 'support': 99769}, '1': {'precision': 0.2935976081241301, 'recall': 0.15997696758609067, 'f1-score': 0.2071053253577208, 'support': 71204}, '2': {'precision': 0.40841030832173436, 'recall': 0.19299032357718715, 'f1-score': 0.26211890501810303, 'support': 100347}, 'accuracy': 0.37718192540173967, 'macro avg': {'precision': 0.362903148798865, 'recall': 0.3568082058624391, 'f1-score': 0.3239213195351988, 'support': 271320}, 'weighted avg': {'precision': 0.37029669113845665, 'recall': 0.37718192540173967, 'f1-score': 0.3360882334305577, 'support': 271320}}
[[71580 12553 15636]
 [47397 11391 12416]
 [66127 14854 19366]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1022815
{'0': {'precision': 0.37848934865491773, 'recall': 0.6017038952231594, 'f1-score': 0.4646808510638297, 'support': 23593}, '1': {'precision': 0.371562317144529, 'recall': 0.19326927257706858, 'f1-score': 0.25427607116297696, 'support': 22999}, '2': {'precision': 0.4023961582256547, 'recall': 0.35221215929280236, 'f1-score': 0.37563545614197247, 'support': 23077}, 'accuracy': 0.3842311501528657, 'macro avg': {'precision': 0.38414927467503385, 'recall': 0.3823951090310101, 'f1-score': 0.36486412612292635, 'support': 69669}, 'weighted avg': {'precision': 0.38412144681559846, 'recall': 0.3842311501528657, 'f1-score': 0.36572722589981976, 'support': 69669}}
[[14196  3992  5405]
 [11888  4445  6666]
 [11423  3526  8128]]
Evaluating performance on  val set...
96/96 - 1s - 740ms/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0956538
{'0': {'precision': 0.39263895097600954, 'recall': 0.5996131528046421, 'f1-score': 0.47453964251947234, 'support': 8789}, '1': {'precision': 0.34220430107526884, 'recall': 0.1760719225449516, 'f1-score': 0.2325114155251142, 'support': 7230}, '2': {'precision': 0.4279114010055714, 'recall': 0.3712567790615421, 'f1-score': 0.3975759106117037, 'support': 8482}, 'accuracy': 0.3955756907881311, 'macro avg': {'precision': 0.3875848843522833, 'recall': 0.3823139514703786, 'f1-score': 0.3682089895520968, 'support': 24501}, 'weighted avg': {'precision': 0.3899671580846332, 'recall': 0.3955756907881311, 'f1-score': 0.3764754632936895, 'support': 24501}}
[[5270 1267 2252]
 [3999 1273 1958]
 [4153 1180 3149]]
training model: results/LILAK/W5/deepLOB_L1/h200
Epoch 1/50
273/273 - 7s - loss: 3.3507 - accuracy200: 0.3508 - val_loss: 3.4547 - val_accuracy200: 0.3104 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3126 - accuracy200: 0.3613 - val_loss: 3.3662 - val_accuracy200: 0.3286 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2930 - accuracy200: 0.3681 - val_loss: 3.3592 - val_accuracy200: 0.3256 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2785 - accuracy200: 0.3796 - val_loss: 3.3694 - val_accuracy200: 0.3374 - 5s/epoch - 18ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2764 - accuracy200: 0.3780 - val_loss: 3.3778 - val_accuracy200: 0.3376 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2634 - accuracy200: 0.3914 - val_loss: 3.3606 - val_accuracy200: 0.3412 - 5s/epoch - 20ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2519 - accuracy200: 0.3997 - val_loss: 3.3336 - val_accuracy200: 0.3476 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2469 - accuracy200: 0.4015 - val_loss: 3.3516 - val_accuracy200: 0.3463 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2432 - accuracy200: 0.4033 - val_loss: 3.3429 - val_accuracy200: 0.3415 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2340 - accuracy200: 0.4075 - val_loss: 3.3614 - val_accuracy200: 0.3460 - 5s/epoch - 19ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2336 - accuracy200: 0.4052 - val_loss: 3.3518 - val_accuracy200: 0.3510 - 5s/epoch - 19ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2251 - accuracy200: 0.4122 - val_loss: 3.3474 - val_accuracy200: 0.3466 - 5s/epoch - 19ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2234 - accuracy200: 0.4147 - val_loss: 3.3425 - val_accuracy200: 0.3530 - 5s/epoch - 19ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2208 - accuracy200: 0.4173 - val_loss: 3.3448 - val_accuracy200: 0.3486 - 5s/epoch - 19ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2185 - accuracy200: 0.4170 - val_loss: 3.3287 - val_accuracy200: 0.3497 - 5s/epoch - 20ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2136 - accuracy200: 0.4185 - val_loss: 3.3354 - val_accuracy200: 0.3565 - 5s/epoch - 19ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2068 - accuracy200: 0.4231 - val_loss: 3.3194 - val_accuracy200: 0.3643 - 5s/epoch - 19ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2078 - accuracy200: 0.4229 - val_loss: 3.3512 - val_accuracy200: 0.3562 - 5s/epoch - 19ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2040 - accuracy200: 0.4251 - val_loss: 3.3356 - val_accuracy200: 0.3581 - 5s/epoch - 19ms/step
Epoch 20/50
273/273 - 5s - loss: 3.2013 - accuracy200: 0.4242 - val_loss: 3.3263 - val_accuracy200: 0.3710 - 5s/epoch - 19ms/step
Epoch 21/50
273/273 - 5s - loss: 3.2004 - accuracy200: 0.4256 - val_loss: 3.3350 - val_accuracy200: 0.3621 - 5s/epoch - 19ms/step
Epoch 22/50
273/273 - 5s - loss: 3.1935 - accuracy200: 0.4285 - val_loss: 3.3536 - val_accuracy200: 0.3598 - 5s/epoch - 19ms/step
Epoch 23/50
273/273 - 5s - loss: 3.1921 - accuracy200: 0.4297 - val_loss: 3.3607 - val_accuracy200: 0.3647 - 5s/epoch - 19ms/step
Epoch 24/50
273/273 - 5s - loss: 3.1892 - accuracy200: 0.4317 - val_loss: 3.3596 - val_accuracy200: 0.3616 - 5s/epoch - 19ms/step
Epoch 25/50
273/273 - 5s - loss: 3.1873 - accuracy200: 0.4311 - val_loss: 3.3711 - val_accuracy200: 0.3667 - 5s/epoch - 19ms/step
Epoch 26/50
273/273 - 5s - loss: 3.1872 - accuracy200: 0.4317 - val_loss: 3.3648 - val_accuracy200: 0.3670 - 5s/epoch - 19ms/step
Epoch 27/50
273/273 - 5s - loss: 3.1878 - accuracy200: 0.4320 - val_loss: 3.3750 - val_accuracy200: 0.3597 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h200
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.130158
{'0': {'precision': 0.3424554842404946, 'recall': 0.4461183957864706, 'f1-score': 0.38747337472659954, 'support': 91135}, '1': {'precision': 0.28106328270963205, 'recall': 0.18825191113974551, 'f1-score': 0.22548044817095791, 'support': 80711}, '2': {'precision': 0.3666061153451933, 'recall': 0.36316022277177956, 'f1-score': 0.3648750334573993, 'support': 99474}, 'accuracy': 0.33899454518649563, 'macro avg': {'precision': 0.3300416274317733, 'recall': 0.33251017656599857, 'f1-score': 0.325942952118319, 'support': 271320}, 'weighted avg': {'precision': 0.3330471615984164, 'recall': 0.33899454518649563, 'f1-score': 0.33099925378216194, 'support': 271320}}
[[40657 19177 31301]
 [34404 15194 31113]
 [43661 19688 36125]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1086497
{'0': {'precision': 0.3794150346361071, 'recall': 0.36466381719546276, 'f1-score': 0.37189320591810215, 'support': 24332}, '1': {'precision': 0.32264121420747927, 'recall': 0.27949216102652147, 'f1-score': 0.29952065075291723, 'support': 22133}, '2': {'precision': 0.3696053116931022, 'recall': 0.43182209963799345, 'f1-score': 0.39829868426282944, 'support': 23204}, 'accuracy': 0.3599735894013119, 'macro avg': {'precision': 0.3572205201788962, 'recall': 0.3586593592866592, 'f1-score': 0.3565708469779496, 'support': 69669}, 'weighted avg': {'precision': 0.35811144510968496, 'recall': 0.3599735894013119, 'f1-score': 0.35769594395137394, 'support': 69669}}
[[ 8873  6920  8539]
 [ 7396  6186  8551]
 [ 7117  6067 10020]]
Evaluating performance on  val set...
96/96 - 1s - 698ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1116391
{'0': {'precision': 0.39546703296703295, 'recall': 0.3207799442896936, 'f1-score': 0.3542294678560442, 'support': 8975}, '1': {'precision': 0.30106631122959016, 'recall': 0.25609410430839, 'f1-score': 0.27676520140909794, 'support': 7056}, '2': {'precision': 0.37525626169890364, 'recall': 0.4970484061393152, 'f1-score': 0.42764995682868606, 'support': 8470}, 'accuracy': 0.363087220929758, 'macro avg': {'precision': 0.3572632019651756, 'recall': 0.357974151579133, 'f1-score': 0.3528815420312761, 'support': 24501}, 'weighted avg': {'precision': 0.3612938675770304, 'recall': 0.363087220929758, 'f1-score': 0.35730214560587575, 'support': 24501}}
[[2879 2184 3912]
 [2152 1807 3097]
 [2249 2011 4210]]
training model: results/LILAK/W5/deepLOB_L1/h300
Epoch 1/50
273/273 - 7s - loss: 3.3380 - accuracy300: 0.3634 - val_loss: 3.3720 - val_accuracy300: 0.3600 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2978 - accuracy300: 0.3796 - val_loss: 3.4003 - val_accuracy300: 0.3526 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2840 - accuracy300: 0.3796 - val_loss: 3.4052 - val_accuracy300: 0.3500 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2727 - accuracy300: 0.3925 - val_loss: 3.3975 - val_accuracy300: 0.3642 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2605 - accuracy300: 0.3963 - val_loss: 3.4223 - val_accuracy300: 0.3613 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2499 - accuracy300: 0.4008 - val_loss: 3.4345 - val_accuracy300: 0.3592 - 5s/epoch - 19ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2345 - accuracy300: 0.4116 - val_loss: 3.4565 - val_accuracy300: 0.3618 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2336 - accuracy300: 0.4137 - val_loss: 3.5766 - val_accuracy300: 0.3619 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2231 - accuracy300: 0.4175 - val_loss: 3.4731 - val_accuracy300: 0.3659 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2155 - accuracy300: 0.4229 - val_loss: 3.4653 - val_accuracy300: 0.3613 - 5s/epoch - 19ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2099 - accuracy300: 0.4265 - val_loss: 3.4375 - val_accuracy300: 0.3661 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h300
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1291152
{'0': {'precision': 0.3272173693377475, 'recall': 0.5530810373499933, 'f1-score': 0.41117357636307444, 'support': 88996}, '1': {'precision': 0.2863072324136003, 'recall': 0.16095998065530165, 'f1-score': 0.20606923666308075, 'support': 82710}, '2': {'precision': 0.3905773237448753, 'recall': 0.2916959463529223, 'f1-score': 0.33397123137308987, 'support': 99614}, 'accuracy': 0.33757924222320507, 'macro avg': {'precision': 0.3347006418320744, 'recall': 0.33524565478607243, 'f1-score': 0.31707134813308163, 'support': 271320}, 'weighted avg': {'precision': 0.3380085423928685, 'recall': 0.33757924222320507, 'f1-score': 0.3203044390697721, 'support': 271320}}
[[49222 16449 23325]
 [47384 13313 22013]
 [53820 16737 29057]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1259038
{'0': {'precision': 0.34964347184656996, 'recall': 0.5310373443983403, 'f1-score': 0.4216595555409123, 'support': 24100}, '1': {'precision': 0.3349108925534275, 'recall': 0.1983272026624628, 'f1-score': 0.24912676366236694, 'support': 22836}, '2': {'precision': 0.3608964846748196, 'recall': 0.31025381603835833, 'f1-score': 0.33366449049105873, 'support': 22733}, 'accuracy': 0.3499404326170894, 'macro avg': {'precision': 0.3484836163582723, 'recall': 0.3465394543663871, 'f1-score': 0.33481693656477934, 'support': 69669}, 'weighted avg': {'precision': 0.3484863081135811, 'recall': 0.3499404326170894, 'f1-score': 0.336394220182047, 'support': 69669}}
[[12798  4764  6538]
 [12355  4529  5952]
 [11450  4230  7053]]
Evaluating performance on  val set...
96/96 - 1s - 753ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1241329
{'0': {'precision': 0.3699495959676774, 'recall': 0.4982758620689655, 'f1-score': 0.4246292299921943, 'support': 9280}, '1': {'precision': 0.30246913580246915, 'recall': 0.1599881270406649, 'f1-score': 0.20927975150456224, 'support': 6738}, '2': {'precision': 0.3592083432092913, 'recall': 0.3573028409760698, 'f1-score': 0.35825305832988596, 'support': 8483}, 'accuracy': 0.3564344312477042, 'macro avg': {'precision': 0.34387569165981263, 'recall': 0.33852227669523344, 'f1-score': 0.33072067994221416, 'support': 24501}, 'weighted avg': {'precision': 0.34767289755771197, 'recall': 0.3564344312477042, 'f1-score': 0.3424246730246817, 'support': 24501}}
[[4624 1313 3343]
 [3596 1078 2064]
 [4279 1173 3031]]
training model: results/LILAK/W5/deepLOB_L1/h500
Epoch 1/50
273/273 - 7s - loss: 3.3446 - accuracy500: 0.3562 - val_loss: 3.5318 - val_accuracy500: 0.3284 - 7s/epoch - 27ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3135 - accuracy500: 0.3649 - val_loss: 3.4613 - val_accuracy500: 0.3046 - 5s/epoch - 20ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2838 - accuracy500: 0.3778 - val_loss: 3.5229 - val_accuracy500: 0.3237 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2745 - accuracy500: 0.3810 - val_loss: 3.4770 - val_accuracy500: 0.3260 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2661 - accuracy500: 0.3876 - val_loss: 3.4886 - val_accuracy500: 0.3293 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2449 - accuracy500: 0.3989 - val_loss: 3.4377 - val_accuracy500: 0.3300 - 5s/epoch - 19ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2319 - accuracy500: 0.4044 - val_loss: 3.4513 - val_accuracy500: 0.3273 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2235 - accuracy500: 0.4091 - val_loss: 3.4526 - val_accuracy500: 0.3279 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2057 - accuracy500: 0.4193 - val_loss: 3.4670 - val_accuracy500: 0.3304 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.1962 - accuracy500: 0.4230 - val_loss: 3.5093 - val_accuracy500: 0.3307 - 5s/epoch - 19ms/step
Epoch 11/50
273/273 - 5s - loss: 3.1887 - accuracy500: 0.4269 - val_loss: 3.5045 - val_accuracy500: 0.3290 - 5s/epoch - 19ms/step
Epoch 12/50
273/273 - 5s - loss: 3.1782 - accuracy500: 0.4327 - val_loss: 3.5300 - val_accuracy500: 0.3260 - 5s/epoch - 19ms/step
Epoch 13/50
273/273 - 5s - loss: 3.1707 - accuracy500: 0.4356 - val_loss: 3.4699 - val_accuracy500: 0.3300 - 5s/epoch - 19ms/step
Epoch 14/50
273/273 - 5s - loss: 3.1622 - accuracy500: 0.4361 - val_loss: 3.5231 - val_accuracy500: 0.3297 - 5s/epoch - 19ms/step
Epoch 15/50
273/273 - 5s - loss: 3.1604 - accuracy500: 0.4359 - val_loss: 3.5342 - val_accuracy500: 0.3258 - 5s/epoch - 19ms/step
Epoch 16/50
273/273 - 5s - loss: 3.1459 - accuracy500: 0.4432 - val_loss: 3.5786 - val_accuracy500: 0.3345 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h500
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.142806
{'0': {'precision': 0.3182899839738031, 'recall': 0.537950119015513, 'f1-score': 0.3999442076174038, 'support': 85283}, '1': {'precision': 0.3406372374510502, 'recall': 0.21520140341407462, 'f1-score': 0.2637657987953634, 'support': 88926}, '2': {'precision': 0.37329051703497135, 'recall': 0.2729247973967934, 'f1-score': 0.3153136004568383, 'support': 97111}, 'accuracy': 0.33731018723278783, 'macro avg': {'precision': 0.3440725794866082, 'recall': 0.34202543994212703, 'f1-score': 0.3263412022898685, 'support': 271320}, 'weighted avg': {'precision': 0.3453001882669654, 'recall': 0.33731018723278783, 'f1-score': 0.3250202651329631, 'support': 271320}}
[[45878 16992 22413]
 [47705 19137 22084]
 [50556 20051 26504]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1238055
{'0': {'precision': 0.35182142857142856, 'recall': 0.4145694806834442, 'f1-score': 0.3806267145782621, 'support': 23762}, '1': {'precision': 0.3389706296860026, 'recall': 0.25175849941383355, 'f1-score': 0.288926795281455, 'support': 23884}, '2': {'precision': 0.3472628499791057, 'recall': 0.37733278844844026, 'f1-score': 0.36167388418601615, 'support': 22023}, 'accuracy': 0.34698359385092364, 'macro avg': {'precision': 0.3460183027455123, 'recall': 0.34788692284857264, 'f1-score': 0.3437424646819111, 'support': 69669}, 'weighted avg': {'precision': 0.34597489629856343, 'recall': 0.34698359385092364, 'f1-score': 0.3431988907798242, 'support': 69669}}
[[9851 6298 7613]
 [9864 6013 8007]
 [8285 5428 8310]]
Evaluating performance on  val set...
96/96 - 1s - 695ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1451404
{'0': {'precision': 0.3413985642116458, 'recall': 0.2857142857142857, 'f1-score': 0.311084191399152, 'support': 8988}, '1': {'precision': 0.2919731894719634, 'recall': 0.24216949152542372, 'f1-score': 0.2647494811740291, 'support': 7375}, '2': {'precision': 0.33962437856748295, 'recall': 0.45330548046203, 'f1-score': 0.3883157894736842, 'support': 8138}, 'accuracy': 0.3282723154156973, 'macro avg': {'precision': 0.32433204408369737, 'recall': 0.3270630859005798, 'f1-score': 0.3213831540156218, 'support': 24501}, 'weighted avg': {'precision': 0.3259318297323448, 'recall': 0.3282723154156973, 'f1-score': 0.32278952004778927, 'support': 24501}}
[[2568 2392 4028]
 [2444 1786 3145]
 [2510 1939 3689]]
training model: results/LILAK/W5/deepLOB_L1/h1000
Epoch 1/50
273/273 - 7s - loss: 3.3349 - accuracy1000: 0.3636 - val_loss: 3.4927 - val_accuracy1000: 0.3145 - 7s/epoch - 26ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3097 - accuracy1000: 0.3716 - val_loss: 3.6222 - val_accuracy1000: 0.3191 - 5s/epoch - 19ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2689 - accuracy1000: 0.3933 - val_loss: 3.6410 - val_accuracy1000: 0.3177 - 5s/epoch - 19ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2384 - accuracy1000: 0.4094 - val_loss: 3.7115 - val_accuracy1000: 0.3231 - 5s/epoch - 19ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2190 - accuracy1000: 0.4158 - val_loss: 3.6110 - val_accuracy1000: 0.3206 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.1856 - accuracy1000: 0.4315 - val_loss: 3.6010 - val_accuracy1000: 0.3190 - 5s/epoch - 18ms/step
Epoch 7/50
273/273 - 5s - loss: 3.1687 - accuracy1000: 0.4370 - val_loss: 3.6781 - val_accuracy1000: 0.3200 - 5s/epoch - 19ms/step
Epoch 8/50
273/273 - 5s - loss: 3.1486 - accuracy1000: 0.4405 - val_loss: 3.7057 - val_accuracy1000: 0.3191 - 5s/epoch - 19ms/step
Epoch 9/50
273/273 - 5s - loss: 3.1426 - accuracy1000: 0.4495 - val_loss: 3.7248 - val_accuracy1000: 0.3200 - 5s/epoch - 19ms/step
Epoch 10/50
273/273 - 5s - loss: 3.1217 - accuracy1000: 0.4550 - val_loss: 3.7580 - val_accuracy1000: 0.3148 - 5s/epoch - 19ms/step
Epoch 11/50
273/273 - 5s - loss: 3.1079 - accuracy1000: 0.4609 - val_loss: 3.9584 - val_accuracy1000: 0.3146 - 5s/epoch - 19ms/step
testing model: results/LILAK/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1426849
{'0': {'precision': 0.29734629081391856, 'recall': 0.34682898144556906, 'f1-score': 0.3201871155900783, 'support': 79927}, '1': {'precision': 0.33656228880378464, 'recall': 0.3431685773350874, 'f1-score': 0.33983332988688764, 'support': 95778}, '2': {'precision': 0.35655319889598924, 'recall': 0.29994247764472104, 'f1-score': 0.32580701963657843, 'support': 95615}, 'accuracy': 0.3290137107474569, 'macro avg': {'precision': 0.3301539261712308, 'recall': 0.32998001214179246, 'f1-score': 0.3286091550378481, 'support': 271320}, 'weighted avg': {'precision': 0.3320547471449689, 'recall': 0.3290137107474569, 'f1-score': 0.32910286908530867, 'support': 271320}}
[[27721 28812 23394]
 [34549 32868 28361]
 [30958 35978 28679]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.138689
{'0': {'precision': 0.35362081513828236, 'recall': 0.3206698840902529, 'f1-score': 0.33634023406234453, 'support': 24243}, '1': {'precision': 0.3289462618787318, 'recall': 0.34158588769539777, 'f1-score': 0.33514694542027246, 'support': 22902}, '2': {'precision': 0.3451031251307367, 'recall': 0.36623157520866634, 'f1-score': 0.35535356581299676, 'support': 22524}, 'accuracy': 0.34227561756304814, 'macro avg': {'precision': 0.34255673404925036, 'recall': 0.3428291156647723, 'f1-score': 0.3422802484318712, 'support': 69669}, 'weighted avg': {'precision': 0.34275588140189767, 'recall': 0.34227561756304814, 'f1-score': 0.3420949827722579, 'support': 69669}}
[[7774 8430 8039]
 [7464 7823 7615]
 [6746 7529 8249]]
Evaluating performance on  val set...
96/96 - 1s - 672ms/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1689653
{'0': {'precision': 0.31703821656050957, 'recall': 0.22573696145124716, 'f1-score': 0.2637086092715232, 'support': 8820}, '1': {'precision': 0.3067878787878788, 'recall': 0.3334211566328547, 'f1-score': 0.3195505334259201, 'support': 7591}, '2': {'precision': 0.30979841540467357, 'recall': 0.3818294190358467, 'f1-score': 0.3420630086927634, 'support': 8090}, 'accuracy': 0.3106403820252235, 'macro avg': {'precision': 0.3112081702510206, 'recall': 0.31366251237331616, 'f1-score': 0.3084407171300689, 'support': 24501}, 'weighted avg': {'precision': 0.311471900680229, 'recall': 0.3106403820252235, 'f1-score': 0.3068816690476083, 'support': 24501}}
[[1991 2958 3871]
 [2049 2531 3011]
 [2240 2761 3089]]
training model: results/LILAK/W5/deepOF_L1/h10
Epoch 1/50
273/273 - 7s - loss: 3.2966 - accuracy10: 0.3677 - val_loss: 3.5572 - val_accuracy10: 0.4478 - 7s/epoch - 25ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2821 - accuracy10: 0.3863 - val_loss: 3.5591 - val_accuracy10: 0.4503 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2638 - accuracy10: 0.3972 - val_loss: 3.5662 - val_accuracy10: 0.4497 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2530 - accuracy10: 0.4055 - val_loss: 3.5695 - val_accuracy10: 0.4522 - 5s/epoch - 18ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2469 - accuracy10: 0.4113 - val_loss: 3.5694 - val_accuracy10: 0.4525 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2395 - accuracy10: 0.4177 - val_loss: 3.5692 - val_accuracy10: 0.4528 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2341 - accuracy10: 0.4213 - val_loss: 3.5637 - val_accuracy10: 0.4534 - 5s/epoch - 18ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2279 - accuracy10: 0.4251 - val_loss: 3.5661 - val_accuracy10: 0.4544 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2245 - accuracy10: 0.4250 - val_loss: 3.5669 - val_accuracy10: 0.4529 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2193 - accuracy10: 0.4298 - val_loss: 3.5672 - val_accuracy10: 0.4552 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2157 - accuracy10: 0.4325 - val_loss: 3.5620 - val_accuracy10: 0.4539 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h10
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1490481
{'0': {'precision': 0.3630550621669627, 'recall': 0.0229261070483198, 'f1-score': 0.043128732091237104, 'support': 89156}, '1': {'precision': 0.36055880568980025, 'recall': 0.9488985695306948, 'f1-score': 0.5225580327013493, 'support': 97101}, '2': {'precision': 0.3862919132149901, 'recall': 0.04605092995367867, 'f1-score': 0.08229164478245342, 'support': 85058}, 'accuracy': 0.36157234211156775, 'macro avg': {'precision': 0.3699685936905843, 'recall': 0.33929186884423107, 'f1-score': 0.21599280319167993, 'support': 271315}, 'weighted avg': {'precision': 0.3694464930729361, 'recall': 0.36157234211156775, 'f1-score': 0.226989497423902, 'support': 271315}}
[[ 2044 84026  3086]
 [ 1825 92139  3137]
 [ 1761 79380  3917]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670992
{'0': {'precision': 0.33519553072625696, 'recall': 0.02622091117666339, 'f1-score': 0.04863714662073158, 'support': 18306}, '1': {'precision': 0.47428397318708104, 'recall': 0.9466642340205559, 'f1-score': 0.6319550169498407, 'support': 32886}, '2': {'precision': 0.33012326656394453, 'recall': 0.046384498809266074, 'f1-score': 0.08134016704631739, 'support': 18476}, 'accuracy': 0.46605328127691337, 'macro avg': {'precision': 0.37986759015909416, 'recall': 0.33975654800216176, 'f1-score': 0.25397744353896323, 'support': 69668}, 'weighted avg': {'precision': 0.3995055061253466, 'recall': 0.46605328127691337, 'f1-score': 0.33265868432852, 'support': 69668}}
[[  480 17199   627]
 [  642 31132  1112]
 [  310 17309   857]]
Evaluating performance on  val set...
96/96 - 1s - 665ms/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0813855
{'0': {'precision': 0.2720125786163522, 'recall': 0.02555391432791728, 'f1-score': 0.046718876586551446, 'support': 6770}, '1': {'precision': 0.45910371544285966, 'recall': 0.9280946871940909, 'f1-score': 0.6143197950107502, 'support': 11237}, '2': {'precision': 0.30983463881636203, 'recall': 0.05481983369263936, 'f1-score': 0.09315713724977104, 'support': 6494}, 'accuracy': 0.4472470511407698, 'macro avg': {'precision': 0.34698364429185796, 'recall': 0.3361561450715492, 'f1-score': 0.2513986029490242, 'support': 24501}, 'weighted avg': {'precision': 0.36784375136270253, 'recall': 0.4472470511407698, 'f1-score': 0.31934862986517965, 'support': 24501}}
[[  173  6313   284]
 [  299 10429   509]
 [  164  5974   356]]
training model: results/LILAK/W5/deepOF_L1/h20
Epoch 1/50
273/273 - 7s - loss: 3.3047 - accuracy20: 0.3614 - val_loss: 3.5324 - val_accuracy20: 0.3585 - 7s/epoch - 24ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2905 - accuracy20: 0.3679 - val_loss: 3.5422 - val_accuracy20: 0.3600 - 5s/epoch - 18ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2751 - accuracy20: 0.3775 - val_loss: 3.5567 - val_accuracy20: 0.3593 - 5s/epoch - 18ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2662 - accuracy20: 0.3813 - val_loss: 3.5380 - val_accuracy20: 0.3612 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2589 - accuracy20: 0.3871 - val_loss: 3.5501 - val_accuracy20: 0.3598 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2522 - accuracy20: 0.3927 - val_loss: 3.5281 - val_accuracy20: 0.3626 - 5s/epoch - 18ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2479 - accuracy20: 0.3963 - val_loss: 3.5316 - val_accuracy20: 0.3634 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2447 - accuracy20: 0.3981 - val_loss: 3.5386 - val_accuracy20: 0.3641 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 4s - loss: 3.2396 - accuracy20: 0.4005 - val_loss: 3.5249 - val_accuracy20: 0.3639 - 4s/epoch - 16ms/step
Epoch 10/50
273/273 - 4s - loss: 3.2344 - accuracy20: 0.4039 - val_loss: 3.5343 - val_accuracy20: 0.3649 - 4s/epoch - 16ms/step
Epoch 11/50
273/273 - 4s - loss: 3.2295 - accuracy20: 0.4067 - val_loss: 3.5499 - val_accuracy20: 0.3632 - 4s/epoch - 16ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2275 - accuracy20: 0.4097 - val_loss: 3.5506 - val_accuracy20: 0.3666 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2216 - accuracy20: 0.4126 - val_loss: 3.5389 - val_accuracy20: 0.3661 - 5s/epoch - 17ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2199 - accuracy20: 0.4146 - val_loss: 3.5437 - val_accuracy20: 0.3663 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2163 - accuracy20: 0.4183 - val_loss: 3.5587 - val_accuracy20: 0.3659 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2129 - accuracy20: 0.4161 - val_loss: 3.5641 - val_accuracy20: 0.3658 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2105 - accuracy20: 0.4188 - val_loss: 3.5567 - val_accuracy20: 0.3666 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2068 - accuracy20: 0.4213 - val_loss: 3.5716 - val_accuracy20: 0.3670 - 5s/epoch - 17ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2031 - accuracy20: 0.4212 - val_loss: 3.5942 - val_accuracy20: 0.3672 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h20
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.2246435
{'0': {'precision': 0.43314606741573036, 'recall': 0.022503940378665526, 'f1-score': 0.042785002127226655, 'support': 102782}, '1': {'precision': 0.27066749053091094, 'recall': 0.9402606453411387, 'f1-score': 0.42033541344083847, 'support': 71745}, '2': {'precision': 0.44125903362599295, 'recall': 0.0763317766665289, 'f1-score': 0.13014947459284248, 'support': 96788}, 'accuracy': 0.28439268009509244, 'macro avg': {'precision': 0.38169086385754475, 'recall': 0.34636545412877773, 'f1-score': 0.19775663005363586, 'support': 271315}, 'weighted avg': {'precision': 0.3930753462059098, 'recall': 0.28439268009509244, 'f1-score': 0.173788399730371, 'support': 271315}}
[[ 2313 94253  6216]
 [ 1147 67459  3139]
 [ 1880 87520  7388]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.142445
{'0': {'precision': 0.4171388101983003, 'recall': 0.02682882390452765, 'f1-score': 0.05041513309937516, 'support': 21954}, '1': {'precision': 0.37386372465231915, 'recall': 0.9403947625561853, 'f1-score': 0.5350233488992662, 'support': 25585}, '2': {'precision': 0.40374263009484745, 'recall': 0.07117357313931945, 'f1-score': 0.12101421436803689, 'support': 22129}, 'accuracy': 0.37641384853878396, 'macro avg': {'precision': 0.3982483883151556, 'recall': 0.3461323865333441, 'f1-score': 0.23548423212222605, 'support': 69668}, 'weighted avg': {'precision': 0.3969912943631502, 'recall': 0.37641384853878396, 'f1-score': 0.2508082586467488, 'support': 69668}}
[[  589 20104  1261]
 [  460 24060  1065]
 [  363 20191  1575]]
Evaluating performance on  val set...
96/96 - 1s - 714ms/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1496778
{'0': {'precision': 0.376, 'recall': 0.02933832709113608, 'f1-score': 0.054429646786334676, 'support': 8010}, '1': {'precision': 0.3645861357725764, 'recall': 0.9202127659574468, 'f1-score': 0.5222557646605434, 'support': 8836}, '2': {'precision': 0.38373570520965694, 'recall': 0.07890267798824298, 'f1-score': 0.13089175425289848, 'support': 7655}, 'accuracy': 0.36610750581608914, 'macro avg': {'precision': 0.3747739469940778, 'recall': 0.3428179236789419, 'f1-score': 0.2358590552332588, 'support': 24501}, 'weighted avg': {'precision': 0.3743006374868948, 'recall': 0.36610750581608914, 'f1-score': 0.24703521432207012, 'support': 24501}}
[[ 235 7276  499]
 [ 234 8131  471]
 [ 156 6895  604]]
training model: results/LILAK/W5/deepOF_L1/h30
Epoch 1/50
273/273 - 7s - loss: 3.3068 - accuracy30: 0.3602 - val_loss: 3.5332 - val_accuracy30: 0.3279 - 7s/epoch - 25ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2944 - accuracy30: 0.3638 - val_loss: 3.5506 - val_accuracy30: 0.3286 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2786 - accuracy30: 0.3717 - val_loss: 3.5579 - val_accuracy30: 0.3289 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2707 - accuracy30: 0.3769 - val_loss: 3.5559 - val_accuracy30: 0.3293 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2650 - accuracy30: 0.3809 - val_loss: 3.5701 - val_accuracy30: 0.3286 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2616 - accuracy30: 0.3822 - val_loss: 3.5511 - val_accuracy30: 0.3282 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2562 - accuracy30: 0.3863 - val_loss: 3.5646 - val_accuracy30: 0.3308 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2516 - accuracy30: 0.3889 - val_loss: 3.5646 - val_accuracy30: 0.3313 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2473 - accuracy30: 0.3911 - val_loss: 3.5639 - val_accuracy30: 0.3317 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2425 - accuracy30: 0.3926 - val_loss: 3.5814 - val_accuracy30: 0.3316 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2385 - accuracy30: 0.3954 - val_loss: 3.5837 - val_accuracy30: 0.3315 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h30
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.2494415
{'0': {'precision': 0.41773934030571197, 'recall': 0.01957679438239314, 'f1-score': 0.03740084813671028, 'support': 106095}, '1': {'precision': 0.2397746179442938, 'recall': 0.9609637884728182, 'f1-score': 0.38378838222874295, 'support': 64786}, '2': {'precision': 0.4215085884988798, 'recall': 0.02809805444371428, 'f1-score': 0.05268414714969803, 'support': 100434}, 'accuracy': 0.24752040985570278, 'macro avg': {'precision': 0.35967418224962855, 'recall': 0.33621287909964187, 'f1-score': 0.15795779250505043, 'support': 271315}, 'weighted avg': {'precision': 0.37663928380358636, 'recall': 0.24752040985570278, 'f1-score': 0.12577054991050401, 'support': 271315}}
[[  2077 101594   2424]
 [  1080  62257   1449]
 [  1815  95797   2822]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1835324
{'0': {'precision': 0.38675388389206866, 'recall': 0.020274324903557652, 'f1-score': 0.03852889667250438, 'support': 23330}, '1': {'precision': 0.3287028684827711, 'recall': 0.9563467763100341, 'f1-score': 0.48924791335675444, 'support': 22862}, '2': {'precision': 0.3846552617936755, 'recall': 0.031606747316408244, 'f1-score': 0.05841369809092698, 'support': 23476}, 'accuracy': 0.33127117184360105, 'macro avg': {'precision': 0.36670400472283843, 'recall': 0.33607594951, 'f1-score': 0.19539683604006194, 'support': 69668}, 'weighted avg': {'precision': 0.366996899815172, 'recall': 0.33127117184360105, 'f1-score': 0.1931358002370421, 'support': 69668}}
[[  473 22273   584]
 [  395 21864   603]
 [  355 22379   742]]
Evaluating performance on  val set...
96/96 - 1s - 800ms/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1831899
{'0': {'precision': 0.35374149659863946, 'recall': 0.02479732951835956, 'f1-score': 0.0463458110516934, 'support': 8388}, '1': {'precision': 0.3256771397616468, 'recall': 0.9385537654552267, 'f1-score': 0.4835596164982949, 'support': 8007}, '2': {'precision': 0.383054892601432, 'recall': 0.03960029607698001, 'f1-score': 0.07177996422182469, 'support': 8106}, 'accuracy': 0.3283131300763234, 'macro avg': {'precision': 0.3541578429872394, 'recall': 0.3343171303501888, 'f1-score': 0.20056179725727097, 'support': 24501}, 'weighted avg': {'precision': 0.3542681315443493, 'recall': 0.3283131300763234, 'f1-score': 0.1976433166966884, 'support': 24501}}
[[ 208 7937  243]
 [ 218 7515  274]
 [ 162 7623  321]]
training model: results/LILAK/W5/deepOF_L1/h50
Epoch 1/50
273/273 - 7s - loss: 3.3129 - accuracy50: 0.3580 - val_loss: 3.4811 - val_accuracy50: 0.3314 - 7s/epoch - 24ms/step
Epoch 2/50
273/273 - 5s - loss: 3.2965 - accuracy50: 0.3664 - val_loss: 3.5110 - val_accuracy50: 0.3316 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2864 - accuracy50: 0.3714 - val_loss: 3.5036 - val_accuracy50: 0.3331 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2787 - accuracy50: 0.3738 - val_loss: 3.5066 - val_accuracy50: 0.3308 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2739 - accuracy50: 0.3784 - val_loss: 3.5146 - val_accuracy50: 0.3311 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2700 - accuracy50: 0.3818 - val_loss: 3.4963 - val_accuracy50: 0.3322 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2646 - accuracy50: 0.3852 - val_loss: 3.5149 - val_accuracy50: 0.3316 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2631 - accuracy50: 0.3872 - val_loss: 3.5053 - val_accuracy50: 0.3327 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2590 - accuracy50: 0.3875 - val_loss: 3.5160 - val_accuracy50: 0.3320 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2530 - accuracy50: 0.3883 - val_loss: 3.5136 - val_accuracy50: 0.3320 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2506 - accuracy50: 0.3932 - val_loss: 3.5151 - val_accuracy50: 0.3337 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h50
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.2108599
{'0': {'precision': 0.42158516020236086, 'recall': 0.02211106634302617, 'f1-score': 0.042018376036453274, 'support': 101759}, '1': {'precision': 0.2599816952372861, 'recall': 0.957665936442004, 'f1-score': 0.40894525994162434, 'support': 70298}, '2': {'precision': 0.4036136007966994, 'recall': 0.028582079026375707, 'f1-score': 0.053383762830825965, 'support': 99258}, 'accuracy': 0.2668816689088329, 'macro avg': {'precision': 0.36172681874544876, 'recall': 0.3361196939371353, 'f1-score': 0.16811579960296785, 'support': 271315}, 'weighted avg': {'precision': 0.3731388103005789, 'recall': 0.2668816689088329, 'f1-score': 0.14124743321059244, 'support': 271315}}
[[ 2250 97064  2445]
 [ 1229 67322  1747]
 [ 1858 94563  2837]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1637771
{'0': {'precision': 0.39921259842519685, 'recall': 0.021685201026518393, 'f1-score': 0.04113590263691684, 'support': 23380}, '1': {'precision': 0.33056195683279865, 'recall': 0.954590926884433, 'f1-score': 0.4910722276917569, 'support': 22991}, '2': {'precision': 0.39650872817955113, 'recall': 0.03412456539468601, 'f1-score': 0.06284088214370405, 'support': 23297}, 'accuracy': 0.33371131652982716, 'macro avg': {'precision': 0.3754277611458489, 'recall': 0.3368002311018792, 'f1-score': 0.19834967082412594, 'support': 69668}, 'weighted avg': {'precision': 0.37565315985994974, 'recall': 0.33371131652982716, 'f1-score': 0.1968766581761235, 'support': 69668}}
[[  507 22289   584]
 [  418 21947   626]
 [  345 22157   795]]
Evaluating performance on  val set...
96/96 - 1s - 664ms/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1626076
{'0': {'precision': 0.3969594594594595, 'recall': 0.028313253012048192, 'f1-score': 0.05285650022492128, 'support': 8300}, '1': {'precision': 0.3280048651231484, 'recall': 0.9398805078416729, 'f1-score': 0.486298502656577, 'support': 8034}, '2': {'precision': 0.40202702702702703, 'recall': 0.04371250153054977, 'f1-score': 0.07885146327995582, 'support': 8167}, 'accuracy': 0.332353781478307, 'macro avg': {'precision': 0.37566378386987825, 'recall': 0.33730208746142365, 'f1-score': 0.20600215538715136, 'support': 24501}, 'weighted avg': {'precision': 0.37603809353261575, 'recall': 0.332353781478307, 'f1-score': 0.2036492805525156, 'support': 24501}}
[[ 235 7812  253]
 [ 205 7551  278]
 [ 152 7658  357]]
training model: results/LILAK/W5/deepOF_L1/h100
Epoch 1/50
273/273 - 7s - loss: 3.3282 - accuracy100: 0.3463 - val_loss: 3.3331 - val_accuracy100: 0.3223 - 7s/epoch - 24ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3057 - accuracy100: 0.3598 - val_loss: 3.3314 - val_accuracy100: 0.3219 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2939 - accuracy100: 0.3675 - val_loss: 3.3314 - val_accuracy100: 0.3186 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2867 - accuracy100: 0.3711 - val_loss: 3.3234 - val_accuracy100: 0.3232 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2851 - accuracy100: 0.3713 - val_loss: 3.3170 - val_accuracy100: 0.3237 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2792 - accuracy100: 0.3726 - val_loss: 3.3138 - val_accuracy100: 0.3268 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2771 - accuracy100: 0.3748 - val_loss: 3.3114 - val_accuracy100: 0.3288 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2735 - accuracy100: 0.3766 - val_loss: 3.3054 - val_accuracy100: 0.3331 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2698 - accuracy100: 0.3784 - val_loss: 3.3074 - val_accuracy100: 0.3299 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2688 - accuracy100: 0.3787 - val_loss: 3.3104 - val_accuracy100: 0.3326 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2650 - accuracy100: 0.3830 - val_loss: 3.3095 - val_accuracy100: 0.3341 - 5s/epoch - 16ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2638 - accuracy100: 0.3845 - val_loss: 3.3097 - val_accuracy100: 0.3313 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2602 - accuracy100: 0.3855 - val_loss: 3.3115 - val_accuracy100: 0.3333 - 5s/epoch - 17ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2569 - accuracy100: 0.3875 - val_loss: 3.3111 - val_accuracy100: 0.3375 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2539 - accuracy100: 0.3893 - val_loss: 3.3085 - val_accuracy100: 0.3387 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2510 - accuracy100: 0.3911 - val_loss: 3.3139 - val_accuracy100: 0.3350 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2509 - accuracy100: 0.3894 - val_loss: 3.3160 - val_accuracy100: 0.3369 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2482 - accuracy100: 0.3941 - val_loss: 3.3122 - val_accuracy100: 0.3432 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h100
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1136898
{'0': {'precision': 0.42037052655252877, 'recall': 0.1498807208868753, 'f1-score': 0.22097430857784645, 'support': 99766}, '1': {'precision': 0.2659542346927772, 'recall': 0.6927517098998638, 'f1-score': 0.38435195249950327, 'support': 71203}, '2': {'precision': 0.39844060784469726, 'recall': 0.19962928268192057, 'f1-score': 0.2659903599739746, 'support': 100346}, 'accuracy': 0.3107494978161915, 'macro avg': {'precision': 0.3615884563633344, 'recall': 0.3474205711562199, 'f1-score': 0.2904388736837748, 'support': 271315}, 'weighted avg': {'precision': 0.37173523970165084, 'recall': 0.3107494978161915, 'f1-score': 0.28049980135763963, 'support': 271315}}
[[14953 68645 16168]
 [ 7801 49326 14076]
 [12817 67497 20032]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967262
{'0': {'precision': 0.40579896907216495, 'recall': 0.13313321777364392, 'f1-score': 0.20049024289306971, 'support': 23653}, '1': {'precision': 0.332533311263759, 'recall': 0.6991777961456476, 'f1-score': 0.4507073851287876, 'support': 22987}, '2': {'precision': 0.3898055391868002, 'recall': 0.22980719124544033, 'f1-score': 0.28914872691509125, 'support': 23028}, 'accuracy': 0.35185450996153184, 'macro avg': {'precision': 0.3760459398409081, 'recall': 0.3540394017215773, 'f1-score': 0.3134487849789829, 'support': 69668}, 'weighted avg': {'precision': 0.3763384652620655, 'recall': 0.35185450996153184, 'f1-score': 0.3123546428849104, 'support': 69668}}
[[ 3149 16628  3876]
 [ 2507 16072  4408]
 [ 2104 15632  5292]]
Evaluating performance on  val set...
96/96 - 1s - 656ms/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032684
{'0': {'precision': 0.4183770129460057, 'recall': 0.15106601299737774, 'f1-score': 0.22198023119450494, 'support': 8771}, '1': {'precision': 0.29442987005063753, 'recall': 0.6629120879120879, 'f1-score': 0.4077563263064509, 'support': 7280}, '2': {'precision': 0.3977341695326725, 'recall': 0.23266272189349113, 'f1-score': 0.29358620174718136, 'support': 8450}, 'accuracy': 0.3312926003020285, 'macro avg': {'precision': 0.3701803508431052, 'recall': 0.3488802742676523, 'f1-score': 0.3077742530827124, 'support': 24501}, 'weighted avg': {'precision': 0.37442912399776085, 'recall': 0.3312926003020285, 'f1-score': 0.30187576295178353, 'support': 24501}}
[[1325 5940 1506]
 [ 983 4826 1471]
 [ 859 5625 1966]]
training model: results/LILAK/W5/deepOF_L1/h200
Epoch 1/50
273/273 - 7s - loss: 3.3322 - accuracy200: 0.3415 - val_loss: 3.3201 - val_accuracy200: 0.3242 - 7s/epoch - 25ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3104 - accuracy200: 0.3479 - val_loss: 3.3200 - val_accuracy200: 0.3224 - 5s/epoch - 18ms/step
Epoch 3/50
273/273 - 5s - loss: 3.2991 - accuracy200: 0.3559 - val_loss: 3.3211 - val_accuracy200: 0.3175 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2939 - accuracy200: 0.3589 - val_loss: 3.3167 - val_accuracy200: 0.3168 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2911 - accuracy200: 0.3569 - val_loss: 3.3170 - val_accuracy200: 0.3162 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2882 - accuracy200: 0.3605 - val_loss: 3.3137 - val_accuracy200: 0.3164 - 5s/epoch - 18ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2852 - accuracy200: 0.3610 - val_loss: 3.3154 - val_accuracy200: 0.3167 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2812 - accuracy200: 0.3645 - val_loss: 3.3104 - val_accuracy200: 0.3185 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2821 - accuracy200: 0.3662 - val_loss: 3.3077 - val_accuracy200: 0.3237 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2788 - accuracy200: 0.3689 - val_loss: 3.3055 - val_accuracy200: 0.3211 - 5s/epoch - 18ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2758 - accuracy200: 0.3706 - val_loss: 3.3082 - val_accuracy200: 0.3233 - 5s/epoch - 17ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2756 - accuracy200: 0.3693 - val_loss: 3.3073 - val_accuracy200: 0.3260 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2724 - accuracy200: 0.3747 - val_loss: 3.3142 - val_accuracy200: 0.3209 - 5s/epoch - 17ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2708 - accuracy200: 0.3764 - val_loss: 3.3092 - val_accuracy200: 0.3308 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2692 - accuracy200: 0.3772 - val_loss: 3.3094 - val_accuracy200: 0.3287 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2666 - accuracy200: 0.3769 - val_loss: 3.3099 - val_accuracy200: 0.3248 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2672 - accuracy200: 0.3777 - val_loss: 3.3083 - val_accuracy200: 0.3311 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2636 - accuracy200: 0.3818 - val_loss: 3.3075 - val_accuracy200: 0.3268 - 5s/epoch - 17ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2624 - accuracy200: 0.3823 - val_loss: 3.3072 - val_accuracy200: 0.3353 - 5s/epoch - 17ms/step
Epoch 20/50
273/273 - 5s - loss: 3.2597 - accuracy200: 0.3831 - val_loss: 3.3090 - val_accuracy200: 0.3299 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h200
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1117407
{'0': {'precision': 0.3673810651877038, 'recall': 0.14464573754841825, 'f1-score': 0.20756766970570173, 'support': 91133}, '1': {'precision': 0.3020748872117923, 'recall': 0.7200753305001797, 'f1-score': 0.42560608113303583, 'support': 80711}, '2': {'precision': 0.37599330823923044, 'recall': 0.1626805802696263, 'f1-score': 0.22710144622444894, 'support': 99471}, 'accuracy': 0.3224370197003483, 'macro avg': {'precision': 0.34848308687957547, 'recall': 0.3424672161060747, 'f1-score': 0.2867583990210622, 'support': 271315}, 'weighted avg': {'precision': 0.35111119989446393, 'recall': 0.3224370197003483, 'f1-score': 0.2795914889151368, 'support': 271315}}
[[13182 64567 13384]
 [ 9121 58118 13472]
 [13578 69711 16182]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027117
{'0': {'precision': 0.4191538684439293, 'recall': 0.11883831744988498, 'f1-score': 0.18517570248991871, 'support': 24344}, '1': {'precision': 0.32207167916884727, 'recall': 0.7507341978041838, 'f1-score': 0.45076230264228745, 'support': 22133}, '2': {'precision': 0.3807606263982103, 'recall': 0.18347634858350223, 'f1-score': 0.24762846999941804, 'support': 23191}, 'accuracy': 0.34110351954986506, 'macro avg': {'precision': 0.3739953913369956, 'recall': 0.351016287945857, 'f1-score': 0.294522158377208, 'support': 69668}, 'weighted avg': {'precision': 0.3755312903376587, 'recall': 0.34110351954986506, 'f1-score': 0.2903397713950857, 'support': 69668}}
[[ 2893 18045  3406]
 [ 2003 16616  3514]
 [ 2006 16930  4255]]
Evaluating performance on  val set...
96/96 - 1s - 640ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076233
{'0': {'precision': 0.4087736789631107, 'recall': 0.13687959047407078, 'f1-score': 0.20508545227177993, 'support': 8986}, '1': {'precision': 0.2845118809046665, 'recall': 0.707532393564004, 'f1-score': 0.4058314276380268, 'support': 7023}, '2': {'precision': 0.402036255276881, 'recall': 0.19065002355157795, 'f1-score': 0.25864685677769783, 'support': 8492}, 'accuracy': 0.31908901677482554, 'macro avg': {'precision': 0.36510727171488605, 'recall': 0.34502066919655094, 'f1-score': 0.2898545788958349, 'support': 24501}, 'weighted avg': {'precision': 0.3708199297403069, 'recall': 0.31908901677482554, 'f1-score': 0.28119183291181127, 'support': 24501}}
[[1230 6480 1276]
 [ 922 4969 1132]
 [ 857 6016 1619]]
training model: results/LILAK/W5/deepOF_L1/h300
Epoch 1/50
273/273 - 7s - loss: 3.3307 - accuracy300: 0.3487 - val_loss: 3.2900 - val_accuracy300: 0.3700 - 7s/epoch - 24ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3105 - accuracy300: 0.3532 - val_loss: 3.2799 - val_accuracy300: 0.3697 - 5s/epoch - 18ms/step
Epoch 3/50
273/273 - 5s - loss: 3.3007 - accuracy300: 0.3554 - val_loss: 3.2823 - val_accuracy300: 0.3730 - 5s/epoch - 18ms/step
Epoch 4/50
273/273 - 5s - loss: 3.2944 - accuracy300: 0.3600 - val_loss: 3.2830 - val_accuracy300: 0.3645 - 5s/epoch - 18ms/step
Epoch 5/50
273/273 - 5s - loss: 3.2909 - accuracy300: 0.3631 - val_loss: 3.2759 - val_accuracy300: 0.3752 - 5s/epoch - 19ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2881 - accuracy300: 0.3642 - val_loss: 3.2764 - val_accuracy300: 0.3776 - 5s/epoch - 18ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2854 - accuracy300: 0.3658 - val_loss: 3.2759 - val_accuracy300: 0.3763 - 5s/epoch - 18ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2839 - accuracy300: 0.3669 - val_loss: 3.2751 - val_accuracy300: 0.3770 - 5s/epoch - 18ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2829 - accuracy300: 0.3693 - val_loss: 3.2784 - val_accuracy300: 0.3763 - 5s/epoch - 18ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2811 - accuracy300: 0.3702 - val_loss: 3.2764 - val_accuracy300: 0.3794 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 4s - loss: 3.2789 - accuracy300: 0.3714 - val_loss: 3.2720 - val_accuracy300: 0.3830 - 4s/epoch - 16ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2773 - accuracy300: 0.3707 - val_loss: 3.2734 - val_accuracy300: 0.3819 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 4s - loss: 3.2750 - accuracy300: 0.3740 - val_loss: 3.2763 - val_accuracy300: 0.3839 - 4s/epoch - 16ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2740 - accuracy300: 0.3746 - val_loss: 3.2763 - val_accuracy300: 0.3835 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2715 - accuracy300: 0.3766 - val_loss: 3.2758 - val_accuracy300: 0.3843 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2682 - accuracy300: 0.3805 - val_loss: 3.2771 - val_accuracy300: 0.3835 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2694 - accuracy300: 0.3785 - val_loss: 3.2758 - val_accuracy300: 0.3881 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2670 - accuracy300: 0.3808 - val_loss: 3.2774 - val_accuracy300: 0.3841 - 5s/epoch - 18ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2648 - accuracy300: 0.3817 - val_loss: 3.2739 - val_accuracy300: 0.3875 - 5s/epoch - 17ms/step
Epoch 20/50
273/273 - 5s - loss: 3.2633 - accuracy300: 0.3829 - val_loss: 3.2760 - val_accuracy300: 0.3879 - 5s/epoch - 17ms/step
Epoch 21/50
273/273 - 5s - loss: 3.2623 - accuracy300: 0.3832 - val_loss: 3.2781 - val_accuracy300: 0.3855 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h300
Evaluating performance on  test set...
1060/1060 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1076958
{'0': {'precision': 0.34144049241954805, 'recall': 0.37149695485088885, 'f1-score': 0.35583515407217664, 'support': 88994}, '1': {'precision': 0.2642089093701997, 'recall': 0.008318220287752387, 'f1-score': 0.016128654148205454, 'support': 82710}, '2': {'precision': 0.3563645037612795, 'recall': 0.6149220467619038, 'f1-score': 0.4512291247688715, 'support': 99611}, 'accuracy': 0.350153880176179, 'macro avg': {'precision': 0.3206713018503424, 'recall': 0.3315790739668483, 'f1-score': 0.27439764432975117, 'support': 271315}, 'weighted avg': {'precision': 0.3233757759820109, 'recall': 0.350153880176179, 'f1-score': 0.2872991874148109, 'support': 271315}}
[[33061   843 55090]
 [26482   688 55540]
 [37285  1073 61253]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1064972
{'0': {'precision': 0.37961589350868047, 'recall': 0.3928630705394191, 'f1-score': 0.3861258946595706, 'support': 24100}, '1': {'precision': 0.3528591352859135, 'recall': 0.011082880672857894, 'f1-score': 0.02149076236992992, 'support': 22828}, '2': {'precision': 0.3418995682799364, 'recall': 0.6616974494283201, 'f1-score': 0.45084644194756557, 'support': 22740}, 'accuracy': 0.355514726990871, 'macro avg': {'precision': 0.35812486569151014, 'recall': 0.35521446688019903, 'f1-score': 0.2861543663256887, 'support': 69668}, 'weighted avg': {'precision': 0.3585377441085116, 'recall': 0.355514726990871, 'f1-score': 0.28777162075219687, 'support': 69668}}
[[ 9468   244 14388]
 [ 8000   253 14575]
 [ 7473   220 15047]]
Evaluating performance on  val set...
96/96 - 1s - 775ms/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092541
{'0': {'precision': 0.4000816076711211, 'recall': 0.4218565128536087, 'f1-score': 0.41068062827225127, 'support': 9297}, '1': {'precision': 0.29491525423728815, 'recall': 0.012942576614102946, 'f1-score': 0.024796921761436514, 'support': 6722}, '2': {'precision': 0.37186697215857806, 'recall': 0.6314548455552935, 'f1-score': 0.46807952807515835, 'support': 8482}, 'accuracy': 0.3822292967633974, 'macro avg': {'precision': 0.3556212780223291, 'recall': 0.3554179783410017, 'f1-score': 0.3011856927029487, 'support': 24501}, 'weighted avg': {'precision': 0.36146094866946343, 'recall': 0.3822292967633974, 'f1-score': 0.32468198303175333, 'support': 24501}}
[[3922  105 5270]
 [2858   87 3777]
 [3023  103 5356]]
training model: results/LILAK/W5/deepOF_L1/h500
Epoch 1/50
273/273 - 7s - loss: 3.3339 - accuracy500: 0.3416 - val_loss: 3.3439 - val_accuracy500: 0.3244 - 7s/epoch - 24ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3189 - accuracy500: 0.3404 - val_loss: 3.3427 - val_accuracy500: 0.3212 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.3098 - accuracy500: 0.3409 - val_loss: 3.3409 - val_accuracy500: 0.3228 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.3043 - accuracy500: 0.3448 - val_loss: 3.3388 - val_accuracy500: 0.3222 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.3009 - accuracy500: 0.3471 - val_loss: 3.3317 - val_accuracy500: 0.3231 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2975 - accuracy500: 0.3486 - val_loss: 3.3309 - val_accuracy500: 0.3188 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2962 - accuracy500: 0.3475 - val_loss: 3.3266 - val_accuracy500: 0.3240 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2941 - accuracy500: 0.3490 - val_loss: 3.3273 - val_accuracy500: 0.3240 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2935 - accuracy500: 0.3489 - val_loss: 3.3226 - val_accuracy500: 0.3261 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2908 - accuracy500: 0.3516 - val_loss: 3.3195 - val_accuracy500: 0.3250 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2890 - accuracy500: 0.3532 - val_loss: 3.3211 - val_accuracy500: 0.3281 - 5s/epoch - 17ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2887 - accuracy500: 0.3551 - val_loss: 3.3190 - val_accuracy500: 0.3262 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2865 - accuracy500: 0.3586 - val_loss: 3.3204 - val_accuracy500: 0.3256 - 5s/epoch - 17ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2840 - accuracy500: 0.3595 - val_loss: 3.3207 - val_accuracy500: 0.3268 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2831 - accuracy500: 0.3607 - val_loss: 3.3194 - val_accuracy500: 0.3302 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2819 - accuracy500: 0.3595 - val_loss: 3.3172 - val_accuracy500: 0.3318 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2801 - accuracy500: 0.3625 - val_loss: 3.3190 - val_accuracy500: 0.3278 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2792 - accuracy500: 0.3642 - val_loss: 3.3208 - val_accuracy500: 0.3286 - 5s/epoch - 17ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2776 - accuracy500: 0.3633 - val_loss: 3.3197 - val_accuracy500: 0.3282 - 5s/epoch - 17ms/step
Epoch 20/50
273/273 - 5s - loss: 3.2767 - accuracy500: 0.3642 - val_loss: 3.3199 - val_accuracy500: 0.3259 - 5s/epoch - 18ms/step
Epoch 21/50
273/273 - 5s - loss: 3.2769 - accuracy500: 0.3669 - val_loss: 3.3209 - val_accuracy500: 0.3290 - 5s/epoch - 17ms/step
Epoch 22/50
273/273 - 5s - loss: 3.2730 - accuracy500: 0.3696 - val_loss: 3.3205 - val_accuracy500: 0.3350 - 5s/epoch - 17ms/step
Epoch 23/50
273/273 - 4s - loss: 3.2727 - accuracy500: 0.3702 - val_loss: 3.3222 - val_accuracy500: 0.3331 - 4s/epoch - 16ms/step
Epoch 24/50
273/273 - 5s - loss: 3.2723 - accuracy500: 0.3690 - val_loss: 3.3251 - val_accuracy500: 0.3272 - 5s/epoch - 17ms/step
Epoch 25/50
273/273 - 5s - loss: 3.2690 - accuracy500: 0.3721 - val_loss: 3.3222 - val_accuracy500: 0.3284 - 5s/epoch - 17ms/step
Epoch 26/50
273/273 - 5s - loss: 3.2675 - accuracy500: 0.3724 - val_loss: 3.3248 - val_accuracy500: 0.3304 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h500
Evaluating performance on  test set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029776
{'0': {'precision': 0.3203427632351215, 'recall': 0.09600140712945592, 'f1-score': 0.14773045102267293, 'support': 85280}, '1': {'precision': 0.323328729396002, 'recall': 0.43962395699795337, 'f1-score': 0.3726130282076088, 'support': 88926}, '2': {'precision': 0.3519668073722236, 'recall': 0.45250182784293935, 'f1-score': 0.39595235091639785, 'support': 97109}, 'accuracy': 0.3362254206365295, 'macro avg': {'precision': 0.331879433334449, 'recall': 0.3293757306567829, 'f1-score': 0.3054319433822265, 'support': 271315}, 'weighted avg': {'precision': 0.3326403115790476, 'recall': 0.3362254206365295, 'f1-score': 0.310281318226946, 'support': 271315}}
[[ 8187 38500 38593]
 [ 7520 39094 42312]
 [ 9850 43317 43942]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992533
{'0': {'precision': 0.38857963727778777, 'recall': 0.09099318812547305, 'f1-score': 0.14745664542945727, 'support': 23782}, '1': {'precision': 0.35003850300323425, 'recall': 0.4761186525892408, 'f1-score': 0.40345800862727, 'support': 23868}, '2': {'precision': 0.33520895239299486, 'recall': 0.4816059587610137, 'f1-score': 0.3952881532841273, 'support': 22018}, 'accuracy': 0.34638571510593097, 'macro avg': {'precision': 0.35794236422467235, 'recall': 0.3495725998252425, 'f1-score': 0.3154009357802849, 'support': 69668}, 'weighted avg': {'precision': 0.3585082195155667, 'recall': 0.34638571510593097, 'f1-score': 0.31348688422990395, 'support': 69668}}
[[ 2164 11286 10332]
 [ 1806 11364 10698]
 [ 1599  9815 10604]]
Evaluating performance on  val set...
96/96 - 1s - 639ms/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1053262
{'0': {'precision': 0.3847464848743076, 'recall': 0.1005008347245409, 'f1-score': 0.1593716907871514, 'support': 8985}, '1': {'precision': 0.3024136715997181, 'recall': 0.4656177946561779, 'f1-score': 0.366675567423231, 'support': 7373}, '2': {'precision': 0.3513238289205703, 'recall': 0.46604445536043226, 'f1-score': 0.40063341250989704, 'support': 8143}, 'accuracy': 0.3318640055507939, 'macro avg': {'precision': 0.3461613284648653, 'recall': 0.3440543615803837, 'f1-score': 0.3088935569067598, 'support': 24501}, 'weighted avg': {'precision': 0.3488622140402669, 'recall': 0.3318640055507939, 'f1-score': 0.30193916486682704, 'support': 24501}}
[[ 903 4278 3804]
 [ 737 3433 3203]
 [ 707 3641 3795]]
training model: results/LILAK/W5/deepOF_L1/h1000
Epoch 1/50
273/273 - 7s - loss: 3.3321 - accuracy1000: 0.3457 - val_loss: 3.3470 - val_accuracy1000: 0.3284 - 7s/epoch - 25ms/step
Epoch 2/50
273/273 - 5s - loss: 3.3183 - accuracy1000: 0.3464 - val_loss: 3.3475 - val_accuracy1000: 0.3279 - 5s/epoch - 17ms/step
Epoch 3/50
273/273 - 5s - loss: 3.3107 - accuracy1000: 0.3499 - val_loss: 3.3415 - val_accuracy1000: 0.3328 - 5s/epoch - 17ms/step
Epoch 4/50
273/273 - 5s - loss: 3.3044 - accuracy1000: 0.3522 - val_loss: 3.3364 - val_accuracy1000: 0.3313 - 5s/epoch - 17ms/step
Epoch 5/50
273/273 - 5s - loss: 3.3015 - accuracy1000: 0.3531 - val_loss: 3.3337 - val_accuracy1000: 0.3324 - 5s/epoch - 17ms/step
Epoch 6/50
273/273 - 5s - loss: 3.2989 - accuracy1000: 0.3538 - val_loss: 3.3326 - val_accuracy1000: 0.3329 - 5s/epoch - 17ms/step
Epoch 7/50
273/273 - 5s - loss: 3.2949 - accuracy1000: 0.3587 - val_loss: 3.3302 - val_accuracy1000: 0.3332 - 5s/epoch - 17ms/step
Epoch 8/50
273/273 - 5s - loss: 3.2940 - accuracy1000: 0.3589 - val_loss: 3.3289 - val_accuracy1000: 0.3328 - 5s/epoch - 17ms/step
Epoch 9/50
273/273 - 5s - loss: 3.2920 - accuracy1000: 0.3593 - val_loss: 3.3310 - val_accuracy1000: 0.3333 - 5s/epoch - 17ms/step
Epoch 10/50
273/273 - 5s - loss: 3.2915 - accuracy1000: 0.3616 - val_loss: 3.3272 - val_accuracy1000: 0.3320 - 5s/epoch - 17ms/step
Epoch 11/50
273/273 - 5s - loss: 3.2882 - accuracy1000: 0.3632 - val_loss: 3.3272 - val_accuracy1000: 0.3332 - 5s/epoch - 17ms/step
Epoch 12/50
273/273 - 5s - loss: 3.2887 - accuracy1000: 0.3633 - val_loss: 3.3262 - val_accuracy1000: 0.3320 - 5s/epoch - 17ms/step
Epoch 13/50
273/273 - 5s - loss: 3.2881 - accuracy1000: 0.3638 - val_loss: 3.3252 - val_accuracy1000: 0.3324 - 5s/epoch - 17ms/step
Epoch 14/50
273/273 - 5s - loss: 3.2860 - accuracy1000: 0.3651 - val_loss: 3.3267 - val_accuracy1000: 0.3331 - 5s/epoch - 17ms/step
Epoch 15/50
273/273 - 5s - loss: 3.2832 - accuracy1000: 0.3665 - val_loss: 3.3277 - val_accuracy1000: 0.3348 - 5s/epoch - 17ms/step
Epoch 16/50
273/273 - 5s - loss: 3.2829 - accuracy1000: 0.3672 - val_loss: 3.3269 - val_accuracy1000: 0.3313 - 5s/epoch - 17ms/step
Epoch 17/50
273/273 - 5s - loss: 3.2835 - accuracy1000: 0.3667 - val_loss: 3.3289 - val_accuracy1000: 0.3314 - 5s/epoch - 17ms/step
Epoch 18/50
273/273 - 5s - loss: 3.2810 - accuracy1000: 0.3680 - val_loss: 3.3279 - val_accuracy1000: 0.3324 - 5s/epoch - 18ms/step
Epoch 19/50
273/273 - 5s - loss: 3.2787 - accuracy1000: 0.3695 - val_loss: 3.3270 - val_accuracy1000: 0.3317 - 5s/epoch - 17ms/step
Epoch 20/50
273/273 - 4s - loss: 3.2783 - accuracy1000: 0.3716 - val_loss: 3.3264 - val_accuracy1000: 0.3323 - 4s/epoch - 16ms/step
Epoch 21/50
273/273 - 5s - loss: 3.2780 - accuracy1000: 0.3719 - val_loss: 3.3316 - val_accuracy1000: 0.3321 - 5s/epoch - 17ms/step
Epoch 22/50
273/273 - 5s - loss: 3.2753 - accuracy1000: 0.3724 - val_loss: 3.3275 - val_accuracy1000: 0.3322 - 5s/epoch - 17ms/step
Epoch 23/50
273/273 - 5s - loss: 3.2739 - accuracy1000: 0.3736 - val_loss: 3.3274 - val_accuracy1000: 0.3328 - 5s/epoch - 17ms/step
testing model: results/LILAK/W5/deepOF_L1/h1000
Evaluating performance on  test set...
1060/1060 - 6s - 6s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1028403
{'0': {'precision': 0.2830899670277909, 'recall': 0.022558930984435212, 'f1-score': 0.04178786228315158, 'support': 79924}, '1': {'precision': 0.34257409922505394, 'recall': 0.04477019774896114, 'f1-score': 0.0791910983886606, 'support': 95778}, '2': {'precision': 0.350660977938351, 'recall': 0.9257841506908057, 'f1-score': 0.5086570011665259, 'support': 95613}, 'accuracy': 0.34870169360337616, 'macro avg': {'precision': 0.32544168139706525, 'recall': 0.3310377598080673, 'f1-score': 0.2098786539461127, 'support': 271315}, 'weighted avg': {'precision': 0.32790112114673325, 'recall': 0.34870169360337616, 'f1-score': 0.21951915662282875, 'support': 271315}}
[[ 1803  3618 74503]
 [ 2081  4288 89409]
 [ 2485  4611 88517]]
Evaluating performance on  train set...
273/273 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1117603
{'0': {'precision': 0.3774885145482389, 'recall': 0.020320679279502082, 'f1-score': 0.038565338131184734, 'support': 24261}, '1': {'precision': 0.36236677692024993, 'recall': 0.04309063893016345, 'f1-score': 0.0770222239581299, 'support': 22882}, '2': {'precision': 0.32423332977864444, 'recall': 0.9448612652608213, 'f1-score': 0.4827938207472269, 'support': 22525}, 'accuracy': 0.326721019693403, 'macro avg': {'precision': 0.35469620708237776, 'recall': 0.33609086115682896, 'f1-score': 0.19946046094551384, 'support': 69668}, 'weighted avg': {'precision': 0.3553034563100412, 'recall': 0.326721019693403, 'f1-score': 0.19482383604153825, 'support': 69668}}
[[  493   918 22850]
 [  388   986 21508]
 [  425   817 21283]]
Evaluating performance on  val set...
96/96 - 1s - 750ms/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1126931
{'0': {'precision': 0.3895870736086176, 'recall': 0.024617129892229153, 'f1-score': 0.04630815194195476, 'support': 8815}, '1': {'precision': 0.3031390134529148, 'recall': 0.0445146845779007, 'f1-score': 0.07762976573265962, 'support': 7593}, '2': {'precision': 0.33107013009768277, 'recall': 0.9338934881996788, 'f1-score': 0.48884289502619493, 'support': 8093}, 'accuracy': 0.3311293416595241, 'macro avg': {'precision': 0.3412654057197384, 'recall': 0.3343417675566029, 'f1-score': 0.20426027090026977, 'support': 24501}, 'weighted avg': {'precision': 0.3434674154478794, 'recall': 0.3311293416595241, 'f1-score': 0.20218989918874378, 'support': 24501}}
[[ 217  402 8196]
 [ 180  338 7075]
 [ 160  375 7558]]
training model: results/LILAK/W5/deepLOB_L2/h10
Epoch 1/50
273/273 - 14s - loss: 3.3433 - accuracy10: 0.3549 - val_loss: 3.4991 - val_accuracy10: 0.4187 - 14s/epoch - 52ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3001 - accuracy10: 0.3714 - val_loss: 3.4557 - val_accuracy10: 0.4010 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2713 - accuracy10: 0.3814 - val_loss: 3.4396 - val_accuracy10: 0.4338 - 12s/epoch - 44ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2205 - accuracy10: 0.4030 - val_loss: 3.4200 - val_accuracy10: 0.4296 - 12s/epoch - 45ms/step
Epoch 5/50
273/273 - 12s - loss: 3.1844 - accuracy10: 0.4103 - val_loss: 3.3700 - val_accuracy10: 0.4111 - 12s/epoch - 45ms/step
Epoch 6/50
273/273 - 12s - loss: 3.1530 - accuracy10: 0.4219 - val_loss: 3.3909 - val_accuracy10: 0.4335 - 12s/epoch - 45ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1271 - accuracy10: 0.4316 - val_loss: 3.3548 - val_accuracy10: 0.4312 - 12s/epoch - 44ms/step
Epoch 8/50
273/273 - 12s - loss: 3.0937 - accuracy10: 0.4430 - val_loss: 3.3777 - val_accuracy10: 0.4457 - 12s/epoch - 43ms/step
Epoch 9/50
273/273 - 12s - loss: 3.0776 - accuracy10: 0.4530 - val_loss: 3.3389 - val_accuracy10: 0.4392 - 12s/epoch - 44ms/step
Epoch 10/50
273/273 - 12s - loss: 3.0615 - accuracy10: 0.4599 - val_loss: 3.3264 - val_accuracy10: 0.4241 - 12s/epoch - 44ms/step
Epoch 11/50
273/273 - 12s - loss: 3.0473 - accuracy10: 0.4646 - val_loss: 3.3215 - val_accuracy10: 0.4488 - 12s/epoch - 44ms/step
Epoch 12/50
273/273 - 12s - loss: 3.0331 - accuracy10: 0.4712 - val_loss: 3.3289 - val_accuracy10: 0.4521 - 12s/epoch - 43ms/step
Epoch 13/50
273/273 - 12s - loss: 3.0179 - accuracy10: 0.4743 - val_loss: 3.3101 - val_accuracy10: 0.4441 - 12s/epoch - 44ms/step
Epoch 14/50
273/273 - 12s - loss: 3.0010 - accuracy10: 0.4811 - val_loss: 3.3242 - val_accuracy10: 0.4204 - 12s/epoch - 44ms/step
Epoch 15/50
273/273 - 12s - loss: 2.9851 - accuracy10: 0.4863 - val_loss: 3.3083 - val_accuracy10: 0.4221 - 12s/epoch - 44ms/step
Epoch 16/50
273/273 - 12s - loss: 2.9668 - accuracy10: 0.4919 - val_loss: 3.3168 - val_accuracy10: 0.4235 - 12s/epoch - 44ms/step
Epoch 17/50
273/273 - 12s - loss: 2.9581 - accuracy10: 0.4961 - val_loss: 3.3034 - val_accuracy10: 0.4273 - 12s/epoch - 44ms/step
Epoch 18/50
273/273 - 12s - loss: 2.9416 - accuracy10: 0.4994 - val_loss: 3.2819 - val_accuracy10: 0.4270 - 12s/epoch - 44ms/step
Epoch 19/50
273/273 - 12s - loss: 2.9288 - accuracy10: 0.5022 - val_loss: 3.3229 - val_accuracy10: 0.4264 - 12s/epoch - 44ms/step
Epoch 20/50
273/273 - 12s - loss: 2.9176 - accuracy10: 0.5053 - val_loss: 3.3322 - val_accuracy10: 0.4229 - 12s/epoch - 43ms/step
Epoch 21/50
273/273 - 12s - loss: 2.9034 - accuracy10: 0.5095 - val_loss: 3.3588 - val_accuracy10: 0.4347 - 12s/epoch - 43ms/step
Epoch 22/50
273/273 - 12s - loss: 2.8951 - accuracy10: 0.5147 - val_loss: 3.3635 - val_accuracy10: 0.4230 - 12s/epoch - 43ms/step
Epoch 23/50
273/273 - 12s - loss: 2.8758 - accuracy10: 0.5188 - val_loss: 3.3411 - val_accuracy10: 0.4107 - 12s/epoch - 43ms/step
Epoch 24/50
273/273 - 12s - loss: 2.8657 - accuracy10: 0.5222 - val_loss: 3.3870 - val_accuracy10: 0.4098 - 12s/epoch - 43ms/step
Epoch 25/50
273/273 - 12s - loss: 2.8598 - accuracy10: 0.5213 - val_loss: 3.3363 - val_accuracy10: 0.4159 - 12s/epoch - 44ms/step
Epoch 26/50
273/273 - 12s - loss: 2.8487 - accuracy10: 0.5256 - val_loss: 3.3805 - val_accuracy10: 0.4133 - 12s/epoch - 43ms/step
Epoch 27/50
273/273 - 12s - loss: 2.8298 - accuracy10: 0.5296 - val_loss: 3.3582 - val_accuracy10: 0.4144 - 12s/epoch - 43ms/step
Epoch 28/50
273/273 - 12s - loss: 2.8134 - accuracy10: 0.5351 - val_loss: 3.3575 - val_accuracy10: 0.4184 - 12s/epoch - 44ms/step
testing model: results/LILAK/W5/deepLOB_L2/h10
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.138435
{'0': {'precision': 0.38265882539740703, 'recall': 0.7027972812310729, 'f1-score': 0.495518115354656, 'support': 89158}, '1': {'precision': 0.42003323591771247, 'recall': 0.3019474166606593, 'f1-score': 0.35133337726997665, 'support': 97103}, '2': {'precision': 0.443191145709217, 'recall': 0.1967810578539602, 'f1-score': 0.27254815755621775, 'support': 85059}, 'accuracy': 0.40070028011204484, 'macro avg': {'precision': 0.4152944023414455, 'recall': 0.4005085852485641, 'f1-score': 0.37313321672695016, 'support': 271320}, 'weighted avg': {'precision': 0.4150117150412058, 'recall': 0.4007002801120448, 'f1-score': 0.37401445818742185, 'support': 271320}}
[[62660 17778  8720]
 [55474 29320 12309]
 [45615 22706 16738]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0338658
{'0': {'precision': 0.3693988682065701, 'recall': 0.5677168799912482, 'f1-score': 0.44757325513702323, 'support': 18282}, '1': {'precision': 0.5855606543594774, 'recall': 0.5085488287191968, 'f1-score': 0.5443443997590244, 'support': 32870}, '2': {'precision': 0.4196545105566219, 'recall': 0.2951882054328455, 'f1-score': 0.34658550504089786, 'support': 18517}, 'accuracy': 0.4673671216753506, 'macro avg': {'precision': 0.4582046777075564, 'recall': 0.4571513047144302, 'f1-score': 0.4461677199789818, 'support': 69669}, 'weighted avg': {'precision': 0.48474172715735125, 'recall': 0.4673671216753506, 'f1-score': 0.4663890463094992, 'support': 69669}}
[[10379  5395  2508]
 [11103 16716  5051]
 [ 6615  6436  5466]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0717854
{'0': {'precision': 0.3629548180727709, 'recall': 0.5355457227138644, 'f1-score': 0.43267397521448997, 'support': 6780}, '1': {'precision': 0.5503011662181212, 'recall': 0.3809777304586993, 'f1-score': 0.45024640872391736, 'support': 11271}, '2': {'precision': 0.3839259037944428, 'recall': 0.3984496124031008, 'f1-score': 0.39105295191722456, 'support': 6450}, 'accuracy': 0.4283498632708869, 'macro avg': {'precision': 0.4323939626951116, 'recall': 0.4383243551918881, 'f1-score': 0.424657778618544, 'support': 24501}, 'weighted avg': {'precision': 0.4546590012837022, 'recall': 0.4283498632708869, 'f1-score': 0.4298007577057106, 'support': 24501}}
[[3631 1718 1431]
 [4284 4294 2693]
 [2089 1791 2570]]
training model: results/LILAK/W5/deepLOB_L2/h20
Epoch 1/50
273/273 - 14s - loss: 3.3437 - accuracy20: 0.3573 - val_loss: 3.4703 - val_accuracy20: 0.3586 - 14s/epoch - 52ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3035 - accuracy20: 0.3666 - val_loss: 3.4627 - val_accuracy20: 0.3570 - 12s/epoch - 44ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2723 - accuracy20: 0.3833 - val_loss: 3.4378 - val_accuracy20: 0.3607 - 12s/epoch - 44ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2351 - accuracy20: 0.4050 - val_loss: 3.3990 - val_accuracy20: 0.3721 - 12s/epoch - 44ms/step
Epoch 5/50
273/273 - 12s - loss: 3.1957 - accuracy20: 0.4270 - val_loss: 3.3472 - val_accuracy20: 0.3876 - 12s/epoch - 44ms/step
Epoch 6/50
273/273 - 12s - loss: 3.1619 - accuracy20: 0.4394 - val_loss: 3.3369 - val_accuracy20: 0.3932 - 12s/epoch - 44ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1432 - accuracy20: 0.4477 - val_loss: 3.3289 - val_accuracy20: 0.4018 - 12s/epoch - 44ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1199 - accuracy20: 0.4575 - val_loss: 3.3168 - val_accuracy20: 0.4085 - 12s/epoch - 43ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1015 - accuracy20: 0.4634 - val_loss: 3.3341 - val_accuracy20: 0.4115 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.0879 - accuracy20: 0.4695 - val_loss: 3.3304 - val_accuracy20: 0.4115 - 12s/epoch - 44ms/step
Epoch 11/50
273/273 - 12s - loss: 3.0698 - accuracy20: 0.4743 - val_loss: 3.3998 - val_accuracy20: 0.4060 - 12s/epoch - 44ms/step
Epoch 12/50
273/273 - 12s - loss: 3.0573 - accuracy20: 0.4799 - val_loss: 3.3496 - val_accuracy20: 0.4128 - 12s/epoch - 43ms/step
Epoch 13/50
273/273 - 12s - loss: 3.0397 - accuracy20: 0.4849 - val_loss: 3.3315 - val_accuracy20: 0.4061 - 12s/epoch - 44ms/step
Epoch 14/50
273/273 - 12s - loss: 3.0332 - accuracy20: 0.4863 - val_loss: 3.3696 - val_accuracy20: 0.3961 - 12s/epoch - 43ms/step
Epoch 15/50
273/273 - 12s - loss: 3.0227 - accuracy20: 0.4891 - val_loss: 3.3669 - val_accuracy20: 0.4011 - 12s/epoch - 43ms/step
Epoch 16/50
273/273 - 12s - loss: 3.0083 - accuracy20: 0.4940 - val_loss: 3.3511 - val_accuracy20: 0.4049 - 12s/epoch - 43ms/step
Epoch 17/50
273/273 - 12s - loss: 2.9962 - accuracy20: 0.4982 - val_loss: 3.4063 - val_accuracy20: 0.3965 - 12s/epoch - 44ms/step
Epoch 18/50
273/273 - 12s - loss: 2.9904 - accuracy20: 0.4988 - val_loss: 3.4367 - val_accuracy20: 0.3919 - 12s/epoch - 44ms/step
testing model: results/LILAK/W5/deepLOB_L2/h20
Evaluating performance on  test set...
1060/1060 - 16s - 16s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1172873
{'0': {'precision': 0.44846332113231246, 'recall': 0.40289925572797586, 'f1-score': 0.4244620170453089, 'support': 102785}, '1': {'precision': 0.28568583885302257, 'recall': 0.3799322619761105, 'f1-score': 0.32613676471467967, 'support': 71747}, '2': {'precision': 0.41156267202795527, 'recall': 0.3553229739223871, 'f1-score': 0.3813806487385639, 'support': 96788}, 'accuracy': 0.37985404688191066, 'macro avg': {'precision': 0.38190394400443006, 'recall': 0.3793848305421578, 'f1-score': 0.37732647683285087, 'support': 271320}, 'weighted avg': {'precision': 0.39225538936685206, 'recall': 0.37985404688191066, 'f1-score': 0.3830927801492493, 'support': 271320}}
[[41412 34893 26480]
 [21797 27259 22691]
 [29133 33264 34391]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.066886
{'0': {'precision': 0.43876159301691214, 'recall': 0.2935085078235482, 'f1-score': 0.35172885062183956, 'support': 21921}, '1': {'precision': 0.43128677411102584, 'recall': 0.6596627147161247, 'f1-score': 0.5215709932402122, 'support': 25557}, '2': {'precision': 0.44234998429154887, 'recall': 0.31724573025100267, 'f1-score': 0.36949561748805965, 'support': 22191}, 'accuracy': 0.4353873315247815, 'macro avg': {'precision': 0.4374661171398289, 'recall': 0.4234723175968919, 'f1-score': 0.4142651537833704, 'support': 69669}, 'weighted avg': {'precision': 0.4371625467265639, 'recall': 0.4353873315247815, 'f1-score': 0.41969190395152767, 'support': 69669}}
[[ 6434 11273  4214]
 [ 4037 16859  4661]
 [ 4193 10958  7040]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0959098
{'0': {'precision': 0.43524554541503696, 'recall': 0.25059426998623796, 'f1-score': 0.318062723302898, 'support': 7993}, '1': {'precision': 0.40787537862397233, 'recall': 0.5321815718157181, 'f1-score': 0.4618098084366273, 'support': 8856}, '2': {'precision': 0.3927372962607862, 'recall': 0.428254051228437, 'f1-score': 0.4097274318579645, 'support': 7652}, 'accuracy': 0.4078609036365863, 'macro avg': {'precision': 0.4119527400999318, 'recall': 0.403676631010131, 'f1-score': 0.39653332119916324, 'support': 24501}, 'weighted avg': {'precision': 0.4120765596744551, 'recall': 0.4078609036365863, 'f1-score': 0.3986489253276185, 'support': 24501}}
[[2003 3691 2299]
 [1375 4713 2768]
 [1224 3151 3277]]
training model: results/LILAK/W5/deepLOB_L2/h30
Epoch 1/50
273/273 - 14s - loss: 3.3371 - accuracy30: 0.3600 - val_loss: 3.5165 - val_accuracy30: 0.3316 - 14s/epoch - 51ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3020 - accuracy30: 0.3666 - val_loss: 3.4444 - val_accuracy30: 0.3366 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2663 - accuracy30: 0.3852 - val_loss: 3.4620 - val_accuracy30: 0.3245 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2433 - accuracy30: 0.4007 - val_loss: 3.4420 - val_accuracy30: 0.3313 - 12s/epoch - 43ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2096 - accuracy30: 0.4184 - val_loss: 3.4169 - val_accuracy30: 0.3550 - 12s/epoch - 44ms/step
Epoch 6/50
273/273 - 12s - loss: 3.1817 - accuracy30: 0.4321 - val_loss: 3.4064 - val_accuracy30: 0.3644 - 12s/epoch - 44ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1596 - accuracy30: 0.4419 - val_loss: 3.4015 - val_accuracy30: 0.3632 - 12s/epoch - 44ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1469 - accuracy30: 0.4468 - val_loss: 3.3865 - val_accuracy30: 0.3699 - 12s/epoch - 44ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1281 - accuracy30: 0.4541 - val_loss: 3.3701 - val_accuracy30: 0.3827 - 12s/epoch - 44ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1111 - accuracy30: 0.4611 - val_loss: 3.3755 - val_accuracy30: 0.3822 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.0969 - accuracy30: 0.4666 - val_loss: 3.4088 - val_accuracy30: 0.3738 - 12s/epoch - 43ms/step
Epoch 12/50
273/273 - 12s - loss: 3.0746 - accuracy30: 0.4733 - val_loss: 3.3869 - val_accuracy30: 0.3827 - 12s/epoch - 43ms/step
Epoch 13/50
273/273 - 12s - loss: 3.0637 - accuracy30: 0.4761 - val_loss: 3.4020 - val_accuracy30: 0.3804 - 12s/epoch - 44ms/step
Epoch 14/50
273/273 - 12s - loss: 3.0491 - accuracy30: 0.4822 - val_loss: 3.4194 - val_accuracy30: 0.3784 - 12s/epoch - 43ms/step
Epoch 15/50
273/273 - 12s - loss: 3.0447 - accuracy30: 0.4806 - val_loss: 3.4629 - val_accuracy30: 0.3778 - 12s/epoch - 44ms/step
Epoch 16/50
273/273 - 12s - loss: 3.0243 - accuracy30: 0.4889 - val_loss: 3.4853 - val_accuracy30: 0.3829 - 12s/epoch - 44ms/step
Epoch 17/50
273/273 - 12s - loss: 3.0120 - accuracy30: 0.4925 - val_loss: 3.4780 - val_accuracy30: 0.3815 - 12s/epoch - 44ms/step
Epoch 18/50
273/273 - 12s - loss: 3.0012 - accuracy30: 0.4981 - val_loss: 3.4777 - val_accuracy30: 0.3830 - 12s/epoch - 43ms/step
Epoch 19/50
273/273 - 12s - loss: 2.9829 - accuracy30: 0.5020 - val_loss: 3.5734 - val_accuracy30: 0.3792 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h30
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1354963
{'0': {'precision': 0.41083563037101456, 'recall': 0.5253916190691624, 'f1-score': 0.4611051369013152, 'support': 106098}, '1': {'precision': 0.2535655366930978, 'recall': 0.2941748471939248, 'f1-score': 0.2723648107922717, 'support': 64788}, '2': {'precision': 0.42748949961967125, 'recall': 0.2574028715375271, 'f1-score': 0.3213264722698685, 'support': 100434}, 'accuracy': 0.3709789178829426, 'macro avg': {'precision': 0.3639635555612612, 'recall': 0.3589897792668715, 'f1-score': 0.3515988066544851, 'support': 271320}, 'weighted avg': {'precision': 0.3794461267403007, 'recall': 0.3709789178829426, 'f1-score': 0.3642945860700184, 'support': 271320}}
[[55743 29854 20501]
 [31608 19059 14121]
 [48331 26251 25852]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850974
{'0': {'precision': 0.4304708819601695, 'recall': 0.31686468928968287, 'f1-score': 0.36503286477437774, 'support': 23398}, '1': {'precision': 0.3939223742942446, 'recall': 0.5852180404900971, 'f1-score': 0.4708833922261484, 'support': 22771}, '2': {'precision': 0.44572165225331684, 'recall': 0.3531063829787234, 'f1-score': 0.3940451599116746, 'support': 23500}, 'accuracy': 0.41679943733941927, 'macro avg': {'precision': 0.4233716361692436, 'recall': 0.4183963709195011, 'f1-score': 0.4099871389707335, 'support': 69669}, 'weighted avg': {'precision': 0.42366939254347324, 'recall': 0.41679943733941927, 'f1-score': 0.4094157509408326, 'support': 69669}}
[[ 7414 10717  5267]
 [ 4393 13326  5052]
 [ 5416  9786  8298]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1234947
{'0': {'precision': 0.3847680097680098, 'recall': 0.29976218787158143, 'f1-score': 0.33698703381900813, 'support': 8410}, '1': {'precision': 0.34808054756472573, 'recall': 0.4401655795283492, 'f1-score': 0.3887442530327369, 'support': 7972}, '2': {'precision': 0.4213268937468226, 'recall': 0.40830151496489714, 'f1-score': 0.41471195346218803, 'support': 8119}, 'accuracy': 0.3814130035508755, 'macro avg': {'precision': 0.3847251503598527, 'recall': 0.3827430941216093, 'f1-score': 0.380147746771311, 'support': 24501}, 'weighted avg': {'precision': 0.3849455180468311, 'recall': 0.3814130035508755, 'f1-score': 0.37958354719212856, 'support': 24501}}
[[2521 3597 2292]
 [2202 3509 2261]
 [1829 2975 3315]]
training model: results/LILAK/W5/deepLOB_L2/h50
Epoch 1/50
273/273 - 14s - loss: 3.3433 - accuracy50: 0.3577 - val_loss: 3.4576 - val_accuracy50: 0.3328 - 14s/epoch - 52ms/step
Epoch 2/50
273/273 - 12s - loss: 3.2999 - accuracy50: 0.3697 - val_loss: 3.4286 - val_accuracy50: 0.3184 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2774 - accuracy50: 0.3782 - val_loss: 3.4586 - val_accuracy50: 0.3219 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2595 - accuracy50: 0.3891 - val_loss: 3.4340 - val_accuracy50: 0.3424 - 12s/epoch - 43ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2328 - accuracy50: 0.4081 - val_loss: 3.4073 - val_accuracy50: 0.3500 - 12s/epoch - 44ms/step
Epoch 6/50
273/273 - 12s - loss: 3.2134 - accuracy50: 0.4160 - val_loss: 3.4205 - val_accuracy50: 0.3497 - 12s/epoch - 44ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1965 - accuracy50: 0.4263 - val_loss: 3.4157 - val_accuracy50: 0.3602 - 12s/epoch - 44ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1710 - accuracy50: 0.4358 - val_loss: 3.4282 - val_accuracy50: 0.3624 - 12s/epoch - 44ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1579 - accuracy50: 0.4412 - val_loss: 3.4582 - val_accuracy50: 0.3626 - 12s/epoch - 44ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1422 - accuracy50: 0.4474 - val_loss: 3.4786 - val_accuracy50: 0.3665 - 12s/epoch - 44ms/step
Epoch 11/50
273/273 - 12s - loss: 3.1297 - accuracy50: 0.4521 - val_loss: 3.5487 - val_accuracy50: 0.3688 - 12s/epoch - 42ms/step
Epoch 12/50
273/273 - 12s - loss: 3.1158 - accuracy50: 0.4567 - val_loss: 3.5479 - val_accuracy50: 0.3689 - 12s/epoch - 43ms/step
Epoch 13/50
273/273 - 12s - loss: 3.1072 - accuracy50: 0.4609 - val_loss: 3.5829 - val_accuracy50: 0.3695 - 12s/epoch - 43ms/step
Epoch 14/50
273/273 - 12s - loss: 3.0937 - accuracy50: 0.4634 - val_loss: 3.5295 - val_accuracy50: 0.3738 - 12s/epoch - 43ms/step
Epoch 15/50
273/273 - 12s - loss: 3.0776 - accuracy50: 0.4711 - val_loss: 3.5841 - val_accuracy50: 0.3708 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h50
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1576484
{'0': {'precision': 0.39200363253991016, 'recall': 0.1611898351054421, 'f1-score': 0.22844449396264782, 'support': 101762}, '1': {'precision': 0.25395520467909655, 'recall': 0.5756493783606931, 'f1-score': 0.35243092599446973, 'support': 70298}, '2': {'precision': 0.3827090076858361, 'recall': 0.27039089260527904, 'f1-score': 0.31689188790299255, 'support': 99260}, 'accuracy': 0.3085249889429456, 'macro avg': {'precision': 0.3428892816349476, 'recall': 0.3357433686904714, 'f1-score': 0.29925576928670333, 'support': 271320}, 'weighted avg': {'precision': 0.3528354442575319, 'recall': 0.3085249889429456, 'f1-score': 0.2929266055706813, 'support': 271320}}
[[16403 61462 23897]
 [10438 40467 19393]
 [15003 57418 26839]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1222056
{'0': {'precision': 0.40910085320498796, 'recall': 0.07986674639104809, 'f1-score': 0.13364302304806144, 'support': 23414}, '1': {'precision': 0.3411866870551811, 'recall': 0.7868088811493252, 'f1-score': 0.4759747698871492, 'support': 22970}, '2': {'precision': 0.4135400346334625, 'recall': 0.21537470474554435, 'f1-score': 0.2832373206822546, 'support': 23285}, 'accuracy': 0.35823680546584563, 'macro avg': {'precision': 0.38794252496454384, 'recall': 0.3606834440953059, 'f1-score': 0.29761837120582174, 'support': 69669}, 'weighted avg': {'precision': 0.38819310288706993, 'recall': 0.35823680546584563, 'f1-score': 0.29650833538649074, 'support': 69669}}
[[ 1870 17975  3569]
 [ 1354 18073  3543]
 [ 1347 16923  5015]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1373582
{'0': {'precision': 0.37953216374269005, 'recall': 0.07796732340221048, 'f1-score': 0.12936017540362768, 'support': 8324}, '1': {'precision': 0.33139909735654416, 'recall': 0.7078117175763645, 'f1-score': 0.4514351870334145, 'support': 7988}, '2': {'precision': 0.39755671902268763, 'recall': 0.2781780437171816, 'f1-score': 0.32732236511243623, 'support': 8189}, 'accuracy': 0.35023060283253743, 'macro avg': {'precision': 0.36949599337397393, 'recall': 0.35465236156525215, 'f1-score': 0.3027059091831595, 'support': 24501}, 'weighted avg': {'precision': 0.3698638297520516, 'recall': 0.35023060283253743, 'f1-score': 0.3005306404631832, 'support': 24501}}
[[ 649 5900 1775]
 [ 657 5654 1677]
 [ 404 5507 2278]]
training model: results/LILAK/W5/deepLOB_L2/h100
Epoch 1/50
273/273 - 14s - loss: 3.3570 - accuracy100: 0.3449 - val_loss: 3.4074 - val_accuracy100: 0.3166 - 14s/epoch - 50ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3088 - accuracy100: 0.3606 - val_loss: 3.3589 - val_accuracy100: 0.3261 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2783 - accuracy100: 0.3762 - val_loss: 3.3549 - val_accuracy100: 0.3308 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2696 - accuracy100: 0.3798 - val_loss: 3.3420 - val_accuracy100: 0.3397 - 12s/epoch - 43ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2531 - accuracy100: 0.3922 - val_loss: 3.3337 - val_accuracy100: 0.3490 - 12s/epoch - 43ms/step
Epoch 6/50
273/273 - 12s - loss: 3.2380 - accuracy100: 0.4021 - val_loss: 3.3277 - val_accuracy100: 0.3496 - 12s/epoch - 44ms/step
Epoch 7/50
273/273 - 12s - loss: 3.2226 - accuracy100: 0.4119 - val_loss: 3.3288 - val_accuracy100: 0.3616 - 12s/epoch - 43ms/step
Epoch 8/50
273/273 - 12s - loss: 3.2128 - accuracy100: 0.4184 - val_loss: 3.3584 - val_accuracy100: 0.3666 - 12s/epoch - 44ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1901 - accuracy100: 0.4298 - val_loss: 3.3635 - val_accuracy100: 0.3621 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1751 - accuracy100: 0.4350 - val_loss: 3.3778 - val_accuracy100: 0.3597 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.1660 - accuracy100: 0.4379 - val_loss: 3.3960 - val_accuracy100: 0.3630 - 12s/epoch - 44ms/step
Epoch 12/50
273/273 - 12s - loss: 3.1520 - accuracy100: 0.4443 - val_loss: 3.4055 - val_accuracy100: 0.3650 - 12s/epoch - 43ms/step
Epoch 13/50
273/273 - 12s - loss: 3.1361 - accuracy100: 0.4532 - val_loss: 3.4359 - val_accuracy100: 0.3595 - 12s/epoch - 43ms/step
Epoch 14/50
273/273 - 12s - loss: 3.1128 - accuracy100: 0.4583 - val_loss: 3.4754 - val_accuracy100: 0.3646 - 12s/epoch - 43ms/step
Epoch 15/50
273/273 - 12s - loss: 3.1041 - accuracy100: 0.4617 - val_loss: 3.4752 - val_accuracy100: 0.3624 - 12s/epoch - 43ms/step
Epoch 16/50
273/273 - 12s - loss: 3.0789 - accuracy100: 0.4713 - val_loss: 3.5216 - val_accuracy100: 0.3654 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h100
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1189841
{'0': {'precision': 0.34982396311908937, 'recall': 0.44417604666780264, 'f1-score': 0.3913940127270399, 'support': 99769}, '1': {'precision': 0.23541316798001982, 'recall': 0.23033818324813213, 'f1-score': 0.23284802623639736, 'support': 71204}, '2': {'precision': 0.4090806023501794, 'recall': 0.3056394311738268, 'f1-score': 0.34987451517225643, 'support': 100347}, 'accuracy': 0.33681999115435646, 'macro avg': {'precision': 0.3314392444830962, 'recall': 0.32671788702992055, 'f1-score': 0.32470551804523123, 'support': 271320}, 'weighted avg': {'precision': 0.34171442353424447, 'recall': 0.33681999115435646, 'f1-score': 0.33443003866243143, 'support': 271320}}
[[44315 27531 27923]
 [38423 16401 16380]
 [43940 25737 30670]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1000165
{'0': {'precision': 0.38057104987021595, 'recall': 0.2920781587759081, 'f1-score': 0.3305035971223022, 'support': 23593}, '1': {'precision': 0.3579500359046071, 'recall': 0.41180051306578547, 'f1-score': 0.3829916292611913, 'support': 22999}, '2': {'precision': 0.37306298052025655, 'recall': 0.4058153139489535, 'f1-score': 0.38875051888750517, 'support': 23077}, 'accuracy': 0.3692747132871148, 'macro avg': {'precision': 0.37052802209835983, 'recall': 0.36989799526354905, 'f1-score': 0.3674152484236662, 'support': 69669}, 'weighted avg': {'precision': 0.3706164873447878, 'recall': 0.3692747132871148, 'f1-score': 0.3671244251051626, 'support': 69669}}
[[6891 9076 7626]
 [5416 9471 8112]
 [5800 7912 9365]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1105207
{'0': {'precision': 0.3674431129662044, 'recall': 0.3105017635680965, 'f1-score': 0.3365811544153922, 'support': 8789}, '1': {'precision': 0.3057347670250896, 'recall': 0.35394190871369297, 'f1-score': 0.32807692307692304, 'support': 7230}, '2': {'precision': 0.38097426470588236, 'recall': 0.39094553171421836, 'f1-score': 0.38589549633422554, 'support': 8482}, 'accuracy': 0.35116934002693767, 'macro avg': {'precision': 0.35138404823239205, 'recall': 0.3517964013320026, 'f1-score': 0.3501845246088469, 'support': 24501}, 'weighted avg': {'precision': 0.35391794615267386, 'recall': 0.35116934002693767, 'f1-score': 0.35114377045467277, 'support': 24501}}
[[2729 3129 2931]
 [2214 2559 2457]
 [2484 2682 3316]]
training model: results/LILAK/W5/deepLOB_L2/h200
Epoch 1/50
273/273 - 14s - loss: 3.3576 - accuracy200: 0.3464 - val_loss: 3.4175 - val_accuracy200: 0.3290 - 14s/epoch - 50ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3155 - accuracy200: 0.3556 - val_loss: 3.3614 - val_accuracy200: 0.3284 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.3044 - accuracy200: 0.3623 - val_loss: 3.4011 - val_accuracy200: 0.3164 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2894 - accuracy200: 0.3713 - val_loss: 3.3643 - val_accuracy200: 0.3340 - 12s/epoch - 43ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2741 - accuracy200: 0.3798 - val_loss: 3.3675 - val_accuracy200: 0.3315 - 12s/epoch - 44ms/step
Epoch 6/50
273/273 - 12s - loss: 3.2573 - accuracy200: 0.3941 - val_loss: 3.3941 - val_accuracy200: 0.3329 - 12s/epoch - 44ms/step
Epoch 7/50
273/273 - 12s - loss: 3.2400 - accuracy200: 0.4022 - val_loss: 3.4007 - val_accuracy200: 0.3360 - 12s/epoch - 44ms/step
Epoch 8/50
273/273 - 12s - loss: 3.2231 - accuracy200: 0.4142 - val_loss: 3.4531 - val_accuracy200: 0.3306 - 12s/epoch - 43ms/step
Epoch 9/50
273/273 - 12s - loss: 3.2079 - accuracy200: 0.4209 - val_loss: 3.5090 - val_accuracy200: 0.3361 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1848 - accuracy200: 0.4317 - val_loss: 3.5191 - val_accuracy200: 0.3287 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.1663 - accuracy200: 0.4412 - val_loss: 3.6175 - val_accuracy200: 0.3333 - 12s/epoch - 43ms/step
Epoch 12/50
273/273 - 12s - loss: 3.1491 - accuracy200: 0.4490 - val_loss: 3.5612 - val_accuracy200: 0.3344 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h200
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1348337
{'0': {'precision': 0.3359445817390724, 'recall': 0.3863279749821693, 'f1-score': 0.35937898723065465, 'support': 91135}, '1': {'precision': 0.29139609624610047, 'recall': 0.3830704612754148, 'f1-score': 0.3310030297515176, 'support': 80711}, '2': {'precision': 0.3679941735359354, 'recall': 0.22349558678649697, 'f1-score': 0.27809466626638646, 'support': 99474}, 'accuracy': 0.3256597375792422, 'macro avg': {'precision': 0.3317782838403694, 'recall': 0.330964674348027, 'f1-score': 0.3228255610828529, 'support': 271320}, 'weighted avg': {'precision': 0.3344428431343912, 'recall': 0.3256597375792422, 'f1-score': 0.3211365854626381, 'support': 271320}}
[[35208 35550 20377]
 [31988 30918 17805]
 [37607 39635 22232]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1147226
{'0': {'precision': 0.37747790780988777, 'recall': 0.25982245602498766, 'f1-score': 0.30778967867575463, 'support': 24332}, '1': {'precision': 0.32606713398301707, 'recall': 0.5170107983553969, 'f1-score': 0.39991612350813427, 'support': 22133}, '2': {'precision': 0.3485162955068155, 'recall': 0.2677555593863127, 'f1-score': 0.30284419097755355, 'support': 23204}, 'accuracy': 0.34417029094719315, 'macro avg': {'precision': 0.3506871124332401, 'recall': 0.34819627125556574, 'f1-score': 0.33684999772048085, 'support': 69669}, 'weighted avg': {'precision': 0.3514993533740466, 'recall': 0.34417029094719315, 'f1-score': 0.33540999053506076, 'support': 69669}}
[[ 6322 12025  5985]
 [ 5061 11443  5629]
 [ 5365 11626  6213]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1244183
{'0': {'precision': 0.36933448078026393, 'recall': 0.28690807799442897, 'f1-score': 0.32294475449927884, 'support': 8975}, '1': {'precision': 0.2943444730077121, 'recall': 0.45436507936507936, 'f1-score': 0.35725429017160687, 'support': 7056}, '2': {'precision': 0.3509115564260961, 'recall': 0.27497048406139313, 'f1-score': 0.30833388495399483, 'support': 8470}, 'accuracy': 0.3310068976776458, 'macro avg': {'precision': 0.3381968367380241, 'recall': 0.33874788047363386, 'f1-score': 0.3295109765416268, 'support': 24501}, 'weighted avg': {'precision': 0.3413694318384686, 'recall': 0.3310068976776458, 'f1-score': 0.32777451731122087, 'support': 24501}}
[[2575 3975 2425]
 [1967 3206 1883]
 [2430 3711 2329]]
training model: results/LILAK/W5/deepLOB_L2/h300
Epoch 1/50
273/273 - 14s - loss: 3.3484 - accuracy300: 0.3559 - val_loss: 3.3641 - val_accuracy300: 0.3414 - 14s/epoch - 50ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3022 - accuracy300: 0.3699 - val_loss: 3.4295 - val_accuracy300: 0.3377 - 12s/epoch - 43ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2830 - accuracy300: 0.3827 - val_loss: 3.4106 - val_accuracy300: 0.3384 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2662 - accuracy300: 0.3908 - val_loss: 3.4182 - val_accuracy300: 0.3354 - 12s/epoch - 43ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2420 - accuracy300: 0.4052 - val_loss: 3.4519 - val_accuracy300: 0.3388 - 12s/epoch - 44ms/step
Epoch 6/50
273/273 - 12s - loss: 3.2202 - accuracy300: 0.4152 - val_loss: 3.4525 - val_accuracy300: 0.3350 - 12s/epoch - 43ms/step
Epoch 7/50
273/273 - 12s - loss: 3.2040 - accuracy300: 0.4257 - val_loss: 3.4727 - val_accuracy300: 0.3397 - 12s/epoch - 43ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1894 - accuracy300: 0.4309 - val_loss: 3.5830 - val_accuracy300: 0.3374 - 12s/epoch - 44ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1737 - accuracy300: 0.4384 - val_loss: 3.5740 - val_accuracy300: 0.3348 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1552 - accuracy300: 0.4465 - val_loss: 3.5930 - val_accuracy300: 0.3359 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.1426 - accuracy300: 0.4512 - val_loss: 3.6309 - val_accuracy300: 0.3408 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h300
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1369907
{'0': {'precision': 0.32017443039686294, 'recall': 0.5321250393276102, 'f1-score': 0.3997956995601631, 'support': 88996}, '1': {'precision': 0.2926618061957038, 'recall': 0.12667150284125256, 'f1-score': 0.17681357534026948, 'support': 82710}, '2': {'precision': 0.3803517823104405, 'recall': 0.33452125203284677, 'f1-score': 0.3559674188810255, 'support': 99614}, 'accuracy': 0.3359759693351025, 'macro avg': {'precision': 0.3310626729676691, 'recall': 0.3311059314005699, 'f1-score': 0.3108588979271527, 'support': 271320}, 'weighted avg': {'precision': 0.3338812621300239, 'recall': 0.3359759693351025, 'f1-score': 0.31572979271290147, 'support': 271320}}
[[47357 12219 29420]
 [47365 10477 24868]
 [53188 13103 33323]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1183432
{'0': {'precision': 0.36770892059499544, 'recall': 0.3518257261410788, 'f1-score': 0.35959201849063804, 'support': 24100}, '1': {'precision': 0.34427690707866004, 'recall': 0.20296899632159748, 'f1-score': 0.25537893605884465, 'support': 22836}, '2': {'precision': 0.3348719341116843, 'recall': 0.4882769542075397, 'f1-score': 0.3972798854688619, 'support': 22733}, 'accuracy': 0.3475577373006646, 'macro avg': {'precision': 0.34895258726177997, 'recall': 0.34769055889007205, 'f1-score': 0.3374169466727815, 'support': 69669}, 'weighted avg': {'precision': 0.34931369927153527, 'recall': 0.3475577373006646, 'f1-score': 0.33773076498626065, 'support': 69669}}
[[ 8479  4563 11058]
 [ 7212  4635 10989]
 [ 7368  4265 11100]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1240807
{'0': {'precision': 0.3744623325549957, 'recall': 0.3283405172413793, 'f1-score': 0.3498880404202791, 'support': 9280}, '1': {'precision': 0.2669253988788271, 'recall': 0.18373404571089344, 'f1-score': 0.2176511954992968, 'support': 6738}, '2': {'precision': 0.34879754391949513, 'recall': 0.48214075209242013, 'f1-score': 0.40477015191251425, 'support': 8483}, 'accuracy': 0.3418227827435615, 'macro avg': {'precision': 0.33006175845110597, 'recall': 0.3314051050148976, 'f1-score': 0.32410312927736334, 'support': 24501}, 'weighted avg': {'precision': 0.33600274881943487, 'recall': 0.3418227827435615, 'f1-score': 0.3325235692032289, 'support': 24501}}
[[3047 1804 4429]
 [2293 1238 3207]
 [2797 1596 4090]]
training model: results/LILAK/W5/deepLOB_L2/h500
Epoch 1/50
273/273 - 14s - loss: 3.3524 - accuracy500: 0.3503 - val_loss: 3.5848 - val_accuracy500: 0.3175 - 14s/epoch - 52ms/step
Epoch 2/50
273/273 - 12s - loss: 3.3011 - accuracy500: 0.3693 - val_loss: 3.5381 - val_accuracy500: 0.3210 - 12s/epoch - 44ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2624 - accuracy500: 0.3913 - val_loss: 3.7421 - val_accuracy500: 0.3219 - 12s/epoch - 43ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2492 - accuracy500: 0.3978 - val_loss: 3.6105 - val_accuracy500: 0.3250 - 12s/epoch - 44ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2261 - accuracy500: 0.4108 - val_loss: 3.7715 - val_accuracy500: 0.3291 - 12s/epoch - 45ms/step
Epoch 6/50
273/273 - 12s - loss: 3.1985 - accuracy500: 0.4231 - val_loss: 3.7774 - val_accuracy500: 0.3282 - 12s/epoch - 45ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1676 - accuracy500: 0.4338 - val_loss: 3.8706 - val_accuracy500: 0.3301 - 12s/epoch - 45ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1451 - accuracy500: 0.4471 - val_loss: 3.9399 - val_accuracy500: 0.3302 - 12s/epoch - 43ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1262 - accuracy500: 0.4514 - val_loss: 4.0753 - val_accuracy500: 0.3297 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.1021 - accuracy500: 0.4601 - val_loss: 4.0521 - val_accuracy500: 0.3310 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.0728 - accuracy500: 0.4714 - val_loss: 4.1988 - val_accuracy500: 0.3285 - 12s/epoch - 43ms/step
Epoch 12/50
273/273 - 12s - loss: 3.0469 - accuracy500: 0.4784 - val_loss: 4.2123 - val_accuracy500: 0.3286 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h500
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1722872
{'0': {'precision': 0.3234607828535359, 'recall': 0.5347724634452353, 'f1-score': 0.4031023510694715, 'support': 85283}, '1': {'precision': 0.35933887324588515, 'recall': 0.17651755392123789, 'f1-score': 0.23674109600404197, 'support': 88926}, '2': {'precision': 0.3654201292705448, 'recall': 0.3260186796552399, 'f1-score': 0.344596764099243, 'support': 97111}, 'accuracy': 0.34263600176912873, 'macro avg': {'precision': 0.349406595123322, 'recall': 0.3457695656739044, 'f1-score': 0.3281467370575855, 'support': 271320}, 'weighted avg': {'precision': 0.35023805381082695, 'recall': 0.34263600176912873, 'f1-score': 0.327636565192226, 'support': 271320}}
[[45607 13265 26411]
 [44660 15697 28569]
 [50730 14721 31660]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.137489
{'0': {'precision': 0.36735417109646323, 'recall': 0.43624274051005807, 'f1-score': 0.39884570988841855, 'support': 23762}, '1': {'precision': 0.3525455597338733, 'recall': 0.20411153910567745, 'f1-score': 0.25853839626644043, 'support': 23884}, '2': {'precision': 0.3463056148861456, 'recall': 0.43436407392271714, 'f1-score': 0.38536840833098335, 'support': 22023}, 'accuracy': 0.3560694139430737, 'macro avg': {'precision': 0.35540178190549404, 'recall': 0.3582394511794842, 'f1-score': 0.34758417149528076, 'support': 69669}, 'weighted avg': {'precision': 0.35562382866002923, 'recall': 0.3560694139430737, 'f1-score': 0.3464851120508334, 'support': 69669}}
[[10366  4510  8886]
 [ 9838  4875  9171]
 [ 8014  4443  9566]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1811864
{'0': {'precision': 0.32653619816614204, 'recall': 0.2654650645304851, 'f1-score': 0.29285056765879103, 'support': 8988}, '1': {'precision': 0.29339051463168514, 'recall': 0.1576949152542373, 'f1-score': 0.20513272775377017, 'support': 7375}, '2': {'precision': 0.33151927437641726, 'recall': 0.5389530597198329, 'f1-score': 0.41052040434294274, 'support': 8138}, 'accuracy': 0.32386433206807885, 'macro avg': {'precision': 0.3171486623914148, 'recall': 0.3207043465015184, 'f1-score': 0.302834566585168, 'support': 24501}, 'weighted avg': {'precision': 0.318214205518193, 'recall': 0.32386433206807885, 'f1-score': 0.30553078730844196, 'support': 24501}}
[[2386 1490 5112]
 [2480 1163 3732]
 [2441 1311 4386]]
training model: results/LILAK/W5/deepLOB_L2/h1000
Epoch 1/50
273/273 - 13s - loss: 3.3525 - accuracy1000: 0.3538 - val_loss: 3.5570 - val_accuracy1000: 0.3173 - 13s/epoch - 49ms/step
Epoch 2/50
273/273 - 12s - loss: 3.2819 - accuracy1000: 0.3852 - val_loss: 3.7780 - val_accuracy1000: 0.3059 - 12s/epoch - 42ms/step
Epoch 3/50
273/273 - 12s - loss: 3.2755 - accuracy1000: 0.3877 - val_loss: 3.7267 - val_accuracy1000: 0.3149 - 12s/epoch - 42ms/step
Epoch 4/50
273/273 - 12s - loss: 3.2390 - accuracy1000: 0.4043 - val_loss: 3.8438 - val_accuracy1000: 0.3156 - 12s/epoch - 42ms/step
Epoch 5/50
273/273 - 12s - loss: 3.2155 - accuracy1000: 0.4128 - val_loss: 3.7926 - val_accuracy1000: 0.3132 - 12s/epoch - 42ms/step
Epoch 6/50
273/273 - 12s - loss: 3.1839 - accuracy1000: 0.4318 - val_loss: 3.9467 - val_accuracy1000: 0.3185 - 12s/epoch - 42ms/step
Epoch 7/50
273/273 - 12s - loss: 3.1536 - accuracy1000: 0.4398 - val_loss: 4.0505 - val_accuracy1000: 0.3159 - 12s/epoch - 42ms/step
Epoch 8/50
273/273 - 12s - loss: 3.1305 - accuracy1000: 0.4475 - val_loss: 3.9614 - val_accuracy1000: 0.3071 - 12s/epoch - 43ms/step
Epoch 9/50
273/273 - 12s - loss: 3.1093 - accuracy1000: 0.4581 - val_loss: 3.9576 - val_accuracy1000: 0.3155 - 12s/epoch - 43ms/step
Epoch 10/50
273/273 - 12s - loss: 3.0704 - accuracy1000: 0.4734 - val_loss: 4.0488 - val_accuracy1000: 0.3222 - 12s/epoch - 43ms/step
Epoch 11/50
273/273 - 12s - loss: 3.0551 - accuracy1000: 0.4777 - val_loss: 4.0818 - val_accuracy1000: 0.3181 - 12s/epoch - 43ms/step
testing model: results/LILAK/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
1060/1060 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1289909
{'0': {'precision': 0.31228545182033557, 'recall': 0.2424337207702028, 'f1-score': 0.27296162731729307, 'support': 79927}, '1': {'precision': 0.3468160231458129, 'recall': 0.38047359518887425, 'f1-score': 0.36286600514809486, 'support': 95778}, '2': {'precision': 0.36379776963089505, 'recall': 0.3964545311928045, 'f1-score': 0.3794247621526127, 'support': 95615}, 'accuracy': 0.34544080790210824, 'macro avg': {'precision': 0.3409664148656812, 'recall': 0.3397872823839605, 'f1-score': 0.33841746487266694, 'support': 271320}, 'weighted avg': {'precision': 0.3426282917431876, 'recall': 0.34544080790210824, 'f1-score': 0.34221687623796837, 'support': 271320}}
[[19377 31439 29111]
 [22157 36441 37180]
 [20515 37193 37907]]
Evaluating performance on  train set...
273/273 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1397774
{'0': {'precision': 0.41732851985559566, 'recall': 0.09536773501629336, 'f1-score': 0.15525635429607496, 'support': 24243}, '1': {'precision': 0.3398582405935347, 'recall': 0.44803947253514975, 'f1-score': 0.3865220175537726, 'support': 22902}, '2': {'precision': 0.3493826796711554, 'recall': 0.5264162670928787, 'f1-score': 0.4200067303094171, 'support': 22524}, 'accuracy': 0.35065811192926555, 'macro avg': {'precision': 0.36885648004009525, 'recall': 0.3566078248814406, 'f1-score': 0.32059503405308826, 'support': 69669}, 'weighted avg': {'precision': 0.36989513571093946, 'recall': 0.35065811192926555, 'f1-score': 0.3168731952045466, 'support': 69669}}
[[ 2312 10567 11364]
 [ 1925 10261 10716]
 [ 1303  9364 11857]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1937603
{'0': {'precision': 0.29766536964980544, 'recall': 0.05204081632653061, 'f1-score': 0.08859293572669369, 'support': 8820}, '1': {'precision': 0.3162745310636452, 'recall': 0.3842708470557239, 'f1-score': 0.34697276079457595, 'support': 7591}, '2': {'precision': 0.32112696563774024, 'recall': 0.5452410383189122, 'f1-score': 0.40419682946944013, 'support': 8090}, 'accuracy': 0.31782376229541653, 'macro avg': {'precision': 0.311688955450397, 'recall': 0.3271842339003889, 'f1-score': 0.27992084199690326, 'support': 24501}, 'weighted avg': {'precision': 0.3111777346893896, 'recall': 0.31782376229541653, 'f1-score': 0.27285467004239966, 'support': 24501}}
[[ 459 3156 5205]
 [ 554 2917 4120]
 [ 529 3150 4411]]
training model: results/LILAK/W5/deepOF_L2/h10
Epoch 1/50
273/273 - 9s - loss: 3.2925 - accuracy10: 0.3849 - val_loss: 3.3587 - val_accuracy10: 0.4547 - 9s/epoch - 32ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2356 - accuracy10: 0.4215 - val_loss: 3.3205 - val_accuracy10: 0.4698 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.1899 - accuracy10: 0.4347 - val_loss: 3.3052 - val_accuracy10: 0.4787 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.1611 - accuracy10: 0.4450 - val_loss: 3.2899 - val_accuracy10: 0.4863 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.1349 - accuracy10: 0.4569 - val_loss: 3.2990 - val_accuracy10: 0.4933 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.1104 - accuracy10: 0.4643 - val_loss: 3.2858 - val_accuracy10: 0.5008 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.0911 - accuracy10: 0.4729 - val_loss: 3.2736 - val_accuracy10: 0.5026 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.0714 - accuracy10: 0.4794 - val_loss: 3.2501 - val_accuracy10: 0.5097 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.0557 - accuracy10: 0.4843 - val_loss: 3.2449 - val_accuracy10: 0.5101 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.0346 - accuracy10: 0.4894 - val_loss: 3.2776 - val_accuracy10: 0.5139 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.0186 - accuracy10: 0.4935 - val_loss: 3.2589 - val_accuracy10: 0.5145 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.0040 - accuracy10: 0.4983 - val_loss: 3.2409 - val_accuracy10: 0.5148 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 2.9832 - accuracy10: 0.5056 - val_loss: 3.2308 - val_accuracy10: 0.5176 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 2.9686 - accuracy10: 0.5107 - val_loss: 3.2323 - val_accuracy10: 0.5181 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 2.9531 - accuracy10: 0.5119 - val_loss: 3.2342 - val_accuracy10: 0.5166 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 2.9390 - accuracy10: 0.5172 - val_loss: 3.2442 - val_accuracy10: 0.5161 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 2.9195 - accuracy10: 0.5208 - val_loss: 3.2455 - val_accuracy10: 0.5178 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 2.9075 - accuracy10: 0.5263 - val_loss: 3.2647 - val_accuracy10: 0.5144 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 2.8902 - accuracy10: 0.5272 - val_loss: 3.2481 - val_accuracy10: 0.5150 - 7s/epoch - 24ms/step
Epoch 20/50
273/273 - 7s - loss: 2.8730 - accuracy10: 0.5319 - val_loss: 3.2314 - val_accuracy10: 0.5110 - 7s/epoch - 25ms/step
Epoch 21/50
273/273 - 7s - loss: 2.8612 - accuracy10: 0.5360 - val_loss: 3.2715 - val_accuracy10: 0.5175 - 7s/epoch - 24ms/step
Epoch 22/50
273/273 - 7s - loss: 2.8436 - accuracy10: 0.5380 - val_loss: 3.2627 - val_accuracy10: 0.5119 - 7s/epoch - 24ms/step
Epoch 23/50
273/273 - 7s - loss: 2.8311 - accuracy10: 0.5405 - val_loss: 3.2707 - val_accuracy10: 0.5130 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepOF_L2/h10
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.058116
{'0': {'precision': 0.4624505928853755, 'recall': 0.32938893624657906, 'f1-score': 0.38473984501405095, 'support': 89156}, '1': {'precision': 0.4674003610609638, 'recall': 0.693247237412591, 'f1-score': 0.5583503718050273, 'support': 97101}, '2': {'precision': 0.4754828191622774, 'recall': 0.3566037292200616, 'f1-score': 0.40755122606650995, 'support': 85058}, 'accuracy': 0.46814219634004756, 'macro avg': {'precision': 0.4684445910362056, 'recall': 0.4597466342930772, 'f1-score': 0.4502138142951961, 'support': 271315}, 'weighted avg': {'precision': 0.46830770562252055, 'recall': 0.46814219634004756, 'f1-score': 0.45402479502230947, 'support': 271315}}
[[29367 40565 19224]
 [15550 67315 14236]
 [18586 36140 30332]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9728581
{'0': {'precision': 0.46894689468946893, 'recall': 0.3130667540697039, 'f1-score': 0.37547089461787925, 'support': 18306}, '1': {'precision': 0.5701326525960706, 'recall': 0.7606276226965882, 'f1-score': 0.651745700885878, 'support': 32886}, '2': {'precision': 0.4726294850069992, 'recall': 0.347207187702966, 'f1-score': 0.40032450310462103, 'support': 18476}, 'accuracy': 0.5333869208244818, 'macro avg': {'precision': 0.5039030107641796, 'recall': 0.47363385482308606, 'f1-score': 0.47584703286945945, 'support': 69668}, 'weighted avg': {'precision': 0.5176871251141, 'recall': 0.5333869208244818, 'f1-score': 0.512474519658507, 'support': 69668}}
[[ 5731  9508  3067]
 [ 3781 25014  4091]
 [ 2709  9352  6415]]
Evaluating performance on  val set...
96/96 - 1s - 921ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9954098
{'0': {'precision': 0.4567032967032967, 'recall': 0.3069423929098966, 'f1-score': 0.3671378091872791, 'support': 6770}, '1': {'precision': 0.5573541167066347, 'recall': 0.7445937527809914, 'f1-score': 0.637510000380967, 'support': 11237}, '2': {'precision': 0.4517108726462847, 'recall': 0.3435478903603326, 'f1-score': 0.3902737689145457, 'support': 6494}, 'accuracy': 0.5173666380964043, 'macro avg': {'precision': 0.48858942868540534, 'recall': 0.46502801201707356, 'f1-score': 0.4649738594942639, 'support': 24501}, 'weighted avg': {'precision': 0.501541975228715, 'recall': 0.5173666380964043, 'f1-score': 0.49727197656462446, 'support': 24501}}
[[2078 3439 1253]
 [1415 8367 1455]
 [1057 3206 2231]]
training model: results/LILAK/W5/deepOF_L2/h20
Epoch 1/50
273/273 - 9s - loss: 3.2998 - accuracy20: 0.3764 - val_loss: 3.3739 - val_accuracy20: 0.3938 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2575 - accuracy20: 0.3990 - val_loss: 3.3426 - val_accuracy20: 0.4043 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2257 - accuracy20: 0.4147 - val_loss: 3.3298 - val_accuracy20: 0.4079 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2020 - accuracy20: 0.4256 - val_loss: 3.3104 - val_accuracy20: 0.4141 - 7s/epoch - 24ms/step
Epoch 5/50
273/273 - 7s - loss: 3.1828 - accuracy20: 0.4326 - val_loss: 3.3190 - val_accuracy20: 0.4171 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.1663 - accuracy20: 0.4417 - val_loss: 3.3030 - val_accuracy20: 0.4250 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.1502 - accuracy20: 0.4454 - val_loss: 3.2893 - val_accuracy20: 0.4311 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.1356 - accuracy20: 0.4517 - val_loss: 3.2889 - val_accuracy20: 0.4344 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.1227 - accuracy20: 0.4577 - val_loss: 3.3200 - val_accuracy20: 0.4301 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.1049 - accuracy20: 0.4643 - val_loss: 3.3227 - val_accuracy20: 0.4331 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.0949 - accuracy20: 0.4668 - val_loss: 3.2905 - val_accuracy20: 0.4386 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.0785 - accuracy20: 0.4751 - val_loss: 3.3171 - val_accuracy20: 0.4370 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.0635 - accuracy20: 0.4794 - val_loss: 3.2896 - val_accuracy20: 0.4469 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.0508 - accuracy20: 0.4846 - val_loss: 3.2957 - val_accuracy20: 0.4467 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.0371 - accuracy20: 0.4890 - val_loss: 3.2824 - val_accuracy20: 0.4483 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.0262 - accuracy20: 0.4919 - val_loss: 3.3097 - val_accuracy20: 0.4478 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.0120 - accuracy20: 0.4968 - val_loss: 3.2958 - val_accuracy20: 0.4512 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 2.9973 - accuracy20: 0.5022 - val_loss: 3.2683 - val_accuracy20: 0.4560 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 2.9819 - accuracy20: 0.5071 - val_loss: 3.2617 - val_accuracy20: 0.4568 - 7s/epoch - 25ms/step
Epoch 20/50
273/273 - 7s - loss: 2.9677 - accuracy20: 0.5114 - val_loss: 3.2580 - val_accuracy20: 0.4570 - 7s/epoch - 25ms/step
Epoch 21/50
273/273 - 7s - loss: 2.9571 - accuracy20: 0.5133 - val_loss: 3.2667 - val_accuracy20: 0.4586 - 7s/epoch - 24ms/step
Epoch 22/50
273/273 - 7s - loss: 2.9382 - accuracy20: 0.5201 - val_loss: 3.2634 - val_accuracy20: 0.4602 - 7s/epoch - 24ms/step
Epoch 23/50
273/273 - 7s - loss: 2.9281 - accuracy20: 0.5219 - val_loss: 3.2806 - val_accuracy20: 0.4620 - 7s/epoch - 25ms/step
Epoch 24/50
273/273 - 7s - loss: 2.9125 - accuracy20: 0.5288 - val_loss: 3.2602 - val_accuracy20: 0.4620 - 7s/epoch - 24ms/step
Epoch 25/50
273/273 - 7s - loss: 2.8997 - accuracy20: 0.5295 - val_loss: 3.2710 - val_accuracy20: 0.4585 - 7s/epoch - 24ms/step
Epoch 26/50
273/273 - 7s - loss: 2.8824 - accuracy20: 0.5362 - val_loss: 3.3108 - val_accuracy20: 0.4601 - 7s/epoch - 24ms/step
Epoch 27/50
273/273 - 7s - loss: 2.8715 - accuracy20: 0.5393 - val_loss: 3.3097 - val_accuracy20: 0.4603 - 7s/epoch - 24ms/step
Epoch 28/50
273/273 - 7s - loss: 2.8523 - accuracy20: 0.5439 - val_loss: 3.3543 - val_accuracy20: 0.4583 - 7s/epoch - 24ms/step
Epoch 29/50
273/273 - 7s - loss: 2.8332 - accuracy20: 0.5473 - val_loss: 3.3332 - val_accuracy20: 0.4628 - 7s/epoch - 24ms/step
Epoch 30/50
273/273 - 7s - loss: 2.8194 - accuracy20: 0.5543 - val_loss: 3.3630 - val_accuracy20: 0.4553 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h20
Evaluating performance on  test set...
1060/1060 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1015397
{'0': {'precision': 0.4784237791077805, 'recall': 0.37020100795859195, 'f1-score': 0.41741171824434764, 'support': 102782}, '1': {'precision': 0.36948791507051687, 'recall': 0.5995957906474318, 'f1-score': 0.45722242003284247, 'support': 71745}, '2': {'precision': 0.4799421420704115, 'recall': 0.3736723560771997, 'f1-score': 0.42019227976415235, 'support': 96788}, 'accuracy': 0.4320992204632991, 'macro avg': {'precision': 0.4426179454162363, 'recall': 0.44782305156107455, 'f1-score': 0.4316088060137808, 'support': 271315}, 'weighted avg': {'precision': 0.45015905267936207, 'recall': 0.4320992204632991, 'f1-score': 0.42893096262152697, 'support': 271315}}
[[38050 39516 25216]
 [14753 43018 13974]
 [26729 33892 36167]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0161718
{'0': {'precision': 0.5083045658828893, 'recall': 0.35547052928851236, 'f1-score': 0.4183665263891495, 'support': 21954}, '1': {'precision': 0.48951612903225805, 'recall': 0.7117451631815517, 'f1-score': 0.5800748586445807, 'support': 25585}, '2': {'precision': 0.5047034764826176, 'recall': 0.3903475077952009, 'f1-score': 0.4402201610437264, 'support': 22129}, 'accuracy': 0.49738760980651087, 'macro avg': {'precision': 0.5008413904659217, 'recall': 0.48585440008842157, 'f1-score': 0.4795538486924856, 'support': 69668}, 'weighted avg': {'precision': 0.5002608346983854, 'recall': 0.49738760980651087, 'f1-score': 0.48469406215917793, 'support': 69668}}
[[ 7804  9671  4479]
 [ 3377 18210  3998]
 [ 4172  9319  8638]]
Evaluating performance on  val set...
96/96 - 1s - 905ms/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0678318
{'0': {'precision': 0.46822682268226823, 'recall': 0.32471910112359553, 'f1-score': 0.3834869148544047, 'support': 8010}, '1': {'precision': 0.4626631032856469, 'recall': 0.6661385242191037, 'f1-score': 0.5460617868076817, 'support': 8836}, '2': {'precision': 0.4389460154241645, 'recall': 0.35689092096668845, 'f1-score': 0.39368830607392463, 'support': 7655}, 'accuracy': 0.45789967756418104, 'macro avg': {'precision': 0.4566119804640265, 'recall': 0.4492495154364626, 'f1-score': 0.4410790025786704, 'support': 24501}, 'weighted avg': {'precision': 0.45707194720170297, 'recall': 0.45789967756418104, 'f1-score': 0.4453049311951492, 'support': 24501}}
[[2601 3505 1904]
 [1362 5886 1588]
 [1592 3331 2732]]
training model: results/LILAK/W5/deepOF_L2/h30
Epoch 1/50
273/273 - 8s - loss: 3.3063 - accuracy30: 0.3685 - val_loss: 3.3885 - val_accuracy30: 0.3598 - 8s/epoch - 31ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2735 - accuracy30: 0.3855 - val_loss: 3.3740 - val_accuracy30: 0.3673 - 7s/epoch - 24ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2438 - accuracy30: 0.3995 - val_loss: 3.3657 - val_accuracy30: 0.3711 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2228 - accuracy30: 0.4117 - val_loss: 3.3552 - val_accuracy30: 0.3728 - 7s/epoch - 24ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2075 - accuracy30: 0.4176 - val_loss: 3.3555 - val_accuracy30: 0.3789 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.1943 - accuracy30: 0.4245 - val_loss: 3.3307 - val_accuracy30: 0.3866 - 7s/epoch - 24ms/step
Epoch 7/50
273/273 - 7s - loss: 3.1796 - accuracy30: 0.4304 - val_loss: 3.3342 - val_accuracy30: 0.3866 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.1697 - accuracy30: 0.4351 - val_loss: 3.3379 - val_accuracy30: 0.3870 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.1575 - accuracy30: 0.4415 - val_loss: 3.3342 - val_accuracy30: 0.3897 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.1476 - accuracy30: 0.4438 - val_loss: 3.3325 - val_accuracy30: 0.3940 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.1354 - accuracy30: 0.4509 - val_loss: 3.3591 - val_accuracy30: 0.3951 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1233 - accuracy30: 0.4571 - val_loss: 3.3764 - val_accuracy30: 0.3908 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1116 - accuracy30: 0.4598 - val_loss: 3.3432 - val_accuracy30: 0.4000 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1017 - accuracy30: 0.4642 - val_loss: 3.3644 - val_accuracy30: 0.3991 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.0892 - accuracy30: 0.4681 - val_loss: 3.3574 - val_accuracy30: 0.4041 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.0769 - accuracy30: 0.4729 - val_loss: 3.3623 - val_accuracy30: 0.4058 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepOF_L2/h30
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1372558
{'0': {'precision': 0.4652183122030924, 'recall': 0.14491729110702672, 'f1-score': 0.2209940780773875, 'support': 106095}, '1': {'precision': 0.28490358126721765, 'recall': 0.7183496434414842, 'f1-score': 0.40799347757478, 'support': 64786}, '2': {'precision': 0.4448849377969993, 'recall': 0.3318497719895653, 'f1-score': 0.3801425719988594, 'support': 100434}, 'accuracy': 0.3510421465823858, 'macro avg': {'precision': 0.3983356104224364, 'recall': 0.398372235512692, 'f1-score': 0.33637670921700896, 'support': 271315}, 'weighted avg': {'precision': 0.414634922845655, 'recall': 0.3510421465823858, 'f1-score': 0.3245595386466416, 'support': 271315}}
[[15375 61553 29167]
 [ 5827 46539 12420]
 [11847 55258 33329]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.105585
{'0': {'precision': 0.483937989451814, 'recall': 0.12978996999571368, 'f1-score': 0.2046844898097137, 'support': 23330}, '1': {'precision': 0.3700060350030175, 'recall': 0.8045227889073572, 'f1-score': 0.5068897095298462, 'support': 22862}, '2': {'precision': 0.4316473250127728, 'recall': 0.2519168512523428, 'f1-score': 0.31815369717836295, 'support': 23476}, 'accuracy': 0.3923609117528851, 'macro avg': {'precision': 0.4285304498225348, 'recall': 0.39540987005180456, 'f1-score': 0.34324263217264095, 'support': 69668}, 'weighted avg': {'precision': 0.42893012384666795, 'recall': 0.3923609117528851, 'f1-score': 0.34209074297369263, 'support': 69668}}
[[ 3028 15666  4636]
 [ 1318 18393  3151]
 [ 1911 15651  5914]]
Evaluating performance on  val set...
96/96 - 1s - 928ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.11369
{'0': {'precision': 0.4584760273972603, 'recall': 0.1276824034334764, 'f1-score': 0.19973890339425585, 'support': 8388}, '1': {'precision': 0.3677671488567429, 'recall': 0.7874359935056825, 'f1-score': 0.5013717148423522, 'support': 8007}, '2': {'precision': 0.40151364270065726, 'recall': 0.24870466321243523, 'f1-score': 0.30715319570351185, 'support': 8106}, 'accuracy': 0.383331292600302, 'macro avg': {'precision': 0.4092522729848868, 'recall': 0.3879410200505314, 'f1-score': 0.33608793798003994, 'support': 24501}, 'weighted avg': {'precision': 0.40998645224422214, 'recall': 0.383331292600302, 'f1-score': 0.33385074269566134, 'support': 24501}}
[[1071 5464 1853]
 [ 550 6305 1152]
 [ 715 5375 2016]]
training model: results/LILAK/W5/deepOF_L2/h50
Epoch 1/50
273/273 - 9s - loss: 3.3266 - accuracy50: 0.3545 - val_loss: 3.4176 - val_accuracy50: 0.3431 - 9s/epoch - 32ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3030 - accuracy50: 0.3636 - val_loss: 3.4089 - val_accuracy50: 0.3431 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2799 - accuracy50: 0.3763 - val_loss: 3.4001 - val_accuracy50: 0.3461 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2644 - accuracy50: 0.3814 - val_loss: 3.3953 - val_accuracy50: 0.3460 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2526 - accuracy50: 0.3920 - val_loss: 3.3917 - val_accuracy50: 0.3492 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2409 - accuracy50: 0.3953 - val_loss: 3.3861 - val_accuracy50: 0.3513 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2301 - accuracy50: 0.4070 - val_loss: 3.3843 - val_accuracy50: 0.3525 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2226 - accuracy50: 0.4104 - val_loss: 3.3814 - val_accuracy50: 0.3532 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2124 - accuracy50: 0.4157 - val_loss: 3.3869 - val_accuracy50: 0.3541 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2033 - accuracy50: 0.4224 - val_loss: 3.3938 - val_accuracy50: 0.3544 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.1966 - accuracy50: 0.4244 - val_loss: 3.4112 - val_accuracy50: 0.3551 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1871 - accuracy50: 0.4314 - val_loss: 3.4222 - val_accuracy50: 0.3550 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1783 - accuracy50: 0.4328 - val_loss: 3.4327 - val_accuracy50: 0.3579 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1696 - accuracy50: 0.4375 - val_loss: 3.4489 - val_accuracy50: 0.3535 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.1617 - accuracy50: 0.4424 - val_loss: 3.4478 - val_accuracy50: 0.3575 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.1525 - accuracy50: 0.4461 - val_loss: 3.4406 - val_accuracy50: 0.3595 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.1427 - accuracy50: 0.4489 - val_loss: 3.4527 - val_accuracy50: 0.3616 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 3.1328 - accuracy50: 0.4544 - val_loss: 3.4459 - val_accuracy50: 0.3621 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h50
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1572182
{'0': {'precision': 0.4361928904764648, 'recall': 0.07440128145913384, 'f1-score': 0.12711978239699118, 'support': 101759}, '1': {'precision': 0.2751759433894005, 'recall': 0.8115024609519474, 'f1-score': 0.4109881163795122, 'support': 70298}, '2': {'precision': 0.41871931742662977, 'recall': 0.19678010840436036, 'f1-score': 0.267735855522429, 'support': 99258}, 'accuracy': 0.3101560916278127, 'macro avg': {'precision': 0.37669605043083165, 'recall': 0.3608946169384806, 'f1-score': 0.2686145847663108, 'support': 271315}, 'weighted avg': {'precision': 0.3880806915191386, 'recall': 0.3101560916278127, 'f1-score': 0.25211341094162737, 'support': 271315}}
[[ 7571 76860 17328]
 [ 3464 57047  9787]
 [ 6322 73404 19532]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.122751
{'0': {'precision': 0.48447789275634995, 'recall': 0.06608212147134303, 'f1-score': 0.1163009522375701, 'support': 23380}, '1': {'precision': 0.3472183828610919, 'recall': 0.874124657474664, 'f1-score': 0.49701376265904956, 'support': 22991}, '2': {'precision': 0.4216769391789743, 'recall': 0.15564235738507104, 'f1-score': 0.22736393278154002, 'support': 23297}, 'accuracy': 0.3626916231268301, 'macro avg': {'precision': 0.41779107159880535, 'recall': 0.36528304544369267, 'f1-score': 0.2802262158927199, 'support': 69668}, 'weighted avg': {'precision': 0.41818049355594233, 'recall': 0.3626916231268301, 'f1-score': 0.27907873374605463, 'support': 69668}}
[[ 1545 18988  2847]
 [  768 20097  2126]
 [  876 18795  3626]]
Evaluating performance on  val set...
96/96 - 1s - 894ms/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1291708
{'0': {'precision': 0.4263959390862944, 'recall': 0.060722891566265064, 'f1-score': 0.10630668635309007, 'support': 8300}, '1': {'precision': 0.3428029357431724, 'recall': 0.8546178740353497, 'f1-score': 0.4893275843637529, 'support': 8034}, '2': {'precision': 0.3945288753799392, 'recall': 0.1589322884780213, 'f1-score': 0.2265863664135463, 'support': 8167}, 'accuracy': 0.3537814783070079, 'macro avg': {'precision': 0.387909250069802, 'recall': 0.35809101802654536, 'f1-score': 0.27407354571012976, 'support': 24501}, 'weighted avg': {'precision': 0.38836302213807006, 'recall': 0.3537814783070079, 'f1-score': 0.2719943742707837, 'support': 24501}}
[[ 504 6651 1145]
 [ 321 6866  847]
 [ 357 6512 1298]]
training model: results/LILAK/W5/deepOF_L2/h100
Epoch 1/50
273/273 - 9s - loss: 3.3444 - accuracy100: 0.3444 - val_loss: 3.3364 - val_accuracy100: 0.3272 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3171 - accuracy100: 0.3542 - val_loss: 3.3217 - val_accuracy100: 0.3258 - 7s/epoch - 24ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2980 - accuracy100: 0.3633 - val_loss: 3.3149 - val_accuracy100: 0.3311 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2847 - accuracy100: 0.3727 - val_loss: 3.3100 - val_accuracy100: 0.3355 - 7s/epoch - 24ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2768 - accuracy100: 0.3771 - val_loss: 3.3041 - val_accuracy100: 0.3382 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2681 - accuracy100: 0.3853 - val_loss: 3.3010 - val_accuracy100: 0.3386 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2624 - accuracy100: 0.3885 - val_loss: 3.3043 - val_accuracy100: 0.3398 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2585 - accuracy100: 0.3906 - val_loss: 3.2978 - val_accuracy100: 0.3448 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2521 - accuracy100: 0.3959 - val_loss: 3.2962 - val_accuracy100: 0.3462 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2436 - accuracy100: 0.4017 - val_loss: 3.2982 - val_accuracy100: 0.3508 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2406 - accuracy100: 0.4014 - val_loss: 3.2967 - val_accuracy100: 0.3473 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2334 - accuracy100: 0.4060 - val_loss: 3.3004 - val_accuracy100: 0.3501 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2278 - accuracy100: 0.4095 - val_loss: 3.3001 - val_accuracy100: 0.3524 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.2191 - accuracy100: 0.4130 - val_loss: 3.3017 - val_accuracy100: 0.3543 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 3.2129 - accuracy100: 0.4160 - val_loss: 3.3090 - val_accuracy100: 0.3511 - 7s/epoch - 25ms/step
Epoch 16/50
273/273 - 7s - loss: 3.2067 - accuracy100: 0.4192 - val_loss: 3.3098 - val_accuracy100: 0.3534 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.1977 - accuracy100: 0.4227 - val_loss: 3.3120 - val_accuracy100: 0.3543 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 3.1869 - accuracy100: 0.4303 - val_loss: 3.3218 - val_accuracy100: 0.3579 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 3.1825 - accuracy100: 0.4329 - val_loss: 3.3307 - val_accuracy100: 0.3532 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h100
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093172
{'0': {'precision': 0.4053371344026848, 'recall': 0.22517691397871017, 'f1-score': 0.28951794263768693, 'support': 99766}, '1': {'precision': 0.2801240623590977, 'recall': 0.5758746120247742, 'f1-score': 0.3769079101575965, 'support': 71203}, '2': {'precision': 0.39807808499007397, 'recall': 0.27576585015845173, 'f1-score': 0.32582126457082305, 'support': 100346}, 'accuracy': 0.3359231889132558, 'macro avg': {'precision': 0.3611797605839522, 'recall': 0.35893912538731204, 'f1-score': 0.3307490391220355, 'support': 271315}, 'weighted avg': {'precision': 0.36979187173354605, 'recall': 0.3359231889132558, 'f1-score': 0.3258790763753078, 'support': 271315}}
[[22465 52681 24620]
 [12977 41004 17222]
 [19981 52693 27672]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0886096
{'0': {'precision': 0.4251512096774194, 'recall': 0.21396862977212194, 'f1-score': 0.28466968529403497, 'support': 23653}, '1': {'precision': 0.3474722564734895, 'recall': 0.6129551485622309, 'f1-score': 0.4435210979429309, 'support': 22987}, '2': {'precision': 0.4056581851980946, 'recall': 0.30323953447976376, 'f1-score': 0.3470503454102679, 'support': 23028}, 'accuracy': 0.3751220072343113, 'macro avg': {'precision': 0.3927605504496678, 'recall': 0.37672110427137223, 'f1-score': 0.358413709549078, 'support': 69668}, 'weighted avg': {'precision': 0.3930777833553113, 'recall': 0.3751220072343113, 'f1-score': 0.35770205688094403, 'support': 69668}}
[[ 5061 13552  5040]
 [ 3706 14090  5191]
 [ 3137 12908  6983]]
Evaluating performance on  val set...
96/96 - 1s - 890ms/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100283
{'0': {'precision': 0.4092134831460674, 'recall': 0.20761600729677346, 'f1-score': 0.2754708418425233, 'support': 8771}, '1': {'precision': 0.3036553141514974, 'recall': 0.5682692307692307, 'f1-score': 0.3958094144661309, 'support': 7280}, '2': {'precision': 0.39629687256885016, 'recall': 0.30142011834319526, 'f1-score': 0.3424077434966727, 'support': 8450}, 'accuracy': 0.3471286886249541, 'macro avg': {'precision': 0.36972188995547167, 'recall': 0.35910178546973315, 'f1-score': 0.337895999935109, 'support': 24501}, 'weighted avg': {'precision': 0.37339417660111185, 'recall': 0.3471286886249541, 'f1-score': 0.3343125882070564, 'support': 24501}}
[[1821 4875 2075]
 [1338 4137 1805]
 [1291 4612 2547]]
training model: results/LILAK/W5/deepOF_L2/h200
Epoch 1/50
273/273 - 8s - loss: 3.3450 - accuracy200: 0.3374 - val_loss: 3.3248 - val_accuracy200: 0.3268 - 8s/epoch - 31ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3209 - accuracy200: 0.3421 - val_loss: 3.3186 - val_accuracy200: 0.3230 - 7s/epoch - 24ms/step
Epoch 3/50
273/273 - 7s - loss: 3.3026 - accuracy200: 0.3503 - val_loss: 3.3143 - val_accuracy200: 0.3212 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2923 - accuracy200: 0.3580 - val_loss: 3.3129 - val_accuracy200: 0.3195 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2860 - accuracy200: 0.3643 - val_loss: 3.3064 - val_accuracy200: 0.3283 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2801 - accuracy200: 0.3715 - val_loss: 3.3060 - val_accuracy200: 0.3282 - 7s/epoch - 24ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2730 - accuracy200: 0.3735 - val_loss: 3.3026 - val_accuracy200: 0.3330 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2685 - accuracy200: 0.3786 - val_loss: 3.3013 - val_accuracy200: 0.3385 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2631 - accuracy200: 0.3843 - val_loss: 3.3011 - val_accuracy200: 0.3375 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2576 - accuracy200: 0.3877 - val_loss: 3.3041 - val_accuracy200: 0.3344 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2516 - accuracy200: 0.3904 - val_loss: 3.3006 - val_accuracy200: 0.3461 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2480 - accuracy200: 0.3936 - val_loss: 3.3022 - val_accuracy200: 0.3435 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2409 - accuracy200: 0.4005 - val_loss: 3.3070 - val_accuracy200: 0.3461 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.2351 - accuracy200: 0.4007 - val_loss: 3.3047 - val_accuracy200: 0.3492 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 3.2308 - accuracy200: 0.4053 - val_loss: 3.3108 - val_accuracy200: 0.3473 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.2227 - accuracy200: 0.4098 - val_loss: 3.3108 - val_accuracy200: 0.3506 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.2195 - accuracy200: 0.4122 - val_loss: 3.3131 - val_accuracy200: 0.3509 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 3.2117 - accuracy200: 0.4146 - val_loss: 3.3138 - val_accuracy200: 0.3552 - 7s/epoch - 25ms/step
Epoch 19/50
273/273 - 7s - loss: 3.2021 - accuracy200: 0.4194 - val_loss: 3.3256 - val_accuracy200: 0.3500 - 7s/epoch - 25ms/step
Epoch 20/50
273/273 - 7s - loss: 3.1969 - accuracy200: 0.4216 - val_loss: 3.3332 - val_accuracy200: 0.3496 - 7s/epoch - 24ms/step
Epoch 21/50
273/273 - 7s - loss: 3.1904 - accuracy200: 0.4253 - val_loss: 3.3324 - val_accuracy200: 0.3498 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepOF_L2/h200
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1110408
{'0': {'precision': 0.35813535037153044, 'recall': 0.23587503977702917, 'f1-score': 0.2844232741225894, 'support': 91133}, '1': {'precision': 0.30437782282442477, 'recall': 0.5302127343236981, 'f1-score': 0.38674053121017954, 'support': 80711}, '2': {'precision': 0.37954397578432203, 'recall': 0.26975701460727247, 'f1-score': 0.3153688392127826, 'support': 99471}, 'accuracy': 0.33585684536424454, 'macro avg': {'precision': 0.34735238299342575, 'recall': 0.3452815962359999, 'f1-score': 0.32884421484851717, 'support': 271315}, 'weighted avg': {'precision': 0.34999246690611696, 'recall': 0.33585684536424454, 'f1-score': 0.3262061259438418, 'support': 271315}}
[[21496 46763 22874]
 [16926 42794 20991]
 [21600 51038 26833]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907342
{'0': {'precision': 0.43055342633757476, 'recall': 0.2307344725599737, 'f1-score': 0.3004546670232683, 'support': 24344}, '1': {'precision': 0.3391742195367573, 'recall': 0.5325983825057606, 'f1-score': 0.4144283504429757, 'support': 22133}, '2': {'precision': 0.38880504870352584, 'recall': 0.3666077357595619, 'f1-score': 0.37738026543566067, 'support': 23191}, 'accuracy': 0.37186369638858585, 'macro avg': {'precision': 0.386177564859286, 'recall': 0.3766468636084321, 'f1-score': 0.3640877609673015, 'support': 69668}, 'weighted avg': {'precision': 0.3876257894047832, 'recall': 0.37186369638858585, 'f1-score': 0.3622701502854571, 'support': 69668}}
[[ 5617 11996  6731]
 [ 3711 11788  6634]
 [ 3718 10971  8502]]
Evaluating performance on  val set...
96/96 - 1s - 998ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1058817
{'0': {'precision': 0.4031166700840681, 'recall': 0.218784776318718, 'f1-score': 0.28363269133665153, 'support': 8986}, '1': {'precision': 0.29129427341939756, 'recall': 0.5012103089847644, 'f1-score': 0.3684513529073115, 'support': 7023}, '2': {'precision': 0.38620689655172413, 'recall': 0.34291097503532736, 'f1-score': 0.36327345309381237, 'support': 8492}, 'accuracy': 0.3427615199379617, 'macro avg': {'precision': 0.3602059466850633, 'recall': 0.3543020201129366, 'f1-score': 0.33845249911259184, 'support': 24501}, 'weighted avg': {'precision': 0.36520285070475106, 'recall': 0.3427615199379617, 'f1-score': 0.33554856452764603, 'support': 24501}}
[[1966 4469 2551]
 [1426 3520 2077]
 [1485 4095 2912]]
training model: results/LILAK/W5/deepOF_L2/h300
Epoch 1/50
273/273 - 8s - loss: 3.3450 - accuracy300: 0.3436 - val_loss: 3.3057 - val_accuracy300: 0.3515 - 8s/epoch - 31ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3144 - accuracy300: 0.3535 - val_loss: 3.2939 - val_accuracy300: 0.3565 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.3020 - accuracy300: 0.3591 - val_loss: 3.2932 - val_accuracy300: 0.3526 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2914 - accuracy300: 0.3637 - val_loss: 3.2893 - val_accuracy300: 0.3570 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2857 - accuracy300: 0.3672 - val_loss: 3.2835 - val_accuracy300: 0.3610 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2786 - accuracy300: 0.3709 - val_loss: 3.2821 - val_accuracy300: 0.3653 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2746 - accuracy300: 0.3765 - val_loss: 3.2808 - val_accuracy300: 0.3688 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2694 - accuracy300: 0.3791 - val_loss: 3.2853 - val_accuracy300: 0.3645 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2648 - accuracy300: 0.3818 - val_loss: 3.2849 - val_accuracy300: 0.3655 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2606 - accuracy300: 0.3854 - val_loss: 3.2835 - val_accuracy300: 0.3705 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2552 - accuracy300: 0.3904 - val_loss: 3.2841 - val_accuracy300: 0.3706 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2493 - accuracy300: 0.3943 - val_loss: 3.2874 - val_accuracy300: 0.3695 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2459 - accuracy300: 0.3967 - val_loss: 3.2889 - val_accuracy300: 0.3691 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.2411 - accuracy300: 0.3992 - val_loss: 3.2906 - val_accuracy300: 0.3715 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.2358 - accuracy300: 0.4010 - val_loss: 3.2953 - val_accuracy300: 0.3719 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.2279 - accuracy300: 0.4070 - val_loss: 3.2915 - val_accuracy300: 0.3726 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.2218 - accuracy300: 0.4099 - val_loss: 3.3018 - val_accuracy300: 0.3741 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h300
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055145
{'0': {'precision': 0.34228714728429294, 'recall': 0.3772950985459694, 'f1-score': 0.35893954781121384, 'support': 88994}, '1': {'precision': 0.27158461768666764, 'recall': 0.04388828436706565, 'f1-score': 0.07556517756775885, 'support': 82710}, '2': {'precision': 0.36481642509055195, 'recall': 0.5854473903484555, 'f1-score': 0.4495190084173527, 'support': 99611}, 'accuracy': 0.3520778430975066, 'macro avg': {'precision': 0.3262293966871708, 'recall': 0.33554359108716353, 'f1-score': 0.29467457793210844, 'support': 271315}, 'weighted avg': {'precision': 0.3290050127489362, 'recall': 0.3520778430975066, 'f1-score': 0.3058087459300128, 'support': 271315}}
[[33577  4417 51000]
 [28544  3630 50536]
 [35975  5319 58317]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994574
{'0': {'precision': 0.3896038238808714, 'recall': 0.3517427385892116, 'f1-score': 0.3697064852370361, 'support': 24100}, '1': {'precision': 0.4004032258064516, 'recall': 0.04349921149465569, 'f1-score': 0.07847321005215743, 'support': 22828}, '2': {'precision': 0.3472154963680387, 'recall': 0.6936675461741425, 'f1-score': 0.46278421593076124, 'support': 22740}, 'accuracy': 0.36234713211230407, 'macro avg': {'precision': 0.37907418201845394, 'recall': 0.3629698320860033, 'f1-score': 0.30365463707331825, 'support': 69668}, 'weighted avg': {'precision': 0.3793066742499839, 'recall': 0.36234713211230407, 'f1-score': 0.304659611350243, 'support': 69668}}
[[ 8477   774 14849]
 [ 7028   993 14807]
 [ 6253   713 15774]]
Evaluating performance on  val set...
96/96 - 1s - 915ms/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0958714
{'0': {'precision': 0.3937059284408462, 'recall': 0.324298160696999, 'f1-score': 0.35564730168092007, 'support': 9297}, '1': {'precision': 0.265, 'recall': 0.0394227908360607, 'f1-score': 0.06863506863506863, 'support': 6722}, '2': {'precision': 0.35826548002272296, 'recall': 0.6691817967460505, 'f1-score': 0.4666803699897225, 'support': 8482}, 'accuracy': 0.3655361005673238, 'macro avg': {'precision': 0.3389904694878563, 'recall': 0.34430091609303676, 'f1-score': 0.29698758010190374, 'support': 24501}, 'weighted avg': {'precision': 0.3461255384787267, 'recall': 0.3655361005673238, 'f1-score': 0.31534226330946785, 'support': 24501}}
[[3015  401 5881]
 [2171  265 4286]
 [2472  334 5676]]
training model: results/LILAK/W5/deepOF_L2/h500
Epoch 1/50
273/273 - 9s - loss: 3.3438 - accuracy500: 0.3402 - val_loss: 3.3612 - val_accuracy500: 0.3212 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3242 - accuracy500: 0.3430 - val_loss: 3.3454 - val_accuracy500: 0.3232 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.3072 - accuracy500: 0.3517 - val_loss: 3.3388 - val_accuracy500: 0.3234 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2960 - accuracy500: 0.3584 - val_loss: 3.3371 - val_accuracy500: 0.3260 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2906 - accuracy500: 0.3617 - val_loss: 3.3317 - val_accuracy500: 0.3286 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2839 - accuracy500: 0.3626 - val_loss: 3.3318 - val_accuracy500: 0.3225 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2784 - accuracy500: 0.3686 - val_loss: 3.3296 - val_accuracy500: 0.3235 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2734 - accuracy500: 0.3729 - val_loss: 3.3344 - val_accuracy500: 0.3258 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2676 - accuracy500: 0.3766 - val_loss: 3.3316 - val_accuracy500: 0.3256 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2634 - accuracy500: 0.3800 - val_loss: 3.3329 - val_accuracy500: 0.3265 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2573 - accuracy500: 0.3839 - val_loss: 3.3368 - val_accuracy500: 0.3266 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2517 - accuracy500: 0.3872 - val_loss: 3.3365 - val_accuracy500: 0.3268 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2463 - accuracy500: 0.3902 - val_loss: 3.3371 - val_accuracy500: 0.3277 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.2433 - accuracy500: 0.3914 - val_loss: 3.3383 - val_accuracy500: 0.3280 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 3.2369 - accuracy500: 0.3964 - val_loss: 3.3451 - val_accuracy500: 0.3279 - 7s/epoch - 25ms/step
Epoch 16/50
273/273 - 7s - loss: 3.2290 - accuracy500: 0.4010 - val_loss: 3.3499 - val_accuracy500: 0.3248 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.2245 - accuracy500: 0.4045 - val_loss: 3.3531 - val_accuracy500: 0.3299 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h500
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028682
{'0': {'precision': 0.32736071548898893, 'recall': 0.12532833020637899, 'f1-score': 0.18126160655987925, 'support': 85280}, '1': {'precision': 0.3343108504398827, 'recall': 0.3935631873692733, 'f1-score': 0.36152531080041117, 'support': 88926}, '2': {'precision': 0.35550347442509644, 'recall': 0.49047977015518646, 'f1-score': 0.41222391469916225, 'support': 97109}, 'accuracy': 0.3439397010854542, 'macro avg': {'precision': 0.339058346784656, 'recall': 0.33645709591027956, 'f1-score': 0.31833694401981755, 'support': 271315}, 'weighted avg': {'precision': 0.3397115360413714, 'recall': 0.3439397010854542, 'f1-score': 0.3230106766237945, 'support': 271315}}
[[10688 32371 42221]
 [ 9800 34998 44128]
 [12161 37318 47630]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0980767
{'0': {'precision': 0.42075218267293485, 'recall': 0.10537381212681861, 'f1-score': 0.16853857017956825, 'support': 23782}, '1': {'precision': 0.36678253562015356, 'recall': 0.4022959611194905, 'f1-score': 0.3837193038543769, 'support': 23868}, '2': {'precision': 0.33674366557429464, 'recall': 0.5740303388136979, 'f1-score': 0.4244764991351951, 'support': 22018}, 'accuracy': 0.3552132973531607, 'macro avg': {'precision': 0.3747594612891277, 'recall': 0.3605667040200024, 'f1-score': 0.3255781243897134, 'support': 69668}, 'weighted avg': {'precision': 0.37571217771608745, 'recall': 0.3552132973531607, 'f1-score': 0.3231457796745347, 'support': 69668}}
[[ 2506  8809 12467]
 [ 1839  9602 12427]
 [ 1611  7768 12639]]
Evaluating performance on  val set...
96/96 - 1s - 903ms/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1113541
{'0': {'precision': 0.36354728074473297, 'recall': 0.08258208124652199, 'f1-score': 0.1345909668057319, 'support': 8985}, '1': {'precision': 0.29889378154870583, 'recall': 0.37745829377458295, 'f1-score': 0.3336130424358667, 'support': 7373}, '2': {'precision': 0.33432200167313103, 'recall': 0.5398501780670515, 'f1-score': 0.41292504226939697, 'support': 8143}, 'accuracy': 0.3232929268193135, 'macro avg': {'precision': 0.3322543546555233, 'recall': 0.3332968510293855, 'f1-score': 0.2937096838369985, 'support': 24501}, 'weighted avg': {'precision': 0.33437819797046403, 'recall': 0.3232929268193135, 'f1-score': 0.28698736450874845, 'support': 24501}}
[[ 742 3427 4816]
 [ 653 2783 3937]
 [ 646 3101 4396]]
training model: results/LILAK/W5/deepOF_L2/h1000
Epoch 1/50
273/273 - 9s - loss: 3.3403 - accuracy1000: 0.3475 - val_loss: 3.3524 - val_accuracy1000: 0.3315 - 9s/epoch - 32ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3208 - accuracy1000: 0.3515 - val_loss: 3.3472 - val_accuracy1000: 0.3289 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.3075 - accuracy1000: 0.3571 - val_loss: 3.3421 - val_accuracy1000: 0.3294 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2983 - accuracy1000: 0.3618 - val_loss: 3.3342 - val_accuracy1000: 0.3335 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2919 - accuracy1000: 0.3667 - val_loss: 3.3314 - val_accuracy1000: 0.3321 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2877 - accuracy1000: 0.3674 - val_loss: 3.3308 - val_accuracy1000: 0.3325 - 7s/epoch - 24ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2814 - accuracy1000: 0.3723 - val_loss: 3.3299 - val_accuracy1000: 0.3348 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2790 - accuracy1000: 0.3754 - val_loss: 3.3277 - val_accuracy1000: 0.3338 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2723 - accuracy1000: 0.3784 - val_loss: 3.3269 - val_accuracy1000: 0.3356 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2698 - accuracy1000: 0.3805 - val_loss: 3.3287 - val_accuracy1000: 0.3337 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2652 - accuracy1000: 0.3843 - val_loss: 3.3273 - val_accuracy1000: 0.3354 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2604 - accuracy1000: 0.3877 - val_loss: 3.3304 - val_accuracy1000: 0.3344 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2551 - accuracy1000: 0.3895 - val_loss: 3.3318 - val_accuracy1000: 0.3337 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.2524 - accuracy1000: 0.3918 - val_loss: 3.3363 - val_accuracy1000: 0.3338 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 3.2481 - accuracy1000: 0.3955 - val_loss: 3.3400 - val_accuracy1000: 0.3341 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.2406 - accuracy1000: 0.3988 - val_loss: 3.3361 - val_accuracy1000: 0.3365 - 7s/epoch - 25ms/step
Epoch 17/50
273/273 - 7s - loss: 3.2358 - accuracy1000: 0.4018 - val_loss: 3.3435 - val_accuracy1000: 0.3350 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 3.2319 - accuracy1000: 0.4032 - val_loss: 3.3439 - val_accuracy1000: 0.3372 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 3.2259 - accuracy1000: 0.4076 - val_loss: 3.3487 - val_accuracy1000: 0.3359 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepOF_L2/h1000
Evaluating performance on  test set...
1060/1060 - 8s - 8s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1057397
{'0': {'precision': 0.2950991831971995, 'recall': 0.06328512086482158, 'f1-score': 0.10421989615099315, 'support': 79924}, '1': {'precision': 0.34039122957867585, 'recall': 0.19839629142391782, 'f1-score': 0.2506827086713896, 'support': 95778}, '2': {'precision': 0.3462901623888964, 'recall': 0.7183855751832909, 'f1-score': 0.467315725735124, 'support': 95613}, 'accuracy': 0.3418425077861526, 'macro avg': {'precision': 0.3272601917215906, 'recall': 0.3266889958240101, 'f1-score': 0.27407277685250225, 'support': 271315}, 'weighted avg': {'precision': 0.3291279125773693, 'recall': 0.3418425077861526, 'f1-score': 0.2838804265735869, 'support': 271315}}
[[ 5058 16395 58471]
 [ 5583 19002 71193]
 [ 6499 20427 68687]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046042
{'0': {'precision': 0.4292207792207792, 'recall': 0.054490746465520795, 'f1-score': 0.09670458286090486, 'support': 24261}, '1': {'precision': 0.382106496080728, 'recall': 0.18534219036797484, 'f1-score': 0.24961007621906361, 'support': 22882}, '2': {'precision': 0.3351114635333129, 'recall': 0.825527192008879, 'f1-score': 0.4767093085856384, 'support': 22525}, 'accuracy': 0.34675891370500084, 'macro avg': {'precision': 0.3821462462782734, 'recall': 0.3551200429474582, 'f1-score': 0.2743413225552023, 'support': 69668}, 'weighted avg': {'precision': 0.38331905443076325, 'recall': 0.34675891370500084, 'f1-score': 0.2697882072791602, 'support': 69668}}
[[ 1322  3812 19127]
 [  874  4241 17767]
 [  884  3046 18595]]
Evaluating performance on  val set...
96/96 - 1s - 942ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1131779
{'0': {'precision': 0.35689948892674617, 'recall': 0.04753261486103233, 'f1-score': 0.08389228150966063, 'support': 8815}, '1': {'precision': 0.31881616939364776, 'recall': 0.17450283155537996, 'f1-score': 0.22555111073282835, 'support': 7593}, '2': {'precision': 0.335037295915706, 'recall': 0.7936488323242308, 'f1-score': 0.47117077464788737, 'support': 8093}, 'accuracy': 0.3333333333333333, 'macro avg': {'precision': 0.33691765141203334, 'recall': 0.338561426246881, 'f1-score': 0.2602047222967921, 'support': 24501}, 'weighted avg': {'precision': 0.33787588281870307, 'recall': 0.3333333333333333, 'f1-score': 0.2557163023765306, 'support': 24501}}
[[ 419 1527 6869]
 [ 389 1325 5879]
 [ 366 1304 6423]]
training model: results/LILAK/W5/deepVOL_L2/h10
Epoch 1/50
273/273 - 9s - loss: 3.3200 - accuracy10: 0.3581 - val_loss: 3.3797 - val_accuracy10: 0.4432 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2394 - accuracy10: 0.4020 - val_loss: 3.2125 - val_accuracy10: 0.4563 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.1661 - accuracy10: 0.4349 - val_loss: 3.1722 - val_accuracy10: 0.4764 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.1167 - accuracy10: 0.4466 - val_loss: 3.1177 - val_accuracy10: 0.4818 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.0888 - accuracy10: 0.4529 - val_loss: 3.1328 - val_accuracy10: 0.4945 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.0566 - accuracy10: 0.4597 - val_loss: 3.1600 - val_accuracy10: 0.5005 - 7s/epoch - 24ms/step
Epoch 7/50
273/273 - 7s - loss: 3.0366 - accuracy10: 0.4702 - val_loss: 3.1410 - val_accuracy10: 0.4968 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.0179 - accuracy10: 0.4764 - val_loss: 3.1362 - val_accuracy10: 0.5008 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 2.9995 - accuracy10: 0.4812 - val_loss: 3.1312 - val_accuracy10: 0.5054 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 2.9893 - accuracy10: 0.4860 - val_loss: 3.1590 - val_accuracy10: 0.5060 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 2.9724 - accuracy10: 0.4903 - val_loss: 3.1558 - val_accuracy10: 0.5092 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 2.9629 - accuracy10: 0.4946 - val_loss: 3.1611 - val_accuracy10: 0.5126 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 2.9541 - accuracy10: 0.4975 - val_loss: 3.0990 - val_accuracy10: 0.5134 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 2.9453 - accuracy10: 0.4982 - val_loss: 3.1036 - val_accuracy10: 0.5068 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 2.9361 - accuracy10: 0.5026 - val_loss: 3.0936 - val_accuracy10: 0.5120 - 7s/epoch - 25ms/step
Epoch 16/50
273/273 - 7s - loss: 2.9268 - accuracy10: 0.5054 - val_loss: 3.1011 - val_accuracy10: 0.5134 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 2.9192 - accuracy10: 0.5089 - val_loss: 3.0854 - val_accuracy10: 0.5121 - 7s/epoch - 24ms/step
Epoch 18/50
273/273 - 7s - loss: 2.9062 - accuracy10: 0.5106 - val_loss: 3.0710 - val_accuracy10: 0.5130 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 2.8976 - accuracy10: 0.5154 - val_loss: 3.0566 - val_accuracy10: 0.5130 - 7s/epoch - 25ms/step
Epoch 20/50
273/273 - 7s - loss: 2.8907 - accuracy10: 0.5171 - val_loss: 3.0663 - val_accuracy10: 0.5122 - 7s/epoch - 25ms/step
Epoch 21/50
273/273 - 7s - loss: 2.8858 - accuracy10: 0.5178 - val_loss: 3.0581 - val_accuracy10: 0.5158 - 7s/epoch - 25ms/step
Epoch 22/50
273/273 - 7s - loss: 2.8759 - accuracy10: 0.5210 - val_loss: 3.0545 - val_accuracy10: 0.5113 - 7s/epoch - 25ms/step
Epoch 23/50
273/273 - 7s - loss: 2.8687 - accuracy10: 0.5239 - val_loss: 3.0880 - val_accuracy10: 0.5181 - 7s/epoch - 25ms/step
Epoch 24/50
273/273 - 7s - loss: 2.8583 - accuracy10: 0.5263 - val_loss: 3.0840 - val_accuracy10: 0.5097 - 7s/epoch - 25ms/step
Epoch 25/50
273/273 - 7s - loss: 2.8513 - accuracy10: 0.5269 - val_loss: 3.0848 - val_accuracy10: 0.5177 - 7s/epoch - 25ms/step
Epoch 26/50
273/273 - 7s - loss: 2.8494 - accuracy10: 0.5267 - val_loss: 3.0987 - val_accuracy10: 0.5139 - 7s/epoch - 25ms/step
Epoch 27/50
273/273 - 7s - loss: 2.8362 - accuracy10: 0.5307 - val_loss: 3.0851 - val_accuracy10: 0.5074 - 7s/epoch - 24ms/step
Epoch 28/50
273/273 - 7s - loss: 2.8329 - accuracy10: 0.5318 - val_loss: 3.0918 - val_accuracy10: 0.5062 - 7s/epoch - 25ms/step
Epoch 29/50
273/273 - 7s - loss: 2.8229 - accuracy10: 0.5358 - val_loss: 3.1034 - val_accuracy10: 0.5033 - 7s/epoch - 25ms/step
Epoch 30/50
273/273 - 7s - loss: 2.8202 - accuracy10: 0.5360 - val_loss: 3.1176 - val_accuracy10: 0.5101 - 7s/epoch - 25ms/step
Epoch 31/50
273/273 - 7s - loss: 2.8119 - accuracy10: 0.5381 - val_loss: 3.0937 - val_accuracy10: 0.5024 - 7s/epoch - 24ms/step
Epoch 32/50
273/273 - 7s - loss: 2.8063 - accuracy10: 0.5374 - val_loss: 3.0989 - val_accuracy10: 0.5063 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h10
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0399147
{'0': {'precision': 0.4231719176254938, 'recall': 0.5515265035106216, 'f1-score': 0.4788979299665464, 'support': 89158}, '1': {'precision': 0.5810128447248228, 'recall': 0.4467318208500252, 'f1-score': 0.5051000209589902, 'support': 97103}, '2': {'precision': 0.4471276939521241, 'recall': 0.42294172280417125, 'f1-score': 0.4346985506020529, 'support': 85059}, 'accuracy': 0.47371001031991744, 'macro avg': {'precision': 0.48377081876748024, 'recall': 0.47373334905493936, 'f1-score': 0.4728988338425298, 'support': 271320}, 'weighted avg': {'precision': 0.48717192471193405, 'recall': 0.47371001031991744, 'f1-score': 0.47441888910068625, 'support': 271320}}
[[49173 16486 23499]
 [32740 43379 20984]
 [34288 14796 35975]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97599936
{'0': {'precision': 0.4032749726434266, 'recall': 0.5644349633519309, 'f1-score': 0.47043537725096873, 'support': 18282}, '1': {'precision': 0.6778895262041329, 'recall': 0.5249467599634925, 'f1-score': 0.5916946711473836, 'support': 32870}, '2': {'precision': 0.43963064368926824, 'recall': 0.442242263865637, 'f1-score': 0.4409325866896403, 'support': 18517}, 'accuracy': 0.5133273048271111, 'macro avg': {'precision': 0.5069317141789426, 'recall': 0.5105413290603534, 'f1-score': 0.5010208783626642, 'support': 69669}, 'weighted avg': {'precision': 0.5425015775365106, 'recall': 0.5133273048271111, 'f1-score': 0.5198043909809065, 'support': 69669}}
[[10319  3969  3994]
 [ 9171 17255  6444]
 [ 6098  4230  8189]]
Evaluating performance on  val set...
96/96 - 1s - 991ms/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9831543
{'0': {'precision': 0.4199425932859104, 'recall': 0.4963126843657817, 'f1-score': 0.45494490637463664, 'support': 6780}, '1': {'precision': 0.6441821247892074, 'recall': 0.5761689291101055, 'f1-score': 0.60828025477707, 'support': 11271}, '2': {'precision': 0.416263461838614, 'recall': 0.41348837209302325, 'f1-score': 0.41487127634751503, 'support': 6450}, 'accuracy': 0.5112444390024897, 'macro avg': {'precision': 0.49346272663791063, 'recall': 0.4953233285229701, 'f1-score': 0.4926988124997406, 'support': 24501}, 'weighted avg': {'precision': 0.5221291718638704, 'recall': 0.5112444390024897, 'f1-score': 0.5149329802560657, 'support': 24501}}
[[3365 1854 1561]
 [2598 6494 2179]
 [2050 1733 2667]]
training model: results/LILAK/W5/deepVOL_L2/h20
Epoch 1/50
273/273 - 9s - loss: 3.3064 - accuracy20: 0.3721 - val_loss: 3.2840 - val_accuracy20: 0.4145 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2216 - accuracy20: 0.4129 - val_loss: 3.1910 - val_accuracy20: 0.4434 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.1658 - accuracy20: 0.4373 - val_loss: 3.1699 - val_accuracy20: 0.4492 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.1310 - accuracy20: 0.4498 - val_loss: 3.1488 - val_accuracy20: 0.4584 - 7s/epoch - 24ms/step
Epoch 5/50
273/273 - 7s - loss: 3.0980 - accuracy20: 0.4567 - val_loss: 3.1439 - val_accuracy20: 0.4603 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.0811 - accuracy20: 0.4629 - val_loss: 3.1322 - val_accuracy20: 0.4643 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.0619 - accuracy20: 0.4718 - val_loss: 3.0882 - val_accuracy20: 0.4711 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.0433 - accuracy20: 0.4767 - val_loss: 3.0904 - val_accuracy20: 0.4723 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.0303 - accuracy20: 0.4812 - val_loss: 3.0976 - val_accuracy20: 0.4721 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.0192 - accuracy20: 0.4866 - val_loss: 3.1048 - val_accuracy20: 0.4705 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.0113 - accuracy20: 0.4873 - val_loss: 3.0814 - val_accuracy20: 0.4765 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 2.9974 - accuracy20: 0.4931 - val_loss: 3.1076 - val_accuracy20: 0.4724 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 2.9890 - accuracy20: 0.4946 - val_loss: 3.0722 - val_accuracy20: 0.4820 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 2.9775 - accuracy20: 0.4998 - val_loss: 3.1026 - val_accuracy20: 0.4756 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 2.9714 - accuracy20: 0.4999 - val_loss: 3.0898 - val_accuracy20: 0.4793 - 7s/epoch - 25ms/step
Epoch 16/50
273/273 - 7s - loss: 2.9575 - accuracy20: 0.5054 - val_loss: 3.1259 - val_accuracy20: 0.4750 - 7s/epoch - 25ms/step
Epoch 17/50
273/273 - 7s - loss: 2.9509 - accuracy20: 0.5063 - val_loss: 3.1203 - val_accuracy20: 0.4802 - 7s/epoch - 25ms/step
Epoch 18/50
273/273 - 7s - loss: 2.9419 - accuracy20: 0.5087 - val_loss: 3.1182 - val_accuracy20: 0.4768 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 2.9344 - accuracy20: 0.5106 - val_loss: 3.1055 - val_accuracy20: 0.4824 - 7s/epoch - 24ms/step
Epoch 20/50
273/273 - 7s - loss: 2.9327 - accuracy20: 0.5120 - val_loss: 3.1100 - val_accuracy20: 0.4805 - 7s/epoch - 25ms/step
Epoch 21/50
273/273 - 7s - loss: 2.9214 - accuracy20: 0.5155 - val_loss: 3.1184 - val_accuracy20: 0.4789 - 7s/epoch - 25ms/step
Epoch 22/50
273/273 - 7s - loss: 2.9137 - accuracy20: 0.5169 - val_loss: 3.1235 - val_accuracy20: 0.4786 - 7s/epoch - 24ms/step
Epoch 23/50
273/273 - 7s - loss: 2.9063 - accuracy20: 0.5180 - val_loss: 3.1222 - val_accuracy20: 0.4810 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h20
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0451033
{'0': {'precision': 0.4476082595462092, 'recall': 0.5036240696599699, 'f1-score': 0.47396684566892366, 'support': 102785}, '1': {'precision': 0.45938705826832854, 'recall': 0.46130151783349826, 'f1-score': 0.46034229760836753, 'support': 71747}, '2': {'precision': 0.46101690861693734, 'recall': 0.39832417241806833, 'f1-score': 0.42738368419302264, 'support': 96788}, 'accuracy': 0.4548687896211116, 'macro avg': {'precision': 0.4560040754771584, 'recall': 0.4544165866371788, 'f1-score': 0.45389760915677124, 'support': 271320}, 'weighted avg': {'precision': 0.4555062759039179, 'recall': 0.4548687896211116, 'f1-score': 0.45374639939651384, 'support': 271320}}
[[51765 21219 29801]
 [23378 33097 15272]
 [40505 17730 38553]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0099117
{'0': {'precision': 0.4278441280048997, 'recall': 0.5098763742529994, 'f1-score': 0.46527214070142575, 'support': 21921}, '1': {'precision': 0.5639556301420326, 'recall': 0.5391086590757914, 'f1-score': 0.5512523005521325, 'support': 25557}, '2': {'precision': 0.4566286491576855, 'recall': 0.3933126042089135, 'f1-score': 0.4226122745430335, 'support': 22191}, 'accuracy': 0.4834718454405833, 'macro avg': {'precision': 0.48280946910153927, 'recall': 0.4807658791792348, 'f1-score': 0.4797122385988639, 'support': 69669}, 'weighted avg': {'precision': 0.4869429950622735, 'recall': 0.4834718454405833, 'f1-score': 0.48322459954802366, 'support': 69669}}
[[11177  5324  5420]
 [ 6813 13778  4966]
 [ 8134  5329  8728]]
Evaluating performance on  val set...
96/96 - 1s - 977ms/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0165237
{'0': {'precision': 0.44573048305184837, 'recall': 0.4721631427499062, 'f1-score': 0.45856622114216283, 'support': 7993}, '1': {'precision': 0.5363892659496711, 'recall': 0.5800587172538392, 'f1-score': 0.55736993435686, 'support': 8856}, '2': {'precision': 0.44664704971348923, 'recall': 0.3768949294302143, 'f1-score': 0.4088170671202778, 'support': 7652}, 'accuracy': 0.48140892208481284, 'macro avg': {'precision': 0.4762555995716696, 'recall': 0.4763722631446532, 'f1-score': 0.47491774087310024, 'support': 24501}, 'weighted avg': {'precision': 0.4787857766903934, 'recall': 0.48140892208481284, 'f1-score': 0.4787419346907484, 'support': 24501}}
[[3774 2327 1892]
 [2038 5137 1681]
 [2655 2113 2884]]
training model: results/LILAK/W5/deepVOL_L2/h30
Epoch 1/50
273/273 - 9s - loss: 3.3139 - accuracy30: 0.3722 - val_loss: 3.4650 - val_accuracy30: 0.3443 - 9s/epoch - 34ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2449 - accuracy30: 0.3937 - val_loss: 3.2658 - val_accuracy30: 0.4009 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.1798 - accuracy30: 0.4218 - val_loss: 3.2697 - val_accuracy30: 0.4084 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.1408 - accuracy30: 0.4376 - val_loss: 3.2212 - val_accuracy30: 0.4288 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.1194 - accuracy30: 0.4451 - val_loss: 3.1813 - val_accuracy30: 0.4462 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.0958 - accuracy30: 0.4591 - val_loss: 3.2105 - val_accuracy30: 0.4468 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.0782 - accuracy30: 0.4637 - val_loss: 3.1857 - val_accuracy30: 0.4520 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.0597 - accuracy30: 0.4739 - val_loss: 3.1592 - val_accuracy30: 0.4566 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.0448 - accuracy30: 0.4766 - val_loss: 3.1994 - val_accuracy30: 0.4508 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.0358 - accuracy30: 0.4795 - val_loss: 3.2052 - val_accuracy30: 0.4514 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.0298 - accuracy30: 0.4814 - val_loss: 3.2137 - val_accuracy30: 0.4501 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.0213 - accuracy30: 0.4874 - val_loss: 3.2232 - val_accuracy30: 0.4503 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.0142 - accuracy30: 0.4871 - val_loss: 3.2105 - val_accuracy30: 0.4536 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.0090 - accuracy30: 0.4883 - val_loss: 3.1973 - val_accuracy30: 0.4514 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 2.9973 - accuracy30: 0.4932 - val_loss: 3.2095 - val_accuracy30: 0.4510 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 2.9888 - accuracy30: 0.4950 - val_loss: 3.2104 - val_accuracy30: 0.4523 - 7s/epoch - 25ms/step
Epoch 17/50
273/273 - 7s - loss: 2.9836 - accuracy30: 0.4977 - val_loss: 3.2078 - val_accuracy30: 0.4536 - 7s/epoch - 25ms/step
Epoch 18/50
273/273 - 7s - loss: 2.9697 - accuracy30: 0.5013 - val_loss: 3.1956 - val_accuracy30: 0.4550 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h30
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0738691
{'0': {'precision': 0.43991393304542253, 'recall': 0.5414899432600049, 'f1-score': 0.4854453429322248, 'support': 106098}, '1': {'precision': 0.38882964063604664, 'recall': 0.500848922639995, 'f1-score': 0.4377871169244676, 'support': 64788}, '2': {'precision': 0.46384732237956383, 'recall': 0.2645020610550212, 'f1-score': 0.33689483529374464, 'support': 100434}, 'accuracy': 0.42925328025947224, 'macro avg': {'precision': 0.43086363202034433, 'recall': 0.4356136423183404, 'f1-score': 0.4200424317168123, 'support': 271320}, 'weighted avg': {'precision': 0.43657498600048117, 'recall': 0.42925328025947224, 'f1-score': 0.41907646916415137, 'support': 271320}}
[[57451 27205 21442]
 [23075 32449  9264]
 [50070 23799 26565]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0439284
{'0': {'precision': 0.42461340206185566, 'recall': 0.5069664073852466, 'f1-score': 0.46214984220984145, 'support': 23398}, '1': {'precision': 0.48830286608403617, 'recall': 0.5618989065038865, 'f1-score': 0.5225221546126516, 'support': 22771}, '2': {'precision': 0.4748873148744366, 'recall': 0.31382978723404253, 'f1-score': 0.3779144248014348, 'support': 23500}, 'accuracy': 0.45977407455252695, 'macro avg': {'precision': 0.46260119434010943, 'recall': 0.4608983670410585, 'f1-score': 0.4541954738746426, 'support': 69669}, 'weighted avg': {'precision': 0.4623878747303987, 'recall': 0.45977407455252695, 'f1-score': 0.45346887386849644, 'support': 69669}}
[[11862  6986  4550]
 [ 6371 12795  3605]
 [ 9703  6422  7375]]
Evaluating performance on  val set...
96/96 - 1s - 967ms/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0552719
{'0': {'precision': 0.4450535758783952, 'recall': 0.4247324613555291, 'f1-score': 0.4346556339742029, 'support': 8410}, '1': {'precision': 0.46961429915333963, 'recall': 0.6261916708479679, 'f1-score': 0.536716482098699, 'support': 7972}, '2': {'precision': 0.45662959794696323, 'recall': 0.32873506589481466, 'f1-score': 0.3822686909195073, 'support': 8119}, 'accuracy': 0.4584710828129464, 'macro avg': {'precision': 0.45709915765956605, 'recall': 0.4598863993661039, 'f1-score': 0.4512136023308031, 'support': 24501}, 'weighted avg': {'precision': 0.45688100370267015, 'recall': 0.4584710828129464, 'f1-score': 0.4505039459038143, 'support': 24501}}
[[3572 3036 1802]
 [1606 4992 1374]
 [2848 2602 2669]]
training model: results/LILAK/W5/deepVOL_L2/h50
Epoch 1/50
273/273 - 9s - loss: 3.3202 - accuracy50: 0.3680 - val_loss: 3.4435 - val_accuracy50: 0.3432 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.2564 - accuracy50: 0.3914 - val_loss: 3.3672 - val_accuracy50: 0.3657 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2299 - accuracy50: 0.4028 - val_loss: 3.3194 - val_accuracy50: 0.3876 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2075 - accuracy50: 0.4122 - val_loss: 3.3084 - val_accuracy50: 0.3952 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.1886 - accuracy50: 0.4199 - val_loss: 3.3189 - val_accuracy50: 0.3997 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.1672 - accuracy50: 0.4304 - val_loss: 3.3246 - val_accuracy50: 0.4009 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.1537 - accuracy50: 0.4367 - val_loss: 3.2933 - val_accuracy50: 0.4095 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.1443 - accuracy50: 0.4417 - val_loss: 3.2982 - val_accuracy50: 0.4136 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.1315 - accuracy50: 0.4474 - val_loss: 3.2597 - val_accuracy50: 0.4173 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.1195 - accuracy50: 0.4527 - val_loss: 3.2788 - val_accuracy50: 0.4132 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.1102 - accuracy50: 0.4564 - val_loss: 3.2593 - val_accuracy50: 0.4182 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.0997 - accuracy50: 0.4604 - val_loss: 3.2589 - val_accuracy50: 0.4251 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.0884 - accuracy50: 0.4652 - val_loss: 3.2644 - val_accuracy50: 0.4253 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.0770 - accuracy50: 0.4685 - val_loss: 3.2739 - val_accuracy50: 0.4266 - 7s/epoch - 25ms/step
Epoch 15/50
273/273 - 7s - loss: 3.0689 - accuracy50: 0.4737 - val_loss: 3.2942 - val_accuracy50: 0.4245 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.0680 - accuracy50: 0.4723 - val_loss: 3.2744 - val_accuracy50: 0.4301 - 7s/epoch - 24ms/step
Epoch 17/50
273/273 - 7s - loss: 3.0544 - accuracy50: 0.4763 - val_loss: 3.2976 - val_accuracy50: 0.4295 - 7s/epoch - 25ms/step
Epoch 18/50
273/273 - 7s - loss: 3.0495 - accuracy50: 0.4802 - val_loss: 3.3223 - val_accuracy50: 0.4263 - 7s/epoch - 24ms/step
Epoch 19/50
273/273 - 7s - loss: 3.0366 - accuracy50: 0.4849 - val_loss: 3.3470 - val_accuracy50: 0.4250 - 7s/epoch - 24ms/step
Epoch 20/50
273/273 - 7s - loss: 3.0312 - accuracy50: 0.4863 - val_loss: 3.3521 - val_accuracy50: 0.4277 - 7s/epoch - 25ms/step
Epoch 21/50
273/273 - 7s - loss: 3.0261 - accuracy50: 0.4863 - val_loss: 3.3828 - val_accuracy50: 0.4221 - 7s/epoch - 24ms/step
Epoch 22/50
273/273 - 7s - loss: 3.0180 - accuracy50: 0.4906 - val_loss: 3.3611 - val_accuracy50: 0.4237 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h50
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1082108
{'0': {'precision': 0.4250256210043434, 'recall': 0.4279200487411804, 'f1-score': 0.42646792382612614, 'support': 101762}, '1': {'precision': 0.3461131812069514, 'recall': 0.479643802099633, 'f1-score': 0.4020820787397819, 'support': 70298}, '2': {'precision': 0.4291212944041654, 'recall': 0.3088756800322386, 'f1-score': 0.35920237132848293, 'support': 99260}, 'accuracy': 0.3977701606958573, 'macro avg': {'precision': 0.4000866988718201, 'recall': 0.4054798436243507, 'f1-score': 0.395917457964797, 'support': 271320}, 'weighted avg': {'precision': 0.4060780677417356, 'recall': 0.3977701606958573, 'f1-score': 0.395541140401403, 'support': 271320}}
[[43546 32551 25665]
 [21458 33718 15122]
 [37451 31150 30659]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0638151
{'0': {'precision': 0.4192121039109335, 'recall': 0.37631331681899716, 'f1-score': 0.3966060496939143, 'support': 23414}, '1': {'precision': 0.44145785876993165, 'recall': 0.5484109708315194, 'f1-score': 0.4891563925832443, 'support': 22970}, '2': {'precision': 0.45182938954066415, 'recall': 0.3903371269057333, 'f1-score': 0.4188382756157692, 'support': 23285}, 'accuracy': 0.4377413196687192, 'macro avg': {'precision': 0.4374997840738431, 'recall': 0.43835380485208325, 'f1-score': 0.43486690596430927, 'support': 69669}, 'weighted avg': {'precision': 0.4374480264159137, 'recall': 0.4377413196687192, 'f1-score': 0.4345505982988648, 'support': 69669}}
[[ 8811  8814  5789]
 [ 5135 12597  5238]
 [ 7072  7124  9089]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.085313
{'0': {'precision': 0.43009046183145533, 'recall': 0.3255646323882749, 'f1-score': 0.3705982905982906, 'support': 8324}, '1': {'precision': 0.4201408718827337, 'recall': 0.5525788683024537, 'f1-score': 0.4773440034605818, 'support': 7988}, '2': {'precision': 0.4403431245126072, 'recall': 0.41372572963731835, 'f1-score': 0.4266196562362274, 'support': 8189}, 'accuracy': 0.42904371250153056, 'macro avg': {'precision': 0.4301914860755987, 'recall': 0.4306230767760157, 'f1-score': 0.42485398343169994, 'support': 24501}, 'weighted avg': {'precision': 0.4302733821279969, 'recall': 0.42904371250153056, 'f1-score': 0.42412442086044505, 'support': 24501}}
[[2710 3352 2262]
 [1530 4414 2044]
 [2061 2740 3388]]
training model: results/LILAK/W5/deepVOL_L2/h100
Epoch 1/50
273/273 - 9s - loss: 3.3628 - accuracy100: 0.3452 - val_loss: 3.3398 - val_accuracy100: 0.3405 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3113 - accuracy100: 0.3627 - val_loss: 3.3128 - val_accuracy100: 0.3637 - 7s/epoch - 26ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2849 - accuracy100: 0.3737 - val_loss: 3.2891 - val_accuracy100: 0.3782 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2638 - accuracy100: 0.3866 - val_loss: 3.2855 - val_accuracy100: 0.3865 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2485 - accuracy100: 0.3966 - val_loss: 3.2784 - val_accuracy100: 0.3910 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2329 - accuracy100: 0.4028 - val_loss: 3.2804 - val_accuracy100: 0.3933 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2239 - accuracy100: 0.4092 - val_loss: 3.2939 - val_accuracy100: 0.3898 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2135 - accuracy100: 0.4136 - val_loss: 3.3099 - val_accuracy100: 0.3880 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2024 - accuracy100: 0.4195 - val_loss: 3.3095 - val_accuracy100: 0.3885 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.1934 - accuracy100: 0.4218 - val_loss: 3.3300 - val_accuracy100: 0.3821 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.1839 - accuracy100: 0.4259 - val_loss: 3.3419 - val_accuracy100: 0.3786 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1745 - accuracy100: 0.4320 - val_loss: 3.3373 - val_accuracy100: 0.3819 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1664 - accuracy100: 0.4344 - val_loss: 3.3484 - val_accuracy100: 0.3797 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1571 - accuracy100: 0.4387 - val_loss: 3.3647 - val_accuracy100: 0.3770 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.1498 - accuracy100: 0.4425 - val_loss: 3.3547 - val_accuracy100: 0.3842 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepVOL_L2/h100
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1079748
{'0': {'precision': 0.380773205437346, 'recall': 0.5761308622918943, 'f1-score': 0.4585103200717918, 'support': 99769}, '1': {'precision': 0.2731446189290373, 'recall': 0.22644795236222684, 'f1-score': 0.24761392866740894, 'support': 71204}, '2': {'precision': 0.4000945657313355, 'recall': 0.24454144119903934, 'f1-score': 0.3035502226620485, 'support': 100347}, 'accuracy': 0.3617241633495503, 'macro avg': {'precision': 0.35133746336590627, 'recall': 0.34904008528438685, 'f1-score': 0.33655815713374976, 'support': 271320}, 'weighted avg': {'precision': 0.3596735985808052, 'recall': 0.3617241633495503, 'f1-score': 0.3458520289456928, 'support': 271320}}
[[57480 20644 21645]
 [39931 16124 15149]
 [53545 22263 24539]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0863302
{'0': {'precision': 0.3880940950552088, 'recall': 0.5139660068664434, 'f1-score': 0.4422480761515737, 'support': 23593}, '1': {'precision': 0.37112543050772134, 'recall': 0.2904908909083004, 'f1-score': 0.32589449037828344, 'support': 22999}, '2': {'precision': 0.4168054059347762, 'recall': 0.36885210382632055, 'f1-score': 0.3913653187429596, 'support': 23077}, 'accuracy': 0.39212562258680334, 'macro avg': {'precision': 0.3920083104992355, 'recall': 0.3911030005336881, 'f1-score': 0.38650262842427224, 'support': 69669}, 'weighted avg': {'precision': 0.3920027001053762, 'recall': 0.39212562258680334, 'f1-score': 0.3869833599662044, 'support': 69669}}
[[12126  5834  5633]
 [10041  6681  6277]
 [ 9078  5487  8512]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0927415
{'0': {'precision': 0.41056218057921634, 'recall': 0.4661508704061896, 'f1-score': 0.43659420289855067, 'support': 8789}, '1': {'precision': 0.3208539111040306, 'recall': 0.2785615491009682, 'f1-score': 0.29821573998667356, 'support': 7230}, '2': {'precision': 0.4203759854457247, 'recall': 0.4086300400848856, 'f1-score': 0.4144198003228313, 'support': 8482}, 'accuracy': 0.39088200481612995, 'macro avg': {'precision': 0.3839306923763239, 'recall': 0.3844474865306811, 'f1-score': 0.3830765810693519, 'support': 24501}, 'weighted avg': {'precision': 0.3874876082993963, 'recall': 0.39088200481612995, 'f1-score': 0.38808354743550333, 'support': 24501}}
[[4097 2307 2385]
 [2822 2014 2394]
 [3060 1956 3466]]
training model: results/LILAK/W5/deepVOL_L2/h200
Epoch 1/50
273/273 - 9s - loss: 3.3577 - accuracy200: 0.3471 - val_loss: 3.3549 - val_accuracy200: 0.3283 - 9s/epoch - 32ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3170 - accuracy200: 0.3544 - val_loss: 3.3537 - val_accuracy200: 0.3204 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2941 - accuracy200: 0.3660 - val_loss: 3.3469 - val_accuracy200: 0.3275 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2747 - accuracy200: 0.3786 - val_loss: 3.3462 - val_accuracy200: 0.3251 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2665 - accuracy200: 0.3854 - val_loss: 3.3567 - val_accuracy200: 0.3314 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2580 - accuracy200: 0.3899 - val_loss: 3.3421 - val_accuracy200: 0.3391 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2416 - accuracy200: 0.4019 - val_loss: 3.3685 - val_accuracy200: 0.3414 - 7s/epoch - 24ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2403 - accuracy200: 0.4005 - val_loss: 3.3930 - val_accuracy200: 0.3371 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2233 - accuracy200: 0.4108 - val_loss: 3.3962 - val_accuracy200: 0.3412 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2165 - accuracy200: 0.4121 - val_loss: 3.4193 - val_accuracy200: 0.3470 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2042 - accuracy200: 0.4206 - val_loss: 3.4572 - val_accuracy200: 0.3346 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1887 - accuracy200: 0.4248 - val_loss: 3.5086 - val_accuracy200: 0.3315 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1796 - accuracy200: 0.4309 - val_loss: 3.5436 - val_accuracy200: 0.3289 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1751 - accuracy200: 0.4355 - val_loss: 3.6042 - val_accuracy200: 0.3193 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.1590 - accuracy200: 0.4403 - val_loss: 3.6230 - val_accuracy200: 0.3242 - 7s/epoch - 24ms/step
Epoch 16/50
273/273 - 7s - loss: 3.1424 - accuracy200: 0.4483 - val_loss: 3.6728 - val_accuracy200: 0.3262 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h200
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.136527
{'0': {'precision': 0.36113591198410183, 'recall': 0.4127612881988259, 'f1-score': 0.3852266792286659, 'support': 91135}, '1': {'precision': 0.31284549474847984, 'recall': 0.56095203875556, 'f1-score': 0.4016750136405375, 'support': 80711}, '2': {'precision': 0.37629807906582874, 'recall': 0.08487645012767155, 'f1-score': 0.138510880888517, 'support': 99474}, 'accuracy': 0.33663202122954444, 'macro avg': {'precision': 0.35009316193280343, 'recall': 0.35286325902735244, 'f1-score': 0.30847085791924017, 'support': 271320}, 'weighted avg': {'precision': 0.35232960777793726, 'recall': 0.33663202122954444, 'f1-score': 0.2996662863148689, 'support': 271320}}
[[37617 46744  6774]
 [28216 45275  7220]
 [38330 52701  8443]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987505
{'0': {'precision': 0.41663283945605845, 'recall': 0.33745684695051786, 'f1-score': 0.37288828337874663, 'support': 24332}, '1': {'precision': 0.3384363738594832, 'recall': 0.5982921429539602, 'f1-score': 0.4323212536728698, 'support': 22133}, '2': {'precision': 0.43437326933727155, 'recall': 0.20280986036890192, 'f1-score': 0.27651448381220994, 'support': 23204}, 'accuracy': 0.3754754625443167, 'macro avg': {'precision': 0.3964808275509377, 'recall': 0.3795196167577933, 'f1-score': 0.36057467362127543, 'support': 69669}, 'weighted avg': {'precision': 0.39769940510096036, 'recall': 0.3754754625443167, 'f1-score': 0.35967110337584596, 'support': 69669}}
[[ 8211 13183  2938]
 [ 5701 13242  3190]
 [ 5796 12702  4706]]
Evaluating performance on  val set...
96/96 - 1s - 993ms/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1182737
{'0': {'precision': 0.41126194067370536, 'recall': 0.27342618384401113, 'f1-score': 0.32847008432606073, 'support': 8975}, '1': {'precision': 0.2884053738317757, 'recall': 0.5598072562358276, 'f1-score': 0.3806861989205859, 'support': 7056}, '2': {'precision': 0.41897478296816865, 'recall': 0.23931523022432113, 'f1-score': 0.3046287947099489, 'support': 8470}, 'accuracy': 0.3441084037386229, 'macro avg': {'precision': 0.37288069915788324, 'recall': 0.35751622343471995, 'f1-score': 0.33792835931886517, 'support': 24501}, 'weighted avg': {'precision': 0.37854702449058825, 'recall': 0.3441084037386229, 'f1-score': 0.3352657735440723, 'support': 24501}}
[[2454 5092 1429]
 [1724 3950 1382]
 [1789 4654 2027]]
training model: results/LILAK/W5/deepVOL_L2/h300
Epoch 1/50
273/273 - 10s - loss: 3.3570 - accuracy300: 0.3510 - val_loss: 3.3158 - val_accuracy300: 0.3681 - 10s/epoch - 36ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3126 - accuracy300: 0.3563 - val_loss: 3.3026 - val_accuracy300: 0.3617 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2954 - accuracy300: 0.3655 - val_loss: 3.3022 - val_accuracy300: 0.3565 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2835 - accuracy300: 0.3707 - val_loss: 3.2758 - val_accuracy300: 0.3825 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2714 - accuracy300: 0.3793 - val_loss: 3.2841 - val_accuracy300: 0.3822 - 7s/epoch - 24ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2612 - accuracy300: 0.3869 - val_loss: 3.2843 - val_accuracy300: 0.3850 - 7s/epoch - 24ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2532 - accuracy300: 0.3913 - val_loss: 3.2860 - val_accuracy300: 0.3926 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2448 - accuracy300: 0.3972 - val_loss: 3.2988 - val_accuracy300: 0.3888 - 7s/epoch - 24ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2312 - accuracy300: 0.4056 - val_loss: 3.3260 - val_accuracy300: 0.3872 - 7s/epoch - 24ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2208 - accuracy300: 0.4129 - val_loss: 3.3213 - val_accuracy300: 0.3862 - 7s/epoch - 24ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2112 - accuracy300: 0.4180 - val_loss: 3.3479 - val_accuracy300: 0.3856 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1985 - accuracy300: 0.4221 - val_loss: 3.3592 - val_accuracy300: 0.3804 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1858 - accuracy300: 0.4295 - val_loss: 3.3816 - val_accuracy300: 0.3760 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1782 - accuracy300: 0.4301 - val_loss: 3.3785 - val_accuracy300: 0.3809 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h300
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.104023
{'0': {'precision': 0.33024732033034615, 'recall': 0.6757831812665738, 'f1-score': 0.4436755831624297, 'support': 88996}, '1': {'precision': 0.330397813543881, 'recall': 0.03946318462096482, 'f1-score': 0.07050513559926125, 'support': 82710}, '2': {'precision': 0.38553366360347413, 'recall': 0.30702511695143253, 'f1-score': 0.3418295211324276, 'support': 99614}, 'accuracy': 0.34641751437417073, 'macro avg': {'precision': 0.34872626582590044, 'recall': 0.34075716094632363, 'f1-score': 0.2853367466313728, 'support': 271320}, 'weighted avg': {'precision': 0.3505913461762139, 'recall': 0.34641751437417073, 'f1-score': 0.29252483371157356, 'support': 271320}}
[[60142  3103 25751]
 [56452  3264 22994]
 [65518  3512 30584]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944663
{'0': {'precision': 0.36766682669227074, 'recall': 0.6355601659751038, 'f1-score': 0.46584549878345505, 'support': 24100}, '1': {'precision': 0.3773635872501351, 'recall': 0.06117533718689788, 'f1-score': 0.10528299042881906, 'support': 22836}, '2': {'precision': 0.37919117949561854, 'recall': 0.40544582765143183, 'f1-score': 0.3918792517006803, 'support': 22733}, 'accuracy': 0.37220284488079347, 'macro avg': {'precision': 0.37474053114600814, 'recall': 0.3673937769378112, 'f1-score': 0.3210025803043181, 'support': 69669}, 'weighted avg': {'precision': 0.3746056134751713, 'recall': 0.37220284488079347, 'f1-score': 0.3235256702267198, 'support': 69669}}
[[15317  1232  7551]
 [13900  1397  7539]
 [12443  1073  9217]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0921016
{'0': {'precision': 0.3968425940256926, 'recall': 0.5525862068965517, 'f1-score': 0.4619403657328169, 'support': 9280}, '1': {'precision': 0.25955414012738853, 'recall': 0.04838230929059068, 'f1-score': 0.08156117087815862, 'support': 6738}, '2': {'precision': 0.3833188026736414, 'recall': 0.46646233643758106, 'f1-score': 0.42082314155056894, 'support': 8483}, 'accuracy': 0.3841067711521979, 'macro avg': {'precision': 0.3465718456089075, 'recall': 0.3558102842082412, 'f1-score': 0.3214415593871815, 'support': 24501}, 'weighted avg': {'precision': 0.3544046558025089, 'recall': 0.3841067711521979, 'f1-score': 0.34309654598388023, 'support': 24501}}
[[5128  485 3667]
 [3713  326 2699]
 [4081  445 3957]]
training model: results/LILAK/W5/deepVOL_L2/h500
Epoch 1/50
273/273 - 9s - loss: 3.3525 - accuracy500: 0.3500 - val_loss: 3.4827 - val_accuracy500: 0.3170 - 9s/epoch - 32ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3241 - accuracy500: 0.3579 - val_loss: 3.3638 - val_accuracy500: 0.3203 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2998 - accuracy500: 0.3644 - val_loss: 3.4004 - val_accuracy500: 0.3104 - 7s/epoch - 24ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2845 - accuracy500: 0.3677 - val_loss: 3.3484 - val_accuracy500: 0.3259 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2722 - accuracy500: 0.3759 - val_loss: 3.3627 - val_accuracy500: 0.3343 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2589 - accuracy500: 0.3858 - val_loss: 3.3772 - val_accuracy500: 0.3288 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2465 - accuracy500: 0.3939 - val_loss: 3.4014 - val_accuracy500: 0.3278 - 7s/epoch - 25ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2321 - accuracy500: 0.4030 - val_loss: 3.4397 - val_accuracy500: 0.3324 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2203 - accuracy500: 0.4111 - val_loss: 3.4561 - val_accuracy500: 0.3204 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2068 - accuracy500: 0.4204 - val_loss: 3.4725 - val_accuracy500: 0.3259 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.1928 - accuracy500: 0.4249 - val_loss: 3.5181 - val_accuracy500: 0.3234 - 7s/epoch - 25ms/step
Epoch 12/50
273/273 - 7s - loss: 3.1814 - accuracy500: 0.4289 - val_loss: 3.5284 - val_accuracy500: 0.3221 - 7s/epoch - 25ms/step
Epoch 13/50
273/273 - 7s - loss: 3.1725 - accuracy500: 0.4328 - val_loss: 3.5990 - val_accuracy500: 0.3191 - 7s/epoch - 25ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1578 - accuracy500: 0.4383 - val_loss: 3.6339 - val_accuracy500: 0.3231 - 7s/epoch - 25ms/step
testing model: results/LILAK/W5/deepVOL_L2/h500
Evaluating performance on  test set...
1060/1060 - 10s - 10s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1038976
{'0': {'precision': 0.3413591711606883, 'recall': 0.1788750395741238, 'f1-score': 0.23474286769458033, 'support': 85283}, '1': {'precision': 0.3420020603591581, 'recall': 0.6570519308188831, 'f1-score': 0.4498517919698195, 'support': 88926}, '2': {'precision': 0.3720759316686683, 'recall': 0.21374509581818743, 'f1-score': 0.27151434289526355, 'support': 97111}, 'accuracy': 0.3480797582190771, 'macro avg': {'precision': 0.3518123877295049, 'recall': 0.34989068873706475, 'f1-score': 0.3187030008532211, 'support': 271320}, 'weighted avg': {'precision': 0.3525640395616671, 'recall': 0.3480797582190771, 'f1-score': 0.31840677351911767, 'support': 271320}}
[[15255 52198 17830]
 [13297 58429 17200]
 [16137 60217 20757]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007595
{'0': {'precision': 0.3857094094891341, 'recall': 0.14266475885868193, 'f1-score': 0.20828853184233972, 'support': 23762}, '1': {'precision': 0.3596485190538463, 'recall': 0.6563389716965332, 'f1-score': 0.46467371166871696, 'support': 23884}, '2': {'precision': 0.356271323656971, 'recall': 0.27975298551514327, 'f1-score': 0.3134092990131244, 'support': 22023}, 'accuracy': 0.3620979201653533, 'macro avg': {'precision': 0.3672097507333172, 'recall': 0.3595855720234528, 'f1-score': 0.32879051417472704, 'support': 69669}, 'weighted avg': {'precision': 0.36746954281330785, 'recall': 0.3620979201653533, 'f1-score': 0.3294123931059632, 'support': 69669}}
[[ 3390 14739  5633]
 [ 2709 15676  5499]
 [ 2690 13172  6161]]
Evaluating performance on  val set...
96/96 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1158226
{'0': {'precision': 0.41205498766302434, 'recall': 0.13006230529595014, 'f1-score': 0.1977167019027484, 'support': 8988}, '1': {'precision': 0.30394771939183785, 'recall': 0.6180338983050847, 'f1-score': 0.4074918421170265, 'support': 7375}, '2': {'precision': 0.35137972405518897, 'recall': 0.28790857704595724, 'f1-score': 0.3164933135215453, 'support': 8138}, 'accuracy': 0.3293743112526019, 'macro avg': {'precision': 0.35579414370335044, 'recall': 0.3453349268823307, 'f1-score': 0.3072339525137734, 'support': 24501}, 'weighted avg': {'precision': 0.3593605507526711, 'recall': 0.3293743112526019, 'f1-score': 0.30031233981279576, 'support': 24501}}
[[1169 5480 2339]
 [ 831 4558 1986]
 [ 837 4958 2343]]
training model: results/LILAK/W5/deepVOL_L2/h1000
Epoch 1/50
273/273 - 9s - loss: 3.3610 - accuracy1000: 0.3487 - val_loss: 3.4014 - val_accuracy1000: 0.3230 - 9s/epoch - 33ms/step
Epoch 2/50
273/273 - 7s - loss: 3.3191 - accuracy1000: 0.3559 - val_loss: 3.3351 - val_accuracy1000: 0.3370 - 7s/epoch - 25ms/step
Epoch 3/50
273/273 - 7s - loss: 3.2953 - accuracy1000: 0.3661 - val_loss: 3.3330 - val_accuracy1000: 0.3262 - 7s/epoch - 25ms/step
Epoch 4/50
273/273 - 7s - loss: 3.2808 - accuracy1000: 0.3700 - val_loss: 3.3335 - val_accuracy1000: 0.3320 - 7s/epoch - 25ms/step
Epoch 5/50
273/273 - 7s - loss: 3.2732 - accuracy1000: 0.3772 - val_loss: 3.3257 - val_accuracy1000: 0.3245 - 7s/epoch - 25ms/step
Epoch 6/50
273/273 - 7s - loss: 3.2658 - accuracy1000: 0.3813 - val_loss: 3.3344 - val_accuracy1000: 0.3406 - 7s/epoch - 25ms/step
Epoch 7/50
273/273 - 7s - loss: 3.2566 - accuracy1000: 0.3850 - val_loss: 3.3470 - val_accuracy1000: 0.3346 - 7s/epoch - 26ms/step
Epoch 8/50
273/273 - 7s - loss: 3.2536 - accuracy1000: 0.3880 - val_loss: 3.3462 - val_accuracy1000: 0.3369 - 7s/epoch - 25ms/step
Epoch 9/50
273/273 - 7s - loss: 3.2480 - accuracy1000: 0.3942 - val_loss: 3.3275 - val_accuracy1000: 0.3493 - 7s/epoch - 25ms/step
Epoch 10/50
273/273 - 7s - loss: 3.2337 - accuracy1000: 0.4002 - val_loss: 3.3355 - val_accuracy1000: 0.3494 - 7s/epoch - 25ms/step
Epoch 11/50
273/273 - 7s - loss: 3.2246 - accuracy1000: 0.4072 - val_loss: 3.3484 - val_accuracy1000: 0.3561 - 7s/epoch - 24ms/step
Epoch 12/50
273/273 - 7s - loss: 3.2162 - accuracy1000: 0.4078 - val_loss: 3.3597 - val_accuracy1000: 0.3482 - 7s/epoch - 24ms/step
Epoch 13/50
273/273 - 7s - loss: 3.2088 - accuracy1000: 0.4129 - val_loss: 3.3649 - val_accuracy1000: 0.3506 - 7s/epoch - 24ms/step
Epoch 14/50
273/273 - 7s - loss: 3.1964 - accuracy1000: 0.4190 - val_loss: 3.3825 - val_accuracy1000: 0.3420 - 7s/epoch - 24ms/step
Epoch 15/50
273/273 - 7s - loss: 3.1847 - accuracy1000: 0.4250 - val_loss: 3.3925 - val_accuracy1000: 0.3381 - 7s/epoch - 24ms/step
testing model: results/LILAK/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
1060/1060 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943446
{'0': {'precision': 0.3265813274771, 'recall': 0.14140403117845032, 'f1-score': 0.19735624356086398, 'support': 79927}, '1': {'precision': 0.36389285714285713, 'recall': 0.42552569483597485, 'f1-score': 0.3923033237397607, 'support': 95778}, '2': {'precision': 0.37045857288334016, 'recall': 0.4831982429535115, 'f1-score': 0.4193838277477216, 'support': 95615}, 'accuracy': 0.3621517027863777, 'macro avg': {'precision': 0.35364425250109904, 'recall': 0.35004265632264553, 'f1-score': 0.3363477983494487, 'support': 271320}, 'weighted avg': {'precision': 0.35521521553490826, 'recall': 0.3621517027863777, 'f1-score': 0.34441804846798746, 'support': 271320}}
[[11302 32261 36364]
 [12874 40756 42148]
 [10431 38983 46201]]
Evaluating performance on  train set...
273/273 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977784
{'0': {'precision': 0.4138159639352957, 'recall': 0.1287381924679289, 'f1-score': 0.19638194116721727, 'support': 24243}, '1': {'precision': 0.3421255699754472, 'recall': 0.42590166797659595, 'f1-score': 0.3794444876682487, 'support': 22902}, '2': {'precision': 0.3616622542166166, 'recall': 0.5397797904457468, 'f1-score': 0.43312374200673304, 'support': 22524}, 'accuracy': 0.35931332443410985, 'macro avg': {'precision': 0.37253459604245315, 'recall': 0.36480655029675724, 'f1-score': 0.33631672361406634, 'support': 69669}, 'weighted avg': {'precision': 0.37338817596400314, 'recall': 0.35931332443410985, 'f1-score': 0.33309799510908344, 'support': 69669}}
[[ 3121 10426 10696]
 [ 2385  9754 10763]
 [ 2036  8330 12158]]
Evaluating performance on  val set...
96/96 - 1s - 958ms/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1134727
{'0': {'precision': 0.39588581024349284, 'recall': 0.10691609977324264, 'f1-score': 0.16836279235850743, 'support': 8820}, '1': {'precision': 0.29680985164355667, 'recall': 0.4032406797523383, 'f1-score': 0.341934763181412, 'support': 7591}, '2': {'precision': 0.3369473149246146, 'recall': 0.4917181705809642, 'f1-score': 0.3998793727382388, 'support': 8090}, 'accuracy': 0.3257826211175054, 'macro avg': {'precision': 0.343214325603888, 'recall': 0.33395831670218173, 'f1-score': 0.3033923094260527, 'support': 24501}, 'weighted avg': {'precision': 0.3457287542514174, 'recall': 0.3257826211175054, 'f1-score': 0.2985841696814206, 'support': 24501}}
[[ 943 3903 3974]
 [ 676 3061 3854]
 [ 763 3349 3978]]
training model: results/LILAK/W5/deepVOL_L3/h10
Epoch 1/50
273/273 - 13s - loss: 3.3273 - accuracy10: 0.3637 - val_loss: 3.5300 - val_accuracy10: 0.4477 - 13s/epoch - 49ms/step
Epoch 2/50
273/273 - 10s - loss: 3.2916 - accuracy10: 0.3796 - val_loss: 3.4412 - val_accuracy10: 0.4508 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.2631 - accuracy10: 0.3928 - val_loss: 3.4063 - val_accuracy10: 0.4605 - 10s/epoch - 38ms/step
Epoch 4/50
273/273 - 11s - loss: 3.2279 - accuracy10: 0.4131 - val_loss: 3.2983 - val_accuracy10: 0.4616 - 11s/epoch - 39ms/step
Epoch 5/50
273/273 - 10s - loss: 3.1906 - accuracy10: 0.4293 - val_loss: 3.2827 - val_accuracy10: 0.4643 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 10s - loss: 3.1748 - accuracy10: 0.4354 - val_loss: 3.2461 - val_accuracy10: 0.4714 - 10s/epoch - 38ms/step
Epoch 7/50
273/273 - 10s - loss: 3.1506 - accuracy10: 0.4452 - val_loss: 3.1803 - val_accuracy10: 0.4614 - 10s/epoch - 38ms/step
Epoch 8/50
273/273 - 10s - loss: 3.1186 - accuracy10: 0.4510 - val_loss: 3.1610 - val_accuracy10: 0.4635 - 10s/epoch - 38ms/step
Epoch 9/50
273/273 - 10s - loss: 3.0910 - accuracy10: 0.4525 - val_loss: 3.1371 - val_accuracy10: 0.4661 - 10s/epoch - 38ms/step
Epoch 10/50
273/273 - 10s - loss: 3.0613 - accuracy10: 0.4589 - val_loss: 3.1026 - val_accuracy10: 0.4815 - 10s/epoch - 38ms/step
Epoch 11/50
273/273 - 10s - loss: 3.0467 - accuracy10: 0.4624 - val_loss: 3.0849 - val_accuracy10: 0.4884 - 10s/epoch - 37ms/step
Epoch 12/50
273/273 - 10s - loss: 3.0297 - accuracy10: 0.4694 - val_loss: 3.1084 - val_accuracy10: 0.4901 - 10s/epoch - 37ms/step
Epoch 13/50
273/273 - 10s - loss: 3.0073 - accuracy10: 0.4736 - val_loss: 3.0705 - val_accuracy10: 0.4885 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 2.9907 - accuracy10: 0.4804 - val_loss: 3.0978 - val_accuracy10: 0.4871 - 10s/epoch - 37ms/step
Epoch 15/50
273/273 - 10s - loss: 2.9813 - accuracy10: 0.4828 - val_loss: 3.0490 - val_accuracy10: 0.4940 - 10s/epoch - 38ms/step
Epoch 16/50
273/273 - 10s - loss: 2.9740 - accuracy10: 0.4861 - val_loss: 3.0594 - val_accuracy10: 0.4875 - 10s/epoch - 37ms/step
Epoch 17/50
273/273 - 10s - loss: 2.9650 - accuracy10: 0.4903 - val_loss: 3.1226 - val_accuracy10: 0.4960 - 10s/epoch - 38ms/step
Epoch 18/50
273/273 - 10s - loss: 2.9511 - accuracy10: 0.4927 - val_loss: 3.0596 - val_accuracy10: 0.4912 - 10s/epoch - 38ms/step
Epoch 19/50
273/273 - 10s - loss: 2.9401 - accuracy10: 0.4985 - val_loss: 3.0942 - val_accuracy10: 0.4883 - 10s/epoch - 38ms/step
Epoch 20/50
273/273 - 10s - loss: 2.9288 - accuracy10: 0.5021 - val_loss: 3.1074 - val_accuracy10: 0.4983 - 10s/epoch - 38ms/step
Epoch 21/50
273/273 - 10s - loss: 2.9208 - accuracy10: 0.5029 - val_loss: 3.1052 - val_accuracy10: 0.4996 - 10s/epoch - 38ms/step
Epoch 22/50
273/273 - 10s - loss: 2.9121 - accuracy10: 0.5058 - val_loss: 3.0949 - val_accuracy10: 0.4994 - 10s/epoch - 38ms/step
Epoch 23/50
273/273 - 10s - loss: 2.9032 - accuracy10: 0.5094 - val_loss: 3.1028 - val_accuracy10: 0.4999 - 10s/epoch - 38ms/step
Epoch 24/50
273/273 - 10s - loss: 2.8942 - accuracy10: 0.5127 - val_loss: 3.1119 - val_accuracy10: 0.4988 - 10s/epoch - 38ms/step
Epoch 25/50
273/273 - 10s - loss: 2.8893 - accuracy10: 0.5134 - val_loss: 3.1261 - val_accuracy10: 0.4997 - 10s/epoch - 38ms/step
testing model: results/LILAK/W5/deepVOL_L3/h10
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0363079
{'0': {'precision': 0.4114390243902439, 'recall': 0.5676103097871195, 'f1-score': 0.4770689768945785, 'support': 89158}, '1': {'precision': 0.5848382423949783, 'recall': 0.374200591124888, 'f1-score': 0.45638780905967985, 'support': 97103}, '2': {'precision': 0.4306067989325908, 'recall': 0.43633242807933315, 'f1-score': 0.43345070628149657, 'support': 85059}, 'accuracy': 0.45723499926286304, 'macro avg': {'precision': 0.47562802190593767, 'recall': 0.45938110966378015, 'f1-score': 0.45563583074525166, 'support': 271320}, 'weighted avg': {'precision': 0.47950616282718633, 'recall': 0.45723499926286304, 'f1-score': 0.4559930152244093, 'support': 271320}}
[[50607 14273 24278]
 [35969 36336 24798]
 [36424 11521 37114]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9948038
{'0': {'precision': 0.3776263921313483, 'recall': 0.5397111913357401, 'f1-score': 0.44434937290310955, 'support': 18282}, '1': {'precision': 0.6897610593992899, 'recall': 0.4373592941892303, 'f1-score': 0.5352993744414656, 'support': 32870}, '2': {'precision': 0.40100449378799896, 'recall': 0.4915483069611708, 'f1-score': 0.4416838529661531, 'support': 18517}, 'accuracy': 0.4786203332902726, 'macro avg': {'precision': 0.48946398177287903, 'recall': 0.4895395974953804, 'f1-score': 0.4737775334369094, 'support': 69669}, 'weighted avg': {'precision': 0.531105828056558, 'recall': 0.4786203332902726, 'f1-score': 0.4865513439073315, 'support': 69669}}
[[ 9867  3422  4993]
 [ 9891 14376  8603]
 [ 6371  3044  9102]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98735774
{'0': {'precision': 0.4106304706330077, 'recall': 0.47743362831858405, 'f1-score': 0.4415194707767851, 'support': 6780}, '1': {'precision': 0.6592687770120313, 'recall': 0.5007541478129713, 'f1-score': 0.5691811214199274, 'support': 11271}, '2': {'precision': 0.3955566588060072, 'recall': 0.49410852713178294, 'f1-score': 0.4393740952643551, 'support': 6450}, 'accuracy': 0.4925513244357373, 'macro avg': {'precision': 0.48848530215034874, 'recall': 0.49076543442111276, 'f1-score': 0.48335822915368915, 'support': 24501}, 'weighted avg': {'precision': 0.5210413218192377, 'recall': 0.4925513244357373, 'f1-score': 0.4996818638359943, 'support': 24501}}
[[3237 1585 1958]
 [2715 5644 2912]
 [1931 1332 3187]]
training model: results/LILAK/W5/deepVOL_L3/h20
Epoch 1/50
273/273 - 12s - loss: 3.3383 - accuracy20: 0.3607 - val_loss: 3.4105 - val_accuracy20: 0.3666 - 12s/epoch - 45ms/step
Epoch 2/50
273/273 - 10s - loss: 3.2998 - accuracy20: 0.3724 - val_loss: 3.3362 - val_accuracy20: 0.3888 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.2446 - accuracy20: 0.3952 - val_loss: 3.2845 - val_accuracy20: 0.4109 - 10s/epoch - 37ms/step
Epoch 4/50
273/273 - 11s - loss: 3.1961 - accuracy20: 0.4214 - val_loss: 3.2194 - val_accuracy20: 0.4327 - 11s/epoch - 39ms/step
Epoch 5/50
273/273 - 10s - loss: 3.1694 - accuracy20: 0.4323 - val_loss: 3.1920 - val_accuracy20: 0.4402 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 10s - loss: 3.1537 - accuracy20: 0.4396 - val_loss: 3.2161 - val_accuracy20: 0.4402 - 10s/epoch - 38ms/step
Epoch 7/50
273/273 - 10s - loss: 3.1435 - accuracy20: 0.4430 - val_loss: 3.1909 - val_accuracy20: 0.4441 - 10s/epoch - 38ms/step
Epoch 8/50
273/273 - 10s - loss: 3.1348 - accuracy20: 0.4496 - val_loss: 3.1753 - val_accuracy20: 0.4375 - 10s/epoch - 37ms/step
Epoch 9/50
273/273 - 10s - loss: 3.1235 - accuracy20: 0.4533 - val_loss: 3.1852 - val_accuracy20: 0.4455 - 10s/epoch - 37ms/step
Epoch 10/50
273/273 - 10s - loss: 3.1112 - accuracy20: 0.4603 - val_loss: 3.1631 - val_accuracy20: 0.4533 - 10s/epoch - 38ms/step
Epoch 11/50
273/273 - 10s - loss: 3.0937 - accuracy20: 0.4653 - val_loss: 3.1361 - val_accuracy20: 0.4557 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.0729 - accuracy20: 0.4697 - val_loss: 3.1135 - val_accuracy20: 0.4638 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.0489 - accuracy20: 0.4745 - val_loss: 3.0948 - val_accuracy20: 0.4661 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 3.0308 - accuracy20: 0.4789 - val_loss: 3.0883 - val_accuracy20: 0.4723 - 10s/epoch - 37ms/step
Epoch 15/50
273/273 - 10s - loss: 3.0161 - accuracy20: 0.4820 - val_loss: 3.0844 - val_accuracy20: 0.4772 - 10s/epoch - 38ms/step
Epoch 16/50
273/273 - 10s - loss: 2.9992 - accuracy20: 0.4879 - val_loss: 3.1015 - val_accuracy20: 0.4714 - 10s/epoch - 38ms/step
Epoch 17/50
273/273 - 11s - loss: 2.9893 - accuracy20: 0.4919 - val_loss: 3.0651 - val_accuracy20: 0.4819 - 11s/epoch - 39ms/step
Epoch 18/50
273/273 - 10s - loss: 2.9775 - accuracy20: 0.4948 - val_loss: 3.0877 - val_accuracy20: 0.4744 - 10s/epoch - 37ms/step
Epoch 19/50
273/273 - 10s - loss: 2.9681 - accuracy20: 0.4986 - val_loss: 3.0980 - val_accuracy20: 0.4805 - 10s/epoch - 37ms/step
Epoch 20/50
273/273 - 10s - loss: 2.9585 - accuracy20: 0.5021 - val_loss: 3.0981 - val_accuracy20: 0.4868 - 10s/epoch - 37ms/step
Epoch 21/50
273/273 - 10s - loss: 2.9456 - accuracy20: 0.5064 - val_loss: 3.1004 - val_accuracy20: 0.4791 - 10s/epoch - 37ms/step
Epoch 22/50
273/273 - 10s - loss: 2.9391 - accuracy20: 0.5081 - val_loss: 3.1111 - val_accuracy20: 0.4773 - 10s/epoch - 37ms/step
Epoch 23/50
273/273 - 10s - loss: 2.9313 - accuracy20: 0.5109 - val_loss: 3.1095 - val_accuracy20: 0.4802 - 10s/epoch - 37ms/step
Epoch 24/50
273/273 - 10s - loss: 2.9199 - accuracy20: 0.5135 - val_loss: 3.1475 - val_accuracy20: 0.4754 - 10s/epoch - 37ms/step
Epoch 25/50
273/273 - 10s - loss: 2.9140 - accuracy20: 0.5156 - val_loss: 3.1197 - val_accuracy20: 0.4754 - 10s/epoch - 38ms/step
Epoch 26/50
273/273 - 10s - loss: 2.9046 - accuracy20: 0.5178 - val_loss: 3.1494 - val_accuracy20: 0.4697 - 10s/epoch - 38ms/step
Epoch 27/50
273/273 - 10s - loss: 2.8985 - accuracy20: 0.5193 - val_loss: 3.1692 - val_accuracy20: 0.4573 - 10s/epoch - 37ms/step
testing model: results/LILAK/W5/deepVOL_L3/h20
Evaluating performance on  test set...
1060/1060 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0383203
{'0': {'precision': 0.4474879017980092, 'recall': 0.5532811207861069, 'f1-score': 0.4947927089224344, 'support': 102785}, '1': {'precision': 0.47865, 'recall': 0.40028154487295636, 'f1-score': 0.43597197659149733, 'support': 71747}, '2': {'precision': 0.4554282661601472, 'recall': 0.3963611191470017, 'f1-score': 0.4238466935140839, 'support': 96788}, 'accuracy': 0.456844316674038, 'macro avg': {'precision': 0.4605220559860521, 'recall': 0.449974594935355, 'f1-score': 0.4515371263426719, 'support': 271320}, 'weighted avg': {'precision': 0.4585608748393657, 'recall': 0.456844316674038, 'f1-score': 0.453929764716732, 'support': 271320}}
[[56869 16616 29300]
 [26456 28719 16572]
 [43760 14665 38363]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0126922
{'0': {'precision': 0.423116238317757, 'recall': 0.5287167556224625, 'f1-score': 0.47005860523594184, 'support': 21921}, '1': {'precision': 0.5882149731036865, 'recall': 0.46636929217044254, 'f1-score': 0.520253164556962, 'support': 25557}, '2': {'precision': 0.4514854183701281, 'recall': 0.4478842774097607, 'f1-score': 0.44967763827621304, 'support': 22191}, 'accuracy': 0.48009875267335544, 'macro avg': {'precision': 0.4876055432638573, 'recall': 0.48099010840088857, 'f1-score': 0.4799964693563723, 'support': 69669}, 'weighted avg': {'precision': 0.49271633074719007, 'recall': 0.48009875267335544, 'f1-score': 0.4819799521013191, 'support': 69669}}
[[11590  4299  6032]
 [ 7595 11919  6043]
 [ 8207  4045  9939]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.018068
{'0': {'precision': 0.4478535197327725, 'recall': 0.45289628424871764, 'f1-score': 0.4503607862652402, 'support': 7993}, '1': {'precision': 0.5619834710743802, 'recall': 0.5067750677506775, 'f1-score': 0.5329533309583184, 'support': 8856}, '2': {'precision': 0.4334677419354839, 'recall': 0.47765290120230003, 'f1-score': 0.45448893310121863, 'support': 7652}, 'accuracy': 0.4801028529447778, 'macro avg': {'precision': 0.4811015775808789, 'recall': 0.47910808440056507, 'f1-score': 0.4792676834415925, 'support': 24501}, 'weighted avg': {'precision': 0.4846134428941302, 'recall': 0.4801028529447778, 'f1-score': 0.4815035214756727, 'support': 24501}}
[[3620 1882 2491]
 [2082 4488 2286]
 [2381 1616 3655]]
training model: results/LILAK/W5/deepVOL_L3/h30
Epoch 1/50
273/273 - 12s - loss: 3.3278 - accuracy30: 0.3651 - val_loss: 3.5654 - val_accuracy30: 0.3278 - 12s/epoch - 45ms/step
Epoch 2/50
273/273 - 10s - loss: 3.2906 - accuracy30: 0.3757 - val_loss: 3.4145 - val_accuracy30: 0.3504 - 10s/epoch - 37ms/step
Epoch 3/50
273/273 - 10s - loss: 3.2748 - accuracy30: 0.3766 - val_loss: 3.3624 - val_accuracy30: 0.3629 - 10s/epoch - 38ms/step
Epoch 4/50
273/273 - 10s - loss: 3.2350 - accuracy30: 0.3933 - val_loss: 3.3138 - val_accuracy30: 0.3873 - 10s/epoch - 38ms/step
Epoch 5/50
273/273 - 10s - loss: 3.1983 - accuracy30: 0.4100 - val_loss: 3.2319 - val_accuracy30: 0.4116 - 10s/epoch - 37ms/step
Epoch 6/50
273/273 - 10s - loss: 3.1760 - accuracy30: 0.4204 - val_loss: 3.2434 - val_accuracy30: 0.4144 - 10s/epoch - 37ms/step
Epoch 7/50
273/273 - 10s - loss: 3.1637 - accuracy30: 0.4259 - val_loss: 3.2692 - val_accuracy30: 0.4141 - 10s/epoch - 37ms/step
Epoch 8/50
273/273 - 10s - loss: 3.1555 - accuracy30: 0.4294 - val_loss: 3.2612 - val_accuracy30: 0.4102 - 10s/epoch - 37ms/step
Epoch 9/50
273/273 - 10s - loss: 3.1449 - accuracy30: 0.4323 - val_loss: 3.2672 - val_accuracy30: 0.4183 - 10s/epoch - 37ms/step
Epoch 10/50
273/273 - 10s - loss: 3.1329 - accuracy30: 0.4385 - val_loss: 3.2348 - val_accuracy30: 0.4237 - 10s/epoch - 37ms/step
Epoch 11/50
273/273 - 10s - loss: 3.1215 - accuracy30: 0.4447 - val_loss: 3.1988 - val_accuracy30: 0.4276 - 10s/epoch - 37ms/step
Epoch 12/50
273/273 - 10s - loss: 3.1125 - accuracy30: 0.4474 - val_loss: 3.1780 - val_accuracy30: 0.4322 - 10s/epoch - 37ms/step
Epoch 13/50
273/273 - 10s - loss: 3.0936 - accuracy30: 0.4554 - val_loss: 3.1788 - val_accuracy30: 0.4418 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 3.0755 - accuracy30: 0.4617 - val_loss: 3.1988 - val_accuracy30: 0.4352 - 10s/epoch - 37ms/step
Epoch 15/50
273/273 - 10s - loss: 3.0656 - accuracy30: 0.4666 - val_loss: 3.2003 - val_accuracy30: 0.4363 - 10s/epoch - 37ms/step
Epoch 16/50
273/273 - 10s - loss: 3.0483 - accuracy30: 0.4735 - val_loss: 3.1647 - val_accuracy30: 0.4543 - 10s/epoch - 37ms/step
Epoch 17/50
273/273 - 10s - loss: 3.0413 - accuracy30: 0.4771 - val_loss: 3.1498 - val_accuracy30: 0.4552 - 10s/epoch - 38ms/step
Epoch 18/50
273/273 - 10s - loss: 3.0302 - accuracy30: 0.4799 - val_loss: 3.1584 - val_accuracy30: 0.4549 - 10s/epoch - 37ms/step
Epoch 19/50
273/273 - 10s - loss: 3.0192 - accuracy30: 0.4848 - val_loss: 3.1561 - val_accuracy30: 0.4560 - 10s/epoch - 37ms/step
Epoch 20/50
273/273 - 10s - loss: 3.0085 - accuracy30: 0.4865 - val_loss: 3.1369 - val_accuracy30: 0.4625 - 10s/epoch - 37ms/step
Epoch 21/50
273/273 - 10s - loss: 3.0018 - accuracy30: 0.4896 - val_loss: 3.1521 - val_accuracy30: 0.4592 - 10s/epoch - 37ms/step
Epoch 22/50
273/273 - 10s - loss: 2.9924 - accuracy30: 0.4938 - val_loss: 3.1575 - val_accuracy30: 0.4597 - 10s/epoch - 37ms/step
Epoch 23/50
273/273 - 10s - loss: 2.9841 - accuracy30: 0.4962 - val_loss: 3.1705 - val_accuracy30: 0.4614 - 10s/epoch - 38ms/step
Epoch 24/50
273/273 - 10s - loss: 2.9804 - accuracy30: 0.4966 - val_loss: 3.1668 - val_accuracy30: 0.4585 - 10s/epoch - 38ms/step
Epoch 25/50
273/273 - 10s - loss: 2.9701 - accuracy30: 0.4995 - val_loss: 3.1699 - val_accuracy30: 0.4620 - 10s/epoch - 38ms/step
Epoch 26/50
273/273 - 10s - loss: 2.9637 - accuracy30: 0.5031 - val_loss: 3.1775 - val_accuracy30: 0.4617 - 10s/epoch - 38ms/step
Epoch 27/50
273/273 - 10s - loss: 2.9486 - accuracy30: 0.5088 - val_loss: 3.1682 - val_accuracy30: 0.4623 - 10s/epoch - 37ms/step
Epoch 28/50
273/273 - 10s - loss: 2.9436 - accuracy30: 0.5081 - val_loss: 3.1663 - val_accuracy30: 0.4616 - 10s/epoch - 38ms/step
Epoch 29/50
273/273 - 10s - loss: 2.9353 - accuracy30: 0.5119 - val_loss: 3.1595 - val_accuracy30: 0.4600 - 10s/epoch - 38ms/step
Epoch 30/50
273/273 - 10s - loss: 2.9307 - accuracy30: 0.5135 - val_loss: 3.1648 - val_accuracy30: 0.4583 - 10s/epoch - 38ms/step
testing model: results/LILAK/W5/deepVOL_L3/h30
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.061256
{'0': {'precision': 0.44515016850241274, 'recall': 0.5938566231220193, 'f1-score': 0.5088616897984567, 'support': 106098}, '1': {'precision': 0.4130087924771701, 'recall': 0.3755633759338149, 'f1-score': 0.3933970348094614, 'support': 64788}, '2': {'precision': 0.45736259084174136, 'recall': 0.3227094410259474, 'f1-score': 0.3784143515140193, 'support': 100434}, 'accuracy': 0.4413607548282471, 'macro avg': {'precision': 0.43850718394044136, 'recall': 0.43070981336059383, 'f1-score': 0.4268910253739791, 'support': 271320}, 'weighted avg': {'precision': 0.44199583765803974, 'recall': 0.4413607548282471, 'f1-score': 0.4330026597207396, 'support': 271320}}
[[63007 18638 24453]
 [26455 24332 14001]
 [52079 15944 32411]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.029426
{'0': {'precision': 0.4320504382166488, 'recall': 0.5330370117104026, 'f1-score': 0.4772601167129054, 'support': 23398}, '1': {'precision': 0.5282928003852637, 'recall': 0.4817531070220895, 'f1-score': 0.5039507533994855, 'support': 22771}, '2': {'precision': 0.4681339521884514, 'recall': 0.39914893617021274, 'f1-score': 0.4308978569951995, 'support': 23500}, 'accuracy': 0.47111340768491006, 'macro avg': {'precision': 0.476159063596788, 'recall': 0.4713130183009016, 'f1-score': 0.4707029090358635, 'support': 69669}, 'weighted avg': {'precision': 0.47567812638899076, 'recall': 0.47111340768491006, 'f1-score': 0.47034541124309864, 'support': 69669}}
[[12472  5150  5776]
 [ 6920 10970  4881]
 [ 9475  4645  9380]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0469704
{'0': {'precision': 0.4431408990591242, 'recall': 0.4536266349583829, 'f1-score': 0.44832246312944357, 'support': 8410}, '1': {'precision': 0.5005331121904988, 'recall': 0.5299799297541394, 'f1-score': 0.5148358008895387, 'support': 7972}, '2': {'precision': 0.4381962152731177, 'recall': 0.4021431210740239, 'f1-score': 0.41939627488760434, 'support': 8119}, 'accuracy': 0.4614097383780254, 'macro avg': {'precision': 0.4606234088409136, 'recall': 0.4619165619288487, 'f1-score': 0.46085151296886223, 'support': 24501}, 'weighted avg': {'precision': 0.4601763194674639, 'recall': 0.4614097383780254, 'f1-score': 0.46037881210654596, 'support': 24501}}
[[3815 2294 2301]
 [1862 4225 1885]
 [2932 1922 3265]]
training model: results/LILAK/W5/deepVOL_L3/h50
Epoch 1/50
273/273 - 13s - loss: 3.3421 - accuracy50: 0.3575 - val_loss: 3.5031 - val_accuracy50: 0.3289 - 13s/epoch - 48ms/step
Epoch 2/50
273/273 - 11s - loss: 3.3045 - accuracy50: 0.3627 - val_loss: 3.4925 - val_accuracy50: 0.3270 - 11s/epoch - 39ms/step
Epoch 3/50
273/273 - 10s - loss: 3.2882 - accuracy50: 0.3724 - val_loss: 3.4429 - val_accuracy50: 0.3289 - 10s/epoch - 37ms/step
Epoch 4/50
273/273 - 10s - loss: 3.2798 - accuracy50: 0.3729 - val_loss: 3.4961 - val_accuracy50: 0.3310 - 10s/epoch - 38ms/step
Epoch 5/50
273/273 - 10s - loss: 3.2725 - accuracy50: 0.3777 - val_loss: 3.4334 - val_accuracy50: 0.3393 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 11s - loss: 3.2582 - accuracy50: 0.3856 - val_loss: 3.3815 - val_accuracy50: 0.3593 - 11s/epoch - 39ms/step
Epoch 7/50
273/273 - 11s - loss: 3.2328 - accuracy50: 0.4001 - val_loss: 3.3137 - val_accuracy50: 0.3820 - 11s/epoch - 39ms/step
Epoch 8/50
273/273 - 10s - loss: 3.2127 - accuracy50: 0.4115 - val_loss: 3.3030 - val_accuracy50: 0.3876 - 10s/epoch - 38ms/step
Epoch 9/50
273/273 - 11s - loss: 3.1986 - accuracy50: 0.4179 - val_loss: 3.2888 - val_accuracy50: 0.3997 - 11s/epoch - 38ms/step
Epoch 10/50
273/273 - 11s - loss: 3.1836 - accuracy50: 0.4215 - val_loss: 3.3214 - val_accuracy50: 0.3852 - 11s/epoch - 40ms/step
Epoch 11/50
273/273 - 10s - loss: 3.1753 - accuracy50: 0.4255 - val_loss: 3.3275 - val_accuracy50: 0.3882 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.1625 - accuracy50: 0.4305 - val_loss: 3.3606 - val_accuracy50: 0.3889 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.1507 - accuracy50: 0.4345 - val_loss: 3.3463 - val_accuracy50: 0.3891 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 3.1382 - accuracy50: 0.4408 - val_loss: 3.3251 - val_accuracy50: 0.3981 - 10s/epoch - 38ms/step
Epoch 15/50
273/273 - 10s - loss: 3.1305 - accuracy50: 0.4405 - val_loss: 3.3154 - val_accuracy50: 0.4047 - 10s/epoch - 38ms/step
Epoch 16/50
273/273 - 10s - loss: 3.1230 - accuracy50: 0.4453 - val_loss: 3.2980 - val_accuracy50: 0.4077 - 10s/epoch - 38ms/step
Epoch 17/50
273/273 - 10s - loss: 3.1180 - accuracy50: 0.4482 - val_loss: 3.3051 - val_accuracy50: 0.4054 - 10s/epoch - 38ms/step
Epoch 18/50
273/273 - 10s - loss: 3.1083 - accuracy50: 0.4520 - val_loss: 3.3226 - val_accuracy50: 0.4090 - 10s/epoch - 38ms/step
Epoch 19/50
273/273 - 10s - loss: 3.0950 - accuracy50: 0.4589 - val_loss: 3.3003 - val_accuracy50: 0.4227 - 10s/epoch - 38ms/step
testing model: results/LILAK/W5/deepVOL_L3/h50
Evaluating performance on  test set...
1060/1060 - 17s - 17s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1136154
{'0': {'precision': 0.4050911234019403, 'recall': 0.1756156522080934, 'f1-score': 0.24501295603175255, 'support': 101762}, '1': {'precision': 0.3090978141615326, 'recall': 0.5209963299098125, 'f1-score': 0.388001356018391, 'support': 70298}, '2': {'precision': 0.4031771436981438, 'recall': 0.4415776747934717, 'f1-score': 0.4215046111533173, 'support': 99260}, 'accuracy': 0.36240232935279376, 'macro avg': {'precision': 0.3724553604205389, 'recall': 0.37939655230379254, 'f1-score': 0.3515063077344869, 'support': 271320}, 'weighted avg': {'precision': 0.3795194026353878, 'recall': 0.36240232935279376, 'f1-score': 0.3466286136671175, 'support': 271320}}
[[17871 42941 40950]
 [ 9740 36625 23933]
 [16505 38924 43831]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856334
{'0': {'precision': 0.40291065894084355, 'recall': 0.12770137524557956, 'f1-score': 0.19393546294794875, 'support': 23414}, '1': {'precision': 0.4031310588303383, 'recall': 0.6064867218110579, 'f1-score': 0.48432909764110765, 'support': 22970}, '2': {'precision': 0.4121555740132173, 'recall': 0.49014386944384797, 'f1-score': 0.44777934714375395, 'support': 23285}, 'accuracy': 0.4066945126239791, 'macro avg': {'precision': 0.40606576392813304, 'recall': 0.40811065550016185, 'f1-score': 0.3753479692442701, 'support': 69669}, 'weighted avg': {'precision': 0.406073190811861, 'recall': 0.4066945126239791, 'f1-score': 0.37451931849921527, 'support': 69669}}
[[ 2990 11300  9124]
 [ 1885 13931  7154]
 [ 2546  9326 11413]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966527
{'0': {'precision': 0.39945155393053017, 'recall': 0.10499759730898607, 'f1-score': 0.16628614916286147, 'support': 8324}, '1': {'precision': 0.3910934393638171, 'recall': 0.6156735102653981, 'f1-score': 0.4783348733161504, 'support': 7988}, '2': {'precision': 0.40737317724378724, 'recall': 0.48443033337403835, 'f1-score': 0.4425726557706253, 'support': 8189}, 'accuracy': 0.3983102730500796, 'macro avg': {'precision': 0.39930605684604487, 'recall': 0.4017004803161408, 'f1-score': 0.36239789274987905, 'support': 24501}, 'weighted avg': {'precision': 0.39937423276622497, 'recall': 0.3983102730500796, 'f1-score': 0.3603662034931929, 'support': 24501}}
[[ 874 4194 3256]
 [ 555 4918 2515]
 [ 759 3463 3967]]
training model: results/LILAK/W5/deepVOL_L3/h100
Epoch 1/50
273/273 - 12s - loss: 3.3474 - accuracy100: 0.3492 - val_loss: 3.3528 - val_accuracy100: 0.3181 - 12s/epoch - 46ms/step
Epoch 2/50
273/273 - 10s - loss: 3.3124 - accuracy100: 0.3492 - val_loss: 3.3223 - val_accuracy100: 0.3196 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.3059 - accuracy100: 0.3480 - val_loss: 3.3141 - val_accuracy100: 0.3144 - 10s/epoch - 38ms/step
Epoch 4/50
273/273 - 10s - loss: 3.3008 - accuracy100: 0.3516 - val_loss: 3.3000 - val_accuracy100: 0.3300 - 10s/epoch - 37ms/step
Epoch 5/50
273/273 - 10s - loss: 3.2920 - accuracy100: 0.3580 - val_loss: 3.2881 - val_accuracy100: 0.3443 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 10s - loss: 3.2878 - accuracy100: 0.3599 - val_loss: 3.2853 - val_accuracy100: 0.3526 - 10s/epoch - 37ms/step
Epoch 7/50
273/273 - 10s - loss: 3.2783 - accuracy100: 0.3669 - val_loss: 3.2849 - val_accuracy100: 0.3593 - 10s/epoch - 38ms/step
Epoch 8/50
273/273 - 10s - loss: 3.2736 - accuracy100: 0.3720 - val_loss: 3.2804 - val_accuracy100: 0.3679 - 10s/epoch - 38ms/step
Epoch 9/50
273/273 - 10s - loss: 3.2684 - accuracy100: 0.3800 - val_loss: 3.2873 - val_accuracy100: 0.3648 - 10s/epoch - 38ms/step
Epoch 10/50
273/273 - 10s - loss: 3.2652 - accuracy100: 0.3818 - val_loss: 3.2805 - val_accuracy100: 0.3784 - 10s/epoch - 37ms/step
Epoch 11/50
273/273 - 10s - loss: 3.2582 - accuracy100: 0.3851 - val_loss: 3.2849 - val_accuracy100: 0.3788 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.2502 - accuracy100: 0.3893 - val_loss: 3.2711 - val_accuracy100: 0.3778 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.2458 - accuracy100: 0.3914 - val_loss: 3.2839 - val_accuracy100: 0.3763 - 10s/epoch - 37ms/step
Epoch 14/50
273/273 - 10s - loss: 3.2384 - accuracy100: 0.3966 - val_loss: 3.2817 - val_accuracy100: 0.3780 - 10s/epoch - 38ms/step
Epoch 15/50
273/273 - 10s - loss: 3.2307 - accuracy100: 0.3997 - val_loss: 3.2966 - val_accuracy100: 0.3743 - 10s/epoch - 37ms/step
Epoch 16/50
273/273 - 10s - loss: 3.2225 - accuracy100: 0.4057 - val_loss: 3.3013 - val_accuracy100: 0.3776 - 10s/epoch - 37ms/step
Epoch 17/50
273/273 - 10s - loss: 3.2142 - accuracy100: 0.4087 - val_loss: 3.3080 - val_accuracy100: 0.3772 - 10s/epoch - 38ms/step
Epoch 18/50
273/273 - 10s - loss: 3.2051 - accuracy100: 0.4144 - val_loss: 3.3160 - val_accuracy100: 0.3780 - 10s/epoch - 38ms/step
Epoch 19/50
273/273 - 10s - loss: 3.1917 - accuracy100: 0.4186 - val_loss: 3.3232 - val_accuracy100: 0.3750 - 10s/epoch - 38ms/step
Epoch 20/50
273/273 - 10s - loss: 3.1812 - accuracy100: 0.4266 - val_loss: 3.3345 - val_accuracy100: 0.3748 - 10s/epoch - 38ms/step
Epoch 21/50
273/273 - 10s - loss: 3.1685 - accuracy100: 0.4291 - val_loss: 3.3423 - val_accuracy100: 0.3761 - 10s/epoch - 38ms/step
Epoch 22/50
273/273 - 10s - loss: 3.1582 - accuracy100: 0.4357 - val_loss: 3.3702 - val_accuracy100: 0.3764 - 10s/epoch - 38ms/step
testing model: results/LILAK/W5/deepVOL_L3/h100
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1063005
{'0': {'precision': 0.3898884789187845, 'recall': 0.3770509877817759, 'f1-score': 0.3833622925509419, 'support': 99769}, '1': {'precision': 0.2826520836659748, 'recall': 0.19889332059996628, 'f1-score': 0.23348831074619975, 'support': 71204}, '2': {'precision': 0.38048776576981047, 'recall': 0.47294886743001785, 'f1-score': 0.42170971081264796, 'support': 100347}, 'accuracy': 0.3657636738906089, 'macro avg': {'precision': 0.3510094427848565, 'recall': 0.34963105860391996, 'f1-score': 0.34618677136992987, 'support': 271320}, 'weighted avg': {'precision': 0.35826901242187614, 'recall': 0.3657636738906089, 'f1-score': 0.3582127325475605, 'support': 271320}}
[[37618 18086 44065]
 [23834 14162 33208]
 [35032 17856 47459]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0820059
{'0': {'precision': 0.3990870849369015, 'recall': 0.3779934726401899, 'f1-score': 0.38825398898539365, 'support': 23593}, '1': {'precision': 0.35766155651727427, 'recall': 0.2120092177920779, 'f1-score': 0.266215330858266, 'support': 22999}, '2': {'precision': 0.39759572573463936, 'recall': 0.5804480651731161, 'f1-score': 0.4719291137456621, 'support': 23077}, 'accuracy': 0.3902596563751453, 'macro avg': {'precision': 0.38478145572960504, 'recall': 0.39015025186846125, 'f1-score': 0.37546614452977395, 'support': 69669}, 'weighted avg': {'precision': 0.38491777255358023, 'recall': 0.3902596563751453, 'f1-score': 0.37568317206290164, 'support': 69669}}
[[ 8918  4840  9835]
 [ 7663  4876 10460]
 [ 5765  3917 13395]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913427
{'0': {'precision': 0.40562028786840304, 'recall': 0.33667083854818525, 'f1-score': 0.36794329768714246, 'support': 8789}, '1': {'precision': 0.298264182895851, 'recall': 0.19488243430152144, 'f1-score': 0.23573699180190733, 'support': 7230}, '2': {'precision': 0.3948886396410832, 'recall': 0.5811129450601273, 'f1-score': 0.47023468803663426, 'support': 8482}, 'accuracy': 0.37945389984082284, 'macro avg': {'precision': 0.3662577034684457, 'recall': 0.37088873930327804, 'f1-score': 0.35797165917522805, 'support': 24501}, 'weighted avg': {'precision': 0.3702253864678203, 'recall': 0.37945389984082284, 'f1-score': 0.36434279082595883, 'support': 24501}}
[[2959 1770 4060]
 [2328 1409 3493]
 [2008 1545 4929]]
training model: results/LILAK/W5/deepVOL_L3/h200
Epoch 1/50
273/273 - 13s - loss: 3.3641 - accuracy200: 0.3402 - val_loss: 3.4135 - val_accuracy200: 0.3178 - 13s/epoch - 48ms/step
Epoch 2/50
273/273 - 11s - loss: 3.3238 - accuracy200: 0.3451 - val_loss: 3.3936 - val_accuracy200: 0.3142 - 11s/epoch - 39ms/step
Epoch 3/50
273/273 - 11s - loss: 3.3123 - accuracy200: 0.3442 - val_loss: 3.3498 - val_accuracy200: 0.3044 - 11s/epoch - 39ms/step
Epoch 4/50
273/273 - 11s - loss: 3.3089 - accuracy200: 0.3473 - val_loss: 3.3605 - val_accuracy200: 0.3099 - 11s/epoch - 40ms/step
Epoch 5/50
273/273 - 11s - loss: 3.3043 - accuracy200: 0.3445 - val_loss: 3.3374 - val_accuracy200: 0.3045 - 11s/epoch - 39ms/step
Epoch 6/50
273/273 - 11s - loss: 3.2954 - accuracy200: 0.3514 - val_loss: 3.3306 - val_accuracy200: 0.3173 - 11s/epoch - 39ms/step
Epoch 7/50
273/273 - 11s - loss: 3.2876 - accuracy200: 0.3633 - val_loss: 3.3246 - val_accuracy200: 0.3213 - 11s/epoch - 39ms/step
Epoch 8/50
273/273 - 11s - loss: 3.2782 - accuracy200: 0.3691 - val_loss: 3.3288 - val_accuracy200: 0.3230 - 11s/epoch - 39ms/step
Epoch 9/50
273/273 - 11s - loss: 3.2709 - accuracy200: 0.3809 - val_loss: 3.3310 - val_accuracy200: 0.3324 - 11s/epoch - 39ms/step
Epoch 10/50
273/273 - 11s - loss: 3.2615 - accuracy200: 0.3880 - val_loss: 3.3377 - val_accuracy200: 0.3299 - 11s/epoch - 39ms/step
Epoch 11/50
273/273 - 11s - loss: 3.2475 - accuracy200: 0.3979 - val_loss: 3.3443 - val_accuracy200: 0.3419 - 11s/epoch - 38ms/step
Epoch 12/50
273/273 - 11s - loss: 3.2408 - accuracy200: 0.4016 - val_loss: 3.3645 - val_accuracy200: 0.3397 - 11s/epoch - 39ms/step
Epoch 13/50
273/273 - 11s - loss: 3.2242 - accuracy200: 0.4125 - val_loss: 3.3999 - val_accuracy200: 0.3421 - 11s/epoch - 39ms/step
Epoch 14/50
273/273 - 10s - loss: 3.2118 - accuracy200: 0.4170 - val_loss: 3.4483 - val_accuracy200: 0.3411 - 10s/epoch - 38ms/step
Epoch 15/50
273/273 - 11s - loss: 3.2002 - accuracy200: 0.4251 - val_loss: 3.4809 - val_accuracy200: 0.3405 - 11s/epoch - 39ms/step
Epoch 16/50
273/273 - 11s - loss: 3.1909 - accuracy200: 0.4262 - val_loss: 3.5415 - val_accuracy200: 0.3328 - 11s/epoch - 38ms/step
Epoch 17/50
273/273 - 11s - loss: 3.1783 - accuracy200: 0.4324 - val_loss: 3.5457 - val_accuracy200: 0.3390 - 11s/epoch - 39ms/step
testing model: results/LILAK/W5/deepVOL_L3/h200
Evaluating performance on  test set...
1060/1060 - 19s - 19s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1164438
{'0': {'precision': 0.35655618549207735, 'recall': 0.21530696219893564, 'f1-score': 0.2684874150800112, 'support': 91135}, '1': {'precision': 0.29606369175934855, 'recall': 0.7265924099565115, 'f1-score': 0.4207037555149037, 'support': 80711}, '2': {'precision': 0.3630622219781427, 'recall': 0.06645957737700303, 'f1-score': 0.11235267625740336, 'support': 99474}, 'accuracy': 0.3128298687896211, 'macro avg': {'precision': 0.33856069974318953, 'recall': 0.3361196498441501, 'f1-score': 0.26718128228410615, 'support': 271320}, 'weighted avg': {'precision': 0.3409464693331233, 'recall': 0.3128298687896211, 'f1-score': 0.25652436791504185, 'support': 271320}}
[[19622 66338  5175]
 [15644 58644  6423]
 [19766 73097  6611]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049074
{'0': {'precision': 0.39069990412272293, 'recall': 0.16747493013315798, 'f1-score': 0.23445141246188367, 'support': 24332}, '1': {'precision': 0.31943333268288876, 'recall': 0.7396195725839244, 'f1-score': 0.44617061869719266, 'support': 22133}, '2': {'precision': 0.3835085085085085, 'recall': 0.1320892949491467, 'f1-score': 0.19649955122451598, 'support': 23204}, 'accuracy': 0.3374528125852244, 'macro avg': {'precision': 0.36454724843804004, 'recall': 0.3463945992220763, 'f1-score': 0.29237386079453076, 'support': 69669}, 'weighted avg': {'precision': 0.36566420432065766, 'recall': 0.3374528125852244, 'f1-score': 0.2890717773796263, 'support': 69669}}
[[ 4075 17890  2367]
 [ 3203 16370  2560]
 [ 3152 16987  3065]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.114118
{'0': {'precision': 0.3968499073502162, 'recall': 0.14317548746518105, 'f1-score': 0.21043150741013675, 'support': 8975}, '1': {'precision': 0.28772215123707745, 'recall': 0.7020975056689343, 'f1-score': 0.4081733542061465, 'support': 7056}, '2': {'precision': 0.37972805933250925, 'recall': 0.18134592680047226, 'f1-score': 0.2454654414702357, 'support': 8470}, 'accuracy': 0.31733398636790333, 'macro avg': {'precision': 0.3547667059732676, 'recall': 0.34220630664486257, 'f1-score': 0.288023434362173, 'support': 24501}, 'weighted avg': {'precision': 0.3595033704805258, 'recall': 0.31733398636790333, 'f1-score': 0.2794900720598116, 'support': 24501}}
[[1285 6358 1332]
 [ 925 4954 1177]
 [1028 5906 1536]]
training model: results/LILAK/W5/deepVOL_L3/h300
Epoch 1/50
273/273 - 12s - loss: 3.3505 - accuracy300: 0.3517 - val_loss: 3.3346 - val_accuracy300: 0.3455 - 12s/epoch - 46ms/step
Epoch 2/50
273/273 - 10s - loss: 3.3185 - accuracy300: 0.3548 - val_loss: 3.2998 - val_accuracy300: 0.3656 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.3085 - accuracy300: 0.3512 - val_loss: 3.2903 - val_accuracy300: 0.3524 - 10s/epoch - 37ms/step
Epoch 4/50
273/273 - 11s - loss: 3.2978 - accuracy300: 0.3501 - val_loss: 3.2845 - val_accuracy300: 0.3510 - 11s/epoch - 39ms/step
Epoch 5/50
273/273 - 10s - loss: 3.2955 - accuracy300: 0.3536 - val_loss: 3.2886 - val_accuracy300: 0.3501 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 10s - loss: 3.2926 - accuracy300: 0.3543 - val_loss: 3.2941 - val_accuracy300: 0.3490 - 10s/epoch - 38ms/step
Epoch 7/50
273/273 - 10s - loss: 3.2888 - accuracy300: 0.3598 - val_loss: 3.3005 - val_accuracy300: 0.3517 - 10s/epoch - 38ms/step
Epoch 8/50
273/273 - 10s - loss: 3.2835 - accuracy300: 0.3629 - val_loss: 3.3046 - val_accuracy300: 0.3571 - 10s/epoch - 38ms/step
Epoch 9/50
273/273 - 10s - loss: 3.2777 - accuracy300: 0.3708 - val_loss: 3.3135 - val_accuracy300: 0.3588 - 10s/epoch - 38ms/step
Epoch 10/50
273/273 - 11s - loss: 3.2707 - accuracy300: 0.3745 - val_loss: 3.3339 - val_accuracy300: 0.3614 - 11s/epoch - 38ms/step
Epoch 11/50
273/273 - 10s - loss: 3.2660 - accuracy300: 0.3788 - val_loss: 3.3330 - val_accuracy300: 0.3640 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.2729 - accuracy300: 0.3791 - val_loss: 3.3271 - val_accuracy300: 0.3761 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.2763 - accuracy300: 0.3736 - val_loss: 3.3127 - val_accuracy300: 0.3703 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 3.2571 - accuracy300: 0.3894 - val_loss: 3.3337 - val_accuracy300: 0.3715 - 10s/epoch - 38ms/step
testing model: results/LILAK/W5/deepVOL_L3/h300
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973935
{'0': {'precision': 0.329301019202158, 'recall': 0.2661130837341004, 'f1-score': 0.2943541621352888, 'support': 88996}, '1': {'precision': 0.3593452607537115, 'recall': 0.01141337202273002, 'f1-score': 0.022124049357254184, 'support': 82710}, '2': {'precision': 0.3683870836594266, 'recall': 0.7276989178227959, 'f1-score': 0.48914935827361433, 'support': 99614}, 'accuracy': 0.35793896505970807, 'macro avg': {'precision': 0.352344454538432, 'recall': 0.33507512452654215, 'f1-score': 0.2685425232553858, 'support': 271320}, 'weighted avg': {'precision': 0.3528100802502758, 'recall': 0.35793896505970807, 'f1-score': 0.28288495986583545, 'support': 271320}}
[[23683   761 64552]
 [22033   944 59733]
 [26203   922 72489]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1020027
{'0': {'precision': 0.35597561600327854, 'recall': 0.2883402489626556, 'f1-score': 0.3186080099034868, 'support': 24100}, '1': {'precision': 0.321978021978022, 'recall': 0.012830618321947802, 'f1-score': 0.02467784047839636, 'support': 22836}, '2': {'precision': 0.33338072220642595, 'recall': 0.7220780363348436, 'f1-score': 0.4561559517027692, 'support': 22733}, 'accuracy': 0.3395627897630223, 'macro avg': {'precision': 0.3371114533959088, 'recall': 0.341082967873149, 'f1-score': 0.2664806006948841, 'support': 69669}, 'weighted avg': {'precision': 0.3374592202197219, 'recall': 0.3395627897630223, 'f1-score': 0.26714592507281204, 'support': 69669}}
[[ 6949   361 16790]
 [ 6510   293 16033]
 [ 6062   256 16415]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971832
{'0': {'precision': 0.3764327648867766, 'recall': 0.29019396551724136, 'f1-score': 0.3277351831568699, 'support': 9280}, '1': {'precision': 0.24324324324324326, 'recall': 0.013357079252003561, 'f1-score': 0.025323579065841303, 'support': 6738}, '2': {'precision': 0.3437592036284385, 'recall': 0.6879641636213604, 'f1-score': 0.45844461901021205, 'support': 8483}, 'accuracy': 0.35178155993632915, 'macro avg': {'precision': 0.32114507058615277, 'recall': 0.33050506946353514, 'f1-score': 0.2705011270776411, 'support': 24501}, 'weighted avg': {'precision': 0.3284918311702503, 'recall': 0.35178155993632915, 'f1-score': 0.2898248430066128, 'support': 24501}}
[[2693  144 6443]
 [1950   90 4698]
 [2511  136 5836]]
training model: results/LILAK/W5/deepVOL_L3/h500
Epoch 1/50
273/273 - 13s - loss: 3.3535 - accuracy500: 0.3482 - val_loss: 3.4099 - val_accuracy500: 0.3142 - 13s/epoch - 48ms/step
Epoch 2/50
273/273 - 10s - loss: 3.3126 - accuracy500: 0.3534 - val_loss: 3.3465 - val_accuracy500: 0.3180 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.3010 - accuracy500: 0.3511 - val_loss: 3.3380 - val_accuracy500: 0.3192 - 10s/epoch - 38ms/step
Epoch 4/50
273/273 - 10s - loss: 3.2991 - accuracy500: 0.3539 - val_loss: 3.3203 - val_accuracy500: 0.3296 - 10s/epoch - 38ms/step
Epoch 5/50
273/273 - 10s - loss: 3.2900 - accuracy500: 0.3605 - val_loss: 3.3131 - val_accuracy500: 0.3248 - 10s/epoch - 38ms/step
Epoch 6/50
273/273 - 10s - loss: 3.2839 - accuracy500: 0.3632 - val_loss: 3.3101 - val_accuracy500: 0.3341 - 10s/epoch - 38ms/step
Epoch 7/50
273/273 - 10s - loss: 3.2751 - accuracy500: 0.3707 - val_loss: 3.3090 - val_accuracy500: 0.3483 - 10s/epoch - 38ms/step
Epoch 8/50
273/273 - 10s - loss: 3.2704 - accuracy500: 0.3743 - val_loss: 3.3069 - val_accuracy500: 0.3499 - 10s/epoch - 38ms/step
Epoch 9/50
273/273 - 10s - loss: 3.2657 - accuracy500: 0.3779 - val_loss: 3.3082 - val_accuracy500: 0.3464 - 10s/epoch - 38ms/step
Epoch 10/50
273/273 - 10s - loss: 3.2625 - accuracy500: 0.3803 - val_loss: 3.3162 - val_accuracy500: 0.3474 - 10s/epoch - 38ms/step
Epoch 11/50
273/273 - 10s - loss: 3.2577 - accuracy500: 0.3847 - val_loss: 3.3235 - val_accuracy500: 0.3409 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.2551 - accuracy500: 0.3864 - val_loss: 3.3076 - val_accuracy500: 0.3554 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.2403 - accuracy500: 0.3959 - val_loss: 3.3243 - val_accuracy500: 0.3500 - 10s/epoch - 38ms/step
Epoch 14/50
273/273 - 10s - loss: 3.2371 - accuracy500: 0.3970 - val_loss: 3.3329 - val_accuracy500: 0.3476 - 10s/epoch - 38ms/step
Epoch 15/50
273/273 - 10s - loss: 3.2413 - accuracy500: 0.3965 - val_loss: 3.3427 - val_accuracy500: 0.3492 - 10s/epoch - 38ms/step
Epoch 16/50
273/273 - 10s - loss: 3.2291 - accuracy500: 0.4085 - val_loss: 3.3405 - val_accuracy500: 0.3513 - 10s/epoch - 38ms/step
Epoch 17/50
273/273 - 10s - loss: 3.2226 - accuracy500: 0.4113 - val_loss: 3.3566 - val_accuracy500: 0.3450 - 10s/epoch - 37ms/step
Epoch 18/50
273/273 - 10s - loss: 3.2135 - accuracy500: 0.4150 - val_loss: 3.3615 - val_accuracy500: 0.3510 - 10s/epoch - 37ms/step
testing model: results/LILAK/W5/deepVOL_L3/h500
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046877
{'0': {'precision': 0.3337082360420054, 'recall': 0.3200755132910428, 'f1-score': 0.32674973964879517, 'support': 85283}, '1': {'precision': 0.32996988086407064, 'recall': 0.41517666374288736, 'f1-score': 0.3677016159151458, 'support': 88926}, '2': {'precision': 0.3793281121187139, 'recall': 0.3032406215567752, 'f1-score': 0.33704354394739705, 'support': 97111}, 'accuracy': 0.34521966681409405, 'macro avg': {'precision': 0.3476687430082633, 'recall': 0.34616426619690177, 'f1-score': 0.343831633170446, 'support': 271320}, 'weighted avg': {'precision': 0.34881126867186024, 'recall': 0.34521966681409405, 'f1-score': 0.343856212367736, 'support': 271320}}
[[27297 34939 23047]
 [26869 36920 25137]
 [27633 40030 29448]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979406
{'0': {'precision': 0.3768226748948719, 'recall': 0.2903795976769632, 'f1-score': 0.3280013310198939, 'support': 23762}, '1': {'precision': 0.3643410852713178, 'recall': 0.42702227432590856, 'f1-score': 0.3931992983403049, 'support': 23884}, '2': {'precision': 0.3436764391183394, 'recall': 0.3646188076102257, 'f1-score': 0.3538380188596105, 'support': 22023}, 'accuracy': 0.36069126871348806, 'macro avg': {'precision': 0.3616133997615097, 'recall': 0.36067355987103245, 'f1-score': 0.35834621607326983, 'support': 69669}, 'weighted avg': {'precision': 0.3620658987523187, 'recall': 0.36069126871348806, 'f1-score': 0.35851977721224304, 'support': 69669}}
[[ 6900  9394  7468]
 [ 5818 10199  7867]
 [ 5593  8400  8030]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101943
{'0': {'precision': 0.40750816104461374, 'recall': 0.25, 'f1-score': 0.30988829127016965, 'support': 8988}, '1': {'precision': 0.3027394521095781, 'recall': 0.4105762711864407, 'f1-score': 0.34850664671692466, 'support': 7375}, '2': {'precision': 0.35325542570951585, 'recall': 0.39002211845662327, 'f1-score': 0.37072942825439464, 'support': 8138}, 'accuracy': 0.34484306762989264, 'macro avg': {'precision': 0.3545010129545692, 'recall': 0.35019946321435463, 'f1-score': 0.3430414554138297, 'support': 24501}, 'weighted avg': {'precision': 0.3579518985021496, 'recall': 0.34484306762989264, 'f1-score': 0.34172109581681837, 'support': 24501}}
[[2247 3661 3080]
 [1616 3028 2731]
 [1651 3313 3174]]
training model: results/LILAK/W5/deepVOL_L3/h1000
Epoch 1/50
273/273 - 12s - loss: 3.3545 - accuracy1000: 0.3498 - val_loss: 3.4426 - val_accuracy1000: 0.3227 - 12s/epoch - 45ms/step
Epoch 2/50
273/273 - 10s - loss: 3.3186 - accuracy1000: 0.3604 - val_loss: 3.3752 - val_accuracy1000: 0.3291 - 10s/epoch - 38ms/step
Epoch 3/50
273/273 - 10s - loss: 3.3112 - accuracy1000: 0.3530 - val_loss: 3.3802 - val_accuracy1000: 0.3147 - 10s/epoch - 38ms/step
Epoch 4/50
273/273 - 10s - loss: 3.3003 - accuracy1000: 0.3576 - val_loss: 3.3684 - val_accuracy1000: 0.3248 - 10s/epoch - 38ms/step
Epoch 5/50
273/273 - 10s - loss: 3.2929 - accuracy1000: 0.3630 - val_loss: 3.3432 - val_accuracy1000: 0.3313 - 10s/epoch - 37ms/step
Epoch 6/50
273/273 - 10s - loss: 3.2814 - accuracy1000: 0.3725 - val_loss: 3.4141 - val_accuracy1000: 0.3413 - 10s/epoch - 38ms/step
Epoch 7/50
273/273 - 10s - loss: 3.2702 - accuracy1000: 0.3805 - val_loss: 3.4425 - val_accuracy1000: 0.3428 - 10s/epoch - 37ms/step
Epoch 8/50
273/273 - 10s - loss: 3.2695 - accuracy1000: 0.3813 - val_loss: 3.4628 - val_accuracy1000: 0.3478 - 10s/epoch - 37ms/step
Epoch 9/50
273/273 - 10s - loss: 3.2522 - accuracy1000: 0.3912 - val_loss: 3.4841 - val_accuracy1000: 0.3511 - 10s/epoch - 37ms/step
Epoch 10/50
273/273 - 10s - loss: 3.2449 - accuracy1000: 0.3989 - val_loss: 3.4685 - val_accuracy1000: 0.3456 - 10s/epoch - 38ms/step
Epoch 11/50
273/273 - 10s - loss: 3.2480 - accuracy1000: 0.3920 - val_loss: 3.4360 - val_accuracy1000: 0.3469 - 10s/epoch - 38ms/step
Epoch 12/50
273/273 - 10s - loss: 3.2351 - accuracy1000: 0.4007 - val_loss: 3.4589 - val_accuracy1000: 0.3516 - 10s/epoch - 38ms/step
Epoch 13/50
273/273 - 10s - loss: 3.2289 - accuracy1000: 0.4072 - val_loss: 3.4700 - val_accuracy1000: 0.3461 - 10s/epoch - 37ms/step
Epoch 14/50
273/273 - 10s - loss: 3.2282 - accuracy1000: 0.4084 - val_loss: 3.4691 - val_accuracy1000: 0.3424 - 10s/epoch - 37ms/step
Epoch 15/50
273/273 - 10s - loss: 3.2166 - accuracy1000: 0.4120 - val_loss: 3.4386 - val_accuracy1000: 0.3426 - 10s/epoch - 37ms/step
testing model: results/LILAK/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
1060/1060 - 18s - 18s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1042502
{'0': {'precision': 0.2968266253869969, 'recall': 0.05757753950479813, 'f1-score': 0.09644664731586171, 'support': 79927}, '1': {'precision': 0.3503587795078495, 'recall': 0.2849714965858548, 'f1-score': 0.31430035524899097, 'support': 95778}, '2': {'precision': 0.3551679753587428, 'recall': 0.6608691104952152, 'f1-score': 0.4620294814424849, 'support': 95615}, 'accuracy': 0.35045333923042904, 'macro avg': {'precision': 0.33411779341786313, 'recall': 0.33447271552862273, 'f1-score': 0.2909254946691125, 'support': 271320}, 'weighted avg': {'precision': 0.33628376395007925, 'recall': 0.35045333923042904, 'f1-score': 0.30218450343939235, 'support': 271320}}
[[ 4602 23691 51634]
 [ 5394 27294 63090]
 [ 5508 26918 63189]]
Evaluating performance on  train set...
273/273 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1119285
{'0': {'precision': 0.38835794960903564, 'recall': 0.07375324836035144, 'f1-score': 0.12396436371199777, 'support': 24243}, '1': {'precision': 0.34681323114158935, 'recall': 0.30032311588507554, 'f1-score': 0.3218982543174054, 'support': 22902}, '2': {'precision': 0.3307098799549002, 'recall': 0.6641360326762564, 'f1-score': 0.44154847469634134, 'support': 22524}, 'accuracy': 0.33910347500322957, 'macro avg': {'precision': 0.3552936869018417, 'recall': 0.3460707989738945, 'f1-score': 0.29580369757524816, 'support': 69669}, 'weighted avg': {'precision': 0.35606349636252427, 'recall': 0.33910347500322957, 'f1-score': 0.2917053457622123, 'support': 69669}}
[[ 1788  6728 15727]
 [ 1477  6878 14547]
 [ 1339  6226 14959]]
Evaluating performance on  val set...
96/96 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1200418
{'0': {'precision': 0.3655786350148368, 'recall': 0.06984126984126984, 'f1-score': 0.11727748691099478, 'support': 8820}, '1': {'precision': 0.30416111357915, 'recall': 0.27058358582531944, 'f1-score': 0.2863915225878416, 'support': 7591}, '2': {'precision': 0.33742140322480235, 'recall': 0.6699629171817059, 'f1-score': 0.44880553140396634, 'support': 8090}, 'accuracy': 0.3301906044651239, 'macro avg': {'precision': 0.33572038393959636, 'recall': 0.3367959242827651, 'f1-score': 0.28415818030093426, 'support': 24501}, 'weighted avg': {'precision': 0.3372527540140745, 'recall': 0.3301906044651239, 'f1-score': 0.2791405343282873, 'support': 24501}}
[[ 616 2571 5633]
 [ 527 2054 5010]
 [ 542 2128 5420]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        11 (peak)   9.61 (ave)

============================================
