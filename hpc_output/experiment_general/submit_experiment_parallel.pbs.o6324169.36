This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-05-22.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-14.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-01.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-02.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-10.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-06.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-08.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-03.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-24.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-07.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-09.csv
data/AAL_orderbooks/AAL_orderbooks_2019-04-30.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-16.csv
data/AAL_orderbooks/AAL_orderbooks_2019-05-15.csv
training model: results/AAL/W3/deepLOB_L1/h10
Epoch 1/50
2159/2159 - 71s - loss: 2.8150 - accuracy10: 0.4430 - val_loss: 2.8241 - val_accuracy10: 0.6317 - 71s/epoch - 33ms/step
Epoch 2/50
2159/2159 - 49s - loss: 2.6333 - accuracy10: 0.4986 - val_loss: 2.7111 - val_accuracy10: 0.6316 - 49s/epoch - 23ms/step
Epoch 3/50
2159/2159 - 48s - loss: 2.4831 - accuracy10: 0.5602 - val_loss: 2.7152 - val_accuracy10: 0.6677 - 48s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 48s - loss: 2.4202 - accuracy10: 0.5808 - val_loss: 2.7414 - val_accuracy10: 0.6829 - 48s/epoch - 22ms/step
Epoch 5/50
2159/2159 - 48s - loss: 2.3812 - accuracy10: 0.5895 - val_loss: 2.7027 - val_accuracy10: 0.6807 - 48s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 47s - loss: 2.3573 - accuracy10: 0.5942 - val_loss: 2.6995 - val_accuracy10: 0.6896 - 47s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 47s - loss: 2.3379 - accuracy10: 0.5971 - val_loss: 2.6751 - val_accuracy10: 0.6897 - 47s/epoch - 22ms/step
Epoch 8/50
2159/2159 - 46s - loss: 2.3225 - accuracy10: 0.5992 - val_loss: 2.6642 - val_accuracy10: 0.6958 - 46s/epoch - 22ms/step
Epoch 9/50
2159/2159 - 47s - loss: 2.3088 - accuracy10: 0.6026 - val_loss: 2.7273 - val_accuracy10: 0.7040 - 47s/epoch - 22ms/step
Epoch 10/50
2159/2159 - 48s - loss: 2.2973 - accuracy10: 0.6041 - val_loss: 2.6914 - val_accuracy10: 0.7012 - 48s/epoch - 22ms/step
Epoch 11/50
2159/2159 - 46s - loss: 2.2867 - accuracy10: 0.6066 - val_loss: 2.6663 - val_accuracy10: 0.7025 - 46s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 47s - loss: 2.2785 - accuracy10: 0.6075 - val_loss: 2.6268 - val_accuracy10: 0.7048 - 47s/epoch - 22ms/step
Epoch 13/50
2159/2159 - 47s - loss: 2.2733 - accuracy10: 0.6088 - val_loss: 2.6319 - val_accuracy10: 0.7020 - 47s/epoch - 22ms/step
Epoch 14/50
2159/2159 - 46s - loss: 2.2665 - accuracy10: 0.6098 - val_loss: 2.6158 - val_accuracy10: 0.7005 - 46s/epoch - 21ms/step
Epoch 15/50
2159/2159 - 47s - loss: 2.2595 - accuracy10: 0.6110 - val_loss: 2.6331 - val_accuracy10: 0.7012 - 47s/epoch - 22ms/step
Epoch 16/50
2159/2159 - 47s - loss: 2.2535 - accuracy10: 0.6117 - val_loss: 2.6089 - val_accuracy10: 0.7002 - 47s/epoch - 22ms/step
Epoch 17/50
2159/2159 - 46s - loss: 2.2490 - accuracy10: 0.6121 - val_loss: 2.6611 - val_accuracy10: 0.7076 - 46s/epoch - 21ms/step
Epoch 18/50
2159/2159 - 46s - loss: 2.2431 - accuracy10: 0.6135 - val_loss: 2.6226 - val_accuracy10: 0.7046 - 46s/epoch - 22ms/step
Epoch 19/50
2159/2159 - 46s - loss: 2.2410 - accuracy10: 0.6140 - val_loss: 2.6157 - val_accuracy10: 0.7085 - 46s/epoch - 21ms/step
Epoch 20/50
2159/2159 - 46s - loss: 2.2387 - accuracy10: 0.6144 - val_loss: 2.6029 - val_accuracy10: 0.7075 - 46s/epoch - 21ms/step
Epoch 21/50
2159/2159 - 46s - loss: 2.2304 - accuracy10: 0.6161 - val_loss: 2.5887 - val_accuracy10: 0.7048 - 46s/epoch - 21ms/step
Epoch 22/50
2159/2159 - 46s - loss: 2.2267 - accuracy10: 0.6163 - val_loss: 2.6131 - val_accuracy10: 0.7083 - 46s/epoch - 21ms/step
Epoch 23/50
2159/2159 - 47s - loss: 2.2241 - accuracy10: 0.6173 - val_loss: 2.6303 - val_accuracy10: 0.7073 - 47s/epoch - 22ms/step
Epoch 24/50
2159/2159 - 46s - loss: 2.2187 - accuracy10: 0.6176 - val_loss: 2.5878 - val_accuracy10: 0.7064 - 46s/epoch - 21ms/step
Epoch 25/50
2159/2159 - 46s - loss: 2.2151 - accuracy10: 0.6182 - val_loss: 2.5677 - val_accuracy10: 0.7040 - 46s/epoch - 21ms/step
Epoch 26/50
2159/2159 - 47s - loss: 2.2108 - accuracy10: 0.6195 - val_loss: 2.6007 - val_accuracy10: 0.6982 - 47s/epoch - 22ms/step
Epoch 27/50
2159/2159 - 46s - loss: 2.2090 - accuracy10: 0.6194 - val_loss: 2.6171 - val_accuracy10: 0.7057 - 46s/epoch - 21ms/step
Epoch 28/50
2159/2159 - 46s - loss: 2.2059 - accuracy10: 0.6190 - val_loss: 2.5908 - val_accuracy10: 0.6966 - 46s/epoch - 21ms/step
Epoch 29/50
2159/2159 - 46s - loss: 2.2011 - accuracy10: 0.6208 - val_loss: 2.6299 - val_accuracy10: 0.7006 - 46s/epoch - 21ms/step
Epoch 30/50
2159/2159 - 45s - loss: 2.2056 - accuracy10: 0.6201 - val_loss: 2.5987 - val_accuracy10: 0.6981 - 45s/epoch - 21ms/step
Epoch 31/50
2159/2159 - 46s - loss: 2.1974 - accuracy10: 0.6210 - val_loss: 2.6037 - val_accuracy10: 0.6996 - 46s/epoch - 21ms/step
Epoch 32/50
2159/2159 - 47s - loss: 2.1926 - accuracy10: 0.6211 - val_loss: 2.5623 - val_accuracy10: 0.6981 - 47s/epoch - 22ms/step
Epoch 33/50
2159/2159 - 46s - loss: 2.1890 - accuracy10: 0.6218 - val_loss: 2.5723 - val_accuracy10: 0.6988 - 46s/epoch - 21ms/step
Epoch 34/50
2159/2159 - 46s - loss: 2.1852 - accuracy10: 0.6221 - val_loss: 2.5918 - val_accuracy10: 0.6984 - 46s/epoch - 21ms/step
Epoch 35/50
2159/2159 - 46s - loss: 2.1840 - accuracy10: 0.6220 - val_loss: 2.5883 - val_accuracy10: 0.6966 - 46s/epoch - 21ms/step
Epoch 36/50
2159/2159 - 46s - loss: 2.1806 - accuracy10: 0.6228 - val_loss: 2.6206 - val_accuracy10: 0.7004 - 46s/epoch - 21ms/step
Epoch 37/50
2159/2159 - 46s - loss: 2.1774 - accuracy10: 0.6234 - val_loss: 2.5853 - val_accuracy10: 0.6926 - 46s/epoch - 21ms/step
Epoch 38/50
2159/2159 - 45s - loss: 2.1755 - accuracy10: 0.6231 - val_loss: 2.6099 - val_accuracy10: 0.6912 - 45s/epoch - 21ms/step
Epoch 39/50
2159/2159 - 46s - loss: 2.1726 - accuracy10: 0.6239 - val_loss: 2.5883 - val_accuracy10: 0.6897 - 46s/epoch - 21ms/step
Epoch 40/50
2159/2159 - 46s - loss: 2.1685 - accuracy10: 0.6242 - val_loss: 2.5971 - val_accuracy10: 0.6931 - 46s/epoch - 21ms/step
Epoch 41/50
2159/2159 - 45s - loss: 2.1671 - accuracy10: 0.6244 - val_loss: 2.6019 - val_accuracy10: 0.6965 - 45s/epoch - 21ms/step
Epoch 42/50
2159/2159 - 45s - loss: 2.1637 - accuracy10: 0.6244 - val_loss: 2.5944 - val_accuracy10: 0.6923 - 45s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h10
Evaluating performance on  test set...
5760/5760 - 62s - 62s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5537127
{'0': {'precision': 0.4294371091035441, 'recall': 0.30361412634047596, 'f1-score': 0.3557273118015474, 'support': 152651}, '1': {'precision': 0.8387895157468678, 'recall': 0.9191020786580878, 'f1-score': 0.8771111824338829, 'support': 1167051}, '2': {'precision': 0.43342601878019876, 'recall': 0.24574688729655164, 'f1-score': 0.3136553123234689, 'support': 154769}, 'accuracy': 0.7847017676169962, 'macro avg': {'precision': 0.5672175478768703, 'recall': 0.4894876974317051, 'f1-score': 0.5154979355196331, 'support': 1474471}, 'weighted avg': {'precision': 0.7538602378644648, 'recall': 0.7847017676169962, 'f1-score': 0.7639890723367596, 'support': 1474471}}
[[  46347   98868    7436]
 [  52130 1072639   42282]
 [   9448  107287   38034]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.70545566
{'0': {'precision': 0.4026374635626722, 'recall': 0.4951629140373708, 'f1-score': 0.44413244799753343, 'support': 81454}, '1': {'precision': 0.8048760944235813, 'recall': 0.7752112676056339, 'f1-score': 0.7897652147818897, 'support': 388725}, '2': {'precision': 0.4360835716759225, 'recall': 0.4128338999514327, 'f1-score': 0.42414036138190847, 'support': 82360}, 'accuracy': 0.6799121871940261, 'macro avg': {'precision': 0.5478657098873919, 'recall': 0.561069360531479, 'f1-score': 0.5526793413871105, 'support': 552539}, 'weighted avg': {'precision': 0.6906077846542408, 'recall': 0.6799121871940261, 'f1-score': 0.6843137727810981, 'support': 552539}}
[[ 40333  33622   7499]
 [ 50912 301344  36469]
 [  8927  39432  34001]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.66454774
{'0': {'precision': 0.4177860628323921, 'recall': 0.5100060236931933, 'f1-score': 0.45931283905967457, 'support': 29882}, '1': {'precision': 0.8412115297480046, 'recall': 0.7653464404629776, 'f1-score': 0.8014877295520207, 'support': 157675}, '2': {'precision': 0.4204800598738373, 'recall': 0.528098563179804, 'f1-score': 0.46818452380952386, 'support': 29788}, 'accuracy': 0.6977248153856771, 'macro avg': {'precision': 0.5598258841514113, 'recall': 0.601150342445325, 'f1-score': 0.5763283641404063, 'support': 217345}, 'weighted avg': {'precision': 0.7253333230858591, 'recall': 0.6977248153856771, 'f1-score': 0.7087627716723833, 'support': 217345}}
[[ 15240  11561   3081]
 [ 18399 120676  18600]
 [  2839  11218  15731]]
training model: results/AAL/W3/deepLOB_L1/h20
Epoch 1/50
2159/2159 - 50s - loss: 2.8962 - accuracy20: 0.4639 - val_loss: 3.5071 - val_accuracy20: 0.6093 - 50s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 48s - loss: 2.8394 - accuracy20: 0.4635 - val_loss: 2.8618 - val_accuracy20: 0.6073 - 48s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 46s - loss: 2.6905 - accuracy20: 0.5270 - val_loss: 2.8383 - val_accuracy20: 0.6335 - 46s/epoch - 21ms/step
Epoch 4/50
2159/2159 - 45s - loss: 2.5961 - accuracy20: 0.5579 - val_loss: 2.8276 - val_accuracy20: 0.6473 - 45s/epoch - 21ms/step
Epoch 5/50
2159/2159 - 45s - loss: 2.5501 - accuracy20: 0.5713 - val_loss: 2.7827 - val_accuracy20: 0.6533 - 45s/epoch - 21ms/step
Epoch 6/50
2159/2159 - 46s - loss: 2.5203 - accuracy20: 0.5778 - val_loss: 2.7778 - val_accuracy20: 0.6517 - 46s/epoch - 21ms/step
Epoch 7/50
2159/2159 - 46s - loss: 2.4996 - accuracy20: 0.5823 - val_loss: 2.7756 - val_accuracy20: 0.6524 - 46s/epoch - 21ms/step
Epoch 8/50
2159/2159 - 46s - loss: 2.4801 - accuracy20: 0.5873 - val_loss: 2.7840 - val_accuracy20: 0.6562 - 46s/epoch - 22ms/step
Epoch 9/50
2159/2159 - 46s - loss: 2.4666 - accuracy20: 0.5896 - val_loss: 2.7624 - val_accuracy20: 0.6576 - 46s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 46s - loss: 2.4534 - accuracy20: 0.5931 - val_loss: 2.7030 - val_accuracy20: 0.6592 - 46s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 46s - loss: 2.4423 - accuracy20: 0.5949 - val_loss: 2.7314 - val_accuracy20: 0.6620 - 46s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 47s - loss: 2.4336 - accuracy20: 0.5967 - val_loss: 2.7485 - val_accuracy20: 0.6634 - 47s/epoch - 22ms/step
Epoch 13/50
2159/2159 - 45s - loss: 2.4271 - accuracy20: 0.5978 - val_loss: 2.7756 - val_accuracy20: 0.6597 - 45s/epoch - 21ms/step
Epoch 14/50
2159/2159 - 46s - loss: 2.4206 - accuracy20: 0.5992 - val_loss: 2.7134 - val_accuracy20: 0.6615 - 46s/epoch - 21ms/step
Epoch 15/50
2159/2159 - 47s - loss: 2.4160 - accuracy20: 0.6002 - val_loss: 2.7366 - val_accuracy20: 0.6592 - 47s/epoch - 22ms/step
Epoch 16/50
2159/2159 - 46s - loss: 2.4097 - accuracy20: 0.6014 - val_loss: 2.7067 - val_accuracy20: 0.6598 - 46s/epoch - 21ms/step
Epoch 17/50
2159/2159 - 47s - loss: 2.4054 - accuracy20: 0.6027 - val_loss: 2.6819 - val_accuracy20: 0.6599 - 47s/epoch - 22ms/step
Epoch 18/50
2159/2159 - 46s - loss: 2.3996 - accuracy20: 0.6032 - val_loss: 2.6901 - val_accuracy20: 0.6592 - 46s/epoch - 21ms/step
Epoch 19/50
2159/2159 - 45s - loss: 2.3970 - accuracy20: 0.6035 - val_loss: 2.6990 - val_accuracy20: 0.6623 - 45s/epoch - 21ms/step
Epoch 20/50
2159/2159 - 45s - loss: 2.3923 - accuracy20: 0.6048 - val_loss: 2.6523 - val_accuracy20: 0.6599 - 45s/epoch - 21ms/step
Epoch 21/50
2159/2159 - 45s - loss: 2.3887 - accuracy20: 0.6058 - val_loss: 2.6860 - val_accuracy20: 0.6607 - 45s/epoch - 21ms/step
Epoch 22/50
2159/2159 - 47s - loss: 2.3853 - accuracy20: 0.6064 - val_loss: 2.6391 - val_accuracy20: 0.6589 - 47s/epoch - 22ms/step
Epoch 23/50
2159/2159 - 47s - loss: 2.3824 - accuracy20: 0.6072 - val_loss: 2.6494 - val_accuracy20: 0.6567 - 47s/epoch - 22ms/step
Epoch 24/50
2159/2159 - 46s - loss: 2.3800 - accuracy20: 0.6071 - val_loss: 2.6492 - val_accuracy20: 0.6626 - 46s/epoch - 21ms/step
Epoch 25/50
2159/2159 - 47s - loss: 2.3757 - accuracy20: 0.6081 - val_loss: 2.6397 - val_accuracy20: 0.6530 - 47s/epoch - 22ms/step
Epoch 26/50
2159/2159 - 46s - loss: 2.3719 - accuracy20: 0.6084 - val_loss: 2.6600 - val_accuracy20: 0.6516 - 46s/epoch - 21ms/step
Epoch 27/50
2159/2159 - 47s - loss: 2.3683 - accuracy20: 0.6091 - val_loss: 2.6360 - val_accuracy20: 0.6428 - 47s/epoch - 22ms/step
Epoch 28/50
2159/2159 - 46s - loss: 2.3663 - accuracy20: 0.6094 - val_loss: 2.6698 - val_accuracy20: 0.6524 - 46s/epoch - 21ms/step
Epoch 29/50
2159/2159 - 47s - loss: 2.3627 - accuracy20: 0.6098 - val_loss: 2.6569 - val_accuracy20: 0.6501 - 47s/epoch - 22ms/step
Epoch 30/50
2159/2159 - 46s - loss: 2.3606 - accuracy20: 0.6106 - val_loss: 2.6088 - val_accuracy20: 0.6435 - 46s/epoch - 22ms/step
Epoch 31/50
2159/2159 - 46s - loss: 2.3591 - accuracy20: 0.6106 - val_loss: 2.6332 - val_accuracy20: 0.6322 - 46s/epoch - 21ms/step
Epoch 32/50
2159/2159 - 47s - loss: 2.3559 - accuracy20: 0.6112 - val_loss: 2.6456 - val_accuracy20: 0.6432 - 47s/epoch - 22ms/step
Epoch 33/50
2159/2159 - 47s - loss: 2.3520 - accuracy20: 0.6114 - val_loss: 2.6119 - val_accuracy20: 0.6364 - 47s/epoch - 22ms/step
Epoch 34/50
2159/2159 - 46s - loss: 2.3498 - accuracy20: 0.6125 - val_loss: 2.6576 - val_accuracy20: 0.6448 - 46s/epoch - 21ms/step
Epoch 35/50
2159/2159 - 46s - loss: 2.3480 - accuracy20: 0.6122 - val_loss: 2.6423 - val_accuracy20: 0.6358 - 46s/epoch - 21ms/step
Epoch 36/50
2159/2159 - 47s - loss: 2.3457 - accuracy20: 0.6127 - val_loss: 2.6396 - val_accuracy20: 0.6380 - 47s/epoch - 22ms/step
Epoch 37/50
2159/2159 - 47s - loss: 2.3421 - accuracy20: 0.6133 - val_loss: 2.6678 - val_accuracy20: 0.6356 - 47s/epoch - 22ms/step
Epoch 38/50
2159/2159 - 47s - loss: 2.3418 - accuracy20: 0.6134 - val_loss: 2.6686 - val_accuracy20: 0.6161 - 47s/epoch - 22ms/step
Epoch 39/50
2159/2159 - 45s - loss: 2.3379 - accuracy20: 0.6131 - val_loss: 2.6433 - val_accuracy20: 0.6127 - 45s/epoch - 21ms/step
Epoch 40/50
2159/2159 - 45s - loss: 2.3370 - accuracy20: 0.6141 - val_loss: 2.6681 - val_accuracy20: 0.6211 - 45s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h20
Evaluating performance on  test set...
5760/5760 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6819268
{'0': {'precision': 0.47469076430983964, 'recall': 0.3034228360641675, 'f1-score': 0.3702082006820818, 'support': 209826}, '1': {'precision': 0.7586439232145782, 'recall': 0.9294426695065673, 'f1-score': 0.8354026816371626, 'support': 1056375}, '2': {'precision': 0.5126771551163698, 'recall': 0.11359293225140443, 'f1-score': 0.18597886925350607, 'support': 208270}, 'accuracy': 0.7251170080659437, 'macro avg': {'precision': 0.5820039475469292, 'recall': 0.44881947927404636, 'f1-score': 0.46386325052425015, 'support': 1474471}, 'weighted avg': {'precision': 0.6834927304734802, 'recall': 0.7251170080659437, 'f1-score': 0.6774711966733857, 'support': 1474471}}
[[ 63666 139224   6936]
 [ 58983 981840  15552]
 [ 11472 173140  23658]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81672025
{'0': {'precision': 0.4581871139809096, 'recall': 0.4798772419876507, 'f1-score': 0.4687814160562976, 'support': 108832}, '1': {'precision': 0.7221375472282079, 'recall': 0.7410907717985059, 'f1-score': 0.7314914087720881, 'support': 333727}, '2': {'precision': 0.44825073644984337, 'recall': 0.391553009638116, 'f1-score': 0.4179879543215449, 'support': 109980}, 'accuracy': 0.6200666378300899, 'macro avg': {'precision': 0.5428584658863203, 'recall': 0.5375070078080909, 'f1-score': 0.5394202597166435, 'support': 552539}, 'weighted avg': {'precision': 0.6156322598175916, 'recall': 0.6200666378300899, 'f1-score': 0.6173449614666207, 'support': 552539}}
[[ 52226  41681  14925]
 [ 48324 247322  38081]
 [ 13434  53483  43063]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7723937
{'0': {'precision': 0.46117893933613124, 'recall': 0.48524688879967887, 'f1-score': 0.4729068857589985, 'support': 39856}, '1': {'precision': 0.7669801862750351, 'recall': 0.7281769962944126, 'f1-score': 0.7470750697920588, 'support': 137630}, '2': {'precision': 0.4508738992445577, 'recall': 0.5061090343460699, 'f1-score': 0.4768974362005177, 'support': 39859}, 'accuracy': 0.6429041385815178, 'macro avg': {'precision': 0.559677674951908, 'recall': 0.5731776398133871, 'f1-score': 0.5656264639171917, 'support': 217345}, 'weighted avg': {'precision': 0.6529324971506257, 'recall': 0.6429041385815178, 'f1-score': 0.6472510230454261, 'support': 217345}}
[[ 19340  14806   5710]
 [ 18552 100219  18859]
 [  4044  15642  20173]]
training model: results/AAL/W3/deepLOB_L1/h30
Epoch 1/50
2159/2159 - 49s - loss: 2.9671 - accuracy30: 0.4638 - val_loss: 3.1399 - val_accuracy30: 0.5329 - 49s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 47s - loss: 2.8694 - accuracy30: 0.4898 - val_loss: 3.0318 - val_accuracy30: 0.5787 - 47s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 47s - loss: 2.7513 - accuracy30: 0.5363 - val_loss: 3.0034 - val_accuracy30: 0.5935 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 47s - loss: 2.6880 - accuracy30: 0.5547 - val_loss: 2.9947 - val_accuracy30: 0.5931 - 47s/epoch - 22ms/step
Epoch 5/50
2159/2159 - 47s - loss: 2.6553 - accuracy30: 0.5627 - val_loss: 3.0017 - val_accuracy30: 0.6011 - 47s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 47s - loss: 2.6296 - accuracy30: 0.5678 - val_loss: 2.9945 - val_accuracy30: 0.6031 - 47s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 46s - loss: 2.6086 - accuracy30: 0.5711 - val_loss: 2.9702 - val_accuracy30: 0.6074 - 46s/epoch - 21ms/step
Epoch 8/50
2159/2159 - 46s - loss: 2.5919 - accuracy30: 0.5748 - val_loss: 2.9662 - val_accuracy30: 0.6086 - 46s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 46s - loss: 2.5800 - accuracy30: 0.5771 - val_loss: 2.9965 - val_accuracy30: 0.6051 - 46s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 45s - loss: 2.5696 - accuracy30: 0.5792 - val_loss: 2.9903 - val_accuracy30: 0.6065 - 45s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 45s - loss: 2.5602 - accuracy30: 0.5811 - val_loss: 2.9930 - val_accuracy30: 0.6094 - 45s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 45s - loss: 2.5539 - accuracy30: 0.5826 - val_loss: 2.9598 - val_accuracy30: 0.6105 - 45s/epoch - 21ms/step
Epoch 13/50
2159/2159 - 45s - loss: 2.5467 - accuracy30: 0.5842 - val_loss: 2.9846 - val_accuracy30: 0.6090 - 45s/epoch - 21ms/step
Epoch 14/50
2159/2159 - 47s - loss: 2.5403 - accuracy30: 0.5856 - val_loss: 2.9977 - val_accuracy30: 0.6088 - 47s/epoch - 22ms/step
Epoch 15/50
2159/2159 - 46s - loss: 2.5355 - accuracy30: 0.5861 - val_loss: 2.9975 - val_accuracy30: 0.6097 - 46s/epoch - 21ms/step
Epoch 16/50
2159/2159 - 45s - loss: 2.5304 - accuracy30: 0.5878 - val_loss: 2.9513 - val_accuracy30: 0.6118 - 45s/epoch - 21ms/step
Epoch 17/50
2159/2159 - 45s - loss: 2.5259 - accuracy30: 0.5885 - val_loss: 2.9529 - val_accuracy30: 0.6127 - 45s/epoch - 21ms/step
Epoch 18/50
2159/2159 - 45s - loss: 2.5212 - accuracy30: 0.5898 - val_loss: 2.9387 - val_accuracy30: 0.6123 - 45s/epoch - 21ms/step
Epoch 19/50
2159/2159 - 45s - loss: 2.5184 - accuracy30: 0.5903 - val_loss: 2.9068 - val_accuracy30: 0.6159 - 45s/epoch - 21ms/step
Epoch 20/50
2159/2159 - 45s - loss: 2.5138 - accuracy30: 0.5912 - val_loss: 2.9471 - val_accuracy30: 0.6123 - 45s/epoch - 21ms/step
Epoch 21/50
2159/2159 - 45s - loss: 2.5105 - accuracy30: 0.5916 - val_loss: 2.9164 - val_accuracy30: 0.6128 - 45s/epoch - 21ms/step
Epoch 22/50
2159/2159 - 45s - loss: 2.5070 - accuracy30: 0.5922 - val_loss: 2.9321 - val_accuracy30: 0.6139 - 45s/epoch - 21ms/step
Epoch 23/50
2159/2159 - 45s - loss: 2.5049 - accuracy30: 0.5924 - val_loss: 2.9244 - val_accuracy30: 0.6138 - 45s/epoch - 21ms/step
Epoch 24/50
2159/2159 - 46s - loss: 2.5020 - accuracy30: 0.5929 - val_loss: 2.9057 - val_accuracy30: 0.6146 - 46s/epoch - 21ms/step
Epoch 25/50
2159/2159 - 47s - loss: 2.4996 - accuracy30: 0.5931 - val_loss: 2.8759 - val_accuracy30: 0.6156 - 47s/epoch - 22ms/step
Epoch 26/50
2159/2159 - 46s - loss: 2.4958 - accuracy30: 0.5937 - val_loss: 2.8808 - val_accuracy30: 0.6156 - 46s/epoch - 21ms/step
Epoch 27/50
2159/2159 - 46s - loss: 2.4929 - accuracy30: 0.5949 - val_loss: 2.8941 - val_accuracy30: 0.6147 - 46s/epoch - 21ms/step
Epoch 28/50
2159/2159 - 46s - loss: 2.4899 - accuracy30: 0.5949 - val_loss: 2.8933 - val_accuracy30: 0.6175 - 46s/epoch - 21ms/step
Epoch 29/50
2159/2159 - 45s - loss: 2.4873 - accuracy30: 0.5952 - val_loss: 2.8667 - val_accuracy30: 0.6174 - 45s/epoch - 21ms/step
Epoch 30/50
2159/2159 - 46s - loss: 2.4849 - accuracy30: 0.5962 - val_loss: 2.8873 - val_accuracy30: 0.6173 - 46s/epoch - 21ms/step
Epoch 31/50
2159/2159 - 46s - loss: 2.4829 - accuracy30: 0.5965 - val_loss: 2.8791 - val_accuracy30: 0.6166 - 46s/epoch - 21ms/step
Epoch 32/50
2159/2159 - 47s - loss: 2.4802 - accuracy30: 0.5969 - val_loss: 2.8601 - val_accuracy30: 0.6150 - 47s/epoch - 22ms/step
Epoch 33/50
2159/2159 - 46s - loss: 2.4776 - accuracy30: 0.5978 - val_loss: 2.8632 - val_accuracy30: 0.6171 - 46s/epoch - 21ms/step
Epoch 34/50
2159/2159 - 45s - loss: 2.4748 - accuracy30: 0.5978 - val_loss: 2.8675 - val_accuracy30: 0.6151 - 45s/epoch - 21ms/step
Epoch 35/50
2159/2159 - 47s - loss: 2.4727 - accuracy30: 0.5982 - val_loss: 2.8648 - val_accuracy30: 0.6154 - 47s/epoch - 22ms/step
Epoch 36/50
2159/2159 - 46s - loss: 2.4706 - accuracy30: 0.5983 - val_loss: 2.9012 - val_accuracy30: 0.6163 - 46s/epoch - 21ms/step
Epoch 37/50
2159/2159 - 46s - loss: 2.4689 - accuracy30: 0.5993 - val_loss: 2.8750 - val_accuracy30: 0.6137 - 46s/epoch - 22ms/step
Epoch 38/50
2159/2159 - 46s - loss: 2.4658 - accuracy30: 0.5996 - val_loss: 2.8513 - val_accuracy30: 0.6138 - 46s/epoch - 21ms/step
Epoch 39/50
2159/2159 - 45s - loss: 2.4627 - accuracy30: 0.5993 - val_loss: 2.9090 - val_accuracy30: 0.6121 - 45s/epoch - 21ms/step
Epoch 40/50
2159/2159 - 46s - loss: 2.4604 - accuracy30: 0.6006 - val_loss: 2.8863 - val_accuracy30: 0.6151 - 46s/epoch - 21ms/step
Epoch 41/50
2159/2159 - 46s - loss: 2.4600 - accuracy30: 0.5999 - val_loss: 2.8987 - val_accuracy30: 0.6151 - 46s/epoch - 21ms/step
Epoch 42/50
2159/2159 - 46s - loss: 2.4569 - accuracy30: 0.6012 - val_loss: 2.9060 - val_accuracy30: 0.6153 - 46s/epoch - 21ms/step
Epoch 43/50
2159/2159 - 45s - loss: 2.4551 - accuracy30: 0.6013 - val_loss: 2.9046 - val_accuracy30: 0.6121 - 45s/epoch - 21ms/step
Epoch 44/50
2159/2159 - 46s - loss: 2.4526 - accuracy30: 0.6016 - val_loss: 2.8961 - val_accuracy30: 0.6115 - 46s/epoch - 21ms/step
Epoch 45/50
2159/2159 - 46s - loss: 2.4500 - accuracy30: 0.6024 - val_loss: 2.8945 - val_accuracy30: 0.6067 - 46s/epoch - 21ms/step
Epoch 46/50
2159/2159 - 46s - loss: 2.4479 - accuracy30: 0.6023 - val_loss: 2.8828 - val_accuracy30: 0.6104 - 46s/epoch - 21ms/step
Epoch 47/50
2159/2159 - 46s - loss: 2.4460 - accuracy30: 0.6030 - val_loss: 2.8696 - val_accuracy30: 0.6090 - 46s/epoch - 21ms/step
Epoch 48/50
2159/2159 - 46s - loss: 2.4430 - accuracy30: 0.6033 - val_loss: 2.9240 - val_accuracy30: 0.6030 - 46s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h30
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7504491
{'0': {'precision': 0.5424238648701565, 'recall': 0.2405107746459421, 'f1-score': 0.33325587435242016, 'support': 253419}, '1': {'precision': 0.7049329409321676, 'recall': 0.912150768109407, 'f1-score': 0.7952651058713603, 'support': 971346}, '2': {'precision': 0.4862299007868628, 'recall': 0.20490096353311493, 'f1-score': 0.2883071218874495, 'support': 249706}, 'accuracy': 0.6769404077801462, 'macro avg': {'precision': 0.577862235529729, 'recall': 0.452520835429488, 'f1-score': 0.4722760340370767, 'support': 1474471}, 'weighted avg': {'precision': 0.6399643190405996, 'recall': 0.6769404077801462, 'f1-score': 0.6300042307568382, 'support': 1474471}}
[[ 60950 183884   8585]
 [ 39854 886014  45478]
 [ 11562 186979  51165]]
Evaluating performance on  train set...
2159/2159 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88917434
{'0': {'precision': 0.4999734930816943, 'recall': 0.36703924529476784, 'f1-score': 0.4233153342400209, 'support': 128474}, '1': {'precision': 0.6184107599291532, 'recall': 0.8031647225516213, 'f1-score': 0.6987820380169687, 'support': 294307}, '2': {'precision': 0.5176797252306194, 'recall': 0.30317205875552955, 'f1-score': 0.3823979703425047, 'support': 129758}, 'accuracy': 0.5843406528769914, 'macro avg': {'precision': 0.5453546594138223, 'recall': 0.4911253422006396, 'f1-score': 0.5014984475331647, 'support': 552539}, 'weighted avg': {'precision': 0.5672166052697124, 'recall': 0.5843406528769914, 'f1-score': 0.5604322144672415, 'support': 552539}}
[[ 47155  69706  11613]
 [ 32891 236377  25039]
 [ 14269  76150  39339]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8401014
{'0': {'precision': 0.500143876611418, 'recall': 0.36781292984869324, 'f1-score': 0.4238906434816539, 'support': 47255}, '1': {'precision': 0.6648586188145731, 'recall': 0.7957274413458723, 'f1-score': 0.724430092873754, 'support': 122924}, '2': {'precision': 0.5145885603134779, 'recall': 0.3870160708985286, 'f1-score': 0.44177688500586887, 'support': 47166}, 'accuracy': 0.6139961811865927, 'macro avg': {'precision': 0.5598636852464897, 'recall': 0.5168521473643647, 'f1-score': 0.5300325404537589, 'support': 217345}, 'weighted avg': {'precision': 0.5964363743549685, 'recall': 0.6139961811865927, 'f1-score': 0.5977484904291597, 'support': 217345}}
[[17381 25175  4699]
 [12590 97814 12520]
 [ 4781 24131 18254]]
training model: results/AAL/W3/deepLOB_L1/h50
Epoch 1/50
2159/2159 - 49s - loss: 3.0848 - accuracy50: 0.4557 - val_loss: 3.2509 - val_accuracy50: 0.4690 - 49s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 46s - loss: 3.0421 - accuracy50: 0.4616 - val_loss: 3.1972 - val_accuracy50: 0.4913 - 46s/epoch - 21ms/step
Epoch 3/50
2159/2159 - 46s - loss: 2.9749 - accuracy50: 0.4931 - val_loss: 3.2319 - val_accuracy50: 0.5098 - 46s/epoch - 21ms/step
Epoch 4/50
2159/2159 - 46s - loss: 2.9098 - accuracy50: 0.5139 - val_loss: 3.1636 - val_accuracy50: 0.5223 - 46s/epoch - 21ms/step
Epoch 5/50
2159/2159 - 46s - loss: 2.8505 - accuracy50: 0.5295 - val_loss: 3.1245 - val_accuracy50: 0.5287 - 46s/epoch - 21ms/step
Epoch 6/50
2159/2159 - 45s - loss: 2.8184 - accuracy50: 0.5367 - val_loss: 3.1243 - val_accuracy50: 0.5323 - 45s/epoch - 21ms/step
Epoch 7/50
2159/2159 - 46s - loss: 2.7970 - accuracy50: 0.5410 - val_loss: 3.1079 - val_accuracy50: 0.5334 - 46s/epoch - 21ms/step
Epoch 8/50
2159/2159 - 47s - loss: 2.7824 - accuracy50: 0.5442 - val_loss: 3.1383 - val_accuracy50: 0.5351 - 47s/epoch - 22ms/step
Epoch 9/50
2159/2159 - 46s - loss: 2.7702 - accuracy50: 0.5458 - val_loss: 3.1423 - val_accuracy50: 0.5352 - 46s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 45s - loss: 2.7603 - accuracy50: 0.5481 - val_loss: 3.1346 - val_accuracy50: 0.5351 - 45s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 46s - loss: 2.7523 - accuracy50: 0.5495 - val_loss: 3.1033 - val_accuracy50: 0.5366 - 46s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 45s - loss: 2.7458 - accuracy50: 0.5512 - val_loss: 3.0832 - val_accuracy50: 0.5394 - 45s/epoch - 21ms/step
Epoch 13/50
2159/2159 - 45s - loss: 2.7390 - accuracy50: 0.5527 - val_loss: 3.1088 - val_accuracy50: 0.5380 - 45s/epoch - 21ms/step
Epoch 14/50
2159/2159 - 46s - loss: 2.7343 - accuracy50: 0.5534 - val_loss: 3.1197 - val_accuracy50: 0.5360 - 46s/epoch - 21ms/step
Epoch 15/50
2159/2159 - 47s - loss: 2.7292 - accuracy50: 0.5545 - val_loss: 3.1114 - val_accuracy50: 0.5348 - 47s/epoch - 22ms/step
Epoch 16/50
2159/2159 - 45s - loss: 2.7254 - accuracy50: 0.5554 - val_loss: 3.1147 - val_accuracy50: 0.5351 - 45s/epoch - 21ms/step
Epoch 17/50
2159/2159 - 46s - loss: 2.7213 - accuracy50: 0.5562 - val_loss: 3.1326 - val_accuracy50: 0.5326 - 46s/epoch - 21ms/step
Epoch 18/50
2159/2159 - 45s - loss: 2.7168 - accuracy50: 0.5567 - val_loss: 3.1169 - val_accuracy50: 0.5348 - 45s/epoch - 21ms/step
Epoch 19/50
2159/2159 - 46s - loss: 2.7138 - accuracy50: 0.5580 - val_loss: 3.1360 - val_accuracy50: 0.5362 - 46s/epoch - 21ms/step
Epoch 20/50
2159/2159 - 48s - loss: 2.7111 - accuracy50: 0.5579 - val_loss: 3.1027 - val_accuracy50: 0.5391 - 48s/epoch - 22ms/step
Epoch 21/50
2159/2159 - 47s - loss: 2.7072 - accuracy50: 0.5594 - val_loss: 3.1436 - val_accuracy50: 0.5340 - 47s/epoch - 22ms/step
Epoch 22/50
2159/2159 - 46s - loss: 2.7052 - accuracy50: 0.5592 - val_loss: 3.1077 - val_accuracy50: 0.5373 - 46s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h50
Evaluating performance on  test set...
5760/5760 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86516565
{'0': {'precision': 0.5517497323079918, 'recall': 0.14031010870204252, 'f1-score': 0.2237265055099035, 'support': 323177}, '1': {'precision': 0.5970179887313872, 'recall': 0.9721865173250277, 'f1-score': 0.7397542347157819, 'support': 834775}, '2': {'precision': 0.6573658003400534, 'recall': 0.06840347656854723, 'f1-score': 0.12391295016525733, 'support': 316519}, 'accuracy': 0.5958428480451633, 'macro avg': {'precision': 0.6020445071264775, 'recall': 0.39363336753187256, 'f1-score': 0.3624645634636476, 'support': 1474471}, 'weighted avg': {'precision': 0.6000506490389956, 'recall': 0.5958428480451633, 'f1-score': 0.4944501487173353, 'support': 1474471}}
[[ 45345 273056   4776]
 [ 16709 811557   6509]
 [ 20130 274738  21651]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0167233
{'0': {'precision': 0.4985893937158873, 'recall': 0.3456476859456592, 'f1-score': 0.40826510544652933, 'support': 156457}, '1': {'precision': 0.49479720550147815, 'recall': 0.8154465408805032, 'f1-score': 0.6158864268998254, 'support': 238500}, '2': {'precision': 0.5712997628241566, 'recall': 0.18495767283065326, 'f1-score': 0.2794452514153951, 'support': 157582}, 'accuracy': 0.5026052459645383, 'macro avg': {'precision': 0.5215621206805073, 'recall': 0.4486839665522719, 'f1-score': 0.43453226125391664, 'support': 552539}, 'weighted avg': {'precision': 0.5176892373390211, 'recall': 0.5026052459645383, 'f1-score': 0.46114462151449365, 'support': 552539}}
[[ 54079  93010   9368]
 [ 31513 194484  12503]
 [ 22872 105564  29146]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9636699
{'0': {'precision': 0.5406301300669276, 'recall': 0.2938451243157913, 'f1-score': 0.3807459285198154, 'support': 58279}, '1': {'precision': 0.5331334332833583, 'recall': 0.8445636361837092, 'f1-score': 0.6536489348258153, 'support': 101051}, '2': {'precision': 0.5820469733088437, 'recall': 0.25672670860984226, 'f1-score': 0.3562987416870006, 'support': 58015}, 'accuracy': 0.5399848167659711, 'macro avg': {'precision': 0.5519368455530432, 'recall': 0.4650451563697809, 'f1-score': 0.4635645350108771, 'support': 217345}, 'weighted avg': {'precision': 0.5481998899141903, 'recall': 0.5399848167659711, 'f1-score': 0.5011021278624358, 'support': 217345}}
[[17125 37201  3953]
 [ 8965 85344  6742]
 [ 5586 37535 14894]]
training model: results/AAL/W3/deepLOB_L1/h100
Epoch 1/50
2159/2159 - 48s - loss: 3.1854 - accuracy100: 0.4304 - val_loss: 3.3531 - val_accuracy100: 0.3916 - 48s/epoch - 22ms/step
Epoch 2/50
2159/2159 - 47s - loss: 3.1515 - accuracy100: 0.4435 - val_loss: 3.4317 - val_accuracy100: 0.3879 - 47s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 47s - loss: 3.1247 - accuracy100: 0.4543 - val_loss: 3.4481 - val_accuracy100: 0.3896 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 48s - loss: 3.1086 - accuracy100: 0.4602 - val_loss: 3.5413 - val_accuracy100: 0.3924 - 48s/epoch - 22ms/step
Epoch 5/50
2159/2159 - 47s - loss: 3.0886 - accuracy100: 0.4664 - val_loss: 3.4635 - val_accuracy100: 0.3950 - 47s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 48s - loss: 3.0745 - accuracy100: 0.4693 - val_loss: 3.4681 - val_accuracy100: 0.3996 - 48s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 47s - loss: 3.0581 - accuracy100: 0.4731 - val_loss: 3.4679 - val_accuracy100: 0.3991 - 47s/epoch - 22ms/step
Epoch 8/50
2159/2159 - 46s - loss: 3.0463 - accuracy100: 0.4765 - val_loss: 3.3782 - val_accuracy100: 0.4096 - 46s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 46s - loss: 3.0379 - accuracy100: 0.4780 - val_loss: 3.4122 - val_accuracy100: 0.4053 - 46s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 46s - loss: 3.0319 - accuracy100: 0.4797 - val_loss: 3.3277 - val_accuracy100: 0.4146 - 46s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 46s - loss: 3.0265 - accuracy100: 0.4815 - val_loss: 3.3331 - val_accuracy100: 0.4078 - 46s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 47s - loss: 3.0219 - accuracy100: 0.4824 - val_loss: 3.3720 - val_accuracy100: 0.4030 - 47s/epoch - 22ms/step
Epoch 13/50
2159/2159 - 47s - loss: 3.0175 - accuracy100: 0.4832 - val_loss: 3.3620 - val_accuracy100: 0.3999 - 47s/epoch - 22ms/step
Epoch 14/50
2159/2159 - 45s - loss: 3.0132 - accuracy100: 0.4847 - val_loss: 3.3292 - val_accuracy100: 0.4099 - 45s/epoch - 21ms/step
Epoch 15/50
2159/2159 - 47s - loss: 3.0109 - accuracy100: 0.4852 - val_loss: 3.3898 - val_accuracy100: 0.4055 - 47s/epoch - 22ms/step
Epoch 16/50
2159/2159 - 46s - loss: 3.0062 - accuracy100: 0.4866 - val_loss: 3.3342 - val_accuracy100: 0.4089 - 46s/epoch - 21ms/step
Epoch 17/50
2159/2159 - 46s - loss: 3.0028 - accuracy100: 0.4866 - val_loss: 3.3394 - val_accuracy100: 0.4053 - 46s/epoch - 21ms/step
Epoch 18/50
2159/2159 - 46s - loss: 3.0006 - accuracy100: 0.4873 - val_loss: 3.3095 - val_accuracy100: 0.4093 - 46s/epoch - 21ms/step
Epoch 19/50
2159/2159 - 46s - loss: 2.9974 - accuracy100: 0.4876 - val_loss: 3.3029 - val_accuracy100: 0.4118 - 46s/epoch - 21ms/step
Epoch 20/50
2159/2159 - 47s - loss: 2.9944 - accuracy100: 0.4892 - val_loss: 3.2885 - val_accuracy100: 0.4155 - 47s/epoch - 22ms/step
Epoch 21/50
2159/2159 - 46s - loss: 2.9918 - accuracy100: 0.4901 - val_loss: 3.3156 - val_accuracy100: 0.4106 - 46s/epoch - 21ms/step
Epoch 22/50
2159/2159 - 46s - loss: 2.9900 - accuracy100: 0.4903 - val_loss: 3.3053 - val_accuracy100: 0.4124 - 46s/epoch - 21ms/step
Epoch 23/50
2159/2159 - 47s - loss: 2.9872 - accuracy100: 0.4903 - val_loss: 3.2950 - val_accuracy100: 0.4094 - 47s/epoch - 22ms/step
Epoch 24/50
2159/2159 - 47s - loss: 2.9851 - accuracy100: 0.4906 - val_loss: 3.3079 - val_accuracy100: 0.4082 - 47s/epoch - 22ms/step
Epoch 25/50
2159/2159 - 46s - loss: 2.9831 - accuracy100: 0.4915 - val_loss: 3.3029 - val_accuracy100: 0.4113 - 46s/epoch - 21ms/step
Epoch 26/50
2159/2159 - 47s - loss: 2.9816 - accuracy100: 0.4919 - val_loss: 3.3217 - val_accuracy100: 0.4103 - 47s/epoch - 22ms/step
Epoch 27/50
2159/2159 - 47s - loss: 2.9796 - accuracy100: 0.4926 - val_loss: 3.3039 - val_accuracy100: 0.4112 - 47s/epoch - 22ms/step
Epoch 28/50
2159/2159 - 47s - loss: 2.9779 - accuracy100: 0.4927 - val_loss: 3.3299 - val_accuracy100: 0.4059 - 47s/epoch - 22ms/step
Epoch 29/50
2159/2159 - 46s - loss: 2.9763 - accuracy100: 0.4931 - val_loss: 3.2967 - val_accuracy100: 0.4101 - 46s/epoch - 21ms/step
Epoch 30/50
2159/2159 - 47s - loss: 2.9741 - accuracy100: 0.4939 - val_loss: 3.2866 - val_accuracy100: 0.4061 - 47s/epoch - 22ms/step
Epoch 31/50
2159/2159 - 46s - loss: 2.9724 - accuracy100: 0.4943 - val_loss: 3.3110 - val_accuracy100: 0.4055 - 46s/epoch - 21ms/step
Epoch 32/50
2159/2159 - 47s - loss: 2.9699 - accuracy100: 0.4953 - val_loss: 3.3096 - val_accuracy100: 0.4069 - 47s/epoch - 22ms/step
Epoch 33/50
2159/2159 - 46s - loss: 2.9694 - accuracy100: 0.4954 - val_loss: 3.2998 - val_accuracy100: 0.4079 - 46s/epoch - 21ms/step
Epoch 34/50
2159/2159 - 46s - loss: 2.9671 - accuracy100: 0.4958 - val_loss: 3.3461 - val_accuracy100: 0.4009 - 46s/epoch - 21ms/step
Epoch 35/50
2159/2159 - 48s - loss: 2.9651 - accuracy100: 0.4968 - val_loss: 3.3283 - val_accuracy100: 0.4025 - 48s/epoch - 22ms/step
Epoch 36/50
2159/2159 - 46s - loss: 2.9637 - accuracy100: 0.4964 - val_loss: 3.3153 - val_accuracy100: 0.4040 - 46s/epoch - 21ms/step
Epoch 37/50
2159/2159 - 45s - loss: 2.9617 - accuracy100: 0.4965 - val_loss: 3.3503 - val_accuracy100: 0.4028 - 45s/epoch - 21ms/step
Epoch 38/50
2159/2159 - 46s - loss: 2.9603 - accuracy100: 0.4978 - val_loss: 3.3453 - val_accuracy100: 0.4022 - 46s/epoch - 21ms/step
Epoch 39/50
2159/2159 - 48s - loss: 2.9585 - accuracy100: 0.4980 - val_loss: 3.3269 - val_accuracy100: 0.4022 - 48s/epoch - 22ms/step
Epoch 40/50
2159/2159 - 46s - loss: 2.9571 - accuracy100: 0.4984 - val_loss: 3.3175 - val_accuracy100: 0.4053 - 46s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h100
Evaluating performance on  test set...
5760/5760 - 64s - 64s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0438281
{'0': {'precision': 0.4982468308095403, 'recall': 0.06054405843243749, 'f1-score': 0.1079684218875896, 'support': 427160}, '1': {'precision': 0.4463093237858473, 'recall': 0.9283168775915248, 'f1-score': 0.6028060246221387, 'support': 638379}, '2': {'precision': 0.5102167901547295, 'recall': 0.11821280799741767, 'f1-score': 0.19195200108005514, 'support': 408932}, 'accuracy': 0.4522442286080906, 'macro avg': {'precision': 0.4849243149167057, 'recall': 0.36902458134046, 'f1-score': 0.3009088158632612, 'support': 1474471}, 'weighted avg': {'precision': 0.47908001479123197, 'recall': 0.4522442286080906, 'f1-score': 0.34550276946201597, 'support': 1474471}}
[[ 25862 383643  17655]
 [ 17011 592618  28750]
 [  9033 351558  48341]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1226008
{'0': {'precision': 0.4194416082035067, 'recall': 0.20670475695797083, 'f1-score': 0.27693389439195093, 'support': 184824}, '1': {'precision': 0.35037428501157225, 'recall': 0.6083769060198746, 'f1-score': 0.4446609828665641, 'support': 182645}, '2': {'precision': 0.40671988248174173, 'recall': 0.31716107418814504, 'f1-score': 0.35640035459701025, 'support': 185070}, 'accuracy': 0.37647659260251315, 'macro avg': {'precision': 0.3921785918989402, 'recall': 0.37741424572199683, 'f1-score': 0.35933174395184175, 'support': 552539}, 'weighted avg': {'precision': 0.3923499259444844, 'recall': 0.37647659260251315, 'f1-score': 0.35899393334774604, 'support': 552539}}
[[ 38204 105467  41153]
 [ 27060 111117  44468]
 [ 25819 100554  58697]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967933
{'0': {'precision': 0.43471965248169897, 'recall': 0.2312201383441489, 'f1-score': 0.3018769551616267, 'support': 70115}, '1': {'precision': 0.38614232760649564, 'recall': 0.6792548030273627, 'f1-score': 0.4923779558573217, 'support': 77295}, '2': {'precision': 0.44460575265402413, 'recall': 0.2802602416529635, 'f1-score': 0.3438023487313518, 'support': 69935}, 'accuracy': 0.40633554947203754, 'macro avg': {'precision': 0.4218225775807396, 'recall': 0.3969117276748251, 'f1-score': 0.37935241991676677, 'support': 217345}, 'weighted avg': {'precision': 0.4206250107338912, 'recall': 0.40633554947203754, 'f1-score': 0.3831156643478167, 'support': 217345}}
[[16212 42401 11502]
 [11810 52503 12982]
 [ 9271 41064 19600]]
training model: results/AAL/W3/deepLOB_L1/h200
Epoch 1/50
2159/2159 - 51s - loss: 3.2573 - accuracy200: 0.3945 - val_loss: 3.3186 - val_accuracy200: 0.3542 - 51s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 47s - loss: 3.2349 - accuracy200: 0.4035 - val_loss: 3.4128 - val_accuracy200: 0.3632 - 47s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 47s - loss: 3.2272 - accuracy200: 0.4100 - val_loss: 3.4115 - val_accuracy200: 0.3655 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 47s - loss: 3.2176 - accuracy200: 0.4149 - val_loss: 3.4203 - val_accuracy200: 0.3674 - 47s/epoch - 22ms/step
Epoch 5/50
2159/2159 - 48s - loss: 3.2108 - accuracy200: 0.4171 - val_loss: 3.5145 - val_accuracy200: 0.3642 - 48s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 48s - loss: 3.2067 - accuracy200: 0.4192 - val_loss: 3.6453 - val_accuracy200: 0.3623 - 48s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 47s - loss: 3.2009 - accuracy200: 0.4211 - val_loss: 3.5846 - val_accuracy200: 0.3642 - 47s/epoch - 22ms/step
Epoch 8/50
2159/2159 - 48s - loss: 3.1981 - accuracy200: 0.4224 - val_loss: 3.5936 - val_accuracy200: 0.3580 - 48s/epoch - 22ms/step
Epoch 9/50
2159/2159 - 47s - loss: 3.1951 - accuracy200: 0.4237 - val_loss: 3.6763 - val_accuracy200: 0.3467 - 47s/epoch - 22ms/step
Epoch 10/50
2159/2159 - 47s - loss: 3.1917 - accuracy200: 0.4247 - val_loss: 3.7169 - val_accuracy200: 0.3476 - 47s/epoch - 22ms/step
Epoch 11/50
2159/2159 - 48s - loss: 3.1889 - accuracy200: 0.4261 - val_loss: 3.6806 - val_accuracy200: 0.3451 - 48s/epoch - 22ms/step
testing model: results/AAL/W3/deepLOB_L1/h200
Evaluating performance on  test set...
5760/5760 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092811
{'0': {'precision': 0.4325062731114633, 'recall': 0.10735740042615964, 'f1-score': 0.17201657168369358, 'support': 488080}, '1': {'precision': 0.3608766841167761, 'recall': 0.8563460549755553, 'f1-score': 0.5077711988957827, 'support': 527107}, '2': {'precision': 0.39506413695556747, 'recall': 0.08818073348951846, 'f1-score': 0.14417967992111058, 'support': 459284}, 'accuracy': 0.36913916923425416, 'macro avg': {'precision': 0.3961490313946023, 'recall': 0.35062806296374444, 'f1-score': 0.27465581683352897, 'support': 1474471}, 'weighted avg': {'precision': 0.39523661380419506, 'recall': 0.36913916923425416, 'f1-score': 0.28337418759448224, 'support': 1474471}}
[[ 52399 412508  23173]
 [ 36879 451386  38842]
 [ 31874 386910  40500]]
Evaluating performance on  train set...
2159/2159 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1107277
{'0': {'precision': 0.3726218353557096, 'recall': 0.25626982620719574, 'f1-score': 0.30368261760793713, 'support': 184415}, '1': {'precision': 0.33548414522686765, 'recall': 0.5992006030728514, 'f1-score': 0.43013925819801374, 'support': 184389}, '2': {'precision': 0.39927367055771723, 'recall': 0.20943206248129098, 'f1-score': 0.27474920566920136, 'support': 183735}, 'accuracy': 0.35513511263458325, 'macro avg': {'precision': 0.3691265503800982, 'recall': 0.35496749725377935, 'f1-score': 0.3361903604917174, 'support': 552539}, 'weighted avg': {'precision': 0.3690910319113805, 'recall': 0.35513511263458325, 'f1-score': 0.33626155422453796, 'support': 552539}}
[[ 47260 109881  27274]
 [ 43282 110486  30621]
 [ 36289 108966  38480]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1064587
{'0': {'precision': 0.3906993511175198, 'recall': 0.14654659527286495, 'f1-score': 0.21314505978602896, 'support': 73956}, '1': {'precision': 0.32781552951824694, 'recall': 0.6577379263378923, 'f1-score': 0.4375545645454331, 'support': 70484}, '2': {'precision': 0.4085173501577287, 'recall': 0.2699951992318771, 'f1-score': 0.3251162368175474, 'support': 72905}, 'accuracy': 0.35373254503209184, 'macro avg': {'precision': 0.37567741026449847, 'recall': 0.3580932402808781, 'f1-score': 0.3252719537163365, 'support': 217345}, 'weighted avg': {'precision': 0.3762831829904558, 'recall': 0.35373254503209184, 'f1-score': 0.3234790366198401, 'support': 217345}}
[[10838 48771 14347]
 [ 9971 46360 14153]
 [ 6931 46290 19684]]
training model: results/AAL/W3/deepLOB_L1/h300
Epoch 1/50
2159/2159 - 50s - loss: 3.2729 - accuracy300: 0.3872 - val_loss: 3.3450 - val_accuracy300: 0.3663 - 50s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 46s - loss: 3.2506 - accuracy300: 0.3986 - val_loss: 3.4300 - val_accuracy300: 0.3387 - 46s/epoch - 21ms/step
Epoch 3/50
2159/2159 - 47s - loss: 3.2395 - accuracy300: 0.4056 - val_loss: 3.4822 - val_accuracy300: 0.3423 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 46s - loss: 3.2331 - accuracy300: 0.4089 - val_loss: 3.4701 - val_accuracy300: 0.3464 - 46s/epoch - 21ms/step
Epoch 5/50
2159/2159 - 47s - loss: 3.2262 - accuracy300: 0.4120 - val_loss: 3.4742 - val_accuracy300: 0.3591 - 47s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 47s - loss: 3.2217 - accuracy300: 0.4138 - val_loss: 3.5199 - val_accuracy300: 0.3639 - 47s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 46s - loss: 3.2174 - accuracy300: 0.4159 - val_loss: 3.5509 - val_accuracy300: 0.3568 - 46s/epoch - 22ms/step
Epoch 8/50
2159/2159 - 46s - loss: 3.2141 - accuracy300: 0.4173 - val_loss: 3.5585 - val_accuracy300: 0.3534 - 46s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 47s - loss: 3.2102 - accuracy300: 0.4191 - val_loss: 3.6045 - val_accuracy300: 0.3537 - 47s/epoch - 22ms/step
Epoch 10/50
2159/2159 - 48s - loss: 3.2069 - accuracy300: 0.4208 - val_loss: 3.6269 - val_accuracy300: 0.3431 - 48s/epoch - 22ms/step
Epoch 11/50
2159/2159 - 46s - loss: 3.2038 - accuracy300: 0.4221 - val_loss: 3.6979 - val_accuracy300: 0.3367 - 46s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h300
Evaluating performance on  test set...
5760/5760 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1025156
{'0': {'precision': 0.39900503858664454, 'recall': 0.13250054537868342, 'f1-score': 0.19893821181386429, 'support': 472149}, '1': {'precision': 0.40987599165470245, 'recall': 0.33553480725563195, 'f1-score': 0.368998308207002, 'support': 563259}, '2': {'precision': 0.3266034931816298, 'recall': 0.6371819078355498, 'f1-score': 0.4318509839879103, 'support': 439063}, 'accuracy': 0.36034347233685843, 'macro avg': {'precision': 0.37849484114099224, 'recall': 0.36840575348995513, 'f1-score': 0.3332625013362589, 'support': 1474471}, 'weighted avg': {'precision': 0.3815983364026065, 'recall': 0.36034347233685843, 'f1-score': 0.333258425859007, 'support': 1474471}}
[[ 62560 158472 251117]
 [ 48563 188993 325703]
 [ 45667 113633 279763]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1275169
{'0': {'precision': 0.36189092604798606, 'recall': 0.4363457462912504, 'f1-score': 0.3956459823868664, 'support': 184968}, '1': {'precision': 0.3424128675403257, 'recall': 0.3691669869858876, 'f1-score': 0.3552869739383642, 'support': 182110}, '2': {'precision': 0.36607672496001564, 'recall': 0.26287467445985946, 'f1-score': 0.30600869952736337, 'support': 185461}, 'accuracy': 0.3559784920159482, 'macro avg': {'precision': 0.35679350618277583, 'recall': 0.3561291359123325, 'f1-score': 0.352313885284198, 'support': 552539}, 'weighted avg': {'precision': 0.35687617273137656, 'recall': 0.3559784920159482, 'f1-score': 0.35225719146900725, 'support': 552539}}
[[80710 63129 41129]
 [71586 67229 43295]
 [70727 65981 48753]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114504
{'0': {'precision': 0.36447419631042266, 'recall': 0.32611784371082325, 'f1-score': 0.34423083991913245, 'support': 71790}, '1': {'precision': 0.3691487970711297, 'recall': 0.4489901399491094, 'f1-score': 0.40517365097588975, 'support': 75456}, '2': {'precision': 0.36811556396126127, 'recall': 0.32208733362815445, 'f1-score': 0.343566684166077, 'support': 70099}, 'accuracy': 0.36747567231820377, 'macro avg': {'precision': 0.3672461857809379, 'recall': 0.36573177242936233, 'f1-score': 0.36432372502036636, 'support': 217345}, 'weighted avg': {'precision': 0.3672715135063832, 'recall': 0.36747567231820377, 'f1-score': 0.36517424371018004, 'support': 217345}}
[[23412 29310 19068]
 [21889 33879 19688]
 [18934 28587 22578]]
training model: results/AAL/W3/deepLOB_L1/h500
Epoch 1/50
2159/2159 - 50s - loss: 3.2361 - accuracy500: 0.4093 - val_loss: 3.3990 - val_accuracy500: 0.3474 - 50s/epoch - 23ms/step
Epoch 2/50
2159/2159 - 48s - loss: 3.2064 - accuracy500: 0.4238 - val_loss: 3.6433 - val_accuracy500: 0.3265 - 48s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 47s - loss: 3.1941 - accuracy500: 0.4312 - val_loss: 3.7607 - val_accuracy500: 0.3259 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 47s - loss: 3.1823 - accuracy500: 0.4364 - val_loss: 3.6690 - val_accuracy500: 0.3182 - 47s/epoch - 22ms/step
Epoch 5/50
2159/2159 - 47s - loss: 3.1719 - accuracy500: 0.4413 - val_loss: 3.8429 - val_accuracy500: 0.3308 - 47s/epoch - 22ms/step
Epoch 6/50
2159/2159 - 47s - loss: 3.1636 - accuracy500: 0.4445 - val_loss: 3.7997 - val_accuracy500: 0.3233 - 47s/epoch - 22ms/step
Epoch 7/50
2159/2159 - 47s - loss: 3.1585 - accuracy500: 0.4471 - val_loss: 3.9138 - val_accuracy500: 0.3133 - 47s/epoch - 22ms/step
Epoch 8/50
2159/2159 - 46s - loss: 3.1523 - accuracy500: 0.4492 - val_loss: 4.0515 - val_accuracy500: 0.3213 - 46s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 46s - loss: 3.1484 - accuracy500: 0.4498 - val_loss: 4.0883 - val_accuracy500: 0.3227 - 46s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 47s - loss: 3.1409 - accuracy500: 0.4531 - val_loss: 4.1565 - val_accuracy500: 0.3222 - 47s/epoch - 22ms/step
Epoch 11/50
2159/2159 - 48s - loss: 3.1359 - accuracy500: 0.4552 - val_loss: 4.0633 - val_accuracy500: 0.3148 - 48s/epoch - 22ms/step
testing model: results/AAL/W3/deepLOB_L1/h500
Evaluating performance on  test set...
5760/5760 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.136559
{'0': {'precision': 0.4546339786917173, 'recall': 0.06044946772556688, 'f1-score': 0.10671040668469373, 'support': 525199}, '1': {'precision': 0.31036817604739736, 'recall': 0.007863665021165632, 'f1-score': 0.015338699996026243, 'support': 466322}, '2': {'precision': 0.32899346938306634, 'recall': 0.9488145770783725, 'f1-score': 0.4885769820884605, 'support': 482950}, 'accuracy': 0.33479464838576006, 'macro avg': {'precision': 0.36466520804072694, 'recall': 0.3390425699417017, 'f1-score': 0.2035420295897268, 'support': 1474471}, 'weighted avg': {'precision': 0.3678554651832675, 'recall': 0.33479464838576006, 'f1-score': 0.20288986737586795, 'support': 1474471}}
[[ 31748   4448 489003]
 [ 17064   3667 445591]
 [ 21020   3700 458230]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1265208
{'0': {'precision': 0.3325028259231349, 'recall': 0.38160127998616233, 'f1-score': 0.3553641630717655, 'support': 185002}, '1': {'precision': 0.3984965257041018, 'recall': 0.23039022251452373, 'f1-score': 0.29197531507315533, 'support': 182460}, '2': {'precision': 0.3619690708473565, 'recall': 0.4590791940651729, 'f1-score': 0.4047812447148332, 'support': 185077}, 'accuracy': 0.3576200051037121, 'macro avg': {'precision': 0.36432280749153106, 'recall': 0.35702356552195297, 'f1-score': 0.350706907619918, 'support': 552539}, 'weighted avg': {'precision': 0.364165269069909, 'recall': 0.3576200051037121, 'f1-score': 0.3509844469131371, 'support': 552539}}
[[70597 31294 83111]
 [73769 42037 66654]
 [67954 32158 84965]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1336159
{'0': {'precision': 0.34499313363180634, 'recall': 0.3978267586775157, 'f1-score': 0.36953103044146396, 'support': 77672}, '1': {'precision': 0.29463737881948704, 'recall': 0.07403067910275186, 'f1-score': 0.1183297808114535, 'support': 64865}, '2': {'precision': 0.3583064226767133, 'recall': 0.5339535878515667, 'f1-score': 0.4288413639096453, 'support': 74808}, 'accuracy': 0.3480457337412869, 'macro avg': {'precision': 0.33264564504266886, 'recall': 0.33527034187727806, 'f1-score': 0.3055673917208543, 'support': 217345}, 'weighted avg': {'precision': 0.33454713529262353, 'recall': 0.3480457337412869, 'f1-score': 0.3149759146984613, 'support': 217345}}
[[30900  5855 40917]
 [29444  4802 30619]
 [29223  5641 39944]]
training model: results/AAL/W3/deepLOB_L1/h1000
Epoch 1/50
2159/2159 - 51s - loss: 3.2223 - accuracy1000: 0.4216 - val_loss: 3.3715 - val_accuracy1000: 0.3678 - 51s/epoch - 24ms/step
Epoch 2/50
2159/2159 - 47s - loss: 3.1761 - accuracy1000: 0.4356 - val_loss: 3.4173 - val_accuracy1000: 0.3714 - 47s/epoch - 22ms/step
Epoch 3/50
2159/2159 - 47s - loss: 3.1509 - accuracy1000: 0.4459 - val_loss: 3.4840 - val_accuracy1000: 0.3666 - 47s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 45s - loss: 3.1448 - accuracy1000: 0.4484 - val_loss: 3.4191 - val_accuracy1000: 0.3724 - 45s/epoch - 21ms/step
Epoch 5/50
2159/2159 - 46s - loss: 3.1251 - accuracy1000: 0.4567 - val_loss: 3.4509 - val_accuracy1000: 0.3708 - 46s/epoch - 21ms/step
Epoch 6/50
2159/2159 - 45s - loss: 3.1122 - accuracy1000: 0.4632 - val_loss: 3.4223 - val_accuracy1000: 0.3685 - 45s/epoch - 21ms/step
Epoch 7/50
2159/2159 - 46s - loss: 3.1026 - accuracy1000: 0.4667 - val_loss: 3.4344 - val_accuracy1000: 0.3745 - 46s/epoch - 21ms/step
Epoch 8/50
2159/2159 - 45s - loss: 3.0978 - accuracy1000: 0.4682 - val_loss: 3.5535 - val_accuracy1000: 0.3742 - 45s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 45s - loss: 3.0882 - accuracy1000: 0.4719 - val_loss: 3.5421 - val_accuracy1000: 0.3749 - 45s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 45s - loss: 3.0896 - accuracy1000: 0.4707 - val_loss: 3.5722 - val_accuracy1000: 0.3737 - 45s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 45s - loss: 3.0792 - accuracy1000: 0.4743 - val_loss: 3.6157 - val_accuracy1000: 0.3712 - 45s/epoch - 21ms/step
testing model: results/AAL/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1341031
{'0': {'precision': 0.4852597350245895, 'recall': 0.0612616708283574, 'f1-score': 0.10878923253495118, 'support': 589504}, '1': {'precision': 0.25350432448553534, 'recall': 0.0024475363387159938, 'f1-score': 0.0048482636086481625, 'support': 347288}, '2': {'precision': 0.36761686150744327, 'recall': 0.9549359376133344, 'f1-score': 0.5308681098546042, 'support': 537679}, 'accuracy': 0.37329523605415094, 'macro avg': {'precision': 0.3687936403391894, 'recall': 0.3395483815934693, 'f1-score': 0.21483520199940118, 'support': 1474471}, 'weighted avg': {'precision': 0.3877739414042927, 'recall': 0.37329523605415094, 'f1-score': 0.23822243092398412, 'support': 1474471}}
[[ 36114   1338 552052]
 [ 15243    850 331195]
 [ 23065   1165 513449]]
Evaluating performance on  train set...
2159/2159 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1617326
{'0': {'precision': 0.31081576311353254, 'recall': 0.48112330898560746, 'f1-score': 0.37765710444792666, 'support': 185096}, '1': {'precision': 0.3501922508133688, 'recall': 0.012945691512043648, 'f1-score': 0.02496836777730915, 'support': 182918}, '2': {'precision': 0.3655480984340045, 'recall': 0.513599783227205, 'f1-score': 0.4271077210811542, 'support': 184525}, 'accuracy': 0.33697892818425484, 'macro avg': {'precision': 0.3421853707869686, 'recall': 0.33588959457495204, 'f1-score': 0.27657773110213, 'support': 552539}, 'weighted avg': {'precision': 0.34212966593684224, 'recall': 0.33697892818425484, 'f1-score': 0.27741396631637455, 'support': 552539}}
[[ 89054   2200  93842]
 [109904   2368  70646]
 [ 87559   2194  94772]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.124226
{'0': {'precision': 0.3670397302965562, 'recall': 0.4446449560127747, 'f1-score': 0.4021324228124144, 'support': 84229}, '1': {'precision': 0.27386306846576713, 'recall': 0.009994346263974758, 'f1-score': 0.019284909909909907, 'support': 54831}, '2': {'precision': 0.370456992568796, 'recall': 0.5361818994698857, 'f1-score': 0.4381729830733177, 'support': 78285}, 'accuracy': 0.3679633761991304, 'macro avg': {'precision': 0.3371199304437064, 'recall': 0.33027373391554504, 'f1-score': 0.286530105265214, 'support': 217345}, 'weighted avg': {'precision': 0.34476431946188457, 'recall': 0.3679633761991304, 'f1-score': 0.318530422674696, 'support': 217345}}
[[37452   740 46037]
 [28989   548 25294]
 [35597   713 41975]]
training model: results/AAL/W3/deepOF_L1/h10
Epoch 1/50
2159/2159 - 46s - loss: 3.1233 - accuracy10: 0.3702 - val_loss: 3.1499 - val_accuracy10: 0.6902 - 46s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.0656 - accuracy10: 0.3652 - val_loss: 3.1186 - val_accuracy10: 0.6886 - 44s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 42s - loss: 3.0332 - accuracy10: 0.3836 - val_loss: 3.1147 - val_accuracy10: 0.6927 - 42s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 42s - loss: 3.0083 - accuracy10: 0.4046 - val_loss: 3.1383 - val_accuracy10: 0.6969 - 42s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 42s - loss: 2.9904 - accuracy10: 0.4204 - val_loss: 3.1253 - val_accuracy10: 0.6974 - 42s/epoch - 19ms/step
Epoch 6/50
2159/2159 - 42s - loss: 2.9743 - accuracy10: 0.4294 - val_loss: 3.1215 - val_accuracy10: 0.6923 - 42s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 42s - loss: 2.9590 - accuracy10: 0.4367 - val_loss: 3.1506 - val_accuracy10: 0.6949 - 42s/epoch - 20ms/step
Epoch 8/50
2159/2159 - 42s - loss: 2.9442 - accuracy10: 0.4414 - val_loss: 3.1700 - val_accuracy10: 0.6980 - 42s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 42s - loss: 2.9348 - accuracy10: 0.4456 - val_loss: 3.1453 - val_accuracy10: 0.6926 - 42s/epoch - 19ms/step
Epoch 10/50
2159/2159 - 41s - loss: 2.9227 - accuracy10: 0.4507 - val_loss: 3.1820 - val_accuracy10: 0.6952 - 41s/epoch - 19ms/step
Epoch 11/50
2159/2159 - 41s - loss: 2.9122 - accuracy10: 0.4547 - val_loss: 3.2077 - val_accuracy10: 0.6947 - 41s/epoch - 19ms/step
Epoch 12/50
2159/2159 - 42s - loss: 2.9021 - accuracy10: 0.4578 - val_loss: 3.2428 - val_accuracy10: 0.6932 - 42s/epoch - 19ms/step
Epoch 13/50
2159/2159 - 42s - loss: 2.8932 - accuracy10: 0.4606 - val_loss: 3.3083 - val_accuracy10: 0.6935 - 42s/epoch - 19ms/step
testing model: results/AAL/W3/deepOF_L1/h10
Evaluating performance on  test set...
5760/5760 - 60s - 60s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8041295
{'0': {'precision': 0.24135114160846302, 'recall': 0.07741943936743771, 'f1-score': 0.11723334077325595, 'support': 152649}, '1': {'precision': 0.7981929735969867, 'recall': 0.9562161004241464, 'f1-score': 0.8700878077990042, 'support': 1167050}, '2': {'precision': 0.30354340765609605, 'recall': 0.05374496019849064, 'f1-score': 0.09132079200311795, 'support': 154768}, 'accuracy': 0.7705075800272234, 'macro avg': {'precision': 0.44769584095384857, 'recall': 0.3624601666633583, 'f1-score': 0.3595473135251261, 'support': 1474467}, 'weighted avg': {'precision': 0.6886230253833231, 'recall': 0.7705075800272234, 'f1-score': 0.7104025147149872, 'support': 1474467}}
[[  11818  138668    2163]
 [  34176 1115952   16922]
 [   2972  143478    8318]]
Evaluating performance on  train set...
2159/2159 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86432797
{'0': {'precision': 0.34793982995421846, 'recall': 0.13736121869351925, 'f1-score': 0.19696408737504628, 'support': 81333}, '1': {'precision': 0.7164150598047095, 'recall': 0.926492155218105, 'f1-score': 0.8080224211322312, 'support': 388666}, '2': {'precision': 0.3580059573989771, 'recall': 0.0771756381831619, 'f1-score': 0.12697843160706454, 'support': 82539}, 'accuracy': 0.6834606850569553, 'macro avg': {'precision': 0.47412028238596843, 'recall': 0.3803430040315954, 'f1-score': 0.3773216467047807, 'support': 552538}, 'weighted avg': {'precision': 0.6086361834687892, 'recall': 0.6834606850569553, 'f1-score': 0.6163398629898214, 'support': 552538}}
[[ 11172  68842   1319]
 [ 18466 360096  10104]
 [  2471  73698   6370]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8536408
{'0': {'precision': 0.3112274206931767, 'recall': 0.16278293383187553, 'f1-score': 0.21376120646193636, 'support': 29954}, '1': {'precision': 0.7393272158584834, 'recall': 0.906660400843346, 'f1-score': 0.8144881566336543, 'support': 157468}, '2': {'precision': 0.33862310385064176, 'recall': 0.09698225445309629, 'f1-score': 0.1507806614189593, 'support': 29923}, 'accuracy': 0.6926683383560699, 'macro avg': {'precision': 0.46305924680076727, 'recall': 0.38880852970943924, 'f1-score': 0.39301000817151666, 'support': 217345}, 'weighted avg': {'precision': 0.6251604744658025, 'recall': 0.6926683383560699, 'f1-score': 0.6403213046483177, 'support': 217345}}
[[  4876  24408    670]
 [  9700 142770   4998]
 [  1091  25930   2902]]
training model: results/AAL/W3/deepOF_L1/h20
Epoch 1/50
2159/2159 - 47s - loss: 3.1643 - accuracy20: 0.3900 - val_loss: 3.2217 - val_accuracy20: 0.6202 - 47s/epoch - 22ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.1179 - accuracy20: 0.3879 - val_loss: 3.1631 - val_accuracy20: 0.6216 - 44s/epoch - 21ms/step
Epoch 3/50
2159/2159 - 43s - loss: 3.0910 - accuracy20: 0.4032 - val_loss: 3.1700 - val_accuracy20: 0.6267 - 43s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 43s - loss: 3.0692 - accuracy20: 0.4190 - val_loss: 3.1745 - val_accuracy20: 0.6268 - 43s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 43s - loss: 3.0537 - accuracy20: 0.4298 - val_loss: 3.1712 - val_accuracy20: 0.6268 - 43s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 43s - loss: 3.0382 - accuracy20: 0.4389 - val_loss: 3.1797 - val_accuracy20: 0.6266 - 43s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 44s - loss: 3.0237 - accuracy20: 0.4454 - val_loss: 3.1540 - val_accuracy20: 0.6230 - 44s/epoch - 20ms/step
Epoch 8/50
2159/2159 - 42s - loss: 3.0120 - accuracy20: 0.4498 - val_loss: 3.1971 - val_accuracy20: 0.6256 - 42s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 42s - loss: 3.0020 - accuracy20: 0.4518 - val_loss: 3.1910 - val_accuracy20: 0.6235 - 42s/epoch - 19ms/step
Epoch 10/50
2159/2159 - 42s - loss: 2.9932 - accuracy20: 0.4551 - val_loss: 3.2175 - val_accuracy20: 0.6241 - 42s/epoch - 20ms/step
Epoch 11/50
2159/2159 - 43s - loss: 2.9826 - accuracy20: 0.4582 - val_loss: 3.2233 - val_accuracy20: 0.6235 - 43s/epoch - 20ms/step
Epoch 12/50
2159/2159 - 43s - loss: 2.9732 - accuracy20: 0.4626 - val_loss: 3.2369 - val_accuracy20: 0.6236 - 43s/epoch - 20ms/step
Epoch 13/50
2159/2159 - 43s - loss: 2.9651 - accuracy20: 0.4640 - val_loss: 3.2444 - val_accuracy20: 0.6227 - 43s/epoch - 20ms/step
Epoch 14/50
2159/2159 - 42s - loss: 2.9560 - accuracy20: 0.4674 - val_loss: 3.2389 - val_accuracy20: 0.6196 - 42s/epoch - 20ms/step
Epoch 15/50
2159/2159 - 42s - loss: 2.9483 - accuracy20: 0.4705 - val_loss: 3.2768 - val_accuracy20: 0.6217 - 42s/epoch - 19ms/step
Epoch 16/50
2159/2159 - 44s - loss: 2.9397 - accuracy20: 0.4721 - val_loss: 3.2575 - val_accuracy20: 0.6216 - 44s/epoch - 20ms/step
Epoch 17/50
2159/2159 - 42s - loss: 2.9327 - accuracy20: 0.4749 - val_loss: 3.2574 - val_accuracy20: 0.6193 - 42s/epoch - 19ms/step
testing model: results/AAL/W3/deepOF_L1/h20
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84095937
{'0': {'precision': 0.3294750158127767, 'recall': 0.14895340857099285, 'f1-score': 0.20515681821165538, 'support': 209824}, '1': {'precision': 0.7312531831952792, 'recall': 0.9228616001529761, 'f1-score': 0.8159596777129723, 'support': 1056374}, '2': {'precision': 0.3923418184950683, 'recall': 0.08747341178956061, 'f1-score': 0.1430528890511694, 'support': 208269}, 'accuracy': 0.6947317233956406, 'macro avg': {'precision': 0.48435667250104136, 'recall': 0.3864294735045099, 'f1-score': 0.38805646165859903, 'support': 1474467}, 'weighted avg': {'precision': 0.6262067947663659, 'recall': 0.6947317233956406, 'f1-score': 0.6339910591139738, 'support': 1474467}}
[[ 31254 174834   3736]
 [ 57007 974887  24480]
 [  6599 183452  18218]]
Evaluating performance on  train set...
2159/2159 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9198578
{'0': {'precision': 0.43824098878073364, 'recall': 0.151981750784146, 'f1-score': 0.2256932113099304, 'support': 108717}, '1': {'precision': 0.6221074498216516, 'recall': 0.9132999406841099, 'f1-score': 0.7400911322096768, 'support': 333806}, '2': {'precision': 0.45983133599644915, 'recall': 0.10358587465345635, 'f1-score': 0.16908262733868457, 'support': 110015}, 'accuracy': 0.6022825579417163, 'macro avg': {'precision': 0.5067265915329447, 'recall': 0.38962252204057074, 'f1-score': 0.37828899028609725, 'support': 552538}, 'weighted avg': {'precision': 0.553619460384789, 'recall': 0.6022825579417163, 'f1-score': 0.5251859140530252, 'support': 552538}}
[[ 16523  89871   2323]
 [ 17877 304865  11064]
 [  3303  95316  11396]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.895788
{'0': {'precision': 0.40265048303195444, 'recall': 0.1630922818371084, 'f1-score': 0.2321521021155048, 'support': 39867}, '1': {'precision': 0.6523583046482907, 'recall': 0.9028058589943126, 'f1-score': 0.7574157293087194, 'support': 137498}, '2': {'precision': 0.4466642228739003, 'recall': 0.12191095547773886, 'f1-score': 0.19154287510807197, 'support': 39980}, 'accuracy': 0.6234788009846097, 'macro avg': {'precision': 0.5005576701847151, 'recall': 0.3959363654363866, 'f1-score': 0.3937035688440987, 'support': 217345}, 'weighted avg': {'precision': 0.5687182341901775, 'recall': 0.6234788009846097, 'f1-score': 0.5569773399450175, 'support': 217345}}
[[  6502  32373    992]
 [  8318 124134   5046]
 [  1328  33778   4874]]
training model: results/AAL/W3/deepOF_L1/h30
Epoch 1/50
2159/2159 - 46s - loss: 3.1949 - accuracy30: 0.3976 - val_loss: 3.2544 - val_accuracy30: 0.5609 - 46s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.1573 - accuracy30: 0.3973 - val_loss: 3.1896 - val_accuracy30: 0.5641 - 44s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 42s - loss: 3.1326 - accuracy30: 0.4139 - val_loss: 3.2036 - val_accuracy30: 0.5664 - 42s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 43s - loss: 3.1147 - accuracy30: 0.4261 - val_loss: 3.2057 - val_accuracy30: 0.5682 - 43s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 42s - loss: 3.1004 - accuracy30: 0.4344 - val_loss: 3.2185 - val_accuracy30: 0.5691 - 42s/epoch - 19ms/step
Epoch 6/50
2159/2159 - 43s - loss: 3.0872 - accuracy30: 0.4387 - val_loss: 3.2218 - val_accuracy30: 0.5705 - 43s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 44s - loss: 3.0745 - accuracy30: 0.4449 - val_loss: 3.2473 - val_accuracy30: 0.5697 - 44s/epoch - 20ms/step
Epoch 8/50
2159/2159 - 45s - loss: 3.0618 - accuracy30: 0.4504 - val_loss: 3.2989 - val_accuracy30: 0.5731 - 45s/epoch - 21ms/step
Epoch 9/50
2159/2159 - 45s - loss: 3.0515 - accuracy30: 0.4545 - val_loss: 3.2744 - val_accuracy30: 0.5716 - 45s/epoch - 21ms/step
Epoch 10/50
2159/2159 - 45s - loss: 3.0416 - accuracy30: 0.4579 - val_loss: 3.3020 - val_accuracy30: 0.5715 - 45s/epoch - 21ms/step
Epoch 11/50
2159/2159 - 45s - loss: 3.0317 - accuracy30: 0.4614 - val_loss: 3.3265 - val_accuracy30: 0.5733 - 45s/epoch - 21ms/step
Epoch 12/50
2159/2159 - 44s - loss: 3.0227 - accuracy30: 0.4644 - val_loss: 3.3437 - val_accuracy30: 0.5735 - 44s/epoch - 20ms/step
testing model: results/AAL/W3/deepOF_L1/h30
Evaluating performance on  test set...
5760/5760 - 62s - 62s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9067876
{'0': {'precision': 0.40047776294526805, 'recall': 0.044984965550986904, 'f1-score': 0.08088433540037746, 'support': 253418}, '1': {'precision': 0.664480502145174, 'recall': 0.9762936958547169, 'f1-score': 0.7907585651377402, 'support': 971345}, '2': {'precision': 0.4374867331776693, 'recall': 0.03301508986640182, 'f1-score': 0.06139684525671389, 'support': 249704}, 'accuracy': 0.6564826476279225, 'macro avg': {'precision': 0.5008149994227037, 'recall': 0.3514312504240353, 'f1-score': 0.31101324859827717, 'support': 1474467}, 'weighted avg': {'precision': 0.5806642497306922, 'recall': 0.6564826476279225, 'f1-score': 0.5452329301437019, 'support': 1474467}}
[[ 11400 240254   1764]
 [ 14191 948318   8836]
 [  2875 238585   8244]]
Evaluating performance on  train set...
2159/2159 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9915456
{'0': {'precision': 0.4658968725164789, 'recall': 0.07759446265484245, 'f1-score': 0.13303254398376804, 'support': 128437}, '1': {'precision': 0.5411761982029608, 'recall': 0.9527772493817767, 'f1-score': 0.690276354177305, 'support': 294392}, '2': {'precision': 0.48910505836575874, 'recall': 0.04845461764411105, 'f1-score': 0.08817401917802455, 'support': 129709}, 'accuracy': 0.537050845371721, 'macro avg': {'precision': 0.4987260430283995, 'recall': 0.35960877656024337, 'f1-score': 0.30382763911303257, 'support': 552538}, 'weighted avg': {'precision': 0.5114538148911555, 'recall': 0.537050845371721, 'f1-score': 0.41940120166245726, 'support': 552538}}
[[  9966 116999   1472]
 [  8809 280490   5093]
 [  2616 120808   6285]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9715508
{'0': {'precision': 0.4193087434134143, 'recall': 0.099253747119633, 'f1-score': 0.1605128205128205, 'support': 47303}, '1': {'precision': 0.5749108353217182, 'recall': 0.9357220783873121, 'f1-score': 0.7122269835810582, 'support': 122826}, '2': {'precision': 0.45438512105178774, 'recall': 0.06002202643171806, 'f1-score': 0.1060370793033132, 'support': 47216}, 'accuracy': 0.5634360118705284, 'macro avg': {'precision': 0.4828682332623067, 'recall': 0.36499928397955445, 'f1-score': 0.32625896113239733, 'support': 217345}, 'weighted avg': {'precision': 0.5148625808023709, 'recall': 0.5634360118705284, 'f1-score': 0.4604632090475062, 'support': 217345}}
[[  4695  41908    700]
 [  5192 114931   2703]
 [  1310  43072   2834]]
training model: results/AAL/W3/deepOF_L1/h50
Epoch 1/50
2159/2159 - 45s - loss: 3.2339 - accuracy50: 0.4039 - val_loss: 3.3242 - val_accuracy50: 0.4669 - 45s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 43s - loss: 3.2087 - accuracy50: 0.4054 - val_loss: 3.2535 - val_accuracy50: 0.4714 - 43s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 42s - loss: 3.1909 - accuracy50: 0.4153 - val_loss: 3.2491 - val_accuracy50: 0.4752 - 42s/epoch - 19ms/step
Epoch 4/50
2159/2159 - 42s - loss: 3.1780 - accuracy50: 0.4242 - val_loss: 3.2393 - val_accuracy50: 0.4775 - 42s/epoch - 19ms/step
Epoch 5/50
2159/2159 - 43s - loss: 3.1669 - accuracy50: 0.4299 - val_loss: 3.2461 - val_accuracy50: 0.4782 - 43s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 42s - loss: 3.1574 - accuracy50: 0.4346 - val_loss: 3.2543 - val_accuracy50: 0.4789 - 42s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 42s - loss: 3.1478 - accuracy50: 0.4395 - val_loss: 3.2714 - val_accuracy50: 0.4791 - 42s/epoch - 19ms/step
Epoch 8/50
2159/2159 - 43s - loss: 3.1393 - accuracy50: 0.4431 - val_loss: 3.2990 - val_accuracy50: 0.4794 - 43s/epoch - 20ms/step
Epoch 9/50
2159/2159 - 42s - loss: 3.1324 - accuracy50: 0.4455 - val_loss: 3.3111 - val_accuracy50: 0.4798 - 42s/epoch - 19ms/step
Epoch 10/50
2159/2159 - 42s - loss: 3.1250 - accuracy50: 0.4488 - val_loss: 3.3380 - val_accuracy50: 0.4798 - 42s/epoch - 20ms/step
Epoch 11/50
2159/2159 - 43s - loss: 3.1181 - accuracy50: 0.4519 - val_loss: 3.3454 - val_accuracy50: 0.4805 - 43s/epoch - 20ms/step
Epoch 12/50
2159/2159 - 42s - loss: 3.1116 - accuracy50: 0.4542 - val_loss: 3.3373 - val_accuracy50: 0.4814 - 42s/epoch - 19ms/step
Epoch 13/50
2159/2159 - 42s - loss: 3.1064 - accuracy50: 0.4565 - val_loss: 3.3819 - val_accuracy50: 0.4807 - 42s/epoch - 19ms/step
Epoch 14/50
2159/2159 - 43s - loss: 3.0999 - accuracy50: 0.4579 - val_loss: 3.3899 - val_accuracy50: 0.4828 - 43s/epoch - 20ms/step
testing model: results/AAL/W3/deepOF_L1/h50
Evaluating performance on  test set...
5760/5760 - 64s - 64s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9771905
{'0': {'precision': 0.468384074941452, 'recall': 0.05384063173007897, 'f1-score': 0.09657947686116701, 'support': 323176}, '1': {'precision': 0.5721895177606925, 'recall': 0.9739965547561376, 'f1-score': 0.720884282781462, 'support': 834774}, '2': {'precision': 0.5264639295111057, 'recall': 0.027183374036781595, 'f1-score': 0.05169741032265817, 'support': 316517}, 'accuracy': 0.5690673307710515, 'macro avg': {'precision': 0.52234584073775, 'recall': 0.3516735201743327, 'f1-score': 0.28972038998842903, 'support': 1474467}, 'weighted avg': {'precision': 0.5396215770712465, 'recall': 0.5690673307710515, 'f1-score': 0.4403969261514794, 'support': 1474467}}
[[ 17400 304049   1727]
 [ 15695 813067   6012]
 [  4054 303859   8604]]
Evaluating performance on  train set...
2159/2159 - 23s - 23s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0588658
{'0': {'precision': 0.5354621848739496, 'recall': 0.08143911557018245, 'f1-score': 0.14137615442216492, 'support': 156485}, '1': {'precision': 0.44044265593561366, 'recall': 0.9542404211708785, 'f1-score': 0.6027006312768629, 'support': 238573}, '2': {'precision': 0.5473098330241187, 'recall': 0.04121158242316485, 'f1-score': 0.0766514308660785, 'support': 157480}, 'accuracy': 0.4468289963767198, 'macro avg': {'precision': 0.5077382246112273, 'recall': 0.3589637063880753, 'f1-score': 0.27357607218836877, 'support': 552538}, 'weighted avg': {'precision': 0.4978116948683446, 'recall': 0.4468289963767198, 'f1-score': 0.3221179585171654, 'support': 552538}}
[[ 12744 141927   1814]
 [  7363 227656   3554]
 [  3693 147297   6490]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0373726
{'0': {'precision': 0.49598375034622844, 'recall': 0.09217095894171543, 'f1-score': 0.15545330902566773, 'support': 58283}, '1': {'precision': 0.47435412226360973, 'recall': 0.9428299944572017, 'f1-score': 0.6311604669961968, 'support': 101032}, '2': {'precision': 0.5147316730971588, 'recall': 0.05057728760985697, 'f1-score': 0.09210443733132491, 'support': 58030}, 'accuracy': 0.47649129264533346, 'macro avg': {'precision': 0.49502318190233235, 'recall': 0.36185941366959135, 'f1-score': 0.2929060711177298, 'support': 217345}, 'weighted avg': {'precision': 0.4909348988557104, 'recall': 0.47649129264533346, 'f1-score': 0.3596701557884448, 'support': 217345}}
[[ 5372 52036   875]
 [ 3884 95256  1892]
 [ 1575 53520  2935]]
training model: results/AAL/W3/deepOF_L1/h100
Epoch 1/50
2159/2159 - 47s - loss: 3.2694 - accuracy100: 0.3908 - val_loss: 3.4387 - val_accuracy100: 0.3575 - 47s/epoch - 22ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.2554 - accuracy100: 0.3952 - val_loss: 3.3726 - val_accuracy100: 0.3591 - 44s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 46s - loss: 3.2474 - accuracy100: 0.3998 - val_loss: 3.3634 - val_accuracy100: 0.3604 - 46s/epoch - 22ms/step
Epoch 4/50
2159/2159 - 43s - loss: 3.2411 - accuracy100: 0.4033 - val_loss: 3.3693 - val_accuracy100: 0.3619 - 43s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 43s - loss: 3.2351 - accuracy100: 0.4070 - val_loss: 3.3775 - val_accuracy100: 0.3625 - 43s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 43s - loss: 3.2298 - accuracy100: 0.4106 - val_loss: 3.3891 - val_accuracy100: 0.3629 - 43s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 41s - loss: 3.2253 - accuracy100: 0.4131 - val_loss: 3.4004 - val_accuracy100: 0.3641 - 41s/epoch - 19ms/step
Epoch 8/50
2159/2159 - 43s - loss: 3.2210 - accuracy100: 0.4160 - val_loss: 3.4072 - val_accuracy100: 0.3647 - 43s/epoch - 20ms/step
Epoch 9/50
2159/2159 - 42s - loss: 3.2166 - accuracy100: 0.4178 - val_loss: 3.4140 - val_accuracy100: 0.3650 - 42s/epoch - 19ms/step
Epoch 10/50
2159/2159 - 42s - loss: 3.2132 - accuracy100: 0.4198 - val_loss: 3.4162 - val_accuracy100: 0.3657 - 42s/epoch - 19ms/step
Epoch 11/50
2159/2159 - 42s - loss: 3.2102 - accuracy100: 0.4209 - val_loss: 3.4189 - val_accuracy100: 0.3667 - 42s/epoch - 19ms/step
Epoch 12/50
2159/2159 - 42s - loss: 3.2072 - accuracy100: 0.4225 - val_loss: 3.4277 - val_accuracy100: 0.3675 - 42s/epoch - 19ms/step
Epoch 13/50
2159/2159 - 42s - loss: 3.2041 - accuracy100: 0.4242 - val_loss: 3.4229 - val_accuracy100: 0.3677 - 42s/epoch - 19ms/step
testing model: results/AAL/W3/deepOF_L1/h100
Evaluating performance on  test set...
5760/5760 - 63s - 63s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0743463
{'0': {'precision': 0.5007607625525822, 'recall': 0.013098228520192809, 'f1-score': 0.025528711244952432, 'support': 427157}, '1': {'precision': 0.43432861213899876, 'recall': 0.9917509817835486, 'f1-score': 0.6040978769224751, 'support': 638379}, '2': {'precision': 0.5422309337134711, 'recall': 0.007441353186723432, 'f1-score': 0.014681227279196608, 'support': 408931}, 'accuracy': 0.4352427012608624, 'macro avg': {'precision': 0.492440102801684, 'recall': 0.33743018783015494, 'f1-score': 0.2147692718155414, 'support': 1474467}, 'weighted avg': {'precision': 0.4834999820903002, 'recall': 0.4352427012608624, 'f1-score': 0.2730151134163477, 'support': 1474467}}
[[  5595 420652    910]
 [  3607 633113   1659]
 [  1971 403917   3043]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1379427
{'0': {'precision': 0.5493072534637327, 'recall': 0.018242050904524246, 'f1-score': 0.035311437447936585, 'support': 184738}, '1': {'precision': 0.33253176018455854, 'recall': 0.986660027686735, 'f1-score': 0.4974194028903791, 'support': 182759}, '2': {'precision': 0.5551257253384912, 'recall': 0.012408060916229376, 'f1-score': 0.024273563911046268, 'support': 185041}, 'accuracy': 0.3366049031921786, 'macro avg': {'precision': 0.4789882463289275, 'recall': 0.33910337983582955, 'f1-score': 0.18566813474978736, 'support': 552538}, 'weighted avg': {'precision': 0.4795545549669209, 'recall': 0.3366049031921786, 'f1-score': 0.18446304421372578, 'support': 552538}}
[[  3370 180514    854]
 [  1452 180321    986]
 [  1313 181432   2296]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1224105
{'0': {'precision': 0.48362956033676335, 'recall': 0.022127744567931176, 'f1-score': 0.042319236016371074, 'support': 70093}, '1': {'precision': 0.35700972504683215, 'recall': 0.9797726036621688, 'f1-score': 0.5233288027971738, 'support': 77222}, '2': {'precision': 0.5119855269109, 'recall': 0.01616450092817364, 'f1-score': 0.03133954402624548, 'support': 70030}, 'accuracy': 0.3604545768248637, 'macro avg': {'precision': 0.4508749374314986, 'recall': 0.33935494971942454, 'f1-score': 0.1989958609465968, 'support': 217345}, 'weighted avg': {'precision': 0.4477784085662037, 'recall': 0.3604545768248637, 'f1-score': 0.20968270394008057, 'support': 217345}}
[[ 1551 68064   478]
 [  961 75660   601]
 [  695 68203  1132]]
training model: results/AAL/W3/deepOF_L1/h200
Epoch 1/50
2159/2159 - 46s - loss: 3.2950 - accuracy200: 0.3647 - val_loss: 3.3668 - val_accuracy200: 0.3248 - 46s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 43s - loss: 3.2807 - accuracy200: 0.3715 - val_loss: 3.3308 - val_accuracy200: 0.3265 - 43s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 42s - loss: 3.2765 - accuracy200: 0.3731 - val_loss: 3.3172 - val_accuracy200: 0.3315 - 42s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 43s - loss: 3.2745 - accuracy200: 0.3753 - val_loss: 3.3071 - val_accuracy200: 0.3382 - 43s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 42s - loss: 3.2728 - accuracy200: 0.3763 - val_loss: 3.3027 - val_accuracy200: 0.3436 - 42s/epoch - 19ms/step
Epoch 6/50
2159/2159 - 42s - loss: 3.2714 - accuracy200: 0.3774 - val_loss: 3.3014 - val_accuracy200: 0.3464 - 42s/epoch - 19ms/step
Epoch 7/50
2159/2159 - 42s - loss: 3.2697 - accuracy200: 0.3785 - val_loss: 3.3036 - val_accuracy200: 0.3460 - 42s/epoch - 20ms/step
Epoch 8/50
2159/2159 - 42s - loss: 3.2685 - accuracy200: 0.3799 - val_loss: 3.3028 - val_accuracy200: 0.3499 - 42s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 44s - loss: 3.2672 - accuracy200: 0.3809 - val_loss: 3.3023 - val_accuracy200: 0.3519 - 44s/epoch - 20ms/step
Epoch 10/50
2159/2159 - 44s - loss: 3.2658 - accuracy200: 0.3821 - val_loss: 3.3017 - val_accuracy200: 0.3536 - 44s/epoch - 20ms/step
Epoch 11/50
2159/2159 - 43s - loss: 3.2647 - accuracy200: 0.3828 - val_loss: 3.3043 - val_accuracy200: 0.3504 - 43s/epoch - 20ms/step
Epoch 12/50
2159/2159 - 44s - loss: 3.2635 - accuracy200: 0.3839 - val_loss: 3.3025 - val_accuracy200: 0.3568 - 44s/epoch - 20ms/step
Epoch 13/50
2159/2159 - 43s - loss: 3.2626 - accuracy200: 0.3845 - val_loss: 3.3035 - val_accuracy200: 0.3565 - 43s/epoch - 20ms/step
Epoch 14/50
2159/2159 - 42s - loss: 3.2611 - accuracy200: 0.3855 - val_loss: 3.3048 - val_accuracy200: 0.3557 - 42s/epoch - 20ms/step
Epoch 15/50
2159/2159 - 44s - loss: 3.2601 - accuracy200: 0.3862 - val_loss: 3.3076 - val_accuracy200: 0.3540 - 44s/epoch - 20ms/step
Epoch 16/50
2159/2159 - 42s - loss: 3.2584 - accuracy200: 0.3873 - val_loss: 3.3096 - val_accuracy200: 0.3556 - 42s/epoch - 19ms/step
testing model: results/AAL/W3/deepOF_L1/h200
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935757
{'0': {'precision': 0.3801944709872417, 'recall': 0.18994339007984395, 'f1-score': 0.25332619227837, 'support': 488077}, '1': {'precision': 0.36011108062283087, 'recall': 0.7643661806164225, 'f1-score': 0.4895727833392976, 'support': 527106}, '2': {'precision': 0.38008390057156144, 'recall': 0.09252009649802737, 'f1-score': 0.1488154961713096, 'support': 459284}, 'accuracy': 0.3649467909420828, 'macro avg': {'precision': 0.3734631507272113, 'recall': 0.34894322239809794, 'f1-score': 0.2972381572629924, 'support': 1474467}, 'weighted avg': {'precision': 0.3729804344681345, 'recall': 0.3649467909420828, 'f1-score': 0.30522759466779353, 'support': 1474467}}
[[ 92707 365206  30164]
 [ 85062 402902  39142]
 [ 66072 350719  42493]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0969509
{'0': {'precision': 0.39084969792090163, 'recall': 0.22420787729555586, 'f1-score': 0.2849540746867945, 'support': 184378}, '1': {'precision': 0.33449922664363335, 'recall': 0.7223556714726471, 'f1-score': 0.457257498451141, 'support': 184423}, '2': {'precision': 0.3988496505658977, 'recall': 0.1052972455194109, 'f1-score': 0.1666092557827113, 'support': 183737}, 'accuracy': 0.3509351393026362, 'macro avg': {'precision': 0.374732858376811, 'recall': 0.350620264762538, 'f1-score': 0.30294027630688225, 'support': 552538}, 'weighted avg': {'precision': 0.3747016037351008, 'recall': 0.3509351393026362, 'f1-score': 0.30311100204728836, 'support': 552538}}
[[ 41339 130054  12985]
 [ 35029 133219  16175]
 [ 29399 134991  19347]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001911
{'0': {'precision': 0.3934582925350865, 'recall': 0.22807064960337303, 'f1-score': 0.28875980597640577, 'support': 73999}, '1': {'precision': 0.3283995217798108, 'recall': 0.7176305215181247, 'f1-score': 0.4505979949450148, 'support': 70429}, '2': {'precision': 0.40648269820411737, 'recall': 0.11454119066884266, 'f1-score': 0.17872121886501754, 'support': 72917}, 'accuracy': 0.34862085624237965, 'macro avg': {'precision': 0.3761135041730049, 'recall': 0.3534141205967802, 'f1-score': 0.30602633992881273, 'support': 217345}, 'weighted avg': {'precision': 0.37674604437039627, 'recall': 0.34862085624237965, 'f1-score': 0.30428543644625355, 'support': 217345}}
[[16877 51170  5952]
 [13644 50542  6243]
 [12373 52192  8352]]
training model: results/AAL/W3/deepOF_L1/h300
Epoch 1/50
2159/2159 - 47s - loss: 3.3024 - accuracy300: 0.3580 - val_loss: 3.3253 - val_accuracy300: 0.3466 - 47s/epoch - 22ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.2879 - accuracy300: 0.3624 - val_loss: 3.3143 - val_accuracy300: 0.3466 - 44s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 43s - loss: 3.2839 - accuracy300: 0.3652 - val_loss: 3.3054 - val_accuracy300: 0.3468 - 43s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 41s - loss: 3.2819 - accuracy300: 0.3673 - val_loss: 3.3002 - val_accuracy300: 0.3472 - 41s/epoch - 19ms/step
Epoch 5/50
2159/2159 - 42s - loss: 3.2806 - accuracy300: 0.3686 - val_loss: 3.2966 - val_accuracy300: 0.3474 - 42s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 42s - loss: 3.2793 - accuracy300: 0.3699 - val_loss: 3.2942 - val_accuracy300: 0.3486 - 42s/epoch - 19ms/step
Epoch 7/50
2159/2159 - 42s - loss: 3.2782 - accuracy300: 0.3713 - val_loss: 3.2939 - val_accuracy300: 0.3491 - 42s/epoch - 19ms/step
Epoch 8/50
2159/2159 - 42s - loss: 3.2773 - accuracy300: 0.3723 - val_loss: 3.2934 - val_accuracy300: 0.3493 - 42s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 43s - loss: 3.2764 - accuracy300: 0.3737 - val_loss: 3.2920 - val_accuracy300: 0.3495 - 43s/epoch - 20ms/step
Epoch 10/50
2159/2159 - 42s - loss: 3.2756 - accuracy300: 0.3743 - val_loss: 3.2923 - val_accuracy300: 0.3505 - 42s/epoch - 19ms/step
Epoch 11/50
2159/2159 - 42s - loss: 3.2746 - accuracy300: 0.3745 - val_loss: 3.2928 - val_accuracy300: 0.3514 - 42s/epoch - 19ms/step
Epoch 12/50
2159/2159 - 42s - loss: 3.2737 - accuracy300: 0.3759 - val_loss: 3.2921 - val_accuracy300: 0.3521 - 42s/epoch - 19ms/step
Epoch 13/50
2159/2159 - 42s - loss: 3.2728 - accuracy300: 0.3768 - val_loss: 3.2931 - val_accuracy300: 0.3529 - 42s/epoch - 19ms/step
Epoch 14/50
2159/2159 - 43s - loss: 3.2719 - accuracy300: 0.3769 - val_loss: 3.2931 - val_accuracy300: 0.3521 - 43s/epoch - 20ms/step
Epoch 15/50
2159/2159 - 42s - loss: 3.2712 - accuracy300: 0.3775 - val_loss: 3.2928 - val_accuracy300: 0.3521 - 42s/epoch - 19ms/step
Epoch 16/50
2159/2159 - 42s - loss: 3.2700 - accuracy300: 0.3784 - val_loss: 3.2927 - val_accuracy300: 0.3533 - 42s/epoch - 20ms/step
Epoch 17/50
2159/2159 - 43s - loss: 3.2692 - accuracy300: 0.3799 - val_loss: 3.2929 - val_accuracy300: 0.3537 - 43s/epoch - 20ms/step
Epoch 18/50
2159/2159 - 42s - loss: 3.2684 - accuracy300: 0.3799 - val_loss: 3.2945 - val_accuracy300: 0.3546 - 42s/epoch - 19ms/step
Epoch 19/50
2159/2159 - 43s - loss: 3.2672 - accuracy300: 0.3815 - val_loss: 3.2927 - val_accuracy300: 0.3544 - 43s/epoch - 20ms/step
testing model: results/AAL/W3/deepOF_L1/h300
Evaluating performance on  test set...
5760/5760 - 64s - 64s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0899211
{'0': {'precision': 0.3406771538114569, 'recall': 0.05118956596144845, 'f1-score': 0.08900534164624344, 'support': 472147}, '1': {'precision': 0.38036034499928, 'recall': 0.9425857113182792, 'f1-score': 0.542005812914798, 'support': 563257}, '2': {'precision': 0.3452040551078763, 'recall': 0.006049245780218328, 'f1-score': 0.011890132667199394, 'support': 439063}, 'accuracy': 0.37826753667596497, 'macro avg': {'precision': 0.3554138513062044, 'recall': 0.333274841019982, 'f1-score': 0.21430042907608027, 'support': 1474467}, 'weighted avg': {'precision': 0.35718442734337685, 'recall': 0.37826753667596497, 'f1-score': 0.23909161108824942, 'support': 1474467}}
[[ 24169 446019   1959]
 [ 29260 530918   3079]
 [ 17515 418892   2656]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004095
{'0': {'precision': 0.39312152282863577, 'recall': 0.09243293206990308, 'f1-score': 0.14967373751077695, 'support': 184999}, '1': {'precision': 0.32983979667260893, 'recall': 0.9168937479397868, 'f1-score': 0.4851526594399435, 'support': 182020}, '2': {'precision': 0.40876389797253104, 'recall': 0.006737854343759939, 'f1-score': 0.013257184068046475, 'support': 185519}, 'accuracy': 0.33525838946823566, 'macro avg': {'precision': 0.37724173915792525, 'recall': 0.3386881781178166, 'f1-score': 0.21602786033958896, 'support': 552538}, 'weighted avg': {'precision': 0.3775269718645397, 'recall': 0.33525838946823566, 'f1-score': 0.21438604832271205, 'support': 552538}}
[[ 17100 167099    800]
 [ 14119 166893   1008]
 [ 12279 171990   1250]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979153
{'0': {'precision': 0.37709865027982004, 'recall': 0.09568825093627745, 'f1-score': 0.15264344330560894, 'support': 71827}, '1': {'precision': 0.34701464228814205, 'recall': 0.9101280095509717, 'f1-score': 0.5024533138044672, 'support': 75385}, '2': {'precision': 0.37393162393162394, 'recall': 0.007485777023655055, 'f1-score': 0.014677719222220668, 'support': 70133}, 'accuracy': 0.34971128850445143, 'macro avg': {'precision': 0.3660149721665287, 'recall': 0.3377673458369681, 'f1-score': 0.2232581587774323, 'support': 217345}, 'weighted avg': {'precision': 0.36564222845585037, 'recall': 0.34971128850445143, 'f1-score': 0.2294543520470852, 'support': 217345}}
[[ 6873 64582   372]
 [ 6268 68610   507]
 [ 5085 64523   525]]
training model: results/AAL/W3/deepOF_L1/h500
Epoch 1/50
2159/2159 - 46s - loss: 3.2776 - accuracy500: 0.3802 - val_loss: 3.3012 - val_accuracy500: 0.3298 - 46s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 44s - loss: 3.2680 - accuracy500: 0.3824 - val_loss: 3.2991 - val_accuracy500: 0.3234 - 44s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 43s - loss: 3.2726 - accuracy500: 0.3804 - val_loss: 3.2909 - val_accuracy500: 0.3643 - 43s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 42s - loss: 3.2752 - accuracy500: 0.3799 - val_loss: 3.2857 - val_accuracy500: 0.3727 - 42s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 42s - loss: 3.2740 - accuracy500: 0.3812 - val_loss: 3.2878 - val_accuracy500: 0.3697 - 42s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 43s - loss: 3.2734 - accuracy500: 0.3815 - val_loss: 3.2858 - val_accuracy500: 0.3724 - 43s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 41s - loss: 3.2721 - accuracy500: 0.3824 - val_loss: 3.2867 - val_accuracy500: 0.3720 - 41s/epoch - 19ms/step
Epoch 8/50
2159/2159 - 41s - loss: 3.2708 - accuracy500: 0.3832 - val_loss: 3.2874 - val_accuracy500: 0.3717 - 41s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 42s - loss: 3.2687 - accuracy500: 0.3850 - val_loss: 3.2908 - val_accuracy500: 0.3667 - 42s/epoch - 20ms/step
Epoch 10/50
2159/2159 - 43s - loss: 3.2664 - accuracy500: 0.3870 - val_loss: 3.2951 - val_accuracy500: 0.3590 - 43s/epoch - 20ms/step
Epoch 11/50
2159/2159 - 43s - loss: 3.2658 - accuracy500: 0.3877 - val_loss: 3.2951 - val_accuracy500: 0.3568 - 43s/epoch - 20ms/step
Epoch 12/50
2159/2159 - 43s - loss: 3.2651 - accuracy500: 0.3884 - val_loss: 3.2956 - val_accuracy500: 0.3537 - 43s/epoch - 20ms/step
Epoch 13/50
2159/2159 - 44s - loss: 3.2639 - accuracy500: 0.3889 - val_loss: 3.2971 - val_accuracy500: 0.3511 - 44s/epoch - 20ms/step
Epoch 14/50
2159/2159 - 44s - loss: 3.2629 - accuracy500: 0.3889 - val_loss: 3.2974 - val_accuracy500: 0.3494 - 44s/epoch - 20ms/step
testing model: results/AAL/W3/deepOF_L1/h500
Evaluating performance on  test set...
5760/5760 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954762
{'0': {'precision': 0.3750794240121926, 'recall': 0.6597771883693166, 'f1-score': 0.4782669305662523, 'support': 525197}, '1': {'precision': 0.3823884197828709, 'recall': 0.012915967936318681, 'f1-score': 0.02498791676779243, 'support': 466322}, '2': {'precision': 0.3523576448417113, 'recall': 0.3902449124957552, 'f1-score': 0.3703347825019036, 'support': 482948}, 'accuracy': 0.36691495977868616, 'macro avg': {'precision': 0.3699418295455916, 'recall': 0.3543126896004635, 'f1-score': 0.2911965432786494, 'support': 1474467}, 'weighted avg': {'precision': 0.3699486938696724, 'recall': 0.36691495977868616, 'f1-score': 0.299558562514674, 'support': 1474467}}
[[346513   4531 174153]
 [288043   6023 172256]
 [289283   5197 188468]]
Evaluating performance on  train set...
2159/2159 - 63s - 63s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0970075
{'0': {'precision': 0.35474327520972815, 'recall': 0.6110270515633275, 'f1-score': 0.44888050813815006, 'support': 185054}, '1': {'precision': 0.3596666275384435, 'recall': 0.016796219754196314, 'f1-score': 0.03209368338910972, 'support': 182422}, '2': {'precision': 0.3594349966485109, 'recall': 0.4375344479147529, 'f1-score': 0.3946580233224073, 'support': 185062}, 'accuracy': 0.3567320256706326, 'macro avg': {'precision': 0.35794829979889414, 'recall': 0.35511923974409226, 'f1-score': 0.29187740494988906, 'support': 552538}, 'weighted avg': {'precision': 0.3579401361159697, 'recall': 0.3567320256706326, 'f1-score': 0.29311636589030393, 'support': 552538}}
[[113073   2588  69393]
 [104449   3064  74909]
 [101224   2867  80971]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955029
{'0': {'precision': 0.37630426643660575, 'recall': 0.5952748809063989, 'f1-score': 0.46111421390673, 'support': 77670}, '1': {'precision': 0.3232919866115377, 'recall': 0.025323093056969247, 'f1-score': 0.04696729165772801, 'support': 64842}, '2': {'precision': 0.36747203579418347, 'recall': 0.43900418264669333, 'f1-score': 0.4000657602308915, 'support': 74833}, 'accuracy': 0.3714325151257218, 'macro avg': {'precision': 0.35568942961410893, 'recall': 0.3532007188700205, 'f1-score': 0.3027157552651165, 'support': 217345}, 'weighted avg': {'precision': 0.35744777300873093, 'recall': 0.3714325151257218, 'f1-score': 0.3165396726640338, 'support': 217345}}
[[46235  1633 29802]
 [36454  1642 26746]
 [40177  1804 32852]]
training model: results/AAL/W3/deepOF_L1/h1000
Epoch 1/50
2159/2159 - 45s - loss: 3.2774 - accuracy1000: 0.3842 - val_loss: 3.2489 - val_accuracy1000: 0.3825 - 45s/epoch - 21ms/step
Epoch 2/50
2159/2159 - 42s - loss: 3.2677 - accuracy1000: 0.3831 - val_loss: 3.2463 - val_accuracy1000: 0.3869 - 42s/epoch - 20ms/step
Epoch 3/50
2159/2159 - 43s - loss: 3.2658 - accuracy1000: 0.3828 - val_loss: 3.2465 - val_accuracy1000: 0.3889 - 43s/epoch - 20ms/step
Epoch 4/50
2159/2159 - 42s - loss: 3.2635 - accuracy1000: 0.3844 - val_loss: 3.2466 - val_accuracy1000: 0.3884 - 42s/epoch - 20ms/step
Epoch 5/50
2159/2159 - 43s - loss: 3.2610 - accuracy1000: 0.3862 - val_loss: 3.2480 - val_accuracy1000: 0.3877 - 43s/epoch - 20ms/step
Epoch 6/50
2159/2159 - 43s - loss: 3.2589 - accuracy1000: 0.3887 - val_loss: 3.2489 - val_accuracy1000: 0.3889 - 43s/epoch - 20ms/step
Epoch 7/50
2159/2159 - 42s - loss: 3.2577 - accuracy1000: 0.3893 - val_loss: 3.2496 - val_accuracy1000: 0.3881 - 42s/epoch - 19ms/step
Epoch 8/50
2159/2159 - 42s - loss: 3.2566 - accuracy1000: 0.3904 - val_loss: 3.2495 - val_accuracy1000: 0.3889 - 42s/epoch - 19ms/step
Epoch 9/50
2159/2159 - 42s - loss: 3.2561 - accuracy1000: 0.3918 - val_loss: 3.2518 - val_accuracy1000: 0.3886 - 42s/epoch - 19ms/step
Epoch 10/50
2159/2159 - 41s - loss: 3.2554 - accuracy1000: 0.3918 - val_loss: 3.2516 - val_accuracy1000: 0.3891 - 41s/epoch - 19ms/step
Epoch 11/50
2159/2159 - 41s - loss: 3.2543 - accuracy1000: 0.3928 - val_loss: 3.2566 - val_accuracy1000: 0.3892 - 41s/epoch - 19ms/step
Epoch 12/50
2159/2159 - 42s - loss: 3.2537 - accuracy1000: 0.3937 - val_loss: 3.2539 - val_accuracy1000: 0.3891 - 42s/epoch - 19ms/step
testing model: results/AAL/W3/deepOF_L1/h1000
Evaluating performance on  test set...
5760/5760 - 67s - 67s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0755409
{'0': {'precision': 0.4062671509880278, 'recall': 0.7898378631455025, 'f1-score': 0.5365501768003996, 'support': 589502}, '1': {'precision': 0.30708661417322836, 'recall': 0.0005614952474466364, 'f1-score': 0.0011209409005466743, 'support': 347287}, '2': {'precision': 0.3743062780501646, 'recall': 0.22817187982398388, 'f1-score': 0.28351622702466606, 'support': 537678}, 'accuracy': 0.39911981753406484, 'macro avg': {'precision': 0.36255334773714026, 'recall': 0.339523746072311, 'f1-score': 0.27372911490853746, 'support': 1474467}, 'weighted avg': {'precision': 0.3712519425579404, 'recall': 0.39911981753406484, 'f1-score': 0.3181672620959884, 'support': 1474467}}
[[465611    211 123680]
 [265694    195  81398]
 [414766    229 122683]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1124941
{'0': {'precision': 0.34015903226534466, 'recall': 0.7333398206263482, 'f1-score': 0.4647460275042654, 'support': 184977}, '1': {'precision': 0.3420074349442379, 'recall': 0.0005027157579532911, 'f1-score': 0.0010039558041194925, 'support': 183006}, '2': {'precision': 0.3508945674411332, 'recall': 0.29181544796944, 'f1-score': 0.31863967553847655, 'support': 184555}, 'accuracy': 0.34314201014228884, 'macro avg': {'precision': 0.34435367821690527, 'recall': 0.3418859947845805, 'f1-score': 0.2614632196156205, 'support': 552538}, 'weighted avg': {'precision': 0.34435705208483436, 'recall': 0.34314201014228884, 'f1-score': 0.26234865508715915, 'support': 552538}}
[[135651     97  49229]
 [132517     92  50397]
 [130619     80  53856]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0822449
{'0': {'precision': 0.39437836269648696, 'recall': 0.7099971511324249, 'f1-score': 0.5070875086898282, 'support': 84244}, '1': {'precision': 0.3230769230769231, 'recall': 0.00114852423750752, 'f1-score': 0.002288911495422177, 'support': 54853}, '2': {'precision': 0.37331643404697185, 'recall': 0.3124297106635313, 'f1-score': 0.3401700363170857, 'support': 78248}, 'accuracy': 0.38796843727714003, 'macro avg': {'precision': 0.3635905732734606, 'recall': 0.3411917953444879, 'f1-score': 0.28318215216744536, 'support': 217345}, 'weighted avg': {'precision': 0.3688008170413341, 'recall': 0.38796843727714003, 'f1-score': 0.3195944638526932, 'support': 217345}}
[[59813    72 24359]
 [38110    63 16680]
 [53741    60 24447]]
training model: results/AAL/W3/deepLOB_L2/h10
Epoch 1/50
2159/2159 - 102s - loss: 2.8817 - accuracy10: 0.4086 - val_loss: 2.6676 - val_accuracy10: 0.5851 - 102s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 115s - loss: 2.6079 - accuracy10: 0.5106 - val_loss: 2.5284 - val_accuracy10: 0.6647 - 115s/epoch - 53ms/step
Epoch 3/50
2159/2159 - 100s - loss: 2.4455 - accuracy10: 0.5796 - val_loss: 2.3729 - val_accuracy10: 0.6504 - 100s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 99s - loss: 2.3578 - accuracy10: 0.6034 - val_loss: 2.3708 - val_accuracy10: 0.6605 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 98s - loss: 2.3155 - accuracy10: 0.6131 - val_loss: 2.3673 - val_accuracy10: 0.6766 - 98s/epoch - 45ms/step
Epoch 6/50
2159/2159 - 98s - loss: 2.2871 - accuracy10: 0.6184 - val_loss: 2.2773 - val_accuracy10: 0.6644 - 98s/epoch - 46ms/step
Epoch 7/50
2159/2159 - 98s - loss: 2.2643 - accuracy10: 0.6207 - val_loss: 2.2618 - val_accuracy10: 0.6713 - 98s/epoch - 46ms/step
Epoch 8/50
2159/2159 - 98s - loss: 2.2448 - accuracy10: 0.6236 - val_loss: 2.2393 - val_accuracy10: 0.6794 - 98s/epoch - 46ms/step
Epoch 9/50
2159/2159 - 98s - loss: 2.2300 - accuracy10: 0.6251 - val_loss: 2.2543 - val_accuracy10: 0.6813 - 98s/epoch - 46ms/step
Epoch 10/50
2159/2159 - 98s - loss: 2.2187 - accuracy10: 0.6271 - val_loss: 2.2347 - val_accuracy10: 0.6853 - 98s/epoch - 46ms/step
Epoch 11/50
2159/2159 - 98s - loss: 2.2090 - accuracy10: 0.6282 - val_loss: 2.2351 - val_accuracy10: 0.6787 - 98s/epoch - 45ms/step
Epoch 12/50
2159/2159 - 99s - loss: 2.1979 - accuracy10: 0.6293 - val_loss: 2.2423 - val_accuracy10: 0.6791 - 99s/epoch - 46ms/step
Epoch 13/50
2159/2159 - 98s - loss: 2.1895 - accuracy10: 0.6297 - val_loss: 2.2755 - val_accuracy10: 0.6947 - 98s/epoch - 45ms/step
Epoch 14/50
2159/2159 - 98s - loss: 2.1830 - accuracy10: 0.6303 - val_loss: 2.2528 - val_accuracy10: 0.6835 - 98s/epoch - 45ms/step
Epoch 15/50
2159/2159 - 98s - loss: 2.1743 - accuracy10: 0.6318 - val_loss: 2.2577 - val_accuracy10: 0.6889 - 98s/epoch - 46ms/step
Epoch 16/50
2159/2159 - 100s - loss: 2.1673 - accuracy10: 0.6324 - val_loss: 2.2497 - val_accuracy10: 0.6890 - 100s/epoch - 46ms/step
Epoch 17/50
2159/2159 - 100s - loss: 2.1625 - accuracy10: 0.6331 - val_loss: 2.2539 - val_accuracy10: 0.6886 - 100s/epoch - 46ms/step
Epoch 18/50
2159/2159 - 99s - loss: 2.1563 - accuracy10: 0.6337 - val_loss: 2.2769 - val_accuracy10: 0.6917 - 99s/epoch - 46ms/step
Epoch 19/50
2159/2159 - 99s - loss: 2.1511 - accuracy10: 0.6344 - val_loss: 2.2691 - val_accuracy10: 0.6874 - 99s/epoch - 46ms/step
Epoch 20/50
2159/2159 - 98s - loss: 2.1459 - accuracy10: 0.6349 - val_loss: 2.2355 - val_accuracy10: 0.6692 - 98s/epoch - 45ms/step
testing model: results/AAL/W3/deepLOB_L2/h10
Evaluating performance on  test set...
5760/5760 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5835896
{'0': {'precision': 0.38092779886265554, 'recall': 0.6042475974608748, 'f1-score': 0.46727660501426055, 'support': 152651}, '1': {'precision': 0.8978087821073973, 'recall': 0.8480383462248008, 'f1-score': 0.8722141388539556, 'support': 1167051}, '2': {'precision': 0.4575488755356882, 'recall': 0.38424361467735785, 'f1-score': 0.4177044482373517, 'support': 154769}, 'accuracy': 0.7741162762780686, 'macro avg': {'precision': 0.578761818835247, 'recall': 0.6121765194543445, 'f1-score': 0.585731730701856, 'support': 1474471}, 'weighted avg': {'precision': 0.7980842134631242, 'recall': 0.7741162762780686, 'f1-score': 0.7825832612136328, 'support': 1474471}}
[[ 92239  43100  17312]
 [124155 989704  53192]
 [ 25749  69551  59469]]
Evaluating performance on  train set...
2159/2159 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7484821
{'0': {'precision': 0.3723139545419696, 'recall': 0.6557934539740221, 'f1-score': 0.47497187976543503, 'support': 81454}, '1': {'precision': 0.8685599745971263, 'recall': 0.675516110360795, 'f1-score': 0.7599706534809921, 'support': 388725}, '2': {'precision': 0.4280387490865484, 'recall': 0.5547353084021369, 'f1-score': 0.48322034077568243, 'support': 82360}, 'accuracy': 0.6546053762720822, 'macro avg': {'precision': 0.5563042260752148, 'recall': 0.6286816242456513, 'f1-score': 0.5727209580073699, 'support': 552539}, 'weighted avg': {'precision': 0.7297416261174281, 'recall': 0.6546053762720822, 'f1-score': 0.6767051358095946, 'support': 552539}}
[[ 53417  16617  11420]
 [ 76505 262590  49630]
 [ 13551  23121  45688]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6964944
{'0': {'precision': 0.3948932001618502, 'recall': 0.620540793788903, 'f1-score': 0.4826455315660016, 'support': 29882}, '1': {'precision': 0.8824170738785658, 'recall': 0.713505628666561, 'f1-score': 0.7890226112326768, 'support': 157675}, '2': {'precision': 0.41459377549830984, 'recall': 0.5970189337988452, 'f1-score': 0.4893578966195672, 'support': 29788}, 'accuracy': 0.6847592537210426, 'macro avg': {'precision': 0.5639680165129086, 'recall': 0.6436884520847698, 'f1-score': 0.587008679806082, 'support': 217345}, 'weighted avg': {'precision': 0.7512720794846117, 'recall': 0.6847592537210426, 'f1-score': 0.7058296580315685, 'support': 217345}}
[[ 18543   7004   4335]
 [ 24397 112502  20776]
 [  4017   7987  17784]]
training model: results/AAL/W3/deepLOB_L2/h20
Epoch 1/50
2159/2159 - 101s - loss: 2.9603 - accuracy20: 0.4420 - val_loss: 2.9017 - val_accuracy20: 0.4333 - 101s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 98s - loss: 2.7677 - accuracy20: 0.4964 - val_loss: 2.6768 - val_accuracy20: 0.5419 - 98s/epoch - 45ms/step
Epoch 3/50
2159/2159 - 98s - loss: 2.6043 - accuracy20: 0.5633 - val_loss: 2.5156 - val_accuracy20: 0.6354 - 98s/epoch - 45ms/step
Epoch 4/50
2159/2159 - 98s - loss: 2.5161 - accuracy20: 0.5892 - val_loss: 2.4471 - val_accuracy20: 0.6460 - 98s/epoch - 45ms/step
Epoch 5/50
2159/2159 - 98s - loss: 2.4685 - accuracy20: 0.5981 - val_loss: 2.4611 - val_accuracy20: 0.6479 - 98s/epoch - 45ms/step
Epoch 6/50
2159/2159 - 98s - loss: 2.4403 - accuracy20: 0.6030 - val_loss: 2.4387 - val_accuracy20: 0.6548 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 98s - loss: 2.4199 - accuracy20: 0.6065 - val_loss: 2.4220 - val_accuracy20: 0.6519 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 98s - loss: 2.4025 - accuracy20: 0.6091 - val_loss: 2.3982 - val_accuracy20: 0.6471 - 98s/epoch - 45ms/step
Epoch 9/50
2159/2159 - 98s - loss: 2.3893 - accuracy20: 0.6115 - val_loss: 2.4158 - val_accuracy20: 0.6477 - 98s/epoch - 45ms/step
Epoch 10/50
2159/2159 - 98s - loss: 2.3786 - accuracy20: 0.6131 - val_loss: 2.4080 - val_accuracy20: 0.6462 - 98s/epoch - 45ms/step
Epoch 11/50
2159/2159 - 97s - loss: 2.3692 - accuracy20: 0.6143 - val_loss: 2.4039 - val_accuracy20: 0.6417 - 97s/epoch - 45ms/step
Epoch 12/50
2159/2159 - 98s - loss: 2.3601 - accuracy20: 0.6160 - val_loss: 2.4011 - val_accuracy20: 0.6404 - 98s/epoch - 45ms/step
Epoch 13/50
2159/2159 - 98s - loss: 2.3538 - accuracy20: 0.6170 - val_loss: 2.4062 - val_accuracy20: 0.6439 - 98s/epoch - 45ms/step
Epoch 14/50
2159/2159 - 98s - loss: 2.3463 - accuracy20: 0.6183 - val_loss: 2.4003 - val_accuracy20: 0.6362 - 98s/epoch - 45ms/step
Epoch 15/50
2159/2159 - 98s - loss: 2.3401 - accuracy20: 0.6194 - val_loss: 2.3956 - val_accuracy20: 0.6388 - 98s/epoch - 45ms/step
Epoch 16/50
2159/2159 - 98s - loss: 2.3351 - accuracy20: 0.6197 - val_loss: 2.3951 - val_accuracy20: 0.6352 - 98s/epoch - 45ms/step
Epoch 17/50
2159/2159 - 98s - loss: 2.3289 - accuracy20: 0.6205 - val_loss: 2.3888 - val_accuracy20: 0.6408 - 98s/epoch - 45ms/step
Epoch 18/50
2159/2159 - 97s - loss: 2.3250 - accuracy20: 0.6211 - val_loss: 2.3788 - val_accuracy20: 0.6433 - 97s/epoch - 45ms/step
Epoch 19/50
2159/2159 - 98s - loss: 2.3197 - accuracy20: 0.6218 - val_loss: 2.4120 - val_accuracy20: 0.6366 - 98s/epoch - 45ms/step
Epoch 20/50
2159/2159 - 98s - loss: 2.3143 - accuracy20: 0.6227 - val_loss: 2.4228 - val_accuracy20: 0.6312 - 98s/epoch - 45ms/step
Epoch 21/50
2159/2159 - 98s - loss: 2.3093 - accuracy20: 0.6229 - val_loss: 2.4055 - val_accuracy20: 0.6290 - 98s/epoch - 45ms/step
Epoch 22/50
2159/2159 - 98s - loss: 2.3051 - accuracy20: 0.6233 - val_loss: 2.4253 - val_accuracy20: 0.6331 - 98s/epoch - 45ms/step
Epoch 23/50
2159/2159 - 99s - loss: 2.2998 - accuracy20: 0.6243 - val_loss: 2.4161 - val_accuracy20: 0.6345 - 99s/epoch - 46ms/step
Epoch 24/50
2159/2159 - 98s - loss: 2.2964 - accuracy20: 0.6251 - val_loss: 2.4127 - val_accuracy20: 0.6338 - 98s/epoch - 45ms/step
Epoch 25/50
2159/2159 - 98s - loss: 2.2915 - accuracy20: 0.6256 - val_loss: 2.4294 - val_accuracy20: 0.6242 - 98s/epoch - 45ms/step
Epoch 26/50
2159/2159 - 98s - loss: 2.2867 - accuracy20: 0.6257 - val_loss: 2.4349 - val_accuracy20: 0.6250 - 98s/epoch - 46ms/step
Epoch 27/50
2159/2159 - 98s - loss: 2.2812 - accuracy20: 0.6263 - val_loss: 2.4486 - val_accuracy20: 0.6280 - 98s/epoch - 46ms/step
Epoch 28/50
2159/2159 - 98s - loss: 2.2788 - accuracy20: 0.6267 - val_loss: 2.4372 - val_accuracy20: 0.6307 - 98s/epoch - 45ms/step
testing model: results/AAL/W3/deepLOB_L2/h20
Evaluating performance on  test set...
5760/5760 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7086012
{'0': {'precision': 0.3788095280620598, 'recall': 0.6064787014002078, 'f1-score': 0.46634051597771914, 'support': 209826}, '1': {'precision': 0.8455040185763711, 'recall': 0.7914045675068039, 'f1-score': 0.8175603058541199, 'support': 1056375}, '2': {'precision': 0.49448428756493984, 'recall': 0.3555528880779757, 'f1-score': 0.413665005697942, 'support': 208270}, 'accuracy': 0.7035241791801942, 'macro avg': {'precision': 0.5729326114011236, 'recall': 0.5844787189949957, 'f1-score': 0.5658552758432603, 'support': 1474471}, 'weighted avg': {'precision': 0.7295088463794227, 'recall': 0.7035241791801942, 'f1-score': 0.7105291619427558, 'support': 1474471}}
[[127255  66089  16482]
 [161134 836020  59221]
 [ 47545  86674  74051]]
Evaluating performance on  train set...
2159/2159 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8157762
{'0': {'precision': 0.40733302378141906, 'recall': 0.6690311673037342, 'f1-score': 0.5063685519063928, 'support': 108832}, '1': {'precision': 0.795017495588719, 'recall': 0.637239420244691, 'f1-score': 0.7074380055320572, 'support': 333727}, '2': {'precision': 0.4997930190986923, 'recall': 0.48302418621567556, 'f1-score': 0.4912655476950109, 'support': 109980}, 'accuracy': 0.6128056119115574, 'macro avg': {'precision': 0.5673811794896101, 'recall': 0.5964315912547002, 'f1-score': 0.5683573683778204, 'support': 552539}, 'weighted avg': {'precision': 0.6598935235974113, 'recall': 0.6128056119115574, 'f1-score': 0.6248059421122684, 'support': 552539}}
[[ 72812  23302  12718]
 [ 80614 212664  40449]
 [ 25327  31530  53123]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7720482
{'0': {'precision': 0.4291805742446219, 'recall': 0.6161932958651144, 'f1-score': 0.5059590642672462, 'support': 39856}, '1': {'precision': 0.8140049482524305, 'recall': 0.6789072149967303, 'f1-score': 0.7403433986482739, 'support': 137630}, '2': {'precision': 0.47935324480522346, 'recall': 0.5451968187862214, 'f1-score': 0.510159285387297, 'support': 39859}, 'accuracy': 0.6428857346614829, 'macro avg': {'precision': 0.5741795891007587, 'recall': 0.6134324432160221, 'f1-score': 0.5854872494342724, 'support': 217345}, 'weighted avg': {'precision': 0.6820652095965726, 'recall': 0.6428857346614829, 'f1-score': 0.6551492115192417, 'support': 217345}}
[[24559 10403  4894]
 [25483 93438 18709]
 [ 7181 10947 21731]]
training model: results/AAL/W3/deepLOB_L2/h30
Epoch 1/50
2159/2159 - 103s - loss: 2.9980 - accuracy30: 0.4578 - val_loss: 2.9850 - val_accuracy30: 0.4918 - 103s/epoch - 48ms/step
Epoch 2/50
2159/2159 - 99s - loss: 2.8248 - accuracy30: 0.5057 - val_loss: 2.8439 - val_accuracy30: 0.4412 - 99s/epoch - 46ms/step
Epoch 3/50
2159/2159 - 98s - loss: 2.7206 - accuracy30: 0.5446 - val_loss: 2.7527 - val_accuracy30: 0.5806 - 98s/epoch - 45ms/step
Epoch 4/50
2159/2159 - 98s - loss: 2.6339 - accuracy30: 0.5693 - val_loss: 2.7469 - val_accuracy30: 0.6041 - 98s/epoch - 45ms/step
Epoch 5/50
2159/2159 - 98s - loss: 2.5911 - accuracy30: 0.5787 - val_loss: 2.6803 - val_accuracy30: 0.5960 - 98s/epoch - 45ms/step
Epoch 6/50
2159/2159 - 98s - loss: 2.5640 - accuracy30: 0.5837 - val_loss: 2.6846 - val_accuracy30: 0.6063 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 98s - loss: 2.5456 - accuracy30: 0.5871 - val_loss: 2.7127 - val_accuracy30: 0.6023 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 98s - loss: 2.5290 - accuracy30: 0.5899 - val_loss: 2.6854 - val_accuracy30: 0.6103 - 98s/epoch - 45ms/step
Epoch 9/50
2159/2159 - 99s - loss: 2.5173 - accuracy30: 0.5922 - val_loss: 2.6940 - val_accuracy30: 0.6007 - 99s/epoch - 46ms/step
Epoch 10/50
2159/2159 - 98s - loss: 2.5070 - accuracy30: 0.5941 - val_loss: 2.6633 - val_accuracy30: 0.6081 - 98s/epoch - 45ms/step
Epoch 11/50
2159/2159 - 99s - loss: 2.4976 - accuracy30: 0.5960 - val_loss: 2.6620 - val_accuracy30: 0.6086 - 99s/epoch - 46ms/step
Epoch 12/50
2159/2159 - 99s - loss: 2.4904 - accuracy30: 0.5970 - val_loss: 2.6596 - val_accuracy30: 0.6112 - 99s/epoch - 46ms/step
Epoch 13/50
2159/2159 - 99s - loss: 2.4853 - accuracy30: 0.5986 - val_loss: 2.6657 - val_accuracy30: 0.6024 - 99s/epoch - 46ms/step
Epoch 14/50
2159/2159 - 98s - loss: 2.4784 - accuracy30: 0.6000 - val_loss: 2.6625 - val_accuracy30: 0.5954 - 98s/epoch - 45ms/step
Epoch 15/50
2159/2159 - 98s - loss: 2.4710 - accuracy30: 0.6011 - val_loss: 2.6591 - val_accuracy30: 0.5969 - 98s/epoch - 45ms/step
Epoch 16/50
2159/2159 - 98s - loss: 2.4663 - accuracy30: 0.6015 - val_loss: 2.6714 - val_accuracy30: 0.6002 - 98s/epoch - 45ms/step
Epoch 17/50
2159/2159 - 98s - loss: 2.4614 - accuracy30: 0.6024 - val_loss: 2.6681 - val_accuracy30: 0.5971 - 98s/epoch - 45ms/step
Epoch 18/50
2159/2159 - 98s - loss: 2.4563 - accuracy30: 0.6036 - val_loss: 2.6582 - val_accuracy30: 0.5944 - 98s/epoch - 45ms/step
Epoch 19/50
2159/2159 - 98s - loss: 2.4514 - accuracy30: 0.6038 - val_loss: 2.6735 - val_accuracy30: 0.6023 - 98s/epoch - 45ms/step
Epoch 20/50
2159/2159 - 98s - loss: 2.4467 - accuracy30: 0.6047 - val_loss: 2.6477 - val_accuracy30: 0.6039 - 98s/epoch - 45ms/step
Epoch 21/50
2159/2159 - 98s - loss: 2.4416 - accuracy30: 0.6054 - val_loss: 2.6772 - val_accuracy30: 0.5984 - 98s/epoch - 45ms/step
Epoch 22/50
2159/2159 - 98s - loss: 2.4371 - accuracy30: 0.6061 - val_loss: 2.6799 - val_accuracy30: 0.6005 - 98s/epoch - 45ms/step
Epoch 23/50
2159/2159 - 98s - loss: 2.4321 - accuracy30: 0.6067 - val_loss: 2.6826 - val_accuracy30: 0.5907 - 98s/epoch - 45ms/step
Epoch 24/50
2159/2159 - 98s - loss: 2.4285 - accuracy30: 0.6078 - val_loss: 2.6818 - val_accuracy30: 0.5855 - 98s/epoch - 45ms/step
Epoch 25/50
2159/2159 - 98s - loss: 2.4231 - accuracy30: 0.6086 - val_loss: 2.7100 - val_accuracy30: 0.5921 - 98s/epoch - 45ms/step
Epoch 26/50
2159/2159 - 98s - loss: 2.4181 - accuracy30: 0.6091 - val_loss: 2.6813 - val_accuracy30: 0.5908 - 98s/epoch - 45ms/step
Epoch 27/50
2159/2159 - 98s - loss: 2.4153 - accuracy30: 0.6099 - val_loss: 2.7019 - val_accuracy30: 0.5894 - 98s/epoch - 45ms/step
Epoch 28/50
2159/2159 - 100s - loss: 2.4101 - accuracy30: 0.6102 - val_loss: 2.7178 - val_accuracy30: 0.5897 - 100s/epoch - 46ms/step
Epoch 29/50
2159/2159 - 99s - loss: 2.4054 - accuracy30: 0.6115 - val_loss: 2.7107 - val_accuracy30: 0.5845 - 99s/epoch - 46ms/step
Epoch 30/50
2159/2159 - 100s - loss: 2.4018 - accuracy30: 0.6121 - val_loss: 2.7273 - val_accuracy30: 0.5879 - 100s/epoch - 46ms/step
testing model: results/AAL/W3/deepLOB_L2/h30
Evaluating performance on  test set...
5760/5760 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73993266
{'0': {'precision': 0.4685539998056351, 'recall': 0.4946590429289043, 'f1-score': 0.4812527713419726, 'support': 253419}, '1': {'precision': 0.773474939444755, 'recall': 0.8547397116990239, 'f1-score': 0.8120793487308449, 'support': 971346}, '2': {'precision': 0.5223577692405622, 'recall': 0.279336499723675, 'f1-score': 0.3640130571262319, 'support': 249706}, 'accuracy': 0.6954060134109115, 'macro avg': {'precision': 0.5881289028303174, 'recall': 0.5429117514505344, 'f1-score': 0.5524483923996831, 'support': 1474471}, 'weighted avg': {'precision': 0.6785404010880058, 'recall': 0.6954060134109115, 'f1-score': 0.6793384661860324, 'support': 1474471}}
[[125356 109784  18279]
 [ 95596 830248  45502]
 [ 46586 133368  69752]]
Evaluating performance on  train set...
2159/2159 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88887435
{'0': {'precision': 0.42897223368770987, 'recall': 0.5986191758643772, 'f1-score': 0.49979204304708924, 'support': 128474}, '1': {'precision': 0.6896601906425089, 'recall': 0.6440893352859429, 'f1-score': 0.666096242403372, 'support': 294307}, '2': {'precision': 0.5172007276644613, 'recall': 0.3921993248971162, 'f1-score': 0.4461090048431987, 'support': 129758}, 'accuracy': 0.5743630766335046, 'macro avg': {'precision': 0.54527771733156, 'recall': 0.5449692786824788, 'f1-score': 0.5373324300978867, 'support': 552539}, 'weighted avg': {'precision': 0.5885458447249966, 'recall': 0.5743630766335046, 'f1-score': 0.575766202932073, 'support': 552539}}
[[ 76907  37047  14520]
 [ 71761 189560  32986]
 [ 30614  48253  50891]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84833115
{'0': {'precision': 0.4562685964074496, 'recall': 0.5257009840228547, 'f1-score': 0.4885301029488402, 'support': 47255}, '1': {'precision': 0.7195441536498741, 'recall': 0.6790374540366405, 'f1-score': 0.6987042121475926, 'support': 122924}, '2': {'precision': 0.4865977183068557, 'recall': 0.48380189119280836, 'f1-score': 0.4851957772084073, 'support': 47166}, 'accuracy': 0.6033311095263291, 'macro avg': {'precision': 0.5541368227880598, 'recall': 0.5628467764174345, 'f1-score': 0.5574766974349467, 'support': 217345}, 'weighted avg': {'precision': 0.6117512988481554, 'recall': 0.6033311095263291, 'f1-score': 0.60667487458506, 'support': 217345}}
[[24842 16389  6024]
 [21402 83470 18052]
 [ 8202 16145 22819]]
training model: results/AAL/W3/deepLOB_L2/h50
Epoch 1/50
2159/2159 - 101s - loss: 3.0891 - accuracy50: 0.4536 - val_loss: 3.0889 - val_accuracy50: 0.4728 - 101s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 100s - loss: 2.9722 - accuracy50: 0.4878 - val_loss: 2.9929 - val_accuracy50: 0.4839 - 100s/epoch - 46ms/step
Epoch 3/50
2159/2159 - 100s - loss: 2.9122 - accuracy50: 0.5097 - val_loss: 3.0028 - val_accuracy50: 0.4818 - 100s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 99s - loss: 2.8557 - accuracy50: 0.5263 - val_loss: 2.9717 - val_accuracy50: 0.5115 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 98s - loss: 2.8093 - accuracy50: 0.5375 - val_loss: 2.9470 - val_accuracy50: 0.5159 - 98s/epoch - 45ms/step
Epoch 6/50
2159/2159 - 98s - loss: 2.7755 - accuracy50: 0.5461 - val_loss: 2.9149 - val_accuracy50: 0.5238 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 98s - loss: 2.7495 - accuracy50: 0.5511 - val_loss: 2.8644 - val_accuracy50: 0.5360 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 98s - loss: 2.7312 - accuracy50: 0.5548 - val_loss: 2.8939 - val_accuracy50: 0.5207 - 98s/epoch - 45ms/step
Epoch 9/50
2159/2159 - 98s - loss: 2.7182 - accuracy50: 0.5569 - val_loss: 2.9089 - val_accuracy50: 0.5114 - 98s/epoch - 45ms/step
Epoch 10/50
2159/2159 - 98s - loss: 2.7064 - accuracy50: 0.5596 - val_loss: 2.9148 - val_accuracy50: 0.5113 - 98s/epoch - 45ms/step
Epoch 11/50
2159/2159 - 97s - loss: 2.6972 - accuracy50: 0.5616 - val_loss: 2.8724 - val_accuracy50: 0.5269 - 97s/epoch - 45ms/step
Epoch 12/50
2159/2159 - 98s - loss: 2.6898 - accuracy50: 0.5628 - val_loss: 2.8851 - val_accuracy50: 0.5209 - 98s/epoch - 45ms/step
Epoch 13/50
2159/2159 - 98s - loss: 2.6825 - accuracy50: 0.5645 - val_loss: 2.8722 - val_accuracy50: 0.5222 - 98s/epoch - 45ms/step
Epoch 14/50
2159/2159 - 98s - loss: 2.6758 - accuracy50: 0.5655 - val_loss: 2.9158 - val_accuracy50: 0.5152 - 98s/epoch - 45ms/step
Epoch 15/50
2159/2159 - 97s - loss: 2.6698 - accuracy50: 0.5666 - val_loss: 2.9275 - val_accuracy50: 0.5243 - 97s/epoch - 45ms/step
Epoch 16/50
2159/2159 - 98s - loss: 2.6647 - accuracy50: 0.5676 - val_loss: 2.9294 - val_accuracy50: 0.5153 - 98s/epoch - 46ms/step
Epoch 17/50
2159/2159 - 98s - loss: 2.6602 - accuracy50: 0.5688 - val_loss: 2.8848 - val_accuracy50: 0.5255 - 98s/epoch - 45ms/step
testing model: results/AAL/W3/deepLOB_L2/h50
Evaluating performance on  test set...
5760/5760 - 99s - 99s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8569338
{'0': {'precision': 0.47428048104147813, 'recall': 0.40221612305331134, 'f1-score': 0.43528578532571843, 'support': 323177}, '1': {'precision': 0.6667046328730086, 'recall': 0.8554712347638586, 'f1-score': 0.749383363161714, 'support': 834775}, '2': {'precision': 0.5533646370802423, 'recall': 0.22600223051380802, 'f1-score': 0.3209313802463043, 'support': 316519}, 'accuracy': 0.6210003452085527, 'macro avg': {'precision': 0.5647832503315764, 'recall': 0.494563196110326, 'f1-score': 0.5018668429112455, 'support': 1474471}, 'weighted avg': {'precision': 0.6001985284838486, 'recall': 0.6210003452085527, 'f1-score': 0.5885648010518413, 'support': 1474471}}
[[129987 176535  16655]
 [ 79567 714126  41082]
 [ 64518 180467  71534]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9803731
{'0': {'precision': 0.41821344369547064, 'recall': 0.5793540717257777, 'f1-score': 0.4857689483866473, 'support': 156457}, '1': {'precision': 0.5647844203046849, 'recall': 0.5785618448637316, 'f1-score': 0.5715901229863013, 'support': 238500}, '2': {'precision': 0.515271097507652, 'recall': 0.2991268038227716, 'f1-score': 0.37851619275521753, 'support': 157582}, 'accuracy': 0.49909237176018345, 'macro avg': {'precision': 0.4994229871692692, 'recall': 0.48568090680409365, 'f1-score': 0.4786250880427221, 'support': 552539}, 'weighted avg': {'precision': 0.5091603580749601, 'recall': 0.49909237176018345, 'f1-score': 0.49222504723958893, 'support': 552539}}
[[ 90644  49560  16253]
 [ 72423 137987  28090]
 [ 53674  56771  47137]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9401257
{'0': {'precision': 0.44939464130238366, 'recall': 0.46939720997271744, 'f1-score': 0.45917819256076275, 'support': 58279}, '1': {'precision': 0.5903032143941965, 'recall': 0.6538777449010895, 'f1-score': 0.6204662300161984, 'support': 101051}, '2': {'precision': 0.5167497417935246, 'recall': 0.3967077479962079, 'f1-score': 0.4488410870476729, 'support': 58015}, 'accuracy': 0.5357657180979548, 'macro avg': {'precision': 0.5188158658300349, 'recall': 0.5066609009566716, 'f1-score': 0.509495169874878, 'support': 217345}, 'weighted avg': {'precision': 0.5328865936108993, 'recall': 0.5357657180979548, 'f1-score': 0.5314071847002981, 'support': 217345}}
[[27356 23821  7102]
 [20555 66075 14421]
 [12962 22038 23015]]
training model: results/AAL/W3/deepLOB_L2/h100
Epoch 1/50
2159/2159 - 100s - loss: 3.2093 - accuracy100: 0.4170 - val_loss: 3.3906 - val_accuracy100: 0.3638 - 100s/epoch - 46ms/step
Epoch 2/50
2159/2159 - 98s - loss: 3.1427 - accuracy100: 0.4445 - val_loss: 3.3133 - val_accuracy100: 0.3775 - 98s/epoch - 45ms/step
Epoch 3/50
2159/2159 - 98s - loss: 3.1119 - accuracy100: 0.4548 - val_loss: 3.2676 - val_accuracy100: 0.3896 - 98s/epoch - 45ms/step
Epoch 4/50
2159/2159 - 99s - loss: 3.0956 - accuracy100: 0.4613 - val_loss: 3.2663 - val_accuracy100: 0.3873 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 98s - loss: 3.0818 - accuracy100: 0.4662 - val_loss: 3.3020 - val_accuracy100: 0.3803 - 98s/epoch - 45ms/step
Epoch 6/50
2159/2159 - 98s - loss: 3.0681 - accuracy100: 0.4703 - val_loss: 3.3462 - val_accuracy100: 0.3815 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 98s - loss: 3.0528 - accuracy100: 0.4744 - val_loss: 3.4042 - val_accuracy100: 0.3832 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 98s - loss: 3.0373 - accuracy100: 0.4786 - val_loss: 3.3993 - val_accuracy100: 0.3887 - 98s/epoch - 45ms/step
Epoch 9/50
2159/2159 - 98s - loss: 3.0236 - accuracy100: 0.4813 - val_loss: 3.3511 - val_accuracy100: 0.4000 - 98s/epoch - 45ms/step
Epoch 10/50
2159/2159 - 99s - loss: 3.0106 - accuracy100: 0.4844 - val_loss: 3.3549 - val_accuracy100: 0.4070 - 99s/epoch - 46ms/step
Epoch 11/50
2159/2159 - 99s - loss: 3.0001 - accuracy100: 0.4874 - val_loss: 3.3634 - val_accuracy100: 0.4060 - 99s/epoch - 46ms/step
Epoch 12/50
2159/2159 - 98s - loss: 2.9935 - accuracy100: 0.4884 - val_loss: 3.3642 - val_accuracy100: 0.4086 - 98s/epoch - 46ms/step
Epoch 13/50
2159/2159 - 98s - loss: 2.9844 - accuracy100: 0.4917 - val_loss: 3.3625 - val_accuracy100: 0.4135 - 98s/epoch - 45ms/step
Epoch 14/50
2159/2159 - 99s - loss: 2.9766 - accuracy100: 0.4931 - val_loss: 3.3414 - val_accuracy100: 0.4162 - 99s/epoch - 46ms/step
testing model: results/AAL/W3/deepLOB_L2/h100
Evaluating performance on  test set...
5760/5760 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0774589
{'0': {'precision': 0.4213491409743469, 'recall': 0.2682367262852327, 'f1-score': 0.32779475207982883, 'support': 427160}, '1': {'precision': 0.45484635834550813, 'recall': 0.2974909888953114, 'f1-score': 0.3597128161612412, 'support': 638379}, '2': {'precision': 0.30322609410131146, 'recall': 0.5820869973491926, 'f1-score': 0.39873795686037034, 'support': 408932}, 'accuracy': 0.36794619900967873, 'macro avg': {'precision': 0.3931405311403888, 'recall': 0.3826049041765789, 'f1-score': 0.36208184170048013, 'support': 1474471}, 'weighted avg': {'precision': 0.40309149217983037, 'recall': 0.36794619900967873, 'f1-score': 0.36128931958745997, 'support': 1474471}}
[[114580 132904 179676]
 [ 81172 189912 367295]
 [ 76184  94714 238034]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1073037
{'0': {'precision': 0.41381960592338757, 'recall': 0.4573702549452452, 'f1-score': 0.43450638526441854, 'support': 184824}, '1': {'precision': 0.380156778803043, 'recall': 0.35977990090065426, 'f1-score': 0.3696877637130802, 'support': 182645}, '2': {'precision': 0.37242672838907925, 'recall': 0.3529853568919868, 'f1-score': 0.3624455238724031, 'support': 185070}, 'accuracy': 0.39014802575021856, 'macro avg': {'precision': 0.3888010377051699, 'recall': 0.39004517091262875, 'f1-score': 0.3888798909499673, 'support': 552539}, 'weighted avg': {'precision': 0.3888278371891086, 'recall': 0.39014802575021856, 'f1-score': 0.38894380823173036, 'support': 552539}}
[[84533 45999 54292]
 [61143 65712 55790]
 [58599 61144 65327]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0883812
{'0': {'precision': 0.3923586523784796, 'recall': 0.3556157740854311, 'f1-score': 0.37308474982044526, 'support': 70115}, '1': {'precision': 0.4279780905397562, 'recall': 0.3052849472799017, 'f1-score': 0.35636671172157575, 'support': 77295}, '2': {'precision': 0.36206162578552603, 'recall': 0.5107742904125259, 'f1-score': 0.4237492215071621, 'support': 69935}, 'accuracy': 0.38764176769651937, 'macro avg': {'precision': 0.3941327895679206, 'recall': 0.39055833725928624, 'f1-score': 0.384400227683061, 'support': 217345}, 'weighted avg': {'precision': 0.3952774309006341, 'recall': 0.38764176769651937, 'f1-score': 0.3834415515529831, 'support': 217345}}
[[24934 14102 31079]
 [21838 23597 31860]
 [16777 17437 35721]]
training model: results/AAL/W3/deepLOB_L2/h200
Epoch 1/50
2159/2159 - 102s - loss: 3.2726 - accuracy200: 0.3830 - val_loss: 3.3627 - val_accuracy200: 0.3634 - 102s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 99s - loss: 3.2399 - accuracy200: 0.3991 - val_loss: 3.3389 - val_accuracy200: 0.3454 - 99s/epoch - 46ms/step
Epoch 3/50
2159/2159 - 99s - loss: 3.2211 - accuracy200: 0.4103 - val_loss: 3.4067 - val_accuracy200: 0.3494 - 99s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 99s - loss: 3.2105 - accuracy200: 0.4156 - val_loss: 3.4456 - val_accuracy200: 0.3529 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 99s - loss: 3.2018 - accuracy200: 0.4194 - val_loss: 3.4828 - val_accuracy200: 0.3535 - 99s/epoch - 46ms/step
Epoch 6/50
2159/2159 - 98s - loss: 3.1937 - accuracy200: 0.4225 - val_loss: 3.4079 - val_accuracy200: 0.3400 - 98s/epoch - 46ms/step
Epoch 7/50
2159/2159 - 98s - loss: 3.1854 - accuracy200: 0.4263 - val_loss: 3.4313 - val_accuracy200: 0.3380 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 99s - loss: 3.1790 - accuracy200: 0.4293 - val_loss: 3.4300 - val_accuracy200: 0.3417 - 99s/epoch - 46ms/step
Epoch 9/50
2159/2159 - 99s - loss: 3.1702 - accuracy200: 0.4331 - val_loss: 3.4882 - val_accuracy200: 0.3415 - 99s/epoch - 46ms/step
Epoch 10/50
2159/2159 - 99s - loss: 3.1638 - accuracy200: 0.4356 - val_loss: 3.5365 - val_accuracy200: 0.3397 - 99s/epoch - 46ms/step
Epoch 11/50
2159/2159 - 99s - loss: 3.1564 - accuracy200: 0.4375 - val_loss: 3.8022 - val_accuracy200: 0.3311 - 99s/epoch - 46ms/step
Epoch 12/50
2159/2159 - 100s - loss: 3.1480 - accuracy200: 0.4411 - val_loss: 3.6002 - val_accuracy200: 0.3280 - 100s/epoch - 46ms/step
testing model: results/AAL/W3/deepLOB_L2/h200
Evaluating performance on  test set...
5760/5760 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988896
{'0': {'precision': 0.39400050415931437, 'recall': 0.12489141124405835, 'f1-score': 0.189662924145098, 'support': 488080}, '1': {'precision': 0.36431631601559955, 'recall': 0.6257856564226998, 'f1-score': 0.4605261504567482, 'support': 527107}, '2': {'precision': 0.33927360400823464, 'recall': 0.3060785918952108, 'f1-score': 0.32182237122995866, 'support': 459284}, 'accuracy': 0.3603936598278298, 'macro avg': {'precision': 0.36586347472771624, 'recall': 0.3522518865206563, 'f1-score': 0.32400381527726824, 'support': 1474471}, 'weighted avg': {'precision': 0.3663418164205541, 'recall': 0.3603936598278298, 'f1-score': 0.32765995638674816, 'support': 1474471}}
[[ 60957 309912 117211]
 [ 40692 329856 156559]
 [ 53064 265643 140577]]
Evaluating performance on  train set...
2159/2159 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1149629
{'0': {'precision': 0.35745218729391076, 'recall': 0.35269365290242116, 'f1-score': 0.35505697714090756, 'support': 184415}, '1': {'precision': 0.3349870218260191, 'recall': 0.5445389909376372, 'f1-score': 0.41479954474379443, 'support': 184389}, '2': {'precision': 0.36537511468699274, 'recall': 0.14088224889106593, 'f1-score': 0.20335454474035664, 'support': 183735}, 'accuracy': 0.34628143895725005, 'macro avg': {'precision': 0.35260477460230755, 'recall': 0.34603829757704146, 'f1-score': 0.3244036888750195, 'support': 552539}, 'weighted avg': {'precision': 0.35258988738224634, 'recall': 0.34628143895725005, 'f1-score': 0.32454840829891357, 'support': 552539}}
[[ 65042  97096  22277]
 [ 61299 100407  22683]
 [ 55619 102231  25885]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1134073
{'0': {'precision': 0.37043180184663016, 'recall': 0.2717832224565958, 'f1-score': 0.31353096703245276, 'support': 73956}, '1': {'precision': 0.32468928607336484, 'recall': 0.5956245389024459, 'f1-score': 0.42027599945941346, 'support': 70484}, '2': {'precision': 0.3688323220364067, 'recall': 0.1709210616555792, 'f1-score': 0.23359265160746087, 'support': 72905}, 'accuracy': 0.34297085279164463, 'macro avg': {'precision': 0.3546511366521339, 'recall': 0.34610960767154025, 'f1-score': 0.3224665393664424, 'support': 217345}, 'weighted avg': {'precision': 0.3550611903426748, 'recall': 0.34297085279164463, 'f1-score': 0.3213338333487833, 'support': 217345}}
[[20100 42566 11290]
 [18468 41982 10034]
 [15693 44751 12461]]
training model: results/AAL/W3/deepLOB_L2/h300
Epoch 1/50
2159/2159 - 102s - loss: 3.2946 - accuracy300: 0.3691 - val_loss: 3.3526 - val_accuracy300: 0.3491 - 102s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 99s - loss: 3.2559 - accuracy300: 0.3918 - val_loss: 3.3723 - val_accuracy300: 0.3414 - 99s/epoch - 46ms/step
Epoch 3/50
2159/2159 - 99s - loss: 3.2422 - accuracy300: 0.4025 - val_loss: 3.4104 - val_accuracy300: 0.3387 - 99s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 99s - loss: 3.2339 - accuracy300: 0.4081 - val_loss: 3.4316 - val_accuracy300: 0.3436 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 99s - loss: 3.2260 - accuracy300: 0.4126 - val_loss: 3.4811 - val_accuracy300: 0.3319 - 99s/epoch - 46ms/step
Epoch 6/50
2159/2159 - 99s - loss: 3.2175 - accuracy300: 0.4147 - val_loss: 3.5815 - val_accuracy300: 0.3330 - 99s/epoch - 46ms/step
Epoch 7/50
2159/2159 - 99s - loss: 3.2097 - accuracy300: 0.4186 - val_loss: 3.7038 - val_accuracy300: 0.3322 - 99s/epoch - 46ms/step
Epoch 8/50
2159/2159 - 98s - loss: 3.2006 - accuracy300: 0.4234 - val_loss: 3.7075 - val_accuracy300: 0.3291 - 98s/epoch - 46ms/step
Epoch 9/50
2159/2159 - 98s - loss: 3.1933 - accuracy300: 0.4257 - val_loss: 3.4743 - val_accuracy300: 0.3432 - 98s/epoch - 45ms/step
Epoch 10/50
2159/2159 - 98s - loss: 3.1821 - accuracy300: 0.4311 - val_loss: 3.5053 - val_accuracy300: 0.3521 - 98s/epoch - 45ms/step
Epoch 11/50
2159/2159 - 98s - loss: 3.1750 - accuracy300: 0.4334 - val_loss: 3.5444 - val_accuracy300: 0.3507 - 98s/epoch - 45ms/step
testing model: results/AAL/W3/deepLOB_L2/h300
Evaluating performance on  test set...
5760/5760 - 103s - 103s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.110424
{'0': {'precision': 0.43862007168458783, 'recall': 0.006220493954239022, 'f1-score': 0.012267017510885568, 'support': 472149}, '1': {'precision': 0.3753041047673275, 'recall': 0.5921307959570996, 'f1-score': 0.4594192707239245, 'support': 563259}, '2': {'precision': 0.30540959176378557, 'recall': 0.4028191854016394, 'f1-score': 0.3474155440577353, 'support': 439063}, 'accuracy': 0.3481404517281113, 'macro avg': {'precision': 0.3731112560719003, 'recall': 0.33372349177099264, 'f1-score': 0.27303394409751514, 'support': 1474471}, 'weighted avg': {'precision': 0.3747659293139909, 'recall': 0.34814045172811126, 'f1-score': 0.282881935338203, 'support': 1474471}}
[[  2937 295025 174187]
 [  1685 333523 228051]
 [  2074 260126 176863]]
Evaluating performance on  train set...
2159/2159 - 38s - 38s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.127282
{'0': {'precision': 0.3554650698602794, 'recall': 0.12035054712166429, 'f1-score': 0.1798193002225426, 'support': 184968}, '1': {'precision': 0.3303703165881398, 'recall': 0.6996046345615288, 'f1-score': 0.4488043215975962, 'support': 182110}, '2': {'precision': 0.33871354451381497, 'recall': 0.1904335682434582, 'f1-score': 0.24379771651043033, 'support': 185461}, 'accuracy': 0.33478903751590383, 'macro avg': {'precision': 0.34151631032074475, 'recall': 0.3367962499755504, 'f1-score': 0.2908071127768564, 'support': 552539}, 'weighted avg': {'precision': 0.34157146205943645, 'recall': 0.33478903751590383, 'f1-score': 0.2899479306102238, 'support': 552539}}
[[ 22261 127669  35038]
 [ 20790 127405  33915]
 [ 19574 130569  35318]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1184464
{'0': {'precision': 0.34697954883940574, 'recall': 0.1330547430004179, 'f1-score': 0.19234990283832903, 'support': 71790}, '1': {'precision': 0.35286323484617726, 'recall': 0.6141062340966921, 'f1-score': 0.4481951483731187, 'support': 75456}, '2': {'precision': 0.3380573030634573, 'recall': 0.282101028545343, 'f1-score': 0.3075547260779968, 'support': 70099}, 'accuracy': 0.348133152361453, 'macro avg': {'precision': 0.3459666955830134, 'recall': 0.34308733521415097, 'f1-score': 0.31603325909648144, 'support': 217345}, 'weighted avg': {'precision': 0.3461445579478681, 'recall': 0.348133152361453, 'f1-score': 0.31832842431961716, 'support': 217345}}
[[ 9552 42250 19988]
 [10385 46338 18733]
 [ 7592 42732 19775]]
training model: results/AAL/W3/deepLOB_L2/h500
Epoch 1/50
2159/2159 - 104s - loss: 3.2486 - accuracy500: 0.4007 - val_loss: 3.3993 - val_accuracy500: 0.3260 - 104s/epoch - 48ms/step
Epoch 2/50
2159/2159 - 102s - loss: 3.2109 - accuracy500: 0.4243 - val_loss: 3.5745 - val_accuracy500: 0.3136 - 102s/epoch - 47ms/step
Epoch 3/50
2159/2159 - 99s - loss: 3.1939 - accuracy500: 0.4316 - val_loss: 3.6384 - val_accuracy500: 0.3112 - 99s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 99s - loss: 3.1776 - accuracy500: 0.4386 - val_loss: 3.7045 - val_accuracy500: 0.3088 - 99s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 98s - loss: 3.1683 - accuracy500: 0.4428 - val_loss: 3.6641 - val_accuracy500: 0.3135 - 98s/epoch - 46ms/step
Epoch 6/50
2159/2159 - 98s - loss: 3.1566 - accuracy500: 0.4476 - val_loss: 3.7017 - val_accuracy500: 0.3073 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 98s - loss: 3.1471 - accuracy500: 0.4519 - val_loss: 3.6841 - val_accuracy500: 0.3088 - 98s/epoch - 45ms/step
Epoch 8/50
2159/2159 - 100s - loss: 3.1353 - accuracy500: 0.4563 - val_loss: 3.7539 - val_accuracy500: 0.3092 - 100s/epoch - 46ms/step
Epoch 9/50
2159/2159 - 100s - loss: 3.1245 - accuracy500: 0.4599 - val_loss: 3.8040 - val_accuracy500: 0.3092 - 100s/epoch - 46ms/step
Epoch 10/50
2159/2159 - 99s - loss: 3.1134 - accuracy500: 0.4639 - val_loss: 3.8416 - val_accuracy500: 0.3080 - 99s/epoch - 46ms/step
Epoch 11/50
2159/2159 - 98s - loss: 3.1047 - accuracy500: 0.4669 - val_loss: 3.8961 - val_accuracy500: 0.3059 - 98s/epoch - 46ms/step
testing model: results/AAL/W3/deepLOB_L2/h500
Evaluating performance on  test set...
5760/5760 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1373488
{'0': {'precision': 0.42939164643546984, 'recall': 0.04613679767097805, 'f1-score': 0.08332101163970221, 'support': 525199}, '1': {'precision': 0.31686197007173905, 'recall': 0.33075214122430424, 'f1-score': 0.3236580959115966, 'support': 466322}, '2': {'precision': 0.3234766062907237, 'recall': 0.6237622942333575, 'f1-score': 0.42602243205824253, 'support': 482950}, 'accuracy': 0.3253465141057369, 'macro avg': {'precision': 0.3565767409326442, 'recall': 0.33355041104287997, 'f1-score': 0.2776671798698471, 'support': 1474471}, 'weighted avg': {'precision': 0.3591110289264155, 'recall': 0.3253465141057369, 'f1-score': 0.2715797978775953, 'support': 1474471}}
[[ 24231 169460 331508]
 [ 13563 154237 298522]
 [ 18637 163067 301246]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182348
{'0': {'precision': 0.34343287019267676, 'recall': 0.24182981805602102, 'f1-score': 0.28381207338425235, 'support': 185002}, '1': {'precision': 0.36913316260142387, 'recall': 0.4882001534582922, 'f1-score': 0.42039860869236906, 'support': 182460}, '2': {'precision': 0.35762482385123373, 'recall': 0.3496598712968116, 'f1-score': 0.35359749967215975, 'support': 185077}, 'accuracy': 0.35930495403944335, 'macro avg': {'precision': 0.3567302855484448, 'recall': 0.35989661427037495, 'f1-score': 0.35260272724959374, 'support': 552539}, 'weighted avg': {'precision': 0.356673346539441, 'recall': 0.35930495403944335, 'f1-score': 0.3522909618851654, 'support': 552539}}
[[44739 77463 62800]
 [39942 89077 53441]
 [45589 74774 64714]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1345211
{'0': {'precision': 0.3401832754875278, 'recall': 0.3508085281697394, 'f1-score': 0.34541421055967547, 'support': 77672}, '1': {'precision': 0.28277083860594604, 'recall': 0.29282355661759035, 'f1-score': 0.28770941258444666, 'support': 64865}, '2': {'precision': 0.35320223757063757, 'recall': 0.3308603357929633, 'f1-score': 0.3416664365975539, 'support': 74808}, 'accuracy': 0.326637373760611, 'macro avg': {'precision': 0.3253854505547038, 'recall': 0.32483080686009774, 'f1-score': 0.32493001991389203, 'support': 217345}, 'weighted avg': {'precision': 0.3275299583980593, 'recall': 0.326637373760611, 'f1-score': 0.32690269570899283, 'support': 217345}}
[[27248 24754 25670]
 [26216 18994 19655]
 [26634 23423 24751]]
training model: results/AAL/W3/deepLOB_L2/h1000
Epoch 1/50
2159/2159 - 100s - loss: 3.2245 - accuracy1000: 0.4192 - val_loss: 3.3386 - val_accuracy1000: 0.3692 - 100s/epoch - 47ms/step
Epoch 2/50
2159/2159 - 98s - loss: 3.1656 - accuracy1000: 0.4426 - val_loss: 3.3896 - val_accuracy1000: 0.3369 - 98s/epoch - 45ms/step
Epoch 3/50
2159/2159 - 98s - loss: 3.1490 - accuracy1000: 0.4458 - val_loss: 3.4042 - val_accuracy1000: 0.3485 - 98s/epoch - 46ms/step
Epoch 4/50
2159/2159 - 98s - loss: 3.1411 - accuracy1000: 0.4500 - val_loss: 3.4168 - val_accuracy1000: 0.3272 - 98s/epoch - 46ms/step
Epoch 5/50
2159/2159 - 99s - loss: 3.1219 - accuracy1000: 0.4596 - val_loss: 3.4007 - val_accuracy1000: 0.3229 - 99s/epoch - 46ms/step
Epoch 6/50
2159/2159 - 98s - loss: 3.1123 - accuracy1000: 0.4635 - val_loss: 3.3908 - val_accuracy1000: 0.3505 - 98s/epoch - 45ms/step
Epoch 7/50
2159/2159 - 99s - loss: 3.1005 - accuracy1000: 0.4678 - val_loss: 3.4057 - val_accuracy1000: 0.3249 - 99s/epoch - 46ms/step
Epoch 8/50
2159/2159 - 99s - loss: 3.0930 - accuracy1000: 0.4709 - val_loss: 3.5083 - val_accuracy1000: 0.3438 - 99s/epoch - 46ms/step
Epoch 9/50
2159/2159 - 98s - loss: 3.0902 - accuracy1000: 0.4704 - val_loss: 3.5113 - val_accuracy1000: 0.3139 - 98s/epoch - 45ms/step
Epoch 10/50
2159/2159 - 98s - loss: 3.0796 - accuracy1000: 0.4750 - val_loss: 3.4746 - val_accuracy1000: 0.3137 - 98s/epoch - 45ms/step
Epoch 11/50
2159/2159 - 97s - loss: 3.0728 - accuracy1000: 0.4771 - val_loss: 3.5911 - val_accuracy1000: 0.3125 - 97s/epoch - 45ms/step
testing model: results/AAL/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
5760/5760 - 96s - 96s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0947007
{'0': {'precision': 0.4235688403202475, 'recall': 0.15050279557051352, 'f1-score': 0.22209177600576746, 'support': 589504}, '1': {'precision': 0.24213889355977805, 'recall': 0.0041464145032365065, 'f1-score': 0.008153212450634845, 'support': 347288}, '2': {'precision': 0.3676287328413794, 'recall': 0.8608612201703991, 'f1-score': 0.5152298050914434, 'support': 537679}, 'accuracy': 0.3750694316809215, 'macro avg': {'precision': 0.34444548890713494, 'recall': 0.3385034767480497, 'f1-score': 0.2484915978492819, 'support': 1474471}, 'weighted avg': {'precision': 0.36043686661599683, 'recall': 0.3750694316809215, 'f1-score': 0.2785973746108416, 'support': 1474471}}
[[ 88722   2289 498493]
 [ 48147   1440 297701]
 [ 72594   2218 462867]]
Evaluating performance on  train set...
2159/2159 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357665
{'0': {'precision': 0.31478183142422034, 'recall': 0.5136955957989368, 'f1-score': 0.39035955628176594, 'support': 185096}, '1': {'precision': 0.35344196265104355, 'recall': 0.021107818804054275, 'f1-score': 0.03983656792645556, 'support': 182918}, '2': {'precision': 0.3606645655486214, 'recall': 0.4682238179108522, 'f1-score': 0.40746557253348425, 'support': 184525}, 'accuracy': 0.3354387654084146, 'macro avg': {'precision': 0.34296278654129514, 'recall': 0.33434241083794775, 'f1-score': 0.27922056558056857, 'support': 552539}, 'weighted avg': {'precision': 0.3429031864743673, 'recall': 0.3354387654084146, 'f1-score': 0.2800316403606665, 'support': 552539}}
[[ 95083   3531  86482]
 [112383   3861  66674]
 [ 94594   3532  86399]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1130404
{'0': {'precision': 0.3696617407809111, 'recall': 0.5179451257880302, 'f1-score': 0.4314173403545205, 'support': 84229}, '1': {'precision': 0.25935973955507324, 'recall': 0.008717696193759004, 'f1-score': 0.016868405265200972, 'support': 54831}, '2': {'precision': 0.3694376628438955, 'recall': 0.4600498179727917, 'f1-score': 0.4097945622429183, 'support': 78285}, 'accuracy': 0.36862591732038924, 'macro avg': {'precision': 0.33281971439329333, 'recall': 0.32890421331819364, 'f1-score': 0.2860267692875466, 'support': 217345}, 'weighted avg': {'precision': 0.34175444606277544, 'recall': 0.36862591732038924, 'f1-score': 0.3190481952426051, 'support': 217345}}
[[43626   716 39887]
 [32769   478 21584]
 [41621   649 36015]]
training model: results/AAL/W3/deepOF_L2/h10
Epoch 1/50
2159/2159 - 61s - loss: 2.7316 - accuracy10: 0.4958 - val_loss: 2.6596 - val_accuracy10: 0.7369 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 59s - loss: 2.4193 - accuracy10: 0.5889 - val_loss: 2.5245 - val_accuracy10: 0.7320 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.3465 - accuracy10: 0.6055 - val_loss: 2.5054 - val_accuracy10: 0.7243 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 2.3170 - accuracy10: 0.6103 - val_loss: 2.4825 - val_accuracy10: 0.7341 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 59s - loss: 2.2967 - accuracy10: 0.6129 - val_loss: 2.4501 - val_accuracy10: 0.7311 - 59s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 2.2813 - accuracy10: 0.6148 - val_loss: 2.4617 - val_accuracy10: 0.7279 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 59s - loss: 2.2694 - accuracy10: 0.6160 - val_loss: 2.4462 - val_accuracy10: 0.7301 - 59s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.2569 - accuracy10: 0.6172 - val_loss: 2.4376 - val_accuracy10: 0.7327 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.2479 - accuracy10: 0.6182 - val_loss: 2.4724 - val_accuracy10: 0.7331 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 59s - loss: 2.2394 - accuracy10: 0.6196 - val_loss: 2.4295 - val_accuracy10: 0.7293 - 59s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 59s - loss: 2.2315 - accuracy10: 0.6212 - val_loss: 2.4545 - val_accuracy10: 0.7340 - 59s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.2240 - accuracy10: 0.6212 - val_loss: 2.4816 - val_accuracy10: 0.7348 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.2160 - accuracy10: 0.6228 - val_loss: 2.4789 - val_accuracy10: 0.7309 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.2101 - accuracy10: 0.6236 - val_loss: 2.4795 - val_accuracy10: 0.7349 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 59s - loss: 2.2041 - accuracy10: 0.6233 - val_loss: 2.4431 - val_accuracy10: 0.7299 - 59s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 59s - loss: 2.1983 - accuracy10: 0.6250 - val_loss: 2.4544 - val_accuracy10: 0.7344 - 59s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 58s - loss: 2.1914 - accuracy10: 0.6252 - val_loss: 2.4674 - val_accuracy10: 0.7357 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 2.1872 - accuracy10: 0.6260 - val_loss: 2.4426 - val_accuracy10: 0.7290 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 2.1803 - accuracy10: 0.6266 - val_loss: 2.4599 - val_accuracy10: 0.7363 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 58s - loss: 2.1755 - accuracy10: 0.6269 - val_loss: 2.4442 - val_accuracy10: 0.7308 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h10
Evaluating performance on  test set...
5760/5760 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58295983
{'0': {'precision': 0.43667872912585903, 'recall': 0.43083151543737597, 'f1-score': 0.4337354165155282, 'support': 152649}, '1': {'precision': 0.897554746119836, 'recall': 0.8274692601002528, 'f1-score': 0.861088261952562, 'support': 1167050}, '2': {'precision': 0.35628234136346953, 'recall': 0.5707704435025328, 'f1-score': 0.4387138107169196, 'support': 154768}, 'accuracy': 0.7594615545820964, 'macro avg': {'precision': 0.5635052722030548, 'recall': 0.6096904063467204, 'f1-score': 0.5778458297283366, 'support': 1474467}, 'weighted avg': {'precision': 0.7930261872185875, 'recall': 0.7594615545820964, 'f1-score': 0.7725104683688768, 'support': 1474467}}
[[ 65766  59766  27117]
 [ 68865 965698 132487]
 [ 15974  50457  88337]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7123015
{'0': {'precision': 0.4633030193644546, 'recall': 0.4891987262242878, 'f1-score': 0.47589885893356937, 'support': 81333}, '1': {'precision': 0.8457080634669231, 'recall': 0.7693417999001714, 'f1-score': 0.8057194746684343, 'support': 388666}, '2': {'precision': 0.4076081670188966, 'recall': 0.5584753873926265, 'f1-score': 0.4712617825669127, 'support': 82539}, 'accuracy': 0.6966054823378663, 'macro avg': {'precision': 0.5722064166167581, 'recall': 0.6056719711723618, 'f1-score': 0.5842933720563055, 'support': 552538}, 'weighted avg': {'precision': 0.7239743966333121, 'recall': 0.6966054823378663, 'f1-score': 0.7072084155414036, 'support': 552538}}
[[ 39788  28388  13157]
 [ 35813 299017  53836]
 [ 10278  26165  46096]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6398959
{'0': {'precision': 0.4872817785051828, 'recall': 0.4770982172664753, 'f1-score': 0.4821362302216525, 'support': 29954}, '1': {'precision': 0.8607032770927969, 'recall': 0.8086023827063277, 'f1-score': 0.8338397663422875, 'support': 157468}, '2': {'precision': 0.4248895985629101, 'recall': 0.5691274270627945, 'f1-score': 0.4865436260785098, 'support': 29923}, 'accuracy': 0.7299454783868964, 'macro avg': {'precision': 0.5909582180536299, 'recall': 0.6182760090118657, 'f1-score': 0.60083987421415, 'support': 217345}, 'weighted avg': {'precision': 0.749238461838969, 'recall': 0.7299454783868964, 'f1-score': 0.7375547350506981, 'support': 217345}}
[[ 14291  11164   4499]
 [ 11587 127329  18552]
 [  3450   9443  17030]]
training model: results/AAL/W3/deepOF_L2/h20
Epoch 1/50
2159/2159 - 61s - loss: 2.8273 - accuracy20: 0.4966 - val_loss: 2.7595 - val_accuracy20: 0.6874 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 58s - loss: 2.5480 - accuracy20: 0.5795 - val_loss: 2.6531 - val_accuracy20: 0.6931 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.4809 - accuracy20: 0.5971 - val_loss: 2.6507 - val_accuracy20: 0.6962 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 2.4547 - accuracy20: 0.6016 - val_loss: 2.6185 - val_accuracy20: 0.6969 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 2.4356 - accuracy20: 0.6056 - val_loss: 2.6208 - val_accuracy20: 0.6985 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 2.4234 - accuracy20: 0.6065 - val_loss: 2.6150 - val_accuracy20: 0.6975 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 2.4129 - accuracy20: 0.6086 - val_loss: 2.6249 - val_accuracy20: 0.6988 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.4027 - accuracy20: 0.6104 - val_loss: 2.6199 - val_accuracy20: 0.6989 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 57s - loss: 2.3950 - accuracy20: 0.6112 - val_loss: 2.6063 - val_accuracy20: 0.6983 - 57s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.3857 - accuracy20: 0.6126 - val_loss: 2.6040 - val_accuracy20: 0.6984 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.3801 - accuracy20: 0.6135 - val_loss: 2.6103 - val_accuracy20: 0.6985 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.3747 - accuracy20: 0.6149 - val_loss: 2.5939 - val_accuracy20: 0.6956 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.3668 - accuracy20: 0.6158 - val_loss: 2.6024 - val_accuracy20: 0.6954 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.3608 - accuracy20: 0.6166 - val_loss: 2.5755 - val_accuracy20: 0.6959 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 2.3553 - accuracy20: 0.6172 - val_loss: 2.5706 - val_accuracy20: 0.6968 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 58s - loss: 2.3507 - accuracy20: 0.6178 - val_loss: 2.5647 - val_accuracy20: 0.6948 - 58s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 58s - loss: 2.3443 - accuracy20: 0.6184 - val_loss: 2.5688 - val_accuracy20: 0.6957 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 2.3397 - accuracy20: 0.6186 - val_loss: 2.5709 - val_accuracy20: 0.6952 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 2.3329 - accuracy20: 0.6200 - val_loss: 2.5512 - val_accuracy20: 0.6933 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 58s - loss: 2.3289 - accuracy20: 0.6205 - val_loss: 2.5768 - val_accuracy20: 0.6936 - 58s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 58s - loss: 2.3246 - accuracy20: 0.6202 - val_loss: 2.5561 - val_accuracy20: 0.6892 - 58s/epoch - 27ms/step
Epoch 22/50
2159/2159 - 58s - loss: 2.3189 - accuracy20: 0.6212 - val_loss: 2.5724 - val_accuracy20: 0.6900 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 58s - loss: 2.3148 - accuracy20: 0.6218 - val_loss: 2.5812 - val_accuracy20: 0.6910 - 58s/epoch - 27ms/step
Epoch 24/50
2159/2159 - 58s - loss: 2.3095 - accuracy20: 0.6231 - val_loss: 2.5678 - val_accuracy20: 0.6888 - 58s/epoch - 27ms/step
Epoch 25/50
2159/2159 - 58s - loss: 2.3045 - accuracy20: 0.6231 - val_loss: 2.5784 - val_accuracy20: 0.6907 - 58s/epoch - 27ms/step
Epoch 26/50
2159/2159 - 58s - loss: 2.3014 - accuracy20: 0.6226 - val_loss: 2.5736 - val_accuracy20: 0.6878 - 58s/epoch - 27ms/step
Epoch 27/50
2159/2159 - 58s - loss: 2.2951 - accuracy20: 0.6241 - val_loss: 2.5969 - val_accuracy20: 0.6883 - 58s/epoch - 27ms/step
Epoch 28/50
2159/2159 - 58s - loss: 2.2926 - accuracy20: 0.6236 - val_loss: 2.5635 - val_accuracy20: 0.6870 - 58s/epoch - 27ms/step
Epoch 29/50
2159/2159 - 58s - loss: 2.2863 - accuracy20: 0.6252 - val_loss: 2.5705 - val_accuracy20: 0.6854 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h20
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6403403
{'0': {'precision': 0.49089086694799905, 'recall': 0.4108061994814702, 'f1-score': 0.44729215369327247, 'support': 209824}, '1': {'precision': 0.8325442938096262, 'recall': 0.8569947764712119, 'f1-score': 0.8445926152594586, 'support': 1056374}, '2': {'precision': 0.4498524655280032, 'recall': 0.45677945349523935, 'f1-score': 0.45328949719472533, 'support': 208269}, 'accuracy': 0.7369693590972195, 'macro avg': {'precision': 0.5910958754285428, 'recall': 0.5748601431493071, 'f1-score': 0.5817247553824855, 'support': 1474467}, 'weighted avg': {'precision': 0.7298699490991651, 'recall': 0.7369693590972195, 'f1-score': 0.7327830724593231, 'support': 1474467}}
[[ 86197  95526  28101]
 [ 62825 905307  88242]
 [ 26571  86565  95133]]
Evaluating performance on  train set...
2159/2159 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7733719
{'0': {'precision': 0.5067170767282079, 'recall': 0.4857198046303706, 'f1-score': 0.4959963180215002, 'support': 108717}, '1': {'precision': 0.7597435252703042, 'recall': 0.7965464970671587, 'f1-score': 0.7777098548952736, 'support': 333806}, '2': {'precision': 0.5093238434163702, 'recall': 0.4553197291278462, 'f1-score': 0.4808101168622369, 'support': 110015}, 'accuracy': 0.667447306791569, 'macro avg': {'precision': 0.5919281484716273, 'recall': 0.5791953436084585, 'f1-score': 0.5848387632596702, 'support': 552538}, 'weighted avg': {'precision': 0.660097532224918, 'recall': 0.667447306791569, 'f1-score': 0.6631648366919817, 'support': 552538}}
[[ 52806  41940  13971]
 [ 33627 265892  34287]
 [ 17779  42144  50092]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71450055
{'0': {'precision': 0.5236621090950784, 'recall': 0.458248676850528, 'f1-score': 0.48877652031998287, 'support': 39867}, '1': {'precision': 0.7773597274099162, 'recall': 0.8279538611470713, 'f1-score': 0.8018595150469282, 'support': 137498}, '2': {'precision': 0.517702924106523, 'recall': 0.4663081540770385, 'f1-score': 0.49066336803042465, 'support': 39980}, 'accuracy': 0.6936161402378707, 'macro avg': {'precision': 0.6062415868705059, 'recall': 0.5841702306915458, 'f1-score': 0.5937664677991119, 'support': 217345}, 'weighted avg': {'precision': 0.6830615289446775, 'recall': 0.6936161402378707, 'f1-score': 0.6871879021342827, 'support': 217345}}
[[ 18269  16828   4770]
 [ 11058 113842  12598]
 [  5560  15777  18643]]
training model: results/AAL/W3/deepOF_L2/h30
Epoch 1/50
2159/2159 - 61s - loss: 2.9055 - accuracy30: 0.4925 - val_loss: 2.8964 - val_accuracy30: 0.6327 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 58s - loss: 2.6565 - accuracy30: 0.5633 - val_loss: 2.7801 - val_accuracy30: 0.6426 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.5958 - accuracy30: 0.5795 - val_loss: 2.7498 - val_accuracy30: 0.6478 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 2.5713 - accuracy30: 0.5846 - val_loss: 2.7372 - val_accuracy30: 0.6512 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 2.5556 - accuracy30: 0.5869 - val_loss: 2.7224 - val_accuracy30: 0.6522 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 2.5436 - accuracy30: 0.5897 - val_loss: 2.7391 - val_accuracy30: 0.6513 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 2.5334 - accuracy30: 0.5914 - val_loss: 2.7232 - val_accuracy30: 0.6500 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.5249 - accuracy30: 0.5922 - val_loss: 2.7242 - val_accuracy30: 0.6509 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.5167 - accuracy30: 0.5943 - val_loss: 2.7163 - val_accuracy30: 0.6523 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.5098 - accuracy30: 0.5951 - val_loss: 2.7053 - val_accuracy30: 0.6514 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.5039 - accuracy30: 0.5967 - val_loss: 2.7126 - val_accuracy30: 0.6518 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.4977 - accuracy30: 0.5974 - val_loss: 2.7282 - val_accuracy30: 0.6505 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.4933 - accuracy30: 0.5980 - val_loss: 2.7175 - val_accuracy30: 0.6513 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.4876 - accuracy30: 0.5993 - val_loss: 2.7061 - val_accuracy30: 0.6503 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 64s - loss: 2.4828 - accuracy30: 0.6001 - val_loss: 2.7001 - val_accuracy30: 0.6478 - 64s/epoch - 30ms/step
Epoch 16/50
2159/2159 - 59s - loss: 2.4774 - accuracy30: 0.6011 - val_loss: 2.7192 - val_accuracy30: 0.6501 - 59s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 59s - loss: 2.4720 - accuracy30: 0.6014 - val_loss: 2.7080 - val_accuracy30: 0.6490 - 59s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 2.4687 - accuracy30: 0.6017 - val_loss: 2.7235 - val_accuracy30: 0.6492 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 2.4628 - accuracy30: 0.6024 - val_loss: 2.7185 - val_accuracy30: 0.6489 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 58s - loss: 2.4585 - accuracy30: 0.6034 - val_loss: 2.7101 - val_accuracy30: 0.6492 - 58s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 58s - loss: 2.4539 - accuracy30: 0.6043 - val_loss: 2.7111 - val_accuracy30: 0.6477 - 58s/epoch - 27ms/step
Epoch 22/50
2159/2159 - 58s - loss: 2.4493 - accuracy30: 0.6050 - val_loss: 2.7022 - val_accuracy30: 0.6452 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 58s - loss: 2.4450 - accuracy30: 0.6057 - val_loss: 2.7205 - val_accuracy30: 0.6483 - 58s/epoch - 27ms/step
Epoch 24/50
2159/2159 - 58s - loss: 2.4400 - accuracy30: 0.6061 - val_loss: 2.7043 - val_accuracy30: 0.6486 - 58s/epoch - 27ms/step
Epoch 25/50
2159/2159 - 58s - loss: 2.4350 - accuracy30: 0.6076 - val_loss: 2.6999 - val_accuracy30: 0.6456 - 58s/epoch - 27ms/step
Epoch 26/50
2159/2159 - 58s - loss: 2.4307 - accuracy30: 0.6073 - val_loss: 2.6826 - val_accuracy30: 0.6451 - 58s/epoch - 27ms/step
Epoch 27/50
2159/2159 - 58s - loss: 2.4262 - accuracy30: 0.6084 - val_loss: 2.7113 - val_accuracy30: 0.6460 - 58s/epoch - 27ms/step
Epoch 28/50
2159/2159 - 58s - loss: 2.4209 - accuracy30: 0.6086 - val_loss: 2.7157 - val_accuracy30: 0.6411 - 58s/epoch - 27ms/step
Epoch 29/50
2159/2159 - 58s - loss: 2.4174 - accuracy30: 0.6098 - val_loss: 2.7419 - val_accuracy30: 0.6429 - 58s/epoch - 27ms/step
Epoch 30/50
2159/2159 - 58s - loss: 2.4106 - accuracy30: 0.6102 - val_loss: 2.7335 - val_accuracy30: 0.6415 - 58s/epoch - 27ms/step
Epoch 31/50
2159/2159 - 58s - loss: 2.4067 - accuracy30: 0.6102 - val_loss: 2.7519 - val_accuracy30: 0.6421 - 58s/epoch - 27ms/step
Epoch 32/50
2159/2159 - 59s - loss: 2.4002 - accuracy30: 0.6115 - val_loss: 2.7462 - val_accuracy30: 0.6400 - 59s/epoch - 27ms/step
Epoch 33/50
2159/2159 - 59s - loss: 2.3990 - accuracy30: 0.6115 - val_loss: 2.7789 - val_accuracy30: 0.6416 - 59s/epoch - 27ms/step
Epoch 34/50
2159/2159 - 59s - loss: 2.3941 - accuracy30: 0.6123 - val_loss: 2.7493 - val_accuracy30: 0.6410 - 59s/epoch - 27ms/step
Epoch 35/50
2159/2159 - 59s - loss: 2.3880 - accuracy30: 0.6131 - val_loss: 2.7888 - val_accuracy30: 0.6394 - 59s/epoch - 27ms/step
Epoch 36/50
2159/2159 - 59s - loss: 2.3840 - accuracy30: 0.6134 - val_loss: 2.7921 - val_accuracy30: 0.6391 - 59s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h30
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71732664
{'0': {'precision': 0.5199922196988813, 'recall': 0.39032349714700615, 'f1-score': 0.4459226132782739, 'support': 253418}, '1': {'precision': 0.7782838541393368, 'recall': 0.8398241613432921, 'f1-score': 0.8078837492126748, 'support': 971345}, '2': {'precision': 0.4661699676397337, 'recall': 0.4407578573030468, 'f1-score': 0.45310788890810133, 'support': 249704}, 'accuracy': 0.694985374375961, 'macro avg': {'precision': 0.5881486804926507, 'recall': 0.5569685052644483, 'f1-score': 0.5689714171330167, 'support': 1474467}, 'weighted avg': {'precision': 0.6810339086803144, 'recall': 0.694985374375961, 'f1-score': 0.685591138684452, 'support': 1474467}}
[[ 98915 121871  32632]
 [ 62185 815759  93401]
 [ 29124 110521 110059]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84092265
{'0': {'precision': 0.5353576914636823, 'recall': 0.4558733075359904, 'f1-score': 0.4924286705493997, 'support': 128437}, '1': {'precision': 0.690796535961114, 'recall': 0.7781903040843501, 'f1-score': 0.7318937811088323, 'support': 294392}, '2': {'precision': 0.524019581472914, 'recall': 0.4505932510465735, 'f1-score': 0.48454048407622186, 'support': 129709}, 'accuracy': 0.6263641595691156, 'macro avg': {'precision': 0.5833912696325702, 'recall': 0.561552287555638, 'f1-score': 0.5696209785781513, 'support': 552538}, 'weighted avg': {'precision': 0.6155138027184655, 'recall': 0.6263641595691156, 'f1-score': 0.6181638128356552, 'support': 552538}}
[[ 58551  51220  18666]
 [ 30877 229093  34422]
 [ 19940  51323  58446]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8010629
{'0': {'precision': 0.5428082191780822, 'recall': 0.42219309557533347, 'f1-score': 0.47496283964563885, 'support': 47303}, '1': {'precision': 0.7098748541885684, 'recall': 0.80264764789214, 'f1-score': 0.7534160731207776, 'support': 122826}, '2': {'precision': 0.5180323935212957, 'recall': 0.45723907150118603, 'f1-score': 0.4857409636521132, 'support': 47216}, 'accuracy': 0.644808944305137, 'macro avg': {'precision': 0.5902384889626489, 'recall': 0.5606932716562198, 'f1-score': 0.5713732921395099, 'support': 217345}, 'weighted avg': {'precision': 0.6318386138390459, 'recall': 0.644808944305137, 'f1-score': 0.6346637610282659, 'support': 217345}}
[[19971 20890  6442]
 [10596 98586 13644]
 [ 6225 19402 21589]]
training model: results/AAL/W3/deepOF_L2/h50
Epoch 1/50
2159/2159 - 63s - loss: 3.0273 - accuracy50: 0.4739 - val_loss: 3.0731 - val_accuracy50: 0.5400 - 63s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 59s - loss: 2.8294 - accuracy50: 0.5315 - val_loss: 2.9976 - val_accuracy50: 0.5597 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 59s - loss: 2.7767 - accuracy50: 0.5452 - val_loss: 2.9726 - val_accuracy50: 0.5670 - 59s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 2.7553 - accuracy50: 0.5498 - val_loss: 2.9778 - val_accuracy50: 0.5690 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 2.7424 - accuracy50: 0.5522 - val_loss: 2.9586 - val_accuracy50: 0.5703 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 59s - loss: 2.7309 - accuracy50: 0.5548 - val_loss: 2.9534 - val_accuracy50: 0.5705 - 59s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 59s - loss: 2.7239 - accuracy50: 0.5563 - val_loss: 2.9360 - val_accuracy50: 0.5712 - 59s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.7157 - accuracy50: 0.5576 - val_loss: 2.9575 - val_accuracy50: 0.5711 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 59s - loss: 2.7085 - accuracy50: 0.5597 - val_loss: 2.9466 - val_accuracy50: 0.5706 - 59s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.7027 - accuracy50: 0.5610 - val_loss: 2.9478 - val_accuracy50: 0.5715 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.6974 - accuracy50: 0.5621 - val_loss: 2.9524 - val_accuracy50: 0.5727 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.6922 - accuracy50: 0.5635 - val_loss: 2.9648 - val_accuracy50: 0.5706 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.6868 - accuracy50: 0.5643 - val_loss: 2.9514 - val_accuracy50: 0.5712 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.6825 - accuracy50: 0.5651 - val_loss: 2.9610 - val_accuracy50: 0.5709 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 2.6778 - accuracy50: 0.5663 - val_loss: 2.9722 - val_accuracy50: 0.5703 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 59s - loss: 2.6715 - accuracy50: 0.5674 - val_loss: 2.9675 - val_accuracy50: 0.5698 - 59s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 59s - loss: 2.6662 - accuracy50: 0.5684 - val_loss: 2.9653 - val_accuracy50: 0.5703 - 59s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h50
Evaluating performance on  test set...
5760/5760 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81551385
{'0': {'precision': 0.5599414547398183, 'recall': 0.34684815704136446, 'f1-score': 0.4283566090839437, 'support': 323176}, '1': {'precision': 0.6662061801182807, 'recall': 0.8757915316001696, 'f1-score': 0.7567556377201937, 'support': 834774}, '2': {'precision': 0.5329583356888462, 'recall': 0.29785130024611634, 'f1-score': 0.3821388833153968, 'support': 316517}, 'accuracy': 0.6357931374523811, 'macro avg': {'precision': 0.5863686568489818, 'recall': 0.5068303296292168, 'f1-score': 0.522417043373178, 'support': 1474467}, 'weighted avg': {'precision': 0.6143112127407936, 'recall': 0.6357931374523811, 'f1-score': 0.6043593781006215, 'support': 1474467}}
[[112093 185172  25911]
 [ 46982 731088  56704]
 [ 41112 181130  94275]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.956529
{'0': {'precision': 0.5475219335433718, 'recall': 0.392024794708758, 'f1-score': 0.45690579753321814, 'support': 156485}, '1': {'precision': 0.5507504351167469, 'recall': 0.8170497080558152, 'f1-score': 0.6579769485621121, 'support': 238573}, '2': {'precision': 0.5585384730902075, 'recall': 0.3070294640589281, 'f1-score': 0.39624334656848886, 'support': 157480}, 'accuracy': 0.5513159275923104, 'macro avg': {'precision': 0.552270280583442, 'recall': 0.5053679889411672, 'f1-score': 0.5037086975546063, 'support': 552538}, 'weighted avg': {'precision': 0.5520557718562128, 'recall': 0.5513159275923104, 'f1-score': 0.5264340923047827, 'support': 552538}}
[[ 61346  77659  17480]
 [ 22911 194926  20736]
 [ 27786  81343  48351]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91988
{'0': {'precision': 0.5610031809458713, 'recall': 0.36614450182729097, 'f1-score': 0.44309711177093497, 'support': 58283}, '1': {'precision': 0.5742920476212935, 'recall': 0.8436633937762293, 'f1-score': 0.6833912600770486, 'support': 101032}, '2': {'precision': 0.5725756839889914, 'recall': 0.3047389281406169, 'f1-score': 0.3977731541359726, 'support': 58030}, 'accuracy': 0.5717223768662725, 'macro avg': {'precision': 0.5692903041853854, 'recall': 0.5048489412480458, 'f1-score': 0.5080871753279854, 'support': 217345}, 'weighted avg': {'precision': 0.5702702592294459, 'recall': 0.5717223768662725, 'f1-score': 0.5426956722628092, 'support': 217345}}
[[21340 31259  5684]
 [ 8278 85237  7517]
 [ 8421 31925 17684]]
training model: results/AAL/W3/deepOF_L2/h100
Epoch 1/50
2159/2159 - 62s - loss: 3.1710 - accuracy100: 0.4296 - val_loss: 3.2788 - val_accuracy100: 0.4121 - 62s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 58s - loss: 3.0801 - accuracy100: 0.4608 - val_loss: 3.2139 - val_accuracy100: 0.4271 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 3.0392 - accuracy100: 0.4729 - val_loss: 3.1880 - val_accuracy100: 0.4382 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.0233 - accuracy100: 0.4772 - val_loss: 3.1955 - val_accuracy100: 0.4421 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.0132 - accuracy100: 0.4797 - val_loss: 3.2008 - val_accuracy100: 0.4423 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 59s - loss: 3.0065 - accuracy100: 0.4815 - val_loss: 3.2153 - val_accuracy100: 0.4429 - 59s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 3.0012 - accuracy100: 0.4834 - val_loss: 3.2109 - val_accuracy100: 0.4437 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.9972 - accuracy100: 0.4838 - val_loss: 3.2093 - val_accuracy100: 0.4444 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.9921 - accuracy100: 0.4856 - val_loss: 3.2109 - val_accuracy100: 0.4450 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.9882 - accuracy100: 0.4866 - val_loss: 3.2144 - val_accuracy100: 0.4457 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.9845 - accuracy100: 0.4876 - val_loss: 3.2298 - val_accuracy100: 0.4443 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.9808 - accuracy100: 0.4890 - val_loss: 3.2198 - val_accuracy100: 0.4458 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.9778 - accuracy100: 0.4896 - val_loss: 3.2219 - val_accuracy100: 0.4464 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h100
Evaluating performance on  test set...
5760/5760 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9952042
{'0': {'precision': 0.5553016278327482, 'recall': 0.20364409338954997, 'f1-score': 0.29800259332279333, 'support': 427157}, '1': {'precision': 0.4866584137178717, 'recall': 0.9329489221919894, 'f1-score': 0.6396521503782656, 'support': 638379}, '2': {'precision': 0.5522486491086245, 'recall': 0.126960294034935, 'f1-score': 0.20645679530284744, 'support': 408931}, 'accuracy': 0.4981332237344071, 'macro avg': {'precision': 0.5314028968864147, 'recall': 0.4211844365388248, 'f1-score': 0.38137051300130215, 'support': 1474467}, 'weighted avg': {'precision': 0.5247354340650509, 'recall': 0.4981332237344071, 'f1-score': 0.42053228564783063, 'support': 1474467}}
[[ 86988 315310  24859]
 [ 25569 595575  17235]
 [ 44093 312920  51918]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.081305
{'0': {'precision': 0.5135744643941366, 'recall': 0.2564063701025236, 'f1-score': 0.34204426472181104, 'support': 184738}, '1': {'precision': 0.3879261477677192, 'recall': 0.8724713967574784, 'f1-score': 0.5370598656777749, 'support': 182759}, '2': {'precision': 0.5496153768089468, 'recall': 0.1463405407450241, 'f1-score': 0.23113823567069267, 'support': 185041}, 'accuracy': 0.42331749128566726, 'macro avg': {'precision': 0.48370532965693425, 'recall': 0.42507276920167536, 'f1-score': 0.3700807886900928, 'support': 552538}, 'weighted avg': {'precision': 0.48408452121524476, 'recall': 0.42331749128566726, 'f1-score': 0.3694065342733405, 'support': 552538}}
[[ 47368 122920  14450]
 [ 15567 159452   7740]
 [ 29297 128665  27079]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0637237
{'0': {'precision': 0.5246253352263764, 'recall': 0.2372276832208637, 'f1-score': 0.32671827720359964, 'support': 70093}, '1': {'precision': 0.40981573982890973, 'recall': 0.8945766750407915, 'f1-score': 0.5621185737302066, 'support': 77222}, '2': {'precision': 0.5625146335752751, 'recall': 0.13722690275596172, 'f1-score': 0.22063043827628165, 'support': 70030}, 'accuracy': 0.43856081345326553, 'macro avg': {'precision': 0.49898523621018703, 'recall': 0.4230104203392056, 'f1-score': 0.36982242973669593, 'support': 217345}, 'weighted avg': {'precision': 0.4960420275247509, 'recall': 0.43856081345326553, 'f1-score': 0.376173062629064, 'support': 217345}}
[[16628 48523  4942]
 [ 5609 69081  2532]
 [ 9458 50962  9610]]
training model: results/AAL/W3/deepOF_L2/h200
Epoch 1/50
2159/2159 - 61s - loss: 3.2721 - accuracy200: 0.3805 - val_loss: 3.3186 - val_accuracy200: 0.3514 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 58s - loss: 3.2485 - accuracy200: 0.3937 - val_loss: 3.3075 - val_accuracy200: 0.3558 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 3.2360 - accuracy200: 0.4009 - val_loss: 3.2980 - val_accuracy200: 0.3611 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 3.2260 - accuracy200: 0.4064 - val_loss: 3.2937 - val_accuracy200: 0.3635 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2190 - accuracy200: 0.4095 - val_loss: 3.2967 - val_accuracy200: 0.3666 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 3.2133 - accuracy200: 0.4126 - val_loss: 3.3060 - val_accuracy200: 0.3674 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 59s - loss: 3.2085 - accuracy200: 0.4145 - val_loss: 3.3024 - val_accuracy200: 0.3682 - 59s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 59s - loss: 3.2050 - accuracy200: 0.4154 - val_loss: 3.3050 - val_accuracy200: 0.3726 - 59s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 3.2004 - accuracy200: 0.4179 - val_loss: 3.3146 - val_accuracy200: 0.3743 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 59s - loss: 3.1978 - accuracy200: 0.4192 - val_loss: 3.3185 - val_accuracy200: 0.3729 - 59s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.1939 - accuracy200: 0.4204 - val_loss: 3.3172 - val_accuracy200: 0.3736 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 3.1897 - accuracy200: 0.4221 - val_loss: 3.3265 - val_accuracy200: 0.3724 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 3.1866 - accuracy200: 0.4241 - val_loss: 3.3293 - val_accuracy200: 0.3754 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 3.1836 - accuracy200: 0.4252 - val_loss: 3.3194 - val_accuracy200: 0.3765 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h200
Evaluating performance on  test set...
5760/5760 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0825131
{'0': {'precision': 0.45834602088520304, 'recall': 0.10485640585399435, 'f1-score': 0.17066871201447306, 'support': 488077}, '1': {'precision': 0.37635769254198054, 'recall': 0.8791040132345297, 'f1-score': 0.5270691354471939, 'support': 527106}, '2': {'precision': 0.45892357733463035, 'recall': 0.13148073958596423, 'f1-score': 0.20440098296066125, 'support': 459284}, 'accuracy': 0.38993480355952354, 'macro avg': {'precision': 0.4312090969206046, 'recall': 0.3718137195581628, 'f1-score': 0.30071294347410943, 'support': 1474467}, 'weighted avg': {'precision': 0.42921598449689197, 'recall': 0.38993480355952354, 'f1-score': 0.30858532454169596, 'support': 1474467}}
[[ 51178 403673  33226]
 [ 25754 463381  37971]
 [ 34726 364171  60387]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1035731
{'0': {'precision': 0.3968012185833968, 'recall': 0.1412858367050299, 'f1-score': 0.20837666181387685, 'support': 184378}, '1': {'precision': 0.33668655633184963, 'recall': 0.7948791636617992, 'f1-score': 0.473017383939015, 'support': 184423}, '2': {'precision': 0.4281163811521579, 'recall': 0.1199649499012175, 'f1-score': 0.1874136457744353, 'support': 183737}, 'accuracy': 0.35234861674672147, 'macro avg': {'precision': 0.38720138535580145, 'recall': 0.3520433167560155, 'f1-score': 0.2896025638424424, 'support': 552538}, 'weighted avg': {'precision': 0.38714980577283786, 'recall': 0.35234861674672147, 'f1-score': 0.28973605106573913, 'support': 552538}}
[[ 26050 145738  12590]
 [ 20975 146594  16854]
 [ 18625 143070  22042]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978543
{'0': {'precision': 0.44275420336269017, 'recall': 0.14946147920917852, 'f1-score': 0.2234817486537548, 'support': 73999}, '1': {'precision': 0.3396944992200606, 'recall': 0.819392579761178, 'f1-score': 0.48027996704311854, 'support': 70429}, '2': {'precision': 0.45533807829181494, 'recall': 0.1403787868398316, 'f1-score': 0.2145979433315513, 'support': 72917}, 'accuracy': 0.3635004255906508, 'macro avg': {'precision': 0.41259559362485526, 'recall': 0.36974428193672937, 'f1-score': 0.30611988634280823, 'support': 217345}, 'weighted avg': {'precision': 0.41358024723370507, 'recall': 0.3635004255906508, 'f1-score': 0.3037148402374829, 'support': 217345}}
[[11060 56994  5945]
 [ 6421 57709  6299]
 [ 7499 55182 10236]]
training model: results/AAL/W3/deepOF_L2/h300
Epoch 1/50
2159/2159 - 62s - loss: 3.2834 - accuracy300: 0.3747 - val_loss: 3.3070 - val_accuracy300: 0.3495 - 62s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 58s - loss: 3.2613 - accuracy300: 0.3868 - val_loss: 3.2963 - val_accuracy300: 0.3511 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 59s - loss: 3.2512 - accuracy300: 0.3936 - val_loss: 3.2873 - val_accuracy300: 0.3547 - 59s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.2434 - accuracy300: 0.3995 - val_loss: 3.2853 - val_accuracy300: 0.3566 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2369 - accuracy300: 0.4035 - val_loss: 3.2829 - val_accuracy300: 0.3594 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 3.2314 - accuracy300: 0.4063 - val_loss: 3.2822 - val_accuracy300: 0.3638 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 3.2263 - accuracy300: 0.4096 - val_loss: 3.2833 - val_accuracy300: 0.3664 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 3.2230 - accuracy300: 0.4114 - val_loss: 3.2884 - val_accuracy300: 0.3687 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 59s - loss: 3.2186 - accuracy300: 0.4147 - val_loss: 3.2995 - val_accuracy300: 0.3676 - 59s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2152 - accuracy300: 0.4164 - val_loss: 3.2943 - val_accuracy300: 0.3723 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.2128 - accuracy300: 0.4176 - val_loss: 3.2988 - val_accuracy300: 0.3718 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 3.2101 - accuracy300: 0.4195 - val_loss: 3.3001 - val_accuracy300: 0.3729 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 3.2091 - accuracy300: 0.4203 - val_loss: 3.3012 - val_accuracy300: 0.3762 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 3.2051 - accuracy300: 0.4220 - val_loss: 3.3273 - val_accuracy300: 0.3703 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 3.2032 - accuracy300: 0.4234 - val_loss: 3.3128 - val_accuracy300: 0.3734 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 58s - loss: 3.1999 - accuracy300: 0.4252 - val_loss: 3.3254 - val_accuracy300: 0.3728 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h300
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0785221
{'0': {'precision': 0.4119961316980966, 'recall': 0.07940323670382317, 'f1-score': 0.1331455775886409, 'support': 472147}, '1': {'precision': 0.3861638510682652, 'recall': 0.8386455916215866, 'f1-score': 0.5288244849432019, 'support': 563257}, '2': {'precision': 0.4034676020121578, 'recall': 0.14723627360993752, 'f1-score': 0.21574232131742782, 'support': 439063}, 'accuracy': 0.38963842527503156, 'macro avg': {'precision': 0.40054252825950654, 'recall': 0.3550950339784491, 'f1-score': 0.29257079461642355, 'support': 1474467}, 'weighted avg': {'precision': 0.39958841099616543, 'recall': 0.38963842527503156, 'f1-score': 0.3088932127758647, 'support': 1474467}}
[[ 37490 397447  37210]
 [ 32514 472373  58370]
 [ 20992 353425  64646]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100167
{'0': {'precision': 0.43131194713844184, 'recall': 0.08750317569284158, 'f1-score': 0.14548984186472896, 'support': 184999}, '1': {'precision': 0.3354173722006582, 'recall': 0.8488517745302714, 'f1-score': 0.48083602006647325, 'support': 182020}, '2': {'precision': 0.44284610573562416, 'recall': 0.1297656843773414, 'f1-score': 0.2007161884434365, 'support': 185519}, 'accuracy': 0.35250064248974733, 'macro avg': {'precision': 0.40319180835824137, 'recall': 0.3553735448668181, 'f1-score': 0.2756806834582129, 'support': 552538}, 'weighted avg': {'precision': 0.40359453229749925, 'recall': 0.35250064248974733, 'f1-score': 0.27450404169753095, 'support': 552538}}
[[ 16188 155102  13709]
 [ 10933 154508  16579]
 [ 10411 151034  24074]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0949706
{'0': {'precision': 0.41894050312791165, 'recall': 0.0876411377337213, 'f1-score': 0.14495757198945344, 'support': 71827}, '1': {'precision': 0.3511570154644994, 'recall': 0.8253366054254825, 'f1-score': 0.492689010749708, 'support': 75385}, '2': {'precision': 0.4193086439396953, 'recall': 0.15030014401209132, 'f1-score': 0.2212822235284239, 'support': 70133}, 'accuracy': 0.36372587361107916, 'macro avg': {'precision': 0.39646872084403545, 'recall': 0.3544259623904317, 'f1-score': 0.2863096020891951, 'support': 217345}, 'weighted avg': {'precision': 0.3955489394942715, 'recall': 0.36372587361107916, 'f1-score': 0.290194919512168, 'support': 217345}}
[[ 6295 59334  6198]
 [ 4767 62218  8400]
 [ 3964 55628 10541]]
training model: results/AAL/W3/deepOF_L2/h500
Epoch 1/50
2159/2159 - 62s - loss: 3.2691 - accuracy500: 0.3866 - val_loss: 3.2937 - val_accuracy500: 0.3484 - 62s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 59s - loss: 3.2588 - accuracy500: 0.3904 - val_loss: 3.2847 - val_accuracy500: 0.3697 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 59s - loss: 3.2556 - accuracy500: 0.3924 - val_loss: 3.2821 - val_accuracy500: 0.3746 - 59s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 3.2536 - accuracy500: 0.3948 - val_loss: 3.2793 - val_accuracy500: 0.3789 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 59s - loss: 3.2503 - accuracy500: 0.3966 - val_loss: 3.2794 - val_accuracy500: 0.3769 - 59s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 59s - loss: 3.2471 - accuracy500: 0.3974 - val_loss: 3.2825 - val_accuracy500: 0.3716 - 59s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 3.2444 - accuracy500: 0.3995 - val_loss: 3.2815 - val_accuracy500: 0.3732 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 3.2401 - accuracy500: 0.4006 - val_loss: 3.2808 - val_accuracy500: 0.3749 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 59s - loss: 3.2377 - accuracy500: 0.4020 - val_loss: 3.2819 - val_accuracy500: 0.3756 - 59s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2382 - accuracy500: 0.4026 - val_loss: 3.2810 - val_accuracy500: 0.3781 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.2351 - accuracy500: 0.4044 - val_loss: 3.2836 - val_accuracy500: 0.3747 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 59s - loss: 3.2311 - accuracy500: 0.4055 - val_loss: 3.2829 - val_accuracy500: 0.3777 - 59s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 3.2299 - accuracy500: 0.4068 - val_loss: 3.2867 - val_accuracy500: 0.3738 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 59s - loss: 3.2269 - accuracy500: 0.4085 - val_loss: 3.2857 - val_accuracy500: 0.3764 - 59s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h500
Evaluating performance on  test set...
5760/5760 - 72s - 72s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0918449
{'0': {'precision': 0.39610559517409694, 'recall': 0.475598680114319, 'f1-score': 0.4322275422782953, 'support': 525197}, '1': {'precision': 0.3503290026414308, 'recall': 0.2235493929087626, 'f1-score': 0.27293529941562117, 'support': 466322}, '2': {'precision': 0.36993871544048734, 'recall': 0.4184694832569966, 'f1-score': 0.39271043437370046, 'support': 482948}, 'accuracy': 0.37717222562458164, 'macro avg': {'precision': 0.37212443775200504, 'recall': 0.3725391854266927, 'f1-score': 0.3659577586892056, 'support': 1474467}, 'weighted avg': {'precision': 0.3730573516958738, 'recall': 0.37717222562458164, 'f1-score': 0.36890555168473427, 'support': 1474467}}
[[249783  98496 176918]
 [194789 104246 167287]
 [186025  94824 202099]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0928206
{'0': {'precision': 0.37206546133091256, 'recall': 0.47840089919699114, 'f1-score': 0.41858551853918236, 'support': 185054}, '1': {'precision': 0.35124574901714867, 'recall': 0.2394941399611889, 'f1-score': 0.2847997913984453, 'support': 182422}, '2': {'precision': 0.3791906967452277, 'recall': 0.3897450584128562, 'f1-score': 0.3843954433415495, 'support': 185062}, 'accuracy': 0.3698315771946907, 'macro avg': {'precision': 0.367500635697763, 'recall': 0.36921336585701203, 'f1-score': 0.3625935844263924, 'support': 552538}, 'weighted avg': {'precision': 0.36757823467237066, 'recall': 0.3698315771946907, 'f1-score': 0.36296446874226, 'support': 552538}}
[[88530 39545 56979]
 [77626 43689 61107]
 [71786 41149 72127]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937153
{'0': {'precision': 0.3955942699795356, 'recall': 0.4753701557873053, 'f1-score': 0.43182868136816316, 'support': 77670}, '1': {'precision': 0.33198438783894824, 'recall': 0.24923660590358102, 'f1-score': 0.2847201423512623, 'support': 64842}, '2': {'precision': 0.38743163595815855, 'recall': 0.39001510028997904, 'f1-score': 0.38871907568341485, 'support': 74833}, 'accuracy': 0.37851802433918424, 'macro avg': {'precision': 0.37167009792554745, 'recall': 0.3715406206602885, 'f1-score': 0.36842263313428014, 'support': 217345}, 'weighted avg': {'precision': 0.37380666792068135, 'recall': 0.37851802433918424, 'f1-score': 0.37309793987817874, 'support': 217345}}
[[36922 16370 24378]
 [26913 16161 21768]
 [29498 16149 29186]]
training model: results/AAL/W3/deepOF_L2/h1000
Epoch 1/50
2159/2159 - 61s - loss: 3.2664 - accuracy1000: 0.3909 - val_loss: 3.2528 - val_accuracy1000: 0.3863 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 58s - loss: 3.2534 - accuracy1000: 0.3917 - val_loss: 3.2481 - val_accuracy1000: 0.3937 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 3.2486 - accuracy1000: 0.3954 - val_loss: 3.2493 - val_accuracy1000: 0.3942 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.2417 - accuracy1000: 0.4001 - val_loss: 3.2497 - val_accuracy1000: 0.3945 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2386 - accuracy1000: 0.4018 - val_loss: 3.2492 - val_accuracy1000: 0.3945 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 3.2366 - accuracy1000: 0.4040 - val_loss: 3.2499 - val_accuracy1000: 0.3954 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 3.2352 - accuracy1000: 0.4056 - val_loss: 3.2494 - val_accuracy1000: 0.3968 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 59s - loss: 3.2339 - accuracy1000: 0.4071 - val_loss: 3.2492 - val_accuracy1000: 0.3971 - 59s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 3.2324 - accuracy1000: 0.4074 - val_loss: 3.2480 - val_accuracy1000: 0.3987 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2304 - accuracy1000: 0.4092 - val_loss: 3.2486 - val_accuracy1000: 0.3998 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.2286 - accuracy1000: 0.4103 - val_loss: 3.2483 - val_accuracy1000: 0.3999 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 3.2272 - accuracy1000: 0.4113 - val_loss: 3.2479 - val_accuracy1000: 0.3995 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 3.2258 - accuracy1000: 0.4122 - val_loss: 3.2466 - val_accuracy1000: 0.4016 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 3.2244 - accuracy1000: 0.4134 - val_loss: 3.2476 - val_accuracy1000: 0.4002 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 3.2230 - accuracy1000: 0.4142 - val_loss: 3.2489 - val_accuracy1000: 0.3994 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 58s - loss: 3.2213 - accuracy1000: 0.4157 - val_loss: 3.2496 - val_accuracy1000: 0.3987 - 58s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 58s - loss: 3.2191 - accuracy1000: 0.4175 - val_loss: 3.2494 - val_accuracy1000: 0.3990 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 3.2180 - accuracy1000: 0.4178 - val_loss: 3.2533 - val_accuracy1000: 0.3962 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 3.2161 - accuracy1000: 0.4190 - val_loss: 3.2550 - val_accuracy1000: 0.3967 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 60s - loss: 3.2141 - accuracy1000: 0.4204 - val_loss: 3.2564 - val_accuracy1000: 0.3964 - 60s/epoch - 28ms/step
Epoch 21/50
2159/2159 - 60s - loss: 3.2116 - accuracy1000: 0.4217 - val_loss: 3.2640 - val_accuracy1000: 0.3928 - 60s/epoch - 28ms/step
Epoch 22/50
2159/2159 - 59s - loss: 3.2097 - accuracy1000: 0.4223 - val_loss: 3.2707 - val_accuracy1000: 0.3875 - 59s/epoch - 28ms/step
Epoch 23/50
2159/2159 - 59s - loss: 3.2071 - accuracy1000: 0.4236 - val_loss: 3.2623 - val_accuracy1000: 0.3933 - 59s/epoch - 27ms/step
testing model: results/AAL/W3/deepOF_L2/h1000
Evaluating performance on  test set...
5760/5760 - 69s - 69s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0753895
{'0': {'precision': 0.4256256909784938, 'recall': 0.634781561385712, 'f1-score': 0.509576561425488, 'support': 589502}, '1': {'precision': 0.315383334258591, 'recall': 0.01635822820894534, 'f1-score': 0.031103202846975087, 'support': 347287}, '2': {'precision': 0.40109758759393416, 'recall': 0.4306294845613918, 'f1-score': 0.41533924573790254, 'support': 537678}, 'accuracy': 0.4146759473084172, 'macro avg': {'precision': 0.3807022042770063, 'recall': 0.3605897580520164, 'f1-score': 0.31867300333678855, 'support': 1474467}, 'weighted avg': {'precision': 0.3907154767045981, 'recall': 0.4146759473084172, 'f1-score': 0.3625153462847452, 'support': 1474467}}
[[374205   6539 208758]
 [204638   5681 136968]
 [300345   5793 231540]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1059414
{'0': {'precision': 0.35511818817314056, 'recall': 0.620666353114171, 'f1-score': 0.45175938222418965, 'support': 184977}, '1': {'precision': 0.3483766542892507, 'recall': 0.01999387998207709, 'f1-score': 0.0378173624999354, 'support': 183006}, '2': {'precision': 0.37249299386935, 'recall': 0.441483568583891, 'f1-score': 0.404064548763675, 'support': 184555}, 'accuracy': 0.3618683239885763, 'macro avg': {'precision': 0.3586626121105804, 'recall': 0.36071460056004634, 'f1-score': 0.2978804311626, 'support': 552538}, 'weighted avg': {'precision': 0.3586887409954058, 'recall': 0.3618683239885763, 'f1-score': 0.2987270238145198, 'support': 552538}}
[[114809   3365  66803]
 [108891   3659  70456]
 [ 99598   3479  81478]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0828668
{'0': {'precision': 0.4093438805674368, 'recall': 0.5884573382080623, 'f1-score': 0.4828244460676893, 'support': 84244}, '1': {'precision': 0.29638671875, 'recall': 0.022131879751335386, 'f1-score': 0.04118814568525335, 'support': 54853}, '2': {'precision': 0.39369241287998, 'recall': 0.46360290358859013, 'f1-score': 0.425797137172738, 'support': 78248}, 'accuracy': 0.4005797234811015, 'macro avg': {'precision': 0.36647433739913887, 'recall': 0.3580640405159959, 'f1-score': 0.31660324297522685, 'support': 217345}, 'weighted avg': {'precision': 0.3752012260744419, 'recall': 0.4005797234811015, 'f1-score': 0.35083452749910055, 'support': 217345}}
[[49574  1519 33151]
 [30923  1214 22716]
 [40609  1363 36276]]
training model: results/AAL/W3/deepVOL_L2/h10
Epoch 1/50
2159/2159 - 61s - loss: 2.7280 - accuracy10: 0.5040 - val_loss: 2.5301 - val_accuracy10: 0.6650 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 58s - loss: 2.5162 - accuracy10: 0.5693 - val_loss: 2.4227 - val_accuracy10: 0.6651 - 58s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.4365 - accuracy10: 0.5933 - val_loss: 2.4034 - val_accuracy10: 0.6829 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 2.3878 - accuracy10: 0.6034 - val_loss: 2.3823 - val_accuracy10: 0.6974 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 57s - loss: 2.3510 - accuracy10: 0.6085 - val_loss: 2.3702 - val_accuracy10: 0.7035 - 57s/epoch - 26ms/step
Epoch 6/50
2159/2159 - 57s - loss: 2.3224 - accuracy10: 0.6137 - val_loss: 2.3572 - val_accuracy10: 0.7146 - 57s/epoch - 26ms/step
Epoch 7/50
2159/2159 - 58s - loss: 2.3011 - accuracy10: 0.6169 - val_loss: 2.3398 - val_accuracy10: 0.7047 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 2.2845 - accuracy10: 0.6205 - val_loss: 2.3681 - val_accuracy10: 0.7169 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 57s - loss: 2.2725 - accuracy10: 0.6213 - val_loss: 2.3514 - val_accuracy10: 0.7148 - 57s/epoch - 26ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.2623 - accuracy10: 0.6235 - val_loss: 2.3445 - val_accuracy10: 0.7121 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.2528 - accuracy10: 0.6238 - val_loss: 2.3297 - val_accuracy10: 0.7124 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 57s - loss: 2.2450 - accuracy10: 0.6249 - val_loss: 2.3331 - val_accuracy10: 0.7135 - 57s/epoch - 26ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.2371 - accuracy10: 0.6260 - val_loss: 2.3417 - val_accuracy10: 0.7173 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.2325 - accuracy10: 0.6260 - val_loss: 2.3150 - val_accuracy10: 0.7174 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 2.2252 - accuracy10: 0.6273 - val_loss: 2.3539 - val_accuracy10: 0.7197 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 58s - loss: 2.2195 - accuracy10: 0.6283 - val_loss: 2.3404 - val_accuracy10: 0.7204 - 58s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 58s - loss: 2.2144 - accuracy10: 0.6292 - val_loss: 2.3384 - val_accuracy10: 0.7190 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 57s - loss: 2.2082 - accuracy10: 0.6293 - val_loss: 2.3325 - val_accuracy10: 0.7218 - 57s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 59s - loss: 2.2033 - accuracy10: 0.6311 - val_loss: 2.3311 - val_accuracy10: 0.7192 - 59s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 57s - loss: 2.1994 - accuracy10: 0.6303 - val_loss: 2.3339 - val_accuracy10: 0.7201 - 57s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 58s - loss: 2.1944 - accuracy10: 0.6315 - val_loss: 2.3472 - val_accuracy10: 0.7234 - 58s/epoch - 27ms/step
Epoch 22/50
2159/2159 - 58s - loss: 2.1902 - accuracy10: 0.6323 - val_loss: 2.3418 - val_accuracy10: 0.7227 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 59s - loss: 2.1867 - accuracy10: 0.6334 - val_loss: 2.3507 - val_accuracy10: 0.7199 - 59s/epoch - 27ms/step
Epoch 24/50
2159/2159 - 57s - loss: 2.1830 - accuracy10: 0.6335 - val_loss: 2.3530 - val_accuracy10: 0.7247 - 57s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h10
Evaluating performance on  test set...
5760/5760 - 68s - 68s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55039096
{'0': {'precision': 0.3929651214629046, 'recall': 0.6351809028437416, 'f1-score': 0.485541809696214, 'support': 152651}, '1': {'precision': 0.916428079374722, 'recall': 0.8104710076937511, 'f1-score': 0.8601989479657761, 'support': 1167051}, '2': {'precision': 0.43291311371490504, 'recall': 0.5471573764772015, 'f1-score': 0.483376667113799, 'support': 154769}, 'accuracy': 0.7646844190221442, 'macro avg': {'precision': 0.5807687715175106, 'recall': 0.6642697623382314, 'f1-score': 0.6097058082585964, 'support': 1474471}, 'weighted avg': {'precision': 0.8114817822224544, 'recall': 0.7646844190221442, 'f1-score': 0.7818574991348621, 'support': 1474471}}
[[ 96961  38109  17581]
 [127842 945861  93348]
 [ 21939  48147  84683]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6977867
{'0': {'precision': 0.41903644162247966, 'recall': 0.6092886782723992, 'f1-score': 0.49656310971034073, 'support': 81454}, '1': {'precision': 0.8606086668279267, 'recall': 0.7413621454755933, 'f1-score': 0.7965472064213337, 'support': 388725}, '2': {'precision': 0.45322450624748084, 'recall': 0.5461146187469645, 'f1-score': 0.495352422907489, 'support': 82360}, 'accuracy': 0.6927891062893298, 'macro avg': {'precision': 0.5776232048992958, 'recall': 0.632255147498319, 'f1-score': 0.5961542463463878, 'support': 552539}, 'weighted avg': {'precision': 0.7347895237497187, 'recall': 0.6927891062893298, 'f1-score': 0.7074289595940556, 'support': 552539}}
[[ 49629  22125   9700]
 [ 55977 288186  44562]
 [ 12830  24552  44978]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6455878
{'0': {'precision': 0.43031957452816866, 'recall': 0.6119402985074627, 'f1-score': 0.5053056261744224, 'support': 29882}, '1': {'precision': 0.8765881006533486, 'recall': 0.7675281433328048, 'f1-score': 0.8184409585673563, 'support': 157675}, '2': {'precision': 0.452586089745332, 'recall': 0.5590170538471868, 'f1-score': 0.5002027605473033, 'support': 29788}, 'accuracy': 0.7175596402033633, 'macro avg': {'precision': 0.5864979216422831, 'recall': 0.6461618318958181, 'f1-score': 0.6079831150963607, 'support': 217345}, 'weighted avg': {'precision': 0.7571210413761595, 'recall': 0.7175596402033633, 'f1-score': 0.7317732669011713, 'support': 217345}}
[[ 18286   8261   3335]
 [ 19849 121020  16806]
 [  4359   8777  16652]]
training model: results/AAL/W3/deepVOL_L2/h20
Epoch 1/50
2159/2159 - 62s - loss: 2.8184 - accuracy20: 0.5098 - val_loss: 2.7004 - val_accuracy20: 0.6527 - 62s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 59s - loss: 2.6114 - accuracy20: 0.5688 - val_loss: 2.7015 - val_accuracy20: 0.6612 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 57s - loss: 2.5536 - accuracy20: 0.5853 - val_loss: 2.6383 - val_accuracy20: 0.6768 - 57s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 2.5209 - accuracy20: 0.5936 - val_loss: 2.5964 - val_accuracy20: 0.6781 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 2.4951 - accuracy20: 0.5983 - val_loss: 2.5762 - val_accuracy20: 0.6726 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 57s - loss: 2.4686 - accuracy20: 0.6014 - val_loss: 2.5420 - val_accuracy20: 0.6754 - 57s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 59s - loss: 2.4488 - accuracy20: 0.6048 - val_loss: 2.5418 - val_accuracy20: 0.6752 - 59s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 59s - loss: 2.4345 - accuracy20: 0.6070 - val_loss: 2.5450 - val_accuracy20: 0.6795 - 59s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.4232 - accuracy20: 0.6083 - val_loss: 2.5330 - val_accuracy20: 0.6801 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 2.4128 - accuracy20: 0.6093 - val_loss: 2.5221 - val_accuracy20: 0.6799 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.4043 - accuracy20: 0.6110 - val_loss: 2.5315 - val_accuracy20: 0.6842 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.3957 - accuracy20: 0.6124 - val_loss: 2.5477 - val_accuracy20: 0.6887 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 57s - loss: 2.3896 - accuracy20: 0.6135 - val_loss: 2.5068 - val_accuracy20: 0.6851 - 57s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 2.3839 - accuracy20: 0.6143 - val_loss: 2.5327 - val_accuracy20: 0.6881 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 2.3770 - accuracy20: 0.6157 - val_loss: 2.5510 - val_accuracy20: 0.6908 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 57s - loss: 2.3726 - accuracy20: 0.6157 - val_loss: 2.5426 - val_accuracy20: 0.6893 - 57s/epoch - 26ms/step
Epoch 17/50
2159/2159 - 58s - loss: 2.3677 - accuracy20: 0.6161 - val_loss: 2.5294 - val_accuracy20: 0.6892 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 59s - loss: 2.3624 - accuracy20: 0.6173 - val_loss: 2.5336 - val_accuracy20: 0.6886 - 59s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 2.3586 - accuracy20: 0.6179 - val_loss: 2.5351 - val_accuracy20: 0.6872 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 57s - loss: 2.3550 - accuracy20: 0.6189 - val_loss: 2.5379 - val_accuracy20: 0.6864 - 57s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 57s - loss: 2.3496 - accuracy20: 0.6189 - val_loss: 2.5540 - val_accuracy20: 0.6921 - 57s/epoch - 27ms/step
Epoch 22/50
2159/2159 - 58s - loss: 2.3443 - accuracy20: 0.6194 - val_loss: 2.5334 - val_accuracy20: 0.6866 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 58s - loss: 2.3412 - accuracy20: 0.6207 - val_loss: 2.5403 - val_accuracy20: 0.6853 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h20
Evaluating performance on  test set...
5760/5760 - 66s - 66s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61498016
{'0': {'precision': 0.48936282857873975, 'recall': 0.5286189509403029, 'f1-score': 0.5082339787941825, 'support': 209826}, '1': {'precision': 0.8492792863155519, 'recall': 0.8337806176783813, 'f1-score': 0.84145859127803, 'support': 1056375}, '2': {'precision': 0.47989711270145596, 'recall': 0.4855332020934364, 'f1-score': 0.4826987059233483, 'support': 208270}, 'accuracy': 0.7411641191993603, 'macro avg': {'precision': 0.6061797425319159, 'recall': 0.6159775902373735, 'f1-score': 0.6107970919985203, 'support': 1474471}, 'weighted avg': {'precision': 0.7458855566594975, 'recall': 0.7411641191993603, 'f1-score': 0.7433636752967354, 'support': 1474471}}
[[110918  75844  23064]
 [ 89060 880785  86530]
 [ 26680  80468 101122]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77290845
{'0': {'precision': 0.5039588463052294, 'recall': 0.5058898118200529, 'f1-score': 0.5049224829306542, 'support': 108832}, '1': {'precision': 0.7634491375379714, 'recall': 0.772661486784108, 'f1-score': 0.7680276880507416, 'support': 333727}, '2': {'precision': 0.509494390539721, 'recall': 0.488907074013457, 'f1-score': 0.4989884741736112, 'support': 109980}, 'accuracy': 0.6636364129952818, 'macro avg': {'precision': 0.5923007914609739, 'recall': 0.5891527908725392, 'f1-score': 0.590646215051669, 'support': 552539}, 'weighted avg': {'precision': 0.661789724446209, 'recall': 0.6636364129952818, 'f1-score': 0.6626537715926525, 'support': 552539}}
[[ 55057  39708  14067]
 [ 38170 257858  37699]
 [ 16022  40188  53770]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7200587
{'0': {'precision': 0.5104945040932392, 'recall': 0.5022330389401847, 'f1-score': 0.5063300744937836, 'support': 39856}, '1': {'precision': 0.7862380024536335, 'recall': 0.7916079343166461, 'f1-score': 0.788913830557567, 'support': 137630}, '2': {'precision': 0.5045748660398341, 'recall': 0.5008404626307735, 'f1-score': 0.5027007290079699, 'support': 39859}, 'accuracy': 0.6852193517219167, 'macro avg': {'precision': 0.6004357908622356, 'recall': 0.5982271452958682, 'f1-score': 0.5993148780197736, 'support': 217345}, 'weighted avg': {'precision': 0.6840187481576087, 'recall': 0.6852193517219167, 'f1-score': 0.6846058124465291, 'support': 217345}}
[[ 20017  15053   4786]
 [ 13866 108949  14815]
 [  5328  14568  19963]]
training model: results/AAL/W3/deepVOL_L2/h30
Epoch 1/50
2159/2159 - 63s - loss: 2.9254 - accuracy30: 0.4943 - val_loss: 2.7878 - val_accuracy30: 0.6046 - 63s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 59s - loss: 2.7187 - accuracy30: 0.5559 - val_loss: 2.8204 - val_accuracy30: 0.6133 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.6636 - accuracy30: 0.5698 - val_loss: 2.8477 - val_accuracy30: 0.6204 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 2.6381 - accuracy30: 0.5766 - val_loss: 2.7725 - val_accuracy30: 0.6174 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 2.6137 - accuracy30: 0.5804 - val_loss: 2.7974 - val_accuracy30: 0.6239 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 57s - loss: 2.5920 - accuracy30: 0.5829 - val_loss: 2.7879 - val_accuracy30: 0.6284 - 57s/epoch - 26ms/step
Epoch 7/50
2159/2159 - 57s - loss: 2.5774 - accuracy30: 0.5855 - val_loss: 2.7364 - val_accuracy30: 0.6318 - 57s/epoch - 26ms/step
Epoch 8/50
2159/2159 - 59s - loss: 2.5632 - accuracy30: 0.5873 - val_loss: 2.7476 - val_accuracy30: 0.6370 - 59s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.5528 - accuracy30: 0.5899 - val_loss: 2.7189 - val_accuracy30: 0.6358 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 59s - loss: 2.5444 - accuracy30: 0.5905 - val_loss: 2.7126 - val_accuracy30: 0.6364 - 59s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 2.5369 - accuracy30: 0.5924 - val_loss: 2.7063 - val_accuracy30: 0.6332 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.5309 - accuracy30: 0.5934 - val_loss: 2.6980 - val_accuracy30: 0.6340 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 57s - loss: 2.5238 - accuracy30: 0.5941 - val_loss: 2.7133 - val_accuracy30: 0.6355 - 57s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 57s - loss: 2.5183 - accuracy30: 0.5950 - val_loss: 2.7181 - val_accuracy30: 0.6361 - 57s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 57s - loss: 2.5147 - accuracy30: 0.5962 - val_loss: 2.7187 - val_accuracy30: 0.6353 - 57s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 60s - loss: 2.5089 - accuracy30: 0.5970 - val_loss: 2.7197 - val_accuracy30: 0.6388 - 60s/epoch - 28ms/step
Epoch 17/50
2159/2159 - 60s - loss: 2.5039 - accuracy30: 0.5977 - val_loss: 2.7089 - val_accuracy30: 0.6380 - 60s/epoch - 28ms/step
Epoch 18/50
2159/2159 - 59s - loss: 2.4995 - accuracy30: 0.5982 - val_loss: 2.7147 - val_accuracy30: 0.6385 - 59s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 59s - loss: 2.4950 - accuracy30: 0.5993 - val_loss: 2.7142 - val_accuracy30: 0.6377 - 59s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 58s - loss: 2.4923 - accuracy30: 0.5991 - val_loss: 2.7059 - val_accuracy30: 0.6403 - 58s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 57s - loss: 2.4878 - accuracy30: 0.6002 - val_loss: 2.7070 - val_accuracy30: 0.6385 - 57s/epoch - 27ms/step
Epoch 22/50
2159/2159 - 57s - loss: 2.4843 - accuracy30: 0.6006 - val_loss: 2.7149 - val_accuracy30: 0.6359 - 57s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h30
Evaluating performance on  test set...
5760/5760 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70539963
{'0': {'precision': 0.4839069629958063, 'recall': 0.5168002399188696, 'f1-score': 0.4998129999389388, 'support': 253419}, '1': {'precision': 0.7926983883439088, 'recall': 0.8084585719197896, 'f1-score': 0.8005009164099564, 'support': 971346}, '2': {'precision': 0.5024300082563987, 'recall': 0.42891240098355665, 'f1-score': 0.4627695657997641, 'support': 249706}, 'accuracy': 0.6940536639920352, 'macro avg': {'precision': 0.5930117865320379, 'recall': 0.5847237376074053, 'f1-score': 0.5876944940495531, 'support': 1474471}, 'weighted avg': {'precision': 0.690468252696329, 'recall': 0.6940536639920352, 'f1-score': 0.6916255463690145, 'support': 1474471}}
[[130967  99262  23190]
 [103177 785293  82876]
 [ 36501 106103 107102]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.86068755
{'0': {'precision': 0.49747419964669787, 'recall': 0.49977427339383845, 'f1-score': 0.49862158405230994, 'support': 128474}, '1': {'precision': 0.6907447507283453, 'recall': 0.7467916155579039, 'f1-score': 0.7176756017201802, 'support': 294307}, '2': {'precision': 0.5314007826450363, 'recall': 0.4311718737958353, 'f1-score': 0.47606810697662544, 'support': 129758}, 'accuracy': 0.6152362095707271, 'macro avg': {'precision': 0.5732065776733598, 'recall': 0.5592459209158592, 'f1-score': 0.5641217642497053, 'support': 552539}, 'weighted avg': {'precision': 0.6083860477404701, 'recall': 0.6152362095707271, 'f1-score': 0.6100031095181888, 'support': 552539}}
[[ 64208  48340  15926]
 [ 41111 219786  33410]
 [ 23749  50061  55948]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8155368
{'0': {'precision': 0.49646666088615277, 'recall': 0.4846682890699397, 'f1-score': 0.4904965359204172, 'support': 47255}, '1': {'precision': 0.7142596783257142, 'recall': 0.7651719761804041, 'f1-score': 0.7388397941950433, 'support': 122924}, '2': {'precision': 0.5272851468616389, 'recall': 0.4418861043972353, 'f1-score': 0.4808231345091299, 'support': 47166}, 'accuracy': 0.6340288481446548, 'macro avg': {'precision': 0.5793371620245019, 'recall': 0.5639087898825264, 'f1-score': 0.5700531548748634, 'support': 217345}, 'weighted avg': {'precision': 0.6263319606872084, 'recall': 0.6340288481446548, 'f1-score': 0.6288530245867558, 'support': 217345}}
[[22903 19024  5328]
 [15509 94058 13357]
 [ 7720 18604 20842]]
training model: results/AAL/W3/deepVOL_L2/h50
Epoch 1/50
2159/2159 - 63s - loss: 3.0299 - accuracy50: 0.4793 - val_loss: 3.0243 - val_accuracy50: 0.5450 - 63s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 57s - loss: 2.8818 - accuracy50: 0.5226 - val_loss: 3.0492 - val_accuracy50: 0.5475 - 57s/epoch - 26ms/step
Epoch 3/50
2159/2159 - 58s - loss: 2.8324 - accuracy50: 0.5334 - val_loss: 2.9814 - val_accuracy50: 0.5553 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 2.8083 - accuracy50: 0.5402 - val_loss: 2.9916 - val_accuracy50: 0.5577 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 60s - loss: 2.7935 - accuracy50: 0.5438 - val_loss: 3.0493 - val_accuracy50: 0.5581 - 60s/epoch - 28ms/step
Epoch 6/50
2159/2159 - 58s - loss: 2.7809 - accuracy50: 0.5461 - val_loss: 3.0108 - val_accuracy50: 0.5626 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 57s - loss: 2.7665 - accuracy50: 0.5486 - val_loss: 3.0135 - val_accuracy50: 0.5581 - 57s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 57s - loss: 2.7552 - accuracy50: 0.5502 - val_loss: 2.9807 - val_accuracy50: 0.5614 - 57s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 2.7483 - accuracy50: 0.5511 - val_loss: 2.9637 - val_accuracy50: 0.5631 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 57s - loss: 2.7403 - accuracy50: 0.5530 - val_loss: 3.0064 - val_accuracy50: 0.5610 - 57s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 57s - loss: 2.7347 - accuracy50: 0.5542 - val_loss: 3.0126 - val_accuracy50: 0.5626 - 57s/epoch - 26ms/step
Epoch 12/50
2159/2159 - 58s - loss: 2.7289 - accuracy50: 0.5557 - val_loss: 2.9924 - val_accuracy50: 0.5649 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 2.7232 - accuracy50: 0.5562 - val_loss: 2.9850 - val_accuracy50: 0.5637 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 59s - loss: 2.7182 - accuracy50: 0.5574 - val_loss: 2.9567 - val_accuracy50: 0.5661 - 59s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 2.7133 - accuracy50: 0.5584 - val_loss: 2.9940 - val_accuracy50: 0.5642 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 58s - loss: 2.7093 - accuracy50: 0.5595 - val_loss: 2.9611 - val_accuracy50: 0.5657 - 58s/epoch - 27ms/step
Epoch 17/50
2159/2159 - 57s - loss: 2.7051 - accuracy50: 0.5600 - val_loss: 2.9733 - val_accuracy50: 0.5670 - 57s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 2.7013 - accuracy50: 0.5607 - val_loss: 2.9668 - val_accuracy50: 0.5661 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 2.6975 - accuracy50: 0.5612 - val_loss: 2.9709 - val_accuracy50: 0.5660 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 58s - loss: 2.6930 - accuracy50: 0.5623 - val_loss: 2.9761 - val_accuracy50: 0.5657 - 58s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 57s - loss: 2.6894 - accuracy50: 0.5626 - val_loss: 2.9761 - val_accuracy50: 0.5668 - 57s/epoch - 26ms/step
Epoch 22/50
2159/2159 - 58s - loss: 2.6856 - accuracy50: 0.5635 - val_loss: 2.9565 - val_accuracy50: 0.5669 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 58s - loss: 2.6816 - accuracy50: 0.5642 - val_loss: 2.9801 - val_accuracy50: 0.5650 - 58s/epoch - 27ms/step
Epoch 24/50
2159/2159 - 58s - loss: 2.6783 - accuracy50: 0.5648 - val_loss: 2.9940 - val_accuracy50: 0.5664 - 58s/epoch - 27ms/step
Epoch 25/50
2159/2159 - 57s - loss: 2.6750 - accuracy50: 0.5661 - val_loss: 2.9710 - val_accuracy50: 0.5673 - 57s/epoch - 27ms/step
Epoch 26/50
2159/2159 - 58s - loss: 2.6707 - accuracy50: 0.5670 - val_loss: 2.9840 - val_accuracy50: 0.5653 - 58s/epoch - 27ms/step
Epoch 27/50
2159/2159 - 58s - loss: 2.6681 - accuracy50: 0.5671 - val_loss: 2.9922 - val_accuracy50: 0.5654 - 58s/epoch - 27ms/step
Epoch 28/50
2159/2159 - 58s - loss: 2.6649 - accuracy50: 0.5678 - val_loss: 2.9762 - val_accuracy50: 0.5664 - 58s/epoch - 27ms/step
Epoch 29/50
2159/2159 - 58s - loss: 2.6617 - accuracy50: 0.5681 - val_loss: 3.0010 - val_accuracy50: 0.5653 - 58s/epoch - 27ms/step
Epoch 30/50
2159/2159 - 57s - loss: 2.6583 - accuracy50: 0.5687 - val_loss: 2.9910 - val_accuracy50: 0.5657 - 57s/epoch - 27ms/step
Epoch 31/50
2159/2159 - 57s - loss: 2.6552 - accuracy50: 0.5694 - val_loss: 3.0195 - val_accuracy50: 0.5626 - 57s/epoch - 26ms/step
Epoch 32/50
2159/2159 - 57s - loss: 2.6522 - accuracy50: 0.5702 - val_loss: 3.0148 - val_accuracy50: 0.5653 - 57s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h50
Evaluating performance on  test set...
5760/5760 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8175663
{'0': {'precision': 0.5571470496350504, 'recall': 0.3642090866614889, 'f1-score': 0.4404768364584171, 'support': 323177}, '1': {'precision': 0.679994137362376, 'recall': 0.839227336707496, 'f1-score': 0.7512659327366666, 'support': 834775}, '2': {'precision': 0.5189563694431566, 'recall': 0.3819486349950556, 'f1-score': 0.44003457846125843, 'support': 316519}, 'accuracy': 0.6369497941973765, 'macro avg': {'precision': 0.585365852146861, 'recall': 0.5284616861213468, 'f1-score': 0.5439257825521141, 'support': 1474471}, 'weighted avg': {'precision': 0.6184989526252891, 'recall': 0.6369497941973765, 'f1-score': 0.6163358291321781, 'support': 1474471}}
[[117704 166379  39094]
 [ 61241 700566  72968]
 [ 32317 163308 120894]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9609524
{'0': {'precision': 0.5568532576958372, 'recall': 0.341307835379689, 'f1-score': 0.42321668456487543, 'support': 156457}, '1': {'precision': 0.556602017205051, 'recall': 0.7897190775681342, 'f1-score': 0.6529783025850727, 'support': 238500}, '2': {'precision': 0.5379522045765893, 'recall': 0.4036945844068485, 'f1-score': 0.4612523383459737, 'support': 157582}, 'accuracy': 0.5526542017848514, 'macro avg': {'precision': 0.5504691598258259, 'recall': 0.5115738324515572, 'f1-score': 0.5124824418319739, 'support': 552539}, 'weighted avg': {'precision': 0.5513543035773227, 'recall': 0.5526542017848514, 'f1-score': 0.5332394708151674, 'support': 552539}}
[[ 53400  76093  26964]
 [ 22477 188348  27675]
 [ 20019  73948  63615]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93317693
{'0': {'precision': 0.5594357628533938, 'recall': 0.32188266785634617, 'f1-score': 0.408643844419514, 'support': 58279}, '1': {'precision': 0.5804610491704417, 'recall': 0.8001207311159712, 'f1-score': 0.6728162368624709, 'support': 101051}, '2': {'precision': 0.5288845963793181, 'recall': 0.40587779022666554, 'f1-score': 0.4592878668188069, 'support': 58015}, 'accuracy': 0.566652096896639, 'macro avg': {'precision': 0.5562604694677179, 'recall': 0.5092937297329942, 'f1-score': 0.5135826493669307, 'support': 217345}, 'weighted avg': {'precision': 0.5610562293220519, 'recall': 0.566652096896639, 'f1-score': 0.5449846730019439, 'support': 217345}}
[[18759 30396  9124]
 [ 8347 80853 11851]
 [ 6426 28042 23547]]
training model: results/AAL/W3/deepVOL_L2/h100
Epoch 1/50
2159/2159 - 64s - loss: 3.1937 - accuracy100: 0.4211 - val_loss: 3.2318 - val_accuracy100: 0.4399 - 64s/epoch - 30ms/step
Epoch 2/50
2159/2159 - 57s - loss: 3.0908 - accuracy100: 0.4570 - val_loss: 3.2400 - val_accuracy100: 0.4405 - 57s/epoch - 26ms/step
Epoch 3/50
2159/2159 - 58s - loss: 3.0575 - accuracy100: 0.4654 - val_loss: 3.2380 - val_accuracy100: 0.4415 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.0396 - accuracy100: 0.4709 - val_loss: 3.2548 - val_accuracy100: 0.4444 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 57s - loss: 3.0307 - accuracy100: 0.4730 - val_loss: 3.2749 - val_accuracy100: 0.4411 - 57s/epoch - 26ms/step
Epoch 6/50
2159/2159 - 57s - loss: 3.0238 - accuracy100: 0.4759 - val_loss: 3.2583 - val_accuracy100: 0.4438 - 57s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 57s - loss: 3.0184 - accuracy100: 0.4769 - val_loss: 3.2505 - val_accuracy100: 0.4453 - 57s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 59s - loss: 3.0139 - accuracy100: 0.4787 - val_loss: 3.2647 - val_accuracy100: 0.4453 - 59s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 58s - loss: 3.0097 - accuracy100: 0.4801 - val_loss: 3.2858 - val_accuracy100: 0.4467 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.0063 - accuracy100: 0.4808 - val_loss: 3.2598 - val_accuracy100: 0.4472 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 59s - loss: 3.0031 - accuracy100: 0.4814 - val_loss: 3.2651 - val_accuracy100: 0.4472 - 59s/epoch - 28ms/step
testing model: results/AAL/W3/deepVOL_L2/h100
Evaluating performance on  test set...
5760/5760 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0217171
{'0': {'precision': 0.45479174332445904, 'recall': 0.29513765333832753, 'f1-score': 0.3579701462024004, 'support': 427160}, '1': {'precision': 0.5028341400642119, 'recall': 0.7877734073332613, 'f1-score': 0.613849445775603, 'support': 638379}, '2': {'precision': 0.46726151224015666, 'recall': 0.22525750002445394, 'f1-score': 0.30397478839077996, 'support': 408932}, 'accuracy': 0.489045901886168, 'macro avg': {'precision': 0.47496246520960916, 'recall': 0.4360561868986809, 'f1-score': 0.42526479345626117, 'support': 1474471}, 'weighted avg': {'precision': 0.4790503043477418, 'recall': 0.489045901886168, 'f1-score': 0.4537791120766834, 'support': 1474471}}
[[126071 256876  44213]
 [ 74671 502898  60810]
 [ 76464 240353  92115]]
Evaluating performance on  train set...
2159/2159 - 24s - 24s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0895402
{'0': {'precision': 0.44931777841009174, 'recall': 0.3588386789594425, 'f1-score': 0.3990133261137683, 'support': 184824}, '1': {'precision': 0.4050458067251725, 'recall': 0.6903775082810918, 'f1-score': 0.5105505989436242, 'support': 182645}, '2': {'precision': 0.48952736982643524, 'recall': 0.24764683633219864, 'f1-score': 0.3289043578105097, 'support': 185070}, 'accuracy': 0.4311876627713157, 'macro avg': {'precision': 0.44796365165389984, 'recall': 0.4322876745242443, 'f1-score': 0.41282276095596737, 'support': 552539}, 'weighted avg': {'precision': 0.44815140791865243, 'recall': 0.4311876627713157, 'f1-score': 0.41239999824392554, 'support': 552539}}
[[ 66322  93542  24960]
 [ 33718 126094  22833]
 [ 47566  91672  45832]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0785503
{'0': {'precision': 0.45033781160208125, 'recall': 0.3308279255508807, 'f1-score': 0.3814410103352162, 'support': 70115}, '1': {'precision': 0.42252483793010853, 'recall': 0.7125169803997671, 'f1-score': 0.5304758235407435, 'support': 77295}, '2': {'precision': 0.47999549194184604, 'recall': 0.2435976263673411, 'f1-score': 0.3231809688220285, 'support': 69935}, 'accuracy': 0.4385010007131519, 'macro avg': {'precision': 0.45095271382467866, 'recall': 0.4289808441059963, 'f1-score': 0.41169926756599606, 'support': 217345}, 'weighted avg': {'precision': 0.4499895453644697, 'recall': 0.4385010007131519, 'f1-score': 0.41569636418967093, 'support': 217345}}
[[23196 37958  8961]
 [12726 55074  9495]
 [15586 37313 17036]]
training model: results/AAL/W3/deepVOL_L2/h200
Epoch 1/50
2159/2159 - 61s - loss: 3.2802 - accuracy200: 0.3754 - val_loss: 3.3204 - val_accuracy200: 0.3346 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 57s - loss: 3.2505 - accuracy200: 0.3921 - val_loss: 3.3144 - val_accuracy200: 0.3524 - 57s/epoch - 26ms/step
Epoch 3/50
2159/2159 - 57s - loss: 3.2394 - accuracy200: 0.3996 - val_loss: 3.3070 - val_accuracy200: 0.3624 - 57s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.2323 - accuracy200: 0.4042 - val_loss: 3.3105 - val_accuracy200: 0.3613 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2260 - accuracy200: 0.4069 - val_loss: 3.3074 - val_accuracy200: 0.3771 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 58s - loss: 3.2201 - accuracy200: 0.4094 - val_loss: 3.2822 - val_accuracy200: 0.3927 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 57s - loss: 3.2132 - accuracy200: 0.4120 - val_loss: 3.2841 - val_accuracy200: 0.3914 - 57s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 58s - loss: 3.2076 - accuracy200: 0.4138 - val_loss: 3.3102 - val_accuracy200: 0.3841 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 57s - loss: 3.2059 - accuracy200: 0.4159 - val_loss: 3.3127 - val_accuracy200: 0.3893 - 57s/epoch - 26ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.1987 - accuracy200: 0.4193 - val_loss: 3.3332 - val_accuracy200: 0.3883 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.1910 - accuracy200: 0.4222 - val_loss: 3.3453 - val_accuracy200: 0.3849 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 58s - loss: 3.1898 - accuracy200: 0.4233 - val_loss: 3.2889 - val_accuracy200: 0.3933 - 58s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 58s - loss: 3.1866 - accuracy200: 0.4250 - val_loss: 3.2976 - val_accuracy200: 0.3915 - 58s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 58s - loss: 3.1830 - accuracy200: 0.4264 - val_loss: 3.2673 - val_accuracy200: 0.3950 - 58s/epoch - 27ms/step
Epoch 15/50
2159/2159 - 58s - loss: 3.1801 - accuracy200: 0.4286 - val_loss: 3.2780 - val_accuracy200: 0.3898 - 58s/epoch - 27ms/step
Epoch 16/50
2159/2159 - 57s - loss: 3.1745 - accuracy200: 0.4306 - val_loss: 3.3073 - val_accuracy200: 0.3863 - 57s/epoch - 26ms/step
Epoch 17/50
2159/2159 - 58s - loss: 3.1689 - accuracy200: 0.4328 - val_loss: 3.3157 - val_accuracy200: 0.3852 - 58s/epoch - 27ms/step
Epoch 18/50
2159/2159 - 58s - loss: 3.1636 - accuracy200: 0.4346 - val_loss: 3.3320 - val_accuracy200: 0.3836 - 58s/epoch - 27ms/step
Epoch 19/50
2159/2159 - 58s - loss: 3.1584 - accuracy200: 0.4363 - val_loss: 3.3293 - val_accuracy200: 0.3829 - 58s/epoch - 27ms/step
Epoch 20/50
2159/2159 - 57s - loss: 3.1546 - accuracy200: 0.4381 - val_loss: 3.3385 - val_accuracy200: 0.3834 - 57s/epoch - 27ms/step
Epoch 21/50
2159/2159 - 57s - loss: 3.1516 - accuracy200: 0.4389 - val_loss: 3.3364 - val_accuracy200: 0.3806 - 57s/epoch - 26ms/step
Epoch 22/50
2159/2159 - 58s - loss: 3.1478 - accuracy200: 0.4401 - val_loss: 3.3650 - val_accuracy200: 0.3787 - 58s/epoch - 27ms/step
Epoch 23/50
2159/2159 - 57s - loss: 3.1443 - accuracy200: 0.4420 - val_loss: 3.3596 - val_accuracy200: 0.3774 - 57s/epoch - 26ms/step
Epoch 24/50
2159/2159 - 58s - loss: 3.1424 - accuracy200: 0.4426 - val_loss: 3.3595 - val_accuracy200: 0.3785 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h200
Evaluating performance on  test set...
5760/5760 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0689111
{'0': {'precision': 0.4185530474761342, 'recall': 0.4297492214391083, 'f1-score': 0.4240772490537961, 'support': 488080}, '1': {'precision': 0.4070640942679414, 'recall': 0.5919348443484909, 'f1-score': 0.4823937483138181, 'support': 527107}, '2': {'precision': 0.4231745463863198, 'recall': 0.1905770721383719, 'f1-score': 0.2628013144719519, 'support': 459284}, 'accuracy': 0.4132288800525748, 'macro avg': {'precision': 0.4162638960434652, 'recall': 0.4040870459753237, 'f1-score': 0.38975743727985535, 'support': 1474471}, 'weighted avg': {'precision': 0.4158854282735557, 'recall': 0.4132288800525748, 'f1-score': 0.39468879627104536, 'support': 1474471}}
[[209752 226307  52021]
 [147805 312013  67289]
 [143579 228176  87529]]
Evaluating performance on  train set...
2159/2159 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089275
{'0': {'precision': 0.3903262969949832, 'recall': 0.4611338557058808, 'f1-score': 0.4227858925535194, 'support': 184415}, '1': {'precision': 0.3524531710563849, 'recall': 0.48246912776792544, 'f1-score': 0.4073379624860061, 'support': 184389}, '2': {'precision': 0.429250443704262, 'recall': 0.19218439600511605, 'f1-score': 0.2654992349537777, 'support': 183735}, 'accuracy': 0.3788203185657483, 'macro avg': {'precision': 0.3906766372518768, 'recall': 0.3785957931596407, 'f1-score': 0.3652076966644344, 'support': 552539}, 'weighted avg': {'precision': 0.39063096377314205, 'recall': 0.3788203185657483, 'f1-score': 0.3653284236485059, 'support': 552539}}
[[85040 77970 21405]
 [69881 88962 25546]
 [62948 85476 35311]]
Evaluating performance on  val set...
850/850 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888795
{'0': {'precision': 0.4153584577623236, 'recall': 0.4393287900914057, 'f1-score': 0.42700749112892633, 'support': 73956}, '1': {'precision': 0.36432648241347315, 'recall': 0.5515294251177573, 'f1-score': 0.43879560910912324, 'support': 70484}, '2': {'precision': 0.43581122763726093, 'recall': 0.19380015088128386, 'f1-score': 0.26829337764063615, 'support': 72905}, 'accuracy': 0.3933561848673767, 'macro avg': {'precision': 0.40516538927101925, 'recall': 0.39488612203014894, 'f1-score': 0.37803215929289524, 'support': 217345}, 'weighted avg': {'precision': 0.4056695826432454, 'recall': 0.3933561848673767, 'f1-score': 0.3775921434735968, 'support': 217345}}
[[32491 32683  8782]
 [22101 38874  9509]
 [23632 35144 14129]]
training model: results/AAL/W3/deepVOL_L2/h300
Epoch 1/50
2159/2159 - 61s - loss: 3.2952 - accuracy300: 0.3644 - val_loss: 3.3168 - val_accuracy300: 0.3567 - 61s/epoch - 28ms/step
Epoch 2/50
2159/2159 - 57s - loss: 3.2628 - accuracy300: 0.3862 - val_loss: 3.3385 - val_accuracy300: 0.3633 - 57s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 58s - loss: 3.2469 - accuracy300: 0.3976 - val_loss: 3.3597 - val_accuracy300: 0.3673 - 58s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 57s - loss: 3.2381 - accuracy300: 0.4033 - val_loss: 3.3632 - val_accuracy300: 0.3654 - 57s/epoch - 26ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2316 - accuracy300: 0.4065 - val_loss: 3.3560 - val_accuracy300: 0.3716 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 57s - loss: 3.2283 - accuracy300: 0.4083 - val_loss: 3.3471 - val_accuracy300: 0.3665 - 57s/epoch - 26ms/step
Epoch 7/50
2159/2159 - 57s - loss: 3.2233 - accuracy300: 0.4117 - val_loss: 3.3555 - val_accuracy300: 0.3701 - 57s/epoch - 26ms/step
Epoch 8/50
2159/2159 - 57s - loss: 3.2190 - accuracy300: 0.4136 - val_loss: 3.3798 - val_accuracy300: 0.3668 - 57s/epoch - 26ms/step
Epoch 9/50
2159/2159 - 58s - loss: 3.2151 - accuracy300: 0.4155 - val_loss: 3.3778 - val_accuracy300: 0.3705 - 58s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2109 - accuracy300: 0.4178 - val_loss: 3.3881 - val_accuracy300: 0.3658 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 57s - loss: 3.2070 - accuracy300: 0.4197 - val_loss: 3.4015 - val_accuracy300: 0.3675 - 57s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h300
Evaluating performance on  test set...
5760/5760 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961946
{'0': {'precision': 0.3798138996482792, 'recall': 0.07227379492490718, 'f1-score': 0.12143923500826521, 'support': 472149}, '1': {'precision': 0.38329960036805755, 'recall': 0.8039037103712502, 'f1-score': 0.519095538451309, 'support': 563259}, '2': {'precision': 0.34404545230950856, 'recall': 0.1592960463532568, 'f1-score': 0.21776499837316865, 'support': 439063}, 'accuracy': 0.3776751119554064, 'macro avg': {'precision': 0.36905298410861515, 'recall': 0.34515785054980475, 'f1-score': 0.2860999239442476, 'support': 1474471}, 'weighted avg': {'precision': 0.37049445593444486, 'recall': 0.3776751119554064, 'f1-score': 0.30203049143942595, 'support': 1474471}}
[[ 34124 382124  55901]
 [ 33005 452806  77448]
 [ 22715 346407  69941]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1138055
{'0': {'precision': 0.4031067570287862, 'recall': 0.06495718178279486, 'f1-score': 0.11188505126318828, 'support': 184968}, '1': {'precision': 0.33259980929846555, 'recall': 0.8274614244138159, 'f1-score': 0.4744810083536165, 'support': 182110}, '2': {'precision': 0.3901161205127101, 'recall': 0.1465483309159338, 'f1-score': 0.2130600086230549, 'support': 185461}, 'accuracy': 0.3436553799822275, 'macro avg': {'precision': 0.37527422894665396, 'recall': 0.34632231237084815, 'f1-score': 0.26647535607995326, 'support': 552539}, 'weighted avg': {'precision': 0.3755082043653965, 'recall': 0.3436553799822275, 'f1-score': 0.26535179028551265, 'support': 552539}}
[[ 12015 152995  19958]
 [  8889 150689  22532]
 [  8902 149380  27179]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062403
{'0': {'precision': 0.39386687937605247, 'recall': 0.06190277197381251, 'f1-score': 0.10699023750195612, 'support': 71790}, '1': {'precision': 0.35181195233282614, 'recall': 0.8396283927056828, 'f1-score': 0.4958558022681558, 'support': 75456}, '2': {'precision': 0.38941493456505005, 'recall': 0.14432445541305866, 'f1-score': 0.2105975291166644, 'support': 70099}, 'accuracy': 0.3584899583611309, 'macro avg': {'precision': 0.37836458875797624, 'recall': 0.3486185400308513, 'f1-score': 0.27114785629559207, 'support': 217345}, 'weighted avg': {'precision': 0.37783074578991, 'recall': 0.3584899583611309, 'f1-score': 0.27540914564292, 'support': 217345}}
[[ 4444 60038  7308]
 [ 3546 63355  8555]
 [ 3293 56689 10117]]
training model: results/AAL/W3/deepVOL_L2/h500
Epoch 1/50
2159/2159 - 62s - loss: 3.2704 - accuracy500: 0.3803 - val_loss: 3.2998 - val_accuracy500: 0.3234 - 62s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 59s - loss: 3.2655 - accuracy500: 0.3808 - val_loss: 3.3049 - val_accuracy500: 0.3537 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 57s - loss: 3.2579 - accuracy500: 0.3888 - val_loss: 3.3111 - val_accuracy500: 0.3418 - 57s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 58s - loss: 3.2554 - accuracy500: 0.3921 - val_loss: 3.3165 - val_accuracy500: 0.3566 - 58s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 58s - loss: 3.2458 - accuracy500: 0.3973 - val_loss: 3.3069 - val_accuracy500: 0.3610 - 58s/epoch - 27ms/step
Epoch 6/50
2159/2159 - 59s - loss: 3.2423 - accuracy500: 0.4021 - val_loss: 3.3163 - val_accuracy500: 0.3583 - 59s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 57s - loss: 3.2386 - accuracy500: 0.4043 - val_loss: 3.3186 - val_accuracy500: 0.3618 - 57s/epoch - 26ms/step
Epoch 8/50
2159/2159 - 58s - loss: 3.2314 - accuracy500: 0.4057 - val_loss: 3.3237 - val_accuracy500: 0.3556 - 58s/epoch - 27ms/step
Epoch 9/50
2159/2159 - 57s - loss: 3.2229 - accuracy500: 0.4096 - val_loss: 3.3661 - val_accuracy500: 0.3439 - 57s/epoch - 27ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2188 - accuracy500: 0.4109 - val_loss: 3.4085 - val_accuracy500: 0.3374 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.2143 - accuracy500: 0.4137 - val_loss: 3.3593 - val_accuracy500: 0.3482 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h500
Evaluating performance on  test set...
5760/5760 - 71s - 71s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999715
{'0': {'precision': 0.3528799785919862, 'recall': 0.24606101687170007, 'f1-score': 0.2899451098644069, 'support': 525199}, '1': {'precision': 0.31599589615719276, 'recall': 0.5739639133474295, 'f1-score': 0.4075919816223304, 'support': 466322}, '2': {'precision': 0.33266473231716187, 'recall': 0.17994823480691582, 'f1-score': 0.23355800653594774, 'support': 482950}, 'accuracy': 0.32811021715584776, 'macro avg': {'precision': 0.33384686902211363, 'recall': 0.3333243883420151, 'f1-score': 0.3103650326742284, 'support': 1474471}, 'weighted avg': {'precision': 0.3345935475414032, 'recall': 0.32811021715584776, 'f1-score': 0.3086834729650844, 'support': 1474471}}
[[129231 302295  93673]
 [118007 267652  80663]
 [118980 277064  86906]]
Evaluating performance on  train set...
2159/2159 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993471
{'0': {'precision': 0.33924097615291826, 'recall': 0.2173814337142301, 'f1-score': 0.2649720473465569, 'support': 185002}, '1': {'precision': 0.33324487734270164, 'recall': 0.6056615148525705, 'f1-score': 0.4299333754802315, 'support': 182460}, '2': {'precision': 0.34422770739521574, 'recall': 0.19041263906374103, 'f1-score': 0.24519401365087978, 'support': 185077}, 'accuracy': 0.3365662876285656, 'macro avg': {'precision': 0.33890452029694523, 'recall': 0.3378185292101805, 'f1-score': 0.31336647882588936, 'support': 552539}, 'weighted avg': {'precision': 0.3389312804920121, 'recall': 0.3365662876285656, 'f1-score': 0.3128209499380037, 'support': 552539}}
[[ 40216 110853  33933]
 [ 38748 110509  33203]
 [ 39583 110253  35241]]
Evaluating performance on  val set...
850/850 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004902
{'0': {'precision': 0.3643145721553622, 'recall': 0.21942270058708416, 'f1-score': 0.2738865274440954, 'support': 77672}, '1': {'precision': 0.3016755117513268, 'recall': 0.6134433053264472, 'f1-score': 0.40445201128249436, 'support': 64865}, '2': {'precision': 0.35591247672253257, 'recall': 0.18395091434071223, 'f1-score': 0.24254441624365483, 'support': 74808}, 'accuracy': 0.32480618371713177, 'macro avg': {'precision': 0.3406341868764072, 'recall': 0.3389389734180812, 'f1-score': 0.30696098499008156, 'support': 217345}, 'weighted avg': {'precision': 0.34272849192233695, 'recall': 0.32480618371713177, 'f1-score': 0.30206518098797813, 'support': 217345}}
[[17043 47103 13526]
 [13697 39791 11377]
 [16041 45006 13761]]
training model: results/AAL/W3/deepVOL_L2/h1000
Epoch 1/50
2159/2159 - 62s - loss: 3.2636 - accuracy1000: 0.3928 - val_loss: 3.2651 - val_accuracy1000: 0.3769 - 62s/epoch - 29ms/step
Epoch 2/50
2159/2159 - 59s - loss: 3.2689 - accuracy1000: 0.3797 - val_loss: 3.2507 - val_accuracy1000: 0.3901 - 59s/epoch - 27ms/step
Epoch 3/50
2159/2159 - 59s - loss: 3.2564 - accuracy1000: 0.3886 - val_loss: 3.2569 - val_accuracy1000: 0.3918 - 59s/epoch - 27ms/step
Epoch 4/50
2159/2159 - 59s - loss: 3.2453 - accuracy1000: 0.3943 - val_loss: 3.2607 - val_accuracy1000: 0.3901 - 59s/epoch - 27ms/step
Epoch 5/50
2159/2159 - 59s - loss: 3.2412 - accuracy1000: 0.3983 - val_loss: 3.2478 - val_accuracy1000: 0.3901 - 59s/epoch - 28ms/step
Epoch 6/50
2159/2159 - 58s - loss: 3.2380 - accuracy1000: 0.4026 - val_loss: 3.2594 - val_accuracy1000: 0.3954 - 58s/epoch - 27ms/step
Epoch 7/50
2159/2159 - 58s - loss: 3.2354 - accuracy1000: 0.4041 - val_loss: 3.2573 - val_accuracy1000: 0.3894 - 58s/epoch - 27ms/step
Epoch 8/50
2159/2159 - 56s - loss: 3.2324 - accuracy1000: 0.4058 - val_loss: 3.2556 - val_accuracy1000: 0.3951 - 56s/epoch - 26ms/step
Epoch 9/50
2159/2159 - 57s - loss: 3.2225 - accuracy1000: 0.4115 - val_loss: 3.2631 - val_accuracy1000: 0.3930 - 57s/epoch - 26ms/step
Epoch 10/50
2159/2159 - 58s - loss: 3.2194 - accuracy1000: 0.4139 - val_loss: 3.2818 - val_accuracy1000: 0.3909 - 58s/epoch - 27ms/step
Epoch 11/50
2159/2159 - 58s - loss: 3.2171 - accuracy1000: 0.4140 - val_loss: 3.2878 - val_accuracy1000: 0.3911 - 58s/epoch - 27ms/step
Epoch 12/50
2159/2159 - 57s - loss: 3.2099 - accuracy1000: 0.4185 - val_loss: 3.3129 - val_accuracy1000: 0.3829 - 57s/epoch - 27ms/step
Epoch 13/50
2159/2159 - 57s - loss: 3.2038 - accuracy1000: 0.4218 - val_loss: 3.3310 - val_accuracy1000: 0.3806 - 57s/epoch - 27ms/step
Epoch 14/50
2159/2159 - 57s - loss: 3.1977 - accuracy1000: 0.4232 - val_loss: 3.3481 - val_accuracy1000: 0.3851 - 57s/epoch - 26ms/step
Epoch 15/50
2159/2159 - 58s - loss: 3.1905 - accuracy1000: 0.4276 - val_loss: 3.3363 - val_accuracy1000: 0.3860 - 58s/epoch - 27ms/step
testing model: results/AAL/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
5760/5760 - 70s - 70s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0789613
{'0': {'precision': 0.40390108716334766, 'recall': 0.5869256188253176, 'f1-score': 0.478509297528519, 'support': 589504}, '1': {'precision': 0.0875, 'recall': 2.0156181612955243e-05, 'f1-score': 4.0303079155247464e-05, 'support': 347288}, '2': {'precision': 0.37783080105801947, 'recall': 0.4341028755075054, 'f1-score': 0.404016835188764, 'support': 537679}, 'accuracy': 0.39296127221220356, 'macro avg': {'precision': 0.2897439627404557, 'recall': 0.34034955017147867, 'f1-score': 0.2941888119321461, 'support': 1474471}, 'weighted avg': {'precision': 0.3198711224359225, 'recall': 0.39296127221220356, 'f1-score': 0.3386492576886661, 'support': 1474471}}
[[345995     44 243465]
 [206396      7 140885]
 [304242     29 233408]]
Evaluating performance on  train set...
2159/2159 - 26s - 26s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1069183
{'0': {'precision': 0.3460258596939802, 'recall': 0.6039244500151273, 'f1-score': 0.43996717485294606, 'support': 185096}, '1': {'precision': 0.3076923076923077, 'recall': 2.1867722148722378e-05, 'f1-score': 4.373233623606715e-05, 'support': 182918}, '2': {'precision': 0.3492537313432836, 'recall': 0.434331391410378, 'f1-score': 0.3871739130434782, 'support': 184525}, 'accuracy': 0.34736552532943377, 'macro avg': {'precision': 0.3343239662431905, 'recall': 0.3460925697158847, 'f1-score': 0.2757282734108868, 'support': 552539}, 'weighted avg': {'precision': 0.3344135144134584, 'recall': 0.34736552532943377, 'f1-score': 0.2766997984439259, 'support': 552539}}
[[111784      4  73308]
 [106892      4  76022]
 [104375      5  80145]]
Evaluating performance on  val set...
850/850 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0828675
{'0': {'precision': 0.3945221170895511, 'recall': 0.5970034073775066, 'f1-score': 0.4750882198717919, 'support': 84229}, '1': {'precision': 0.125, 'recall': 1.823785814593934e-05, 'f1-score': 3.647039515673152e-05, 'support': 54831}, '2': {'precision': 0.38321521156221144, 'recall': 0.4399693427859743, 'f1-score': 0.409635831688114, 'support': 78285}, 'accuracy': 0.3898364351606892, 'macro avg': {'precision': 0.3009124428839209, 'recall': 0.3456636626738756, 'f1-score': 0.2949201739850209, 'support': 217345}, 'weighted avg': {'precision': 0.3224554567047023, 'recall': 0.3898364351606892, 'f1-score': 0.33166875917790606, 'support': 217345}}
[[50285     4 33940]
 [33334     1 21496]
 [43839     3 34443]]
training model: results/AAL/W3/deepVOL_L3/h10
Epoch 1/50
2159/2159 - 89s - loss: 3.2244 - accuracy10: 0.4059 - val_loss: 3.1005 - val_accuracy10: 0.6791 - 89s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 82s - loss: 2.8516 - accuracy10: 0.3606 - val_loss: 2.5065 - val_accuracy10: 0.6203 - 82s/epoch - 38ms/step
Epoch 3/50
2159/2159 - 83s - loss: 2.5414 - accuracy10: 0.5434 - val_loss: 2.4663 - val_accuracy10: 0.6566 - 83s/epoch - 38ms/step
Epoch 4/50
2159/2159 - 82s - loss: 2.4408 - accuracy10: 0.5844 - val_loss: 2.4397 - val_accuracy10: 0.6801 - 82s/epoch - 38ms/step
Epoch 5/50
2159/2159 - 83s - loss: 2.3925 - accuracy10: 0.5963 - val_loss: 2.3426 - val_accuracy10: 0.6875 - 83s/epoch - 38ms/step
Epoch 6/50
2159/2159 - 84s - loss: 2.3564 - accuracy10: 0.6023 - val_loss: 2.3708 - val_accuracy10: 0.6635 - 84s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 86s - loss: 2.3284 - accuracy10: 0.6081 - val_loss: 2.3394 - val_accuracy10: 0.6857 - 86s/epoch - 40ms/step
Epoch 8/50
2159/2159 - 86s - loss: 2.3054 - accuracy10: 0.6094 - val_loss: 2.3312 - val_accuracy10: 0.6794 - 86s/epoch - 40ms/step
Epoch 9/50
2159/2159 - 84s - loss: 2.2848 - accuracy10: 0.6123 - val_loss: 2.3275 - val_accuracy10: 0.6962 - 84s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 84s - loss: 2.2678 - accuracy10: 0.6156 - val_loss: 2.3150 - val_accuracy10: 0.6930 - 84s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 83s - loss: 2.2530 - accuracy10: 0.6174 - val_loss: 2.2758 - val_accuracy10: 0.7037 - 83s/epoch - 38ms/step
Epoch 12/50
2159/2159 - 83s - loss: 2.2432 - accuracy10: 0.6192 - val_loss: 2.2987 - val_accuracy10: 0.7052 - 83s/epoch - 38ms/step
Epoch 13/50
2159/2159 - 82s - loss: 2.2347 - accuracy10: 0.6197 - val_loss: 2.2992 - val_accuracy10: 0.7084 - 82s/epoch - 38ms/step
Epoch 14/50
2159/2159 - 83s - loss: 2.2247 - accuracy10: 0.6218 - val_loss: 2.3025 - val_accuracy10: 0.7046 - 83s/epoch - 38ms/step
Epoch 15/50
2159/2159 - 82s - loss: 2.2150 - accuracy10: 0.6238 - val_loss: 2.2710 - val_accuracy10: 0.7092 - 82s/epoch - 38ms/step
Epoch 16/50
2159/2159 - 82s - loss: 2.2083 - accuracy10: 0.6251 - val_loss: 2.2672 - val_accuracy10: 0.7150 - 82s/epoch - 38ms/step
Epoch 17/50
2159/2159 - 83s - loss: 2.2019 - accuracy10: 0.6257 - val_loss: 2.2747 - val_accuracy10: 0.7094 - 83s/epoch - 38ms/step
Epoch 18/50
2159/2159 - 83s - loss: 2.1957 - accuracy10: 0.6270 - val_loss: 2.2484 - val_accuracy10: 0.7095 - 83s/epoch - 39ms/step
Epoch 19/50
2159/2159 - 83s - loss: 2.1888 - accuracy10: 0.6278 - val_loss: 2.2676 - val_accuracy10: 0.7015 - 83s/epoch - 38ms/step
Epoch 20/50
2159/2159 - 84s - loss: 2.1849 - accuracy10: 0.6288 - val_loss: 2.2387 - val_accuracy10: 0.7111 - 84s/epoch - 39ms/step
Epoch 21/50
2159/2159 - 82s - loss: 2.1800 - accuracy10: 0.6297 - val_loss: 2.2501 - val_accuracy10: 0.7123 - 82s/epoch - 38ms/step
Epoch 22/50
2159/2159 - 82s - loss: 2.1748 - accuracy10: 0.6301 - val_loss: 2.2429 - val_accuracy10: 0.6970 - 82s/epoch - 38ms/step
Epoch 23/50
2159/2159 - 82s - loss: 2.1695 - accuracy10: 0.6307 - val_loss: 2.2378 - val_accuracy10: 0.7101 - 82s/epoch - 38ms/step
Epoch 24/50
2159/2159 - 82s - loss: 2.1670 - accuracy10: 0.6312 - val_loss: 2.2223 - val_accuracy10: 0.7063 - 82s/epoch - 38ms/step
Epoch 25/50
2159/2159 - 82s - loss: 2.1629 - accuracy10: 0.6319 - val_loss: 2.2241 - val_accuracy10: 0.7112 - 82s/epoch - 38ms/step
Epoch 26/50
2159/2159 - 82s - loss: 2.1589 - accuracy10: 0.6325 - val_loss: 2.2401 - val_accuracy10: 0.7186 - 82s/epoch - 38ms/step
Epoch 27/50
2159/2159 - 83s - loss: 2.1547 - accuracy10: 0.6330 - val_loss: 2.2448 - val_accuracy10: 0.7098 - 83s/epoch - 38ms/step
Epoch 28/50
2159/2159 - 82s - loss: 2.1521 - accuracy10: 0.6339 - val_loss: 2.2292 - val_accuracy10: 0.7014 - 82s/epoch - 38ms/step
Epoch 29/50
2159/2159 - 84s - loss: 2.1465 - accuracy10: 0.6345 - val_loss: 2.2250 - val_accuracy10: 0.7039 - 84s/epoch - 39ms/step
Epoch 30/50
2159/2159 - 83s - loss: 2.1437 - accuracy10: 0.6343 - val_loss: 2.2198 - val_accuracy10: 0.7061 - 83s/epoch - 39ms/step
Epoch 31/50
2159/2159 - 84s - loss: 2.1416 - accuracy10: 0.6347 - val_loss: 2.2342 - val_accuracy10: 0.7103 - 84s/epoch - 39ms/step
Epoch 32/50
2159/2159 - 83s - loss: 2.1365 - accuracy10: 0.6353 - val_loss: 2.2374 - val_accuracy10: 0.7117 - 83s/epoch - 38ms/step
Epoch 33/50
2159/2159 - 83s - loss: 2.1335 - accuracy10: 0.6357 - val_loss: 2.2284 - val_accuracy10: 0.7047 - 83s/epoch - 38ms/step
Epoch 34/50
2159/2159 - 82s - loss: 2.1299 - accuracy10: 0.6365 - val_loss: 2.2405 - val_accuracy10: 0.7134 - 82s/epoch - 38ms/step
Epoch 35/50
2159/2159 - 83s - loss: 2.1263 - accuracy10: 0.6365 - val_loss: 2.2391 - val_accuracy10: 0.7074 - 83s/epoch - 38ms/step
Epoch 36/50
2159/2159 - 85s - loss: 2.1234 - accuracy10: 0.6368 - val_loss: 2.2505 - val_accuracy10: 0.7031 - 85s/epoch - 39ms/step
Epoch 37/50
2159/2159 - 85s - loss: 2.1206 - accuracy10: 0.6370 - val_loss: 2.2471 - val_accuracy10: 0.7069 - 85s/epoch - 40ms/step
Epoch 38/50
2159/2159 - 84s - loss: 2.1175 - accuracy10: 0.6381 - val_loss: 2.2395 - val_accuracy10: 0.7039 - 84s/epoch - 39ms/step
Epoch 39/50
2159/2159 - 85s - loss: 2.1151 - accuracy10: 0.6382 - val_loss: 2.2389 - val_accuracy10: 0.7066 - 85s/epoch - 40ms/step
Epoch 40/50
2159/2159 - 86s - loss: 2.1114 - accuracy10: 0.6385 - val_loss: 2.2417 - val_accuracy10: 0.7104 - 86s/epoch - 40ms/step
testing model: results/AAL/W3/deepVOL_L3/h10
Evaluating performance on  test set...
5760/5760 - 101s - 101s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5368211
{'0': {'precision': 0.3930092507336721, 'recall': 0.6570870809886604, 'f1-score': 0.49184306918313003, 'support': 152651}, '1': {'precision': 0.9181911206084794, 'recall': 0.8096227157167939, 'f1-score': 0.8604959318940598, 'support': 1167051}, '2': {'precision': 0.43522038371952404, 'recall': 0.5348293262862718, 'f1-score': 0.47991071428571425, 'support': 154769}, 'accuracy': 0.7649869003866472, 'macro avg': {'precision': 0.5821402516872253, 'recall': 0.6671797076639088, 'f1-score': 0.610749905120968, 'support': 1474471}, 'weighted avg': {'precision': 0.8131239910441638, 'recall': 0.7649869003866472, 'f1-score': 0.7823811221150189, 'support': 1474471}}
[[100305  36061  16285]
 [131049 944871  91131]
 [ 23869  48125  82775]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6923981
{'0': {'precision': 0.4087245139876719, 'recall': 0.6561249294080095, 'f1-score': 0.503684994251032, 'support': 81454}, '1': {'precision': 0.871972275242327, 'recall': 0.7204064570068814, 'f1-score': 0.7889761960438495, 'support': 388725}, '2': {'precision': 0.45276474797265065, 'recall': 0.553169014084507, 'f1-score': 0.4979561054518429, 'support': 82360}, 'accuracy': 0.6860022550444403, 'macro avg': {'precision': 0.5778205124008832, 'recall': 0.6432334668331326, 'f1-score': 0.5968724319155748, 'support': 552539}, 'weighted avg': {'precision': 0.7411954158873001, 'recall': 0.6860022550444403, 'f1-score': 0.7035405540131695, 'support': 552539}}
[[ 53444  18873   9137]
 [ 62757 280040  45928]
 [ 14557  22244  45559]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6493576
{'0': {'precision': 0.40988341226188707, 'recall': 0.6459072351248243, 'f1-score': 0.5015135570539554, 'support': 29882}, '1': {'precision': 0.8837586553915016, 'recall': 0.746319961947043, 'f1-score': 0.8092452953453748, 'support': 157675}, '2': {'precision': 0.44663360465743085, 'recall': 0.5562978380555929, 'f1-score': 0.4954701749140379, 'support': 29788}, 'accuracy': 0.7064712783822954, 'macro avg': {'precision': 0.5800918907702731, 'recall': 0.6495083450424867, 'f1-score': 0.6020763424377894, 'support': 217345}, 'weighted avg': {'precision': 0.7586974806395375, 'recall': 0.7064712783822954, 'f1-score': 0.7239322074388996, 'support': 217345}}
[[ 19301   7239   3342]
 [ 22810 117676  17189]
 [  4978   8239  16571]]
training model: results/AAL/W3/deepVOL_L3/h20
Epoch 1/50
2159/2159 - 88s - loss: 3.1161 - accuracy20: 0.4165 - val_loss: 3.1856 - val_accuracy20: 0.5810 - 88s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 85s - loss: 2.9605 - accuracy20: 0.4191 - val_loss: 2.9387 - val_accuracy20: 0.6049 - 85s/epoch - 40ms/step
Epoch 3/50
2159/2159 - 84s - loss: 2.7004 - accuracy20: 0.5371 - val_loss: 2.6947 - val_accuracy20: 0.6037 - 84s/epoch - 39ms/step
Epoch 4/50
2159/2159 - 84s - loss: 2.5875 - accuracy20: 0.5727 - val_loss: 2.6303 - val_accuracy20: 0.6156 - 84s/epoch - 39ms/step
Epoch 5/50
2159/2159 - 87s - loss: 2.5363 - accuracy20: 0.5845 - val_loss: 2.5775 - val_accuracy20: 0.6268 - 87s/epoch - 40ms/step
Epoch 6/50
2159/2159 - 84s - loss: 2.5026 - accuracy20: 0.5918 - val_loss: 2.5094 - val_accuracy20: 0.6435 - 84s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 85s - loss: 2.4711 - accuracy20: 0.5967 - val_loss: 2.4965 - val_accuracy20: 0.6530 - 85s/epoch - 40ms/step
Epoch 8/50
2159/2159 - 85s - loss: 2.4503 - accuracy20: 0.5993 - val_loss: 2.4774 - val_accuracy20: 0.6616 - 85s/epoch - 39ms/step
Epoch 9/50
2159/2159 - 84s - loss: 2.4298 - accuracy20: 0.6022 - val_loss: 2.4507 - val_accuracy20: 0.6633 - 84s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 83s - loss: 2.4153 - accuracy20: 0.6062 - val_loss: 2.4652 - val_accuracy20: 0.6794 - 83s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 85s - loss: 2.4026 - accuracy20: 0.6084 - val_loss: 2.4493 - val_accuracy20: 0.6814 - 85s/epoch - 39ms/step
Epoch 12/50
2159/2159 - 88s - loss: 2.3943 - accuracy20: 0.6102 - val_loss: 2.4455 - val_accuracy20: 0.6831 - 88s/epoch - 41ms/step
Epoch 13/50
2159/2159 - 83s - loss: 2.3849 - accuracy20: 0.6121 - val_loss: 2.4811 - val_accuracy20: 0.6911 - 83s/epoch - 38ms/step
Epoch 14/50
2159/2159 - 82s - loss: 2.3778 - accuracy20: 0.6126 - val_loss: 2.4410 - val_accuracy20: 0.6864 - 82s/epoch - 38ms/step
Epoch 15/50
2159/2159 - 82s - loss: 2.3710 - accuracy20: 0.6147 - val_loss: 2.4185 - val_accuracy20: 0.6833 - 82s/epoch - 38ms/step
Epoch 16/50
2159/2159 - 83s - loss: 2.3642 - accuracy20: 0.6159 - val_loss: 2.4504 - val_accuracy20: 0.6907 - 83s/epoch - 38ms/step
Epoch 17/50
2159/2159 - 82s - loss: 2.3601 - accuracy20: 0.6167 - val_loss: 2.4425 - val_accuracy20: 0.6882 - 82s/epoch - 38ms/step
Epoch 18/50
2159/2159 - 83s - loss: 2.3555 - accuracy20: 0.6171 - val_loss: 2.4075 - val_accuracy20: 0.6856 - 83s/epoch - 39ms/step
Epoch 19/50
2159/2159 - 82s - loss: 2.3508 - accuracy20: 0.6177 - val_loss: 2.4331 - val_accuracy20: 0.6838 - 82s/epoch - 38ms/step
Epoch 20/50
2159/2159 - 83s - loss: 2.3456 - accuracy20: 0.6182 - val_loss: 2.4100 - val_accuracy20: 0.6854 - 83s/epoch - 38ms/step
Epoch 21/50
2159/2159 - 82s - loss: 2.3422 - accuracy20: 0.6189 - val_loss: 2.4322 - val_accuracy20: 0.6867 - 82s/epoch - 38ms/step
Epoch 22/50
2159/2159 - 83s - loss: 2.3371 - accuracy20: 0.6195 - val_loss: 2.4738 - val_accuracy20: 0.6902 - 83s/epoch - 38ms/step
Epoch 23/50
2159/2159 - 84s - loss: 2.3338 - accuracy20: 0.6203 - val_loss: 2.4797 - val_accuracy20: 0.6893 - 84s/epoch - 39ms/step
Epoch 24/50
2159/2159 - 82s - loss: 2.3295 - accuracy20: 0.6208 - val_loss: 2.4658 - val_accuracy20: 0.6840 - 82s/epoch - 38ms/step
Epoch 25/50
2159/2159 - 82s - loss: 2.3264 - accuracy20: 0.6208 - val_loss: 2.5000 - val_accuracy20: 0.6876 - 82s/epoch - 38ms/step
Epoch 26/50
2159/2159 - 82s - loss: 2.3229 - accuracy20: 0.6211 - val_loss: 2.5400 - val_accuracy20: 0.6901 - 82s/epoch - 38ms/step
Epoch 27/50
2159/2159 - 82s - loss: 2.3195 - accuracy20: 0.6221 - val_loss: 2.4911 - val_accuracy20: 0.6874 - 82s/epoch - 38ms/step
Epoch 28/50
2159/2159 - 91s - loss: 2.3159 - accuracy20: 0.6223 - val_loss: 2.5128 - val_accuracy20: 0.6880 - 91s/epoch - 42ms/step
testing model: results/AAL/W3/deepVOL_L3/h20
Evaluating performance on  test set...
5760/5760 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60153025
{'0': {'precision': 0.474304892816758, 'recall': 0.563728994500205, 'f1-score': 0.515165108925725, 'support': 209826}, '1': {'precision': 0.8506977629644948, 'recall': 0.8333290734824281, 'f1-score': 0.841923849765348, 'support': 1056375}, '2': {'precision': 0.4995112414467253, 'recall': 0.4563595332981226, 'f1-score': 0.4769613697722734, 'support': 208270}, 'accuracy': 0.741716181600045, 'macro avg': {'precision': 0.6081712990759928, 'recall': 0.6178058670935852, 'f1-score': 0.6113501094877821, 'support': 1474471}, 'weighted avg': {'precision': 0.7475294895917903, 'recall': 0.741716181600045, 'f1-score': 0.7438729452283497, 'support': 1474471}}
[[118285  69613  21928]
 [102763 880308  73304]
 [ 28338  84886  95046]]
Evaluating performance on  train set...
2159/2159 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7539913
{'0': {'precision': 0.47966347137617854, 'recall': 0.5600099235518965, 'f1-score': 0.5167320915326375, 'support': 108832}, '1': {'precision': 0.7701017981508894, 'recall': 0.7607445606738442, 'f1-score': 0.7653945815414253, 'support': 333727}, '2': {'precision': 0.5211836542977923, 'recall': 0.4540098199672668, 'f1-score': 0.48528318390553243, 'support': 109980}, 'accuracy': 0.6601524960229052, 'macro avg': {'precision': 0.5903163079416202, 'recall': 0.5915881013976693, 'f1-score': 0.5891366189931985, 'support': 552539}, 'weighted avg': {'precision': 0.6633491500292021, 'recall': 0.6601524960229052, 'f1-score': 0.6606615443718646, 'support': 552539}}
[[ 60947  34542  13343]
 [ 47316 253881  32530]
 [ 18799  41249  49932]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70157886
{'0': {'precision': 0.4879845401841537, 'recall': 0.5385387394620634, 'f1-score': 0.5120167936928234, 'support': 39856}, '1': {'precision': 0.790255422737347, 'recall': 0.790169294485214, 'f1-score': 0.7902123562644189, 'support': 137630}, '2': {'precision': 0.5234858022100993, 'recall': 0.4694548282696505, 'f1-score': 0.4950002645362679, 'support': 39859}, 'accuracy': 0.6852101497618993, 'macro avg': {'precision': 0.6005752550438667, 'recall': 0.599387620738976, 'f1-score': 0.5990764714978367, 'support': 217345}, 'weighted avg': {'precision': 0.6859029941117258, 'recall': 0.6852101497618993, 'f1-score': 0.685058701448132, 'support': 217345}}
[[ 21464  13520   4872]
 [ 16718 108751  12161]
 [  5803  15344  18712]]
training model: results/AAL/W3/deepVOL_L3/h30
Epoch 1/50
2159/2159 - 89s - loss: 3.1642 - accuracy30: 0.4169 - val_loss: 3.0887 - val_accuracy30: 0.5386 - 89s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 84s - loss: 3.0664 - accuracy30: 0.4152 - val_loss: 3.1310 - val_accuracy30: 0.5483 - 84s/epoch - 39ms/step
Epoch 3/50
2159/2159 - 84s - loss: 2.9569 - accuracy30: 0.4659 - val_loss: 2.8521 - val_accuracy30: 0.6033 - 84s/epoch - 39ms/step
Epoch 4/50
2159/2159 - 82s - loss: 2.7680 - accuracy30: 0.5373 - val_loss: 2.7954 - val_accuracy30: 0.6092 - 82s/epoch - 38ms/step
Epoch 5/50
2159/2159 - 83s - loss: 2.6842 - accuracy30: 0.5634 - val_loss: 2.7715 - val_accuracy30: 0.6349 - 83s/epoch - 38ms/step
Epoch 6/50
2159/2159 - 84s - loss: 2.6399 - accuracy30: 0.5724 - val_loss: 2.7331 - val_accuracy30: 0.6348 - 84s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 86s - loss: 2.6096 - accuracy30: 0.5776 - val_loss: 2.6974 - val_accuracy30: 0.6306 - 86s/epoch - 40ms/step
Epoch 8/50
2159/2159 - 83s - loss: 2.5857 - accuracy30: 0.5812 - val_loss: 2.6456 - val_accuracy30: 0.6358 - 83s/epoch - 39ms/step
Epoch 9/50
2159/2159 - 83s - loss: 2.5664 - accuracy30: 0.5844 - val_loss: 2.6628 - val_accuracy30: 0.6324 - 83s/epoch - 38ms/step
Epoch 10/50
2159/2159 - 84s - loss: 2.5535 - accuracy30: 0.5862 - val_loss: 2.6178 - val_accuracy30: 0.6302 - 84s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 85s - loss: 2.5423 - accuracy30: 0.5880 - val_loss: 2.6336 - val_accuracy30: 0.6335 - 85s/epoch - 39ms/step
Epoch 12/50
2159/2159 - 85s - loss: 2.5310 - accuracy30: 0.5901 - val_loss: 2.5728 - val_accuracy30: 0.6375 - 85s/epoch - 39ms/step
Epoch 13/50
2159/2159 - 82s - loss: 2.5231 - accuracy30: 0.5908 - val_loss: 2.5706 - val_accuracy30: 0.6385 - 82s/epoch - 38ms/step
Epoch 14/50
2159/2159 - 83s - loss: 2.5138 - accuracy30: 0.5927 - val_loss: 2.5771 - val_accuracy30: 0.6425 - 83s/epoch - 38ms/step
Epoch 15/50
2159/2159 - 84s - loss: 2.5077 - accuracy30: 0.5938 - val_loss: 2.5496 - val_accuracy30: 0.6458 - 84s/epoch - 39ms/step
Epoch 16/50
2159/2159 - 85s - loss: 2.5019 - accuracy30: 0.5948 - val_loss: 2.5190 - val_accuracy30: 0.6431 - 85s/epoch - 39ms/step
Epoch 17/50
2159/2159 - 85s - loss: 2.4952 - accuracy30: 0.5961 - val_loss: 2.5515 - val_accuracy30: 0.6463 - 85s/epoch - 40ms/step
Epoch 18/50
2159/2159 - 83s - loss: 2.4904 - accuracy30: 0.5966 - val_loss: 2.5154 - val_accuracy30: 0.6448 - 83s/epoch - 39ms/step
Epoch 19/50
2159/2159 - 83s - loss: 2.4858 - accuracy30: 0.5976 - val_loss: 2.5351 - val_accuracy30: 0.6497 - 83s/epoch - 39ms/step
Epoch 20/50
2159/2159 - 85s - loss: 2.4829 - accuracy30: 0.5979 - val_loss: 2.5155 - val_accuracy30: 0.6478 - 85s/epoch - 39ms/step
Epoch 21/50
2159/2159 - 85s - loss: 2.4779 - accuracy30: 0.5994 - val_loss: 2.5057 - val_accuracy30: 0.6433 - 85s/epoch - 39ms/step
Epoch 22/50
2159/2159 - 85s - loss: 2.4743 - accuracy30: 0.5998 - val_loss: 2.5252 - val_accuracy30: 0.6506 - 85s/epoch - 39ms/step
Epoch 23/50
2159/2159 - 85s - loss: 2.4704 - accuracy30: 0.6005 - val_loss: 2.5156 - val_accuracy30: 0.6458 - 85s/epoch - 40ms/step
Epoch 24/50
2159/2159 - 83s - loss: 2.4662 - accuracy30: 0.6014 - val_loss: 2.5051 - val_accuracy30: 0.6421 - 83s/epoch - 39ms/step
Epoch 25/50
2159/2159 - 85s - loss: 2.4638 - accuracy30: 0.6014 - val_loss: 2.5112 - val_accuracy30: 0.6440 - 85s/epoch - 39ms/step
Epoch 26/50
2159/2159 - 84s - loss: 2.4614 - accuracy30: 0.6019 - val_loss: 2.5385 - val_accuracy30: 0.6441 - 84s/epoch - 39ms/step
Epoch 27/50
2159/2159 - 84s - loss: 2.4584 - accuracy30: 0.6025 - val_loss: 2.5236 - val_accuracy30: 0.6441 - 84s/epoch - 39ms/step
Epoch 28/50
2159/2159 - 83s - loss: 2.4546 - accuracy30: 0.6031 - val_loss: 2.5170 - val_accuracy30: 0.6439 - 83s/epoch - 38ms/step
Epoch 29/50
2159/2159 - 84s - loss: 2.4528 - accuracy30: 0.6032 - val_loss: 2.5478 - val_accuracy30: 0.6473 - 84s/epoch - 39ms/step
Epoch 30/50
2159/2159 - 82s - loss: 2.4503 - accuracy30: 0.6036 - val_loss: 2.5337 - val_accuracy30: 0.6451 - 82s/epoch - 38ms/step
Epoch 31/50
2159/2159 - 85s - loss: 2.4475 - accuracy30: 0.6040 - val_loss: 2.5293 - val_accuracy30: 0.6455 - 85s/epoch - 39ms/step
Epoch 32/50
2159/2159 - 83s - loss: 2.4435 - accuracy30: 0.6050 - val_loss: 2.5222 - val_accuracy30: 0.6461 - 83s/epoch - 38ms/step
Epoch 33/50
2159/2159 - 84s - loss: 2.4417 - accuracy30: 0.6051 - val_loss: 2.5303 - val_accuracy30: 0.6428 - 84s/epoch - 39ms/step
Epoch 34/50
2159/2159 - 82s - loss: 2.4395 - accuracy30: 0.6055 - val_loss: 2.5425 - val_accuracy30: 0.6443 - 82s/epoch - 38ms/step
testing model: results/AAL/W3/deepVOL_L3/h30
Evaluating performance on  test set...
5760/5760 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6706164
{'0': {'precision': 0.5072663122882278, 'recall': 0.5151389595886654, 'f1-score': 0.5111723257585102, 'support': 253419}, '1': {'precision': 0.8003015676763834, 'recall': 0.8316480430248335, 'f1-score': 0.8156737539240424, 'support': 971346}, '2': {'precision': 0.5250834027353208, 'recall': 0.43680968819331534, 'f1-score': 0.4768960700255557, 'support': 249706}, 'accuracy': 0.7103822320004938, 'macro avg': {'precision': 0.6108837608999773, 'recall': 0.5945322302689381, 'f1-score': 0.6012473832360361, 'support': 1474471}, 'weighted avg': {'precision': 0.7033282609921665, 'recall': 0.7103822320004938, 'f1-score': 0.7059657516914881, 'support': 1474471}}
[[130546  96202  26671]
 [ 91546 807818  71982]
 [ 35260 105372 109074]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8210332
{'0': {'precision': 0.4998795259895297, 'recall': 0.5328938150909912, 'f1-score': 0.5158589926648157, 'support': 128474}, '1': {'precision': 0.7156828918732416, 'recall': 0.7329897012303479, 'f1-score': 0.7242329172059201, 'support': 294307}, '2': {'precision': 0.5338659378394478, 'recall': 0.46967431680512955, 'f1-score': 0.49971711340882446, 'support': 129758}, 'accuracy': 0.6246274018666556, 'macro avg': {'precision': 0.583142785234073, 'recall': 0.5785192777088229, 'f1-score': 0.5799363410931867, 'support': 552539}, 'weighted avg': {'precision': 0.6228074098709557, 'recall': 0.6246274018666556, 'f1-score': 0.6230575191786363, 'support': 552539}}
[[ 68463  42092  17919]
 [ 43290 215724  35293]
 [ 25206  43608  60944]]
Evaluating performance on  val set...
850/850 - 15s - 15s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78263706
{'0': {'precision': 0.5030322106809358, 'recall': 0.5072902338376891, 'f1-score': 0.5051522494995259, 'support': 47255}, '1': {'precision': 0.7329269633795736, 'recall': 0.7590543750610134, 'f1-score': 0.7457618990528713, 'support': 122924}, '2': {'precision': 0.5273688184220461, 'recall': 0.473900691175847, 'f1-score': 0.49920714684533785, 'support': 47166}, 'accuracy': 0.6424348386206262, 'macro avg': {'precision': 0.5877759974941852, 'recall': 0.5800817666915165, 'f1-score': 0.5833737651325783, 'support': 217345}, 'weighted avg': {'precision': 0.6383352681308175, 'recall': 0.6424348386206262, 'f1-score': 0.6399439118331798, 'support': 217345}}
[[23972 16956  6327]
 [15913 93306 13705]
 [ 7770 17044 22352]]
training model: results/AAL/W3/deepVOL_L3/h50
Epoch 1/50
2159/2159 - 89s - loss: 3.2321 - accuracy50: 0.4132 - val_loss: 3.3486 - val_accuracy50: 0.4694 - 89s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 86s - loss: 3.1318 - accuracy50: 0.4235 - val_loss: 3.3660 - val_accuracy50: 0.4696 - 86s/epoch - 40ms/step
Epoch 3/50
2159/2159 - 85s - loss: 3.0521 - accuracy50: 0.4558 - val_loss: 3.0072 - val_accuracy50: 0.5095 - 85s/epoch - 40ms/step
Epoch 4/50
2159/2159 - 90s - loss: 2.9043 - accuracy50: 0.5170 - val_loss: 2.9653 - val_accuracy50: 0.5505 - 90s/epoch - 42ms/step
Epoch 5/50
2159/2159 - 92s - loss: 2.8360 - accuracy50: 0.5352 - val_loss: 3.0164 - val_accuracy50: 0.5543 - 92s/epoch - 42ms/step
Epoch 6/50
2159/2159 - 91s - loss: 2.8084 - accuracy50: 0.5410 - val_loss: 2.9972 - val_accuracy50: 0.5578 - 91s/epoch - 42ms/step
Epoch 7/50
2159/2159 - 91s - loss: 2.7888 - accuracy50: 0.5447 - val_loss: 3.0191 - val_accuracy50: 0.5564 - 91s/epoch - 42ms/step
Epoch 8/50
2159/2159 - 91s - loss: 2.7735 - accuracy50: 0.5479 - val_loss: 3.0178 - val_accuracy50: 0.5591 - 91s/epoch - 42ms/step
Epoch 9/50
2159/2159 - 90s - loss: 2.7621 - accuracy50: 0.5504 - val_loss: 2.9922 - val_accuracy50: 0.5606 - 90s/epoch - 42ms/step
Epoch 10/50
2159/2159 - 91s - loss: 2.7509 - accuracy50: 0.5520 - val_loss: 2.9770 - val_accuracy50: 0.5643 - 91s/epoch - 42ms/step
Epoch 11/50
2159/2159 - 91s - loss: 2.7384 - accuracy50: 0.5542 - val_loss: 2.9279 - val_accuracy50: 0.5661 - 91s/epoch - 42ms/step
Epoch 12/50
2159/2159 - 90s - loss: 2.7282 - accuracy50: 0.5559 - val_loss: 2.9325 - val_accuracy50: 0.5666 - 90s/epoch - 42ms/step
Epoch 13/50
2159/2159 - 91s - loss: 2.7183 - accuracy50: 0.5572 - val_loss: 2.9273 - val_accuracy50: 0.5650 - 91s/epoch - 42ms/step
Epoch 14/50
2159/2159 - 91s - loss: 2.7109 - accuracy50: 0.5589 - val_loss: 2.9229 - val_accuracy50: 0.5659 - 91s/epoch - 42ms/step
Epoch 15/50
2159/2159 - 91s - loss: 2.7049 - accuracy50: 0.5592 - val_loss: 2.9452 - val_accuracy50: 0.5640 - 91s/epoch - 42ms/step
Epoch 16/50
2159/2159 - 91s - loss: 2.6999 - accuracy50: 0.5605 - val_loss: 2.9354 - val_accuracy50: 0.5645 - 91s/epoch - 42ms/step
Epoch 17/50
2159/2159 - 91s - loss: 2.6942 - accuracy50: 0.5613 - val_loss: 2.9208 - val_accuracy50: 0.5675 - 91s/epoch - 42ms/step
Epoch 18/50
2159/2159 - 91s - loss: 2.6905 - accuracy50: 0.5621 - val_loss: 2.9223 - val_accuracy50: 0.5641 - 91s/epoch - 42ms/step
Epoch 19/50
2159/2159 - 91s - loss: 2.6861 - accuracy50: 0.5629 - val_loss: 2.9346 - val_accuracy50: 0.5638 - 91s/epoch - 42ms/step
Epoch 20/50
2159/2159 - 91s - loss: 2.6821 - accuracy50: 0.5639 - val_loss: 2.9181 - val_accuracy50: 0.5650 - 91s/epoch - 42ms/step
Epoch 21/50
2159/2159 - 91s - loss: 2.6784 - accuracy50: 0.5650 - val_loss: 2.9117 - val_accuracy50: 0.5661 - 91s/epoch - 42ms/step
Epoch 22/50
2159/2159 - 91s - loss: 2.6747 - accuracy50: 0.5658 - val_loss: 2.9357 - val_accuracy50: 0.5639 - 91s/epoch - 42ms/step
Epoch 23/50
2159/2159 - 90s - loss: 2.6720 - accuracy50: 0.5662 - val_loss: 2.9405 - val_accuracy50: 0.5632 - 90s/epoch - 42ms/step
Epoch 24/50
2159/2159 - 91s - loss: 2.6689 - accuracy50: 0.5662 - val_loss: 2.9242 - val_accuracy50: 0.5634 - 91s/epoch - 42ms/step
Epoch 25/50
2159/2159 - 91s - loss: 2.6646 - accuracy50: 0.5676 - val_loss: 2.9317 - val_accuracy50: 0.5637 - 91s/epoch - 42ms/step
Epoch 26/50
2159/2159 - 91s - loss: 2.6613 - accuracy50: 0.5678 - val_loss: 2.9034 - val_accuracy50: 0.5634 - 91s/epoch - 42ms/step
Epoch 27/50
2159/2159 - 91s - loss: 2.6591 - accuracy50: 0.5684 - val_loss: 2.9233 - val_accuracy50: 0.5634 - 91s/epoch - 42ms/step
Epoch 28/50
2159/2159 - 91s - loss: 2.6557 - accuracy50: 0.5692 - val_loss: 2.9136 - val_accuracy50: 0.5648 - 91s/epoch - 42ms/step
Epoch 29/50
2159/2159 - 91s - loss: 2.6512 - accuracy50: 0.5695 - val_loss: 2.9341 - val_accuracy50: 0.5631 - 91s/epoch - 42ms/step
Epoch 30/50
2159/2159 - 90s - loss: 2.6498 - accuracy50: 0.5702 - val_loss: 2.9214 - val_accuracy50: 0.5637 - 90s/epoch - 42ms/step
Epoch 31/50
2159/2159 - 82s - loss: 2.6466 - accuracy50: 0.5713 - val_loss: 2.9417 - val_accuracy50: 0.5632 - 82s/epoch - 38ms/step
Epoch 32/50
2159/2159 - 83s - loss: 2.6453 - accuracy50: 0.5713 - val_loss: 2.9334 - val_accuracy50: 0.5630 - 83s/epoch - 39ms/step
Epoch 33/50
2159/2159 - 83s - loss: 2.6410 - accuracy50: 0.5722 - val_loss: 2.9710 - val_accuracy50: 0.5591 - 83s/epoch - 38ms/step
Epoch 34/50
2159/2159 - 83s - loss: 2.6388 - accuracy50: 0.5723 - val_loss: 2.9524 - val_accuracy50: 0.5586 - 83s/epoch - 38ms/step
Epoch 35/50
2159/2159 - 83s - loss: 2.6338 - accuracy50: 0.5734 - val_loss: 2.9365 - val_accuracy50: 0.5607 - 83s/epoch - 38ms/step
Epoch 36/50
2159/2159 - 82s - loss: 2.6323 - accuracy50: 0.5738 - val_loss: 2.9254 - val_accuracy50: 0.5608 - 82s/epoch - 38ms/step
testing model: results/AAL/W3/deepVOL_L3/h50
Evaluating performance on  test set...
5760/5760 - 100s - 100s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.80303115
{'0': {'precision': 0.5381039439964997, 'recall': 0.4262246385107851, 'f1-score': 0.47567429436719666, 'support': 323177}, '1': {'precision': 0.6722684374006317, 'recall': 0.8636339133299392, 'f1-score': 0.7560296019136168, 'support': 834775}, '2': {'precision': 0.5732161436942117, 'recall': 0.2645654763221165, 'f1-score': 0.36203516159504723, 'support': 316519}, 'accuracy': 0.6391621130561401, 'macro avg': {'precision': 0.594529508363781, 'recall': 0.518141342720947, 'f1-score': 0.531246352625287, 'support': 1474471}, 'weighted avg': {'precision': 0.6215988674758726, 'recall': 0.6391621130561401, 'f1-score': 0.6100035942931734, 'support': 1474471}}
[[137746 169005  16426]
 [ 67913 720940  45922]
 [ 50325 182454  83740]]
Evaluating performance on  train set...
2159/2159 - 44s - 44s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9412793
{'0': {'precision': 0.5232040686586141, 'recall': 0.44711965587989033, 'f1-score': 0.4821789207408276, 'support': 156457}, '1': {'precision': 0.5481023506020042, 'recall': 0.812545073375262, 'f1-score': 0.6546264033415023, 'support': 238500}, '2': {'precision': 0.6005209530376159, 'recall': 0.24871495475371552, 'f1-score': 0.35174806032838674, 'support': 157582}, 'accuracy': 0.5482689909671534, 'macro avg': {'precision': 0.557275790766078, 'recall': 0.502793228002956, 'f1-score': 0.49618446147023887, 'support': 552539}, 'weighted avg': {'precision': 0.5560017345567867, 'recall': 0.5482689909671534, 'f1-score': 0.5194164166546865, 'support': 552539}}
[[ 69955  76149  10353]
 [ 28989 193792  15719]
 [ 34761  83628  39193]]
Evaluating performance on  val set...
850/850 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.91351926
{'0': {'precision': 0.5244579785979284, 'recall': 0.41963657578201413, 'f1-score': 0.4662281955962253, 'support': 58279}, '1': {'precision': 0.5716531756984065, 'recall': 0.8239700745168281, 'f1-score': 0.6750032427524482, 'support': 101051}, '2': {'precision': 0.588643709349188, 'recall': 0.25427906575885545, 'f1-score': 0.3551446867928162, 'support': 58015}, 'accuracy': 0.5634866226506245, 'macro avg': {'precision': 0.5615849545485077, 'recall': 0.49929523868589926, 'f1-score': 0.4987920417138299, 'support': 217345}, 'weighted avg': {'precision': 0.5635334440180427, 'recall': 0.5634866226506245, 'f1-score': 0.5336436757174782, 'support': 217345}}
[[24456 30240  3583]
 [11062 83263  6726]
 [11113 32150 14752]]
training model: results/AAL/W3/deepVOL_L3/h100
Epoch 1/50
2159/2159 - 89s - loss: 3.2876 - accuracy100: 0.3699 - val_loss: 3.3062 - val_accuracy100: 0.3557 - 89s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 83s - loss: 3.2831 - accuracy100: 0.3596 - val_loss: 3.3110 - val_accuracy100: 0.3556 - 83s/epoch - 38ms/step
Epoch 3/50
2159/2159 - 85s - loss: 3.2618 - accuracy100: 0.3730 - val_loss: 3.3456 - val_accuracy100: 0.3632 - 85s/epoch - 39ms/step
Epoch 4/50
2159/2159 - 84s - loss: 3.2124 - accuracy100: 0.4102 - val_loss: 3.3935 - val_accuracy100: 0.3559 - 84s/epoch - 39ms/step
Epoch 5/50
2159/2159 - 85s - loss: 3.1949 - accuracy100: 0.4186 - val_loss: 3.3379 - val_accuracy100: 0.3593 - 85s/epoch - 39ms/step
Epoch 6/50
2159/2159 - 85s - loss: 3.1824 - accuracy100: 0.4256 - val_loss: 3.2986 - val_accuracy100: 0.3645 - 85s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 83s - loss: 3.1565 - accuracy100: 0.4370 - val_loss: 3.3062 - val_accuracy100: 0.3770 - 83s/epoch - 39ms/step
Epoch 8/50
2159/2159 - 85s - loss: 3.1377 - accuracy100: 0.4450 - val_loss: 3.2832 - val_accuracy100: 0.3955 - 85s/epoch - 39ms/step
Epoch 9/50
2159/2159 - 84s - loss: 3.1208 - accuracy100: 0.4537 - val_loss: 3.2472 - val_accuracy100: 0.4156 - 84s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 84s - loss: 3.1002 - accuracy100: 0.4605 - val_loss: 3.2030 - val_accuracy100: 0.4310 - 84s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 82s - loss: 3.0751 - accuracy100: 0.4652 - val_loss: 3.2185 - val_accuracy100: 0.4338 - 82s/epoch - 38ms/step
Epoch 12/50
2159/2159 - 84s - loss: 3.0514 - accuracy100: 0.4710 - val_loss: 3.2175 - val_accuracy100: 0.4381 - 84s/epoch - 39ms/step
Epoch 13/50
2159/2159 - 84s - loss: 3.0367 - accuracy100: 0.4740 - val_loss: 3.2023 - val_accuracy100: 0.4372 - 84s/epoch - 39ms/step
Epoch 14/50
2159/2159 - 84s - loss: 3.0260 - accuracy100: 0.4762 - val_loss: 3.1922 - val_accuracy100: 0.4366 - 84s/epoch - 39ms/step
Epoch 15/50
2159/2159 - 82s - loss: 3.0167 - accuracy100: 0.4793 - val_loss: 3.1977 - val_accuracy100: 0.4385 - 82s/epoch - 38ms/step
Epoch 16/50
2159/2159 - 83s - loss: 3.0103 - accuracy100: 0.4809 - val_loss: 3.2073 - val_accuracy100: 0.4386 - 83s/epoch - 38ms/step
Epoch 17/50
2159/2159 - 82s - loss: 3.0042 - accuracy100: 0.4824 - val_loss: 3.1985 - val_accuracy100: 0.4405 - 82s/epoch - 38ms/step
Epoch 18/50
2159/2159 - 85s - loss: 2.9990 - accuracy100: 0.4839 - val_loss: 3.1961 - val_accuracy100: 0.4412 - 85s/epoch - 39ms/step
Epoch 19/50
2159/2159 - 84s - loss: 2.9944 - accuracy100: 0.4852 - val_loss: 3.1817 - val_accuracy100: 0.4430 - 84s/epoch - 39ms/step
Epoch 20/50
2159/2159 - 82s - loss: 2.9900 - accuracy100: 0.4860 - val_loss: 3.1842 - val_accuracy100: 0.4430 - 82s/epoch - 38ms/step
Epoch 21/50
2159/2159 - 83s - loss: 2.9856 - accuracy100: 0.4876 - val_loss: 3.1885 - val_accuracy100: 0.4432 - 83s/epoch - 39ms/step
Epoch 22/50
2159/2159 - 82s - loss: 2.9827 - accuracy100: 0.4881 - val_loss: 3.2016 - val_accuracy100: 0.4408 - 82s/epoch - 38ms/step
Epoch 23/50
2159/2159 - 82s - loss: 2.9792 - accuracy100: 0.4897 - val_loss: 3.1968 - val_accuracy100: 0.4421 - 82s/epoch - 38ms/step
Epoch 24/50
2159/2159 - 84s - loss: 2.9761 - accuracy100: 0.4908 - val_loss: 3.1864 - val_accuracy100: 0.4433 - 84s/epoch - 39ms/step
Epoch 25/50
2159/2159 - 83s - loss: 2.9729 - accuracy100: 0.4910 - val_loss: 3.1798 - val_accuracy100: 0.4440 - 83s/epoch - 38ms/step
Epoch 26/50
2159/2159 - 83s - loss: 2.9704 - accuracy100: 0.4918 - val_loss: 3.1865 - val_accuracy100: 0.4448 - 83s/epoch - 38ms/step
Epoch 27/50
2159/2159 - 83s - loss: 2.9678 - accuracy100: 0.4922 - val_loss: 3.1897 - val_accuracy100: 0.4462 - 83s/epoch - 38ms/step
Epoch 28/50
2159/2159 - 83s - loss: 2.9651 - accuracy100: 0.4927 - val_loss: 3.2002 - val_accuracy100: 0.4444 - 83s/epoch - 38ms/step
Epoch 29/50
2159/2159 - 82s - loss: 2.9634 - accuracy100: 0.4939 - val_loss: 3.2002 - val_accuracy100: 0.4437 - 82s/epoch - 38ms/step
Epoch 30/50
2159/2159 - 82s - loss: 2.9604 - accuracy100: 0.4942 - val_loss: 3.1854 - val_accuracy100: 0.4461 - 82s/epoch - 38ms/step
Epoch 31/50
2159/2159 - 82s - loss: 2.9584 - accuracy100: 0.4945 - val_loss: 3.2126 - val_accuracy100: 0.4440 - 82s/epoch - 38ms/step
Epoch 32/50
2159/2159 - 83s - loss: 2.9556 - accuracy100: 0.4957 - val_loss: 3.2276 - val_accuracy100: 0.4429 - 83s/epoch - 38ms/step
Epoch 33/50
2159/2159 - 83s - loss: 2.9530 - accuracy100: 0.4964 - val_loss: 3.2103 - val_accuracy100: 0.4475 - 83s/epoch - 39ms/step
Epoch 34/50
2159/2159 - 83s - loss: 2.9511 - accuracy100: 0.4970 - val_loss: 3.2225 - val_accuracy100: 0.4435 - 83s/epoch - 38ms/step
Epoch 35/50
2159/2159 - 82s - loss: 2.9484 - accuracy100: 0.4979 - val_loss: 3.2462 - val_accuracy100: 0.4451 - 82s/epoch - 38ms/step
testing model: results/AAL/W3/deepVOL_L3/h100
Evaluating performance on  test set...
5760/5760 - 104s - 104s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9899614
{'0': {'precision': 0.5157057202931593, 'recall': 0.34049302369135687, 'f1-score': 0.41017158988199226, 'support': 427160}, '1': {'precision': 0.5030689933756377, 'recall': 0.8652038992510719, 'f1-score': 0.6362141017430208, 'support': 638379}, '2': {'precision': 0.572633115749606, 'recall': 0.13236185967349096, 'f1-score': 0.2150221966213465, 'support': 408932}, 'accuracy': 0.509945600829043, 'macro avg': {'precision': 0.5304692764728011, 'recall': 0.4460195942053066, 'f1-score': 0.4204692960821199, 'support': 1474471}, 'weighted avg': {'precision': 0.5260229205540766, 'recall': 0.509945600829043, 'f1-score': 0.45391470927496047, 'support': 1474471}}
[[145445 261858  19857]
 [ 65512 552328  20539]
 [ 71074 283731  54127]]
Evaluating performance on  train set...
2159/2159 - 45s - 45s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0688947
{'0': {'precision': 0.4801480373138775, 'recall': 0.39238951651300696, 'f1-score': 0.4318554665983857, 'support': 184824}, '1': {'precision': 0.4030490068045914, 'recall': 0.802644474253333, 'f1-score': 0.5366290242875706, 'support': 182645}, '2': {'precision': 0.570199359296815, 'recall': 0.11637218349813584, 'f1-score': 0.19329477071095533, 'support': 185070}, 'accuracy': 0.43555115566503, 'macro avg': {'precision': 0.48446546780509464, 'recall': 0.43713539142149194, 'f1-score': 0.3872597538656372, 'support': 552539}, 'weighted avg': {'precision': 0.48482471304538904, 'recall': 0.43555115566503, 'f1-score': 0.38658434267094244, 'support': 552539}}
[[ 72523 102429   9872]
 [ 29684 146599   6362]
 [ 48836 114697  21537]]
Evaluating performance on  val set...
850/850 - 18s - 18s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0609576
{'0': {'precision': 0.4776423926930191, 'recall': 0.35725593667546174, 'f1-score': 0.40876972535452605, 'support': 70115}, '1': {'precision': 0.4213477527453111, 'recall': 0.8175819910731613, 'f1-score': 0.556103098408117, 'support': 77295}, '2': {'precision': 0.5682016220926336, 'recall': 0.1212125545149067, 'f1-score': 0.1998020128691635, 'support': 69935}, 'accuracy': 0.44501138742552165, 'macro avg': {'precision': 0.48906392251032127, 'recall': 0.4320168274211766, 'f1-score': 0.3882249455439355, 'support': 217345}, 'weighted avg': {'precision': 0.48676137639774636, 'recall': 0.44501138742552165, 'f1-score': 0.39392685387146215, 'support': 217345}}
[[25049 41353  3713]
 [11371 63195  2729]
 [16023 45435  8477]]
training model: results/AAL/W3/deepVOL_L3/h200
Epoch 1/50
2159/2159 - 90s - loss: 3.2957 - accuracy200: 0.3599 - val_loss: 3.3530 - val_accuracy200: 0.3252 - 90s/epoch - 42ms/step
Epoch 2/50
2159/2159 - 85s - loss: 3.2902 - accuracy200: 0.3532 - val_loss: 3.3266 - val_accuracy200: 0.3293 - 85s/epoch - 40ms/step
Epoch 3/50
2159/2159 - 85s - loss: 3.2857 - accuracy200: 0.3585 - val_loss: 3.3506 - val_accuracy200: 0.3243 - 85s/epoch - 39ms/step
Epoch 4/50
2159/2159 - 85s - loss: 3.2649 - accuracy200: 0.3778 - val_loss: 3.3346 - val_accuracy200: 0.3328 - 85s/epoch - 39ms/step
Epoch 5/50
2159/2159 - 86s - loss: 3.2451 - accuracy200: 0.3939 - val_loss: 3.3511 - val_accuracy200: 0.3326 - 86s/epoch - 40ms/step
Epoch 6/50
2159/2159 - 86s - loss: 3.2343 - accuracy200: 0.4017 - val_loss: 3.3501 - val_accuracy200: 0.3326 - 86s/epoch - 40ms/step
Epoch 7/50
2159/2159 - 86s - loss: 3.2285 - accuracy200: 0.4050 - val_loss: 3.3529 - val_accuracy200: 0.3431 - 86s/epoch - 40ms/step
Epoch 8/50
2159/2159 - 84s - loss: 3.2249 - accuracy200: 0.4069 - val_loss: 3.3729 - val_accuracy200: 0.3407 - 84s/epoch - 39ms/step
Epoch 9/50
2159/2159 - 84s - loss: 3.2202 - accuracy200: 0.4089 - val_loss: 3.3766 - val_accuracy200: 0.3424 - 84s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 85s - loss: 3.2153 - accuracy200: 0.4113 - val_loss: 3.3952 - val_accuracy200: 0.3457 - 85s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 87s - loss: 3.2118 - accuracy200: 0.4138 - val_loss: 3.3857 - val_accuracy200: 0.3483 - 87s/epoch - 40ms/step
Epoch 12/50
2159/2159 - 85s - loss: 3.2076 - accuracy200: 0.4155 - val_loss: 3.3880 - val_accuracy200: 0.3560 - 85s/epoch - 39ms/step
testing model: results/AAL/W3/deepVOL_L3/h200
Evaluating performance on  test set...
5760/5760 - 97s - 97s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1023567
{'0': {'precision': 0.32362302795460834, 'recall': 0.009582445500737584, 'f1-score': 0.018613740020536007, 'support': 488080}, '1': {'precision': 0.3595099389241389, 'recall': 0.9192801461562833, 'f1-score': 0.5168797491545059, 'support': 527107}, '2': {'precision': 0.3194666048650913, 'recall': 0.07803450588307018, 'f1-score': 0.1254306867715072, 'support': 459284}, 'accuracy': 0.35611144607116724, 'macro avg': {'precision': 0.33419985724794615, 'recall': 0.33563236584669703, 'f1-score': 0.22030805864884964, 'support': 1474471}, 'weighted avg': {'precision': 0.3351575127685997, 'recall': 0.35611144607116724, 'f1-score': 0.230010787401022, 'support': 1474471}}
[[  4677 444507  38896]
 [  5097 484559  37451]
 [  4678 418766  35840]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076539
{'0': {'precision': 0.35038411092373994, 'recall': 0.010140172979421413, 'f1-score': 0.01970993718116278, 'support': 184415}, '1': {'precision': 0.3346982509669273, 'recall': 0.9114101166555488, 'f1-score': 0.4896000699203928, 'support': 184389}, '2': {'precision': 0.33932056058186977, 'recall': 0.08328298908754456, 'f1-score': 0.1337406208074955, 'support': 183735}, 'accuracy': 0.3352270156495741, 'macro avg': {'precision': 0.34146764082417896, 'recall': 0.33494442624083826, 'f1-score': 0.21435020930301704, 'support': 552539}, 'weighted avg': {'precision': 0.34147060173499444, 'recall': 0.3352270156495741, 'f1-score': 0.2144364620811936, 'support': 552539}}
[[  1870 167339  15206]
 [  1747 168054  14588]
 [  1720 166713  15302]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1089351
{'0': {'precision': 0.39010416666666664, 'recall': 0.010127643463681108, 'f1-score': 0.01974273815172123, 'support': 73956}, '1': {'precision': 0.32679432816751924, 'recall': 0.9217552919811588, 'f1-score': 0.48251891076939074, 'support': 70484}, '2': {'precision': 0.34883860873751354, 'recall': 0.07951443659556957, 'f1-score': 0.12950861789707674, 'support': 72905}, 'accuracy': 0.3290390853251743, 'macro avg': {'precision': 0.3552457011905665, 'recall': 0.33713245734680314, 'f1-score': 0.21059008893939626, 'support': 217345}, 'weighted avg': {'precision': 0.35573118289616895, 'recall': 0.3290390853251743, 'f1-score': 0.2066382140707392, 'support': 217345}}
[[  749 67315  5892]
 [  586 64969  4929]
 [  585 66523  5797]]
training model: results/AAL/W3/deepVOL_L3/h300
Epoch 1/50
2159/2159 - 89s - loss: 3.3004 - accuracy300: 0.3557 - val_loss: 3.3218 - val_accuracy300: 0.3469 - 89s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 84s - loss: 3.2845 - accuracy300: 0.3641 - val_loss: 3.3093 - val_accuracy300: 0.3491 - 84s/epoch - 39ms/step
Epoch 3/50
2159/2159 - 83s - loss: 3.2741 - accuracy300: 0.3747 - val_loss: 3.3215 - val_accuracy300: 0.3531 - 83s/epoch - 38ms/step
Epoch 4/50
2159/2159 - 85s - loss: 3.2698 - accuracy300: 0.3784 - val_loss: 3.3098 - val_accuracy300: 0.3511 - 85s/epoch - 39ms/step
Epoch 5/50
2159/2159 - 84s - loss: 3.2640 - accuracy300: 0.3836 - val_loss: 3.3232 - val_accuracy300: 0.3503 - 84s/epoch - 39ms/step
Epoch 6/50
2159/2159 - 85s - loss: 3.2588 - accuracy300: 0.3877 - val_loss: 3.3316 - val_accuracy300: 0.3508 - 85s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 82s - loss: 3.2555 - accuracy300: 0.3909 - val_loss: 3.3191 - val_accuracy300: 0.3530 - 82s/epoch - 38ms/step
Epoch 8/50
2159/2159 - 88s - loss: 3.2504 - accuracy300: 0.3938 - val_loss: 3.3212 - val_accuracy300: 0.3547 - 88s/epoch - 41ms/step
Epoch 9/50
2159/2159 - 83s - loss: 3.2430 - accuracy300: 0.3992 - val_loss: 3.3123 - val_accuracy300: 0.3569 - 83s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 85s - loss: 3.2371 - accuracy300: 0.4038 - val_loss: 3.3046 - val_accuracy300: 0.3630 - 85s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 83s - loss: 3.2301 - accuracy300: 0.4074 - val_loss: 3.3023 - val_accuracy300: 0.3684 - 83s/epoch - 38ms/step
Epoch 12/50
2159/2159 - 86s - loss: 3.2227 - accuracy300: 0.4114 - val_loss: 3.3090 - val_accuracy300: 0.3645 - 86s/epoch - 40ms/step
Epoch 13/50
2159/2159 - 84s - loss: 3.2169 - accuracy300: 0.4146 - val_loss: 3.3096 - val_accuracy300: 0.3653 - 84s/epoch - 39ms/step
Epoch 14/50
2159/2159 - 82s - loss: 3.2105 - accuracy300: 0.4183 - val_loss: 3.3080 - val_accuracy300: 0.3683 - 82s/epoch - 38ms/step
Epoch 15/50
2159/2159 - 83s - loss: 3.2061 - accuracy300: 0.4200 - val_loss: 3.3162 - val_accuracy300: 0.3659 - 83s/epoch - 38ms/step
Epoch 16/50
2159/2159 - 82s - loss: 3.2008 - accuracy300: 0.4230 - val_loss: 3.3187 - val_accuracy300: 0.3649 - 82s/epoch - 38ms/step
Epoch 17/50
2159/2159 - 84s - loss: 3.1954 - accuracy300: 0.4257 - val_loss: 3.3257 - val_accuracy300: 0.3643 - 84s/epoch - 39ms/step
Epoch 18/50
2159/2159 - 82s - loss: 3.1907 - accuracy300: 0.4287 - val_loss: 3.3357 - val_accuracy300: 0.3625 - 82s/epoch - 38ms/step
Epoch 19/50
2159/2159 - 83s - loss: 3.1868 - accuracy300: 0.4300 - val_loss: 3.3408 - val_accuracy300: 0.3647 - 83s/epoch - 39ms/step
Epoch 20/50
2159/2159 - 82s - loss: 3.1834 - accuracy300: 0.4318 - val_loss: 3.3465 - val_accuracy300: 0.3635 - 82s/epoch - 38ms/step
Epoch 21/50
2159/2159 - 82s - loss: 3.1767 - accuracy300: 0.4346 - val_loss: 3.3609 - val_accuracy300: 0.3610 - 82s/epoch - 38ms/step
testing model: results/AAL/W3/deepVOL_L3/h300
Evaluating performance on  test set...
5760/5760 - 95s - 95s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0871768
{'0': {'precision': 0.3811411071364233, 'recall': 0.2823049503440651, 'f1-score': 0.32436102411353734, 'support': 472149}, '1': {'precision': 0.38673983900128783, 'recall': 0.654716569109415, 'f1-score': 0.4862517116548118, 'support': 563259}, '2': {'precision': 0.37508323111967756, 'recall': 0.14626147044957102, 'f1-score': 0.21045663170417173, 'support': 439063}, 'accuracy': 0.38405841823949066, 'macro avg': {'precision': 0.3809880590857963, 'recall': 0.3610943299676837, 'f1-score': 0.3403564558241736, 'support': 1474471}, 'weighted avg': {'precision': 0.38147597089022467, 'recall': 0.38405841823949066, 'f1-score': 0.35228641737619043, 'support': 1474471}}
[[133290 295814  43045]
 [130537 368775  63947]
 [ 85886 288959  64218]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033144
{'0': {'precision': 0.4010813827746189, 'recall': 0.31080511223562995, 'f1-score': 0.35021915730285746, 'support': 184968}, '1': {'precision': 0.34283785054317634, 'recall': 0.660770962605019, 'f1-score': 0.4514454109071264, 'support': 182110}, '2': {'precision': 0.4296806555236803, 'recall': 0.13486932562641202, 'f1-score': 0.20529888293375578, 'support': 185461}, 'accuracy': 0.36709625926857653, 'macro avg': {'precision': 0.39119996294715853, 'recall': 0.36881513348902034, 'f1-score': 0.3356544837145799, 'support': 552539}, 'weighted avg': {'precision': 0.39148444946972216, 'recall': 0.36709625926857653, 'f1-score': 0.3349392477201953, 'support': 552539}}
[[ 57489 112718  14761]
 [ 43338 120333  18439]
 [ 42508 117940  25013]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1019189
{'0': {'precision': 0.3829132120267839, 'recall': 0.28756094163532525, 'f1-score': 0.32845675918633604, 'support': 71790}, '1': {'precision': 0.357444622059831, 'recall': 0.6638040712468194, 'f1-score': 0.4646727029835238, 'support': 75456}, '2': {'precision': 0.3969275660830759, 'recall': 0.1319562333271516, 'f1-score': 0.19806644326199374, 'support': 70099}, 'accuracy': 0.3679955830591916, 'macro avg': {'precision': 0.3790951333898969, 'recall': 0.36110708206976544, 'f1-score': 0.33039863514395124, 'support': 217345}, 'weighted avg': {'precision': 0.37859120913021677, 'recall': 0.3679955830591916, 'f1-score': 0.3336930402104228, 'support': 217345}}
[[20644 45250  5896]
 [17210 50088  8158]
 [16059 44790  9250]]
training model: results/AAL/W3/deepVOL_L3/h500
Epoch 1/50
2159/2159 - 88s - loss: 3.2714 - accuracy500: 0.3803 - val_loss: 3.3090 - val_accuracy500: 0.3000 - 88s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 86s - loss: 3.2732 - accuracy500: 0.3744 - val_loss: 3.3035 - val_accuracy500: 0.3007 - 86s/epoch - 40ms/step
Epoch 3/50
2159/2159 - 86s - loss: 3.2738 - accuracy500: 0.3753 - val_loss: 3.3059 - val_accuracy500: 0.3301 - 86s/epoch - 40ms/step
Epoch 4/50
2159/2159 - 83s - loss: 3.2583 - accuracy500: 0.3845 - val_loss: 3.3159 - val_accuracy500: 0.3307 - 83s/epoch - 38ms/step
Epoch 5/50
2159/2159 - 85s - loss: 3.2644 - accuracy500: 0.3887 - val_loss: 3.3049 - val_accuracy500: 0.3628 - 85s/epoch - 40ms/step
Epoch 6/50
2159/2159 - 84s - loss: 3.2638 - accuracy500: 0.3910 - val_loss: 3.3273 - val_accuracy500: 0.3378 - 84s/epoch - 39ms/step
Epoch 7/50
2159/2159 - 85s - loss: 3.2509 - accuracy500: 0.3966 - val_loss: 3.3130 - val_accuracy500: 0.3570 - 85s/epoch - 39ms/step
Epoch 8/50
2159/2159 - 83s - loss: 3.2523 - accuracy500: 0.3969 - val_loss: 3.3166 - val_accuracy500: 0.3605 - 83s/epoch - 38ms/step
Epoch 9/50
2159/2159 - 85s - loss: 3.2486 - accuracy500: 0.3999 - val_loss: 3.3266 - val_accuracy500: 0.3587 - 85s/epoch - 39ms/step
Epoch 10/50
2159/2159 - 85s - loss: 3.2467 - accuracy500: 0.4005 - val_loss: 3.3153 - val_accuracy500: 0.3603 - 85s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 83s - loss: 3.2455 - accuracy500: 0.4040 - val_loss: 3.3386 - val_accuracy500: 0.3432 - 83s/epoch - 39ms/step
Epoch 12/50
2159/2159 - 83s - loss: 3.2416 - accuracy500: 0.4044 - val_loss: 3.3196 - val_accuracy500: 0.3607 - 83s/epoch - 38ms/step
testing model: results/AAL/W3/deepVOL_L3/h500
Evaluating performance on  test set...
5760/5760 - 98s - 98s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.100617
{'0': {'precision': 0.35726866278282077, 'recall': 0.02510476981106209, 'f1-score': 0.046913026770846675, 'support': 525199}, '1': {'precision': 0.31624410164040606, 'recall': 0.9653629895222614, 'f1-score': 0.4764180121715876, 'support': 466322}, '2': {'precision': 0.32954464729700933, 'recall': 0.009605549228698622, 'f1-score': 0.018666993946002932, 'support': 482950}, 'accuracy': 0.31739790067081686, 'macro avg': {'precision': 0.33435247057341205, 'recall': 0.33335776952067403, 'f1-score': 0.1806660109628124, 'support': 1474471}, 'weighted avg': {'precision': 0.33521331637049673, 'recall': 0.31739790067081686, 'f1-score': 0.17349822393598996, 'support': 1474471}}
[[ 13185 507077   4937]
 [ 11651 450170   4501]
 [ 12069 466242   4639]]
Evaluating performance on  train set...
2159/2159 - 36s - 36s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994565
{'0': {'precision': 0.33970290815259085, 'recall': 0.026329445087080138, 'f1-score': 0.04887103004399496, 'support': 185002}, '1': {'precision': 0.3303651904819132, 'recall': 0.9642332566041872, 'f1-score': 0.49212032380238424, 'support': 182460}, '2': {'precision': 0.3412305516265912, 'recall': 0.010428092091399796, 'f1-score': 0.020237714501423455, 'support': 185077}, 'accuracy': 0.3307187365959688, 'macro avg': {'precision': 0.33709955008703174, 'recall': 0.33366359792755573, 'f1-score': 0.1870763561159342, 'support': 552539}, 'weighted avg': {'precision': 0.33713109277855524, 'recall': 0.3307187365959688, 'f1-score': 0.185650330687901, 'support': 552539}}
[[  4871 178222   1909]
 [  4709 175934   1817]
 [  4759 178388   1930]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018264
{'0': {'precision': 0.36378349217766587, 'recall': 0.02604542177361211, 'f1-score': 0.04861052707459781, 'support': 77672}, '1': {'precision': 0.29889905633400055, 'recall': 0.9668542357203422, 'f1-score': 0.456632142272057, 'support': 64865}, '2': {'precision': 0.35692464358452136, 'recall': 0.009370655544861512, 'f1-score': 0.018261866305423854, 'support': 74808}, 'accuracy': 0.3010835307920587, 'macro avg': {'precision': 0.3398690640320626, 'recall': 0.334090104346272, 'f1-score': 0.1745015118840262, 'support': 217345}, 'weighted avg': {'precision': 0.3420584666350709, 'recall': 0.3010835307920587, 'f1-score': 0.15993583685841076, 'support': 217345}}
[[ 2023 74926   723]
 [ 1610 62715   540]
 [ 1928 72179   701]]
training model: results/AAL/W3/deepVOL_L3/h1000
Epoch 1/50
2159/2159 - 88s - loss: 3.2714 - accuracy1000: 0.3875 - val_loss: 3.2503 - val_accuracy1000: 0.3821 - 88s/epoch - 41ms/step
Epoch 2/50
2159/2159 - 84s - loss: 3.2676 - accuracy1000: 0.3794 - val_loss: 3.2528 - val_accuracy1000: 0.3848 - 84s/epoch - 39ms/step
Epoch 3/50
2159/2159 - 82s - loss: 3.2668 - accuracy1000: 0.3808 - val_loss: 3.2658 - val_accuracy1000: 0.3882 - 82s/epoch - 38ms/step
Epoch 4/50
2159/2159 - 82s - loss: 3.2544 - accuracy1000: 0.3944 - val_loss: 3.3090 - val_accuracy1000: 0.3818 - 82s/epoch - 38ms/step
Epoch 5/50
2159/2159 - 82s - loss: 3.2562 - accuracy1000: 0.3889 - val_loss: 3.2798 - val_accuracy1000: 0.3879 - 82s/epoch - 38ms/step
Epoch 6/50
2159/2159 - 82s - loss: 3.2446 - accuracy1000: 0.3974 - val_loss: 3.2822 - val_accuracy1000: 0.3839 - 82s/epoch - 38ms/step
Epoch 7/50
2159/2159 - 82s - loss: 3.2353 - accuracy1000: 0.4035 - val_loss: 3.2930 - val_accuracy1000: 0.3852 - 82s/epoch - 38ms/step
Epoch 8/50
2159/2159 - 82s - loss: 3.2237 - accuracy1000: 0.4132 - val_loss: 3.2806 - val_accuracy1000: 0.3882 - 82s/epoch - 38ms/step
Epoch 9/50
2159/2159 - 82s - loss: 3.2131 - accuracy1000: 0.4184 - val_loss: 3.3212 - val_accuracy1000: 0.3844 - 82s/epoch - 38ms/step
Epoch 10/50
2159/2159 - 84s - loss: 3.2021 - accuracy1000: 0.4236 - val_loss: 3.3659 - val_accuracy1000: 0.3754 - 84s/epoch - 39ms/step
Epoch 11/50
2159/2159 - 84s - loss: 3.1919 - accuracy1000: 0.4280 - val_loss: 3.3785 - val_accuracy1000: 0.3799 - 84s/epoch - 39ms/step
testing model: results/AAL/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
5760/5760 - 98s - 98s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0791432
{'0': {'precision': 0.4012475043350557, 'recall': 0.4667160867441103, 'f1-score': 0.4315127200353201, 'support': 589504}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 347288}, '2': {'precision': 0.3679974137275286, 'recall': 0.5398555643794903, 'f1-score': 0.437659965366438, 'support': 537679}, 'accuracy': 0.3834595593945218, 'macro avg': {'precision': 0.25641497268752805, 'recall': 0.3355238837078669, 'f1-score': 0.2897242284672527, 'support': 1474471}, 'weighted avg': {'precision': 0.2946151468636118, 'recall': 0.3834595593945218, 'f1-score': 0.3321184662363399, 'support': 1474471}}
[[275131      1 314372]
 [163149      0 184139]
 [247409      1 290269]]
Evaluating performance on  train set...
2159/2159 - 38s - 38s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089218
{'0': {'precision': 0.3356047761624761, 'recall': 0.5026202619181398, 'f1-score': 0.40247368625975005, 'support': 185096}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 182918}, '2': {'precision': 0.3367607480505141, 'recall': 0.5024793388429752, 'f1-score': 0.40325842550026747, 'support': 184525}, 'accuracy': 0.33618079447785587, 'macro avg': {'precision': 0.22412184140433009, 'recall': 0.33503320025370503, 'f1-score': 0.2685773705866725, 'support': 552539}, 'weighted avg': {'precision': 0.2248888832871359, 'recall': 0.33618079447785587, 'f1-score': 0.26949686881355267, 'support': 552539}}
[[93033     0 92063]
 [92372     0 90546]
 [91805     0 92720]]
Evaluating performance on  val set...
850/850 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0838618
{'0': {'precision': 0.3964935683658885, 'recall': 0.4940341212646476, 'f1-score': 0.43992197865513616, 'support': 84229}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 54831}, '2': {'precision': 0.36820143244806264, 'recall': 0.5286325605160631, 'f1-score': 0.43406754772393535, 'support': 78285}, 'accuracy': 0.38186293680553957, 'macro avg': {'precision': 0.25489833360465036, 'recall': 0.3408888939269035, 'f1-score': 0.2913298421263572, 'support': 217345}, 'weighted avg': {'precision': 0.2862771442135177, 'recall': 0.38186293680553957, 'f1-score': 0.3268313801270411, 'support': 217345}}
[[41612     0 42617]
 [26437     0 28394]
 [36901     0 41384]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        30 (peak)  14.87 (ave)

============================================
