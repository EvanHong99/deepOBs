This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-22.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-14.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-01.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-02.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-10.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-06.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-08.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-03.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-24.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-07.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-20.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-09.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-04-30.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-16.csv
data/QRTEA_orderbooks/QRTEA_orderbooks_2019-05-15.csv
training model: results/QRTEA/W3/deepLOB_L1/h10
Epoch 1/50
641/641 - 21s - loss: 3.0947 - accuracy10: 0.4345 - val_loss: 2.9246 - val_accuracy10: 0.4291 - 21s/epoch - 33ms/step
Epoch 2/50
641/641 - 11s - loss: 2.9958 - accuracy10: 0.4539 - val_loss: 2.8587 - val_accuracy10: 0.4469 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 2.9354 - accuracy10: 0.4775 - val_loss: 2.8308 - val_accuracy10: 0.5074 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 2.8883 - accuracy10: 0.4968 - val_loss: 2.7374 - val_accuracy10: 0.5454 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 2.8516 - accuracy10: 0.5109 - val_loss: 2.7219 - val_accuracy10: 0.5325 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 2.8194 - accuracy10: 0.5223 - val_loss: 2.7233 - val_accuracy10: 0.5363 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 2.8002 - accuracy10: 0.5284 - val_loss: 2.7066 - val_accuracy10: 0.5413 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 2.7723 - accuracy10: 0.5393 - val_loss: 2.6683 - val_accuracy10: 0.5619 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 2.7510 - accuracy10: 0.5476 - val_loss: 2.6579 - val_accuracy10: 0.5663 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 11s - loss: 2.7393 - accuracy10: 0.5554 - val_loss: 2.6559 - val_accuracy10: 0.5521 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 2.7208 - accuracy10: 0.5589 - val_loss: 2.6240 - val_accuracy10: 0.5713 - 11s/epoch - 17ms/step
Epoch 12/50
641/641 - 11s - loss: 2.7053 - accuracy10: 0.5648 - val_loss: 2.6183 - val_accuracy10: 0.5598 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 2.6912 - accuracy10: 0.5690 - val_loss: 2.6241 - val_accuracy10: 0.5576 - 11s/epoch - 17ms/step
Epoch 14/50
641/641 - 11s - loss: 2.6800 - accuracy10: 0.5704 - val_loss: 2.6213 - val_accuracy10: 0.5609 - 11s/epoch - 17ms/step
Epoch 15/50
641/641 - 11s - loss: 2.6672 - accuracy10: 0.5739 - val_loss: 2.6204 - val_accuracy10: 0.5582 - 11s/epoch - 17ms/step
Epoch 16/50
641/641 - 11s - loss: 2.6523 - accuracy10: 0.5777 - val_loss: 2.5983 - val_accuracy10: 0.5772 - 11s/epoch - 17ms/step
Epoch 17/50
641/641 - 11s - loss: 2.6495 - accuracy10: 0.5788 - val_loss: 2.6012 - val_accuracy10: 0.5711 - 11s/epoch - 17ms/step
Epoch 18/50
641/641 - 11s - loss: 2.6395 - accuracy10: 0.5808 - val_loss: 2.5980 - val_accuracy10: 0.5678 - 11s/epoch - 17ms/step
Epoch 19/50
641/641 - 11s - loss: 2.6310 - accuracy10: 0.5808 - val_loss: 2.6143 - val_accuracy10: 0.5629 - 11s/epoch - 17ms/step
Epoch 20/50
641/641 - 11s - loss: 2.6237 - accuracy10: 0.5820 - val_loss: 2.6261 - val_accuracy10: 0.5563 - 11s/epoch - 17ms/step
Epoch 21/50
641/641 - 11s - loss: 2.6166 - accuracy10: 0.5838 - val_loss: 2.6118 - val_accuracy10: 0.5584 - 11s/epoch - 17ms/step
Epoch 22/50
641/641 - 11s - loss: 2.6118 - accuracy10: 0.5848 - val_loss: 2.6045 - val_accuracy10: 0.5629 - 11s/epoch - 17ms/step
Epoch 23/50
641/641 - 11s - loss: 2.6058 - accuracy10: 0.5865 - val_loss: 2.5954 - val_accuracy10: 0.5672 - 11s/epoch - 17ms/step
Epoch 24/50
641/641 - 11s - loss: 2.5961 - accuracy10: 0.5859 - val_loss: 2.6096 - val_accuracy10: 0.5697 - 11s/epoch - 17ms/step
Epoch 25/50
641/641 - 11s - loss: 2.5912 - accuracy10: 0.5889 - val_loss: 2.6124 - val_accuracy10: 0.5635 - 11s/epoch - 17ms/step
Epoch 26/50
641/641 - 11s - loss: 2.5860 - accuracy10: 0.5885 - val_loss: 2.6008 - val_accuracy10: 0.5642 - 11s/epoch - 17ms/step
Epoch 27/50
641/641 - 11s - loss: 2.5795 - accuracy10: 0.5892 - val_loss: 2.6170 - val_accuracy10: 0.5657 - 11s/epoch - 17ms/step
Epoch 28/50
641/641 - 11s - loss: 2.5723 - accuracy10: 0.5906 - val_loss: 2.6206 - val_accuracy10: 0.5594 - 11s/epoch - 17ms/step
Epoch 29/50
641/641 - 11s - loss: 2.5685 - accuracy10: 0.5909 - val_loss: 2.6323 - val_accuracy10: 0.5455 - 11s/epoch - 16ms/step
Epoch 30/50
641/641 - 11s - loss: 2.5629 - accuracy10: 0.5927 - val_loss: 2.6096 - val_accuracy10: 0.5513 - 11s/epoch - 16ms/step
Epoch 31/50
641/641 - 11s - loss: 2.5593 - accuracy10: 0.5934 - val_loss: 2.6330 - val_accuracy10: 0.5481 - 11s/epoch - 17ms/step
Epoch 32/50
641/641 - 11s - loss: 2.5510 - accuracy10: 0.5941 - val_loss: 2.6267 - val_accuracy10: 0.5467 - 11s/epoch - 17ms/step
Epoch 33/50
641/641 - 11s - loss: 2.5476 - accuracy10: 0.5950 - val_loss: 2.6471 - val_accuracy10: 0.5412 - 11s/epoch - 17ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h10
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8193523
{'0': {'precision': 0.3414420062695925, 'recall': 0.4781387181738367, 'f1-score': 0.39839063643013894, 'support': 34170}, '1': {'precision': 0.9137109581789307, 'recall': 0.5944293770717638, 'f1-score': 0.7202733366370205, 'support': 301977}, '2': {'precision': 0.19345907319532357, 'recall': 0.7298194771478597, 'f1-score': 0.3058452935930117, 'support': 33126}, 'accuracy': 0.5958139371142759, 'macro avg': {'precision': 0.4828706792146156, 'recall': 0.6007958574644867, 'f1-score': 0.4748364222200571, 'support': 369273}, 'weighted avg': {'precision': 0.7961461916546815, 'recall': 0.595813937114276, 'f1-score': 0.6533118333049465, 'support': 369273}}
[[ 16338  11078   6754]
 [ 28436 179504  94037]
 [  3076   5874  24176]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9134084
{'0': {'precision': 0.3813932840790183, 'recall': 0.4332072753466595, 'f1-score': 0.4056524231897744, 'support': 27765}, '1': {'precision': 0.826811822148064, 'recall': 0.551884682447668, 'f1-score': 0.6619365152361243, 'support': 109541}, '2': {'precision': 0.30317564497399907, 'recall': 0.6729799394822369, 'f1-score': 0.4180299338670379, 'support': 26769}, 'accuracy': 0.5515587383818376, 'macro avg': {'precision': 0.5037935837336938, 'recall': 0.5526906324255214, 'f1-score': 0.4952062907643122, 'support': 164075}, 'weighted avg': {'precision': 0.6660057119164042, 'recall': 0.5515587383818376, 'f1-score': 0.5787741620906971, 'support': 164075}}
[[12028  7743  7994]
 [15675 60454 33412]
 [ 3834  4920 18015]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8862959
{'0': {'precision': 0.3351808853269418, 'recall': 0.45454545454545453, 'f1-score': 0.38584238661838244, 'support': 9845}, '1': {'precision': 0.8302043624064892, 'recall': 0.5746453724828886, 'f1-score': 0.6791802471451684, 'support': 50405}, '2': {'precision': 0.2909697468238735, 'recall': 0.6449554294975689, 'f1-score': 0.40102034389368263, 'support': 9872}, 'accuracy': 0.5676820398733635, 'macro avg': {'precision': 0.4854516648524348, 'recall': 0.558048752175304, 'f1-score': 0.48868099255241115, 'support': 70122}, 'weighted avg': {'precision': 0.6847887972931193, 'recall': 0.5676820398733635, 'f1-score': 0.5988359072549075, 'support': 70122}}
[[ 4475  3559  1811]
 [ 7736 28965 13704]
 [ 1140  2365  6367]]
training model: results/QRTEA/W3/deepLOB_L1/h20
Epoch 1/50
641/641 - 13s - loss: 3.1135 - accuracy20: 0.4481 - val_loss: 3.1205 - val_accuracy20: 0.4335 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.0470 - accuracy20: 0.4503 - val_loss: 3.0532 - val_accuracy20: 0.4713 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 2.9959 - accuracy20: 0.4684 - val_loss: 2.9386 - val_accuracy20: 0.5113 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 2.9465 - accuracy20: 0.4862 - val_loss: 2.9239 - val_accuracy20: 0.5259 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 2.9122 - accuracy20: 0.5036 - val_loss: 2.9486 - val_accuracy20: 0.5207 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 2.8847 - accuracy20: 0.5147 - val_loss: 2.8737 - val_accuracy20: 0.5214 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 2.8628 - accuracy20: 0.5229 - val_loss: 2.8977 - val_accuracy20: 0.4760 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 2.8440 - accuracy20: 0.5282 - val_loss: 2.8948 - val_accuracy20: 0.4889 - 11s/epoch - 16ms/step
Epoch 9/50
641/641 - 11s - loss: 2.8237 - accuracy20: 0.5377 - val_loss: 2.9018 - val_accuracy20: 0.4740 - 11s/epoch - 16ms/step
Epoch 10/50
641/641 - 11s - loss: 2.8088 - accuracy20: 0.5422 - val_loss: 2.8877 - val_accuracy20: 0.5810 - 11s/epoch - 16ms/step
Epoch 11/50
641/641 - 11s - loss: 2.7924 - accuracy20: 0.5470 - val_loss: 2.9506 - val_accuracy20: 0.5372 - 11s/epoch - 17ms/step
Epoch 12/50
641/641 - 11s - loss: 2.7762 - accuracy20: 0.5529 - val_loss: 2.9103 - val_accuracy20: 0.5746 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 2.7621 - accuracy20: 0.5567 - val_loss: 2.9099 - val_accuracy20: 0.5592 - 11s/epoch - 16ms/step
Epoch 14/50
641/641 - 10s - loss: 2.7505 - accuracy20: 0.5604 - val_loss: 2.9102 - val_accuracy20: 0.5398 - 10s/epoch - 16ms/step
Epoch 15/50
641/641 - 11s - loss: 2.7327 - accuracy20: 0.5650 - val_loss: 2.8847 - val_accuracy20: 0.5337 - 11s/epoch - 16ms/step
Epoch 16/50
641/641 - 11s - loss: 2.7194 - accuracy20: 0.5682 - val_loss: 2.8836 - val_accuracy20: 0.5259 - 11s/epoch - 17ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h20
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96064717
{'0': {'precision': 0.364501985284432, 'recall': 0.4195001516004678, 'f1-score': 0.39007199315309876, 'support': 46174}, '1': {'precision': 0.8322141925734551, 'recall': 0.49118882527260693, 'f1-score': 0.6177623990772779, 'support': 278056}, '2': {'precision': 0.2101198542277888, 'recall': 0.7091445951646205, 'f1-score': 0.32418388214816735, 'support': 45043}, 'accuracy': 0.5088105547927956, 'macro avg': {'precision': 0.46894534402855864, 'recall': 0.5399445240125651, 'f1-score': 0.4440060914595147, 'support': 369273}, 'weighted avg': {'precision': 0.6978498097416012, 'recall': 0.5088105547927956, 'f1-score': 0.5534819508961735, 'support': 369273}}
[[ 19370  17392   9412]
 [ 30814 136578 110664]
 [  2957  10144  31942]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.97740537
{'0': {'precision': 0.4121494624464326, 'recall': 0.30754558204768584, 'f1-score': 0.3522457109811733, 'support': 35650}, '1': {'precision': 0.6611179080314883, 'recall': 0.5698991168731558, 'f1-score': 0.6121288403226729, 'support': 93871}, '2': {'precision': 0.34796831347031154, 'recall': 0.569514383284135, 'f1-score': 0.4319927997541379, 'support': 34554}, 'accuracy': 0.5128142617705318, 'macro avg': {'precision': 0.4737452279827441, 'recall': 0.4823196940683255, 'f1-score': 0.4654557836859947, 'support': 164075}, 'weighted avg': {'precision': 0.5410734394922585, 'recall': 0.5128142617705318, 'f1-score': 0.5177253400524938, 'support': 164075}}
[[10964 16347  8339]
 [11838 53497 28536]
 [ 3800 11075 19679]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9744383
{'0': {'precision': 0.3710202604920405, 'recall': 0.3150537634408602, 'f1-score': 0.3407542781192889, 'support': 13020}, '1': {'precision': 0.6927956254272044, 'recall': 0.5764103730664241, 'f1-score': 0.6292667784193208, 'support': 43960}, '2': {'precision': 0.32448534969543374, 'recall': 0.55531882514077, 'f1-score': 0.4096202957932254, 'support': 13142}, 'accuracy': 0.5239297224836713, 'macro avg': {'precision': 0.46276707853822624, 'recall': 0.4822609872160181, 'f1-score': 0.4598804507772783, 'support': 70122}, 'weighted avg': {'precision': 0.5640222177217373, 'recall': 0.5239297224836713, 'f1-score': 0.5345315052015209, 'support': 70122}}
[[ 4102  6617  2301]
 [ 5729 25339 12892]
 [ 1225  4619  7298]]
training model: results/QRTEA/W3/deepLOB_L1/h30
Epoch 1/50
641/641 - 13s - loss: 3.1542 - accuracy30: 0.4349 - val_loss: 3.1159 - val_accuracy30: 0.4921 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.0713 - accuracy30: 0.4550 - val_loss: 3.0874 - val_accuracy30: 0.4947 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.0383 - accuracy30: 0.4718 - val_loss: 3.0548 - val_accuracy30: 0.4897 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.0000 - accuracy30: 0.4845 - val_loss: 3.0376 - val_accuracy30: 0.5438 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 2.9664 - accuracy30: 0.4998 - val_loss: 2.9813 - val_accuracy30: 0.5006 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 2.9465 - accuracy30: 0.5058 - val_loss: 2.9595 - val_accuracy30: 0.5050 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 2.9160 - accuracy30: 0.5141 - val_loss: 2.9258 - val_accuracy30: 0.5237 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 2.8922 - accuracy30: 0.5233 - val_loss: 2.9364 - val_accuracy30: 0.4931 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 2.8711 - accuracy30: 0.5318 - val_loss: 2.9391 - val_accuracy30: 0.4884 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 11s - loss: 2.8498 - accuracy30: 0.5364 - val_loss: 2.9300 - val_accuracy30: 0.4889 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 2.8339 - accuracy30: 0.5421 - val_loss: 2.9057 - val_accuracy30: 0.4936 - 11s/epoch - 17ms/step
Epoch 12/50
641/641 - 11s - loss: 2.8268 - accuracy30: 0.5440 - val_loss: 2.8866 - val_accuracy30: 0.4960 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 2.8125 - accuracy30: 0.5475 - val_loss: 2.8733 - val_accuracy30: 0.5035 - 11s/epoch - 17ms/step
Epoch 14/50
641/641 - 11s - loss: 2.7982 - accuracy30: 0.5502 - val_loss: 2.8875 - val_accuracy30: 0.4927 - 11s/epoch - 17ms/step
Epoch 15/50
641/641 - 11s - loss: 2.7900 - accuracy30: 0.5524 - val_loss: 2.8857 - val_accuracy30: 0.4933 - 11s/epoch - 17ms/step
Epoch 16/50
641/641 - 11s - loss: 2.7803 - accuracy30: 0.5549 - val_loss: 2.8858 - val_accuracy30: 0.4860 - 11s/epoch - 17ms/step
Epoch 17/50
641/641 - 11s - loss: 2.7713 - accuracy30: 0.5538 - val_loss: 2.8907 - val_accuracy30: 0.4877 - 11s/epoch - 17ms/step
Epoch 18/50
641/641 - 10s - loss: 2.7632 - accuracy30: 0.5570 - val_loss: 2.8859 - val_accuracy30: 0.5018 - 10s/epoch - 16ms/step
Epoch 19/50
641/641 - 11s - loss: 2.7568 - accuracy30: 0.5585 - val_loss: 2.8691 - val_accuracy30: 0.4997 - 11s/epoch - 17ms/step
Epoch 20/50
641/641 - 11s - loss: 2.7510 - accuracy30: 0.5583 - val_loss: 2.8676 - val_accuracy30: 0.4975 - 11s/epoch - 17ms/step
Epoch 21/50
641/641 - 11s - loss: 2.7399 - accuracy30: 0.5608 - val_loss: 2.8847 - val_accuracy30: 0.4931 - 11s/epoch - 17ms/step
Epoch 22/50
641/641 - 11s - loss: 2.7337 - accuracy30: 0.5618 - val_loss: 2.8846 - val_accuracy30: 0.4954 - 11s/epoch - 16ms/step
Epoch 23/50
641/641 - 11s - loss: 2.7289 - accuracy30: 0.5619 - val_loss: 2.8937 - val_accuracy30: 0.4856 - 11s/epoch - 17ms/step
Epoch 24/50
641/641 - 11s - loss: 2.7213 - accuracy30: 0.5643 - val_loss: 2.9086 - val_accuracy30: 0.4964 - 11s/epoch - 17ms/step
Epoch 25/50
641/641 - 11s - loss: 2.7159 - accuracy30: 0.5651 - val_loss: 2.8922 - val_accuracy30: 0.4846 - 11s/epoch - 17ms/step
Epoch 26/50
641/641 - 11s - loss: 2.7092 - accuracy30: 0.5675 - val_loss: 2.9232 - val_accuracy30: 0.4720 - 11s/epoch - 17ms/step
Epoch 27/50
641/641 - 11s - loss: 2.7052 - accuracy30: 0.5671 - val_loss: 2.8937 - val_accuracy30: 0.4793 - 11s/epoch - 17ms/step
Epoch 28/50
641/641 - 11s - loss: 2.6998 - accuracy30: 0.5690 - val_loss: 2.9090 - val_accuracy30: 0.5012 - 11s/epoch - 17ms/step
Epoch 29/50
641/641 - 11s - loss: 2.6973 - accuracy30: 0.5691 - val_loss: 2.9261 - val_accuracy30: 0.4880 - 11s/epoch - 17ms/step
Epoch 30/50
641/641 - 11s - loss: 2.6915 - accuracy30: 0.5712 - val_loss: 2.9097 - val_accuracy30: 0.5088 - 11s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h30
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97330683
{'0': {'precision': 0.42994556021481645, 'recall': 0.42264648984831227, 'f1-score': 0.42626478123319017, 'support': 55311}, '1': {'precision': 0.8183238758632563, 'recall': 0.47537338979856375, 'f1-score': 0.6013916936327584, 'support': 259983}, '2': {'precision': 0.24733026593602403, 'recall': 0.7508660775486763, 'f1-score': 0.37209494475632654, 'support': 53979}, 'accuracy': 0.507746301516764, 'macro avg': {'precision': 0.498533234004699, 'recall': 0.5496286523985174, 'f1-score': 0.4665838065407583, 'support': 369273}, 'weighted avg': {'precision': 0.6766854211506373, 'recall': 0.507746301516764, 'f1-score': 0.5416427982103109, 'support': 369273}}
[[ 23377  17873  14061]
 [ 27112 123589 109282]
 [  3883   9565  40531]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0090892
{'0': {'precision': 0.4853743990874277, 'recall': 0.29210287591634587, 'f1-score': 0.3647161465109516, 'support': 40787}, '1': {'precision': 0.6880055124440142, 'recall': 0.5017648396089833, 'f1-score': 0.5803085864526395, 'support': 83577}, '2': {'precision': 0.36973121563836286, 'recall': 0.7315857067311324, 'f1-score': 0.4912120520429126, 'support': 39711}, 'accuracy': 0.5052689318909036, 'macro avg': {'precision': 0.5143703757232682, 'recall': 0.5084844740854871, 'f1-score': 0.4787455950021679, 'support': 164075}, 'weighted avg': {'precision': 0.5606021553151139, 'recall': 0.5052689318909036, 'f1-score': 0.5051509979970777, 'support': 164075}}
[[11914 11450 17423]
 [ 9540 41936 32101]
 [ 3092  7567 29052]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9941254
{'0': {'precision': 0.4144649052575394, 'recall': 0.4103309333509479, 'f1-score': 0.41238755933216054, 'support': 15139}, '1': {'precision': 0.6816270836406549, 'recall': 0.46746250537444045, 'f1-score': 0.5545870527342285, 'support': 39539}, '2': {'precision': 0.36494396459418943, 'recall': 0.662069412069412, 'f1-score': 0.47052597671529156, 'support': 15444}, 'accuracy': 0.49798921879010866, 'macro avg': {'precision': 0.48701198449746125, 'recall': 0.5132876169316001, 'f1-score': 0.4791668629272268, 'support': 70122}, 'weighted avg': {'precision': 0.5542002802252417, 'recall': 0.49798921879010866, 'f1-score': 0.5053728633407375, 'support': 70122}}
[[ 6212  5120  3807]
 [ 7070 18483 13986]
 [ 1706  3513 10225]]
training model: results/QRTEA/W3/deepLOB_L1/h50
Epoch 1/50
641/641 - 13s - loss: 3.1667 - accuracy50: 0.4330 - val_loss: 3.2596 - val_accuracy50: 0.3959 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.1463 - accuracy50: 0.4413 - val_loss: 3.1235 - val_accuracy50: 0.4222 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.0983 - accuracy50: 0.4544 - val_loss: 3.1254 - val_accuracy50: 0.4090 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.0624 - accuracy50: 0.4705 - val_loss: 3.0958 - val_accuracy50: 0.4503 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.0355 - accuracy50: 0.4772 - val_loss: 3.0637 - val_accuracy50: 0.4451 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 3.0156 - accuracy50: 0.4849 - val_loss: 3.0679 - val_accuracy50: 0.4519 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 2.9967 - accuracy50: 0.4931 - val_loss: 3.0944 - val_accuracy50: 0.4515 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 2.9827 - accuracy50: 0.4977 - val_loss: 3.0743 - val_accuracy50: 0.4604 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 2.9697 - accuracy50: 0.5024 - val_loss: 3.0919 - val_accuracy50: 0.4652 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 11s - loss: 2.9578 - accuracy50: 0.5058 - val_loss: 3.1013 - val_accuracy50: 0.4538 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 2.9481 - accuracy50: 0.5089 - val_loss: 3.1179 - val_accuracy50: 0.4465 - 11s/epoch - 17ms/step
Epoch 12/50
641/641 - 11s - loss: 2.9366 - accuracy50: 0.5136 - val_loss: 3.1131 - val_accuracy50: 0.4552 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 2.9296 - accuracy50: 0.5164 - val_loss: 3.1170 - val_accuracy50: 0.4590 - 11s/epoch - 17ms/step
Epoch 14/50
641/641 - 11s - loss: 2.9228 - accuracy50: 0.5185 - val_loss: 3.1394 - val_accuracy50: 0.4422 - 11s/epoch - 17ms/step
Epoch 15/50
641/641 - 11s - loss: 2.9115 - accuracy50: 0.5216 - val_loss: 3.1358 - val_accuracy50: 0.4529 - 11s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h50
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0490891
{'0': {'precision': 0.4000120831319478, 'recall': 0.37628939217413543, 'f1-score': 0.38778827146936085, 'support': 70382}, '1': {'precision': 0.728164320529393, 'recall': 0.26676253741783285, 'f1-score': 0.3904748580259083, 'support': 230171}, '2': {'precision': 0.25304696857485076, 'recall': 0.8054714784633294, 'f1-score': 0.38510829257432294, 'support': 68720}, 'accuracy': 0.38788917684206536, 'macro avg': {'precision': 0.46040779074539717, 'recall': 0.4828411360184326, 'f1-score': 0.3877904740231974, 'support': 369273}, 'weighted avg': {'precision': 0.5772026331089124, 'recall': 0.38788917684206536, 'f1-score': 0.38896411201183234, 'support': 369273}}
[[ 26484  14952  28946]
 [ 34326  61401 134444]
 [  5398   7970  55352]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.044063
{'0': {'precision': 0.4699680378564609, 'recall': 0.23596348630736527, 'f1-score': 0.314181454913768, 'support': 47982}, '1': {'precision': 0.5453044685401268, 'recall': 0.42142805364262415, 'f1-score': 0.47542954342866023, 'support': 68975}, '2': {'precision': 0.38287685456517223, 'recall': 0.7043380449085275, 'f1-score': 0.4960835899428981, 'support': 47118}, 'accuracy': 0.4484351668444309, 'macro avg': {'precision': 0.4660497869872533, 'recall': 0.45390986161950564, 'f1-score': 0.42856486276177547, 'support': 164075}, 'weighted avg': {'precision': 0.4766282111435974, 'recall': 0.4484351668444309, 'f1-score': 0.4342055396531691, 'support': 164075}}
[[11322 14220 22440]
 [ 8856 29068 31051]
 [ 3913 10018 33187]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0336852
{'0': {'precision': 0.45383054287163876, 'recall': 0.29342299491553225, 'f1-score': 0.3564100009961152, 'support': 18291}, '1': {'precision': 0.5362976758623366, 'recall': 0.4182527914788029, 'f1-score': 0.4699761985719143, 'support': 33047}, '2': {'precision': 0.3716754296959075, 'recall': 0.643526405451448, 'f1-score': 0.4712027598573294, 'support': 18784}, 'accuracy': 0.4460369071047603, 'macro avg': {'precision': 0.4539345494766276, 'recall': 0.45173406394859433, 'f1-score': 0.4325296531417863, 'support': 70122}, 'weighted avg': {'precision': 0.4706881581428897, 'recall': 0.4460369071047603, 'f1-score': 0.44068154649876035, 'support': 70122}}
[[ 5367  6750  6174]
 [ 4964 13822 14261]
 [ 1495  5201 12088]]
training model: results/QRTEA/W3/deepLOB_L1/h100
Epoch 1/50
641/641 - 13s - loss: 3.2333 - accuracy100: 0.4058 - val_loss: 3.3240 - val_accuracy100: 0.3690 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.1888 - accuracy100: 0.4275 - val_loss: 3.3154 - val_accuracy100: 0.3765 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.1771 - accuracy100: 0.4305 - val_loss: 3.2328 - val_accuracy100: 0.3964 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.1491 - accuracy100: 0.4448 - val_loss: 3.2851 - val_accuracy100: 0.3907 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.1284 - accuracy100: 0.4527 - val_loss: 3.2435 - val_accuracy100: 0.4033 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 3.1150 - accuracy100: 0.4591 - val_loss: 3.2571 - val_accuracy100: 0.3980 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 3.1090 - accuracy100: 0.4605 - val_loss: 3.2648 - val_accuracy100: 0.3966 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 3.1019 - accuracy100: 0.4622 - val_loss: 3.2961 - val_accuracy100: 0.3924 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 3.0918 - accuracy100: 0.4651 - val_loss: 3.3342 - val_accuracy100: 0.3919 - 11s/epoch - 16ms/step
Epoch 10/50
641/641 - 11s - loss: 3.0861 - accuracy100: 0.4673 - val_loss: 3.3206 - val_accuracy100: 0.3965 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 3.0789 - accuracy100: 0.4713 - val_loss: 3.2862 - val_accuracy100: 0.4056 - 11s/epoch - 16ms/step
Epoch 12/50
641/641 - 11s - loss: 3.0760 - accuracy100: 0.4700 - val_loss: 3.3212 - val_accuracy100: 0.3985 - 11s/epoch - 16ms/step
Epoch 13/50
641/641 - 10s - loss: 3.0681 - accuracy100: 0.4744 - val_loss: 3.2909 - val_accuracy100: 0.4004 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h100
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0737821
{'0': {'precision': 0.482663669570104, 'recall': 0.09216851955187363, 'f1-score': 0.15478046187253905, 'support': 93188}, '1': {'precision': 0.535512914466895, 'recall': 0.38608598138902966, 'f1-score': 0.4486854966040951, 'support': 185482}, '2': {'precision': 0.28382747345604176, 'recall': 0.6821407679657406, 'f1-score': 0.4008626420846103, 'support': 90603}, 'accuracy': 0.3845528917630046, 'macro avg': {'precision': 0.43400135249768024, 'recall': 0.3867984229688813, 'f1-score': 0.3347762001870815, 'support': 369273}, 'weighted avg': {'precision': 0.46042383011643206, 'recall': 0.3845528917630046, 'f1-score': 0.36278342289550247, 'support': 369273}}
[[  8589  36253  48346]
 [  6268  71612 107602]
 [  2938  25861  61804]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0817208
{'0': {'precision': 0.45997049751910957, 'recall': 0.1240057845263919, 'f1-score': 0.19534698294273428, 'support': 55320}, '1': {'precision': 0.3696452514601277, 'recall': 0.6016015090431631, 'f1-score': 0.4579251126126126, 'support': 54074}, '2': {'precision': 0.4027144141934429, 'recall': 0.4503941039849308, 'f1-score': 0.42522186539590456, 'support': 54681}, 'accuracy': 0.39018131951851287, 'macro avg': {'precision': 0.4107767210575601, 'recall': 0.3920004658514953, 'f1-score': 0.35949798698375046, 'support': 164075}, 'weighted avg': {'precision': 0.41112047620127223, 'recall': 0.39018131951851287, 'f1-score': 0.35849455710815137, 'support': 164075}}
[[ 6860 30375 18085]
 [ 3101 32531 18442]
 [ 4953 25100 24628]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0786277
{'0': {'precision': 0.472903421132304, 'recall': 0.07221117840136841, 'f1-score': 0.12529076762653407, 'support': 21631}, '1': {'precision': 0.3864496131598858, 'recall': 0.6135782376191583, 'f1-score': 0.47422093771994195, 'support': 25806}, '2': {'precision': 0.3995589259459878, 'recall': 0.4552347366100948, 'f1-score': 0.4255836475654736, 'support': 22685}, 'accuracy': 0.395353811927783, 'macro avg': {'precision': 0.41963732007939253, 'recall': 0.3803413842102072, 'f1-score': 0.34169845097064994, 'support': 70122}, 'weighted avg': {'precision': 0.417359556983566, 'recall': 0.395353811927783, 'f1-score': 0.35084959297158025, 'support': 70122}}
[[ 1562 13371  6698]
 [ 1151 15834  8821]
 [  590 11768 10327]]
training model: results/QRTEA/W3/deepLOB_L1/h200
Epoch 1/50
641/641 - 13s - loss: 3.2727 - accuracy200: 0.3883 - val_loss: 3.3021 - val_accuracy200: 0.3788 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.2507 - accuracy200: 0.3923 - val_loss: 3.3038 - val_accuracy200: 0.3749 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.2259 - accuracy200: 0.4016 - val_loss: 3.3046 - val_accuracy200: 0.3782 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.2191 - accuracy200: 0.4062 - val_loss: 3.2977 - val_accuracy200: 0.3813 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.2104 - accuracy200: 0.4095 - val_loss: 3.3793 - val_accuracy200: 0.3701 - 11s/epoch - 16ms/step
Epoch 6/50
641/641 - 11s - loss: 3.2036 - accuracy200: 0.4114 - val_loss: 3.3905 - val_accuracy200: 0.3550 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 3.2036 - accuracy200: 0.4156 - val_loss: 3.4100 - val_accuracy200: 0.3496 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 3.1935 - accuracy200: 0.4187 - val_loss: 3.3812 - val_accuracy200: 0.3532 - 11s/epoch - 16ms/step
Epoch 9/50
641/641 - 11s - loss: 3.1889 - accuracy200: 0.4218 - val_loss: 3.4225 - val_accuracy200: 0.3536 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 11s - loss: 3.1881 - accuracy200: 0.4223 - val_loss: 3.4221 - val_accuracy200: 0.3423 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 3.1795 - accuracy200: 0.4263 - val_loss: 3.4063 - val_accuracy200: 0.3482 - 11s/epoch - 16ms/step
Epoch 12/50
641/641 - 10s - loss: 3.1742 - accuracy200: 0.4299 - val_loss: 3.4278 - val_accuracy200: 0.3441 - 10s/epoch - 16ms/step
Epoch 13/50
641/641 - 10s - loss: 3.1703 - accuracy200: 0.4309 - val_loss: 3.4071 - val_accuracy200: 0.3469 - 10s/epoch - 16ms/step
Epoch 14/50
641/641 - 10s - loss: 3.1639 - accuracy200: 0.4342 - val_loss: 3.4210 - val_accuracy200: 0.3355 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h200
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1118778
{'0': {'precision': 0.4036215133302512, 'recall': 0.22913458846584547, 'f1-score': 0.2923200553589964, 'support': 114304}, '1': {'precision': 0.4175191997052739, 'recall': 0.10033096347143908, 'f1-score': 0.1617846495105172, 'support': 146844}, '2': {'precision': 0.31376163153670067, 'recall': 0.7808739884393063, 'f1-score': 0.44765270226206916, 'support': 108125}, 'accuracy': 0.3394670067944312, 'macro avg': {'precision': 0.37830078152407526, 'recall': 0.37011318012553024, 'f1-score': 0.3005858023771943, 'support': 369273}, 'weighted avg': {'precision': 0.38283659848168705, 'recall': 0.3394670067944312, 'f1-score': 0.2858939188962186, 'support': 369273}}
[[ 26191  11061  77052]
 [ 24499  14733 107612]
 [ 14200   9493  84432]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950763
{'0': {'precision': 0.3716733019664616, 'recall': 0.27794518323379225, 'f1-score': 0.3180476121652593, 'support': 55421}, '1': {'precision': 0.3930464198458936, 'recall': 0.38319469383267984, 'f1-score': 0.38805803985601367, 'support': 54578}, '2': {'precision': 0.38208009219245176, 'recall': 0.4904948590872106, 'f1-score': 0.42955237416596487, 'support': 54076}, 'accuracy': 0.3830077708365077, 'macro avg': {'precision': 0.38226660466826895, 'recall': 0.38387824538456083, 'f1-score': 0.37855267539574594, 'support': 164075}, 'weighted avg': {'precision': 0.3822127480483405, 'recall': 0.3830077708365077, 'f1-score': 0.37808576930349574, 'support': 164075}}
[[15404 16941 23076]
 [13844 20914 19820]
 [12197 15355 26524]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990127
{'0': {'precision': 0.36271465686585136, 'recall': 0.2614534326040287, 'f1-score': 0.3038700430004778, 'support': 21893}, '1': {'precision': 0.3950850067565444, 'recall': 0.503605191475725, 'f1-score': 0.44279299110680637, 'support': 24964}, '2': {'precision': 0.37602131438721137, 'recall': 0.36398022781001504, 'f1-score': 0.3699028065960468, 'support': 23265}, 'accuracy': 0.381677647528593, 'macro avg': {'precision': 0.3779403260032024, 'recall': 0.37634628396325626, 'f1-score': 0.372188613567777, 'support': 70122}, 'weighted avg': {'precision': 0.37865363182243705, 'recall': 0.381677647528593, 'f1-score': 0.3752360154709906, 'support': 70122}}
[[ 5724  9427  6742]
 [ 5082 12572  7310]
 [ 4975  9822  8468]]
training model: results/QRTEA/W3/deepLOB_L1/h300
Epoch 1/50
641/641 - 13s - loss: 3.2985 - accuracy300: 0.3731 - val_loss: 3.3911 - val_accuracy300: 0.3357 - 13s/epoch - 21ms/step
Epoch 2/50
641/641 - 11s - loss: 3.2758 - accuracy300: 0.3756 - val_loss: 3.3907 - val_accuracy300: 0.3386 - 11s/epoch - 18ms/step
Epoch 3/50
641/641 - 11s - loss: 3.2571 - accuracy300: 0.3832 - val_loss: 3.3517 - val_accuracy300: 0.3480 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.2488 - accuracy300: 0.3908 - val_loss: 3.3642 - val_accuracy300: 0.3460 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.2452 - accuracy300: 0.3892 - val_loss: 3.3624 - val_accuracy300: 0.3363 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 3.2342 - accuracy300: 0.3990 - val_loss: 3.4017 - val_accuracy300: 0.3413 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 3.2322 - accuracy300: 0.3983 - val_loss: 3.4065 - val_accuracy300: 0.3435 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 3.2213 - accuracy300: 0.4070 - val_loss: 3.4603 - val_accuracy300: 0.3409 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 3.2145 - accuracy300: 0.4095 - val_loss: 3.4762 - val_accuracy300: 0.3348 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 11s - loss: 3.2114 - accuracy300: 0.4120 - val_loss: 3.5197 - val_accuracy300: 0.3339 - 11s/epoch - 17ms/step
Epoch 11/50
641/641 - 11s - loss: 3.2075 - accuracy300: 0.4146 - val_loss: 3.4843 - val_accuracy300: 0.3329 - 11s/epoch - 16ms/step
Epoch 12/50
641/641 - 11s - loss: 3.2045 - accuracy300: 0.4163 - val_loss: 3.5058 - val_accuracy300: 0.3333 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 3.2035 - accuracy300: 0.4173 - val_loss: 3.5129 - val_accuracy300: 0.3321 - 11s/epoch - 17ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h300
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106515
{'0': {'precision': 0.3849946521274098, 'recall': 0.12161315841518887, 'f1-score': 0.1848389015875004, 'support': 121352}, '1': {'precision': 0.39101791752497184, 'recall': 0.1489451476793249, 'f1-score': 0.2157192786843065, 'support': 135090}, '2': {'precision': 0.3219241310710529, 'recall': 0.7974049684927015, 'f1-score': 0.45867457871648404, 'support': 112831}, 'accuracy': 0.3380994548748487, 'macro avg': {'precision': 0.3659789002411449, 'recall': 0.3559877581957384, 'f1-score': 0.2864109196627636, 'support': 369273}, 'weighted avg': {'precision': 0.3679269893447174, 'recall': 0.3380994548748487, 'f1-score': 0.2798059948441097, 'support': 369273}}
[[ 14758  17095  89499]
 [ 14958  20121 100011]
 [  8617  14242  89972]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109437
{'0': {'precision': 0.35255533111791665, 'recall': 0.28460216712837955, 'f1-score': 0.3149551297598836, 'support': 57034}, '1': {'precision': 0.33768143743206086, 'recall': 0.305902569944585, 'f1-score': 0.3210074158122948, 'support': 51791}, '2': {'precision': 0.36434326532334044, 'recall': 0.46897737556561087, 'f1-score': 0.410091242175568, 'support': 55250}, 'accuracy': 0.35341154959622123, 'macro avg': {'precision': 0.35152667795777265, 'recall': 0.35316070421285845, 'f1-score': 0.3486845959159155, 'support': 164075}, 'weighted avg': {'precision': 0.3518297454830881, 'recall': 0.35341154959622123, 'f1-score': 0.34890133824933656, 'support': 164075}}
[[16232 16478 24324]
 [15066 15843 20882]
 [14743 14596 25911]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1171998
{'0': {'precision': 0.3148218635809988, 'recall': 0.3627949820159663, 'f1-score': 0.33711025066231914, 'support': 22798}, '1': {'precision': 0.3422061002401267, 'recall': 0.29265521912002446, 'f1-score': 0.3154969382948658, 'support': 22887}, '2': {'precision': 0.38138979280800756, 'recall': 0.37889266276547856, 'f1-score': 0.38013712690397006, 'support': 24437}, 'accuracy': 0.3455121074698383, 'macro avg': {'precision': 0.34613925220971103, 'recall': 0.34478095463382313, 'f1-score': 0.3442481052870517, 'support': 70122}, 'weighted avg': {'precision': 0.346958190424755, 'recall': 0.3455121074698383, 'f1-score': 0.3450504676350712, 'support': 70122}}
[[8271 6399 8128]
 [9299 6698 6890]
 [8702 6476 9259]]
training model: results/QRTEA/W3/deepLOB_L1/h500
Epoch 1/50
641/641 - 13s - loss: 3.2290 - accuracy500: 0.4237 - val_loss: 3.5004 - val_accuracy500: 0.3137 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.2175 - accuracy500: 0.4227 - val_loss: 3.3985 - val_accuracy500: 0.3452 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.2214 - accuracy500: 0.4197 - val_loss: 3.4082 - val_accuracy500: 0.3391 - 11s/epoch - 16ms/step
Epoch 4/50
641/641 - 11s - loss: 3.2171 - accuracy500: 0.4176 - val_loss: 3.4671 - val_accuracy500: 0.3381 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.2148 - accuracy500: 0.4157 - val_loss: 3.4495 - val_accuracy500: 0.3426 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 3.2017 - accuracy500: 0.4193 - val_loss: 3.4556 - val_accuracy500: 0.3395 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 3.1844 - accuracy500: 0.4270 - val_loss: 3.5322 - val_accuracy500: 0.3382 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 3.1946 - accuracy500: 0.4230 - val_loss: 3.6522 - val_accuracy500: 0.3406 - 11s/epoch - 16ms/step
Epoch 9/50
641/641 - 11s - loss: 3.1919 - accuracy500: 0.4305 - val_loss: 3.5575 - val_accuracy500: 0.3364 - 11s/epoch - 16ms/step
Epoch 10/50
641/641 - 11s - loss: 3.1871 - accuracy500: 0.4326 - val_loss: 3.4103 - val_accuracy500: 0.3423 - 11s/epoch - 16ms/step
Epoch 11/50
641/641 - 11s - loss: 3.1983 - accuracy500: 0.4315 - val_loss: 3.4641 - val_accuracy500: 0.3438 - 11s/epoch - 17ms/step
Epoch 12/50
641/641 - 11s - loss: 3.1815 - accuracy500: 0.4348 - val_loss: 3.3808 - val_accuracy500: 0.3498 - 11s/epoch - 17ms/step
Epoch 13/50
641/641 - 11s - loss: 3.1780 - accuracy500: 0.4369 - val_loss: 3.6211 - val_accuracy500: 0.3498 - 11s/epoch - 17ms/step
Epoch 14/50
641/641 - 10s - loss: 3.1705 - accuracy500: 0.4419 - val_loss: 3.4981 - val_accuracy500: 0.3491 - 10s/epoch - 16ms/step
Epoch 15/50
641/641 - 10s - loss: 3.1666 - accuracy500: 0.4407 - val_loss: 3.5922 - val_accuracy500: 0.3422 - 10s/epoch - 16ms/step
Epoch 16/50
641/641 - 10s - loss: 3.1762 - accuracy500: 0.4407 - val_loss: 3.5113 - val_accuracy500: 0.3512 - 10s/epoch - 16ms/step
Epoch 17/50
641/641 - 10s - loss: 3.1502 - accuracy500: 0.4500 - val_loss: 3.4909 - val_accuracy500: 0.3444 - 10s/epoch - 16ms/step
Epoch 18/50
641/641 - 11s - loss: 3.1531 - accuracy500: 0.4496 - val_loss: 3.5012 - val_accuracy500: 0.3353 - 11s/epoch - 16ms/step
Epoch 19/50
641/641 - 10s - loss: 3.1487 - accuracy500: 0.4518 - val_loss: 3.4266 - val_accuracy500: 0.3429 - 10s/epoch - 16ms/step
Epoch 20/50
641/641 - 10s - loss: 3.1368 - accuracy500: 0.4561 - val_loss: 3.5980 - val_accuracy500: 0.3492 - 10s/epoch - 16ms/step
Epoch 21/50
641/641 - 11s - loss: 3.1549 - accuracy500: 0.4516 - val_loss: 3.4007 - val_accuracy500: 0.3506 - 11s/epoch - 17ms/step
Epoch 22/50
641/641 - 11s - loss: 3.1321 - accuracy500: 0.4581 - val_loss: 3.4460 - val_accuracy500: 0.3461 - 11s/epoch - 17ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h500
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1332275
{'0': {'precision': 0.38300916118737793, 'recall': 0.09909319970959614, 'f1-score': 0.15745039385217396, 'support': 140494}, '1': {'precision': 0.26474199319465397, 'recall': 0.07601502774896005, 'f1-score': 0.11811565850223021, 'support': 99283}, '2': {'precision': 0.35073271203645, 'recall': 0.8244965095446963, 'f1-score': 0.492121692597364, 'support': 129496}, 'accuracy': 0.34727153081866263, 'macro avg': {'precision': 0.3328279554728273, 'recall': 0.3332015790010842, 'f1-score': 0.2558959149839227, 'support': 369273}, 'weighted avg': {'precision': 0.33989311885807094, 'recall': 0.34727153081866263, 'f1-score': 0.2642367659198817, 'support': 369273}}
[[ 13922  10732 115840]
 [  9928   7547  81808]
 [ 12499  10228 106769]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1230818
{'0': {'precision': 0.3432288848443111, 'recall': 0.2548579151143254, 'f1-score': 0.2925147253023665, 'support': 54756}, '1': {'precision': 0.3704483972133777, 'recall': 0.27777478593354515, 'f1-score': 0.31748702271281726, 'support': 55707}, '2': {'precision': 0.356416725865321, 'recall': 0.5427889278519734, 'f1-score': 0.43028878143991484, 'support': 53612}, 'accuracy': 0.3567210117324394, 'macro avg': {'precision': 0.3566980026410033, 'recall': 0.358473876299948, 'f1-score': 0.3467635098183662, 'support': 164075}, 'weighted avg': {'precision': 0.3567796628931423, 'recall': 0.3567210117324394, 'f1-score': 0.3460114461281487, 'support': 164075}}
[[13955 13815 26986]
 [14673 15474 25560]
 [12030 12482 29100]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.126248
{'0': {'precision': 0.32345239342201737, 'recall': 0.12814873220732872, 'f1-score': 0.183569135655689, 'support': 24097}, '1': {'precision': 0.32551816786079835, 'recall': 0.5070752366716492, 'f1-score': 0.3965013441383878, 'support': 20070}, '2': {'precision': 0.38371259936542595, 'recall': 0.43332691196301293, 'f1-score': 0.4070133535989578, 'support': 25955}, 'accuracy': 0.34956219160891017, 'macro avg': {'precision': 0.34422772021608056, 'recall': 0.35618362694733025, 'f1-score': 0.32902794446434486, 'support': 70122}, 'weighted avg': {'precision': 0.3463483995006732, 'recall': 0.34956219160891017, 'f1-score': 0.32721940377361636, 'support': 70122}}
[[ 3088  9862 11147]
 [ 2976 10177  6917]
 [ 3483 11225 11247]]
training model: results/QRTEA/W3/deepLOB_L1/h1000
Epoch 1/50
641/641 - 13s - loss: 3.2446 - accuracy1000: 0.4111 - val_loss: 3.4565 - val_accuracy1000: 0.3038 - 13s/epoch - 20ms/step
Epoch 2/50
641/641 - 11s - loss: 3.2199 - accuracy1000: 0.4201 - val_loss: 3.4751 - val_accuracy1000: 0.2948 - 11s/epoch - 17ms/step
Epoch 3/50
641/641 - 11s - loss: 3.2071 - accuracy1000: 0.4280 - val_loss: 3.4076 - val_accuracy1000: 0.2995 - 11s/epoch - 17ms/step
Epoch 4/50
641/641 - 11s - loss: 3.2026 - accuracy1000: 0.4268 - val_loss: 3.3712 - val_accuracy1000: 0.3317 - 11s/epoch - 17ms/step
Epoch 5/50
641/641 - 11s - loss: 3.2033 - accuracy1000: 0.4274 - val_loss: 3.4038 - val_accuracy1000: 0.3213 - 11s/epoch - 17ms/step
Epoch 6/50
641/641 - 11s - loss: 3.1887 - accuracy1000: 0.4349 - val_loss: 3.3374 - val_accuracy1000: 0.3230 - 11s/epoch - 17ms/step
Epoch 7/50
641/641 - 11s - loss: 3.1824 - accuracy1000: 0.4345 - val_loss: 3.3334 - val_accuracy1000: 0.3207 - 11s/epoch - 17ms/step
Epoch 8/50
641/641 - 11s - loss: 3.1619 - accuracy1000: 0.4458 - val_loss: 3.3873 - val_accuracy1000: 0.3019 - 11s/epoch - 17ms/step
Epoch 9/50
641/641 - 11s - loss: 3.1465 - accuracy1000: 0.4497 - val_loss: 3.4120 - val_accuracy1000: 0.3013 - 11s/epoch - 17ms/step
Epoch 10/50
641/641 - 10s - loss: 3.1414 - accuracy1000: 0.4484 - val_loss: 3.4337 - val_accuracy1000: 0.2978 - 10s/epoch - 16ms/step
Epoch 11/50
641/641 - 11s - loss: 3.1356 - accuracy1000: 0.4531 - val_loss: 3.3403 - val_accuracy1000: 0.3128 - 11s/epoch - 16ms/step
Epoch 12/50
641/641 - 10s - loss: 3.1226 - accuracy1000: 0.4598 - val_loss: 3.3919 - val_accuracy1000: 0.2997 - 10s/epoch - 16ms/step
Epoch 13/50
641/641 - 10s - loss: 3.1087 - accuracy1000: 0.4632 - val_loss: 3.4060 - val_accuracy1000: 0.3155 - 10s/epoch - 16ms/step
Epoch 14/50
641/641 - 11s - loss: 3.1018 - accuracy1000: 0.4668 - val_loss: 3.3766 - val_accuracy1000: 0.3175 - 11s/epoch - 17ms/step
Epoch 15/50
641/641 - 11s - loss: 3.0953 - accuracy1000: 0.4681 - val_loss: 3.3691 - val_accuracy1000: 0.3419 - 11s/epoch - 17ms/step
Epoch 16/50
641/641 - 11s - loss: 3.0872 - accuracy1000: 0.4717 - val_loss: 3.3697 - val_accuracy1000: 0.3411 - 11s/epoch - 16ms/step
Epoch 17/50
641/641 - 11s - loss: 3.0785 - accuracy1000: 0.4736 - val_loss: 3.3367 - val_accuracy1000: 0.3683 - 11s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095294
{'0': {'precision': 0.43200620475698037, 'recall': 0.011601830186976234, 'f1-score': 0.02259680723746932, 'support': 144029}, '1': {'precision': 0.2487106017191977, 'recall': 0.014487915609560689, 'f1-score': 0.027380839721144443, 'support': 89868}, '2': {'precision': 0.36735152844490104, 'recall': 0.9773445810187921, 'f1-score': 0.5339928079330678, 'support': 135376}, 'accuracy': 0.36634684907913656, 'macro avg': {'precision': 0.3493561116403597, 'recall': 0.334478108938443, 'f1-score': 0.19465681829722717, 'support': 369273}, 'weighted avg': {'precision': 0.3636960366314378, 'recall': 0.36634684907913656, 'f1-score': 0.21123956319690926, 'support': 369273}}
[[  1671   2025 140333]
 [  1038   1302  87528]
 [  1159   1908 132309]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1161704
{'0': {'precision': 0.33255599067188807, 'recall': 0.27037275524075266, 'f1-score': 0.29825772972119735, 'support': 55908}, '1': {'precision': 0.3721633888048411, 'recall': 0.040814821642547704, 'f1-score': 0.07356214905140049, 'support': 54245}, '2': {'precision': 0.35056624538483383, 'recall': 0.7325210489225177, 'f1-score': 0.474194748910525, 'support': 53922}, 'accuracy': 0.34635989638884657, 'macro avg': {'precision': 0.3517618749538543, 'recall': 0.34790287526860597, 'f1-score': 0.2820048758943743, 'support': 164075}, 'weighted avg': {'precision': 0.35156956535635253, 'recall': 0.34635989638884657, 'f1-score': 0.28179126118725734, 'support': 164075}}
[[15116  1965 38827]
 [17685  2214 34346]
 [12653  1770 39499]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1109083
{'0': {'precision': 0.23581448249715659, 'recall': 0.17367024989529528, 'f1-score': 0.2000267988744473, 'support': 21489}, '1': {'precision': 0.41990473802958134, 'recall': 0.06611407144266825, 'f1-score': 0.11424089483017323, 'support': 25335}, '2': {'precision': 0.33736855705965374, 'recall': 0.728474547171431, 'f1-score': 0.461164323075878, 'support': 23298}, 'accuracy': 0.31914377798693705, 'macro avg': {'precision': 0.3310292591954639, 'recall': 0.32275295616979816, 'f1-score': 0.25847733892683283, 'support': 70122}, 'weighted avg': {'precision': 0.33606737678241716, 'recall': 0.31914377798693705, 'f1-score': 0.25579526183732987, 'support': 70122}}
[[ 3732  1055 16702]
 [ 7027  1675 16633]
 [ 5067  1259 16972]]
training model: results/QRTEA/W3/deepOF_L1/h10
Epoch 1/50
641/641 - 12s - loss: 3.1867 - accuracy10: 0.4391 - val_loss: 2.8855 - val_accuracy10: 0.6285 - 12s/epoch - 19ms/step
Epoch 2/50
641/641 - 9s - loss: 3.1305 - accuracy10: 0.4628 - val_loss: 2.8533 - val_accuracy10: 0.6233 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 10s - loss: 3.1175 - accuracy10: 0.4655 - val_loss: 2.8280 - val_accuracy10: 0.6243 - 10s/epoch - 15ms/step
Epoch 4/50
641/641 - 9s - loss: 3.1050 - accuracy10: 0.4743 - val_loss: 2.8046 - val_accuracy10: 0.6241 - 9s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.0891 - accuracy10: 0.4818 - val_loss: 2.7962 - val_accuracy10: 0.6227 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 10s - loss: 3.0829 - accuracy10: 0.4839 - val_loss: 2.7781 - val_accuracy10: 0.6287 - 10s/epoch - 15ms/step
Epoch 7/50
641/641 - 10s - loss: 3.0709 - accuracy10: 0.4879 - val_loss: 2.7702 - val_accuracy10: 0.6293 - 10s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.0575 - accuracy10: 0.4969 - val_loss: 2.7644 - val_accuracy10: 0.6348 - 9s/epoch - 15ms/step
Epoch 9/50
641/641 - 9s - loss: 3.0506 - accuracy10: 0.5020 - val_loss: 2.7518 - val_accuracy10: 0.6308 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.0393 - accuracy10: 0.5120 - val_loss: 2.7495 - val_accuracy10: 0.6338 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.0298 - accuracy10: 0.5135 - val_loss: 2.7476 - val_accuracy10: 0.6378 - 9s/epoch - 15ms/step
Epoch 12/50
641/641 - 9s - loss: 3.0209 - accuracy10: 0.5151 - val_loss: 2.7562 - val_accuracy10: 0.6377 - 9s/epoch - 15ms/step
Epoch 13/50
641/641 - 9s - loss: 3.0123 - accuracy10: 0.5143 - val_loss: 2.7535 - val_accuracy10: 0.6414 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.0005 - accuracy10: 0.5207 - val_loss: 2.7470 - val_accuracy10: 0.6390 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 10s - loss: 2.9910 - accuracy10: 0.5243 - val_loss: 2.7513 - val_accuracy10: 0.6421 - 10s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 2.9814 - accuracy10: 0.5229 - val_loss: 2.7461 - val_accuracy10: 0.6442 - 9s/epoch - 15ms/step
Epoch 17/50
641/641 - 10s - loss: 2.9722 - accuracy10: 0.5238 - val_loss: 2.7530 - val_accuracy10: 0.6502 - 10s/epoch - 15ms/step
Epoch 18/50
641/641 - 9s - loss: 2.9614 - accuracy10: 0.5259 - val_loss: 2.7536 - val_accuracy10: 0.6457 - 9s/epoch - 15ms/step
Epoch 19/50
641/641 - 9s - loss: 2.9520 - accuracy10: 0.5253 - val_loss: 2.7461 - val_accuracy10: 0.6459 - 9s/epoch - 15ms/step
Epoch 20/50
641/641 - 10s - loss: 2.9454 - accuracy10: 0.5249 - val_loss: 2.7556 - val_accuracy10: 0.6463 - 10s/epoch - 15ms/step
Epoch 21/50
641/641 - 9s - loss: 2.9394 - accuracy10: 0.5244 - val_loss: 2.7575 - val_accuracy10: 0.6495 - 9s/epoch - 15ms/step
Epoch 22/50
641/641 - 9s - loss: 2.9290 - accuracy10: 0.5263 - val_loss: 2.7523 - val_accuracy10: 0.6412 - 9s/epoch - 15ms/step
Epoch 23/50
641/641 - 9s - loss: 2.9219 - accuracy10: 0.5257 - val_loss: 2.7699 - val_accuracy10: 0.6523 - 9s/epoch - 14ms/step
Epoch 24/50
641/641 - 9s - loss: 2.9181 - accuracy10: 0.5249 - val_loss: 2.7556 - val_accuracy10: 0.6458 - 9s/epoch - 14ms/step
Epoch 25/50
641/641 - 9s - loss: 2.9097 - accuracy10: 0.5280 - val_loss: 2.7790 - val_accuracy10: 0.6486 - 9s/epoch - 14ms/step
Epoch 26/50
641/641 - 9s - loss: 2.9034 - accuracy10: 0.5260 - val_loss: 2.7578 - val_accuracy10: 0.6459 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h10
Evaluating performance on  test set...
1443/1443 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7840001
{'0': {'precision': 0.2672980615269308, 'recall': 0.4592332455370208, 'f1-score': 0.3379129161462595, 'support': 34170}, '1': {'precision': 0.8772417390008568, 'recall': 0.7797904469229343, 'f1-score': 0.8256505015725641, 'support': 301976}, '2': {'precision': 0.265658747300216, 'recall': 0.33792228964767684, 'f1-score': 0.2974646539810779, 'support': 33123}, 'accuracy': 0.7104928927150668, 'macro avg': {'precision': 0.4700661826093346, 'recall': 0.525648660702544, 'f1-score': 0.4870093572333005, 'support': 369269}, 'weighted avg': {'precision': 0.7659428244063894, 'recall': 0.7104928927150668, 'f1-score': 0.7331404530069126, 'support': 369269}}
[[ 15692  15434   3044]
 [ 38602 235478  27896]
 [  4412  17518  11193]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89001703
{'0': {'precision': 0.34933906949311316, 'recall': 0.36233761560329625, 'f1-score': 0.3557196354129867, 'support': 27789}, '1': {'precision': 0.7369896834494313, 'recall': 0.7635430179233734, 'f1-score': 0.7500314075988442, 'support': 109466}, '2': {'precision': 0.3585000686781741, 'recall': 0.29195719452626867, 'f1-score': 0.3218249075215783, 'support': 26819}, 'accuracy': 0.6185075027121908, 'macro avg': {'precision': 0.4816096072069062, 'recall': 0.4726126093509795, 'f1-score': 0.47585865017780304, 'support': 164074}, 'weighted avg': {'precision': 0.6094671272261267, 'recall': 0.6185075027121908, 'f1-score': 0.613254100025158, 'support': 164074}}
[[10069 14877  2843]
 [14716 83582 11168]
 [ 4038 14951  7830]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8583824
{'0': {'precision': 0.3213176393657021, 'recall': 0.4001832434083274, 'f1-score': 0.3564401323842771, 'support': 9823}, '1': {'precision': 0.7901316886147691, 'recall': 0.7516054864029176, 'f1-score': 0.7703872252244931, 'support': 50452}, '2': {'precision': 0.3412489894907033, 'recall': 0.3429470904844115, 'f1-score': 0.34209593273565314, 'support': 9847}, 'accuracy': 0.6449901600068452, 'macro avg': {'precision': 0.4842327724903915, 'recall': 0.49824527343188557, 'f1-score': 0.48964109678147444, 'support': 70122}, 'weighted avg': {'precision': 0.6614230330708848, 'recall': 0.6449901600068452, 'f1-score': 0.6522561586532737, 'support': 70122}}
[[ 3931  4940   952]
 [ 6965 37920  5567]
 [ 1338  5132  3377]]
training model: results/QRTEA/W3/deepOF_L1/h20
Epoch 1/50
641/641 - 11s - loss: 3.2027 - accuracy20: 0.4361 - val_loss: 2.9745 - val_accuracy20: 0.5768 - 11s/epoch - 18ms/step
Epoch 2/50
641/641 - 10s - loss: 3.1574 - accuracy20: 0.4447 - val_loss: 2.9442 - val_accuracy20: 0.5792 - 10s/epoch - 15ms/step
Epoch 3/50
641/641 - 10s - loss: 3.1414 - accuracy20: 0.4478 - val_loss: 2.9218 - val_accuracy20: 0.5802 - 10s/epoch - 15ms/step
Epoch 4/50
641/641 - 9s - loss: 3.1327 - accuracy20: 0.4521 - val_loss: 2.9268 - val_accuracy20: 0.5852 - 9s/epoch - 14ms/step
Epoch 5/50
641/641 - 10s - loss: 3.1219 - accuracy20: 0.4634 - val_loss: 2.9077 - val_accuracy20: 0.5859 - 10s/epoch - 15ms/step
Epoch 6/50
641/641 - 9s - loss: 3.1073 - accuracy20: 0.4726 - val_loss: 2.9001 - val_accuracy20: 0.5907 - 9s/epoch - 15ms/step
Epoch 7/50
641/641 - 9s - loss: 3.0999 - accuracy20: 0.4681 - val_loss: 2.8840 - val_accuracy20: 0.5915 - 9s/epoch - 14ms/step
Epoch 8/50
641/641 - 10s - loss: 3.0873 - accuracy20: 0.4785 - val_loss: 2.8786 - val_accuracy20: 0.5967 - 10s/epoch - 16ms/step
Epoch 9/50
641/641 - 10s - loss: 3.0788 - accuracy20: 0.4833 - val_loss: 2.8707 - val_accuracy20: 0.6023 - 10s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.0678 - accuracy20: 0.4900 - val_loss: 2.8664 - val_accuracy20: 0.6071 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.0550 - accuracy20: 0.4979 - val_loss: 2.8644 - val_accuracy20: 0.6105 - 9s/epoch - 14ms/step
Epoch 12/50
641/641 - 9s - loss: 3.0458 - accuracy20: 0.4994 - val_loss: 2.8621 - val_accuracy20: 0.6134 - 9s/epoch - 15ms/step
Epoch 13/50
641/641 - 9s - loss: 3.0342 - accuracy20: 0.5041 - val_loss: 2.8608 - val_accuracy20: 0.6139 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.0242 - accuracy20: 0.5077 - val_loss: 2.8658 - val_accuracy20: 0.6163 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.0150 - accuracy20: 0.5110 - val_loss: 2.8650 - val_accuracy20: 0.6167 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.0071 - accuracy20: 0.5094 - val_loss: 2.8654 - val_accuracy20: 0.6180 - 9s/epoch - 14ms/step
Epoch 17/50
641/641 - 9s - loss: 2.9971 - accuracy20: 0.5142 - val_loss: 2.8704 - val_accuracy20: 0.6167 - 9s/epoch - 15ms/step
Epoch 18/50
641/641 - 10s - loss: 2.9912 - accuracy20: 0.5146 - val_loss: 2.8640 - val_accuracy20: 0.6145 - 10s/epoch - 15ms/step
Epoch 19/50
641/641 - 9s - loss: 2.9800 - accuracy20: 0.5172 - val_loss: 2.8663 - val_accuracy20: 0.6171 - 9s/epoch - 15ms/step
Epoch 20/50
641/641 - 9s - loss: 2.9768 - accuracy20: 0.5182 - val_loss: 2.8626 - val_accuracy20: 0.6134 - 9s/epoch - 14ms/step
Epoch 21/50
641/641 - 10s - loss: 2.9678 - accuracy20: 0.5196 - val_loss: 2.8628 - val_accuracy20: 0.6152 - 10s/epoch - 15ms/step
Epoch 22/50
641/641 - 10s - loss: 2.9593 - accuracy20: 0.5191 - val_loss: 2.8478 - val_accuracy20: 0.6064 - 10s/epoch - 15ms/step
Epoch 23/50
641/641 - 10s - loss: 2.9523 - accuracy20: 0.5190 - val_loss: 2.8451 - val_accuracy20: 0.6131 - 10s/epoch - 15ms/step
Epoch 24/50
641/641 - 10s - loss: 2.9454 - accuracy20: 0.5209 - val_loss: 2.8454 - val_accuracy20: 0.6097 - 10s/epoch - 15ms/step
Epoch 25/50
641/641 - 10s - loss: 2.9378 - accuracy20: 0.5229 - val_loss: 2.8540 - val_accuracy20: 0.6133 - 10s/epoch - 15ms/step
Epoch 26/50
641/641 - 10s - loss: 2.9305 - accuracy20: 0.5249 - val_loss: 2.8435 - val_accuracy20: 0.6124 - 10s/epoch - 15ms/step
Epoch 27/50
641/641 - 9s - loss: 2.9266 - accuracy20: 0.5221 - val_loss: 2.8464 - val_accuracy20: 0.6123 - 9s/epoch - 15ms/step
Epoch 28/50
641/641 - 9s - loss: 2.9170 - accuracy20: 0.5254 - val_loss: 2.8428 - val_accuracy20: 0.6142 - 9s/epoch - 15ms/step
Epoch 29/50
641/641 - 9s - loss: 2.9125 - accuracy20: 0.5268 - val_loss: 2.8483 - val_accuracy20: 0.6157 - 9s/epoch - 15ms/step
Epoch 30/50
641/641 - 9s - loss: 2.9032 - accuracy20: 0.5291 - val_loss: 2.8568 - val_accuracy20: 0.6179 - 9s/epoch - 15ms/step
Epoch 31/50
641/641 - 9s - loss: 2.9010 - accuracy20: 0.5303 - val_loss: 2.8482 - val_accuracy20: 0.6170 - 9s/epoch - 15ms/step
Epoch 32/50
641/641 - 9s - loss: 2.8934 - accuracy20: 0.5325 - val_loss: 2.8501 - val_accuracy20: 0.6164 - 9s/epoch - 15ms/step
Epoch 33/50
641/641 - 9s - loss: 2.8904 - accuracy20: 0.5319 - val_loss: 2.8422 - val_accuracy20: 0.6193 - 9s/epoch - 15ms/step
Epoch 34/50
641/641 - 9s - loss: 2.8808 - accuracy20: 0.5345 - val_loss: 2.8457 - val_accuracy20: 0.6119 - 9s/epoch - 15ms/step
Epoch 35/50
641/641 - 9s - loss: 2.8752 - accuracy20: 0.5358 - val_loss: 2.8428 - val_accuracy20: 0.6129 - 9s/epoch - 14ms/step
Epoch 36/50
641/641 - 9s - loss: 2.8713 - accuracy20: 0.5348 - val_loss: 2.8395 - val_accuracy20: 0.6153 - 9s/epoch - 15ms/step
Epoch 37/50
641/641 - 9s - loss: 2.8695 - accuracy20: 0.5357 - val_loss: 2.8407 - val_accuracy20: 0.6131 - 9s/epoch - 15ms/step
Epoch 38/50
641/641 - 9s - loss: 2.8602 - accuracy20: 0.5372 - val_loss: 2.8563 - val_accuracy20: 0.6135 - 9s/epoch - 14ms/step
Epoch 39/50
641/641 - 10s - loss: 2.8554 - accuracy20: 0.5402 - val_loss: 2.8483 - val_accuracy20: 0.6130 - 10s/epoch - 15ms/step
Epoch 40/50
641/641 - 9s - loss: 2.8496 - accuracy20: 0.5400 - val_loss: 2.8613 - val_accuracy20: 0.6174 - 9s/epoch - 15ms/step
Epoch 41/50
641/641 - 10s - loss: 2.8424 - accuracy20: 0.5410 - val_loss: 2.8601 - val_accuracy20: 0.6104 - 10s/epoch - 15ms/step
Epoch 42/50
641/641 - 10s - loss: 2.8349 - accuracy20: 0.5426 - val_loss: 2.8727 - val_accuracy20: 0.6130 - 10s/epoch - 15ms/step
Epoch 43/50
641/641 - 9s - loss: 2.8327 - accuracy20: 0.5434 - val_loss: 2.8633 - val_accuracy20: 0.6152 - 9s/epoch - 15ms/step
Epoch 44/50
641/641 - 9s - loss: 2.8226 - accuracy20: 0.5449 - val_loss: 2.8695 - val_accuracy20: 0.6156 - 9s/epoch - 15ms/step
Epoch 45/50
641/641 - 9s - loss: 2.8182 - accuracy20: 0.5463 - val_loss: 2.8647 - val_accuracy20: 0.6105 - 9s/epoch - 15ms/step
Epoch 46/50
641/641 - 10s - loss: 2.8105 - accuracy20: 0.5472 - val_loss: 2.8655 - val_accuracy20: 0.6127 - 10s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h20
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.780591
{'0': {'precision': 0.36206477202566933, 'recall': 0.41911939878283844, 'f1-score': 0.3885085623657425, 'support': 46173}, '1': {'precision': 0.8234144886469558, 'recall': 0.7942572719164485, 'f1-score': 0.8085731127326248, 'support': 278056}, '2': {'precision': 0.32638101239235456, 'recall': 0.3450044404973357, 'f1-score': 0.3354344306529951, 'support': 45040}, 'accuracy': 0.6925547500602541, 'macro avg': {'precision': 0.5039534243549932, 'recall': 0.5194603703988743, 'f1-score': 0.5108387019171208, 'support': 369269}, 'weighted avg': {'precision': 0.7051042913759638, 'recall': 0.6925547500602541, 'f1-score': 0.698339633277386, 'support': 369269}}
[[ 19352  22181   4640]
 [ 29777 220848  27431]
 [  4320  25181  15539]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92126715
{'0': {'precision': 0.45479473519272956, 'recall': 0.3251281189616063, 'f1-score': 0.37918252037167066, 'support': 35709}, '1': {'precision': 0.6531824913902321, 'recall': 0.7803988871241112, 'f1-score': 0.7111460807312535, 'support': 93811}, '2': {'precision': 0.4265417170495768, 'recall': 0.3266770851420964, 'f1-score': 0.3699891835196171, 'support': 34554}, 'accuracy': 0.5857600838645977, 'macro avg': {'precision': 0.5115063145441795, 'recall': 0.47740136374260467, 'f1-score': 0.4867725948741805, 'support': 164074}, 'weighted avg': {'precision': 0.5622748905355957, 'recall': 0.5857600838645977, 'f1-score': 0.5670499887049043, 'support': 164074}}
[[11610 19533  4566]
 [ 9991 73210 10610]
 [ 3927 19339 11288]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.882556
{'0': {'precision': 0.41743679163034003, 'recall': 0.36890361352954776, 'f1-score': 0.3916724610413514, 'support': 12979}, '1': {'precision': 0.7116039151850834, 'recall': 0.7647793883764257, 'f1-score': 0.7372340309033367, 'support': 44014}, '2': {'precision': 0.4128998149616706, 'recall': 0.35691979587173434, 'f1-score': 0.38287441784459514, 'support': 13129}, 'accuracy': 0.6151421807706569, 'macro avg': {'precision': 0.513980173925698, 'recall': 0.4968675992592359, 'f1-score': 0.503926969929761, 'support': 70122}, 'weighted avg': {'precision': 0.6012294074920598, 'recall': 0.6151421807706569, 'f1-score': 0.6069264102552244, 'support': 70122}}
[[ 4788  6667  1524]
 [ 5214 33661  5139]
 [ 1468  6975  4686]]
training model: results/QRTEA/W3/deepOF_L1/h30
Epoch 1/50
641/641 - 11s - loss: 3.2226 - accuracy30: 0.4226 - val_loss: 3.0341 - val_accuracy30: 0.5424 - 11s/epoch - 18ms/step
Epoch 2/50
641/641 - 9s - loss: 3.1719 - accuracy30: 0.4376 - val_loss: 3.0086 - val_accuracy30: 0.5480 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 10s - loss: 3.1574 - accuracy30: 0.4410 - val_loss: 2.9934 - val_accuracy30: 0.5516 - 10s/epoch - 15ms/step
Epoch 4/50
641/641 - 9s - loss: 3.1495 - accuracy30: 0.4452 - val_loss: 2.9770 - val_accuracy30: 0.5548 - 9s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.1363 - accuracy30: 0.4513 - val_loss: 2.9699 - val_accuracy30: 0.5565 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 9s - loss: 3.1240 - accuracy30: 0.4555 - val_loss: 2.9642 - val_accuracy30: 0.5619 - 9s/epoch - 15ms/step
Epoch 7/50
641/641 - 10s - loss: 3.1102 - accuracy30: 0.4650 - val_loss: 2.9596 - val_accuracy30: 0.5667 - 10s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.1010 - accuracy30: 0.4683 - val_loss: 2.9639 - val_accuracy30: 0.5709 - 9s/epoch - 14ms/step
Epoch 9/50
641/641 - 9s - loss: 3.0891 - accuracy30: 0.4719 - val_loss: 2.9645 - val_accuracy30: 0.5718 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.0810 - accuracy30: 0.4765 - val_loss: 2.9636 - val_accuracy30: 0.5758 - 9s/epoch - 14ms/step
Epoch 11/50
641/641 - 9s - loss: 3.0678 - accuracy30: 0.4829 - val_loss: 2.9711 - val_accuracy30: 0.5773 - 9s/epoch - 14ms/step
Epoch 12/50
641/641 - 9s - loss: 3.0617 - accuracy30: 0.4825 - val_loss: 2.9674 - val_accuracy30: 0.5812 - 9s/epoch - 15ms/step
Epoch 13/50
641/641 - 9s - loss: 3.0532 - accuracy30: 0.4857 - val_loss: 2.9641 - val_accuracy30: 0.5807 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 9s - loss: 3.0432 - accuracy30: 0.4887 - val_loss: 2.9755 - val_accuracy30: 0.5827 - 9s/epoch - 15ms/step
Epoch 15/50
641/641 - 10s - loss: 3.0341 - accuracy30: 0.4896 - val_loss: 2.9721 - val_accuracy30: 0.5851 - 10s/epoch - 15ms/step
Epoch 16/50
641/641 - 10s - loss: 3.0309 - accuracy30: 0.4910 - val_loss: 2.9614 - val_accuracy30: 0.5839 - 10s/epoch - 15ms/step
Epoch 17/50
641/641 - 10s - loss: 3.0211 - accuracy30: 0.4938 - val_loss: 2.9525 - val_accuracy30: 0.5797 - 10s/epoch - 15ms/step
Epoch 18/50
641/641 - 9s - loss: 3.0124 - accuracy30: 0.4973 - val_loss: 2.9584 - val_accuracy30: 0.5829 - 9s/epoch - 14ms/step
Epoch 19/50
641/641 - 9s - loss: 3.0034 - accuracy30: 0.5001 - val_loss: 2.9537 - val_accuracy30: 0.5832 - 9s/epoch - 15ms/step
Epoch 20/50
641/641 - 9s - loss: 2.9972 - accuracy30: 0.5016 - val_loss: 2.9501 - val_accuracy30: 0.5815 - 9s/epoch - 15ms/step
Epoch 21/50
641/641 - 9s - loss: 2.9904 - accuracy30: 0.5030 - val_loss: 2.9439 - val_accuracy30: 0.5823 - 9s/epoch - 15ms/step
Epoch 22/50
641/641 - 9s - loss: 2.9823 - accuracy30: 0.5041 - val_loss: 2.9406 - val_accuracy30: 0.5798 - 9s/epoch - 15ms/step
Epoch 23/50
641/641 - 9s - loss: 2.9766 - accuracy30: 0.5066 - val_loss: 2.9452 - val_accuracy30: 0.5815 - 9s/epoch - 15ms/step
Epoch 24/50
641/641 - 9s - loss: 2.9656 - accuracy30: 0.5097 - val_loss: 2.9555 - val_accuracy30: 0.5847 - 9s/epoch - 14ms/step
Epoch 25/50
641/641 - 9s - loss: 2.9640 - accuracy30: 0.5081 - val_loss: 2.9349 - val_accuracy30: 0.5815 - 9s/epoch - 15ms/step
Epoch 26/50
641/641 - 9s - loss: 2.9538 - accuracy30: 0.5125 - val_loss: 2.9435 - val_accuracy30: 0.5836 - 9s/epoch - 14ms/step
Epoch 27/50
641/641 - 9s - loss: 2.9448 - accuracy30: 0.5157 - val_loss: 2.9394 - val_accuracy30: 0.5805 - 9s/epoch - 15ms/step
Epoch 28/50
641/641 - 10s - loss: 2.9429 - accuracy30: 0.5169 - val_loss: 2.9370 - val_accuracy30: 0.5770 - 10s/epoch - 15ms/step
Epoch 29/50
641/641 - 9s - loss: 2.9313 - accuracy30: 0.5218 - val_loss: 2.9494 - val_accuracy30: 0.5776 - 9s/epoch - 15ms/step
Epoch 30/50
641/641 - 9s - loss: 2.9290 - accuracy30: 0.5186 - val_loss: 2.9331 - val_accuracy30: 0.5793 - 9s/epoch - 15ms/step
Epoch 31/50
641/641 - 9s - loss: 2.9240 - accuracy30: 0.5219 - val_loss: 2.9493 - val_accuracy30: 0.5802 - 9s/epoch - 15ms/step
Epoch 32/50
641/641 - 9s - loss: 2.9143 - accuracy30: 0.5248 - val_loss: 2.9418 - val_accuracy30: 0.5791 - 9s/epoch - 14ms/step
Epoch 33/50
641/641 - 9s - loss: 2.9150 - accuracy30: 0.5219 - val_loss: 2.9301 - val_accuracy30: 0.5765 - 9s/epoch - 14ms/step
Epoch 34/50
641/641 - 9s - loss: 2.9054 - accuracy30: 0.5271 - val_loss: 2.9362 - val_accuracy30: 0.5777 - 9s/epoch - 14ms/step
Epoch 35/50
641/641 - 9s - loss: 2.8985 - accuracy30: 0.5291 - val_loss: 2.9426 - val_accuracy30: 0.5766 - 9s/epoch - 14ms/step
Epoch 36/50
641/641 - 9s - loss: 2.8921 - accuracy30: 0.5306 - val_loss: 2.9342 - val_accuracy30: 0.5749 - 9s/epoch - 15ms/step
Epoch 37/50
641/641 - 9s - loss: 2.8857 - accuracy30: 0.5315 - val_loss: 2.9400 - val_accuracy30: 0.5713 - 9s/epoch - 15ms/step
Epoch 38/50
641/641 - 10s - loss: 2.8791 - accuracy30: 0.5330 - val_loss: 2.9400 - val_accuracy30: 0.5750 - 10s/epoch - 15ms/step
Epoch 39/50
641/641 - 9s - loss: 2.8784 - accuracy30: 0.5339 - val_loss: 2.9407 - val_accuracy30: 0.5736 - 9s/epoch - 14ms/step
Epoch 40/50
641/641 - 9s - loss: 2.8703 - accuracy30: 0.5356 - val_loss: 2.9357 - val_accuracy30: 0.5770 - 9s/epoch - 15ms/step
Epoch 41/50
641/641 - 10s - loss: 2.8598 - accuracy30: 0.5377 - val_loss: 2.9439 - val_accuracy30: 0.5732 - 10s/epoch - 15ms/step
Epoch 42/50
641/641 - 9s - loss: 2.8551 - accuracy30: 0.5393 - val_loss: 2.9565 - val_accuracy30: 0.5777 - 9s/epoch - 14ms/step
Epoch 43/50
641/641 - 9s - loss: 2.8506 - accuracy30: 0.5401 - val_loss: 2.9359 - val_accuracy30: 0.5717 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h30
Evaluating performance on  test set...
1443/1443 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8227238
{'0': {'precision': 0.39259395387301294, 'recall': 0.386241186042307, 'f1-score': 0.38939166097060834, 'support': 55310}, '1': {'precision': 0.7737461309670032, 'recall': 0.7874899512660443, 'f1-score': 0.7805575465511719, 'support': 259983}, '2': {'precision': 0.3634210892882017, 'recall': 0.3383540832962798, 'f1-score': 0.35043989676577536, 'support': 53976}, 'accuracy': 0.6617398156899171, 'macro avg': {'precision': 0.5099203913760726, 'recall': 0.5040284068682103, 'f1-score': 0.5067963680958519, 'support': 369269}, 'weighted avg': {'precision': 0.6566790840046977, 'recall': 0.6617398156899171, 'f1-score': 0.6590975393578318, 'support': 369269}}
[[ 21363  28813   5134]
 [ 28393 204734  26856]
 [  4659  31054  18263]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9677376
{'0': {'precision': 0.4710252051149383, 'recall': 0.31226264853607744, 'f1-score': 0.3755543441427372, 'support': 40815}, '1': {'precision': 0.5827881365172828, 'recall': 0.7681629817711453, 'f1-score': 0.6627571740051461, 'support': 83494}, '2': {'precision': 0.45412401720812934, 'recall': 0.30793411291336603, 'f1-score': 0.36700684859656224, 'support': 39765}, 'accuracy': 0.5432122091251509, 'macro avg': {'precision': 0.5026457862801168, 'recall': 0.46278658107352966, 'f1-score': 0.46843945558148187, 'support': 164074}, 'weighted avg': {'precision': 0.5238029667188067, 'recall': 0.5432122091251509, 'f1-score': 0.5196345879116361, 'support': 164074}}
[[12745 23106  4964]
 [ 9602 64137  9755]
 [ 4711 22809 12245]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93016624
{'0': {'precision': 0.4361728497066843, 'recall': 0.348632941487254, 'f1-score': 0.3875206459900899, 'support': 15142}, '1': {'precision': 0.6408865935011836, 'recall': 0.7525077696641989, 'f1-score': 0.6922263414180623, 'support': 39577}, '2': {'precision': 0.4551909256212659, 'recall': 0.3412971499058625, 'f1-score': 0.3901009201543485, 'support': 15403}, 'accuracy': 0.5749693391517641, 'macro avg': {'precision': 0.5107501229430446, 'recall': 0.4808126203524385, 'f1-score': 0.48994930252083363, 'support': 70122}, 'weighted avg': {'precision': 0.5558912157183098, 'recall': 0.5749693391517641, 'f1-score': 0.5600639458233083, 'support': 70122}}
[[ 5279  8280  1583]
 [ 5086 29782  4709]
 [ 1738  8408  5257]]
training model: results/QRTEA/W3/deepOF_L1/h50
Epoch 1/50
641/641 - 12s - loss: 3.2509 - accuracy50: 0.4045 - val_loss: 3.1530 - val_accuracy50: 0.4777 - 12s/epoch - 19ms/step
Epoch 2/50
641/641 - 9s - loss: 3.2115 - accuracy50: 0.4178 - val_loss: 3.1340 - val_accuracy50: 0.4806 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 9s - loss: 3.2008 - accuracy50: 0.4211 - val_loss: 3.1106 - val_accuracy50: 0.4852 - 9s/epoch - 15ms/step
Epoch 4/50
641/641 - 10s - loss: 3.1871 - accuracy50: 0.4252 - val_loss: 3.1041 - val_accuracy50: 0.4874 - 10s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.1808 - accuracy50: 0.4261 - val_loss: 3.0985 - val_accuracy50: 0.4895 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 10s - loss: 3.1726 - accuracy50: 0.4291 - val_loss: 3.0903 - val_accuracy50: 0.4926 - 10s/epoch - 15ms/step
Epoch 7/50
641/641 - 10s - loss: 3.1697 - accuracy50: 0.4311 - val_loss: 3.0829 - val_accuracy50: 0.4953 - 10s/epoch - 15ms/step
Epoch 8/50
641/641 - 10s - loss: 3.1625 - accuracy50: 0.4346 - val_loss: 3.0812 - val_accuracy50: 0.4989 - 10s/epoch - 16ms/step
Epoch 9/50
641/641 - 9s - loss: 3.1557 - accuracy50: 0.4377 - val_loss: 3.0802 - val_accuracy50: 0.5005 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.1479 - accuracy50: 0.4440 - val_loss: 3.0794 - val_accuracy50: 0.5015 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.1403 - accuracy50: 0.4471 - val_loss: 3.0758 - val_accuracy50: 0.5041 - 9s/epoch - 15ms/step
Epoch 12/50
641/641 - 10s - loss: 3.1340 - accuracy50: 0.4497 - val_loss: 3.0818 - val_accuracy50: 0.5053 - 10s/epoch - 15ms/step
Epoch 13/50
641/641 - 10s - loss: 3.1253 - accuracy50: 0.4537 - val_loss: 3.0797 - val_accuracy50: 0.5080 - 10s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.1188 - accuracy50: 0.4562 - val_loss: 3.0796 - val_accuracy50: 0.5090 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.1103 - accuracy50: 0.4595 - val_loss: 3.0799 - val_accuracy50: 0.5093 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.1045 - accuracy50: 0.4619 - val_loss: 3.0796 - val_accuracy50: 0.5109 - 9s/epoch - 15ms/step
Epoch 17/50
641/641 - 10s - loss: 3.1002 - accuracy50: 0.4645 - val_loss: 3.0832 - val_accuracy50: 0.5109 - 10s/epoch - 15ms/step
Epoch 18/50
641/641 - 10s - loss: 3.0934 - accuracy50: 0.4663 - val_loss: 3.0872 - val_accuracy50: 0.5121 - 10s/epoch - 15ms/step
Epoch 19/50
641/641 - 10s - loss: 3.0876 - accuracy50: 0.4691 - val_loss: 3.0837 - val_accuracy50: 0.5140 - 10s/epoch - 15ms/step
Epoch 20/50
641/641 - 10s - loss: 3.0811 - accuracy50: 0.4713 - val_loss: 3.0894 - val_accuracy50: 0.5143 - 10s/epoch - 15ms/step
Epoch 21/50
641/641 - 9s - loss: 3.0741 - accuracy50: 0.4729 - val_loss: 3.0890 - val_accuracy50: 0.5156 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h50
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.94220465
{'0': {'precision': 0.41173796238892335, 'recall': 0.28308776516389367, 'f1-score': 0.33550277424623853, 'support': 70381}, '1': {'precision': 0.660195905734183, 'recall': 0.8043880609983924, 'f1-score': 0.7251939343257391, 'support': 230170}, '2': {'precision': 0.39020228497947473, 'recall': 0.229619604761489, 'f1-score': 0.2891091648649639, 'support': 68718}, 'accuracy': 0.5980707830876678, 'macro avg': {'precision': 0.48737871770086033, 'recall': 0.439031810307925, 'f1-score': 0.4499352911456472, 'support': 369269}, 'weighted avg': {'precision': 0.5625972983731407, 'recall': 0.5980707830876678, 'f1-score': 0.5697686841006704, 'support': 369269}}
[[ 19924  46712   3745]
 [ 24110 185146  20914]
 [  4356  48583  15779]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0452375
{'0': {'precision': 0.49032401242787393, 'recall': 0.23006914361879374, 'f1-score': 0.3131857227908032, 'support': 48016}, '1': {'precision': 0.4538333097965592, 'recall': 0.7922503552887264, 'f1-score': 0.5770874155606143, 'support': 68958}, '2': {'precision': 0.47847862036380817, 'recall': 0.21501061571125266, 'f1-score': 0.2966966966966967, 'support': 47100}, 'accuracy': 0.462023233419067, 'macro avg': {'precision': 0.47421198086274713, 'recall': 0.41244337153959093, 'f1-score': 0.3956566116827047, 'support': 164074}, 'weighted avg': {'precision': 0.4715870776407188, 'recall': 0.462023233419067, 'f1-score': 0.41936646928926247, 'support': 164074}}
[[11047 33026  3943]
 [ 7231 54632  7095]
 [ 4252 32721 10127]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0110021
{'0': {'precision': 0.47142402714452336, 'recall': 0.2432698621142482, 'f1-score': 0.320929728949363, 'support': 18276}, '1': {'precision': 0.5111601525446696, 'recall': 0.7982405755917652, 'f1-score': 0.6232297960725076, 'support': 33079}, '2': {'precision': 0.5022138587558114, 'recall': 0.24175414291042788, 'f1-score': 0.3263911370094601, 'support': 18767}, 'accuracy': 0.5046633011037905, 'macro avg': {'precision': 0.49493267948166814, 'recall': 0.4277548602054804, 'f1-score': 0.4235168873437769, 'support': 70122}, 'weighted avg': {'precision': 0.49840933934269915, 'recall': 0.5046633011037905, 'f1-score': 0.4649968999574681, 'support': 70122}}
[[ 4446 12541  1289]
 [ 3466 26405  3208]
 [ 1519 12711  4537]]
training model: results/QRTEA/W3/deepOF_L1/h100
Epoch 1/50
641/641 - 12s - loss: 3.2815 - accuracy100: 0.3855 - val_loss: 3.2566 - val_accuracy100: 0.3964 - 12s/epoch - 18ms/step
Epoch 2/50
641/641 - 9s - loss: 3.2512 - accuracy100: 0.3985 - val_loss: 3.2376 - val_accuracy100: 0.4020 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 9s - loss: 3.2413 - accuracy100: 0.4045 - val_loss: 3.2229 - val_accuracy100: 0.4093 - 9s/epoch - 15ms/step
Epoch 4/50
641/641 - 9s - loss: 3.2340 - accuracy100: 0.4059 - val_loss: 3.2193 - val_accuracy100: 0.4079 - 9s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.2321 - accuracy100: 0.4068 - val_loss: 3.2112 - val_accuracy100: 0.4129 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 10s - loss: 3.2293 - accuracy100: 0.4087 - val_loss: 3.2066 - val_accuracy100: 0.4157 - 10s/epoch - 15ms/step
Epoch 7/50
641/641 - 9s - loss: 3.2257 - accuracy100: 0.4093 - val_loss: 3.2058 - val_accuracy100: 0.4147 - 9s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.2208 - accuracy100: 0.4109 - val_loss: 3.2061 - val_accuracy100: 0.4158 - 9s/epoch - 15ms/step
Epoch 9/50
641/641 - 9s - loss: 3.2165 - accuracy100: 0.4137 - val_loss: 3.2069 - val_accuracy100: 0.4159 - 9s/epoch - 14ms/step
Epoch 10/50
641/641 - 9s - loss: 3.2120 - accuracy100: 0.4151 - val_loss: 3.2080 - val_accuracy100: 0.4148 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.2048 - accuracy100: 0.4186 - val_loss: 3.2095 - val_accuracy100: 0.4149 - 9s/epoch - 14ms/step
Epoch 12/50
641/641 - 9s - loss: 3.2021 - accuracy100: 0.4206 - val_loss: 3.2131 - val_accuracy100: 0.4150 - 9s/epoch - 14ms/step
Epoch 13/50
641/641 - 9s - loss: 3.1971 - accuracy100: 0.4238 - val_loss: 3.2114 - val_accuracy100: 0.4154 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.1924 - accuracy100: 0.4246 - val_loss: 3.2134 - val_accuracy100: 0.4183 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.1876 - accuracy100: 0.4278 - val_loss: 3.2170 - val_accuracy100: 0.4166 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.1837 - accuracy100: 0.4298 - val_loss: 3.2193 - val_accuracy100: 0.4178 - 9s/epoch - 14ms/step
Epoch 17/50
641/641 - 9s - loss: 3.1772 - accuracy100: 0.4328 - val_loss: 3.2205 - val_accuracy100: 0.4183 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h100
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0273918
{'0': {'precision': 0.4300114624772436, 'recall': 0.2737565058754091, 'f1-score': 0.3345376338445599, 'support': 93185}, '1': {'precision': 0.5255848966155205, 'recall': 0.7566125014826236, 'f1-score': 0.620285307019967, 'support': 185482}, '2': {'precision': 0.4154010994130253, 'recall': 0.19683892187810423, 'f1-score': 0.26710800245630323, 'support': 90602}, 'accuracy': 0.4974205795774896, 'macro avg': {'precision': 0.4569991528352631, 'recall': 0.409069309745379, 'f1-score': 0.4073103144402767, 'support': 369269}, 'weighted avg': {'precision': 0.47443280192488635, 'recall': 0.4974205795774896, 'f1-score': 0.4615230847025579, 'support': 369269}}
[[ 25510  61949   5726]
 [ 25772 140338  19372]
 [  8042  64726  17834]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0871403
{'0': {'precision': 0.47511328361936705, 'recall': 0.24076953675912197, 'f1-score': 0.31958527834111333, 'support': 55306}, '1': {'precision': 0.34315353422358946, 'recall': 0.7265914137675795, 'f1-score': 0.46615300598347426, 'support': 54040}, '2': {'precision': 0.48004439716968045, 'recall': 0.18966525361789213, 'f1-score': 0.2719021361868214, 'support': 54728}, 'accuracy': 0.38373538769091997, 'macro avg': {'precision': 0.4327704050042123, 'recall': 0.38567540138153117, 'f1-score': 0.3525468068371363, 'support': 164074}, 'weighted avg': {'precision': 0.43329535466678304, 'recall': 0.38373538769091997, 'f1-score': 0.3519543130326129, 'support': 164074}}
[[13316 37227  4763]
 [ 8295 39265  6480]
 [ 6416 37932 10380]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0686424
{'0': {'precision': 0.4617260297831577, 'recall': 0.2458613494087642, 'f1-score': 0.32086661825223917, 'support': 21565}, '1': {'precision': 0.38788038948630904, 'recall': 0.7378006341350244, 'f1-score': 0.5084538005462661, 'support': 25862}, '2': {'precision': 0.49957654033453314, 'recall': 0.2079312623925975, 'f1-score': 0.2936436327432252, 'support': 22695}, 'accuracy': 0.41501953737771313, 'macro avg': {'precision': 0.4497276532013333, 'recall': 0.39719774864546203, 'f1-score': 0.3743213505139102, 'support': 70122}, 'weighted avg': {'precision': 0.44674102347424416, 'recall': 0.41501953737771313, 'f1-score': 0.38124073839086975, 'support': 70122}}
[[ 5302 14489  1774]
 [ 3828 19081  2953]
 [ 2353 15623  4719]]
training model: results/QRTEA/W3/deepOF_L1/h200
Epoch 1/50
641/641 - 11s - loss: 3.2982 - accuracy200: 0.3701 - val_loss: 3.2884 - val_accuracy200: 0.3617 - 11s/epoch - 18ms/step
Epoch 2/50
641/641 - 10s - loss: 3.2733 - accuracy200: 0.3810 - val_loss: 3.2767 - val_accuracy200: 0.3703 - 10s/epoch - 15ms/step
Epoch 3/50
641/641 - 9s - loss: 3.2645 - accuracy200: 0.3857 - val_loss: 3.2664 - val_accuracy200: 0.3773 - 9s/epoch - 14ms/step
Epoch 4/50
641/641 - 9s - loss: 3.2625 - accuracy200: 0.3875 - val_loss: 3.2637 - val_accuracy200: 0.3786 - 9s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.2614 - accuracy200: 0.3875 - val_loss: 3.2616 - val_accuracy200: 0.3787 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 9s - loss: 3.2607 - accuracy200: 0.3868 - val_loss: 3.2588 - val_accuracy200: 0.3805 - 9s/epoch - 15ms/step
Epoch 7/50
641/641 - 9s - loss: 3.2596 - accuracy200: 0.3860 - val_loss: 3.2556 - val_accuracy200: 0.3805 - 9s/epoch - 14ms/step
Epoch 8/50
641/641 - 10s - loss: 3.2577 - accuracy200: 0.3869 - val_loss: 3.2541 - val_accuracy200: 0.3820 - 10s/epoch - 15ms/step
Epoch 9/50
641/641 - 9s - loss: 3.2575 - accuracy200: 0.3874 - val_loss: 3.2548 - val_accuracy200: 0.3832 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.2573 - accuracy200: 0.3867 - val_loss: 3.2536 - val_accuracy200: 0.3824 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.2556 - accuracy200: 0.3875 - val_loss: 3.2537 - val_accuracy200: 0.3835 - 9s/epoch - 15ms/step
Epoch 12/50
641/641 - 9s - loss: 3.2542 - accuracy200: 0.3871 - val_loss: 3.2501 - val_accuracy200: 0.3860 - 9s/epoch - 15ms/step
Epoch 13/50
641/641 - 9s - loss: 3.2541 - accuracy200: 0.3882 - val_loss: 3.2511 - val_accuracy200: 0.3841 - 9s/epoch - 14ms/step
Epoch 14/50
641/641 - 9s - loss: 3.2537 - accuracy200: 0.3876 - val_loss: 3.2511 - val_accuracy200: 0.3841 - 9s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.2514 - accuracy200: 0.3889 - val_loss: 3.2495 - val_accuracy200: 0.3851 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.2497 - accuracy200: 0.3901 - val_loss: 3.2496 - val_accuracy200: 0.3859 - 9s/epoch - 15ms/step
Epoch 17/50
641/641 - 9s - loss: 3.2494 - accuracy200: 0.3907 - val_loss: 3.2498 - val_accuracy200: 0.3855 - 9s/epoch - 15ms/step
Epoch 18/50
641/641 - 9s - loss: 3.2477 - accuracy200: 0.3924 - val_loss: 3.2475 - val_accuracy200: 0.3862 - 9s/epoch - 14ms/step
Epoch 19/50
641/641 - 9s - loss: 3.2463 - accuracy200: 0.3925 - val_loss: 3.2469 - val_accuracy200: 0.3871 - 9s/epoch - 15ms/step
Epoch 20/50
641/641 - 9s - loss: 3.2458 - accuracy200: 0.3920 - val_loss: 3.2467 - val_accuracy200: 0.3869 - 9s/epoch - 15ms/step
Epoch 21/50
641/641 - 9s - loss: 3.2447 - accuracy200: 0.3936 - val_loss: 3.2475 - val_accuracy200: 0.3858 - 9s/epoch - 15ms/step
Epoch 22/50
641/641 - 10s - loss: 3.2426 - accuracy200: 0.3943 - val_loss: 3.2481 - val_accuracy200: 0.3863 - 10s/epoch - 15ms/step
Epoch 23/50
641/641 - 9s - loss: 3.2395 - accuracy200: 0.3968 - val_loss: 3.2466 - val_accuracy200: 0.3870 - 9s/epoch - 14ms/step
Epoch 24/50
641/641 - 10s - loss: 3.2379 - accuracy200: 0.3979 - val_loss: 3.2458 - val_accuracy200: 0.3861 - 10s/epoch - 15ms/step
Epoch 25/50
641/641 - 10s - loss: 3.2361 - accuracy200: 0.3982 - val_loss: 3.2479 - val_accuracy200: 0.3866 - 10s/epoch - 15ms/step
Epoch 26/50
641/641 - 10s - loss: 3.2351 - accuracy200: 0.3986 - val_loss: 3.2462 - val_accuracy200: 0.3866 - 10s/epoch - 15ms/step
Epoch 27/50
641/641 - 10s - loss: 3.2335 - accuracy200: 0.3984 - val_loss: 3.2459 - val_accuracy200: 0.3867 - 10s/epoch - 15ms/step
Epoch 28/50
641/641 - 9s - loss: 3.2330 - accuracy200: 0.3990 - val_loss: 3.2450 - val_accuracy200: 0.3877 - 9s/epoch - 15ms/step
Epoch 29/50
641/641 - 9s - loss: 3.2288 - accuracy200: 0.4028 - val_loss: 3.2454 - val_accuracy200: 0.3882 - 9s/epoch - 15ms/step
Epoch 30/50
641/641 - 9s - loss: 3.2272 - accuracy200: 0.4037 - val_loss: 3.2432 - val_accuracy200: 0.3891 - 9s/epoch - 14ms/step
Epoch 31/50
641/641 - 9s - loss: 3.2250 - accuracy200: 0.4045 - val_loss: 3.2449 - val_accuracy200: 0.3879 - 9s/epoch - 15ms/step
Epoch 32/50
641/641 - 9s - loss: 3.2226 - accuracy200: 0.4039 - val_loss: 3.2454 - val_accuracy200: 0.3886 - 9s/epoch - 15ms/step
Epoch 33/50
641/641 - 9s - loss: 3.2196 - accuracy200: 0.4061 - val_loss: 3.2466 - val_accuracy200: 0.3881 - 9s/epoch - 15ms/step
Epoch 34/50
641/641 - 9s - loss: 3.2201 - accuracy200: 0.4073 - val_loss: 3.2477 - val_accuracy200: 0.3851 - 9s/epoch - 15ms/step
Epoch 35/50
641/641 - 9s - loss: 3.2168 - accuracy200: 0.4088 - val_loss: 3.2460 - val_accuracy200: 0.3877 - 9s/epoch - 15ms/step
Epoch 36/50
641/641 - 9s - loss: 3.2124 - accuracy200: 0.4109 - val_loss: 3.2463 - val_accuracy200: 0.3861 - 9s/epoch - 14ms/step
Epoch 37/50
641/641 - 9s - loss: 3.2109 - accuracy200: 0.4126 - val_loss: 3.2462 - val_accuracy200: 0.3888 - 9s/epoch - 15ms/step
Epoch 38/50
641/641 - 10s - loss: 3.2059 - accuracy200: 0.4148 - val_loss: 3.2494 - val_accuracy200: 0.3872 - 10s/epoch - 15ms/step
Epoch 39/50
641/641 - 9s - loss: 3.2041 - accuracy200: 0.4166 - val_loss: 3.2498 - val_accuracy200: 0.3860 - 9s/epoch - 15ms/step
Epoch 40/50
641/641 - 9s - loss: 3.2003 - accuracy200: 0.4184 - val_loss: 3.2486 - val_accuracy200: 0.3866 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h200
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0802245
{'0': {'precision': 0.38010288300509615, 'recall': 0.5540060541372854, 'f1-score': 0.45086668161866006, 'support': 114302}, '1': {'precision': 0.40263907786306574, 'recall': 0.10680795134940038, 'f1-score': 0.16883033003939807, 'support': 146843}, '2': {'precision': 0.3648141022117164, 'recall': 0.5523935481484222, 'f1-score': 0.43942275504611117, 'support': 108124}, 'accuracy': 0.375701724217305, 'macro avg': {'precision': 0.3825186876932927, 'recall': 0.4044025178783694, 'f1-score': 0.35303992223472314, 'support': 369269}, 'weighted avg': {'precision': 0.38458795574888294, 'recall': 0.375701724217305, 'f1-score': 0.3353616511620448, 'support': 369269}}
[[63324 12092 38886]
 [66053 15684 65106]
 [37220 11177 59727]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083105
{'0': {'precision': 0.3989406606573895, 'recall': 0.528939196995956, 'f1-score': 0.45483335144449444, 'support': 55392}, '1': {'precision': 0.3494801370274656, 'recall': 0.10649402974141088, 'f1-score': 0.16324410819308563, 'support': 54604}, '2': {'precision': 0.38811779492654713, 'recall': 0.531047745848589, 'f1-score': 0.44846998930280857, 'support': 54078}, 'accuracy': 0.38904396796567403, 'macro avg': {'precision': 0.37884619753713406, 'recall': 0.3888269908619853, 'f1-score': 0.3555158163134629, 'support': 164074}, 'weighted avg': {'precision': 0.37891298189487466, 'recall': 0.38904396796567403, 'f1-score': 0.3556948106860683, 'support': 164074}}
[[29299  5363 20730]
 [24244  5815 24545]
 [19899  5461 28718]]
Evaluating performance on  val set...
274/274 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0808098
{'0': {'precision': 0.38229122954259337, 'recall': 0.5414933016322985, 'f1-score': 0.4481740775780511, 'support': 21871}, '1': {'precision': 0.36523636363636364, 'recall': 0.10052041633306645, 'f1-score': 0.15765185999058232, 'support': 24980}, '2': {'precision': 0.40061361100780957, 'recall': 0.5554982596364574, 'f1-score': 0.46551072219521417, 'support': 23271}, 'accuracy': 0.38905051196486123, 'macro avg': {'precision': 0.3827137347289222, 'recall': 0.3991706592006074, 'f1-score': 0.35711221992128256, 'support': 70122}, 'weighted avg': {'precision': 0.3822962149785396, 'recall': 0.38905051196486123, 'f1-score': 0.3504329415800908, 'support': 70122}}
[[11843  2070  7958]
 [11086  2511 11383]
 [ 8050  2294 12927]]
training model: results/QRTEA/W3/deepOF_L1/h300
Epoch 1/50
641/641 - 12s - loss: 3.3116 - accuracy300: 0.3577 - val_loss: 3.3100 - val_accuracy300: 0.3390 - 12s/epoch - 19ms/step
Epoch 2/50
641/641 - 9s - loss: 3.2910 - accuracy300: 0.3638 - val_loss: 3.2994 - val_accuracy300: 0.3376 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 9s - loss: 3.2820 - accuracy300: 0.3668 - val_loss: 3.2907 - val_accuracy300: 0.3417 - 9s/epoch - 15ms/step
Epoch 4/50
641/641 - 10s - loss: 3.2770 - accuracy300: 0.3711 - val_loss: 3.2858 - val_accuracy300: 0.3430 - 10s/epoch - 15ms/step
Epoch 5/50
641/641 - 10s - loss: 3.2750 - accuracy300: 0.3719 - val_loss: 3.2820 - val_accuracy300: 0.3448 - 10s/epoch - 15ms/step
Epoch 6/50
641/641 - 10s - loss: 3.2727 - accuracy300: 0.3734 - val_loss: 3.2800 - val_accuracy300: 0.3461 - 10s/epoch - 16ms/step
Epoch 7/50
641/641 - 10s - loss: 3.2711 - accuracy300: 0.3751 - val_loss: 3.2777 - val_accuracy300: 0.3507 - 10s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.2696 - accuracy300: 0.3755 - val_loss: 3.2752 - val_accuracy300: 0.3540 - 9s/epoch - 15ms/step
Epoch 9/50
641/641 - 10s - loss: 3.2679 - accuracy300: 0.3754 - val_loss: 3.2749 - val_accuracy300: 0.3557 - 10s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.2671 - accuracy300: 0.3770 - val_loss: 3.2749 - val_accuracy300: 0.3577 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 9s - loss: 3.2660 - accuracy300: 0.3789 - val_loss: 3.2731 - val_accuracy300: 0.3620 - 9s/epoch - 15ms/step
Epoch 12/50
641/641 - 9s - loss: 3.2652 - accuracy300: 0.3791 - val_loss: 3.2729 - val_accuracy300: 0.3629 - 9s/epoch - 14ms/step
Epoch 13/50
641/641 - 9s - loss: 3.2644 - accuracy300: 0.3798 - val_loss: 3.2728 - val_accuracy300: 0.3629 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 9s - loss: 3.2627 - accuracy300: 0.3810 - val_loss: 3.2732 - val_accuracy300: 0.3639 - 9s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.2619 - accuracy300: 0.3800 - val_loss: 3.2722 - val_accuracy300: 0.3654 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.2608 - accuracy300: 0.3818 - val_loss: 3.2725 - val_accuracy300: 0.3623 - 9s/epoch - 15ms/step
Epoch 17/50
641/641 - 9s - loss: 3.2591 - accuracy300: 0.3832 - val_loss: 3.2734 - val_accuracy300: 0.3658 - 9s/epoch - 15ms/step
Epoch 18/50
641/641 - 10s - loss: 3.2582 - accuracy300: 0.3834 - val_loss: 3.2729 - val_accuracy300: 0.3647 - 10s/epoch - 15ms/step
Epoch 19/50
641/641 - 10s - loss: 3.2559 - accuracy300: 0.3852 - val_loss: 3.2751 - val_accuracy300: 0.3623 - 10s/epoch - 15ms/step
Epoch 20/50
641/641 - 9s - loss: 3.2553 - accuracy300: 0.3862 - val_loss: 3.2751 - val_accuracy300: 0.3623 - 9s/epoch - 15ms/step
Epoch 21/50
641/641 - 10s - loss: 3.2540 - accuracy300: 0.3869 - val_loss: 3.2755 - val_accuracy300: 0.3636 - 10s/epoch - 15ms/step
Epoch 22/50
641/641 - 9s - loss: 3.2529 - accuracy300: 0.3862 - val_loss: 3.2763 - val_accuracy300: 0.3630 - 9s/epoch - 15ms/step
Epoch 23/50
641/641 - 9s - loss: 3.2516 - accuracy300: 0.3878 - val_loss: 3.2775 - val_accuracy300: 0.3618 - 9s/epoch - 15ms/step
Epoch 24/50
641/641 - 9s - loss: 3.2506 - accuracy300: 0.3892 - val_loss: 3.2784 - val_accuracy300: 0.3627 - 9s/epoch - 15ms/step
Epoch 25/50
641/641 - 9s - loss: 3.2487 - accuracy300: 0.3893 - val_loss: 3.2792 - val_accuracy300: 0.3622 - 9s/epoch - 15ms/step
testing model: results/QRTEA/W3/deepOF_L1/h300
Evaluating performance on  test set...
1443/1443 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0840195
{'0': {'precision': 0.394856278366112, 'recall': 0.34627935723114955, 'f1-score': 0.3689758573303888, 'support': 121350}, '1': {'precision': 0.36317341195389974, 'recall': 0.49149079495739845, 'f1-score': 0.4176994602211961, 'support': 135089}, '2': {'precision': 0.3845730922540579, 'recall': 0.27277319861738897, 'f1-score': 0.3191658154402957, 'support': 112830}, 'accuracy': 0.3769420124624596, 'macro avg': {'precision': 0.3808675941913566, 'recall': 0.37018111693531236, 'f1-score': 0.3686137109972935, 'support': 369269}, 'weighted avg': {'precision': 0.38012377000558784, 'recall': 0.3769420124624596, 'f1-score': 0.37158088446360893, 'support': 369269}}
[[42021 60565 18764]
 [38206 66395 30488]
 [26194 55859 30777]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924008
{'0': {'precision': 0.40289291882556133, 'recall': 0.32735182164219684, 'f1-score': 0.3612151477320017, 'support': 57009}, '1': {'precision': 0.3197318492284341, 'recall': 0.4876439608773656, 'f1-score': 0.38622733905284307, 'support': 51837}, '2': {'precision': 0.3969090815113454, 'recall': 0.2780835807923517, 'f1-score': 0.3270373288473414, 'support': 55228}, 'accuracy': 0.36141009544473834, 'macro avg': {'precision': 0.3731779498551136, 'recall': 0.364359787770638, 'f1-score': 0.3581599385440621, 'support': 164074}, 'weighted avg': {'precision': 0.37460509911070217, 'recall': 0.36141009544473834, 'f1-score': 0.35761301930297845, 'support': 164074}}
[[18662 27213 11134]
 [14357 25278 12202]
 [13301 26569 15358]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0905474
{'0': {'precision': 0.38933359524628003, 'recall': 0.3476735517256501, 'f1-score': 0.3673261363109855, 'support': 22803}, '1': {'precision': 0.32447973713033956, 'recall': 0.4663926181834084, 'f1-score': 0.38270386651116894, 'support': 22867}, '2': {'precision': 0.41229056894204014, 'recall': 0.2848028791100932, 'f1-score': 0.33688895338993297, 'support': 24452}, 'accuracy': 0.36446478993753745, 'macro avg': {'precision': 0.37536796710621995, 'recall': 0.3662896830063839, 'f1-score': 0.3623063187373625, 'support': 70122}, 'weighted avg': {'precision': 0.37618979939435787, 'recall': 0.36446478993753745, 'f1-score': 0.3617272167094626, 'support': 70122}}
[[ 7928 10570  4305]
 [ 6580 10665  5622]
 [ 5855 11633  6964]]
training model: results/QRTEA/W3/deepOF_L1/h500
Epoch 1/50
641/641 - 12s - loss: 3.2962 - accuracy500: 0.3824 - val_loss: 3.2962 - val_accuracy500: 0.3659 - 12s/epoch - 18ms/step
Epoch 2/50
641/641 - 10s - loss: 3.2695 - accuracy500: 0.3938 - val_loss: 3.2893 - val_accuracy500: 0.3676 - 10s/epoch - 15ms/step
Epoch 3/50
641/641 - 9s - loss: 3.2824 - accuracy500: 0.3806 - val_loss: 3.2814 - val_accuracy500: 0.3774 - 9s/epoch - 15ms/step
Epoch 4/50
641/641 - 10s - loss: 3.2845 - accuracy500: 0.3796 - val_loss: 3.2782 - val_accuracy500: 0.3790 - 10s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.2858 - accuracy500: 0.3765 - val_loss: 3.2774 - val_accuracy500: 0.3777 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 9s - loss: 3.2850 - accuracy500: 0.3732 - val_loss: 3.2772 - val_accuracy500: 0.3762 - 9s/epoch - 15ms/step
Epoch 7/50
641/641 - 9s - loss: 3.2828 - accuracy500: 0.3736 - val_loss: 3.2792 - val_accuracy500: 0.3723 - 9s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.2812 - accuracy500: 0.3750 - val_loss: 3.2775 - val_accuracy500: 0.3734 - 9s/epoch - 14ms/step
Epoch 9/50
641/641 - 9s - loss: 3.2791 - accuracy500: 0.3760 - val_loss: 3.2769 - val_accuracy500: 0.3739 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.2770 - accuracy500: 0.3783 - val_loss: 3.2778 - val_accuracy500: 0.3725 - 9s/epoch - 14ms/step
Epoch 11/50
641/641 - 9s - loss: 3.2758 - accuracy500: 0.3796 - val_loss: 3.2780 - val_accuracy500: 0.3721 - 9s/epoch - 15ms/step
Epoch 12/50
641/641 - 10s - loss: 3.2734 - accuracy500: 0.3815 - val_loss: 3.2778 - val_accuracy500: 0.3741 - 10s/epoch - 15ms/step
Epoch 13/50
641/641 - 9s - loss: 3.2728 - accuracy500: 0.3822 - val_loss: 3.2786 - val_accuracy500: 0.3735 - 9s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.2677 - accuracy500: 0.3866 - val_loss: 3.2778 - val_accuracy500: 0.3737 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 9s - loss: 3.2619 - accuracy500: 0.3893 - val_loss: 3.2781 - val_accuracy500: 0.3732 - 9s/epoch - 15ms/step
Epoch 16/50
641/641 - 10s - loss: 3.2588 - accuracy500: 0.3912 - val_loss: 3.2795 - val_accuracy500: 0.3724 - 10s/epoch - 15ms/step
Epoch 17/50
641/641 - 9s - loss: 3.2559 - accuracy500: 0.3944 - val_loss: 3.2806 - val_accuracy500: 0.3721 - 9s/epoch - 15ms/step
Epoch 18/50
641/641 - 10s - loss: 3.2538 - accuracy500: 0.3940 - val_loss: 3.2822 - val_accuracy500: 0.3699 - 10s/epoch - 15ms/step
Epoch 19/50
641/641 - 9s - loss: 3.2514 - accuracy500: 0.3965 - val_loss: 3.2823 - val_accuracy500: 0.3717 - 9s/epoch - 14ms/step
testing model: results/QRTEA/W3/deepOF_L1/h500
Evaluating performance on  test set...
1443/1443 - 10s - 10s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0841572
{'0': {'precision': 0.4013694348950195, 'recall': 0.804424419721979, 'f1-score': 0.5355332895806136, 'support': 140493}, '1': {'precision': 0.29178470254957506, 'recall': 0.001037459332601404, 'f1-score': 0.002067567296304474, 'support': 99281}, '2': {'precision': 0.40541561712846347, 'recall': 0.27343912892389666, 'f1-score': 0.32659856572970225, 'support': 129495}, 'accuracy': 0.40222168662953023, 'macro avg': {'precision': 0.3661899181910193, 'recall': 0.35963366932615903, 'f1-score': 0.2880664742022068, 'support': 369269}, 'weighted avg': {'precision': 0.37332559302454493, 'recall': 0.40222168662953023, 'f1-score': 0.3188375679273412, 'support': 369269}}
[[113016    146  27331]
 [ 74578    103  24600]
 [ 93982    104  35409]]
Evaluating performance on  train set...
641/641 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1039579
{'0': {'precision': 0.3469754574294494, 'recall': 0.7656175750265014, 'f1-score': 0.4775340138962512, 'support': 54714}, '1': {'precision': 0.3838383838383838, 'recall': 0.0006818956699624957, 'f1-score': 0.001361372837029341, 'support': 55727}, '2': {'precision': 0.3620450446284049, 'recall': 0.29192847687058343, 'f1-score': 0.3232279441365002, 'support': 53633}, 'accuracy': 0.35096968441069276, 'macro avg': {'precision': 0.36428629529874607, 'recall': 0.35274264918901577, 'f1-score': 0.2673744436232603, 'support': 164074}, 'weighted avg': {'precision': 0.36442177720121255, 'recall': 0.35096968441069276, 'f1-score': 0.26536407711326315, 'support': 164074}}
[[41890    35 12789]
 [40889    38 14800]
 [37950    26 15657]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917778
{'0': {'precision': 0.3592328450269853, 'recall': 0.774283340257582, 'f1-score': 0.49077024358130344, 'support': 24070}, '1': {'precision': 0.2727272727272727, 'recall': 0.0005969258319653783, 'f1-score': 0.001191244353998114, 'support': 20103}, '2': {'precision': 0.41801296845807234, 'recall': 0.2931519519056611, 'f1-score': 0.34462137857612074, 'support': 25949}, 'accuracy': 0.3744331308291264, 'macro avg': {'precision': 0.3499910287374434, 'recall': 0.3560107393317362, 'f1-score': 0.27886095550380746, 'support': 70122}, 'weighted avg': {'precision': 0.3561847845462825, 'recall': 0.3744331308291264, 'f1-score': 0.29633164343461615, 'support': 70122}}
[[18637    11  5422]
 [14922    12  5169]
 [18321    21  7607]]
training model: results/QRTEA/W3/deepOF_L1/h1000
Epoch 1/50
641/641 - 12s - loss: 3.3085 - accuracy1000: 0.3716 - val_loss: 3.4269 - val_accuracy1000: 0.3242 - 12s/epoch - 19ms/step
Epoch 2/50
641/641 - 9s - loss: 3.2985 - accuracy1000: 0.3744 - val_loss: 3.3979 - val_accuracy1000: 0.3284 - 9s/epoch - 15ms/step
Epoch 3/50
641/641 - 10s - loss: 3.2936 - accuracy1000: 0.3744 - val_loss: 3.3777 - val_accuracy1000: 0.3331 - 10s/epoch - 15ms/step
Epoch 4/50
641/641 - 9s - loss: 3.2942 - accuracy1000: 0.3694 - val_loss: 3.3653 - val_accuracy1000: 0.3320 - 9s/epoch - 15ms/step
Epoch 5/50
641/641 - 9s - loss: 3.2921 - accuracy1000: 0.3675 - val_loss: 3.3637 - val_accuracy1000: 0.3297 - 9s/epoch - 15ms/step
Epoch 6/50
641/641 - 9s - loss: 3.2936 - accuracy1000: 0.3627 - val_loss: 3.3510 - val_accuracy1000: 0.3288 - 9s/epoch - 15ms/step
Epoch 7/50
641/641 - 9s - loss: 3.2917 - accuracy1000: 0.3638 - val_loss: 3.3419 - val_accuracy1000: 0.3290 - 9s/epoch - 15ms/step
Epoch 8/50
641/641 - 9s - loss: 3.2903 - accuracy1000: 0.3645 - val_loss: 3.3329 - val_accuracy1000: 0.3316 - 9s/epoch - 15ms/step
Epoch 9/50
641/641 - 9s - loss: 3.2903 - accuracy1000: 0.3626 - val_loss: 3.3288 - val_accuracy1000: 0.3282 - 9s/epoch - 15ms/step
Epoch 10/50
641/641 - 9s - loss: 3.2903 - accuracy1000: 0.3614 - val_loss: 3.3248 - val_accuracy1000: 0.3297 - 9s/epoch - 15ms/step
Epoch 11/50
641/641 - 10s - loss: 3.2881 - accuracy1000: 0.3639 - val_loss: 3.3248 - val_accuracy1000: 0.3262 - 10s/epoch - 15ms/step
Epoch 12/50
641/641 - 10s - loss: 3.2875 - accuracy1000: 0.3649 - val_loss: 3.3237 - val_accuracy1000: 0.3340 - 10s/epoch - 15ms/step
Epoch 13/50
641/641 - 10s - loss: 3.2851 - accuracy1000: 0.3670 - val_loss: 3.3291 - val_accuracy1000: 0.3282 - 10s/epoch - 15ms/step
Epoch 14/50
641/641 - 10s - loss: 3.2852 - accuracy1000: 0.3651 - val_loss: 3.3245 - val_accuracy1000: 0.3314 - 10s/epoch - 15ms/step
Epoch 15/50
641/641 - 10s - loss: 3.2828 - accuracy1000: 0.3679 - val_loss: 3.3289 - val_accuracy1000: 0.3304 - 10s/epoch - 15ms/step
Epoch 16/50
641/641 - 9s - loss: 3.2815 - accuracy1000: 0.3703 - val_loss: 3.3322 - val_accuracy1000: 0.3325 - 9s/epoch - 15ms/step
Epoch 17/50
641/641 - 9s - loss: 3.2823 - accuracy1000: 0.3754 - val_loss: 3.3423 - val_accuracy1000: 0.3268 - 9s/epoch - 15ms/step
Epoch 18/50
641/641 - 9s - loss: 3.2800 - accuracy1000: 0.3705 - val_loss: 3.3343 - val_accuracy1000: 0.3310 - 9s/epoch - 15ms/step
Epoch 19/50
641/641 - 10s - loss: 3.2764 - accuracy1000: 0.3732 - val_loss: 3.3337 - val_accuracy1000: 0.3274 - 10s/epoch - 15ms/step
Epoch 20/50
641/641 - 10s - loss: 3.2746 - accuracy1000: 0.3747 - val_loss: 3.3313 - val_accuracy1000: 0.3295 - 10s/epoch - 15ms/step
Epoch 21/50
641/641 - 10s - loss: 3.2738 - accuracy1000: 0.3758 - val_loss: 3.3356 - val_accuracy1000: 0.3286 - 10s/epoch - 16ms/step
Epoch 22/50
641/641 - 10s - loss: 3.2723 - accuracy1000: 0.3767 - val_loss: 3.3322 - val_accuracy1000: 0.3302 - 10s/epoch - 16ms/step
testing model: results/QRTEA/W3/deepOF_L1/h1000
Evaluating performance on  test set...
1443/1443 - 8s - 8s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0856423
{'0': {'precision': 0.40453834517063664, 'recall': 0.5477236906968832, 'f1-score': 0.4653661011349961, 'support': 144027}, '1': {'precision': 0.23655913978494625, 'recall': 0.0019584497090144324, 'f1-score': 0.0038847380560859054, 'support': 89867}, '2': {'precision': 0.37992738589211617, 'recall': 0.48698060941828253, 'f1-score': 0.42684407322876705, 'support': 135375}, 'accuracy': 0.39263517923248364, 'macro avg': {'precision': 0.34034162361589965, 'recall': 0.34555424994139344, 'f1-score': 0.2986983041399497, 'support': 369269}, 'weighted avg': {'precision': 0.35463571087768064, 'recall': 0.39263517923248364, 'f1-score': 0.3389355987542975, 'support': 369269}}
[[78887   262 64878]
 [46974   176 42717]
 [69144   306 65925]]
Evaluating performance on  train set...
641/641 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002027
{'0': {'precision': 0.35357561264297016, 'recall': 0.5241155829275279, 'f1-score': 0.42227719558898835, 'support': 55856}, '1': {'precision': 0.36637931034482757, 'recall': 0.0015654928539855606, 'f1-score': 0.003117664319248826, 'support': 54296}, '2': {'precision': 0.3390708865445123, 'recall': 0.5096250139089796, 'f1-score': 0.407210651492587, 'support': 53922}, 'accuracy': 0.346429050306569, 'macro avg': {'precision': 0.35300860317743665, 'recall': 0.34510202989683103, 'f1-score': 0.27753517046694137, 'support': 164074}, 'weighted avg': {'precision': 0.3530457647069108, 'recall': 0.346429050306569, 'f1-score': 0.2786157739098196, 'support': 164074}}
[[29275    72 26509]
 [27155    85 27056]
 [26367    75 27480]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.106415
{'0': {'precision': 0.31726742753920684, 'recall': 0.5394889933448132, 'f1-score': 0.39955880325382603, 'support': 21487}, '1': {'precision': 0.19801980198019803, 'recall': 0.000789110278161373, 'f1-score': 0.0015719562996148707, 'support': 25345}, '2': {'precision': 0.3439553219448095, 'recall': 0.49450407900386434, 'f1-score': 0.40571388311551065, 'support': 23290}, 'accuracy': 0.32983942272040156, 'macro avg': {'precision': 0.28641418382140477, 'recall': 0.3449273942089463, 'f1-score': 0.2689482142229838, 'support': 70122}, 'weighted avg': {'precision': 0.2830303834006114, 'recall': 0.32983942272040156, 'f1-score': 0.2577541652504056, 'support': 70122}}
[[11592    40  9855]
 [13213    20 12112]
 [11732    41 11517]]
training model: results/QRTEA/W3/deepLOB_L2/h10
Epoch 1/50
641/641 - 31s - loss: 3.2348 - accuracy10: 0.4501 - val_loss: 3.0756 - val_accuracy10: 0.5129 - 31s/epoch - 49ms/step
Epoch 2/50
641/641 - 28s - loss: 3.0369 - accuracy10: 0.4445 - val_loss: 2.8336 - val_accuracy10: 0.5640 - 28s/epoch - 43ms/step
Epoch 3/50
641/641 - 28s - loss: 2.9246 - accuracy10: 0.4794 - val_loss: 2.9061 - val_accuracy10: 0.5118 - 28s/epoch - 43ms/step
Epoch 4/50
641/641 - 28s - loss: 2.8696 - accuracy10: 0.5012 - val_loss: 2.7668 - val_accuracy10: 0.5243 - 28s/epoch - 44ms/step
Epoch 5/50
641/641 - 28s - loss: 2.8190 - accuracy10: 0.5231 - val_loss: 2.7696 - val_accuracy10: 0.5662 - 28s/epoch - 44ms/step
Epoch 6/50
641/641 - 28s - loss: 2.7802 - accuracy10: 0.5353 - val_loss: 2.6821 - val_accuracy10: 0.5744 - 28s/epoch - 44ms/step
Epoch 7/50
641/641 - 28s - loss: 2.7480 - accuracy10: 0.5464 - val_loss: 2.6806 - val_accuracy10: 0.5871 - 28s/epoch - 44ms/step
Epoch 8/50
641/641 - 28s - loss: 2.7273 - accuracy10: 0.5524 - val_loss: 2.6519 - val_accuracy10: 0.5640 - 28s/epoch - 44ms/step
Epoch 9/50
641/641 - 28s - loss: 2.6937 - accuracy10: 0.5656 - val_loss: 2.6037 - val_accuracy10: 0.5873 - 28s/epoch - 44ms/step
Epoch 10/50
641/641 - 28s - loss: 2.6651 - accuracy10: 0.5778 - val_loss: 2.6023 - val_accuracy10: 0.5548 - 28s/epoch - 43ms/step
Epoch 11/50
641/641 - 28s - loss: 2.6382 - accuracy10: 0.5857 - val_loss: 2.6198 - val_accuracy10: 0.5580 - 28s/epoch - 44ms/step
Epoch 12/50
641/641 - 28s - loss: 2.6146 - accuracy10: 0.5937 - val_loss: 2.5583 - val_accuracy10: 0.5737 - 28s/epoch - 43ms/step
Epoch 13/50
641/641 - 28s - loss: 2.5940 - accuracy10: 0.5976 - val_loss: 2.5366 - val_accuracy10: 0.5956 - 28s/epoch - 44ms/step
Epoch 14/50
641/641 - 28s - loss: 2.5742 - accuracy10: 0.6023 - val_loss: 2.5556 - val_accuracy10: 0.5621 - 28s/epoch - 44ms/step
Epoch 15/50
641/641 - 28s - loss: 2.5572 - accuracy10: 0.6070 - val_loss: 2.5414 - val_accuracy10: 0.5667 - 28s/epoch - 44ms/step
Epoch 16/50
641/641 - 28s - loss: 2.5428 - accuracy10: 0.6076 - val_loss: 2.5172 - val_accuracy10: 0.5846 - 28s/epoch - 43ms/step
Epoch 17/50
641/641 - 27s - loss: 2.5278 - accuracy10: 0.6114 - val_loss: 2.5198 - val_accuracy10: 0.5618 - 27s/epoch - 43ms/step
Epoch 18/50
641/641 - 27s - loss: 2.5180 - accuracy10: 0.6128 - val_loss: 2.4991 - val_accuracy10: 0.5969 - 27s/epoch - 43ms/step
Epoch 19/50
641/641 - 28s - loss: 2.5022 - accuracy10: 0.6162 - val_loss: 2.5298 - val_accuracy10: 0.5720 - 28s/epoch - 43ms/step
Epoch 20/50
641/641 - 28s - loss: 2.4878 - accuracy10: 0.6184 - val_loss: 2.5186 - val_accuracy10: 0.5732 - 28s/epoch - 43ms/step
Epoch 21/50
641/641 - 27s - loss: 2.4746 - accuracy10: 0.6196 - val_loss: 2.5003 - val_accuracy10: 0.5871 - 27s/epoch - 43ms/step
Epoch 22/50
641/641 - 28s - loss: 2.4646 - accuracy10: 0.6207 - val_loss: 2.5147 - val_accuracy10: 0.5770 - 28s/epoch - 43ms/step
Epoch 23/50
641/641 - 27s - loss: 2.4479 - accuracy10: 0.6226 - val_loss: 2.5245 - val_accuracy10: 0.5665 - 27s/epoch - 43ms/step
Epoch 24/50
641/641 - 28s - loss: 2.4362 - accuracy10: 0.6231 - val_loss: 2.5271 - val_accuracy10: 0.5669 - 28s/epoch - 43ms/step
Epoch 25/50
641/641 - 28s - loss: 2.4255 - accuracy10: 0.6230 - val_loss: 2.5301 - val_accuracy10: 0.5686 - 28s/epoch - 43ms/step
Epoch 26/50
641/641 - 28s - loss: 2.4151 - accuracy10: 0.6248 - val_loss: 2.5321 - val_accuracy10: 0.5709 - 28s/epoch - 43ms/step
Epoch 27/50
641/641 - 27s - loss: 2.4034 - accuracy10: 0.6260 - val_loss: 2.5448 - val_accuracy10: 0.5618 - 27s/epoch - 43ms/step
Epoch 28/50
641/641 - 28s - loss: 2.3938 - accuracy10: 0.6263 - val_loss: 2.5046 - val_accuracy10: 0.5885 - 28s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h10
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7626423
{'0': {'precision': 0.3706346038714827, 'recall': 0.43482587064676614, 'f1-score': 0.4001723720003232, 'support': 34170}, '1': {'precision': 0.9172074452362221, 'recall': 0.6679084830963947, 'f1-score': 0.7729537284718975, 'support': 301977}, '2': {'precision': 0.2193053090057281, 'recall': 0.7235102336533237, 'f1-score': 0.33658680448276834, 'support': 33126}, 'accuracy': 0.6513284209785173, 'macro avg': {'precision': 0.5023824527044777, 'recall': 0.6087481957988282, 'f1-score': 0.5032376349849964, 'support': 369273}, 'weighted avg': {'precision': 0.8040253275232984, 'recall': 0.6513284209785173, 'f1-score': 0.6993143622721006, 'support': 369273}}
[[ 14858  11904   7408]
 [ 22373 201693  77911]
 [  2857   6302  23967]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8931935
{'0': {'precision': 0.40116854822737175, 'recall': 0.4377093462992977, 'f1-score': 0.418643104428254, 'support': 27765}, '1': {'precision': 0.8140213846970501, 'recall': 0.5879716270620133, 'f1-score': 0.6827729867541594, 'support': 109541}, '2': {'precision': 0.30545747269434126, 'recall': 0.6237065262056857, 'f1-score': 0.41008007073733854, 'support': 26769}, 'accuracy': 0.5683742191071156, 'macro avg': {'precision': 0.5068824685395877, 'recall': 0.5497958331889988, 'f1-score': 0.5038320539732507, 'support': 164075}, 'weighted avg': {'precision': 0.661185142947965, 'recall': 0.5683742191071156, 'f1-score': 0.593586438824048, 'support': 164075}}
[[12153  8665  6947]
 [14118 64407 31016]
 [ 4023  6050 16696]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.85978544
{'0': {'precision': 0.36215399300031814, 'recall': 0.4624682579989843, 'f1-score': 0.4062095730918499, 'support': 9845}, '1': {'precision': 0.8578523003096838, 'recall': 0.6100188473365737, 'f1-score': 0.7130136350987849, 'support': 50405}, '2': {'precision': 0.3020223890910766, 'recall': 0.6641004862236629, 'f1-score': 0.4152126413122645, 'support': 9872}, 'accuracy': 0.5969168021448333, 'macro avg': {'precision': 0.5073428941336928, 'recall': 0.5788625305197402, 'f1-score': 0.5114786165009665, 'support': 70122}, 'weighted avg': {'precision': 0.71000565134059, 'recall': 0.5969168021448333, 'f1-score': 0.6280135295524685, 'support': 70122}}
[[ 4553  2954  2338]
 [ 6844 30748 12813]
 [ 1175  2141  6556]]
training model: results/QRTEA/W3/deepLOB_L2/h20
Epoch 1/50
641/641 - 31s - loss: 3.2157 - accuracy20: 0.4412 - val_loss: 3.1856 - val_accuracy20: 0.4868 - 31s/epoch - 49ms/step
Epoch 2/50
641/641 - 28s - loss: 3.0428 - accuracy20: 0.4622 - val_loss: 3.1159 - val_accuracy20: 0.4726 - 28s/epoch - 43ms/step
Epoch 3/50
641/641 - 28s - loss: 2.9366 - accuracy20: 0.5030 - val_loss: 3.0271 - val_accuracy20: 0.5005 - 28s/epoch - 44ms/step
Epoch 4/50
641/641 - 28s - loss: 2.8792 - accuracy20: 0.5177 - val_loss: 2.8948 - val_accuracy20: 0.5690 - 28s/epoch - 43ms/step
Epoch 5/50
641/641 - 28s - loss: 2.8421 - accuracy20: 0.5311 - val_loss: 2.8234 - val_accuracy20: 0.5442 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 2.8007 - accuracy20: 0.5451 - val_loss: 2.8002 - val_accuracy20: 0.5509 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 28s - loss: 2.7623 - accuracy20: 0.5589 - val_loss: 2.7977 - val_accuracy20: 0.5513 - 28s/epoch - 43ms/step
Epoch 8/50
641/641 - 28s - loss: 2.7331 - accuracy20: 0.5678 - val_loss: 2.7738 - val_accuracy20: 0.5581 - 28s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 2.7107 - accuracy20: 0.5737 - val_loss: 2.7557 - val_accuracy20: 0.5523 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 28s - loss: 2.6853 - accuracy20: 0.5833 - val_loss: 2.7296 - val_accuracy20: 0.5661 - 28s/epoch - 43ms/step
Epoch 11/50
641/641 - 28s - loss: 2.6686 - accuracy20: 0.5857 - val_loss: 2.7284 - val_accuracy20: 0.5510 - 28s/epoch - 43ms/step
Epoch 12/50
641/641 - 28s - loss: 2.6493 - accuracy20: 0.5912 - val_loss: 2.7270 - val_accuracy20: 0.5404 - 28s/epoch - 43ms/step
Epoch 13/50
641/641 - 28s - loss: 2.6345 - accuracy20: 0.5929 - val_loss: 2.7127 - val_accuracy20: 0.5489 - 28s/epoch - 43ms/step
Epoch 14/50
641/641 - 28s - loss: 2.6182 - accuracy20: 0.5979 - val_loss: 2.6962 - val_accuracy20: 0.5603 - 28s/epoch - 44ms/step
Epoch 15/50
641/641 - 28s - loss: 2.6058 - accuracy20: 0.5997 - val_loss: 2.7175 - val_accuracy20: 0.5487 - 28s/epoch - 44ms/step
Epoch 16/50
641/641 - 28s - loss: 2.5906 - accuracy20: 0.6021 - val_loss: 2.7296 - val_accuracy20: 0.5365 - 28s/epoch - 44ms/step
Epoch 17/50
641/641 - 28s - loss: 2.5791 - accuracy20: 0.6058 - val_loss: 2.7239 - val_accuracy20: 0.5487 - 28s/epoch - 43ms/step
Epoch 18/50
641/641 - 27s - loss: 2.5666 - accuracy20: 0.6066 - val_loss: 2.7375 - val_accuracy20: 0.5405 - 27s/epoch - 43ms/step
Epoch 19/50
641/641 - 28s - loss: 2.5536 - accuracy20: 0.6102 - val_loss: 2.7458 - val_accuracy20: 0.5412 - 28s/epoch - 43ms/step
Epoch 20/50
641/641 - 28s - loss: 2.5399 - accuracy20: 0.6112 - val_loss: 2.7615 - val_accuracy20: 0.5194 - 28s/epoch - 43ms/step
Epoch 21/50
641/641 - 28s - loss: 2.5294 - accuracy20: 0.6132 - val_loss: 2.7644 - val_accuracy20: 0.5430 - 28s/epoch - 44ms/step
Epoch 22/50
641/641 - 28s - loss: 2.5203 - accuracy20: 0.6145 - val_loss: 2.7436 - val_accuracy20: 0.5318 - 28s/epoch - 44ms/step
Epoch 23/50
641/641 - 28s - loss: 2.5066 - accuracy20: 0.6168 - val_loss: 2.7803 - val_accuracy20: 0.5190 - 28s/epoch - 44ms/step
Epoch 24/50
641/641 - 28s - loss: 2.4971 - accuracy20: 0.6175 - val_loss: 2.7416 - val_accuracy20: 0.5329 - 28s/epoch - 44ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h20
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91886204
{'0': {'precision': 0.4232991156734658, 'recall': 0.4125915017109196, 'f1-score': 0.4178767273524896, 'support': 46174}, '1': {'precision': 0.8682184967773586, 'recall': 0.5537337802457059, 'f1-score': 0.6761997826063088, 'support': 278056}, '2': {'precision': 0.22848606120004356, 'recall': 0.7453100370756832, 'f1-score': 0.34975074360189823, 'support': 45043}, 'accuracy': 0.5594533041949994, 'macro avg': {'precision': 0.506667891216956, 'recall': 0.5705451063441029, 'f1-score': 0.48127575118689886, 'support': 369273}, 'weighted avg': {'precision': 0.7345526842245855, 'recall': 0.5594533041949994, 'f1-score': 0.6040795549775205, 'support': 369273}}
[[ 19051  14926  12197]
 [ 22927 153969 101160]
 [  3028   8444  33571]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.93034786
{'0': {'precision': 0.48687360049417033, 'recall': 0.35374474053295935, 'f1-score': 0.40976735118273977, 'support': 35650}, '1': {'precision': 0.732323299739705, 'recall': 0.5844403489895708, 'f1-score': 0.6500776130721742, 'support': 93871}, '2': {'precision': 0.36088716051724684, 'recall': 0.6606760432945534, 'f1-score': 0.466793440477651, 'support': 34554}, 'accuracy': 0.5503702575041901, 'macro avg': {'precision': 0.5266946869170407, 'recall': 0.5329537109390278, 'f1-score': 0.5088794682441883, 'support': 164075}, 'weighted avg': {'precision': 0.6007683027395763, 'recall': 0.5503702575041901, 'f1-score': 0.5592638868116867, 'support': 164075}}
[[12611 12039 11000]
 [ 9580 54862 29429]
 [ 3711  8014 22829]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92027915
{'0': {'precision': 0.45528753554067686, 'recall': 0.3812596006144393, 'f1-score': 0.4149981189650127, 'support': 13020}, '1': {'precision': 0.7665213910877879, 'recall': 0.5881255686988172, 'f1-score': 0.6655768512916886, 'support': 43960}, '2': {'precision': 0.33978030600235387, 'recall': 0.6590321107898341, 'f1-score': 0.44838475874922346, 'support': 13142}, 'accuracy': 0.5630044779099284, 'macro avg': {'precision': 0.5205297442102729, 'recall': 0.5428057600343635, 'f1-score': 0.509653243001975, 'support': 70122}, 'weighted avg': {'precision': 0.6287544115461867, 'recall': 0.5630044779099284, 'f1-score': 0.5783449757735004, 'support': 70122}}
[[ 4964  4646  3410]
 [ 4687 25854 13419]
 [ 1252  3229  8661]]
training model: results/QRTEA/W3/deepLOB_L2/h30
Epoch 1/50
641/641 - 30s - loss: 3.2369 - accuracy30: 0.4279 - val_loss: 3.3350 - val_accuracy30: 0.4248 - 30s/epoch - 46ms/step
Epoch 2/50
641/641 - 28s - loss: 3.0762 - accuracy30: 0.4558 - val_loss: 3.0742 - val_accuracy30: 0.4603 - 28s/epoch - 43ms/step
Epoch 3/50
641/641 - 28s - loss: 2.9882 - accuracy30: 0.4862 - val_loss: 3.0456 - val_accuracy30: 0.4437 - 28s/epoch - 43ms/step
Epoch 4/50
641/641 - 27s - loss: 2.9462 - accuracy30: 0.5014 - val_loss: 2.9912 - val_accuracy30: 0.4746 - 27s/epoch - 43ms/step
Epoch 5/50
641/641 - 27s - loss: 2.9149 - accuracy30: 0.5125 - val_loss: 3.0092 - val_accuracy30: 0.4679 - 27s/epoch - 43ms/step
Epoch 6/50
641/641 - 27s - loss: 2.8911 - accuracy30: 0.5237 - val_loss: 2.9923 - val_accuracy30: 0.4917 - 27s/epoch - 42ms/step
Epoch 7/50
641/641 - 27s - loss: 2.8637 - accuracy30: 0.5314 - val_loss: 2.9907 - val_accuracy30: 0.4785 - 27s/epoch - 43ms/step
Epoch 8/50
641/641 - 27s - loss: 2.8382 - accuracy30: 0.5394 - val_loss: 2.9382 - val_accuracy30: 0.5044 - 27s/epoch - 43ms/step
Epoch 9/50
641/641 - 27s - loss: 2.8114 - accuracy30: 0.5472 - val_loss: 2.9106 - val_accuracy30: 0.4982 - 27s/epoch - 43ms/step
Epoch 10/50
641/641 - 27s - loss: 2.7900 - accuracy30: 0.5540 - val_loss: 2.8831 - val_accuracy30: 0.5239 - 27s/epoch - 43ms/step
Epoch 11/50
641/641 - 29s - loss: 2.7686 - accuracy30: 0.5591 - val_loss: 2.8891 - val_accuracy30: 0.5143 - 29s/epoch - 45ms/step
Epoch 12/50
641/641 - 29s - loss: 2.7502 - accuracy30: 0.5630 - val_loss: 2.8927 - val_accuracy30: 0.5160 - 29s/epoch - 45ms/step
Epoch 13/50
641/641 - 29s - loss: 2.7360 - accuracy30: 0.5660 - val_loss: 2.8844 - val_accuracy30: 0.5207 - 29s/epoch - 45ms/step
Epoch 14/50
641/641 - 29s - loss: 2.7158 - accuracy30: 0.5728 - val_loss: 2.9024 - val_accuracy30: 0.5144 - 29s/epoch - 45ms/step
Epoch 15/50
641/641 - 29s - loss: 2.6983 - accuracy30: 0.5771 - val_loss: 2.8960 - val_accuracy30: 0.5223 - 29s/epoch - 45ms/step
Epoch 16/50
641/641 - 29s - loss: 2.6862 - accuracy30: 0.5778 - val_loss: 2.9251 - val_accuracy30: 0.5104 - 29s/epoch - 45ms/step
Epoch 17/50
641/641 - 28s - loss: 2.6706 - accuracy30: 0.5832 - val_loss: 2.9414 - val_accuracy30: 0.5130 - 28s/epoch - 44ms/step
Epoch 18/50
641/641 - 29s - loss: 2.6566 - accuracy30: 0.5851 - val_loss: 2.9943 - val_accuracy30: 0.4881 - 29s/epoch - 45ms/step
Epoch 19/50
641/641 - 28s - loss: 2.6421 - accuracy30: 0.5877 - val_loss: 3.0104 - val_accuracy30: 0.4851 - 28s/epoch - 44ms/step
Epoch 20/50
641/641 - 28s - loss: 2.6296 - accuracy30: 0.5906 - val_loss: 3.0423 - val_accuracy30: 0.4859 - 28s/epoch - 44ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h30
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.920572
{'0': {'precision': 0.43464137214137216, 'recall': 0.3023810815208548, 'f1-score': 0.3566440276785619, 'support': 55311}, '1': {'precision': 0.7848294776403667, 'recall': 0.5943811710765704, 'f1-score': 0.6764562968669974, 'support': 259983}, '2': {'precision': 0.2518932321617948, 'recall': 0.6248355842086737, 'f1-score': 0.35904341670348155, 'support': 53979}, 'accuracy': 0.5550960942175572, 'macro avg': {'precision': 0.49045469398117786, 'recall': 0.5071992789353663, 'f1-score': 0.46404791374968024, 'support': 369273}, 'weighted avg': {'precision': 0.6544743747816614, 'recall': 0.5550960942175572, 'f1-score': 0.5821554238558972, 'support': 369273}}
[[ 16725  24721  13865]
 [ 19149 154529  86305]
 [  2606  17645  33728]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9642212
{'0': {'precision': 0.48089026405541296, 'recall': 0.33532743276043836, 'f1-score': 0.39512913849887327, 'support': 40787}, '1': {'precision': 0.6776872704040888, 'recall': 0.5584431123395193, 'f1-score': 0.6123137069689337, 'support': 83577}, '2': {'precision': 0.38259215433698307, 'recall': 0.643222280980081, 'f1-score': 0.47979788492965414, 'support': 39711}, 'accuracy': 0.5234984001218955, 'macro avg': {'precision': 0.5137232295988282, 'recall': 0.5123309420266796, 'f1-score': 0.495746910132487, 'support': 164075}, 'weighted avg': {'precision': 0.5573442464693987, 'recall': 0.5234984001218955, 'f1-score': 0.5262515841397996, 'support': 164075}}
[[13677 12992 14118]
 [ 9802 46673 27102]
 [ 4962  9206 25543]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96834457
{'0': {'precision': 0.4474860335195531, 'recall': 0.31745822049012484, 'f1-score': 0.3714208431546814, 'support': 15139}, '1': {'precision': 0.6620984509063222, 'recall': 0.5718404613166747, 'f1-score': 0.6136684399088046, 'support': 39539}, '2': {'precision': 0.3661078746086474, 'recall': 0.5981610981610982, 'f1-score': 0.45421245421245426, 'support': 15444}, 'accuracy': 0.5227175494138787, 'macro avg': {'precision': 0.4918974530115076, 'recall': 0.4958199266559659, 'f1-score': 0.47976724575864677, 'support': 70122}, 'weighted avg': {'precision': 0.5505743094505795, 'recall': 0.5227175494138787, 'f1-score': 0.5262490193224678, 'support': 70122}}
[[ 4806  6607  3726]
 [ 4660 22610 12269]
 [ 1274  4932  9238]]
training model: results/QRTEA/W3/deepLOB_L2/h50
Epoch 1/50
641/641 - 31s - loss: 3.2459 - accuracy50: 0.4097 - val_loss: 3.5641 - val_accuracy50: 0.4295 - 31s/epoch - 48ms/step
Epoch 2/50
641/641 - 28s - loss: 3.1385 - accuracy50: 0.4503 - val_loss: 3.1400 - val_accuracy50: 0.4502 - 28s/epoch - 44ms/step
Epoch 3/50
641/641 - 28s - loss: 3.0622 - accuracy50: 0.4757 - val_loss: 3.1529 - val_accuracy50: 0.4525 - 28s/epoch - 44ms/step
Epoch 4/50
641/641 - 28s - loss: 3.0162 - accuracy50: 0.4893 - val_loss: 3.1251 - val_accuracy50: 0.4598 - 28s/epoch - 44ms/step
Epoch 5/50
641/641 - 28s - loss: 2.9854 - accuracy50: 0.4995 - val_loss: 3.1307 - val_accuracy50: 0.4488 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 2.9667 - accuracy50: 0.5053 - val_loss: 3.1442 - val_accuracy50: 0.4483 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 28s - loss: 2.9401 - accuracy50: 0.5126 - val_loss: 3.1375 - val_accuracy50: 0.4412 - 28s/epoch - 43ms/step
Epoch 8/50
641/641 - 28s - loss: 2.9277 - accuracy50: 0.5166 - val_loss: 3.1313 - val_accuracy50: 0.4485 - 28s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 2.9107 - accuracy50: 0.5203 - val_loss: 3.1338 - val_accuracy50: 0.4452 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 28s - loss: 2.8957 - accuracy50: 0.5243 - val_loss: 3.1512 - val_accuracy50: 0.4443 - 28s/epoch - 44ms/step
Epoch 11/50
641/641 - 28s - loss: 2.8825 - accuracy50: 0.5285 - val_loss: 3.1596 - val_accuracy50: 0.4524 - 28s/epoch - 44ms/step
Epoch 12/50
641/641 - 28s - loss: 2.8666 - accuracy50: 0.5328 - val_loss: 3.1772 - val_accuracy50: 0.4422 - 28s/epoch - 43ms/step
Epoch 13/50
641/641 - 27s - loss: 2.8548 - accuracy50: 0.5350 - val_loss: 3.1793 - val_accuracy50: 0.4436 - 27s/epoch - 43ms/step
Epoch 14/50
641/641 - 28s - loss: 2.8384 - accuracy50: 0.5395 - val_loss: 3.1928 - val_accuracy50: 0.4412 - 28s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h50
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0414898
{'0': {'precision': 0.3952711657742671, 'recall': 0.31780853059020775, 'f1-score': 0.3523324223641619, 'support': 70382}, '1': {'precision': 0.689042684252482, 'recall': 0.41308852983216826, 'f1-score': 0.5165185883349948, 'support': 230171}, '2': {'precision': 0.2620525032342267, 'recall': 0.6661670547147847, 'f1-score': 0.3761410600869301, 'support': 68720}, 'accuracy': 0.4420252766923117, 'macro avg': {'precision': 0.44878878442032527, 'recall': 0.46568803837905354, 'f1-score': 0.4149973569286956, 'support': 369273}, 'weighted avg': {'precision': 0.553590072626102, 'recall': 0.4420252766923117, 'f1-score': 0.4591017328525572, 'support': 369273}}
[[ 22368  25424  22590]
 [ 28765  95081 106325]
 [  5456  17485  45779]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.036797
{'0': {'precision': 0.4950052431149622, 'recall': 0.1869242632653912, 'f1-score': 0.2713725964811425, 'support': 47982}, '1': {'precision': 0.4994177621364248, 'recall': 0.5596085538238492, 'f1-score': 0.527802656857852, 'support': 68975}, '2': {'precision': 0.3903273722840333, 'recall': 0.5688484231079418, 'f1-score': 0.46297479833485916, 'support': 47118}, 'accuracy': 0.4532744171872619, 'macro avg': {'precision': 0.4615834591784734, 'recall': 0.4384604133990608, 'f1-score': 0.4207166838912845, 'support': 164075}, 'weighted avg': {'precision': 0.46679949319385106, 'recall': 0.4532744171872619, 'f1-score': 0.43419554916392145, 'support': 164075}}
[[ 8969 21665 17348]
 [ 5859 38599 24517]
 [ 3291 17024 26803]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.046036
{'0': {'precision': 0.4662934730824202, 'recall': 0.21403969165163195, 'f1-score': 0.29340128152283884, 'support': 18291}, '1': {'precision': 0.5185852482190869, 'recall': 0.5661330831845554, 'f1-score': 0.5413170534112609, 'support': 33047}, '2': {'precision': 0.3729190221841007, 'recall': 0.5092099659284497, 'f1-score': 0.4305358629847185, 'support': 18784}, 'accuracy': 0.45904281110065315, 'macro avg': {'precision': 0.45259924782853594, 'recall': 0.42979424692154566, 'f1-score': 0.42175139930627276, 'support': 70122}, 'weighted avg': {'precision': 0.4659246959121654, 'recall': 0.45904281110065315, 'f1-score': 0.4469737479638507, 'support': 70122}}
[[ 3915  9412  4964]
 [ 3218 18709 11120]
 [ 1263  7956  9565]]
training model: results/QRTEA/W3/deepLOB_L2/h100
Epoch 1/50
641/641 - 31s - loss: 3.2829 - accuracy100: 0.3840 - val_loss: 3.3816 - val_accuracy100: 0.3610 - 31s/epoch - 48ms/step
Epoch 2/50
641/641 - 28s - loss: 3.1928 - accuracy100: 0.4224 - val_loss: 3.3181 - val_accuracy100: 0.3866 - 28s/epoch - 44ms/step
Epoch 3/50
641/641 - 28s - loss: 3.1397 - accuracy100: 0.4449 - val_loss: 3.2994 - val_accuracy100: 0.3986 - 28s/epoch - 44ms/step
Epoch 4/50
641/641 - 28s - loss: 3.1077 - accuracy100: 0.4593 - val_loss: 3.2643 - val_accuracy100: 0.4085 - 28s/epoch - 44ms/step
Epoch 5/50
641/641 - 28s - loss: 3.0818 - accuracy100: 0.4686 - val_loss: 3.2578 - val_accuracy100: 0.4091 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 3.0655 - accuracy100: 0.4725 - val_loss: 3.2731 - val_accuracy100: 0.4084 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 28s - loss: 3.0490 - accuracy100: 0.4790 - val_loss: 3.2837 - val_accuracy100: 0.4076 - 28s/epoch - 43ms/step
Epoch 8/50
641/641 - 27s - loss: 3.0319 - accuracy100: 0.4852 - val_loss: 3.2963 - val_accuracy100: 0.4107 - 27s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 3.0180 - accuracy100: 0.4851 - val_loss: 3.3202 - val_accuracy100: 0.4064 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 28s - loss: 2.9999 - accuracy100: 0.4930 - val_loss: 3.3591 - val_accuracy100: 0.4041 - 28s/epoch - 43ms/step
Epoch 11/50
641/641 - 28s - loss: 2.9866 - accuracy100: 0.4949 - val_loss: 3.3938 - val_accuracy100: 0.4019 - 28s/epoch - 43ms/step
Epoch 12/50
641/641 - 27s - loss: 2.9692 - accuracy100: 0.5005 - val_loss: 3.4383 - val_accuracy100: 0.4026 - 27s/epoch - 43ms/step
Epoch 13/50
641/641 - 28s - loss: 2.9493 - accuracy100: 0.5073 - val_loss: 3.4692 - val_accuracy100: 0.4004 - 28s/epoch - 43ms/step
Epoch 14/50
641/641 - 28s - loss: 2.9332 - accuracy100: 0.5107 - val_loss: 3.4866 - val_accuracy100: 0.3987 - 28s/epoch - 43ms/step
Epoch 15/50
641/641 - 28s - loss: 2.9153 - accuracy100: 0.5171 - val_loss: 3.4753 - val_accuracy100: 0.4010 - 28s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h100
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908376
{'0': {'precision': 0.44113523388707143, 'recall': 0.11141992531227196, 'f1-score': 0.17790533304776182, 'support': 93188}, '1': {'precision': 0.552575062113109, 'recall': 0.42447245554824725, 'f1-score': 0.48012586747325925, 'support': 185482}, '2': {'precision': 0.2991281844391746, 'recall': 0.6710484200302418, 'f1-score': 0.4137999094797809, 'support': 90603}, 'accuracy': 0.40597065044018926, 'macro avg': {'precision': 0.4309461601464517, 'recall': 0.4023136002969203, 'f1-score': 0.357277036666934, 'support': 369273}, 'weighted avg': {'precision': 0.4622681559200771, 'recall': 0.40597065044018926, 'f1-score': 0.38758550320583013, 'support': 369273}}
[[10383 37197 45608]
 [ 9903 78732 96847]
 [ 3251 26553 60799]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0684651
{'0': {'precision': 0.47327534329011434, 'recall': 0.15638105567606653, 'f1-score': 0.23508471582494328, 'support': 55320}, '1': {'precision': 0.41737803496154835, 'recall': 0.510873987498613, 'f1-score': 0.4594174337482642, 'support': 54074}, '2': {'precision': 0.41190066449773266, 'recall': 0.5996781331723999, 'f1-score': 0.48836100975500774, 'support': 54681}, 'accuracy': 0.42094773731525215, 'macro avg': {'precision': 0.4341846809164651, 'recall': 0.4223110587823598, 'f1-score': 0.39428771977607174, 'support': 164075}, 'weighted avg': {'precision': 0.4343990985142186, 'recall': 0.42094773731525215, 'f1-score': 0.39342674488101825, 'support': 164075}}
[[ 8651 21357 25312]
 [ 4943 27625 21506]
 [ 4685 17205 32791]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861455
{'0': {'precision': 0.43598936047183995, 'recall': 0.17428690305579955, 'f1-score': 0.24902569522425522, 'support': 21631}, '1': {'precision': 0.40666314119513486, 'recall': 0.5363868867705185, 'f1-score': 0.4626027671947063, 'support': 25806}, '2': {'precision': 0.40102780916280933, 'recall': 0.4850341635441922, 'f1-score': 0.43904872112046606, 'support': 22685}, 'accuracy': 0.4080744987307835, 'macro avg': {'precision': 0.414560103609928, 'recall': 0.3985693177901701, 'f1-score': 0.3835590611798092, 'support': 70122}, 'weighted avg': {'precision': 0.4138865224737793, 'recall': 0.4080744987307835, 'f1-score': 0.38909931351416427, 'support': 70122}}
[[ 3770 10594  7267]
 [ 2797 13842  9167]
 [ 2080  9602 11003]]
training model: results/QRTEA/W3/deepLOB_L2/h200
Epoch 1/50
641/641 - 31s - loss: 3.2886 - accuracy200: 0.3786 - val_loss: 3.3745 - val_accuracy200: 0.3417 - 31s/epoch - 48ms/step
Epoch 2/50
641/641 - 27s - loss: 3.2532 - accuracy200: 0.3900 - val_loss: 3.3360 - val_accuracy200: 0.3630 - 27s/epoch - 43ms/step
Epoch 3/50
641/641 - 29s - loss: 3.2408 - accuracy200: 0.3940 - val_loss: 3.3768 - val_accuracy200: 0.3649 - 29s/epoch - 45ms/step
Epoch 4/50
641/641 - 29s - loss: 3.2209 - accuracy200: 0.4080 - val_loss: 3.4050 - val_accuracy200: 0.3582 - 29s/epoch - 45ms/step
Epoch 5/50
641/641 - 27s - loss: 3.1969 - accuracy200: 0.4161 - val_loss: 3.3567 - val_accuracy200: 0.3425 - 27s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 3.1806 - accuracy200: 0.4265 - val_loss: 3.3840 - val_accuracy200: 0.3522 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 28s - loss: 3.1655 - accuracy200: 0.4349 - val_loss: 3.4317 - val_accuracy200: 0.3452 - 28s/epoch - 43ms/step
Epoch 8/50
641/641 - 28s - loss: 3.1537 - accuracy200: 0.4384 - val_loss: 3.4486 - val_accuracy200: 0.3276 - 28s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 3.1375 - accuracy200: 0.4458 - val_loss: 3.5050 - val_accuracy200: 0.3278 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 27s - loss: 3.1155 - accuracy200: 0.4542 - val_loss: 3.4923 - val_accuracy200: 0.3268 - 27s/epoch - 43ms/step
Epoch 11/50
641/641 - 27s - loss: 3.0960 - accuracy200: 0.4640 - val_loss: 3.5017 - val_accuracy200: 0.3234 - 27s/epoch - 43ms/step
Epoch 12/50
641/641 - 28s - loss: 3.0787 - accuracy200: 0.4708 - val_loss: 3.5841 - val_accuracy200: 0.3242 - 28s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h200
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1342955
{'0': {'precision': 0.32370121799652, 'recall': 0.045571458566629336, 'f1-score': 0.07989508880640511, 'support': 114304}, '1': {'precision': 0.4003886220111189, 'recall': 0.05051619405627741, 'f1-score': 0.08971343222209456, 'support': 146844}, '2': {'precision': 0.29806905042222714, 'recall': 0.922543352601156, 'f1-score': 0.45056337360172916, 'support': 108125}, 'accuracy': 0.3043195684493586, 'macro avg': {'precision': 0.3407196301432887, 'recall': 0.3395436684080209, 'f1-score': 0.20672396487674294, 'support': 369273}, 'weighted avg': {'precision': 0.34669127423174256, 'recall': 0.3043195684493586, 'f1-score': 0.19233296840775133, 'support': 369273}}
[[  5209   5906 103189]
 [  7711   7418 131715]
 [  3172   5203  99750]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1037525
{'0': {'precision': 0.34184315370098556, 'recall': 0.11766297973692283, 'f1-score': 0.1750674523806328, 'support': 55421}, '1': {'precision': 0.38245105856698836, 'recall': 0.43061306753636996, 'f1-score': 0.4051056201466875, 'support': 54578}, '2': {'precision': 0.36362330636280943, 'recall': 0.5618019084251794, 'f1-score': 0.44149276289019357, 'support': 54076}, 'accuracy': 0.3681426177053177, 'macro avg': {'precision': 0.36263917287692776, 'recall': 0.3700259852328241, 'f1-score': 0.3405552784725046, 'support': 164075}, 'weighted avg': {'precision': 0.3625293140978619, 'recall': 0.3681426177053177, 'f1-score': 0.3393961935749082, 'support': 164075}}
[[ 6521 19968 28932]
 [ 6840 23502 24236]
 [ 5715 17981 30380]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119653
{'0': {'precision': 0.3068432671081678, 'recall': 0.06983967478189376, 'f1-score': 0.11378181276975739, 'support': 21893}, '1': {'precision': 0.38169238066010097, 'recall': 0.5480291619932703, 'f1-score': 0.4499810877037183, 'support': 24964}, '2': {'precision': 0.3489213544511196, 'recall': 0.43937244788308616, 'f1-score': 0.38895759213104775, 'support': 23265}, 'accuracy': 0.36268218248196, 'macro avg': {'precision': 0.3458190007397961, 'recall': 0.35241376155275006, 'f1-score': 0.31757349753484115, 'support': 70122}, 'weighted avg': {'precision': 0.3474507793403379, 'recall': 0.36268218248196, 'f1-score': 0.32476899519883556, 'support': 70122}}
[[ 1529 10644  9720]
 [ 1929 13681  9354]
 [ 1525 11518 10222]]
training model: results/QRTEA/W3/deepLOB_L2/h300
Epoch 1/50
641/641 - 30s - loss: 3.3135 - accuracy300: 0.3677 - val_loss: 3.3978 - val_accuracy300: 0.3429 - 30s/epoch - 47ms/step
Epoch 2/50
641/641 - 28s - loss: 3.2783 - accuracy300: 0.3744 - val_loss: 3.3361 - val_accuracy300: 0.3425 - 28s/epoch - 44ms/step
Epoch 3/50
641/641 - 27s - loss: 3.2586 - accuracy300: 0.3845 - val_loss: 3.3507 - val_accuracy300: 0.3443 - 27s/epoch - 43ms/step
Epoch 4/50
641/641 - 27s - loss: 3.2501 - accuracy300: 0.3897 - val_loss: 3.3634 - val_accuracy300: 0.3440 - 27s/epoch - 43ms/step
Epoch 5/50
641/641 - 28s - loss: 3.2322 - accuracy300: 0.4001 - val_loss: 3.4305 - val_accuracy300: 0.3342 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 3.2149 - accuracy300: 0.4106 - val_loss: 3.4516 - val_accuracy300: 0.3359 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 27s - loss: 3.2066 - accuracy300: 0.4153 - val_loss: 3.4408 - val_accuracy300: 0.3401 - 27s/epoch - 43ms/step
Epoch 8/50
641/641 - 28s - loss: 3.1932 - accuracy300: 0.4235 - val_loss: 3.4937 - val_accuracy300: 0.3374 - 28s/epoch - 43ms/step
Epoch 9/50
641/641 - 27s - loss: 3.1765 - accuracy300: 0.4286 - val_loss: 3.4937 - val_accuracy300: 0.3363 - 27s/epoch - 43ms/step
Epoch 10/50
641/641 - 27s - loss: 3.1556 - accuracy300: 0.4387 - val_loss: 3.4727 - val_accuracy300: 0.3373 - 27s/epoch - 43ms/step
Epoch 11/50
641/641 - 27s - loss: 3.1341 - accuracy300: 0.4473 - val_loss: 3.4790 - val_accuracy300: 0.3389 - 27s/epoch - 43ms/step
Epoch 12/50
641/641 - 27s - loss: 3.1143 - accuracy300: 0.4554 - val_loss: 3.5120 - val_accuracy300: 0.3377 - 27s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h300
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.109167
{'0': {'precision': 0.33648351323813885, 'recall': 0.18777605643087877, 'f1-score': 0.24103917534497254, 'support': 121352}, '1': {'precision': 0.40006650357456713, 'recall': 0.12468724554001036, 'f1-score': 0.19012037721580421, 'support': 135090}, '2': {'precision': 0.3120343497180563, 'recall': 0.7175067135804877, 'f1-score': 0.43492532502417536, 'support': 112831}, 'accuracy': 0.3265551502546896, 'macro avg': {'precision': 0.3495281221769207, 'recall': 0.34332333851712554, 'f1-score': 0.28869495919498406, 'support': 369273}, 'weighted avg': {'precision': 0.35227346429173245, 'recall': 0.3265551502546896, 'f1-score': 0.2816534301515378, 'support': 369273}}
[[22787 13600 84965]
 [24719 16844 93527]
 [20215 11659 80957]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1022542
{'0': {'precision': 0.3668556404568236, 'recall': 0.2348599081249781, 'f1-score': 0.2863801083947107, 'support': 57034}, '1': {'precision': 0.33830967839347725, 'recall': 0.34610260469965826, 'f1-score': 0.34216177523264135, 'support': 51791}, '2': {'precision': 0.35444769234895007, 'recall': 0.47844343891402713, 'f1-score': 0.4072157007733308, 'support': 55250}, 'accuracy': 0.35199756209050737, 'macro avg': {'precision': 0.353204337066417, 'recall': 0.3531353172462211, 'f1-score': 0.34525252813356094, 'support': 164075}, 'weighted avg': {'precision': 0.3536667752781993, 'recall': 0.35199756209050737, 'f1-score': 0.3446775625231399, 'support': 164075}}
[[13395 17963 25676]
 [11398 17925 22468]
 [11720 17096 26434]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1116202
{'0': {'precision': 0.31995687589841876, 'recall': 0.23431879989472762, 'f1-score': 0.27052210462348714, 'support': 22798}, '1': {'precision': 0.347932792146498, 'recall': 0.322104251321711, 'f1-score': 0.33452070334656836, 'support': 22887}, '2': {'precision': 0.34760220857373286, 'recall': 0.45856692720055653, 'f1-score': 0.39544772827525365, 'support': 24437}, 'accuracy': 0.3411197626992955, 'macro avg': {'precision': 0.33849729220621655, 'recall': 0.33832999280566506, 'f1-score': 0.33349684541510305, 'support': 70122}, 'weighted avg': {'precision': 0.3387220821069758, 'recall': 0.3411197626992955, 'f1-score': 0.3349461569059859, 'support': 70122}}
[[ 5342  6380 11076]
 [ 5559  7372  9956]
 [ 5795  7436 11206]]
training model: results/QRTEA/W3/deepLOB_L2/h500
Epoch 1/50
641/641 - 30s - loss: 3.2472 - accuracy500: 0.4123 - val_loss: 3.3869 - val_accuracy500: 0.3354 - 30s/epoch - 46ms/step
Epoch 2/50
641/641 - 29s - loss: 3.2091 - accuracy500: 0.4281 - val_loss: 3.3971 - val_accuracy500: 0.3369 - 29s/epoch - 45ms/step
Epoch 3/50
641/641 - 28s - loss: 3.1964 - accuracy500: 0.4333 - val_loss: 3.5271 - val_accuracy500: 0.3340 - 28s/epoch - 44ms/step
Epoch 4/50
641/641 - 28s - loss: 3.2122 - accuracy500: 0.4304 - val_loss: 3.5055 - val_accuracy500: 0.3393 - 28s/epoch - 43ms/step
Epoch 5/50
641/641 - 28s - loss: 3.2049 - accuracy500: 0.4222 - val_loss: 3.4804 - val_accuracy500: 0.3409 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 3.1819 - accuracy500: 0.4370 - val_loss: 3.6605 - val_accuracy500: 0.3395 - 28s/epoch - 43ms/step
Epoch 7/50
641/641 - 28s - loss: 3.1794 - accuracy500: 0.4371 - val_loss: 3.5933 - val_accuracy500: 0.3349 - 28s/epoch - 43ms/step
Epoch 8/50
641/641 - 27s - loss: 3.1672 - accuracy500: 0.4420 - val_loss: 3.7910 - val_accuracy500: 0.3370 - 27s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 3.1601 - accuracy500: 0.4434 - val_loss: 3.8186 - val_accuracy500: 0.3274 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 28s - loss: 3.1433 - accuracy500: 0.4505 - val_loss: 3.9275 - val_accuracy500: 0.3092 - 28s/epoch - 43ms/step
Epoch 11/50
641/641 - 28s - loss: 3.1123 - accuracy500: 0.4646 - val_loss: 3.8943 - val_accuracy500: 0.3010 - 28s/epoch - 44ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h500
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1295921
{'0': {'precision': 0.3927860586492105, 'recall': 0.12641821003032158, 'f1-score': 0.19127466184199193, 'support': 140494}, '1': {'precision': 0.2724713971101681, 'recall': 0.2554616601029381, 'f1-score': 0.26369250603010896, 'support': 99283}, '2': {'precision': 0.35083344157249857, 'recall': 0.6257490578859579, 'f1-score': 0.44959580099093954, 'support': 129496}, 'accuracy': 0.33621737847067074, 'macro avg': {'precision': 0.3386969657772924, 'recall': 0.33587630933973917, 'f1-score': 0.3015209896210135, 'support': 369273}, 'weighted avg': {'precision': 0.3457263043683759, 'recall': 0.33621737847067074, 'f1-score': 0.301332573088579, 'support': 369273}}
[[17761 34893 87840]
 [11822 25363 62098]
 [15635 32829 81032]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1187688
{'0': {'precision': 0.34566820088794753, 'recall': 0.3099751625392651, 'f1-score': 0.32685012228234706, 'support': 54756}, '1': {'precision': 0.3566959400690216, 'recall': 0.2282118943759312, 'f1-score': 0.2783421640320533, 'support': 55707}, '2': {'precision': 0.3498588211566581, 'recall': 0.5177012609117362, 'f1-score': 0.4175442291491155, 'support': 53612}, 'accuracy': 0.35008989791253997, 'macro avg': {'precision': 0.3507409873712091, 'recall': 0.3519627726089775, 'f1-score': 0.340912171821172, 'support': 164075}, 'weighted avg': {'precision': 0.35078165388448085, 'recall': 0.35008989791253997, 'f1-score': 0.340015196956076, 'support': 164075}}
[[16973 11580 26203]
 [17620 12713 25374]
 [14509 11348 27755]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1265942
{'0': {'precision': 0.31804459691252146, 'recall': 0.38473668921442505, 'f1-score': 0.3482261911469191, 'support': 24097}, '1': {'precision': 0.27837233206360723, 'recall': 0.2293971101145989, 'f1-score': 0.2515228495725095, 'support': 20070}, '2': {'precision': 0.3898825359145418, 'recall': 0.3670198420342901, 'f1-score': 0.3781058982297372, 'support': 25955}, 'accuracy': 0.33371837654373804, 'macro avg': {'precision': 0.3287664882968902, 'recall': 0.3270512137877713, 'f1-score': 0.32595164631638857, 'support': 70122}, 'weighted avg': {'precision': 0.33327992036706827, 'recall': 0.33371837654373804, 'f1-score': 0.331607893493346, 'support': 70122}}
[[ 9271  5902  8924]
 [ 9483  4604  5983]
 [10396  6033  9526]]
training model: results/QRTEA/W3/deepLOB_L2/h1000
Epoch 1/50
641/641 - 31s - loss: 3.2400 - accuracy1000: 0.4178 - val_loss: 3.3963 - val_accuracy1000: 0.3363 - 31s/epoch - 48ms/step
Epoch 2/50
641/641 - 28s - loss: 3.2294 - accuracy1000: 0.4153 - val_loss: 3.4639 - val_accuracy1000: 0.2936 - 28s/epoch - 44ms/step
Epoch 3/50
641/641 - 28s - loss: 3.2158 - accuracy1000: 0.4187 - val_loss: 3.5787 - val_accuracy1000: 0.2945 - 28s/epoch - 43ms/step
Epoch 4/50
641/641 - 28s - loss: 3.1966 - accuracy1000: 0.4301 - val_loss: 3.5865 - val_accuracy1000: 0.2931 - 28s/epoch - 43ms/step
Epoch 5/50
641/641 - 28s - loss: 3.1812 - accuracy1000: 0.4339 - val_loss: 3.5919 - val_accuracy1000: 0.2941 - 28s/epoch - 43ms/step
Epoch 6/50
641/641 - 28s - loss: 3.1604 - accuracy1000: 0.4469 - val_loss: 3.6643 - val_accuracy1000: 0.2925 - 28s/epoch - 44ms/step
Epoch 7/50
641/641 - 28s - loss: 3.1392 - accuracy1000: 0.4544 - val_loss: 3.7095 - val_accuracy1000: 0.2922 - 28s/epoch - 44ms/step
Epoch 8/50
641/641 - 28s - loss: 3.1251 - accuracy1000: 0.4603 - val_loss: 3.8127 - val_accuracy1000: 0.2930 - 28s/epoch - 43ms/step
Epoch 9/50
641/641 - 28s - loss: 3.0959 - accuracy1000: 0.4703 - val_loss: 3.7580 - val_accuracy1000: 0.2925 - 28s/epoch - 43ms/step
Epoch 10/50
641/641 - 28s - loss: 3.0625 - accuracy1000: 0.4833 - val_loss: 3.7144 - val_accuracy1000: 0.2961 - 28s/epoch - 43ms/step
Epoch 11/50
641/641 - 28s - loss: 3.0438 - accuracy1000: 0.4900 - val_loss: 3.7440 - val_accuracy1000: 0.2945 - 28s/epoch - 43ms/step
testing model: results/QRTEA/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1154937
{'0': {'precision': 0.4063325443381016, 'recall': 0.08224038214526241, 'f1-score': 0.1367940870770297, 'support': 144029}, '1': {'precision': 0.2071909571909572, 'recall': 0.019172564205278853, 'f1-score': 0.035097368206632444, 'support': 89868}, '2': {'precision': 0.36553889923630073, 'recall': 0.8959342867273372, 'f1-score': 0.519232333437504, 'support': 135376}, 'accuracy': 0.3651932310242016, 'macro avg': {'precision': 0.32635413358845317, 'recall': 0.33244907769262616, 'f1-score': 0.2303745962403887, 'support': 369273}, 'weighted avg': {'precision': 0.34291351112137314, 'recall': 0.3651932310242016, 'f1-score': 0.2522470969311233, 'support': 369273}}
[[ 11845   3316 128868]
 [  6495   1723  81650]
 [ 10811   3277 121288]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.12052
{'0': {'precision': 0.34371181608363127, 'recall': 0.2716963583029262, 'f1-score': 0.3034904397514535, 'support': 55908}, '1': {'precision': 0.37578752987182273, 'recall': 0.12755092635265924, 'f1-score': 0.19045652862077983, 'support': 54245}, '2': {'precision': 0.35012663966334545, 'recall': 0.6588590927636215, 'f1-score': 0.4572594294392853, 'support': 53922}, 'accuracy': 0.3512783787901874, 'macro avg': {'precision': 0.35654199520626645, 'recall': 0.3527021258064023, 'f1-score': 0.3170687992705062, 'support': 164075}, 'weighted avg': {'precision': 0.3564245828762919, 'recall': 0.3512783787901874, 'f1-score': 0.31665519338646114, 'support': 164075}}
[[15190  6078 34640]
 [16024  6919 31302]
 [12980  5415 35527]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1308079
{'0': {'precision': 0.23474341192787795, 'recall': 0.25203592535715946, 'f1-score': 0.24308251610152376, 'support': 21489}, '1': {'precision': 0.44361998985286655, 'recall': 0.27610025656206827, 'f1-score': 0.34036445028343426, 'support': 25335}, '2': {'precision': 0.3542292692283102, 'recall': 0.4756202249120096, 'f1-score': 0.4060461707585196, 'support': 23298}, 'accuracy': 0.3350161147713984, 'macro avg': {'precision': 0.34419755700301824, 'recall': 0.33458546894374575, 'f1-score': 0.32983104571449257, 'support': 70122}, 'weighted avg': {'precision': 0.3499094027027426, 'recall': 0.3350161147713984, 'f1-score': 0.3323749639595055, 'support': 70122}}
[[ 5416  4111 11962]
 [10101  6995  8239]
 [ 7555  4662 11081]]
training model: results/QRTEA/W3/deepOF_L2/h10
Epoch 1/50
641/641 - 17s - loss: 3.0531 - accuracy10: 0.4893 - val_loss: 2.6615 - val_accuracy10: 0.6485 - 17s/epoch - 27ms/step
Epoch 2/50
641/641 - 15s - loss: 2.8359 - accuracy10: 0.5543 - val_loss: 2.5664 - val_accuracy10: 0.6706 - 15s/epoch - 24ms/step
Epoch 3/50
641/641 - 15s - loss: 2.7228 - accuracy10: 0.5880 - val_loss: 2.4803 - val_accuracy10: 0.6827 - 15s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 2.6537 - accuracy10: 0.5984 - val_loss: 2.4291 - val_accuracy10: 0.6795 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 15s - loss: 2.6113 - accuracy10: 0.6024 - val_loss: 2.3985 - val_accuracy10: 0.6840 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 2.5791 - accuracy10: 0.6094 - val_loss: 2.3937 - val_accuracy10: 0.6915 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 16s - loss: 2.5576 - accuracy10: 0.6117 - val_loss: 2.3708 - val_accuracy10: 0.6940 - 16s/epoch - 25ms/step
Epoch 8/50
641/641 - 16s - loss: 2.5389 - accuracy10: 0.6131 - val_loss: 2.3766 - val_accuracy10: 0.6917 - 16s/epoch - 24ms/step
Epoch 9/50
641/641 - 16s - loss: 2.5198 - accuracy10: 0.6157 - val_loss: 2.3750 - val_accuracy10: 0.6946 - 16s/epoch - 24ms/step
Epoch 10/50
641/641 - 16s - loss: 2.5044 - accuracy10: 0.6184 - val_loss: 2.3640 - val_accuracy10: 0.6939 - 16s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 2.4905 - accuracy10: 0.6207 - val_loss: 2.3619 - val_accuracy10: 0.7009 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 2.4799 - accuracy10: 0.6212 - val_loss: 2.3520 - val_accuracy10: 0.6960 - 15s/epoch - 24ms/step
Epoch 13/50
641/641 - 15s - loss: 2.4679 - accuracy10: 0.6219 - val_loss: 2.3769 - val_accuracy10: 0.6868 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 15s - loss: 2.4567 - accuracy10: 0.6246 - val_loss: 2.3606 - val_accuracy10: 0.6904 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 2.4454 - accuracy10: 0.6265 - val_loss: 2.3626 - val_accuracy10: 0.6903 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 2.4333 - accuracy10: 0.6274 - val_loss: 2.3472 - val_accuracy10: 0.6917 - 15s/epoch - 23ms/step
Epoch 17/50
641/641 - 15s - loss: 2.4245 - accuracy10: 0.6290 - val_loss: 2.3575 - val_accuracy10: 0.6898 - 15s/epoch - 24ms/step
Epoch 18/50
641/641 - 15s - loss: 2.4135 - accuracy10: 0.6295 - val_loss: 2.3595 - val_accuracy10: 0.6840 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 15s - loss: 2.4058 - accuracy10: 0.6307 - val_loss: 2.3599 - val_accuracy10: 0.6812 - 15s/epoch - 23ms/step
Epoch 20/50
641/641 - 15s - loss: 2.3923 - accuracy10: 0.6322 - val_loss: 2.3518 - val_accuracy10: 0.6843 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 15s - loss: 2.3845 - accuracy10: 0.6335 - val_loss: 2.3835 - val_accuracy10: 0.6827 - 15s/epoch - 24ms/step
Epoch 22/50
641/641 - 15s - loss: 2.3742 - accuracy10: 0.6323 - val_loss: 2.3732 - val_accuracy10: 0.6823 - 15s/epoch - 24ms/step
Epoch 23/50
641/641 - 15s - loss: 2.3637 - accuracy10: 0.6351 - val_loss: 2.3762 - val_accuracy10: 0.6774 - 15s/epoch - 24ms/step
Epoch 24/50
641/641 - 15s - loss: 2.3518 - accuracy10: 0.6345 - val_loss: 2.3877 - val_accuracy10: 0.6735 - 15s/epoch - 24ms/step
Epoch 25/50
641/641 - 15s - loss: 2.3400 - accuracy10: 0.6368 - val_loss: 2.4039 - val_accuracy10: 0.6856 - 15s/epoch - 24ms/step
Epoch 26/50
641/641 - 15s - loss: 2.3288 - accuracy10: 0.6374 - val_loss: 2.4108 - val_accuracy10: 0.6784 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h10
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60299534
{'0': {'precision': 0.3922578714490306, 'recall': 0.5370500438981562, 'f1-score': 0.4533741800797994, 'support': 34170}, '1': {'precision': 0.915973310677194, 'recall': 0.8282876784910059, 'f1-score': 0.8699264751914637, 'support': 301976}, '2': {'precision': 0.3292120280059897, 'recall': 0.49116927814509553, 'f1-score': 0.39420409251160027, 'support': 33123}, 'accuracy': 0.7710991174455478, 'macro avg': {'precision': 0.5458144033774048, 'recall': 0.6188356668447526, 'f1-score': 0.5725015825942879, 'support': 369269}, 'weighted avg': {'precision': 0.8148799328839197, 'recall': 0.7710991174455478, 'f1-score': 0.788709410110261, 'support': 369269}}
[[ 18351  11267   4552]
 [ 23256 250123  28597]
 [  5176  11678  16269]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7751831
{'0': {'precision': 0.4246564023466549, 'recall': 0.5548238511641297, 'f1-score': 0.4810908637044433, 'support': 27789}, '1': {'precision': 0.8387372458285131, 'recall': 0.735168910894707, 'f1-score': 0.7835455054402064, 'support': 109466}, '2': {'precision': 0.4259224338424791, 'recall': 0.50531339721839, 'f1-score': 0.4622337431996862, 'support': 26819}, 'accuracy': 0.6670526713556079, 'macro avg': {'precision': 0.563105360672549, 'recall': 0.5984353864257422, 'f1-score': 0.5756233707814453, 'support': 164074}, 'weighted avg': {'precision': 0.7011275514090999, 'recall': 0.6670526713556079, 'f1-score': 0.6797985852046807, 'support': 164074}}
[[15418  8134  4237]
 [14961 80476 14029]
 [ 5928  7339 13552]]
Evaluating performance on  val set...
274/274 - 3s - 3s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7291421
{'0': {'precision': 0.4016083634901488, 'recall': 0.5083986562150056, 'f1-score': 0.4487375325725581, 'support': 9823}, '1': {'precision': 0.8535183129855716, 'recall': 0.7621303417109332, 'f1-score': 0.8052396808443802, 'support': 50452}, '2': {'precision': 0.3952678642082773, 'recall': 0.50726109474967, 'f1-score': 0.4443159580145882, 'support': 9847}, 'accuracy': 0.6907960411853626, 'macro avg': {'precision': 0.5501315135613325, 'recall': 0.5925966975585363, 'f1-score': 0.5660977238105088, 'support': 70122}, 'weighted avg': {'precision': 0.7258621764948332, 'recall': 0.6907960411853626, 'f1-score': 0.7046159607397189, 'support': 70122}}
[[ 4994  3420  1409]
 [ 5768 38451  6233]
 [ 1673  3179  4995]]
training model: results/QRTEA/W3/deepOF_L2/h20
Epoch 1/50
641/641 - 18s - loss: 3.0820 - accuracy20: 0.4776 - val_loss: 2.7621 - val_accuracy20: 0.6013 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 15s - loss: 2.8775 - accuracy20: 0.5387 - val_loss: 2.6866 - val_accuracy20: 0.6311 - 15s/epoch - 24ms/step
Epoch 3/50
641/641 - 15s - loss: 2.7728 - accuracy20: 0.5688 - val_loss: 2.6034 - val_accuracy20: 0.6403 - 15s/epoch - 24ms/step
Epoch 4/50
641/641 - 16s - loss: 2.7079 - accuracy20: 0.5828 - val_loss: 2.5653 - val_accuracy20: 0.6478 - 16s/epoch - 25ms/step
Epoch 5/50
641/641 - 16s - loss: 2.6661 - accuracy20: 0.5913 - val_loss: 2.5187 - val_accuracy20: 0.6436 - 16s/epoch - 25ms/step
Epoch 6/50
641/641 - 16s - loss: 2.6373 - accuracy20: 0.5975 - val_loss: 2.5031 - val_accuracy20: 0.6481 - 16s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 2.6176 - accuracy20: 0.6012 - val_loss: 2.4876 - val_accuracy20: 0.6496 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 16s - loss: 2.6012 - accuracy20: 0.6035 - val_loss: 2.4806 - val_accuracy20: 0.6480 - 16s/epoch - 24ms/step
Epoch 9/50
641/641 - 16s - loss: 2.5839 - accuracy20: 0.6060 - val_loss: 2.4677 - val_accuracy20: 0.6573 - 16s/epoch - 25ms/step
Epoch 10/50
641/641 - 16s - loss: 2.5701 - accuracy20: 0.6085 - val_loss: 2.4750 - val_accuracy20: 0.6450 - 16s/epoch - 25ms/step
Epoch 11/50
641/641 - 16s - loss: 2.5565 - accuracy20: 0.6101 - val_loss: 2.4696 - val_accuracy20: 0.6572 - 16s/epoch - 24ms/step
Epoch 12/50
641/641 - 16s - loss: 2.5462 - accuracy20: 0.6121 - val_loss: 2.4721 - val_accuracy20: 0.6556 - 16s/epoch - 24ms/step
Epoch 13/50
641/641 - 15s - loss: 2.5357 - accuracy20: 0.6135 - val_loss: 2.4775 - val_accuracy20: 0.6458 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 15s - loss: 2.5249 - accuracy20: 0.6148 - val_loss: 2.4844 - val_accuracy20: 0.6475 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 2.5171 - accuracy20: 0.6149 - val_loss: 2.4770 - val_accuracy20: 0.6467 - 15s/epoch - 23ms/step
Epoch 16/50
641/641 - 15s - loss: 2.5070 - accuracy20: 0.6180 - val_loss: 2.4792 - val_accuracy20: 0.6442 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 16s - loss: 2.4959 - accuracy20: 0.6200 - val_loss: 2.4951 - val_accuracy20: 0.6413 - 16s/epoch - 24ms/step
Epoch 18/50
641/641 - 16s - loss: 2.4869 - accuracy20: 0.6217 - val_loss: 2.4848 - val_accuracy20: 0.6399 - 16s/epoch - 25ms/step
Epoch 19/50
641/641 - 16s - loss: 2.4740 - accuracy20: 0.6228 - val_loss: 2.5138 - val_accuracy20: 0.6305 - 16s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h20
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6745094
{'0': {'precision': 0.477423226110623, 'recall': 0.48248976674680005, 'f1-score': 0.47994312551165497, 'support': 46173}, '1': {'precision': 0.8625514096957291, 'recall': 0.8334508156630319, 'f1-score': 0.847751453639907, 'support': 278056}, '2': {'precision': 0.3855667426897332, 'recall': 0.4616785079928952, 'f1-score': 0.42020389811156805, 'support': 45040}, 'accuracy': 0.7442216920456362, 'macro avg': {'precision': 0.575180459498695, 'recall': 0.592539696800909, 'f1-score': 0.5826328257543767, 'support': 369269}, 'weighted avg': {'precision': 0.7562172386100838, 'recall': 0.7442216920456362, 'f1-score': 0.7496128180228848, 'support': 369269}}
[[ 22278  18122   5773]
 [ 18946 231746  27364]
 [  5439  18807  20794]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8362778
{'0': {'precision': 0.4818239884473326, 'recall': 0.4858719090425383, 'f1-score': 0.48383948241724534, 'support': 35709}, '1': {'precision': 0.7573045596323197, 'recall': 0.7324407585464391, 'f1-score': 0.7446651710721678, 'support': 93811}, '2': {'precision': 0.46475062945304546, 'recall': 0.5021415755050067, 'f1-score': 0.48272312486089475, 'support': 34554}, 'accuracy': 0.6302765825176445, 'macro avg': {'precision': 0.5679597258442326, 'recall': 0.5734847476979947, 'f1-score': 0.5704092594501026, 'support': 164074}, 'weighted avg': {'precision': 0.6357371923476838, 'recall': 0.6302765825176445, 'f1-score': 0.6327341522577125, 'support': 164074}}
[[17350 11737  6622]
 [11739 68711 13361]
 [ 6920 10283 17351]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79120445
{'0': {'precision': 0.4754007739082366, 'recall': 0.46382618075352494, 'f1-score': 0.46954215739801886, 'support': 12979}, '1': {'precision': 0.7732474964234621, 'recall': 0.7613713818330531, 'f1-score': 0.7672634856671857, 'support': 44014}, '2': {'precision': 0.4587493803554989, 'recall': 0.49341153172366514, 'f1-score': 0.47544954128440364, 'support': 13129}, 'accuracy': 0.656127891389293, 'macro avg': {'precision': 0.569132550229066, 'recall': 0.5728696981034144, 'f1-score': 0.5707517281165361, 'support': 70122}, 'weighted avg': {'precision': 0.6592347988765953, 'recall': 0.656127891389293, 'f1-score': 0.6575211737621195, 'support': 70122}}
[[ 6020  5142  1817]
 [ 4677 33511  5826]
 [ 1966  4685  6478]]
training model: results/QRTEA/W3/deepOF_L2/h30
Epoch 1/50
641/641 - 18s - loss: 3.1138 - accuracy30: 0.4588 - val_loss: 2.8530 - val_accuracy30: 0.5711 - 18s/epoch - 29ms/step
Epoch 2/50
641/641 - 16s - loss: 2.9298 - accuracy30: 0.5186 - val_loss: 2.7902 - val_accuracy30: 0.5964 - 16s/epoch - 25ms/step
Epoch 3/50
641/641 - 16s - loss: 2.8372 - accuracy30: 0.5473 - val_loss: 2.7299 - val_accuracy30: 0.6118 - 16s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 2.7758 - accuracy30: 0.5622 - val_loss: 2.6876 - val_accuracy30: 0.6126 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 15s - loss: 2.7365 - accuracy30: 0.5687 - val_loss: 2.6534 - val_accuracy30: 0.6159 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 2.7078 - accuracy30: 0.5768 - val_loss: 2.6347 - val_accuracy30: 0.6182 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 2.6880 - accuracy30: 0.5818 - val_loss: 2.6143 - val_accuracy30: 0.6187 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 15s - loss: 2.6712 - accuracy30: 0.5864 - val_loss: 2.6134 - val_accuracy30: 0.6180 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 2.6564 - accuracy30: 0.5902 - val_loss: 2.6056 - val_accuracy30: 0.6226 - 15s/epoch - 23ms/step
Epoch 10/50
641/641 - 15s - loss: 2.6433 - accuracy30: 0.5931 - val_loss: 2.6026 - val_accuracy30: 0.6174 - 15s/epoch - 23ms/step
Epoch 11/50
641/641 - 15s - loss: 2.6326 - accuracy30: 0.5932 - val_loss: 2.6155 - val_accuracy30: 0.6221 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 2.6210 - accuracy30: 0.5965 - val_loss: 2.6052 - val_accuracy30: 0.6230 - 15s/epoch - 23ms/step
Epoch 13/50
641/641 - 15s - loss: 2.6106 - accuracy30: 0.5986 - val_loss: 2.6001 - val_accuracy30: 0.6222 - 15s/epoch - 23ms/step
Epoch 14/50
641/641 - 15s - loss: 2.6002 - accuracy30: 0.5993 - val_loss: 2.6016 - val_accuracy30: 0.6266 - 15s/epoch - 23ms/step
Epoch 15/50
641/641 - 15s - loss: 2.5909 - accuracy30: 0.6026 - val_loss: 2.6004 - val_accuracy30: 0.6215 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 2.5805 - accuracy30: 0.6047 - val_loss: 2.6041 - val_accuracy30: 0.6209 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 15s - loss: 2.5709 - accuracy30: 0.6063 - val_loss: 2.6191 - val_accuracy30: 0.6113 - 15s/epoch - 24ms/step
Epoch 18/50
641/641 - 15s - loss: 2.5613 - accuracy30: 0.6090 - val_loss: 2.6211 - val_accuracy30: 0.6132 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 15s - loss: 2.5528 - accuracy30: 0.6100 - val_loss: 2.6169 - val_accuracy30: 0.6148 - 15s/epoch - 24ms/step
Epoch 20/50
641/641 - 15s - loss: 2.5409 - accuracy30: 0.6121 - val_loss: 2.6272 - val_accuracy30: 0.6084 - 15s/epoch - 23ms/step
Epoch 21/50
641/641 - 15s - loss: 2.5306 - accuracy30: 0.6147 - val_loss: 2.6381 - val_accuracy30: 0.6142 - 15s/epoch - 24ms/step
Epoch 22/50
641/641 - 15s - loss: 2.5214 - accuracy30: 0.6154 - val_loss: 2.6369 - val_accuracy30: 0.6067 - 15s/epoch - 24ms/step
Epoch 23/50
641/641 - 15s - loss: 2.5080 - accuracy30: 0.6178 - val_loss: 2.6542 - val_accuracy30: 0.5916 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h30
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7255278
{'0': {'precision': 0.5197543588422228, 'recall': 0.4376423793165793, 'f1-score': 0.47517716574075897, 'support': 55310}, '1': {'precision': 0.8160537040373873, 'recall': 0.8187343018581984, 'f1-score': 0.8173918052302139, 'support': 259983}, '2': {'precision': 0.4009860976398319, 'recall': 0.45955609900696603, 'f1-score': 0.4282779101488311, 'support': 53976}, 'accuracy': 0.7091524065112425, 'macro avg': {'precision': 0.5789313868398139, 'recall': 0.5719775933939145, 'f1-score': 0.5736156270399347, 'support': 369269}, 'weighted avg': {'precision': 0.7110028985117163, 'recall': 0.7091524065112425, 'f1-score': 0.7092573468514318, 'support': 369269}}
[[ 24206  24521   6583]
 [ 16654 212857  30472]
 [  5712  23459  24805]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8709794
{'0': {'precision': 0.5120400693507995, 'recall': 0.45586181550900406, 'f1-score': 0.48232061385317293, 'support': 40815}, '1': {'precision': 0.6883078730904818, 'recall': 0.7296093132440654, 'f1-score': 0.7083570739194642, 'support': 83494}, '2': {'precision': 0.4946091300690745, 'recall': 0.48799195272224316, 'f1-score': 0.4912782602091192, 'support': 39765}, 'accuracy': 0.6029535453514877, 'macro avg': {'precision': 0.5649856908367853, 'recall': 0.5578210271584375, 'f1-score': 0.5606519826605855, 'support': 164074}, 'weighted avg': {'precision': 0.5975146887597446, 'recall': 0.6029535453514877, 'f1-score': 0.5995170557276877, 'support': 164074}}
[[18606 14813  7396]
 [10144 60918 12432]
 [ 7587 12773 19405]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.842504
{'0': {'precision': 0.5078786918995961, 'recall': 0.4235900145291243, 'f1-score': 0.4619207086529113, 'support': 15142}, '1': {'precision': 0.703827388565203, 'recall': 0.7508654016221543, 'f1-score': 0.7265858995831245, 'support': 39577}, '2': {'precision': 0.48687053892999804, 'recall': 0.48269817568006235, 'f1-score': 0.4847753798004825, 'support': 15403}, 'accuracy': 0.6212886112774878, 'macro avg': {'precision': 0.5661922064649324, 'recall': 0.552384530610447, 'f1-score': 0.5577606626788395, 'support': 70122}, 'weighted avg': {'precision': 0.6138578851305936, 'recall': 0.6212886112774878, 'f1-score': 0.6163185404479412, 'support': 70122}}
[[ 6414  6667  2061]
 [ 4085 29717  5775]
 [ 2130  5838  7435]]
training model: results/QRTEA/W3/deepOF_L2/h50
Epoch 1/50
641/641 - 18s - loss: 3.1679 - accuracy50: 0.4367 - val_loss: 3.0184 - val_accuracy50: 0.5063 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 16s - loss: 3.0227 - accuracy50: 0.4876 - val_loss: 2.9725 - val_accuracy50: 0.5307 - 16s/epoch - 25ms/step
Epoch 3/50
641/641 - 16s - loss: 2.9435 - accuracy50: 0.5109 - val_loss: 2.9512 - val_accuracy50: 0.5408 - 16s/epoch - 25ms/step
Epoch 4/50
641/641 - 16s - loss: 2.8998 - accuracy50: 0.5235 - val_loss: 2.9247 - val_accuracy50: 0.5480 - 16s/epoch - 24ms/step
Epoch 5/50
641/641 - 16s - loss: 2.8680 - accuracy50: 0.5309 - val_loss: 2.8858 - val_accuracy50: 0.5514 - 16s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 2.8411 - accuracy50: 0.5385 - val_loss: 2.8483 - val_accuracy50: 0.5543 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 2.8199 - accuracy50: 0.5434 - val_loss: 2.8320 - val_accuracy50: 0.5589 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 16s - loss: 2.8029 - accuracy50: 0.5483 - val_loss: 2.8271 - val_accuracy50: 0.5613 - 16s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 2.7859 - accuracy50: 0.5548 - val_loss: 2.8212 - val_accuracy50: 0.5615 - 15s/epoch - 24ms/step
Epoch 10/50
641/641 - 15s - loss: 2.7779 - accuracy50: 0.5558 - val_loss: 2.8173 - val_accuracy50: 0.5618 - 15s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 2.7629 - accuracy50: 0.5593 - val_loss: 2.8205 - val_accuracy50: 0.5639 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 2.7503 - accuracy50: 0.5626 - val_loss: 2.8265 - val_accuracy50: 0.5626 - 15s/epoch - 23ms/step
Epoch 13/50
641/641 - 15s - loss: 2.7413 - accuracy50: 0.5650 - val_loss: 2.8204 - val_accuracy50: 0.5623 - 15s/epoch - 23ms/step
Epoch 14/50
641/641 - 15s - loss: 2.7296 - accuracy50: 0.5685 - val_loss: 2.8291 - val_accuracy50: 0.5611 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 2.7207 - accuracy50: 0.5702 - val_loss: 2.8291 - val_accuracy50: 0.5658 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 16s - loss: 2.7091 - accuracy50: 0.5734 - val_loss: 2.8303 - val_accuracy50: 0.5575 - 16s/epoch - 25ms/step
Epoch 17/50
641/641 - 16s - loss: 2.6974 - accuracy50: 0.5761 - val_loss: 2.8388 - val_accuracy50: 0.5573 - 16s/epoch - 24ms/step
Epoch 18/50
641/641 - 15s - loss: 2.6861 - accuracy50: 0.5783 - val_loss: 2.8357 - val_accuracy50: 0.5590 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 16s - loss: 2.6734 - accuracy50: 0.5805 - val_loss: 2.8526 - val_accuracy50: 0.5560 - 16s/epoch - 25ms/step
Epoch 20/50
641/641 - 15s - loss: 2.6646 - accuracy50: 0.5845 - val_loss: 2.8469 - val_accuracy50: 0.5564 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h50
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.81865495
{'0': {'precision': 0.5446964570280949, 'recall': 0.35452750031968855, 'f1-score': 0.4295033996040967, 'support': 70381}, '1': {'precision': 0.718811686122067, 'recall': 0.8242646739366555, 'f1-score': 0.7679348805015918, 'support': 230170}, '2': {'precision': 0.4347395124573694, 'recall': 0.3765680025611921, 'f1-score': 0.40356828159480973, 'support': 68718}, 'accuracy': 0.6514221339998755, 'macro avg': {'precision': 0.5660825518691771, 'recall': 0.5184533922725121, 'f1-score': 0.533668853900166, 'support': 369269}, 'weighted avg': {'precision': 0.6327625577935219, 'recall': 0.6514221339998755, 'f1-score': 0.6356256695991797, 'support': 369269}}
[[ 24952  37956   7473]
 [ 14276 189721  26173]
 [  6581  36260  25877]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.943375
{'0': {'precision': 0.5280281131326872, 'recall': 0.38803732089303566, 'f1-score': 0.4473361984106024, 'support': 48016}, '1': {'precision': 0.5580878625435484, 'recall': 0.7503407871457989, 'f1-score': 0.6400900594417056, 'support': 68958}, '2': {'precision': 0.5225779625779626, 'recall': 0.4002547770700637, 'f1-score': 0.4533092876465284, 'support': 47100}, 'accuracy': 0.5438155954020747, 'macro avg': {'precision': 0.5362313127513993, 'recall': 0.5128776283696328, 'f1-score': 0.5135785151662787, 'support': 164074}, 'weighted avg': {'precision': 0.5390972533300775, 'recall': 0.5438155954020747, 'f1-score': 0.5300626099809604, 'support': 164074}}
[[18632 21458  7926]
 [ 7919 51742  9297]
 [ 8735 19513 18852]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9243698
{'0': {'precision': 0.5253764640267707, 'recall': 0.360801050558109, 'f1-score': 0.4278067927466182, 'support': 18276}, '1': {'precision': 0.583720875885116, 'recall': 0.755101423864083, 'f1-score': 0.6584420719652037, 'support': 33079}, '2': {'precision': 0.5257104194857916, 'recall': 0.4140246176799702, 'f1-score': 0.4632306912689659, 'support': 18767}, 'accuracy': 0.5610507401386156, 'macro avg': {'precision': 0.5449359197992262, 'recall': 0.5099756973673873, 'f1-score': 0.5164931853269292, 'support': 70122}, 'weighted avg': {'precision': 0.552988941451283, 'recall': 0.5610507401386156, 'f1-score': 0.5460861445169682, 'support': 70122}}
[[ 6594  9283  2399]
 [ 3490 24978  4611]
 [ 2467  8530  7770]]
training model: results/QRTEA/W3/deepOF_L2/h100
Epoch 1/50
641/641 - 18s - loss: 3.2377 - accuracy100: 0.4018 - val_loss: 3.1904 - val_accuracy100: 0.4275 - 18s/epoch - 29ms/step
Epoch 2/50
641/641 - 16s - loss: 3.1445 - accuracy100: 0.4387 - val_loss: 3.1641 - val_accuracy100: 0.4356 - 16s/epoch - 25ms/step
Epoch 3/50
641/641 - 16s - loss: 3.0948 - accuracy100: 0.4585 - val_loss: 3.1530 - val_accuracy100: 0.4421 - 16s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 3.0673 - accuracy100: 0.4661 - val_loss: 3.1469 - val_accuracy100: 0.4465 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 15s - loss: 3.0509 - accuracy100: 0.4724 - val_loss: 3.1313 - val_accuracy100: 0.4492 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 3.0366 - accuracy100: 0.4769 - val_loss: 3.1206 - val_accuracy100: 0.4520 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 16s - loss: 3.0232 - accuracy100: 0.4806 - val_loss: 3.1048 - val_accuracy100: 0.4559 - 16s/epoch - 25ms/step
Epoch 8/50
641/641 - 16s - loss: 3.0116 - accuracy100: 0.4843 - val_loss: 3.1000 - val_accuracy100: 0.4598 - 16s/epoch - 25ms/step
Epoch 9/50
641/641 - 16s - loss: 2.9999 - accuracy100: 0.4873 - val_loss: 3.0903 - val_accuracy100: 0.4617 - 16s/epoch - 24ms/step
Epoch 10/50
641/641 - 15s - loss: 2.9886 - accuracy100: 0.4909 - val_loss: 3.0853 - val_accuracy100: 0.4649 - 15s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 2.9782 - accuracy100: 0.4946 - val_loss: 3.0866 - val_accuracy100: 0.4647 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 2.9684 - accuracy100: 0.4971 - val_loss: 3.0775 - val_accuracy100: 0.4676 - 15s/epoch - 24ms/step
Epoch 13/50
641/641 - 15s - loss: 2.9594 - accuracy100: 0.4995 - val_loss: 3.0734 - val_accuracy100: 0.4672 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 15s - loss: 2.9533 - accuracy100: 0.5017 - val_loss: 3.0711 - val_accuracy100: 0.4677 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 2.9425 - accuracy100: 0.5055 - val_loss: 3.0771 - val_accuracy100: 0.4680 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 2.9331 - accuracy100: 0.5090 - val_loss: 3.0768 - val_accuracy100: 0.4688 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 16s - loss: 2.9207 - accuracy100: 0.5131 - val_loss: 3.0817 - val_accuracy100: 0.4709 - 16s/epoch - 24ms/step
Epoch 18/50
641/641 - 16s - loss: 2.9107 - accuracy100: 0.5162 - val_loss: 3.0896 - val_accuracy100: 0.4701 - 16s/epoch - 24ms/step
Epoch 19/50
641/641 - 16s - loss: 2.9009 - accuracy100: 0.5187 - val_loss: 3.0923 - val_accuracy100: 0.4689 - 16s/epoch - 24ms/step
Epoch 20/50
641/641 - 15s - loss: 2.8852 - accuracy100: 0.5259 - val_loss: 3.1176 - val_accuracy100: 0.4676 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 15s - loss: 2.8742 - accuracy100: 0.5272 - val_loss: 3.1320 - val_accuracy100: 0.4614 - 15s/epoch - 24ms/step
Epoch 22/50
641/641 - 15s - loss: 2.8620 - accuracy100: 0.5317 - val_loss: 3.1373 - val_accuracy100: 0.4582 - 15s/epoch - 24ms/step
Epoch 23/50
641/641 - 15s - loss: 2.8517 - accuracy100: 0.5347 - val_loss: 3.1440 - val_accuracy100: 0.4575 - 15s/epoch - 24ms/step
Epoch 24/50
641/641 - 15s - loss: 2.8402 - accuracy100: 0.5384 - val_loss: 3.1562 - val_accuracy100: 0.4616 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h100
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9518506
{'0': {'precision': 0.522777124951038, 'recall': 0.28645168213768313, 'f1-score': 0.37010641616693823, 'support': 93185}, '1': {'precision': 0.576624019363345, 'recall': 0.804034892873702, 'f1-score': 0.6716008241108722, 'support': 185482}, '2': {'precision': 0.45580435074526654, 'recall': 0.2997174455310037, 'f1-score': 0.3616375234721464, 'support': 90602}, 'accuracy': 0.5496860012619527, 'macro avg': {'precision': 0.5184018316865499, 'recall': 0.4634013401807962, 'f1-score': 0.46778158791665225, 'support': 369269}, 'weighted avg': {'precision': 0.5333920489787581, 'recall': 0.5496860012619527, 'f1-score': 0.5194676871058018, 'support': 369269}}
[[ 26693  56175  10317]
 [ 14244 149134  22104]
 [ 10123  53324  27155]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0171729
{'0': {'precision': 0.5234476111799532, 'recall': 0.34370592702419267, 'f1-score': 0.4149485379989304, 'support': 55306}, '1': {'precision': 0.4348790011250579, 'recall': 0.7295891931902294, 'f1-score': 0.5449406366187061, 'support': 54040}, '2': {'precision': 0.5297193843167911, 'recall': 0.3590666569215027, 'f1-score': 0.42800980125238225, 'support': 54728}, 'accuracy': 0.4759254970318271, 'macro avg': {'precision': 0.4960153322072674, 'recall': 0.4774539257119749, 'f1-score': 0.4626329919566729, 'support': 164074}, 'weighted avg': {'precision': 0.4963683293489886, 'recall': 0.4759254970318271, 'f1-score': 0.4621198742542029, 'support': 164074}}
[[19009 26600  9697]
 [ 6864 39427  7749]
 [10442 24635 19651]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0240192
{'0': {'precision': 0.49836116747307635, 'recall': 0.29612798516114075, 'f1-score': 0.37150586113615874, 'support': 21565}, '1': {'precision': 0.4391118145424076, 'recall': 0.729487278632743, 'f1-score': 0.548223055240752, 'support': 25862}, '2': {'precision': 0.5294896820970441, 'recall': 0.3346552103987662, 'f1-score': 0.4101082642619941, 'support': 22695}, 'accuracy': 0.4684264567468127, 'macro avg': {'precision': 0.488987554704176, 'recall': 0.45342349139754995, 'f1-score': 0.4432790602129682, 'support': 70122}, 'weighted avg': {'precision': 0.4865839060415426, 'recall': 0.4684264567468127, 'f1-score': 0.44917537445400224, 'support': 70122}}
[[ 6386 12243  2936]
 [ 3183 18866  3813]
 [ 3245 11855  7595]]
training model: results/QRTEA/W3/deepOF_L2/h200
Epoch 1/50
641/641 - 18s - loss: 3.2831 - accuracy200: 0.3768 - val_loss: 3.2836 - val_accuracy200: 0.3697 - 18s/epoch - 29ms/step
Epoch 2/50
641/641 - 16s - loss: 3.2424 - accuracy200: 0.3943 - val_loss: 3.2702 - val_accuracy200: 0.3763 - 16s/epoch - 24ms/step
Epoch 3/50
641/641 - 16s - loss: 3.2238 - accuracy200: 0.4030 - val_loss: 3.2638 - val_accuracy200: 0.3806 - 16s/epoch - 25ms/step
Epoch 4/50
641/641 - 16s - loss: 3.2122 - accuracy200: 0.4082 - val_loss: 3.2648 - val_accuracy200: 0.3822 - 16s/epoch - 25ms/step
Epoch 5/50
641/641 - 15s - loss: 3.2046 - accuracy200: 0.4123 - val_loss: 3.2648 - val_accuracy200: 0.3844 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 3.1979 - accuracy200: 0.4132 - val_loss: 3.2646 - val_accuracy200: 0.3852 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 3.1932 - accuracy200: 0.4158 - val_loss: 3.2635 - val_accuracy200: 0.3848 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 15s - loss: 3.1883 - accuracy200: 0.4171 - val_loss: 3.2648 - val_accuracy200: 0.3847 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 3.1844 - accuracy200: 0.4197 - val_loss: 3.2627 - val_accuracy200: 0.3867 - 15s/epoch - 24ms/step
Epoch 10/50
641/641 - 15s - loss: 3.1791 - accuracy200: 0.4219 - val_loss: 3.2639 - val_accuracy200: 0.3857 - 15s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 3.1751 - accuracy200: 0.4232 - val_loss: 3.2586 - val_accuracy200: 0.3864 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 3.1706 - accuracy200: 0.4271 - val_loss: 3.2656 - val_accuracy200: 0.3871 - 15s/epoch - 24ms/step
Epoch 13/50
641/641 - 15s - loss: 3.1659 - accuracy200: 0.4275 - val_loss: 3.2673 - val_accuracy200: 0.3837 - 15s/epoch - 23ms/step
Epoch 14/50
641/641 - 15s - loss: 3.1610 - accuracy200: 0.4304 - val_loss: 3.2679 - val_accuracy200: 0.3874 - 15s/epoch - 23ms/step
Epoch 15/50
641/641 - 15s - loss: 3.1553 - accuracy200: 0.4327 - val_loss: 3.2661 - val_accuracy200: 0.3879 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 3.1484 - accuracy200: 0.4360 - val_loss: 3.2727 - val_accuracy200: 0.3893 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 15s - loss: 3.1416 - accuracy200: 0.4380 - val_loss: 3.2776 - val_accuracy200: 0.3865 - 15s/epoch - 24ms/step
Epoch 18/50
641/641 - 15s - loss: 3.1367 - accuracy200: 0.4414 - val_loss: 3.2844 - val_accuracy200: 0.3831 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 16s - loss: 3.1278 - accuracy200: 0.4446 - val_loss: 3.2930 - val_accuracy200: 0.3799 - 16s/epoch - 24ms/step
Epoch 20/50
641/641 - 15s - loss: 3.1227 - accuracy200: 0.4456 - val_loss: 3.3043 - val_accuracy200: 0.3792 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 15s - loss: 3.1183 - accuracy200: 0.4484 - val_loss: 3.3115 - val_accuracy200: 0.3754 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h200
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0794364
{'0': {'precision': 0.37751571560840114, 'recall': 0.6099893265209707, 'f1-score': 0.46638862039325596, 'support': 114302}, '1': {'precision': 0.41344699573765986, 'recall': 0.10238826501774004, 'f1-score': 0.16413038731933105, 'support': 146843}, '2': {'precision': 0.3723577235772358, 'recall': 0.5104232177869853, 'f1-score': 0.4305938620342593, 'support': 108124}, 'accuracy': 0.3789838843769718, 'macro avg': {'precision': 0.3877734783077656, 'recall': 0.40760026977523206, 'f1-score': 0.3537042899156155, 'support': 369269}, 'weighted avg': {'precision': 0.39029381027013293, 'recall': 0.3789838843769718, 'f1-score': 0.33571212663915667, 'support': 369269}}
[[69723 10889 33690]
 [72472 15035 59336]
 [42494 10441 55189]]
Evaluating performance on  train set...
641/641 - 6s - 6s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0783594
{'0': {'precision': 0.39455152800975035, 'recall': 0.6311741767764298, 'f1-score': 0.48556984528207553, 'support': 55392}, '1': {'precision': 0.3632634457611668, 'recall': 0.08757600175811296, 'f1-score': 0.1411285562507378, 'support': 54604}, '2': {'precision': 0.4034800475135638, 'recall': 0.4648100891305152, 'f1-score': 0.4319791022203891, 'support': 54078}, 'accuracy': 0.3954313297658374, 'macro avg': {'precision': 0.3870983404281603, 'recall': 0.394520089221686, 'f1-score': 0.35289250125106747, 'support': 164074}, 'weighted avg': {'precision': 0.3870816183020914, 'recall': 0.3954313297658374, 'f1-score': 0.353276170784245, 'support': 164074}}
[[34962  4189 16241]
 [28901  4782 20921]
 [24749  4193 25136]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0855734
{'0': {'precision': 0.3719467888882678, 'recall': 0.6085227012939509, 'f1-score': 0.4616932336565313, 'support': 21871}, '1': {'precision': 0.3757304915778618, 'recall': 0.08751000800640513, 'f1-score': 0.14195726995259433, 'support': 24980}, '2': {'precision': 0.4099291774770353, 'recall': 0.5024279145717846, 'f1-score': 0.45148958353445445, 'support': 23271}, 'accuracy': 0.38770999115826704, 'macro avg': {'precision': 0.38586881931438827, 'recall': 0.3994868746240468, 'f1-score': 0.3517133623811934, 'support': 70122}, 'weighted avg': {'precision': 0.38589968609649444, 'recall': 0.38770999115826704, 'f1-score': 0.3444054564209249, 'support': 70122}}
[[13309  1742  6820]
 [12784  2186 10010]
 [ 9689  1890 11692]]
training model: results/QRTEA/W3/deepOF_L2/h300
Epoch 1/50
641/641 - 17s - loss: 3.3026 - accuracy300: 0.3617 - val_loss: 3.2955 - val_accuracy300: 0.3483 - 17s/epoch - 27ms/step
Epoch 2/50
641/641 - 16s - loss: 3.2706 - accuracy300: 0.3771 - val_loss: 3.2795 - val_accuracy300: 0.3609 - 16s/epoch - 25ms/step
Epoch 3/50
641/641 - 15s - loss: 3.2579 - accuracy300: 0.3829 - val_loss: 3.2708 - val_accuracy300: 0.3686 - 15s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 3.2491 - accuracy300: 0.3897 - val_loss: 3.2651 - val_accuracy300: 0.3733 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 16s - loss: 3.2440 - accuracy300: 0.3917 - val_loss: 3.2639 - val_accuracy300: 0.3767 - 16s/epoch - 25ms/step
Epoch 6/50
641/641 - 16s - loss: 3.2384 - accuracy300: 0.3950 - val_loss: 3.2621 - val_accuracy300: 0.3774 - 16s/epoch - 24ms/step
Epoch 7/50
641/641 - 16s - loss: 3.2362 - accuracy300: 0.3954 - val_loss: 3.2619 - val_accuracy300: 0.3775 - 16s/epoch - 24ms/step
Epoch 8/50
641/641 - 15s - loss: 3.2315 - accuracy300: 0.3973 - val_loss: 3.2598 - val_accuracy300: 0.3821 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 16s - loss: 3.2274 - accuracy300: 0.4007 - val_loss: 3.2609 - val_accuracy300: 0.3832 - 16s/epoch - 24ms/step
Epoch 10/50
641/641 - 16s - loss: 3.2250 - accuracy300: 0.4015 - val_loss: 3.2591 - val_accuracy300: 0.3832 - 16s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 3.2215 - accuracy300: 0.4047 - val_loss: 3.2580 - val_accuracy300: 0.3867 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 16s - loss: 3.2180 - accuracy300: 0.4064 - val_loss: 3.2577 - val_accuracy300: 0.3861 - 16s/epoch - 25ms/step
Epoch 13/50
641/641 - 15s - loss: 3.2158 - accuracy300: 0.4071 - val_loss: 3.2583 - val_accuracy300: 0.3869 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 16s - loss: 3.2119 - accuracy300: 0.4093 - val_loss: 3.2577 - val_accuracy300: 0.3886 - 16s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 3.2087 - accuracy300: 0.4109 - val_loss: 3.2568 - val_accuracy300: 0.3857 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 16s - loss: 3.2039 - accuracy300: 0.4142 - val_loss: 3.2621 - val_accuracy300: 0.3896 - 16s/epoch - 24ms/step
Epoch 17/50
641/641 - 15s - loss: 3.1986 - accuracy300: 0.4160 - val_loss: 3.2637 - val_accuracy300: 0.3879 - 15s/epoch - 24ms/step
Epoch 18/50
641/641 - 16s - loss: 3.1941 - accuracy300: 0.4184 - val_loss: 3.2637 - val_accuracy300: 0.3892 - 16s/epoch - 25ms/step
Epoch 19/50
641/641 - 16s - loss: 3.1889 - accuracy300: 0.4225 - val_loss: 3.2676 - val_accuracy300: 0.3900 - 16s/epoch - 24ms/step
Epoch 20/50
641/641 - 15s - loss: 3.1820 - accuracy300: 0.4264 - val_loss: 3.2701 - val_accuracy300: 0.3885 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 16s - loss: 3.1763 - accuracy300: 0.4286 - val_loss: 3.2782 - val_accuracy300: 0.3841 - 16s/epoch - 24ms/step
Epoch 22/50
641/641 - 15s - loss: 3.1704 - accuracy300: 0.4326 - val_loss: 3.2878 - val_accuracy300: 0.3834 - 15s/epoch - 24ms/step
Epoch 23/50
641/641 - 15s - loss: 3.1737 - accuracy300: 0.4329 - val_loss: 3.2653 - val_accuracy300: 0.3906 - 15s/epoch - 24ms/step
Epoch 24/50
641/641 - 16s - loss: 3.1682 - accuracy300: 0.4355 - val_loss: 3.2878 - val_accuracy300: 0.3825 - 16s/epoch - 24ms/step
Epoch 25/50
641/641 - 16s - loss: 3.1590 - accuracy300: 0.4408 - val_loss: 3.2999 - val_accuracy300: 0.3814 - 16s/epoch - 25ms/step
testing model: results/QRTEA/W3/deepOF_L2/h300
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0793068
{'0': {'precision': 0.40801116161843465, 'recall': 0.3735311083642357, 'f1-score': 0.39001054012777214, 'support': 121350}, '1': {'precision': 0.38572513287775245, 'recall': 0.3760483829179282, 'f1-score': 0.3808252963952786, 'support': 135089}, '2': {'precision': 0.37270110852823507, 'recall': 0.41777009660551273, 'f1-score': 0.3939507906261492, 'support': 112830}, 'accuracy': 0.38796920402200025, 'macro avg': {'precision': 0.3888124676748074, 'recall': 0.3891165292958922, 'f1-score': 0.38826220904973335, 'support': 369269}, 'weighted avg': {'precision': 0.3890693316063913, 'recall': 0.38796920402200025, 'f1-score': 0.3878542612989321, 'support': 369269}}
[[45328 42592 33430]
 [38382 50800 45907]
 [27385 38308 47137]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0811098
{'0': {'precision': 0.4268239239372749, 'recall': 0.39293795716465824, 'f1-score': 0.4091805794030614, 'support': 57009}, '1': {'precision': 0.35142895077505226, 'recall': 0.408492003781083, 'f1-score': 0.3778180228564292, 'support': 51837}, '2': {'precision': 0.41375616027426615, 'recall': 0.38460563482291593, 'f1-score': 0.3986487120536762, 'support': 55228}, 'accuracy': 0.3950473566805222, 'macro avg': {'precision': 0.3973363449955311, 'recall': 0.3953451985895524, 'f1-score': 0.39521577143772224, 'support': 164074}, 'weighted avg': {'precision': 0.39860521972215984, 'recall': 0.3950473566805222, 'f1-score': 0.3957269254805653, 'support': 164074}}
[[22401 20123 14485]
 [15051 21175 15611]
 [15031 18956 21241]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0863032
{'0': {'precision': 0.39616306954436453, 'recall': 0.36223303951234487, 'f1-score': 0.37843905344420775, 'support': 22803}, '1': {'precision': 0.3513617479612248, 'recall': 0.399440241395898, 'f1-score': 0.3738616130814727, 'support': 22867}, '2': {'precision': 0.4174256745145214, 'recall': 0.39734991002780956, 'f1-score': 0.4071404626215219, 'support': 24452}, 'accuracy': 0.3866119049656313, 'macro avg': {'precision': 0.3883168306733702, 'recall': 0.3863410636453508, 'f1-score': 0.3864803763824008, 'support': 70122}, 'weighted avg': {'precision': 0.38896763011149926, 'recall': 0.3866119049656313, 'f1-score': 0.38695470514309005, 'support': 70122}}
[[8260 8225 6318]
 [6491 9134 7242]
 [6099 8637 9716]]
training model: results/QRTEA/W3/deepOF_L2/h500
Epoch 1/50
641/641 - 18s - loss: 3.2836 - accuracy500: 0.3904 - val_loss: 3.2916 - val_accuracy500: 0.3707 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 16s - loss: 3.2639 - accuracy500: 0.3929 - val_loss: 3.2828 - val_accuracy500: 0.3775 - 16s/epoch - 24ms/step
Epoch 3/50
641/641 - 15s - loss: 3.2592 - accuracy500: 0.3931 - val_loss: 3.2796 - val_accuracy500: 0.3771 - 15s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 3.2556 - accuracy500: 0.3922 - val_loss: 3.2753 - val_accuracy500: 0.3794 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 15s - loss: 3.2551 - accuracy500: 0.3941 - val_loss: 3.2737 - val_accuracy500: 0.3811 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 16s - loss: 3.2490 - accuracy500: 0.3943 - val_loss: 3.2723 - val_accuracy500: 0.3816 - 16s/epoch - 25ms/step
Epoch 7/50
641/641 - 15s - loss: 3.2457 - accuracy500: 0.4000 - val_loss: 3.2707 - val_accuracy500: 0.3839 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 15s - loss: 3.2419 - accuracy500: 0.4007 - val_loss: 3.2701 - val_accuracy500: 0.3865 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 3.2314 - accuracy500: 0.4001 - val_loss: 3.2694 - val_accuracy500: 0.3848 - 15s/epoch - 24ms/step
Epoch 10/50
641/641 - 15s - loss: 3.2352 - accuracy500: 0.4021 - val_loss: 3.2699 - val_accuracy500: 0.3853 - 15s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 3.2309 - accuracy500: 0.4034 - val_loss: 3.2692 - val_accuracy500: 0.3865 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 3.2301 - accuracy500: 0.4066 - val_loss: 3.2690 - val_accuracy500: 0.3856 - 15s/epoch - 23ms/step
Epoch 13/50
641/641 - 15s - loss: 3.2285 - accuracy500: 0.4055 - val_loss: 3.2708 - val_accuracy500: 0.3851 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 15s - loss: 3.2208 - accuracy500: 0.4083 - val_loss: 3.2720 - val_accuracy500: 0.3844 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 3.2209 - accuracy500: 0.4084 - val_loss: 3.2721 - val_accuracy500: 0.3833 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 3.2182 - accuracy500: 0.4088 - val_loss: 3.2727 - val_accuracy500: 0.3843 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 15s - loss: 3.2168 - accuracy500: 0.4098 - val_loss: 3.2718 - val_accuracy500: 0.3847 - 15s/epoch - 23ms/step
Epoch 18/50
641/641 - 15s - loss: 3.2181 - accuracy500: 0.4102 - val_loss: 3.2712 - val_accuracy500: 0.3847 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 15s - loss: 3.2145 - accuracy500: 0.4132 - val_loss: 3.2724 - val_accuracy500: 0.3857 - 15s/epoch - 23ms/step
Epoch 20/50
641/641 - 15s - loss: 3.2130 - accuracy500: 0.4136 - val_loss: 3.2749 - val_accuracy500: 0.3850 - 15s/epoch - 23ms/step
Epoch 21/50
641/641 - 15s - loss: 3.2090 - accuracy500: 0.4149 - val_loss: 3.2763 - val_accuracy500: 0.3841 - 15s/epoch - 24ms/step
Epoch 22/50
641/641 - 15s - loss: 3.2062 - accuracy500: 0.4166 - val_loss: 3.2776 - val_accuracy500: 0.3840 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h500
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0814319
{'0': {'precision': 0.41481518068826784, 'recall': 0.6575487746720478, 'f1-score': 0.5087101490375747, 'support': 140493}, '1': {'precision': 0.35688805843383725, 'recall': 0.02116215590092767, 'f1-score': 0.03995511942796288, 'support': 99281}, '2': {'precision': 0.40209556576010463, 'recall': 0.43681995443839533, 'f1-score': 0.4187391042036029, 'support': 129495}, 'accuracy': 0.40904598003081766, 'macro avg': {'precision': 0.3912662682940699, 'recall': 0.3718436283371236, 'f1-score': 0.3224681242230469, 'support': 369269}, 'weighted avg': {'precision': 0.39478049280581734, 'recall': 0.40904598003081766, 'f1-score': 0.3511305294501004, 'support': 369269}}
[[92381  1804 46308]
 [59376  2101 37804]
 [70947  1982 56566]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1017811
{'0': {'precision': 0.3592337240224564, 'recall': 0.6666118360931389, 'f1-score': 0.46687232789739125, 'support': 54714}, '1': {'precision': 0.3754093480202441, 'recall': 0.02262816946901861, 'f1-score': 0.042683546017669154, 'support': 55727}, '2': {'precision': 0.36421390555039285, 'recall': 0.40191673037122666, 'f1-score': 0.3821376021556843, 'support': 53633}, 'accuracy': 0.3613613369577142, 'macro avg': {'precision': 0.3662856591976978, 'recall': 0.36371891197779477, 'f1-score': 0.29723115869024824, 'support': 164074}, 'weighted avg': {'precision': 0.3663556389779797, 'recall': 0.3613613369577142, 'f1-score': 0.2951001653761128, 'support': 164074}}
[[36473   998 17243]
 [34080  1261 20386]
 [30977  1100 21556]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0893283
{'0': {'precision': 0.3694312965297434, 'recall': 0.6452845866223514, 'f1-score': 0.4698622056176546, 'support': 24070}, '1': {'precision': 0.3445575567736883, 'recall': 0.021887280505397205, 'f1-score': 0.04115996258185221, 'support': 20103}, '2': {'precision': 0.4120214909335124, 'recall': 0.4255655323904582, 'f1-score': 0.4186840059904078, 'support': 25949}, 'accuracy': 0.3852571232993925, 'macro avg': {'precision': 0.37533678141231475, 'recall': 0.36424579983940225, 'f1-score': 0.3099020580633049, 'support': 70122}, 'weighted avg': {'precision': 0.3780610584342445, 'recall': 0.3852571232993925, 'f1-score': 0.3280204969687832, 'support': 70122}}
[[15532   386  8152]
 [12056   440  7607]
 [14455   451 11043]]
training model: results/QRTEA/W3/deepOF_L2/h1000
Epoch 1/50
641/641 - 18s - loss: 3.2960 - accuracy1000: 0.3796 - val_loss: 3.4368 - val_accuracy1000: 0.3237 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 15s - loss: 3.2693 - accuracy1000: 0.3910 - val_loss: 3.4394 - val_accuracy1000: 0.3278 - 15s/epoch - 24ms/step
Epoch 3/50
641/641 - 15s - loss: 3.2606 - accuracy1000: 0.3949 - val_loss: 3.4347 - val_accuracy1000: 0.3274 - 15s/epoch - 24ms/step
Epoch 4/50
641/641 - 15s - loss: 3.2543 - accuracy1000: 0.3973 - val_loss: 3.4341 - val_accuracy1000: 0.3289 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 15s - loss: 3.2499 - accuracy1000: 0.3954 - val_loss: 3.4228 - val_accuracy1000: 0.3307 - 15s/epoch - 24ms/step
Epoch 6/50
641/641 - 15s - loss: 3.2454 - accuracy1000: 0.3993 - val_loss: 3.4274 - val_accuracy1000: 0.3313 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 3.2414 - accuracy1000: 0.4006 - val_loss: 3.4223 - val_accuracy1000: 0.3316 - 15s/epoch - 24ms/step
Epoch 8/50
641/641 - 15s - loss: 3.2371 - accuracy1000: 0.4043 - val_loss: 3.4189 - val_accuracy1000: 0.3344 - 15s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 3.2328 - accuracy1000: 0.4054 - val_loss: 3.4128 - val_accuracy1000: 0.3352 - 15s/epoch - 24ms/step
Epoch 10/50
641/641 - 15s - loss: 3.2309 - accuracy1000: 0.4056 - val_loss: 3.4160 - val_accuracy1000: 0.3371 - 15s/epoch - 24ms/step
Epoch 11/50
641/641 - 15s - loss: 3.2280 - accuracy1000: 0.4065 - val_loss: 3.4125 - val_accuracy1000: 0.3378 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 15s - loss: 3.2248 - accuracy1000: 0.4081 - val_loss: 3.4118 - val_accuracy1000: 0.3371 - 15s/epoch - 24ms/step
Epoch 13/50
641/641 - 15s - loss: 3.2236 - accuracy1000: 0.4084 - val_loss: 3.4116 - val_accuracy1000: 0.3370 - 15s/epoch - 24ms/step
Epoch 14/50
641/641 - 15s - loss: 3.2212 - accuracy1000: 0.4095 - val_loss: 3.4033 - val_accuracy1000: 0.3371 - 15s/epoch - 24ms/step
Epoch 15/50
641/641 - 15s - loss: 3.2184 - accuracy1000: 0.4112 - val_loss: 3.4034 - val_accuracy1000: 0.3386 - 15s/epoch - 24ms/step
Epoch 16/50
641/641 - 15s - loss: 3.2172 - accuracy1000: 0.4106 - val_loss: 3.4016 - val_accuracy1000: 0.3379 - 15s/epoch - 24ms/step
Epoch 17/50
641/641 - 15s - loss: 3.2157 - accuracy1000: 0.4124 - val_loss: 3.4108 - val_accuracy1000: 0.3379 - 15s/epoch - 24ms/step
Epoch 18/50
641/641 - 15s - loss: 3.2127 - accuracy1000: 0.4134 - val_loss: 3.4064 - val_accuracy1000: 0.3381 - 15s/epoch - 23ms/step
Epoch 19/50
641/641 - 15s - loss: 3.2098 - accuracy1000: 0.4156 - val_loss: 3.4137 - val_accuracy1000: 0.3385 - 15s/epoch - 24ms/step
Epoch 20/50
641/641 - 15s - loss: 3.2063 - accuracy1000: 0.4170 - val_loss: 3.4201 - val_accuracy1000: 0.3373 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 16s - loss: 3.2030 - accuracy1000: 0.4197 - val_loss: 3.4146 - val_accuracy1000: 0.3373 - 16s/epoch - 24ms/step
Epoch 22/50
641/641 - 16s - loss: 3.1997 - accuracy1000: 0.4193 - val_loss: 3.4151 - val_accuracy1000: 0.3368 - 16s/epoch - 25ms/step
Epoch 23/50
641/641 - 15s - loss: 3.1937 - accuracy1000: 0.4231 - val_loss: 3.4242 - val_accuracy1000: 0.3391 - 15s/epoch - 24ms/step
Epoch 24/50
641/641 - 15s - loss: 3.1908 - accuracy1000: 0.4249 - val_loss: 3.4293 - val_accuracy1000: 0.3393 - 15s/epoch - 24ms/step
Epoch 25/50
641/641 - 15s - loss: 3.1840 - accuracy1000: 0.4276 - val_loss: 3.4434 - val_accuracy1000: 0.3378 - 15s/epoch - 24ms/step
Epoch 26/50
641/641 - 15s - loss: 3.1777 - accuracy1000: 0.4316 - val_loss: 3.4512 - val_accuracy1000: 0.3398 - 15s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepOF_L2/h1000
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.083026
{'0': {'precision': 0.40880819967222803, 'recall': 0.42259437466586125, 'f1-score': 0.41558698717357834, 'support': 144027}, '1': {'precision': 0.2376448332939229, 'recall': 0.011183192940679003, 'f1-score': 0.021361163067505524, 'support': 89867}, '2': {'precision': 0.38223320194674215, 'recall': 0.6103194829178209, 'f1-score': 0.4700694960046198, 'support': 135375}, 'accuracy': 0.3912919849757223, 'macro avg': {'precision': 0.34289541163763104, 'recall': 0.34803235017478706, 'f1-score': 0.3023392154152345, 'support': 369269}, 'weighted avg': {'precision': 0.3574106316028618, 'recall': 0.3912919849757223, 'f1-score': 0.33961981283200565, 'support': 369269}}
[[60865  1511 81651]
 [36979  1005 51883]
 [51040  1713 82622]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112787
{'0': {'precision': 0.3725413060582219, 'recall': 0.49167502148381553, 'f1-score': 0.423896769413617, 'support': 55856}, '1': {'precision': 0.3851573508689526, 'recall': 0.015102401650213643, 'f1-score': 0.029065130704474966, 'support': 54296}, '2': {'precision': 0.3404740045564283, 'recall': 0.5570824524312896, 'f1-score': 0.42264103159360955, 'support': 53922}, 'accuracy': 0.35546156002779233, 'macro avg': {'precision': 0.3660575538278676, 'recall': 0.3546199585217729, 'f1-score': 0.2918676439039005, 'support': 164074}, 'weighted avg': {'precision': 0.36617751738642573, 'recall': 0.35546156002779233, 'f1-score': 0.292824871671854, 'support': 164074}}
[[27463   645 27748]
 [23036   820 30440]
 [23219   664 30039]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1313417
{'0': {'precision': 0.3314311652940795, 'recall': 0.4757295108670359, 'f1-score': 0.39068203099619714, 'support': 21487}, '1': {'precision': 0.3846994535519126, 'recall': 0.013888340895640165, 'f1-score': 0.02680883472962681, 'support': 25345}, '2': {'precision': 0.342656066727486, 'recall': 0.5644482610562473, 'f1-score': 0.4264374341091558, 'support': 23290}, 'accuracy': 0.33826759077037166, 'macro avg': {'precision': 0.3529288951911594, 'recall': 0.35135537093964114, 'f1-score': 0.2813094332783266, 'support': 70122}, 'weighted avg': {'precision': 0.35441272201349444, 'recall': 0.33826759077037166, 'f1-score': 0.27103879747639714, 'support': 70122}}
[[10222   270 10995]
 [10769   352 14224]
 [ 9851   293 13146]]
training model: results/QRTEA/W3/deepVOL_L2/h10
Epoch 1/50
641/641 - 18s - loss: 2.9335 - accuracy10: 0.5267 - val_loss: 2.5093 - val_accuracy10: 0.5907 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 15s - loss: 2.7409 - accuracy10: 0.5682 - val_loss: 2.4474 - val_accuracy10: 0.5963 - 15s/epoch - 24ms/step
Epoch 3/50
641/641 - 14s - loss: 2.6676 - accuracy10: 0.5866 - val_loss: 2.4414 - val_accuracy10: 0.6039 - 14s/epoch - 22ms/step
Epoch 4/50
641/641 - 14s - loss: 2.6334 - accuracy10: 0.5947 - val_loss: 2.4254 - val_accuracy10: 0.6291 - 14s/epoch - 22ms/step
Epoch 5/50
641/641 - 14s - loss: 2.6116 - accuracy10: 0.6016 - val_loss: 2.3886 - val_accuracy10: 0.6493 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 15s - loss: 2.5911 - accuracy10: 0.6066 - val_loss: 2.3803 - val_accuracy10: 0.6619 - 15s/epoch - 23ms/step
Epoch 7/50
641/641 - 14s - loss: 2.5783 - accuracy10: 0.6090 - val_loss: 2.3697 - val_accuracy10: 0.6622 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 14s - loss: 2.5666 - accuracy10: 0.6129 - val_loss: 2.3731 - val_accuracy10: 0.6694 - 14s/epoch - 23ms/step
Epoch 9/50
641/641 - 14s - loss: 2.5541 - accuracy10: 0.6153 - val_loss: 2.3631 - val_accuracy10: 0.6745 - 14s/epoch - 23ms/step
Epoch 10/50
641/641 - 14s - loss: 2.5447 - accuracy10: 0.6179 - val_loss: 2.3656 - val_accuracy10: 0.6600 - 14s/epoch - 23ms/step
Epoch 11/50
641/641 - 14s - loss: 2.5351 - accuracy10: 0.6174 - val_loss: 2.3617 - val_accuracy10: 0.6680 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 2.5272 - accuracy10: 0.6196 - val_loss: 2.3592 - val_accuracy10: 0.6560 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 14s - loss: 2.5172 - accuracy10: 0.6216 - val_loss: 2.3754 - val_accuracy10: 0.6632 - 14s/epoch - 22ms/step
Epoch 14/50
641/641 - 14s - loss: 2.5083 - accuracy10: 0.6221 - val_loss: 2.3616 - val_accuracy10: 0.6646 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 14s - loss: 2.5020 - accuracy10: 0.6234 - val_loss: 2.3509 - val_accuracy10: 0.6595 - 14s/epoch - 22ms/step
Epoch 16/50
641/641 - 14s - loss: 2.4969 - accuracy10: 0.6238 - val_loss: 2.3449 - val_accuracy10: 0.6591 - 14s/epoch - 22ms/step
Epoch 17/50
641/641 - 14s - loss: 2.4861 - accuracy10: 0.6258 - val_loss: 2.3607 - val_accuracy10: 0.6652 - 14s/epoch - 22ms/step
Epoch 18/50
641/641 - 14s - loss: 2.4805 - accuracy10: 0.6263 - val_loss: 2.3558 - val_accuracy10: 0.6574 - 14s/epoch - 22ms/step
Epoch 19/50
641/641 - 15s - loss: 2.4735 - accuracy10: 0.6284 - val_loss: 2.3463 - val_accuracy10: 0.6643 - 15s/epoch - 23ms/step
Epoch 20/50
641/641 - 15s - loss: 2.4676 - accuracy10: 0.6288 - val_loss: 2.3564 - val_accuracy10: 0.6566 - 15s/epoch - 24ms/step
Epoch 21/50
641/641 - 14s - loss: 2.4596 - accuracy10: 0.6294 - val_loss: 2.3577 - val_accuracy10: 0.6556 - 14s/epoch - 22ms/step
Epoch 22/50
641/641 - 14s - loss: 2.4526 - accuracy10: 0.6313 - val_loss: 2.3622 - val_accuracy10: 0.6530 - 14s/epoch - 22ms/step
Epoch 23/50
641/641 - 15s - loss: 2.4452 - accuracy10: 0.6323 - val_loss: 2.3374 - val_accuracy10: 0.6694 - 15s/epoch - 23ms/step
Epoch 24/50
641/641 - 14s - loss: 2.4415 - accuracy10: 0.6330 - val_loss: 2.3449 - val_accuracy10: 0.6600 - 14s/epoch - 22ms/step
Epoch 25/50
641/641 - 14s - loss: 2.4323 - accuracy10: 0.6333 - val_loss: 2.3644 - val_accuracy10: 0.6530 - 14s/epoch - 22ms/step
Epoch 26/50
641/641 - 15s - loss: 2.4248 - accuracy10: 0.6345 - val_loss: 2.3799 - val_accuracy10: 0.6535 - 15s/epoch - 24ms/step
Epoch 27/50
641/641 - 14s - loss: 2.4203 - accuracy10: 0.6344 - val_loss: 2.3603 - val_accuracy10: 0.6573 - 14s/epoch - 22ms/step
Epoch 28/50
641/641 - 14s - loss: 2.4120 - accuracy10: 0.6369 - val_loss: 2.3724 - val_accuracy10: 0.6536 - 14s/epoch - 22ms/step
Epoch 29/50
641/641 - 15s - loss: 2.4063 - accuracy10: 0.6358 - val_loss: 2.3808 - val_accuracy10: 0.6472 - 15s/epoch - 23ms/step
Epoch 30/50
641/641 - 14s - loss: 2.3975 - accuracy10: 0.6377 - val_loss: 2.3559 - val_accuracy10: 0.6567 - 14s/epoch - 23ms/step
Epoch 31/50
641/641 - 14s - loss: 2.3937 - accuracy10: 0.6389 - val_loss: 2.3975 - val_accuracy10: 0.6496 - 14s/epoch - 22ms/step
Epoch 32/50
641/641 - 16s - loss: 2.3842 - accuracy10: 0.6388 - val_loss: 2.4037 - val_accuracy10: 0.6455 - 16s/epoch - 24ms/step
Epoch 33/50
641/641 - 14s - loss: 2.3806 - accuracy10: 0.6405 - val_loss: 2.3847 - val_accuracy10: 0.6396 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h10
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6971003
{'0': {'precision': 0.41245994642012923, 'recall': 0.45958443078724026, 'f1-score': 0.43474890648358344, 'support': 34170}, '1': {'precision': 0.9249383644645021, 'recall': 0.7329929100560638, 'f1-score': 0.8178544838505266, 'support': 301977}, '2': {'precision': 0.24133465376704502, 'recall': 0.6694439413149792, 'f1-score': 0.3547734271887374, 'support': 33126}, 'accuracy': 0.7019928345695461, 'macro avg': {'precision': 0.5262443215505588, 'recall': 0.6206737607194278, 'f1-score': 0.5357922725076159, 'support': 369273}, 'weighted avg': {'precision': 0.8161937661181832, 'recall': 0.701992834569546, 'f1-score': 0.7408633670843214, 'support': 369273}}
[[ 15704  11374   7092]
 [ 18009 221347  62621]
 [  4361   6589  22176]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8209408
{'0': {'precision': 0.41909917454240936, 'recall': 0.5047001620745543, 'f1-score': 0.45793369389389055, 'support': 27765}, '1': {'precision': 0.8483716442858906, 'recall': 0.6903625126664902, 'f1-score': 0.76125427823636, 'support': 109541}, '2': {'precision': 0.3683614457831325, 'recall': 0.5710710149800142, 'f1-score': 0.4478460208879579, 'support': 26769}, 'accuracy': 0.6394819442328203, 'macro avg': {'precision': 0.5452774215371442, 'recall': 0.5887112299070195, 'f1-score': 0.5556779976727362, 'support': 164075}, 'weighted avg': {'precision': 0.6974154161819864, 'recall': 0.6394819442328203, 'f1-score': 0.6587930765589074, 'support': 164075}}
[[14013  8111  5641]
 [13346 75623 20572]
 [ 6077  5405 15287]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.76264673
{'0': {'precision': 0.42239723396081447, 'recall': 0.4467242254951752, 'f1-score': 0.4342202695364565, 'support': 9845}, '1': {'precision': 0.8618938517136311, 'recall': 0.7239361174486658, 'f1-score': 0.7869142351900973, 'support': 50405}, '2': {'precision': 0.34593910090370117, 'recall': 0.6087925445705025, 'f1-score': 0.44118186823270333, 'support': 9872}, 'accuracy': 0.6688057956133596, 'macro avg': {'precision': 0.5434100621927156, 'recall': 0.5931509625047812, 'f1-score': 0.5541054576530857, 'support': 70122}, 'weighted avg': {'precision': 0.727551569665599, 'recall': 0.6688057956133596, 'f1-score': 0.6887233390595893, 'support': 70122}}
[[ 4398  3521  1926]
 [ 4478 36490  9437]
 [ 1536  2326  6010]]
training model: results/QRTEA/W3/deepVOL_L2/h20
Epoch 1/50
641/641 - 17s - loss: 2.9905 - accuracy20: 0.5179 - val_loss: 2.6894 - val_accuracy20: 0.5804 - 17s/epoch - 26ms/step
Epoch 2/50
641/641 - 15s - loss: 2.8057 - accuracy20: 0.5658 - val_loss: 2.6038 - val_accuracy20: 0.6046 - 15s/epoch - 23ms/step
Epoch 3/50
641/641 - 15s - loss: 2.7419 - accuracy20: 0.5818 - val_loss: 2.5722 - val_accuracy20: 0.6289 - 15s/epoch - 23ms/step
Epoch 4/50
641/641 - 15s - loss: 2.7090 - accuracy20: 0.5901 - val_loss: 2.5621 - val_accuracy20: 0.6264 - 15s/epoch - 23ms/step
Epoch 5/50
641/641 - 14s - loss: 2.6894 - accuracy20: 0.5966 - val_loss: 2.5408 - val_accuracy20: 0.6475 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 15s - loss: 2.6746 - accuracy20: 0.5988 - val_loss: 2.5100 - val_accuracy20: 0.6492 - 15s/epoch - 24ms/step
Epoch 7/50
641/641 - 15s - loss: 2.6553 - accuracy20: 0.6041 - val_loss: 2.5083 - val_accuracy20: 0.6499 - 15s/epoch - 23ms/step
Epoch 8/50
641/641 - 14s - loss: 2.6445 - accuracy20: 0.6054 - val_loss: 2.5188 - val_accuracy20: 0.6381 - 14s/epoch - 22ms/step
Epoch 9/50
641/641 - 14s - loss: 2.6371 - accuracy20: 0.6075 - val_loss: 2.5153 - val_accuracy20: 0.6397 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 15s - loss: 2.6269 - accuracy20: 0.6095 - val_loss: 2.5234 - val_accuracy20: 0.6425 - 15s/epoch - 23ms/step
Epoch 11/50
641/641 - 14s - loss: 2.6174 - accuracy20: 0.6112 - val_loss: 2.5284 - val_accuracy20: 0.6371 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 2.6100 - accuracy20: 0.6113 - val_loss: 2.5244 - val_accuracy20: 0.6422 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 14s - loss: 2.6040 - accuracy20: 0.6120 - val_loss: 2.5162 - val_accuracy20: 0.6406 - 14s/epoch - 22ms/step
Epoch 14/50
641/641 - 14s - loss: 2.5924 - accuracy20: 0.6139 - val_loss: 2.5162 - val_accuracy20: 0.6378 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 14s - loss: 2.5876 - accuracy20: 0.6144 - val_loss: 2.5202 - val_accuracy20: 0.6446 - 14s/epoch - 22ms/step
Epoch 16/50
641/641 - 14s - loss: 2.5786 - accuracy20: 0.6154 - val_loss: 2.5114 - val_accuracy20: 0.6407 - 14s/epoch - 22ms/step
Epoch 17/50
641/641 - 14s - loss: 2.5719 - accuracy20: 0.6151 - val_loss: 2.5201 - val_accuracy20: 0.6457 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h20
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.766238
{'0': {'precision': 0.48958666306031623, 'recall': 0.43121670204010915, 'f1-score': 0.4585516391649298, 'support': 46174}, '1': {'precision': 0.8715470025360698, 'recall': 0.7353842391460713, 'f1-score': 0.7976967684928542, 'support': 278056}, '2': {'precision': 0.28643777463320175, 'recall': 0.5976955353773061, 'f1-score': 0.3872777490074228, 'support': 45043}, 'accuracy': 0.6805561197271396, 'macro avg': {'precision': 0.5491904800765292, 'recall': 0.5880988255211622, 'f1-score': 0.5478420522217357, 'support': 369273}, 'weighted avg': {'precision': 0.752416408998545, 'recall': 0.6805561197271396, 'f1-score': 0.7052280770470407, 'support': 369273}}
[[ 19911  18000   8263]
 [ 14774 204478  58804]
 [  5984  12137  26922]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8737419
{'0': {'precision': 0.46304767713733863, 'recall': 0.5110799438990182, 'f1-score': 0.4858796234566255, 'support': 35650}, '1': {'precision': 0.7573523501108164, 'recall': 0.7025705489448285, 'f1-score': 0.7289336398602945, 'support': 93871}, '2': {'precision': 0.4250385167082824, 'recall': 0.4630722926433987, 'f1-score': 0.4432409972299169, 'support': 34554}, 'accuracy': 0.610525674234344, 'macro avg': {'precision': 0.5484795146521458, 'recall': 0.5589075951624152, 'f1-score': 0.5526847535156123, 'support': 164075}, 'weighted avg': {'precision': 0.6234213198448061, 'recall': 0.610525674234344, 'f1-score': 0.615956652151985, 'support': 164075}}
[[18220 11862  5568]
 [11843 65951 16077]
 [ 9285  9268 16001]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81703955
{'0': {'precision': 0.4824348117716106, 'recall': 0.44193548387096776, 'f1-score': 0.46129795165751397, 'support': 13020}, '1': {'precision': 0.7737363864842223, 'recall': 0.756346678798908, 'f1-score': 0.7649427138453043, 'support': 43960}, '2': {'precision': 0.42856204427511, 'recall': 0.4964236798052047, 'f1-score': 0.4600035254715318, 'support': 13142}, 'accuracy': 0.6492541570405864, 'macro avg': {'precision': 0.5615777475103143, 'recall': 0.5649019474916935, 'f1-score': 0.5620813969914501, 'support': 70122}, 'weighted avg': {'precision': 0.654957291363285, 'recall': 0.6492541570405864, 'f1-score': 0.6514125005414461, 'support': 70122}}
[[ 5754  5361  1905]
 [ 3917 33249  6794]
 [ 2256  4362  6524]]
training model: results/QRTEA/W3/deepVOL_L2/h30
Epoch 1/50
641/641 - 17s - loss: 3.0222 - accuracy30: 0.5041 - val_loss: 2.7861 - val_accuracy30: 0.5671 - 17s/epoch - 26ms/step
Epoch 2/50
641/641 - 14s - loss: 2.8446 - accuracy30: 0.5599 - val_loss: 2.7312 - val_accuracy30: 0.5856 - 14s/epoch - 22ms/step
Epoch 3/50
641/641 - 14s - loss: 2.7927 - accuracy30: 0.5712 - val_loss: 2.7148 - val_accuracy30: 0.5907 - 14s/epoch - 22ms/step
Epoch 4/50
641/641 - 15s - loss: 2.7633 - accuracy30: 0.5784 - val_loss: 2.6760 - val_accuracy30: 0.5988 - 15s/epoch - 23ms/step
Epoch 5/50
641/641 - 14s - loss: 2.7428 - accuracy30: 0.5826 - val_loss: 2.6645 - val_accuracy30: 0.6067 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 14s - loss: 2.7270 - accuracy30: 0.5857 - val_loss: 2.6499 - val_accuracy30: 0.6152 - 14s/epoch - 23ms/step
Epoch 7/50
641/641 - 14s - loss: 2.7169 - accuracy30: 0.5881 - val_loss: 2.6473 - val_accuracy30: 0.6152 - 14s/epoch - 23ms/step
Epoch 8/50
641/641 - 14s - loss: 2.7072 - accuracy30: 0.5898 - val_loss: 2.6612 - val_accuracy30: 0.6033 - 14s/epoch - 22ms/step
Epoch 9/50
641/641 - 14s - loss: 2.6988 - accuracy30: 0.5917 - val_loss: 2.6486 - val_accuracy30: 0.6126 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 15s - loss: 2.6924 - accuracy30: 0.5926 - val_loss: 2.6654 - val_accuracy30: 0.5975 - 15s/epoch - 23ms/step
Epoch 11/50
641/641 - 14s - loss: 2.6837 - accuracy30: 0.5923 - val_loss: 2.6513 - val_accuracy30: 0.6025 - 14s/epoch - 23ms/step
Epoch 12/50
641/641 - 14s - loss: 2.6756 - accuracy30: 0.5932 - val_loss: 2.6461 - val_accuracy30: 0.6115 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 14s - loss: 2.6696 - accuracy30: 0.5939 - val_loss: 2.6430 - val_accuracy30: 0.6162 - 14s/epoch - 23ms/step
Epoch 14/50
641/641 - 14s - loss: 2.6627 - accuracy30: 0.5957 - val_loss: 2.6384 - val_accuracy30: 0.6165 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 14s - loss: 2.6565 - accuracy30: 0.5958 - val_loss: 2.6367 - val_accuracy30: 0.6058 - 14s/epoch - 22ms/step
Epoch 16/50
641/641 - 14s - loss: 2.6462 - accuracy30: 0.5974 - val_loss: 2.6339 - val_accuracy30: 0.6074 - 14s/epoch - 22ms/step
Epoch 17/50
641/641 - 15s - loss: 2.6389 - accuracy30: 0.5987 - val_loss: 2.6413 - val_accuracy30: 0.6141 - 15s/epoch - 23ms/step
Epoch 18/50
641/641 - 15s - loss: 2.6372 - accuracy30: 0.5991 - val_loss: 2.6379 - val_accuracy30: 0.6029 - 15s/epoch - 24ms/step
Epoch 19/50
641/641 - 14s - loss: 2.6254 - accuracy30: 0.6007 - val_loss: 2.6416 - val_accuracy30: 0.5970 - 14s/epoch - 22ms/step
Epoch 20/50
641/641 - 15s - loss: 2.6195 - accuracy30: 0.6022 - val_loss: 2.6454 - val_accuracy30: 0.6042 - 15s/epoch - 23ms/step
Epoch 21/50
641/641 - 15s - loss: 2.6084 - accuracy30: 0.6029 - val_loss: 2.6566 - val_accuracy30: 0.5979 - 15s/epoch - 23ms/step
Epoch 22/50
641/641 - 14s - loss: 2.6026 - accuracy30: 0.6036 - val_loss: 2.6613 - val_accuracy30: 0.5956 - 14s/epoch - 22ms/step
Epoch 23/50
641/641 - 15s - loss: 2.5937 - accuracy30: 0.6042 - val_loss: 2.6645 - val_accuracy30: 0.5975 - 15s/epoch - 23ms/step
Epoch 24/50
641/641 - 14s - loss: 2.5902 - accuracy30: 0.6035 - val_loss: 2.6679 - val_accuracy30: 0.5898 - 14s/epoch - 22ms/step
Epoch 25/50
641/641 - 14s - loss: 2.5782 - accuracy30: 0.6067 - val_loss: 2.6661 - val_accuracy30: 0.5971 - 14s/epoch - 23ms/step
Epoch 26/50
641/641 - 14s - loss: 2.5720 - accuracy30: 0.6076 - val_loss: 2.6743 - val_accuracy30: 0.6004 - 14s/epoch - 23ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h30
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7880506
{'0': {'precision': 0.5888151889490659, 'recall': 0.3498761548335774, 'f1-score': 0.43893532327024054, 'support': 55311}, '1': {'precision': 0.8174441004040733, 'recall': 0.7524530450067889, 'f1-score': 0.7836033134653593, 'support': 259983}, '2': {'precision': 0.3286505860300328, 'recall': 0.5911558198558698, 'f1-score': 0.42244477835218736, 'support': 53979}, 'accuracy': 0.6685758233068759, 'macro avg': {'precision': 0.5783032917943907, 'recall': 0.5644950065654121, 'f1-score': 0.5483278050292625, 'support': 369273}, 'weighted avg': {'precision': 0.7117491840850242, 'recall': 0.6685758233068759, 'f1-score': 0.6791848811062209, 'support': 369273}}
[[ 19352  25942  10017]
 [  9191 195625  55167]
 [  4323  17746  31910]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8947503
{'0': {'precision': 0.5279803761242845, 'recall': 0.3957878735871724, 'f1-score': 0.45242566071578705, 'support': 40787}, '1': {'precision': 0.6814346471377561, 'recall': 0.7169915168048626, 'f1-score': 0.6987610413083404, 'support': 83577}, '2': {'precision': 0.4546990913480532, 'recall': 0.5216942408904334, 'f1-score': 0.4858982327348633, 'support': 39711}, 'accuracy': 0.5898765808319366, 'macro avg': {'precision': 0.5547047048700313, 'recall': 0.5448245437608228, 'f1-score': 0.5456949782529968, 'support': 164075}, 'weighted avg': {'precision': 0.5884111212636659, 'recall': 0.5898765808319366, 'f1-score': 0.5860060441455196, 'support': 164075}}
[[16143 15651  8993]
 [ 7801 59924 15852]
 [ 6631 12363 20717]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8671789
{'0': {'precision': 0.5393247650105506, 'recall': 0.37142479688222474, 'f1-score': 0.4398982984549189, 'support': 15139}, '1': {'precision': 0.7021339004179805, 'recall': 0.7264978881610562, 'f1-score': 0.7141081417029211, 'support': 39539}, '2': {'precision': 0.43854138940644133, 'recall': 0.5334110334110335, 'f1-score': 0.48134622688363676, 'support': 15444}, 'accuracy': 0.6073129688257608, 'macro avg': {'precision': 0.5600000182783241, 'recall': 0.5437779061514382, 'f1-score': 0.5451175556804922, 'support': 70122}, 'weighted avg': {'precision': 0.608929339210438, 'recall': 0.6073129688257608, 'f1-score': 0.6036429834159279, 'support': 70122}}
[[ 5623  6858  2658]
 [ 2925 28725  7889]
 [ 1878  5328  8238]]
training model: results/QRTEA/W3/deepVOL_L2/h50
Epoch 1/50
641/641 - 17s - loss: 3.0979 - accuracy50: 0.4723 - val_loss: 2.9935 - val_accuracy50: 0.5107 - 17s/epoch - 27ms/step
Epoch 2/50
641/641 - 14s - loss: 2.9534 - accuracy50: 0.5221 - val_loss: 2.9211 - val_accuracy50: 0.5285 - 14s/epoch - 23ms/step
Epoch 3/50
641/641 - 14s - loss: 2.8998 - accuracy50: 0.5343 - val_loss: 2.8990 - val_accuracy50: 0.5358 - 14s/epoch - 22ms/step
Epoch 4/50
641/641 - 15s - loss: 2.8740 - accuracy50: 0.5413 - val_loss: 2.8687 - val_accuracy50: 0.5468 - 15s/epoch - 23ms/step
Epoch 5/50
641/641 - 14s - loss: 2.8586 - accuracy50: 0.5448 - val_loss: 2.8478 - val_accuracy50: 0.5521 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 14s - loss: 2.8401 - accuracy50: 0.5496 - val_loss: 2.8521 - val_accuracy50: 0.5508 - 14s/epoch - 22ms/step
Epoch 7/50
641/641 - 14s - loss: 2.8259 - accuracy50: 0.5524 - val_loss: 2.8651 - val_accuracy50: 0.5523 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 15s - loss: 2.8182 - accuracy50: 0.5538 - val_loss: 2.8592 - val_accuracy50: 0.5496 - 15s/epoch - 23ms/step
Epoch 9/50
641/641 - 14s - loss: 2.8095 - accuracy50: 0.5556 - val_loss: 2.8583 - val_accuracy50: 0.5486 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 14s - loss: 2.8014 - accuracy50: 0.5566 - val_loss: 2.8607 - val_accuracy50: 0.5473 - 14s/epoch - 22ms/step
Epoch 11/50
641/641 - 14s - loss: 2.7923 - accuracy50: 0.5580 - val_loss: 2.8789 - val_accuracy50: 0.5416 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 2.7851 - accuracy50: 0.5588 - val_loss: 2.8800 - val_accuracy50: 0.5435 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 15s - loss: 2.7780 - accuracy50: 0.5620 - val_loss: 2.8734 - val_accuracy50: 0.5435 - 15s/epoch - 23ms/step
Epoch 14/50
641/641 - 14s - loss: 2.7703 - accuracy50: 0.5618 - val_loss: 2.8844 - val_accuracy50: 0.5410 - 14s/epoch - 22ms/step
Epoch 15/50
641/641 - 14s - loss: 2.7629 - accuracy50: 0.5642 - val_loss: 2.8809 - val_accuracy50: 0.5371 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h50
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88073134
{'0': {'precision': 0.5394216717376201, 'recall': 0.3199113409678611, 'f1-score': 0.4016303523808675, 'support': 70382}, '1': {'precision': 0.7291850297923351, 'recall': 0.7188351269273714, 'f1-score': 0.7239730897555106, 'support': 230171}, '2': {'precision': 0.35162181500178874, 'recall': 0.5148864959254947, 'f1-score': 0.41787325507239526, 'support': 68720}, 'accuracy': 0.60484790385433, 'macro avg': {'precision': 0.5400761721772479, 'recall': 0.517877654606909, 'f1-score': 0.5144922324029245, 'support': 369273}, 'weighted avg': {'precision': 0.6227540998651179, 'recall': 0.60484790385433, 'f1-score': 0.6055720499250171, 'support': 369273}}
[[ 22516  36057  11809]
 [ 11280 165455  53436]
 [  7945  25392  35383]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9561265
{'0': {'precision': 0.486327370263451, 'recall': 0.4458963778083448, 'f1-score': 0.4652351182386518, 'support': 47982}, '1': {'precision': 0.5886541279921836, 'recall': 0.6987894164552374, 'f1-score': 0.6390109707997745, 'support': 68975}, '2': {'precision': 0.48057693314486155, 'recall': 0.38963877923511187, 'f1-score': 0.4303563056727614, 'support': 47118}, 'accuracy': 0.5360536340088374, 'macro avg': {'precision': 0.5185194771334988, 'recall': 0.5114415244995647, 'f1-score': 0.511534131570396, 'support': 164075}, 'weighted avg': {'precision': 0.5276928373863254, 'recall': 0.5360536340088374, 'f1-score': 0.5282719583417986, 'support': 164075}}
[[21395 18661  7926]
 [ 8859 48199 11917]
 [13739 15020 18359]]
Evaluating performance on  val set...
274/274 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9400632
{'0': {'precision': 0.524411839109537, 'recall': 0.3400032803017878, 'f1-score': 0.41253731343283584, 'support': 18291}, '1': {'precision': 0.5885631559898661, 'recall': 0.7381305413501982, 'f1-score': 0.6549159641303764, 'support': 33047}, '2': {'precision': 0.48061600665953147, 'recall': 0.43031303236797275, 'f1-score': 0.4540756137295658, 'support': 18784}, 'accuracy': 0.5518239639485468, 'macro avg': {'precision': 0.5311970005863116, 'recall': 0.5028156180066529, 'f1-score': 0.5071762970975927, 'support': 70122}, 'weighted avg': {'precision': 0.5429131318878851, 'recall': 0.5518239639485468, 'f1-score': 0.5378923047675866, 'support': 70122}}
[[ 6219  9338  2734]
 [ 2653 24393  6001]
 [ 2987  7714  8083]]
training model: results/QRTEA/W3/deepVOL_L2/h100
Epoch 1/50
641/641 - 18s - loss: 3.1960 - accuracy100: 0.4277 - val_loss: 3.1955 - val_accuracy100: 0.4384 - 18s/epoch - 28ms/step
Epoch 2/50
641/641 - 15s - loss: 3.0993 - accuracy100: 0.4630 - val_loss: 3.1542 - val_accuracy100: 0.4456 - 15s/epoch - 23ms/step
Epoch 3/50
641/641 - 15s - loss: 3.0680 - accuracy100: 0.4715 - val_loss: 3.1228 - val_accuracy100: 0.4499 - 15s/epoch - 23ms/step
Epoch 4/50
641/641 - 15s - loss: 3.0528 - accuracy100: 0.4762 - val_loss: 3.1123 - val_accuracy100: 0.4529 - 15s/epoch - 23ms/step
Epoch 5/50
641/641 - 15s - loss: 3.0356 - accuracy100: 0.4816 - val_loss: 3.1098 - val_accuracy100: 0.4543 - 15s/epoch - 23ms/step
Epoch 6/50
641/641 - 15s - loss: 3.0214 - accuracy100: 0.4871 - val_loss: 3.1063 - val_accuracy100: 0.4555 - 15s/epoch - 23ms/step
Epoch 7/50
641/641 - 14s - loss: 3.0096 - accuracy100: 0.4901 - val_loss: 3.1083 - val_accuracy100: 0.4553 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 15s - loss: 3.0016 - accuracy100: 0.4917 - val_loss: 3.0991 - val_accuracy100: 0.4594 - 15s/epoch - 23ms/step
Epoch 9/50
641/641 - 14s - loss: 2.9915 - accuracy100: 0.4942 - val_loss: 3.0990 - val_accuracy100: 0.4566 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 14s - loss: 2.9859 - accuracy100: 0.4960 - val_loss: 3.1066 - val_accuracy100: 0.4564 - 14s/epoch - 22ms/step
Epoch 11/50
641/641 - 14s - loss: 2.9774 - accuracy100: 0.4972 - val_loss: 3.1209 - val_accuracy100: 0.4534 - 14s/epoch - 23ms/step
Epoch 12/50
641/641 - 15s - loss: 2.9689 - accuracy100: 0.5009 - val_loss: 3.1164 - val_accuracy100: 0.4567 - 15s/epoch - 23ms/step
Epoch 13/50
641/641 - 14s - loss: 2.9591 - accuracy100: 0.5042 - val_loss: 3.1226 - val_accuracy100: 0.4557 - 14s/epoch - 22ms/step
Epoch 14/50
641/641 - 14s - loss: 2.9562 - accuracy100: 0.5028 - val_loss: 3.1195 - val_accuracy100: 0.4553 - 14s/epoch - 23ms/step
Epoch 15/50
641/641 - 14s - loss: 2.9491 - accuracy100: 0.5049 - val_loss: 3.1273 - val_accuracy100: 0.4537 - 14s/epoch - 22ms/step
Epoch 16/50
641/641 - 14s - loss: 2.9417 - accuracy100: 0.5066 - val_loss: 3.1356 - val_accuracy100: 0.4527 - 14s/epoch - 23ms/step
Epoch 17/50
641/641 - 15s - loss: 2.9361 - accuracy100: 0.5093 - val_loss: 3.1435 - val_accuracy100: 0.4518 - 15s/epoch - 23ms/step
Epoch 18/50
641/641 - 14s - loss: 2.9277 - accuracy100: 0.5108 - val_loss: 3.1597 - val_accuracy100: 0.4490 - 14s/epoch - 23ms/step
Epoch 19/50
641/641 - 15s - loss: 2.9200 - accuracy100: 0.5131 - val_loss: 3.1583 - val_accuracy100: 0.4479 - 15s/epoch - 23ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h100
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0090388
{'0': {'precision': 0.48270623145400593, 'recall': 0.21820406060866207, 'f1-score': 0.300547619223578, 'support': 93188}, '1': {'precision': 0.6020955849428341, 'recall': 0.5437077452259519, 'f1-score': 0.5714140014788499, 'support': 185482}, '2': {'precision': 0.3438457153952635, 'recall': 0.6058960520071079, 'f1-score': 0.4387187519979541, 'support': 90603}, 'accuracy': 0.47682337999258, 'macro avg': {'precision': 0.47621584393070115, 'recall': 0.4559359526139073, 'f1-score': 0.436893457566794, 'support': 369273}, 'weighted avg': {'precision': 0.5086041355177868, 'recall': 0.47682337999258, 'f1-score': 0.4705019821372736, 'support': 369273}}
[[ 20334  40316  32538]
 [ 12415 100848  72219]
 [  9376  26331  54896]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0176305
{'0': {'precision': 0.49280781723394385, 'recall': 0.32637382501807666, 'f1-score': 0.3926835368704938, 'support': 55320}, '1': {'precision': 0.4789700943547097, 'recall': 0.5538706217405778, 'f1-score': 0.513704504133649, 'support': 54074}, '2': {'precision': 0.45057620016022676, 'recall': 0.5348475704540883, 'f1-score': 0.4891085300487503, 'support': 54681}, 'accuracy': 0.4708273655340545, 'macro avg': {'precision': 0.47411803724962676, 'recall': 0.47169733907091427, 'f1-score': 0.4651655236842977, 'support': 164075}, 'weighted avg': {'precision': 0.47417287540746433, 'recall': 0.4708273655340545, 'f1-score': 0.4647036669071727, 'support': 164075}}
[[18055 18156 19109]
 [ 7571 29950 16553]
 [11011 14424 29246]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0334408
{'0': {'precision': 0.4875724163707718, 'recall': 0.24122786741250982, 'f1-score': 0.32276621408468126, 'support': 21631}, '1': {'precision': 0.4558665552637861, 'recall': 0.5919941098969232, 'f1-score': 0.5150881688526248, 'support': 25806}, '2': {'precision': 0.44329936699089084, 'recall': 0.5062816839321137, 'f1-score': 0.4727018294816126, 'support': 22685}, 'accuracy': 0.4560622914349277, 'macro avg': {'precision': 0.4622461128751496, 'recall': 0.44650122041384893, 'f1-score': 0.43685207080630617, 'support': 70122}, 'weighted avg': {'precision': 0.4615814923111404, 'recall': 0.4560622914349277, 'f1-score': 0.44204903260128, 'support': 70122}}
[[ 5218  9878  6535]
 [ 2641 15277  7888]
 [ 2843  8357 11485]]
training model: results/QRTEA/W3/deepVOL_L2/h200
Epoch 1/50
641/641 - 17s - loss: 3.2766 - accuracy200: 0.3902 - val_loss: 3.3006 - val_accuracy200: 0.3637 - 17s/epoch - 26ms/step
Epoch 2/50
641/641 - 15s - loss: 3.2367 - accuracy200: 0.4006 - val_loss: 3.2872 - val_accuracy200: 0.3750 - 15s/epoch - 24ms/step
Epoch 3/50
641/641 - 14s - loss: 3.2209 - accuracy200: 0.4083 - val_loss: 3.2979 - val_accuracy200: 0.3740 - 14s/epoch - 22ms/step
Epoch 4/50
641/641 - 14s - loss: 3.2106 - accuracy200: 0.4143 - val_loss: 3.3026 - val_accuracy200: 0.3763 - 14s/epoch - 22ms/step
Epoch 5/50
641/641 - 14s - loss: 3.2031 - accuracy200: 0.4172 - val_loss: 3.3081 - val_accuracy200: 0.3749 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 14s - loss: 3.2004 - accuracy200: 0.4186 - val_loss: 3.3007 - val_accuracy200: 0.3740 - 14s/epoch - 22ms/step
Epoch 7/50
641/641 - 14s - loss: 3.1930 - accuracy200: 0.4211 - val_loss: 3.2923 - val_accuracy200: 0.3785 - 14s/epoch - 23ms/step
Epoch 8/50
641/641 - 14s - loss: 3.1867 - accuracy200: 0.4243 - val_loss: 3.2990 - val_accuracy200: 0.3749 - 14s/epoch - 22ms/step
Epoch 9/50
641/641 - 14s - loss: 3.1810 - accuracy200: 0.4266 - val_loss: 3.3120 - val_accuracy200: 0.3740 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 15s - loss: 3.1747 - accuracy200: 0.4294 - val_loss: 3.3068 - val_accuracy200: 0.3756 - 15s/epoch - 23ms/step
Epoch 11/50
641/641 - 14s - loss: 3.1657 - accuracy200: 0.4332 - val_loss: 3.3163 - val_accuracy200: 0.3751 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 3.1608 - accuracy200: 0.4376 - val_loss: 3.3264 - val_accuracy200: 0.3754 - 14s/epoch - 22ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h200
Evaluating performance on  test set...
1443/1443 - 12s - 12s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992142
{'0': {'precision': 0.3845082836230792, 'recall': 0.2633503639417693, 'f1-score': 0.3126002772715236, 'support': 114304}, '1': {'precision': 0.436495791889824, 'recall': 0.13986271144888454, 'f1-score': 0.2118455254363164, 'support': 146844}, '2': {'precision': 0.3315609960071167, 'recall': 0.74801387283237, 'f1-score': 0.45946276050321117, 'support': 108125}, 'accuracy': 0.3561565562605444, 'macro avg': {'precision': 0.38418835717334, 'recall': 0.38374231607434134, 'f1-score': 0.3279695210703504, 'support': 369273}, 'weighted avg': {'precision': 0.38967824782421473, 'recall': 0.3561565562605444, 'f1-score': 0.3155365201621142, 'support': 369273}}
[[30102 16225 67977]
 [31228 20538 95078]
 [16957 10289 80879]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0950495
{'0': {'precision': 0.39083086851304116, 'recall': 0.36717128886162287, 'f1-score': 0.3786318345474337, 'support': 55421}, '1': {'precision': 0.3997175141242938, 'recall': 0.1296309868445161, 'f1-score': 0.19577188079360247, 'support': 54578}, '2': {'precision': 0.36505529694938976, 'recall': 0.636659516236408, 'f1-score': 0.4640361222495535, 'support': 54076}, 'accuracy': 0.37697394484229774, 'macro avg': {'precision': 0.38520122652890826, 'recall': 0.3778205973141824, 'f1-score': 0.3461466125301966, 'support': 164075}, 'weighted avg': {'precision': 0.385291789045084, 'recall': 0.37697394484229774, 'f1-score': 0.3459528262024892, 'support': 164075}}
[[20349  6032 29040]
 [16662  7075 30841]
 [15055  4593 34428]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959575
{'0': {'precision': 0.37612744523837416, 'recall': 0.2933357694240168, 'f1-score': 0.3296122359945595, 'support': 21893}, '1': {'precision': 0.3770305676855895, 'recall': 0.1729290177856113, 'f1-score': 0.23710660734882189, 'support': 24964}, '2': {'precision': 0.3705947401317371, 'recall': 0.6626262626262627, 'f1-score': 0.4753403327012319, 'support': 23265}, 'accuracy': 0.37299278400501984, 'macro avg': {'precision': 0.3745842510185669, 'recall': 0.37629701661196363, 'f1-score': 0.3473530586815377, 'support': 70122}, 'weighted avg': {'precision': 0.37461332933275787, 'recall': 0.37299278400501984, 'f1-score': 0.34502899045633384, 'support': 70122}}
[[ 6422  3894 11577]
 [ 6042  4317 14605]
 [ 4610  3239 15416]]
training model: results/QRTEA/W3/deepVOL_L2/h300
Epoch 1/50
641/641 - 17s - loss: 3.3133 - accuracy300: 0.3689 - val_loss: 3.3327 - val_accuracy300: 0.3379 - 17s/epoch - 26ms/step
Epoch 2/50
641/641 - 14s - loss: 3.2748 - accuracy300: 0.3779 - val_loss: 3.3076 - val_accuracy300: 0.3503 - 14s/epoch - 22ms/step
Epoch 3/50
641/641 - 14s - loss: 3.2536 - accuracy300: 0.3877 - val_loss: 3.3029 - val_accuracy300: 0.3565 - 14s/epoch - 22ms/step
Epoch 4/50
641/641 - 14s - loss: 3.2484 - accuracy300: 0.3923 - val_loss: 3.3042 - val_accuracy300: 0.3603 - 14s/epoch - 22ms/step
Epoch 5/50
641/641 - 14s - loss: 3.2404 - accuracy300: 0.3974 - val_loss: 3.3063 - val_accuracy300: 0.3621 - 14s/epoch - 22ms/step
Epoch 6/50
641/641 - 14s - loss: 3.2331 - accuracy300: 0.4031 - val_loss: 3.3155 - val_accuracy300: 0.3620 - 14s/epoch - 22ms/step
Epoch 7/50
641/641 - 14s - loss: 3.2239 - accuracy300: 0.4086 - val_loss: 3.3166 - val_accuracy300: 0.3629 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 14s - loss: 3.2169 - accuracy300: 0.4138 - val_loss: 3.3122 - val_accuracy300: 0.3631 - 14s/epoch - 22ms/step
Epoch 9/50
641/641 - 14s - loss: 3.2098 - accuracy300: 0.4168 - val_loss: 3.3139 - val_accuracy300: 0.3628 - 14s/epoch - 22ms/step
Epoch 10/50
641/641 - 14s - loss: 3.2003 - accuracy300: 0.4211 - val_loss: 3.3214 - val_accuracy300: 0.3626 - 14s/epoch - 22ms/step
Epoch 11/50
641/641 - 15s - loss: 3.1892 - accuracy300: 0.4279 - val_loss: 3.3397 - val_accuracy300: 0.3601 - 15s/epoch - 24ms/step
Epoch 12/50
641/641 - 14s - loss: 3.1795 - accuracy300: 0.4334 - val_loss: 3.3539 - val_accuracy300: 0.3598 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 15s - loss: 3.1701 - accuracy300: 0.4360 - val_loss: 3.3594 - val_accuracy300: 0.3619 - 15s/epoch - 23ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h300
Evaluating performance on  test set...
1443/1443 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933131
{'0': {'precision': 0.43394484827506635, 'recall': 0.03099248467268772, 'f1-score': 0.05785308301094456, 'support': 121352}, '1': {'precision': 0.3782471087902225, 'recall': 0.6520023687911762, 'f1-score': 0.47875396452244995, 'support': 135090}, '2': {'precision': 0.36756820227797565, 'recall': 0.41615336210793136, 'f1-score': 0.39035481511040165, 'support': 112831}, 'accuracy': 0.37586013599694534, 'macro avg': {'precision': 0.3932533864477548, 'recall': 0.3663827385239318, 'f1-score': 0.30898728754793203, 'support': 369273}, 'weighted avg': {'precision': 0.3932877978773788, 'recall': 0.37586013599694534, 'f1-score': 0.31342552675284585, 'support': 369273}}
[[ 3761 80478 37113]
 [ 3334 88079 43677]
 [ 1572 64304 46955]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009688
{'0': {'precision': 0.448586118251928, 'recall': 0.06731072693481081, 'f1-score': 0.11705695816562994, 'support': 57034}, '1': {'precision': 0.3424013220619081, 'recall': 0.6240852657797686, 'f1-score': 0.44219469317116883, 'support': 51791}, '2': {'precision': 0.38600107986059984, 'recall': 0.42700452488687785, 'f1-score': 0.40546881042201965, 'support': 55250}, 'accuracy': 0.3641810147798263, 'macro avg': {'precision': 0.39232950672481204, 'recall': 0.3728001725338191, 'f1-score': 0.3215734872529395, 'support': 164075}, 'weighted avg': {'precision': 0.3939937662750991, 'recall': 0.3641810147798263, 'f1-score': 0.316806848586702, 'support': 164075}}
[[ 3839 32944 20251]
 [ 2193 32322 17276]
 [ 2526 29132 23592]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038951
{'0': {'precision': 0.372992700729927, 'recall': 0.04482849372751996, 'f1-score': 0.08003759104080194, 'support': 22798}, '1': {'precision': 0.3376901191520311, 'recall': 0.689736531655525, 'f1-score': 0.4533992015394778, 'support': 22887}, '2': {'precision': 0.3983038526774897, 'recall': 0.3363342472480255, 'f1-score': 0.3647053603123891, 'support': 24437}, 'accuracy': 0.35690653432588915, 'macro avg': {'precision': 0.36966222418648265, 'recall': 0.3569664242103568, 'f1-score': 0.29938071763088964, 'support': 70122}, 'weighted avg': {'precision': 0.3702911011687235, 'recall': 0.35690653432588915, 'f1-score': 0.30110306916710994, 'support': 70122}}
[[ 1022 15554  6222]
 [  907 15786  6194]
 [  811 15407  8219]]
training model: results/QRTEA/W3/deepVOL_L2/h500
Epoch 1/50
641/641 - 19s - loss: 3.2627 - accuracy500: 0.4081 - val_loss: 3.2992 - val_accuracy500: 0.3518 - 19s/epoch - 29ms/step
Epoch 2/50
641/641 - 16s - loss: 3.2407 - accuracy500: 0.4069 - val_loss: 3.2925 - val_accuracy500: 0.3632 - 16s/epoch - 24ms/step
Epoch 3/50
641/641 - 15s - loss: 3.2363 - accuracy500: 0.4059 - val_loss: 3.2878 - val_accuracy500: 0.3628 - 15s/epoch - 23ms/step
Epoch 4/50
641/641 - 15s - loss: 3.2355 - accuracy500: 0.3981 - val_loss: 3.2838 - val_accuracy500: 0.3667 - 15s/epoch - 24ms/step
Epoch 5/50
641/641 - 14s - loss: 3.2411 - accuracy500: 0.4053 - val_loss: 3.2935 - val_accuracy500: 0.3659 - 14s/epoch - 23ms/step
Epoch 6/50
641/641 - 14s - loss: 3.2347 - accuracy500: 0.4063 - val_loss: 3.2866 - val_accuracy500: 0.3750 - 14s/epoch - 22ms/step
Epoch 7/50
641/641 - 15s - loss: 3.2313 - accuracy500: 0.4056 - val_loss: 3.2822 - val_accuracy500: 0.3715 - 15s/epoch - 23ms/step
Epoch 8/50
641/641 - 16s - loss: 3.2203 - accuracy500: 0.4120 - val_loss: 3.2837 - val_accuracy500: 0.3755 - 16s/epoch - 24ms/step
Epoch 9/50
641/641 - 15s - loss: 3.2011 - accuracy500: 0.4208 - val_loss: 3.2870 - val_accuracy500: 0.3762 - 15s/epoch - 23ms/step
Epoch 10/50
641/641 - 14s - loss: 3.2075 - accuracy500: 0.4157 - val_loss: 3.3008 - val_accuracy500: 0.3665 - 14s/epoch - 23ms/step
Epoch 11/50
641/641 - 14s - loss: 3.2005 - accuracy500: 0.4176 - val_loss: 3.2916 - val_accuracy500: 0.3754 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 3.1934 - accuracy500: 0.4234 - val_loss: 3.2928 - val_accuracy500: 0.3781 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 14s - loss: 3.1777 - accuracy500: 0.4342 - val_loss: 3.2986 - val_accuracy500: 0.3767 - 14s/epoch - 23ms/step
Epoch 14/50
641/641 - 15s - loss: 3.1719 - accuracy500: 0.4361 - val_loss: 3.2952 - val_accuracy500: 0.3812 - 15s/epoch - 23ms/step
Epoch 15/50
641/641 - 15s - loss: 3.1719 - accuracy500: 0.4351 - val_loss: 3.2930 - val_accuracy500: 0.3783 - 15s/epoch - 23ms/step
Epoch 16/50
641/641 - 15s - loss: 3.1681 - accuracy500: 0.4405 - val_loss: 3.2965 - val_accuracy500: 0.3798 - 15s/epoch - 23ms/step
Epoch 17/50
641/641 - 15s - loss: 3.1564 - accuracy500: 0.4464 - val_loss: 3.3111 - val_accuracy500: 0.3766 - 15s/epoch - 23ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h500
Evaluating performance on  test set...
1443/1443 - 13s - 13s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0879184
{'0': {'precision': 0.4235466914038343, 'recall': 0.3509829601264111, 'f1-score': 0.3838656692018465, 'support': 140494}, '1': {'precision': 0.32414151925078044, 'recall': 0.0062749916904203135, 'f1-score': 0.012311644681586877, 'support': 99283}, '2': {'precision': 0.3718651241197639, 'recall': 0.7205705195527276, 'f1-score': 0.49056445062469944, 'support': 129496}, 'accuracy': 0.3879108410308904, 'macro avg': {'precision': 0.3731844449247929, 'recall': 0.35927615712318633, 'f1-score': 0.2955805881693776, 'support': 369273}, 'weighted avg': {'precision': 0.3786969462454024, 'recall': 0.3879108410308904, 'f1-score': 0.32138633056265226, 'support': 369273}}
[[49311   880 90303]
 [31347   623 67313]
 [35766   419 93311]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1036407
{'0': {'precision': 0.36369417993055797, 'recall': 0.3864234056541749, 'f1-score': 0.37471443497972273, 'support': 54756}, '1': {'precision': 0.4734982332155477, 'recall': 0.0072163282890839574, 'f1-score': 0.014215998302567368, 'support': 55707}, '2': {'precision': 0.3424815322519229, 'recall': 0.6710624487055137, 'f1-score': 0.453510651708055, 'support': 53612}, 'accuracy': 0.35068109096449795, 'macro avg': {'precision': 0.3932246484660095, 'recall': 0.35490072754959084, 'f1-score': 0.2808136949967817, 'support': 164075}, 'weighted avg': {'precision': 0.3940437269608791, 'recall': 0.35068109096449795, 'f1-score': 0.27806434422406257, 'support': 164075}}
[[21159   219 33378]
 [19612   402 35693]
 [17407   228 35977]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938439
{'0': {'precision': 0.361096140292691, 'recall': 0.3614557828775366, 'f1-score': 0.36127587208096557, 'support': 24097}, '1': {'precision': 0.2992957746478873, 'recall': 0.004235176880916791, 'f1-score': 0.00835216665028987, 'support': 20070}, '2': {'precision': 0.3775838309600367, 'recall': 0.6650741668272009, 'f1-score': 0.4816943855340997, 'support': 25955}, 'accuracy': 0.3715952197598471, 'macro avg': {'precision': 0.34599191530020507, 'recall': 0.3435883755285514, 'f1-score': 0.2837741414217851, 'support': 70122}, 'weighted avg': {'precision': 0.3495106845552584, 'recall': 0.3715952197598471, 'f1-score': 0.30483543610769664, 'support': 70122}}
[[ 8710   107 15280]
 [ 6810    85 13175]
 [ 8601    92 17262]]
training model: results/QRTEA/W3/deepVOL_L2/h1000
Epoch 1/50
641/641 - 17s - loss: 3.2838 - accuracy1000: 0.3932 - val_loss: 3.4612 - val_accuracy1000: 0.3276 - 17s/epoch - 27ms/step
Epoch 2/50
641/641 - 15s - loss: 3.2657 - accuracy1000: 0.3942 - val_loss: 3.4023 - val_accuracy1000: 0.3311 - 15s/epoch - 23ms/step
Epoch 3/50
641/641 - 15s - loss: 3.2786 - accuracy1000: 0.3834 - val_loss: 3.4002 - val_accuracy1000: 0.3303 - 15s/epoch - 23ms/step
Epoch 4/50
641/641 - 15s - loss: 3.2622 - accuracy1000: 0.3907 - val_loss: 3.4008 - val_accuracy1000: 0.3351 - 15s/epoch - 23ms/step
Epoch 5/50
641/641 - 15s - loss: 3.2559 - accuracy1000: 0.3965 - val_loss: 3.4248 - val_accuracy1000: 0.3384 - 15s/epoch - 23ms/step
Epoch 6/50
641/641 - 14s - loss: 3.2372 - accuracy1000: 0.4022 - val_loss: 3.4400 - val_accuracy1000: 0.3394 - 14s/epoch - 22ms/step
Epoch 7/50
641/641 - 14s - loss: 3.2352 - accuracy1000: 0.4056 - val_loss: 3.4355 - val_accuracy1000: 0.3405 - 14s/epoch - 22ms/step
Epoch 8/50
641/641 - 14s - loss: 3.2215 - accuracy1000: 0.4156 - val_loss: 3.4361 - val_accuracy1000: 0.3444 - 14s/epoch - 22ms/step
Epoch 9/50
641/641 - 15s - loss: 3.2066 - accuracy1000: 0.4250 - val_loss: 3.4615 - val_accuracy1000: 0.3446 - 15s/epoch - 23ms/step
Epoch 10/50
641/641 - 14s - loss: 3.2003 - accuracy1000: 0.4288 - val_loss: 3.4885 - val_accuracy1000: 0.3427 - 14s/epoch - 22ms/step
Epoch 11/50
641/641 - 14s - loss: 3.1911 - accuracy1000: 0.4318 - val_loss: 3.5064 - val_accuracy1000: 0.3415 - 14s/epoch - 22ms/step
Epoch 12/50
641/641 - 14s - loss: 3.1748 - accuracy1000: 0.4388 - val_loss: 3.5229 - val_accuracy1000: 0.3439 - 14s/epoch - 22ms/step
Epoch 13/50
641/641 - 16s - loss: 3.1501 - accuracy1000: 0.4492 - val_loss: 3.5494 - val_accuracy1000: 0.3422 - 16s/epoch - 24ms/step
testing model: results/QRTEA/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
1443/1443 - 14s - 14s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.090288
{'0': {'precision': 0.38484428710686985, 'recall': 0.10415957897367892, 'f1-score': 0.16394642944959592, 'support': 144029}, '1': {'precision': 0.2553191489361702, 'recall': 0.00013352917612498332, 'f1-score': 0.00026691875660345886, 'support': 89868}, '2': {'precision': 0.3681580891704316, 'recall': 0.8981060158373715, 'f1-score': 0.5222370173102531, 'support': 135376}, 'accuracy': 0.3699051920936543, 'macro avg': {'precision': 0.3361071750711572, 'recall': 0.33413304132905847, 'f1-score': 0.22881678850548415, 'support': 369273}, 'weighted avg': {'precision': 0.3472052616461194, 'recall': 0.3699051920936543, 'f1-score': 0.2554624524333139, 'support': 369273}}
[[ 15002     13 129014]
 [ 10208     12  79648]
 [ 13772     22 121582]]
Evaluating performance on  train set...
641/641 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1250565
{'0': {'precision': 0.3762423505924222, 'recall': 0.1550583100808471, 'f1-score': 0.2196101280573535, 'support': 55908}, '1': {'precision': 0.32142857142857145, 'recall': 0.00016591390911604756, 'f1-score': 0.0003316566248410812, 'support': 54245}, '2': {'precision': 0.3332836900557423, 'recall': 0.8715366640703238, 'f1-score': 0.48217803496675704, 'support': 53922}, 'accuracy': 0.33931433795520344, 'macro avg': {'precision': 0.34365153735891196, 'recall': 0.342253629353429, 'f1-score': 0.23403993988298388, 'support': 164075}, 'weighted avg': {'precision': 0.3440022753573045, 'recall': 0.33931433795520344, 'f1-score': 0.23340519734586315, 'support': 164075}}
[[ 8669     6 47233]
 [ 7458     9 46778]
 [ 6914    13 46995]]
Evaluating performance on  val set...
274/274 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1324567
{'0': {'precision': 0.3029880651624706, 'recall': 0.16185024896458652, 'f1-score': 0.21099247755399175, 'support': 21489}, '1': {'precision': 0.3888888888888889, 'recall': 0.0002762976119992106, 'f1-score': 0.000552202895120893, 'support': 25335}, '2': {'precision': 0.3348230277185501, 'recall': 0.8425186711305691, 'f1-score': 0.47920608376158097, 'support': 23298}, 'accuracy': 0.3296255098257323, 'macro avg': {'precision': 0.3422333272566365, 'recall': 0.33488173923571823, 'f1-score': 0.23025025473689786, 'support': 70122}, 'weighted avg': {'precision': 0.34460108713475246, 'recall': 0.3296255098257323, 'f1-score': 0.22407448090446552, 'support': 70122}}
[[ 3478     7 18004]
 [ 4336     7 20992]
 [ 3665     4 19629]]
training model: results/QRTEA/W3/deepVOL_L3/h10
Epoch 1/50
641/641 - 26s - loss: 3.2578 - accuracy10: 0.4360 - val_loss: 2.9137 - val_accuracy10: 0.6223 - 26s/epoch - 40ms/step
Epoch 2/50
641/641 - 23s - loss: 3.0063 - accuracy10: 0.4743 - val_loss: 2.5703 - val_accuracy10: 0.5972 - 23s/epoch - 35ms/step
Epoch 3/50
641/641 - 22s - loss: 2.7612 - accuracy10: 0.5696 - val_loss: 2.4670 - val_accuracy10: 0.6150 - 22s/epoch - 35ms/step
Epoch 4/50
641/641 - 23s - loss: 2.6754 - accuracy10: 0.5922 - val_loss: 2.4547 - val_accuracy10: 0.5996 - 23s/epoch - 36ms/step
Epoch 5/50
641/641 - 22s - loss: 2.6304 - accuracy10: 0.5961 - val_loss: 2.4109 - val_accuracy10: 0.6317 - 22s/epoch - 35ms/step
Epoch 6/50
641/641 - 22s - loss: 2.6084 - accuracy10: 0.6022 - val_loss: 2.4107 - val_accuracy10: 0.6345 - 22s/epoch - 35ms/step
Epoch 7/50
641/641 - 22s - loss: 2.5839 - accuracy10: 0.6056 - val_loss: 2.3968 - val_accuracy10: 0.6341 - 22s/epoch - 35ms/step
Epoch 8/50
641/641 - 23s - loss: 2.5645 - accuracy10: 0.6095 - val_loss: 2.3878 - val_accuracy10: 0.6403 - 23s/epoch - 35ms/step
Epoch 9/50
641/641 - 22s - loss: 2.5496 - accuracy10: 0.6130 - val_loss: 2.3946 - val_accuracy10: 0.6482 - 22s/epoch - 35ms/step
Epoch 10/50
641/641 - 23s - loss: 2.5349 - accuracy10: 0.6151 - val_loss: 2.3606 - val_accuracy10: 0.6647 - 23s/epoch - 35ms/step
Epoch 11/50
641/641 - 23s - loss: 2.5238 - accuracy10: 0.6173 - val_loss: 2.3634 - val_accuracy10: 0.6637 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 23s - loss: 2.5117 - accuracy10: 0.6197 - val_loss: 2.3500 - val_accuracy10: 0.6614 - 23s/epoch - 36ms/step
Epoch 13/50
641/641 - 22s - loss: 2.5025 - accuracy10: 0.6202 - val_loss: 2.3492 - val_accuracy10: 0.6588 - 22s/epoch - 35ms/step
Epoch 14/50
641/641 - 23s - loss: 2.4921 - accuracy10: 0.6224 - val_loss: 2.3538 - val_accuracy10: 0.6515 - 23s/epoch - 35ms/step
Epoch 15/50
641/641 - 23s - loss: 2.4850 - accuracy10: 0.6215 - val_loss: 2.3528 - val_accuracy10: 0.6596 - 23s/epoch - 36ms/step
Epoch 16/50
641/641 - 23s - loss: 2.4745 - accuracy10: 0.6242 - val_loss: 2.3380 - val_accuracy10: 0.6552 - 23s/epoch - 35ms/step
Epoch 17/50
641/641 - 22s - loss: 2.4673 - accuracy10: 0.6251 - val_loss: 2.3386 - val_accuracy10: 0.6572 - 22s/epoch - 35ms/step
Epoch 18/50
641/641 - 23s - loss: 2.4595 - accuracy10: 0.6257 - val_loss: 2.3265 - val_accuracy10: 0.6506 - 23s/epoch - 35ms/step
Epoch 19/50
641/641 - 23s - loss: 2.4544 - accuracy10: 0.6259 - val_loss: 2.3228 - val_accuracy10: 0.6567 - 23s/epoch - 36ms/step
Epoch 20/50
641/641 - 22s - loss: 2.4456 - accuracy10: 0.6271 - val_loss: 2.3230 - val_accuracy10: 0.6571 - 22s/epoch - 35ms/step
Epoch 21/50
641/641 - 23s - loss: 2.4436 - accuracy10: 0.6278 - val_loss: 2.3209 - val_accuracy10: 0.6551 - 23s/epoch - 36ms/step
Epoch 22/50
641/641 - 22s - loss: 2.4336 - accuracy10: 0.6277 - val_loss: 2.3236 - val_accuracy10: 0.6515 - 22s/epoch - 35ms/step
Epoch 23/50
641/641 - 23s - loss: 2.4267 - accuracy10: 0.6291 - val_loss: 2.3188 - val_accuracy10: 0.6595 - 23s/epoch - 35ms/step
Epoch 24/50
641/641 - 22s - loss: 2.4206 - accuracy10: 0.6283 - val_loss: 2.3117 - val_accuracy10: 0.6616 - 22s/epoch - 35ms/step
Epoch 25/50
641/641 - 22s - loss: 2.4142 - accuracy10: 0.6305 - val_loss: 2.3293 - val_accuracy10: 0.6520 - 22s/epoch - 35ms/step
Epoch 26/50
641/641 - 23s - loss: 2.4080 - accuracy10: 0.6311 - val_loss: 2.3144 - val_accuracy10: 0.6592 - 23s/epoch - 36ms/step
Epoch 27/50
641/641 - 22s - loss: 2.4070 - accuracy10: 0.6314 - val_loss: 2.3355 - val_accuracy10: 0.6510 - 22s/epoch - 35ms/step
Epoch 28/50
641/641 - 23s - loss: 2.3991 - accuracy10: 0.6308 - val_loss: 2.3240 - val_accuracy10: 0.6520 - 23s/epoch - 36ms/step
Epoch 29/50
641/641 - 23s - loss: 2.3940 - accuracy10: 0.6309 - val_loss: 2.3295 - val_accuracy10: 0.6454 - 23s/epoch - 36ms/step
Epoch 30/50
641/641 - 22s - loss: 2.3874 - accuracy10: 0.6309 - val_loss: 2.3232 - val_accuracy10: 0.6369 - 22s/epoch - 35ms/step
Epoch 31/50
641/641 - 22s - loss: 2.3800 - accuracy10: 0.6333 - val_loss: 2.3184 - val_accuracy10: 0.6628 - 22s/epoch - 35ms/step
Epoch 32/50
641/641 - 23s - loss: 2.3742 - accuracy10: 0.6338 - val_loss: 2.3315 - val_accuracy10: 0.6374 - 23s/epoch - 35ms/step
Epoch 33/50
641/641 - 23s - loss: 2.3668 - accuracy10: 0.6343 - val_loss: 2.3224 - val_accuracy10: 0.6433 - 23s/epoch - 36ms/step
Epoch 34/50
641/641 - 22s - loss: 2.3624 - accuracy10: 0.6352 - val_loss: 2.3190 - val_accuracy10: 0.6558 - 22s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h10
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6953036
{'0': {'precision': 0.4242344729868017, 'recall': 0.47316359379572726, 'f1-score': 0.44736514436712277, 'support': 34170}, '1': {'precision': 0.9279322317292682, 'recall': 0.720419104766257, 'f1-score': 0.8111136174250546, 'support': 301977}, '2': {'precision': 0.2371065800901609, 'recall': 0.692265893859808, 'f1-score': 0.35322930946843084, 'support': 33126}, 'accuracy': 0.6950142577442705, 'macro avg': {'precision': 0.5297577616020769, 'recall': 0.6286161974739307, 'f1-score': 0.5372360237535361, 'support': 369273}, 'weighted avg': {'precision': 0.8193522842312732, 'recall': 0.6950142577442705, 'f1-score': 0.7363798543019433, 'support': 369273}}
[[ 16168  10986   7016]
 [ 17659 217550  66768]
 [  4284   5910  22932]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8421604
{'0': {'precision': 0.39913895808512945, 'recall': 0.5309202233027193, 'f1-score': 0.45569346337542704, 'support': 27765}, '1': {'precision': 0.8646270374633349, 'recall': 0.6377612035676139, 'f1-score': 0.7340653567300619, 'support': 109541}, '2': {'precision': 0.3526238563783877, 'recall': 0.6104822742724794, 'f1-score': 0.447034043193413, 'support': 26769}, 'accuracy': 0.6152308395550815, 'macro avg': {'precision': 0.5387966173089507, 'recall': 0.5930545670476042, 'f1-score': 0.545597621099634, 'support': 164075}, 'weighted avg': {'precision': 0.7023226664232689, 'recall': 0.6152308395550815, 'f1-score': 0.6401294319940937, 'support': 164075}}
[[14741  6717  6307]
 [15985 69861 23695]
 [ 6206  4221 16342]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7583206
{'0': {'precision': 0.42035637149028077, 'recall': 0.4744540375825292, 'f1-score': 0.44576990981533615, 'support': 9845}, '1': {'precision': 0.867493615468807, 'recall': 0.707608372185299, 'f1-score': 0.7794361888111887, 'support': 50405}, '2': {'precision': 0.33875384185526686, 'recall': 0.6140599675850892, 'f1-score': 0.4366334137645407, 'support': 9872}, 'accuracy': 0.6617038875103392, 'macro avg': {'precision': 0.5422012762714515, 'recall': 0.5987074591176391, 'f1-score': 0.5539465041303552, 'support': 70122}, 'weighted avg': {'precision': 0.730278687028639, 'recall': 0.6617038875103392, 'f1-score': 0.684329182280076, 'support': 70122}}
[[ 4671  3215  1959]
 [ 4864 35667  9874]
 [ 1577  2233  6062]]
training model: results/QRTEA/W3/deepVOL_L3/h20
Epoch 1/50
641/641 - 25s - loss: 3.2397 - accuracy20: 0.4374 - val_loss: 2.9979 - val_accuracy20: 0.5536 - 25s/epoch - 40ms/step
Epoch 2/50
641/641 - 24s - loss: 3.0130 - accuracy20: 0.4884 - val_loss: 2.7301 - val_accuracy20: 0.5611 - 24s/epoch - 37ms/step
Epoch 3/50
641/641 - 23s - loss: 2.8094 - accuracy20: 0.5613 - val_loss: 2.5834 - val_accuracy20: 0.6143 - 23s/epoch - 35ms/step
Epoch 4/50
641/641 - 23s - loss: 2.7301 - accuracy20: 0.5828 - val_loss: 2.5398 - val_accuracy20: 0.5899 - 23s/epoch - 36ms/step
Epoch 5/50
641/641 - 23s - loss: 2.6850 - accuracy20: 0.5920 - val_loss: 2.5475 - val_accuracy20: 0.6229 - 23s/epoch - 36ms/step
Epoch 6/50
641/641 - 23s - loss: 2.6617 - accuracy20: 0.5963 - val_loss: 2.5203 - val_accuracy20: 0.6357 - 23s/epoch - 36ms/step
Epoch 7/50
641/641 - 23s - loss: 2.6433 - accuracy20: 0.5985 - val_loss: 2.5105 - val_accuracy20: 0.6416 - 23s/epoch - 35ms/step
Epoch 8/50
641/641 - 22s - loss: 2.6316 - accuracy20: 0.6009 - val_loss: 2.5219 - val_accuracy20: 0.6558 - 22s/epoch - 35ms/step
Epoch 9/50
641/641 - 23s - loss: 2.6203 - accuracy20: 0.6035 - val_loss: 2.5072 - val_accuracy20: 0.6583 - 23s/epoch - 36ms/step
Epoch 10/50
641/641 - 22s - loss: 2.6104 - accuracy20: 0.6060 - val_loss: 2.5102 - val_accuracy20: 0.6527 - 22s/epoch - 35ms/step
Epoch 11/50
641/641 - 23s - loss: 2.5997 - accuracy20: 0.6079 - val_loss: 2.5026 - val_accuracy20: 0.6648 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 22s - loss: 2.5928 - accuracy20: 0.6095 - val_loss: 2.5083 - val_accuracy20: 0.6578 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 22s - loss: 2.5836 - accuracy20: 0.6107 - val_loss: 2.5066 - val_accuracy20: 0.6615 - 22s/epoch - 35ms/step
Epoch 14/50
641/641 - 23s - loss: 2.5772 - accuracy20: 0.6121 - val_loss: 2.4919 - val_accuracy20: 0.6563 - 23s/epoch - 35ms/step
Epoch 15/50
641/641 - 23s - loss: 2.5678 - accuracy20: 0.6137 - val_loss: 2.4877 - val_accuracy20: 0.6534 - 23s/epoch - 35ms/step
Epoch 16/50
641/641 - 22s - loss: 2.5611 - accuracy20: 0.6147 - val_loss: 2.4942 - val_accuracy20: 0.6603 - 22s/epoch - 35ms/step
Epoch 17/50
641/641 - 22s - loss: 2.5536 - accuracy20: 0.6169 - val_loss: 2.4963 - val_accuracy20: 0.6518 - 22s/epoch - 35ms/step
Epoch 18/50
641/641 - 23s - loss: 2.5475 - accuracy20: 0.6171 - val_loss: 2.5077 - val_accuracy20: 0.6505 - 23s/epoch - 35ms/step
Epoch 19/50
641/641 - 23s - loss: 2.5401 - accuracy20: 0.6169 - val_loss: 2.4911 - val_accuracy20: 0.6448 - 23s/epoch - 35ms/step
Epoch 20/50
641/641 - 23s - loss: 2.5345 - accuracy20: 0.6195 - val_loss: 2.4770 - val_accuracy20: 0.6469 - 23s/epoch - 35ms/step
Epoch 21/50
641/641 - 22s - loss: 2.5278 - accuracy20: 0.6196 - val_loss: 2.4726 - val_accuracy20: 0.6488 - 22s/epoch - 34ms/step
Epoch 22/50
641/641 - 23s - loss: 2.5213 - accuracy20: 0.6204 - val_loss: 2.4885 - val_accuracy20: 0.6434 - 23s/epoch - 35ms/step
Epoch 23/50
641/641 - 23s - loss: 2.5157 - accuracy20: 0.6207 - val_loss: 2.4879 - val_accuracy20: 0.6518 - 23s/epoch - 35ms/step
Epoch 24/50
641/641 - 23s - loss: 2.5073 - accuracy20: 0.6228 - val_loss: 2.4796 - val_accuracy20: 0.6409 - 23s/epoch - 35ms/step
Epoch 25/50
641/641 - 23s - loss: 2.5024 - accuracy20: 0.6219 - val_loss: 2.4795 - val_accuracy20: 0.6487 - 23s/epoch - 35ms/step
Epoch 26/50
641/641 - 23s - loss: 2.4952 - accuracy20: 0.6252 - val_loss: 2.4892 - val_accuracy20: 0.6378 - 23s/epoch - 36ms/step
Epoch 27/50
641/641 - 23s - loss: 2.4916 - accuracy20: 0.6239 - val_loss: 2.4939 - val_accuracy20: 0.6412 - 23s/epoch - 35ms/step
Epoch 28/50
641/641 - 23s - loss: 2.4847 - accuracy20: 0.6253 - val_loss: 2.4897 - val_accuracy20: 0.6344 - 23s/epoch - 36ms/step
Epoch 29/50
641/641 - 23s - loss: 2.4775 - accuracy20: 0.6263 - val_loss: 2.5044 - val_accuracy20: 0.6293 - 23s/epoch - 36ms/step
Epoch 30/50
641/641 - 24s - loss: 2.4721 - accuracy20: 0.6262 - val_loss: 2.4945 - val_accuracy20: 0.6352 - 24s/epoch - 37ms/step
Epoch 31/50
641/641 - 23s - loss: 2.4672 - accuracy20: 0.6269 - val_loss: 2.5055 - val_accuracy20: 0.6202 - 23s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h20
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7089483
{'0': {'precision': 0.5335593785609072, 'recall': 0.41577511153462987, 'f1-score': 0.4673604771468566, 'support': 46174}, '1': {'precision': 0.8737654459032524, 'recall': 0.7728407227321115, 'f1-score': 0.8202101165087453, 'support': 278056}, '2': {'precision': 0.3201607271644935, 'recall': 0.6208955886597252, 'f1-score': 0.4224749992446902, 'support': 45043}, 'accuracy': 0.7096592493900177, 'macro avg': {'precision': 0.5758285172095511, 'recall': 0.6031704743088222, 'f1-score': 0.5700151976334307, 'support': 369273}, 'weighted avg': {'precision': 0.7636986598137864, 'recall': 0.7096592493900176, 'f1-score': 0.7275749600396271, 'support': 369273}}
[[ 19198  18760   8216]
 [ 11993 214893  51170]
 [  4790  12286  27967]]
Evaluating performance on  train set...
641/641 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85440433
{'0': {'precision': 0.4861255541568606, 'recall': 0.498288920056101, 'f1-score': 0.49213209219858156, 'support': 35650}, '1': {'precision': 0.7759712435726528, 'recall': 0.6945062905476664, 'f1-score': 0.7329821740768014, 'support': 93871}, '2': {'precision': 0.430889077831652, 'recall': 0.5426578688429704, 'f1-score': 0.4803576231891483, 'support': 34554}, 'accuracy': 0.6198933414596983, 'macro avg': {'precision': 0.5643286251870552, 'recall': 0.5784843598155792, 'f1-score': 0.5684906298215106, 'support': 164075}, 'weighted avg': {'precision': 0.6403200597683709, 'recall': 0.6198933414596983, 'f1-score': 0.6274481551809885, 'support': 164075}}
[[17764 11000  6886]
 [10797 65194 17880]
 [ 7981  7822 18751]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7993448
{'0': {'precision': 0.5083509310808216, 'recall': 0.40675883256528417, 'f1-score': 0.45191569246522734, 'support': 13020}, '1': {'precision': 0.7770480960030237, 'recall': 0.7482711555959963, 'f1-score': 0.762388170398183, 'support': 43960}, '2': {'precision': 0.4194681096016578, 'recall': 0.5544818140313499, 'f1-score': 0.47761683161827356, 'support': 13142}, 'accuracy': 0.6485411140583555, 'macro avg': {'precision': 0.5682890455618343, 'recall': 0.5698372673975435, 'f1-score': 0.5639735648272279, 'support': 70122}, 'weighted avg': {'precision': 0.6601410872386727, 'recall': 0.6485411140583555, 'f1-score': 0.651369993550223, 'support': 70122}}
[[ 5296  5435  2289]
 [ 3270 32894  7796]
 [ 1852  4003  7287]]
training model: results/QRTEA/W3/deepVOL_L3/h30
Epoch 1/50
641/641 - 26s - loss: 3.2196 - accuracy30: 0.4258 - val_loss: 3.0452 - val_accuracy30: 0.5000 - 26s/epoch - 41ms/step
Epoch 2/50
641/641 - 23s - loss: 3.0191 - accuracy30: 0.4920 - val_loss: 2.8195 - val_accuracy30: 0.5507 - 23s/epoch - 36ms/step
Epoch 3/50
641/641 - 23s - loss: 2.8705 - accuracy30: 0.5500 - val_loss: 2.6947 - val_accuracy30: 0.5903 - 23s/epoch - 36ms/step
Epoch 4/50
641/641 - 23s - loss: 2.8056 - accuracy30: 0.5668 - val_loss: 2.6815 - val_accuracy30: 0.5966 - 23s/epoch - 35ms/step
Epoch 5/50
641/641 - 23s - loss: 2.7702 - accuracy30: 0.5753 - val_loss: 2.6695 - val_accuracy30: 0.5982 - 23s/epoch - 35ms/step
Epoch 6/50
641/641 - 23s - loss: 2.7401 - accuracy30: 0.5815 - val_loss: 2.6509 - val_accuracy30: 0.6063 - 23s/epoch - 35ms/step
Epoch 7/50
641/641 - 24s - loss: 2.7160 - accuracy30: 0.5861 - val_loss: 2.6485 - val_accuracy30: 0.6080 - 24s/epoch - 37ms/step
Epoch 8/50
641/641 - 24s - loss: 2.7024 - accuracy30: 0.5874 - val_loss: 2.6256 - val_accuracy30: 0.6083 - 24s/epoch - 37ms/step
Epoch 9/50
641/641 - 23s - loss: 2.6893 - accuracy30: 0.5885 - val_loss: 2.6348 - val_accuracy30: 0.6081 - 23s/epoch - 36ms/step
Epoch 10/50
641/641 - 23s - loss: 2.6754 - accuracy30: 0.5902 - val_loss: 2.6236 - val_accuracy30: 0.6180 - 23s/epoch - 35ms/step
Epoch 11/50
641/641 - 23s - loss: 2.6677 - accuracy30: 0.5908 - val_loss: 2.5987 - val_accuracy30: 0.6239 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 22s - loss: 2.6558 - accuracy30: 0.5925 - val_loss: 2.6191 - val_accuracy30: 0.6149 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 23s - loss: 2.6473 - accuracy30: 0.5940 - val_loss: 2.5984 - val_accuracy30: 0.6173 - 23s/epoch - 36ms/step
Epoch 14/50
641/641 - 23s - loss: 2.6372 - accuracy30: 0.5958 - val_loss: 2.5997 - val_accuracy30: 0.6112 - 23s/epoch - 35ms/step
Epoch 15/50
641/641 - 23s - loss: 2.6301 - accuracy30: 0.5962 - val_loss: 2.6163 - val_accuracy30: 0.6121 - 23s/epoch - 36ms/step
Epoch 16/50
641/641 - 23s - loss: 2.6203 - accuracy30: 0.5975 - val_loss: 2.5919 - val_accuracy30: 0.6114 - 23s/epoch - 36ms/step
Epoch 17/50
641/641 - 23s - loss: 2.6144 - accuracy30: 0.5987 - val_loss: 2.5936 - val_accuracy30: 0.6115 - 23s/epoch - 35ms/step
Epoch 18/50
641/641 - 23s - loss: 2.6055 - accuracy30: 0.6003 - val_loss: 2.5989 - val_accuracy30: 0.6089 - 23s/epoch - 35ms/step
Epoch 19/50
641/641 - 23s - loss: 2.5968 - accuracy30: 0.6004 - val_loss: 2.6039 - val_accuracy30: 0.6067 - 23s/epoch - 35ms/step
Epoch 20/50
641/641 - 23s - loss: 2.5892 - accuracy30: 0.6027 - val_loss: 2.5909 - val_accuracy30: 0.6125 - 23s/epoch - 35ms/step
Epoch 21/50
641/641 - 23s - loss: 2.5806 - accuracy30: 0.6040 - val_loss: 2.6021 - val_accuracy30: 0.6075 - 23s/epoch - 35ms/step
Epoch 22/50
641/641 - 23s - loss: 2.5750 - accuracy30: 0.6042 - val_loss: 2.5982 - val_accuracy30: 0.6100 - 23s/epoch - 36ms/step
Epoch 23/50
641/641 - 23s - loss: 2.5642 - accuracy30: 0.6064 - val_loss: 2.6203 - val_accuracy30: 0.5980 - 23s/epoch - 36ms/step
Epoch 24/50
641/641 - 23s - loss: 2.5582 - accuracy30: 0.6074 - val_loss: 2.6065 - val_accuracy30: 0.6099 - 23s/epoch - 35ms/step
Epoch 25/50
641/641 - 23s - loss: 2.5495 - accuracy30: 0.6077 - val_loss: 2.6071 - val_accuracy30: 0.6130 - 23s/epoch - 35ms/step
Epoch 26/50
641/641 - 23s - loss: 2.5422 - accuracy30: 0.6091 - val_loss: 2.6208 - val_accuracy30: 0.6070 - 23s/epoch - 35ms/step
Epoch 27/50
641/641 - 23s - loss: 2.5357 - accuracy30: 0.6088 - val_loss: 2.6257 - val_accuracy30: 0.6129 - 23s/epoch - 35ms/step
Epoch 28/50
641/641 - 23s - loss: 2.5283 - accuracy30: 0.6123 - val_loss: 2.6184 - val_accuracy30: 0.6061 - 23s/epoch - 37ms/step
Epoch 29/50
641/641 - 22s - loss: 2.5206 - accuracy30: 0.6119 - val_loss: 2.6263 - val_accuracy30: 0.6044 - 22s/epoch - 35ms/step
Epoch 30/50
641/641 - 23s - loss: 2.5142 - accuracy30: 0.6135 - val_loss: 2.6450 - val_accuracy30: 0.5969 - 23s/epoch - 36ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h30
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79843134
{'0': {'precision': 0.5898801989815442, 'recall': 0.36231491023485385, 'f1-score': 0.4489046189686842, 'support': 55311}, '1': {'precision': 0.8235895186931258, 'recall': 0.7223510768011755, 'f1-score': 0.7696554154849921, 'support': 259983}, '2': {'precision': 0.31872290841295736, 'recall': 0.6334129939420886, 'f1-score': 0.4240638991900976, 'support': 53979}, 'accuracy': 0.6554229526664554, 'macro avg': {'precision': 0.5773975420292091, 'recall': 0.5726929936593727, 'f1-score': 0.5475413112145913, 'support': 369273}, 'weighted avg': {'precision': 0.7147841336829016, 'recall': 0.6554229526664554, 'f1-score': 0.6710949148142266, 'support': 369273}}
[[ 20040  24724  10547]
 [  9647 187799  62537]
 [  4286  15502  34191]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8932778
{'0': {'precision': 0.530517616629341, 'recall': 0.41236178194032413, 'f1-score': 0.46403641881638846, 'support': 40787}, '1': {'precision': 0.6910522065116503, 'recall': 0.6859423047010541, 'f1-score': 0.6884877744151415, 'support': 83577}, '2': {'precision': 0.44555076599275495, 'recall': 0.5544055803177961, 'f1-score': 0.49405322920874295, 'support': 39711}, 'accuracy': 0.5860978211183909, 'macro avg': {'precision': 0.5557068630445822, 'recall': 0.5509032223197248, 'f1-score': 0.5488591408134244, 'support': 164075}, 'weighted avg': {'precision': 0.5917267027970344, 'recall': 0.5860978211183909, 'f1-score': 0.5856330575752962, 'support': 164075}}
[[16819 14954  9014]
 [ 7865 57329 18383]
 [ 7019 10676 22016]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85406274
{'0': {'precision': 0.5417843798414289, 'recall': 0.39269436554594095, 'f1-score': 0.4553462009803922, 'support': 15139}, '1': {'precision': 0.7096854780284294, 'recall': 0.7184804876198184, 'f1-score': 0.7140559018700985, 'support': 39539}, '2': {'precision': 0.4467573221757322, 'recall': 0.5530950530950531, 'f1-score': 0.49427149635458867, 'support': 15444}, 'accuracy': 0.6117195744559482, 'macro avg': {'precision': 0.5660757266818636, 'recall': 0.5547566354202709, 'f1-score': 0.5545578664016931, 'support': 70122}, 'weighted avg': {'precision': 0.615527907445131, 'recall': 0.6117195744559482, 'f1-score': 0.6097953770626087, 'support': 70122}}
[[ 5945  6608  2586]
 [ 3139 28408  7992]
 [ 1889  5013  8542]]
training model: results/QRTEA/W3/deepVOL_L3/h50
Epoch 1/50
641/641 - 26s - loss: 3.2533 - accuracy50: 0.4061 - val_loss: 3.1748 - val_accuracy50: 0.4687 - 26s/epoch - 40ms/step
Epoch 2/50
641/641 - 25s - loss: 3.0648 - accuracy50: 0.4788 - val_loss: 2.9755 - val_accuracy50: 0.5178 - 25s/epoch - 39ms/step
Epoch 3/50
641/641 - 25s - loss: 2.9547 - accuracy50: 0.5167 - val_loss: 2.9045 - val_accuracy50: 0.5386 - 25s/epoch - 39ms/step
Epoch 4/50
641/641 - 25s - loss: 2.9055 - accuracy50: 0.5306 - val_loss: 2.8904 - val_accuracy50: 0.5267 - 25s/epoch - 39ms/step
Epoch 5/50
641/641 - 25s - loss: 2.8693 - accuracy50: 0.5385 - val_loss: 2.8501 - val_accuracy50: 0.5422 - 25s/epoch - 39ms/step
Epoch 6/50
641/641 - 25s - loss: 2.8491 - accuracy50: 0.5432 - val_loss: 2.8352 - val_accuracy50: 0.5422 - 25s/epoch - 39ms/step
Epoch 7/50
641/641 - 25s - loss: 2.8294 - accuracy50: 0.5465 - val_loss: 2.8291 - val_accuracy50: 0.5472 - 25s/epoch - 39ms/step
Epoch 8/50
641/641 - 25s - loss: 2.8188 - accuracy50: 0.5491 - val_loss: 2.8183 - val_accuracy50: 0.5468 - 25s/epoch - 39ms/step
Epoch 9/50
641/641 - 22s - loss: 2.8064 - accuracy50: 0.5529 - val_loss: 2.8099 - val_accuracy50: 0.5517 - 22s/epoch - 35ms/step
Epoch 10/50
641/641 - 22s - loss: 2.7969 - accuracy50: 0.5539 - val_loss: 2.8194 - val_accuracy50: 0.5400 - 22s/epoch - 35ms/step
Epoch 11/50
641/641 - 22s - loss: 2.7903 - accuracy50: 0.5553 - val_loss: 2.8017 - val_accuracy50: 0.5499 - 22s/epoch - 35ms/step
Epoch 12/50
641/641 - 22s - loss: 2.7813 - accuracy50: 0.5572 - val_loss: 2.8234 - val_accuracy50: 0.5423 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 22s - loss: 2.7735 - accuracy50: 0.5591 - val_loss: 2.8207 - val_accuracy50: 0.5402 - 22s/epoch - 35ms/step
Epoch 14/50
641/641 - 22s - loss: 2.7653 - accuracy50: 0.5605 - val_loss: 2.8207 - val_accuracy50: 0.5375 - 22s/epoch - 35ms/step
Epoch 15/50
641/641 - 23s - loss: 2.7599 - accuracy50: 0.5620 - val_loss: 2.8298 - val_accuracy50: 0.5353 - 23s/epoch - 36ms/step
Epoch 16/50
641/641 - 22s - loss: 2.7524 - accuracy50: 0.5643 - val_loss: 2.8417 - val_accuracy50: 0.5286 - 22s/epoch - 35ms/step
Epoch 17/50
641/641 - 23s - loss: 2.7458 - accuracy50: 0.5651 - val_loss: 2.8303 - val_accuracy50: 0.5276 - 23s/epoch - 36ms/step
Epoch 18/50
641/641 - 23s - loss: 2.7371 - accuracy50: 0.5672 - val_loss: 2.8365 - val_accuracy50: 0.5274 - 23s/epoch - 36ms/step
Epoch 19/50
641/641 - 22s - loss: 2.7321 - accuracy50: 0.5671 - val_loss: 2.8480 - val_accuracy50: 0.5239 - 22s/epoch - 35ms/step
Epoch 20/50
641/641 - 23s - loss: 2.7238 - accuracy50: 0.5689 - val_loss: 2.8609 - val_accuracy50: 0.5264 - 23s/epoch - 36ms/step
Epoch 21/50
641/641 - 23s - loss: 2.7138 - accuracy50: 0.5715 - val_loss: 2.8508 - val_accuracy50: 0.5263 - 23s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h50
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8742726
{'0': {'precision': 0.6131386861313869, 'recall': 0.29479128186183967, 'f1-score': 0.39815392291380813, 'support': 70382}, '1': {'precision': 0.7410383246697595, 'recall': 0.6912034965308401, 'f1-score': 0.7152539096306053, 'support': 230171}, '2': {'precision': 0.35023438405857116, 'recall': 0.6153667054714784, 'f1-score': 0.4464008613864522, 'support': 68720}, 'accuracy': 0.6015359909876975, 'macro avg': {'precision': 0.5681371316199059, 'recall': 0.5337871612880528, 'f1-score': 0.5199362313102885, 'support': 369273}, 'weighted avg': {'precision': 0.6439343415504721, 'recall': 0.6015359909876975, 'f1-score': 0.6047835726700372, 'support': 369273}}
[[ 20748  32951  16683]
 [  9305 159095  61771]
 [  3786  22646  42288]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.945731
{'0': {'precision': 0.5340751879699248, 'recall': 0.3700971197532408, 'f1-score': 0.43721686035060076, 'support': 47982}, '1': {'precision': 0.6059111980492511, 'recall': 0.6556578470460311, 'f1-score': 0.6298037085779142, 'support': 68975}, '2': {'precision': 0.46400412906900174, 'recall': 0.5533129589541153, 'f1-score': 0.5047383960118097, 'support': 47118}, 'accuracy': 0.5427578851135152, 'macro avg': {'precision': 0.5346635050293925, 'recall': 0.526355975251129, 'f1-score': 0.5239196549801083, 'support': 164075}, 'weighted avg': {'precision': 0.5441515593971857, 'recall': 0.5427578851135152, 'f1-score': 0.5375682702165998, 'support': 164075}}
[[17758 16447 13777]
 [ 7412 45224 16339]
 [ 8080 12967 26071]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9306666
{'0': {'precision': 0.568062317429406, 'recall': 0.3189546771636324, 'f1-score': 0.40852911312629114, 'support': 18291}, '1': {'precision': 0.5968125408229915, 'recall': 0.691227645474627, 'f1-score': 0.6405597150949216, 'support': 33047}, '2': {'precision': 0.46053668257867175, 'recall': 0.5290140545144804, 'f1-score': 0.49240603552934764, 'support': 18784}, 'accuracy': 0.5506688343173326, 'macro avg': {'precision': 0.5418038469436898, 'recall': 0.5130654590509133, 'f1-score': 0.5138316212501868, 'support': 70122}, 'weighted avg': {'precision': 0.5528081476603125, 'recall': 0.5506688343173326, 'f1-score': 0.5403487904554651, 'support': 70122}}
[[ 5834  8389  4068]
 [ 2632 22843  7572]
 [ 1804  7043  9937]]
training model: results/QRTEA/W3/deepVOL_L3/h100
Epoch 1/50
641/641 - 26s - loss: 3.2671 - accuracy100: 0.3919 - val_loss: 3.3343 - val_accuracy100: 0.3731 - 26s/epoch - 40ms/step
Epoch 2/50
641/641 - 22s - loss: 3.2140 - accuracy100: 0.4104 - val_loss: 3.2248 - val_accuracy100: 0.4217 - 22s/epoch - 35ms/step
Epoch 3/50
641/641 - 22s - loss: 3.1626 - accuracy100: 0.4353 - val_loss: 3.2073 - val_accuracy100: 0.4325 - 22s/epoch - 35ms/step
Epoch 4/50
641/641 - 22s - loss: 3.1271 - accuracy100: 0.4478 - val_loss: 3.1897 - val_accuracy100: 0.4368 - 22s/epoch - 35ms/step
Epoch 5/50
641/641 - 22s - loss: 3.0948 - accuracy100: 0.4627 - val_loss: 3.1500 - val_accuracy100: 0.4499 - 22s/epoch - 35ms/step
Epoch 6/50
641/641 - 23s - loss: 3.0680 - accuracy100: 0.4704 - val_loss: 3.1303 - val_accuracy100: 0.4534 - 23s/epoch - 35ms/step
Epoch 7/50
641/641 - 23s - loss: 3.0443 - accuracy100: 0.4779 - val_loss: 3.1264 - val_accuracy100: 0.4573 - 23s/epoch - 35ms/step
Epoch 8/50
641/641 - 22s - loss: 3.0249 - accuracy100: 0.4830 - val_loss: 3.1318 - val_accuracy100: 0.4603 - 22s/epoch - 35ms/step
Epoch 9/50
641/641 - 22s - loss: 3.0107 - accuracy100: 0.4869 - val_loss: 3.1364 - val_accuracy100: 0.4580 - 22s/epoch - 35ms/step
Epoch 10/50
641/641 - 22s - loss: 2.9990 - accuracy100: 0.4931 - val_loss: 3.1265 - val_accuracy100: 0.4586 - 22s/epoch - 35ms/step
Epoch 11/50
641/641 - 22s - loss: 2.9872 - accuracy100: 0.4938 - val_loss: 3.1283 - val_accuracy100: 0.4567 - 22s/epoch - 35ms/step
Epoch 12/50
641/641 - 22s - loss: 2.9758 - accuracy100: 0.4967 - val_loss: 3.1256 - val_accuracy100: 0.4568 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 23s - loss: 2.9636 - accuracy100: 0.4996 - val_loss: 3.1324 - val_accuracy100: 0.4537 - 23s/epoch - 35ms/step
Epoch 14/50
641/641 - 23s - loss: 2.9574 - accuracy100: 0.5013 - val_loss: 3.1274 - val_accuracy100: 0.4549 - 23s/epoch - 36ms/step
Epoch 15/50
641/641 - 23s - loss: 2.9478 - accuracy100: 0.5048 - val_loss: 3.1502 - val_accuracy100: 0.4514 - 23s/epoch - 35ms/step
Epoch 16/50
641/641 - 23s - loss: 2.9367 - accuracy100: 0.5078 - val_loss: 3.1605 - val_accuracy100: 0.4521 - 23s/epoch - 36ms/step
Epoch 17/50
641/641 - 22s - loss: 2.9261 - accuracy100: 0.5104 - val_loss: 3.1915 - val_accuracy100: 0.4466 - 22s/epoch - 35ms/step
Epoch 18/50
641/641 - 23s - loss: 2.9177 - accuracy100: 0.5108 - val_loss: 3.1882 - val_accuracy100: 0.4456 - 23s/epoch - 35ms/step
Epoch 19/50
641/641 - 23s - loss: 2.9076 - accuracy100: 0.5146 - val_loss: 3.2067 - val_accuracy100: 0.4443 - 23s/epoch - 36ms/step
Epoch 20/50
641/641 - 23s - loss: 2.8993 - accuracy100: 0.5177 - val_loss: 3.2017 - val_accuracy100: 0.4440 - 23s/epoch - 36ms/step
Epoch 21/50
641/641 - 23s - loss: 2.8864 - accuracy100: 0.5215 - val_loss: 3.2150 - val_accuracy100: 0.4439 - 23s/epoch - 36ms/step
Epoch 22/50
641/641 - 23s - loss: 2.8775 - accuracy100: 0.5249 - val_loss: 3.2312 - val_accuracy100: 0.4413 - 23s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h100
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9926765
{'0': {'precision': 0.534697385566553, 'recall': 0.20695797742198566, 'f1-score': 0.2984132387414221, 'support': 93188}, '1': {'precision': 0.58900396330312, 'recall': 0.6337757841731273, 'f1-score': 0.6105702183798495, 'support': 185482}, '2': {'precision': 0.3591896604626449, 'recall': 0.5297396333454742, 'f1-score': 0.4281037881423207, 'support': 90603}, 'accuracy': 0.5005402507088251, 'macro avg': {'precision': 0.4942970031107727, 'recall': 0.45682446498019574, 'f1-score': 0.4456957484211974, 'support': 369273}, 'weighted avg': {'precision': 0.5189133077545942, 'recall': 0.5005402507088251, 'f1-score': 0.4870266866367851, 'support': 369273}}
[[ 19286  47068  26834]
 [  9135 117554  58793]
 [  7648  34959  47996]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.023182
{'0': {'precision': 0.5101189706452864, 'recall': 0.2852313810556761, 'f1-score': 0.3658813708667625, 'support': 55320}, '1': {'precision': 0.4587532304158178, 'recall': 0.6204460554055553, 'f1-score': 0.5274866949145881, 'support': 54074}, '2': {'precision': 0.4569071821363106, 'recall': 0.5014355992026481, 'f1-score': 0.4781369069935741, 'support': 54681}, 'accuracy': 0.46776169434709736, 'macro avg': {'precision': 0.4752597943991383, 'recall': 0.4690376785546266, 'f1-score': 0.4571683242583082, 'support': 164075}, 'weighted avg': {'precision': 0.4754566220569726, 'recall': 0.46776169434709736, 'f1-score': 0.45655265694637426, 'support': 164075}}
[[15779 22011 17530]
 [ 5463 33550 15061]
 [ 9690 17572 27419]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0428045
{'0': {'precision': 0.5162266513617865, 'recall': 0.22869955156950672, 'f1-score': 0.3169731530723393, 'support': 21631}, '1': {'precision': 0.4475487047741383, 'recall': 0.6480663411609703, 'f1-score': 0.5294583214613606, 'support': 25806}, '2': {'precision': 0.4512105649303008, 'recall': 0.46087723165087063, 'f1-score': 0.45599267271458477, 'support': 22685}, 'accuracy': 0.4581443769430421, 'macro avg': {'precision': 0.4716619736887419, 'recall': 0.4458810414604492, 'f1-score': 0.4341413824160949, 'support': 70122}, 'weighted avg': {'precision': 0.4699188876023514, 'recall': 0.4581443769430421, 'f1-score': 0.4401449117006075, 'support': 70122}}
[[ 4947 10974  5710]
 [ 2076 16724  7006]
 [ 2560  9670 10455]]
training model: results/QRTEA/W3/deepVOL_L3/h200
Epoch 1/50
641/641 - 26s - loss: 3.2862 - accuracy200: 0.3790 - val_loss: 3.3129 - val_accuracy200: 0.3454 - 26s/epoch - 41ms/step
Epoch 2/50
641/641 - 23s - loss: 3.2673 - accuracy200: 0.3820 - val_loss: 3.2924 - val_accuracy200: 0.3568 - 23s/epoch - 37ms/step
Epoch 3/50
641/641 - 23s - loss: 3.2372 - accuracy200: 0.3943 - val_loss: 3.2870 - val_accuracy200: 0.3604 - 23s/epoch - 37ms/step
Epoch 4/50
641/641 - 24s - loss: 3.2289 - accuracy200: 0.4039 - val_loss: 3.2833 - val_accuracy200: 0.3676 - 24s/epoch - 37ms/step
Epoch 5/50
641/641 - 23s - loss: 3.2245 - accuracy200: 0.4049 - val_loss: 3.2831 - val_accuracy200: 0.3640 - 23s/epoch - 35ms/step
Epoch 6/50
641/641 - 23s - loss: 3.2163 - accuracy200: 0.4101 - val_loss: 3.2746 - val_accuracy200: 0.3697 - 23s/epoch - 36ms/step
Epoch 7/50
641/641 - 23s - loss: 3.2031 - accuracy200: 0.4164 - val_loss: 3.2814 - val_accuracy200: 0.3695 - 23s/epoch - 36ms/step
Epoch 8/50
641/641 - 23s - loss: 3.1975 - accuracy200: 0.4205 - val_loss: 3.2770 - val_accuracy200: 0.3713 - 23s/epoch - 36ms/step
Epoch 9/50
641/641 - 23s - loss: 3.1858 - accuracy200: 0.4262 - val_loss: 3.2902 - val_accuracy200: 0.3683 - 23s/epoch - 37ms/step
Epoch 10/50
641/641 - 23s - loss: 3.1789 - accuracy200: 0.4311 - val_loss: 3.2887 - val_accuracy200: 0.3689 - 23s/epoch - 36ms/step
Epoch 11/50
641/641 - 23s - loss: 3.1724 - accuracy200: 0.4332 - val_loss: 3.3026 - val_accuracy200: 0.3656 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 23s - loss: 3.1681 - accuracy200: 0.4359 - val_loss: 3.3045 - val_accuracy200: 0.3664 - 23s/epoch - 36ms/step
Epoch 13/50
641/641 - 23s - loss: 3.1619 - accuracy200: 0.4361 - val_loss: 3.3093 - val_accuracy200: 0.3703 - 23s/epoch - 36ms/step
Epoch 14/50
641/641 - 23s - loss: 3.1489 - accuracy200: 0.4419 - val_loss: 3.3267 - val_accuracy200: 0.3671 - 23s/epoch - 36ms/step
Epoch 15/50
641/641 - 22s - loss: 3.1410 - accuracy200: 0.4470 - val_loss: 3.3280 - val_accuracy200: 0.3657 - 22s/epoch - 35ms/step
Epoch 16/50
641/641 - 23s - loss: 3.1306 - accuracy200: 0.4498 - val_loss: 3.3329 - val_accuracy200: 0.3665 - 23s/epoch - 36ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h200
Evaluating performance on  test set...
1443/1443 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0887306
{'0': {'precision': 0.35141942261204134, 'recall': 0.24291363381858902, 'f1-score': 0.2872617230944313, 'support': 114304}, '1': {'precision': 0.4326634919331664, 'recall': 0.28708697665549837, 'f1-score': 0.3451531029965613, 'support': 146844}, '2': {'precision': 0.34856813915135926, 'recall': 0.6216231213872833, 'f1-score': 0.4466707204827364, 'support': 108125}, 'accuracy': 0.3713675248393465, 'macro avg': {'precision': 0.377550351232189, 'recall': 0.38387457728712354, 'f1-score': 0.359695182191243, 'support': 369273}, 'weighted avg': {'precision': 0.382891826744499, 'recall': 0.3713675248393465, 'f1-score': 0.3569583963766883, 'support': 369273}}
[[27766 34449 52089]
 [31163 42157 73524]
 [20082 20830 67213]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0890977
{'0': {'precision': 0.3874953931536844, 'recall': 0.32251312679309285, 'f1-score': 0.3520305668255406, 'support': 55421}, '1': {'precision': 0.3824637758080781, 'recall': 0.26406244274249696, 'f1-score': 0.3124214177324951, 'support': 54578}, '2': {'precision': 0.37410609722672117, 'recall': 0.555292551224203, 'f1-score': 0.4470381563472332, 'support': 54076}, 'accuracy': 0.3797897303062624, 'macro avg': {'precision': 0.38135508872949453, 'recall': 0.380622706919931, 'f1-score': 0.3704967136350896, 'support': 164075}, 'weighted avg': {'precision': 0.3814088158077452, 'recall': 0.3797897303062624, 'f1-score': 0.3701676521327161, 'support': 164075}}
[[17874 12905 24642]
 [14570 14412 25596]
 [13683 10365 30028]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0915099
{'0': {'precision': 0.34737151248164466, 'recall': 0.2701320056639108, 'f1-score': 0.30392106480291897, 'support': 21893}, '1': {'precision': 0.3722814697527127, 'recall': 0.32022111841051115, 'f1-score': 0.34429442039752783, 'support': 24964}, '2': {'precision': 0.37835188464457375, 'recall': 0.5142918547173866, 'f1-score': 0.4359707773870903, 'support': 23265}, 'accuracy': 0.36897122158523715, 'macro avg': {'precision': 0.366001622292977, 'recall': 0.36821499293060284, 'f1-score': 0.36139542086251236, 'support': 70122}, 'weighted avg': {'precision': 0.36651829283139914, 'recall': 0.36897122158523715, 'f1-score': 0.36210561476348146, 'support': 70122}}
[[ 5914  7146  8833]
 [ 6144  7994 10826]
 [ 4967  6333 11965]]
training model: results/QRTEA/W3/deepVOL_L3/h300
Epoch 1/50
641/641 - 26s - loss: 3.3107 - accuracy300: 0.3632 - val_loss: 3.3339 - val_accuracy300: 0.3286 - 26s/epoch - 41ms/step
Epoch 2/50
641/641 - 22s - loss: 3.2867 - accuracy300: 0.3607 - val_loss: 3.3079 - val_accuracy300: 0.3342 - 22s/epoch - 35ms/step
Epoch 3/50
641/641 - 23s - loss: 3.2823 - accuracy300: 0.3670 - val_loss: 3.2990 - val_accuracy300: 0.3356 - 23s/epoch - 35ms/step
Epoch 4/50
641/641 - 23s - loss: 3.2763 - accuracy300: 0.3726 - val_loss: 3.2971 - val_accuracy300: 0.3399 - 23s/epoch - 36ms/step
Epoch 5/50
641/641 - 23s - loss: 3.2690 - accuracy300: 0.3771 - val_loss: 3.2885 - val_accuracy300: 0.3561 - 23s/epoch - 35ms/step
Epoch 6/50
641/641 - 23s - loss: 3.2649 - accuracy300: 0.3822 - val_loss: 3.2899 - val_accuracy300: 0.3568 - 23s/epoch - 35ms/step
Epoch 7/50
641/641 - 23s - loss: 3.2538 - accuracy300: 0.3913 - val_loss: 3.2901 - val_accuracy300: 0.3603 - 23s/epoch - 36ms/step
Epoch 8/50
641/641 - 23s - loss: 3.2438 - accuracy300: 0.3987 - val_loss: 3.2989 - val_accuracy300: 0.3579 - 23s/epoch - 35ms/step
Epoch 9/50
641/641 - 22s - loss: 3.2352 - accuracy300: 0.4040 - val_loss: 3.3014 - val_accuracy300: 0.3591 - 22s/epoch - 35ms/step
Epoch 10/50
641/641 - 23s - loss: 3.2270 - accuracy300: 0.4086 - val_loss: 3.3066 - val_accuracy300: 0.3599 - 23s/epoch - 35ms/step
Epoch 11/50
641/641 - 23s - loss: 3.2197 - accuracy300: 0.4135 - val_loss: 3.3012 - val_accuracy300: 0.3677 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 23s - loss: 3.2133 - accuracy300: 0.4165 - val_loss: 3.3162 - val_accuracy300: 0.3610 - 23s/epoch - 35ms/step
Epoch 13/50
641/641 - 23s - loss: 3.2036 - accuracy300: 0.4215 - val_loss: 3.3140 - val_accuracy300: 0.3618 - 23s/epoch - 36ms/step
Epoch 14/50
641/641 - 22s - loss: 3.1963 - accuracy300: 0.4238 - val_loss: 3.3229 - val_accuracy300: 0.3599 - 22s/epoch - 35ms/step
Epoch 15/50
641/641 - 22s - loss: 3.1856 - accuracy300: 0.4283 - val_loss: 3.3395 - val_accuracy300: 0.3590 - 22s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h300
Evaluating performance on  test set...
1443/1443 - 22s - 22s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0925709
{'0': {'precision': 0.36805478231822736, 'recall': 0.054477882523567805, 'f1-score': 0.09490790588167736, 'support': 121352}, '1': {'precision': 0.3843397542264868, 'recall': 0.4732252572359168, 'f1-score': 0.42417607208498387, 'support': 135090}, '2': {'precision': 0.35086685515653127, 'recall': 0.575223121305315, 'f1-score': 0.43586850676605887, 'support': 112831}, 'accuracy': 0.366780132855638, 'macro avg': {'precision': 0.3677537972337485, 'recall': 0.3676420870215999, 'f1-score': 0.31831749491090666, 'support': 369273}, 'weighted avg': {'precision': 0.3687605090989707, 'recall': 0.366780132855638, 'f1-score': 0.3195432356533918, 'support': 369273}}
[[ 6611 59168 55573]
 [ 6659 63928 64503]
 [ 4692 43236 64903]]
Evaluating performance on  train set...
641/641 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952922
{'0': {'precision': 0.39459093982420557, 'recall': 0.05116246449486271, 'f1-score': 0.0905803287339552, 'support': 57034}, '1': {'precision': 0.34134675546780496, 'recall': 0.4740205827267286, 'f1-score': 0.39688954992240044, 'support': 51791}, '2': {'precision': 0.3737892141247537, 'recall': 0.5734298642533937, 'f1-score': 0.45257090615603285, 'support': 55250}, 'accuracy': 0.3605058662197166, 'macro avg': {'precision': 0.369908969805588, 'recall': 0.36620430382499497, 'f1-score': 0.3133469282707962, 'support': 164075}, 'weighted avg': {'precision': 0.3707794822779794, 'recall': 0.3605058662197166, 'f1-score': 0.3091635393214338, 'support': 164075}}
[[ 2918 26051 28065]
 [ 2229 24550 25012]
 [ 2248 21320 31682]]
Evaluating performance on  val set...
274/274 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0957665
{'0': {'precision': 0.3612273361227336, 'recall': 0.0681638740240372, 'f1-score': 0.11468634686346862, 'support': 22798}, '1': {'precision': 0.32996156180457215, 'recall': 0.49884213745794553, 'f1-score': 0.39719593654327867, 'support': 22887}, '2': {'precision': 0.3841891156026779, 'recall': 0.49081311126570365, 'f1-score': 0.4310047434238896, 'support': 24437}, 'accuracy': 0.3560223610279228, 'macro avg': {'precision': 0.35845933784332784, 'recall': 0.35260637424922875, 'f1-score': 0.3142956756102123, 'support': 70122}, 'weighted avg': {'precision': 0.3590245642156522, 'recall': 0.3560223610279228, 'f1-score': 0.31712879910026764, 'support': 70122}}
[[ 1554 12106  9138]
 [ 1383 11417 10087]
 [ 1365 11078 11994]]
training model: results/QRTEA/W3/deepVOL_L3/h500
Epoch 1/50
641/641 - 25s - loss: 3.2533 - accuracy500: 0.4058 - val_loss: 3.2853 - val_accuracy500: 0.3640 - 25s/epoch - 40ms/step
Epoch 2/50
641/641 - 23s - loss: 3.2774 - accuracy500: 0.3846 - val_loss: 3.2832 - val_accuracy500: 0.3639 - 23s/epoch - 35ms/step
Epoch 3/50
641/641 - 23s - loss: 3.2797 - accuracy500: 0.3838 - val_loss: 3.2851 - val_accuracy500: 0.3591 - 23s/epoch - 36ms/step
Epoch 4/50
641/641 - 24s - loss: 3.2641 - accuracy500: 0.3914 - val_loss: 3.2835 - val_accuracy500: 0.3635 - 24s/epoch - 37ms/step
Epoch 5/50
641/641 - 23s - loss: 3.2888 - accuracy500: 0.3751 - val_loss: 3.2816 - val_accuracy500: 0.3693 - 23s/epoch - 35ms/step
Epoch 6/50
641/641 - 23s - loss: 3.2924 - accuracy500: 0.3717 - val_loss: 3.2827 - val_accuracy500: 0.3657 - 23s/epoch - 37ms/step
Epoch 7/50
641/641 - 22s - loss: 3.2867 - accuracy500: 0.3767 - val_loss: 3.2825 - val_accuracy500: 0.3677 - 22s/epoch - 35ms/step
Epoch 8/50
641/641 - 23s - loss: 3.2886 - accuracy500: 0.3736 - val_loss: 3.2836 - val_accuracy500: 0.3723 - 23s/epoch - 36ms/step
Epoch 9/50
641/641 - 23s - loss: 3.2860 - accuracy500: 0.3727 - val_loss: 3.2870 - val_accuracy500: 0.3720 - 23s/epoch - 36ms/step
Epoch 10/50
641/641 - 23s - loss: 3.2824 - accuracy500: 0.3727 - val_loss: 3.2910 - val_accuracy500: 0.3713 - 23s/epoch - 35ms/step
Epoch 11/50
641/641 - 23s - loss: 3.2728 - accuracy500: 0.3821 - val_loss: 3.3050 - val_accuracy500: 0.3679 - 23s/epoch - 36ms/step
Epoch 12/50
641/641 - 22s - loss: 3.2701 - accuracy500: 0.3822 - val_loss: 3.2997 - val_accuracy500: 0.3770 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 23s - loss: 3.2614 - accuracy500: 0.3886 - val_loss: 3.3138 - val_accuracy500: 0.3706 - 23s/epoch - 36ms/step
Epoch 14/50
641/641 - 23s - loss: 3.2556 - accuracy500: 0.3923 - val_loss: 3.3247 - val_accuracy500: 0.3664 - 23s/epoch - 36ms/step
Epoch 15/50
641/641 - 23s - loss: 3.2482 - accuracy500: 0.3953 - val_loss: 3.3319 - val_accuracy500: 0.3696 - 23s/epoch - 36ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h500
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0880442
{'0': {'precision': 0.3942570199616349, 'recall': 0.42863040414537273, 'f1-score': 0.41072579517591573, 'support': 140494}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 99283}, '2': {'precision': 0.36965487301931843, 'recall': 0.6180963118551924, 'f1-score': 0.4626313127664186, 'support': 129496}, 'accuracy': 0.3798300985991394, 'macro avg': {'precision': 0.2546372976603178, 'recall': 0.3489089053335217, 'f1-score': 0.2911190359807781, 'support': 369273}, 'weighted avg': {'precision': 0.2796293614724055, 'recall': 0.3798300985991394, 'f1-score': 0.3184999020926124, 'support': 369273}}
[[60220     0 80274]
 [43069     0 56214]
 [49454     1 80041]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108848
{'0': {'precision': 0.3443710345550836, 'recall': 0.4797647746365695, 'f1-score': 0.40094627594627597, 'support': 54756}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 55707}, '2': {'precision': 0.3520975954254992, 'recall': 0.5765686786540327, 'f1-score': 0.4372043025961259, 'support': 53612}, 'accuracy': 0.34850525674234345, 'macro avg': {'precision': 0.2321562099935276, 'recall': 0.35211115109686747, 'f1-score': 0.27938352618080065, 'support': 164075}, 'weighted avg': {'precision': 0.22997432060978226, 'recall': 0.34850525674234345, 'f1-score': 0.2766637900746475, 'support': 164075}}
[[26270     0 28486]
 [27313     0 28394]
 [22701     0 30911]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937483
{'0': {'precision': 0.3519363232818001, 'recall': 0.47707183466821595, 'f1-score': 0.40505972305415594, 'support': 24097}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 20070}, '2': {'precision': 0.3863897268868302, 'recall': 0.557618955885186, 'f1-score': 0.4564751151201665, 'support': 25955}, 'accuracy': 0.37034026411112064, 'macro avg': {'precision': 0.24610868338954342, 'recall': 0.3448969301844673, 'f1-score': 0.2871782793914408, 'support': 70122}, 'weighted avg': {'precision': 0.2639593129612563, 'recall': 0.37034026411112064, 'f1-score': 0.3081562955902558, 'support': 70122}}
[[11496     0 12601]
 [ 9687     0 10383]
 [11482     0 14473]]
training model: results/QRTEA/W3/deepVOL_L3/h1000
Epoch 1/50
641/641 - 26s - loss: 3.2722 - accuracy1000: 0.3897 - val_loss: 3.4125 - val_accuracy1000: 0.3243 - 26s/epoch - 40ms/step
Epoch 2/50
641/641 - 23s - loss: 3.2892 - accuracy1000: 0.3699 - val_loss: 3.3647 - val_accuracy1000: 0.3153 - 23s/epoch - 36ms/step
Epoch 3/50
641/641 - 23s - loss: 3.2960 - accuracy1000: 0.3587 - val_loss: 3.3538 - val_accuracy1000: 0.3231 - 23s/epoch - 36ms/step
Epoch 4/50
641/641 - 23s - loss: 3.2672 - accuracy1000: 0.3903 - val_loss: 3.3910 - val_accuracy1000: 0.3275 - 23s/epoch - 36ms/step
Epoch 5/50
641/641 - 23s - loss: 3.2840 - accuracy1000: 0.3727 - val_loss: 3.3789 - val_accuracy1000: 0.3305 - 23s/epoch - 36ms/step
Epoch 6/50
641/641 - 23s - loss: 3.2789 - accuracy1000: 0.3771 - val_loss: 3.3661 - val_accuracy1000: 0.3332 - 23s/epoch - 35ms/step
Epoch 7/50
641/641 - 22s - loss: 3.2825 - accuracy1000: 0.3826 - val_loss: 3.3573 - val_accuracy1000: 0.3237 - 22s/epoch - 35ms/step
Epoch 8/50
641/641 - 22s - loss: 3.2847 - accuracy1000: 0.3745 - val_loss: 3.3627 - val_accuracy1000: 0.3279 - 22s/epoch - 35ms/step
Epoch 9/50
641/641 - 22s - loss: 3.2686 - accuracy1000: 0.3884 - val_loss: 3.3611 - val_accuracy1000: 0.3323 - 22s/epoch - 35ms/step
Epoch 10/50
641/641 - 23s - loss: 3.2626 - accuracy1000: 0.3897 - val_loss: 3.3671 - val_accuracy1000: 0.3335 - 23s/epoch - 35ms/step
Epoch 11/50
641/641 - 22s - loss: 3.2508 - accuracy1000: 0.3979 - val_loss: 3.4092 - val_accuracy1000: 0.3358 - 22s/epoch - 35ms/step
Epoch 12/50
641/641 - 22s - loss: 3.2384 - accuracy1000: 0.4061 - val_loss: 3.4194 - val_accuracy1000: 0.3368 - 22s/epoch - 35ms/step
Epoch 13/50
641/641 - 22s - loss: 3.2315 - accuracy1000: 0.4144 - val_loss: 3.4279 - val_accuracy1000: 0.3376 - 22s/epoch - 35ms/step
testing model: results/QRTEA/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
1443/1443 - 21s - 21s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0862813
{'0': {'precision': 0.3816864484387064, 'recall': 0.29516972276416553, 'f1-score': 0.3328987396784006, 'support': 144029}, '1': {'precision': 0.2413793103448276, 'recall': 7.789201940624027e-05, 'f1-score': 0.0001557337842197181, 'support': 89868}, '2': {'precision': 0.3578697132574788, 'recall': 0.6816644013709964, 'f1-score': 0.46933917881791687, 'support': 135376}, 'accuracy': 0.36504428972602926, 'macro avg': {'precision': 0.32697849068033763, 'recall': 0.3256373387181894, 'f1-score': 0.2674645507601791, 'support': 369273}, 'weighted avg': {'precision': 0.3388094002166198, 'recall': 0.36504428972602926, 'f1-score': 0.3019401059176136, 'support': 369273}}
[[ 42513     11 101505]
 [ 25785      7  64076]
 [ 43084     11  92281]]
Evaluating performance on  train set...
641/641 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1068659
{'0': {'precision': 0.35725420631081006, 'recall': 0.3566215926164413, 'f1-score': 0.3569376191627058, 'support': 55908}, '1': {'precision': 0.5, 'recall': 7.373951516268781e-05, 'f1-score': 0.00014745728346819532, 'support': 54245}, '2': {'precision': 0.3326313066932698, 'recall': 0.667816475650013, 'f1-score': 0.4440744851399679, 'support': 53922}, 'accuracy': 0.34101477982629896, 'macro avg': {'precision': 0.3966285043346933, 'recall': 0.3415039359272057, 'f1-score': 0.2670531871953806, 'support': 164075}, 'weighted avg': {'precision': 0.3963554075022963, 'recall': 0.34101477982629896, 'f1-score': 0.2676157343910263, 'support': 164075}}
[[19938     2 35968]
 [17961     4 36280]
 [17910     2 36010]]
Evaluating performance on  val set...
274/274 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1160849
{'0': {'precision': 0.2995740241676085, 'recall': 0.3207222299781283, 'f1-score': 0.30978761658613324, 'support': 21489}, '1': {'precision': 0.5, 'recall': 3.9471087428458653e-05, 'f1-score': 7.893594348186447e-05, 'support': 25335}, '2': {'precision': 0.3319183257630428, 'recall': 0.6712164134260451, 'f1-score': 0.4441856501732659, 'support': 23298}, 'accuracy': 0.3213114286529192, 'macro avg': {'precision': 0.37716411664355043, 'recall': 0.33065937149720065, 'f1-score': 0.25135073423429366, 'support': 70122}, 'weighted avg': {'precision': 0.3827340828693578, 'recall': 0.3213114286529192, 'f1-score': 0.24254389795904682, 'support': 70122}}
[[ 6892     0 14597]
 [ 8455     1 16879]
 [ 7659     1 15638]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  12.49 (ave)

============================================
