This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-18.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-10.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-27.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-02.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-04.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-29.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-03.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-05.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-11-26.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-12.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-11.csv
training model: results/AAPL/W9/deepLOB_L1/h10
Epoch 1/50
3419/3419 - 62s - loss: 3.1467 - accuracy10: 0.4400 - val_loss: 3.2923 - val_accuracy10: 0.3892 - 62s/epoch - 18ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.1167 - accuracy10: 0.4534 - val_loss: 3.3002 - val_accuracy10: 0.3991 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1019 - accuracy10: 0.4593 - val_loss: 3.3021 - val_accuracy10: 0.4035 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 51s - loss: 3.0903 - accuracy10: 0.4637 - val_loss: 3.3098 - val_accuracy10: 0.4000 - 51s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 51s - loss: 3.0802 - accuracy10: 0.4670 - val_loss: 3.3243 - val_accuracy10: 0.3920 - 51s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 50s - loss: 3.0746 - accuracy10: 0.4687 - val_loss: 3.3399 - val_accuracy10: 0.3935 - 50s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 51s - loss: 3.0690 - accuracy10: 0.4705 - val_loss: 3.3558 - val_accuracy10: 0.3860 - 51s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.0654 - accuracy10: 0.4718 - val_loss: 3.3656 - val_accuracy10: 0.3836 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.0624 - accuracy10: 0.4731 - val_loss: 3.3641 - val_accuracy10: 0.3882 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 51s - loss: 3.0592 - accuracy10: 0.4737 - val_loss: 3.3636 - val_accuracy10: 0.3907 - 51s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 51s - loss: 3.0571 - accuracy10: 0.4744 - val_loss: 3.3573 - val_accuracy10: 0.3902 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h10
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1234651
{'0': {'precision': 0.3244338149160484, 'recall': 0.5093071537075978, 'f1-score': 0.39637361976865637, 'support': 822217}, '1': {'precision': 0.37428397529979623, 'recall': 0.3937402108479508, 'f1-score': 0.38376565220096037, 'support': 987062}, '2': {'precision': 0.40228941768735726, 'recall': 0.14976120754716982, 'f1-score': 0.2182674784607357, 'support': 828125}, 'accuracy': 0.3531609112597084, 'macro avg': {'precision': 0.3670024026344006, 'recall': 0.3509361907009061, 'f1-score': 0.33280225014345083, 'support': 2637404}, 'weighted avg': {'precision': 0.3675365667332493, 'recall': 0.3531609112597084, 'f1-score': 0.3357310356389868, 'support': 2637404}}
[[418761 314205  89251]
 [503400 388646  95016]
 [368583 335521 124021]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0930965
{'0': {'precision': 0.3817336961534914, 'recall': 0.22779079328056034, 'f1-score': 0.2853221584237345, 'support': 290679}, '1': {'precision': 0.33855600395542135, 'recall': 0.5268752729465752, 'f1-score': 0.4122263471462546, 'support': 288518}, '2': {'precision': 0.42512287588941566, 'recall': 0.36297840564676626, 'f1-score': 0.39160048919987395, 'support': 295957}, 'accuracy': 0.3721093658944597, 'macro avg': {'precision': 0.3818041919994428, 'recall': 0.3725481572913006, 'f1-score': 0.36304966492328766, 'support': 875154}, 'weighted avg': {'precision': 0.3821722361927326, 'recall': 0.3721093658944597, 'f1-score': 0.3631004222074319, 'support': 875154}}
[[ 66214 151695  72770]
 [ 64007 152013  72498]
 [ 43235 145296 107426]]
Evaluating performance on  val set...
1396/1396 - 9s - 9s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0984951
{'0': {'precision': 0.3891194293489744, 'recall': 0.3961061307362734, 'f1-score': 0.39258169725650705, 'support': 116234}, '1': {'precision': 0.380960729312763, 'recall': 0.5659524091393394, 'f1-score': 0.45538631535830976, 'support': 126705}, '2': {'precision': 0.41626407430047524, 'recall': 0.18464579670593997, 'f1-score': 0.2558167716917111, 'support': 114327}, 'accuracy': 0.38867398520989965, 'macro avg': {'precision': 0.3954480776540709, 'recall': 0.3822347788605176, 'f1-score': 0.3679282614355093, 'support': 357266}, 'weighted avg': {'precision': 0.39491236160472243, 'recall': 0.38867398520989965, 'f1-score': 0.3710899669814249, 'support': 357266}}
[[46041 59203 10990]
 [36383 71709 18613]
 [35897 57320 21110]]
training model: results/AAPL/W9/deepLOB_L1/h20
Epoch 1/50
3419/3419 - 53s - loss: 3.1926 - accuracy20: 0.4201 - val_loss: 3.2870 - val_accuracy20: 0.3706 - 53s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.1695 - accuracy20: 0.4315 - val_loss: 3.2733 - val_accuracy20: 0.3800 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1579 - accuracy20: 0.4376 - val_loss: 3.2901 - val_accuracy20: 0.3892 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 52s - loss: 3.1502 - accuracy20: 0.4409 - val_loss: 3.2933 - val_accuracy20: 0.3933 - 52s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 51s - loss: 3.1442 - accuracy20: 0.4433 - val_loss: 3.2745 - val_accuracy20: 0.3956 - 51s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 51s - loss: 3.1397 - accuracy20: 0.4451 - val_loss: 3.2941 - val_accuracy20: 0.3907 - 51s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 50s - loss: 3.1357 - accuracy20: 0.4466 - val_loss: 3.3040 - val_accuracy20: 0.3850 - 50s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.1325 - accuracy20: 0.4472 - val_loss: 3.2872 - val_accuracy20: 0.3890 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.1301 - accuracy20: 0.4482 - val_loss: 3.2943 - val_accuracy20: 0.3827 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 51s - loss: 3.1279 - accuracy20: 0.4492 - val_loss: 3.2914 - val_accuracy20: 0.3821 - 51s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 52s - loss: 3.1259 - accuracy20: 0.4502 - val_loss: 3.2800 - val_accuracy20: 0.3798 - 52s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 50s - loss: 3.1243 - accuracy20: 0.4504 - val_loss: 3.2881 - val_accuracy20: 0.3812 - 50s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h20
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0938504
{'0': {'precision': 0.3607761359309187, 'recall': 0.4067951887346449, 'f1-score': 0.38240614674061524, 'support': 836121}, '1': {'precision': 0.35929939771277986, 'recall': 0.5161155995823316, 'f1-score': 0.42366197666953664, 'support': 955782}, '2': {'precision': 0.40350266398920726, 'recall': 0.1535255428438287, 'f1-score': 0.22242308295329247, 'support': 845501}, 'accuracy': 0.36521898048232276, 'macro avg': {'precision': 0.37452606587763526, 'recall': 0.35881211038693506, 'f1-score': 0.3428304021211481, 'support': 2637404}, 'weighted avg': {'precision': 0.3739382765783894, 'recall': 0.36521898048232276, 'f1-score': 0.34606955940923906, 'support': 2637404}}
[[340130 409656  86335]
 [356931 493294 105557]
 [245712 469983 129806]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0804485
{'0': {'precision': 0.39345576650165937, 'recall': 0.48617851940323237, 'f1-score': 0.43493016375926796, 'support': 289694}, '1': {'precision': 0.38662999712395746, 'recall': 0.29869358875993346, 'f1-score': 0.3370200697653011, 'support': 288041}, '2': {'precision': 0.42138110784559935, 'recall': 0.4174750100027234, 'f1-score': 0.41941896463490635, 'support': 297419}, 'accuracy': 0.40112254528917196, 'macro avg': {'precision': 0.40048895715707206, 'recall': 0.40078237272196304, 'f1-score': 0.39712306605315845, 'support': 875154}, 'weighted avg': {'precision': 0.4006995494928251, 'recall': 0.40112254528917196, 'f1-score': 0.3974333955144965, 'support': 875154}}
[[140843  64055  84796]
 [116304  86036  85701]
 [100817  72437 124165]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0921102
{'0': {'precision': 0.3912711161004855, 'recall': 0.5535468392285403, 'f1-score': 0.45847327176042546, 'support': 118373}, '1': {'precision': 0.3527420707268853, 'recall': 0.37402830458012154, 'f1-score': 0.36307346350578806, 'support': 122595}, '2': {'precision': 0.4102765608801792, 'recall': 0.21098385182892226, 'f1-score': 0.27866487984372873, 'support': 116298}, 'accuracy': 0.38043362648558776, 'macro avg': {'precision': 0.38476324923585, 'recall': 0.37951966521252806, 'f1-score': 0.3667372050366475, 'support': 357266}, 'weighted avg': {'precision': 0.38423665690037223, 'recall': 0.38043362648558776, 'f1-score': 0.36720543251430277, 'support': 357266}}
[[65525 39331 13517]
 [54989 45854 21752]
 [46953 44808 24537]]
training model: results/AAPL/W9/deepLOB_L1/h30
Epoch 1/50
3419/3419 - 54s - loss: 3.2273 - accuracy30: 0.4036 - val_loss: 3.3128 - val_accuracy30: 0.3615 - 54s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.2061 - accuracy30: 0.4160 - val_loss: 3.3180 - val_accuracy30: 0.3663 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1983 - accuracy30: 0.4212 - val_loss: 3.3327 - val_accuracy30: 0.3773 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 50s - loss: 3.1917 - accuracy30: 0.4244 - val_loss: 3.3098 - val_accuracy30: 0.3824 - 50s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 50s - loss: 3.1870 - accuracy30: 0.4266 - val_loss: 3.3236 - val_accuracy30: 0.3785 - 50s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 51s - loss: 3.1832 - accuracy30: 0.4282 - val_loss: 3.3214 - val_accuracy30: 0.3807 - 51s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 50s - loss: 3.1797 - accuracy30: 0.4298 - val_loss: 3.3362 - val_accuracy30: 0.3818 - 50s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.1764 - accuracy30: 0.4309 - val_loss: 3.3358 - val_accuracy30: 0.3827 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 50s - loss: 3.1745 - accuracy30: 0.4320 - val_loss: 3.3449 - val_accuracy30: 0.3807 - 50s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 50s - loss: 3.1725 - accuracy30: 0.4327 - val_loss: 3.3356 - val_accuracy30: 0.3809 - 50s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 50s - loss: 3.1694 - accuracy30: 0.4340 - val_loss: 3.3310 - val_accuracy30: 0.3807 - 50s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 50s - loss: 3.1680 - accuracy30: 0.4347 - val_loss: 3.3412 - val_accuracy30: 0.3809 - 50s/epoch - 15ms/step
Epoch 13/50
3419/3419 - 51s - loss: 3.1661 - accuracy30: 0.4353 - val_loss: 3.3439 - val_accuracy30: 0.3761 - 51s/epoch - 15ms/step
Epoch 14/50
3419/3419 - 51s - loss: 3.1640 - accuracy30: 0.4359 - val_loss: 3.3385 - val_accuracy30: 0.3707 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h30
Evaluating performance on  test set...
10303/10303 - 62s - 62s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1087189
{'0': {'precision': 0.3739247846447876, 'recall': 0.4891712566662428, 'f1-score': 0.42385377304129995, 'support': 857117}, '1': {'precision': 0.3763445806323775, 'recall': 0.5834681909693841, 'f1-score': 0.45755817830232715, 'support': 911455}, '2': {'precision': 0.4300688102332172, 'recall': 0.0510029556922397, 'f1-score': 0.09119130253151403, 'support': 868832}, 'accuracy': 0.37741468504635617, 'macro avg': {'precision': 0.39344605850346076, 'recall': 0.37454746777595554, 'f1-score': 0.3242010846250471, 'support': 2637404}, 'weighted avg': {'precision': 0.3932563929959978, 'recall': 0.37741468504635617, 'f1-score': 0.32591362019373893, 'support': 2637404}}
[[419277 410017  27823]
 [348749 531805  30901]
 [353261 471258  44313]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0886295
{'0': {'precision': 0.3861006895842844, 'recall': 0.4429407766047473, 'f1-score': 0.4125722204903482, 'support': 288332}, '1': {'precision': 0.37190996484369304, 'recall': 0.44149897828421014, 'f1-score': 0.40372772116518996, 'support': 288730}, '2': {'precision': 0.42644082928280924, 'recall': 0.28843108838881953, 'f1-score': 0.3441142097848361, 'support': 298092}, 'accuracy': 0.3898365316275764, 'macro avg': {'precision': 0.3948171612369289, 'recall': 0.390956947759259, 'f1-score': 0.38680471714679143, 'support': 875154}, 'weighted avg': {'precision': 0.3951594209260388, 'recall': 0.3898365316275764, 'f1-score': 0.3863363150184193, 'support': 875154}}
[[127714 101992  58626]
 [104241 127474  57015]
 [ 98824 113289  85979]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.105256
{'0': {'precision': 0.3850912858796226, 'recall': 0.5357160920509146, 'f1-score': 0.4480841567927914, 'support': 118630}, '1': {'precision': 0.37109933321935373, 'recall': 0.44690786601988125, 'f1-score': 0.40549083490879745, 'support': 121421}, '2': {'precision': 0.41097587480982395, 'recall': 0.1613189438211833, 'f1-score': 0.23169244907336498, 'support': 117215}, 'accuracy': 0.38269804571383786, 'macro avg': {'precision': 0.3890554979696001, 'recall': 0.3813143006306597, 'f1-score': 0.36175581359165127, 'support': 357266}, 'weighted avg': {'precision': 0.38882840390230333, 'recall': 0.38269804571383786, 'f1-score': 0.3626126096631765, 'support': 357266}}
[[63552 43995 11083]
 [51139 54264 16018]
 [50340 47966 18909]]
training model: results/AAPL/W9/deepLOB_L1/h50
Epoch 1/50
3419/3419 - 54s - loss: 3.1999 - accuracy50: 0.4216 - val_loss: 3.3500 - val_accuracy50: 0.3587 - 54s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.1908 - accuracy50: 0.4260 - val_loss: 3.3051 - val_accuracy50: 0.3624 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1887 - accuracy50: 0.4280 - val_loss: 3.3043 - val_accuracy50: 0.3674 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 50s - loss: 3.1826 - accuracy50: 0.4303 - val_loss: 3.3259 - val_accuracy50: 0.3506 - 50s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 51s - loss: 3.1770 - accuracy50: 0.4329 - val_loss: 3.3440 - val_accuracy50: 0.3593 - 51s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 51s - loss: 3.1714 - accuracy50: 0.4353 - val_loss: 3.3255 - val_accuracy50: 0.3635 - 51s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 51s - loss: 3.1651 - accuracy50: 0.4391 - val_loss: 3.3561 - val_accuracy50: 0.3606 - 51s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.1601 - accuracy50: 0.4408 - val_loss: 3.3762 - val_accuracy50: 0.3625 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 50s - loss: 3.1573 - accuracy50: 0.4415 - val_loss: 3.3706 - val_accuracy50: 0.3665 - 50s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 50s - loss: 3.1546 - accuracy50: 0.4427 - val_loss: 3.3603 - val_accuracy50: 0.3626 - 50s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 50s - loss: 3.1523 - accuracy50: 0.4438 - val_loss: 3.3395 - val_accuracy50: 0.3651 - 50s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 50s - loss: 3.1502 - accuracy50: 0.4444 - val_loss: 3.3490 - val_accuracy50: 0.3633 - 50s/epoch - 15ms/step
Epoch 13/50
3419/3419 - 51s - loss: 3.1489 - accuracy50: 0.4450 - val_loss: 3.3418 - val_accuracy50: 0.3655 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h50
Evaluating performance on  test set...
10303/10303 - 54s - 54s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021067
{'0': {'precision': 0.32112027598371073, 'recall': 0.30632031611477717, 'f1-score': 0.31354574660593376, 'support': 808314}, '1': {'precision': 0.38601305885036497, 'recall': 0.6992105947951698, 'f1-score': 0.4974171352988683, 'support': 1006834}, '2': {'precision': 0.3253755868544601, 'recall': 0.016857280457667684, 'f1-score': 0.032053891052383286, 'support': 822256}, 'accuracy': 0.3660618547632445, 'macro avg': {'precision': 0.3441696405628452, 'recall': 0.34079606378920485, 'f1-score': 0.28100559098572847, 'support': 2637404}, 'weighted avg': {'precision': 0.3472198856908712, 'recall': 0.3660618547632445, 'f1-score': 0.2959790782393209, 'support': 2637404}}
[[247603 551039   9672]
 [283778 703989  19067]
 [239679 568716  13861]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1064091
{'0': {'precision': 0.3620507399577167, 'recall': 0.09332033869885982, 'f1-score': 0.14839193467755374, 'support': 286272}, '1': {'precision': 0.3451107721492265, 'recall': 0.8007920436865908, 'f1-score': 0.48234799096127373, 'support': 289883}, '2': {'precision': 0.43326030887790934, 'recall': 0.18652570744383762, 'f1-score': 0.2607809259731181, 'support': 298999}, 'accuracy': 0.35950472716801846, 'macro avg': {'precision': 0.38014060699495084, 'recall': 0.36021269660976274, 'f1-score': 0.2971736172039819, 'support': 875154}, 'weighted avg': {'precision': 0.3807685670022598, 'recall': 0.3595047271680185, 'f1-score': 0.29740842717153315, 'support': 875154}}
[[ 26715 219689  39868]
 [ 24662 232136  33085]
 [ 22411 220817  55771]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021682
{'0': {'precision': 0.3867435291938695, 'recall': 0.1439168116890949, 'f1-score': 0.20977220785091796, 'support': 116074}, '1': {'precision': 0.35948542169184544, 'recall': 0.8111269365118519, 'f1-score': 0.49818081412538573, 'support': 125677}, '2': {'precision': 0.4036393442622951, 'recall': 0.10657490369216119, 'f1-score': 0.16862651097489986, 'support': 115515}, 'accuracy': 0.36655041341745365, 'macro avg': {'precision': 0.3832894317160034, 'recall': 0.3538728839643693, 'f1-score': 0.2921931776504012, 'support': 357266}, 'weighted avg': {'precision': 0.3826177598822006, 'recall': 0.36655041341745365, 'f1-score': 0.29792328642017185, 'support': 357266}}
[[ 16705  92085   7284]
 [ 12832 101940  10905]
 [ 13657  89547  12311]]
training model: results/AAPL/W9/deepLOB_L1/h100
Epoch 1/50
3419/3419 - 53s - loss: 3.2573 - accuracy100: 0.3883 - val_loss: 3.3551 - val_accuracy100: 0.3353 - 53s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.2464 - accuracy100: 0.3938 - val_loss: 3.3365 - val_accuracy100: 0.3457 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.2401 - accuracy100: 0.3989 - val_loss: 3.3272 - val_accuracy100: 0.3472 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 50s - loss: 3.2362 - accuracy100: 0.4020 - val_loss: 3.3298 - val_accuracy100: 0.3486 - 50s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 50s - loss: 3.2319 - accuracy100: 0.4049 - val_loss: 3.3330 - val_accuracy100: 0.3498 - 50s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 51s - loss: 3.2315 - accuracy100: 0.4061 - val_loss: 3.3363 - val_accuracy100: 0.3482 - 51s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 52s - loss: 3.2280 - accuracy100: 0.4072 - val_loss: 3.3276 - val_accuracy100: 0.3491 - 52s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.2252 - accuracy100: 0.4086 - val_loss: 3.3248 - val_accuracy100: 0.3548 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 50s - loss: 3.2232 - accuracy100: 0.4091 - val_loss: 3.3315 - val_accuracy100: 0.3525 - 50s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 50s - loss: 3.2215 - accuracy100: 0.4112 - val_loss: 3.3297 - val_accuracy100: 0.3549 - 50s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 51s - loss: 3.2200 - accuracy100: 0.4116 - val_loss: 3.3386 - val_accuracy100: 0.3521 - 51s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 51s - loss: 3.2186 - accuracy100: 0.4122 - val_loss: 3.3537 - val_accuracy100: 0.3529 - 51s/epoch - 15ms/step
Epoch 13/50
3419/3419 - 51s - loss: 3.2168 - accuracy100: 0.4137 - val_loss: 3.3669 - val_accuracy100: 0.3488 - 51s/epoch - 15ms/step
Epoch 14/50
3419/3419 - 51s - loss: 3.2153 - accuracy100: 0.4139 - val_loss: 3.3719 - val_accuracy100: 0.3518 - 51s/epoch - 15ms/step
Epoch 15/50
3419/3419 - 51s - loss: 3.2134 - accuracy100: 0.4153 - val_loss: 3.3777 - val_accuracy100: 0.3523 - 51s/epoch - 15ms/step
Epoch 16/50
3419/3419 - 51s - loss: 3.2125 - accuracy100: 0.4156 - val_loss: 3.3769 - val_accuracy100: 0.3530 - 51s/epoch - 15ms/step
Epoch 17/50
3419/3419 - 50s - loss: 3.2115 - accuracy100: 0.4164 - val_loss: 3.3945 - val_accuracy100: 0.3510 - 50s/epoch - 15ms/step
Epoch 18/50
3419/3419 - 52s - loss: 3.2100 - accuracy100: 0.4167 - val_loss: 3.3895 - val_accuracy100: 0.3460 - 52s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h100
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1090176
{'0': {'precision': 0.30594886659202664, 'recall': 0.8883903596124152, 'f1-score': 0.4551504591848271, 'support': 804366}, '1': {'precision': 0.3860589221134339, 'recall': 0.10332514931891688, 'f1-score': 0.16301959177592373, 'support': 1016616}, '2': {'precision': 0.29402245372711644, 'recall': 0.010681975742936863, 'f1-score': 0.020614998764896586, 'support': 816422}, 'accuracy': 0.3140792991896577, 'macro avg': {'precision': 0.3286767474775257, 'recall': 0.334132494891423, 'f1-score': 0.21292834990854914, 'support': 2637404}, 'weighted avg': {'precision': 0.33313627449766237, 'recall': 0.3140792991896577, 'f1-score': 0.20803275421102324, 'support': 2637404}}
[[714591  81220   8555]
 [899189 105042  12385]
 [721875  85826   8721]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1137449
{'0': {'precision': 0.3108488602698137, 'recall': 0.17734877824767506, 'f1-score': 0.2258456872341419, 'support': 286351}, '1': {'precision': 0.3232287350808755, 'recall': 0.6815892576675469, 'f1-score': 0.4385057496790928, 'support': 289695}, '2': {'precision': 0.38294435359992074, 'recall': 0.12918745068670848, 'f1-score': 0.19319872104156616, 'support': 299108}, 'accuracy': 0.32780287812202197, 'macro avg': {'precision': 0.3390073163168699, 'recall': 0.32937516220064345, 'f1-score': 0.2858500526516003, 'support': 875154}, 'weighted avg': {'precision': 0.3395874898737145, 'recall': 0.32780287812202197, 'f1-score': 0.2850827906765773, 'support': 875154}}
[[ 50784 204374  31193]
 [ 61171 197453  31071]
 [ 51417 209050  38641]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093621
{'0': {'precision': 0.3495226389561374, 'recall': 0.4735735432647019, 'f1-score': 0.4022000785742348, 'support': 118896}, '1': {'precision': 0.3615071689802532, 'recall': 0.5263328404578758, 'f1-score': 0.42862023128621246, 'support': 120382}, '2': {'precision': 0.34363488494474476, 'recall': 0.060879072448045565, 'f1-score': 0.1034336278088573, 'support': 117988}, 'accuracy': 0.35505757614774425, 'macro avg': {'precision': 0.3515548976270451, 'recall': 0.35359515205687436, 'f1-score': 0.3114179792231015, 'support': 357266}, 'weighted avg': {'precision': 0.35161642166444695, 'recall': 0.35505757614774425, 'f1-score': 0.31243406342268926, 'support': 357266}}
[[56306 56758  5832]
 [49133 63361  7888]
 [55655 55150  7183]]
training model: results/AAPL/W9/deepLOB_L1/h200
Epoch 1/50
3419/3419 - 54s - loss: 3.2516 - accuracy200: 0.3928 - val_loss: 3.3373 - val_accuracy200: 0.3332 - 54s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 52s - loss: 3.2358 - accuracy200: 0.4031 - val_loss: 3.4609 - val_accuracy200: 0.3504 - 52s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 50s - loss: 3.2298 - accuracy200: 0.4082 - val_loss: 3.3406 - val_accuracy200: 0.3353 - 50s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 50s - loss: 3.2248 - accuracy200: 0.4107 - val_loss: 3.3376 - val_accuracy200: 0.3412 - 50s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 51s - loss: 3.2214 - accuracy200: 0.4121 - val_loss: 3.3496 - val_accuracy200: 0.3442 - 51s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 50s - loss: 3.2187 - accuracy200: 0.4133 - val_loss: 3.3570 - val_accuracy200: 0.3470 - 50s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 51s - loss: 3.2156 - accuracy200: 0.4152 - val_loss: 3.3514 - val_accuracy200: 0.3451 - 51s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.2146 - accuracy200: 0.4158 - val_loss: 3.3466 - val_accuracy200: 0.3505 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.2130 - accuracy200: 0.4165 - val_loss: 3.3503 - val_accuracy200: 0.3499 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 52s - loss: 3.2113 - accuracy200: 0.4172 - val_loss: 3.3712 - val_accuracy200: 0.3469 - 52s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 52s - loss: 3.2079 - accuracy200: 0.4192 - val_loss: 3.3528 - val_accuracy200: 0.3460 - 52s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h200
Evaluating performance on  test set...
10303/10303 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1160156
{'0': {'precision': 0.31010923058041384, 'recall': 0.44194769010191487, 'f1-score': 0.3644725668103711, 'support': 811854}, '1': {'precision': 0.37786752121125095, 'recall': 0.4228796777245887, 'f1-score': 0.3991084721988679, 'support': 1001876}, '2': {'precision': 0.3032175978128019, 'recall': 0.13222464227352085, 'f1-score': 0.18414767659603248, 'support': 823674}, 'accuracy': 0.3379762827386324, 'macro avg': {'precision': 0.33039811653482226, 'recall': 0.33235067003334146, 'f1-score': 0.31590957186842383, 'support': 2637404}, 'weighted avg': {'precision': 0.33369641951916973, 'recall': 0.3379762827386324, 'f1-score': 0.3213134447056804, 'support': 2637404}}
[[358797 346581 106476]
 [434408 423673 143795]
 [363797 350967 108910]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095543
{'0': {'precision': 0.31685185475403155, 'recall': 0.1405447865725438, 'f1-score': 0.19471886007892578, 'support': 287709}, '1': {'precision': 0.3331230283911672, 'recall': 0.4685312988530051, 'f1-score': 0.3893911873625321, 'support': 288493}, '2': {'precision': 0.3495505828378821, 'recall': 0.39962268190211137, 'f1-score': 0.3729133111086139, 'support': 298952}, 'accuracy': 0.33716580167604787, 'macro avg': {'precision': 0.33317515532769365, 'recall': 0.3362329224425535, 'f1-score': 0.3190077861833573, 'support': 875154}, 'weighted avg': {'precision': 0.33338548181192246, 'recall': 0.33716580167604787, 'f1-score': 0.31976335652098825, 'support': 875154}}
[[ 40436 133246 114027]
 [ 45044 135168 108281]
 [ 42138 137346 119468]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1125826
{'0': {'precision': 0.3461358099529915, 'recall': 0.2544627466807927, 'f1-score': 0.2933029656910254, 'support': 118929}, '1': {'precision': 0.3381268436578171, 'recall': 0.43913273225667954, 'f1-score': 0.3820668649339827, 'support': 121116}, '2': {'precision': 0.31674352890997787, 'recall': 0.3040922701563713, 'f1-score': 0.31028899721448466, 'support': 117221}, 'accuracy': 0.33335106055432084, 'macro avg': {'precision': 0.3336687275069288, 'recall': 0.3325625830312812, 'f1-score': 0.3285529426131642, 'support': 357266}, 'weighted avg': {'precision': 0.3337769329875107, 'recall': 0.33335106055432084, 'f1-score': 0.32896784290274284, 'support': 357266}}
[[30263 52354 36312]
 [27349 53186 40581]
 [29819 51756 35646]]
training model: results/AAPL/W9/deepLOB_L1/h300
Epoch 1/50
3419/3419 - 54s - loss: 3.2472 - accuracy300: 0.3989 - val_loss: 3.3436 - val_accuracy300: 0.3386 - 54s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.2232 - accuracy300: 0.4112 - val_loss: 3.3207 - val_accuracy300: 0.3524 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.2143 - accuracy300: 0.4176 - val_loss: 3.3562 - val_accuracy300: 0.3532 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 51s - loss: 3.2108 - accuracy300: 0.4204 - val_loss: 3.3505 - val_accuracy300: 0.3452 - 51s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 51s - loss: 3.2074 - accuracy300: 0.4224 - val_loss: 3.3551 - val_accuracy300: 0.3495 - 51s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 50s - loss: 3.2038 - accuracy300: 0.4237 - val_loss: 3.3593 - val_accuracy300: 0.3437 - 50s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 51s - loss: 3.2029 - accuracy300: 0.4234 - val_loss: 3.3946 - val_accuracy300: 0.3509 - 51s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 50s - loss: 3.2009 - accuracy300: 0.4248 - val_loss: 3.3853 - val_accuracy300: 0.3486 - 50s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.1974 - accuracy300: 0.4256 - val_loss: 3.4319 - val_accuracy300: 0.3506 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 51s - loss: 3.1940 - accuracy300: 0.4273 - val_loss: 3.4178 - val_accuracy300: 0.3422 - 51s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 51s - loss: 3.1917 - accuracy300: 0.4278 - val_loss: 3.4965 - val_accuracy300: 0.3474 - 51s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 51s - loss: 3.1902 - accuracy300: 0.4282 - val_loss: 3.5271 - val_accuracy300: 0.3407 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h300
Evaluating performance on  test set...
10303/10303 - 52s - 52s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1294013
{'0': {'precision': 0.31123949476910795, 'recall': 0.7474830666645199, 'f1-score': 0.43948482915505216, 'support': 807431}, '1': {'precision': 0.3962807058382314, 'recall': 0.12121104241575589, 'f1-score': 0.1856400516760644, 'support': 1011228}, '2': {'precision': 0.2958618827854838, 'recall': 0.14054925526262757, 'f1-score': 0.190568771787462, 'support': 818745}, 'accuracy': 0.3189450687115057, 'macro avg': {'precision': 0.33446069446427434, 'recall': 0.33641445478096776, 'f1-score': 0.2718978842061928, 'support': 2637404}, 'weighted avg': {'precision': 0.33907205696415854, 'recall': 0.3189450687115057, 'f1-score': 0.26488369712145043, 'support': 2637404}}
[[603541  92063 111827]
 [726612 122572 162044]
 [609000  94671 115074]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1178528
{'0': {'precision': 0.3046703099393441, 'recall': 0.1620794575932088, 'f1-score': 0.21159431461861283, 'support': 287902}, '1': {'precision': 0.32311434636443975, 'recall': 0.6128881746072892, 'f1-score': 0.4231462148780052, 'support': 289335}, '2': {'precision': 0.3517323016514609, 'recall': 0.20446298801343998, 'f1-score': 0.25860067035026757, 'support': 297917}, 'accuracy': 0.3255495604202232, 'macro avg': {'precision': 0.32650565265174825, 'recall': 0.326476873404646, 'f1-score': 0.2977803999489618, 'support': 875154}, 'weighted avg': {'precision': 0.32678878584638876, 'recall': 0.3255495604202232, 'f1-score': 0.2975373161269858, 'support': 875154}}
[[ 46663 183400  57839]
 [ 57577 177330  54428]
 [ 48919 188085  60913]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.107624
{'0': {'precision': 0.34233040388522, 'recall': 0.39633807091194173, 'f1-score': 0.36735985498130624, 'support': 118626}, '1': {'precision': 0.36470564201042904, 'recall': 0.5819330127943932, 'f1-score': 0.44839549274902746, 'support': 122710}, '2': {'precision': 0.32127165713338307, 'recall': 0.06685931165358405, 'f1-score': 0.11068429770948762, 'support': 115930}, 'accuracy': 0.353171026630018, 'macro avg': {'precision': 0.3427692343430107, 'recall': 0.3483767984533063, 'f1-score': 0.3088132151466071, 'support': 357266}, 'weighted avg': {'precision': 0.3431822200653322, 'recall': 0.353171026630018, 'f1-score': 0.31190393629874236, 'support': 357266}}
[[47016 62951  8659]
 [43585 71409  7716]
 [46740 61439  7751]]
training model: results/AAPL/W9/deepLOB_L1/h500
Epoch 1/50
3419/3419 - 55s - loss: 3.2338 - accuracy500: 0.4083 - val_loss: 3.3881 - val_accuracy500: 0.3188 - 55s/epoch - 16ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.2022 - accuracy500: 0.4232 - val_loss: 3.3635 - val_accuracy500: 0.3340 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1917 - accuracy500: 0.4303 - val_loss: 3.3969 - val_accuracy500: 0.3323 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 51s - loss: 3.1840 - accuracy500: 0.4338 - val_loss: 3.3864 - val_accuracy500: 0.3440 - 51s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 50s - loss: 3.1814 - accuracy500: 0.4344 - val_loss: 3.4215 - val_accuracy500: 0.3402 - 50s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 50s - loss: 3.1749 - accuracy500: 0.4374 - val_loss: 3.4103 - val_accuracy500: 0.3449 - 50s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 51s - loss: 3.1706 - accuracy500: 0.4391 - val_loss: 3.4354 - val_accuracy500: 0.3403 - 51s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 51s - loss: 3.1670 - accuracy500: 0.4405 - val_loss: 3.4575 - val_accuracy500: 0.3360 - 51s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.1631 - accuracy500: 0.4421 - val_loss: 3.4386 - val_accuracy500: 0.3415 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 51s - loss: 3.1594 - accuracy500: 0.4430 - val_loss: 3.4735 - val_accuracy500: 0.3392 - 51s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 51s - loss: 3.1552 - accuracy500: 0.4454 - val_loss: 3.4633 - val_accuracy500: 0.3377 - 51s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 51s - loss: 3.1525 - accuracy500: 0.4460 - val_loss: 3.4790 - val_accuracy500: 0.3365 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h500
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1447033
{'0': {'precision': 0.3030677952237814, 'recall': 0.7411165149917851, 'f1-score': 0.4302086250580102, 'support': 794902}, '1': {'precision': 0.38561904502393346, 'recall': 0.08206792101236851, 'f1-score': 0.1353339118945329, 'support': 1034643}, '2': {'precision': 0.29915013805239443, 'recall': 0.1752892522086156, 'f1-score': 0.22105164568422533, 'support': 807859}, 'accuracy': 0.30925675398990826, 'macro avg': {'precision': 0.3292789927667031, 'recall': 0.3328245627375897, 'f1-score': 0.2621980608789228, 'support': 2637404}, 'weighted avg': {'precision': 0.33425230777557824, 'recall': 0.30925675398990826, 'f1-score': 0.25046391925960915, 'support': 2637404}}
[[589115  67801 137986]
 [755956  84911 193776]
 [598768  67482 141609]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1251371
{'0': {'precision': 0.3084103041176601, 'recall': 0.24061145633886544, 'f1-score': 0.27032463107457716, 'support': 289342}, '1': {'precision': 0.3056970173399868, 'recall': 0.37158634538152613, 'f1-score': 0.33543666866686667, 'support': 288840}, '2': {'precision': 0.345729293416867, 'recall': 0.34730210255512306, 'f1-score': 0.34651391326989145, 'support': 296972}, 'accuracy': 0.3200431009856551, 'macro avg': {'precision': 0.3199455382915046, 'recall': 0.3198333014251715, 'f1-score': 0.3174250710037784, 'support': 875154}, 'weighted avg': {'precision': 0.3201785062138636, 'recall': 0.3200431009856551, 'f1-score': 0.3176683493804568, 'support': 875154}}
[[ 69619 121186  98537]
 [ 84864 107329  96647]
 [ 71252 122581 103139]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1212339
{'0': {'precision': 0.3314771615621943, 'recall': 0.4466413181242079, 'f1-score': 0.3805368982571324, 'support': 118350}, '1': {'precision': 0.35819531578893327, 'recall': 0.2844457852937819, 'f1-score': 0.3170888003163162, 'support': 122642}, '2': {'precision': 0.3148684852649716, 'recall': 0.27190085487727267, 'f1-score': 0.29181146478002223, 'support': 116274}, 'accuracy': 0.33409280480090464, 'macro avg': {'precision': 0.33484698753869974, 'recall': 0.3343293194317541, 'f1-score': 0.3298123877844903, 'support': 357266}, 'weighted avg': {'precision': 0.3352435727037315, 'recall': 0.33409280480090464, 'f1-score': 0.32988034913190056, 'support': 357266}}
[[52860 31426 34064]
 [53029 34885 34728]
 [53579 31080 31615]]
training model: results/AAPL/W9/deepLOB_L1/h1000
Epoch 1/50
3419/3419 - 52s - loss: 3.2123 - accuracy1000: 0.4201 - val_loss: 3.4608 - val_accuracy1000: 0.3259 - 52s/epoch - 15ms/step
Epoch 2/50
3419/3419 - 51s - loss: 3.1603 - accuracy1000: 0.4419 - val_loss: 3.4190 - val_accuracy1000: 0.3355 - 51s/epoch - 15ms/step
Epoch 3/50
3419/3419 - 51s - loss: 3.1395 - accuracy1000: 0.4503 - val_loss: 3.4721 - val_accuracy1000: 0.3288 - 51s/epoch - 15ms/step
Epoch 4/50
3419/3419 - 51s - loss: 3.1261 - accuracy1000: 0.4547 - val_loss: 3.6405 - val_accuracy1000: 0.3281 - 51s/epoch - 15ms/step
Epoch 5/50
3419/3419 - 50s - loss: 3.1128 - accuracy1000: 0.4589 - val_loss: 3.6365 - val_accuracy1000: 0.3253 - 50s/epoch - 15ms/step
Epoch 6/50
3419/3419 - 50s - loss: 3.1038 - accuracy1000: 0.4625 - val_loss: 3.6967 - val_accuracy1000: 0.3250 - 50s/epoch - 15ms/step
Epoch 7/50
3419/3419 - 50s - loss: 3.0962 - accuracy1000: 0.4648 - val_loss: 3.7321 - val_accuracy1000: 0.3252 - 50s/epoch - 15ms/step
Epoch 8/50
3419/3419 - 50s - loss: 3.0866 - accuracy1000: 0.4683 - val_loss: 3.8538 - val_accuracy1000: 0.3255 - 50s/epoch - 15ms/step
Epoch 9/50
3419/3419 - 51s - loss: 3.0804 - accuracy1000: 0.4696 - val_loss: 3.8447 - val_accuracy1000: 0.3250 - 51s/epoch - 15ms/step
Epoch 10/50
3419/3419 - 51s - loss: 3.0746 - accuracy1000: 0.4718 - val_loss: 4.0133 - val_accuracy1000: 0.3254 - 51s/epoch - 15ms/step
Epoch 11/50
3419/3419 - 50s - loss: 3.0704 - accuracy1000: 0.4733 - val_loss: 3.9619 - val_accuracy1000: 0.3255 - 50s/epoch - 15ms/step
Epoch 12/50
3419/3419 - 51s - loss: 3.0656 - accuracy1000: 0.4743 - val_loss: 4.1457 - val_accuracy1000: 0.3254 - 51s/epoch - 15ms/step
testing model: results/AAPL/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
10303/10303 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1429828
{'0': {'precision': 0.29512707121226817, 'recall': 0.8445831587875738, 'f1-score': 0.437408294647346, 'support': 771049}, '1': {'precision': 0.4311727319048513, 'recall': 0.16482326451795687, 'f1-score': 0.2384824652186665, 'support': 1073016}, '2': {'precision': 0.26336671989161464, 'recall': 0.006860875363495303, 'f1-score': 0.013373365798286501, 'support': 793339}, 'accuracy': 0.3160365268271376, 'macro avg': {'precision': 0.3298888410029114, 'recall': 0.3387557662230087, 'f1-score': 0.22975470855476632, 'support': 2637404}, 'weighted avg': {'precision': 0.340923030154219, 'recall': 0.3160365268271376, 'f1-score': 0.22892523926090239, 'support': 2637404}}
[[651215 114472   5362]
 [886296 176858   9862]
 [669047 118849   5443]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1470591
{'0': {'precision': 0.30469159707934973, 'recall': 0.23597143779528107, 'f1-score': 0.26596423135761993, 'support': 288073}, '1': {'precision': 0.3156623138053592, 'recall': 0.4372789350851413, 'f1-score': 0.36664874086980215, 'support': 289225}, '2': {'precision': 0.35096281976316346, 'recall': 0.2962203212290503, 'f1-score': 0.32127635169949004, 'support': 297856}, 'accuracy': 0.3230060080854341, 'macro avg': {'precision': 0.3237722435492908, 'recall': 0.3231568980364909, 'f1-score': 0.31796310797563737, 'support': 875154}, 'weighted avg': {'precision': 0.3240655208102475, 'recall': 0.3230060080854341, 'f1-score': 0.31806423224913044, 'support': 875154}}
[[ 67977 134637  85459]
 [ 85046 126472  77707]
 [ 70078 139547  88231]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1407086
{'0': {'precision': 0.32895653406814246, 'recall': 0.4571646419820777, 'f1-score': 0.3826058900500099, 'support': 116726}, '1': {'precision': 0.35326129262821193, 'recall': 0.410524844158621, 'f1-score': 0.37974645026568327, 'support': 121598}, '2': {'precision': 0.3109531430272805, 'recall': 0.140488641522759, 'f1-score': 0.19353717859624742, 'support': 118942}, 'accuracy': 0.33586179485313467, 'macro avg': {'precision': 0.3310569899078783, 'recall': 0.33605937588781926, 'f1-score': 0.3186298396373135, 'support': 357266}, 'weighted avg': {'precision': 0.33123509036570536, 'recall': 0.33586179485313467, 'f1-score': 0.3186873732120573, 'support': 357266}}
[[53363 44950 18413]
 [53064 49919 18615]
 [55792 46440 16710]]
training model: results/AAPL/W9/deepOF_L1/h10
Epoch 1/50
3419/3419 - 49s - loss: 3.1643 - accuracy10: 0.4400 - val_loss: 3.2293 - val_accuracy10: 0.4152 - 49s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 46s - loss: 3.1526 - accuracy10: 0.4452 - val_loss: 3.2201 - val_accuracy10: 0.4193 - 46s/epoch - 14ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.1475 - accuracy10: 0.4474 - val_loss: 3.2141 - val_accuracy10: 0.4244 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.1466 - accuracy10: 0.4485 - val_loss: 3.2067 - val_accuracy10: 0.4281 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 47s - loss: 3.1402 - accuracy10: 0.4502 - val_loss: 3.2091 - val_accuracy10: 0.4258 - 47s/epoch - 14ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.1351 - accuracy10: 0.4517 - val_loss: 3.2015 - val_accuracy10: 0.4290 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.1311 - accuracy10: 0.4530 - val_loss: 3.2002 - val_accuracy10: 0.4292 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.1268 - accuracy10: 0.4544 - val_loss: 3.1975 - val_accuracy10: 0.4315 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.1236 - accuracy10: 0.4551 - val_loss: 3.1997 - val_accuracy10: 0.4312 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 46s - loss: 3.1191 - accuracy10: 0.4570 - val_loss: 3.1976 - val_accuracy10: 0.4318 - 46s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.1162 - accuracy10: 0.4572 - val_loss: 3.1974 - val_accuracy10: 0.4317 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 45s - loss: 3.1149 - accuracy10: 0.4579 - val_loss: 3.1972 - val_accuracy10: 0.4314 - 45s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.1129 - accuracy10: 0.4586 - val_loss: 3.1951 - val_accuracy10: 0.4325 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 45s - loss: 3.1120 - accuracy10: 0.4590 - val_loss: 3.1952 - val_accuracy10: 0.4328 - 45s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.1098 - accuracy10: 0.4595 - val_loss: 3.1968 - val_accuracy10: 0.4324 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.1078 - accuracy10: 0.4601 - val_loss: 3.1966 - val_accuracy10: 0.4331 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.1056 - accuracy10: 0.4610 - val_loss: 3.1975 - val_accuracy10: 0.4325 - 45s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 45s - loss: 3.1040 - accuracy10: 0.4617 - val_loss: 3.1961 - val_accuracy10: 0.4317 - 45s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 45s - loss: 3.1014 - accuracy10: 0.4621 - val_loss: 3.1938 - val_accuracy10: 0.4332 - 45s/epoch - 13ms/step
Epoch 20/50
3419/3419 - 47s - loss: 3.0995 - accuracy10: 0.4630 - val_loss: 3.1947 - val_accuracy10: 0.4322 - 47s/epoch - 14ms/step
Epoch 21/50
3419/3419 - 45s - loss: 3.0984 - accuracy10: 0.4635 - val_loss: 3.1953 - val_accuracy10: 0.4328 - 45s/epoch - 13ms/step
Epoch 22/50
3419/3419 - 45s - loss: 3.0979 - accuracy10: 0.4635 - val_loss: 3.1933 - val_accuracy10: 0.4331 - 45s/epoch - 13ms/step
Epoch 23/50
3419/3419 - 45s - loss: 3.0960 - accuracy10: 0.4643 - val_loss: 3.1900 - val_accuracy10: 0.4340 - 45s/epoch - 13ms/step
Epoch 24/50
3419/3419 - 45s - loss: 3.0943 - accuracy10: 0.4648 - val_loss: 3.1909 - val_accuracy10: 0.4333 - 45s/epoch - 13ms/step
Epoch 25/50
3419/3419 - 45s - loss: 3.0928 - accuracy10: 0.4657 - val_loss: 3.1913 - val_accuracy10: 0.4331 - 45s/epoch - 13ms/step
Epoch 26/50
3419/3419 - 45s - loss: 3.0923 - accuracy10: 0.4655 - val_loss: 3.1912 - val_accuracy10: 0.4339 - 45s/epoch - 13ms/step
Epoch 27/50
3419/3419 - 45s - loss: 3.0918 - accuracy10: 0.4655 - val_loss: 3.1915 - val_accuracy10: 0.4332 - 45s/epoch - 13ms/step
Epoch 28/50
3419/3419 - 45s - loss: 3.0910 - accuracy10: 0.4657 - val_loss: 3.1909 - val_accuracy10: 0.4332 - 45s/epoch - 13ms/step
Epoch 29/50
3419/3419 - 45s - loss: 3.0890 - accuracy10: 0.4667 - val_loss: 3.1917 - val_accuracy10: 0.4340 - 45s/epoch - 13ms/step
Epoch 30/50
3419/3419 - 47s - loss: 3.0881 - accuracy10: 0.4670 - val_loss: 3.1948 - val_accuracy10: 0.4325 - 47s/epoch - 14ms/step
Epoch 31/50
3419/3419 - 46s - loss: 3.0878 - accuracy10: 0.4675 - val_loss: 3.1933 - val_accuracy10: 0.4331 - 46s/epoch - 14ms/step
Epoch 32/50
3419/3419 - 45s - loss: 3.0863 - accuracy10: 0.4680 - val_loss: 3.1936 - val_accuracy10: 0.4329 - 45s/epoch - 13ms/step
Epoch 33/50
3419/3419 - 45s - loss: 3.0856 - accuracy10: 0.4680 - val_loss: 3.1929 - val_accuracy10: 0.4333 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h10
Evaluating performance on  test set...
10303/10303 - 55s - 55s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0756975
{'0': {'precision': 0.45061590635597853, 'recall': 0.2504867948164409, 'f1-score': 0.321988016556382, 'support': 822215}, '1': {'precision': 0.43320820536154403, 'recall': 0.4398411040452414, 'f1-score': 0.43649945833448534, 'support': 987061}, '2': {'precision': 0.38030565891683416, 'recall': 0.5410626910945704, 'f1-score': 0.44666002093405777, 'support': 828124}, 'accuracy': 0.41259232577538485, 'macro avg': {'precision': 0.4213765902114522, 'recall': 0.4104635299854176, 'f1-score': 0.4017158319416417, 'support': 2637400}, 'weighted avg': {'precision': 0.4220240863432533, 'recall': 0.41259232577538485, 'f1-score': 0.4039906165359811, 'support': 2637400}}
[[205954 292033 324228]
 [147030 434150 405881]
 [104066 275991 448067]]
Evaluating performance on  train set...
3419/3419 - 19s - 19s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0666903
{'0': {'precision': 0.45309683264680883, 'recall': 0.33402191052627955, 'f1-score': 0.3845525748351091, 'support': 290454}, '1': {'precision': 0.41034548060045734, 'recall': 0.5025320618217691, 'f1-score': 0.4517840583047556, 'support': 288895}, '2': {'precision': 0.41770442073468433, 'recall': 0.4338447079823126, 'f1-score': 0.42562160261874044, 'support': 295804}, 'accuracy': 0.42338882458267296, 'macro avg': {'precision': 0.4270489113273168, 'recall': 0.4234662267767871, 'f1-score': 0.4206527452528684, 'support': 875153}, 'weighted avg': {'precision': 0.42702154196885334, 'recall': 0.42338882458267296, 'f1-score': 0.4206276635469947, 'support': 875153}}
[[ 97018 102583  90853]
 [ 55668 145179  88048]
 [ 61436 106035 128333]]
Evaluating performance on  val set...
1396/1396 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0625976
{'0': {'precision': 0.4497799119647859, 'recall': 0.34811634849488543, 'f1-score': 0.39247142351395, 'support': 116237}, '1': {'precision': 0.44255436468277215, 'recall': 0.5061566840619925, 'f1-score': 0.4722235501344051, 'support': 126854}, '2': {'precision': 0.4128885506926205, 'recall': 0.4419706590759799, 'f1-score': 0.4269349216555552, 'support': 114175}, 'accuracy': 0.4342254790548219, 'macro avg': {'precision': 0.43507427578005947, 'recall': 0.4320812305442859, 'f1-score': 0.43054329843463673, 'support': 357266}, 'weighted avg': {'precision': 0.43542461157750567, 'recall': 0.4342254790548219, 'f1-score': 0.43180275134987334, 'support': 357266}}
[[40464 41695 34078]
 [24969 64208 37677]
 [24531 39182 50462]]
training model: results/AAPL/W9/deepOF_L1/h20
Epoch 1/50
3419/3419 - 50s - loss: 3.2049 - accuracy20: 0.4237 - val_loss: 3.2496 - val_accuracy20: 0.3957 - 50s/epoch - 15ms/step
Epoch 2/50
3419/3419 - 47s - loss: 3.1966 - accuracy20: 0.4273 - val_loss: 3.2487 - val_accuracy20: 0.3923 - 47s/epoch - 14ms/step
Epoch 3/50
3419/3419 - 46s - loss: 3.1945 - accuracy20: 0.4278 - val_loss: 3.2472 - val_accuracy20: 0.3917 - 46s/epoch - 14ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.1938 - accuracy20: 0.4276 - val_loss: 3.2479 - val_accuracy20: 0.3917 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 45s - loss: 3.1912 - accuracy20: 0.4290 - val_loss: 3.2459 - val_accuracy20: 0.3948 - 45s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.1863 - accuracy20: 0.4308 - val_loss: 3.2434 - val_accuracy20: 0.3983 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 46s - loss: 3.1837 - accuracy20: 0.4320 - val_loss: 3.2416 - val_accuracy20: 0.3985 - 46s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 46s - loss: 3.1816 - accuracy20: 0.4325 - val_loss: 3.2430 - val_accuracy20: 0.3971 - 46s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.1806 - accuracy20: 0.4333 - val_loss: 3.2429 - val_accuracy20: 0.3968 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.1785 - accuracy20: 0.4339 - val_loss: 3.2408 - val_accuracy20: 0.3986 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 46s - loss: 3.1773 - accuracy20: 0.4348 - val_loss: 3.2410 - val_accuracy20: 0.3985 - 46s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 46s - loss: 3.1759 - accuracy20: 0.4349 - val_loss: 3.2395 - val_accuracy20: 0.3989 - 46s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.1738 - accuracy20: 0.4360 - val_loss: 3.2411 - val_accuracy20: 0.3982 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 45s - loss: 3.1719 - accuracy20: 0.4363 - val_loss: 3.2421 - val_accuracy20: 0.3972 - 45s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.1696 - accuracy20: 0.4372 - val_loss: 3.2387 - val_accuracy20: 0.3994 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.1688 - accuracy20: 0.4377 - val_loss: 3.2371 - val_accuracy20: 0.4010 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.1670 - accuracy20: 0.4384 - val_loss: 3.2373 - val_accuracy20: 0.4008 - 45s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 45s - loss: 3.1657 - accuracy20: 0.4391 - val_loss: 3.2364 - val_accuracy20: 0.4025 - 45s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 44s - loss: 3.1640 - accuracy20: 0.4397 - val_loss: 3.2374 - val_accuracy20: 0.4025 - 44s/epoch - 13ms/step
Epoch 20/50
3419/3419 - 45s - loss: 3.1625 - accuracy20: 0.4404 - val_loss: 3.2365 - val_accuracy20: 0.4036 - 45s/epoch - 13ms/step
Epoch 21/50
3419/3419 - 47s - loss: 3.1615 - accuracy20: 0.4409 - val_loss: 3.2375 - val_accuracy20: 0.4008 - 47s/epoch - 14ms/step
Epoch 22/50
3419/3419 - 46s - loss: 3.1605 - accuracy20: 0.4409 - val_loss: 3.2369 - val_accuracy20: 0.4022 - 46s/epoch - 14ms/step
Epoch 23/50
3419/3419 - 46s - loss: 3.1589 - accuracy20: 0.4422 - val_loss: 3.2358 - val_accuracy20: 0.4037 - 46s/epoch - 14ms/step
Epoch 24/50
3419/3419 - 46s - loss: 3.1576 - accuracy20: 0.4426 - val_loss: 3.2377 - val_accuracy20: 0.4029 - 46s/epoch - 13ms/step
Epoch 25/50
3419/3419 - 46s - loss: 3.1565 - accuracy20: 0.4425 - val_loss: 3.2371 - val_accuracy20: 0.4017 - 46s/epoch - 14ms/step
Epoch 26/50
3419/3419 - 45s - loss: 3.1563 - accuracy20: 0.4428 - val_loss: 3.2367 - val_accuracy20: 0.4030 - 45s/epoch - 13ms/step
Epoch 27/50
3419/3419 - 46s - loss: 3.1545 - accuracy20: 0.4435 - val_loss: 3.2354 - val_accuracy20: 0.4035 - 46s/epoch - 14ms/step
Epoch 28/50
3419/3419 - 45s - loss: 3.1536 - accuracy20: 0.4441 - val_loss: 3.2360 - val_accuracy20: 0.4045 - 45s/epoch - 13ms/step
Epoch 29/50
3419/3419 - 45s - loss: 3.1535 - accuracy20: 0.4437 - val_loss: 3.2374 - val_accuracy20: 0.4020 - 45s/epoch - 13ms/step
Epoch 30/50
3419/3419 - 45s - loss: 3.1520 - accuracy20: 0.4445 - val_loss: 3.2340 - val_accuracy20: 0.4038 - 45s/epoch - 13ms/step
Epoch 31/50
3419/3419 - 45s - loss: 3.1509 - accuracy20: 0.4452 - val_loss: 3.2337 - val_accuracy20: 0.4060 - 45s/epoch - 13ms/step
Epoch 32/50
3419/3419 - 46s - loss: 3.1499 - accuracy20: 0.4454 - val_loss: 3.2346 - val_accuracy20: 0.4046 - 46s/epoch - 13ms/step
Epoch 33/50
3419/3419 - 45s - loss: 3.1488 - accuracy20: 0.4454 - val_loss: 3.2336 - val_accuracy20: 0.4048 - 45s/epoch - 13ms/step
Epoch 34/50
3419/3419 - 45s - loss: 3.1483 - accuracy20: 0.4458 - val_loss: 3.2354 - val_accuracy20: 0.4028 - 45s/epoch - 13ms/step
Epoch 35/50
3419/3419 - 45s - loss: 3.1466 - accuracy20: 0.4463 - val_loss: 3.2356 - val_accuracy20: 0.4017 - 45s/epoch - 13ms/step
Epoch 36/50
3419/3419 - 45s - loss: 3.1463 - accuracy20: 0.4468 - val_loss: 3.2367 - val_accuracy20: 0.4027 - 45s/epoch - 13ms/step
Epoch 37/50
3419/3419 - 45s - loss: 3.1457 - accuracy20: 0.4471 - val_loss: 3.2364 - val_accuracy20: 0.4015 - 45s/epoch - 13ms/step
Epoch 38/50
3419/3419 - 45s - loss: 3.1449 - accuracy20: 0.4471 - val_loss: 3.2351 - val_accuracy20: 0.4039 - 45s/epoch - 13ms/step
Epoch 39/50
3419/3419 - 45s - loss: 3.1433 - accuracy20: 0.4479 - val_loss: 3.2376 - val_accuracy20: 0.4016 - 45s/epoch - 13ms/step
Epoch 40/50
3419/3419 - 45s - loss: 3.1426 - accuracy20: 0.4477 - val_loss: 3.2359 - val_accuracy20: 0.4024 - 45s/epoch - 13ms/step
Epoch 41/50
3419/3419 - 45s - loss: 3.1416 - accuracy20: 0.4485 - val_loss: 3.2382 - val_accuracy20: 0.4000 - 45s/epoch - 13ms/step
Epoch 42/50
3419/3419 - 47s - loss: 3.1401 - accuracy20: 0.4488 - val_loss: 3.2362 - val_accuracy20: 0.4025 - 47s/epoch - 14ms/step
Epoch 43/50
3419/3419 - 45s - loss: 3.1398 - accuracy20: 0.4494 - val_loss: 3.2399 - val_accuracy20: 0.4002 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h20
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829186
{'0': {'precision': 0.40850560110867307, 'recall': 0.3892113443182131, 'f1-score': 0.3986251391060587, 'support': 836119}, '1': {'precision': 0.3986455514646084, 'recall': 0.16924379120321495, 'f1-score': 0.2376106730906941, 'support': 955781}, '2': {'precision': 0.3785433847294561, 'recall': 0.6424707273802484, 'f1-score': 0.4763950680947758, 'support': 845500}, 'accuracy': 0.39068628194433913, 'macro avg': {'precision': 0.39523151243424587, 'recall': 0.40030862096722547, 'f1-score': 0.3708769600971762, 'support': 2637400}, 'weighted avg': {'precision': 0.39532705327463885, 'recall': 0.39068628194433913, 'f1-score': 0.3652058275178768, 'support': 2637400}}
[[325427 137944 372748]
 [274980 161760 519041]
 [196221 106070 543209]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777223
{'0': {'precision': 0.4139863784944751, 'recall': 0.45520020163448227, 'f1-score': 0.4336161815490874, 'support': 289633}, '1': {'precision': 0.3855239029501764, 'recall': 0.24019835950576812, 'f1-score': 0.2959850227333512, 'support': 287962}, '2': {'precision': 0.40333922650176396, 'recall': 0.5113927368781884, 'f1-score': 0.45098402414826816, 'support': 297558}, 'accuracy': 0.4035614344006134, 'macro avg': {'precision': 0.40094983598213846, 'recall': 0.4022637660061463, 'f1-score': 0.39352840947690226, 'support': 875153}, 'weighted avg': {'precision': 0.4010009272244292, 'recall': 0.4035614344006134, 'f1-score': 0.3942349496424722, 'support': 875153}}
[[131841  56836 100956]
 [ 94646  69168 124148]
 [ 91980  53409 152169]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0769714
{'0': {'precision': 0.41529337266591504, 'recall': 0.4543749366318564, 'f1-score': 0.4339560217873714, 'support': 118356}, '1': {'precision': 0.40731424658255855, 'recall': 0.2524074557681008, 'f1-score': 0.31167430845971683, 'support': 122536}, '2': {'precision': 0.39427547781187844, 'recall': 0.5144276212899789, 'f1-score': 0.4464080652618078, 'support': 116374}, 'accuracy': 0.40466487155228875, 'macro avg': {'precision': 0.4056276990201173, 'recall': 0.407070004563312, 'f1-score': 0.3973461318362987, 'support': 357266}, 'weighted avg': {'precision': 0.40571041014081094, 'recall': 0.40466487155228875, 'f1-score': 0.3960715941703482, 'support': 357266}}
[[53778 24354 40224]
 [39859 30929 51748]
 [35857 20651 59866]]
training model: results/AAPL/W9/deepOF_L1/h30
Epoch 1/50
3419/3419 - 49s - loss: 3.2271 - accuracy30: 0.4126 - val_loss: 3.2553 - val_accuracy30: 0.3850 - 49s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 45s - loss: 3.2185 - accuracy30: 0.4162 - val_loss: 3.2504 - val_accuracy30: 0.3918 - 45s/epoch - 13ms/step
Epoch 3/50
3419/3419 - 46s - loss: 3.2181 - accuracy30: 0.4167 - val_loss: 3.2504 - val_accuracy30: 0.3893 - 46s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 46s - loss: 3.2164 - accuracy30: 0.4167 - val_loss: 3.2493 - val_accuracy30: 0.3903 - 46s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 46s - loss: 3.2135 - accuracy30: 0.4185 - val_loss: 3.2511 - val_accuracy30: 0.3870 - 46s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.2133 - accuracy30: 0.4178 - val_loss: 3.2491 - val_accuracy30: 0.3879 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 46s - loss: 3.2107 - accuracy30: 0.4194 - val_loss: 3.2488 - val_accuracy30: 0.3892 - 46s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.2098 - accuracy30: 0.4199 - val_loss: 3.2478 - val_accuracy30: 0.3902 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 46s - loss: 3.2088 - accuracy30: 0.4199 - val_loss: 3.2472 - val_accuracy30: 0.3901 - 46s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.2068 - accuracy30: 0.4210 - val_loss: 3.2455 - val_accuracy30: 0.3908 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 46s - loss: 3.2051 - accuracy30: 0.4217 - val_loss: 3.2456 - val_accuracy30: 0.3906 - 46s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 45s - loss: 3.2038 - accuracy30: 0.4224 - val_loss: 3.2458 - val_accuracy30: 0.3900 - 45s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.2023 - accuracy30: 0.4232 - val_loss: 3.2455 - val_accuracy30: 0.3899 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 46s - loss: 3.2015 - accuracy30: 0.4238 - val_loss: 3.2469 - val_accuracy30: 0.3877 - 46s/epoch - 14ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.1996 - accuracy30: 0.4243 - val_loss: 3.2451 - val_accuracy30: 0.3890 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.1983 - accuracy30: 0.4251 - val_loss: 3.2455 - val_accuracy30: 0.3890 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.1971 - accuracy30: 0.4258 - val_loss: 3.2440 - val_accuracy30: 0.3893 - 45s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 45s - loss: 3.1960 - accuracy30: 0.4257 - val_loss: 3.2440 - val_accuracy30: 0.3890 - 45s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 46s - loss: 3.1950 - accuracy30: 0.4263 - val_loss: 3.2431 - val_accuracy30: 0.3900 - 46s/epoch - 13ms/step
Epoch 20/50
3419/3419 - 45s - loss: 3.1941 - accuracy30: 0.4263 - val_loss: 3.2440 - val_accuracy30: 0.3896 - 45s/epoch - 13ms/step
Epoch 21/50
3419/3419 - 45s - loss: 3.1931 - accuracy30: 0.4274 - val_loss: 3.2428 - val_accuracy30: 0.3904 - 45s/epoch - 13ms/step
Epoch 22/50
3419/3419 - 45s - loss: 3.1921 - accuracy30: 0.4274 - val_loss: 3.2433 - val_accuracy30: 0.3906 - 45s/epoch - 13ms/step
Epoch 23/50
3419/3419 - 45s - loss: 3.1913 - accuracy30: 0.4277 - val_loss: 3.2438 - val_accuracy30: 0.3905 - 45s/epoch - 13ms/step
Epoch 24/50
3419/3419 - 45s - loss: 3.1900 - accuracy30: 0.4285 - val_loss: 3.2440 - val_accuracy30: 0.3898 - 45s/epoch - 13ms/step
Epoch 25/50
3419/3419 - 44s - loss: 3.1892 - accuracy30: 0.4288 - val_loss: 3.2437 - val_accuracy30: 0.3897 - 44s/epoch - 13ms/step
Epoch 26/50
3419/3419 - 45s - loss: 3.1881 - accuracy30: 0.4295 - val_loss: 3.2426 - val_accuracy30: 0.3914 - 45s/epoch - 13ms/step
Epoch 27/50
3419/3419 - 45s - loss: 3.1871 - accuracy30: 0.4302 - val_loss: 3.2424 - val_accuracy30: 0.3920 - 45s/epoch - 13ms/step
Epoch 28/50
3419/3419 - 45s - loss: 3.1865 - accuracy30: 0.4303 - val_loss: 3.2423 - val_accuracy30: 0.3920 - 45s/epoch - 13ms/step
Epoch 29/50
3419/3419 - 46s - loss: 3.1851 - accuracy30: 0.4312 - val_loss: 3.2426 - val_accuracy30: 0.3912 - 46s/epoch - 13ms/step
Epoch 30/50
3419/3419 - 45s - loss: 3.1841 - accuracy30: 0.4313 - val_loss: 3.2411 - val_accuracy30: 0.3919 - 45s/epoch - 13ms/step
Epoch 31/50
3419/3419 - 45s - loss: 3.1841 - accuracy30: 0.4316 - val_loss: 3.2423 - val_accuracy30: 0.3910 - 45s/epoch - 13ms/step
Epoch 32/50
3419/3419 - 45s - loss: 3.1828 - accuracy30: 0.4320 - val_loss: 3.2405 - val_accuracy30: 0.3940 - 45s/epoch - 13ms/step
Epoch 33/50
3419/3419 - 45s - loss: 3.1828 - accuracy30: 0.4322 - val_loss: 3.2417 - val_accuracy30: 0.3924 - 45s/epoch - 13ms/step
Epoch 34/50
3419/3419 - 46s - loss: 3.1807 - accuracy30: 0.4329 - val_loss: 3.2424 - val_accuracy30: 0.3937 - 46s/epoch - 13ms/step
Epoch 35/50
3419/3419 - 45s - loss: 3.1805 - accuracy30: 0.4335 - val_loss: 3.2418 - val_accuracy30: 0.3930 - 45s/epoch - 13ms/step
Epoch 36/50
3419/3419 - 45s - loss: 3.1800 - accuracy30: 0.4333 - val_loss: 3.2436 - val_accuracy30: 0.3928 - 45s/epoch - 13ms/step
Epoch 37/50
3419/3419 - 45s - loss: 3.1787 - accuracy30: 0.4334 - val_loss: 3.2446 - val_accuracy30: 0.3907 - 45s/epoch - 13ms/step
Epoch 38/50
3419/3419 - 47s - loss: 3.1779 - accuracy30: 0.4339 - val_loss: 3.2449 - val_accuracy30: 0.3918 - 47s/epoch - 14ms/step
Epoch 39/50
3419/3419 - 45s - loss: 3.1772 - accuracy30: 0.4340 - val_loss: 3.2442 - val_accuracy30: 0.3921 - 45s/epoch - 13ms/step
Epoch 40/50
3419/3419 - 46s - loss: 3.1761 - accuracy30: 0.4349 - val_loss: 3.2432 - val_accuracy30: 0.3923 - 46s/epoch - 13ms/step
Epoch 41/50
3419/3419 - 45s - loss: 3.1753 - accuracy30: 0.4352 - val_loss: 3.2441 - val_accuracy30: 0.3922 - 45s/epoch - 13ms/step
Epoch 42/50
3419/3419 - 45s - loss: 3.1749 - accuracy30: 0.4355 - val_loss: 3.2460 - val_accuracy30: 0.3920 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h30
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0804949
{'0': {'precision': 0.4186860543519686, 'recall': 0.3332528307169983, 'f1-score': 0.3711160988348865, 'support': 857115}, '1': {'precision': 0.36159572816597874, 'recall': 0.3475556638074988, 'f1-score': 0.3544367105673901, 'support': 911454}, '2': {'precision': 0.40270832792767414, 'recall': 0.5001766741748396, 'f1-score': 0.4461815439537113, 'support': 868831}, 'accuracy': 0.39318495487980587, 'macro avg': {'precision': 0.3943300368152072, 'recall': 0.3936617228997789, 'f1-score': 0.3905781177853293, 'support': 2637400}, 'weighted avg': {'precision': 0.3936928223088688, 'recall': 0.39318495487980587, 'f1-score': 0.3900804920229016, 'support': 2637400}}
[[285636 296776 274703]
 [224829 316781 369844]
 [171755 262507 434569]]
Evaluating performance on  train set...
3419/3419 - 20s - 20s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0804353
{'0': {'precision': 0.42039483404619654, 'recall': 0.38464764809872093, 'f1-score': 0.40172758028342886, 'support': 288490}, '1': {'precision': 0.3513780238295824, 'recall': 0.40487160552891865, 'f1-score': 0.37623287108553866, 'support': 288447}, '2': {'precision': 0.42028949123851467, 'recall': 0.3929735493736084, 'f1-score': 0.4061727753227623, 'support': 298216}, 'accuracy': 0.3941505085396496, 'macro avg': {'precision': 0.3973541163714312, 'recall': 0.3941642676670827, 'f1-score': 0.39471107556391, 'support': 875153}, 'weighted avg': {'precision': 0.39761126732439206, 'recall': 0.3941505085396496, 'f1-score': 0.394839362908691, 'support': 875153}}
[[110967 106747  70776]
 [ 80796 116784  90867]
 [ 72196 108829 117191]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0797757
{'0': {'precision': 0.4181937060169652, 'recall': 0.4094473597762822, 'f1-score': 0.4137743180725148, 'support': 118721}, '1': {'precision': 0.36001311245454476, 'recall': 0.3888733345410827, 'f1-score': 0.3738871228885519, 'support': 121438}, '2': {'precision': 0.4120977652359929, 'recall': 0.3865780867070286, 'f1-score': 0.39893021739322004, 'support': 117107}, 'accuracy': 0.39495781854416595, 'macro avg': {'precision': 0.3967681945691676, 'recall': 0.3949662603414645, 'f1-score': 0.3955305527847623, 'support': 357266}, 'weighted avg': {'precision': 0.39641941946836967, 'recall': 0.39495781854416595, 'f1-score': 0.39535059651210813, 'support': 357266}}
[[48610 42689 27422]
 [37052 47224 37162]
 [30576 41260 45271]]
training model: results/AAPL/W9/deepOF_L1/h50
Epoch 1/50
3419/3419 - 48s - loss: 3.2036 - accuracy50: 0.4284 - val_loss: 3.2769 - val_accuracy50: 0.3630 - 48s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 45s - loss: 3.2007 - accuracy50: 0.4291 - val_loss: 3.2731 - val_accuracy50: 0.3617 - 45s/epoch - 13ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2043 - accuracy50: 0.4278 - val_loss: 3.2632 - val_accuracy50: 0.3659 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 44s - loss: 3.2023 - accuracy50: 0.4280 - val_loss: 3.2631 - val_accuracy50: 0.3676 - 44s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 45s - loss: 3.2008 - accuracy50: 0.4288 - val_loss: 3.2602 - val_accuracy50: 0.3691 - 45s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.2010 - accuracy50: 0.4278 - val_loss: 3.2600 - val_accuracy50: 0.3710 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.1995 - accuracy50: 0.4293 - val_loss: 3.2621 - val_accuracy50: 0.3714 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.1990 - accuracy50: 0.4295 - val_loss: 3.2662 - val_accuracy50: 0.3692 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.1969 - accuracy50: 0.4306 - val_loss: 3.2667 - val_accuracy50: 0.3696 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.1940 - accuracy50: 0.4323 - val_loss: 3.2680 - val_accuracy50: 0.3705 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.1923 - accuracy50: 0.4327 - val_loss: 3.2745 - val_accuracy50: 0.3678 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 45s - loss: 3.1906 - accuracy50: 0.4336 - val_loss: 3.2759 - val_accuracy50: 0.3678 - 45s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 46s - loss: 3.1894 - accuracy50: 0.4344 - val_loss: 3.2677 - val_accuracy50: 0.3703 - 46s/epoch - 14ms/step
Epoch 14/50
3419/3419 - 44s - loss: 3.1877 - accuracy50: 0.4348 - val_loss: 3.2635 - val_accuracy50: 0.3711 - 44s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.1874 - accuracy50: 0.4348 - val_loss: 3.2675 - val_accuracy50: 0.3700 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.1872 - accuracy50: 0.4351 - val_loss: 3.2618 - val_accuracy50: 0.3728 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h50
Evaluating performance on  test set...
10303/10303 - 51s - 51s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080245
{'0': {'precision': 0.4468920776150123, 'recall': 0.08488059066301132, 'f1-score': 0.14266420887487408, 'support': 808312}, '1': {'precision': 0.38468097109956245, 'recall': 0.8993586821250396, 'f1-score': 0.538871475406324, 'support': 1006833}, '2': {'precision': 0.4401834354128836, 'recall': 0.06957452371831123, 'f1-score': 0.120157232737427, 'support': 822255}, 'accuracy': 0.3910373853037082, 'macro avg': {'precision': 0.4239188280424861, 'recall': 0.3512712655021207, 'f1-score': 0.2672309723395417, 'support': 2637400}, 'weighted avg': {'precision': 0.4210513217189854, 'recall': 0.3910373853037082, 'f1-score': 0.286900228105845, 'support': 2637400}}
[[ 68610 714469  25233]
 [ 53806 905504  47523]
 [ 31111 733936  57208]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0933381
{'0': {'precision': 0.47597752713584196, 'recall': 0.11749130185700113, 'f1-score': 0.18846219577453344, 'support': 286268}, '1': {'precision': 0.3345516417290108, 'recall': 0.887875466208903, 'f1-score': 0.4859843060453234, 'support': 290106}, '2': {'precision': 0.4632918715649407, 'recall': 0.05360483835878693, 'f1-score': 0.0960914837002661, 'support': 298779}, 'accuracy': 0.3510563295789422, 'macro avg': {'precision': 0.42460701347659785, 'recall': 0.352990535474897, 'f1-score': 0.2568459951733743, 'support': 875153}, 'weighted avg': {'precision': 0.4247651043964439, 'recall': 0.3510563295789422, 'f1-score': 0.2555527734670972, 'support': 875153}}
[[ 33634 245437   7197]
 [ 21171 257578  11357]
 [ 15858 266905  16016]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868654
{'0': {'precision': 0.47167023490034077, 'recall': 0.13478440698997002, 'f1-score': 0.2096572060449687, 'support': 116052}, '1': {'precision': 0.35620338413412445, 'recall': 0.8770498977537656, 'f1-score': 0.5066406815575437, 'support': 125677}, '2': {'precision': 0.46115014666757626, 'recall': 0.05850939525866173, 'f1-score': 0.10384343605026268, 'support': 115537}, 'accuracy': 0.3712276007232706, 'macro avg': {'precision': 0.4296745885673472, 'recall': 0.3567812333341325, 'f1-score': 0.2733804412175917, 'support': 357266}, 'weighted avg': {'precision': 0.42764984998295513, 'recall': 0.3712276007232706, 'f1-score': 0.27990902600017165, 'support': 357266}}
[[ 15642  97406   3004]
 [ 10557 110225   4895]
 [  6964 101813   6760]]
training model: results/AAPL/W9/deepOF_L1/h100
Epoch 1/50
3419/3419 - 49s - loss: 3.2544 - accuracy100: 0.3951 - val_loss: 3.2932 - val_accuracy100: 0.3488 - 49s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 45s - loss: 3.2460 - accuracy100: 0.3993 - val_loss: 3.2789 - val_accuracy100: 0.3566 - 45s/epoch - 13ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2459 - accuracy100: 0.3992 - val_loss: 3.2748 - val_accuracy100: 0.3625 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.2456 - accuracy100: 0.3995 - val_loss: 3.2791 - val_accuracy100: 0.3563 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 45s - loss: 3.2459 - accuracy100: 0.3998 - val_loss: 3.2721 - val_accuracy100: 0.3680 - 45s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.2452 - accuracy100: 0.4001 - val_loss: 3.2719 - val_accuracy100: 0.3683 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.2454 - accuracy100: 0.3998 - val_loss: 3.2710 - val_accuracy100: 0.3714 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.2445 - accuracy100: 0.3998 - val_loss: 3.2697 - val_accuracy100: 0.3741 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.2435 - accuracy100: 0.4009 - val_loss: 3.2702 - val_accuracy100: 0.3715 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.2423 - accuracy100: 0.4014 - val_loss: 3.2688 - val_accuracy100: 0.3742 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.2418 - accuracy100: 0.4015 - val_loss: 3.2695 - val_accuracy100: 0.3715 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 46s - loss: 3.2412 - accuracy100: 0.4020 - val_loss: 3.2706 - val_accuracy100: 0.3713 - 46s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.2395 - accuracy100: 0.4034 - val_loss: 3.2698 - val_accuracy100: 0.3719 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 45s - loss: 3.2379 - accuracy100: 0.4038 - val_loss: 3.2700 - val_accuracy100: 0.3707 - 45s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.2382 - accuracy100: 0.4040 - val_loss: 3.2701 - val_accuracy100: 0.3700 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.2370 - accuracy100: 0.4047 - val_loss: 3.2693 - val_accuracy100: 0.3724 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 46s - loss: 3.2356 - accuracy100: 0.4059 - val_loss: 3.2712 - val_accuracy100: 0.3706 - 46s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 46s - loss: 3.2346 - accuracy100: 0.4061 - val_loss: 3.2721 - val_accuracy100: 0.3680 - 46s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 44s - loss: 3.2348 - accuracy100: 0.4065 - val_loss: 3.2723 - val_accuracy100: 0.3699 - 44s/epoch - 13ms/step
Epoch 20/50
3419/3419 - 45s - loss: 3.2327 - accuracy100: 0.4072 - val_loss: 3.2732 - val_accuracy100: 0.3685 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h100
Evaluating performance on  test set...
10303/10303 - 53s - 53s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0874832
{'0': {'precision': 0.36893848311792404, 'recall': 0.3662401179566937, 'f1-score': 0.3675843485606513, 'support': 804363}, '1': {'precision': 0.3929789575126179, 'recall': 0.5206498815678683, 'f1-score': 0.44789402202656214, 'support': 1016616}, '2': {'precision': 0.3807176856507583, 'recall': 0.22944412257891456, 'f1-score': 0.2863287546228468, 'support': 816421}, 'accuracy': 0.38341320997952527, 'macro avg': {'precision': 0.3808783754271001, 'recall': 0.3721113740344922, 'f1-score': 0.3672690417366868, 'support': 2637400}, 'weighted avg': {'precision': 0.3818514728912975, 'recall': 0.38341320997952527, 'f1-score': 0.3733875356926465, 'support': 2637400}}
[[294590 393104 116669]
 [299281 529301 188034]
 [204609 424489 187323]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0908834
{'0': {'precision': 0.4013273343315319, 'recall': 0.3809314295491607, 'f1-score': 0.3908634897886062, 'support': 286377}, '1': {'precision': 0.33752402288626054, 'recall': 0.5300951717334088, 'f1-score': 0.4124386735230652, 'support': 289897}, '2': {'precision': 0.4210153004357078, 'recall': 0.20852920412608447, 'f1-score': 0.2789127214631898, 'support': 298879}, 'accuracy': 0.37146418969025985, 'macro avg': {'precision': 0.3866222192178334, 'recall': 0.37318526846955136, 'f1-score': 0.36073829492495374, 'support': 875153}, 'weighted avg': {'precision': 0.3869160611520995, 'recall': 0.37146418969025985, 'f1-score': 0.3597773224015737, 'support': 875153}}
[[109090 140191  37096]
 [ 87610 153673  48614]
 [ 75123 161431  62325]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898468
{'0': {'precision': 0.3999855967736773, 'recall': 0.4201470897247321, 'f1-score': 0.4098185261552714, 'support': 118975}, '1': {'precision': 0.3435716817802376, 'recall': 0.49945142629164174, 'f1-score': 0.4071000304867722, 'support': 120312}, '2': {'precision': 0.41022022440588196, 'recall': 0.1995694148958713, 'f1-score': 0.26851033499643623, 'support': 117979}, 'accuracy': 0.3740126404415757, 'macro avg': {'precision': 0.3845925009865989, 'recall': 0.3730559769707484, 'f1-score': 0.36180963054615994, 'support': 357266}, 'weighted avg': {'precision': 0.3843675424184606, 'recall': 0.3740126404415757, 'f1-score': 0.36223922463876357, 'support': 357266}}
[[49987 54254 14734]
 [41105 60090 19117]
 [33880 60554 23545]]
training model: results/AAPL/W9/deepOF_L1/h200
Epoch 1/50
3419/3419 - 49s - loss: 3.2579 - accuracy200: 0.3893 - val_loss: 3.3018 - val_accuracy200: 0.3437 - 49s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 47s - loss: 3.2531 - accuracy200: 0.3900 - val_loss: 3.2895 - val_accuracy200: 0.3502 - 47s/epoch - 14ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2550 - accuracy200: 0.3889 - val_loss: 3.2918 - val_accuracy200: 0.3476 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.2558 - accuracy200: 0.3891 - val_loss: 3.2864 - val_accuracy200: 0.3572 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 45s - loss: 3.2582 - accuracy200: 0.3880 - val_loss: 3.2863 - val_accuracy200: 0.3564 - 45s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 44s - loss: 3.2579 - accuracy200: 0.3880 - val_loss: 3.2853 - val_accuracy200: 0.3581 - 44s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.2573 - accuracy200: 0.3887 - val_loss: 3.2845 - val_accuracy200: 0.3593 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 44s - loss: 3.2570 - accuracy200: 0.3892 - val_loss: 3.2846 - val_accuracy200: 0.3587 - 44s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.2555 - accuracy200: 0.3902 - val_loss: 3.2851 - val_accuracy200: 0.3564 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.2550 - accuracy200: 0.3909 - val_loss: 3.2851 - val_accuracy200: 0.3564 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.2544 - accuracy200: 0.3912 - val_loss: 3.2846 - val_accuracy200: 0.3572 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 46s - loss: 3.2536 - accuracy200: 0.3914 - val_loss: 3.2843 - val_accuracy200: 0.3571 - 46s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.2525 - accuracy200: 0.3921 - val_loss: 3.2843 - val_accuracy200: 0.3575 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 45s - loss: 3.2507 - accuracy200: 0.3929 - val_loss: 3.2854 - val_accuracy200: 0.3562 - 45s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.2493 - accuracy200: 0.3940 - val_loss: 3.2861 - val_accuracy200: 0.3557 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 46s - loss: 3.2484 - accuracy200: 0.3946 - val_loss: 3.2867 - val_accuracy200: 0.3552 - 46s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.2471 - accuracy200: 0.3955 - val_loss: 3.2869 - val_accuracy200: 0.3553 - 45s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 46s - loss: 3.2466 - accuracy200: 0.3961 - val_loss: 3.2882 - val_accuracy200: 0.3539 - 46s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 44s - loss: 3.2453 - accuracy200: 0.3971 - val_loss: 3.2882 - val_accuracy200: 0.3538 - 44s/epoch - 13ms/step
Epoch 20/50
3419/3419 - 44s - loss: 3.2437 - accuracy200: 0.3977 - val_loss: 3.2861 - val_accuracy200: 0.3567 - 44s/epoch - 13ms/step
Epoch 21/50
3419/3419 - 45s - loss: 3.2438 - accuracy200: 0.3977 - val_loss: 3.2872 - val_accuracy200: 0.3546 - 45s/epoch - 13ms/step
Epoch 22/50
3419/3419 - 45s - loss: 3.2424 - accuracy200: 0.3984 - val_loss: 3.2871 - val_accuracy200: 0.3541 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h200
Evaluating performance on  test set...
10303/10303 - 57s - 57s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935982
{'0': {'precision': 0.33770676307392217, 'recall': 0.4597777178324594, 'f1-score': 0.3893995395276977, 'support': 811851}, '1': {'precision': 0.38222525036446253, 'recall': 0.3807636873225828, 'f1-score': 0.3814930689762246, 'support': 1001876}, '2': {'precision': 0.3544239800465879, 'recall': 0.22979750459223502, 'f1-score': 0.27881804529220744, 'support': 823673}, 'accuracy': 0.3579385000379161, 'macro avg': {'precision': 0.3581186644949909, 'recall': 0.3567796365824257, 'f1-score': 0.3499035512653766, 'support': 2637400}, 'weighted avg': {'precision': 0.35983898580396845, 'recall': 0.3579385000379161, 'f1-score': 0.3518609431101438, 'support': 2637400}}
[[373271 298783 139797]
 [415429 381478 204969]
 [316611 317784 189278]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955621
{'0': {'precision': 0.36494819198393114, 'recall': 0.46973687868342046, 'f1-score': 0.41076480365613155, 'support': 287776}, '1': {'precision': 0.33298675009201323, 'recall': 0.3762723847878752, 'f1-score': 0.3533087200381403, 'support': 288533}, '2': {'precision': 0.3937226857369885, 'recall': 0.23544391053526253, 'f1-score': 0.2946742860971917, 'support': 298844}, 'accuracy': 0.3589166694280886, 'macro avg': {'precision': 0.36388587593764427, 'recall': 0.3604843913355194, 'f1-score': 0.35291593659715453, 'support': 875153}, 'weighted avg': {'precision': 0.3642364925413627, 'recall': 0.3589166694280886, 'f1-score': 0.3521796981900774, 'support': 875153}}
[[135179 102745  49852]
 [121472 108567  58494]
 [113755 114728  70361]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949786
{'0': {'precision': 0.36366979334956956, 'recall': 0.5067579486748709, 'f1-score': 0.42345286018622186, 'support': 119045}, '1': {'precision': 0.3402369031627793, 'recall': 0.34563378185036014, 'f1-score': 0.3429141094226919, 'support': 120917}, '2': {'precision': 0.3783535384480721, 'recall': 0.22109220486939918, 'f1-score': 0.2790945434783778, 'support': 117304}, 'accuracy': 0.35843041319353086, 'macro avg': {'precision': 0.36075341165347363, 'recall': 0.35782797846487674, 'f1-score': 0.34848717102909715, 'support': 357266}, 'weighted avg': {'precision': 0.360560141863894, 'recall': 0.35843041319353086, 'f1-score': 0.3487961279218287, 'support': 357266}}
[[60327 38985 19733]
 [56245 41793 22879]
 [49312 42057 25935]]
training model: results/AAPL/W9/deepOF_L1/h300
Epoch 1/50
3419/3419 - 49s - loss: 3.2607 - accuracy300: 0.3877 - val_loss: 3.3044 - val_accuracy300: 0.3458 - 49s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 46s - loss: 3.2592 - accuracy300: 0.3845 - val_loss: 3.2969 - val_accuracy300: 0.3459 - 46s/epoch - 13ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2612 - accuracy300: 0.3838 - val_loss: 3.2919 - val_accuracy300: 0.3505 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 46s - loss: 3.2609 - accuracy300: 0.3849 - val_loss: 3.2902 - val_accuracy300: 0.3503 - 46s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 46s - loss: 3.2594 - accuracy300: 0.3861 - val_loss: 3.2892 - val_accuracy300: 0.3529 - 46s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 46s - loss: 3.2609 - accuracy300: 0.3853 - val_loss: 3.2891 - val_accuracy300: 0.3527 - 46s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 46s - loss: 3.2603 - accuracy300: 0.3860 - val_loss: 3.2888 - val_accuracy300: 0.3543 - 46s/epoch - 14ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.2605 - accuracy300: 0.3860 - val_loss: 3.2890 - val_accuracy300: 0.3543 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.2607 - accuracy300: 0.3855 - val_loss: 3.2892 - val_accuracy300: 0.3545 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.2610 - accuracy300: 0.3850 - val_loss: 3.2902 - val_accuracy300: 0.3532 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.2592 - accuracy300: 0.3867 - val_loss: 3.2918 - val_accuracy300: 0.3528 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 46s - loss: 3.2576 - accuracy300: 0.3876 - val_loss: 3.2913 - val_accuracy300: 0.3518 - 46s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 45s - loss: 3.2583 - accuracy300: 0.3874 - val_loss: 3.2902 - val_accuracy300: 0.3532 - 45s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 45s - loss: 3.2579 - accuracy300: 0.3877 - val_loss: 3.2915 - val_accuracy300: 0.3511 - 45s/epoch - 13ms/step
Epoch 15/50
3419/3419 - 46s - loss: 3.2589 - accuracy300: 0.3876 - val_loss: 3.2910 - val_accuracy300: 0.3527 - 46s/epoch - 14ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.2583 - accuracy300: 0.3877 - val_loss: 3.2906 - val_accuracy300: 0.3535 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.2594 - accuracy300: 0.3870 - val_loss: 3.2897 - val_accuracy300: 0.3540 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h300
Evaluating performance on  test set...
10303/10303 - 64s - 64s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0944262
{'0': {'precision': 0.3285253666754121, 'recall': 0.40166305850181067, 'f1-score': 0.36143137585958834, 'support': 807428}, '1': {'precision': 0.38841486704125955, 'recall': 0.45957785979027477, 'f1-score': 0.42101038760680104, 'support': 1011228}, '2': {'precision': 0.3441902494930794, 'recall': 0.19073849701493995, 'f1-score': 0.24545448829986544, 'support': 818744}, 'accuracy': 0.3583900811405172, 'macro avg': {'precision': 0.3537101610699171, 'recall': 0.3506598051023418, 'f1-score': 0.34263208392208494, 'support': 2637400}, 'weighted avg': {'precision': 0.35635105428200325, 'recall': 0.3583900811405172, 'f1-score': 0.3482716670793171, 'support': 2637400}}
[[324314 362844 120270]
 [369206 464738 177284]
 [293661 368917 156166]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974038
{'0': {'precision': 0.3569379452714372, 'recall': 0.42986409627844635, 'f1-score': 0.3900213755656964, 'support': 287998}, '1': {'precision': 0.33478752759381897, 'recall': 0.4195407863342439, 'f1-score': 0.3724028913887567, 'support': 289190}, '2': {'precision': 0.38288510915293467, 'recall': 0.21319953685835585, 'f1-score': 0.2738903895196808, 'support': 297965}, 'accuracy': 0.35268461628995157, 'macro avg': {'precision': 0.3582035273393969, 'recall': 0.3542014731570154, 'f1-score': 0.3454382188247113, 'support': 875153}, 'weighted avg': {'precision': 0.35845272885529056, 'recall': 0.35268461628995157, 'f1-score': 0.3446600973705348, 'support': 875153}}
[[123800 116044  48154]
 [113629 121327  54234]
 [109410 125029  63526]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964122
{'0': {'precision': 0.3541696654879995, 'recall': 0.47697753803362974, 'f1-score': 0.4065007362712352, 'support': 118645}, '1': {'precision': 0.3482555444226772, 'recall': 0.3798072218416675, 'f1-score': 0.36334771381540454, 'support': 122628}, '2': {'precision': 0.3687306841535541, 'recall': 0.20263291750364246, 'f1-score': 0.2615391463034673, 'support': 115993}, 'accuracy': 0.35455374986704585, 'macro avg': {'precision': 0.35705196468807693, 'recall': 0.3531392257929799, 'f1-score': 0.34379586546336904, 'support': 357266}, 'weighted avg': {'precision': 0.35686720569634656, 'recall': 0.35455374986704585, 'f1-score': 0.34462443529984443, 'support': 357266}}
[[56591 43148 18906]
 [54720 46575 21333]
 [48474 44015 23504]]
training model: results/AAPL/W9/deepOF_L1/h500
Epoch 1/50
3419/3419 - 47s - loss: 3.2633 - accuracy500: 0.3845 - val_loss: 3.3076 - val_accuracy500: 0.3450 - 47s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 45s - loss: 3.2609 - accuracy500: 0.3809 - val_loss: 3.2983 - val_accuracy500: 0.3469 - 45s/epoch - 13ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2659 - accuracy500: 0.3778 - val_loss: 3.2946 - val_accuracy500: 0.3450 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.2674 - accuracy500: 0.3774 - val_loss: 3.2938 - val_accuracy500: 0.3488 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 46s - loss: 3.2633 - accuracy500: 0.3806 - val_loss: 3.2934 - val_accuracy500: 0.3472 - 46s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 45s - loss: 3.2652 - accuracy500: 0.3794 - val_loss: 3.2939 - val_accuracy500: 0.3448 - 45s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.2655 - accuracy500: 0.3788 - val_loss: 3.2937 - val_accuracy500: 0.3450 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.2643 - accuracy500: 0.3792 - val_loss: 3.2934 - val_accuracy500: 0.3460 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 46s - loss: 3.2646 - accuracy500: 0.3793 - val_loss: 3.2933 - val_accuracy500: 0.3454 - 46s/epoch - 14ms/step
Epoch 10/50
3419/3419 - 45s - loss: 3.2638 - accuracy500: 0.3798 - val_loss: 3.2950 - val_accuracy500: 0.3453 - 45s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 45s - loss: 3.2618 - accuracy500: 0.3811 - val_loss: 3.2952 - val_accuracy500: 0.3462 - 45s/epoch - 13ms/step
Epoch 12/50
3419/3419 - 45s - loss: 3.2626 - accuracy500: 0.3807 - val_loss: 3.2944 - val_accuracy500: 0.3445 - 45s/epoch - 13ms/step
Epoch 13/50
3419/3419 - 46s - loss: 3.2642 - accuracy500: 0.3807 - val_loss: 3.2950 - val_accuracy500: 0.3461 - 46s/epoch - 13ms/step
Epoch 14/50
3419/3419 - 47s - loss: 3.2635 - accuracy500: 0.3812 - val_loss: 3.2959 - val_accuracy500: 0.3442 - 47s/epoch - 14ms/step
Epoch 15/50
3419/3419 - 45s - loss: 3.2626 - accuracy500: 0.3811 - val_loss: 3.2954 - val_accuracy500: 0.3467 - 45s/epoch - 13ms/step
Epoch 16/50
3419/3419 - 45s - loss: 3.2618 - accuracy500: 0.3821 - val_loss: 3.2970 - val_accuracy500: 0.3463 - 45s/epoch - 13ms/step
Epoch 17/50
3419/3419 - 45s - loss: 3.2617 - accuracy500: 0.3820 - val_loss: 3.2977 - val_accuracy500: 0.3454 - 45s/epoch - 13ms/step
Epoch 18/50
3419/3419 - 46s - loss: 3.2621 - accuracy500: 0.3814 - val_loss: 3.2974 - val_accuracy500: 0.3462 - 46s/epoch - 13ms/step
Epoch 19/50
3419/3419 - 45s - loss: 3.2619 - accuracy500: 0.3825 - val_loss: 3.2986 - val_accuracy500: 0.3455 - 45s/epoch - 13ms/step
testing model: results/AAPL/W9/deepOF_L1/h500
Evaluating performance on  test set...
10303/10303 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937356
{'0': {'precision': 0.31686460319336457, 'recall': 0.23270444998811174, 'f1-score': 0.2683404488660844, 'support': 794901}, '1': {'precision': 0.39429849160929753, 'recall': 0.7678059001993924, 'f1-score': 0.5210284212525002, 'support': 1034643}, '2': {'precision': 0.33904928400647866, 'recall': 0.016324691529183418, 'f1-score': 0.031149579629478726, 'support': 807856}, 'accuracy': 0.3763441267915371, 'macro avg': {'precision': 0.35007079293638027, 'recall': 0.33894501390556253, 'f1-score': 0.2735061499160211, 'support': 2637400}, 'weighted avg': {'precision': 0.3540369919532361, 'recall': 0.3763441267915371, 'f1-score': 0.29481568013771214, 'support': 2637400}}
[[184977 599543  10381]
 [224910 794405  15328]
 [173886 620782  13188]]
Evaluating performance on  train set...
3419/3419 - 18s - 18s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996749
{'0': {'precision': 0.3516116312252788, 'recall': 0.29880641873801667, 'f1-score': 0.3230654878627268, 'support': 289465}, '1': {'precision': 0.3309824511842894, 'recall': 0.7065300266163913, 'f1-score': 0.4507879086726892, 'support': 288544}, '2': {'precision': 0.3734210725361168, 'recall': 0.016614839942923298, 'f1-score': 0.03181415430219258, 'support': 297144}, 'accuracy': 0.3374221421854236, 'macro avg': {'precision': 0.3520050516485617, 'recall': 0.3406504284324438, 'f1-score': 0.26855585027920287, 'support': 875153}, 'weighted avg': {'precision': 0.3522150897098185, 'recall': 0.3374221421854236, 'f1-score': 0.2662867896587309, 'support': 875153}}
[[ 86494 199095   3876]
 [ 80271 203865   4408]
 [ 79228 212979   4937]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0979706
{'0': {'precision': 0.3484586625282167, 'recall': 0.3341055123435915, 'f1-score': 0.34113117640965435, 'support': 118280}, '1': {'precision': 0.34454102148035404, 'recall': 0.669442023022966, 'f1-score': 0.45493904397028045, 'support': 122747}, '2': {'precision': 0.3782876329043089, 'recall': 0.01744681217147429, 'f1-score': 0.033355263157894735, 'support': 116239}, 'accuracy': 0.3462909988635918, 'macro avg': {'precision': 0.3570957723042933, 'recall': 0.34033144917934394, 'f1-score': 0.2764751611792765, 'support': 357266}, 'weighted avg': {'precision': 0.3568177311265288, 'recall': 0.3462909988635918, 'f1-score': 0.280095449357522, 'support': 357266}}
[[39518 77131  1631]
 [38873 82172  1702]
 [35017 79194  2028]]
training model: results/AAPL/W9/deepOF_L1/h1000
Epoch 1/50
3419/3419 - 48s - loss: 3.2725 - accuracy1000: 0.3786 - val_loss: 3.2993 - val_accuracy1000: 0.3358 - 48s/epoch - 14ms/step
Epoch 2/50
3419/3419 - 46s - loss: 3.2670 - accuracy1000: 0.3769 - val_loss: 3.3000 - val_accuracy1000: 0.3320 - 46s/epoch - 14ms/step
Epoch 3/50
3419/3419 - 45s - loss: 3.2690 - accuracy1000: 0.3748 - val_loss: 3.3007 - val_accuracy1000: 0.3321 - 45s/epoch - 13ms/step
Epoch 4/50
3419/3419 - 45s - loss: 3.2708 - accuracy1000: 0.3742 - val_loss: 3.3016 - val_accuracy1000: 0.3293 - 45s/epoch - 13ms/step
Epoch 5/50
3419/3419 - 45s - loss: 3.2708 - accuracy1000: 0.3738 - val_loss: 3.3031 - val_accuracy1000: 0.3293 - 45s/epoch - 13ms/step
Epoch 6/50
3419/3419 - 46s - loss: 3.2695 - accuracy1000: 0.3755 - val_loss: 3.3038 - val_accuracy1000: 0.3292 - 46s/epoch - 13ms/step
Epoch 7/50
3419/3419 - 45s - loss: 3.2709 - accuracy1000: 0.3744 - val_loss: 3.3045 - val_accuracy1000: 0.3290 - 45s/epoch - 13ms/step
Epoch 8/50
3419/3419 - 45s - loss: 3.2700 - accuracy1000: 0.3758 - val_loss: 3.3038 - val_accuracy1000: 0.3287 - 45s/epoch - 13ms/step
Epoch 9/50
3419/3419 - 45s - loss: 3.2701 - accuracy1000: 0.3751 - val_loss: 3.3045 - val_accuracy1000: 0.3287 - 45s/epoch - 13ms/step
Epoch 10/50
3419/3419 - 46s - loss: 3.2696 - accuracy1000: 0.3757 - val_loss: 3.3046 - val_accuracy1000: 0.3277 - 46s/epoch - 13ms/step
Epoch 11/50
3419/3419 - 46s - loss: 3.2691 - accuracy1000: 0.3768 - val_loss: 3.3046 - val_accuracy1000: 0.3285 - 46s/epoch - 14ms/step
testing model: results/AAPL/W9/deepOF_L1/h1000
Evaluating performance on  test set...
10303/10303 - 60s - 60s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989588
{'0': {'precision': 0.2972966851046838, 'recall': 0.5957813261949969, 'f1-score': 0.3966592192036611, 'support': 771048}, '1': {'precision': 0.40839351960890974, 'recall': 0.3183490616152259, 'f1-score': 0.3577929712560456, 'support': 1073014}, '2': {'precision': 0.3087000375304935, 'recall': 0.09953260779138275, 'f1-score': 0.1505304395070201, 'support': 793338}, 'accuracy': 0.3336361568211117, 'macro avg': {'precision': 0.338130080748029, 'recall': 0.3378876652005352, 'f1-score': 0.30166087665557556, 'support': 2637400}, 'weighted avg': {'precision': 0.34592608208106385, 'recall': 0.3336361568211117, 'f1-score': 0.3068103748864409, 'support': 2637400}}
[[459376 240849  70823]
 [625415 341593 106006]
 [460386 253989  78963]]
Evaluating performance on  train set...
3419/3419 - 17s - 17s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.10072
{'0': {'precision': 0.33418513721761367, 'recall': 0.5661059194356888, 'f1-score': 0.42027338374232653, 'support': 288068}, '1': {'precision': 0.3294104608393885, 'recall': 0.3289376757311974, 'f1-score': 0.3291738985227114, 'support': 289149}, '2': {'precision': 0.352974043785239, 'recall': 0.11661900542398368, 'f1-score': 0.1753155503303723, 'support': 297936}, 'accuracy': 0.3347231855458417, 'macro avg': {'precision': 0.33885654728074704, 'recall': 0.33722086686362335, 'f1-score': 0.3082542775318034, 'support': 875153}, 'weighted avg': {'precision': 0.3390040646132172, 'recall': 0.3347231855458417, 'f1-score': 0.3067811348359176, 'support': 875153}}
[[163077  93793  31198]
 [161545  95112  32492]
 [163362  99829  34745]]
Evaluating performance on  val set...
1396/1396 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002014
{'0': {'precision': 0.3307959686972057, 'recall': 0.5838302830899993, 'f1-score': 0.4223117446544778, 'support': 116712}, '1': {'precision': 0.3389478279851561, 'recall': 0.3193293901827066, 'f1-score': 0.3288462678854316, 'support': 121561}, '2': {'precision': 0.34576769243327077, 'recall': 0.1067961980956863, 'f1-score': 0.16318878173436235, 'support': 118993}, 'accuracy': 0.33494930947809193, 'macro avg': {'precision': 0.3385038297052108, 'recall': 0.33665195712279744, 'f1-score': 0.30478226475809056, 'support': 357266}, 'weighted avg': {'precision': 0.33855623272856644, 'recall': 0.33494930947809193, 'f1-score': 0.3042048563743859, 'support': 357266}}
[[68140 36869 11703]
 [70401 38818 12342]
 [67447 38838 12708]]
training model: results/AAPL/W9/deepLOB_L2/h10
Epoch 1/50
3419/3419 - 143s - loss: 3.1617 - accuracy10: 0.4306 - val_loss: 3.2629 - val_accuracy10: 0.3845 - 143s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 140s - loss: 3.1002 - accuracy10: 0.4588 - val_loss: 3.2210 - val_accuracy10: 0.4077 - 140s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 140s - loss: 3.0710 - accuracy10: 0.4697 - val_loss: 3.2412 - val_accuracy10: 0.4161 - 140s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.0549 - accuracy10: 0.4748 - val_loss: 3.2373 - val_accuracy10: 0.4244 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 140s - loss: 3.0453 - accuracy10: 0.4781 - val_loss: 3.1983 - val_accuracy10: 0.4278 - 140s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.0378 - accuracy10: 0.4805 - val_loss: 3.2207 - val_accuracy10: 0.4307 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 138s - loss: 3.0298 - accuracy10: 0.4832 - val_loss: 3.1847 - val_accuracy10: 0.4332 - 138s/epoch - 40ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.0234 - accuracy10: 0.4851 - val_loss: 3.1640 - val_accuracy10: 0.4390 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 138s - loss: 3.0185 - accuracy10: 0.4863 - val_loss: 3.1804 - val_accuracy10: 0.4326 - 138s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 140s - loss: 3.0132 - accuracy10: 0.4884 - val_loss: 3.1578 - val_accuracy10: 0.4409 - 140s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.0077 - accuracy10: 0.4899 - val_loss: 3.1538 - val_accuracy10: 0.4424 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.0035 - accuracy10: 0.4913 - val_loss: 3.1497 - val_accuracy10: 0.4436 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 139s - loss: 2.9993 - accuracy10: 0.4925 - val_loss: 3.1515 - val_accuracy10: 0.4416 - 139s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 139s - loss: 2.9956 - accuracy10: 0.4935 - val_loss: 3.1525 - val_accuracy10: 0.4400 - 139s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 139s - loss: 2.9924 - accuracy10: 0.4944 - val_loss: 3.1492 - val_accuracy10: 0.4398 - 139s/epoch - 41ms/step
Epoch 16/50
3419/3419 - 139s - loss: 2.9889 - accuracy10: 0.4956 - val_loss: 3.1548 - val_accuracy10: 0.4402 - 139s/epoch - 41ms/step
Epoch 17/50
3419/3419 - 139s - loss: 2.9856 - accuracy10: 0.4965 - val_loss: 3.1524 - val_accuracy10: 0.4401 - 139s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 139s - loss: 2.9827 - accuracy10: 0.4977 - val_loss: 3.1599 - val_accuracy10: 0.4384 - 139s/epoch - 41ms/step
Epoch 19/50
3419/3419 - 140s - loss: 2.9792 - accuracy10: 0.4987 - val_loss: 3.1574 - val_accuracy10: 0.4405 - 140s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 139s - loss: 2.9764 - accuracy10: 0.4993 - val_loss: 3.1672 - val_accuracy10: 0.4342 - 139s/epoch - 41ms/step
Epoch 21/50
3419/3419 - 141s - loss: 2.9736 - accuracy10: 0.4998 - val_loss: 3.1633 - val_accuracy10: 0.4380 - 141s/epoch - 41ms/step
Epoch 22/50
3419/3419 - 139s - loss: 2.9707 - accuracy10: 0.5011 - val_loss: 3.1691 - val_accuracy10: 0.4369 - 139s/epoch - 41ms/step
Epoch 23/50
3419/3419 - 139s - loss: 2.9688 - accuracy10: 0.5014 - val_loss: 3.1784 - val_accuracy10: 0.4339 - 139s/epoch - 41ms/step
Epoch 24/50
3419/3419 - 138s - loss: 2.9663 - accuracy10: 0.5026 - val_loss: 3.1564 - val_accuracy10: 0.4421 - 138s/epoch - 40ms/step
Epoch 25/50
3419/3419 - 140s - loss: 2.9641 - accuracy10: 0.5027 - val_loss: 3.1713 - val_accuracy10: 0.4377 - 140s/epoch - 41ms/step
testing model: results/AAPL/W9/deepLOB_L2/h10
Evaluating performance on  test set...
10303/10303 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0641643
{'0': {'precision': 0.4451616966874182, 'recall': 0.3180425605405872, 'f1-score': 0.37101566069163566, 'support': 822217}, '1': {'precision': 0.4352711470446931, 'recall': 0.48738883677013195, 'f1-score': 0.45985802301856654, 'support': 987062}, '2': {'precision': 0.42324245708817776, 'recall': 0.4828365283018868, 'f1-score': 0.45107970034740613, 'support': 828125}, 'accuracy': 0.4331653398569199, 'macro avg': {'precision': 0.434558433606763, 'recall': 0.42942264187086865, 'f1-score': 0.42731779468586945, 'support': 2637404}, 'weighted avg': {'precision': 0.4345776314457758, 'recall': 0.4331653398569199, 'f1-score': 0.42940487701309416, 'support': 2637404}}
[[261500 311369 249348]
 [210448 481083 295531]
 [115479 312797 399849]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0408659
{'0': {'precision': 0.4625761657135449, 'recall': 0.4418963874239281, 'f1-score': 0.4519998662826398, 'support': 290679}, '1': {'precision': 0.447823951975077, 'recall': 0.4772977769151318, 'f1-score': 0.46209135522838807, 'support': 288518}, '2': {'precision': 0.46328669519904264, 'recall': 0.4539037765621357, 'f1-score': 0.45854724194429275, 'support': 295957}, 'accuracy': 0.4576280288954858, 'macro avg': {'precision': 0.45789560429588816, 'recall': 0.4576993136337319, 'f1-score': 0.4575461544851069, 'support': 875154}, 'weighted avg': {'precision': 0.4579529873604141, 'recall': 0.4576280288954858, 'f1-score': 0.4575409686101675, 'support': 875154}}
[[128450  85128  77101]
 [ 72283 137709  78526]
 [ 76951  84670 134336]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0504358
{'0': {'precision': 0.4613795489701213, 'recall': 0.3900493831409054, 'f1-score': 0.42272655222892525, 'support': 116234}, '1': {'precision': 0.4178786919946318, 'recall': 0.6045381003117477, 'f1-score': 0.49416948649546627, 'support': 126705}, '2': {'precision': 0.46562747688243067, 'recall': 0.3083086235097571, 'f1-score': 0.3709788608987144, 'support': 114327}, 'accuracy': 0.4399607015501055, 'macro avg': {'precision': 0.4482952392823946, 'recall': 0.43429870232080336, 'f1-score': 0.429291633207702, 'support': 357266}, 'weighted avg': {'precision': 0.4473112546777766, 'recall': 0.4399607015501055, 'f1-score': 0.43150437793731355, 'support': 357266}}
[[45337 52872 18025]
 [27680 76598 22427]
 [25247 53832 35248]]
training model: results/AAPL/W9/deepLOB_L2/h20
Epoch 1/50
3419/3419 - 143s - loss: 3.2023 - accuracy20: 0.4167 - val_loss: 3.3071 - val_accuracy20: 0.3755 - 143s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 140s - loss: 3.1758 - accuracy20: 0.4296 - val_loss: 3.2967 - val_accuracy20: 0.3926 - 140s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 140s - loss: 3.1557 - accuracy20: 0.4403 - val_loss: 3.2992 - val_accuracy20: 0.4016 - 140s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.1438 - accuracy20: 0.4447 - val_loss: 3.2770 - val_accuracy20: 0.4103 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 140s - loss: 3.1373 - accuracy20: 0.4472 - val_loss: 3.3040 - val_accuracy20: 0.4071 - 140s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.1313 - accuracy20: 0.4494 - val_loss: 3.2726 - val_accuracy20: 0.4062 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.1249 - accuracy20: 0.4517 - val_loss: 3.2944 - val_accuracy20: 0.3923 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 139s - loss: 3.1185 - accuracy20: 0.4542 - val_loss: 3.2614 - val_accuracy20: 0.4021 - 139s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.1126 - accuracy20: 0.4560 - val_loss: 3.2586 - val_accuracy20: 0.4066 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 139s - loss: 3.1085 - accuracy20: 0.4574 - val_loss: 3.2383 - val_accuracy20: 0.4128 - 139s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 140s - loss: 3.1051 - accuracy20: 0.4589 - val_loss: 3.2456 - val_accuracy20: 0.4126 - 140s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.1008 - accuracy20: 0.4603 - val_loss: 3.2445 - val_accuracy20: 0.4138 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 139s - loss: 3.0974 - accuracy20: 0.4616 - val_loss: 3.2380 - val_accuracy20: 0.4138 - 139s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 139s - loss: 3.0941 - accuracy20: 0.4631 - val_loss: 3.2310 - val_accuracy20: 0.4161 - 139s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 138s - loss: 3.0917 - accuracy20: 0.4639 - val_loss: 3.2344 - val_accuracy20: 0.4138 - 138s/epoch - 40ms/step
Epoch 16/50
3419/3419 - 139s - loss: 3.0888 - accuracy20: 0.4646 - val_loss: 3.2311 - val_accuracy20: 0.4141 - 139s/epoch - 41ms/step
Epoch 17/50
3419/3419 - 139s - loss: 3.0862 - accuracy20: 0.4657 - val_loss: 3.2298 - val_accuracy20: 0.4131 - 139s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 139s - loss: 3.0842 - accuracy20: 0.4656 - val_loss: 3.2273 - val_accuracy20: 0.4122 - 139s/epoch - 41ms/step
Epoch 19/50
3419/3419 - 139s - loss: 3.0820 - accuracy20: 0.4666 - val_loss: 3.2273 - val_accuracy20: 0.4119 - 139s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 138s - loss: 3.0798 - accuracy20: 0.4676 - val_loss: 3.2267 - val_accuracy20: 0.4049 - 138s/epoch - 40ms/step
Epoch 21/50
3419/3419 - 139s - loss: 3.0779 - accuracy20: 0.4680 - val_loss: 3.2285 - val_accuracy20: 0.4035 - 139s/epoch - 41ms/step
Epoch 22/50
3419/3419 - 139s - loss: 3.0754 - accuracy20: 0.4689 - val_loss: 3.2326 - val_accuracy20: 0.4051 - 139s/epoch - 41ms/step
Epoch 23/50
3419/3419 - 139s - loss: 3.0737 - accuracy20: 0.4693 - val_loss: 3.2291 - val_accuracy20: 0.4076 - 139s/epoch - 41ms/step
Epoch 24/50
3419/3419 - 139s - loss: 3.0715 - accuracy20: 0.4705 - val_loss: 3.2358 - val_accuracy20: 0.4054 - 139s/epoch - 41ms/step
Epoch 25/50
3419/3419 - 139s - loss: 3.0696 - accuracy20: 0.4706 - val_loss: 3.2292 - val_accuracy20: 0.4055 - 139s/epoch - 41ms/step
Epoch 26/50
3419/3419 - 140s - loss: 3.0683 - accuracy20: 0.4710 - val_loss: 3.2318 - val_accuracy20: 0.4046 - 140s/epoch - 41ms/step
Epoch 27/50
3419/3419 - 139s - loss: 3.0657 - accuracy20: 0.4720 - val_loss: 3.2352 - val_accuracy20: 0.4078 - 139s/epoch - 41ms/step
Epoch 28/50
3419/3419 - 138s - loss: 3.0642 - accuracy20: 0.4721 - val_loss: 3.2364 - val_accuracy20: 0.4057 - 138s/epoch - 40ms/step
Epoch 29/50
3419/3419 - 139s - loss: 3.0623 - accuracy20: 0.4729 - val_loss: 3.2391 - val_accuracy20: 0.4024 - 139s/epoch - 41ms/step
Epoch 30/50
3419/3419 - 139s - loss: 3.0602 - accuracy20: 0.4737 - val_loss: 3.2370 - val_accuracy20: 0.4068 - 139s/epoch - 41ms/step
testing model: results/AAPL/W9/deepLOB_L2/h20
Evaluating performance on  test set...
10303/10303 - 138s - 138s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0628165
{'0': {'precision': 0.43378305246693233, 'recall': 0.3844240247523983, 'f1-score': 0.4076147262510605, 'support': 836121}, '1': {'precision': 0.4210341930890557, 'recall': 0.584699230577684, 'f1-score': 0.48954994027849014, 'support': 955782}, '2': {'precision': 0.44512640834428613, 'recall': 0.29961525769928127, 'f1-score': 0.3581555044538809, 'support': 845501}, 'accuracy': 0.4298146965728421, 'macro avg': {'precision': 0.4333145513000914, 'recall': 0.42291283767645454, 'f1-score': 0.4184400569944772, 'support': 2637404}, 'weighted avg': {'precision': 0.43279939142135604, 'recall': 0.4298146965728421, 'f1-score': 0.42145196212574165, 'support': 2637404}}
[[321425 370249 144447]
 [225601 558845 171336]
 [193955 398221 253325]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.062053
{'0': {'precision': 0.4348517952990735, 'recall': 0.4197705164760057, 'f1-score': 0.42717808835126925, 'support': 289694}, '1': {'precision': 0.44132240572376924, 'recall': 0.3591224860349742, 'f1-score': 0.39600177630773, 'support': 288041}, '2': {'precision': 0.4353864132300978, 'recall': 0.5286313248312986, 'f1-score': 0.4774992976834945, 'support': 297419}, 'accuracy': 0.4368054079624843, 'macro avg': {'precision': 0.43718687141764684, 'recall': 0.4358414424474262, 'f1-score': 0.4335597207808312, 'support': 875154}, 'weighted avg': {'precision': 0.43716316750072837, 'recall': 0.4368054079624843, 'f1-score': 0.4340185160486208, 'support': 875154}}
[[121605  64575 103514]
 [ 84222 103442 100377]
 [ 73820  66374 157225]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0762693
{'0': {'precision': 0.4212512952089604, 'recall': 0.43274226386084663, 'f1-score': 0.426919470778206, 'support': 118373}, '1': {'precision': 0.3806934382732612, 'recall': 0.5208042742363065, 'f1-score': 0.43986083841410906, 'support': 122595}, '2': {'precision': 0.4363272454340756, 'recall': 0.25493129718481833, 'f1-score': 0.32182884931640676, 'support': 116298}, 'accuracy': 0.4050791287164186, 'macro avg': {'precision': 0.41275732630543244, 'recall': 0.40282594509399045, 'f1-score': 0.3962030528362406, 'support': 357266}, 'weighted avg': {'precision': 0.4122415164677659, 'recall': 0.4050791287164186, 'f1-score': 0.39715094500345893, 'support': 357266}}
[[51225 51164 15984]
 [36430 63848 22317]
 [33947 52703 29648]]
training model: results/AAPL/W9/deepLOB_L2/h30
Epoch 1/50
3419/3419 - 143s - loss: 3.2306 - accuracy30: 0.4020 - val_loss: 3.2961 - val_accuracy30: 0.3618 - 143s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.1971 - accuracy30: 0.4190 - val_loss: 3.3571 - val_accuracy30: 0.3462 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.1869 - accuracy30: 0.4247 - val_loss: 3.3657 - val_accuracy30: 0.3426 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 140s - loss: 3.1807 - accuracy30: 0.4286 - val_loss: 3.3786 - val_accuracy30: 0.3646 - 140s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 139s - loss: 3.1760 - accuracy30: 0.4297 - val_loss: 3.3712 - val_accuracy30: 0.3692 - 139s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.1706 - accuracy30: 0.4323 - val_loss: 3.3503 - val_accuracy30: 0.3700 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.1643 - accuracy30: 0.4347 - val_loss: 3.3284 - val_accuracy30: 0.3791 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.1582 - accuracy30: 0.4371 - val_loss: 3.3400 - val_accuracy30: 0.3782 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.1543 - accuracy30: 0.4386 - val_loss: 3.3724 - val_accuracy30: 0.3778 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 139s - loss: 3.1507 - accuracy30: 0.4403 - val_loss: 3.3683 - val_accuracy30: 0.3673 - 139s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 137s - loss: 3.1472 - accuracy30: 0.4418 - val_loss: 3.3462 - val_accuracy30: 0.3725 - 137s/epoch - 40ms/step
testing model: results/AAPL/W9/deepLOB_L2/h30
Evaluating performance on  test set...
10303/10303 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1016176
{'0': {'precision': 0.3317657006072863, 'recall': 0.338767052806093, 'f1-score': 0.3352298244783591, 'support': 857117}, '1': {'precision': 0.3329127752931294, 'recall': 0.5526548211376315, 'f1-score': 0.41552073726636646, 'support': 911455}, '2': {'precision': 0.3923212780476057, 'recall': 0.11249470553570771, 'f1-score': 0.17485209694068315, 'support': 868832}, 'accuracy': 0.33814387177694427, 'macro avg': {'precision': 0.3523332513160071, 'recall': 0.3346388598264774, 'f1-score': 0.3085342195618029, 'support': 2637404}, 'weighted avg': {'precision': 0.3521107559785577, 'recall': 0.33814387177694427, 'f1-score': 0.3101446468351839, 'support': 2637404}}
[[290363 491310  75444]
 [331788 503720  75947]
 [253054 518039  97739]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0993327
{'0': {'precision': 0.3724409837481644, 'recall': 0.20935241319035, 'f1-score': 0.2680381700066162, 'support': 288332}, '1': {'precision': 0.34937929781828597, 'recall': 0.5196377238250268, 'f1-score': 0.41782993554388065, 'support': 288730}, '2': {'precision': 0.3833673544934373, 'recall': 0.3647900648122056, 'f1-score': 0.37384806588521663, 'support': 298092}, 'accuracy': 0.3646661044798973, 'macro avg': {'precision': 0.36839587868662926, 'recall': 0.36459340060919415, 'f1-score': 0.3532387238119045, 'support': 875154}, 'weighted avg': {'precision': 0.36855419711365905, 'recall': 0.3646661044798973, 'f1-score': 0.35349794045366684, 'support': 875154}}
[[ 60363 137737  90232]
 [ 54021 150035  84674]
 [ 47690 141661 108741]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0992976
{'0': {'precision': 0.3816479514723634, 'recall': 0.3171541768523982, 'f1-score': 0.3464249377339294, 'support': 118630}, '1': {'precision': 0.34693792165681714, 'recall': 0.5463470075192923, 'f1-score': 0.4243852976832112, 'support': 121421}, '2': {'precision': 0.371763520222904, 'recall': 0.21399991468668686, 'f1-score': 0.27163648964740533, 'support': 117215}, 'accuracy': 0.3612042567722649, 'macro avg': {'precision': 0.3667831311173615, 'recall': 0.3591670330194591, 'f1-score': 0.347482241688182, 'support': 357266}, 'weighted avg': {'precision': 0.36660837272952523, 'recall': 0.3612042567722649, 'f1-score': 0.34838341383560106, 'support': 357266}}
[[37624 63247 17759]
 [30453 66338 24630]
 [30506 61625 25084]]
training model: results/AAPL/W9/deepLOB_L2/h50
Epoch 1/50
3419/3419 - 144s - loss: 3.2081 - accuracy50: 0.4185 - val_loss: 3.4072 - val_accuracy50: 0.3507 - 144s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 138s - loss: 3.1798 - accuracy50: 0.4296 - val_loss: 3.3277 - val_accuracy50: 0.3595 - 138s/epoch - 40ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.1673 - accuracy50: 0.4364 - val_loss: 3.3432 - val_accuracy50: 0.3625 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 140s - loss: 3.1598 - accuracy50: 0.4393 - val_loss: 3.3381 - val_accuracy50: 0.3728 - 140s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 138s - loss: 3.1541 - accuracy50: 0.4416 - val_loss: 3.3527 - val_accuracy50: 0.3663 - 138s/epoch - 40ms/step
Epoch 6/50
3419/3419 - 138s - loss: 3.1501 - accuracy50: 0.4433 - val_loss: 3.3461 - val_accuracy50: 0.3701 - 138s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 140s - loss: 3.1465 - accuracy50: 0.4446 - val_loss: 3.3370 - val_accuracy50: 0.3755 - 140s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 139s - loss: 3.1434 - accuracy50: 0.4460 - val_loss: 3.3730 - val_accuracy50: 0.3677 - 139s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 140s - loss: 3.1391 - accuracy50: 0.4480 - val_loss: 3.3835 - val_accuracy50: 0.3647 - 140s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 140s - loss: 3.1359 - accuracy50: 0.4492 - val_loss: 3.3765 - val_accuracy50: 0.3647 - 140s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.1328 - accuracy50: 0.4505 - val_loss: 3.3794 - val_accuracy50: 0.3686 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 138s - loss: 3.1302 - accuracy50: 0.4515 - val_loss: 3.3787 - val_accuracy50: 0.3661 - 138s/epoch - 40ms/step
testing model: results/AAPL/W9/deepLOB_L2/h50
Evaluating performance on  test set...
10303/10303 - 137s - 137s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1167855
{'0': {'precision': 0.32292187598321537, 'recall': 0.12062639023943665, 'f1-score': 0.17564221617157108, 'support': 808314}, '1': {'precision': 0.3589035715755364, 'recall': 0.6843451850056712, 'f1-score': 0.47086359708483916, 'support': 1006834}, '2': {'precision': 0.27097848262057816, 'recall': 0.13698410227471736, 'f1-score': 0.18197621817241824, 'support': 822256}, 'accuracy': 0.3409269114629386, 'macro avg': {'precision': 0.3176013100597766, 'recall': 0.31398522583994176, 'f1-score': 0.27616067714294285, 'support': 2637404}, 'weighted avg': {'precision': 0.3204637116849927, 'recall': 0.3409269114629386, 'f1-score': 0.29031827451516873, 'support': 2637404}}
[[ 97504 604873 105937]
 [120721 689022 197091]
 [ 83718 625902 112636]]
Evaluating performance on  train set...
3419/3419 - 47s - 47s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1185092
{'0': {'precision': 0.38301812871745555, 'recall': 0.07513134361725911, 'f1-score': 0.12562130212075018, 'support': 286272}, '1': {'precision': 0.329378390585274, 'recall': 0.8956027086790188, 'f1-score': 0.48162731484702187, 'support': 289883}, '2': {'precision': 0.3786540210471612, 'recall': 0.03899009695684601, 'f1-score': 0.07070017920657878, 'support': 298999}, 'accuracy': 0.3345536899791351, 'macro avg': {'precision': 0.3636835134499636, 'recall': 0.336574716417708, 'f1-score': 0.22598293205811693, 'support': 875154}, 'weighted avg': {'precision': 0.36375967587569114, 'recall': 0.3345536899791351, 'f1-score': 0.22477954187845625, 'support': 875154}}
[[ 21508 256694   8070]
 [ 19203 259620  11060]
 [ 15443 271898  11658]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1110435
{'0': {'precision': 0.38139830172208555, 'recall': 0.12421386356979168, 'f1-score': 0.1873964270163832, 'support': 116074}, '1': {'precision': 0.35633552625122267, 'recall': 0.8667059207333084, 'f1-score': 0.5050329424746962, 'support': 125677}, '2': {'precision': 0.3636627485125526, 'recall': 0.04338830454919274, 'f1-score': 0.07752693411293379, 'support': 115515}, 'accuracy': 0.3592701236613616, 'macro avg': {'precision': 0.36713219216195364, 'recall': 0.34476936295076427, 'f1-score': 0.25665210120133775, 'support': 357266}, 'weighted avg': {'precision': 0.36684741565441936, 'recall': 0.3592701236613616, 'f1-score': 0.26360863271329377, 'support': 357266}}
[[ 14418  98048   3608]
 [ 11590 108925   5162]
 [ 11795  98708   5012]]
training model: results/AAPL/W9/deepLOB_L2/h100
Epoch 1/50
3419/3419 - 142s - loss: 3.2612 - accuracy100: 0.3888 - val_loss: 3.3521 - val_accuracy100: 0.3541 - 142s/epoch - 41ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.2418 - accuracy100: 0.3998 - val_loss: 3.3669 - val_accuracy100: 0.3517 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 140s - loss: 3.2321 - accuracy100: 0.4053 - val_loss: 3.3952 - val_accuracy100: 0.3476 - 140s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 140s - loss: 3.2239 - accuracy100: 0.4097 - val_loss: 3.3813 - val_accuracy100: 0.3519 - 140s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 141s - loss: 3.2194 - accuracy100: 0.4118 - val_loss: 3.3725 - val_accuracy100: 0.3563 - 141s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 141s - loss: 3.2161 - accuracy100: 0.4134 - val_loss: 3.3501 - val_accuracy100: 0.3564 - 141s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.2122 - accuracy100: 0.4152 - val_loss: 3.3647 - val_accuracy100: 0.3526 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 141s - loss: 3.2089 - accuracy100: 0.4170 - val_loss: 3.3652 - val_accuracy100: 0.3564 - 141s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 141s - loss: 3.2059 - accuracy100: 0.4180 - val_loss: 3.3751 - val_accuracy100: 0.3526 - 141s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 140s - loss: 3.2025 - accuracy100: 0.4200 - val_loss: 3.3817 - val_accuracy100: 0.3593 - 140s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.2000 - accuracy100: 0.4210 - val_loss: 3.3628 - val_accuracy100: 0.3550 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.1980 - accuracy100: 0.4219 - val_loss: 3.3691 - val_accuracy100: 0.3542 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 139s - loss: 3.1960 - accuracy100: 0.4229 - val_loss: 3.3710 - val_accuracy100: 0.3520 - 139s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 138s - loss: 3.1932 - accuracy100: 0.4240 - val_loss: 3.3650 - val_accuracy100: 0.3537 - 138s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 139s - loss: 3.1904 - accuracy100: 0.4258 - val_loss: 3.3625 - val_accuracy100: 0.3566 - 139s/epoch - 41ms/step
Epoch 16/50
3419/3419 - 140s - loss: 3.1882 - accuracy100: 0.4268 - val_loss: 3.3890 - val_accuracy100: 0.3485 - 140s/epoch - 41ms/step
testing model: results/AAPL/W9/deepLOB_L2/h100
Evaluating performance on  test set...
10303/10303 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121223
{'0': {'precision': 0.3081437435367115, 'recall': 0.5334437308389465, 'f1-score': 0.39063639417601415, 'support': 804366}, '1': {'precision': 0.37818717733467627, 'recall': 0.41699520763001957, 'f1-score': 0.3966442001672005, 'support': 1016616}, '2': {'precision': 0.29299845951591696, 'recall': 0.044496596123083404, 'f1-score': 0.07726000070182228, 'support': 816422}, 'accuracy': 0.3372012782266198, 'macro avg': {'precision': 0.3264431267957682, 'recall': 0.3316451781973498, 'f1-score': 0.28818019834834563, 'support': 2637404}, 'weighted avg': {'precision': 0.3304544446743175, 'recall': 0.3372012782266198, 'f1-score': 0.2959448906303113, 'support': 2637404}}
[[429084 340752  34530]
 [539563 423924  53129]
 [423833 356261  36328]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1044408
{'0': {'precision': 0.3556753487389714, 'recall': 0.25875586256028443, 'f1-score': 0.29957163621220484, 'support': 286351}, '1': {'precision': 0.361030379284843, 'recall': 0.6487754362346606, 'f1-score': 0.4639063039936812, 'support': 289695}, '2': {'precision': 0.3970953250323084, 'recall': 0.19415729435521617, 'f1-score': 0.2607986886865535, 'support': 299108}, 'accuracy': 0.36578247942647807, 'macro avg': {'precision': 0.37126701768537423, 'recall': 0.36722953105005374, 'f1-score': 0.34142554296414646, 'support': 875154}, 'weighted avg': {'precision': 0.37160439876117746, 'recall': 0.36578247942647807, 'f1-score': 0.3407182604571403, 'support': 875154}}
[[ 74095 162882  49374]
 [ 62949 187947  38799]
 [ 71278 169756  58074]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1187227
{'0': {'precision': 0.3620830895260386, 'recall': 0.26022742564930695, 'f1-score': 0.3028197273252229, 'support': 118896}, '1': {'precision': 0.3533270252236426, 'recall': 0.778571547241282, 'f1-score': 0.4860689383351182, 'support': 120382}, '2': {'precision': 0.35150404641930066, 'recall': 0.01951045869071431, 'f1-score': 0.036968932927563695, 'support': 117988}, 'accuracy': 0.355387862265091, 'macro avg': {'precision': 0.35563805372299395, 'recall': 0.35276981052710105, 'f1-score': 0.27528586619596823, 'support': 357266}, 'weighted avg': {'precision': 0.35563894798744045, 'recall': 0.355387862265091, 'f1-score': 0.2767682782379943, 'support': 357266}}
[[30940 85827  2129]
 [24538 93726  2118]
 [29972 85714  2302]]
training model: results/AAPL/W9/deepLOB_L2/h200
Epoch 1/50
3419/3419 - 143s - loss: 3.2499 - accuracy200: 0.3935 - val_loss: 3.3258 - val_accuracy200: 0.3411 - 143s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 138s - loss: 3.2294 - accuracy200: 0.4067 - val_loss: 3.3150 - val_accuracy200: 0.3554 - 138s/epoch - 40ms/step
Epoch 3/50
3419/3419 - 138s - loss: 3.2228 - accuracy200: 0.4103 - val_loss: 3.3144 - val_accuracy200: 0.3534 - 138s/epoch - 40ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.2184 - accuracy200: 0.4142 - val_loss: 3.3149 - val_accuracy200: 0.3507 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 139s - loss: 3.2142 - accuracy200: 0.4163 - val_loss: 3.3237 - val_accuracy200: 0.3528 - 139s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.2113 - accuracy200: 0.4177 - val_loss: 3.3482 - val_accuracy200: 0.3556 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.2082 - accuracy200: 0.4196 - val_loss: 3.3335 - val_accuracy200: 0.3550 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.2058 - accuracy200: 0.4203 - val_loss: 3.3342 - val_accuracy200: 0.3516 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.2016 - accuracy200: 0.4223 - val_loss: 3.3645 - val_accuracy200: 0.3482 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 139s - loss: 3.1994 - accuracy200: 0.4232 - val_loss: 3.3525 - val_accuracy200: 0.3511 - 139s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 138s - loss: 3.1971 - accuracy200: 0.4244 - val_loss: 3.3611 - val_accuracy200: 0.3432 - 138s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 138s - loss: 3.1955 - accuracy200: 0.4250 - val_loss: 3.3451 - val_accuracy200: 0.3487 - 138s/epoch - 40ms/step
Epoch 13/50
3419/3419 - 138s - loss: 3.1939 - accuracy200: 0.4258 - val_loss: 3.3674 - val_accuracy200: 0.3472 - 138s/epoch - 40ms/step
testing model: results/AAPL/W9/deepLOB_L2/h200
Evaluating performance on  test set...
10303/10303 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1202276
{'0': {'precision': 0.3113784299866018, 'recall': 0.5816858696268048, 'f1-score': 0.4056246183129065, 'support': 811854}, '1': {'precision': 0.35305951239556227, 'recall': 0.0823315460196671, 'f1-score': 0.1335256428934495, 'support': 1001876}, '2': {'precision': 0.30551948491119857, 'recall': 0.329063440147437, 'f1-score': 0.31685470493131374, 'support': 823674}, 'accuracy': 0.3130999270494774, 'macro avg': {'precision': 0.32331914243112087, 'recall': 0.33102695193130294, 'f1-score': 0.2853349887125566, 'support': 2637404}, 'weighted avg': {'precision': 0.32538213036527797, 'recall': 0.3130999270494774, 'f1-score': 0.2745385568934145, 'support': 2637404}}
[[472244  74672 264938]
 [568221  82486 351169]
 [476159  76474 271041]]
Evaluating performance on  train set...
3419/3419 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1158495
{'0': {'precision': 0.3080898381052683, 'recall': 0.08744252004629678, 'f1-score': 0.1362222396694886, 'support': 287709}, '1': {'precision': 0.3260420851197476, 'recall': 0.7736652189134572, 'f1-score': 0.458753743353428, 'support': 288493}, '2': {'precision': 0.34155566367700657, 'recall': 0.12445476196847655, 'f1-score': 0.1824346687653077, 'support': 298952}, 'accuracy': 0.3262980001234069, 'macro avg': {'precision': 0.3252291956340075, 'recall': 0.3285208336427435, 'f1-score': 0.2591368839294081, 'support': 875154}, 'weighted avg': {'precision': 0.32543966806007685, 'recall': 0.3262980001234069, 'f1-score': 0.25833032486974367, 'support': 875154}}
[[ 25158 226407  36144]
 [ 29715 223197  35581]
 [ 26785 234961  37206]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1048725
{'0': {'precision': 0.34450859405266987, 'recall': 0.30656105743763085, 'f1-score': 0.32442894135025224, 'support': 118929}, '1': {'precision': 0.35901856444583563, 'recall': 0.6155421249050497, 'f1-score': 0.45351931891803104, 'support': 121116}, '2': {'precision': 0.3458727330866566, 'recall': 0.12918333745659907, 'f1-score': 0.18810829611870586, 'support': 117221}, 'accuracy': 0.3531094478623771, 'macro avg': {'precision': 0.3497999638617207, 'recall': 0.3504288399330932, 'f1-score': 0.32201885212899634, 'support': 357266}, 'weighted avg': {'precision': 0.34987517054145306, 'recall': 0.3531094478623771, 'f1-score': 0.3234640239352506, 'support': 357266}}
[[36459 67299 15171]
 [33096 74552 13468]
 [36274 65804 15143]]
training model: results/AAPL/W9/deepLOB_L2/h300
Epoch 1/50
3419/3419 - 141s - loss: 3.2435 - accuracy300: 0.4017 - val_loss: 3.3401 - val_accuracy300: 0.3406 - 141s/epoch - 41ms/step
Epoch 2/50
3419/3419 - 138s - loss: 3.2196 - accuracy300: 0.4137 - val_loss: 3.3317 - val_accuracy300: 0.3527 - 138s/epoch - 40ms/step
Epoch 3/50
3419/3419 - 138s - loss: 3.2096 - accuracy300: 0.4192 - val_loss: 3.3379 - val_accuracy300: 0.3527 - 138s/epoch - 40ms/step
Epoch 4/50
3419/3419 - 138s - loss: 3.2048 - accuracy300: 0.4218 - val_loss: 3.3277 - val_accuracy300: 0.3506 - 138s/epoch - 40ms/step
Epoch 5/50
3419/3419 - 137s - loss: 3.2009 - accuracy300: 0.4234 - val_loss: 3.3345 - val_accuracy300: 0.3507 - 137s/epoch - 40ms/step
Epoch 6/50
3419/3419 - 138s - loss: 3.1978 - accuracy300: 0.4256 - val_loss: 3.3305 - val_accuracy300: 0.3495 - 138s/epoch - 40ms/step
Epoch 7/50
3419/3419 - 138s - loss: 3.1921 - accuracy300: 0.4283 - val_loss: 3.3416 - val_accuracy300: 0.3485 - 138s/epoch - 40ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.1898 - accuracy300: 0.4292 - val_loss: 3.3429 - val_accuracy300: 0.3520 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.1861 - accuracy300: 0.4302 - val_loss: 3.3523 - val_accuracy300: 0.3472 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 138s - loss: 3.1833 - accuracy300: 0.4319 - val_loss: 3.3456 - val_accuracy300: 0.3529 - 138s/epoch - 40ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.1797 - accuracy300: 0.4331 - val_loss: 3.3618 - val_accuracy300: 0.3524 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.1762 - accuracy300: 0.4348 - val_loss: 3.3671 - val_accuracy300: 0.3492 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 138s - loss: 3.1734 - accuracy300: 0.4350 - val_loss: 3.3619 - val_accuracy300: 0.3493 - 138s/epoch - 40ms/step
Epoch 14/50
3419/3419 - 138s - loss: 3.1716 - accuracy300: 0.4364 - val_loss: 3.3693 - val_accuracy300: 0.3536 - 138s/epoch - 40ms/step
testing model: results/AAPL/W9/deepLOB_L2/h300
Evaluating performance on  test set...
10303/10303 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151003
{'0': {'precision': 0.31225252372363765, 'recall': 0.6694082838038173, 'f1-score': 0.42585875776324106, 'support': 807431}, '1': {'precision': 0.3769602918863813, 'recall': 0.12505587266175383, 'f1-score': 0.18780709303698445, 'support': 1011228}, '2': {'precision': 0.2964128647166074, 'recall': 0.20670538446036313, 'f1-score': 0.24356156931486028, 'support': 818745}, 'accuracy': 0.3170541942000543, 'macro avg': {'precision': 0.3285418934422088, 'recall': 0.33372318030864473, 'f1-score': 0.2857424733716953, 'support': 2637404}, 'weighted avg': {'precision': 0.3321454431891287, 'recall': 0.3170541942000543, 'f1-score': 0.27799387988561125, 'support': 2637404}}
[[540501 102933 163997]
 [647047 126460 237721]
 [543426 106080 169239]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.114991
{'0': {'precision': 0.31029419588232166, 'recall': 0.20258977013011373, 'f1-score': 0.2451331450474077, 'support': 287902}, '1': {'precision': 0.33232104438948, 'recall': 0.47086940743428896, 'f1-score': 0.3896456012252305, 'support': 289335}, '2': {'precision': 0.3550259358925338, 'recall': 0.33036382616634835, 'f1-score': 0.3422511775414291, 'support': 297917}, 'accuracy': 0.3347822211862141, 'macro avg': {'precision': 0.3325470587214452, 'recall': 0.3346076679102503, 'f1-score': 0.32567664127135576, 'support': 875154}, 'weighted avg': {'precision': 0.3328039301707338, 'recall': 0.3347822211862141, 'f1-score': 0.3259710597398295, 'support': 875154}}
[[ 58326 135013  94563]
 [ 68858 136239  84238]
 [ 60786 138710  98421]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1093725
{'0': {'precision': 0.3408402260257145, 'recall': 0.385935629625883, 'f1-score': 0.36198887513985145, 'support': 118626}, '1': {'precision': 0.36380980175973365, 'recall': 0.5485697987124114, 'f1-score': 0.4374825338437242, 'support': 122710}, '2': {'precision': 0.3231268296542448, 'recall': 0.10568446476321919, 'f1-score': 0.1592751239868181, 'support': 115930}, 'accuracy': 0.35085622477369804, 'macro avg': {'precision': 0.3425922858132309, 'recall': 0.34672996436717124, 'f1-score': 0.3195821776567979, 'support': 357266}, 'weighted avg': {'precision': 0.34298171891050344, 'recall': 0.35085622477369804, 'f1-score': 0.32213963588501354, 'support': 357266}}
[[45782 59702 13142]
 [42872 67315 12523]
 [45667 58011 12252]]
training model: results/AAPL/W9/deepLOB_L2/h500
Epoch 1/50
3419/3419 - 141s - loss: 3.2317 - accuracy500: 0.4103 - val_loss: 3.4746 - val_accuracy500: 0.3311 - 141s/epoch - 41ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.1961 - accuracy500: 0.4266 - val_loss: 3.3959 - val_accuracy500: 0.3287 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.1874 - accuracy500: 0.4317 - val_loss: 3.3978 - val_accuracy500: 0.3382 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.1810 - accuracy500: 0.4356 - val_loss: 3.3953 - val_accuracy500: 0.3410 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 139s - loss: 3.1746 - accuracy500: 0.4372 - val_loss: 3.3816 - val_accuracy500: 0.3428 - 139s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.1686 - accuracy500: 0.4395 - val_loss: 3.3892 - val_accuracy500: 0.3401 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.1616 - accuracy500: 0.4422 - val_loss: 3.3996 - val_accuracy500: 0.3389 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.1568 - accuracy500: 0.4436 - val_loss: 3.4067 - val_accuracy500: 0.3351 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 138s - loss: 3.1527 - accuracy500: 0.4451 - val_loss: 3.4160 - val_accuracy500: 0.3401 - 138s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 139s - loss: 3.1470 - accuracy500: 0.4474 - val_loss: 3.4343 - val_accuracy500: 0.3352 - 139s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 140s - loss: 3.1428 - accuracy500: 0.4482 - val_loss: 3.4788 - val_accuracy500: 0.3394 - 140s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.1373 - accuracy500: 0.4506 - val_loss: 3.4413 - val_accuracy500: 0.3349 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 140s - loss: 3.1347 - accuracy500: 0.4510 - val_loss: 3.4552 - val_accuracy500: 0.3351 - 140s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 138s - loss: 3.1299 - accuracy500: 0.4531 - val_loss: 3.4375 - val_accuracy500: 0.3309 - 138s/epoch - 40ms/step
Epoch 15/50
3419/3419 - 139s - loss: 3.1267 - accuracy500: 0.4537 - val_loss: 3.4637 - val_accuracy500: 0.3276 - 139s/epoch - 41ms/step
testing model: results/AAPL/W9/deepLOB_L2/h500
Evaluating performance on  test set...
10303/10303 - 139s - 139s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1523502
{'0': {'precision': 0.3026945036865122, 'recall': 0.8804267695892072, 'f1-score': 0.4505038495593308, 'support': 794902}, '1': {'precision': 0.410602591488763, 'recall': 0.06205135491179083, 'f1-score': 0.10781015297216376, 'support': 1034643}, '2': {'precision': 0.300735637898076, 'recall': 0.06290082799102319, 'f1-score': 0.10404083421032156, 'support': 807859}, 'accuracy': 0.30896631687826365, 'macro avg': {'precision': 0.3380109110244504, 'recall': 0.3351263174973404, 'f1-score': 0.22078494558060538, 'support': 2637404}, 'weighted avg': {'precision': 0.344426396233503, 'recall': 0.30896631687826365, 'f1-score': 0.2099419563359674, 'support': 2637404}}
[[699853  45858  49191]
 [901479  64201  68963]
 [710745  46299  50815]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1403601
{'0': {'precision': 0.3059055447998483, 'recall': 0.23973360244969621, 'f1-score': 0.26880709946812115, 'support': 289342}, '1': {'precision': 0.31001369071950896, 'recall': 0.49625051931865394, 'f1-score': 0.38162292980403273, 'support': 288840}, '2': {'precision': 0.34661692932854593, 'recall': 0.2171450507118516, 'f1-score': 0.2670139291452043, 'support': 296972}, 'accuracy': 0.31673054113904525, 'macro avg': {'precision': 0.32084538828263437, 'recall': 0.31770972416006726, 'f1-score': 0.30581465280578607, 'support': 875154}, 'weighted avg': {'precision': 0.3210762897815214, 'recall': 0.31673054113904525, 'f1-score': 0.3054328853950408, 'support': 875154}}
[[ 69365 157502  62475]
 [ 86420 143337  59083]
 [ 70968 161518  64486]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273351
{'0': {'precision': 0.3332693864092803, 'recall': 0.46971694127587665, 'f1-score': 0.38990022969963695, 'support': 118350}, '1': {'precision': 0.3609041646900035, 'recall': 0.4404200844735083, 'f1-score': 0.3967169166926792, 'support': 122642}, '2': {'precision': 0.3207019951958429, 'recall': 0.1125273061905499, 'f1-score': 0.16659875725781806, 'support': 116274}, 'accuracy': 0.34341079195893254, 'macro avg': {'precision': 0.3382918487650422, 'recall': 0.340888110646645, 'f1-score': 0.31773863455004475, 'support': 357266}, 'weighted avg': {'precision': 0.3386657119257113, 'recall': 0.34341079195893254, 'f1-score': 0.31956567986702106, 'support': 357266}}
[[55591 48847 13912]
 [54826 54014 13802]
 [56388 46802 13084]]
training model: results/AAPL/W9/deepLOB_L2/h1000
Epoch 1/50
3419/3419 - 145s - loss: 3.2211 - accuracy1000: 0.4178 - val_loss: 3.4507 - val_accuracy1000: 0.3374 - 145s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.1577 - accuracy1000: 0.4434 - val_loss: 3.3958 - val_accuracy1000: 0.3296 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 140s - loss: 3.1393 - accuracy1000: 0.4509 - val_loss: 3.6235 - val_accuracy1000: 0.3271 - 140s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 137s - loss: 3.1285 - accuracy1000: 0.4557 - val_loss: 3.5363 - val_accuracy1000: 0.3254 - 137s/epoch - 40ms/step
Epoch 5/50
3419/3419 - 140s - loss: 3.1187 - accuracy1000: 0.4588 - val_loss: 3.5579 - val_accuracy1000: 0.3206 - 140s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.1100 - accuracy1000: 0.4611 - val_loss: 3.5595 - val_accuracy1000: 0.3223 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.1014 - accuracy1000: 0.4638 - val_loss: 3.6155 - val_accuracy1000: 0.3230 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.0971 - accuracy1000: 0.4656 - val_loss: 3.5760 - val_accuracy1000: 0.3280 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 138s - loss: 3.0924 - accuracy1000: 0.4673 - val_loss: 3.5617 - val_accuracy1000: 0.3273 - 138s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 138s - loss: 3.0853 - accuracy1000: 0.4694 - val_loss: 3.5448 - val_accuracy1000: 0.3253 - 138s/epoch - 40ms/step
Epoch 11/50
3419/3419 - 138s - loss: 3.0789 - accuracy1000: 0.4715 - val_loss: 3.5486 - val_accuracy1000: 0.3279 - 138s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.0735 - accuracy1000: 0.4733 - val_loss: 3.5989 - val_accuracy1000: 0.3282 - 139s/epoch - 41ms/step
testing model: results/AAPL/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
10303/10303 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1180965
{'0': {'precision': 0.29866376200096134, 'recall': 0.6753020884535225, 'f1-score': 0.41415879649275333, 'support': 771049}, '1': {'precision': 0.4323147420754631, 'recall': 0.291818574932713, 'f1-score': 0.3484371426965861, 'support': 1073016}, '2': {'precision': 0.29930878427351637, 'recall': 0.06402433259930496, 'f1-score': 0.10548471506894833, 'support': 793339}, 'accuracy': 0.33540936466313087, 'macro avg': {'precision': 0.3434290961166469, 'recall': 0.34371499866184685, 'f1-score': 0.2893602180860959, 'support': 2637404}, 'weighted avg': {'precision': 0.3532330890211327, 'recall': 0.33540936466313087, 'f1-score': 0.2945701505543881, 'support': 2637404}}
[[520691 200939  49419]
 [690401 313126  69489]
 [532310 210236  50793]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1487795
{'0': {'precision': 0.3069061919626981, 'recall': 0.2156918558837517, 'f1-score': 0.2533387424596711, 'support': 288073}, '1': {'precision': 0.32542935206869633, 'recall': 0.21908548707753478, 'f1-score': 0.2618729297408547, 'support': 289225}, '2': {'precision': 0.3506504374605114, 'recall': 0.5627081542758917, 'f1-score': 0.4320621982310831, 'support': 297856}, 'accuracy': 0.33491933991046147, 'macro avg': {'precision': 0.32766199383063527, 'recall': 0.3324951657457261, 'f1-score': 0.31575795681053626, 'support': 875154}, 'weighted avg': {'precision': 0.3279160336233133, 'recall': 0.33491933991046147, 'f1-score': 0.3169871448650192, 'support': 875154}}
[[ 62135  64456 161482]
 [ 76962  63365 148898]
 [ 63359  66891 167606]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317264
{'0': {'precision': 0.32852232178545215, 'recall': 0.38727447184003566, 'f1-score': 0.35548722707380653, 'support': 116726}, '1': {'precision': 0.3456667434222486, 'recall': 0.23455977894373262, 'f1-score': 0.27947538349231543, 'support': 121598}, '2': {'precision': 0.3211692137190854, 'recall': 0.37034016579509343, 'f1-score': 0.3440064976141573, 'support': 118942}, 'accuracy': 0.3296591335307586, 'macro avg': {'precision': 0.33178609297559536, 'recall': 0.33072480552628725, 'f1-score': 0.32632303606009305, 'support': 357266}, 'weighted avg': {'precision': 0.3319095290835477, 'recall': 0.3296591335307586, 'f1-score': 0.3257938639236278, 'support': 357266}}
[[45205 26400 45121]
 [45094 28522 47982]
 [47302 27591 44049]]
training model: results/AAPL/W9/deepOF_L2/h10
Epoch 1/50
3419/3419 - 121s - loss: 3.1106 - accuracy10: 0.4577 - val_loss: 3.1268 - val_accuracy10: 0.4548 - 121s/epoch - 35ms/step
Epoch 2/50
3419/3419 - 96s - loss: 3.0437 - accuracy10: 0.4820 - val_loss: 3.0951 - val_accuracy10: 0.4669 - 96s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 96s - loss: 3.0127 - accuracy10: 0.4908 - val_loss: 3.0813 - val_accuracy10: 0.4705 - 96s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 95s - loss: 2.9968 - accuracy10: 0.4956 - val_loss: 3.0725 - val_accuracy10: 0.4724 - 95s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 95s - loss: 2.9854 - accuracy10: 0.4990 - val_loss: 3.0671 - val_accuracy10: 0.4750 - 95s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 96s - loss: 2.9769 - accuracy10: 0.5012 - val_loss: 3.0622 - val_accuracy10: 0.4760 - 96s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 2.9696 - accuracy10: 0.5039 - val_loss: 3.0566 - val_accuracy10: 0.4790 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 95s - loss: 2.9637 - accuracy10: 0.5056 - val_loss: 3.0545 - val_accuracy10: 0.4791 - 95s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 96s - loss: 2.9587 - accuracy10: 0.5064 - val_loss: 3.0508 - val_accuracy10: 0.4806 - 96s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 2.9541 - accuracy10: 0.5079 - val_loss: 3.0519 - val_accuracy10: 0.4799 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 95s - loss: 2.9504 - accuracy10: 0.5088 - val_loss: 3.0519 - val_accuracy10: 0.4793 - 95s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 96s - loss: 2.9466 - accuracy10: 0.5097 - val_loss: 3.0481 - val_accuracy10: 0.4809 - 96s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 96s - loss: 2.9439 - accuracy10: 0.5107 - val_loss: 3.0453 - val_accuracy10: 0.4821 - 96s/epoch - 28ms/step
Epoch 14/50
3419/3419 - 96s - loss: 2.9405 - accuracy10: 0.5112 - val_loss: 3.0443 - val_accuracy10: 0.4823 - 96s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 96s - loss: 2.9379 - accuracy10: 0.5123 - val_loss: 3.0441 - val_accuracy10: 0.4832 - 96s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 95s - loss: 2.9349 - accuracy10: 0.5130 - val_loss: 3.0402 - val_accuracy10: 0.4831 - 95s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 95s - loss: 2.9323 - accuracy10: 0.5137 - val_loss: 3.0450 - val_accuracy10: 0.4824 - 95s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 96s - loss: 2.9303 - accuracy10: 0.5146 - val_loss: 3.0418 - val_accuracy10: 0.4831 - 96s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 95s - loss: 2.9281 - accuracy10: 0.5147 - val_loss: 3.0441 - val_accuracy10: 0.4825 - 95s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 95s - loss: 2.9253 - accuracy10: 0.5159 - val_loss: 3.0376 - val_accuracy10: 0.4854 - 95s/epoch - 28ms/step
Epoch 21/50
3419/3419 - 95s - loss: 2.9237 - accuracy10: 0.5162 - val_loss: 3.0357 - val_accuracy10: 0.4853 - 95s/epoch - 28ms/step
Epoch 22/50
3419/3419 - 95s - loss: 2.9209 - accuracy10: 0.5170 - val_loss: 3.0402 - val_accuracy10: 0.4848 - 95s/epoch - 28ms/step
Epoch 23/50
3419/3419 - 95s - loss: 2.9195 - accuracy10: 0.5171 - val_loss: 3.0443 - val_accuracy10: 0.4835 - 95s/epoch - 28ms/step
Epoch 24/50
3419/3419 - 95s - loss: 2.9172 - accuracy10: 0.5182 - val_loss: 3.0377 - val_accuracy10: 0.4855 - 95s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 95s - loss: 2.9158 - accuracy10: 0.5179 - val_loss: 3.0381 - val_accuracy10: 0.4864 - 95s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 96s - loss: 2.9140 - accuracy10: 0.5190 - val_loss: 3.0363 - val_accuracy10: 0.4868 - 96s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 96s - loss: 2.9123 - accuracy10: 0.5194 - val_loss: 3.0355 - val_accuracy10: 0.4866 - 96s/epoch - 28ms/step
Epoch 28/50
3419/3419 - 96s - loss: 2.9105 - accuracy10: 0.5200 - val_loss: 3.0393 - val_accuracy10: 0.4851 - 96s/epoch - 28ms/step
Epoch 29/50
3419/3419 - 96s - loss: 2.9088 - accuracy10: 0.5204 - val_loss: 3.0391 - val_accuracy10: 0.4862 - 96s/epoch - 28ms/step
Epoch 30/50
3419/3419 - 95s - loss: 2.9072 - accuracy10: 0.5207 - val_loss: 3.0363 - val_accuracy10: 0.4876 - 95s/epoch - 28ms/step
Epoch 31/50
3419/3419 - 95s - loss: 2.9051 - accuracy10: 0.5215 - val_loss: 3.0401 - val_accuracy10: 0.4857 - 95s/epoch - 28ms/step
Epoch 32/50
3419/3419 - 95s - loss: 2.9036 - accuracy10: 0.5213 - val_loss: 3.0396 - val_accuracy10: 0.4866 - 95s/epoch - 28ms/step
Epoch 33/50
3419/3419 - 96s - loss: 2.9024 - accuracy10: 0.5219 - val_loss: 3.0387 - val_accuracy10: 0.4873 - 96s/epoch - 28ms/step
Epoch 34/50
3419/3419 - 96s - loss: 2.9003 - accuracy10: 0.5225 - val_loss: 3.0383 - val_accuracy10: 0.4870 - 96s/epoch - 28ms/step
Epoch 35/50
3419/3419 - 95s - loss: 2.8983 - accuracy10: 0.5231 - val_loss: 3.0377 - val_accuracy10: 0.4877 - 95s/epoch - 28ms/step
Epoch 36/50
3419/3419 - 95s - loss: 2.8968 - accuracy10: 0.5239 - val_loss: 3.0358 - val_accuracy10: 0.4876 - 95s/epoch - 28ms/step
Epoch 37/50
3419/3419 - 94s - loss: 2.8962 - accuracy10: 0.5236 - val_loss: 3.0354 - val_accuracy10: 0.4881 - 94s/epoch - 28ms/step
Epoch 38/50
3419/3419 - 95s - loss: 2.8946 - accuracy10: 0.5245 - val_loss: 3.0375 - val_accuracy10: 0.4876 - 95s/epoch - 28ms/step
Epoch 39/50
3419/3419 - 97s - loss: 2.8930 - accuracy10: 0.5243 - val_loss: 3.0448 - val_accuracy10: 0.4864 - 97s/epoch - 28ms/step
Epoch 40/50
3419/3419 - 95s - loss: 2.8915 - accuracy10: 0.5249 - val_loss: 3.0367 - val_accuracy10: 0.4879 - 95s/epoch - 28ms/step
Epoch 41/50
3419/3419 - 95s - loss: 2.8899 - accuracy10: 0.5256 - val_loss: 3.0399 - val_accuracy10: 0.4870 - 95s/epoch - 28ms/step
Epoch 42/50
3419/3419 - 95s - loss: 2.8886 - accuracy10: 0.5258 - val_loss: 3.0397 - val_accuracy10: 0.4876 - 95s/epoch - 28ms/step
Epoch 43/50
3419/3419 - 95s - loss: 2.8872 - accuracy10: 0.5261 - val_loss: 3.0374 - val_accuracy10: 0.4873 - 95s/epoch - 28ms/step
Epoch 44/50
3419/3419 - 96s - loss: 2.8861 - accuracy10: 0.5262 - val_loss: 3.0425 - val_accuracy10: 0.4866 - 96s/epoch - 28ms/step
Epoch 45/50
3419/3419 - 96s - loss: 2.8844 - accuracy10: 0.5272 - val_loss: 3.0405 - val_accuracy10: 0.4870 - 96s/epoch - 28ms/step
Epoch 46/50
3419/3419 - 96s - loss: 2.8825 - accuracy10: 0.5272 - val_loss: 3.0460 - val_accuracy10: 0.4861 - 96s/epoch - 28ms/step
Epoch 47/50
3419/3419 - 95s - loss: 2.8816 - accuracy10: 0.5274 - val_loss: 3.0428 - val_accuracy10: 0.4866 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h10
Evaluating performance on  test set...
10303/10303 - 125s - 125s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.024227
{'0': {'precision': 0.48235255367637486, 'recall': 0.37403112324635285, 'f1-score': 0.42134121028698723, 'support': 822215}, '1': {'precision': 0.47674375755431736, 'recall': 0.5242756020144652, 'f1-score': 0.4993811920003204, 'support': 987061}, '2': {'precision': 0.45761557028600425, 'recall': 0.5052673271152629, 'f1-score': 0.4802623385850405, 'support': 828124}, 'accuracy': 0.4714681125350724, 'macro avg': {'precision': 0.47223729383889884, 'recall': 0.4678580174586937, 'f1-score': 0.46699491362411605, 'support': 2637400}, 'weighted avg': {'precision': 0.47248620289825943, 'recall': 0.4714681125350724, 'f1-score': 0.46904888558866364, 'support': 2637400}}
[[307534 306519 208162]
 [181798 517492 287771]
 [148239 261461 418424]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0037014
{'0': {'precision': 0.5010948110020198, 'recall': 0.4672271685017249, 'f1-score': 0.48356871918856464, 'support': 290454}, '1': {'precision': 0.48162217789579337, 'recall': 0.5248688970041019, 'f1-score': 0.5023164290056333, 'support': 288895}, '2': {'precision': 0.5004283335751345, 'recall': 0.4897533501913429, 'f1-score': 0.4950332992766078, 'support': 295804}, 'accuracy': 0.49386907203654673, 'macro avg': {'precision': 0.4943817741576492, 'recall': 0.4939498052323899, 'f1-score': 0.49363948249026857, 'support': 875153}, 'weighted avg': {'precision': 0.49444146806654954, 'recall': 0.49386907203654673, 'f1-score': 0.49363254605765566, 'support': 875153}}
[[135708  81433  73313]
 [ 65953 151632  71310]
 [ 69162  81771 144871]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0116836
{'0': {'precision': 0.48939480033161625, 'recall': 0.4519903301014307, 'f1-score': 0.4699494610671318, 'support': 116237}, '1': {'precision': 0.49669394876556616, 'recall': 0.5228845759692244, 'f1-score': 0.5094528738810354, 'support': 126854}, '2': {'precision': 0.47837071410157256, 'recall': 0.4875673308517626, 'f1-score': 0.4829252423604936, 'support': 114175}, 'accuracy': 0.4885323540443255, 'macro avg': {'precision': 0.48815315439958495, 'recall': 0.48748074564080596, 'f1-score': 0.48744252576955366, 'support': 357266}, 'weighted avg': {'precision': 0.48846342463430686, 'recall': 0.4885323540443255, 'f1-score': 0.4881226870619494, 'support': 357266}}
[[52538 34587 29112]
 [28934 66330 31590]
 [25881 32626 55668]]
training model: results/AAPL/W9/deepOF_L2/h20
Epoch 1/50
3419/3419 - 98s - loss: 3.1791 - accuracy20: 0.4314 - val_loss: 3.2022 - val_accuracy20: 0.4184 - 98s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 95s - loss: 3.1375 - accuracy20: 0.4473 - val_loss: 3.1827 - val_accuracy20: 0.4266 - 95s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 97s - loss: 3.1168 - accuracy20: 0.4558 - val_loss: 3.1751 - val_accuracy20: 0.4300 - 97s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 98s - loss: 3.1038 - accuracy20: 0.4603 - val_loss: 3.1672 - val_accuracy20: 0.4343 - 98s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 98s - loss: 3.0951 - accuracy20: 0.4636 - val_loss: 3.1585 - val_accuracy20: 0.4388 - 98s/epoch - 29ms/step
Epoch 6/50
3419/3419 - 96s - loss: 3.0875 - accuracy20: 0.4661 - val_loss: 3.1527 - val_accuracy20: 0.4409 - 96s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 96s - loss: 3.0813 - accuracy20: 0.4685 - val_loss: 3.1491 - val_accuracy20: 0.4415 - 96s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 95s - loss: 3.0759 - accuracy20: 0.4700 - val_loss: 3.1452 - val_accuracy20: 0.4436 - 95s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 96s - loss: 3.0714 - accuracy20: 0.4712 - val_loss: 3.1419 - val_accuracy20: 0.4437 - 96s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.0673 - accuracy20: 0.4727 - val_loss: 3.1429 - val_accuracy20: 0.4432 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 95s - loss: 3.0637 - accuracy20: 0.4734 - val_loss: 3.1428 - val_accuracy20: 0.4431 - 95s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 96s - loss: 3.0611 - accuracy20: 0.4742 - val_loss: 3.1395 - val_accuracy20: 0.4455 - 96s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 95s - loss: 3.0581 - accuracy20: 0.4752 - val_loss: 3.1379 - val_accuracy20: 0.4465 - 95s/epoch - 28ms/step
Epoch 14/50
3419/3419 - 94s - loss: 3.0550 - accuracy20: 0.4760 - val_loss: 3.1385 - val_accuracy20: 0.4459 - 94s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 96s - loss: 3.0526 - accuracy20: 0.4769 - val_loss: 3.1387 - val_accuracy20: 0.4459 - 96s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 95s - loss: 3.0508 - accuracy20: 0.4780 - val_loss: 3.1371 - val_accuracy20: 0.4463 - 95s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 96s - loss: 3.0485 - accuracy20: 0.4782 - val_loss: 3.1367 - val_accuracy20: 0.4480 - 96s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 95s - loss: 3.0458 - accuracy20: 0.4794 - val_loss: 3.1374 - val_accuracy20: 0.4457 - 95s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 95s - loss: 3.0438 - accuracy20: 0.4800 - val_loss: 3.1384 - val_accuracy20: 0.4460 - 95s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 96s - loss: 3.0423 - accuracy20: 0.4804 - val_loss: 3.1382 - val_accuracy20: 0.4456 - 96s/epoch - 28ms/step
Epoch 21/50
3419/3419 - 95s - loss: 3.0400 - accuracy20: 0.4813 - val_loss: 3.1438 - val_accuracy20: 0.4432 - 95s/epoch - 28ms/step
Epoch 22/50
3419/3419 - 97s - loss: 3.0382 - accuracy20: 0.4817 - val_loss: 3.1390 - val_accuracy20: 0.4459 - 97s/epoch - 28ms/step
Epoch 23/50
3419/3419 - 95s - loss: 3.0364 - accuracy20: 0.4821 - val_loss: 3.1441 - val_accuracy20: 0.4436 - 95s/epoch - 28ms/step
Epoch 24/50
3419/3419 - 95s - loss: 3.0348 - accuracy20: 0.4828 - val_loss: 3.1415 - val_accuracy20: 0.4443 - 95s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 95s - loss: 3.0327 - accuracy20: 0.4834 - val_loss: 3.1433 - val_accuracy20: 0.4440 - 95s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 95s - loss: 3.0309 - accuracy20: 0.4842 - val_loss: 3.1399 - val_accuracy20: 0.4462 - 95s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 95s - loss: 3.0297 - accuracy20: 0.4844 - val_loss: 3.1396 - val_accuracy20: 0.4449 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h20
Evaluating performance on  test set...
10303/10303 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.048754
{'0': {'precision': 0.4358434545978778, 'recall': 0.43751308127192423, 'f1-score': 0.4366766719926276, 'support': 836119}, '1': {'precision': 0.4341831893630393, 'recall': 0.3686451184947179, 'f1-score': 0.3987390871112907, 'support': 955781}, '2': {'precision': 0.43424173498430924, 'recall': 0.5066930810171496, 'f1-score': 0.4676780556180229, 'support': 845500}, 'accuracy': 0.43473344960946386, 'macro avg': {'precision': 0.43475612631507543, 'recall': 0.4376170935945973, 'f1-score': 0.4343646049073137, 'support': 2637400}, 'weighted avg': {'precision': 0.434728301833909, 'recall': 0.43473344960946386, 'f1-score': 0.4328667254694618, 'support': 2637400}}
[[365813 246638 223668]
 [268946 352344 334491]
 [204563 212528 428409]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0423887
{'0': {'precision': 0.452160349106914, 'recall': 0.49941477663111594, 'f1-score': 0.47461425512890976, 'support': 289633}, '1': {'precision': 0.4366900434410504, 'recall': 0.3738757197130177, 'f1-score': 0.4028490017829647, 'support': 287962}, '2': {'precision': 0.46280003887143273, 'recall': 0.4801450473521129, 'f1-score': 0.4713130166856902, 'support': 297558}, 'accuracy': 0.45155532803978277, 'macro avg': {'precision': 0.4505501438064657, 'recall': 0.4511451812320822, 'f1-score': 0.4495920911991882, 'support': 875153}, 'weighted avg': {'precision': 0.4506875376634262, 'recall': 0.45155532803978277, 'f1-score': 0.4498780366703173, 'support': 875153}}
[[144647  68772  76214]
 [ 90675 107662  89625]
 [ 84580  70107 142871]]
Evaluating performance on  val set...
1396/1396 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0453624
{'0': {'precision': 0.45234901447125475, 'recall': 0.48436919125350636, 'f1-score': 0.4678118242278346, 'support': 118356}, '1': {'precision': 0.43760518692233413, 'recall': 0.38831853496115426, 'f1-score': 0.41149128079179836, 'support': 122536}, '2': {'precision': 0.44995361133689665, 'recall': 0.47092133981817247, 'f1-score': 0.4601987647530556, 'support': 116374}, 'accuracy': 0.44704505886370377, 'macro avg': {'precision': 0.4466359375768285, 'recall': 0.447869688677611, 'f1-score': 0.44650062325756285, 'support': 357266}, 'weighted avg': {'precision': 0.44651187268644366, 'recall': 0.44704505886370377, 'f1-score': 0.44601502214256455, 'support': 357266}}
[[57328 31294 29734]
 [37693 47583 37260]
 [31713 29858 54803]]
training model: results/AAPL/W9/deepOF_L2/h30
Epoch 1/50
3419/3419 - 99s - loss: 3.2136 - accuracy30: 0.4159 - val_loss: 3.2327 - val_accuracy30: 0.3920 - 99s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 98s - loss: 3.1848 - accuracy30: 0.4282 - val_loss: 3.2171 - val_accuracy30: 0.4019 - 98s/epoch - 29ms/step
Epoch 3/50
3419/3419 - 99s - loss: 3.1686 - accuracy30: 0.4348 - val_loss: 3.2200 - val_accuracy30: 0.4006 - 99s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 98s - loss: 3.1558 - accuracy30: 0.4404 - val_loss: 3.2161 - val_accuracy30: 0.4033 - 98s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 96s - loss: 3.1476 - accuracy30: 0.4433 - val_loss: 3.2106 - val_accuracy30: 0.4066 - 96s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 95s - loss: 3.1409 - accuracy30: 0.4464 - val_loss: 3.2065 - val_accuracy30: 0.4085 - 95s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 3.1356 - accuracy30: 0.4481 - val_loss: 3.2061 - val_accuracy30: 0.4092 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 96s - loss: 3.1315 - accuracy30: 0.4498 - val_loss: 3.2016 - val_accuracy30: 0.4105 - 96s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 94s - loss: 3.1276 - accuracy30: 0.4514 - val_loss: 3.1991 - val_accuracy30: 0.4121 - 94s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.1239 - accuracy30: 0.4523 - val_loss: 3.1971 - val_accuracy30: 0.4137 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 95s - loss: 3.1205 - accuracy30: 0.4539 - val_loss: 3.2002 - val_accuracy30: 0.4133 - 95s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 95s - loss: 3.1184 - accuracy30: 0.4543 - val_loss: 3.1989 - val_accuracy30: 0.4144 - 95s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 96s - loss: 3.1154 - accuracy30: 0.4555 - val_loss: 3.1975 - val_accuracy30: 0.4149 - 96s/epoch - 28ms/step
Epoch 14/50
3419/3419 - 95s - loss: 3.1128 - accuracy30: 0.4565 - val_loss: 3.1994 - val_accuracy30: 0.4149 - 95s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 94s - loss: 3.1100 - accuracy30: 0.4577 - val_loss: 3.2009 - val_accuracy30: 0.4152 - 94s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 95s - loss: 3.1076 - accuracy30: 0.4579 - val_loss: 3.2088 - val_accuracy30: 0.4120 - 95s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 95s - loss: 3.1058 - accuracy30: 0.4589 - val_loss: 3.2019 - val_accuracy30: 0.4156 - 95s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 95s - loss: 3.1036 - accuracy30: 0.4592 - val_loss: 3.2004 - val_accuracy30: 0.4174 - 95s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 97s - loss: 3.1013 - accuracy30: 0.4603 - val_loss: 3.2004 - val_accuracy30: 0.4168 - 97s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 97s - loss: 3.0996 - accuracy30: 0.4609 - val_loss: 3.2031 - val_accuracy30: 0.4159 - 97s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h30
Evaluating performance on  test set...
10303/10303 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.071993
{'0': {'precision': 0.43733615354016964, 'recall': 0.37583871475822966, 'f1-score': 0.404262021052843, 'support': 857115}, '1': {'precision': 0.36410795613392677, 'recall': 0.5558437397828085, 'f1-score': 0.4399951191360697, 'support': 911454}, '2': {'precision': 0.4610929849978602, 'recall': 0.27033795985640474, 'f1-score': 0.3408412994975421, 'support': 868831}, 'accuracy': 0.4032914992037613, 'macro avg': {'precision': 0.4208456982239855, 'recall': 0.4006734714658144, 'f1-score': 0.3950328132288183, 'support': 2637400}, 'weighted avg': {'precision': 0.41985550524772525, 'recall': 0.4032914992037613, 'f1-score': 0.39571845020683394, 'support': 2637400}}
[[322137 429940 105038]
 [235350 506626 169478]
 [179102 454851 234878]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0693405
{'0': {'precision': 0.4461624374730188, 'recall': 0.3904884051440258, 'f1-score': 0.41647303694584464, 'support': 288490}, '1': {'precision': 0.35953729337300266, 'recall': 0.5425398773431515, 'f1-score': 0.4324759020162717, 'support': 288447}, '2': {'precision': 0.47219539266903954, 'recall': 0.2967245218231081, 'f1-score': 0.3644383490557296, 'support': 298216}, 'accuracy': 0.40865311551237327, 'macro avg': {'precision': 0.42596504117168693, 'recall': 0.40991760143676176, 'f1-score': 0.404462429339282, 'support': 875153}, 'weighted avg': {'precision': 0.42648208538203486, 'recall': 0.40865311551237327, 'f1-score': 0.4040162458900303, 'support': 875153}}
[[112652 133911  41927]
 [ 74971 156494  56982]
 [ 64868 144860  88488]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0660912
{'0': {'precision': 0.45404569323074195, 'recall': 0.3881958541454334, 'f1-score': 0.4185465707643127, 'support': 118721}, '1': {'precision': 0.3703967012654628, 'recall': 0.5362818887004068, 'f1-score': 0.43816418457729356, 'support': 121438}, '2': {'precision': 0.4589181615752208, 'recall': 0.3132605224282067, 'f1-score': 0.3723514933137101, 'support': 117107}, 'accuracy': 0.4139688635358528, 'macro avg': {'precision': 0.42778685202380845, 'recall': 0.41257942175801565, 'f1-score': 0.40968741621843874, 'support': 357266}, 'weighted avg': {'precision': 0.4272097610797321, 'recall': 0.4139688635358528, 'f1-score': 0.4100726517549837, 'support': 357266}}
[[46087 55183 17451]
 [30511 65125 25802]
 [24905 55517 36685]]
training model: results/AAPL/W9/deepOF_L2/h50
Epoch 1/50
3419/3419 - 99s - loss: 3.1986 - accuracy50: 0.4292 - val_loss: 3.2691 - val_accuracy50: 0.3664 - 99s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 95s - loss: 3.1760 - accuracy50: 0.4376 - val_loss: 3.2740 - val_accuracy50: 0.3667 - 95s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 95s - loss: 3.1576 - accuracy50: 0.4444 - val_loss: 3.2844 - val_accuracy50: 0.3655 - 95s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 95s - loss: 3.1461 - accuracy50: 0.4488 - val_loss: 3.2836 - val_accuracy50: 0.3662 - 95s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 94s - loss: 3.1372 - accuracy50: 0.4529 - val_loss: 3.2886 - val_accuracy50: 0.3654 - 94s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 97s - loss: 3.1306 - accuracy50: 0.4552 - val_loss: 3.2856 - val_accuracy50: 0.3655 - 97s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 96s - loss: 3.1261 - accuracy50: 0.4571 - val_loss: 3.2877 - val_accuracy50: 0.3665 - 96s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 96s - loss: 3.1224 - accuracy50: 0.4582 - val_loss: 3.2884 - val_accuracy50: 0.3673 - 96s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 95s - loss: 3.1185 - accuracy50: 0.4594 - val_loss: 3.2863 - val_accuracy50: 0.3694 - 95s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.1156 - accuracy50: 0.4605 - val_loss: 3.2877 - val_accuracy50: 0.3677 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 98s - loss: 3.1134 - accuracy50: 0.4616 - val_loss: 3.2824 - val_accuracy50: 0.3696 - 98s/epoch - 29ms/step
testing model: results/AAPL/W9/deepOF_L2/h50
Evaluating performance on  test set...
10303/10303 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812336
{'0': {'precision': 0.411552336994005, 'recall': 0.19193949860944784, 'f1-score': 0.26178696894942344, 'support': 808312}, '1': {'precision': 0.3810364399811671, 'recall': 0.8271183006516473, 'f1-score': 0.5217249117584041, 'support': 1006833}, '2': {'precision': 0.43378160013888706, 'recall': 0.039503560331040855, 'f1-score': 0.07241265538335324, 'support': 822255}, 'accuracy': 0.3868958064760749, 'macro avg': {'precision': 0.40879012570468637, 'recall': 0.35285378653071203, 'f1-score': 0.28530817869706027, 'support': 2637400}, 'weighted avg': {'precision': 0.40683318579588124, 'recall': 0.3868958064760749, 'f1-score': 0.30197811271636266, 'support': 2637400}}
[[155147 640158  13007]
 [144671 832770  29392]
 [ 77162 712611  32482]]
Evaluating performance on  train set...
3419/3419 - 48s - 48s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0999873
{'0': {'precision': 0.43132303426421076, 'recall': 0.15214763787779284, 'f1-score': 0.22494628765029132, 'support': 286268}, '1': {'precision': 0.33192753391007157, 'recall': 0.857021226724025, 'f1-score': 0.4785217861590191, 'support': 290106}, '2': {'precision': 0.4590777066008833, 'recall': 0.038617171889590636, 'f1-score': 0.07124157178492924, 'support': 298779}, 'accuracy': 0.34704788762650646, 'macro avg': {'precision': 0.40744275825838855, 'recall': 0.34926201216380287, 'f1-score': 0.25823654853141326, 'support': 875153}, 'weighted avg': {'precision': 0.4078497469879754, 'recall': 0.34704788762650646, 'f1-score': 0.2565293734293905, 'support': 875153}}
[[ 43555 237848   4865]
 [ 32749 248627   8730]
 [ 24676 262565  11538]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0906167
{'0': {'precision': 0.42833678336783365, 'recall': 0.1640385344500741, 'f1-score': 0.23722709600239256, 'support': 116052}, '1': {'precision': 0.35344621036658413, 'recall': 0.8451188363821542, 'f1-score': 0.49843611047888103, 'support': 125677}, '2': {'precision': 0.44812469556746226, 'recall': 0.0477769026372504, 'f1-score': 0.08634781588518242, 'support': 115537}, 'accuracy': 0.36602699389250587, 'macro avg': {'precision': 0.4099692297672934, 'recall': 0.3523114244898262, 'f1-score': 0.27400367412215204, 'support': 357266}, 'weighted avg': {'precision': 0.40839145822838696, 'recall': 0.36602699389250587, 'f1-score': 0.28032054997075095, 'support': 357266}}
[[ 19037  94473   2542]
 [ 15209 106212   4256]
 [ 10198  99819   5520]]
training model: results/AAPL/W9/deepOF_L2/h100
Epoch 1/50
3419/3419 - 103s - loss: 3.2539 - accuracy100: 0.3954 - val_loss: 3.2911 - val_accuracy100: 0.3459 - 103s/epoch - 30ms/step
Epoch 2/50
3419/3419 - 97s - loss: 3.2352 - accuracy100: 0.4048 - val_loss: 3.3104 - val_accuracy100: 0.3435 - 97s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 96s - loss: 3.2254 - accuracy100: 0.4102 - val_loss: 3.3149 - val_accuracy100: 0.3443 - 96s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 96s - loss: 3.2164 - accuracy100: 0.4154 - val_loss: 3.3092 - val_accuracy100: 0.3480 - 96s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 100s - loss: 3.2108 - accuracy100: 0.4179 - val_loss: 3.3127 - val_accuracy100: 0.3475 - 100s/epoch - 29ms/step
Epoch 6/50
3419/3419 - 98s - loss: 3.2061 - accuracy100: 0.4206 - val_loss: 3.3199 - val_accuracy100: 0.3471 - 98s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 96s - loss: 3.2026 - accuracy100: 0.4214 - val_loss: 3.3307 - val_accuracy100: 0.3461 - 96s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 94s - loss: 3.1998 - accuracy100: 0.4233 - val_loss: 3.3236 - val_accuracy100: 0.3474 - 94s/epoch - 27ms/step
Epoch 9/50
3419/3419 - 95s - loss: 3.1970 - accuracy100: 0.4246 - val_loss: 3.3220 - val_accuracy100: 0.3488 - 95s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.1945 - accuracy100: 0.4264 - val_loss: 3.3245 - val_accuracy100: 0.3497 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 96s - loss: 3.1924 - accuracy100: 0.4270 - val_loss: 3.3325 - val_accuracy100: 0.3486 - 96s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h100
Evaluating performance on  test set...
10303/10303 - 133s - 133s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0858386
{'0': {'precision': 0.3786481443735399, 'recall': 0.1501175464311511, 'f1-score': 0.21499780103947624, 'support': 804363}, '1': {'precision': 0.3854886623343426, 'recall': 0.8499876059397058, 'f1-score': 0.5304198771413182, 'support': 1016616}, '2': {'precision': 0.3744571294827452, 'recall': 0.035273467977918256, 'f1-score': 0.06447359141725259, 'support': 816421}, 'accuracy': 0.38433988018503074, 'macro avg': {'precision': 0.37953131206354257, 'recall': 0.34512620678292505, 'f1-score': 0.26996375653268234, 'support': 2637400}, 'weighted avg': {'precision': 0.3799875496359506, 'recall': 0.38433988018503074, 'f1-score': 0.2899852900719949, 'support': 2637400}}
[[120749 665914  17700]
 [122097 864111  30408]
 [ 76049 711574  28798]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0997664
{'0': {'precision': 0.4055286530151354, 'recall': 0.13042248504593595, 'f1-score': 0.1973689425304971, 'support': 286377}, '1': {'precision': 0.33140372621406844, 'recall': 0.8623959544251923, 'f1-score': 0.47880936375423505, 'support': 289897}, '2': {'precision': 0.4116723644735924, 'recall': 0.03948420598302323, 'f1-score': 0.07205727457295943, 'support': 298879}, 'accuracy': 0.3418339421792532, 'macro avg': {'precision': 0.38286824790093205, 'recall': 0.3441008818180505, 'f1-score': 0.2494118602858972, 'support': 875153}, 'weighted avg': {'precision': 0.3830727309445298, 'recall': 0.3418339421792532, 'f1-score': 0.24780093303274875, 'support': 875153}}
[[ 37350 241920   7107]
 [ 30133 250006   9758]
 [ 24619 262459  11801]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0977108
{'0': {'precision': 0.4092318572516592, 'recall': 0.12645513763395672, 'f1-score': 0.1932078670082638, 'support': 118975}, '1': {'precision': 0.3368121164422098, 'recall': 0.8607952656426624, 'f1-score': 0.48417583188209307, 'support': 120312}, '2': {'precision': 0.39588294031799676, 'recall': 0.043685740682663864, 'f1-score': 0.07868822424769843, 'support': 117979}, 'accuracy': 0.34641695543376644, 'macro avg': {'precision': 0.380642304670622, 'recall': 0.343645381319761, 'f1-score': 0.25202397437935176, 'support': 357266}, 'weighted avg': {'precision': 0.38043579009950074, 'recall': 0.34641695543376644, 'f1-score': 0.25337599063786026, 'support': 357266}}
[[ 15045 100554   3376]
 [ 12259 103564   4489]
 [  9460 103365   5154]]
training model: results/AAPL/W9/deepOF_L2/h200
Epoch 1/50
3419/3419 - 97s - loss: 3.2583 - accuracy200: 0.3888 - val_loss: 3.3037 - val_accuracy200: 0.3417 - 97s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 95s - loss: 3.2440 - accuracy200: 0.3959 - val_loss: 3.3050 - val_accuracy200: 0.3445 - 95s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 95s - loss: 3.2351 - accuracy200: 0.4015 - val_loss: 3.3118 - val_accuracy200: 0.3418 - 95s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 95s - loss: 3.2281 - accuracy200: 0.4052 - val_loss: 3.3130 - val_accuracy200: 0.3415 - 95s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 94s - loss: 3.2240 - accuracy200: 0.4080 - val_loss: 3.3235 - val_accuracy200: 0.3410 - 94s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 95s - loss: 3.2207 - accuracy200: 0.4102 - val_loss: 3.3305 - val_accuracy200: 0.3408 - 95s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 3.2184 - accuracy200: 0.4111 - val_loss: 3.3285 - val_accuracy200: 0.3418 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 95s - loss: 3.2164 - accuracy200: 0.4123 - val_loss: 3.3345 - val_accuracy200: 0.3414 - 95s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 94s - loss: 3.2149 - accuracy200: 0.4130 - val_loss: 3.3318 - val_accuracy200: 0.3417 - 94s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.2134 - accuracy200: 0.4141 - val_loss: 3.3357 - val_accuracy200: 0.3421 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 95s - loss: 3.2119 - accuracy200: 0.4147 - val_loss: 3.3313 - val_accuracy200: 0.3418 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h200
Evaluating performance on  test set...
10303/10303 - 123s - 123s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0931861
{'0': {'precision': 0.3453510720465581, 'recall': 0.1420938078539042, 'f1-score': 0.20134481208847307, 'support': 811851}, '1': {'precision': 0.3798634720750526, 'recall': 0.8340752747845043, 'f1-score': 0.5219945910306307, 'support': 1001876}, '2': {'precision': 0.33361668421510193, 'recall': 0.04193047483649458, 'f1-score': 0.07449773294966759, 'support': 823673}, 'accuracy': 0.3736771062409949, 'macro avg': {'precision': 0.3529437427789042, 'recall': 0.339366519158301, 'f1-score': 0.2659457120229238, 'support': 2637400}, 'weighted avg': {'precision': 0.3547966801691974, 'recall': 0.3736771062409949, 'f1-score': 0.2835359107886914, 'support': 2637400}}
[[115359 667957  28535]
 [125785 835640  40451]
 [ 92890 696246  34537]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1039383
{'0': {'precision': 0.36925321011051726, 'recall': 0.12051387190036696, 'f1-score': 0.18171957935331073, 'support': 287776}, '1': {'precision': 0.3300764329665503, 'recall': 0.8490848533789895, 'f1-score': 0.47535973735680365, 'support': 288533}, '2': {'precision': 0.3760125089715985, 'recall': 0.04908581065706522, 'f1-score': 0.08683581170676265, 'support': 298844}, 'accuracy': 0.3363286191100299, 'macro avg': {'precision': 0.35844738401622206, 'recall': 0.3395615119788073, 'f1-score': 0.24797170947229233, 'support': 875153}, 'weighted avg': {'precision': 0.3586449883129124, 'recall': 0.3363286191100299, 'f1-score': 0.24613052355467532, 'support': 875153}}
[[ 34681 241873  11222]
 [ 30423 244989  13121]
 [ 28818 255357  14669]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1022084
{'0': {'precision': 0.36896183247938186, 'recall': 0.11311688857154857, 'f1-score': 0.1731493744454874, 'support': 119045}, '1': {'precision': 0.3381735126612613, 'recall': 0.8461175847895664, 'f1-score': 0.4832165949548239, 'support': 120917}, '2': {'precision': 0.34960508995173323, 'recall': 0.05433744799836323, 'f1-score': 0.09405619171290286, 'support': 117304}, 'accuracy': 0.3419021121517301, 'macro avg': {'precision': 0.3522468116974588, 'recall': 0.3378573071198261, 'f1-score': 0.2501407203710713, 'support': 357266}, 'weighted avg': {'precision': 0.35218594394559755, 'recall': 0.3419021121517301, 'f1-score': 0.2521226083806067, 'support': 357266}}
[[ 13466  99975   5604]
 [ 12353 102310   6254]
 [ 10678 100252   6374]]
training model: results/AAPL/W9/deepOF_L2/h300
Epoch 1/50
3419/3419 - 101s - loss: 3.2599 - accuracy300: 0.3878 - val_loss: 3.3136 - val_accuracy300: 0.3451 - 101s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 96s - loss: 3.2499 - accuracy300: 0.3914 - val_loss: 3.3043 - val_accuracy300: 0.3444 - 96s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 95s - loss: 3.2449 - accuracy300: 0.3954 - val_loss: 3.3111 - val_accuracy300: 0.3442 - 95s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 95s - loss: 3.2375 - accuracy300: 0.3995 - val_loss: 3.3217 - val_accuracy300: 0.3439 - 95s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 95s - loss: 3.2316 - accuracy300: 0.4035 - val_loss: 3.3360 - val_accuracy300: 0.3436 - 95s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 95s - loss: 3.2280 - accuracy300: 0.4055 - val_loss: 3.3404 - val_accuracy300: 0.3437 - 95s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 94s - loss: 3.2257 - accuracy300: 0.4067 - val_loss: 3.3432 - val_accuracy300: 0.3436 - 94s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 96s - loss: 3.2237 - accuracy300: 0.4078 - val_loss: 3.3435 - val_accuracy300: 0.3437 - 96s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 95s - loss: 3.2221 - accuracy300: 0.4089 - val_loss: 3.3432 - val_accuracy300: 0.3438 - 95s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.2206 - accuracy300: 0.4097 - val_loss: 3.3445 - val_accuracy300: 0.3438 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 94s - loss: 3.2191 - accuracy300: 0.4106 - val_loss: 3.3439 - val_accuracy300: 0.3441 - 94s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 95s - loss: 3.2179 - accuracy300: 0.4117 - val_loss: 3.3453 - val_accuracy300: 0.3441 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h300
Evaluating performance on  test set...
10303/10303 - 131s - 131s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.095178
{'0': {'precision': 0.3387741991999299, 'recall': 0.028738166127506105, 'f1-score': 0.052981886515009326, 'support': 807428}, '1': {'precision': 0.3830960366937449, 'recall': 0.96446795381457, 'f1-score': 0.5483729948662616, 'support': 1011228}, '2': {'precision': 0.3359188802703991, 'recall': 0.009468160988049989, 'f1-score': 0.018417216961800667, 'support': 818744}, 'accuracy': 0.3815321907939638, 'macro avg': {'precision': 0.35259637205469135, 'recall': 0.33422476031004206, 'f1-score': 0.2065906994476905, 'support': 2637400}, 'weighted avg': {'precision': 0.3548816185688371, 'recall': 0.3815321907939638, 'f1-score': 0.23219389224305506, 'support': 2637400}}
[[ 23204 778325   5899]
 [ 26505 975297   9426]
 [ 18785 792207   7752]]
Evaluating performance on  train set...
3419/3419 - 43s - 43s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1062716
{'0': {'precision': 0.3773717498243148, 'recall': 0.02983354051069799, 'f1-score': 0.05529562436045127, 'support': 287998}, '1': {'precision': 0.3306150868020136, 'recall': 0.9638334658874789, 'f1-score': 0.49234538417922424, 'support': 289190}, '2': {'precision': 0.3763013845658474, 'recall': 0.011766482640578592, 'f1-score': 0.02281942970951764, 'support': 297965}, 'accuracy': 0.33231789184291205, 'macro avg': {'precision': 0.3614294070640586, 'recall': 0.3351444963462518, 'f1-score': 0.1901534794163977, 'support': 875153}, 'weighted avg': {'precision': 0.3615568114493581, 'recall': 0.33231789184291205, 'f1-score': 0.18865933413785646, 'support': 875153}}
[[  8592 276801   2605]
 [  7253 278731   3206]
 [  6923 287536   3506]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026199
{'0': {'precision': 0.37632636241887296, 'recall': 0.030789329512410975, 'f1-score': 0.05692159062577911, 'support': 118645}, '1': {'precision': 0.3431920686109553, 'recall': 0.9580764588837786, 'f1-score': 0.5053595547182146, 'support': 122628}, '2': {'precision': 0.3333333333333333, 'recall': 0.01500952643694016, 'f1-score': 0.028725580781414996, 'support': 115993}, 'accuracy': 0.3439482066583442, 'macro avg': {'precision': 0.3509505881210539, 'recall': 0.33462510494437653, 'f1-score': 0.19700224204180286, 'support': 357266}, 'weighted avg': {'precision': 0.3509948654284055, 'recall': 0.3439482066583442, 'f1-score': 0.20168910528110554, 'support': 357266}}
[[  3653 113348   1644]
 [  3303 117487   1838]
 [  2751 111501   1741]]
training model: results/AAPL/W9/deepOF_L2/h500
Epoch 1/50
3419/3419 - 100s - loss: 3.2629 - accuracy500: 0.3842 - val_loss: 3.3060 - val_accuracy500: 0.3451 - 100s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 98s - loss: 3.2555 - accuracy500: 0.3854 - val_loss: 3.3104 - val_accuracy500: 0.3447 - 98s/epoch - 29ms/step
Epoch 3/50
3419/3419 - 96s - loss: 3.2496 - accuracy500: 0.3891 - val_loss: 3.3200 - val_accuracy500: 0.3437 - 96s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 96s - loss: 3.2427 - accuracy500: 0.3946 - val_loss: 3.3356 - val_accuracy500: 0.3437 - 96s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 94s - loss: 3.2373 - accuracy500: 0.3973 - val_loss: 3.3421 - val_accuracy500: 0.3434 - 94s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 94s - loss: 3.2346 - accuracy500: 0.3989 - val_loss: 3.3455 - val_accuracy500: 0.3438 - 94s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 3.2324 - accuracy500: 0.4003 - val_loss: 3.3469 - val_accuracy500: 0.3438 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 95s - loss: 3.2308 - accuracy500: 0.4014 - val_loss: 3.3505 - val_accuracy500: 0.3438 - 95s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 96s - loss: 3.2296 - accuracy500: 0.4020 - val_loss: 3.3490 - val_accuracy500: 0.3438 - 96s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 96s - loss: 3.2283 - accuracy500: 0.4030 - val_loss: 3.3549 - val_accuracy500: 0.3440 - 96s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 95s - loss: 3.2277 - accuracy500: 0.4032 - val_loss: 3.3508 - val_accuracy500: 0.3440 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h500
Evaluating performance on  test set...
10303/10303 - 124s - 124s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936391
{'0': {'precision': 0.31216897385892556, 'recall': 0.03685112988913085, 'f1-score': 0.0659204399946891, 'support': 794901}, '1': {'precision': 0.3918936889775097, 'recall': 0.951313641516929, 'f1-score': 0.5551098536835168, 'support': 1034643}, '2': {'precision': 0.30526118353183906, 'recall': 0.012087550256481353, 'f1-score': 0.023254290970357624, 'support': 807856}, 'accuracy': 0.3880063699097596, 'macro avg': {'precision': 0.3364412821227581, 'recall': 0.3334174405541804, 'f1-score': 0.21476152821618785, 'support': 2637400}, 'weighted avg': {'precision': 0.3413287973828349, 'recall': 0.3880063699097596, 'f1-score': 0.24475880279936396, 'support': 2637400}}
[[ 29293 756771   8837]
 [ 36986 984270  13387]
 [ 27558 770533   9765]]
Evaluating performance on  train set...
3419/3419 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065936
{'0': {'precision': 0.3427171738080453, 'recall': 0.03431848409997754, 'f1-score': 0.06238950419373781, 'support': 289465}, '1': {'precision': 0.32974638210612806, 'recall': 0.9540936564267495, 'f1-score': 0.4901061221873882, 'support': 288544}, '2': {'precision': 0.3584905660377358, 'recall': 0.013619659155157095, 'f1-score': 0.026242328155547556, 'support': 297144}, 'accuracy': 0.33054677296427026, 'macro avg': {'precision': 0.3436513739839697, 'recall': 0.33401059989396137, 'f1-score': 0.1929126515122245, 'support': 875153}, 'weighted avg': {'precision': 0.3437962134043915, 'recall': 0.33054677296427026, 'f1-score': 0.19113744580585346, 'support': 875153}}
[[  9934 276083   3448]
 [  9452 275298   3794]
 [  9600 283497   4047]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1029184
{'0': {'precision': 0.36284185941384767, 'recall': 0.04071694284748056, 'f1-score': 0.07321763851831581, 'support': 118280}, '1': {'precision': 0.34442483849765815, 'recall': 0.9477624707732164, 'f1-score': 0.5052408943938608, 'support': 122747}, '2': {'precision': 0.3314597719608158, 'recall': 0.017756518896411704, 'f1-score': 0.03370731468325903, 'support': 116239}, 'accuracy': 0.34488308431252906, 'macro avg': {'precision': 0.3462421566241072, 'recall': 0.3354119775057029, 'f1-score': 0.20405528253181185, 'support': 357266}, 'weighted avg': {'precision': 0.34630388342438184, 'recall': 0.34488308431252906, 'f1-score': 0.2087942622571892, 'support': 357266}}
[[  4816 111419   2045]
 [  4294 116335   2118]
 [  4163 110012   2064]]
training model: results/AAPL/W9/deepOF_L2/h1000
Epoch 1/50
3419/3419 - 100s - loss: 3.2715 - accuracy1000: 0.3791 - val_loss: 3.3024 - val_accuracy1000: 0.3417 - 100s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 98s - loss: 3.2632 - accuracy1000: 0.3781 - val_loss: 3.2989 - val_accuracy1000: 0.3361 - 98s/epoch - 29ms/step
Epoch 3/50
3419/3419 - 98s - loss: 3.2641 - accuracy1000: 0.3778 - val_loss: 3.2999 - val_accuracy1000: 0.3307 - 98s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 98s - loss: 3.2612 - accuracy1000: 0.3810 - val_loss: 3.3041 - val_accuracy1000: 0.3354 - 98s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 96s - loss: 3.2554 - accuracy1000: 0.3854 - val_loss: 3.3087 - val_accuracy1000: 0.3399 - 96s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 95s - loss: 3.2502 - accuracy1000: 0.3895 - val_loss: 3.3144 - val_accuracy1000: 0.3448 - 95s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 95s - loss: 3.2464 - accuracy1000: 0.3924 - val_loss: 3.3195 - val_accuracy1000: 0.3445 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 95s - loss: 3.2445 - accuracy1000: 0.3934 - val_loss: 3.3238 - val_accuracy1000: 0.3439 - 95s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 95s - loss: 3.2419 - accuracy1000: 0.3954 - val_loss: 3.3264 - val_accuracy1000: 0.3475 - 95s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.2409 - accuracy1000: 0.3965 - val_loss: 3.3308 - val_accuracy1000: 0.3452 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 96s - loss: 3.2393 - accuracy1000: 0.3971 - val_loss: 3.3326 - val_accuracy1000: 0.3468 - 96s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 95s - loss: 3.2387 - accuracy1000: 0.3979 - val_loss: 3.3334 - val_accuracy1000: 0.3451 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepOF_L2/h1000
Evaluating performance on  test set...
10303/10303 - 123s - 123s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985347
{'0': {'precision': 0.29636438804425064, 'recall': 0.7010030503937498, 'f1-score': 0.4166014089500701, 'support': 771048}, '1': {'precision': 0.4182212284189062, 'recall': 0.2731408909855789, 'f1-score': 0.33045871549288786, 'support': 1073014}, '2': {'precision': 0.3013977894186366, 'recall': 0.04286193274493343, 'f1-score': 0.07505084648499877, 'support': 793338}, 'accuracy': 0.32895844392204443, 'macro avg': {'precision': 0.3386611352939311, 'recall': 0.3390019580414207, 'f1-score': 0.27403699030931894, 'support': 2637400}, 'weighted avg': {'precision': 0.3474553428851255, 'recall': 0.32895844392204443, 'f1-score': 0.2788151966947506, 'support': 2637400}}
[[540507 198801  31740]
 [732853 293084  47077]
 [550432 208902  34004]]
Evaluating performance on  train set...
3419/3419 - 45s - 45s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003351
{'0': {'precision': 0.3337197862804787, 'recall': 0.6994667925628671, 'f1-score': 0.4518562538543477, 'support': 288068}, '1': {'precision': 0.34327294404271314, 'recall': 0.27483062365769895, 'f1-score': 0.30526249070867595, 'support': 289149}, '2': {'precision': 0.3534221152158102, 'recall': 0.0472987487245583, 'f1-score': 0.08343176173518173, 'support': 297936}, 'accuracy': 0.33714447645154616, 'macro avg': {'precision': 0.34347161517966734, 'recall': 0.34053205498170813, 'f1-score': 0.2801835020994018, 'support': 875153}, 'weighted avg': {'precision': 0.34358356905614107, 'recall': 0.33714447645154616, 'f1-score': 0.2779959579931398, 'support': 875153}}
[[201494  74218  12356]
 [196257  79467  13425]
 [206031  77813  14092]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1001395
{'0': {'precision': 0.3293132243959346, 'recall': 0.6723901569675783, 'f1-score': 0.4421008748950746, 'support': 116712}, '1': {'precision': 0.35261132490379327, 'recall': 0.2901999819020903, 'f1-score': 0.3183758562493795, 'support': 121561}, '2': {'precision': 0.3314128653734341, 'recall': 0.05269217516996798, 'f1-score': 0.09092754800162421, 'support': 118993}, 'accuracy': 0.33594856493481046, 'macro avg': {'precision': 0.3377791382243873, 'recall': 0.3384274380132122, 'f1-score': 0.28380142638202605, 'support': 357266}, 'weighted avg': {'precision': 0.3379398022809598, 'recall': 0.33594856493481046, 'f1-score': 0.28303926623759895, 'support': 357266}}
[[78476 32087  6149]
 [79784 35277  6500]
 [80042 32681  6270]]
training model: results/AAPL/W9/deepVOL_L2/h10
Epoch 1/50
3419/3419 - 112s - loss: 3.1625 - accuracy10: 0.4354 - val_loss: 3.2161 - val_accuracy10: 0.3996 - 112s/epoch - 33ms/step
Epoch 2/50
3419/3419 - 106s - loss: 3.0956 - accuracy10: 0.4606 - val_loss: 3.1652 - val_accuracy10: 0.4404 - 106s/epoch - 31ms/step
Epoch 3/50
3419/3419 - 105s - loss: 3.0623 - accuracy10: 0.4725 - val_loss: 3.0969 - val_accuracy10: 0.4690 - 105s/epoch - 31ms/step
Epoch 4/50
3419/3419 - 100s - loss: 3.0420 - accuracy10: 0.4790 - val_loss: 3.0789 - val_accuracy10: 0.4753 - 100s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 97s - loss: 3.0287 - accuracy10: 0.4836 - val_loss: 3.0772 - val_accuracy10: 0.4756 - 97s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 100s - loss: 3.0185 - accuracy10: 0.4871 - val_loss: 3.0689 - val_accuracy10: 0.4776 - 100s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 99s - loss: 3.0107 - accuracy10: 0.4897 - val_loss: 3.0625 - val_accuracy10: 0.4795 - 99s/epoch - 29ms/step
Epoch 8/50
3419/3419 - 100s - loss: 3.0036 - accuracy10: 0.4914 - val_loss: 3.0568 - val_accuracy10: 0.4802 - 100s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 96s - loss: 2.9977 - accuracy10: 0.4934 - val_loss: 3.0511 - val_accuracy10: 0.4817 - 96s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 96s - loss: 2.9919 - accuracy10: 0.4947 - val_loss: 3.0547 - val_accuracy10: 0.4796 - 96s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 97s - loss: 2.9866 - accuracy10: 0.4961 - val_loss: 3.0406 - val_accuracy10: 0.4831 - 97s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 99s - loss: 2.9817 - accuracy10: 0.4972 - val_loss: 3.0361 - val_accuracy10: 0.4839 - 99s/epoch - 29ms/step
Epoch 13/50
3419/3419 - 97s - loss: 2.9776 - accuracy10: 0.4983 - val_loss: 3.0349 - val_accuracy10: 0.4848 - 97s/epoch - 29ms/step
Epoch 14/50
3419/3419 - 95s - loss: 2.9734 - accuracy10: 0.4996 - val_loss: 3.0311 - val_accuracy10: 0.4869 - 95s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 100s - loss: 2.9700 - accuracy10: 0.5001 - val_loss: 3.0280 - val_accuracy10: 0.4867 - 100s/epoch - 29ms/step
Epoch 16/50
3419/3419 - 98s - loss: 2.9673 - accuracy10: 0.5012 - val_loss: 3.0255 - val_accuracy10: 0.4881 - 98s/epoch - 29ms/step
Epoch 17/50
3419/3419 - 98s - loss: 2.9640 - accuracy10: 0.5013 - val_loss: 3.0235 - val_accuracy10: 0.4872 - 98s/epoch - 29ms/step
Epoch 18/50
3419/3419 - 95s - loss: 2.9607 - accuracy10: 0.5026 - val_loss: 3.0211 - val_accuracy10: 0.4891 - 95s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 96s - loss: 2.9582 - accuracy10: 0.5035 - val_loss: 3.0201 - val_accuracy10: 0.4894 - 96s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 98s - loss: 2.9552 - accuracy10: 0.5042 - val_loss: 3.0177 - val_accuracy10: 0.4896 - 98s/epoch - 29ms/step
Epoch 21/50
3419/3419 - 96s - loss: 2.9526 - accuracy10: 0.5051 - val_loss: 3.0176 - val_accuracy10: 0.4895 - 96s/epoch - 28ms/step
Epoch 22/50
3419/3419 - 97s - loss: 2.9499 - accuracy10: 0.5058 - val_loss: 3.0169 - val_accuracy10: 0.4894 - 97s/epoch - 28ms/step
Epoch 23/50
3419/3419 - 96s - loss: 2.9475 - accuracy10: 0.5063 - val_loss: 3.0155 - val_accuracy10: 0.4905 - 96s/epoch - 28ms/step
Epoch 24/50
3419/3419 - 96s - loss: 2.9462 - accuracy10: 0.5066 - val_loss: 3.0139 - val_accuracy10: 0.4904 - 96s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 96s - loss: 2.9435 - accuracy10: 0.5074 - val_loss: 3.0135 - val_accuracy10: 0.4903 - 96s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 97s - loss: 2.9413 - accuracy10: 0.5080 - val_loss: 3.0114 - val_accuracy10: 0.4907 - 97s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 98s - loss: 2.9394 - accuracy10: 0.5089 - val_loss: 3.0078 - val_accuracy10: 0.4925 - 98s/epoch - 29ms/step
Epoch 28/50
3419/3419 - 97s - loss: 2.9376 - accuracy10: 0.5090 - val_loss: 3.0112 - val_accuracy10: 0.4910 - 97s/epoch - 28ms/step
Epoch 29/50
3419/3419 - 95s - loss: 2.9358 - accuracy10: 0.5093 - val_loss: 3.0088 - val_accuracy10: 0.4916 - 95s/epoch - 28ms/step
Epoch 30/50
3419/3419 - 98s - loss: 2.9341 - accuracy10: 0.5100 - val_loss: 3.0071 - val_accuracy10: 0.4925 - 98s/epoch - 29ms/step
Epoch 31/50
3419/3419 - 97s - loss: 2.9317 - accuracy10: 0.5104 - val_loss: 3.0107 - val_accuracy10: 0.4911 - 97s/epoch - 28ms/step
Epoch 32/50
3419/3419 - 97s - loss: 2.9297 - accuracy10: 0.5115 - val_loss: 3.0091 - val_accuracy10: 0.4923 - 97s/epoch - 28ms/step
Epoch 33/50
3419/3419 - 96s - loss: 2.9283 - accuracy10: 0.5118 - val_loss: 3.0061 - val_accuracy10: 0.4925 - 96s/epoch - 28ms/step
Epoch 34/50
3419/3419 - 96s - loss: 2.9268 - accuracy10: 0.5127 - val_loss: 3.0064 - val_accuracy10: 0.4921 - 96s/epoch - 28ms/step
Epoch 35/50
3419/3419 - 97s - loss: 2.9251 - accuracy10: 0.5129 - val_loss: 3.0075 - val_accuracy10: 0.4917 - 97s/epoch - 28ms/step
Epoch 36/50
3419/3419 - 95s - loss: 2.9237 - accuracy10: 0.5128 - val_loss: 3.0063 - val_accuracy10: 0.4921 - 95s/epoch - 28ms/step
Epoch 37/50
3419/3419 - 98s - loss: 2.9217 - accuracy10: 0.5138 - val_loss: 3.0072 - val_accuracy10: 0.4919 - 98s/epoch - 29ms/step
Epoch 38/50
3419/3419 - 97s - loss: 2.9202 - accuracy10: 0.5138 - val_loss: 3.0060 - val_accuracy10: 0.4932 - 97s/epoch - 28ms/step
Epoch 39/50
3419/3419 - 97s - loss: 2.9186 - accuracy10: 0.5145 - val_loss: 3.0052 - val_accuracy10: 0.4925 - 97s/epoch - 28ms/step
Epoch 40/50
3419/3419 - 96s - loss: 2.9178 - accuracy10: 0.5146 - val_loss: 3.0071 - val_accuracy10: 0.4923 - 96s/epoch - 28ms/step
Epoch 41/50
3419/3419 - 97s - loss: 2.9159 - accuracy10: 0.5154 - val_loss: 3.0058 - val_accuracy10: 0.4928 - 97s/epoch - 28ms/step
Epoch 42/50
3419/3419 - 99s - loss: 2.9145 - accuracy10: 0.5160 - val_loss: 3.0050 - val_accuracy10: 0.4927 - 99s/epoch - 29ms/step
Epoch 43/50
3419/3419 - 95s - loss: 2.9130 - accuracy10: 0.5165 - val_loss: 3.0065 - val_accuracy10: 0.4923 - 95s/epoch - 28ms/step
Epoch 44/50
3419/3419 - 94s - loss: 2.9115 - accuracy10: 0.5167 - val_loss: 3.0041 - val_accuracy10: 0.4936 - 94s/epoch - 28ms/step
Epoch 45/50
3419/3419 - 96s - loss: 2.9096 - accuracy10: 0.5172 - val_loss: 3.0057 - val_accuracy10: 0.4932 - 96s/epoch - 28ms/step
Epoch 46/50
3419/3419 - 95s - loss: 2.9092 - accuracy10: 0.5167 - val_loss: 3.0071 - val_accuracy10: 0.4914 - 95s/epoch - 28ms/step
Epoch 47/50
3419/3419 - 97s - loss: 2.9076 - accuracy10: 0.5179 - val_loss: 3.0066 - val_accuracy10: 0.4920 - 97s/epoch - 28ms/step
Epoch 48/50
3419/3419 - 98s - loss: 2.9064 - accuracy10: 0.5182 - val_loss: 3.0065 - val_accuracy10: 0.4927 - 98s/epoch - 29ms/step
Epoch 49/50
3419/3419 - 94s - loss: 2.9050 - accuracy10: 0.5185 - val_loss: 3.0092 - val_accuracy10: 0.4919 - 94s/epoch - 28ms/step
Epoch 50/50
3419/3419 - 97s - loss: 2.9038 - accuracy10: 0.5188 - val_loss: 3.0080 - val_accuracy10: 0.4915 - 97s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h10
Evaluating performance on  test set...
10303/10303 - 135s - 135s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.005346
{'0': {'precision': 0.4653837412786073, 'recall': 0.4981008663163131, 'f1-score': 0.48118681476198677, 'support': 822217}, '1': {'precision': 0.4968139630163645, 'recall': 0.5110611086233692, 'f1-score': 0.5038368382415366, 'support': 987062}, '2': {'precision': 0.48892476712092464, 'recall': 0.43808603773584903, 'f1-score': 0.46211136452076595, 'support': 828125}, 'accuracy': 0.48410709925366, 'macro avg': {'precision': 0.48370749047196554, 'recall': 0.4824160042251771, 'f1-score': 0.48237833917476314, 'support': 2637404}, 'weighted avg': {'precision': 0.4845383681596551, 'recall': 0.48410709925366, 'f1-score': 0.483674154678344, 'support': 2637404}}
[[409547 249755 162915]
 [266302 504449 216311]
 [204171 261164 362790]]
Evaluating performance on  train set...
3419/3419 - 42s - 42s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9918944
{'0': {'precision': 0.4863942724501496, 'recall': 0.5384909126562291, 'f1-score': 0.5111185125683274, 'support': 290679}, '1': {'precision': 0.5114473901819934, 'recall': 0.49305415953250753, 'f1-score': 0.5020823774397346, 'support': 288518}, '2': {'precision': 0.5100527254822874, 'recall': 0.47427835800471013, 'f1-score': 0.4915154528710195, 'support': 295957}, 'accuracy': 0.5017962552876408, 'macro avg': {'precision': 0.5026314627048101, 'recall': 0.5019411433978156, 'f1-score': 0.5015721142930272, 'support': 875154}, 'weighted avg': {'precision': 0.5026544508939303, 'recall': 0.5017962552876408, 'f1-score': 0.5015102032034985, 'support': 875154}}
[[156528  65563  68588]
 [ 80018 142255  66245]
 [ 85267  70324 140366]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.001551
{'0': {'precision': 0.47254547508756073, 'recall': 0.5037682605778, 'f1-score': 0.48765761113979716, 'support': 116234}, '1': {'precision': 0.5172419260222282, 'recall': 0.5149599463320311, 'f1-score': 0.5160984136902762, 'support': 126705}, '2': {'precision': 0.4867638005335522, 'recall': 0.4564451092042999, 'f1-score': 0.4711171699024524, 'support': 114327}, 'accuracy': 0.4925937536737333, 'macro avg': {'precision': 0.4921837338811137, 'recall': 0.4917244387047104, 'f1-score': 0.49162439824417525, 'support': 357266}, 'weighted avg': {'precision': 0.49294708707678137, 'recall': 0.4925937536737333, 'f1-score': 0.4924511623364308, 'support': 357266}}
[[58555 30513 27166]
 [33601 65248 27856]
 [31758 30385 52184]]
training model: results/AAPL/W9/deepVOL_L2/h20
Epoch 1/50
3419/3419 - 99s - loss: 3.2044 - accuracy20: 0.4181 - val_loss: 3.2545 - val_accuracy20: 0.3816 - 99s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 95s - loss: 3.1716 - accuracy20: 0.4322 - val_loss: 3.2273 - val_accuracy20: 0.4019 - 95s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 97s - loss: 3.1516 - accuracy20: 0.4414 - val_loss: 3.2096 - val_accuracy20: 0.4160 - 97s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 101s - loss: 3.1357 - accuracy20: 0.4470 - val_loss: 3.1829 - val_accuracy20: 0.4309 - 101s/epoch - 30ms/step
Epoch 5/50
3419/3419 - 105s - loss: 3.1234 - accuracy20: 0.4524 - val_loss: 3.1723 - val_accuracy20: 0.4378 - 105s/epoch - 31ms/step
Epoch 6/50
3419/3419 - 101s - loss: 3.1143 - accuracy20: 0.4558 - val_loss: 3.1632 - val_accuracy20: 0.4421 - 101s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 103s - loss: 3.1080 - accuracy20: 0.4580 - val_loss: 3.1589 - val_accuracy20: 0.4444 - 103s/epoch - 30ms/step
Epoch 8/50
3419/3419 - 98s - loss: 3.1023 - accuracy20: 0.4597 - val_loss: 3.1556 - val_accuracy20: 0.4457 - 98s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 96s - loss: 3.0979 - accuracy20: 0.4614 - val_loss: 3.1536 - val_accuracy20: 0.4467 - 96s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 96s - loss: 3.0942 - accuracy20: 0.4619 - val_loss: 3.1517 - val_accuracy20: 0.4469 - 96s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 96s - loss: 3.0905 - accuracy20: 0.4638 - val_loss: 3.1492 - val_accuracy20: 0.4486 - 96s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 96s - loss: 3.0880 - accuracy20: 0.4647 - val_loss: 3.1461 - val_accuracy20: 0.4488 - 96s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 97s - loss: 3.0853 - accuracy20: 0.4652 - val_loss: 3.1444 - val_accuracy20: 0.4494 - 97s/epoch - 28ms/step
Epoch 14/50
3419/3419 - 97s - loss: 3.0825 - accuracy20: 0.4660 - val_loss: 3.1430 - val_accuracy20: 0.4498 - 97s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 98s - loss: 3.0801 - accuracy20: 0.4673 - val_loss: 3.1413 - val_accuracy20: 0.4506 - 98s/epoch - 29ms/step
Epoch 16/50
3419/3419 - 96s - loss: 3.0776 - accuracy20: 0.4677 - val_loss: 3.1428 - val_accuracy20: 0.4493 - 96s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 96s - loss: 3.0751 - accuracy20: 0.4689 - val_loss: 3.1398 - val_accuracy20: 0.4501 - 96s/epoch - 28ms/step
Epoch 18/50
3419/3419 - 97s - loss: 3.0735 - accuracy20: 0.4690 - val_loss: 3.1385 - val_accuracy20: 0.4507 - 97s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 96s - loss: 3.0709 - accuracy20: 0.4702 - val_loss: 3.1382 - val_accuracy20: 0.4510 - 96s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 98s - loss: 3.0690 - accuracy20: 0.4710 - val_loss: 3.1413 - val_accuracy20: 0.4493 - 98s/epoch - 29ms/step
Epoch 21/50
3419/3419 - 97s - loss: 3.0669 - accuracy20: 0.4712 - val_loss: 3.1366 - val_accuracy20: 0.4505 - 97s/epoch - 28ms/step
Epoch 22/50
3419/3419 - 96s - loss: 3.0652 - accuracy20: 0.4722 - val_loss: 3.1385 - val_accuracy20: 0.4501 - 96s/epoch - 28ms/step
Epoch 23/50
3419/3419 - 97s - loss: 3.0630 - accuracy20: 0.4726 - val_loss: 3.1361 - val_accuracy20: 0.4503 - 97s/epoch - 28ms/step
Epoch 24/50
3419/3419 - 95s - loss: 3.0614 - accuracy20: 0.4732 - val_loss: 3.1346 - val_accuracy20: 0.4518 - 95s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 97s - loss: 3.0594 - accuracy20: 0.4743 - val_loss: 3.1338 - val_accuracy20: 0.4517 - 97s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 97s - loss: 3.0577 - accuracy20: 0.4743 - val_loss: 3.1336 - val_accuracy20: 0.4515 - 97s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 96s - loss: 3.0561 - accuracy20: 0.4751 - val_loss: 3.1350 - val_accuracy20: 0.4507 - 96s/epoch - 28ms/step
Epoch 28/50
3419/3419 - 97s - loss: 3.0545 - accuracy20: 0.4756 - val_loss: 3.1347 - val_accuracy20: 0.4507 - 97s/epoch - 28ms/step
Epoch 29/50
3419/3419 - 96s - loss: 3.0530 - accuracy20: 0.4763 - val_loss: 3.1362 - val_accuracy20: 0.4504 - 96s/epoch - 28ms/step
Epoch 30/50
3419/3419 - 98s - loss: 3.0515 - accuracy20: 0.4771 - val_loss: 3.1332 - val_accuracy20: 0.4509 - 98s/epoch - 29ms/step
Epoch 31/50
3419/3419 - 96s - loss: 3.0497 - accuracy20: 0.4774 - val_loss: 3.1327 - val_accuracy20: 0.4522 - 96s/epoch - 28ms/step
Epoch 32/50
3419/3419 - 96s - loss: 3.0477 - accuracy20: 0.4781 - val_loss: 3.1369 - val_accuracy20: 0.4492 - 96s/epoch - 28ms/step
Epoch 33/50
3419/3419 - 97s - loss: 3.0459 - accuracy20: 0.4786 - val_loss: 3.1316 - val_accuracy20: 0.4520 - 97s/epoch - 28ms/step
Epoch 34/50
3419/3419 - 99s - loss: 3.0447 - accuracy20: 0.4793 - val_loss: 3.1338 - val_accuracy20: 0.4506 - 99s/epoch - 29ms/step
Epoch 35/50
3419/3419 - 101s - loss: 3.0433 - accuracy20: 0.4797 - val_loss: 3.1335 - val_accuracy20: 0.4517 - 101s/epoch - 29ms/step
Epoch 36/50
3419/3419 - 97s - loss: 3.0423 - accuracy20: 0.4799 - val_loss: 3.1329 - val_accuracy20: 0.4522 - 97s/epoch - 28ms/step
Epoch 37/50
3419/3419 - 97s - loss: 3.0399 - accuracy20: 0.4809 - val_loss: 3.1336 - val_accuracy20: 0.4510 - 97s/epoch - 28ms/step
Epoch 38/50
3419/3419 - 97s - loss: 3.0384 - accuracy20: 0.4812 - val_loss: 3.1319 - val_accuracy20: 0.4503 - 97s/epoch - 28ms/step
Epoch 39/50
3419/3419 - 97s - loss: 3.0368 - accuracy20: 0.4818 - val_loss: 3.1315 - val_accuracy20: 0.4515 - 97s/epoch - 28ms/step
Epoch 40/50
3419/3419 - 95s - loss: 3.0353 - accuracy20: 0.4825 - val_loss: 3.1348 - val_accuracy20: 0.4497 - 95s/epoch - 28ms/step
Epoch 41/50
3419/3419 - 96s - loss: 3.0340 - accuracy20: 0.4824 - val_loss: 3.1365 - val_accuracy20: 0.4503 - 96s/epoch - 28ms/step
Epoch 42/50
3419/3419 - 96s - loss: 3.0326 - accuracy20: 0.4833 - val_loss: 3.1337 - val_accuracy20: 0.4510 - 96s/epoch - 28ms/step
Epoch 43/50
3419/3419 - 95s - loss: 3.0312 - accuracy20: 0.4837 - val_loss: 3.1339 - val_accuracy20: 0.4504 - 95s/epoch - 28ms/step
Epoch 44/50
3419/3419 - 96s - loss: 3.0301 - accuracy20: 0.4840 - val_loss: 3.1370 - val_accuracy20: 0.4479 - 96s/epoch - 28ms/step
Epoch 45/50
3419/3419 - 97s - loss: 3.0284 - accuracy20: 0.4844 - val_loss: 3.1358 - val_accuracy20: 0.4483 - 97s/epoch - 28ms/step
Epoch 46/50
3419/3419 - 96s - loss: 3.0265 - accuracy20: 0.4851 - val_loss: 3.1361 - val_accuracy20: 0.4498 - 96s/epoch - 28ms/step
Epoch 47/50
3419/3419 - 96s - loss: 3.0248 - accuracy20: 0.4858 - val_loss: 3.1386 - val_accuracy20: 0.4481 - 96s/epoch - 28ms/step
Epoch 48/50
3419/3419 - 96s - loss: 3.0234 - accuracy20: 0.4861 - val_loss: 3.1345 - val_accuracy20: 0.4491 - 96s/epoch - 28ms/step
Epoch 49/50
3419/3419 - 99s - loss: 3.0226 - accuracy20: 0.4865 - val_loss: 3.1387 - val_accuracy20: 0.4467 - 99s/epoch - 29ms/step
testing model: results/AAPL/W9/deepVOL_L2/h20
Evaluating performance on  test set...
10303/10303 - 154s - 154s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0441016
{'0': {'precision': 0.4362032724902779, 'recall': 0.4834874378229945, 'f1-score': 0.4586298420139352, 'support': 836121}, '1': {'precision': 0.4367479980873377, 'recall': 0.42239234469784953, 'f1-score': 0.42945023476875227, 'support': 955782}, '2': {'precision': 0.4538231830310245, 'recall': 0.42203734827043377, 'f1-score': 0.4373534961450144, 'support': 845501}, 'accuracy': 0.4416471651669596, 'macro avg': {'precision': 0.44225815120288003, 'recall': 0.4426390435970926, 'f1-score': 0.44181119097590066, 'support': 2637404}, 'weighted avg': {'precision': 0.4420492827726316, 'recall': 0.4416471651669596, 'f1-score': 0.44123451119600443, 'support': 2637404}}
[[404254 254816 177051]
 [299669 403715 252398]
 [222833 265835 356833]]
Evaluating performance on  train set...
3419/3419 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0368265
{'0': {'precision': 0.4542212492496734, 'recall': 0.5328657134769792, 'f1-score': 0.49041054982479443, 'support': 289694}, '1': {'precision': 0.4454529559777114, 'recall': 0.40687263271548146, 'f1-score': 0.42528962958258865, 'support': 288041}, '2': {'precision': 0.4822194792217716, 'recall': 0.44134369357707476, 'f1-score': 0.46087703005651065, 'support': 297419}, 'accuracy': 0.46029384542606216, 'macro avg': {'precision': 0.46063122814971874, 'recall': 0.4603606799231785, 'f1-score': 0.4588590698212979, 'support': 875154}, 'weighted avg': {'precision': 0.4608504569065226, 'recall': 0.46029384542606216, 'f1-score': 0.4589402887010969, 'support': 875154}}
[[154368  70210  65116]
 [ 95017 117196  75828]
 [ 90467  75688 131264]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.044239
{'0': {'precision': 0.4450570470553818, 'recall': 0.5012207175622819, 'f1-score': 0.47147216350661947, 'support': 118373}, '1': {'precision': 0.4478775482832618, 'recall': 0.435825278355561, 'f1-score': 0.44176922663513735, 'support': 122595}, '2': {'precision': 0.4592916041620883, 'recall': 0.4133261105092091, 'f1-score': 0.4350982317826545, 'support': 116298}, 'accuracy': 0.45016878180403397, 'macro avg': {'precision': 0.45074206650024395, 'recall': 0.4501240354756841, 'f1-score': 0.44944654064147044, 'support': 357266}, 'weighted avg': {'precision': 0.4506585592911605, 'recall': 0.45016878180403397, 'f1-score': 0.44943914872941415, 'support': 357266}}
[[59331 33101 25941]
 [38516 53430 30649]
 [35464 32765 48069]]
training model: results/AAPL/W9/deepVOL_L2/h30
Epoch 1/50
3419/3419 - 104s - loss: 3.2295 - accuracy30: 0.4079 - val_loss: 3.2566 - val_accuracy30: 0.3723 - 104s/epoch - 30ms/step
Epoch 2/50
3419/3419 - 107s - loss: 3.2017 - accuracy30: 0.4194 - val_loss: 3.2446 - val_accuracy30: 0.3827 - 107s/epoch - 31ms/step
Epoch 3/50
3419/3419 - 108s - loss: 3.1890 - accuracy30: 0.4249 - val_loss: 3.2405 - val_accuracy30: 0.3876 - 108s/epoch - 32ms/step
Epoch 4/50
3419/3419 - 104s - loss: 3.1811 - accuracy30: 0.4291 - val_loss: 3.2313 - val_accuracy30: 0.3959 - 104s/epoch - 31ms/step
Epoch 5/50
3419/3419 - 105s - loss: 3.1729 - accuracy30: 0.4327 - val_loss: 3.2282 - val_accuracy30: 0.3938 - 105s/epoch - 31ms/step
Epoch 6/50
3419/3419 - 93s - loss: 3.1655 - accuracy30: 0.4356 - val_loss: 3.2266 - val_accuracy30: 0.3960 - 93s/epoch - 27ms/step
Epoch 7/50
3419/3419 - 94s - loss: 3.1612 - accuracy30: 0.4379 - val_loss: 3.2172 - val_accuracy30: 0.4021 - 94s/epoch - 27ms/step
Epoch 8/50
3419/3419 - 97s - loss: 3.1559 - accuracy30: 0.4396 - val_loss: 3.2159 - val_accuracy30: 0.4020 - 97s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 97s - loss: 3.1516 - accuracy30: 0.4415 - val_loss: 3.2124 - val_accuracy30: 0.4039 - 97s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 97s - loss: 3.1486 - accuracy30: 0.4422 - val_loss: 3.2101 - val_accuracy30: 0.4067 - 97s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 96s - loss: 3.1457 - accuracy30: 0.4433 - val_loss: 3.2089 - val_accuracy30: 0.4056 - 96s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 97s - loss: 3.1432 - accuracy30: 0.4440 - val_loss: 3.2081 - val_accuracy30: 0.4062 - 97s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 98s - loss: 3.1406 - accuracy30: 0.4455 - val_loss: 3.2055 - val_accuracy30: 0.4082 - 98s/epoch - 29ms/step
Epoch 14/50
3419/3419 - 97s - loss: 3.1385 - accuracy30: 0.4458 - val_loss: 3.2053 - val_accuracy30: 0.4076 - 97s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 96s - loss: 3.1367 - accuracy30: 0.4465 - val_loss: 3.2046 - val_accuracy30: 0.4078 - 96s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 96s - loss: 3.1345 - accuracy30: 0.4474 - val_loss: 3.2012 - val_accuracy30: 0.4108 - 96s/epoch - 28ms/step
Epoch 17/50
3419/3419 - 98s - loss: 3.1325 - accuracy30: 0.4481 - val_loss: 3.2042 - val_accuracy30: 0.4087 - 98s/epoch - 29ms/step
Epoch 18/50
3419/3419 - 95s - loss: 3.1305 - accuracy30: 0.4485 - val_loss: 3.2026 - val_accuracy30: 0.4105 - 95s/epoch - 28ms/step
Epoch 19/50
3419/3419 - 95s - loss: 3.1292 - accuracy30: 0.4493 - val_loss: 3.1998 - val_accuracy30: 0.4120 - 95s/epoch - 28ms/step
Epoch 20/50
3419/3419 - 95s - loss: 3.1275 - accuracy30: 0.4498 - val_loss: 3.2016 - val_accuracy30: 0.4106 - 95s/epoch - 28ms/step
Epoch 21/50
3419/3419 - 96s - loss: 3.1258 - accuracy30: 0.4502 - val_loss: 3.1984 - val_accuracy30: 0.4129 - 96s/epoch - 28ms/step
Epoch 22/50
3419/3419 - 98s - loss: 3.1243 - accuracy30: 0.4507 - val_loss: 3.2003 - val_accuracy30: 0.4118 - 98s/epoch - 29ms/step
Epoch 23/50
3419/3419 - 98s - loss: 3.1225 - accuracy30: 0.4513 - val_loss: 3.1999 - val_accuracy30: 0.4117 - 98s/epoch - 29ms/step
Epoch 24/50
3419/3419 - 97s - loss: 3.1216 - accuracy30: 0.4513 - val_loss: 3.1990 - val_accuracy30: 0.4124 - 97s/epoch - 28ms/step
Epoch 25/50
3419/3419 - 97s - loss: 3.1199 - accuracy30: 0.4518 - val_loss: 3.2004 - val_accuracy30: 0.4109 - 97s/epoch - 28ms/step
Epoch 26/50
3419/3419 - 95s - loss: 3.1183 - accuracy30: 0.4529 - val_loss: 3.1989 - val_accuracy30: 0.4130 - 95s/epoch - 28ms/step
Epoch 27/50
3419/3419 - 96s - loss: 3.1166 - accuracy30: 0.4534 - val_loss: 3.1987 - val_accuracy30: 0.4135 - 96s/epoch - 28ms/step
Epoch 28/50
3419/3419 - 97s - loss: 3.1150 - accuracy30: 0.4538 - val_loss: 3.1991 - val_accuracy30: 0.4145 - 97s/epoch - 28ms/step
Epoch 29/50
3419/3419 - 96s - loss: 3.1137 - accuracy30: 0.4547 - val_loss: 3.1978 - val_accuracy30: 0.4134 - 96s/epoch - 28ms/step
Epoch 30/50
3419/3419 - 96s - loss: 3.1124 - accuracy30: 0.4550 - val_loss: 3.1974 - val_accuracy30: 0.4156 - 96s/epoch - 28ms/step
Epoch 31/50
3419/3419 - 96s - loss: 3.1106 - accuracy30: 0.4557 - val_loss: 3.1977 - val_accuracy30: 0.4146 - 96s/epoch - 28ms/step
Epoch 32/50
3419/3419 - 97s - loss: 3.1093 - accuracy30: 0.4561 - val_loss: 3.1972 - val_accuracy30: 0.4157 - 97s/epoch - 28ms/step
Epoch 33/50
3419/3419 - 96s - loss: 3.1079 - accuracy30: 0.4566 - val_loss: 3.1993 - val_accuracy30: 0.4143 - 96s/epoch - 28ms/step
Epoch 34/50
3419/3419 - 95s - loss: 3.1066 - accuracy30: 0.4574 - val_loss: 3.1984 - val_accuracy30: 0.4155 - 95s/epoch - 28ms/step
Epoch 35/50
3419/3419 - 97s - loss: 3.1050 - accuracy30: 0.4578 - val_loss: 3.2003 - val_accuracy30: 0.4143 - 97s/epoch - 28ms/step
Epoch 36/50
3419/3419 - 96s - loss: 3.1036 - accuracy30: 0.4583 - val_loss: 3.2013 - val_accuracy30: 0.4154 - 96s/epoch - 28ms/step
Epoch 37/50
3419/3419 - 96s - loss: 3.1012 - accuracy30: 0.4592 - val_loss: 3.1997 - val_accuracy30: 0.4151 - 96s/epoch - 28ms/step
Epoch 38/50
3419/3419 - 96s - loss: 3.0999 - accuracy30: 0.4598 - val_loss: 3.2031 - val_accuracy30: 0.4127 - 96s/epoch - 28ms/step
Epoch 39/50
3419/3419 - 97s - loss: 3.0986 - accuracy30: 0.4600 - val_loss: 3.2002 - val_accuracy30: 0.4149 - 97s/epoch - 28ms/step
Epoch 40/50
3419/3419 - 96s - loss: 3.0972 - accuracy30: 0.4610 - val_loss: 3.2030 - val_accuracy30: 0.4140 - 96s/epoch - 28ms/step
Epoch 41/50
3419/3419 - 96s - loss: 3.0958 - accuracy30: 0.4614 - val_loss: 3.2075 - val_accuracy30: 0.4117 - 96s/epoch - 28ms/step
Epoch 42/50
3419/3419 - 95s - loss: 3.0944 - accuracy30: 0.4620 - val_loss: 3.2046 - val_accuracy30: 0.4135 - 95s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h30
Evaluating performance on  test set...
10303/10303 - 132s - 132s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0672499
{'0': {'precision': 0.4497019112091858, 'recall': 0.35070124615425896, 'f1-score': 0.3940789568559896, 'support': 857117}, '1': {'precision': 0.36573238662458185, 'recall': 0.6037313965033929, 'f1-score': 0.4555180469165194, 'support': 911455}, '2': {'precision': 0.48035951920550907, 'recall': 0.256756196825163, 'f1-score': 0.3346429348274491, 'support': 868832}, 'accuracy': 0.40719738045441656, 'macro avg': {'precision': 0.43193127234642553, 'recall': 0.4037296131609383, 'f1-score': 0.394746646199986, 'support': 2637404}, 'weighted avg': {'precision': 0.43078249948477854, 'recall': 0.40719738045441656, 'f1-score': 0.39573173661215105, 'support': 2637404}}
[[300592 462808  93717]
 [213578 550274 147603]
 [154255 491499 223078]]
Evaluating performance on  train set...
3419/3419 - 49s - 49s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0634458
{'0': {'precision': 0.45727448417439837, 'recall': 0.3955405574129823, 'f1-score': 0.4241731103251026, 'support': 288332}, '1': {'precision': 0.36966515644439124, 'recall': 0.5773282997956568, 'f1-score': 0.45072783736245314, 'support': 288730}, '2': {'precision': 0.49244083948724693, 'recall': 0.28880010198193845, 'f1-score': 0.3640796510140343, 'support': 298092}, 'accuracy': 0.4191582281518453, 'macro avg': {'precision': 0.43979349336867885, 'recall': 0.4205563197301925, 'f1-score': 0.41299353290053004, 'support': 875154}, 'weighted avg': {'precision': 0.4403487408108677, 'recall': 0.4191582281518453, 'f1-score': 0.412465190192805, 'support': 875154}}
[[114047 135566  38719]
 [ 72025 166692  50013]
 [ 63334 148669  86089]]
Evaluating performance on  val set...
1396/1396 - 18s - 18s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0664885
{'0': {'precision': 0.45041578877726546, 'recall': 0.37302537300851385, 'f1-score': 0.40808384475993303, 'support': 118630}, '1': {'precision': 0.37722441886173513, 'recall': 0.6042282636446743, 'f1-score': 0.464474059067456, 'support': 121421}, '2': {'precision': 0.47976135130946845, 'recall': 0.2641214861579149, 'f1-score': 0.3406861261657817, 'support': 117215}, 'accuracy': 0.4158722072629357, 'macro avg': {'precision': 0.4358005196494897, 'recall': 0.413791707603701, 'f1-score': 0.4044146766643902, 'support': 357266}, 'weighted avg': {'precision': 0.43516880413752523, 'recall': 0.4158722072629357, 'f1-score': 0.40513627243684686, 'support': 357266}}
[[44252 59784 14594]
 [29078 73366 18977]
 [24917 61339 30959]]
training model: results/AAPL/W9/deepVOL_L2/h50
Epoch 1/50
3419/3419 - 113s - loss: 3.2065 - accuracy50: 0.4228 - val_loss: 3.2882 - val_accuracy50: 0.3573 - 113s/epoch - 33ms/step
Epoch 2/50
3419/3419 - 104s - loss: 3.1945 - accuracy50: 0.4271 - val_loss: 3.2956 - val_accuracy50: 0.3646 - 104s/epoch - 30ms/step
Epoch 3/50
3419/3419 - 97s - loss: 3.1876 - accuracy50: 0.4309 - val_loss: 3.2698 - val_accuracy50: 0.3688 - 97s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 101s - loss: 3.1795 - accuracy50: 0.4333 - val_loss: 3.2712 - val_accuracy50: 0.3690 - 101s/epoch - 30ms/step
Epoch 5/50
3419/3419 - 103s - loss: 3.1711 - accuracy50: 0.4369 - val_loss: 3.2692 - val_accuracy50: 0.3692 - 103s/epoch - 30ms/step
Epoch 6/50
3419/3419 - 102s - loss: 3.1658 - accuracy50: 0.4402 - val_loss: 3.2636 - val_accuracy50: 0.3734 - 102s/epoch - 30ms/step
Epoch 7/50
3419/3419 - 99s - loss: 3.1622 - accuracy50: 0.4413 - val_loss: 3.2687 - val_accuracy50: 0.3703 - 99s/epoch - 29ms/step
Epoch 8/50
3419/3419 - 100s - loss: 3.1555 - accuracy50: 0.4440 - val_loss: 3.2731 - val_accuracy50: 0.3703 - 100s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 100s - loss: 3.1504 - accuracy50: 0.4466 - val_loss: 3.2720 - val_accuracy50: 0.3706 - 100s/epoch - 29ms/step
Epoch 10/50
3419/3419 - 100s - loss: 3.1467 - accuracy50: 0.4477 - val_loss: 3.2734 - val_accuracy50: 0.3715 - 100s/epoch - 29ms/step
Epoch 11/50
3419/3419 - 97s - loss: 3.1425 - accuracy50: 0.4496 - val_loss: 3.2796 - val_accuracy50: 0.3736 - 97s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 97s - loss: 3.1390 - accuracy50: 0.4513 - val_loss: 3.2825 - val_accuracy50: 0.3722 - 97s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 100s - loss: 3.1357 - accuracy50: 0.4522 - val_loss: 3.2811 - val_accuracy50: 0.3736 - 100s/epoch - 29ms/step
Epoch 14/50
3419/3419 - 96s - loss: 3.1329 - accuracy50: 0.4533 - val_loss: 3.2848 - val_accuracy50: 0.3730 - 96s/epoch - 28ms/step
Epoch 15/50
3419/3419 - 96s - loss: 3.1303 - accuracy50: 0.4542 - val_loss: 3.2806 - val_accuracy50: 0.3741 - 96s/epoch - 28ms/step
Epoch 16/50
3419/3419 - 96s - loss: 3.1279 - accuracy50: 0.4550 - val_loss: 3.2818 - val_accuracy50: 0.3748 - 96s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h50
Evaluating performance on  test set...
10303/10303 - 150s - 150s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0812002
{'0': {'precision': 0.4245265973464652, 'recall': 0.1482456075238088, 'f1-score': 0.21975299359331144, 'support': 808314}, '1': {'precision': 0.3874887333218137, 'recall': 0.8240861949437543, 'f1-score': 0.5271223568217569, 'support': 1006834}, '2': {'precision': 0.4356498604285801, 'recall': 0.11331264229145181, 'f1-score': 0.17984702617927376, 'support': 822256}, 'accuracy': 0.39535808696733604, 'macro avg': {'precision': 0.41588839703228636, 'recall': 0.3618814815863383, 'f1-score': 0.3089074588647807, 'support': 2637404}, 'weighted avg': {'precision': 0.4138551905469956, 'recall': 0.39535808696733604, 'f1-score': 0.3246504625873494, 'support': 2637404}}
[[119829 641623  46862]
 [103281 829718  73835]
 [ 59155 669929  93172]]
Evaluating performance on  train set...
3419/3419 - 50s - 50s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0944371
{'0': {'precision': 0.4596821733622647, 'recall': 0.12802509501453163, 'f1-score': 0.2002726768506097, 'support': 286272}, '1': {'precision': 0.33669004897571114, 'recall': 0.8404666710362456, 'f1-score': 0.4807801031467962, 'support': 289883}, '2': {'precision': 0.4766925251737441, 'recall': 0.11447195475570153, 'f1-score': 0.1846116504854369, 'support': 298999}, 'accuracy': 0.3593813203161958, 'macro avg': {'precision': 0.42435491583724, 'recall': 0.36098790693549293, 'f1-score': 0.2885548101609476, 'support': 875154}, 'weighted avg': {'precision': 0.42475432316416606, 'recall': 0.3593813203161958, 'f1-score': 0.28783635482597986, 'support': 875154}}
[[ 36650 232826  16796]
 [ 25468 243637  20778]
 [ 17611 247161  34227]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0879008
{'0': {'precision': 0.45296631161753775, 'recall': 0.12603166945224598, 'f1-score': 0.19719619869245802, 'support': 116074}, '1': {'precision': 0.3570381083035419, 'recall': 0.8407584522227616, 'f1-score': 0.5012250280463827, 'support': 125677}, '2': {'precision': 0.45279768467475195, 'recall': 0.11376877461801498, 'f1-score': 0.18184711392772884, 'support': 115515}, 'accuracy': 0.37348922091662795, 'macro avg': {'precision': 0.4209340348652772, 'recall': 0.3601862987643409, 'f1-score': 0.29342278022218987, 'support': 357266}, 'weighted avg': {'precision': 0.4191667120217493, 'recall': 0.37348922091662795, 'f1-score': 0.29918290232536876, 'support': 357266}}
[[ 14629  94673   6772]
 [ 10903 105664   9110]
 [  6764  95609  13142]]
training model: results/AAPL/W9/deepVOL_L2/h100
Epoch 1/50
3419/3419 - 100s - loss: 3.2595 - accuracy100: 0.3886 - val_loss: 3.2985 - val_accuracy100: 0.3425 - 100s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 96s - loss: 3.2495 - accuracy100: 0.3927 - val_loss: 3.2858 - val_accuracy100: 0.3519 - 96s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 97s - loss: 3.2410 - accuracy100: 0.3987 - val_loss: 3.2866 - val_accuracy100: 0.3517 - 97s/epoch - 28ms/step
Epoch 4/50
3419/3419 - 96s - loss: 3.2347 - accuracy100: 0.4033 - val_loss: 3.2942 - val_accuracy100: 0.3507 - 96s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 95s - loss: 3.2300 - accuracy100: 0.4057 - val_loss: 3.2975 - val_accuracy100: 0.3512 - 95s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 98s - loss: 3.2262 - accuracy100: 0.4083 - val_loss: 3.2938 - val_accuracy100: 0.3553 - 98s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 95s - loss: 3.2228 - accuracy100: 0.4098 - val_loss: 3.2931 - val_accuracy100: 0.3563 - 95s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 97s - loss: 3.2191 - accuracy100: 0.4116 - val_loss: 3.2960 - val_accuracy100: 0.3563 - 97s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 95s - loss: 3.2160 - accuracy100: 0.4140 - val_loss: 3.3028 - val_accuracy100: 0.3546 - 95s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 95s - loss: 3.2136 - accuracy100: 0.4144 - val_loss: 3.2985 - val_accuracy100: 0.3568 - 95s/epoch - 28ms/step
Epoch 11/50
3419/3419 - 99s - loss: 3.2112 - accuracy100: 0.4163 - val_loss: 3.3035 - val_accuracy100: 0.3563 - 99s/epoch - 29ms/step
Epoch 12/50
3419/3419 - 97s - loss: 3.2094 - accuracy100: 0.4171 - val_loss: 3.3067 - val_accuracy100: 0.3557 - 97s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h100
Evaluating performance on  test set...
10303/10303 - 140s - 140s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0898917
{'0': {'precision': 0.35460619475812427, 'recall': 0.1724762110780416, 'f1-score': 0.23207427233188357, 'support': 804366}, '1': {'precision': 0.3850902773627476, 'recall': 0.7415651534109241, 'f1-score': 0.5069332163312101, 'support': 1016616}, '2': {'precision': 0.36639501388306334, 'recall': 0.12946490907888322, 'f1-score': 0.1913253923647596, 'support': 816422}, 'accuracy': 0.37852335099211193, 'macro avg': {'precision': 0.36869716200131175, 'recall': 0.3478354245226163, 'f1-score': 0.31011096034261776, 'support': 2637404}, 'weighted avg': {'precision': 0.3700059050068396, 'recall': 0.37852335099211193, 'f1-score': 0.3254076100125347, 'support': 2637404}}
[[138734 594965  70667]
 [150613 753887 112116]
 [101887 608837 105698]]
Evaluating performance on  train set...
3419/3419 - 50s - 50s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0959754
{'0': {'precision': 0.3921782461949946, 'recall': 0.1720510841589518, 'f1-score': 0.23917470720310696, 'support': 286351}, '1': {'precision': 0.33129116824840726, 'recall': 0.7625157493225634, 'f1-score': 0.46190004715250127, 'support': 289695}, '2': {'precision': 0.422191072334872, 'recall': 0.11680730705965738, 'f1-score': 0.18298757142632677, 'support': 299108}, 'accuracy': 0.34862664171105884, 'macro avg': {'precision': 0.38188682892609127, 'recall': 0.3504580468470575, 'f1-score': 0.2946874419273116, 'support': 875154}, 'weighted avg': {'precision': 0.38228101022887867, 'recall': 0.34862664171105884, 'f1-score': 0.2936981345641413, 'support': 875154}}
[[ 49267 215971  21113]
 [ 42095 220897  26703]
 [ 34262 229908  34938]]
Evaluating performance on  val set...
1396/1396 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0951222
{'0': {'precision': 0.40220431332739437, 'recall': 0.16328556048983986, 'f1-score': 0.2322735022283373, 'support': 118896}, '1': {'precision': 0.33793860205046117, 'recall': 0.7751657224502002, 'f1-score': 0.47068080652686534, 'support': 120382}, '2': {'precision': 0.4007120253164557, 'recall': 0.1116130453944469, 'f1-score': 0.1745949672526715, 'support': 117988}, 'accuracy': 0.352395693964721, 'macro avg': {'precision': 0.38028498023143714, 'recall': 0.35002144277816233, 'f1-score': 0.29251642533595806, 'support': 357266}, 'weighted avg': {'precision': 0.3800569303332824, 'recall': 0.352395693964721, 'f1-score': 0.293557176357296, 'support': 357266}}
[[19414 91056  8426]
 [15797 93316 11269]
 [13058 91761 13169]]
training model: results/AAPL/W9/deepVOL_L2/h200
Epoch 1/50
3419/3419 - 101s - loss: 3.2557 - accuracy200: 0.3887 - val_loss: 3.3245 - val_accuracy200: 0.3405 - 101s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 99s - loss: 3.2534 - accuracy200: 0.3880 - val_loss: 3.3041 - val_accuracy200: 0.3405 - 99s/epoch - 29ms/step
Epoch 3/50
3419/3419 - 101s - loss: 3.2541 - accuracy200: 0.3865 - val_loss: 3.3020 - val_accuracy200: 0.3420 - 101s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 101s - loss: 3.2503 - accuracy200: 0.3886 - val_loss: 3.2907 - val_accuracy200: 0.3462 - 101s/epoch - 30ms/step
Epoch 5/50
3419/3419 - 98s - loss: 3.2458 - accuracy200: 0.3928 - val_loss: 3.2934 - val_accuracy200: 0.3465 - 98s/epoch - 29ms/step
Epoch 6/50
3419/3419 - 99s - loss: 3.2425 - accuracy200: 0.3952 - val_loss: 3.2945 - val_accuracy200: 0.3478 - 99s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 98s - loss: 3.2389 - accuracy200: 0.3984 - val_loss: 3.2973 - val_accuracy200: 0.3479 - 98s/epoch - 29ms/step
Epoch 8/50
3419/3419 - 98s - loss: 3.2345 - accuracy200: 0.4016 - val_loss: 3.2995 - val_accuracy200: 0.3464 - 98s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 99s - loss: 3.2322 - accuracy200: 0.4028 - val_loss: 3.3047 - val_accuracy200: 0.3447 - 99s/epoch - 29ms/step
Epoch 10/50
3419/3419 - 99s - loss: 3.2292 - accuracy200: 0.4046 - val_loss: 3.3076 - val_accuracy200: 0.3446 - 99s/epoch - 29ms/step
Epoch 11/50
3419/3419 - 96s - loss: 3.2275 - accuracy200: 0.4055 - val_loss: 3.3078 - val_accuracy200: 0.3447 - 96s/epoch - 28ms/step
Epoch 12/50
3419/3419 - 96s - loss: 3.2250 - accuracy200: 0.4070 - val_loss: 3.3151 - val_accuracy200: 0.3442 - 96s/epoch - 28ms/step
Epoch 13/50
3419/3419 - 103s - loss: 3.2235 - accuracy200: 0.4079 - val_loss: 3.3126 - val_accuracy200: 0.3441 - 103s/epoch - 30ms/step
Epoch 14/50
3419/3419 - 105s - loss: 3.2212 - accuracy200: 0.4093 - val_loss: 3.3177 - val_accuracy200: 0.3433 - 105s/epoch - 31ms/step
testing model: results/AAPL/W9/deepVOL_L2/h200
Evaluating performance on  test set...
10303/10303 - 163s - 163s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0953972
{'0': {'precision': 0.33362087280133035, 'recall': 0.224376550463507, 'f1-score': 0.2683048253656841, 'support': 811854}, '1': {'precision': 0.3771900275254766, 'recall': 0.6661013937852589, 'f1-score': 0.4816426128395977, 'support': 1001876}, '2': {'precision': 0.3351990860605609, 'recall': 0.1310894844319476, 'f1-score': 0.18847159529270485, 'support': 823674}, 'accuracy': 0.3630414604664284, 'macro avg': {'precision': 0.348669995462456, 'recall': 0.3405224762269045, 'f1-score': 0.31280634449932887, 'support': 2637404}, 'weighted avg': {'precision': 0.35066445948220754, 'recall': 0.3630414604664284, 'f1-score': 0.32441357973781804, 'support': 2637404}}
[[182161 537970  91723]
 [212101 667351 122424]
 [151750 563949 107975]]
Evaluating performance on  train set...
3419/3419 - 46s - 46s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990933
{'0': {'precision': 0.36185629468072217, 'recall': 0.2075986500248515, 'f1-score': 0.263834317278789, 'support': 287709}, '1': {'precision': 0.32588997237834344, 'recall': 0.6940133729414578, 'f1-score': 0.4435165351225985, 'support': 288493}, '2': {'precision': 0.3889742062870217, 'recall': 0.12454507747063073, 'f1-score': 0.1886777154758496, 'support': 298952}, 'accuracy': 0.33957337794262493, 'macro avg': {'precision': 0.35890682444869576, 'recall': 0.3420523668123134, 'f1-score': 0.29867618929241235, 'support': 875154}, 'weighted avg': {'precision': 0.35926351865564116, 'recall': 0.33957337794262493, 'f1-score': 0.2973928060135966, 'support': 875154}}
[[ 59728 199851  28130]
 [ 57917 200218  30358]
 [ 47415 214304  37233]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0971287
{'0': {'precision': 0.3729834305863263, 'recall': 0.2010106870485752, 'f1-score': 0.2612349267578392, 'support': 118929}, '1': {'precision': 0.3367445675762849, 'recall': 0.6982314475378976, 'f1-score': 0.45435960531582525, 'support': 121116}, '2': {'precision': 0.3690207178706501, 'recall': 0.13234829936615453, 'f1-score': 0.19482362396554107, 'support': 117221}, 'accuracy': 0.3470439392497467, 'macro avg': {'precision': 0.35958290534442044, 'recall': 0.3438634779842091, 'f1-score': 0.3034727186797352, 'support': 357266}, 'weighted avg': {'precision': 0.35939798086659797, 'recall': 0.3470439392497467, 'f1-score': 0.3049157954764216, 'support': 357266}}
[[23906 82472 12551]
 [22573 84567 13976]
 [17615 84092 15514]]
training model: results/AAPL/W9/deepVOL_L2/h300
Epoch 1/50
3419/3419 - 100s - loss: 3.2574 - accuracy300: 0.3871 - val_loss: 3.3002 - val_accuracy300: 0.3438 - 100s/epoch - 29ms/step
Epoch 2/50
3419/3419 - 97s - loss: 3.2574 - accuracy300: 0.3856 - val_loss: 3.2977 - val_accuracy300: 0.3426 - 97s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 98s - loss: 3.2547 - accuracy300: 0.3882 - val_loss: 3.2986 - val_accuracy300: 0.3425 - 98s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 97s - loss: 3.2480 - accuracy300: 0.3938 - val_loss: 3.2978 - val_accuracy300: 0.3450 - 97s/epoch - 28ms/step
Epoch 5/50
3419/3419 - 96s - loss: 3.2477 - accuracy300: 0.3948 - val_loss: 3.2969 - val_accuracy300: 0.3427 - 96s/epoch - 28ms/step
Epoch 6/50
3419/3419 - 96s - loss: 3.2444 - accuracy300: 0.3963 - val_loss: 3.2986 - val_accuracy300: 0.3430 - 96s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 99s - loss: 3.2433 - accuracy300: 0.3972 - val_loss: 3.2990 - val_accuracy300: 0.3434 - 99s/epoch - 29ms/step
Epoch 8/50
3419/3419 - 96s - loss: 3.2396 - accuracy300: 0.4000 - val_loss: 3.3161 - val_accuracy300: 0.3434 - 96s/epoch - 28ms/step
Epoch 9/50
3419/3419 - 97s - loss: 3.2378 - accuracy300: 0.4012 - val_loss: 3.3021 - val_accuracy300: 0.3427 - 97s/epoch - 28ms/step
Epoch 10/50
3419/3419 - 99s - loss: 3.2346 - accuracy300: 0.4027 - val_loss: 3.3024 - val_accuracy300: 0.3448 - 99s/epoch - 29ms/step
Epoch 11/50
3419/3419 - 100s - loss: 3.2325 - accuracy300: 0.4040 - val_loss: 3.3037 - val_accuracy300: 0.3434 - 100s/epoch - 29ms/step
Epoch 12/50
3419/3419 - 104s - loss: 3.2299 - accuracy300: 0.4055 - val_loss: 3.3096 - val_accuracy300: 0.3441 - 104s/epoch - 30ms/step
Epoch 13/50
3419/3419 - 103s - loss: 3.2277 - accuracy300: 0.4066 - val_loss: 3.3080 - val_accuracy300: 0.3441 - 103s/epoch - 30ms/step
Epoch 14/50
3419/3419 - 102s - loss: 3.2255 - accuracy300: 0.4078 - val_loss: 3.3149 - val_accuracy300: 0.3457 - 102s/epoch - 30ms/step
Epoch 15/50
3419/3419 - 98s - loss: 3.2232 - accuracy300: 0.4082 - val_loss: 3.3182 - val_accuracy300: 0.3458 - 98s/epoch - 29ms/step
testing model: results/AAPL/W9/deepVOL_L2/h300
Evaluating performance on  test set...
10303/10303 - 136s - 136s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952381
{'0': {'precision': 0.33117184730659693, 'recall': 0.0671103784719685, 'f1-score': 0.11160461890339664, 'support': 807431}, '1': {'precision': 0.38284018286265586, 'recall': 0.919814324761577, 'f1-score': 0.5406527705241584, 'support': 1011228}, '2': {'precision': 0.3237856060091857, 'recall': 0.01747919071261504, 'f1-score': 0.03316785330218415, 'support': 818745}, 'accuracy': 0.37864506158328415, 'macro avg': {'precision': 0.3459325453928128, 'recall': 0.33480129798205355, 'f1-score': 0.2284750809099131, 'support': 2637404}, 'weighted avg': {'precision': 0.34868945913119165, 'recall': 0.37864506158328415, 'f1-score': 0.25175978459473364, 'support': 2637404}}
[[ 54187 739875  13369]
 [ 64567 930142  16519]
 [ 44868 759566  14311]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1027571
{'0': {'precision': 0.35499947867792725, 'recall': 0.05913123215538621, 'f1-score': 0.10137647867991438, 'support': 287902}, '1': {'precision': 0.3301116540017242, 'recall': 0.9277342872448892, 'f1-score': 0.486952956628377, 'support': 289335}, '2': {'precision': 0.4079078367230835, 'recall': 0.019253684751121956, 'f1-score': 0.03677170578788957, 'support': 297917}, 'accuracy': 0.33272544032250323, 'macro avg': {'precision': 0.3643396564675783, 'recall': 0.3353730680504658, 'f1-score': 0.20836704703206033, 'support': 875154}, 'weighted avg': {'precision': 0.3647821918358967, 'recall': 0.33272544032250323, 'f1-score': 0.20685952523120146, 'support': 875154}}
[[ 17024 266568   4310]
 [ 16893 268426   4016]
 [ 14038 278143   5736]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994167
{'0': {'precision': 0.34267585931254996, 'recall': 0.05782037664592922, 'f1-score': 0.09894548549501594, 'support': 118626}, '1': {'precision': 0.3419471683435486, 'recall': 0.9170320267296879, 'f1-score': 0.49814406155031177, 'support': 122710}, '2': {'precision': 0.3872903146810334, 'recall': 0.027283705684464764, 'f1-score': 0.05097625244768206, 'support': 115930}, 'accuracy': 0.34302452514373044, 'macro avg': {'precision': 0.3573044474457106, 'recall': 0.3340453696866939, 'f1-score': 0.21602193316433657, 'support': 357266}, 'weighted avg': {'precision': 0.35690261512491983, 'recall': 0.34302452514373044, 'f1-score': 0.22049241154050567, 'support': 357266}}
[[  6859 109297   2470]
 [  7647 112529   2534]
 [  5510 107257   3163]]
training model: results/AAPL/W9/deepVOL_L2/h500
Epoch 1/50
3419/3419 - 103s - loss: 3.2592 - accuracy500: 0.3847 - val_loss: 3.2978 - val_accuracy500: 0.3432 - 103s/epoch - 30ms/step
Epoch 2/50
3419/3419 - 100s - loss: 3.2602 - accuracy500: 0.3813 - val_loss: 3.2978 - val_accuracy500: 0.3435 - 100s/epoch - 29ms/step
Epoch 3/50
3419/3419 - 99s - loss: 3.2681 - accuracy500: 0.3759 - val_loss: 3.2946 - val_accuracy500: 0.3427 - 99s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 100s - loss: 3.2687 - accuracy500: 0.3749 - val_loss: 3.2958 - val_accuracy500: 0.3433 - 100s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 101s - loss: 3.2631 - accuracy500: 0.3833 - val_loss: 3.3015 - val_accuracy500: 0.3434 - 101s/epoch - 30ms/step
Epoch 6/50
3419/3419 - 101s - loss: 3.2616 - accuracy500: 0.3846 - val_loss: 3.2979 - val_accuracy500: 0.3431 - 101s/epoch - 29ms/step
Epoch 7/50
3419/3419 - 100s - loss: 3.2555 - accuracy500: 0.3882 - val_loss: 3.3043 - val_accuracy500: 0.3438 - 100s/epoch - 29ms/step
Epoch 8/50
3419/3419 - 98s - loss: 3.2508 - accuracy500: 0.3913 - val_loss: 3.3028 - val_accuracy500: 0.3398 - 98s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 104s - loss: 3.2478 - accuracy500: 0.3944 - val_loss: 3.3085 - val_accuracy500: 0.3376 - 104s/epoch - 30ms/step
Epoch 10/50
3419/3419 - 103s - loss: 3.2460 - accuracy500: 0.3952 - val_loss: 3.3087 - val_accuracy500: 0.3390 - 103s/epoch - 30ms/step
Epoch 11/50
3419/3419 - 98s - loss: 3.2432 - accuracy500: 0.3961 - val_loss: 3.3104 - val_accuracy500: 0.3401 - 98s/epoch - 29ms/step
Epoch 12/50
3419/3419 - 102s - loss: 3.2428 - accuracy500: 0.3962 - val_loss: 3.3125 - val_accuracy500: 0.3352 - 102s/epoch - 30ms/step
Epoch 13/50
3419/3419 - 96s - loss: 3.2392 - accuracy500: 0.3978 - val_loss: 3.3210 - val_accuracy500: 0.3363 - 96s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h500
Evaluating performance on  test set...
10303/10303 - 134s - 134s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951375
{'0': {'precision': 0.30067031900795155, 'recall': 0.1278660765729612, 'f1-score': 0.17942715918619534, 'support': 794902}, '1': {'precision': 0.39114395323076173, 'recall': 0.8678819650836086, 'f1-score': 0.5392530492382159, 'support': 1034643}, '2': {'precision': 0.2987154960371686, 'recall': 0.0013529588702979108, 'f1-score': 0.0026937172065191408, 'support': 807859}, 'accuracy': 0.3794193077738564, 'macro avg': {'precision': 0.330176589425294, 'recall': 0.3323670001756226, 'f1-score': 0.24045797521031012, 'support': 2637404}, 'weighted avg': {'precision': 0.3355639837642184, 'recall': 0.3794193077738564, 'f1-score': 0.26645047326960214, 'support': 2637404}}
[[101641 692167   1094]
 [135223 897948   1472]
 [101184 705582   1093]]
Evaluating performance on  train set...
3419/3419 - 44s - 44s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009357
{'0': {'precision': 0.3367157220952927, 'recall': 0.1258095955651098, 'f1-score': 0.1831772973272177, 'support': 289342}, '1': {'precision': 0.3258957484592082, 'recall': 0.8640908461431934, 'f1-score': 0.4732885804224978, 'support': 288840}, '2': {'precision': 0.3950207468879668, 'recall': 0.0016028447126328407, 'f1-score': 0.0031927345167467643, 'support': 296972}, 'accuracy': 0.32732753321129765, 'macro avg': {'precision': 0.3525440724808226, 'recall': 0.33050109547364537, 'f1-score': 0.21988620408882073, 'support': 875154}, 'weighted avg': {'precision': 0.35292968973719724, 'recall': 0.32732753321129765, 'f1-score': 0.21785161455857302, 'support': 875154}}
[[ 36402 252578    362]
 [ 38889 249584    367]
 [ 32818 263678    476]]
Evaluating performance on  val set...
1396/1396 - 17s - 17s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984879
{'0': {'precision': 0.3564965617082881, 'recall': 0.11651880016899029, 'f1-score': 0.17563299200163024, 'support': 118350}, '1': {'precision': 0.3408928655669649, 'recall': 0.883808157075064, 'f1-score': 0.4920121559575767, 'support': 122642}, '2': {'precision': 0.345718901453958, 'recall': 0.0018404802449386794, 'f1-score': 0.0036614681803016436, 'support': 116274}, 'accuracy': 0.34259067473535126, 'macro avg': {'precision': 0.3477027762430704, 'recall': 0.33405581249633104, 'f1-score': 0.22376887204650286, 'support': 357266}, 'weighted avg': {'precision': 0.347632493561372, 'recall': 0.34259067473535126, 'f1-score': 0.22827040072533755, 'support': 357266}}
[[ 13790 104362    198]
 [ 14043 108392    207]
 [ 10849 105211    214]]
training model: results/AAPL/W9/deepVOL_L2/h1000
Epoch 1/50
3419/3419 - 101s - loss: 3.2656 - accuracy1000: 0.3819 - val_loss: 3.2987 - val_accuracy1000: 0.3310 - 101s/epoch - 30ms/step
Epoch 2/50
3419/3419 - 96s - loss: 3.2655 - accuracy1000: 0.3765 - val_loss: 3.2976 - val_accuracy1000: 0.3381 - 96s/epoch - 28ms/step
Epoch 3/50
3419/3419 - 99s - loss: 3.2669 - accuracy1000: 0.3755 - val_loss: 3.2970 - val_accuracy1000: 0.3365 - 99s/epoch - 29ms/step
Epoch 4/50
3419/3419 - 99s - loss: 3.2740 - accuracy1000: 0.3693 - val_loss: 3.3018 - val_accuracy1000: 0.3356 - 99s/epoch - 29ms/step
Epoch 5/50
3419/3419 - 98s - loss: 3.2666 - accuracy1000: 0.3760 - val_loss: 3.3025 - val_accuracy1000: 0.3344 - 98s/epoch - 29ms/step
Epoch 6/50
3419/3419 - 96s - loss: 3.2719 - accuracy1000: 0.3715 - val_loss: 3.3031 - val_accuracy1000: 0.3387 - 96s/epoch - 28ms/step
Epoch 7/50
3419/3419 - 97s - loss: 3.2697 - accuracy1000: 0.3735 - val_loss: 3.3004 - val_accuracy1000: 0.3386 - 97s/epoch - 28ms/step
Epoch 8/50
3419/3419 - 98s - loss: 3.2680 - accuracy1000: 0.3763 - val_loss: 3.3022 - val_accuracy1000: 0.3355 - 98s/epoch - 29ms/step
Epoch 9/50
3419/3419 - 104s - loss: 3.2655 - accuracy1000: 0.3794 - val_loss: 3.3053 - val_accuracy1000: 0.3325 - 104s/epoch - 30ms/step
Epoch 10/50
3419/3419 - 101s - loss: 3.2639 - accuracy1000: 0.3810 - val_loss: 3.3068 - val_accuracy1000: 0.3315 - 101s/epoch - 30ms/step
Epoch 11/50
3419/3419 - 102s - loss: 3.2620 - accuracy1000: 0.3826 - val_loss: 3.3087 - val_accuracy1000: 0.3301 - 102s/epoch - 30ms/step
Epoch 12/50
3419/3419 - 101s - loss: 3.2599 - accuracy1000: 0.3835 - val_loss: 3.3128 - val_accuracy1000: 0.3288 - 101s/epoch - 30ms/step
Epoch 13/50
3419/3419 - 97s - loss: 3.2592 - accuracy1000: 0.3860 - val_loss: 3.3109 - val_accuracy1000: 0.3314 - 97s/epoch - 28ms/step
testing model: results/AAPL/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
10303/10303 - 141s - 141s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0982784
{'0': {'precision': 0.2929328420246337, 'recall': 0.552527790062629, 'f1-score': 0.3828765756746215, 'support': 771049}, '1': {'precision': 0.4053872743566765, 'recall': 0.2951009118223773, 'f1-score': 0.3415622323522369, 'support': 1073016}, '2': {'precision': 0.30372900583893303, 'recall': 0.15388881676055255, 'f1-score': 0.204277434208765, 'support': 793339}, 'accuracy': 0.3278830243679012, 'macro avg': {'precision': 0.3340163740734144, 'recall': 0.3338391728818529, 'f1-score': 0.3095720807452078, 'support': 2637404}, 'weighted avg': {'precision': 0.34193194226391127, 'recall': 0.3278830243679012, 'f1-score': 0.3123448650585032, 'support': 2637404}}
[[426026 229995 115028]
 [591525 316648 164843]
 [436796 234457 122086]]
Evaluating performance on  train set...
3419/3419 - 43s - 43s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002792
{'0': {'precision': 0.33326387722858003, 'recall': 0.5718619933141946, 'f1-score': 0.42111478929945423, 'support': 288073}, '1': {'precision': 0.3215952416677247, 'recall': 0.28901374362520527, 'f1-score': 0.30443523421736945, 'support': 289225}, '2': {'precision': 0.3676662752038639, 'recall': 0.14925333046841427, 'f1-score': 0.2123170236645414, 'support': 297856}, 'accuracy': 0.3345514046670643, 'macro avg': {'precision': 0.34084179803338954, 'recall': 0.336709689135938, 'f1-score': 0.31262234906045505, 'support': 875154}, 'weighted avg': {'precision': 0.34111632323378344, 'recall': 0.3345514046670643, 'f1-score': 0.3114902985246094, 'support': 875154}}
[[164738  85005  38330]
 [167507  83590  38128]
 [162072  91328  44456]]
Evaluating performance on  val set...
1396/1396 - 19s - 19s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994456
{'0': {'precision': 0.33290365370317876, 'recall': 0.533214536607097, 'f1-score': 0.4098957149960321, 'support': 116726}, '1': {'precision': 0.3340618816333873, 'recall': 0.30544087896182504, 'f1-score': 0.31911091254328156, 'support': 121598}, '2': {'precision': 0.3521183932346723, 'recall': 0.1750348909552555, 'f1-score': 0.23383333239735607, 'support': 118942}, 'accuracy': 0.3364439941108306, 'macro avg': {'precision': 0.33969464285707945, 'recall': 0.3378967688413925, 'f1-score': 0.3209466533122232, 'support': 357266}, 'weighted avg': {'precision': 0.33969488978277323, 'recall': 0.3364439941108306, 'f1-score': 0.3203812850763048, 'support': 357266}}
[[62240 35705 18781]
 [64932 37141 19525]
 [59789 38334 20819]]
training model: results/AAPL/W9/deepVOL_L3/h10
Epoch 1/50
3419/3419 - 142s - loss: 3.2010 - accuracy10: 0.4146 - val_loss: 3.2632 - val_accuracy10: 0.3709 - 142s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 138s - loss: 3.1510 - accuracy10: 0.4398 - val_loss: 3.1962 - val_accuracy10: 0.4161 - 138s/epoch - 40ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.0994 - accuracy10: 0.4587 - val_loss: 3.1514 - val_accuracy10: 0.4511 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 138s - loss: 3.0690 - accuracy10: 0.4696 - val_loss: 3.1132 - val_accuracy10: 0.4637 - 138s/epoch - 40ms/step
Epoch 5/50
3419/3419 - 138s - loss: 3.0473 - accuracy10: 0.4767 - val_loss: 3.0931 - val_accuracy10: 0.4698 - 138s/epoch - 40ms/step
Epoch 6/50
3419/3419 - 138s - loss: 3.0314 - accuracy10: 0.4815 - val_loss: 3.0814 - val_accuracy10: 0.4741 - 138s/epoch - 40ms/step
Epoch 7/50
3419/3419 - 140s - loss: 3.0200 - accuracy10: 0.4855 - val_loss: 3.0712 - val_accuracy10: 0.4762 - 140s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.0113 - accuracy10: 0.4883 - val_loss: 3.0571 - val_accuracy10: 0.4807 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 135s - loss: 3.0032 - accuracy10: 0.4911 - val_loss: 3.0578 - val_accuracy10: 0.4803 - 135s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 137s - loss: 2.9960 - accuracy10: 0.4930 - val_loss: 3.0503 - val_accuracy10: 0.4829 - 137s/epoch - 40ms/step
Epoch 11/50
3419/3419 - 138s - loss: 2.9903 - accuracy10: 0.4951 - val_loss: 3.0466 - val_accuracy10: 0.4844 - 138s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 139s - loss: 2.9853 - accuracy10: 0.4966 - val_loss: 3.0433 - val_accuracy10: 0.4856 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 137s - loss: 2.9813 - accuracy10: 0.4980 - val_loss: 3.0421 - val_accuracy10: 0.4859 - 137s/epoch - 40ms/step
Epoch 14/50
3419/3419 - 136s - loss: 2.9771 - accuracy10: 0.4994 - val_loss: 3.0339 - val_accuracy10: 0.4878 - 136s/epoch - 40ms/step
Epoch 15/50
3419/3419 - 138s - loss: 2.9729 - accuracy10: 0.5004 - val_loss: 3.0322 - val_accuracy10: 0.4881 - 138s/epoch - 40ms/step
Epoch 16/50
3419/3419 - 137s - loss: 2.9698 - accuracy10: 0.5012 - val_loss: 3.0284 - val_accuracy10: 0.4902 - 137s/epoch - 40ms/step
Epoch 17/50
3419/3419 - 139s - loss: 2.9665 - accuracy10: 0.5020 - val_loss: 3.0268 - val_accuracy10: 0.4897 - 139s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 138s - loss: 2.9637 - accuracy10: 0.5031 - val_loss: 3.0243 - val_accuracy10: 0.4901 - 138s/epoch - 40ms/step
Epoch 19/50
3419/3419 - 137s - loss: 2.9610 - accuracy10: 0.5035 - val_loss: 3.0229 - val_accuracy10: 0.4906 - 137s/epoch - 40ms/step
Epoch 20/50
3419/3419 - 138s - loss: 2.9584 - accuracy10: 0.5044 - val_loss: 3.0206 - val_accuracy10: 0.4914 - 138s/epoch - 40ms/step
Epoch 21/50
3419/3419 - 137s - loss: 2.9561 - accuracy10: 0.5051 - val_loss: 3.0199 - val_accuracy10: 0.4909 - 137s/epoch - 40ms/step
Epoch 22/50
3419/3419 - 138s - loss: 2.9540 - accuracy10: 0.5053 - val_loss: 3.0196 - val_accuracy10: 0.4908 - 138s/epoch - 40ms/step
Epoch 23/50
3419/3419 - 137s - loss: 2.9517 - accuracy10: 0.5063 - val_loss: 3.0158 - val_accuracy10: 0.4921 - 137s/epoch - 40ms/step
Epoch 24/50
3419/3419 - 138s - loss: 2.9498 - accuracy10: 0.5067 - val_loss: 3.0188 - val_accuracy10: 0.4915 - 138s/epoch - 40ms/step
Epoch 25/50
3419/3419 - 136s - loss: 2.9483 - accuracy10: 0.5073 - val_loss: 3.0155 - val_accuracy10: 0.4922 - 136s/epoch - 40ms/step
Epoch 26/50
3419/3419 - 137s - loss: 2.9458 - accuracy10: 0.5080 - val_loss: 3.0141 - val_accuracy10: 0.4925 - 137s/epoch - 40ms/step
Epoch 27/50
3419/3419 - 139s - loss: 2.9443 - accuracy10: 0.5081 - val_loss: 3.0114 - val_accuracy10: 0.4922 - 139s/epoch - 41ms/step
Epoch 28/50
3419/3419 - 141s - loss: 2.9422 - accuracy10: 0.5086 - val_loss: 3.0129 - val_accuracy10: 0.4917 - 141s/epoch - 41ms/step
Epoch 29/50
3419/3419 - 138s - loss: 2.9408 - accuracy10: 0.5095 - val_loss: 3.0154 - val_accuracy10: 0.4918 - 138s/epoch - 40ms/step
Epoch 30/50
3419/3419 - 141s - loss: 2.9389 - accuracy10: 0.5098 - val_loss: 3.0110 - val_accuracy10: 0.4936 - 141s/epoch - 41ms/step
Epoch 31/50
3419/3419 - 145s - loss: 2.9374 - accuracy10: 0.5101 - val_loss: 3.0100 - val_accuracy10: 0.4938 - 145s/epoch - 42ms/step
Epoch 32/50
3419/3419 - 141s - loss: 2.9357 - accuracy10: 0.5110 - val_loss: 3.0122 - val_accuracy10: 0.4921 - 141s/epoch - 41ms/step
Epoch 33/50
3419/3419 - 142s - loss: 2.9346 - accuracy10: 0.5109 - val_loss: 3.0112 - val_accuracy10: 0.4931 - 142s/epoch - 41ms/step
Epoch 34/50
3419/3419 - 141s - loss: 2.9321 - accuracy10: 0.5117 - val_loss: 3.0081 - val_accuracy10: 0.4939 - 141s/epoch - 41ms/step
Epoch 35/50
3419/3419 - 139s - loss: 2.9308 - accuracy10: 0.5120 - val_loss: 3.0091 - val_accuracy10: 0.4929 - 139s/epoch - 41ms/step
Epoch 36/50
3419/3419 - 135s - loss: 2.9289 - accuracy10: 0.5123 - val_loss: 3.0101 - val_accuracy10: 0.4930 - 135s/epoch - 39ms/step
Epoch 37/50
3419/3419 - 146s - loss: 2.9275 - accuracy10: 0.5129 - val_loss: 3.0088 - val_accuracy10: 0.4933 - 146s/epoch - 43ms/step
Epoch 38/50
3419/3419 - 147s - loss: 2.9265 - accuracy10: 0.5131 - val_loss: 3.0084 - val_accuracy10: 0.4927 - 147s/epoch - 43ms/step
Epoch 39/50
3419/3419 - 148s - loss: 2.9243 - accuracy10: 0.5138 - val_loss: 3.0098 - val_accuracy10: 0.4935 - 148s/epoch - 43ms/step
Epoch 40/50
3419/3419 - 137s - loss: 2.9233 - accuracy10: 0.5141 - val_loss: 3.0150 - val_accuracy10: 0.4916 - 137s/epoch - 40ms/step
Epoch 41/50
3419/3419 - 140s - loss: 2.9215 - accuracy10: 0.5149 - val_loss: 3.0107 - val_accuracy10: 0.4932 - 140s/epoch - 41ms/step
Epoch 42/50
3419/3419 - 137s - loss: 2.9200 - accuracy10: 0.5148 - val_loss: 3.0106 - val_accuracy10: 0.4933 - 137s/epoch - 40ms/step
Epoch 43/50
3419/3419 - 140s - loss: 2.9187 - accuracy10: 0.5155 - val_loss: 3.0064 - val_accuracy10: 0.4941 - 140s/epoch - 41ms/step
Epoch 44/50
3419/3419 - 140s - loss: 2.9170 - accuracy10: 0.5159 - val_loss: 3.0091 - val_accuracy10: 0.4931 - 140s/epoch - 41ms/step
Epoch 45/50
3419/3419 - 141s - loss: 2.9153 - accuracy10: 0.5164 - val_loss: 3.0087 - val_accuracy10: 0.4933 - 141s/epoch - 41ms/step
Epoch 46/50
3419/3419 - 137s - loss: 2.9137 - accuracy10: 0.5171 - val_loss: 3.0078 - val_accuracy10: 0.4932 - 137s/epoch - 40ms/step
Epoch 47/50
3419/3419 - 136s - loss: 2.9122 - accuracy10: 0.5177 - val_loss: 3.0099 - val_accuracy10: 0.4929 - 136s/epoch - 40ms/step
Epoch 48/50
3419/3419 - 137s - loss: 2.9112 - accuracy10: 0.5175 - val_loss: 3.0112 - val_accuracy10: 0.4926 - 137s/epoch - 40ms/step
Epoch 49/50
3419/3419 - 146s - loss: 2.9099 - accuracy10: 0.5179 - val_loss: 3.0085 - val_accuracy10: 0.4935 - 146s/epoch - 43ms/step
Epoch 50/50
3419/3419 - 137s - loss: 2.9080 - accuracy10: 0.5186 - val_loss: 3.0123 - val_accuracy10: 0.4920 - 137s/epoch - 40ms/step
testing model: results/AAPL/W9/deepVOL_L3/h10
Evaluating performance on  test set...
10303/10303 - 222s - 222s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0035815
{'0': {'precision': 0.4762635935643341, 'recall': 0.46212252969714807, 'f1-score': 0.4690865118415132, 'support': 822217}, '1': {'precision': 0.4996179552086104, 'recall': 0.5080947296117164, 'f1-score': 0.5038206895373935, 'support': 987062}, '2': {'precision': 0.47768640724774497, 'recall': 0.48210837735849055, 'f1-score': 0.47988720584452577, 'support': 828125}, 'accuracy': 0.4856032674554221, 'macro avg': {'precision': 0.48452265200689654, 'recall': 0.484108545555785, 'f1-score': 0.48426480240781083, 'support': 2637404}, 'weighted avg': {'precision': 0.48545083620706053, 'recall': 0.4856032674554221, 'f1-score': 0.48547729293765757, 'support': 2637404}}
[[379965 254383 187869]
 [236865 501521 248676]
 [180974 247905 399246]]
Evaluating performance on  train set...
3419/3419 - 76s - 76s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99250627
{'0': {'precision': 0.49504671405429085, 'recall': 0.5014706944774132, 'f1-score': 0.49823799839351934, 'support': 290679}, '1': {'precision': 0.512373786640065, 'recall': 0.48244130348886377, 'f1-score': 0.496957233465612, 'support': 288518}, '2': {'precision': 0.49753753559409786, 'recall': 0.5195315535702821, 'f1-score': 0.5082967353557125, 'support': 295957}, 'accuracy': 0.501304913192421, 'macro avg': {'precision': 0.5016526787628179, 'recall': 0.5011478505121864, 'f1-score': 0.5011639890716145, 'support': 875154}, 'weighted avg': {'precision': 0.5016013871732609, 'recall': 0.501304913192421, 'f1-score': 0.5012173938823702, 'support': 875154}}
[[145767  66773  78139]
 [ 72183 139193  77142]
 [ 76501  65697 153759]]
Evaluating performance on  val set...
1396/1396 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0018842
{'0': {'precision': 0.48045240699269137, 'recall': 0.4762031763511537, 'f1-score': 0.4783183546491532, 'support': 116234}, '1': {'precision': 0.5207685077142487, 'recall': 0.507217552582771, 'f1-score': 0.5139037155205847, 'support': 126705}, '2': {'precision': 0.4783737315848026, 'recall': 0.4964706499776956, 'f1-score': 0.48725421604522295, 'support': 114327}, 'accuracy': 0.49368817631680595, 'macro avg': {'precision': 0.4931982154305809, 'recall': 0.49329712630387346, 'f1-score': 0.4931587620716536, 'support': 357266}, 'weighted avg': {'precision': 0.49408539423067993, 'recall': 0.49368817631680595, 'f1-score': 0.493798286618731, 'support': 357266}}
[[55351 30772 30111]
 [30657 64267 31781]
 [29198 28369 56760]]
training model: results/AAPL/W9/deepVOL_L3/h20
Epoch 1/50
3419/3419 - 143s - loss: 3.2329 - accuracy20: 0.4011 - val_loss: 3.2678 - val_accuracy20: 0.3699 - 143s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.1877 - accuracy20: 0.4250 - val_loss: 3.2351 - val_accuracy20: 0.3910 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 140s - loss: 3.1698 - accuracy20: 0.4323 - val_loss: 3.2218 - val_accuracy20: 0.3978 - 140s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 142s - loss: 3.1590 - accuracy20: 0.4382 - val_loss: 3.2251 - val_accuracy20: 0.3956 - 142s/epoch - 42ms/step
Epoch 5/50
3419/3419 - 150s - loss: 3.1506 - accuracy20: 0.4414 - val_loss: 3.1987 - val_accuracy20: 0.4169 - 150s/epoch - 44ms/step
Epoch 6/50
3419/3419 - 141s - loss: 3.1406 - accuracy20: 0.4465 - val_loss: 3.1946 - val_accuracy20: 0.4203 - 141s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 142s - loss: 3.1330 - accuracy20: 0.4489 - val_loss: 3.1841 - val_accuracy20: 0.4292 - 142s/epoch - 42ms/step
Epoch 8/50
3419/3419 - 137s - loss: 3.1250 - accuracy20: 0.4519 - val_loss: 3.1738 - val_accuracy20: 0.4367 - 137s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 135s - loss: 3.1188 - accuracy20: 0.4543 - val_loss: 3.1613 - val_accuracy20: 0.4394 - 135s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 138s - loss: 3.1118 - accuracy20: 0.4568 - val_loss: 3.1572 - val_accuracy20: 0.4431 - 138s/epoch - 40ms/step
Epoch 11/50
3419/3419 - 142s - loss: 3.1064 - accuracy20: 0.4591 - val_loss: 3.1534 - val_accuracy20: 0.4455 - 142s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 139s - loss: 3.1024 - accuracy20: 0.4605 - val_loss: 3.1498 - val_accuracy20: 0.4475 - 139s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 140s - loss: 3.0982 - accuracy20: 0.4612 - val_loss: 3.1479 - val_accuracy20: 0.4481 - 140s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 138s - loss: 3.0957 - accuracy20: 0.4626 - val_loss: 3.1464 - val_accuracy20: 0.4479 - 138s/epoch - 40ms/step
Epoch 15/50
3419/3419 - 142s - loss: 3.0928 - accuracy20: 0.4634 - val_loss: 3.1448 - val_accuracy20: 0.4488 - 142s/epoch - 42ms/step
Epoch 16/50
3419/3419 - 138s - loss: 3.0904 - accuracy20: 0.4642 - val_loss: 3.1406 - val_accuracy20: 0.4498 - 138s/epoch - 40ms/step
Epoch 17/50
3419/3419 - 138s - loss: 3.0881 - accuracy20: 0.4646 - val_loss: 3.1401 - val_accuracy20: 0.4511 - 138s/epoch - 40ms/step
Epoch 18/50
3419/3419 - 139s - loss: 3.0861 - accuracy20: 0.4658 - val_loss: 3.1351 - val_accuracy20: 0.4518 - 139s/epoch - 41ms/step
Epoch 19/50
3419/3419 - 139s - loss: 3.0843 - accuracy20: 0.4662 - val_loss: 3.1361 - val_accuracy20: 0.4520 - 139s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 139s - loss: 3.0827 - accuracy20: 0.4665 - val_loss: 3.1323 - val_accuracy20: 0.4533 - 139s/epoch - 41ms/step
Epoch 21/50
3419/3419 - 140s - loss: 3.0807 - accuracy20: 0.4676 - val_loss: 3.1320 - val_accuracy20: 0.4526 - 140s/epoch - 41ms/step
Epoch 22/50
3419/3419 - 141s - loss: 3.0792 - accuracy20: 0.4681 - val_loss: 3.1324 - val_accuracy20: 0.4532 - 141s/epoch - 41ms/step
Epoch 23/50
3419/3419 - 140s - loss: 3.0771 - accuracy20: 0.4688 - val_loss: 3.1331 - val_accuracy20: 0.4528 - 140s/epoch - 41ms/step
Epoch 24/50
3419/3419 - 140s - loss: 3.0755 - accuracy20: 0.4690 - val_loss: 3.1310 - val_accuracy20: 0.4532 - 140s/epoch - 41ms/step
Epoch 25/50
3419/3419 - 140s - loss: 3.0744 - accuracy20: 0.4697 - val_loss: 3.1303 - val_accuracy20: 0.4532 - 140s/epoch - 41ms/step
Epoch 26/50
3419/3419 - 141s - loss: 3.0725 - accuracy20: 0.4704 - val_loss: 3.1300 - val_accuracy20: 0.4544 - 141s/epoch - 41ms/step
Epoch 27/50
3419/3419 - 139s - loss: 3.0710 - accuracy20: 0.4707 - val_loss: 3.1293 - val_accuracy20: 0.4540 - 139s/epoch - 41ms/step
Epoch 28/50
3419/3419 - 141s - loss: 3.0694 - accuracy20: 0.4715 - val_loss: 3.1293 - val_accuracy20: 0.4541 - 141s/epoch - 41ms/step
Epoch 29/50
3419/3419 - 142s - loss: 3.0678 - accuracy20: 0.4716 - val_loss: 3.1293 - val_accuracy20: 0.4544 - 142s/epoch - 41ms/step
Epoch 30/50
3419/3419 - 140s - loss: 3.0665 - accuracy20: 0.4722 - val_loss: 3.1288 - val_accuracy20: 0.4536 - 140s/epoch - 41ms/step
Epoch 31/50
3419/3419 - 141s - loss: 3.0652 - accuracy20: 0.4728 - val_loss: 3.1282 - val_accuracy20: 0.4535 - 141s/epoch - 41ms/step
Epoch 32/50
3419/3419 - 140s - loss: 3.0635 - accuracy20: 0.4733 - val_loss: 3.1282 - val_accuracy20: 0.4542 - 140s/epoch - 41ms/step
Epoch 33/50
3419/3419 - 142s - loss: 3.0623 - accuracy20: 0.4738 - val_loss: 3.1251 - val_accuracy20: 0.4550 - 142s/epoch - 41ms/step
Epoch 34/50
3419/3419 - 143s - loss: 3.0616 - accuracy20: 0.4740 - val_loss: 3.1274 - val_accuracy20: 0.4544 - 143s/epoch - 42ms/step
Epoch 35/50
3419/3419 - 144s - loss: 3.0597 - accuracy20: 0.4747 - val_loss: 3.1298 - val_accuracy20: 0.4540 - 144s/epoch - 42ms/step
Epoch 36/50
3419/3419 - 144s - loss: 3.0580 - accuracy20: 0.4755 - val_loss: 3.1286 - val_accuracy20: 0.4541 - 144s/epoch - 42ms/step
Epoch 37/50
3419/3419 - 141s - loss: 3.0567 - accuracy20: 0.4754 - val_loss: 3.1282 - val_accuracy20: 0.4541 - 141s/epoch - 41ms/step
Epoch 38/50
3419/3419 - 139s - loss: 3.0552 - accuracy20: 0.4761 - val_loss: 3.1272 - val_accuracy20: 0.4550 - 139s/epoch - 41ms/step
Epoch 39/50
3419/3419 - 140s - loss: 3.0535 - accuracy20: 0.4770 - val_loss: 3.1249 - val_accuracy20: 0.4549 - 140s/epoch - 41ms/step
Epoch 40/50
3419/3419 - 139s - loss: 3.0525 - accuracy20: 0.4770 - val_loss: 3.1274 - val_accuracy20: 0.4538 - 139s/epoch - 41ms/step
Epoch 41/50
3419/3419 - 141s - loss: 3.0509 - accuracy20: 0.4778 - val_loss: 3.1269 - val_accuracy20: 0.4541 - 141s/epoch - 41ms/step
Epoch 42/50
3419/3419 - 140s - loss: 3.0501 - accuracy20: 0.4780 - val_loss: 3.1254 - val_accuracy20: 0.4550 - 140s/epoch - 41ms/step
Epoch 43/50
3419/3419 - 141s - loss: 3.0486 - accuracy20: 0.4787 - val_loss: 3.1260 - val_accuracy20: 0.4547 - 141s/epoch - 41ms/step
Epoch 44/50
3419/3419 - 141s - loss: 3.0468 - accuracy20: 0.4791 - val_loss: 3.1300 - val_accuracy20: 0.4539 - 141s/epoch - 41ms/step
Epoch 45/50
3419/3419 - 141s - loss: 3.0458 - accuracy20: 0.4796 - val_loss: 3.1296 - val_accuracy20: 0.4529 - 141s/epoch - 41ms/step
Epoch 46/50
3419/3419 - 141s - loss: 3.0442 - accuracy20: 0.4798 - val_loss: 3.1269 - val_accuracy20: 0.4540 - 141s/epoch - 41ms/step
Epoch 47/50
3419/3419 - 139s - loss: 3.0427 - accuracy20: 0.4802 - val_loss: 3.1283 - val_accuracy20: 0.4536 - 139s/epoch - 41ms/step
Epoch 48/50
3419/3419 - 140s - loss: 3.0416 - accuracy20: 0.4808 - val_loss: 3.1289 - val_accuracy20: 0.4536 - 140s/epoch - 41ms/step
Epoch 49/50
3419/3419 - 138s - loss: 3.0401 - accuracy20: 0.4812 - val_loss: 3.1272 - val_accuracy20: 0.4538 - 138s/epoch - 40ms/step
testing model: results/AAPL/W9/deepVOL_L3/h20
Evaluating performance on  test set...
10303/10303 - 192s - 192s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0420943
{'0': {'precision': 0.4504749602912183, 'recall': 0.43587112391627525, 'f1-score': 0.44305273241847487, 'support': 836121}, '1': {'precision': 0.4318217151662767, 'recall': 0.4620656174734406, 'f1-score': 0.4464320282233302, 'support': 955782}, '2': {'precision': 0.45585515585863123, 'recall': 0.4343779605228143, 'f1-score': 0.4448574856450014, 'support': 845501}, 'accuracy': 0.44488519771714913, 'macro avg': {'precision': 0.44605061043870875, 'recall': 0.44410490063751, 'f1-score': 0.4447807487622688, 'support': 2637404}, 'weighted avg': {'precision': 0.44543990491116886, 'recall': 0.44488519771714913, 'f1-score': 0.44485594146825935, 'support': 2637404}}
[[364441 288508 183172]
 [258921 441634 255227]
 [185653 292581 367267]]
Evaluating performance on  train set...
3419/3419 - 63s - 63s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0362448
{'0': {'precision': 0.4662441595618037, 'recall': 0.4677763433139796, 'f1-score': 0.46700899472722884, 'support': 289694}, '1': {'precision': 0.4411665138585232, 'recall': 0.43433400106234876, 'f1-score': 0.4377235965788521, 'support': 288041}, '2': {'precision': 0.47372128881327097, 'recall': 0.4793103332335863, 'f1-score': 0.4764994225758632, 'support': 297419}, 'accuracy': 0.4606892044143088, 'macro avg': {'precision': 0.4603773207445326, 'recall': 0.4604735592033049, 'f1-score': 0.46041067129398144, 'support': 875154}, 'weighted avg': {'precision': 0.46053139376152574, 'recall': 0.4606892044143088, 'f1-score': 0.46059553857237656, 'support': 875154}}
[[135512  78028  76154]
 [ 80717 125106  82218]
 [ 74417  80446 142556]]
Evaluating performance on  val set...
1396/1396 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0417656
{'0': {'precision': 0.4607611840640997, 'recall': 0.4372196362346143, 'f1-score': 0.4486818264570997, 'support': 118373}, '1': {'precision': 0.44485350750177144, 'recall': 0.4711285125820792, 'f1-score': 0.4576141599090444, 'support': 122595}, '2': {'precision': 0.4590678076538812, 'recall': 0.45435863041496843, 'f1-score': 0.45670107993414083, 'support': 116298}, 'accuracy': 0.4544345109806139, 'macro avg': {'precision': 0.45489416640658414, 'recall': 0.45423559307722067, 'f1-score': 0.45433235543342837, 'support': 357266}, 'weighted avg': {'precision': 0.4547512701682511, 'recall': 0.4544345109806139, 'f1-score': 0.45435738069515785, 'support': 357266}}
[[51755 36761 29857]
 [32430 57758 32407]
 [28140 35317 52841]]
training model: results/AAPL/W9/deepVOL_L3/h30
Epoch 1/50
3419/3419 - 144s - loss: 3.2444 - accuracy30: 0.3975 - val_loss: 3.2582 - val_accuracy30: 0.3711 - 144s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 141s - loss: 3.2089 - accuracy30: 0.4144 - val_loss: 3.2451 - val_accuracy30: 0.3767 - 141s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.1961 - accuracy30: 0.4209 - val_loss: 3.2490 - val_accuracy30: 0.3739 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.1928 - accuracy30: 0.4231 - val_loss: 3.2481 - val_accuracy30: 0.3816 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 143s - loss: 3.1827 - accuracy30: 0.4287 - val_loss: 3.2363 - val_accuracy30: 0.3831 - 143s/epoch - 42ms/step
Epoch 6/50
3419/3419 - 141s - loss: 3.1740 - accuracy30: 0.4325 - val_loss: 3.2281 - val_accuracy30: 0.3909 - 141s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 140s - loss: 3.1678 - accuracy30: 0.4357 - val_loss: 3.2248 - val_accuracy30: 0.3917 - 140s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 140s - loss: 3.1621 - accuracy30: 0.4376 - val_loss: 3.2225 - val_accuracy30: 0.3953 - 140s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 142s - loss: 3.1575 - accuracy30: 0.4400 - val_loss: 3.2187 - val_accuracy30: 0.3960 - 142s/epoch - 42ms/step
Epoch 10/50
3419/3419 - 139s - loss: 3.1536 - accuracy30: 0.4414 - val_loss: 3.2185 - val_accuracy30: 0.3956 - 139s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 138s - loss: 3.1503 - accuracy30: 0.4426 - val_loss: 3.2148 - val_accuracy30: 0.3987 - 138s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 142s - loss: 3.1471 - accuracy30: 0.4439 - val_loss: 3.2096 - val_accuracy30: 0.4038 - 142s/epoch - 42ms/step
Epoch 13/50
3419/3419 - 142s - loss: 3.1447 - accuracy30: 0.4452 - val_loss: 3.2043 - val_accuracy30: 0.4071 - 142s/epoch - 42ms/step
Epoch 14/50
3419/3419 - 141s - loss: 3.1416 - accuracy30: 0.4460 - val_loss: 3.2022 - val_accuracy30: 0.4080 - 141s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 140s - loss: 3.1393 - accuracy30: 0.4469 - val_loss: 3.2000 - val_accuracy30: 0.4104 - 140s/epoch - 41ms/step
Epoch 16/50
3419/3419 - 144s - loss: 3.1375 - accuracy30: 0.4478 - val_loss: 3.2001 - val_accuracy30: 0.4109 - 144s/epoch - 42ms/step
Epoch 17/50
3419/3419 - 140s - loss: 3.1351 - accuracy30: 0.4484 - val_loss: 3.1970 - val_accuracy30: 0.4117 - 140s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 144s - loss: 3.1333 - accuracy30: 0.4492 - val_loss: 3.1954 - val_accuracy30: 0.4140 - 144s/epoch - 42ms/step
Epoch 19/50
3419/3419 - 139s - loss: 3.1315 - accuracy30: 0.4497 - val_loss: 3.1926 - val_accuracy30: 0.4172 - 139s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 143s - loss: 3.1294 - accuracy30: 0.4501 - val_loss: 3.1960 - val_accuracy30: 0.4147 - 143s/epoch - 42ms/step
Epoch 21/50
3419/3419 - 138s - loss: 3.1274 - accuracy30: 0.4510 - val_loss: 3.1918 - val_accuracy30: 0.4180 - 138s/epoch - 40ms/step
Epoch 22/50
3419/3419 - 143s - loss: 3.1259 - accuracy30: 0.4517 - val_loss: 3.1904 - val_accuracy30: 0.4200 - 143s/epoch - 42ms/step
Epoch 23/50
3419/3419 - 139s - loss: 3.1242 - accuracy30: 0.4516 - val_loss: 3.1899 - val_accuracy30: 0.4205 - 139s/epoch - 41ms/step
Epoch 24/50
3419/3419 - 143s - loss: 3.1229 - accuracy30: 0.4526 - val_loss: 3.1905 - val_accuracy30: 0.4203 - 143s/epoch - 42ms/step
Epoch 25/50
3419/3419 - 139s - loss: 3.1213 - accuracy30: 0.4529 - val_loss: 3.1887 - val_accuracy30: 0.4203 - 139s/epoch - 41ms/step
Epoch 26/50
3419/3419 - 142s - loss: 3.1196 - accuracy30: 0.4542 - val_loss: 3.1870 - val_accuracy30: 0.4232 - 142s/epoch - 42ms/step
Epoch 27/50
3419/3419 - 140s - loss: 3.1184 - accuracy30: 0.4538 - val_loss: 3.1900 - val_accuracy30: 0.4204 - 140s/epoch - 41ms/step
Epoch 28/50
3419/3419 - 143s - loss: 3.1171 - accuracy30: 0.4550 - val_loss: 3.1870 - val_accuracy30: 0.4216 - 143s/epoch - 42ms/step
Epoch 29/50
3419/3419 - 138s - loss: 3.1155 - accuracy30: 0.4553 - val_loss: 3.1881 - val_accuracy30: 0.4227 - 138s/epoch - 40ms/step
Epoch 30/50
3419/3419 - 145s - loss: 3.1141 - accuracy30: 0.4557 - val_loss: 3.1870 - val_accuracy30: 0.4238 - 145s/epoch - 42ms/step
Epoch 31/50
3419/3419 - 148s - loss: 3.1123 - accuracy30: 0.4562 - val_loss: 3.1885 - val_accuracy30: 0.4226 - 148s/epoch - 43ms/step
Epoch 32/50
3419/3419 - 144s - loss: 3.1111 - accuracy30: 0.4564 - val_loss: 3.1837 - val_accuracy30: 0.4252 - 144s/epoch - 42ms/step
Epoch 33/50
3419/3419 - 143s - loss: 3.1102 - accuracy30: 0.4567 - val_loss: 3.1877 - val_accuracy30: 0.4243 - 143s/epoch - 42ms/step
Epoch 34/50
3419/3419 - 141s - loss: 3.1090 - accuracy30: 0.4573 - val_loss: 3.1890 - val_accuracy30: 0.4236 - 141s/epoch - 41ms/step
Epoch 35/50
3419/3419 - 144s - loss: 3.1079 - accuracy30: 0.4575 - val_loss: 3.1890 - val_accuracy30: 0.4234 - 144s/epoch - 42ms/step
Epoch 36/50
3419/3419 - 143s - loss: 3.1057 - accuracy30: 0.4585 - val_loss: 3.1896 - val_accuracy30: 0.4233 - 143s/epoch - 42ms/step
Epoch 37/50
3419/3419 - 139s - loss: 3.1044 - accuracy30: 0.4591 - val_loss: 3.1895 - val_accuracy30: 0.4224 - 139s/epoch - 41ms/step
Epoch 38/50
3419/3419 - 146s - loss: 3.1032 - accuracy30: 0.4590 - val_loss: 3.1900 - val_accuracy30: 0.4234 - 146s/epoch - 43ms/step
Epoch 39/50
3419/3419 - 144s - loss: 3.1017 - accuracy30: 0.4597 - val_loss: 3.1916 - val_accuracy30: 0.4225 - 144s/epoch - 42ms/step
Epoch 40/50
3419/3419 - 141s - loss: 3.1004 - accuracy30: 0.4601 - val_loss: 3.1910 - val_accuracy30: 0.4236 - 141s/epoch - 41ms/step
Epoch 41/50
3419/3419 - 145s - loss: 3.0993 - accuracy30: 0.4608 - val_loss: 3.1900 - val_accuracy30: 0.4241 - 145s/epoch - 42ms/step
Epoch 42/50
3419/3419 - 145s - loss: 3.0968 - accuracy30: 0.4617 - val_loss: 3.1949 - val_accuracy30: 0.4213 - 145s/epoch - 42ms/step
testing model: results/AAPL/W9/deepVOL_L3/h30
Evaluating performance on  test set...
10303/10303 - 191s - 191s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0636567
{'0': {'precision': 0.46152356511137604, 'recall': 0.3197614794712974, 'f1-score': 0.377781346293939, 'support': 857117}, '1': {'precision': 0.37621121444291483, 'recall': 0.5759626092346852, 'f1-score': 0.4551345296533978, 'support': 911455}, '2': {'precision': 0.4599290610540867, 'recall': 0.34311466428492504, 'f1-score': 0.3930256856482718, 'support': 868832}, 'accuracy': 0.4159946674836316, 'macro avg': {'precision': 0.43255461353612584, 'recall': 0.41294625099696924, 'f1-score': 0.40864718719853615, 'support': 2637404}, 'weighted avg': {'precision': 0.4315153734472908, 'recall': 0.4159946674836316, 'f1-score': 0.4095355696092897, 'support': 2637404}}
[[274073 434478 148566]
 [185003 524964 201488]
 [134768 435955 298109]]
Evaluating performance on  train set...
3419/3419 - 65s - 65s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0568771
{'0': {'precision': 0.46596688388548535, 'recall': 0.37273698375483816, 'f1-score': 0.4141702394142299, 'support': 288332}, '1': {'precision': 0.3893630856458457, 'recall': 0.5246874242371766, 'f1-score': 0.44700793291325436, 'support': 288730}, '2': {'precision': 0.47034435779385514, 'recall': 0.4030332917354374, 'f1-score': 0.43409499859084705, 'support': 298092}, 'accuracy': 0.433187758954424, 'macro avg': {'precision': 0.4418914424417287, 'recall': 0.4334858999091507, 'f1-score': 0.4317577236394438, 'support': 875154}, 'weighted avg': {'precision': 0.44218486984745614, 'recall': 0.433187758954424, 'f1-score': 0.4317907251304004, 'support': 875154}}
[[107472 117844  63016]
 [ 64962 151493  72275]
 [ 58209 119742 120141]]
Evaluating performance on  val set...
1396/1396 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.06145
{'0': {'precision': 0.4615212852661077, 'recall': 0.3484616033043918, 'f1-score': 0.39710085062848527, 'support': 118630}, '1': {'precision': 0.39028154710334106, 'recall': 0.5602078717849466, 'f1-score': 0.46005518957890895, 'support': 121421}, '2': {'precision': 0.4569746279841559, 'recall': 0.3641684084801433, 'f1-score': 0.4053270029673591, 'support': 117215}, 'accuracy': 0.4255792602710585, 'macro avg': {'precision': 0.43625915345120153, 'recall': 0.42427929452316054, 'f1-score': 0.42082768105825114, 'support': 357266}, 'weighted avg': {'precision': 0.4358179250785576, 'recall': 0.4255792602710585, 'f1-score': 0.4211955230465169, 'support': 357266}}
[[41338 54029 23263]
 [25939 68021 27461]
 [22292 52237 42686]]
training model: results/AAPL/W9/deepVOL_L3/h50
Epoch 1/50
3419/3419 - 147s - loss: 3.2115 - accuracy50: 0.4200 - val_loss: 3.2864 - val_accuracy50: 0.3571 - 147s/epoch - 43ms/step
Epoch 2/50
3419/3419 - 148s - loss: 3.2004 - accuracy50: 0.4245 - val_loss: 3.2988 - val_accuracy50: 0.3554 - 148s/epoch - 43ms/step
Epoch 3/50
3419/3419 - 143s - loss: 3.1901 - accuracy50: 0.4291 - val_loss: 3.2624 - val_accuracy50: 0.3683 - 143s/epoch - 42ms/step
Epoch 4/50
3419/3419 - 153s - loss: 3.1837 - accuracy50: 0.4327 - val_loss: 3.2688 - val_accuracy50: 0.3652 - 153s/epoch - 45ms/step
Epoch 5/50
3419/3419 - 141s - loss: 3.1803 - accuracy50: 0.4342 - val_loss: 3.2790 - val_accuracy50: 0.3606 - 141s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 143s - loss: 3.1755 - accuracy50: 0.4360 - val_loss: 3.2802 - val_accuracy50: 0.3638 - 143s/epoch - 42ms/step
Epoch 7/50
3419/3419 - 145s - loss: 3.1691 - accuracy50: 0.4387 - val_loss: 3.2777 - val_accuracy50: 0.3640 - 145s/epoch - 42ms/step
Epoch 8/50
3419/3419 - 144s - loss: 3.1633 - accuracy50: 0.4408 - val_loss: 3.2752 - val_accuracy50: 0.3656 - 144s/epoch - 42ms/step
Epoch 9/50
3419/3419 - 140s - loss: 3.1564 - accuracy50: 0.4443 - val_loss: 3.2682 - val_accuracy50: 0.3668 - 140s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 143s - loss: 3.1499 - accuracy50: 0.4467 - val_loss: 3.2721 - val_accuracy50: 0.3671 - 143s/epoch - 42ms/step
Epoch 11/50
3419/3419 - 141s - loss: 3.1449 - accuracy50: 0.4496 - val_loss: 3.2756 - val_accuracy50: 0.3676 - 141s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 144s - loss: 3.1411 - accuracy50: 0.4510 - val_loss: 3.2711 - val_accuracy50: 0.3701 - 144s/epoch - 42ms/step
Epoch 13/50
3419/3419 - 139s - loss: 3.1367 - accuracy50: 0.4523 - val_loss: 3.2757 - val_accuracy50: 0.3701 - 139s/epoch - 41ms/step
testing model: results/AAPL/W9/deepVOL_L3/h50
Evaluating performance on  test set...
10303/10303 - 191s - 191s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0823363
{'0': {'precision': 0.4082871591655243, 'recall': 0.17539223618544278, 'f1-score': 0.24537579507593787, 'support': 808314}, '1': {'precision': 0.3821717855791876, 'recall': 0.777669407270712, 'f1-score': 0.5124896542718653, 'support': 1006834}, '2': {'precision': 0.4184586959853848, 'recall': 0.1228486018952735, 'f1-score': 0.18993671784583072, 'support': 822256}, 'accuracy': 0.3889313127605782, 'macro avg': {'precision': 0.40297254691003226, 'recall': 0.35863674845047605, 'f1-score': 0.3159340557312113, 'support': 2637404}, 'weighted avg': {'precision': 0.40148871688285753, 'recall': 0.3889313127605782, 'f1-score': 0.33006293493875505, 'support': 2637404}}
[[141772 615447  51095]
 [134565 782984  89285]
 [ 70899 650344 101013]]
Evaluating performance on  train set...
3419/3419 - 64s - 64s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0936913
{'0': {'precision': 0.44327833318587984, 'recall': 0.1400171864520456, 'f1-score': 0.21281351540764967, 'support': 286272}, '1': {'precision': 0.33097777188613203, 'recall': 0.8096266424729978, 'f1-score': 0.46987091898276745, 'support': 289883}, '2': {'precision': 0.46246099328291107, 'recall': 0.11697363536332897, 'f1-score': 0.18671905655491994, 'support': 298999}, 'accuracy': 0.35394342024375136, 'macro avg': {'precision': 0.4122390327849743, 'recall': 0.3555391547627908, 'f1-score': 0.2898011636484457, 'support': 875154}, 'weighted avg': {'precision': 0.41263409522901445, 'recall': 0.35394342024375136, 'f1-score': 0.2890450749023884, 'support': 875154}}
[[ 40083 229572  16617]
 [ 31150 234697  24036]
 [ 19191 244833  34975]]
Evaluating performance on  val set...
1396/1396 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0875406
{'0': {'precision': 0.442857914057439, 'recall': 0.14134948394989402, 'f1-score': 0.21429970872898732, 'support': 116074}, '1': {'precision': 0.3513813589141805, 'recall': 0.818415461858574, 'f1-score': 0.4916681803841336, 'support': 125677}, '2': {'precision': 0.44430706571148043, 'recall': 0.10576981344414145, 'f1-score': 0.17086439089879313, 'support': 115515}, 'accuracy': 0.36801990673615737, 'macro avg': {'precision': 0.41284877956103333, 'recall': 0.35517825308420314, 'f1-score': 0.292277426670638, 'support': 357266}, 'weighted avg': {'precision': 0.4111473671052446, 'recall': 0.36801990673615737, 'f1-score': 0.2978268472561602, 'support': 357266}}
[[ 16407  93800   5867]
 [ 13407 102856   9414]
 [  7234  96063  12218]]
training model: results/AAPL/W9/deepVOL_L3/h100
Epoch 1/50
3419/3419 - 145s - loss: 3.2671 - accuracy100: 0.3828 - val_loss: 3.3065 - val_accuracy100: 0.3398 - 145s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 142s - loss: 3.2509 - accuracy100: 0.3939 - val_loss: 3.2911 - val_accuracy100: 0.3481 - 142s/epoch - 42ms/step
Epoch 3/50
3419/3419 - 141s - loss: 3.2532 - accuracy100: 0.3930 - val_loss: 3.2900 - val_accuracy100: 0.3487 - 141s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 142s - loss: 3.2499 - accuracy100: 0.3943 - val_loss: 3.2799 - val_accuracy100: 0.3601 - 142s/epoch - 42ms/step
Epoch 5/50
3419/3419 - 138s - loss: 3.2506 - accuracy100: 0.3931 - val_loss: 3.2740 - val_accuracy100: 0.3649 - 138s/epoch - 40ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.2438 - accuracy100: 0.3978 - val_loss: 3.2772 - val_accuracy100: 0.3619 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.2381 - accuracy100: 0.4019 - val_loss: 3.3156 - val_accuracy100: 0.3503 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 138s - loss: 3.2357 - accuracy100: 0.4027 - val_loss: 3.2878 - val_accuracy100: 0.3568 - 138s/epoch - 40ms/step
Epoch 9/50
3419/3419 - 141s - loss: 3.2327 - accuracy100: 0.4045 - val_loss: 3.2994 - val_accuracy100: 0.3525 - 141s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 148s - loss: 3.2297 - accuracy100: 0.4061 - val_loss: 3.2882 - val_accuracy100: 0.3569 - 148s/epoch - 43ms/step
Epoch 11/50
3419/3419 - 142s - loss: 3.2264 - accuracy100: 0.4076 - val_loss: 3.3127 - val_accuracy100: 0.3519 - 142s/epoch - 42ms/step
Epoch 12/50
3419/3419 - 140s - loss: 3.2246 - accuracy100: 0.4085 - val_loss: 3.2969 - val_accuracy100: 0.3546 - 140s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 140s - loss: 3.2202 - accuracy100: 0.4121 - val_loss: 3.3024 - val_accuracy100: 0.3538 - 140s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 139s - loss: 3.2205 - accuracy100: 0.4116 - val_loss: 3.2997 - val_accuracy100: 0.3564 - 139s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 143s - loss: 3.2159 - accuracy100: 0.4146 - val_loss: 3.3012 - val_accuracy100: 0.3557 - 143s/epoch - 42ms/step
testing model: results/AAPL/W9/deepVOL_L3/h100
Evaluating performance on  test set...
10303/10303 - 192s - 192s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0894146
{'0': {'precision': 0.3569833222148099, 'recall': 0.33263340320202495, 'f1-score': 0.344378472789803, 'support': 804366}, '1': {'precision': 0.38182385124774104, 'recall': 0.48300144794101213, 'f1-score': 0.4264941675135281, 'support': 1016616}, '2': {'precision': 0.36034224954311345, 'recall': 0.26565918115876347, 'f1-score': 0.30584028168497707, 'support': 816422}, 'accuracy': 0.3698621826614353, 'macro avg': {'precision': 0.3663831410018881, 'recall': 0.3604313441006002, 'f1-score': 0.358904307329436, 'support': 2637404}, 'weighted avg': {'precision': 0.36759814703139865, 'recall': 0.3698621826614353, 'f1-score': 0.36410116299921735, 'support': 2637404}}
[[267559 384500 152307]
 [292886 491027 232703]
 [189055 410477 216890]]
Evaluating performance on  train set...
3419/3419 - 65s - 65s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0918382
{'0': {'precision': 0.3887757223030555, 'recall': 0.29393297037551813, 'f1-score': 0.3347665090305978, 'support': 286351}, '1': {'precision': 0.325306960763195, 'recall': 0.5265089145480591, 'f1-score': 0.4021456274075031, 'support': 289695}, '2': {'precision': 0.41563744809998526, 'recall': 0.2637274830496008, 'f1-score': 0.3226984880219924, 'support': 299108}, 'accuracy': 0.36059710633785597, 'macro avg': {'precision': 0.376573377055412, 'recall': 0.3613897893243927, 'f1-score': 0.3532035414866977, 'support': 875154}, 'weighted avg': {'precision': 0.37694691755026705, 'recall': 0.36059710633785597, 'f1-score': 0.3529458832554264, 'support': 875154}}
[[ 84168 152402  49781]
 [ 76044 152527  61124]
 [ 56283 163942  78883]]
Evaluating performance on  val set...
1396/1396 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09118
{'0': {'precision': 0.4005113667945084, 'recall': 0.30302112770824924, 'f1-score': 0.34501151538656744, 'support': 118896}, '1': {'precision': 0.3348712629085448, 'recall': 0.5390091541924873, 'f1-score': 0.4130969699091832, 'support': 120382}, '2': {'precision': 0.4023713695202872, 'recall': 0.2508051666271146, 'f1-score': 0.3090031952885158, 'support': 117988}, 'accuracy': 0.3652936467506004, 'macro avg': {'precision': 0.37925133307444686, 'recall': 0.3642784828426171, 'f1-score': 0.3557038935280888, 'support': 357266}, 'weighted avg': {'precision': 0.37900798000597863, 'recall': 0.3652936467506004, 'f1-score': 0.3560613032606238, 'support': 357266}}
[[36028 62977 19891]
 [31434 64887 24061]
 [22493 65903 29592]]
training model: results/AAPL/W9/deepVOL_L3/h200
Epoch 1/50
3419/3419 - 144s - loss: 3.2585 - accuracy200: 0.3838 - val_loss: 3.2998 - val_accuracy200: 0.3418 - 144s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 139s - loss: 3.2569 - accuracy200: 0.3796 - val_loss: 3.3002 - val_accuracy200: 0.3388 - 139s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.2607 - accuracy200: 0.3802 - val_loss: 3.2985 - val_accuracy200: 0.3457 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.2574 - accuracy200: 0.3842 - val_loss: 3.2939 - val_accuracy200: 0.3458 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 142s - loss: 3.2529 - accuracy200: 0.3876 - val_loss: 3.2953 - val_accuracy200: 0.3448 - 142s/epoch - 42ms/step
Epoch 6/50
3419/3419 - 142s - loss: 3.2580 - accuracy200: 0.3856 - val_loss: 3.2921 - val_accuracy200: 0.3467 - 142s/epoch - 42ms/step
Epoch 7/50
3419/3419 - 141s - loss: 3.2549 - accuracy200: 0.3884 - val_loss: 3.3071 - val_accuracy200: 0.3407 - 141s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 141s - loss: 3.2545 - accuracy200: 0.3882 - val_loss: 3.2998 - val_accuracy200: 0.3480 - 141s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 138s - loss: 3.2504 - accuracy200: 0.3903 - val_loss: 3.2894 - val_accuracy200: 0.3525 - 138s/epoch - 40ms/step
Epoch 10/50
3419/3419 - 140s - loss: 3.2504 - accuracy200: 0.3913 - val_loss: 3.2965 - val_accuracy200: 0.3506 - 140s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 138s - loss: 3.2459 - accuracy200: 0.3934 - val_loss: 3.2891 - val_accuracy200: 0.3513 - 138s/epoch - 40ms/step
Epoch 12/50
3419/3419 - 138s - loss: 3.2500 - accuracy200: 0.3928 - val_loss: 3.2934 - val_accuracy200: 0.3576 - 138s/epoch - 40ms/step
Epoch 13/50
3419/3419 - 141s - loss: 3.2490 - accuracy200: 0.3923 - val_loss: 3.2851 - val_accuracy200: 0.3587 - 141s/epoch - 41ms/step
Epoch 14/50
3419/3419 - 140s - loss: 3.2461 - accuracy200: 0.3955 - val_loss: 3.2989 - val_accuracy200: 0.3561 - 140s/epoch - 41ms/step
Epoch 15/50
3419/3419 - 139s - loss: 3.2449 - accuracy200: 0.3953 - val_loss: 3.2896 - val_accuracy200: 0.3549 - 139s/epoch - 41ms/step
Epoch 16/50
3419/3419 - 139s - loss: 3.2409 - accuracy200: 0.3990 - val_loss: 3.3031 - val_accuracy200: 0.3494 - 139s/epoch - 41ms/step
Epoch 17/50
3419/3419 - 139s - loss: 3.2388 - accuracy200: 0.4002 - val_loss: 3.2957 - val_accuracy200: 0.3541 - 139s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 141s - loss: 3.2336 - accuracy200: 0.4026 - val_loss: 3.2997 - val_accuracy200: 0.3547 - 141s/epoch - 41ms/step
Epoch 19/50
3419/3419 - 139s - loss: 3.2339 - accuracy200: 0.4015 - val_loss: 3.3022 - val_accuracy200: 0.3541 - 139s/epoch - 41ms/step
Epoch 20/50
3419/3419 - 137s - loss: 3.2295 - accuracy200: 0.4057 - val_loss: 3.3084 - val_accuracy200: 0.3549 - 137s/epoch - 40ms/step
Epoch 21/50
3419/3419 - 141s - loss: 3.2267 - accuracy200: 0.4077 - val_loss: 3.3124 - val_accuracy200: 0.3548 - 141s/epoch - 41ms/step
Epoch 22/50
3419/3419 - 141s - loss: 3.2236 - accuracy200: 0.4090 - val_loss: 3.3145 - val_accuracy200: 0.3549 - 141s/epoch - 41ms/step
Epoch 23/50
3419/3419 - 141s - loss: 3.2211 - accuracy200: 0.4102 - val_loss: 3.3183 - val_accuracy200: 0.3532 - 141s/epoch - 41ms/step
testing model: results/AAPL/W9/deepVOL_L3/h200
Evaluating performance on  test set...
10303/10303 - 194s - 194s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0937438
{'0': {'precision': 0.3371659720519735, 'recall': 0.20328285627711387, 'f1-score': 0.25364126350345106, 'support': 811854}, '1': {'precision': 0.3841874002823952, 'recall': 0.6018269725994035, 'f1-score': 0.46898776809312614, 'support': 1001876}, '2': {'precision': 0.3420444880828084, 'recall': 0.24022853701828636, 'f1-score': 0.28223477106134365, 'support': 823674}, 'accuracy': 0.366216931497791, 'macro avg': {'precision': 0.3544659534723924, 'recall': 0.3484461219649346, 'f1-score': 0.3349546008859736, 'support': 2637404}, 'weighted avg': {'precision': 0.3565516813490565, 'recall': 0.366216931497791, 'f1-score': 0.34437526685543085, 'support': 2637404}}
[[165036 473304 173514]
 [191812 602956 207108]
 [132632 493172 197870]]
Evaluating performance on  train set...
3419/3419 - 62s - 62s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955205
{'0': {'precision': 0.3607627335551574, 'recall': 0.16656760824305114, 'f1-score': 0.227907938946182, 'support': 287709}, '1': {'precision': 0.33558910518745844, 'recall': 0.6170929623942348, 'f1-score': 0.43475086204370295, 'support': 288493}, '2': {'precision': 0.4010244305440812, 'recall': 0.2841492948700795, 'f1-score': 0.33261873576923, 'support': 298952}, 'accuracy': 0.3552483334361724, 'macro avg': {'precision': 0.3657920897622324, 'recall': 0.3559366218357885, 'f1-score': 0.33175917891970497, 'support': 875154}, 'weighted avg': {'precision': 0.3662176583678763, 'recall': 0.3552483334361724, 'f1-score': 0.33186248585451694, 'support': 875154}}
[[ 47923 174265  65521]
 [ 49109 178027  61357]
 [ 35806 178199  84947]]
Evaluating performance on  val set...
1396/1396 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0948279
{'0': {'precision': 0.3760790894203748, 'recall': 0.1564126495640256, 'f1-score': 0.2209368616086275, 'support': 118929}, '1': {'precision': 0.34887513401987547, 'recall': 0.6394200601076654, 'f1-score': 0.4514395303965631, 'support': 121116}, '2': {'precision': 0.3780310180491954, 'recall': 0.27676781464072137, 'f1-score': 0.31956935018370586, 'support': 117221}, 'accuracy': 0.3596451943369926, 'macro avg': {'precision': 0.36766174716314853, 'recall': 0.3575335081041375, 'f1-score': 0.33064858072963216, 'support': 357266}, 'weighted avg': {'precision': 0.36749717220326517, 'recall': 0.3596451943369926, 'f1-score': 0.331440968285946, 'support': 357266}}
[[18602 72505 27822]
 [18116 77444 25556]
 [12745 72033 32443]]
training model: results/AAPL/W9/deepVOL_L3/h300
Epoch 1/50
3419/3419 - 142s - loss: 3.2574 - accuracy300: 0.3849 - val_loss: 3.3033 - val_accuracy300: 0.3435 - 142s/epoch - 41ms/step
Epoch 2/50
3419/3419 - 138s - loss: 3.2641 - accuracy300: 0.3766 - val_loss: 3.3027 - val_accuracy300: 0.3435 - 138s/epoch - 40ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.2628 - accuracy300: 0.3757 - val_loss: 3.2935 - val_accuracy300: 0.3489 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 140s - loss: 3.2704 - accuracy300: 0.3721 - val_loss: 3.2923 - val_accuracy300: 0.3490 - 140s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 140s - loss: 3.2715 - accuracy300: 0.3737 - val_loss: 3.2910 - val_accuracy300: 0.3553 - 140s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 140s - loss: 3.2649 - accuracy300: 0.3801 - val_loss: 3.2964 - val_accuracy300: 0.3485 - 140s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 139s - loss: 3.2576 - accuracy300: 0.3836 - val_loss: 3.2931 - val_accuracy300: 0.3528 - 139s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 140s - loss: 3.2529 - accuracy300: 0.3884 - val_loss: 3.2957 - val_accuracy300: 0.3517 - 140s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 141s - loss: 3.2506 - accuracy300: 0.3911 - val_loss: 3.2983 - val_accuracy300: 0.3508 - 141s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 141s - loss: 3.2457 - accuracy300: 0.3951 - val_loss: 3.3040 - val_accuracy300: 0.3485 - 141s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.2414 - accuracy300: 0.3967 - val_loss: 3.3140 - val_accuracy300: 0.3460 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 140s - loss: 3.2367 - accuracy300: 0.4011 - val_loss: 3.3170 - val_accuracy300: 0.3459 - 140s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 142s - loss: 3.2328 - accuracy300: 0.4026 - val_loss: 3.3231 - val_accuracy300: 0.3449 - 142s/epoch - 42ms/step
Epoch 14/50
3419/3419 - 145s - loss: 3.2330 - accuracy300: 0.4032 - val_loss: 3.3242 - val_accuracy300: 0.3471 - 145s/epoch - 42ms/step
Epoch 15/50
3419/3419 - 147s - loss: 3.2308 - accuracy300: 0.4045 - val_loss: 3.3154 - val_accuracy300: 0.3457 - 147s/epoch - 43ms/step
testing model: results/AAPL/W9/deepVOL_L3/h300
Evaluating performance on  test set...
10303/10303 - 193s - 193s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965394
{'0': {'precision': 0.3115557370355247, 'recall': 0.08504751489600969, 'f1-score': 0.13361988867928015, 'support': 807431}, '1': {'precision': 0.38714247696174087, 'recall': 0.648798292768792, 'f1-score': 0.4849261375752104, 'support': 1011228}, '2': {'precision': 0.32189369428488757, 'recall': 0.28398097087615803, 'f1-score': 0.3017511346101185, 'support': 818745}, 'accuracy': 0.3629557701436716, 'macro avg': {'precision': 0.3401973027607177, 'recall': 0.33927559284698655, 'f1-score': 0.30676572028820304, 'support': 2637404}, 'weighted avg': {'precision': 0.3437463224180589, 'recall': 0.3629557701436716, 'f1-score': 0.32051098780864296, 'support': 2637404}}
[[ 68670 517631 221130]
 [ 86470 656083 268675]
 [ 65270 520967 232508]]
Evaluating performance on  train set...
3419/3419 - 64s - 64s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976553
{'0': {'precision': 0.34238848547717843, 'recall': 0.0733721891476961, 'f1-score': 0.1208473732687258, 'support': 287902}, '1': {'precision': 0.34324176401720957, 'recall': 0.6545906993623308, 'f1-score': 0.45034186520132063, 'support': 289335}, '2': {'precision': 0.38244061267541046, 'recall': 0.33591235142673964, 'f1-score': 0.35766964683008423, 'support': 297917}, 'accuracy': 0.3549021086574477, 'macro avg': {'precision': 0.35602362072326615, 'recall': 0.3546250799789222, 'f1-score': 0.3096196284333769, 'support': 875154}, 'weighted avg': {'precision': 0.3563049995134459, 'recall': 0.3549021086574477, 'f1-score': 0.31039992070140227, 'support': 875154}}
[[ 21124 182561  84217]
 [ 22558 189396  77381]
 [ 18014 179829 100074]]
Evaluating performance on  val set...
1396/1396 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0968313
{'0': {'precision': 0.34544382455662903, 'recall': 0.0642017770134709, 'f1-score': 0.10827948504688177, 'support': 118626}, '1': {'precision': 0.35467777492496616, 'recall': 0.6529296715834081, 'f1-score': 0.459662428859923, 'support': 122710}, '2': {'precision': 0.35784524473797347, 'recall': 0.33744500991977916, 'f1-score': 0.3473458497409556, 'support': 115930}, 'accuracy': 0.35507716939199363, 'macro avg': {'precision': 0.35265561473985624, 'recall': 0.3515254861722194, 'f1-score': 0.3050959212159201, 'support': 357266}, 'weighted avg': {'precision': 0.35263956859978435, 'recall': 0.35507716939199363, 'f1-score': 0.3065439845914291, 'support': 357266}}
[[ 7616 75115 35895]
 [ 8283 80121 34306]
 [ 6148 70662 39120]]
training model: results/AAPL/W9/deepVOL_L3/h500
Epoch 1/50
3419/3419 - 147s - loss: 3.2555 - accuracy500: 0.3871 - val_loss: 3.3170 - val_accuracy500: 0.3433 - 147s/epoch - 43ms/step
Epoch 2/50
3419/3419 - 140s - loss: 3.2568 - accuracy500: 0.3841 - val_loss: 3.3147 - val_accuracy500: 0.3433 - 140s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 141s - loss: 3.2592 - accuracy500: 0.3813 - val_loss: 3.3092 - val_accuracy500: 0.3433 - 141s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.2616 - accuracy500: 0.3787 - val_loss: 3.3057 - val_accuracy500: 0.3433 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 140s - loss: 3.2623 - accuracy500: 0.3780 - val_loss: 3.3047 - val_accuracy500: 0.3434 - 140s/epoch - 41ms/step
Epoch 6/50
3419/3419 - 139s - loss: 3.2626 - accuracy500: 0.3790 - val_loss: 3.3085 - val_accuracy500: 0.3432 - 139s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 140s - loss: 3.2603 - accuracy500: 0.3796 - val_loss: 3.3036 - val_accuracy500: 0.3388 - 140s/epoch - 41ms/step
Epoch 8/50
3419/3419 - 139s - loss: 3.2657 - accuracy500: 0.3749 - val_loss: 3.3018 - val_accuracy500: 0.3426 - 139s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.2597 - accuracy500: 0.3780 - val_loss: 3.2983 - val_accuracy500: 0.3433 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 140s - loss: 3.2682 - accuracy500: 0.3748 - val_loss: 3.2968 - val_accuracy500: 0.3432 - 140s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.2639 - accuracy500: 0.3797 - val_loss: 3.2969 - val_accuracy500: 0.3433 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 137s - loss: 3.2548 - accuracy500: 0.3843 - val_loss: 3.3001 - val_accuracy500: 0.3431 - 137s/epoch - 40ms/step
Epoch 13/50
3419/3419 - 138s - loss: 3.2487 - accuracy500: 0.3892 - val_loss: 3.3063 - val_accuracy500: 0.3433 - 138s/epoch - 40ms/step
Epoch 14/50
3419/3419 - 142s - loss: 3.2413 - accuracy500: 0.3948 - val_loss: 3.3089 - val_accuracy500: 0.3432 - 142s/epoch - 42ms/step
Epoch 15/50
3419/3419 - 140s - loss: 3.2363 - accuracy500: 0.3986 - val_loss: 3.3168 - val_accuracy500: 0.3430 - 140s/epoch - 41ms/step
Epoch 16/50
3419/3419 - 140s - loss: 3.2331 - accuracy500: 0.4010 - val_loss: 3.3182 - val_accuracy500: 0.3431 - 140s/epoch - 41ms/step
Epoch 17/50
3419/3419 - 139s - loss: 3.2302 - accuracy500: 0.4025 - val_loss: 3.3263 - val_accuracy500: 0.3431 - 139s/epoch - 41ms/step
Epoch 18/50
3419/3419 - 142s - loss: 3.2267 - accuracy500: 0.4045 - val_loss: 3.3313 - val_accuracy500: 0.3428 - 142s/epoch - 42ms/step
Epoch 19/50
3419/3419 - 142s - loss: 3.2242 - accuracy500: 0.4053 - val_loss: 3.3385 - val_accuracy500: 0.3428 - 142s/epoch - 42ms/step
Epoch 20/50
3419/3419 - 143s - loss: 3.2211 - accuracy500: 0.4064 - val_loss: 3.3419 - val_accuracy500: 0.3419 - 143s/epoch - 42ms/step
testing model: results/AAPL/W9/deepVOL_L3/h500
Evaluating performance on  test set...
10303/10303 - 193s - 193s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0929543
{'0': {'precision': 0.300196463654224, 'recall': 0.001922249535162825, 'f1-score': 0.0038200382003820035, 'support': 794902}, '1': {'precision': 0.3922921469064388, 'recall': 0.9977509150499254, 'f1-score': 0.5631621915250941, 'support': 1034643}, '2': {'precision': 0.3137254901960784, 'recall': 0.0003168869815153387, 'f1-score': 0.0006331344483259653, 'support': 807859}, 'accuracy': 0.3920901007202537, 'macro avg': {'precision': 0.33540470025224706, 'recall': 0.33333001718886784, 'f1-score': 0.18920512139126733, 'support': 2637404}, 'weighted avg': {'precision': 0.3404692849058022, 'recall': 0.3920901007202537, 'f1-score': 0.2222715437960768, 'support': 2637404}}
[[   1528  793130     244]
 [   2011 1032316     316]
 [   1551  806052     256]]
Evaluating performance on  train set...
3419/3419 - 73s - 73s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.101496
{'0': {'precision': 0.3399162178336326, 'recall': 0.0019630748387721103, 'f1-score': 0.0039036056808458724, 'support': 289342}, '1': {'precision': 0.3300745508056297, 'recall': 0.9978915662650603, 'f1-score': 0.4960647809512336, 'support': 288840}, '2': {'precision': 0.3794466403162055, 'recall': 0.0003232627991864553, 'f1-score': 0.0006459752712591471, 'support': 296972}, 'accuracy': 0.3301076153454135, 'macro avg': {'precision': 0.3498124696518226, 'recall': 0.3333926346343396, 'f1-score': 0.1668714539677795, 'support': 875154}, 'weighted avg': {'precision': 0.3500821560812168, 'recall': 0.3301076153454135, 'f1-score': 0.1652333931777927, 'support': 875154}}
[[   568 288684     90]
 [   542 288231     67]
 [   561 296315     96]]
Evaluating performance on  val set...
1396/1396 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0992695
{'0': {'precision': 0.29972375690607733, 'recall': 0.0018335445711871567, 'f1-score': 0.003644792314023212, 'support': 118350}, '1': {'precision': 0.3432283044807946, 'recall': 0.9974560101759593, 'f1-score': 0.5107169994071624, 'support': 122642}, '2': {'precision': 0.4166666666666667, 'recall': 0.0004730206236991933, 'f1-score': 0.0009449684724155112, 'support': 116274}, 'accuracy': 0.3431672759232617, 'macro avg': {'precision': 0.3532062426845129, 'recall': 0.3332541917902819, 'f1-score': 0.17176892006453373, 'support': 357266}, 'weighted avg': {'precision': 0.3527176175397823, 'recall': 0.3431672759232617, 'f1-score': 0.17683348170780178, 'support': 357266}}
[[   217 118088     45]
 [   280 122330     32]
 [   227 115992     55]]
training model: results/AAPL/W9/deepVOL_L3/h1000
Epoch 1/50
3419/3419 - 144s - loss: 3.2653 - accuracy1000: 0.3806 - val_loss: 3.2966 - val_accuracy1000: 0.3392 - 144s/epoch - 42ms/step
Epoch 2/50
3419/3419 - 140s - loss: 3.2695 - accuracy1000: 0.3735 - val_loss: 3.2972 - val_accuracy1000: 0.3290 - 140s/epoch - 41ms/step
Epoch 3/50
3419/3419 - 139s - loss: 3.2670 - accuracy1000: 0.3754 - val_loss: 3.2963 - val_accuracy1000: 0.3319 - 139s/epoch - 41ms/step
Epoch 4/50
3419/3419 - 139s - loss: 3.2791 - accuracy1000: 0.3675 - val_loss: 3.2990 - val_accuracy1000: 0.3371 - 139s/epoch - 41ms/step
Epoch 5/50
3419/3419 - 148s - loss: 3.2728 - accuracy1000: 0.3729 - val_loss: 3.3012 - val_accuracy1000: 0.3371 - 148s/epoch - 43ms/step
Epoch 6/50
3419/3419 - 140s - loss: 3.2782 - accuracy1000: 0.3686 - val_loss: 3.3052 - val_accuracy1000: 0.3383 - 140s/epoch - 41ms/step
Epoch 7/50
3419/3419 - 147s - loss: 3.2770 - accuracy1000: 0.3696 - val_loss: 3.3076 - val_accuracy1000: 0.3368 - 147s/epoch - 43ms/step
Epoch 8/50
3419/3419 - 140s - loss: 3.2703 - accuracy1000: 0.3756 - val_loss: 3.3051 - val_accuracy1000: 0.3377 - 140s/epoch - 41ms/step
Epoch 9/50
3419/3419 - 139s - loss: 3.2631 - accuracy1000: 0.3804 - val_loss: 3.3015 - val_accuracy1000: 0.3329 - 139s/epoch - 41ms/step
Epoch 10/50
3419/3419 - 141s - loss: 3.2635 - accuracy1000: 0.3800 - val_loss: 3.3008 - val_accuracy1000: 0.3313 - 141s/epoch - 41ms/step
Epoch 11/50
3419/3419 - 139s - loss: 3.2678 - accuracy1000: 0.3774 - val_loss: 3.3013 - val_accuracy1000: 0.3363 - 139s/epoch - 41ms/step
Epoch 12/50
3419/3419 - 140s - loss: 3.2640 - accuracy1000: 0.3795 - val_loss: 3.3059 - val_accuracy1000: 0.3327 - 140s/epoch - 41ms/step
Epoch 13/50
3419/3419 - 143s - loss: 3.2595 - accuracy1000: 0.3849 - val_loss: 3.3103 - val_accuracy1000: 0.3305 - 143s/epoch - 42ms/step
testing model: results/AAPL/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
10303/10303 - 195s - 195s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983462
{'0': {'precision': 0.2877305274520905, 'recall': 0.6360698217623004, 'f1-score': 0.3962256681709703, 'support': 771049}, '1': {'precision': 0.39255609562802307, 'recall': 0.3083663244536894, 'f1-score': 0.34540507446342644, 'support': 1073016}, '2': {'precision': 0.3041956487921954, 'recall': 0.034508577039575765, 'f1-score': 0.06198540307945891, 'support': 793339}, 'accuracy': 0.3217937032020881, 'macro avg': {'precision': 0.32816075729076966, 'recall': 0.3263149077518552, 'f1-score': 0.2678720485712852, 'support': 2637404}, 'weighted avg': {'precision': 0.33533109784657844, 'recall': 0.3217937032020881, 'f1-score': 0.27500906736004854, 'support': 2637404}}
[[490441 253598  27010]
 [706523 330882  35611]
 [507551 258411  27377]]
Evaluating performance on  train set...
3419/3419 - 65s - 65s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992
{'0': {'precision': 0.33074351285125175, 'recall': 0.6531608307616472, 'f1-score': 0.43912542723348746, 'support': 288073}, '1': {'precision': 0.31190332238783275, 'recall': 0.2978753565563143, 'f1-score': 0.3047279827108704, 'support': 289225}, '2': {'precision': 0.36943714009919115, 'recall': 0.03726297271164589, 'f1-score': 0.06769767519876546, 'support': 297856}, 'accuracy': 0.3261254590620622, 'macro avg': {'precision': 0.3373613251127585, 'recall': 0.3294330533432025, 'f1-score': 0.27051702838104114, 'support': 875154}, 'weighted avg': {'precision': 0.33768637656527223, 'recall': 0.3261254590620622, 'f1-score': 0.2682948243886075, 'support': 875154}}
[[188158  90182   9733]
 [193861  86153   9211]
 [186875  99882  11099]]
Evaluating performance on  val set...
1396/1396 - 27s - 27s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098801
{'0': {'precision': 0.3304357148600477, 'recall': 0.6337234206603499, 'f1-score': 0.4343781930073873, 'support': 116726}, '1': {'precision': 0.3315699744271173, 'recall': 0.3262800375006168, 'f1-score': 0.3289037371091289, 'support': 121598}, '2': {'precision': 0.346500800232795, 'recall': 0.040044727682399826, 'f1-score': 0.07179247558181599, 'support': 118942}, 'accuracy': 0.3314337216527741, 'macro avg': {'precision': 0.3361688298399867, 'recall': 0.3333493952811222, 'f1-score': 0.27835813523277736, 'support': 357266}, 'weighted avg': {'precision': 0.33617020143095516, 'recall': 0.3314337216527741, 'f1-score': 0.2777661636221429, 'support': 357266}}
[[73972 38335  4419]
 [77359 39675  4564]
 [72531 41648  4763]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        92 (peak)  22.70 (ave)

============================================
