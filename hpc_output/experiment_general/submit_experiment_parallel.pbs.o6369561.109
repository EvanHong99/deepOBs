This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-22.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-14.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-02.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-10.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-06.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-08.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-03.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-09.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-12-31.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-16.csv
data/AAPL_orderbooks/AAPL_orderbooks_2020-01-15.csv
training model: results/AAPL/W10/deepLOB_L1/h10
Epoch 1/50
5429/5429 - 95s - loss: 3.2081 - accuracy10: 0.4184 - val_loss: 3.3311 - val_accuracy10: 0.3753 - 95s/epoch - 18ms/step
Epoch 2/50
5429/5429 - 84s - loss: 3.1802 - accuracy10: 0.4306 - val_loss: 3.3463 - val_accuracy10: 0.3581 - 84s/epoch - 16ms/step
Epoch 3/50
5429/5429 - 85s - loss: 3.1713 - accuracy10: 0.4342 - val_loss: 3.2899 - val_accuracy10: 0.3667 - 85s/epoch - 16ms/step
Epoch 4/50
5429/5429 - 82s - loss: 3.1657 - accuracy10: 0.4365 - val_loss: 3.2618 - val_accuracy10: 0.3827 - 82s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 84s - loss: 3.1618 - accuracy10: 0.4376 - val_loss: 3.2851 - val_accuracy10: 0.3816 - 84s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 84s - loss: 3.1594 - accuracy10: 0.4389 - val_loss: 3.2759 - val_accuracy10: 0.3837 - 84s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 83s - loss: 3.1567 - accuracy10: 0.4400 - val_loss: 3.3075 - val_accuracy10: 0.3728 - 83s/epoch - 15ms/step
Epoch 8/50
5429/5429 - 84s - loss: 3.1547 - accuracy10: 0.4408 - val_loss: 3.3100 - val_accuracy10: 0.3685 - 84s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 82s - loss: 3.1525 - accuracy10: 0.4417 - val_loss: 3.3264 - val_accuracy10: 0.3643 - 82s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 82s - loss: 3.1507 - accuracy10: 0.4422 - val_loss: 3.3338 - val_accuracy10: 0.3608 - 82s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 82s - loss: 3.1491 - accuracy10: 0.4426 - val_loss: 3.3211 - val_accuracy10: 0.3645 - 82s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 83s - loss: 3.1477 - accuracy10: 0.4436 - val_loss: 3.3292 - val_accuracy10: 0.3620 - 83s/epoch - 15ms/step
Epoch 13/50
5429/5429 - 85s - loss: 3.1463 - accuracy10: 0.4437 - val_loss: 3.3139 - val_accuracy10: 0.3682 - 85s/epoch - 16ms/step
Epoch 14/50
5429/5429 - 84s - loss: 3.1453 - accuracy10: 0.4442 - val_loss: 3.3217 - val_accuracy10: 0.3634 - 84s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h10
Evaluating performance on  test set...
22048/22048 - 139s - 139s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0814011
{'0': {'precision': 0.4209262466275578, 'recall': 0.6814368691456013, 'f1-score': 0.5203996025246479, 'support': 2146890}, '1': {'precision': 0.24209431935007614, 'recall': 0.047480513652760604, 'f1-score': 0.07939061910842556, 'support': 1319257}, '2': {'precision': 0.4376564682078594, 'recall': 0.3837636902348616, 'f1-score': 0.408942146277547, 'support': 2177921}, 'accuracy': 0.41838900594393974, 'macro avg': {'precision': 0.36689234472849774, 'recall': 0.3708936910110745, 'f1-score': 0.3362441226368735, 'support': 5644068}, 'weighted avg': {'precision': 0.38558149688855453, 'recall': 0.41838900594393974, 'f1-score': 0.3743082154255064, 'support': 5644068}}
[[1462970   91843  592077]
 [ 774769   62639  481849]
 [1237858  104256  835807]]
Evaluating performance on  train set...
5429/5429 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.098549
{'0': {'precision': 0.37072957171442916, 'recall': 0.6370053220893808, 'f1-score': 0.4686881672750415, 'support': 461285}, '1': {'precision': 0.3576874973213277, 'recall': 0.19944903461566035, 'f1-score': 0.25609674449744746, 'support': 460283}, '2': {'precision': 0.4163130584929097, 'recall': 0.3027798422990509, 'f1-score': 0.35058391498148417, 'support': 468228}, 'accuracy': 0.3794902273427179, 'macro avg': {'precision': 0.38157670917622216, 'recall': 0.37974473300136397, 'f1-score': 0.3584562755846577, 'support': 1389796}, 'weighted avg': {'precision': 0.3817674648436614, 'recall': 0.3794902273427179, 'f1-score': 0.3584907457158723, 'support': 1389796}}
[[293841  79967  87477]
 [257190  91803 111290]
 [241571  84887 141770]]
Evaluating performance on  val set...
1890/1890 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0874785
{'0': {'precision': 0.3610261837566635, 'recall': 0.6016709998562861, 'f1-score': 0.4512716743181072, 'support': 153082}, '1': {'precision': 0.4065199219838395, 'recall': 0.20893718423132884, 'f1-score': 0.2760131517712893, 'support': 174574}, '2': {'precision': 0.4057786229848295, 'recall': 0.3610706937331342, 'f1-score': 0.38212140432041186, 'support': 156011}, 'accuracy': 0.3823105566433104, 'macro avg': {'precision': 0.3911082429084442, 'recall': 0.39055962594024973, 'f1-score': 0.3698020768032695, 'support': 483667}, 'weighted avg': {'precision': 0.39188191022486674, 'recall': 0.3823105566433104, 'f1-score': 0.36570911973468795, 'support': 483667}}
[[92105 25609 35368]
 [90976 36475 47123]
 [72039 27641 56331]]
training model: results/AAPL/W10/deepLOB_L1/h20
Epoch 1/50
5429/5429 - 86s - loss: 3.2384 - accuracy20: 0.4026 - val_loss: 3.3865 - val_accuracy20: 0.3290 - 86s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 83s - loss: 3.2187 - accuracy20: 0.4124 - val_loss: 3.3127 - val_accuracy20: 0.3451 - 83s/epoch - 15ms/step
Epoch 3/50
5429/5429 - 85s - loss: 3.2099 - accuracy20: 0.4166 - val_loss: 3.3225 - val_accuracy20: 0.3344 - 85s/epoch - 16ms/step
Epoch 4/50
5429/5429 - 81s - loss: 3.2052 - accuracy20: 0.4187 - val_loss: 3.2844 - val_accuracy20: 0.3497 - 81s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 83s - loss: 3.2023 - accuracy20: 0.4196 - val_loss: 3.2823 - val_accuracy20: 0.3586 - 83s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 83s - loss: 3.2001 - accuracy20: 0.4203 - val_loss: 3.2715 - val_accuracy20: 0.3641 - 83s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 83s - loss: 3.1983 - accuracy20: 0.4211 - val_loss: 3.2765 - val_accuracy20: 0.3664 - 83s/epoch - 15ms/step
Epoch 8/50
5429/5429 - 81s - loss: 3.1969 - accuracy20: 0.4218 - val_loss: 3.2769 - val_accuracy20: 0.3602 - 81s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 83s - loss: 3.1955 - accuracy20: 0.4225 - val_loss: 3.2981 - val_accuracy20: 0.3712 - 83s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 82s - loss: 3.1941 - accuracy20: 0.4232 - val_loss: 3.2879 - val_accuracy20: 0.3819 - 82s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 83s - loss: 3.1925 - accuracy20: 0.4241 - val_loss: 3.3555 - val_accuracy20: 0.3679 - 83s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 82s - loss: 3.1907 - accuracy20: 0.4247 - val_loss: 3.3498 - val_accuracy20: 0.3580 - 82s/epoch - 15ms/step
Epoch 13/50
5429/5429 - 83s - loss: 3.1896 - accuracy20: 0.4247 - val_loss: 3.3527 - val_accuracy20: 0.3498 - 83s/epoch - 15ms/step
Epoch 14/50
5429/5429 - 83s - loss: 3.1885 - accuracy20: 0.4256 - val_loss: 3.3470 - val_accuracy20: 0.3583 - 83s/epoch - 15ms/step
Epoch 15/50
5429/5429 - 84s - loss: 3.1877 - accuracy20: 0.4258 - val_loss: 3.3573 - val_accuracy20: 0.3523 - 84s/epoch - 16ms/step
Epoch 16/50
5429/5429 - 83s - loss: 3.1870 - accuracy20: 0.4261 - val_loss: 3.3727 - val_accuracy20: 0.3565 - 83s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h20
Evaluating performance on  test set...
22048/22048 - 129s - 129s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0988182
{'0': {'precision': 0.4099650220094559, 'recall': 0.3731784985860673, 'f1-score': 0.3907077754278169, 'support': 2075417}, '1': {'precision': 0.22645666274391746, 'recall': 0.06884511409357816, 'f1-score': 0.10558984744907482, 'support': 1442281}, '2': {'precision': 0.39901676872475433, 'recall': 0.6223300742580078, 'f1-score': 0.4862601515181023, 'support': 2126370}, 'accuracy': 0.38927578477084257, 'macro avg': {'precision': 0.34514615115937586, 'recall': 0.354784562312551, 'f1-score': 0.32751925813166466, 'support': 5644068}, 'weighted avg': {'precision': 0.35894673923064263, 'recall': 0.38927578477084257, 'f1-score': 0.3538477545464228, 'support': 5644068}}
[[ 774501  161447 1139469]
 [ 489348   99294  853639]
 [ 625339  177727 1323304]]
Evaluating performance on  train set...
5429/5429 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0985184
{'0': {'precision': 0.35634048926610085, 'recall': 0.6217239719777791, 'f1-score': 0.45302826785316175, 'support': 459207}, '1': {'precision': 0.32942390610377914, 'recall': 0.2460661385224447, 'f1-score': 0.2817079783355251, 'support': 459218}, '2': {'precision': 0.4196450022192451, 'recall': 0.2186303357652465, 'f1-score': 0.2874844828788618, 'support': 471371}, 'accuracy': 0.3608831799774931, 'macro avg': {'precision': 0.368469799196375, 'recall': 0.36214014875515677, 'f1-score': 0.3407402430225162, 'support': 1389796}, 'weighted avg': {'precision': 0.3689173941417815, 'recall': 0.3608831799774931, 'f1-score': 0.34027366201257014, 'support': 1389796}}
[[285500 110525  63182]
 [266879 112998  79341]
 [248821 119494 103056]]
Evaluating performance on  val set...
1890/1890 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0910085
{'0': {'precision': 0.34261737237690215, 'recall': 0.6894460618562085, 'f1-score': 0.457755192701505, 'support': 153194}, '1': {'precision': 0.3762970086551602, 'recall': 0.17263940088821805, 'f1-score': 0.23668931045872588, 'support': 172255}, '2': {'precision': 0.4235534617300349, 'recall': 0.2579794966438711, 'f1-score': 0.3206539244106117, 'support': 158218}, 'accuracy': 0.36424647536424853, 'macro avg': {'precision': 0.38082261425403247, 'recall': 0.3733549864627659, 'f1-score': 0.3383661425236142, 'support': 483667}, 'weighted avg': {'precision': 0.3810881217403801, 'recall': 0.36424647536424853, 'f1-score': 0.33417514276595334, 'support': 483667}}
[[105619  23441  24134]
 [111100  29738  31417]
 [ 91552  25849  40817]]
training model: results/AAPL/W10/deepLOB_L1/h30
Epoch 1/50
5429/5429 - 87s - loss: 3.2472 - accuracy30: 0.3983 - val_loss: 3.4127 - val_accuracy30: 0.3169 - 87s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 83s - loss: 3.2292 - accuracy30: 0.4075 - val_loss: 3.3427 - val_accuracy30: 0.3459 - 83s/epoch - 15ms/step
Epoch 3/50
5429/5429 - 86s - loss: 3.2202 - accuracy30: 0.4123 - val_loss: 3.3260 - val_accuracy30: 0.3531 - 86s/epoch - 16ms/step
Epoch 4/50
5429/5429 - 81s - loss: 3.2156 - accuracy30: 0.4144 - val_loss: 3.3184 - val_accuracy30: 0.3538 - 81s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 86s - loss: 3.2127 - accuracy30: 0.4156 - val_loss: 3.3206 - val_accuracy30: 0.3525 - 86s/epoch - 16ms/step
Epoch 6/50
5429/5429 - 84s - loss: 3.2107 - accuracy30: 0.4164 - val_loss: 3.3235 - val_accuracy30: 0.3544 - 84s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 82s - loss: 3.2092 - accuracy30: 0.4171 - val_loss: 3.3242 - val_accuracy30: 0.3542 - 82s/epoch - 15ms/step
Epoch 8/50
5429/5429 - 84s - loss: 3.2081 - accuracy30: 0.4176 - val_loss: 3.3281 - val_accuracy30: 0.3547 - 84s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 83s - loss: 3.2070 - accuracy30: 0.4181 - val_loss: 3.3396 - val_accuracy30: 0.3518 - 83s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 83s - loss: 3.2058 - accuracy30: 0.4189 - val_loss: 3.3318 - val_accuracy30: 0.3582 - 83s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 82s - loss: 3.2052 - accuracy30: 0.4190 - val_loss: 3.3263 - val_accuracy30: 0.3604 - 82s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 82s - loss: 3.2044 - accuracy30: 0.4197 - val_loss: 3.3228 - val_accuracy30: 0.3634 - 82s/epoch - 15ms/step
Epoch 13/50
5429/5429 - 83s - loss: 3.2034 - accuracy30: 0.4197 - val_loss: 3.3277 - val_accuracy30: 0.3581 - 83s/epoch - 15ms/step
Epoch 14/50
5429/5429 - 83s - loss: 3.2025 - accuracy30: 0.4203 - val_loss: 3.3280 - val_accuracy30: 0.3614 - 83s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h30
Evaluating performance on  test set...
22048/22048 - 112s - 112s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1032023
{'0': {'precision': 0.3731965914203803, 'recall': 0.26795137702511984, 'f1-score': 0.3119359196118927, 'support': 2039941}, '1': {'precision': 0.26002928298480266, 'recall': 0.12356741111858446, 'f1-score': 0.16752566331968363, 'support': 1510552}, '2': {'precision': 0.3869325292322483, 'recall': 0.6397673835425051, 'f1-score': 0.482218433554515, 'support': 2093575}, 'accuracy': 0.36722821199177613, 'macro avg': {'precision': 0.3400528012124771, 'recall': 0.3437620572287365, 'f1-score': 0.3205600054953638, 'support': 5644068}, 'weighted avg': {'precision': 0.3480041436880892, 'recall': 0.36722821199177613, 'f1-score': 0.33645015520662974, 'support': 5644068}}
[[ 546605  260331 1233005]
 [ 434715  186655  889182]
 [ 483337  270837 1339401]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1149485
{'0': {'precision': 0.3436438116983413, 'recall': 0.39127281306937095, 'f1-score': 0.365914925219143, 'support': 457742}, '1': {'precision': 0.3317490583759833, 'recall': 0.38445228757029365, 'f1-score': 0.35616153226694636, 'support': 458434}, '2': {'precision': 0.35885791526850613, 'recall': 0.25560575989189643, 'f1-score': 0.2985567864576654, 'support': 473620}, 'accuracy': 0.3427898770754845, 'macro avg': {'precision': 0.34475026178094353, 'recall': 0.34377695351052034, 'f1-score': 0.34021108131458494, 'support': 1389796}, 'weighted avg': {'precision': 0.344904963974157, 'recall': 0.3427898770754845, 'f1-score': 0.33974313552852775, 'support': 1389796}}
[[179102 174512 104128]
 [170028 176246 112160]
 [172055 180505 121060]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1057444
{'0': {'precision': 0.32313890437338466, 'recall': 0.4370489174017642, 'f1-score': 0.3715595127451351, 'support': 145899}, '1': {'precision': 0.39846163389367906, 'recall': 0.3459816980227617, 'f1-score': 0.37037186520715076, 'support': 185663}, '2': {'precision': 0.3430035084354296, 'recall': 0.28216692416422867, 'f1-score': 0.30962515149766257, 'support': 152105}, 'accuracy': 0.3533836296460168, 'macro avg': {'precision': 0.35486801556749775, 'recall': 0.35506584652958484, 'f1-score': 0.35051884314998283, 'support': 483667}, 'weighted avg': {'precision': 0.3582997682152092, 'recall': 0.3533836296460168, 'f1-score': 0.3516263185797453, 'support': 483667}}
[[63765 47600 34534]
 [73753 64236 47674]
 [59812 49374 42919]]
training model: results/AAPL/W10/deepLOB_L1/h50
Epoch 1/50
5429/5429 - 85s - loss: 3.2479 - accuracy50: 0.3978 - val_loss: 3.4760 - val_accuracy50: 0.3196 - 85s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 82s - loss: 3.2307 - accuracy50: 0.4066 - val_loss: 3.3720 - val_accuracy50: 0.3306 - 82s/epoch - 15ms/step
Epoch 3/50
5429/5429 - 83s - loss: 3.2228 - accuracy50: 0.4107 - val_loss: 3.3593 - val_accuracy50: 0.3364 - 83s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 83s - loss: 3.2187 - accuracy50: 0.4134 - val_loss: 3.3610 - val_accuracy50: 0.3395 - 83s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 84s - loss: 3.2163 - accuracy50: 0.4141 - val_loss: 3.3634 - val_accuracy50: 0.3411 - 84s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 82s - loss: 3.2145 - accuracy50: 0.4155 - val_loss: 3.3720 - val_accuracy50: 0.3383 - 82s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 85s - loss: 3.2126 - accuracy50: 0.4166 - val_loss: 3.3898 - val_accuracy50: 0.3411 - 85s/epoch - 16ms/step
Epoch 8/50
5429/5429 - 85s - loss: 3.2116 - accuracy50: 0.4172 - val_loss: 3.3841 - val_accuracy50: 0.3457 - 85s/epoch - 16ms/step
Epoch 9/50
5429/5429 - 82s - loss: 3.2106 - accuracy50: 0.4176 - val_loss: 3.3741 - val_accuracy50: 0.3464 - 82s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 83s - loss: 3.2097 - accuracy50: 0.4182 - val_loss: 3.3691 - val_accuracy50: 0.3439 - 83s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 84s - loss: 3.2083 - accuracy50: 0.4189 - val_loss: 3.3678 - val_accuracy50: 0.3477 - 84s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 83s - loss: 3.2079 - accuracy50: 0.4189 - val_loss: 3.3626 - val_accuracy50: 0.3479 - 83s/epoch - 15ms/step
Epoch 13/50
5429/5429 - 83s - loss: 3.2072 - accuracy50: 0.4195 - val_loss: 3.3733 - val_accuracy50: 0.3430 - 83s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h50
Evaluating performance on  test set...
22048/22048 - 139s - 139s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059864
{'0': {'precision': 0.383235108693551, 'recall': 0.5760962744549386, 'f1-score': 0.4602795702025205, 'support': 2133567}, '1': {'precision': 0.23075866722389368, 'recall': 0.26518136916458657, 'f1-score': 0.24677539553630087, 'support': 1318030}, '2': {'precision': 0.4004300814074918, 'recall': 0.16842047169609084, 'f1-score': 0.23711191919918367, 'support': 2192471}, 'accuracy': 0.34512589146693484, 'macro avg': {'precision': 0.3381412857749788, 'recall': 0.33656603843853866, 'f1-score': 0.31472229497933507, 'support': 5644068}, 'weighted avg': {'precision': 0.3543075611995899, 'recall': 0.34512589146693484, 'f1-score': 0.3237302744998014, 'support': 5644068}}
[[1229140  573136  331291]
 [ 746910  349517  221603]
 [1231224  591990  369257]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1258794
{'0': {'precision': 0.32932611551603114, 'recall': 0.5270631484391562, 'f1-score': 0.4053662665163897, 'support': 457541}, '1': {'precision': 0.330408587055073, 'recall': 0.3440850389863548, 'f1-score': 0.3371081569013622, 'support': 459648}, '2': {'precision': 0.35525550710052556, 'recall': 0.13444786048450405, 'f1-score': 0.1950705100949089, 'support': 472607}, 'accuracy': 0.33303592757498224, 'macro avg': {'precision': 0.3383300698905432, 'recall': 0.3351986826366717, 'f1-score': 0.31251497783755355, 'support': 1389796}, 'weighted avg': {'precision': 0.3385015397124964, 'recall': 0.33303592757498224, 'f1-score': 0.3112791126294776, 'support': 1389796}}
[[241153 160394  55994]
 [242165 158158  59325]
 [248944 160122  63541]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.121227
{'0': {'precision': 0.3228148422033755, 'recall': 0.5426323967370192, 'f1-score': 0.40480755763128534, 'support': 154460}, '1': {'precision': 0.356428679093604, 'recall': 0.3384864968031301, 'f1-score': 0.34722596118548255, 'support': 167664}, '2': {'precision': 0.34971067047295734, 'recall': 0.14029082040076016, 'f1-score': 0.20024917383851415, 'support': 161543}, 'accuracy': 0.33748426086543015, 'macro avg': {'precision': 0.3429847305899789, 'recall': 0.34046990464696986, 'f1-score': 0.3174275642184274, 'support': 483667}, 'weighted avg': {'precision': 0.3434502445246344, 'recall': 0.33748426086543015, 'f1-score': 0.31652504966707706, 'support': 483667}}
[[83815 51067 19578]
 [88348 56752 22564]
 [87475 51405 22663]]
training model: results/AAPL/W10/deepLOB_L1/h100
Epoch 1/50
5429/5429 - 88s - loss: 3.2655 - accuracy100: 0.3878 - val_loss: 3.3213 - val_accuracy100: 0.3506 - 88s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 83s - loss: 3.2530 - accuracy100: 0.3949 - val_loss: 3.3437 - val_accuracy100: 0.3418 - 83s/epoch - 15ms/step
Epoch 3/50
5429/5429 - 84s - loss: 3.2465 - accuracy100: 0.3994 - val_loss: 3.3315 - val_accuracy100: 0.3493 - 84s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 84s - loss: 3.2417 - accuracy100: 0.4023 - val_loss: 3.3346 - val_accuracy100: 0.3528 - 84s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 82s - loss: 3.2385 - accuracy100: 0.4046 - val_loss: 3.3416 - val_accuracy100: 0.3500 - 82s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 82s - loss: 3.2356 - accuracy100: 0.4063 - val_loss: 3.3457 - val_accuracy100: 0.3477 - 82s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 85s - loss: 3.2336 - accuracy100: 0.4074 - val_loss: 3.3525 - val_accuracy100: 0.3486 - 85s/epoch - 16ms/step
Epoch 8/50
5429/5429 - 83s - loss: 3.2315 - accuracy100: 0.4088 - val_loss: 3.3520 - val_accuracy100: 0.3408 - 83s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 84s - loss: 3.2297 - accuracy100: 0.4096 - val_loss: 3.3562 - val_accuracy100: 0.3420 - 84s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 83s - loss: 3.2287 - accuracy100: 0.4104 - val_loss: 3.3613 - val_accuracy100: 0.3397 - 83s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 84s - loss: 3.2272 - accuracy100: 0.4107 - val_loss: 3.3619 - val_accuracy100: 0.3389 - 84s/epoch - 16ms/step
testing model: results/AAPL/W10/deepLOB_L1/h100
Evaluating performance on  test set...
22048/22048 - 135s - 135s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1154265
{'0': {'precision': 0.370795315213863, 'recall': 0.2293228039294974, 'f1-score': 0.2833836161792405, 'support': 2102050}, '1': {'precision': 0.24230219859462807, 'recall': 0.3374686190075886, 'f1-score': 0.2820748677224177, 'support': 1398936}, '2': {'precision': 0.37938821588638405, 'recall': 0.42409996444373105, 'f1-score': 0.40050005166642394, 'support': 2143082}, 'accuracy': 0.33008567579270837, 'macro avg': {'precision': 0.3308285765649584, 'recall': 0.33029712912693904, 'f1-score': 0.32198617852269407, 'support': 5644068}, 'weighted avg': {'precision': 0.34220984178728875, 'recall': 0.33008567579270837, 'f1-score': 0.32752895061985143, 'support': 5644068}}
[[482048 728661 891341]
 [331412 472097 595427]
 [486578 747623 908881]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.115622
{'0': {'precision': 0.3355519621650757, 'recall': 0.2100875464566655, 'f1-score': 0.2583951027228519, 'support': 459299}, '1': {'precision': 0.33014651276084944, 'recall': 0.5749063343699432, 'f1-score': 0.4194303615707657, 'support': 458546}, '2': {'precision': 0.3387305998011418, 'recall': 0.21799720733720238, 'f1-score': 0.2652726299980018, 'support': 471951}, 'accuracy': 0.33314097896381917, 'macro avg': {'precision': 0.334809691575689, 'recall': 0.33433036272127037, 'f1-score': 0.3143660314305398, 'support': 1389796}, 'weighted avg': {'precision': 0.3348479120803645, 'recall': 0.33314097896381917, 'f1-score': 0.3138621854304649, 'support': 1389796}}
[[ 96493 262992  99814]
 [ 93889 263621 101036]
 [ 97183 271884 102884]]
Evaluating performance on  val set...
1890/1890 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1074634
{'0': {'precision': 0.32697175687590657, 'recall': 0.22899181982364814, 'f1-score': 0.26934806802428873, 'support': 150608}, '1': {'precision': 0.370540668511312, 'recall': 0.5721556150862783, 'f1-score': 0.4497883948316701, 'support': 175073}, '2': {'precision': 0.3275139535314951, 'recall': 0.22359576164976644, 'f1-score': 0.2657573614601044, 'support': 157986}, 'accuracy': 0.35144427881166174, 'macro avg': {'precision': 0.34167545963957124, 'recall': 0.34158106551989764, 'f1-score': 0.3282979414386878, 'support': 483667}, 'weighted avg': {'precision': 0.34291950511503627, 'recall': 0.35144427881166174, 'f1-score': 0.33348919811565214, 'support': 483667}}
[[ 34488  83016  33104]
 [ 35475 100169  39429]
 [ 35514  87147  35325]]
training model: results/AAPL/W10/deepLOB_L1/h200
Epoch 1/50
5429/5429 - 84s - loss: 3.2675 - accuracy200: 0.3862 - val_loss: 3.2957 - val_accuracy200: 0.3637 - 84s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 84s - loss: 3.2522 - accuracy200: 0.3940 - val_loss: 3.3725 - val_accuracy200: 0.3456 - 84s/epoch - 16ms/step
Epoch 3/50
5429/5429 - 82s - loss: 3.2455 - accuracy200: 0.3996 - val_loss: 3.3797 - val_accuracy200: 0.3603 - 82s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 81s - loss: 3.2412 - accuracy200: 0.4025 - val_loss: 3.3964 - val_accuracy200: 0.3525 - 81s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 84s - loss: 3.2372 - accuracy200: 0.4051 - val_loss: 3.3670 - val_accuracy200: 0.3586 - 84s/epoch - 16ms/step
Epoch 6/50
5429/5429 - 85s - loss: 3.2338 - accuracy200: 0.4069 - val_loss: 3.3656 - val_accuracy200: 0.3566 - 85s/epoch - 16ms/step
Epoch 7/50
5429/5429 - 83s - loss: 3.2300 - accuracy200: 0.4090 - val_loss: 3.3676 - val_accuracy200: 0.3504 - 83s/epoch - 15ms/step
Epoch 8/50
5429/5429 - 84s - loss: 3.2276 - accuracy200: 0.4100 - val_loss: 3.3600 - val_accuracy200: 0.3486 - 84s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 84s - loss: 3.2257 - accuracy200: 0.4113 - val_loss: 3.3319 - val_accuracy200: 0.3512 - 84s/epoch - 16ms/step
Epoch 10/50
5429/5429 - 81s - loss: 3.2241 - accuracy200: 0.4124 - val_loss: 3.3429 - val_accuracy200: 0.3505 - 81s/epoch - 15ms/step
Epoch 11/50
5429/5429 - 84s - loss: 3.2211 - accuracy200: 0.4137 - val_loss: 3.3375 - val_accuracy200: 0.3455 - 84s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h200
Evaluating performance on  test set...
22048/22048 - 149s - 149s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1060026
{'0': {'precision': 0.36667035051193564, 'recall': 0.29176041525324764, 'f1-score': 0.3249541160249141, 'support': 2115143}, '1': {'precision': 0.23143335908840762, 'recall': 0.23864113968564396, 'f1-score': 0.23498198995338984, 'support': 1413302}, '2': {'precision': 0.37250162358021605, 'recall': 0.44083563092290073, 'f1-score': 0.4037980243536481, 'support': 2115623}, 'accuracy': 0.3343384594232387, 'macro avg': {'precision': 0.32353511106018645, 'recall': 0.3237457286205974, 'f1-score': 0.32124471011065064, 'support': 5644068}, 'weighted avg': {'precision': 0.3349921469484208, 'recall': 0.3343384594232387, 'f1-score': 0.33197851759998787, 'support': 5644068}}
[[617115 554889 943139]
 [448085 337272 627945]
 [617824 565157 932642]]
Evaluating performance on  train set...
5429/5429 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071591
{'0': {'precision': 0.3450649843592529, 'recall': 0.1140654305684451, 'f1-score': 0.17145449194965753, 'support': 462261}, '1': {'precision': 0.3343375725655895, 'recall': 0.7012092229238025, 'f1-score': 0.45278608455768043, 'support': 456905}, '2': {'precision': 0.3405437017210883, 'recall': 0.2016786010241591, 'f1-score': 0.25332922309898326, 'support': 470630}, 'accuracy': 0.33676165422839033, 'macro avg': {'precision': 0.33998208621531023, 'recall': 0.33898441817213554, 'f1-score': 0.2925232665354404, 'support': 1389796}, 'weighted avg': {'precision': 0.34000722096550073, 'recall': 0.33676165422839033, 'f1-score': 0.29166962858940604, 'support': 1389796}}
[[ 52728 316716  92817]
 [ 45533 320386  90986]
 [ 54545 321169  94916]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986867
{'0': {'precision': 0.3570954086616737, 'recall': 0.1799221667311996, 'f1-score': 0.2392822231531909, 'support': 152377}, '1': {'precision': 0.3768951227287217, 'recall': 0.6870398456612566, 'f1-score': 0.4867627714913265, 'support': 172089}, '2': {'precision': 0.330693621770109, 'recall': 0.19357918606038907, 'f1-score': 0.2442064558050342, 'support': 159201}, 'accuracy': 0.3648501965195062, 'macro avg': {'precision': 0.3548947177201682, 'recall': 0.35351373281761506, 'f1-score': 0.32341715014985056, 'support': 483667}, 'weighted avg': {'precision': 0.35544990073816485, 'recall': 0.3648501965195062, 'f1-score': 0.32895677784757266, 'support': 483667}}
[[ 27416  96040  28921]
 [ 20404 118232  33453]
 [ 28955  99428  30818]]
training model: results/AAPL/W10/deepLOB_L1/h300
Epoch 1/50
5429/5429 - 84s - loss: 3.2581 - accuracy300: 0.3911 - val_loss: 3.8284 - val_accuracy300: 0.3184 - 84s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 85s - loss: 3.2347 - accuracy300: 0.4044 - val_loss: 3.5326 - val_accuracy300: 0.3383 - 85s/epoch - 16ms/step
Epoch 3/50
5429/5429 - 83s - loss: 3.2259 - accuracy300: 0.4094 - val_loss: 3.4849 - val_accuracy300: 0.3544 - 83s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 85s - loss: 3.2195 - accuracy300: 0.4126 - val_loss: 3.3815 - val_accuracy300: 0.3530 - 85s/epoch - 16ms/step
Epoch 5/50
5429/5429 - 84s - loss: 3.2157 - accuracy300: 0.4144 - val_loss: 3.4591 - val_accuracy300: 0.3444 - 84s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 83s - loss: 3.2119 - accuracy300: 0.4164 - val_loss: 3.5049 - val_accuracy300: 0.3414 - 83s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 84s - loss: 3.2073 - accuracy300: 0.4183 - val_loss: 3.5886 - val_accuracy300: 0.3459 - 84s/epoch - 16ms/step
Epoch 8/50
5429/5429 - 82s - loss: 3.2034 - accuracy300: 0.4199 - val_loss: 3.4924 - val_accuracy300: 0.3431 - 82s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 83s - loss: 3.1997 - accuracy300: 0.4218 - val_loss: 3.4490 - val_accuracy300: 0.3422 - 83s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 85s - loss: 3.1961 - accuracy300: 0.4237 - val_loss: 3.4876 - val_accuracy300: 0.3405 - 85s/epoch - 16ms/step
Epoch 11/50
5429/5429 - 84s - loss: 3.1934 - accuracy300: 0.4250 - val_loss: 3.4703 - val_accuracy300: 0.3499 - 84s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 83s - loss: 3.1906 - accuracy300: 0.4262 - val_loss: 3.4782 - val_accuracy300: 0.3478 - 83s/epoch - 15ms/step
Epoch 13/50
5429/5429 - 83s - loss: 3.1879 - accuracy300: 0.4276 - val_loss: 3.5014 - val_accuracy300: 0.3552 - 83s/epoch - 15ms/step
Epoch 14/50
5429/5429 - 83s - loss: 3.1857 - accuracy300: 0.4281 - val_loss: 3.5193 - val_accuracy300: 0.3456 - 83s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h300
Evaluating performance on  test set...
22048/22048 - 129s - 129s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1407058
{'0': {'precision': 0.38628224109717135, 'recall': 0.29296610898720327, 'f1-score': 0.333214221664396, 'support': 2115074}, '1': {'precision': 0.25765887045028496, 'recall': 0.34370011097521835, 'f1-score': 0.2945241863939231, 'support': 1430049}, '2': {'precision': 0.36709012728204693, 'recall': 0.3729325923261448, 'f1-score': 0.3699882967298908, 'support': 2098945}, 'accuracy': 0.33555903295282763, 'macro avg': {'precision': 0.33701041294316775, 'recall': 0.3365329374295221, 'f1-score': 0.33257556826273665, 'support': 5644068}, 'weighted avg': {'precision': 0.346555413939544, 'recall': 0.33555903295282763, 'f1-score': 0.3370869805928569, 'support': 5644068}}
[[619645 702474 792955]
 [381910 491508 556631]
 [602570 713610 782765]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.144873
{'0': {'precision': 0.33366468469463517, 'recall': 0.11718473885196583, 'f1-score': 0.1734521855766455, 'support': 464028}, '1': {'precision': 0.32947520460582197, 'recall': 0.8562458937409663, 'f1-score': 0.4758484797589229, 'support': 456620}, '2': {'precision': 0.36040343668285396, 'recall': 0.030847408493694953, 'f1-score': 0.05683060967636162, 'support': 469148}, 'accuracy': 0.330860068671949, 'macro avg': {'precision': 0.3411811086611037, 'recall': 0.33475934702887566, 'f1-score': 0.23537709167064336, 'support': 1389796}, 'weighted avg': {'precision': 0.34131431933138406, 'recall': 0.330860068671949, 'f1-score': 0.23343754800324992, 'support': 1389796}}
[[ 54377 396158  13493]
 [ 53451 390979  12190]
 [ 55141 399535  14472]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1295091
{'0': {'precision': 0.3235549649920785, 'recall': 0.12348271580056043, 'f1-score': 0.17874755307935553, 'support': 153811}, '1': {'precision': 0.3550124962536009, 'recall': 0.8491581055300795, 'f1-score': 0.5006960613582018, 'support': 168786}, '2': {'precision': 0.3835726053188986, 'recall': 0.050592909914943814, 'f1-score': 0.08939472890327181, 'support': 161070}, 'accuracy': 0.3524491023782892, 'macro avg': {'precision': 0.3540466888548593, 'recall': 0.34107791041519464, 'f1-score': 0.2562794477802764, 'support': 483667}, 'weighted avg': {'precision': 0.35451972421474254, 'recall': 0.3524491023782892, 'f1-score': 0.2613422753331201, 'support': 483667}}
[[ 18993 127532   7286]
 [ 19650 143326   5810]
 [ 20058 132863   8149]]
training model: results/AAPL/W10/deepLOB_L1/h500
Epoch 1/50
5429/5429 - 87s - loss: 3.2414 - accuracy500: 0.4022 - val_loss: 3.3554 - val_accuracy500: 0.3472 - 87s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 85s - loss: 3.2059 - accuracy500: 0.4214 - val_loss: 3.3500 - val_accuracy500: 0.3613 - 85s/epoch - 16ms/step
Epoch 3/50
5429/5429 - 83s - loss: 3.1931 - accuracy500: 0.4281 - val_loss: 3.3652 - val_accuracy500: 0.3529 - 83s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 82s - loss: 3.1834 - accuracy500: 0.4324 - val_loss: 3.3890 - val_accuracy500: 0.3466 - 82s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 85s - loss: 3.1753 - accuracy500: 0.4356 - val_loss: 3.4762 - val_accuracy500: 0.3409 - 85s/epoch - 16ms/step
Epoch 6/50
5429/5429 - 83s - loss: 3.1685 - accuracy500: 0.4376 - val_loss: 3.3779 - val_accuracy500: 0.3525 - 83s/epoch - 15ms/step
Epoch 7/50
5429/5429 - 82s - loss: 3.1625 - accuracy500: 0.4397 - val_loss: 3.3743 - val_accuracy500: 0.3433 - 82s/epoch - 15ms/step
Epoch 8/50
5429/5429 - 83s - loss: 3.1584 - accuracy500: 0.4414 - val_loss: 3.4211 - val_accuracy500: 0.3351 - 83s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 83s - loss: 3.1544 - accuracy500: 0.4428 - val_loss: 3.3782 - val_accuracy500: 0.3461 - 83s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 85s - loss: 3.1512 - accuracy500: 0.4439 - val_loss: 3.3567 - val_accuracy500: 0.3342 - 85s/epoch - 16ms/step
Epoch 11/50
5429/5429 - 82s - loss: 3.1480 - accuracy500: 0.4450 - val_loss: 3.3588 - val_accuracy500: 0.3377 - 82s/epoch - 15ms/step
Epoch 12/50
5429/5429 - 82s - loss: 3.1447 - accuracy500: 0.4464 - val_loss: 3.3676 - val_accuracy500: 0.3345 - 82s/epoch - 15ms/step
testing model: results/AAPL/W10/deepLOB_L1/h500
Evaluating performance on  test set...
22048/22048 - 118s - 118s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1330179
{'0': {'precision': 0.36320927000002085, 'recall': 0.1629613537178219, 'f1-score': 0.22498053541584723, 'support': 2135807}, '1': {'precision': 0.24690001561496597, 'recall': 0.33825122173920125, 'f1-score': 0.285444946871547, 'support': 1411717}, '2': {'precision': 0.3722959045727958, 'recall': 0.4886451226399255, 'f1-score': 0.42260868560830445, 'support': 2096544}, 'accuracy': 0.32778396716694413, 'macro avg': {'precision': 0.32746839672926087, 'recall': 0.3299525660323162, 'f1-score': 0.3110113892985662, 'support': 5644068}, 'weighted avg': {'precision': 0.33749285012716274, 'recall': 0.32778396716694413, 'f1-score': 0.31351503749202725, 'support': 5644068}}
[[ 348054  729664 1058089]
 [ 265005  477515  669197]
 [ 345215  726863 1024466]]
Evaluating performance on  train set...
5429/5429 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1299044
{'0': {'precision': 0.3387328594180942, 'recall': 0.16865305350565402, 'f1-score': 0.22518690254669516, 'support': 465334}, '1': {'precision': 0.3308150052278205, 'recall': 0.7859680790007492, 'f1-score': 0.46564106823508644, 'support': 456502}, '2': {'precision': 0.33867830864852366, 'recall': 0.05321394991024874, 'f1-score': 0.09197635400295852, 'support': 467960}, 'accuracy': 0.3325509643141871, 'macro avg': {'precision': 0.33607539109814616, 'recall': 0.3359450274722173, 'f1-score': 0.26093477492824674, 'support': 1389796}, 'weighted avg': {'precision': 0.3361137384451625, 'recall': 0.3325509643141871, 'f1-score': 0.2593146444948336, 'support': 1389796}}
[[ 78480 362469  24385]
 [ 73466 358796  24240]
 [ 79741 363317  24902]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.118213
{'0': {'precision': 0.33189337730145646, 'recall': 0.19913208642203287, 'f1-score': 0.24891695486040977, 'support': 151628}, '1': {'precision': 0.3689431850016754, 'recall': 0.7769410512678142, 'f1-score': 0.5003072682917745, 'support': 172896}, '2': {'precision': 0.3510385341632282, 'recall': 0.0630816309859686, 'f1-score': 0.10694520642800455, 'support': 159143}, 'accuracy': 0.3609156713193168, 'macro avg': {'precision': 0.3506250321554534, 'recall': 0.3463849228919385, 'f1-score': 0.28538980986006296, 'support': 483667}, 'weighted avg': {'precision': 0.35143695015341864, 'recall': 0.3609156713193168, 'f1-score': 0.29206765497071496, 'support': 483667}}
[[ 30194 112396   9038]
 [ 29045 134330   9521]
 [ 31736 117368  10039]]
training model: results/AAPL/W10/deepLOB_L1/h1000
Epoch 1/50
5429/5429 - 86s - loss: 3.2014 - accuracy1000: 0.4239 - val_loss: 3.4420 - val_accuracy1000: 0.3454 - 86s/epoch - 16ms/step
Epoch 2/50
5429/5429 - 85s - loss: 3.1458 - accuracy1000: 0.4492 - val_loss: 3.3234 - val_accuracy1000: 0.3594 - 85s/epoch - 16ms/step
Epoch 3/50
5429/5429 - 84s - loss: 3.1218 - accuracy1000: 0.4587 - val_loss: 3.3724 - val_accuracy1000: 0.3547 - 84s/epoch - 15ms/step
Epoch 4/50
5429/5429 - 84s - loss: 3.1097 - accuracy1000: 0.4620 - val_loss: 3.4101 - val_accuracy1000: 0.3483 - 84s/epoch - 15ms/step
Epoch 5/50
5429/5429 - 83s - loss: 3.0971 - accuracy1000: 0.4659 - val_loss: 3.3998 - val_accuracy1000: 0.3457 - 83s/epoch - 15ms/step
Epoch 6/50
5429/5429 - 84s - loss: 3.0870 - accuracy1000: 0.4685 - val_loss: 3.5033 - val_accuracy1000: 0.3321 - 84s/epoch - 16ms/step
Epoch 7/50
5429/5429 - 86s - loss: 3.0801 - accuracy1000: 0.4707 - val_loss: 3.3946 - val_accuracy1000: 0.3487 - 86s/epoch - 16ms/step
Epoch 8/50
5429/5429 - 82s - loss: 3.0741 - accuracy1000: 0.4722 - val_loss: 3.4018 - val_accuracy1000: 0.3413 - 82s/epoch - 15ms/step
Epoch 9/50
5429/5429 - 83s - loss: 3.0693 - accuracy1000: 0.4739 - val_loss: 3.4752 - val_accuracy1000: 0.3393 - 83s/epoch - 15ms/step
Epoch 10/50
5429/5429 - 85s - loss: 3.0653 - accuracy1000: 0.4750 - val_loss: 3.5035 - val_accuracy1000: 0.3325 - 85s/epoch - 16ms/step
Epoch 11/50
5429/5429 - 87s - loss: 3.0614 - accuracy1000: 0.4758 - val_loss: 3.4782 - val_accuracy1000: 0.3343 - 87s/epoch - 16ms/step
Epoch 12/50
5429/5429 - 85s - loss: 3.0570 - accuracy1000: 0.4769 - val_loss: 3.5673 - val_accuracy1000: 0.3299 - 85s/epoch - 16ms/step
testing model: results/AAPL/W10/deepLOB_L1/h1000
Evaluating performance on  test set...
22048/22048 - 151s - 151s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1203923
{'0': {'precision': 0.378683956138164, 'recall': 0.3161997813546922, 'f1-score': 0.3446325699474246, 'support': 2156918}, '1': {'precision': 0.2410295846646861, 'recall': 0.22669275413295814, 'f1-score': 0.2336414399860429, 'support': 1364640}, '2': {'precision': 0.37379765430265904, 'recall': 0.4507705499620732, 'f1-score': 0.4086914177215731, 'support': 2122510}, 'accuracy': 0.34516522479885076, 'macro avg': {'precision': 0.33117039836850304, 'recall': 0.3312210284832412, 'f1-score': 0.3289884758850135, 'support': 5644068}, 'weighted avg': {'precision': 0.3435639175425191, 'recall': 0.34516522479885076, 'f1-score': 0.341886786126005, 'support': 5644068}}
[[682017 487555 987346]
 [439817 309354 615469]
 [679185 486560 956765]]
Evaluating performance on  train set...
5429/5429 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1129491
{'0': {'precision': 0.33691874821597667, 'recall': 0.16075203963837764, 'f1-score': 0.21765543523915873, 'support': 462582}, '1': {'precision': 0.33314431500054126, 'recall': 0.7329218601500966, 'f1-score': 0.45807428608102074, 'support': 457705}, '2': {'precision': 0.33852464072040955, 'recall': 0.1168987175964678, 'f1-score': 0.17378597585012961, 'support': 469509}, 'accuracy': 0.3343713753673201, 'macro avg': {'precision': 0.3361959013123091, 'recall': 0.336857539128314, 'f1-score': 0.2831718990567697, 'support': 1389796}, 'weighted avg': {'precision': 0.33621821664802926, 'recall': 0.3343713753673201, 'f1-score': 0.2820129410287068, 'support': 1389796}}
[[ 74361 334043  54178]
 [ 69176 335462  53067]
 [ 77172 337452  54885]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1083709
{'0': {'precision': 0.33757664622767264, 'recall': 0.20125028144577037, 'f1-score': 0.25216777994440526, 'support': 151006}, '1': {'precision': 0.36950767280875435, 'recall': 0.7149587266572406, 'f1-score': 0.48721239380309844, 'support': 170449}, '2': {'precision': 0.3420788822405313, 'recall': 0.13463245629176632, 'f1-score': 0.19321931927769467, 'support': 162212}, 'accuracy': 0.35994392836393635, 'macro avg': {'precision': 0.3497210670923194, 'recall': 0.3502804881315924, 'f1-score': 0.3108664976750661, 'support': 483667}, 'weighted avg': {'precision': 0.35033941122474005, 'recall': 0.35994392836393635, 'f1-score': 0.3152297041317737, 'support': 483667}}
[[ 30390 100685  19931]
 [ 26513 121864  22072]
 [ 33121 107252  21839]]
training model: results/AAPL/W10/deepOF_L1/h10
Epoch 1/50
5429/5429 - 80s - loss: 3.2177 - accuracy10: 0.4173 - val_loss: 3.3507 - val_accuracy10: 0.3745 - 80s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 77s - loss: 3.2000 - accuracy10: 0.4245 - val_loss: 3.3179 - val_accuracy10: 0.3763 - 77s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 76s - loss: 3.1939 - accuracy10: 0.4270 - val_loss: 3.3107 - val_accuracy10: 0.3771 - 76s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 75s - loss: 3.1898 - accuracy10: 0.4287 - val_loss: 3.2992 - val_accuracy10: 0.3782 - 75s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 76s - loss: 3.1863 - accuracy10: 0.4307 - val_loss: 3.3049 - val_accuracy10: 0.3786 - 76s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 75s - loss: 3.1831 - accuracy10: 0.4318 - val_loss: 3.3015 - val_accuracy10: 0.3808 - 75s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 75s - loss: 3.1802 - accuracy10: 0.4334 - val_loss: 3.3022 - val_accuracy10: 0.3812 - 75s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 73s - loss: 3.1777 - accuracy10: 0.4343 - val_loss: 3.3046 - val_accuracy10: 0.3816 - 73s/epoch - 13ms/step
Epoch 9/50
5429/5429 - 73s - loss: 3.1754 - accuracy10: 0.4356 - val_loss: 3.3059 - val_accuracy10: 0.3832 - 73s/epoch - 13ms/step
Epoch 10/50
5429/5429 - 73s - loss: 3.1732 - accuracy10: 0.4363 - val_loss: 3.3125 - val_accuracy10: 0.3817 - 73s/epoch - 13ms/step
Epoch 11/50
5429/5429 - 73s - loss: 3.1721 - accuracy10: 0.4365 - val_loss: 3.3073 - val_accuracy10: 0.3842 - 73s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 76s - loss: 3.1701 - accuracy10: 0.4375 - val_loss: 3.3148 - val_accuracy10: 0.3835 - 76s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 76s - loss: 3.1688 - accuracy10: 0.4381 - val_loss: 3.3118 - val_accuracy10: 0.3845 - 76s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 76s - loss: 3.1674 - accuracy10: 0.4390 - val_loss: 3.3111 - val_accuracy10: 0.3854 - 76s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h10
Evaluating performance on  test set...
22048/22048 - 139s - 139s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0655
{'0': {'precision': 0.4257725751683727, 'recall': 0.595205900258467, 'f1-score': 0.49643034600217006, 'support': 2146889}, '1': {'precision': 0.2636922254875768, 'recall': 0.000748149523784257, 'f1-score': 0.0014920657476428533, 'support': 1319255}, '2': {'precision': 0.4358951623873523, 'recall': 0.5281954930371607, 'f1-score': 0.4776269926780306, 'support': 2177919}, 'accuracy': 0.43039827868682545, 'macro avg': {'precision': 0.3751199876811006, 'recall': 0.3747165142731373, 'f1-score': 0.3251831348092812, 'support': 5644063}, 'weighted avg': {'precision': 0.39179366021211415, 'recall': 0.43039827868682545, 'f1-score': 0.3734866472189455, 'support': 5644063}}
[[1277841    1480  867568]
 [ 697112     987  621156]
 [1026276    1276 1150367]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0865549
{'0': {'precision': 0.39196026395930916, 'recall': 0.6332458799035485, 'f1-score': 0.48420939286010106, 'support': 461579}, '1': {'precision': 0.38445807770961143, 'recall': 0.0008171923357791147, 'f1-score': 0.00163091804203084, 'support': 460112}, '2': {'precision': 0.4053811561570901, 'recall': 0.556925384102678, 'f1-score': 0.4692206623470122, 'support': 468104}, 'accuracy': 0.3981651970254606, 'macro avg': {'precision': 0.39393316594200356, 'recall': 0.3969961521140019, 'f1-score': 0.31835365774971475, 'support': 1389795}, 'weighted avg': {'precision': 0.3939969149773579, 'recall': 0.3981651970254606, 'f1-score': 0.3193962859532617, 'support': 1389795}}
[[292293    341 168945]
 [246284    376 213452]
 [207144    261 260699]]
Evaluating performance on  val set...
1890/1890 - 9s - 9s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0985742
{'0': {'precision': 0.37283637341856013, 'recall': 0.6068739706689671, 'f1-score': 0.4619011970463075, 'support': 153012}, '1': {'precision': 0.4205607476635514, 'recall': 0.0007713007558747408, 'f1-score': 0.0015397775876817795, 'support': 175029}, '2': {'precision': 0.38418165909042407, 'recall': 0.5783609422590056, 'f1-score': 0.4616848460289656, 'support': 155626}, 'accuracy': 0.37836362621390335, 'macro avg': {'precision': 0.3925262600575119, 'recall': 0.39533540456128247, 'f1-score': 0.3083752735543183, 'support': 483667}, 'weighted avg': {'precision': 0.3937573188783415, 'recall': 0.37836362621390335, 'f1-score': 0.2952363868983159, 'support': 483667}}
[[92859    93 60060]
 [90677   135 84217]
 [65525    93 90008]]
training model: results/AAPL/W10/deepOF_L1/h20
Epoch 1/50
5429/5429 - 81s - loss: 3.2363 - accuracy20: 0.4070 - val_loss: 3.2872 - val_accuracy20: 0.3781 - 81s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 77s - loss: 3.2219 - accuracy20: 0.4125 - val_loss: 3.2724 - val_accuracy20: 0.3798 - 77s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 74s - loss: 3.2180 - accuracy20: 0.4139 - val_loss: 3.2653 - val_accuracy20: 0.3807 - 74s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 76s - loss: 3.2155 - accuracy20: 0.4152 - val_loss: 3.2645 - val_accuracy20: 0.3817 - 76s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 75s - loss: 3.2130 - accuracy20: 0.4162 - val_loss: 3.2666 - val_accuracy20: 0.3817 - 75s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 78s - loss: 3.2109 - accuracy20: 0.4171 - val_loss: 3.2617 - val_accuracy20: 0.3829 - 78s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 78s - loss: 3.2087 - accuracy20: 0.4178 - val_loss: 3.2617 - val_accuracy20: 0.3834 - 78s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 74s - loss: 3.2069 - accuracy20: 0.4189 - val_loss: 3.2632 - val_accuracy20: 0.3837 - 74s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 75s - loss: 3.2049 - accuracy20: 0.4197 - val_loss: 3.2601 - val_accuracy20: 0.3847 - 75s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 75s - loss: 3.2035 - accuracy20: 0.4209 - val_loss: 3.2596 - val_accuracy20: 0.3852 - 75s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 74s - loss: 3.2019 - accuracy20: 0.4218 - val_loss: 3.2604 - val_accuracy20: 0.3851 - 74s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 76s - loss: 3.2003 - accuracy20: 0.4222 - val_loss: 3.2605 - val_accuracy20: 0.3856 - 76s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 77s - loss: 3.1989 - accuracy20: 0.4230 - val_loss: 3.2601 - val_accuracy20: 0.3860 - 77s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 74s - loss: 3.1976 - accuracy20: 0.4235 - val_loss: 3.2591 - val_accuracy20: 0.3860 - 74s/epoch - 14ms/step
Epoch 15/50
5429/5429 - 75s - loss: 3.1967 - accuracy20: 0.4240 - val_loss: 3.2563 - val_accuracy20: 0.3872 - 75s/epoch - 14ms/step
Epoch 16/50
5429/5429 - 74s - loss: 3.1958 - accuracy20: 0.4244 - val_loss: 3.2540 - val_accuracy20: 0.3874 - 74s/epoch - 14ms/step
Epoch 17/50
5429/5429 - 76s - loss: 3.1948 - accuracy20: 0.4248 - val_loss: 3.2545 - val_accuracy20: 0.3873 - 76s/epoch - 14ms/step
Epoch 18/50
5429/5429 - 73s - loss: 3.1936 - accuracy20: 0.4253 - val_loss: 3.2558 - val_accuracy20: 0.3873 - 73s/epoch - 13ms/step
Epoch 19/50
5429/5429 - 74s - loss: 3.1928 - accuracy20: 0.4257 - val_loss: 3.2589 - val_accuracy20: 0.3879 - 74s/epoch - 14ms/step
Epoch 20/50
5429/5429 - 76s - loss: 3.1920 - accuracy20: 0.4261 - val_loss: 3.2585 - val_accuracy20: 0.3879 - 76s/epoch - 14ms/step
Epoch 21/50
5429/5429 - 73s - loss: 3.1914 - accuracy20: 0.4259 - val_loss: 3.2552 - val_accuracy20: 0.3887 - 73s/epoch - 13ms/step
Epoch 22/50
5429/5429 - 77s - loss: 3.1906 - accuracy20: 0.4263 - val_loss: 3.2585 - val_accuracy20: 0.3881 - 77s/epoch - 14ms/step
Epoch 23/50
5429/5429 - 74s - loss: 3.1897 - accuracy20: 0.4272 - val_loss: 3.2562 - val_accuracy20: 0.3881 - 74s/epoch - 14ms/step
Epoch 24/50
5429/5429 - 73s - loss: 3.1889 - accuracy20: 0.4272 - val_loss: 3.2595 - val_accuracy20: 0.3876 - 73s/epoch - 14ms/step
Epoch 25/50
5429/5429 - 74s - loss: 3.1885 - accuracy20: 0.4274 - val_loss: 3.2587 - val_accuracy20: 0.3879 - 74s/epoch - 14ms/step
Epoch 26/50
5429/5429 - 75s - loss: 3.1876 - accuracy20: 0.4276 - val_loss: 3.2601 - val_accuracy20: 0.3876 - 75s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h20
Evaluating performance on  test set...
22048/22048 - 144s - 144s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0712574
{'0': {'precision': 0.4208898347524648, 'recall': 0.6033837104307863, 'f1-score': 0.4958793895826091, 'support': 2075414}, '1': {'precision': 0.31932112947454233, 'recall': 0.01493676678592229, 'f1-score': 0.028538594265919075, 'support': 1442280}, '2': {'precision': 0.4368374476800866, 'recall': 0.534407245402844, 'f1-score': 0.4807214881401485, 'support': 2126369}, 'accuracy': 0.42702588543040715, 'macro avg': {'precision': 0.39234947063569797, 'recall': 0.3842425742065176, 'f1-score': 0.3350464906628922, 'support': 5644063}, 'weighted avg': {'precision': 0.40094321075217493, 'recall': 0.42702588543040715, 'f1-score': 0.3707447881435998, 'support': 5644063}}
[[1252271   24775  798368]
 [ 754148   21543  666589]
 [ 968875   21147 1136347]]
Evaluating performance on  train set...
5429/5429 - 38s - 38s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0788323
{'0': {'precision': 0.39531034254445435, 'recall': 0.6235270312608786, 'f1-score': 0.4838587406601366, 'support': 459616}, '1': {'precision': 0.40500421339210474, 'recall': 0.013630820314460057, 'f1-score': 0.026373997467285772, 'support': 458373}, '2': {'precision': 0.4076185959276945, 'recall': 0.5610611141019826, 'f1-score': 0.47218691832178783, 'support': 471806}, 'accuracy': 0.40116923718965747, 'macro avg': {'precision': 0.40264438395475116, 'recall': 0.3994063218924404, 'f1-score': 0.3274732188164034, 'support': 1389795}, 'weighted avg': {'precision': 0.40268590257869186, 'recall': 0.40116923718965747, 'f1-score': 0.329011809996475, 'support': 1389795}}
[[286583   4763 168270]
 [235696   6248 216429]
 [202678   4416 264712]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0838646
{'0': {'precision': 0.37961668108221713, 'recall': 0.6129929122449779, 'f1-score': 0.46886980830670927, 'support': 153222}, '1': {'precision': 0.4428552509601377, 'recall': 0.019389666189269582, 'f1-score': 0.03715266590376304, 'support': 172463}, '2': {'precision': 0.3944721860269876, 'recall': 0.5710460685394538, 'f1-score': 0.4666132202337851, 'support': 157982}, 'accuracy': 0.38762826490126473, 'macro avg': {'precision': 0.40564803935644744, 'recall': 0.40114288232456713, 'f1-score': 0.32421189814808576, 'support': 483667}, 'weighted avg': {'precision': 0.4070182111825559, 'recall': 0.38762826490126473, 'f1-score': 0.31419369059105773, 'support': 483667}}
[[93924  2214 57084]
 [87720  3344 81399]
 [65774  1993 90215]]
training model: results/AAPL/W10/deepOF_L1/h30
Epoch 1/50
5429/5429 - 79s - loss: 3.2442 - accuracy30: 0.4027 - val_loss: 3.3533 - val_accuracy30: 0.3643 - 79s/epoch - 14ms/step
Epoch 2/50
5429/5429 - 74s - loss: 3.2322 - accuracy30: 0.4078 - val_loss: 3.3306 - val_accuracy30: 0.3664 - 74s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 75s - loss: 3.2296 - accuracy30: 0.4085 - val_loss: 3.3191 - val_accuracy30: 0.3665 - 75s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 75s - loss: 3.2271 - accuracy30: 0.4098 - val_loss: 3.3166 - val_accuracy30: 0.3671 - 75s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 74s - loss: 3.2253 - accuracy30: 0.4101 - val_loss: 3.3172 - val_accuracy30: 0.3673 - 74s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 74s - loss: 3.2235 - accuracy30: 0.4116 - val_loss: 3.3191 - val_accuracy30: 0.3678 - 74s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 75s - loss: 3.2216 - accuracy30: 0.4122 - val_loss: 3.3185 - val_accuracy30: 0.3673 - 75s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 74s - loss: 3.2199 - accuracy30: 0.4131 - val_loss: 3.3191 - val_accuracy30: 0.3683 - 74s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 76s - loss: 3.2184 - accuracy30: 0.4139 - val_loss: 3.3213 - val_accuracy30: 0.3675 - 76s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 76s - loss: 3.2169 - accuracy30: 0.4143 - val_loss: 3.3223 - val_accuracy30: 0.3682 - 76s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 76s - loss: 3.2156 - accuracy30: 0.4151 - val_loss: 3.3248 - val_accuracy30: 0.3683 - 76s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 74s - loss: 3.2146 - accuracy30: 0.4154 - val_loss: 3.3235 - val_accuracy30: 0.3679 - 74s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 74s - loss: 3.2131 - accuracy30: 0.4168 - val_loss: 3.3255 - val_accuracy30: 0.3688 - 74s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 76s - loss: 3.2120 - accuracy30: 0.4169 - val_loss: 3.3242 - val_accuracy30: 0.3688 - 76s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h30
Evaluating performance on  test set...
22048/22048 - 153s - 153s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0767347
{'0': {'precision': 0.40606204727278905, 'recall': 0.6445462339805259, 'f1-score': 0.4982366272991391, 'support': 2039939}, '1': {'precision': 0.2434881087202718, 'recall': 0.00014233216885758905, 'f1-score': 0.00028449803299383233, 'support': 1510551}, '2': {'precision': 0.43209218494365254, 'recall': 0.4964016062492208, 'f1-score': 0.4620197931064223, 'support': 2093573}, 'accuracy': 0.4171291142568749, 'macro avg': {'precision': 0.3605474469789045, 'recall': 0.3803633907995348, 'f1-score': 0.3201803061461851, 'support': 5644063}, 'weighted avg': {'precision': 0.3722069623737649, 'recall': 0.4171291142568749, 'f1-score': 0.351532971966721, 'support': 5644063}}
[[1314835     377  724727]
 [ 869151     215  641185]
 [1054029     291 1039253]]
Evaluating performance on  train set...
5429/5429 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0901914
{'0': {'precision': 0.382904813586267, 'recall': 0.6565344166693968, 'f1-score': 0.48370348378313793, 'support': 457845}, '1': {'precision': 0.365296803652968, 'recall': 0.0001746126327874506, 'f1-score': 0.00034905841492573783, 'support': 458157}, '2': {'precision': 0.40757392299701595, 'recall': 0.5200541164601419, 'f1-score': 0.4569945870554861, 'support': 473793}, 'accuracy': 0.3936328739130591, 'macro avg': {'precision': 0.3852585134120836, 'recall': 0.39225438192077533, 'f1-score': 0.31368237641784996, 'support': 1389795}, 'weighted avg': {'precision': 0.3855101031059706, 'recall': 0.3936328739130591, 'f1-score': 0.31525655328568447, 'support': 1389795}}
[[300591     70 157184]
 [257111     80 200966]
 [227326     69 246398]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1037683
{'0': {'precision': 0.35471162995627337, 'recall': 0.6566031787371408, 'f1-score': 0.46059798939407787, 'support': 145907}, '1': {'precision': 0.41379310344827586, 'recall': 0.00012923931890878934, 'f1-score': 0.00025839793281653745, 'support': 185702}, '2': {'precision': 0.3836138664868257, 'recall': 0.5386760315142906, 'f1-score': 0.44810985283658844, 'support': 152058}, 'accuracy': 0.3674780375754393, 'macro avg': {'precision': 0.384039533297125, 'recall': 0.3984694831901134, 'f1-score': 0.30298874672116094, 'support': 483667}, 'weighted avg': {'precision': 0.3864821747169756, 'recall': 0.3674780375754393, 'f1-score': 0.27992636225764334, 'support': 483667}}
[[ 95803     22  50082]
 [104148     24  81530]
 [ 70136     12  81910]]
training model: results/AAPL/W10/deepOF_L1/h50
Epoch 1/50
5429/5429 - 78s - loss: 3.2425 - accuracy50: 0.4040 - val_loss: 3.3048 - val_accuracy50: 0.3782 - 78s/epoch - 14ms/step
Epoch 2/50
5429/5429 - 73s - loss: 3.2320 - accuracy50: 0.4088 - val_loss: 3.2936 - val_accuracy50: 0.3810 - 73s/epoch - 13ms/step
Epoch 3/50
5429/5429 - 73s - loss: 3.2308 - accuracy50: 0.4091 - val_loss: 3.2910 - val_accuracy50: 0.3814 - 73s/epoch - 13ms/step
Epoch 4/50
5429/5429 - 76s - loss: 3.2296 - accuracy50: 0.4099 - val_loss: 3.2901 - val_accuracy50: 0.3824 - 76s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 76s - loss: 3.2280 - accuracy50: 0.4108 - val_loss: 3.2865 - val_accuracy50: 0.3836 - 76s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 74s - loss: 3.2263 - accuracy50: 0.4116 - val_loss: 3.2865 - val_accuracy50: 0.3837 - 74s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 75s - loss: 3.2249 - accuracy50: 0.4121 - val_loss: 3.2873 - val_accuracy50: 0.3833 - 75s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 75s - loss: 3.2235 - accuracy50: 0.4131 - val_loss: 3.2869 - val_accuracy50: 0.3831 - 75s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 76s - loss: 3.2219 - accuracy50: 0.4139 - val_loss: 3.2873 - val_accuracy50: 0.3834 - 76s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 74s - loss: 3.2206 - accuracy50: 0.4146 - val_loss: 3.2886 - val_accuracy50: 0.3845 - 74s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 74s - loss: 3.2194 - accuracy50: 0.4150 - val_loss: 3.2887 - val_accuracy50: 0.3850 - 74s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 73s - loss: 3.2186 - accuracy50: 0.4155 - val_loss: 3.2883 - val_accuracy50: 0.3846 - 73s/epoch - 13ms/step
Epoch 13/50
5429/5429 - 74s - loss: 3.2176 - accuracy50: 0.4158 - val_loss: 3.2886 - val_accuracy50: 0.3846 - 74s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 75s - loss: 3.2166 - accuracy50: 0.4163 - val_loss: 3.2872 - val_accuracy50: 0.3850 - 75s/epoch - 14ms/step
Epoch 15/50
5429/5429 - 77s - loss: 3.2152 - accuracy50: 0.4170 - val_loss: 3.2880 - val_accuracy50: 0.3855 - 77s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h50
Evaluating performance on  test set...
22048/22048 - 131s - 131s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0694473
{'0': {'precision': 0.4212461897376199, 'recall': 0.6277021662324953, 'f1-score': 0.5041566523471859, 'support': 2133566}, '1': {'precision': 0.18457943925233644, 'recall': 5.9937983155150606e-05, 'f1-score': 0.00011983705194784508, 'support': 1318029}, '2': {'precision': 0.44467438621777705, 'recall': 0.49982576712636173, 'f1-score': 0.4706398732192936, 'support': 2192468}, 'accuracy': 0.43145779910677823, 'macro avg': {'precision': 0.35016667173591115, 'recall': 0.37586262378067076, 'f1-score': 0.32497212087280913, 'support': 5644063}, 'weighted avg': {'precision': 0.3750794355049137, 'recall': 0.43145779910677823, 'f1-score': 0.3734317463126963, 'support': 5644063}}
[[1339244     193  794129]
 [ 743539      79  574411]
 [1096460     156 1095852]]
Evaluating performance on  train set...
5429/5429 - 35s - 35s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.091846
{'0': {'precision': 0.38032262601113614, 'recall': 0.638123828375916, 'f1-score': 0.4765943836964343, 'support': 457698}, '1': {'precision': 0.39325842696629215, 'recall': 7.622897441537822e-05, 'f1-score': 0.00015242840220193715, 'support': 459143}, '2': {'precision': 0.4010065009215804, 'recall': 0.5271738900611899, 'f1-score': 0.4555152405381507, 'support': 472954}, 'accuracy': 0.38957688004345964, 'macro avg': {'precision': 0.3915291846330029, 'recall': 0.38845798247050706, 'f1-score': 0.3107540175455956, 'support': 1389795}, 'weighted avg': {'precision': 0.3916350165668278, 'recall': 0.38957688004345964, 'f1-score': 0.3120201452274928, 'support': 1389795}}
[[292068     27 165603]
 [252282     35 206826]
 [223598     27 249329]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948495
{'0': {'precision': 0.37123722083811134, 'recall': 0.6435421104772758, 'f1-score': 0.47085465226454426, 'support': 154439}, '1': {'precision': 0.1724137931034483, 'recall': 2.9777679842297407e-05, 'f1-score': 5.9545075622246034e-05, 'support': 167911}, '2': {'precision': 0.39832898752761475, 'recall': 0.533149017152563, 'f1-score': 0.4559822285371944, 'support': 161317}, 'accuracy': 0.3833195152863437, 'macro avg': {'precision': 0.3139933338230581, 'recall': 0.39224030176989366, 'f1-score': 0.3089654752924536, 'support': 483667}, 'weighted avg': {'precision': 0.3112490925446689, 'recall': 0.3833195152863437, 'f1-score': 0.3024519040480565, 'support': 483667}}
[[99388    14 55037]
 [93032     5 74874]
 [75301    10 86006]]
training model: results/AAPL/W10/deepOF_L1/h100
Epoch 1/50
5429/5429 - 79s - loss: 3.2606 - accuracy100: 0.3927 - val_loss: 3.3019 - val_accuracy100: 0.3572 - 79s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 73s - loss: 3.2520 - accuracy100: 0.3969 - val_loss: 3.2932 - val_accuracy100: 0.3580 - 73s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 75s - loss: 3.2511 - accuracy100: 0.3965 - val_loss: 3.2913 - val_accuracy100: 0.3601 - 75s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 75s - loss: 3.2502 - accuracy100: 0.3972 - val_loss: 3.2915 - val_accuracy100: 0.3601 - 75s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 77s - loss: 3.2489 - accuracy100: 0.3977 - val_loss: 3.2910 - val_accuracy100: 0.3606 - 77s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 73s - loss: 3.2474 - accuracy100: 0.3987 - val_loss: 3.2905 - val_accuracy100: 0.3608 - 73s/epoch - 13ms/step
Epoch 7/50
5429/5429 - 75s - loss: 3.2465 - accuracy100: 0.3996 - val_loss: 3.2896 - val_accuracy100: 0.3624 - 75s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 74s - loss: 3.2454 - accuracy100: 0.4001 - val_loss: 3.2896 - val_accuracy100: 0.3629 - 74s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 76s - loss: 3.2443 - accuracy100: 0.4006 - val_loss: 3.2903 - val_accuracy100: 0.3615 - 76s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 75s - loss: 3.2436 - accuracy100: 0.4013 - val_loss: 3.2883 - val_accuracy100: 0.3629 - 75s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 75s - loss: 3.2424 - accuracy100: 0.4022 - val_loss: 3.2876 - val_accuracy100: 0.3636 - 75s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 74s - loss: 3.2415 - accuracy100: 0.4024 - val_loss: 3.2868 - val_accuracy100: 0.3639 - 74s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 75s - loss: 3.2406 - accuracy100: 0.4029 - val_loss: 3.2871 - val_accuracy100: 0.3637 - 75s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 74s - loss: 3.2399 - accuracy100: 0.4034 - val_loss: 3.2876 - val_accuracy100: 0.3643 - 74s/epoch - 14ms/step
Epoch 15/50
5429/5429 - 74s - loss: 3.2387 - accuracy100: 0.4042 - val_loss: 3.2884 - val_accuracy100: 0.3638 - 74s/epoch - 14ms/step
Epoch 16/50
5429/5429 - 76s - loss: 3.2377 - accuracy100: 0.4050 - val_loss: 3.2885 - val_accuracy100: 0.3646 - 76s/epoch - 14ms/step
Epoch 17/50
5429/5429 - 74s - loss: 3.2368 - accuracy100: 0.4054 - val_loss: 3.2876 - val_accuracy100: 0.3651 - 74s/epoch - 14ms/step
Epoch 18/50
5429/5429 - 75s - loss: 3.2361 - accuracy100: 0.4059 - val_loss: 3.2889 - val_accuracy100: 0.3632 - 75s/epoch - 14ms/step
Epoch 19/50
5429/5429 - 76s - loss: 3.2348 - accuracy100: 0.4068 - val_loss: 3.2880 - val_accuracy100: 0.3646 - 76s/epoch - 14ms/step
Epoch 20/50
5429/5429 - 76s - loss: 3.2341 - accuracy100: 0.4073 - val_loss: 3.2855 - val_accuracy100: 0.3655 - 76s/epoch - 14ms/step
Epoch 21/50
5429/5429 - 74s - loss: 3.2333 - accuracy100: 0.4074 - val_loss: 3.2869 - val_accuracy100: 0.3648 - 74s/epoch - 14ms/step
Epoch 22/50
5429/5429 - 75s - loss: 3.2324 - accuracy100: 0.4083 - val_loss: 3.2908 - val_accuracy100: 0.3637 - 75s/epoch - 14ms/step
Epoch 23/50
5429/5429 - 73s - loss: 3.2315 - accuracy100: 0.4089 - val_loss: 3.2873 - val_accuracy100: 0.3653 - 73s/epoch - 14ms/step
Epoch 24/50
5429/5429 - 74s - loss: 3.2307 - accuracy100: 0.4091 - val_loss: 3.2906 - val_accuracy100: 0.3637 - 74s/epoch - 14ms/step
Epoch 25/50
5429/5429 - 76s - loss: 3.2295 - accuracy100: 0.4099 - val_loss: 3.2895 - val_accuracy100: 0.3640 - 76s/epoch - 14ms/step
Epoch 26/50
5429/5429 - 76s - loss: 3.2277 - accuracy100: 0.4111 - val_loss: 3.2844 - val_accuracy100: 0.3673 - 76s/epoch - 14ms/step
Epoch 27/50
5429/5429 - 75s - loss: 3.2275 - accuracy100: 0.4112 - val_loss: 3.2957 - val_accuracy100: 0.3631 - 75s/epoch - 14ms/step
Epoch 28/50
5429/5429 - 77s - loss: 3.2264 - accuracy100: 0.4113 - val_loss: 3.2930 - val_accuracy100: 0.3635 - 77s/epoch - 14ms/step
Epoch 29/50
5429/5429 - 75s - loss: 3.2254 - accuracy100: 0.4124 - val_loss: 3.2948 - val_accuracy100: 0.3637 - 75s/epoch - 14ms/step
Epoch 30/50
5429/5429 - 77s - loss: 3.2241 - accuracy100: 0.4131 - val_loss: 3.2958 - val_accuracy100: 0.3614 - 77s/epoch - 14ms/step
Epoch 31/50
5429/5429 - 73s - loss: 3.2238 - accuracy100: 0.4135 - val_loss: 3.2932 - val_accuracy100: 0.3628 - 73s/epoch - 14ms/step
Epoch 32/50
5429/5429 - 75s - loss: 3.2223 - accuracy100: 0.4141 - val_loss: 3.2959 - val_accuracy100: 0.3608 - 75s/epoch - 14ms/step
Epoch 33/50
5429/5429 - 73s - loss: 3.2209 - accuracy100: 0.4148 - val_loss: 3.2943 - val_accuracy100: 0.3641 - 73s/epoch - 14ms/step
Epoch 34/50
5429/5429 - 75s - loss: 3.2192 - accuracy100: 0.4163 - val_loss: 3.2951 - val_accuracy100: 0.3652 - 75s/epoch - 14ms/step
Epoch 35/50
5429/5429 - 75s - loss: 3.2184 - accuracy100: 0.4166 - val_loss: 3.2874 - val_accuracy100: 0.3670 - 75s/epoch - 14ms/step
Epoch 36/50
5429/5429 - 76s - loss: 3.2170 - accuracy100: 0.4171 - val_loss: 3.2931 - val_accuracy100: 0.3646 - 76s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h100
Evaluating performance on  test set...
22048/22048 - 133s - 133s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0860856
{'0': {'precision': 0.40426189902878773, 'recall': 0.5758579252234012, 'f1-score': 0.47503868947699207, 'support': 2102048}, '1': {'precision': 0.265430329663331, 'recall': 0.047666941160996644, 'f1-score': 0.08081994373885716, 'support': 1398936}, '2': {'precision': 0.4222134483589587, 'recall': 0.47254207614371657, 'f1-score': 0.4459623081382688, 'support': 2143079}, 'accuracy': 0.40571109854726994, 'macro avg': {'precision': 0.36396855901702585, 'recall': 0.3653556475093715, 'f1-score': 0.33394031378470607, 'support': 5644063}, 'weighted avg': {'precision': 0.3766674352648501, 'recall': 0.40571109854726994, 'f1-score': 0.3662872851197173, 'support': 5644063}}
[[1210481   93305  798262]
 [ 744672   66683  587581]
 [1039146   91238 1012695]]
Evaluating performance on  train set...
5429/5429 - 37s - 37s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0876018
{'0': {'precision': 0.3830569879089616, 'recall': 0.6001758616786955, 'f1-score': 0.4676441758159759, 'support': 459452}, '1': {'precision': 0.3505158086575599, 'recall': 0.0457717265049824, 'f1-score': 0.08097006494522238, 'support': 458012}, '2': {'precision': 0.3950524000432706, 'recall': 0.5102925702526406, 'f1-score': 0.4453381003191848, 'support': 472331}, 'accuracy': 0.3869225317402926, 'macro avg': {'precision': 0.3762083988699307, 'recall': 0.3854133861454396, 'f1-score': 0.33131744702679433, 'support': 1389795}, 'weighted avg': {'precision': 0.37640964381685976, 'recall': 0.3869225317402926, 'f1-score': 0.33263344846869775, 'support': 1389795}}
[[275752  17986 165714]
 [233675  20964 203373]
 [210445  20859 241027]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0941336
{'0': {'precision': 0.3540350686125027, 'recall': 0.6046661485009732, 'f1-score': 0.4465896518140359, 'support': 150531}, '1': {'precision': 0.3927135083983913, 'recall': 0.047361453483064, 'f1-score': 0.08452870156785465, 'support': 175248}, '2': {'precision': 0.38108705387565955, 'recall': 0.49585148966355896, 'f1-score': 0.4309596943774702, 'support': 157888}, 'accuracy': 0.3672154602236663, 'macro avg': {'precision': 0.37594521029551786, 'recall': 0.3826263638825321, 'f1-score': 0.3206926825864536, 'support': 483667}, 'weighted avg': {'precision': 0.37688033832250306, 'recall': 0.3672154602236663, 'f1-score': 0.3103011720780042, 'support': 483667}}
[[91021  6362 53148]
 [92949  8300 73999]
 [73126  6473 78289]]
training model: results/AAPL/W10/deepOF_L1/h200
Epoch 1/50
5429/5429 - 79s - loss: 3.2728 - accuracy200: 0.3817 - val_loss: 3.3062 - val_accuracy200: 0.3449 - 79s/epoch - 14ms/step
Epoch 2/50
5429/5429 - 74s - loss: 3.2653 - accuracy200: 0.3848 - val_loss: 3.3031 - val_accuracy200: 0.3425 - 74s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 75s - loss: 3.2650 - accuracy200: 0.3849 - val_loss: 3.3022 - val_accuracy200: 0.3426 - 75s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 73s - loss: 3.2642 - accuracy200: 0.3855 - val_loss: 3.3030 - val_accuracy200: 0.3415 - 73s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 76s - loss: 3.2637 - accuracy200: 0.3862 - val_loss: 3.3012 - val_accuracy200: 0.3445 - 76s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 75s - loss: 3.2630 - accuracy200: 0.3866 - val_loss: 3.3008 - val_accuracy200: 0.3457 - 75s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 74s - loss: 3.2624 - accuracy200: 0.3872 - val_loss: 3.3010 - val_accuracy200: 0.3463 - 74s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 73s - loss: 3.2616 - accuracy200: 0.3878 - val_loss: 3.3002 - val_accuracy200: 0.3469 - 73s/epoch - 13ms/step
Epoch 9/50
5429/5429 - 73s - loss: 3.2611 - accuracy200: 0.3880 - val_loss: 3.3006 - val_accuracy200: 0.3471 - 73s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 75s - loss: 3.2605 - accuracy200: 0.3882 - val_loss: 3.3006 - val_accuracy200: 0.3474 - 75s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 78s - loss: 3.2597 - accuracy200: 0.3889 - val_loss: 3.2997 - val_accuracy200: 0.3484 - 78s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 74s - loss: 3.2590 - accuracy200: 0.3892 - val_loss: 3.3001 - val_accuracy200: 0.3489 - 74s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 75s - loss: 3.2584 - accuracy200: 0.3897 - val_loss: 3.3002 - val_accuracy200: 0.3490 - 75s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 73s - loss: 3.2578 - accuracy200: 0.3905 - val_loss: 3.2996 - val_accuracy200: 0.3491 - 73s/epoch - 13ms/step
Epoch 15/50
5429/5429 - 74s - loss: 3.2576 - accuracy200: 0.3907 - val_loss: 3.3008 - val_accuracy200: 0.3479 - 74s/epoch - 14ms/step
Epoch 16/50
5429/5429 - 76s - loss: 3.2569 - accuracy200: 0.3914 - val_loss: 3.3008 - val_accuracy200: 0.3481 - 76s/epoch - 14ms/step
Epoch 17/50
5429/5429 - 74s - loss: 3.2563 - accuracy200: 0.3920 - val_loss: 3.3021 - val_accuracy200: 0.3471 - 74s/epoch - 14ms/step
Epoch 18/50
5429/5429 - 74s - loss: 3.2553 - accuracy200: 0.3929 - val_loss: 3.2998 - val_accuracy200: 0.3490 - 74s/epoch - 14ms/step
Epoch 19/50
5429/5429 - 74s - loss: 3.2550 - accuracy200: 0.3929 - val_loss: 3.3005 - val_accuracy200: 0.3492 - 74s/epoch - 14ms/step
Epoch 20/50
5429/5429 - 74s - loss: 3.2544 - accuracy200: 0.3939 - val_loss: 3.3030 - val_accuracy200: 0.3477 - 74s/epoch - 14ms/step
Epoch 21/50
5429/5429 - 76s - loss: 3.2535 - accuracy200: 0.3946 - val_loss: 3.2986 - val_accuracy200: 0.3498 - 76s/epoch - 14ms/step
Epoch 22/50
5429/5429 - 74s - loss: 3.2528 - accuracy200: 0.3951 - val_loss: 3.3038 - val_accuracy200: 0.3469 - 74s/epoch - 14ms/step
Epoch 23/50
5429/5429 - 74s - loss: 3.2525 - accuracy200: 0.3953 - val_loss: 3.3000 - val_accuracy200: 0.3494 - 74s/epoch - 14ms/step
Epoch 24/50
5429/5429 - 73s - loss: 3.2516 - accuracy200: 0.3956 - val_loss: 3.3006 - val_accuracy200: 0.3501 - 73s/epoch - 14ms/step
Epoch 25/50
5429/5429 - 74s - loss: 3.2507 - accuracy200: 0.3963 - val_loss: 3.3020 - val_accuracy200: 0.3494 - 74s/epoch - 14ms/step
Epoch 26/50
5429/5429 - 74s - loss: 3.2502 - accuracy200: 0.3968 - val_loss: 3.2946 - val_accuracy200: 0.3527 - 74s/epoch - 14ms/step
Epoch 27/50
5429/5429 - 73s - loss: 3.2497 - accuracy200: 0.3973 - val_loss: 3.2984 - val_accuracy200: 0.3513 - 73s/epoch - 13ms/step
Epoch 28/50
5429/5429 - 74s - loss: 3.2490 - accuracy200: 0.3977 - val_loss: 3.3021 - val_accuracy200: 0.3477 - 74s/epoch - 14ms/step
Epoch 29/50
5429/5429 - 75s - loss: 3.2472 - accuracy200: 0.3990 - val_loss: 3.2984 - val_accuracy200: 0.3508 - 75s/epoch - 14ms/step
Epoch 30/50
5429/5429 - 74s - loss: 3.2468 - accuracy200: 0.3994 - val_loss: 3.3031 - val_accuracy200: 0.3480 - 74s/epoch - 14ms/step
Epoch 31/50
5429/5429 - 75s - loss: 3.2460 - accuracy200: 0.3996 - val_loss: 3.3016 - val_accuracy200: 0.3491 - 75s/epoch - 14ms/step
Epoch 32/50
5429/5429 - 76s - loss: 3.2451 - accuracy200: 0.4005 - val_loss: 3.2990 - val_accuracy200: 0.3511 - 76s/epoch - 14ms/step
Epoch 33/50
5429/5429 - 77s - loss: 3.2442 - accuracy200: 0.4011 - val_loss: 3.2987 - val_accuracy200: 0.3507 - 77s/epoch - 14ms/step
Epoch 34/50
5429/5429 - 77s - loss: 3.2429 - accuracy200: 0.4020 - val_loss: 3.3020 - val_accuracy200: 0.3507 - 77s/epoch - 14ms/step
Epoch 35/50
5429/5429 - 76s - loss: 3.2416 - accuracy200: 0.4022 - val_loss: 3.3020 - val_accuracy200: 0.3490 - 76s/epoch - 14ms/step
Epoch 36/50
5429/5429 - 72s - loss: 3.2399 - accuracy200: 0.4034 - val_loss: 3.3013 - val_accuracy200: 0.3503 - 72s/epoch - 13ms/step
testing model: results/AAPL/W10/deepOF_L1/h200
Evaluating performance on  test set...
22048/22048 - 147s - 147s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918971
{'0': {'precision': 0.39383540831911973, 'recall': 0.597468443002145, 'f1-score': 0.47473683854634874, 'support': 2115141}, '1': {'precision': 0.2591221575885775, 'recall': 0.050272340943407705, 'f1-score': 0.08420755710973116, 'support': 1413302}, '2': {'precision': 0.4052999156444592, 'recall': 0.4140110227734659, 'f1-score': 0.409609159936222, 'support': 2115620}, 'accuracy': 0.39168060313997205, 'macro avg': {'precision': 0.3527524938507188, 'recall': 0.3539172689063395, 'f1-score': 0.322851185197434, 'support': 5644063}, 'weighted avg': {'precision': 0.36439988187365974, 'recall': 0.39168060313997205, 'f1-score': 0.35253387342457554, 'support': 5644063}}
[[1263730  102694  748717]
 [ 805768   71050  536484]
 [1139279  100451  875890]]
Evaluating performance on  train set...
5429/5429 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927644
{'0': {'precision': 0.3666080308218964, 'recall': 0.6351557126356726, 'f1-score': 0.4648864297502998, 'support': 462326}, '1': {'precision': 0.3430103517463023, 'recall': 0.042275035014005605, 'f1-score': 0.0752729022617329, 'support': 456960}, '2': {'precision': 0.3838948180894557, 'recall': 0.4344635277964927, 'f1-score': 0.40761678012674024, 'support': 470509}, 'accuracy': 0.3722750477588421, 'macro avg': {'precision': 0.36450440021921815, 'recall': 0.37063142514872366, 'f1-score': 0.3159253707129243, 'support': 1389795}, 'weighted avg': {'precision': 0.36470155796805, 'recall': 0.3722750477588421, 'f1-score': 0.31739440172033356, 'support': 1389795}}
[[293649  17108 151569]
 [261143  19318 176499]
 [246197  19893 204419]]
Evaluating performance on  val set...
1890/1890 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.097381
{'0': {'precision': 0.3400209639090511, 'recall': 0.6215696568016275, 'f1-score': 0.43957731968331465, 'support': 152390}, '1': {'precision': 0.3774631440665596, 'recall': 0.045077918908554226, 'f1-score': 0.08053774882562093, 'support': 172102}, '2': {'precision': 0.3700715292077598, 'recall': 0.4290435055756243, 'f1-score': 0.39738155157616045, 'support': 159175}, 'accuracy': 0.3530776339919821, 'macro avg': {'precision': 0.3625185457277902, 'recall': 0.365230360428602, 'f1-score': 0.305832206695032, 'support': 483667}, 'weighted avg': {'precision': 0.3632335726272177, 'recall': 0.3530776339919821, 'f1-score': 0.29793453733056563, 'support': 483667}}
[[94721  6226 51443]
 [99540  7758 64804]
 [84313  6569 68293]]
training model: results/AAPL/W10/deepOF_L1/h300
Epoch 1/50
5429/5429 - 80s - loss: 3.2760 - accuracy300: 0.3762 - val_loss: 3.3190 - val_accuracy300: 0.3339 - 80s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 74s - loss: 3.2684 - accuracy300: 0.3792 - val_loss: 3.3172 - val_accuracy300: 0.3334 - 74s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 74s - loss: 3.2680 - accuracy300: 0.3796 - val_loss: 3.3170 - val_accuracy300: 0.3346 - 74s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 74s - loss: 3.2675 - accuracy300: 0.3806 - val_loss: 3.3161 - val_accuracy300: 0.3348 - 74s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 74s - loss: 3.2671 - accuracy300: 0.3809 - val_loss: 3.3162 - val_accuracy300: 0.3352 - 74s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 73s - loss: 3.2667 - accuracy300: 0.3815 - val_loss: 3.3162 - val_accuracy300: 0.3375 - 73s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 76s - loss: 3.2663 - accuracy300: 0.3818 - val_loss: 3.3168 - val_accuracy300: 0.3375 - 76s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 77s - loss: 3.2658 - accuracy300: 0.3817 - val_loss: 3.3172 - val_accuracy300: 0.3375 - 77s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 74s - loss: 3.2653 - accuracy300: 0.3826 - val_loss: 3.3177 - val_accuracy300: 0.3378 - 74s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 74s - loss: 3.2649 - accuracy300: 0.3827 - val_loss: 3.3183 - val_accuracy300: 0.3388 - 74s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 73s - loss: 3.2645 - accuracy300: 0.3832 - val_loss: 3.3181 - val_accuracy300: 0.3388 - 73s/epoch - 13ms/step
Epoch 12/50
5429/5429 - 74s - loss: 3.2643 - accuracy300: 0.3837 - val_loss: 3.3174 - val_accuracy300: 0.3394 - 74s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 74s - loss: 3.2636 - accuracy300: 0.3839 - val_loss: 3.3178 - val_accuracy300: 0.3392 - 74s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 72s - loss: 3.2630 - accuracy300: 0.3848 - val_loss: 3.3165 - val_accuracy300: 0.3408 - 72s/epoch - 13ms/step
testing model: results/AAPL/W10/deepOF_L1/h300
Evaluating performance on  test set...
22048/22048 - 150s - 150s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.090249
{'0': {'precision': 0.38156799567180194, 'recall': 0.8242863599915274, 'f1-score': 0.5216571848240449, 'support': 2115072}, '1': {'precision': 0.25236593059936907, 'recall': 0.0013426122759515764, 'f1-score': 0.0026710144846889662, 'support': 1430048}, '2': {'precision': 0.4042280493334882, 'recall': 0.20555679692111697, 'f1-score': 0.2725283304661511, 'support': 2098943}, 'accuracy': 0.38567907551705216, 'macro avg': {'precision': 0.3460539918682197, 'recall': 0.34372858972953196, 'f1-score': 0.265618843258295, 'support': 5644063}, 'weighted avg': {'precision': 0.357258735881491, 'recall': 0.38567907551705216, 'f1-score': 0.29751326582916904, 'support': 5644063}}
[[1743425    2686  368961]
 [1161193    1920  266935]
 [1664489    3002  431452]]
Evaluating performance on  train set...
5429/5429 - 36s - 36s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000752
{'0': {'precision': 0.3438203133905632, 'recall': 0.8452226210107673, 'f1-score': 0.48880439559069644, 'support': 463905}, '1': {'precision': 0.3381326352530541, 'recall': 0.0016959649165038176, 'f1-score': 0.003375001905243011, 'support': 456967}, '2': {'precision': 0.3823647262145196, 'recall': 0.201465912313962, 'f1-score': 0.26388974240079555, 'support': 468923}, 'accuracy': 0.35066322731050265, 'macro avg': {'precision': 0.35477255828604565, 'recall': 0.3494614994137444, 'f1-score': 0.252023046632245, 'support': 1389795}, 'weighted avg': {'precision': 0.35495525090234364, 'recall': 0.35066322731050265, 'f1-score': 0.25330716926449115, 'support': 1389795}}
[[392103    713  71089]
 [374680    775  81512]
 [373647    804  94472]]
Evaluating performance on  val set...
1890/1890 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045429
{'0': {'precision': 0.3260761624873663, 'recall': 0.8412807824113512, 'f1-score': 0.46998753946139954, 'support': 153781}, '1': {'precision': 0.3864265927977839, 'recall': 0.0016533725243857633, 'f1-score': 0.0032926570207944864, 'support': 168746}, '2': {'precision': 0.377372720100246, 'recall': 0.20184311778577635, 'f1-score': 0.26301106223314785, 'support': 161140}, 'accuracy': 0.33530714313773735, 'macro avg': {'precision': 0.36329182512846536, 'recall': 0.34825909090717105, 'f1-score': 0.2454304195717806, 'support': 483667}, 'weighted avg': {'precision': 0.36422187225648667, 'recall': 0.33530714313773735, 'f1-score': 0.23820599519048002, 'support': 483667}}
[[129373    195  24213]
 [139017    279  29450]
 [128367    248  32525]]
training model: results/AAPL/W10/deepOF_L1/h500
Epoch 1/50
5429/5429 - 76s - loss: 3.2786 - accuracy500: 0.3738 - val_loss: 3.3601 - val_accuracy500: 0.3164 - 76s/epoch - 14ms/step
Epoch 2/50
5429/5429 - 74s - loss: 3.2728 - accuracy500: 0.3751 - val_loss: 3.3522 - val_accuracy500: 0.3160 - 74s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 74s - loss: 3.2725 - accuracy500: 0.3759 - val_loss: 3.3487 - val_accuracy500: 0.3155 - 74s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 76s - loss: 3.2728 - accuracy500: 0.3756 - val_loss: 3.3493 - val_accuracy500: 0.3171 - 76s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 76s - loss: 3.2722 - accuracy500: 0.3763 - val_loss: 3.3489 - val_accuracy500: 0.3173 - 76s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 76s - loss: 3.2715 - accuracy500: 0.3772 - val_loss: 3.3477 - val_accuracy500: 0.3181 - 76s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 76s - loss: 3.2710 - accuracy500: 0.3777 - val_loss: 3.3467 - val_accuracy500: 0.3200 - 76s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 74s - loss: 3.2704 - accuracy500: 0.3786 - val_loss: 3.3453 - val_accuracy500: 0.3207 - 74s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 73s - loss: 3.2696 - accuracy500: 0.3791 - val_loss: 3.3444 - val_accuracy500: 0.3214 - 73s/epoch - 13ms/step
Epoch 10/50
5429/5429 - 76s - loss: 3.2691 - accuracy500: 0.3794 - val_loss: 3.3444 - val_accuracy500: 0.3215 - 76s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 74s - loss: 3.2686 - accuracy500: 0.3801 - val_loss: 3.3436 - val_accuracy500: 0.3218 - 74s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 75s - loss: 3.2680 - accuracy500: 0.3806 - val_loss: 3.3435 - val_accuracy500: 0.3222 - 75s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 74s - loss: 3.2674 - accuracy500: 0.3810 - val_loss: 3.3445 - val_accuracy500: 0.3225 - 74s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 73s - loss: 3.2669 - accuracy500: 0.3816 - val_loss: 3.3441 - val_accuracy500: 0.3224 - 73s/epoch - 13ms/step
Epoch 15/50
5429/5429 - 76s - loss: 3.2663 - accuracy500: 0.3820 - val_loss: 3.3428 - val_accuracy500: 0.3236 - 76s/epoch - 14ms/step
Epoch 16/50
5429/5429 - 77s - loss: 3.2655 - accuracy500: 0.3828 - val_loss: 3.3418 - val_accuracy500: 0.3250 - 77s/epoch - 14ms/step
Epoch 17/50
5429/5429 - 74s - loss: 3.2652 - accuracy500: 0.3833 - val_loss: 3.3435 - val_accuracy500: 0.3238 - 74s/epoch - 14ms/step
Epoch 18/50
5429/5429 - 76s - loss: 3.2648 - accuracy500: 0.3834 - val_loss: 3.3426 - val_accuracy500: 0.3240 - 76s/epoch - 14ms/step
Epoch 19/50
5429/5429 - 76s - loss: 3.2643 - accuracy500: 0.3840 - val_loss: 3.3417 - val_accuracy500: 0.3256 - 76s/epoch - 14ms/step
Epoch 20/50
5429/5429 - 74s - loss: 3.2637 - accuracy500: 0.3841 - val_loss: 3.3422 - val_accuracy500: 0.3253 - 74s/epoch - 14ms/step
Epoch 21/50
5429/5429 - 75s - loss: 3.2632 - accuracy500: 0.3850 - val_loss: 3.3413 - val_accuracy500: 0.3248 - 75s/epoch - 14ms/step
Epoch 22/50
5429/5429 - 75s - loss: 3.2626 - accuracy500: 0.3853 - val_loss: 3.3409 - val_accuracy500: 0.3259 - 75s/epoch - 14ms/step
Epoch 23/50
5429/5429 - 75s - loss: 3.2622 - accuracy500: 0.3857 - val_loss: 3.3394 - val_accuracy500: 0.3278 - 75s/epoch - 14ms/step
Epoch 24/50
5429/5429 - 77s - loss: 3.2615 - accuracy500: 0.3861 - val_loss: 3.3400 - val_accuracy500: 0.3272 - 77s/epoch - 14ms/step
Epoch 25/50
5429/5429 - 75s - loss: 3.2612 - accuracy500: 0.3862 - val_loss: 3.3401 - val_accuracy500: 0.3260 - 75s/epoch - 14ms/step
Epoch 26/50
5429/5429 - 75s - loss: 3.2608 - accuracy500: 0.3868 - val_loss: 3.3384 - val_accuracy500: 0.3274 - 75s/epoch - 14ms/step
Epoch 27/50
5429/5429 - 74s - loss: 3.2602 - accuracy500: 0.3871 - val_loss: 3.3407 - val_accuracy500: 0.3270 - 74s/epoch - 14ms/step
Epoch 28/50
5429/5429 - 75s - loss: 3.2594 - accuracy500: 0.3878 - val_loss: 3.3398 - val_accuracy500: 0.3282 - 75s/epoch - 14ms/step
Epoch 29/50
5429/5429 - 76s - loss: 3.2596 - accuracy500: 0.3877 - val_loss: 3.3414 - val_accuracy500: 0.3290 - 76s/epoch - 14ms/step
Epoch 30/50
5429/5429 - 77s - loss: 3.2591 - accuracy500: 0.3883 - val_loss: 3.3387 - val_accuracy500: 0.3280 - 77s/epoch - 14ms/step
Epoch 31/50
5429/5429 - 75s - loss: 3.2588 - accuracy500: 0.3885 - val_loss: 3.3422 - val_accuracy500: 0.3289 - 75s/epoch - 14ms/step
Epoch 32/50
5429/5429 - 75s - loss: 3.2584 - accuracy500: 0.3889 - val_loss: 3.3408 - val_accuracy500: 0.3300 - 75s/epoch - 14ms/step
Epoch 33/50
5429/5429 - 76s - loss: 3.2600 - accuracy500: 0.3877 - val_loss: 3.3443 - val_accuracy500: 0.3273 - 76s/epoch - 14ms/step
Epoch 34/50
5429/5429 - 75s - loss: 3.2582 - accuracy500: 0.3896 - val_loss: 3.3397 - val_accuracy500: 0.3319 - 75s/epoch - 14ms/step
Epoch 35/50
5429/5429 - 75s - loss: 3.2580 - accuracy500: 0.3890 - val_loss: 3.3411 - val_accuracy500: 0.3326 - 75s/epoch - 14ms/step
Epoch 36/50
5429/5429 - 76s - loss: 3.2578 - accuracy500: 0.3896 - val_loss: 3.3386 - val_accuracy500: 0.3298 - 76s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h500
Evaluating performance on  test set...
22048/22048 - 112s - 112s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0864888
{'0': {'precision': 0.38404260048463257, 'recall': 0.8049057872351583, 'f1-score': 0.5199857535746504, 'support': 2135804}, '1': {'precision': 0.23230879199428162, 'recall': 0.00023021611271947565, 'f1-score': 0.00045997639259622, 'support': 1411717}, '2': {'precision': 0.3958404606772113, 'recall': 0.22020164633000436, 'f1-score': 0.2829829978622819, 'support': 2096542}, 'accuracy': 0.38644288697698803, 'macro avg': {'precision': 0.33739728438537514, 'recall': 0.34177921655929405, 'f1-score': 0.26780957594317617, 'support': 5644063}, 'weighted avg': {'precision': 0.35047272581868655, 'recall': 0.38644288697698803, 'f1-score': 0.3020027857989827, 'support': 5644063}}
[[1719121     523  416160]
 [1122931     325  288461]
 [1634329     551  461662]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028639
{'0': {'precision': 0.34279712475793483, 'recall': 0.8303154927277454, 'f1-score': 0.4852556511736836, 'support': 465399}, '1': {'precision': 0.3171355498721228, 'recall': 0.00027168376010323984, 'f1-score': 0.0005429024264235865, 'support': 456413}, '2': {'precision': 0.3689728183118741, 'recall': 0.2066677635726084, 'f1-score': 0.26493888575388846, 'support': 467983}, 'accuracy': 0.3477268230206613, 'macro avg': {'precision': 0.3429684976473106, 'recall': 0.34575164668681896, 'f1-score': 0.25024581311799854, 'support': 1389795}, 'weighted avg': {'precision': 0.3431838747592624, 'recall': 0.3477268230206613, 'f1-score': 0.2518876360164588, 'support': 1389795}}
[[386428    112  78859]
 [369740    124  86549]
 [371111    155  96717]]
Evaluating performance on  val set...
1890/1890 - 12s - 12s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.111062
{'0': {'precision': 0.31896538502829624, 'recall': 0.8234187864990596, 'f1-score': 0.4598139519458769, 'support': 151545}, '1': {'precision': 0.35877862595419846, 'recall': 0.0002715601419046188, 'f1-score': 0.0005427095060766144, 'support': 173074}, '2': {'precision': 0.36152213002881345, 'recall': 0.20984231175494192, 'f1-score': 0.2655490400451931, 'support': 159048}, 'accuracy': 0.32709901647207684, 'macro avg': {'precision': 0.3464220470037694, 'recall': 0.34451088613196873, 'f1-score': 0.24196856716571555, 'support': 483667}, 'weighted avg': {'precision': 0.34720630706525935, 'recall': 0.32709901647207684, 'f1-score': 0.23158800987828504, 'support': 483667}}
[[124785     46  26714]
 [140798     47  32229]
 [125635     38  33375]]
training model: results/AAPL/W10/deepOF_L1/h1000
Epoch 1/50
5429/5429 - 80s - loss: 3.2759 - accuracy1000: 0.3769 - val_loss: 3.3970 - val_accuracy1000: 0.3126 - 80s/epoch - 15ms/step
Epoch 2/50
5429/5429 - 78s - loss: 3.2696 - accuracy1000: 0.3786 - val_loss: 3.3921 - val_accuracy1000: 0.3126 - 78s/epoch - 14ms/step
Epoch 3/50
5429/5429 - 75s - loss: 3.2682 - accuracy1000: 0.3797 - val_loss: 3.3845 - val_accuracy1000: 0.3126 - 75s/epoch - 14ms/step
Epoch 4/50
5429/5429 - 75s - loss: 3.2672 - accuracy1000: 0.3805 - val_loss: 3.3761 - val_accuracy1000: 0.3127 - 75s/epoch - 14ms/step
Epoch 5/50
5429/5429 - 77s - loss: 3.2662 - accuracy1000: 0.3816 - val_loss: 3.3746 - val_accuracy1000: 0.3126 - 77s/epoch - 14ms/step
Epoch 6/50
5429/5429 - 74s - loss: 3.2654 - accuracy1000: 0.3820 - val_loss: 3.3732 - val_accuracy1000: 0.3125 - 74s/epoch - 14ms/step
Epoch 7/50
5429/5429 - 76s - loss: 3.2642 - accuracy1000: 0.3828 - val_loss: 3.3743 - val_accuracy1000: 0.3127 - 76s/epoch - 14ms/step
Epoch 8/50
5429/5429 - 75s - loss: 3.2629 - accuracy1000: 0.3838 - val_loss: 3.3758 - val_accuracy1000: 0.3126 - 75s/epoch - 14ms/step
Epoch 9/50
5429/5429 - 74s - loss: 3.2617 - accuracy1000: 0.3845 - val_loss: 3.3768 - val_accuracy1000: 0.3126 - 74s/epoch - 14ms/step
Epoch 10/50
5429/5429 - 75s - loss: 3.2608 - accuracy1000: 0.3853 - val_loss: 3.3768 - val_accuracy1000: 0.3126 - 75s/epoch - 14ms/step
Epoch 11/50
5429/5429 - 75s - loss: 3.2600 - accuracy1000: 0.3862 - val_loss: 3.3781 - val_accuracy1000: 0.3126 - 75s/epoch - 14ms/step
Epoch 12/50
5429/5429 - 77s - loss: 3.2590 - accuracy1000: 0.3867 - val_loss: 3.3798 - val_accuracy1000: 0.3126 - 77s/epoch - 14ms/step
Epoch 13/50
5429/5429 - 75s - loss: 3.2582 - accuracy1000: 0.3875 - val_loss: 3.3794 - val_accuracy1000: 0.3126 - 75s/epoch - 14ms/step
Epoch 14/50
5429/5429 - 76s - loss: 3.2572 - accuracy1000: 0.3880 - val_loss: 3.3812 - val_accuracy1000: 0.3127 - 76s/epoch - 14ms/step
Epoch 15/50
5429/5429 - 77s - loss: 3.2566 - accuracy1000: 0.3883 - val_loss: 3.3790 - val_accuracy1000: 0.3126 - 77s/epoch - 14ms/step
Epoch 16/50
5429/5429 - 74s - loss: 3.2559 - accuracy1000: 0.3893 - val_loss: 3.3791 - val_accuracy1000: 0.3127 - 74s/epoch - 14ms/step
testing model: results/AAPL/W10/deepOF_L1/h1000
Evaluating performance on  test set...
22048/22048 - 147s - 147s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0838912
{'0': {'precision': 0.38225381918620155, 'recall': 0.9955580055579406, 'f1-score': 0.5524061312459546, 'support': 2156914}, '1': {'precision': 0.21546261089987326, 'recall': 0.0002491499589635362, 'f1-score': 0.0004977243748801436, 'support': 1364640}, '2': {'precision': 0.40129177197416455, 'recall': 0.0047128186500033685, 'f1-score': 0.009316226420717543, 'support': 2122509}, 'accuracy': 0.3822912678331195, 'macro avg': {'precision': 0.3330027340200798, 'recall': 0.33350665805563584, 'f1-score': 0.18740669401385077, 'support': 5644063}, 'weighted avg': {'precision': 0.34908591720817106, 'recall': 0.3822912678331195, 'f1-score': 0.21472926634326794, 'support': 5644063}}
[[2147333     579    9002]
 [1358378     340    5922]
 [2111847     659   10003]]
Evaluating performance on  train set...
5429/5429 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.113547
{'0': {'precision': 0.33308903301162307, 'recall': 0.9959112667077269, 'f1-score': 0.49921301125832623, 'support': 462735}, '1': {'precision': 0.3276699029126214, 'recall': 0.00029503360104900835, 'f1-score': 0.0005895363842205128, 'support': 457575}, '2': {'precision': 0.36523972602739724, 'recall': 0.004543276143007764, 'f1-score': 0.00897491190238258, 'support': 469485}, 'accuracy': 0.33322252562428273, 'macro avg': {'precision': 0.34199955398388054, 'recall': 0.33358319215059457, 'f1-score': 0.1695924865149764, 'support': 1389795}, 'weighted avg': {'precision': 0.3421656303914237, 'recall': 0.33322252562428273, 'f1-score': 0.1694398644333311, 'support': 1389795}}
[[460843    135   1757]
 [455490    135   1950]
 [467210    142   2133]]
Evaluating performance on  val set...
1890/1890 - 13s - 13s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1232281
{'0': {'precision': 0.31228653342751483, 'recall': 0.9952395140199292, 'f1-score': 0.47540146273967193, 'support': 151035}, '1': {'precision': 0.3380281690140845, 'recall': 0.0002817546269392643, 'f1-score': 0.0005630399465112052, 'support': 170361}, '2': {'precision': 0.35697940503432496, 'recall': 0.004806773853615248, 'f1-score': 0.0094858199153573, 'support': 162271}, 'accuracy': 0.31249599414473184, 'macro avg': {'precision': 0.33576470249197476, 'recall': 0.33344268083349454, 'f1-score': 0.16181677420051346, 'support': 483667}, 'weighted avg': {'precision': 0.33634798014327644, 'recall': 0.31249599414473184, 'f1-score': 0.15183474054814342, 'support': 483667}}
[[150316     54    665]
 [169573     48    740]
 [161451     40    780]]
training model: results/AAPL/W10/deepLOB_L2/h10
Epoch 1/50
5429/5429 - 223s - loss: 3.2101 - accuracy10: 0.4166 - val_loss: 3.4096 - val_accuracy10: 0.3855 - 223s/epoch - 41ms/step
Epoch 2/50
5429/5429 - 221s - loss: 3.1665 - accuracy10: 0.4360 - val_loss: 3.3009 - val_accuracy10: 0.3995 - 221s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 220s - loss: 3.1439 - accuracy10: 0.4456 - val_loss: 3.2615 - val_accuracy10: 0.4101 - 220s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 221s - loss: 3.1314 - accuracy10: 0.4505 - val_loss: 3.2439 - val_accuracy10: 0.4147 - 221s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 221s - loss: 3.1240 - accuracy10: 0.4530 - val_loss: 3.2180 - val_accuracy10: 0.4210 - 221s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 221s - loss: 3.1180 - accuracy10: 0.4553 - val_loss: 3.2142 - val_accuracy10: 0.4238 - 221s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 220s - loss: 3.1139 - accuracy10: 0.4565 - val_loss: 3.2071 - val_accuracy10: 0.4264 - 220s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 222s - loss: 3.1104 - accuracy10: 0.4577 - val_loss: 3.2171 - val_accuracy10: 0.4221 - 222s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 222s - loss: 3.1065 - accuracy10: 0.4591 - val_loss: 3.2195 - val_accuracy10: 0.4215 - 222s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 220s - loss: 3.1034 - accuracy10: 0.4604 - val_loss: 3.1928 - val_accuracy10: 0.4291 - 220s/epoch - 40ms/step
Epoch 11/50
5429/5429 - 220s - loss: 3.1004 - accuracy10: 0.4616 - val_loss: 3.2001 - val_accuracy10: 0.4272 - 220s/epoch - 41ms/step
Epoch 12/50
5429/5429 - 221s - loss: 3.0978 - accuracy10: 0.4624 - val_loss: 3.1993 - val_accuracy10: 0.4279 - 221s/epoch - 41ms/step
Epoch 13/50
5429/5429 - 221s - loss: 3.0952 - accuracy10: 0.4635 - val_loss: 3.2099 - val_accuracy10: 0.4265 - 221s/epoch - 41ms/step
Epoch 14/50
5429/5429 - 221s - loss: 3.0929 - accuracy10: 0.4645 - val_loss: 3.2075 - val_accuracy10: 0.4280 - 221s/epoch - 41ms/step
Epoch 15/50
5429/5429 - 223s - loss: 3.0904 - accuracy10: 0.4648 - val_loss: 3.2052 - val_accuracy10: 0.4289 - 223s/epoch - 41ms/step
Epoch 16/50
5429/5429 - 220s - loss: 3.0886 - accuracy10: 0.4654 - val_loss: 3.2089 - val_accuracy10: 0.4289 - 220s/epoch - 41ms/step
Epoch 17/50
5429/5429 - 221s - loss: 3.0864 - accuracy10: 0.4664 - val_loss: 3.2087 - val_accuracy10: 0.4290 - 221s/epoch - 41ms/step
Epoch 18/50
5429/5429 - 220s - loss: 3.0845 - accuracy10: 0.4669 - val_loss: 3.2174 - val_accuracy10: 0.4282 - 220s/epoch - 40ms/step
Epoch 19/50
5429/5429 - 222s - loss: 3.0824 - accuracy10: 0.4674 - val_loss: 3.2069 - val_accuracy10: 0.4301 - 222s/epoch - 41ms/step
Epoch 20/50
5429/5429 - 220s - loss: 3.0806 - accuracy10: 0.4684 - val_loss: 3.2070 - val_accuracy10: 0.4306 - 220s/epoch - 40ms/step
testing model: results/AAPL/W10/deepLOB_L2/h10
Evaluating performance on  test set...
22048/22048 - 294s - 294s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.072255
{'0': {'precision': 0.46253408155367476, 'recall': 0.44147208287336565, 'f1-score': 0.4517577255965714, 'support': 2146890}, '1': {'precision': 0.3885588976758642, 'recall': 0.017057328481107168, 'f1-score': 0.032680037555249127, 'support': 1319257}, '2': {'precision': 0.4381133862497438, 'recall': 0.7115124928773817, 'f1-score': 0.542303636814766, 'support': 2177921}, 'accuracy': 0.446471055983025, 'macro avg': {'precision': 0.4297354551597609, 'recall': 0.3900139680772849, 'f1-score': 0.3422471333221955, 'support': 5644068}, 'weighted avg': {'precision': 0.43581955148526996, 'recall': 0.446471055983025, 'f1-score': 0.38874123961764817, 'support': 5644068}}
[[ 947792   17192 1181906]
 [ 491253   22503  805501]
 [ 610084   18219 1549618]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0619483
{'0': {'precision': 0.42170451352183164, 'recall': 0.6831871836283425, 'f1-score': 0.5215047224256265, 'support': 461285}, '1': {'precision': 0.47046606903825094, 'recall': 0.12599205271539465, 'f1-score': 0.19875657186726714, 'support': 460283}, '2': {'precision': 0.4552435282856433, 'recall': 0.5048224369324347, 'f1-score': 0.47875282672826647, 'support': 468228}, 'accuracy': 0.4385593281316107, 'macro avg': {'precision': 0.4491380369485753, 'recall': 0.438000557758724, 'f1-score': 0.3996713736737201, 'support': 1389796}, 'weighted avg': {'precision': 0.4491531612820742, 'recall': 0.4385593281316107, 'f1-score': 0.4002112940361098, 'support': 1389796}}
[[315144  28885 117256]
 [236698  57992 165593]
 [195468  36388 236372]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0633241
{'0': {'precision': 0.41303619014871484, 'recall': 0.6277485269332775, 'f1-score': 0.4982449409190599, 'support': 153082}, '1': {'precision': 0.5113088616981831, 'recall': 0.1184884347039078, 'f1-score': 0.19239265401410974, 'support': 174574}, '2': {'precision': 0.43004103499373075, 'recall': 0.5803821525405259, 'f1-score': 0.49402694761882676, 'support': 156011}, 'accuracy': 0.42865856053855234, 'macro avg': {'precision': 0.45146202894687626, 'recall': 0.4422063713925704, 'f1-score': 0.39488818085066546, 'support': 483667}, 'weighted avg': {'precision': 0.45399163307161977, 'recall': 0.4286585605385523, 'f1-score': 0.38649055104563984, 'support': 483667}}
[[96097  9231 47754]
 [81637 20685 72252]
 [54926 10539 90546]]
training model: results/AAPL/W10/deepLOB_L2/h20
Epoch 1/50
5429/5429 - 224s - loss: 3.2372 - accuracy20: 0.4037 - val_loss: 3.2830 - val_accuracy20: 0.3602 - 224s/epoch - 41ms/step
Epoch 2/50
5429/5429 - 221s - loss: 3.2087 - accuracy20: 0.4172 - val_loss: 3.3220 - val_accuracy20: 0.3492 - 221s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 221s - loss: 3.1912 - accuracy20: 0.4252 - val_loss: 3.3133 - val_accuracy20: 0.3549 - 221s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 220s - loss: 3.1805 - accuracy20: 0.4302 - val_loss: 3.3683 - val_accuracy20: 0.3454 - 220s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 220s - loss: 3.1736 - accuracy20: 0.4330 - val_loss: 3.3284 - val_accuracy20: 0.3471 - 220s/epoch - 40ms/step
Epoch 6/50
5429/5429 - 221s - loss: 3.1683 - accuracy20: 0.4356 - val_loss: 3.3851 - val_accuracy20: 0.3429 - 221s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 222s - loss: 3.1644 - accuracy20: 0.4369 - val_loss: 3.4137 - val_accuracy20: 0.3408 - 222s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 221s - loss: 3.1613 - accuracy20: 0.4385 - val_loss: 3.3178 - val_accuracy20: 0.3604 - 221s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 220s - loss: 3.1588 - accuracy20: 0.4392 - val_loss: 3.3658 - val_accuracy20: 0.3497 - 220s/epoch - 40ms/step
Epoch 10/50
5429/5429 - 225s - loss: 3.1563 - accuracy20: 0.4402 - val_loss: 3.2898 - val_accuracy20: 0.3709 - 225s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 223s - loss: 3.1542 - accuracy20: 0.4414 - val_loss: 3.3861 - val_accuracy20: 0.3438 - 223s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h20
Evaluating performance on  test set...
22048/22048 - 293s - 293s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1115879
{'0': {'precision': 0.3993136890288976, 'recall': 0.3761065848453588, 'f1-score': 0.38736286094839584, 'support': 2075417}, '1': {'precision': 0.23589537429861776, 'recall': 0.057365381641996255, 'f1-score': 0.09228802627080501, 'support': 1442281}, '2': {'precision': 0.3898901104167609, 'recall': 0.6121516951424258, 'f1-score': 0.4763711268068254, 'support': 2126370}, 'accuracy': 0.38358432251347785, 'macro avg': {'precision': 0.34169972458142545, 'recall': 0.3485412205432603, 'f1-score': 0.31867400467534207, 'support': 5644068}, 'weighted avg': {'precision': 0.3540036138772531, 'recall': 0.38358432251347785, 'f1-score': 0.3454930037177173, 'support': 5644068}}
[[ 780578  128753 1166086]
 [ 488758   82737  870786]
 [ 685463  139246 1301661]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0975529
{'0': {'precision': 0.3536849757497665, 'recall': 0.7776645390858589, 'f1-score': 0.48623040013942515, 'support': 459207}, '1': {'precision': 0.33652606581476874, 'recall': 0.06480364445644553, 'f1-score': 0.10867929765104593, 'support': 459218}, '2': {'precision': 0.407199547457017, 'recall': 0.25197562005299434, 'f1-score': 0.3113113585372502, 'support': 471371}, 'accuracy': 0.36382461886492695, 'macro avg': {'precision': 0.3658035296738507, 'recall': 0.36481460119843295, 'f1-score': 0.3020736854425738, 'support': 1389796}, 'weighted avg': {'precision': 0.3661656109492407, 'recall': 0.36382461886492695, 'f1-score': 0.30215300623300484, 'support': 1389796}}
[[357109  24429  77669]
 [334217  29759  95242]
 [318355  34242 118774]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0943542
{'0': {'precision': 0.34270916186120504, 'recall': 0.7200216718670444, 'f1-score': 0.46438480159983164, 'support': 153194}, '1': {'precision': 0.3690532763081472, 'recall': 0.08115294185945256, 'f1-score': 0.13304906892301543, 'support': 172255}, '2': {'precision': 0.4022818781115603, 'recall': 0.31510953241729767, 'f1-score': 0.35339942087747345, 'support': 158218}, 'accuracy': 0.3600369675830685, 'macro avg': {'precision': 0.3713481054269709, 'recall': 0.3720947153812649, 'f1-score': 0.3169444304667735, 'support': 483667}, 'weighted avg': {'precision': 0.3715789864590311, 'recall': 0.3600369675830685, 'f1-score': 0.3100759039504674, 'support': 483667}}
[[110303   9337  33554]
 [117753  13979  40523]
 [ 93800  14562  49856]]
training model: results/AAPL/W10/deepLOB_L2/h30
Epoch 1/50
5429/5429 - 225s - loss: 3.2478 - accuracy30: 0.3994 - val_loss: 3.3572 - val_accuracy30: 0.3150 - 225s/epoch - 41ms/step
Epoch 2/50
5429/5429 - 225s - loss: 3.2238 - accuracy30: 0.4119 - val_loss: 3.3052 - val_accuracy30: 0.3359 - 225s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 220s - loss: 3.2115 - accuracy30: 0.4167 - val_loss: 3.2810 - val_accuracy30: 0.3690 - 220s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 222s - loss: 3.2023 - accuracy30: 0.4213 - val_loss: 3.2729 - val_accuracy30: 0.3764 - 222s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 221s - loss: 3.1961 - accuracy30: 0.4242 - val_loss: 3.3307 - val_accuracy30: 0.3491 - 221s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 222s - loss: 3.1911 - accuracy30: 0.4261 - val_loss: 3.3344 - val_accuracy30: 0.3494 - 222s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 219s - loss: 3.1872 - accuracy30: 0.4280 - val_loss: 3.3615 - val_accuracy30: 0.3369 - 219s/epoch - 40ms/step
Epoch 8/50
5429/5429 - 222s - loss: 3.1842 - accuracy30: 0.4291 - val_loss: 3.3493 - val_accuracy30: 0.3386 - 222s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 222s - loss: 3.1813 - accuracy30: 0.4306 - val_loss: 3.3554 - val_accuracy30: 0.3331 - 222s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 221s - loss: 3.1789 - accuracy30: 0.4320 - val_loss: 3.3542 - val_accuracy30: 0.3465 - 221s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 224s - loss: 3.1767 - accuracy30: 0.4328 - val_loss: 3.3827 - val_accuracy30: 0.3368 - 224s/epoch - 41ms/step
Epoch 12/50
5429/5429 - 226s - loss: 3.1746 - accuracy30: 0.4337 - val_loss: 3.3489 - val_accuracy30: 0.3426 - 226s/epoch - 42ms/step
Epoch 13/50
5429/5429 - 226s - loss: 3.1728 - accuracy30: 0.4343 - val_loss: 3.3343 - val_accuracy30: 0.3475 - 226s/epoch - 42ms/step
Epoch 14/50
5429/5429 - 220s - loss: 3.1714 - accuracy30: 0.4348 - val_loss: 3.3493 - val_accuracy30: 0.3437 - 220s/epoch - 40ms/step
testing model: results/AAPL/W10/deepLOB_L2/h30
Evaluating performance on  test set...
22048/22048 - 296s - 296s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0999547
{'0': {'precision': 0.3858450677292191, 'recall': 0.6676570547873688, 'f1-score': 0.48905868534738917, 'support': 2039941}, '1': {'precision': 0.2936592844593158, 'recall': 0.17371861412251946, 'f1-score': 0.21829908549494997, 'support': 1510552}, '2': {'precision': 0.39616651633236744, 'recall': 0.23097620099590413, 'f1-score': 0.2918156724965512, 'support': 2093575}, 'accuracy': 0.373482034589236, 'macro avg': {'precision': 0.35855695617363414, 'recall': 0.3574506233019308, 'f1-score': 0.3330578144462968, 'support': 5644068}, 'weighted avg': {'precision': 0.36500146830224856, 'recall': 0.373482034589236, 'f1-score': 0.3434297709357459, 'support': 5644068}}
[[1361981  311949  366011]
 [ 877105  262411  371036]
 [1290779  319230  483566]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1069869
{'0': {'precision': 0.35163841127577894, 'recall': 0.5358717356065207, 'f1-score': 0.4246330848570251, 'support': 457742}, '1': {'precision': 0.34890949564521123, 'recall': 0.41062399385734916, 'f1-score': 0.3772594956686424, 'support': 458434}, '2': {'precision': 0.4160396571256442, 'recall': 0.13414340610616104, 'f1-score': 0.20287420828350597, 'support': 473620}, 'accuracy': 0.35765536812596954, 'macro avg': {'precision': 0.37219585468221145, 'recall': 0.3602130451900103, 'f1-score': 0.3349222629363912, 'support': 1389796}, 'weighted avg': {'precision': 0.3726851622746518, 'recall': 0.35765536812596954, 'f1-score': 0.3334347340855902, 'support': 1389796}}
[[245291 170139  42312]
 [223326 188244  46864]
 [228949 181138  63533]]
Evaluating performance on  val set...
1890/1890 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914685
{'0': {'precision': 0.33009941603481274, 'recall': 0.4622170131392265, 'f1-score': 0.3851430072645863, 'support': 145899}, '1': {'precision': 0.4100187071294949, 'recall': 0.4781081852603911, 'f1-score': 0.4414533591275071, 'support': 185663}, '2': {'precision': 0.41040729019227407, 'recall': 0.16965911705729594, 'f1-score': 0.24007367990176012, 'support': 152105}, 'accuracy': 0.37631262831658974, 'macro avg': {'precision': 0.3835084711188606, 'recall': 0.36999477181897117, 'f1-score': 0.3555566820979512, 'support': 483667}, 'weighted avg': {'precision': 0.3860331153387401, 'recall': 0.37631262831658974, 'f1-score': 0.36113677739858924, 'support': 483667}}
[[67437 61762 16700]
 [76523 88767 20373]
 [60333 65966 25806]]
training model: results/AAPL/W10/deepLOB_L2/h50
Epoch 1/50
5429/5429 - 223s - loss: 3.2491 - accuracy50: 0.3958 - val_loss: 3.3947 - val_accuracy50: 0.3335 - 223s/epoch - 41ms/step
Epoch 2/50
5429/5429 - 220s - loss: 3.2277 - accuracy50: 0.4083 - val_loss: 3.4238 - val_accuracy50: 0.3509 - 220s/epoch - 40ms/step
Epoch 3/50
5429/5429 - 220s - loss: 3.2212 - accuracy50: 0.4123 - val_loss: 3.4600 - val_accuracy50: 0.3597 - 220s/epoch - 40ms/step
Epoch 4/50
5429/5429 - 223s - loss: 3.2146 - accuracy50: 0.4155 - val_loss: 3.5049 - val_accuracy50: 0.3570 - 223s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 221s - loss: 3.2099 - accuracy50: 0.4181 - val_loss: 3.4677 - val_accuracy50: 0.3605 - 221s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 221s - loss: 3.2054 - accuracy50: 0.4202 - val_loss: 3.4857 - val_accuracy50: 0.3596 - 221s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 222s - loss: 3.2018 - accuracy50: 0.4219 - val_loss: 3.5304 - val_accuracy50: 0.3566 - 222s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 221s - loss: 3.1984 - accuracy50: 0.4236 - val_loss: 3.5814 - val_accuracy50: 0.3563 - 221s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 220s - loss: 3.1960 - accuracy50: 0.4252 - val_loss: 3.6039 - val_accuracy50: 0.3545 - 220s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 226s - loss: 3.1934 - accuracy50: 0.4256 - val_loss: 3.6459 - val_accuracy50: 0.3570 - 226s/epoch - 42ms/step
Epoch 11/50
5429/5429 - 224s - loss: 3.1910 - accuracy50: 0.4270 - val_loss: 3.6318 - val_accuracy50: 0.3596 - 224s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h50
Evaluating performance on  test set...
22048/22048 - 295s - 295s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1066952
{'0': {'precision': 0.386647597596855, 'recall': 0.6229169273802979, 'f1-score': 0.4771350964010098, 'support': 2133567}, '1': {'precision': 0.2261819337098285, 'recall': 0.0626571474093913, 'f1-score': 0.09813017481487116, 'support': 1318030}, '2': {'precision': 0.40438810024016936, 'recall': 0.33967518840614086, 'f1-score': 0.36921752822447107, 'support': 2192471}, 'accuracy': 0.38205546070671015, 'macro avg': {'precision': 0.33907254384895097, 'recall': 0.34174975439861005, 'f1-score': 0.3148275998134507, 'support': 5644068}, 'weighted avg': {'precision': 0.3560662825946035, 'recall': 0.38205546070671015, 'f1-score': 0.34670683164307947, 'support': 5644068}}
[[1329035  132689  671843]
 [ 810400   82584  425046]
 [1297894  149849  744728]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1392121
{'0': {'precision': 0.33459601714414006, 'recall': 0.8664185286127364, 'f1-score': 0.48275883065348446, 'support': 457541}, '1': {'precision': 0.34664364114082297, 'recall': 0.14236546226677807, 'f1-score': 0.2018370695717617, 'support': 459648}, '2': {'precision': 0.4203915773919468, 'recall': 0.014447521936831235, 'f1-score': 0.027935006515304315, 'support': 472607}, 'accuracy': 0.337235105008217, 'macro avg': {'precision': 0.36721041189230325, 'recall': 0.34107717093878187, 'f1-score': 0.23751030224685019, 'support': 1389796}, 'weighted avg': {'precision': 0.3677557388708269, 'recall': 0.337235105008217, 'f1-score': 0.23518433145204437, 'support': 1389796}}
[[396422  56327   4792]
 [389588  65438   4622]
 [398768  67011   6828]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1353323
{'0': {'precision': 0.3244670000248775, 'recall': 0.8443998446199663, 'f1-score': 0.4687957155437342, 'support': 154460}, '1': {'precision': 0.3649930327684632, 'recall': 0.14529058116232466, 'f1-score': 0.20784539578933897, 'support': 167664}, '2': {'precision': 0.4221048408665419, 'recall': 0.039079378246039756, 'f1-score': 0.07153581606694656, 'support': 161543}, 'accuracy': 0.3330783369549711, 'macro avg': {'precision': 0.37052162455329424, 'recall': 0.34292326800944356, 'f1-score': 0.24939230913333996, 'support': 483667}, 'weighted avg': {'precision': 0.37112609910958977, 'recall': 0.3330783369549711, 'f1-score': 0.24565349092952726, 'support': 483667}}
[[130426  18739   5295]
 [139956  24360   3348]
 [131588  23642   6313]]
training model: results/AAPL/W10/deepLOB_L2/h100
Epoch 1/50
5429/5429 - 226s - loss: 3.2642 - accuracy100: 0.3888 - val_loss: 3.3368 - val_accuracy100: 0.3478 - 226s/epoch - 42ms/step
Epoch 2/50
5429/5429 - 220s - loss: 3.2464 - accuracy100: 0.3988 - val_loss: 3.3680 - val_accuracy100: 0.3421 - 220s/epoch - 40ms/step
Epoch 3/50
5429/5429 - 225s - loss: 3.2391 - accuracy100: 0.4037 - val_loss: 3.3810 - val_accuracy100: 0.3582 - 225s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 225s - loss: 3.2344 - accuracy100: 0.4067 - val_loss: 3.4166 - val_accuracy100: 0.3613 - 225s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 227s - loss: 3.2308 - accuracy100: 0.4086 - val_loss: 3.3500 - val_accuracy100: 0.3498 - 227s/epoch - 42ms/step
Epoch 6/50
5429/5429 - 223s - loss: 3.2278 - accuracy100: 0.4103 - val_loss: 3.4109 - val_accuracy100: 0.3502 - 223s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 222s - loss: 3.2252 - accuracy100: 0.4117 - val_loss: 3.3575 - val_accuracy100: 0.3501 - 222s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 221s - loss: 3.2224 - accuracy100: 0.4131 - val_loss: 3.3700 - val_accuracy100: 0.3599 - 221s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 221s - loss: 3.2204 - accuracy100: 0.4145 - val_loss: 3.3465 - val_accuracy100: 0.3550 - 221s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 221s - loss: 3.2180 - accuracy100: 0.4157 - val_loss: 3.3518 - val_accuracy100: 0.3572 - 221s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 222s - loss: 3.2158 - accuracy100: 0.4168 - val_loss: 3.3435 - val_accuracy100: 0.3531 - 222s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h100
Evaluating performance on  test set...
22048/22048 - 302s - 302s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1181418
{'0': {'precision': 0.368681546796311, 'recall': 0.3438804976094765, 'f1-score': 0.3558494162497022, 'support': 2102050}, '1': {'precision': 0.23140885651890558, 'recall': 0.23148164033236687, 'f1-score': 0.23144524270345837, 'support': 1398936}, '2': {'precision': 0.37884000584926925, 'recall': 0.4037586989205266, 'f1-score': 0.39090263484588655, 'support': 2143082}, 'accuracy': 0.3387574352399723, 'macro avg': {'precision': 0.3263101363881619, 'recall': 0.32637361228745665, 'f1-score': 0.32606576459968234, 'support': 5644068}, 'weighted avg': {'precision': 0.3385144231008168, 'recall': 0.3387574352399723, 'f1-score': 0.33832454675689305, 'support': 5644068}}
[[722854 530445 848751]
 [505101 323828 570007]
 [732691 545103 865288]]
Evaluating performance on  train set...
5429/5429 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1194065
{'0': {'precision': 0.33336894931734173, 'recall': 0.43475383138217155, 'f1-score': 0.37737047154772696, 'support': 459299}, '1': {'precision': 0.3350477275092914, 'recall': 0.47734360347707755, 'f1-score': 0.3937336194661452, 'support': 458546}, '2': {'precision': 0.34030191532991083, 'recall': 0.09916071795588949, 'f1-score': 0.15357202041763948, 'support': 471951}, 'accuracy': 0.33484410661708625, 'macro avg': {'precision': 0.33623953071884793, 'recall': 0.3370860509383795, 'f1-score': 0.3082253704771706, 'support': 1389796}, 'weighted avg': {'precision': 0.33627715834039523, 'recall': 0.33484410661708625, 'f1-score': 0.30677115568849517, 'support': 1389796}}
[[199682 214456  45161]
 [194100 218884  45562]
 [205200 219952  46799]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1138467
{'0': {'precision': 0.31831300194554324, 'recall': 0.45843514288749604, 'f1-score': 0.3757353461364737, 'support': 150608}, '1': {'precision': 0.3788494305651635, 'recall': 0.46609128763430113, 'f1-score': 0.41796640902315724, 'support': 175073}, '2': {'precision': 0.33010200109008797, 'recall': 0.10733862494145051, 'f1-score': 0.1620000191060289, 'support': 157986}, 'accuracy': 0.34652353788867135, 'macro avg': {'precision': 0.3424214778669316, 'recall': 0.3439550184877492, 'f1-score': 0.3185672580885533, 'support': 483667}, 'weighted avg': {'precision': 0.3440761633490974, 'recall': 0.34652353788867135, 'f1-score': 0.3212067748188699, 'support': 483667}}
[[69044 65539 16025]
 [75084 81600 18389]
 [72778 68250 16958]]
training model: results/AAPL/W10/deepLOB_L2/h200
Epoch 1/50
5429/5429 - 232s - loss: 3.2652 - accuracy200: 0.3873 - val_loss: 3.3262 - val_accuracy200: 0.3390 - 232s/epoch - 43ms/step
Epoch 2/50
5429/5429 - 229s - loss: 3.2466 - accuracy200: 0.3985 - val_loss: 3.3276 - val_accuracy200: 0.3434 - 229s/epoch - 42ms/step
Epoch 3/50
5429/5429 - 228s - loss: 3.2380 - accuracy200: 0.4038 - val_loss: 3.3316 - val_accuracy200: 0.3372 - 228s/epoch - 42ms/step
Epoch 4/50
5429/5429 - 225s - loss: 3.2316 - accuracy200: 0.4075 - val_loss: 3.3301 - val_accuracy200: 0.3377 - 225s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 226s - loss: 3.2273 - accuracy200: 0.4102 - val_loss: 3.3369 - val_accuracy200: 0.3391 - 226s/epoch - 42ms/step
Epoch 6/50
5429/5429 - 226s - loss: 3.2234 - accuracy200: 0.4120 - val_loss: 3.3443 - val_accuracy200: 0.3261 - 226s/epoch - 42ms/step
Epoch 7/50
5429/5429 - 226s - loss: 3.2200 - accuracy200: 0.4140 - val_loss: 3.3361 - val_accuracy200: 0.3386 - 226s/epoch - 42ms/step
Epoch 8/50
5429/5429 - 225s - loss: 3.2167 - accuracy200: 0.4157 - val_loss: 3.3318 - val_accuracy200: 0.3424 - 225s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 224s - loss: 3.2134 - accuracy200: 0.4170 - val_loss: 3.3324 - val_accuracy200: 0.3486 - 224s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 223s - loss: 3.2112 - accuracy200: 0.4185 - val_loss: 3.3379 - val_accuracy200: 0.3415 - 223s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 223s - loss: 3.2085 - accuracy200: 0.4196 - val_loss: 3.3374 - val_accuracy200: 0.3449 - 223s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h200
Evaluating performance on  test set...
22048/22048 - 309s - 309s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1090815
{'0': {'precision': 0.37635270905072765, 'recall': 0.45063241586975444, 'f1-score': 0.41015666518781363, 'support': 2115143}, '1': {'precision': 0.2488868812611216, 'recall': 0.16061959864204536, 'f1-score': 0.19524043177477735, 'support': 1413302}, '2': {'precision': 0.3693450177958596, 'recall': 0.38396869385519067, 'f1-score': 0.3765149150257091, 'support': 2115623}, 'accuracy': 0.3530235638550067, 'macro avg': {'precision': 0.3315282027025696, 'recall': 0.3317402361223301, 'f1-score': 0.32730400399610005, 'support': 5644068}, 'weighted avg': {'precision': 0.3418078839099952, 'recall': 0.3530235638550067, 'f1-score': 0.34373032111855134, 'support': 5644068}}
[[953152 339445 822546]
 [621789 227004 564509]
 [957662 345628 812333]]
Evaluating performance on  train set...
5429/5429 - 78s - 78s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096095
{'0': {'precision': 0.33388061833561467, 'recall': 0.3994431717146807, 'f1-score': 0.36373109660847003, 'support': 462261}, '1': {'precision': 0.33107412115367757, 'recall': 0.39674549413991966, 'f1-score': 0.3609470342210244, 'support': 456905}, '2': {'precision': 0.33789722259678384, 'recall': 0.20765569555701932, 'f1-score': 0.2572299787986424, 'support': 470630}, 'accuracy': 0.3336108320933432, 'macro avg': {'precision': 0.33428398736202536, 'recall': 0.33461478713720655, 'f1-score': 0.327302703209379, 'support': 1389796}, 'weighted avg': {'precision': 0.33431811554277385, 'recall': 0.3336108320933432, 'f1-score': 0.3267510843620864, 'support': 1389796}}
[[184647 181595  96019]
 [180151 181275  95479]
 [188235 184666  97729]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1084695
{'0': {'precision': 0.3205476999288766, 'recall': 0.4229575329610112, 'f1-score': 0.3646996910331715, 'support': 152377}, '1': {'precision': 0.3681478654380895, 'recall': 0.39236674046568926, 'f1-score': 0.37987167333804034, 'support': 172089}, '2': {'precision': 0.3259541523014577, 'recall': 0.20310173931068273, 'f1-score': 0.25026412640915796, 'support': 159201}, 'accuracy': 0.33970686443358755, 'macro avg': {'precision': 0.3382165725561413, 'recall': 0.33947533757912773, 'f1-score': 0.33161183026012325, 'support': 483667}, 'weighted avg': {'precision': 0.3392634227432969, 'recall': 0.33970686443358755, 'f1-score': 0.33243095022421615, 'support': 483667}}
[[64449 56930 30998]
 [68701 67522 35866]
 [67909 58958 32334]]
training model: results/AAPL/W10/deepLOB_L2/h300
Epoch 1/50
5429/5429 - 227s - loss: 3.2557 - accuracy300: 0.3921 - val_loss: 3.3594 - val_accuracy300: 0.3484 - 227s/epoch - 42ms/step
Epoch 2/50
5429/5429 - 223s - loss: 3.2305 - accuracy300: 0.4070 - val_loss: 3.3443 - val_accuracy300: 0.3417 - 223s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 222s - loss: 3.2200 - accuracy300: 0.4126 - val_loss: 3.3738 - val_accuracy300: 0.3473 - 222s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 223s - loss: 3.2127 - accuracy300: 0.4163 - val_loss: 3.3866 - val_accuracy300: 0.3481 - 223s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 224s - loss: 3.2074 - accuracy300: 0.4187 - val_loss: 3.3631 - val_accuracy300: 0.3487 - 224s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 224s - loss: 3.2026 - accuracy300: 0.4209 - val_loss: 3.3967 - val_accuracy300: 0.3516 - 224s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 222s - loss: 3.1986 - accuracy300: 0.4229 - val_loss: 3.4047 - val_accuracy300: 0.3513 - 222s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 224s - loss: 3.1951 - accuracy300: 0.4249 - val_loss: 3.3911 - val_accuracy300: 0.3512 - 224s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 223s - loss: 3.1926 - accuracy300: 0.4257 - val_loss: 3.3953 - val_accuracy300: 0.3516 - 223s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 223s - loss: 3.1890 - accuracy300: 0.4272 - val_loss: 3.4279 - val_accuracy300: 0.3514 - 223s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 221s - loss: 3.1861 - accuracy300: 0.4284 - val_loss: 3.4268 - val_accuracy300: 0.3495 - 221s/epoch - 41ms/step
Epoch 12/50
5429/5429 - 220s - loss: 3.1836 - accuracy300: 0.4297 - val_loss: 3.4131 - val_accuracy300: 0.3466 - 220s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h300
Evaluating performance on  test set...
22048/22048 - 294s - 294s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1199424
{'0': {'precision': 0.3716461263750967, 'recall': 0.18057240550448825, 'f1-score': 0.24305245536602108, 'support': 2115074}, '1': {'precision': 0.25688238089755644, 'recall': 0.3292089991321976, 'f1-score': 0.2885829561447816, 'support': 1430049}, '2': {'precision': 0.37106310031949985, 'recall': 0.4921224710509327, 'f1-score': 0.4231036660057579, 'support': 2098945}, 'accuracy': 0.3340936005732036, 'macro avg': {'precision': 0.33319720253071766, 'recall': 0.3339679585625395, 'f1-score': 0.31824635917218685, 'support': 5644068}, 'weighted avg': {'precision': 0.34235138380986263, 'recall': 0.3340936005732036, 'f1-score': 0.32154698013510397, 'support': 5644068}}
[[ 381924  677948 1055202]
 [ 263678  470785  695586]
 [ 382053  683954 1032938]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1179533
{'0': {'precision': 0.3347161688104603, 'recall': 0.2714211211392416, 'f1-score': 0.2997638960952413, 'support': 464028}, '1': {'precision': 0.32873664195629154, 'recall': 0.5982370461215014, 'f1-score': 0.4243107224405474, 'support': 456620}, '2': {'precision': 0.3378305834921887, 'recall': 0.13145745052733893, 'f1-score': 0.18926690644832625, 'support': 469148}, 'accuracy': 0.33155009799999424, 'macro avg': {'precision': 0.33376113141964686, 'recall': 0.33370520592936065, 'f1-score': 0.30444717499470497, 'support': 1389796}, 'weighted avg': {'precision': 0.33380290518540523, 'recall': 0.33155009799999424, 'f1-score': 0.3033839454743752, 'support': 1389796}}
[[125947 277775  60306]
 [122876 273167  60577]
 [127457 280018  61673]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1149127
{'0': {'precision': 0.32182132345404224, 'recall': 0.28577279908459086, 'f1-score': 0.30272768282982027, 'support': 153811}, '1': {'precision': 0.3542085658442625, 'recall': 0.5926854122972285, 'f1-score': 0.44341659094434965, 'support': 168786}, '2': {'precision': 0.33412721733347767, 'recall': 0.13413422735456634, 'f1-score': 0.19142253390097064, 'support': 161070}, 'accuracy': 0.34237812379178234, 'macro avg': {'precision': 0.3367190355439275, 'recall': 0.33753081291212855, 'f1-score': 0.31252226922504683, 'support': 483667}, 'weighted avg': {'precision': 0.33722163693674084, 'recall': 0.3423781237917824, 'f1-score': 0.31475744236902625, 'support': 483667}}
[[ 43955  89280  20576]
 [ 46269 100037  22480]
 [ 46358  93107  21605]]
training model: results/AAPL/W10/deepLOB_L2/h500
Epoch 1/50
5429/5429 - 227s - loss: 3.2387 - accuracy500: 0.4034 - val_loss: 3.3219 - val_accuracy500: 0.3639 - 227s/epoch - 42ms/step
Epoch 2/50
5429/5429 - 221s - loss: 3.2012 - accuracy500: 0.4232 - val_loss: 3.3142 - val_accuracy500: 0.3585 - 221s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 222s - loss: 3.1861 - accuracy500: 0.4297 - val_loss: 3.3254 - val_accuracy500: 0.3628 - 222s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 220s - loss: 3.1759 - accuracy500: 0.4337 - val_loss: 3.3338 - val_accuracy500: 0.3619 - 220s/epoch - 41ms/step
Epoch 5/50
5429/5429 - 222s - loss: 3.1679 - accuracy500: 0.4368 - val_loss: 3.3451 - val_accuracy500: 0.3605 - 222s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 221s - loss: 3.1616 - accuracy500: 0.4392 - val_loss: 3.4047 - val_accuracy500: 0.3584 - 221s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 224s - loss: 3.1561 - accuracy500: 0.4414 - val_loss: 3.4324 - val_accuracy500: 0.3614 - 224s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 224s - loss: 3.1515 - accuracy500: 0.4433 - val_loss: 3.4197 - val_accuracy500: 0.3454 - 224s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 222s - loss: 3.1470 - accuracy500: 0.4451 - val_loss: 3.4318 - val_accuracy500: 0.3490 - 222s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 221s - loss: 3.1425 - accuracy500: 0.4467 - val_loss: 3.4597 - val_accuracy500: 0.3501 - 221s/epoch - 41ms/step
Epoch 11/50
5429/5429 - 221s - loss: 3.1390 - accuracy500: 0.4477 - val_loss: 3.4755 - val_accuracy500: 0.3577 - 221s/epoch - 41ms/step
Epoch 12/50
5429/5429 - 222s - loss: 3.1361 - accuracy500: 0.4485 - val_loss: 3.4900 - val_accuracy500: 0.3563 - 222s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h500
Evaluating performance on  test set...
22048/22048 - 296s - 296s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1261785
{'0': {'precision': 0.3826645865727476, 'recall': 0.20867334923052505, 'f1-score': 0.2700719709571101, 'support': 2135807}, '1': {'precision': 0.25634138424098557, 'recall': 0.3647154493428924, 'f1-score': 0.3010728103549751, 'support': 1411717}, '2': {'precision': 0.37314904940657473, 'recall': 0.43976467939618724, 'f1-score': 0.4037273975455016, 'support': 2096544}, 'accuracy': 0.3335443513437471, 'macro avg': {'precision': 0.3373850067401027, 'recall': 0.33771782598986827, 'f1-score': 0.3249573929525289, 'support': 5644068}, 'weighted avg': {'precision': 0.3475334799704344, 'recall': 0.3335443513437471, 'f1-score': 0.3274736349118265, 'support': 5644068}}
[[445686 745013 945108]
 [293111 514875 603731]
 [425894 748664 921986]]
Evaluating performance on  train set...
5429/5429 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.114703
{'0': {'precision': 0.3360471872265002, 'recall': 0.09819183640138052, 'f1-score': 0.15197662409800053, 'support': 465334}, '1': {'precision': 0.3292043701451603, 'recall': 0.8792732561960298, 'f1-score': 0.4790499917948412, 'support': 456502}, '2': {'precision': 0.34904786710655783, 'recall': 0.02577357039063168, 'f1-score': 0.04800264271244185, 'support': 467960}, 'accuracy': 0.3303671905804881, 'macro avg': {'precision': 0.33809980815940605, 'recall': 0.3344128876626807, 'f1-score': 0.22634308620176116, 'support': 1389796}, 'weighted avg': {'precision': 0.3381770238884318, 'recall': 0.3303671905804881, 'f1-score': 0.22440018998188357, 'support': 1389796}}
[[ 45692 408116  11526]
 [ 44145 401390  10967]
 [ 46132 409767  12061]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1055799
{'0': {'precision': 0.3232239542187711, 'recall': 0.11063260083889519, 'f1-score': 0.16484299380426184, 'support': 151628}, '1': {'precision': 0.36249473139127397, 'recall': 0.8705001850823616, 'f1-score': 0.5118459558129609, 'support': 172896}, '2': {'precision': 0.36366379050262476, 'recall': 0.03787159975619411, 'f1-score': 0.0685993307382367, 'support': 159143}, 'accuracy': 0.3583209108746307, 'macro avg': {'precision': 0.34979415870422326, 'recall': 0.3396681285591503, 'f1-score': 0.24842942678515312, 'support': 483667}, 'weighted avg': {'precision': 0.35056813349033267, 'recall': 0.3583209108746307, 'f1-score': 0.2572183653887189, 'support': 483667}}
[[ 16775 129456   5397]
 [ 17241 150506   5149]
 [ 17883 135233   6027]]
training model: results/AAPL/W10/deepLOB_L2/h1000
Epoch 1/50
5429/5429 - 228s - loss: 3.1998 - accuracy1000: 0.4256 - val_loss: 3.3520 - val_accuracy1000: 0.3392 - 228s/epoch - 42ms/step
Epoch 2/50
5429/5429 - 222s - loss: 3.1419 - accuracy1000: 0.4511 - val_loss: 3.3954 - val_accuracy1000: 0.3528 - 222s/epoch - 41ms/step
Epoch 3/50
5429/5429 - 221s - loss: 3.1248 - accuracy1000: 0.4572 - val_loss: 3.3758 - val_accuracy1000: 0.3472 - 221s/epoch - 41ms/step
Epoch 4/50
5429/5429 - 220s - loss: 3.1118 - accuracy1000: 0.4612 - val_loss: 3.4514 - val_accuracy1000: 0.3459 - 220s/epoch - 40ms/step
Epoch 5/50
5429/5429 - 221s - loss: 3.1025 - accuracy1000: 0.4638 - val_loss: 3.5630 - val_accuracy1000: 0.3488 - 221s/epoch - 41ms/step
Epoch 6/50
5429/5429 - 220s - loss: 3.0933 - accuracy1000: 0.4666 - val_loss: 3.6112 - val_accuracy1000: 0.3366 - 220s/epoch - 41ms/step
Epoch 7/50
5429/5429 - 223s - loss: 3.0854 - accuracy1000: 0.4695 - val_loss: 3.6040 - val_accuracy1000: 0.3363 - 223s/epoch - 41ms/step
Epoch 8/50
5429/5429 - 220s - loss: 3.0789 - accuracy1000: 0.4716 - val_loss: 3.6109 - val_accuracy1000: 0.3263 - 220s/epoch - 41ms/step
Epoch 9/50
5429/5429 - 221s - loss: 3.0733 - accuracy1000: 0.4730 - val_loss: 3.6099 - val_accuracy1000: 0.3276 - 221s/epoch - 41ms/step
Epoch 10/50
5429/5429 - 220s - loss: 3.0693 - accuracy1000: 0.4743 - val_loss: 3.7183 - val_accuracy1000: 0.3326 - 220s/epoch - 40ms/step
Epoch 11/50
5429/5429 - 223s - loss: 3.0648 - accuracy1000: 0.4755 - val_loss: 3.7327 - val_accuracy1000: 0.3343 - 223s/epoch - 41ms/step
testing model: results/AAPL/W10/deepLOB_L2/h1000
Evaluating performance on  test set...
22048/22048 - 304s - 304s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1249549
{'0': {'precision': 0.3788887380516981, 'recall': 0.4399527473923441, 'f1-score': 0.40714385928179553, 'support': 2156918}, '1': {'precision': 0.23756890899434077, 'recall': 0.13307612264040333, 'f1-score': 0.17059313667008916, 'support': 1364640}, '2': {'precision': 0.37278210645889, 'recall': 0.41714762239047165, 'f1-score': 0.393718994740334, 'support': 2122510}, 'accuracy': 0.357179077218772, 'macro avg': {'precision': 0.32974658450164296, 'recall': 0.3300588308077397, 'f1-score': 0.3238186635640729, 'support': 5644068}, 'weighted avg': {'precision': 0.3424235363307261, 'recall': 0.357179077218772, 'f1-score': 0.3449013442478277, 'support': 5644068}}
[[948942 290343 917633]
 [610958 181601 572081]
 [944640 292470 885400]]
Evaluating performance on  train set...
5429/5429 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188223
{'0': {'precision': 0.3331028810508624, 'recall': 0.5436981983734775, 'f1-score': 0.4131095194802315, 'support': 462582}, '1': {'precision': 0.3328681399694824, 'recall': 0.42418588392086604, 'f1-score': 0.3730195249645764, 'support': 457705}, '2': {'precision': 0.35077395171784265, 'recall': 0.03846784619677152, 'f1-score': 0.0693323198937424, 'support': 469509}, 'accuracy': 0.3336590406073985, 'macro avg': {'precision': 0.33891499091272914, 'recall': 0.3354506428303717, 'f1-score': 0.28515378811285014, 'support': 1389796}, 'weighted avg': {'precision': 0.3389953174596088, 'recall': 0.3336590406073985, 'f1-score': 0.2837697601627196, 'support': 1389796}}
[[251505 194049  17028]
 [247153 194152  16400]
 [256379 195069  18061]]
Evaluating performance on  val set...
1890/1890 - 26s - 26s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1181973
{'0': {'precision': 0.31704013925639146, 'recall': 0.5705005099135134, 'f1-score': 0.40757921629389565, 'support': 151006}, '1': {'precision': 0.37101394429639906, 'recall': 0.4141297396875312, 'f1-score': 0.3913880001996085, 'support': 170449}, '2': {'precision': 0.35782482357824824, 'recall': 0.04782630138337484, 'f1-score': 0.08437515294220008, 'support': 162212}, 'accuracy': 0.3400996966921456, 'macro avg': {'precision': 0.3486263023770129, 'recall': 0.34415218366147315, 'f1-score': 0.2944474564785681, 'support': 483667}, 'weighted avg': {'precision': 0.34973938544949806, 'recall': 0.3400996966921456, 'f1-score': 0.2934772533390933, 'support': 483667}}
[[86149 57907  6950]
 [92888 70588  6973]
 [92692 61762  7758]]
training model: results/AAPL/W10/deepOF_L2/h10
Epoch 1/50
5429/5429 - 144s - loss: 3.1686 - accuracy10: 0.4345 - val_loss: 3.2909 - val_accuracy10: 0.4093 - 144s/epoch - 27ms/step
Epoch 2/50
5429/5429 - 122s - loss: 3.1194 - accuracy10: 0.4546 - val_loss: 3.2636 - val_accuracy10: 0.4165 - 122s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 120s - loss: 3.1034 - accuracy10: 0.4610 - val_loss: 3.2696 - val_accuracy10: 0.4182 - 120s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 118s - loss: 3.0934 - accuracy10: 0.4642 - val_loss: 3.2633 - val_accuracy10: 0.4202 - 118s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 118s - loss: 3.0857 - accuracy10: 0.4668 - val_loss: 3.2603 - val_accuracy10: 0.4200 - 118s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 117s - loss: 3.0797 - accuracy10: 0.4691 - val_loss: 3.2582 - val_accuracy10: 0.4211 - 117s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 117s - loss: 3.0747 - accuracy10: 0.4705 - val_loss: 3.2573 - val_accuracy10: 0.4206 - 117s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 118s - loss: 3.0701 - accuracy10: 0.4721 - val_loss: 3.2674 - val_accuracy10: 0.4215 - 118s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 117s - loss: 3.0666 - accuracy10: 0.4729 - val_loss: 3.2616 - val_accuracy10: 0.4226 - 117s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 119s - loss: 3.0629 - accuracy10: 0.4744 - val_loss: 3.2516 - val_accuracy10: 0.4229 - 119s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 118s - loss: 3.0601 - accuracy10: 0.4754 - val_loss: 3.2500 - val_accuracy10: 0.4231 - 118s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 117s - loss: 3.0570 - accuracy10: 0.4762 - val_loss: 3.2442 - val_accuracy10: 0.4253 - 117s/epoch - 22ms/step
Epoch 13/50
5429/5429 - 117s - loss: 3.0541 - accuracy10: 0.4771 - val_loss: 3.2492 - val_accuracy10: 0.4258 - 117s/epoch - 22ms/step
Epoch 14/50
5429/5429 - 119s - loss: 3.0519 - accuracy10: 0.4780 - val_loss: 3.2415 - val_accuracy10: 0.4256 - 119s/epoch - 22ms/step
Epoch 15/50
5429/5429 - 120s - loss: 3.0494 - accuracy10: 0.4791 - val_loss: 3.2366 - val_accuracy10: 0.4276 - 120s/epoch - 22ms/step
Epoch 16/50
5429/5429 - 116s - loss: 3.0470 - accuracy10: 0.4796 - val_loss: 3.2344 - val_accuracy10: 0.4275 - 116s/epoch - 21ms/step
Epoch 17/50
5429/5429 - 117s - loss: 3.0452 - accuracy10: 0.4801 - val_loss: 3.2288 - val_accuracy10: 0.4305 - 117s/epoch - 22ms/step
Epoch 18/50
5429/5429 - 117s - loss: 3.0433 - accuracy10: 0.4809 - val_loss: 3.2237 - val_accuracy10: 0.4307 - 117s/epoch - 22ms/step
Epoch 19/50
5429/5429 - 117s - loss: 3.0413 - accuracy10: 0.4813 - val_loss: 3.2246 - val_accuracy10: 0.4310 - 117s/epoch - 22ms/step
Epoch 20/50
5429/5429 - 120s - loss: 3.0392 - accuracy10: 0.4824 - val_loss: 3.2166 - val_accuracy10: 0.4326 - 120s/epoch - 22ms/step
Epoch 21/50
5429/5429 - 118s - loss: 3.0376 - accuracy10: 0.4825 - val_loss: 3.2172 - val_accuracy10: 0.4317 - 118s/epoch - 22ms/step
Epoch 22/50
5429/5429 - 117s - loss: 3.0360 - accuracy10: 0.4829 - val_loss: 3.2211 - val_accuracy10: 0.4322 - 117s/epoch - 22ms/step
Epoch 23/50
5429/5429 - 118s - loss: 3.0345 - accuracy10: 0.4837 - val_loss: 3.2247 - val_accuracy10: 0.4319 - 118s/epoch - 22ms/step
Epoch 24/50
5429/5429 - 118s - loss: 3.0325 - accuracy10: 0.4841 - val_loss: 3.2096 - val_accuracy10: 0.4352 - 118s/epoch - 22ms/step
Epoch 25/50
5429/5429 - 117s - loss: 3.0308 - accuracy10: 0.4843 - val_loss: 3.2120 - val_accuracy10: 0.4339 - 117s/epoch - 22ms/step
Epoch 26/50
5429/5429 - 117s - loss: 3.0295 - accuracy10: 0.4850 - val_loss: 3.2073 - val_accuracy10: 0.4358 - 117s/epoch - 22ms/step
Epoch 27/50
5429/5429 - 118s - loss: 3.0281 - accuracy10: 0.4854 - val_loss: 3.2051 - val_accuracy10: 0.4348 - 118s/epoch - 22ms/step
Epoch 28/50
5429/5429 - 117s - loss: 3.0266 - accuracy10: 0.4859 - val_loss: 3.2129 - val_accuracy10: 0.4352 - 117s/epoch - 22ms/step
Epoch 29/50
5429/5429 - 118s - loss: 3.0253 - accuracy10: 0.4864 - val_loss: 3.2006 - val_accuracy10: 0.4366 - 118s/epoch - 22ms/step
Epoch 30/50
5429/5429 - 118s - loss: 3.0236 - accuracy10: 0.4869 - val_loss: 3.2048 - val_accuracy10: 0.4358 - 118s/epoch - 22ms/step
Epoch 31/50
5429/5429 - 118s - loss: 3.0223 - accuracy10: 0.4871 - val_loss: 3.2076 - val_accuracy10: 0.4355 - 118s/epoch - 22ms/step
Epoch 32/50
5429/5429 - 117s - loss: 3.0208 - accuracy10: 0.4879 - val_loss: 3.2037 - val_accuracy10: 0.4374 - 117s/epoch - 22ms/step
Epoch 33/50
5429/5429 - 117s - loss: 3.0197 - accuracy10: 0.4881 - val_loss: 3.2087 - val_accuracy10: 0.4356 - 117s/epoch - 22ms/step
Epoch 34/50
5429/5429 - 119s - loss: 3.0186 - accuracy10: 0.4885 - val_loss: 3.2004 - val_accuracy10: 0.4376 - 119s/epoch - 22ms/step
Epoch 35/50
5429/5429 - 117s - loss: 3.0177 - accuracy10: 0.4886 - val_loss: 3.1987 - val_accuracy10: 0.4374 - 117s/epoch - 22ms/step
Epoch 36/50
5429/5429 - 117s - loss: 3.0162 - accuracy10: 0.4893 - val_loss: 3.1975 - val_accuracy10: 0.4380 - 117s/epoch - 22ms/step
Epoch 37/50
5429/5429 - 117s - loss: 3.0147 - accuracy10: 0.4897 - val_loss: 3.2075 - val_accuracy10: 0.4354 - 117s/epoch - 22ms/step
Epoch 38/50
5429/5429 - 118s - loss: 3.0139 - accuracy10: 0.4898 - val_loss: 3.1913 - val_accuracy10: 0.4393 - 118s/epoch - 22ms/step
Epoch 39/50
5429/5429 - 117s - loss: 3.0123 - accuracy10: 0.4904 - val_loss: 3.2054 - val_accuracy10: 0.4366 - 117s/epoch - 22ms/step
Epoch 40/50
5429/5429 - 118s - loss: 3.0112 - accuracy10: 0.4907 - val_loss: 3.1973 - val_accuracy10: 0.4388 - 118s/epoch - 22ms/step
Epoch 41/50
5429/5429 - 117s - loss: 3.0100 - accuracy10: 0.4910 - val_loss: 3.1974 - val_accuracy10: 0.4385 - 117s/epoch - 22ms/step
Epoch 42/50
5429/5429 - 118s - loss: 3.0089 - accuracy10: 0.4913 - val_loss: 3.1929 - val_accuracy10: 0.4388 - 118s/epoch - 22ms/step
Epoch 43/50
5429/5429 - 117s - loss: 3.0077 - accuracy10: 0.4918 - val_loss: 3.1969 - val_accuracy10: 0.4383 - 117s/epoch - 22ms/step
Epoch 44/50
5429/5429 - 117s - loss: 3.0066 - accuracy10: 0.4918 - val_loss: 3.1958 - val_accuracy10: 0.4386 - 117s/epoch - 22ms/step
Epoch 45/50
5429/5429 - 118s - loss: 3.0054 - accuracy10: 0.4925 - val_loss: 3.2032 - val_accuracy10: 0.4360 - 118s/epoch - 22ms/step
Epoch 46/50
5429/5429 - 117s - loss: 3.0049 - accuracy10: 0.4924 - val_loss: 3.2011 - val_accuracy10: 0.4374 - 117s/epoch - 22ms/step
Epoch 47/50
5429/5429 - 118s - loss: 3.0036 - accuracy10: 0.4928 - val_loss: 3.2045 - val_accuracy10: 0.4373 - 118s/epoch - 22ms/step
Epoch 48/50
5429/5429 - 121s - loss: 3.0026 - accuracy10: 0.4931 - val_loss: 3.1993 - val_accuracy10: 0.4380 - 121s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h10
Evaluating performance on  test set...
22048/22048 - 167s - 167s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.028718
{'0': {'precision': 0.48514576257670305, 'recall': 0.600750201803633, 'f1-score': 0.5367943602929731, 'support': 2146889}, '1': {'precision': 0.46274235283823145, 'recall': 0.02805977616154572, 'f1-score': 0.052911126802034227, 'support': 1319255}, '2': {'precision': 0.48092148985458766, 'recall': 0.6416055877192861, 'f1-score': 0.5497629791022673, 'support': 2177919}, 'accuracy': 0.4826535423151726, 'macro avg': {'precision': 0.4762698684231741, 'recall': 0.42347185522815495, 'f1-score': 0.37982282206575824, 'support': 5644063}, 'weighted avg': {'precision': 0.47827908973176775, 'recall': 0.4826535423151726, 'f1-score': 0.42869479196948534, 'support': 5644063}}
[[1289744   20678  836467]
 [ 610470   37018  671767]
 [ 758253   22301 1397365]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0436834
{'0': {'precision': 0.43874564200085764, 'recall': 0.6627879517915677, 'f1-score': 0.5279826726265469, 'support': 461579}, '1': {'precision': 0.5310968432316747, 'recall': 0.10786721493897138, 'f1-score': 0.17931505414027699, 'support': 460112}, '2': {'precision': 0.46555793704846227, 'recall': 0.5958056329362705, 'f1-score': 0.5226899607184623, 'support': 468104}, 'accuracy': 0.4565126511463921, 'macro avg': {'precision': 0.4784668074269982, 'recall': 0.4554869332222699, 'f1-score': 0.4099958958284287, 'support': 1389795}, 'weighted avg': {'precision': 0.4783506473877511, 'recall': 0.4565126511463921, 'f1-score': 0.4107684828417393, 'support': 1389795}}
[[305929  18109 137541]
 [227857  49631 182624]
 [163495  25710 278899]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0621259
{'0': {'precision': 0.42688291726294586, 'recall': 0.6316367343737747, 'f1-score': 0.5094566386235688, 'support': 153012}, '1': {'precision': 0.5569531573416553, 'recall': 0.09992629792777197, 'f1-score': 0.1694504727949155, 'support': 175029}, '2': {'precision': 0.43661560258567256, 'recall': 0.6336601853160783, 'f1-score': 0.5169993132120183, 'support': 155626}, 'accuracy': 0.4398728877512834, 'macro avg': {'precision': 0.47348389239675787, 'recall': 0.4550744058725416, 'f1-score': 0.3986354748768342, 'support': 483667}, 'weighted avg': {'precision': 0.47708423952965223, 'recall': 0.4398728877512834, 'f1-score': 0.38884244968092585, 'support': 483667}}
[[96648  6116 50248]
 [80541 17490 76998]
 [49215  7797 98614]]
training model: results/AAPL/W10/deepOF_L2/h20
Epoch 1/50
5429/5429 - 129s - loss: 3.2151 - accuracy20: 0.4135 - val_loss: 3.2557 - val_accuracy20: 0.3911 - 129s/epoch - 24ms/step
Epoch 2/50
5429/5429 - 122s - loss: 3.1797 - accuracy20: 0.4298 - val_loss: 3.2323 - val_accuracy20: 0.4003 - 122s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 122s - loss: 3.1682 - accuracy20: 0.4345 - val_loss: 3.2235 - val_accuracy20: 0.4040 - 122s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 118s - loss: 3.1603 - accuracy20: 0.4373 - val_loss: 3.2250 - val_accuracy20: 0.4034 - 118s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 116s - loss: 3.1540 - accuracy20: 0.4401 - val_loss: 3.2269 - val_accuracy20: 0.4025 - 116s/epoch - 21ms/step
Epoch 6/50
5429/5429 - 117s - loss: 3.1485 - accuracy20: 0.4422 - val_loss: 3.2226 - val_accuracy20: 0.4049 - 117s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 117s - loss: 3.1441 - accuracy20: 0.4442 - val_loss: 3.2265 - val_accuracy20: 0.4053 - 117s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 117s - loss: 3.1406 - accuracy20: 0.4455 - val_loss: 3.2278 - val_accuracy20: 0.4042 - 117s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 117s - loss: 3.1368 - accuracy20: 0.4469 - val_loss: 3.2316 - val_accuracy20: 0.4047 - 117s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 117s - loss: 3.1343 - accuracy20: 0.4480 - val_loss: 3.2245 - val_accuracy20: 0.4049 - 117s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 117s - loss: 3.1311 - accuracy20: 0.4491 - val_loss: 3.2322 - val_accuracy20: 0.4031 - 117s/epoch - 21ms/step
Epoch 12/50
5429/5429 - 116s - loss: 3.1285 - accuracy20: 0.4501 - val_loss: 3.2213 - val_accuracy20: 0.4083 - 116s/epoch - 21ms/step
Epoch 13/50
5429/5429 - 117s - loss: 3.1263 - accuracy20: 0.4509 - val_loss: 3.2222 - val_accuracy20: 0.4066 - 117s/epoch - 22ms/step
Epoch 14/50
5429/5429 - 117s - loss: 3.1243 - accuracy20: 0.4517 - val_loss: 3.2197 - val_accuracy20: 0.4082 - 117s/epoch - 21ms/step
Epoch 15/50
5429/5429 - 116s - loss: 3.1223 - accuracy20: 0.4523 - val_loss: 3.2184 - val_accuracy20: 0.4087 - 116s/epoch - 21ms/step
Epoch 16/50
5429/5429 - 116s - loss: 3.1201 - accuracy20: 0.4533 - val_loss: 3.2163 - val_accuracy20: 0.4092 - 116s/epoch - 21ms/step
Epoch 17/50
5429/5429 - 117s - loss: 3.1181 - accuracy20: 0.4543 - val_loss: 3.2107 - val_accuracy20: 0.4114 - 117s/epoch - 22ms/step
Epoch 18/50
5429/5429 - 122s - loss: 3.1162 - accuracy20: 0.4546 - val_loss: 3.2072 - val_accuracy20: 0.4130 - 122s/epoch - 22ms/step
Epoch 19/50
5429/5429 - 121s - loss: 3.1146 - accuracy20: 0.4554 - val_loss: 3.2089 - val_accuracy20: 0.4143 - 121s/epoch - 22ms/step
Epoch 20/50
5429/5429 - 119s - loss: 3.1130 - accuracy20: 0.4558 - val_loss: 3.2081 - val_accuracy20: 0.4135 - 119s/epoch - 22ms/step
Epoch 21/50
5429/5429 - 119s - loss: 3.1113 - accuracy20: 0.4563 - val_loss: 3.2092 - val_accuracy20: 0.4133 - 119s/epoch - 22ms/step
Epoch 22/50
5429/5429 - 117s - loss: 3.1099 - accuracy20: 0.4569 - val_loss: 3.2061 - val_accuracy20: 0.4163 - 117s/epoch - 22ms/step
Epoch 23/50
5429/5429 - 118s - loss: 3.1082 - accuracy20: 0.4574 - val_loss: 3.2110 - val_accuracy20: 0.4136 - 118s/epoch - 22ms/step
Epoch 24/50
5429/5429 - 117s - loss: 3.1071 - accuracy20: 0.4578 - val_loss: 3.2055 - val_accuracy20: 0.4159 - 117s/epoch - 22ms/step
Epoch 25/50
5429/5429 - 117s - loss: 3.1053 - accuracy20: 0.4586 - val_loss: 3.2012 - val_accuracy20: 0.4178 - 117s/epoch - 22ms/step
Epoch 26/50
5429/5429 - 119s - loss: 3.1037 - accuracy20: 0.4593 - val_loss: 3.2050 - val_accuracy20: 0.4175 - 119s/epoch - 22ms/step
Epoch 27/50
5429/5429 - 118s - loss: 3.1022 - accuracy20: 0.4596 - val_loss: 3.2083 - val_accuracy20: 0.4147 - 118s/epoch - 22ms/step
Epoch 28/50
5429/5429 - 117s - loss: 3.1013 - accuracy20: 0.4601 - val_loss: 3.2029 - val_accuracy20: 0.4164 - 117s/epoch - 22ms/step
Epoch 29/50
5429/5429 - 117s - loss: 3.0996 - accuracy20: 0.4606 - val_loss: 3.2049 - val_accuracy20: 0.4161 - 117s/epoch - 22ms/step
Epoch 30/50
5429/5429 - 116s - loss: 3.0988 - accuracy20: 0.4611 - val_loss: 3.1990 - val_accuracy20: 0.4190 - 116s/epoch - 21ms/step
Epoch 31/50
5429/5429 - 118s - loss: 3.0975 - accuracy20: 0.4614 - val_loss: 3.2057 - val_accuracy20: 0.4177 - 118s/epoch - 22ms/step
Epoch 32/50
5429/5429 - 117s - loss: 3.0957 - accuracy20: 0.4621 - val_loss: 3.2024 - val_accuracy20: 0.4176 - 117s/epoch - 22ms/step
Epoch 33/50
5429/5429 - 117s - loss: 3.0947 - accuracy20: 0.4625 - val_loss: 3.2022 - val_accuracy20: 0.4181 - 117s/epoch - 22ms/step
Epoch 34/50
5429/5429 - 118s - loss: 3.0935 - accuracy20: 0.4627 - val_loss: 3.2049 - val_accuracy20: 0.4183 - 118s/epoch - 22ms/step
Epoch 35/50
5429/5429 - 118s - loss: 3.0920 - accuracy20: 0.4634 - val_loss: 3.2033 - val_accuracy20: 0.4180 - 118s/epoch - 22ms/step
Epoch 36/50
5429/5429 - 117s - loss: 3.0907 - accuracy20: 0.4637 - val_loss: 3.2071 - val_accuracy20: 0.4175 - 117s/epoch - 22ms/step
Epoch 37/50
5429/5429 - 118s - loss: 3.0894 - accuracy20: 0.4643 - val_loss: 3.2074 - val_accuracy20: 0.4177 - 118s/epoch - 22ms/step
Epoch 38/50
5429/5429 - 118s - loss: 3.0882 - accuracy20: 0.4644 - val_loss: 3.2094 - val_accuracy20: 0.4157 - 118s/epoch - 22ms/step
Epoch 39/50
5429/5429 - 118s - loss: 3.0869 - accuracy20: 0.4656 - val_loss: 3.2093 - val_accuracy20: 0.4179 - 118s/epoch - 22ms/step
Epoch 40/50
5429/5429 - 117s - loss: 3.0863 - accuracy20: 0.4652 - val_loss: 3.2076 - val_accuracy20: 0.4168 - 117s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h20
Evaluating performance on  test set...
22048/22048 - 165s - 165s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0520941
{'0': {'precision': 0.44778734260202807, 'recall': 0.6055423158945636, 'f1-score': 0.5148515135413931, 'support': 2075414}, '1': {'precision': 0.3811930046188465, 'recall': 0.02677982083922678, 'f1-score': 0.050043923182370616, 'support': 1442280}, '2': {'precision': 0.45900256527489813, 'recall': 0.5906331403439384, 'f1-score': 0.5165642233833924, 'support': 2126369}, 'accuracy': 0.45202879556801545, 'macro avg': {'precision': 0.4293276374985909, 'recall': 0.40765175902590967, 'f1-score': 0.36048655336905205, 'support': 5644063}, 'weighted avg': {'precision': 0.4349951430878315, 'recall': 0.45202879556801545, 'f1-score': 0.3967201535071432, 'support': 5644063}}
[[1256751   31091  787572]
 [ 710973   38624  692683]
 [ 838856   31609 1255904]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0538397
{'0': {'precision': 0.41873661194907824, 'recall': 0.6566829701315882, 'f1-score': 0.511385893690995, 'support': 459616}, '1': {'precision': 0.4600835107706772, 'recall': 0.10889384845966059, 'f1-score': 0.17610635392741092, 'support': 458373}, '2': {'precision': 0.4538530705745084, 'recall': 0.5391855974701466, 'f1-score': 0.49285299132052074, 'support': 471806}, 'accuracy': 0.4361269108033919, 'macro avg': {'precision': 0.44422439776475464, 'recall': 0.43492080535379846, 'f1-score': 0.3934484129796422, 'support': 1389795}, 'weighted avg': {'precision': 0.4442946675844651, 'recall': 0.4361269108033919, 'f1-score': 0.39451468389684746, 'support': 1389795}}
[[301822  26843 130951]
 [233287  49914 175172]
 [185683  31732 254391]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0654243
{'0': {'precision': 0.40190260401542693, 'recall': 0.6413439323334769, 'f1-score': 0.49414551113949445, 'support': 153222}, '1': {'precision': 0.4635278675773559, 'recall': 0.11057444205423772, 'f1-score': 0.17855470871332, 'support': 172463}, '2': {'precision': 0.43277160272499104, 'recall': 0.5424478738084085, 'f1-score': 0.48144246785823636, 'support': 157982}, 'accuracy': 0.4197826190333432, 'macro avg': {'precision': 0.4327340247725913, 'recall': 0.43145541606537435, 'f1-score': 0.3847142292370169, 'support': 483667}, 'weighted avg': {'precision': 0.4339594199317812, 'recall': 0.4197826190333432, 'f1-score': 0.37746484294736005, 'support': 483667}}
[[98268 10407 44547]
 [85618 19070 67775]
 [60621 11664 85697]]
training model: results/AAPL/W10/deepOF_L2/h30
Epoch 1/50
5429/5429 - 120s - loss: 3.2317 - accuracy30: 0.4078 - val_loss: 3.3224 - val_accuracy30: 0.3752 - 120s/epoch - 22ms/step
Epoch 2/50
5429/5429 - 117s - loss: 3.2042 - accuracy30: 0.4199 - val_loss: 3.3088 - val_accuracy30: 0.3784 - 117s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 121s - loss: 3.1947 - accuracy30: 0.4233 - val_loss: 3.3062 - val_accuracy30: 0.3787 - 121s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 118s - loss: 3.1874 - accuracy30: 0.4266 - val_loss: 3.3089 - val_accuracy30: 0.3796 - 118s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 119s - loss: 3.1814 - accuracy30: 0.4293 - val_loss: 3.3076 - val_accuracy30: 0.3806 - 119s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 118s - loss: 3.1765 - accuracy30: 0.4315 - val_loss: 3.3109 - val_accuracy30: 0.3813 - 118s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 121s - loss: 3.1724 - accuracy30: 0.4333 - val_loss: 3.3104 - val_accuracy30: 0.3821 - 121s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 121s - loss: 3.1685 - accuracy30: 0.4354 - val_loss: 3.3144 - val_accuracy30: 0.3822 - 121s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 120s - loss: 3.1652 - accuracy30: 0.4367 - val_loss: 3.3095 - val_accuracy30: 0.3828 - 120s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 122s - loss: 3.1628 - accuracy30: 0.4377 - val_loss: 3.3144 - val_accuracy30: 0.3817 - 122s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 122s - loss: 3.1599 - accuracy30: 0.4390 - val_loss: 3.3123 - val_accuracy30: 0.3824 - 122s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 121s - loss: 3.1575 - accuracy30: 0.4398 - val_loss: 3.3110 - val_accuracy30: 0.3833 - 121s/epoch - 22ms/step
Epoch 13/50
5429/5429 - 118s - loss: 3.1551 - accuracy30: 0.4409 - val_loss: 3.3066 - val_accuracy30: 0.3859 - 118s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h30
Evaluating performance on  test set...
22048/22048 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0692898
{'0': {'precision': 0.42141723881424226, 'recall': 0.6187474233298152, 'f1-score': 0.501364524585176, 'support': 2039939}, '1': {'precision': 0.27138772817242135, 'recall': 0.0016338408964675804, 'f1-score': 0.0032481270296681134, 'support': 1510551}, '2': {'precision': 0.43881611669882165, 'recall': 0.5533105365802864, 'f1-score': 0.4894568252716761, 'support': 2093573}, 'accuracy': 0.4293132447316765, 'macro avg': {'precision': 0.37720702789516175, 'recall': 0.3912306002688564, 'f1-score': 0.33135649229550673, 'support': 5644063}, 'weighted avg': {'precision': 0.38771786190082713, 'recall': 0.4293132447316765, 'f1-score': 0.363633981850495, 'support': 5644063}}
[[1262207    3252  774480]
 [ 801138    2468  706945]
 [ 931803    3374 1158396]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0831949
{'0': {'precision': 0.3920487919612502, 'recall': 0.6807937183981478, 'f1-score': 0.4975648378873233, 'support': 457845}, '1': {'precision': 0.37360890302066774, 'recall': 0.0015387738264394082, 'f1-score': 0.003064924224639382, 'support': 458157}, '2': {'precision': 0.4282198634076568, 'recall': 0.5358331592066577, 'f1-score': 0.4760202952790601, 'support': 473793}, 'accuracy': 0.4074536172600995, 'macro avg': {'precision': 0.3979591861298582, 'recall': 0.4060552171437483, 'f1-score': 0.32555001913034093, 'support': 1389795}, 'weighted avg': {'precision': 0.398300963149416, 'recall': 0.4074536172600995, 'f1-score': 0.32720428081239417, 'support': 1389795}}
[[311698    590 145557]
 [264024    705 193428]
 [219327    592 253874]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1002275
{'0': {'precision': 0.3622904916631349, 'recall': 0.6854708821372518, 'f1-score': 0.47403843875157003, 'support': 145907}, '1': {'precision': 0.44727272727272727, 'recall': 0.0019870545282226365, 'f1-score': 0.003956531762157758, 'support': 185702}, '2': {'precision': 0.40026308280821554, 'recall': 0.5443054623893514, 'f1-score': 0.4613013708173906, 'support': 152058}, 'accuracy': 0.37866962186793807, 'macro avg': {'precision': 0.4032754339146926, 'recall': 0.410587799684942, 'f1-score': 0.31309878044370615, 'support': 483667}, 'weighted avg': {'precision': 0.40685711990428264, 'recall': 0.37866962186793807, 'f1-score': 0.2895480282673251, 'support': 483667}}
[[100015    251  45641]
 [106961    369  78372]
 [ 69087    205  82766]]
training model: results/AAPL/W10/deepOF_L2/h50
Epoch 1/50
5429/5429 - 124s - loss: 3.2391 - accuracy50: 0.4044 - val_loss: 3.2918 - val_accuracy50: 0.3796 - 124s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 122s - loss: 3.2174 - accuracy50: 0.4159 - val_loss: 3.2859 - val_accuracy50: 0.3809 - 122s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 118s - loss: 3.2089 - accuracy50: 0.4203 - val_loss: 3.2879 - val_accuracy50: 0.3772 - 118s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 118s - loss: 3.2022 - accuracy50: 0.4228 - val_loss: 3.2919 - val_accuracy50: 0.3782 - 118s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 118s - loss: 3.1962 - accuracy50: 0.4256 - val_loss: 3.3010 - val_accuracy50: 0.3780 - 118s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 118s - loss: 3.1911 - accuracy50: 0.4278 - val_loss: 3.2989 - val_accuracy50: 0.3806 - 118s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 117s - loss: 3.1866 - accuracy50: 0.4301 - val_loss: 3.3005 - val_accuracy50: 0.3804 - 117s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 117s - loss: 3.1828 - accuracy50: 0.4317 - val_loss: 3.3146 - val_accuracy50: 0.3786 - 117s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 118s - loss: 3.1798 - accuracy50: 0.4329 - val_loss: 3.3093 - val_accuracy50: 0.3802 - 118s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 118s - loss: 3.1766 - accuracy50: 0.4342 - val_loss: 3.3034 - val_accuracy50: 0.3832 - 118s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 117s - loss: 3.1738 - accuracy50: 0.4356 - val_loss: 3.3006 - val_accuracy50: 0.3831 - 117s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 117s - loss: 3.1715 - accuracy50: 0.4366 - val_loss: 3.3001 - val_accuracy50: 0.3857 - 117s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h50
Evaluating performance on  test set...
22048/22048 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0676665
{'0': {'precision': 0.419081398073774, 'recall': 0.683116903812678, 'f1-score': 0.519473830811867, 'support': 2133566}, '1': {'precision': 0.24616753353408158, 'recall': 0.0027290750051781865, 'f1-score': 0.00539830306886851, 'support': 1318029}, '2': {'precision': 0.45251261115805147, 'recall': 0.4440913162700664, 'f1-score': 0.4482624154779756, 'support': 2192468}, 'accuracy': 0.4313786008412734, 'macro avg': {'precision': 0.372587180921969, 'recall': 0.3766457650293075, 'f1-score': 0.3243781831195704, 'support': 5644063}, 'weighted avg': {'precision': 0.3916882553896957, 'recall': 0.4313786008412734, 'f1-score': 0.37176194256578565, 'support': 5644063}}
[[1457475    5422  670669]
 [ 807091    3597  507341]
 [1213219    5593  973656]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0905056
{'0': {'precision': 0.37286013086816827, 'recall': 0.7279406945190934, 'f1-score': 0.49313201146477864, 'support': 457698}, '1': {'precision': 0.3663704716336295, 'recall': 0.002334784587808156, 'f1-score': 0.004639999653731369, 'support': 459143}, '2': {'precision': 0.41949896411499743, 'recall': 0.4375436088921967, 'f1-score': 0.4283313255755227, 'support': 472954}, 'accuracy': 0.3894005950517882, 'macro avg': {'precision': 0.3862431888722651, 'recall': 0.3892730293330327, 'f1-score': 0.3087011122313443, 'support': 1389795}, 'weighted avg': {'precision': 0.3865875806931403, 'recall': 0.3894005950517882, 'f1-score': 0.3096981731123405, 'support': 1389795}}
[[333177    883 123638]
 [295349   1072 162722]
 [265045    971 206938]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.094848
{'0': {'precision': 0.3619932228389057, 'recall': 0.7373655618075745, 'f1-score': 0.4855945845104206, 'support': 154439}, '1': {'precision': 0.41824440619621345, 'recall': 0.002894390480671308, 'f1-score': 0.00574899599581246, 'support': 167911}, '2': {'precision': 0.41727261358154827, 'recall': 0.43434975854993585, 'f1-score': 0.4256399664678225, 'support': 161317}, 'accuracy': 0.3813202058441035, 'macro avg': {'precision': 0.3991700808722225, 'recall': 0.39153657027939387, 'f1-score': 0.30566118232468514, 'support': 483667}, 'weighted avg': {'precision': 0.3999588023081268, 'recall': 0.3813202058441035, 'f1-score': 0.29901362750517907, 'support': 483667}}
[[113878    339  40222]
 [109796    486  57629]
 [ 90912    337  70068]]
training model: results/AAPL/W10/deepOF_L2/h100
Epoch 1/50
5429/5429 - 124s - loss: 3.2617 - accuracy100: 0.3914 - val_loss: 3.2933 - val_accuracy100: 0.3592 - 124s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 117s - loss: 3.2461 - accuracy100: 0.3996 - val_loss: 3.2910 - val_accuracy100: 0.3554 - 117s/epoch - 21ms/step
Epoch 3/50
5429/5429 - 117s - loss: 3.2402 - accuracy100: 0.4033 - val_loss: 3.3024 - val_accuracy100: 0.3497 - 117s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 117s - loss: 3.2343 - accuracy100: 0.4069 - val_loss: 3.3046 - val_accuracy100: 0.3535 - 117s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 117s - loss: 3.2297 - accuracy100: 0.4094 - val_loss: 3.3099 - val_accuracy100: 0.3513 - 117s/epoch - 21ms/step
Epoch 6/50
5429/5429 - 119s - loss: 3.2260 - accuracy100: 0.4118 - val_loss: 3.3099 - val_accuracy100: 0.3528 - 119s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 121s - loss: 3.2226 - accuracy100: 0.4141 - val_loss: 3.3126 - val_accuracy100: 0.3555 - 121s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 117s - loss: 3.2198 - accuracy100: 0.4155 - val_loss: 3.3215 - val_accuracy100: 0.3526 - 117s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 117s - loss: 3.2171 - accuracy100: 0.4170 - val_loss: 3.3168 - val_accuracy100: 0.3568 - 117s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 117s - loss: 3.2145 - accuracy100: 0.4183 - val_loss: 3.3173 - val_accuracy100: 0.3605 - 117s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 117s - loss: 3.2122 - accuracy100: 0.4193 - val_loss: 3.3271 - val_accuracy100: 0.3556 - 117s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 117s - loss: 3.2100 - accuracy100: 0.4208 - val_loss: 3.3229 - val_accuracy100: 0.3593 - 117s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h100
Evaluating performance on  test set...
22048/22048 - 166s - 166s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.085157
{'0': {'precision': 0.3986890518415694, 'recall': 0.6949232367671908, 'f1-score': 0.5066846619323301, 'support': 2102048}, '1': {'precision': 0.25220633262490544, 'recall': 0.01000975026734604, 'f1-score': 0.019255282723873775, 'support': 1398936}, '2': {'precision': 0.42818716136313095, 'recall': 0.38454065389096714, 'f1-score': 0.40519191770695384, 'support': 2143079}, 'accuracy': 0.4073069347383259, 'macro avg': {'precision': 0.35969418194320196, 'recall': 0.3631578803085014, 'f1-score': 0.3103772874543859, 'support': 5644063}, 'weighted avg': {'precision': 0.37358246280549295, 'recall': 0.4073069347383259, 'f1-score': 0.3473332381735705, 'support': 5644063}}
[[1460762   20379  620907]
 [ 905313   14003  479620]
 [1297838   21140  824101]]
Evaluating performance on  train set...
5429/5429 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.092006
{'0': {'precision': 0.3595855528521448, 'recall': 0.7491642217250115, 'f1-score': 0.48593224011932135, 'support': 459452}, '1': {'precision': 0.375253075844884, 'recall': 0.010521558387116495, 'f1-score': 0.02046919002493342, 'support': 458012}, '2': {'precision': 0.4060434664519234, 'recall': 0.3608211190880971, 'f1-score': 0.38209890175179395, 'support': 472331}, 'accuracy': 0.37376087840292993, 'macro avg': {'precision': 0.3802940317163174, 'recall': 0.37350229973340837, 'f1-score': 0.2961667772986829, 'support': 1389795}, 'weighted avg': {'precision': 0.38053787051730226, 'recall': 0.37376087840292993, 'f1-score': 0.2972487529544493, 'support': 1389795}}
[[344205   3930 111317]
 [315211   4819 137982]
 [297811   4093 170427]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0967262
{'0': {'precision': 0.33873601362661887, 'recall': 0.7662408407570533, 'f1-score': 0.4697896916958054, 'support': 150531}, '1': {'precision': 0.428657677601127, 'recall': 0.012154204327581485, 'f1-score': 0.02363816954005449, 'support': 175248}, '2': {'precision': 0.39534547138680637, 'recall': 0.34601743007701663, 'f1-score': 0.36904038152366286, 'support': 157888}, 'accuracy': 0.3558336624164973, 'macro avg': {'precision': 0.38757972087151743, 'recall': 0.3748041583872172, 'f1-score': 0.28748941425317426, 'support': 483667}, 'weighted avg': {'precision': 0.3897970656211628, 'recall': 0.3558336624164973, 'f1-score': 0.2752461957797924, 'support': 483667}}
[[115343   1359  33829]
 [123391   2130  49727]
 [101776   1480  54632]]
training model: results/AAPL/W10/deepOF_L2/h200
Epoch 1/50
5429/5429 - 120s - loss: 3.2744 - accuracy200: 0.3796 - val_loss: 3.3042 - val_accuracy200: 0.3453 - 120s/epoch - 22ms/step
Epoch 2/50
5429/5429 - 116s - loss: 3.2640 - accuracy200: 0.3858 - val_loss: 3.3029 - val_accuracy200: 0.3423 - 116s/epoch - 21ms/step
Epoch 3/50
5429/5429 - 117s - loss: 3.2607 - accuracy200: 0.3879 - val_loss: 3.3034 - val_accuracy200: 0.3438 - 117s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 117s - loss: 3.2569 - accuracy200: 0.3910 - val_loss: 3.3088 - val_accuracy200: 0.3460 - 117s/epoch - 21ms/step
Epoch 5/50
5429/5429 - 120s - loss: 3.2536 - accuracy200: 0.3940 - val_loss: 3.3170 - val_accuracy200: 0.3481 - 120s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 119s - loss: 3.2502 - accuracy200: 0.3966 - val_loss: 3.3192 - val_accuracy200: 0.3473 - 119s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 120s - loss: 3.2472 - accuracy200: 0.3990 - val_loss: 3.3235 - val_accuracy200: 0.3470 - 120s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 119s - loss: 3.2447 - accuracy200: 0.4005 - val_loss: 3.3216 - val_accuracy200: 0.3479 - 119s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 118s - loss: 3.2425 - accuracy200: 0.4022 - val_loss: 3.3222 - val_accuracy200: 0.3499 - 118s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 119s - loss: 3.2403 - accuracy200: 0.4029 - val_loss: 3.3194 - val_accuracy200: 0.3504 - 119s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 119s - loss: 3.2382 - accuracy200: 0.4050 - val_loss: 3.3235 - val_accuracy200: 0.3491 - 119s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 119s - loss: 3.2365 - accuracy200: 0.4059 - val_loss: 3.3277 - val_accuracy200: 0.3482 - 119s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h200
Evaluating performance on  test set...
22048/22048 - 167s - 167s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0907156
{'0': {'precision': 0.38714005927609424, 'recall': 0.7625014124353885, 'f1-score': 0.5135424378330444, 'support': 2115141}, '1': {'precision': 0.24714249764910004, 'recall': 0.01320312289942277, 'f1-score': 0.025067084003613634, 'support': 1413302}, '2': {'precision': 0.41149168954628834, 'recall': 0.27281411595655175, 'f1-score': 0.32810109341260757, 'support': 2115620}, 'accuracy': 0.3913189842140316, 'macro avg': {'precision': 0.34859141549049416, 'recall': 0.34950621709712104, 'f1-score': 0.28890353841642186, 'support': 5644063}, 'weighted avg': {'precision': 0.36121192243383604, 'recall': 0.3913189842140316, 'f1-score': 0.3217149171975365, 'support': 5644063}}
[[1612798   28289  474054]
 [1043236   18660  351406]
 [1509895   28554  577171]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964938
{'0': {'precision': 0.34907704356674496, 'recall': 0.7924667875049207, 'f1-score': 0.48466288508143457, 'support': 462326}, '1': {'precision': 0.37195084295683317, 'recall': 0.013180584733893557, 'f1-score': 0.025458995293277227, 'support': 456960}, '2': {'precision': 0.3908653252684854, 'recall': 0.2691893247525552, 'f1-score': 0.3188123073592692, 'support': 470509}, 'accuracy': 0.35908677179008414, 'macro avg': {'precision': 0.37063107059735456, 'recall': 0.3582788989971231, 'f1-score': 0.27631139591132703, 'support': 1389795}, 'weighted avg': {'precision': 0.37074511260174575, 'recall': 0.35908677179008414, 'f1-score': 0.2775301792139687, 'support': 1389795}}
[[366378   5040  90908]
 [344461   6023 106476]
 [338723   5130 126656]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003926
{'0': {'precision': 0.3292089715684021, 'recall': 0.7989566244504233, 'f1-score': 0.4662856048638038, 'support': 152390}, '1': {'precision': 0.43363808322824715, 'recall': 0.01598470674367526, 'f1-score': 0.030832856998755927, 'support': 172102}, '2': {'precision': 0.3840242631735636, 'recall': 0.25932464268886446, 'f1-score': 0.3095892568522817, 'support': 159175}, 'accuracy': 0.34276061835932575, 'macro avg': {'precision': 0.3822904393234043, 'recall': 0.35808865796098766, 'f1-score': 0.2689025729049472, 'support': 483667}, 'weighted avg': {'precision': 0.3844074511341658, 'recall': 0.34276061835932575, 'f1-score': 0.25977072994406664, 'support': 483667}}
[[121753   1870  28767]
 [131908   2751  37443]
 [116174   1723  41278]]
training model: results/AAPL/W10/deepOF_L2/h300
Epoch 1/50
5429/5429 - 121s - loss: 3.2778 - accuracy300: 0.3744 - val_loss: 3.3191 - val_accuracy300: 0.3277 - 121s/epoch - 22ms/step
Epoch 2/50
5429/5429 - 117s - loss: 3.2689 - accuracy300: 0.3787 - val_loss: 3.3215 - val_accuracy300: 0.3278 - 117s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 117s - loss: 3.2658 - accuracy300: 0.3811 - val_loss: 3.3269 - val_accuracy300: 0.3281 - 117s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 118s - loss: 3.2625 - accuracy300: 0.3839 - val_loss: 3.3320 - val_accuracy300: 0.3293 - 118s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 118s - loss: 3.2595 - accuracy300: 0.3867 - val_loss: 3.3328 - val_accuracy300: 0.3297 - 118s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 118s - loss: 3.2570 - accuracy300: 0.3889 - val_loss: 3.3325 - val_accuracy300: 0.3339 - 118s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 119s - loss: 3.2547 - accuracy300: 0.3905 - val_loss: 3.3348 - val_accuracy300: 0.3323 - 119s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 117s - loss: 3.2527 - accuracy300: 0.3925 - val_loss: 3.3384 - val_accuracy300: 0.3353 - 117s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 118s - loss: 3.2507 - accuracy300: 0.3938 - val_loss: 3.3400 - val_accuracy300: 0.3347 - 118s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 118s - loss: 3.2490 - accuracy300: 0.3950 - val_loss: 3.3397 - val_accuracy300: 0.3372 - 118s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 116s - loss: 3.2473 - accuracy300: 0.3961 - val_loss: 3.3420 - val_accuracy300: 0.3384 - 116s/epoch - 21ms/step
testing model: results/AAPL/W10/deepOF_L2/h300
Evaluating performance on  test set...
22048/22048 - 164s - 164s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0904092
{'0': {'precision': 0.37829810776321177, 'recall': 0.8951908020152506, 'f1-score': 0.5318444218698584, 'support': 2115072}, '1': {'precision': 0.25492444684295734, 'recall': 0.007927705923157825, 'f1-score': 0.015377207498033257, 'support': 1430048}, '2': {'precision': 0.40091529562938766, 'recall': 0.1135662092777174, 'f1-score': 0.1769954019019827, 'support': 2098943}, 'accuracy': 0.3797085539264888, 'macro avg': {'precision': 0.34471261674518566, 'recall': 0.33889490573870856, 'f1-score': 0.2414056770899581, 'support': 5644063}, 'weighted avg': {'precision': 0.35544966172348946, 'recall': 0.3797085539264888, 'f1-score': 0.2690229803841002, 'support': 5644063}}
[[1893393   16350  205329]
 [1267847   11337  150864]
 [1843789   16785  238369]]
Evaluating performance on  train set...
5429/5429 - 45s - 45s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101038
{'0': {'precision': 0.33953859537810455, 'recall': 0.8951660361496427, 'f1-score': 0.49233381131543086, 'support': 463905}, '1': {'precision': 0.368011617052173, 'recall': 0.007764236804845864, 'f1-score': 0.015207626101567055, 'support': 456967}, '2': {'precision': 0.37517981490204066, 'recall': 0.1256986754755045, 'f1-score': 0.18830757041606697, 'support': 468923}, 'accuracy': 0.3437650876568127, 'macro avg': {'precision': 0.3609100091107727, 'recall': 0.34287631614333103, 'f1-score': 0.23194966927768826, 'support': 1389795}, 'weighted avg': {'precision': 0.36092607977555646, 'recall': 0.3437650876568127, 'f1-score': 0.2328740935585846, 'support': 1389795}}
[[415272   3042  45591]
 [400847   3548  52572]
 [406929   3051  58943]]
Evaluating performance on  val set...
1890/1890 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055592
{'0': {'precision': 0.3226506102856716, 'recall': 0.8986740884764698, 'f1-score': 0.47482498861889183, 'support': 153781}, '1': {'precision': 0.4139333152615885, 'recall': 0.009049103386154339, 'f1-score': 0.017711021544350045, 'support': 168746}, '2': {'precision': 0.36887753126572964, 'recall': 0.11824500434404865, 'f1-score': 0.17908399672923106, 'support': 161140}, 'accuracy': 0.3282837158623598, 'macro avg': {'precision': 0.36848715227099654, 'recall': 0.3419893987355576, 'f1-score': 0.22387333563082432, 'support': 483667}, 'weighted avg': {'precision': 0.36989922840638817, 'recall': 0.3282837158623598, 'f1-score': 0.21681305701913298, 'support': 483667}}
[[138199   1125  14457]
 [149076   1527  18143]
 [141049   1037  19054]]
training model: results/AAPL/W10/deepOF_L2/h500
Epoch 1/50
5429/5429 - 124s - loss: 3.2810 - accuracy500: 0.3718 - val_loss: 3.3590 - val_accuracy500: 0.3134 - 124s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 122s - loss: 3.2736 - accuracy500: 0.3738 - val_loss: 3.3584 - val_accuracy500: 0.3139 - 122s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 123s - loss: 3.2711 - accuracy500: 0.3760 - val_loss: 3.3604 - val_accuracy500: 0.3140 - 123s/epoch - 23ms/step
Epoch 4/50
5429/5429 - 121s - loss: 3.2678 - accuracy500: 0.3791 - val_loss: 3.3648 - val_accuracy500: 0.3148 - 121s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 123s - loss: 3.2647 - accuracy500: 0.3822 - val_loss: 3.3734 - val_accuracy500: 0.3160 - 123s/epoch - 23ms/step
Epoch 6/50
5429/5429 - 122s - loss: 3.2618 - accuracy500: 0.3847 - val_loss: 3.3739 - val_accuracy500: 0.3165 - 122s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 123s - loss: 3.2592 - accuracy500: 0.3872 - val_loss: 3.3801 - val_accuracy500: 0.3184 - 123s/epoch - 23ms/step
Epoch 8/50
5429/5429 - 123s - loss: 3.2571 - accuracy500: 0.3888 - val_loss: 3.3784 - val_accuracy500: 0.3217 - 123s/epoch - 23ms/step
Epoch 9/50
5429/5429 - 123s - loss: 3.2550 - accuracy500: 0.3905 - val_loss: 3.3785 - val_accuracy500: 0.3225 - 123s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 119s - loss: 3.2529 - accuracy500: 0.3921 - val_loss: 3.3792 - val_accuracy500: 0.3256 - 119s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 118s - loss: 3.2512 - accuracy500: 0.3933 - val_loss: 3.3781 - val_accuracy500: 0.3277 - 118s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 117s - loss: 3.2494 - accuracy500: 0.3947 - val_loss: 3.3797 - val_accuracy500: 0.3292 - 117s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h500
Evaluating performance on  test set...
22048/22048 - 167s - 167s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0873823
{'0': {'precision': 0.3786159025773668, 'recall': 0.9769833748789682, 'f1-score': 0.5457386241411557, 'support': 2135804}, '1': {'precision': 0.24312896405919662, 'recall': 0.004154515387999153, 'f1-score': 0.008169433920213952, 'support': 1411717}, '2': {'precision': 0.3954091724550347, 'recall': 0.02049994705567549, 'f1-score': 0.03897903037179225, 'support': 2096542}, 'accuracy': 0.3783602344623014, 'macro avg': {'precision': 0.339051346363866, 'recall': 0.3338792791075476, 'f1-score': 0.19762902947772065, 'support': 5644063}, 'weighted avg': {'precision': 0.3509653574349419, 'recall': 0.3783602344623014, 'f1-score': 0.22303876470451475, 'support': 5644063}}
[[2086645    8858   40301]
 [1380437    5865   25415]
 [2044163    9400   42979]]
Evaluating performance on  train set...
5429/5429 - 44s - 44s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.108378
{'0': {'precision': 0.33510435851557613, 'recall': 0.9875461700605287, 'f1-score': 0.5004058421674095, 'support': 465399}, '1': {'precision': 0.3611630321910696, 'recall': 0.0038101456356414037, 'f1-score': 0.00754073907048141, 'support': 456413}, '2': {'precision': 0.36394709466488334, 'recall': 0.010466192148005376, 'f1-score': 0.02034724919564391, 'support': 467983}, 'accuracy': 0.3354739368036293, 'macro avg': {'precision': 0.3534048284571763, 'recall': 0.3339408359480585, 'f1-score': 0.1760979434778449, 'support': 1389795}, 'weighted avg': {'precision': 0.3533742671133292, 'recall': 0.3354739368036293, 'f1-score': 0.17689820196544875, 'support': 1389795}}
[[459603   1521   4275]
 [450389   1739   4285]
 [461530   1555   4898]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177043
{'0': {'precision': 0.31330879212000906, 'recall': 0.9873304958923093, 'f1-score': 0.4756727371568361, 'support': 151545}, '1': {'precision': 0.38694516971279375, 'recall': 0.004281405641517501, 'f1-score': 0.00846910377223711, 'support': 173074}, '2': {'precision': 0.33858643744030564, 'recall': 0.008915547507670641, 'f1-score': 0.017373618564532334, 'support': 159048}, 'accuracy': 0.3138192185946116, 'macro avg': {'precision': 0.3462801330910361, 'recall': 0.3335091496804991, 'f1-score': 0.16717181983120186, 'support': 483667}, 'weighted avg': {'precision': 0.3479708661262905, 'recall': 0.3138192185946116, 'f1-score': 0.15778385935811337, 'support': 483667}}
[[149625    615   1305]
 [170868    741   1465]
 [157071    559   1418]]
training model: results/AAPL/W10/deepOF_L2/h1000
Epoch 1/50
5429/5429 - 122s - loss: 3.2776 - accuracy1000: 0.3758 - val_loss: 3.4114 - val_accuracy1000: 0.3121 - 122s/epoch - 22ms/step
Epoch 2/50
5429/5429 - 118s - loss: 3.2743 - accuracy1000: 0.3725 - val_loss: 3.4300 - val_accuracy1000: 0.3124 - 118s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 118s - loss: 3.2708 - accuracy1000: 0.3769 - val_loss: 3.4221 - val_accuracy1000: 0.3122 - 118s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 117s - loss: 3.2677 - accuracy1000: 0.3809 - val_loss: 3.4185 - val_accuracy1000: 0.3122 - 117s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 117s - loss: 3.2634 - accuracy1000: 0.3844 - val_loss: 3.4216 - val_accuracy1000: 0.3123 - 117s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 117s - loss: 3.2580 - accuracy1000: 0.3883 - val_loss: 3.4254 - val_accuracy1000: 0.3123 - 117s/epoch - 22ms/step
Epoch 7/50
5429/5429 - 116s - loss: 3.2537 - accuracy1000: 0.3919 - val_loss: 3.4255 - val_accuracy1000: 0.3131 - 116s/epoch - 21ms/step
Epoch 8/50
5429/5429 - 117s - loss: 3.2504 - accuracy1000: 0.3936 - val_loss: 3.4266 - val_accuracy1000: 0.3147 - 117s/epoch - 21ms/step
Epoch 9/50
5429/5429 - 118s - loss: 3.2472 - accuracy1000: 0.3958 - val_loss: 3.4237 - val_accuracy1000: 0.3176 - 118s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 117s - loss: 3.2442 - accuracy1000: 0.3981 - val_loss: 3.4290 - val_accuracy1000: 0.3228 - 117s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 117s - loss: 3.2417 - accuracy1000: 0.3994 - val_loss: 3.4318 - val_accuracy1000: 0.3263 - 117s/epoch - 22ms/step
testing model: results/AAPL/W10/deepOF_L2/h1000
Evaluating performance on  test set...
22048/22048 - 167s - 167s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0844077
{'0': {'precision': 0.38217897582562804, 'recall': 0.9938096743773743, 'f1-score': 0.5520585703422936, 'support': 2156914}, '1': {'precision': 0.20750013547932586, 'recall': 0.0028058682143275882, 'f1-score': 0.005536865561462605, 'support': 1364640}, '2': {'precision': 0.40162910993519235, 'recall': 0.0031825542318077334, 'f1-score': 0.006315067161276812, 'support': 2122509}, 'accuracy': 0.38166583186615743, 'macro avg': {'precision': 0.3304360737467154, 'recall': 0.3332660322745032, 'f1-score': 0.18797016768834432, 'support': 5644063}, 'weighted avg': {'precision': 0.34725898148973555, 'recall': 0.38166583186615743, 'f1-score': 0.21468620642549288, 'support': 5644063}}
[[2143562    6927    6425]
 [1357172    3829    3639]
 [2108057    7697    6755]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1234081
{'0': {'precision': 0.33300303775495443, 'recall': 0.9949755259489773, 'f1-score': 0.49899882677129076, 'support': 462735}, '1': {'precision': 0.35070717653221584, 'recall': 0.002926296235589794, 'f1-score': 0.005804162611916522, 'support': 457575}, '2': {'precision': 0.34290790642582175, 'recall': 0.0024665324770759447, 'f1-score': 0.004897834886288176, 'support': 469485}, 'accuracy': 0.33307574138631957, 'macro avg': {'precision': 0.34220604023766404, 'recall': 0.3334561182205477, 'f1-score': 0.1699002747564985, 'support': 1389795}, 'weighted avg': {'precision': 0.3421778862534363, 'recall': 0.33307574138631957, 'f1-score': 0.16970813812450752, 'support': 1389795}}
[[460410   1208   1117]
 [455134   1339   1102]
 [467056   1271   1158]]
Evaluating performance on  val set...
1890/1890 - 14s - 14s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1355351
{'0': {'precision': 0.31210030957179363, 'recall': 0.9945840368126593, 'f1-score': 0.475110896741494, 'support': 151035}, '1': {'precision': 0.38738738738738737, 'recall': 0.003028862239597091, 'f1-score': 0.006010728451363772, 'support': 170361}, '2': {'precision': 0.2682926829268293, 'recall': 0.001694695909928453, 'f1-score': 0.0033681167940427205, 'support': 162271}, 'accuracy': 0.31221480894913234, 'macro avg': {'precision': 0.32259345996200345, 'recall': 0.3331025316540616, 'f1-score': 0.16149658066230013, 'support': 483667}, 'weighted avg': {'precision': 0.3239209929767755, 'recall': 0.31221480894913234, 'f1-score': 0.15161033454699296, 'support': 483667}}
[[150217    456    362]
 [169457    516    388]
 [161636    360    275]]
training model: results/AAPL/W10/deepVOL_L2/h10
Epoch 1/50
5429/5429 - 136s - loss: 3.2217 - accuracy10: 0.4128 - val_loss: 3.3691 - val_accuracy10: 0.3903 - 136s/epoch - 25ms/step
Epoch 2/50
5429/5429 - 126s - loss: 3.1639 - accuracy10: 0.4389 - val_loss: 3.2969 - val_accuracy10: 0.4052 - 126s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 130s - loss: 3.1379 - accuracy10: 0.4486 - val_loss: 3.2810 - val_accuracy10: 0.4108 - 130s/epoch - 24ms/step
Epoch 4/50
5429/5429 - 132s - loss: 3.1256 - accuracy10: 0.4529 - val_loss: 3.2844 - val_accuracy10: 0.4104 - 132s/epoch - 24ms/step
Epoch 5/50
5429/5429 - 132s - loss: 3.1175 - accuracy10: 0.4559 - val_loss: 3.2718 - val_accuracy10: 0.4125 - 132s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 132s - loss: 3.1116 - accuracy10: 0.4582 - val_loss: 3.2663 - val_accuracy10: 0.4148 - 132s/epoch - 24ms/step
Epoch 7/50
5429/5429 - 137s - loss: 3.1066 - accuracy10: 0.4597 - val_loss: 3.2595 - val_accuracy10: 0.4167 - 137s/epoch - 25ms/step
Epoch 8/50
5429/5429 - 129s - loss: 3.1022 - accuracy10: 0.4616 - val_loss: 3.2571 - val_accuracy10: 0.4177 - 129s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 119s - loss: 3.0987 - accuracy10: 0.4623 - val_loss: 3.2577 - val_accuracy10: 0.4173 - 119s/epoch - 22ms/step
Epoch 10/50
5429/5429 - 130s - loss: 3.0956 - accuracy10: 0.4633 - val_loss: 3.2537 - val_accuracy10: 0.4182 - 130s/epoch - 24ms/step
Epoch 11/50
5429/5429 - 127s - loss: 3.0921 - accuracy10: 0.4643 - val_loss: 3.2570 - val_accuracy10: 0.4180 - 127s/epoch - 23ms/step
Epoch 12/50
5429/5429 - 122s - loss: 3.0893 - accuracy10: 0.4654 - val_loss: 3.2587 - val_accuracy10: 0.4187 - 122s/epoch - 22ms/step
Epoch 13/50
5429/5429 - 128s - loss: 3.0863 - accuracy10: 0.4664 - val_loss: 3.2556 - val_accuracy10: 0.4192 - 128s/epoch - 24ms/step
Epoch 14/50
5429/5429 - 132s - loss: 3.0841 - accuracy10: 0.4673 - val_loss: 3.2550 - val_accuracy10: 0.4198 - 132s/epoch - 24ms/step
Epoch 15/50
5429/5429 - 132s - loss: 3.0817 - accuracy10: 0.4678 - val_loss: 3.2549 - val_accuracy10: 0.4201 - 132s/epoch - 24ms/step
Epoch 16/50
5429/5429 - 128s - loss: 3.0794 - accuracy10: 0.4686 - val_loss: 3.2542 - val_accuracy10: 0.4200 - 128s/epoch - 24ms/step
Epoch 17/50
5429/5429 - 122s - loss: 3.0774 - accuracy10: 0.4692 - val_loss: 3.2480 - val_accuracy10: 0.4216 - 122s/epoch - 22ms/step
Epoch 18/50
5429/5429 - 132s - loss: 3.0750 - accuracy10: 0.4701 - val_loss: 3.2364 - val_accuracy10: 0.4242 - 132s/epoch - 24ms/step
Epoch 19/50
5429/5429 - 132s - loss: 3.0731 - accuracy10: 0.4709 - val_loss: 3.2361 - val_accuracy10: 0.4247 - 132s/epoch - 24ms/step
Epoch 20/50
5429/5429 - 120s - loss: 3.0714 - accuracy10: 0.4712 - val_loss: 3.2417 - val_accuracy10: 0.4229 - 120s/epoch - 22ms/step
Epoch 21/50
5429/5429 - 138s - loss: 3.0697 - accuracy10: 0.4718 - val_loss: 3.2371 - val_accuracy10: 0.4250 - 138s/epoch - 25ms/step
Epoch 22/50
5429/5429 - 137s - loss: 3.0679 - accuracy10: 0.4722 - val_loss: 3.2414 - val_accuracy10: 0.4242 - 137s/epoch - 25ms/step
Epoch 23/50
5429/5429 - 130s - loss: 3.0661 - accuracy10: 0.4728 - val_loss: 3.2351 - val_accuracy10: 0.4247 - 130s/epoch - 24ms/step
Epoch 24/50
5429/5429 - 134s - loss: 3.0645 - accuracy10: 0.4731 - val_loss: 3.2390 - val_accuracy10: 0.4246 - 134s/epoch - 25ms/step
Epoch 25/50
5429/5429 - 129s - loss: 3.0627 - accuracy10: 0.4739 - val_loss: 3.2342 - val_accuracy10: 0.4254 - 129s/epoch - 24ms/step
Epoch 26/50
5429/5429 - 133s - loss: 3.0611 - accuracy10: 0.4748 - val_loss: 3.2396 - val_accuracy10: 0.4249 - 133s/epoch - 24ms/step
Epoch 27/50
5429/5429 - 120s - loss: 3.0595 - accuracy10: 0.4748 - val_loss: 3.2324 - val_accuracy10: 0.4260 - 120s/epoch - 22ms/step
Epoch 28/50
5429/5429 - 122s - loss: 3.0583 - accuracy10: 0.4753 - val_loss: 3.2380 - val_accuracy10: 0.4245 - 122s/epoch - 22ms/step
Epoch 29/50
5429/5429 - 130s - loss: 3.0565 - accuracy10: 0.4757 - val_loss: 3.2373 - val_accuracy10: 0.4260 - 130s/epoch - 24ms/step
Epoch 30/50
5429/5429 - 129s - loss: 3.0550 - accuracy10: 0.4763 - val_loss: 3.2283 - val_accuracy10: 0.4277 - 129s/epoch - 24ms/step
Epoch 31/50
5429/5429 - 129s - loss: 3.0537 - accuracy10: 0.4767 - val_loss: 3.2321 - val_accuracy10: 0.4260 - 129s/epoch - 24ms/step
Epoch 32/50
5429/5429 - 127s - loss: 3.0523 - accuracy10: 0.4769 - val_loss: 3.2316 - val_accuracy10: 0.4273 - 127s/epoch - 23ms/step
Epoch 33/50
5429/5429 - 130s - loss: 3.0510 - accuracy10: 0.4777 - val_loss: 3.2242 - val_accuracy10: 0.4295 - 130s/epoch - 24ms/step
Epoch 34/50
5429/5429 - 117s - loss: 3.0496 - accuracy10: 0.4779 - val_loss: 3.2304 - val_accuracy10: 0.4267 - 117s/epoch - 22ms/step
Epoch 35/50
5429/5429 - 119s - loss: 3.0481 - accuracy10: 0.4787 - val_loss: 3.2307 - val_accuracy10: 0.4267 - 119s/epoch - 22ms/step
Epoch 36/50
5429/5429 - 132s - loss: 3.0469 - accuracy10: 0.4785 - val_loss: 3.2268 - val_accuracy10: 0.4281 - 132s/epoch - 24ms/step
Epoch 37/50
5429/5429 - 121s - loss: 3.0456 - accuracy10: 0.4791 - val_loss: 3.2200 - val_accuracy10: 0.4297 - 121s/epoch - 22ms/step
Epoch 38/50
5429/5429 - 135s - loss: 3.0442 - accuracy10: 0.4795 - val_loss: 3.2321 - val_accuracy10: 0.4271 - 135s/epoch - 25ms/step
Epoch 39/50
5429/5429 - 134s - loss: 3.0430 - accuracy10: 0.4802 - val_loss: 3.2251 - val_accuracy10: 0.4284 - 134s/epoch - 25ms/step
Epoch 40/50
5429/5429 - 124s - loss: 3.0414 - accuracy10: 0.4807 - val_loss: 3.2260 - val_accuracy10: 0.4292 - 124s/epoch - 23ms/step
Epoch 41/50
5429/5429 - 128s - loss: 3.0404 - accuracy10: 0.4812 - val_loss: 3.2168 - val_accuracy10: 0.4310 - 128s/epoch - 24ms/step
Epoch 42/50
5429/5429 - 130s - loss: 3.0392 - accuracy10: 0.4815 - val_loss: 3.2270 - val_accuracy10: 0.4282 - 130s/epoch - 24ms/step
Epoch 43/50
5429/5429 - 131s - loss: 3.0380 - accuracy10: 0.4819 - val_loss: 3.2116 - val_accuracy10: 0.4315 - 131s/epoch - 24ms/step
Epoch 44/50
5429/5429 - 124s - loss: 3.0373 - accuracy10: 0.4820 - val_loss: 3.2223 - val_accuracy10: 0.4295 - 124s/epoch - 23ms/step
Epoch 45/50
5429/5429 - 121s - loss: 3.0354 - accuracy10: 0.4825 - val_loss: 3.2234 - val_accuracy10: 0.4293 - 121s/epoch - 22ms/step
Epoch 46/50
5429/5429 - 132s - loss: 3.0346 - accuracy10: 0.4826 - val_loss: 3.2235 - val_accuracy10: 0.4291 - 132s/epoch - 24ms/step
Epoch 47/50
5429/5429 - 128s - loss: 3.0332 - accuracy10: 0.4829 - val_loss: 3.2156 - val_accuracy10: 0.4306 - 128s/epoch - 24ms/step
Epoch 48/50
5429/5429 - 132s - loss: 3.0324 - accuracy10: 0.4834 - val_loss: 3.2167 - val_accuracy10: 0.4308 - 132s/epoch - 24ms/step
Epoch 49/50
5429/5429 - 132s - loss: 3.0313 - accuracy10: 0.4836 - val_loss: 3.2197 - val_accuracy10: 0.4307 - 132s/epoch - 24ms/step
Epoch 50/50
5429/5429 - 128s - loss: 3.0301 - accuracy10: 0.4837 - val_loss: 3.2090 - val_accuracy10: 0.4326 - 128s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h10
Evaluating performance on  test set...
22048/22048 - 255s - 255s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0334768
{'0': {'precision': 0.49390000033608816, 'recall': 0.5476032772987903, 'f1-score': 0.5193670815056841, 'support': 2146890}, '1': {'precision': 0.45212970069071373, 'recall': 0.025007257873181647, 'f1-score': 0.04739320152992512, 'support': 1319257}, '2': {'precision': 0.46729631575054564, 'recall': 0.6846143638818856, 'f1-score': 0.5554558623486201, 'support': 2177921}, 'accuracy': 0.4783200698503278, 'macro avg': {'precision': 0.47110867225911585, 'recall': 0.4190749663512858, 'f1-score': 0.3740720484614098, 'support': 5644068}, 'weighted avg': {'precision': 0.4738707442152393, 'recall': 0.4783200698503278, 'f1-score': 0.4229727199719549, 'support': 5644068}}
[[1175644   22896  948350]
 [ 534880   32991  751386]
 [ 669804   17081 1491036]]
Evaluating performance on  train set...
5429/5429 - 58s - 58s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.051737
{'0': {'precision': 0.4667849092722417, 'recall': 0.5539893991783821, 'f1-score': 0.506662225513434, 'support': 461285}, '1': {'precision': 0.5515071809663294, 'recall': 0.08017458824245084, 'f1-score': 0.1399972685680468, 'support': 460283}, '2': {'precision': 0.4294854021234916, 'recall': 0.711260326165885, 'f1-score': 0.5355723359243644, 'support': 468228}, 'accuracy': 0.4500531013184669, 'macro avg': {'precision': 0.48259249745402083, 'recall': 0.4484747711955726, 'f1-score': 0.3940772766686151, 'support': 1389796}, 'weighted avg': {'precision': 0.48227750512726275, 'recall': 0.4500531013184669, 'f1-score': 0.39496732698141596, 'support': 1389796}}
[[255547  16541 189197]
 [170188  36903 253192]
 [121727  13469 333032]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.068123
{'0': {'precision': 0.445451470728124, 'recall': 0.5506264616349408, 'f1-score': 0.4924862988887201, 'support': 153082}, '1': {'precision': 0.5631181577953945, 'recall': 0.08544800485753892, 'f1-score': 0.1483806151275216, 'support': 174574}, '2': {'precision': 0.4107094207523017, 'recall': 0.7053989782771728, 'f1-score': 0.5191503012062402, 'support': 156011}, 'accuracy': 0.43264890927022104, 'macro avg': {'precision': 0.4730930164252734, 'recall': 0.44715781492321743, 'f1-score': 0.3866724050741606, 'support': 483667}, 'weighted avg': {'precision': 0.4767155476018898, 'recall': 0.43264890927022104, 'f1-score': 0.3768860450542248, 'support': 483667}}
[[ 84291   6241  62550]
 [ 64306  14917  95351]
 [ 40629   5332 110050]]
training model: results/AAPL/W10/deepVOL_L2/h20
Epoch 1/50
5429/5429 - 134s - loss: 3.2401 - accuracy20: 0.4025 - val_loss: 3.2910 - val_accuracy20: 0.3843 - 134s/epoch - 25ms/step
Epoch 2/50
5429/5429 - 119s - loss: 3.2104 - accuracy20: 0.4168 - val_loss: 3.2624 - val_accuracy20: 0.3918 - 119s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 119s - loss: 3.1925 - accuracy20: 0.4246 - val_loss: 3.2525 - val_accuracy20: 0.3971 - 119s/epoch - 22ms/step
Epoch 4/50
5429/5429 - 135s - loss: 3.1810 - accuracy20: 0.4301 - val_loss: 3.2390 - val_accuracy20: 0.4009 - 135s/epoch - 25ms/step
Epoch 5/50
5429/5429 - 132s - loss: 3.1750 - accuracy20: 0.4324 - val_loss: 3.2342 - val_accuracy20: 0.4030 - 132s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 136s - loss: 3.1699 - accuracy20: 0.4348 - val_loss: 3.2308 - val_accuracy20: 0.4038 - 136s/epoch - 25ms/step
Epoch 7/50
5429/5429 - 134s - loss: 3.1659 - accuracy20: 0.4364 - val_loss: 3.2297 - val_accuracy20: 0.4041 - 134s/epoch - 25ms/step
Epoch 8/50
5429/5429 - 135s - loss: 3.1623 - accuracy20: 0.4380 - val_loss: 3.2260 - val_accuracy20: 0.4054 - 135s/epoch - 25ms/step
Epoch 9/50
5429/5429 - 130s - loss: 3.1593 - accuracy20: 0.4389 - val_loss: 3.2325 - val_accuracy20: 0.4049 - 130s/epoch - 24ms/step
Epoch 10/50
5429/5429 - 124s - loss: 3.1564 - accuracy20: 0.4398 - val_loss: 3.2355 - val_accuracy20: 0.4040 - 124s/epoch - 23ms/step
Epoch 11/50
5429/5429 - 125s - loss: 3.1536 - accuracy20: 0.4409 - val_loss: 3.2320 - val_accuracy20: 0.4044 - 125s/epoch - 23ms/step
Epoch 12/50
5429/5429 - 131s - loss: 3.1511 - accuracy20: 0.4419 - val_loss: 3.2302 - val_accuracy20: 0.4057 - 131s/epoch - 24ms/step
Epoch 13/50
5429/5429 - 125s - loss: 3.1488 - accuracy20: 0.4426 - val_loss: 3.2336 - val_accuracy20: 0.4055 - 125s/epoch - 23ms/step
Epoch 14/50
5429/5429 - 130s - loss: 3.1463 - accuracy20: 0.4435 - val_loss: 3.2332 - val_accuracy20: 0.4063 - 130s/epoch - 24ms/step
Epoch 15/50
5429/5429 - 124s - loss: 3.1443 - accuracy20: 0.4442 - val_loss: 3.2317 - val_accuracy20: 0.4070 - 124s/epoch - 23ms/step
Epoch 16/50
5429/5429 - 122s - loss: 3.1423 - accuracy20: 0.4448 - val_loss: 3.2342 - val_accuracy20: 0.4065 - 122s/epoch - 22ms/step
Epoch 17/50
5429/5429 - 132s - loss: 3.1408 - accuracy20: 0.4455 - val_loss: 3.2343 - val_accuracy20: 0.4068 - 132s/epoch - 24ms/step
Epoch 18/50
5429/5429 - 132s - loss: 3.1389 - accuracy20: 0.4460 - val_loss: 3.2284 - val_accuracy20: 0.4075 - 132s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h20
Evaluating performance on  test set...
22048/22048 - 224s - 224s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.056714
{'0': {'precision': 0.45140985139168155, 'recall': 0.5602223553146187, 'f1-score': 0.4999640946233527, 'support': 2075417}, '1': {'precision': 0.32090775028674423, 'recall': 0.005431673855510819, 'f1-score': 0.010682535472658558, 'support': 1442281}, '2': {'precision': 0.4460280181171954, 'recall': 0.6385017659203243, 'f1-score': 0.5251855346149152, 'support': 2126370}, 'accuracy': 0.4479428667407976, 'macro avg': {'precision': 0.40611520659854045, 'recall': 0.40138526503015126, 'f1-score': 0.34527738823697546, 'support': 5644068}, 'weighted avg': {'precision': 0.41603386554183014, 'recall': 0.4479428667407976, 'f1-score': 0.3844354753617556, 'support': 5644068}}
[[1162695    8637  904085]
 [ 652264    7834  782183]
 [ 760738    7941 1357691]]
Evaluating performance on  train set...
5429/5429 - 55s - 55s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0686604
{'0': {'precision': 0.4190212852648489, 'recall': 0.5867549928463635, 'f1-score': 0.48890163068822046, 'support': 459207}, '1': {'precision': 0.43935975179805387, 'recall': 0.013568718996206595, 'f1-score': 0.02632446134347275, 'support': 459218}, '2': {'precision': 0.4157908890002143, 'recall': 0.6462064912775711, 'f1-score': 0.5060027010909018, 'support': 471371}, 'accuracy': 0.4175260254022893, 'macro avg': {'precision': 0.4247239753543724, 'recall': 0.41551006770671367, 'f1-score': 0.34040959770753165, 'support': 1389796}, 'weighted avg': {'precision': 0.4246459055737203, 'recall': 0.4175260254022893, 'f1-score': 0.3418564428366408, 'support': 1389796}}
[[269442   4191 185574]
 [210577   6231 242410]
 [163008   3760 304603]]
Evaluating performance on  val set...
1890/1890 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0739744
{'0': {'precision': 0.405063177663928, 'recall': 0.5899056098802825, 'f1-score': 0.4803146467532122, 'support': 153194}, '1': {'precision': 0.45427099982241165, 'recall': 0.014850076920844097, 'f1-score': 0.028759992354654103, 'support': 172255}, '2': {'precision': 0.4043775864436033, 'recall': 0.6515693536765729, 'f1-score': 0.4990403071017275, 'support': 158218}, 'accuracy': 0.4052747034633332, 'macro avg': {'precision': 0.4212372546433143, 'recall': 0.41877501349256646, 'f1-score': 0.3360383154031979, 'support': 483667}, 'weighted avg': {'precision': 0.4223639662937338, 'recall': 0.4052747034633332, 'f1-score': 0.3256218302815442, 'support': 483667}}
[[ 90370   1581  61243]
 [ 79095   2558  90602]
 [ 53636   1492 103090]]
training model: results/AAPL/W10/deepVOL_L2/h30
Epoch 1/50
5429/5429 - 124s - loss: 3.2489 - accuracy30: 0.3982 - val_loss: 3.3450 - val_accuracy30: 0.3642 - 124s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 127s - loss: 3.2242 - accuracy30: 0.4104 - val_loss: 3.3270 - val_accuracy30: 0.3679 - 127s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 139s - loss: 3.2120 - accuracy30: 0.4164 - val_loss: 3.3259 - val_accuracy30: 0.3721 - 139s/epoch - 26ms/step
Epoch 4/50
5429/5429 - 136s - loss: 3.2013 - accuracy30: 0.4215 - val_loss: 3.3173 - val_accuracy30: 0.3763 - 136s/epoch - 25ms/step
Epoch 5/50
5429/5429 - 133s - loss: 3.1936 - accuracy30: 0.4251 - val_loss: 3.3200 - val_accuracy30: 0.3791 - 133s/epoch - 25ms/step
Epoch 6/50
5429/5429 - 123s - loss: 3.1885 - accuracy30: 0.4276 - val_loss: 3.3230 - val_accuracy30: 0.3797 - 123s/epoch - 23ms/step
Epoch 7/50
5429/5429 - 120s - loss: 3.1843 - accuracy30: 0.4296 - val_loss: 3.3219 - val_accuracy30: 0.3812 - 120s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 128s - loss: 3.1809 - accuracy30: 0.4309 - val_loss: 3.3229 - val_accuracy30: 0.3818 - 128s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 130s - loss: 3.1782 - accuracy30: 0.4315 - val_loss: 3.3242 - val_accuracy30: 0.3823 - 130s/epoch - 24ms/step
Epoch 10/50
5429/5429 - 134s - loss: 3.1757 - accuracy30: 0.4331 - val_loss: 3.3226 - val_accuracy30: 0.3833 - 134s/epoch - 25ms/step
Epoch 11/50
5429/5429 - 121s - loss: 3.1736 - accuracy30: 0.4337 - val_loss: 3.3219 - val_accuracy30: 0.3832 - 121s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 130s - loss: 3.1716 - accuracy30: 0.4344 - val_loss: 3.3256 - val_accuracy30: 0.3821 - 130s/epoch - 24ms/step
Epoch 13/50
5429/5429 - 119s - loss: 3.1700 - accuracy30: 0.4350 - val_loss: 3.3241 - val_accuracy30: 0.3810 - 119s/epoch - 22ms/step
Epoch 14/50
5429/5429 - 132s - loss: 3.1682 - accuracy30: 0.4360 - val_loss: 3.3273 - val_accuracy30: 0.3830 - 132s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h30
Evaluating performance on  test set...
22048/22048 - 247s - 247s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706551
{'0': {'precision': 0.4335268559260275, 'recall': 0.5237504418019933, 'f1-score': 0.4743868529279542, 'support': 2039941}, '1': {'precision': 0.31728045325779036, 'recall': 0.00022243524221609055, 'f1-score': 0.00044455881837324553, 'support': 1510552}, '2': {'precision': 0.42300343712885696, 'recall': 0.6422158269944951, 'f1-score': 0.5100536787997193, 'support': 2093575}, 'accuracy': 0.4275786542614299, 'macro avg': {'precision': 0.3912702487708916, 'recall': 0.3887295680129015, 'f1-score': 0.32829503018201556, 'support': 5644068}, 'weighted avg': {'precision': 0.39851172100001364, 'recall': 0.4275786542614299, 'f1-score': 0.3607731783093396, 'support': 5644068}}
[[1068420     379  971142]
 [ 647360     336  862856]
 [ 748704     344 1344527]]
Evaluating performance on  train set...
5429/5429 - 49s - 49s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0865108
{'0': {'precision': 0.4124279957392093, 'recall': 0.5227398840394808, 'f1-score': 0.4610777750800643, 'support': 457742}, '1': {'precision': 0.41365461847389556, 'recall': 0.00022467792528477383, 'f1-score': 0.0004491119138926012, 'support': 458434}, '2': {'precision': 0.39869009714927484, 'recall': 0.6813246906802922, 'f1-score': 0.5030253477610556, 'support': 473620}, 'accuracy': 0.40442770018045815, 'macro avg': {'precision': 0.40825757045412653, 'recall': 0.401429750881686, 'f1-score': 0.32151741158500413, 'support': 1389796}, 'weighted avg': {'precision': 0.4081509522282108, 'recall': 0.40442770018045815, 'f1-score': 0.32343122033623883, 'support': 1389796}}
[[239280     82 218380]
 [190027    103 268304]
 [150867     64 322689]]
Evaluating performance on  val set...
1890/1890 - 19s - 19s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1031268
{'0': {'precision': 0.38365197731149103, 'recall': 0.5303531895352265, 'f1-score': 0.44522953965482026, 'support': 145899}, '1': {'precision': 0.5, 'recall': 0.00028007734443588655, 'f1-score': 0.0005598410912594809, 'support': 185663}, '2': {'precision': 0.3718811529933481, 'recall': 0.6891555175700996, 'f1-score': 0.483082169685239, 'support': 152105}, 'accuracy': 0.3768171076381064, 'macro avg': {'precision': 0.4185110434349464, 'recall': 0.40659626148325395, 'f1-score': 0.3096238501437729, 'support': 483667}, 'weighted avg': {'precision': 0.4246122282765259, 'recall': 0.3768171076381064, 'f1-score': 0.28644025704172166, 'support': 483667}}
[[ 77378     30  68491]
 [ 77051     52 108560]
 [ 47259     22 104824]]
training model: results/AAPL/W10/deepVOL_L2/h50
Epoch 1/50
5429/5429 - 135s - loss: 3.2462 - accuracy50: 0.3991 - val_loss: 3.2925 - val_accuracy50: 0.3735 - 135s/epoch - 25ms/step
Epoch 2/50
5429/5429 - 141s - loss: 3.2299 - accuracy50: 0.4061 - val_loss: 3.2943 - val_accuracy50: 0.3727 - 141s/epoch - 26ms/step
Epoch 3/50
5429/5429 - 130s - loss: 3.2238 - accuracy50: 0.4105 - val_loss: 3.2892 - val_accuracy50: 0.3790 - 130s/epoch - 24ms/step
Epoch 4/50
5429/5429 - 134s - loss: 3.2171 - accuracy50: 0.4148 - val_loss: 3.2931 - val_accuracy50: 0.3785 - 134s/epoch - 25ms/step
Epoch 5/50
5429/5429 - 132s - loss: 3.2103 - accuracy50: 0.4182 - val_loss: 3.2918 - val_accuracy50: 0.3809 - 132s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 130s - loss: 3.2047 - accuracy50: 0.4214 - val_loss: 3.3026 - val_accuracy50: 0.3813 - 130s/epoch - 24ms/step
Epoch 7/50
5429/5429 - 121s - loss: 3.2003 - accuracy50: 0.4235 - val_loss: 3.2979 - val_accuracy50: 0.3842 - 121s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 128s - loss: 3.1965 - accuracy50: 0.4254 - val_loss: 3.2923 - val_accuracy50: 0.3847 - 128s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 123s - loss: 3.1936 - accuracy50: 0.4263 - val_loss: 3.2980 - val_accuracy50: 0.3863 - 123s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 128s - loss: 3.1913 - accuracy50: 0.4278 - val_loss: 3.2855 - val_accuracy50: 0.3881 - 128s/epoch - 24ms/step
Epoch 11/50
5429/5429 - 134s - loss: 3.1890 - accuracy50: 0.4287 - val_loss: 3.2874 - val_accuracy50: 0.3876 - 134s/epoch - 25ms/step
Epoch 12/50
5429/5429 - 127s - loss: 3.1871 - accuracy50: 0.4298 - val_loss: 3.2851 - val_accuracy50: 0.3884 - 127s/epoch - 23ms/step
Epoch 13/50
5429/5429 - 134s - loss: 3.1853 - accuracy50: 0.4307 - val_loss: 3.2806 - val_accuracy50: 0.3892 - 134s/epoch - 25ms/step
Epoch 14/50
5429/5429 - 129s - loss: 3.1836 - accuracy50: 0.4311 - val_loss: 3.2813 - val_accuracy50: 0.3898 - 129s/epoch - 24ms/step
Epoch 15/50
5429/5429 - 128s - loss: 3.1821 - accuracy50: 0.4318 - val_loss: 3.2774 - val_accuracy50: 0.3905 - 128s/epoch - 24ms/step
Epoch 16/50
5429/5429 - 127s - loss: 3.1806 - accuracy50: 0.4325 - val_loss: 3.2799 - val_accuracy50: 0.3901 - 127s/epoch - 23ms/step
Epoch 17/50
5429/5429 - 130s - loss: 3.1790 - accuracy50: 0.4331 - val_loss: 3.2798 - val_accuracy50: 0.3906 - 130s/epoch - 24ms/step
Epoch 18/50
5429/5429 - 140s - loss: 3.1779 - accuracy50: 0.4334 - val_loss: 3.2794 - val_accuracy50: 0.3906 - 140s/epoch - 26ms/step
Epoch 19/50
5429/5429 - 121s - loss: 3.1765 - accuracy50: 0.4340 - val_loss: 3.2826 - val_accuracy50: 0.3904 - 121s/epoch - 22ms/step
Epoch 20/50
5429/5429 - 136s - loss: 3.1751 - accuracy50: 0.4348 - val_loss: 3.2799 - val_accuracy50: 0.3909 - 136s/epoch - 25ms/step
Epoch 21/50
5429/5429 - 126s - loss: 3.1738 - accuracy50: 0.4352 - val_loss: 3.2821 - val_accuracy50: 0.3904 - 126s/epoch - 23ms/step
Epoch 22/50
5429/5429 - 127s - loss: 3.1722 - accuracy50: 0.4353 - val_loss: 3.2784 - val_accuracy50: 0.3910 - 127s/epoch - 23ms/step
Epoch 23/50
5429/5429 - 127s - loss: 3.1711 - accuracy50: 0.4362 - val_loss: 3.2798 - val_accuracy50: 0.3906 - 127s/epoch - 23ms/step
Epoch 24/50
5429/5429 - 130s - loss: 3.1699 - accuracy50: 0.4364 - val_loss: 3.2819 - val_accuracy50: 0.3909 - 130s/epoch - 24ms/step
Epoch 25/50
5429/5429 - 130s - loss: 3.1686 - accuracy50: 0.4372 - val_loss: 3.2779 - val_accuracy50: 0.3919 - 130s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h50
Evaluating performance on  test set...
22048/22048 - 213s - 213s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0630565
{'0': {'precision': 0.43488042440524427, 'recall': 0.5875395523084113, 'f1-score': 0.49981310162586634, 'support': 2133567}, '1': {'precision': 0.25295043273013373, 'recall': 0.00048784929022859875, 'f1-score': 0.0009738204353870899, 'support': 1318030}, '2': {'precision': 0.44498220005958683, 'recall': 0.5599640770619086, 'f1-score': 0.49589525855862165, 'support': 2192471}, 'accuracy': 0.43973655172120535, 'macro avg': {'precision': 0.37760435239832163, 'recall': 0.38266382622018286, 'f1-score': 0.3322273935399584, 'support': 5644068}, 'weighted avg': {'precision': 0.39631934811117875, 'recall': 0.43973655172120535, 'f1-score': 0.381799836177085, 'support': 5644068}}
[[1253555     971  879041]
 [ 665135     643  652252]
 [ 963838     928 1227705]]
Evaluating performance on  train set...
5429/5429 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0868846
{'0': {'precision': 0.39377647770829133, 'recall': 0.5972645074430488, 'f1-score': 0.47462964201260766, 'support': 457541}, '1': {'precision': 0.4, 'recall': 0.00042641325536062376, 'f1-score': 0.0008519183375422155, 'support': 459648}, '2': {'precision': 0.40553639587761714, 'recall': 0.5966479548546678, 'f1-score': 0.4828701646412936, 'support': 472607}, 'accuracy': 0.3996622525895887, 'macro avg': {'precision': 0.3997709578619695, 'recall': 0.3981129585176924, 'f1-score': 0.31945057499714785, 'support': 1389796}, 'weighted avg': {'precision': 0.39983380498552473, 'recall': 0.3996622525895887, 'f1-score': 0.3207391037941777, 'support': 1389796}}
[[273273    133 184135]
 [230241    196 229211]
 [190466    161 281980]]
Evaluating performance on  val set...
1890/1890 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0914538
{'0': {'precision': 0.3828891011231269, 'recall': 0.5943804221157581, 'f1-score': 0.4657502974099336, 'support': 154460}, '1': {'precision': 0.4897959183673469, 'recall': 0.0007157171485828801, 'f1-score': 0.0014293456574692245, 'support': 167664}, '2': {'precision': 0.3975620267192021, 'recall': 0.599617439319562, 'f1-score': 0.4781187991747041, 'support': 161543}, 'accuracy': 0.39033467240890946, 'macro avg': {'precision': 0.423415682069892, 'recall': 0.3982378595279677, 'f1-score': 0.315099480747369, 'support': 483667}, 'weighted avg': {'precision': 0.42484923697279553, 'recall': 0.39033467240890946, 'f1-score': 0.30892367253364705, 'support': 483667}}
[[91808    64 62588]
 [83351   120 84193]
 [64618    61 96864]]
training model: results/AAPL/W10/deepVOL_L2/h100
Epoch 1/50
5429/5429 - 129s - loss: 3.2650 - accuracy100: 0.3874 - val_loss: 3.2927 - val_accuracy100: 0.3542 - 129s/epoch - 24ms/step
Epoch 2/50
5429/5429 - 138s - loss: 3.2516 - accuracy100: 0.3951 - val_loss: 3.2901 - val_accuracy100: 0.3543 - 138s/epoch - 25ms/step
Epoch 3/50
5429/5429 - 130s - loss: 3.2464 - accuracy100: 0.3982 - val_loss: 3.2918 - val_accuracy100: 0.3537 - 130s/epoch - 24ms/step
Epoch 4/50
5429/5429 - 131s - loss: 3.2425 - accuracy100: 0.4008 - val_loss: 3.2914 - val_accuracy100: 0.3574 - 131s/epoch - 24ms/step
Epoch 5/50
5429/5429 - 118s - loss: 3.2390 - accuracy100: 0.4028 - val_loss: 3.2918 - val_accuracy100: 0.3598 - 118s/epoch - 22ms/step
Epoch 6/50
5429/5429 - 125s - loss: 3.2363 - accuracy100: 0.4046 - val_loss: 3.2939 - val_accuracy100: 0.3594 - 125s/epoch - 23ms/step
Epoch 7/50
5429/5429 - 121s - loss: 3.2338 - accuracy100: 0.4060 - val_loss: 3.2951 - val_accuracy100: 0.3604 - 121s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 130s - loss: 3.2314 - accuracy100: 0.4074 - val_loss: 3.2964 - val_accuracy100: 0.3607 - 130s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 126s - loss: 3.2296 - accuracy100: 0.4091 - val_loss: 3.2959 - val_accuracy100: 0.3610 - 126s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 126s - loss: 3.2275 - accuracy100: 0.4098 - val_loss: 3.2957 - val_accuracy100: 0.3607 - 126s/epoch - 23ms/step
Epoch 11/50
5429/5429 - 131s - loss: 3.2261 - accuracy100: 0.4108 - val_loss: 3.2991 - val_accuracy100: 0.3613 - 131s/epoch - 24ms/step
Epoch 12/50
5429/5429 - 134s - loss: 3.2246 - accuracy100: 0.4116 - val_loss: 3.2966 - val_accuracy100: 0.3626 - 134s/epoch - 25ms/step
testing model: results/AAPL/W10/deepVOL_L2/h100
Evaluating performance on  test set...
22048/22048 - 228s - 228s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0891348
{'0': {'precision': 0.39553107448066327, 'recall': 0.6146162079874409, 'f1-score': 0.4813155731994543, 'support': 2102050}, '1': {'precision': 0.238837936335216, 'recall': 0.009884655195091126, 'f1-score': 0.018983644659339813, 'support': 1398936}, '2': {'precision': 0.4108176893369365, 'recall': 0.44469227029110414, 'f1-score': 0.4270843346497493, 'support': 2143082}, 'accuracy': 0.40020673032288057, 'macro avg': {'precision': 0.3483955667176053, 'recall': 0.35639771115787866, 'f1-score': 0.30912785083618116, 'support': 5644068}, 'weighted avg': {'precision': 0.36249759530124387, 'recall': 0.40020673032288057, 'f1-score': 0.34613031852892717, 'support': 5644068}}
[[1291954   22055  788041]
 [ 806368   13828  578740]
 [1168056   22014  953012]]
Evaluating performance on  train set...
5429/5429 - 43s - 43s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933679
{'0': {'precision': 0.35929432013769363, 'recall': 0.6326597706504913, 'f1-score': 0.4583096421200724, 'support': 459299}, '1': {'precision': 0.3311996206733049, 'recall': 0.006093172767835724, 'f1-score': 0.011966199982012154, 'support': 458546}, '2': {'precision': 0.3859691097574606, 'recall': 0.4682880214259531, 'f1-score': 0.42316231060189036, 'support': 471951}, 'accuracy': 0.37011403112399227, 'macro avg': {'precision': 0.35882101685615303, 'recall': 0.36901365494809335, 'f1-score': 0.29781271756799166, 'support': 1389796}, 'weighted avg': {'precision': 0.35908312480776106, 'recall': 0.37011403112399227, 'f1-score': 0.2991087102739767, 'support': 1389796}}
[[290580   2726 165993]
 [270146   2794 185606]
 [248026   2916 221009]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0961041
{'0': {'precision': 0.3384219160683731, 'recall': 0.6369117178370339, 'f1-score': 0.44199210695468066, 'support': 150608}, '1': {'precision': 0.3852080123266564, 'recall': 0.005711903034734083, 'f1-score': 0.01125688780822766, 'support': 175073}, '2': {'precision': 0.3758715958426523, 'recall': 0.4701809021052498, 'f1-score': 0.41776992902376753, 'support': 157986}, 'accuracy': 0.35397494557205683, 'macro avg': {'precision': 0.36650050807922724, 'recall': 0.37093484099233925, 'f1-score': 0.2903396412622253, 'support': 483667}, 'weighted avg': {'precision': 0.36758972644006627, 'recall': 0.35397494557205683, 'f1-score': 0.27816684696336386, 'support': 483667}}
[[ 95924    707  53977]
 [104706   1000  69367]
 [ 82815    889  74282]]
training model: results/AAPL/W10/deepVOL_L2/h200
Epoch 1/50
5429/5429 - 123s - loss: 3.2740 - accuracy200: 0.3789 - val_loss: 3.2971 - val_accuracy200: 0.3385 - 123s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 122s - loss: 3.2652 - accuracy200: 0.3842 - val_loss: 3.2933 - val_accuracy200: 0.3441 - 122s/epoch - 22ms/step
Epoch 3/50
5429/5429 - 126s - loss: 3.2611 - accuracy200: 0.3879 - val_loss: 3.2922 - val_accuracy200: 0.3462 - 126s/epoch - 23ms/step
Epoch 4/50
5429/5429 - 130s - loss: 3.2578 - accuracy200: 0.3903 - val_loss: 3.2934 - val_accuracy200: 0.3462 - 130s/epoch - 24ms/step
Epoch 5/50
5429/5429 - 131s - loss: 3.2554 - accuracy200: 0.3917 - val_loss: 3.2919 - val_accuracy200: 0.3471 - 131s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 134s - loss: 3.2530 - accuracy200: 0.3940 - val_loss: 3.2932 - val_accuracy200: 0.3475 - 134s/epoch - 25ms/step
Epoch 7/50
5429/5429 - 125s - loss: 3.2511 - accuracy200: 0.3952 - val_loss: 3.2922 - val_accuracy200: 0.3477 - 125s/epoch - 23ms/step
Epoch 8/50
5429/5429 - 121s - loss: 3.2493 - accuracy200: 0.3965 - val_loss: 3.2943 - val_accuracy200: 0.3466 - 121s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 125s - loss: 3.2480 - accuracy200: 0.3973 - val_loss: 3.2940 - val_accuracy200: 0.3468 - 125s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 122s - loss: 3.2467 - accuracy200: 0.3981 - val_loss: 3.2941 - val_accuracy200: 0.3474 - 122s/epoch - 23ms/step
Epoch 11/50
5429/5429 - 118s - loss: 3.2452 - accuracy200: 0.3992 - val_loss: 3.2981 - val_accuracy200: 0.3458 - 118s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 126s - loss: 3.2443 - accuracy200: 0.3997 - val_loss: 3.2967 - val_accuracy200: 0.3459 - 126s/epoch - 23ms/step
Epoch 13/50
5429/5429 - 132s - loss: 3.2432 - accuracy200: 0.4007 - val_loss: 3.2980 - val_accuracy200: 0.3465 - 132s/epoch - 24ms/step
Epoch 14/50
5429/5429 - 127s - loss: 3.2419 - accuracy200: 0.4013 - val_loss: 3.2994 - val_accuracy200: 0.3454 - 127s/epoch - 23ms/step
Epoch 15/50
5429/5429 - 131s - loss: 3.2409 - accuracy200: 0.4020 - val_loss: 3.3007 - val_accuracy200: 0.3459 - 131s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h200
Evaluating performance on  test set...
22048/22048 - 184s - 184s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0936828
{'0': {'precision': 0.3953198117885628, 'recall': 0.5227712736207434, 'f1-score': 0.4501989939355198, 'support': 2115143}, '1': {'precision': 0.2552960823131725, 'recall': 0.053651661145317844, 'f1-score': 0.08866909818898752, 'support': 1413302}, '2': {'precision': 0.3984923072217174, 'recall': 0.4803081645453845, 'f1-score': 0.43559172944514035, 'support': 2115623}, 'accuracy': 0.38938457155370915, 'macro avg': {'precision': 0.34970273377448424, 'recall': 0.3522436997704819, 'f1-score': 0.3248199405232159, 'support': 5644068}, 'weighted avg': {'precision': 0.36144636933371443, 'recall': 0.38938457155370915, 'f1-score': 0.35419476623286, 'support': 5644068}}
[[1105736  111617  897790]
 [ 701428   75826  636048]
 [ 989903  109569 1016151]]
Evaluating performance on  train set...
5429/5429 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946918
{'0': {'precision': 0.35605024115810124, 'recall': 0.5680362392674269, 'f1-score': 0.4377283820548383, 'support': 462261}, '1': {'precision': 0.32886714478975554, 'recall': 0.038839583720904784, 'f1-score': 0.06947418696879416, 'support': 456905}, '2': {'precision': 0.37628018290237186, 'recall': 0.4783970422624992, 'f1-score': 0.4212381499407848, 'support': 470630}, 'accuracy': 0.36370445734481893, 'macro avg': {'precision': 0.35373252295007623, 'recall': 0.3617576217502769, 'f1-score': 0.30948023965480576, 'support': 1389796}, 'weighted avg': {'precision': 0.3539641255245313, 'recall': 0.36370445734481893, 'f1-score': 0.31107815357121477, 'support': 1389796}}
[[262581  17505 182175]
 [248130  17746 191029]
 [226772  18710 225148]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096629
{'0': {'precision': 0.33262039916605973, 'recall': 0.5664371919646666, 'f1-score': 0.4191245738926064, 'support': 152377}, '1': {'precision': 0.35565948443850565, 'recall': 0.03712032727251596, 'f1-score': 0.06722441462772955, 'support': 172089}, '2': {'precision': 0.3643090948767064, 'recall': 0.47189402076620124, 'f1-score': 0.4111806817435471, 'support': 159201}, 'accuracy': 0.34698666644612924, 'macro avg': {'precision': 0.35086299282709055, 'recall': 0.3584838466677946, 'f1-score': 0.2991765567546277, 'support': 483667}, 'weighted avg': {'precision': 0.3512481847939413, 'recall': 0.34698666644612924, 'f1-score': 0.2913035274251902, 'support': 483667}}
[[86312  5539 60526]
 [95138  6388 70563]
 [78041  6034 75126]]
training model: results/AAPL/W10/deepVOL_L2/h300
Epoch 1/50
5429/5429 - 128s - loss: 3.2771 - accuracy300: 0.3741 - val_loss: 3.3210 - val_accuracy300: 0.3263 - 128s/epoch - 24ms/step
Epoch 2/50
5429/5429 - 125s - loss: 3.2707 - accuracy300: 0.3761 - val_loss: 3.3261 - val_accuracy300: 0.3262 - 125s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 134s - loss: 3.2692 - accuracy300: 0.3774 - val_loss: 3.3155 - val_accuracy300: 0.3312 - 134s/epoch - 25ms/step
Epoch 4/50
5429/5429 - 132s - loss: 3.2669 - accuracy300: 0.3800 - val_loss: 3.3163 - val_accuracy300: 0.3310 - 132s/epoch - 24ms/step
Epoch 5/50
5429/5429 - 127s - loss: 3.2632 - accuracy300: 0.3835 - val_loss: 3.3052 - val_accuracy300: 0.3383 - 127s/epoch - 23ms/step
Epoch 6/50
5429/5429 - 127s - loss: 3.2590 - accuracy300: 0.3874 - val_loss: 3.3058 - val_accuracy300: 0.3394 - 127s/epoch - 23ms/step
Epoch 7/50
5429/5429 - 121s - loss: 3.2560 - accuracy300: 0.3900 - val_loss: 3.3041 - val_accuracy300: 0.3429 - 121s/epoch - 22ms/step
Epoch 8/50
5429/5429 - 131s - loss: 3.2538 - accuracy300: 0.3918 - val_loss: 3.3026 - val_accuracy300: 0.3419 - 131s/epoch - 24ms/step
Epoch 9/50
5429/5429 - 126s - loss: 3.2520 - accuracy300: 0.3929 - val_loss: 3.3021 - val_accuracy300: 0.3436 - 126s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 130s - loss: 3.2505 - accuracy300: 0.3939 - val_loss: 3.3020 - val_accuracy300: 0.3463 - 130s/epoch - 24ms/step
Epoch 11/50
5429/5429 - 119s - loss: 3.2490 - accuracy300: 0.3946 - val_loss: 3.3024 - val_accuracy300: 0.3455 - 119s/epoch - 22ms/step
Epoch 12/50
5429/5429 - 123s - loss: 3.2474 - accuracy300: 0.3961 - val_loss: 3.3043 - val_accuracy300: 0.3452 - 123s/epoch - 23ms/step
Epoch 13/50
5429/5429 - 127s - loss: 3.2460 - accuracy300: 0.3967 - val_loss: 3.3045 - val_accuracy300: 0.3448 - 127s/epoch - 23ms/step
Epoch 14/50
5429/5429 - 127s - loss: 3.2447 - accuracy300: 0.3978 - val_loss: 3.3054 - val_accuracy300: 0.3452 - 127s/epoch - 23ms/step
Epoch 15/50
5429/5429 - 122s - loss: 3.2433 - accuracy300: 0.3987 - val_loss: 3.3073 - val_accuracy300: 0.3438 - 122s/epoch - 22ms/step
Epoch 16/50
5429/5429 - 132s - loss: 3.2419 - accuracy300: 0.3995 - val_loss: 3.3075 - val_accuracy300: 0.3446 - 132s/epoch - 24ms/step
Epoch 17/50
5429/5429 - 131s - loss: 3.2407 - accuracy300: 0.4003 - val_loss: 3.3092 - val_accuracy300: 0.3447 - 131s/epoch - 24ms/step
Epoch 18/50
5429/5429 - 122s - loss: 3.2392 - accuracy300: 0.4012 - val_loss: 3.3093 - val_accuracy300: 0.3439 - 122s/epoch - 22ms/step
Epoch 19/50
5429/5429 - 132s - loss: 3.2383 - accuracy300: 0.4019 - val_loss: 3.3092 - val_accuracy300: 0.3448 - 132s/epoch - 24ms/step
Epoch 20/50
5429/5429 - 132s - loss: 3.2370 - accuracy300: 0.4025 - val_loss: 3.3070 - val_accuracy300: 0.3448 - 132s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h300
Evaluating performance on  test set...
22048/22048 - 223s - 223s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0929412
{'0': {'precision': 0.38997063282550387, 'recall': 0.4347743861444091, 'f1-score': 0.4111555416553305, 'support': 2115074}, '1': {'precision': 0.24588387884336613, 'recall': 0.04507258142902796, 'f1-score': 0.07618061575864163, 'support': 1430049}, '2': {'precision': 0.38337114932504984, 'recall': 0.5523050866030316, 'f1-score': 0.4525878240758273, 'support': 2098945}, 'accuracy': 0.37974276709635674, 'macro avg': {'precision': 0.3397418869979733, 'recall': 0.34405068472548955, 'f1-score': 0.3133079938299332, 'support': 5644068}, 'weighted avg': {'precision': 0.3510088287966965, 'recall': 0.37974276709635674, 'f1-score': 0.3416903127143354, 'support': 5644068}}
[[ 919580  100231 1095263]
 [ 596261   64456  769332]
 [ 842234   97453 1159258]]
Evaluating performance on  train set...
5429/5429 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097245
{'0': {'precision': 0.3538196994703143, 'recall': 0.4412147542820692, 'f1-score': 0.3927137271225015, 'support': 464028}, '1': {'precision': 0.343862234091537, 'recall': 0.032709911961806316, 'f1-score': 0.05973730942134481, 'support': 456620}, '2': {'precision': 0.3603681053515953, 'recall': 0.5897072991891684, 'f1-score': 0.44735754889587603, 'support': 469148}, 'accuracy': 0.3571257940014218, 'macro avg': {'precision': 0.3526833463044822, 'recall': 0.3545439884776813, 'f1-score': 0.29993619514657416, 'support': 1389796}, 'weighted avg': {'precision': 0.35275867589644727, 'recall': 0.3571257940014218, 'f1-score': 0.30175962151752994, 'support': 1389796}}
[[204736  14243 245049]
 [195678  14936 246006]
 [178231  14257 276660]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997392
{'0': {'precision': 0.3310609973589576, 'recall': 0.441717432433311, 'f1-score': 0.37846660334843873, 'support': 153811}, '1': {'precision': 0.37636363636363634, 'recall': 0.03311293590700651, 'f1-score': 0.060870417565183306, 'support': 168786}, '2': {'precision': 0.35516986285779323, 'recall': 0.5812441795492643, 'f1-score': 0.44091695807283393, 'support': 161070}, 'accuracy': 0.3455910781591467, 'macro avg': {'precision': 0.3541981655267958, 'recall': 0.3520248492965273, 'f1-score': 0.2934179929954853, 'support': 483667}, 'weighted avg': {'precision': 0.3548990226799763, 'recall': 0.3455910781591467, 'f1-score': 0.28843170086769426, 'support': 483667}}
[[67941  4562 81308]
 [74531  5589 88666]
 [62750  4699 93621]]
training model: results/AAPL/W10/deepVOL_L2/h500
Epoch 1/50
5429/5429 - 123s - loss: 3.2766 - accuracy500: 0.3733 - val_loss: 3.3401 - val_accuracy500: 0.3223 - 123s/epoch - 23ms/step
Epoch 2/50
5429/5429 - 132s - loss: 3.2704 - accuracy500: 0.3771 - val_loss: 3.3462 - val_accuracy500: 0.3242 - 132s/epoch - 24ms/step
Epoch 3/50
5429/5429 - 126s - loss: 3.2662 - accuracy500: 0.3812 - val_loss: 3.3542 - val_accuracy500: 0.3235 - 126s/epoch - 23ms/step
Epoch 4/50
5429/5429 - 121s - loss: 3.2642 - accuracy500: 0.3835 - val_loss: 3.3395 - val_accuracy500: 0.3280 - 121s/epoch - 22ms/step
Epoch 5/50
5429/5429 - 124s - loss: 3.2607 - accuracy500: 0.3871 - val_loss: 3.3388 - val_accuracy500: 0.3294 - 124s/epoch - 23ms/step
Epoch 6/50
5429/5429 - 126s - loss: 3.2581 - accuracy500: 0.3893 - val_loss: 3.3347 - val_accuracy500: 0.3285 - 126s/epoch - 23ms/step
Epoch 7/50
5429/5429 - 125s - loss: 3.2554 - accuracy500: 0.3911 - val_loss: 3.3321 - val_accuracy500: 0.3292 - 125s/epoch - 23ms/step
Epoch 8/50
5429/5429 - 127s - loss: 3.2532 - accuracy500: 0.3922 - val_loss: 3.3335 - val_accuracy500: 0.3309 - 127s/epoch - 23ms/step
Epoch 9/50
5429/5429 - 131s - loss: 3.2514 - accuracy500: 0.3938 - val_loss: 3.3295 - val_accuracy500: 0.3307 - 131s/epoch - 24ms/step
Epoch 10/50
5429/5429 - 128s - loss: 3.2496 - accuracy500: 0.3944 - val_loss: 3.3327 - val_accuracy500: 0.3332 - 128s/epoch - 24ms/step
Epoch 11/50
5429/5429 - 124s - loss: 3.2481 - accuracy500: 0.3954 - val_loss: 3.3332 - val_accuracy500: 0.3331 - 124s/epoch - 23ms/step
Epoch 12/50
5429/5429 - 127s - loss: 3.2466 - accuracy500: 0.3963 - val_loss: 3.3354 - val_accuracy500: 0.3338 - 127s/epoch - 23ms/step
Epoch 13/50
5429/5429 - 128s - loss: 3.2450 - accuracy500: 0.3973 - val_loss: 3.3349 - val_accuracy500: 0.3327 - 128s/epoch - 24ms/step
Epoch 14/50
5429/5429 - 133s - loss: 3.2437 - accuracy500: 0.3980 - val_loss: 3.3350 - val_accuracy500: 0.3323 - 133s/epoch - 24ms/step
Epoch 15/50
5429/5429 - 134s - loss: 3.2424 - accuracy500: 0.3989 - val_loss: 3.3367 - val_accuracy500: 0.3328 - 134s/epoch - 25ms/step
Epoch 16/50
5429/5429 - 131s - loss: 3.2409 - accuracy500: 0.3996 - val_loss: 3.3415 - val_accuracy500: 0.3329 - 131s/epoch - 24ms/step
Epoch 17/50
5429/5429 - 125s - loss: 3.2393 - accuracy500: 0.4007 - val_loss: 3.3415 - val_accuracy500: 0.3331 - 125s/epoch - 23ms/step
Epoch 18/50
5429/5429 - 129s - loss: 3.2380 - accuracy500: 0.4015 - val_loss: 3.3426 - val_accuracy500: 0.3322 - 129s/epoch - 24ms/step
Epoch 19/50
5429/5429 - 130s - loss: 3.2367 - accuracy500: 0.4019 - val_loss: 3.3447 - val_accuracy500: 0.3322 - 130s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h500
Evaluating performance on  test set...
22048/22048 - 231s - 231s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0881443
{'0': {'precision': 0.38588889275683086, 'recall': 0.5916742477199485, 'f1-score': 0.46712178655595543, 'support': 2135807}, '1': {'precision': 0.2634730538922156, 'recall': 0.0015895537136692412, 'f1-score': 0.0031600426408605903, 'support': 1411717}, '2': {'precision': 0.3817328167220088, 'recall': 0.4298421592869026, 'f1-score': 0.4043615514548787, 'support': 2096544}, 'accuracy': 0.3839657849621939, 'macro avg': {'precision': 0.3436982544570184, 'recall': 0.3410353202401734, 'f1-score': 0.29154779355056487, 'support': 5644068}, 'weighted avg': {'precision': 0.3537259356364014, 'recall': 0.3839657849621939, 'f1-score': 0.32776090791765095, 'support': 5644068}}
[[1263702    3237  868868]
 [ 818755    2244  590718]
 [1192325    3036  901183]]
Evaluating performance on  train set...
5429/5429 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018009
{'0': {'precision': 0.3442818436271712, 'recall': 0.5950091762046186, 'f1-score': 0.4361818687364765, 'support': 465334}, '1': {'precision': 0.3634727845254161, 'recall': 0.0017699812925244577, 'f1-score': 0.0035228077824404594, 'support': 456502}, '2': {'precision': 0.3589964241266881, 'recall': 0.44752115565432943, 'f1-score': 0.3984004778781601, 'support': 467960}, 'accuracy': 0.35048884872312197, 'macro avg': {'precision': 0.35558368409309177, 'recall': 0.34810010438382416, 'f1-score': 0.27936838479902565, 'support': 1389796}, 'weighted avg': {'precision': 0.35553999805593955, 'recall': 0.35048884872312197, 'f1-score': 0.28134626242468896, 'support': 1389796}}
[[276878    654 187802]
 [269564    808 186130]
 [257777    761 209422]]
Evaluating performance on  val set...
1890/1890 - 18s - 18s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1083037
{'0': {'precision': 0.3161489471163228, 'recall': 0.5876553143218931, 'f1-score': 0.4111213385839487, 'support': 151628}, '1': {'precision': 0.38558786346396967, 'recall': 0.001764066259485471, 'f1-score': 0.0035120648062318995, 'support': 172896}, '2': {'precision': 0.3504782844436928, 'recall': 0.4427276097597758, 'f1-score': 0.39123867908288773, 'support': 159143}, 'accuracy': 0.3305311298889525, 'macro avg': {'precision': 0.3507383650079951, 'recall': 0.3440489967803848, 'f1-score': 0.26862402749102277, 'support': 483667}, 'weighted avg': {'precision': 0.3522667401663601, 'recall': 0.3305311298889525, 'f1-score': 0.25887154879045554, 'support': 483667}}
[[ 89105    218  62305]
 [104322    305  68269]
 [ 88418    268  70457]]
training model: results/AAPL/W10/deepVOL_L2/h1000
Epoch 1/50
5429/5429 - 132s - loss: 3.2726 - accuracy1000: 0.3791 - val_loss: 3.3907 - val_accuracy1000: 0.3264 - 132s/epoch - 24ms/step
Epoch 2/50
5429/5429 - 125s - loss: 3.2634 - accuracy1000: 0.3843 - val_loss: 3.3697 - val_accuracy1000: 0.3182 - 125s/epoch - 23ms/step
Epoch 3/50
5429/5429 - 134s - loss: 3.2603 - accuracy1000: 0.3869 - val_loss: 3.3863 - val_accuracy1000: 0.3259 - 134s/epoch - 25ms/step
Epoch 4/50
5429/5429 - 129s - loss: 3.2558 - accuracy1000: 0.3903 - val_loss: 3.3554 - val_accuracy1000: 0.3291 - 129s/epoch - 24ms/step
Epoch 5/50
5429/5429 - 132s - loss: 3.2512 - accuracy1000: 0.3942 - val_loss: 3.3625 - val_accuracy1000: 0.3308 - 132s/epoch - 24ms/step
Epoch 6/50
5429/5429 - 114s - loss: 3.2475 - accuracy1000: 0.3964 - val_loss: 3.3670 - val_accuracy1000: 0.3322 - 114s/epoch - 21ms/step
Epoch 7/50
5429/5429 - 132s - loss: 3.2445 - accuracy1000: 0.3984 - val_loss: 3.3751 - val_accuracy1000: 0.3326 - 132s/epoch - 24ms/step
Epoch 8/50
5429/5429 - 122s - loss: 3.2430 - accuracy1000: 0.3991 - val_loss: 3.3744 - val_accuracy1000: 0.3342 - 122s/epoch - 22ms/step
Epoch 9/50
5429/5429 - 123s - loss: 3.2412 - accuracy1000: 0.4005 - val_loss: 3.3819 - val_accuracy1000: 0.3351 - 123s/epoch - 23ms/step
Epoch 10/50
5429/5429 - 121s - loss: 3.2393 - accuracy1000: 0.4009 - val_loss: 3.3841 - val_accuracy1000: 0.3355 - 121s/epoch - 22ms/step
Epoch 11/50
5429/5429 - 126s - loss: 3.2372 - accuracy1000: 0.4021 - val_loss: 3.3946 - val_accuracy1000: 0.3350 - 126s/epoch - 23ms/step
Epoch 12/50
5429/5429 - 118s - loss: 3.2357 - accuracy1000: 0.4025 - val_loss: 3.3992 - val_accuracy1000: 0.3353 - 118s/epoch - 22ms/step
Epoch 13/50
5429/5429 - 132s - loss: 3.2343 - accuracy1000: 0.4033 - val_loss: 3.3955 - val_accuracy1000: 0.3357 - 132s/epoch - 24ms/step
Epoch 14/50
5429/5429 - 130s - loss: 3.2326 - accuracy1000: 0.4038 - val_loss: 3.3941 - val_accuracy1000: 0.3365 - 130s/epoch - 24ms/step
testing model: results/AAPL/W10/deepVOL_L2/h1000
Evaluating performance on  test set...
22048/22048 - 228s - 228s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0853465
{'0': {'precision': 0.3872764643639434, 'recall': 0.7021648481768894, 'f1-score': 0.4992135265522138, 'support': 2156918}, '1': {'precision': 0.26124460874922983, 'recall': 0.0006214093094149373, 'f1-score': 0.0012398694043217052, 'support': 1364640}, '2': {'precision': 0.37794916966641007, 'recall': 0.3080824118614282, 'f1-score': 0.33945810918072666, 'support': 2122510}, 'accuracy': 0.3843447669305189, 'macro avg': {'precision': 0.3421567475931944, 'recall': 0.33695622311591084, 'f1-score': 0.2799705017124207, 'support': 5644068}, 'weighted avg': {'precision': 0.35329647196935776, 'recall': 0.3843447669305189, 'f1-score': 0.3187342618772569, 'support': 5644068}}
[[1514512    1167  641239]
 [ 928791     848  435001]
 [1467371    1231  653908]]
Evaluating performance on  train set...
5429/5429 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1089472
{'0': {'precision': 0.3391364119227645, 'recall': 0.6452823499401187, 'f1-score': 0.44460497770615015, 'support': 462582}, '1': {'precision': 0.36363636363636365, 'recall': 0.0006117477414491867, 'f1-score': 0.001221440645618627, 'support': 457705}, '2': {'precision': 0.3563114485095144, 'recall': 0.3861757708584926, 'f1-score': 0.3706430082688553, 'support': 469509}, 'accuracy': 0.34543846722828386, 'macro avg': {'precision': 0.35302807468954756, 'recall': 0.3440232895133535, 'f1-score': 0.272156475540208, 'support': 1389796}, 'weighted avg': {'precision': 0.35300721357414444, 'recall': 0.34543846722828386, 'f1-score': 0.27359810177700267, 'support': 1389796}}
[[298496    253 163833]
 [293710    280 163715]
 [287959    237 181313]]
Evaluating performance on  val set...
1890/1890 - 20s - 20s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1171688
{'0': {'precision': 0.3138261979155007, 'recall': 0.6498417281432526, 'f1-score': 0.4232523533788374, 'support': 151006}, '1': {'precision': 0.4452054794520548, 'recall': 0.0007626914795628018, 'f1-score': 0.0015227742604295397, 'support': 170449}, '2': {'precision': 0.35632096364083754, 'recall': 0.37493526989371934, 'f1-score': 0.36539120090838634, 'support': 162212}, 'accuracy': 0.328901909785038, 'macro avg': {'precision': 0.3717842136694644, 'recall': 0.34184656317217826, 'f1-score': 0.2633887761825511, 'support': 483667}, 'weighted avg': {'precision': 0.37437742034014915, 'recall': 0.328901909785038, 'f1-score': 0.2552252638819515, 'support': 483667}}
[[ 98130     60  52816]
 [113268    130  57051]
 [101291    102  60819]]
training model: results/AAPL/W10/deepVOL_L3/h10
Epoch 1/50
5429/5429 - 185s - loss: 3.2196 - accuracy10: 0.4123 - val_loss: 3.4065 - val_accuracy10: 0.3924 - 185s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 179s - loss: 3.1574 - accuracy10: 0.4391 - val_loss: 3.2797 - val_accuracy10: 0.4108 - 179s/epoch - 33ms/step
Epoch 3/50
5429/5429 - 182s - loss: 3.1338 - accuracy10: 0.4490 - val_loss: 3.2505 - val_accuracy10: 0.4160 - 182s/epoch - 34ms/step
Epoch 4/50
5429/5429 - 180s - loss: 3.1219 - accuracy10: 0.4533 - val_loss: 3.2326 - val_accuracy10: 0.4202 - 180s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 180s - loss: 3.1140 - accuracy10: 0.4562 - val_loss: 3.2139 - val_accuracy10: 0.4207 - 180s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 186s - loss: 3.1086 - accuracy10: 0.4584 - val_loss: 3.2213 - val_accuracy10: 0.4204 - 186s/epoch - 34ms/step
Epoch 7/50
5429/5429 - 187s - loss: 3.1037 - accuracy10: 0.4600 - val_loss: 3.2287 - val_accuracy10: 0.4190 - 187s/epoch - 34ms/step
Epoch 8/50
5429/5429 - 186s - loss: 3.0993 - accuracy10: 0.4617 - val_loss: 3.2167 - val_accuracy10: 0.4225 - 186s/epoch - 34ms/step
Epoch 9/50
5429/5429 - 184s - loss: 3.0954 - accuracy10: 0.4630 - val_loss: 3.2118 - val_accuracy10: 0.4233 - 184s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 183s - loss: 3.0920 - accuracy10: 0.4638 - val_loss: 3.2134 - val_accuracy10: 0.4232 - 183s/epoch - 34ms/step
Epoch 11/50
5429/5429 - 196s - loss: 3.0890 - accuracy10: 0.4653 - val_loss: 3.2076 - val_accuracy10: 0.4263 - 196s/epoch - 36ms/step
Epoch 12/50
5429/5429 - 196s - loss: 3.0865 - accuracy10: 0.4663 - val_loss: 3.2105 - val_accuracy10: 0.4258 - 196s/epoch - 36ms/step
Epoch 13/50
5429/5429 - 178s - loss: 3.0839 - accuracy10: 0.4670 - val_loss: 3.2118 - val_accuracy10: 0.4267 - 178s/epoch - 33ms/step
Epoch 14/50
5429/5429 - 182s - loss: 3.0821 - accuracy10: 0.4676 - val_loss: 3.2134 - val_accuracy10: 0.4264 - 182s/epoch - 34ms/step
Epoch 15/50
5429/5429 - 178s - loss: 3.0798 - accuracy10: 0.4683 - val_loss: 3.2115 - val_accuracy10: 0.4272 - 178s/epoch - 33ms/step
Epoch 16/50
5429/5429 - 180s - loss: 3.0773 - accuracy10: 0.4688 - val_loss: 3.2023 - val_accuracy10: 0.4300 - 180s/epoch - 33ms/step
Epoch 17/50
5429/5429 - 179s - loss: 3.0753 - accuracy10: 0.4699 - val_loss: 3.2112 - val_accuracy10: 0.4278 - 179s/epoch - 33ms/step
Epoch 18/50
5429/5429 - 186s - loss: 3.0734 - accuracy10: 0.4700 - val_loss: 3.2067 - val_accuracy10: 0.4292 - 186s/epoch - 34ms/step
Epoch 19/50
5429/5429 - 187s - loss: 3.0716 - accuracy10: 0.4708 - val_loss: 3.2118 - val_accuracy10: 0.4283 - 187s/epoch - 35ms/step
Epoch 20/50
5429/5429 - 183s - loss: 3.0698 - accuracy10: 0.4711 - val_loss: 3.2068 - val_accuracy10: 0.4296 - 183s/epoch - 34ms/step
Epoch 21/50
5429/5429 - 185s - loss: 3.0680 - accuracy10: 0.4716 - val_loss: 3.2078 - val_accuracy10: 0.4287 - 185s/epoch - 34ms/step
Epoch 22/50
5429/5429 - 180s - loss: 3.0662 - accuracy10: 0.4723 - val_loss: 3.2069 - val_accuracy10: 0.4299 - 180s/epoch - 33ms/step
Epoch 23/50
5429/5429 - 177s - loss: 3.0647 - accuracy10: 0.4728 - val_loss: 3.2046 - val_accuracy10: 0.4304 - 177s/epoch - 33ms/step
Epoch 24/50
5429/5429 - 181s - loss: 3.0633 - accuracy10: 0.4734 - val_loss: 3.1994 - val_accuracy10: 0.4314 - 181s/epoch - 33ms/step
Epoch 25/50
5429/5429 - 177s - loss: 3.0613 - accuracy10: 0.4741 - val_loss: 3.2025 - val_accuracy10: 0.4322 - 177s/epoch - 33ms/step
Epoch 26/50
5429/5429 - 186s - loss: 3.0603 - accuracy10: 0.4745 - val_loss: 3.2030 - val_accuracy10: 0.4314 - 186s/epoch - 34ms/step
Epoch 27/50
5429/5429 - 183s - loss: 3.0586 - accuracy10: 0.4750 - val_loss: 3.2037 - val_accuracy10: 0.4315 - 183s/epoch - 34ms/step
Epoch 28/50
5429/5429 - 184s - loss: 3.0569 - accuracy10: 0.4756 - val_loss: 3.1965 - val_accuracy10: 0.4322 - 184s/epoch - 34ms/step
Epoch 29/50
5429/5429 - 195s - loss: 3.0556 - accuracy10: 0.4760 - val_loss: 3.1980 - val_accuracy10: 0.4325 - 195s/epoch - 36ms/step
Epoch 30/50
5429/5429 - 199s - loss: 3.0542 - accuracy10: 0.4764 - val_loss: 3.1982 - val_accuracy10: 0.4327 - 199s/epoch - 37ms/step
Epoch 31/50
5429/5429 - 201s - loss: 3.0524 - accuracy10: 0.4769 - val_loss: 3.1945 - val_accuracy10: 0.4337 - 201s/epoch - 37ms/step
Epoch 32/50
5429/5429 - 196s - loss: 3.0513 - accuracy10: 0.4775 - val_loss: 3.1918 - val_accuracy10: 0.4348 - 196s/epoch - 36ms/step
Epoch 33/50
5429/5429 - 202s - loss: 3.0499 - accuracy10: 0.4780 - val_loss: 3.1891 - val_accuracy10: 0.4357 - 202s/epoch - 37ms/step
Epoch 34/50
5429/5429 - 197s - loss: 3.0485 - accuracy10: 0.4784 - val_loss: 3.1942 - val_accuracy10: 0.4351 - 197s/epoch - 36ms/step
Epoch 35/50
5429/5429 - 201s - loss: 3.0473 - accuracy10: 0.4787 - val_loss: 3.1928 - val_accuracy10: 0.4354 - 201s/epoch - 37ms/step
Epoch 36/50
5429/5429 - 197s - loss: 3.0460 - accuracy10: 0.4794 - val_loss: 3.2024 - val_accuracy10: 0.4335 - 197s/epoch - 36ms/step
Epoch 37/50
5429/5429 - 199s - loss: 3.0450 - accuracy10: 0.4798 - val_loss: 3.2043 - val_accuracy10: 0.4332 - 199s/epoch - 37ms/step
Epoch 38/50
5429/5429 - 196s - loss: 3.0434 - accuracy10: 0.4803 - val_loss: 3.1906 - val_accuracy10: 0.4361 - 196s/epoch - 36ms/step
Epoch 39/50
5429/5429 - 199s - loss: 3.0422 - accuracy10: 0.4804 - val_loss: 3.1924 - val_accuracy10: 0.4363 - 199s/epoch - 37ms/step
Epoch 40/50
5429/5429 - 196s - loss: 3.0410 - accuracy10: 0.4807 - val_loss: 3.1967 - val_accuracy10: 0.4350 - 196s/epoch - 36ms/step
Epoch 41/50
5429/5429 - 200s - loss: 3.0393 - accuracy10: 0.4815 - val_loss: 3.1877 - val_accuracy10: 0.4368 - 200s/epoch - 37ms/step
Epoch 42/50
5429/5429 - 197s - loss: 3.0383 - accuracy10: 0.4817 - val_loss: 3.1906 - val_accuracy10: 0.4369 - 197s/epoch - 36ms/step
Epoch 43/50
5429/5429 - 199s - loss: 3.0371 - accuracy10: 0.4820 - val_loss: 3.1908 - val_accuracy10: 0.4366 - 199s/epoch - 37ms/step
Epoch 44/50
5429/5429 - 198s - loss: 3.0362 - accuracy10: 0.4824 - val_loss: 3.1941 - val_accuracy10: 0.4360 - 198s/epoch - 36ms/step
Epoch 45/50
5429/5429 - 196s - loss: 3.0348 - accuracy10: 0.4826 - val_loss: 3.1919 - val_accuracy10: 0.4361 - 196s/epoch - 36ms/step
Epoch 46/50
5429/5429 - 198s - loss: 3.0338 - accuracy10: 0.4829 - val_loss: 3.1952 - val_accuracy10: 0.4356 - 198s/epoch - 36ms/step
Epoch 47/50
5429/5429 - 200s - loss: 3.0326 - accuracy10: 0.4835 - val_loss: 3.1930 - val_accuracy10: 0.4370 - 200s/epoch - 37ms/step
Epoch 48/50
5429/5429 - 197s - loss: 3.0315 - accuracy10: 0.4840 - val_loss: 3.1979 - val_accuracy10: 0.4350 - 197s/epoch - 36ms/step
Epoch 49/50
5429/5429 - 200s - loss: 3.0304 - accuracy10: 0.4844 - val_loss: 3.1928 - val_accuracy10: 0.4358 - 200s/epoch - 37ms/step
Epoch 50/50
5429/5429 - 198s - loss: 3.0293 - accuracy10: 0.4846 - val_loss: 3.1967 - val_accuracy10: 0.4361 - 198s/epoch - 36ms/step
testing model: results/AAPL/W10/deepVOL_L3/h10
Evaluating performance on  test set...
22048/22048 - 336s - 336s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.030042
{'0': {'precision': 0.49018100740100073, 'recall': 0.5691530539524615, 'f1-score': 0.5267233963860721, 'support': 2146890}, '1': {'precision': 0.46004341102867113, 'recall': 0.024580502510125016, 'f1-score': 0.046667520539724526, 'support': 1319257}, '2': {'precision': 0.4745414190043651, 'recall': 0.6712690680699621, 'f1-score': 0.5560168626297344, 'support': 2177921}, 'accuracy': 0.4812677664408012, 'macro avg': {'precision': 0.47492194581134567, 'recall': 0.42166754151084956, 'f1-score': 0.3764692598518437, 'support': 5644068}, 'weighted avg': {'precision': 0.4771016074047995, 'recall': 0.4812677664408012, 'f1-score': 0.42581776957460177, 'support': 5644068}}
[[1221909   19968  905013]
 [ 573005   32428  713824]
 [ 697857   18093 1461971]]
Evaluating performance on  train set...
5429/5429 - 92s - 92s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0464386
{'0': {'precision': 0.4555596183891234, 'recall': 0.594192310610577, 'f1-score': 0.5157218858924967, 'support': 461285}, '1': {'precision': 0.542360359212789, 'recall': 0.09250395952055583, 'f1-score': 0.15805103305938514, 'support': 460283}, '2': {'precision': 0.4426948653596024, 'recall': 0.6709338185670229, 'f1-score': 0.53342547792223, 'support': 468228}, 'accuracy': 0.4538939527815593, 'macro avg': {'precision': 0.4802049476538383, 'recall': 0.4525433628993853, 'f1-score': 0.4023994656247039, 'support': 1389796}, 'weighted avg': {'precision': 0.47997274650795, 'recall': 0.4538939527815593, 'f1-score': 0.40323019958336564, 'support': 1389796}}
[[274092  18373 168820]
 [191044  42578 226661]
 [136524  17554 314150]]
Evaluating performance on  val set...
1890/1890 - 32s - 32s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0612073
{'0': {'precision': 0.43684177668070556, 'recall': 0.5942174782142904, 'f1-score': 0.5035191094701824, 'support': 153082}, '1': {'precision': 0.5514486867045763, 'recall': 0.09332432091834982, 'f1-score': 0.1596331533720691, 'support': 174574}, '2': {'precision': 0.4232020561872692, 'recall': 0.6670170693092153, 'f1-score': 0.5178463460088628, 'support': 156011}, 'accuracy': 0.43690803796827155, 'macro avg': {'precision': 0.47049750652418365, 'recall': 0.4515196228139519, 'f1-score': 0.3936662029503714, 'support': 483667}, 'weighted avg': {'precision': 0.47380820249972094, 'recall': 0.43690803796827155, 'f1-score': 0.38401883262632913, 'support': 483667}}
[[ 90964   6646  55472]
 [ 71924  16292  86358]
 [ 45343   6606 104062]]
training model: results/AAPL/W10/deepVOL_L3/h20
Epoch 1/50
5429/5429 - 187s - loss: 3.2407 - accuracy20: 0.4022 - val_loss: 3.2724 - val_accuracy20: 0.3904 - 187s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 181s - loss: 3.2059 - accuracy20: 0.4183 - val_loss: 3.2770 - val_accuracy20: 0.3911 - 181s/epoch - 33ms/step
Epoch 3/50
5429/5429 - 180s - loss: 3.1939 - accuracy20: 0.4239 - val_loss: 3.2658 - val_accuracy20: 0.3956 - 180s/epoch - 33ms/step
Epoch 4/50
5429/5429 - 180s - loss: 3.1851 - accuracy20: 0.4278 - val_loss: 3.2700 - val_accuracy20: 0.3961 - 180s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 176s - loss: 3.1771 - accuracy20: 0.4314 - val_loss: 3.2639 - val_accuracy20: 0.3998 - 176s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 181s - loss: 3.1710 - accuracy20: 0.4338 - val_loss: 3.2644 - val_accuracy20: 0.4008 - 181s/epoch - 33ms/step
Epoch 7/50
5429/5429 - 181s - loss: 3.1660 - accuracy20: 0.4358 - val_loss: 3.2534 - val_accuracy20: 0.4034 - 181s/epoch - 33ms/step
Epoch 8/50
5429/5429 - 178s - loss: 3.1618 - accuracy20: 0.4374 - val_loss: 3.2498 - val_accuracy20: 0.4040 - 178s/epoch - 33ms/step
Epoch 9/50
5429/5429 - 177s - loss: 3.1582 - accuracy20: 0.4394 - val_loss: 3.2463 - val_accuracy20: 0.4054 - 177s/epoch - 33ms/step
Epoch 10/50
5429/5429 - 177s - loss: 3.1554 - accuracy20: 0.4404 - val_loss: 3.2436 - val_accuracy20: 0.4063 - 177s/epoch - 33ms/step
Epoch 11/50
5429/5429 - 176s - loss: 3.1525 - accuracy20: 0.4412 - val_loss: 3.2448 - val_accuracy20: 0.4066 - 176s/epoch - 32ms/step
Epoch 12/50
5429/5429 - 180s - loss: 3.1500 - accuracy20: 0.4422 - val_loss: 3.2377 - val_accuracy20: 0.4071 - 180s/epoch - 33ms/step
Epoch 13/50
5429/5429 - 178s - loss: 3.1478 - accuracy20: 0.4427 - val_loss: 3.2378 - val_accuracy20: 0.4077 - 178s/epoch - 33ms/step
Epoch 14/50
5429/5429 - 179s - loss: 3.1460 - accuracy20: 0.4437 - val_loss: 3.2348 - val_accuracy20: 0.4074 - 179s/epoch - 33ms/step
Epoch 15/50
5429/5429 - 177s - loss: 3.1442 - accuracy20: 0.4441 - val_loss: 3.2313 - val_accuracy20: 0.4089 - 177s/epoch - 33ms/step
Epoch 16/50
5429/5429 - 177s - loss: 3.1423 - accuracy20: 0.4449 - val_loss: 3.2285 - val_accuracy20: 0.4098 - 177s/epoch - 33ms/step
Epoch 17/50
5429/5429 - 178s - loss: 3.1409 - accuracy20: 0.4455 - val_loss: 3.2266 - val_accuracy20: 0.4098 - 178s/epoch - 33ms/step
Epoch 18/50
5429/5429 - 180s - loss: 3.1392 - accuracy20: 0.4458 - val_loss: 3.2319 - val_accuracy20: 0.4094 - 180s/epoch - 33ms/step
Epoch 19/50
5429/5429 - 179s - loss: 3.1378 - accuracy20: 0.4465 - val_loss: 3.2290 - val_accuracy20: 0.4102 - 179s/epoch - 33ms/step
Epoch 20/50
5429/5429 - 178s - loss: 3.1361 - accuracy20: 0.4472 - val_loss: 3.2291 - val_accuracy20: 0.4102 - 178s/epoch - 33ms/step
Epoch 21/50
5429/5429 - 179s - loss: 3.1354 - accuracy20: 0.4475 - val_loss: 3.2234 - val_accuracy20: 0.4114 - 179s/epoch - 33ms/step
Epoch 22/50
5429/5429 - 177s - loss: 3.1338 - accuracy20: 0.4480 - val_loss: 3.2294 - val_accuracy20: 0.4108 - 177s/epoch - 33ms/step
Epoch 23/50
5429/5429 - 178s - loss: 3.1324 - accuracy20: 0.4484 - val_loss: 3.2262 - val_accuracy20: 0.4116 - 178s/epoch - 33ms/step
Epoch 24/50
5429/5429 - 178s - loss: 3.1315 - accuracy20: 0.4486 - val_loss: 3.2260 - val_accuracy20: 0.4112 - 178s/epoch - 33ms/step
Epoch 25/50
5429/5429 - 178s - loss: 3.1303 - accuracy20: 0.4493 - val_loss: 3.2250 - val_accuracy20: 0.4110 - 178s/epoch - 33ms/step
Epoch 26/50
5429/5429 - 178s - loss: 3.1289 - accuracy20: 0.4496 - val_loss: 3.2190 - val_accuracy20: 0.4126 - 178s/epoch - 33ms/step
Epoch 27/50
5429/5429 - 177s - loss: 3.1278 - accuracy20: 0.4499 - val_loss: 3.2270 - val_accuracy20: 0.4119 - 177s/epoch - 33ms/step
Epoch 28/50
5429/5429 - 181s - loss: 3.1266 - accuracy20: 0.4506 - val_loss: 3.2253 - val_accuracy20: 0.4114 - 181s/epoch - 33ms/step
Epoch 29/50
5429/5429 - 177s - loss: 3.1254 - accuracy20: 0.4508 - val_loss: 3.2165 - val_accuracy20: 0.4131 - 177s/epoch - 33ms/step
Epoch 30/50
5429/5429 - 177s - loss: 3.1243 - accuracy20: 0.4516 - val_loss: 3.2172 - val_accuracy20: 0.4135 - 177s/epoch - 33ms/step
Epoch 31/50
5429/5429 - 177s - loss: 3.1233 - accuracy20: 0.4517 - val_loss: 3.2176 - val_accuracy20: 0.4126 - 177s/epoch - 33ms/step
Epoch 32/50
5429/5429 - 181s - loss: 3.1220 - accuracy20: 0.4521 - val_loss: 3.2160 - val_accuracy20: 0.4135 - 181s/epoch - 33ms/step
Epoch 33/50
5429/5429 - 182s - loss: 3.1209 - accuracy20: 0.4525 - val_loss: 3.2137 - val_accuracy20: 0.4148 - 182s/epoch - 33ms/step
Epoch 34/50
5429/5429 - 183s - loss: 3.1198 - accuracy20: 0.4531 - val_loss: 3.2152 - val_accuracy20: 0.4141 - 183s/epoch - 34ms/step
Epoch 35/50
5429/5429 - 184s - loss: 3.1188 - accuracy20: 0.4537 - val_loss: 3.2088 - val_accuracy20: 0.4160 - 184s/epoch - 34ms/step
Epoch 36/50
5429/5429 - 188s - loss: 3.1176 - accuracy20: 0.4537 - val_loss: 3.2168 - val_accuracy20: 0.4144 - 188s/epoch - 35ms/step
Epoch 37/50
5429/5429 - 178s - loss: 3.1165 - accuracy20: 0.4540 - val_loss: 3.2135 - val_accuracy20: 0.4151 - 178s/epoch - 33ms/step
Epoch 38/50
5429/5429 - 179s - loss: 3.1159 - accuracy20: 0.4542 - val_loss: 3.2136 - val_accuracy20: 0.4149 - 179s/epoch - 33ms/step
Epoch 39/50
5429/5429 - 179s - loss: 3.1146 - accuracy20: 0.4551 - val_loss: 3.2132 - val_accuracy20: 0.4141 - 179s/epoch - 33ms/step
Epoch 40/50
5429/5429 - 183s - loss: 3.1138 - accuracy20: 0.4555 - val_loss: 3.2124 - val_accuracy20: 0.4150 - 183s/epoch - 34ms/step
Epoch 41/50
5429/5429 - 183s - loss: 3.1129 - accuracy20: 0.4554 - val_loss: 3.2140 - val_accuracy20: 0.4150 - 183s/epoch - 34ms/step
Epoch 42/50
5429/5429 - 183s - loss: 3.1116 - accuracy20: 0.4560 - val_loss: 3.2176 - val_accuracy20: 0.4140 - 183s/epoch - 34ms/step
Epoch 43/50
5429/5429 - 181s - loss: 3.1105 - accuracy20: 0.4563 - val_loss: 3.2206 - val_accuracy20: 0.4133 - 181s/epoch - 33ms/step
Epoch 44/50
5429/5429 - 181s - loss: 3.1096 - accuracy20: 0.4564 - val_loss: 3.2132 - val_accuracy20: 0.4146 - 181s/epoch - 33ms/step
Epoch 45/50
5429/5429 - 179s - loss: 3.1086 - accuracy20: 0.4571 - val_loss: 3.2221 - val_accuracy20: 0.4132 - 179s/epoch - 33ms/step
testing model: results/AAPL/W10/deepVOL_L3/h20
Evaluating performance on  test set...
22048/22048 - 298s - 298s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0539275
{'0': {'precision': 0.4565540035450295, 'recall': 0.5447064373087432, 'f1-score': 0.49674968582200385, 'support': 2075417}, '1': {'precision': 0.3666489220122438, 'recall': 0.009550843420942244, 'f1-score': 0.018616739117654414, 'support': 1442281}, '2': {'precision': 0.4453622672188937, 'recall': 0.6556441259047109, 'f1-score': 0.530422268617818, 'support': 2126370}, 'accuracy': 0.4497483021111723, 'macro avg': {'precision': 0.4228550642587223, 'recall': 0.4033004688781321, 'f1-score': 0.34859623118582544, 'support': 5644068}, 'weighted avg': {'precision': 0.42936330292448543, 'recall': 0.4497483021111723, 'f1-score': 0.3872538940232232, 'support': 5644068}}
[[1130493   13145  931779]
 [ 624072   13775  804434]
 [ 721578   10650 1394142]]
Evaluating performance on  train set...
5429/5429 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0576272
{'0': {'precision': 0.43839674940908463, 'recall': 0.5577854867194969, 'f1-score': 0.49093696991767855, 'support': 459207}, '1': {'precision': 0.46899385463785614, 'recall': 0.05667025247268182, 'f1-score': 0.10112160899307761, 'support': 459218}, '2': {'precision': 0.4239364623942062, 'recall': 0.6745663182503803, 'f1-score': 0.5206600541175604, 'support': 471371}, 'accuracy': 0.4318144533442318, 'macro avg': {'precision': 0.44377568881371565, 'recall': 0.4296740191475197, 'f1-score': 0.3709062110094388, 'support': 1389796}, 'weighted avg': {'precision': 0.44360224828694567, 'recall': 0.4318144533442318, 'f1-score': 0.3722147758038008, 'support': 1389796}}
[[256139  15516 187552]
 [188673  26024 244521]
 [139451  13949 317971]]
Evaluating performance on  val set...
1890/1890 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0681949
{'0': {'precision': 0.4186704384724187, 'recall': 0.5603352611721085, 'f1-score': 0.479253204698736, 'support': 153194}, '1': {'precision': 0.46912938731163495, 'recall': 0.05765289831935212, 'f1-score': 0.10268632641244106, 'support': 172255}, '2': {'precision': 0.40937902962698275, 'recall': 0.6661821031741015, 'f1-score': 0.5071231650813354, 'support': 158218}, 'accuracy': 0.41593286289947423, 'macro avg': {'precision': 0.4323929518036788, 'recall': 0.4280567542218541, 'f1-score': 0.3630208987308374, 'support': 483667}, 'weighted avg': {'precision': 0.4336016579014722, 'recall': 0.41593286289947423, 'f1-score': 0.3542581187669035, 'support': 483667}}
[[ 85840   5778  61576]
 [ 71834   9931  90490]
 [ 47356   5460 105402]]
training model: results/AAPL/W10/deepVOL_L3/h30
Epoch 1/50
5429/5429 - 187s - loss: 3.2486 - accuracy30: 0.3988 - val_loss: 3.3567 - val_accuracy30: 0.3660 - 187s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 180s - loss: 3.2199 - accuracy30: 0.4127 - val_loss: 3.3382 - val_accuracy30: 0.3734 - 180s/epoch - 33ms/step
Epoch 3/50
5429/5429 - 178s - loss: 3.2107 - accuracy30: 0.4172 - val_loss: 3.3339 - val_accuracy30: 0.3733 - 178s/epoch - 33ms/step
Epoch 4/50
5429/5429 - 178s - loss: 3.2040 - accuracy30: 0.4205 - val_loss: 3.3247 - val_accuracy30: 0.3760 - 178s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 176s - loss: 3.1989 - accuracy30: 0.4230 - val_loss: 3.3247 - val_accuracy30: 0.3768 - 176s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 182s - loss: 3.1949 - accuracy30: 0.4248 - val_loss: 3.3184 - val_accuracy30: 0.3780 - 182s/epoch - 34ms/step
Epoch 7/50
5429/5429 - 179s - loss: 3.1914 - accuracy30: 0.4263 - val_loss: 3.3111 - val_accuracy30: 0.3791 - 179s/epoch - 33ms/step
Epoch 8/50
5429/5429 - 179s - loss: 3.1880 - accuracy30: 0.4278 - val_loss: 3.3121 - val_accuracy30: 0.3787 - 179s/epoch - 33ms/step
Epoch 9/50
5429/5429 - 184s - loss: 3.1851 - accuracy30: 0.4291 - val_loss: 3.3038 - val_accuracy30: 0.3791 - 184s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 184s - loss: 3.1825 - accuracy30: 0.4297 - val_loss: 3.3032 - val_accuracy30: 0.3809 - 184s/epoch - 34ms/step
Epoch 11/50
5429/5429 - 177s - loss: 3.1804 - accuracy30: 0.4308 - val_loss: 3.3058 - val_accuracy30: 0.3808 - 177s/epoch - 33ms/step
Epoch 12/50
5429/5429 - 177s - loss: 3.1779 - accuracy30: 0.4318 - val_loss: 3.3081 - val_accuracy30: 0.3812 - 177s/epoch - 33ms/step
Epoch 13/50
5429/5429 - 176s - loss: 3.1757 - accuracy30: 0.4327 - val_loss: 3.3099 - val_accuracy30: 0.3805 - 176s/epoch - 32ms/step
Epoch 14/50
5429/5429 - 176s - loss: 3.1739 - accuracy30: 0.4333 - val_loss: 3.3082 - val_accuracy30: 0.3811 - 176s/epoch - 32ms/step
Epoch 15/50
5429/5429 - 179s - loss: 3.1720 - accuracy30: 0.4339 - val_loss: 3.3057 - val_accuracy30: 0.3808 - 179s/epoch - 33ms/step
Epoch 16/50
5429/5429 - 183s - loss: 3.1706 - accuracy30: 0.4344 - val_loss: 3.3022 - val_accuracy30: 0.3818 - 183s/epoch - 34ms/step
Epoch 17/50
5429/5429 - 184s - loss: 3.1690 - accuracy30: 0.4351 - val_loss: 3.2945 - val_accuracy30: 0.3821 - 184s/epoch - 34ms/step
Epoch 18/50
5429/5429 - 183s - loss: 3.1673 - accuracy30: 0.4356 - val_loss: 3.2977 - val_accuracy30: 0.3825 - 183s/epoch - 34ms/step
Epoch 19/50
5429/5429 - 184s - loss: 3.1660 - accuracy30: 0.4362 - val_loss: 3.2943 - val_accuracy30: 0.3824 - 184s/epoch - 34ms/step
Epoch 20/50
5429/5429 - 182s - loss: 3.1647 - accuracy30: 0.4367 - val_loss: 3.2943 - val_accuracy30: 0.3819 - 182s/epoch - 34ms/step
Epoch 21/50
5429/5429 - 177s - loss: 3.1636 - accuracy30: 0.4371 - val_loss: 3.2960 - val_accuracy30: 0.3826 - 177s/epoch - 33ms/step
Epoch 22/50
5429/5429 - 196s - loss: 3.1624 - accuracy30: 0.4375 - val_loss: 3.2904 - val_accuracy30: 0.3824 - 196s/epoch - 36ms/step
Epoch 23/50
5429/5429 - 183s - loss: 3.1609 - accuracy30: 0.4384 - val_loss: 3.2927 - val_accuracy30: 0.3833 - 183s/epoch - 34ms/step
Epoch 24/50
5429/5429 - 176s - loss: 3.1597 - accuracy30: 0.4389 - val_loss: 3.2919 - val_accuracy30: 0.3822 - 176s/epoch - 32ms/step
Epoch 25/50
5429/5429 - 176s - loss: 3.1588 - accuracy30: 0.4388 - val_loss: 3.2858 - val_accuracy30: 0.3840 - 176s/epoch - 32ms/step
Epoch 26/50
5429/5429 - 177s - loss: 3.1575 - accuracy30: 0.4398 - val_loss: 3.2874 - val_accuracy30: 0.3839 - 177s/epoch - 33ms/step
Epoch 27/50
5429/5429 - 177s - loss: 3.1566 - accuracy30: 0.4400 - val_loss: 3.2878 - val_accuracy30: 0.3832 - 177s/epoch - 33ms/step
Epoch 28/50
5429/5429 - 179s - loss: 3.1552 - accuracy30: 0.4407 - val_loss: 3.2845 - val_accuracy30: 0.3838 - 179s/epoch - 33ms/step
Epoch 29/50
5429/5429 - 178s - loss: 3.1539 - accuracy30: 0.4410 - val_loss: 3.2815 - val_accuracy30: 0.3844 - 178s/epoch - 33ms/step
Epoch 30/50
5429/5429 - 179s - loss: 3.1531 - accuracy30: 0.4415 - val_loss: 3.2795 - val_accuracy30: 0.3843 - 179s/epoch - 33ms/step
Epoch 31/50
5429/5429 - 178s - loss: 3.1520 - accuracy30: 0.4418 - val_loss: 3.2717 - val_accuracy30: 0.3848 - 178s/epoch - 33ms/step
Epoch 32/50
5429/5429 - 181s - loss: 3.1510 - accuracy30: 0.4425 - val_loss: 3.2787 - val_accuracy30: 0.3854 - 181s/epoch - 33ms/step
Epoch 33/50
5429/5429 - 182s - loss: 3.1499 - accuracy30: 0.4428 - val_loss: 3.2718 - val_accuracy30: 0.3860 - 182s/epoch - 34ms/step
Epoch 34/50
5429/5429 - 179s - loss: 3.1487 - accuracy30: 0.4432 - val_loss: 3.2745 - val_accuracy30: 0.3858 - 179s/epoch - 33ms/step
Epoch 35/50
5429/5429 - 178s - loss: 3.1480 - accuracy30: 0.4434 - val_loss: 3.2695 - val_accuracy30: 0.3866 - 178s/epoch - 33ms/step
Epoch 36/50
5429/5429 - 179s - loss: 3.1469 - accuracy30: 0.4439 - val_loss: 3.2659 - val_accuracy30: 0.3866 - 179s/epoch - 33ms/step
Epoch 37/50
5429/5429 - 179s - loss: 3.1462 - accuracy30: 0.4439 - val_loss: 3.2697 - val_accuracy30: 0.3860 - 179s/epoch - 33ms/step
Epoch 38/50
5429/5429 - 178s - loss: 3.1449 - accuracy30: 0.4441 - val_loss: 3.2637 - val_accuracy30: 0.3877 - 178s/epoch - 33ms/step
Epoch 39/50
5429/5429 - 179s - loss: 3.1437 - accuracy30: 0.4449 - val_loss: 3.2697 - val_accuracy30: 0.3846 - 179s/epoch - 33ms/step
Epoch 40/50
5429/5429 - 179s - loss: 3.1425 - accuracy30: 0.4457 - val_loss: 3.2715 - val_accuracy30: 0.3851 - 179s/epoch - 33ms/step
Epoch 41/50
5429/5429 - 176s - loss: 3.1417 - accuracy30: 0.4458 - val_loss: 3.2662 - val_accuracy30: 0.3859 - 176s/epoch - 32ms/step
Epoch 42/50
5429/5429 - 177s - loss: 3.1406 - accuracy30: 0.4462 - val_loss: 3.2640 - val_accuracy30: 0.3868 - 177s/epoch - 33ms/step
Epoch 43/50
5429/5429 - 177s - loss: 3.1398 - accuracy30: 0.4467 - val_loss: 3.2661 - val_accuracy30: 0.3865 - 177s/epoch - 33ms/step
Epoch 44/50
5429/5429 - 176s - loss: 3.1385 - accuracy30: 0.4470 - val_loss: 3.2762 - val_accuracy30: 0.3840 - 176s/epoch - 32ms/step
Epoch 45/50
5429/5429 - 179s - loss: 3.1376 - accuracy30: 0.4475 - val_loss: 3.2694 - val_accuracy30: 0.3852 - 179s/epoch - 33ms/step
Epoch 46/50
5429/5429 - 182s - loss: 3.1363 - accuracy30: 0.4478 - val_loss: 3.2649 - val_accuracy30: 0.3856 - 182s/epoch - 33ms/step
Epoch 47/50
5429/5429 - 183s - loss: 3.1353 - accuracy30: 0.4486 - val_loss: 3.2658 - val_accuracy30: 0.3867 - 183s/epoch - 34ms/step
Epoch 48/50
5429/5429 - 178s - loss: 3.1342 - accuracy30: 0.4487 - val_loss: 3.2663 - val_accuracy30: 0.3845 - 178s/epoch - 33ms/step
testing model: results/AAPL/W10/deepVOL_L3/h30
Evaluating performance on  test set...
22048/22048 - 292s - 292s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0669929
{'0': {'precision': 0.42767246884695365, 'recall': 0.573838164927319, 'f1-score': 0.49008922409182354, 'support': 2039941}, '1': {'precision': 0.3884598572053038, 'recall': 0.003529835450881532, 'f1-score': 0.006996099136771639, 'support': 1510552}, '2': {'precision': 0.43440814873445066, 'recall': 0.6003291021339097, 'f1-score': 0.5040658460310601, 'support': 2093575}, 'accuracy': 0.4310298883712953, 'macro avg': {'precision': 0.41684682492890274, 'recall': 0.39256570083737, 'f1-score': 0.3337170564198851, 'support': 5644068}, 'weighted avg': {'precision': 0.4196762792333538, 'recall': 0.4310298883712953, 'f1-score': 0.3659808363454912, 'support': 5644068}}
[[1170596    4300  865045]
 [ 733889    5332  771331]
 [ 832647    4094 1256834]]
Evaluating performance on  train set...
5429/5429 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681924
{'0': {'precision': 0.4124501704742957, 'recall': 0.6091619296459577, 'f1-score': 0.4918675918175829, 'support': 457742}, '1': {'precision': 0.44300062587548056, 'recall': 0.03242342409158134, 'f1-score': 0.06042436080628146, 'support': 458434}, '2': {'precision': 0.4258646139008627, 'recall': 0.6116042396858241, 'f1-score': 0.5021078030313536, 'support': 473620}, 'accuracy': 0.41975297093961994, 'macro avg': {'precision': 0.427105136750213, 'recall': 0.4177298644744544, 'f1-score': 0.351466585218406, 'support': 1389796}, 'weighted avg': {'precision': 0.4270988787502423, 'recall': 0.41975297093961994, 'f1-score': 0.3530427014521128, 'support': 1389796}}
[[278839   9613 169290]
 [222340  14864 221230]
 [174876   9076 289668]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0860224
{'0': {'precision': 0.37598172033612604, 'recall': 0.6191680546131227, 'f1-score': 0.4678609717064682, 'support': 145899}, '1': {'precision': 0.4814510158756272, 'recall': 0.031524859557370076, 'f1-score': 0.0591750075826509, 'support': 185663}, '2': {'precision': 0.3945200503366588, 'recall': 0.5997830446073437, 'f1-score': 0.47596439788390704, 'support': 152105}, 'accuracy': 0.3874959424562767, 'macro avg': {'precision': 0.4173175955161374, 'recall': 0.41682531959261215, 'f1-score': 0.33433345905767536, 'support': 483667}, 'weighted avg': {'precision': 0.42229771564380975, 'recall': 0.3874959424562767, 'f1-score': 0.3135289818903324, 'support': 483667}}
[[90336  3101 52462]
 [92259  5853 87551]
 [57672  3203 91230]]
training model: results/AAPL/W10/deepVOL_L3/h50
Epoch 1/50
5429/5429 - 184s - loss: 3.2461 - accuracy50: 0.3990 - val_loss: 3.3017 - val_accuracy50: 0.3796 - 184s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 182s - loss: 3.2255 - accuracy50: 0.4097 - val_loss: 3.3221 - val_accuracy50: 0.3785 - 182s/epoch - 33ms/step
Epoch 3/50
5429/5429 - 177s - loss: 3.2169 - accuracy50: 0.4148 - val_loss: 3.3131 - val_accuracy50: 0.3846 - 177s/epoch - 33ms/step
Epoch 4/50
5429/5429 - 179s - loss: 3.2103 - accuracy50: 0.4187 - val_loss: 3.3096 - val_accuracy50: 0.3841 - 179s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 177s - loss: 3.2048 - accuracy50: 0.4215 - val_loss: 3.3056 - val_accuracy50: 0.3848 - 177s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 177s - loss: 3.2003 - accuracy50: 0.4240 - val_loss: 3.3029 - val_accuracy50: 0.3851 - 177s/epoch - 33ms/step
Epoch 7/50
5429/5429 - 183s - loss: 3.1967 - accuracy50: 0.4257 - val_loss: 3.2914 - val_accuracy50: 0.3873 - 183s/epoch - 34ms/step
Epoch 8/50
5429/5429 - 177s - loss: 3.1933 - accuracy50: 0.4273 - val_loss: 3.2857 - val_accuracy50: 0.3881 - 177s/epoch - 33ms/step
Epoch 9/50
5429/5429 - 184s - loss: 3.1906 - accuracy50: 0.4282 - val_loss: 3.2833 - val_accuracy50: 0.3897 - 184s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 185s - loss: 3.1884 - accuracy50: 0.4290 - val_loss: 3.2857 - val_accuracy50: 0.3901 - 185s/epoch - 34ms/step
Epoch 11/50
5429/5429 - 178s - loss: 3.1862 - accuracy50: 0.4302 - val_loss: 3.2832 - val_accuracy50: 0.3900 - 178s/epoch - 33ms/step
Epoch 12/50
5429/5429 - 179s - loss: 3.1842 - accuracy50: 0.4307 - val_loss: 3.2795 - val_accuracy50: 0.3909 - 179s/epoch - 33ms/step
Epoch 13/50
5429/5429 - 177s - loss: 3.1822 - accuracy50: 0.4316 - val_loss: 3.2792 - val_accuracy50: 0.3913 - 177s/epoch - 33ms/step
Epoch 14/50
5429/5429 - 177s - loss: 3.1808 - accuracy50: 0.4322 - val_loss: 3.2728 - val_accuracy50: 0.3925 - 177s/epoch - 33ms/step
Epoch 15/50
5429/5429 - 177s - loss: 3.1793 - accuracy50: 0.4327 - val_loss: 3.2718 - val_accuracy50: 0.3912 - 177s/epoch - 33ms/step
Epoch 16/50
5429/5429 - 183s - loss: 3.1779 - accuracy50: 0.4335 - val_loss: 3.2689 - val_accuracy50: 0.3914 - 183s/epoch - 34ms/step
Epoch 17/50
5429/5429 - 177s - loss: 3.1764 - accuracy50: 0.4338 - val_loss: 3.2628 - val_accuracy50: 0.3938 - 177s/epoch - 33ms/step
Epoch 18/50
5429/5429 - 177s - loss: 3.1751 - accuracy50: 0.4346 - val_loss: 3.2610 - val_accuracy50: 0.3933 - 177s/epoch - 33ms/step
Epoch 19/50
5429/5429 - 180s - loss: 3.1738 - accuracy50: 0.4351 - val_loss: 3.2581 - val_accuracy50: 0.3938 - 180s/epoch - 33ms/step
Epoch 20/50
5429/5429 - 182s - loss: 3.1723 - accuracy50: 0.4354 - val_loss: 3.2579 - val_accuracy50: 0.3935 - 182s/epoch - 34ms/step
Epoch 21/50
5429/5429 - 177s - loss: 3.1714 - accuracy50: 0.4360 - val_loss: 3.2587 - val_accuracy50: 0.3928 - 177s/epoch - 33ms/step
Epoch 22/50
5429/5429 - 178s - loss: 3.1698 - accuracy50: 0.4366 - val_loss: 3.2540 - val_accuracy50: 0.3938 - 178s/epoch - 33ms/step
Epoch 23/50
5429/5429 - 179s - loss: 3.1688 - accuracy50: 0.4371 - val_loss: 3.2554 - val_accuracy50: 0.3932 - 179s/epoch - 33ms/step
Epoch 24/50
5429/5429 - 178s - loss: 3.1679 - accuracy50: 0.4373 - val_loss: 3.2532 - val_accuracy50: 0.3936 - 178s/epoch - 33ms/step
Epoch 25/50
5429/5429 - 177s - loss: 3.1666 - accuracy50: 0.4377 - val_loss: 3.2524 - val_accuracy50: 0.3937 - 177s/epoch - 33ms/step
Epoch 26/50
5429/5429 - 178s - loss: 3.1656 - accuracy50: 0.4383 - val_loss: 3.2529 - val_accuracy50: 0.3930 - 178s/epoch - 33ms/step
Epoch 27/50
5429/5429 - 177s - loss: 3.1646 - accuracy50: 0.4385 - val_loss: 3.2534 - val_accuracy50: 0.3932 - 177s/epoch - 33ms/step
Epoch 28/50
5429/5429 - 176s - loss: 3.1635 - accuracy50: 0.4392 - val_loss: 3.2528 - val_accuracy50: 0.3938 - 176s/epoch - 32ms/step
Epoch 29/50
5429/5429 - 174s - loss: 3.1622 - accuracy50: 0.4394 - val_loss: 3.2520 - val_accuracy50: 0.3943 - 174s/epoch - 32ms/step
Epoch 30/50
5429/5429 - 178s - loss: 3.1617 - accuracy50: 0.4397 - val_loss: 3.2497 - val_accuracy50: 0.3949 - 178s/epoch - 33ms/step
Epoch 31/50
5429/5429 - 177s - loss: 3.1604 - accuracy50: 0.4402 - val_loss: 3.2515 - val_accuracy50: 0.3949 - 177s/epoch - 33ms/step
Epoch 32/50
5429/5429 - 179s - loss: 3.1594 - accuracy50: 0.4407 - val_loss: 3.2509 - val_accuracy50: 0.3942 - 179s/epoch - 33ms/step
Epoch 33/50
5429/5429 - 179s - loss: 3.1584 - accuracy50: 0.4411 - val_loss: 3.2492 - val_accuracy50: 0.3947 - 179s/epoch - 33ms/step
Epoch 34/50
5429/5429 - 178s - loss: 3.1571 - accuracy50: 0.4414 - val_loss: 3.2476 - val_accuracy50: 0.3958 - 178s/epoch - 33ms/step
Epoch 35/50
5429/5429 - 177s - loss: 3.1564 - accuracy50: 0.4421 - val_loss: 3.2486 - val_accuracy50: 0.3940 - 177s/epoch - 33ms/step
Epoch 36/50
5429/5429 - 179s - loss: 3.1549 - accuracy50: 0.4426 - val_loss: 3.2492 - val_accuracy50: 0.3944 - 179s/epoch - 33ms/step
Epoch 37/50
5429/5429 - 181s - loss: 3.1536 - accuracy50: 0.4432 - val_loss: 3.2515 - val_accuracy50: 0.3940 - 181s/epoch - 33ms/step
Epoch 38/50
5429/5429 - 179s - loss: 3.1531 - accuracy50: 0.4430 - val_loss: 3.2513 - val_accuracy50: 0.3944 - 179s/epoch - 33ms/step
Epoch 39/50
5429/5429 - 176s - loss: 3.1516 - accuracy50: 0.4442 - val_loss: 3.2482 - val_accuracy50: 0.3950 - 176s/epoch - 32ms/step
Epoch 40/50
5429/5429 - 176s - loss: 3.1503 - accuracy50: 0.4448 - val_loss: 3.2461 - val_accuracy50: 0.3961 - 176s/epoch - 33ms/step
Epoch 41/50
5429/5429 - 176s - loss: 3.1494 - accuracy50: 0.4451 - val_loss: 3.2498 - val_accuracy50: 0.3946 - 176s/epoch - 32ms/step
Epoch 42/50
5429/5429 - 176s - loss: 3.1482 - accuracy50: 0.4451 - val_loss: 3.2536 - val_accuracy50: 0.3939 - 176s/epoch - 33ms/step
Epoch 43/50
5429/5429 - 178s - loss: 3.1471 - accuracy50: 0.4458 - val_loss: 3.2489 - val_accuracy50: 0.3959 - 178s/epoch - 33ms/step
Epoch 44/50
5429/5429 - 177s - loss: 3.1458 - accuracy50: 0.4462 - val_loss: 3.2499 - val_accuracy50: 0.3954 - 177s/epoch - 33ms/step
Epoch 45/50
5429/5429 - 176s - loss: 3.1450 - accuracy50: 0.4464 - val_loss: 3.2537 - val_accuracy50: 0.3937 - 176s/epoch - 32ms/step
Epoch 46/50
5429/5429 - 181s - loss: 3.1434 - accuracy50: 0.4471 - val_loss: 3.2562 - val_accuracy50: 0.3939 - 181s/epoch - 33ms/step
Epoch 47/50
5429/5429 - 177s - loss: 3.1426 - accuracy50: 0.4472 - val_loss: 3.2541 - val_accuracy50: 0.3939 - 177s/epoch - 33ms/step
Epoch 48/50
5429/5429 - 183s - loss: 3.1413 - accuracy50: 0.4480 - val_loss: 3.2593 - val_accuracy50: 0.3931 - 183s/epoch - 34ms/step
Epoch 49/50
5429/5429 - 181s - loss: 3.1402 - accuracy50: 0.4482 - val_loss: 3.2575 - val_accuracy50: 0.3936 - 181s/epoch - 33ms/step
Epoch 50/50
5429/5429 - 180s - loss: 3.1391 - accuracy50: 0.4483 - val_loss: 3.2565 - val_accuracy50: 0.3938 - 180s/epoch - 33ms/step
testing model: results/AAPL/W10/deepVOL_L3/h50
Evaluating performance on  test set...
22048/22048 - 304s - 304s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0651835
{'0': {'precision': 0.42860254231320954, 'recall': 0.582006095894809, 'f1-score': 0.49366150834534106, 'support': 2133567}, '1': {'precision': 0.28405229672096766, 'recall': 0.015412395772478623, 'f1-score': 0.029238347804497158, 'support': 1318030}, '2': {'precision': 0.4433989733675868, 'recall': 0.5410548189690992, 'f1-score': 0.4873832639662108, 'support': 2192471}, 'accuracy': 0.43378463902277575, 'macro avg': {'precision': 0.385351270800588, 'recall': 0.3794911035454623, 'f1-score': 0.33676104003868296, 'support': 5644068}, 'weighted avg': {'precision': 0.40059423089532425, 'recall': 0.43378463902277575, 'f1-score': 0.38276834989654057, 'support': 5644068}}
[[1241749   25615  866203]
 [ 674817   20314  622899]
 [ 980638   25586 1186247]]
Evaluating performance on  train set...
5429/5429 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.071426
{'0': {'precision': 0.399727639270778, 'recall': 0.604966549445842, 'f1-score': 0.4813839939826348, 'support': 457541}, '1': {'precision': 0.44916756497784166, 'recall': 0.08158634433305485, 'f1-score': 0.13809013547201632, 'support': 459648}, '2': {'precision': 0.4214960853118555, 'recall': 0.5474569779965172, 'f1-score': 0.47628926898547463, 'support': 472607}, 'accuracy': 0.41231231058371154, 'macro avg': {'precision': 0.42346376318682505, 'recall': 0.411336623925138, 'f1-score': 0.36525446614670853, 'support': 1389796}, 'weighted avg': {'precision': 0.4234814009376241, 'recall': 0.41231231058371154, 'f1-score': 0.366113739806179, 'support': 1389796}}
[[276797  21765 158979]
 [226016  37501 196131]
 [189651  24224 258732]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.081643
{'0': {'precision': 0.3833615483635972, 'recall': 0.599630972420044, 'f1-score': 0.4677054060400397, 'support': 154460}, '1': {'precision': 0.4263874215399913, 'recall': 0.08184225594045233, 'f1-score': 0.13732574082043172, 'support': 167664}, '2': {'precision': 0.4063738755907913, 'recall': 0.5279894517249277, 'f1-score': 0.4592669971004036, 'support': 161543}, 'accuracy': 0.3962106159816568, 'macro avg': {'precision': 0.4053742818314599, 'recall': 0.4031542266951414, 'f1-score': 0.3547660479869583, 'support': 483667}, 'weighted avg': {'precision': 0.4059625742295536, 'recall': 0.3962106159816568, 'f1-score': 0.35036032753620133, 'support': 483667}}
[[92619  8615 53226]
 [82573 13722 71369]
 [66405  9845 85293]]
training model: results/AAPL/W10/deepVOL_L3/h100
Epoch 1/50
5429/5429 - 184s - loss: 3.2668 - accuracy100: 0.3873 - val_loss: 3.3340 - val_accuracy100: 0.3561 - 184s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 181s - loss: 3.2503 - accuracy100: 0.3975 - val_loss: 3.3104 - val_accuracy100: 0.3585 - 181s/epoch - 33ms/step
Epoch 3/50
5429/5429 - 177s - loss: 3.2470 - accuracy100: 0.3992 - val_loss: 3.2929 - val_accuracy100: 0.3568 - 177s/epoch - 33ms/step
Epoch 4/50
5429/5429 - 177s - loss: 3.2431 - accuracy100: 0.4016 - val_loss: 3.2936 - val_accuracy100: 0.3604 - 177s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 178s - loss: 3.2376 - accuracy100: 0.4051 - val_loss: 3.2876 - val_accuracy100: 0.3641 - 178s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 176s - loss: 3.2332 - accuracy100: 0.4077 - val_loss: 3.2959 - val_accuracy100: 0.3623 - 176s/epoch - 32ms/step
Epoch 7/50
5429/5429 - 177s - loss: 3.2298 - accuracy100: 0.4098 - val_loss: 3.3024 - val_accuracy100: 0.3645 - 177s/epoch - 33ms/step
Epoch 8/50
5429/5429 - 180s - loss: 3.2267 - accuracy100: 0.4117 - val_loss: 3.2912 - val_accuracy100: 0.3651 - 180s/epoch - 33ms/step
Epoch 9/50
5429/5429 - 179s - loss: 3.2245 - accuracy100: 0.4127 - val_loss: 3.2959 - val_accuracy100: 0.3664 - 179s/epoch - 33ms/step
Epoch 10/50
5429/5429 - 176s - loss: 3.2223 - accuracy100: 0.4140 - val_loss: 3.2946 - val_accuracy100: 0.3662 - 176s/epoch - 32ms/step
Epoch 11/50
5429/5429 - 177s - loss: 3.2210 - accuracy100: 0.4142 - val_loss: 3.2889 - val_accuracy100: 0.3661 - 177s/epoch - 33ms/step
Epoch 12/50
5429/5429 - 176s - loss: 3.2193 - accuracy100: 0.4159 - val_loss: 3.2854 - val_accuracy100: 0.3680 - 176s/epoch - 32ms/step
Epoch 13/50
5429/5429 - 183s - loss: 3.2180 - accuracy100: 0.4161 - val_loss: 3.2867 - val_accuracy100: 0.3677 - 183s/epoch - 34ms/step
Epoch 14/50
5429/5429 - 181s - loss: 3.2165 - accuracy100: 0.4173 - val_loss: 3.2846 - val_accuracy100: 0.3673 - 181s/epoch - 33ms/step
Epoch 15/50
5429/5429 - 180s - loss: 3.2153 - accuracy100: 0.4174 - val_loss: 3.2870 - val_accuracy100: 0.3670 - 180s/epoch - 33ms/step
Epoch 16/50
5429/5429 - 177s - loss: 3.2140 - accuracy100: 0.4181 - val_loss: 3.2843 - val_accuracy100: 0.3671 - 177s/epoch - 33ms/step
Epoch 17/50
5429/5429 - 176s - loss: 3.2126 - accuracy100: 0.4188 - val_loss: 3.2863 - val_accuracy100: 0.3679 - 176s/epoch - 32ms/step
Epoch 18/50
5429/5429 - 179s - loss: 3.2116 - accuracy100: 0.4193 - val_loss: 3.2865 - val_accuracy100: 0.3677 - 179s/epoch - 33ms/step
Epoch 19/50
5429/5429 - 179s - loss: 3.2106 - accuracy100: 0.4199 - val_loss: 3.2891 - val_accuracy100: 0.3665 - 179s/epoch - 33ms/step
Epoch 20/50
5429/5429 - 182s - loss: 3.2092 - accuracy100: 0.4205 - val_loss: 3.2881 - val_accuracy100: 0.3676 - 182s/epoch - 33ms/step
Epoch 21/50
5429/5429 - 175s - loss: 3.2078 - accuracy100: 0.4212 - val_loss: 3.2892 - val_accuracy100: 0.3682 - 175s/epoch - 32ms/step
Epoch 22/50
5429/5429 - 175s - loss: 3.2069 - accuracy100: 0.4215 - val_loss: 3.2878 - val_accuracy100: 0.3675 - 175s/epoch - 32ms/step
Epoch 23/50
5429/5429 - 178s - loss: 3.2059 - accuracy100: 0.4216 - val_loss: 3.2916 - val_accuracy100: 0.3673 - 178s/epoch - 33ms/step
Epoch 24/50
5429/5429 - 177s - loss: 3.2046 - accuracy100: 0.4223 - val_loss: 3.2885 - val_accuracy100: 0.3684 - 177s/epoch - 33ms/step
Epoch 25/50
5429/5429 - 177s - loss: 3.2034 - accuracy100: 0.4229 - val_loss: 3.2925 - val_accuracy100: 0.3680 - 177s/epoch - 33ms/step
Epoch 26/50
5429/5429 - 178s - loss: 3.2024 - accuracy100: 0.4237 - val_loss: 3.2954 - val_accuracy100: 0.3677 - 178s/epoch - 33ms/step
testing model: results/AAPL/W10/deepVOL_L3/h100
Evaluating performance on  test set...
22048/22048 - 299s - 299s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0796225
{'0': {'precision': 0.4144817363563301, 'recall': 0.48234628101139365, 'f1-score': 0.4458462942882094, 'support': 2102050}, '1': {'precision': 0.29591992665036676, 'recall': 0.0027685326562473193, 'f1-score': 0.0054857424519696545, 'support': 1398936}, '2': {'precision': 0.41413905124226236, 'recall': 0.6154365535243168, 'f1-score': 0.49510945907494147, 'support': 2143082}, 'accuracy': 0.41401343853405026, 'macro avg': {'precision': 0.37484690474965304, 'recall': 0.3668504557306526, 'f1-score': 0.3154804986050402, 'support': 5644068}, 'weighted avg': {'precision': 0.3849649434823874, 'recall': 0.41401343853405026, 'f1-score': 0.3554042182490649, 'support': 5644068}}
[[1013916    4825 1083309]
 [ 612549    3873  782514]
 [ 819761    4390 1318931]]
Evaluating performance on  train set...
5429/5429 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0868728
{'0': {'precision': 0.37754100580621835, 'recall': 0.5887950986176761, 'f1-score': 0.46007655665192243, 'support': 459299}, '1': {'precision': 0.42185376460994833, 'recall': 0.006769222717022938, 'f1-score': 0.013324633400872282, 'support': 458546}, '2': {'precision': 0.39602514197529937, 'recall': 0.5589711643793529, 'f1-score': 0.4635968396116996, 'support': 471951}, 'accuracy': 0.3866351608437497, 'macro avg': {'precision': 0.3984733041304887, 'recall': 0.384845161904684, 'f1-score': 0.31233267655483143, 'support': 1389796}, 'weighted avg': {'precision': 0.3984383496232599, 'recall': 0.3866351608437497, 'f1-score': 0.313871713397282, 'support': 1389796}}
[[270433   1960 186906]
 [240018   3104 215424]
 [205850   2294 263807]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0937176
{'0': {'precision': 0.35448893800943376, 'recall': 0.5963029852331881, 'f1-score': 0.44464578800008914, 'support': 150608}, '1': {'precision': 0.40193885160328113, 'recall': 0.006157431471443341, 'f1-score': 0.01212905403504824, 'support': 175073}, '2': {'precision': 0.3804252328237568, 'recall': 0.5481498360614232, 'f1-score': 0.4491398401560061, 'support': 157986}, 'accuracy': 0.3669590854865021, 'macro avg': {'precision': 0.3789510074788239, 'recall': 0.3835367509220182, 'f1-score': 0.30197156073038117, 'support': 483667}, 'weighted avg': {'precision': 0.3801362742865651, 'recall': 0.3669590854865021, 'f1-score': 0.2895556023112641, 'support': 483667}}
[[89808   761 60039]
 [92994  1078 81001]
 [70543   843 86600]]
training model: results/AAPL/W10/deepVOL_L3/h200
Epoch 1/50
5429/5429 - 188s - loss: 3.2758 - accuracy200: 0.3771 - val_loss: 3.3148 - val_accuracy200: 0.3355 - 188s/epoch - 35ms/step
Epoch 2/50
5429/5429 - 185s - loss: 3.2667 - accuracy200: 0.3837 - val_loss: 3.3118 - val_accuracy200: 0.3385 - 185s/epoch - 34ms/step
Epoch 3/50
5429/5429 - 183s - loss: 3.2646 - accuracy200: 0.3855 - val_loss: 3.3099 - val_accuracy200: 0.3419 - 183s/epoch - 34ms/step
Epoch 4/50
5429/5429 - 187s - loss: 3.2621 - accuracy200: 0.3877 - val_loss: 3.2961 - val_accuracy200: 0.3426 - 187s/epoch - 34ms/step
Epoch 5/50
5429/5429 - 187s - loss: 3.2618 - accuracy200: 0.3877 - val_loss: 3.2964 - val_accuracy200: 0.3437 - 187s/epoch - 34ms/step
Epoch 6/50
5429/5429 - 184s - loss: 3.2573 - accuracy200: 0.3912 - val_loss: 3.2953 - val_accuracy200: 0.3452 - 184s/epoch - 34ms/step
Epoch 7/50
5429/5429 - 184s - loss: 3.2518 - accuracy200: 0.3948 - val_loss: 3.3008 - val_accuracy200: 0.3493 - 184s/epoch - 34ms/step
Epoch 8/50
5429/5429 - 184s - loss: 3.2484 - accuracy200: 0.3974 - val_loss: 3.3050 - val_accuracy200: 0.3486 - 184s/epoch - 34ms/step
Epoch 9/50
5429/5429 - 185s - loss: 3.2454 - accuracy200: 0.3992 - val_loss: 3.3049 - val_accuracy200: 0.3485 - 185s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 176s - loss: 3.2425 - accuracy200: 0.4012 - val_loss: 3.3066 - val_accuracy200: 0.3489 - 176s/epoch - 33ms/step
Epoch 11/50
5429/5429 - 176s - loss: 3.2404 - accuracy200: 0.4023 - val_loss: 3.3067 - val_accuracy200: 0.3491 - 176s/epoch - 32ms/step
Epoch 12/50
5429/5429 - 176s - loss: 3.2384 - accuracy200: 0.4033 - val_loss: 3.3071 - val_accuracy200: 0.3490 - 176s/epoch - 32ms/step
Epoch 13/50
5429/5429 - 178s - loss: 3.2363 - accuracy200: 0.4050 - val_loss: 3.3093 - val_accuracy200: 0.3496 - 178s/epoch - 33ms/step
Epoch 14/50
5429/5429 - 182s - loss: 3.2347 - accuracy200: 0.4059 - val_loss: 3.3046 - val_accuracy200: 0.3497 - 182s/epoch - 33ms/step
Epoch 15/50
5429/5429 - 182s - loss: 3.2334 - accuracy200: 0.4068 - val_loss: 3.3014 - val_accuracy200: 0.3499 - 182s/epoch - 34ms/step
Epoch 16/50
5429/5429 - 176s - loss: 3.2317 - accuracy200: 0.4073 - val_loss: 3.3012 - val_accuracy200: 0.3502 - 176s/epoch - 32ms/step
testing model: results/AAPL/W10/deepVOL_L3/h200
Evaluating performance on  test set...
22048/22048 - 298s - 298s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927263
{'0': {'precision': 0.3900056540096759, 'recall': 0.6414738861627796, 'f1-score': 0.4850865824468322, 'support': 2115143}, '1': {'precision': 0.256000737134696, 'recall': 0.011795072815293546, 'f1-score': 0.022551117105502564, 'support': 1413302}, '2': {'precision': 0.4017292348014575, 'recall': 0.3987633902637663, 'f1-score': 0.4002408182697378, 'support': 2115623}, 'accuracy': 0.39282163148991117, 'macro avg': {'precision': 0.34924520864860975, 'recall': 0.3506774497472798, 'f1-score': 0.3026261726073575, 'support': 5644068}, 'weighted avg': {'precision': 0.3608446410906623, 'recall': 0.39282163148991117, 'f1-score': 0.33746186417918045, 'support': 5644068}}
[[1356809   23704  734630]
 [ 874891   16670  521741]
 [1247247   24743  843633]]
Evaluating performance on  train set...
5429/5429 - 89s - 89s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945288
{'0': {'precision': 0.3522117845689344, 'recall': 0.677831355013726, 'f1-score': 0.46355377170492684, 'support': 462261}, '1': {'precision': 0.3386928785314412, 'recall': 0.011387487552116961, 'f1-score': 0.022034145938632173, 'support': 456905}, '2': {'precision': 0.38494223545985773, 'recall': 0.39654293181480144, 'f1-score': 0.3906564808157054, 'support': 470630}, 'accuracy': 0.36347996396593457, 'macro avg': {'precision': 0.35861563285341114, 'recall': 0.3619205914602148, 'f1-score': 0.29208146615308817, 'support': 1389796}, 'weighted avg': {'precision': 0.35885094336614953, 'recall': 0.36347996396593457, 'f1-score': 0.29371576913336733, 'support': 1389796}}
[[313335   4618 144308]
 [297822   5203 153880]
 [278464   5541 186625]]
Evaluating performance on  val set...
1890/1890 - 31s - 31s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0978308
{'0': {'precision': 0.3305483523921951, 'recall': 0.6633809564435578, 'f1-score': 0.4412375814083425, 'support': 152377}, '1': {'precision': 0.3705482192877151, 'recall': 0.010761873216765744, 'f1-score': 0.02091627279246924, 'support': 172089}, '2': {'precision': 0.37010447640314237, 'recall': 0.401863053624035, 'f1-score': 0.3853304945145951, 'support': 159201}, 'accuracy': 0.3450990040668476, 'macro avg': {'precision': 0.35706701602768415, 'recall': 0.3586686277614528, 'f1-score': 0.28249478290513563, 'support': 483667}, 'weighted avg': {'precision': 0.3578003906599495, 'recall': 0.3450990040668476, 'f1-score': 0.273284965623167, 'support': 483667}}
[[101084   1406  49887]
 [111239   1852  58998]
 [ 93484   1740  63977]]
training model: results/AAPL/W10/deepVOL_L3/h300
Epoch 1/50
5429/5429 - 187s - loss: 3.2778 - accuracy300: 0.3701 - val_loss: 3.3247 - val_accuracy300: 0.3185 - 187s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 196s - loss: 3.2762 - accuracy300: 0.3676 - val_loss: 3.3144 - val_accuracy300: 0.3193 - 196s/epoch - 36ms/step
Epoch 3/50
5429/5429 - 181s - loss: 3.2737 - accuracy300: 0.3714 - val_loss: 3.3092 - val_accuracy300: 0.3237 - 181s/epoch - 33ms/step
Epoch 4/50
5429/5429 - 178s - loss: 3.2719 - accuracy300: 0.3753 - val_loss: 3.3141 - val_accuracy300: 0.3273 - 178s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 194s - loss: 3.2710 - accuracy300: 0.3768 - val_loss: 3.3097 - val_accuracy300: 0.3264 - 194s/epoch - 36ms/step
Epoch 6/50
5429/5429 - 184s - loss: 3.2708 - accuracy300: 0.3772 - val_loss: 3.3079 - val_accuracy300: 0.3299 - 184s/epoch - 34ms/step
Epoch 7/50
5429/5429 - 191s - loss: 3.2683 - accuracy300: 0.3799 - val_loss: 3.3080 - val_accuracy300: 0.3285 - 191s/epoch - 35ms/step
Epoch 8/50
5429/5429 - 185s - loss: 3.2670 - accuracy300: 0.3819 - val_loss: 3.3044 - val_accuracy300: 0.3325 - 185s/epoch - 34ms/step
Epoch 9/50
5429/5429 - 183s - loss: 3.2623 - accuracy300: 0.3865 - val_loss: 3.3078 - val_accuracy300: 0.3330 - 183s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 182s - loss: 3.2597 - accuracy300: 0.3888 - val_loss: 3.3105 - val_accuracy300: 0.3320 - 182s/epoch - 33ms/step
Epoch 11/50
5429/5429 - 186s - loss: 3.2562 - accuracy300: 0.3914 - val_loss: 3.3119 - val_accuracy300: 0.3300 - 186s/epoch - 34ms/step
Epoch 12/50
5429/5429 - 196s - loss: 3.2535 - accuracy300: 0.3928 - val_loss: 3.3129 - val_accuracy300: 0.3341 - 196s/epoch - 36ms/step
Epoch 13/50
5429/5429 - 196s - loss: 3.2513 - accuracy300: 0.3948 - val_loss: 3.3134 - val_accuracy300: 0.3352 - 196s/epoch - 36ms/step
Epoch 14/50
5429/5429 - 200s - loss: 3.2488 - accuracy300: 0.3964 - val_loss: 3.3157 - val_accuracy300: 0.3366 - 200s/epoch - 37ms/step
Epoch 15/50
5429/5429 - 204s - loss: 3.2468 - accuracy300: 0.3978 - val_loss: 3.3173 - val_accuracy300: 0.3370 - 204s/epoch - 37ms/step
Epoch 16/50
5429/5429 - 200s - loss: 3.2455 - accuracy300: 0.3985 - val_loss: 3.3196 - val_accuracy300: 0.3377 - 200s/epoch - 37ms/step
Epoch 17/50
5429/5429 - 204s - loss: 3.2440 - accuracy300: 0.3996 - val_loss: 3.3220 - val_accuracy300: 0.3378 - 204s/epoch - 38ms/step
Epoch 18/50
5429/5429 - 201s - loss: 3.2429 - accuracy300: 0.3998 - val_loss: 3.3205 - val_accuracy300: 0.3385 - 201s/epoch - 37ms/step
testing model: results/AAPL/W10/deepVOL_L3/h300
Evaluating performance on  test set...
22048/22048 - 291s - 291s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0931164
{'0': {'precision': 0.3809378678081998, 'recall': 0.778275842831031, 'f1-score': 0.5115100648200513, 'support': 2115074}, '1': {'precision': 0.2555448723171944, 'recall': 0.01096535852967276, 'f1-score': 0.021028394568368768, 'support': 1430049}, '2': {'precision': 0.39689131739303796, 'recall': 0.23853793215162855, 'f1-score': 0.2979832426905492, 'support': 2098945}, 'accuracy': 0.3831403165234721, 'macro avg': {'precision': 0.34445801917281077, 'recall': 0.34259304450411077, 'f1-score': 0.27684056735965645, 'support': 5644068}, 'weighted avg': {'precision': 0.35509964003169736, 'recall': 0.3831403165234721, 'f1-score': 0.30782827400244317, 'support': 5644068}}
[[1646111   21968  446995]
 [1100542   15681  313826]
 [1574553   23714  500678]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980521
{'0': {'precision': 0.3390054844030445, 'recall': 0.8340207918487678, 'f1-score': 0.4820652840724725, 'support': 464028}, '1': {'precision': 0.3499539736115373, 'recall': 0.009990801979764355, 'f1-score': 0.01942698485700172, 'support': 456620}, '2': {'precision': 0.39041669678813057, 'recall': 0.19569517508334258, 'f1-score': 0.26071017326251195, 'support': 469148}, 'accuracy': 0.3478071601875383, 'macro avg': {'precision': 0.3597920516009041, 'recall': 0.34656892297062486, 'f1-score': 0.25406748073066204, 'support': 1389796}, 'weighted avg': {'precision': 0.359957312304708, 'recall': 0.3478071601875383, 'f1-score': 0.2553426516040817, 'support': 1389796}}
[[387009   3897  73122]
 [381831   4562  70227]
 [372761   4577  91810]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008923
{'0': {'precision': 0.3223394080063255, 'recall': 0.8216447458244209, 'f1-score': 0.4630282335182349, 'support': 153811}, '1': {'precision': 0.37778227438284095, 'recall': 0.011061343950327634, 'f1-score': 0.021493368944557004, 'support': 168786}, '2': {'precision': 0.37928686822063234, 'recall': 0.20406655491401254, 'f1-score': 0.26536148225891093, 'support': 161070}, 'accuracy': 0.3331093500280151, 'macro avg': {'precision': 0.35980285020326624, 'recall': 0.34559088156292034, 'f1-score': 0.24996102824056762, 'support': 483667}, 'weighted avg': {'precision': 0.3606519392746257, 'recall': 0.3331093500280151, 'f1-score': 0.24311848719013707, 'support': 483667}}
[[126378   1407  26026]
 [139154   1867  27765]
 [126533   1668  32869]]
training model: results/AAPL/W10/deepVOL_L3/h500
Epoch 1/50
5429/5429 - 187s - loss: 3.2778 - accuracy500: 0.3732 - val_loss: 3.3524 - val_accuracy500: 0.3140 - 187s/epoch - 34ms/step
Epoch 2/50
5429/5429 - 184s - loss: 3.2756 - accuracy500: 0.3718 - val_loss: 3.3550 - val_accuracy500: 0.3158 - 184s/epoch - 34ms/step
Epoch 3/50
5429/5429 - 182s - loss: 3.2738 - accuracy500: 0.3722 - val_loss: 3.3421 - val_accuracy500: 0.3178 - 182s/epoch - 34ms/step
Epoch 4/50
5429/5429 - 180s - loss: 3.2751 - accuracy500: 0.3726 - val_loss: 3.3689 - val_accuracy500: 0.3226 - 180s/epoch - 33ms/step
Epoch 5/50
5429/5429 - 179s - loss: 3.2729 - accuracy500: 0.3744 - val_loss: 3.3713 - val_accuracy500: 0.3231 - 179s/epoch - 33ms/step
Epoch 6/50
5429/5429 - 178s - loss: 3.2706 - accuracy500: 0.3777 - val_loss: 3.3575 - val_accuracy500: 0.3278 - 178s/epoch - 33ms/step
Epoch 7/50
5429/5429 - 182s - loss: 3.2664 - accuracy500: 0.3813 - val_loss: 3.3509 - val_accuracy500: 0.3274 - 182s/epoch - 34ms/step
Epoch 8/50
5429/5429 - 178s - loss: 3.2617 - accuracy500: 0.3853 - val_loss: 3.3295 - val_accuracy500: 0.3280 - 178s/epoch - 33ms/step
Epoch 9/50
5429/5429 - 182s - loss: 3.2533 - accuracy500: 0.3924 - val_loss: 3.3270 - val_accuracy500: 0.3294 - 182s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 189s - loss: 3.2484 - accuracy500: 0.3965 - val_loss: 3.3265 - val_accuracy500: 0.3327 - 189s/epoch - 35ms/step
Epoch 11/50
5429/5429 - 179s - loss: 3.2434 - accuracy500: 0.3997 - val_loss: 3.3282 - val_accuracy500: 0.3337 - 179s/epoch - 33ms/step
Epoch 12/50
5429/5429 - 177s - loss: 3.2396 - accuracy500: 0.4023 - val_loss: 3.3344 - val_accuracy500: 0.3338 - 177s/epoch - 33ms/step
Epoch 13/50
5429/5429 - 190s - loss: 3.2367 - accuracy500: 0.4035 - val_loss: 3.3362 - val_accuracy500: 0.3340 - 190s/epoch - 35ms/step
Epoch 14/50
5429/5429 - 178s - loss: 3.2342 - accuracy500: 0.4049 - val_loss: 3.3401 - val_accuracy500: 0.3346 - 178s/epoch - 33ms/step
Epoch 15/50
5429/5429 - 188s - loss: 3.2320 - accuracy500: 0.4067 - val_loss: 3.3446 - val_accuracy500: 0.3331 - 188s/epoch - 35ms/step
Epoch 16/50
5429/5429 - 197s - loss: 3.2301 - accuracy500: 0.4074 - val_loss: 3.3458 - val_accuracy500: 0.3330 - 197s/epoch - 36ms/step
Epoch 17/50
5429/5429 - 181s - loss: 3.2286 - accuracy500: 0.4083 - val_loss: 3.3494 - val_accuracy500: 0.3332 - 181s/epoch - 33ms/step
Epoch 18/50
5429/5429 - 196s - loss: 3.2266 - accuracy500: 0.4094 - val_loss: 3.3512 - val_accuracy500: 0.3328 - 196s/epoch - 36ms/step
Epoch 19/50
5429/5429 - 183s - loss: 3.2251 - accuracy500: 0.4101 - val_loss: 3.3534 - val_accuracy500: 0.3320 - 183s/epoch - 34ms/step
Epoch 20/50
5429/5429 - 196s - loss: 3.2232 - accuracy500: 0.4113 - val_loss: 3.3520 - val_accuracy500: 0.3326 - 196s/epoch - 36ms/step
testing model: results/AAPL/W10/deepVOL_L3/h500
Evaluating performance on  test set...
22048/22048 - 304s - 304s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0875218
{'0': {'precision': 0.3857387054040082, 'recall': 0.42167199564380115, 'f1-score': 0.4029057566209619, 'support': 2135807}, '1': {'precision': 0.26949941792782306, 'recall': 0.0009839082478995437, 'f1-score': 0.0019606583803324367, 'support': 1411717}, '2': {'precision': 0.3792400882890501, 'recall': 0.597681231588748, 'f1-score': 0.46403876837241753, 'support': 2096544}, 'accuracy': 0.38182814239658347, 'macro avg': {'precision': 0.34482607054029374, 'recall': 0.3401123784934829, 'f1-score': 0.2896350611245706, 'support': 5644068}, 'weighted avg': {'precision': 0.3542504924840575, 'recall': 0.38182814239658347, 'f1-score': 0.3253282075440332, 'support': 5644068}}
[[ 900610    1931 1233266]
 [ 592512    1389  817816]
 [ 841645    1834 1253065]]
Evaluating performance on  train set...
5429/5429 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1009716
{'0': {'precision': 0.34151839041060317, 'recall': 0.49459742894351155, 'f1-score': 0.404044784045574, 'support': 465334}, '1': {'precision': 0.3557910673732021, 'recall': 0.0010295683260971474, 'f1-score': 0.0020531952304711646, 'support': 456502}, '2': {'precision': 0.3569939151706495, 'recall': 0.5451213778955466, 'f1-score': 0.431441560594119, 'support': 467960}, 'accuracy': 0.3494887019389896, 'macro avg': {'precision': 0.35143445765148495, 'recall': 0.3469161250550517, 'f1-score': 0.2791798466233881, 'support': 1389796}, 'weighted avg': {'precision': 0.351417276394943, 'recall': 0.3494887019389896, 'f1-score': 0.28122865223657834, 'support': 1389796}}
[[230153    420 234761]
 [231324    470 224708]
 [212434    431 255095]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071476
{'0': {'precision': 0.3172447439308142, 'recall': 0.5017608884902525, 'f1-score': 0.38871772862668164, 'support': 151628}, '1': {'precision': 0.389948006932409, 'recall': 0.0013013603553581343, 'f1-score': 0.0025940636294985386, 'support': 172896}, '2': {'precision': 0.3471792890262751, 'recall': 0.5307113727905092, 'f1-score': 0.4197606948051141, 'support': 159143}, 'accuracy': 0.3323877791951901, 'macro avg': {'precision': 0.35145734662983275, 'recall': 0.3445912072120399, 'f1-score': 0.27035749568709805, 'support': 483667}, 'weighted avg': {'precision': 0.35308340290496515, 'recall': 0.3323877791951901, 'f1-score': 0.2609046538938206, 'support': 483667}}
[[76081   162 75385]
 [89243   225 83428]
 [74494   190 84459]]
training model: results/AAPL/W10/deepVOL_L3/h1000
Epoch 1/50
5429/5429 - 189s - loss: 3.2714 - accuracy1000: 0.3820 - val_loss: 3.4466 - val_accuracy1000: 0.3293 - 189s/epoch - 35ms/step
Epoch 2/50
5429/5429 - 185s - loss: 3.2661 - accuracy1000: 0.3834 - val_loss: 3.4376 - val_accuracy1000: 0.3289 - 185s/epoch - 34ms/step
Epoch 3/50
5429/5429 - 189s - loss: 3.2648 - accuracy1000: 0.3837 - val_loss: 3.4146 - val_accuracy1000: 0.3263 - 189s/epoch - 35ms/step
Epoch 4/50
5429/5429 - 183s - loss: 3.2613 - accuracy1000: 0.3870 - val_loss: 3.4093 - val_accuracy1000: 0.3232 - 183s/epoch - 34ms/step
Epoch 5/50
5429/5429 - 184s - loss: 3.2607 - accuracy1000: 0.3882 - val_loss: 3.3639 - val_accuracy1000: 0.3310 - 184s/epoch - 34ms/step
Epoch 6/50
5429/5429 - 184s - loss: 3.2566 - accuracy1000: 0.3923 - val_loss: 3.3598 - val_accuracy1000: 0.3303 - 184s/epoch - 34ms/step
Epoch 7/50
5429/5429 - 184s - loss: 3.2517 - accuracy1000: 0.3956 - val_loss: 3.3655 - val_accuracy1000: 0.3304 - 184s/epoch - 34ms/step
Epoch 8/50
5429/5429 - 184s - loss: 3.2463 - accuracy1000: 0.3980 - val_loss: 3.3564 - val_accuracy1000: 0.3283 - 184s/epoch - 34ms/step
Epoch 9/50
5429/5429 - 185s - loss: 3.2407 - accuracy1000: 0.4016 - val_loss: 3.3700 - val_accuracy1000: 0.3309 - 185s/epoch - 34ms/step
Epoch 10/50
5429/5429 - 185s - loss: 3.2340 - accuracy1000: 0.4049 - val_loss: 3.3721 - val_accuracy1000: 0.3317 - 185s/epoch - 34ms/step
Epoch 11/50
5429/5429 - 184s - loss: 3.2270 - accuracy1000: 0.4089 - val_loss: 3.3789 - val_accuracy1000: 0.3342 - 184s/epoch - 34ms/step
Epoch 12/50
5429/5429 - 185s - loss: 3.2217 - accuracy1000: 0.4113 - val_loss: 3.3924 - val_accuracy1000: 0.3347 - 185s/epoch - 34ms/step
Epoch 13/50
5429/5429 - 186s - loss: 3.2169 - accuracy1000: 0.4140 - val_loss: 3.3982 - val_accuracy1000: 0.3363 - 186s/epoch - 34ms/step
Epoch 14/50
5429/5429 - 185s - loss: 3.2137 - accuracy1000: 0.4153 - val_loss: 3.4089 - val_accuracy1000: 0.3369 - 185s/epoch - 34ms/step
Epoch 15/50
5429/5429 - 184s - loss: 3.2106 - accuracy1000: 0.4170 - val_loss: 3.4035 - val_accuracy1000: 0.3369 - 184s/epoch - 34ms/step
Epoch 16/50
5429/5429 - 186s - loss: 3.2078 - accuracy1000: 0.4184 - val_loss: 3.4028 - val_accuracy1000: 0.3373 - 186s/epoch - 34ms/step
Epoch 17/50
5429/5429 - 184s - loss: 3.2050 - accuracy1000: 0.4201 - val_loss: 3.3996 - val_accuracy1000: 0.3374 - 184s/epoch - 34ms/step
Epoch 18/50
5429/5429 - 183s - loss: 3.2030 - accuracy1000: 0.4211 - val_loss: 3.4013 - val_accuracy1000: 0.3373 - 183s/epoch - 34ms/step
testing model: results/AAPL/W10/deepVOL_L3/h1000
Evaluating performance on  test set...
22048/22048 - 296s - 296s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0849489
{'0': {'precision': 0.38557533669285665, 'recall': 0.5934398062420546, 'f1-score': 0.467440682097675, 'support': 2156918}, '1': {'precision': 0.27956989247311825, 'recall': 1.9052643920741e-05, 'f1-score': 3.810269114911122e-05, 'support': 1364640}, '2': {'precision': 0.3810515011672542, 'recall': 0.4172710611492996, 'f1-score': 0.39833964803200883, 'support': 2122510}, 'accuracy': 0.38371064983625286, 'macro avg': {'precision': 0.34873224344440973, 'recall': 0.3369099733450917, 'f1-score': 0.288606144273611, 'support': 5644068}, 'weighted avg': {'precision': 0.3582437815908504, 'recall': 0.38371064983625286, 'f1-score': 0.32844450207715814, 'support': 5644068}}
[[1280001      32  876885]
 [ 802903      26  561711]
 [1236813      35  885662]]
Evaluating performance on  train set...
5429/5429 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091152
{'0': {'precision': 0.3327040636819421, 'recall': 0.6541564522614369, 'f1-score': 0.4410765380416325, 'support': 462582}, '1': {'precision': 0.3684210526315789, 'recall': 1.5293693536229667e-05, 'f1-score': 3.0586117398257465e-05, 'support': 457705}, '2': {'precision': 0.36004889048988353, 'recall': 0.3682911296695058, 'f1-score': 0.36412337354674734, 'support': 469509}, 'accuracy': 0.3421538125019787, 'macro avg': {'precision': 0.3537246689344682, 'recall': 0.34082095854149297, 'f1-score': 0.268410165901926, 'support': 1389796}, 'weighted avg': {'precision': 0.35370461823596533, 'recall': 0.3421538125019787, 'f1-score': 0.26982900190373116, 'support': 1389796}}
[[302601      8 159973]
 [310330      7 147368]
 [296589      4 172916]]
Evaluating performance on  val set...
1890/1890 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1175381
{'0': {'precision': 0.3121664969527951, 'recall': 0.6760327404209104, 'f1-score': 0.4271097657663689, 'support': 151006}, '1': {'precision': 0.125, 'recall': 5.8668575350984755e-06, 'f1-score': 1.1733164375766324e-05, 'support': 170449}, '2': {'precision': 0.35950407946986046, 'recall': 0.3471506423692452, 'f1-score': 0.3532193821546181, 'support': 162212}, 'accuracy': 0.32749391626883784, 'macro avg': {'precision': 0.26555685880755187, 'recall': 0.34106308321589696, 'f1-score': 0.26011362702845425, 'support': 483667}, 'weighted avg': {'precision': 0.2620832406962203, 'recall': 0.32749391626883784, 'f1-score': 0.2518149049108496, 'support': 483667}}
[[102085      1  48920]
 [119042      1  51406]
 [105894      6  56312]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :       241 (peak)  31.99 (ave)

============================================
