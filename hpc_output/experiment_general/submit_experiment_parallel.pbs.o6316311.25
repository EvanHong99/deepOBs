This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-04-17.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-09.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-27.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-28.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-05.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-01.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-03.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-02.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-15.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-04.csv
data/EXC_orderbooks/EXC_orderbooks_2019-03-26.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-04-10.csv
training model: results/EXC/W2/deepLOB_L1/h10
Epoch 1/50
1403/1403 - 70s - loss: 2.5353 - accuracy10: 0.4895 - val_loss: 2.9211 - val_accuracy10: 0.6394 - 70s/epoch - 50ms/step
Epoch 2/50
1403/1403 - 48s - loss: 2.2236 - accuracy10: 0.6066 - val_loss: 2.7030 - val_accuracy10: 0.6913 - 48s/epoch - 34ms/step
Epoch 3/50
1403/1403 - 45s - loss: 2.0762 - accuracy10: 0.6482 - val_loss: 2.6191 - val_accuracy10: 0.6852 - 45s/epoch - 32ms/step
Epoch 4/50
1403/1403 - 51s - loss: 2.0108 - accuracy10: 0.6582 - val_loss: 2.5038 - val_accuracy10: 0.6907 - 51s/epoch - 37ms/step
Epoch 5/50
1403/1403 - 50s - loss: 1.9752 - accuracy10: 0.6669 - val_loss: 2.4671 - val_accuracy10: 0.6972 - 50s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 52s - loss: 1.9504 - accuracy10: 0.6691 - val_loss: 2.4791 - val_accuracy10: 0.7106 - 52s/epoch - 37ms/step
Epoch 7/50
1403/1403 - 49s - loss: 1.9320 - accuracy10: 0.6707 - val_loss: 2.5484 - val_accuracy10: 0.7275 - 49s/epoch - 35ms/step
Epoch 8/50
1403/1403 - 54s - loss: 1.9179 - accuracy10: 0.6727 - val_loss: 2.5061 - val_accuracy10: 0.7242 - 54s/epoch - 38ms/step
Epoch 9/50
1403/1403 - 52s - loss: 1.9014 - accuracy10: 0.6754 - val_loss: 2.5048 - val_accuracy10: 0.7268 - 52s/epoch - 37ms/step
Epoch 10/50
1403/1403 - 48s - loss: 1.8932 - accuracy10: 0.6763 - val_loss: 2.4483 - val_accuracy10: 0.7225 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 48s - loss: 1.8818 - accuracy10: 0.6765 - val_loss: 2.3874 - val_accuracy10: 0.7163 - 48s/epoch - 35ms/step
Epoch 12/50
1403/1403 - 51s - loss: 1.8708 - accuracy10: 0.6788 - val_loss: 2.4235 - val_accuracy10: 0.7282 - 51s/epoch - 36ms/step
Epoch 13/50
1403/1403 - 51s - loss: 1.8649 - accuracy10: 0.6797 - val_loss: 2.4456 - val_accuracy10: 0.7304 - 51s/epoch - 36ms/step
Epoch 14/50
1403/1403 - 50s - loss: 1.8586 - accuracy10: 0.6792 - val_loss: 2.4000 - val_accuracy10: 0.7223 - 50s/epoch - 36ms/step
Epoch 15/50
1403/1403 - 53s - loss: 1.8497 - accuracy10: 0.6799 - val_loss: 2.4129 - val_accuracy10: 0.7240 - 53s/epoch - 38ms/step
Epoch 16/50
1403/1403 - 48s - loss: 1.8455 - accuracy10: 0.6808 - val_loss: 2.4295 - val_accuracy10: 0.7220 - 48s/epoch - 34ms/step
Epoch 17/50
1403/1403 - 49s - loss: 1.8383 - accuracy10: 0.6815 - val_loss: 2.4499 - val_accuracy10: 0.7230 - 49s/epoch - 35ms/step
Epoch 18/50
1403/1403 - 52s - loss: 1.8313 - accuracy10: 0.6822 - val_loss: 2.5138 - val_accuracy10: 0.7344 - 52s/epoch - 37ms/step
Epoch 19/50
1403/1403 - 52s - loss: 1.8264 - accuracy10: 0.6833 - val_loss: 2.6065 - val_accuracy10: 0.7432 - 52s/epoch - 37ms/step
Epoch 20/50
1403/1403 - 56s - loss: 1.8202 - accuracy10: 0.6830 - val_loss: 2.4479 - val_accuracy10: 0.7263 - 56s/epoch - 40ms/step
Epoch 21/50
1403/1403 - 53s - loss: 1.8157 - accuracy10: 0.6839 - val_loss: 2.4438 - val_accuracy10: 0.7225 - 53s/epoch - 38ms/step
testing model: results/EXC/W2/deepLOB_L1/h10
Evaluating performance on  test set...
4918/4918 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.716186
{'0': {'precision': 0.3282807276006261, 'recall': 0.71062923124506, 'f1-score': 0.44909740079227184, 'support': 145495}, '1': {'precision': 0.9321739780611434, 'recall': 0.6187531342249611, 'f1-score': 0.7437945548815466, 'support': 967145}, '2': {'precision': 0.34444554848966613, 'recall': 0.7113249748630291, 'f1-score': 0.4641401056415818, 'support': 146199}, 'accuracy': 0.640123161103207, 'macro avg': {'precision': 0.5349667513838119, 'recall': 0.6802357801110168, 'f1-score': 0.5523440204384668, 'support': 1258839}, 'weighted avg': {'precision': 0.7941191853905372, 'recall': 0.640123161103207, 'f1-score': 0.6772553363963768, 'support': 1258839}}
[[103393  20925  21177]
 [191973 598424 176748]
 [ 19587  22617 103995]]
Evaluating performance on  train set...
1403/1403 - 23s - 23s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57428026
{'0': {'precision': 0.36136841017871285, 'recall': 0.5825423258395781, 'f1-score': 0.4460430125807548, 'support': 36030}, '1': {'precision': 0.9204497072350256, 'recall': 0.761626710477207, 'f1-score': 0.8335401118512722, 'support': 286689}, '2': {'precision': 0.38159775115033684, 'recall': 0.6701138964727945, 'f1-score': 0.48628149452660646, 'support': 36261}, 'accuracy': 0.7344086021505376, 'macro avg': {'precision': 0.554471956188025, 'recall': 0.6714276442631931, 'f1-score': 0.5886215396528779, 'support': 358980}, 'weighted avg': {'precision': 0.8099059167382686, 'recall': 0.7344086021505376, 'f1-score': 0.7595709068550985, 'support': 358980}}
[[ 20989  10502   4539]
 [ 33500 218350  34839]
 [  3593   8369  24299]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60117465
{'0': {'precision': 0.36693401385344515, 'recall': 0.601883689639707, 'f1-score': 0.45591982333956177, 'support': 13378}, '1': {'precision': 0.9220387652548456, 'recall': 0.735042557176451, 'f1-score': 0.8179897059419525, 'support': 96106}, '2': {'precision': 0.3779286364765295, 'recall': 0.6899418121363259, 'f1-score': 0.48835281217405263, 'support': 13233}, 'accuracy': 0.7156628665955003, 'macro avg': {'precision': 0.5556338051949401, 'recall': 0.6756226863174946, 'f1-score': 0.587420780485189, 'support': 122717}, 'weighted avg': {'precision': 0.8028507090085929, 'recall': 0.7156628665955003, 'f1-score': 0.7429727490029352, 'support': 122717}}
[[ 8052  3257  2069]
 [12505 70642 12959]
 [ 1387  2716  9130]]
training model: results/EXC/W2/deepLOB_L1/h20
Epoch 1/50
1403/1403 - 61s - loss: 2.6118 - accuracy20: 0.4970 - val_loss: 2.9698 - val_accuracy20: 0.5898 - 61s/epoch - 43ms/step
Epoch 2/50
1403/1403 - 51s - loss: 2.3141 - accuracy20: 0.6018 - val_loss: 2.7770 - val_accuracy20: 0.6681 - 51s/epoch - 37ms/step
Epoch 3/50
1403/1403 - 49s - loss: 2.1607 - accuracy20: 0.6379 - val_loss: 2.6483 - val_accuracy20: 0.6614 - 49s/epoch - 35ms/step
Epoch 4/50
1403/1403 - 56s - loss: 2.1148 - accuracy20: 0.6463 - val_loss: 2.6065 - val_accuracy20: 0.6659 - 56s/epoch - 40ms/step
Epoch 5/50
1403/1403 - 50s - loss: 2.0837 - accuracy20: 0.6504 - val_loss: 2.5723 - val_accuracy20: 0.6699 - 50s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 51s - loss: 2.0616 - accuracy20: 0.6536 - val_loss: 2.5720 - val_accuracy20: 0.6809 - 51s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 50s - loss: 2.0426 - accuracy20: 0.6556 - val_loss: 2.5598 - val_accuracy20: 0.6833 - 50s/epoch - 36ms/step
Epoch 8/50
1403/1403 - 49s - loss: 2.0296 - accuracy20: 0.6573 - val_loss: 2.5392 - val_accuracy20: 0.6918 - 49s/epoch - 35ms/step
Epoch 9/50
1403/1403 - 50s - loss: 2.0177 - accuracy20: 0.6592 - val_loss: 2.5457 - val_accuracy20: 0.6926 - 50s/epoch - 36ms/step
Epoch 10/50
1403/1403 - 48s - loss: 2.0078 - accuracy20: 0.6598 - val_loss: 2.4970 - val_accuracy20: 0.6905 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 50s - loss: 1.9985 - accuracy20: 0.6611 - val_loss: 2.4939 - val_accuracy20: 0.6929 - 50s/epoch - 35ms/step
Epoch 12/50
1403/1403 - 49s - loss: 1.9887 - accuracy20: 0.6632 - val_loss: 2.4919 - val_accuracy20: 0.6949 - 49s/epoch - 35ms/step
Epoch 13/50
1403/1403 - 54s - loss: 1.9843 - accuracy20: 0.6639 - val_loss: 2.4917 - val_accuracy20: 0.6833 - 54s/epoch - 38ms/step
Epoch 14/50
1403/1403 - 53s - loss: 1.9752 - accuracy20: 0.6648 - val_loss: 2.4936 - val_accuracy20: 0.6897 - 53s/epoch - 38ms/step
Epoch 15/50
1403/1403 - 54s - loss: 1.9694 - accuracy20: 0.6655 - val_loss: 2.5131 - val_accuracy20: 0.7013 - 54s/epoch - 38ms/step
Epoch 16/50
1403/1403 - 51s - loss: 1.9638 - accuracy20: 0.6662 - val_loss: 2.4846 - val_accuracy20: 0.6972 - 51s/epoch - 36ms/step
Epoch 17/50
1403/1403 - 51s - loss: 1.9596 - accuracy20: 0.6671 - val_loss: 2.4986 - val_accuracy20: 0.6993 - 51s/epoch - 36ms/step
Epoch 18/50
1403/1403 - 47s - loss: 1.9537 - accuracy20: 0.6677 - val_loss: 2.5066 - val_accuracy20: 0.7011 - 47s/epoch - 34ms/step
Epoch 19/50
1403/1403 - 51s - loss: 1.9480 - accuracy20: 0.6689 - val_loss: 2.4878 - val_accuracy20: 0.6989 - 51s/epoch - 36ms/step
Epoch 20/50
1403/1403 - 48s - loss: 1.9446 - accuracy20: 0.6688 - val_loss: 2.5293 - val_accuracy20: 0.7022 - 48s/epoch - 34ms/step
Epoch 21/50
1403/1403 - 49s - loss: 1.9395 - accuracy20: 0.6692 - val_loss: 2.5256 - val_accuracy20: 0.6984 - 49s/epoch - 35ms/step
Epoch 22/50
1403/1403 - 53s - loss: 1.9350 - accuracy20: 0.6696 - val_loss: 2.5110 - val_accuracy20: 0.6994 - 53s/epoch - 38ms/step
Epoch 23/50
1403/1403 - 52s - loss: 1.9314 - accuracy20: 0.6708 - val_loss: 2.5713 - val_accuracy20: 0.7071 - 52s/epoch - 37ms/step
Epoch 24/50
1403/1403 - 56s - loss: 1.9275 - accuracy20: 0.6708 - val_loss: 2.5478 - val_accuracy20: 0.7021 - 56s/epoch - 40ms/step
Epoch 25/50
1403/1403 - 46s - loss: 1.9228 - accuracy20: 0.6712 - val_loss: 2.6097 - val_accuracy20: 0.7014 - 46s/epoch - 33ms/step
Epoch 26/50
1403/1403 - 57s - loss: 1.9186 - accuracy20: 0.6726 - val_loss: 2.5943 - val_accuracy20: 0.6960 - 57s/epoch - 41ms/step
testing model: results/EXC/W2/deepLOB_L1/h20
Evaluating performance on  test set...
4918/4918 - 77s - 77s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8565771
{'0': {'precision': 0.4213734740796901, 'recall': 0.6774744364167555, 'f1-score': 0.5195801059386584, 'support': 202632}, '1': {'precision': 0.8887817201012654, 'recall': 0.5775108618327837, 'f1-score': 0.7001073366679449, 'support': 850455}, '2': {'precision': 0.38042292578427894, 'recall': 0.7034196508417901, 'f1-score': 0.4937930422707724, 'support': 205752}, 'accuracy': 0.6141810032895391, 'macro avg': {'precision': 0.5635260399884116, 'recall': 0.6528016496971097, 'f1-score': 0.5711601616257919, 'support': 1258839}, 'weighted avg': {'precision': 0.7304551141126104, 'recall': 0.6141810032895391, 'f1-score': 0.6373271300506224, 'support': 1258839}}
[[137278  34886  30468]
 [154061 491147 205247]
 [ 34448  26574 144730]]
Evaluating performance on  train set...
1403/1403 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65933573
{'0': {'precision': 0.4618410435718128, 'recall': 0.53858971594362, 'f1-score': 0.4972714685200771, 'support': 51011}, '1': {'precision': 0.8668368508196063, 'recall': 0.7570400165257689, 'f1-score': 0.8082265312916111, 'support': 256569}, '2': {'precision': 0.44096471804934967, 'recall': 0.6470428015564202, 'f1-score': 0.5244872694585282, 'support': 51400}, 'accuracy': 0.7102484818095716, 'macro avg': {'precision': 0.5898808708135895, 'recall': 0.6475575113419364, 'f1-score': 0.6099950897567389, 'support': 358980}, 'weighted avg': {'precision': 0.7483091647426426, 'recall': 0.7102484818095716, 'f1-score': 0.7234130966566477, 'support': 358980}}
[[ 27474  17374   6163]
 [ 26336 194233  36000]
 [  5678  12464  33258]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6848331
{'0': {'precision': 0.47045577373446223, 'recall': 0.5573578059972255, 'f1-score': 0.5102329897914327, 'support': 18742}, '1': {'precision': 0.8672366243794816, 'recall': 0.7362333770368983, 'f1-score': 0.7963835283391582, 'support': 85424}, '2': {'precision': 0.43996713464080306, 'recall': 0.6638995202414965, 'f1-score': 0.5292196631144723, 'support': 18551}, 'accuracy': 0.6979799049846395, 'macro avg': {'precision': 0.5925531775849157, 'recall': 0.6524969010918734, 'f1-score': 0.6119453937483544, 'support': 122717}, 'weighted avg': {'precision': 0.7420482396656182, 'recall': 0.6979799049846395, 'f1-score': 0.7122941987658747, 'support': 122717}}
[[10446  5616  2680]
 [ 9535 62892 12997]
 [ 2223  4012 12316]]
training model: results/EXC/W2/deepLOB_L1/h30
Epoch 1/50
1403/1403 - 59s - loss: 2.7197 - accuracy30: 0.4875 - val_loss: 3.0009 - val_accuracy30: 0.6055 - 59s/epoch - 42ms/step
Epoch 2/50
1403/1403 - 51s - loss: 2.5010 - accuracy30: 0.5632 - val_loss: 2.8995 - val_accuracy30: 0.6400 - 51s/epoch - 36ms/step
Epoch 3/50
1403/1403 - 50s - loss: 2.3209 - accuracy30: 0.6157 - val_loss: 3.0548 - val_accuracy30: 0.6583 - 50s/epoch - 36ms/step
Epoch 4/50
1403/1403 - 54s - loss: 2.2521 - accuracy30: 0.6273 - val_loss: 2.9491 - val_accuracy30: 0.6584 - 54s/epoch - 39ms/step
Epoch 5/50
1403/1403 - 52s - loss: 2.2187 - accuracy30: 0.6315 - val_loss: 2.9036 - val_accuracy30: 0.6609 - 52s/epoch - 37ms/step
Epoch 6/50
1403/1403 - 52s - loss: 2.1944 - accuracy30: 0.6368 - val_loss: 2.8744 - val_accuracy30: 0.6675 - 52s/epoch - 37ms/step
Epoch 7/50
1403/1403 - 51s - loss: 2.1773 - accuracy30: 0.6381 - val_loss: 2.8372 - val_accuracy30: 0.6601 - 51s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 51s - loss: 2.1633 - accuracy30: 0.6395 - val_loss: 2.8922 - val_accuracy30: 0.6615 - 51s/epoch - 37ms/step
Epoch 9/50
1403/1403 - 53s - loss: 2.1539 - accuracy30: 0.6408 - val_loss: 2.8954 - val_accuracy30: 0.6698 - 53s/epoch - 38ms/step
Epoch 10/50
1403/1403 - 53s - loss: 2.1428 - accuracy30: 0.6433 - val_loss: 2.8902 - val_accuracy30: 0.6717 - 53s/epoch - 38ms/step
Epoch 11/50
1403/1403 - 53s - loss: 2.1352 - accuracy30: 0.6441 - val_loss: 2.8447 - val_accuracy30: 0.6834 - 53s/epoch - 38ms/step
Epoch 12/50
1403/1403 - 51s - loss: 2.1286 - accuracy30: 0.6452 - val_loss: 2.8547 - val_accuracy30: 0.6810 - 51s/epoch - 37ms/step
Epoch 13/50
1403/1403 - 50s - loss: 2.1211 - accuracy30: 0.6458 - val_loss: 2.8045 - val_accuracy30: 0.6826 - 50s/epoch - 36ms/step
Epoch 14/50
1403/1403 - 50s - loss: 2.1151 - accuracy30: 0.6475 - val_loss: 2.8212 - val_accuracy30: 0.6817 - 50s/epoch - 35ms/step
Epoch 15/50
1403/1403 - 49s - loss: 2.1097 - accuracy30: 0.6468 - val_loss: 2.8160 - val_accuracy30: 0.6844 - 49s/epoch - 35ms/step
Epoch 16/50
1403/1403 - 52s - loss: 2.1044 - accuracy30: 0.6485 - val_loss: 2.8716 - val_accuracy30: 0.6834 - 52s/epoch - 37ms/step
Epoch 17/50
1403/1403 - 52s - loss: 2.1004 - accuracy30: 0.6483 - val_loss: 2.9045 - val_accuracy30: 0.6862 - 52s/epoch - 37ms/step
Epoch 18/50
1403/1403 - 48s - loss: 2.0965 - accuracy30: 0.6487 - val_loss: 2.8462 - val_accuracy30: 0.6870 - 48s/epoch - 34ms/step
Epoch 19/50
1403/1403 - 49s - loss: 2.0914 - accuracy30: 0.6498 - val_loss: 2.8688 - val_accuracy30: 0.6851 - 49s/epoch - 35ms/step
Epoch 20/50
1403/1403 - 50s - loss: 2.0871 - accuracy30: 0.6506 - val_loss: 2.8633 - val_accuracy30: 0.6884 - 50s/epoch - 36ms/step
Epoch 21/50
1403/1403 - 51s - loss: 2.0815 - accuracy30: 0.6503 - val_loss: 2.9243 - val_accuracy30: 0.6878 - 51s/epoch - 36ms/step
Epoch 22/50
1403/1403 - 50s - loss: 2.0778 - accuracy30: 0.6520 - val_loss: 2.8615 - val_accuracy30: 0.6854 - 50s/epoch - 35ms/step
Epoch 23/50
1403/1403 - 52s - loss: 2.0745 - accuracy30: 0.6519 - val_loss: 2.8787 - val_accuracy30: 0.6868 - 52s/epoch - 37ms/step
testing model: results/EXC/W2/deepLOB_L1/h30
Evaluating performance on  test set...
4918/4918 - 76s - 76s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.772788
{'0': {'precision': 0.5010400885448965, 'recall': 0.5246485095819925, 'f1-score': 0.5125725998630816, 'support': 243321}, '1': {'precision': 0.7583370567737828, 'recall': 0.6928425261856412, 'f1-score': 0.7241118443023498, 'support': 766737}, '2': {'precision': 0.4788196457751305, 'recall': 0.584204581539587, 'f1-score': 0.526288345279975, 'support': 248781}, 'accuracy': 0.6388624756620982, 'macro avg': {'precision': 0.5793989303646033, 'recall': 0.6005652057690735, 'f1-score': 0.5876575964818022, 'support': 1258839}, 'weighted avg': {'precision': 0.6533638420639775, 'recall': 0.6388624756620982, 'f1-score': 0.6441280906956592, 'support': 1258839}}
[[127658  89497  26166]
 [103478 531228 132031]
 [ 23650  79792 145339]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68890226
{'0': {'precision': 0.5316968679441904, 'recall': 0.4425597532767926, 'f1-score': 0.48305062458908615, 'support': 62256}, '1': {'precision': 0.7787749091076441, 'recall': 0.7949011401972925, 'f1-score': 0.7867553979488111, 'support': 234170}, '2': {'precision': 0.5171260015849256, 'recall': 0.56332129040509, 'f1-score': 0.5392360898573789, 'support': 62554}, 'accuracy': 0.6934425316173602, 'macro avg': {'precision': 0.6091992595455867, 'recall': 0.6002607279597251, 'f1-score': 0.6030140374650921, 'support': 358980}, 'weighted avg': {'precision': 0.6903318863992812, 'recall': 0.6934425316173602, 'f1-score': 0.6909540520001942, 'support': 358980}}
[[ 27552  29570   5134]
 [ 20258 186142  27770]
 [  4009  23307  35238]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7157518
{'0': {'precision': 0.5412666887344146, 'recall': 0.4325647017327278, 'f1-score': 0.4808488739677016, 'support': 22681}, '1': {'precision': 0.7666978579196277, 'recall': 0.7828433461156086, 'f1-score': 0.7746864878332365, 'support': 77451}, '2': {'precision': 0.5197381316398134, 'recall': 0.5870267876909453, 'f1-score': 0.5513369651099929, 'support': 22585}, 'accuracy': 0.6820652395348648, 'macro avg': {'precision': 0.6092342260979519, 'recall': 0.6008116118464272, 'f1-score': 0.602290775636977, 'support': 122717}, 'weighted avg': {'precision': 0.6795820567973755, 'recall': 0.6820652395348648, 'f1-score': 0.6792728133562801, 'support': 122717}}
[[ 9811 10607  2263]
 [ 6831 60632  9988]
 [ 1484  7843 13258]]
training model: results/EXC/W2/deepLOB_L1/h50
Epoch 1/50
1403/1403 - 55s - loss: 2.8716 - accuracy50: 0.4773 - val_loss: 3.2058 - val_accuracy50: 0.5319 - 55s/epoch - 39ms/step
Epoch 2/50
1403/1403 - 51s - loss: 2.7381 - accuracy50: 0.5278 - val_loss: 3.0228 - val_accuracy50: 0.5793 - 51s/epoch - 36ms/step
Epoch 3/50
1403/1403 - 53s - loss: 2.5699 - accuracy50: 0.5822 - val_loss: 2.9547 - val_accuracy50: 0.5968 - 53s/epoch - 38ms/step
Epoch 4/50
1403/1403 - 53s - loss: 2.5021 - accuracy50: 0.5926 - val_loss: 3.0076 - val_accuracy50: 0.6099 - 53s/epoch - 38ms/step
Epoch 5/50
1403/1403 - 53s - loss: 2.4655 - accuracy50: 0.5968 - val_loss: 2.9835 - val_accuracy50: 0.6132 - 53s/epoch - 38ms/step
Epoch 6/50
1403/1403 - 51s - loss: 2.4437 - accuracy50: 0.5995 - val_loss: 2.9944 - val_accuracy50: 0.6168 - 51s/epoch - 37ms/step
Epoch 7/50
1403/1403 - 56s - loss: 2.4282 - accuracy50: 0.6022 - val_loss: 2.9321 - val_accuracy50: 0.6162 - 56s/epoch - 40ms/step
Epoch 8/50
1403/1403 - 53s - loss: 2.4141 - accuracy50: 0.6031 - val_loss: 2.8766 - val_accuracy50: 0.6140 - 53s/epoch - 38ms/step
Epoch 9/50
1403/1403 - 57s - loss: 2.4046 - accuracy50: 0.6045 - val_loss: 2.8804 - val_accuracy50: 0.6176 - 57s/epoch - 41ms/step
Epoch 10/50
1403/1403 - 52s - loss: 2.3936 - accuracy50: 0.6070 - val_loss: 2.8587 - val_accuracy50: 0.6165 - 52s/epoch - 37ms/step
Epoch 11/50
1403/1403 - 53s - loss: 2.3869 - accuracy50: 0.6079 - val_loss: 2.8345 - val_accuracy50: 0.6219 - 53s/epoch - 38ms/step
Epoch 12/50
1403/1403 - 52s - loss: 2.3797 - accuracy50: 0.6095 - val_loss: 2.8567 - val_accuracy50: 0.6212 - 52s/epoch - 37ms/step
Epoch 13/50
1403/1403 - 59s - loss: 2.3753 - accuracy50: 0.6103 - val_loss: 2.8524 - val_accuracy50: 0.6199 - 59s/epoch - 42ms/step
Epoch 14/50
1403/1403 - 51s - loss: 2.3672 - accuracy50: 0.6111 - val_loss: 2.8863 - val_accuracy50: 0.6193 - 51s/epoch - 36ms/step
Epoch 15/50
1403/1403 - 51s - loss: 2.3620 - accuracy50: 0.6120 - val_loss: 2.8635 - val_accuracy50: 0.6186 - 51s/epoch - 36ms/step
Epoch 16/50
1403/1403 - 51s - loss: 2.3573 - accuracy50: 0.6138 - val_loss: 2.8730 - val_accuracy50: 0.6168 - 51s/epoch - 36ms/step
Epoch 17/50
1403/1403 - 51s - loss: 2.3536 - accuracy50: 0.6134 - val_loss: 2.8307 - val_accuracy50: 0.6191 - 51s/epoch - 36ms/step
Epoch 18/50
1403/1403 - 49s - loss: 2.3487 - accuracy50: 0.6142 - val_loss: 2.8602 - val_accuracy50: 0.6182 - 49s/epoch - 35ms/step
Epoch 19/50
1403/1403 - 53s - loss: 2.3445 - accuracy50: 0.6155 - val_loss: 2.8335 - val_accuracy50: 0.6193 - 53s/epoch - 37ms/step
Epoch 20/50
1403/1403 - 52s - loss: 2.3413 - accuracy50: 0.6163 - val_loss: 2.8484 - val_accuracy50: 0.6208 - 52s/epoch - 37ms/step
Epoch 21/50
1403/1403 - 55s - loss: 2.3427 - accuracy50: 0.6158 - val_loss: 2.8667 - val_accuracy50: 0.6167 - 55s/epoch - 39ms/step
Epoch 22/50
1403/1403 - 53s - loss: 2.3381 - accuracy50: 0.6168 - val_loss: 2.8838 - val_accuracy50: 0.6179 - 53s/epoch - 38ms/step
Epoch 23/50
1403/1403 - 51s - loss: 2.3326 - accuracy50: 0.6167 - val_loss: 2.8448 - val_accuracy50: 0.6166 - 51s/epoch - 37ms/step
Epoch 24/50
1403/1403 - 51s - loss: 2.3283 - accuracy50: 0.6181 - val_loss: 2.8373 - val_accuracy50: 0.6189 - 51s/epoch - 36ms/step
Epoch 25/50
1403/1403 - 53s - loss: 2.3268 - accuracy50: 0.6183 - val_loss: 2.8453 - val_accuracy50: 0.6221 - 53s/epoch - 38ms/step
Epoch 26/50
1403/1403 - 50s - loss: 2.3229 - accuracy50: 0.6190 - val_loss: 2.8525 - val_accuracy50: 0.6206 - 50s/epoch - 36ms/step
Epoch 27/50
1403/1403 - 49s - loss: 2.3188 - accuracy50: 0.6198 - val_loss: 2.8604 - val_accuracy50: 0.6182 - 49s/epoch - 35ms/step
testing model: results/EXC/W2/deepLOB_L1/h50
Evaluating performance on  test set...
4918/4918 - 82s - 82s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8885959
{'0': {'precision': 0.4893839183552, 'recall': 0.6186454694933888, 'f1-score': 0.5464749351480886, 'support': 308343}, '1': {'precision': 0.7049054941998586, 'recall': 0.5762815704913115, 'f1-score': 0.6341369756856994, 'support': 633305}, '2': {'precision': 0.5094689260390485, 'recall': 0.5642656948021855, 'f1-score': 0.5354690664743949, 'support': 317191}, 'accuracy': 0.5836306310814965, 'macro avg': {'precision': 0.5679194461980357, 'recall': 0.5863975782622952, 'f1-score': 0.5720269924360609, 'support': 1258839}, 'weighted avg': {'precision': 0.602870770337502, 'recall': 0.5836306310814965, 'f1-score': 0.5878033703905572, 'support': 1258839}}
[[190755  77064  40524]
 [136540 364962 131803]
 [ 62491  75720 178980]]
Evaluating performance on  train set...
1403/1403 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8153701
{'0': {'precision': 0.5258919245780881, 'recall': 0.4749646252761711, 'f1-score': 0.49913258983890957, 'support': 80566}, '1': {'precision': 0.7009438017820854, 'recall': 0.7245633259439179, 'f1-score': 0.7125578854581798, 'support': 198031}, '2': {'precision': 0.5284007262734322, 'recall': 0.5358222509734646, 'f1-score': 0.5320856110441954, 'support': 80383}, 'accuracy': 0.6262828012702657, 'macro avg': {'precision': 0.5850788175445353, 'recall': 0.5784500673978513, 'f1-score': 0.581258695447095, 'support': 358980}, 'weighted avg': {'precision': 0.6230209103189696, 'recall': 0.6262828012702657, 'f1-score': 0.6242473244211263, 'support': 358980}}
[[ 38266  33693   8607]
 [ 24711 143486  29834]
 [  9787  27525  43071]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83250797
{'0': {'precision': 0.5321804511278195, 'recall': 0.4866444360411152, 'f1-score': 0.508394835604877, 'support': 29089}, '1': {'precision': 0.6846435100548446, 'recall': 0.7207176446851769, 'f1-score': 0.7022175849267737, 'support': 64433}, '2': {'precision': 0.5469263671391708, 'recall': 0.5299537592053434, 'f1-score': 0.5383063113214113, 'support': 29195}, 'accuracy': 0.6198489206874354, 'macro avg': {'precision': 0.5879167761072783, 'recall': 0.5791052799772118, 'f1-score': 0.5829729106176873, 'support': 122717}, 'weighted avg': {'precision': 0.6157398544199176, 'recall': 0.6198489206874354, 'f1-score': 0.6172782563257386, 'support': 122717}}
[[14156 11730  3203]
 [ 8381 46438  9614]
 [ 4063  9660 15472]]
training model: results/EXC/W2/deepLOB_L1/h100
Epoch 1/50
1403/1403 - 58s - loss: 3.0722 - accuracy100: 0.4681 - val_loss: 3.5183 - val_accuracy100: 0.4312 - 58s/epoch - 41ms/step
Epoch 2/50
1403/1403 - 56s - loss: 3.0032 - accuracy100: 0.4893 - val_loss: 3.3872 - val_accuracy100: 0.4413 - 56s/epoch - 40ms/step
Epoch 3/50
1403/1403 - 58s - loss: 2.9483 - accuracy100: 0.5083 - val_loss: 3.3720 - val_accuracy100: 0.4640 - 58s/epoch - 41ms/step
Epoch 4/50
1403/1403 - 52s - loss: 2.9067 - accuracy100: 0.5194 - val_loss: 3.3626 - val_accuracy100: 0.4671 - 52s/epoch - 37ms/step
Epoch 5/50
1403/1403 - 52s - loss: 2.8697 - accuracy100: 0.5275 - val_loss: 3.3579 - val_accuracy100: 0.4708 - 52s/epoch - 37ms/step
Epoch 6/50
1403/1403 - 51s - loss: 2.8406 - accuracy100: 0.5339 - val_loss: 3.4014 - val_accuracy100: 0.4678 - 51s/epoch - 37ms/step
Epoch 7/50
1403/1403 - 52s - loss: 2.8269 - accuracy100: 0.5357 - val_loss: 3.4217 - val_accuracy100: 0.4645 - 52s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 55s - loss: 2.8163 - accuracy100: 0.5378 - val_loss: 3.4205 - val_accuracy100: 0.4634 - 55s/epoch - 39ms/step
Epoch 9/50
1403/1403 - 56s - loss: 2.8058 - accuracy100: 0.5401 - val_loss: 3.4288 - val_accuracy100: 0.4698 - 56s/epoch - 40ms/step
Epoch 10/50
1403/1403 - 48s - loss: 2.8005 - accuracy100: 0.5408 - val_loss: 3.4196 - val_accuracy100: 0.4717 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 52s - loss: 2.7938 - accuracy100: 0.5413 - val_loss: 3.4270 - val_accuracy100: 0.4710 - 52s/epoch - 37ms/step
Epoch 12/50
1403/1403 - 56s - loss: 2.7868 - accuracy100: 0.5427 - val_loss: 3.4614 - val_accuracy100: 0.4693 - 56s/epoch - 40ms/step
Epoch 13/50
1403/1403 - 51s - loss: 2.7822 - accuracy100: 0.5438 - val_loss: 3.4049 - val_accuracy100: 0.4769 - 51s/epoch - 37ms/step
Epoch 14/50
1403/1403 - 49s - loss: 2.7773 - accuracy100: 0.5449 - val_loss: 3.4113 - val_accuracy100: 0.4714 - 49s/epoch - 35ms/step
Epoch 15/50
1403/1403 - 51s - loss: 2.7721 - accuracy100: 0.5460 - val_loss: 3.3806 - val_accuracy100: 0.4676 - 51s/epoch - 36ms/step
testing model: results/EXC/W2/deepLOB_L1/h100
Evaluating performance on  test set...
4918/4918 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0683792
{'0': {'precision': 0.5560171886848818, 'recall': 0.2955383796090464, 'f1-score': 0.3859393916193338, 'support': 409358}, '1': {'precision': 0.4381699394354372, 'recall': 0.5013757595825152, 'f1-score': 0.46764683493371895, 'support': 428854}, '2': {'precision': 0.47047251960809244, 'recall': 0.6157783499394951, 'f1-score': 0.5334067846349487, 'support': 420627}, 'accuracy': 0.4726664807811007, 'macro avg': {'precision': 0.4882198825761372, 'recall': 0.47089749637701894, 'f1-score': 0.46233100372933383, 'support': 1258839}, 'weighted avg': {'precision': 0.48728587217070957, 'recall': 0.4726664807811007, 'f1-score': 0.46304959476455443, 'support': 1258839}}
[[120981 147019 141358]
 [ 63670 215017 150167]
 [ 32934 128680 259013]]
Evaluating performance on  train set...
1403/1403 - 20s - 20s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0646622
{'0': {'precision': 0.6070729083335632, 'recall': 0.19899989148913083, 'f1-score': 0.2997432562193968, 'support': 110588}, '1': {'precision': 0.44437600045115194, 'recall': 0.7411442958847022, 'f1-score': 0.5556155200047731, 'support': 138216}, '2': {'precision': 0.5141961651917404, 'recall': 0.43033873075805984, 'f1-score': 0.4685449442643687, 'support': 110176}, 'accuracy': 0.4787397626608725, 'macro avg': {'precision': 0.5218816913254852, 'recall': 0.4568276393772976, 'f1-score': 0.4413012401628462, 'support': 358980}, 'weighted avg': {'precision': 0.5159254798632618, 'recall': 0.4787397626608725, 'f1-score': 0.45006788598540715, 'support': 358980}}
[[ 22007  69698  18883]
 [  9866 102438  25912]
 [  4378  58385  47413]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0818077
{'0': {'precision': 0.6063169768753525, 'recall': 0.1928201711679393, 'f1-score': 0.2925909364854093, 'support': 39026}, '1': {'precision': 0.42621111946896817, 'recall': 0.7348577929465302, 'f1-score': 0.539510720221838, 'support': 43950}, '2': {'precision': 0.5200266442700339, 'recall': 0.4518255705694371, 'f1-score': 0.4835330550693416, 'support': 39741}, 'accuracy': 0.47082311334207977, 'macro avg': {'precision': 0.5175182468714515, 'recall': 0.45983451156130223, 'f1-score': 0.4385449039255296, 'support': 122717}, 'weighted avg': {'precision': 0.5138691779470984, 'recall': 0.47082311334207977, 'f1-score': 0.4428582607343731, 'support': 122717}}
[[ 7525 23576  7925]
 [ 3005 32297  8648]
 [ 1881 19904 17956]]
training model: results/EXC/W2/deepLOB_L1/h200
Epoch 1/50
1403/1403 - 49s - loss: 3.2244 - accuracy200: 0.4137 - val_loss: 3.3561 - val_accuracy200: 0.3726 - 49s/epoch - 35ms/step
Epoch 2/50
1403/1403 - 51s - loss: 3.1951 - accuracy200: 0.4229 - val_loss: 3.4279 - val_accuracy200: 0.3755 - 51s/epoch - 37ms/step
Epoch 3/50
1403/1403 - 61s - loss: 3.1763 - accuracy200: 0.4296 - val_loss: 3.4582 - val_accuracy200: 0.3798 - 61s/epoch - 44ms/step
Epoch 4/50
1403/1403 - 53s - loss: 3.1630 - accuracy200: 0.4365 - val_loss: 3.4060 - val_accuracy200: 0.3759 - 53s/epoch - 38ms/step
Epoch 5/50
1403/1403 - 51s - loss: 3.1518 - accuracy200: 0.4409 - val_loss: 3.4060 - val_accuracy200: 0.3768 - 51s/epoch - 36ms/step
Epoch 6/50
1403/1403 - 53s - loss: 3.1429 - accuracy200: 0.4439 - val_loss: 3.4293 - val_accuracy200: 0.3790 - 53s/epoch - 38ms/step
Epoch 7/50
1403/1403 - 53s - loss: 3.1335 - accuracy200: 0.4463 - val_loss: 3.4691 - val_accuracy200: 0.3732 - 53s/epoch - 38ms/step
Epoch 8/50
1403/1403 - 50s - loss: 3.1249 - accuracy200: 0.4472 - val_loss: 3.4652 - val_accuracy200: 0.3754 - 50s/epoch - 36ms/step
Epoch 9/50
1403/1403 - 54s - loss: 3.1183 - accuracy200: 0.4491 - val_loss: 3.4755 - val_accuracy200: 0.3775 - 54s/epoch - 39ms/step
Epoch 10/50
1403/1403 - 52s - loss: 3.1125 - accuracy200: 0.4509 - val_loss: 3.4857 - val_accuracy200: 0.3749 - 52s/epoch - 37ms/step
Epoch 11/50
1403/1403 - 49s - loss: 3.1071 - accuracy200: 0.4522 - val_loss: 3.4728 - val_accuracy200: 0.3747 - 49s/epoch - 35ms/step
testing model: results/EXC/W2/deepLOB_L1/h200
Evaluating performance on  test set...
4918/4918 - 79s - 79s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1259162
{'0': {'precision': 0.40066320977749426, 'recall': 0.5649689354599406, 'f1-score': 0.46883747236955253, 'support': 431360}, '1': {'precision': 0.3163430286776919, 'recall': 0.44589517895801195, 'f1-score': 0.37010957984350656, 'support': 385705}, '2': {'precision': 0.4554722133891996, 'recall': 0.11023736118467814, 'f1-score': 0.17751177336813098, 'support': 441774}, 'accuracy': 0.36890261582299244, 'macro avg': {'precision': 0.3908261506147952, 'recall': 0.37370049186754356, 'f1-score': 0.3388196085270634, 'support': 1258839}, 'weighted avg': {'precision': 0.39406226820391593, 'recall': 0.36890261582299244, 'f1-score': 0.33635034642460443, 'support': 1258839}}
[[243705 162263  25392]
 [180891 171984  32830]
 [183658 209416  48700]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.119107
{'0': {'precision': 0.4267728881561502, 'recall': 0.30467418948616015, 'f1-score': 0.3555327179999424, 'support': 121497}, '1': {'precision': 0.3263900161368866, 'recall': 0.5891706022268951, 'f1-score': 0.4200691871432346, 'support': 116036}, '2': {'precision': 0.4469857450027873, 'recall': 0.23108022429537164, 'f1-score': 0.3046593425680663, 'support': 121447}, 'accuracy': 0.37173658699649004, 'macro avg': {'precision': 0.40004954976527474, 'recall': 0.37497500533614225, 'f1-score': 0.3600870825704145, 'support': 358980}, 'weighted avg': {'precision': 0.40116356141880066, 'recall': 0.37173658699649004, 'f1-score': 0.35918232217687707, 'support': 358980}}
[[37017 70161 14319]
 [27269 68365 20402]
 [22451 70932 28064]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1222286
{'0': {'precision': 0.43062846857657117, 'recall': 0.2749539109823545, 'f1-score': 0.33561773946080226, 'support': 41767}, '1': {'precision': 0.3210686600221484, 'recall': 0.6019256221939636, 'f1-score': 0.4187663058687586, 'support': 38533}, '2': {'precision': 0.4620941660716536, 'recall': 0.2593771365254497, 'f1-score': 0.332256213571709, 'support': 42417}, 'accuracy': 0.37223856515397213, 'macro avg': {'precision': 0.4045970982234577, 'recall': 0.3787522232339226, 'f1-score': 0.3622134196337566, 'support': 122717}, 'weighted avg': {'precision': 0.4071028966315377, 'recall': 0.37223856515397213, 'f1-score': 0.3605643879753529, 'support': 122717}}
[[11484 24804  5479]
 [ 8011 23194  7328]
 [ 7173 24242 11002]]
training model: results/EXC/W2/deepLOB_L1/h300
Epoch 1/50
1403/1403 - 57s - loss: 3.2539 - accuracy300: 0.4026 - val_loss: 3.3595 - val_accuracy300: 0.3643 - 57s/epoch - 41ms/step
Epoch 2/50
1403/1403 - 52s - loss: 3.2221 - accuracy300: 0.4144 - val_loss: 3.4217 - val_accuracy300: 0.3585 - 52s/epoch - 37ms/step
Epoch 3/50
1403/1403 - 53s - loss: 3.2091 - accuracy300: 0.4198 - val_loss: 3.4799 - val_accuracy300: 0.3574 - 53s/epoch - 38ms/step
Epoch 4/50
1403/1403 - 50s - loss: 3.1967 - accuracy300: 0.4259 - val_loss: 3.4847 - val_accuracy300: 0.3591 - 50s/epoch - 36ms/step
Epoch 5/50
1403/1403 - 51s - loss: 3.1863 - accuracy300: 0.4286 - val_loss: 3.4644 - val_accuracy300: 0.3638 - 51s/epoch - 36ms/step
Epoch 6/50
1403/1403 - 50s - loss: 3.1828 - accuracy300: 0.4299 - val_loss: 3.4453 - val_accuracy300: 0.3676 - 50s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 51s - loss: 3.1760 - accuracy300: 0.4341 - val_loss: 3.4540 - val_accuracy300: 0.3674 - 51s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 54s - loss: 3.1711 - accuracy300: 0.4350 - val_loss: 3.4622 - val_accuracy300: 0.3665 - 54s/epoch - 39ms/step
Epoch 9/50
1403/1403 - 50s - loss: 3.1657 - accuracy300: 0.4372 - val_loss: 3.4677 - val_accuracy300: 0.3640 - 50s/epoch - 36ms/step
Epoch 10/50
1403/1403 - 51s - loss: 3.1614 - accuracy300: 0.4385 - val_loss: 3.4373 - val_accuracy300: 0.3640 - 51s/epoch - 36ms/step
Epoch 11/50
1403/1403 - 52s - loss: 3.1585 - accuracy300: 0.4398 - val_loss: 3.4346 - val_accuracy300: 0.3621 - 52s/epoch - 37ms/step
testing model: results/EXC/W2/deepLOB_L1/h300
Evaluating performance on  test set...
4918/4918 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1232477
{'0': {'precision': 0.3765952192873017, 'recall': 0.694208770257388, 'f1-score': 0.4882979641818717, 'support': 419600}, '1': {'precision': 0.3181044852655743, 'recall': 0.32541322567281694, 'f1-score': 0.32171735102772303, 'support': 407949}, '2': {'precision': 0.48065673045830026, 'recall': 0.07582137309003223, 'f1-score': 0.1309810864288518, 'support': 431290}, 'accuracy': 0.36282876523526836, 'macro avg': {'precision': 0.39178547833705873, 'recall': 0.3651477896734123, 'f1-score': 0.3136654672128156, 'support': 1258839}, 'weighted avg': {'precision': 0.393292710149525, 'recall': 0.36282876523526836, 'f1-score': 0.31189447591870084, 'support': 1258839}}
[[291290 114944  13366]
 [253230 132752  21967]
 [228963 169626  32701]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1161767
{'0': {'precision': 0.37404951543924353, 'recall': 0.3945878379497028, 'f1-score': 0.3840442802644247, 'support': 120802}, '1': {'precision': 0.3220293095317112, 'recall': 0.3132742009481572, 'f1-score': 0.31759142822690395, 'support': 117702}, '2': {'precision': 0.39065129909520435, 'recall': 0.37951957236296024, 'f1-score': 0.38500498907455827, 'support': 120476}, 'accuracy': 0.3628697977603209, 'macro avg': {'precision': 0.3622433746887197, 'recall': 0.3624605370869401, 'f1-score': 0.3622135658552956, 'support': 358980}, 'weighted avg': {'precision': 0.36256484836031755, 'recall': 0.3628697977603209, 'f1-score': 0.36257820628840765, 'support': 358980}}
[[47667 37313 35822]
 [45331 36873 35498]
 [34437 40316 45723]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.12192
{'0': {'precision': 0.39954951496071056, 'recall': 0.3614346245571789, 'f1-score': 0.37953755257847266, 'support': 43189}, '1': {'precision': 0.2962327489742633, 'recall': 0.3313124009233251, 'f1-score': 0.31279210208475555, 'support': 35957}, '2': {'precision': 0.39790021412290194, 'recall': 0.3966399669504946, 'f1-score': 0.39726909107627234, 'support': 43571}, 'accuracy': 0.36510833869797993, 'macro avg': {'precision': 0.3645608260192919, 'recall': 0.3631289974769995, 'f1-score': 0.36319958191316687, 'support': 122717}, 'weighted avg': {'precision': 0.3686913401244707, 'recall': 0.36510833869797993, 'f1-score': 0.36627626604510766, 'support': 122717}}
[[15610 13672 13907]
 [11800 11913 12244]
 [11659 14630 17282]]
training model: results/EXC/W2/deepLOB_L1/h500
Epoch 1/50
1403/1403 - 58s - loss: 3.2751 - accuracy500: 0.3904 - val_loss: 3.3774 - val_accuracy500: 0.3506 - 58s/epoch - 41ms/step
Epoch 2/50
1403/1403 - 53s - loss: 3.2427 - accuracy500: 0.4049 - val_loss: 3.3995 - val_accuracy500: 0.3524 - 53s/epoch - 38ms/step
Epoch 3/50
1403/1403 - 52s - loss: 3.2317 - accuracy500: 0.4088 - val_loss: 3.4225 - val_accuracy500: 0.3565 - 52s/epoch - 37ms/step
Epoch 4/50
1403/1403 - 47s - loss: 3.2181 - accuracy500: 0.4165 - val_loss: 3.4659 - val_accuracy500: 0.3585 - 47s/epoch - 33ms/step
Epoch 5/50
1403/1403 - 51s - loss: 3.2058 - accuracy500: 0.4222 - val_loss: 3.5043 - val_accuracy500: 0.3521 - 51s/epoch - 36ms/step
Epoch 6/50
1403/1403 - 51s - loss: 3.2009 - accuracy500: 0.4233 - val_loss: 3.5074 - val_accuracy500: 0.3528 - 51s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 53s - loss: 3.1926 - accuracy500: 0.4273 - val_loss: 3.4972 - val_accuracy500: 0.3550 - 53s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 48s - loss: 3.1873 - accuracy500: 0.4286 - val_loss: 3.5185 - val_accuracy500: 0.3538 - 48s/epoch - 34ms/step
Epoch 9/50
1403/1403 - 54s - loss: 3.1825 - accuracy500: 0.4305 - val_loss: 3.5369 - val_accuracy500: 0.3550 - 54s/epoch - 38ms/step
Epoch 10/50
1403/1403 - 49s - loss: 3.1765 - accuracy500: 0.4328 - val_loss: 3.5635 - val_accuracy500: 0.3526 - 49s/epoch - 35ms/step
Epoch 11/50
1403/1403 - 52s - loss: 3.1716 - accuracy500: 0.4355 - val_loss: 3.5164 - val_accuracy500: 0.3528 - 52s/epoch - 37ms/step
testing model: results/EXC/W2/deepLOB_L1/h500
Evaluating performance on  test set...
4918/4918 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1563158
{'0': {'precision': 0.3351771102274967, 'recall': 0.47502710873065424, 'f1-score': 0.3930322994091631, 'support': 426062}, '1': {'precision': 0.3085186365284433, 'recall': 0.5011051540714794, 'f1-score': 0.3819064624495561, 'support': 392253}, '2': {'precision': 0.3332402078560653, 'recall': 0.013538422424203903, 'f1-score': 0.026019750404104525, 'support': 440524}, 'accuracy': 0.3216574955176953, 'macro avg': {'precision': 0.3256453182040018, 'recall': 0.3298902284087792, 'f1-score': 0.2669861707542746, 'support': 1258839}, 'weighted avg': {'precision': 0.3261925472578499, 'recall': 0.3216574955176953, 'f1-score': 0.2611314137019193, 'support': 1258839}}
[[202391 216516   7155]
 [190915 196560   4778]
 [210527 224033   5964]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218697
{'0': {'precision': 0.3667773527804632, 'recall': 0.35830725894536286, 'f1-score': 0.36249283405754357, 'support': 121767}, '1': {'precision': 0.33637842986796496, 'recall': 0.43159904939738586, 'f1-score': 0.37808559362360217, 'support': 117820}, '2': {'precision': 0.37065715282545325, 'recall': 0.27584531756468134, 'f1-score': 0.3162989925376718, 'support': 119393}, 'accuracy': 0.3549362081453006, 'macro avg': {'precision': 0.3579376451579605, 'recall': 0.35525054196914335, 'f1-score': 0.3522924734062725, 'support': 358980}, 'weighted avg': {'precision': 0.35809057320840054, 'recall': 0.3549362081453006, 'f1-score': 0.35224690841124284, 'support': 358980}}
[[43630 50815 27322]
 [38372 50851 28597]
 [36953 49506 32934]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1270981
{'0': {'precision': 0.38100030752886577, 'recall': 0.3238670120487654, 'f1-score': 0.3501181790155174, 'support': 42079}, '1': {'precision': 0.31532374235309524, 'recall': 0.44263242206990727, 'f1-score': 0.36828650089586157, 'support': 38079}, '2': {'precision': 0.3711897298104195, 'recall': 0.29213562348739397, 'f1-score': 0.32695190259552426, 'support': 42559}, 'accuracy': 0.3497151983832721, 'macro avg': {'precision': 0.35583792656412677, 'recall': 0.35287835253535554, 'f1-score': 0.3484521941689678, 'support': 122717}, 'weighted avg': {'precision': 0.35721854703563727, 'recall': 0.3497151983832721, 'f1-score': 0.34772159150704784, 'support': 122717}}
[[13628 17954 10497]
 [10659 16855 10565]
 [11482 18644 12433]]
training model: results/EXC/W2/deepLOB_L1/h1000
Epoch 1/50
1403/1403 - 56s - loss: 3.2051 - accuracy1000: 0.4357 - val_loss: 3.3787 - val_accuracy1000: 0.3664 - 56s/epoch - 40ms/step
Epoch 2/50
1403/1403 - 53s - loss: 3.1559 - accuracy1000: 0.4540 - val_loss: 3.3321 - val_accuracy1000: 0.3680 - 53s/epoch - 38ms/step
Epoch 3/50
1403/1403 - 52s - loss: 3.1245 - accuracy1000: 0.4662 - val_loss: 3.3792 - val_accuracy1000: 0.3627 - 52s/epoch - 37ms/step
Epoch 4/50
1403/1403 - 56s - loss: 3.1055 - accuracy1000: 0.4735 - val_loss: 3.4170 - val_accuracy1000: 0.3700 - 56s/epoch - 40ms/step
Epoch 5/50
1403/1403 - 51s - loss: 3.0921 - accuracy1000: 0.4781 - val_loss: 3.4126 - val_accuracy1000: 0.3788 - 51s/epoch - 37ms/step
Epoch 6/50
1403/1403 - 51s - loss: 3.0788 - accuracy1000: 0.4828 - val_loss: 3.4598 - val_accuracy1000: 0.3808 - 51s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 52s - loss: 3.0685 - accuracy1000: 0.4833 - val_loss: 3.4609 - val_accuracy1000: 0.4040 - 52s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 53s - loss: 3.0547 - accuracy1000: 0.4882 - val_loss: 3.4430 - val_accuracy1000: 0.4023 - 53s/epoch - 38ms/step
Epoch 9/50
1403/1403 - 54s - loss: 3.0398 - accuracy1000: 0.4907 - val_loss: 3.5191 - val_accuracy1000: 0.4074 - 54s/epoch - 39ms/step
Epoch 10/50
1403/1403 - 53s - loss: 3.0292 - accuracy1000: 0.4944 - val_loss: 3.5203 - val_accuracy1000: 0.4072 - 53s/epoch - 38ms/step
Epoch 11/50
1403/1403 - 50s - loss: 3.0218 - accuracy1000: 0.4970 - val_loss: 3.4971 - val_accuracy1000: 0.4060 - 50s/epoch - 36ms/step
Epoch 12/50
1403/1403 - 55s - loss: 3.0141 - accuracy1000: 0.4985 - val_loss: 3.4704 - val_accuracy1000: 0.3951 - 55s/epoch - 39ms/step
testing model: results/EXC/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
4918/4918 - 78s - 78s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093997
{'0': {'precision': 0.3407807024731644, 'recall': 0.6830297409441555, 'f1-score': 0.4547000988817519, 'support': 414042}, '1': {'precision': 0.383514174611139, 'recall': 0.11882183768448257, 'f1-score': 0.18143178227295992, 'support': 411692}, '2': {'precision': 0.309811259409659, 'recall': 0.21561284215144133, 'f1-score': 0.254268070206011, 'support': 433105}, 'accuracy': 0.33769528907191465, 'macro avg': {'precision': 0.34470204549798744, 'recall': 0.33915480692669314, 'f1-score': 0.2967999837869076, 'support': 1258839}, 'weighted avg': {'precision': 0.34410122874650634, 'recall': 0.33769528907191465, 'f1-score': 0.29637127876979674, 'support': 1258839}}
[[282803  39501  91738]
 [246476  48918 116298]
 [300589  39133  93383]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1100298
{'0': {'precision': 0.32496515774041157, 'recall': 0.4478013983920985, 'f1-score': 0.376620470723146, 'support': 120281}, '1': {'precision': 0.3822264691829909, 'recall': 0.04640563496996064, 'f1-score': 0.08276310538994724, 'support': 120675}, '2': {'precision': 0.37054686362567335, 'recall': 0.5606741001830137, 'f1-score': 0.4462013580305186, 'support': 118024}, 'accuracy': 0.3499777146359129, 'macro avg': {'precision': 0.3592461635163586, 'recall': 0.35162704451502425, 'f1-score': 0.30186164471453725, 'support': 358980}, 'weighted avg': {'precision': 0.3592003352258854, 'recall': 0.3499777146359129, 'f1-score': 0.3007136711298026, 'support': 358980}}
[[53862  4536 61883]
 [64549  5600 50526]
 [47336  4515 66173]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107564
{'0': {'precision': 0.3624448147321045, 'recall': 0.4892521739130435, 'f1-score': 0.41640845487378875, 'support': 43125}, '1': {'precision': 0.43633457645178475, 'recall': 0.045321232914614575, 'f1-score': 0.08211349508722678, 'support': 36142}, '2': {'precision': 0.3662551440329218, 'recall': 0.5120828538550057, 'f1-score': 0.427063339731286, 'support': 43450}, 'accuracy': 0.36659142580082626, 'macro avg': {'precision': 0.38834484507227035, 'recall': 0.34888542022755464, 'f1-score': 0.30852842989743384, 'support': 122717}, 'weighted avg': {'precision': 0.3855555701791346, 'recall': 0.36659142580082626, 'f1-score': 0.32172610695501896, 'support': 122717}}
[[21099  1039 20987]
 [16991  1638 17513]
 [20123  1077 22250]]
training model: results/EXC/W2/deepOF_L1/h10
Epoch 1/50
1403/1403 - 52s - loss: 2.9683 - accuracy10: 0.3855 - val_loss: 3.3113 - val_accuracy10: 0.6648 - 52s/epoch - 37ms/step
Epoch 2/50
1403/1403 - 52s - loss: 2.8621 - accuracy10: 0.4298 - val_loss: 3.2159 - val_accuracy10: 0.6739 - 52s/epoch - 37ms/step
Epoch 3/50
1403/1403 - 46s - loss: 2.7928 - accuracy10: 0.4589 - val_loss: 3.1452 - val_accuracy10: 0.6892 - 46s/epoch - 33ms/step
Epoch 4/50
1403/1403 - 49s - loss: 2.7452 - accuracy10: 0.4772 - val_loss: 3.1158 - val_accuracy10: 0.6915 - 49s/epoch - 35ms/step
Epoch 5/50
1403/1403 - 50s - loss: 2.7099 - accuracy10: 0.4916 - val_loss: 3.0801 - val_accuracy10: 0.6798 - 50s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 50s - loss: 2.6805 - accuracy10: 0.5009 - val_loss: 3.0390 - val_accuracy10: 0.6830 - 50s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 49s - loss: 2.6553 - accuracy10: 0.5057 - val_loss: 2.9978 - val_accuracy10: 0.6805 - 49s/epoch - 35ms/step
Epoch 8/50
1403/1403 - 46s - loss: 2.6353 - accuracy10: 0.5100 - val_loss: 2.9678 - val_accuracy10: 0.6635 - 46s/epoch - 33ms/step
Epoch 9/50
1403/1403 - 48s - loss: 2.6176 - accuracy10: 0.5156 - val_loss: 2.9595 - val_accuracy10: 0.6670 - 48s/epoch - 34ms/step
Epoch 10/50
1403/1403 - 48s - loss: 2.6008 - accuracy10: 0.5178 - val_loss: 2.9549 - val_accuracy10: 0.6433 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 52s - loss: 2.5857 - accuracy10: 0.5233 - val_loss: 2.9250 - val_accuracy10: 0.6572 - 52s/epoch - 37ms/step
Epoch 12/50
1403/1403 - 54s - loss: 2.5685 - accuracy10: 0.5263 - val_loss: 2.9476 - val_accuracy10: 0.6669 - 54s/epoch - 38ms/step
Epoch 13/50
1403/1403 - 49s - loss: 2.5522 - accuracy10: 0.5314 - val_loss: 2.9479 - val_accuracy10: 0.6630 - 49s/epoch - 35ms/step
Epoch 14/50
1403/1403 - 48s - loss: 2.5380 - accuracy10: 0.5343 - val_loss: 2.9287 - val_accuracy10: 0.6684 - 48s/epoch - 34ms/step
Epoch 15/50
1403/1403 - 50s - loss: 2.5221 - accuracy10: 0.5374 - val_loss: 2.9484 - val_accuracy10: 0.6737 - 50s/epoch - 36ms/step
Epoch 16/50
1403/1403 - 46s - loss: 2.5080 - accuracy10: 0.5431 - val_loss: 2.9258 - val_accuracy10: 0.6705 - 46s/epoch - 33ms/step
Epoch 17/50
1403/1403 - 49s - loss: 2.4954 - accuracy10: 0.5454 - val_loss: 2.9571 - val_accuracy10: 0.6828 - 49s/epoch - 35ms/step
Epoch 18/50
1403/1403 - 49s - loss: 2.4821 - accuracy10: 0.5467 - val_loss: 2.9168 - val_accuracy10: 0.6632 - 49s/epoch - 35ms/step
Epoch 19/50
1403/1403 - 49s - loss: 2.4707 - accuracy10: 0.5504 - val_loss: 2.9202 - val_accuracy10: 0.6689 - 49s/epoch - 35ms/step
Epoch 20/50
1403/1403 - 48s - loss: 2.4569 - accuracy10: 0.5533 - val_loss: 2.9174 - val_accuracy10: 0.6625 - 48s/epoch - 34ms/step
Epoch 21/50
1403/1403 - 54s - loss: 2.4406 - accuracy10: 0.5572 - val_loss: 2.9808 - val_accuracy10: 0.6611 - 54s/epoch - 38ms/step
Epoch 22/50
1403/1403 - 48s - loss: 2.4325 - accuracy10: 0.5579 - val_loss: 2.9612 - val_accuracy10: 0.6725 - 48s/epoch - 34ms/step
Epoch 23/50
1403/1403 - 48s - loss: 2.4193 - accuracy10: 0.5612 - val_loss: 2.9925 - val_accuracy10: 0.6703 - 48s/epoch - 34ms/step
Epoch 24/50
1403/1403 - 49s - loss: 2.4093 - accuracy10: 0.5634 - val_loss: 2.9683 - val_accuracy10: 0.6652 - 49s/epoch - 35ms/step
Epoch 25/50
1403/1403 - 51s - loss: 2.4003 - accuracy10: 0.5659 - val_loss: 3.0272 - val_accuracy10: 0.6760 - 51s/epoch - 36ms/step
Epoch 26/50
1403/1403 - 49s - loss: 2.3888 - accuracy10: 0.5679 - val_loss: 2.9961 - val_accuracy10: 0.6692 - 49s/epoch - 35ms/step
Epoch 27/50
1403/1403 - 53s - loss: 2.3780 - accuracy10: 0.5698 - val_loss: 2.9819 - val_accuracy10: 0.6672 - 53s/epoch - 38ms/step
Epoch 28/50
1403/1403 - 46s - loss: 2.3645 - accuracy10: 0.5720 - val_loss: 3.0364 - val_accuracy10: 0.6618 - 46s/epoch - 33ms/step
testing model: results/EXC/W2/deepOF_L1/h10
Evaluating performance on  test set...
4918/4918 - 70s - 70s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7491077
{'0': {'precision': 0.3157363882000222, 'recall': 0.4690365238429076, 'f1-score': 0.37741337831485217, 'support': 145494}, '1': {'precision': 0.857384652139344, 'recall': 0.7013272094480438, 'f1-score': 0.7715437347042428, 'support': 967142}, '2': {'precision': 0.2960241026109837, 'recall': 0.5094255735372577, 'f1-score': 0.3744547989009248, 'support': 146198}, 'accuracy': 0.6521924256891695, 'macro avg': {'precision': 0.48971504765011664, 'recall': 0.5599297689427364, 'f1-score': 0.5078039706400066, 'support': 1258834}, 'weighted avg': {'precision': 0.7295867358664003, 'recall': 0.6521924256891695, 'f1-score': 0.6798738161056893, 'support': 1258834}}
[[ 68242  59445  17807]
 [129552 678283 159307]
 [ 18342  53379  74477]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7271001
{'0': {'precision': 0.29565052100433736, 'recall': 0.47476205011515943, 'f1-score': 0.3643856622580026, 'support': 36037}, '1': {'precision': 0.881985073384082, 'recall': 0.7020651643061466, 'f1-score': 0.7818072694005744, 'support': 286660}, '2': {'precision': 0.28022158841597195, 'recall': 0.5632389824435686, 'f1-score': 0.3742480153098131, 'support': 36283}, 'accuracy': 0.6652153323304919, 'macro avg': {'precision': 0.48595239426813047, 'recall': 0.580022065621625, 'f1-score': 0.5068136489894634, 'support': 358980}, 'weighted avg': {'precision': 0.7623028549061536, 'recall': 0.6652153323304919, 'f1-score': 0.6987104537763837, 'support': 358980}}
[[ 17109  14942   3986]
 [ 36900 201254  48506]
 [  3860  11987  20436]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.72853833
{'0': {'precision': 0.307218830017727, 'recall': 0.46448779035139964, 'f1-score': 0.36982809721398935, 'support': 13432}, '1': {'precision': 0.8718881334584292, 'recall': 0.7059062246363239, 'f1-score': 0.7801666388743539, 'support': 96102}, '2': {'precision': 0.2972236900938986, 'recall': 0.5546957972993476, 'f1-score': 0.38705237805362197, 'support': 13182}, 'accuracy': 0.6632386974803611, 'macro avg': {'precision': 0.49211021785668496, 'recall': 0.5750299374290236, 'f1-score': 0.5123490380473217, 'support': 122716}, 'weighted avg': {'precision': 0.7483519623295889, 'recall': 0.6632386974803611, 'f1-score': 0.6930247871376537, 'support': 122716}}
[[ 6239  5571  1622]
 [12596 67839 15667]
 [ 1473  4397  7312]]
training model: results/EXC/W2/deepOF_L1/h20
Epoch 1/50
1403/1403 - 60s - loss: 2.9888 - accuracy20: 0.4002 - val_loss: 3.2471 - val_accuracy20: 0.6211 - 60s/epoch - 43ms/step
Epoch 2/50
1403/1403 - 45s - loss: 2.8696 - accuracy20: 0.4449 - val_loss: 3.1433 - val_accuracy20: 0.6506 - 45s/epoch - 32ms/step
Epoch 3/50
1403/1403 - 47s - loss: 2.8036 - accuracy20: 0.4716 - val_loss: 3.0871 - val_accuracy20: 0.6451 - 47s/epoch - 33ms/step
Epoch 4/50
1403/1403 - 51s - loss: 2.7575 - accuracy20: 0.4878 - val_loss: 3.0569 - val_accuracy20: 0.6509 - 51s/epoch - 36ms/step
Epoch 5/50
1403/1403 - 49s - loss: 2.7234 - accuracy20: 0.4987 - val_loss: 3.0336 - val_accuracy20: 0.6432 - 49s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 49s - loss: 2.6982 - accuracy20: 0.5020 - val_loss: 3.0052 - val_accuracy20: 0.6349 - 49s/epoch - 35ms/step
Epoch 7/50
1403/1403 - 52s - loss: 2.6776 - accuracy20: 0.5088 - val_loss: 2.9962 - val_accuracy20: 0.6365 - 52s/epoch - 37ms/step
Epoch 8/50
1403/1403 - 50s - loss: 2.6617 - accuracy20: 0.5134 - val_loss: 2.9817 - val_accuracy20: 0.6510 - 50s/epoch - 36ms/step
Epoch 9/50
1403/1403 - 51s - loss: 2.6480 - accuracy20: 0.5160 - val_loss: 2.9612 - val_accuracy20: 0.6405 - 51s/epoch - 36ms/step
Epoch 10/50
1403/1403 - 49s - loss: 2.6344 - accuracy20: 0.5201 - val_loss: 2.9536 - val_accuracy20: 0.6337 - 49s/epoch - 35ms/step
Epoch 11/50
1403/1403 - 51s - loss: 2.6216 - accuracy20: 0.5252 - val_loss: 2.9366 - val_accuracy20: 0.6318 - 51s/epoch - 36ms/step
Epoch 12/50
1403/1403 - 51s - loss: 2.6090 - accuracy20: 0.5302 - val_loss: 2.9298 - val_accuracy20: 0.6370 - 51s/epoch - 36ms/step
Epoch 13/50
1403/1403 - 48s - loss: 2.5967 - accuracy20: 0.5356 - val_loss: 2.9240 - val_accuracy20: 0.6285 - 48s/epoch - 34ms/step
Epoch 14/50
1403/1403 - 47s - loss: 2.5825 - accuracy20: 0.5395 - val_loss: 2.9092 - val_accuracy20: 0.6360 - 47s/epoch - 34ms/step
Epoch 15/50
1403/1403 - 46s - loss: 2.5693 - accuracy20: 0.5442 - val_loss: 2.9113 - val_accuracy20: 0.6346 - 46s/epoch - 33ms/step
Epoch 16/50
1403/1403 - 48s - loss: 2.5591 - accuracy20: 0.5466 - val_loss: 2.8878 - val_accuracy20: 0.6292 - 48s/epoch - 34ms/step
Epoch 17/50
1403/1403 - 49s - loss: 2.5478 - accuracy20: 0.5491 - val_loss: 2.9069 - val_accuracy20: 0.6295 - 49s/epoch - 35ms/step
Epoch 18/50
1403/1403 - 50s - loss: 2.5378 - accuracy20: 0.5521 - val_loss: 2.8959 - val_accuracy20: 0.6204 - 50s/epoch - 36ms/step
Epoch 19/50
1403/1403 - 47s - loss: 2.5293 - accuracy20: 0.5547 - val_loss: 2.8764 - val_accuracy20: 0.6344 - 47s/epoch - 34ms/step
Epoch 20/50
1403/1403 - 48s - loss: 2.5187 - accuracy20: 0.5577 - val_loss: 2.8871 - val_accuracy20: 0.6386 - 48s/epoch - 34ms/step
Epoch 21/50
1403/1403 - 49s - loss: 2.5094 - accuracy20: 0.5598 - val_loss: 2.8792 - val_accuracy20: 0.6313 - 49s/epoch - 35ms/step
Epoch 22/50
1403/1403 - 50s - loss: 2.5003 - accuracy20: 0.5614 - val_loss: 2.8844 - val_accuracy20: 0.6343 - 50s/epoch - 35ms/step
Epoch 23/50
1403/1403 - 50s - loss: 2.4913 - accuracy20: 0.5633 - val_loss: 2.9032 - val_accuracy20: 0.6374 - 50s/epoch - 36ms/step
Epoch 24/50
1403/1403 - 45s - loss: 2.4787 - accuracy20: 0.5657 - val_loss: 2.8852 - val_accuracy20: 0.6292 - 45s/epoch - 32ms/step
Epoch 25/50
1403/1403 - 49s - loss: 2.4708 - accuracy20: 0.5683 - val_loss: 2.8938 - val_accuracy20: 0.6281 - 49s/epoch - 35ms/step
Epoch 26/50
1403/1403 - 51s - loss: 2.4618 - accuracy20: 0.5691 - val_loss: 2.8924 - val_accuracy20: 0.6287 - 51s/epoch - 37ms/step
Epoch 27/50
1403/1403 - 46s - loss: 2.4517 - accuracy20: 0.5712 - val_loss: 2.9092 - val_accuracy20: 0.6338 - 46s/epoch - 33ms/step
Epoch 28/50
1403/1403 - 48s - loss: 2.4411 - accuracy20: 0.5733 - val_loss: 2.9142 - val_accuracy20: 0.6336 - 48s/epoch - 35ms/step
Epoch 29/50
1403/1403 - 49s - loss: 2.4331 - accuracy20: 0.5752 - val_loss: 2.9386 - val_accuracy20: 0.6359 - 49s/epoch - 35ms/step
testing model: results/EXC/W2/deepOF_L1/h20
Evaluating performance on  test set...
4918/4918 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8121711
{'0': {'precision': 0.39421641550262204, 'recall': 0.4522353661124518, 'f1-score': 0.4212374735680794, 'support': 202629}, '1': {'precision': 0.7924442564340493, 'recall': 0.682833306876907, 'f1-score': 0.7335668156195227, 'support': 850455}, '2': {'precision': 0.3774862635958891, 'recall': 0.538595382746051, 'f1-score': 0.4438738827148502, 'support': 205750}, 'accuracy': 0.6221400121064413, 'macro avg': {'precision': 0.5213823118441868, 'recall': 0.5578880185784699, 'f1-score': 0.5328927239674841, 'support': 1258834}, 'weighted avg': {'precision': 0.6605204950750888, 'recall': 0.6221400121064413, 'f1-score': 0.6359436951797521, 'support': 1258834}}
[[ 91636  81697  29296]
 [116285 580719 153451]
 [ 24530  70404 110816]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7856409
{'0': {'precision': 0.3805203056021633, 'recall': 0.45775931333163494, 'f1-score': 0.41558141189866216, 'support': 51029}, '1': {'precision': 0.8223430310227104, 'recall': 0.6910606184634694, 'f1-score': 0.7510076823200735, 'support': 256539}, '2': {'precision': 0.3519735638771354, 'recall': 0.5614447988796389, 'f1-score': 0.43269050599231007, 'support': 51412}, 'accuracy': 0.6393336676137946, 'macro avg': {'precision': 0.5182789668340031, 'recall': 0.5700882435582478, 'f1-score': 0.5330932000703485, 'support': 358980}, 'weighted avg': {'precision': 0.6921730858993793, 'recall': 0.6393336676137946, 'f1-score': 0.6577384477591031, 'support': 358980}}
[[ 23359  20993   6677]
 [ 32788 177284  46467]
 [  5240  17307  28865]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.793326
{'0': {'precision': 0.375854813256181, 'recall': 0.45710934584421814, 'f1-score': 0.4125189444056869, 'support': 18757}, '1': {'precision': 0.812358850017319, 'recall': 0.6861556465769456, 'f1-score': 0.7439429024583665, 'support': 85450}, '2': {'precision': 0.37520285621551447, 'recall': 0.5621049219298719, 'f1-score': 0.45001946450971064, 'support': 18509}, 'accuracy': 0.632435868183448, 'macro avg': {'precision': 0.5211388398296715, 'recall': 0.5684566381170119, 'f1-score': 0.5354937704579213, 'support': 122716}, 'weighted avg': {'precision': 0.6797043754027108, 'recall': 0.632435868183448, 'f1-score': 0.6489532670873815, 'support': 122716}}
[[ 8574  7604  2579]
 [12072 58632 14746]
 [ 2166  5939 10404]]
training model: results/EXC/W2/deepOF_L1/h30
Epoch 1/50
1403/1403 - 52s - loss: 3.0198 - accuracy30: 0.4108 - val_loss: 3.2470 - val_accuracy30: 0.5929 - 52s/epoch - 37ms/step
Epoch 2/50
1403/1403 - 46s - loss: 2.9081 - accuracy30: 0.4522 - val_loss: 3.1457 - val_accuracy30: 0.6092 - 46s/epoch - 32ms/step
Epoch 3/50
1403/1403 - 47s - loss: 2.8487 - accuracy30: 0.4692 - val_loss: 3.0994 - val_accuracy30: 0.6057 - 47s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 47s - loss: 2.8079 - accuracy30: 0.4842 - val_loss: 3.0895 - val_accuracy30: 0.6074 - 47s/epoch - 34ms/step
Epoch 5/50
1403/1403 - 49s - loss: 2.7815 - accuracy30: 0.4919 - val_loss: 3.0634 - val_accuracy30: 0.5989 - 49s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 50s - loss: 2.7610 - accuracy30: 0.4986 - val_loss: 3.0537 - val_accuracy30: 0.6049 - 50s/epoch - 36ms/step
Epoch 7/50
1403/1403 - 47s - loss: 2.7422 - accuracy30: 0.5035 - val_loss: 3.0367 - val_accuracy30: 0.5995 - 47s/epoch - 34ms/step
Epoch 8/50
1403/1403 - 49s - loss: 2.7253 - accuracy30: 0.5081 - val_loss: 3.0234 - val_accuracy30: 0.5970 - 49s/epoch - 35ms/step
Epoch 9/50
1403/1403 - 47s - loss: 2.7140 - accuracy30: 0.5103 - val_loss: 3.0139 - val_accuracy30: 0.6002 - 47s/epoch - 33ms/step
Epoch 10/50
1403/1403 - 48s - loss: 2.6998 - accuracy30: 0.5139 - val_loss: 2.9971 - val_accuracy30: 0.5957 - 48s/epoch - 35ms/step
Epoch 11/50
1403/1403 - 51s - loss: 2.6890 - accuracy30: 0.5191 - val_loss: 2.9954 - val_accuracy30: 0.6068 - 51s/epoch - 37ms/step
Epoch 12/50
1403/1403 - 47s - loss: 2.6750 - accuracy30: 0.5230 - val_loss: 3.0026 - val_accuracy30: 0.5945 - 47s/epoch - 33ms/step
Epoch 13/50
1403/1403 - 46s - loss: 2.6644 - accuracy30: 0.5270 - val_loss: 2.9987 - val_accuracy30: 0.5987 - 46s/epoch - 32ms/step
Epoch 14/50
1403/1403 - 45s - loss: 2.6531 - accuracy30: 0.5290 - val_loss: 2.9907 - val_accuracy30: 0.6014 - 45s/epoch - 32ms/step
Epoch 15/50
1403/1403 - 47s - loss: 2.6425 - accuracy30: 0.5331 - val_loss: 3.0032 - val_accuracy30: 0.6089 - 47s/epoch - 34ms/step
Epoch 16/50
1403/1403 - 45s - loss: 2.6334 - accuracy30: 0.5347 - val_loss: 2.9903 - val_accuracy30: 0.6030 - 45s/epoch - 32ms/step
Epoch 17/50
1403/1403 - 50s - loss: 2.6215 - accuracy30: 0.5382 - val_loss: 2.9975 - val_accuracy30: 0.6024 - 50s/epoch - 36ms/step
Epoch 18/50
1403/1403 - 48s - loss: 2.6142 - accuracy30: 0.5392 - val_loss: 2.9905 - val_accuracy30: 0.5933 - 48s/epoch - 34ms/step
Epoch 19/50
1403/1403 - 49s - loss: 2.6030 - accuracy30: 0.5441 - val_loss: 2.9961 - val_accuracy30: 0.6002 - 49s/epoch - 35ms/step
Epoch 20/50
1403/1403 - 52s - loss: 2.5925 - accuracy30: 0.5475 - val_loss: 2.9997 - val_accuracy30: 0.6077 - 52s/epoch - 37ms/step
Epoch 21/50
1403/1403 - 49s - loss: 2.5826 - accuracy30: 0.5496 - val_loss: 2.9922 - val_accuracy30: 0.6039 - 49s/epoch - 35ms/step
Epoch 22/50
1403/1403 - 51s - loss: 2.5744 - accuracy30: 0.5515 - val_loss: 3.0073 - val_accuracy30: 0.6072 - 51s/epoch - 37ms/step
Epoch 23/50
1403/1403 - 55s - loss: 2.5624 - accuracy30: 0.5554 - val_loss: 3.0104 - val_accuracy30: 0.6049 - 55s/epoch - 39ms/step
Epoch 24/50
1403/1403 - 50s - loss: 2.5527 - accuracy30: 0.5579 - val_loss: 2.9986 - val_accuracy30: 0.6077 - 50s/epoch - 36ms/step
Epoch 25/50
1403/1403 - 44s - loss: 2.5427 - accuracy30: 0.5600 - val_loss: 3.0113 - val_accuracy30: 0.6037 - 44s/epoch - 32ms/step
Epoch 26/50
1403/1403 - 46s - loss: 2.5331 - accuracy30: 0.5625 - val_loss: 3.0368 - val_accuracy30: 0.6124 - 46s/epoch - 32ms/step
testing model: results/EXC/W2/deepOF_L1/h30
Evaluating performance on  test set...
4918/4918 - 76s - 76s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.87912536
{'0': {'precision': 0.4170145830216819, 'recall': 0.37807724870334297, 'f1-score': 0.39659249391593754, 'support': 243318}, '1': {'precision': 0.6983754965226916, 'recall': 0.6902079852674385, 'f1-score': 0.6942677206467402, 'support': 766737}, '2': {'precision': 0.424527124596652, 'recall': 0.4785974700436934, 'f1-score': 0.44994369326813344, 'support': 248779}, 'accuracy': 0.5880568843866626, 'macro avg': {'precision': 0.5133057347136751, 'recall': 0.515627568004825, 'f1-score': 0.5136013026102705, 'support': 1258834}, 'weighted avg': {'precision': 0.5898719933835749, 'recall': 0.5880568843866626, 'f1-score': 0.5884456440068434, 'support': 1258834}}
[[ 91993 124120  27205]
 [103334 529208 134195]
 [ 25272 104442 119065]]
Evaluating performance on  train set...
1403/1403 - 24s - 24s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8390877
{'0': {'precision': 0.4293819576233052, 'recall': 0.35245467246944706, 'f1-score': 0.3871337602088515, 'support': 62269}, '1': {'precision': 0.7389359729709544, 'recall': 0.7183181002818826, 'f1-score': 0.7284811812529371, 'support': 234140}, '2': {'precision': 0.4041490156989783, 'recall': 0.5184030940851193, 'f1-score': 0.4542011188047413, 'support': 62571}, 'accuracy': 0.620009471279737, 'macro avg': {'precision': 0.5241556487644127, 'recall': 0.529725288945483, 'f1-score': 0.5232720200888433, 'support': 358980}, 'weighted avg': {'precision': 0.6268863499135485, 'recall': 0.620009471279737, 'f1-score': 0.6214631291373869, 'support': 358980}}
[[ 21947  34157   6165]
 [ 24295 168187  41658]
 [  4871  25263  32437]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85951847
{'0': {'precision': 0.41129571278525734, 'recall': 0.3796157574689345, 'f1-score': 0.39482126489459207, 'support': 22694}, '1': {'precision': 0.7268604383554226, 'recall': 0.6932880533030319, 'f1-score': 0.7096774193548386, 'support': 77444}, '2': {'precision': 0.42493638676844786, 'recall': 0.5251572327044025, 'f1-score': 0.469760900140647, 'support': 22578}, 'accuracy': 0.6043466214674533, 'macro avg': {'precision': 0.5210308459697093, 'recall': 0.532687014492123, 'f1-score': 0.5247531947966926, 'support': 122716}, 'weighted avg': {'precision': 0.612952984406304, 'recall': 0.6043466214674533, 'f1-score': 0.6073095069380482, 'support': 122716}}
[[ 8615 11612  2467]
 [10174 53691 13579]
 [ 2157  8564 11857]]
training model: results/EXC/W2/deepOF_L1/h50
Epoch 1/50
1403/1403 - 52s - loss: 3.0980 - accuracy50: 0.4180 - val_loss: 3.3152 - val_accuracy50: 0.5311 - 52s/epoch - 37ms/step
Epoch 2/50
1403/1403 - 49s - loss: 3.0033 - accuracy50: 0.4492 - val_loss: 3.2043 - val_accuracy50: 0.5378 - 49s/epoch - 35ms/step
Epoch 3/50
1403/1403 - 50s - loss: 2.9575 - accuracy50: 0.4630 - val_loss: 3.1554 - val_accuracy50: 0.5418 - 50s/epoch - 36ms/step
Epoch 4/50
1403/1403 - 47s - loss: 2.9275 - accuracy50: 0.4707 - val_loss: 3.1471 - val_accuracy50: 0.5466 - 47s/epoch - 34ms/step
Epoch 5/50
1403/1403 - 50s - loss: 2.9086 - accuracy50: 0.4772 - val_loss: 3.1317 - val_accuracy50: 0.5456 - 50s/epoch - 36ms/step
Epoch 6/50
1403/1403 - 46s - loss: 2.8889 - accuracy50: 0.4841 - val_loss: 3.1469 - val_accuracy50: 0.5430 - 46s/epoch - 33ms/step
Epoch 7/50
1403/1403 - 48s - loss: 2.8779 - accuracy50: 0.4872 - val_loss: 3.1192 - val_accuracy50: 0.5433 - 48s/epoch - 34ms/step
Epoch 8/50
1403/1403 - 49s - loss: 2.8645 - accuracy50: 0.4923 - val_loss: 3.1250 - val_accuracy50: 0.5452 - 49s/epoch - 35ms/step
Epoch 9/50
1403/1403 - 50s - loss: 2.8548 - accuracy50: 0.4952 - val_loss: 3.1312 - val_accuracy50: 0.5483 - 50s/epoch - 35ms/step
Epoch 10/50
1403/1403 - 51s - loss: 2.8433 - accuracy50: 0.4983 - val_loss: 3.1290 - val_accuracy50: 0.5525 - 51s/epoch - 36ms/step
Epoch 11/50
1403/1403 - 48s - loss: 2.8345 - accuracy50: 0.5012 - val_loss: 3.1536 - val_accuracy50: 0.5488 - 48s/epoch - 34ms/step
Epoch 12/50
1403/1403 - 49s - loss: 2.8244 - accuracy50: 0.5028 - val_loss: 3.1472 - val_accuracy50: 0.5522 - 49s/epoch - 35ms/step
Epoch 13/50
1403/1403 - 47s - loss: 2.8142 - accuracy50: 0.5066 - val_loss: 3.1505 - val_accuracy50: 0.5532 - 47s/epoch - 33ms/step
Epoch 14/50
1403/1403 - 46s - loss: 2.8065 - accuracy50: 0.5083 - val_loss: 3.1496 - val_accuracy50: 0.5499 - 46s/epoch - 33ms/step
Epoch 15/50
1403/1403 - 45s - loss: 2.7965 - accuracy50: 0.5120 - val_loss: 3.1635 - val_accuracy50: 0.5593 - 45s/epoch - 32ms/step
Epoch 16/50
1403/1403 - 50s - loss: 2.7876 - accuracy50: 0.5152 - val_loss: 3.1503 - val_accuracy50: 0.5563 - 50s/epoch - 36ms/step
Epoch 17/50
1403/1403 - 46s - loss: 2.7776 - accuracy50: 0.5179 - val_loss: 3.1558 - val_accuracy50: 0.5550 - 46s/epoch - 33ms/step
testing model: results/EXC/W2/deepOF_L1/h50
Evaluating performance on  test set...
4918/4918 - 83s - 83s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96955866
{'0': {'precision': 0.5067249696791702, 'recall': 0.3021664396445482, 'f1-score': 0.3785805565544577, 'support': 308340}, '1': {'precision': 0.563703983238101, 'recall': 0.7005281815239103, 'f1-score': 0.6247120383460721, 'support': 633305}, '2': {'precision': 0.45987414219431555, 'recall': 0.417473493721409, 'f1-score': 0.43764924405048145, 'support': 317189}, 'accuracy': 0.5316316527834488, 'macro avg': {'precision': 0.5101010317038622, 'recall': 0.4733893716299558, 'f1-score': 0.4803139463170038, 'support': 1258834}, 'weighted avg': {'precision': 0.5235854350485876, 'recall': 0.5316316527834488, 'f1-score': 0.5172900575642927, 'support': 1258834}}
[[ 93170 181717  33453]
 [ 67584 443648 122073]
 [ 23113 161658 132418]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93871284
{'0': {'precision': 0.4849739000745712, 'recall': 0.32273432169220273, 'f1-score': 0.3875600581027226, 'support': 80605}, '1': {'precision': 0.6145792263547554, 'recall': 0.7087787725077299, 'f1-score': 0.658326333522602, 'support': 197932}, '2': {'precision': 0.4487738419618529, 'recall': 0.42995661524309137, 'f1-score': 0.43916375156336307, 'support': 80443}, 'accuracy': 0.559616134603599, 'macro avg': {'precision': 0.5161089894637265, 'recall': 0.48715656981434136, 'f1-score': 0.4950167143962292, 'support': 358980}, 'weighted avg': {'precision': 0.5483228336266577, 'recall': 0.559616134603599, 'f1-score': 0.5484171151517556, 'support': 358980}}
[[ 26014  47419   7172]
 [ 22331 140290  35311]
 [  5295  40561  34587]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9572508
{'0': {'precision': 0.48428175618073316, 'recall': 0.31244413887933997, 'f1-score': 0.3798320030089014, 'support': 29090}, '1': {'precision': 0.5918137740751654, 'recall': 0.6855644510643579, 'f1-score': 0.6352487887631726, 'support': 64452}, '2': {'precision': 0.4584443078604111, 'recall': 0.46020429149242476, 'f1-score': 0.4593226137529935, 'support': 29174}, 'accuracy': 0.5435395547442876, 'macro avg': {'precision': 0.5115132793721032, 'recall': 0.4860709604787075, 'f1-score': 0.49146780184168914, 'support': 122716}, 'weighted avg': {'precision': 0.5346164468489009, 'recall': 0.5435395547442876, 'f1-score': 0.5328779118820918, 'support': 122716}}
[[ 9089 16807  3194]
 [ 7600 44186 12666]
 [ 2079 13669 13426]]
training model: results/EXC/W2/deepOF_L1/h100
Epoch 1/50
1403/1403 - 54s - loss: 3.2200 - accuracy100: 0.4153 - val_loss: 3.3810 - val_accuracy100: 0.4019 - 54s/epoch - 38ms/step
Epoch 2/50
1403/1403 - 51s - loss: 3.1646 - accuracy100: 0.4325 - val_loss: 3.2902 - val_accuracy100: 0.4224 - 51s/epoch - 36ms/step
Epoch 3/50
1403/1403 - 47s - loss: 3.1377 - accuracy100: 0.4445 - val_loss: 3.2765 - val_accuracy100: 0.4273 - 47s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 48s - loss: 3.1200 - accuracy100: 0.4508 - val_loss: 3.2802 - val_accuracy100: 0.4322 - 48s/epoch - 34ms/step
Epoch 5/50
1403/1403 - 52s - loss: 3.1070 - accuracy100: 0.4555 - val_loss: 3.3089 - val_accuracy100: 0.4302 - 52s/epoch - 37ms/step
Epoch 6/50
1403/1403 - 48s - loss: 3.0943 - accuracy100: 0.4596 - val_loss: 3.2983 - val_accuracy100: 0.4322 - 48s/epoch - 34ms/step
Epoch 7/50
1403/1403 - 47s - loss: 3.0833 - accuracy100: 0.4643 - val_loss: 3.2940 - val_accuracy100: 0.4351 - 47s/epoch - 33ms/step
Epoch 8/50
1403/1403 - 47s - loss: 3.0743 - accuracy100: 0.4676 - val_loss: 3.3157 - val_accuracy100: 0.4325 - 47s/epoch - 33ms/step
Epoch 9/50
1403/1403 - 49s - loss: 3.0652 - accuracy100: 0.4703 - val_loss: 3.3460 - val_accuracy100: 0.4314 - 49s/epoch - 35ms/step
Epoch 10/50
1403/1403 - 48s - loss: 3.0558 - accuracy100: 0.4726 - val_loss: 3.3589 - val_accuracy100: 0.4311 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 49s - loss: 3.0471 - accuracy100: 0.4762 - val_loss: 3.3760 - val_accuracy100: 0.4312 - 49s/epoch - 35ms/step
Epoch 12/50
1403/1403 - 49s - loss: 3.0425 - accuracy100: 0.4774 - val_loss: 3.3930 - val_accuracy100: 0.4307 - 49s/epoch - 35ms/step
Epoch 13/50
1403/1403 - 51s - loss: 3.0355 - accuracy100: 0.4798 - val_loss: 3.4115 - val_accuracy100: 0.4301 - 51s/epoch - 36ms/step
testing model: results/EXC/W2/deepOF_L1/h100
Evaluating performance on  test set...
4918/4918 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0816928
{'0': {'precision': 0.5267944242443787, 'recall': 0.159621454186576, 'f1-score': 0.24500509005555005, 'support': 409356}, '1': {'precision': 0.36512014975122403, 'recall': 0.7713860661204046, 'f1-score': 0.4956393410693016, 'support': 428854}, '2': {'precision': 0.5165609522602191, 'recall': 0.2809373692418882, 'f1-score': 0.36394126750694883, 'support': 420624}, 'accuracy': 0.40857094740053096, 'macro avg': {'precision': 0.4694918420852739, 'recall': 0.403981629849623, 'f1-score': 0.36819523287726685, 'support': 1258834}, 'weighted avg': {'precision': 0.4682965577795768, 'recall': 0.40857094740053096, 'f1-score': 0.3701311287457733, 'support': 1258834}}
[[ 65342 298413  45601]
 [ 33051 330812  64991]
 [ 25644 276811 118169]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0533376
{'0': {'precision': 0.5331720158481134, 'recall': 0.1813749434644957, 'f1-score': 0.27067232732844215, 'support': 110550}, '1': {'precision': 0.41160911039333475, 'recall': 0.7892497702787766, 'f1-score': 0.5410500784917677, 'support': 138211}, '2': {'precision': 0.5151622691058786, 'recall': 0.26341193442147, 'f1-score': 0.34858563058303715, 'support': 110219}, 'accuracy': 0.4406011476962505, 'macro avg': {'precision': 0.4866477984491089, 'recall': 0.4113455493882474, 'f1-score': 0.386769345467749, 'support': 358980}, 'weighted avg': {'precision': 0.48083944299727827, 'recall': 0.4406011476962505, 'f1-score': 0.39869256727900376, 'support': 358980}}
[[ 20051  80992   9507]
 [ 11311 109083  17817]
 [  6245  74941  29033]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0691116
{'0': {'precision': 0.5269201520912548, 'recall': 0.17744372455120488, 'f1-score': 0.2654840131036993, 'support': 39049}, '1': {'precision': 0.38845950238221283, 'recall': 0.751604679746893, 'f1-score': 0.5121956894345389, 'support': 43934}, '2': {'precision': 0.5139448719514678, 'recall': 0.31769561825183096, 'f1-score': 0.3926649454070364, 'support': 39733}, 'accuracy': 0.4284119430229147, 'macro avg': {'precision': 0.4764415088083118, 'recall': 0.4155813408499763, 'f1-score': 0.39011488264842487, 'support': 122716}, 'weighted avg': {'precision': 0.4731482153420843, 'recall': 0.4284119430229147, 'f1-score': 0.39498881093876237, 'support': 122716}}
[[ 6929 27352  4768]
 [ 3743 33021  7170]
 [ 2478 24632 12623]]
training model: results/EXC/W2/deepOF_L1/h200
Epoch 1/50
1403/1403 - 55s - loss: 3.2863 - accuracy200: 0.3803 - val_loss: 3.3370 - val_accuracy200: 0.3438 - 55s/epoch - 39ms/step
Epoch 2/50
1403/1403 - 48s - loss: 3.2562 - accuracy200: 0.3954 - val_loss: 3.2922 - val_accuracy200: 0.3659 - 48s/epoch - 34ms/step
Epoch 3/50
1403/1403 - 49s - loss: 3.2457 - accuracy200: 0.3996 - val_loss: 3.2708 - val_accuracy200: 0.3785 - 49s/epoch - 35ms/step
Epoch 4/50
1403/1403 - 46s - loss: 3.2382 - accuracy200: 0.4031 - val_loss: 3.2614 - val_accuracy200: 0.3856 - 46s/epoch - 33ms/step
Epoch 5/50
1403/1403 - 50s - loss: 3.2322 - accuracy200: 0.4067 - val_loss: 3.2635 - val_accuracy200: 0.3881 - 50s/epoch - 36ms/step
Epoch 6/50
1403/1403 - 48s - loss: 3.2277 - accuracy200: 0.4098 - val_loss: 3.2674 - val_accuracy200: 0.3871 - 48s/epoch - 34ms/step
Epoch 7/50
1403/1403 - 50s - loss: 3.2228 - accuracy200: 0.4123 - val_loss: 3.2685 - val_accuracy200: 0.3904 - 50s/epoch - 35ms/step
Epoch 8/50
1403/1403 - 48s - loss: 3.2187 - accuracy200: 0.4145 - val_loss: 3.2664 - val_accuracy200: 0.3919 - 48s/epoch - 34ms/step
Epoch 9/50
1403/1403 - 49s - loss: 3.2138 - accuracy200: 0.4175 - val_loss: 3.2740 - val_accuracy200: 0.3894 - 49s/epoch - 35ms/step
Epoch 10/50
1403/1403 - 48s - loss: 3.2103 - accuracy200: 0.4199 - val_loss: 3.2796 - val_accuracy200: 0.3872 - 48s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 47s - loss: 3.2070 - accuracy200: 0.4212 - val_loss: 3.2824 - val_accuracy200: 0.3902 - 47s/epoch - 34ms/step
Epoch 12/50
1403/1403 - 46s - loss: 3.2022 - accuracy200: 0.4239 - val_loss: 3.2873 - val_accuracy200: 0.3884 - 46s/epoch - 33ms/step
Epoch 13/50
1403/1403 - 47s - loss: 3.1990 - accuracy200: 0.4258 - val_loss: 3.2905 - val_accuracy200: 0.3884 - 47s/epoch - 33ms/step
Epoch 14/50
1403/1403 - 45s - loss: 3.1962 - accuracy200: 0.4274 - val_loss: 3.2942 - val_accuracy200: 0.3876 - 45s/epoch - 32ms/step
testing model: results/EXC/W2/deepOF_L1/h200
Evaluating performance on  test set...
4918/4918 - 74s - 74s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0949701
{'0': {'precision': 0.439247311827957, 'recall': 0.24622182451276084, 'f1-score': 0.31555694865551825, 'support': 431359}, '1': {'precision': 0.32197708332162583, 'recall': 0.5941914006595731, 'f1-score': 0.41764373576309793, 'support': 385704}, '2': {'precision': 0.4482862553155243, 'recall': 0.30973966149883086, 'f1-score': 0.3663516771551614, 'support': 441771}, 'accuracy': 0.3751296835007634, 'macro avg': {'precision': 0.4031702168217024, 'recall': 0.38338429555705494, 'f1-score': 0.3665174538579259, 'support': 1258834}, 'weighted avg': {'precision': 0.4064880654838323, 'recall': 0.3751296835007634, 'f1-score': 0.364661850603319, 'support': 1258834}}
[[106210 243097  82052]
 [ 70170 229182  86352]
 [ 65420 239517 136834]]
Evaluating performance on  train set...
1403/1403 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869113
{'0': {'precision': 0.4489125493129189, 'recall': 0.2520378756689996, 'f1-score': 0.3228272963609422, 'support': 121450}, '1': {'precision': 0.34131529293523094, 'recall': 0.620224157685714, 'f1-score': 0.4403188864051277, 'support': 116079}, '2': {'precision': 0.45222204134787564, 'recall': 0.29735448864150976, 'f1-score': 0.35878992598479953, 'support': 121451}, 'accuracy': 0.3864254276004234, 'macro avg': {'precision': 0.4141499611986752, 'recall': 0.38987217399874113, 'f1-score': 0.3739787029169565, 'support': 358980}, 'weighted avg': {'precision': 0.4152398076394883, 'recall': 0.3864254276004234, 'f1-score': 0.37298608963963764, 'support': 358980}}
[[30610 70772 20068]
 [20407 71995 23677]
 [17170 68167 36114]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0893387
{'0': {'precision': 0.4400615360340815, 'recall': 0.26699215010530347, 'f1-score': 0.33234527444700973, 'support': 41784}, '1': {'precision': 0.33319802143941785, 'recall': 0.575218023255814, 'f1-score': 0.42196856465570587, 'support': 38528}, '2': {'precision': 0.45527032283158303, 'recall': 0.33124233562871425, 'f1-score': 0.3834771213279458, 'support': 42404}, 'accuracy': 0.385964340428306, 'macro avg': {'precision': 0.4095099601016941, 'recall': 0.39115083632994385, 'f1-score': 0.3792636534768871, 'support': 122716}, 'weighted avg': {'precision': 0.4117659258859187, 'recall': 0.385964340428306, 'f1-score': 0.3781518600617613, 'support': 122716}}
[[11156 22707  7921]
 [ 7481 22162  8885]
 [ 6714 21644 14046]]
training model: results/EXC/W2/deepOF_L1/h300
Epoch 1/50
1403/1403 - 59s - loss: 3.2991 - accuracy300: 0.3695 - val_loss: 3.3015 - val_accuracy300: 0.3420 - 59s/epoch - 42ms/step
Epoch 2/50
1403/1403 - 51s - loss: 3.2778 - accuracy300: 0.3792 - val_loss: 3.2860 - val_accuracy300: 0.3659 - 51s/epoch - 37ms/step
Epoch 3/50
1403/1403 - 48s - loss: 3.2716 - accuracy300: 0.3801 - val_loss: 3.2793 - val_accuracy300: 0.3770 - 48s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 44s - loss: 3.2676 - accuracy300: 0.3825 - val_loss: 3.2760 - val_accuracy300: 0.3808 - 44s/epoch - 31ms/step
Epoch 5/50
1403/1403 - 45s - loss: 3.2639 - accuracy300: 0.3852 - val_loss: 3.2755 - val_accuracy300: 0.3841 - 45s/epoch - 32ms/step
Epoch 6/50
1403/1403 - 45s - loss: 3.2608 - accuracy300: 0.3864 - val_loss: 3.2747 - val_accuracy300: 0.3869 - 45s/epoch - 32ms/step
Epoch 7/50
1403/1403 - 49s - loss: 3.2581 - accuracy300: 0.3895 - val_loss: 3.2750 - val_accuracy300: 0.3883 - 49s/epoch - 35ms/step
Epoch 8/50
1403/1403 - 49s - loss: 3.2555 - accuracy300: 0.3912 - val_loss: 3.2752 - val_accuracy300: 0.3891 - 49s/epoch - 35ms/step
Epoch 9/50
1403/1403 - 47s - loss: 3.2535 - accuracy300: 0.3926 - val_loss: 3.2755 - val_accuracy300: 0.3902 - 47s/epoch - 34ms/step
Epoch 10/50
1403/1403 - 49s - loss: 3.2503 - accuracy300: 0.3946 - val_loss: 3.2762 - val_accuracy300: 0.3895 - 49s/epoch - 35ms/step
Epoch 11/50
1403/1403 - 48s - loss: 3.2479 - accuracy300: 0.3964 - val_loss: 3.2781 - val_accuracy300: 0.3880 - 48s/epoch - 34ms/step
Epoch 12/50
1403/1403 - 48s - loss: 3.2452 - accuracy300: 0.3990 - val_loss: 3.2808 - val_accuracy300: 0.3888 - 48s/epoch - 34ms/step
Epoch 13/50
1403/1403 - 46s - loss: 3.2425 - accuracy300: 0.4005 - val_loss: 3.2837 - val_accuracy300: 0.3872 - 46s/epoch - 33ms/step
Epoch 14/50
1403/1403 - 47s - loss: 3.2401 - accuracy300: 0.4022 - val_loss: 3.2872 - val_accuracy300: 0.3883 - 47s/epoch - 33ms/step
Epoch 15/50
1403/1403 - 49s - loss: 3.2372 - accuracy300: 0.4041 - val_loss: 3.2945 - val_accuracy300: 0.3844 - 49s/epoch - 35ms/step
Epoch 16/50
1403/1403 - 50s - loss: 3.2346 - accuracy300: 0.4058 - val_loss: 3.2930 - val_accuracy300: 0.3855 - 50s/epoch - 36ms/step
testing model: results/EXC/W2/deepOF_L1/h300
Evaluating performance on  test set...
4918/4918 - 75s - 75s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092548
{'0': {'precision': 0.3826160187056632, 'recall': 0.4601798383694909, 'f1-score': 0.41782876877585173, 'support': 419599}, '1': {'precision': 0.3221423847753758, 'recall': 0.23045829370409954, 'f1-score': 0.2686945102180508, 'support': 407948}, '2': {'precision': 0.3999731793887929, 'recall': 0.42876321335908574, 'f1-score': 0.41386811814444213, 'support': 431287}, 'accuracy': 0.37497080631759233, 'macro avg': {'precision': 0.3682438609566106, 'recall': 0.373133781810892, 'f1-score': 0.36679713237944817, 'support': 1258834}, 'weighted avg': {'precision': 0.36896514793553153, 'recall': 0.37497080631759233, 'f1-score': 0.36814215430642483, 'support': 1258834}}
[[193091  97885 128623]
 [165145  94015 148788]
 [146424  99943 184920]]
Evaluating performance on  train set...
1403/1403 - 21s - 21s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0901395
{'0': {'precision': 0.39392377009442164, 'recall': 0.42379686892018315, 'f1-score': 0.4083146551380325, 'support': 120789}, '1': {'precision': 0.3305432604199042, 'recall': 0.26199456337071014, 'f1-score': 0.29230382842006, 'support': 117720}, '2': {'precision': 0.3957369367245292, 'recall': 0.4458417378456226, 'f1-score': 0.4192978005035227, 'support': 120471}, 'accuracy': 0.3781352721600089, 'macro avg': {'precision': 0.3734013224129517, 'recall': 0.377211056712172, 'f1-score': 0.37330542802053834, 'support': 358980}, 'weighted avg': {'precision': 0.3737479396810601, 'recall': 0.3781352721600089, 'f1-score': 0.3739571867110623, 'support': 358980}}
[[51190 31724 37875]
 [42740 30842 44138]
 [36019 30741 53711]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926886
{'0': {'precision': 0.4067567298700782, 'recall': 0.4731421694554375, 'f1-score': 0.4374451695731251, 'support': 43209}, '1': {'precision': 0.3045812581682032, 'recall': 0.23972755073672505, 'f1-score': 0.26829078576873416, 'support': 35970}, '2': {'precision': 0.42118974266038417, 'recall': 0.42706203918506097, 'f1-score': 0.4241055644894561, 'support': 43537}, 'accuracy': 0.3883764138335669, 'macro avg': {'precision': 0.3775092435662219, 'recall': 0.3799772531257412, 'f1-score': 0.3766138399437718, 'support': 122716}, 'weighted avg': {'precision': 0.38192800631923807, 'recall': 0.3883764138335669, 'f1-score': 0.38313073973535633, 'support': 122716}}
[[20444  9868 12897]
 [14693  8623 12654]
 [15124  9820 18593]]
training model: results/EXC/W2/deepOF_L1/h500
Epoch 1/50
1403/1403 - 57s - loss: 3.3103 - accuracy500: 0.3561 - val_loss: 3.3236 - val_accuracy500: 0.3172 - 57s/epoch - 40ms/step
Epoch 2/50
1403/1403 - 53s - loss: 3.2906 - accuracy500: 0.3623 - val_loss: 3.3097 - val_accuracy500: 0.3188 - 53s/epoch - 38ms/step
Epoch 3/50
1403/1403 - 48s - loss: 3.2850 - accuracy500: 0.3664 - val_loss: 3.3004 - val_accuracy500: 0.3275 - 48s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 47s - loss: 3.2812 - accuracy500: 0.3678 - val_loss: 3.2961 - val_accuracy500: 0.3333 - 47s/epoch - 33ms/step
Epoch 5/50
1403/1403 - 50s - loss: 3.2782 - accuracy500: 0.3710 - val_loss: 3.2927 - val_accuracy500: 0.3451 - 50s/epoch - 35ms/step
Epoch 6/50
1403/1403 - 49s - loss: 3.2756 - accuracy500: 0.3730 - val_loss: 3.2919 - val_accuracy500: 0.3483 - 49s/epoch - 35ms/step
Epoch 7/50
1403/1403 - 49s - loss: 3.2735 - accuracy500: 0.3749 - val_loss: 3.2917 - val_accuracy500: 0.3474 - 49s/epoch - 35ms/step
Epoch 8/50
1403/1403 - 50s - loss: 3.2720 - accuracy500: 0.3763 - val_loss: 3.2906 - val_accuracy500: 0.3497 - 50s/epoch - 35ms/step
Epoch 9/50
1403/1403 - 47s - loss: 3.2702 - accuracy500: 0.3777 - val_loss: 3.2917 - val_accuracy500: 0.3496 - 47s/epoch - 33ms/step
Epoch 10/50
1403/1403 - 47s - loss: 3.2678 - accuracy500: 0.3787 - val_loss: 3.2915 - val_accuracy500: 0.3519 - 47s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 48s - loss: 3.2665 - accuracy500: 0.3818 - val_loss: 3.2922 - val_accuracy500: 0.3510 - 48s/epoch - 34ms/step
Epoch 12/50
1403/1403 - 49s - loss: 3.2648 - accuracy500: 0.3828 - val_loss: 3.2918 - val_accuracy500: 0.3534 - 49s/epoch - 35ms/step
Epoch 13/50
1403/1403 - 46s - loss: 3.2632 - accuracy500: 0.3843 - val_loss: 3.2931 - val_accuracy500: 0.3507 - 46s/epoch - 33ms/step
Epoch 14/50
1403/1403 - 50s - loss: 3.2618 - accuracy500: 0.3855 - val_loss: 3.2937 - val_accuracy500: 0.3509 - 50s/epoch - 36ms/step
Epoch 15/50
1403/1403 - 51s - loss: 3.2601 - accuracy500: 0.3876 - val_loss: 3.2936 - val_accuracy500: 0.3540 - 51s/epoch - 36ms/step
Epoch 16/50
1403/1403 - 47s - loss: 3.2585 - accuracy500: 0.3884 - val_loss: 3.2948 - val_accuracy500: 0.3536 - 47s/epoch - 34ms/step
Epoch 17/50
1403/1403 - 44s - loss: 3.2573 - accuracy500: 0.3890 - val_loss: 3.2961 - val_accuracy500: 0.3543 - 44s/epoch - 31ms/step
Epoch 18/50
1403/1403 - 45s - loss: 3.2552 - accuracy500: 0.3903 - val_loss: 3.2973 - val_accuracy500: 0.3534 - 45s/epoch - 32ms/step
testing model: results/EXC/W2/deepOF_L1/h500
Evaluating performance on  test set...
4918/4918 - 73s - 73s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0982845
{'0': {'precision': 0.3851347021340028, 'recall': 0.32442772279086796, 'f1-score': 0.35218430399355893, 'support': 426061}, '1': {'precision': 0.3138330788052889, 'recall': 0.5637127058301658, 'f1-score': 0.40319649898570875, 'support': 392253}, '2': {'precision': 0.40413290403820656, 'recall': 0.17922228275674204, 'f1-score': 0.24832082833369243, 'support': 440520}, 'accuracy': 0.34817537498987156, 'macro avg': {'precision': 0.36770022832583277, 'recall': 0.3557875704592586, 'f1-score': 0.33456721043765336, 'support': 1258834}, 'weighted avg': {'precision': 0.3695653834210365, 'recall': 0.34817537498987156, 'f1-score': 0.3317334329689213, 'support': 1258834}}
[[138226 231580  56255]
 [110982 221118  60153]
 [109695 251874  78951]]
Evaluating performance on  train set...
1403/1403 - 22s - 22s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0939554
{'0': {'precision': 0.3881101376720901, 'recall': 0.30564020008049214, 'f1-score': 0.3419733401951009, 'support': 121751}, '1': {'precision': 0.3316780278629734, 'recall': 0.5855668528168656, 'f1-score': 0.4234848577847068, 'support': 117826}, '2': {'precision': 0.3927598852619731, 'recall': 0.18118472735190908, 'f1-score': 0.24797547067083128, 'support': 119403}, 'accuracy': 0.35612290378294054, 'macro avg': {'precision': 0.3708493502656789, 'recall': 0.35746392674975563, 'f1-score': 0.3378112228835463, 'support': 358980}, 'weighted avg': {'precision': 0.37113432854931394, 'recall': 0.35612290378294054, 'f1-score': 0.33746208178712983, 'support': 358980}}
[[37212 68949 15590]
 [30973 68995 17858]
 [27695 70074 21634]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978985
{'0': {'precision': 0.38932347631737296, 'recall': 0.3227775930061291, 'f1-score': 0.3529411764705882, 'support': 42094}, '1': {'precision': 0.3135739454490089, 'recall': 0.5679728948889006, 'f1-score': 0.40406588375982144, 'support': 38074}, '2': {'precision': 0.40686326508963616, 'recall': 0.18029049544044373, 'f1-score': 0.24986156802710013, 'support': 42548}, 'accuracy': 0.3494491345871769, 'macro avg': {'precision': 0.36992022895200605, 'recall': 0.3570136611118245, 'f1-score': 0.33562287608583663, 'support': 122716}, 'weighted avg': {'precision': 0.3719027267362276, 'recall': 0.3494491345871769, 'f1-score': 0.33306349894913, 'support': 122716}}
[[13587 23025  5482]
 [10748 21625  5701]
 [10564 24313  7671]]
training model: results/EXC/W2/deepOF_L1/h1000
Epoch 1/50
1403/1403 - 55s - loss: 3.2776 - accuracy1000: 0.3924 - val_loss: 3.2904 - val_accuracy1000: 0.3600 - 55s/epoch - 39ms/step
Epoch 2/50
1403/1403 - 48s - loss: 3.2779 - accuracy1000: 0.3807 - val_loss: 3.2880 - val_accuracy1000: 0.3614 - 48s/epoch - 35ms/step
Epoch 3/50
1403/1403 - 48s - loss: 3.2830 - accuracy1000: 0.3724 - val_loss: 3.2873 - val_accuracy1000: 0.3623 - 48s/epoch - 34ms/step
Epoch 4/50
1403/1403 - 47s - loss: 3.2814 - accuracy1000: 0.3728 - val_loss: 3.2860 - val_accuracy1000: 0.3674 - 47s/epoch - 33ms/step
Epoch 5/50
1403/1403 - 46s - loss: 3.2807 - accuracy1000: 0.3731 - val_loss: 3.2847 - val_accuracy1000: 0.3697 - 46s/epoch - 33ms/step
Epoch 6/50
1403/1403 - 46s - loss: 3.2778 - accuracy1000: 0.3752 - val_loss: 3.2848 - val_accuracy1000: 0.3693 - 46s/epoch - 33ms/step
Epoch 7/50
1403/1403 - 50s - loss: 3.2757 - accuracy1000: 0.3775 - val_loss: 3.2847 - val_accuracy1000: 0.3687 - 50s/epoch - 36ms/step
Epoch 8/50
1403/1403 - 46s - loss: 3.2728 - accuracy1000: 0.3797 - val_loss: 3.2841 - val_accuracy1000: 0.3697 - 46s/epoch - 33ms/step
Epoch 9/50
1403/1403 - 48s - loss: 3.2698 - accuracy1000: 0.3825 - val_loss: 3.2830 - val_accuracy1000: 0.3714 - 48s/epoch - 34ms/step
Epoch 10/50
1403/1403 - 47s - loss: 3.2677 - accuracy1000: 0.3840 - val_loss: 3.2829 - val_accuracy1000: 0.3714 - 47s/epoch - 34ms/step
Epoch 11/50
1403/1403 - 51s - loss: 3.2650 - accuracy1000: 0.3863 - val_loss: 3.2835 - val_accuracy1000: 0.3715 - 51s/epoch - 36ms/step
Epoch 12/50
1403/1403 - 52s - loss: 3.2630 - accuracy1000: 0.3879 - val_loss: 3.2824 - val_accuracy1000: 0.3736 - 52s/epoch - 37ms/step
Epoch 13/50
1403/1403 - 44s - loss: 3.2623 - accuracy1000: 0.3874 - val_loss: 3.2824 - val_accuracy1000: 0.3741 - 44s/epoch - 31ms/step
Epoch 14/50
1403/1403 - 50s - loss: 3.2613 - accuracy1000: 0.3877 - val_loss: 3.2820 - val_accuracy1000: 0.3747 - 50s/epoch - 35ms/step
Epoch 15/50
1403/1403 - 48s - loss: 3.2613 - accuracy1000: 0.3878 - val_loss: 3.2823 - val_accuracy1000: 0.3750 - 48s/epoch - 34ms/step
Epoch 16/50
1403/1403 - 48s - loss: 3.2590 - accuracy1000: 0.3896 - val_loss: 3.2820 - val_accuracy1000: 0.3742 - 48s/epoch - 34ms/step
Epoch 17/50
1403/1403 - 49s - loss: 3.2565 - accuracy1000: 0.3912 - val_loss: 3.2822 - val_accuracy1000: 0.3747 - 49s/epoch - 35ms/step
Epoch 18/50
1403/1403 - 50s - loss: 3.2540 - accuracy1000: 0.3929 - val_loss: 3.2821 - val_accuracy1000: 0.3756 - 50s/epoch - 35ms/step
Epoch 19/50
1403/1403 - 50s - loss: 3.2524 - accuracy1000: 0.3949 - val_loss: 3.2818 - val_accuracy1000: 0.3772 - 50s/epoch - 36ms/step
Epoch 20/50
1403/1403 - 48s - loss: 3.2500 - accuracy1000: 0.3955 - val_loss: 3.2821 - val_accuracy1000: 0.3761 - 48s/epoch - 34ms/step
Epoch 21/50
1403/1403 - 47s - loss: 3.2499 - accuracy1000: 0.3954 - val_loss: 3.2823 - val_accuracy1000: 0.3756 - 47s/epoch - 34ms/step
Epoch 22/50
1403/1403 - 48s - loss: 3.2499 - accuracy1000: 0.3957 - val_loss: 3.2829 - val_accuracy1000: 0.3755 - 48s/epoch - 34ms/step
Epoch 23/50
1403/1403 - 51s - loss: 3.2484 - accuracy1000: 0.3968 - val_loss: 3.2830 - val_accuracy1000: 0.3762 - 51s/epoch - 36ms/step
Epoch 24/50
1403/1403 - 46s - loss: 3.2472 - accuracy1000: 0.3975 - val_loss: 3.2829 - val_accuracy1000: 0.3758 - 46s/epoch - 33ms/step
Epoch 25/50
1403/1403 - 48s - loss: 3.2462 - accuracy1000: 0.3989 - val_loss: 3.2835 - val_accuracy1000: 0.3767 - 48s/epoch - 34ms/step
Epoch 26/50
1403/1403 - 51s - loss: 3.2451 - accuracy1000: 0.3997 - val_loss: 3.2836 - val_accuracy1000: 0.3753 - 51s/epoch - 36ms/step
Epoch 27/50
1403/1403 - 50s - loss: 3.2441 - accuracy1000: 0.4006 - val_loss: 3.2836 - val_accuracy1000: 0.3759 - 50s/epoch - 35ms/step
Epoch 28/50
1403/1403 - 51s - loss: 3.2425 - accuracy1000: 0.4020 - val_loss: 3.2837 - val_accuracy1000: 0.3768 - 51s/epoch - 36ms/step
Epoch 29/50
1403/1403 - 47s - loss: 3.2408 - accuracy1000: 0.4034 - val_loss: 3.2829 - val_accuracy1000: 0.3773 - 47s/epoch - 33ms/step
testing model: results/EXC/W2/deepOF_L1/h1000
Evaluating performance on  test set...
4918/4918 - 72s - 72s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099488
{'0': {'precision': 0.3447731487983109, 'recall': 0.6878142797107539, 'f1-score': 0.45931199326476596, 'support': 414042}, '1': {'precision': 0.3812305295950156, 'recall': 0.0023779913138948536, 'f1-score': 0.004726500265533722, 'support': 411692}, '2': {'precision': 0.3720547015539369, 'recall': 0.36961671669360424, 'f1-score': 0.3708317021133661, 'support': 433100}, 'accuracy': 0.3541721942686645, 'macro avg': {'precision': 0.36601945998242114, 'recall': 0.353269662572751, 'f1-score': 0.27829006521455524, 'support': 1258834}, 'weighted avg': {'precision': 0.3660824338298707, 'recall': 0.3541721942686645, 'f1-score': 0.28020178105131194, 'support': 1258834}}
[[284784    788 128470]
 [269002    979 141711]
 [272218    801 160081]]
Evaluating performance on  train set...
1403/1403 - 23s - 23s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.098842
{'0': {'precision': 0.35399362056961514, 'recall': 0.727245511471838, 'f1-score': 0.47619488422113015, 'support': 120251}, '1': {'precision': 0.3721945137157107, 'recall': 0.004947459144097856, 'f1-score': 0.009765113844543314, 'support': 120668}, '2': {'precision': 0.35925207555378313, 'recall': 0.3357332226560846, 'f1-score': 0.34709470080081267, 'support': 118061}, 'accuracy': 0.3556911248537523, 'macro avg': {'precision': 0.36181340327970296, 'recall': 0.35597539775734016, 'f1-score': 0.2776848996221621, 'support': 358980}, 'weighted avg': {'precision': 0.3618410879160938, 'recall': 0.3556911248537523, 'f1-score': 0.27695023469584157, 'support': 358980}}
[[87452   481 32318]
 [81694   597 38377]
 [77898   526 39637]]
Evaluating performance on  val set...
480/480 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0934187
{'0': {'precision': 0.37173366834170857, 'recall': 0.686001761951129, 'f1-score': 0.4821809767464598, 'support': 43134}, '1': {'precision': 0.3411371237458194, 'recall': 0.00564034505640345, 'f1-score': 0.011097209378229885, 'support': 36168}, '2': {'precision': 0.3855073145491321, 'recall': 0.37755102040816324, 'f1-score': 0.3814876879393008, 'support': 43414}, 'accuracy': 0.3763567912904593, 'macro avg': {'precision': 0.36612603554555334, 'recall': 0.3563977091385652, 'f1-score': 0.29158862468799684, 'support': 122716}, 'weighted avg': {'precision': 0.3675887585622582, 'recall': 0.3763567912904593, 'f1-score': 0.3077159017892567, 'support': 122716}}
[[29590   182 13362]
 [23199   204 12765]
 [26811   212 16391]]
training model: results/EXC/W2/deepLOB_L2/h10
Epoch 1/50
1403/1403 - 91s - loss: 2.6301 - accuracy10: 0.4768 - val_loss: 2.7483 - val_accuracy10: 0.5353 - 91s/epoch - 65ms/step
Epoch 2/50
1403/1403 - 85s - loss: 2.3461 - accuracy10: 0.5480 - val_loss: 2.6157 - val_accuracy10: 0.6073 - 85s/epoch - 60ms/step
Epoch 3/50
1403/1403 - 89s - loss: 2.1708 - accuracy10: 0.6154 - val_loss: 2.4693 - val_accuracy10: 0.6343 - 89s/epoch - 63ms/step
Epoch 4/50
1403/1403 - 87s - loss: 2.0383 - accuracy10: 0.6563 - val_loss: 2.3942 - val_accuracy10: 0.6912 - 87s/epoch - 62ms/step
Epoch 5/50
1403/1403 - 89s - loss: 1.9863 - accuracy10: 0.6660 - val_loss: 2.3120 - val_accuracy10: 0.7158 - 89s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 93s - loss: 1.9516 - accuracy10: 0.6698 - val_loss: 2.3019 - val_accuracy10: 0.6996 - 93s/epoch - 66ms/step
Epoch 7/50
1403/1403 - 86s - loss: 1.9294 - accuracy10: 0.6737 - val_loss: 2.3390 - val_accuracy10: 0.7252 - 86s/epoch - 61ms/step
Epoch 8/50
1403/1403 - 83s - loss: 1.9061 - accuracy10: 0.6777 - val_loss: 2.3208 - val_accuracy10: 0.7157 - 83s/epoch - 59ms/step
Epoch 9/50
1403/1403 - 89s - loss: 1.8866 - accuracy10: 0.6794 - val_loss: 2.2877 - val_accuracy10: 0.7047 - 89s/epoch - 63ms/step
Epoch 10/50
1403/1403 - 87s - loss: 1.8695 - accuracy10: 0.6811 - val_loss: 2.3373 - val_accuracy10: 0.7235 - 87s/epoch - 62ms/step
Epoch 11/50
1403/1403 - 85s - loss: 1.8588 - accuracy10: 0.6828 - val_loss: 2.2779 - val_accuracy10: 0.7184 - 85s/epoch - 60ms/step
Epoch 12/50
1403/1403 - 86s - loss: 1.8428 - accuracy10: 0.6843 - val_loss: 2.2768 - val_accuracy10: 0.7125 - 86s/epoch - 61ms/step
Epoch 13/50
1403/1403 - 81s - loss: 1.8296 - accuracy10: 0.6859 - val_loss: 2.3135 - val_accuracy10: 0.7150 - 81s/epoch - 58ms/step
Epoch 14/50
1403/1403 - 83s - loss: 1.8180 - accuracy10: 0.6857 - val_loss: 2.2711 - val_accuracy10: 0.7110 - 83s/epoch - 59ms/step
Epoch 15/50
1403/1403 - 81s - loss: 1.8101 - accuracy10: 0.6866 - val_loss: 2.3541 - val_accuracy10: 0.7092 - 81s/epoch - 58ms/step
Epoch 16/50
1403/1403 - 81s - loss: 1.8009 - accuracy10: 0.6863 - val_loss: 2.3421 - val_accuracy10: 0.7118 - 81s/epoch - 57ms/step
Epoch 17/50
1403/1403 - 79s - loss: 1.7870 - accuracy10: 0.6876 - val_loss: 2.3932 - val_accuracy10: 0.7024 - 79s/epoch - 56ms/step
Epoch 18/50
1403/1403 - 79s - loss: 1.7796 - accuracy10: 0.6883 - val_loss: 2.3996 - val_accuracy10: 0.7073 - 79s/epoch - 56ms/step
Epoch 19/50
1403/1403 - 84s - loss: 1.7684 - accuracy10: 0.6887 - val_loss: 2.4611 - val_accuracy10: 0.7194 - 84s/epoch - 60ms/step
Epoch 20/50
1403/1403 - 85s - loss: 1.7612 - accuracy10: 0.6893 - val_loss: 2.3803 - val_accuracy10: 0.7146 - 85s/epoch - 61ms/step
Epoch 21/50
1403/1403 - 86s - loss: 1.7518 - accuracy10: 0.6904 - val_loss: 2.4502 - val_accuracy10: 0.7105 - 86s/epoch - 61ms/step
Epoch 22/50
1403/1403 - 91s - loss: 1.7429 - accuracy10: 0.6911 - val_loss: 2.4034 - val_accuracy10: 0.6980 - 91s/epoch - 65ms/step
Epoch 23/50
1403/1403 - 85s - loss: 1.7351 - accuracy10: 0.6919 - val_loss: 2.3910 - val_accuracy10: 0.7007 - 85s/epoch - 61ms/step
Epoch 24/50
1403/1403 - 82s - loss: 1.7304 - accuracy10: 0.6912 - val_loss: 2.5684 - val_accuracy10: 0.7005 - 82s/epoch - 59ms/step
testing model: results/EXC/W2/deepLOB_L2/h10
Evaluating performance on  test set...
4918/4918 - 105s - 105s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.71611786
{'0': {'precision': 0.35853516875006936, 'recall': 0.6661122375339359, 'f1-score': 0.46615969947523606, 'support': 145495}, '1': {'precision': 0.9393953800076371, 'recall': 0.6333693499940547, 'f1-score': 0.7566093387943854, 'support': 967145}, '2': {'precision': 0.3260672494196743, 'recall': 0.7503813295576577, 'f1-score': 0.4545963103545441, 'support': 146199}, 'accuracy': 0.650743264229977, 'macro avg': {'precision': 0.5413325993924603, 'recall': 0.6832876390285495, 'f1-score': 0.5591217828747218, 'support': 1258839}, 'weighted avg': {'precision': 0.8010296193339136, 'recall': 0.650743264229977, 'f1-score': 0.6879643627350038, 'support': 1258839}}
[[ 96916  21000  27579]
 [155420 612560 199165]
 [ 17975  18519 109705]]
Evaluating performance on  train set...
1403/1403 - 30s - 30s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.56593883
{'0': {'precision': 0.38456411155937553, 'recall': 0.6084929225645296, 'f1-score': 0.47128116938950987, 'support': 36030}, '1': {'precision': 0.9317333150832589, 'recall': 0.7598094101971126, 'f1-score': 0.837034418361583, 'support': 286689}, '2': {'precision': 0.3725524706296476, 'recall': 0.7005046744436171, 'f1-score': 0.48641351180559544, 'support': 36261}, 'accuracy': 0.7386316786450499, 'macro avg': {'precision': 0.5629499657574274, 'recall': 0.6896023357350863, 'f1-score': 0.5982430331855627, 'support': 358980}, 'weighted avg': {'precision': 0.8203316687416857, 'recall': 0.7386316786450499, 'f1-score': 0.7649079649293848, 'support': 358980}}
[[ 21924   9104   5002]
 [ 31082 217829  37778]
 [  4004   6856  25401]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6199354
{'0': {'precision': 0.3947510689536541, 'recall': 0.6003886978621618, 'f1-score': 0.4763232023721275, 'support': 13378}, '1': {'precision': 0.9325637828634249, 'recall': 0.7237737498179094, 'f1-score': 0.8150092269838015, 'support': 96106}, '2': {'precision': 0.35052733882869586, 'recall': 0.735887553842666, 'f1-score': 0.4748622421612132, 'support': 13233}, 'accuracy': 0.7116291956289674, 'macro avg': {'precision': 0.5592807302152583, 'recall': 0.6866833338409123, 'f1-score': 0.5887315571723807, 'support': 122717}, 'weighted avg': {'precision': 0.8111710927667268, 'recall': 0.7116291956289674, 'f1-score': 0.7414081229198797, 'support': 122717}}
[[ 8032  2969  2377]
 [10881 69559 15666]
 [ 1434  2061  9738]]
training model: results/EXC/W2/deepLOB_L2/h20
Epoch 1/50
1403/1403 - 89s - loss: 2.6654 - accuracy20: 0.4787 - val_loss: 2.7599 - val_accuracy20: 0.4938 - 89s/epoch - 63ms/step
Epoch 2/50
1403/1403 - 85s - loss: 2.4056 - accuracy20: 0.5612 - val_loss: 2.8286 - val_accuracy20: 0.6499 - 85s/epoch - 61ms/step
Epoch 3/50
1403/1403 - 80s - loss: 2.2159 - accuracy20: 0.6240 - val_loss: 2.6126 - val_accuracy20: 0.6877 - 80s/epoch - 57ms/step
Epoch 4/50
1403/1403 - 92s - loss: 2.0941 - accuracy20: 0.6513 - val_loss: 2.5598 - val_accuracy20: 0.7101 - 92s/epoch - 65ms/step
Epoch 5/50
1403/1403 - 88s - loss: 2.0442 - accuracy20: 0.6608 - val_loss: 2.4516 - val_accuracy20: 0.7078 - 88s/epoch - 62ms/step
Epoch 6/50
1403/1403 - 86s - loss: 2.0173 - accuracy20: 0.6649 - val_loss: 2.4396 - val_accuracy20: 0.7100 - 86s/epoch - 61ms/step
Epoch 7/50
1403/1403 - 84s - loss: 1.9944 - accuracy20: 0.6680 - val_loss: 2.4492 - val_accuracy20: 0.7134 - 84s/epoch - 60ms/step
Epoch 8/50
1403/1403 - 85s - loss: 1.9792 - accuracy20: 0.6699 - val_loss: 2.3631 - val_accuracy20: 0.6953 - 85s/epoch - 60ms/step
Epoch 9/50
1403/1403 - 89s - loss: 1.9639 - accuracy20: 0.6717 - val_loss: 2.3328 - val_accuracy20: 0.6909 - 89s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 86s - loss: 1.9516 - accuracy20: 0.6716 - val_loss: 2.3560 - val_accuracy20: 0.7011 - 86s/epoch - 61ms/step
Epoch 11/50
1403/1403 - 83s - loss: 1.9394 - accuracy20: 0.6735 - val_loss: 2.3327 - val_accuracy20: 0.7005 - 83s/epoch - 59ms/step
Epoch 12/50
1403/1403 - 85s - loss: 1.9273 - accuracy20: 0.6744 - val_loss: 2.3327 - val_accuracy20: 0.7009 - 85s/epoch - 60ms/step
Epoch 13/50
1403/1403 - 79s - loss: 1.9183 - accuracy20: 0.6759 - val_loss: 2.2925 - val_accuracy20: 0.6861 - 79s/epoch - 57ms/step
Epoch 14/50
1403/1403 - 84s - loss: 1.9065 - accuracy20: 0.6762 - val_loss: 2.2954 - val_accuracy20: 0.6892 - 84s/epoch - 60ms/step
Epoch 15/50
1403/1403 - 82s - loss: 1.8990 - accuracy20: 0.6775 - val_loss: 2.3215 - val_accuracy20: 0.6968 - 82s/epoch - 58ms/step
Epoch 16/50
1403/1403 - 86s - loss: 1.8906 - accuracy20: 0.6782 - val_loss: 2.3137 - val_accuracy20: 0.6895 - 86s/epoch - 62ms/step
Epoch 17/50
1403/1403 - 82s - loss: 1.8818 - accuracy20: 0.6791 - val_loss: 2.3336 - val_accuracy20: 0.6890 - 82s/epoch - 59ms/step
Epoch 18/50
1403/1403 - 84s - loss: 1.8739 - accuracy20: 0.6795 - val_loss: 2.3681 - val_accuracy20: 0.6954 - 84s/epoch - 60ms/step
Epoch 19/50
1403/1403 - 85s - loss: 1.8695 - accuracy20: 0.6802 - val_loss: 2.3727 - val_accuracy20: 0.7014 - 85s/epoch - 61ms/step
Epoch 20/50
1403/1403 - 87s - loss: 1.8585 - accuracy20: 0.6815 - val_loss: 2.3890 - val_accuracy20: 0.6903 - 87s/epoch - 62ms/step
Epoch 21/50
1403/1403 - 84s - loss: 1.8525 - accuracy20: 0.6821 - val_loss: 2.4022 - val_accuracy20: 0.6951 - 84s/epoch - 60ms/step
Epoch 22/50
1403/1403 - 85s - loss: 1.8427 - accuracy20: 0.6828 - val_loss: 2.4225 - val_accuracy20: 0.6938 - 85s/epoch - 61ms/step
Epoch 23/50
1403/1403 - 83s - loss: 1.8354 - accuracy20: 0.6820 - val_loss: 2.4412 - val_accuracy20: 0.6940 - 83s/epoch - 59ms/step
testing model: results/EXC/W2/deepLOB_L2/h20
Evaluating performance on  test set...
4918/4918 - 125s - 125s/epoch - 25ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8319575
{'0': {'precision': 0.36723963692700096, 'recall': 0.7872892731651466, 'f1-score': 0.5008516015603538, 'support': 202632}, '1': {'precision': 0.9067057974754601, 'recall': 0.5659817391866707, 'f1-score': 0.6969284541497868, 'support': 850455}, '2': {'precision': 0.44306751099408315, 'recall': 0.6321688246043781, 'f1-score': 0.5209895878186089, 'support': 205752}, 'accuracy': 0.6124230342402801, 'macro avg': {'precision': 0.5723376484655147, 'recall': 0.6618132789853984, 'f1-score': 0.5729232145095832, 'support': 1258839}, 'weighted avg': {'precision': 0.7440895997215204, 'recall': 0.6124230342402801, 'f1-score': 0.6366100032444093, 'support': 1258839}}
[[159530  21676  21426]
 [227042 481342 142071]
 [ 47831  27851 130070]]
Evaluating performance on  train set...
1403/1403 - 33s - 33s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66696393
{'0': {'precision': 0.4026912620022714, 'recall': 0.6881456940659858, 'f1-score': 0.5080690683301733, 'support': 51011}, '1': {'precision': 0.891809459361481, 'recall': 0.7191125973909552, 'f1-score': 0.7962041540260738, 'support': 256569}, '2': {'precision': 0.48442794652208737, 'recall': 0.6118871595330739, 'f1-score': 0.5407482548743165, 'support': 51400}, 'accuracy': 0.6993592957824949, 'macro avg': {'precision': 0.5929762226286133, 'recall': 0.6730484836633384, 'f1-score': 0.6150071590768545, 'support': 358980}, 'weighted avg': {'precision': 0.7639755462592595, 'recall': 0.6993592957824949, 'f1-score': 0.7186831442961894, 'support': 358980}}
[[ 35103  11034   4874]
 [ 43468 184502  28599]
 [  8600  11349  31451]]
Evaluating performance on  val set...
480/480 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7028481
{'0': {'precision': 0.418962962962963, 'recall': 0.6790097108099455, 'f1-score': 0.5181912576093817, 'support': 18742}, '1': {'precision': 0.8891838286830607, 'recall': 0.6980005619029781, 'f1-score': 0.7820777670660607, 'support': 85424}, '2': {'precision': 0.47023927229582757, 'recall': 0.6409357986092394, 'f1-score': 0.5424765033305959, 'support': 18551}, 'accuracy': 0.6864737566922269, 'macro avg': {'precision': 0.5927953546472837, 'recall': 0.6726486904407211, 'f1-score': 0.6142485093353461, 'support': 122717}, 'weighted avg': {'precision': 0.754037761464455, 'recall': 0.6864737566922269, 'f1-score': 0.7055553292310934, 'support': 122717}}
[[12726  3967  2049]
 [14452 59626 11346]
 [ 3197  3464 11890]]
training model: results/EXC/W2/deepLOB_L2/h30
Epoch 1/50
1403/1403 - 89s - loss: 2.7697 - accuracy30: 0.4776 - val_loss: 2.8950 - val_accuracy30: 0.5492 - 89s/epoch - 63ms/step
Epoch 2/50
1403/1403 - 80s - loss: 2.5189 - accuracy30: 0.5536 - val_loss: 2.7574 - val_accuracy30: 0.6186 - 80s/epoch - 57ms/step
Epoch 3/50
1403/1403 - 85s - loss: 2.3316 - accuracy30: 0.6114 - val_loss: 2.6664 - val_accuracy30: 0.6660 - 85s/epoch - 60ms/step
Epoch 4/50
1403/1403 - 79s - loss: 2.2271 - accuracy30: 0.6360 - val_loss: 2.5597 - val_accuracy30: 0.6699 - 79s/epoch - 56ms/step
Epoch 5/50
1403/1403 - 84s - loss: 2.1848 - accuracy30: 0.6437 - val_loss: 2.5823 - val_accuracy30: 0.6734 - 84s/epoch - 60ms/step
Epoch 6/50
1403/1403 - 84s - loss: 2.1560 - accuracy30: 0.6464 - val_loss: 2.5726 - val_accuracy30: 0.6823 - 84s/epoch - 60ms/step
Epoch 7/50
1403/1403 - 91s - loss: 2.1340 - accuracy30: 0.6486 - val_loss: 2.5348 - val_accuracy30: 0.6814 - 91s/epoch - 65ms/step
Epoch 8/50
1403/1403 - 84s - loss: 2.1154 - accuracy30: 0.6499 - val_loss: 2.4989 - val_accuracy30: 0.6812 - 84s/epoch - 60ms/step
Epoch 9/50
1403/1403 - 87s - loss: 2.1014 - accuracy30: 0.6503 - val_loss: 2.5028 - val_accuracy30: 0.6870 - 87s/epoch - 62ms/step
Epoch 10/50
1403/1403 - 83s - loss: 2.0885 - accuracy30: 0.6513 - val_loss: 2.5035 - val_accuracy30: 0.6833 - 83s/epoch - 59ms/step
Epoch 11/50
1403/1403 - 83s - loss: 2.0780 - accuracy30: 0.6521 - val_loss: 2.5015 - val_accuracy30: 0.6909 - 83s/epoch - 59ms/step
Epoch 12/50
1403/1403 - 86s - loss: 2.0663 - accuracy30: 0.6537 - val_loss: 2.5236 - val_accuracy30: 0.6915 - 86s/epoch - 61ms/step
Epoch 13/50
1403/1403 - 84s - loss: 2.0573 - accuracy30: 0.6538 - val_loss: 2.5388 - val_accuracy30: 0.6930 - 84s/epoch - 60ms/step
Epoch 14/50
1403/1403 - 84s - loss: 2.0485 - accuracy30: 0.6548 - val_loss: 2.5228 - val_accuracy30: 0.6869 - 84s/epoch - 60ms/step
Epoch 15/50
1403/1403 - 81s - loss: 2.0392 - accuracy30: 0.6567 - val_loss: 2.5755 - val_accuracy30: 0.6908 - 81s/epoch - 58ms/step
Epoch 16/50
1403/1403 - 90s - loss: 2.0311 - accuracy30: 0.6571 - val_loss: 2.6222 - val_accuracy30: 0.6931 - 90s/epoch - 64ms/step
Epoch 17/50
1403/1403 - 84s - loss: 2.0225 - accuracy30: 0.6579 - val_loss: 2.6150 - val_accuracy30: 0.6966 - 84s/epoch - 60ms/step
Epoch 18/50
1403/1403 - 85s - loss: 2.0147 - accuracy30: 0.6588 - val_loss: 2.6347 - val_accuracy30: 0.6968 - 85s/epoch - 60ms/step
testing model: results/EXC/W2/deepLOB_L2/h30
Evaluating performance on  test set...
4918/4918 - 104s - 104s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.75324386
{'0': {'precision': 0.5109432128141141, 'recall': 0.5789266031291997, 'f1-score': 0.5428145898881924, 'support': 243321}, '1': {'precision': 0.8224737286428144, 'recall': 0.6442156828221411, 'f1-score': 0.7225121700056168, 'support': 766737}, '2': {'precision': 0.45574828011626206, 'recall': 0.7008654197868809, 'f1-score': 0.552333436284875, 'support': 248781}, 'accuracy': 0.6427914927961399, 'macro avg': {'precision': 0.5963884071910636, 'recall': 0.6413359019127406, 'f1-score': 0.6058867320595613, 'support': 1258839}, 'weighted avg': {'precision': 0.6897830188285813, 'recall': 0.6427914927961399, 'f1-score': 0.6541464533051239, 'support': 1258839}}
[[140865  58085  44371]
 [108942 493944 163851]
 [ 25889  48530 174362]]
Evaluating performance on  train set...
1403/1403 - 33s - 33s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.670171
{'0': {'precision': 0.5278252672280186, 'recall': 0.5306315857106142, 'f1-score': 0.5292247062310261, 'support': 62256}, '1': {'precision': 0.8217816741034234, 'recall': 0.7581714139300508, 'f1-score': 0.7886960423265381, 'support': 234170}, '2': {'precision': 0.49354690164158854, 'recall': 0.6339482686958468, 'f1-score': 0.555005843124357, 'support': 62554}, 'accuracy': 0.6970639032815199, 'macro avg': {'precision': 0.6143846143243435, 'recall': 0.6409170894455039, 'f1-score': 0.6243088638939738, 'support': 358980}, 'weighted avg': {'precision': 0.7136058759447158, 'recall': 0.6970639032815199, 'f1-score': 0.7029756561745089, 'support': 358980}}
[[ 33035  21086   8135]
 [ 24071 177541  32558]
 [  5481  17417  39656]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7039749
{'0': {'precision': 0.5214157476275968, 'recall': 0.5378069750011022, 'f1-score': 0.5294845360824741, 'support': 22681}, '1': {'precision': 0.8158892653738015, 'recall': 0.7306038656699074, 'f1-score': 0.7708949225508495, 'support': 77451}, '2': {'precision': 0.48908836091831287, 'recall': 0.6489705556785477, 'f1-score': 0.557798793598843, 'support': 22585}, 'accuracy': 0.6799465436736557, 'macro avg': {'precision': 0.6087977913065704, 'recall': 0.6391271321165191, 'f1-score': 0.6193927507440556, 'support': 122717}, 'weighted avg': {'precision': 0.7013187308665296, 'recall': 0.6799465436736557, 'f1-score': 0.6870580861885665, 'support': 122717}}
[[12198  7175  3308]
 [ 8862 56586 12003]
 [ 2334  5594 14657]]
training model: results/EXC/W2/deepLOB_L2/h50
Epoch 1/50
1403/1403 - 91s - loss: 2.8852 - accuracy50: 0.4878 - val_loss: 3.0388 - val_accuracy50: 0.5161 - 91s/epoch - 65ms/step
Epoch 2/50
1403/1403 - 86s - loss: 2.7114 - accuracy50: 0.5379 - val_loss: 3.0501 - val_accuracy50: 0.5817 - 86s/epoch - 61ms/step
Epoch 3/50
1403/1403 - 82s - loss: 2.5893 - accuracy50: 0.5768 - val_loss: 3.0578 - val_accuracy50: 0.6030 - 82s/epoch - 58ms/step
Epoch 4/50
1403/1403 - 86s - loss: 2.4947 - accuracy50: 0.5965 - val_loss: 3.0145 - val_accuracy50: 0.6106 - 86s/epoch - 61ms/step
Epoch 5/50
1403/1403 - 85s - loss: 2.4456 - accuracy50: 0.6026 - val_loss: 2.9437 - val_accuracy50: 0.6125 - 85s/epoch - 60ms/step
Epoch 6/50
1403/1403 - 82s - loss: 2.4180 - accuracy50: 0.6064 - val_loss: 2.9356 - val_accuracy50: 0.6162 - 82s/epoch - 58ms/step
Epoch 7/50
1403/1403 - 82s - loss: 2.3971 - accuracy50: 0.6105 - val_loss: 2.9120 - val_accuracy50: 0.6202 - 82s/epoch - 59ms/step
Epoch 8/50
1403/1403 - 81s - loss: 2.3794 - accuracy50: 0.6125 - val_loss: 2.8844 - val_accuracy50: 0.6294 - 81s/epoch - 57ms/step
Epoch 9/50
1403/1403 - 79s - loss: 2.3649 - accuracy50: 0.6148 - val_loss: 2.8611 - val_accuracy50: 0.6224 - 79s/epoch - 56ms/step
Epoch 10/50
1403/1403 - 81s - loss: 2.3518 - accuracy50: 0.6161 - val_loss: 2.8735 - val_accuracy50: 0.6237 - 81s/epoch - 58ms/step
Epoch 11/50
1403/1403 - 81s - loss: 2.3397 - accuracy50: 0.6185 - val_loss: 2.8846 - val_accuracy50: 0.6230 - 81s/epoch - 58ms/step
Epoch 12/50
1403/1403 - 84s - loss: 2.3288 - accuracy50: 0.6202 - val_loss: 2.9108 - val_accuracy50: 0.6207 - 84s/epoch - 60ms/step
Epoch 13/50
1403/1403 - 84s - loss: 2.3196 - accuracy50: 0.6212 - val_loss: 2.9188 - val_accuracy50: 0.6188 - 84s/epoch - 60ms/step
Epoch 14/50
1403/1403 - 97s - loss: 2.3091 - accuracy50: 0.6231 - val_loss: 2.9272 - val_accuracy50: 0.6169 - 97s/epoch - 69ms/step
Epoch 15/50
1403/1403 - 83s - loss: 2.3001 - accuracy50: 0.6242 - val_loss: 2.9505 - val_accuracy50: 0.6167 - 83s/epoch - 59ms/step
Epoch 16/50
1403/1403 - 85s - loss: 2.2910 - accuracy50: 0.6254 - val_loss: 2.9698 - val_accuracy50: 0.6151 - 85s/epoch - 61ms/step
Epoch 17/50
1403/1403 - 85s - loss: 2.2833 - accuracy50: 0.6270 - val_loss: 2.9319 - val_accuracy50: 0.6090 - 85s/epoch - 60ms/step
Epoch 18/50
1403/1403 - 81s - loss: 2.2753 - accuracy50: 0.6276 - val_loss: 2.9605 - val_accuracy50: 0.6118 - 81s/epoch - 58ms/step
Epoch 19/50
1403/1403 - 82s - loss: 2.2657 - accuracy50: 0.6292 - val_loss: 3.0016 - val_accuracy50: 0.6138 - 82s/epoch - 58ms/step
testing model: results/EXC/W2/deepLOB_L2/h50
Evaluating performance on  test set...
4918/4918 - 102s - 102s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9161896
{'0': {'precision': 0.44348453284227407, 'recall': 0.7138803215899178, 'f1-score': 0.5470960686479802, 'support': 308343}, '1': {'precision': 0.6987917455146946, 'recall': 0.5650105399452081, 'f1-score': 0.6248203630979093, 'support': 633305}, '2': {'precision': 0.5729687425130572, 'recall': 0.45238357960976194, 'f1-score': 0.5055855341623989, 'support': 317191}, 'accuracy': 0.5730963212928738, 'macro avg': {'precision': 0.5717483402900086, 'recall': 0.5770914803816293, 'f1-score': 0.5591673219694295, 'support': 1258839}, 'weighted avg': {'precision': 0.6045524376904656, 'recall': 0.5730963212928738, 'f1-score': 0.5757386642083309, 'support': 1258839}}
[[220120  60512  27711]
 [196248 357824  79233]
 [ 79974  93725 143492]]
Evaluating performance on  train set...
1403/1403 - 33s - 33s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.82555485
{'0': {'precision': 0.474675836377964, 'recall': 0.5757019089938684, 'f1-score': 0.52033049321569, 'support': 80566}, '1': {'precision': 0.701317479934932, 'recall': 0.7249673030990097, 'f1-score': 0.7129463177235933, 'support': 198031}, '2': {'precision': 0.5995791930407723, 'recall': 0.4218678078698232, 'f1-score': 0.4952643839317662, 'support': 80383}, 'accuracy': 0.6235974148977659, 'macro avg': {'precision': 0.5918575031178894, 'recall': 0.5741790066542337, 'f1-score': 0.5761803982903498, 'support': 358980}, 'weighted avg': {'precision': 0.6276709275637026, 'recall': 0.6235974148977659, 'f1-score': 0.6209740256702974, 'support': 358980}}
[[ 46382  28507   5677]
 [ 37495 143566  16970]
 [ 13836  32636  33911]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.83748525
{'0': {'precision': 0.504542626011201, 'recall': 0.5574615834164117, 'f1-score': 0.529683646638031, 'support': 29089}, '1': {'precision': 0.6806750496360027, 'recall': 0.7342666025173435, 'f1-score': 0.7064559239653873, 'support': 64433}, '2': {'precision': 0.6064258934080016, 'recall': 0.4376776845350231, 'f1-score': 0.508415230971233, 'support': 29195}, 'accuracy': 0.6217964911137006, 'macro avg': {'precision': 0.5972145230184017, 'recall': 0.5764686234895927, 'f1-score': 0.5815182671915505, 'support': 122717}, 'weighted avg': {'precision': 0.6212601341239029, 'recall': 0.6217964911137006, 'f1-score': 0.6174386989098546, 'support': 122717}}
[[16216 10529  2344]
 [11173 47311  5949]
 [ 4751 11666 12778]]
training model: results/EXC/W2/deepLOB_L2/h100
Epoch 1/50
1403/1403 - 87s - loss: 3.0834 - accuracy100: 0.4629 - val_loss: 3.2803 - val_accuracy100: 0.4454 - 87s/epoch - 62ms/step
Epoch 2/50
1403/1403 - 84s - loss: 2.9841 - accuracy100: 0.4918 - val_loss: 3.2989 - val_accuracy100: 0.4375 - 84s/epoch - 60ms/step
Epoch 3/50
1403/1403 - 86s - loss: 2.9377 - accuracy100: 0.5062 - val_loss: 3.3376 - val_accuracy100: 0.4406 - 86s/epoch - 61ms/step
Epoch 4/50
1403/1403 - 80s - loss: 2.9051 - accuracy100: 0.5154 - val_loss: 3.3133 - val_accuracy100: 0.4508 - 80s/epoch - 57ms/step
Epoch 5/50
1403/1403 - 82s - loss: 2.8733 - accuracy100: 0.5246 - val_loss: 3.2493 - val_accuracy100: 0.4702 - 82s/epoch - 58ms/step
Epoch 6/50
1403/1403 - 83s - loss: 2.8412 - accuracy100: 0.5329 - val_loss: 3.2693 - val_accuracy100: 0.4666 - 83s/epoch - 59ms/step
Epoch 7/50
1403/1403 - 80s - loss: 2.8162 - accuracy100: 0.5384 - val_loss: 3.3284 - val_accuracy100: 0.4597 - 80s/epoch - 57ms/step
Epoch 8/50
1403/1403 - 83s - loss: 2.7967 - accuracy100: 0.5430 - val_loss: 3.3138 - val_accuracy100: 0.4690 - 83s/epoch - 59ms/step
Epoch 9/50
1403/1403 - 86s - loss: 2.7794 - accuracy100: 0.5464 - val_loss: 3.3517 - val_accuracy100: 0.4619 - 86s/epoch - 61ms/step
Epoch 10/50
1403/1403 - 83s - loss: 2.7653 - accuracy100: 0.5496 - val_loss: 3.2738 - val_accuracy100: 0.4762 - 83s/epoch - 59ms/step
Epoch 11/50
1403/1403 - 85s - loss: 2.7498 - accuracy100: 0.5523 - val_loss: 3.2590 - val_accuracy100: 0.4852 - 85s/epoch - 60ms/step
Epoch 12/50
1403/1403 - 82s - loss: 2.7372 - accuracy100: 0.5549 - val_loss: 3.2281 - val_accuracy100: 0.4868 - 82s/epoch - 59ms/step
Epoch 13/50
1403/1403 - 83s - loss: 2.7230 - accuracy100: 0.5581 - val_loss: 3.2098 - val_accuracy100: 0.4940 - 83s/epoch - 59ms/step
Epoch 14/50
1403/1403 - 79s - loss: 2.7125 - accuracy100: 0.5603 - val_loss: 3.2682 - val_accuracy100: 0.4861 - 79s/epoch - 56ms/step
Epoch 15/50
1403/1403 - 86s - loss: 2.6995 - accuracy100: 0.5636 - val_loss: 3.2189 - val_accuracy100: 0.4906 - 86s/epoch - 61ms/step
Epoch 16/50
1403/1403 - 85s - loss: 2.6888 - accuracy100: 0.5664 - val_loss: 3.1944 - val_accuracy100: 0.4900 - 85s/epoch - 60ms/step
Epoch 17/50
1403/1403 - 85s - loss: 2.6760 - accuracy100: 0.5689 - val_loss: 3.1966 - val_accuracy100: 0.4937 - 85s/epoch - 61ms/step
Epoch 18/50
1403/1403 - 83s - loss: 2.6665 - accuracy100: 0.5715 - val_loss: 3.2235 - val_accuracy100: 0.4909 - 83s/epoch - 59ms/step
Epoch 19/50
1403/1403 - 83s - loss: 2.6539 - accuracy100: 0.5738 - val_loss: 3.2542 - val_accuracy100: 0.4894 - 83s/epoch - 59ms/step
Epoch 20/50
1403/1403 - 85s - loss: 2.6442 - accuracy100: 0.5768 - val_loss: 3.2530 - val_accuracy100: 0.4890 - 85s/epoch - 61ms/step
Epoch 21/50
1403/1403 - 85s - loss: 2.6322 - accuracy100: 0.5798 - val_loss: 3.3000 - val_accuracy100: 0.4852 - 85s/epoch - 60ms/step
Epoch 22/50
1403/1403 - 85s - loss: 2.6192 - accuracy100: 0.5824 - val_loss: 3.2863 - val_accuracy100: 0.4872 - 85s/epoch - 61ms/step
Epoch 23/50
1403/1403 - 80s - loss: 2.6134 - accuracy100: 0.5834 - val_loss: 3.3381 - val_accuracy100: 0.4899 - 80s/epoch - 57ms/step
Epoch 24/50
1403/1403 - 78s - loss: 2.6019 - accuracy100: 0.5863 - val_loss: 3.3446 - val_accuracy100: 0.4868 - 78s/epoch - 55ms/step
Epoch 25/50
1403/1403 - 80s - loss: 2.5887 - accuracy100: 0.5886 - val_loss: 3.4043 - val_accuracy100: 0.4870 - 80s/epoch - 57ms/step
Epoch 26/50
1403/1403 - 82s - loss: 2.5814 - accuracy100: 0.5899 - val_loss: 3.4191 - val_accuracy100: 0.4811 - 82s/epoch - 58ms/step
testing model: results/EXC/W2/deepLOB_L2/h100
Evaluating performance on  test set...
4918/4918 - 108s - 108s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0597806
{'0': {'precision': 0.45002574291409786, 'recall': 0.5829200846203079, 'f1-score': 0.5079241082118899, 'support': 409358}, '1': {'precision': 0.43199382063455527, 'recall': 0.5164275021335932, 'f1-score': 0.4704522860711524, 'support': 428854}, '2': {'precision': 0.5754531729050305, 'recall': 0.295399486956377, 'f1-score': 0.3903957118776402, 'support': 420627}, 'accuracy': 0.46419597740457674, 'macro avg': {'precision': 0.4858242454845612, 'recall': 0.46491569123675935, 'f1-score': 0.45625736872022754, 'support': 1258839}, 'weighted avg': {'precision': 0.4857929074184746, 'recall': 0.46419597740457674, 'f1-score': 0.45588762254753545, 'support': 1258839}}
[[238623 130087  40648]
 [156361 221472  51021]
 [135259 161115 124253]]
Evaluating performance on  train set...
1403/1403 - 33s - 33s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0087782
{'0': {'precision': 0.4829883559412138, 'recall': 0.5093590624660903, 'f1-score': 0.4958233207460808, 'support': 110588}, '1': {'precision': 0.49873644190987365, 'recall': 0.6453956126642357, 'f1-score': 0.5626663639001376, 'support': 138216}, '2': {'precision': 0.5850001574951964, 'recall': 0.33713331397037466, 'f1-score': 0.4277537859158173, 'support': 110176}, 'accuracy': 0.5088779319182127, 'macro avg': {'precision': 0.5222416517820946, 'recall': 0.4972959963669002, 'f1-score': 0.49541449018734524, 'support': 358980}, 'weighted avg': {'precision': 0.5203606042510246, 'recall': 0.5088779319182127, 'f1-score': 0.5006680167824115, 'support': 358980}}
[[56329 43701 10558]
 [33220 89204 15792]
 [27077 45955 37144]]
Evaluating performance on  val set...
480/480 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0434569
{'0': {'precision': 0.483170808430324, 'recall': 0.47230051760364883, 'f1-score': 0.47767382797315155, 'support': 39026}, '1': {'precision': 0.4646569826972805, 'recall': 0.6091922639362912, 'f1-score': 0.5271977237597345, 'support': 43950}, '2': {'precision': 0.5526569689772896, 'recall': 0.3747515160665308, 'f1-score': 0.4466403754742161, 'support': 39741}, 'accuracy': 0.4897365483184889, 'macro avg': {'precision': 0.5001615867016314, 'recall': 0.48541476586882365, 'f1-score': 0.48383730906903405, 'support': 122717}, 'weighted avg': {'precision': 0.4990428299540713, 'recall': 0.4897365483184889, 'f1-score': 0.4853604140538097, 'support': 122717}}
[[18432 15687  4907]
 [10028 26774  7148]
 [ 9688 15160 14893]]
training model: results/EXC/W2/deepLOB_L2/h200
Epoch 1/50
1403/1403 - 90s - loss: 3.2454 - accuracy200: 0.4035 - val_loss: 3.3062 - val_accuracy200: 0.3784 - 90s/epoch - 64ms/step
Epoch 2/50
1403/1403 - 84s - loss: 3.1851 - accuracy200: 0.4279 - val_loss: 3.3477 - val_accuracy200: 0.4007 - 84s/epoch - 60ms/step
Epoch 3/50
1403/1403 - 88s - loss: 3.1644 - accuracy200: 0.4350 - val_loss: 3.4042 - val_accuracy200: 0.3880 - 88s/epoch - 63ms/step
Epoch 4/50
1403/1403 - 82s - loss: 3.1508 - accuracy200: 0.4418 - val_loss: 3.3568 - val_accuracy200: 0.3963 - 82s/epoch - 58ms/step
Epoch 5/50
1403/1403 - 81s - loss: 3.1352 - accuracy200: 0.4460 - val_loss: 3.3711 - val_accuracy200: 0.4016 - 81s/epoch - 58ms/step
Epoch 6/50
1403/1403 - 83s - loss: 3.1238 - accuracy200: 0.4492 - val_loss: 3.4014 - val_accuracy200: 0.3944 - 83s/epoch - 59ms/step
Epoch 7/50
1403/1403 - 87s - loss: 3.1153 - accuracy200: 0.4526 - val_loss: 3.3701 - val_accuracy200: 0.3958 - 87s/epoch - 62ms/step
Epoch 8/50
1403/1403 - 85s - loss: 3.1041 - accuracy200: 0.4563 - val_loss: 3.3861 - val_accuracy200: 0.3886 - 85s/epoch - 61ms/step
Epoch 9/50
1403/1403 - 84s - loss: 3.0885 - accuracy200: 0.4617 - val_loss: 3.4094 - val_accuracy200: 0.3832 - 84s/epoch - 60ms/step
Epoch 10/50
1403/1403 - 84s - loss: 3.0777 - accuracy200: 0.4654 - val_loss: 3.4162 - val_accuracy200: 0.3798 - 84s/epoch - 60ms/step
Epoch 11/50
1403/1403 - 81s - loss: 3.0666 - accuracy200: 0.4702 - val_loss: 3.4652 - val_accuracy200: 0.3794 - 81s/epoch - 58ms/step
testing model: results/EXC/W2/deepLOB_L2/h200
Evaluating performance on  test set...
4918/4918 - 104s - 104s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1059002
{'0': {'precision': 0.40107685768070767, 'recall': 0.22967359050445105, 'f1-score': 0.2920862354892206, 'support': 431360}, '1': {'precision': 0.3291416481666344, 'recall': 0.3436460507382585, 'f1-score': 0.3362375016964588, 'support': 385705}, '2': {'precision': 0.38932594783967744, 'recall': 0.5368061497507776, 'f1-score': 0.45132344209132014, 'support': 441774}, 'accuracy': 0.37237883478347905, 'macro avg': {'precision': 0.3731814845623398, 'recall': 0.3700419303311624, 'f1-score': 0.35988239309233316, 'support': 1258839}, 'weighted avg': {'precision': 0.3749122596425654, 'recall': 0.37237883478347905, 'f1-score': 0.36149639980880294, 'support': 1258839}}
[[ 99072 130738 201550]
 [ 82734 132546 170425]
 [ 65209 139418 237147]]
Evaluating performance on  train set...
1403/1403 - 33s - 33s/epoch - 23ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1056012
{'0': {'precision': 0.4260602496242567, 'recall': 0.2683193823715812, 'f1-score': 0.3292729733551502, 'support': 121497}, '1': {'precision': 0.33259113470242474, 'recall': 0.43252955979178875, 'f1-score': 0.37603347581282615, 'support': 116036}, '2': {'precision': 0.3996594761405269, 'recall': 0.4329460587746095, 'f1-score': 0.4156373883932982, 'support': 121447}, 'accuracy': 0.3770934313889353, 'macro avg': {'precision': 0.3861036201557361, 'recall': 0.37793166697932645, 'f1-score': 0.3736479458537582, 'support': 358980}, 'weighted avg': {'precision': 0.38691579323017283, 'recall': 0.3770934313889353, 'f1-score': 0.37360580743035454, 'support': 358980}}
[[32600 50381 38516]
 [25381 50189 40466]
 [18534 50333 52580]]
Evaluating performance on  val set...
480/480 - 12s - 12s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1047347
{'0': {'precision': 0.43054583624912524, 'recall': 0.2356884621830632, 'f1-score': 0.30462162120344727, 'support': 41767}, '1': {'precision': 0.3267651276702736, 'recall': 0.4553240079931487, 'f1-score': 0.3804783900418537, 'support': 38533}, '2': {'precision': 0.4134098786828423, 'recall': 0.4498903741424429, 'f1-score': 0.4308793479119862, 'support': 42417}, 'accuracy': 0.37869243870042457, 'macro avg': {'precision': 0.3902402808674137, 'recall': 0.3803009481062183, 'f1-score': 0.3719931197190957, 'support': 122717}, 'weighted avg': {'precision': 0.3920357850275511, 'recall': 0.37869243870042457, 'f1-score': 0.3720814097204939, 'support': 122717}}
[[ 9844 18346 13577]
 [ 7488 17545 13500]
 [ 5532 17802 19083]]
training model: results/EXC/W2/deepLOB_L2/h300
Epoch 1/50
1403/1403 - 85s - loss: 3.2591 - accuracy300: 0.3976 - val_loss: 3.3637 - val_accuracy300: 0.3630 - 85s/epoch - 61ms/step
Epoch 2/50
1403/1403 - 83s - loss: 3.2165 - accuracy300: 0.4154 - val_loss: 3.3014 - val_accuracy300: 0.3819 - 83s/epoch - 59ms/step
Epoch 3/50
1403/1403 - 78s - loss: 3.1972 - accuracy300: 0.4240 - val_loss: 3.3045 - val_accuracy300: 0.3933 - 78s/epoch - 56ms/step
Epoch 4/50
1403/1403 - 80s - loss: 3.1789 - accuracy300: 0.4327 - val_loss: 3.2884 - val_accuracy300: 0.3923 - 80s/epoch - 57ms/step
Epoch 5/50
1403/1403 - 82s - loss: 3.1699 - accuracy300: 0.4353 - val_loss: 3.3101 - val_accuracy300: 0.3888 - 82s/epoch - 58ms/step
Epoch 6/50
1403/1403 - 82s - loss: 3.1558 - accuracy300: 0.4407 - val_loss: 3.3553 - val_accuracy300: 0.3771 - 82s/epoch - 58ms/step
Epoch 7/50
1403/1403 - 82s - loss: 3.1405 - accuracy300: 0.4463 - val_loss: 3.3869 - val_accuracy300: 0.3785 - 82s/epoch - 59ms/step
Epoch 8/50
1403/1403 - 84s - loss: 3.1325 - accuracy300: 0.4480 - val_loss: 3.4186 - val_accuracy300: 0.3804 - 84s/epoch - 60ms/step
Epoch 9/50
1403/1403 - 82s - loss: 3.1197 - accuracy300: 0.4534 - val_loss: 3.3837 - val_accuracy300: 0.3876 - 82s/epoch - 58ms/step
Epoch 10/50
1403/1403 - 84s - loss: 3.1038 - accuracy300: 0.4599 - val_loss: 3.4224 - val_accuracy300: 0.3833 - 84s/epoch - 60ms/step
Epoch 11/50
1403/1403 - 82s - loss: 3.0902 - accuracy300: 0.4643 - val_loss: 3.4248 - val_accuracy300: 0.3835 - 82s/epoch - 58ms/step
Epoch 12/50
1403/1403 - 80s - loss: 3.0745 - accuracy300: 0.4692 - val_loss: 3.4686 - val_accuracy300: 0.3779 - 80s/epoch - 57ms/step
Epoch 13/50
1403/1403 - 82s - loss: 3.0570 - accuracy300: 0.4756 - val_loss: 3.4637 - val_accuracy300: 0.3872 - 82s/epoch - 58ms/step
Epoch 14/50
1403/1403 - 81s - loss: 3.0451 - accuracy300: 0.4781 - val_loss: 3.5502 - val_accuracy300: 0.3800 - 81s/epoch - 58ms/step
testing model: results/EXC/W2/deepLOB_L2/h300
Evaluating performance on  test set...
4918/4918 - 103s - 103s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979313
{'0': {'precision': 0.39224201538948034, 'recall': 0.4434223069590086, 'f1-score': 0.41626489177247045, 'support': 419600}, '1': {'precision': 0.3602578492093041, 'recall': 0.32494993246704856, 'f1-score': 0.3416942040117744, 'support': 407949}, '2': {'precision': 0.3836460018918569, 'recall': 0.3705094020264787, 'f1-score': 0.3769632890310588, 'support': 431290}, 'accuracy': 0.38004860033729493, 'macro avg': {'precision': 0.3787152888302137, 'recall': 0.3796272138175119, 'f1-score': 0.3783074616051012, 'support': 1258839}, 'weighted avg': {'precision': 0.378931907210097, 'recall': 0.38004860033729493, 'f1-score': 0.3786338478124155, 'support': 1258839}}
[[186060 109761 123779]
 [142440 132563 132946]
 [145850 125643 159797]]
Evaluating performance on  train set...
1403/1403 - 34s - 34s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0863295
{'0': {'precision': 0.4047992201267294, 'recall': 0.4468634625254549, 'f1-score': 0.4247925494871281, 'support': 120802}, '1': {'precision': 0.36520366356357986, 'recall': 0.2476423510220727, 'f1-score': 0.29514720400982203, 'support': 117702}, '2': {'precision': 0.4048912298027597, 'recall': 0.49003950994388923, 'f1-score': 0.44341464880129783, 'support': 120476}, 'accuracy': 0.39603320519248986, 'macro avg': {'precision': 0.39163137116435626, 'recall': 0.3948484411638056, 'f1-score': 0.3877848007660826, 'support': 358980}, 'weighted avg': {'precision': 0.39184754805344846, 'recall': 0.39603320519248986, 'f1-score': 0.3885342609574162, 'support': 358980}}
[[53982 24709 42111]
 [43891 29148 44663]
 [35482 25956 59038]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971981
{'0': {'precision': 0.41286875945537066, 'recall': 0.40440852994975574, 'f1-score': 0.40859485571918175, 'support': 43189}, '1': {'precision': 0.3247088186356073, 'recall': 0.21709263842923493, 'f1-score': 0.26021301065053254, 'support': 35957}, '2': {'precision': 0.40441346034449116, 'recall': 0.5232379334878704, 'f1-score': 0.4562154806691747, 'support': 43571}, 'accuracy': 0.39171426941662524, 'macro avg': {'precision': 0.38066367947848967, 'recall': 0.381579700622287, 'f1-score': 0.37500778234629634, 'support': 122717}, 'weighted avg': {'precision': 0.3840351599572053, 'recall': 0.39171426941662524, 'f1-score': 0.3820256945317564, 'support': 122717}}
[[17466  7874 17849]
 [12425  7806 15726]
 [12413  8360 22798]]
training model: results/EXC/W2/deepLOB_L2/h500
Epoch 1/50
1403/1403 - 89s - loss: 3.2725 - accuracy500: 0.3868 - val_loss: 3.4322 - val_accuracy500: 0.3179 - 89s/epoch - 63ms/step
Epoch 2/50
1403/1403 - 82s - loss: 3.2392 - accuracy500: 0.4026 - val_loss: 3.4276 - val_accuracy500: 0.3337 - 82s/epoch - 58ms/step
Epoch 3/50
1403/1403 - 84s - loss: 3.2206 - accuracy500: 0.4123 - val_loss: 3.4846 - val_accuracy500: 0.3385 - 84s/epoch - 60ms/step
Epoch 4/50
1403/1403 - 80s - loss: 3.1997 - accuracy500: 0.4229 - val_loss: 3.5123 - val_accuracy500: 0.3473 - 80s/epoch - 57ms/step
Epoch 5/50
1403/1403 - 88s - loss: 3.1831 - accuracy500: 0.4311 - val_loss: 3.5761 - val_accuracy500: 0.3476 - 88s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 81s - loss: 3.1650 - accuracy500: 0.4402 - val_loss: 3.5724 - val_accuracy500: 0.3431 - 81s/epoch - 58ms/step
Epoch 7/50
1403/1403 - 83s - loss: 3.1491 - accuracy500: 0.4465 - val_loss: 3.6356 - val_accuracy500: 0.3436 - 83s/epoch - 59ms/step
Epoch 8/50
1403/1403 - 89s - loss: 3.1344 - accuracy500: 0.4530 - val_loss: 3.6529 - val_accuracy500: 0.3480 - 89s/epoch - 63ms/step
Epoch 9/50
1403/1403 - 85s - loss: 3.1204 - accuracy500: 0.4581 - val_loss: 3.7415 - val_accuracy500: 0.3424 - 85s/epoch - 60ms/step
Epoch 10/50
1403/1403 - 81s - loss: 3.1106 - accuracy500: 0.4606 - val_loss: 3.6554 - val_accuracy500: 0.3408 - 81s/epoch - 58ms/step
Epoch 11/50
1403/1403 - 82s - loss: 3.0957 - accuracy500: 0.4661 - val_loss: 3.7159 - val_accuracy500: 0.3410 - 82s/epoch - 58ms/step
Epoch 12/50
1403/1403 - 87s - loss: 3.0797 - accuracy500: 0.4717 - val_loss: 3.8020 - val_accuracy500: 0.3466 - 87s/epoch - 62ms/step
testing model: results/EXC/W2/deepLOB_L2/h500
Evaluating performance on  test set...
4918/4918 - 115s - 115s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1334789
{'0': {'precision': 0.3504205016341506, 'recall': 0.4434049504532204, 'f1-score': 0.39146687664477087, 'support': 426062}, '1': {'precision': 0.30914900644447685, 'recall': 0.5130336797933986, 'f1-score': 0.38581170592735026, 'support': 392253}, '2': {'precision': 0.3668721647086193, 'recall': 0.057277242556591695, 'f1-score': 0.0990850186530532, 'support': 440524}, 'accuracy': 0.3299778605524614, 'macro avg': {'precision': 0.34214722426241556, 'recall': 0.3379052909344036, 'f1-score': 0.29212120040839146, 'support': 1258839}, 'weighted avg': {'precision': 0.3433175159636893, 'recall': 0.3299778605524614, 'f1-score': 0.28738725781395624, 'support': 1258839}}
[[188918 211847  25297]
 [172767 201239  18247]
 [177433 237859  25232]]
Evaluating performance on  train set...
1403/1403 - 32s - 32s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1321791
{'0': {'precision': 0.372439968039026, 'recall': 0.2909244705051451, 'f1-score': 0.3266738287463748, 'support': 121767}, '1': {'precision': 0.3269715952973483, 'recall': 0.4850874214904091, 'f1-score': 0.3906361601421663, 'support': 117820}, '2': {'precision': 0.3603273866328352, 'recall': 0.26880972921360546, 'f1-score': 0.30791223340464924, 'support': 119393}, 'accuracy': 0.34729511393392387, 'macro avg': {'precision': 0.3532463166564032, 'recall': 0.3482738737363866, 'f1-score': 0.3417407407643968, 'support': 358980}, 'weighted avg': {'precision': 0.3534883799052754, 'recall': 0.34729511393392387, 'f1-score': 0.34142684766781195, 'support': 358980}}
[[35425 58447 27895]
 [31587 57153 29080]
 [28104 59195 32094]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 24ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1444849
{'0': {'precision': 0.37471740168762935, 'recall': 0.27966444069488344, 'f1-score': 0.3202874095041098, 'support': 42079}, '1': {'precision': 0.3024159402241594, 'recall': 0.478295123296305, 'f1-score': 0.37054443359375, 'support': 38079}, '2': {'precision': 0.35371698780840866, 'recall': 0.25837073239502806, 'f1-score': 0.29861771175623925, 'support': 42559}, 'accuracy': 0.3339146165567933, 'macro avg': {'precision': 0.3436167765733991, 'recall': 0.33877676546207214, 'f1-score': 0.32981651828469966, 'support': 122717}, 'weighted avg': {'precision': 0.34499923741248223, 'recall': 0.3339146165567933, 'f1-score': 0.3283669466005006, 'support': 122717}}
[[11768 20247 10064]
 [ 9839 18213 10027]
 [ 9798 21765 10996]]
training model: results/EXC/W2/deepLOB_L2/h1000
Epoch 1/50
1403/1403 - 88s - loss: 3.2094 - accuracy1000: 0.4308 - val_loss: 3.3819 - val_accuracy1000: 0.3638 - 88s/epoch - 63ms/step
Epoch 2/50
1403/1403 - 83s - loss: 3.1602 - accuracy1000: 0.4507 - val_loss: 3.5943 - val_accuracy1000: 0.3959 - 83s/epoch - 59ms/step
Epoch 3/50
1403/1403 - 85s - loss: 3.1251 - accuracy1000: 0.4646 - val_loss: 3.5885 - val_accuracy1000: 0.3943 - 85s/epoch - 61ms/step
Epoch 4/50
1403/1403 - 83s - loss: 3.0935 - accuracy1000: 0.4812 - val_loss: 3.6015 - val_accuracy1000: 0.3977 - 83s/epoch - 59ms/step
Epoch 5/50
1403/1403 - 83s - loss: 3.0655 - accuracy1000: 0.4907 - val_loss: 3.5124 - val_accuracy1000: 0.4029 - 83s/epoch - 59ms/step
Epoch 6/50
1403/1403 - 83s - loss: 3.0397 - accuracy1000: 0.4975 - val_loss: 3.5983 - val_accuracy1000: 0.4032 - 83s/epoch - 59ms/step
Epoch 7/50
1403/1403 - 82s - loss: 3.0183 - accuracy1000: 0.5048 - val_loss: 3.5682 - val_accuracy1000: 0.4079 - 82s/epoch - 58ms/step
Epoch 8/50
1403/1403 - 80s - loss: 2.9998 - accuracy1000: 0.5094 - val_loss: 3.3846 - val_accuracy1000: 0.4041 - 80s/epoch - 57ms/step
Epoch 9/50
1403/1403 - 84s - loss: 2.9887 - accuracy1000: 0.5122 - val_loss: 3.4078 - val_accuracy1000: 0.4044 - 84s/epoch - 60ms/step
Epoch 10/50
1403/1403 - 81s - loss: 2.9659 - accuracy1000: 0.5182 - val_loss: 3.4026 - val_accuracy1000: 0.3948 - 81s/epoch - 58ms/step
Epoch 11/50
1403/1403 - 82s - loss: 2.9563 - accuracy1000: 0.5207 - val_loss: 3.4373 - val_accuracy1000: 0.4050 - 82s/epoch - 58ms/step
testing model: results/EXC/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
4918/4918 - 107s - 107s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2094214
{'0': {'precision': 0.32870891128021307, 'recall': 0.9372938011119645, 'f1-score': 0.48672379908419233, 'support': 414042}, '1': {'precision': 0.3388530264758163, 'recall': 0.06158487412920338, 'f1-score': 0.10422700225070142, 'support': 411692}, '2': {'precision': 0.24235294117647058, 'recall': 0.0019025409542720588, 'f1-score': 0.0037754435802568125, 'support': 433105}, 'accuracy': 0.3290786192674361, 'macro avg': {'precision': 0.30330495964416665, 'recall': 0.3335937387318133, 'f1-score': 0.19824208163838353, 'support': 1258839}, 'weighted avg': {'precision': 0.3023155826983427, 'recall': 0.3290786192674361, 'f1-score': 0.1954727186898722, 'support': 1258839}}
[[388079  24140   1823]
 [385585  25354    753]
 [406952  25329    824]]
Evaluating performance on  train set...
1403/1403 - 30s - 30s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1257007
{'0': {'precision': 0.32232594770028744, 'recall': 0.5342157115421389, 'f1-score': 0.40206237172748666, 'support': 120281}, '1': {'precision': 0.45198237885462555, 'recall': 0.046761963952765696, 'f1-score': 0.08475518173625714, 'support': 120675}, '2': {'precision': 0.38770863915620074, 'recall': 0.48336778960211485, 'f1-score': 0.43028570566584207, 'support': 118024}, 'accuracy': 0.353635300016714, 'macro avg': {'precision': 0.38733898857037125, 'recall': 0.35478182169900646, 'f1-score': 0.3057010863765286, 'support': 358980}, 'weighted avg': {'precision': 0.3874076141049408, 'recall': 0.353635300016714, 'f1-score': 0.30467529058800485, 'support': 358980}}
[[64256  3583 52442]
 [77379  5643 37653]
 [57716  3259 57049]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1263976
{'0': {'precision': 0.3469359901733315, 'recall': 0.5305043478260869, 'f1-score': 0.41951809880074814, 'support': 43125}, '1': {'precision': 0.3529613146182814, 'recall': 0.028526368214265952, 'f1-score': 0.052786524332488545, 'support': 36142}, '2': {'precision': 0.38586522570701726, 'recall': 0.47825086306098963, 'f1-score': 0.4271194105012179, 'support': 43450}, 'accuracy': 0.3641630743906712, 'macro avg': {'precision': 0.36192084349954334, 'recall': 0.3457605263671142, 'f1-score': 0.29980801121148487, 'support': 122717}, 'weighted avg': {'precision': 0.362494083673238, 'recall': 0.3641630743906712, 'f1-score': 0.31420151209274166, 'support': 122717}}
[[22878   850 19397]
 [21435  1031 13676]
 [21630  1040 20780]]
training model: results/EXC/W2/deepOF_L2/h10
Epoch 1/50
1403/1403 - 61s - loss: 2.5692 - accuracy10: 0.5458 - val_loss: 2.8452 - val_accuracy10: 0.7654 - 61s/epoch - 44ms/step
Epoch 2/50
1403/1403 - 56s - loss: 2.1326 - accuracy10: 0.6367 - val_loss: 2.7121 - val_accuracy10: 0.7627 - 56s/epoch - 40ms/step
Epoch 3/50
1403/1403 - 61s - loss: 2.0195 - accuracy10: 0.6520 - val_loss: 2.5973 - val_accuracy10: 0.7597 - 61s/epoch - 43ms/step
Epoch 4/50
1403/1403 - 59s - loss: 1.9732 - accuracy10: 0.6575 - val_loss: 2.6105 - val_accuracy10: 0.7686 - 59s/epoch - 42ms/step
Epoch 5/50
1403/1403 - 59s - loss: 1.9470 - accuracy10: 0.6607 - val_loss: 2.5531 - val_accuracy10: 0.7621 - 59s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 58s - loss: 1.9259 - accuracy10: 0.6642 - val_loss: 2.5865 - val_accuracy10: 0.7707 - 58s/epoch - 41ms/step
Epoch 7/50
1403/1403 - 58s - loss: 1.9074 - accuracy10: 0.6664 - val_loss: 2.5801 - val_accuracy10: 0.7715 - 58s/epoch - 41ms/step
Epoch 8/50
1403/1403 - 56s - loss: 1.8959 - accuracy10: 0.6662 - val_loss: 2.5351 - val_accuracy10: 0.7740 - 56s/epoch - 40ms/step
Epoch 9/50
1403/1403 - 57s - loss: 1.8843 - accuracy10: 0.6686 - val_loss: 2.5194 - val_accuracy10: 0.7715 - 57s/epoch - 41ms/step
Epoch 10/50
1403/1403 - 61s - loss: 1.8754 - accuracy10: 0.6703 - val_loss: 2.4854 - val_accuracy10: 0.7698 - 61s/epoch - 43ms/step
Epoch 11/50
1403/1403 - 56s - loss: 1.8624 - accuracy10: 0.6711 - val_loss: 2.5101 - val_accuracy10: 0.7739 - 56s/epoch - 40ms/step
Epoch 12/50
1403/1403 - 55s - loss: 1.8571 - accuracy10: 0.6713 - val_loss: 2.4801 - val_accuracy10: 0.7700 - 55s/epoch - 39ms/step
Epoch 13/50
1403/1403 - 59s - loss: 1.8506 - accuracy10: 0.6726 - val_loss: 2.5039 - val_accuracy10: 0.7731 - 59s/epoch - 42ms/step
Epoch 14/50
1403/1403 - 54s - loss: 1.8433 - accuracy10: 0.6735 - val_loss: 2.4885 - val_accuracy10: 0.7734 - 54s/epoch - 39ms/step
Epoch 15/50
1403/1403 - 56s - loss: 1.8352 - accuracy10: 0.6740 - val_loss: 2.5026 - val_accuracy10: 0.7737 - 56s/epoch - 40ms/step
Epoch 16/50
1403/1403 - 53s - loss: 1.8295 - accuracy10: 0.6747 - val_loss: 2.5180 - val_accuracy10: 0.7765 - 53s/epoch - 38ms/step
Epoch 17/50
1403/1403 - 59s - loss: 1.8244 - accuracy10: 0.6758 - val_loss: 2.4760 - val_accuracy10: 0.7669 - 59s/epoch - 42ms/step
Epoch 18/50
1403/1403 - 57s - loss: 1.8175 - accuracy10: 0.6761 - val_loss: 2.5373 - val_accuracy10: 0.7715 - 57s/epoch - 41ms/step
Epoch 19/50
1403/1403 - 57s - loss: 1.8131 - accuracy10: 0.6766 - val_loss: 2.4883 - val_accuracy10: 0.7694 - 57s/epoch - 41ms/step
Epoch 20/50
1403/1403 - 60s - loss: 1.8051 - accuracy10: 0.6774 - val_loss: 2.5249 - val_accuracy10: 0.7727 - 60s/epoch - 43ms/step
Epoch 21/50
1403/1403 - 57s - loss: 1.8017 - accuracy10: 0.6778 - val_loss: 2.5156 - val_accuracy10: 0.7712 - 57s/epoch - 41ms/step
Epoch 22/50
1403/1403 - 57s - loss: 1.7952 - accuracy10: 0.6794 - val_loss: 2.4984 - val_accuracy10: 0.7668 - 57s/epoch - 41ms/step
Epoch 23/50
1403/1403 - 54s - loss: 1.7896 - accuracy10: 0.6794 - val_loss: 2.5229 - val_accuracy10: 0.7687 - 54s/epoch - 39ms/step
Epoch 24/50
1403/1403 - 58s - loss: 1.7865 - accuracy10: 0.6796 - val_loss: 2.5221 - val_accuracy10: 0.7691 - 58s/epoch - 41ms/step
Epoch 25/50
1403/1403 - 58s - loss: 1.7777 - accuracy10: 0.6806 - val_loss: 2.5100 - val_accuracy10: 0.7678 - 58s/epoch - 41ms/step
Epoch 26/50
1403/1403 - 59s - loss: 1.7721 - accuracy10: 0.6815 - val_loss: 2.5607 - val_accuracy10: 0.7721 - 59s/epoch - 42ms/step
Epoch 27/50
1403/1403 - 58s - loss: 1.7704 - accuracy10: 0.6811 - val_loss: 2.5201 - val_accuracy10: 0.7674 - 58s/epoch - 41ms/step
testing model: results/EXC/W2/deepOF_L2/h10
Evaluating performance on  test set...
4918/4918 - 86s - 86s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55439454
{'0': {'precision': 0.4361320013469525, 'recall': 0.5875225095192929, 'f1-score': 0.5006325184777388, 'support': 145494}, '1': {'precision': 0.9015223206040028, 'recall': 0.8175728073023403, 'f1-score': 0.8574977876873959, 'support': 967142}, '2': {'precision': 0.4289705739849478, 'recall': 0.5450348157977537, 'f1-score': 0.48008748252759437, 'support': 146198}, 'accuracy': 0.759332048546512, 'macro avg': {'precision': 0.5888749653119677, 'recall': 0.6500433775397956, 'f1-score': 0.6127392628975764, 'support': 1258834}, 'weighted avg': {'precision': 0.7928522184601159, 'recall': 0.759332048546512, 'f1-score': 0.7724203372275715, 'support': 1258834}}
[[ 85481  39492  20521]
 [ 90883 790709  85550]
 [ 19634  46881  79683]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5187368
{'0': {'precision': 0.3959089830848676, 'recall': 0.6020756444765103, 'f1-score': 0.4776970497578159, 'support': 36037}, '1': {'precision': 0.9158202315118023, 'recall': 0.8243947533663574, 'f1-score': 0.867705887428562, 'support': 286660}, '2': {'precision': 0.4396757272293753, 'recall': 0.559049692693548, 'f1-score': 0.49222854508171865, 'support': 36283}, 'accuracy': 0.7752576745222575, 'macro avg': {'precision': 0.5838016472753483, 'recall': 0.6618400301788052, 'f1-score': 0.6125438274226989, 'support': 358980}, 'weighted avg': {'precision': 0.8155026853854422, 'recall': 0.7752576745222575, 'f1-score': 0.790603561684757, 'support': 358980}}
[[ 21697  10148   4192]
 [ 28681 236321  21658]
 [  4425  11574  20284]]
Evaluating performance on  val set...
480/480 - 11s - 11s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5343828
{'0': {'precision': 0.41665764107007475, 'recall': 0.5728111971411555, 'f1-score': 0.482412690450812, 'support': 13432}, '1': {'precision': 0.9091140029791116, 'recall': 0.8192545420490729, 'f1-score': 0.8618483347472702, 'support': 96102}, '2': {'precision': 0.4323114410381368, 'recall': 0.578743741465635, 'f1-score': 0.4949236108858542, 'support': 13182}, 'accuracy': 0.7664444734182991, 'macro avg': {'precision': 0.5860276950291078, 'recall': 0.6569364935519544, 'f1-score': 0.6130615453613121, 'support': 122716}, 'weighted avg': {'precision': 0.8039941716232321, 'recall': 0.7664444734182991, 'f1-score': 0.780902237383184, 'support': 122716}}
[[ 7694  3896  1842]
 [ 9194 78732  8176]
 [ 1578  3975  7629]]
training model: results/EXC/W2/deepOF_L2/h20
Epoch 1/50
1403/1403 - 62s - loss: 2.6038 - accuracy20: 0.5482 - val_loss: 2.9993 - val_accuracy20: 0.7384 - 62s/epoch - 44ms/step
Epoch 2/50
1403/1403 - 58s - loss: 2.2057 - accuracy20: 0.6310 - val_loss: 2.7516 - val_accuracy20: 0.7345 - 58s/epoch - 41ms/step
Epoch 3/50
1403/1403 - 58s - loss: 2.1061 - accuracy20: 0.6457 - val_loss: 2.6774 - val_accuracy20: 0.7322 - 58s/epoch - 41ms/step
Epoch 4/50
1403/1403 - 64s - loss: 2.0692 - accuracy20: 0.6511 - val_loss: 2.6488 - val_accuracy20: 0.7352 - 64s/epoch - 46ms/step
Epoch 5/50
1403/1403 - 61s - loss: 2.0443 - accuracy20: 0.6547 - val_loss: 2.6680 - val_accuracy20: 0.7442 - 61s/epoch - 44ms/step
Epoch 6/50
1403/1403 - 57s - loss: 2.0262 - accuracy20: 0.6574 - val_loss: 2.6244 - val_accuracy20: 0.7391 - 57s/epoch - 41ms/step
Epoch 7/50
1403/1403 - 59s - loss: 2.0119 - accuracy20: 0.6603 - val_loss: 2.6042 - val_accuracy20: 0.7454 - 59s/epoch - 42ms/step
Epoch 8/50
1403/1403 - 57s - loss: 2.0007 - accuracy20: 0.6619 - val_loss: 2.6121 - val_accuracy20: 0.7369 - 57s/epoch - 41ms/step
Epoch 9/50
1403/1403 - 59s - loss: 1.9912 - accuracy20: 0.6624 - val_loss: 2.5935 - val_accuracy20: 0.7431 - 59s/epoch - 42ms/step
Epoch 10/50
1403/1403 - 58s - loss: 1.9819 - accuracy20: 0.6640 - val_loss: 2.5824 - val_accuracy20: 0.7419 - 58s/epoch - 41ms/step
Epoch 11/50
1403/1403 - 61s - loss: 1.9695 - accuracy20: 0.6657 - val_loss: 2.6281 - val_accuracy20: 0.7478 - 61s/epoch - 43ms/step
Epoch 12/50
1403/1403 - 58s - loss: 1.9646 - accuracy20: 0.6662 - val_loss: 2.5901 - val_accuracy20: 0.7473 - 58s/epoch - 41ms/step
Epoch 13/50
1403/1403 - 57s - loss: 1.9571 - accuracy20: 0.6676 - val_loss: 2.6049 - val_accuracy20: 0.7452 - 57s/epoch - 41ms/step
Epoch 14/50
1403/1403 - 60s - loss: 1.9503 - accuracy20: 0.6678 - val_loss: 2.6345 - val_accuracy20: 0.7500 - 60s/epoch - 42ms/step
Epoch 15/50
1403/1403 - 61s - loss: 1.9440 - accuracy20: 0.6689 - val_loss: 2.6263 - val_accuracy20: 0.7496 - 61s/epoch - 43ms/step
Epoch 16/50
1403/1403 - 60s - loss: 1.9364 - accuracy20: 0.6710 - val_loss: 2.6134 - val_accuracy20: 0.7499 - 60s/epoch - 43ms/step
Epoch 17/50
1403/1403 - 63s - loss: 1.9318 - accuracy20: 0.6707 - val_loss: 2.6368 - val_accuracy20: 0.7496 - 63s/epoch - 45ms/step
Epoch 18/50
1403/1403 - 67s - loss: 1.9242 - accuracy20: 0.6712 - val_loss: 2.6521 - val_accuracy20: 0.7490 - 67s/epoch - 48ms/step
Epoch 19/50
1403/1403 - 56s - loss: 1.9195 - accuracy20: 0.6714 - val_loss: 2.6515 - val_accuracy20: 0.7503 - 56s/epoch - 40ms/step
Epoch 20/50
1403/1403 - 56s - loss: 1.9131 - accuracy20: 0.6726 - val_loss: 2.6459 - val_accuracy20: 0.7467 - 56s/epoch - 40ms/step
testing model: results/EXC/W2/deepOF_L2/h20
Evaluating performance on  test set...
4918/4918 - 85s - 85s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6215502
{'0': {'precision': 0.5345098254473597, 'recall': 0.48056793450098456, 'f1-score': 0.5061056264276563, 'support': 202629}, '1': {'precision': 0.8260556996843059, 'recall': 0.8390285200275147, 'f1-score': 0.8324915736530971, 'support': 850455}, '2': {'precision': 0.5155678128949507, 'recall': 0.5333414337788578, 'f1-score': 0.5243040375734902, 'support': 205750}, 'accuracy': 0.7313656923788204, 'macro avg': {'precision': 0.6253777793422054, 'recall': 0.617645962769119, 'f1-score': 0.6209670792180811, 'support': 1258834}, 'weighted avg': {'precision': 0.728379173901186, 'recall': 0.7313656923788204, 'f1-score': 0.7295829743868533, 'support': 1258834}}
[[ 97377  75221  30031]
 [ 63822 713556  73077]
 [ 20981  75034 109735]]
Evaluating performance on  train set...
1403/1403 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57711506
{'0': {'precision': 0.5098632457945056, 'recall': 0.49536538046992884, 'f1-score': 0.5025097657220671, 'support': 51029}, '1': {'precision': 0.850591093874118, 'recall': 0.8514962637259832, 'f1-score': 0.8510434381154415, 'support': 256539}, '2': {'precision': 0.5262787602205743, 'recall': 0.5383373531471252, 'f1-score': 0.5322397646199112, 'support': 51412}, 'accuracy': 0.7560226196445484, 'macro avg': {'precision': 0.6289110332963993, 'recall': 0.6283996657810124, 'f1-score': 0.6285976561524732, 'support': 358980}, 'weighted avg': {'precision': 0.7557096323513297, 'recall': 0.7560226196445484, 'f1-score': 0.7558413120072636, 'support': 358980}}
[[ 25278  19542   6209]
 [ 19393 218442  18704]
 [  4907  18828  27677]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6026742
{'0': {'precision': 0.5222163526442449, 'recall': 0.4743295836221144, 'f1-score': 0.4971224227524166, 'support': 18757}, '1': {'precision': 0.8402519559428994, 'recall': 0.8383148039789351, 'f1-score': 0.8392822621746543, 'support': 85450}, '2': {'precision': 0.5123372172721041, 'recall': 0.5654006159165811, 'f1-score': 0.5375626043405677, 'support': 18509}, 'accuracy': 0.7415169985983898, 'macro avg': {'precision': 0.6249351752864162, 'recall': 0.6260150011725436, 'f1-score': 0.6246557630892129, 'support': 122716}, 'weighted avg': {'precision': 0.7421818778020651, 'recall': 0.7415169985983898, 'f1-score': 0.7414757719460451, 'support': 122716}}
[[ 8897  7210  2650]
 [ 6505 71634  7311]
 [ 1635  6409 10465]]
training model: results/EXC/W2/deepOF_L2/h30
Epoch 1/50
1403/1403 - 68s - loss: 2.6781 - accuracy30: 0.5403 - val_loss: 2.9992 - val_accuracy30: 0.6931 - 68s/epoch - 49ms/step
Epoch 2/50
1403/1403 - 60s - loss: 2.3309 - accuracy30: 0.6126 - val_loss: 2.9127 - val_accuracy30: 0.7046 - 60s/epoch - 42ms/step
Epoch 3/50
1403/1403 - 59s - loss: 2.2328 - accuracy30: 0.6289 - val_loss: 2.8306 - val_accuracy30: 0.7059 - 59s/epoch - 42ms/step
Epoch 4/50
1403/1403 - 60s - loss: 2.1946 - accuracy30: 0.6347 - val_loss: 2.8660 - val_accuracy30: 0.7085 - 60s/epoch - 43ms/step
Epoch 5/50
1403/1403 - 59s - loss: 2.1692 - accuracy30: 0.6375 - val_loss: 2.8298 - val_accuracy30: 0.7089 - 59s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 59s - loss: 2.1538 - accuracy30: 0.6408 - val_loss: 2.8295 - val_accuracy30: 0.7099 - 59s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 57s - loss: 2.1411 - accuracy30: 0.6430 - val_loss: 2.7940 - val_accuracy30: 0.7079 - 57s/epoch - 41ms/step
Epoch 8/50
1403/1403 - 60s - loss: 2.1282 - accuracy30: 0.6442 - val_loss: 2.7933 - val_accuracy30: 0.7062 - 60s/epoch - 43ms/step
Epoch 9/50
1403/1403 - 58s - loss: 2.1198 - accuracy30: 0.6459 - val_loss: 2.7969 - val_accuracy30: 0.7057 - 58s/epoch - 41ms/step
Epoch 10/50
1403/1403 - 55s - loss: 2.1087 - accuracy30: 0.6475 - val_loss: 2.8116 - val_accuracy30: 0.7051 - 55s/epoch - 39ms/step
Epoch 11/50
1403/1403 - 54s - loss: 2.1003 - accuracy30: 0.6485 - val_loss: 2.8017 - val_accuracy30: 0.7076 - 54s/epoch - 38ms/step
Epoch 12/50
1403/1403 - 55s - loss: 2.0921 - accuracy30: 0.6492 - val_loss: 2.8124 - val_accuracy30: 0.7087 - 55s/epoch - 39ms/step
Epoch 13/50
1403/1403 - 57s - loss: 2.0856 - accuracy30: 0.6508 - val_loss: 2.7878 - val_accuracy30: 0.7073 - 57s/epoch - 41ms/step
Epoch 14/50
1403/1403 - 57s - loss: 2.0794 - accuracy30: 0.6511 - val_loss: 2.8129 - val_accuracy30: 0.7091 - 57s/epoch - 41ms/step
Epoch 15/50
1403/1403 - 58s - loss: 2.0713 - accuracy30: 0.6521 - val_loss: 2.8458 - val_accuracy30: 0.7072 - 58s/epoch - 41ms/step
Epoch 16/50
1403/1403 - 58s - loss: 2.0656 - accuracy30: 0.6531 - val_loss: 2.8333 - val_accuracy30: 0.7082 - 58s/epoch - 41ms/step
Epoch 17/50
1403/1403 - 57s - loss: 2.0581 - accuracy30: 0.6529 - val_loss: 2.8059 - val_accuracy30: 0.7091 - 57s/epoch - 40ms/step
Epoch 18/50
1403/1403 - 56s - loss: 2.0533 - accuracy30: 0.6539 - val_loss: 2.8752 - val_accuracy30: 0.7123 - 56s/epoch - 40ms/step
Epoch 19/50
1403/1403 - 57s - loss: 2.0463 - accuracy30: 0.6543 - val_loss: 2.8368 - val_accuracy30: 0.7116 - 57s/epoch - 40ms/step
Epoch 20/50
1403/1403 - 56s - loss: 2.0379 - accuracy30: 0.6555 - val_loss: 2.8344 - val_accuracy30: 0.7109 - 56s/epoch - 40ms/step
Epoch 21/50
1403/1403 - 55s - loss: 2.0301 - accuracy30: 0.6569 - val_loss: 2.8593 - val_accuracy30: 0.7103 - 55s/epoch - 39ms/step
Epoch 22/50
1403/1403 - 60s - loss: 2.0245 - accuracy30: 0.6568 - val_loss: 2.8442 - val_accuracy30: 0.7111 - 60s/epoch - 43ms/step
Epoch 23/50
1403/1403 - 55s - loss: 2.0173 - accuracy30: 0.6576 - val_loss: 2.8549 - val_accuracy30: 0.7064 - 55s/epoch - 39ms/step
testing model: results/EXC/W2/deepOF_L2/h30
Evaluating performance on  test set...
4918/4918 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71193075
{'0': {'precision': 0.5800461914888752, 'recall': 0.41700161928011903, 'f1-score': 0.4851927831255589, 'support': 243318}, '1': {'precision': 0.7576366838468769, 'recall': 0.8399203377429288, 'f1-score': 0.79665946289646, 'support': 766737}, '2': {'precision': 0.5479668748744126, 'recall': 0.5151962183303254, 'f1-score': 0.5310764895997349, 'support': 248779}, 'accuracy': 0.6940009564406426, 'macro avg': {'precision': 0.6285499167367216, 'recall': 0.5907060584511244, 'f1-score': 0.6043095785405846, 'support': 1258834}, 'weighted avg': {'precision': 0.6818741855143525, 'recall': 0.6940009564406426, 'f1-score': 0.6839703266781165, 'support': 1258834}}
[[101464 106936  34918]
 [ 51926 643998  70813]
 [ 21534  99075 128170]]
Evaluating performance on  train set...
1403/1403 - 32s - 32s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.65044355
{'0': {'precision': 0.567098121085595, 'recall': 0.4362363294737349, 'f1-score': 0.4931332770561591, 'support': 62269}, '1': {'precision': 0.7912668569741116, 'recall': 0.8582984539164602, 'f1-score': 0.8234207102834372, 'support': 234140}, '2': {'precision': 0.5623850801155765, 'recall': 0.5132569401160282, 'f1-score': 0.5366990875363481, 'support': 62571}, 'accuracy': 0.7249456794250376, 'macro avg': {'precision': 0.640250019391761, 'recall': 0.6025972411687411, 'f1-score': 0.6177510249586482, 'support': 358980}, 'weighted avg': {'precision': 0.7124877476230128, 'recall': 0.7249456794250376, 'f1-score': 0.7161525425957179, 'support': 358980}}
[[ 27164  27556   7549]
 [ 15737 200962  17441]
 [  4999  25457  32115]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68577063
{'0': {'precision': 0.5707251838793994, 'recall': 0.41372168855204017, 'f1-score': 0.4797036658577085, 'support': 22694}, '1': {'precision': 0.7741851368970013, 'recall': 0.843422343887196, 'f1-score': 0.807321986972697, 'support': 77444}, '2': {'precision': 0.5493491664763644, 'recall': 0.5327309770573124, 'f1-score': 0.5409124637420457, 'support': 22578}, 'accuracy': 0.7067945500179276, 'macro avg': {'precision': 0.6314198290842551, 'recall': 0.5966250031655161, 'f1-score': 0.6093127055241504, 'support': 122716}, 'weighted avg': {'precision': 0.6951924487883716, 'recall': 0.7067945500179276, 'f1-score': 0.6977196173152342, 'support': 122716}}
[[ 9389 10315  2990]
 [ 5249 65318  6877]
 [ 1813  8737 12028]]
training model: results/EXC/W2/deepOF_L2/h50
Epoch 1/50
1403/1403 - 63s - loss: 2.8242 - accuracy50: 0.5225 - val_loss: 3.3005 - val_accuracy50: 0.6120 - 63s/epoch - 45ms/step
Epoch 2/50
1403/1403 - 61s - loss: 2.5442 - accuracy50: 0.5829 - val_loss: 3.1043 - val_accuracy50: 0.6243 - 61s/epoch - 43ms/step
Epoch 3/50
1403/1403 - 60s - loss: 2.4639 - accuracy50: 0.5984 - val_loss: 3.0596 - val_accuracy50: 0.6282 - 60s/epoch - 43ms/step
Epoch 4/50
1403/1403 - 59s - loss: 2.4293 - accuracy50: 0.6054 - val_loss: 3.0468 - val_accuracy50: 0.6324 - 59s/epoch - 42ms/step
Epoch 5/50
1403/1403 - 58s - loss: 2.4093 - accuracy50: 0.6094 - val_loss: 3.0335 - val_accuracy50: 0.6338 - 58s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 58s - loss: 2.3939 - accuracy50: 0.6109 - val_loss: 2.9917 - val_accuracy50: 0.6341 - 58s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 60s - loss: 2.3800 - accuracy50: 0.6127 - val_loss: 3.0013 - val_accuracy50: 0.6355 - 60s/epoch - 42ms/step
Epoch 8/50
1403/1403 - 59s - loss: 2.3692 - accuracy50: 0.6152 - val_loss: 2.9993 - val_accuracy50: 0.6366 - 59s/epoch - 42ms/step
Epoch 9/50
1403/1403 - 59s - loss: 2.3595 - accuracy50: 0.6167 - val_loss: 3.0233 - val_accuracy50: 0.6367 - 59s/epoch - 42ms/step
Epoch 10/50
1403/1403 - 58s - loss: 2.3515 - accuracy50: 0.6180 - val_loss: 3.0055 - val_accuracy50: 0.6361 - 58s/epoch - 42ms/step
Epoch 11/50
1403/1403 - 61s - loss: 2.3436 - accuracy50: 0.6185 - val_loss: 3.0096 - val_accuracy50: 0.6361 - 61s/epoch - 43ms/step
Epoch 12/50
1403/1403 - 62s - loss: 2.3369 - accuracy50: 0.6198 - val_loss: 3.0288 - val_accuracy50: 0.6362 - 62s/epoch - 44ms/step
Epoch 13/50
1403/1403 - 57s - loss: 2.3296 - accuracy50: 0.6212 - val_loss: 3.0207 - val_accuracy50: 0.6348 - 57s/epoch - 41ms/step
Epoch 14/50
1403/1403 - 59s - loss: 2.3217 - accuracy50: 0.6218 - val_loss: 3.0544 - val_accuracy50: 0.6356 - 59s/epoch - 42ms/step
Epoch 15/50
1403/1403 - 63s - loss: 2.3152 - accuracy50: 0.6225 - val_loss: 3.0854 - val_accuracy50: 0.6353 - 63s/epoch - 45ms/step
Epoch 16/50
1403/1403 - 61s - loss: 2.3101 - accuracy50: 0.6238 - val_loss: 3.0587 - val_accuracy50: 0.6346 - 61s/epoch - 43ms/step
testing model: results/EXC/W2/deepOF_L2/h50
Evaluating performance on  test set...
4918/4918 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8502233
{'0': {'precision': 0.6013743704769563, 'recall': 0.36868067717454756, 'f1-score': 0.45711861544276716, 'support': 308340}, '1': {'precision': 0.6239869173250204, 'recall': 0.8483179510662319, 'f1-score': 0.7190620836236047, 'support': 633305}, '2': {'precision': 0.6147086430158608, 'recall': 0.4046830123364934, 'f1-score': 0.48805999942966316, 'support': 317189}, 'accuracy': 0.6190522340515111, 'macro avg': {'precision': 0.6133566436059459, 'recall': 0.5405605468590909, 'f1-score': 0.5547468994986784, 'support': 1258834}, 'weighted avg': {'precision': 0.6161103273655976, 'recall': 0.6190522340515111, 'f1-score': 0.5966956961076403, 'support': 1258834}}
[[113679 163326  31335]
 [ 46941 537244  49120]
 [ 28412 160416 128361]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.788664
{'0': {'precision': 0.5888781055900622, 'recall': 0.37639104273928414, 'f1-score': 0.4592469252601703, 'support': 80605}, '1': {'precision': 0.6689159850254075, 'recall': 0.8639179112018269, 'f1-score': 0.7540132064863913, 'support': 197932}, '2': {'precision': 0.619850656993459, 'recall': 0.3993510933207364, 'f1-score': 0.4857488470552657, 'support': 80443}, 'accuracy': 0.6503454231433506, 'macro avg': {'precision': 0.6258815825363095, 'recall': 0.5465533490872826, 'f1-score': 0.5663363262672758, 'support': 358980}, 'weighted avg': {'precision': 0.6399494257330792, 'recall': 0.6503454231433506, 'f1-score': 0.6277119474637226, 'support': 358980}}
[[ 30339  43212   7054]
 [ 14287 170997  12648]
 [  6894  41424  32125]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8204956
{'0': {'precision': 0.595963548946162, 'recall': 0.3664489515297353, 'f1-score': 0.45383911275730676, 'support': 29090}, '1': {'precision': 0.6454015200612738, 'recall': 0.8498107118475765, 'f1-score': 0.7336338126268276, 'support': 64452}, '2': {'precision': 0.6187136846323382, 'recall': 0.42339069034071436, 'f1-score': 0.5027473645651024, 'support': 29174}, 'accuracy': 0.6338537761987026, 'macro avg': {'precision': 0.620026251213258, 'recall': 0.5465501179060087, 'f1-score': 0.5634067633164123, 'support': 122716}, 'weighted avg': {'precision': 0.6273375227785856, 'recall': 0.6338537761987026, 'f1-score': 0.6124180864382529, 'support': 122716}}
[[10660 15751  2679]
 [ 4747 54772  4933]
 [ 2480 14342 12352]]
training model: results/EXC/W2/deepOF_L2/h100
Epoch 1/50
1403/1403 - 65s - loss: 3.0687 - accuracy100: 0.4685 - val_loss: 3.3621 - val_accuracy100: 0.4583 - 65s/epoch - 46ms/step
Epoch 2/50
1403/1403 - 55s - loss: 2.9039 - accuracy100: 0.5144 - val_loss: 3.3710 - val_accuracy100: 0.4689 - 55s/epoch - 39ms/step
Epoch 3/50
1403/1403 - 55s - loss: 2.8403 - accuracy100: 0.5290 - val_loss: 3.3823 - val_accuracy100: 0.4716 - 55s/epoch - 39ms/step
Epoch 4/50
1403/1403 - 58s - loss: 2.8123 - accuracy100: 0.5343 - val_loss: 3.3634 - val_accuracy100: 0.4764 - 58s/epoch - 41ms/step
Epoch 5/50
1403/1403 - 58s - loss: 2.7959 - accuracy100: 0.5369 - val_loss: 3.3727 - val_accuracy100: 0.4774 - 58s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 58s - loss: 2.7857 - accuracy100: 0.5396 - val_loss: 3.3541 - val_accuracy100: 0.4794 - 58s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 61s - loss: 2.7763 - accuracy100: 0.5416 - val_loss: 3.3765 - val_accuracy100: 0.4779 - 61s/epoch - 43ms/step
Epoch 8/50
1403/1403 - 56s - loss: 2.7683 - accuracy100: 0.5433 - val_loss: 3.3555 - val_accuracy100: 0.4807 - 56s/epoch - 40ms/step
Epoch 9/50
1403/1403 - 60s - loss: 2.7612 - accuracy100: 0.5449 - val_loss: 3.3747 - val_accuracy100: 0.4801 - 60s/epoch - 43ms/step
Epoch 10/50
1403/1403 - 60s - loss: 2.7556 - accuracy100: 0.5458 - val_loss: 3.4009 - val_accuracy100: 0.4819 - 60s/epoch - 43ms/step
Epoch 11/50
1403/1403 - 57s - loss: 2.7479 - accuracy100: 0.5473 - val_loss: 3.4061 - val_accuracy100: 0.4826 - 57s/epoch - 41ms/step
Epoch 12/50
1403/1403 - 61s - loss: 2.7434 - accuracy100: 0.5488 - val_loss: 3.4040 - val_accuracy100: 0.4835 - 61s/epoch - 43ms/step
Epoch 13/50
1403/1403 - 57s - loss: 2.7361 - accuracy100: 0.5504 - val_loss: 3.4249 - val_accuracy100: 0.4813 - 57s/epoch - 41ms/step
Epoch 14/50
1403/1403 - 56s - loss: 2.7290 - accuracy100: 0.5520 - val_loss: 3.4363 - val_accuracy100: 0.4828 - 56s/epoch - 40ms/step
Epoch 15/50
1403/1403 - 59s - loss: 2.7224 - accuracy100: 0.5532 - val_loss: 3.4597 - val_accuracy100: 0.4830 - 59s/epoch - 42ms/step
Epoch 16/50
1403/1403 - 58s - loss: 2.7153 - accuracy100: 0.5555 - val_loss: 3.4433 - val_accuracy100: 0.4828 - 58s/epoch - 41ms/step
testing model: results/EXC/W2/deepOF_L2/h100
Evaluating performance on  test set...
4918/4918 - 81s - 81s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0861651
{'0': {'precision': 0.6031027390388282, 'recall': 0.23494953048202544, 'f1-score': 0.33816197514890267, 'support': 409356}, '1': {'precision': 0.4079202952773374, 'recall': 0.8682138909745508, 'f1-score': 0.5550545868697839, 'support': 428854}, '2': {'precision': 0.6390593430621727, 'recall': 0.2834930959716992, 'f1-score': 0.3927558022914378, 'support': 420624}, 'accuracy': 0.466907471517293, 'macro avg': {'precision': 0.5500274591261128, 'recall': 0.46221883914275846, 'f1-score': 0.42865745477004147, 'support': 1258834}, 'weighted avg': {'precision': 0.5486233071787299, 'recall': 0.466907471517293, 'f1-score': 0.4302938511984442, 'support': 1258834}}
[[ 96178 278921  34257]
 [ 23425 372337  33092]
 [ 39869 261511 119244]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0276462
{'0': {'precision': 0.6183108396398015, 'recall': 0.24906377204884667, 'f1-score': 0.3550918552240442, 'support': 110550}, '1': {'precision': 0.45500980117614115, 'recall': 0.8817170847472343, 'f1-score': 0.60025712005832, 'support': 138211}, '2': {'precision': 0.6526038091969801, 'recall': 0.2760594815775864, 'f1-score': 0.3879930886300313, 'support': 110219}, 'accuracy': 0.5009304139506379, 'macro avg': {'precision': 0.5753081500043076, 'recall': 0.46894677945788904, 'f1-score': 0.44778068797079845, 'support': 358980}, 'weighted avg': {'precision': 0.5659673580656795, 'recall': 0.5009304139506379, 'f1-score': 0.4595848004098054, 'support': 358980}}
[[ 27534  75620   7396]
 [  7547 121863   8801]
 [  9450  70342  30427]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0700597
{'0': {'precision': 0.607434332350319, 'recall': 0.22681758815846756, 'f1-score': 0.33030020510908076, 'support': 39049}, '1': {'precision': 0.42415752198614676, 'recall': 0.8683479765102199, 'f1-score': 0.5699261262203366, 'support': 43934}, '2': {'precision': 0.6458883025505717, 'recall': 0.29572395741575014, 'f1-score': 0.40569702201122143, 'support': 39733}, 'accuracy': 0.47880471984093353, 'macro avg': {'precision': 0.5591600522956791, 'recall': 0.46362984069481256, 'f1-score': 0.43530778444687956, 'support': 122716}, 'weighted avg': {'precision': 0.5542693678096486, 'recall': 0.47880471984093353, 'f1-score': 0.44050153944262055, 'support': 122716}}
[[ 8857 27238  2954]
 [ 2296 38150  3488]
 [ 3428 24555 11750]]
training model: results/EXC/W2/deepOF_L2/h200
Epoch 1/50
1403/1403 - 67s - loss: 3.2301 - accuracy200: 0.4026 - val_loss: 3.2686 - val_accuracy200: 0.3908 - 67s/epoch - 48ms/step
Epoch 2/50
1403/1403 - 57s - loss: 3.1677 - accuracy200: 0.4289 - val_loss: 3.2517 - val_accuracy200: 0.4020 - 57s/epoch - 40ms/step
Epoch 3/50
1403/1403 - 60s - loss: 3.1401 - accuracy200: 0.4373 - val_loss: 3.2433 - val_accuracy200: 0.4072 - 60s/epoch - 43ms/step
Epoch 4/50
1403/1403 - 61s - loss: 3.1215 - accuracy200: 0.4421 - val_loss: 3.2377 - val_accuracy200: 0.4108 - 61s/epoch - 43ms/step
Epoch 5/50
1403/1403 - 59s - loss: 3.1098 - accuracy200: 0.4451 - val_loss: 3.2419 - val_accuracy200: 0.4140 - 59s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 59s - loss: 3.1021 - accuracy200: 0.4474 - val_loss: 3.2301 - val_accuracy200: 0.4136 - 59s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 56s - loss: 3.0943 - accuracy200: 0.4494 - val_loss: 3.2304 - val_accuracy200: 0.4167 - 56s/epoch - 40ms/step
Epoch 8/50
1403/1403 - 58s - loss: 3.0907 - accuracy200: 0.4512 - val_loss: 3.2266 - val_accuracy200: 0.4165 - 58s/epoch - 41ms/step
Epoch 9/50
1403/1403 - 59s - loss: 3.0851 - accuracy200: 0.4536 - val_loss: 3.2373 - val_accuracy200: 0.4145 - 59s/epoch - 42ms/step
Epoch 10/50
1403/1403 - 57s - loss: 3.0812 - accuracy200: 0.4543 - val_loss: 3.2369 - val_accuracy200: 0.4169 - 57s/epoch - 40ms/step
Epoch 11/50
1403/1403 - 58s - loss: 3.0768 - accuracy200: 0.4558 - val_loss: 3.2337 - val_accuracy200: 0.4177 - 58s/epoch - 42ms/step
Epoch 12/50
1403/1403 - 59s - loss: 3.0715 - accuracy200: 0.4578 - val_loss: 3.2459 - val_accuracy200: 0.4170 - 59s/epoch - 42ms/step
Epoch 13/50
1403/1403 - 61s - loss: 3.0672 - accuracy200: 0.4592 - val_loss: 3.2812 - val_accuracy200: 0.4134 - 61s/epoch - 44ms/step
Epoch 14/50
1403/1403 - 60s - loss: 3.0662 - accuracy200: 0.4596 - val_loss: 3.2592 - val_accuracy200: 0.4157 - 60s/epoch - 43ms/step
Epoch 15/50
1403/1403 - 57s - loss: 3.0580 - accuracy200: 0.4626 - val_loss: 3.2707 - val_accuracy200: 0.4160 - 57s/epoch - 40ms/step
Epoch 16/50
1403/1403 - 61s - loss: 3.0691 - accuracy200: 0.4587 - val_loss: 3.2745 - val_accuracy200: 0.4137 - 61s/epoch - 43ms/step
Epoch 17/50
1403/1403 - 59s - loss: 3.0565 - accuracy200: 0.4620 - val_loss: 3.3326 - val_accuracy200: 0.4145 - 59s/epoch - 42ms/step
Epoch 18/50
1403/1403 - 58s - loss: 3.0471 - accuracy200: 0.4651 - val_loss: 3.3117 - val_accuracy200: 0.4175 - 58s/epoch - 41ms/step
testing model: results/EXC/W2/deepOF_L2/h200
Evaluating performance on  test set...
4918/4918 - 88s - 88s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0838925
{'0': {'precision': 0.47618945122119966, 'recall': 0.3590118671454635, 'f1-score': 0.40938073309612305, 'support': 431359}, '1': {'precision': 0.3427493575841519, 'recall': 0.633882459087798, 'f1-score': 0.444922645212538, 'support': 385704}, '2': {'precision': 0.5197641376680678, 'recall': 0.2591908477469096, 'f1-score': 0.34589446115133016, 'support': 441771}, 'accuracy': 0.4082007635637423, 'macro avg': {'precision': 0.44623431549113973, 'recall': 0.417361724660057, 'f1-score': 0.40006594648666377, 'support': 1258834}, 'weighted avg': {'precision': 0.45059565166552795, 'recall': 0.4082007635637423, 'f1-score': 0.39799103741553815, 'support': 1258834}}
[[154863 223396  53100]
 [ 88518 244491  52695]
 [ 81832 245436 114503]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0636959
{'0': {'precision': 0.48947236495801477, 'recall': 0.38588719637710994, 'f1-score': 0.43155093509148335, 'support': 121450}, '1': {'precision': 0.36210615719449285, 'recall': 0.6464218334065593, 'f1-score': 0.46418806062480666, 'support': 116079}, '2': {'precision': 0.5381264394493939, 'recall': 0.24817416077265728, 'f1-score': 0.3396896236940866, 'support': 121451}, 'accuracy': 0.42354170148754805, 'macro avg': {'precision': 0.46323498720063383, 'recall': 0.4268277301854422, 'f1-score': 0.41180953980345886, 'support': 358980}, 'weighted avg': {'precision': 0.46474826882472214, 'recall': 0.42354170148754805, 'f1-score': 0.4110256600462368, 'support': 358980}}
[[46866 62233 12351]
 [27524 75036 13519]
 [21358 69952 30141]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.078643
{'0': {'precision': 0.48611469904417465, 'recall': 0.3602814474439977, 'f1-score': 0.4138442929404002, 'support': 41784}, '1': {'precision': 0.35161372732691815, 'recall': 0.6430128737541528, 'f1-score': 0.4546271998238306, 'support': 38528}, '2': {'precision': 0.5316580554250822, 'recall': 0.26693236487123856, 'f1-score': 0.35541809275598957, 'support': 42404}, 'accuracy': 0.4167916164151374, 'macro avg': {'precision': 0.45646216059872496, 'recall': 0.42340889535646303, 'f1-score': 0.4079631951734068, 'support': 122716}, 'weighted avg': {'precision': 0.4596239973072662, 'recall': 0.4167916164151374, 'f1-score': 0.4064595936655303, 'support': 122716}}
[[15054 22047  4683]
 [ 8466 24774  5288]
 [ 7448 23637 11319]]
training model: results/EXC/W2/deepOF_L2/h300
Epoch 1/50
1403/1403 - 67s - loss: 3.2732 - accuracy300: 0.3820 - val_loss: 3.2772 - val_accuracy300: 0.3778 - 67s/epoch - 48ms/step
Epoch 2/50
1403/1403 - 61s - loss: 3.2380 - accuracy300: 0.4025 - val_loss: 3.2713 - val_accuracy300: 0.3934 - 61s/epoch - 43ms/step
Epoch 3/50
1403/1403 - 56s - loss: 3.2242 - accuracy300: 0.4089 - val_loss: 3.2642 - val_accuracy300: 0.4002 - 56s/epoch - 40ms/step
Epoch 4/50
1403/1403 - 57s - loss: 3.2129 - accuracy300: 0.4133 - val_loss: 3.2635 - val_accuracy300: 0.4035 - 57s/epoch - 41ms/step
Epoch 5/50
1403/1403 - 58s - loss: 3.2051 - accuracy300: 0.4165 - val_loss: 3.2693 - val_accuracy300: 0.4018 - 58s/epoch - 41ms/step
Epoch 6/50
1403/1403 - 62s - loss: 3.1986 - accuracy300: 0.4201 - val_loss: 3.2702 - val_accuracy300: 0.3989 - 62s/epoch - 44ms/step
Epoch 7/50
1403/1403 - 58s - loss: 3.1928 - accuracy300: 0.4218 - val_loss: 3.2686 - val_accuracy300: 0.3995 - 58s/epoch - 41ms/step
Epoch 8/50
1403/1403 - 58s - loss: 3.1887 - accuracy300: 0.4239 - val_loss: 3.2722 - val_accuracy300: 0.3955 - 58s/epoch - 42ms/step
Epoch 9/50
1403/1403 - 55s - loss: 3.1835 - accuracy300: 0.4262 - val_loss: 3.2733 - val_accuracy300: 0.3981 - 55s/epoch - 39ms/step
Epoch 10/50
1403/1403 - 55s - loss: 3.1804 - accuracy300: 0.4282 - val_loss: 3.2809 - val_accuracy300: 0.3951 - 55s/epoch - 39ms/step
Epoch 11/50
1403/1403 - 62s - loss: 3.1762 - accuracy300: 0.4295 - val_loss: 3.2763 - val_accuracy300: 0.3958 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 59s - loss: 3.1719 - accuracy300: 0.4314 - val_loss: 3.2810 - val_accuracy300: 0.3950 - 59s/epoch - 42ms/step
Epoch 13/50
1403/1403 - 58s - loss: 3.1671 - accuracy300: 0.4327 - val_loss: 3.2774 - val_accuracy300: 0.3963 - 58s/epoch - 41ms/step
Epoch 14/50
1403/1403 - 55s - loss: 3.1629 - accuracy300: 0.4351 - val_loss: 3.2864 - val_accuracy300: 0.3959 - 55s/epoch - 40ms/step
testing model: results/EXC/W2/deepOF_L2/h300
Evaluating performance on  test set...
4918/4918 - 77s - 77s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0886582
{'0': {'precision': 0.41443383904350445, 'recall': 0.491524050343304, 'f1-score': 0.44969904573349223, 'support': 419599}, '1': {'precision': 0.32763107996488255, 'recall': 0.3091962701128575, 'f1-score': 0.3181468505893243, 'support': 407948}, '2': {'precision': 0.43229750923735344, 'recall': 0.37707141648136855, 'f1-score': 0.402800327439667, 'support': 431287}, 'accuracy': 0.3932250002780351, 'macro avg': {'precision': 0.3914541427485802, 'recall': 0.39259724564584336, 'f1-score': 0.3902154079208278, 'support': 1258834}, 'weighted avg': {'precision': 0.3924240718830122, 'recall': 0.3932250002780351, 'f1-score': 0.3909992787892708, 'support': 1258834}}
[[206243 122983  90373]
 [158621 126136 123191]
 [132786 135875 162626]]
Evaluating performance on  train set...
1403/1403 - 25s - 25s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0827883
{'0': {'precision': 0.4189025538900401, 'recall': 0.5154774027436273, 'f1-score': 0.46219912777210725, 'support': 120789}, '1': {'precision': 0.3339197528107949, 'recall': 0.31763506625891946, 'f1-score': 0.32557390323858615, 'support': 117720}, '2': {'precision': 0.44008539622833326, 'recall': 0.35933129134812525, 'f1-score': 0.3956296039042935, 'support': 120471}, 'accuracy': 0.3981976711794529, 'macro avg': {'precision': 0.39763590097638946, 'recall': 0.39748125345022406, 'f1-score': 0.3944675449716623, 'support': 358980}, 'weighted avg': {'precision': 0.39814302092521686, 'recall': 0.3981976711794529, 'f1-score': 0.3950555026621694, 'support': 358980}}
[[62264 35529 22996]
 [48248 37392 32080]
 [38124 39058 43289]]
Evaluating performance on  val set...
480/480 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0889207
{'0': {'precision': 0.43407544836116263, 'recall': 0.48732902867458167, 'f1-score': 0.45916331403525984, 'support': 43209}, '1': {'precision': 0.3077780727369259, 'recall': 0.3223241590214067, 'f1-score': 0.31488321564367183, 'support': 35970}, '2': {'precision': 0.458616159404423, 'recall': 0.38486804327353746, 'f1-score': 0.41851810223171354, 'support': 43537}, 'accuracy': 0.40261253626259, 'macro avg': {'precision': 0.4001565601675039, 'recall': 0.39817374365650865, 'f1-score': 0.39752154397021505, 'support': 122716}, 'weighted avg': {'precision': 0.4057622075081902, 'recall': 0.40261253626259, 'f1-score': 0.4024524880187957, 'support': 122716}}
[[21057 12713  9439]
 [14035 11594 10341]
 [13418 13363 16756]]
training model: results/EXC/W2/deepOF_L2/h500
Epoch 1/50
1403/1403 - 59s - loss: 3.2805 - accuracy500: 0.3761 - val_loss: 3.3048 - val_accuracy500: 0.3411 - 59s/epoch - 42ms/step
Epoch 2/50
1403/1403 - 58s - loss: 3.2534 - accuracy500: 0.3935 - val_loss: 3.3001 - val_accuracy500: 0.3589 - 58s/epoch - 42ms/step
Epoch 3/50
1403/1403 - 56s - loss: 3.2417 - accuracy500: 0.4010 - val_loss: 3.2928 - val_accuracy500: 0.3692 - 56s/epoch - 40ms/step
Epoch 4/50
1403/1403 - 59s - loss: 3.2331 - accuracy500: 0.4053 - val_loss: 3.2956 - val_accuracy500: 0.3703 - 59s/epoch - 42ms/step
Epoch 5/50
1403/1403 - 58s - loss: 3.2257 - accuracy500: 0.4097 - val_loss: 3.2958 - val_accuracy500: 0.3774 - 58s/epoch - 41ms/step
Epoch 6/50
1403/1403 - 57s - loss: 3.2197 - accuracy500: 0.4138 - val_loss: 3.2947 - val_accuracy500: 0.3794 - 57s/epoch - 40ms/step
Epoch 7/50
1403/1403 - 56s - loss: 3.2150 - accuracy500: 0.4156 - val_loss: 3.2974 - val_accuracy500: 0.3852 - 56s/epoch - 40ms/step
Epoch 8/50
1403/1403 - 54s - loss: 3.2106 - accuracy500: 0.4185 - val_loss: 3.2982 - val_accuracy500: 0.3839 - 54s/epoch - 39ms/step
Epoch 9/50
1403/1403 - 57s - loss: 3.2065 - accuracy500: 0.4207 - val_loss: 3.3060 - val_accuracy500: 0.3859 - 57s/epoch - 40ms/step
Epoch 10/50
1403/1403 - 54s - loss: 3.2031 - accuracy500: 0.4224 - val_loss: 3.3098 - val_accuracy500: 0.3871 - 54s/epoch - 39ms/step
Epoch 11/50
1403/1403 - 53s - loss: 3.1997 - accuracy500: 0.4246 - val_loss: 3.3165 - val_accuracy500: 0.3860 - 53s/epoch - 38ms/step
Epoch 12/50
1403/1403 - 58s - loss: 3.1960 - accuracy500: 0.4268 - val_loss: 3.3278 - val_accuracy500: 0.3883 - 58s/epoch - 42ms/step
Epoch 13/50
1403/1403 - 57s - loss: 3.1926 - accuracy500: 0.4277 - val_loss: 3.3271 - val_accuracy500: 0.3909 - 57s/epoch - 41ms/step
testing model: results/EXC/W2/deepOF_L2/h500
Evaluating performance on  test set...
4918/4918 - 84s - 84s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1000005
{'0': {'precision': 0.4202868214861539, 'recall': 0.17436939780923388, 'f1-score': 0.24647908351663664, 'support': 426061}, '1': {'precision': 0.3257869861523857, 'recall': 0.5765692040596248, 'f1-score': 0.4163294834930581, 'support': 392253}, '2': {'precision': 0.4147497872998685, 'recall': 0.36517978752383545, 'f1-score': 0.3883895266722196, 'support': 440520}, 'accuracy': 0.3664676994742754, 'macro avg': {'precision': 0.38694119831280266, 'recall': 0.37203946313089803, 'f1-score': 0.3503993645606381, 'support': 1258834}, 'weighted avg': {'precision': 0.38890300264354316, 'recall': 0.3664676994742754, 'f1-score': 0.3490650617797346, 'support': 1258834}}
[[ 74292 238805 112964]
 [ 52055 226161 114037]
 [ 50418 229233 160869]]
Evaluating performance on  train set...
1403/1403 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0919039
{'0': {'precision': 0.42613000279876856, 'recall': 0.2000887056369147, 'f1-score': 0.27231316964659985, 'support': 121751}, '1': {'precision': 0.34514637904468415, 'recall': 0.5665303074024409, 'f1-score': 0.42895883403806856, 'support': 117826}, '2': {'precision': 0.4043169449312794, 'recall': 0.3670929541133807, 'f1-score': 0.38480683718664, 'support': 119403}, 'accuracy': 0.3759123070923171, 'macro avg': {'precision': 0.391864442258244, 'recall': 0.37790398905091216, 'f1-score': 0.36202628029043615, 'support': 358980}, 'weighted avg': {'precision': 0.39229379743635123, 'recall': 0.3759123070923171, 'f1-score': 0.3611454540019194, 'support': 358980}}
[[24361 66327 31063]
 [17559 66752 33515]
 [15248 60323 43832]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0996554
{'0': {'precision': 0.42781795443423415, 'recall': 0.18691499976243645, 'f1-score': 0.260163676944697, 'support': 42094}, '1': {'precision': 0.3264743380674237, 'recall': 0.578399957976572, 'f1-score': 0.4173679023576681, 'support': 38074}, '2': {'precision': 0.4162621030077839, 'recall': 0.3607220080849864, 'f1-score': 0.38650700713934955, 'support': 42548}, 'accuracy': 0.3686397861729522, 'macro avg': {'precision': 0.39018479850314725, 'recall': 0.37534565527466496, 'f1-score': 0.35467952881390485, 'support': 122716}, 'weighted avg': {'precision': 0.39236833730164716, 'recall': 0.3686397861729522, 'f1-score': 0.35274369659572485, 'support': 122716}}
[[ 7868 23396 10830]
 [ 5359 22022 10693]
 [ 5164 22036 15348]]
training model: results/EXC/W2/deepOF_L2/h1000
Epoch 1/50
1403/1403 - 71s - loss: 3.2621 - accuracy1000: 0.3992 - val_loss: 3.2812 - val_accuracy1000: 0.3730 - 71s/epoch - 51ms/step
Epoch 2/50
1403/1403 - 57s - loss: 3.2575 - accuracy1000: 0.3983 - val_loss: 3.2768 - val_accuracy1000: 0.3808 - 57s/epoch - 41ms/step
Epoch 3/50
1403/1403 - 62s - loss: 3.2637 - accuracy1000: 0.3918 - val_loss: 3.2769 - val_accuracy1000: 0.3824 - 62s/epoch - 44ms/step
Epoch 4/50
1403/1403 - 59s - loss: 3.2617 - accuracy1000: 0.3904 - val_loss: 3.2769 - val_accuracy1000: 0.3835 - 59s/epoch - 42ms/step
Epoch 5/50
1403/1403 - 59s - loss: 3.2573 - accuracy1000: 0.3935 - val_loss: 3.2777 - val_accuracy1000: 0.3846 - 59s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 62s - loss: 3.2530 - accuracy1000: 0.3958 - val_loss: 3.2772 - val_accuracy1000: 0.3847 - 62s/epoch - 44ms/step
Epoch 7/50
1403/1403 - 54s - loss: 3.2469 - accuracy1000: 0.3996 - val_loss: 3.2761 - val_accuracy1000: 0.3865 - 54s/epoch - 39ms/step
Epoch 8/50
1403/1403 - 66s - loss: 3.2417 - accuracy1000: 0.4018 - val_loss: 3.2769 - val_accuracy1000: 0.3854 - 66s/epoch - 47ms/step
Epoch 9/50
1403/1403 - 62s - loss: 3.2369 - accuracy1000: 0.4049 - val_loss: 3.2762 - val_accuracy1000: 0.3874 - 62s/epoch - 44ms/step
Epoch 10/50
1403/1403 - 60s - loss: 3.2330 - accuracy1000: 0.4065 - val_loss: 3.2775 - val_accuracy1000: 0.3867 - 60s/epoch - 43ms/step
Epoch 11/50
1403/1403 - 62s - loss: 3.2302 - accuracy1000: 0.4068 - val_loss: 3.2757 - val_accuracy1000: 0.3879 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 54s - loss: 3.2259 - accuracy1000: 0.4087 - val_loss: 3.2766 - val_accuracy1000: 0.3880 - 54s/epoch - 39ms/step
Epoch 13/50
1403/1403 - 56s - loss: 3.2229 - accuracy1000: 0.4102 - val_loss: 3.2767 - val_accuracy1000: 0.3865 - 56s/epoch - 40ms/step
Epoch 14/50
1403/1403 - 65s - loss: 3.2194 - accuracy1000: 0.4106 - val_loss: 3.2770 - val_accuracy1000: 0.3880 - 65s/epoch - 46ms/step
Epoch 15/50
1403/1403 - 56s - loss: 3.2160 - accuracy1000: 0.4130 - val_loss: 3.2772 - val_accuracy1000: 0.3878 - 56s/epoch - 40ms/step
Epoch 16/50
1403/1403 - 59s - loss: 3.2147 - accuracy1000: 0.4134 - val_loss: 3.2787 - val_accuracy1000: 0.3859 - 59s/epoch - 42ms/step
Epoch 17/50
1403/1403 - 59s - loss: 3.2107 - accuracy1000: 0.4156 - val_loss: 3.2808 - val_accuracy1000: 0.3867 - 59s/epoch - 42ms/step
Epoch 18/50
1403/1403 - 61s - loss: 3.2078 - accuracy1000: 0.4173 - val_loss: 3.2819 - val_accuracy1000: 0.3860 - 61s/epoch - 43ms/step
Epoch 19/50
1403/1403 - 68s - loss: 3.2044 - accuracy1000: 0.4194 - val_loss: 3.2876 - val_accuracy1000: 0.3832 - 68s/epoch - 48ms/step
Epoch 20/50
1403/1403 - 61s - loss: 3.2013 - accuracy1000: 0.4214 - val_loss: 3.2834 - val_accuracy1000: 0.3844 - 61s/epoch - 44ms/step
Epoch 21/50
1403/1403 - 65s - loss: 3.2002 - accuracy1000: 0.4231 - val_loss: 3.2887 - val_accuracy1000: 0.3845 - 65s/epoch - 46ms/step
testing model: results/EXC/W2/deepOF_L2/h1000
Evaluating performance on  test set...
4918/4918 - 82s - 82s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950005
{'0': {'precision': 0.358190844421292, 'recall': 0.5546731974050941, 'f1-score': 0.43528685949528195, 'support': 414042}, '1': {'precision': 0.3774870582008832, 'recall': 0.055439503318014435, 'f1-score': 0.0966801156399911, 'support': 411692}, '2': {'precision': 0.3803736472784049, 'recall': 0.48937427845763104, 'f1-score': 0.42804374387817956, 'support': 433100}, 'accuracy': 0.36893665090075417, 'macro avg': {'precision': 0.37201718330019334, 'recall': 0.36649565972691317, 'f1-score': 0.3200035730044842, 'support': 1258834}, 'weighted avg': {'precision': 0.37213348400741936, 'recall': 0.36893665090075417, 'f1-score': 0.322056138872039, 'support': 1258834}}
[[229658  18857 165527]
 [209133  22824 179735]
 [202370  18782 211948]]
Evaluating performance on  train set...
1403/1403 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0925035
{'0': {'precision': 0.3724456667048623, 'recall': 0.5676210592843303, 'f1-score': 0.4497723364017949, 'support': 120251}, '1': {'precision': 0.41276111408677024, 'recall': 0.05109059568402559, 'f1-score': 0.09092652134155335, 'support': 120668}, '2': {'precision': 0.36872811409592166, 'recall': 0.5021387248964518, 'f1-score': 0.4252146407591505, 'support': 118061}, 'accuracy': 0.37245807565881106, 'macro avg': {'precision': 0.3846449649625181, 'recall': 0.37361679328826924, 'f1-score': 0.3219711661674996, 'support': 358980}, 'weighted avg': {'precision': 0.3847747280066505, 'recall': 0.37245807565881106, 'f1-score': 0.3210729299809484, 'support': 358980}}
[[68257  4222 47772]
 [60781  6165 53722]
 [54229  4549 59283]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0913659
{'0': {'precision': 0.38489339204267475, 'recall': 0.5654008438818565, 'f1-score': 0.4580035118360142, 'support': 43134}, '1': {'precision': 0.35267777180727206, 'recall': 0.054440389294403896, 'f1-score': 0.0943210941055304, 'support': 36168}, '2': {'precision': 0.39404872605542124, 'recall': 0.4880453309992168, 'f1-score': 0.4360388541323675, 'support': 43414}, 'accuracy': 0.3874392907200365, 'macro avg': {'precision': 0.377206629968456, 'recall': 0.3692955213918257, 'f1-score': 0.329454486691304, 'support': 122716}, 'weighted avg': {'precision': 0.37863744431096363, 'recall': 0.3874392907200365, 'f1-score': 0.34304507663585887, 'support': 122716}}
[[24388  1799 16947]
 [18564  1969 15635]
 [20411  1815 21188]]
training model: results/EXC/W2/deepVOL_L2/h10
Epoch 1/50
1403/1403 - 69s - loss: 2.2660 - accuracy10: 0.6132 - val_loss: 2.5276 - val_accuracy10: 0.7649 - 69s/epoch - 49ms/step
Epoch 2/50
1403/1403 - 59s - loss: 2.0616 - accuracy10: 0.6512 - val_loss: 2.4855 - val_accuracy10: 0.7754 - 59s/epoch - 42ms/step
Epoch 3/50
1403/1403 - 63s - loss: 2.0092 - accuracy10: 0.6639 - val_loss: 2.4735 - val_accuracy10: 0.7788 - 63s/epoch - 45ms/step
Epoch 4/50
1403/1403 - 58s - loss: 1.9856 - accuracy10: 0.6705 - val_loss: 2.3714 - val_accuracy10: 0.7707 - 58s/epoch - 42ms/step
Epoch 5/50
1403/1403 - 63s - loss: 1.9625 - accuracy10: 0.6738 - val_loss: 2.3590 - val_accuracy10: 0.7621 - 63s/epoch - 45ms/step
Epoch 6/50
1403/1403 - 59s - loss: 1.9463 - accuracy10: 0.6766 - val_loss: 2.3698 - val_accuracy10: 0.7708 - 59s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 60s - loss: 1.9313 - accuracy10: 0.6775 - val_loss: 2.3964 - val_accuracy10: 0.7708 - 60s/epoch - 42ms/step
Epoch 8/50
1403/1403 - 57s - loss: 1.9214 - accuracy10: 0.6789 - val_loss: 2.3587 - val_accuracy10: 0.7697 - 57s/epoch - 40ms/step
Epoch 9/50
1403/1403 - 58s - loss: 1.9087 - accuracy10: 0.6792 - val_loss: 2.4222 - val_accuracy10: 0.7721 - 58s/epoch - 41ms/step
Epoch 10/50
1403/1403 - 57s - loss: 1.8992 - accuracy10: 0.6814 - val_loss: 2.4614 - val_accuracy10: 0.7721 - 57s/epoch - 41ms/step
Epoch 11/50
1403/1403 - 62s - loss: 1.8915 - accuracy10: 0.6814 - val_loss: 2.4090 - val_accuracy10: 0.7683 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 60s - loss: 1.8812 - accuracy10: 0.6810 - val_loss: 2.4285 - val_accuracy10: 0.7693 - 60s/epoch - 43ms/step
Epoch 13/50
1403/1403 - 60s - loss: 1.8717 - accuracy10: 0.6818 - val_loss: 2.3916 - val_accuracy10: 0.7683 - 60s/epoch - 43ms/step
Epoch 14/50
1403/1403 - 55s - loss: 1.8614 - accuracy10: 0.6830 - val_loss: 2.4025 - val_accuracy10: 0.7661 - 55s/epoch - 39ms/step
Epoch 15/50
1403/1403 - 59s - loss: 1.8524 - accuracy10: 0.6841 - val_loss: 2.4525 - val_accuracy10: 0.7742 - 59s/epoch - 42ms/step
Epoch 16/50
1403/1403 - 58s - loss: 1.8469 - accuracy10: 0.6849 - val_loss: 2.4342 - val_accuracy10: 0.7705 - 58s/epoch - 42ms/step
Epoch 17/50
1403/1403 - 60s - loss: 1.8392 - accuracy10: 0.6850 - val_loss: 2.4415 - val_accuracy10: 0.7664 - 60s/epoch - 43ms/step
Epoch 18/50
1403/1403 - 60s - loss: 1.8321 - accuracy10: 0.6862 - val_loss: 2.3835 - val_accuracy10: 0.7617 - 60s/epoch - 43ms/step
testing model: results/EXC/W2/deepVOL_L2/h10
Evaluating performance on  test set...
4918/4918 - 96s - 96s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55141574
{'0': {'precision': 0.45297211015994837, 'recall': 0.5695315990240214, 'f1-score': 0.5046083019465394, 'support': 145495}, '1': {'precision': 0.9054083146382007, 'recall': 0.7957813978255587, 'f1-score': 0.8470626044195757, 'support': 967145}, '2': {'precision': 0.4027370695380365, 'recall': 0.62218619826401, 'f1-score': 0.48896820682629993, 'support': 146199}, 'accuracy': 0.7494707424857349, 'macro avg': {'precision': 0.5870391647787285, 'recall': 0.66249973170453, 'f1-score': 0.6135463710641383, 'support': 1258839}, 'weighted avg': {'precision': 0.7947371017722485, 'recall': 0.7494707424857349, 'f1-score': 0.765893819871231, 'support': 1258839}}
[[ 82864  43695  18936]
 [ 81546 769636 115963]
 [ 18524  36712  90963]]
Evaluating performance on  train set...
1403/1403 - 32s - 32s/epoch - 23ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5194647
{'0': {'precision': 0.417260773130545, 'recall': 0.5847904524007771, 'f1-score': 0.4870212421699836, 'support': 36030}, '1': {'precision': 0.9179905321198225, 'recall': 0.8211511428760783, 'f1-score': 0.8668747180719343, 'support': 286689}, '2': {'precision': 0.4195780006918021, 'recall': 0.6021345246959543, 'f1-score': 0.49454693711140557, 'support': 36261}, 'accuracy': 0.7753050309209427, 'macro avg': {'precision': 0.5849431019807233, 'recall': 0.6693587066576031, 'f1-score': 0.6161476324511078, 'support': 358980}, 'weighted avg': {'precision': 0.8173881865337312, 'recall': 0.7753050309209427, 'f1-score': 0.7911404197763271, 'support': 358980}}
[[ 21070  11016   3944]
 [ 25014 235415  26260]
 [  4412  10015  21834]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5297727
{'0': {'precision': 0.4388316553500351, 'recall': 0.5603976678128271, 'f1-score': 0.4922198148512901, 'support': 13378}, '1': {'precision': 0.9110055056505361, 'recall': 0.8178157451147691, 'f1-score': 0.8618989916712816, 'support': 96106}, '2': {'precision': 0.42958983366050213, 'recall': 0.628428927680798, 'f1-score': 0.5103249363321163, 'support': 13233}, 'accuracy': 0.7693310625259744, 'macro avg': {'precision': 0.5931423315536911, 'recall': 0.6688807802027981, 'f1-score': 0.6214812476182293, 'support': 122717}, 'weighted avg': {'precision': 0.8076187266650311, 'recall': 0.7693310625259744, 'f1-score': 0.7836869468706346, 'support': 122717}}
[[ 7497  4273  1608]
 [ 8075 78597  9434]
 [ 1512  3405  8316]]
training model: results/EXC/W2/deepVOL_L2/h20
Epoch 1/50
1403/1403 - 63s - loss: 2.3905 - accuracy20: 0.5996 - val_loss: 2.6987 - val_accuracy20: 0.7438 - 63s/epoch - 45ms/step
Epoch 2/50
1403/1403 - 60s - loss: 2.1674 - accuracy20: 0.6442 - val_loss: 2.6924 - val_accuracy20: 0.7471 - 60s/epoch - 43ms/step
Epoch 3/50
1403/1403 - 60s - loss: 2.1079 - accuracy20: 0.6564 - val_loss: 2.6880 - val_accuracy20: 0.7524 - 60s/epoch - 43ms/step
Epoch 4/50
1403/1403 - 62s - loss: 2.0841 - accuracy20: 0.6612 - val_loss: 2.7237 - val_accuracy20: 0.7458 - 62s/epoch - 44ms/step
Epoch 5/50
1403/1403 - 63s - loss: 2.0666 - accuracy20: 0.6640 - val_loss: 2.6419 - val_accuracy20: 0.7450 - 63s/epoch - 45ms/step
Epoch 6/50
1403/1403 - 64s - loss: 2.0538 - accuracy20: 0.6652 - val_loss: 2.6483 - val_accuracy20: 0.7406 - 64s/epoch - 45ms/step
Epoch 7/50
1403/1403 - 67s - loss: 2.0390 - accuracy20: 0.6656 - val_loss: 2.7327 - val_accuracy20: 0.7468 - 67s/epoch - 48ms/step
Epoch 8/50
1403/1403 - 58s - loss: 2.0249 - accuracy20: 0.6662 - val_loss: 2.6767 - val_accuracy20: 0.7458 - 58s/epoch - 42ms/step
Epoch 9/50
1403/1403 - 61s - loss: 2.0117 - accuracy20: 0.6670 - val_loss: 2.6943 - val_accuracy20: 0.7400 - 61s/epoch - 43ms/step
Epoch 10/50
1403/1403 - 61s - loss: 2.0015 - accuracy20: 0.6686 - val_loss: 2.6556 - val_accuracy20: 0.7396 - 61s/epoch - 44ms/step
Epoch 11/50
1403/1403 - 61s - loss: 1.9918 - accuracy20: 0.6680 - val_loss: 2.6811 - val_accuracy20: 0.7438 - 61s/epoch - 43ms/step
Epoch 12/50
1403/1403 - 61s - loss: 1.9822 - accuracy20: 0.6694 - val_loss: 2.6213 - val_accuracy20: 0.7448 - 61s/epoch - 44ms/step
Epoch 13/50
1403/1403 - 62s - loss: 1.9751 - accuracy20: 0.6711 - val_loss: 2.5883 - val_accuracy20: 0.7428 - 62s/epoch - 44ms/step
Epoch 14/50
1403/1403 - 61s - loss: 1.9681 - accuracy20: 0.6719 - val_loss: 2.6319 - val_accuracy20: 0.7505 - 61s/epoch - 44ms/step
Epoch 15/50
1403/1403 - 67s - loss: 1.9622 - accuracy20: 0.6719 - val_loss: 2.6122 - val_accuracy20: 0.7466 - 67s/epoch - 48ms/step
Epoch 16/50
1403/1403 - 62s - loss: 1.9559 - accuracy20: 0.6725 - val_loss: 2.6394 - val_accuracy20: 0.7502 - 62s/epoch - 44ms/step
Epoch 17/50
1403/1403 - 61s - loss: 1.9495 - accuracy20: 0.6723 - val_loss: 2.6343 - val_accuracy20: 0.7502 - 61s/epoch - 44ms/step
Epoch 18/50
1403/1403 - 58s - loss: 1.9427 - accuracy20: 0.6741 - val_loss: 2.6317 - val_accuracy20: 0.7508 - 58s/epoch - 41ms/step
Epoch 19/50
1403/1403 - 60s - loss: 1.9400 - accuracy20: 0.6744 - val_loss: 2.6033 - val_accuracy20: 0.7439 - 60s/epoch - 42ms/step
Epoch 20/50
1403/1403 - 61s - loss: 1.9345 - accuracy20: 0.6737 - val_loss: 2.6290 - val_accuracy20: 0.7460 - 61s/epoch - 44ms/step
Epoch 21/50
1403/1403 - 62s - loss: 1.9302 - accuracy20: 0.6739 - val_loss: 2.6197 - val_accuracy20: 0.7445 - 62s/epoch - 44ms/step
Epoch 22/50
1403/1403 - 60s - loss: 1.9226 - accuracy20: 0.6749 - val_loss: 2.6246 - val_accuracy20: 0.7456 - 60s/epoch - 43ms/step
Epoch 23/50
1403/1403 - 64s - loss: 1.9189 - accuracy20: 0.6758 - val_loss: 2.6241 - val_accuracy20: 0.7451 - 64s/epoch - 45ms/step
testing model: results/EXC/W2/deepVOL_L2/h20
Evaluating performance on  test set...
4918/4918 - 103s - 103s/epoch - 21ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.60876757
{'0': {'precision': 0.5287805464546574, 'recall': 0.5209048916261992, 'f1-score': 0.5248131740278337, 'support': 202632}, '1': {'precision': 0.8310973626545811, 'recall': 0.8232628416553492, 'f1-score': 0.8271615512616568, 'support': 850455}, '2': {'precision': 0.5150078187345182, 'recall': 0.5426289902406781, 'f1-score': 0.5284577281623708, 'support': 205752}, 'accuracy': 0.7287246423093025, 'macro avg': {'precision': 0.6249619092812523, 'recall': 0.6289322411740755, 'f1-score': 0.6268108178172871, 'support': 1258839}, 'weighted avg': {'precision': 0.7307706990058829, 'recall': 0.7287246423093025, 'f1-score': 0.7296714310906355, 'support': 1258839}}
[[105552  71748  25332]
 [ 70499 700148  79808]
 [ 23563  70542 111647]]
Evaluating performance on  train set...
1403/1403 - 27s - 27s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.57292056
{'0': {'precision': 0.4947027715382302, 'recall': 0.548313108937288, 'f1-score': 0.5201301720130171, 'support': 51011}, '1': {'precision': 0.8566724803339733, 'recall': 0.8366053576230955, 'f1-score': 0.8465200107270748, 'support': 256569}, '2': {'precision': 0.5276781928221734, 'recall': 0.5326264591439689, 'f1-score': 0.5301407796130981, 'support': 51400}, 'accuracy': 0.752114323917767, 'macro avg': {'precision': 0.626351148231459, 'recall': 0.6391816419014508, 'f1-score': 0.63226365411773, 'support': 358980}, 'weighted avg': {'precision': 0.7581301013895024, 'recall': 0.752114323917767, 'f1-score': 0.7548397930494851, 'support': 358980}}
[[ 27970  17835   5206]
 [ 22623 214647  19299]
 [  5946  18077  27377]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.59343344
{'0': {'precision': 0.5117124826184619, 'recall': 0.5105111514246078, 'f1-score': 0.5111111111111112, 'support': 18742}, '1': {'precision': 0.8417133093737111, 'recall': 0.836205281887994, 'f1-score': 0.8389502551544727, 'support': 85424}, '2': {'precision': 0.5341965124778114, 'recall': 0.5515605627728963, 'f1-score': 0.5427396896963268, 'support': 18551}, 'accuracy': 0.7434340800378105, 'macro avg': {'precision': 0.6292074348233282, 'recall': 0.632758998695166, 'f1-score': 0.6309336853206369, 'support': 122717}, 'weighted avg': {'precision': 0.7448268177363445, 'recall': 0.7434340800378105, 'f1-score': 0.7441030584541398, 'support': 122717}}
[[ 9568  7067  2107]
 [ 7177 71432  6815]
 [ 1953  6366 10232]]
training model: results/EXC/W2/deepVOL_L2/h30
Epoch 1/50
1403/1403 - 67s - loss: 2.4983 - accuracy30: 0.5914 - val_loss: 2.8226 - val_accuracy30: 0.7056 - 67s/epoch - 48ms/step
Epoch 2/50
1403/1403 - 64s - loss: 2.3080 - accuracy30: 0.6266 - val_loss: 2.7394 - val_accuracy30: 0.7073 - 64s/epoch - 45ms/step
Epoch 3/50
1403/1403 - 62s - loss: 2.2517 - accuracy30: 0.6380 - val_loss: 2.7210 - val_accuracy30: 0.7041 - 62s/epoch - 44ms/step
Epoch 4/50
1403/1403 - 63s - loss: 2.2242 - accuracy30: 0.6418 - val_loss: 2.7300 - val_accuracy30: 0.7025 - 63s/epoch - 45ms/step
Epoch 5/50
1403/1403 - 60s - loss: 2.2064 - accuracy30: 0.6426 - val_loss: 2.7596 - val_accuracy30: 0.7057 - 60s/epoch - 43ms/step
Epoch 6/50
1403/1403 - 61s - loss: 2.1887 - accuracy30: 0.6450 - val_loss: 2.7626 - val_accuracy30: 0.7088 - 61s/epoch - 43ms/step
Epoch 7/50
1403/1403 - 58s - loss: 2.1738 - accuracy30: 0.6465 - val_loss: 2.7843 - val_accuracy30: 0.7100 - 58s/epoch - 41ms/step
Epoch 8/50
1403/1403 - 58s - loss: 2.1602 - accuracy30: 0.6461 - val_loss: 2.7802 - val_accuracy30: 0.7090 - 58s/epoch - 41ms/step
Epoch 9/50
1403/1403 - 62s - loss: 2.1475 - accuracy30: 0.6469 - val_loss: 2.7805 - val_accuracy30: 0.7078 - 62s/epoch - 44ms/step
Epoch 10/50
1403/1403 - 68s - loss: 2.1334 - accuracy30: 0.6480 - val_loss: 2.7700 - val_accuracy30: 0.7115 - 68s/epoch - 48ms/step
Epoch 11/50
1403/1403 - 62s - loss: 2.1241 - accuracy30: 0.6484 - val_loss: 2.7677 - val_accuracy30: 0.7099 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 64s - loss: 2.1153 - accuracy30: 0.6497 - val_loss: 2.7947 - val_accuracy30: 0.7130 - 64s/epoch - 45ms/step
Epoch 13/50
1403/1403 - 62s - loss: 2.1087 - accuracy30: 0.6495 - val_loss: 2.7339 - val_accuracy30: 0.7126 - 62s/epoch - 44ms/step
testing model: results/EXC/W2/deepVOL_L2/h30
Evaluating performance on  test set...
4918/4918 - 93s - 93s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71100193
{'0': {'precision': 0.59947456707287, 'recall': 0.3994969608048627, 'f1-score': 0.4794696564259519, 'support': 243321}, '1': {'precision': 0.7533540166872497, 'recall': 0.8154882312970418, 'f1-score': 0.7831907069026851, 'support': 766737}, '2': {'precision': 0.524689552776028, 'recall': 0.5625067830742702, 'f1-score': 0.5429404472999633, 'support': 248781}, 'accuracy': 0.6850852253544735, 'macro avg': {'precision': 0.6258393788453825, 'recall': 0.592497325058725, 'f1-score': 0.6018669368762001, 'support': 1258839}, 'weighted avg': {'precision': 0.6784203074870119, 'recall': 0.6850852253544735, 'f1-score': 0.6770044435621992, 'support': 1258839}}
[[ 97206 115035  31080]
 [ 45781 625265  95691]
 [ 19165  89675 139941]]
Evaluating performance on  train set...
1403/1403 - 29s - 29s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6699787
{'0': {'precision': 0.5776537073602506, 'recall': 0.40882806476484196, 'f1-score': 0.4787945483789046, 'support': 62256}, '1': {'precision': 0.7861551166306954, 'recall': 0.8415253875389674, 'f1-score': 0.8128984619446284, 'support': 234170}, '2': {'precision': 0.5337711653386454, 'recall': 0.5482942737474822, 'f1-score': 0.5409352574718084, 'support': 62554}, 'accuracy': 0.7153880439021673, 'macro avg': {'precision': 0.6325266631098637, 'recall': 0.5995492420170971, 'f1-score': 0.6108760892651138, 'support': 358980}, 'weighted avg': {'precision': 0.7060166982657065, 'recall': 0.7153880439021673, 'f1-score': 0.7075656870392284, 'support': 358980}}
[[ 25452  29802   7002]
 [ 14154 197060  22956]
 [  4455  23801  34298]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.69282895
{'0': {'precision': 0.5912979053007341, 'recall': 0.38706406243110975, 'f1-score': 0.4678639948838201, 'support': 22681}, '1': {'precision': 0.7661127065580716, 'recall': 0.8404281416637616, 'f1-score': 0.801551580826894, 'support': 77451}, '2': {'precision': 0.5473675019645508, 'recall': 0.5551472216072615, 'f1-score': 0.5512299136092854, 'support': 22585}, 'accuracy': 0.7041322718123814, 'macro avg': {'precision': 0.6349260379411188, 'recall': 0.594213141900711, 'f1-score': 0.6068818297733332, 'support': 122717}, 'weighted avg': {'precision': 0.6935446438360172, 'recall': 0.7041322718123814, 'f1-score': 0.6938087009415925, 'support': 122717}}
[[ 8779 11263  2639]
 [ 4630 65092  7729]
 [ 1438  8609 12538]]
training model: results/EXC/W2/deepVOL_L2/h50
Epoch 1/50
1403/1403 - 67s - loss: 2.7346 - accuracy50: 0.5492 - val_loss: 3.0660 - val_accuracy50: 0.6224 - 67s/epoch - 48ms/step
Epoch 2/50
1403/1403 - 63s - loss: 2.5396 - accuracy50: 0.5935 - val_loss: 3.0873 - val_accuracy50: 0.6328 - 63s/epoch - 45ms/step
Epoch 3/50
1403/1403 - 59s - loss: 2.4819 - accuracy50: 0.6002 - val_loss: 3.0744 - val_accuracy50: 0.6373 - 59s/epoch - 42ms/step
Epoch 4/50
1403/1403 - 64s - loss: 2.4570 - accuracy50: 0.6051 - val_loss: 3.0878 - val_accuracy50: 0.6384 - 64s/epoch - 46ms/step
Epoch 5/50
1403/1403 - 59s - loss: 2.4375 - accuracy50: 0.6068 - val_loss: 3.0240 - val_accuracy50: 0.6397 - 59s/epoch - 42ms/step
Epoch 6/50
1403/1403 - 61s - loss: 2.4219 - accuracy50: 0.6080 - val_loss: 3.0559 - val_accuracy50: 0.6394 - 61s/epoch - 44ms/step
Epoch 7/50
1403/1403 - 62s - loss: 2.4089 - accuracy50: 0.6084 - val_loss: 3.0431 - val_accuracy50: 0.6395 - 62s/epoch - 44ms/step
Epoch 8/50
1403/1403 - 62s - loss: 2.3991 - accuracy50: 0.6092 - val_loss: 3.0113 - val_accuracy50: 0.6408 - 62s/epoch - 44ms/step
Epoch 9/50
1403/1403 - 70s - loss: 2.3911 - accuracy50: 0.6105 - val_loss: 3.0716 - val_accuracy50: 0.6386 - 70s/epoch - 50ms/step
Epoch 10/50
1403/1403 - 60s - loss: 2.3787 - accuracy50: 0.6120 - val_loss: 3.0248 - val_accuracy50: 0.6404 - 60s/epoch - 43ms/step
Epoch 11/50
1403/1403 - 62s - loss: 2.3720 - accuracy50: 0.6123 - val_loss: 3.0454 - val_accuracy50: 0.6407 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 61s - loss: 2.3658 - accuracy50: 0.6135 - val_loss: 3.0197 - val_accuracy50: 0.6411 - 61s/epoch - 44ms/step
Epoch 13/50
1403/1403 - 62s - loss: 2.3573 - accuracy50: 0.6155 - val_loss: 3.0074 - val_accuracy50: 0.6403 - 62s/epoch - 44ms/step
Epoch 14/50
1403/1403 - 58s - loss: 2.3525 - accuracy50: 0.6153 - val_loss: 3.0113 - val_accuracy50: 0.6400 - 58s/epoch - 41ms/step
Epoch 15/50
1403/1403 - 60s - loss: 2.3463 - accuracy50: 0.6166 - val_loss: 3.0256 - val_accuracy50: 0.6408 - 60s/epoch - 43ms/step
Epoch 16/50
1403/1403 - 64s - loss: 2.3421 - accuracy50: 0.6169 - val_loss: 3.0287 - val_accuracy50: 0.6381 - 64s/epoch - 45ms/step
Epoch 17/50
1403/1403 - 63s - loss: 2.3372 - accuracy50: 0.6178 - val_loss: 2.9919 - val_accuracy50: 0.6399 - 63s/epoch - 45ms/step
Epoch 18/50
1403/1403 - 64s - loss: 2.3325 - accuracy50: 0.6188 - val_loss: 3.0389 - val_accuracy50: 0.6410 - 64s/epoch - 45ms/step
Epoch 19/50
1403/1403 - 63s - loss: 2.3272 - accuracy50: 0.6194 - val_loss: 3.0189 - val_accuracy50: 0.6393 - 63s/epoch - 45ms/step
Epoch 20/50
1403/1403 - 57s - loss: 2.3241 - accuracy50: 0.6203 - val_loss: 3.0275 - val_accuracy50: 0.6397 - 57s/epoch - 41ms/step
Epoch 21/50
1403/1403 - 62s - loss: 2.3194 - accuracy50: 0.6204 - val_loss: 3.0316 - val_accuracy50: 0.6396 - 62s/epoch - 44ms/step
Epoch 22/50
1403/1403 - 61s - loss: 2.3155 - accuracy50: 0.6215 - val_loss: 3.0334 - val_accuracy50: 0.6390 - 61s/epoch - 44ms/step
Epoch 23/50
1403/1403 - 61s - loss: 2.3126 - accuracy50: 0.6221 - val_loss: 3.0051 - val_accuracy50: 0.6382 - 61s/epoch - 43ms/step
Epoch 24/50
1403/1403 - 65s - loss: 2.3072 - accuracy50: 0.6222 - val_loss: 3.0363 - val_accuracy50: 0.6365 - 65s/epoch - 47ms/step
Epoch 25/50
1403/1403 - 58s - loss: 2.3019 - accuracy50: 0.6231 - val_loss: 3.0631 - val_accuracy50: 0.6368 - 58s/epoch - 41ms/step
Epoch 26/50
1403/1403 - 61s - loss: 2.2983 - accuracy50: 0.6243 - val_loss: 3.0256 - val_accuracy50: 0.6378 - 61s/epoch - 43ms/step
Epoch 27/50
1403/1403 - 64s - loss: 2.2949 - accuracy50: 0.6238 - val_loss: 3.0788 - val_accuracy50: 0.6356 - 64s/epoch - 45ms/step
testing model: results/EXC/W2/deepVOL_L2/h50
Evaluating performance on  test set...
4918/4918 - 92s - 92s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8396561
{'0': {'precision': 0.6296055638460141, 'recall': 0.3708110772743341, 'f1-score': 0.4667349737929233, 'support': 308343}, '1': {'precision': 0.6364410544568041, 'recall': 0.8166128484695367, 'f1-score': 0.7153567273949542, 'support': 633305}, '2': {'precision': 0.5912586104614036, 'recall': 0.4933179062457636, 'f1-score': 0.5378660800219991, 'support': 317191}, 'accuracy': 0.6259561389502549, 'macro avg': {'precision': 0.6191017429214072, 'recall': 0.5602472773298781, 'f1-score': 0.5733192604032921, 'support': 1258839}, 'weighted avg': {'precision': 0.6233820848230798, 'recall': 0.6259561389502549, 'f1-score': 0.6097362204820082, 'support': 1258839}}
[[114337 160795  33211]
 [ 41178 517165  74962]
 [ 26086 134629 156476]]
Evaluating performance on  train set...
1403/1403 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.77242893
{'0': {'precision': 0.6101737258820816, 'recall': 0.3940992478216617, 'f1-score': 0.4788917210901797, 'support': 80566}, '1': {'precision': 0.684194923105429, 'recall': 0.8390958991269044, 'f1-score': 0.7537695964581216, 'support': 198031}, '2': {'precision': 0.6027403673590411, 'recall': 0.48048716768470945, 'f1-score': 0.5347150115601333, 'support': 80383}, 'accuracy': 0.6589252883168979, 'macro avg': {'precision': 0.6323696721155172, 'recall': 0.5712274382110918, 'f1-score': 0.5891254430361449, 'support': 358980}, 'weighted avg': {'precision': 0.6493429722166383, 'recall': 0.6589252883168979, 'f1-score': 0.6430278403582035, 'support': 358980}}
[[ 31751  42033   6782]
 [ 13190 166167  18674]
 [  7095  34665  38623]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.819641
{'0': {'precision': 0.6106528810408922, 'recall': 0.36140809240606414, 'f1-score': 0.45407623366807043, 'support': 29089}, '1': {'precision': 0.6534533368913903, 'recall': 0.836093306225071, 'f1-score': 0.733576170212766, 'support': 64433}, '2': {'precision': 0.6128626566633418, 'recall': 0.48405548895358796, 'f1-score': 0.5408963907069316, 'support': 29195}, 'accuracy': 0.639821703594449, 'macro avg': {'precision': 0.6256562915318747, 'recall': 0.5605189625282411, 'f1-score': 0.576182931529256, 'support': 122717}, 'weighted avg': {'precision': 0.6336511304367588, 'recall': 0.639821703594449, 'f1-score': 0.6214836335893033, 'support': 122717}}
[[10513 15888  2688]
 [ 4322 53872  6239]
 [ 2381 12682 14132]]
training model: results/EXC/W2/deepVOL_L2/h100
Epoch 1/50
1403/1403 - 69s - loss: 3.0198 - accuracy100: 0.4878 - val_loss: 3.2759 - val_accuracy100: 0.4755 - 69s/epoch - 49ms/step
Epoch 2/50
1403/1403 - 59s - loss: 2.8985 - accuracy100: 0.5171 - val_loss: 3.3431 - val_accuracy100: 0.4808 - 59s/epoch - 42ms/step
Epoch 3/50
1403/1403 - 67s - loss: 2.8595 - accuracy100: 0.5246 - val_loss: 3.3413 - val_accuracy100: 0.4855 - 67s/epoch - 48ms/step
Epoch 4/50
1403/1403 - 66s - loss: 2.8381 - accuracy100: 0.5282 - val_loss: 3.3103 - val_accuracy100: 0.4933 - 66s/epoch - 47ms/step
Epoch 5/50
1403/1403 - 70s - loss: 2.8237 - accuracy100: 0.5314 - val_loss: 3.3584 - val_accuracy100: 0.4879 - 70s/epoch - 50ms/step
Epoch 6/50
1403/1403 - 59s - loss: 2.8125 - accuracy100: 0.5336 - val_loss: 3.3582 - val_accuracy100: 0.4892 - 59s/epoch - 42ms/step
Epoch 7/50
1403/1403 - 66s - loss: 2.8033 - accuracy100: 0.5364 - val_loss: 3.3509 - val_accuracy100: 0.4893 - 66s/epoch - 47ms/step
Epoch 8/50
1403/1403 - 65s - loss: 2.7945 - accuracy100: 0.5382 - val_loss: 3.3804 - val_accuracy100: 0.4914 - 65s/epoch - 46ms/step
Epoch 9/50
1403/1403 - 73s - loss: 2.7874 - accuracy100: 0.5398 - val_loss: 3.3771 - val_accuracy100: 0.4886 - 73s/epoch - 52ms/step
Epoch 10/50
1403/1403 - 70s - loss: 2.7806 - accuracy100: 0.5418 - val_loss: 3.3901 - val_accuracy100: 0.4880 - 70s/epoch - 50ms/step
Epoch 11/50
1403/1403 - 70s - loss: 2.7744 - accuracy100: 0.5428 - val_loss: 3.3874 - val_accuracy100: 0.4879 - 70s/epoch - 50ms/step
testing model: results/EXC/W2/deepVOL_L2/h100
Evaluating performance on  test set...
4918/4918 - 97s - 97s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0577407
{'0': {'precision': 0.6026903114732388, 'recall': 0.23345824437289608, 'f1-score': 0.33655029607678455, 'support': 409358}, '1': {'precision': 0.4102655378907244, 'recall': 0.8008459755534517, 'f1-score': 0.5425751489946563, 'support': 428854}, '2': {'precision': 0.5866671226994098, 'recall': 0.3670116278793325, 'f1-score': 0.4515433642503429, 'support': 420627}, 'accuracy': 0.47137799194337004, 'macro avg': {'precision': 0.5332076573544576, 'recall': 0.4671052826018935, 'f1-score': 0.4435562697739279, 'support': 1258839}, 'weighted avg': {'precision': 0.5317821813038327, 'recall': 0.47137799194337004, 'f1-score': 0.4451613031713219, 'support': 1258839}}
[[ 95568 260909  52881]
 [ 29525 343446  55883]
 [ 33476 232776 154375]]
Evaluating performance on  train set...
1403/1403 - 26s - 26s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0191408
{'0': {'precision': 0.6013001322168356, 'recall': 0.24674467392483815, 'f1-score': 0.34990510874025443, 'support': 110588}, '1': {'precision': 0.4561355043923692, 'recall': 0.8362418243908086, 'f1-score': 0.5902913613033375, 'support': 138216}, '2': {'precision': 0.5945586818589509, 'recall': 0.3248983444670346, 'f1-score': 0.4201852308342431, 'support': 110176}, 'accuracy': 0.49770182182851413, 'macro avg': {'precision': 0.5506647728227185, 'recall': 0.46929494759422713, 'f1-score': 0.45346056695927833, 'support': 358980}, 'weighted avg': {'precision': 0.5433391866655047, 'recall': 0.49770182182851413, 'f1-score': 0.4640295976145271, 'support': 358980}}
[[ 27287  72255  11046]
 [  9270 115582  13364]
 [  8823  65557  35796]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0519866
{'0': {'precision': 0.6020386493947759, 'recall': 0.21793163532004306, 'f1-score': 0.32001956615807203, 'support': 39026}, '1': {'precision': 0.425309994406116, 'recall': 0.8303754266211604, 'f1-score': 0.5625086699856656, 'support': 43950}, '2': {'precision': 0.5897199543499254, 'recall': 0.33806396416798773, 'f1-score': 0.4297618476400685, 'support': 39741}, 'accuracy': 0.4761768948067505, 'macro avg': {'precision': 0.5390228660502724, 'recall': 0.46212367536973037, 'f1-score': 0.43743002792793534, 'support': 122717}, 'weighted avg': {'precision': 0.5347555374662819, 'recall': 0.4761768948067505, 'f1-score': 0.4424041104477691, 'support': 122717}}
[[ 8505 25834  4687]
 [ 2795 36495  4660]
 [ 2827 23479 13435]]
training model: results/EXC/W2/deepVOL_L2/h200
Epoch 1/50
1403/1403 - 78s - loss: 3.2103 - accuracy200: 0.4155 - val_loss: 3.2619 - val_accuracy200: 0.3961 - 78s/epoch - 55ms/step
Epoch 2/50
1403/1403 - 63s - loss: 3.1537 - accuracy200: 0.4317 - val_loss: 3.2265 - val_accuracy200: 0.4080 - 63s/epoch - 45ms/step
Epoch 3/50
1403/1403 - 65s - loss: 3.1334 - accuracy200: 0.4372 - val_loss: 3.2148 - val_accuracy200: 0.4111 - 65s/epoch - 47ms/step
Epoch 4/50
1403/1403 - 63s - loss: 3.1176 - accuracy200: 0.4419 - val_loss: 3.2247 - val_accuracy200: 0.4115 - 63s/epoch - 45ms/step
Epoch 5/50
1403/1403 - 64s - loss: 3.1093 - accuracy200: 0.4458 - val_loss: 3.2467 - val_accuracy200: 0.4107 - 64s/epoch - 46ms/step
Epoch 6/50
1403/1403 - 69s - loss: 3.1015 - accuracy200: 0.4476 - val_loss: 3.2577 - val_accuracy200: 0.4122 - 69s/epoch - 49ms/step
Epoch 7/50
1403/1403 - 63s - loss: 3.0962 - accuracy200: 0.4500 - val_loss: 3.2444 - val_accuracy200: 0.4106 - 63s/epoch - 45ms/step
Epoch 8/50
1403/1403 - 66s - loss: 3.0930 - accuracy200: 0.4520 - val_loss: 3.2462 - val_accuracy200: 0.4121 - 66s/epoch - 47ms/step
Epoch 9/50
1403/1403 - 67s - loss: 3.0869 - accuracy200: 0.4532 - val_loss: 3.2672 - val_accuracy200: 0.4138 - 67s/epoch - 48ms/step
Epoch 10/50
1403/1403 - 62s - loss: 3.0840 - accuracy200: 0.4551 - val_loss: 3.2671 - val_accuracy200: 0.4094 - 62s/epoch - 44ms/step
Epoch 11/50
1403/1403 - 62s - loss: 3.0812 - accuracy200: 0.4548 - val_loss: 3.2784 - val_accuracy200: 0.4106 - 62s/epoch - 44ms/step
Epoch 12/50
1403/1403 - 62s - loss: 3.0764 - accuracy200: 0.4573 - val_loss: 3.2856 - val_accuracy200: 0.4098 - 62s/epoch - 44ms/step
Epoch 13/50
1403/1403 - 61s - loss: 3.0734 - accuracy200: 0.4580 - val_loss: 3.2826 - val_accuracy200: 0.4117 - 61s/epoch - 43ms/step
testing model: results/EXC/W2/deepVOL_L2/h200
Evaluating performance on  test set...
4918/4918 - 96s - 96s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0751426
{'0': {'precision': 0.48881750972246185, 'recall': 0.25612945103857565, 'f1-score': 0.3361328175508037, 'support': 431360}, '1': {'precision': 0.34729659204871355, 'recall': 0.5503791757949729, 'f1-score': 0.42586603968897196, 'support': 385705}, '2': {'precision': 0.46978549181747237, 'recall': 0.44829935668463966, 'f1-score': 0.4587910019540322, 'support': 441774}, 'accuracy': 0.41372645747391046, 'macro avg': {'precision': 0.4352998645295492, 'recall': 0.4182693278393961, 'f1-score': 0.40692995306460267, 'support': 1258839}, 'weighted avg': {'precision': 0.43877681648900474, 'recall': 0.41372645747391046, 'f1-score': 0.40667221869849146, 'support': 1258839}}
[[110484 206374 114502]
 [ 64401 212284 109020]
 [ 51138 192589 198047]]
Evaluating performance on  train set...
1403/1403 - 30s - 30s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0618939
{'0': {'precision': 0.49529775786120384, 'recall': 0.26745516350197945, 'f1-score': 0.3473469300495981, 'support': 121497}, '1': {'precision': 0.36615725643157065, 'recall': 0.5921955255265607, 'f1-score': 0.45251955851750386, 'support': 116036}, '2': {'precision': 0.47361051984295915, 'recall': 0.41222096881767356, 'f1-score': 0.44078854687610064, 'support': 121447}, 'accuracy': 0.42139952086467214, 'macro avg': {'precision': 0.4450218447119112, 'recall': 0.4239572192820713, 'f1-score': 0.41355167848106755, 'support': 358980}, 'weighted avg': {'precision': 0.44621759400948324, 'recall': 0.42139952086467214, 'f1-score': 0.41295508414071785, 'support': 358980}}
[[32495 61289 27713]
 [19391 68716 27929]
 [13721 57663 50063]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0737867
{'0': {'precision': 0.49203206490245316, 'recall': 0.24394857183901167, 'f1-score': 0.32617847138855544, 'support': 41767}, '1': {'precision': 0.3526088710929013, 'recall': 0.5896244777203955, 'f1-score': 0.4413064379849855, 'support': 38533}, '2': {'precision': 0.46522954091816365, 'recall': 0.4121224980550251, 'f1-score': 0.43706870687068705, 'support': 42417}, 'accuracy': 0.41061955556279894, 'macro avg': {'precision': 0.43662349230450603, 'recall': 0.41523184920481077, 'f1-score': 0.4015178720814094, 'support': 122717}, 'weighted avg': {'precision': 0.43898907504037155, 'recall': 0.41061955556279894, 'f1-score': 0.4006576149082456, 'support': 122717}}
[[10189 21287 10291]
 [ 6010 22720  9803]
 [ 4509 20427 17481]]
training model: results/EXC/W2/deepVOL_L2/h300
Epoch 1/50
1403/1403 - 73s - loss: 3.2600 - accuracy300: 0.3965 - val_loss: 3.2953 - val_accuracy300: 0.3737 - 73s/epoch - 52ms/step
Epoch 2/50
1403/1403 - 69s - loss: 3.2291 - accuracy300: 0.4092 - val_loss: 3.2705 - val_accuracy300: 0.3836 - 69s/epoch - 49ms/step
Epoch 3/50
1403/1403 - 67s - loss: 3.2086 - accuracy300: 0.4188 - val_loss: 3.2691 - val_accuracy300: 0.3887 - 67s/epoch - 48ms/step
Epoch 4/50
1403/1403 - 67s - loss: 3.1921 - accuracy300: 0.4229 - val_loss: 3.2671 - val_accuracy300: 0.3901 - 67s/epoch - 48ms/step
Epoch 5/50
1403/1403 - 63s - loss: 3.1820 - accuracy300: 0.4266 - val_loss: 3.2618 - val_accuracy300: 0.3976 - 63s/epoch - 45ms/step
Epoch 6/50
1403/1403 - 71s - loss: 3.1797 - accuracy300: 0.4287 - val_loss: 3.2711 - val_accuracy300: 0.3954 - 71s/epoch - 50ms/step
Epoch 7/50
1403/1403 - 79s - loss: 3.1707 - accuracy300: 0.4312 - val_loss: 3.2876 - val_accuracy300: 0.3878 - 79s/epoch - 56ms/step
Epoch 8/50
1403/1403 - 79s - loss: 3.1649 - accuracy300: 0.4340 - val_loss: 3.2930 - val_accuracy300: 0.3873 - 79s/epoch - 56ms/step
Epoch 9/50
1403/1403 - 81s - loss: 3.1611 - accuracy300: 0.4359 - val_loss: 3.2931 - val_accuracy300: 0.3888 - 81s/epoch - 58ms/step
Epoch 10/50
1403/1403 - 75s - loss: 3.1581 - accuracy300: 0.4369 - val_loss: 3.2834 - val_accuracy300: 0.3923 - 75s/epoch - 54ms/step
Epoch 11/50
1403/1403 - 79s - loss: 3.1557 - accuracy300: 0.4379 - val_loss: 3.2898 - val_accuracy300: 0.3874 - 79s/epoch - 56ms/step
Epoch 12/50
1403/1403 - 81s - loss: 3.1505 - accuracy300: 0.4387 - val_loss: 3.2906 - val_accuracy300: 0.3852 - 81s/epoch - 58ms/step
Epoch 13/50
1403/1403 - 75s - loss: 3.1470 - accuracy300: 0.4399 - val_loss: 3.2969 - val_accuracy300: 0.3846 - 75s/epoch - 53ms/step
Epoch 14/50
1403/1403 - 72s - loss: 3.1410 - accuracy300: 0.4426 - val_loss: 3.3014 - val_accuracy300: 0.3848 - 72s/epoch - 51ms/step
Epoch 15/50
1403/1403 - 73s - loss: 3.1361 - accuracy300: 0.4433 - val_loss: 3.3048 - val_accuracy300: 0.3853 - 73s/epoch - 52ms/step
testing model: results/EXC/W2/deepVOL_L2/h300
Evaluating performance on  test set...
4918/4918 - 103s - 103s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0897331
{'0': {'precision': 0.40480925654790956, 'recall': 0.4744256434699714, 'f1-score': 0.4368613939606742, 'support': 419600}, '1': {'precision': 0.33860356599337965, 'recall': 0.2803340613655138, 'f1-score': 0.306725940230255, 'support': 407949}, '2': {'precision': 0.4212161655405012, 'recall': 0.41930487606946604, 'f1-score': 0.4202583477318175, 'support': 431290}, 'accuracy': 0.39264195024145265, 'macro avg': {'precision': 0.38820966269393015, 'recall': 0.3913548603016504, 'f1-score': 0.3879485606409156, 'support': 1258839}, 'weighted avg': {'precision': 0.3889752940820064, 'recall': 0.39264195024145265, 'f1-score': 0.389000344198223, 'support': 1258839}}
[[199069 108199 112332]
 [157428 114362 136159]
 [135263 115185 180842]]
Evaluating performance on  train set...
1403/1403 - 28s - 28s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0832927
{'0': {'precision': 0.4101169525815481, 'recall': 0.49000016556017284, 'f1-score': 0.4465138382855462, 'support': 120802}, '1': {'precision': 0.3500341700751742, 'recall': 0.2915583422541673, 'f1-score': 0.31813146318965796, 'support': 117702}, '2': {'precision': 0.4237666046360058, 'recall': 0.41016468010226104, 'f1-score': 0.416854714553852, 'support': 120476}, 'accuracy': 0.39814195776923506, 'macro avg': {'precision': 0.39463924243090936, 'recall': 0.397241062638867, 'f1-score': 0.393833338676352, 'support': 358980}, 'weighted avg': {'precision': 0.3949979816482026, 'recall': 0.39814195776923506, 'f1-score': 0.39446616180151967, 'support': 358980}}
[[59193 30771 30838]
 [47029 34317 36356]
 [38110 32951 49415]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0884871
{'0': {'precision': 0.42215632733168357, 'recall': 0.458195373822038, 'f1-score': 0.4394381835341142, 'support': 43189}, '1': {'precision': 0.32012656486449304, 'recall': 0.32358094390522013, 'f1-score': 0.3218444856297198, 'support': 35957}, '2': {'precision': 0.43910775774762, 'recall': 0.39803998072112184, 'f1-score': 0.4175665426703746, 'support': 43571}, 'accuracy': 0.3973940040907128, 'macro avg': {'precision': 0.39379688331459883, 'recall': 0.39327209948279335, 'f1-score': 0.3929497372780695, 'support': 122717}, 'weighted avg': {'precision': 0.3982794936869563, 'recall': 0.3973940040907128, 'f1-score': 0.39721676466287137, 'support': 122717}}
[[19789 11906 11494]
 [13663 11635 10659]
 [13424 12804 17343]]
training model: results/EXC/W2/deepVOL_L2/h500
Epoch 1/50
1403/1403 - 67s - loss: 3.2741 - accuracy500: 0.3877 - val_loss: 3.3181 - val_accuracy500: 0.3521 - 67s/epoch - 48ms/step
Epoch 2/50
1403/1403 - 62s - loss: 3.2420 - accuracy500: 0.4021 - val_loss: 3.3438 - val_accuracy500: 0.3522 - 62s/epoch - 44ms/step
Epoch 3/50
1403/1403 - 61s - loss: 3.2264 - accuracy500: 0.4117 - val_loss: 3.3627 - val_accuracy500: 0.3633 - 61s/epoch - 44ms/step
Epoch 4/50
1403/1403 - 61s - loss: 3.2171 - accuracy500: 0.4159 - val_loss: 3.3649 - val_accuracy500: 0.3555 - 61s/epoch - 44ms/step
Epoch 5/50
1403/1403 - 62s - loss: 3.2035 - accuracy500: 0.4229 - val_loss: 3.3845 - val_accuracy500: 0.3500 - 62s/epoch - 44ms/step
Epoch 6/50
1403/1403 - 68s - loss: 3.1950 - accuracy500: 0.4257 - val_loss: 3.3874 - val_accuracy500: 0.3487 - 68s/epoch - 48ms/step
Epoch 7/50
1403/1403 - 71s - loss: 3.1881 - accuracy500: 0.4289 - val_loss: 3.4043 - val_accuracy500: 0.3463 - 71s/epoch - 51ms/step
Epoch 8/50
1403/1403 - 62s - loss: 3.1832 - accuracy500: 0.4314 - val_loss: 3.3995 - val_accuracy500: 0.3525 - 62s/epoch - 44ms/step
Epoch 9/50
1403/1403 - 63s - loss: 3.1765 - accuracy500: 0.4335 - val_loss: 3.4028 - val_accuracy500: 0.3549 - 63s/epoch - 45ms/step
Epoch 10/50
1403/1403 - 67s - loss: 3.1705 - accuracy500: 0.4359 - val_loss: 3.4290 - val_accuracy500: 0.3538 - 67s/epoch - 48ms/step
Epoch 11/50
1403/1403 - 60s - loss: 3.1658 - accuracy500: 0.4376 - val_loss: 3.4388 - val_accuracy500: 0.3542 - 60s/epoch - 43ms/step
testing model: results/EXC/W2/deepVOL_L2/h500
Evaluating performance on  test set...
4918/4918 - 97s - 97s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1049337
{'0': {'precision': 0.413991829108636, 'recall': 0.14769681407870217, 'f1-score': 0.21771946061429076, 'support': 426062}, '1': {'precision': 0.3282342779124523, 'recall': 0.6306643926241482, 'f1-score': 0.4317571353024028, 'support': 392253}, '2': {'precision': 0.39898688156028167, 'recall': 0.31986679499868337, 'f1-score': 0.35507269201742236, 'support': 440524}, 'accuracy': 0.35843900610006524, 'macro avg': {'precision': 0.38040432952712333, 'recall': 0.36607600056717793, 'f1-score': 0.3348497626447053, 'support': 1258839}, 'weighted avg': {'precision': 0.3820189586755243, 'recall': 0.35843900610006524, 'f1-score': 0.33247942191201757, 'support': 1258839}}
[[ 62928 249647 113487]
 [ 46102 247380  98771]
 [ 42973 256642 140909]]
Evaluating performance on  train set...
1403/1403 - 30s - 30s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007671
{'0': {'precision': 0.41986439524654307, 'recall': 0.1418857325876469, 'f1-score': 0.21209703159910628, 'support': 121767}, '1': {'precision': 0.3427700833492964, 'recall': 0.6530639959259888, 'f1-score': 0.449574492326839, 'support': 117820}, '2': {'precision': 0.3919167898536753, 'recall': 0.3064417511914434, 'f1-score': 0.34394844580652134, 'support': 119393}, 'accuracy': 0.36438798818875706, 'macro avg': {'precision': 0.3848504228165049, 'recall': 0.3671304932350264, 'f1-score': 0.3352066565774889, 'support': 358980}, 'weighted avg': {'precision': 0.38526636672572223, 'recall': 0.36438798818875706, 'f1-score': 0.33389136643505085, 'support': 358980}}
[[17277 75627 28863]
 [12972 76944 27904]
 [10900 71906 36587]]
Evaluating performance on  val set...
480/480 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1071398
{'0': {'precision': 0.4259910860896083, 'recall': 0.12947075738491884, 'f1-score': 0.19858569658088504, 'support': 42079}, '1': {'precision': 0.3230177382718643, 'recall': 0.6460778907009113, 'f1-score': 0.43069974265156424, 'support': 38079}, '2': {'precision': 0.39425440544942986, 'recall': 0.31278930425996854, 'f1-score': 0.3488286777422567, 'support': 42559}, 'accuracy': 0.35334957666826927, 'macro avg': {'precision': 0.3810877432703008, 'recall': 0.3627793174485996, 'f1-score': 0.32603803899156863, 'support': 122717}, 'weighted avg': {'precision': 0.3830320543098448, 'recall': 0.35334957666826927, 'f1-score': 0.32271570135261357, 'support': 122717}}
[[ 5448 25672 10959]
 [ 3983 24602  9494]
 [ 3358 25889 13312]]
training model: results/EXC/W2/deepVOL_L2/h1000
Epoch 1/50
1403/1403 - 73s - loss: 3.2154 - accuracy1000: 0.4309 - val_loss: 3.3053 - val_accuracy1000: 0.3669 - 73s/epoch - 52ms/step
Epoch 2/50
1403/1403 - 60s - loss: 3.2081 - accuracy1000: 0.4291 - val_loss: 3.2871 - val_accuracy1000: 0.3639 - 60s/epoch - 43ms/step
Epoch 3/50
1403/1403 - 66s - loss: 3.2125 - accuracy1000: 0.4295 - val_loss: 3.2866 - val_accuracy1000: 0.3758 - 66s/epoch - 47ms/step
Epoch 4/50
1403/1403 - 67s - loss: 3.2230 - accuracy1000: 0.4219 - val_loss: 3.2908 - val_accuracy1000: 0.3671 - 67s/epoch - 48ms/step
Epoch 5/50
1403/1403 - 64s - loss: 3.2090 - accuracy1000: 0.4284 - val_loss: 3.3042 - val_accuracy1000: 0.3710 - 64s/epoch - 46ms/step
Epoch 6/50
1403/1403 - 62s - loss: 3.2144 - accuracy1000: 0.4246 - val_loss: 3.3108 - val_accuracy1000: 0.3703 - 62s/epoch - 44ms/step
Epoch 7/50
1403/1403 - 64s - loss: 3.2072 - accuracy1000: 0.4257 - val_loss: 3.3229 - val_accuracy1000: 0.3750 - 64s/epoch - 46ms/step
Epoch 8/50
1403/1403 - 66s - loss: 3.1967 - accuracy1000: 0.4286 - val_loss: 3.3228 - val_accuracy1000: 0.3735 - 66s/epoch - 47ms/step
Epoch 9/50
1403/1403 - 64s - loss: 3.1765 - accuracy1000: 0.4370 - val_loss: 3.3244 - val_accuracy1000: 0.3702 - 64s/epoch - 46ms/step
Epoch 10/50
1403/1403 - 59s - loss: 3.1729 - accuracy1000: 0.4397 - val_loss: 3.3382 - val_accuracy1000: 0.3697 - 59s/epoch - 42ms/step
Epoch 11/50
1403/1403 - 67s - loss: 3.1613 - accuracy1000: 0.4434 - val_loss: 3.3517 - val_accuracy1000: 0.3713 - 67s/epoch - 48ms/step
Epoch 12/50
1403/1403 - 64s - loss: 3.1573 - accuracy1000: 0.4461 - val_loss: 3.3658 - val_accuracy1000: 0.3714 - 64s/epoch - 46ms/step
Epoch 13/50
1403/1403 - 63s - loss: 3.1490 - accuracy1000: 0.4469 - val_loss: 3.3812 - val_accuracy1000: 0.3696 - 63s/epoch - 45ms/step
testing model: results/EXC/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
4918/4918 - 93s - 93s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017634
{'0': {'precision': 0.3455706222058841, 'recall': 0.5630660657614445, 'f1-score': 0.42828799071163637, 'support': 414042}, '1': {'precision': 0.3126604512903662, 'recall': 0.01124141348386658, 'f1-score': 0.02170253274371972, 'support': 411692}, '2': {'precision': 0.36170388387878577, 'recall': 0.47553364657531083, 'f1-score': 0.4108806894694317, 'support': 433105}, 'accuracy': 0.3524811353953921, 'macro avg': {'precision': 0.33997831912501203, 'recall': 0.34994704194020726, 'f1-score': 0.28695707097492923, 'support': 1258839}, 'weighted avg': {'precision': 0.3403583132547717, 'recall': 0.3524811353953921, 'f1-score': 0.2893288628436306, 'support': 1258839}}
[[233133   4807 176102]
 [219717   4628 187347]
 [221782   5367 205956]]
Evaluating performance on  train set...
1403/1403 - 31s - 31s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0981896
{'0': {'precision': 0.35422284543199223, 'recall': 0.5460546553487251, 'f1-score': 0.42970091690900586, 'support': 120281}, '1': {'precision': 0.3194192377495463, 'recall': 0.01166770250673296, 'f1-score': 0.02251305133391428, 'support': 120675}, '2': {'precision': 0.3665756242905789, 'recall': 0.52537619467227, 'f1-score': 0.4318397080535978, 'support': 118024}, 'accuracy': 0.3596161346035991, 'macro avg': {'precision': 0.34673923582403915, 'recall': 0.361032850842576, 'f1-score': 0.294684558765506, 'support': 358980}, 'weighted avg': {'precision': 0.34658453414703677, 'recall': 0.3596161346035991, 'f1-score': 0.29352350593283766, 'support': 358980}}
[[65680  1508 53093]
 [65215  1408 54052]
 [54525  1492 62007]]
Evaluating performance on  val set...
480/480 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0952362
{'0': {'precision': 0.3729934977103466, 'recall': 0.5307362318840579, 'f1-score': 0.43809815481203584, 'support': 43125}, '1': {'precision': 0.30049610205527993, 'recall': 0.011731503513917326, 'f1-score': 0.02258141826218944, 'support': 36142}, '2': {'precision': 0.37912683716197054, 'recall': 0.5230379746835443, 'f1-score': 0.43960422852610914, 'support': 43450}, 'accuracy': 0.3751558463782524, 'macro avg': {'precision': 0.35087214564253233, 'recall': 0.35516857002717317, 'f1-score': 0.30009460053344483, 'support': 122717}, 'weighted avg': {'precision': 0.3538135367058211, 'recall': 0.3751558463782524, 'f1-score': 0.31625548436288814, 'support': 122717}}
[[22888   467 19770]
 [18271   424 17447]
 [20204   520 22726]]
training model: results/EXC/W2/deepVOL_L3/h10
Epoch 1/50
1403/1403 - 89s - loss: 2.4855 - accuracy10: 0.5451 - val_loss: 2.3633 - val_accuracy10: 0.6910 - 89s/epoch - 63ms/step
Epoch 2/50
1403/1403 - 84s - loss: 2.0591 - accuracy10: 0.6528 - val_loss: 2.3230 - val_accuracy10: 0.7079 - 84s/epoch - 60ms/step
Epoch 3/50
1403/1403 - 83s - loss: 1.9834 - accuracy10: 0.6703 - val_loss: 2.2173 - val_accuracy10: 0.7167 - 83s/epoch - 59ms/step
Epoch 4/50
1403/1403 - 81s - loss: 1.9463 - accuracy10: 0.6764 - val_loss: 2.1933 - val_accuracy10: 0.7222 - 81s/epoch - 58ms/step
Epoch 5/50
1403/1403 - 89s - loss: 1.9200 - accuracy10: 0.6824 - val_loss: 2.1792 - val_accuracy10: 0.7335 - 89s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 86s - loss: 1.9025 - accuracy10: 0.6834 - val_loss: 2.1898 - val_accuracy10: 0.7347 - 86s/epoch - 61ms/step
Epoch 7/50
1403/1403 - 86s - loss: 1.8905 - accuracy10: 0.6847 - val_loss: 2.1921 - val_accuracy10: 0.7369 - 86s/epoch - 61ms/step
Epoch 8/50
1403/1403 - 92s - loss: 1.8779 - accuracy10: 0.6848 - val_loss: 2.2668 - val_accuracy10: 0.7551 - 92s/epoch - 65ms/step
Epoch 9/50
1403/1403 - 90s - loss: 1.8674 - accuracy10: 0.6867 - val_loss: 2.2860 - val_accuracy10: 0.7559 - 90s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 83s - loss: 1.8616 - accuracy10: 0.6874 - val_loss: 2.2949 - val_accuracy10: 0.7528 - 83s/epoch - 59ms/step
Epoch 11/50
1403/1403 - 84s - loss: 1.8514 - accuracy10: 0.6889 - val_loss: 2.2633 - val_accuracy10: 0.7496 - 84s/epoch - 60ms/step
Epoch 12/50
1403/1403 - 88s - loss: 1.8442 - accuracy10: 0.6889 - val_loss: 2.2741 - val_accuracy10: 0.7524 - 88s/epoch - 63ms/step
Epoch 13/50
1403/1403 - 88s - loss: 1.8392 - accuracy10: 0.6896 - val_loss: 2.3085 - val_accuracy10: 0.7587 - 88s/epoch - 63ms/step
Epoch 14/50
1403/1403 - 94s - loss: 1.8324 - accuracy10: 0.6898 - val_loss: 2.3058 - val_accuracy10: 0.7537 - 94s/epoch - 67ms/step
Epoch 15/50
1403/1403 - 86s - loss: 1.8225 - accuracy10: 0.6912 - val_loss: 2.3246 - val_accuracy10: 0.7554 - 86s/epoch - 61ms/step
testing model: results/EXC/W2/deepVOL_L3/h10
Evaluating performance on  test set...
4918/4918 - 125s - 125s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5903879
{'0': {'precision': 0.4270304568527919, 'recall': 0.6429568026392659, 'f1-score': 0.5132063671449615, 'support': 145495}, '1': {'precision': 0.9280173228528702, 'recall': 0.7462376375827823, 'f1-score': 0.8272592538252659, 'support': 967145}, '2': {'precision': 0.38023230080053727, 'recall': 0.6815983693458916, 'f1-score': 0.4881488611786722, 'support': 146199}, 'accuracy': 0.7267934978182278, 'macro avg': {'precision': 0.5784266935020664, 'recall': 0.6902642698559799, 'f1-score': 0.6095381607162998, 'support': 1258839}, 'weighted avg': {'precision': 0.8064952644262482, 'recall': 0.7267934978182278, 'f1-score': 0.7515778322597677, 'support': 1258839}}
[[ 93547  30547  21401]
 [104401 721720 141024]
 [ 21116  25434  99649]]
Evaluating performance on  train set...
1403/1403 - 37s - 37s/epoch - 27ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5942938
{'0': {'precision': 0.3646996668672312, 'recall': 0.6897307799056341, 'f1-score': 0.4771193518349636, 'support': 36030}, '1': {'precision': 0.9407802500586006, 'recall': 0.7419782412300437, 'f1-score': 0.8296359565987256, 'support': 286689}, '2': {'precision': 0.3796576654513996, 'recall': 0.6777529577231737, 'f1-score': 0.486687196142307, 'support': 36261}, 'accuracy': 0.730246810407265, 'macro avg': {'precision': 0.5617125274590772, 'recall': 0.7031539929529504, 'f1-score': 0.5978141681919987, 'support': 358980}, 'weighted avg': {'precision': 0.8262806972901267, 'recall': 0.730246810407265, 'f1-score': 0.7596130074858264, 'support': 358980}}
[[ 24851   6582   4597]
 [ 38413 212717  35559]
 [  4877   6808  24576]]
Evaluating performance on  val set...
480/480 - 13s - 13s/epoch - 28ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.58325046
{'0': {'precision': 0.4027057603469407, 'recall': 0.6385857377784422, 'f1-score': 0.4939292321924144, 'support': 13378}, '1': {'precision': 0.9306345001414573, 'recall': 0.7530018937423262, 'f1-score': 0.8324476039294177, 'support': 96106}, '2': {'precision': 0.3843140558527442, 'recall': 0.6894884002115922, 'f1-score': 0.4935359982690539, 'support': 13233}, 'accuracy': 0.7336799302460132, 'macro avg': {'precision': 0.5725514387803808, 'recall': 0.6936920105774536, 'f1-score': 0.6066376114636287, 'support': 122717}, 'weighted avg': {'precision': 0.8141706921911034, 'recall': 0.7336799302460132, 'f1-score': 0.7589979917746126, 'support': 122717}}
[[ 8543  2908  1927]
 [11048 72368 12690]
 [ 1623  2486  9124]]
training model: results/EXC/W2/deepVOL_L3/h20
Epoch 1/50
1403/1403 - 92s - loss: 2.5693 - accuracy20: 0.5667 - val_loss: 2.5504 - val_accuracy20: 0.6981 - 92s/epoch - 66ms/step
Epoch 2/50
1403/1403 - 85s - loss: 2.1963 - accuracy20: 0.6438 - val_loss: 2.3974 - val_accuracy20: 0.6869 - 85s/epoch - 61ms/step
Epoch 3/50
1403/1403 - 85s - loss: 2.1078 - accuracy20: 0.6578 - val_loss: 2.4339 - val_accuracy20: 0.7211 - 85s/epoch - 61ms/step
Epoch 4/50
1403/1403 - 90s - loss: 2.0663 - accuracy20: 0.6632 - val_loss: 2.4099 - val_accuracy20: 0.7176 - 90s/epoch - 64ms/step
Epoch 5/50
1403/1403 - 88s - loss: 2.0443 - accuracy20: 0.6647 - val_loss: 2.3532 - val_accuracy20: 0.6838 - 88s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 90s - loss: 2.0273 - accuracy20: 0.6666 - val_loss: 2.3659 - val_accuracy20: 0.6913 - 90s/epoch - 65ms/step
Epoch 7/50
1403/1403 - 88s - loss: 2.0121 - accuracy20: 0.6677 - val_loss: 2.3867 - val_accuracy20: 0.7092 - 88s/epoch - 63ms/step
Epoch 8/50
1403/1403 - 86s - loss: 1.9985 - accuracy20: 0.6697 - val_loss: 2.3757 - val_accuracy20: 0.7052 - 86s/epoch - 61ms/step
Epoch 9/50
1403/1403 - 89s - loss: 1.9872 - accuracy20: 0.6709 - val_loss: 2.3875 - val_accuracy20: 0.7108 - 89s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 92s - loss: 1.9755 - accuracy20: 0.6716 - val_loss: 2.3858 - val_accuracy20: 0.7161 - 92s/epoch - 65ms/step
Epoch 11/50
1403/1403 - 90s - loss: 1.9645 - accuracy20: 0.6729 - val_loss: 2.3085 - val_accuracy20: 0.7048 - 90s/epoch - 64ms/step
Epoch 12/50
1403/1403 - 92s - loss: 1.9549 - accuracy20: 0.6740 - val_loss: 2.3495 - val_accuracy20: 0.7089 - 92s/epoch - 65ms/step
Epoch 13/50
1403/1403 - 89s - loss: 1.9479 - accuracy20: 0.6744 - val_loss: 2.3540 - val_accuracy20: 0.7042 - 89s/epoch - 63ms/step
Epoch 14/50
1403/1403 - 90s - loss: 1.9394 - accuracy20: 0.6764 - val_loss: 2.3667 - val_accuracy20: 0.7110 - 90s/epoch - 64ms/step
Epoch 15/50
1403/1403 - 89s - loss: 1.9335 - accuracy20: 0.6769 - val_loss: 2.3868 - val_accuracy20: 0.7044 - 89s/epoch - 64ms/step
Epoch 16/50
1403/1403 - 82s - loss: 1.9264 - accuracy20: 0.6762 - val_loss: 2.3927 - val_accuracy20: 0.7124 - 82s/epoch - 58ms/step
Epoch 17/50
1403/1403 - 88s - loss: 1.9214 - accuracy20: 0.6769 - val_loss: 2.3691 - val_accuracy20: 0.7080 - 88s/epoch - 63ms/step
Epoch 18/50
1403/1403 - 80s - loss: 1.9152 - accuracy20: 0.6770 - val_loss: 2.3975 - val_accuracy20: 0.7225 - 80s/epoch - 57ms/step
Epoch 19/50
1403/1403 - 85s - loss: 1.9090 - accuracy20: 0.6779 - val_loss: 2.3948 - val_accuracy20: 0.7196 - 85s/epoch - 60ms/step
Epoch 20/50
1403/1403 - 86s - loss: 1.9046 - accuracy20: 0.6780 - val_loss: 2.3957 - val_accuracy20: 0.7166 - 86s/epoch - 61ms/step
Epoch 21/50
1403/1403 - 83s - loss: 1.8987 - accuracy20: 0.6788 - val_loss: 2.3738 - val_accuracy20: 0.7126 - 83s/epoch - 59ms/step
testing model: results/EXC/W2/deepVOL_L3/h20
Evaluating performance on  test set...
4918/4918 - 126s - 126s/epoch - 26ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6330632
{'0': {'precision': 0.48142122176058166, 'recall': 0.5855590429941964, 'f1-score': 0.528408179988243, 'support': 202632}, '1': {'precision': 0.8669364090375143, 'recall': 0.7419604799783646, 'f1-score': 0.7995945029810368, 'support': 850455}, '2': {'precision': 0.4745606635737382, 'recall': 0.6562366343948054, 'f1-score': 0.5508044514065661, 'support': 205752}, 'accuracy': 0.7027737462852676, 'macro avg': {'precision': 0.6076394314572781, 'recall': 0.6612520524557888, 'f1-score': 0.6262690447919487, 'support': 1258839}, 'weighted avg': {'precision': 0.7407488601857848, 'recall': 0.7027737462852676, 'f1-score': 0.7152786550511376, 'support': 1258839}}
[[118653  50389  33590]
 [103543 631004 115908]
 [ 24268  46462 135022]]
Evaluating performance on  train set...
1403/1403 - 42s - 42s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6448548
{'0': {'precision': 0.41147874398531675, 'recall': 0.6504479426006156, 'f1-score': 0.5040752922588438, 'support': 51011}, '1': {'precision': 0.8955169331219471, 'recall': 0.7067026803705826, 'f1-score': 0.7899843587297023, 'support': 256569}, '2': {'precision': 0.4547323746886162, 'recall': 0.6712256809338522, 'f1-score': 0.542165929394756, 'support': 51400}, 'accuracy': 0.6936291715415901, 'macro avg': {'precision': 0.5872426839319601, 'recall': 0.6761254346350167, 'f1-score': 0.6120751934611007, 'support': 358980}, 'weighted avg': {'precision': 0.7636221245824133, 'recall': 0.6936291715415901, 'f1-score': 0.7138732253585919, 'support': 358980}}
[[ 33180  10480   7351]
 [ 41232 181318  34019]
 [  6224  10675  34501]]
Evaluating performance on  val set...
480/480 - 14s - 14s/epoch - 30ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.63535494
{'0': {'precision': 0.4551271534044299, 'recall': 0.5920392700885712, 'f1-score': 0.5146329019989797, 'support': 18742}, '1': {'precision': 0.8780028721609525, 'recall': 0.7371815883124181, 'f1-score': 0.8014534162281176, 'support': 85424}, '2': {'precision': 0.46783647704215825, 'recall': 0.6711767559700286, 'f1-score': 0.5513561386029006, 'support': 18551}, 'accuracy': 0.7050367919685129, 'macro avg': {'precision': 0.6003221675358469, 'recall': 0.6667992047903392, 'f1-score': 0.6224808189433326, 'support': 122717}, 'weighted avg': {'precision': 0.7514145957462464, 'recall': 0.7050367919685129, 'f1-score': 0.7198417024891254, 'support': 122717}}
[[11096  4643  3003]
 [11291 62973 11160]
 [ 1993  4107 12451]]
training model: results/EXC/W2/deepVOL_L3/h30
Epoch 1/50
1403/1403 - 93s - loss: 2.7486 - accuracy30: 0.5112 - val_loss: 2.7055 - val_accuracy30: 0.6527 - 93s/epoch - 66ms/step
Epoch 2/50
1403/1403 - 87s - loss: 2.3627 - accuracy30: 0.6215 - val_loss: 2.6448 - val_accuracy30: 0.6878 - 87s/epoch - 62ms/step
Epoch 3/50
1403/1403 - 88s - loss: 2.2659 - accuracy30: 0.6364 - val_loss: 2.5855 - val_accuracy30: 0.6833 - 88s/epoch - 62ms/step
Epoch 4/50
1403/1403 - 98s - loss: 2.2195 - accuracy30: 0.6427 - val_loss: 2.6588 - val_accuracy30: 0.6939 - 98s/epoch - 70ms/step
Epoch 5/50
1403/1403 - 87s - loss: 2.1927 - accuracy30: 0.6450 - val_loss: 2.5452 - val_accuracy30: 0.6843 - 87s/epoch - 62ms/step
Epoch 6/50
1403/1403 - 92s - loss: 2.1715 - accuracy30: 0.6464 - val_loss: 2.5521 - val_accuracy30: 0.6838 - 92s/epoch - 66ms/step
Epoch 7/50
1403/1403 - 95s - loss: 2.1561 - accuracy30: 0.6486 - val_loss: 2.5294 - val_accuracy30: 0.6870 - 95s/epoch - 67ms/step
Epoch 8/50
1403/1403 - 89s - loss: 2.1421 - accuracy30: 0.6498 - val_loss: 2.5348 - val_accuracy30: 0.6789 - 89s/epoch - 64ms/step
Epoch 9/50
1403/1403 - 90s - loss: 2.1298 - accuracy30: 0.6512 - val_loss: 2.5330 - val_accuracy30: 0.6783 - 90s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 88s - loss: 2.1170 - accuracy30: 0.6527 - val_loss: 2.5061 - val_accuracy30: 0.6782 - 88s/epoch - 63ms/step
Epoch 11/50
1403/1403 - 90s - loss: 2.1059 - accuracy30: 0.6524 - val_loss: 2.5175 - val_accuracy30: 0.6765 - 90s/epoch - 64ms/step
Epoch 12/50
1403/1403 - 89s - loss: 2.0963 - accuracy30: 0.6525 - val_loss: 2.5161 - val_accuracy30: 0.6780 - 89s/epoch - 63ms/step
Epoch 13/50
1403/1403 - 97s - loss: 2.0886 - accuracy30: 0.6543 - val_loss: 2.5229 - val_accuracy30: 0.6747 - 97s/epoch - 69ms/step
Epoch 14/50
1403/1403 - 90s - loss: 2.0809 - accuracy30: 0.6552 - val_loss: 2.5337 - val_accuracy30: 0.6822 - 90s/epoch - 64ms/step
Epoch 15/50
1403/1403 - 93s - loss: 2.0735 - accuracy30: 0.6548 - val_loss: 2.5157 - val_accuracy30: 0.6759 - 93s/epoch - 66ms/step
Epoch 16/50
1403/1403 - 90s - loss: 2.0680 - accuracy30: 0.6554 - val_loss: 2.5435 - val_accuracy30: 0.6756 - 90s/epoch - 64ms/step
Epoch 17/50
1403/1403 - 90s - loss: 2.0618 - accuracy30: 0.6566 - val_loss: 2.5486 - val_accuracy30: 0.6839 - 90s/epoch - 64ms/step
Epoch 18/50
1403/1403 - 98s - loss: 2.0582 - accuracy30: 0.6565 - val_loss: 2.5459 - val_accuracy30: 0.6881 - 98s/epoch - 70ms/step
Epoch 19/50
1403/1403 - 91s - loss: 2.0521 - accuracy30: 0.6569 - val_loss: 2.5619 - val_accuracy30: 0.6843 - 91s/epoch - 65ms/step
Epoch 20/50
1403/1403 - 91s - loss: 2.0475 - accuracy30: 0.6574 - val_loss: 2.5220 - val_accuracy30: 0.6809 - 91s/epoch - 65ms/step
testing model: results/EXC/W2/deepVOL_L3/h30
Evaluating performance on  test set...
4918/4918 - 142s - 142s/epoch - 29ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7068475
{'0': {'precision': 0.5141877795469487, 'recall': 0.556088459278073, 'f1-score': 0.5343179260370802, 'support': 243321}, '1': {'precision': 0.8004063544203432, 'recall': 0.7372945351535142, 'f1-score': 0.7675552963747194, 'support': 766737}, '2': {'precision': 0.5176186033654677, 'recall': 0.6021520936084347, 'f1-score': 0.556694556393548, 'support': 248781}, 'accuracy': 0.6755613704373633, 'macro avg': {'precision': 0.6107375791109199, 'recall': 0.6318450293466739, 'f1-score': 0.6195225929351159, 'support': 1258839}, 'weighted avg': {'precision': 0.6891965735413331, 'recall': 0.6755613704373633, 'f1-score': 0.680800996626157, 'support': 1258839}}
[[135308  70164  37849]
 [ 99669 565311 101757]
 [ 28172  70805 149804]]
Evaluating performance on  train set...
1403/1403 - 46s - 46s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70426327
{'0': {'precision': 0.44834021508386407, 'recall': 0.6174184014392187, 'f1-score': 0.5194675315899723, 'support': 62256}, '1': {'precision': 0.8406256529960094, 'recall': 0.7043600802835547, 'f1-score': 0.7664836505328998, 'support': 234170}, '2': {'precision': 0.4986175115207373, 'recall': 0.6140454647184832, 'f1-score': 0.5503442248314696, 'support': 62554}, 'accuracy': 0.6735444871580589, 'macro avg': {'precision': 0.5958611265335368, 'recall': 0.6452746488137522, 'f1-score': 0.6120984689847806, 'support': 358980}, 'weighted avg': {'precision': 0.712997095682224, 'recall': 0.6735444871580589, 'f1-score': 0.6859816138282417, 'support': 358980}}
[[ 38438  14671   9147]
 [ 39753 164940  29477]
 [  7543  16600  38411]]
Evaluating performance on  val set...
480/480 - 16s - 16s/epoch - 32ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7075636
{'0': {'precision': 0.48601869302665485, 'recall': 0.5571182928442309, 'f1-score': 0.5191454396055876, 'support': 22681}, '1': {'precision': 0.8168389955686853, 'recall': 0.7354198138177687, 'f1-score': 0.7739941025397127, 'support': 77451}, '2': {'precision': 0.5113202653129284, 'recall': 0.6109807394288245, 'f1-score': 0.5567255708867909, 'support': 22585}, 'accuracy': 0.6795635486525909, 'macro avg': {'precision': 0.6047259846360896, 'recall': 0.6345062820302747, 'f1-score': 0.6166217043440304, 'support': 122717}, 'weighted avg': {'precision': 0.6994675164355411, 'recall': 0.6795635486525909, 'f1-score': 0.6869056607477024, 'support': 122717}}
[[12636  6331  3714]
 [11018 56959  9474]
 [ 2345  6441 13799]]
training model: results/EXC/W2/deepVOL_L3/h50
Epoch 1/50
1403/1403 - 98s - loss: 2.8995 - accuracy50: 0.5026 - val_loss: 2.8829 - val_accuracy50: 0.5762 - 98s/epoch - 70ms/step
Epoch 2/50
1403/1403 - 96s - loss: 2.6094 - accuracy50: 0.5818 - val_loss: 2.8611 - val_accuracy50: 0.6171 - 96s/epoch - 68ms/step
Epoch 3/50
1403/1403 - 96s - loss: 2.4954 - accuracy50: 0.6006 - val_loss: 2.9009 - val_accuracy50: 0.6327 - 96s/epoch - 69ms/step
Epoch 4/50
1403/1403 - 94s - loss: 2.4520 - accuracy50: 0.6065 - val_loss: 2.8957 - val_accuracy50: 0.6311 - 94s/epoch - 67ms/step
Epoch 5/50
1403/1403 - 97s - loss: 2.4295 - accuracy50: 0.6090 - val_loss: 2.8364 - val_accuracy50: 0.6297 - 97s/epoch - 69ms/step
Epoch 6/50
1403/1403 - 95s - loss: 2.4136 - accuracy50: 0.6101 - val_loss: 2.8581 - val_accuracy50: 0.6312 - 95s/epoch - 68ms/step
Epoch 7/50
1403/1403 - 92s - loss: 2.3979 - accuracy50: 0.6121 - val_loss: 2.8651 - val_accuracy50: 0.6349 - 92s/epoch - 66ms/step
Epoch 8/50
1403/1403 - 94s - loss: 2.3832 - accuracy50: 0.6131 - val_loss: 2.8424 - val_accuracy50: 0.6332 - 94s/epoch - 67ms/step
Epoch 9/50
1403/1403 - 94s - loss: 2.3735 - accuracy50: 0.6152 - val_loss: 2.8210 - val_accuracy50: 0.6355 - 94s/epoch - 67ms/step
Epoch 10/50
1403/1403 - 94s - loss: 2.3634 - accuracy50: 0.6155 - val_loss: 2.8013 - val_accuracy50: 0.6336 - 94s/epoch - 67ms/step
Epoch 11/50
1403/1403 - 95s - loss: 2.3532 - accuracy50: 0.6168 - val_loss: 2.8404 - val_accuracy50: 0.6357 - 95s/epoch - 68ms/step
Epoch 12/50
1403/1403 - 87s - loss: 2.3460 - accuracy50: 0.6175 - val_loss: 2.8426 - val_accuracy50: 0.6365 - 87s/epoch - 62ms/step
Epoch 13/50
1403/1403 - 93s - loss: 2.3383 - accuracy50: 0.6177 - val_loss: 2.8337 - val_accuracy50: 0.6355 - 93s/epoch - 66ms/step
Epoch 14/50
1403/1403 - 98s - loss: 2.3312 - accuracy50: 0.6186 - val_loss: 2.8461 - val_accuracy50: 0.6351 - 98s/epoch - 70ms/step
Epoch 15/50
1403/1403 - 92s - loss: 2.3257 - accuracy50: 0.6194 - val_loss: 2.8790 - val_accuracy50: 0.6353 - 92s/epoch - 65ms/step
Epoch 16/50
1403/1403 - 89s - loss: 2.3217 - accuracy50: 0.6197 - val_loss: 2.8737 - val_accuracy50: 0.6322 - 89s/epoch - 64ms/step
Epoch 17/50
1403/1403 - 95s - loss: 2.3150 - accuracy50: 0.6203 - val_loss: 2.8458 - val_accuracy50: 0.6316 - 95s/epoch - 68ms/step
Epoch 18/50
1403/1403 - 96s - loss: 2.3095 - accuracy50: 0.6206 - val_loss: 2.8512 - val_accuracy50: 0.6327 - 96s/epoch - 68ms/step
Epoch 19/50
1403/1403 - 95s - loss: 2.3065 - accuracy50: 0.6220 - val_loss: 2.8477 - val_accuracy50: 0.6304 - 95s/epoch - 68ms/step
Epoch 20/50
1403/1403 - 97s - loss: 2.3011 - accuracy50: 0.6227 - val_loss: 2.8581 - val_accuracy50: 0.6321 - 97s/epoch - 69ms/step
testing model: results/EXC/W2/deepVOL_L3/h50
Evaluating performance on  test set...
4918/4918 - 142s - 142s/epoch - 29ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8237549
{'0': {'precision': 0.5911686386471573, 'recall': 0.41903659236629337, 'f1-score': 0.49043755515700177, 'support': 308343}, '1': {'precision': 0.658991599611892, 'recall': 0.7646521028572331, 'f1-score': 0.707900876510797, 'support': 633305}, '2': {'precision': 0.5620404020561176, 'recall': 0.5412007276372911, 'f1-score': 0.5514237393213529, 'support': 317191}, 'accuracy': 0.6236929424652398, 'macro avg': {'precision': 0.6040668801050556, 'recall': 0.5749631409536059, 'f1-score': 0.5832540569963839, 'support': 1258839}, 'weighted avg': {'precision': 0.6179499870175389, 'recall': 0.6236929424652398, 'f1-score': 0.6152071861195315, 'support': 1258839}}
[[129207 128573  50563]
 [ 65844 484258  83203]
 [ 23511 122016 171664]]
Evaluating performance on  train set...
1403/1403 - 44s - 44s/epoch - 31ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.775817
{'0': {'precision': 0.5399091963735839, 'recall': 0.46790209269418864, 'f1-score': 0.5013332269411584, 'support': 80566}, '1': {'precision': 0.7115442957512484, 'recall': 0.7461458054547015, 'f1-score': 0.7284343787898209, 'support': 198031}, '2': {'precision': 0.5448109156052909, 'recall': 0.5523680380179888, 'f1-score': 0.5485634509300041, 'support': 80383}, 'accuracy': 0.6403086522926068, 'macro avg': {'precision': 0.5987548025767078, 'recall': 0.5888053120556264, 'f1-score': 0.5927770188869945, 'support': 358980}, 'weighted avg': {'precision': 0.6356891430610333, 'recall': 0.6403086522926068, 'f1-score': 0.6371891946737281, 'support': 358980}}
[[ 37697  30325  12544]
 [ 25718 147760  24553]
 [  6406  29576  44401]]
Evaluating performance on  val set...
480/480 - 15s - 15s/epoch - 32ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8033241
{'0': {'precision': 0.56701321917486, 'recall': 0.4143490666574994, 'f1-score': 0.4788066579271441, 'support': 29089}, '1': {'precision': 0.6797008751866106, 'recall': 0.7702109167662533, 'f1-score': 0.7221308732156628, 'support': 64433}, '2': {'precision': 0.5598832917355081, 'recall': 0.5455386196266484, 'f1-score': 0.5526178827937962, 'support': 29195}, 'accuracy': 0.632406268080217, 'macro avg': {'precision': 0.6021991286989928, 'recall': 0.5766995343501337, 'f1-score': 0.584518471312201, 'support': 122717}, 'weighted avg': {'precision': 0.624484030131885, 'recall': 0.632406268080217, 'f1-score': 0.6241249746531644, 'support': 122717}}
[[12053 12272  4764]
 [ 7050 49627  7756]
 [ 2154 11114 15927]]
training model: results/EXC/W2/deepVOL_L3/h100
Epoch 1/50
1403/1403 - 100s - loss: 3.1538 - accuracy100: 0.4418 - val_loss: 3.3371 - val_accuracy100: 0.4421 - 100s/epoch - 71ms/step
Epoch 2/50
1403/1403 - 99s - loss: 3.0814 - accuracy100: 0.4671 - val_loss: 3.3037 - val_accuracy100: 0.4658 - 99s/epoch - 70ms/step
Epoch 3/50
1403/1403 - 91s - loss: 2.9651 - accuracy100: 0.5026 - val_loss: 3.2380 - val_accuracy100: 0.4971 - 91s/epoch - 65ms/step
Epoch 4/50
1403/1403 - 93s - loss: 2.8836 - accuracy100: 0.5214 - val_loss: 3.3207 - val_accuracy100: 0.4985 - 93s/epoch - 67ms/step
Epoch 5/50
1403/1403 - 93s - loss: 2.8399 - accuracy100: 0.5318 - val_loss: 3.2957 - val_accuracy100: 0.4904 - 93s/epoch - 66ms/step
Epoch 6/50
1403/1403 - 93s - loss: 2.8176 - accuracy100: 0.5367 - val_loss: 3.2406 - val_accuracy100: 0.4918 - 93s/epoch - 67ms/step
Epoch 7/50
1403/1403 - 90s - loss: 2.8011 - accuracy100: 0.5401 - val_loss: 3.2628 - val_accuracy100: 0.4871 - 90s/epoch - 64ms/step
Epoch 8/50
1403/1403 - 86s - loss: 2.7896 - accuracy100: 0.5429 - val_loss: 3.2562 - val_accuracy100: 0.4886 - 86s/epoch - 62ms/step
Epoch 9/50
1403/1403 - 85s - loss: 2.7806 - accuracy100: 0.5444 - val_loss: 3.3086 - val_accuracy100: 0.4847 - 85s/epoch - 60ms/step
Epoch 10/50
1403/1403 - 84s - loss: 2.7727 - accuracy100: 0.5464 - val_loss: 3.3014 - val_accuracy100: 0.4855 - 84s/epoch - 60ms/step
Epoch 11/50
1403/1403 - 99s - loss: 2.7665 - accuracy100: 0.5467 - val_loss: 3.3139 - val_accuracy100: 0.4857 - 99s/epoch - 71ms/step
Epoch 12/50
1403/1403 - 89s - loss: 2.7609 - accuracy100: 0.5479 - val_loss: 3.3084 - val_accuracy100: 0.4897 - 89s/epoch - 64ms/step
Epoch 13/50
1403/1403 - 88s - loss: 2.7563 - accuracy100: 0.5482 - val_loss: 3.2276 - val_accuracy100: 0.4973 - 88s/epoch - 62ms/step
Epoch 14/50
1403/1403 - 86s - loss: 2.7503 - accuracy100: 0.5497 - val_loss: 3.2462 - val_accuracy100: 0.4945 - 86s/epoch - 61ms/step
Epoch 15/50
1403/1403 - 94s - loss: 2.7440 - accuracy100: 0.5500 - val_loss: 3.2799 - val_accuracy100: 0.4938 - 94s/epoch - 67ms/step
Epoch 16/50
1403/1403 - 87s - loss: 2.7391 - accuracy100: 0.5512 - val_loss: 3.3469 - val_accuracy100: 0.4896 - 87s/epoch - 62ms/step
Epoch 17/50
1403/1403 - 88s - loss: 2.7343 - accuracy100: 0.5526 - val_loss: 3.3114 - val_accuracy100: 0.4910 - 88s/epoch - 63ms/step
Epoch 18/50
1403/1403 - 88s - loss: 2.7296 - accuracy100: 0.5536 - val_loss: 3.3167 - val_accuracy100: 0.4886 - 88s/epoch - 63ms/step
Epoch 19/50
1403/1403 - 93s - loss: 2.7239 - accuracy100: 0.5541 - val_loss: 3.3139 - val_accuracy100: 0.4887 - 93s/epoch - 66ms/step
Epoch 20/50
1403/1403 - 93s - loss: 2.7198 - accuracy100: 0.5549 - val_loss: 3.3529 - val_accuracy100: 0.4929 - 93s/epoch - 66ms/step
Epoch 21/50
1403/1403 - 97s - loss: 2.7166 - accuracy100: 0.5554 - val_loss: 3.2996 - val_accuracy100: 0.4956 - 97s/epoch - 69ms/step
Epoch 22/50
1403/1403 - 89s - loss: 2.7106 - accuracy100: 0.5569 - val_loss: 3.3200 - val_accuracy100: 0.4947 - 89s/epoch - 63ms/step
Epoch 23/50
1403/1403 - 89s - loss: 2.7064 - accuracy100: 0.5584 - val_loss: 3.3526 - val_accuracy100: 0.4927 - 89s/epoch - 63ms/step
testing model: results/EXC/W2/deepVOL_L3/h100
Evaluating performance on  test set...
4918/4918 - 146s - 146s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0491228
{'0': {'precision': 0.6195940786999579, 'recall': 0.26563545844957226, 'f1-score': 0.3718496734261191, 'support': 409358}, '1': {'precision': 0.4263339421843933, 'recall': 0.7744850228749178, 'f1-score': 0.5499401035004889, 'support': 428854}, '2': {'precision': 0.5809106266062825, 'recall': 0.4202202901858416, 'f1-score': 0.4876693507113385, 'support': 420627}, 'accuracy': 0.49064018512295854, 'macro avg': {'precision': 0.5422795491635445, 'recall': 0.48678025717011053, 'f1-score': 0.4698197092126488, 'support': 1258839}, 'weighted avg': {'precision': 0.5408296878691587, 'recall': 0.49064018512295854, 'f1-score': 0.47122034489130543, 'support': 1258839}}
[[108740 235625  64993]
 [ 34188 332141  62525]
 [ 32574 211297 176756]]
Evaluating performance on  train set...
1403/1403 - 43s - 43s/epoch - 30ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9820801
{'0': {'precision': 0.6134434089802981, 'recall': 0.307736824971968, 'f1-score': 0.4098636076235209, 'support': 110588}, '1': {'precision': 0.47922565118912797, 'recall': 0.7837587544133819, 'f1-score': 0.5947774141831199, 'support': 138216}, '2': {'precision': 0.5879672067652185, 'recall': 0.4133477345338368, 'f1-score': 0.4854315118503872, 'support': 110176}, 'accuracy': 0.5234302746671123, 'macro avg': {'precision': 0.560212088978215, 'recall': 0.5016144379730623, 'f1-score': 0.49669084455234264, 'support': 358980}, 'weighted avg': {'precision': 0.5539473154204537, 'recall': 0.5234302746671123, 'f1-score': 0.5042527549396408, 'support': 358980}}
[[ 34032  61730  14826]
 [ 12800 108328  17088]
 [  8645  55990  45541]]
Evaluating performance on  val set...
480/480 - 15s - 15s/epoch - 31ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0367252
{'0': {'precision': 0.6132657423807488, 'recall': 0.2572900117870138, 'f1-score': 0.36249751800574015, 'support': 39026}, '1': {'precision': 0.4419533711405167, 'recall': 0.7979294653014789, 'f1-score': 0.5688402270884023, 'support': 43950}, '2': {'precision': 0.5890568274431355, 'recall': 0.4001157494778692, 'f1-score': 0.4765415449164606, 'support': 39741}, 'accuracy': 0.49716828149319164, 'macro avg': {'precision': 0.548091980321467, 'recall': 0.48511174218878733, 'f1-score': 0.46929309667020097, 'support': 122717}, 'weighted avg': {'precision': 0.5440718637449943, 'recall': 0.49716828149319164, 'f1-score': 0.473329641816149, 'support': 122717}}
[[10041 23241  5744]
 [ 3532 35069  5349]
 [ 2800 21040 15901]]
training model: results/EXC/W2/deepVOL_L3/h200
Epoch 1/50
1403/1403 - 103s - loss: 3.2743 - accuracy200: 0.3875 - val_loss: 3.3490 - val_accuracy200: 0.3565 - 103s/epoch - 73ms/step
Epoch 2/50
1403/1403 - 88s - loss: 3.2154 - accuracy200: 0.4150 - val_loss: 3.2785 - val_accuracy200: 0.3891 - 88s/epoch - 63ms/step
Epoch 3/50
1403/1403 - 91s - loss: 3.2016 - accuracy200: 0.4202 - val_loss: 3.3326 - val_accuracy200: 0.3890 - 91s/epoch - 65ms/step
Epoch 4/50
1403/1403 - 94s - loss: 3.1683 - accuracy200: 0.4330 - val_loss: 3.2720 - val_accuracy200: 0.4069 - 94s/epoch - 67ms/step
Epoch 5/50
1403/1403 - 88s - loss: 3.1311 - accuracy200: 0.4400 - val_loss: 3.2671 - val_accuracy200: 0.4079 - 88s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 85s - loss: 3.1135 - accuracy200: 0.4449 - val_loss: 3.2869 - val_accuracy200: 0.4071 - 85s/epoch - 61ms/step
Epoch 7/50
1403/1403 - 90s - loss: 3.1047 - accuracy200: 0.4479 - val_loss: 3.3135 - val_accuracy200: 0.4062 - 90s/epoch - 64ms/step
Epoch 8/50
1403/1403 - 86s - loss: 3.0966 - accuracy200: 0.4508 - val_loss: 3.3021 - val_accuracy200: 0.4039 - 86s/epoch - 61ms/step
Epoch 9/50
1403/1403 - 90s - loss: 3.0890 - accuracy200: 0.4531 - val_loss: 3.3326 - val_accuracy200: 0.3981 - 90s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 88s - loss: 3.0813 - accuracy200: 0.4563 - val_loss: 3.3256 - val_accuracy200: 0.4028 - 88s/epoch - 63ms/step
Epoch 11/50
1403/1403 - 88s - loss: 3.0745 - accuracy200: 0.4586 - val_loss: 3.4124 - val_accuracy200: 0.4013 - 88s/epoch - 63ms/step
Epoch 12/50
1403/1403 - 95s - loss: 3.0692 - accuracy200: 0.4605 - val_loss: 3.3456 - val_accuracy200: 0.4052 - 95s/epoch - 68ms/step
Epoch 13/50
1403/1403 - 88s - loss: 3.0622 - accuracy200: 0.4623 - val_loss: 3.3708 - val_accuracy200: 0.4068 - 88s/epoch - 63ms/step
Epoch 14/50
1403/1403 - 94s - loss: 3.0580 - accuracy200: 0.4648 - val_loss: 3.4128 - val_accuracy200: 0.4056 - 94s/epoch - 67ms/step
Epoch 15/50
1403/1403 - 91s - loss: 3.0535 - accuracy200: 0.4668 - val_loss: 3.4151 - val_accuracy200: 0.4052 - 91s/epoch - 65ms/step
testing model: results/EXC/W2/deepVOL_L3/h200
Evaluating performance on  test set...
4918/4918 - 129s - 129s/epoch - 26ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942667
{'0': {'precision': 0.4873090992333603, 'recall': 0.2418142618694362, 'f1-score': 0.32323279274756705, 'support': 431360}, '1': {'precision': 0.3473645426894599, 'recall': 0.584192582414021, 'f1-score': 0.4356743859594849, 'support': 385705}, '2': {'precision': 0.46442068591191954, 'recall': 0.41642106597491024, 'f1-score': 0.4391130567414061, 'support': 441774}, 'accuracy': 0.40799419147325433, 'macro avg': {'precision': 0.43303144261157994, 'recall': 0.4141426367527892, 'f1-score': 0.3993400784828194, 'support': 1258839}, 'weighted avg': {'precision': 0.43639804461205345, 'recall': 0.40799419147325433, 'f1-score': 0.39835135235321717, 'support': 1258839}}
[[104309 212967 114084]
 [ 62312 225326  98067]
 [ 47430 210380 183964]]
Evaluating performance on  train set...
1403/1403 - 39s - 39s/epoch - 28ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0769444
{'0': {'precision': 0.49559617109500215, 'recall': 0.2774142571421517, 'f1-score': 0.3557143309446667, 'support': 121497}, '1': {'precision': 0.36500980695777846, 'recall': 0.6094401737391844, 'f1-score': 0.45656861732348536, 'support': 116036}, '2': {'precision': 0.4735423887443305, 'recall': 0.37912011000683427, 'f1-score': 0.4211031745305883, 'support': 121447}, 'accuracy': 0.41914591342136054, 'macro avg': {'precision': 0.44471612226570373, 'recall': 0.4219915136293901, 'f1-score': 0.41112870759958015, 'support': 358980}, 'weighted avg': {'precision': 0.4459246432823973, 'recall': 0.41914591342136054, 'f1-score': 0.4104360615737603, 'support': 358980}}
[[33705 61471 26321]
 [20452 70717 24867]
 [13852 61552 46043]]
Evaluating performance on  val set...
480/480 - 14s - 14s/epoch - 29ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924574
{'0': {'precision': 0.4878839916046556, 'recall': 0.24488232336533627, 'f1-score': 0.3260907685195517, 'support': 41767}, '1': {'precision': 0.3523790804215365, 'recall': 0.6048322217320219, 'f1-score': 0.4453148884133292, 'support': 38533}, '2': {'precision': 0.4657999663053855, 'recall': 0.39109319376665014, 'f1-score': 0.4251899885942766, 'support': 42417}, 'accuracy': 0.4084438178899419, 'macro avg': {'precision': 0.43535434611052587, 'recall': 0.4136025796213361, 'f1-score': 0.3988652151757191, 'support': 122717}, 'weighted avg': {'precision': 0.43770228211258627, 'recall': 0.4084438178899419, 'f1-score': 0.3977805476844314, 'support': 122717}}
[[10228 21568  9971]
 [ 6173 23306  9054]
 [ 4563 21265 16589]]
training model: results/EXC/W2/deepVOL_L3/h300
Epoch 1/50
1403/1403 - 99s - loss: 3.2837 - accuracy300: 0.3821 - val_loss: 3.3247 - val_accuracy300: 0.3418 - 99s/epoch - 71ms/step
Epoch 2/50
1403/1403 - 85s - loss: 3.2576 - accuracy300: 0.3925 - val_loss: 3.2811 - val_accuracy300: 0.3685 - 85s/epoch - 61ms/step
Epoch 3/50
1403/1403 - 85s - loss: 3.2394 - accuracy300: 0.4025 - val_loss: 3.2728 - val_accuracy300: 0.3930 - 85s/epoch - 61ms/step
Epoch 4/50
1403/1403 - 87s - loss: 3.2264 - accuracy300: 0.4102 - val_loss: 3.2811 - val_accuracy300: 0.3947 - 87s/epoch - 62ms/step
Epoch 5/50
1403/1403 - 84s - loss: 3.2135 - accuracy300: 0.4175 - val_loss: 3.2800 - val_accuracy300: 0.3941 - 84s/epoch - 60ms/step
Epoch 6/50
1403/1403 - 88s - loss: 3.2013 - accuracy300: 0.4226 - val_loss: 3.2944 - val_accuracy300: 0.3857 - 88s/epoch - 63ms/step
Epoch 7/50
1403/1403 - 83s - loss: 3.1918 - accuracy300: 0.4274 - val_loss: 3.2898 - val_accuracy300: 0.3838 - 83s/epoch - 59ms/step
Epoch 8/50
1403/1403 - 90s - loss: 3.1850 - accuracy300: 0.4291 - val_loss: 3.2937 - val_accuracy300: 0.3833 - 90s/epoch - 64ms/step
Epoch 9/50
1403/1403 - 90s - loss: 3.1783 - accuracy300: 0.4310 - val_loss: 3.3070 - val_accuracy300: 0.3785 - 90s/epoch - 64ms/step
Epoch 10/50
1403/1403 - 92s - loss: 3.1697 - accuracy300: 0.4343 - val_loss: 3.3202 - val_accuracy300: 0.3792 - 92s/epoch - 66ms/step
Epoch 11/50
1403/1403 - 84s - loss: 3.1622 - accuracy300: 0.4367 - val_loss: 3.3352 - val_accuracy300: 0.3879 - 84s/epoch - 60ms/step
Epoch 12/50
1403/1403 - 91s - loss: 3.1563 - accuracy300: 0.4382 - val_loss: 3.3434 - val_accuracy300: 0.3835 - 91s/epoch - 65ms/step
Epoch 13/50
1403/1403 - 99s - loss: 3.1504 - accuracy300: 0.4411 - val_loss: 3.4061 - val_accuracy300: 0.3816 - 99s/epoch - 70ms/step
testing model: results/EXC/W2/deepVOL_L3/h300
Evaluating performance on  test set...
4918/4918 - 147s - 147s/epoch - 30ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924077
{'0': {'precision': 0.38352963317284317, 'recall': 0.5245352716873213, 'f1-score': 0.44308467216324243, 'support': 419600}, '1': {'precision': 0.3264110916732018, 'recall': 0.159164503406063, 'f1-score': 0.21398546318587247, 'support': 407949}, '2': {'precision': 0.4037852228586477, 'recall': 0.45505112569268935, 'f1-score': 0.42788808487166125, 'support': 431290}, 'accuracy': 0.38232450694648007, 'macro avg': {'precision': 0.3712419825682309, 'recall': 0.3795836335953579, 'f1-score': 0.36165274007359205, 'support': 1258839}, 'weighted avg': {'precision': 0.37195911572728696, 'recall': 0.38232450694648007, 'f1-score': 0.3636345364937127, 'support': 1258839}}
[[220095  64375 135130]
 [188359  64931 154659]
 [165413  69618 196259]]
Evaluating performance on  train set...
1403/1403 - 39s - 39s/epoch - 28ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0881968
{'0': {'precision': 0.3914702856875672, 'recall': 0.5544527408486615, 'f1-score': 0.45892058184708356, 'support': 120802}, '1': {'precision': 0.3318266887955083, 'recall': 0.1596744320402372, 'f1-score': 0.21560169783182287, 'support': 117702}, '2': {'precision': 0.4109458573975588, 'recall': 0.44768252598027825, 'f1-score': 0.42852829708964657, 'support': 120476}, 'accuracy': 0.3891804557356956, 'macro avg': {'precision': 0.37808094396021147, 'recall': 0.387269899623059, 'f1-score': 0.36768352558951767, 'support': 358980}, 'weighted avg': {'precision': 0.3784505306481328, 'recall': 0.3891804557356956, 'f1-score': 0.36894158528794047, 'support': 358980}}
[[66979 18419 35404]
 [57001 18794 41907]
 [47116 19425 53935]]
Evaluating performance on  val set...
480/480 - 12s - 12s/epoch - 26ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0915487
{'0': {'precision': 0.4049982820665835, 'recall': 0.5185579661487879, 'f1-score': 0.454796523434327, 'support': 43189}, '1': {'precision': 0.2944855313446171, 'recall': 0.16500264204466447, 'f1-score': 0.21150007129616427, 'support': 35957}, '2': {'precision': 0.42499629794165555, 'recall': 0.46108650249018845, 'f1-score': 0.442306422139539, 'support': 43571}, 'accuracy': 0.3945582111687867, 'macro avg': {'precision': 0.3748267037842854, 'recall': 0.38154903689454694, 'f1-score': 0.36953433895667676, 'support': 122717}, 'weighted avg': {'precision': 0.37971756767479603, 'recall': 0.3945582111687867, 'f1-score': 0.37907419699995265, 'support': 122717}}
[[22396  7047 13746]
 [16589  5933 13435]
 [16314  7167 20090]]
training model: results/EXC/W2/deepVOL_L3/h500
Epoch 1/50
1403/1403 - 99s - loss: 3.2935 - accuracy500: 0.3730 - val_loss: 3.3373 - val_accuracy500: 0.3116 - 99s/epoch - 70ms/step
Epoch 2/50
1403/1403 - 89s - loss: 3.2700 - accuracy500: 0.3820 - val_loss: 3.3132 - val_accuracy500: 0.3333 - 89s/epoch - 63ms/step
Epoch 3/50
1403/1403 - 91s - loss: 3.2511 - accuracy500: 0.3946 - val_loss: 3.3181 - val_accuracy500: 0.3467 - 91s/epoch - 65ms/step
Epoch 4/50
1403/1403 - 88s - loss: 3.2368 - accuracy500: 0.4030 - val_loss: 3.3305 - val_accuracy500: 0.3460 - 88s/epoch - 62ms/step
Epoch 5/50
1403/1403 - 87s - loss: 3.2256 - accuracy500: 0.4099 - val_loss: 3.3423 - val_accuracy500: 0.3535 - 87s/epoch - 62ms/step
Epoch 6/50
1403/1403 - 83s - loss: 3.2155 - accuracy500: 0.4160 - val_loss: 3.3483 - val_accuracy500: 0.3531 - 83s/epoch - 59ms/step
Epoch 7/50
1403/1403 - 85s - loss: 3.2035 - accuracy500: 0.4211 - val_loss: 3.3528 - val_accuracy500: 0.3583 - 85s/epoch - 61ms/step
Epoch 8/50
1403/1403 - 95s - loss: 3.1911 - accuracy500: 0.4269 - val_loss: 3.3460 - val_accuracy500: 0.3618 - 95s/epoch - 68ms/step
Epoch 9/50
1403/1403 - 84s - loss: 3.1820 - accuracy500: 0.4325 - val_loss: 3.3478 - val_accuracy500: 0.3630 - 84s/epoch - 60ms/step
Epoch 10/50
1403/1403 - 93s - loss: 3.1748 - accuracy500: 0.4355 - val_loss: 3.3522 - val_accuracy500: 0.3601 - 93s/epoch - 66ms/step
Epoch 11/50
1403/1403 - 90s - loss: 3.1640 - accuracy500: 0.4398 - val_loss: 3.3487 - val_accuracy500: 0.3706 - 90s/epoch - 64ms/step
Epoch 12/50
1403/1403 - 85s - loss: 3.1550 - accuracy500: 0.4435 - val_loss: 3.3666 - val_accuracy500: 0.3625 - 85s/epoch - 61ms/step
testing model: results/EXC/W2/deepVOL_L3/h500
Evaluating performance on  test set...
4918/4918 - 134s - 134s/epoch - 27ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1081725
{'0': {'precision': 0.3766745081934283, 'recall': 0.19805333496063954, 'f1-score': 0.2596068502022049, 'support': 426062}, '1': {'precision': 0.3118149891600737, 'recall': 0.6743045942287248, 'f1-score': 0.42643566415640066, 'support': 392253}, '2': {'precision': 0.36775386594484494, 'recall': 0.1557463384514805, 'f1-score': 0.21882061397983377, 'support': 440524}, 'accuracy': 0.33164765311529115, 'macro avg': {'precision': 0.352081121099449, 'recall': 0.3427014225469483, 'f1-score': 0.30162104277947976, 'support': 1258839}, 'weighted avg': {'precision': 0.3533426143409934, 'recall': 0.33164765311529115, 'f1-score': 0.2973176192793874, 'support': 1258839}}
[[ 84383 276736  64943]
 [ 74743 264498  53012]
 [ 64895 307019  68610]]
Evaluating performance on  train set...
1403/1403 - 40s - 40s/epoch - 29ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1023266
{'0': {'precision': 0.3882870481206608, 'recall': 0.21311192687674, 'f1-score': 0.27518703704685604, 'support': 121767}, '1': {'precision': 0.3292297784328053, 'recall': 0.676871498896622, 'f1-score': 0.4429897041791534, 'support': 117820}, '2': {'precision': 0.3716220276848495, 'recall': 0.15537761845334316, 'f1-score': 0.21913390663390667, 'support': 119393}, 'accuracy': 0.34611956097832747, 'macro avg': {'precision': 0.3630462847461052, 'recall': 0.3484536814089017, 'f1-score': 0.312436882619972, 'support': 358980}, 'weighted avg': {'precision': 0.3633613856895617, 'recall': 0.34611956097832747, 'f1-score': 0.31161847847014984, 'support': 358980}}
[[25950 79789 16028]
 [22731 79749 15340]
 [18151 82691 18551]]
Evaluating performance on  val set...
480/480 - 12s - 12s/epoch - 26ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1054875
{'0': {'precision': 0.3963530708345857, 'recall': 0.1880272820171582, 'f1-score': 0.2550571396334682, 'support': 42079}, '1': {'precision': 0.3101139198794897, 'recall': 0.6920087187163528, 'f1-score': 0.42829395941520176, 'support': 38079}, '2': {'precision': 0.3821627396952145, 'recall': 0.15968420310627598, 'f1-score': 0.22524941168671903, 'support': 42559}, 'accuracy': 0.3345828206360977, 'macro avg': {'precision': 0.36287657680309665, 'recall': 0.346573401279929, 'f1-score': 0.30286683691179633, 'support': 122717}, 'weighted avg': {'precision': 0.3646718291795616, 'recall': 0.3345828206360977, 'f1-score': 0.2984749038127012, 'support': 122717}}
[[ 7912 28217  5950]
 [ 6691 26351  5037]
 [ 5359 30404  6796]]
training model: results/EXC/W2/deepVOL_L3/h1000
Epoch 1/50
1403/1403 - 91s - loss: 3.2491 - accuracy1000: 0.4100 - val_loss: 3.2892 - val_accuracy1000: 0.3600 - 91s/epoch - 65ms/step
Epoch 2/50
1403/1403 - 89s - loss: 3.2497 - accuracy1000: 0.4088 - val_loss: 3.2893 - val_accuracy1000: 0.3622 - 89s/epoch - 63ms/step
Epoch 3/50
1403/1403 - 93s - loss: 3.2433 - accuracy1000: 0.4128 - val_loss: 3.2957 - val_accuracy1000: 0.3645 - 93s/epoch - 67ms/step
Epoch 4/50
1403/1403 - 93s - loss: 3.2189 - accuracy1000: 0.4278 - val_loss: 3.2971 - val_accuracy1000: 0.3686 - 93s/epoch - 67ms/step
Epoch 5/50
1403/1403 - 88s - loss: 3.2012 - accuracy1000: 0.4364 - val_loss: 3.2988 - val_accuracy1000: 0.3658 - 88s/epoch - 63ms/step
Epoch 6/50
1403/1403 - 85s - loss: 3.2046 - accuracy1000: 0.4336 - val_loss: 3.3128 - val_accuracy1000: 0.3616 - 85s/epoch - 61ms/step
Epoch 7/50
1403/1403 - 92s - loss: 3.1906 - accuracy1000: 0.4414 - val_loss: 3.2985 - val_accuracy1000: 0.3666 - 92s/epoch - 65ms/step
Epoch 8/50
1403/1403 - 88s - loss: 3.1839 - accuracy1000: 0.4414 - val_loss: 3.3052 - val_accuracy1000: 0.3642 - 88s/epoch - 63ms/step
Epoch 9/50
1403/1403 - 92s - loss: 3.1836 - accuracy1000: 0.4403 - val_loss: 3.3279 - val_accuracy1000: 0.3666 - 92s/epoch - 66ms/step
Epoch 10/50
1403/1403 - 95s - loss: 3.1700 - accuracy1000: 0.4421 - val_loss: 3.3213 - val_accuracy1000: 0.3661 - 95s/epoch - 67ms/step
Epoch 11/50
1403/1403 - 90s - loss: 3.1616 - accuracy1000: 0.4457 - val_loss: 3.3321 - val_accuracy1000: 0.3651 - 90s/epoch - 64ms/step
testing model: results/EXC/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
4918/4918 - 128s - 128s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046749
{'0': {'precision': 0.322910280565255, 'recall': 0.5559194477854904, 'f1-score': 0.40852533560278054, 'support': 414042}, '1': {'precision': 0.3297317095504075, 'recall': 0.00874683015458158, 'f1-score': 0.01704159597551424, 'support': 411692}, '2': {'precision': 0.33892286963168117, 'recall': 0.4187437226538599, 'f1-score': 0.3746286970209004, 'support': 433105}, 'accuracy': 0.3297760873312632, 'macro avg': {'precision': 0.3305216199157812, 'recall': 0.32780333353131064, 'f1-score': 0.2667318761997317, 'support': 1258839}, 'weighted avg': {'precision': 0.3306503173208448, 'recall': 0.3297760873312632, 'f1-score': 0.26883191381680654, 'support': 1258839}}
[[230174   3460 180408]
 [234752   3601 173339]
 [247885   3860 181360]]
Evaluating performance on  train set...
1403/1403 - 39s - 39s/epoch - 28ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1032679
{'0': {'precision': 0.3375059639546278, 'recall': 0.5469442389072255, 'f1-score': 0.4174275543936904, 'support': 120281}, '1': {'precision': 0.35095137420718814, 'recall': 0.009629169256266832, 'f1-score': 0.018744051747777973, 'support': 120675}, '2': {'precision': 0.33907731355911114, 'recall': 0.4618213244763777, 'f1-score': 0.3910435768298108, 'support': 118024}, 'accuracy': 0.3383336119003844, 'macro avg': {'precision': 0.3425115505736424, 'recall': 0.3394649108799566, 'f1-score': 0.27573839432375974, 'support': 358980}, 'weighted avg': {'precision': 0.34254240567268246, 'recall': 0.3383336119003844, 'f1-score': 0.27473137563778527, 'support': 358980}}
[[65787  1134 53360]
 [66631  1162 52882]
 [62503  1015 54506]]
Evaluating performance on  val set...
480/480 - 14s - 14s/epoch - 29ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963054
{'0': {'precision': 0.3557483731019523, 'recall': 0.5590260869565218, 'f1-score': 0.434801428416838, 'support': 43125}, '1': {'precision': 0.3188539741219963, 'recall': 0.009545680925239334, 'f1-score': 0.018536428110896196, 'support': 36142}, '2': {'precision': 0.36611717531744264, 'recall': 0.45390103567318757, 'f1-score': 0.40531042561499414, 'support': 43450}, 'accuracy': 0.3599745756496655, 'macro avg': {'precision': 0.3469065075137971, 'recall': 0.34082426785164954, 'f1-score': 0.28621609404757614, 'support': 122717}, 'weighted avg': {'precision': 0.3485536656720892, 'recall': 0.3599745756496655, 'f1-score': 0.30176335127351256, 'support': 122717}}
[[24108   343 18674]
 [20325   345 15472]
 [23334   394 19722]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        22 (peak)  18.47 (ave)

============================================
