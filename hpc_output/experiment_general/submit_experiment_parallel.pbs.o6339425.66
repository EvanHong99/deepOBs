This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-09-04.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-27.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-14.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-23.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-19.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-21.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-16.csv
data/AAL_orderbooks/AAL_orderbooks_2019-09-06.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-20.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-22.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-13.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-08-28.csv
training model: results/AAL/W6/deepLOB_L1/h10
Epoch 1/50
1766/1766 - 62s - loss: 2.8919 - accuracy10: 0.4392 - val_loss: 2.9792 - val_accuracy10: 0.3553 - 62s/epoch - 35ms/step
Epoch 2/50
1766/1766 - 51s - loss: 2.7792 - accuracy10: 0.4570 - val_loss: 2.7925 - val_accuracy10: 0.3873 - 51s/epoch - 29ms/step
Epoch 3/50
1766/1766 - 52s - loss: 2.6318 - accuracy10: 0.5338 - val_loss: 2.6980 - val_accuracy10: 0.5510 - 52s/epoch - 29ms/step
Epoch 4/50
1766/1766 - 51s - loss: 2.5445 - accuracy10: 0.5702 - val_loss: 2.7045 - val_accuracy10: 0.6186 - 51s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 49s - loss: 2.4966 - accuracy10: 0.5857 - val_loss: 2.7041 - val_accuracy10: 0.5742 - 49s/epoch - 28ms/step
Epoch 6/50
1766/1766 - 49s - loss: 2.4655 - accuracy10: 0.5939 - val_loss: 2.6624 - val_accuracy10: 0.6508 - 49s/epoch - 28ms/step
Epoch 7/50
1766/1766 - 51s - loss: 2.4399 - accuracy10: 0.6001 - val_loss: 2.6260 - val_accuracy10: 0.6273 - 51s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 50s - loss: 2.4196 - accuracy10: 0.6032 - val_loss: 2.6159 - val_accuracy10: 0.6720 - 50s/epoch - 28ms/step
Epoch 9/50
1766/1766 - 48s - loss: 2.4025 - accuracy10: 0.6073 - val_loss: 2.5592 - val_accuracy10: 0.6535 - 48s/epoch - 27ms/step
Epoch 10/50
1766/1766 - 48s - loss: 2.3897 - accuracy10: 0.6105 - val_loss: 2.5742 - val_accuracy10: 0.6634 - 48s/epoch - 27ms/step
Epoch 11/50
1766/1766 - 48s - loss: 2.3758 - accuracy10: 0.6134 - val_loss: 2.5801 - val_accuracy10: 0.6442 - 48s/epoch - 27ms/step
Epoch 12/50
1766/1766 - 51s - loss: 2.3646 - accuracy10: 0.6152 - val_loss: 2.5821 - val_accuracy10: 0.6677 - 51s/epoch - 29ms/step
Epoch 13/50
1766/1766 - 50s - loss: 2.3547 - accuracy10: 0.6156 - val_loss: 2.5741 - val_accuracy10: 0.6558 - 50s/epoch - 29ms/step
Epoch 14/50
1766/1766 - 51s - loss: 2.3465 - accuracy10: 0.6174 - val_loss: 2.5526 - val_accuracy10: 0.6663 - 51s/epoch - 29ms/step
Epoch 15/50
1766/1766 - 54s - loss: 2.3397 - accuracy10: 0.6194 - val_loss: 2.6323 - val_accuracy10: 0.6482 - 54s/epoch - 30ms/step
Epoch 16/50
1766/1766 - 53s - loss: 2.3311 - accuracy10: 0.6216 - val_loss: 2.5780 - val_accuracy10: 0.5934 - 53s/epoch - 30ms/step
Epoch 17/50
1766/1766 - 49s - loss: 2.3245 - accuracy10: 0.6224 - val_loss: 2.6976 - val_accuracy10: 0.5717 - 49s/epoch - 28ms/step
Epoch 18/50
1766/1766 - 48s - loss: 2.3163 - accuracy10: 0.6243 - val_loss: 2.6302 - val_accuracy10: 0.5906 - 48s/epoch - 27ms/step
Epoch 19/50
1766/1766 - 49s - loss: 2.3093 - accuracy10: 0.6250 - val_loss: 2.6091 - val_accuracy10: 0.6285 - 49s/epoch - 28ms/step
Epoch 20/50
1766/1766 - 49s - loss: 2.3038 - accuracy10: 0.6260 - val_loss: 2.6390 - val_accuracy10: 0.6270 - 49s/epoch - 28ms/step
Epoch 21/50
1766/1766 - 50s - loss: 2.2975 - accuracy10: 0.6268 - val_loss: 2.6432 - val_accuracy10: 0.6052 - 50s/epoch - 28ms/step
Epoch 22/50
1766/1766 - 51s - loss: 2.2909 - accuracy10: 0.6285 - val_loss: 2.6183 - val_accuracy10: 0.6189 - 51s/epoch - 29ms/step
Epoch 23/50
1766/1766 - 49s - loss: 2.2870 - accuracy10: 0.6286 - val_loss: 2.6900 - val_accuracy10: 0.5391 - 49s/epoch - 28ms/step
Epoch 24/50
1766/1766 - 50s - loss: 2.2821 - accuracy10: 0.6289 - val_loss: 2.8628 - val_accuracy10: 0.4750 - 50s/epoch - 29ms/step
testing model: results/AAL/W6/deepLOB_L1/h10
Evaluating performance on  test set...
6203/6203 - 104s - 104s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0244889
{'0': {'precision': 0.26898541699102185, 'recall': 0.6398800999496301, 'f1-score': 0.37875441922052183, 'support': 202502}, '1': {'precision': 0.8967153455194863, 'recall': 0.4387478282073948, 'f1-score': 0.589206678412504, 'support': 1181052}, '2': {'precision': 0.26734496857726964, 'recall': 0.691234338292874, 'f1-score': 0.3855664755664756, 'support': 204320}, 'accuracy': 0.4968870325983044, 'macro avg': {'precision': 0.4776819103625926, 'recall': 0.5899540888166329, 'f1-score': 0.4511758577331671, 'support': 1587874}, 'weighted avg': {'precision': 0.7356764208921514, 'recall': 0.4968870325983044, 'f1-score': 0.53616420171952, 'support': 1587874}}
[[129577  26832  46093]
 [321914 518184 340954]
 [ 30234  32853 141233]]
Evaluating performance on  train set...
1766/1766 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86523056
{'0': {'precision': 0.3484307201668174, 'recall': 0.386775593566505, 'f1-score': 0.36660321352519837, 'support': 58755}, '1': {'precision': 0.8395272724492059, 'recall': 0.6579558496118038, 'f1-score': 0.7377336968664587, 'support': 333723}, '2': {'precision': 0.2939931642496646, 'recall': 0.6186043385478803, 'f1-score': 0.39856661091172857, 'support': 59513}, 'accuracy': 0.6175233577659732, 'macro avg': {'precision': 0.49398371895522936, 'recall': 0.5544452605753963, 'f1-score': 0.5009678404344619, 'support': 451991}, 'weighted avg': {'precision': 0.7038591965126694, 'recall': 0.6175233577659732, 'f1-score': 0.6448322401225421, 'support': 451991}}
[[ 22725  23591  12439]
 [ 38178 219575  75970]
 [  4318  18380  36815]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7764752
{'0': {'precision': 0.3384573997924753, 'recall': 0.5094285053216103, 'f1-score': 0.4067053037474889, 'support': 17288}, '1': {'precision': 0.8717453466414891, 'recall': 0.7074776912770485, 'f1-score': 0.7810681207339947, 'support': 114193}, '2': {'precision': 0.30041530501089325, 'recall': 0.5319148936170213, 'f1-score': 0.3839711097091391, 'support': 16591}, 'accuracy': 0.6646833972661949, 'macro avg': {'precision': 0.5035393504816192, 'recall': 0.5829403634052267, 'f1-score': 0.5239148447302077, 'support': 148072}, 'weighted avg': {'precision': 0.745466112580904, 'recall': 0.6646833972661949, 'f1-score': 0.6928662939877085, 'support': 148072}}
[[ 8807  5882  2599]
 [15452 80789 17952]
 [ 1762  6004  8825]]
training model: results/AAL/W6/deepLOB_L1/h20
Epoch 1/50
1766/1766 - 52s - loss: 2.9440 - accuracy20: 0.4425 - val_loss: 2.9794 - val_accuracy20: 0.5616 - 52s/epoch - 29ms/step
Epoch 2/50
1766/1766 - 49s - loss: 2.9189 - accuracy20: 0.4214 - val_loss: 3.2499 - val_accuracy20: 0.5645 - 49s/epoch - 28ms/step
Epoch 3/50
1766/1766 - 49s - loss: 2.8447 - accuracy20: 0.4609 - val_loss: 3.3700 - val_accuracy20: 0.5580 - 49s/epoch - 28ms/step
Epoch 4/50
1766/1766 - 50s - loss: 2.7519 - accuracy20: 0.5211 - val_loss: 3.3776 - val_accuracy20: 0.5675 - 50s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 49s - loss: 2.6732 - accuracy20: 0.5466 - val_loss: 3.3352 - val_accuracy20: 0.6270 - 49s/epoch - 27ms/step
Epoch 6/50
1766/1766 - 53s - loss: 2.6219 - accuracy20: 0.5622 - val_loss: 3.2451 - val_accuracy20: 0.6306 - 53s/epoch - 30ms/step
Epoch 7/50
1766/1766 - 51s - loss: 2.5876 - accuracy20: 0.5742 - val_loss: 3.0236 - val_accuracy20: 0.6014 - 51s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 51s - loss: 2.5615 - accuracy20: 0.5804 - val_loss: 2.9929 - val_accuracy20: 0.5873 - 51s/epoch - 29ms/step
Epoch 9/50
1766/1766 - 50s - loss: 2.5360 - accuracy20: 0.5867 - val_loss: 2.9921 - val_accuracy20: 0.5926 - 50s/epoch - 28ms/step
Epoch 10/50
1766/1766 - 51s - loss: 2.5161 - accuracy20: 0.5920 - val_loss: 3.0457 - val_accuracy20: 0.5741 - 51s/epoch - 29ms/step
Epoch 11/50
1766/1766 - 50s - loss: 2.5020 - accuracy20: 0.5934 - val_loss: 3.0865 - val_accuracy20: 0.5631 - 50s/epoch - 29ms/step
testing model: results/AAL/W6/deepLOB_L1/h20
Evaluating performance on  test set...
6203/6203 - 112s - 112s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9192141
{'0': {'precision': 0.2932613092595333, 'recall': 0.22424368162957375, 'f1-score': 0.25415018917936766, 'support': 265100}, '1': {'precision': 0.6688746343421983, 'recall': 0.6636992194206696, 'f1-score': 0.6662768768119632, 'support': 1054217}, '2': {'precision': 0.24575056619798055, 'recall': 0.3103065643420205, 'f1-score': 0.27428121929826, 'support': 268557}, 'accuracy': 0.5305616188690034, 'macro avg': {'precision': 0.40262883659990406, 'recall': 0.3994164884640879, 'f1-score': 0.3982360950965303, 'support': 1587874}, 'weighted avg': {'precision': 0.5346020013448565, 'recall': 0.5305616188690034, 'f1-score': 0.5311729814863211, 'support': 1587874}}
[[ 59447 170694  34959]
 [133724 699683 220810]
 [  9539 175683  83335]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9446793
{'0': {'precision': 0.3150633359907875, 'recall': 0.18284987211947512, 'f1-score': 0.23140294234851136, 'support': 77807}, '1': {'precision': 0.6837455383135458, 'recall': 0.6389032504418289, 'f1-score': 0.6605642414184644, 'support': 295929}, '2': {'precision': 0.2760486210230674, 'recall': 0.45968947671075333, 'f1-score': 0.3449505918904536, 'support': 78255}, 'accuracy': 0.5293689476117888, 'macro avg': {'precision': 0.4249524984424669, 'recall': 0.4271475330906858, 'f1-score': 0.41230592521914305, 'support': 451991}, 'weighted avg': {'precision': 0.5496933594456187, 'recall': 0.5293689476117888, 'f1-score': 0.5320437634873766, 'support': 451991}}
[[ 14227  47341  16239]
 [ 28757 189070  78102]
 [  2172  40110  35973]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8976596
{'0': {'precision': 0.3402133986356481, 'recall': 0.1696615491974878, 'f1-score': 0.22641289796868636, 'support': 22928}, '1': {'precision': 0.7079766245442286, 'recall': 0.6879173784749185, 'f1-score': 0.6978028740357114, 'support': 103024}, '2': {'precision': 0.23285796403251854, 'recall': 0.3845840867992767, 'f1-score': 0.2900789388437079, 'support': 22120}, 'accuracy': 0.5623548003673888, 'macro avg': {'precision': 0.42701599573746507, 'recall': 0.4140543381572277, 'f1-score': 0.40476490361603523, 'support': 148072}, 'weighted avg': {'precision': 0.5800543974239698, 'recall': 0.5623548003673888, 'f1-score': 0.5639025902703008, 'support': 148072}}
[[ 3890 16057  2981]
 [ 7107 70872 25045]
 [  437 13176  8507]]
training model: results/AAL/W6/deepLOB_L1/h30
Epoch 1/50
1766/1766 - 52s - loss: 3.0030 - accuracy30: 0.4534 - val_loss: 3.2683 - val_accuracy30: 0.6091 - 52s/epoch - 29ms/step
Epoch 2/50
1766/1766 - 49s - loss: 2.9400 - accuracy30: 0.4513 - val_loss: 3.2848 - val_accuracy30: 0.5713 - 49s/epoch - 28ms/step
Epoch 3/50
1766/1766 - 49s - loss: 2.8562 - accuracy30: 0.4950 - val_loss: 3.1760 - val_accuracy30: 0.6022 - 49s/epoch - 28ms/step
Epoch 4/50
1766/1766 - 50s - loss: 2.7768 - accuracy30: 0.5281 - val_loss: 3.2122 - val_accuracy30: 0.4922 - 50s/epoch - 28ms/step
Epoch 5/50
1766/1766 - 52s - loss: 2.7204 - accuracy30: 0.5488 - val_loss: 3.2175 - val_accuracy30: 0.5710 - 52s/epoch - 29ms/step
Epoch 6/50
1766/1766 - 51s - loss: 2.6868 - accuracy30: 0.5580 - val_loss: 3.2677 - val_accuracy30: 0.5854 - 51s/epoch - 29ms/step
Epoch 7/50
1766/1766 - 52s - loss: 2.6610 - accuracy30: 0.5642 - val_loss: 3.3271 - val_accuracy30: 0.5681 - 52s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 52s - loss: 2.6384 - accuracy30: 0.5695 - val_loss: 3.3338 - val_accuracy30: 0.5370 - 52s/epoch - 30ms/step
Epoch 9/50
1766/1766 - 54s - loss: 2.6213 - accuracy30: 0.5733 - val_loss: 3.4943 - val_accuracy30: 0.4794 - 54s/epoch - 30ms/step
Epoch 10/50
1766/1766 - 52s - loss: 2.6056 - accuracy30: 0.5766 - val_loss: 3.3086 - val_accuracy30: 0.5179 - 52s/epoch - 29ms/step
Epoch 11/50
1766/1766 - 50s - loss: 2.5940 - accuracy30: 0.5787 - val_loss: 3.1797 - val_accuracy30: 0.5365 - 50s/epoch - 28ms/step
Epoch 12/50
1766/1766 - 51s - loss: 2.5817 - accuracy30: 0.5813 - val_loss: 3.2336 - val_accuracy30: 0.5029 - 51s/epoch - 29ms/step
Epoch 13/50
1766/1766 - 52s - loss: 2.5727 - accuracy30: 0.5829 - val_loss: 3.1714 - val_accuracy30: 0.4737 - 52s/epoch - 29ms/step
Epoch 14/50
1766/1766 - 52s - loss: 2.5643 - accuracy30: 0.5846 - val_loss: 3.2181 - val_accuracy30: 0.4839 - 52s/epoch - 30ms/step
Epoch 15/50
1766/1766 - 50s - loss: 2.5551 - accuracy30: 0.5860 - val_loss: 3.2391 - val_accuracy30: 0.4929 - 50s/epoch - 28ms/step
Epoch 16/50
1766/1766 - 50s - loss: 2.5485 - accuracy30: 0.5881 - val_loss: 3.3901 - val_accuracy30: 0.3771 - 50s/epoch - 28ms/step
Epoch 17/50
1766/1766 - 50s - loss: 2.5424 - accuracy30: 0.5892 - val_loss: 3.3334 - val_accuracy30: 0.4979 - 50s/epoch - 29ms/step
Epoch 18/50
1766/1766 - 47s - loss: 2.5359 - accuracy30: 0.5906 - val_loss: 3.3885 - val_accuracy30: 0.4737 - 47s/epoch - 27ms/step
Epoch 19/50
1766/1766 - 49s - loss: 2.5305 - accuracy30: 0.5915 - val_loss: 3.2819 - val_accuracy30: 0.4641 - 49s/epoch - 28ms/step
Epoch 20/50
1766/1766 - 50s - loss: 2.5253 - accuracy30: 0.5928 - val_loss: 3.3044 - val_accuracy30: 0.4650 - 50s/epoch - 28ms/step
Epoch 21/50
1766/1766 - 48s - loss: 2.5202 - accuracy30: 0.5931 - val_loss: 3.4089 - val_accuracy30: 0.4710 - 48s/epoch - 27ms/step
Epoch 22/50
1766/1766 - 46s - loss: 2.5142 - accuracy30: 0.5937 - val_loss: 3.5072 - val_accuracy30: 0.4012 - 46s/epoch - 26ms/step
Epoch 23/50
1766/1766 - 49s - loss: 2.5110 - accuracy30: 0.5945 - val_loss: 3.4340 - val_accuracy30: 0.4892 - 49s/epoch - 28ms/step
testing model: results/AAL/W6/deepLOB_L1/h30
Evaluating performance on  test set...
6203/6203 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.029304
{'0': {'precision': 0.266476963752001, 'recall': 0.6148124616949522, 'f1-score': 0.37180375331582993, 'support': 311643}, '1': {'precision': 0.6618413770161261, 'recall': 0.47475756887378157, 'f1-score': 0.5529025066730742, 'support': 959654}, '2': {'precision': 0.35811889088370236, 'recall': 0.20414938545756642, 'f1-score': 0.2600529127141406, 'support': 316577}, 'accuracy': 0.4482937563056011, 'macro avg': {'precision': 0.42881241055060976, 'recall': 0.43123980534210005, 'f1-score': 0.39491972423434824, 'support': 1587874}, 'weighted avg': {'precision': 0.5236918101517426, 'recall': 0.4482937563056011, 'f1-score': 0.4589733884311677, 'support': 1587874}}
[[191602 107264  12777]
 [400989 455603 103062]
 [126428 125520  64629]]
Evaluating performance on  train set...
1766/1766 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0160409
{'0': {'precision': 0.309437179798158, 'recall': 0.45768645357686455, 'f1-score': 0.3692369763229793, 'support': 91980}, '1': {'precision': 0.6557558789541428, 'recall': 0.5210186280693766, 'f1-score': 0.5806737422708073, 'support': 267929}, '2': {'precision': 0.33294199833116644, 'recall': 0.3726569796485741, 'f1-score': 0.351681800479636, 'support': 92082}, 'accuracy': 0.4779055335172603, 'macro avg': {'precision': 0.43271168569448903, 'recall': 0.45045402043160504, 'f1-score': 0.43386417302447416, 'support': 451991}, 'weighted avg': {'precision': 0.5195147995877564, 'recall': 0.4779055335172603, 'f1-score': 0.49099498823389975, 'support': 451991}}
[[ 42098  34283  15599]
 [ 75181 139596  53152]
 [ 18768  38999  34315]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0091985
{'0': {'precision': 0.2712817127228143, 'recall': 0.5294897282968853, 'f1-score': 0.3587562517929082, 'support': 27162}, '1': {'precision': 0.6771096788229855, 'recall': 0.5264571241291086, 'f1-score': 0.5923546800373523, 'support': 94587}, '2': {'precision': 0.27041598884499185, 'recall': 0.22102343957755574, 'f1-score': 0.24323759354488061, 'support': 26323}, 'accuracy': 0.47271597601167, 'macro avg': {'precision': 0.40626912679693056, 'recall': 0.4256567640011832, 'f1-score': 0.398116175125047, 'support': 148072}, 'weighted avg': {'precision': 0.5303668968216376, 'recall': 0.47271597601167, 'f1-score': 0.48744078966160986, 'support': 148072}}
[[14382 10489  2291]
 [31385 49796 13406]
 [ 7248 13257  5818]]
training model: results/AAL/W6/deepLOB_L1/h50
Epoch 1/50
1766/1766 - 52s - loss: 3.0627 - accuracy50: 0.4597 - val_loss: 3.4551 - val_accuracy50: 0.3644 - 52s/epoch - 29ms/step
Epoch 2/50
1766/1766 - 49s - loss: 3.0195 - accuracy50: 0.4617 - val_loss: 3.3237 - val_accuracy50: 0.4507 - 49s/epoch - 28ms/step
Epoch 3/50
1766/1766 - 47s - loss: 3.0062 - accuracy50: 0.4638 - val_loss: 3.2843 - val_accuracy50: 0.5168 - 47s/epoch - 27ms/step
Epoch 4/50
1766/1766 - 47s - loss: 2.9463 - accuracy50: 0.4909 - val_loss: 3.4613 - val_accuracy50: 0.5050 - 47s/epoch - 27ms/step
Epoch 5/50
1766/1766 - 50s - loss: 2.8989 - accuracy50: 0.5102 - val_loss: 3.4585 - val_accuracy50: 0.5192 - 50s/epoch - 28ms/step
Epoch 6/50
1766/1766 - 51s - loss: 2.8648 - accuracy50: 0.5216 - val_loss: 3.5551 - val_accuracy50: 0.5048 - 51s/epoch - 29ms/step
Epoch 7/50
1766/1766 - 50s - loss: 2.8394 - accuracy50: 0.5299 - val_loss: 3.4603 - val_accuracy50: 0.5319 - 50s/epoch - 28ms/step
Epoch 8/50
1766/1766 - 48s - loss: 2.8217 - accuracy50: 0.5353 - val_loss: 3.4894 - val_accuracy50: 0.5364 - 48s/epoch - 27ms/step
Epoch 9/50
1766/1766 - 49s - loss: 2.8067 - accuracy50: 0.5389 - val_loss: 3.4410 - val_accuracy50: 0.5250 - 49s/epoch - 28ms/step
Epoch 10/50
1766/1766 - 47s - loss: 2.7934 - accuracy50: 0.5418 - val_loss: 3.3724 - val_accuracy50: 0.5236 - 47s/epoch - 27ms/step
Epoch 11/50
1766/1766 - 48s - loss: 2.7814 - accuracy50: 0.5433 - val_loss: 3.3746 - val_accuracy50: 0.5306 - 48s/epoch - 27ms/step
Epoch 12/50
1766/1766 - 47s - loss: 2.7704 - accuracy50: 0.5459 - val_loss: 3.3574 - val_accuracy50: 0.5348 - 47s/epoch - 27ms/step
Epoch 13/50
1766/1766 - 49s - loss: 2.7587 - accuracy50: 0.5485 - val_loss: 3.3906 - val_accuracy50: 0.5395 - 49s/epoch - 28ms/step
testing model: results/AAL/W6/deepLOB_L1/h50
Evaluating performance on  test set...
6203/6203 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0613787
{'0': {'precision': 0.35148895861701496, 'recall': 0.18685039432031872, 'f1-score': 0.24399423953861513, 'support': 381289}, '1': {'precision': 0.5224280787576318, 'recall': 0.8860068735759123, 'f1-score': 0.6572896646187494, 'support': 816751}, '2': {'precision': 0.47619047619047616, 'recall': 2.565194416084795e-05, 'f1-score': 5.130112477716074e-05, 'support': 389834}, 'accuracy': 0.5006071010672132, 'macro avg': {'precision': 0.4500358378550409, 'recall': 0.3576276399467973, 'f1-score': 0.30044506842738056, 'support': 1587874}, 'weighted avg': {'precision': 0.47002959138491823, 'recall': 0.5006071010672132, 'f1-score': 0.39669036043737954, 'support': 1587874}}
[[ 71244 310044      1]
 [ 93094 723647     10]
 [ 38354 351470     10]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0283062
{'0': {'precision': 0.4246379300475127, 'recall': 0.19625550078047146, 'f1-score': 0.2684439083232811, 'support': 113393}, '1': {'precision': 0.5286813245315162, 'recall': 0.704642716181877, 'f1-score': 0.6041095968534532, 'support': 225493}, '2': {'precision': 0.393578352180937, 'recall': 0.3446355156712789, 'f1-score': 0.36748450352353346, 'support': 113105}, 'accuracy': 0.48701412196260546, 'macro avg': {'precision': 0.44896586891998863, 'recall': 0.41517791087787587, 'f1-score': 0.41334600290008927, 'support': 451991}, 'weighted avg': {'precision': 0.46877169288301684, 'recall': 0.48701412196260546, 'f1-score': 0.46068722649523286, 'support': 451991}}
[[ 22254  73161  17978]
 [ 24519 158892  42082]
 [  5634  68491  38980]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0193241
{'0': {'precision': 0.3858195211786372, 'recall': 0.16012581944321957, 'f1-score': 0.2263218032616599, 'support': 34017}, '1': {'precision': 0.5585157239205147, 'recall': 0.798595972658415, 'f1-score': 0.6573201143482756, 'support': 81195}, '2': {'precision': 0.34563476507812063, 'recall': 0.1878271454656117, 'f1-score': 0.24338979040558392, 'support': 32860}, 'accuracy': 0.5163771678642822, 'macro avg': {'precision': 0.4299900033924242, 'recall': 0.38218297918908206, 'f1-score': 0.37567723600517317, 'support': 148072}, 'weighted avg': {'precision': 0.4715993924315667, 'recall': 0.5163771678642822, 'f1-score': 0.4664466204197121, 'support': 148072}}
[[ 5447 26340  2230]
 [ 6898 64842  9455]
 [ 1773 24915  6172]]
training model: results/AAL/W6/deepLOB_L1/h100
Epoch 1/50
1766/1766 - 52s - loss: 3.1633 - accuracy100: 0.4390 - val_loss: 3.2981 - val_accuracy100: 0.3976 - 52s/epoch - 29ms/step
Epoch 2/50
1766/1766 - 50s - loss: 3.1578 - accuracy100: 0.4387 - val_loss: 3.2749 - val_accuracy100: 0.3954 - 50s/epoch - 28ms/step
Epoch 3/50
1766/1766 - 50s - loss: 3.1402 - accuracy100: 0.4464 - val_loss: 3.3001 - val_accuracy100: 0.3952 - 50s/epoch - 28ms/step
Epoch 4/50
1766/1766 - 47s - loss: 3.1015 - accuracy100: 0.4606 - val_loss: 3.3364 - val_accuracy100: 0.3764 - 47s/epoch - 27ms/step
Epoch 5/50
1766/1766 - 49s - loss: 3.0811 - accuracy100: 0.4681 - val_loss: 3.3347 - val_accuracy100: 0.3986 - 49s/epoch - 28ms/step
Epoch 6/50
1766/1766 - 45s - loss: 3.0613 - accuracy100: 0.4739 - val_loss: 3.3273 - val_accuracy100: 0.4026 - 45s/epoch - 25ms/step
Epoch 7/50
1766/1766 - 42s - loss: 3.0458 - accuracy100: 0.4773 - val_loss: 3.3786 - val_accuracy100: 0.3914 - 42s/epoch - 24ms/step
Epoch 8/50
1766/1766 - 44s - loss: 3.0329 - accuracy100: 0.4809 - val_loss: 3.4069 - val_accuracy100: 0.3821 - 44s/epoch - 25ms/step
Epoch 9/50
1766/1766 - 44s - loss: 3.0219 - accuracy100: 0.4839 - val_loss: 3.4552 - val_accuracy100: 0.3566 - 44s/epoch - 25ms/step
Epoch 10/50
1766/1766 - 44s - loss: 3.0121 - accuracy100: 0.4853 - val_loss: 3.3804 - val_accuracy100: 0.3771 - 44s/epoch - 25ms/step
Epoch 11/50
1766/1766 - 46s - loss: 3.0024 - accuracy100: 0.4882 - val_loss: 3.3675 - val_accuracy100: 0.3778 - 46s/epoch - 26ms/step
Epoch 12/50
1766/1766 - 44s - loss: 2.9942 - accuracy100: 0.4899 - val_loss: 3.3731 - val_accuracy100: 0.3782 - 44s/epoch - 25ms/step
testing model: results/AAL/W6/deepLOB_L1/h100
Evaluating performance on  test set...
6203/6203 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0989776
{'0': {'precision': 0.36144654808381804, 'recall': 0.6027278105894687, 'f1-score': 0.4518972831251182, 'support': 481705}, '1': {'precision': 0.3786143537009658, 'recall': 0.42235157426948183, 'f1-score': 0.3992888155225631, 'support': 609362}, '2': {'precision': 0.36048829335749366, 'recall': 0.07608387160406355, 'f1-score': 0.12564861998929633, 'support': 496807}, 'accuracy': 0.3687326576290058, 'macro avg': {'precision': 0.36684973171409246, 'recall': 0.3670544188210047, 'f1-score': 0.32561157287899256, 'support': 1587874}, 'weighted avg': {'precision': 0.3677350449737825, 'recall': 0.3687326576290058, 'f1-score': 0.32963303506655284, 'support': 1587874}}
[[290337 173613  17755]
 [302696 257365  49301]
 [210231 248777  37799]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1076158
{'0': {'precision': 0.41625380397230266, 'recall': 0.19513304525813055, 'f1-score': 0.2657069659631573, 'support': 145101}, '1': {'precision': 0.3680988546037141, 'recall': 0.6354379316667685, 'f1-score': 0.46615924402246406, 'support': 163610}, '2': {'precision': 0.4100260993745999, 'recall': 0.2905639307649358, 'f1-score': 0.34010987888814004, 'support': 143280}, 'accuracy': 0.38476429840417176, 'macro avg': {'precision': 0.39812625265020557, 'recall': 0.37371163589661166, 'f1-score': 0.3573253629579205, 'support': 451991}, 'weighted avg': {'precision': 0.3968486901958035, 'recall': 0.38476429840417176, 'f1-score': 0.3618514612676539, 'support': 451991}}
[[ 28314  90470  26317]
 [ 26060 103964  33586]
 [ 13647  88001  41632]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0901248
{'0': {'precision': 0.37169790147009313, 'recall': 0.3719734064058218, 'f1-score': 0.3718356029053515, 'support': 44522}, '1': {'precision': 0.41295076589194235, 'recall': 0.5405833966502593, 'f1-score': 0.46822512804372085, 'support': 60542}, '2': {'precision': 0.38292873923257637, 'recall': 0.21602957589285715, 'f1-score': 0.2762260112083959, 'support': 43008}, 'accuracy': 0.39561834783078503, 'macro avg': {'precision': 0.38919246886487063, 'recall': 0.3761954596496461, 'f1-score': 0.3720955807191561, 'support': 148072}, 'weighted avg': {'precision': 0.39182693861632245, 'recall': 0.39561834783078503, 'f1-score': 0.38347613799115093, 'support': 148072}}
[[16561 23139  4822]
 [17664 32728 10150]
 [10330 23387  9291]]
training model: results/AAL/W6/deepLOB_L1/h200
Epoch 1/50
1766/1766 - 45s - loss: 3.2535 - accuracy200: 0.3989 - val_loss: 3.3567 - val_accuracy200: 0.3496 - 45s/epoch - 26ms/step
Epoch 2/50
1766/1766 - 47s - loss: 3.2341 - accuracy200: 0.4092 - val_loss: 3.3278 - val_accuracy200: 0.3361 - 47s/epoch - 26ms/step
Epoch 3/50
1766/1766 - 46s - loss: 3.2169 - accuracy200: 0.4199 - val_loss: 3.3237 - val_accuracy200: 0.3430 - 46s/epoch - 26ms/step
Epoch 4/50
1766/1766 - 45s - loss: 3.2022 - accuracy200: 0.4279 - val_loss: 3.3130 - val_accuracy200: 0.3488 - 45s/epoch - 26ms/step
Epoch 5/50
1766/1766 - 41s - loss: 3.1924 - accuracy200: 0.4315 - val_loss: 3.3350 - val_accuracy200: 0.3400 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 41s - loss: 3.1857 - accuracy200: 0.4334 - val_loss: 3.3424 - val_accuracy200: 0.3341 - 41s/epoch - 23ms/step
Epoch 7/50
1766/1766 - 41s - loss: 3.1799 - accuracy200: 0.4349 - val_loss: 3.3395 - val_accuracy200: 0.3302 - 41s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 42s - loss: 3.1756 - accuracy200: 0.4372 - val_loss: 3.3396 - val_accuracy200: 0.3340 - 42s/epoch - 24ms/step
Epoch 9/50
1766/1766 - 41s - loss: 3.1720 - accuracy200: 0.4379 - val_loss: 3.3565 - val_accuracy200: 0.3311 - 41s/epoch - 23ms/step
Epoch 10/50
1766/1766 - 43s - loss: 3.1668 - accuracy200: 0.4397 - val_loss: 3.3693 - val_accuracy200: 0.3342 - 43s/epoch - 24ms/step
Epoch 11/50
1766/1766 - 45s - loss: 3.1629 - accuracy200: 0.4408 - val_loss: 3.3846 - val_accuracy200: 0.3367 - 45s/epoch - 25ms/step
Epoch 12/50
1766/1766 - 43s - loss: 3.1608 - accuracy200: 0.4416 - val_loss: 3.3795 - val_accuracy200: 0.3322 - 43s/epoch - 24ms/step
Epoch 13/50
1766/1766 - 40s - loss: 3.1560 - accuracy200: 0.4436 - val_loss: 3.3810 - val_accuracy200: 0.3317 - 40s/epoch - 23ms/step
Epoch 14/50
1766/1766 - 41s - loss: 3.1522 - accuracy200: 0.4450 - val_loss: 3.3856 - val_accuracy200: 0.3277 - 41s/epoch - 23ms/step
testing model: results/AAL/W6/deepLOB_L1/h200
Evaluating performance on  test set...
6203/6203 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011783
{'0': {'precision': 0.33801583993330553, 'recall': 0.5035879128804269, 'f1-score': 0.4045150482835639, 'support': 499176}, '1': {'precision': 0.37420770027856654, 'recall': 0.246191630529285, 'f1-score': 0.2969919511945043, 'support': 564743}, '2': {'precision': 0.30048937984381313, 'recall': 0.2710595375557061, 'f1-score': 0.2850167671087725, 'support': 523955}, 'accuracy': 0.3353143889250658, 'macro avg': {'precision': 0.33757097335189507, 'recall': 0.3402796936551393, 'f1-score': 0.3288412555289469, 'support': 1587874}, 'weighted avg': {'precision': 0.3385051252234317, 'recall': 0.3353143889250658, 'f1-score': 0.32684223650359606, 'support': 1587874}}
[[251379 110670 137127]
 [232219 139035 193489]
 [260092 121840 142023]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133198
{'0': {'precision': 0.3711819449634943, 'recall': 0.2578696403807063, 'f1-score': 0.3043202080515346, 'support': 157917}, '1': {'precision': 0.3056293660857915, 'recall': 0.48108988827446114, 'f1-score': 0.373793311320884, 'support': 141776}, '2': {'precision': 0.35096085229991686, 'recall': 0.2744881744999934, 'f1-score': 0.30804941583060375, 'support': 152298}, 'accuracy': 0.3334867287180497, 'macro avg': {'precision': 0.34259072111640093, 'recall': 0.3378159010517203, 'f1-score': 0.32872097840100745, 'support': 451991}, 'weighted avg': {'precision': 0.3438065892740166, 'recall': 0.3334867287180497, 'f1-score': 0.3273683872751296, 'support': 451991}}
[[40722 79226 37969]
 [34229 68207 39340]
 [34758 75736 41804]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1038994
{'0': {'precision': 0.36872064233982, 'recall': 0.3217436953580875, 'f1-score': 0.3436340895367894, 'support': 49527}, '1': {'precision': 0.35275917117888117, 'recall': 0.4224280646432795, 'f1-score': 0.38446291961507073, 'support': 50740}, '2': {'precision': 0.31927246337370163, 'recall': 0.29448802426524423, 'f1-score': 0.30637983003079466, 'support': 47805}, 'accuracy': 0.3474458371603004, 'macro avg': {'precision': 0.3469174256308009, 'recall': 0.3462199280888704, 'f1-score': 0.34482561306088494, 'support': 148072}, 'weighted avg': {'precision': 0.3472867774485419, 'recall': 0.3474458371603004, 'f1-score': 0.3455974246878505, 'support': 148072}}
[[15935 20168 13424]
 [12714 21434 16592]
 [14568 19159 14078]]
training model: results/AAL/W6/deepLOB_L1/h300
Epoch 1/50
1766/1766 - 45s - loss: 3.2758 - accuracy300: 0.3842 - val_loss: 3.3573 - val_accuracy300: 0.3449 - 45s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 41s - loss: 3.2528 - accuracy300: 0.3938 - val_loss: 3.3574 - val_accuracy300: 0.3408 - 41s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 43s - loss: 3.2402 - accuracy300: 0.4034 - val_loss: 3.3737 - val_accuracy300: 0.3514 - 43s/epoch - 24ms/step
Epoch 4/50
1766/1766 - 42s - loss: 3.2320 - accuracy300: 0.4086 - val_loss: 3.4084 - val_accuracy300: 0.3447 - 42s/epoch - 24ms/step
Epoch 5/50
1766/1766 - 42s - loss: 3.2283 - accuracy300: 0.4099 - val_loss: 3.4236 - val_accuracy300: 0.3384 - 42s/epoch - 24ms/step
Epoch 6/50
1766/1766 - 42s - loss: 3.2224 - accuracy300: 0.4140 - val_loss: 3.4413 - val_accuracy300: 0.3359 - 42s/epoch - 24ms/step
Epoch 7/50
1766/1766 - 43s - loss: 3.2176 - accuracy300: 0.4155 - val_loss: 3.4588 - val_accuracy300: 0.3357 - 43s/epoch - 25ms/step
Epoch 8/50
1766/1766 - 42s - loss: 3.2120 - accuracy300: 0.4179 - val_loss: 3.4560 - val_accuracy300: 0.3343 - 42s/epoch - 24ms/step
Epoch 9/50
1766/1766 - 43s - loss: 3.2074 - accuracy300: 0.4193 - val_loss: 3.4639 - val_accuracy300: 0.3327 - 43s/epoch - 24ms/step
Epoch 10/50
1766/1766 - 44s - loss: 3.2030 - accuracy300: 0.4217 - val_loss: 3.4265 - val_accuracy300: 0.3334 - 44s/epoch - 25ms/step
Epoch 11/50
1766/1766 - 44s - loss: 3.2010 - accuracy300: 0.4223 - val_loss: 3.4129 - val_accuracy300: 0.3364 - 44s/epoch - 25ms/step
testing model: results/AAL/W6/deepLOB_L1/h300
Evaluating performance on  test set...
6203/6203 - 82s - 82s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.106558
{'0': {'precision': 0.32958766006157475, 'recall': 0.6002208193850396, 'f1-score': 0.4255185444191565, 'support': 509919}, '1': {'precision': 0.35880251056425555, 'recall': 0.42981300340941236, 'f1-score': 0.391110704681393, 'support': 537336}, '2': {'precision': 0.37528104323247896, 'recall': 0.010806131490014224, 'f1-score': 0.021007360846910926, 'support': 540619}, 'accuracy': 0.34187851177108514, 'macro avg': {'precision': 0.3545570712861031, 'recall': 0.3469466514281554, 'f1-score': 0.27921220331582014, 'support': 1587874}, 'weighted avg': {'precision': 0.3550310529417275, 'recall': 0.34187851177108514, 'f1-score': 0.2761521573349327, 'support': 1587874}}
[[306064 199196   4659]
 [301316 230954   5066]
 [321247 213530   5842]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1167488
{'0': {'precision': 0.3507209127992445, 'recall': 0.23560380628494818, 'f1-score': 0.2818614986190547, 'support': 152905}, '1': {'precision': 0.3421407721539902, 'recall': 0.4885989001985935, 'f1-score': 0.4024596646844303, 'support': 152573}, '2': {'precision': 0.34821523708044755, 'recall': 0.3122726310975818, 'f1-score': 0.32926596690212057, 'support': 146513}, 'accuracy': 0.3458564440442398, 'macro avg': {'precision': 0.34702564067789404, 'recall': 0.3454917791937078, 'f1-score': 0.3378623767352018, 'support': 451991}, 'weighted avg': {'precision': 0.3470124056270741, 'recall': 0.3458564440442398, 'f1-score': 0.33793649757401045, 'support': 451991}}
[[36025 73134 43746]
 [36134 74547 41892]
 [30558 70203 45752]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1187518
{'0': {'precision': 0.3463163740854321, 'recall': 0.2927058247275399, 'f1-score': 0.31726228003229695, 'support': 48998}, '1': {'precision': 0.35916078955624975, 'recall': 0.505199938598511, 'f1-score': 0.41984325044050935, 'support': 52116}, '2': {'precision': 0.31311465579275605, 'recall': 0.22239022104859663, 'f1-score': 0.2600672394471424, 'support': 46958}, 'accuracy': 0.34519693122264844, 'macro avg': {'precision': 0.339530606478146, 'recall': 0.3400986614582158, 'f1-score': 0.33239092330664954, 'support': 148072}, 'weighted avg': {'precision': 0.3403079002962596, 'recall': 0.34519693122264844, 'f1-score': 0.3352288445279255, 'support': 148072}}
[[14342 23197 11459]
 [14337 26329 11450]
 [12734 23781 10443]]
training model: results/AAL/W6/deepLOB_L1/h500
Epoch 1/50
1766/1766 - 45s - loss: 3.2216 - accuracy500: 0.4090 - val_loss: 3.3475 - val_accuracy500: 0.3542 - 45s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 46s - loss: 3.1948 - accuracy500: 0.4231 - val_loss: 3.5710 - val_accuracy500: 0.2960 - 46s/epoch - 26ms/step
Epoch 3/50
1766/1766 - 44s - loss: 3.1866 - accuracy500: 0.4270 - val_loss: 3.4138 - val_accuracy500: 0.3152 - 44s/epoch - 25ms/step
Epoch 4/50
1766/1766 - 44s - loss: 3.1716 - accuracy500: 0.4347 - val_loss: 3.3689 - val_accuracy500: 0.3687 - 44s/epoch - 25ms/step
Epoch 5/50
1766/1766 - 41s - loss: 3.1699 - accuracy500: 0.4335 - val_loss: 3.4192 - val_accuracy500: 0.3672 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 43s - loss: 3.1645 - accuracy500: 0.4374 - val_loss: 3.4342 - val_accuracy500: 0.3750 - 43s/epoch - 24ms/step
Epoch 7/50
1766/1766 - 44s - loss: 3.1570 - accuracy500: 0.4412 - val_loss: 3.5310 - val_accuracy500: 0.3653 - 44s/epoch - 25ms/step
Epoch 8/50
1766/1766 - 44s - loss: 3.1542 - accuracy500: 0.4422 - val_loss: 3.5049 - val_accuracy500: 0.3556 - 44s/epoch - 25ms/step
Epoch 9/50
1766/1766 - 45s - loss: 3.1510 - accuracy500: 0.4430 - val_loss: 3.4553 - val_accuracy500: 0.3689 - 45s/epoch - 25ms/step
Epoch 10/50
1766/1766 - 42s - loss: 3.1476 - accuracy500: 0.4442 - val_loss: 3.4490 - val_accuracy500: 0.3553 - 42s/epoch - 24ms/step
Epoch 11/50
1766/1766 - 43s - loss: 3.1429 - accuracy500: 0.4466 - val_loss: 3.4415 - val_accuracy500: 0.3700 - 43s/epoch - 24ms/step
testing model: results/AAL/W6/deepLOB_L1/h500
Evaluating performance on  test set...
6203/6203 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.069377
{'0': {'precision': 0.20965071799121604, 'recall': 0.3208449415776124, 'f1-score': 0.2535944306133157, 'support': 336686}, '1': {'precision': 0.557165481956532, 'recall': 0.629370764060882, 'f1-score': 0.5910711388115246, 'support': 882626}, '2': {'precision': 0.22830917363241984, 'recall': 0.04683608185325671, 'f1-score': 0.07772699642028953, 'support': 368562}, 'accuracy': 0.42873993780362923, 'macro avg': {'precision': 0.331708457860056, 'recall': 0.3323505958305837, 'f1-score': 0.3074641886150433, 'support': 1587874}, 'weighted avg': {'precision': 0.4071489853522814, 'recall': 0.42873993780362923, 'f1-score': 0.40036153163587934, 'support': 1587874}}
[[108024 212132  16530]
 [285311 555499  41816]
 [121922 229378  17262]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1319965
{'0': {'precision': 0.34328599880179406, 'recall': 0.2714301260426202, 'f1-score': 0.3031583462920264, 'support': 156217}, '1': {'precision': 0.3585956709258737, 'recall': 0.30202130621057705, 'f1-score': 0.3278860116612488, 'support': 147281}, '2': {'precision': 0.33674447727317197, 'recall': 0.46359087633760515, 'f1-score': 0.39011563494379764, 'support': 148493}, 'accuracy': 0.34452898398419435, 'macro avg': {'precision': 0.3462087156669466, 'recall': 0.34568076953026744, 'f1-score': 0.3403866642990243, 'support': 451991}, 'weighted avg': {'precision': 0.3461255545977212, 'recall': 0.34452898398419435, 'f1-score': 0.3397839958005607, 'support': 451991}}
[[42402 41055 72760]
 [39971 44482 62828]
 [41145 38508 68840]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1131277
{'0': {'precision': 0.3169309036686183, 'recall': 0.32838025128939174, 'f1-score': 0.32255400821281915, 'support': 44013}, '1': {'precision': 0.44698466962234923, 'recall': 0.4109750507497872, 'f1-score': 0.4282241763115474, 'support': 61084}, '2': {'precision': 0.2792294735023539, 'recall': 0.3008726003490401, 'f1-score': 0.2896472933770903, 'support': 42975}, 'accuracy': 0.3544694472959101, 'macro avg': {'precision': 0.3477150155977738, 'recall': 0.34674263412940637, 'f1-score': 0.346808492633819, 'support': 148072}, 'weighted avg': {'precision': 0.35963975664637565, 'recall': 0.3544694472959101, 'f1-score': 0.3565954912621281, 'support': 148072}}
[[14453 15804 13756]
 [16360 25104 19620]
 [14790 15255 12930]]
training model: results/AAL/W6/deepLOB_L1/h1000
Epoch 1/50
1766/1766 - 45s - loss: 3.2075 - accuracy1000: 0.4273 - val_loss: 3.3881 - val_accuracy1000: 0.3108 - 45s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 43s - loss: 3.1773 - accuracy1000: 0.4463 - val_loss: 3.4169 - val_accuracy1000: 0.2917 - 43s/epoch - 24ms/step
Epoch 3/50
1766/1766 - 45s - loss: 3.1519 - accuracy1000: 0.4535 - val_loss: 3.4485 - val_accuracy1000: 0.3393 - 45s/epoch - 26ms/step
Epoch 4/50
1766/1766 - 45s - loss: 3.1290 - accuracy1000: 0.4607 - val_loss: 3.3398 - val_accuracy1000: 0.3971 - 45s/epoch - 25ms/step
Epoch 5/50
1766/1766 - 41s - loss: 3.1184 - accuracy1000: 0.4615 - val_loss: 3.3822 - val_accuracy1000: 0.4015 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 44s - loss: 3.1094 - accuracy1000: 0.4636 - val_loss: 3.3499 - val_accuracy1000: 0.4026 - 44s/epoch - 25ms/step
Epoch 7/50
1766/1766 - 45s - loss: 3.0991 - accuracy1000: 0.4682 - val_loss: 3.4384 - val_accuracy1000: 0.4005 - 45s/epoch - 26ms/step
Epoch 8/50
1766/1766 - 43s - loss: 3.0928 - accuracy1000: 0.4699 - val_loss: 3.4578 - val_accuracy1000: 0.3987 - 43s/epoch - 25ms/step
Epoch 9/50
1766/1766 - 43s - loss: 3.0774 - accuracy1000: 0.4750 - val_loss: 3.3682 - val_accuracy1000: 0.3975 - 43s/epoch - 24ms/step
Epoch 10/50
1766/1766 - 41s - loss: 3.0691 - accuracy1000: 0.4781 - val_loss: 3.4365 - val_accuracy1000: 0.4014 - 41s/epoch - 23ms/step
Epoch 11/50
1766/1766 - 42s - loss: 3.0613 - accuracy1000: 0.4810 - val_loss: 3.3581 - val_accuracy1000: 0.3866 - 42s/epoch - 24ms/step
Epoch 12/50
1766/1766 - 41s - loss: 3.0613 - accuracy1000: 0.4816 - val_loss: 3.3912 - val_accuracy1000: 0.3858 - 41s/epoch - 23ms/step
Epoch 13/50
1766/1766 - 43s - loss: 3.0490 - accuracy1000: 0.4864 - val_loss: 3.5262 - val_accuracy1000: 0.3734 - 43s/epoch - 24ms/step
Epoch 14/50
1766/1766 - 42s - loss: 3.0442 - accuracy1000: 0.4876 - val_loss: 3.5135 - val_accuracy1000: 0.3769 - 42s/epoch - 24ms/step
testing model: results/AAL/W6/deepLOB_L1/h1000
Evaluating performance on  test set...
6203/6203 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1435812
{'0': {'precision': 0.2703382561751753, 'recall': 0.08908391326033774, 'f1-score': 0.13400837128039858, 'support': 421030}, '1': {'precision': 0.4359892965041001, 'recall': 0.9131546557556771, 'f1-score': 0.5901900316797365, 'support': 691413}, '2': {'precision': 0.29365079365079366, 'recall': 0.0006225929735334886, 'f1-score': 0.0012425515123656963, 'support': 475431}, 'accuracy': 0.42142512567118046, 'macro avg': {'precision': 0.3333261154433564, 'recall': 0.33428705399651615, 'f1-score': 0.2418136514908336, 'support': 1587874}, 'weighted avg': {'precision': 0.3494483025337111, 'recall': 0.42142512567118046, 'f1-score': 0.29289310892554665, 'support': 1587874}}
[[ 37507 383271    252]
 [ 59586 631367    460]
 [ 41648 433487    296]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182365
{'0': {'precision': 0.34719716443408427, 'recall': 0.14033570603457735, 'f1-score': 0.1998805092145779, 'support': 154957}, '1': {'precision': 0.379596503201631, 'recall': 0.5809846972721224, 'f1-score': 0.45917983693494485, 'support': 150300}, '2': {'precision': 0.3683741424437763, 'recall': 0.3999686507557894, 'f1-score': 0.38352180831424626, 'support': 146734}, 'accuracy': 0.37115119548840575, 'macro avg': {'precision': 0.36505593669316383, 'recall': 0.37376301802082973, 'f1-score': 0.34752738482125634, 'support': 451991}, 'weighted avg': {'precision': 0.3648457532511989, 'recall': 0.37115119548840575, 'f1-score': 0.34572215504040604, 'support': 451991}}
[[21746 72954 60257]
 [22605 87322 40373]
 [18282 69763 58689]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108102
{'0': {'precision': 0.3173059106911247, 'recall': 0.07672834804426722, 'f1-score': 0.12357483042286045, 'support': 44638}, '1': {'precision': 0.4266567851849206, 'recall': 0.7924212271973466, 'f1-score': 0.5546681834538637, 'support': 60300}, '2': {'precision': 0.31118493909191586, 'recall': 0.18240830899058746, 'f1-score': 0.22999795375485982, 'support': 43134}, 'accuracy': 0.3989680695877681, 'macro avg': {'precision': 0.3517158783226537, 'recall': 0.3505192947440671, 'f1-score': 0.30274698921052795, 'support': 148072}, 'weighted avg': {'precision': 0.3600542746155373, 'recall': 0.3989680695877681, 'f1-score': 0.33013234426458576, 'support': 148072}}
[[ 3425 32077  9136]
 [ 4237 47783  8280]
 [ 3132 32134  7868]]
training model: results/AAL/W6/deepOF_L1/h10
Epoch 1/50
1766/1766 - 44s - loss: 3.0724 - accuracy10: 0.4105 - val_loss: 2.8668 - val_accuracy10: 0.5925 - 44s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 41s - loss: 3.0065 - accuracy10: 0.4237 - val_loss: 2.8374 - val_accuracy10: 0.5766 - 41s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 39s - loss: 2.9734 - accuracy10: 0.4363 - val_loss: 2.8379 - val_accuracy10: 0.5798 - 39s/epoch - 22ms/step
Epoch 4/50
1766/1766 - 40s - loss: 2.9494 - accuracy10: 0.4494 - val_loss: 2.8373 - val_accuracy10: 0.5820 - 40s/epoch - 23ms/step
Epoch 5/50
1766/1766 - 38s - loss: 2.9303 - accuracy10: 0.4604 - val_loss: 2.8099 - val_accuracy10: 0.6017 - 38s/epoch - 22ms/step
Epoch 6/50
1766/1766 - 39s - loss: 2.9147 - accuracy10: 0.4674 - val_loss: 2.8001 - val_accuracy10: 0.5897 - 39s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 39s - loss: 2.9017 - accuracy10: 0.4738 - val_loss: 2.7907 - val_accuracy10: 0.5968 - 39s/epoch - 22ms/step
Epoch 8/50
1766/1766 - 39s - loss: 2.8892 - accuracy10: 0.4802 - val_loss: 2.7957 - val_accuracy10: 0.6161 - 39s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 39s - loss: 2.8787 - accuracy10: 0.4842 - val_loss: 2.7671 - val_accuracy10: 0.6060 - 39s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 38s - loss: 2.8681 - accuracy10: 0.4888 - val_loss: 2.7652 - val_accuracy10: 0.6385 - 38s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 39s - loss: 2.8608 - accuracy10: 0.4899 - val_loss: 2.7486 - val_accuracy10: 0.5839 - 39s/epoch - 22ms/step
Epoch 12/50
1766/1766 - 39s - loss: 2.8504 - accuracy10: 0.4936 - val_loss: 2.7958 - val_accuracy10: 0.6159 - 39s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 39s - loss: 2.8410 - accuracy10: 0.4952 - val_loss: 2.7800 - val_accuracy10: 0.6214 - 39s/epoch - 22ms/step
Epoch 14/50
1766/1766 - 40s - loss: 2.8325 - accuracy10: 0.4982 - val_loss: 2.7441 - val_accuracy10: 0.6152 - 40s/epoch - 22ms/step
Epoch 15/50
1766/1766 - 41s - loss: 2.8219 - accuracy10: 0.4992 - val_loss: 2.7804 - val_accuracy10: 0.6382 - 41s/epoch - 23ms/step
Epoch 16/50
1766/1766 - 40s - loss: 2.8114 - accuracy10: 0.5032 - val_loss: 2.7509 - val_accuracy10: 0.6468 - 40s/epoch - 23ms/step
Epoch 17/50
1766/1766 - 42s - loss: 2.8049 - accuracy10: 0.5042 - val_loss: 2.7612 - val_accuracy10: 0.6535 - 42s/epoch - 24ms/step
Epoch 18/50
1766/1766 - 43s - loss: 2.7940 - accuracy10: 0.5071 - val_loss: 2.7698 - val_accuracy10: 0.6502 - 43s/epoch - 24ms/step
Epoch 19/50
1766/1766 - 41s - loss: 2.7843 - accuracy10: 0.5100 - val_loss: 2.8244 - val_accuracy10: 0.6518 - 41s/epoch - 23ms/step
Epoch 20/50
1766/1766 - 41s - loss: 2.7754 - accuracy10: 0.5106 - val_loss: 2.7495 - val_accuracy10: 0.6484 - 41s/epoch - 23ms/step
Epoch 21/50
1766/1766 - 41s - loss: 2.7645 - accuracy10: 0.5149 - val_loss: 2.7859 - val_accuracy10: 0.6600 - 41s/epoch - 23ms/step
Epoch 22/50
1766/1766 - 41s - loss: 2.7543 - accuracy10: 0.5163 - val_loss: 2.7836 - val_accuracy10: 0.6392 - 41s/epoch - 23ms/step
Epoch 23/50
1766/1766 - 39s - loss: 2.7465 - accuracy10: 0.5196 - val_loss: 2.7665 - val_accuracy10: 0.6363 - 39s/epoch - 22ms/step
Epoch 24/50
1766/1766 - 38s - loss: 2.7383 - accuracy10: 0.5199 - val_loss: 2.7409 - val_accuracy10: 0.6179 - 38s/epoch - 22ms/step
Epoch 25/50
1766/1766 - 39s - loss: 2.7285 - accuracy10: 0.5230 - val_loss: 2.7367 - val_accuracy10: 0.6475 - 39s/epoch - 22ms/step
Epoch 26/50
1766/1766 - 39s - loss: 2.7201 - accuracy10: 0.5227 - val_loss: 2.7475 - val_accuracy10: 0.6072 - 39s/epoch - 22ms/step
Epoch 27/50
1766/1766 - 39s - loss: 2.7127 - accuracy10: 0.5254 - val_loss: 2.7113 - val_accuracy10: 0.6216 - 39s/epoch - 22ms/step
Epoch 28/50
1766/1766 - 40s - loss: 2.7036 - accuracy10: 0.5292 - val_loss: 2.7603 - val_accuracy10: 0.6279 - 40s/epoch - 23ms/step
Epoch 29/50
1766/1766 - 40s - loss: 2.6960 - accuracy10: 0.5314 - val_loss: 2.7222 - val_accuracy10: 0.6329 - 40s/epoch - 23ms/step
Epoch 30/50
1766/1766 - 41s - loss: 2.6972 - accuracy10: 0.5301 - val_loss: 2.7189 - val_accuracy10: 0.6346 - 41s/epoch - 23ms/step
Epoch 31/50
1766/1766 - 39s - loss: 2.6814 - accuracy10: 0.5341 - val_loss: 2.7553 - val_accuracy10: 0.6293 - 39s/epoch - 22ms/step
Epoch 32/50
1766/1766 - 40s - loss: 2.6751 - accuracy10: 0.5355 - val_loss: 2.6950 - val_accuracy10: 0.6259 - 40s/epoch - 23ms/step
Epoch 33/50
1766/1766 - 41s - loss: 2.6681 - accuracy10: 0.5363 - val_loss: 2.7037 - val_accuracy10: 0.6079 - 41s/epoch - 23ms/step
Epoch 34/50
1766/1766 - 41s - loss: 2.6606 - accuracy10: 0.5382 - val_loss: 2.7136 - val_accuracy10: 0.6217 - 41s/epoch - 23ms/step
Epoch 35/50
1766/1766 - 41s - loss: 2.6534 - accuracy10: 0.5394 - val_loss: 2.6996 - val_accuracy10: 0.6082 - 41s/epoch - 23ms/step
Epoch 36/50
1766/1766 - 41s - loss: 2.6464 - accuracy10: 0.5412 - val_loss: 2.6979 - val_accuracy10: 0.6224 - 41s/epoch - 23ms/step
Epoch 37/50
1766/1766 - 41s - loss: 2.6396 - accuracy10: 0.5415 - val_loss: 2.7176 - val_accuracy10: 0.6227 - 41s/epoch - 23ms/step
Epoch 38/50
1766/1766 - 40s - loss: 2.6339 - accuracy10: 0.5439 - val_loss: 2.7363 - val_accuracy10: 0.6259 - 40s/epoch - 23ms/step
Epoch 39/50
1766/1766 - 39s - loss: 2.6295 - accuracy10: 0.5444 - val_loss: 2.6960 - val_accuracy10: 0.6157 - 39s/epoch - 22ms/step
Epoch 40/50
1766/1766 - 41s - loss: 2.6177 - accuracy10: 0.5474 - val_loss: 2.7203 - val_accuracy10: 0.6097 - 41s/epoch - 23ms/step
Epoch 41/50
1766/1766 - 41s - loss: 2.6132 - accuracy10: 0.5483 - val_loss: 2.7231 - val_accuracy10: 0.6051 - 41s/epoch - 23ms/step
Epoch 42/50
1766/1766 - 37s - loss: 2.6097 - accuracy10: 0.5482 - val_loss: 2.7422 - val_accuracy10: 0.6162 - 37s/epoch - 21ms/step
testing model: results/AAL/W6/deepOF_L1/h10
Evaluating performance on  test set...
6203/6203 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8150452
{'0': {'precision': 0.2950486848701685, 'recall': 0.4679256091418187, 'f1-score': 0.36190167002453955, 'support': 202498}, '1': {'precision': 0.8201151241491225, 'recall': 0.7163240907258952, 'f1-score': 0.7647139111122762, 'support': 1181052}, '2': {'precision': 0.31993280598792206, 'recall': 0.3681938537287281, 'f1-score': 0.3423709606584459, 'support': 204319}, 'accuracy': 0.639850642590793, 'macro avg': {'precision': 0.4783655383357377, 'recall': 0.5174811845321473, 'f1-score': 0.48966218059842054, 'support': 1587869}, 'weighted avg': {'precision': 0.6887934251390101, 'recall': 0.639850642590793, 'f1-score': 0.6589990426378866, 'support': 1587869}}
[[ 94754  85932  21812]
 [196937 846016 138099]
 [ 29456  99634  75229]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8605332
{'0': {'precision': 0.26714642960733126, 'recall': 0.5806242758808696, 'f1-score': 0.3659284314515046, 'support': 58692}, '1': {'precision': 0.8268157730673317, 'recall': 0.635674891929217, 'f1-score': 0.7187547103983578, 'support': 333809}, '2': {'precision': 0.3397604225061222, 'recall': 0.38715371167294244, 'f1-score': 0.36191209516476264, 'support': 59488}, 'accuracy': 0.5958175973309084, 'macro avg': {'precision': 0.47790754172692834, 'recall': 0.5344842931610096, 'f1-score': 0.48219841233820837, 'support': 451989}, 'weighted avg': {'precision': 0.6900379713939733, 'recall': 0.5958175973309084, 'f1-score': 0.6259738386095204, 'support': 451989}}
[[ 34078  18695   5919]
 [ 82779 212194  38836]
 [ 10706  25751  23031]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8246935
{'0': {'precision': 0.2517964627582001, 'recall': 0.5494734405740076, 'f1-score': 0.3453404854986817, 'support': 17282}, '1': {'precision': 0.8494018608772708, 'recall': 0.6714944964491808, 'f1-score': 0.7500427916803193, 'support': 114199}, '2': {'precision': 0.3188405797101449, 'recall': 0.38587185823639325, 'f1-score': 0.3491682574311426, 'support': 16591}, 'accuracy': 0.6252498784375169, 'macro avg': {'precision': 0.4733463011152053, 'recall': 0.5356132650865272, 'f1-score': 0.4815171782033812, 'support': 148072}, 'weighted avg': {'precision': 0.7202055326981581, 'recall': 0.6252498784375169, 'f1-score': 0.6578918471860249, 'support': 148072}}
[[ 9496  6167  1619]
 [25457 76684 12058]
 [ 2760  7429  6402]]
training model: results/AAL/W6/deepOF_L1/h20
Epoch 1/50
1766/1766 - 45s - loss: 3.1067 - accuracy20: 0.4121 - val_loss: 2.9292 - val_accuracy20: 0.5232 - 45s/epoch - 26ms/step
Epoch 2/50
1766/1766 - 44s - loss: 3.0484 - accuracy20: 0.4239 - val_loss: 2.9110 - val_accuracy20: 0.5097 - 44s/epoch - 25ms/step
Epoch 3/50
1766/1766 - 44s - loss: 3.0202 - accuracy20: 0.4320 - val_loss: 2.9009 - val_accuracy20: 0.5463 - 44s/epoch - 25ms/step
Epoch 4/50
1766/1766 - 44s - loss: 2.9976 - accuracy20: 0.4433 - val_loss: 2.8762 - val_accuracy20: 0.5407 - 44s/epoch - 25ms/step
Epoch 5/50
1766/1766 - 42s - loss: 2.9796 - accuracy20: 0.4522 - val_loss: 2.8311 - val_accuracy20: 0.5571 - 42s/epoch - 24ms/step
Epoch 6/50
1766/1766 - 38s - loss: 2.9663 - accuracy20: 0.4586 - val_loss: 2.8132 - val_accuracy20: 0.5864 - 38s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 38s - loss: 2.9528 - accuracy20: 0.4654 - val_loss: 2.8013 - val_accuracy20: 0.5590 - 38s/epoch - 21ms/step
Epoch 8/50
1766/1766 - 39s - loss: 2.9411 - accuracy20: 0.4724 - val_loss: 2.7877 - val_accuracy20: 0.5942 - 39s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 39s - loss: 2.9323 - accuracy20: 0.4770 - val_loss: 2.7871 - val_accuracy20: 0.5855 - 39s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 39s - loss: 2.9226 - accuracy20: 0.4800 - val_loss: 2.7787 - val_accuracy20: 0.5893 - 39s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 40s - loss: 2.9138 - accuracy20: 0.4835 - val_loss: 2.7752 - val_accuracy20: 0.6020 - 40s/epoch - 23ms/step
Epoch 12/50
1766/1766 - 39s - loss: 2.9054 - accuracy20: 0.4862 - val_loss: 2.7657 - val_accuracy20: 0.6069 - 39s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 39s - loss: 2.8975 - accuracy20: 0.4890 - val_loss: 2.7739 - val_accuracy20: 0.6036 - 39s/epoch - 22ms/step
Epoch 14/50
1766/1766 - 39s - loss: 2.8892 - accuracy20: 0.4903 - val_loss: 2.7637 - val_accuracy20: 0.6000 - 39s/epoch - 22ms/step
Epoch 15/50
1766/1766 - 38s - loss: 2.8806 - accuracy20: 0.4933 - val_loss: 2.7750 - val_accuracy20: 0.6048 - 38s/epoch - 21ms/step
Epoch 16/50
1766/1766 - 39s - loss: 2.8723 - accuracy20: 0.4947 - val_loss: 2.7764 - val_accuracy20: 0.6079 - 39s/epoch - 22ms/step
Epoch 17/50
1766/1766 - 41s - loss: 2.8615 - accuracy20: 0.4992 - val_loss: 2.7808 - val_accuracy20: 0.5996 - 41s/epoch - 23ms/step
Epoch 18/50
1766/1766 - 41s - loss: 2.8560 - accuracy20: 0.4990 - val_loss: 2.7896 - val_accuracy20: 0.6200 - 41s/epoch - 23ms/step
Epoch 19/50
1766/1766 - 39s - loss: 2.8448 - accuracy20: 0.5033 - val_loss: 2.8182 - val_accuracy20: 0.6021 - 39s/epoch - 22ms/step
Epoch 20/50
1766/1766 - 39s - loss: 2.8368 - accuracy20: 0.5040 - val_loss: 2.7887 - val_accuracy20: 0.6196 - 39s/epoch - 22ms/step
Epoch 21/50
1766/1766 - 39s - loss: 2.8278 - accuracy20: 0.5070 - val_loss: 2.7814 - val_accuracy20: 0.6307 - 39s/epoch - 22ms/step
Epoch 22/50
1766/1766 - 39s - loss: 2.8185 - accuracy20: 0.5101 - val_loss: 2.8015 - val_accuracy20: 0.6278 - 39s/epoch - 22ms/step
Epoch 23/50
1766/1766 - 39s - loss: 2.8137 - accuracy20: 0.5096 - val_loss: 2.7855 - val_accuracy20: 0.6052 - 39s/epoch - 22ms/step
Epoch 24/50
1766/1766 - 40s - loss: 2.8047 - accuracy20: 0.5139 - val_loss: 2.8277 - val_accuracy20: 0.6300 - 40s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h20
Evaluating performance on  test set...
6203/6203 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9298425
{'0': {'precision': 0.3420772786897773, 'recall': 0.40529091348039953, 'f1-score': 0.3710107393211092, 'support': 265096}, '1': {'precision': 0.7295357699088458, 'recall': 0.7002600033958852, 'f1-score': 0.7145981688461852, 'support': 1054217}, '2': {'precision': 0.3512465966327189, 'recall': 0.34250584608051954, 'f1-score': 0.34682115796836144, 'support': 268556}, 'accuracy': 0.5905077811834604, 'macro avg': {'precision': 0.4742865484104473, 'recall': 0.48268558765226804, 'f1-score': 0.47747668871188526, 'support': 1587869}, 'weighted avg': {'precision': 0.6008692845712307, 'recall': 0.5905077811834604, 'f1-score': 0.595033912505968, 'support': 1587869}}
[[107441 130372  27283]
 [173383 738226 142608]
 [ 33260 143314  91982]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9308656
{'0': {'precision': 0.34155379504216715, 'recall': 0.4811448114481145, 'f1-score': 0.3995067817509248, 'support': 77777}, '1': {'precision': 0.7257954772863718, 'recall': 0.6741241158360397, 'f1-score': 0.6990061955089568, 'support': 295901}, '2': {'precision': 0.38591507619470333, 'recall': 0.33308219790323196, 'f1-score': 0.3575575218812756, 'support': 78311}, 'accuracy': 0.581828318830768, 'macro avg': {'precision': 0.4844214495077474, 'recall': 0.49611704172912874, 'f1-score': 0.4853568330470524, 'support': 451989}, 'weighted avg': {'precision': 0.6007890293201666, 'recall': 0.5818283188307679, 'f1-score': 0.5883102427660454, 'support': 451989}}
[[ 37422  33854   6501]
 [ 61422 199474  35005]
 [ 10720  41507  26084]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9129478
{'0': {'precision': 0.31115341351561826, 'recall': 0.4715859415981815, 'f1-score': 0.37492831946061483, 'support': 22876}, '1': {'precision': 0.7617438030854567, 'recall': 0.6823029373805203, 'f1-score': 0.7198382431982799, 'support': 103051}, '2': {'precision': 0.3642698013935631, 'recall': 0.3470309324904042, 'f1-score': 0.35544146894223216, 'support': 22145}, 'accuracy': 0.5996069479712572, 'macro avg': {'precision': 0.47905567266487936, 'recall': 0.5003066038230354, 'f1-score': 0.48340267720037566, 'support': 148072}, 'weighted avg': {'precision': 0.6326865368955856, 'recall': 0.5996069479712572, 'f1-score': 0.6120546920790743, 'support': 148072}}
[[10788 10307  1781]
 [21108 70312 11631]
 [ 2775 11685  7685]]
training model: results/AAL/W6/deepOF_L1/h30
Epoch 1/50
1766/1766 - 45s - loss: 3.1364 - accuracy30: 0.4119 - val_loss: 3.0059 - val_accuracy30: 0.4771 - 45s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 42s - loss: 3.0872 - accuracy30: 0.4199 - val_loss: 3.0004 - val_accuracy30: 0.4789 - 42s/epoch - 24ms/step
Epoch 3/50
1766/1766 - 40s - loss: 3.0633 - accuracy30: 0.4301 - val_loss: 3.0094 - val_accuracy30: 0.4390 - 40s/epoch - 23ms/step
Epoch 4/50
1766/1766 - 38s - loss: 3.0421 - accuracy30: 0.4390 - val_loss: 2.9894 - val_accuracy30: 0.4678 - 38s/epoch - 22ms/step
Epoch 5/50
1766/1766 - 41s - loss: 3.0256 - accuracy30: 0.4462 - val_loss: 2.9503 - val_accuracy30: 0.4872 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 41s - loss: 3.0112 - accuracy30: 0.4513 - val_loss: 2.9223 - val_accuracy30: 0.5070 - 41s/epoch - 23ms/step
Epoch 7/50
1766/1766 - 40s - loss: 2.9987 - accuracy30: 0.4568 - val_loss: 2.8934 - val_accuracy30: 0.5240 - 40s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 40s - loss: 2.9877 - accuracy30: 0.4621 - val_loss: 2.8832 - val_accuracy30: 0.5478 - 40s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 38s - loss: 2.9779 - accuracy30: 0.4665 - val_loss: 2.8905 - val_accuracy30: 0.5362 - 38s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 38s - loss: 2.9687 - accuracy30: 0.4720 - val_loss: 2.9061 - val_accuracy30: 0.5503 - 38s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 39s - loss: 2.9612 - accuracy30: 0.4739 - val_loss: 2.8835 - val_accuracy30: 0.5489 - 39s/epoch - 22ms/step
Epoch 12/50
1766/1766 - 40s - loss: 2.9528 - accuracy30: 0.4776 - val_loss: 2.9006 - val_accuracy30: 0.5537 - 40s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 41s - loss: 2.9451 - accuracy30: 0.4798 - val_loss: 2.9129 - val_accuracy30: 0.5523 - 41s/epoch - 23ms/step
Epoch 14/50
1766/1766 - 40s - loss: 2.9384 - accuracy30: 0.4822 - val_loss: 2.9353 - val_accuracy30: 0.5497 - 40s/epoch - 23ms/step
Epoch 15/50
1766/1766 - 39s - loss: 2.9298 - accuracy30: 0.4843 - val_loss: 2.9130 - val_accuracy30: 0.5658 - 39s/epoch - 22ms/step
Epoch 16/50
1766/1766 - 39s - loss: 2.9204 - accuracy30: 0.4871 - val_loss: 2.8963 - val_accuracy30: 0.5712 - 39s/epoch - 22ms/step
Epoch 17/50
1766/1766 - 41s - loss: 2.9149 - accuracy30: 0.4896 - val_loss: 2.9273 - val_accuracy30: 0.5842 - 41s/epoch - 23ms/step
Epoch 18/50
1766/1766 - 41s - loss: 2.9061 - accuracy30: 0.4910 - val_loss: 2.9244 - val_accuracy30: 0.5720 - 41s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h30
Evaluating performance on  test set...
6203/6203 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97540116
{'0': {'precision': 0.3487350513542843, 'recall': 0.4083538966560668, 'f1-score': 0.3761970571498252, 'support': 311639}, '1': {'precision': 0.65699823260518, 'recall': 0.6836922474141722, 'f1-score': 0.6700794924574848, 'support': 959654}, '2': {'precision': 0.40275424862242987, 'recall': 0.2853690740927929, 'f1-score': 0.334049444982658, 'support': 316576}, 'accuracy': 0.5502393459410064, 'macro avg': {'precision': 0.4694958441939647, 'recall': 0.45913840605434403, 'f1-score': 0.46010866486332275, 'support': 1587869}, 'weighted avg': {'precision': 0.5458087245190778, 'recall': 0.5502393459410064, 'f1-score': 0.5454065650521166, 'support': 1587869}}
[[127259 157095  27285]
 [196864 656108 106682]
 [ 40793 185442  90341]]
Evaluating performance on  train set...
1766/1766 - 24s - 24s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97682375
{'0': {'precision': 0.35146344262922297, 'recall': 0.49972800069631823, 'f1-score': 0.41268301010346053, 'support': 91912}, '1': {'precision': 0.6489377634998016, 'recall': 0.6468572836151782, 'f1-score': 0.6478958533872883, 'support': 267937}, '2': {'precision': 0.43261535056983735, 'recall': 0.2546016930757543, 'f1-score': 0.3205525873495211, 'support': 92140}, 'accuracy': 0.5369754573673253, 'macro avg': {'precision': 0.4776721855662873, 'recall': 0.46706232579575024, 'f1-score': 0.46037715028008996, 'support': 451989}, 'weighted avg': {'precision': 0.5443480347514835, 'recall': 0.5369754573673253, 'f1-score': 0.5333348986193115, 'support': 451989}}
[[ 45931  40158   5823]
 [ 69676 173317  24944]
 [ 15078  53603  23459]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96543837
{'0': {'precision': 0.3215319633619667, 'recall': 0.49906080807336745, 'f1-score': 0.39109289538625835, 'support': 27151}, '1': {'precision': 0.6912971708927507, 'recall': 0.6373157199471599, 'f1-score': 0.6632098140887821, 'support': 94625}, '2': {'precision': 0.3879319567775757, 'recall': 0.27578338910860967, 'f1-score': 0.32238275172260505, 'support': 26296}, 'accuracy': 0.547760548922146, 'macro avg': {'precision': 0.466920363677431, 'recall': 0.470719972376379, 'f1-score': 0.45889515373254847, 'support': 148072}, 'weighted avg': {'precision': 0.5696213184693286, 'recall': 0.547760548922146, 'f1-score': 0.5527862708687727, 'support': 148072}}
[[13550 11860  1741]
 [24618 60306  9701]
 [ 3974 15070  7252]]
training model: results/AAL/W6/deepOF_L1/h50
Epoch 1/50
1766/1766 - 41s - loss: 3.1838 - accuracy50: 0.4131 - val_loss: 3.0861 - val_accuracy50: 0.4428 - 41s/epoch - 23ms/step
Epoch 2/50
1766/1766 - 38s - loss: 3.1430 - accuracy50: 0.4200 - val_loss: 3.0658 - val_accuracy50: 0.4273 - 38s/epoch - 22ms/step
Epoch 3/50
1766/1766 - 40s - loss: 3.1205 - accuracy50: 0.4297 - val_loss: 3.0532 - val_accuracy50: 0.4503 - 40s/epoch - 22ms/step
Epoch 4/50
1766/1766 - 38s - loss: 3.1034 - accuracy50: 0.4376 - val_loss: 3.0285 - val_accuracy50: 0.4625 - 38s/epoch - 22ms/step
Epoch 5/50
1766/1766 - 38s - loss: 3.0908 - accuracy50: 0.4444 - val_loss: 3.0091 - val_accuracy50: 0.4803 - 38s/epoch - 22ms/step
Epoch 6/50
1766/1766 - 39s - loss: 3.0796 - accuracy50: 0.4481 - val_loss: 3.0082 - val_accuracy50: 0.4913 - 39s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 39s - loss: 3.0710 - accuracy50: 0.4515 - val_loss: 3.0053 - val_accuracy50: 0.4871 - 39s/epoch - 22ms/step
Epoch 8/50
1766/1766 - 41s - loss: 3.0638 - accuracy50: 0.4536 - val_loss: 2.9898 - val_accuracy50: 0.4994 - 41s/epoch - 23ms/step
Epoch 9/50
1766/1766 - 42s - loss: 3.0558 - accuracy50: 0.4565 - val_loss: 3.0081 - val_accuracy50: 0.4711 - 42s/epoch - 24ms/step
Epoch 10/50
1766/1766 - 44s - loss: 3.0480 - accuracy50: 0.4605 - val_loss: 2.9928 - val_accuracy50: 0.5099 - 44s/epoch - 25ms/step
Epoch 11/50
1766/1766 - 41s - loss: 3.0419 - accuracy50: 0.4633 - val_loss: 2.9866 - val_accuracy50: 0.5250 - 41s/epoch - 23ms/step
Epoch 12/50
1766/1766 - 40s - loss: 3.0359 - accuracy50: 0.4650 - val_loss: 2.9998 - val_accuracy50: 0.5004 - 40s/epoch - 23ms/step
Epoch 13/50
1766/1766 - 38s - loss: 3.0301 - accuracy50: 0.4680 - val_loss: 2.9962 - val_accuracy50: 0.5236 - 38s/epoch - 21ms/step
Epoch 14/50
1766/1766 - 39s - loss: 3.0245 - accuracy50: 0.4699 - val_loss: 2.9994 - val_accuracy50: 0.5304 - 39s/epoch - 22ms/step
Epoch 15/50
1766/1766 - 40s - loss: 3.0183 - accuracy50: 0.4708 - val_loss: 3.0064 - val_accuracy50: 0.5282 - 40s/epoch - 23ms/step
Epoch 16/50
1766/1766 - 41s - loss: 3.0127 - accuracy50: 0.4725 - val_loss: 3.0211 - val_accuracy50: 0.5426 - 41s/epoch - 23ms/step
Epoch 17/50
1766/1766 - 40s - loss: 3.0078 - accuracy50: 0.4740 - val_loss: 3.0223 - val_accuracy50: 0.5370 - 40s/epoch - 23ms/step
Epoch 18/50
1766/1766 - 40s - loss: 3.0006 - accuracy50: 0.4759 - val_loss: 3.0304 - val_accuracy50: 0.5328 - 40s/epoch - 23ms/step
Epoch 19/50
1766/1766 - 41s - loss: 2.9941 - accuracy50: 0.4782 - val_loss: 3.0153 - val_accuracy50: 0.5372 - 41s/epoch - 23ms/step
Epoch 20/50
1766/1766 - 40s - loss: 2.9885 - accuracy50: 0.4801 - val_loss: 3.0201 - val_accuracy50: 0.5287 - 40s/epoch - 23ms/step
Epoch 21/50
1766/1766 - 40s - loss: 2.9813 - accuracy50: 0.4820 - val_loss: 3.0301 - val_accuracy50: 0.5360 - 40s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h50
Evaluating performance on  test set...
6203/6203 - 87s - 87s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0080669
{'0': {'precision': 0.4209606923595457, 'recall': 0.3046374637411287, 'f1-score': 0.3534749821975254, 'support': 381286}, '1': {'precision': 0.5630138030514478, 'recall': 0.7053627180899908, 'f1-score': 0.6262004063039062, 'support': 816750}, '2': {'precision': 0.4123024271626064, 'recall': 0.305330744190461, 'f1-score': 0.35084389056245613, 'support': 389833}, 'accuracy': 0.5109281685076036, 'macro avg': {'precision': 0.4654256408578666, 'recall': 0.43844364200719355, 'f1-score': 0.4435064263546293, 'support': 1587869}, 'weighted avg': {'precision': 0.49190269113973006, 'recall': 0.5109281685076036, 'f1-score': 0.49311043310280317, 'support': 1587869}}
[[116154 219128  46004]
 [116986 576105 123659]
 [ 42786 228019 119028]]
Evaluating performance on  train set...
1766/1766 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0066245
{'0': {'precision': 0.42842557583781177, 'recall': 0.3368827800372295, 'f1-score': 0.37717920605288363, 'support': 113351}, '1': {'precision': 0.5455887170468456, 'recall': 0.7015199347332577, 'f1-score': 0.6138059592924577, 'support': 225536}, '2': {'precision': 0.4398391501859654, 'recall': 0.2833548478364662, 'f1-score': 0.3446670072325438, 'support': 113102}, 'accuracy': 0.5054370792209545, 'macro avg': {'precision': 0.471284481023541, 'recall': 0.44058585420231783, 'f1-score': 0.44521739085929507, 'support': 451989}, 'weighted avg': {'precision': 0.4897443342625644, 'recall': 0.5054370792209545, 'f1-score': 0.4871169627409059, 'support': 451989}}
[[ 38186  64191  10974]
 [ 37477 158218  29841]
 [ 13468  67586  32048]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98923117
{'0': {'precision': 0.395034858017344, 'recall': 0.34155664676997266, 'f1-score': 0.366354432775097, 'support': 34009}, '1': {'precision': 0.5942108773675796, 'recall': 0.6912030936341581, 'f1-score': 0.639047662423428, 'support': 81199}, '2': {'precision': 0.4084826959610143, 'recall': 0.3009676241480039, 'f1-score': 0.34657836644591616, 'support': 32864}, 'accuracy': 0.5242854827381274, 'macro avg': {'precision': 0.46590947711531266, 'recall': 0.4445757881840449, 'f1-score': 0.45066015388148034, 'support': 148072}, 'weighted avg': {'precision': 0.5072427254156404, 'recall': 0.5242854827381274, 'f1-score': 0.5115033934859176, 'support': 148072}}
[[11616 19236  3157]
 [13908 56125 11166]
 [ 3881 19092  9891]]
training model: results/AAL/W6/deepOF_L1/h100
Epoch 1/50
1766/1766 - 41s - loss: 3.2424 - accuracy100: 0.4077 - val_loss: 3.2156 - val_accuracy100: 0.4069 - 41s/epoch - 23ms/step
Epoch 2/50
1766/1766 - 40s - loss: 3.2195 - accuracy100: 0.4161 - val_loss: 3.1975 - val_accuracy100: 0.4091 - 40s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 41s - loss: 3.2077 - accuracy100: 0.4210 - val_loss: 3.1935 - val_accuracy100: 0.4146 - 41s/epoch - 23ms/step
Epoch 4/50
1766/1766 - 42s - loss: 3.2008 - accuracy100: 0.4241 - val_loss: 3.1856 - val_accuracy100: 0.4200 - 42s/epoch - 24ms/step
Epoch 5/50
1766/1766 - 43s - loss: 3.1942 - accuracy100: 0.4263 - val_loss: 3.1829 - val_accuracy100: 0.4248 - 43s/epoch - 24ms/step
Epoch 6/50
1766/1766 - 42s - loss: 3.1895 - accuracy100: 0.4285 - val_loss: 3.1853 - val_accuracy100: 0.4258 - 42s/epoch - 24ms/step
Epoch 7/50
1766/1766 - 40s - loss: 3.1847 - accuracy100: 0.4304 - val_loss: 3.1801 - val_accuracy100: 0.4297 - 40s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 41s - loss: 3.1796 - accuracy100: 0.4331 - val_loss: 3.1829 - val_accuracy100: 0.4285 - 41s/epoch - 23ms/step
Epoch 9/50
1766/1766 - 38s - loss: 3.1749 - accuracy100: 0.4350 - val_loss: 3.1855 - val_accuracy100: 0.4268 - 38s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 39s - loss: 3.1706 - accuracy100: 0.4357 - val_loss: 3.1861 - val_accuracy100: 0.4285 - 39s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 38s - loss: 3.1662 - accuracy100: 0.4377 - val_loss: 3.1874 - val_accuracy100: 0.4296 - 38s/epoch - 21ms/step
Epoch 12/50
1766/1766 - 39s - loss: 3.1626 - accuracy100: 0.4390 - val_loss: 3.1936 - val_accuracy100: 0.4327 - 39s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 38s - loss: 3.1585 - accuracy100: 0.4405 - val_loss: 3.1988 - val_accuracy100: 0.4333 - 38s/epoch - 22ms/step
Epoch 14/50
1766/1766 - 39s - loss: 3.1545 - accuracy100: 0.4413 - val_loss: 3.2018 - val_accuracy100: 0.4326 - 39s/epoch - 22ms/step
Epoch 15/50
1766/1766 - 38s - loss: 3.1508 - accuracy100: 0.4435 - val_loss: 3.2042 - val_accuracy100: 0.4317 - 38s/epoch - 22ms/step
Epoch 16/50
1766/1766 - 39s - loss: 3.1459 - accuracy100: 0.4450 - val_loss: 3.2059 - val_accuracy100: 0.4343 - 39s/epoch - 22ms/step
Epoch 17/50
1766/1766 - 40s - loss: 3.1421 - accuracy100: 0.4462 - val_loss: 3.2113 - val_accuracy100: 0.4360 - 40s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h100
Evaluating performance on  test set...
6203/6203 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0718359
{'0': {'precision': 0.41798404354986635, 'recall': 0.351952767380595, 'f1-score': 0.3821369202247254, 'support': 481701}, '1': {'precision': 0.4130036034672581, 'recall': 0.6359208483627138, 'f1-score': 0.5007750585574671, 'support': 609362}, '2': {'precision': 0.44863976524782584, 'recall': 0.2203455674850948, 'f1-score': 0.2955394650165765, 'support': 496806}, 'accuracy': 0.41975188129499347, 'macro avg': {'precision': 0.4265424707549834, 'recall': 0.40273972774280115, 'f1-score': 0.392817147932923, 'support': 1587869}, 'weighted avg': {'precision': 0.42566418312325566, 'recall': 0.41975188129499347, 'f1-score': 0.40057133636269177, 'support': 1587869}}
[[169536 258562  53603]
 [140926 387506  80930]
 [ 95142 292195 109469]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0761746
{'0': {'precision': 0.43845677373683745, 'recall': 0.4099869681236167, 'f1-score': 0.42374421413834756, 'support': 145029}, '1': {'precision': 0.39046102054879633, 'recall': 0.6335547178111653, 'f1-score': 0.4831535540386273, 'support': 163667}, '2': {'precision': 0.4631597591215019, 'recall': 0.16424389188585625, 'f1-score': 0.2424951186716605, 'support': 143293}, 'accuracy': 0.4130343880050178, 'macro avg': {'precision': 0.4306925178023786, 'recall': 0.4025951926068794, 'f1-score': 0.38313096228287846, 'support': 451989}, 'weighted avg': {'precision': 0.4289088509946858, 'recall': 0.4130343880050178, 'f1-score': 0.3877955998949723, 'support': 451989}}
[[ 59460  74007  11562]
 [ 44258 103692  15717]
 [ 31894  87864  23535]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0609382
{'0': {'precision': 0.4150519191544595, 'recall': 0.40251303722352094, 'f1-score': 0.408686324630272, 'support': 44488}, '1': {'precision': 0.433639394116615, 'recall': 0.611640875045369, 'f1-score': 0.5074841385540931, 'support': 60614}, '2': {'precision': 0.4406936654145011, 'recall': 0.19930183849197114, 'f1-score': 0.2744739836225823, 'support': 42970}, 'accuracy': 0.4291493327570371, 'macro avg': {'precision': 0.42979499289519185, 'recall': 0.4044852502536204, 'f1-score': 0.3968814822689825, 'support': 148072}, 'weighted avg': {'precision': 0.4301019424144282, 'recall': 0.4291493327570371, 'f1-score': 0.41018172146477194, 'support': 148072}}
[[17907 22998  3583]
 [16254 37074  7286]
 [ 8983 25423  8564]]
training model: results/AAL/W6/deepOF_L1/h200
Epoch 1/50
1766/1766 - 43s - loss: 3.2771 - accuracy200: 0.3861 - val_loss: 3.2758 - val_accuracy200: 0.3744 - 43s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 41s - loss: 3.2591 - accuracy200: 0.3966 - val_loss: 3.2689 - val_accuracy200: 0.3834 - 41s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 40s - loss: 3.2528 - accuracy200: 0.3997 - val_loss: 3.2628 - val_accuracy200: 0.3839 - 40s/epoch - 22ms/step
Epoch 4/50
1766/1766 - 40s - loss: 3.2478 - accuracy200: 0.4020 - val_loss: 3.2589 - val_accuracy200: 0.3866 - 40s/epoch - 23ms/step
Epoch 5/50
1766/1766 - 43s - loss: 3.2446 - accuracy200: 0.4034 - val_loss: 3.2608 - val_accuracy200: 0.3845 - 43s/epoch - 24ms/step
Epoch 6/50
1766/1766 - 42s - loss: 3.2419 - accuracy200: 0.4051 - val_loss: 3.2543 - val_accuracy200: 0.3874 - 42s/epoch - 24ms/step
Epoch 7/50
1766/1766 - 40s - loss: 3.2398 - accuracy200: 0.4054 - val_loss: 3.2539 - val_accuracy200: 0.3878 - 40s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 41s - loss: 3.2376 - accuracy200: 0.4066 - val_loss: 3.2554 - val_accuracy200: 0.3882 - 41s/epoch - 23ms/step
Epoch 9/50
1766/1766 - 40s - loss: 3.2353 - accuracy200: 0.4077 - val_loss: 3.2568 - val_accuracy200: 0.3883 - 40s/epoch - 23ms/step
Epoch 10/50
1766/1766 - 41s - loss: 3.2336 - accuracy200: 0.4084 - val_loss: 3.2577 - val_accuracy200: 0.3870 - 41s/epoch - 23ms/step
Epoch 11/50
1766/1766 - 42s - loss: 3.2311 - accuracy200: 0.4095 - val_loss: 3.2597 - val_accuracy200: 0.3858 - 42s/epoch - 24ms/step
Epoch 12/50
1766/1766 - 42s - loss: 3.2295 - accuracy200: 0.4102 - val_loss: 3.2568 - val_accuracy200: 0.3865 - 42s/epoch - 24ms/step
Epoch 13/50
1766/1766 - 41s - loss: 3.2274 - accuracy200: 0.4107 - val_loss: 3.2579 - val_accuracy200: 0.3887 - 41s/epoch - 23ms/step
Epoch 14/50
1766/1766 - 42s - loss: 3.2258 - accuracy200: 0.4131 - val_loss: 3.2620 - val_accuracy200: 0.3855 - 42s/epoch - 24ms/step
Epoch 15/50
1766/1766 - 40s - loss: 3.2237 - accuracy200: 0.4138 - val_loss: 3.2656 - val_accuracy200: 0.3854 - 40s/epoch - 23ms/step
Epoch 16/50
1766/1766 - 41s - loss: 3.2220 - accuracy200: 0.4144 - val_loss: 3.2584 - val_accuracy200: 0.3857 - 41s/epoch - 23ms/step
Epoch 17/50
1766/1766 - 41s - loss: 3.2204 - accuracy200: 0.4151 - val_loss: 3.2639 - val_accuracy200: 0.3862 - 41s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h200
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945345
{'0': {'precision': 0.36917918023989144, 'recall': 0.4327285985592141, 'f1-score': 0.39843581395777805, 'support': 499172}, '1': {'precision': 0.36214359629856846, 'recall': 0.4505058052955061, 'f1-score': 0.4015207349271906, 'support': 564743}, '2': {'precision': 0.4084141597164859, 'recall': 0.23402626948167204, 'f1-score': 0.29755176622752627, 'support': 523954}, 'accuracy': 0.37348484037411145, 'macro avg': {'precision': 0.37991231208498194, 'recall': 0.37242022444546413, 'f1-score': 0.3658361050374983, 'support': 1587869}, 'weighted avg': {'precision': 0.3796233841729017, 'recall': 0.37348484037411145, 'f1-score': 0.3662439814946294, 'support': 1587869}}
[[216006 210448  72718]
 [205428 254420 104895]
 [163664 237671 122619]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0922955
{'0': {'precision': 0.4164063874047075, 'recall': 0.4348624666696223, 'f1-score': 0.42543435695342896, 'support': 157889}, '1': {'precision': 0.32967781359181636, 'recall': 0.4984167953681568, 'f1-score': 0.3968555224886293, 'support': 141801}, '2': {'precision': 0.43555683896428915, 'recall': 0.2079790412281105, 'f1-score': 0.28152802837055935, 'support': 152299}, 'accuracy': 0.3783521280385142, 'macro avg': {'precision': 0.39388034665360433, 'recall': 0.3804194344219632, 'f1-score': 0.36793930260420593, 'support': 451989}, 'weighted avg': {'precision': 0.39565012149299494, 'recall': 0.3783521280385142, 'f1-score': 0.36797876125799056, 'support': 451989}}
[[68660 69104 20125]
 [50202 70676 20923]
 [46025 74599 31675]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0835311
{'0': {'precision': 0.4149558390578999, 'recall': 0.42688688769535194, 'f1-score': 0.4208368167522593, 'support': 49526}, '1': {'precision': 0.3567465055840416, 'recall': 0.5009172140363335, 'f1-score': 0.4167145271656192, 'support': 50697}, '2': {'precision': 0.4264564136176119, 'recall': 0.23116470563648142, 'f1-score': 0.29981297265063833, 'support': 47849}, 'accuracy': 0.38898643902966124, 'macro avg': {'precision': 0.39938625275318446, 'recall': 0.3863229357893889, 'f1-score': 0.37912143885617233, 'support': 148072}, 'weighted avg': {'precision': 0.398742459168275, 'recall': 0.38898643902966124, 'f1-score': 0.38031695052777154, 'support': 148072}}
[[21142 22145  6239]
 [16665 25395  8637]
 [13143 23645 11061]]
training model: results/AAL/W6/deepOF_L1/h300
Epoch 1/50
1766/1766 - 42s - loss: 3.2918 - accuracy300: 0.3705 - val_loss: 3.2824 - val_accuracy300: 0.3640 - 42s/epoch - 24ms/step
Epoch 2/50
1766/1766 - 38s - loss: 3.2755 - accuracy300: 0.3759 - val_loss: 3.2767 - val_accuracy300: 0.3687 - 38s/epoch - 21ms/step
Epoch 3/50
1766/1766 - 39s - loss: 3.2715 - accuracy300: 0.3774 - val_loss: 3.2700 - val_accuracy300: 0.3728 - 39s/epoch - 22ms/step
Epoch 4/50
1766/1766 - 39s - loss: 3.2687 - accuracy300: 0.3781 - val_loss: 3.2723 - val_accuracy300: 0.3714 - 39s/epoch - 22ms/step
Epoch 5/50
1766/1766 - 39s - loss: 3.2660 - accuracy300: 0.3801 - val_loss: 3.2718 - val_accuracy300: 0.3723 - 39s/epoch - 22ms/step
Epoch 6/50
1766/1766 - 38s - loss: 3.2646 - accuracy300: 0.3797 - val_loss: 3.2702 - val_accuracy300: 0.3727 - 38s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 38s - loss: 3.2632 - accuracy300: 0.3811 - val_loss: 3.2706 - val_accuracy300: 0.3731 - 38s/epoch - 22ms/step
Epoch 8/50
1766/1766 - 39s - loss: 3.2617 - accuracy300: 0.3821 - val_loss: 3.2736 - val_accuracy300: 0.3731 - 39s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 39s - loss: 3.2606 - accuracy300: 0.3827 - val_loss: 3.2740 - val_accuracy300: 0.3728 - 39s/epoch - 22ms/step
Epoch 10/50
1766/1766 - 39s - loss: 3.2593 - accuracy300: 0.3836 - val_loss: 3.2756 - val_accuracy300: 0.3720 - 39s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 40s - loss: 3.2580 - accuracy300: 0.3845 - val_loss: 3.2741 - val_accuracy300: 0.3732 - 40s/epoch - 23ms/step
Epoch 12/50
1766/1766 - 40s - loss: 3.2566 - accuracy300: 0.3850 - val_loss: 3.2764 - val_accuracy300: 0.3723 - 40s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 41s - loss: 3.2552 - accuracy300: 0.3864 - val_loss: 3.2754 - val_accuracy300: 0.3748 - 41s/epoch - 23ms/step
testing model: results/AAL/W6/deepOF_L1/h300
Evaluating performance on  test set...
6203/6203 - 89s - 89s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977181
{'0': {'precision': 0.34519159909593417, 'recall': 0.6310836119745448, 'f1-score': 0.4462773584957993, 'support': 509915}, '1': {'precision': 0.36376414307261723, 'recall': 0.16472002620334392, 'f1-score': 0.2267588800657911, 'support': 537336}, '2': {'precision': 0.38664723187628997, 'recall': 0.2948884424861917, 'f1-score': 0.3345908491327339, 'support': 540618}, 'accuracy': 0.3588022689529174, 'macro avg': {'precision': 0.3652009913482805, 'recall': 0.36356402688802686, 'f1-score': 0.3358756958981081, 'support': 1587869}, 'weighted avg': {'precision': 0.3655908623680966, 'recall': 0.3588022689529174, 'f1-score': 0.33396650763561586, 'support': 1587869}}
[[321799  74147 113969]
 [309898  88510 138928]
 [300536  80660 159422]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0930501
{'0': {'precision': 0.3643091350809534, 'recall': 0.701183702831731, 'f1-score': 0.4794919669510191, 'support': 152910}, '1': {'precision': 0.3779704806487095, 'recall': 0.09684988791736035, 'f1-score': 0.1541905154467048, 'support': 152566}, '2': {'precision': 0.3771196802455498, 'recall': 0.30524936353770654, 'f1-score': 0.33739966201943383, 'support': 146513}, 'accuracy': 0.3688518968381974, 'macro avg': {'precision': 0.37313309865840427, 'recall': 0.367760984762266, 'f1-score': 0.32369404813905256, 'support': 451989}, 'weighted avg': {'precision': 0.37307299493504453, 'recall': 0.3688518968381974, 'f1-score': 0.323629078423536, 'support': 451989}}
[[107218  12104  33588]
 [ 97510  14776  40280]
 [ 89577  12213  44723]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0890026
{'0': {'precision': 0.3658050130536601, 'recall': 0.6667143178058692, 'f1-score': 0.4724123460720332, 'support': 48967}, '1': {'precision': 0.411089976367514, 'recall': 0.13682756503721893, 'f1-score': 0.20531717357822463, 'support': 52124}, '2': {'precision': 0.374674510560324, 'recall': 0.3307720142185139, 'f1-score': 0.3513571565845552, 'support': 46981}, 'accuracy': 0.37359527797287806, 'macro avg': {'precision': 0.3838564999938327, 'recall': 0.3781046323538673, 'f1-score': 0.343028892078271, 'support': 148072}, 'weighted avg': {'precision': 0.3845602894741305, 'recall': 0.37359527797287806, 'f1-score': 0.3399810786590281, 'support': 148072}}
[[32647  5044 11276]
 [30332  7132 14660]
 [26268  5173 15540]]
training model: results/AAL/W6/deepOF_L1/h500
Epoch 1/50
1766/1766 - 42s - loss: 3.2476 - accuracy500: 0.3904 - val_loss: 3.3065 - val_accuracy500: 0.3337 - 42s/epoch - 24ms/step
Epoch 2/50
1766/1766 - 40s - loss: 3.2392 - accuracy500: 0.3949 - val_loss: 3.2725 - val_accuracy500: 0.3695 - 40s/epoch - 23ms/step
Epoch 3/50
1766/1766 - 41s - loss: 3.2443 - accuracy500: 0.3961 - val_loss: 3.2759 - val_accuracy500: 0.3634 - 41s/epoch - 23ms/step
Epoch 4/50
1766/1766 - 39s - loss: 3.2454 - accuracy500: 0.3971 - val_loss: 3.2767 - val_accuracy500: 0.3592 - 39s/epoch - 22ms/step
Epoch 5/50
1766/1766 - 41s - loss: 3.2462 - accuracy500: 0.3980 - val_loss: 3.2799 - val_accuracy500: 0.3485 - 41s/epoch - 23ms/step
Epoch 6/50
1766/1766 - 39s - loss: 3.2455 - accuracy500: 0.3985 - val_loss: 3.2824 - val_accuracy500: 0.3432 - 39s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 38s - loss: 3.2440 - accuracy500: 0.4008 - val_loss: 3.2724 - val_accuracy500: 0.3581 - 38s/epoch - 21ms/step
Epoch 8/50
1766/1766 - 39s - loss: 3.2436 - accuracy500: 0.4000 - val_loss: 3.2778 - val_accuracy500: 0.3506 - 39s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 40s - loss: 3.2426 - accuracy500: 0.4012 - val_loss: 3.2797 - val_accuracy500: 0.3474 - 40s/epoch - 23ms/step
Epoch 10/50
1766/1766 - 39s - loss: 3.2400 - accuracy500: 0.4014 - val_loss: 3.2802 - val_accuracy500: 0.3460 - 39s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 41s - loss: 3.2414 - accuracy500: 0.4017 - val_loss: 3.2860 - val_accuracy500: 0.3418 - 41s/epoch - 23ms/step
Epoch 12/50
1766/1766 - 40s - loss: 3.2387 - accuracy500: 0.4025 - val_loss: 3.2850 - val_accuracy500: 0.3423 - 40s/epoch - 23ms/step
Epoch 13/50
1766/1766 - 41s - loss: 3.2370 - accuracy500: 0.4035 - val_loss: 3.2835 - val_accuracy500: 0.3433 - 41s/epoch - 23ms/step
Epoch 14/50
1766/1766 - 42s - loss: 3.2349 - accuracy500: 0.4043 - val_loss: 3.2821 - val_accuracy500: 0.3442 - 42s/epoch - 24ms/step
Epoch 15/50
1766/1766 - 42s - loss: 3.2345 - accuracy500: 0.4045 - val_loss: 3.2804 - val_accuracy500: 0.3473 - 42s/epoch - 24ms/step
Epoch 16/50
1766/1766 - 42s - loss: 3.2341 - accuracy500: 0.4038 - val_loss: 3.2857 - val_accuracy500: 0.3444 - 42s/epoch - 24ms/step
Epoch 17/50
1766/1766 - 38s - loss: 3.2312 - accuracy500: 0.4042 - val_loss: 3.2822 - val_accuracy500: 0.3466 - 38s/epoch - 22ms/step
testing model: results/AAL/W6/deepOF_L1/h500
Evaluating performance on  test set...
6203/6203 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0827743
{'0': {'precision': 0.225121440777221, 'recall': 0.3830766123523087, 'f1-score': 0.2835877505922966, 'support': 336682}, '1': {'precision': 0.558834746952217, 'recall': 0.32703659307566285, 'f1-score': 0.41260937898679834, 'support': 882626}, '2': {'precision': 0.254908884443847, 'recall': 0.34473262227962265, 'f1-score': 0.29309314712673906, 'support': 368561}, 'accuracy': 0.3430264083498072, 'macro avg': {'precision': 0.34628835739109504, 'recall': 0.35161527590253144, 'f1-score': 0.3297634255686113, 'support': 1587869}, 'weighted avg': {'precision': 0.4175318541055418, 'recall': 0.3430264083498072, 'f1-score': 0.3575114572931996, 'support': 1587869}}
[[128975 112020  95687]
 [318284 288651 275691]
 [125654 115852 127055]]
Evaluating performance on  train set...
1766/1766 - 25s - 25s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0957208
{'0': {'precision': 0.3726277675029157, 'recall': 0.48902323436739503, 'f1-score': 0.4229639046060193, 'support': 156148}, '1': {'precision': 0.33537318805587507, 'recall': 0.25928766825731914, 'f1-score': 0.2924629425456327, 'support': 147319}, '2': {'precision': 0.36551299476604915, 'recall': 0.3277292252999556, 'f1-score': 0.3455914459460899, 'support': 148522}, 'accuracy': 0.36114374464865295, 'macro avg': {'precision': 0.35783798344161327, 'recall': 0.35868004264155656, 'f1-score': 0.35367276436591394, 'support': 451989}, 'weighted avg': {'precision': 0.358147309646677, 'recall': 0.36114374464865295, 'f1-score': 0.3550047650365516, 'support': 451989}}
[[76360 39396 40392]
 [65019 38198 44102]
 [63544 36303 48675]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0878112
{'0': {'precision': 0.3317147968310759, 'recall': 0.4718713078251386, 'f1-score': 0.38957043706621647, 'support': 44012}, '1': {'precision': 0.4395358627585118, 'recall': 0.2734937786509496, 'f1-score': 0.337181842036211, 'support': 61080}, '2': {'precision': 0.33246238779552445, 'recall': 0.36710097719869705, 'f1-score': 0.34892412481479024, 'support': 42980}, 'accuracy': 0.35962909935706955, 'macro avg': {'precision': 0.3679043491283707, 'recall': 0.3708220212249284, 'f1-score': 0.35855880130573925, 'support': 148072}, 'weighted avg': {'precision': 0.37640820386616547, 'recall': 0.35962909935706955, 'f1-score': 0.3561618663371182, 'support': 148072}}
[[20768 11042 12202]
 [24897 16705 19478]
 [16943 10259 15778]]
training model: results/AAL/W6/deepOF_L1/h1000
Epoch 1/50
1766/1766 - 44s - loss: 3.2593 - accuracy1000: 0.3951 - val_loss: 3.5517 - val_accuracy1000: 0.3150 - 44s/epoch - 25ms/step
Epoch 2/50
1766/1766 - 42s - loss: 3.2679 - accuracy1000: 0.3845 - val_loss: 3.4500 - val_accuracy1000: 0.3143 - 42s/epoch - 24ms/step
Epoch 3/50
1766/1766 - 41s - loss: 3.2827 - accuracy1000: 0.3682 - val_loss: 3.4034 - val_accuracy1000: 0.3116 - 41s/epoch - 23ms/step
Epoch 4/50
1766/1766 - 41s - loss: 3.2828 - accuracy1000: 0.3675 - val_loss: 3.4184 - val_accuracy1000: 0.3135 - 41s/epoch - 23ms/step
Epoch 5/50
1766/1766 - 40s - loss: 3.2806 - accuracy1000: 0.3702 - val_loss: 3.4138 - val_accuracy1000: 0.3117 - 40s/epoch - 22ms/step
Epoch 6/50
1766/1766 - 39s - loss: 3.2797 - accuracy1000: 0.3704 - val_loss: 3.4157 - val_accuracy1000: 0.3142 - 39s/epoch - 22ms/step
Epoch 7/50
1766/1766 - 41s - loss: 3.2783 - accuracy1000: 0.3710 - val_loss: 3.4300 - val_accuracy1000: 0.3157 - 41s/epoch - 23ms/step
Epoch 8/50
1766/1766 - 39s - loss: 3.2765 - accuracy1000: 0.3734 - val_loss: 3.4342 - val_accuracy1000: 0.3147 - 39s/epoch - 22ms/step
Epoch 9/50
1766/1766 - 41s - loss: 3.2757 - accuracy1000: 0.3742 - val_loss: 3.4387 - val_accuracy1000: 0.3147 - 41s/epoch - 23ms/step
Epoch 10/50
1766/1766 - 39s - loss: 3.2745 - accuracy1000: 0.3749 - val_loss: 3.4600 - val_accuracy1000: 0.3147 - 39s/epoch - 22ms/step
Epoch 11/50
1766/1766 - 38s - loss: 3.2727 - accuracy1000: 0.3769 - val_loss: 3.4654 - val_accuracy1000: 0.3142 - 38s/epoch - 21ms/step
Epoch 12/50
1766/1766 - 39s - loss: 3.2714 - accuracy1000: 0.3793 - val_loss: 3.4676 - val_accuracy1000: 0.3151 - 39s/epoch - 22ms/step
Epoch 13/50
1766/1766 - 38s - loss: 3.2699 - accuracy1000: 0.3800 - val_loss: 3.4710 - val_accuracy1000: 0.3153 - 38s/epoch - 22ms/step
testing model: results/AAL/W6/deepOF_L1/h1000
Evaluating performance on  test set...
6203/6203 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1440203
{'0': {'precision': 0.280502988554386, 'recall': 0.3274833383211488, 'f1-score': 0.30217802947287214, 'support': 421026}, '1': {'precision': 0.4691011235955056, 'recall': 0.00024153436513342966, 'f1-score': 0.00048282013215394156, 'support': 691413}, '2': {'precision': 0.3052188424693719, 'recall': 0.7035967440001683, 'f1-score': 0.4257487426824852, 'support': 475430}, 'accuracy': 0.2976045253103373, 'macro avg': {'precision': 0.35160765153975443, 'recall': 0.34377387222881683, 'f1-score': 0.24280319742917045, 'support': 1587869}, 'weighted avg': {'precision': 0.3700253992633219, 'recall': 0.2976045253103373, 'f1-score': 0.20780830149490442, 'support': 1587869}}
[[137879     70 283077]
 [212863    167 478383]
 [140800    119 334511]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1107725
{'0': {'precision': 0.3698545389867995, 'recall': 0.308599118601635, 'f1-score': 0.3364615503668737, 'support': 154981}, '1': {'precision': 0.4, 'recall': 0.0004126538300265563, 'f1-score': 0.0008244571215808302, 'support': 150247}, '2': {'precision': 0.33386663194024574, 'recall': 0.7337030955090249, 'f1-score': 0.4589095682340256, 'support': 146761}, 'accuracy': 0.3441853673430106, 'macro avg': {'precision': 0.3679070569756817, 'recall': 0.3475716226468955, 'f1-score': 0.2653985252408267, 'support': 451989}, 'weighted avg': {'precision': 0.3681899937319173, 'recall': 0.3441853673430106, 'f1-score': 0.2646503496548554, 'support': 451989}}
[[ 47827     44 107110]
 [ 42453     62 107732]
 [ 39033     49 107679]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.134142
{'0': {'precision': 0.3296930045294414, 'recall': 0.293628560543242, 'f1-score': 0.31061746541648394, 'support': 44621}, '1': {'precision': 0.5988857938718662, 'recall': 0.00356402818068794, 'f1-score': 0.007085887548612485, 'support': 60325}, '2': {'precision': 0.3021125651783316, 'recall': 0.7563882576635904, 'f1-score': 0.43176989920515685, 'support': 43126}, 'accuracy': 0.31023421038413745, 'macro avg': {'precision': 0.41023045452654644, 'recall': 0.35119361546250677, 'f1-score': 0.24982441739008443, 'support': 148072}, 'weighted avg': {'precision': 0.4313301877215765, 'recall': 0.31023421038413745, 'f1-score': 0.22224341377060194, 'support': 148072}}
[[13102    77 31442]
 [16199   215 43911]
 [10439    67 32620]]
training model: results/AAL/W6/deepLOB_L2/h10
Epoch 1/50
1766/1766 - 87s - loss: 2.9740 - accuracy10: 0.4015 - val_loss: 3.1109 - val_accuracy10: 0.5276 - 87s/epoch - 49ms/step
Epoch 2/50
1766/1766 - 83s - loss: 2.8477 - accuracy10: 0.3993 - val_loss: 2.8548 - val_accuracy10: 0.5888 - 83s/epoch - 47ms/step
Epoch 3/50
1766/1766 - 84s - loss: 2.7131 - accuracy10: 0.5042 - val_loss: 2.7084 - val_accuracy10: 0.5355 - 84s/epoch - 48ms/step
Epoch 4/50
1766/1766 - 85s - loss: 2.5777 - accuracy10: 0.5641 - val_loss: 2.6307 - val_accuracy10: 0.4937 - 85s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 84s - loss: 2.4734 - accuracy10: 0.6087 - val_loss: 2.5591 - val_accuracy10: 0.5686 - 84s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 86s - loss: 2.4196 - accuracy10: 0.6293 - val_loss: 2.5313 - val_accuracy10: 0.6091 - 86s/epoch - 49ms/step
Epoch 7/50
1766/1766 - 84s - loss: 2.3831 - accuracy10: 0.6385 - val_loss: 2.4840 - val_accuracy10: 0.6052 - 84s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 82s - loss: 2.3515 - accuracy10: 0.6430 - val_loss: 2.4562 - val_accuracy10: 0.6376 - 82s/epoch - 47ms/step
Epoch 9/50
1766/1766 - 82s - loss: 2.3245 - accuracy10: 0.6476 - val_loss: 2.4199 - val_accuracy10: 0.6396 - 82s/epoch - 47ms/step
Epoch 10/50
1766/1766 - 82s - loss: 2.3022 - accuracy10: 0.6509 - val_loss: 2.4888 - val_accuracy10: 0.6321 - 82s/epoch - 46ms/step
Epoch 11/50
1766/1766 - 82s - loss: 2.2819 - accuracy10: 0.6531 - val_loss: 2.4463 - val_accuracy10: 0.6494 - 82s/epoch - 47ms/step
Epoch 12/50
1766/1766 - 82s - loss: 2.2660 - accuracy10: 0.6542 - val_loss: 2.4238 - val_accuracy10: 0.6546 - 82s/epoch - 46ms/step
Epoch 13/50
1766/1766 - 82s - loss: 2.2504 - accuracy10: 0.6564 - val_loss: 2.3495 - val_accuracy10: 0.6700 - 82s/epoch - 46ms/step
Epoch 14/50
1766/1766 - 84s - loss: 2.2375 - accuracy10: 0.6578 - val_loss: 2.3676 - val_accuracy10: 0.6531 - 84s/epoch - 48ms/step
Epoch 15/50
1766/1766 - 83s - loss: 2.2260 - accuracy10: 0.6585 - val_loss: 2.4456 - val_accuracy10: 0.6358 - 83s/epoch - 47ms/step
Epoch 16/50
1766/1766 - 82s - loss: 2.2145 - accuracy10: 0.6600 - val_loss: 2.3758 - val_accuracy10: 0.6671 - 82s/epoch - 47ms/step
Epoch 17/50
1766/1766 - 85s - loss: 2.2035 - accuracy10: 0.6593 - val_loss: 2.4083 - val_accuracy10: 0.6643 - 85s/epoch - 48ms/step
Epoch 18/50
1766/1766 - 85s - loss: 2.1940 - accuracy10: 0.6598 - val_loss: 2.3806 - val_accuracy10: 0.6624 - 85s/epoch - 48ms/step
Epoch 19/50
1766/1766 - 85s - loss: 2.1836 - accuracy10: 0.6608 - val_loss: 2.3740 - val_accuracy10: 0.6542 - 85s/epoch - 48ms/step
Epoch 20/50
1766/1766 - 84s - loss: 2.1762 - accuracy10: 0.6611 - val_loss: 2.4168 - val_accuracy10: 0.6605 - 84s/epoch - 48ms/step
Epoch 21/50
1766/1766 - 85s - loss: 2.1669 - accuracy10: 0.6615 - val_loss: 2.4053 - val_accuracy10: 0.6422 - 85s/epoch - 48ms/step
Epoch 22/50
1766/1766 - 83s - loss: 2.1598 - accuracy10: 0.6622 - val_loss: 2.3993 - val_accuracy10: 0.6441 - 83s/epoch - 47ms/step
Epoch 23/50
1766/1766 - 83s - loss: 2.1506 - accuracy10: 0.6625 - val_loss: 2.4384 - val_accuracy10: 0.6337 - 83s/epoch - 47ms/step
testing model: results/AAL/W6/deepLOB_L2/h10
Evaluating performance on  test set...
6203/6203 - 115s - 115s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9274858
{'0': {'precision': 0.282064928153273, 'recall': 0.6543145252886391, 'f1-score': 0.3941974140649637, 'support': 202502}, '1': {'precision': 0.9216940538606392, 'recall': 0.514716540846635, 'f1-score': 0.6605509272489604, 'support': 1181052}, '2': {'precision': 0.3008679154763722, 'recall': 0.6752593970242756, 'f1-score': 0.4162651420295977, 'support': 204320}, 'accuracy': 0.5531773931684756, 'macro avg': {'precision': 0.5015422991634281, 'recall': 0.6147634877198499, 'f1-score': 0.4903378277811739, 'support': 1587874}, 'weighted avg': {'precision': 0.7602370529848351, 'recall': 0.5531773931684755, 'f1-score': 0.5951492702139526, 'support': 1587874}}
[[132500  25557  44445]
 [296989 607907 276156]
 [ 40261  26090 137969]]
Evaluating performance on  train set...
1766/1766 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.89025444
{'0': {'precision': 0.3631822744699636, 'recall': 0.5110884180069781, 'f1-score': 0.42462421697139385, 'support': 58755}, '1': {'precision': 0.891999355940997, 'recall': 0.597606398120597, 'f1-score': 0.7157122222122536, 'support': 333723}, '2': {'precision': 0.2816450050094012, 'recall': 0.6896476400114261, 'f1-score': 0.3999532252642042, 'support': 59513}, 'accuracy': 0.598478730771188, 'macro avg': {'precision': 0.5122755451401206, 'recall': 0.5994474853796671, 'f1-score': 0.5134298881492839, 'support': 451991}, 'weighted avg': {'precision': 0.7428931434083965, 'recall': 0.598478730771188, 'f1-score': 0.6362977185312159, 'support': 451991}}
[[ 30029  13716  15010]
 [ 44615 199435  89673]
 [  8039  10431  41043]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74667805
{'0': {'precision': 0.3452990323965523, 'recall': 0.6048125867653864, 'f1-score': 0.43961403435010193, 'support': 17288}, '1': {'precision': 0.9020738629938712, 'recall': 0.6985892305132538, 'f1-score': 0.7873975333988066, 'support': 114193}, '2': {'precision': 0.3026876043192424, 'recall': 0.5355915857995298, 'f1-score': 0.38678506137372676, 'support': 16591}, 'accuracy': 0.6693770598087417, 'macro avg': {'precision': 0.5166868332365553, 'recall': 0.6129978010260567, 'f1-score': 0.5379322097075451, 'support': 148072}, 'weighted avg': {'precision': 0.7699088305161764, 'recall': 0.6693770598087417, 'f1-score': 0.7019050523428196, 'support': 148072}}
[[10456  4276  2556]
 [16504 79774 17915]
 [ 3321  4384  8886]]
training model: results/AAL/W6/deepLOB_L2/h20
Epoch 1/50
1766/1766 - 85s - loss: 3.0131 - accuracy20: 0.4322 - val_loss: 3.4039 - val_accuracy20: 0.5631 - 85s/epoch - 48ms/step
Epoch 2/50
1766/1766 - 83s - loss: 2.9143 - accuracy20: 0.4322 - val_loss: 3.0753 - val_accuracy20: 0.6088 - 83s/epoch - 47ms/step
Epoch 3/50
1766/1766 - 84s - loss: 2.7603 - accuracy20: 0.5022 - val_loss: 2.8962 - val_accuracy20: 0.6323 - 84s/epoch - 47ms/step
Epoch 4/50
1766/1766 - 84s - loss: 2.6249 - accuracy20: 0.5662 - val_loss: 2.7437 - val_accuracy20: 0.6613 - 84s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 85s - loss: 2.5284 - accuracy20: 0.6015 - val_loss: 2.5521 - val_accuracy20: 0.6200 - 85s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 84s - loss: 2.4713 - accuracy20: 0.6151 - val_loss: 2.4593 - val_accuracy20: 0.6656 - 84s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 84s - loss: 2.4389 - accuracy20: 0.6214 - val_loss: 2.4850 - val_accuracy20: 0.6494 - 84s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 84s - loss: 2.4137 - accuracy20: 0.6250 - val_loss: 2.4917 - val_accuracy20: 0.6502 - 84s/epoch - 48ms/step
Epoch 9/50
1766/1766 - 85s - loss: 2.3943 - accuracy20: 0.6270 - val_loss: 2.5057 - val_accuracy20: 0.6302 - 85s/epoch - 48ms/step
Epoch 10/50
1766/1766 - 86s - loss: 2.3770 - accuracy20: 0.6294 - val_loss: 2.4685 - val_accuracy20: 0.6272 - 86s/epoch - 48ms/step
Epoch 11/50
1766/1766 - 86s - loss: 2.3633 - accuracy20: 0.6313 - val_loss: 2.4505 - val_accuracy20: 0.6404 - 86s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 85s - loss: 2.3487 - accuracy20: 0.6322 - val_loss: 2.4857 - val_accuracy20: 0.6110 - 85s/epoch - 48ms/step
Epoch 13/50
1766/1766 - 84s - loss: 2.3391 - accuracy20: 0.6343 - val_loss: 2.4449 - val_accuracy20: 0.6363 - 84s/epoch - 48ms/step
Epoch 14/50
1766/1766 - 83s - loss: 2.3299 - accuracy20: 0.6354 - val_loss: 2.5045 - val_accuracy20: 0.6263 - 83s/epoch - 47ms/step
Epoch 15/50
1766/1766 - 84s - loss: 2.3208 - accuracy20: 0.6368 - val_loss: 2.4613 - val_accuracy20: 0.6350 - 84s/epoch - 48ms/step
Epoch 16/50
1766/1766 - 84s - loss: 2.3119 - accuracy20: 0.6383 - val_loss: 2.5538 - val_accuracy20: 0.5973 - 84s/epoch - 47ms/step
Epoch 17/50
1766/1766 - 84s - loss: 2.3052 - accuracy20: 0.6389 - val_loss: 2.5145 - val_accuracy20: 0.5972 - 84s/epoch - 48ms/step
Epoch 18/50
1766/1766 - 84s - loss: 2.2965 - accuracy20: 0.6393 - val_loss: 2.5386 - val_accuracy20: 0.6096 - 84s/epoch - 48ms/step
Epoch 19/50
1766/1766 - 84s - loss: 2.2909 - accuracy20: 0.6401 - val_loss: 2.4958 - val_accuracy20: 0.6175 - 84s/epoch - 48ms/step
Epoch 20/50
1766/1766 - 86s - loss: 2.2844 - accuracy20: 0.6419 - val_loss: 2.5113 - val_accuracy20: 0.6151 - 86s/epoch - 49ms/step
Epoch 21/50
1766/1766 - 86s - loss: 2.2796 - accuracy20: 0.6414 - val_loss: 2.5677 - val_accuracy20: 0.5925 - 86s/epoch - 49ms/step
Epoch 22/50
1766/1766 - 85s - loss: 2.2717 - accuracy20: 0.6418 - val_loss: 2.4707 - val_accuracy20: 0.6263 - 85s/epoch - 48ms/step
Epoch 23/50
1766/1766 - 83s - loss: 2.2662 - accuracy20: 0.6425 - val_loss: 2.4914 - val_accuracy20: 0.6198 - 83s/epoch - 47ms/step
testing model: results/AAL/W6/deepLOB_L2/h20
Evaluating performance on  test set...
6203/6203 - 118s - 118s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9930352
{'0': {'precision': 0.3400470839559162, 'recall': 0.6532893247831008, 'f1-score': 0.4472787424635493, 'support': 265100}, '1': {'precision': 0.8767157586334471, 'recall': 0.445075349761956, 'f1-score': 0.5904179116309709, 'support': 1054217}, '2': {'precision': 0.3293097895598885, 'recall': 0.6663092006538649, 'f1-score': 0.44077532631641175, 'support': 268557}, 'accuracy': 0.5172545176758357, 'macro avg': {'precision': 0.5153575440497505, 'recall': 0.5882246250663072, 'f1-score': 0.4928239934703107, 'support': 1587874}, 'weighted avg': {'precision': 0.694534697356859, 'recall': 0.5172545176758357, 'f1-score': 0.5412113892427931, 'support': 1587874}}
[[173187  34903  57010]
 [277578 469206 307433]
 [ 58538  31077 178942]]
Evaluating performance on  train set...
1766/1766 - 34s - 34s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9195182
{'0': {'precision': 0.45769334009365026, 'recall': 0.39446322310331977, 'f1-score': 0.4237324405480965, 'support': 77807}, '1': {'precision': 0.8216892742273808, 'recall': 0.5956732864977748, 'f1-score': 0.6906607582587436, 'support': 295929}, '2': {'precision': 0.32694260077580795, 'recall': 0.7119289502268226, 'f1-score': 0.4481014083600769, 'support': 78255}, 'accuracy': 0.5811642267213285, 'macro avg': {'precision': 0.535441738365613, 'recall': 0.5673551532759724, 'f1-score': 0.5208315357223057, 'support': 451991}, 'weighted avg': {'precision': 0.6733725321283212, 'recall': 0.5811642267213285, 'f1-score': 0.6027157028429666, 'support': 451991}}
[[ 30692  23530  23585]
 [ 28546 176277  91106]
 [  7820  14723  55712]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8006861
{'0': {'precision': 0.4213522143551298, 'recall': 0.5294836008374041, 'f1-score': 0.4692694240432934, 'support': 22928}, '1': {'precision': 0.8516697954747554, 'recall': 0.6693391831029663, 'f1-score': 0.7495760685247184, 'support': 103024}, '2': {'precision': 0.34424945158257597, 'recall': 0.5959312839059675, 'f1-score': 0.4364033635701517, 'support': 22120}, 'accuracy': 0.6367172726781566, 'macro avg': {'precision': 0.5390904871374871, 'recall': 0.5982513559487792, 'f1-score': 0.5517496187127211, 'support': 148072}, 'weighted avg': {'precision': 0.7092359828241139, 'recall': 0.6367172726781566, 'f1-score': 0.6593885180204696, 'support': 148072}}
[[12140  6760  4028]
 [12984 68958 21082]
 [ 3688  5250 13182]]
training model: results/AAL/W6/deepLOB_L2/h30
Epoch 1/50
1766/1766 - 88s - loss: 3.0333 - accuracy30: 0.4415 - val_loss: 3.1436 - val_accuracy30: 0.5036 - 88s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 85s - loss: 2.9555 - accuracy30: 0.4427 - val_loss: 3.0840 - val_accuracy30: 0.5160 - 85s/epoch - 48ms/step
Epoch 3/50
1766/1766 - 84s - loss: 2.8711 - accuracy30: 0.4857 - val_loss: 3.2258 - val_accuracy30: 0.4592 - 84s/epoch - 47ms/step
Epoch 4/50
1766/1766 - 85s - loss: 2.7960 - accuracy30: 0.5190 - val_loss: 3.1828 - val_accuracy30: 0.4252 - 85s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 85s - loss: 2.7094 - accuracy30: 0.5558 - val_loss: 3.1304 - val_accuracy30: 0.4725 - 85s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 85s - loss: 2.6326 - accuracy30: 0.5822 - val_loss: 3.1879 - val_accuracy30: 0.4486 - 85s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 85s - loss: 2.5879 - accuracy30: 0.5950 - val_loss: 3.2970 - val_accuracy30: 0.4301 - 85s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 85s - loss: 2.5593 - accuracy30: 0.6011 - val_loss: 3.2240 - val_accuracy30: 0.4498 - 85s/epoch - 48ms/step
Epoch 9/50
1766/1766 - 84s - loss: 2.5343 - accuracy30: 0.6055 - val_loss: 3.3217 - val_accuracy30: 0.4579 - 84s/epoch - 48ms/step
Epoch 10/50
1766/1766 - 83s - loss: 2.5150 - accuracy30: 0.6078 - val_loss: 3.1755 - val_accuracy30: 0.4962 - 83s/epoch - 47ms/step
Epoch 11/50
1766/1766 - 85s - loss: 2.4981 - accuracy30: 0.6110 - val_loss: 2.9216 - val_accuracy30: 0.5664 - 85s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 84s - loss: 2.4829 - accuracy30: 0.6128 - val_loss: 2.9278 - val_accuracy30: 0.5696 - 84s/epoch - 47ms/step
Epoch 13/50
1766/1766 - 84s - loss: 2.4724 - accuracy30: 0.6140 - val_loss: 2.9262 - val_accuracy30: 0.5411 - 84s/epoch - 47ms/step
Epoch 14/50
1766/1766 - 84s - loss: 2.4613 - accuracy30: 0.6152 - val_loss: 3.1691 - val_accuracy30: 0.4889 - 84s/epoch - 47ms/step
Epoch 15/50
1766/1766 - 84s - loss: 2.4504 - accuracy30: 0.6167 - val_loss: 3.1495 - val_accuracy30: 0.4952 - 84s/epoch - 48ms/step
Epoch 16/50
1766/1766 - 84s - loss: 2.4413 - accuracy30: 0.6177 - val_loss: 3.1362 - val_accuracy30: 0.5123 - 84s/epoch - 47ms/step
Epoch 17/50
1766/1766 - 84s - loss: 2.4324 - accuracy30: 0.6188 - val_loss: 3.4242 - val_accuracy30: 0.4428 - 84s/epoch - 48ms/step
Epoch 18/50
1766/1766 - 84s - loss: 2.4247 - accuracy30: 0.6196 - val_loss: 3.6355 - val_accuracy30: 0.4205 - 84s/epoch - 48ms/step
Epoch 19/50
1766/1766 - 85s - loss: 2.4177 - accuracy30: 0.6206 - val_loss: 3.3159 - val_accuracy30: 0.4729 - 85s/epoch - 48ms/step
Epoch 20/50
1766/1766 - 84s - loss: 2.4093 - accuracy30: 0.6218 - val_loss: 3.2441 - val_accuracy30: 0.4806 - 84s/epoch - 47ms/step
Epoch 21/50
1766/1766 - 84s - loss: 2.4017 - accuracy30: 0.6222 - val_loss: 3.4913 - val_accuracy30: 0.4495 - 84s/epoch - 48ms/step
testing model: results/AAL/W6/deepLOB_L2/h30
Evaluating performance on  test set...
6203/6203 - 120s - 120s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1325617
{'0': {'precision': 0.2658167057821283, 'recall': 0.8169989378872621, 'f1-score': 0.40112454519173435, 'support': 311643}, '1': {'precision': 0.7747567118196489, 'recall': 0.3797087283541776, 'f1-score': 0.5096417364985968, 'support': 959654}, '2': {'precision': 0.42509971884607917, 'recall': 0.21444387937215906, 'f1-score': 0.28507839991937445, 'support': 316577}, 'accuracy': 0.4325840715321241, 'macro avg': {'precision': 0.48855771214928545, 'recall': 0.47038384853786624, 'f1-score': 0.3986148938699019, 'support': 1587874}, 'weighted avg': {'precision': 0.6051582725441492, 'recall': 0.4325840715321241, 'f1-score': 0.4435721299336646, 'support': 1587874}}
[[254612  38762  18269]
 [521723 364389  73542]
 [181513  67176  67888]]
Evaluating performance on  train set...
1766/1766 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94437814
{'0': {'precision': 0.3764584912730156, 'recall': 0.46968906283974776, 'f1-score': 0.4179375928102583, 'support': 91980}, '1': {'precision': 0.7360555579974507, 'recall': 0.6250163289528196, 'f1-score': 0.6760065315810827, 'support': 267929}, '2': {'precision': 0.4023258781283608, 'recall': 0.47939879672465846, 'f1-score': 0.43749380587104325, 'support': 92082}, 'accuracy': 0.5637413134332321, 'macro avg': {'precision': 0.5049466424662757, 'recall': 0.5247013961724086, 'f1-score': 0.5104793100874615, 'support': 451991}, 'weighted avg': {'precision': 0.5948885113548869, 'recall': 0.5637413134332321, 'f1-score': 0.5748985232424825, 'support': 451991}}
[[ 43202  30682  18096]
 [ 52987 167460  47482]
 [ 18570  29368  44144]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92298275
{'0': {'precision': 0.3218775073549077, 'recall': 0.6203151461600765, 'f1-score': 0.42383156411933387, 'support': 27162}, '1': {'precision': 0.7758102370718072, 'recall': 0.622062228424625, 'f1-score': 0.6904810800978708, 'support': 94587}, '2': {'precision': 0.4014282840474754, 'recall': 0.30323291418151427, 'f1-score': 0.3454887787564655, 'support': 26323}, 'accuracy': 0.5650629423523691, 'macro avg': {'precision': 0.49970534282473017, 'recall': 0.5152034295887385, 'f1-score': 0.4866004743245567, 'support': 148072}, 'weighted avg': {'precision': 0.6259873336597516, 'recall': 0.5650629423523691, 'f1-score': 0.5802376410869922, 'support': 148072}}
[[16849  7672  2641]
 [26487 58839  9261]
 [ 9010  9331  7982]]
training model: results/AAL/W6/deepLOB_L2/h50
Epoch 1/50
1766/1766 - 89s - loss: 3.0981 - accuracy50: 0.4438 - val_loss: 3.3424 - val_accuracy50: 0.5117 - 89s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 84s - loss: 3.0109 - accuracy50: 0.4614 - val_loss: 3.1491 - val_accuracy50: 0.5260 - 84s/epoch - 48ms/step
Epoch 3/50
1766/1766 - 85s - loss: 2.9370 - accuracy50: 0.4896 - val_loss: 3.0703 - val_accuracy50: 0.5110 - 85s/epoch - 48ms/step
Epoch 4/50
1766/1766 - 85s - loss: 2.8860 - accuracy50: 0.5123 - val_loss: 3.1253 - val_accuracy50: 0.4686 - 85s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 87s - loss: 2.8409 - accuracy50: 0.5301 - val_loss: 3.1149 - val_accuracy50: 0.4274 - 87s/epoch - 49ms/step
Epoch 6/50
1766/1766 - 86s - loss: 2.7942 - accuracy50: 0.5449 - val_loss: 2.9779 - val_accuracy50: 0.5340 - 86s/epoch - 49ms/step
Epoch 7/50
1766/1766 - 84s - loss: 2.7567 - accuracy50: 0.5553 - val_loss: 2.9407 - val_accuracy50: 0.5231 - 84s/epoch - 47ms/step
Epoch 8/50
1766/1766 - 84s - loss: 2.7270 - accuracy50: 0.5626 - val_loss: 2.9715 - val_accuracy50: 0.5115 - 84s/epoch - 48ms/step
Epoch 9/50
1766/1766 - 84s - loss: 2.7079 - accuracy50: 0.5666 - val_loss: 3.0399 - val_accuracy50: 0.5056 - 84s/epoch - 47ms/step
Epoch 10/50
1766/1766 - 84s - loss: 2.6914 - accuracy50: 0.5699 - val_loss: 3.0871 - val_accuracy50: 0.4982 - 84s/epoch - 48ms/step
Epoch 11/50
1766/1766 - 84s - loss: 2.6775 - accuracy50: 0.5723 - val_loss: 3.0528 - val_accuracy50: 0.4893 - 84s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 85s - loss: 2.6660 - accuracy50: 0.5748 - val_loss: 2.9596 - val_accuracy50: 0.5098 - 85s/epoch - 48ms/step
Epoch 13/50
1766/1766 - 85s - loss: 2.6559 - accuracy50: 0.5759 - val_loss: 3.0211 - val_accuracy50: 0.4906 - 85s/epoch - 48ms/step
Epoch 14/50
1766/1766 - 86s - loss: 2.6440 - accuracy50: 0.5780 - val_loss: 2.9897 - val_accuracy50: 0.5012 - 86s/epoch - 48ms/step
Epoch 15/50
1766/1766 - 84s - loss: 2.6352 - accuracy50: 0.5803 - val_loss: 3.1389 - val_accuracy50: 0.4699 - 84s/epoch - 47ms/step
Epoch 16/50
1766/1766 - 85s - loss: 2.6277 - accuracy50: 0.5809 - val_loss: 3.0814 - val_accuracy50: 0.4883 - 85s/epoch - 48ms/step
Epoch 17/50
1766/1766 - 85s - loss: 2.6201 - accuracy50: 0.5824 - val_loss: 3.0500 - val_accuracy50: 0.4929 - 85s/epoch - 48ms/step
testing model: results/AAL/W6/deepLOB_L2/h50
Evaluating performance on  test set...
6203/6203 - 120s - 120s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.117987
{'0': {'precision': 0.3588812457840771, 'recall': 0.47302439881559655, 'f1-score': 0.4081222110589151, 'support': 381289}, '1': {'precision': 0.6851891474526841, 'recall': 0.3607207092492081, 'f1-score': 0.47262565441036686, 'support': 816751}, '2': {'precision': 0.3692779090935448, 'recall': 0.6207770486925204, 'f1-score': 0.4630838899429469, 'support': 389834}, 'accuracy': 0.45153330805844794, 'macro avg': {'precision': 0.47111610077676863, 'recall': 0.48484071891910835, 'f1-score': 0.447943918470743, 'support': 1587874}, 'weighted avg': {'precision': 0.5292759230949465, 'recall': 0.45153330805844794, 'f1-score': 0.4547941655004005, 'support': 1587874}}
[[180359  71921 129009]
 [237808 294619 284324]
 [ 84392  63442 242000]]
Evaluating performance on  train set...
1766/1766 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9765811
{'0': {'precision': 0.46498869713844626, 'recall': 0.2974963181148748, 'f1-score': 0.3628462791960891, 'support': 113393}, '1': {'precision': 0.6147420823427754, 'recall': 0.6341527231443992, 'f1-score': 0.6242965601847608, 'support': 225493}, '2': {'precision': 0.4122182115371518, 'recall': 0.5351310728968658, 'f1-score': 0.46570104064477663, 'support': 113105}, 'accuracy': 0.5249153191103363, 'macro avg': {'precision': 0.4973163303394578, 'recall': 0.4889267047187132, 'f1-score': 0.4842812933418755, 'support': 451991}, 'weighted avg': {'precision': 0.5264937587789333, 'recall': 0.5249153191103363, 'f1-score': 0.5190188490141437, 'support': 451991}}
[[ 33734  47907  31752]
 [ 27944 142997  54552]
 [ 10870  41709  60526]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9870903
{'0': {'precision': 0.38940138517688305, 'recall': 0.39833024664138517, 'f1-score': 0.3938152120208097, 'support': 34017}, '1': {'precision': 0.655152335815843, 'recall': 0.595886446209742, 'f1-score': 0.6241155793479312, 'support': 81195}, '2': {'precision': 0.39370957514267596, 'recall': 0.4723676202069385, 'f1-score': 0.42946669433492424, 'support': 32860}, 'accuracy': 0.5230901183208169, 'macro avg': {'precision': 0.47942109871180066, 'recall': 0.48886143768602186, 'f1-score': 0.48246582856788844, 'support': 148072}, 'weighted avg': {'precision': 0.5360814837735544, 'recall': 0.5230901183208169, 'f1-score': 0.5280117247576366, 'support': 148072}}
[[13550 13661  6806]
 [15715 48383 17097]
 [ 5532 11806 15522]]
training model: results/AAL/W6/deepLOB_L2/h100
Epoch 1/50
1766/1766 - 86s - loss: 3.2107 - accuracy100: 0.4183 - val_loss: 3.4608 - val_accuracy100: 0.3969 - 86s/epoch - 49ms/step
Epoch 2/50
1766/1766 - 84s - loss: 3.1574 - accuracy100: 0.4379 - val_loss: 3.4888 - val_accuracy100: 0.3532 - 84s/epoch - 48ms/step
Epoch 3/50
1766/1766 - 84s - loss: 3.1013 - accuracy100: 0.4601 - val_loss: 3.3999 - val_accuracy100: 0.3333 - 84s/epoch - 48ms/step
Epoch 4/50
1766/1766 - 85s - loss: 3.0691 - accuracy100: 0.4705 - val_loss: 3.4095 - val_accuracy100: 0.3242 - 85s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 85s - loss: 3.0476 - accuracy100: 0.4766 - val_loss: 3.3971 - val_accuracy100: 0.3295 - 85s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 86s - loss: 3.0314 - accuracy100: 0.4805 - val_loss: 3.3983 - val_accuracy100: 0.3482 - 86s/epoch - 49ms/step
Epoch 7/50
1766/1766 - 86s - loss: 3.0174 - accuracy100: 0.4850 - val_loss: 3.5510 - val_accuracy100: 0.3180 - 86s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 87s - loss: 3.0029 - accuracy100: 0.4887 - val_loss: 3.4694 - val_accuracy100: 0.3213 - 87s/epoch - 49ms/step
Epoch 9/50
1766/1766 - 86s - loss: 2.9885 - accuracy100: 0.4934 - val_loss: 3.5629 - val_accuracy100: 0.3378 - 86s/epoch - 49ms/step
Epoch 10/50
1766/1766 - 84s - loss: 2.9772 - accuracy100: 0.4964 - val_loss: 3.5948 - val_accuracy100: 0.3354 - 84s/epoch - 48ms/step
Epoch 11/50
1766/1766 - 85s - loss: 2.9638 - accuracy100: 0.5000 - val_loss: 3.5791 - val_accuracy100: 0.3317 - 85s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 85s - loss: 2.9498 - accuracy100: 0.5035 - val_loss: 3.6879 - val_accuracy100: 0.3251 - 85s/epoch - 48ms/step
Epoch 13/50
1766/1766 - 85s - loss: 2.9385 - accuracy100: 0.5065 - val_loss: 3.6641 - val_accuracy100: 0.3375 - 85s/epoch - 48ms/step
Epoch 14/50
1766/1766 - 85s - loss: 2.9263 - accuracy100: 0.5088 - val_loss: 3.7259 - val_accuracy100: 0.3407 - 85s/epoch - 48ms/step
Epoch 15/50
1766/1766 - 84s - loss: 2.9152 - accuracy100: 0.5114 - val_loss: 3.7087 - val_accuracy100: 0.3594 - 84s/epoch - 48ms/step
testing model: results/AAL/W6/deepLOB_L2/h100
Evaluating performance on  test set...
6203/6203 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1354187
{'0': {'precision': 0.30362295246558, 'recall': 0.6717410033111552, 'f1-score': 0.41821514012193056, 'support': 481705}, '1': {'precision': 0.39511763839088365, 'recall': 0.26402040166600477, 'f1-score': 0.3165319288332405, 'support': 609362}, '2': {'precision': 0.3321735197153817, 'recall': 0.076864858989507, 'f1-score': 0.1248414431614599, 'support': 496807}, 'accuracy': 0.32915206118369594, 'macro avg': {'precision': 0.3436380368572818, 'recall': 0.3375420879888889, 'f1-score': 0.28652950403887695, 'support': 1587874}, 'weighted avg': {'precision': 0.34766769812454734, 'recall': 0.32915206118369594, 'f1-score': 0.28740375882647556, 'support': 1587874}}
[[323581 121097  37027]
 [408731 160884  39747]
 [333421 125199  38187]]
Evaluating performance on  train set...
1766/1766 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.122128
{'0': {'precision': 0.3256402175406273, 'recall': 0.277716900641622, 'f1-score': 0.29977533773730886, 'support': 145101}, '1': {'precision': 0.42886373463462846, 'recall': 0.33948413911130126, 'f1-score': 0.3789753072099672, 'support': 163610}, '2': {'precision': 0.36171829398385763, 'recall': 0.5017099385817979, 'f1-score': 0.4203653672970539, 'support': 143280}, 'accuracy': 0.3710803976185367, 'macro avg': {'precision': 0.37207408205303777, 'recall': 0.37297032611157377, 'f1-score': 0.3663720040814433, 'support': 451991}, 'weighted avg': {'precision': 0.3744413362012545, 'recall': 0.3710803976185367, 'f1-score': 0.36667057777691564, 'support': 451991}}
[[40297 38755 66049]
 [47269 55543 60798]
 [36181 35214 71885]]
Evaluating performance on  val set...
579/579 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1361763
{'0': {'precision': 0.300695635601296, 'recall': 0.42525043798571494, 'f1-score': 0.35228773979867145, 'support': 44522}, '1': {'precision': 0.4326698262243286, 'recall': 0.22619008291764395, 'f1-score': 0.297075668170774, 'support': 60542}, '2': {'precision': 0.30493097384862883, 'recall': 0.37902250744047616, 'f1-score': 0.33796363485580405, 'support': 43008}, 'accuracy': 0.3304338429952996, 'macro avg': {'precision': 0.34609881189141783, 'recall': 0.3434876761146117, 'f1-score': 0.32910901427508316, 'support': 148072}, 'weighted avg': {'precision': 0.35588591381757545, 'recall': 0.3304338429952996, 'f1-score': 0.3255527706898662, 'support': 148072}}
[[18933  9446 16143]
 [25834 13694 21014]
 [18197  8510 16301]]
training model: results/AAL/W6/deepLOB_L2/h200
Epoch 1/50
1766/1766 - 89s - loss: 3.2688 - accuracy200: 0.3906 - val_loss: 3.4035 - val_accuracy200: 0.3394 - 89s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 87s - loss: 3.2351 - accuracy200: 0.4083 - val_loss: 3.3366 - val_accuracy200: 0.3399 - 87s/epoch - 49ms/step
Epoch 3/50
1766/1766 - 87s - loss: 3.2124 - accuracy200: 0.4185 - val_loss: 3.3298 - val_accuracy200: 0.3528 - 87s/epoch - 49ms/step
Epoch 4/50
1766/1766 - 84s - loss: 3.1900 - accuracy200: 0.4289 - val_loss: 3.3353 - val_accuracy200: 0.3549 - 84s/epoch - 47ms/step
Epoch 5/50
1766/1766 - 86s - loss: 3.1761 - accuracy200: 0.4338 - val_loss: 3.3784 - val_accuracy200: 0.3416 - 86s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 85s - loss: 3.1641 - accuracy200: 0.4388 - val_loss: 3.4404 - val_accuracy200: 0.3280 - 85s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 85s - loss: 3.1513 - accuracy200: 0.4437 - val_loss: 3.4540 - val_accuracy200: 0.3326 - 85s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 85s - loss: 3.1401 - accuracy200: 0.4475 - val_loss: 3.5023 - val_accuracy200: 0.3304 - 85s/epoch - 48ms/step
Epoch 9/50
1766/1766 - 86s - loss: 3.1279 - accuracy200: 0.4522 - val_loss: 3.5283 - val_accuracy200: 0.3356 - 86s/epoch - 49ms/step
Epoch 10/50
1766/1766 - 85s - loss: 3.1163 - accuracy200: 0.4573 - val_loss: 3.5510 - val_accuracy200: 0.3336 - 85s/epoch - 48ms/step
Epoch 11/50
1766/1766 - 86s - loss: 3.1053 - accuracy200: 0.4606 - val_loss: 3.5606 - val_accuracy200: 0.3407 - 86s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 84s - loss: 3.0931 - accuracy200: 0.4655 - val_loss: 3.4836 - val_accuracy200: 0.3422 - 84s/epoch - 48ms/step
Epoch 13/50
1766/1766 - 85s - loss: 3.0825 - accuracy200: 0.4689 - val_loss: 3.5791 - val_accuracy200: 0.3439 - 85s/epoch - 48ms/step
testing model: results/AAL/W6/deepLOB_L2/h200
Evaluating performance on  test set...
6203/6203 - 122s - 122s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1184018
{'0': {'precision': 0.3164265657079785, 'recall': 0.5542073336859143, 'f1-score': 0.4028465314996203, 'support': 499176}, '1': {'precision': 0.3663438871995303, 'recall': 0.3701205681168248, 'f1-score': 0.36822254401448773, 'support': 564743}, '2': {'precision': 0.3301334041839132, 'recall': 0.09011651763987365, 'f1-score': 0.14158466758323723, 'support': 523955}, 'accuracy': 0.3355977867261508, 'macro avg': {'precision': 0.337634619030474, 'recall': 0.3381481398142043, 'f1-score': 0.30421791436578177, 'support': 1587874}, 'weighted avg': {'precision': 0.33870303376826655, 'recall': 0.3355977867261508, 'f1-score': 0.30432289897422804, 'support': 1587874}}
[[276647 178689  43840]
 [303753 209023  51967]
 [293885 182853  47217]]
Evaluating performance on  train set...
1766/1766 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033477
{'0': {'precision': 0.3799870953866007, 'recall': 0.4475135672536839, 'f1-score': 0.4109951526183712, 'support': 157917}, '1': {'precision': 0.3330827951876224, 'recall': 0.4594853853966821, 'f1-score': 0.3862044433904937, 'support': 141776}, '2': {'precision': 0.3887437528396184, 'recall': 0.17977911725695675, 'f1-score': 0.24585821398105331, 'support': 152298}, 'accuracy': 0.36105586173176013, 'macro avg': {'precision': 0.36727121447128047, 'recall': 0.3622593566357743, 'f1-score': 0.34768593666330605, 'support': 451991}, 'weighted avg': {'precision': 0.3682251739142027, 'recall': 0.36105586173176013, 'f1-score': 0.34757629456129085, 'support': 451991}}
[[70670 64963 22284]
 [55864 65144 20768]
 [59446 65472 27380]]
Evaluating performance on  val set...
579/579 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082761
{'0': {'precision': 0.348464068191538, 'recall': 0.4770933026430028, 'f1-score': 0.40275789186609395, 'support': 49527}, '1': {'precision': 0.3554529307282416, 'recall': 0.394402837997635, 'f1-score': 0.37391629297458895, 'support': 50740}, '2': {'precision': 0.35876142386178694, 'recall': 0.17983474531952726, 'f1-score': 0.23957752758889758, 'support': 47805}, 'accuracy': 0.3527878329461343, 'macro avg': {'precision': 0.3542261409271888, 'recall': 0.35044362865338835, 'f1-score': 0.33875057080986015, 'support': 148072}, 'weighted avg': {'precision': 0.3541834477699093, 'recall': 0.3527878329461343, 'f1-score': 0.3401919777025361, 'support': 148072}}
[[23629 18377  7521]
 [22883 20012  7845]
 [21297 17911  8597]]
training model: results/AAL/W6/deepLOB_L2/h300
Epoch 1/50
1766/1766 - 88s - loss: 3.2896 - accuracy300: 0.3752 - val_loss: 3.3155 - val_accuracy300: 0.3421 - 88s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 85s - loss: 3.2563 - accuracy300: 0.3882 - val_loss: 3.3565 - val_accuracy300: 0.3507 - 85s/epoch - 48ms/step
Epoch 3/50
1766/1766 - 84s - loss: 3.2405 - accuracy300: 0.4011 - val_loss: 3.3523 - val_accuracy300: 0.3514 - 84s/epoch - 47ms/step
Epoch 4/50
1766/1766 - 84s - loss: 3.2298 - accuracy300: 0.4066 - val_loss: 3.3843 - val_accuracy300: 0.3518 - 84s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 85s - loss: 3.2201 - accuracy300: 0.4134 - val_loss: 3.3898 - val_accuracy300: 0.3478 - 85s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 84s - loss: 3.2095 - accuracy300: 0.4171 - val_loss: 3.4378 - val_accuracy300: 0.3468 - 84s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 84s - loss: 3.2012 - accuracy300: 0.4205 - val_loss: 3.4297 - val_accuracy300: 0.3427 - 84s/epoch - 47ms/step
Epoch 8/50
1766/1766 - 85s - loss: 3.1893 - accuracy300: 0.4257 - val_loss: 3.4479 - val_accuracy300: 0.3430 - 85s/epoch - 48ms/step
Epoch 9/50
1766/1766 - 85s - loss: 3.1787 - accuracy300: 0.4301 - val_loss: 3.4775 - val_accuracy300: 0.3331 - 85s/epoch - 48ms/step
Epoch 10/50
1766/1766 - 86s - loss: 3.1694 - accuracy300: 0.4337 - val_loss: 3.6074 - val_accuracy300: 0.3363 - 86s/epoch - 49ms/step
Epoch 11/50
1766/1766 - 87s - loss: 3.1589 - accuracy300: 0.4381 - val_loss: 3.5449 - val_accuracy300: 0.3342 - 87s/epoch - 49ms/step
testing model: results/AAL/W6/deepLOB_L2/h300
Evaluating performance on  test set...
6203/6203 - 121s - 121s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105689
{'0': {'precision': 0.32291924194453087, 'recall': 0.4764423369201775, 'f1-score': 0.38493818651392536, 'support': 509919}, '1': {'precision': 0.33646040214246065, 'recall': 0.4139625857936189, 'f1-score': 0.37120935879410405, 'support': 537336}, '2': {'precision': 0.3452720173834273, 'recall': 0.11139453108381318, 'f1-score': 0.16844419457427437, 'support': 540619}, 'accuracy': 0.33101241030459594, 'macro avg': {'precision': 0.3348838871568063, 'recall': 0.33393315126586987, 'f1-score': 0.3081972466274346, 'support': 1587874}, 'weighted avg': {'precision': 0.33511195242478026, 'recall': 0.33101241030459594, 'f1-score': 0.30658325482534043, 'support': 1587874}}
[[242947 213732  53240]
 [253942 222437  60957]
 [255457 224940  60222]]
Evaluating performance on  train set...
1766/1766 - 35s - 35s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1034627
{'0': {'precision': 0.3399216554543132, 'recall': 0.26105751937477517, 'f1-score': 0.2953150720402463, 'support': 152905}, '1': {'precision': 0.3404391984893195, 'recall': 0.4620149043408729, 'f1-score': 0.3920173955599057, 'support': 152573}, '2': {'precision': 0.34345343602453293, 'recall': 0.2988881532696757, 'f1-score': 0.3196248380563108, 'support': 146513}, 'accuracy': 0.3411550229982455, 'macro avg': {'precision': 0.3412714299893886, 'recall': 0.3406535256617746, 'f1-score': 0.3356524352188209, 'support': 451991}, 'weighted avg': {'precision': 0.3412411836311234, 'recall': 0.3411550229982455, 'f1-score': 0.33583769385058465, 'support': 451991}}
[[39917 70264 42724]
 [41095 70491 40987]
 [36418 66304 43791]]
Evaluating performance on  val set...
579/579 - 12s - 12s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1048372
{'0': {'precision': 0.33081518987341774, 'recall': 0.3333605453283808, 'f1-score': 0.3320829902513901, 'support': 48998}, '1': {'precision': 0.3599190938511327, 'recall': 0.4267979123493745, 'f1-score': 0.39051581867340845, 'support': 52116}, '2': {'precision': 0.3233054177846437, 'recall': 0.25403552110396527, 'f1-score': 0.28451493649752546, 'support': 46958}, 'accuracy': 0.34109082068183044, 'macro avg': {'precision': 0.3380132338363981, 'recall': 0.3380646595939068, 'f1-score': 0.33570458180744134, 'support': 148072}, 'weighted avg': {'precision': 0.3386771433957443, 'recall': 0.34109082068183044, 'f1-score': 0.33756400366289213, 'support': 148072}}
[[16334 20194 12470]
 [17375 22243 12498]
 [15666 19363 11929]]
training model: results/AAL/W6/deepLOB_L2/h500
Epoch 1/50
1766/1766 - 89s - loss: 3.2306 - accuracy500: 0.4015 - val_loss: 3.3944 - val_accuracy500: 0.3476 - 89s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 86s - loss: 3.2141 - accuracy500: 0.4092 - val_loss: 3.3751 - val_accuracy500: 0.2996 - 86s/epoch - 49ms/step
Epoch 3/50
1766/1766 - 85s - loss: 3.1980 - accuracy500: 0.4229 - val_loss: 3.3478 - val_accuracy500: 0.3215 - 85s/epoch - 48ms/step
Epoch 4/50
1766/1766 - 85s - loss: 3.1810 - accuracy500: 0.4317 - val_loss: 3.4059 - val_accuracy500: 0.3215 - 85s/epoch - 48ms/step
Epoch 5/50
1766/1766 - 82s - loss: 3.1698 - accuracy500: 0.4342 - val_loss: 3.4110 - val_accuracy500: 0.3128 - 82s/epoch - 46ms/step
Epoch 6/50
1766/1766 - 84s - loss: 3.1568 - accuracy500: 0.4410 - val_loss: 3.3628 - val_accuracy500: 0.3506 - 84s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 84s - loss: 3.1468 - accuracy500: 0.4447 - val_loss: 3.3853 - val_accuracy500: 0.3417 - 84s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 86s - loss: 3.1380 - accuracy500: 0.4497 - val_loss: 3.4020 - val_accuracy500: 0.3188 - 86s/epoch - 49ms/step
Epoch 9/50
1766/1766 - 85s - loss: 3.1304 - accuracy500: 0.4532 - val_loss: 3.3795 - val_accuracy500: 0.3302 - 85s/epoch - 48ms/step
Epoch 10/50
1766/1766 - 86s - loss: 3.1213 - accuracy500: 0.4570 - val_loss: 3.3593 - val_accuracy500: 0.3377 - 86s/epoch - 49ms/step
Epoch 11/50
1766/1766 - 84s - loss: 3.1123 - accuracy500: 0.4599 - val_loss: 3.3601 - val_accuracy500: 0.3364 - 84s/epoch - 48ms/step
Epoch 12/50
1766/1766 - 85s - loss: 3.1020 - accuracy500: 0.4639 - val_loss: 3.4022 - val_accuracy500: 0.3092 - 85s/epoch - 48ms/step
Epoch 13/50
1766/1766 - 85s - loss: 3.0948 - accuracy500: 0.4667 - val_loss: 3.4017 - val_accuracy500: 0.3414 - 85s/epoch - 48ms/step
testing model: results/AAL/W6/deepLOB_L2/h500
Evaluating performance on  test set...
6203/6203 - 122s - 122s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1095747
{'0': {'precision': 0.21189359399088137, 'recall': 0.8442287472600584, 'f1-score': 0.3387612522152845, 'support': 336686}, '1': {'precision': 0.5524722902606213, 'recall': 0.1420862290483172, 'f1-score': 0.22603913765228156, 'support': 882626}, '2': {'precision': 0.23187660668380464, 'recall': 0.012236747141593545, 'f1-score': 0.023246703710194532, 'support': 368562}, 'accuracy': 0.2608261108878916, 'macro avg': {'precision': 0.3320808303117691, 'recall': 0.33285057448332306, 'f1-score': 0.19601569785925355, 'support': 1587874}, 'weighted avg': {'precision': 0.4058438642880867, 'recall': 0.2608261108878916, 'f1-score': 0.20287002777655821, 'support': 1587874}}
[[284240  48461   3985]
 [746262 125409  10955]
 [310926  53126   4510]]
Evaluating performance on  train set...
1766/1766 - 36s - 36s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1234126
{'0': {'precision': 0.3318516857711387, 'recall': 0.3789856417675413, 'f1-score': 0.3538559927320977, 'support': 156217}, '1': {'precision': 0.31666426379420426, 'recall': 0.20878456827425126, 'f1-score': 0.2516500468519193, 'support': 147281}, '2': {'precision': 0.338366953762466, 'recall': 0.4021401682234179, 'f1-score': 0.36750745446544786, 'support': 148493}, 'accuracy': 0.33113269954490243, 'macro avg': {'precision': 0.32896096777593636, 'recall': 0.3299701260884035, 'f1-score': 0.32433783134982164, 'support': 451991}, 'weighted avg': {'precision': 0.3290433400156951, 'recall': 0.33113269954490243, 'f1-score': 0.3250371724281355, 'support': 451991}}
[[59204 34384 62629]
 [62395 30750 54136]
 [56806 31972 59715]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1126899
{'0': {'precision': 0.29670232961617277, 'recall': 0.536205212096426, 'f1-score': 0.38201919808342905, 'support': 44013}, '1': {'precision': 0.41630773398347554, 'recall': 0.25158797721170845, 'f1-score': 0.3136358534270758, 'support': 61084}, '2': {'precision': 0.271002024291498, 'recall': 0.1993717277486911, 'f1-score': 0.22973280958828815, 'support': 42975}, 'accuracy': 0.32103301096763737, 'macro avg': {'precision': 0.3280040292970488, 'recall': 0.32905497235227515, 'f1-score': 0.3084626203662643, 'support': 148072}, 'weighted avg': {'precision': 0.33858402162441487, 'recall': 0.32103301096763737, 'f1-score': 0.3096109387868209, 'support': 148072}}
[[23600 11060  9353]
 [32021 15368 13695]
 [23920 10487  8568]]
training model: results/AAL/W6/deepLOB_L2/h1000
Epoch 1/50
1766/1766 - 89s - loss: 3.1993 - accuracy1000: 0.4305 - val_loss: 3.3924 - val_accuracy1000: 0.3246 - 89s/epoch - 50ms/step
Epoch 2/50
1766/1766 - 87s - loss: 3.1498 - accuracy1000: 0.4547 - val_loss: 3.3775 - val_accuracy1000: 0.3088 - 87s/epoch - 49ms/step
Epoch 3/50
1766/1766 - 89s - loss: 3.1234 - accuracy1000: 0.4630 - val_loss: 3.2962 - val_accuracy1000: 0.4001 - 89s/epoch - 50ms/step
Epoch 4/50
1766/1766 - 86s - loss: 3.1027 - accuracy1000: 0.4693 - val_loss: 3.3339 - val_accuracy1000: 0.3367 - 86s/epoch - 49ms/step
Epoch 5/50
1766/1766 - 85s - loss: 3.0890 - accuracy1000: 0.4732 - val_loss: 3.2862 - val_accuracy1000: 0.3807 - 85s/epoch - 48ms/step
Epoch 6/50
1766/1766 - 85s - loss: 3.0753 - accuracy1000: 0.4790 - val_loss: 3.3413 - val_accuracy1000: 0.3326 - 85s/epoch - 48ms/step
Epoch 7/50
1766/1766 - 85s - loss: 3.0679 - accuracy1000: 0.4809 - val_loss: 3.2828 - val_accuracy1000: 0.3847 - 85s/epoch - 48ms/step
Epoch 8/50
1766/1766 - 86s - loss: 3.0576 - accuracy1000: 0.4830 - val_loss: 3.2634 - val_accuracy1000: 0.4019 - 86s/epoch - 49ms/step
Epoch 9/50
1766/1766 - 86s - loss: 3.0472 - accuracy1000: 0.4875 - val_loss: 3.2727 - val_accuracy1000: 0.4006 - 86s/epoch - 49ms/step
Epoch 10/50
1766/1766 - 86s - loss: 3.0320 - accuracy1000: 0.4920 - val_loss: 3.2943 - val_accuracy1000: 0.3857 - 86s/epoch - 49ms/step
Epoch 11/50
1766/1766 - 87s - loss: 3.0218 - accuracy1000: 0.4945 - val_loss: 3.3091 - val_accuracy1000: 0.3889 - 87s/epoch - 49ms/step
Epoch 12/50
1766/1766 - 86s - loss: 3.0098 - accuracy1000: 0.4994 - val_loss: 3.3121 - val_accuracy1000: 0.3923 - 86s/epoch - 49ms/step
Epoch 13/50
1766/1766 - 85s - loss: 2.9937 - accuracy1000: 0.5051 - val_loss: 3.3911 - val_accuracy1000: 0.3292 - 85s/epoch - 48ms/step
Epoch 14/50
1766/1766 - 86s - loss: 2.9821 - accuracy1000: 0.5086 - val_loss: 3.3162 - val_accuracy1000: 0.3890 - 86s/epoch - 49ms/step
Epoch 15/50
1766/1766 - 86s - loss: 2.9650 - accuracy1000: 0.5122 - val_loss: 3.4386 - val_accuracy1000: 0.3864 - 86s/epoch - 49ms/step
Epoch 16/50
1766/1766 - 85s - loss: 2.9621 - accuracy1000: 0.5138 - val_loss: 3.3670 - val_accuracy1000: 0.3446 - 85s/epoch - 48ms/step
Epoch 17/50
1766/1766 - 86s - loss: 2.9448 - accuracy1000: 0.5178 - val_loss: 3.4232 - val_accuracy1000: 0.3846 - 86s/epoch - 49ms/step
Epoch 18/50
1766/1766 - 88s - loss: 2.9304 - accuracy1000: 0.5215 - val_loss: 3.3938 - val_accuracy1000: 0.3365 - 88s/epoch - 50ms/step
testing model: results/AAL/W6/deepLOB_L2/h1000
Evaluating performance on  test set...
6203/6203 - 125s - 125s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0799547
{'0': {'precision': 0.2613920881321983, 'recall': 0.013637983041588485, 'f1-score': 0.02592342611800983, 'support': 421030}, '1': {'precision': 0.4358748954518904, 'recall': 0.9745781464913156, 'f1-score': 0.6023513510614333, 'support': 691413}, '2': {'precision': 0.3203125, 'recall': 0.013453056279460111, 'f1-score': 0.02582161045944784, 'support': 475431}, 'accuracy': 0.43200782933658466, 'macro avg': {'precision': 0.3391931611946963, 'recall': 0.33388972860412136, 'f1-score': 0.21803212921296367, 'support': 1587874}, 'weighted avg': {'precision': 0.35500925901102814, 'recall': 0.43200782933658466, 'f1-score': 0.27688877635898707, 'support': 1587874}}
[[  5742 409684   5604]
 [  9609 673836   7968]
 [  6616 462419   6396]]
Evaluating performance on  train set...
1766/1766 - 36s - 36s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1065472
{'0': {'precision': 0.36382474837181766, 'recall': 0.11103725549668618, 'f1-score': 0.1701467003545135, 'support': 154957}, '1': {'precision': 0.4225256205100269, 'recall': 0.49540918163672654, 'f1-score': 0.4560739420444313, 'support': 150300}, '2': {'precision': 0.36008631216817744, 'recall': 0.5606744176537135, 'f1-score': 0.43853126407556364, 'support': 146734}, 'accuracy': 0.3848218216734404, 'macro avg': {'precision': 0.3821455603500073, 'recall': 0.389040284929042, 'f1-score': 0.3549173021581695, 'support': 451991}, 'weighted avg': {'precision': 0.38213083275063914, 'recall': 0.3848218216734404, 'f1-score': 0.35235387925639255, 'support': 451991}}
[[17206 50802 86949]
 [16586 74460 59254]
 [13500 50964 82270]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.088335
{'0': {'precision': 0.329583532790809, 'recall': 0.0308481562794032, 'f1-score': 0.05641592920353982, 'support': 44638}, '1': {'precision': 0.44800041766732795, 'recall': 0.7115257048092869, 'f1-score': 0.549817389632857, 'support': 60300}, '2': {'precision': 0.31551824453495136, 'recall': 0.35201928872814947, 'f1-score': 0.3327708255714567, 'support': 43134}, 'accuracy': 0.4016019233886218, 'macro avg': {'precision': 0.36436739833102944, 'recall': 0.36479771660561316, 'f1-score': 0.31300138146928447, 'support': 148072}, 'weighted avg': {'precision': 0.37370967422488116, 'recall': 0.4016019233886218, 'f1-score': 0.3378492870552711, 'support': 148072}}
[[ 1377 26082 17179]
 [ 1634 42905 15761]
 [ 1167 26783 15184]]
training model: results/AAL/W6/deepOF_L2/h10
Epoch 1/50
1766/1766 - 59s - loss: 2.7548 - accuracy10: 0.5131 - val_loss: 2.4855 - val_accuracy10: 0.7484 - 59s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 55s - loss: 2.4319 - accuracy10: 0.6090 - val_loss: 2.3620 - val_accuracy10: 0.7637 - 55s/epoch - 31ms/step
Epoch 3/50
1766/1766 - 55s - loss: 2.3407 - accuracy10: 0.6324 - val_loss: 2.2989 - val_accuracy10: 0.7610 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 55s - loss: 2.3037 - accuracy10: 0.6366 - val_loss: 2.3173 - val_accuracy10: 0.7546 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 56s - loss: 2.2805 - accuracy10: 0.6398 - val_loss: 2.3054 - val_accuracy10: 0.7574 - 56s/epoch - 32ms/step
Epoch 6/50
1766/1766 - 56s - loss: 2.2627 - accuracy10: 0.6420 - val_loss: 2.2976 - val_accuracy10: 0.7556 - 56s/epoch - 31ms/step
Epoch 7/50
1766/1766 - 55s - loss: 2.2488 - accuracy10: 0.6430 - val_loss: 2.2889 - val_accuracy10: 0.7574 - 55s/epoch - 31ms/step
Epoch 8/50
1766/1766 - 55s - loss: 2.2373 - accuracy10: 0.6450 - val_loss: 2.3021 - val_accuracy10: 0.7560 - 55s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 56s - loss: 2.2279 - accuracy10: 0.6455 - val_loss: 2.2872 - val_accuracy10: 0.7493 - 56s/epoch - 32ms/step
Epoch 10/50
1766/1766 - 56s - loss: 2.2179 - accuracy10: 0.6476 - val_loss: 2.3045 - val_accuracy10: 0.7482 - 56s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 56s - loss: 2.2101 - accuracy10: 0.6479 - val_loss: 2.2942 - val_accuracy10: 0.7508 - 56s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 57s - loss: 2.2035 - accuracy10: 0.6489 - val_loss: 2.2955 - val_accuracy10: 0.7548 - 57s/epoch - 32ms/step
Epoch 13/50
1766/1766 - 56s - loss: 2.1957 - accuracy10: 0.6491 - val_loss: 2.3254 - val_accuracy10: 0.7517 - 56s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 59s - loss: 2.1886 - accuracy10: 0.6504 - val_loss: 2.3081 - val_accuracy10: 0.7516 - 59s/epoch - 33ms/step
Epoch 15/50
1766/1766 - 60s - loss: 2.1833 - accuracy10: 0.6504 - val_loss: 2.3321 - val_accuracy10: 0.7514 - 60s/epoch - 34ms/step
Epoch 16/50
1766/1766 - 58s - loss: 2.1766 - accuracy10: 0.6516 - val_loss: 2.3134 - val_accuracy10: 0.7521 - 58s/epoch - 33ms/step
Epoch 17/50
1766/1766 - 57s - loss: 2.1700 - accuracy10: 0.6518 - val_loss: 2.3142 - val_accuracy10: 0.7510 - 57s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 58s - loss: 2.1630 - accuracy10: 0.6515 - val_loss: 2.3265 - val_accuracy10: 0.7514 - 58s/epoch - 33ms/step
Epoch 19/50
1766/1766 - 56s - loss: 2.1591 - accuracy10: 0.6525 - val_loss: 2.3276 - val_accuracy10: 0.7441 - 56s/epoch - 32ms/step
testing model: results/AAL/W6/deepOF_L2/h10
Evaluating performance on  test set...
6203/6203 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.638178
{'0': {'precision': 0.4317345346406383, 'recall': 0.5068741419668342, 'f1-score': 0.46629671610193546, 'support': 202498}, '1': {'precision': 0.8698904480936894, 'recall': 0.823255030261157, 'f1-score': 0.8459304842075408, 'support': 1181052}, '2': {'precision': 0.43605874531504824, 'recall': 0.4959744321379803, 'f1-score': 0.4640907508838777, 'support': 204319}, 'accuracy': 0.7407947381049697, 'macro avg': {'precision': 0.579227909349792, 'recall': 0.6087012014553239, 'f1-score': 0.5921059837311179, 'support': 1587869}, 'weighted avg': {'precision': 0.7581899514894702, 'recall': 0.7407947381049697, 'f1-score': 0.7483832739233132, 'support': 1587869}}
[[102641  69424  30433]
 [108122 972307 100623]
 [ 26978  76004 101337]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6661288
{'0': {'precision': 0.41902655449793963, 'recall': 0.5422885572139303, 'f1-score': 0.47275508915773606, 'support': 58692}, '1': {'precision': 0.8730009469415767, 'recall': 0.7926389042835873, 'f1-score': 0.8308813138846582, 'support': 333809}, '2': {'precision': 0.4309879234006388, 'recall': 0.5285267616998386, 'f1-score': 0.47479971911597035, 'support': 59488}, 'accuracy': 0.7253694227071897, 'macro avg': {'precision': 0.5743384749467184, 'recall': 0.621151407732452, 'f1-score': 0.5928120407194549, 'support': 451989}, 'weighted avg': {'precision': 0.7558761147317105, 'recall': 0.7253694227071897, 'f1-score': 0.7375123905452138, 'support': 451989}}
[[ 31828  18170   8694]
 [ 36403 264590  32816]
 [  7726  20321  31441]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.62363994
{'0': {'precision': 0.40029469548133595, 'recall': 0.5659067237588242, 'f1-score': 0.4689073212830225, 'support': 17282}, '1': {'precision': 0.892733297372274, 'recall': 0.811565775532185, 'f1-score': 0.8502167282067747, 'support': 114199}, '2': {'precision': 0.42630145278450365, 'recall': 0.5093725513832801, 'f1-score': 0.46414938898805436, 'support': 16591}, 'accuracy': 0.7490342536063537, 'macro avg': {'precision': 0.5731098152127045, 'recall': 0.6289483502247631, 'f1-score': 0.5944244794926171, 'support': 148072}, 'weighted avg': {'precision': 0.782996853943166, 'recall': 0.7490342536063537, 'f1-score': 0.7624551500864408, 'support': 148072}}
[[ 9780  5198  2304]
 [12450 92680  9069]
 [ 2202  5938  8451]]
training model: results/AAL/W6/deepOF_L2/h20
Epoch 1/50
1766/1766 - 60s - loss: 2.8295 - accuracy20: 0.4996 - val_loss: 2.6508 - val_accuracy20: 0.7068 - 60s/epoch - 34ms/step
Epoch 2/50
1766/1766 - 56s - loss: 2.5396 - accuracy20: 0.5852 - val_loss: 2.5119 - val_accuracy20: 0.7250 - 56s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 54s - loss: 2.4558 - accuracy20: 0.6128 - val_loss: 2.4535 - val_accuracy20: 0.7237 - 54s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 55s - loss: 2.4210 - accuracy20: 0.6197 - val_loss: 2.4498 - val_accuracy20: 0.7190 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 55s - loss: 2.3979 - accuracy20: 0.6229 - val_loss: 2.4510 - val_accuracy20: 0.7144 - 55s/epoch - 31ms/step
Epoch 6/50
1766/1766 - 56s - loss: 2.3806 - accuracy20: 0.6258 - val_loss: 2.4423 - val_accuracy20: 0.7139 - 56s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 57s - loss: 2.3682 - accuracy20: 0.6270 - val_loss: 2.4359 - val_accuracy20: 0.7187 - 57s/epoch - 32ms/step
Epoch 8/50
1766/1766 - 58s - loss: 2.3576 - accuracy20: 0.6288 - val_loss: 2.4620 - val_accuracy20: 0.7143 - 58s/epoch - 33ms/step
Epoch 9/50
1766/1766 - 57s - loss: 2.3482 - accuracy20: 0.6298 - val_loss: 2.4176 - val_accuracy20: 0.7118 - 57s/epoch - 32ms/step
Epoch 10/50
1766/1766 - 59s - loss: 2.3407 - accuracy20: 0.6315 - val_loss: 2.4460 - val_accuracy20: 0.7132 - 59s/epoch - 33ms/step
Epoch 11/50
1766/1766 - 59s - loss: 2.3323 - accuracy20: 0.6324 - val_loss: 2.4301 - val_accuracy20: 0.7143 - 59s/epoch - 33ms/step
Epoch 12/50
1766/1766 - 58s - loss: 2.3247 - accuracy20: 0.6337 - val_loss: 2.4607 - val_accuracy20: 0.7120 - 58s/epoch - 33ms/step
Epoch 13/50
1766/1766 - 57s - loss: 2.3178 - accuracy20: 0.6346 - val_loss: 2.4639 - val_accuracy20: 0.7118 - 57s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 56s - loss: 2.3113 - accuracy20: 0.6356 - val_loss: 2.4501 - val_accuracy20: 0.7118 - 56s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 55s - loss: 2.3060 - accuracy20: 0.6358 - val_loss: 2.4690 - val_accuracy20: 0.7096 - 55s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 55s - loss: 2.2999 - accuracy20: 0.6368 - val_loss: 2.4816 - val_accuracy20: 0.7126 - 55s/epoch - 31ms/step
Epoch 17/50
1766/1766 - 55s - loss: 2.2948 - accuracy20: 0.6373 - val_loss: 2.4885 - val_accuracy20: 0.7103 - 55s/epoch - 31ms/step
Epoch 18/50
1766/1766 - 57s - loss: 2.2874 - accuracy20: 0.6391 - val_loss: 2.4851 - val_accuracy20: 0.7134 - 57s/epoch - 32ms/step
Epoch 19/50
1766/1766 - 57s - loss: 2.2823 - accuracy20: 0.6385 - val_loss: 2.4839 - val_accuracy20: 0.7061 - 57s/epoch - 32ms/step
testing model: results/AAL/W6/deepOF_L2/h20
Evaluating performance on  test set...
6203/6203 - 103s - 103s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7111626
{'0': {'precision': 0.49712653406686413, 'recall': 0.44312626369315267, 'f1-score': 0.4685757365435703, 'support': 265096}, '1': {'precision': 0.7924547712210688, 'recall': 0.8329916895667591, 'f1-score': 0.8122177564245748, 'support': 1054217}, '2': {'precision': 0.4869877785765636, 'recall': 0.4414163154053531, 'f1-score': 0.46308359099263446, 'support': 268556}, 'accuracy': 0.7016762717831256, 'macro avg': {'precision': 0.5921896946214988, 'recall': 0.5725114228884216, 'f1-score': 0.5812923613202599, 'support': 1587869}, 'weighted avg': {'precision': 0.691485907899681, 'recall': 0.7016762717831256, 'f1-score': 0.6957974472969862, 'support': 1587869}}
[[117471 109481  38144]
 [ 89327 878154  86736]
 [ 29502 120509 118545]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.718593
{'0': {'precision': 0.5109738208079441, 'recall': 0.4657675148180053, 'f1-score': 0.48732453101773693, 'support': 77777}, '1': {'precision': 0.7954283607539518, 'recall': 0.8166244791332236, 'f1-score': 0.8058870710887512, 'support': 295901}, '2': {'precision': 0.49193475364456, 'recall': 0.4856278172925898, 'f1-score': 0.48876094025112776, 'support': 78311}, 'accuracy': 0.6989019644283379, 'macro avg': {'precision': 0.5994456450688187, 'recall': 0.589339937081273, 'f1-score': 0.5939908474525386, 'support': 451989}, 'weighted avg': {'precision': 0.6938973309728635, 'recall': 0.6989019644283379, 'f1-score': 0.6961248797276154, 'support': 451989}}
[[ 36226  30249  11302]
 [ 26286 241640  27975]
 [  8384  31897  38030]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68818
{'0': {'precision': 0.48560536348100436, 'recall': 0.484437838783004, 'f1-score': 0.48502089852725555, 'support': 22876}, '1': {'precision': 0.8242657204809777, 'recall': 0.8115399171284121, 'f1-score': 0.817853318403411, 'support': 103051}, '2': {'precision': 0.4455466352822496, 'recall': 0.4786633551591781, 'f1-score': 0.4615116684082201, 'support': 22145}, 'accuracy': 0.7112215678858933, 'macro avg': {'precision': 0.5851392397480772, 'recall': 0.5915470370235314, 'f1-score': 0.5881286284462955, 'support': 148072}, 'weighted avg': {'precision': 0.715305697867268, 'recall': 0.7112215678858933, 'f1-score': 0.7131403390674769, 'support': 148072}}
[[11082  8729  3065]
 [ 9295 83630 10126]
 [ 2444  9101 10600]]
training model: results/AAL/W6/deepOF_L2/h30
Epoch 1/50
1766/1766 - 60s - loss: 2.8931 - accuracy30: 0.4917 - val_loss: 2.7455 - val_accuracy30: 0.6533 - 60s/epoch - 34ms/step
Epoch 2/50
1766/1766 - 57s - loss: 2.6392 - accuracy30: 0.5641 - val_loss: 2.6572 - val_accuracy30: 0.6745 - 57s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 58s - loss: 2.5595 - accuracy30: 0.5904 - val_loss: 2.6069 - val_accuracy30: 0.6847 - 58s/epoch - 33ms/step
Epoch 4/50
1766/1766 - 57s - loss: 2.5275 - accuracy30: 0.5978 - val_loss: 2.5849 - val_accuracy30: 0.6875 - 57s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 56s - loss: 2.5072 - accuracy30: 0.6014 - val_loss: 2.5744 - val_accuracy30: 0.6911 - 56s/epoch - 32ms/step
Epoch 6/50
1766/1766 - 57s - loss: 2.4915 - accuracy30: 0.6046 - val_loss: 2.5966 - val_accuracy30: 0.6897 - 57s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 56s - loss: 2.4833 - accuracy30: 0.6064 - val_loss: 2.5977 - val_accuracy30: 0.6918 - 56s/epoch - 32ms/step
Epoch 8/50
1766/1766 - 57s - loss: 2.4741 - accuracy30: 0.6073 - val_loss: 2.5852 - val_accuracy30: 0.6936 - 57s/epoch - 32ms/step
Epoch 9/50
1766/1766 - 55s - loss: 2.4642 - accuracy30: 0.6091 - val_loss: 2.5838 - val_accuracy30: 0.6901 - 55s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 56s - loss: 2.4543 - accuracy30: 0.6099 - val_loss: 2.5886 - val_accuracy30: 0.6896 - 56s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 56s - loss: 2.4473 - accuracy30: 0.6113 - val_loss: 2.5864 - val_accuracy30: 0.6883 - 56s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 57s - loss: 2.4409 - accuracy30: 0.6126 - val_loss: 2.5905 - val_accuracy30: 0.6887 - 57s/epoch - 32ms/step
Epoch 13/50
1766/1766 - 58s - loss: 2.4352 - accuracy30: 0.6132 - val_loss: 2.6000 - val_accuracy30: 0.6869 - 58s/epoch - 33ms/step
Epoch 14/50
1766/1766 - 58s - loss: 2.4273 - accuracy30: 0.6146 - val_loss: 2.5942 - val_accuracy30: 0.6834 - 58s/epoch - 33ms/step
Epoch 15/50
1766/1766 - 55s - loss: 2.4212 - accuracy30: 0.6153 - val_loss: 2.5981 - val_accuracy30: 0.6819 - 55s/epoch - 31ms/step
testing model: results/AAL/W6/deepOF_L2/h30
Evaluating performance on  test set...
6203/6203 - 96s - 96s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77821875
{'0': {'precision': 0.5481756878515133, 'recall': 0.37092918408799924, 'f1-score': 0.44246171865580375, 'support': 311639}, '1': {'precision': 0.7208236458225835, 'recall': 0.8661392543562576, 'f1-score': 0.7868282932698338, 'support': 959654}, '2': {'precision': 0.5276445206764399, 'recall': 0.37314262609926213, 'f1-score': 0.4371435866882288, 'support': 316576}, 'accuracy': 0.6706585996703758, 'macro avg': {'precision': 0.5988812847835122, 'recall': 0.5367370215145063, 'f1-score': 0.5554778662046221, 'support': 1587869}, 'weighted avg': {'precision': 0.6484249078307139, 'recall': 0.6706585996703758, 'f1-score': 0.6495248755339122, 'support': 1587869}}
[[115596 155064  40979]
 [ 63689 831194  64771]
 [ 31589 166859 118128]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7832627
{'0': {'precision': 0.5559983446500008, 'recall': 0.3946709896422665, 'f1-score': 0.4616461455251185, 'support': 91912}, '1': {'precision': 0.7213913574513833, 'recall': 0.8464825686635291, 'f1-score': 0.7789468261395931, 'support': 267937}, '2': {'precision': 0.5282385138497263, 'recall': 0.414771000651183, 'f1-score': 0.46467827440299597, 'support': 92140}, 'accuracy': 0.6666002933699714, 'macro avg': {'precision': 0.6018760719837034, 'recall': 0.5519748529856595, 'f1-score': 0.568423748689236, 'support': 451989}, 'weighted avg': {'precision': 0.6483835948685387, 'recall': 0.6666002933699714, 'f1-score': 0.6503586425474092, 'support': 451989}}
[[ 36275  43156  12481]
 [ 19483 226804  21650]
 [  9485  44438  38217]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.74002934
{'0': {'precision': 0.5372340425531915, 'recall': 0.4129129682147987, 'f1-score': 0.4669401695162332, 'support': 27151}, '1': {'precision': 0.7589395225964713, 'recall': 0.8500924702774109, 'f1-score': 0.8019340527876779, 'support': 94625}, '2': {'precision': 0.5031582916941643, 'recall': 0.4059172497718284, 'f1-score': 0.4493369816880657, 'support': 26296}, 'accuracy': 0.6910489491598681, 'macro avg': {'precision': 0.599777285614609, 'recall': 0.5563075627546793, 'f1-score': 0.5727370679973256, 'support': 148072}, 'weighted avg': {'precision': 0.6728628252028915, 'recall': 0.6910489491598681, 'f1-score': 0.6778909419609288, 'support': 148072}}
[[11211 12559  3381]
 [ 7026 80440  7159]
 [ 2631 12991 10674]]
training model: results/AAL/W6/deepOF_L2/h50
Epoch 1/50
1766/1766 - 58s - loss: 3.0051 - accuracy50: 0.4734 - val_loss: 2.9453 - val_accuracy50: 0.5794 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 56s - loss: 2.7999 - accuracy50: 0.5330 - val_loss: 2.8668 - val_accuracy50: 0.6017 - 56s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 57s - loss: 2.7356 - accuracy50: 0.5527 - val_loss: 2.8448 - val_accuracy50: 0.6093 - 57s/epoch - 32ms/step
Epoch 4/50
1766/1766 - 55s - loss: 2.7044 - accuracy50: 0.5613 - val_loss: 2.8062 - val_accuracy50: 0.6131 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 53s - loss: 2.6853 - accuracy50: 0.5656 - val_loss: 2.8155 - val_accuracy50: 0.6123 - 53s/epoch - 30ms/step
Epoch 6/50
1766/1766 - 54s - loss: 2.6711 - accuracy50: 0.5687 - val_loss: 2.8214 - val_accuracy50: 0.6154 - 54s/epoch - 30ms/step
Epoch 7/50
1766/1766 - 53s - loss: 2.6613 - accuracy50: 0.5703 - val_loss: 2.8063 - val_accuracy50: 0.6154 - 53s/epoch - 30ms/step
Epoch 8/50
1766/1766 - 54s - loss: 2.6517 - accuracy50: 0.5726 - val_loss: 2.8109 - val_accuracy50: 0.6175 - 54s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 56s - loss: 2.6433 - accuracy50: 0.5754 - val_loss: 2.8205 - val_accuracy50: 0.6195 - 56s/epoch - 32ms/step
Epoch 10/50
1766/1766 - 55s - loss: 2.6338 - accuracy50: 0.5765 - val_loss: 2.7930 - val_accuracy50: 0.6191 - 55s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 54s - loss: 2.6276 - accuracy50: 0.5778 - val_loss: 2.8204 - val_accuracy50: 0.6193 - 54s/epoch - 30ms/step
Epoch 12/50
1766/1766 - 54s - loss: 2.6199 - accuracy50: 0.5793 - val_loss: 2.8236 - val_accuracy50: 0.6209 - 54s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 54s - loss: 2.6132 - accuracy50: 0.5809 - val_loss: 2.8175 - val_accuracy50: 0.6211 - 54s/epoch - 31ms/step
Epoch 14/50
1766/1766 - 56s - loss: 2.6075 - accuracy50: 0.5816 - val_loss: 2.8198 - val_accuracy50: 0.6207 - 56s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 56s - loss: 2.6009 - accuracy50: 0.5829 - val_loss: 2.8319 - val_accuracy50: 0.6218 - 56s/epoch - 32ms/step
Epoch 16/50
1766/1766 - 56s - loss: 2.5940 - accuracy50: 0.5844 - val_loss: 2.8239 - val_accuracy50: 0.6206 - 56s/epoch - 32ms/step
Epoch 17/50
1766/1766 - 58s - loss: 2.5885 - accuracy50: 0.5853 - val_loss: 2.8480 - val_accuracy50: 0.6189 - 58s/epoch - 33ms/step
Epoch 18/50
1766/1766 - 57s - loss: 2.5826 - accuracy50: 0.5863 - val_loss: 2.8596 - val_accuracy50: 0.6182 - 57s/epoch - 32ms/step
Epoch 19/50
1766/1766 - 56s - loss: 2.5765 - accuracy50: 0.5883 - val_loss: 2.8707 - val_accuracy50: 0.6146 - 56s/epoch - 32ms/step
Epoch 20/50
1766/1766 - 55s - loss: 2.5705 - accuracy50: 0.5886 - val_loss: 2.8773 - val_accuracy50: 0.6142 - 55s/epoch - 31ms/step
testing model: results/AAL/W6/deepOF_L2/h50
Evaluating performance on  test set...
6203/6203 - 101s - 101s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90436846
{'0': {'precision': 0.5590164155186577, 'recall': 0.32662096169279753, 'f1-score': 0.4123278532206078, 'support': 381286}, '1': {'precision': 0.6087958272940271, 'recall': 0.8608741965105602, 'f1-score': 0.7132167223551036, 'support': 816750}, '2': {'precision': 0.5499338592868223, 'recall': 0.2964679747481614, 'f1-score': 0.38524911207001433, 'support': 389833}, 'accuracy': 0.5940212952076022, 'macro avg': {'precision': 0.572582034033169, 'recall': 0.49465437765050635, 'f1-score': 0.5035978958819086, 'support': 1587869}, 'weighted avg': {'precision': 0.582391551895782, 'recall': 0.5940212952076022, 'f1-score': 0.5604476269340817, 'support': 1587869}}
[[124536 215484  41266]
 [ 60312 703119  53319]
 [ 37929 236331 115573]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89213645
{'0': {'precision': 0.572993528587631, 'recall': 0.378849767536237, 'f1-score': 0.45612227556612994, 'support': 113351}, '1': {'precision': 0.6101045509859555, 'recall': 0.8380524616912599, 'f1-score': 0.7061383763872102, 'support': 225536}, '2': {'precision': 0.5648766414347962, 'recall': 0.3358384467118177, 'f1-score': 0.42123707338711913, 'support': 113102}, 'accuracy': 0.5972224987776251, 'macro avg': {'precision': 0.5826582403361277, 'recall': 0.5175802253131049, 'f1-score': 0.5278325751134864, 'support': 451989}, 'weighted avg': {'precision': 0.5894802912674054, 'recall': 0.5972224987776251, 'f1-score': 0.5721473230295255, 'support': 451989}}
[[ 42943  57999  12409]
 [ 19675 189011  16850]
 [ 12327  62791  37984]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8506115
{'0': {'precision': 0.5485940429077275, 'recall': 0.3872210297274251, 'f1-score': 0.45399386355017757, 'support': 34009}, '1': {'precision': 0.6543309458789687, 'recall': 0.8291974039089152, 'f1-score': 0.7314582450651285, 'support': 81199}, '2': {'precision': 0.5263605442176871, 'recall': 0.3390335929892892, 'f1-score': 0.41242226828546047, 'support': 32864}, 'accuracy': 0.618894861959047, 'macro avg': {'precision': 0.5764285110014611, 'recall': 0.5184840088752097, 'f1-score': 0.5326247923002555, 'support': 148072}, 'weighted avg': {'precision': 0.6016428913288491, 'recall': 0.618894861959047, 'f1-score': 0.5969217729986407, 'support': 148072}}
[[13169 17313  3527]
 [ 7370 67330  6499]
 [ 3466 18256 11142]]
training model: results/AAL/W6/deepOF_L2/h100
Epoch 1/50
1766/1766 - 60s - loss: 3.1342 - accuracy100: 0.4430 - val_loss: 3.1629 - val_accuracy100: 0.4560 - 60s/epoch - 34ms/step
Epoch 2/50
1766/1766 - 57s - loss: 3.0127 - accuracy100: 0.4801 - val_loss: 3.1272 - val_accuracy100: 0.4748 - 57s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 57s - loss: 2.9674 - accuracy100: 0.4912 - val_loss: 3.0831 - val_accuracy100: 0.4827 - 57s/epoch - 32ms/step
Epoch 4/50
1766/1766 - 56s - loss: 2.9442 - accuracy100: 0.4972 - val_loss: 3.0771 - val_accuracy100: 0.4871 - 56s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 54s - loss: 2.9308 - accuracy100: 0.5007 - val_loss: 3.0610 - val_accuracy100: 0.4879 - 54s/epoch - 31ms/step
Epoch 6/50
1766/1766 - 55s - loss: 2.9196 - accuracy100: 0.5033 - val_loss: 3.0632 - val_accuracy100: 0.4882 - 55s/epoch - 31ms/step
Epoch 7/50
1766/1766 - 56s - loss: 2.9111 - accuracy100: 0.5055 - val_loss: 3.0616 - val_accuracy100: 0.4891 - 56s/epoch - 32ms/step
Epoch 8/50
1766/1766 - 56s - loss: 2.9041 - accuracy100: 0.5075 - val_loss: 3.0607 - val_accuracy100: 0.4897 - 56s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 55s - loss: 2.8977 - accuracy100: 0.5092 - val_loss: 3.0729 - val_accuracy100: 0.4903 - 55s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 56s - loss: 2.8915 - accuracy100: 0.5109 - val_loss: 3.0637 - val_accuracy100: 0.4912 - 56s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 56s - loss: 2.8850 - accuracy100: 0.5123 - val_loss: 3.0787 - val_accuracy100: 0.4879 - 56s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 56s - loss: 2.8791 - accuracy100: 0.5141 - val_loss: 3.0920 - val_accuracy100: 0.4904 - 56s/epoch - 32ms/step
Epoch 13/50
1766/1766 - 56s - loss: 2.8732 - accuracy100: 0.5159 - val_loss: 3.0854 - val_accuracy100: 0.4889 - 56s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 55s - loss: 2.8680 - accuracy100: 0.5177 - val_loss: 3.0716 - val_accuracy100: 0.4926 - 55s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 55s - loss: 2.8603 - accuracy100: 0.5196 - val_loss: 3.0820 - val_accuracy100: 0.4948 - 55s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 56s - loss: 2.8554 - accuracy100: 0.5216 - val_loss: 3.1058 - val_accuracy100: 0.4933 - 56s/epoch - 32ms/step
Epoch 17/50
1766/1766 - 55s - loss: 2.8489 - accuracy100: 0.5223 - val_loss: 3.0793 - val_accuracy100: 0.4952 - 55s/epoch - 31ms/step
Epoch 18/50
1766/1766 - 55s - loss: 2.8419 - accuracy100: 0.5246 - val_loss: 3.0948 - val_accuracy100: 0.4946 - 55s/epoch - 31ms/step
testing model: results/AAL/W6/deepOF_L2/h100
Evaluating performance on  test set...
6203/6203 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0421259
{'0': {'precision': 0.5598642381054766, 'recall': 0.22703917990620737, 'f1-score': 0.3230666294459879, 'support': 481701}, '1': {'precision': 0.44148677028543826, 'recall': 0.8759161221080408, 'f1-score': 0.5870723102601542, 'support': 609362}, '2': {'precision': 0.5580242339711459, 'recall': 0.20616095618812977, 'f1-score': 0.3010862056294554, 'support': 496806}, 'accuracy': 0.46952047051740414, 'macro avg': {'precision': 0.5197917474540202, 'recall': 0.4363720860674593, 'f1-score': 0.40374171511186585, 'support': 1587869}, 'weighted avg': {'precision': 0.5138599042216899, 'recall': 0.46952047051740414, 'f1-score': 0.41750453536750015, 'support': 1587869}}
[[109365 323020  49316]
 [ 43806 533750  31806]
 [ 42171 352213 102422]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0358915
{'0': {'precision': 0.5916430195317037, 'recall': 0.2458335919023092, 'f1-score': 0.3473427833796094, 'support': 145029}, '1': {'precision': 0.42893307378290746, 'recall': 0.8737558579310429, 'f1-score': 0.5753987414095569, 'support': 163667}, '2': {'precision': 0.5585366271793729, 'recall': 0.22736630540221783, 'f1-score': 0.32317581240328536, 'support': 143293}, 'accuracy': 0.46735208157720654, 'macro avg': {'precision': 0.5263709068313281, 'recall': 0.44898525174519, 'f1-score': 0.41530577906415056, 'support': 451989}, 'weighted avg': {'precision': 0.5222294652854482, 'recall': 0.46735208157720654, 'f1-score': 0.4222611480096713, 'support': 451989}}
[[ 35653  93088  16288]
 [ 11199 143005   9463]
 [ 13409  97304  32580]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0074664
{'0': {'precision': 0.5562325209748302, 'recall': 0.2503596475454055, 'f1-score': 0.34530009920634924, 'support': 44488}, '1': {'precision': 0.4715305925497008, 'recall': 0.8463886230903752, 'f1-score': 0.6056488504559808, 'support': 60614}, '2': {'precision': 0.526263833324674, 'recall': 0.23572259716080987, 'f1-score': 0.3256023273381873, 'support': 42970}, 'accuracy': 0.49009941109730404, 'macro avg': {'precision': 0.5180089822830684, 'recall': 0.4441569559321969, 'f1-score': 0.4255170923335057, 'support': 148072}, 'weighted avg': {'precision': 0.5128625577279773, 'recall': 0.49009941109730404, 'f1-score': 0.4461589108052353, 'support': 148072}}
[[11138 28698  4652]
 [ 4845 51303  4466]
 [ 4041 28800 10129]]
training model: results/AAL/W6/deepOF_L2/h200
Epoch 1/50
1766/1766 - 58s - loss: 3.2358 - accuracy200: 0.4029 - val_loss: 3.2228 - val_accuracy200: 0.3872 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 56s - loss: 3.1815 - accuracy200: 0.4266 - val_loss: 3.1989 - val_accuracy200: 0.3976 - 56s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 56s - loss: 3.1599 - accuracy200: 0.4334 - val_loss: 3.1842 - val_accuracy200: 0.4034 - 56s/epoch - 32ms/step
Epoch 4/50
1766/1766 - 56s - loss: 3.1468 - accuracy200: 0.4367 - val_loss: 3.1788 - val_accuracy200: 0.4069 - 56s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 56s - loss: 3.1370 - accuracy200: 0.4398 - val_loss: 3.1725 - val_accuracy200: 0.4105 - 56s/epoch - 32ms/step
Epoch 6/50
1766/1766 - 55s - loss: 3.1302 - accuracy200: 0.4413 - val_loss: 3.1773 - val_accuracy200: 0.4085 - 55s/epoch - 31ms/step
Epoch 7/50
1766/1766 - 55s - loss: 3.1246 - accuracy200: 0.4430 - val_loss: 3.1754 - val_accuracy200: 0.4117 - 55s/epoch - 31ms/step
Epoch 8/50
1766/1766 - 55s - loss: 3.1188 - accuracy200: 0.4452 - val_loss: 3.1751 - val_accuracy200: 0.4123 - 55s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 56s - loss: 3.1153 - accuracy200: 0.4458 - val_loss: 3.1724 - val_accuracy200: 0.4142 - 56s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 55s - loss: 3.1108 - accuracy200: 0.4471 - val_loss: 3.1724 - val_accuracy200: 0.4151 - 55s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 56s - loss: 3.1073 - accuracy200: 0.4484 - val_loss: 3.1717 - val_accuracy200: 0.4143 - 56s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 55s - loss: 3.1034 - accuracy200: 0.4492 - val_loss: 3.1806 - val_accuracy200: 0.4114 - 55s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 56s - loss: 3.0984 - accuracy200: 0.4506 - val_loss: 3.1782 - val_accuracy200: 0.4158 - 56s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 57s - loss: 3.0927 - accuracy200: 0.4534 - val_loss: 3.1792 - val_accuracy200: 0.4159 - 57s/epoch - 32ms/step
Epoch 15/50
1766/1766 - 58s - loss: 3.0887 - accuracy200: 0.4539 - val_loss: 3.1774 - val_accuracy200: 0.4173 - 58s/epoch - 33ms/step
Epoch 16/50
1766/1766 - 58s - loss: 3.0841 - accuracy200: 0.4551 - val_loss: 3.1940 - val_accuracy200: 0.4172 - 58s/epoch - 33ms/step
Epoch 17/50
1766/1766 - 57s - loss: 3.0791 - accuracy200: 0.4574 - val_loss: 3.1959 - val_accuracy200: 0.4174 - 57s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 56s - loss: 3.0750 - accuracy200: 0.4585 - val_loss: 3.1884 - val_accuracy200: 0.4165 - 56s/epoch - 32ms/step
Epoch 19/50
1766/1766 - 56s - loss: 3.0669 - accuracy200: 0.4611 - val_loss: 3.2240 - val_accuracy200: 0.4151 - 56s/epoch - 32ms/step
Epoch 20/50
1766/1766 - 55s - loss: 3.0650 - accuracy200: 0.4618 - val_loss: 3.1983 - val_accuracy200: 0.4167 - 55s/epoch - 31ms/step
Epoch 21/50
1766/1766 - 57s - loss: 3.0574 - accuracy200: 0.4641 - val_loss: 3.2059 - val_accuracy200: 0.4147 - 57s/epoch - 32ms/step
testing model: results/AAL/W6/deepOF_L2/h200
Evaluating performance on  test set...
6203/6203 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069409
{'0': {'precision': 0.4440428496777565, 'recall': 0.18385045635572508, 'f1-score': 0.2600361550928812, 'support': 499172}, '1': {'precision': 0.37284911339740207, 'recall': 0.7420083117453425, 'f1-score': 0.49630945613037714, 'support': 564743}, '2': {'precision': 0.4443714632174616, 'recall': 0.218215721227436, 'f1-score': 0.2926976, 'support': 523954}, 'accuracy': 0.3937050222656907, 'macro avg': {'precision': 0.42042114209754006, 'recall': 0.38135816310950116, 'f1-score': 0.3496810704077527, 'support': 1587869}, 'weighted avg': {'precision': 0.41883045128116736, 'recall': 0.3937050222656907, 'f1-score': 0.3548467393115309, 'support': 1587869}}
[[ 91773 342642  64757]
 [ 67495 419044  78204]
 [ 47408 362211 114335]]
Evaluating performance on  train set...
1766/1766 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.06792
{'0': {'precision': 0.5368152543599393, 'recall': 0.18793582833509617, 'f1-score': 0.27840405319822675, 'support': 157889}, '1': {'precision': 0.35624917898325287, 'recall': 0.7841270512901883, 'f1-score': 0.4899165921297867, 'support': 141801}, '2': {'precision': 0.49009456264775414, 'recall': 0.27224078949960273, 'f1-score': 0.35003946829661586, 'support': 152299}, 'accuracy': 0.40338371066552503, 'macro avg': {'precision': 0.46105299866364874, 'recall': 0.41476788970829576, 'f1-score': 0.3727867045415431, 'support': 451989}, 'weighted avg': {'precision': 0.46442419023766285, 'recall': 0.40338371066552503, 'f1-score': 0.3688989360761369, 'support': 451989}}
[[ 29673 103754  24462]
 [ 11935 111190  18676]
 [ 13668  97169  41462]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0610026
{'0': {'precision': 0.5160580021482277, 'recall': 0.19401930299236764, 'f1-score': 0.2820121503830012, 'support': 49526}, '1': {'precision': 0.38165581211762384, 'recall': 0.7629051028660473, 'f1-score': 0.5087840459888053, 'support': 50697}, '2': {'precision': 0.46748719408081957, 'recall': 0.27465568768417314, 'f1-score': 0.34601966798751993, 'support': 47849}, 'accuracy': 0.41485223404830085, 'macro avg': {'precision': 0.45506700278222373, 'recall': 0.4105266978475293, 'f1-score': 0.3789386214531088, 'support': 148072}, 'weighted avg': {'precision': 0.45434577820852984, 'recall': 0.41485223404830085, 'f1-score': 0.38033830591129875, 'support': 148072}}
[[ 9609 32343  7574]
 [ 4624 38677  7396]
 [ 4387 30320 13142]]
training model: results/AAL/W6/deepOF_L2/h300
Epoch 1/50
1766/1766 - 58s - loss: 3.2740 - accuracy300: 0.3828 - val_loss: 3.2529 - val_accuracy300: 0.3835 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 55s - loss: 3.2439 - accuracy300: 0.3985 - val_loss: 3.2474 - val_accuracy300: 0.3873 - 55s/epoch - 31ms/step
Epoch 3/50
1766/1766 - 56s - loss: 3.2322 - accuracy300: 0.4047 - val_loss: 3.2421 - val_accuracy300: 0.3908 - 56s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 56s - loss: 3.2247 - accuracy300: 0.4084 - val_loss: 3.2393 - val_accuracy300: 0.3923 - 56s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 54s - loss: 3.2183 - accuracy300: 0.4111 - val_loss: 3.2380 - val_accuracy300: 0.3952 - 54s/epoch - 31ms/step
Epoch 6/50
1766/1766 - 53s - loss: 3.2124 - accuracy300: 0.4140 - val_loss: 3.2362 - val_accuracy300: 0.3954 - 53s/epoch - 30ms/step
Epoch 7/50
1766/1766 - 56s - loss: 3.2078 - accuracy300: 0.4157 - val_loss: 3.2385 - val_accuracy300: 0.3971 - 56s/epoch - 31ms/step
Epoch 8/50
1766/1766 - 56s - loss: 3.2033 - accuracy300: 0.4178 - val_loss: 3.2386 - val_accuracy300: 0.3955 - 56s/epoch - 32ms/step
Epoch 9/50
1766/1766 - 56s - loss: 3.2005 - accuracy300: 0.4191 - val_loss: 3.2384 - val_accuracy300: 0.3969 - 56s/epoch - 32ms/step
Epoch 10/50
1766/1766 - 56s - loss: 3.1964 - accuracy300: 0.4211 - val_loss: 3.2414 - val_accuracy300: 0.3983 - 56s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 57s - loss: 3.1925 - accuracy300: 0.4226 - val_loss: 3.2419 - val_accuracy300: 0.3978 - 57s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 55s - loss: 3.1879 - accuracy300: 0.4248 - val_loss: 3.2472 - val_accuracy300: 0.3957 - 55s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 56s - loss: 3.1834 - accuracy300: 0.4265 - val_loss: 3.2484 - val_accuracy300: 0.3958 - 56s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 56s - loss: 3.1797 - accuracy300: 0.4286 - val_loss: 3.2510 - val_accuracy300: 0.3952 - 56s/epoch - 32ms/step
Epoch 15/50
1766/1766 - 56s - loss: 3.1750 - accuracy300: 0.4309 - val_loss: 3.2543 - val_accuracy300: 0.3951 - 56s/epoch - 32ms/step
Epoch 16/50
1766/1766 - 56s - loss: 3.1708 - accuracy300: 0.4326 - val_loss: 3.2639 - val_accuracy300: 0.3921 - 56s/epoch - 31ms/step
testing model: results/AAL/W6/deepOF_L2/h300
Evaluating performance on  test set...
6203/6203 - 99s - 99s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.092312
{'0': {'precision': 0.39449430847822325, 'recall': 0.308492591902572, 'f1-score': 0.3462328292243795, 'support': 509915}, '1': {'precision': 0.3558348601910184, 'recall': 0.44853313383060134, 'f1-score': 0.39684255503423616, 'support': 537336}, '2': {'precision': 0.40158186482636804, 'recall': 0.38017602077622276, 'f1-score': 0.39058587881822726, 'support': 540618}, 'accuracy': 0.3802882983419917, 'macro avg': {'precision': 0.38397034449853656, 'recall': 0.3790672488364654, 'f1-score': 0.377887087692281, 'support': 1587869}, 'weighted avg': {'precision': 0.3838250071901244, 'recall': 0.3802882983419917, 'f1-score': 0.3784599742804842, 'support': 1587869}}
[[157305 211226 141384]
 [131436 241013 164887]
 [110010 225078 205530]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0839907
{'0': {'precision': 0.43211654103497926, 'recall': 0.30029429075927017, 'f1-score': 0.3543424662291211, 'support': 152910}, '1': {'precision': 0.3638405501833613, 'recall': 0.47992344296894457, 'f1-score': 0.41389680278569163, 'support': 152566}, '2': {'precision': 0.40279892583261817, 'recall': 0.3972207244408346, 'f1-score': 0.39999037790767605, 'support': 146513}, 'accuracy': 0.39234583142510104, 'macro avg': {'precision': 0.3995853390169863, 'recall': 0.3924794860563498, 'f1-score': 0.3894098823074963, 'support': 451989}, 'weighted avg': {'precision': 0.39956706178568013, 'recall': 0.39234583142510104, 'f1-score': 0.3892415000437711, 'support': 451989}}
[[45918 65715 41277]
 [34337 73220 45009]
 [26008 62307 58198]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.078729
{'0': {'precision': 0.42412513680164426, 'recall': 0.3244838360528519, 'f1-score': 0.3676732615989818, 'support': 48967}, '1': {'precision': 0.37655587042632804, 'recall': 0.46141892410405955, 'f1-score': 0.41469028837449884, 'support': 52124}, '2': {'precision': 0.39642261115152555, 'recall': 0.39437219301419724, 'f1-score': 0.3953947438619704, 'support': 46981}, 'accuracy': 0.39486195904695015, 'macro avg': {'precision': 0.39903453945983264, 'recall': 0.3934249843903696, 'f1-score': 0.3925860979451503, 'support': 148072}, 'weighted avg': {'precision': 0.39859031051365457, 'recall': 0.39486195904695015, 'f1-score': 0.3930197042879744, 'support': 148072}}
[[15889 20387 12691]
 [12554 24051 15519]
 [ 9020 19433 18528]]
training model: results/AAL/W6/deepOF_L2/h500
Epoch 1/50
1766/1766 - 59s - loss: 3.2390 - accuracy500: 0.3972 - val_loss: 3.2974 - val_accuracy500: 0.3442 - 59s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 57s - loss: 3.2195 - accuracy500: 0.4071 - val_loss: 3.2865 - val_accuracy500: 0.3495 - 57s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 56s - loss: 3.2095 - accuracy500: 0.4117 - val_loss: 3.2810 - val_accuracy500: 0.3522 - 56s/epoch - 32ms/step
Epoch 4/50
1766/1766 - 57s - loss: 3.2017 - accuracy500: 0.4144 - val_loss: 3.2781 - val_accuracy500: 0.3536 - 57s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 57s - loss: 3.1971 - accuracy500: 0.4157 - val_loss: 3.2755 - val_accuracy500: 0.3568 - 57s/epoch - 33ms/step
Epoch 6/50
1766/1766 - 57s - loss: 3.1945 - accuracy500: 0.4173 - val_loss: 3.2727 - val_accuracy500: 0.3612 - 57s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 54s - loss: 3.1928 - accuracy500: 0.4173 - val_loss: 3.2716 - val_accuracy500: 0.3601 - 54s/epoch - 30ms/step
Epoch 8/50
1766/1766 - 55s - loss: 3.1904 - accuracy500: 0.4184 - val_loss: 3.2756 - val_accuracy500: 0.3579 - 55s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 55s - loss: 3.1876 - accuracy500: 0.4201 - val_loss: 3.2781 - val_accuracy500: 0.3570 - 55s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 55s - loss: 3.1866 - accuracy500: 0.4212 - val_loss: 3.2790 - val_accuracy500: 0.3576 - 55s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 53s - loss: 3.1841 - accuracy500: 0.4228 - val_loss: 3.2777 - val_accuracy500: 0.3587 - 53s/epoch - 30ms/step
Epoch 12/50
1766/1766 - 53s - loss: 3.1824 - accuracy500: 0.4236 - val_loss: 3.2754 - val_accuracy500: 0.3604 - 53s/epoch - 30ms/step
Epoch 13/50
1766/1766 - 54s - loss: 3.1807 - accuracy500: 0.4246 - val_loss: 3.2752 - val_accuracy500: 0.3605 - 54s/epoch - 30ms/step
Epoch 14/50
1766/1766 - 55s - loss: 3.1787 - accuracy500: 0.4265 - val_loss: 3.2776 - val_accuracy500: 0.3583 - 55s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 54s - loss: 3.1776 - accuracy500: 0.4273 - val_loss: 3.2762 - val_accuracy500: 0.3594 - 54s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 54s - loss: 3.1753 - accuracy500: 0.4291 - val_loss: 3.2754 - val_accuracy500: 0.3603 - 54s/epoch - 30ms/step
Epoch 17/50
1766/1766 - 54s - loss: 3.1717 - accuracy500: 0.4309 - val_loss: 3.2779 - val_accuracy500: 0.3579 - 54s/epoch - 31ms/step
testing model: results/AAL/W6/deepOF_L2/h500
Evaluating performance on  test set...
6203/6203 - 95s - 95s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0945185
{'0': {'precision': 0.22638956279591216, 'recall': 0.44623116174906885, 'f1-score': 0.30038348188757863, 'support': 336682}, '1': {'precision': 0.5017704614762035, 'recall': 0.15733957531275988, 'f1-score': 0.23956045851697877, 'support': 882626}, '2': {'precision': 0.2555125339972416, 'recall': 0.4488782046933886, 'f1-score': 0.32565450179126804, 'support': 368561}, 'accuracy': 0.2862635393725805, 'macro avg': {'precision': 0.3278908527564524, 'recall': 0.3508163139184058, 'f1-score': 0.28853281406527514, 'support': 1587869}, 'weighted avg': {'precision': 0.3862213451832023, 'recall': 0.2862635393725805, 'f1-score': 0.2724403269681392, 'support': 1587869}}
[[150238  67341 119103]
 [380817 138872 362937]
 [132571  70551 165439]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905972
{'0': {'precision': 0.38970082851586435, 'recall': 0.4684081768578528, 'f1-score': 0.4254449107560938, 'support': 156148}, '1': {'precision': 0.3704484917319055, 'recall': 0.18597736883904994, 'f1-score': 0.24763419770605302, 'support': 147319}, '2': {'precision': 0.3792849825317187, 'recall': 0.4860896028871144, 'f1-score': 0.426096374093671, 'support': 148522}, 'accuracy': 0.3821641677120461, 'macro avg': {'precision': 0.37981143425982955, 'recall': 0.3801583828613391, 'f1-score': 0.36639182751860594, 'support': 451989}, 'weighted avg': {'precision': 0.3800032091491689, 'recall': 0.3821641677120461, 'f1-score': 0.36770425822252484, 'support': 451989}}
[[73141 24399 58608]
 [60379 27398 59542]
 [54165 22162 72195]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0874959
{'0': {'precision': 0.33991609373255277, 'recall': 0.4841634099790966, 'f1-score': 0.39941518823628647, 'support': 44012}, '1': {'precision': 0.4710537634408602, 'recall': 0.17930582842174198, 'f1-score': 0.25974149175856753, 'support': 61080}, '2': {'precision': 0.3387088986528898, 'recall': 0.4896463471382038, 'f1-score': 0.40042620798569156, 'support': 42980}, 'accuracy': 0.36000054027770273, 'macro avg': {'precision': 0.38322625194210086, 'recall': 0.3843718618463475, 'f1-score': 0.3531942959935152, 'support': 148072}, 'weighted avg': {'precision': 0.39366024266860755, 'recall': 0.36000054027770273, 'f1-score': 0.34209296828903346, 'support': 148072}}
[[21309  6342 16361]
 [25401 10952 24727]
 [15979  5956 21045]]
training model: results/AAL/W6/deepOF_L2/h1000
Epoch 1/50
1766/1766 - 59s - loss: 3.2426 - accuracy1000: 0.4026 - val_loss: 3.5297 - val_accuracy1000: 0.3141 - 59s/epoch - 34ms/step
Epoch 2/50
1766/1766 - 56s - loss: 3.2379 - accuracy1000: 0.4027 - val_loss: 3.5243 - val_accuracy1000: 0.3161 - 56s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 55s - loss: 3.2457 - accuracy1000: 0.3954 - val_loss: 3.4925 - val_accuracy1000: 0.3158 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 55s - loss: 3.2385 - accuracy1000: 0.4004 - val_loss: 3.4810 - val_accuracy1000: 0.3185 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 55s - loss: 3.2313 - accuracy1000: 0.4030 - val_loss: 3.4513 - val_accuracy1000: 0.3179 - 55s/epoch - 31ms/step
Epoch 6/50
1766/1766 - 55s - loss: 3.2305 - accuracy1000: 0.4034 - val_loss: 3.4474 - val_accuracy1000: 0.3197 - 55s/epoch - 31ms/step
Epoch 7/50
1766/1766 - 55s - loss: 3.2272 - accuracy1000: 0.4049 - val_loss: 3.4470 - val_accuracy1000: 0.3200 - 55s/epoch - 31ms/step
Epoch 8/50
1766/1766 - 54s - loss: 3.2267 - accuracy1000: 0.4046 - val_loss: 3.4502 - val_accuracy1000: 0.3191 - 54s/epoch - 30ms/step
Epoch 9/50
1766/1766 - 54s - loss: 3.2250 - accuracy1000: 0.4063 - val_loss: 3.4411 - val_accuracy1000: 0.3206 - 54s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 55s - loss: 3.2227 - accuracy1000: 0.4075 - val_loss: 3.4480 - val_accuracy1000: 0.3216 - 55s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 54s - loss: 3.2206 - accuracy1000: 0.4085 - val_loss: 3.4528 - val_accuracy1000: 0.3223 - 54s/epoch - 30ms/step
Epoch 12/50
1766/1766 - 54s - loss: 3.2183 - accuracy1000: 0.4100 - val_loss: 3.4582 - val_accuracy1000: 0.3225 - 54s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 54s - loss: 3.2155 - accuracy1000: 0.4118 - val_loss: 3.4809 - val_accuracy1000: 0.3224 - 54s/epoch - 31ms/step
Epoch 14/50
1766/1766 - 54s - loss: 3.2120 - accuracy1000: 0.4154 - val_loss: 3.4914 - val_accuracy1000: 0.3234 - 54s/epoch - 30ms/step
Epoch 15/50
1766/1766 - 55s - loss: 3.2095 - accuracy1000: 0.4160 - val_loss: 3.5492 - val_accuracy1000: 0.3235 - 55s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 55s - loss: 3.2058 - accuracy1000: 0.4179 - val_loss: 3.5347 - val_accuracy1000: 0.3250 - 55s/epoch - 31ms/step
Epoch 17/50
1766/1766 - 56s - loss: 3.2036 - accuracy1000: 0.4200 - val_loss: 3.5187 - val_accuracy1000: 0.3257 - 56s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 57s - loss: 3.2016 - accuracy1000: 0.4200 - val_loss: 3.5381 - val_accuracy1000: 0.3249 - 57s/epoch - 32ms/step
Epoch 19/50
1766/1766 - 58s - loss: 3.1986 - accuracy1000: 0.4220 - val_loss: 3.5387 - val_accuracy1000: 0.3266 - 58s/epoch - 33ms/step
testing model: results/AAL/W6/deepOF_L2/h1000
Evaluating performance on  test set...
6203/6203 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1596059
{'0': {'precision': 0.2802879117429424, 'recall': 0.3265831563846413, 'f1-score': 0.3016697144449332, 'support': 421026}, '1': {'precision': 0.3766185558005983, 'recall': 0.024946016346235896, 'f1-score': 0.04679263710475984, 'support': 691413}, '2': {'precision': 0.30723391709977604, 'recall': 0.6795069726352986, 'f1-score': 0.4231457134717588, 'support': 475430}, 'accuracy': 0.3009102136259351, 'macro avg': {'precision': 0.3213801282144389, 'recall': 0.3436787151220586, 'f1-score': 0.25720268834048393, 'support': 1587869}, 'weighted avg': {'precision': 0.3303016086704821, 'recall': 0.3009102136259351, 'f1-score': 0.22705903153741525, 'support': 1587869}}
[[137500  13711 269815]
 [215533  17248 458632]
 [137534  14838 323058]]
Evaluating performance on  train set...
1766/1766 - 31s - 31s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1175697
{'0': {'precision': 0.37502308345747104, 'recall': 0.39310625173408353, 'f1-score': 0.3838518121820215, 'support': 154981}, '1': {'precision': 0.336921007111282, 'recall': 0.023334908517308166, 'f1-score': 0.043646866227210195, 'support': 150247}, '2': {'precision': 0.3423864951330747, 'recall': 0.6511947997083694, 'f1-score': 0.44880133367771025, 'support': 146761}, 'accuracy': 0.35399091570812563, 'macro avg': {'precision': 0.3514435285672759, 'recall': 0.35587865331992036, 'f1-score': 0.2921000040289807, 'support': 451989}, 'weighted avg': {'precision': 0.35176034696640024, 'recall': 0.35399091570812563, 'f1-score': 0.291852414429767, 'support': 451989}}
[[60924  3604 90453]
 [53635  3506 93106]
 [47895  3296 95570]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1468152
{'0': {'precision': 0.33732267808664396, 'recall': 0.3954191972389682, 'f1-score': 0.36406780360477475, 'support': 44621}, '1': {'precision': 0.3993688639551192, 'recall': 0.01888106092001658, 'f1-score': 0.03605742596197984, 'support': 60325}, '2': {'precision': 0.3095658350732936, 'recall': 0.6669526503733246, 'f1-score': 0.42286092325786534, 'support': 43126}, 'accuracy': 0.32110054568047974, 'macro avg': {'precision': 0.3487524590383522, 'recall': 0.3604176361774365, 'f1-score': 0.27432871760820665, 'support': 148072}, 'weighted avg': {'precision': 0.35451630382764854, 'recall': 0.32110054568047974, 'f1-score': 0.2475588488183032, 'support': 148072}}
[[17644   938 26039]
 [21074  1139 38112]
 [13588   775 28763]]
training model: results/AAL/W6/deepVOL_L2/h10
Epoch 1/50
1766/1766 - 59s - loss: 2.8247 - accuracy10: 0.4942 - val_loss: 2.3856 - val_accuracy10: 0.6591 - 59s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 56s - loss: 2.5906 - accuracy10: 0.5708 - val_loss: 2.3286 - val_accuracy10: 0.6847 - 56s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 55s - loss: 2.4879 - accuracy10: 0.6069 - val_loss: 2.3111 - val_accuracy10: 0.7044 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 57s - loss: 2.4432 - accuracy10: 0.6209 - val_loss: 2.3122 - val_accuracy10: 0.7234 - 57s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 56s - loss: 2.4120 - accuracy10: 0.6302 - val_loss: 2.2639 - val_accuracy10: 0.7127 - 56s/epoch - 32ms/step
Epoch 6/50
1766/1766 - 57s - loss: 2.3894 - accuracy10: 0.6355 - val_loss: 2.2758 - val_accuracy10: 0.7201 - 57s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 57s - loss: 2.3707 - accuracy10: 0.6385 - val_loss: 2.2598 - val_accuracy10: 0.7154 - 57s/epoch - 32ms/step
Epoch 8/50
1766/1766 - 56s - loss: 2.3506 - accuracy10: 0.6404 - val_loss: 2.2219 - val_accuracy10: 0.7177 - 56s/epoch - 32ms/step
Epoch 9/50
1766/1766 - 56s - loss: 2.3328 - accuracy10: 0.6432 - val_loss: 2.2202 - val_accuracy10: 0.7248 - 56s/epoch - 32ms/step
Epoch 10/50
1766/1766 - 57s - loss: 2.3167 - accuracy10: 0.6458 - val_loss: 2.2225 - val_accuracy10: 0.7059 - 57s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 57s - loss: 2.3054 - accuracy10: 0.6466 - val_loss: 2.2032 - val_accuracy10: 0.7392 - 57s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 58s - loss: 2.2932 - accuracy10: 0.6488 - val_loss: 2.1742 - val_accuracy10: 0.7369 - 58s/epoch - 33ms/step
Epoch 13/50
1766/1766 - 59s - loss: 2.2813 - accuracy10: 0.6504 - val_loss: 2.1797 - val_accuracy10: 0.7344 - 59s/epoch - 33ms/step
Epoch 14/50
1766/1766 - 58s - loss: 2.2702 - accuracy10: 0.6514 - val_loss: 2.2090 - val_accuracy10: 0.7490 - 58s/epoch - 33ms/step
Epoch 15/50
1766/1766 - 58s - loss: 2.2623 - accuracy10: 0.6522 - val_loss: 2.2200 - val_accuracy10: 0.7434 - 58s/epoch - 33ms/step
Epoch 16/50
1766/1766 - 58s - loss: 2.2551 - accuracy10: 0.6532 - val_loss: 2.1794 - val_accuracy10: 0.7331 - 58s/epoch - 33ms/step
Epoch 17/50
1766/1766 - 56s - loss: 2.2459 - accuracy10: 0.6541 - val_loss: 2.1567 - val_accuracy10: 0.7408 - 56s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 58s - loss: 2.2414 - accuracy10: 0.6543 - val_loss: 2.1818 - val_accuracy10: 0.7459 - 58s/epoch - 33ms/step
Epoch 19/50
1766/1766 - 56s - loss: 2.2335 - accuracy10: 0.6559 - val_loss: 2.1769 - val_accuracy10: 0.7422 - 56s/epoch - 32ms/step
Epoch 20/50
1766/1766 - 56s - loss: 2.2286 - accuracy10: 0.6558 - val_loss: 2.1946 - val_accuracy10: 0.7512 - 56s/epoch - 32ms/step
Epoch 21/50
1766/1766 - 57s - loss: 2.2246 - accuracy10: 0.6554 - val_loss: 2.1915 - val_accuracy10: 0.7469 - 57s/epoch - 32ms/step
Epoch 22/50
1766/1766 - 57s - loss: 2.2167 - accuracy10: 0.6560 - val_loss: 2.1818 - val_accuracy10: 0.7551 - 57s/epoch - 32ms/step
Epoch 23/50
1766/1766 - 56s - loss: 2.2100 - accuracy10: 0.6572 - val_loss: 2.1870 - val_accuracy10: 0.7554 - 56s/epoch - 31ms/step
Epoch 24/50
1766/1766 - 56s - loss: 2.2063 - accuracy10: 0.6571 - val_loss: 2.1768 - val_accuracy10: 0.7466 - 56s/epoch - 32ms/step
Epoch 25/50
1766/1766 - 56s - loss: 2.2005 - accuracy10: 0.6580 - val_loss: 2.1752 - val_accuracy10: 0.7503 - 56s/epoch - 32ms/step
Epoch 26/50
1766/1766 - 56s - loss: 2.1946 - accuracy10: 0.6593 - val_loss: 2.2252 - val_accuracy10: 0.7306 - 56s/epoch - 32ms/step
Epoch 27/50
1766/1766 - 56s - loss: 2.1905 - accuracy10: 0.6590 - val_loss: 2.1602 - val_accuracy10: 0.7428 - 56s/epoch - 32ms/step
testing model: results/AAL/W6/deepVOL_L2/h10
Evaluating performance on  test set...
6203/6203 - 98s - 98s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6424511
{'0': {'precision': 0.4413275463884686, 'recall': 0.5473279276254062, 'f1-score': 0.4886452312616557, 'support': 202502}, '1': {'precision': 0.8795441065089837, 'recall': 0.8161080121789727, 'f1-score': 0.846639454491634, 'support': 1181052}, '2': {'precision': 0.43947621894513084, 'recall': 0.5180794831636648, 'f1-score': 0.47555168200115006, 'support': 204320}, 'accuracy': 0.7434815356886, 'macro avg': {'precision': 0.5867826239475278, 'recall': 0.6271718076560145, 'f1-score': 0.6036121225848133, 'support': 1587874}, 'weighted avg': {'precision': 0.7670324080715945, 'recall': 0.7434815356886, 'f1-score': 0.7532345622471783, 'support': 1587874}}
[[110835  64296  27371]
 [109547 963866 107639]
 [ 30758  67708 105854]]
Evaluating performance on  train set...
1766/1766 - 32s - 32s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6925147
{'0': {'precision': 0.40555549114854444, 'recall': 0.5953876265849715, 'f1-score': 0.48247041624141446, 'support': 58755}, '1': {'precision': 0.8828682202687013, 'recall': 0.7655900252604705, 'f1-score': 0.8200572927950699, 'support': 333723}, '2': {'precision': 0.41896989861413114, 'recall': 0.537445600120982, 'f1-score': 0.470869677229399, 'support': 59513}, 'accuracy': 0.7134257098039563, 'macro avg': {'precision': 0.5691312033437922, 'recall': 0.6328077506554747, 'f1-score': 0.5911324620886278, 'support': 451991}, 'weighted avg': {'precision': 0.7597407902621675, 'recall': 0.7134257098039563, 'f1-score': 0.7301968320844147, 'support': 451991}}
[[ 34982  15917   7856]
 [ 41727 255495  36501]
 [  9548  17980  31985]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6486629
{'0': {'precision': 0.4072179369329763, 'recall': 0.5893683479870431, 'f1-score': 0.48164693091304456, 'support': 17288}, '1': {'precision': 0.9019559099903547, 'recall': 0.7943306507404132, 'f1-score': 0.8447289998137457, 'support': 114193}, '2': {'precision': 0.3985500800569294, 'recall': 0.5401121089747454, 'f1-score': 0.45865642994241845, 'support': 16591}, 'accuracy': 0.7419160948727646, 'macro avg': {'precision': 0.5692413089934201, 'recall': 0.6412703692340672, 'f1-score': 0.5950107868897363, 'support': 148072}, 'weighted avg': {'precision': 0.7877882334367766, 'recall': 0.7419160948727646, 'f1-score': 0.7590794994768115, 'support': 148072}}
[[10189  4970  2129]
 [12092 90707 11394]
 [ 2740  4890  8961]]
training model: results/AAL/W6/deepVOL_L2/h20
Epoch 1/50
1766/1766 - 61s - loss: 2.9438 - accuracy20: 0.4796 - val_loss: 2.5595 - val_accuracy20: 0.6736 - 61s/epoch - 35ms/step
Epoch 2/50
1766/1766 - 58s - loss: 2.6872 - accuracy20: 0.5632 - val_loss: 2.5090 - val_accuracy20: 0.6915 - 58s/epoch - 33ms/step
Epoch 3/50
1766/1766 - 58s - loss: 2.5905 - accuracy20: 0.5889 - val_loss: 2.4504 - val_accuracy20: 0.7057 - 58s/epoch - 33ms/step
Epoch 4/50
1766/1766 - 55s - loss: 2.5440 - accuracy20: 0.6017 - val_loss: 2.4436 - val_accuracy20: 0.7037 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 55s - loss: 2.5130 - accuracy20: 0.6098 - val_loss: 2.4088 - val_accuracy20: 0.7007 - 55s/epoch - 31ms/step
Epoch 6/50
1766/1766 - 56s - loss: 2.4886 - accuracy20: 0.6141 - val_loss: 2.3679 - val_accuracy20: 0.7086 - 56s/epoch - 31ms/step
Epoch 7/50
1766/1766 - 54s - loss: 2.4672 - accuracy20: 0.6174 - val_loss: 2.3887 - val_accuracy20: 0.7092 - 54s/epoch - 30ms/step
Epoch 8/50
1766/1766 - 54s - loss: 2.4517 - accuracy20: 0.6183 - val_loss: 2.3740 - val_accuracy20: 0.7103 - 54s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 54s - loss: 2.4396 - accuracy20: 0.6211 - val_loss: 2.3581 - val_accuracy20: 0.7091 - 54s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 55s - loss: 2.4269 - accuracy20: 0.6222 - val_loss: 2.3544 - val_accuracy20: 0.7071 - 55s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 55s - loss: 2.4149 - accuracy20: 0.6252 - val_loss: 2.3475 - val_accuracy20: 0.7030 - 55s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 56s - loss: 2.4087 - accuracy20: 0.6264 - val_loss: 2.3419 - val_accuracy20: 0.7085 - 56s/epoch - 32ms/step
Epoch 13/50
1766/1766 - 55s - loss: 2.4005 - accuracy20: 0.6272 - val_loss: 2.3404 - val_accuracy20: 0.7062 - 55s/epoch - 31ms/step
Epoch 14/50
1766/1766 - 56s - loss: 2.3928 - accuracy20: 0.6288 - val_loss: 2.3368 - val_accuracy20: 0.7066 - 56s/epoch - 32ms/step
Epoch 15/50
1766/1766 - 56s - loss: 2.3870 - accuracy20: 0.6295 - val_loss: 2.3372 - val_accuracy20: 0.7128 - 56s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 59s - loss: 2.3800 - accuracy20: 0.6304 - val_loss: 2.3585 - val_accuracy20: 0.7157 - 59s/epoch - 33ms/step
Epoch 17/50
1766/1766 - 59s - loss: 2.3737 - accuracy20: 0.6313 - val_loss: 2.3398 - val_accuracy20: 0.7125 - 59s/epoch - 34ms/step
Epoch 18/50
1766/1766 - 60s - loss: 2.3677 - accuracy20: 0.6318 - val_loss: 2.3355 - val_accuracy20: 0.7168 - 60s/epoch - 34ms/step
Epoch 19/50
1766/1766 - 59s - loss: 2.3626 - accuracy20: 0.6323 - val_loss: 2.3454 - val_accuracy20: 0.7173 - 59s/epoch - 33ms/step
Epoch 20/50
1766/1766 - 58s - loss: 2.3570 - accuracy20: 0.6339 - val_loss: 2.3414 - val_accuracy20: 0.7148 - 58s/epoch - 33ms/step
Epoch 21/50
1766/1766 - 58s - loss: 2.3518 - accuracy20: 0.6337 - val_loss: 2.3324 - val_accuracy20: 0.7159 - 58s/epoch - 33ms/step
Epoch 22/50
1766/1766 - 58s - loss: 2.3475 - accuracy20: 0.6349 - val_loss: 2.3403 - val_accuracy20: 0.7095 - 58s/epoch - 33ms/step
Epoch 23/50
1766/1766 - 55s - loss: 2.3423 - accuracy20: 0.6353 - val_loss: 2.3599 - val_accuracy20: 0.7163 - 55s/epoch - 31ms/step
Epoch 24/50
1766/1766 - 57s - loss: 2.3354 - accuracy20: 0.6361 - val_loss: 2.3619 - val_accuracy20: 0.7109 - 57s/epoch - 32ms/step
Epoch 25/50
1766/1766 - 56s - loss: 2.3324 - accuracy20: 0.6361 - val_loss: 2.3485 - val_accuracy20: 0.7117 - 56s/epoch - 31ms/step
Epoch 26/50
1766/1766 - 55s - loss: 2.3272 - accuracy20: 0.6372 - val_loss: 2.3663 - val_accuracy20: 0.7184 - 55s/epoch - 31ms/step
Epoch 27/50
1766/1766 - 56s - loss: 2.3220 - accuracy20: 0.6373 - val_loss: 2.3710 - val_accuracy20: 0.7146 - 56s/epoch - 31ms/step
Epoch 28/50
1766/1766 - 55s - loss: 2.3189 - accuracy20: 0.6378 - val_loss: 2.3660 - val_accuracy20: 0.7138 - 55s/epoch - 31ms/step
Epoch 29/50
1766/1766 - 56s - loss: 2.3147 - accuracy20: 0.6377 - val_loss: 2.3647 - val_accuracy20: 0.7117 - 56s/epoch - 32ms/step
Epoch 30/50
1766/1766 - 54s - loss: 2.3089 - accuracy20: 0.6396 - val_loss: 2.3766 - val_accuracy20: 0.7095 - 54s/epoch - 31ms/step
Epoch 31/50
1766/1766 - 54s - loss: 2.3064 - accuracy20: 0.6393 - val_loss: 2.3520 - val_accuracy20: 0.7139 - 54s/epoch - 31ms/step
testing model: results/AAL/W6/deepVOL_L2/h20
Evaluating performance on  test set...
6203/6203 - 98s - 98s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.70993316
{'0': {'precision': 0.48611938474697947, 'recall': 0.48020746887966803, 'f1-score': 0.4831453424823901, 'support': 265100}, '1': {'precision': 0.7982488116214561, 'recall': 0.8246537477578145, 'f1-score': 0.8112364730001221, 'support': 1054217}, '2': {'precision': 0.4963593616114204, 'recall': 0.43786607684774553, 'f1-score': 0.46528154218087864, 'support': 268557}, 'accuracy': 0.7017301120869792, 'macro avg': {'precision': 0.5935758526599519, 'recall': 0.5809090978284094, 'f1-score': 0.5865544525544636, 'support': 1587874}, 'weighted avg': {'precision': 0.6950793938397122, 'recall': 0.7017301120869792, 'f1-score': 0.6979494130342342, 'support': 1587874}}
[[127303 104779  33018]
 [ 98554 869364  86299]
 [ 36019 114946 117592]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7288258
{'0': {'precision': 0.479573330787954, 'recall': 0.5165859112933283, 'f1-score': 0.49739201455274434, 'support': 77807}, '1': {'precision': 0.8021812608618307, 'recall': 0.7923657363759551, 'f1-score': 0.7972432879944649, 'support': 295929}, '2': {'precision': 0.4839530255301762, 'recall': 0.469209635167082, 'f1-score': 0.47646730597043974, 'support': 78255}, 'accuracy': 0.6889429214298515, 'macro avg': {'precision': 0.5885692057266537, 'recall': 0.5927204276121218, 'f1-score': 0.5903675361725497, 'support': 451991}, 'weighted avg': {'precision': 0.6915505054460442, 'recall': 0.6889429214298515, 'f1-score': 0.6900888258348864, 'support': 451991}}
[[ 40194  27386  10227]
 [ 32519 234484  28926]
 [ 11099  30438  36718]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.68518746
{'0': {'precision': 0.47541644819102163, 'recall': 0.5140875785066295, 'f1-score': 0.4939963538065002, 'support': 22928}, '1': {'precision': 0.8319465066916462, 'recall': 0.8103451622922814, 'f1-score': 0.8210037713954164, 'support': 103024}, '2': {'precision': 0.4617531617967728, 'recall': 0.4786618444846293, 'f1-score': 0.4700554938956715, 'support': 22120}, 'accuracy': 0.7149224701496569, 'macro avg': {'precision': 0.5897053722264801, 'recall': 0.6010315284278468, 'f1-score': 0.595018539699196, 'support': 148072}, 'weighted avg': {'precision': 0.7214381190803697, 'recall': 0.7149224701496569, 'f1-score': 0.7179417342190898, 'support': 148072}}
[[11787  8393  2748]
 [ 9945 83485  9594]
 [ 3061  8471 10588]]
training model: results/AAL/W6/deepVOL_L2/h30
Epoch 1/50
1766/1766 - 60s - loss: 3.0269 - accuracy30: 0.4497 - val_loss: 2.7509 - val_accuracy30: 0.6112 - 60s/epoch - 34ms/step
Epoch 2/50
1766/1766 - 58s - loss: 2.8339 - accuracy30: 0.5303 - val_loss: 2.6723 - val_accuracy30: 0.6438 - 58s/epoch - 33ms/step
Epoch 3/50
1766/1766 - 55s - loss: 2.7382 - accuracy30: 0.5554 - val_loss: 2.5772 - val_accuracy30: 0.6536 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 58s - loss: 2.6727 - accuracy30: 0.5739 - val_loss: 2.6799 - val_accuracy30: 0.6622 - 58s/epoch - 33ms/step
Epoch 5/50
1766/1766 - 58s - loss: 2.6385 - accuracy30: 0.5827 - val_loss: 2.6621 - val_accuracy30: 0.6560 - 58s/epoch - 33ms/step
Epoch 6/50
1766/1766 - 56s - loss: 2.6162 - accuracy30: 0.5897 - val_loss: 2.5879 - val_accuracy30: 0.6609 - 56s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 58s - loss: 2.5961 - accuracy30: 0.5938 - val_loss: 2.5858 - val_accuracy30: 0.6463 - 58s/epoch - 33ms/step
Epoch 8/50
1766/1766 - 57s - loss: 2.5776 - accuracy30: 0.5973 - val_loss: 2.5213 - val_accuracy30: 0.6705 - 57s/epoch - 32ms/step
Epoch 9/50
1766/1766 - 59s - loss: 2.5669 - accuracy30: 0.5978 - val_loss: 2.5238 - val_accuracy30: 0.6691 - 59s/epoch - 33ms/step
Epoch 10/50
1766/1766 - 53s - loss: 2.5581 - accuracy30: 0.5982 - val_loss: 2.6803 - val_accuracy30: 0.6782 - 53s/epoch - 30ms/step
Epoch 11/50
1766/1766 - 55s - loss: 2.5654 - accuracy30: 0.5970 - val_loss: 2.5228 - val_accuracy30: 0.6724 - 55s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 56s - loss: 2.5367 - accuracy30: 0.6026 - val_loss: 2.5037 - val_accuracy30: 0.6862 - 56s/epoch - 32ms/step
Epoch 13/50
1766/1766 - 57s - loss: 2.5273 - accuracy30: 0.6045 - val_loss: 2.5137 - val_accuracy30: 0.6830 - 57s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 57s - loss: 2.5181 - accuracy30: 0.6049 - val_loss: 2.5187 - val_accuracy30: 0.6694 - 57s/epoch - 32ms/step
Epoch 15/50
1766/1766 - 54s - loss: 2.5099 - accuracy30: 0.6064 - val_loss: 2.5143 - val_accuracy30: 0.6798 - 54s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 54s - loss: 2.5024 - accuracy30: 0.6090 - val_loss: 2.5077 - val_accuracy30: 0.6769 - 54s/epoch - 31ms/step
Epoch 17/50
1766/1766 - 56s - loss: 2.4968 - accuracy30: 0.6089 - val_loss: 2.5130 - val_accuracy30: 0.6784 - 56s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 56s - loss: 2.4901 - accuracy30: 0.6098 - val_loss: 2.5342 - val_accuracy30: 0.6813 - 56s/epoch - 32ms/step
Epoch 19/50
1766/1766 - 56s - loss: 2.4836 - accuracy30: 0.6109 - val_loss: 2.5020 - val_accuracy30: 0.6849 - 56s/epoch - 31ms/step
Epoch 20/50
1766/1766 - 56s - loss: 2.4777 - accuracy30: 0.6119 - val_loss: 2.5181 - val_accuracy30: 0.6836 - 56s/epoch - 32ms/step
Epoch 21/50
1766/1766 - 56s - loss: 2.4716 - accuracy30: 0.6125 - val_loss: 2.5130 - val_accuracy30: 0.6873 - 56s/epoch - 32ms/step
Epoch 22/50
1766/1766 - 56s - loss: 2.4654 - accuracy30: 0.6146 - val_loss: 2.5416 - val_accuracy30: 0.6834 - 56s/epoch - 32ms/step
Epoch 23/50
1766/1766 - 56s - loss: 2.4625 - accuracy30: 0.6135 - val_loss: 2.5176 - val_accuracy30: 0.6870 - 56s/epoch - 32ms/step
Epoch 24/50
1766/1766 - 55s - loss: 2.4567 - accuracy30: 0.6151 - val_loss: 2.5298 - val_accuracy30: 0.6847 - 55s/epoch - 31ms/step
Epoch 25/50
1766/1766 - 55s - loss: 2.4509 - accuracy30: 0.6159 - val_loss: 2.5257 - val_accuracy30: 0.6884 - 55s/epoch - 31ms/step
Epoch 26/50
1766/1766 - 55s - loss: 2.4487 - accuracy30: 0.6157 - val_loss: 2.5123 - val_accuracy30: 0.6849 - 55s/epoch - 31ms/step
Epoch 27/50
1766/1766 - 58s - loss: 2.4428 - accuracy30: 0.6159 - val_loss: 2.5104 - val_accuracy30: 0.6817 - 58s/epoch - 33ms/step
Epoch 28/50
1766/1766 - 57s - loss: 2.4388 - accuracy30: 0.6167 - val_loss: 2.5140 - val_accuracy30: 0.6783 - 57s/epoch - 32ms/step
Epoch 29/50
1766/1766 - 57s - loss: 2.4338 - accuracy30: 0.6174 - val_loss: 2.5101 - val_accuracy30: 0.6758 - 57s/epoch - 33ms/step
testing model: results/AAL/W6/deepVOL_L2/h30
Evaluating performance on  test set...
6203/6203 - 108s - 108s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.77763516
{'0': {'precision': 0.5202920538592831, 'recall': 0.44016711429424055, 'f1-score': 0.476887429535906, 'support': 311643}, '1': {'precision': 0.7278550723846788, 'recall': 0.8339015936993959, 'f1-score': 0.7772779435168399, 'support': 959654}, '2': {'precision': 0.5219954527454828, 'recall': 0.37058598697947104, 'f1-score': 0.43344885171282477, 'support': 316577}, 'accuracy': 0.6642535868715024, 'macro avg': {'precision': 0.5900475263298149, 'recall': 0.5482182316577024, 'f1-score': 0.5625380749218569, 'support': 1587874}, 'weighted avg': {'precision': 0.6460752947771182, 'recall': 0.6642535868715024, 'f1-score': 0.6497722451146997, 'support': 1587874}}
[[137175 145616  28852]
 [ 80817 800257  78580]
 [ 45658 153600 117319]]
Evaluating performance on  train set...
1766/1766 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7919785
{'0': {'precision': 0.5046419392005672, 'recall': 0.4952272233094151, 'f1-score': 0.4998902570180637, 'support': 91980}, '1': {'precision': 0.7306365886314764, 'recall': 0.8065420316576406, 'f1-score': 0.7667152155517276, 'support': 267929}, '2': {'precision': 0.525673483619605, 'recall': 0.37656653852001476, 'f1-score': 0.4387990762124711, 'support': 92082}, 'accuracy': 0.6555926998546431, 'macro avg': {'precision': 0.5869840038172162, 'recall': 0.5594452644956901, 'f1-score': 0.5684681829274209, 'support': 451991}, 'weighted avg': {'precision': 0.6428905926042144, 'recall': 0.6555926998546431, 'f1-score': 0.6456116236028528, 'support': 451991}}
[[ 45551  38088   8341]
 [ 28886 216096  22947]
 [ 15827  41580  34675]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7461654
{'0': {'precision': 0.5132171529273546, 'recall': 0.48247551726676974, 'f1-score': 0.49737176689375107, 'support': 27162}, '1': {'precision': 0.7675767616088722, 'recall': 0.8253882668865701, 'f1-score': 0.7954334735962669, 'support': 94587}, '2': {'precision': 0.49731105349082877, 'recall': 0.39345819245526725, 'f1-score': 0.4393306326751362, 'support': 26323}, 'accuracy': 0.68570019990275, 'macro avg': {'precision': 0.5927016560090185, 'recall': 0.5671073255362024, 'f1-score': 0.5773786243883848, 'support': 148072}, 'weighted avg': {'precision': 0.672872023874536, 'recall': 0.68570019990275, 'f1-score': 0.6774527131620142, 'support': 148072}}
[[13105 11834  2223]
 [ 8270 78071  8246]
 [ 4160 11806 10357]]
training model: results/AAL/W6/deepVOL_L2/h50
Epoch 1/50
1766/1766 - 59s - loss: 3.1052 - accuracy50: 0.4451 - val_loss: 2.9583 - val_accuracy50: 0.5385 - 59s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 57s - loss: 2.9306 - accuracy50: 0.5079 - val_loss: 2.8755 - val_accuracy50: 0.5909 - 57s/epoch - 32ms/step
Epoch 3/50
1766/1766 - 56s - loss: 2.8420 - accuracy50: 0.5358 - val_loss: 2.8326 - val_accuracy50: 0.5921 - 56s/epoch - 32ms/step
Epoch 4/50
1766/1766 - 57s - loss: 2.8016 - accuracy50: 0.5466 - val_loss: 2.8417 - val_accuracy50: 0.5925 - 57s/epoch - 32ms/step
Epoch 5/50
1766/1766 - 57s - loss: 2.7773 - accuracy50: 0.5511 - val_loss: 2.8222 - val_accuracy50: 0.5985 - 57s/epoch - 32ms/step
Epoch 6/50
1766/1766 - 57s - loss: 2.7610 - accuracy50: 0.5555 - val_loss: 2.8713 - val_accuracy50: 0.6022 - 57s/epoch - 32ms/step
Epoch 7/50
1766/1766 - 57s - loss: 2.7456 - accuracy50: 0.5591 - val_loss: 2.8368 - val_accuracy50: 0.6052 - 57s/epoch - 33ms/step
Epoch 8/50
1766/1766 - 54s - loss: 2.7348 - accuracy50: 0.5607 - val_loss: 2.8352 - val_accuracy50: 0.6077 - 54s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 55s - loss: 2.7239 - accuracy50: 0.5623 - val_loss: 2.8165 - val_accuracy50: 0.6094 - 55s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 56s - loss: 2.7128 - accuracy50: 0.5640 - val_loss: 2.7804 - val_accuracy50: 0.6115 - 56s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 56s - loss: 2.7050 - accuracy50: 0.5650 - val_loss: 2.8003 - val_accuracy50: 0.6145 - 56s/epoch - 32ms/step
Epoch 12/50
1766/1766 - 55s - loss: 2.6961 - accuracy50: 0.5669 - val_loss: 2.7845 - val_accuracy50: 0.6145 - 55s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 56s - loss: 2.6901 - accuracy50: 0.5680 - val_loss: 2.7610 - val_accuracy50: 0.6170 - 56s/epoch - 32ms/step
Epoch 14/50
1766/1766 - 55s - loss: 2.6825 - accuracy50: 0.5684 - val_loss: 2.7555 - val_accuracy50: 0.6175 - 55s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 57s - loss: 2.6769 - accuracy50: 0.5703 - val_loss: 2.7523 - val_accuracy50: 0.6106 - 57s/epoch - 32ms/step
Epoch 16/50
1766/1766 - 56s - loss: 2.6695 - accuracy50: 0.5714 - val_loss: 2.7495 - val_accuracy50: 0.6153 - 56s/epoch - 32ms/step
Epoch 17/50
1766/1766 - 57s - loss: 2.6645 - accuracy50: 0.5718 - val_loss: 2.7524 - val_accuracy50: 0.6189 - 57s/epoch - 32ms/step
Epoch 18/50
1766/1766 - 59s - loss: 2.6581 - accuracy50: 0.5732 - val_loss: 2.7589 - val_accuracy50: 0.6175 - 59s/epoch - 34ms/step
Epoch 19/50
1766/1766 - 58s - loss: 2.6532 - accuracy50: 0.5738 - val_loss: 2.7576 - val_accuracy50: 0.6184 - 58s/epoch - 33ms/step
Epoch 20/50
1766/1766 - 58s - loss: 2.6478 - accuracy50: 0.5743 - val_loss: 2.7511 - val_accuracy50: 0.6142 - 58s/epoch - 33ms/step
Epoch 21/50
1766/1766 - 54s - loss: 2.6421 - accuracy50: 0.5756 - val_loss: 2.7331 - val_accuracy50: 0.6139 - 54s/epoch - 31ms/step
Epoch 22/50
1766/1766 - 61s - loss: 2.6376 - accuracy50: 0.5763 - val_loss: 2.7476 - val_accuracy50: 0.6127 - 61s/epoch - 34ms/step
Epoch 23/50
1766/1766 - 52s - loss: 2.6337 - accuracy50: 0.5775 - val_loss: 2.7394 - val_accuracy50: 0.6119 - 52s/epoch - 30ms/step
Epoch 24/50
1766/1766 - 53s - loss: 2.6276 - accuracy50: 0.5784 - val_loss: 2.7517 - val_accuracy50: 0.6124 - 53s/epoch - 30ms/step
Epoch 25/50
1766/1766 - 53s - loss: 2.6247 - accuracy50: 0.5788 - val_loss: 2.7537 - val_accuracy50: 0.6084 - 53s/epoch - 30ms/step
Epoch 26/50
1766/1766 - 53s - loss: 2.6211 - accuracy50: 0.5787 - val_loss: 2.7743 - val_accuracy50: 0.6080 - 53s/epoch - 30ms/step
Epoch 27/50
1766/1766 - 53s - loss: 2.6162 - accuracy50: 0.5805 - val_loss: 2.7499 - val_accuracy50: 0.6067 - 53s/epoch - 30ms/step
Epoch 28/50
1766/1766 - 53s - loss: 2.6109 - accuracy50: 0.5814 - val_loss: 2.7757 - val_accuracy50: 0.6034 - 53s/epoch - 30ms/step
Epoch 29/50
1766/1766 - 54s - loss: 2.6065 - accuracy50: 0.5821 - val_loss: 2.7825 - val_accuracy50: 0.5991 - 54s/epoch - 30ms/step
Epoch 30/50
1766/1766 - 53s - loss: 2.6016 - accuracy50: 0.5824 - val_loss: 2.7601 - val_accuracy50: 0.5941 - 53s/epoch - 30ms/step
Epoch 31/50
1766/1766 - 54s - loss: 2.5980 - accuracy50: 0.5832 - val_loss: 2.7749 - val_accuracy50: 0.5980 - 54s/epoch - 31ms/step
testing model: results/AAL/W6/deepVOL_L2/h50
Evaluating performance on  test set...
6203/6203 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8867605
{'0': {'precision': 0.5477018170853915, 'recall': 0.3239563690533952, 'f1-score': 0.40711254665754804, 'support': 381289}, '1': {'precision': 0.6241878871807716, 'recall': 0.8299995959600907, 'f1-score': 0.7125294367741974, 'support': 816751}, '2': {'precision': 0.5164608457718646, 'recall': 0.36603785200880373, 'f1-score': 0.4284294562890504, 'support': 389834}, 'accuracy': 0.5945799225883162, 'macro avg': {'precision': 0.5627835166793425, 'recall': 0.5066646056740965, 'f1-score': 0.5160238132402654, 'support': 1587874}, 'weighted avg': {'precision': 0.5793739027958662, 'recall': 0.5945799225883162, 'f1-score': 0.5694425593468109, 'support': 1587874}}
[[123521 201914  55854]
 [ 61104 677903  77744]
 [ 40901 206239 142694]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88770765
{'0': {'precision': 0.5374949430557429, 'recall': 0.3866552609067579, 'f1-score': 0.4497650848361749, 'support': 113393}, '1': {'precision': 0.623234679244631, 'recall': 0.7998518801027082, 'f1-score': 0.7005834278522708, 'support': 225493}, '2': {'precision': 0.5213699475470533, 'recall': 0.37349365633703197, 'f1-score': 0.43521351671560293, 'support': 113105}, 'accuracy': 0.5895006758984139, 'macro avg': {'precision': 0.560699856615809, 'recall': 0.520000265782166, 'f1-score': 0.5285206764680161, 'support': 451991}, 'weighted avg': {'precision': 0.5762344151147676, 'recall': 0.5895006758984139, 'f1-score': 0.5712540647261534, 'support': 451991}}
[[ 43844  53658  15891]
 [ 22242 180361  22890]
 [ 15485  55376  42244]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.85493207
{'0': {'precision': 0.538328505339617, 'recall': 0.3660228709174824, 'f1-score': 0.4357610331431771, 'support': 34017}, '1': {'precision': 0.6649809343676987, 'recall': 0.8097296631565983, 'f1-score': 0.7302514661453705, 'support': 81195}, '2': {'precision': 0.492137761755005, 'recall': 0.3905051734631771, 'f1-score': 0.43547018698883494, 'support': 32860}, 'accuracy': 0.614761737533092, 'macro avg': {'precision': 0.565149067154107, 'recall': 0.5220859025124193, 'f1-score': 0.5338275620924608, 'support': 148072}, 'weighted avg': {'precision': 0.5975275175819366, 'recall': 0.614761737533092, 'f1-score': 0.5971797585131419, 'support': 148072}}
[[12451 17034  4532]
 [ 6739 65746  8710]
 [ 3939 16089 12832]]
training model: results/AAL/W6/deepVOL_L2/h100
Epoch 1/50
1766/1766 - 59s - loss: 3.2011 - accuracy100: 0.4200 - val_loss: 3.1578 - val_accuracy100: 0.4488 - 59s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 54s - loss: 3.0672 - accuracy100: 0.4682 - val_loss: 3.1093 - val_accuracy100: 0.4714 - 54s/epoch - 31ms/step
Epoch 3/50
1766/1766 - 54s - loss: 3.0095 - accuracy100: 0.4805 - val_loss: 3.0870 - val_accuracy100: 0.4775 - 54s/epoch - 30ms/step
Epoch 4/50
1766/1766 - 52s - loss: 2.9829 - accuracy100: 0.4864 - val_loss: 3.0573 - val_accuracy100: 0.4830 - 52s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 53s - loss: 2.9720 - accuracy100: 0.4893 - val_loss: 3.0543 - val_accuracy100: 0.4877 - 53s/epoch - 30ms/step
Epoch 6/50
1766/1766 - 53s - loss: 2.9608 - accuracy100: 0.4922 - val_loss: 3.0400 - val_accuracy100: 0.4925 - 53s/epoch - 30ms/step
Epoch 7/50
1766/1766 - 52s - loss: 2.9541 - accuracy100: 0.4943 - val_loss: 3.0523 - val_accuracy100: 0.4903 - 52s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 53s - loss: 2.9483 - accuracy100: 0.4954 - val_loss: 3.0536 - val_accuracy100: 0.4906 - 53s/epoch - 30ms/step
Epoch 9/50
1766/1766 - 53s - loss: 2.9425 - accuracy100: 0.4967 - val_loss: 3.0713 - val_accuracy100: 0.4859 - 53s/epoch - 30ms/step
Epoch 10/50
1766/1766 - 56s - loss: 2.9369 - accuracy100: 0.4987 - val_loss: 3.0793 - val_accuracy100: 0.4873 - 56s/epoch - 32ms/step
Epoch 11/50
1766/1766 - 55s - loss: 2.9306 - accuracy100: 0.5005 - val_loss: 3.0828 - val_accuracy100: 0.4884 - 55s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 54s - loss: 2.9247 - accuracy100: 0.5023 - val_loss: 3.0955 - val_accuracy100: 0.4839 - 54s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 54s - loss: 2.9196 - accuracy100: 0.5035 - val_loss: 3.0966 - val_accuracy100: 0.4873 - 54s/epoch - 31ms/step
Epoch 14/50
1766/1766 - 53s - loss: 2.9144 - accuracy100: 0.5050 - val_loss: 3.0938 - val_accuracy100: 0.4907 - 53s/epoch - 30ms/step
Epoch 15/50
1766/1766 - 53s - loss: 2.9106 - accuracy100: 0.5055 - val_loss: 3.1125 - val_accuracy100: 0.4879 - 53s/epoch - 30ms/step
Epoch 16/50
1766/1766 - 52s - loss: 2.9065 - accuracy100: 0.5068 - val_loss: 3.0895 - val_accuracy100: 0.4928 - 52s/epoch - 29ms/step
testing model: results/AAL/W6/deepVOL_L2/h100
Evaluating performance on  test set...
6203/6203 - 88s - 88s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.022308
{'0': {'precision': 0.5088575384135403, 'recall': 0.21669901703324648, 'f1-score': 0.30395681096498317, 'support': 481705}, '1': {'precision': 0.4496303595728979, 'recall': 0.8648471680216357, 'f1-score': 0.5916594768185638, 'support': 609362}, '2': {'precision': 0.5233535719880562, 'recall': 0.221909111586592, 'f1-score': 0.3116670907189099, 'support': 496807}, 'accuracy': 0.4670622480121219, 'macro avg': {'precision': 0.4939471566581648, 'recall': 0.43448509888049136, 'f1-score': 0.40242779283415225, 'support': 1587874}, 'weighted avg': {'precision': 0.49066399081427425, 'recall': 0.4670622480121219, 'f1-score': 0.41677784892112996, 'support': 1587874}}
[[104385 321127  56193]
 [ 38143 527005  44214]
 [ 62608 323953 110246]]
Evaluating performance on  train set...
1766/1766 - 28s - 28s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.033385
{'0': {'precision': 0.5295991667815405, 'recall': 0.2382960834177573, 'f1-score': 0.328694329578402, 'support': 145101}, '1': {'precision': 0.4338387681495642, 'recall': 0.8572458896155492, 'f1-score': 0.5761148171272715, 'support': 163610}, '2': {'precision': 0.5124574239939448, 'recall': 0.2268146286990508, 'f1-score': 0.31445214227658014, 'support': 143280}, 'accuracy': 0.45870161131526954, 'macro avg': {'precision': 0.49196511964168316, 'recall': 0.4407855339107858, 'f1-score': 0.4064204296607512, 'support': 451991}, 'weighted avg': {'precision': 0.4895022893508298, 'recall': 0.45870161131526954, 'f1-score': 0.4137399286528648, 'support': 451991}}
[[ 34577  92906  17618]
 [ 10056 140254  13300]
 [ 20656  90126  32498]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0029812
{'0': {'precision': 0.5320134561297083, 'recall': 0.2166793944566731, 'f1-score': 0.30794030803607053, 'support': 44522}, '1': {'precision': 0.48102585678614873, 'recall': 0.8686862013147897, 'f1-score': 0.6191846946284032, 'support': 60542}, '2': {'precision': 0.5132000388236436, 'recall': 0.24588448660714285, 'f1-score': 0.3324739837142767, 'support': 43008}, 'accuracy': 0.4917472580906586, 'macro avg': {'precision': 0.5087464505798335, 'recall': 0.4437500274595352, 'f1-score': 0.4198663287929168, 'support': 148072}, 'weighted avg': {'precision': 0.5057018057774674, 'recall': 0.4917472580906586, 'f1-score': 0.44232426973471234, 'support': 148072}}
[[ 9647 29685  5190]
 [ 3109 52592  4841]
 [ 5377 27056 10575]]
training model: results/AAL/W6/deepVOL_L2/h200
Epoch 1/50
1766/1766 - 58s - loss: 3.2650 - accuracy200: 0.3903 - val_loss: 3.2718 - val_accuracy200: 0.3663 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 54s - loss: 3.2172 - accuracy200: 0.4132 - val_loss: 3.2222 - val_accuracy200: 0.3998 - 54s/epoch - 30ms/step
Epoch 3/50
1766/1766 - 55s - loss: 3.1831 - accuracy200: 0.4237 - val_loss: 3.1957 - val_accuracy200: 0.4095 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 55s - loss: 3.1681 - accuracy200: 0.4267 - val_loss: 3.1925 - val_accuracy200: 0.4136 - 55s/epoch - 31ms/step
Epoch 5/50
1766/1766 - 54s - loss: 3.1571 - accuracy200: 0.4309 - val_loss: 3.1874 - val_accuracy200: 0.4160 - 54s/epoch - 30ms/step
Epoch 6/50
1766/1766 - 52s - loss: 3.1476 - accuracy200: 0.4340 - val_loss: 3.1856 - val_accuracy200: 0.4160 - 52s/epoch - 30ms/step
Epoch 7/50
1766/1766 - 53s - loss: 3.1423 - accuracy200: 0.4369 - val_loss: 3.1927 - val_accuracy200: 0.4119 - 53s/epoch - 30ms/step
Epoch 8/50
1766/1766 - 54s - loss: 3.1360 - accuracy200: 0.4381 - val_loss: 3.1963 - val_accuracy200: 0.4107 - 54s/epoch - 31ms/step
Epoch 9/50
1766/1766 - 54s - loss: 3.1307 - accuracy200: 0.4403 - val_loss: 3.1991 - val_accuracy200: 0.4116 - 54s/epoch - 31ms/step
Epoch 10/50
1766/1766 - 54s - loss: 3.1257 - accuracy200: 0.4426 - val_loss: 3.2077 - val_accuracy200: 0.4080 - 54s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 54s - loss: 3.1218 - accuracy200: 0.4436 - val_loss: 3.2128 - val_accuracy200: 0.4102 - 54s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 55s - loss: 3.1171 - accuracy200: 0.4449 - val_loss: 3.2077 - val_accuracy200: 0.4104 - 55s/epoch - 31ms/step
Epoch 13/50
1766/1766 - 54s - loss: 3.1101 - accuracy200: 0.4485 - val_loss: 3.2059 - val_accuracy200: 0.4086 - 54s/epoch - 31ms/step
Epoch 14/50
1766/1766 - 55s - loss: 3.1067 - accuracy200: 0.4493 - val_loss: 3.2038 - val_accuracy200: 0.4096 - 55s/epoch - 31ms/step
Epoch 15/50
1766/1766 - 55s - loss: 3.1025 - accuracy200: 0.4509 - val_loss: 3.2138 - val_accuracy200: 0.4047 - 55s/epoch - 31ms/step
Epoch 16/50
1766/1766 - 57s - loss: 3.0969 - accuracy200: 0.4531 - val_loss: 3.2075 - val_accuracy200: 0.4088 - 57s/epoch - 32ms/step
testing model: results/AAL/W6/deepVOL_L2/h200
Evaluating performance on  test set...
6203/6203 - 93s - 93s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0968801
{'0': {'precision': 0.3931292012558023, 'recall': 0.32711308235972886, 'f1-score': 0.3570956821442318, 'support': 499176}, '1': {'precision': 0.38886981392990005, 'recall': 0.6557903329479072, 'f1-score': 0.4882297185599615, 'support': 564743}, '2': {'precision': 0.42171991332748854, 'recall': 0.17718506360279032, 'f1-score': 0.24953030127913947, 'support': 523955}, 'accuracy': 0.39453823162291213, 'macro avg': {'precision': 0.4012396428377303, 'recall': 0.3866961596368088, 'f1-score': 0.3649519006611109, 'support': 1587874}, 'weighted avg': {'precision': 0.4010484614533547, 'recall': 0.39453823162291213, 'f1-score': 0.3682411571607375, 'support': 1587874}}
[[163287 281972  53917]
 [121005 370353  73385]
 [131060 300058  92837]]
Evaluating performance on  train set...
1766/1766 - 27s - 27s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0703963
{'0': {'precision': 0.44366565797006624, 'recall': 0.34351589759177287, 'f1-score': 0.3872199638098841, 'support': 157917}, '1': {'precision': 0.37002087877480083, 'recall': 0.6712631192867622, 'f1-score': 0.47706748543141797, 'support': 141776}, '2': {'precision': 0.45220760596784426, 'recall': 0.21533441016953603, 'f1-score': 0.29174450671648433, 'support': 152298}, 'accuracy': 0.40312970833490047, 'macro avg': {'precision': 0.4219647142375704, 'recall': 0.4100378090160237, 'f1-score': 0.3853439853192621, 'support': 451991}, 'weighted avg': {'precision': 0.42344370527848085, 'recall': 0.40312970833490047, 'f1-score': 0.38323205489356493, 'support': 451991}}
[[54247 81700 21970]
 [28850 95169 17757]
 [39173 80330 32795]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0628147
{'0': {'precision': 0.44043248824136744, 'recall': 0.3100732933551396, 'f1-score': 0.3639315125303632, 'support': 49527}, '1': {'precision': 0.3981912728917025, 'recall': 0.6942057548285376, 'f1-score': 0.5060919540229886, 'support': 50740}, '2': {'precision': 0.4482702877465244, 'recall': 0.23202593870934002, 'f1-score': 0.30577954210257896, 'support': 47805}, 'accuracy': 0.4165068345129396, 'macro avg': {'precision': 0.4289646829598648, 'recall': 0.41210166229767237, 'f1-score': 0.3919343362186436, 'support': 148072}, 'weighted avg': {'precision': 0.4284880742974889, 'recall': 0.4165068345129396, 'f1-score': 0.3938714461777481, 'support': 148072}}
[[15357 27343  6827]
 [ 8691 35224  6825]
 [10820 25893 11092]]
training model: results/AAL/W6/deepVOL_L2/h300
Epoch 1/50
1766/1766 - 58s - loss: 3.2994 - accuracy300: 0.3654 - val_loss: 3.2847 - val_accuracy300: 0.3539 - 58s/epoch - 33ms/step
Epoch 2/50
1766/1766 - 55s - loss: 3.2701 - accuracy300: 0.3780 - val_loss: 3.2771 - val_accuracy300: 0.3655 - 55s/epoch - 31ms/step
Epoch 3/50
1766/1766 - 55s - loss: 3.2563 - accuracy300: 0.3883 - val_loss: 3.2829 - val_accuracy300: 0.3702 - 55s/epoch - 31ms/step
Epoch 4/50
1766/1766 - 51s - loss: 3.2436 - accuracy300: 0.3989 - val_loss: 3.2887 - val_accuracy300: 0.3686 - 51s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 53s - loss: 3.2353 - accuracy300: 0.4048 - val_loss: 3.2875 - val_accuracy300: 0.3683 - 53s/epoch - 30ms/step
Epoch 6/50
1766/1766 - 52s - loss: 3.2276 - accuracy300: 0.4086 - val_loss: 3.2909 - val_accuracy300: 0.3685 - 52s/epoch - 29ms/step
Epoch 7/50
1766/1766 - 52s - loss: 3.2195 - accuracy300: 0.4130 - val_loss: 3.2941 - val_accuracy300: 0.3673 - 52s/epoch - 29ms/step
Epoch 8/50
1766/1766 - 51s - loss: 3.2115 - accuracy300: 0.4178 - val_loss: 3.3041 - val_accuracy300: 0.3683 - 51s/epoch - 29ms/step
Epoch 9/50
1766/1766 - 53s - loss: 3.2052 - accuracy300: 0.4205 - val_loss: 3.3047 - val_accuracy300: 0.3699 - 53s/epoch - 30ms/step
Epoch 10/50
1766/1766 - 54s - loss: 3.1985 - accuracy300: 0.4235 - val_loss: 3.3071 - val_accuracy300: 0.3693 - 54s/epoch - 31ms/step
Epoch 11/50
1766/1766 - 55s - loss: 3.1917 - accuracy300: 0.4255 - val_loss: 3.3123 - val_accuracy300: 0.3682 - 55s/epoch - 31ms/step
Epoch 12/50
1766/1766 - 54s - loss: 3.1871 - accuracy300: 0.4278 - val_loss: 3.3205 - val_accuracy300: 0.3682 - 54s/epoch - 31ms/step
testing model: results/AAL/W6/deepVOL_L2/h300
Evaluating performance on  test set...
6203/6203 - 96s - 96s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0964684
{'0': {'precision': 0.3636044219727483, 'recall': 0.416036664646738, 'f1-score': 0.38805746275959896, 'support': 509919}, '1': {'precision': 0.340193636470404, 'recall': 0.5175104590051662, 'f1-score': 0.4105233165823211, 'support': 537336}, '2': {'precision': 0.3733156521367156, 'recall': 0.129140855204867, 'f1-score': 0.19189841060421778, 'support': 540619}, 'accuracy': 0.35269675049783544, 'macro avg': {'precision': 0.3590379035266226, 'recall': 0.3542293262855904, 'f1-score': 0.33015972998204596, 'support': 1587874}, 'weighted avg': {'precision': 0.3589885756910699, 'recall': 0.35269675049783544, 'f1-score': 0.3288741783255042, 'support': 1587874}}
[[212145 250900  46874]
 [188933 278077  70326]
 [182372 288431  69816]]
Evaluating performance on  train set...
1766/1766 - 26s - 26s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946847
{'0': {'precision': 0.38991815084132503, 'recall': 0.36296393185311143, 'f1-score': 0.37595854220295355, 'support': 152905}, '1': {'precision': 0.3434908027097481, 'recall': 0.5510018155243719, 'f1-score': 0.42317633941492855, 'support': 152573}, '2': {'precision': 0.37448775227237713, 'recall': 0.16591019226962794, 'f1-score': 0.2299465999441877, 'support': 146513}, 'accuracy': 0.36256252889991175, 'macro avg': {'precision': 0.36929890194115006, 'recall': 0.35995864654903714, 'f1-score': 0.3430271605206899, 'support': 451991}, 'weighted avg': {'precision': 0.36924447863986226, 'recall': 0.36256252889991175, 'f1-score': 0.3445674598094194, 'support': 451991}}
[[55499 78926 18480]
 [46383 84068 22122]
 [40453 81752 24308]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0922233
{'0': {'precision': 0.3867132700858359, 'recall': 0.33193191558839136, 'f1-score': 0.3572346384053594, 'support': 48998}, '1': {'precision': 0.352984487901062, 'recall': 0.5427315987412695, 'f1-score': 0.427760176034239, 'support': 52116}, '2': {'precision': 0.3705764178643177, 'recall': 0.20426764342604029, 'f1-score': 0.26336454243430985, 'support': 46958}, 'accuracy': 0.3656396888000432, 'macro avg': {'precision': 0.37009139195040525, 'recall': 0.35964371925190036, 'f1-score': 0.34945311895796943, 'support': 148072}, 'weighted avg': {'precision': 0.3697244840968594, 'recall': 0.3656396888000432, 'f1-score': 0.35228810531644417, 'support': 148072}}
[[16264 25749  6985]
 [14524 28285  9307]
 [11269 26097  9592]]
training model: results/AAL/W6/deepVOL_L2/h500
Epoch 1/50
1766/1766 - 54s - loss: 3.2437 - accuracy500: 0.3925 - val_loss: 3.3244 - val_accuracy500: 0.3174 - 54s/epoch - 30ms/step
Epoch 2/50
1766/1766 - 51s - loss: 3.2371 - accuracy500: 0.3917 - val_loss: 3.3193 - val_accuracy500: 0.3224 - 51s/epoch - 29ms/step
Epoch 3/50
1766/1766 - 51s - loss: 3.2216 - accuracy500: 0.4022 - val_loss: 3.3015 - val_accuracy500: 0.3447 - 51s/epoch - 29ms/step
Epoch 4/50
1766/1766 - 50s - loss: 3.2157 - accuracy500: 0.4061 - val_loss: 3.3195 - val_accuracy500: 0.3301 - 50s/epoch - 28ms/step
Epoch 5/50
1766/1766 - 52s - loss: 3.2075 - accuracy500: 0.4110 - val_loss: 3.3197 - val_accuracy500: 0.3350 - 52s/epoch - 29ms/step
Epoch 6/50
1766/1766 - 51s - loss: 3.2021 - accuracy500: 0.4151 - val_loss: 3.3281 - val_accuracy500: 0.3362 - 51s/epoch - 29ms/step
Epoch 7/50
1766/1766 - 50s - loss: 3.1957 - accuracy500: 0.4165 - val_loss: 3.3472 - val_accuracy500: 0.3381 - 50s/epoch - 28ms/step
Epoch 8/50
1766/1766 - 51s - loss: 3.1878 - accuracy500: 0.4206 - val_loss: 3.3528 - val_accuracy500: 0.3398 - 51s/epoch - 29ms/step
Epoch 9/50
1766/1766 - 50s - loss: 3.1824 - accuracy500: 0.4230 - val_loss: 3.3231 - val_accuracy500: 0.3470 - 50s/epoch - 28ms/step
Epoch 10/50
1766/1766 - 50s - loss: 3.1773 - accuracy500: 0.4259 - val_loss: 3.3152 - val_accuracy500: 0.3497 - 50s/epoch - 29ms/step
Epoch 11/50
1766/1766 - 50s - loss: 3.1725 - accuracy500: 0.4289 - val_loss: 3.3258 - val_accuracy500: 0.3447 - 50s/epoch - 28ms/step
Epoch 12/50
1766/1766 - 51s - loss: 3.1676 - accuracy500: 0.4318 - val_loss: 3.3426 - val_accuracy500: 0.3392 - 51s/epoch - 29ms/step
Epoch 13/50
1766/1766 - 50s - loss: 3.1609 - accuracy500: 0.4337 - val_loss: 3.3492 - val_accuracy500: 0.3453 - 50s/epoch - 28ms/step
testing model: results/AAL/W6/deepVOL_L2/h500
Evaluating performance on  test set...
6203/6203 - 86s - 86s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0930959
{'0': {'precision': 0.22889546431032387, 'recall': 0.4193135443707193, 'f1-score': 0.29613586711989265, 'support': 336686}, '1': {'precision': 0.5441709807773585, 'recall': 0.3690691187433862, 'f1-score': 0.4398333021658162, 'support': 882626}, '2': {'precision': 0.2241262665041532, 'recall': 0.2265100580092359, 'f1-score': 0.2253118573256109, 'support': 368562}, 'accuracy': 0.34663329710039964, 'macro avg': {'precision': 0.33239757053061186, 'recall': 0.33829757370778046, 'f1-score': 0.3204270088704399, 'support': 1587874}, 'weighted avg': {'precision': 0.4030356183246821, 'recall': 0.34663329710039964, 'f1-score': 0.35957166467501556, 'support': 1587874}}
[[141177 128961  66548]
 [334425 325750 222451]
 [141173 143906  83483]]
Evaluating performance on  train set...
1766/1766 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1004132
{'0': {'precision': 0.36784958319178407, 'recall': 0.36043452377142055, 'f1-score': 0.3641043050907739, 'support': 156217}, '1': {'precision': 0.3284983096303851, 'recall': 0.354281950828688, 'f1-score': 0.34090329999150665, 'support': 147281}, '2': {'precision': 0.34241372910152623, 'recall': 0.32301859346905243, 'f1-score': 0.3324335094862687, 'support': 148493}, 'accuracy': 0.3461374230902828, 'macro avg': {'precision': 0.3462538739745651, 'recall': 0.345911689356387, 'f1-score': 0.34581370485618307, 'support': 451991}, 'weighted avg': {'precision': 0.34667053050529023, 'recall': 0.3461374230902828, 'f1-score': 0.3461394370210005, 'support': 451991}}
[[56306 54831 45080]
 [48066 52179 47036]
 [48696 51831 47966]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0977124
{'0': {'precision': 0.3203617370284037, 'recall': 0.33724126962488354, 'f1-score': 0.32858486911284523, 'support': 44013}, '1': {'precision': 0.4060614036736919, 'recall': 0.3535786785410255, 'f1-score': 0.378007053284678, 'support': 61084}, '2': {'precision': 0.2980371156103891, 'recall': 0.3367073880162885, 'f1-score': 0.316194305443262, 'support': 42975}, 'accuracy': 0.3438259765519477, 'macro avg': {'precision': 0.3414867521041616, 'recall': 0.3425091120607325, 'f1-score': 0.3409287426135951, 'support': 148072}, 'weighted avg': {'precision': 0.3492360537926914, 'recall': 0.3438259765519477, 'f1-score': 0.3453768366978842, 'support': 148072}}
[[14843 16278 12892]
 [18297 21598 21189]
 [13192 15313 14470]]
training model: results/AAL/W6/deepVOL_L2/h1000
Epoch 1/50
1766/1766 - 54s - loss: 3.2493 - accuracy1000: 0.3994 - val_loss: 3.5184 - val_accuracy1000: 0.2968 - 54s/epoch - 30ms/step
Epoch 2/50
1766/1766 - 51s - loss: 3.2469 - accuracy1000: 0.3972 - val_loss: 3.6466 - val_accuracy1000: 0.2977 - 51s/epoch - 29ms/step
Epoch 3/50
1766/1766 - 50s - loss: 3.2676 - accuracy1000: 0.3828 - val_loss: 3.5444 - val_accuracy1000: 0.2950 - 50s/epoch - 29ms/step
Epoch 4/50
1766/1766 - 52s - loss: 3.2676 - accuracy1000: 0.3825 - val_loss: 3.5280 - val_accuracy1000: 0.2940 - 52s/epoch - 29ms/step
Epoch 5/50
1766/1766 - 52s - loss: 3.2633 - accuracy1000: 0.3846 - val_loss: 3.5099 - val_accuracy1000: 0.3012 - 52s/epoch - 29ms/step
Epoch 6/50
1766/1766 - 52s - loss: 3.2500 - accuracy1000: 0.3955 - val_loss: 3.5309 - val_accuracy1000: 0.2952 - 52s/epoch - 29ms/step
Epoch 7/50
1766/1766 - 53s - loss: 3.2464 - accuracy1000: 0.3950 - val_loss: 3.4849 - val_accuracy1000: 0.3081 - 53s/epoch - 30ms/step
Epoch 8/50
1766/1766 - 53s - loss: 3.2247 - accuracy1000: 0.4051 - val_loss: 3.5596 - val_accuracy1000: 0.2963 - 53s/epoch - 30ms/step
Epoch 9/50
1766/1766 - 52s - loss: 3.2230 - accuracy1000: 0.4104 - val_loss: 3.5821 - val_accuracy1000: 0.2975 - 52s/epoch - 29ms/step
Epoch 10/50
1766/1766 - 52s - loss: 3.2218 - accuracy1000: 0.4103 - val_loss: 3.5032 - val_accuracy1000: 0.3068 - 52s/epoch - 29ms/step
Epoch 11/50
1766/1766 - 53s - loss: 3.2207 - accuracy1000: 0.4106 - val_loss: 3.4728 - val_accuracy1000: 0.3200 - 53s/epoch - 30ms/step
Epoch 12/50
1766/1766 - 52s - loss: 3.2250 - accuracy1000: 0.4060 - val_loss: 3.5026 - val_accuracy1000: 0.3114 - 52s/epoch - 30ms/step
Epoch 13/50
1766/1766 - 53s - loss: 3.2146 - accuracy1000: 0.4134 - val_loss: 3.5260 - val_accuracy1000: 0.3061 - 53s/epoch - 30ms/step
Epoch 14/50
1766/1766 - 53s - loss: 3.2153 - accuracy1000: 0.4119 - val_loss: 3.5166 - val_accuracy1000: 0.3105 - 53s/epoch - 30ms/step
Epoch 15/50
1766/1766 - 53s - loss: 3.2078 - accuracy1000: 0.4162 - val_loss: 3.5478 - val_accuracy1000: 0.3075 - 53s/epoch - 30ms/step
Epoch 16/50
1766/1766 - 54s - loss: 3.1970 - accuracy1000: 0.4208 - val_loss: 3.5449 - val_accuracy1000: 0.3111 - 54s/epoch - 31ms/step
Epoch 17/50
1766/1766 - 54s - loss: 3.1873 - accuracy1000: 0.4275 - val_loss: 3.5170 - val_accuracy1000: 0.3097 - 54s/epoch - 31ms/step
Epoch 18/50
1766/1766 - 54s - loss: 3.1811 - accuracy1000: 0.4309 - val_loss: 3.5016 - val_accuracy1000: 0.3112 - 54s/epoch - 31ms/step
Epoch 19/50
1766/1766 - 53s - loss: 3.1758 - accuracy1000: 0.4327 - val_loss: 3.5131 - val_accuracy1000: 0.3115 - 53s/epoch - 30ms/step
Epoch 20/50
1766/1766 - 51s - loss: 3.1711 - accuracy1000: 0.4336 - val_loss: 3.5029 - val_accuracy1000: 0.3083 - 51s/epoch - 29ms/step
Epoch 21/50
1766/1766 - 51s - loss: 3.1648 - accuracy1000: 0.4367 - val_loss: 3.4957 - val_accuracy1000: 0.3112 - 51s/epoch - 29ms/step
testing model: results/AAL/W6/deepVOL_L2/h1000
Evaluating performance on  test set...
6203/6203 - 83s - 83s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1858736
{'0': {'precision': 0.26523396106744634, 'recall': 0.5701185188703893, 'f1-score': 0.3620382932224059, 'support': 421030}, '1': {'precision': 0.4811722145116152, 'recall': 0.0305866392445615, 'f1-score': 0.057517093575426594, 'support': 691413}, '2': {'precision': 0.3008051061005882, 'recall': 0.40424583167694156, 'f1-score': 0.34493737621741044, 'support': 475431}, 'accuracy': 0.28552391436600133, 'macro avg': {'precision': 0.3490704272265499, 'recall': 0.33498366326396417, 'f1-score': 0.254830921005081, 'support': 1587874}, 'weighted avg': {'precision': 0.3699111210202164, 'recall': 0.28552391436600133, 'f1-score': 0.2243194173644229, 'support': 1587874}}
[[240037  10910 170083]
 [393617  21148 276648]
 [271347  11893 192191]]
Evaluating performance on  train set...
1766/1766 - 23s - 23s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1370811
{'0': {'precision': 0.35208925396452656, 'recall': 0.47411862645766245, 'f1-score': 0.4040921841482867, 'support': 154957}, '1': {'precision': 0.35098213563980274, 'recall': 0.028888888888888888, 'f1-score': 0.05338382379157932, 'support': 150300}, '2': {'precision': 0.3380629294630602, 'recall': 0.5321057151035207, 'f1-score': 0.4134490893349326, 'support': 146734}, 'accuracy': 0.34489182306727345, 'macro avg': {'precision': 0.3470447730224631, 'recall': 0.3450377434833573, 'f1-score': 0.2903083657582662, 'support': 451991}, 'weighted avg': {'precision': 0.3471676104282523, 'recall': 0.34489182306727345, 'f1-score': 0.29050919148702614, 'support': 451991}}
[[73468  4682 76807]
 [69886  4342 76072]
 [65309  3347 78078]]
Evaluating performance on  val set...
579/579 - 8s - 8s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1565096
{'0': {'precision': 0.3152371582744537, 'recall': 0.47376674582194545, 'f1-score': 0.37857577601947656, 'support': 44638}, '1': {'precision': 0.4704229748712346, 'recall': 0.04998341625207297, 'f1-score': 0.09036532897596954, 'support': 60300}, '2': {'precision': 0.30830394615106127, 'recall': 0.5330597672369825, 'f1-score': 0.3906620339299822, 'support': 43134}, 'accuracy': 0.3184599384083419, 'macro avg': {'precision': 0.3646546930989165, 'recall': 0.3522699764370003, 'f1-score': 0.28653437964180944, 'support': 148072}, 'weighted avg': {'precision': 0.37641447450612125, 'recall': 0.3184599384083419, 'f1-score': 0.26472736910924555, 'support': 148072}}
[[21148  1929 21561]
 [27261  3014 30025]
 [18677  1464 22993]]
training model: results/AAL/W6/deepVOL_L3/h10
Epoch 1/50
1766/1766 - 74s - loss: 3.1977 - accuracy10: 0.4506 - val_loss: 2.9257 - val_accuracy10: 0.6408 - 74s/epoch - 42ms/step
Epoch 2/50
1766/1766 - 74s - loss: 2.9903 - accuracy10: 0.3722 - val_loss: 2.7716 - val_accuracy10: 0.5235 - 74s/epoch - 42ms/step
Epoch 3/50
1766/1766 - 72s - loss: 2.7485 - accuracy10: 0.4497 - val_loss: 2.3574 - val_accuracy10: 0.6927 - 72s/epoch - 41ms/step
Epoch 4/50
1766/1766 - 75s - loss: 2.5187 - accuracy10: 0.5780 - val_loss: 2.3052 - val_accuracy10: 0.6758 - 75s/epoch - 42ms/step
Epoch 5/50
1766/1766 - 75s - loss: 2.4465 - accuracy10: 0.6040 - val_loss: 2.2422 - val_accuracy10: 0.7078 - 75s/epoch - 42ms/step
Epoch 6/50
1766/1766 - 74s - loss: 2.4022 - accuracy10: 0.6159 - val_loss: 2.2917 - val_accuracy10: 0.6954 - 74s/epoch - 42ms/step
Epoch 7/50
1766/1766 - 77s - loss: 2.3723 - accuracy10: 0.6242 - val_loss: 2.2671 - val_accuracy10: 0.7027 - 77s/epoch - 43ms/step
Epoch 8/50
1766/1766 - 76s - loss: 2.3466 - accuracy10: 0.6287 - val_loss: 2.2871 - val_accuracy10: 0.7364 - 76s/epoch - 43ms/step
Epoch 9/50
1766/1766 - 79s - loss: 2.3272 - accuracy10: 0.6321 - val_loss: 2.2047 - val_accuracy10: 0.7197 - 79s/epoch - 45ms/step
Epoch 10/50
1766/1766 - 79s - loss: 2.3080 - accuracy10: 0.6367 - val_loss: 2.1814 - val_accuracy10: 0.7244 - 79s/epoch - 45ms/step
Epoch 11/50
1766/1766 - 81s - loss: 2.2954 - accuracy10: 0.6382 - val_loss: 2.2026 - val_accuracy10: 0.7074 - 81s/epoch - 46ms/step
Epoch 12/50
1766/1766 - 77s - loss: 2.2797 - accuracy10: 0.6399 - val_loss: 2.1960 - val_accuracy10: 0.7161 - 77s/epoch - 44ms/step
Epoch 13/50
1766/1766 - 74s - loss: 2.2691 - accuracy10: 0.6419 - val_loss: 2.1801 - val_accuracy10: 0.7282 - 74s/epoch - 42ms/step
Epoch 14/50
1766/1766 - 74s - loss: 2.2587 - accuracy10: 0.6434 - val_loss: 2.1773 - val_accuracy10: 0.7421 - 74s/epoch - 42ms/step
Epoch 15/50
1766/1766 - 72s - loss: 2.2490 - accuracy10: 0.6445 - val_loss: 2.1607 - val_accuracy10: 0.7250 - 72s/epoch - 41ms/step
Epoch 16/50
1766/1766 - 73s - loss: 2.2402 - accuracy10: 0.6466 - val_loss: 2.1479 - val_accuracy10: 0.7297 - 73s/epoch - 41ms/step
Epoch 17/50
1766/1766 - 76s - loss: 2.2314 - accuracy10: 0.6476 - val_loss: 2.1223 - val_accuracy10: 0.7194 - 76s/epoch - 43ms/step
Epoch 18/50
1766/1766 - 75s - loss: 2.2229 - accuracy10: 0.6490 - val_loss: 2.1162 - val_accuracy10: 0.7339 - 75s/epoch - 42ms/step
Epoch 19/50
1766/1766 - 73s - loss: 2.2155 - accuracy10: 0.6501 - val_loss: 2.1130 - val_accuracy10: 0.7205 - 73s/epoch - 41ms/step
Epoch 20/50
1766/1766 - 77s - loss: 2.2107 - accuracy10: 0.6510 - val_loss: 2.1204 - val_accuracy10: 0.7386 - 77s/epoch - 43ms/step
Epoch 21/50
1766/1766 - 73s - loss: 2.2041 - accuracy10: 0.6510 - val_loss: 2.0952 - val_accuracy10: 0.7044 - 73s/epoch - 41ms/step
Epoch 22/50
1766/1766 - 74s - loss: 2.1974 - accuracy10: 0.6525 - val_loss: 2.0918 - val_accuracy10: 0.7160 - 74s/epoch - 42ms/step
Epoch 23/50
1766/1766 - 73s - loss: 2.1923 - accuracy10: 0.6529 - val_loss: 2.1015 - val_accuracy10: 0.7060 - 73s/epoch - 41ms/step
Epoch 24/50
1766/1766 - 74s - loss: 2.1866 - accuracy10: 0.6542 - val_loss: 2.0754 - val_accuracy10: 0.7206 - 74s/epoch - 42ms/step
Epoch 25/50
1766/1766 - 76s - loss: 2.1782 - accuracy10: 0.6558 - val_loss: 2.0932 - val_accuracy10: 0.7316 - 76s/epoch - 43ms/step
Epoch 26/50
1766/1766 - 74s - loss: 2.1747 - accuracy10: 0.6558 - val_loss: 2.1010 - val_accuracy10: 0.7143 - 74s/epoch - 42ms/step
Epoch 27/50
1766/1766 - 71s - loss: 2.1720 - accuracy10: 0.6564 - val_loss: 2.0852 - val_accuracy10: 0.7269 - 71s/epoch - 40ms/step
Epoch 28/50
1766/1766 - 72s - loss: 2.1629 - accuracy10: 0.6575 - val_loss: 2.1039 - val_accuracy10: 0.7327 - 72s/epoch - 41ms/step
Epoch 29/50
1766/1766 - 71s - loss: 2.1601 - accuracy10: 0.6575 - val_loss: 2.0872 - val_accuracy10: 0.7179 - 71s/epoch - 40ms/step
Epoch 30/50
1766/1766 - 74s - loss: 2.1542 - accuracy10: 0.6583 - val_loss: 2.0933 - val_accuracy10: 0.7070 - 74s/epoch - 42ms/step
Epoch 31/50
1766/1766 - 74s - loss: 2.1512 - accuracy10: 0.6589 - val_loss: 2.1122 - val_accuracy10: 0.7271 - 74s/epoch - 42ms/step
Epoch 32/50
1766/1766 - 74s - loss: 2.1464 - accuracy10: 0.6594 - val_loss: 2.1056 - val_accuracy10: 0.7032 - 74s/epoch - 42ms/step
Epoch 33/50
1766/1766 - 76s - loss: 2.1414 - accuracy10: 0.6598 - val_loss: 2.1193 - val_accuracy10: 0.6937 - 76s/epoch - 43ms/step
Epoch 34/50
1766/1766 - 73s - loss: 2.1373 - accuracy10: 0.6594 - val_loss: 2.1206 - val_accuracy10: 0.7225 - 73s/epoch - 41ms/step
testing model: results/AAL/W6/deepVOL_L3/h10
Evaluating performance on  test set...
6203/6203 - 116s - 116s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6585522
{'0': {'precision': 0.42779251829606085, 'recall': 0.5796288431719193, 'f1-score': 0.4922684627934189, 'support': 202502}, '1': {'precision': 0.8941354524344209, 'recall': 0.7723453328049908, 'f1-score': 0.828790046305866, 'support': 1181052}, '2': {'precision': 0.4092091491458047, 'recall': 0.587451057165231, 'f1-score': 0.4823917835691478, 'support': 204320}, 'accuracy': 0.7239768394721495, 'macro avg': {'precision': 0.5770457066254289, 'recall': 0.646475077714047, 'f1-score': 0.6011500975561442, 'support': 1587874}, 'weighted avg': {'precision': 0.7722646244362193, 'recall': 0.7239768394721495, 'f1-score': 0.741300493138043, 'support': 1587874}}
[[117376  54842  30284]
 [125867 912180 143005]
 [ 31133  53159 120028]]
Evaluating performance on  train set...
1766/1766 - 40s - 40s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7080792
{'0': {'precision': 0.40239130909965243, 'recall': 0.6266360309760871, 'f1-score': 0.49008006495710565, 'support': 58755}, '1': {'precision': 0.8964155192144413, 'recall': 0.7276393895536118, 'f1-score': 0.8032576209906171, 'support': 333723}, '2': {'precision': 0.398736649442541, 'recall': 0.6003394216389696, 'f1-score': 0.47919740336382416, 'support': 59513}, 'accuracy': 0.6977484064948196, 'macro avg': {'precision': 0.5658478259188783, 'recall': 0.6515382807228894, 'f1-score': 0.5908450297705157, 'support': 451991}, 'weighted avg': {'precision': 0.76666790246537, 'recall': 0.6977484064948196, 'f1-score': 0.7198786531873373, 'support': 451991}}
[[ 36818  13572   8365]
 [ 45383 242830  45510]
 [  9297  14488  35728]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6666501
{'0': {'precision': 0.40018719580681394, 'recall': 0.6182901434521055, 'f1-score': 0.4858857220782763, 'support': 17288}, '1': {'precision': 0.9140300347535896, 'recall': 0.7531284754757297, 'f1-score': 0.8258147529334946, 'support': 114193}, '2': {'precision': 0.3675699460965861, 'recall': 0.6041829907781328, 'f1-score': 0.45706990105330353, 'support': 16591}, 'accuracy': 0.7206966880976822, 'macro avg': {'precision': 0.5605957255523298, 'recall': 0.6585338699019894, 'f1-score': 0.5895901253550248, 'support': 148072}, 'weighted avg': {'precision': 0.7928076947391357, 'recall': 0.7206966880976822, 'f1-score': 0.7448099787495216, 'support': 148072}}
[[10689  4153  2446]
 [13390 86002 14801]
 [ 2631  3936 10024]]
training model: results/AAL/W6/deepVOL_L3/h20
Epoch 1/50
1766/1766 - 76s - loss: 3.1363 - accuracy20: 0.4117 - val_loss: 2.9215 - val_accuracy20: 0.5857 - 76s/epoch - 43ms/step
Epoch 2/50
1766/1766 - 77s - loss: 2.8146 - accuracy20: 0.4840 - val_loss: 2.5666 - val_accuracy20: 0.6661 - 77s/epoch - 44ms/step
Epoch 3/50
1766/1766 - 76s - loss: 2.6198 - accuracy20: 0.5776 - val_loss: 2.4929 - val_accuracy20: 0.6937 - 76s/epoch - 43ms/step
Epoch 4/50
1766/1766 - 75s - loss: 2.5491 - accuracy20: 0.5962 - val_loss: 2.4472 - val_accuracy20: 0.7049 - 75s/epoch - 42ms/step
Epoch 5/50
1766/1766 - 76s - loss: 2.5081 - accuracy20: 0.6060 - val_loss: 2.3928 - val_accuracy20: 0.7117 - 76s/epoch - 43ms/step
Epoch 6/50
1766/1766 - 75s - loss: 2.4804 - accuracy20: 0.6132 - val_loss: 2.3764 - val_accuracy20: 0.6788 - 75s/epoch - 42ms/step
Epoch 7/50
1766/1766 - 75s - loss: 2.4552 - accuracy20: 0.6176 - val_loss: 2.3973 - val_accuracy20: 0.6598 - 75s/epoch - 42ms/step
Epoch 8/50
1766/1766 - 75s - loss: 2.4381 - accuracy20: 0.6208 - val_loss: 2.3424 - val_accuracy20: 0.7017 - 75s/epoch - 43ms/step
Epoch 9/50
1766/1766 - 74s - loss: 2.4223 - accuracy20: 0.6211 - val_loss: 2.3129 - val_accuracy20: 0.6858 - 74s/epoch - 42ms/step
Epoch 10/50
1766/1766 - 74s - loss: 2.4084 - accuracy20: 0.6238 - val_loss: 2.2808 - val_accuracy20: 0.6858 - 74s/epoch - 42ms/step
Epoch 11/50
1766/1766 - 75s - loss: 2.3964 - accuracy20: 0.6247 - val_loss: 2.2904 - val_accuracy20: 0.6994 - 75s/epoch - 42ms/step
Epoch 12/50
1766/1766 - 75s - loss: 2.3844 - accuracy20: 0.6282 - val_loss: 2.3090 - val_accuracy20: 0.6949 - 75s/epoch - 43ms/step
Epoch 13/50
1766/1766 - 76s - loss: 2.3749 - accuracy20: 0.6294 - val_loss: 2.2704 - val_accuracy20: 0.7021 - 76s/epoch - 43ms/step
Epoch 14/50
1766/1766 - 78s - loss: 2.3649 - accuracy20: 0.6304 - val_loss: 2.2410 - val_accuracy20: 0.6979 - 78s/epoch - 44ms/step
Epoch 15/50
1766/1766 - 78s - loss: 2.3568 - accuracy20: 0.6320 - val_loss: 2.2760 - val_accuracy20: 0.7007 - 78s/epoch - 44ms/step
Epoch 16/50
1766/1766 - 75s - loss: 2.3523 - accuracy20: 0.6327 - val_loss: 2.2519 - val_accuracy20: 0.7028 - 75s/epoch - 42ms/step
Epoch 17/50
1766/1766 - 75s - loss: 2.3451 - accuracy20: 0.6337 - val_loss: 2.2511 - val_accuracy20: 0.7115 - 75s/epoch - 43ms/step
Epoch 18/50
1766/1766 - 75s - loss: 2.3377 - accuracy20: 0.6354 - val_loss: 2.2510 - val_accuracy20: 0.6999 - 75s/epoch - 43ms/step
Epoch 19/50
1766/1766 - 75s - loss: 2.3325 - accuracy20: 0.6352 - val_loss: 2.2548 - val_accuracy20: 0.7086 - 75s/epoch - 42ms/step
Epoch 20/50
1766/1766 - 76s - loss: 2.3281 - accuracy20: 0.6356 - val_loss: 2.2462 - val_accuracy20: 0.7021 - 76s/epoch - 43ms/step
Epoch 21/50
1766/1766 - 77s - loss: 2.3208 - accuracy20: 0.6365 - val_loss: 2.2551 - val_accuracy20: 0.7233 - 77s/epoch - 43ms/step
Epoch 22/50
1766/1766 - 76s - loss: 2.3154 - accuracy20: 0.6377 - val_loss: 2.2472 - val_accuracy20: 0.7213 - 76s/epoch - 43ms/step
Epoch 23/50
1766/1766 - 75s - loss: 2.3098 - accuracy20: 0.6391 - val_loss: 2.2787 - val_accuracy20: 0.7271 - 75s/epoch - 42ms/step
Epoch 24/50
1766/1766 - 75s - loss: 2.3066 - accuracy20: 0.6396 - val_loss: 2.2455 - val_accuracy20: 0.7096 - 75s/epoch - 42ms/step
testing model: results/AAL/W6/deepVOL_L3/h20
Evaluating performance on  test set...
6203/6203 - 119s - 119s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7298065
{'0': {'precision': 0.4658305411181173, 'recall': 0.5328215767634855, 'f1-score': 0.49707913091827904, 'support': 265100}, '1': {'precision': 0.8218844651600906, 'recall': 0.7680714691567296, 'f1-score': 0.794067300870007, 'support': 1054217}, '2': {'precision': 0.45907272472266564, 'recall': 0.5118950539364083, 'f1-score': 0.48404707622157866, 'support': 268557}, 'accuracy': 0.6854687462607234, 'macro avg': {'precision': 0.5822625770002912, 'recall': 0.6042626999522077, 'f1-score': 0.5917311693366215, 'support': 1587874}, 'weighted avg': {'precision': 0.701077947867043, 'recall': 0.6854687462607234, 'f1-score': 0.6920506009775023, 'support': 1587874}}
[[141251  85922  37927]
 [120445 809714 124058]
 [ 41528  89556 137473]]
Evaluating performance on  train set...
1766/1766 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7601314
{'0': {'precision': 0.4522864919699085, 'recall': 0.5787525543974192, 'f1-score': 0.5077634323730055, 'support': 77807}, '1': {'precision': 0.8240574438398741, 'recall': 0.736446918010739, 'f1-score': 0.7777928464871269, 'support': 295929}, '2': {'precision': 0.4585668648605632, 'recall': 0.5154431026771452, 'f1-score': 0.48534437117966983, 'support': 78255}, 'accuracy': 0.6710376976532718, 'macro avg': {'precision': 0.5783036002234486, 'recall': 0.6102141916951012, 'f1-score': 0.5903002166799342, 'support': 451991}, 'weighted avg': {'precision': 0.6967809102138233, 'recall': 0.6710376976532718, 'f1-score': 0.6806764568706025, 'support': 451991}}
[[ 45031  22029  10747]
 [ 41115 217936  36878]
 [ 13417  24502  40336]]
Evaluating performance on  val set...
579/579 - 11s - 11s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.71586096
{'0': {'precision': 0.45222600970974075, 'recall': 0.5728367062107467, 'f1-score': 0.505435723769025, 'support': 22928}, '1': {'precision': 0.8502852688672606, 'recall': 0.7623466376766579, 'f1-score': 0.8039182570511737, 'support': 103024}, '2': {'precision': 0.43488372093023253, 'recall': 0.5241410488245931, 'f1-score': 0.4753587535875359, 'support': 22120}, 'accuracy': 0.6974174725809066, 'macro avg': {'precision': 0.5791316665024113, 'recall': 0.6197747975706659, 'f1-score': 0.5949042448025782, 'support': 148072}, 'weighted avg': {'precision': 0.7265928426534547, 'recall': 0.6974174725809066, 'f1-score': 0.7086177023230091, 'support': 148072}}
[[13134  6944  2850]
 [12268 78540 12216]
 [ 3641  6885 11594]]
training model: results/AAL/W6/deepVOL_L3/h30
Epoch 1/50
1766/1766 - 74s - loss: 3.2303 - accuracy30: 0.4176 - val_loss: 3.0469 - val_accuracy30: 0.5571 - 74s/epoch - 42ms/step
Epoch 2/50
1766/1766 - 70s - loss: 3.0597 - accuracy30: 0.3685 - val_loss: 2.8561 - val_accuracy30: 0.5057 - 70s/epoch - 40ms/step
Epoch 3/50
1766/1766 - 75s - loss: 2.8519 - accuracy30: 0.4994 - val_loss: 2.6504 - val_accuracy30: 0.6137 - 75s/epoch - 42ms/step
Epoch 4/50
1766/1766 - 71s - loss: 2.7304 - accuracy30: 0.5504 - val_loss: 2.6364 - val_accuracy30: 0.6236 - 71s/epoch - 40ms/step
Epoch 5/50
1766/1766 - 71s - loss: 2.6585 - accuracy30: 0.5738 - val_loss: 2.5831 - val_accuracy30: 0.6474 - 71s/epoch - 40ms/step
Epoch 6/50
1766/1766 - 75s - loss: 2.6176 - accuracy30: 0.5838 - val_loss: 2.5723 - val_accuracy30: 0.6323 - 75s/epoch - 42ms/step
Epoch 7/50
1766/1766 - 76s - loss: 2.5911 - accuracy30: 0.5886 - val_loss: 2.5526 - val_accuracy30: 0.6467 - 76s/epoch - 43ms/step
Epoch 8/50
1766/1766 - 72s - loss: 2.5686 - accuracy30: 0.5928 - val_loss: 2.5362 - val_accuracy30: 0.6414 - 72s/epoch - 41ms/step
Epoch 9/50
1766/1766 - 73s - loss: 2.5514 - accuracy30: 0.5958 - val_loss: 2.5143 - val_accuracy30: 0.6621 - 73s/epoch - 41ms/step
Epoch 10/50
1766/1766 - 76s - loss: 2.5335 - accuracy30: 0.5999 - val_loss: 2.5013 - val_accuracy30: 0.6515 - 76s/epoch - 43ms/step
Epoch 11/50
1766/1766 - 75s - loss: 2.5211 - accuracy30: 0.6009 - val_loss: 2.4768 - val_accuracy30: 0.6727 - 75s/epoch - 42ms/step
Epoch 12/50
1766/1766 - 71s - loss: 2.5082 - accuracy30: 0.6036 - val_loss: 2.4612 - val_accuracy30: 0.6602 - 71s/epoch - 40ms/step
Epoch 13/50
1766/1766 - 74s - loss: 2.5003 - accuracy30: 0.6047 - val_loss: 2.4513 - val_accuracy30: 0.6653 - 74s/epoch - 42ms/step
Epoch 14/50
1766/1766 - 70s - loss: 2.4857 - accuracy30: 0.6070 - val_loss: 2.4538 - val_accuracy30: 0.6698 - 70s/epoch - 40ms/step
Epoch 15/50
1766/1766 - 71s - loss: 2.4816 - accuracy30: 0.6078 - val_loss: 2.4463 - val_accuracy30: 0.6641 - 71s/epoch - 40ms/step
Epoch 16/50
1766/1766 - 70s - loss: 2.4724 - accuracy30: 0.6094 - val_loss: 2.3999 - val_accuracy30: 0.6660 - 70s/epoch - 40ms/step
Epoch 17/50
1766/1766 - 72s - loss: 2.4665 - accuracy30: 0.6099 - val_loss: 2.4469 - val_accuracy30: 0.6717 - 72s/epoch - 41ms/step
Epoch 18/50
1766/1766 - 71s - loss: 2.4610 - accuracy30: 0.6119 - val_loss: 2.4025 - val_accuracy30: 0.6707 - 71s/epoch - 40ms/step
Epoch 19/50
1766/1766 - 76s - loss: 2.4544 - accuracy30: 0.6125 - val_loss: 2.4133 - val_accuracy30: 0.6664 - 76s/epoch - 43ms/step
Epoch 20/50
1766/1766 - 70s - loss: 2.4488 - accuracy30: 0.6134 - val_loss: 2.4549 - val_accuracy30: 0.6734 - 70s/epoch - 40ms/step
Epoch 21/50
1766/1766 - 70s - loss: 2.4429 - accuracy30: 0.6146 - val_loss: 2.4474 - val_accuracy30: 0.6697 - 70s/epoch - 40ms/step
Epoch 22/50
1766/1766 - 70s - loss: 2.4391 - accuracy30: 0.6145 - val_loss: 2.4182 - val_accuracy30: 0.6737 - 70s/epoch - 40ms/step
Epoch 23/50
1766/1766 - 70s - loss: 2.4345 - accuracy30: 0.6154 - val_loss: 2.4205 - val_accuracy30: 0.6708 - 70s/epoch - 40ms/step
Epoch 24/50
1766/1766 - 70s - loss: 2.4303 - accuracy30: 0.6164 - val_loss: 2.4276 - val_accuracy30: 0.6669 - 70s/epoch - 40ms/step
Epoch 25/50
1766/1766 - 70s - loss: 2.4242 - accuracy30: 0.6175 - val_loss: 2.4155 - val_accuracy30: 0.6720 - 70s/epoch - 40ms/step
Epoch 26/50
1766/1766 - 75s - loss: 2.4199 - accuracy30: 0.6177 - val_loss: 2.4288 - val_accuracy30: 0.6728 - 75s/epoch - 43ms/step
testing model: results/AAL/W6/deepVOL_L3/h30
Evaluating performance on  test set...
6203/6203 - 122s - 122s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.78000355
{'0': {'precision': 0.5084945508015223, 'recall': 0.4527391919600312, 'f1-score': 0.4789998557157771, 'support': 311643}, '1': {'precision': 0.7521938404503445, 'recall': 0.7793194213747872, 'f1-score': 0.7655164119217058, 'support': 959654}, '2': {'precision': 0.4799472387320847, 'recall': 0.4792862399984838, 'f1-score': 0.479616511621291, 'support': 316577}, 'accuracy': 0.6554052777487382, 'macro avg': {'precision': 0.5802118766613172, 'recall': 0.5704482844444341, 'f1-score': 0.5747109264195912, 'support': 1587874}, 'weighted avg': {'precision': 0.6500861227371069, 'recall': 0.6554052777487382, 'f1-score': 0.6522831126403468, 'support': 1587874}}
[[141093 125178  45372]
 [ 92739 747877 119038]
 [ 43640 121206 151731]]
Evaluating performance on  train set...
1766/1766 - 34s - 34s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7930005
{'0': {'precision': 0.5046499269297197, 'recall': 0.49556425309849966, 'f1-score': 0.5000658241179567, 'support': 91980}, '1': {'precision': 0.7522349512055638, 'recall': 0.7609553277174177, 'f1-score': 0.756570012097283, 'support': 267929}, '2': {'precision': 0.4866272398269927, 'recall': 0.47896440129449835, 'f1-score': 0.4827654148012741, 'support': 92082}, 'accuracy': 0.6494996581790345, 'macro avg': {'precision': 0.5811707059874254, 'recall': 0.5784946607034719, 'f1-score': 0.5798004170055047, 'support': 451991}, 'weighted avg': {'precision': 0.6477404815987492, 'recall': 0.6494996581790345, 'f1-score': 0.6485905829968153, 'support': 451991}}
[[ 45582  33650  12748]
 [ 30267 203882  33780]
 [ 14475  33503  44104]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.76384884
{'0': {'precision': 0.4927525375482228, 'recall': 0.4843531404167587, 'f1-score': 0.48851673752808156, 'support': 27162}, '1': {'precision': 0.7829345850999394, 'recall': 0.7652954422912239, 'f1-score': 0.7740145314179092, 'support': 94587}, '2': {'precision': 0.4486288342497493, 'recall': 0.49283896212437794, 'f1-score': 0.4696958725561188, 'support': 26323}, 'accuracy': 0.6653249770381976, 'macro avg': {'precision': 0.5747719856326372, 'recall': 0.5808291816107869, 'f1-score': 0.5774090471673698, 'support': 148072}, 'weighted avg': {'precision': 0.6702741560165929, 'recall': 0.6653249770381976, 'f1-score': 0.6675442255204106, 'support': 148072}}
[[13156 10500  3506]
 [ 9762 72387 12438]
 [ 3781  9569 12973]]
training model: results/AAL/W6/deepVOL_L3/h50
Epoch 1/50
1766/1766 - 71s - loss: 3.2163 - accuracy50: 0.4121 - val_loss: 3.0444 - val_accuracy50: 0.4150 - 71s/epoch - 40ms/step
Epoch 2/50
1766/1766 - 68s - loss: 3.1261 - accuracy50: 0.3912 - val_loss: 3.0129 - val_accuracy50: 0.3892 - 68s/epoch - 38ms/step
Epoch 3/50
1766/1766 - 68s - loss: 3.0828 - accuracy50: 0.4125 - val_loss: 3.0217 - val_accuracy50: 0.4759 - 68s/epoch - 38ms/step
Epoch 4/50
1766/1766 - 68s - loss: 3.0178 - accuracy50: 0.4593 - val_loss: 2.8945 - val_accuracy50: 0.5303 - 68s/epoch - 39ms/step
Epoch 5/50
1766/1766 - 73s - loss: 2.9178 - accuracy50: 0.5098 - val_loss: 2.7781 - val_accuracy50: 0.5734 - 73s/epoch - 41ms/step
Epoch 6/50
1766/1766 - 73s - loss: 2.8319 - accuracy50: 0.5376 - val_loss: 2.7479 - val_accuracy50: 0.5937 - 73s/epoch - 41ms/step
Epoch 7/50
1766/1766 - 73s - loss: 2.7836 - accuracy50: 0.5498 - val_loss: 2.7582 - val_accuracy50: 0.5924 - 73s/epoch - 42ms/step
Epoch 8/50
1766/1766 - 74s - loss: 2.7557 - accuracy50: 0.5554 - val_loss: 2.7196 - val_accuracy50: 0.6036 - 74s/epoch - 42ms/step
Epoch 9/50
1766/1766 - 73s - loss: 2.7356 - accuracy50: 0.5591 - val_loss: 2.7146 - val_accuracy50: 0.5994 - 73s/epoch - 41ms/step
Epoch 10/50
1766/1766 - 72s - loss: 2.7208 - accuracy50: 0.5618 - val_loss: 2.7243 - val_accuracy50: 0.6055 - 72s/epoch - 41ms/step
Epoch 11/50
1766/1766 - 73s - loss: 2.7074 - accuracy50: 0.5653 - val_loss: 2.7119 - val_accuracy50: 0.6134 - 73s/epoch - 41ms/step
Epoch 12/50
1766/1766 - 70s - loss: 2.6924 - accuracy50: 0.5669 - val_loss: 2.7346 - val_accuracy50: 0.6152 - 70s/epoch - 40ms/step
Epoch 13/50
1766/1766 - 72s - loss: 2.6842 - accuracy50: 0.5686 - val_loss: 2.7472 - val_accuracy50: 0.6198 - 72s/epoch - 41ms/step
Epoch 14/50
1766/1766 - 72s - loss: 2.6732 - accuracy50: 0.5703 - val_loss: 2.7151 - val_accuracy50: 0.6188 - 72s/epoch - 41ms/step
Epoch 15/50
1766/1766 - 73s - loss: 2.6656 - accuracy50: 0.5710 - val_loss: 2.7301 - val_accuracy50: 0.6216 - 73s/epoch - 41ms/step
Epoch 16/50
1766/1766 - 73s - loss: 2.6584 - accuracy50: 0.5736 - val_loss: 2.7588 - val_accuracy50: 0.6199 - 73s/epoch - 41ms/step
Epoch 17/50
1766/1766 - 73s - loss: 2.6512 - accuracy50: 0.5743 - val_loss: 2.7027 - val_accuracy50: 0.6228 - 73s/epoch - 41ms/step
Epoch 18/50
1766/1766 - 73s - loss: 2.6455 - accuracy50: 0.5756 - val_loss: 2.7305 - val_accuracy50: 0.6214 - 73s/epoch - 41ms/step
Epoch 19/50
1766/1766 - 73s - loss: 2.6387 - accuracy50: 0.5766 - val_loss: 2.7130 - val_accuracy50: 0.6192 - 73s/epoch - 41ms/step
Epoch 20/50
1766/1766 - 72s - loss: 2.6334 - accuracy50: 0.5778 - val_loss: 2.7217 - val_accuracy50: 0.6199 - 72s/epoch - 41ms/step
Epoch 21/50
1766/1766 - 73s - loss: 2.6278 - accuracy50: 0.5788 - val_loss: 2.7216 - val_accuracy50: 0.6193 - 73s/epoch - 42ms/step
Epoch 22/50
1766/1766 - 70s - loss: 2.6240 - accuracy50: 0.5800 - val_loss: 2.7090 - val_accuracy50: 0.6201 - 70s/epoch - 40ms/step
Epoch 23/50
1766/1766 - 69s - loss: 2.6176 - accuracy50: 0.5803 - val_loss: 2.7462 - val_accuracy50: 0.6171 - 69s/epoch - 39ms/step
Epoch 24/50
1766/1766 - 74s - loss: 2.6135 - accuracy50: 0.5818 - val_loss: 2.7311 - val_accuracy50: 0.6198 - 74s/epoch - 42ms/step
Epoch 25/50
1766/1766 - 70s - loss: 2.6102 - accuracy50: 0.5814 - val_loss: 2.7136 - val_accuracy50: 0.6228 - 70s/epoch - 40ms/step
Epoch 26/50
1766/1766 - 74s - loss: 2.6048 - accuracy50: 0.5828 - val_loss: 2.7261 - val_accuracy50: 0.6224 - 74s/epoch - 42ms/step
Epoch 27/50
1766/1766 - 73s - loss: 2.6024 - accuracy50: 0.5830 - val_loss: 2.6828 - val_accuracy50: 0.6231 - 73s/epoch - 41ms/step
Epoch 28/50
1766/1766 - 74s - loss: 2.5959 - accuracy50: 0.5854 - val_loss: 2.6926 - val_accuracy50: 0.6162 - 74s/epoch - 42ms/step
Epoch 29/50
1766/1766 - 74s - loss: 2.5926 - accuracy50: 0.5846 - val_loss: 2.7065 - val_accuracy50: 0.6187 - 74s/epoch - 42ms/step
Epoch 30/50
1766/1766 - 74s - loss: 2.5885 - accuracy50: 0.5866 - val_loss: 2.6900 - val_accuracy50: 0.6189 - 74s/epoch - 42ms/step
Epoch 31/50
1766/1766 - 73s - loss: 2.5846 - accuracy50: 0.5868 - val_loss: 2.6919 - val_accuracy50: 0.6212 - 73s/epoch - 41ms/step
Epoch 32/50
1766/1766 - 74s - loss: 2.5818 - accuracy50: 0.5872 - val_loss: 2.7430 - val_accuracy50: 0.6195 - 74s/epoch - 42ms/step
Epoch 33/50
1766/1766 - 67s - loss: 2.5771 - accuracy50: 0.5888 - val_loss: 2.6600 - val_accuracy50: 0.6142 - 67s/epoch - 38ms/step
Epoch 34/50
1766/1766 - 67s - loss: 2.5735 - accuracy50: 0.5887 - val_loss: 2.7038 - val_accuracy50: 0.6147 - 67s/epoch - 38ms/step
Epoch 35/50
1766/1766 - 67s - loss: 2.5692 - accuracy50: 0.5902 - val_loss: 2.6890 - val_accuracy50: 0.6156 - 67s/epoch - 38ms/step
Epoch 36/50
1766/1766 - 67s - loss: 2.5643 - accuracy50: 0.5905 - val_loss: 2.6949 - val_accuracy50: 0.6174 - 67s/epoch - 38ms/step
Epoch 37/50
1766/1766 - 69s - loss: 2.5605 - accuracy50: 0.5909 - val_loss: 2.7207 - val_accuracy50: 0.6163 - 69s/epoch - 39ms/step
Epoch 38/50
1766/1766 - 69s - loss: 2.5579 - accuracy50: 0.5906 - val_loss: 2.7059 - val_accuracy50: 0.6157 - 69s/epoch - 39ms/step
Epoch 39/50
1766/1766 - 70s - loss: 2.5560 - accuracy50: 0.5915 - val_loss: 2.7187 - val_accuracy50: 0.6161 - 70s/epoch - 39ms/step
Epoch 40/50
1766/1766 - 69s - loss: 2.5515 - accuracy50: 0.5926 - val_loss: 2.7005 - val_accuracy50: 0.6165 - 69s/epoch - 39ms/step
Epoch 41/50
1766/1766 - 69s - loss: 2.5484 - accuracy50: 0.5925 - val_loss: 2.7165 - val_accuracy50: 0.6186 - 69s/epoch - 39ms/step
Epoch 42/50
1766/1766 - 70s - loss: 2.5428 - accuracy50: 0.5939 - val_loss: 2.7255 - val_accuracy50: 0.6145 - 70s/epoch - 39ms/step
Epoch 43/50
1766/1766 - 71s - loss: 2.5407 - accuracy50: 0.5947 - val_loss: 2.7225 - val_accuracy50: 0.6152 - 71s/epoch - 40ms/step
testing model: results/AAL/W6/deepVOL_L3/h50
Evaluating performance on  test set...
6203/6203 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.87681794
{'0': {'precision': 0.504643895585674, 'recall': 0.36551539645780495, 'f1-score': 0.4239571196943379, 'support': 381289}, '1': {'precision': 0.645803233521594, 'recall': 0.7765830712175437, 'f1-score': 0.7051809439101674, 'support': 816751}, '2': {'precision': 0.504839845124956, 'recall': 0.4267790905872756, 'f1-score': 0.4625390956226803, 'support': 389834}, 'accuracy': 0.5919959644153125, 'macro avg': {'precision': 0.5517623247440747, 'recall': 0.5229591860875414, 'f1-score': 0.5305590530757286, 'support': 1587874}, 'weighted avg': {'precision': 0.5772997978872402, 'recall': 0.5919959644153125, 'f1-score': 0.5780816948534201, 'support': 1587874}}
[[139367 174672  67250]
 [ 86543 634275  95933]
 [ 50259 173202 166373]]
Evaluating performance on  train set...
1766/1766 - 39s - 39s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.865387
{'0': {'precision': 0.541311920647104, 'recall': 0.40426657730194987, 'f1-score': 0.46285806601439844, 'support': 113393}, '1': {'precision': 0.640300061303627, 'recall': 0.7828003530043062, 'f1-score': 0.7044156673384282, 'support': 225493}, '2': {'precision': 0.5200646083663469, 'recall': 0.42131647584103266, 'f1-score': 0.4655113464300019, 'support': 113105}, 'accuracy': 0.5973791513547836, 'macro avg': {'precision': 0.5672255301056927, 'recall': 0.5361278020490962, 'f1-score': 0.5442616932609429, 'support': 451991}, 'weighted avg': {'precision': 0.5853790714212264, 'recall': 0.5973791513547836, 'f1-score': 0.584032265228025, 'support': 451991}}
[[ 45841  49066  18486]
 [ 23487 176516  25490]
 [ 15357  50095  47653]]
Evaluating performance on  val set...
579/579 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.848257
{'0': {'precision': 0.5150401836969001, 'recall': 0.39562571655348794, 'f1-score': 0.4475036161404558, 'support': 34017}, '1': {'precision': 0.679259474153585, 'recall': 0.7785947410554838, 'f1-score': 0.7255428545195796, 'support': 81195}, '2': {'precision': 0.4874450178367333, 'recall': 0.42830188679245285, 'f1-score': 0.4559635851165503, 'support': 32860}, 'accuracy': 0.612877519044789, 'macro avg': {'precision': 0.5605815585624062, 'recall': 0.5341741148004748, 'f1-score': 0.5430033519255285, 'support': 148072}, 'weighted avg': {'precision': 0.5989656263090445, 'recall': 0.612877519044789, 'f1-score': 0.6018433329049179, 'support': 148072}}
[[13458 15296  5263]
 [ 8441 63218  9536]
 [ 4231 14555 14074]]
training model: results/AAL/W6/deepVOL_L3/h100
Epoch 1/50
1766/1766 - 72s - loss: 3.2815 - accuracy100: 0.3835 - val_loss: 3.2581 - val_accuracy100: 0.4057 - 72s/epoch - 41ms/step
Epoch 2/50
1766/1766 - 69s - loss: 3.2284 - accuracy100: 0.4034 - val_loss: 3.2012 - val_accuracy100: 0.4113 - 69s/epoch - 39ms/step
Epoch 3/50
1766/1766 - 67s - loss: 3.1955 - accuracy100: 0.4227 - val_loss: 3.2486 - val_accuracy100: 0.4125 - 67s/epoch - 38ms/step
Epoch 4/50
1766/1766 - 68s - loss: 3.1795 - accuracy100: 0.4266 - val_loss: 3.2135 - val_accuracy100: 0.4125 - 68s/epoch - 39ms/step
Epoch 5/50
1766/1766 - 68s - loss: 3.1397 - accuracy100: 0.4438 - val_loss: 3.2778 - val_accuracy100: 0.4191 - 68s/epoch - 38ms/step
Epoch 6/50
1766/1766 - 68s - loss: 3.1143 - accuracy100: 0.4517 - val_loss: 3.1973 - val_accuracy100: 0.4203 - 68s/epoch - 38ms/step
Epoch 7/50
1766/1766 - 68s - loss: 3.0956 - accuracy100: 0.4581 - val_loss: 3.1520 - val_accuracy100: 0.4324 - 68s/epoch - 39ms/step
Epoch 8/50
1766/1766 - 68s - loss: 3.0663 - accuracy100: 0.4687 - val_loss: 3.1019 - val_accuracy100: 0.4640 - 68s/epoch - 38ms/step
Epoch 9/50
1766/1766 - 68s - loss: 3.0255 - accuracy100: 0.4812 - val_loss: 3.0754 - val_accuracy100: 0.4891 - 68s/epoch - 39ms/step
Epoch 10/50
1766/1766 - 67s - loss: 2.9949 - accuracy100: 0.4872 - val_loss: 3.0257 - val_accuracy100: 0.4976 - 67s/epoch - 38ms/step
Epoch 11/50
1766/1766 - 67s - loss: 2.9699 - accuracy100: 0.4926 - val_loss: 3.0195 - val_accuracy100: 0.4954 - 67s/epoch - 38ms/step
Epoch 12/50
1766/1766 - 69s - loss: 2.9559 - accuracy100: 0.4963 - val_loss: 3.0155 - val_accuracy100: 0.4961 - 69s/epoch - 39ms/step
Epoch 13/50
1766/1766 - 69s - loss: 2.9432 - accuracy100: 0.4988 - val_loss: 3.0472 - val_accuracy100: 0.4901 - 69s/epoch - 39ms/step
Epoch 14/50
1766/1766 - 69s - loss: 2.9344 - accuracy100: 0.5017 - val_loss: 3.0180 - val_accuracy100: 0.4939 - 69s/epoch - 39ms/step
Epoch 15/50
1766/1766 - 68s - loss: 2.9261 - accuracy100: 0.5039 - val_loss: 3.0190 - val_accuracy100: 0.4962 - 68s/epoch - 38ms/step
Epoch 16/50
1766/1766 - 65s - loss: 2.9197 - accuracy100: 0.5054 - val_loss: 3.0134 - val_accuracy100: 0.4932 - 65s/epoch - 37ms/step
Epoch 17/50
1766/1766 - 64s - loss: 2.9144 - accuracy100: 0.5070 - val_loss: 3.0277 - val_accuracy100: 0.4938 - 64s/epoch - 36ms/step
Epoch 18/50
1766/1766 - 65s - loss: 2.9095 - accuracy100: 0.5080 - val_loss: 3.0263 - val_accuracy100: 0.4930 - 65s/epoch - 37ms/step
Epoch 19/50
1766/1766 - 65s - loss: 2.9048 - accuracy100: 0.5090 - val_loss: 3.0332 - val_accuracy100: 0.4913 - 65s/epoch - 37ms/step
Epoch 20/50
1766/1766 - 66s - loss: 2.9010 - accuracy100: 0.5096 - val_loss: 3.0280 - val_accuracy100: 0.4944 - 66s/epoch - 37ms/step
Epoch 21/50
1766/1766 - 64s - loss: 2.8969 - accuracy100: 0.5107 - val_loss: 3.0333 - val_accuracy100: 0.4918 - 64s/epoch - 36ms/step
Epoch 22/50
1766/1766 - 65s - loss: 2.8923 - accuracy100: 0.5121 - val_loss: 3.0432 - val_accuracy100: 0.4926 - 65s/epoch - 37ms/step
Epoch 23/50
1766/1766 - 64s - loss: 2.8894 - accuracy100: 0.5126 - val_loss: 3.0141 - val_accuracy100: 0.4947 - 64s/epoch - 36ms/step
Epoch 24/50
1766/1766 - 64s - loss: 2.8842 - accuracy100: 0.5145 - val_loss: 3.0176 - val_accuracy100: 0.4948 - 64s/epoch - 36ms/step
Epoch 25/50
1766/1766 - 65s - loss: 2.8791 - accuracy100: 0.5154 - val_loss: 3.0224 - val_accuracy100: 0.4917 - 65s/epoch - 37ms/step
Epoch 26/50
1766/1766 - 65s - loss: 2.8753 - accuracy100: 0.5161 - val_loss: 3.0308 - val_accuracy100: 0.4933 - 65s/epoch - 37ms/step
testing model: results/AAL/W6/deepVOL_L3/h100
Evaluating performance on  test set...
6203/6203 - 110s - 110s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0124222
{'0': {'precision': 0.5281724522113591, 'recall': 0.26276663102936443, 'f1-score': 0.35094003776231925, 'support': 481705}, '1': {'precision': 0.45034546435851575, 'recall': 0.8284353143123464, 'f1-score': 0.5834965500541229, 'support': 609362}, '2': {'precision': 0.5194702336428038, 'recall': 0.2376375534161153, 'f1-score': 0.32609791500075264, 'support': 496807}, 'accuracy': 0.4719851827034135, 'macro avg': {'precision': 0.4993293834042262, 'recall': 0.442946499585942, 'f1-score': 0.4201781676057316, 'support': 1587874}, 'weighted avg': {'precision': 0.4955828814567699, 'recall': 0.4719851827034135, 'f1-score': 0.4324133542599459, 'support': 1587874}}
[[126576 297188  57941]
 [ 53276 504817  51269]
 [ 59797 318950 118060]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0195346
{'0': {'precision': 0.5350943486762395, 'recall': 0.30741345683351595, 'f1-score': 0.39048944682266634, 'support': 145101}, '1': {'precision': 0.43913747350501525, 'recall': 0.8041012163070717, 'f1-score': 0.5680501732531655, 'support': 163610}, '2': {'precision': 0.5127525526830328, 'recall': 0.2470896147403685, 'f1-score': 0.3334793359237018, 'support': 143280}, 'accuracy': 0.4680801166394906, 'macro avg': {'precision': 0.4956614582880958, 'recall': 0.4528680959603187, 'f1-score': 0.4306729853331779, 'support': 451991}, 'weighted avg': {'precision': 0.4932779477375689, 'recall': 0.4680801166394906, 'f1-score': 0.43669014940676726, 'support': 451991}}
[[ 44606  81230  19265]
 [ 17674 131559  14377]
 [ 21081  86796  35403]]
Evaluating performance on  val set...
579/579 - 12s - 12s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9956594
{'0': {'precision': 0.5194963940838528, 'recall': 0.2863752751448722, 'f1-score': 0.3692174038948816, 'support': 44522}, '1': {'precision': 0.4834971249863919, 'recall': 0.8069439397443098, 'f1-score': 0.6046848407958659, 'support': 60542}, '2': {'precision': 0.5129858578671174, 'recall': 0.26820591517857145, 'f1-score': 0.35224600726784133, 'support': 43008}, 'accuracy': 0.4939421362580366, 'macro avg': {'precision': 0.5053264589791208, 'recall': 0.45384171002258444, 'f1-score': 0.44204941731952957, 'support': 148072}, 'weighted avg': {'precision': 0.5028864145380384, 'recall': 0.4939421362580366, 'f1-score': 0.46056326090176775, 'support': 148072}}
[[12750 26328  5444]
 [ 6181 48854  5507]
 [ 5612 25861 11535]]
training model: results/AAL/W6/deepVOL_L3/h200
Epoch 1/50
1766/1766 - 71s - loss: 3.2918 - accuracy200: 0.3670 - val_loss: 3.3171 - val_accuracy200: 0.3423 - 71s/epoch - 40ms/step
Epoch 2/50
1766/1766 - 67s - loss: 3.2870 - accuracy200: 0.3636 - val_loss: 3.3004 - val_accuracy200: 0.3445 - 67s/epoch - 38ms/step
Epoch 3/50
1766/1766 - 65s - loss: 3.2794 - accuracy200: 0.3674 - val_loss: 3.2948 - val_accuracy200: 0.3497 - 65s/epoch - 37ms/step
Epoch 4/50
1766/1766 - 65s - loss: 3.2707 - accuracy200: 0.3750 - val_loss: 3.2848 - val_accuracy200: 0.3620 - 65s/epoch - 37ms/step
Epoch 5/50
1766/1766 - 65s - loss: 3.2466 - accuracy200: 0.3902 - val_loss: 3.2694 - val_accuracy200: 0.3774 - 65s/epoch - 37ms/step
Epoch 6/50
1766/1766 - 66s - loss: 3.2193 - accuracy200: 0.4081 - val_loss: 3.2632 - val_accuracy200: 0.3966 - 66s/epoch - 37ms/step
Epoch 7/50
1766/1766 - 65s - loss: 3.2011 - accuracy200: 0.4170 - val_loss: 3.2417 - val_accuracy200: 0.4077 - 65s/epoch - 37ms/step
Epoch 8/50
1766/1766 - 65s - loss: 3.1890 - accuracy200: 0.4228 - val_loss: 3.2327 - val_accuracy200: 0.4070 - 65s/epoch - 37ms/step
Epoch 9/50
1766/1766 - 65s - loss: 3.1773 - accuracy200: 0.4280 - val_loss: 3.2272 - val_accuracy200: 0.4073 - 65s/epoch - 37ms/step
Epoch 10/50
1766/1766 - 65s - loss: 3.1670 - accuracy200: 0.4314 - val_loss: 3.2186 - val_accuracy200: 0.4080 - 65s/epoch - 37ms/step
Epoch 11/50
1766/1766 - 65s - loss: 3.1577 - accuracy200: 0.4337 - val_loss: 3.2156 - val_accuracy200: 0.4073 - 65s/epoch - 37ms/step
Epoch 12/50
1766/1766 - 66s - loss: 3.1495 - accuracy200: 0.4361 - val_loss: 3.2041 - val_accuracy200: 0.4092 - 66s/epoch - 38ms/step
Epoch 13/50
1766/1766 - 65s - loss: 3.1433 - accuracy200: 0.4393 - val_loss: 3.2176 - val_accuracy200: 0.4033 - 65s/epoch - 37ms/step
Epoch 14/50
1766/1766 - 65s - loss: 3.1358 - accuracy200: 0.4414 - val_loss: 3.2148 - val_accuracy200: 0.4042 - 65s/epoch - 37ms/step
Epoch 15/50
1766/1766 - 64s - loss: 3.1295 - accuracy200: 0.4428 - val_loss: 3.2110 - val_accuracy200: 0.4079 - 64s/epoch - 36ms/step
Epoch 16/50
1766/1766 - 65s - loss: 3.1268 - accuracy200: 0.4444 - val_loss: 3.2055 - val_accuracy200: 0.4078 - 65s/epoch - 37ms/step
Epoch 17/50
1766/1766 - 65s - loss: 3.1212 - accuracy200: 0.4467 - val_loss: 3.2030 - val_accuracy200: 0.4067 - 65s/epoch - 37ms/step
Epoch 18/50
1766/1766 - 65s - loss: 3.1144 - accuracy200: 0.4485 - val_loss: 3.2293 - val_accuracy200: 0.4045 - 65s/epoch - 37ms/step
Epoch 19/50
1766/1766 - 64s - loss: 3.1099 - accuracy200: 0.4507 - val_loss: 3.2175 - val_accuracy200: 0.4062 - 64s/epoch - 36ms/step
Epoch 20/50
1766/1766 - 64s - loss: 3.1073 - accuracy200: 0.4512 - val_loss: 3.1934 - val_accuracy200: 0.4150 - 64s/epoch - 36ms/step
Epoch 21/50
1766/1766 - 64s - loss: 3.1002 - accuracy200: 0.4539 - val_loss: 3.1974 - val_accuracy200: 0.4111 - 64s/epoch - 36ms/step
Epoch 22/50
1766/1766 - 65s - loss: 3.0944 - accuracy200: 0.4559 - val_loss: 3.2063 - val_accuracy200: 0.4091 - 65s/epoch - 37ms/step
Epoch 23/50
1766/1766 - 64s - loss: 3.0890 - accuracy200: 0.4582 - val_loss: 3.2089 - val_accuracy200: 0.4103 - 64s/epoch - 36ms/step
Epoch 24/50
1766/1766 - 66s - loss: 3.0822 - accuracy200: 0.4609 - val_loss: 3.2355 - val_accuracy200: 0.4025 - 66s/epoch - 37ms/step
Epoch 25/50
1766/1766 - 65s - loss: 3.0774 - accuracy200: 0.4625 - val_loss: 3.2343 - val_accuracy200: 0.3999 - 65s/epoch - 37ms/step
Epoch 26/50
1766/1766 - 64s - loss: 3.0707 - accuracy200: 0.4651 - val_loss: 3.2370 - val_accuracy200: 0.4021 - 64s/epoch - 36ms/step
Epoch 27/50
1766/1766 - 65s - loss: 3.0653 - accuracy200: 0.4660 - val_loss: 3.2476 - val_accuracy200: 0.4010 - 65s/epoch - 37ms/step
Epoch 28/50
1766/1766 - 64s - loss: 3.0597 - accuracy200: 0.4683 - val_loss: 3.2734 - val_accuracy200: 0.3985 - 64s/epoch - 36ms/step
Epoch 29/50
1766/1766 - 64s - loss: 3.0529 - accuracy200: 0.4716 - val_loss: 3.2849 - val_accuracy200: 0.4002 - 64s/epoch - 37ms/step
Epoch 30/50
1766/1766 - 65s - loss: 3.0476 - accuracy200: 0.4722 - val_loss: 3.2841 - val_accuracy200: 0.3970 - 65s/epoch - 37ms/step
testing model: results/AAL/W6/deepVOL_L3/h200
Evaluating performance on  test set...
6203/6203 - 106s - 106s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0945323
{'0': {'precision': 0.4008508703559366, 'recall': 0.2719942465182621, 'f1-score': 0.32408388710663, 'support': 499176}, '1': {'precision': 0.3951615740599573, 'recall': 0.5966324505128882, 'f1-score': 0.47543383492648955, 'support': 564743}, '2': {'precision': 0.4123680918464115, 'recall': 0.31204779036367625, 'f1-score': 0.35526154253984227, 'support': 523955}, 'accuracy': 0.40067158981128226, 'macro avg': {'precision': 0.4027935120874351, 'recall': 0.3935581624649422, 'f1-score': 0.3849264215243206, 'support': 1587874}, 'weighted avg': {'precision': 0.40262778434782864, 'recall': 0.40067158981128226, 'f1-score': 0.38820075786220615, 'support': 1587874}}
[[135773 256178 107225]
 [102035 336944 125764]
 [100904 259552 163499]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0654728
{'0': {'precision': 0.45933869526362825, 'recall': 0.3254874396043491, 'f1-score': 0.38099897337825267, 'support': 157917}, '1': {'precision': 0.37826631954488477, 'recall': 0.6087490125268028, 'f1-score': 0.46659710546091504, 'support': 141776}, '2': {'precision': 0.4420838209936656, 'recall': 0.3249024937950597, 'f1-score': 0.3745415873472431, 'support': 152298}, 'accuracy': 0.4141409895329774, 'macro avg': {'precision': 0.4265629452673929, 'recall': 0.4197129819754039, 'f1-score': 0.4073792220621369, 'support': 451991}, 'weighted avg': {'precision': 0.4280947103580276, 'recall': 0.4141409895329774, 'f1-score': 0.4056727252812792, 'support': 451991}}
[[51400 73186 33331]
 [26354 86306 29116]
 [34146 68670 49482]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0646107
{'0': {'precision': 0.43846918189756406, 'recall': 0.2940214428493549, 'f1-score': 0.3520027073412459, 'support': 49527}, '1': {'precision': 0.39945963332261175, 'recall': 0.6119038234134805, 'f1-score': 0.4833690110146732, 'support': 50740}, '2': {'precision': 0.42489767341663076, 'recall': 0.33007007635184604, 'f1-score': 0.37152847270458317, 'support': 47805}, 'accuracy': 0.41458884866821544, 'macro avg': {'precision': 0.42094216287893554, 'recall': 0.4119984475382272, 'f1-score': 0.4023000636868341, 'support': 148072}, 'weighted avg': {'precision': 0.4207201783207629, 'recall': 0.41458884866821544, 'f1-score': 0.40332203484127316, 'support': 148072}}
[[14562 24292 10673]
 [ 9008 31048 10684]
 [ 9641 22385 15779]]
training model: results/AAL/W6/deepVOL_L3/h300
Epoch 1/50
1766/1766 - 71s - loss: 3.3003 - accuracy300: 0.3610 - val_loss: 3.2924 - val_accuracy300: 0.3521 - 71s/epoch - 40ms/step
Epoch 2/50
1766/1766 - 66s - loss: 3.2833 - accuracy300: 0.3684 - val_loss: 3.2889 - val_accuracy300: 0.3512 - 66s/epoch - 38ms/step
Epoch 3/50
1766/1766 - 66s - loss: 3.2769 - accuracy300: 0.3715 - val_loss: 3.2834 - val_accuracy300: 0.3540 - 66s/epoch - 38ms/step
Epoch 4/50
1766/1766 - 65s - loss: 3.2704 - accuracy300: 0.3782 - val_loss: 3.2793 - val_accuracy300: 0.3570 - 65s/epoch - 37ms/step
Epoch 5/50
1766/1766 - 65s - loss: 3.2656 - accuracy300: 0.3819 - val_loss: 3.2826 - val_accuracy300: 0.3546 - 65s/epoch - 37ms/step
Epoch 6/50
1766/1766 - 64s - loss: 3.2613 - accuracy300: 0.3864 - val_loss: 3.2790 - val_accuracy300: 0.3589 - 64s/epoch - 36ms/step
Epoch 7/50
1766/1766 - 65s - loss: 3.2562 - accuracy300: 0.3897 - val_loss: 3.2824 - val_accuracy300: 0.3564 - 65s/epoch - 37ms/step
Epoch 8/50
1766/1766 - 65s - loss: 3.2521 - accuracy300: 0.3929 - val_loss: 3.2836 - val_accuracy300: 0.3543 - 65s/epoch - 37ms/step
Epoch 9/50
1766/1766 - 69s - loss: 3.2468 - accuracy300: 0.3973 - val_loss: 3.2850 - val_accuracy300: 0.3580 - 69s/epoch - 39ms/step
Epoch 10/50
1766/1766 - 67s - loss: 3.2420 - accuracy300: 0.4004 - val_loss: 3.2794 - val_accuracy300: 0.3639 - 67s/epoch - 38ms/step
Epoch 11/50
1766/1766 - 65s - loss: 3.2377 - accuracy300: 0.4036 - val_loss: 3.2787 - val_accuracy300: 0.3681 - 65s/epoch - 37ms/step
Epoch 12/50
1766/1766 - 67s - loss: 3.2297 - accuracy300: 0.4077 - val_loss: 3.2814 - val_accuracy300: 0.3632 - 67s/epoch - 38ms/step
Epoch 13/50
1766/1766 - 67s - loss: 3.2237 - accuracy300: 0.4110 - val_loss: 3.2775 - val_accuracy300: 0.3669 - 67s/epoch - 38ms/step
Epoch 14/50
1766/1766 - 67s - loss: 3.2201 - accuracy300: 0.4126 - val_loss: 3.2756 - val_accuracy300: 0.3688 - 67s/epoch - 38ms/step
Epoch 15/50
1766/1766 - 67s - loss: 3.2124 - accuracy300: 0.4161 - val_loss: 3.2748 - val_accuracy300: 0.3691 - 67s/epoch - 38ms/step
Epoch 16/50
1766/1766 - 67s - loss: 3.2036 - accuracy300: 0.4214 - val_loss: 3.2806 - val_accuracy300: 0.3703 - 67s/epoch - 38ms/step
Epoch 17/50
1766/1766 - 67s - loss: 3.1962 - accuracy300: 0.4253 - val_loss: 3.2840 - val_accuracy300: 0.3691 - 67s/epoch - 38ms/step
Epoch 18/50
1766/1766 - 65s - loss: 3.1888 - accuracy300: 0.4282 - val_loss: 3.2985 - val_accuracy300: 0.3696 - 65s/epoch - 37ms/step
Epoch 19/50
1766/1766 - 65s - loss: 3.1842 - accuracy300: 0.4301 - val_loss: 3.3112 - val_accuracy300: 0.3707 - 65s/epoch - 37ms/step
Epoch 20/50
1766/1766 - 64s - loss: 3.1782 - accuracy300: 0.4331 - val_loss: 3.3378 - val_accuracy300: 0.3673 - 64s/epoch - 36ms/step
Epoch 21/50
1766/1766 - 64s - loss: 3.1716 - accuracy300: 0.4367 - val_loss: 3.3437 - val_accuracy300: 0.3685 - 64s/epoch - 36ms/step
Epoch 22/50
1766/1766 - 64s - loss: 3.1644 - accuracy300: 0.4397 - val_loss: 3.3704 - val_accuracy300: 0.3694 - 64s/epoch - 36ms/step
Epoch 23/50
1766/1766 - 64s - loss: 3.1609 - accuracy300: 0.4409 - val_loss: 3.3575 - val_accuracy300: 0.3676 - 64s/epoch - 36ms/step
Epoch 24/50
1766/1766 - 65s - loss: 3.1534 - accuracy300: 0.4447 - val_loss: 3.3910 - val_accuracy300: 0.3640 - 65s/epoch - 37ms/step
Epoch 25/50
1766/1766 - 65s - loss: 3.1512 - accuracy300: 0.4437 - val_loss: 3.3856 - val_accuracy300: 0.3642 - 65s/epoch - 37ms/step
testing model: results/AAL/W6/deepVOL_L3/h300
Evaluating performance on  test set...
6203/6203 - 105s - 105s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940188
{'0': {'precision': 0.38142918054822833, 'recall': 0.20701130963937409, 'f1-score': 0.26837090756548215, 'support': 509919}, '1': {'precision': 0.3560086678931065, 'recall': 0.33601508181100836, 'f1-score': 0.34572305276712667, 'support': 537336}, '2': {'precision': 0.3720491710501276, 'recall': 0.5532842907851925, 'f1-score': 0.44491844341909936, 'support': 540619}, 'accuracy': 0.36856072962968095, 'macro avg': {'precision': 0.3698290064971541, 'recall': 0.36543689407852503, 'f1-score': 0.35300413458390273, 'support': 1587874}, 'weighted avg': {'precision': 0.3696333025737125, 'recall': 0.36856072962968095, 'f1-score': 0.3546554897046932, 'support': 1587874}}
[[105559 165342 239018]
 [ 90948 180553 265835]
 [ 80239 161264 299116]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0908194
{'0': {'precision': 0.43471992234340207, 'recall': 0.19916287891174259, 'f1-score': 0.2731737509923438, 'support': 152905}, '1': {'precision': 0.3636206495362829, 'recall': 0.3584775812234144, 'f1-score': 0.361030799899666, 'support': 152573}, '2': {'precision': 0.36840241184499234, 'recall': 0.5821599448513102, 'f1-score': 0.4512468356272006, 'support': 146513}, 'accuracy': 0.3770893668236757, 'macro avg': {'precision': 0.38891432790822583, 'recall': 0.3799334683288224, 'f1-score': 0.36181712883973677, 'support': 451991}, 'weighted avg': {'precision': 0.389222983763532, 'recall': 0.3770893668236757, 'f1-score': 0.3605530027297537, 'support': 451991}}
[[30453 52355 70097]
 [21746 54694 76133]
 [17853 43366 85294]]
Evaluating performance on  val set...
579/579 - 9s - 9s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0933467
{'0': {'precision': 0.4141536737932966, 'recall': 0.18106861504551205, 'f1-score': 0.2519738710593581, 'support': 48998}, '1': {'precision': 0.3698367943361666, 'recall': 0.34480773658761227, 'f1-score': 0.35688396802542083, 'support': 52116}, '2': {'precision': 0.35198114295230654, 'recall': 0.585118616636143, 'f1-score': 0.43954918852334446, 'support': 46958}, 'accuracy': 0.3668350532173537, 'macro avg': {'precision': 0.37865720369392325, 'recall': 0.37033165608975577, 'f1-score': 0.3494690092027078, 'support': 148072}, 'weighted avg': {'precision': 0.3788389877417879, 'recall': 0.3668350532173537, 'f1-score': 0.34838410642429674, 'support': 148072}}
[[ 8872 16465 23661]
 [ 7222 17970 26924]
 [ 5328 14154 27476]]
training model: results/AAL/W6/deepVOL_L3/h500
Epoch 1/50
1766/1766 - 70s - loss: 3.2490 - accuracy500: 0.3835 - val_loss: 3.3358 - val_accuracy500: 0.2935 - 70s/epoch - 40ms/step
Epoch 2/50
1766/1766 - 65s - loss: 3.2492 - accuracy500: 0.3829 - val_loss: 3.3416 - val_accuracy500: 0.2965 - 65s/epoch - 37ms/step
Epoch 3/50
1766/1766 - 66s - loss: 3.2538 - accuracy500: 0.3899 - val_loss: 3.3454 - val_accuracy500: 0.2978 - 66s/epoch - 38ms/step
Epoch 4/50
1766/1766 - 64s - loss: 3.2507 - accuracy500: 0.3924 - val_loss: 3.3557 - val_accuracy500: 0.2985 - 64s/epoch - 36ms/step
Epoch 5/50
1766/1766 - 65s - loss: 3.2494 - accuracy500: 0.3962 - val_loss: 3.3508 - val_accuracy500: 0.3057 - 65s/epoch - 37ms/step
Epoch 6/50
1766/1766 - 65s - loss: 3.2470 - accuracy500: 0.4000 - val_loss: 3.3543 - val_accuracy500: 0.3064 - 65s/epoch - 37ms/step
Epoch 7/50
1766/1766 - 65s - loss: 3.2428 - accuracy500: 0.4022 - val_loss: 3.3546 - val_accuracy500: 0.3081 - 65s/epoch - 37ms/step
Epoch 8/50
1766/1766 - 71s - loss: 3.2419 - accuracy500: 0.4050 - val_loss: 3.3556 - val_accuracy500: 0.3063 - 71s/epoch - 40ms/step
Epoch 9/50
1766/1766 - 72s - loss: 3.2406 - accuracy500: 0.4066 - val_loss: 3.3575 - val_accuracy500: 0.3049 - 72s/epoch - 41ms/step
Epoch 10/50
1766/1766 - 67s - loss: 3.2358 - accuracy500: 0.4096 - val_loss: 3.3575 - val_accuracy500: 0.3108 - 67s/epoch - 38ms/step
Epoch 11/50
1766/1766 - 72s - loss: 3.2283 - accuracy500: 0.4153 - val_loss: 3.3578 - val_accuracy500: 0.3105 - 72s/epoch - 41ms/step
testing model: results/AAL/W6/deepVOL_L3/h500
Evaluating performance on  test set...
6203/6203 - 112s - 112s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1216038
{'0': {'precision': 0.20995388335024776, 'recall': 0.3342639729599686, 'f1-score': 0.25791149030958455, 'support': 336686}, '1': {'precision': 0.5533993312790927, 'recall': 0.009563507080008974, 'f1-score': 0.018802088031906306, 'support': 882626}, '2': {'precision': 0.2327701721704552, 'recall': 0.6546713985706611, 'f1-score': 0.34343212935833944, 'support': 368562}, 'accuracy': 0.22814782533122904, 'macro avg': {'precision': 0.3320411289332652, 'recall': 0.3328329595368796, 'f1-score': 0.20671523589994342, 'support': 1587874}, 'weighted avg': {'precision': 0.4061552815492219, 'recall': 0.22814782533122904, 'f1-score': 0.14485181584822876, 'support': 1587874}}
[[112542   3215 220929]
 [299812   8441 574373]
 [123678   3597 241287]]
Evaluating performance on  train set...
1766/1766 - 30s - 30s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0993202
{'0': {'precision': 0.34831851307080297, 'recall': 0.33349763470044874, 'f1-score': 0.3407469905522472, 'support': 156217}, '1': {'precision': 0.3115202786762876, 'recall': 0.008500757056239433, 'f1-score': 0.01654990085922009, 'support': 147281}, '2': {'precision': 0.3300480559781771, 'recall': 0.6632433852100772, 'f1-score': 0.44076125264323834, 'support': 148493}, 'accuracy': 0.3359292552285333, 'macro avg': {'precision': 0.32996228257508925, 'recall': 0.3350805923222551, 'f1-score': 0.26601938135156855, 'support': 451991}, 'weighted avg': {'precision': 0.33032542085234307, 'recall': 0.3359292552285333, 'f1-score': 0.2679653339564274, 'support': 451991}}
[[ 52098   1418 102701]
 [ 48815   1252  97214]
 [ 48657   1349  98487]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076975
{'0': {'precision': 0.2989674376201518, 'recall': 0.3427396451048554, 'f1-score': 0.3193606435905579, 'support': 44013}, '1': {'precision': 0.398923904688701, 'recall': 0.008496496627594788, 'f1-score': 0.01663861505169512, 'support': 61084}, '2': {'precision': 0.2901551176360654, 'recall': 0.6502850494473531, 'f1-score': 0.4012664316636633, 'support': 42975}, 'accuracy': 0.2941136744286563, 'macro avg': {'precision': 0.3293488199816394, 'recall': 0.3338403970599344, 'f1-score': 0.2457552301019721, 'support': 148072}, 'weighted avg': {'precision': 0.33764477960985373, 'recall': 0.2941136744286563, 'f1-score': 0.2182505677570027, 'support': 148072}}
[[15085   389 28539]
 [20736   519 39829]
 [14636   393 27946]]
training model: results/AAL/W6/deepVOL_L3/h1000
Epoch 1/50
1766/1766 - 71s - loss: 3.2355 - accuracy1000: 0.4078 - val_loss: 3.5948 - val_accuracy1000: 0.2973 - 71s/epoch - 40ms/step
Epoch 2/50
1766/1766 - 67s - loss: 3.2426 - accuracy1000: 0.4094 - val_loss: 3.5770 - val_accuracy1000: 0.3014 - 67s/epoch - 38ms/step
Epoch 3/50
1766/1766 - 67s - loss: 3.2365 - accuracy1000: 0.4053 - val_loss: 3.5348 - val_accuracy1000: 0.2922 - 67s/epoch - 38ms/step
Epoch 4/50
1766/1766 - 66s - loss: 3.2664 - accuracy1000: 0.3888 - val_loss: 3.5062 - val_accuracy1000: 0.2960 - 66s/epoch - 37ms/step
Epoch 5/50
1766/1766 - 66s - loss: 3.2674 - accuracy1000: 0.3863 - val_loss: 3.5017 - val_accuracy1000: 0.2948 - 66s/epoch - 37ms/step
Epoch 6/50
1766/1766 - 67s - loss: 3.2423 - accuracy1000: 0.4048 - val_loss: 3.5878 - val_accuracy1000: 0.2960 - 67s/epoch - 38ms/step
Epoch 7/50
1766/1766 - 66s - loss: 3.2444 - accuracy1000: 0.4037 - val_loss: 3.5560 - val_accuracy1000: 0.2933 - 66s/epoch - 37ms/step
Epoch 8/50
1766/1766 - 67s - loss: 3.2568 - accuracy1000: 0.3973 - val_loss: 3.4983 - val_accuracy1000: 0.2937 - 67s/epoch - 38ms/step
Epoch 9/50
1766/1766 - 68s - loss: 3.2575 - accuracy1000: 0.3967 - val_loss: 3.5525 - val_accuracy1000: 0.2966 - 68s/epoch - 39ms/step
Epoch 10/50
1766/1766 - 65s - loss: 3.2498 - accuracy1000: 0.4013 - val_loss: 3.5092 - val_accuracy1000: 0.2901 - 65s/epoch - 37ms/step
Epoch 11/50
1766/1766 - 69s - loss: 3.2473 - accuracy1000: 0.3995 - val_loss: 3.5417 - val_accuracy1000: 0.2906 - 69s/epoch - 39ms/step
Epoch 12/50
1766/1766 - 66s - loss: 3.2401 - accuracy1000: 0.4055 - val_loss: 3.5554 - val_accuracy1000: 0.2914 - 66s/epoch - 38ms/step
Epoch 13/50
1766/1766 - 68s - loss: 3.2311 - accuracy1000: 0.4110 - val_loss: 3.6106 - val_accuracy1000: 0.2894 - 68s/epoch - 38ms/step
Epoch 14/50
1766/1766 - 66s - loss: 3.2138 - accuracy1000: 0.4218 - val_loss: 3.5740 - val_accuracy1000: 0.2936 - 66s/epoch - 37ms/step
Epoch 15/50
1766/1766 - 65s - loss: 3.2197 - accuracy1000: 0.4157 - val_loss: 3.5847 - val_accuracy1000: 0.2914 - 65s/epoch - 37ms/step
Epoch 16/50
1766/1766 - 68s - loss: 3.1971 - accuracy1000: 0.4247 - val_loss: 3.6005 - val_accuracy1000: 0.2910 - 68s/epoch - 38ms/step
Epoch 17/50
1766/1766 - 66s - loss: 3.1844 - accuracy1000: 0.4304 - val_loss: 3.6550 - val_accuracy1000: 0.2952 - 66s/epoch - 38ms/step
Epoch 18/50
1766/1766 - 66s - loss: 3.1898 - accuracy1000: 0.4276 - val_loss: 3.6138 - val_accuracy1000: 0.2947 - 66s/epoch - 37ms/step
testing model: results/AAL/W6/deepVOL_L3/h1000
Evaluating performance on  test set...
6203/6203 - 106s - 106s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.171609
{'0': {'precision': 0.21826366844008893, 'recall': 0.04686839417618697, 'f1-score': 0.07716658291604668, 'support': 421030}, '1': {'precision': 0.6060606060606061, 'recall': 2.892627127346463e-05, 'f1-score': 5.7849781472450486e-05, 'support': 691413}, '2': {'precision': 0.3008577351091736, 'recall': 0.9475907124272502, 'f1-score': 0.4567108815969482, 'support': 475431}, 'accuracy': 0.2961614082729486, 'macro avg': {'precision': 0.3750606698699562, 'recall': 0.3314960109582369, 'f1-score': 0.1779784380981558, 'support': 1587874}, 'weighted avg': {'precision': 0.4118530991767621, 'recall': 0.2961614082729486, 'f1-score': 0.15723159119969154, 'support': 1587874}}
[[ 19733      7 401290]
 [ 45765     20 645628]
 [ 24911      6 450514]]
Evaluating performance on  train set...
1766/1766 - 29s - 29s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1303593
{'0': {'precision': 0.39737621667371986, 'recall': 0.0605974560684577, 'f1-score': 0.10515883015001092, 'support': 154957}, '1': {'precision': 0.39285714285714285, 'recall': 7.318695941450433e-05, 'f1-score': 0.00014634665531371402, 'support': 150300}, '2': {'precision': 0.33037146332409595, 'recall': 0.9643913476085979, 'f1-score': 0.49214787146541183, 'support': 146734}, 'accuracy': 0.3338783294357631, 'macro avg': {'precision': 0.37353494095165285, 'recall': 0.34168733021215675, 'f1-score': 0.19915101609024546, 'support': 451991}, 'weighted avg': {'precision': 0.3741211247080939, 'recall': 0.3338783294357631, 'f1-score': 0.19587097645186438, 'support': 451991}}
[[  9390      6 145561]
 [  9026     11 141263]
 [  5214     11 141509]]
Evaluating performance on  val set...
579/579 - 10s - 10s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1669272
{'0': {'precision': 0.28496536229170566, 'recall': 0.06819301940051077, 'f1-score': 0.11005061460592913, 'support': 44638}, '1': {'precision': 0.5714285714285714, 'recall': 6.633499170812604e-05, 'f1-score': 0.0001326545840449699, 'support': 60300}, '2': {'precision': 0.29411935974611125, 'recall': 0.9367784114619557, 'f1-score': 0.447680827844469, 'support': 43134}, 'accuracy': 0.2934720946566535, 'macro avg': {'precision': 0.38350443115546273, 'recall': 0.3350125886180582, 'f1-score': 0.185954699011481, 'support': 148072}, 'weighted avg': {'precision': 0.4042896102059051, 'recall': 0.2934720946566535, 'f1-score': 0.16364135849073896, 'support': 148072}}
[[ 3044     0 41594]
 [ 4914     4 55382]
 [ 2724     3 40407]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        27 (peak)  14.61 (ave)

============================================
