This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-10-09.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-01.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-18.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-19.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-27.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-23.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-25.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-11.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-24.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-07.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-26.csv
data/EXC_orderbooks/EXC_orderbooks_2019-09-17.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-03.csv
data/EXC_orderbooks/EXC_orderbooks_2019-10-02.csv
training model: results/EXC/W7/deepLOB_L1/h10
Epoch 1/50
1254/1254 - 55s - loss: 2.7450 - accuracy10: 0.4663 - val_loss: 2.6760 - val_accuracy10: 0.5173 - 55s/epoch - 44ms/step
Epoch 2/50
1254/1254 - 29s - loss: 2.5138 - accuracy10: 0.5449 - val_loss: 2.6350 - val_accuracy10: 0.5155 - 29s/epoch - 23ms/step
Epoch 3/50
1254/1254 - 29s - loss: 2.3753 - accuracy10: 0.5926 - val_loss: 2.5411 - val_accuracy10: 0.5895 - 29s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 28s - loss: 2.2944 - accuracy10: 0.6145 - val_loss: 2.4562 - val_accuracy10: 0.6067 - 28s/epoch - 22ms/step
Epoch 5/50
1254/1254 - 29s - loss: 2.2504 - accuracy10: 0.6213 - val_loss: 2.4163 - val_accuracy10: 0.6115 - 29s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 28s - loss: 2.2270 - accuracy10: 0.6245 - val_loss: 2.4010 - val_accuracy10: 0.6352 - 28s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 2.2050 - accuracy10: 0.6273 - val_loss: 2.3608 - val_accuracy10: 0.6364 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 2.1894 - accuracy10: 0.6303 - val_loss: 2.3744 - val_accuracy10: 0.6364 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 2.1747 - accuracy10: 0.6306 - val_loss: 2.3282 - val_accuracy10: 0.6337 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 2.1612 - accuracy10: 0.6332 - val_loss: 2.3435 - val_accuracy10: 0.6276 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 30s - loss: 2.1521 - accuracy10: 0.6339 - val_loss: 2.3226 - val_accuracy10: 0.6303 - 30s/epoch - 24ms/step
Epoch 12/50
1254/1254 - 29s - loss: 2.1436 - accuracy10: 0.6345 - val_loss: 2.3072 - val_accuracy10: 0.6306 - 29s/epoch - 23ms/step
Epoch 13/50
1254/1254 - 29s - loss: 2.1349 - accuracy10: 0.6356 - val_loss: 2.3026 - val_accuracy10: 0.6430 - 29s/epoch - 23ms/step
Epoch 14/50
1254/1254 - 30s - loss: 2.1279 - accuracy10: 0.6367 - val_loss: 2.3033 - val_accuracy10: 0.6318 - 30s/epoch - 24ms/step
Epoch 15/50
1254/1254 - 29s - loss: 2.1219 - accuracy10: 0.6373 - val_loss: 2.3026 - val_accuracy10: 0.6244 - 29s/epoch - 24ms/step
Epoch 16/50
1254/1254 - 29s - loss: 2.1134 - accuracy10: 0.6391 - val_loss: 2.3055 - val_accuracy10: 0.6365 - 29s/epoch - 23ms/step
Epoch 17/50
1254/1254 - 30s - loss: 2.1085 - accuracy10: 0.6396 - val_loss: 2.2906 - val_accuracy10: 0.6228 - 30s/epoch - 24ms/step
Epoch 18/50
1254/1254 - 30s - loss: 2.1037 - accuracy10: 0.6399 - val_loss: 2.2934 - val_accuracy10: 0.6327 - 30s/epoch - 24ms/step
Epoch 19/50
1254/1254 - 28s - loss: 2.0976 - accuracy10: 0.6401 - val_loss: 2.3311 - val_accuracy10: 0.6366 - 28s/epoch - 23ms/step
Epoch 20/50
1254/1254 - 29s - loss: 2.0929 - accuracy10: 0.6419 - val_loss: 2.3187 - val_accuracy10: 0.6310 - 29s/epoch - 23ms/step
Epoch 21/50
1254/1254 - 30s - loss: 2.0883 - accuracy10: 0.6418 - val_loss: 2.3251 - val_accuracy10: 0.6238 - 30s/epoch - 24ms/step
Epoch 22/50
1254/1254 - 29s - loss: 2.0853 - accuracy10: 0.6417 - val_loss: 2.2990 - val_accuracy10: 0.6250 - 29s/epoch - 23ms/step
Epoch 23/50
1254/1254 - 30s - loss: 2.0808 - accuracy10: 0.6433 - val_loss: 2.2672 - val_accuracy10: 0.6171 - 30s/epoch - 24ms/step
Epoch 24/50
1254/1254 - 29s - loss: 2.0780 - accuracy10: 0.6426 - val_loss: 2.2975 - val_accuracy10: 0.6292 - 29s/epoch - 23ms/step
Epoch 25/50
1254/1254 - 30s - loss: 2.0715 - accuracy10: 0.6442 - val_loss: 2.3010 - val_accuracy10: 0.6190 - 30s/epoch - 24ms/step
Epoch 26/50
1254/1254 - 30s - loss: 2.0675 - accuracy10: 0.6444 - val_loss: 2.2746 - val_accuracy10: 0.6229 - 30s/epoch - 24ms/step
Epoch 27/50
1254/1254 - 29s - loss: 2.0617 - accuracy10: 0.6446 - val_loss: 2.2693 - val_accuracy10: 0.6160 - 29s/epoch - 23ms/step
Epoch 28/50
1254/1254 - 30s - loss: 2.0585 - accuracy10: 0.6453 - val_loss: 2.2997 - val_accuracy10: 0.6209 - 30s/epoch - 24ms/step
Epoch 29/50
1254/1254 - 30s - loss: 2.0560 - accuracy10: 0.6450 - val_loss: 2.3080 - val_accuracy10: 0.6294 - 30s/epoch - 24ms/step
Epoch 30/50
1254/1254 - 30s - loss: 2.0524 - accuracy10: 0.6455 - val_loss: 2.3114 - val_accuracy10: 0.6308 - 30s/epoch - 24ms/step
Epoch 31/50
1254/1254 - 30s - loss: 2.0486 - accuracy10: 0.6455 - val_loss: 2.3049 - val_accuracy10: 0.6247 - 30s/epoch - 24ms/step
Epoch 32/50
1254/1254 - 29s - loss: 2.0437 - accuracy10: 0.6462 - val_loss: 2.2886 - val_accuracy10: 0.6201 - 29s/epoch - 23ms/step
Epoch 33/50
1254/1254 - 29s - loss: 2.0431 - accuracy10: 0.6461 - val_loss: 2.3148 - val_accuracy10: 0.6267 - 29s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h10
Evaluating performance on  test set...
5929/5929 - 89s - 89s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7263905
{'0': {'precision': 0.2854652071509801, 'recall': 0.5998595640823815, 'f1-score': 0.38683890993746295, 'support': 176593}, '1': {'precision': 0.8764372791576085, 'recall': 0.7030376710302841, 'f1-score': 0.7802193044844242, 'support': 1166387}, '2': {'precision': 0.39875941935514464, 'recall': 0.4816115193621737, 'f1-score': 0.43628684539591445, 'support': 174593}, 'accuracy': 0.6655567804645971, 'macro avg': {'precision': 0.5202206352212444, 'recall': 0.5948362514916131, 'f1-score': 0.5344483532726007, 'support': 1517573}, 'weighted avg': {'precision': 0.7527129234341223, 'recall': 0.6655567804645971, 'f1-score': 0.6948748605309065, 'support': 1517573}}
[[105931  47272  23390]
 [242980 820014 103393]
 [ 22171  68336  84086]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7448659
{'0': {'precision': 0.30334012952746464, 'recall': 0.7499629355077836, 'f1-score': 0.4319627684556595, 'support': 40470}, '1': {'precision': 0.8899511038672396, 'recall': 0.6261785912368275, 'f1-score': 0.7351196012963743, 'support': 239799}, '2': {'precision': 0.4119799950179163, 'recall': 0.5282685078257451, 'f1-score': 0.4629330577266757, 'support': 40699}, 'accuracy': 0.6293711522644002, 'macro avg': {'precision': 0.5350904094708736, 'recall': 0.6348033448567855, 'f1-score': 0.5433384758262365, 'support': 320968}, 'weighted avg': {'precision': 0.7553797687478842, 'recall': 0.6293711522644002, 'f1-score': 0.6623818917371445, 'support': 320968}}
[[ 30351   5791   4328]
 [ 63283 150157  26359]
 [  6422  12777  21500]]
Evaluating performance on  val set...
427/427 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75074214
{'0': {'precision': 0.2760742878928163, 'recall': 0.7827362569487338, 'f1-score': 0.40818134235213593, 'support': 12952}, '1': {'precision': 0.903077977844333, 'recall': 0.6019289047092212, 'f1-score': 0.7223737570535856, 'support': 83156}, '2': {'precision': 0.42712301471019165, 'recall': 0.5562085018698009, 'f1-score': 0.4831929987403037, 'support': 13103}, 'accuracy': 0.6178864766369688, 'macro avg': {'precision': 0.535425093482447, 'recall': 0.6469578878425853, 'f1-score': 0.5379160327153417, 'support': 109211}, 'weighted avg': {'precision': 0.7716132932045192, 'recall': 0.6178864766369688, 'f1-score': 0.6564151482010697, 'support': 109211}}
[[10138  1530  1284]
 [24611 50054  8491]
 [ 1973  3842  7288]]
training model: results/EXC/W7/deepLOB_L1/h20
Epoch 1/50
1254/1254 - 33s - loss: 2.8083 - accuracy20: 0.4682 - val_loss: 2.9172 - val_accuracy20: 0.5095 - 33s/epoch - 26ms/step
Epoch 2/50
1254/1254 - 30s - loss: 2.6497 - accuracy20: 0.5178 - val_loss: 2.7684 - val_accuracy20: 0.5612 - 30s/epoch - 24ms/step
Epoch 3/50
1254/1254 - 30s - loss: 2.5134 - accuracy20: 0.5769 - val_loss: 2.6815 - val_accuracy20: 0.6028 - 30s/epoch - 24ms/step
Epoch 4/50
1254/1254 - 30s - loss: 2.4390 - accuracy20: 0.5961 - val_loss: 2.6622 - val_accuracy20: 0.6038 - 30s/epoch - 24ms/step
Epoch 5/50
1254/1254 - 30s - loss: 2.3986 - accuracy20: 0.6047 - val_loss: 2.6008 - val_accuracy20: 0.6027 - 30s/epoch - 24ms/step
Epoch 6/50
1254/1254 - 30s - loss: 2.3706 - accuracy20: 0.6096 - val_loss: 2.5685 - val_accuracy20: 0.5976 - 30s/epoch - 24ms/step
Epoch 7/50
1254/1254 - 29s - loss: 2.3434 - accuracy20: 0.6119 - val_loss: 2.5590 - val_accuracy20: 0.5917 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 2.3234 - accuracy20: 0.6130 - val_loss: 2.5367 - val_accuracy20: 0.6033 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 30s - loss: 2.3072 - accuracy20: 0.6138 - val_loss: 2.5484 - val_accuracy20: 0.5976 - 30s/epoch - 24ms/step
Epoch 10/50
1254/1254 - 30s - loss: 2.2968 - accuracy20: 0.6154 - val_loss: 2.5456 - val_accuracy20: 0.5875 - 30s/epoch - 24ms/step
Epoch 11/50
1254/1254 - 29s - loss: 2.2867 - accuracy20: 0.6167 - val_loss: 2.5481 - val_accuracy20: 0.5890 - 29s/epoch - 23ms/step
Epoch 12/50
1254/1254 - 29s - loss: 2.2782 - accuracy20: 0.6178 - val_loss: 2.5352 - val_accuracy20: 0.5914 - 29s/epoch - 23ms/step
Epoch 13/50
1254/1254 - 29s - loss: 2.2708 - accuracy20: 0.6183 - val_loss: 2.5515 - val_accuracy20: 0.5987 - 29s/epoch - 23ms/step
Epoch 14/50
1254/1254 - 29s - loss: 2.2651 - accuracy20: 0.6196 - val_loss: 2.5078 - val_accuracy20: 0.5927 - 29s/epoch - 23ms/step
Epoch 15/50
1254/1254 - 30s - loss: 2.2593 - accuracy20: 0.6197 - val_loss: 2.4850 - val_accuracy20: 0.5924 - 30s/epoch - 24ms/step
Epoch 16/50
1254/1254 - 30s - loss: 2.2529 - accuracy20: 0.6209 - val_loss: 2.5303 - val_accuracy20: 0.5826 - 30s/epoch - 24ms/step
Epoch 17/50
1254/1254 - 29s - loss: 2.2473 - accuracy20: 0.6206 - val_loss: 2.5491 - val_accuracy20: 0.5900 - 29s/epoch - 23ms/step
Epoch 18/50
1254/1254 - 29s - loss: 2.2442 - accuracy20: 0.6214 - val_loss: 2.5486 - val_accuracy20: 0.5852 - 29s/epoch - 23ms/step
Epoch 19/50
1254/1254 - 29s - loss: 2.2379 - accuracy20: 0.6217 - val_loss: 2.4999 - val_accuracy20: 0.5888 - 29s/epoch - 23ms/step
Epoch 20/50
1254/1254 - 29s - loss: 2.2341 - accuracy20: 0.6213 - val_loss: 2.5441 - val_accuracy20: 0.5721 - 29s/epoch - 23ms/step
Epoch 21/50
1254/1254 - 29s - loss: 2.2326 - accuracy20: 0.6218 - val_loss: 2.5150 - val_accuracy20: 0.5828 - 29s/epoch - 24ms/step
Epoch 22/50
1254/1254 - 29s - loss: 2.2254 - accuracy20: 0.6230 - val_loss: 2.5529 - val_accuracy20: 0.5720 - 29s/epoch - 23ms/step
Epoch 23/50
1254/1254 - 29s - loss: 2.2243 - accuracy20: 0.6238 - val_loss: 2.5630 - val_accuracy20: 0.5691 - 29s/epoch - 23ms/step
Epoch 24/50
1254/1254 - 30s - loss: 2.2187 - accuracy20: 0.6234 - val_loss: 2.5961 - val_accuracy20: 0.5695 - 30s/epoch - 24ms/step
Epoch 25/50
1254/1254 - 29s - loss: 2.2154 - accuracy20: 0.6238 - val_loss: 2.5408 - val_accuracy20: 0.5701 - 29s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h20
Evaluating performance on  test set...
5929/5929 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.78289604
{'0': {'precision': 0.35686702158664774, 'recall': 0.6292450002141236, 'f1-score': 0.45543870089857197, 'support': 233510}, '1': {'precision': 0.8106870472059959, 'recall': 0.6780786413298319, 'f1-score': 0.7384769487181878, 'support': 1051381}, '2': {'precision': 0.45998427811832043, 'recall': 0.4476366886995986, 'f1-score': 0.45372649297130585, 'support': 232682}, 'accuracy': 0.6352320448505607, 'macro avg': {'precision': 0.5425127823036546, 'recall': 0.5849867767478514, 'f1-score': 0.5492140475293552, 'support': 1517573}, 'weighted avg': {'precision': 0.6870859183645943, 'recall': 0.6352320448505607, 'f1-score': 0.6512662729928985, 'support': 1517573}}
[[146935  67245  19330]
 [235513 712919 102949]
 [ 29288  99237 104157]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81142175
{'0': {'precision': 0.3570206177165675, 'recall': 0.7246246301435318, 'f1-score': 0.47835634387207915, 'support': 54413}, '1': {'precision': 0.7937826235426119, 'recall': 0.6145965137580027, 'f1-score': 0.6927907694600263, 'support': 211804}, '2': {'precision': 0.49745363903990375, 'recall': 0.42282332742780954, 'f1-score': 0.45711239238606743, 'support': 54751}, 'accuracy': 0.6005365020812043, 'macro avg': {'precision': 0.5494189600996944, 'recall': 0.5873481571097813, 'f1-score': 0.5427531685727243, 'support': 320968}, 'weighted avg': {'precision': 0.6691912647357516, 'recall': 0.6005365020812043, 'f1-score': 0.6162359502173189, 'support': 320968}}
[[ 39429  11714   3270]
 [ 61513 130174  20117]
 [  9497  22104  23150]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8045718
{'0': {'precision': 0.33413910833104893, 'recall': 0.7609534619750283, 'f1-score': 0.46437044348624174, 'support': 17620}, '1': {'precision': 0.8161819043107532, 'recall': 0.5834055694008018, 'f1-score': 0.680436310788503, 'support': 73832}, '2': {'precision': 0.511803298792078, 'recall': 0.4700152035587589, 'f1-score': 0.49001996007984033, 'support': 17759}, 'accuracy': 0.5936123650548022, 'macro avg': {'precision': 0.5540414371446267, 'recall': 0.604791411644863, 'f1-score': 0.544942238118195, 'support': 109211}, 'weighted avg': {'precision': 0.6889140126096558, 'recall': 0.5936123650548022, 'f1-score': 0.6146124967578561, 'support': 109211}}
[[13408  3095  1117]
 [23913 43074  6845]
 [ 2806  6606  8347]]
training model: results/EXC/W7/deepLOB_L1/h30
Epoch 1/50
1254/1254 - 31s - loss: 2.8987 - accuracy30: 0.4597 - val_loss: 3.1796 - val_accuracy30: 0.4432 - 31s/epoch - 25ms/step
Epoch 2/50
1254/1254 - 30s - loss: 2.7982 - accuracy30: 0.4879 - val_loss: 2.8038 - val_accuracy30: 0.5774 - 30s/epoch - 24ms/step
Epoch 3/50
1254/1254 - 29s - loss: 2.6683 - accuracy30: 0.5539 - val_loss: 2.7507 - val_accuracy30: 0.5808 - 29s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 29s - loss: 2.5912 - accuracy30: 0.5766 - val_loss: 2.7144 - val_accuracy30: 0.5869 - 29s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 29s - loss: 2.5502 - accuracy30: 0.5849 - val_loss: 2.7229 - val_accuracy30: 0.5783 - 29s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 29s - loss: 2.5247 - accuracy30: 0.5875 - val_loss: 2.7000 - val_accuracy30: 0.5738 - 29s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 2.5041 - accuracy30: 0.5894 - val_loss: 2.7279 - val_accuracy30: 0.5717 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 2.4886 - accuracy30: 0.5905 - val_loss: 2.7059 - val_accuracy30: 0.5667 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 28s - loss: 2.4742 - accuracy30: 0.5925 - val_loss: 2.7143 - val_accuracy30: 0.5731 - 28s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 28s - loss: 2.4587 - accuracy30: 0.5940 - val_loss: 2.6774 - val_accuracy30: 0.5701 - 28s/epoch - 22ms/step
Epoch 11/50
1254/1254 - 28s - loss: 2.4491 - accuracy30: 0.5957 - val_loss: 2.6772 - val_accuracy30: 0.5656 - 28s/epoch - 22ms/step
Epoch 12/50
1254/1254 - 29s - loss: 2.4391 - accuracy30: 0.5970 - val_loss: 2.6743 - val_accuracy30: 0.5690 - 29s/epoch - 23ms/step
Epoch 13/50
1254/1254 - 29s - loss: 2.4278 - accuracy30: 0.5988 - val_loss: 2.6926 - val_accuracy30: 0.5688 - 29s/epoch - 23ms/step
Epoch 14/50
1254/1254 - 29s - loss: 2.4212 - accuracy30: 0.5986 - val_loss: 2.6462 - val_accuracy30: 0.5655 - 29s/epoch - 23ms/step
Epoch 15/50
1254/1254 - 29s - loss: 2.4153 - accuracy30: 0.5992 - val_loss: 2.7213 - val_accuracy30: 0.5695 - 29s/epoch - 23ms/step
Epoch 16/50
1254/1254 - 28s - loss: 2.4094 - accuracy30: 0.5999 - val_loss: 2.7369 - val_accuracy30: 0.5663 - 28s/epoch - 22ms/step
Epoch 17/50
1254/1254 - 29s - loss: 2.4035 - accuracy30: 0.6003 - val_loss: 2.7195 - val_accuracy30: 0.5699 - 29s/epoch - 23ms/step
Epoch 18/50
1254/1254 - 29s - loss: 2.3974 - accuracy30: 0.6006 - val_loss: 2.7457 - val_accuracy30: 0.5665 - 29s/epoch - 23ms/step
Epoch 19/50
1254/1254 - 29s - loss: 2.3916 - accuracy30: 0.6008 - val_loss: 2.6953 - val_accuracy30: 0.5694 - 29s/epoch - 23ms/step
Epoch 20/50
1254/1254 - 29s - loss: 2.3865 - accuracy30: 0.6024 - val_loss: 2.7358 - val_accuracy30: 0.5626 - 29s/epoch - 24ms/step
Epoch 21/50
1254/1254 - 29s - loss: 2.3823 - accuracy30: 0.6027 - val_loss: 2.7037 - val_accuracy30: 0.5610 - 29s/epoch - 23ms/step
Epoch 22/50
1254/1254 - 28s - loss: 2.3784 - accuracy30: 0.6028 - val_loss: 2.7197 - val_accuracy30: 0.5624 - 28s/epoch - 23ms/step
Epoch 23/50
1254/1254 - 29s - loss: 2.3733 - accuracy30: 0.6037 - val_loss: 2.7230 - val_accuracy30: 0.5589 - 29s/epoch - 23ms/step
Epoch 24/50
1254/1254 - 28s - loss: 2.3699 - accuracy30: 0.6045 - val_loss: 2.7160 - val_accuracy30: 0.5608 - 28s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h30
Evaluating performance on  test set...
5929/5929 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8315221
{'0': {'precision': 0.3863015638375703, 'recall': 0.6519585478719937, 'f1-score': 0.48514356616384047, 'support': 276174}, '1': {'precision': 0.7593618310366314, 'recall': 0.6387515144498154, 'f1-score': 0.6938543590273384, 'support': 967348}, '2': {'precision': 0.4950562090733599, 'recall': 0.4295222422103915, 'f1-score': 0.45996670730563627, 'support': 274051}, 'accuracy': 0.6033713040492945, 'macro avg': {'precision': 0.5469065346491871, 'recall': 0.5734107681774002, 'f1-score': 0.546321544165605, 'support': 1517573}, 'weighted avg': {'precision': 0.6437411879189098, 'recall': 0.6033713040492945, 'f1-score': 0.6136357208792771, 'support': 1517573}}
[[180054  75936  20184]
 [249575 617895  99878]
 [ 36468 119872 117711]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.88032585
{'0': {'precision': 0.39540366855343234, 'recall': 0.7130424104744508, 'f1-score': 0.5087114118948278, 'support': 65149}, '1': {'precision': 0.7209395053267709, 'recall': 0.6084944602489338, 'f1-score': 0.6599616175384466, 'support': 190171}, '2': {'precision': 0.5381984036488028, 'recall': 0.3523031927857665, 'f1-score': 0.4258476721812541, 'support': 65648}, 'accuracy': 0.577316118740809, 'macro avg': {'precision': 0.5515138591763353, 'recall': 0.5579466878363837, 'f1-score': 0.5315069005381762, 'support': 320968}, 'weighted avg': {'precision': 0.6174870674734599, 'recall': 0.577316118740809, 'f1-score': 0.5813777339977663, 'support': 320968}}
[[ 46454  15509   3186]
 [ 57794 115718  16659]
 [ 13237  29283  23128]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8751371
{'0': {'precision': 0.36867798806163526, 'recall': 0.7447653767059264, 'f1-score': 0.4932062273669875, 'support': 21396}, '1': {'precision': 0.7394093706770384, 'recall': 0.5562996817352218, 'f1-score': 0.6349159895331221, 'support': 66297}, '2': {'precision': 0.551893234016139, 'recall': 0.4131889580816061, 'f1-score': 0.4725736153927926, 'support': 21518}, 'accuracy': 0.5650255010942121, 'macro avg': {'precision': 0.5533268642516043, 'recall': 0.5714180055075848, 'f1-score': 0.5335652774309675, 'support': 109211}, 'weighted avg': {'precision': 0.6298312064709749, 'recall': 0.5650255010942121, 'f1-score': 0.5751664654187176, 'support': 109211}}
[[15935  4330  1131]
 [23328 36881  6088]
 [ 3959  8668  8891]]
training model: results/EXC/W7/deepLOB_L1/h50
Epoch 1/50
1254/1254 - 34s - loss: 2.9946 - accuracy50: 0.4730 - val_loss: 3.1627 - val_accuracy50: 0.4862 - 34s/epoch - 27ms/step
Epoch 2/50
1254/1254 - 32s - loss: 2.9257 - accuracy50: 0.4958 - val_loss: 3.0995 - val_accuracy50: 0.4882 - 32s/epoch - 26ms/step
Epoch 3/50
1254/1254 - 31s - loss: 2.8524 - accuracy50: 0.5218 - val_loss: 3.1223 - val_accuracy50: 0.4878 - 31s/epoch - 25ms/step
Epoch 4/50
1254/1254 - 31s - loss: 2.7885 - accuracy50: 0.5420 - val_loss: 3.0663 - val_accuracy50: 0.4954 - 31s/epoch - 25ms/step
Epoch 5/50
1254/1254 - 31s - loss: 2.7485 - accuracy50: 0.5505 - val_loss: 2.9874 - val_accuracy50: 0.5074 - 31s/epoch - 25ms/step
Epoch 6/50
1254/1254 - 28s - loss: 2.7216 - accuracy50: 0.5548 - val_loss: 2.9679 - val_accuracy50: 0.5067 - 28s/epoch - 22ms/step
Epoch 7/50
1254/1254 - 29s - loss: 2.6996 - accuracy50: 0.5583 - val_loss: 2.9581 - val_accuracy50: 0.5048 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 28s - loss: 2.6842 - accuracy50: 0.5600 - val_loss: 2.9688 - val_accuracy50: 0.5052 - 28s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 2.6715 - accuracy50: 0.5628 - val_loss: 2.9412 - val_accuracy50: 0.5056 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 2.6621 - accuracy50: 0.5640 - val_loss: 2.9634 - val_accuracy50: 0.4997 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 29s - loss: 2.6502 - accuracy50: 0.5662 - val_loss: 2.9458 - val_accuracy50: 0.5090 - 29s/epoch - 23ms/step
Epoch 12/50
1254/1254 - 29s - loss: 2.6426 - accuracy50: 0.5672 - val_loss: 2.9663 - val_accuracy50: 0.4999 - 29s/epoch - 23ms/step
Epoch 13/50
1254/1254 - 29s - loss: 2.6361 - accuracy50: 0.5681 - val_loss: 2.9471 - val_accuracy50: 0.5007 - 29s/epoch - 23ms/step
Epoch 14/50
1254/1254 - 28s - loss: 2.6300 - accuracy50: 0.5695 - val_loss: 2.9396 - val_accuracy50: 0.4971 - 28s/epoch - 23ms/step
Epoch 15/50
1254/1254 - 28s - loss: 2.6245 - accuracy50: 0.5704 - val_loss: 2.9384 - val_accuracy50: 0.4988 - 28s/epoch - 23ms/step
Epoch 16/50
1254/1254 - 28s - loss: 2.6195 - accuracy50: 0.5718 - val_loss: 2.9168 - val_accuracy50: 0.4995 - 28s/epoch - 23ms/step
Epoch 17/50
1254/1254 - 29s - loss: 2.6154 - accuracy50: 0.5715 - val_loss: 2.9414 - val_accuracy50: 0.5018 - 29s/epoch - 23ms/step
Epoch 18/50
1254/1254 - 29s - loss: 2.6106 - accuracy50: 0.5726 - val_loss: 2.9585 - val_accuracy50: 0.4930 - 29s/epoch - 23ms/step
Epoch 19/50
1254/1254 - 29s - loss: 2.6077 - accuracy50: 0.5733 - val_loss: 2.9221 - val_accuracy50: 0.5002 - 29s/epoch - 23ms/step
Epoch 20/50
1254/1254 - 29s - loss: 2.6027 - accuracy50: 0.5746 - val_loss: 2.9443 - val_accuracy50: 0.4950 - 29s/epoch - 23ms/step
Epoch 21/50
1254/1254 - 29s - loss: 2.5983 - accuracy50: 0.5760 - val_loss: 2.9436 - val_accuracy50: 0.4954 - 29s/epoch - 23ms/step
Epoch 22/50
1254/1254 - 29s - loss: 2.5941 - accuracy50: 0.5757 - val_loss: 2.9801 - val_accuracy50: 0.4930 - 29s/epoch - 23ms/step
Epoch 23/50
1254/1254 - 29s - loss: 2.5909 - accuracy50: 0.5763 - val_loss: 2.9546 - val_accuracy50: 0.4938 - 29s/epoch - 23ms/step
Epoch 24/50
1254/1254 - 29s - loss: 2.5874 - accuracy50: 0.5768 - val_loss: 2.9790 - val_accuracy50: 0.4868 - 29s/epoch - 23ms/step
Epoch 25/50
1254/1254 - 29s - loss: 2.5839 - accuracy50: 0.5778 - val_loss: 2.9396 - val_accuracy50: 0.4922 - 29s/epoch - 23ms/step
Epoch 26/50
1254/1254 - 28s - loss: 2.5792 - accuracy50: 0.5789 - val_loss: 2.9679 - val_accuracy50: 0.4943 - 28s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h50
Evaluating performance on  test set...
5929/5929 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9249215
{'0': {'precision': 0.4214536974979874, 'recall': 0.6139920096831316, 'f1-score': 0.4998218659279492, 'support': 346169}, '1': {'precision': 0.6517380328519337, 'recall': 0.5726641435393353, 'f1-score': 0.6096477278326817, 'support': 831772}, '2': {'precision': 0.4751809464455178, 'recall': 0.3951129457766053, 'f1-score': 0.43146377380087325, 'support': 339632}, 'accuracy': 0.5423554583535685, 'macro avg': {'precision': 0.5161242255984796, 'recall': 0.527256366333024, 'f1-score': 0.5136444558538348, 'support': 1517573}, 'weighted avg': {'precision': 0.5596951891432461, 'recall': 0.5423554583535685, 'f1-score': 0.5447182111205167, 'support': 1517573}}
[[212545 102839  30785]
 [238020 476326 117426]
 [ 53749 151690 134193]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9932161
{'0': {'precision': 0.3839008511198781, 'recall': 0.7475694953344081, 'f1-score': 0.5072913601836619, 'support': 81876}, '1': {'precision': 0.5842004605596971, 'recall': 0.479829454382253, 'f1-score': 0.5268960661797061, 'support': 155970}, '2': {'precision': 0.5986357924968587, 'recall': 0.24073049252905368, 'f1-score': 0.3433778357414971, 'support': 83122}, 'accuracy': 0.48620734777298674, 'macro avg': {'precision': 0.5222457013921447, 'recall': 0.4893764807485716, 'f1-score': 0.4591884207016217, 'support': 320968}, 'weighted avg': {'precision': 0.5368442220523884, 'recall': 0.48620734777298674, 'f1-score': 0.47436884459183154, 'support': 320968}}
[[61208 17261  3407]
 [71122 74839 10009]
 [27107 36005 20010]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96213406
{'0': {'precision': 0.3879091747349009, 'recall': 0.7391288433382137, 'f1-score': 0.5087935900020157, 'support': 27320}, '1': {'precision': 0.5934554914086211, 'recall': 0.47918854679122214, 'f1-score': 0.5302356874898059, 'support': 54273}, '2': {'precision': 0.6265376537653765, 'recall': 0.302447679049895, 'f1-score': 0.407960927960928, 'support': 27618}, 'accuracy': 0.4995192791934878, 'macro avg': {'precision': 0.5359674399696329, 'recall': 0.5069216897264436, 'f1-score': 0.4823300684842499, 'support': 109211}, 'weighted avg': {'precision': 0.5504024819905481, 'recall': 0.4995192791934878, 'f1-score': 0.49395012640131686, 'support': 109211}}
[[20193  5877  1250]
 [24537 26007  3729]
 [ 7326 11939  8353]]
training model: results/EXC/W7/deepLOB_L1/h100
Epoch 1/50
1254/1254 - 31s - loss: 3.1675 - accuracy100: 0.4403 - val_loss: 3.7375 - val_accuracy100: 0.3565 - 31s/epoch - 25ms/step
Epoch 2/50
1254/1254 - 28s - loss: 3.1224 - accuracy100: 0.4570 - val_loss: 3.6136 - val_accuracy100: 0.3588 - 28s/epoch - 22ms/step
Epoch 3/50
1254/1254 - 28s - loss: 3.0928 - accuracy100: 0.4665 - val_loss: 3.5193 - val_accuracy100: 0.3676 - 28s/epoch - 22ms/step
Epoch 4/50
1254/1254 - 29s - loss: 3.0675 - accuracy100: 0.4742 - val_loss: 3.4524 - val_accuracy100: 0.3764 - 29s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 28s - loss: 3.0504 - accuracy100: 0.4788 - val_loss: 3.5144 - val_accuracy100: 0.3735 - 28s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 28s - loss: 3.0358 - accuracy100: 0.4820 - val_loss: 3.5095 - val_accuracy100: 0.3718 - 28s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 3.0219 - accuracy100: 0.4854 - val_loss: 3.5096 - val_accuracy100: 0.3748 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 28s - loss: 3.0087 - accuracy100: 0.4885 - val_loss: 3.5887 - val_accuracy100: 0.3657 - 28s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 3.0002 - accuracy100: 0.4902 - val_loss: 3.5058 - val_accuracy100: 0.3798 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 2.9886 - accuracy100: 0.4923 - val_loss: 3.5123 - val_accuracy100: 0.3796 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 29s - loss: 2.9811 - accuracy100: 0.4943 - val_loss: 3.4271 - val_accuracy100: 0.3891 - 29s/epoch - 23ms/step
Epoch 12/50
1254/1254 - 29s - loss: 2.9741 - accuracy100: 0.4960 - val_loss: 3.5945 - val_accuracy100: 0.3698 - 29s/epoch - 23ms/step
Epoch 13/50
1254/1254 - 29s - loss: 2.9680 - accuracy100: 0.4980 - val_loss: 3.6520 - val_accuracy100: 0.3677 - 29s/epoch - 23ms/step
Epoch 14/50
1254/1254 - 29s - loss: 2.9619 - accuracy100: 0.4981 - val_loss: 3.6202 - val_accuracy100: 0.3785 - 29s/epoch - 23ms/step
Epoch 15/50
1254/1254 - 29s - loss: 2.9561 - accuracy100: 0.5003 - val_loss: 3.5895 - val_accuracy100: 0.3758 - 29s/epoch - 23ms/step
Epoch 16/50
1254/1254 - 29s - loss: 2.9495 - accuracy100: 0.5011 - val_loss: 3.4381 - val_accuracy100: 0.3925 - 29s/epoch - 23ms/step
Epoch 17/50
1254/1254 - 29s - loss: 2.9463 - accuracy100: 0.5022 - val_loss: 3.4312 - val_accuracy100: 0.3918 - 29s/epoch - 23ms/step
Epoch 18/50
1254/1254 - 29s - loss: 2.9405 - accuracy100: 0.5034 - val_loss: 3.6483 - val_accuracy100: 0.3759 - 29s/epoch - 23ms/step
Epoch 19/50
1254/1254 - 29s - loss: 2.9358 - accuracy100: 0.5041 - val_loss: 3.3318 - val_accuracy100: 0.3960 - 29s/epoch - 23ms/step
Epoch 20/50
1254/1254 - 29s - loss: 2.9322 - accuracy100: 0.5056 - val_loss: 3.4167 - val_accuracy100: 0.3871 - 29s/epoch - 23ms/step
Epoch 21/50
1254/1254 - 29s - loss: 2.9299 - accuracy100: 0.5057 - val_loss: 3.4423 - val_accuracy100: 0.3937 - 29s/epoch - 23ms/step
Epoch 22/50
1254/1254 - 29s - loss: 2.9250 - accuracy100: 0.5070 - val_loss: 3.4012 - val_accuracy100: 0.4018 - 29s/epoch - 23ms/step
Epoch 23/50
1254/1254 - 29s - loss: 2.9216 - accuracy100: 0.5079 - val_loss: 3.4089 - val_accuracy100: 0.4022 - 29s/epoch - 23ms/step
Epoch 24/50
1254/1254 - 29s - loss: 2.9195 - accuracy100: 0.5081 - val_loss: 3.5374 - val_accuracy100: 0.4101 - 29s/epoch - 23ms/step
Epoch 25/50
1254/1254 - 30s - loss: 2.9143 - accuracy100: 0.5093 - val_loss: 3.5123 - val_accuracy100: 0.4002 - 30s/epoch - 24ms/step
Epoch 26/50
1254/1254 - 29s - loss: 2.9121 - accuracy100: 0.5092 - val_loss: 3.4002 - val_accuracy100: 0.4099 - 29s/epoch - 23ms/step
Epoch 27/50
1254/1254 - 30s - loss: 2.9092 - accuracy100: 0.5099 - val_loss: 3.3591 - val_accuracy100: 0.4207 - 30s/epoch - 24ms/step
Epoch 28/50
1254/1254 - 29s - loss: 2.9063 - accuracy100: 0.5112 - val_loss: 3.3702 - val_accuracy100: 0.4179 - 29s/epoch - 23ms/step
Epoch 29/50
1254/1254 - 28s - loss: 2.9037 - accuracy100: 0.5115 - val_loss: 3.4028 - val_accuracy100: 0.4179 - 28s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h100
Evaluating performance on  test set...
5929/5929 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0984412
{'0': {'precision': 0.40125056532812836, 'recall': 0.5821004400646608, 'f1-score': 0.47504528774117866, 'support': 463341}, '1': {'precision': 0.46595412178378076, 'recall': 0.2744930419129191, 'f1-score': 0.34547006336480024, 'support': 608285}, '2': {'precision': 0.4116438117099231, 'recall': 0.4495915433896853, 'f1-score': 0.42978165152560976, 'support': 445947}, 'accuracy': 0.4198644809837813, 'macro avg': {'precision': 0.42628283294061076, 'recall': 0.43539500845575513, 'f1-score': 0.41676566754386285, 'support': 1517573}, 'weighted avg': {'precision': 0.4302396418884314, 'recall': 0.4198644809837813, 'f1-score': 0.4098070104792547, 'support': 1517573}}
[[269711  99930  93700]
 [248452 166970 192863]
 [154013  91440 200494]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1251947
{'0': {'precision': 0.4013147742353631, 'recall': 0.49450936023350667, 'f1-score': 0.4430644467444406, 'support': 105179}, '1': {'precision': 0.37837414753004917, 'recall': 0.5171730515191546, 'f1-score': 0.4370175300683909, 'support': 107494}, '2': {'precision': 0.4829200234033935, 'recall': 0.19816242670483403, 'f1-score': 0.2810132715261273, 'support': 108295}, 'accuracy': 0.40211173699558833, 'macro avg': {'precision': 0.42086964838960195, 'recall': 0.40328161281916514, 'f1-score': 0.3870317494463196, 'support': 320968}, 'weighted avg': {'precision': 0.42116554045377375, 'recall': 0.40211173699558833, 'f1-score': 0.3863630332657059, 'support': 320968}}
[[52012 45198  7969]
 [36892 55593 15009]
 [40700 46135 21460]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1129961
{'0': {'precision': 0.3752891810392967, 'recall': 0.6620507191308509, 'f1-score': 0.47903386758446537, 'support': 35529}, '1': {'precision': 0.38175178182246566, 'recall': 0.34515630824945415, 'f1-score': 0.36253286345583713, 'support': 37554}, '2': {'precision': 0.5404610492845787, 'recall': 0.18819198405668733, 'f1-score': 0.27917385234458403, 'support': 36128}, 'accuracy': 0.39632454606220985, 'macro avg': {'precision': 0.432500670715447, 'recall': 0.3984663371456641, 'f1-score': 0.3735801944616289, 'support': 109211}, 'weighted avg': {'precision': 0.43215182093616306, 'recall': 0.39632454606220985, 'f1-score': 0.37285755439593177, 'support': 109211}}
[[23522  9826  2181]
 [20992 12962  3600]
 [18163 11166  6799]]
training model: results/EXC/W7/deepLOB_L1/h200
Epoch 1/50
1254/1254 - 32s - loss: 3.2509 - accuracy200: 0.4004 - val_loss: 3.3419 - val_accuracy200: 0.3467 - 32s/epoch - 25ms/step
Epoch 2/50
1254/1254 - 29s - loss: 3.2213 - accuracy200: 0.4119 - val_loss: 3.4910 - val_accuracy200: 0.3411 - 29s/epoch - 23ms/step
Epoch 3/50
1254/1254 - 29s - loss: 3.2074 - accuracy200: 0.4179 - val_loss: 3.4033 - val_accuracy200: 0.3519 - 29s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 28s - loss: 3.1954 - accuracy200: 0.4228 - val_loss: 3.5250 - val_accuracy200: 0.3408 - 28s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 28s - loss: 3.1902 - accuracy200: 0.4257 - val_loss: 3.6277 - val_accuracy200: 0.3360 - 28s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 28s - loss: 3.1835 - accuracy200: 0.4281 - val_loss: 3.7156 - val_accuracy200: 0.3349 - 28s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 3.1780 - accuracy200: 0.4295 - val_loss: 3.6746 - val_accuracy200: 0.3359 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 3.1744 - accuracy200: 0.4302 - val_loss: 3.6461 - val_accuracy200: 0.3369 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 3.1704 - accuracy200: 0.4321 - val_loss: 3.6457 - val_accuracy200: 0.3369 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 3.1663 - accuracy200: 0.4343 - val_loss: 3.5435 - val_accuracy200: 0.3383 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 29s - loss: 3.1635 - accuracy200: 0.4350 - val_loss: 3.5891 - val_accuracy200: 0.3378 - 29s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h200
Evaluating performance on  test set...
5929/5929 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1298091
{'0': {'precision': 0.3611675072738008, 'recall': 0.4938793298002319, 'f1-score': 0.41722431732137033, 'support': 513996}, '1': {'precision': 0.3317622950819672, 'recall': 0.015471325966217276, 'f1-score': 0.02956397249217532, 'support': 523226}, '2': {'precision': 0.35260556643738894, 'recall': 0.5801320284541929, 'f1-score': 0.4386180714101895, 'support': 480351}, 'accuracy': 0.35623591089193074, 'macro avg': {'precision': 0.348511789597719, 'recall': 0.36316089474021407, 'f1-score': 0.295135453741245, 'support': 1517573}, 'weighted avg': {'precision': 0.3483191577070942, 'recall': 0.35623591089193074, 'f1-score': 0.29033917873938314, 'support': 1517573}}
[[253852   8761 251383]
 [254873   8095 260258]
 [194140   7544 278667]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1239079
{'0': {'precision': 0.34403170072115385, 'recall': 0.8676398150954835, 'f1-score': 0.4927005336087443, 'support': 105568}, '1': {'precision': 0.38726775651397644, 'recall': 0.0655392517893226, 'f1-score': 0.11210621098450281, 'support': 105906}, '2': {'precision': 0.412036408096726, 'recall': 0.13850073976656255, 'f1-score': 0.20731515594775082, 'support': 109494}, 'accuracy': 0.35424403678871413, 'macro avg': {'precision': 0.3811119551106188, 'recall': 0.3572266022171229, 'f1-score': 0.2707073001803327, 'support': 320968}, 'weighted avg': {'precision': 0.381496697712055, 'recall': 0.35424403678871413, 'f1-score': 0.26976488621256856, 'support': 320968}}
[[91595  4195  9778]
 [87103  6941 11862]
 [87542  6787 15165]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1155185
{'0': {'precision': 0.3361637890367016, 'recall': 0.9003537735849056, 'f1-score': 0.4895463601181616, 'support': 35616}, '1': {'precision': 0.3284438775510204, 'recall': 0.013857869386217475, 'f1-score': 0.026593684645374507, 'support': 37163}, '2': {'precision': 0.42907280444009144, 'recall': 0.14429622310057091, 'f1-score': 0.21596417714238764, 'support': 36432}, 'accuracy': 0.34647608757359605, 'macro avg': {'precision': 0.36456015700927114, 'recall': 0.35283595535723133, 'f1-score': 0.24403474063530792, 'support': 109211}, 'weighted avg': {'precision': 0.3645305852260408, 'recall': 0.34647608757359605, 'f1-score': 0.24074489901288298, 'support': 109211}}
[[32067   341  3208]
 [32861   515  3787]
 [30463   712  5257]]
training model: results/EXC/W7/deepLOB_L1/h300
Epoch 1/50
1254/1254 - 30s - loss: 3.2851 - accuracy300: 0.3815 - val_loss: 3.3435 - val_accuracy300: 0.3424 - 30s/epoch - 24ms/step
Epoch 2/50
1254/1254 - 29s - loss: 3.2538 - accuracy300: 0.3937 - val_loss: 3.3415 - val_accuracy300: 0.3464 - 29s/epoch - 23ms/step
Epoch 3/50
1254/1254 - 29s - loss: 3.2420 - accuracy300: 0.3998 - val_loss: 3.4286 - val_accuracy300: 0.3348 - 29s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 29s - loss: 3.2295 - accuracy300: 0.4077 - val_loss: 3.3992 - val_accuracy300: 0.3394 - 29s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 28s - loss: 3.2240 - accuracy300: 0.4099 - val_loss: 3.4319 - val_accuracy300: 0.3400 - 28s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 28s - loss: 3.2173 - accuracy300: 0.4146 - val_loss: 3.4388 - val_accuracy300: 0.3411 - 28s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 28s - loss: 3.2104 - accuracy300: 0.4173 - val_loss: 3.4416 - val_accuracy300: 0.3436 - 28s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 3.2078 - accuracy300: 0.4188 - val_loss: 3.4574 - val_accuracy300: 0.3387 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 3.2016 - accuracy300: 0.4223 - val_loss: 3.4337 - val_accuracy300: 0.3394 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 3.1958 - accuracy300: 0.4237 - val_loss: 3.4636 - val_accuracy300: 0.3410 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 29s - loss: 3.1929 - accuracy300: 0.4259 - val_loss: 3.4058 - val_accuracy300: 0.3446 - 29s/epoch - 23ms/step
Epoch 12/50
1254/1254 - 29s - loss: 3.1888 - accuracy300: 0.4269 - val_loss: 3.4580 - val_accuracy300: 0.3432 - 29s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h300
Evaluating performance on  test set...
5929/5929 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1152579
{'0': {'precision': 0.343173067430151, 'recall': 0.3738296910444105, 'f1-score': 0.35784599223889185, 'support': 502111}, '1': {'precision': 0.3557534408143639, 'recall': 0.2849968110796358, 'f1-score': 0.31646837707205316, 'support': 550343}, '2': {'precision': 0.34568255484470184, 'recall': 0.3936970968719833, 'f1-score': 0.3681308187631805, 'support': 465119}, 'accuracy': 0.3477038666344222, 'macro avg': {'precision': 0.3482030210297389, 'recall': 0.35084119966534316, 'f1-score': 0.34748172935804184, 'support': 1517573}, 'weighted avg': {'precision': 0.34850442922042824, 'recall': 0.3477038666344222, 'f1-score': 0.3459927155690955, 'support': 1517573}}
[[187704 152648 161759]
 [208649 156846 184848]
 [150613 131390 183116]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.128861
{'0': {'precision': 0.33810521841725355, 'recall': 0.8744373371239043, 'f1-score': 0.4876560010358232, 'support': 105525}, '1': {'precision': 0.33694065714997684, 'recall': 0.08951201059201816, 'f1-score': 0.14144704889001802, 'support': 105740}, '2': {'precision': 0.40352723082318753, 'recall': 0.07341640611469148, 'f1-score': 0.12423069210717094, 'support': 109703}, 'accuracy': 0.3420714837616211, 'macro avg': {'precision': 0.35952436879680594, 'recall': 0.3457885846102047, 'f1-score': 0.2511112473443374, 'support': 320968}, 'weighted avg': {'precision': 0.3600820208354583, 'recall': 0.3420714837616211, 'f1-score': 0.24938620072770096, 'support': 320968}}
[[92275  7752  5498]
 [89868  9465  6407]
 [90775 10874  8054]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1179394
{'0': {'precision': 0.33700906990673396, 'recall': 0.8920502802785799, 'f1-score': 0.4892018196214814, 'support': 35322}, '1': {'precision': 0.3596600133702607, 'recall': 0.09993366060766884, 'f1-score': 0.15640833956308664, 'support': 37685}, '2': {'precision': 0.45537757437070936, 'recall': 0.06595956247928406, 'f1-score': 0.11522872032426174, 'support': 36204}, 'accuracy': 0.34486452829843145, 'macro avg': {'precision': 0.38401555254923464, 'recall': 0.3526478344551776, 'f1-score': 0.2536129598362766, 'support': 109211}, 'weighted avg': {'precision': 0.3840648988986558, 'recall': 0.34486452829843145, 'f1-score': 0.2503921357713459, 'support': 109211}}
[[31509  2686  1127]
 [32190  3766  1729]
 [29797  4019  2388]]
training model: results/EXC/W7/deepLOB_L1/h500
Epoch 1/50
1254/1254 - 29s - loss: 3.2471 - accuracy500: 0.4078 - val_loss: 3.4087 - val_accuracy500: 0.3506 - 29s/epoch - 23ms/step
Epoch 2/50
1254/1254 - 29s - loss: 3.2171 - accuracy500: 0.4203 - val_loss: 3.5234 - val_accuracy500: 0.3330 - 29s/epoch - 23ms/step
Epoch 3/50
1254/1254 - 28s - loss: 3.2097 - accuracy500: 0.4245 - val_loss: 3.5145 - val_accuracy500: 0.3338 - 28s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 29s - loss: 3.2074 - accuracy500: 0.4241 - val_loss: 3.6809 - val_accuracy500: 0.3224 - 29s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 29s - loss: 3.2028 - accuracy500: 0.4271 - val_loss: 3.7388 - val_accuracy500: 0.3257 - 29s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 29s - loss: 3.1834 - accuracy500: 0.4375 - val_loss: 3.6891 - val_accuracy500: 0.3129 - 29s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 3.1808 - accuracy500: 0.4363 - val_loss: 3.5950 - val_accuracy500: 0.3233 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 29s - loss: 3.1721 - accuracy500: 0.4423 - val_loss: 3.5627 - val_accuracy500: 0.3276 - 29s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 28s - loss: 3.1720 - accuracy500: 0.4403 - val_loss: 3.6006 - val_accuracy500: 0.3229 - 28s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 28s - loss: 3.1700 - accuracy500: 0.4401 - val_loss: 3.5117 - val_accuracy500: 0.3216 - 28s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 28s - loss: 3.1653 - accuracy500: 0.4419 - val_loss: 3.5283 - val_accuracy500: 0.3209 - 28s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h500
Evaluating performance on  test set...
5929/5929 - 82s - 82s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.12136
{'0': {'precision': 0.36954647077610986, 'recall': 0.5370406735122321, 'f1-score': 0.4378210893679942, 'support': 560168}, '1': {'precision': 0.27750364266385863, 'recall': 0.05069871799173663, 'f1-score': 0.08573417261832707, 'support': 447033}, '2': {'precision': 0.3607556260271902, 'recall': 0.4395480159569882, 'f1-score': 0.3962731427097704, 'support': 510372}, 'accuracy': 0.3609908716088122, 'macro avg': {'precision': 0.3359352464890529, 'recall': 0.3424291358203189, 'f1-score': 0.30660946823203056, 'support': 1517573}, 'weighted avg': {'precision': 0.33947689086417177, 'recall': 0.3609908716088122, 'f1-score': 0.32013358485440246, 'support': 1517573}}
[[300833  32873 226462]
 [253322  22664 171047]
 [259905  26134 224333]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1489742
{'0': {'precision': 0.3296086858176883, 'recall': 0.8978094579095537, 'f1-score': 0.48219231082512015, 'support': 105499}, '1': {'precision': 0.3075087203965486, 'recall': 0.031613317227842365, 'f1-score': 0.05733258030839793, 'support': 105968}, '2': {'precision': 0.4097494385485931, 'recall': 0.0849763929096538, 'f1-score': 0.1407609106724151, 'support': 109501}, 'accuracy': 0.3345286757558386, 'macro avg': {'precision': 0.34895561492094335, 'recall': 0.3381330560156833, 'f1-score': 0.22676193393531108, 'support': 320968}, 'weighted avg': {'precision': 0.34965306229459403, 'recall': 0.3345286757558386, 'f1-score': 0.225442056371351, 'support': 320968}}
[[94718  3730  7051]
 [96265  3350  6353]
 [96382  3814  9305]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1399105
{'0': {'precision': 0.34780288732324777, 'recall': 0.9388636969858629, 'f1-score': 0.5075743919937126, 'support': 37490}, '1': {'precision': 0.3061953931691819, 'recall': 0.023504664349734774, 'f1-score': 0.04365798414496037, 'support': 32802}, '2': {'precision': 0.42498179169701383, 'recall': 0.05997070839435751, 'f1-score': 0.10510909459368174, 'support': 38919}, 'accuracy': 0.35072474384448454, 'macro avg': {'precision': 0.3596600240631478, 'recall': 0.3407796899099851, 'f1-score': 0.21878049024411825, 'support': 109211}, 'weighted avg': {'precision': 0.3628097708430482, 'recall': 0.35072474384448454, 'f1-score': 0.2248104495358414, 'support': 109211}}
[[35198   835  1457]
 [30330   771  1701]
 [35673   912  2334]]
training model: results/EXC/W7/deepLOB_L1/h1000
Epoch 1/50
1254/1254 - 30s - loss: 3.2183 - accuracy1000: 0.4258 - val_loss: 3.4823 - val_accuracy1000: 0.3341 - 30s/epoch - 24ms/step
Epoch 2/50
1254/1254 - 28s - loss: 3.1722 - accuracy1000: 0.4419 - val_loss: 3.5167 - val_accuracy1000: 0.3420 - 28s/epoch - 23ms/step
Epoch 3/50
1254/1254 - 29s - loss: 3.1472 - accuracy1000: 0.4517 - val_loss: 3.5814 - val_accuracy1000: 0.3381 - 29s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 28s - loss: 3.1332 - accuracy1000: 0.4578 - val_loss: 3.6264 - val_accuracy1000: 0.3370 - 28s/epoch - 23ms/step
Epoch 5/50
1254/1254 - 29s - loss: 3.1272 - accuracy1000: 0.4566 - val_loss: 3.7865 - val_accuracy1000: 0.3370 - 29s/epoch - 23ms/step
Epoch 6/50
1254/1254 - 29s - loss: 3.1192 - accuracy1000: 0.4594 - val_loss: 3.8297 - val_accuracy1000: 0.3364 - 29s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 29s - loss: 3.1074 - accuracy1000: 0.4621 - val_loss: 3.7204 - val_accuracy1000: 0.3367 - 29s/epoch - 23ms/step
Epoch 8/50
1254/1254 - 28s - loss: 3.1128 - accuracy1000: 0.4633 - val_loss: 3.6516 - val_accuracy1000: 0.3369 - 28s/epoch - 23ms/step
Epoch 9/50
1254/1254 - 29s - loss: 3.1146 - accuracy1000: 0.4580 - val_loss: 3.7065 - val_accuracy1000: 0.3366 - 29s/epoch - 23ms/step
Epoch 10/50
1254/1254 - 29s - loss: 3.1053 - accuracy1000: 0.4620 - val_loss: 3.6575 - val_accuracy1000: 0.3364 - 29s/epoch - 23ms/step
Epoch 11/50
1254/1254 - 29s - loss: 3.0978 - accuracy1000: 0.4669 - val_loss: 3.7015 - val_accuracy1000: 0.3368 - 29s/epoch - 23ms/step
testing model: results/EXC/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
5929/5929 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1444287
{'0': {'precision': 0.39293954507317985, 'recall': 0.4254778195215969, 'f1-score': 0.4085618611582715, 'support': 634026}, '1': {'precision': 0.16938307164518132, 'recall': 0.0915494071896645, 'f1-score': 0.11885772032921778, 'support': 316037}, '2': {'precision': 0.3840065068135244, 'recall': 0.44674631284030236, 'f1-score': 0.41300730365769334, 'support': 567510}, 'accuracy': 0.3638902378995936, 'macro avg': {'precision': 0.3154430411772952, 'recall': 0.321257846517188, 'f1-score': 0.31347562838172754, 'support': 1517573}, 'weighted avg': {'precision': 0.343042963007275, 'recall': 0.3638902378995936, 'f1-score': 0.34989292432139796, 'support': 1517573}}
[[269764  77486 286776]
 [167182  28933 119922]
 [249582  64395 253533]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1236371
{'0': {'precision': 0.3542045986277317, 'recall': 0.7217816547713455, 'f1-score': 0.47520752336288846, 'support': 105924}, '1': {'precision': 0.43340441298791643, 'recall': 0.2693648898873025, 'f1-score': 0.33223970228503197, 'support': 106391}, '2': {'precision': 0.3524283296579312, 'recall': 0.12649443641684996, 'f1-score': 0.18616873573494255, 'support': 108653}, 'accuracy': 0.37030482789561575, 'macro avg': {'precision': 0.38001244709119314, 'recall': 0.37254699369183264, 'f1-score': 0.3312053204609543, 'support': 320968}, 'weighted avg': {'precision': 0.3798555996534373, 'recall': 0.37030482789561575, 'f1-score': 0.32997366564363473, 'support': 320968}}
[[76454 18450 11020]
 [63499 28658 14234]
 [75894 19015 13744]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1606505
{'0': {'precision': 0.3279552683697761, 'recall': 0.9221487835747434, 'f1-score': 0.48383740749212345, 'support': 35555}, '1': {'precision': 0.417910447761194, 'recall': 0.028847492551443768, 'f1-score': 0.05396957699520734, 'support': 35913}, '2': {'precision': 0.40440958863569104, 'recall': 0.07241077815753914, 'f1-score': 0.12282870047864092, 'support': 37743}, 'accuracy': 0.3347281867211178, 'macro avg': {'precision': 0.38342510158888704, 'recall': 0.3411356847612421, 'f1-score': 0.22021189498865723, 'support': 109211}, 'weighted avg': {'precision': 0.38395856261010375, 'recall': 0.3347281867211178, 'f1-score': 0.21771590850900252, 'support': 109211}}
[[32787   804  1964]
 [32816  1036  2061]
 [34371   639  2733]]
training model: results/EXC/W7/deepOF_L1/h10
Epoch 1/50
1254/1254 - 29s - loss: 3.0771 - accuracy10: 0.3593 - val_loss: 2.9650 - val_accuracy10: 0.6153 - 29s/epoch - 23ms/step
Epoch 2/50
1254/1254 - 25s - loss: 2.9957 - accuracy10: 0.3781 - val_loss: 2.9006 - val_accuracy10: 0.5996 - 25s/epoch - 20ms/step
Epoch 3/50
1254/1254 - 26s - loss: 2.9579 - accuracy10: 0.3896 - val_loss: 2.8738 - val_accuracy10: 0.5947 - 26s/epoch - 20ms/step
Epoch 4/50
1254/1254 - 27s - loss: 2.9318 - accuracy10: 0.4027 - val_loss: 2.8550 - val_accuracy10: 0.5569 - 27s/epoch - 22ms/step
Epoch 5/50
1254/1254 - 27s - loss: 2.9132 - accuracy10: 0.4076 - val_loss: 2.8384 - val_accuracy10: 0.5475 - 27s/epoch - 22ms/step
Epoch 6/50
1254/1254 - 27s - loss: 2.8970 - accuracy10: 0.4141 - val_loss: 2.8327 - val_accuracy10: 0.5371 - 27s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 2.8824 - accuracy10: 0.4172 - val_loss: 2.8254 - val_accuracy10: 0.5276 - 27s/epoch - 21ms/step
Epoch 8/50
1254/1254 - 27s - loss: 2.8704 - accuracy10: 0.4227 - val_loss: 2.8134 - val_accuracy10: 0.5219 - 27s/epoch - 22ms/step
Epoch 9/50
1254/1254 - 27s - loss: 2.8571 - accuracy10: 0.4275 - val_loss: 2.8055 - val_accuracy10: 0.5186 - 27s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 27s - loss: 2.8454 - accuracy10: 0.4306 - val_loss: 2.7937 - val_accuracy10: 0.5175 - 27s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 27s - loss: 2.8369 - accuracy10: 0.4361 - val_loss: 2.7946 - val_accuracy10: 0.5074 - 27s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 26s - loss: 2.8269 - accuracy10: 0.4363 - val_loss: 2.7923 - val_accuracy10: 0.4972 - 26s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 27s - loss: 2.8168 - accuracy10: 0.4385 - val_loss: 2.7810 - val_accuracy10: 0.4891 - 27s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 27s - loss: 2.8096 - accuracy10: 0.4427 - val_loss: 2.7780 - val_accuracy10: 0.5028 - 27s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 2.8012 - accuracy10: 0.4440 - val_loss: 2.7730 - val_accuracy10: 0.5033 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 2.7911 - accuracy10: 0.4478 - val_loss: 2.7729 - val_accuracy10: 0.5153 - 27s/epoch - 22ms/step
Epoch 17/50
1254/1254 - 27s - loss: 2.7841 - accuracy10: 0.4525 - val_loss: 2.7557 - val_accuracy10: 0.5144 - 27s/epoch - 22ms/step
Epoch 18/50
1254/1254 - 27s - loss: 2.7772 - accuracy10: 0.4532 - val_loss: 2.7545 - val_accuracy10: 0.5105 - 27s/epoch - 22ms/step
Epoch 19/50
1254/1254 - 27s - loss: 2.7675 - accuracy10: 0.4562 - val_loss: 2.7572 - val_accuracy10: 0.5087 - 27s/epoch - 21ms/step
Epoch 20/50
1254/1254 - 27s - loss: 2.7590 - accuracy10: 0.4604 - val_loss: 2.7661 - val_accuracy10: 0.5096 - 27s/epoch - 21ms/step
Epoch 21/50
1254/1254 - 28s - loss: 2.7537 - accuracy10: 0.4629 - val_loss: 2.7455 - val_accuracy10: 0.5033 - 28s/epoch - 22ms/step
Epoch 22/50
1254/1254 - 27s - loss: 2.7456 - accuracy10: 0.4651 - val_loss: 2.7414 - val_accuracy10: 0.5104 - 27s/epoch - 22ms/step
Epoch 23/50
1254/1254 - 27s - loss: 2.7357 - accuracy10: 0.4688 - val_loss: 2.7506 - val_accuracy10: 0.5142 - 27s/epoch - 21ms/step
Epoch 24/50
1254/1254 - 27s - loss: 2.7289 - accuracy10: 0.4716 - val_loss: 2.7407 - val_accuracy10: 0.5104 - 27s/epoch - 22ms/step
Epoch 25/50
1254/1254 - 27s - loss: 2.7203 - accuracy10: 0.4740 - val_loss: 2.7398 - val_accuracy10: 0.5219 - 27s/epoch - 21ms/step
Epoch 26/50
1254/1254 - 27s - loss: 2.7096 - accuracy10: 0.4771 - val_loss: 2.7347 - val_accuracy10: 0.5053 - 27s/epoch - 22ms/step
Epoch 27/50
1254/1254 - 26s - loss: 2.7057 - accuracy10: 0.4777 - val_loss: 2.7275 - val_accuracy10: 0.5073 - 26s/epoch - 21ms/step
Epoch 28/50
1254/1254 - 27s - loss: 2.6961 - accuracy10: 0.4833 - val_loss: 2.7365 - val_accuracy10: 0.5043 - 27s/epoch - 21ms/step
Epoch 29/50
1254/1254 - 27s - loss: 2.6868 - accuracy10: 0.4858 - val_loss: 2.7328 - val_accuracy10: 0.5004 - 27s/epoch - 21ms/step
Epoch 30/50
1254/1254 - 27s - loss: 2.6785 - accuracy10: 0.4894 - val_loss: 2.7342 - val_accuracy10: 0.5098 - 27s/epoch - 22ms/step
Epoch 31/50
1254/1254 - 27s - loss: 2.6698 - accuracy10: 0.4935 - val_loss: 2.7333 - val_accuracy10: 0.5016 - 27s/epoch - 22ms/step
Epoch 32/50
1254/1254 - 27s - loss: 2.6614 - accuracy10: 0.4951 - val_loss: 2.7367 - val_accuracy10: 0.4950 - 27s/epoch - 21ms/step
Epoch 33/50
1254/1254 - 27s - loss: 2.6530 - accuracy10: 0.4974 - val_loss: 2.7236 - val_accuracy10: 0.4980 - 27s/epoch - 22ms/step
Epoch 34/50
1254/1254 - 27s - loss: 2.6457 - accuracy10: 0.4995 - val_loss: 2.7171 - val_accuracy10: 0.4937 - 27s/epoch - 21ms/step
Epoch 35/50
1254/1254 - 27s - loss: 2.6356 - accuracy10: 0.5015 - val_loss: 2.7278 - val_accuracy10: 0.5053 - 27s/epoch - 22ms/step
Epoch 36/50
1254/1254 - 27s - loss: 2.6272 - accuracy10: 0.5055 - val_loss: 2.7341 - val_accuracy10: 0.5003 - 27s/epoch - 21ms/step
Epoch 37/50
1254/1254 - 27s - loss: 2.6196 - accuracy10: 0.5065 - val_loss: 2.7312 - val_accuracy10: 0.5032 - 27s/epoch - 21ms/step
Epoch 38/50
1254/1254 - 26s - loss: 2.6105 - accuracy10: 0.5111 - val_loss: 2.7307 - val_accuracy10: 0.4962 - 26s/epoch - 21ms/step
Epoch 39/50
1254/1254 - 25s - loss: 2.6041 - accuracy10: 0.5108 - val_loss: 2.7572 - val_accuracy10: 0.4981 - 25s/epoch - 20ms/step
Epoch 40/50
1254/1254 - 26s - loss: 2.5995 - accuracy10: 0.5105 - val_loss: 2.7588 - val_accuracy10: 0.5015 - 26s/epoch - 21ms/step
Epoch 41/50
1254/1254 - 27s - loss: 2.5893 - accuracy10: 0.5148 - val_loss: 2.7337 - val_accuracy10: 0.5077 - 27s/epoch - 21ms/step
Epoch 42/50
1254/1254 - 27s - loss: 2.5797 - accuracy10: 0.5178 - val_loss: 2.7562 - val_accuracy10: 0.5095 - 27s/epoch - 22ms/step
Epoch 43/50
1254/1254 - 27s - loss: 2.5751 - accuracy10: 0.5187 - val_loss: 2.7706 - val_accuracy10: 0.5180 - 27s/epoch - 21ms/step
Epoch 44/50
1254/1254 - 26s - loss: 2.5680 - accuracy10: 0.5202 - val_loss: 2.7600 - val_accuracy10: 0.5155 - 26s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h10
Evaluating performance on  test set...
5928/5928 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94203323
{'0': {'precision': 0.2259455059656059, 'recall': 0.6161887288212377, 'f1-score': 0.3306481754397693, 'support': 176592}, '1': {'precision': 0.8757517320191415, 'recall': 0.47305351744619706, 'f1-score': 0.6142879965887919, 'support': 1166386}, '2': {'precision': 0.2449492398917052, 'recall': 0.5695171544762014, 'f1-score': 0.3425624312038021, 'support': 174590}, 'accuracy': 0.50080721259278, 'macro avg': {'precision': 0.44888215929215086, 'recall': 0.5529198002478787, 'f1-score': 0.4291662010774544, 'support': 1517568}, 'weighted avg': {'precision': 0.7275656947728533, 'recall': 0.50080721259278, 'f1-score': 0.5500212950262171, 'support': 1517568}}
[[108814  34574  33204]
 [341330 551763 273293]
 [ 31450  43708  99432]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9216614
{'0': {'precision': 0.2517587891468553, 'recall': 0.6480150201338966, 'f1-score': 0.36263219741480607, 'support': 40479}, '1': {'precision': 0.8636782362952207, 'recall': 0.4615224165766277, 'f1-score': 0.6015796413860606, 'support': 239711}, '2': {'precision': 0.26734024199095635, 'recall': 0.5814204433980773, 'f1-score': 0.36626833620429944, 'support': 40776}, 'accuracy': 0.5002741723422418, 'macro avg': {'precision': 0.46092575581101075, 'recall': 0.5636526267028672, 'f1-score': 0.4434933916683887, 'support': 320966}, 'weighted avg': {'precision': 0.7107456348456298, 'recall': 0.5002741723422418, 'f1-score': 0.5415502072260439, 'support': 320966}}
[[ 26231   8000   6248]
 [ 70354 110632  58725]
 [  7606   9462  23708]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9328792
{'0': {'precision': 0.2318641459661464, 'recall': 0.6536524905104966, 'f1-score': 0.34230542991014384, 'support': 12909}, '1': {'precision': 0.8710206685960394, 'recall': 0.45942762359219685, 'f1-score': 0.601558073654391, 'support': 83197}, '2': {'precision': 0.2606441802598839, 'recall': 0.5755055322396032, 'f1-score': 0.3587926072167646, 'support': 13105}, 'accuracy': 0.4963144738167401, 'macro avg': {'precision': 0.4545096649406899, 'recall': 0.5628618821140988, 'f1-score': 0.4342187035937665, 'support': 109211}, 'weighted avg': {'precision': 0.722227457012274, 'recall': 0.4963144738167401, 'f1-score': 0.5417826497890332, 'support': 109211}}
[[ 8438  2596  1875]
 [25455 38223 19519]
 [ 2499  3064  7542]]
training model: results/EXC/W7/deepOF_L1/h20
Epoch 1/50
1254/1254 - 30s - loss: 3.0873 - accuracy20: 0.3791 - val_loss: 2.9931 - val_accuracy20: 0.5731 - 30s/epoch - 24ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.0060 - accuracy20: 0.4012 - val_loss: 2.9224 - val_accuracy20: 0.5406 - 27s/epoch - 21ms/step
Epoch 3/50
1254/1254 - 27s - loss: 2.9653 - accuracy20: 0.4130 - val_loss: 2.8917 - val_accuracy20: 0.5120 - 27s/epoch - 21ms/step
Epoch 4/50
1254/1254 - 26s - loss: 2.9413 - accuracy20: 0.4209 - val_loss: 2.8807 - val_accuracy20: 0.5078 - 26s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 27s - loss: 2.9218 - accuracy20: 0.4239 - val_loss: 2.8690 - val_accuracy20: 0.4819 - 27s/epoch - 22ms/step
Epoch 6/50
1254/1254 - 27s - loss: 2.9095 - accuracy20: 0.4258 - val_loss: 2.8634 - val_accuracy20: 0.4706 - 27s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 2.8970 - accuracy20: 0.4312 - val_loss: 2.8645 - val_accuracy20: 0.4623 - 27s/epoch - 22ms/step
Epoch 8/50
1254/1254 - 27s - loss: 2.8880 - accuracy20: 0.4337 - val_loss: 2.8488 - val_accuracy20: 0.4707 - 27s/epoch - 21ms/step
Epoch 9/50
1254/1254 - 27s - loss: 2.8766 - accuracy20: 0.4374 - val_loss: 2.8463 - val_accuracy20: 0.4758 - 27s/epoch - 22ms/step
Epoch 10/50
1254/1254 - 27s - loss: 2.8672 - accuracy20: 0.4420 - val_loss: 2.8404 - val_accuracy20: 0.4753 - 27s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 27s - loss: 2.8586 - accuracy20: 0.4453 - val_loss: 2.8374 - val_accuracy20: 0.4754 - 27s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 27s - loss: 2.8523 - accuracy20: 0.4462 - val_loss: 2.8251 - val_accuracy20: 0.4846 - 27s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 27s - loss: 2.8438 - accuracy20: 0.4488 - val_loss: 2.8312 - val_accuracy20: 0.4904 - 27s/epoch - 22ms/step
Epoch 14/50
1254/1254 - 27s - loss: 2.8368 - accuracy20: 0.4531 - val_loss: 2.8222 - val_accuracy20: 0.4869 - 27s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 2.8280 - accuracy20: 0.4570 - val_loss: 2.8273 - val_accuracy20: 0.4945 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 2.8204 - accuracy20: 0.4596 - val_loss: 2.8204 - val_accuracy20: 0.4933 - 27s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 27s - loss: 2.8152 - accuracy20: 0.4641 - val_loss: 2.8221 - val_accuracy20: 0.5016 - 27s/epoch - 21ms/step
Epoch 18/50
1254/1254 - 27s - loss: 2.8064 - accuracy20: 0.4665 - val_loss: 2.8309 - val_accuracy20: 0.4909 - 27s/epoch - 21ms/step
Epoch 19/50
1254/1254 - 27s - loss: 2.7979 - accuracy20: 0.4708 - val_loss: 2.8203 - val_accuracy20: 0.4883 - 27s/epoch - 21ms/step
Epoch 20/50
1254/1254 - 26s - loss: 2.7915 - accuracy20: 0.4730 - val_loss: 2.8111 - val_accuracy20: 0.5005 - 26s/epoch - 21ms/step
Epoch 21/50
1254/1254 - 26s - loss: 2.7874 - accuracy20: 0.4758 - val_loss: 2.8124 - val_accuracy20: 0.5051 - 26s/epoch - 20ms/step
Epoch 22/50
1254/1254 - 27s - loss: 2.7778 - accuracy20: 0.4806 - val_loss: 2.8160 - val_accuracy20: 0.5045 - 27s/epoch - 22ms/step
Epoch 23/50
1254/1254 - 27s - loss: 2.7689 - accuracy20: 0.4849 - val_loss: 2.8076 - val_accuracy20: 0.5067 - 27s/epoch - 21ms/step
Epoch 24/50
1254/1254 - 27s - loss: 2.7625 - accuracy20: 0.4856 - val_loss: 2.8148 - val_accuracy20: 0.5056 - 27s/epoch - 21ms/step
Epoch 25/50
1254/1254 - 27s - loss: 2.7558 - accuracy20: 0.4879 - val_loss: 2.7996 - val_accuracy20: 0.5012 - 27s/epoch - 22ms/step
Epoch 26/50
1254/1254 - 27s - loss: 2.7476 - accuracy20: 0.4912 - val_loss: 2.8061 - val_accuracy20: 0.4986 - 27s/epoch - 22ms/step
Epoch 27/50
1254/1254 - 27s - loss: 2.7427 - accuracy20: 0.4920 - val_loss: 2.8043 - val_accuracy20: 0.5026 - 27s/epoch - 21ms/step
Epoch 28/50
1254/1254 - 27s - loss: 2.7321 - accuracy20: 0.4939 - val_loss: 2.8156 - val_accuracy20: 0.4894 - 27s/epoch - 22ms/step
Epoch 29/50
1254/1254 - 27s - loss: 2.7282 - accuracy20: 0.4959 - val_loss: 2.7902 - val_accuracy20: 0.5042 - 27s/epoch - 21ms/step
Epoch 30/50
1254/1254 - 26s - loss: 2.7187 - accuracy20: 0.4977 - val_loss: 2.7991 - val_accuracy20: 0.5007 - 26s/epoch - 21ms/step
Epoch 31/50
1254/1254 - 27s - loss: 2.7128 - accuracy20: 0.4993 - val_loss: 2.8145 - val_accuracy20: 0.4906 - 27s/epoch - 21ms/step
Epoch 32/50
1254/1254 - 27s - loss: 2.7027 - accuracy20: 0.5044 - val_loss: 2.8107 - val_accuracy20: 0.4903 - 27s/epoch - 21ms/step
Epoch 33/50
1254/1254 - 26s - loss: 2.6953 - accuracy20: 0.5061 - val_loss: 2.8047 - val_accuracy20: 0.5027 - 26s/epoch - 21ms/step
Epoch 34/50
1254/1254 - 27s - loss: 2.6923 - accuracy20: 0.5058 - val_loss: 2.7932 - val_accuracy20: 0.4963 - 27s/epoch - 21ms/step
Epoch 35/50
1254/1254 - 26s - loss: 2.6834 - accuracy20: 0.5089 - val_loss: 2.8077 - val_accuracy20: 0.5034 - 26s/epoch - 21ms/step
Epoch 36/50
1254/1254 - 27s - loss: 2.6767 - accuracy20: 0.5108 - val_loss: 2.8067 - val_accuracy20: 0.5069 - 27s/epoch - 21ms/step
Epoch 37/50
1254/1254 - 26s - loss: 2.6701 - accuracy20: 0.5129 - val_loss: 2.7946 - val_accuracy20: 0.4941 - 26s/epoch - 21ms/step
Epoch 38/50
1254/1254 - 26s - loss: 2.6649 - accuracy20: 0.5130 - val_loss: 2.8028 - val_accuracy20: 0.4981 - 26s/epoch - 21ms/step
Epoch 39/50
1254/1254 - 26s - loss: 2.6576 - accuracy20: 0.5152 - val_loss: 2.8186 - val_accuracy20: 0.4995 - 26s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h20
Evaluating performance on  test set...
5928/5928 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94901586
{'0': {'precision': 0.2906889731689545, 'recall': 0.6338283913184988, 'f1-score': 0.3985796942599343, 'support': 233508}, '1': {'precision': 0.8140359071763724, 'recall': 0.474076927466758, 'f1-score': 0.5991953986371185, 'support': 1051380}, '2': {'precision': 0.32971488293892226, 'recall': 0.5613116726835138, 'f1-score': 0.4154148072990054, 'support': 232680}, 'accuracy': 0.5120330686993927, 'macro avg': {'precision': 0.4781465877614164, 'recall': 0.5564056638229236, 'f1-score': 0.47106330006535274, 'support': 1517568}, 'weighted avg': {'precision': 0.6592504136856201, 'recall': 0.5120330686993927, 'f1-score': 0.5401486607708352, 'support': 1517568}}
[[148004  49743  35761]
 [323194 498435 229751]
 [ 37951  64123 130606]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94118273
{'0': {'precision': 0.3186274049080331, 'recall': 0.6233061832355807, 'f1-score': 0.421690943241327, 'support': 54389}, '1': {'precision': 0.7749529921834937, 'recall': 0.4710510779984414, 'f1-score': 0.5859410111121882, 'support': 211735}, '2': {'precision': 0.3394202662256746, 'recall': 0.5314357609131687, 'f1-score': 0.4142592158284119, 'support': 54842}, 'accuracy': 0.507168983630665, 'macro avg': {'precision': 0.47766688777240046, 'recall': 0.541931007382397, 'f1-score': 0.47396372339397574, 'support': 320966}, 'weighted avg': {'precision': 0.6232092619338606, 'recall': 0.507168983630665, 'f1-score': 0.5287736788764339, 'support': 320966}}
[[33901 13105  7383]
 [62658 99738 49339]
 [ 9838 15859 29145]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9474858
{'0': {'precision': 0.29601012276545335, 'recall': 0.6255689576695493, 'f1-score': 0.4018640350877193, 'support': 17576}, '1': {'precision': 0.7906944762777905, 'recall': 0.46678844462485625, 'f1-score': 0.5870251414472285, 'support': 73905}, '2': {'precision': 0.3392059640609066, 'recall': 0.5440496333897349, 'f1-score': 0.4178742391751684, 'support': 17730}, 'accuracy': 0.5048850390528427, 'macro avg': {'precision': 0.4753035210347169, 'recall': 0.5454690118947135, 'f1-score': 0.46892113857003875, 'support': 109211}, 'weighted avg': {'precision': 0.6377843892083728, 'recall': 0.5048850390528427, 'f1-score': 0.5297650018765043, 'support': 109211}}
[[10995  4254  2327]
 [22943 34498 16464]
 [ 3206  4878  9646]]
training model: results/EXC/W7/deepOF_L1/h30
Epoch 1/50
1254/1254 - 29s - loss: 3.1161 - accuracy30: 0.3924 - val_loss: 3.0513 - val_accuracy30: 0.5359 - 29s/epoch - 23ms/step
Epoch 2/50
1254/1254 - 26s - loss: 3.0361 - accuracy30: 0.4106 - val_loss: 2.9929 - val_accuracy30: 0.5162 - 26s/epoch - 21ms/step
Epoch 3/50
1254/1254 - 27s - loss: 3.0011 - accuracy30: 0.4225 - val_loss: 2.9785 - val_accuracy30: 0.4993 - 27s/epoch - 21ms/step
Epoch 4/50
1254/1254 - 27s - loss: 2.9812 - accuracy30: 0.4282 - val_loss: 2.9616 - val_accuracy30: 0.4865 - 27s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 27s - loss: 2.9660 - accuracy30: 0.4330 - val_loss: 2.9518 - val_accuracy30: 0.4858 - 27s/epoch - 21ms/step
Epoch 6/50
1254/1254 - 28s - loss: 2.9538 - accuracy30: 0.4360 - val_loss: 2.9415 - val_accuracy30: 0.4700 - 28s/epoch - 23ms/step
Epoch 7/50
1254/1254 - 27s - loss: 2.9429 - accuracy30: 0.4392 - val_loss: 2.9467 - val_accuracy30: 0.4700 - 27s/epoch - 21ms/step
Epoch 8/50
1254/1254 - 27s - loss: 2.9330 - accuracy30: 0.4420 - val_loss: 2.9289 - val_accuracy30: 0.4792 - 27s/epoch - 22ms/step
Epoch 9/50
1254/1254 - 26s - loss: 2.9256 - accuracy30: 0.4438 - val_loss: 2.9244 - val_accuracy30: 0.4870 - 26s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 26s - loss: 2.9169 - accuracy30: 0.4478 - val_loss: 2.9232 - val_accuracy30: 0.4821 - 26s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 27s - loss: 2.9084 - accuracy30: 0.4501 - val_loss: 2.9064 - val_accuracy30: 0.4981 - 27s/epoch - 22ms/step
Epoch 12/50
1254/1254 - 26s - loss: 2.9027 - accuracy30: 0.4515 - val_loss: 2.9063 - val_accuracy30: 0.5024 - 26s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 27s - loss: 2.8951 - accuracy30: 0.4542 - val_loss: 2.8986 - val_accuracy30: 0.4993 - 27s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 27s - loss: 2.8883 - accuracy30: 0.4554 - val_loss: 2.9065 - val_accuracy30: 0.5062 - 27s/epoch - 22ms/step
Epoch 15/50
1254/1254 - 27s - loss: 2.8819 - accuracy30: 0.4580 - val_loss: 2.9094 - val_accuracy30: 0.4994 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 2.8760 - accuracy30: 0.4603 - val_loss: 2.9180 - val_accuracy30: 0.4875 - 27s/epoch - 22ms/step
Epoch 17/50
1254/1254 - 26s - loss: 2.8690 - accuracy30: 0.4631 - val_loss: 2.9027 - val_accuracy30: 0.5014 - 26s/epoch - 21ms/step
Epoch 18/50
1254/1254 - 27s - loss: 2.8631 - accuracy30: 0.4648 - val_loss: 2.9028 - val_accuracy30: 0.5094 - 27s/epoch - 21ms/step
Epoch 19/50
1254/1254 - 27s - loss: 2.8570 - accuracy30: 0.4656 - val_loss: 2.9121 - val_accuracy30: 0.5027 - 27s/epoch - 21ms/step
Epoch 20/50
1254/1254 - 28s - loss: 2.8517 - accuracy30: 0.4668 - val_loss: 2.9094 - val_accuracy30: 0.5030 - 28s/epoch - 22ms/step
Epoch 21/50
1254/1254 - 27s - loss: 2.8428 - accuracy30: 0.4709 - val_loss: 2.9197 - val_accuracy30: 0.5052 - 27s/epoch - 21ms/step
Epoch 22/50
1254/1254 - 27s - loss: 2.8388 - accuracy30: 0.4702 - val_loss: 2.9163 - val_accuracy30: 0.4961 - 27s/epoch - 21ms/step
Epoch 23/50
1254/1254 - 27s - loss: 2.8307 - accuracy30: 0.4720 - val_loss: 2.9101 - val_accuracy30: 0.4997 - 27s/epoch - 22ms/step
testing model: results/EXC/W7/deepOF_L1/h30
Evaluating performance on  test set...
5928/5928 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9778996
{'0': {'precision': 0.31618384473485933, 'recall': 0.6609793896557218, 'f1-score': 0.4277504461006178, 'support': 276172}, '1': {'precision': 0.7331100423680293, 'recall': 0.4500484314315339, 'f1-score': 0.5577190747320475, 'support': 967347}, '2': {'precision': 0.381865474942911, 'recall': 0.4826655087228926, 'f1-score': 0.42638909931371066, 'support': 274049}, 'accuracy': 0.49432447178643724, 'macro avg': {'precision': 0.47705312068193323, 'recall': 0.5312311099367161, 'f1-score': 0.47061954004879203, 'support': 1517568}, 'weighted avg': {'precision': 0.5938071812698551, 'recall': 0.49432447178643724, 'f1-score': 0.5103508220146609, 'support': 1517568}}
[[182544  64457  29171]
 [347050 435353 184944]
 [ 47741  94034 132274]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.97903407
{'0': {'precision': 0.3434187962691873, 'recall': 0.6301361452625439, 'f1-score': 0.4445575432061333, 'support': 65151}, '1': {'precision': 0.6709370616782052, 'recall': 0.4706111368323583, 'f1-score': 0.5531968842863019, 'support': 190072}, '2': {'precision': 0.39983847283406754, 'recall': 0.41417337207003024, 'f1-score': 0.4068797023378137, 'support': 65743}, 'accuracy': 0.49143211430494194, 'macro avg': {'precision': 0.4713981102604867, 'recall': 0.5049735513883108, 'f1-score': 0.468211376610083, 'support': 320966}, 'weighted avg': {'precision': 0.5489273253321654, 'recall': 0.49143211430494194, 'f1-score': 0.5011748875528363, 'support': 320966}}
[[41054 18725  5372]
 [65123 89450 35499]
 [13368 25146 27229]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9761242
{'0': {'precision': 0.33119631976900676, 'recall': 0.634969037342841, 'f1-score': 0.4353279835324767, 'support': 21316}, '1': {'precision': 0.6912069412069413, 'recall': 0.4824059289609255, 'f1-score': 0.5682322255540375, 'support': 66386}, '2': {'precision': 0.40641468290023625, 'recall': 0.4159189176623739, 'f1-score': 0.41111187702488455, 'support': 21509}, 'accuracy': 0.49908891961432456, 'macro avg': {'precision': 0.4762726479587281, 'recall': 0.5110979613220469, 'f1-score': 0.4715573620371329, 'support': 109211}, 'weighted avg': {'precision': 0.5648498609632852, 'recall': 0.49908891961432456, 'f1-score': 0.5113470363382521, 'support': 109211}}
[[13535  6039  1742]
 [23037 32025 11324]
 [ 4295  8268  8946]]
training model: results/EXC/W7/deepOF_L1/h50
Epoch 1/50
1254/1254 - 30s - loss: 3.1727 - accuracy50: 0.4029 - val_loss: 3.1392 - val_accuracy50: 0.4769 - 30s/epoch - 24ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.1068 - accuracy50: 0.4195 - val_loss: 3.0941 - val_accuracy50: 0.4691 - 27s/epoch - 22ms/step
Epoch 3/50
1254/1254 - 27s - loss: 3.0799 - accuracy50: 0.4270 - val_loss: 3.0707 - val_accuracy50: 0.4607 - 27s/epoch - 22ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.0635 - accuracy50: 0.4309 - val_loss: 3.0657 - val_accuracy50: 0.4454 - 27s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 27s - loss: 3.0497 - accuracy50: 0.4357 - val_loss: 3.0624 - val_accuracy50: 0.4409 - 27s/epoch - 22ms/step
Epoch 6/50
1254/1254 - 27s - loss: 3.0399 - accuracy50: 0.4387 - val_loss: 3.0562 - val_accuracy50: 0.4370 - 27s/epoch - 22ms/step
Epoch 7/50
1254/1254 - 27s - loss: 3.0292 - accuracy50: 0.4428 - val_loss: 3.0472 - val_accuracy50: 0.4413 - 27s/epoch - 21ms/step
Epoch 8/50
1254/1254 - 27s - loss: 3.0222 - accuracy50: 0.4459 - val_loss: 3.0454 - val_accuracy50: 0.4427 - 27s/epoch - 22ms/step
Epoch 9/50
1254/1254 - 26s - loss: 3.0135 - accuracy50: 0.4484 - val_loss: 3.0392 - val_accuracy50: 0.4453 - 26s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 27s - loss: 3.0071 - accuracy50: 0.4526 - val_loss: 3.0370 - val_accuracy50: 0.4493 - 27s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 27s - loss: 3.0000 - accuracy50: 0.4535 - val_loss: 3.0345 - val_accuracy50: 0.4513 - 27s/epoch - 22ms/step
Epoch 12/50
1254/1254 - 27s - loss: 2.9933 - accuracy50: 0.4570 - val_loss: 3.0392 - val_accuracy50: 0.4494 - 27s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 27s - loss: 2.9866 - accuracy50: 0.4585 - val_loss: 3.0361 - val_accuracy50: 0.4533 - 27s/epoch - 22ms/step
Epoch 14/50
1254/1254 - 27s - loss: 2.9815 - accuracy50: 0.4604 - val_loss: 3.0364 - val_accuracy50: 0.4558 - 27s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 26s - loss: 2.9757 - accuracy50: 0.4627 - val_loss: 3.0476 - val_accuracy50: 0.4541 - 26s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 2.9675 - accuracy50: 0.4658 - val_loss: 3.0563 - val_accuracy50: 0.4555 - 27s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 27s - loss: 2.9611 - accuracy50: 0.4678 - val_loss: 3.0500 - val_accuracy50: 0.4548 - 27s/epoch - 21ms/step
Epoch 18/50
1254/1254 - 27s - loss: 2.9545 - accuracy50: 0.4708 - val_loss: 3.0494 - val_accuracy50: 0.4556 - 27s/epoch - 22ms/step
Epoch 19/50
1254/1254 - 27s - loss: 2.9502 - accuracy50: 0.4710 - val_loss: 3.0462 - val_accuracy50: 0.4620 - 27s/epoch - 22ms/step
Epoch 20/50
1254/1254 - 27s - loss: 2.9432 - accuracy50: 0.4736 - val_loss: 3.0515 - val_accuracy50: 0.4621 - 27s/epoch - 21ms/step
Epoch 21/50
1254/1254 - 27s - loss: 2.9365 - accuracy50: 0.4765 - val_loss: 3.0515 - val_accuracy50: 0.4682 - 27s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h50
Evaluating performance on  test set...
5928/5928 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9981448
{'0': {'precision': 0.3633700421908502, 'recall': 0.6829497986515141, 'f1-score': 0.47435494857947735, 'support': 346166}, '1': {'precision': 0.6418868349416822, 'recall': 0.349545308089236, 'f1-score': 0.4526150035688683, 'support': 831772}, '2': {'precision': 0.42161428391996214, 'recall': 0.5139416423755263, 'f1-score': 0.46322220069689, 'support': 339630}, 'accuracy': 0.46238850581983804, 'macro avg': {'precision': 0.4756237203508315, 'recall': 0.5154789163720921, 'f1-score': 0.4633973842817452, 'support': 1517568}, 'weighted avg': {'precision': 0.5290588031283524, 'recall': 0.46238850581983804, 'f1-score': 0.4599478889256579, 'support': 1517568}}
[[236414  68205  41547]
 [343123 290742 197907]
 [ 71078  94002 174550]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0174284
{'0': {'precision': 0.3823488441997375, 'recall': 0.6364113390362063, 'f1-score': 0.4777005303509109, 'support': 81947}, '1': {'precision': 0.5609515543632634, 'recall': 0.3650811990500032, 'f1-score': 0.4423015607624172, 'support': 155790}, '2': {'precision': 0.4398677487225729, 'recall': 0.4395823571111031, 'f1-score': 0.4397250066104181, 'support': 83229}, 'accuracy': 0.45367422094552073, 'macro avg': {'precision': 0.4610560490951912, 'recall': 0.48035829839910416, 'f1-score': 0.45324236590791545, 'support': 320966}, 'weighted avg': {'precision': 0.4839538650458919, 'recall': 0.45367422094552073, 'f1-score': 0.4506712800951551, 'support': 320966}}
[[52152 19855  9940]
 [62265 56876 36649]
 [21982 24661 36586]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.020865
{'0': {'precision': 0.36547967103464235, 'recall': 0.6369734960958979, 'f1-score': 0.46446232391542597, 'support': 27279}, '1': {'precision': 0.5739492181896428, 'recall': 0.36829411981295335, 'f1-score': 0.4486784116268377, 'support': 54318}, '2': {'precision': 0.4426957073061575, 'recall': 0.4298544216701673, 'f1-score': 0.43618057214250283, 'support': 27614}, 'accuracy': 0.45097105602915455, 'macro avg': {'precision': 0.4607081988434809, 'recall': 0.4783740125263396, 'f1-score': 0.44977376922825546, 'support': 109211}, 'weighted avg': {'precision': 0.488689718447146, 'recall': 0.45097105602915455, 'f1-score': 0.44946087862924566, 'support': 109211}}
[[17376  6597  3306]
 [22676 20005 11637]
 [ 7491  8253 11870]]
training model: results/EXC/W7/deepOF_L1/h100
Epoch 1/50
1254/1254 - 28s - loss: 3.2495 - accuracy100: 0.4018 - val_loss: 3.2537 - val_accuracy100: 0.3920 - 28s/epoch - 22ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.2099 - accuracy100: 0.4156 - val_loss: 3.2272 - val_accuracy100: 0.4029 - 27s/epoch - 21ms/step
Epoch 3/50
1254/1254 - 26s - loss: 3.1941 - accuracy100: 0.4208 - val_loss: 3.2179 - val_accuracy100: 0.4080 - 26s/epoch - 21ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.1832 - accuracy100: 0.4245 - val_loss: 3.2131 - val_accuracy100: 0.4123 - 27s/epoch - 22ms/step
Epoch 5/50
1254/1254 - 26s - loss: 3.1740 - accuracy100: 0.4296 - val_loss: 3.2137 - val_accuracy100: 0.4144 - 26s/epoch - 21ms/step
Epoch 6/50
1254/1254 - 26s - loss: 3.1685 - accuracy100: 0.4308 - val_loss: 3.2130 - val_accuracy100: 0.4147 - 26s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 3.1622 - accuracy100: 0.4344 - val_loss: 3.2103 - val_accuracy100: 0.4157 - 27s/epoch - 22ms/step
Epoch 8/50
1254/1254 - 26s - loss: 3.1572 - accuracy100: 0.4361 - val_loss: 3.2109 - val_accuracy100: 0.4179 - 26s/epoch - 21ms/step
Epoch 9/50
1254/1254 - 27s - loss: 3.1525 - accuracy100: 0.4386 - val_loss: 3.2138 - val_accuracy100: 0.4167 - 27s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 27s - loss: 3.1480 - accuracy100: 0.4404 - val_loss: 3.2188 - val_accuracy100: 0.4147 - 27s/epoch - 22ms/step
Epoch 11/50
1254/1254 - 26s - loss: 3.1437 - accuracy100: 0.4418 - val_loss: 3.2166 - val_accuracy100: 0.4171 - 26s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 27s - loss: 3.1403 - accuracy100: 0.4434 - val_loss: 3.2196 - val_accuracy100: 0.4161 - 27s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 26s - loss: 3.1358 - accuracy100: 0.4461 - val_loss: 3.2208 - val_accuracy100: 0.4152 - 26s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 27s - loss: 3.1311 - accuracy100: 0.4482 - val_loss: 3.2238 - val_accuracy100: 0.4171 - 27s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 3.1277 - accuracy100: 0.4501 - val_loss: 3.2231 - val_accuracy100: 0.4169 - 27s/epoch - 22ms/step
Epoch 16/50
1254/1254 - 26s - loss: 3.1244 - accuracy100: 0.4521 - val_loss: 3.2224 - val_accuracy100: 0.4184 - 26s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 27s - loss: 3.1198 - accuracy100: 0.4529 - val_loss: 3.2310 - val_accuracy100: 0.4152 - 27s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h100
Evaluating performance on  test set...
5928/5928 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0396712
{'0': {'precision': 0.4320338980534453, 'recall': 0.6280439507313251, 'f1-score': 0.5119176416984641, 'support': 463337}, '1': {'precision': 0.46266674366229715, 'recall': 0.30294352154006754, 'f1-score': 0.36614423550730396, 'support': 608285}, '2': {'precision': 0.4573888111135042, 'recall': 0.457165217313307, 'f1-score': 0.45727698688085555, 'support': 445946}, 'accuracy': 0.44752063828441296, 'macro avg': {'precision': 0.45069648427641557, 'recall': 0.4627175631948999, 'f1-score': 0.4451129546955412, 'support': 1517568}, 'weighted avg': {'precision': 0.4517631112094037, 'recall': 0.44752063828441296, 'f1-score': 0.43743099079499026, 'support': 1517568}}
[[290996  95195  77146]
 [259298 184276 164711]
 [123255 118820 203871]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0635402
{'0': {'precision': 0.43042477801149115, 'recall': 0.580198283572149, 'f1-score': 0.49421337569293605, 'support': 105102}, '1': {'precision': 0.38210004876671544, 'recall': 0.27683095776036, 'f1-score': 0.32105674619220914, 'support': 107553}, '2': {'precision': 0.4643780211107823, 'recall': 0.4346188291124632, 'f1-score': 0.4490058708228214, 'support': 108311}, 'accuracy': 0.42941619984671275, 'macro avg': {'precision': 0.425634282629663, 'recall': 0.4305493568149907, 'f1-score': 0.4214253309026555, 'support': 320966}, 'weighted avg': {'precision': 0.42568919888119067, 'recall': 0.42941619984671275, 'f1-score': 0.4209346326713117, 'support': 320966}}
[[60980 22060 22062]
 [45545 29774 32234]
 [35149 26088 47074]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0703745
{'0': {'precision': 0.4119340905455127, 'recall': 0.5802326563952342, 'f1-score': 0.48180935786039225, 'support': 35503}, '1': {'precision': 0.38127879964964395, 'recall': 0.26639704121544316, 'f1-score': 0.3136493217631027, 'support': 37583}, '2': {'precision': 0.4558644973288004, 'recall': 0.41572318339100345, 'f1-score': 0.4348694783477392, 'support': 36125}, 'accuracy': 0.4178150552600013, 'macro avg': {'precision': 0.4163591291746524, 'recall': 0.42078429366722697, 'f1-score': 0.4101093859904114, 'support': 109211}, 'weighted avg': {'precision': 0.4159159984788421, 'recall': 0.4178150552600013, 'f1-score': 0.4084132550498784, 'support': 109211}}
[[20600  7619  7284]
 [16929 10012 10642]
 [12479  8628 15018]]
training model: results/EXC/W7/deepOF_L1/h200
Epoch 1/50
1254/1254 - 28s - loss: 3.2869 - accuracy200: 0.3719 - val_loss: 3.2896 - val_accuracy200: 0.3682 - 28s/epoch - 22ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.2595 - accuracy200: 0.3843 - val_loss: 3.2819 - val_accuracy200: 0.3751 - 27s/epoch - 22ms/step
Epoch 3/50
1254/1254 - 27s - loss: 3.2509 - accuracy200: 0.3883 - val_loss: 3.2791 - val_accuracy200: 0.3790 - 27s/epoch - 22ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.2459 - accuracy200: 0.3916 - val_loss: 3.2796 - val_accuracy200: 0.3808 - 27s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 26s - loss: 3.2416 - accuracy200: 0.3947 - val_loss: 3.2792 - val_accuracy200: 0.3818 - 26s/epoch - 21ms/step
Epoch 6/50
1254/1254 - 26s - loss: 3.2390 - accuracy200: 0.3971 - val_loss: 3.2777 - val_accuracy200: 0.3824 - 26s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 26s - loss: 3.2364 - accuracy200: 0.3988 - val_loss: 3.2761 - val_accuracy200: 0.3817 - 26s/epoch - 21ms/step
Epoch 8/50
1254/1254 - 26s - loss: 3.2333 - accuracy200: 0.4008 - val_loss: 3.2777 - val_accuracy200: 0.3801 - 26s/epoch - 21ms/step
Epoch 9/50
1254/1254 - 26s - loss: 3.2316 - accuracy200: 0.4023 - val_loss: 3.2745 - val_accuracy200: 0.3814 - 26s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 26s - loss: 3.2298 - accuracy200: 0.4026 - val_loss: 3.2772 - val_accuracy200: 0.3806 - 26s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 26s - loss: 3.2280 - accuracy200: 0.4042 - val_loss: 3.2764 - val_accuracy200: 0.3822 - 26s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 27s - loss: 3.2255 - accuracy200: 0.4058 - val_loss: 3.2783 - val_accuracy200: 0.3812 - 27s/epoch - 21ms/step
Epoch 13/50
1254/1254 - 26s - loss: 3.2237 - accuracy200: 0.4066 - val_loss: 3.2788 - val_accuracy200: 0.3795 - 26s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 27s - loss: 3.2218 - accuracy200: 0.4078 - val_loss: 3.2817 - val_accuracy200: 0.3783 - 27s/epoch - 22ms/step
Epoch 15/50
1254/1254 - 27s - loss: 3.2201 - accuracy200: 0.4088 - val_loss: 3.2808 - val_accuracy200: 0.3800 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 26s - loss: 3.2172 - accuracy200: 0.4109 - val_loss: 3.2873 - val_accuracy200: 0.3775 - 26s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 27s - loss: 3.2154 - accuracy200: 0.4113 - val_loss: 3.2855 - val_accuracy200: 0.3775 - 27s/epoch - 21ms/step
Epoch 18/50
1254/1254 - 27s - loss: 3.2130 - accuracy200: 0.4136 - val_loss: 3.2994 - val_accuracy200: 0.3720 - 27s/epoch - 22ms/step
Epoch 19/50
1254/1254 - 27s - loss: 3.2111 - accuracy200: 0.4148 - val_loss: 3.2927 - val_accuracy200: 0.3742 - 27s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h200
Evaluating performance on  test set...
5928/5928 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0715379
{'0': {'precision': 0.4209354934645143, 'recall': 0.671904092079075, 'f1-score': 0.5176025544855245, 'support': 513993}, '1': {'precision': 0.47743306417339565, 'recall': 0.010735322785947181, 'f1-score': 0.020998484086648186, 'support': 523226}, '2': {'precision': 0.40794970227282346, 'recall': 0.5820601271159095, 'f1-score': 0.479694743452048, 'support': 480349}, 'accuracy': 0.41550889317645073, 'macro avg': {'precision': 0.4354394199702445, 'recall': 0.4215665139936438, 'f1-score': 0.33943192734140687, 'support': 1517568}, 'weighted avg': {'precision': 0.4363043508195637, 'recall': 0.41550889317645073, 'f1-score': 0.33438497183971105, 'support': 1517568}}
[[345354   2984 165655]
 [277497   5617 240112]
 [197593   3164 279592]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0827254
{'0': {'precision': 0.38893336527841893, 'recall': 0.6302447800767009, 'f1-score': 0.4810213491753754, 'support': 105605}, '1': {'precision': 0.5874403815580286, 'recall': 0.013965266360526862, 'f1-score': 0.02728195662205814, 'support': 105834}, '2': {'precision': 0.4092979371856397, 'recall': 0.5505400494855149, 'f1-score': 0.4695269612614366, 'support': 109527}, 'accuracy': 0.39983674283257414, 'macro avg': {'precision': 0.4618905613406958, 'recall': 0.3982500319742475, 'f1-score': 0.3259434223529567, 'support': 320966}, 'weighted avg': {'precision': 0.46133748916761086, 'recall': 0.39983674283257414, 'f1-score': 0.3274848353498058, 'support': 320966}}
[[66557   429 38619]
 [55951  1478 48405]
 [48619   609 60299]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0910947
{'0': {'precision': 0.3736064125851984, 'recall': 0.629747191011236, 'f1-score': 0.46898239668643515, 'support': 35600}, '1': {'precision': 0.38741721854304634, 'recall': 0.0031498182797146316, 'f1-score': 0.006248831682110716, 'support': 37145}, '2': {'precision': 0.3906793178193121, 'recall': 0.5239126857895026, 'f1-score': 0.4475916034111142, 'support': 36466}, 'accuracy': 0.3812894305518675, 'macro avg': {'precision': 0.3839009829825189, 'recall': 0.38560323169348437, 'f1-score': 0.30760761059322, 'support': 109211}, 'weighted avg': {'precision': 0.38400447642099744, 'recall': 0.3812894305518675, 'f1-score': 0.3044543277221048, 'support': 109211}}
[[22419    95 13086]
 [20317   117 16711]
 [17271    90 19105]]
training model: results/EXC/W7/deepOF_L1/h300
Epoch 1/50
1254/1254 - 29s - loss: 3.3063 - accuracy300: 0.3581 - val_loss: 3.2924 - val_accuracy300: 0.3547 - 29s/epoch - 23ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.2827 - accuracy300: 0.3670 - val_loss: 3.2849 - val_accuracy300: 0.3629 - 27s/epoch - 22ms/step
Epoch 3/50
1254/1254 - 28s - loss: 3.2746 - accuracy300: 0.3710 - val_loss: 3.2838 - val_accuracy300: 0.3643 - 28s/epoch - 23ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.2710 - accuracy300: 0.3738 - val_loss: 3.2824 - val_accuracy300: 0.3664 - 27s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 27s - loss: 3.2673 - accuracy300: 0.3767 - val_loss: 3.2810 - val_accuracy300: 0.3664 - 27s/epoch - 22ms/step
Epoch 6/50
1254/1254 - 27s - loss: 3.2647 - accuracy300: 0.3800 - val_loss: 3.2817 - val_accuracy300: 0.3660 - 27s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 3.2631 - accuracy300: 0.3814 - val_loss: 3.2808 - val_accuracy300: 0.3663 - 27s/epoch - 22ms/step
Epoch 8/50
1254/1254 - 28s - loss: 3.2609 - accuracy300: 0.3821 - val_loss: 3.2805 - val_accuracy300: 0.3663 - 28s/epoch - 22ms/step
Epoch 9/50
1254/1254 - 27s - loss: 3.2591 - accuracy300: 0.3833 - val_loss: 3.2805 - val_accuracy300: 0.3666 - 27s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 27s - loss: 3.2577 - accuracy300: 0.3839 - val_loss: 3.2790 - val_accuracy300: 0.3691 - 27s/epoch - 22ms/step
Epoch 11/50
1254/1254 - 27s - loss: 3.2563 - accuracy300: 0.3857 - val_loss: 3.2793 - val_accuracy300: 0.3687 - 27s/epoch - 22ms/step
Epoch 12/50
1254/1254 - 27s - loss: 3.2550 - accuracy300: 0.3872 - val_loss: 3.2790 - val_accuracy300: 0.3686 - 27s/epoch - 22ms/step
Epoch 13/50
1254/1254 - 27s - loss: 3.2529 - accuracy300: 0.3886 - val_loss: 3.2799 - val_accuracy300: 0.3677 - 27s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 26s - loss: 3.2513 - accuracy300: 0.3893 - val_loss: 3.2810 - val_accuracy300: 0.3683 - 26s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 3.2505 - accuracy300: 0.3901 - val_loss: 3.2803 - val_accuracy300: 0.3684 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 3.2487 - accuracy300: 0.3914 - val_loss: 3.2830 - val_accuracy300: 0.3681 - 27s/epoch - 22ms/step
Epoch 17/50
1254/1254 - 27s - loss: 3.2472 - accuracy300: 0.3927 - val_loss: 3.2843 - val_accuracy300: 0.3665 - 27s/epoch - 21ms/step
Epoch 18/50
1254/1254 - 27s - loss: 3.2463 - accuracy300: 0.3934 - val_loss: 3.2865 - val_accuracy300: 0.3665 - 27s/epoch - 21ms/step
Epoch 19/50
1254/1254 - 26s - loss: 3.2451 - accuracy300: 0.3952 - val_loss: 3.2860 - val_accuracy300: 0.3666 - 26s/epoch - 21ms/step
Epoch 20/50
1254/1254 - 27s - loss: 3.2430 - accuracy300: 0.3959 - val_loss: 3.2897 - val_accuracy300: 0.3656 - 27s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h300
Evaluating performance on  test set...
5928/5928 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0783604
{'0': {'precision': 0.3987036097243695, 'recall': 0.6055330725660615, 'f1-score': 0.48081936479144644, 'support': 502108}, '1': {'precision': 0.43943131654115813, 'recall': 0.06149801124026289, 'f1-score': 0.10789606655158177, 'support': 550343}, '2': {'precision': 0.37871643098725755, 'recall': 0.5520288443552912, 'f1-score': 0.4492365403827884, 'support': 465117}, 'accuracy': 0.39184141995614036, 'macro avg': {'precision': 0.40561711908426173, 'recall': 0.4063533093872052, 'f1-score': 0.3459839905752722, 'support': 1517568}, 'weighted avg': {'precision': 0.4073475925574304, 'recall': 0.39184141995614036, 'f1-score': 0.3358997069812504, 'support': 1517568}}
[[304043  22415 175650]
 [270937  33845 245561]
 [187599  20760 256758]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0875084
{'0': {'precision': 0.37611270320306356, 'recall': 0.5621499710974442, 'f1-score': 0.4506877466752263, 'support': 105527}, '1': {'precision': 0.4357814761215629, 'recall': 0.04559003037442871, 'f1-score': 0.08254452315889563, 'support': 105681}, '2': {'precision': 0.3914026257342988, 'recall': 0.5427030375917928, 'f1-score': 0.45479949912958495, 'support': 109758}, 'accuracy': 0.38541777010649103, 'macro avg': {'precision': 0.4010989350196417, 'recall': 0.3834810130212219, 'f1-score': 0.3293439229879023, 'support': 320966}, 'weighted avg': {'precision': 0.4009877582181843, 'recall': 0.38541777010649103, 'f1-score': 0.33087927388202126, 'support': 320966}}
[[59322  2976 43229]
 [51472  4818 49391]
 [46930  3262 59566]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0927904
{'0': {'precision': 0.3601713294296248, 'recall': 0.5643530711069578, 'f1-score': 0.439715373159027, 'support': 35313}, '1': {'precision': 0.41408, 'recall': 0.034340003184544346, 'f1-score': 0.06342049158232657, 'support': 37682}, '2': {'precision': 0.37431532490050046, 'recall': 0.5245747735807378, 'f1-score': 0.43688628262619295, 'support': 36216}, 'accuracy': 0.3682870773090623, 'macro avg': {'precision': 0.38285555144337513, 'recall': 0.3744226159574133, 'f1-score': 0.31334071578918216, 'support': 109211}, 'weighted avg': {'precision': 0.38346225675751405, 'recall': 0.3682870773090623, 'f1-score': 0.30894098165716044, 'support': 109211}}
[[19929   958 14426]
 [19058  1294 17330]
 [16345   873 18998]]
training model: results/EXC/W7/deepOF_L1/h500
Epoch 1/50
1254/1254 - 31s - loss: 3.2898 - accuracy500: 0.3785 - val_loss: 3.2992 - val_accuracy500: 0.3652 - 31s/epoch - 25ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.2792 - accuracy500: 0.3797 - val_loss: 3.2915 - val_accuracy500: 0.3633 - 27s/epoch - 22ms/step
Epoch 3/50
1254/1254 - 27s - loss: 3.2775 - accuracy500: 0.3752 - val_loss: 3.2902 - val_accuracy500: 0.3675 - 27s/epoch - 22ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.2755 - accuracy500: 0.3726 - val_loss: 3.2895 - val_accuracy500: 0.3700 - 27s/epoch - 21ms/step
Epoch 5/50
1254/1254 - 26s - loss: 3.2735 - accuracy500: 0.3729 - val_loss: 3.2880 - val_accuracy500: 0.3706 - 26s/epoch - 21ms/step
Epoch 6/50
1254/1254 - 26s - loss: 3.2716 - accuracy500: 0.3744 - val_loss: 3.2879 - val_accuracy500: 0.3717 - 26s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 3.2697 - accuracy500: 0.3747 - val_loss: 3.2872 - val_accuracy500: 0.3716 - 27s/epoch - 22ms/step
Epoch 8/50
1254/1254 - 26s - loss: 3.2687 - accuracy500: 0.3761 - val_loss: 3.2867 - val_accuracy500: 0.3722 - 26s/epoch - 21ms/step
Epoch 9/50
1254/1254 - 26s - loss: 3.2676 - accuracy500: 0.3761 - val_loss: 3.2862 - val_accuracy500: 0.3739 - 26s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 26s - loss: 3.2668 - accuracy500: 0.3763 - val_loss: 3.2868 - val_accuracy500: 0.3746 - 26s/epoch - 21ms/step
Epoch 11/50
1254/1254 - 26s - loss: 3.2654 - accuracy500: 0.3771 - val_loss: 3.2867 - val_accuracy500: 0.3740 - 26s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 26s - loss: 3.2638 - accuracy500: 0.3787 - val_loss: 3.2864 - val_accuracy500: 0.3741 - 26s/epoch - 20ms/step
Epoch 13/50
1254/1254 - 26s - loss: 3.2630 - accuracy500: 0.3789 - val_loss: 3.2882 - val_accuracy500: 0.3729 - 26s/epoch - 20ms/step
Epoch 14/50
1254/1254 - 26s - loss: 3.2616 - accuracy500: 0.3798 - val_loss: 3.2882 - val_accuracy500: 0.3735 - 26s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 3.2607 - accuracy500: 0.3809 - val_loss: 3.2872 - val_accuracy500: 0.3735 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 26s - loss: 3.2593 - accuracy500: 0.3820 - val_loss: 3.2886 - val_accuracy500: 0.3737 - 26s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 25s - loss: 3.2575 - accuracy500: 0.3845 - val_loss: 3.2883 - val_accuracy500: 0.3741 - 25s/epoch - 20ms/step
Epoch 18/50
1254/1254 - 27s - loss: 3.2565 - accuracy500: 0.3854 - val_loss: 3.2873 - val_accuracy500: 0.3752 - 27s/epoch - 22ms/step
Epoch 19/50
1254/1254 - 26s - loss: 3.2553 - accuracy500: 0.3855 - val_loss: 3.2895 - val_accuracy500: 0.3747 - 26s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h500
Evaluating performance on  test set...
5928/5928 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.084891
{'0': {'precision': 0.40990984875227415, 'recall': 0.6467689934769336, 'f1-score': 0.5017929189052184, 'support': 560166}, '1': {'precision': 0.4349085165196788, 'recall': 0.007390986307437292, 'f1-score': 0.014534960451182065, 'support': 447031}, '2': {'precision': 0.3911771329275558, 'recall': 0.4798959972255477, 'f1-score': 0.4310185535515366, 'support': 510371}, 'accuracy': 0.40230618990384615, 'macro avg': {'precision': 0.41199849939983624, 'recall': 0.37801865900330617, 'f1-score': 0.3157821443026457, 'support': 1517568}, 'weighted avg': {'precision': 0.41097375135337894, 'recall': 0.40230618990384615, 'f1-score': 0.3344590030308785, 'support': 1517568}}
[[362298   2599 195269]
 [257798   3304 185929]
 [263752   1694 244925]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0990776
{'0': {'precision': 0.3588235294117647, 'recall': 0.6115896706941483, 'f1-score': 0.4522872610683813, 'support': 105525}, '1': {'precision': 0.44610778443113774, 'recall': 0.0014063370112035035, 'f1-score': 0.0028038350441745154, 'support': 105949}, '2': {'precision': 0.37334128946097234, 'recall': 0.47999853870602416, 'f1-score': 0.42000447527411056, 'support': 109492}, 'accuracy': 0.3652816809257055, 'macro avg': {'precision': 0.39275753443462486, 'recall': 0.36433151547045867, 'f1-score': 0.29169852379555544, 'support': 320966}, 'weighted avg': {'precision': 0.39258803443209517, 'recall': 0.3652816809257055, 'f1-score': 0.29290269608011155, 'support': 320966}}
[[64538   100 40887]
 [58471   149 47329]
 [56851    85 52556]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955201
{'0': {'precision': 0.3663032768648889, 'recall': 0.6149290363888592, 'f1-score': 0.4591176177671546, 'support': 37484}, '1': {'precision': 0.36, 'recall': 0.0010978287387167602, 'f1-score': 0.0021889821233126595, 'support': 32792}, '2': {'precision': 0.38653242394716897, 'recall': 0.4585077693591884, 'f1-score': 0.41945488721804514, 'support': 38935}, 'accuracy': 0.3748523500379998, 'macro avg': {'precision': 0.3709452336040193, 'recall': 0.3581782114955881, 'f1-score': 0.2935871623695041, 'support': 109211}, 'weighted avg': {'precision': 0.3716225650931364, 'recall': 0.3748523500379998, 'f1-score': 0.3077787211911463, 'support': 109211}}
[[23050    36 14398]
 [18821    36 13935]
 [21055    28 17852]]
training model: results/EXC/W7/deepOF_L1/h1000
Epoch 1/50
1254/1254 - 29s - loss: 3.2728 - accuracy1000: 0.3912 - val_loss: 3.4452 - val_accuracy1000: 0.3359 - 29s/epoch - 23ms/step
Epoch 2/50
1254/1254 - 27s - loss: 3.2575 - accuracy1000: 0.3912 - val_loss: 3.4350 - val_accuracy1000: 0.3389 - 27s/epoch - 21ms/step
Epoch 3/50
1254/1254 - 27s - loss: 3.2615 - accuracy1000: 0.3864 - val_loss: 3.4145 - val_accuracy1000: 0.3446 - 27s/epoch - 22ms/step
Epoch 4/50
1254/1254 - 27s - loss: 3.2644 - accuracy1000: 0.3855 - val_loss: 3.4092 - val_accuracy1000: 0.3414 - 27s/epoch - 22ms/step
Epoch 5/50
1254/1254 - 27s - loss: 3.2650 - accuracy1000: 0.3849 - val_loss: 3.4053 - val_accuracy1000: 0.3457 - 27s/epoch - 21ms/step
Epoch 6/50
1254/1254 - 26s - loss: 3.2660 - accuracy1000: 0.3838 - val_loss: 3.3995 - val_accuracy1000: 0.3459 - 26s/epoch - 21ms/step
Epoch 7/50
1254/1254 - 27s - loss: 3.2671 - accuracy1000: 0.3835 - val_loss: 3.3976 - val_accuracy1000: 0.3455 - 27s/epoch - 21ms/step
Epoch 8/50
1254/1254 - 27s - loss: 3.2680 - accuracy1000: 0.3830 - val_loss: 3.4087 - val_accuracy1000: 0.3432 - 27s/epoch - 22ms/step
Epoch 9/50
1254/1254 - 27s - loss: 3.2666 - accuracy1000: 0.3844 - val_loss: 3.4197 - val_accuracy1000: 0.3434 - 27s/epoch - 21ms/step
Epoch 10/50
1254/1254 - 27s - loss: 3.2656 - accuracy1000: 0.3848 - val_loss: 3.4158 - val_accuracy1000: 0.3444 - 27s/epoch - 22ms/step
Epoch 11/50
1254/1254 - 27s - loss: 3.2635 - accuracy1000: 0.3856 - val_loss: 3.4189 - val_accuracy1000: 0.3453 - 27s/epoch - 21ms/step
Epoch 12/50
1254/1254 - 27s - loss: 3.2624 - accuracy1000: 0.3875 - val_loss: 3.4189 - val_accuracy1000: 0.3436 - 27s/epoch - 22ms/step
Epoch 13/50
1254/1254 - 27s - loss: 3.2619 - accuracy1000: 0.3873 - val_loss: 3.4219 - val_accuracy1000: 0.3452 - 27s/epoch - 21ms/step
Epoch 14/50
1254/1254 - 27s - loss: 3.2606 - accuracy1000: 0.3878 - val_loss: 3.4260 - val_accuracy1000: 0.3442 - 27s/epoch - 21ms/step
Epoch 15/50
1254/1254 - 27s - loss: 3.2620 - accuracy1000: 0.3873 - val_loss: 3.4270 - val_accuracy1000: 0.3447 - 27s/epoch - 21ms/step
Epoch 16/50
1254/1254 - 27s - loss: 3.2607 - accuracy1000: 0.3876 - val_loss: 3.4117 - val_accuracy1000: 0.3445 - 27s/epoch - 21ms/step
Epoch 17/50
1254/1254 - 27s - loss: 3.2593 - accuracy1000: 0.3887 - val_loss: 3.4085 - val_accuracy1000: 0.3450 - 27s/epoch - 21ms/step
testing model: results/EXC/W7/deepOF_L1/h1000
Evaluating performance on  test set...
5928/5928 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0567569
{'0': {'precision': 0.44163923966449553, 'recall': 0.6965135444185955, 'f1-score': 0.5405385225514581, 'support': 634025}, '1': {'precision': 0.23414634146341465, 'recall': 0.0003037638236271299, 'f1-score': 0.0006067405078291647, 'support': 316035}, '2': {'precision': 0.4164406232418397, 'recall': 0.37954707246417674, 'f1-score': 0.39713885091252366, 'support': 567508}, 'accuracy': 0.43299476530870445, 'macro avg': {'precision': 0.3640754014565833, 'recall': 0.35878812690213313, 'f1-score': 0.31276137132393694, 'support': 1517568}, 'weighted avg': {'precision': 0.3890053975620216, 'recall': 0.43299476530870445, 'f1-score': 0.3744716302668114, 'support': 1517568}}
[[441607    160 192258]
 [206362     96 109577]
 [351958    154 215396]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.132091
{'0': {'precision': 0.34432606446173303, 'recall': 0.6785491758397372, 'f1-score': 0.45683414370610476, 'support': 105926}, '1': {'precision': 0.36363636363636365, 'recall': 0.00011276817682050125, 'f1-score': 0.0002254664336846852, 'support': 106413}, '2': {'precision': 0.35857347868329337, 'recall': 0.37033150137626925, 'f1-score': 0.36435765524237373, 'support': 108627}, 'accuracy': 0.3493080263953191, 'macro avg': {'precision': 0.35551196892713, 'recall': 0.34966448179760895, 'f1-score': 0.27380575512738775, 'support': 320966}, 'weighted avg': {'precision': 0.3555500593107681, 'recall': 0.3493080263953191, 'f1-score': 0.2741526675156679, 'support': 320966}}
[[71876     6 34044]
 [68484    12 37917]
 [68384    15 40228]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317667
{'0': {'precision': 0.33618311436453524, 'recall': 0.692822966507177, 'f1-score': 0.4526997204649109, 'support': 35530}, '1': {'precision': 0.5, 'recall': 5.5665339976063906e-05, 'f1-score': 0.00011131828681156599, 'support': 35929}, '2': {'precision': 0.36670835070168123, 'recall': 0.34954439499894047, 'f1-score': 0.35792071822829785, 'support': 37752}, 'accuracy': 0.3462471729038284, 'macro avg': {'precision': 0.40096382168873884, 'recall': 0.34747434228203117, 'f1-score': 0.2702439189933401, 'support': 109211}, 'weighted avg': {'precision': 0.40062868858504924, 'recall': 0.3462471729038284, 'f1-score': 0.2710408619772719, 'support': 109211}}
[[24616     1 10913]
 [24051     2 11876]
 [24555     1 13196]]
training model: results/EXC/W7/deepLOB_L2/h10
Epoch 1/50
1254/1254 - 62s - loss: 2.7566 - accuracy10: 0.4717 - val_loss: 2.8062 - val_accuracy10: 0.2974 - 62s/epoch - 50ms/step
Epoch 2/50
1254/1254 - 59s - loss: 2.5386 - accuracy10: 0.5231 - val_loss: 2.9005 - val_accuracy10: 0.2668 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 59s - loss: 2.4360 - accuracy10: 0.5628 - val_loss: 2.5486 - val_accuracy10: 0.3908 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 2.3480 - accuracy10: 0.5992 - val_loss: 2.4744 - val_accuracy10: 0.4618 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 58s - loss: 2.2678 - accuracy10: 0.6247 - val_loss: 2.4132 - val_accuracy10: 0.4929 - 58s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 2.2228 - accuracy10: 0.6332 - val_loss: 2.5027 - val_accuracy10: 0.4597 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 58s - loss: 2.1933 - accuracy10: 0.6388 - val_loss: 2.3064 - val_accuracy10: 0.5256 - 58s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 59s - loss: 2.1698 - accuracy10: 0.6425 - val_loss: 2.3988 - val_accuracy10: 0.4941 - 59s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 58s - loss: 2.1520 - accuracy10: 0.6440 - val_loss: 2.3637 - val_accuracy10: 0.5004 - 58s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 58s - loss: 2.1301 - accuracy10: 0.6464 - val_loss: 2.4340 - val_accuracy10: 0.4880 - 58s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 58s - loss: 2.1145 - accuracy10: 0.6495 - val_loss: 2.3424 - val_accuracy10: 0.5239 - 58s/epoch - 46ms/step
Epoch 12/50
1254/1254 - 58s - loss: 2.1004 - accuracy10: 0.6496 - val_loss: 2.3547 - val_accuracy10: 0.5222 - 58s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 59s - loss: 2.0864 - accuracy10: 0.6500 - val_loss: 2.3005 - val_accuracy10: 0.5423 - 59s/epoch - 47ms/step
Epoch 14/50
1254/1254 - 59s - loss: 2.0748 - accuracy10: 0.6516 - val_loss: 2.2315 - val_accuracy10: 0.5671 - 59s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 59s - loss: 2.0634 - accuracy10: 0.6527 - val_loss: 2.2669 - val_accuracy10: 0.5725 - 59s/epoch - 47ms/step
Epoch 16/50
1254/1254 - 58s - loss: 2.0533 - accuracy10: 0.6534 - val_loss: 2.2377 - val_accuracy10: 0.5682 - 58s/epoch - 46ms/step
Epoch 17/50
1254/1254 - 58s - loss: 2.0430 - accuracy10: 0.6535 - val_loss: 2.2502 - val_accuracy10: 0.5798 - 58s/epoch - 47ms/step
Epoch 18/50
1254/1254 - 59s - loss: 2.0313 - accuracy10: 0.6551 - val_loss: 2.2396 - val_accuracy10: 0.5694 - 59s/epoch - 47ms/step
Epoch 19/50
1254/1254 - 58s - loss: 2.0221 - accuracy10: 0.6553 - val_loss: 2.2283 - val_accuracy10: 0.5825 - 58s/epoch - 46ms/step
Epoch 20/50
1254/1254 - 59s - loss: 2.0117 - accuracy10: 0.6564 - val_loss: 2.2681 - val_accuracy10: 0.5706 - 59s/epoch - 47ms/step
Epoch 21/50
1254/1254 - 58s - loss: 2.0039 - accuracy10: 0.6563 - val_loss: 2.2538 - val_accuracy10: 0.5701 - 58s/epoch - 46ms/step
Epoch 22/50
1254/1254 - 59s - loss: 1.9944 - accuracy10: 0.6582 - val_loss: 2.2501 - val_accuracy10: 0.5717 - 59s/epoch - 47ms/step
Epoch 23/50
1254/1254 - 59s - loss: 1.9858 - accuracy10: 0.6583 - val_loss: 2.2723 - val_accuracy10: 0.5751 - 59s/epoch - 47ms/step
Epoch 24/50
1254/1254 - 59s - loss: 1.9786 - accuracy10: 0.6582 - val_loss: 2.2759 - val_accuracy10: 0.5850 - 59s/epoch - 47ms/step
Epoch 25/50
1254/1254 - 59s - loss: 1.9687 - accuracy10: 0.6589 - val_loss: 2.2883 - val_accuracy10: 0.6125 - 59s/epoch - 47ms/step
Epoch 26/50
1254/1254 - 59s - loss: 1.9634 - accuracy10: 0.6585 - val_loss: 2.3476 - val_accuracy10: 0.5956 - 59s/epoch - 47ms/step
Epoch 27/50
1254/1254 - 60s - loss: 1.9533 - accuracy10: 0.6592 - val_loss: 2.3766 - val_accuracy10: 0.5862 - 60s/epoch - 48ms/step
Epoch 28/50
1254/1254 - 60s - loss: 1.9439 - accuracy10: 0.6595 - val_loss: 2.3428 - val_accuracy10: 0.5967 - 60s/epoch - 48ms/step
Epoch 29/50
1254/1254 - 60s - loss: 1.9406 - accuracy10: 0.6598 - val_loss: 2.4321 - val_accuracy10: 0.5812 - 60s/epoch - 48ms/step
testing model: results/EXC/W7/deepLOB_L2/h10
Evaluating performance on  test set...
5929/5929 - 130s - 130s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8877162
{'0': {'precision': 0.26216136596632217, 'recall': 0.6299173806436269, 'f1-score': 0.37023637561823103, 'support': 176593}, '1': {'precision': 0.9078603892076615, 'recall': 0.5584750172970034, 'f1-score': 0.6915434822304416, 'support': 1166387}, '2': {'precision': 0.3000966070435317, 'recall': 0.6458506354779401, 'f1-score': 0.4097851881193875, 'support': 174593}, 'accuracy': 0.5768407845948762, 'macro avg': {'precision': 0.4900394540725051, 'recall': 0.6114143444728568, 'f1-score': 0.49052168198935336, 'support': 1517573}, 'weighted avg': {'precision': 0.7628016476310523, 'recall': 0.5768407845948762, 'f1-score': 0.6217388588471175, 'support': 1517573}}
[[111239  26305  39049]
 [291050 651398 223939]
 [ 22026  39806 112761]]
Evaluating performance on  train set...
1254/1254 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8378377
{'0': {'precision': 0.2905495437293063, 'recall': 0.7112181863108475, 'f1-score': 0.41255894620665934, 'support': 40470}, '1': {'precision': 0.9032848927258279, 'recall': 0.5593684710945417, 'f1-score': 0.6908938261176367, 'support': 239799}, '2': {'precision': 0.3533362395444514, 'recall': 0.6372883854640163, 'f1-score': 0.45461636212260637, 'support': 40699}, 'accuracy': 0.588395104807956, 'macro avg': {'precision': 0.5157235586665285, 'recall': 0.6359583476231352, 'f1-score': 0.5193563781489674, 'support': 320968}, 'weighted avg': {'precision': 0.7562927944178407, 'recall': 0.588395104807956, 'f1-score': 0.6258391505825959, 'support': 320968}}
[[ 28783   4706   6981]
 [ 65175 134136  40488]
 [  5106   9656  25937]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8345592
{'0': {'precision': 0.26920806274774395, 'recall': 0.7393452748610253, 'f1-score': 0.39469942089318466, 'support': 12952}, '1': {'precision': 0.9152059198156123, 'recall': 0.5443624031939969, 'f1-score': 0.6826726588597238, 'support': 83156}, '2': {'precision': 0.35783117581372265, 'recall': 0.6603067999694726, 'f1-score': 0.46413819001126555, 'support': 13103}, 'accuracy': 0.5813974782759979, 'macro avg': {'precision': 0.5140817194590263, 'recall': 0.6480048260081649, 'f1-score': 0.513836756588058, 'support': 109211}, 'weighted avg': {'precision': 0.7717199567221529, 'recall': 0.5813974782759979, 'f1-score': 0.6223006585716213, 'support': 109211}}
[[ 9576  1371  2005]
 [24367 45267 13522]
 [ 1628  2823  8652]]
training model: results/EXC/W7/deepLOB_L2/h20
Epoch 1/50
1254/1254 - 61s - loss: 2.8379 - accuracy20: 0.4704 - val_loss: 2.7466 - val_accuracy20: 0.4768 - 61s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 60s - loss: 2.6423 - accuracy20: 0.5208 - val_loss: 2.7984 - val_accuracy20: 0.4331 - 60s/epoch - 48ms/step
Epoch 3/50
1254/1254 - 60s - loss: 2.5360 - accuracy20: 0.5631 - val_loss: 2.6873 - val_accuracy20: 0.4454 - 60s/epoch - 48ms/step
Epoch 4/50
1254/1254 - 60s - loss: 2.4447 - accuracy20: 0.5961 - val_loss: 2.6028 - val_accuracy20: 0.5348 - 60s/epoch - 48ms/step
Epoch 5/50
1254/1254 - 59s - loss: 2.3753 - accuracy20: 0.6168 - val_loss: 2.5506 - val_accuracy20: 0.5210 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 2.3380 - accuracy20: 0.6238 - val_loss: 2.5621 - val_accuracy20: 0.5327 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 59s - loss: 2.3132 - accuracy20: 0.6264 - val_loss: 2.5965 - val_accuracy20: 0.5185 - 59s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 59s - loss: 2.2908 - accuracy20: 0.6299 - val_loss: 2.5665 - val_accuracy20: 0.5343 - 59s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 61s - loss: 2.2702 - accuracy20: 0.6316 - val_loss: 2.5944 - val_accuracy20: 0.5403 - 61s/epoch - 49ms/step
Epoch 10/50
1254/1254 - 59s - loss: 2.2543 - accuracy20: 0.6323 - val_loss: 2.5306 - val_accuracy20: 0.5560 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 60s - loss: 2.2358 - accuracy20: 0.6333 - val_loss: 2.5223 - val_accuracy20: 0.5576 - 60s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 60s - loss: 2.2227 - accuracy20: 0.6344 - val_loss: 2.4795 - val_accuracy20: 0.5721 - 60s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 60s - loss: 2.2121 - accuracy20: 0.6355 - val_loss: 2.4700 - val_accuracy20: 0.5830 - 60s/epoch - 48ms/step
Epoch 14/50
1254/1254 - 59s - loss: 2.2024 - accuracy20: 0.6359 - val_loss: 2.4757 - val_accuracy20: 0.5898 - 59s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 60s - loss: 2.1926 - accuracy20: 0.6373 - val_loss: 2.4725 - val_accuracy20: 0.5886 - 60s/epoch - 48ms/step
Epoch 16/50
1254/1254 - 60s - loss: 2.1838 - accuracy20: 0.6390 - val_loss: 2.4525 - val_accuracy20: 0.5728 - 60s/epoch - 48ms/step
Epoch 17/50
1254/1254 - 59s - loss: 2.1727 - accuracy20: 0.6387 - val_loss: 2.4626 - val_accuracy20: 0.5821 - 59s/epoch - 47ms/step
Epoch 18/50
1254/1254 - 59s - loss: 2.1657 - accuracy20: 0.6392 - val_loss: 2.4655 - val_accuracy20: 0.5922 - 59s/epoch - 47ms/step
Epoch 19/50
1254/1254 - 59s - loss: 2.1572 - accuracy20: 0.6394 - val_loss: 2.4724 - val_accuracy20: 0.5808 - 59s/epoch - 47ms/step
Epoch 20/50
1254/1254 - 59s - loss: 2.1504 - accuracy20: 0.6398 - val_loss: 2.4854 - val_accuracy20: 0.5896 - 59s/epoch - 47ms/step
Epoch 21/50
1254/1254 - 60s - loss: 2.1421 - accuracy20: 0.6398 - val_loss: 2.4641 - val_accuracy20: 0.6058 - 60s/epoch - 47ms/step
Epoch 22/50
1254/1254 - 59s - loss: 2.1374 - accuracy20: 0.6402 - val_loss: 2.4640 - val_accuracy20: 0.5904 - 59s/epoch - 47ms/step
Epoch 23/50
1254/1254 - 59s - loss: 2.1290 - accuracy20: 0.6412 - val_loss: 2.5061 - val_accuracy20: 0.5803 - 59s/epoch - 47ms/step
Epoch 24/50
1254/1254 - 59s - loss: 2.1225 - accuracy20: 0.6413 - val_loss: 2.4998 - val_accuracy20: 0.5796 - 59s/epoch - 47ms/step
Epoch 25/50
1254/1254 - 59s - loss: 2.1160 - accuracy20: 0.6438 - val_loss: 2.4978 - val_accuracy20: 0.5921 - 59s/epoch - 47ms/step
Epoch 26/50
1254/1254 - 59s - loss: 2.1092 - accuracy20: 0.6427 - val_loss: 2.5286 - val_accuracy20: 0.6008 - 59s/epoch - 47ms/step
testing model: results/EXC/W7/deepLOB_L2/h20
Evaluating performance on  test set...
5929/5929 - 113s - 113s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8531092
{'0': {'precision': 0.3356924088929529, 'recall': 0.6162948053616547, 'f1-score': 0.4346392151118454, 'support': 233510}, '1': {'precision': 0.8297301233899997, 'recall': 0.6068361516900154, 'f1-score': 0.7009913064974661, 'support': 1051381}, '2': {'precision': 0.3999031038039571, 'recall': 0.5498534480535666, 'f1-score': 0.4630409763088749, 'support': 232682}, 'accuracy': 0.5995546836956114, 'macro avg': {'precision': 0.5217752120289699, 'recall': 0.5909948017017456, 'f1-score': 0.5328904993060621, 'support': 1517573}, 'weighted avg': {'precision': 0.6878089391810525, 'recall': 0.5995546836956114, 'f1-score': 0.6235237740700982, 'support': 1517573}}
[[143911  52966  36633]
 [258009 638016 155356]
 [ 26779  77962 127941]]
Evaluating performance on  train set...
1254/1254 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94058347
{'0': {'precision': 0.33844699065458167, 'recall': 0.618308124896624, 'f1-score': 0.4374463658822, 'support': 54413}, '1': {'precision': 0.8070123814481994, 'recall': 0.5049904628807765, 'f1-score': 0.6212388301131727, 'support': 211804}, '2': {'precision': 0.3825709920920201, 'recall': 0.6220525652499498, 'f1-score': 0.47376804034081027, 'support': 54751}, 'accuracy': 0.5441695122255178, 'macro avg': {'precision': 0.5093434547316004, 'recall': 0.5817837176757835, 'f1-score': 0.5108177454453943, 'support': 320968}, 'weighted avg': {'precision': 0.655175939441852, 'recall': 0.5441695122255178, 'f1-score': 0.5649252020660573, 'support': 320968}}
[[ 33644  11119   9650]
 [ 59529 106959  45316]
 [  6234  14459  34058]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8683505
{'0': {'precision': 0.33242356493713887, 'recall': 0.6497729852440408, 'f1-score': 0.4398301991894124, 'support': 17620}, '1': {'precision': 0.825578298194931, 'recall': 0.545752519232853, 'f1-score': 0.6571155994422654, 'support': 73832}, '2': {'precision': 0.41898085737395524, 'recall': 0.612534489554592, 'f1-score': 0.49759846301633054, 'support': 17759}, 'accuracy': 0.5733946214209191, 'macro avg': {'precision': 0.5256609068353417, 'recall': 0.6026866646771619, 'f1-score': 0.5315147538826694, 'support': 109211}, 'weighted avg': {'precision': 0.6798956256478249, 'recall': 0.5733946214209191, 'f1-score': 0.5961196047325434, 'support': 109211}}
[[11449  3442  2729]
 [21182 40294 12356]
 [ 1810  5071 10878]]
training model: results/EXC/W7/deepLOB_L2/h30
Epoch 1/50
1254/1254 - 62s - loss: 2.9211 - accuracy30: 0.4769 - val_loss: 2.9163 - val_accuracy30: 0.5020 - 62s/epoch - 50ms/step
Epoch 2/50
1254/1254 - 59s - loss: 2.7486 - accuracy30: 0.5162 - val_loss: 2.8246 - val_accuracy30: 0.4739 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 59s - loss: 2.6635 - accuracy30: 0.5474 - val_loss: 2.7784 - val_accuracy30: 0.4804 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 2.5942 - accuracy30: 0.5719 - val_loss: 2.7341 - val_accuracy30: 0.4906 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 59s - loss: 2.5304 - accuracy30: 0.5867 - val_loss: 2.7638 - val_accuracy30: 0.4510 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 2.4814 - accuracy30: 0.5961 - val_loss: 2.7204 - val_accuracy30: 0.4720 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 59s - loss: 2.4508 - accuracy30: 0.6020 - val_loss: 2.7159 - val_accuracy30: 0.4834 - 59s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 59s - loss: 2.4265 - accuracy30: 0.6062 - val_loss: 2.7066 - val_accuracy30: 0.4906 - 59s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 59s - loss: 2.4057 - accuracy30: 0.6100 - val_loss: 2.7167 - val_accuracy30: 0.4893 - 59s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 59s - loss: 2.3896 - accuracy30: 0.6122 - val_loss: 2.8093 - val_accuracy30: 0.4694 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 59s - loss: 2.3733 - accuracy30: 0.6136 - val_loss: 2.7366 - val_accuracy30: 0.4883 - 59s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 59s - loss: 2.3612 - accuracy30: 0.6150 - val_loss: 2.6807 - val_accuracy30: 0.5052 - 59s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 59s - loss: 2.3497 - accuracy30: 0.6170 - val_loss: 2.6882 - val_accuracy30: 0.5024 - 59s/epoch - 47ms/step
Epoch 14/50
1254/1254 - 59s - loss: 2.3396 - accuracy30: 0.6175 - val_loss: 2.7063 - val_accuracy30: 0.4936 - 59s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 59s - loss: 2.3300 - accuracy30: 0.6182 - val_loss: 2.6672 - val_accuracy30: 0.5069 - 59s/epoch - 47ms/step
Epoch 16/50
1254/1254 - 59s - loss: 2.3198 - accuracy30: 0.6202 - val_loss: 2.7384 - val_accuracy30: 0.4896 - 59s/epoch - 47ms/step
Epoch 17/50
1254/1254 - 59s - loss: 2.3113 - accuracy30: 0.6207 - val_loss: 2.7113 - val_accuracy30: 0.5046 - 59s/epoch - 47ms/step
Epoch 18/50
1254/1254 - 59s - loss: 2.3022 - accuracy30: 0.6216 - val_loss: 2.7001 - val_accuracy30: 0.5113 - 59s/epoch - 47ms/step
Epoch 19/50
1254/1254 - 59s - loss: 2.2928 - accuracy30: 0.6236 - val_loss: 2.6745 - val_accuracy30: 0.5244 - 59s/epoch - 47ms/step
Epoch 20/50
1254/1254 - 59s - loss: 2.2853 - accuracy30: 0.6232 - val_loss: 2.7746 - val_accuracy30: 0.4888 - 59s/epoch - 47ms/step
Epoch 21/50
1254/1254 - 59s - loss: 2.2769 - accuracy30: 0.6250 - val_loss: 2.7717 - val_accuracy30: 0.5073 - 59s/epoch - 47ms/step
Epoch 22/50
1254/1254 - 59s - loss: 2.2688 - accuracy30: 0.6258 - val_loss: 2.7599 - val_accuracy30: 0.4984 - 59s/epoch - 47ms/step
Epoch 23/50
1254/1254 - 59s - loss: 2.2612 - accuracy30: 0.6264 - val_loss: 2.7241 - val_accuracy30: 0.5277 - 59s/epoch - 47ms/step
Epoch 24/50
1254/1254 - 59s - loss: 2.2544 - accuracy30: 0.6278 - val_loss: 2.7600 - val_accuracy30: 0.5179 - 59s/epoch - 47ms/step
Epoch 25/50
1254/1254 - 59s - loss: 2.2458 - accuracy30: 0.6284 - val_loss: 2.7414 - val_accuracy30: 0.5217 - 59s/epoch - 47ms/step
testing model: results/EXC/W7/deepLOB_L2/h30
Evaluating performance on  test set...
5929/5929 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89753294
{'0': {'precision': 0.37322067680160215, 'recall': 0.5641189974436406, 'f1-score': 0.44923068938074534, 'support': 276174}, '1': {'precision': 0.7865463369186593, 'recall': 0.5847254555754495, 'f1-score': 0.6707841110761271, 'support': 967348}, '2': {'precision': 0.4065862825587133, 'recall': 0.5652633998781249, 'f1-score': 0.47297097190312265, 'support': 274051}, 'accuracy': 0.5774608536129728, 'macro avg': {'precision': 0.5221177654263248, 'recall': 0.5713692842990717, 'f1-score': 0.5309952574533318, 'support': 1517573}, 'weighted avg': {'precision': 0.6427125749088148, 'recall': 0.5774608536129728, 'f1-score': 0.594742837749044, 'support': 1517573}}
[[155795  61643  58736]
 [234358 565633 167357]
 [ 27281  91859 154911]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0130589
{'0': {'precision': 0.3754430148365542, 'recall': 0.5674837679780196, 'f1-score': 0.45190744520907944, 'support': 65149}, '1': {'precision': 0.799755884571111, 'recall': 0.4237922711664765, 'f1-score': 0.5540122979415212, 'support': 190171}, '2': {'precision': 0.3845205918355611, 'recall': 0.7129691689008043, 'f1-score': 0.4995970561079356, 'support': 65648}, 'accuracy': 0.5121040103686348, 'macro avg': {'precision': 0.5199064970810755, 'recall': 0.5680817360151001, 'f1-score': 0.5018389330861788, 'support': 320968}, 'weighted avg': {'precision': 0.6287016808877531, 'recall': 0.5121040103686348, 'f1-score': 0.5221577802121616, 'support': 320968}}
[[36971  8363 19815]
 [54475 80593 55103]
 [ 7027 11816 46805]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0068105
{'0': {'precision': 0.3523397151651103, 'recall': 0.6313329594316694, 'f1-score': 0.45227173803863796, 'support': 21396}, '1': {'precision': 0.7892522691254863, 'recall': 0.4131559497413156, 'f1-score': 0.5423852993010039, 'support': 66297}, '2': {'precision': 0.40541362530413627, 'recall': 0.6814295008829817, 'f1-score': 0.5083729154387545, 'support': 21518}, 'accuracy': 0.5087582752653121, 'macro avg': {'precision': 0.5156685365315776, 'recall': 0.5753061366853222, 'f1-score': 0.5010099842594654, 'support': 109211}, 'weighted avg': {'precision': 0.6280265597895768, 'recall': 0.5087582752653121, 'f1-score': 0.5180292524493363, 'support': 109211}}
[[13508  2946  4942]
 [22343 27391 16563]
 [ 2487  4368 14663]]
training model: results/EXC/W7/deepLOB_L2/h50
Epoch 1/50
1254/1254 - 62s - loss: 3.0465 - accuracy50: 0.4599 - val_loss: 3.1138 - val_accuracy50: 0.4582 - 62s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 59s - loss: 2.8808 - accuracy50: 0.5018 - val_loss: 3.0181 - val_accuracy50: 0.4788 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 59s - loss: 2.8286 - accuracy50: 0.5225 - val_loss: 2.9829 - val_accuracy50: 0.4591 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 2.7854 - accuracy50: 0.5362 - val_loss: 2.9775 - val_accuracy50: 0.4402 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 59s - loss: 2.7480 - accuracy50: 0.5471 - val_loss: 2.9256 - val_accuracy50: 0.4647 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 2.7090 - accuracy50: 0.5569 - val_loss: 2.8711 - val_accuracy50: 0.4946 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 59s - loss: 2.6796 - accuracy50: 0.5629 - val_loss: 2.8990 - val_accuracy50: 0.4889 - 59s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 59s - loss: 2.6558 - accuracy50: 0.5694 - val_loss: 2.8988 - val_accuracy50: 0.5045 - 59s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 59s - loss: 2.6382 - accuracy50: 0.5724 - val_loss: 2.8853 - val_accuracy50: 0.5032 - 59s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 59s - loss: 2.6220 - accuracy50: 0.5759 - val_loss: 2.8226 - val_accuracy50: 0.5273 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 59s - loss: 2.6113 - accuracy50: 0.5782 - val_loss: 2.8312 - val_accuracy50: 0.5284 - 59s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 58s - loss: 2.5984 - accuracy50: 0.5805 - val_loss: 2.8280 - val_accuracy50: 0.5286 - 58s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 59s - loss: 2.5866 - accuracy50: 0.5824 - val_loss: 2.8063 - val_accuracy50: 0.5294 - 59s/epoch - 47ms/step
Epoch 14/50
1254/1254 - 59s - loss: 2.5785 - accuracy50: 0.5832 - val_loss: 2.8099 - val_accuracy50: 0.5227 - 59s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 58s - loss: 2.5668 - accuracy50: 0.5849 - val_loss: 2.8067 - val_accuracy50: 0.5225 - 58s/epoch - 47ms/step
Epoch 16/50
1254/1254 - 59s - loss: 2.5572 - accuracy50: 0.5871 - val_loss: 2.8223 - val_accuracy50: 0.5192 - 59s/epoch - 47ms/step
Epoch 17/50
1254/1254 - 59s - loss: 2.5486 - accuracy50: 0.5879 - val_loss: 2.8241 - val_accuracy50: 0.5185 - 59s/epoch - 47ms/step
Epoch 18/50
1254/1254 - 59s - loss: 2.5414 - accuracy50: 0.5894 - val_loss: 2.8404 - val_accuracy50: 0.5251 - 59s/epoch - 47ms/step
Epoch 19/50
1254/1254 - 59s - loss: 2.5317 - accuracy50: 0.5911 - val_loss: 2.8451 - val_accuracy50: 0.5205 - 59s/epoch - 47ms/step
Epoch 20/50
1254/1254 - 58s - loss: 2.5243 - accuracy50: 0.5922 - val_loss: 2.8462 - val_accuracy50: 0.5175 - 58s/epoch - 47ms/step
Epoch 21/50
1254/1254 - 59s - loss: 2.5163 - accuracy50: 0.5933 - val_loss: 2.8439 - val_accuracy50: 0.5205 - 59s/epoch - 47ms/step
Epoch 22/50
1254/1254 - 59s - loss: 2.5091 - accuracy50: 0.5946 - val_loss: 2.8690 - val_accuracy50: 0.5143 - 59s/epoch - 47ms/step
Epoch 23/50
1254/1254 - 59s - loss: 2.5003 - accuracy50: 0.5956 - val_loss: 2.8976 - val_accuracy50: 0.5042 - 59s/epoch - 47ms/step
testing model: results/EXC/W7/deepLOB_L2/h50
Evaluating performance on  test set...
5929/5929 - 109s - 109s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1270537
{'0': {'precision': 0.4103210130703308, 'recall': 0.39612443633023176, 'f1-score': 0.40309776721475804, 'support': 346169}, '1': {'precision': 0.643574704425273, 'recall': 0.41013522936573965, 'f1-score': 0.5009968124032101, 'support': 831772}, '2': {'precision': 0.34644090419278994, 'recall': 0.6664095256041833, 'f1-score': 0.4558847226026845, 'support': 339632}, 'accuracy': 0.4642933157087007, 'macro avg': {'precision': 0.4667788738961313, 'recall': 0.49088973043338485, 'f1-score': 0.45332643407355094, 'support': 1517573}, 'weighted avg': {'precision': 0.5238695278550469, 'recall': 0.4642933157087007, 'f1-score': 0.4685692956663063, 'support': 1517573}}
[[137126 104900 104143]
 [167798 341139 322835]
 [ 29268  84030 226334]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9426804
{'0': {'precision': 0.4439159227207908, 'recall': 0.5550955102838439, 'f1-score': 0.4933191503218313, 'support': 81876}, '1': {'precision': 0.6304609155040967, 'recall': 0.5111111111111111, 'f1-score': 0.56454708335989, 'support': 155970}, '2': {'precision': 0.49106813396713767, 'recall': 0.5443564880537042, 'f1-score': 0.5163410626255249, 'support': 83122}, 'accuracy': 0.5309407791430921, 'macro avg': {'precision': 0.521814990730675, 'recall': 0.5368543698162197, 'f1-score': 0.5247357654357487, 'support': 320968}, 'weighted avg': {'precision': 0.5467760478037619, 'recall': 0.5309407791430921, 'f1-score': 0.533893438445425, 'support': 320968}}
[[45449 22547 13880]
 [43238 79718 33014]
 [13695 24179 45248]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9375435
{'0': {'precision': 0.42432093378422603, 'recall': 0.5695095168374817, 'f1-score': 0.4863099331124586, 'support': 27320}, '1': {'precision': 0.6233331069301999, 'recall': 0.5072872330624805, 'f1-score': 0.5593547469575995, 'support': 54273}, '2': {'precision': 0.5138507083950096, 'recall': 0.5279165761459917, 'f1-score': 0.5207886840977283, 'support': 27618}, 'accuracy': 0.528069516806915, 'macro avg': {'precision': 0.5205015830364785, 'recall': 0.5349044420153181, 'f1-score': 0.5221511213892621, 'support': 109211}, 'weighted avg': {'precision': 0.5458619963910336, 'recall': 0.5280695168069152, 'f1-score': 0.5313291649346057, 'support': 109211}}
[[15559  7630  4131]
 [17078 27532  9663]
 [ 4031  9007 14580]]
training model: results/EXC/W7/deepLOB_L2/h100
Epoch 1/50
1254/1254 - 62s - loss: 3.1722 - accuracy100: 0.4376 - val_loss: 3.2114 - val_accuracy100: 0.4181 - 62s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 60s - loss: 3.0900 - accuracy100: 0.4649 - val_loss: 3.2305 - val_accuracy100: 0.4057 - 60s/epoch - 48ms/step
Epoch 3/50
1254/1254 - 59s - loss: 3.0615 - accuracy100: 0.4709 - val_loss: 3.2188 - val_accuracy100: 0.4136 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 3.0457 - accuracy100: 0.4756 - val_loss: 3.1995 - val_accuracy100: 0.4162 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 59s - loss: 3.0297 - accuracy100: 0.4807 - val_loss: 3.1965 - val_accuracy100: 0.4196 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 3.0150 - accuracy100: 0.4847 - val_loss: 3.1948 - val_accuracy100: 0.4226 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 59s - loss: 3.0008 - accuracy100: 0.4895 - val_loss: 3.2255 - val_accuracy100: 0.4249 - 59s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 60s - loss: 2.9865 - accuracy100: 0.4929 - val_loss: 3.2074 - val_accuracy100: 0.4280 - 60s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 59s - loss: 2.9734 - accuracy100: 0.4964 - val_loss: 3.2623 - val_accuracy100: 0.4230 - 59s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 59s - loss: 2.9613 - accuracy100: 0.5003 - val_loss: 3.2255 - val_accuracy100: 0.4254 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 59s - loss: 2.9476 - accuracy100: 0.5038 - val_loss: 3.2675 - val_accuracy100: 0.4188 - 59s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 58s - loss: 2.9352 - accuracy100: 0.5079 - val_loss: 3.2510 - val_accuracy100: 0.4231 - 58s/epoch - 46ms/step
Epoch 13/50
1254/1254 - 58s - loss: 2.9241 - accuracy100: 0.5112 - val_loss: 3.3202 - val_accuracy100: 0.4182 - 58s/epoch - 46ms/step
Epoch 14/50
1254/1254 - 58s - loss: 2.9099 - accuracy100: 0.5134 - val_loss: 3.3170 - val_accuracy100: 0.4213 - 58s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 58s - loss: 2.8996 - accuracy100: 0.5164 - val_loss: 3.3088 - val_accuracy100: 0.4235 - 58s/epoch - 46ms/step
Epoch 16/50
1254/1254 - 58s - loss: 2.8846 - accuracy100: 0.5200 - val_loss: 3.3555 - val_accuracy100: 0.4177 - 58s/epoch - 46ms/step
testing model: results/EXC/W7/deepLOB_L2/h100
Evaluating performance on  test set...
5929/5929 - 114s - 114s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0442896
{'0': {'precision': 0.4177423082407667, 'recall': 0.5500592436240264, 'f1-score': 0.4748556512601519, 'support': 463341}, '1': {'precision': 0.4421791983037837, 'recall': 0.41004463368322414, 'f1-score': 0.425506071493154, 'support': 608285}, '2': {'precision': 0.4607927360196626, 'recall': 0.3548246764750071, 'f1-score': 0.4009248232700737, 'support': 445947}, 'accuracy': 0.436566807659335, 'macro avg': {'precision': 0.4402380808547377, 'recall': 0.43830951792741923, 'f1-score': 0.4337621820077932, 'support': 1517573}, 'weighted avg': {'precision': 0.4401878860078313, 'recall': 0.436566807659335, 'f1-score': 0.4333500102937801, 'support': 1517573}}
[[254865 149782  58694]
 [232395 249424 126466]
 [122841 164873 158233]]
Evaluating performance on  train set...
1254/1254 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0604783
{'0': {'precision': 0.4368322455368981, 'recall': 0.4855246769792449, 'f1-score': 0.45989319260453343, 'support': 105179}, '1': {'precision': 0.3851942653959182, 'recall': 0.44141068338697975, 'f1-score': 0.411390868577572, 'support': 107494}, '2': {'precision': 0.479383801293226, 'recall': 0.35804053742093356, 'f1-score': 0.4099208153167916, 'support': 108295}, 'accuracy': 0.42773734453278833, 'macro avg': {'precision': 0.43380343740868077, 'recall': 0.42832529926238605, 'f1-score': 0.427068292166299, 'support': 320968}, 'weighted avg': {'precision': 0.43389534121421497, 'recall': 0.42773734453278833, 'f1-score': 0.42678874787069637, 'support': 320968}}
[[51067 35012 19100]
 [37036 47449 23009]
 [28800 40721 38774]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0660117
{'0': {'precision': 0.41713793951315464, 'recall': 0.5729967069154775, 'f1-score': 0.48280032727402084, 'support': 35529}, '1': {'precision': 0.38093202223172296, 'recall': 0.35588752196836554, 'f1-score': 0.3679841407508364, 'support': 37554}, '2': {'precision': 0.49557696864386697, 'recall': 0.34734831709477415, 'f1-score': 0.40842961757526447, 'support': 36128}, 'accuracy': 0.42369358397963575, 'macro avg': {'precision': 0.43121564346291485, 'recall': 0.4254108486595391, 'f1-score': 0.4197380285333739, 'support': 109211}, 'weighted avg': {'precision': 0.4306362888263876, 'recall': 0.42369358397963575, 'f1-score': 0.4187163790573729, 'support': 109211}}
[[20358  9769  5402]
 [16818 13365  7371]
 [11628 11951 12549]]
training model: results/EXC/W7/deepLOB_L2/h200
Epoch 1/50
1254/1254 - 61s - loss: 3.2687 - accuracy200: 0.3886 - val_loss: 3.3424 - val_accuracy200: 0.3594 - 61s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 59s - loss: 3.2191 - accuracy200: 0.4119 - val_loss: 3.3336 - val_accuracy200: 0.3602 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 58s - loss: 3.1977 - accuracy200: 0.4190 - val_loss: 3.3685 - val_accuracy200: 0.3525 - 58s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 3.1798 - accuracy200: 0.4267 - val_loss: 3.3903 - val_accuracy200: 0.3541 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 59s - loss: 3.1680 - accuracy200: 0.4326 - val_loss: 3.3420 - val_accuracy200: 0.3597 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 3.1595 - accuracy200: 0.4357 - val_loss: 3.3319 - val_accuracy200: 0.3616 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 59s - loss: 3.1503 - accuracy200: 0.4400 - val_loss: 3.3284 - val_accuracy200: 0.3682 - 59s/epoch - 47ms/step
Epoch 8/50
1254/1254 - 58s - loss: 3.1377 - accuracy200: 0.4455 - val_loss: 3.3828 - val_accuracy200: 0.3633 - 58s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 59s - loss: 3.1298 - accuracy200: 0.4497 - val_loss: 3.4106 - val_accuracy200: 0.3663 - 59s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 59s - loss: 3.1190 - accuracy200: 0.4523 - val_loss: 3.4157 - val_accuracy200: 0.3645 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 58s - loss: 3.1052 - accuracy200: 0.4580 - val_loss: 3.5427 - val_accuracy200: 0.3557 - 58s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 58s - loss: 3.0964 - accuracy200: 0.4622 - val_loss: 3.5548 - val_accuracy200: 0.3560 - 58s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 58s - loss: 3.0838 - accuracy200: 0.4661 - val_loss: 3.3890 - val_accuracy200: 0.3719 - 58s/epoch - 46ms/step
Epoch 14/50
1254/1254 - 59s - loss: 3.0788 - accuracy200: 0.4673 - val_loss: 3.4100 - val_accuracy200: 0.3674 - 59s/epoch - 47ms/step
Epoch 15/50
1254/1254 - 59s - loss: 3.0655 - accuracy200: 0.4717 - val_loss: 3.4144 - val_accuracy200: 0.3672 - 59s/epoch - 47ms/step
Epoch 16/50
1254/1254 - 58s - loss: 3.0538 - accuracy200: 0.4750 - val_loss: 3.4200 - val_accuracy200: 0.3686 - 58s/epoch - 46ms/step
Epoch 17/50
1254/1254 - 58s - loss: 3.0461 - accuracy200: 0.4788 - val_loss: 3.4623 - val_accuracy200: 0.3644 - 58s/epoch - 46ms/step
testing model: results/EXC/W7/deepLOB_L2/h200
Evaluating performance on  test set...
5929/5929 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192626
{'0': {'precision': 0.37227391991985115, 'recall': 0.35857282936053975, 'f1-score': 0.3652949483437801, 'support': 513996}, '1': {'precision': 0.34439966770037306, 'recall': 0.12756437944597554, 'f1-score': 0.18617151097517945, 'support': 523226}, '2': {'precision': 0.35610171679982816, 'recall': 0.6143403469546228, 'f1-score': 0.45086185032741455, 'support': 480351}, 'accuracy': 0.3598831818963569, 'macro avg': {'precision': 0.3575917681400174, 'recall': 0.36682585192037936, 'f1-score': 0.3341094365487914, 'support': 1517573}, 'weighted avg': {'precision': 0.3575445675706101, 'recall': 0.3598831818963569, 'f1-score': 0.33062123399469595, 'support': 1517573}}
[[184305  69919 259772]
 [182659  66745 273822]
 [128115  57137 295099]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1627842
{'0': {'precision': 0.34966857752807917, 'recall': 0.6950875265231888, 'f1-score': 0.46527656687411423, 'support': 105568}, '1': {'precision': 0.329475892799204, 'recall': 0.1438256567144449, 'f1-score': 0.20024057264176365, 'support': 105906}, '2': {'precision': 0.42363294494790704, 'recall': 0.25103658647962446, 'f1-score': 0.3152576586496003, 'support': 109494}, 'accuracy': 0.3617120709852696, 'macro avg': {'precision': 0.3675924717583967, 'recall': 0.3633165899057527, 'f1-score': 0.32692493272182604, 'support': 320968}, 'weighted avg': {'precision': 0.3682378055426176, 'recall': 0.3617120709852696, 'f1-score': 0.3266488147545688, 'support': 320968}}
[[73379 14421 17768]
 [71045 15232 19629]
 [65429 16578 27487]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1104105
{'0': {'precision': 0.3582704621822101, 'recall': 0.6346585804132974, 'f1-score': 0.4579973254447461, 'support': 35616}, '1': {'precision': 0.3408682013193708, 'recall': 0.1988267900869144, 'f1-score': 0.251155676410605, 'support': 37163}, '2': {'precision': 0.4219376483102856, 'recall': 0.2830753184014054, 'f1-score': 0.33883102802510107, 'support': 36432}, 'accuracy': 0.36906538718627246, 'macro avg': {'precision': 0.37369210393728886, 'recall': 0.372186896300539, 'f1-score': 0.34932800996015073, 'support': 109211}, 'weighted avg': {'precision': 0.37358762533035766, 'recall': 0.36906538718627246, 'f1-score': 0.34785894423178865, 'support': 109211}}
[[22604  6790  6222]
 [21867  7389  7907]
 [18621  7498 10313]]
training model: results/EXC/W7/deepLOB_L2/h300
Epoch 1/50
1254/1254 - 61s - loss: 3.2827 - accuracy300: 0.3813 - val_loss: 3.4255 - val_accuracy300: 0.3320 - 61s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 58s - loss: 3.2426 - accuracy300: 0.3975 - val_loss: 3.4297 - val_accuracy300: 0.3324 - 58s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 58s - loss: 3.2254 - accuracy300: 0.4084 - val_loss: 3.3605 - val_accuracy300: 0.3407 - 58s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 58s - loss: 3.2136 - accuracy300: 0.4150 - val_loss: 3.3400 - val_accuracy300: 0.3481 - 58s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 58s - loss: 3.2007 - accuracy300: 0.4215 - val_loss: 3.3391 - val_accuracy300: 0.3514 - 58s/epoch - 46ms/step
Epoch 6/50
1254/1254 - 58s - loss: 3.1904 - accuracy300: 0.4268 - val_loss: 3.3622 - val_accuracy300: 0.3521 - 58s/epoch - 46ms/step
Epoch 7/50
1254/1254 - 58s - loss: 3.1784 - accuracy300: 0.4313 - val_loss: 3.3932 - val_accuracy300: 0.3483 - 58s/epoch - 46ms/step
Epoch 8/50
1254/1254 - 58s - loss: 3.1710 - accuracy300: 0.4348 - val_loss: 3.4143 - val_accuracy300: 0.3504 - 58s/epoch - 46ms/step
Epoch 9/50
1254/1254 - 58s - loss: 3.1591 - accuracy300: 0.4389 - val_loss: 3.3881 - val_accuracy300: 0.3454 - 58s/epoch - 46ms/step
Epoch 10/50
1254/1254 - 58s - loss: 3.1481 - accuracy300: 0.4430 - val_loss: 3.3979 - val_accuracy300: 0.3492 - 58s/epoch - 46ms/step
Epoch 11/50
1254/1254 - 58s - loss: 3.1400 - accuracy300: 0.4464 - val_loss: 3.3883 - val_accuracy300: 0.3496 - 58s/epoch - 46ms/step
Epoch 12/50
1254/1254 - 60s - loss: 3.1353 - accuracy300: 0.4485 - val_loss: 3.3756 - val_accuracy300: 0.3463 - 60s/epoch - 48ms/step
Epoch 13/50
1254/1254 - 59s - loss: 3.1226 - accuracy300: 0.4535 - val_loss: 3.3617 - val_accuracy300: 0.3511 - 59s/epoch - 47ms/step
Epoch 14/50
1254/1254 - 58s - loss: 3.1108 - accuracy300: 0.4577 - val_loss: 3.3958 - val_accuracy300: 0.3497 - 58s/epoch - 46ms/step
Epoch 15/50
1254/1254 - 58s - loss: 3.1041 - accuracy300: 0.4602 - val_loss: 3.3709 - val_accuracy300: 0.3525 - 58s/epoch - 46ms/step
testing model: results/EXC/W7/deepLOB_L2/h300
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1497923
{'0': {'precision': 0.3434127720735635, 'recall': 0.23507152800874706, 'f1-score': 0.27909682270570124, 'support': 502111}, '1': {'precision': 0.37091983525709266, 'recall': 0.21715548303512536, 'f1-score': 0.2739352375014612, 'support': 550343}, '2': {'precision': 0.3200296828235316, 'recall': 0.5860005718966544, 'f1-score': 0.41397641233605964, 'support': 465119}, 'accuracy': 0.33613012355913024, 'macro avg': {'precision': 0.34478743005139595, 'recall': 0.3460758609801757, 'f1-score': 0.32233615751440736, 'support': 1517573}, 'weighted avg': {'precision': 0.3462214676583738, 'recall': 0.33613012355913024, 'f1-score': 0.3185640625440653, 'support': 1517573}}
[[118032  99385 284694]
 [136416 119510 294417]
 [ 89255 103304 272560]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1188543
{'0': {'precision': 0.34258684018354424, 'recall': 0.5957261312485193, 'f1-score': 0.4350103624971023, 'support': 105525}, '1': {'precision': 0.3361796785304248, 'recall': 0.2215339512010592, 'f1-score': 0.26707330977083577, 'support': 105740}, '2': {'precision': 0.3729016079067709, 'recall': 0.2304312552983966, 'f1-score': 0.28484503614227036, 'support': 109703}, 'accuracy': 0.3475985144936567, 'macro avg': {'precision': 0.35055604220691333, 'recall': 0.34923044591599167, 'f1-score': 0.3289762361367361, 'support': 320968}, 'weighted avg': {'precision': 0.3508372816304806, 'recall': 0.3475985144936567, 'f1-score': 0.3283603202736422, 'support': 320968}}
[[62864 21276 21385]
 [61189 23425 21126]
 [59445 24979 25279]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151942
{'0': {'precision': 0.3431290085164546, 'recall': 0.5543570579242398, 'f1-score': 0.4238862189894791, 'support': 35322}, '1': {'precision': 0.3454601882823546, 'recall': 0.2658352129494494, 'f1-score': 0.30046187991122314, 'support': 37685}, '2': {'precision': 0.37462196491834443, 'recall': 0.2395039222185394, 'f1-score': 0.2921988205560236, 'support': 36204}, 'accuracy': 0.35042257648039116, 'macro avg': {'precision': 0.3544037205723845, 'recall': 0.3532320643640762, 'f1-score': 0.33884897315224194, 'support': 109211}, 'weighted avg': {'precision': 0.3543734939900054, 'recall': 0.35042257648039116, 'f1-score': 0.3376416393129914, 'support': 109211}}
[[19581  8491  7250]
 [20442 10018  7225]
 [17043 10490  8671]]
training model: results/EXC/W7/deepLOB_L2/h500
Epoch 1/50
1254/1254 - 62s - loss: 3.2645 - accuracy500: 0.3952 - val_loss: 3.4874 - val_accuracy500: 0.3498 - 62s/epoch - 49ms/step
Epoch 2/50
1254/1254 - 59s - loss: 3.2324 - accuracy500: 0.4119 - val_loss: 3.3960 - val_accuracy500: 0.3278 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 59s - loss: 3.2210 - accuracy500: 0.4192 - val_loss: 3.3925 - val_accuracy500: 0.3510 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 65s - loss: 3.1983 - accuracy500: 0.4310 - val_loss: 3.4747 - val_accuracy500: 0.3280 - 65s/epoch - 52ms/step
Epoch 5/50
1254/1254 - 59s - loss: 3.1907 - accuracy500: 0.4358 - val_loss: 3.4289 - val_accuracy500: 0.3334 - 59s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 58s - loss: 3.1823 - accuracy500: 0.4367 - val_loss: 3.4394 - val_accuracy500: 0.3336 - 58s/epoch - 46ms/step
Epoch 7/50
1254/1254 - 58s - loss: 3.1646 - accuracy500: 0.4447 - val_loss: 3.5352 - val_accuracy500: 0.3229 - 58s/epoch - 46ms/step
Epoch 8/50
1254/1254 - 58s - loss: 3.1579 - accuracy500: 0.4474 - val_loss: 3.5420 - val_accuracy500: 0.3099 - 58s/epoch - 46ms/step
Epoch 9/50
1254/1254 - 58s - loss: 3.1550 - accuracy500: 0.4483 - val_loss: 3.4792 - val_accuracy500: 0.3128 - 58s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 58s - loss: 3.1317 - accuracy500: 0.4585 - val_loss: 3.5622 - val_accuracy500: 0.3147 - 58s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 58s - loss: 3.1184 - accuracy500: 0.4627 - val_loss: 3.5513 - val_accuracy500: 0.3093 - 58s/epoch - 46ms/step
Epoch 12/50
1254/1254 - 58s - loss: 3.1026 - accuracy500: 0.4663 - val_loss: 3.5025 - val_accuracy500: 0.3183 - 58s/epoch - 46ms/step
Epoch 13/50
1254/1254 - 58s - loss: 3.0902 - accuracy500: 0.4711 - val_loss: 3.5226 - val_accuracy500: 0.3099 - 58s/epoch - 46ms/step
testing model: results/EXC/W7/deepLOB_L2/h500
Evaluating performance on  test set...
5929/5929 - 107s - 107s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.148679
{'0': {'precision': 0.3380073647918773, 'recall': 0.34968081004270146, 'f1-score': 0.34374500957284576, 'support': 560168}, '1': {'precision': 0.2987900618823312, 'recall': 0.028946408878091773, 'f1-score': 0.05277959624016755, 'support': 447033}, '2': {'precision': 0.3371183714798866, 'recall': 0.5910140054705195, 'f1-score': 0.42933892620076675, 'support': 510372}, 'accuracy': 0.33636404970304556, 'macro avg': {'precision': 0.32463859938469836, 'recall': 0.3232137414637709, 'f1-score': 0.27528784400459333, 'support': 1517573}, 'weighted avg': {'precision': 0.32615610896023667, 'recall': 0.33636404970304556, 'f1-score': 0.28682095834030413, 'support': 1517573}}
[[195880  15695 348593]
 [189572  12940 244521]
 [194062  14673 301637]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1244231
{'0': {'precision': 0.3437342183103672, 'recall': 0.722585048199509, 'f1-score': 0.4658589870903674, 'support': 105499}, '1': {'precision': 0.40637051642647953, 'recall': 0.2645043786803563, 'f1-score': 0.32043763075762255, 'support': 105968}, '2': {'precision': 0.39228274538354624, 'recall': 0.10825471913498506, 'f1-score': 0.16968343603947922, 'support': 109501}, 'accuracy': 0.3617650357668054, 'macro avg': {'precision': 0.3807958267067977, 'recall': 0.36511471533828344, 'f1-score': 0.3186600179624897, 'support': 320968}, 'weighted avg': {'precision': 0.38097642158860173, 'recall': 0.3617650357668054, 'f1-score': 0.3168050960373914, 'support': 320968}}
[[76232 19146 10121]
 [69696 28029  8243]
 [75848 21799 11854]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1343609
{'0': {'precision': 0.3474138107207815, 'recall': 0.9069085089357162, 'f1-score': 0.5023789119063802, 'support': 37490}, '1': {'precision': 0.3523809523809524, 'recall': 0.029327480031705384, 'f1-score': 0.054148373297309475, 'support': 32802}, '2': {'precision': 0.3964016250725479, 'recall': 0.08774634497289242, 'f1-score': 0.1436866243110195, 'support': 38919}, 'accuracy': 0.35140233126699694, 'macro avg': {'precision': 0.36539879605809394, 'recall': 0.34132744464677134, 'f1-score': 0.23340463650490306, 'support': 109211}, 'weighted avg': {'precision': 0.36636326569778316, 'recall': 0.35140233126699694, 'f1-score': 0.23992546611448579, 'support': 109211}}
[[34000   813  2677]
 [29317   962  2523]
 [34549   955  3415]]
training model: results/EXC/W7/deepLOB_L2/h1000
Epoch 1/50
1254/1254 - 63s - loss: 3.2169 - accuracy1000: 0.4233 - val_loss: 3.4450 - val_accuracy1000: 0.3572 - 63s/epoch - 50ms/step
Epoch 2/50
1254/1254 - 59s - loss: 3.1601 - accuracy1000: 0.4479 - val_loss: 3.4518 - val_accuracy1000: 0.3440 - 59s/epoch - 47ms/step
Epoch 3/50
1254/1254 - 59s - loss: 3.1282 - accuracy1000: 0.4595 - val_loss: 3.3717 - val_accuracy1000: 0.3612 - 59s/epoch - 47ms/step
Epoch 4/50
1254/1254 - 59s - loss: 3.1244 - accuracy1000: 0.4619 - val_loss: 3.4056 - val_accuracy1000: 0.3488 - 59s/epoch - 47ms/step
Epoch 5/50
1254/1254 - 58s - loss: 3.1042 - accuracy1000: 0.4684 - val_loss: 3.5114 - val_accuracy1000: 0.3465 - 58s/epoch - 47ms/step
Epoch 6/50
1254/1254 - 59s - loss: 3.0987 - accuracy1000: 0.4674 - val_loss: 3.5727 - val_accuracy1000: 0.3448 - 59s/epoch - 47ms/step
Epoch 7/50
1254/1254 - 58s - loss: 3.0867 - accuracy1000: 0.4743 - val_loss: 3.4590 - val_accuracy1000: 0.3475 - 58s/epoch - 46ms/step
Epoch 8/50
1254/1254 - 59s - loss: 3.0752 - accuracy1000: 0.4763 - val_loss: 3.4622 - val_accuracy1000: 0.3469 - 59s/epoch - 47ms/step
Epoch 9/50
1254/1254 - 58s - loss: 3.0619 - accuracy1000: 0.4815 - val_loss: 3.6147 - val_accuracy1000: 0.3487 - 58s/epoch - 47ms/step
Epoch 10/50
1254/1254 - 59s - loss: 3.0468 - accuracy1000: 0.4867 - val_loss: 3.5252 - val_accuracy1000: 0.3562 - 59s/epoch - 47ms/step
Epoch 11/50
1254/1254 - 58s - loss: 3.0338 - accuracy1000: 0.4917 - val_loss: 3.5264 - val_accuracy1000: 0.3451 - 58s/epoch - 47ms/step
Epoch 12/50
1254/1254 - 59s - loss: 3.0253 - accuracy1000: 0.4936 - val_loss: 3.4904 - val_accuracy1000: 0.3511 - 59s/epoch - 47ms/step
Epoch 13/50
1254/1254 - 58s - loss: 3.0110 - accuracy1000: 0.4965 - val_loss: 3.5408 - val_accuracy1000: 0.3540 - 58s/epoch - 47ms/step
testing model: results/EXC/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
5929/5929 - 106s - 106s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188365
{'0': {'precision': 0.3766945717714589, 'recall': 0.24406727799806316, 'f1-score': 0.296212851363341, 'support': 634026}, '1': {'precision': 0.21317579663444325, 'recall': 0.15071653002654753, 'f1-score': 0.17658584147238898, 'support': 316037}, '2': {'precision': 0.3760347138574676, 'recall': 0.585302461630632, 'f1-score': 0.45789146470404163, 'support': 567510}, 'accuracy': 0.3522347854106524, 'macro avg': {'precision': 0.32196836075445656, 'recall': 0.3266954232184142, 'f1-score': 0.31023005251325725, 'support': 1517573}, 'weighted avg': {'precision': 0.34239476602719077, 'recall': 0.3522347854106524, 'f1-score': 0.3317614994561011, 'support': 1517573}}
[[154745  94823 384458]
 [101692  47632 166713]
 [154360  80985 332165]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1084148
{'0': {'precision': 0.38482839270544883, 'recall': 0.3293115818889015, 'f1-score': 0.35491206560612926, 'support': 105924}, '1': {'precision': 0.3870094140910459, 'recall': 0.5923527366036601, 'f1-score': 0.4681538598680692, 'support': 106391}, '2': {'precision': 0.3569586865034675, 'recall': 0.22170579735488205, 'f1-score': 0.27352572145545795, 'support': 108653}, 'accuracy': 0.3800752723012886, 'macro avg': {'precision': 0.376265497766654, 'recall': 0.38112337194914786, 'f1-score': 0.3655305489765521, 'support': 320968}, 'weighted avg': {'precision': 0.3761169755494431, 'recall': 0.3800752723012886, 'f1-score': 0.36489760086920586, 'support': 320968}}
[[34882 48664 22378]
 [22353 63021 21017]
 [33408 51156 24089]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1257533
{'0': {'precision': 0.33839124428859846, 'recall': 0.4478413725214456, 'f1-score': 0.38549812371383607, 'support': 35555}, '1': {'precision': 0.3708115276231973, 'recall': 0.4360259516052683, 'f1-score': 0.40078318957794784, 'support': 35913}, '2': {'precision': 0.39072615044913933, 'recall': 0.20628990806242217, 'f1-score': 0.2700190740419629, 'support': 37743}, 'accuracy': 0.36047650877658843, 'macro avg': {'precision': 0.36664297412031166, 'recall': 0.3633857440630453, 'f1-score': 0.3521001291112489, 'support': 109211}, 'weighted avg': {'precision': 0.3671391359717874, 'recall': 0.36047650877658843, 'f1-score': 0.3506152529280392, 'support': 109211}}
[[15923 13189  6443]
 [14556 15659  5698]
 [16576 13381  7786]]
training model: results/EXC/W7/deepOF_L2/h10
Epoch 1/50
1254/1254 - 39s - loss: 2.7052 - accuracy10: 0.4874 - val_loss: 2.4870 - val_accuracy10: 0.6718 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.3291 - accuracy10: 0.5910 - val_loss: 2.3512 - val_accuracy10: 0.6341 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 2.2347 - accuracy10: 0.6119 - val_loss: 2.2460 - val_accuracy10: 0.6682 - 36s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 37s - loss: 2.1931 - accuracy10: 0.6203 - val_loss: 2.2104 - val_accuracy10: 0.6798 - 37s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.1683 - accuracy10: 0.6233 - val_loss: 2.1776 - val_accuracy10: 0.6709 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.1494 - accuracy10: 0.6273 - val_loss: 2.1745 - val_accuracy10: 0.6672 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 35s - loss: 2.1362 - accuracy10: 0.6287 - val_loss: 2.1346 - val_accuracy10: 0.6769 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 2.1230 - accuracy10: 0.6301 - val_loss: 2.1390 - val_accuracy10: 0.6787 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.1155 - accuracy10: 0.6327 - val_loss: 2.1324 - val_accuracy10: 0.6798 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 36s - loss: 2.1069 - accuracy10: 0.6337 - val_loss: 2.1195 - val_accuracy10: 0.6761 - 36s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 36s - loss: 2.0978 - accuracy10: 0.6348 - val_loss: 2.1102 - val_accuracy10: 0.6800 - 36s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.0904 - accuracy10: 0.6351 - val_loss: 2.1184 - val_accuracy10: 0.6827 - 36s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.0828 - accuracy10: 0.6370 - val_loss: 2.1249 - val_accuracy10: 0.6844 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.0752 - accuracy10: 0.6387 - val_loss: 2.1232 - val_accuracy10: 0.6785 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.0691 - accuracy10: 0.6385 - val_loss: 2.1249 - val_accuracy10: 0.6816 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.0637 - accuracy10: 0.6393 - val_loss: 2.1121 - val_accuracy10: 0.6767 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 36s - loss: 2.0584 - accuracy10: 0.6393 - val_loss: 2.1133 - val_accuracy10: 0.6783 - 36s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.0510 - accuracy10: 0.6412 - val_loss: 2.1259 - val_accuracy10: 0.6876 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.0435 - accuracy10: 0.6416 - val_loss: 2.1392 - val_accuracy10: 0.6806 - 36s/epoch - 29ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.0372 - accuracy10: 0.6419 - val_loss: 2.1302 - val_accuracy10: 0.6897 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 36s - loss: 2.0327 - accuracy10: 0.6419 - val_loss: 2.1348 - val_accuracy10: 0.6905 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h10
Evaluating performance on  test set...
5928/5928 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7371938
{'0': {'precision': 0.294042762125553, 'recall': 0.6579063604240283, 'f1-score': 0.4064347534055847, 'support': 176592}, '1': {'precision': 0.9067809704826156, 'recall': 0.6691686971551442, 'f1-score': 0.7700619544943523, 'support': 1166386}, '2': {'precision': 0.37199518541869664, 'recall': 0.5576092559711324, 'f1-score': 0.44627144477933517, 'support': 174590}, 'accuracy': 0.6550236958080297, 'macro avg': {'precision': 0.5242729726756218, 'recall': 0.6282281045167682, 'f1-score': 0.5409227175597574, 'support': 1517568}, 'weighted avg': {'precision': 0.7739546879671041, 'recall': 0.6550236958080297, 'f1-score': 0.6904976517508756, 'support': 1517568}}
[[116181  30201  30210]
 [251735 780509 134142]
 [ 27200  50037  97353]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7214708
{'0': {'precision': 0.3465955602638802, 'recall': 0.7112576891721634, 'f1-score': 0.46607363999125845, 'support': 40479}, '1': {'precision': 0.9048003022391636, 'recall': 0.6693893897234586, 'f1-score': 0.7694926796050391, 'support': 239711}, '2': {'precision': 0.4030715878127322, 'recall': 0.5985874043555033, 'f1-score': 0.48174793498534507, 'support': 40776}, 'accuracy': 0.6656748689892388, 'macro avg': {'precision': 0.5514891501052587, 'recall': 0.6597448277503751, 'f1-score': 0.5724380848605476, 'support': 320966}, 'weighted avg': {'precision': 0.7706612974540161, 'recall': 0.6656748689892388, 'f1-score': 0.6946711128000228, 'support': 320966}}
[[ 28791   6152   5536]
 [ 48640 160460  30611]
 [  5637  10731  24408]]
Evaluating performance on  val set...
427/427 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6884995
{'0': {'precision': 0.3254437869822485, 'recall': 0.7072585018204354, 'f1-score': 0.4457681322168786, 'support': 12909}, '1': {'precision': 0.9036459966142077, 'recall': 0.6929216197699436, 'f1-score': 0.7843774873633439, 'support': 83197}, '2': {'precision': 0.431714762974483, 'recall': 0.5719191148416635, 'f1-score': 0.4920238954900545, 'support': 13105}, 'accuracy': 0.6800963272930383, 'macro avg': {'precision': 0.5536015155236464, 'recall': 0.6573664121440141, 'f1-score': 0.5740565050234256, 'support': 109211}, 'weighted avg': {'precision': 0.7786707547339251, 'recall': 0.6800963272930383, 'f1-score': 0.7092714816763236, 'support': 109211}}
[[ 9130  2211  1568]
 [17250 57649  8298]
 [ 1674  3936  7495]]
training model: results/EXC/W7/deepOF_L2/h20
Epoch 1/50
1254/1254 - 39s - loss: 2.7696 - accuracy20: 0.4894 - val_loss: 2.5786 - val_accuracy20: 0.6217 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.4401 - accuracy20: 0.5783 - val_loss: 2.4491 - val_accuracy20: 0.6260 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 37s - loss: 2.3525 - accuracy20: 0.5998 - val_loss: 2.3879 - val_accuracy20: 0.6340 - 37s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.3125 - accuracy20: 0.6080 - val_loss: 2.3406 - val_accuracy20: 0.6413 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.2901 - accuracy20: 0.6121 - val_loss: 2.3150 - val_accuracy20: 0.6514 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.2742 - accuracy20: 0.6146 - val_loss: 2.3015 - val_accuracy20: 0.6442 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.2610 - accuracy20: 0.6158 - val_loss: 2.2974 - val_accuracy20: 0.6438 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 2.2510 - accuracy20: 0.6178 - val_loss: 2.2854 - val_accuracy20: 0.6495 - 36s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.2415 - accuracy20: 0.6190 - val_loss: 2.2790 - val_accuracy20: 0.6512 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 36s - loss: 2.2327 - accuracy20: 0.6206 - val_loss: 2.3022 - val_accuracy20: 0.6461 - 36s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 2.2261 - accuracy20: 0.6225 - val_loss: 2.2733 - val_accuracy20: 0.6508 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.2179 - accuracy20: 0.6234 - val_loss: 2.2843 - val_accuracy20: 0.6411 - 36s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.2120 - accuracy20: 0.6239 - val_loss: 2.2803 - val_accuracy20: 0.6477 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.2050 - accuracy20: 0.6249 - val_loss: 2.2675 - val_accuracy20: 0.6425 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.1989 - accuracy20: 0.6259 - val_loss: 2.2796 - val_accuracy20: 0.6405 - 36s/epoch - 28ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.1927 - accuracy20: 0.6273 - val_loss: 2.2801 - val_accuracy20: 0.6405 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 36s - loss: 2.1870 - accuracy20: 0.6276 - val_loss: 2.2819 - val_accuracy20: 0.6439 - 36s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 35s - loss: 2.1810 - accuracy20: 0.6278 - val_loss: 2.2857 - val_accuracy20: 0.6414 - 35s/epoch - 28ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.1738 - accuracy20: 0.6294 - val_loss: 2.2768 - val_accuracy20: 0.6437 - 36s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.1675 - accuracy20: 0.6307 - val_loss: 2.2760 - val_accuracy20: 0.6428 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 35s - loss: 2.1637 - accuracy20: 0.6300 - val_loss: 2.2972 - val_accuracy20: 0.6383 - 35s/epoch - 28ms/step
Epoch 22/50
1254/1254 - 36s - loss: 2.1580 - accuracy20: 0.6306 - val_loss: 2.2948 - val_accuracy20: 0.6341 - 36s/epoch - 29ms/step
Epoch 23/50
1254/1254 - 35s - loss: 2.1511 - accuracy20: 0.6310 - val_loss: 2.3076 - val_accuracy20: 0.6415 - 35s/epoch - 28ms/step
Epoch 24/50
1254/1254 - 36s - loss: 2.1447 - accuracy20: 0.6331 - val_loss: 2.3058 - val_accuracy20: 0.6490 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h20
Evaluating performance on  test set...
5928/5928 - 86s - 86s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79257905
{'0': {'precision': 0.35178089254349554, 'recall': 0.6895994998030046, 'f1-score': 0.46589686020808496, 'support': 233508}, '1': {'precision': 0.8544216083839054, 'recall': 0.6344765926686831, 'f1-score': 0.7282035943178208, 'support': 1051380}, '2': {'precision': 0.4423331876195868, 'recall': 0.5305526903902356, 'f1-score': 0.4824431478449135, 'support': 232680}, 'accuracy': 0.6270242914979757, 'macro avg': {'precision': 0.5495118961823292, 'recall': 0.6182095942873077, 'f1-score': 0.5588478674569397, 'support': 1517568}, 'weighted avg': {'precision': 0.7138971890380151, 'recall': 0.6270242914979757, 'f1-score': 0.650161449548155, 'support': 1517568}}
[[161027  43556  28925]
 [257592 667076 126712]
 [ 39129  70102 123449]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77383775
{'0': {'precision': 0.4018382506363978, 'recall': 0.7081762856459946, 'f1-score': 0.5127362038325091, 'support': 54389}, '1': {'precision': 0.8421689162938176, 'recall': 0.6347320943632371, 'f1-score': 0.7238828278802211, 'support': 211735}, '2': {'precision': 0.47265458096807667, 'recall': 0.56478611283323, 'f1-score': 0.5146294050210177, 'support': 54842}, 'accuracy': 0.6352261610264015, 'macro avg': {'precision': 0.572220582632764, 'recall': 0.6358981642808206, 'f1-score': 0.5837494789112493, 'support': 320966}, 'weighted avg': {'precision': 0.7044158528778306, 'recall': 0.6352261610264015, 'f1-score': 0.652348989555366, 'support': 320966}}
[[ 38517   9594   6278]
 [ 49060 134395  28280]
 [  8275  15593  30974]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.75785005
{'0': {'precision': 0.38238684153141644, 'recall': 0.6983955393718707, 'f1-score': 0.49419248344304195, 'support': 17576}, '1': {'precision': 0.8406366878316083, 'recall': 0.6538664501725188, 'f1-score': 0.7355810944516326, 'support': 73905}, '2': {'precision': 0.49253503184713376, 'recall': 0.5451776649746193, 'f1-score': 0.517521081515192, 'support': 17730}, 'accuracy': 0.6433875708490903, 'macro avg': {'precision': 0.5718528537367195, 'recall': 0.6324798848396695, 'f1-score': 0.5824315531366222, 'support': 109211}, 'weighted avg': {'precision': 0.7103747026911289, 'recall': 0.6433875708490903, 'f1-score': 0.6613317033055934, 'support': 109211}}
[[12275  3488  1813]
 [17435 48324  8146]
 [ 2391  5673  9666]]
training model: results/EXC/W7/deepOF_L2/h30
Epoch 1/50
1254/1254 - 38s - loss: 2.8414 - accuracy30: 0.4870 - val_loss: 2.7045 - val_accuracy30: 0.5923 - 38s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 37s - loss: 2.5537 - accuracy30: 0.5640 - val_loss: 2.5676 - val_accuracy30: 0.6067 - 37s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 37s - loss: 2.4772 - accuracy30: 0.5802 - val_loss: 2.5316 - val_accuracy30: 0.6099 - 37s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.4432 - accuracy30: 0.5884 - val_loss: 2.5004 - val_accuracy30: 0.6097 - 36s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.4221 - accuracy30: 0.5931 - val_loss: 2.4783 - val_accuracy30: 0.6111 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.4061 - accuracy30: 0.5958 - val_loss: 2.4861 - val_accuracy30: 0.6049 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.3934 - accuracy30: 0.5990 - val_loss: 2.4499 - val_accuracy30: 0.6038 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 2.3848 - accuracy30: 0.6015 - val_loss: 2.4591 - val_accuracy30: 0.6014 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.3751 - accuracy30: 0.6031 - val_loss: 2.4289 - val_accuracy30: 0.6035 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 37s - loss: 2.3676 - accuracy30: 0.6045 - val_loss: 2.4298 - val_accuracy30: 0.6051 - 37s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 35s - loss: 2.3610 - accuracy30: 0.6050 - val_loss: 2.4445 - val_accuracy30: 0.6010 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.3545 - accuracy30: 0.6060 - val_loss: 2.4425 - val_accuracy30: 0.6037 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.3484 - accuracy30: 0.6079 - val_loss: 2.4205 - val_accuracy30: 0.6104 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.3420 - accuracy30: 0.6084 - val_loss: 2.4380 - val_accuracy30: 0.6106 - 36s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.3352 - accuracy30: 0.6097 - val_loss: 2.4422 - val_accuracy30: 0.6069 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.3296 - accuracy30: 0.6108 - val_loss: 2.4455 - val_accuracy30: 0.6073 - 36s/epoch - 28ms/step
Epoch 17/50
1254/1254 - 36s - loss: 2.3249 - accuracy30: 0.6120 - val_loss: 2.4523 - val_accuracy30: 0.6072 - 36s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.3181 - accuracy30: 0.6123 - val_loss: 2.4502 - val_accuracy30: 0.6089 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.3104 - accuracy30: 0.6127 - val_loss: 2.4484 - val_accuracy30: 0.6113 - 36s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.3073 - accuracy30: 0.6130 - val_loss: 2.4566 - val_accuracy30: 0.6061 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 36s - loss: 2.3017 - accuracy30: 0.6134 - val_loss: 2.4596 - val_accuracy30: 0.6091 - 36s/epoch - 29ms/step
Epoch 22/50
1254/1254 - 36s - loss: 2.2949 - accuracy30: 0.6144 - val_loss: 2.4562 - val_accuracy30: 0.6066 - 36s/epoch - 29ms/step
Epoch 23/50
1254/1254 - 37s - loss: 2.2876 - accuracy30: 0.6160 - val_loss: 2.4864 - val_accuracy30: 0.5966 - 37s/epoch - 30ms/step
testing model: results/EXC/W7/deepOF_L2/h30
Evaluating performance on  test set...
5928/5928 - 78s - 78s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8286763
{'0': {'precision': 0.3889746940715219, 'recall': 0.6875859971322219, 'f1-score': 0.4968666514905319, 'support': 276172}, '1': {'precision': 0.8032858592332257, 'recall': 0.5999057215249544, 'f1-score': 0.6868567194705097, 'support': 967347}, '2': {'precision': 0.46809772180105746, 'recall': 0.5243003988337852, 'f1-score': 0.49460759171224883, 'support': 274049}, 'accuracy': 0.6022089290232794, 'macro avg': {'precision': 0.5534527583686017, 'recall': 0.6039307058303205, 'f1-score': 0.5594436542244301, 'support': 1517568}, 'weighted avg': {'precision': 0.6673584299646945, 'recall': 0.6022089290232794, 'f1-score': 0.6175645241506361, 'support': 1517568}}
[[189892  56172  30108]
 [253869 580317 133161]
 [ 44425  85940 143684]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.81530404
{'0': {'precision': 0.43616823980712355, 'recall': 0.6858682138416908, 'f1-score': 0.5332338902147972, 'support': 65151}, '1': {'precision': 0.7773102454656846, 'recall': 0.6074382339324046, 'f1-score': 0.6819548383667152, 'support': 190072}, '2': {'precision': 0.49774945343869226, 'recall': 0.529851086807721, 'f1-score': 0.5132988520990819, 'support': 65743}, 'accuracy': 0.6074662113744135, 'macro avg': {'precision': 0.5704093129038336, 'recall': 0.6077191781939387, 'f1-score': 0.5761625268935314, 'support': 320966}, 'weighted avg': {'precision': 0.6508018054412227, 'recall': 0.6074662113744135, 'f1-score': 0.6172212871549401, 'support': 320966}}
[[ 44685  12894   7572]
 [ 47038 115457  27577]
 [ 10726  20183  34834]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8085004
{'0': {'precision': 0.4139699179580675, 'recall': 0.6817414148996059, 'f1-score': 0.5151364764267989, 'support': 21316}, '1': {'precision': 0.7718942085377545, 'recall': 0.6185641550929413, 'f1-score': 0.6867750972111887, 'support': 66386}, '2': {'precision': 0.5219533193036159, 'recall': 0.5073690083220977, 'f1-score': 0.5145578423745196, 'support': 21509}, 'accuracy': 0.6089954308631914, 'macro avg': {'precision': 0.569272481933146, 'recall': 0.6025581927715483, 'f1-score': 0.5721564720041691, 'support': 109211}, 'weighted avg': {'precision': 0.6528082852833781, 'recall': 0.6089954308631914, 'f1-score': 0.6193563410884357, 'support': 109211}}
[[14532  4687  2097]
 [17424 41064  7898]
 [ 3148  7448 10913]]
training model: results/EXC/W7/deepOF_L2/h50
Epoch 1/50
1254/1254 - 39s - loss: 2.9674 - accuracy50: 0.4751 - val_loss: 2.8929 - val_accuracy50: 0.5366 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.7506 - accuracy50: 0.5379 - val_loss: 2.8040 - val_accuracy50: 0.5428 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 2.6843 - accuracy50: 0.5525 - val_loss: 2.7592 - val_accuracy50: 0.5480 - 36s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.6541 - accuracy50: 0.5590 - val_loss: 2.7541 - val_accuracy50: 0.5476 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.6326 - accuracy50: 0.5630 - val_loss: 2.7295 - val_accuracy50: 0.5560 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 37s - loss: 2.6208 - accuracy50: 0.5657 - val_loss: 2.7191 - val_accuracy50: 0.5539 - 37s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 37s - loss: 2.6097 - accuracy50: 0.5696 - val_loss: 2.7101 - val_accuracy50: 0.5493 - 37s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 2.6004 - accuracy50: 0.5707 - val_loss: 2.7238 - val_accuracy50: 0.5420 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 37s - loss: 2.5908 - accuracy50: 0.5734 - val_loss: 2.6932 - val_accuracy50: 0.5537 - 37s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 36s - loss: 2.5848 - accuracy50: 0.5755 - val_loss: 2.6885 - val_accuracy50: 0.5541 - 36s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 37s - loss: 2.5777 - accuracy50: 0.5761 - val_loss: 2.6967 - val_accuracy50: 0.5505 - 37s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.5723 - accuracy50: 0.5771 - val_loss: 2.6937 - val_accuracy50: 0.5518 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.5648 - accuracy50: 0.5787 - val_loss: 2.6916 - val_accuracy50: 0.5522 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 37s - loss: 2.5598 - accuracy50: 0.5801 - val_loss: 2.6964 - val_accuracy50: 0.5537 - 37s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.5527 - accuracy50: 0.5822 - val_loss: 2.6770 - val_accuracy50: 0.5558 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 37s - loss: 2.5474 - accuracy50: 0.5824 - val_loss: 2.6860 - val_accuracy50: 0.5560 - 37s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 37s - loss: 2.5407 - accuracy50: 0.5850 - val_loss: 2.6907 - val_accuracy50: 0.5527 - 37s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.5338 - accuracy50: 0.5850 - val_loss: 2.6783 - val_accuracy50: 0.5583 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.5281 - accuracy50: 0.5857 - val_loss: 2.6816 - val_accuracy50: 0.5577 - 36s/epoch - 29ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.5194 - accuracy50: 0.5864 - val_loss: 2.7000 - val_accuracy50: 0.5576 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 37s - loss: 2.5127 - accuracy50: 0.5886 - val_loss: 2.7176 - val_accuracy50: 0.5564 - 37s/epoch - 29ms/step
Epoch 22/50
1254/1254 - 36s - loss: 2.5062 - accuracy50: 0.5894 - val_loss: 2.7115 - val_accuracy50: 0.5532 - 36s/epoch - 29ms/step
Epoch 23/50
1254/1254 - 37s - loss: 2.4990 - accuracy50: 0.5907 - val_loss: 2.7179 - val_accuracy50: 0.5513 - 37s/epoch - 29ms/step
Epoch 24/50
1254/1254 - 36s - loss: 2.4896 - accuracy50: 0.5925 - val_loss: 2.7153 - val_accuracy50: 0.5560 - 36s/epoch - 29ms/step
Epoch 25/50
1254/1254 - 36s - loss: 2.4847 - accuracy50: 0.5931 - val_loss: 2.7426 - val_accuracy50: 0.5555 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h50
Evaluating performance on  test set...
5928/5928 - 83s - 83s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89309275
{'0': {'precision': 0.42163298935605265, 'recall': 0.6903682048496964, 'f1-score': 0.5235282326743464, 'support': 346166}, '1': {'precision': 0.7051676239358019, 'recall': 0.520309652164295, 'f1-score': 0.5987961234094571, 'support': 831772}, '2': {'precision': 0.5051655283317806, 'recall': 0.50131613815034, 'f1-score': 0.5032334720514519, 'support': 339630}, 'accuracy': 0.5548502604166666, 'macro avg': {'precision': 0.5439887138745451, 'recall': 0.5706646650547772, 'f1-score': 0.5418526093784185, 'support': 1517568}, 'weighted avg': {'precision': 0.5957314984745855, 'recall': 0.5548502604166666, 'f1-score': 0.5602402709238159, 'support': 1517568}}
[[238982  73561  33623]
 [265836 432779 133157]
 [ 61983 107385 170262]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.88502586
{'0': {'precision': 0.4738771769019248, 'recall': 0.6498224462152367, 'f1-score': 0.5480753396459449, 'support': 81947}, '1': {'precision': 0.6601536253130535, 'recall': 0.5549714359073111, 'f1-score': 0.6030102037257896, 'support': 155790}, '2': {'precision': 0.5372367149758455, 'recall': 0.5010633312907761, 'f1-score': 0.5185199000335708, 'support': 83229}, 'accuracy': 0.5652093991263872, 'macro avg': {'precision': 0.5570891723969412, 'recall': 0.5686190711377747, 'f1-score': 0.5565351478017684, 'support': 320966}, 'weighted avg': {'precision': 0.5807213874797558, 'recall': 0.5652093991263872, 'f1-score': 0.5670755851283348, 'support': 320966}}
[[53251 18785  9911]
 [43320 86459 26011]
 [15802 25724 41703]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.89303416
{'0': {'precision': 0.4514759083521208, 'recall': 0.6313281278639247, 'f1-score': 0.5264654184180358, 'support': 27279}, '1': {'precision': 0.6439853424311347, 'recall': 0.5629625538495526, 'f1-score': 0.6007544056108917, 'support': 54318}, '2': {'precision': 0.5503159323183919, 'recall': 0.46994278264648365, 'f1-score': 0.5069635706611973, 'support': 27614}, 'accuracy': 0.5565190319656445, 'macro avg': {'precision': 0.5485923943672159, 'recall': 0.554744488119987, 'f1-score': 0.5447277982300416, 'support': 109211}, 'weighted avg': {'precision': 0.5722155395441114, 'recall': 0.5565190319656445, 'f1-score': 0.558483302902055, 'support': 109211}}
[[17222  7133  2924]
 [16059 30579  7680]
 [ 4865  9772 12977]]
training model: results/EXC/W7/deepOF_L2/h100
Epoch 1/50
1254/1254 - 39s - loss: 3.1353 - accuracy100: 0.4380 - val_loss: 3.1208 - val_accuracy100: 0.4371 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 36s - loss: 3.0192 - accuracy100: 0.4772 - val_loss: 3.0903 - val_accuracy100: 0.4425 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 2.9739 - accuracy100: 0.4891 - val_loss: 3.0759 - val_accuracy100: 0.4461 - 36s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.9518 - accuracy100: 0.4938 - val_loss: 3.0618 - val_accuracy100: 0.4479 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.9363 - accuracy100: 0.4976 - val_loss: 3.0527 - val_accuracy100: 0.4529 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.9257 - accuracy100: 0.4999 - val_loss: 3.0419 - val_accuracy100: 0.4562 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.9179 - accuracy100: 0.5023 - val_loss: 3.0498 - val_accuracy100: 0.4562 - 36s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 37s - loss: 2.9109 - accuracy100: 0.5034 - val_loss: 3.0507 - val_accuracy100: 0.4563 - 37s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 37s - loss: 2.9040 - accuracy100: 0.5063 - val_loss: 3.0355 - val_accuracy100: 0.4604 - 37s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 37s - loss: 2.8984 - accuracy100: 0.5075 - val_loss: 3.0525 - val_accuracy100: 0.4585 - 37s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 37s - loss: 2.8909 - accuracy100: 0.5102 - val_loss: 3.0358 - val_accuracy100: 0.4613 - 37s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 37s - loss: 2.8864 - accuracy100: 0.5111 - val_loss: 3.0259 - val_accuracy100: 0.4661 - 37s/epoch - 30ms/step
Epoch 13/50
1254/1254 - 37s - loss: 2.8796 - accuracy100: 0.5130 - val_loss: 3.0524 - val_accuracy100: 0.4607 - 37s/epoch - 30ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.8736 - accuracy100: 0.5141 - val_loss: 3.0432 - val_accuracy100: 0.4634 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.8674 - accuracy100: 0.5158 - val_loss: 3.0378 - val_accuracy100: 0.4656 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.8610 - accuracy100: 0.5177 - val_loss: 3.0327 - val_accuracy100: 0.4704 - 36s/epoch - 28ms/step
Epoch 17/50
1254/1254 - 36s - loss: 2.8551 - accuracy100: 0.5205 - val_loss: 3.0321 - val_accuracy100: 0.4696 - 36s/epoch - 28ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.8481 - accuracy100: 0.5217 - val_loss: 3.0511 - val_accuracy100: 0.4636 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.8413 - accuracy100: 0.5238 - val_loss: 3.0464 - val_accuracy100: 0.4640 - 36s/epoch - 29ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.8328 - accuracy100: 0.5266 - val_loss: 3.0661 - val_accuracy100: 0.4606 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 36s - loss: 2.8246 - accuracy100: 0.5281 - val_loss: 3.0631 - val_accuracy100: 0.4636 - 36s/epoch - 29ms/step
Epoch 22/50
1254/1254 - 36s - loss: 2.8168 - accuracy100: 0.5302 - val_loss: 3.0416 - val_accuracy100: 0.4673 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h100
Evaluating performance on  test set...
5928/5928 - 87s - 87s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97699195
{'0': {'precision': 0.4597606128544617, 'recall': 0.6793802351204415, 'f1-score': 0.5483997414638652, 'support': 463337}, '1': {'precision': 0.5037731878756054, 'recall': 0.42899792038271534, 'f1-score': 0.4633883876329374, 'support': 608285}, '2': {'precision': 0.5376588569287343, 'recall': 0.3796692873128137, 'f1-score': 0.4450589602182816, 'support': 445946}, 'accuracy': 0.4909480168269231, 'macro avg': {'precision': 0.5003975525529337, 'recall': 0.49601581427199015, 'f1-score': 0.48561569643836133, 'support': 1517568}, 'weighted avg': {'precision': 0.5002929643198866, 'recall': 0.4909480168269231, 'f1-score': 0.483957463161747, 'support': 1517568}}
[[314782 105955  42600]
 [244338 260953 102994]
 [125545 151089 169312]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98775506
{'0': {'precision': 0.4776743830485152, 'recall': 0.6539742345531008, 'f1-score': 0.5520914074579811, 'support': 105102}, '1': {'precision': 0.4421925215071571, 'recall': 0.45927124301507166, 'f1-score': 0.45057009942533977, 'support': 107553}, '2': {'precision': 0.5784505706330508, 'recall': 0.3490965829878775, 'f1-score': 0.4354174703616483, 'support': 108311}, 'accuracy': 0.48584896842656233, 'macro avg': {'precision': 0.49943915839624103, 'recall': 0.48744735351868335, 'f1-score': 0.4793596590816564, 'support': 320966}, 'weighted avg': {'precision': 0.499791956246645, 'recall': 0.48584896842656233, 'f1-score': 0.478700481180196, 'support': 320966}}
[[68734 25236 11132]
 [41734 49396 16423]
 [33425 37075 37811]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0103321
{'0': {'precision': 0.4562977801398144, 'recall': 0.6287637664422725, 'f1-score': 0.528824400355345, 'support': 35503}, '1': {'precision': 0.4224945035942788, 'recall': 0.45507277226405557, 'f1-score': 0.4381789301086288, 'support': 37583}, '2': {'precision': 0.5800181744749596, 'recall': 0.31803460207612455, 'f1-score': 0.41081293690665616, 'support': 36125}, 'accuracy': 0.4662076164488925, 'macro avg': {'precision': 0.48627015273635094, 'recall': 0.46729038026081754, 'f1-score': 0.45927208912354334, 'support': 109211}, 'weighted avg': {'precision': 0.48558943302227364, 'recall': 0.4662076164488925, 'f1-score': 0.4585943610244514, 'support': 109211}}
[[22323  9732  3448]
 [15609 17103  4871]
 [10990 13646 11489]]
training model: results/EXC/W7/deepOF_L2/h200
Epoch 1/50
1254/1254 - 38s - loss: 3.2560 - accuracy200: 0.3904 - val_loss: 3.2708 - val_accuracy200: 0.3874 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 36s - loss: 3.2205 - accuracy200: 0.4088 - val_loss: 3.2567 - val_accuracy200: 0.3932 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 3.2043 - accuracy200: 0.4159 - val_loss: 3.2516 - val_accuracy200: 0.3956 - 36s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 3.1945 - accuracy200: 0.4199 - val_loss: 3.2534 - val_accuracy200: 0.3957 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 3.1861 - accuracy200: 0.4243 - val_loss: 3.2489 - val_accuracy200: 0.3983 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 3.1799 - accuracy200: 0.4259 - val_loss: 3.2470 - val_accuracy200: 0.3987 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 36s - loss: 3.1738 - accuracy200: 0.4293 - val_loss: 3.2503 - val_accuracy200: 0.4005 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 3.1693 - accuracy200: 0.4301 - val_loss: 3.2496 - val_accuracy200: 0.3991 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 36s - loss: 3.1656 - accuracy200: 0.4324 - val_loss: 3.2547 - val_accuracy200: 0.3964 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 37s - loss: 3.1607 - accuracy200: 0.4342 - val_loss: 3.2533 - val_accuracy200: 0.3989 - 37s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 36s - loss: 3.1560 - accuracy200: 0.4370 - val_loss: 3.2601 - val_accuracy200: 0.3962 - 36s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 36s - loss: 3.1512 - accuracy200: 0.4384 - val_loss: 3.2520 - val_accuracy200: 0.4020 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 3.1470 - accuracy200: 0.4394 - val_loss: 3.2595 - val_accuracy200: 0.3990 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 3.1417 - accuracy200: 0.4423 - val_loss: 3.2644 - val_accuracy200: 0.3992 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 3.1353 - accuracy200: 0.4448 - val_loss: 3.2803 - val_accuracy200: 0.3978 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 3.1307 - accuracy200: 0.4455 - val_loss: 3.2723 - val_accuracy200: 0.3969 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h200
Evaluating performance on  test set...
5928/5928 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.057013
{'0': {'precision': 0.4085472471680652, 'recall': 0.7686952935156705, 'f1-score': 0.5335321061273874, 'support': 513993}, '1': {'precision': 0.39369639848490606, 'recall': 0.05939689541421871, 'f1-score': 0.1032208779985552, 'support': 523226}, '2': {'precision': 0.4457472843951868, 'recall': 0.4375672687983112, 'f1-score': 0.44161940070365785, 'support': 480349}, 'accuracy': 0.41933343349358976, 'macro avg': {'precision': 0.41599697668271934, 'recall': 0.4218864859094001, 'f1-score': 0.35945746160986686, 'support': 1517568}, 'weighted avg': {'precision': 0.41520174339420857, 'recall': 0.41933343349358976, 'f1-score': 0.3560769945366585, 'support': 1517568}}
[[395104  20752  98137]
 [328936  31078 163212]
 [243055  27109 210185]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0744641
{'0': {'precision': 0.39383755501272366, 'recall': 0.7312911320486719, 'f1-score': 0.5119590581247349, 'support': 105605}, '1': {'precision': 0.3845390959390333, 'recall': 0.06960901033694276, 'f1-score': 0.11787954429083462, 'support': 105834}, '2': {'precision': 0.4558301881438179, 'recall': 0.43997370511380757, 'f1-score': 0.4477616100797235, 'support': 109527}, 'accuracy': 0.41370113968457717, 'macro avg': {'precision': 0.4114022796985249, 'recall': 0.41362461583314075, 'f1-score': 0.35920007083176425, 'support': 320966}, 'weighted avg': {'precision': 0.41192599432201, 'recall': 0.41370113968457717, 'f1-score': 0.3601100611620567, 'support': 320966}}
[[77228  5068 23309]
 [64248  7367 34219]
 [54615  6723 48189]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.083023
{'0': {'precision': 0.38159232892634026, 'recall': 0.7377808988764045, 'f1-score': 0.5030163746049986, 'support': 35600}, '1': {'precision': 0.35257664709719505, 'recall': 0.05820433436532508, 'f1-score': 0.09991450424012754, 'support': 37145}, '2': {'precision': 0.4409179830068031, 'recall': 0.414111775352383, 'f1-score': 0.4270946758113554, 'support': 36466}, 'accuracy': 0.39856790982593326, 'macro avg': {'precision': 0.3916956530101128, 'recall': 0.40336566953137093, 'f1-score': 0.3433418515521605, 'support': 109211}, 'weighted avg': {'precision': 0.39153255289786837, 'recall': 0.39856790982593326, 'f1-score': 0.3405622294830592, 'support': 109211}}
[[26265  1695  7640]
 [23475  2162 11508]
 [19090  2275 15101]]
training model: results/EXC/W7/deepOF_L2/h300
Epoch 1/50
1254/1254 - 39s - loss: 3.2805 - accuracy300: 0.3760 - val_loss: 3.2661 - val_accuracy300: 0.3795 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 36s - loss: 3.2511 - accuracy300: 0.3948 - val_loss: 3.2535 - val_accuracy300: 0.3898 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 37s - loss: 3.2384 - accuracy300: 0.4019 - val_loss: 3.2448 - val_accuracy300: 0.3929 - 37s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 37s - loss: 3.2301 - accuracy300: 0.4075 - val_loss: 3.2397 - val_accuracy300: 0.3955 - 37s/epoch - 30ms/step
Epoch 5/50
1254/1254 - 37s - loss: 3.2206 - accuracy300: 0.4128 - val_loss: 3.2353 - val_accuracy300: 0.3971 - 37s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 37s - loss: 3.2142 - accuracy300: 0.4164 - val_loss: 3.2336 - val_accuracy300: 0.4006 - 37s/epoch - 30ms/step
Epoch 7/50
1254/1254 - 37s - loss: 3.2086 - accuracy300: 0.4198 - val_loss: 3.2326 - val_accuracy300: 0.4010 - 37s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 3.2034 - accuracy300: 0.4233 - val_loss: 3.2290 - val_accuracy300: 0.4031 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 36s - loss: 3.1993 - accuracy300: 0.4263 - val_loss: 3.2286 - val_accuracy300: 0.4036 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 37s - loss: 3.1941 - accuracy300: 0.4284 - val_loss: 3.2270 - val_accuracy300: 0.4046 - 37s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 36s - loss: 3.1896 - accuracy300: 0.4302 - val_loss: 3.2299 - val_accuracy300: 0.4038 - 36s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 36s - loss: 3.1831 - accuracy300: 0.4339 - val_loss: 3.2319 - val_accuracy300: 0.4037 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 3.1790 - accuracy300: 0.4358 - val_loss: 3.2427 - val_accuracy300: 0.3996 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 3.1746 - accuracy300: 0.4382 - val_loss: 3.2358 - val_accuracy300: 0.4036 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 36s - loss: 3.1667 - accuracy300: 0.4412 - val_loss: 3.2450 - val_accuracy300: 0.3986 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 3.1645 - accuracy300: 0.4421 - val_loss: 3.2653 - val_accuracy300: 0.3953 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 36s - loss: 3.1580 - accuracy300: 0.4455 - val_loss: 3.2556 - val_accuracy300: 0.3962 - 36s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 36s - loss: 3.1498 - accuracy300: 0.4486 - val_loss: 3.2816 - val_accuracy300: 0.3913 - 36s/epoch - 28ms/step
Epoch 19/50
1254/1254 - 35s - loss: 3.1452 - accuracy300: 0.4499 - val_loss: 3.2813 - val_accuracy300: 0.3889 - 35s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 3.1372 - accuracy300: 0.4521 - val_loss: 3.3338 - val_accuracy300: 0.3805 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h300
Evaluating performance on  test set...
5928/5928 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0684063
{'0': {'precision': 0.3885273508451026, 'recall': 0.7250790666549826, 'f1-score': 0.5059472440058534, 'support': 502108}, '1': {'precision': 0.476323339868345, 'recall': 0.17526342662666736, 'f1-score': 0.2562423456714689, 'support': 550343}, '2': {'precision': 0.4158053875028768, 'recall': 0.3379450761851319, 'f1-score': 0.3728538558246554, 'support': 465117}, 'accuracy': 0.4070374441211201, 'macro avg': {'precision': 0.42688535940544153, 'recall': 0.412762523155594, 'f1-score': 0.3783478151673259, 'support': 1517568}, 'weighted avg': {'precision': 0.4287267926909851, 'recall': 0.4070374441211201, 'f1-score': 0.37460068141708347, 'support': 1517568}}
[[364068  52525  85515]
 [318564  96455 135324]
 [254414  53519 157184]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0701324
{'0': {'precision': 0.39329444958922954, 'recall': 0.6881935428847593, 'f1-score': 0.5005375973533669, 'support': 105527}, '1': {'precision': 0.4583058082219625, 'recall': 0.17068347195806247, 'f1-score': 0.24873309937327198, 'support': 105681}, '2': {'precision': 0.45332370687432316, 'recall': 0.4004446145155706, 'f1-score': 0.42524659794013925, 'support': 109758}, 'accuracy': 0.4193995625704903, 'macro avg': {'precision': 0.4349746548951718, 'recall': 0.41977387645279746, 'f1-score': 0.391505764888926, 'support': 320966}, 'weighted avg': {'precision': 0.4352277279201529, 'recall': 0.4193995625704903, 'f1-score': 0.39188203674996513, 'support': 320966}}
[[72623 10236 22668]
 [57308 18038 30335]
 [54722 11084 43952]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.076349
{'0': {'precision': 0.3775274227319604, 'recall': 0.684195622008892, 'f1-score': 0.48657248441763756, 'support': 35313}, '1': {'precision': 0.4779788838612368, 'recall': 0.16819701714346372, 'f1-score': 0.24883200502532288, 'support': 37682}, '2': {'precision': 0.42925546897004974, 'recall': 0.378727634194831, 'f1-score': 0.40241165339083745, 'support': 36216}, 'accuracy': 0.4048584849511496, 'macro avg': {'precision': 0.428253925187749, 'recall': 0.4103734244490622, 'f1-score': 0.37927204761126593, 'support': 109211}, 'weighted avg': {'precision': 0.42934083787175437, 'recall': 0.4048584849511496, 'f1-score': 0.37663387566093914, 'support': 109211}}
[[24161  3332  7820]
 [20927  6338 10417]
 [18910  3590 13716]]
training model: results/EXC/W7/deepOF_L2/h500
Epoch 1/50
1254/1254 - 38s - loss: 3.2766 - accuracy500: 0.3863 - val_loss: 3.2834 - val_accuracy500: 0.3821 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 36s - loss: 3.2626 - accuracy500: 0.3926 - val_loss: 3.2734 - val_accuracy500: 0.3891 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 3.2604 - accuracy500: 0.3919 - val_loss: 3.2708 - val_accuracy500: 0.3910 - 36s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 3.2571 - accuracy500: 0.3922 - val_loss: 3.2686 - val_accuracy500: 0.3928 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 3.2525 - accuracy500: 0.3939 - val_loss: 3.2668 - val_accuracy500: 0.3942 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 3.2486 - accuracy500: 0.3973 - val_loss: 3.2687 - val_accuracy500: 0.3919 - 36s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 36s - loss: 3.2460 - accuracy500: 0.3983 - val_loss: 3.2702 - val_accuracy500: 0.3906 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 35s - loss: 3.2429 - accuracy500: 0.4004 - val_loss: 3.2683 - val_accuracy500: 0.3914 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 35s - loss: 3.2404 - accuracy500: 0.4024 - val_loss: 3.2710 - val_accuracy500: 0.3893 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 35s - loss: 3.2366 - accuracy500: 0.4034 - val_loss: 3.2695 - val_accuracy500: 0.3913 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 36s - loss: 3.2328 - accuracy500: 0.4051 - val_loss: 3.2729 - val_accuracy500: 0.3895 - 36s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 36s - loss: 3.2294 - accuracy500: 0.4062 - val_loss: 3.2690 - val_accuracy500: 0.3917 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 3.2247 - accuracy500: 0.4097 - val_loss: 3.2749 - val_accuracy500: 0.3876 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 35s - loss: 3.2209 - accuracy500: 0.4114 - val_loss: 3.2778 - val_accuracy500: 0.3848 - 35s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 36s - loss: 3.2173 - accuracy500: 0.4137 - val_loss: 3.2785 - val_accuracy500: 0.3860 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepOF_L2/h500
Evaluating performance on  test set...
5928/5928 - 76s - 76s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.080662
{'0': {'precision': 0.4123468010715298, 'recall': 0.693296272890536, 'f1-score': 0.5171261993199721, 'support': 560166}, '1': {'precision': 0.44149127826879464, 'recall': 0.04659632106050811, 'f1-score': 0.08429580827661004, 'support': 447031}, '2': {'precision': 0.40466856870416756, 'recall': 0.419087291401745, 'f1-score': 0.41175174001638226, 'support': 510371}, 'accuracy': 0.41057863634446695, 'macro avg': {'precision': 0.4195022160148307, 'recall': 0.3863266284509297, 'f1-score': 0.33772458253765486, 'support': 1517568}, 'weighted avg': {'precision': 0.41834965409321145, 'recall': 0.41057863634446695, 'f1-score': 0.3541887423442467, 'support': 1517568}}
[[388361  13743 158062]
 [269597  20830 156604]
 [283873  12608 213890]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0959713
{'0': {'precision': 0.36745013770148777, 'recall': 0.6789670694148306, 'f1-score': 0.4768395272069002, 'support': 105525}, '1': {'precision': 0.4439717899921639, 'recall': 0.037433104606933526, 'f1-score': 0.06904475897007364, 'support': 105949}, '2': {'precision': 0.39486184918749895, 'recall': 0.42210389800168047, 'f1-score': 0.40802867510086616, 'support': 109492}, 'accuracy': 0.37957602985986055, 'macro avg': {'precision': 0.40209459229371686, 'recall': 0.37950135734114826, 'f1-score': 0.31797098709261334, 'support': 320966}, 'weighted avg': {'precision': 0.40206051902714585, 'recall': 0.37957602985986055, 'f1-score': 0.318755226319213, 'support': 320966}}
[[71648  2323 31554]
 [62708  3966 39275]
 [60631  2644 46217]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0890374
{'0': {'precision': 0.37779761904761905, 'recall': 0.6773023156546794, 'f1-score': 0.48504069389782584, 'support': 37484}, '1': {'precision': 0.43256997455470736, 'recall': 0.04665772139546231, 'f1-score': 0.08423022929340196, 'support': 32792}, '2': {'precision': 0.41698289754119666, 'recall': 0.41204571722100936, 'f1-score': 0.4144996059889677, 'support': 38935}, 'accuracy': 0.3933761251156019, 'macro avg': {'precision': 0.40911683038117436, 'recall': 0.37866858475705034, 'f1-score': 0.32792350972673184, 'support': 109211}, 'weighted avg': {'precision': 0.40821373006149025, 'recall': 0.3933761251156019, 'f1-score': 0.3395435002722784, 'support': 109211}}
[[25388   951 11145]
 [19976  1530 11286]
 [21836  1056 16043]]
training model: results/EXC/W7/deepOF_L2/h1000
Epoch 1/50
1254/1254 - 39s - loss: 3.2585 - accuracy1000: 0.3964 - val_loss: 3.4402 - val_accuracy1000: 0.3401 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 35s - loss: 3.2418 - accuracy1000: 0.4000 - val_loss: 3.4234 - val_accuracy1000: 0.3479 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 3.2391 - accuracy1000: 0.4017 - val_loss: 3.4212 - val_accuracy1000: 0.3515 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 3.2385 - accuracy1000: 0.3997 - val_loss: 3.4147 - val_accuracy1000: 0.3554 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 3.2374 - accuracy1000: 0.3997 - val_loss: 3.4130 - val_accuracy1000: 0.3583 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 35s - loss: 3.2369 - accuracy1000: 0.4006 - val_loss: 3.4106 - val_accuracy1000: 0.3585 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 36s - loss: 3.2344 - accuracy1000: 0.4017 - val_loss: 3.4129 - val_accuracy1000: 0.3586 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 3.2322 - accuracy1000: 0.4037 - val_loss: 3.4123 - val_accuracy1000: 0.3577 - 36s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 3.2309 - accuracy1000: 0.4047 - val_loss: 3.4098 - val_accuracy1000: 0.3572 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 37s - loss: 3.2295 - accuracy1000: 0.4055 - val_loss: 3.4099 - val_accuracy1000: 0.3566 - 37s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 36s - loss: 3.2290 - accuracy1000: 0.4064 - val_loss: 3.4173 - val_accuracy1000: 0.3559 - 36s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 36s - loss: 3.2280 - accuracy1000: 0.4067 - val_loss: 3.4197 - val_accuracy1000: 0.3545 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 36s - loss: 3.2257 - accuracy1000: 0.4084 - val_loss: 3.4248 - val_accuracy1000: 0.3528 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 3.2240 - accuracy1000: 0.4090 - val_loss: 3.4266 - val_accuracy1000: 0.3533 - 36s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 36s - loss: 3.2216 - accuracy1000: 0.4108 - val_loss: 3.4350 - val_accuracy1000: 0.3527 - 36s/epoch - 29ms/step
Epoch 16/50
1254/1254 - 36s - loss: 3.2194 - accuracy1000: 0.4121 - val_loss: 3.4382 - val_accuracy1000: 0.3518 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 36s - loss: 3.2175 - accuracy1000: 0.4130 - val_loss: 3.4401 - val_accuracy1000: 0.3528 - 36s/epoch - 28ms/step
Epoch 18/50
1254/1254 - 35s - loss: 3.2160 - accuracy1000: 0.4136 - val_loss: 3.4449 - val_accuracy1000: 0.3508 - 35s/epoch - 28ms/step
Epoch 19/50
1254/1254 - 35s - loss: 3.2149 - accuracy1000: 0.4150 - val_loss: 3.4445 - val_accuracy1000: 0.3506 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepOF_L2/h1000
Evaluating performance on  test set...
5928/5928 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0535098
{'0': {'precision': 0.44217437747762717, 'recall': 0.7344931193564922, 'f1-score': 0.5520234708392604, 'support': 634025}, '1': {'precision': 0.329464861379755, 'recall': 0.009701457117091462, 'f1-score': 0.01884791649377115, 'support': 316035}, '2': {'precision': 0.42547468945498335, 'recall': 0.3411899039308697, 'f1-score': 0.3786992895525599, 'support': 567508}, 'accuracy': 0.43647533421896084, 'macro avg': {'precision': 0.39903797610412184, 'recall': 0.3617948268014845, 'f1-score': 0.3165235589618638, 'support': 1517568}, 'weighted avg': {'precision': 0.41245751571568595, 'recall': 0.43647533421896084, 'f1-score': 0.376173033961816, 'support': 1517568}}
[[465687   3490 164848]
 [216358   3066  96611]
 [371130   2750 193628]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1360719
{'0': {'precision': 0.35406459581076233, 'recall': 0.7361365481562601, 'f1-score': 0.47815009335994635, 'support': 105926}, '1': {'precision': 0.42369668246445497, 'recall': 0.004200614586563672, 'f1-score': 0.008318755350429896, 'support': 106413}, '2': {'precision': 0.3751805778491172, 'recall': 0.3442790466458615, 'f1-score': 0.3590661859659061, 'support': 108627}, 'accuracy': 0.36085130512266095, 'macro avg': {'precision': 0.38431395204144475, 'recall': 0.361538736462895, 'f1-score': 0.2818450115587608, 'support': 320966}, 'weighted avg': {'precision': 0.38429684788094975, 'recall': 0.36085130512266095, 'f1-score': 0.2820798249199898, 'support': 320966}}
[[77976   260 27690]
 [71374   447 34592]
 [70881   348 37398]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1357865
{'0': {'precision': 0.34489369804730075, 'recall': 0.7392063045313819, 'f1-score': 0.4703396280477431, 'support': 35530}, '1': {'precision': 0.38501742160278746, 'recall': 0.006151020067355062, 'f1-score': 0.012108593814207052, 'support': 35929}, '2': {'precision': 0.3895524225820353, 'recall': 0.3352140283958466, 'f1-score': 0.3603462513169509, 'support': 37752}, 'accuracy': 0.35838880698830705, 'macro avg': {'precision': 0.3731545140773745, 'recall': 0.3601904509981945, 'f1-score': 0.28093149105963366, 'support': 109211}, 'weighted avg': {'precision': 0.3735314857450636, 'recall': 0.35838880698830705, 'f1-score': 0.2815651201014961, 'support': 109211}}
[[26264   153  9113]
 [24990   221 10718]
 [24897   200 12655]]
training model: results/EXC/W7/deepVOL_L2/h10
Epoch 1/50
1254/1254 - 40s - loss: 2.5575 - accuracy10: 0.5500 - val_loss: 2.5890 - val_accuracy10: 0.6327 - 40s/epoch - 32ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.2867 - accuracy10: 0.6140 - val_loss: 2.4454 - val_accuracy10: 0.6613 - 36s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 36s - loss: 2.2244 - accuracy10: 0.6311 - val_loss: 2.3776 - val_accuracy10: 0.6849 - 36s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 35s - loss: 2.1907 - accuracy10: 0.6388 - val_loss: 2.3700 - val_accuracy10: 0.6928 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.1709 - accuracy10: 0.6416 - val_loss: 2.3372 - val_accuracy10: 0.6843 - 36s/epoch - 28ms/step
Epoch 6/50
1254/1254 - 35s - loss: 2.1553 - accuracy10: 0.6441 - val_loss: 2.3372 - val_accuracy10: 0.6853 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.1446 - accuracy10: 0.6453 - val_loss: 2.2795 - val_accuracy10: 0.6883 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 35s - loss: 2.1318 - accuracy10: 0.6466 - val_loss: 2.2911 - val_accuracy10: 0.6944 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 35s - loss: 2.1210 - accuracy10: 0.6470 - val_loss: 2.2704 - val_accuracy10: 0.6821 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 36s - loss: 2.1122 - accuracy10: 0.6479 - val_loss: 2.2584 - val_accuracy10: 0.6857 - 36s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 2.1020 - accuracy10: 0.6491 - val_loss: 2.2484 - val_accuracy10: 0.6953 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.0954 - accuracy10: 0.6497 - val_loss: 2.2207 - val_accuracy10: 0.6824 - 36s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.0870 - accuracy10: 0.6501 - val_loss: 2.2361 - val_accuracy10: 0.6850 - 36s/epoch - 29ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.0809 - accuracy10: 0.6503 - val_loss: 2.2233 - val_accuracy10: 0.6856 - 36s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.0747 - accuracy10: 0.6509 - val_loss: 2.2184 - val_accuracy10: 0.6846 - 36s/epoch - 28ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.0693 - accuracy10: 0.6516 - val_loss: 2.2210 - val_accuracy10: 0.6830 - 36s/epoch - 28ms/step
Epoch 17/50
1254/1254 - 35s - loss: 2.0635 - accuracy10: 0.6518 - val_loss: 2.2164 - val_accuracy10: 0.6826 - 35s/epoch - 28ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.0562 - accuracy10: 0.6528 - val_loss: 2.2223 - val_accuracy10: 0.6872 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 35s - loss: 2.0518 - accuracy10: 0.6530 - val_loss: 2.2437 - val_accuracy10: 0.6873 - 35s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.0496 - accuracy10: 0.6541 - val_loss: 2.2508 - val_accuracy10: 0.6848 - 36s/epoch - 28ms/step
Epoch 21/50
1254/1254 - 36s - loss: 2.0429 - accuracy10: 0.6546 - val_loss: 2.2368 - val_accuracy10: 0.6833 - 36s/epoch - 29ms/step
Epoch 22/50
1254/1254 - 35s - loss: 2.0377 - accuracy10: 0.6548 - val_loss: 2.2117 - val_accuracy10: 0.6831 - 35s/epoch - 28ms/step
Epoch 23/50
1254/1254 - 36s - loss: 2.0339 - accuracy10: 0.6554 - val_loss: 2.2165 - val_accuracy10: 0.6799 - 36s/epoch - 28ms/step
Epoch 24/50
1254/1254 - 36s - loss: 2.0276 - accuracy10: 0.6551 - val_loss: 2.2172 - val_accuracy10: 0.6826 - 36s/epoch - 28ms/step
Epoch 25/50
1254/1254 - 36s - loss: 2.0235 - accuracy10: 0.6562 - val_loss: 2.2368 - val_accuracy10: 0.6795 - 36s/epoch - 28ms/step
Epoch 26/50
1254/1254 - 35s - loss: 2.0188 - accuracy10: 0.6567 - val_loss: 2.2107 - val_accuracy10: 0.6831 - 35s/epoch - 28ms/step
Epoch 27/50
1254/1254 - 35s - loss: 2.0137 - accuracy10: 0.6579 - val_loss: 2.2521 - val_accuracy10: 0.6835 - 35s/epoch - 28ms/step
Epoch 28/50
1254/1254 - 36s - loss: 2.0101 - accuracy10: 0.6575 - val_loss: 2.2348 - val_accuracy10: 0.6770 - 36s/epoch - 29ms/step
Epoch 29/50
1254/1254 - 36s - loss: 2.0069 - accuracy10: 0.6576 - val_loss: 2.2333 - val_accuracy10: 0.6740 - 36s/epoch - 28ms/step
Epoch 30/50
1254/1254 - 35s - loss: 1.9998 - accuracy10: 0.6580 - val_loss: 2.2524 - val_accuracy10: 0.6841 - 35s/epoch - 28ms/step
Epoch 31/50
1254/1254 - 35s - loss: 1.9965 - accuracy10: 0.6580 - val_loss: 2.2443 - val_accuracy10: 0.6821 - 35s/epoch - 28ms/step
Epoch 32/50
1254/1254 - 35s - loss: 1.9950 - accuracy10: 0.6585 - val_loss: 2.2357 - val_accuracy10: 0.6841 - 35s/epoch - 28ms/step
Epoch 33/50
1254/1254 - 35s - loss: 1.9876 - accuracy10: 0.6599 - val_loss: 2.2471 - val_accuracy10: 0.6801 - 35s/epoch - 28ms/step
Epoch 34/50
1254/1254 - 36s - loss: 1.9848 - accuracy10: 0.6598 - val_loss: 2.2536 - val_accuracy10: 0.6812 - 36s/epoch - 29ms/step
Epoch 35/50
1254/1254 - 35s - loss: 1.9818 - accuracy10: 0.6595 - val_loss: 2.2450 - val_accuracy10: 0.6876 - 35s/epoch - 28ms/step
Epoch 36/50
1254/1254 - 35s - loss: 1.9761 - accuracy10: 0.6602 - val_loss: 2.2500 - val_accuracy10: 0.6773 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h10
Evaluating performance on  test set...
5929/5929 - 90s - 90s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.68184423
{'0': {'precision': 0.31046301352571365, 'recall': 0.640670921270945, 'f1-score': 0.41824735217463627, 'support': 176593}, '1': {'precision': 0.8989436022814737, 'recall': 0.7319697493199084, 'f1-score': 0.8069092359426951, 'support': 1166387}, '2': {'precision': 0.4328750018434856, 'recall': 0.5043443895230622, 'f1-score': 0.4658846809096007, 'support': 174593}, 'accuracy': 0.6951579923997067, 'macro avg': {'precision': 0.5474272058835576, 'recall': 0.6256616867046386, 'f1-score': 0.5636804230089774, 'support': 1517573}, 'weighted avg': {'precision': 0.7768447854427348, 'recall': 0.6951579923997067, 'f1-score': 0.7224484105477087, 'support': 1517573}}
[[113138  34373  29082]
 [226345 853760  86282]
 [ 24934  61604  88055]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.67682624
{'0': {'precision': 0.35363963603639637, 'recall': 0.6991351618482827, 'f1-score': 0.4696957120802138, 'support': 40470}, '1': {'precision': 0.8965390105288662, 'recall': 0.7098278141276653, 'f1-score': 0.7923325063189793, 'support': 239799}, '2': {'precision': 0.4510479246981468, 'recall': 0.5663284110174697, 'f1-score': 0.5021568627450981, 'support': 40699}, 'accuracy': 0.6902837666060168, 'macro avg': {'precision': 0.5670755237544699, 'recall': 0.6584304623311392, 'f1-score': 0.5880616937147637, 'support': 320968}, 'weighted avg': {'precision': 0.7715976475645374, 'recall': 0.6902837666060168, 'f1-score': 0.7148575880073215, 'support': 320968}}
[[ 28294   7060   5116]
 [ 46647 170216  22936]
 [  5067  12583  23049]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6805004
{'0': {'precision': 0.32405427199102477, 'recall': 0.7136349598517604, 'f1-score': 0.4457142857142857, 'support': 12952}, '1': {'precision': 0.8987010978815525, 'recall': 0.6989152917408245, 'f1-score': 0.7863163448919677, 'support': 83156}, '2': {'precision': 0.44849544262704455, 'recall': 0.5482713882317026, 'f1-score': 0.49338965008069774, 'support': 13103}, 'accuracy': 0.6825869189001108, 'macro avg': {'precision': 0.5570836041665407, 'recall': 0.6536072132747625, 'f1-score': 0.5751400935623171, 'support': 109211}, 'weighted avg': {'precision': 0.776535103707578, 'recall': 0.6825869189001108, 'f1-score': 0.7107772842425697, 'support': 109211}}
[[ 9243  2229  1480]
 [17683 58119  7354]
 [ 1597  4322  7184]]
training model: results/EXC/W7/deepVOL_L2/h20
Epoch 1/50
1254/1254 - 40s - loss: 2.6937 - accuracy20: 0.5301 - val_loss: 2.6075 - val_accuracy20: 0.6216 - 40s/epoch - 32ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.4248 - accuracy20: 0.5959 - val_loss: 2.6231 - val_accuracy20: 0.6104 - 36s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 2.3617 - accuracy20: 0.6122 - val_loss: 2.5412 - val_accuracy20: 0.6358 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.3349 - accuracy20: 0.6179 - val_loss: 2.5536 - val_accuracy20: 0.6292 - 36s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 35s - loss: 2.3179 - accuracy20: 0.6203 - val_loss: 2.5189 - val_accuracy20: 0.6403 - 35s/epoch - 28ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.3059 - accuracy20: 0.6226 - val_loss: 2.5285 - val_accuracy20: 0.6374 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 35s - loss: 2.2949 - accuracy20: 0.6247 - val_loss: 2.5089 - val_accuracy20: 0.6387 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 2.2859 - accuracy20: 0.6260 - val_loss: 2.5155 - val_accuracy20: 0.6360 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.2777 - accuracy20: 0.6270 - val_loss: 2.5186 - val_accuracy20: 0.6415 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 35s - loss: 2.2672 - accuracy20: 0.6285 - val_loss: 2.5130 - val_accuracy20: 0.6413 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 2.2579 - accuracy20: 0.6289 - val_loss: 2.4802 - val_accuracy20: 0.6458 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 35s - loss: 2.2499 - accuracy20: 0.6295 - val_loss: 2.5052 - val_accuracy20: 0.6426 - 35s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 35s - loss: 2.2398 - accuracy20: 0.6305 - val_loss: 2.5112 - val_accuracy20: 0.6432 - 35s/epoch - 28ms/step
Epoch 14/50
1254/1254 - 35s - loss: 2.2331 - accuracy20: 0.6310 - val_loss: 2.4989 - val_accuracy20: 0.6479 - 35s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 36s - loss: 2.2248 - accuracy20: 0.6322 - val_loss: 2.4901 - val_accuracy20: 0.6503 - 36s/epoch - 28ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.2174 - accuracy20: 0.6321 - val_loss: 2.4994 - val_accuracy20: 0.6506 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 37s - loss: 2.2136 - accuracy20: 0.6328 - val_loss: 2.4890 - val_accuracy20: 0.6510 - 37s/epoch - 29ms/step
Epoch 18/50
1254/1254 - 36s - loss: 2.2080 - accuracy20: 0.6327 - val_loss: 2.4852 - val_accuracy20: 0.6430 - 36s/epoch - 29ms/step
Epoch 19/50
1254/1254 - 35s - loss: 2.2027 - accuracy20: 0.6331 - val_loss: 2.4654 - val_accuracy20: 0.6521 - 35s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.1991 - accuracy20: 0.6339 - val_loss: 2.4786 - val_accuracy20: 0.6452 - 36s/epoch - 29ms/step
Epoch 21/50
1254/1254 - 35s - loss: 2.1915 - accuracy20: 0.6334 - val_loss: 2.4970 - val_accuracy20: 0.6505 - 35s/epoch - 28ms/step
Epoch 22/50
1254/1254 - 36s - loss: 2.1862 - accuracy20: 0.6343 - val_loss: 2.4799 - val_accuracy20: 0.6457 - 36s/epoch - 29ms/step
Epoch 23/50
1254/1254 - 35s - loss: 2.1813 - accuracy20: 0.6357 - val_loss: 2.5017 - val_accuracy20: 0.6494 - 35s/epoch - 28ms/step
Epoch 24/50
1254/1254 - 35s - loss: 2.1778 - accuracy20: 0.6356 - val_loss: 2.4744 - val_accuracy20: 0.6557 - 35s/epoch - 28ms/step
Epoch 25/50
1254/1254 - 36s - loss: 2.1737 - accuracy20: 0.6358 - val_loss: 2.4739 - val_accuracy20: 0.6518 - 36s/epoch - 28ms/step
Epoch 26/50
1254/1254 - 35s - loss: 2.1681 - accuracy20: 0.6371 - val_loss: 2.4826 - val_accuracy20: 0.6475 - 35s/epoch - 28ms/step
Epoch 27/50
1254/1254 - 35s - loss: 2.1641 - accuracy20: 0.6381 - val_loss: 2.4559 - val_accuracy20: 0.6524 - 35s/epoch - 28ms/step
Epoch 28/50
1254/1254 - 35s - loss: 2.1602 - accuracy20: 0.6381 - val_loss: 2.4801 - val_accuracy20: 0.6454 - 35s/epoch - 28ms/step
Epoch 29/50
1254/1254 - 35s - loss: 2.1542 - accuracy20: 0.6392 - val_loss: 2.4859 - val_accuracy20: 0.6477 - 35s/epoch - 28ms/step
Epoch 30/50
1254/1254 - 35s - loss: 2.1521 - accuracy20: 0.6383 - val_loss: 2.4814 - val_accuracy20: 0.6465 - 35s/epoch - 28ms/step
Epoch 31/50
1254/1254 - 36s - loss: 2.1490 - accuracy20: 0.6388 - val_loss: 2.4718 - val_accuracy20: 0.6527 - 36s/epoch - 29ms/step
Epoch 32/50
1254/1254 - 35s - loss: 2.1423 - accuracy20: 0.6394 - val_loss: 2.4711 - val_accuracy20: 0.6491 - 35s/epoch - 28ms/step
Epoch 33/50
1254/1254 - 36s - loss: 2.1397 - accuracy20: 0.6399 - val_loss: 2.4652 - val_accuracy20: 0.6483 - 36s/epoch - 28ms/step
Epoch 34/50
1254/1254 - 36s - loss: 2.1365 - accuracy20: 0.6399 - val_loss: 2.4903 - val_accuracy20: 0.6464 - 36s/epoch - 28ms/step
Epoch 35/50
1254/1254 - 35s - loss: 2.1315 - accuracy20: 0.6402 - val_loss: 2.4777 - val_accuracy20: 0.6493 - 35s/epoch - 28ms/step
Epoch 36/50
1254/1254 - 35s - loss: 2.1263 - accuracy20: 0.6417 - val_loss: 2.4882 - val_accuracy20: 0.6401 - 35s/epoch - 28ms/step
Epoch 37/50
1254/1254 - 35s - loss: 2.1246 - accuracy20: 0.6414 - val_loss: 2.4729 - val_accuracy20: 0.6508 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h20
Evaluating performance on  test set...
5929/5929 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.733754
{'0': {'precision': 0.3780621985530547, 'recall': 0.6445077298616761, 'f1-score': 0.4765718266597002, 'support': 233510}, '1': {'precision': 0.8289929622937388, 'recall': 0.726556785789357, 'f1-score': 0.7744020567241438, 'support': 1051381}, '2': {'precision': 0.5066859232027794, 'recall': 0.4312237302412735, 'f1-score': 0.4659190638712823, 'support': 232682}, 'accuracy': 0.6686498771393534, 'macro avg': {'precision': 0.5712470280165243, 'recall': 0.6007627486307688, 'f1-score': 0.5722976490850421, 'support': 1517573}, 'weighted avg': {'precision': 0.7101901837052624, 'recall': 0.6686498771393534, 'f1-score': 0.6812765354046832, 'support': 1517573}}
[[150499  56147  26864]
 [216667 763888  70826]
 [ 30914 101430 100338]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.73003113
{'0': {'precision': 0.4171099290780142, 'recall': 0.6744527962067888, 'f1-score': 0.5154462523789124, 'support': 54413}, '1': {'precision': 0.8144851629902158, 'recall': 0.7180600932937999, 'f1-score': 0.7632391796915187, 'support': 211804}, '2': {'precision': 0.5432709977299751, 'recall': 0.45896878595824736, 'f1-score': 0.49757440152070176, 'support': 54751}, 'accuracy': 0.6664714239425737, 'macro avg': {'precision': 0.591622029932735, 'recall': 0.6171605584862787, 'f1-score': 0.5920866111970443, 'support': 320968}, 'weighted avg': {'precision': 0.7008550647716143, 'recall': 0.6664714239425737, 'f1-score': 0.6759140606033502, 'support': 320968}}
[[ 36699  12612   5102]
 [ 43692 152088  16024]
 [  7593  22029  25129]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.74334
{'0': {'precision': 0.38282185392904405, 'recall': 0.6895573212258796, 'f1-score': 0.49232140686413556, 'support': 17620}, '1': {'precision': 0.8155634238897446, 'recall': 0.6957010510347816, 'f1-score': 0.7508789369431269, 'support': 73832}, '2': {'precision': 0.5394010488545404, 'recall': 0.4401711808097303, 'f1-score': 0.4847601624755821, 'support': 17759}, 'accuracy': 0.6531576489547756, 'macro avg': {'precision': 0.5792621088911097, 'recall': 0.6084765176901304, 'f1-score': 0.5759868354276149, 'support': 109211}, 'weighted avg': {'precision': 0.700838038342888, 'recall': 0.6531576489547756, 'f1-score': 0.6658894487435779, 'support': 109211}}
[[12150  3905  1565]
 [17357 51365  5110]
 [ 2231  7711  7817]]
training model: results/EXC/W7/deepVOL_L2/h30
Epoch 1/50
1254/1254 - 38s - loss: 2.8075 - accuracy30: 0.5120 - val_loss: 2.7881 - val_accuracy30: 0.5825 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 36s - loss: 2.5537 - accuracy30: 0.5821 - val_loss: 2.7595 - val_accuracy30: 0.5884 - 36s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 2.4959 - accuracy30: 0.5946 - val_loss: 2.7321 - val_accuracy30: 0.5946 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 35s - loss: 2.4693 - accuracy30: 0.6009 - val_loss: 2.7290 - val_accuracy30: 0.5954 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.4482 - accuracy30: 0.6039 - val_loss: 2.7201 - val_accuracy30: 0.5943 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.4351 - accuracy30: 0.6047 - val_loss: 2.6703 - val_accuracy30: 0.6045 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 35s - loss: 2.4211 - accuracy30: 0.6072 - val_loss: 2.6761 - val_accuracy30: 0.6058 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 36s - loss: 2.4107 - accuracy30: 0.6075 - val_loss: 2.6529 - val_accuracy30: 0.6095 - 36s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.4012 - accuracy30: 0.6090 - val_loss: 2.6702 - val_accuracy30: 0.6042 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 35s - loss: 2.3941 - accuracy30: 0.6103 - val_loss: 2.6535 - val_accuracy30: 0.6076 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 36s - loss: 2.3855 - accuracy30: 0.6116 - val_loss: 2.6460 - val_accuracy30: 0.6042 - 36s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 35s - loss: 2.3795 - accuracy30: 0.6124 - val_loss: 2.6625 - val_accuracy30: 0.6076 - 35s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 36s - loss: 2.3756 - accuracy30: 0.6122 - val_loss: 2.6571 - val_accuracy30: 0.6110 - 36s/epoch - 28ms/step
Epoch 14/50
1254/1254 - 36s - loss: 2.3683 - accuracy30: 0.6138 - val_loss: 2.6553 - val_accuracy30: 0.6087 - 36s/epoch - 29ms/step
Epoch 15/50
1254/1254 - 35s - loss: 2.3633 - accuracy30: 0.6140 - val_loss: 2.6509 - val_accuracy30: 0.6104 - 35s/epoch - 28ms/step
Epoch 16/50
1254/1254 - 36s - loss: 2.3585 - accuracy30: 0.6151 - val_loss: 2.6544 - val_accuracy30: 0.6105 - 36s/epoch - 29ms/step
Epoch 17/50
1254/1254 - 35s - loss: 2.3537 - accuracy30: 0.6153 - val_loss: 2.6381 - val_accuracy30: 0.6117 - 35s/epoch - 28ms/step
Epoch 18/50
1254/1254 - 35s - loss: 2.3487 - accuracy30: 0.6160 - val_loss: 2.6489 - val_accuracy30: 0.6127 - 35s/epoch - 28ms/step
Epoch 19/50
1254/1254 - 36s - loss: 2.3447 - accuracy30: 0.6167 - val_loss: 2.6358 - val_accuracy30: 0.6085 - 36s/epoch - 29ms/step
Epoch 20/50
1254/1254 - 35s - loss: 2.3415 - accuracy30: 0.6172 - val_loss: 2.6541 - val_accuracy30: 0.6108 - 35s/epoch - 28ms/step
Epoch 21/50
1254/1254 - 36s - loss: 2.3371 - accuracy30: 0.6174 - val_loss: 2.6572 - val_accuracy30: 0.6089 - 36s/epoch - 29ms/step
Epoch 22/50
1254/1254 - 37s - loss: 2.3304 - accuracy30: 0.6183 - val_loss: 2.6707 - val_accuracy30: 0.6133 - 37s/epoch - 30ms/step
Epoch 23/50
1254/1254 - 36s - loss: 2.3271 - accuracy30: 0.6188 - val_loss: 2.6657 - val_accuracy30: 0.6118 - 36s/epoch - 29ms/step
Epoch 24/50
1254/1254 - 36s - loss: 2.3230 - accuracy30: 0.6194 - val_loss: 2.6863 - val_accuracy30: 0.6065 - 36s/epoch - 28ms/step
Epoch 25/50
1254/1254 - 35s - loss: 2.3194 - accuracy30: 0.6193 - val_loss: 2.6760 - val_accuracy30: 0.6072 - 35s/epoch - 28ms/step
Epoch 26/50
1254/1254 - 36s - loss: 2.3168 - accuracy30: 0.6199 - val_loss: 2.6746 - val_accuracy30: 0.6098 - 36s/epoch - 28ms/step
Epoch 27/50
1254/1254 - 36s - loss: 2.3141 - accuracy30: 0.6202 - val_loss: 2.6578 - val_accuracy30: 0.6101 - 36s/epoch - 29ms/step
Epoch 28/50
1254/1254 - 35s - loss: 2.3085 - accuracy30: 0.6211 - val_loss: 2.6815 - val_accuracy30: 0.6050 - 35s/epoch - 28ms/step
Epoch 29/50
1254/1254 - 37s - loss: 2.3064 - accuracy30: 0.6211 - val_loss: 2.6880 - val_accuracy30: 0.6060 - 37s/epoch - 29ms/step
testing model: results/EXC/W7/deepVOL_L2/h30
Evaluating performance on  test set...
5929/5929 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7764007
{'0': {'precision': 0.4153947763434404, 'recall': 0.6262718431133996, 'f1-score': 0.4994881228620646, 'support': 276174}, '1': {'precision': 0.7712832867359775, 'recall': 0.7175122086363956, 'f1-score': 0.7434267181361314, 'support': 967348}, '2': {'precision': 0.5608326295394704, 'recall': 0.4119306260513554, 'f1-score': 0.47498532632362866, 'support': 274051}, 'accuracy': 0.645724456088768, 'macro avg': {'precision': 0.582503564206296, 'recall': 0.5852382259337169, 'f1-score': 0.5726333891072749, 'support': 1517573}, 'weighted avg': {'precision': 0.6685130301983951, 'recall': 0.645724456088768, 'f1-score': 0.6505572947351956, 'support': 1517573}}
[[172960  77497  25717]
 [210581 694084  62683]
 [ 32834 128327 112890]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8112427
{'0': {'precision': 0.43745040154905884, 'recall': 0.6345914749267064, 'f1-score': 0.5178944994926655, 'support': 65149}, '1': {'precision': 0.735965787116077, 'recall': 0.6868397389717675, 'f1-score': 0.7105546609800678, 'support': 190171}, '2': {'precision': 0.567371687558695, 'recall': 0.4233335364367536, 'f1-score': 0.4848817935967897, 'support': 65648}, 'accuracy': 0.6223392986216695, 'macro avg': {'precision': 0.5802626254079436, 'recall': 0.5815882501117425, 'f1-score': 0.5711103180231744, 'support': 320968}, 'weighted avg': {'precision': 0.640891373772539, 'recall': 0.6223392986216695, 'f1-score': 0.6252919891289168, 'support': 320968}}
[[ 41343  18079   5727]
 [ 44090 130617  15464]
 [  9076  28781  27791]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82620615
{'0': {'precision': 0.40440394400206975, 'recall': 0.6575060759020378, 'f1-score': 0.5007920545360697, 'support': 21396}, '1': {'precision': 0.7345655200174429, 'recall': 0.6606181275170823, 'f1-score': 0.6956321473951715, 'support': 66297}, '2': {'precision': 0.5796905614485508, 'recall': 0.3987359420020448, 'f1-score': 0.4724799691621465, 'support': 21518}, 'accuracy': 0.6084094093085861, 'macro avg': {'precision': 0.5728866751560212, 'recall': 0.5722867151403883, 'f1-score': 0.5563013903644626, 'support': 109211}, 'weighted avg': {'precision': 0.639366900474445, 'recall': 0.6084094093085861, 'f1-score': 0.6134921871527823, 'support': 109211}}
[[14068  5733  1595]
 [17874 43797  4626]
 [ 2845 10093  8580]]
training model: results/EXC/W7/deepVOL_L2/h50
Epoch 1/50
1254/1254 - 39s - loss: 2.9571 - accuracy50: 0.4937 - val_loss: 3.0069 - val_accuracy50: 0.5082 - 39s/epoch - 31ms/step
Epoch 2/50
1254/1254 - 35s - loss: 2.7815 - accuracy50: 0.5417 - val_loss: 2.9890 - val_accuracy50: 0.5240 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 2.7230 - accuracy50: 0.5531 - val_loss: 2.9703 - val_accuracy50: 0.5304 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.6979 - accuracy50: 0.5591 - val_loss: 2.9710 - val_accuracy50: 0.5403 - 36s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 35s - loss: 2.6802 - accuracy50: 0.5639 - val_loss: 2.9409 - val_accuracy50: 0.5397 - 35s/epoch - 28ms/step
Epoch 6/50
1254/1254 - 35s - loss: 2.6686 - accuracy50: 0.5671 - val_loss: 2.9489 - val_accuracy50: 0.5319 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.6579 - accuracy50: 0.5697 - val_loss: 2.9437 - val_accuracy50: 0.5314 - 36s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 2.6489 - accuracy50: 0.5719 - val_loss: 2.9264 - val_accuracy50: 0.5294 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 35s - loss: 2.6378 - accuracy50: 0.5738 - val_loss: 2.9227 - val_accuracy50: 0.5279 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 35s - loss: 2.6291 - accuracy50: 0.5745 - val_loss: 2.9157 - val_accuracy50: 0.5322 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 2.6208 - accuracy50: 0.5756 - val_loss: 2.9240 - val_accuracy50: 0.5292 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 36s - loss: 2.6145 - accuracy50: 0.5766 - val_loss: 2.9244 - val_accuracy50: 0.5311 - 36s/epoch - 29ms/step
Epoch 13/50
1254/1254 - 35s - loss: 2.6071 - accuracy50: 0.5774 - val_loss: 2.9484 - val_accuracy50: 0.5290 - 35s/epoch - 28ms/step
Epoch 14/50
1254/1254 - 35s - loss: 2.6011 - accuracy50: 0.5780 - val_loss: 2.9536 - val_accuracy50: 0.5277 - 35s/epoch - 28ms/step
Epoch 15/50
1254/1254 - 35s - loss: 2.5959 - accuracy50: 0.5788 - val_loss: 2.9306 - val_accuracy50: 0.5350 - 35s/epoch - 28ms/step
Epoch 16/50
1254/1254 - 35s - loss: 2.5908 - accuracy50: 0.5801 - val_loss: 2.9460 - val_accuracy50: 0.5331 - 35s/epoch - 28ms/step
Epoch 17/50
1254/1254 - 35s - loss: 2.5844 - accuracy50: 0.5797 - val_loss: 2.9598 - val_accuracy50: 0.5322 - 35s/epoch - 28ms/step
Epoch 18/50
1254/1254 - 35s - loss: 2.5808 - accuracy50: 0.5804 - val_loss: 2.9755 - val_accuracy50: 0.5271 - 35s/epoch - 28ms/step
Epoch 19/50
1254/1254 - 35s - loss: 2.5765 - accuracy50: 0.5814 - val_loss: 2.9539 - val_accuracy50: 0.5322 - 35s/epoch - 28ms/step
Epoch 20/50
1254/1254 - 36s - loss: 2.5734 - accuracy50: 0.5822 - val_loss: 2.9734 - val_accuracy50: 0.5305 - 36s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h50
Evaluating performance on  test set...
5929/5929 - 84s - 84s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8758677
{'0': {'precision': 0.4283846191718773, 'recall': 0.6283722690362222, 'f1-score': 0.5094549525495817, 'support': 346169}, '1': {'precision': 0.6660663766616981, 'recall': 0.6581010180674511, 'f1-score': 0.6620597400696784, 'support': 831772}, '2': {'precision': 0.6021875482117113, 'recall': 0.33328720497479625, 'f1-score': 0.42908994418172686, 'support': 339632}, 'accuracy': 0.5786265306512438, 'macro avg': {'precision': 0.5655461813484289, 'recall': 0.5399201640261565, 'f1-score': 0.5335348789336624, 'support': 1517573}, 'weighted avg': {'precision': 0.5975534612549138, 'recall': 0.5786265306512438, 'f1-score': 0.5751110104810121, 'support': 1517573}}
[[217523 101942  26704]
 [236308 547390  48074]
 [ 53944 172493 113195]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9245065
{'0': {'precision': 0.4471212134427688, 'recall': 0.6260931164199521, 'f1-score': 0.5216842640885384, 'support': 81876}, '1': {'precision': 0.6059133327173611, 'recall': 0.6306789767262935, 'f1-score': 0.6180481598416663, 'support': 155970}, '2': {'precision': 0.6051985264019648, 'recall': 0.32016794591082987, 'f1-score': 0.41878579971045504, 'support': 83122}, 'accuracy': 0.5490952369083523, 'macro avg': {'precision': 0.5527443575206982, 'recall': 0.5256466796856918, 'f1-score': 0.5195060745468866, 'support': 320968}, 'weighted avg': {'precision': 0.565221800576229, 'recall': 0.5490952369083523, 'f1-score': 0.5418630690304027, 'support': 320968}}
[[51262 24164  6450]
 [46692 98367 10911]
 [16695 39814 26613]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9433927
{'0': {'precision': 0.42074496352480795, 'recall': 0.6375549048316251, 'f1-score': 0.506941412730289, 'support': 27320}, '1': {'precision': 0.5939568555225296, 'recall': 0.6001510880179831, 'f1-score': 0.5970379060048391, 'support': 54273}, '2': {'precision': 0.6159241560043163, 'recall': 0.28934028532116735, 'f1-score': 0.3937229010642491, 'support': 27618}, 'accuracy': 0.5309080587120345, 'macro avg': {'precision': 0.5435419916838846, 'recall': 0.5090154260569252, 'f1-score': 0.4992340732664591, 'support': 109211}, 'weighted avg': {'precision': 0.5561817597476373, 'recall': 0.5309080587120345, 'f1-score': 0.5230839086720619, 'support': 109211}}
[[17418  8060  1842]
 [18560 32572  3141]
 [ 5420 14207  7991]]
training model: results/EXC/W7/deepVOL_L2/h100
Epoch 1/50
1254/1254 - 40s - loss: 3.1531 - accuracy100: 0.4423 - val_loss: 3.1897 - val_accuracy100: 0.4325 - 40s/epoch - 32ms/step
Epoch 2/50
1254/1254 - 35s - loss: 3.0377 - accuracy100: 0.4729 - val_loss: 3.1399 - val_accuracy100: 0.4348 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 36s - loss: 2.9968 - accuracy100: 0.4815 - val_loss: 3.1196 - val_accuracy100: 0.4423 - 36s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 36s - loss: 2.9755 - accuracy100: 0.4889 - val_loss: 3.1256 - val_accuracy100: 0.4446 - 36s/epoch - 29ms/step
Epoch 5/50
1254/1254 - 36s - loss: 2.9616 - accuracy100: 0.4916 - val_loss: 3.1326 - val_accuracy100: 0.4419 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 36s - loss: 2.9527 - accuracy100: 0.4948 - val_loss: 3.1469 - val_accuracy100: 0.4451 - 36s/epoch - 29ms/step
Epoch 7/50
1254/1254 - 36s - loss: 2.9452 - accuracy100: 0.4966 - val_loss: 3.1259 - val_accuracy100: 0.4487 - 36s/epoch - 29ms/step
Epoch 8/50
1254/1254 - 36s - loss: 2.9387 - accuracy100: 0.4984 - val_loss: 3.1382 - val_accuracy100: 0.4460 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 36s - loss: 2.9320 - accuracy100: 0.5006 - val_loss: 3.1363 - val_accuracy100: 0.4449 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 35s - loss: 2.9264 - accuracy100: 0.5030 - val_loss: 3.1398 - val_accuracy100: 0.4466 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 36s - loss: 2.9203 - accuracy100: 0.5036 - val_loss: 3.1377 - val_accuracy100: 0.4471 - 36s/epoch - 29ms/step
Epoch 12/50
1254/1254 - 35s - loss: 2.9178 - accuracy100: 0.5050 - val_loss: 3.1392 - val_accuracy100: 0.4455 - 35s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 35s - loss: 2.9118 - accuracy100: 0.5062 - val_loss: 3.1421 - val_accuracy100: 0.4459 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h100
Evaluating performance on  test set...
5929/5929 - 88s - 88s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9820357
{'0': {'precision': 0.47846065914433117, 'recall': 0.5456240652133094, 'f1-score': 0.5098399452266409, 'support': 463341}, '1': {'precision': 0.4853833641453106, 'recall': 0.6107498951971526, 'f1-score': 0.5408974433638111, 'support': 608285}, '2': {'precision': 0.5573826163112835, 'recall': 0.2797193388451991, 'f1-score': 0.372501093703107, 'support': 445947}, 'accuracy': 0.49359075313016243, 'macro avg': {'precision': 0.5070755465336417, 'recall': 0.4786977664185537, 'f1-score': 0.47441282743118635, 'support': 1517573}, 'weighted avg': {'precision': 0.5044271119240338, 'recall': 0.49359075313016243, 'f1-score': 0.4819308834773894, 'support': 1517573}}
[[252810 170500  40031]
 [177750 371510  59025]
 [ 97822 223385 124740]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0249169
{'0': {'precision': 0.4678714198759603, 'recall': 0.5408018710959412, 'f1-score': 0.5017000877606911, 'support': 105179}, '1': {'precision': 0.4102783725910064, 'recall': 0.5614638956592927, 'f1-score': 0.4741102675187256, 'support': 107494}, '2': {'precision': 0.5644590640478877, 'recall': 0.2725425919940902, 'f1-score': 0.367595775419718, 'support': 108295}, 'accuracy': 0.45721068766979883, 'macro avg': {'precision': 0.48086961883828483, 'recall': 0.45826945291644144, 'f1-score': 0.44780204356637815, 'support': 320968}, 'weighted avg': {'precision': 0.48117197289292785, 'recall': 0.45721068766979883, 'f1-score': 0.4472131400211796, 'support': 320968}}
[[56881 36461 11837]
 [36203 60354 10937]
 [28490 50290 29515]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0409368
{'0': {'precision': 0.45238204833141543, 'recall': 0.5532381997804611, 'f1-score': 0.49775256713809996, 'support': 35529}, '1': {'precision': 0.4021635569670504, 'recall': 0.5395164296746019, 'f1-score': 0.4608228898946938, 'support': 37554}, '2': {'precision': 0.5497041804824133, 'recall': 0.23402900797165632, 'f1-score': 0.3282921431206196, 'support': 36128}, 'accuracy': 0.44292241624012235, 'macro avg': {'precision': 0.4680832619269597, 'recall': 0.4422612124755731, 'f1-score': 0.42895586671780445, 'support': 109211}, 'weighted avg': {'precision': 0.4673086469858906, 'recall': 0.44292241624012235, 'f1-score': 0.4289946279368985, 'support': 109211}}
[[19656 12387  3486]
 [13853 20261  3440]
 [ 9941 17732  8455]]
training model: results/EXC/W7/deepVOL_L2/h200
Epoch 1/50
1254/1254 - 38s - loss: 3.2621 - accuracy200: 0.3947 - val_loss: 3.3026 - val_accuracy200: 0.3732 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 36s - loss: 3.2289 - accuracy200: 0.4036 - val_loss: 3.2865 - val_accuracy200: 0.3781 - 36s/epoch - 29ms/step
Epoch 3/50
1254/1254 - 36s - loss: 3.2156 - accuracy200: 0.4110 - val_loss: 3.3096 - val_accuracy200: 0.3789 - 36s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 35s - loss: 3.2060 - accuracy200: 0.4153 - val_loss: 3.3310 - val_accuracy200: 0.3787 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 36s - loss: 3.1980 - accuracy200: 0.4170 - val_loss: 3.3254 - val_accuracy200: 0.3802 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 35s - loss: 3.1926 - accuracy200: 0.4204 - val_loss: 3.3226 - val_accuracy200: 0.3848 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 35s - loss: 3.1859 - accuracy200: 0.4250 - val_loss: 3.3246 - val_accuracy200: 0.3873 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 36s - loss: 3.1840 - accuracy200: 0.4247 - val_loss: 3.3293 - val_accuracy200: 0.3844 - 36s/epoch - 29ms/step
Epoch 9/50
1254/1254 - 35s - loss: 3.1770 - accuracy200: 0.4288 - val_loss: 3.3475 - val_accuracy200: 0.3831 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 35s - loss: 3.1753 - accuracy200: 0.4282 - val_loss: 3.3521 - val_accuracy200: 0.3829 - 35s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 3.1754 - accuracy200: 0.4276 - val_loss: 3.3506 - val_accuracy200: 0.3818 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 35s - loss: 3.1717 - accuracy200: 0.4298 - val_loss: 3.3445 - val_accuracy200: 0.3819 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h200
Evaluating performance on  test set...
5929/5929 - 80s - 80s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.079683
{'0': {'precision': 0.3941269247621903, 'recall': 0.7647433053953727, 'f1-score': 0.5201720077785945, 'support': 513996}, '1': {'precision': 0.38975326104038976, 'recall': 0.009479651240572907, 'f1-score': 0.01850912021972117, 'support': 523226}, '2': {'precision': 0.40055682973541723, 'recall': 0.4232092782153051, 'f1-score': 0.4115715982009724, 'support': 480351}, 'accuracy': 0.39624057623587133, 'macro avg': {'precision': 0.3948123385126658, 'recall': 0.39914407828375026, 'f1-score': 0.316750908733096, 'support': 1517573}, 'weighted avg': {'precision': 0.39465421189058, 'recall': 0.39624057623587133, 'f1-score': 0.3128347783030441, 'support': 1517573}}
[[393075   3621 117300]
 [331339   4960 186927]
 [272917   4145 203289]]
Evaluating performance on  train set...
1254/1254 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0888174
{'0': {'precision': 0.3720704238846282, 'recall': 0.7725162928160049, 'f1-score': 0.5022432295114779, 'support': 105568}, '1': {'precision': 0.3458401305057096, 'recall': 0.004003550318206712, 'f1-score': 0.007915468767501774, 'support': 105906}, '2': {'precision': 0.4332255979314803, 'recall': 0.3978574168447586, 'f1-score': 0.41478893020200047, 'support': 109494}, 'accuracy': 0.3911293337653598, 'macro avg': {'precision': 0.38371205077393933, 'recall': 0.39145908665965673, 'f1-score': 0.30831587616032674, 'support': 320968}, 'weighted avg': {'precision': 0.3842778064788378, 'recall': 0.3911293337653598, 'f1-score': 0.30930188682951754, 'support': 320968}}
[[81553   325 23690]
 [72180   424 33302]
 [65454   477 43563]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096559
{'0': {'precision': 0.3612142047896238, 'recall': 0.7788072776280324, 'f1-score': 0.49352798313272306, 'support': 35616}, '1': {'precision': 0.3591549295774648, 'recall': 0.005489330785996825, 'f1-score': 0.01081338952055339, 'support': 37163}, '2': {'precision': 0.4223910586462389, 'recall': 0.3692907334211682, 'f1-score': 0.39406010192724505, 'support': 36432}, 'accuracy': 0.37904606678814406, 'macro avg': {'precision': 0.38092006433777587, 'recall': 0.3845291139450658, 'f1-score': 0.29946715819350717, 'support': 109211}, 'weighted avg': {'precision': 0.3809216179164584, 'recall': 0.37904606678814406, 'f1-score': 0.2960850855263735, 'support': 109211}}
[[27738   132  7746]
 [26307   204 10652]
 [22746   232 13454]]
training model: results/EXC/W7/deepVOL_L2/h300
Epoch 1/50
1254/1254 - 38s - loss: 3.2832 - accuracy300: 0.3798 - val_loss: 3.3001 - val_accuracy300: 0.3574 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 35s - loss: 3.2542 - accuracy300: 0.3925 - val_loss: 3.3003 - val_accuracy300: 0.3709 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 36s - loss: 3.2408 - accuracy300: 0.4019 - val_loss: 3.2923 - val_accuracy300: 0.3764 - 36s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 35s - loss: 3.2300 - accuracy300: 0.4092 - val_loss: 3.2990 - val_accuracy300: 0.3748 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 36s - loss: 3.2199 - accuracy300: 0.4136 - val_loss: 3.3042 - val_accuracy300: 0.3788 - 36s/epoch - 29ms/step
Epoch 6/50
1254/1254 - 35s - loss: 3.2121 - accuracy300: 0.4176 - val_loss: 3.3262 - val_accuracy300: 0.3752 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 35s - loss: 3.2055 - accuracy300: 0.4207 - val_loss: 3.3256 - val_accuracy300: 0.3777 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 3.1996 - accuracy300: 0.4226 - val_loss: 3.3322 - val_accuracy300: 0.3761 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 35s - loss: 3.1947 - accuracy300: 0.4253 - val_loss: 3.3422 - val_accuracy300: 0.3740 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 36s - loss: 3.1886 - accuracy300: 0.4298 - val_loss: 3.3500 - val_accuracy300: 0.3757 - 36s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 35s - loss: 3.1819 - accuracy300: 0.4315 - val_loss: 3.3676 - val_accuracy300: 0.3723 - 35s/epoch - 28ms/step
Epoch 12/50
1254/1254 - 35s - loss: 3.1772 - accuracy300: 0.4333 - val_loss: 3.3682 - val_accuracy300: 0.3753 - 35s/epoch - 28ms/step
Epoch 13/50
1254/1254 - 36s - loss: 3.1739 - accuracy300: 0.4349 - val_loss: 3.3626 - val_accuracy300: 0.3726 - 36s/epoch - 29ms/step
testing model: results/EXC/W7/deepVOL_L2/h300
Evaluating performance on  test set...
5929/5929 - 85s - 85s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.088086
{'0': {'precision': 0.3786583740361546, 'recall': 0.6761094658352436, 'f1-score': 0.48544239087691693, 'support': 502111}, '1': {'precision': 0.4073830797820196, 'recall': 0.224263777317055, 'f1-score': 0.2892795784864984, 'support': 550343}, '2': {'precision': 0.3919470809976389, 'recall': 0.26803248200998026, 'f1-score': 0.31835697595730283, 'support': 465119}, 'accuracy': 0.3871780797365267, 'macro avg': {'precision': 0.3926628449386043, 'recall': 0.38946857505409294, 'f1-score': 0.3643596484402394, 'support': 1517573}, 'weighted avg': {'precision': 0.393148135535282, 'recall': 0.3871780797365267, 'f1-score': 0.3630947794200868, 'support': 1517573}}
[[339482  85363  77266]
 [310783 123422 116138]
 [246274  94178 124667]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0962174
{'0': {'precision': 0.36940012368583797, 'recall': 0.7075574508410329, 'f1-score': 0.48538924102064035, 'support': 105525}, '1': {'precision': 0.379205585432588, 'recall': 0.19005106865897484, 'f1-score': 0.2532018773427411, 'support': 105740}, '2': {'precision': 0.43773539059652533, 'recall': 0.26274577723489784, 'f1-score': 0.328383204880633, 'support': 109703}, 'accuracy': 0.38503838388873657, 'macro avg': {'precision': 0.3954470332383171, 'recall': 0.3867847655783019, 'f1-score': 0.35565810774800477, 'support': 320968}, 'weighted avg': {'precision': 0.3959866161430439, 'recall': 0.38503838388873657, 'f1-score': 0.35523444360168177, 'support': 320968}}
[[74665 14346 16514]
 [65134 20096 20510]
 [62326 18553 28824]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0990844
{'0': {'precision': 0.35681723995026937, 'recall': 0.7068965517241379, 'f1-score': 0.4742495180391077, 'support': 35322}, '1': {'precision': 0.38494147116913147, 'recall': 0.2120472336473398, 'f1-score': 0.2734583532954623, 'support': 37685}, '2': {'precision': 0.4359404600811908, 'recall': 0.2224616064523257, 'f1-score': 0.2945920737394612, 'support': 36204}, 'accuracy': 0.37554825063409364, 'macro avg': {'precision': 0.3925663904001972, 'recall': 0.3804684639412678, 'f1-score': 0.34743331502467706, 'support': 109211}, 'weighted avg': {'precision': 0.39275170364992135, 'recall': 0.37554825063409364, 'f1-score': 0.34540596604536455, 'support': 109211}}
[[24969  5778  4575]
 [23848  7991  5846]
 [21160  6990  8054]]
training model: results/EXC/W7/deepVOL_L2/h500
Epoch 1/50
1254/1254 - 38s - loss: 3.2681 - accuracy500: 0.3911 - val_loss: 3.3048 - val_accuracy500: 0.3597 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 35s - loss: 3.2603 - accuracy500: 0.3929 - val_loss: 3.3282 - val_accuracy500: 0.3685 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 35s - loss: 3.2603 - accuracy500: 0.3866 - val_loss: 3.3159 - val_accuracy500: 0.3680 - 35s/epoch - 28ms/step
Epoch 4/50
1254/1254 - 35s - loss: 3.2535 - accuracy500: 0.4001 - val_loss: 3.3206 - val_accuracy500: 0.3662 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 35s - loss: 3.2585 - accuracy500: 0.3887 - val_loss: 3.3211 - val_accuracy500: 0.3641 - 35s/epoch - 28ms/step
Epoch 6/50
1254/1254 - 35s - loss: 3.2518 - accuracy500: 0.3948 - val_loss: 3.3186 - val_accuracy500: 0.3654 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 35s - loss: 3.2439 - accuracy500: 0.3982 - val_loss: 3.3244 - val_accuracy500: 0.3656 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 3.2357 - accuracy500: 0.4069 - val_loss: 3.3423 - val_accuracy500: 0.3654 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 36s - loss: 3.2286 - accuracy500: 0.4114 - val_loss: 3.3421 - val_accuracy500: 0.3643 - 36s/epoch - 29ms/step
Epoch 10/50
1254/1254 - 36s - loss: 3.2173 - accuracy500: 0.4183 - val_loss: 3.3487 - val_accuracy500: 0.3668 - 36s/epoch - 28ms/step
Epoch 11/50
1254/1254 - 35s - loss: 3.2059 - accuracy500: 0.4231 - val_loss: 3.3673 - val_accuracy500: 0.3640 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h500
Evaluating performance on  test set...
5929/5929 - 81s - 81s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0966866
{'0': {'precision': 0.38545660861298314, 'recall': 0.586998900329901, 'f1-score': 0.4653428425258751, 'support': 560168}, '1': {'precision': 0.2855948732237392, 'recall': 0.0022928956027854766, 'f1-score': 0.0045492674569816835, 'support': 447033}, '2': {'precision': 0.3504462698377875, 'recall': 0.453821918130305, 'f1-score': 0.3954904614123684, 'support': 510372}, 'accuracy': 0.36997297658827616, 'macro avg': {'precision': 0.34049925055816993, 'recall': 0.34770457135433047, 'f1-score': 0.28846085713174174, 'support': 1517573}, 'weighted avg': {'precision': 0.34426597872062603, 'recall': 0.36997297658827616, 'f1-score': 0.3061144998382842, 'support': 1517573}}
[[328818   1163 230187]
 [246890   1025 199118]
 [277353   1401 231618]]
Evaluating performance on  train set...
1254/1254 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1053622
{'0': {'precision': 0.35103675620650454, 'recall': 0.6994947819410611, 'f1-score': 0.46747455039560126, 'support': 105499}, '1': {'precision': 0.33053221288515405, 'recall': 0.0011135437113090744, 'f1-score': 0.0022196096872795675, 'support': 105968}, '2': {'precision': 0.36834619705040406, 'recall': 0.37132994219230875, 'f1-score': 0.36983205162604765, 'support': 109501}, 'accuracy': 0.3569670496747339, 'macro avg': {'precision': 0.3499717220473542, 'recall': 0.3573127559482263, 'f1-score': 0.27984207056964283, 'support': 320968}, 'weighted avg': {'precision': 0.3501724196843932, 'recall': 0.3569670496747339, 'f1-score': 0.28055845030230747, 'support': 320968}}
[[73796    99 31604]
 [67727   118 38123]
 [68700   140 40661]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1022813
{'0': {'precision': 0.3494680631442767, 'recall': 0.6773006134969325, 'f1-score': 0.4610482165067318, 'support': 37490}, '1': {'precision': 0.2784090909090909, 'recall': 0.0014938113529662826, 'f1-score': 0.002971678088422585, 'support': 32802}, '2': {'precision': 0.37238838794809764, 'recall': 0.34805621932732084, 'f1-score': 0.35981140846005705, 'support': 38919}, 'accuracy': 0.35698784920932874, 'macro avg': {'precision': 0.33342184733382174, 'recall': 0.3422835480590732, 'f1-score': 0.2746104343517371, 'support': 109211}, 'weighted avg': {'precision': 0.33629319718554856, 'recall': 0.35698784920932874, 'f1-score': 0.28738565554157336, 'support': 109211}}
[[25392    64 12034]
 [21957    49 10796]
 [25310    63 13546]]
training model: results/EXC/W7/deepVOL_L2/h1000
Epoch 1/50
1254/1254 - 38s - loss: 3.2402 - accuracy1000: 0.4108 - val_loss: 3.4145 - val_accuracy1000: 0.3427 - 38s/epoch - 30ms/step
Epoch 2/50
1254/1254 - 35s - loss: 3.2421 - accuracy1000: 0.4040 - val_loss: 3.4232 - val_accuracy1000: 0.3389 - 35s/epoch - 28ms/step
Epoch 3/50
1254/1254 - 37s - loss: 3.2374 - accuracy1000: 0.4073 - val_loss: 3.4542 - val_accuracy1000: 0.3388 - 37s/epoch - 29ms/step
Epoch 4/50
1254/1254 - 35s - loss: 3.2337 - accuracy1000: 0.4078 - val_loss: 3.4287 - val_accuracy1000: 0.3403 - 35s/epoch - 28ms/step
Epoch 5/50
1254/1254 - 35s - loss: 3.2286 - accuracy1000: 0.4077 - val_loss: 3.4312 - val_accuracy1000: 0.3385 - 35s/epoch - 28ms/step
Epoch 6/50
1254/1254 - 35s - loss: 3.2241 - accuracy1000: 0.4118 - val_loss: 3.4405 - val_accuracy1000: 0.3407 - 35s/epoch - 28ms/step
Epoch 7/50
1254/1254 - 35s - loss: 3.2183 - accuracy1000: 0.4146 - val_loss: 3.4418 - val_accuracy1000: 0.3407 - 35s/epoch - 28ms/step
Epoch 8/50
1254/1254 - 35s - loss: 3.2123 - accuracy1000: 0.4178 - val_loss: 3.4622 - val_accuracy1000: 0.3399 - 35s/epoch - 28ms/step
Epoch 9/50
1254/1254 - 35s - loss: 3.2108 - accuracy1000: 0.4184 - val_loss: 3.4756 - val_accuracy1000: 0.3383 - 35s/epoch - 28ms/step
Epoch 10/50
1254/1254 - 36s - loss: 3.2181 - accuracy1000: 0.4140 - val_loss: 3.5009 - val_accuracy1000: 0.3348 - 36s/epoch - 29ms/step
Epoch 11/50
1254/1254 - 35s - loss: 3.2101 - accuracy1000: 0.4191 - val_loss: 3.5318 - val_accuracy1000: 0.3353 - 35s/epoch - 28ms/step
testing model: results/EXC/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
5929/5929 - 80s - 80s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.060867
{'0': {'precision': 0.4229851691223627, 'recall': 0.7312933539003132, 'f1-score': 0.5359646511789202, 'support': 634026}, '1': {'precision': 0.28618968386023297, 'recall': 0.0005442400731559912, 'f1-score': 0.001086414138543068, 'support': 316037}, '2': {'precision': 0.39257104699712225, 'recall': 0.29109443005409597, 'f1-score': 0.33430164025323705, 'support': 567510}, 'accuracy': 0.4144973586114144, 'macro avg': {'precision': 0.3672486333265726, 'recall': 0.3409773413425217, 'f1-score': 0.2904509018569001, 'support': 1517573}, 'weighted avg': {'precision': 0.383123657865189, 'recall': 0.4144973586114144, 'f1-score': 0.3491617173299626, 'support': 1517573}}
[[463659    180 170187]
 [230438    172  85427]
 [402062    249 165199]]
Evaluating performance on  train set...
1254/1254 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1388339
{'0': {'precision': 0.3372366469819152, 'recall': 0.7256617952494241, 'f1-score': 0.460476261794219, 'support': 105924}, '1': {'precision': 0.30337078651685395, 'recall': 0.0002537808649227848, 'f1-score': 0.000507137490608565, 'support': 106391}, '2': {'precision': 0.35360881305606057, 'recall': 0.30251350629987206, 'f1-score': 0.3260716446931142, 'support': 108653}, 'accuracy': 0.34196866977393386, 'macro avg': {'precision': 0.33140541551827657, 'recall': 0.342809694138073, 'f1-score': 0.2623516813259806, 'support': 320968}, 'weighted avg': {'precision': 0.33155340815348305, 'recall': 0.34196866977393386, 'f1-score': 0.2625124773494402, 'support': 320968}}
[[76865    39 29020]
 [75300    27 31064]
 [75761    23 32869]]
Evaluating performance on  val set...
427/427 - 6s - 6s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1376193
{'0': {'precision': 0.33009576936367674, 'recall': 0.7522711292363943, 'f1-score': 0.4588490603261196, 'support': 35555}, '1': {'precision': 0.29411764705882354, 'recall': 0.00027845070030351127, 'f1-score': 0.0005563746626978607, 'support': 35913}, '2': {'precision': 0.3766030764858432, 'recall': 0.2808732745144795, 'f1-score': 0.3217689552601226, 'support': 37743}, 'accuracy': 0.3420717693272656, 'macro avg': {'precision': 0.33360549763611447, 'recall': 0.34447428481705905, 'f1-score': 0.26039146341631336, 'support': 109211}, 'weighted avg': {'precision': 0.3343374939736312, 'recall': 0.3420717693272656, 'f1-score': 0.2607693831348441, 'support': 109211}}
[[26747    10  8798]
 [27153    10  8750]
 [27128    14 10601]]
training model: results/EXC/W7/deepVOL_L3/h10
Epoch 1/50
1254/1254 - 54s - loss: 2.6998 - accuracy10: 0.5261 - val_loss: 2.4797 - val_accuracy10: 0.6426 - 54s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 51s - loss: 2.2836 - accuracy10: 0.6148 - val_loss: 2.3233 - val_accuracy10: 0.6680 - 51s/epoch - 40ms/step
Epoch 3/50
1254/1254 - 51s - loss: 2.1906 - accuracy10: 0.6380 - val_loss: 2.2696 - val_accuracy10: 0.6541 - 51s/epoch - 40ms/step
Epoch 4/50
1254/1254 - 52s - loss: 2.1546 - accuracy10: 0.6437 - val_loss: 2.2120 - val_accuracy10: 0.6702 - 52s/epoch - 41ms/step
Epoch 5/50
1254/1254 - 50s - loss: 2.1343 - accuracy10: 0.6474 - val_loss: 2.2286 - val_accuracy10: 0.6675 - 50s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 51s - loss: 2.1132 - accuracy10: 0.6514 - val_loss: 2.2287 - val_accuracy10: 0.6694 - 51s/epoch - 41ms/step
Epoch 7/50
1254/1254 - 50s - loss: 2.1011 - accuracy10: 0.6532 - val_loss: 2.1857 - val_accuracy10: 0.6622 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 51s - loss: 2.0886 - accuracy10: 0.6541 - val_loss: 2.1758 - val_accuracy10: 0.6688 - 51s/epoch - 41ms/step
Epoch 9/50
1254/1254 - 50s - loss: 2.0795 - accuracy10: 0.6563 - val_loss: 2.1561 - val_accuracy10: 0.6663 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 53s - loss: 2.0705 - accuracy10: 0.6562 - val_loss: 2.1461 - val_accuracy10: 0.6636 - 53s/epoch - 42ms/step
Epoch 11/50
1254/1254 - 50s - loss: 2.0619 - accuracy10: 0.6562 - val_loss: 2.1516 - val_accuracy10: 0.6567 - 50s/epoch - 40ms/step
Epoch 12/50
1254/1254 - 51s - loss: 2.0546 - accuracy10: 0.6564 - val_loss: 2.1586 - val_accuracy10: 0.6546 - 51s/epoch - 41ms/step
Epoch 13/50
1254/1254 - 50s - loss: 2.0484 - accuracy10: 0.6572 - val_loss: 2.1312 - val_accuracy10: 0.6549 - 50s/epoch - 40ms/step
Epoch 14/50
1254/1254 - 53s - loss: 2.0425 - accuracy10: 0.6583 - val_loss: 2.1399 - val_accuracy10: 0.6526 - 53s/epoch - 42ms/step
Epoch 15/50
1254/1254 - 50s - loss: 2.0362 - accuracy10: 0.6583 - val_loss: 2.1467 - val_accuracy10: 0.6592 - 50s/epoch - 40ms/step
Epoch 16/50
1254/1254 - 50s - loss: 2.0333 - accuracy10: 0.6590 - val_loss: 2.1172 - val_accuracy10: 0.6548 - 50s/epoch - 40ms/step
Epoch 17/50
1254/1254 - 50s - loss: 2.0241 - accuracy10: 0.6597 - val_loss: 2.1465 - val_accuracy10: 0.6645 - 50s/epoch - 40ms/step
Epoch 18/50
1254/1254 - 50s - loss: 2.0212 - accuracy10: 0.6591 - val_loss: 2.1430 - val_accuracy10: 0.6685 - 50s/epoch - 40ms/step
Epoch 19/50
1254/1254 - 50s - loss: 2.0159 - accuracy10: 0.6601 - val_loss: 2.1354 - val_accuracy10: 0.6704 - 50s/epoch - 40ms/step
Epoch 20/50
1254/1254 - 50s - loss: 2.0104 - accuracy10: 0.6605 - val_loss: 2.1557 - val_accuracy10: 0.6745 - 50s/epoch - 40ms/step
Epoch 21/50
1254/1254 - 50s - loss: 2.0068 - accuracy10: 0.6605 - val_loss: 2.1518 - val_accuracy10: 0.6689 - 50s/epoch - 40ms/step
Epoch 22/50
1254/1254 - 50s - loss: 2.0015 - accuracy10: 0.6608 - val_loss: 2.1384 - val_accuracy10: 0.6629 - 50s/epoch - 40ms/step
Epoch 23/50
1254/1254 - 50s - loss: 1.9989 - accuracy10: 0.6611 - val_loss: 2.1506 - val_accuracy10: 0.6730 - 50s/epoch - 40ms/step
Epoch 24/50
1254/1254 - 50s - loss: 1.9933 - accuracy10: 0.6618 - val_loss: 2.1614 - val_accuracy10: 0.6745 - 50s/epoch - 40ms/step
Epoch 25/50
1254/1254 - 50s - loss: 1.9879 - accuracy10: 0.6625 - val_loss: 2.1870 - val_accuracy10: 0.6731 - 50s/epoch - 40ms/step
Epoch 26/50
1254/1254 - 50s - loss: 1.9858 - accuracy10: 0.6628 - val_loss: 2.1713 - val_accuracy10: 0.6765 - 50s/epoch - 40ms/step
testing model: results/EXC/W7/deepVOL_L3/h10
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7116609
{'0': {'precision': 0.2936671952145128, 'recall': 0.6638654986324486, 'f1-score': 0.4072038902396665, 'support': 176593}, '1': {'precision': 0.9133178570365639, 'recall': 0.6840516912482735, 'f1-score': 0.7822317952961326, 'support': 1166387}, '2': {'precision': 0.4090051149641299, 'recall': 0.5734078685857967, 'f1-score': 0.4774504310087871, 'support': 174593}, 'accuracy': 0.6689734200595293, 'macro avg': {'precision': 0.5386633890717355, 'recall': 0.6404416861555062, 'f1-score': 0.5556287055148621, 'support': 1517573}, 'weighted avg': {'precision': 0.7831920285592557, 'recall': 0.6689734200595293, 'f1-score': 0.7035271823564868, 'support': 1517573}}
[[117234  27339  32020]
 [255879 797869 112639]
 [ 26094  48386 100113]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7273561
{'0': {'precision': 0.3241518120253094, 'recall': 0.7202866320731406, 'f1-score': 0.44709617552551056, 'support': 40470}, '1': {'precision': 0.9114265561629342, 'recall': 0.6466290518309084, 'f1-score': 0.7565261301347306, 'support': 239799}, '2': {'precision': 0.41792122933460296, 'recall': 0.6254699132656822, 'f1-score': 0.5010530459600434, 'support': 40699}, 'accuracy': 0.6532333441339947, 'macro avg': {'precision': 0.5511665325076156, 'recall': 0.6641285323899104, 'f1-score': 0.5682251172067615, 'support': 320968}, 'weighted avg': {'precision': 0.7748017767711072, 'recall': 0.6532333441339947, 'f1-score': 0.685116739429549, 'support': 320968}}
[[ 29150   5281   6039]
 [ 55322 155061  29416]
 [  5455   9788  25456]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7124699
{'0': {'precision': 0.30323236171969264, 'recall': 0.7373378628783199, 'f1-score': 0.4297349592764253, 'support': 12952}, '1': {'precision': 0.9129906510513348, 'recall': 0.6506084948770985, 'f1-score': 0.7597848526128048, 'support': 83156}, '2': {'precision': 0.42970908499918736, 'recall': 0.6053575517057163, 'f1-score': 0.502629744629618, 'support': 13103}, 'accuracy': 0.655465108826034, 'macro avg': {'precision': 0.5486440325900716, 'recall': 0.6644346364870449, 'f1-score': 0.5640498521729493, 'support': 109211}, 'weighted avg': {'precision': 0.7826921671678, 'recall': 0.655465108826034, 'f1-score': 0.689789068320046, 'support': 109211}}
[[ 9550  1696  1706]
 [20233 54102  8821]
 [ 1711  3460  7932]]
training model: results/EXC/W7/deepVOL_L3/h20
Epoch 1/50
1254/1254 - 54s - loss: 2.8396 - accuracy20: 0.4950 - val_loss: 2.7845 - val_accuracy20: 0.5851 - 54s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 53s - loss: 2.4588 - accuracy20: 0.5987 - val_loss: 2.5518 - val_accuracy20: 0.6289 - 53s/epoch - 43ms/step
Epoch 3/50
1254/1254 - 54s - loss: 2.3507 - accuracy20: 0.6200 - val_loss: 2.5377 - val_accuracy20: 0.6101 - 54s/epoch - 43ms/step
Epoch 4/50
1254/1254 - 53s - loss: 2.3098 - accuracy20: 0.6266 - val_loss: 2.4588 - val_accuracy20: 0.6124 - 53s/epoch - 42ms/step
Epoch 5/50
1254/1254 - 53s - loss: 2.2874 - accuracy20: 0.6287 - val_loss: 2.4251 - val_accuracy20: 0.6202 - 53s/epoch - 42ms/step
Epoch 6/50
1254/1254 - 51s - loss: 2.2694 - accuracy20: 0.6314 - val_loss: 2.4370 - val_accuracy20: 0.6147 - 51s/epoch - 40ms/step
Epoch 7/50
1254/1254 - 50s - loss: 2.2574 - accuracy20: 0.6322 - val_loss: 2.4078 - val_accuracy20: 0.6305 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 50s - loss: 2.2463 - accuracy20: 0.6342 - val_loss: 2.4081 - val_accuracy20: 0.6168 - 50s/epoch - 40ms/step
Epoch 9/50
1254/1254 - 50s - loss: 2.2362 - accuracy20: 0.6360 - val_loss: 2.3713 - val_accuracy20: 0.6223 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 50s - loss: 2.2288 - accuracy20: 0.6366 - val_loss: 2.3793 - val_accuracy20: 0.6240 - 50s/epoch - 40ms/step
Epoch 11/50
1254/1254 - 51s - loss: 2.2187 - accuracy20: 0.6361 - val_loss: 2.3878 - val_accuracy20: 0.6281 - 51s/epoch - 40ms/step
Epoch 12/50
1254/1254 - 52s - loss: 2.2106 - accuracy20: 0.6379 - val_loss: 2.3787 - val_accuracy20: 0.6164 - 52s/epoch - 41ms/step
Epoch 13/50
1254/1254 - 50s - loss: 2.2037 - accuracy20: 0.6378 - val_loss: 2.3548 - val_accuracy20: 0.6257 - 50s/epoch - 40ms/step
Epoch 14/50
1254/1254 - 50s - loss: 2.1963 - accuracy20: 0.6386 - val_loss: 2.3395 - val_accuracy20: 0.6323 - 50s/epoch - 40ms/step
Epoch 15/50
1254/1254 - 50s - loss: 2.1903 - accuracy20: 0.6387 - val_loss: 2.3579 - val_accuracy20: 0.6353 - 50s/epoch - 40ms/step
Epoch 16/50
1254/1254 - 51s - loss: 2.1853 - accuracy20: 0.6385 - val_loss: 2.3381 - val_accuracy20: 0.6352 - 51s/epoch - 40ms/step
Epoch 17/50
1254/1254 - 50s - loss: 2.1796 - accuracy20: 0.6390 - val_loss: 2.3100 - val_accuracy20: 0.6358 - 50s/epoch - 40ms/step
Epoch 18/50
1254/1254 - 50s - loss: 2.1746 - accuracy20: 0.6389 - val_loss: 2.3466 - val_accuracy20: 0.6310 - 50s/epoch - 40ms/step
Epoch 19/50
1254/1254 - 50s - loss: 2.1669 - accuracy20: 0.6395 - val_loss: 2.3193 - val_accuracy20: 0.6388 - 50s/epoch - 40ms/step
Epoch 20/50
1254/1254 - 50s - loss: 2.1647 - accuracy20: 0.6398 - val_loss: 2.3210 - val_accuracy20: 0.6321 - 50s/epoch - 40ms/step
Epoch 21/50
1254/1254 - 52s - loss: 2.1589 - accuracy20: 0.6405 - val_loss: 2.3242 - val_accuracy20: 0.6338 - 52s/epoch - 41ms/step
Epoch 22/50
1254/1254 - 51s - loss: 2.1536 - accuracy20: 0.6405 - val_loss: 2.3069 - val_accuracy20: 0.6319 - 51s/epoch - 41ms/step
Epoch 23/50
1254/1254 - 51s - loss: 2.1496 - accuracy20: 0.6411 - val_loss: 2.3069 - val_accuracy20: 0.6401 - 51s/epoch - 41ms/step
Epoch 24/50
1254/1254 - 51s - loss: 2.1456 - accuracy20: 0.6417 - val_loss: 2.3084 - val_accuracy20: 0.6366 - 51s/epoch - 41ms/step
Epoch 25/50
1254/1254 - 52s - loss: 2.1399 - accuracy20: 0.6419 - val_loss: 2.3402 - val_accuracy20: 0.6405 - 52s/epoch - 41ms/step
Epoch 26/50
1254/1254 - 53s - loss: 2.1360 - accuracy20: 0.6425 - val_loss: 2.3327 - val_accuracy20: 0.6438 - 53s/epoch - 43ms/step
Epoch 27/50
1254/1254 - 54s - loss: 2.1326 - accuracy20: 0.6426 - val_loss: 2.3281 - val_accuracy20: 0.6463 - 54s/epoch - 43ms/step
Epoch 28/50
1254/1254 - 54s - loss: 2.1267 - accuracy20: 0.6430 - val_loss: 2.3317 - val_accuracy20: 0.6398 - 54s/epoch - 43ms/step
Epoch 29/50
1254/1254 - 54s - loss: 2.1272 - accuracy20: 0.6435 - val_loss: 2.3423 - val_accuracy20: 0.6410 - 54s/epoch - 43ms/step
Epoch 30/50
1254/1254 - 54s - loss: 2.1218 - accuracy20: 0.6437 - val_loss: 2.3740 - val_accuracy20: 0.6400 - 54s/epoch - 43ms/step
Epoch 31/50
1254/1254 - 54s - loss: 2.1171 - accuracy20: 0.6451 - val_loss: 2.3573 - val_accuracy20: 0.6434 - 54s/epoch - 43ms/step
Epoch 32/50
1254/1254 - 53s - loss: 2.1136 - accuracy20: 0.6446 - val_loss: 2.3508 - val_accuracy20: 0.6338 - 53s/epoch - 43ms/step
testing model: results/EXC/W7/deepVOL_L3/h20
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7493538
{'0': {'precision': 0.36348816374031345, 'recall': 0.674138152541647, 'f1-score': 0.4723111496491075, 'support': 233510}, '1': {'precision': 0.8554208847123983, 'recall': 0.6722196805915268, 'f1-score': 0.7528351458489673, 'support': 1051381}, '2': {'precision': 0.47931161314052306, 'recall': 0.5320523289296121, 'f1-score': 0.5043068067711272, 'support': 232682}, 'accuracy': 0.6510237069320554, 'macro avg': {'precision': 0.5660735538644116, 'recall': 0.6261367206875953, 'f1-score': 0.5764843674230673, 'support': 1517573}, 'weighted avg': {'precision': 0.7220598752571177, 'recall': 0.6510237069320554, 'f1-score': 0.6715650986446883, 'support': 1517573}}
[[157418  43470  32622]
 [242758 706759 101864]
 [ 32900  75983 123799]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.772351
{'0': {'precision': 0.3886589319576698, 'recall': 0.7006046349218018, 'f1-score': 0.49996393418973245, 'support': 54413}, '1': {'precision': 0.8445911565664275, 'recall': 0.6269475552869634, 'f1-score': 0.7196743878513283, 'support': 211804}, '2': {'precision': 0.48394711992445705, 'recall': 0.5803546967178682, 'f1-score': 0.5277844679384431, 'support': 54751}, 'accuracy': 0.6314866279504499, 'macro avg': {'precision': 0.5723990694828515, 'recall': 0.6359689623088779, 'f1-score': 0.5824742633265013, 'support': 320968}, 'weighted avg': {'precision': 0.7057789952674168, 'recall': 0.6314866279504499, 'f1-score': 0.6496946081840755, 'support': 320968}}
[[ 38122   8997   7294]
 [ 52425 132790  26589]
 [  7539  15437  31775]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.76682836
{'0': {'precision': 0.36703258305913866, 'recall': 0.7153802497162316, 'f1-score': 0.4851528972538152, 'support': 17620}, '1': {'precision': 0.8431620610507672, 'recall': 0.6318804854263734, 'f1-score': 0.7223895387998112, 'support': 73832}, '2': {'precision': 0.49889952398014026, 'recall': 0.5488484711977025, 'f1-score': 0.5226833976833977, 'support': 17759}, 'accuracy': 0.6318502714927984, 'macro avg': {'precision': 0.5696980560300154, 'recall': 0.6320364021134358, 'f1-score': 0.5767419445790081, 'support': 109211}, 'weighted avg': {'precision': 0.710362619620419, 'recall': 0.6318502714927984, 'f1-score': 0.6516394221986735, 'support': 109211}}
[[12605  3037  1978]
 [19367 46653  7812]
 [ 2371  5641  9747]]
training model: results/EXC/W7/deepVOL_L3/h30
Epoch 1/50
1254/1254 - 54s - loss: 2.9882 - accuracy30: 0.4605 - val_loss: 2.9060 - val_accuracy30: 0.5396 - 54s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 51s - loss: 2.6089 - accuracy30: 0.5750 - val_loss: 2.7685 - val_accuracy30: 0.5537 - 51s/epoch - 40ms/step
Epoch 3/50
1254/1254 - 50s - loss: 2.5039 - accuracy30: 0.5948 - val_loss: 2.6527 - val_accuracy30: 0.5784 - 50s/epoch - 40ms/step
Epoch 4/50
1254/1254 - 50s - loss: 2.4613 - accuracy30: 0.6021 - val_loss: 2.5923 - val_accuracy30: 0.5930 - 50s/epoch - 40ms/step
Epoch 5/50
1254/1254 - 50s - loss: 2.4376 - accuracy30: 0.6074 - val_loss: 2.5715 - val_accuracy30: 0.5869 - 50s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 50s - loss: 2.4195 - accuracy30: 0.6089 - val_loss: 2.5588 - val_accuracy30: 0.5935 - 50s/epoch - 40ms/step
Epoch 7/50
1254/1254 - 50s - loss: 2.4063 - accuracy30: 0.6108 - val_loss: 2.5704 - val_accuracy30: 0.5956 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 53s - loss: 2.3937 - accuracy30: 0.6124 - val_loss: 2.5430 - val_accuracy30: 0.5960 - 53s/epoch - 42ms/step
Epoch 9/50
1254/1254 - 50s - loss: 2.3856 - accuracy30: 0.6136 - val_loss: 2.5586 - val_accuracy30: 0.5960 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 50s - loss: 2.3761 - accuracy30: 0.6143 - val_loss: 2.5621 - val_accuracy30: 0.5997 - 50s/epoch - 40ms/step
Epoch 11/50
1254/1254 - 53s - loss: 2.3684 - accuracy30: 0.6148 - val_loss: 2.5638 - val_accuracy30: 0.5954 - 53s/epoch - 42ms/step
Epoch 12/50
1254/1254 - 53s - loss: 2.3600 - accuracy30: 0.6159 - val_loss: 2.5575 - val_accuracy30: 0.5966 - 53s/epoch - 42ms/step
Epoch 13/50
1254/1254 - 54s - loss: 2.3554 - accuracy30: 0.6153 - val_loss: 2.5374 - val_accuracy30: 0.5966 - 54s/epoch - 43ms/step
Epoch 14/50
1254/1254 - 52s - loss: 2.3484 - accuracy30: 0.6161 - val_loss: 2.5184 - val_accuracy30: 0.5971 - 52s/epoch - 41ms/step
Epoch 15/50
1254/1254 - 50s - loss: 2.3417 - accuracy30: 0.6171 - val_loss: 2.5491 - val_accuracy30: 0.5989 - 50s/epoch - 40ms/step
Epoch 16/50
1254/1254 - 50s - loss: 2.3348 - accuracy30: 0.6178 - val_loss: 2.5284 - val_accuracy30: 0.5975 - 50s/epoch - 40ms/step
Epoch 17/50
1254/1254 - 50s - loss: 2.3309 - accuracy30: 0.6184 - val_loss: 2.5446 - val_accuracy30: 0.5910 - 50s/epoch - 40ms/step
Epoch 18/50
1254/1254 - 53s - loss: 2.3250 - accuracy30: 0.6180 - val_loss: 2.5124 - val_accuracy30: 0.5953 - 53s/epoch - 42ms/step
Epoch 19/50
1254/1254 - 53s - loss: 2.3180 - accuracy30: 0.6188 - val_loss: 2.5166 - val_accuracy30: 0.5957 - 53s/epoch - 43ms/step
Epoch 20/50
1254/1254 - 54s - loss: 2.3141 - accuracy30: 0.6197 - val_loss: 2.5113 - val_accuracy30: 0.6028 - 54s/epoch - 43ms/step
Epoch 21/50
1254/1254 - 50s - loss: 2.3071 - accuracy30: 0.6202 - val_loss: 2.5030 - val_accuracy30: 0.6017 - 50s/epoch - 40ms/step
Epoch 22/50
1254/1254 - 51s - loss: 2.3052 - accuracy30: 0.6205 - val_loss: 2.5195 - val_accuracy30: 0.5994 - 51s/epoch - 40ms/step
Epoch 23/50
1254/1254 - 51s - loss: 2.2990 - accuracy30: 0.6209 - val_loss: 2.5332 - val_accuracy30: 0.6013 - 51s/epoch - 41ms/step
Epoch 24/50
1254/1254 - 50s - loss: 2.2938 - accuracy30: 0.6221 - val_loss: 2.5423 - val_accuracy30: 0.6034 - 50s/epoch - 40ms/step
Epoch 25/50
1254/1254 - 51s - loss: 2.2900 - accuracy30: 0.6217 - val_loss: 2.5193 - val_accuracy30: 0.6052 - 51s/epoch - 41ms/step
Epoch 26/50
1254/1254 - 52s - loss: 2.2864 - accuracy30: 0.6216 - val_loss: 2.5101 - val_accuracy30: 0.6086 - 52s/epoch - 41ms/step
Epoch 27/50
1254/1254 - 51s - loss: 2.2817 - accuracy30: 0.6222 - val_loss: 2.5283 - val_accuracy30: 0.5981 - 51s/epoch - 41ms/step
Epoch 28/50
1254/1254 - 50s - loss: 2.2763 - accuracy30: 0.6230 - val_loss: 2.5406 - val_accuracy30: 0.6040 - 50s/epoch - 40ms/step
Epoch 29/50
1254/1254 - 51s - loss: 2.2720 - accuracy30: 0.6229 - val_loss: 2.5486 - val_accuracy30: 0.6044 - 51s/epoch - 40ms/step
Epoch 30/50
1254/1254 - 52s - loss: 2.2669 - accuracy30: 0.6237 - val_loss: 2.5301 - val_accuracy30: 0.6029 - 52s/epoch - 41ms/step
Epoch 31/50
1254/1254 - 50s - loss: 2.2639 - accuracy30: 0.6242 - val_loss: 2.5331 - val_accuracy30: 0.6078 - 50s/epoch - 40ms/step
testing model: results/EXC/W7/deepVOL_L3/h30
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7955928
{'0': {'precision': 0.39816435217243507, 'recall': 0.687066849160312, 'f1-score': 0.5041608213238107, 'support': 276174}, '1': {'precision': 0.8042660622025548, 'recall': 0.6448134487278622, 'f1-score': 0.7157668980229054, 'support': 967348}, '2': {'precision': 0.5081296525119797, 'recall': 0.4921784631327746, 'f1-score': 0.5000268767875381, 'support': 274051}, 'accuracy': 0.6249392945182868, 'macro avg': {'precision': 0.5701866889623233, 'recall': 0.6080195870069829, 'f1-score': 0.5733181987114181, 'support': 1517573}, 'weighted avg': {'precision': 0.6768842407824517, 'recall': 0.6249392945182868, 'f1-score': 0.6382985553561148, 'support': 1517573}}
[[189750  56855  29569]
 [242592 623759 100997]
 [ 44220  94949 134882]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8221911
{'0': {'precision': 0.42500372744893394, 'recall': 0.7000567928901441, 'f1-score': 0.5289079849937087, 'support': 65149}, '1': {'precision': 0.7773198806309507, 'recall': 0.604035315584395, 'f1-score': 0.6798087279699835, 'support': 190171}, '2': {'precision': 0.5143520697035474, 'recall': 0.5161619546673166, 'f1-score': 0.5152554228409375, 'support': 65648}, 'accuracy': 0.6055525784501882, 'macro avg': {'precision': 0.5722252259278107, 'recall': 0.6067513543806186, 'f1-score': 0.5746573786015432, 'support': 320968}, 'weighted avg': {'precision': 0.6520227920881135, 'recall': 0.6055525784501882, 'f1-score': 0.6155231048571719, 'support': 320968}}
[[ 45608  12682   6859]
 [ 50166 114870  25135]
 [ 11538  20225  33885]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.82904065
{'0': {'precision': 0.3975131093920357, 'recall': 0.7156945223406244, 'f1-score': 0.5111318802363229, 'support': 21396}, '1': {'precision': 0.7709202006033472, 'recall': 0.6051706713727619, 'f1-score': 0.678063207706608, 'support': 66297}, '2': {'precision': 0.5488576638421109, 'recall': 0.47560182173064414, 'f1-score': 0.509610596554128, 'support': 21518}, 'accuracy': 0.6012947413722061, 'macro avg': {'precision': 0.572430324612498, 'recall': 0.5988223384813435, 'f1-score': 0.5662685614990196, 'support': 109211}, 'weighted avg': {'precision': 0.6540110999670972, 'recall': 0.6012947413722061, 'f1-score': 0.6121685087355037, 'support': 109211}}
[[15313  4252  1831]
 [19595 40121  6581]
 [ 3614  7670 10234]]
training model: results/EXC/W7/deepVOL_L3/h50
Epoch 1/50
1254/1254 - 54s - loss: 3.1044 - accuracy50: 0.4282 - val_loss: 3.1404 - val_accuracy50: 0.4234 - 54s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 50s - loss: 3.0046 - accuracy50: 0.4382 - val_loss: 3.0944 - val_accuracy50: 0.4772 - 50s/epoch - 40ms/step
Epoch 3/50
1254/1254 - 51s - loss: 2.8360 - accuracy50: 0.5277 - val_loss: 2.9623 - val_accuracy50: 0.5098 - 51s/epoch - 41ms/step
Epoch 4/50
1254/1254 - 50s - loss: 2.7325 - accuracy50: 0.5542 - val_loss: 2.8950 - val_accuracy50: 0.5341 - 50s/epoch - 40ms/step
Epoch 5/50
1254/1254 - 51s - loss: 2.6891 - accuracy50: 0.5623 - val_loss: 2.8405 - val_accuracy50: 0.5366 - 51s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 50s - loss: 2.6662 - accuracy50: 0.5662 - val_loss: 2.8703 - val_accuracy50: 0.5320 - 50s/epoch - 40ms/step
Epoch 7/50
1254/1254 - 50s - loss: 2.6503 - accuracy50: 0.5692 - val_loss: 2.8588 - val_accuracy50: 0.5279 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 50s - loss: 2.6351 - accuracy50: 0.5725 - val_loss: 2.8250 - val_accuracy50: 0.5399 - 50s/epoch - 40ms/step
Epoch 9/50
1254/1254 - 50s - loss: 2.6228 - accuracy50: 0.5741 - val_loss: 2.8417 - val_accuracy50: 0.5400 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 53s - loss: 2.6140 - accuracy50: 0.5760 - val_loss: 2.8174 - val_accuracy50: 0.5457 - 53s/epoch - 43ms/step
Epoch 11/50
1254/1254 - 54s - loss: 2.6069 - accuracy50: 0.5766 - val_loss: 2.8244 - val_accuracy50: 0.5445 - 54s/epoch - 43ms/step
Epoch 12/50
1254/1254 - 51s - loss: 2.5997 - accuracy50: 0.5775 - val_loss: 2.8167 - val_accuracy50: 0.5461 - 51s/epoch - 41ms/step
Epoch 13/50
1254/1254 - 50s - loss: 2.5935 - accuracy50: 0.5781 - val_loss: 2.8182 - val_accuracy50: 0.5486 - 50s/epoch - 40ms/step
Epoch 14/50
1254/1254 - 51s - loss: 2.5888 - accuracy50: 0.5791 - val_loss: 2.8089 - val_accuracy50: 0.5487 - 51s/epoch - 40ms/step
Epoch 15/50
1254/1254 - 50s - loss: 2.5830 - accuracy50: 0.5801 - val_loss: 2.8030 - val_accuracy50: 0.5514 - 50s/epoch - 40ms/step
Epoch 16/50
1254/1254 - 51s - loss: 2.5767 - accuracy50: 0.5811 - val_loss: 2.7843 - val_accuracy50: 0.5526 - 51s/epoch - 40ms/step
Epoch 17/50
1254/1254 - 50s - loss: 2.5740 - accuracy50: 0.5812 - val_loss: 2.7943 - val_accuracy50: 0.5541 - 50s/epoch - 40ms/step
Epoch 18/50
1254/1254 - 51s - loss: 2.5702 - accuracy50: 0.5821 - val_loss: 2.8057 - val_accuracy50: 0.5501 - 51s/epoch - 40ms/step
Epoch 19/50
1254/1254 - 50s - loss: 2.5657 - accuracy50: 0.5831 - val_loss: 2.7865 - val_accuracy50: 0.5512 - 50s/epoch - 40ms/step
Epoch 20/50
1254/1254 - 50s - loss: 2.5617 - accuracy50: 0.5836 - val_loss: 2.7813 - val_accuracy50: 0.5532 - 50s/epoch - 40ms/step
Epoch 21/50
1254/1254 - 50s - loss: 2.5578 - accuracy50: 0.5844 - val_loss: 2.8033 - val_accuracy50: 0.5499 - 50s/epoch - 40ms/step
Epoch 22/50
1254/1254 - 50s - loss: 2.5534 - accuracy50: 0.5848 - val_loss: 2.7974 - val_accuracy50: 0.5460 - 50s/epoch - 40ms/step
Epoch 23/50
1254/1254 - 50s - loss: 2.5490 - accuracy50: 0.5858 - val_loss: 2.7941 - val_accuracy50: 0.5511 - 50s/epoch - 40ms/step
Epoch 24/50
1254/1254 - 50s - loss: 2.5454 - accuracy50: 0.5847 - val_loss: 2.8305 - val_accuracy50: 0.5492 - 50s/epoch - 40ms/step
Epoch 25/50
1254/1254 - 50s - loss: 2.5418 - accuracy50: 0.5863 - val_loss: 2.8385 - val_accuracy50: 0.5488 - 50s/epoch - 40ms/step
Epoch 26/50
1254/1254 - 50s - loss: 2.5382 - accuracy50: 0.5875 - val_loss: 2.8308 - val_accuracy50: 0.5468 - 50s/epoch - 40ms/step
Epoch 27/50
1254/1254 - 51s - loss: 2.5334 - accuracy50: 0.5879 - val_loss: 2.8305 - val_accuracy50: 0.5460 - 51s/epoch - 41ms/step
Epoch 28/50
1254/1254 - 53s - loss: 2.5308 - accuracy50: 0.5888 - val_loss: 2.8284 - val_accuracy50: 0.5466 - 53s/epoch - 42ms/step
Epoch 29/50
1254/1254 - 54s - loss: 2.5266 - accuracy50: 0.5895 - val_loss: 2.8311 - val_accuracy50: 0.5449 - 54s/epoch - 43ms/step
Epoch 30/50
1254/1254 - 51s - loss: 2.5230 - accuracy50: 0.5903 - val_loss: 2.8315 - val_accuracy50: 0.5467 - 51s/epoch - 40ms/step
testing model: results/EXC/W7/deepVOL_L3/h50
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8599969
{'0': {'precision': 0.4431464605186883, 'recall': 0.6249577518495302, 'f1-score': 0.5185782669872309, 'support': 346169}, '1': {'precision': 0.695881297453864, 'recall': 0.6285195943119027, 'f1-score': 0.6604873697748871, 'support': 831772}, '2': {'precision': 0.5442608332973782, 'recall': 0.44569416309417254, 'f1-score': 0.4900705132770868, 'support': 339632}, 'accuracy': 0.5867908825473305, 'macro avg': {'precision': 0.5610961970899768, 'recall': 0.5663905030852018, 'f1-score': 0.5563787166797349, 'support': 1517573}, 'weighted avg': {'precision': 0.6042981398400896, 'recall': 0.5867908825473305, 'f1-score': 0.5899777138908137, 'support': 1517573}}
[[216341  93537  36291]
 [218526 522785  90461]
 [ 53326 134934 151372]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8953973
{'0': {'precision': 0.47342271442929473, 'recall': 0.6098246128291562, 'f1-score': 0.5330358381996562, 'support': 81876}, '1': {'precision': 0.6435385766098872, 'recall': 0.5847342437648265, 'f1-score': 0.6127287630001881, 'support': 155970}, '2': {'precision': 0.5383958581806354, 'recall': 0.47791198479343616, 'f1-score': 0.506354122850624, 'support': 83122}, 'accuracy': 0.5634705017322599, 'macro avg': {'precision': 0.5517857164066058, 'recall': 0.557490280462473, 'f1-score': 0.5507062413501561, 'support': 320968}, 'weighted avg': {'precision': 0.572914466501794, 'recall': 0.5634705017322599, 'f1-score': 0.5648516825763439, 'support': 320968}}
[[49930 21827 10119]
 [40829 91201 23940]
 [14707 28690 39725]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9094748
{'0': {'precision': 0.4426543015823116, 'recall': 0.618484626647145, 'f1-score': 0.5160019544371832, 'support': 27320}, '1': {'precision': 0.6301743565413356, 'recall': 0.5873638825935548, 'f1-score': 0.6080164792721655, 'support': 54273}, '2': {'precision': 0.5716520803794064, 'recall': 0.4233470924759215, 'f1-score': 0.4864471302864513, 'support': 27618}, 'accuracy': 0.5536713334737343, 'macro avg': {'precision': 0.5481602461676846, 'recall': 0.5430652005722071, 'f1-score': 0.5368218546652667, 'support': 109211}, 'weighted avg': {'precision': 0.5684652235371447, 'recall': 0.5536713334737343, 'f1-score': 0.5542550532365174, 'support': 109211}}
[[16897  7634  2789]
 [16423 31878  5972]
 [ 4852 11074 11692]]
training model: results/EXC/W7/deepVOL_L3/h100
Epoch 1/50
1254/1254 - 53s - loss: 3.2206 - accuracy100: 0.4131 - val_loss: 3.2594 - val_accuracy100: 0.4031 - 53s/epoch - 42ms/step
Epoch 2/50
1254/1254 - 53s - loss: 3.1015 - accuracy100: 0.4603 - val_loss: 3.2013 - val_accuracy100: 0.4291 - 53s/epoch - 42ms/step
Epoch 3/50
1254/1254 - 53s - loss: 3.0236 - accuracy100: 0.4803 - val_loss: 3.1552 - val_accuracy100: 0.4455 - 53s/epoch - 42ms/step
Epoch 4/50
1254/1254 - 53s - loss: 2.9843 - accuracy100: 0.4886 - val_loss: 3.1452 - val_accuracy100: 0.4444 - 53s/epoch - 42ms/step
Epoch 5/50
1254/1254 - 54s - loss: 2.9651 - accuracy100: 0.4923 - val_loss: 3.1656 - val_accuracy100: 0.4393 - 54s/epoch - 43ms/step
Epoch 6/50
1254/1254 - 53s - loss: 2.9529 - accuracy100: 0.4949 - val_loss: 3.1419 - val_accuracy100: 0.4464 - 53s/epoch - 43ms/step
Epoch 7/50
1254/1254 - 53s - loss: 2.9452 - accuracy100: 0.4968 - val_loss: 3.1546 - val_accuracy100: 0.4440 - 53s/epoch - 42ms/step
Epoch 8/50
1254/1254 - 54s - loss: 2.9394 - accuracy100: 0.4980 - val_loss: 3.1445 - val_accuracy100: 0.4473 - 54s/epoch - 43ms/step
Epoch 9/50
1254/1254 - 53s - loss: 2.9351 - accuracy100: 0.4992 - val_loss: 3.1463 - val_accuracy100: 0.4473 - 53s/epoch - 43ms/step
Epoch 10/50
1254/1254 - 54s - loss: 2.9282 - accuracy100: 0.5010 - val_loss: 3.1365 - val_accuracy100: 0.4493 - 54s/epoch - 43ms/step
Epoch 11/50
1254/1254 - 53s - loss: 2.9238 - accuracy100: 0.5027 - val_loss: 3.1250 - val_accuracy100: 0.4499 - 53s/epoch - 43ms/step
Epoch 12/50
1254/1254 - 53s - loss: 2.9202 - accuracy100: 0.5040 - val_loss: 3.1460 - val_accuracy100: 0.4482 - 53s/epoch - 43ms/step
Epoch 13/50
1254/1254 - 53s - loss: 2.9169 - accuracy100: 0.5045 - val_loss: 3.1377 - val_accuracy100: 0.4531 - 53s/epoch - 42ms/step
Epoch 14/50
1254/1254 - 53s - loss: 2.9133 - accuracy100: 0.5060 - val_loss: 3.1421 - val_accuracy100: 0.4502 - 53s/epoch - 43ms/step
Epoch 15/50
1254/1254 - 53s - loss: 2.9095 - accuracy100: 0.5076 - val_loss: 3.1341 - val_accuracy100: 0.4512 - 53s/epoch - 42ms/step
Epoch 16/50
1254/1254 - 53s - loss: 2.9036 - accuracy100: 0.5085 - val_loss: 3.1184 - val_accuracy100: 0.4543 - 53s/epoch - 42ms/step
Epoch 17/50
1254/1254 - 54s - loss: 2.8997 - accuracy100: 0.5097 - val_loss: 3.1306 - val_accuracy100: 0.4525 - 54s/epoch - 43ms/step
Epoch 18/50
1254/1254 - 53s - loss: 2.8952 - accuracy100: 0.5108 - val_loss: 3.1355 - val_accuracy100: 0.4515 - 53s/epoch - 42ms/step
Epoch 19/50
1254/1254 - 53s - loss: 2.8911 - accuracy100: 0.5116 - val_loss: 3.1263 - val_accuracy100: 0.4531 - 53s/epoch - 42ms/step
Epoch 20/50
1254/1254 - 53s - loss: 2.8870 - accuracy100: 0.5131 - val_loss: 3.1366 - val_accuracy100: 0.4505 - 53s/epoch - 42ms/step
Epoch 21/50
1254/1254 - 53s - loss: 2.8821 - accuracy100: 0.5146 - val_loss: 3.1231 - val_accuracy100: 0.4538 - 53s/epoch - 42ms/step
Epoch 22/50
1254/1254 - 53s - loss: 2.8774 - accuracy100: 0.5162 - val_loss: 3.1349 - val_accuracy100: 0.4527 - 53s/epoch - 42ms/step
Epoch 23/50
1254/1254 - 53s - loss: 2.8736 - accuracy100: 0.5162 - val_loss: 3.1416 - val_accuracy100: 0.4534 - 53s/epoch - 42ms/step
Epoch 24/50
1254/1254 - 53s - loss: 2.8695 - accuracy100: 0.5180 - val_loss: 3.1676 - val_accuracy100: 0.4462 - 53s/epoch - 42ms/step
Epoch 25/50
1254/1254 - 53s - loss: 2.8646 - accuracy100: 0.5194 - val_loss: 3.1779 - val_accuracy100: 0.4473 - 53s/epoch - 42ms/step
Epoch 26/50
1254/1254 - 53s - loss: 2.8619 - accuracy100: 0.5198 - val_loss: 3.1729 - val_accuracy100: 0.4470 - 53s/epoch - 43ms/step
testing model: results/EXC/W7/deepVOL_L3/h100
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.991207
{'0': {'precision': 0.4717364417144002, 'recall': 0.5893974416250667, 'f1-score': 0.5240436786219033, 'support': 463341}, '1': {'precision': 0.4920767629023284, 'recall': 0.5640990654051966, 'f1-score': 0.5256322567154897, 'support': 608285}, '2': {'precision': 0.5528342773328251, 'recall': 0.29919698977681203, 'f1-score': 0.38826357202719064, 'support': 445947}, 'accuracy': 0.49398019073876515, 'macro avg': {'precision': 0.5055491606498512, 'recall': 0.4842311656023584, 'f1-score': 0.47931316912152794, 'support': 1517573}, 'weighted avg': {'precision': 0.5037204377227165, 'recall': 0.49398019073876515, 'f1-score': 0.4847807087549282, 'support': 1517573}}
[[273092 148049  42200]
 [199429 343133  65723]
 [106387 206134 133426]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0149109
{'0': {'precision': 0.48202906355306424, 'recall': 0.5616805636106067, 'f1-score': 0.5188154809474045, 'support': 105179}, '1': {'precision': 0.41768654622374757, 'recall': 0.5400580497516141, 'f1-score': 0.471054564043476, 'support': 107494}, '2': {'precision': 0.5736427585742654, 'recall': 0.31476060759961216, 'f1-score': 0.4064823482413828, 'support': 108295}, 'accuracy': 0.4711279629121906, 'macro avg': {'precision': 0.49111945611702573, 'recall': 0.4721664069872776, 'f1-score': 0.46545079774408776, 'support': 320968}, 'weighted avg': {'precision': 0.49139096425507633, 'recall': 0.4711279629121906, 'f1-score': 0.46491874168346065, 'support': 320968}}
[[59077 34030 12072]
 [36178 58053 13263]
 [27304 46904 34087]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0409809
{'0': {'precision': 0.46075867336311244, 'recall': 0.5603309972135438, 'f1-score': 0.5056899004267424, 'support': 35529}, '1': {'precision': 0.40516863775733686, 'recall': 0.5172551525802844, 'f1-score': 0.45440190883890663, 'support': 37554}, '2': {'precision': 0.5600465090526549, 'recall': 0.27997674933569533, 'f1-score': 0.3733229991326653, 'support': 36128}, 'accuracy': 0.452774903626924, 'macro avg': {'precision': 0.475324606724368, 'recall': 0.4525209663765078, 'f1-score': 0.44447160279943815, 'support': 109211}, 'weighted avg': {'precision': 0.474488450864028, 'recall': 0.452774903626924, 'f1-score': 0.4442654958700403, 'support': 109211}}
[[19908 11940  3681]
 [13864 19425  4265]
 [ 9435 16578 10115]]
training model: results/EXC/W7/deepVOL_L3/h200
Epoch 1/50
1254/1254 - 53s - loss: 3.2814 - accuracy200: 0.3815 - val_loss: 3.3655 - val_accuracy200: 0.3677 - 53s/epoch - 42ms/step
Epoch 2/50
1254/1254 - 51s - loss: 3.2302 - accuracy200: 0.4061 - val_loss: 3.3159 - val_accuracy200: 0.3764 - 51s/epoch - 40ms/step
Epoch 3/50
1254/1254 - 50s - loss: 3.2134 - accuracy200: 0.4130 - val_loss: 3.3087 - val_accuracy200: 0.3780 - 50s/epoch - 40ms/step
Epoch 4/50
1254/1254 - 50s - loss: 3.2029 - accuracy200: 0.4177 - val_loss: 3.3255 - val_accuracy200: 0.3763 - 50s/epoch - 40ms/step
Epoch 5/50
1254/1254 - 50s - loss: 3.1934 - accuracy200: 0.4227 - val_loss: 3.3298 - val_accuracy200: 0.3772 - 50s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 51s - loss: 3.1873 - accuracy200: 0.4253 - val_loss: 3.3215 - val_accuracy200: 0.3789 - 51s/epoch - 41ms/step
Epoch 7/50
1254/1254 - 50s - loss: 3.1829 - accuracy200: 0.4275 - val_loss: 3.3160 - val_accuracy200: 0.3824 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 51s - loss: 3.1775 - accuracy200: 0.4301 - val_loss: 3.3139 - val_accuracy200: 0.3811 - 51s/epoch - 41ms/step
Epoch 9/50
1254/1254 - 50s - loss: 3.1741 - accuracy200: 0.4310 - val_loss: 3.3068 - val_accuracy200: 0.3819 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 50s - loss: 3.1674 - accuracy200: 0.4344 - val_loss: 3.3151 - val_accuracy200: 0.3829 - 50s/epoch - 40ms/step
Epoch 11/50
1254/1254 - 51s - loss: 3.1636 - accuracy200: 0.4355 - val_loss: 3.3329 - val_accuracy200: 0.3822 - 51s/epoch - 41ms/step
Epoch 12/50
1254/1254 - 51s - loss: 3.1599 - accuracy200: 0.4365 - val_loss: 3.3240 - val_accuracy200: 0.3823 - 51s/epoch - 40ms/step
Epoch 13/50
1254/1254 - 50s - loss: 3.1544 - accuracy200: 0.4390 - val_loss: 3.3391 - val_accuracy200: 0.3833 - 50s/epoch - 40ms/step
Epoch 14/50
1254/1254 - 50s - loss: 3.1497 - accuracy200: 0.4400 - val_loss: 3.3292 - val_accuracy200: 0.3859 - 50s/epoch - 40ms/step
Epoch 15/50
1254/1254 - 51s - loss: 3.1463 - accuracy200: 0.4424 - val_loss: 3.3468 - val_accuracy200: 0.3808 - 51s/epoch - 41ms/step
Epoch 16/50
1254/1254 - 50s - loss: 3.1427 - accuracy200: 0.4443 - val_loss: 3.3322 - val_accuracy200: 0.3846 - 50s/epoch - 40ms/step
Epoch 17/50
1254/1254 - 52s - loss: 3.1390 - accuracy200: 0.4454 - val_loss: 3.3236 - val_accuracy200: 0.3872 - 52s/epoch - 41ms/step
Epoch 18/50
1254/1254 - 53s - loss: 3.1320 - accuracy200: 0.4467 - val_loss: 3.3261 - val_accuracy200: 0.3863 - 53s/epoch - 43ms/step
Epoch 19/50
1254/1254 - 51s - loss: 3.1255 - accuracy200: 0.4504 - val_loss: 3.3274 - val_accuracy200: 0.3863 - 51s/epoch - 41ms/step
testing model: results/EXC/W7/deepVOL_L3/h200
Evaluating performance on  test set...
5929/5929 - 112s - 112s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0813216
{'0': {'precision': 0.40568057513238165, 'recall': 0.7251359932762123, 'f1-score': 0.5202852434599137, 'support': 513996}, '1': {'precision': 0.4117935658715511, 'recall': 0.20212298318508637, 'f1-score': 0.2711539349062361, 'support': 523226}, '2': {'precision': 0.4145872927692173, 'recall': 0.29518622840381303, 'f1-score': 0.34484368786943936, 'support': 480351}, 'accuracy': 0.40872234811768526, 'macro avg': {'precision': 0.41068714459105005, 'recall': 0.4074817349550372, 'f1-score': 0.3787609554118631, 'support': 1517573}, 'weighted avg': {'precision': 0.4106074066034636, 'recall': 0.40872234811768526, 'f1-score': 0.3788584358409415, 'support': 1517573}}
[[372717  62001  79278]
 [296531 105756 120939]
 [249497  89061 141793]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.092192
{'0': {'precision': 0.380563098872958, 'recall': 0.7686135950287966, 'f1-score': 0.509070490399365, 'support': 105568}, '1': {'precision': 0.37914815028568133, 'recall': 0.12406284818612733, 'f1-score': 0.1869521912350598, 'support': 105906}, '2': {'precision': 0.45710728991395466, 'recall': 0.30517653935375455, 'f1-score': 0.3660012596182809, 'support': 109494}, 'accuracy': 0.3978433987188754, 'macro avg': {'precision': 0.4056061796908647, 'recall': 0.39928432752289283, 'f1-score': 0.3540079804175686, 'support': 320968}, 'weighted avg': {'precision': 0.4062082663312678, 'recall': 0.3978433987188754, 'f1-score': 0.35397875868019385, 'support': 320968}}
[[81141  8195 16232]
 [69313 13139 23454]
 [62759 13320 33415]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044142
{'0': {'precision': 0.3676914050240834, 'recall': 0.756598158131177, 'f1-score': 0.49488076545182413, 'support': 35616}, '1': {'precision': 0.36843779828189627, 'recall': 0.12464009902322203, 'f1-score': 0.18626721624610434, 'support': 37163}, '2': {'precision': 0.43486639260020554, 'recall': 0.2787384716732543, 'f1-score': 0.3397230028101164, 'support': 36432}, 'accuracy': 0.3821409931234033, 'macro avg': {'precision': 0.39033186530206176, 'recall': 0.3866589096092177, 'f1-score': 0.3402903281693483, 'support': 109211}, 'weighted avg': {'precision': 0.3903544825530263, 'recall': 0.3821409931234033, 'f1-score': 0.3381043149322349, 'support': 109211}}
[[26947  3138  5531]
 [24865  4632  7666]
 [21475  4802 10155]]
training model: results/EXC/W7/deepVOL_L3/h300
Epoch 1/50
1254/1254 - 53s - loss: 3.2985 - accuracy300: 0.3670 - val_loss: 3.3081 - val_accuracy300: 0.3491 - 53s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 50s - loss: 3.2600 - accuracy300: 0.3887 - val_loss: 3.3210 - val_accuracy300: 0.3593 - 50s/epoch - 40ms/step
Epoch 3/50
1254/1254 - 50s - loss: 3.2487 - accuracy300: 0.3956 - val_loss: 3.2992 - val_accuracy300: 0.3566 - 50s/epoch - 40ms/step
Epoch 4/50
1254/1254 - 50s - loss: 3.2405 - accuracy300: 0.4001 - val_loss: 3.3079 - val_accuracy300: 0.3589 - 50s/epoch - 40ms/step
Epoch 5/50
1254/1254 - 50s - loss: 3.2347 - accuracy300: 0.4043 - val_loss: 3.3174 - val_accuracy300: 0.3603 - 50s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 50s - loss: 3.2298 - accuracy300: 0.4071 - val_loss: 3.3287 - val_accuracy300: 0.3607 - 50s/epoch - 40ms/step
Epoch 7/50
1254/1254 - 50s - loss: 3.2239 - accuracy300: 0.4100 - val_loss: 3.3296 - val_accuracy300: 0.3573 - 50s/epoch - 40ms/step
Epoch 8/50
1254/1254 - 50s - loss: 3.2194 - accuracy300: 0.4123 - val_loss: 3.3455 - val_accuracy300: 0.3591 - 50s/epoch - 40ms/step
Epoch 9/50
1254/1254 - 50s - loss: 3.2137 - accuracy300: 0.4165 - val_loss: 3.3524 - val_accuracy300: 0.3598 - 50s/epoch - 40ms/step
Epoch 10/50
1254/1254 - 51s - loss: 3.2098 - accuracy300: 0.4180 - val_loss: 3.3506 - val_accuracy300: 0.3574 - 51s/epoch - 41ms/step
Epoch 11/50
1254/1254 - 51s - loss: 3.2026 - accuracy300: 0.4219 - val_loss: 3.3574 - val_accuracy300: 0.3599 - 51s/epoch - 41ms/step
Epoch 12/50
1254/1254 - 50s - loss: 3.1974 - accuracy300: 0.4237 - val_loss: 3.3403 - val_accuracy300: 0.3646 - 50s/epoch - 40ms/step
Epoch 13/50
1254/1254 - 49s - loss: 3.1880 - accuracy300: 0.4280 - val_loss: 3.3558 - val_accuracy300: 0.3649 - 49s/epoch - 39ms/step
testing model: results/EXC/W7/deepVOL_L3/h300
Evaluating performance on  test set...
5929/5929 - 111s - 111s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0910317
{'0': {'precision': 0.37102125773085204, 'recall': 0.7433814435453515, 'f1-score': 0.4949921923952936, 'support': 502111}, '1': {'precision': 0.3837999806682347, 'recall': 0.08657873362612044, 'f1-score': 0.14128579921748402, 'support': 550343}, '2': {'precision': 0.378589074087937, 'recall': 0.3153214553694861, 'f1-score': 0.3440710372898852, 'support': 465119}, 'accuracy': 0.3739984831042724, 'macro avg': {'precision': 0.3778034374956745, 'recall': 0.38176054418031935, 'f1-score': 0.32678300963422097, 'support': 1517573}, 'weighted avg': {'precision': 0.37797487109490036, 'recall': 0.3739984831042724, 'f1-score': 0.32046606793068616, 'support': 1517573}}
[[373260  34015  94836]
 [356802  47648 145893]
 [275972  42485 146662]]
Evaluating performance on  train set...
1254/1254 - 27s - 27s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0953532
{'0': {'precision': 0.36296101087297294, 'recall': 0.7570054489457475, 'f1-score': 0.4906637347517904, 'support': 105525}, '1': {'precision': 0.33541347483277906, 'recall': 0.08488745980707396, 'f1-score': 0.1354857699187176, 'support': 105740}, '2': {'precision': 0.42483810037776576, 'recall': 0.2870386406935088, 'f1-score': 0.34260130669176325, 'support': 109703}, 'accuracy': 0.3749532663692331, 'macro avg': {'precision': 0.3744041953611726, 'recall': 0.3763105164821101, 'f1-score': 0.3229169371207571, 'support': 320968}, 'weighted avg': {'precision': 0.37503456926214, 'recall': 0.3749532663692331, 'f1-score': 0.3230476155532464, 'support': 320968}}
[[79883  7208 18434]
 [72567  8976 24197]
 [67637 10577 31489]]
Evaluating performance on  val set...
427/427 - 9s - 9s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1009539
{'0': {'precision': 0.34604712041884816, 'recall': 0.7484853632297152, 'f1-score': 0.47328189613504956, 'support': 35322}, '1': {'precision': 0.344187168355041, 'recall': 0.07573305028525938, 'f1-score': 0.12414903103725775, 'support': 37685}, '2': {'precision': 0.3991598352298218, 'recall': 0.27032924538725, 'f1-score': 0.32234902755133965, 'support': 36204}, 'accuracy': 0.35783025519407385, 'macro avg': {'precision': 0.36313137466790363, 'recall': 0.36484921963407485, 'f1-score': 0.30659331824121566, 'support': 109211}, 'weighted avg': {'precision': 0.36301244839397806, 'recall': 0.35783025519407385, 'f1-score': 0.3027730133721876, 'support': 109211}}
[[26438  2204  6680]
 [26779  2854  8052]
 [23183  3234  9787]]
training model: results/EXC/W7/deepVOL_L3/h500
Epoch 1/50
1254/1254 - 54s - loss: 3.2657 - accuracy500: 0.3934 - val_loss: 3.3011 - val_accuracy500: 0.3558 - 54s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 54s - loss: 3.2620 - accuracy500: 0.3955 - val_loss: 3.3087 - val_accuracy500: 0.3622 - 54s/epoch - 43ms/step
Epoch 3/50
1254/1254 - 51s - loss: 3.2532 - accuracy500: 0.4022 - val_loss: 3.3138 - val_accuracy500: 0.3696 - 51s/epoch - 40ms/step
Epoch 4/50
1254/1254 - 50s - loss: 3.2498 - accuracy500: 0.3999 - val_loss: 3.3174 - val_accuracy500: 0.3692 - 50s/epoch - 40ms/step
Epoch 5/50
1254/1254 - 50s - loss: 3.2432 - accuracy500: 0.4017 - val_loss: 3.3611 - val_accuracy500: 0.3627 - 50s/epoch - 40ms/step
Epoch 6/50
1254/1254 - 50s - loss: 3.2337 - accuracy500: 0.4068 - val_loss: 3.3337 - val_accuracy500: 0.3680 - 50s/epoch - 40ms/step
Epoch 7/50
1254/1254 - 49s - loss: 3.2292 - accuracy500: 0.4101 - val_loss: 3.3530 - val_accuracy500: 0.3691 - 49s/epoch - 39ms/step
Epoch 8/50
1254/1254 - 52s - loss: 3.2214 - accuracy500: 0.4138 - val_loss: 3.3515 - val_accuracy500: 0.3691 - 52s/epoch - 41ms/step
Epoch 9/50
1254/1254 - 51s - loss: 3.2118 - accuracy500: 0.4196 - val_loss: 3.3688 - val_accuracy500: 0.3692 - 51s/epoch - 41ms/step
Epoch 10/50
1254/1254 - 52s - loss: 3.2032 - accuracy500: 0.4228 - val_loss: 3.3662 - val_accuracy500: 0.3701 - 52s/epoch - 42ms/step
Epoch 11/50
1254/1254 - 50s - loss: 3.1986 - accuracy500: 0.4254 - val_loss: 3.4137 - val_accuracy500: 0.3622 - 50s/epoch - 40ms/step
testing model: results/EXC/W7/deepVOL_L3/h500
Evaluating performance on  test set...
5929/5929 - 110s - 110s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1005858
{'0': {'precision': 0.36447238563976364, 'recall': 0.7106992902129361, 'f1-score': 0.48183982445587253, 'support': 560168}, '1': {'precision': 0.2895230942546001, 'recall': 0.0017247048875586367, 'f1-score': 0.003428983135273607, 'support': 447033}, '2': {'precision': 0.32409563291498666, 'recall': 0.2683689544097247, 'f1-score': 0.2936114933954134, 'support': 510372}, 'accuracy': 0.3530966879352756, 'macro avg': {'precision': 0.3260303709364501, 'recall': 0.32693098317007313, 'f1-score': 0.25962676699551984, 'support': 1517573}, 'weighted avg': {'precision': 0.3288154711997771, 'recall': 0.3530966879352756, 'f1-score': 0.27761116236972583, 'support': 1517573}}
[[398111    943 161114]
 [321728    771 124534]
 [372455    949 136968]]
Evaluating performance on  train set...
1254/1254 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1069423
{'0': {'precision': 0.3381328725307884, 'recall': 0.730784178049081, 'f1-score': 0.46234112027633595, 'support': 105499}, '1': {'precision': 0.32044198895027626, 'recall': 0.002189340178166994, 'f1-score': 0.0043489671203089265, 'support': 105968}, '2': {'precision': 0.36948696821197796, 'recall': 0.31123003442890934, 'f1-score': 0.33786563694314875, 'support': 109501}, 'accuracy': 0.34710313800752723, 'macro avg': {'precision': 0.34268727656434755, 'recall': 0.3480678508853858, 'f1-score': 0.2681852414465979, 'support': 320968}, 'weighted avg': {'precision': 0.3429889244734313, 'recall': 0.34710313800752723, 'f1-score': 0.2686685348905492, 'support': 320968}}
[[77097   236 28166]
 [75746   232 29990]
 [75165   256 34080]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1015104
{'0': {'precision': 0.3472245809763936, 'recall': 0.7089623899706589, 'f1-score': 0.4661469523049537, 'support': 37490}, '1': {'precision': 0.29545454545454547, 'recall': 0.002774221084080239, 'f1-score': 0.005496828752642706, 'support': 32802}, '2': {'precision': 0.3702249969093831, 'recall': 0.3077931087643567, 'f1-score': 0.33613468958260256, 'support': 38919}, 'accuracy': 0.3538929228740695, 'macro avg': {'precision': 0.3376347077801074, 'recall': 0.3398432399396986, 'f1-score': 0.2692594902133996, 'support': 109211}, 'weighted avg': {'precision': 0.3398717729488905, 'recall': 0.3538929228740695, 'f1-score': 0.28145683312598735, 'support': 109211}}
[[26579   105 10806]
 [23140    91  9571]
 [26828   112 11979]]
training model: results/EXC/W7/deepVOL_L3/h1000
Epoch 1/50
1254/1254 - 53s - loss: 3.2426 - accuracy1000: 0.4086 - val_loss: 3.4223 - val_accuracy1000: 0.3332 - 53s/epoch - 43ms/step
Epoch 2/50
1254/1254 - 53s - loss: 3.2359 - accuracy1000: 0.4063 - val_loss: 3.4287 - val_accuracy1000: 0.3411 - 53s/epoch - 42ms/step
Epoch 3/50
1254/1254 - 53s - loss: 3.2304 - accuracy1000: 0.4146 - val_loss: 3.4351 - val_accuracy1000: 0.3371 - 53s/epoch - 42ms/step
Epoch 4/50
1254/1254 - 54s - loss: 3.2254 - accuracy1000: 0.4103 - val_loss: 3.4399 - val_accuracy1000: 0.3391 - 54s/epoch - 43ms/step
Epoch 5/50
1254/1254 - 54s - loss: 3.2332 - accuracy1000: 0.4091 - val_loss: 3.4269 - val_accuracy1000: 0.3401 - 54s/epoch - 43ms/step
Epoch 6/50
1254/1254 - 55s - loss: 3.2143 - accuracy1000: 0.4191 - val_loss: 3.5008 - val_accuracy1000: 0.3315 - 55s/epoch - 44ms/step
Epoch 7/50
1254/1254 - 54s - loss: 3.2139 - accuracy1000: 0.4219 - val_loss: 3.4723 - val_accuracy1000: 0.3326 - 54s/epoch - 43ms/step
Epoch 8/50
1254/1254 - 54s - loss: 3.2048 - accuracy1000: 0.4249 - val_loss: 3.5167 - val_accuracy1000: 0.3374 - 54s/epoch - 43ms/step
Epoch 9/50
1254/1254 - 53s - loss: 3.1997 - accuracy1000: 0.4285 - val_loss: 3.4922 - val_accuracy1000: 0.3358 - 53s/epoch - 43ms/step
Epoch 10/50
1254/1254 - 54s - loss: 3.1980 - accuracy1000: 0.4306 - val_loss: 3.5027 - val_accuracy1000: 0.3335 - 54s/epoch - 43ms/step
Epoch 11/50
1254/1254 - 55s - loss: 3.1957 - accuracy1000: 0.4290 - val_loss: 3.5359 - val_accuracy1000: 0.3331 - 55s/epoch - 44ms/step
testing model: results/EXC/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
5929/5929 - 108s - 108s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0624601
{'0': {'precision': 0.41478586915817267, 'recall': 0.8315605353723664, 'f1-score': 0.5534890752173881, 'support': 634026}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 316037}, '2': {'precision': 0.3711726258819138, 'recall': 0.16120773202234323, 'f1-score': 0.22478626913565386, 'support': 567510}, 'accuracy': 0.40770229834083765, 'macro avg': {'precision': 0.26198616501336214, 'recall': 0.33092275579823655, 'f1-score': 0.2594251147843473, 'support': 1517573}, 'weighted avg': {'precision': 0.312096487215524, 'recall': 0.40770229834083765, 'f1-score': 0.3153027366729341, 'support': 1517573}}
[[527231      0 106795]
 [267838      0  48199]
 [476023      0  91487]]
Evaluating performance on  train set...
1254/1254 - 23s - 23s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1398017
{'0': {'precision': 0.332038850927461, 'recall': 0.7619897284845738, 'f1-score': 0.4625294048543439, 'support': 105924}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 106391}, '2': {'precision': 0.3695961995249406, 'recall': 0.26493516055700256, 'f1-score': 0.3086341656927811, 'support': 108653}, 'accuracy': 0.3411523890232048, 'macro avg': {'precision': 0.23387835015080052, 'recall': 0.3423082963471921, 'f1-score': 0.25705452351570834, 'support': 320968}, 'weighted avg': {'precision': 0.23469199145280445, 'recall': 0.3411523890232048, 'f1-score': 0.2571190669624675, 'support': 320968}}
[[80713     0 25211]
 [82503     0 23888]
 [79867     0 28786]]
Evaluating performance on  val set...
427/427 - 8s - 8s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1402524
{'0': {'precision': 0.3235227231923781, 'recall': 0.7602306286035719, 'f1-score': 0.4538890381515314, 'support': 35555}, '1': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 35913}, '2': {'precision': 0.361896968279947, 'recall': 0.2460588718437856, 'f1-score': 0.2929421969876193, 'support': 37743}, 'accuracy': 0.33253976247813866, 'macro avg': {'precision': 0.22847323049077506, 'recall': 0.33542983348245253, 'f1-score': 0.24894374504638359, 'support': 109211}, 'weighted avg': {'precision': 0.2303973747781363, 'recall': 0.33253976247813866, 'f1-score': 0.24900918490244953, 'support': 109211}}
[[27030     0  8525]
 [28063     0  7850]
 [28456     0  9287]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        27 (peak)  14.50 (ave)

============================================
