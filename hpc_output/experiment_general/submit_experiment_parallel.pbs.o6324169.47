This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/WBA_orderbooks/WBA_orderbooks_2019-06-26.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-18.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-05.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-06.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-14.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-10.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-12.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-07.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-28.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-11.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-24.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-13.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-04.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-20.csv
data/WBA_orderbooks/WBA_orderbooks_2019-06-19.csv
training model: results/WBA/W4/deepLOB_L1/h10
Epoch 1/50
2108/2108 - 44s - loss: 2.7896 - accuracy10: 0.4833 - val_loss: 3.5447 - val_accuracy10: 0.5021 - 44s/epoch - 21ms/step
Epoch 2/50
2108/2108 - 34s - loss: 2.6878 - accuracy10: 0.4949 - val_loss: 3.0618 - val_accuracy10: 0.5885 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 2.5026 - accuracy10: 0.5763 - val_loss: 3.0808 - val_accuracy10: 0.6151 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 33s - loss: 2.4251 - accuracy10: 0.6029 - val_loss: 3.2802 - val_accuracy10: 0.6506 - 33s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 2.3900 - accuracy10: 0.6125 - val_loss: 3.3540 - val_accuracy10: 0.6521 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 2.3670 - accuracy10: 0.6174 - val_loss: 3.3616 - val_accuracy10: 0.6565 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 34s - loss: 2.3503 - accuracy10: 0.6213 - val_loss: 3.3877 - val_accuracy10: 0.6604 - 34s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 2.3356 - accuracy10: 0.6237 - val_loss: 3.4171 - val_accuracy10: 0.6638 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 2.3261 - accuracy10: 0.6256 - val_loss: 3.4033 - val_accuracy10: 0.6643 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 33s - loss: 2.3155 - accuracy10: 0.6271 - val_loss: 3.4648 - val_accuracy10: 0.6656 - 33s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 35s - loss: 2.3091 - accuracy10: 0.6271 - val_loss: 3.3919 - val_accuracy10: 0.6657 - 35s/epoch - 17ms/step
Epoch 12/50
2108/2108 - 33s - loss: 2.3014 - accuracy10: 0.6288 - val_loss: 3.3799 - val_accuracy10: 0.6660 - 33s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h10
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8437723
{'0': {'precision': 0.3151690464737782, 'recall': 0.5124383972573388, 'f1-score': 0.3902930604684561, 'support': 186680}, '1': {'precision': 0.7667215889516334, 'recall': 0.6233883116898933, 'f1-score': 0.6876654524252697, 'support': 821111}, '2': {'precision': 0.3501835264530469, 'recall': 0.41802767471114916, 'f1-score': 0.38110979132684897, 'support': 189198}, 'accuracy': 0.5736251544500409, 'macro avg': {'precision': 0.47735805395948616, 'recall': 0.5179514612194603, 'f1-score': 0.48635610140685825, 'support': 1196989}, 'weighted avg': {'precision': 0.6304596876489702, 'recall': 0.5736251544500409, 'f1-score': 0.592833172346675, 'support': 1196989}}
[[ 95662  74792  16226]
 [178703 511871 130537]
 [ 29161  80947  79090]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8275063
{'0': {'precision': 0.32795793163891324, 'recall': 0.5431311759036704, 'f1-score': 0.408968900002623, 'support': 86121}, '1': {'precision': 0.7922663122146755, 'recall': 0.6192185626055527, 'f1-score': 0.6951346285065311, 'support': 367707}, '2': {'precision': 0.3739853005704256, 'recall': 0.47803834963368036, 'f1-score': 0.4196581065070548, 'support': 85581}, 'accuracy': 0.5846713718161914, 'macro avg': {'precision': 0.49806984814133815, 'recall': 0.5467960293809678, 'f1-score': 0.507920545005403, 'support': 539409}, 'weighted avg': {'precision': 0.6517725323535836, 'recall': 0.5846713718161914, 'f1-score': 0.6057396889824923, 'support': 539409}}
[[ 46775  29041  10305]
 [ 81840 227691  58176]
 [ 14010  30660  40911]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83248997
{'0': {'precision': 0.34635263103125324, 'recall': 0.5561744555227539, 'f1-score': 0.426873583857039, 'support': 35906}, '1': {'precision': 0.779585193536948, 'recall': 0.6441961635848618, 'f1-score': 0.7054535281727226, 'support': 133093}, '2': {'precision': 0.39998905788379474, 'recall': 0.415468545774848, 'f1-score': 0.40758188153310104, 'support': 35194}, 'accuracy': 0.5892954214884937, 'macro avg': {'precision': 0.5086422941506653, 'recall': 0.5386130549608212, 'f1-score': 0.5133029978542876, 'support': 204193}, 'weighted avg': {'precision': 0.6379782100090771, 'recall': 0.5892954214884937, 'f1-score': 0.6051269439488081, 'support': 204193}}
[[19970 12367  3569]
 [28990 85738 18365]
 [ 8698 11874 14622]]
training model: results/WBA/W4/deepLOB_L1/h20
Epoch 1/50
2108/2108 - 36s - loss: 2.8839 - accuracy20: 0.4911 - val_loss: 3.3643 - val_accuracy20: 0.4131 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 33s - loss: 2.7845 - accuracy20: 0.5070 - val_loss: 3.1621 - val_accuracy20: 0.5591 - 33s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 2.6184 - accuracy20: 0.5721 - val_loss: 3.2199 - val_accuracy20: 0.5959 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 34s - loss: 2.5402 - accuracy20: 0.5984 - val_loss: 3.3146 - val_accuracy20: 0.5980 - 34s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 2.5064 - accuracy20: 0.6076 - val_loss: 3.3097 - val_accuracy20: 0.5992 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 2.4840 - accuracy20: 0.6124 - val_loss: 3.3599 - val_accuracy20: 0.5983 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 33s - loss: 2.4698 - accuracy20: 0.6151 - val_loss: 3.3036 - val_accuracy20: 0.6038 - 33s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 2.4575 - accuracy20: 0.6171 - val_loss: 3.2900 - val_accuracy20: 0.6030 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 35s - loss: 2.4475 - accuracy20: 0.6185 - val_loss: 3.2907 - val_accuracy20: 0.6040 - 35s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 34s - loss: 2.4388 - accuracy20: 0.6194 - val_loss: 3.2674 - val_accuracy20: 0.6054 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 2.4310 - accuracy20: 0.6208 - val_loss: 3.3282 - val_accuracy20: 0.6038 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 34s - loss: 2.4258 - accuracy20: 0.6207 - val_loss: 3.2925 - val_accuracy20: 0.6039 - 34s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h20
Evaluating performance on  test set...
4676/4676 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9063356
{'0': {'precision': 0.3949889619992713, 'recall': 0.4431965754412967, 'f1-score': 0.4177064563288342, 'support': 249492}, '1': {'precision': 0.6703433073051355, 'recall': 0.6111862696188864, 'f1-score': 0.6393994063550245, 'support': 695567}, '2': {'precision': 0.39182926010117974, 'recall': 0.439939665780177, 'f1-score': 0.4144930842400704, 'support': 251930}, 'accuracy': 0.5401294414568555, 'macro avg': {'precision': 0.48572050980186215, 'recall': 0.4981075036134534, 'f1-score': 0.4905329823079763, 'support': 1196989}, 'weighted avg': {'precision': 0.554331589376948, 'recall': 0.5401294414568555, 'f1-score': 0.5458552992509871, 'support': 1196989}}
[[110574 104160  34758]
 [133175 425121 137271]
 [ 36193 104903 110834]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8870713
{'0': {'precision': 0.4150486937020458, 'recall': 0.4133588927384323, 'f1-score': 0.4142020697767655, 'support': 113722}, '1': {'precision': 0.7035217604412808, 'recall': 0.61512506676304, 'f1-score': 0.6563605370790313, 'support': 312673}, '2': {'precision': 0.3962190044774947, 'recall': 0.535579662696657, 'f1-score': 0.45547788003521733, 'support': 113014}, 'accuracy': 0.5559213880376486, 'macro avg': {'precision': 0.5049298195402737, 'recall': 0.5213545407327098, 'f1-score': 0.5086801622970046, 'support': 539409}, 'weighted avg': {'precision': 0.578319459852654, 'recall': 0.5559213880376486, 'f1-score': 0.5632191586042601, 'support': 539409}}
[[ 47008  43758  22956]
 [ 51060 192333  69280]
 [ 15191  37295  60528]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8959748
{'0': {'precision': 0.4177566662077195, 'recall': 0.39099246150211553, 'f1-score': 0.40393170547709645, 'support': 46561}, '1': {'precision': 0.6777132476397567, 'recall': 0.6619706949858852, 'f1-score': 0.6697494763757039, 'support': 111585}, '2': {'precision': 0.43018480492813144, 'recall': 0.48226811735835123, 'f1-score': 0.454739989147017, 'support': 46047}, 'accuracy': 0.559656795286812, 'macro avg': {'precision': 0.5085515729252025, 'recall': 0.511743757948784, 'f1-score': 0.5094737236666058, 'support': 204193}, 'weighted avg': {'precision': 0.5626173305926527, 'recall': 0.559656795286812, 'f1-score': 0.5606503246455791, 'support': 204193}}
[[18205 20058  8298]
 [16602 73866 21117]
 [ 8771 15069 22207]]
training model: results/WBA/W4/deepLOB_L1/h30
Epoch 1/50
2108/2108 - 36s - loss: 2.9724 - accuracy30: 0.4804 - val_loss: 3.3963 - val_accuracy30: 0.4822 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 33s - loss: 2.8723 - accuracy30: 0.5083 - val_loss: 3.3412 - val_accuracy30: 0.5170 - 33s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 2.7185 - accuracy30: 0.5636 - val_loss: 3.2316 - val_accuracy30: 0.5509 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 34s - loss: 2.6496 - accuracy30: 0.5837 - val_loss: 3.2589 - val_accuracy30: 0.5566 - 34s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 2.6109 - accuracy30: 0.5928 - val_loss: 3.2872 - val_accuracy30: 0.5545 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 33s - loss: 2.5900 - accuracy30: 0.5970 - val_loss: 3.2501 - val_accuracy30: 0.5613 - 33s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 34s - loss: 2.5744 - accuracy30: 0.6005 - val_loss: 3.2479 - val_accuracy30: 0.5610 - 34s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 2.5635 - accuracy30: 0.6022 - val_loss: 3.2431 - val_accuracy30: 0.5619 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 2.5547 - accuracy30: 0.6034 - val_loss: 3.2533 - val_accuracy30: 0.5653 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 34s - loss: 2.5467 - accuracy30: 0.6049 - val_loss: 3.2955 - val_accuracy30: 0.5613 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 2.5396 - accuracy30: 0.6056 - val_loss: 3.2480 - val_accuracy30: 0.5660 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 34s - loss: 2.5346 - accuracy30: 0.6064 - val_loss: 3.2682 - val_accuracy30: 0.5660 - 34s/epoch - 16ms/step
Epoch 13/50
2108/2108 - 34s - loss: 2.5293 - accuracy30: 0.6072 - val_loss: 3.2667 - val_accuracy30: 0.5683 - 34s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h30
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93351275
{'0': {'precision': 0.46375073556249113, 'recall': 0.4245341879613372, 'f1-score': 0.44327678366414086, 'support': 293305}, '1': {'precision': 0.5737725540727538, 'recall': 0.8017361048365502, 'f1-score': 0.6688640883281277, 'support': 608719}, '2': {'precision': 0.5451103696098563, 'recall': 0.14400013560930958, 'f1-score': 0.22781822814004318, 'support': 294965}, 'accuracy': 0.5472272510440781, 'macro avg': {'precision': 0.5275445530817003, 'recall': 0.45675680946906566, 'f1-score': 0.4466530333774372, 'support': 1196989}, 'weighted avg': {'precision': 0.539750277578775, 'recall': 0.5472272510440781, 'f1-score': 0.5049035368570206, 'support': 1196989}}
[[124518 157532  11255]
 [ 96497 488032  24190]
 [ 47487 205003  42475]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90861917
{'0': {'precision': 0.4749962963572616, 'recall': 0.435793463815392, 'f1-score': 0.45455118259075195, 'support': 132432}, '1': {'precision': 0.6112093878623347, 'recall': 0.7607030750450503, 'f1-score': 0.6778112648061404, 'support': 275248}, '2': {'precision': 0.4997013419700811, 'recall': 0.2857836922773269, 'f1-score': 0.3636135338491109, 'support': 131729}, 'accuracy': 0.5649534953995947, 'macro avg': {'precision': 0.5286356753965591, 'recall': 0.4940934103792564, 'f1-score': 0.4986586604153344, 'support': 539409}, 'weighted avg': {'precision': 0.5505359183585992, 'recall': 0.5649534953995947, 'f1-score': 0.54626779387928, 'support': 539409}}
[[ 57713  61708  13011]
 [ 41186 209382  24680]
 [ 22603  71480  37646]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9346357
{'0': {'precision': 0.47047036917098445, 'recall': 0.4336106551261006, 'f1-score': 0.4512891201366778, 'support': 53608}, '1': {'precision': 0.5867632093933464, 'recall': 0.7714370986332949, 'f1-score': 0.6665451408957932, 'support': 97168}, '2': {'precision': 0.5250970963565748, 'recall': 0.2657580919931857, 'f1-score': 0.35290608064435935, 'support': 53417}, 'accuracy': 0.5504596141885373, 'macro avg': {'precision': 0.5274435583069685, 'recall': 0.4902686152508604, 'f1-score': 0.49024678055894344, 'support': 204193}, 'weighted avg': {'precision': 0.5401002711989635, 'recall': 0.5504596141885373, 'f1-score': 0.5279845514421612, 'support': 204193}}
[[23245 25777  4586]
 [13956 74959  8253]
 [12207 27014 14196]]
training model: results/WBA/W4/deepLOB_L1/h50
Epoch 1/50
2108/2108 - 36s - loss: 3.0673 - accuracy50: 0.4674 - val_loss: 3.5441 - val_accuracy50: 0.4331 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 34s - loss: 2.9879 - accuracy50: 0.4977 - val_loss: 3.3710 - val_accuracy50: 0.4670 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 33s - loss: 2.8862 - accuracy50: 0.5328 - val_loss: 3.3914 - val_accuracy50: 0.4627 - 33s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 35s - loss: 2.8124 - accuracy50: 0.5505 - val_loss: 3.3270 - val_accuracy50: 0.4798 - 35s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 2.7771 - accuracy50: 0.5571 - val_loss: 3.2927 - val_accuracy50: 0.4906 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 2.7576 - accuracy50: 0.5610 - val_loss: 3.2958 - val_accuracy50: 0.4897 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 35s - loss: 2.7420 - accuracy50: 0.5635 - val_loss: 3.3151 - val_accuracy50: 0.4879 - 35s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 2.7329 - accuracy50: 0.5649 - val_loss: 3.2962 - val_accuracy50: 0.4928 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 2.7227 - accuracy50: 0.5670 - val_loss: 3.3072 - val_accuracy50: 0.4950 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 34s - loss: 2.7153 - accuracy50: 0.5674 - val_loss: 3.3417 - val_accuracy50: 0.4940 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 2.7087 - accuracy50: 0.5689 - val_loss: 3.3406 - val_accuracy50: 0.4950 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 34s - loss: 2.7029 - accuracy50: 0.5691 - val_loss: 3.3582 - val_accuracy50: 0.4971 - 34s/epoch - 16ms/step
Epoch 13/50
2108/2108 - 34s - loss: 2.6985 - accuracy50: 0.5700 - val_loss: 3.3383 - val_accuracy50: 0.4948 - 34s/epoch - 16ms/step
Epoch 14/50
2108/2108 - 34s - loss: 2.6949 - accuracy50: 0.5708 - val_loss: 3.4017 - val_accuracy50: 0.4938 - 34s/epoch - 16ms/step
Epoch 15/50
2108/2108 - 34s - loss: 2.6915 - accuracy50: 0.5711 - val_loss: 3.4078 - val_accuracy50: 0.4940 - 34s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h50
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.025501
{'0': {'precision': 0.5588085856491083, 'recall': 0.3045139016417527, 'f1-score': 0.3942095455451502, 'support': 353951}, '1': {'precision': 0.4626791957899006, 'recall': 0.8689260354302656, 'f1-score': 0.6038336135183145, 'support': 488396}, '2': {'precision': 0.5895080910618512, 'recall': 0.14442733799155205, 'f1-score': 0.23201246580058343, 'support': 354642}, 'accuracy': 0.48737540612319746, 'macro avg': {'precision': 0.5369986241669533, 'recall': 0.43928909168785674, 'f1-score': 0.4100185416213494, 'support': 1196989}, 'weighted avg': {'precision': 0.5286814286818416, 'recall': 0.48737540612319746, 'f1-score': 0.43168496056320715, 'support': 1196989}}
[[107783 227918  18250]
 [ 46600 424380  17416]
 [ 38497 264925  51220]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99691814
{'0': {'precision': 0.5544812906116962, 'recall': 0.31104393567078725, 'f1-score': 0.39852805591454993, 'support': 159119}, '1': {'precision': 0.4865722566680119, 'recall': 0.8338610224144358, 'f1-score': 0.6145462188072491, 'support': 222669}, '2': {'precision': 0.5604586366354977, 'recall': 0.24374924661054048, 'f1-score': 0.3397414357214863, 'support': 157621}, 'accuracy': 0.5071995461699749, 'macro avg': {'precision': 0.533837394638402, 'recall': 0.46288473489858784, 'f1-score': 0.4509385701477618, 'support': 539409}, 'weighted avg': {'precision': 0.5281949634988956, 'recall': 0.5071995461699749, 'f1-score': 0.4705226693742874, 'support': 539409}}
[[ 49493  94997  14629]
 [ 21492 185675  15502]
 [ 18275 100926  38420]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.034621
{'0': {'precision': 0.5206698817150124, 'recall': 0.34203889922138514, 'f1-score': 0.41286087990487513, 'support': 63446}, '1': {'precision': 0.46356890799198064, 'recall': 0.8139190523198421, 'f1-score': 0.5907023439746231, 'support': 76988}, '2': {'precision': 0.5811784499469661, 'recall': 0.249219718000596, 'f1-score': 0.3488474204171241, 'support': 63759}, 'accuracy': 0.49097177670145403, 'macro avg': {'precision': 0.5218057465513197, 'recall': 0.46839255651394107, 'f1-score': 0.45080354809887413, 'support': 204193}, 'weighted avg': {'precision': 0.518034512416909, 'recall': 0.49097177670145403, 'f1-score': 0.4599252967669724, 'support': 204193}}
[[21701 36187  5558]
 [ 8433 62662  5893]
 [11545 36324 15890]]
training model: results/WBA/W4/deepLOB_L1/h100
Epoch 1/50
2108/2108 - 36s - loss: 3.1639 - accuracy100: 0.4404 - val_loss: 3.5931 - val_accuracy100: 0.3301 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 33s - loss: 3.1279 - accuracy100: 0.4557 - val_loss: 3.5180 - val_accuracy100: 0.3464 - 33s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 3.0886 - accuracy100: 0.4699 - val_loss: 3.5460 - val_accuracy100: 0.3474 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 35s - loss: 3.0673 - accuracy100: 0.4763 - val_loss: 3.6534 - val_accuracy100: 0.3544 - 35s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 33s - loss: 3.0459 - accuracy100: 0.4818 - val_loss: 3.6129 - val_accuracy100: 0.3861 - 33s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 33s - loss: 3.0291 - accuracy100: 0.4865 - val_loss: 3.6602 - val_accuracy100: 0.3857 - 33s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 34s - loss: 3.0190 - accuracy100: 0.4890 - val_loss: 3.6666 - val_accuracy100: 0.3874 - 34s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 3.0113 - accuracy100: 0.4910 - val_loss: 3.6800 - val_accuracy100: 0.3958 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 35s - loss: 3.0074 - accuracy100: 0.4914 - val_loss: 3.6803 - val_accuracy100: 0.3904 - 35s/epoch - 17ms/step
Epoch 10/50
2108/2108 - 34s - loss: 3.0028 - accuracy100: 0.4929 - val_loss: 3.6998 - val_accuracy100: 0.3820 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 2.9980 - accuracy100: 0.4938 - val_loss: 3.6568 - val_accuracy100: 0.3891 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 34s - loss: 2.9958 - accuracy100: 0.4944 - val_loss: 3.6901 - val_accuracy100: 0.3864 - 34s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h100
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1339501
{'0': {'precision': 0.4773367244981379, 'recall': 0.2869368173120118, 'f1-score': 0.358420049945048, 'support': 402911}, '1': {'precision': 0.34026331981894653, 'recall': 0.8194569906115199, 'f1-score': 0.4808593133474091, 'support': 394100}, '2': {'precision': 0.5215706990667371, 'recall': 0.007405407297401357, 'f1-score': 0.014603470419590935, 'support': 399978}, 'accuracy': 0.3688588616938, 'macro avg': {'precision': 0.4463902477946072, 'recall': 0.37126640507364445, 'f1-score': 0.28462761123734936, 'support': 1196989}, 'weighted avg': {'precision': 0.4469872291359665, 'recall': 0.3688588616938, 'f1-score': 0.28384479976433397, 'support': 1196989}}
[[115610 286443    858]
 [ 69293 322948   1859]
 [ 57295 339721   2962]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.138411
{'0': {'precision': 0.4768194803428105, 'recall': 0.19218137456479426, 'f1-score': 0.27394829910705565, 'support': 182385}, '1': {'precision': 0.3398877395345556, 'recall': 0.8646121922494532, 'f1-score': 0.4879553345634897, 'support': 178310}, '2': {'precision': 0.4702298757209, 'recall': 0.03239253779782222, 'f1-score': 0.06060986781834837, 'support': 178714}, 'accuracy': 0.36152344510380807, 'macro avg': {'precision': 0.4289790318660887, 'recall': 0.3630620348706899, 'f1-score': 0.2741711671629646, 'support': 539409}, 'weighted avg': {'precision': 0.42937134116841774, 'recall': 0.36152344510380807, 'f1-score': 0.27400953294428626, 'support': 539409}}
[[ 35051 144682   2652]
 [ 20271 154169   3870]
 [ 18188 154737   5789]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1754925
{'0': {'precision': 0.4553195654301654, 'recall': 0.19672685752949634, 'f1-score': 0.2747460429955114, 'support': 70941}, '1': {'precision': 0.3189805669825967, 'recall': 0.8502946764999517, 'f1-score': 0.4639240923367524, 'support': 62102}, '2': {'precision': 0.4846855856982123, 'recall': 0.05449051300070274, 'f1-score': 0.09796712529532906, 'support': 71150}, 'accuracy': 0.3459374219488425, 'macro avg': {'precision': 0.41966190603699144, 'recall': 0.36717068234338357, 'f1-score': 0.27887908687586427, 'support': 204193}, 'weighted avg': {'precision': 0.42408670172024693, 'recall': 0.3459374219488425, 'f1-score': 0.2706837843765665, 'support': 204193}}
[[13956 54752  2233]
 [ 7408 52805  1889]
 [ 9287 57986  3877]]
training model: results/WBA/W4/deepLOB_L1/h200
Epoch 1/50
2108/2108 - 36s - loss: 3.2434 - accuracy200: 0.4010 - val_loss: 3.4397 - val_accuracy200: 0.3451 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 34s - loss: 3.2135 - accuracy200: 0.4143 - val_loss: 3.5093 - val_accuracy200: 0.3599 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 3.2019 - accuracy200: 0.4208 - val_loss: 3.6509 - val_accuracy200: 0.3641 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 34s - loss: 3.1926 - accuracy200: 0.4245 - val_loss: 3.6691 - val_accuracy200: 0.3578 - 34s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 3.1859 - accuracy200: 0.4268 - val_loss: 3.6468 - val_accuracy200: 0.3595 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 35s - loss: 3.1822 - accuracy200: 0.4282 - val_loss: 3.7021 - val_accuracy200: 0.3531 - 35s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 34s - loss: 3.1771 - accuracy200: 0.4306 - val_loss: 3.6793 - val_accuracy200: 0.3548 - 34s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 3.1747 - accuracy200: 0.4314 - val_loss: 3.6837 - val_accuracy200: 0.3521 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 3.1726 - accuracy200: 0.4325 - val_loss: 3.6612 - val_accuracy200: 0.3532 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 35s - loss: 3.1695 - accuracy200: 0.4330 - val_loss: 3.6891 - val_accuracy200: 0.3541 - 35s/epoch - 17ms/step
Epoch 11/50
2108/2108 - 34s - loss: 3.1669 - accuracy200: 0.4341 - val_loss: 3.6160 - val_accuracy200: 0.3575 - 34s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h200
Evaluating performance on  test set...
4676/4676 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1132176
{'0': {'precision': 0.37204594956368436, 'recall': 0.4063760850959775, 'f1-score': 0.38845399982956136, 'support': 392592}, '1': {'precision': 0.35397041551513336, 'recall': 0.6369792281009202, 'f1-score': 0.45506207807417376, 'support': 415417}, '2': {'precision': 0.4213513120240578, 'recall': 0.02233276775155535, 'f1-score': 0.04241730286110494, 'support': 388980}, 'accuracy': 0.3616064976369875, 'macro avg': {'precision': 0.38245589236762517, 'recall': 0.355229360316151, 'f1-score': 0.2953111269216134, 'support': 1196989}, 'weighted avg': {'precision': 0.38179534221640643, 'recall': 0.3616064976369875, 'f1-score': 0.2991204918803254, 'support': 1196989}}
[[159540 227412   5640]
 [144515 264612   6290]
 [124763 255530   8687]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1192994
{'0': {'precision': 0.37166709542501014, 'recall': 0.2489079329087332, 'f1-score': 0.29814570109540434, 'support': 179934}, '1': {'precision': 0.351452231003486, 'recall': 0.7313076843306026, 'f1-score': 0.47474922846341094, 'support': 183217}, '2': {'precision': 0.36195406876410463, 'recall': 0.077346843831202, 'f1-score': 0.1274570756767622, 'support': 176258}, 'accuracy': 0.3567015010873011, 'macro avg': {'precision': 0.3616911317308669, 'recall': 0.3525208203568459, 'f1-score': 0.30011733507852584, 'support': 539409}, 'weighted avg': {'precision': 0.3616270229235942, 'recall': 0.3567015010873011, 'f1-score': 0.30235685206757024, 'support': 539409}}
[[ 44787 122409  12738]
 [ 37935 133988  11294]
 [ 37781 124844  13633]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1442144
{'0': {'precision': 0.38618767420253947, 'recall': 0.19790509442945564, 'f1-score': 0.2616998950682057, 'support': 69311}, '1': {'precision': 0.33197056418642684, 'recall': 0.7812223206377326, 'f1-score': 0.4659440750523727, 'support': 65482}, '2': {'precision': 0.38268386388583975, 'recall': 0.08037463976945244, 'f1-score': 0.13284748023244736, 'support': 69400}, 'accuracy': 0.34502162170103773, 'macro avg': {'precision': 0.36694736742493533, 'recall': 0.3531673516122136, 'f1-score': 0.28683048345100853, 'support': 204193}, 'weighted avg': {'precision': 0.3676101067342421, 'recall': 0.34502162170103773, 'f1-score': 0.2834046538215498, 'support': 204193}}
[[13717 50643  4951]
 [10279 51156  4047]
 [11523 52299  5578]]
training model: results/WBA/W4/deepLOB_L1/h300
Epoch 1/50
2108/2108 - 37s - loss: 3.2727 - accuracy300: 0.3864 - val_loss: 3.4252 - val_accuracy300: 0.3573 - 37s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 34s - loss: 3.2451 - accuracy300: 0.4003 - val_loss: 3.4598 - val_accuracy300: 0.3420 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 34s - loss: 3.2303 - accuracy300: 0.4086 - val_loss: 3.5716 - val_accuracy300: 0.3561 - 34s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 34s - loss: 3.2235 - accuracy300: 0.4126 - val_loss: 3.5525 - val_accuracy300: 0.3520 - 34s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 3.2182 - accuracy300: 0.4160 - val_loss: 3.4810 - val_accuracy300: 0.3483 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 3.2127 - accuracy300: 0.4183 - val_loss: 3.5969 - val_accuracy300: 0.3466 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 35s - loss: 3.2098 - accuracy300: 0.4195 - val_loss: 3.5156 - val_accuracy300: 0.3501 - 35s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 35s - loss: 3.2058 - accuracy300: 0.4220 - val_loss: 3.5252 - val_accuracy300: 0.3517 - 35s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 3.2021 - accuracy300: 0.4234 - val_loss: 3.5647 - val_accuracy300: 0.3517 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 33s - loss: 3.1997 - accuracy300: 0.4245 - val_loss: 3.4973 - val_accuracy300: 0.3517 - 33s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 35s - loss: 3.1965 - accuracy300: 0.4258 - val_loss: 3.4748 - val_accuracy300: 0.3500 - 35s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h300
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.121687
{'0': {'precision': 0.35764475009932806, 'recall': 0.8024359372152696, 'f1-score': 0.4947707575417094, 'support': 406086}, '1': {'precision': 0.32343189515956156, 'recall': 0.23140178984527374, 'f1-score': 0.269784338823333, 'support': 391207}, '2': {'precision': 0.5082845188284519, 'recall': 0.00759827468876346, 'f1-score': 0.01497272420261739, 'support': 399696}, 'accuracy': 0.350396703729107, 'macro avg': {'precision': 0.3964537213624472, 'recall': 0.34714533391643565, 'f1-score': 0.2598426068558866, 'support': 1196989}, 'weighted avg': {'precision': 0.3967644117332567, 'recall': 0.350396703729107, 'f1-score': 0.2610262397215276, 'support': 1196989}}
[[325858  78928   1300]
 [299043  90526   1638]
 [286221 110438   3037]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1321826
{'0': {'precision': 0.3652758598816245, 'recall': 0.40390197580688675, 'f1-score': 0.38361906616480856, 'support': 185342}, '1': {'precision': 0.33760567221161714, 'recall': 0.4521679643339575, 'f1-score': 0.38657777998066967, 'support': 172489}, '2': {'precision': 0.3640414898450414, 'recall': 0.2073984733833394, 'f1-score': 0.2642505043417244, 'support': 181578}, 'accuracy': 0.3531883969307149, 'macro avg': {'precision': 0.355641007312761, 'recall': 0.3544894711747279, 'f1-score': 0.3448157834957342, 'support': 539409}, 'weighted avg': {'precision': 0.35601213338926974, 'recall': 0.3531883969307149, 'f1-score': 0.34438286667364704, 'support': 539409}}
[[74860 76600 33882]
 [62589 77994 31906]
 [67492 76427 37659]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1468291
{'0': {'precision': 0.37793301402313556, 'recall': 0.3063736140508263, 'f1-score': 0.3384117546874758, 'support': 71341}, '1': {'precision': 0.32621565966209576, 'recall': 0.44631022890987676, 'f1-score': 0.37692817261285133, 'support': 62470}, '2': {'precision': 0.3787853905274913, 'recall': 0.32771163081469695, 'f1-score': 0.35140241022593965, 'support': 70382}, 'accuracy': 0.35654013604775875, 'macro avg': {'precision': 0.36097802140424085, 'recall': 0.3601318245918, 'f1-score': 0.35558077917542225, 'support': 204193}, 'weighted avg': {'precision': 0.3624046111699301, 'recall': 0.35654013604775875, 'f1-score': 0.3546729827702523, 'support': 204193}}
[[21857 29117 20367]
 [17129 27881 17460]
 [18847 28470 23065]]
training model: results/WBA/W4/deepLOB_L1/h500
Epoch 1/50
2108/2108 - 38s - loss: 3.2090 - accuracy500: 0.4225 - val_loss: 3.7284 - val_accuracy500: 0.3478 - 38s/epoch - 18ms/step
Epoch 2/50
2108/2108 - 34s - loss: 3.1834 - accuracy500: 0.4354 - val_loss: 3.5008 - val_accuracy500: 0.3538 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 35s - loss: 3.1709 - accuracy500: 0.4383 - val_loss: 3.5200 - val_accuracy500: 0.3367 - 35s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 34s - loss: 3.1641 - accuracy500: 0.4405 - val_loss: 3.5790 - val_accuracy500: 0.3241 - 34s/epoch - 16ms/step
Epoch 5/50
2108/2108 - 34s - loss: 3.1549 - accuracy500: 0.4470 - val_loss: 3.5476 - val_accuracy500: 0.3240 - 34s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 3.1513 - accuracy500: 0.4487 - val_loss: 3.5613 - val_accuracy500: 0.3279 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 34s - loss: 3.1438 - accuracy500: 0.4499 - val_loss: 3.5929 - val_accuracy500: 0.3196 - 34s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 34s - loss: 3.1384 - accuracy500: 0.4499 - val_loss: 3.6255 - val_accuracy500: 0.3204 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 3.1347 - accuracy500: 0.4526 - val_loss: 3.5801 - val_accuracy500: 0.3265 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 34s - loss: 3.1316 - accuracy500: 0.4524 - val_loss: 3.6955 - val_accuracy500: 0.3530 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 3.1251 - accuracy500: 0.4547 - val_loss: 3.6185 - val_accuracy500: 0.3255 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 35s - loss: 3.1200 - accuracy500: 0.4582 - val_loss: 3.6896 - val_accuracy500: 0.3372 - 35s/epoch - 17ms/step
testing model: results/WBA/W4/deepLOB_L1/h500
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1410939
{'0': {'precision': 0.27089909377863763, 'recall': 0.01615223963961776, 'f1-score': 0.030486721860944796, 'support': 329428}, '1': {'precision': 0.45936209359969965, 'recall': 0.9832415134820633, 'f1-score': 0.6261787755555762, 'support': 549990}, '2': {'precision': 0.9834710743801653, 'recall': 0.00037471935409719403, 'f1-score': 0.0007491532679450537, 'support': 317571}, 'accuracy': 0.45632248917909857, 'macro avg': {'precision': 0.5712440872528343, 'recall': 0.3332561574919261, 'f1-score': 0.21913821689482202, 'support': 1196989}, 'weighted avg': {'precision': 0.5465448697408174, 'recall': 0.45632248917909857, 'f1-score': 0.2963044388289895, 'support': 1196989}}
[[  5321 324107      0]
 [  9215 540773      2]
 [  5106 312346    119]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1958954
{'0': {'precision': 0.34343715239154615, 'recall': 0.0068155604487784415, 'f1-score': 0.013365873191954501, 'support': 181203}, '1': {'precision': 0.33931107111565734, 'recall': 0.87572962616406, 'f1-score': 0.48911078966606, 'support': 179544}, '2': {'precision': 0.3576566749968934, 'recall': 0.14498886164937144, 'f1-score': 0.2063332125262357, 'support': 178662}, 'accuracy': 0.3418018609255685, 'macro avg': {'precision': 0.346801632834699, 'recall': 0.34251134942073663, 'f1-score': 0.23626995846141674, 'support': 539409}, 'weighted avg': {'precision': 0.346773535750219, 'recall': 0.3418018609255685, 'f1-score': 0.2356333475269547, 'support': 539409}}
[[  1235 154437  25531]
 [  1320 157232  20992]
 [  1041 151717  25904]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.168111
{'0': {'precision': 0.27259368111682586, 'recall': 0.005533596837944664, 'f1-score': 0.010847001724994884, 'support': 67045}, '1': {'precision': 0.35182871230286045, 'recall': 0.8871794143945952, 'f1-score': 0.5038468823930067, 'support': 70457}, '2': {'precision': 0.35734721449574824, 'recall': 0.13484578128982921, 'f1-score': 0.1958043480627497, 'support': 66691}, 'accuracy': 0.35198072411884834, 'macro avg': {'precision': 0.32725653597181154, 'recall': 0.34251959750745636, 'f1-score': 0.23683274406025043, 'support': 204193}, 'weighted avg': {'precision': 0.32761496238919147, 'recall': 0.35198072411884834, 'f1-score': 0.24136559431552107, 'support': 204193}}
[[  371 57835  8839]
 [  615 62508  7334]
 [  375 57323  8993]]
training model: results/WBA/W4/deepLOB_L1/h1000
Epoch 1/50
2108/2108 - 36s - loss: 3.2000 - accuracy1000: 0.4251 - val_loss: 3.5514 - val_accuracy1000: 0.3187 - 36s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 34s - loss: 3.1362 - accuracy1000: 0.4487 - val_loss: 3.5434 - val_accuracy1000: 0.3351 - 34s/epoch - 16ms/step
Epoch 3/50
2108/2108 - 33s - loss: 3.1116 - accuracy1000: 0.4588 - val_loss: 3.6031 - val_accuracy1000: 0.3320 - 33s/epoch - 16ms/step
Epoch 4/50
2108/2108 - 35s - loss: 3.0946 - accuracy1000: 0.4662 - val_loss: 3.5324 - val_accuracy1000: 0.3258 - 35s/epoch - 17ms/step
Epoch 5/50
2108/2108 - 35s - loss: 3.0795 - accuracy1000: 0.4728 - val_loss: 3.5588 - val_accuracy1000: 0.3436 - 35s/epoch - 16ms/step
Epoch 6/50
2108/2108 - 34s - loss: 3.0640 - accuracy1000: 0.4780 - val_loss: 3.6006 - val_accuracy1000: 0.3426 - 34s/epoch - 16ms/step
Epoch 7/50
2108/2108 - 36s - loss: 3.0555 - accuracy1000: 0.4805 - val_loss: 3.6089 - val_accuracy1000: 0.3495 - 36s/epoch - 17ms/step
Epoch 8/50
2108/2108 - 34s - loss: 3.0446 - accuracy1000: 0.4830 - val_loss: 3.6596 - val_accuracy1000: 0.3424 - 34s/epoch - 16ms/step
Epoch 9/50
2108/2108 - 34s - loss: 3.0396 - accuracy1000: 0.4848 - val_loss: 3.7471 - val_accuracy1000: 0.3556 - 34s/epoch - 16ms/step
Epoch 10/50
2108/2108 - 34s - loss: 3.0329 - accuracy1000: 0.4861 - val_loss: 3.7557 - val_accuracy1000: 0.3476 - 34s/epoch - 16ms/step
Epoch 11/50
2108/2108 - 34s - loss: 3.0258 - accuracy1000: 0.4880 - val_loss: 3.8476 - val_accuracy1000: 0.3539 - 34s/epoch - 16ms/step
Epoch 12/50
2108/2108 - 34s - loss: 3.0206 - accuracy1000: 0.4894 - val_loss: 3.7056 - val_accuracy1000: 0.3492 - 34s/epoch - 16ms/step
Epoch 13/50
2108/2108 - 34s - loss: 3.0148 - accuracy1000: 0.4915 - val_loss: 3.6284 - val_accuracy1000: 0.3485 - 34s/epoch - 16ms/step
Epoch 14/50
2108/2108 - 35s - loss: 3.0122 - accuracy1000: 0.4923 - val_loss: 3.6111 - val_accuracy1000: 0.3448 - 35s/epoch - 16ms/step
testing model: results/WBA/W4/deepLOB_L1/h1000
Evaluating performance on  test set...
4676/4676 - 28s - 28s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2115856
{'0': {'precision': 0.314213369045613, 'recall': 0.34890488664788954, 'f1-score': 0.3306516717608904, 'support': 406168}, '1': {'precision': 0.3464180924667045, 'recall': 0.630794374372467, 'f1-score': 0.44722839980878354, 'support': 409341}, '2': {'precision': 0.731023102310231, 'recall': 0.0011612666456957115, 'f1-score': 0.002318849683055647, 'support': 381480}, 'accuracy': 0.33447842879090783, 'macro avg': {'precision': 0.4638848546075162, 'recall': 0.32695350922201744, 'f1-score': 0.26006630708424316, 'support': 1196989}, 'weighted avg': {'precision': 0.458063722503915, 'recall': 0.33447842879090783, 'f1-score': 0.265878502976215, 'support': 1196989}}
[[141714 264450      4]
 [150972 258210    159]
 [158326 222711    443]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2039348
{'0': {'precision': 0.3466490690739099, 'recall': 0.19049069055435908, 'f1-score': 0.24587053691059352, 'support': 180623}, '1': {'precision': 0.3321416712783619, 'recall': 0.4957461219500107, 'f1-score': 0.39777841108673606, 'support': 181599}, '2': {'precision': 0.32649923419454413, 'recall': 0.3116029957051025, 'f1-score': 0.31887724161829684, 'support': 177187}, 'accuracy': 0.33304227404437076, 'macro avg': {'precision': 0.335096658182272, 'recall': 0.33261326940315744, 'f1-score': 0.32084206320520875, 'support': 539409}, 'weighted avg': {'precision': 0.33514607649305955, 'recall': 0.33304227404437076, 'f1-score': 0.32099378667015843, 'support': 539409}}
[[34407 91950 54266]
 [31947 90027 59625]
 [32902 89073 55212]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1751679
{'0': {'precision': 0.3142986288985988, 'recall': 0.1456846339725951, 'f1-score': 0.1990875947240833, 'support': 71593}, '1': {'precision': 0.29253961221174335, 'recall': 0.45211621233859395, 'f1-score': 0.3552296163453532, 'support': 61336}, '2': {'precision': 0.3740913742881885, 'recall': 0.400075774584643, 'f1-score': 0.3866474999660966, 'support': 71264}, 'accuracy': 0.32651462097133593, 'macro avg': {'precision': 0.32697653846617686, 'recall': 0.3326255402986107, 'f1-score': 0.31365490367851107, 'support': 204193}, 'weighted avg': {'precision': 0.3286304579032109, 'recall': 0.32651462097133593, 'f1-score': 0.31144892016290365, 'support': 204193}}
[[10430 34100 27063]
 [12965 27731 20640]
 [ 9790 32963 28511]]
training model: results/WBA/W4/deepOF_L1/h10
Epoch 1/50
2108/2108 - 34s - loss: 3.1175 - accuracy10: 0.3944 - val_loss: 3.2884 - val_accuracy10: 0.4252 - 34s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 30s - loss: 3.0752 - accuracy10: 0.3795 - val_loss: 3.2812 - val_accuracy10: 0.4583 - 30s/epoch - 14ms/step
Epoch 3/50
2108/2108 - 31s - loss: 3.0535 - accuracy10: 0.3913 - val_loss: 3.2702 - val_accuracy10: 0.4608 - 31s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 31s - loss: 3.0360 - accuracy10: 0.4075 - val_loss: 3.2685 - val_accuracy10: 0.4843 - 31s/epoch - 15ms/step
Epoch 5/50
2108/2108 - 31s - loss: 3.0214 - accuracy10: 0.4193 - val_loss: 3.2633 - val_accuracy10: 0.4934 - 31s/epoch - 15ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.0071 - accuracy10: 0.4293 - val_loss: 3.2650 - val_accuracy10: 0.4992 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 30s - loss: 2.9949 - accuracy10: 0.4403 - val_loss: 3.2670 - val_accuracy10: 0.5046 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 31s - loss: 2.9818 - accuracy10: 0.4474 - val_loss: 3.2710 - val_accuracy10: 0.5213 - 31s/epoch - 15ms/step
Epoch 9/50
2108/2108 - 30s - loss: 2.9685 - accuracy10: 0.4554 - val_loss: 3.2673 - val_accuracy10: 0.5117 - 30s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 31s - loss: 2.9545 - accuracy10: 0.4607 - val_loss: 3.2725 - val_accuracy10: 0.5290 - 31s/epoch - 15ms/step
Epoch 11/50
2108/2108 - 31s - loss: 2.9422 - accuracy10: 0.4655 - val_loss: 3.2856 - val_accuracy10: 0.5420 - 31s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 31s - loss: 2.9322 - accuracy10: 0.4687 - val_loss: 3.2831 - val_accuracy10: 0.5407 - 31s/epoch - 15ms/step
Epoch 13/50
2108/2108 - 30s - loss: 2.9185 - accuracy10: 0.4730 - val_loss: 3.2976 - val_accuracy10: 0.5463 - 30s/epoch - 14ms/step
Epoch 14/50
2108/2108 - 31s - loss: 2.9067 - accuracy10: 0.4759 - val_loss: 3.3165 - val_accuracy10: 0.5550 - 31s/epoch - 15ms/step
Epoch 15/50
2108/2108 - 30s - loss: 2.8946 - accuracy10: 0.4782 - val_loss: 3.3666 - val_accuracy10: 0.5686 - 30s/epoch - 14ms/step
testing model: results/WBA/W4/deepOF_L1/h10
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98887265
{'0': {'precision': 0.2927241571843894, 'recall': 0.407215556031712, 'f1-score': 0.3406059927191263, 'support': 186680}, '1': {'precision': 0.735813357467759, 'recall': 0.535668876688572, 'f1-score': 0.6199887093329838, 'support': 821108}, '2': {'precision': 0.2601177520491743, 'recall': 0.46679915643482717, 'f1-score': 0.33407600184595365, 'support': 189197}, 'accuracy': 0.5047498506664662, 'macro avg': {'precision': 0.42955175556710756, 'recall': 0.46989452971837037, 'f1-score': 0.4315569012993546, 'support': 1196985}, 'weighted avg': {'precision': 0.5915207611801869, 'recall': 0.5047498506664662, 'f1-score': 0.5312248634569715, 'support': 1196985}}
[[ 76019  79981  30680]
 [160736 439842 220530]
 [ 22940  77940  88317]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9876459
{'0': {'precision': 0.28860982976624233, 'recall': 0.3871821664925113, 'f1-score': 0.3307070216236854, 'support': 86130}, '1': {'precision': 0.7300520318586129, 'recall': 0.5463801181835735, 'f1-score': 0.6250013609166513, 'support': 367733}, '2': {'precision': 0.2689176825166169, 'recall': 0.467279996259235, 'f1-score': 0.3413753053102635, 'support': 85544}, 'accuracy': 0.5084157231923204, 'macro avg': {'precision': 0.42919318138049073, 'recall': 0.46694742697843994, 'f1-score': 0.43236122928353343, 'support': 539407}, 'weighted avg': {'precision': 0.5864337739451495, 'recall': 0.5084157231923204, 'f1-score': 0.5330298463755052, 'support': 539407}}
[[ 33348  39307  13475]
 [ 71615 200922  95196]
 [ 10584  34987  39973]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9986881
{'0': {'precision': 0.2971651157758061, 'recall': 0.3820599855322464, 'f1-score': 0.33430713798811956, 'support': 35942}, '1': {'precision': 0.6924372857588034, 'recall': 0.5345637710032703, 'f1-score': 0.6033440388964078, 'support': 133015}, '2': {'precision': 0.2845465231937788, 'recall': 0.4465319559541378, 'f1-score': 0.34759364195689874, 'support': 35236}, 'accuracy': 0.49252912685547495, 'macro avg': {'precision': 0.4247163082427961, 'recall': 0.4543852374965515, 'f1-score': 0.42841493961380867, 'support': 204193}, 'weighted avg': {'precision': 0.5524750380653461, 'recall': 0.49252912685547495, 'f1-score': 0.5118553723945872, 'support': 204193}}
[[13732 16548  5662]
 [28011 71105 33899]
 [ 4467 15035 15734]]
training model: results/WBA/W4/deepOF_L1/h20
Epoch 1/50
2108/2108 - 35s - loss: 3.1526 - accuracy20: 0.4076 - val_loss: 3.2641 - val_accuracy20: 0.4234 - 35s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 32s - loss: 3.1143 - accuracy20: 0.3941 - val_loss: 3.2509 - val_accuracy20: 0.4425 - 32s/epoch - 15ms/step
Epoch 3/50
2108/2108 - 30s - loss: 3.0895 - accuracy20: 0.4159 - val_loss: 3.2416 - val_accuracy20: 0.4645 - 30s/epoch - 14ms/step
Epoch 4/50
2108/2108 - 30s - loss: 3.0716 - accuracy20: 0.4319 - val_loss: 3.2385 - val_accuracy20: 0.4798 - 30s/epoch - 14ms/step
Epoch 5/50
2108/2108 - 30s - loss: 3.0572 - accuracy20: 0.4398 - val_loss: 3.2342 - val_accuracy20: 0.4818 - 30s/epoch - 14ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.0444 - accuracy20: 0.4474 - val_loss: 3.2372 - val_accuracy20: 0.4923 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 33s - loss: 3.0312 - accuracy20: 0.4544 - val_loss: 3.2378 - val_accuracy20: 0.4964 - 33s/epoch - 16ms/step
Epoch 8/50
2108/2108 - 31s - loss: 3.0196 - accuracy20: 0.4599 - val_loss: 3.2343 - val_accuracy20: 0.4998 - 31s/epoch - 15ms/step
Epoch 9/50
2108/2108 - 31s - loss: 3.0057 - accuracy20: 0.4654 - val_loss: 3.2392 - val_accuracy20: 0.5049 - 31s/epoch - 15ms/step
Epoch 10/50
2108/2108 - 31s - loss: 2.9915 - accuracy20: 0.4720 - val_loss: 3.2510 - val_accuracy20: 0.5149 - 31s/epoch - 15ms/step
Epoch 11/50
2108/2108 - 31s - loss: 2.9786 - accuracy20: 0.4770 - val_loss: 3.2548 - val_accuracy20: 0.5180 - 31s/epoch - 15ms/step
Epoch 12/50
2108/2108 - 30s - loss: 2.9678 - accuracy20: 0.4812 - val_loss: 3.2773 - val_accuracy20: 0.5243 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 30s - loss: 2.9544 - accuracy20: 0.4854 - val_loss: 3.2945 - val_accuracy20: 0.5261 - 30s/epoch - 14ms/step
Epoch 14/50
2108/2108 - 31s - loss: 2.9447 - accuracy20: 0.4894 - val_loss: 3.3000 - val_accuracy20: 0.5216 - 31s/epoch - 14ms/step
Epoch 15/50
2108/2108 - 31s - loss: 2.9315 - accuracy20: 0.4932 - val_loss: 3.3404 - val_accuracy20: 0.5291 - 31s/epoch - 15ms/step
testing model: results/WBA/W4/deepOF_L1/h20
Evaluating performance on  test set...
4676/4676 - 27s - 27s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0090345
{'0': {'precision': 0.3583799903937832, 'recall': 0.4007511353205953, 'f1-score': 0.3783830834003501, 'support': 249489}, '1': {'precision': 0.6344606414995219, 'recall': 0.5313075519683941, 'f1-score': 0.5783203421473092, 'support': 695567}, '2': {'precision': 0.3361915832141154, 'recall': 0.4477412286795089, 'f1-score': 0.3840299328111887, 'support': 251929}, 'accuracy': 0.48650734971616183, 'macro avg': {'precision': 0.4430107383691402, 'recall': 0.4599333053228327, 'f1-score': 0.44691111945294937, 'support': 1196985}, 'weighted avg': {'precision': 0.5141402438767415, 'recall': 0.48650734971616183, 'f1-score': 0.4957549505332459, 'support': 1196985}}
[[ 99983 107709  41797]
 [145083 369560 180924]
 [ 33920 105210 112799]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0078824
{'0': {'precision': 0.3590012921512234, 'recall': 0.3787077994600441, 'f1-score': 0.3685913347142099, 'support': 113713}, '1': {'precision': 0.6341691712553656, 'recall': 0.5546711353162966, 'f1-score': 0.591762126937282, 'support': 312697}, '2': {'precision': 0.34316976581662717, 'recall': 0.44325955556342206, 'f1-score': 0.38684538773744837, 'support': 112997}, 'accuracy': 0.4942371900994981, 'macro avg': {'precision': 0.4454467430744054, 'recall': 0.45887949677992096, 'f1-score': 0.44906628312964675, 'support': 539407}, 'weighted avg': {'precision': 0.5152010732274749, 'recall': 0.4942371900994981, 'f1-score': 0.5017885131810168, 'support': 539407}}
[[ 43064  52010  18639]
 [ 62025 173444  77228]
 [ 14866  48044  50087]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0172281
{'0': {'precision': 0.3736583670099509, 'recall': 0.3693966535644479, 'f1-score': 0.37151528898393876, 'support': 46557}, '1': {'precision': 0.5962440856543583, 'recall': 0.547907627209811, 'f1-score': 0.5710548322144514, 'support': 111548}, '2': {'precision': 0.36008407890481836, 'recall': 0.43488543655615347, 'f1-score': 0.393965601965602, 'support': 46088}, 'accuracy': 0.48169623836272546, 'macro avg': {'precision': 0.44332884385637583, 'recall': 0.4507299057768041, 'f1-score': 0.4455119077213307, 'support': 204193}, 'weighted avg': {'precision': 0.4921902459340913, 'recall': 0.48169623836272546, 'f1-score': 0.4855883815629014, 'support': 204193}}
[[17198 21378  7981]
 [22792 61118 27638]
 [ 6036 20009 20043]]
training model: results/WBA/W4/deepOF_L1/h30
Epoch 1/50
2108/2108 - 33s - loss: 3.1821 - accuracy30: 0.4116 - val_loss: 3.2598 - val_accuracy30: 0.4191 - 33s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 31s - loss: 3.1447 - accuracy30: 0.4024 - val_loss: 3.2411 - val_accuracy30: 0.4359 - 31s/epoch - 14ms/step
Epoch 3/50
2108/2108 - 30s - loss: 3.1204 - accuracy30: 0.4192 - val_loss: 3.2347 - val_accuracy30: 0.4502 - 30s/epoch - 14ms/step
Epoch 4/50
2108/2108 - 32s - loss: 3.1055 - accuracy30: 0.4298 - val_loss: 3.2338 - val_accuracy30: 0.4626 - 32s/epoch - 15ms/step
Epoch 5/50
2108/2108 - 30s - loss: 3.0904 - accuracy30: 0.4420 - val_loss: 3.2296 - val_accuracy30: 0.4689 - 30s/epoch - 14ms/step
Epoch 6/50
2108/2108 - 30s - loss: 3.0782 - accuracy30: 0.4485 - val_loss: 3.2333 - val_accuracy30: 0.4742 - 30s/epoch - 14ms/step
Epoch 7/50
2108/2108 - 29s - loss: 3.0659 - accuracy30: 0.4555 - val_loss: 3.2334 - val_accuracy30: 0.4762 - 29s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.0524 - accuracy30: 0.4616 - val_loss: 3.2359 - val_accuracy30: 0.4809 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 30s - loss: 3.0404 - accuracy30: 0.4672 - val_loss: 3.2424 - val_accuracy30: 0.4831 - 30s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.0280 - accuracy30: 0.4720 - val_loss: 3.2471 - val_accuracy30: 0.4870 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 30s - loss: 3.0164 - accuracy30: 0.4774 - val_loss: 3.2643 - val_accuracy30: 0.4929 - 30s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 31s - loss: 3.0042 - accuracy30: 0.4833 - val_loss: 3.2717 - val_accuracy30: 0.4940 - 31s/epoch - 15ms/step
Epoch 13/50
2108/2108 - 31s - loss: 2.9953 - accuracy30: 0.4853 - val_loss: 3.2838 - val_accuracy30: 0.4946 - 31s/epoch - 15ms/step
Epoch 14/50
2108/2108 - 31s - loss: 2.9851 - accuracy30: 0.4897 - val_loss: 3.2971 - val_accuracy30: 0.4988 - 31s/epoch - 14ms/step
Epoch 15/50
2108/2108 - 30s - loss: 2.9748 - accuracy30: 0.4927 - val_loss: 3.3272 - val_accuracy30: 0.4991 - 30s/epoch - 14ms/step
testing model: results/WBA/W4/deepOF_L1/h30
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0228533
{'0': {'precision': 0.42426165050712655, 'recall': 0.323741399649508, 'f1-score': 0.3672473274648431, 'support': 293302}, '1': {'precision': 0.5559177191876693, 'recall': 0.5578501738897587, 'f1-score': 0.5568822700757817, 'support': 608719}, '2': {'precision': 0.37360766131257933, 'recall': 0.45894753258024706, 'f1-score': 0.41190377663911976, 'support': 294964}, 'accuracy': 0.4761137357610998, 'macro avg': {'precision': 0.45126234366912504, 'recall': 0.44684636870650457, 'f1-score': 0.44534445805991485, 'support': 1196985}, 'weighted avg': {'precision': 0.47873221379937403, 'recall': 0.4761137357610998, 'f1-score': 0.4746893066921761, 'support': 1196985}}
[[ 94954 142816  55532]
 [ 97710 339574 171435]
 [ 31146 128445 135373]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0213506
{'0': {'precision': 0.4172919335488725, 'recall': 0.30991339278298363, 'f1-score': 0.3556749496306246, 'support': 132437}, '1': {'precision': 0.5601713467772492, 'recall': 0.5796786279606744, 'f1-score': 0.5697580645161291, 'support': 275444}, '2': {'precision': 0.38026959291853885, 'recall': 0.4510667092437997, 'f1-score': 0.4126535878611249, 'support': 131526}, 'accuracy': 0.48208495625751985, 'macro avg': {'precision': 0.45257762441488686, 'recall': 0.44688624332915255, 'f1-score': 0.44602886733595953, 'support': 539407}, 'weighted avg': {'precision': 0.48122487606450864, 'recall': 0.48208495625751985, 'f1-score': 0.47888818540329287, 'support': 539407}}
[[ 41044  67081  24312]
 [ 43401 159669  72374]
 [ 13913  58286  59327]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0297436
{'0': {'precision': 0.4318913026137361, 'recall': 0.3026627163806436, 'f1-score': 0.3559095490599939, 'support': 53667}, '1': {'precision': 0.522613302164241, 'recall': 0.5710416001483145, 'f1-score': 0.5457552207659256, 'support': 97091}, '2': {'precision': 0.39734858503041526, 'recall': 0.4498549639749228, 'f1-score': 0.42197470398750125, 'support': 53435}, 'accuracy': 0.4687917803254764, 'macro avg': {'precision': 0.45061772993613075, 'recall': 0.441186426834627, 'f1-score': 0.4412131579378069, 'support': 204193}, 'weighted avg': {'precision': 0.4659889432982518, 'recall': 0.46879178032547647, 'f1-score': 0.4634670934672555, 'support': 204193}}
[[16243 26744 10680]
 [15870 55443 25778]
 [ 5496 23901 24038]]
training model: results/WBA/W4/deepOF_L1/h50
Epoch 1/50
2108/2108 - 33s - loss: 3.2219 - accuracy50: 0.4115 - val_loss: 3.2606 - val_accuracy50: 0.4060 - 33s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 31s - loss: 3.1967 - accuracy50: 0.4043 - val_loss: 3.2491 - val_accuracy50: 0.4140 - 31s/epoch - 15ms/step
Epoch 3/50
2108/2108 - 30s - loss: 3.1765 - accuracy50: 0.4170 - val_loss: 3.2447 - val_accuracy50: 0.4218 - 30s/epoch - 14ms/step
Epoch 4/50
2108/2108 - 30s - loss: 3.1611 - accuracy50: 0.4279 - val_loss: 3.2477 - val_accuracy50: 0.4238 - 30s/epoch - 14ms/step
Epoch 5/50
2108/2108 - 31s - loss: 3.1482 - accuracy50: 0.4362 - val_loss: 3.2484 - val_accuracy50: 0.4277 - 31s/epoch - 15ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.1373 - accuracy50: 0.4431 - val_loss: 3.2557 - val_accuracy50: 0.4270 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 30s - loss: 3.1251 - accuracy50: 0.4492 - val_loss: 3.2636 - val_accuracy50: 0.4268 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.1140 - accuracy50: 0.4550 - val_loss: 3.2667 - val_accuracy50: 0.4280 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 31s - loss: 3.1026 - accuracy50: 0.4596 - val_loss: 3.2867 - val_accuracy50: 0.4257 - 31s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.0923 - accuracy50: 0.4636 - val_loss: 3.3024 - val_accuracy50: 0.4272 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 30s - loss: 3.0824 - accuracy50: 0.4682 - val_loss: 3.3042 - val_accuracy50: 0.4277 - 30s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 30s - loss: 3.0734 - accuracy50: 0.4716 - val_loss: 3.3249 - val_accuracy50: 0.4261 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 31s - loss: 3.0630 - accuracy50: 0.4752 - val_loss: 3.3520 - val_accuracy50: 0.4248 - 31s/epoch - 15ms/step
testing model: results/WBA/W4/deepOF_L1/h50
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0544953
{'0': {'precision': 0.4518623132899272, 'recall': 0.319995253553478, 'f1-score': 0.37466445034361273, 'support': 353949}, '1': {'precision': 0.43899605064916153, 'recall': 0.6049476244686689, 'f1-score': 0.5087815067443419, 'support': 488396}, '2': {'precision': 0.4304500067689448, 'recall': 0.3317307692307692, 'f1-score': 0.3746972276322683, 'support': 354640}, 'accuracy': 0.43973901093163237, 'macro avg': {'precision': 0.44043612356934453, 'recall': 0.41889121575097205, 'f1-score': 0.41938106157340765, 'support': 1196985}, 'weighted avg': {'precision': 0.44026860777707566, 'recall': 0.43973901093163237, 'f1-score': 0.4293968471702557, 'support': 1196985}}
[[113262 187121  53566]
 [ 90846 295454 102096]
 [ 46548 190447 117645]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.053973
{'0': {'precision': 0.43450448479544956, 'recall': 0.3120259408914668, 'f1-score': 0.3632180712932416, 'support': 159131}, '1': {'precision': 0.44238104451415855, 'recall': 0.5750284053909615, 'f1-score': 0.5000576053738979, 'support': 222669}, '2': {'precision': 0.42648272609362103, 'recall': 0.36719181254639705, 'f1-score': 0.39462262574879897, 'support': 157607}, 'accuracy': 0.43671290880541036, 'macro avg': {'precision': 0.4344560851344097, 'recall': 0.4180820529429418, 'f1-score': 0.4192994341386462, 'support': 539407}, 'weighted avg': {'precision': 0.43541211178636013, 'recall': 0.43671290880541036, 'f1-score': 0.4288818461947217, 'support': 539407}}
[[ 49653  82995  26483]
 [ 43287 128041  51341]
 [ 21335  78400  57872]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0613071
{'0': {'precision': 0.4482608496402548, 'recall': 0.30803023145961267, 'f1-score': 0.36514484097357025, 'support': 63510}, '1': {'precision': 0.40196022781025903, 'recall': 0.5519355676799169, 'f1-score': 0.4651580341796127, 'support': 76980}, '2': {'precision': 0.4387500227898412, 'recall': 0.3777687079101455, 'f1-score': 0.4059821850327282, 'support': 63703}, 'accuracy': 0.4217382574329189, 'macro avg': {'precision': 0.42965703341345174, 'recall': 0.41257816901655836, 'f1-score': 0.41209502006197035, 'support': 204193}, 'weighted avg': {'precision': 0.4278385527381819, 'recall': 0.4217382574329189, 'f1-score': 0.4155896502549937, 'support': 204193}}
[[19563 32103 11844]
 [15552 42488 18940]
 [ 8527 31111 24065]]
training model: results/WBA/W4/deepOF_L1/h100
Epoch 1/50
2108/2108 - 33s - loss: 3.2630 - accuracy100: 0.3953 - val_loss: 3.2805 - val_accuracy100: 0.3556 - 33s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 31s - loss: 3.2439 - accuracy100: 0.3992 - val_loss: 3.2663 - val_accuracy100: 0.3659 - 31s/epoch - 15ms/step
Epoch 3/50
2108/2108 - 31s - loss: 3.2325 - accuracy100: 0.4061 - val_loss: 3.2656 - val_accuracy100: 0.3643 - 31s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 30s - loss: 3.2234 - accuracy100: 0.4116 - val_loss: 3.2709 - val_accuracy100: 0.3585 - 30s/epoch - 14ms/step
Epoch 5/50
2108/2108 - 31s - loss: 3.2157 - accuracy100: 0.4168 - val_loss: 3.2800 - val_accuracy100: 0.3534 - 31s/epoch - 15ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.2080 - accuracy100: 0.4205 - val_loss: 3.2887 - val_accuracy100: 0.3518 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 30s - loss: 3.2018 - accuracy100: 0.4243 - val_loss: 3.2965 - val_accuracy100: 0.3483 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.1953 - accuracy100: 0.4281 - val_loss: 3.3050 - val_accuracy100: 0.3474 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 30s - loss: 3.1895 - accuracy100: 0.4310 - val_loss: 3.3160 - val_accuracy100: 0.3484 - 30s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.1836 - accuracy100: 0.4343 - val_loss: 3.3246 - val_accuracy100: 0.3469 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 31s - loss: 3.1791 - accuracy100: 0.4368 - val_loss: 3.3350 - val_accuracy100: 0.3452 - 31s/epoch - 15ms/step
Epoch 12/50
2108/2108 - 31s - loss: 3.1741 - accuracy100: 0.4391 - val_loss: 3.3417 - val_accuracy100: 0.3470 - 31s/epoch - 15ms/step
Epoch 13/50
2108/2108 - 31s - loss: 3.1697 - accuracy100: 0.4407 - val_loss: 3.3494 - val_accuracy100: 0.3462 - 31s/epoch - 15ms/step
testing model: results/WBA/W4/deepOF_L1/h100
Evaluating performance on  test set...
4676/4676 - 26s - 26s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0828179
{'0': {'precision': 0.4909738884968243, 'recall': 0.1726717447364045, 'f1-score': 0.2554897183116695, 'support': 402909}, '1': {'precision': 0.3399378199583908, 'recall': 0.7379973052456362, 'f1-score': 0.46546993267871184, 'support': 394099}, '2': {'precision': 0.45643323902756566, 'recall': 0.22789310385347158, 'f1-score': 0.3040011205939148, 'support': 399977}, 'accuracy': 0.3772536832124045, 'macro avg': {'precision': 0.4291149824942602, 'recall': 0.3795207179451707, 'f1-score': 0.3416535905280987, 'support': 1196985}, 'weighted avg': {'precision': 0.42970442486303295, 'recall': 0.3772536832124045, 'f1-score': 0.3408345118157507, 'support': 1196985}}
[[ 69571 286212  47126]
 [ 41828 290844  61427]
 [ 30301 278524  91152]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0838003
{'0': {'precision': 0.4674770129055142, 'recall': 0.18790131986598452, 'f1-score': 0.2680575275062678, 'support': 182367}, '1': {'precision': 0.34197736234094345, 'recall': 0.7068798205020334, 'f1-score': 0.4609529313649465, 'support': 178275}, '2': {'precision': 0.4518052538830376, 'recall': 0.24668139736525607, 'f1-score': 0.31912406963154333, 'support': 178765}, 'accuracy': 0.3789049826939584, 'macro avg': {'precision': 0.42041987637649836, 'recall': 0.38048751257775804, 'f1-score': 0.3493781761675859, 'support': 539407}, 'weighted avg': {'precision': 0.4208053675504263, 'recall': 0.3789049826939584, 'f1-score': 0.34873378592696097, 'support': 539407}}
[[ 34267 124388  23712]
 [ 22462 126019  29794]
 [ 16573 118094  44098]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0895697
{'0': {'precision': 0.4729710352738744, 'recall': 0.18598029403887628, 'f1-score': 0.26697963354546284, 'support': 70943}, '1': {'precision': 0.3136707473049516, 'recall': 0.6917906478183078, 'f1-score': 0.4316316678735216, 'support': 62039}, '2': {'precision': 0.4647344953384678, 'recall': 0.25760065158472706, 'f1-score': 0.3314691506374059, 'support': 71211}, 'accuracy': 0.36463541845215064, 'macro avg': {'precision': 0.41712542597243124, 'recall': 0.37845719781397036, 'f1-score': 0.3433601506854635, 'support': 204193}, 'weighted avg': {'precision': 0.42169913657683655, 'recall': 0.36463541845215064, 'f1-score': 0.33949539343592333, 'support': 204193}}
[[13194 47738 10011]
 [ 8004 42918 11117]
 [ 6698 46169 18344]]
training model: results/WBA/W4/deepOF_L1/h200
Epoch 1/50
2108/2108 - 35s - loss: 3.2910 - accuracy200: 0.3681 - val_loss: 3.3301 - val_accuracy200: 0.3218 - 35s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 31s - loss: 3.2748 - accuracy200: 0.3720 - val_loss: 3.2978 - val_accuracy200: 0.3297 - 31s/epoch - 15ms/step
Epoch 3/50
2108/2108 - 31s - loss: 3.2704 - accuracy200: 0.3744 - val_loss: 3.2868 - val_accuracy200: 0.3423 - 31s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 31s - loss: 3.2669 - accuracy200: 0.3758 - val_loss: 3.2829 - val_accuracy200: 0.3531 - 31s/epoch - 15ms/step
Epoch 5/50
2108/2108 - 32s - loss: 3.2641 - accuracy200: 0.3787 - val_loss: 3.2822 - val_accuracy200: 0.3570 - 32s/epoch - 15ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.2618 - accuracy200: 0.3811 - val_loss: 3.2851 - val_accuracy200: 0.3490 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 30s - loss: 3.2599 - accuracy200: 0.3829 - val_loss: 3.2871 - val_accuracy200: 0.3487 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.2578 - accuracy200: 0.3848 - val_loss: 3.2874 - val_accuracy200: 0.3475 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 31s - loss: 3.2560 - accuracy200: 0.3858 - val_loss: 3.2886 - val_accuracy200: 0.3473 - 31s/epoch - 15ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.2545 - accuracy200: 0.3876 - val_loss: 3.2911 - val_accuracy200: 0.3444 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 30s - loss: 3.2527 - accuracy200: 0.3880 - val_loss: 3.2929 - val_accuracy200: 0.3407 - 30s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 30s - loss: 3.2505 - accuracy200: 0.3900 - val_loss: 3.2953 - val_accuracy200: 0.3407 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 31s - loss: 3.2495 - accuracy200: 0.3906 - val_loss: 3.2996 - val_accuracy200: 0.3349 - 31s/epoch - 15ms/step
Epoch 14/50
2108/2108 - 31s - loss: 3.2482 - accuracy200: 0.3920 - val_loss: 3.3016 - val_accuracy200: 0.3335 - 31s/epoch - 15ms/step
Epoch 15/50
2108/2108 - 31s - loss: 3.2463 - accuracy200: 0.3933 - val_loss: 3.3031 - val_accuracy200: 0.3343 - 31s/epoch - 15ms/step
testing model: results/WBA/W4/deepOF_L1/h200
Evaluating performance on  test set...
4676/4676 - 23s - 23s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0865515
{'0': {'precision': 0.4040690642590498, 'recall': 0.15743101599374412, 'f1-score': 0.22658234808908437, 'support': 392591}, '1': {'precision': 0.3519597461351424, 'recall': 0.6024659618310321, 'f1-score': 0.44433792009430956, 'support': 415416}, '2': {'precision': 0.3905249910644292, 'recall': 0.334263120279296, 'f1-score': 0.3602103842962557, 'support': 388978}, 'accuracy': 0.36934548051980604, 'macro avg': {'precision': 0.3821846004862071, 'recall': 0.3647200327013574, 'f1-score': 0.3437102174932165, 'support': 1196985}, 'weighted avg': {'precision': 0.3815830757121105, 'recall': 0.36934548051980604, 'f1-score': 0.3455792569625587, 'support': 1196985}}
[[ 61806 239178  91607]
 [ 53831 250274 111311]
 [ 37322 221635 130021]]
Evaluating performance on  train set...
2108/2108 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.089942
{'0': {'precision': 0.3978731718209222, 'recall': 0.15832643790504855, 'f1-score': 0.22651523277201094, 'support': 180071}, '1': {'precision': 0.34643575312637576, 'recall': 0.6362027335598553, 'f1-score': 0.4485950349556073, 'support': 183058}, '2': {'precision': 0.38225704709718117, 'recall': 0.2853277209861696, 'f1-score': 0.32675560406292536, 'support': 176278}, 'accuracy': 0.36200679635229055, 'macro avg': {'precision': 0.37552199068149306, 'recall': 0.3599522974836911, 'f1-score': 0.3339552905968479, 'support': 539407}, 'weighted avg': {'precision': 0.375313564278866, 'recall': 0.36200679635229055, 'f1-score': 0.33464074207860983, 'support': 539407}}
[[ 28510 113174  38387]
 [ 23701 116462  42895]
 [ 19445 106536  50297]]
Evaluating performance on  val set...
798/798 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929625
{'0': {'precision': 0.4030682851607291, 'recall': 0.1470910769941129, 'f1-score': 0.21552936201701994, 'support': 69304}, '1': {'precision': 0.32780092830540775, 'recall': 0.6324332570556827, 'f1-score': 0.4317951014753902, 'support': 65550}, '2': {'precision': 0.3983217316677792, 'recall': 0.3012157660191234, 'f1-score': 0.343028889582341, 'support': 69339}, 'accuracy': 0.3552325495976845, 'macro avg': {'precision': 0.3763969817113053, 'recall': 0.360246700022973, 'f1-score': 0.3301177843582504, 'support': 204193}, 'weighted avg': {'precision': 0.3772941571812491, 'recall': 0.3552325495976845, 'f1-score': 0.32825070390115885, 'support': 204193}}
[[10194 43469 15641]
 [ 8186 41456 15908]
 [ 6911 41542 20886]]
training model: results/WBA/W4/deepOF_L1/h300
Epoch 1/50
2108/2108 - 33s - loss: 3.3025 - accuracy300: 0.3580 - val_loss: 3.3110 - val_accuracy300: 0.3102 - 33s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 30s - loss: 3.2856 - accuracy300: 0.3636 - val_loss: 3.2955 - val_accuracy300: 0.3166 - 30s/epoch - 14ms/step
Epoch 3/50
2108/2108 - 31s - loss: 3.2820 - accuracy300: 0.3665 - val_loss: 3.2876 - val_accuracy300: 0.3322 - 31s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 31s - loss: 3.2797 - accuracy300: 0.3686 - val_loss: 3.2853 - val_accuracy300: 0.3428 - 31s/epoch - 15ms/step
Epoch 5/50
2108/2108 - 30s - loss: 3.2779 - accuracy300: 0.3707 - val_loss: 3.2853 - val_accuracy300: 0.3458 - 30s/epoch - 14ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.2766 - accuracy300: 0.3718 - val_loss: 3.2838 - val_accuracy300: 0.3487 - 31s/epoch - 14ms/step
Epoch 7/50
2108/2108 - 30s - loss: 3.2755 - accuracy300: 0.3728 - val_loss: 3.2870 - val_accuracy300: 0.3425 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.2742 - accuracy300: 0.3745 - val_loss: 3.2879 - val_accuracy300: 0.3390 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 30s - loss: 3.2729 - accuracy300: 0.3747 - val_loss: 3.2888 - val_accuracy300: 0.3367 - 30s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.2714 - accuracy300: 0.3767 - val_loss: 3.2904 - val_accuracy300: 0.3356 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 30s - loss: 3.2708 - accuracy300: 0.3772 - val_loss: 3.2934 - val_accuracy300: 0.3278 - 30s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 30s - loss: 3.2694 - accuracy300: 0.3776 - val_loss: 3.2943 - val_accuracy300: 0.3273 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 30s - loss: 3.2683 - accuracy300: 0.3793 - val_loss: 3.2944 - val_accuracy300: 0.3291 - 30s/epoch - 14ms/step
Epoch 14/50
2108/2108 - 30s - loss: 3.2678 - accuracy300: 0.3795 - val_loss: 3.2962 - val_accuracy300: 0.3274 - 30s/epoch - 14ms/step
Epoch 15/50
2108/2108 - 31s - loss: 3.2667 - accuracy300: 0.3803 - val_loss: 3.2975 - val_accuracy300: 0.3253 - 31s/epoch - 15ms/step
Epoch 16/50
2108/2108 - 30s - loss: 3.2657 - accuracy300: 0.3815 - val_loss: 3.2991 - val_accuracy300: 0.3245 - 30s/epoch - 14ms/step
testing model: results/WBA/W4/deepOF_L1/h300
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.093056
{'0': {'precision': 0.39604593071665084, 'recall': 0.2014652104854895, 'f1-score': 0.26707276665409846, 'support': 406085}, '1': {'precision': 0.33056062248450174, 'recall': 0.5160401425336012, 'f1-score': 0.402982274033855, 'support': 391206}, '2': {'precision': 0.38068838738053035, 'recall': 0.36164415778070225, 'f1-score': 0.3709219867255672, 'support': 399694}, 'accuracy': 0.35776304632054706, 'macro avg': {'precision': 0.3690983135272276, 'recall': 0.35971650359993096, 'f1-score': 0.34699234247117355, 'support': 1196985}, 'weighted avg': {'precision': 0.3695154700856041, 'recall': 0.35776304632054706, 'f1-score': 0.3461685990256408, 'support': 1196985}}
[[ 81812 209078 115195]
 [ 69371 201878 119957]
 [ 55389 199758 144547]]
Evaluating performance on  train set...
2108/2108 - 14s - 14s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0948709
{'0': {'precision': 0.39247880778084465, 'recall': 0.19410063558178933, 'f1-score': 0.2597444793016682, 'support': 185342}, '1': {'precision': 0.3256387518705315, 'recall': 0.5452489081449775, 'f1-score': 0.4077544832910794, 'support': 172413}, '2': {'precision': 0.3771643048447736, 'recall': 0.33025235064849273, 'f1-score': 0.35215285726864487, 'support': 181652}, 'accuracy': 0.3521904610062532, 'macro avg': {'precision': 0.3650939548320499, 'recall': 0.3565339647917532, 'f1-score': 0.33988393995379756, 'support': 539407}, 'weighted avg': {'precision': 0.36595708179840836, 'recall': 0.3521904610062532, 'f1-score': 0.33817322696768587, 'support': 539407}}
[[35975 99537 49830]
 [29168 94008 49237]
 [26518 95143 59991]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097246
{'0': {'precision': 0.3997412297468168, 'recall': 0.19050688790167747, 'f1-score': 0.2580387988307202, 'support': 71357}, '1': {'precision': 0.3119132777374243, 'recall': 0.5425582957489684, 'f1-score': 0.39610711846199653, 'support': 62526}, '2': {'precision': 0.38477818477818476, 'recall': 0.33615417437064427, 'f1-score': 0.35882643185182367, 'support': 70310}, 'accuracy': 0.34845954562595194, 'macro avg': {'precision': 0.3654775640874753, 'recall': 0.35640645267376336, 'f1-score': 0.3376574497148468, 'support': 204193}, 'weighted avg': {'precision': 0.3676951644111599, 'recall': 0.34845954562595194, 'f1-score': 0.33502105694426454, 'support': 204193}}
[[13594 38024 19739]
 [10551 33924 18051]
 [ 9862 36813 23635]]
training model: results/WBA/W4/deepOF_L1/h500
Epoch 1/50
2108/2108 - 34s - loss: 3.2582 - accuracy500: 0.3934 - val_loss: 3.4748 - val_accuracy500: 0.3450 - 34s/epoch - 16ms/step
Epoch 2/50
2108/2108 - 30s - loss: 3.2615 - accuracy500: 0.3872 - val_loss: 3.3237 - val_accuracy500: 0.3451 - 30s/epoch - 14ms/step
Epoch 3/50
2108/2108 - 31s - loss: 3.2663 - accuracy500: 0.3821 - val_loss: 3.3136 - val_accuracy500: 0.3452 - 31s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 30s - loss: 3.2673 - accuracy500: 0.3801 - val_loss: 3.3133 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 5/50
2108/2108 - 30s - loss: 3.2663 - accuracy500: 0.3803 - val_loss: 3.3131 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 6/50
2108/2108 - 30s - loss: 3.2648 - accuracy500: 0.3820 - val_loss: 3.3133 - val_accuracy500: 0.3453 - 30s/epoch - 14ms/step
Epoch 7/50
2108/2108 - 30s - loss: 3.2631 - accuracy500: 0.3831 - val_loss: 3.3146 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 8/50
2108/2108 - 30s - loss: 3.2619 - accuracy500: 0.3836 - val_loss: 3.3173 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 9/50
2108/2108 - 32s - loss: 3.2594 - accuracy500: 0.3846 - val_loss: 3.3197 - val_accuracy500: 0.3452 - 32s/epoch - 15ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.2591 - accuracy500: 0.3849 - val_loss: 3.3183 - val_accuracy500: 0.3453 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 30s - loss: 3.2586 - accuracy500: 0.3850 - val_loss: 3.3183 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 12/50
2108/2108 - 30s - loss: 3.2587 - accuracy500: 0.3847 - val_loss: 3.3187 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 30s - loss: 3.2582 - accuracy500: 0.3846 - val_loss: 3.3195 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 14/50
2108/2108 - 30s - loss: 3.2575 - accuracy500: 0.3847 - val_loss: 3.3193 - val_accuracy500: 0.3452 - 30s/epoch - 14ms/step
Epoch 15/50
2108/2108 - 31s - loss: 3.2562 - accuracy500: 0.3856 - val_loss: 3.3198 - val_accuracy500: 0.3451 - 31s/epoch - 14ms/step
testing model: results/WBA/W4/deepOF_L1/h500
Evaluating performance on  test set...
4676/4676 - 24s - 24s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0673221
{'0': {'precision': 0.35135135135135137, 'recall': 0.0003551610670616948, 'f1-score': 0.0007096048350168758, 'support': 329428}, '1': {'precision': 0.4594960078964502, 'recall': 0.9996218106180306, 'f1-score': 0.6295889551302165, 'support': 549989}, '2': {'precision': 0.47878787878787876, 'recall': 0.00024876561870213626, 'f1-score': 0.0004972728674704863, 'support': 317568}, 'accuracy': 0.4594685814776292, 'macro avg': {'precision': 0.42987841267856014, 'recall': 0.3334085791012648, 'f1-score': 0.2102652776109013, 'support': 1196985}, 'weighted avg': {'precision': 0.4348512570757718, 'recall': 0.4594685814776292, 'f1-score': 0.28960987940089433, 'support': 1196985}}
[[   117 329277     34]
 [   156 549781     52]
 [    60 317429     79]]
Evaluating performance on  train set...
2108/2108 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.10788
{'0': {'precision': 0.3905325443786982, 'recall': 0.0003643429681807141, 'f1-score': 0.0007280067506080511, 'support': 181148}, '1': {'precision': 0.3330137026952838, 'recall': 0.9994767399787357, 'f1-score': 0.499574990226862, 'support': 179643}, '2': {'precision': 0.47297297297297297, 'recall': 0.0001959510906077843, 'f1-score': 0.00039173988471654823, 'support': 178616}, 'accuracy': 0.3330509244410992, 'macro avg': {'precision': 0.39883974001565164, 'recall': 0.3333456780125081, 'f1-score': 0.16689824562072886, 'support': 539407}, 'weighted avg': {'precision': 0.39867541667598283, 'recall': 0.3330509244410992, 'f1-score': 0.1667516327141321, 'support': 539407}}
[[    66 181074      8]
 [    63 179549     31]
 [    40 178541     35]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1046101
{'0': {'precision': 0.3829787234042553, 'recall': 0.0005367766561796412, 'f1-score': 0.0010720507437352034, 'support': 67067}, '1': {'precision': 0.3452012232176112, 'recall': 0.9992906694661579, 'f1-score': 0.5131401138627746, 'support': 70489}, '2': {'precision': 0.44680851063829785, 'recall': 0.00031514023740564554, 'f1-score': 0.00062983624257693, 'support': 66637}, 'accuracy': 0.3452420014398143, 'macro avg': {'precision': 0.39166281908672146, 'recall': 0.3333808621199144, 'f1-score': 0.1716140002830289, 'support': 204193}, 'weighted avg': {'precision': 0.3907680566392758, 'recall': 0.3452420014398143, 'f1-score': 0.17769758567139818, 'support': 204193}}
[[   36 67019    12]
 [   36 70439    14]
 [   22 66594    21]]
training model: results/WBA/W4/deepOF_L1/h1000
Epoch 1/50
2108/2108 - 35s - loss: 3.2868 - accuracy1000: 0.3745 - val_loss: 3.3417 - val_accuracy1000: 0.3005 - 35s/epoch - 17ms/step
Epoch 2/50
2108/2108 - 32s - loss: 3.2808 - accuracy1000: 0.3641 - val_loss: 3.3231 - val_accuracy1000: 0.3015 - 32s/epoch - 15ms/step
Epoch 3/50
2108/2108 - 32s - loss: 3.2784 - accuracy1000: 0.3626 - val_loss: 3.3218 - val_accuracy1000: 0.3010 - 32s/epoch - 15ms/step
Epoch 4/50
2108/2108 - 31s - loss: 3.2783 - accuracy1000: 0.3618 - val_loss: 3.3221 - val_accuracy1000: 0.3010 - 31s/epoch - 15ms/step
Epoch 5/50
2108/2108 - 31s - loss: 3.2761 - accuracy1000: 0.3649 - val_loss: 3.3239 - val_accuracy1000: 0.3010 - 31s/epoch - 15ms/step
Epoch 6/50
2108/2108 - 31s - loss: 3.2743 - accuracy1000: 0.3667 - val_loss: 3.3250 - val_accuracy1000: 0.3008 - 31s/epoch - 15ms/step
Epoch 7/50
2108/2108 - 31s - loss: 3.2725 - accuracy1000: 0.3690 - val_loss: 3.3281 - val_accuracy1000: 0.3018 - 31s/epoch - 15ms/step
Epoch 8/50
2108/2108 - 31s - loss: 3.2698 - accuracy1000: 0.3715 - val_loss: 3.3315 - val_accuracy1000: 0.3018 - 31s/epoch - 15ms/step
Epoch 9/50
2108/2108 - 30s - loss: 3.2680 - accuracy1000: 0.3731 - val_loss: 3.3343 - val_accuracy1000: 0.3015 - 30s/epoch - 14ms/step
Epoch 10/50
2108/2108 - 30s - loss: 3.2662 - accuracy1000: 0.3753 - val_loss: 3.3415 - val_accuracy1000: 0.3015 - 30s/epoch - 14ms/step
Epoch 11/50
2108/2108 - 31s - loss: 3.2636 - accuracy1000: 0.3778 - val_loss: 3.3493 - val_accuracy1000: 0.3017 - 31s/epoch - 15ms/step
Epoch 12/50
2108/2108 - 30s - loss: 3.2609 - accuracy1000: 0.3800 - val_loss: 3.3508 - val_accuracy1000: 0.3017 - 30s/epoch - 14ms/step
Epoch 13/50
2108/2108 - 32s - loss: 3.2583 - accuracy1000: 0.3832 - val_loss: 3.3564 - val_accuracy1000: 0.3017 - 32s/epoch - 15ms/step
testing model: results/WBA/W4/deepOF_L1/h1000
Evaluating performance on  test set...
4676/4676 - 25s - 25s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000974
{'0': {'precision': 0.3953488372093023, 'recall': 0.0035994957751472297, 'f1-score': 0.0071340389297965675, 'support': 406168}, '1': {'precision': 0.34191566502363113, 'recall': 0.9881199003273562, 'f1-score': 0.5080370505045175, 'support': 409340}, '2': {'precision': 0.35922047702152415, 'recall': 0.009712250017694383, 'f1-score': 0.018913145018645147, 'support': 381477}, 'accuracy': 0.34222985250441734, 'macro avg': {'precision': 0.3654949930848192, 'recall': 0.3338105487067326, 'f1-score': 0.17802807815098642, 'support': 1196985}, 'weighted avg': {'precision': 0.3655619366534594, 'recall': 0.34222985250441734, 'f1-score': 0.18218476789586713, 'support': 1196985}}
[[  1462 401636   3070]
 [  1324 404477   3539]
 [   912 376860   3705]]
Evaluating performance on  train set...
2108/2108 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003647
{'0': {'precision': 0.34814814814814815, 'recall': 0.004163736732241829, 'f1-score': 0.008229056667779195, 'support': 180607}, '1': {'precision': 0.33621041504834737, 'recall': 0.9841710299566699, 'f1-score': 0.5012014546433348, 'support': 181629}, '2': {'precision': 0.3464298528884105, 'recall': 0.010899074905035248, 'f1-score': 0.021133273140167993, 'support': 177171}, 'accuracy': 0.33636382175240587, 'macro avg': {'precision': 0.34359613869496863, 'recall': 0.33307794719798234, 'f1-score': 0.17685459481709398, 'support': 539407}, 'weighted avg': {'precision': 0.34356409452139375, 'recall': 0.33636382175240587, 'f1-score': 0.17846106442543117, 'support': 539407}}
[[   752 178199   1656]
 [   888 178754   1987]
 [   520 174720   1931]]
Evaluating performance on  val set...
798/798 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062807
{'0': {'precision': 0.39863325740318906, 'recall': 0.0073338362249601875, 'f1-score': 0.014402699477387761, 'support': 71586}, '1': {'precision': 0.2997236328807032, 'recall': 0.9792997783283348, 'f1-score': 0.45897406516175854, 'support': 61352}, '2': {'precision': 0.3531844499586435, 'recall': 0.011985123850957827, 'f1-score': 0.023183527208068083, 'support': 71255}, 'accuracy': 0.3009946472210115, 'macro avg': {'precision': 0.35051378008084527, 'recall': 0.3328729128014176, 'f1-score': 0.1655200972824048, 'support': 204193}, 'weighted avg': {'precision': 0.35305501496508074, 'recall': 0.3009946472210115, 'f1-score': 0.1510431342984499, 'support': 204193}}
[[  525 70297   764]
 [  470 60082   800]
 [  322 70079   854]]
training model: results/WBA/W4/deepLOB_L2/h10
Epoch 1/50
2108/2108 - 89s - loss: 2.7449 - accuracy10: 0.5084 - val_loss: 3.0189 - val_accuracy10: 0.4653 - 89s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 86s - loss: 2.4928 - accuracy10: 0.5736 - val_loss: 2.8606 - val_accuracy10: 0.4961 - 86s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 2.3845 - accuracy10: 0.6078 - val_loss: 2.7635 - val_accuracy10: 0.5299 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 2.3366 - accuracy10: 0.6212 - val_loss: 2.7266 - val_accuracy10: 0.5415 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 87s - loss: 2.3098 - accuracy10: 0.6271 - val_loss: 2.7082 - val_accuracy10: 0.5613 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 86s - loss: 2.2896 - accuracy10: 0.6316 - val_loss: 2.7305 - val_accuracy10: 0.5754 - 86s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 87s - loss: 2.2741 - accuracy10: 0.6340 - val_loss: 2.6957 - val_accuracy10: 0.5708 - 87s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 86s - loss: 2.2626 - accuracy10: 0.6360 - val_loss: 2.6989 - val_accuracy10: 0.5792 - 86s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 87s - loss: 2.2525 - accuracy10: 0.6372 - val_loss: 2.6897 - val_accuracy10: 0.5689 - 87s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 86s - loss: 2.2428 - accuracy10: 0.6386 - val_loss: 2.7168 - val_accuracy10: 0.5711 - 86s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 2.2345 - accuracy10: 0.6393 - val_loss: 2.7125 - val_accuracy10: 0.5726 - 86s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 86s - loss: 2.2264 - accuracy10: 0.6402 - val_loss: 2.7218 - val_accuracy10: 0.5671 - 86s/epoch - 41ms/step
Epoch 13/50
2108/2108 - 86s - loss: 2.2202 - accuracy10: 0.6412 - val_loss: 2.7440 - val_accuracy10: 0.5750 - 86s/epoch - 41ms/step
Epoch 14/50
2108/2108 - 86s - loss: 2.2135 - accuracy10: 0.6421 - val_loss: 2.7491 - val_accuracy10: 0.5655 - 86s/epoch - 41ms/step
Epoch 15/50
2108/2108 - 87s - loss: 2.2068 - accuracy10: 0.6430 - val_loss: 2.7104 - val_accuracy10: 0.5807 - 87s/epoch - 41ms/step
Epoch 16/50
2108/2108 - 86s - loss: 2.2002 - accuracy10: 0.6442 - val_loss: 2.7070 - val_accuracy10: 0.5792 - 86s/epoch - 41ms/step
Epoch 17/50
2108/2108 - 86s - loss: 2.1945 - accuracy10: 0.6445 - val_loss: 2.6891 - val_accuracy10: 0.5812 - 86s/epoch - 41ms/step
Epoch 18/50
2108/2108 - 86s - loss: 2.1897 - accuracy10: 0.6447 - val_loss: 2.6758 - val_accuracy10: 0.5901 - 86s/epoch - 41ms/step
Epoch 19/50
2108/2108 - 87s - loss: 2.1833 - accuracy10: 0.6453 - val_loss: 2.7036 - val_accuracy10: 0.5816 - 87s/epoch - 41ms/step
Epoch 20/50
2108/2108 - 87s - loss: 2.1784 - accuracy10: 0.6461 - val_loss: 2.7036 - val_accuracy10: 0.5809 - 87s/epoch - 41ms/step
Epoch 21/50
2108/2108 - 87s - loss: 2.1717 - accuracy10: 0.6475 - val_loss: 2.7049 - val_accuracy10: 0.5982 - 87s/epoch - 41ms/step
Epoch 22/50
2108/2108 - 88s - loss: 2.1666 - accuracy10: 0.6484 - val_loss: 2.6996 - val_accuracy10: 0.5796 - 88s/epoch - 42ms/step
Epoch 23/50
2108/2108 - 86s - loss: 2.1618 - accuracy10: 0.6485 - val_loss: 2.6835 - val_accuracy10: 0.5824 - 86s/epoch - 41ms/step
Epoch 24/50
2108/2108 - 87s - loss: 2.1567 - accuracy10: 0.6494 - val_loss: 2.7325 - val_accuracy10: 0.5854 - 87s/epoch - 41ms/step
Epoch 25/50
2108/2108 - 86s - loss: 2.1525 - accuracy10: 0.6490 - val_loss: 2.6913 - val_accuracy10: 0.5832 - 86s/epoch - 41ms/step
Epoch 26/50
2108/2108 - 86s - loss: 2.1463 - accuracy10: 0.6502 - val_loss: 2.7132 - val_accuracy10: 0.5811 - 86s/epoch - 41ms/step
Epoch 27/50
2108/2108 - 86s - loss: 2.1427 - accuracy10: 0.6501 - val_loss: 2.7007 - val_accuracy10: 0.5872 - 86s/epoch - 41ms/step
Epoch 28/50
2108/2108 - 86s - loss: 2.1377 - accuracy10: 0.6502 - val_loss: 2.7186 - val_accuracy10: 0.5839 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h10
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7323395
{'0': {'precision': 0.3727086122776415, 'recall': 0.699335761731305, 'f1-score': 0.48626431440761775, 'support': 186680}, '1': {'precision': 0.8419632822358342, 'recall': 0.7134638313212222, 'f1-score': 0.772405654935543, 'support': 821111}, '2': {'precision': 0.49319488987251187, 'recall': 0.39340267867525025, 'f1-score': 0.4376826593436319, 'support': 189198}, 'accuracy': 0.6606710671526639, 'macro avg': {'precision': 0.5692889281286625, 'recall': 0.6020674239092592, 'f1-score': 0.5654508762289309, 'support': 1196989}, 'weighted avg': {'precision': 0.7136523753802564, 'recall': 0.6606710671526639, 'f1-score': 0.674872773037922, 'support': 1196989}}
[[130552  42257  13871]
 [172664 585833  62614]
 [ 47063  67704  74431]]
Evaluating performance on  train set...
2108/2108 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.80775714
{'0': {'precision': 0.3486613038780166, 'recall': 0.7418399693454558, 'f1-score': 0.4743706354716196, 'support': 86121}, '1': {'precision': 0.8962861515487776, 'recall': 0.5908916610235867, 'f1-score': 0.7122322675390577, 'support': 367707}, '2': {'precision': 0.4184556147476133, 'recall': 0.5562099064044589, 'f1-score': 0.47759801339453684, 'support': 85581}, 'accuracy': 0.6094892743725077, 'macro avg': {'precision': 0.5544676900581358, 'recall': 0.6296471789245005, 'f1-score': 0.554733638801738, 'support': 539409}, 'weighted avg': {'precision': 0.7330422778347052, 'recall': 0.6094892743725077, 'f1-score': 0.6370293774886097, 'support': 539409}}
[[ 63888  10494  11739]
 [ 96018 217275  54414]
 [ 23332  14648  47601]]
Evaluating performance on  val set...
798/798 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8437739
{'0': {'precision': 0.3555567891639836, 'recall': 0.7135297721829221, 'f1-score': 0.47461143735758876, 'support': 35906}, '1': {'precision': 0.8751081167205353, 'recall': 0.5777463878641251, 'f1-score': 0.6959961260131877, 'support': 133093}, '2': {'precision': 0.4108744267997922, 'recall': 0.5168210490424504, 'f1-score': 0.45779796886601304, 'support': 35194}, 'accuracy': 0.5911221246565749, 'macro avg': {'precision': 0.547179777561437, 'recall': 0.6026990696964992, 'f1-score': 0.5428018440789298, 'support': 204193}, 'weighted avg': {'precision': 0.7037347079831341, 'recall': 0.5911221246565749, 'f1-score': 0.6160120689029753, 'support': 204193}}
[[25620  4994  5292]
 [35411 76894 20788]
 [11025  5980 18189]]
training model: results/WBA/W4/deepLOB_L2/h20
Epoch 1/50
2108/2108 - 89s - loss: 2.8569 - accuracy20: 0.5101 - val_loss: 3.0708 - val_accuracy20: 0.4313 - 89s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 87s - loss: 2.6318 - accuracy20: 0.5665 - val_loss: 2.9764 - val_accuracy20: 0.4942 - 87s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 86s - loss: 2.5359 - accuracy20: 0.5956 - val_loss: 2.9796 - val_accuracy20: 0.5152 - 86s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 88s - loss: 2.4741 - accuracy20: 0.6117 - val_loss: 2.9053 - val_accuracy20: 0.5238 - 88s/epoch - 42ms/step
Epoch 5/50
2108/2108 - 87s - loss: 2.4489 - accuracy20: 0.6180 - val_loss: 2.8898 - val_accuracy20: 0.5099 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 86s - loss: 2.4306 - accuracy20: 0.6207 - val_loss: 2.8769 - val_accuracy20: 0.5319 - 86s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 86s - loss: 2.4087 - accuracy20: 0.6259 - val_loss: 2.8915 - val_accuracy20: 0.5278 - 86s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 86s - loss: 2.3939 - accuracy20: 0.6274 - val_loss: 2.9006 - val_accuracy20: 0.5223 - 86s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 86s - loss: 2.3822 - accuracy20: 0.6288 - val_loss: 2.9073 - val_accuracy20: 0.5222 - 86s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 86s - loss: 2.3720 - accuracy20: 0.6305 - val_loss: 2.9103 - val_accuracy20: 0.5239 - 86s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 2.3630 - accuracy20: 0.6315 - val_loss: 2.9098 - val_accuracy20: 0.5239 - 86s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 87s - loss: 2.3553 - accuracy20: 0.6328 - val_loss: 2.8851 - val_accuracy20: 0.5301 - 87s/epoch - 41ms/step
Epoch 13/50
2108/2108 - 86s - loss: 2.3473 - accuracy20: 0.6338 - val_loss: 2.8785 - val_accuracy20: 0.5327 - 86s/epoch - 41ms/step
Epoch 14/50
2108/2108 - 86s - loss: 2.3415 - accuracy20: 0.6346 - val_loss: 2.8931 - val_accuracy20: 0.5321 - 86s/epoch - 41ms/step
Epoch 15/50
2108/2108 - 87s - loss: 2.3363 - accuracy20: 0.6354 - val_loss: 2.8816 - val_accuracy20: 0.5330 - 87s/epoch - 41ms/step
Epoch 16/50
2108/2108 - 87s - loss: 2.3298 - accuracy20: 0.6362 - val_loss: 2.8860 - val_accuracy20: 0.5321 - 87s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h20
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8473619
{'0': {'precision': 0.4063879207552285, 'recall': 0.7089766405335642, 'f1-score': 0.5166374346295222, 'support': 249492}, '1': {'precision': 0.7491288303362956, 'recall': 0.6706787412283791, 'f1-score': 0.7077364440226869, 'support': 695567}, '2': {'precision': 0.5662930563149262, 'recall': 0.3124558409081888, 'f1-score': 0.40271247832114887, 'support': 251930}, 'accuracy': 0.6032661954286965, 'macro avg': {'precision': 0.5739366024688167, 'recall': 0.5640370742233775, 'f1-score': 0.5423621189911193, 'support': 1196989}, 'weighted avg': {'precision': 0.6392089133091524, 'recall': 0.6032661954286965, 'f1-score': 0.603706781485514, 'support': 1196989}}
[[176884  55160  17448]
 [186226 466502  42839]
 [ 72149 101064  78717]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.92981666
{'0': {'precision': 0.38708350669784836, 'recall': 0.711718049278064, 'f1-score': 0.5014450822287412, 'support': 113722}, '1': {'precision': 0.8323195550499305, 'recall': 0.5264669478976438, 'f1-score': 0.644970692411372, 'support': 312673}, '2': {'precision': 0.45591042501339246, 'recall': 0.5346682711876405, 'f1-score': 0.49215845180838197, 'support': 113014}, 'accuracy': 0.5672411843332239, 'macro avg': {'precision': 0.5584378289203905, 'recall': 0.5909510894544494, 'f1-score': 0.546191408816165, 'support': 539409}, 'weighted avg': {'precision': 0.65958859336289, 'recall': 0.5672411843332239, 'f1-score': 0.5826952353821132, 'support': 539409}}
[[ 80938  13229  19555]
 [ 95504 164612  52557]
 [ 32655  19934  60425]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0091166
{'0': {'precision': 0.3882801563933002, 'recall': 0.6910504499473809, 'f1-score': 0.4971992366471193, 'support': 46561}, '1': {'precision': 0.809548777102674, 'recall': 0.4704574987677555, 'f1-score': 0.5950881647782985, 'support': 111585}, '2': {'precision': 0.4235025407673649, 'recall': 0.5194475210111408, 'f1-score': 0.46659383961141565, 'support': 46047}, 'accuracy': 0.5318056936329845, 'macro avg': {'precision': 0.5404438247544464, 'recall': 0.560318489908759, 'f1-score': 0.5196270803456112, 'support': 204193}, 'weighted avg': {'precision': 0.6264330028431199, 'recall': 0.5318056936329845, 'f1-score': 0.5437906933974221, 'support': 204193}}
[[32176  5294  9091]
 [35620 52496 23469]
 [15072  7056 23919]]
training model: results/WBA/W4/deepLOB_L2/h30
Epoch 1/50
2108/2108 - 90s - loss: 2.9141 - accuracy30: 0.5032 - val_loss: 3.0631 - val_accuracy30: 0.4749 - 90s/epoch - 43ms/step
Epoch 2/50
2108/2108 - 87s - loss: 2.7379 - accuracy30: 0.5523 - val_loss: 3.0912 - val_accuracy30: 0.4664 - 87s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 2.6554 - accuracy30: 0.5772 - val_loss: 3.0383 - val_accuracy30: 0.4872 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 2.5893 - accuracy30: 0.5931 - val_loss: 3.0005 - val_accuracy30: 0.5092 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 87s - loss: 2.5536 - accuracy30: 0.6015 - val_loss: 2.9132 - val_accuracy30: 0.5177 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 87s - loss: 2.5320 - accuracy30: 0.6068 - val_loss: 2.8532 - val_accuracy30: 0.5314 - 87s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 87s - loss: 2.5160 - accuracy30: 0.6099 - val_loss: 2.8441 - val_accuracy30: 0.5364 - 87s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 87s - loss: 2.5057 - accuracy30: 0.6121 - val_loss: 2.8383 - val_accuracy30: 0.5353 - 87s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 87s - loss: 2.4962 - accuracy30: 0.6136 - val_loss: 2.8450 - val_accuracy30: 0.5294 - 87s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 87s - loss: 2.4887 - accuracy30: 0.6147 - val_loss: 2.8472 - val_accuracy30: 0.5354 - 87s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 87s - loss: 2.4806 - accuracy30: 0.6157 - val_loss: 2.8223 - val_accuracy30: 0.5474 - 87s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 86s - loss: 2.4749 - accuracy30: 0.6169 - val_loss: 2.8286 - val_accuracy30: 0.5373 - 86s/epoch - 41ms/step
Epoch 13/50
2108/2108 - 87s - loss: 2.4687 - accuracy30: 0.6181 - val_loss: 2.8196 - val_accuracy30: 0.5453 - 87s/epoch - 41ms/step
Epoch 14/50
2108/2108 - 87s - loss: 2.4623 - accuracy30: 0.6184 - val_loss: 2.8523 - val_accuracy30: 0.5361 - 87s/epoch - 41ms/step
Epoch 15/50
2108/2108 - 86s - loss: 2.4577 - accuracy30: 0.6188 - val_loss: 2.8232 - val_accuracy30: 0.5400 - 86s/epoch - 41ms/step
Epoch 16/50
2108/2108 - 87s - loss: 2.4525 - accuracy30: 0.6192 - val_loss: 2.8161 - val_accuracy30: 0.5500 - 87s/epoch - 41ms/step
Epoch 17/50
2108/2108 - 86s - loss: 2.4481 - accuracy30: 0.6202 - val_loss: 2.8239 - val_accuracy30: 0.5415 - 86s/epoch - 41ms/step
Epoch 18/50
2108/2108 - 86s - loss: 2.4423 - accuracy30: 0.6207 - val_loss: 2.8498 - val_accuracy30: 0.5414 - 86s/epoch - 41ms/step
Epoch 19/50
2108/2108 - 86s - loss: 2.4380 - accuracy30: 0.6213 - val_loss: 2.8375 - val_accuracy30: 0.5453 - 86s/epoch - 41ms/step
Epoch 20/50
2108/2108 - 87s - loss: 2.4339 - accuracy30: 0.6224 - val_loss: 2.8386 - val_accuracy30: 0.5482 - 87s/epoch - 41ms/step
Epoch 21/50
2108/2108 - 86s - loss: 2.4295 - accuracy30: 0.6226 - val_loss: 2.8539 - val_accuracy30: 0.5444 - 86s/epoch - 41ms/step
Epoch 22/50
2108/2108 - 87s - loss: 2.4253 - accuracy30: 0.6235 - val_loss: 2.8454 - val_accuracy30: 0.5514 - 87s/epoch - 41ms/step
Epoch 23/50
2108/2108 - 86s - loss: 2.4213 - accuracy30: 0.6236 - val_loss: 2.8501 - val_accuracy30: 0.5460 - 86s/epoch - 41ms/step
Epoch 24/50
2108/2108 - 86s - loss: 2.4169 - accuracy30: 0.6245 - val_loss: 2.8723 - val_accuracy30: 0.5442 - 86s/epoch - 41ms/step
Epoch 25/50
2108/2108 - 87s - loss: 2.4116 - accuracy30: 0.6255 - val_loss: 2.8965 - val_accuracy30: 0.5376 - 87s/epoch - 41ms/step
Epoch 26/50
2108/2108 - 86s - loss: 2.4087 - accuracy30: 0.6256 - val_loss: 2.9017 - val_accuracy30: 0.5381 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h30
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8924921
{'0': {'precision': 0.43646461744709375, 'recall': 0.652685770784678, 'f1-score': 0.5231127828383506, 'support': 293305}, '1': {'precision': 0.6717671176164212, 'recall': 0.6610767858404288, 'f1-score': 0.6663790797937654, 'support': 608719}, '2': {'precision': 0.5528361918030009, 'recall': 0.2986625531842761, 'f1-score': 0.38781376839028336, 'support': 294965}, 'accuracy': 0.5697136732250673, 'macro avg': {'precision': 0.5536893089555053, 'recall': 0.5374750366031277, 'f1-score': 0.5257685436741332, 'support': 1196989}, 'weighted avg': {'precision': 0.584802358253787, 'recall': 0.5697136732250673, 'f1-score': 0.5626289715583213, 'support': 1196989}}
[[191436  73349  28520]
 [163573 402410  42736]
 [ 83597 123273  88095]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8883386
{'0': {'precision': 0.43988942154744015, 'recall': 0.6055787120937538, 'f1-score': 0.5096045700342499, 'support': 132432}, '1': {'precision': 0.7591883801952991, 'recall': 0.562093094227751, 'f1-score': 0.6459404055628155, 'support': 275248}, '2': {'precision': 0.46430970940282446, 'recall': 0.5403593741696969, 'f1-score': 0.4994562052246399, 'support': 131729}, 'accuracy': 0.5674617961509726, 'macro avg': {'precision': 0.5544625037151879, 'recall': 0.5693437268304006, 'f1-score': 0.5516670602739017, 'support': 539409}, 'weighted avg': {'precision': 0.6087840077868388, 'recall': 0.5674617961509726, 'f1-score': 0.576695278772075, 'support': 539409}}
[[ 80198  21423  30811]
 [ 69220 154715  51313]
 [ 32896  27652  71181]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9282038
{'0': {'precision': 0.4478654780024643, 'recall': 0.5763318907625727, 'f1-score': 0.5040418294682404, 'support': 53608}, '1': {'precision': 0.7276836796677449, 'recall': 0.5301333772435369, 'f1-score': 0.6133950951731693, 'support': 97168}, '2': {'precision': 0.4645058135022276, 'recall': 0.5601774715914409, 'f1-score': 0.5078753521843918, 'support': 53417}, 'accuracy': 0.5501216985890799, 'macro avg': {'precision': 0.5466849903908123, 'recall': 0.5555475798658502, 'f1-score': 0.5417707589419338, 'support': 204193}, 'weighted avg': {'precision': 0.5853738735929246, 'recall': 0.5501216985890799, 'f1-score': 0.5570819111798817, 'support': 204193}}
[[30896  9074 13638]
 [24798 51512 20858]
 [13291 10203 29923]]
training model: results/WBA/W4/deepLOB_L2/h50
Epoch 1/50
2108/2108 - 88s - loss: 3.0187 - accuracy50: 0.4844 - val_loss: 3.3381 - val_accuracy50: 0.4318 - 88s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 86s - loss: 2.8840 - accuracy50: 0.5223 - val_loss: 3.2418 - val_accuracy50: 0.4588 - 86s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 2.8295 - accuracy50: 0.5392 - val_loss: 3.3199 - val_accuracy50: 0.4546 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 2.7893 - accuracy50: 0.5500 - val_loss: 3.2479 - val_accuracy50: 0.4758 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 87s - loss: 2.7549 - accuracy50: 0.5578 - val_loss: 3.1950 - val_accuracy50: 0.4863 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 88s - loss: 2.7305 - accuracy50: 0.5632 - val_loss: 3.2418 - val_accuracy50: 0.4889 - 88s/epoch - 42ms/step
Epoch 7/50
2108/2108 - 88s - loss: 2.7136 - accuracy50: 0.5670 - val_loss: 3.2065 - val_accuracy50: 0.4950 - 88s/epoch - 42ms/step
Epoch 8/50
2108/2108 - 86s - loss: 2.7011 - accuracy50: 0.5700 - val_loss: 3.1594 - val_accuracy50: 0.4977 - 86s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 86s - loss: 2.6913 - accuracy50: 0.5720 - val_loss: 3.1398 - val_accuracy50: 0.5025 - 86s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 87s - loss: 2.6830 - accuracy50: 0.5735 - val_loss: 3.1517 - val_accuracy50: 0.5021 - 87s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 87s - loss: 2.6754 - accuracy50: 0.5756 - val_loss: 3.1410 - val_accuracy50: 0.5009 - 87s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 86s - loss: 2.6686 - accuracy50: 0.5762 - val_loss: 3.1193 - val_accuracy50: 0.5058 - 86s/epoch - 41ms/step
Epoch 13/50
2108/2108 - 87s - loss: 2.6633 - accuracy50: 0.5773 - val_loss: 3.1572 - val_accuracy50: 0.4986 - 87s/epoch - 41ms/step
Epoch 14/50
2108/2108 - 86s - loss: 2.6560 - accuracy50: 0.5784 - val_loss: 3.1624 - val_accuracy50: 0.4960 - 86s/epoch - 41ms/step
Epoch 15/50
2108/2108 - 87s - loss: 2.6508 - accuracy50: 0.5796 - val_loss: 3.1370 - val_accuracy50: 0.4981 - 87s/epoch - 41ms/step
Epoch 16/50
2108/2108 - 87s - loss: 2.6455 - accuracy50: 0.5804 - val_loss: 3.1772 - val_accuracy50: 0.4939 - 87s/epoch - 41ms/step
Epoch 17/50
2108/2108 - 87s - loss: 2.6405 - accuracy50: 0.5815 - val_loss: 3.1190 - val_accuracy50: 0.5002 - 87s/epoch - 41ms/step
Epoch 18/50
2108/2108 - 87s - loss: 2.6354 - accuracy50: 0.5825 - val_loss: 3.1649 - val_accuracy50: 0.4969 - 87s/epoch - 41ms/step
Epoch 19/50
2108/2108 - 87s - loss: 2.6295 - accuracy50: 0.5837 - val_loss: 3.1409 - val_accuracy50: 0.4989 - 87s/epoch - 41ms/step
Epoch 20/50
2108/2108 - 87s - loss: 2.6240 - accuracy50: 0.5851 - val_loss: 3.1970 - val_accuracy50: 0.4958 - 87s/epoch - 41ms/step
Epoch 21/50
2108/2108 - 87s - loss: 2.6205 - accuracy50: 0.5855 - val_loss: 3.2025 - val_accuracy50: 0.4917 - 87s/epoch - 41ms/step
Epoch 22/50
2108/2108 - 87s - loss: 2.6155 - accuracy50: 0.5863 - val_loss: 3.1757 - val_accuracy50: 0.4946 - 87s/epoch - 41ms/step
Epoch 23/50
2108/2108 - 87s - loss: 2.6102 - accuracy50: 0.5872 - val_loss: 3.1985 - val_accuracy50: 0.4921 - 87s/epoch - 41ms/step
Epoch 24/50
2108/2108 - 87s - loss: 2.6056 - accuracy50: 0.5884 - val_loss: 3.2780 - val_accuracy50: 0.4915 - 87s/epoch - 41ms/step
Epoch 25/50
2108/2108 - 86s - loss: 2.6021 - accuracy50: 0.5890 - val_loss: 3.2587 - val_accuracy50: 0.4920 - 86s/epoch - 41ms/step
Epoch 26/50
2108/2108 - 86s - loss: 2.5973 - accuracy50: 0.5901 - val_loss: 3.3369 - val_accuracy50: 0.4842 - 86s/epoch - 41ms/step
Epoch 27/50
2108/2108 - 87s - loss: 2.5920 - accuracy50: 0.5911 - val_loss: 3.3832 - val_accuracy50: 0.4761 - 87s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h50
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98577935
{'0': {'precision': 0.466799638339375, 'recall': 0.630129594209368, 'f1-score': 0.536304910026727, 'support': 353951}, '1': {'precision': 0.5331918064011322, 'recall': 0.7004193318536598, 'f1-score': 0.605470941706417, 'support': 488396}, '2': {'precision': 0.6433089836251433, 'recall': 0.14079832619937852, 'f1-score': 0.23103171463537076, 'support': 354642}, 'accuracy': 0.5138309541691695, 'macro avg': {'precision': 0.5477668094552168, 'recall': 0.49044908408746885, 'f1-score': 0.4576025221228382, 'support': 1196989}, 'weighted avg': {'precision': 0.5461849096689574, 'recall': 0.5138309541691695, 'f1-score': 0.4740802084198221, 'support': 1196989}}
[[223035 117793  13123]
 [131751 342082  14563]
 [123010 181699  49933]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.95820194
{'0': {'precision': 0.46613109723321705, 'recall': 0.5994884331852262, 'f1-score': 0.5244652395391479, 'support': 159119}, '1': {'precision': 0.6118098535804057, 'recall': 0.5935491693949315, 'f1-score': 0.6025411906303284, 'support': 222669}, '2': {'precision': 0.49025634979451593, 'recall': 0.36933530430589834, 'f1-score': 0.42129068442096507, 'support': 157621}, 'accuracy': 0.5297835223364831, 'macro avg': {'precision': 0.5227324335360463, 'recall': 0.5207909689620186, 'f1-score': 0.5160990381968138, 'support': 539409}, 'weighted avg': {'precision': 0.5333172017124465, 'recall': 0.5297835223364831, 'f1-score': 0.5265464384090944, 'support': 539409}}
[[ 95390  37453  26276]
 [ 56251 132165  34253]
 [ 53001  46405  58215]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0204757
{'0': {'precision': 0.4869935752390705, 'recall': 0.46474167008164424, 'f1-score': 0.4756074939714339, 'support': 63446}, '1': {'precision': 0.5315374817191112, 'recall': 0.5853899308983218, 'f1-score': 0.5571654633567401, 'support': 76988}, '2': {'precision': 0.4661558326820483, 'recall': 0.43032356216377293, 'f1-score': 0.44752358971431366, 'support': 63759}, 'accuracy': 0.4994833319457572, 'macro avg': {'precision': 0.4948956298800766, 'recall': 0.49348505438124635, 'f1-score': 0.4934321823474959, 'support': 204193}, 'weighted avg': {'precision': 0.49728164899474375, 'recall': 0.4994833319457572, 'f1-score': 0.49758857704238263, 'support': 204193}}
[[29486 18762 15198]
 [15697 45068 16223]
 [15364 20958 27437]]
training model: results/WBA/W4/deepLOB_L2/h100
Epoch 1/50
2108/2108 - 88s - loss: 3.1675 - accuracy100: 0.4380 - val_loss: 3.3333 - val_accuracy100: 0.4084 - 88s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 87s - loss: 3.0919 - accuracy100: 0.4659 - val_loss: 3.2332 - val_accuracy100: 0.4245 - 87s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 3.0602 - accuracy100: 0.4757 - val_loss: 3.2489 - val_accuracy100: 0.4239 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 3.0399 - accuracy100: 0.4826 - val_loss: 3.3531 - val_accuracy100: 0.4195 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 86s - loss: 3.0239 - accuracy100: 0.4865 - val_loss: 3.5501 - val_accuracy100: 0.4029 - 86s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 87s - loss: 3.0099 - accuracy100: 0.4902 - val_loss: 3.5829 - val_accuracy100: 0.4019 - 87s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 86s - loss: 2.9993 - accuracy100: 0.4932 - val_loss: 3.6520 - val_accuracy100: 0.3975 - 86s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 87s - loss: 2.9899 - accuracy100: 0.4960 - val_loss: 3.6124 - val_accuracy100: 0.4041 - 87s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 87s - loss: 2.9811 - accuracy100: 0.4983 - val_loss: 3.6575 - val_accuracy100: 0.3984 - 87s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 88s - loss: 2.9743 - accuracy100: 0.5004 - val_loss: 3.7316 - val_accuracy100: 0.3961 - 88s/epoch - 42ms/step
Epoch 11/50
2108/2108 - 87s - loss: 2.9677 - accuracy100: 0.5020 - val_loss: 3.7269 - val_accuracy100: 0.4012 - 87s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 87s - loss: 2.9610 - accuracy100: 0.5042 - val_loss: 3.6679 - val_accuracy100: 0.4023 - 87s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h100
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0789982
{'0': {'precision': 0.4191158523228669, 'recall': 0.6648292054572846, 'f1-score': 0.5141228461615973, 'support': 402911}, '1': {'precision': 0.4064977199285341, 'recall': 0.47974879472215176, 'f1-score': 0.4400960409302888, 'support': 394100}, '2': {'precision': 0.505563462284901, 'recall': 0.11723144772962513, 'f1-score': 0.19032890490861046, 'support': 399978}, 'accuracy': 0.42091113619256315, 'macro avg': {'precision': 0.44372567817876735, 'recall': 0.42060314930302045, 'f1-score': 0.38151593066683226, 'support': 1196989}, 'weighted avg': {'precision': 0.44384819001418063, 'recall': 0.42091113619256315, 'f1-score': 0.3815531926592294, 'support': 1196989}}
[[267867 113405  21639]
 [180812 189069  24219]
 [190445 162643  46890]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.062857
{'0': {'precision': 0.4241120628396118, 'recall': 0.5464868273158429, 'f1-score': 0.47758483550393394, 'support': 182385}, '1': {'precision': 0.44612621447186795, 'recall': 0.46945207784196064, 'f1-score': 0.45749201378356735, 'support': 178310}, '2': {'precision': 0.42910975035327364, 'recall': 0.28036415725684616, 'f1-score': 0.3391442369846927, 'support': 178714}, 'accuracy': 0.4328515097078469, 'macro avg': {'precision': 0.43311600922158444, 'recall': 0.4321010208048833, 'f1-score': 0.4247403620907313, 'support': 539409}, 'weighted avg': {'precision': 0.43304498777016387, 'recall': 0.4328515097078469, 'f1-score': 0.4250754703195817, 'support': 539409}}
[[99671 48274 34440]
 [62382 83708 32220]
 [72958 55651 50105]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0777112
{'0': {'precision': 0.42846547314578004, 'recall': 0.47230797423210835, 'f1-score': 0.4493197712232049, 'support': 70941}, '1': {'precision': 0.4141564678077346, 'recall': 0.4430131074683585, 'f1-score': 0.4280990578148462, 'support': 62102}, '2': {'precision': 0.4324759922100598, 'recall': 0.3620520028109628, 'f1-score': 0.3941429380173509, 'support': 71150}, 'accuracy': 0.4249802882566983, 'macro avg': {'precision': 0.4250326443878581, 'recall': 0.4257910281704766, 'f1-score': 0.4238539223518007, 'support': 204193}, 'weighted avg': {'precision': 0.42551106521759546, 'recall': 0.4249802882566983, 'f1-score': 0.4236397507196499, 'support': 204193}}
[[33506 18291 19144]
 [19930 27512 14660]
 [24764 20626 25760]]
training model: results/WBA/W4/deepLOB_L2/h200
Epoch 1/50
2108/2108 - 88s - loss: 3.2632 - accuracy200: 0.3900 - val_loss: 3.4011 - val_accuracy200: 0.3465 - 88s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 87s - loss: 3.2144 - accuracy200: 0.4136 - val_loss: 3.4640 - val_accuracy200: 0.3511 - 87s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 3.1989 - accuracy200: 0.4218 - val_loss: 3.5249 - val_accuracy200: 0.3623 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 3.1879 - accuracy200: 0.4263 - val_loss: 3.5395 - val_accuracy200: 0.3628 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 86s - loss: 3.1790 - accuracy200: 0.4300 - val_loss: 3.5297 - val_accuracy200: 0.3660 - 86s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 86s - loss: 3.1704 - accuracy200: 0.4341 - val_loss: 3.5116 - val_accuracy200: 0.3703 - 86s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 86s - loss: 3.1629 - accuracy200: 0.4362 - val_loss: 3.5232 - val_accuracy200: 0.3693 - 86s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 87s - loss: 3.1571 - accuracy200: 0.4383 - val_loss: 3.5049 - val_accuracy200: 0.3706 - 87s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 88s - loss: 3.1498 - accuracy200: 0.4410 - val_loss: 3.4947 - val_accuracy200: 0.3704 - 88s/epoch - 42ms/step
Epoch 10/50
2108/2108 - 87s - loss: 3.1416 - accuracy200: 0.4448 - val_loss: 3.4287 - val_accuracy200: 0.3689 - 87s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 3.1358 - accuracy200: 0.4465 - val_loss: 3.4470 - val_accuracy200: 0.3663 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h200
Evaluating performance on  test set...
4676/4676 - 63s - 63s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1120749
{'0': {'precision': 0.3462340247383059, 'recall': 0.8710697110486204, 'f1-score': 0.4955114537441742, 'support': 392592}, '1': {'precision': 0.39722452164651667, 'recall': 0.18135512027673398, 'f1-score': 0.24901913472312662, 'support': 415417}, '2': {'precision': 0.4402669519588364, 'recall': 0.0222170805696951, 'f1-score': 0.04229960671448744, 'support': 388980}, 'accuracy': 0.3558554005091108, 'macro avg': {'precision': 0.39457516611455296, 'recall': 0.35821397063168314, 'f1-score': 0.26227673172726274, 'support': 1196989}, 'weighted avg': {'precision': 0.3944878075920833, 'recall': 0.3558554005091108, 'f1-score': 0.26268772357758613, 'support': 1196989}}
[[341975  45328   5289]
 [334381  75338   5698]
 [311343  68995   8642]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1076437
{'0': {'precision': 0.3674944206312657, 'recall': 0.4612357864550335, 'f1-score': 0.40906335178403314, 'support': 179934}, '1': {'precision': 0.36854040442685326, 'recall': 0.5783415294432285, 'f1-score': 0.4501980944692873, 'support': 183217}, '2': {'precision': 0.40097471123220385, 'recall': 0.059282415549932486, 'f1-score': 0.10329334657987219, 'support': 176258}, 'accuracy': 0.3696693974331166, 'macro avg': {'precision': 0.3790031787634409, 'recall': 0.36628657714939816, 'f1-score': 0.32085159761106424, 'support': 539409}, 'weighted avg': {'precision': 0.37878976622953403, 'recall': 0.3696693974331166, 'f1-score': 0.3231214683028329, 'support': 539409}}
[[ 82992  89161   7781]
 [ 69426 105962   7829]
 [ 73414  92395  10449]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1305487
{'0': {'precision': 0.36711972026744305, 'recall': 0.36203488623739377, 'f1-score': 0.3645595734480103, 'support': 69311}, '1': {'precision': 0.3313587212035731, 'recall': 0.6457957912097981, 'f1-score': 0.43798614203892244, 'support': 65482}, '2': {'precision': 0.43310630017027485, 'recall': 0.05131123919308357, 'f1-score': 0.09175233825461854, 'support': 69400}, 'accuracy': 0.34742620951746633, 'macro avg': {'precision': 0.3771949138804303, 'recall': 0.3530473055467585, 'f1-score': 0.29809935124718373, 'support': 204193}, 'weighted avg': {'precision': 0.3780787977311964, 'recall': 0.34742620951746633, 'f1-score': 0.2953862738836213, 'support': 204193}}
[[25093 41840  2378]
 [20911 42288  2283]
 [22347 43492  3561]]
training model: results/WBA/W4/deepLOB_L2/h300
Epoch 1/50
2108/2108 - 89s - loss: 3.2806 - accuracy300: 0.3790 - val_loss: 3.3922 - val_accuracy300: 0.3310 - 89s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 88s - loss: 3.2410 - accuracy300: 0.4013 - val_loss: 3.4383 - val_accuracy300: 0.3321 - 88s/epoch - 42ms/step
Epoch 3/50
2108/2108 - 86s - loss: 3.2244 - accuracy300: 0.4126 - val_loss: 3.4819 - val_accuracy300: 0.3385 - 86s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 86s - loss: 3.2119 - accuracy300: 0.4188 - val_loss: 3.4631 - val_accuracy300: 0.3329 - 86s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 86s - loss: 3.2006 - accuracy300: 0.4248 - val_loss: 3.4444 - val_accuracy300: 0.3382 - 86s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 86s - loss: 3.1915 - accuracy300: 0.4288 - val_loss: 3.4512 - val_accuracy300: 0.3455 - 86s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 87s - loss: 3.1847 - accuracy300: 0.4326 - val_loss: 3.4818 - val_accuracy300: 0.3391 - 87s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 87s - loss: 3.1750 - accuracy300: 0.4364 - val_loss: 3.4844 - val_accuracy300: 0.3406 - 87s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 87s - loss: 3.1682 - accuracy300: 0.4389 - val_loss: 3.4630 - val_accuracy300: 0.3396 - 87s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 87s - loss: 3.1608 - accuracy300: 0.4420 - val_loss: 3.4745 - val_accuracy300: 0.3425 - 87s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 3.1532 - accuracy300: 0.4448 - val_loss: 3.4850 - val_accuracy300: 0.3375 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h300
Evaluating performance on  test set...
4676/4676 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.126501
{'0': {'precision': 0.33932741573252184, 'recall': 0.4297390207985501, 'f1-score': 0.37921881502133375, 'support': 406086}, '1': {'precision': 0.32746734080062745, 'recall': 0.47813561618273703, 'f1-score': 0.38871207563520294, 'support': 391207}, '2': {'precision': 0.3178777062294847, 'recall': 0.08867739482006325, 'f1-score': 0.13867033908583365, 'support': 399696}, 'accuracy': 0.3316697145921976, 'macro avg': {'precision': 0.3282241542542113, 'recall': 0.3321840106004501, 'f1-score': 0.3022004099141235, 'support': 1196989}, 'weighted avg': {'precision': 0.32828879514084763, 'recall': 0.3316697145921976, 'f1-score': 0.30199802716735535, 'support': 1196989}}
[[174511 191730  39845]
 [167944 187050  36213]
 [171830 192422  35444]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1233711
{'0': {'precision': 0.3608529866542567, 'recall': 0.25938535248351696, 'f1-score': 0.30181939177820744, 'support': 185342}, '1': {'precision': 0.32350213376614423, 'recall': 0.5985715031103432, 'f1-score': 0.42000801394507803, 'support': 172489}, '2': {'precision': 0.35148054096910225, 'recall': 0.16846203835266388, 'f1-score': 0.22776025941245015, 'support': 181578}, 'accuracy': 0.33724131410488145, 'macro avg': {'precision': 0.3452785537965011, 'recall': 0.342139631315508, 'f1-score': 0.31652922171191183, 'support': 539409}, 'weighted avg': {'precision': 0.34575416330048137, 'recall': 0.33724131410488145, 'f1-score': 0.3146829667505046, 'support': 539409}}
[[ 48075 108686  28581]
 [ 41383 103247  27859]
 [ 43768 107221  30589]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1354178
{'0': {'precision': 0.35449710436118664, 'recall': 0.2102157244782103, 'f1-score': 0.2639248191753339, 'support': 71341}, '1': {'precision': 0.30854590622268, 'recall': 0.5706098927485193, 'f1-score': 0.4005191040399103, 'support': 62470}, '2': {'precision': 0.36661705386224896, 'recall': 0.24148219715268107, 'f1-score': 0.2911744802597202, 'support': 70382}, 'accuracy': 0.3312503366912676, 'macro avg': {'precision': 0.3432200214820386, 'recall': 0.34076927145980357, 'f1-score': 0.31853946782498815, 'support': 204193}, 'weighted avg': {'precision': 0.3446165253896805, 'recall': 0.3312503366912676, 'f1-score': 0.3151064494071801, 'support': 204193}}
[[14997 40420 15924]
 [13385 35646 13439]
 [13923 39463 16996]]
training model: results/WBA/W4/deepLOB_L2/h500
Epoch 1/50
2108/2108 - 89s - loss: 3.2101 - accuracy500: 0.4210 - val_loss: 3.5641 - val_accuracy500: 0.3484 - 89s/epoch - 42ms/step
Epoch 2/50
2108/2108 - 86s - loss: 3.1791 - accuracy500: 0.4371 - val_loss: 3.7221 - val_accuracy500: 0.3469 - 86s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 3.1597 - accuracy500: 0.4442 - val_loss: 3.5901 - val_accuracy500: 0.3477 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 86s - loss: 3.1522 - accuracy500: 0.4458 - val_loss: 3.7132 - val_accuracy500: 0.3471 - 86s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 87s - loss: 3.1401 - accuracy500: 0.4518 - val_loss: 3.7531 - val_accuracy500: 0.3359 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 87s - loss: 3.1258 - accuracy500: 0.4575 - val_loss: 3.7225 - val_accuracy500: 0.3456 - 87s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 87s - loss: 3.1112 - accuracy500: 0.4630 - val_loss: 3.7222 - val_accuracy500: 0.3398 - 87s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 87s - loss: 3.1001 - accuracy500: 0.4680 - val_loss: 3.6443 - val_accuracy500: 0.3434 - 87s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 87s - loss: 3.0888 - accuracy500: 0.4715 - val_loss: 3.7333 - val_accuracy500: 0.3380 - 87s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 87s - loss: 3.0806 - accuracy500: 0.4756 - val_loss: 3.7408 - val_accuracy500: 0.3413 - 87s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 3.0763 - accuracy500: 0.4771 - val_loss: 3.6546 - val_accuracy500: 0.3450 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h500
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.157207
{'0': {'precision': 0.30655231272696726, 'recall': 0.24369209660381025, 'f1-score': 0.27153161228131006, 'support': 329428}, '1': {'precision': 0.4614551971940163, 'recall': 0.7836524300441826, 'f1-score': 0.5808662299173716, 'support': 549990}, '2': {'precision': 0.22653429602888087, 'recall': 0.000790374435952905, 'f1-score': 0.001575252840632737, 'support': 317571}, 'accuracy': 0.4273481209935931, 'macro avg': {'precision': 0.3315139353166215, 'recall': 0.3427116336946486, 'f1-score': 0.2846576983464381, 'support': 1196989}, 'weighted avg': {'precision': 0.35649732963790326, 'recall': 0.4273481209935931, 'f1-score': 0.34204239837017314, 'support': 1196989}}
[[ 80279 248803    346]
 [118478 431001    511]
 [ 63120 254200    251]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.238038
{'0': {'precision': 0.3393209767258168, 'recall': 0.13750324222005156, 'f1-score': 0.19570203273744072, 'support': 181203}, '1': {'precision': 0.3333570633461907, 'recall': 0.8606636813260259, 'f1-score': 0.4805750965647217, 'support': 179544}, '2': {'precision': 0.31949013157894735, 'recall': 0.004348994190146758, 'f1-score': 0.008581178835301004, 'support': 178662}, 'accuracy': 0.3341064016358644, 'macro avg': {'precision': 0.3307227238836516, 'recall': 0.33417197257874137, 'f1-score': 0.2282861027124878, 'support': 539409}, 'weighted avg': {'precision': 0.3307675352380745, 'recall': 0.3341064016358644, 'f1-score': 0.2285451320775356, 'support': 539409}}
[[ 24916 155402    885]
 [ 24247 154527    770]
 [ 24266 153619    777]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1886348
{'0': {'precision': 0.34972417080978, 'recall': 0.07659034976508315, 'f1-score': 0.12566072826938135, 'support': 67045}, '1': {'precision': 0.34825105087072145, 'recall': 0.9218814312275573, 'f1-score': 0.5055317956640685, 'support': 70457}, '2': {'precision': 0.39392928619079387, 'recall': 0.01770853638421976, 'f1-score': 0.0338934408586721, 'support': 66691}, 'accuracy': 0.3490276356192426, 'macro avg': {'precision': 0.3639681692904318, 'recall': 0.3387267724589534, 'f1-score': 0.22169532159737396, 'support': 204193}, 'weighted avg': {'precision': 0.3636535990386074, 'recall': 0.3490276356192426, 'f1-score': 0.22676372215614465, 'support': 204193}}
[[ 5135 60848  1062]
 [ 4749 64953   755]
 [ 4799 60711  1181]]
training model: results/WBA/W4/deepLOB_L2/h1000
Epoch 1/50
2108/2108 - 91s - loss: 3.2131 - accuracy1000: 0.4216 - val_loss: 3.5742 - val_accuracy1000: 0.3572 - 91s/epoch - 43ms/step
Epoch 2/50
2108/2108 - 87s - loss: 3.1403 - accuracy1000: 0.4463 - val_loss: 3.4869 - val_accuracy1000: 0.3185 - 87s/epoch - 41ms/step
Epoch 3/50
2108/2108 - 87s - loss: 3.0977 - accuracy1000: 0.4630 - val_loss: 3.4748 - val_accuracy1000: 0.3231 - 87s/epoch - 41ms/step
Epoch 4/50
2108/2108 - 87s - loss: 3.0730 - accuracy1000: 0.4707 - val_loss: 3.5644 - val_accuracy1000: 0.3510 - 87s/epoch - 41ms/step
Epoch 5/50
2108/2108 - 87s - loss: 3.0514 - accuracy1000: 0.4775 - val_loss: 3.7039 - val_accuracy1000: 0.3510 - 87s/epoch - 41ms/step
Epoch 6/50
2108/2108 - 87s - loss: 3.0361 - accuracy1000: 0.4832 - val_loss: 3.5192 - val_accuracy1000: 0.3536 - 87s/epoch - 41ms/step
Epoch 7/50
2108/2108 - 86s - loss: 3.0239 - accuracy1000: 0.4866 - val_loss: 3.5966 - val_accuracy1000: 0.3409 - 86s/epoch - 41ms/step
Epoch 8/50
2108/2108 - 86s - loss: 3.0115 - accuracy1000: 0.4913 - val_loss: 3.5569 - val_accuracy1000: 0.3314 - 86s/epoch - 41ms/step
Epoch 9/50
2108/2108 - 86s - loss: 3.0016 - accuracy1000: 0.4937 - val_loss: 3.4920 - val_accuracy1000: 0.3143 - 86s/epoch - 41ms/step
Epoch 10/50
2108/2108 - 86s - loss: 2.9933 - accuracy1000: 0.4969 - val_loss: 3.5120 - val_accuracy1000: 0.3143 - 86s/epoch - 41ms/step
Epoch 11/50
2108/2108 - 86s - loss: 2.9852 - accuracy1000: 0.4990 - val_loss: 3.5351 - val_accuracy1000: 0.3219 - 86s/epoch - 41ms/step
Epoch 12/50
2108/2108 - 86s - loss: 2.9724 - accuracy1000: 0.5023 - val_loss: 3.5263 - val_accuracy1000: 0.2984 - 86s/epoch - 41ms/step
Epoch 13/50
2108/2108 - 86s - loss: 2.9659 - accuracy1000: 0.5045 - val_loss: 3.5561 - val_accuracy1000: 0.3128 - 86s/epoch - 41ms/step
testing model: results/WBA/W4/deepLOB_L2/h1000
Evaluating performance on  test set...
4676/4676 - 62s - 62s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.165187
{'0': {'precision': 0.3251560478559787, 'recall': 0.40964083827381775, 'f1-score': 0.3625415363831479, 'support': 406168}, '1': {'precision': 0.35041069007924264, 'recall': 0.5853994591306515, 'f1-score': 0.43840137579011884, 'support': 409341}, '2': {'precision': 0.7538247566063978, 'recall': 0.002841564433259935, 'f1-score': 0.005661786596608151, 'support': 381480}, 'accuracy': 0.3400991989065898, 'macro avg': {'precision': 0.476463831513873, 'recall': 0.332627287279243, 'f1-score': 0.2688682329232916, 'support': 1196989}, 'weighted avg': {'precision': 0.47040909489018107, 'recall': 0.3400991989065898, 'f1-score': 0.2747462897886677, 'support': 1196989}}
[[166383 239717     68]
 [169427 239628    286]
 [175892 204504   1084]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1557529
{'0': {'precision': 0.35758949793395983, 'recall': 0.27070195932965346, 'f1-score': 0.3081378128170709, 'support': 180623}, '1': {'precision': 0.3591622177874458, 'recall': 0.5064234935214401, 'f1-score': 0.42026614510026145, 'support': 181599}, '2': {'precision': 0.33957180954459576, 'recall': 0.28098562535626204, 'f1-score': 0.3075131869896604, 'support': 177187}, 'accuracy': 0.3534386708416063, 'macro avg': {'precision': 0.3521078417553338, 'recall': 0.35270369273578517, 'f1-score': 0.3453057149689976, 'support': 539409}, 'weighted avg': {'precision': 0.35220045956053064, 'recall': 0.3534386708416063, 'f1-score': 0.3456820833758004, 'support': 539409}}
[[48895 82919 48809]
 [41612 91966 48021]
 [46228 81172 49787]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1566106
{'0': {'precision': 0.3293587389406911, 'recall': 0.19290992136102691, 'f1-score': 0.24330990257738314, 'support': 71593}, '1': {'precision': 0.29639386213320035, 'recall': 0.5136298421807748, 'f1-score': 0.375882166954011, 'support': 61336}, '2': {'precision': 0.3692043809966231, 'recall': 0.289964077233947, 'f1-score': 0.32482139067694704, 'support': 71264}, 'accuracy': 0.3231207729941771, 'macro avg': {'precision': 0.3316523273568382, 'recall': 0.3321679469252496, 'f1-score': 0.3146711534027804, 'support': 204193}, 'weighted avg': {'precision': 0.33336292200088263, 'recall': 0.3231207729941771, 'f1-score': 0.31158005432466224, 'support': 204193}}
[[13811 37720 20062]
 [14589 31504 15243]
 [13533 37067 20664]]
training model: results/WBA/W4/deepOF_L2/h10
Epoch 1/50
2108/2108 - 51s - loss: 2.7214 - accuracy10: 0.5385 - val_loss: 3.1099 - val_accuracy10: 0.6574 - 51s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 2.4179 - accuracy10: 0.6120 - val_loss: 2.8891 - val_accuracy10: 0.6485 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 2.3559 - accuracy10: 0.6207 - val_loss: 2.8157 - val_accuracy10: 0.6349 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 48s - loss: 2.3246 - accuracy10: 0.6247 - val_loss: 2.7955 - val_accuracy10: 0.6355 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 48s - loss: 2.3061 - accuracy10: 0.6274 - val_loss: 2.7844 - val_accuracy10: 0.6298 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.2906 - accuracy10: 0.6289 - val_loss: 2.7660 - val_accuracy10: 0.6316 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 48s - loss: 2.2775 - accuracy10: 0.6313 - val_loss: 2.7767 - val_accuracy10: 0.6321 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 48s - loss: 2.2678 - accuracy10: 0.6323 - val_loss: 2.8042 - val_accuracy10: 0.6292 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 47s - loss: 2.2578 - accuracy10: 0.6332 - val_loss: 2.7881 - val_accuracy10: 0.6312 - 47s/epoch - 22ms/step
Epoch 10/50
2108/2108 - 47s - loss: 2.2494 - accuracy10: 0.6347 - val_loss: 2.7598 - val_accuracy10: 0.6363 - 47s/epoch - 22ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.2422 - accuracy10: 0.6354 - val_loss: 2.7776 - val_accuracy10: 0.6399 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 2.2362 - accuracy10: 0.6359 - val_loss: 2.7791 - val_accuracy10: 0.6312 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 2.2285 - accuracy10: 0.6371 - val_loss: 2.7320 - val_accuracy10: 0.6450 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 48s - loss: 2.2241 - accuracy10: 0.6372 - val_loss: 2.7436 - val_accuracy10: 0.6396 - 48s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 48s - loss: 2.2178 - accuracy10: 0.6379 - val_loss: 2.7382 - val_accuracy10: 0.6391 - 48s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 48s - loss: 2.2129 - accuracy10: 0.6387 - val_loss: 2.7281 - val_accuracy10: 0.6459 - 48s/epoch - 23ms/step
Epoch 17/50
2108/2108 - 48s - loss: 2.2070 - accuracy10: 0.6390 - val_loss: 2.7193 - val_accuracy10: 0.6492 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 48s - loss: 2.2034 - accuracy10: 0.6399 - val_loss: 2.7232 - val_accuracy10: 0.6365 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 2.1980 - accuracy10: 0.6398 - val_loss: 2.7056 - val_accuracy10: 0.6464 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 48s - loss: 2.1918 - accuracy10: 0.6407 - val_loss: 2.7117 - val_accuracy10: 0.6446 - 48s/epoch - 23ms/step
Epoch 21/50
2108/2108 - 48s - loss: 2.1889 - accuracy10: 0.6407 - val_loss: 2.7192 - val_accuracy10: 0.6425 - 48s/epoch - 23ms/step
Epoch 22/50
2108/2108 - 48s - loss: 2.1829 - accuracy10: 0.6417 - val_loss: 2.7173 - val_accuracy10: 0.6488 - 48s/epoch - 23ms/step
Epoch 23/50
2108/2108 - 47s - loss: 2.1784 - accuracy10: 0.6420 - val_loss: 2.7242 - val_accuracy10: 0.6527 - 47s/epoch - 22ms/step
Epoch 24/50
2108/2108 - 48s - loss: 2.1758 - accuracy10: 0.6420 - val_loss: 2.7031 - val_accuracy10: 0.6535 - 48s/epoch - 23ms/step
Epoch 25/50
2108/2108 - 48s - loss: 2.1717 - accuracy10: 0.6431 - val_loss: 2.6974 - val_accuracy10: 0.6490 - 48s/epoch - 23ms/step
Epoch 26/50
2108/2108 - 48s - loss: 2.1672 - accuracy10: 0.6425 - val_loss: 2.7206 - val_accuracy10: 0.6529 - 48s/epoch - 23ms/step
Epoch 27/50
2108/2108 - 47s - loss: 2.1639 - accuracy10: 0.6438 - val_loss: 2.7270 - val_accuracy10: 0.6484 - 47s/epoch - 22ms/step
Epoch 28/50
2108/2108 - 48s - loss: 2.1591 - accuracy10: 0.6438 - val_loss: 2.7405 - val_accuracy10: 0.6518 - 48s/epoch - 23ms/step
Epoch 29/50
2108/2108 - 48s - loss: 2.1547 - accuracy10: 0.6441 - val_loss: 2.7329 - val_accuracy10: 0.6583 - 48s/epoch - 23ms/step
Epoch 30/50
2108/2108 - 48s - loss: 2.1520 - accuracy10: 0.6441 - val_loss: 2.7258 - val_accuracy10: 0.6551 - 48s/epoch - 23ms/step
Epoch 31/50
2108/2108 - 47s - loss: 2.1475 - accuracy10: 0.6454 - val_loss: 2.7248 - val_accuracy10: 0.6492 - 47s/epoch - 23ms/step
Epoch 32/50
2108/2108 - 48s - loss: 2.1434 - accuracy10: 0.6456 - val_loss: 2.7089 - val_accuracy10: 0.6489 - 48s/epoch - 23ms/step
Epoch 33/50
2108/2108 - 47s - loss: 2.1408 - accuracy10: 0.6457 - val_loss: 2.7225 - val_accuracy10: 0.6539 - 47s/epoch - 23ms/step
Epoch 34/50
2108/2108 - 48s - loss: 2.1371 - accuracy10: 0.6453 - val_loss: 2.7315 - val_accuracy10: 0.6569 - 48s/epoch - 23ms/step
Epoch 35/50
2108/2108 - 48s - loss: 2.1325 - accuracy10: 0.6467 - val_loss: 2.7466 - val_accuracy10: 0.6513 - 48s/epoch - 23ms/step
testing model: results/WBA/W4/deepOF_L2/h10
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8399861
{'0': {'precision': 0.42142700632187174, 'recall': 0.5563477608742232, 'f1-score': 0.47957869072740955, 'support': 186680}, '1': {'precision': 0.8490563987619405, 'recall': 0.6661620639428675, 'f1-score': 0.7465711076322115, 'support': 821108}, '2': {'precision': 0.3665594750330553, 'recall': 0.5934502132697664, 'f1-score': 0.4531929235401674, 'support': 189197}, 'accuracy': 0.637542659264736, 'macro avg': {'precision': 0.5456809600389558, 'recall': 0.6053200126956191, 'f1-score': 0.5597809072999295, 'support': 1196985}, 'weighted avg': {'precision': 0.706099865923646, 'recall': 0.637542659264736, 'f1-score': 0.658559631562377, 'support': 1196985}}
[[103859  48320  34501]
 [114592 546991 159525]
 [ 27995  48923 112279]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7383266
{'0': {'precision': 0.4545012599956347, 'recall': 0.5318820387785905, 'f1-score': 0.49015642721105906, 'support': 86130}, '1': {'precision': 0.8564880168762986, 'recall': 0.7342147699553753, 'f1-score': 0.7906519778379074, 'support': 367733}, '2': {'precision': 0.4245489471380635, 'recall': 0.6123164687178528, 'f1-score': 0.5014311561252525, 'support': 85544}, 'accuracy': 0.6825754949416675, 'macro avg': {'precision': 0.5785127413366656, 'recall': 0.6261377591506062, 'f1-score': 0.5940798537247397, 'support': 539407}, 'weighted avg': {'precision': 0.7237998701673771, 'recall': 0.6825754949416675, 'f1-score': 0.6968030145354701, 'support': 539407}}
[[ 45811  24081  16238]
 [ 42978 269995  54760]
 [ 12005  21159  52380]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8083732
{'0': {'precision': 0.4451304139746351, 'recall': 0.5175560625452117, 'f1-score': 0.47861884423403483, 'support': 35942}, '1': {'precision': 0.8455136851184086, 'recall': 0.6927790098861031, 'f1-score': 0.7615639540169089, 'support': 133015}, '2': {'precision': 0.40734985772053317, 'recall': 0.6175218526506981, 'f1-score': 0.4908857104182647, 'support': 35236}, 'accuracy': 0.6489497681115415, 'macro avg': {'precision': 0.5659979856045256, 'recall': 0.6092856416940043, 'f1-score': 0.5770228362230695, 'support': 204193}, 'weighted avg': {'precision': 0.6994277950357857, 'recall': 0.6489497681115415, 'f1-score': 0.6650511855710862, 'support': 204193}}
[[18602  9084  8256]
 [17464 92150 23401]
 [ 5724  7753 21759]]
training model: results/WBA/W4/deepOF_L2/h20
Epoch 1/50
2108/2108 - 51s - loss: 2.7926 - accuracy20: 0.5425 - val_loss: 3.2013 - val_accuracy20: 0.6185 - 51s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 2.5242 - accuracy20: 0.6053 - val_loss: 2.9619 - val_accuracy20: 0.6200 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 2.4671 - accuracy20: 0.6149 - val_loss: 2.9198 - val_accuracy20: 0.6155 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 48s - loss: 2.4390 - accuracy20: 0.6200 - val_loss: 2.8966 - val_accuracy20: 0.6209 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 48s - loss: 2.4226 - accuracy20: 0.6222 - val_loss: 2.8797 - val_accuracy20: 0.6228 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.4101 - accuracy20: 0.6244 - val_loss: 2.8873 - val_accuracy20: 0.6205 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 48s - loss: 2.3983 - accuracy20: 0.6263 - val_loss: 2.8678 - val_accuracy20: 0.6221 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 47s - loss: 2.3901 - accuracy20: 0.6277 - val_loss: 2.8773 - val_accuracy20: 0.6201 - 47s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 47s - loss: 2.3811 - accuracy20: 0.6292 - val_loss: 2.8656 - val_accuracy20: 0.6180 - 47s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 48s - loss: 2.3753 - accuracy20: 0.6297 - val_loss: 2.8468 - val_accuracy20: 0.6244 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 47s - loss: 2.3687 - accuracy20: 0.6305 - val_loss: 2.8655 - val_accuracy20: 0.6203 - 47s/epoch - 22ms/step
Epoch 12/50
2108/2108 - 48s - loss: 2.3621 - accuracy20: 0.6319 - val_loss: 2.8507 - val_accuracy20: 0.6243 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 2.3572 - accuracy20: 0.6323 - val_loss: 2.8453 - val_accuracy20: 0.6249 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 48s - loss: 2.3512 - accuracy20: 0.6330 - val_loss: 2.8501 - val_accuracy20: 0.6226 - 48s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 48s - loss: 2.3463 - accuracy20: 0.6336 - val_loss: 2.8564 - val_accuracy20: 0.6209 - 48s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 48s - loss: 2.3422 - accuracy20: 0.6348 - val_loss: 2.8583 - val_accuracy20: 0.6200 - 48s/epoch - 23ms/step
Epoch 17/50
2108/2108 - 48s - loss: 2.3369 - accuracy20: 0.6350 - val_loss: 2.8388 - val_accuracy20: 0.6208 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 48s - loss: 2.3319 - accuracy20: 0.6362 - val_loss: 2.8523 - val_accuracy20: 0.6208 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 2.3272 - accuracy20: 0.6366 - val_loss: 2.8534 - val_accuracy20: 0.6235 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 47s - loss: 2.3237 - accuracy20: 0.6369 - val_loss: 2.8709 - val_accuracy20: 0.6204 - 47s/epoch - 22ms/step
Epoch 21/50
2108/2108 - 48s - loss: 2.3192 - accuracy20: 0.6373 - val_loss: 2.8365 - val_accuracy20: 0.6215 - 48s/epoch - 23ms/step
Epoch 22/50
2108/2108 - 47s - loss: 2.3148 - accuracy20: 0.6374 - val_loss: 2.8395 - val_accuracy20: 0.6250 - 47s/epoch - 22ms/step
Epoch 23/50
2108/2108 - 49s - loss: 2.3121 - accuracy20: 0.6379 - val_loss: 2.8360 - val_accuracy20: 0.6233 - 49s/epoch - 23ms/step
Epoch 24/50
2108/2108 - 49s - loss: 2.3069 - accuracy20: 0.6386 - val_loss: 2.8311 - val_accuracy20: 0.6268 - 49s/epoch - 23ms/step
Epoch 25/50
2108/2108 - 48s - loss: 2.3029 - accuracy20: 0.6390 - val_loss: 2.8583 - val_accuracy20: 0.6240 - 48s/epoch - 23ms/step
Epoch 26/50
2108/2108 - 48s - loss: 2.2986 - accuracy20: 0.6392 - val_loss: 2.8646 - val_accuracy20: 0.6213 - 48s/epoch - 23ms/step
Epoch 27/50
2108/2108 - 48s - loss: 2.2936 - accuracy20: 0.6400 - val_loss: 2.8507 - val_accuracy20: 0.6213 - 48s/epoch - 23ms/step
Epoch 28/50
2108/2108 - 48s - loss: 2.2910 - accuracy20: 0.6405 - val_loss: 2.8656 - val_accuracy20: 0.6222 - 48s/epoch - 23ms/step
Epoch 29/50
2108/2108 - 48s - loss: 2.2872 - accuracy20: 0.6408 - val_loss: 2.8147 - val_accuracy20: 0.6289 - 48s/epoch - 23ms/step
Epoch 30/50
2108/2108 - 48s - loss: 2.2840 - accuracy20: 0.6418 - val_loss: 2.8429 - val_accuracy20: 0.6238 - 48s/epoch - 23ms/step
Epoch 31/50
2108/2108 - 47s - loss: 2.2797 - accuracy20: 0.6415 - val_loss: 2.8531 - val_accuracy20: 0.6261 - 47s/epoch - 23ms/step
Epoch 32/50
2108/2108 - 48s - loss: 2.2745 - accuracy20: 0.6422 - val_loss: 2.8554 - val_accuracy20: 0.6261 - 48s/epoch - 23ms/step
Epoch 33/50
2108/2108 - 48s - loss: 2.2715 - accuracy20: 0.6424 - val_loss: 2.8598 - val_accuracy20: 0.6268 - 48s/epoch - 23ms/step
Epoch 34/50
2108/2108 - 48s - loss: 2.2672 - accuracy20: 0.6430 - val_loss: 2.8549 - val_accuracy20: 0.6277 - 48s/epoch - 23ms/step
Epoch 35/50
2108/2108 - 48s - loss: 2.2638 - accuracy20: 0.6436 - val_loss: 2.8523 - val_accuracy20: 0.6294 - 48s/epoch - 23ms/step
Epoch 36/50
2108/2108 - 48s - loss: 2.2606 - accuracy20: 0.6436 - val_loss: 2.8423 - val_accuracy20: 0.6257 - 48s/epoch - 23ms/step
Epoch 37/50
2108/2108 - 48s - loss: 2.2574 - accuracy20: 0.6442 - val_loss: 2.8584 - val_accuracy20: 0.6276 - 48s/epoch - 23ms/step
Epoch 38/50
2108/2108 - 48s - loss: 2.2512 - accuracy20: 0.6441 - val_loss: 2.8661 - val_accuracy20: 0.6287 - 48s/epoch - 23ms/step
Epoch 39/50
2108/2108 - 47s - loss: 2.2506 - accuracy20: 0.6450 - val_loss: 2.8631 - val_accuracy20: 0.6260 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L2/h20
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9164419
{'0': {'precision': 0.4740300283535824, 'recall': 0.5173254131444673, 'f1-score': 0.49473230285665004, 'support': 249489}, '1': {'precision': 0.7623897019810789, 'recall': 0.6713918285370065, 'f1-score': 0.7140030823048791, 'support': 695567}, '2': {'precision': 0.43452800451044965, 'recall': 0.5384215394019743, 'f1-score': 0.4809277902757169, 'support': 251929}, 'accuracy': 0.6112933746036918, 'macro avg': {'precision': 0.5569825782817036, 'recall': 0.5757129270278161, 'f1-score': 0.5632210584790821, 'support': 1196985}, 'weighted avg': {'precision': 0.6332816210980866, 'recall': 0.6112933746036918, 'f1-score': 0.6192449418608685, 'support': 1196985}}
[[129067  68146  52276]
 [104325 466998 124244]
 [ 38884  77401 135644]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7885638
{'0': {'precision': 0.5276615527661552, 'recall': 0.46911962572441146, 'f1-score': 0.4966714771193147, 'support': 113713}, '1': {'precision': 0.770709781338834, 'recall': 0.7742639040348964, 'f1-score': 0.7724827546599111, 'support': 312697}, '2': {'precision': 0.49695983764325, 'recall': 0.5461029938847934, 'f1-score': 0.5203737435067125, 'support': 112997}, 'accuracy': 0.6621400908775749, 'macro avg': {'precision': 0.5984437239160798, 'recall': 0.5964955078813671, 'f1-score': 0.5965093250953127, 'support': 539407}, 'weighted avg': {'precision': 0.6621263450774304, 'recall': 0.6621400908775749, 'f1-score': 0.6615259266316285, 'support': 539407}}
[[ 53345  36278  24090]
 [ 32214 242110  38373]
 [ 15538  35751  61708]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.86058825
{'0': {'precision': 0.5094624179031866, 'recall': 0.44985716433619005, 'f1-score': 0.4778080691708397, 'support': 46557}, '1': {'precision': 0.7536754121198049, 'recall': 0.7275074407429986, 'f1-score': 0.7403602724166716, 'support': 111548}, '2': {'precision': 0.47442607565694483, 'recall': 0.5703653879534804, 'f1-score': 0.5179908567825333, 'support': 46088}, 'accuracy': 0.6287336000744393, 'macro avg': {'precision': 0.5791879685599789, 'recall': 0.5825766643442231, 'f1-score': 0.5787197327900149, 'support': 204193}, 'weighted avg': {'precision': 0.6349648403046918, 'recall': 0.6287336000744393, 'f1-score': 0.6303065264299709, 'support': 204193}}
[[20944 13410 12203]
 [13478 81152 16918]
 [ 6688 13113 26287]]
training model: results/WBA/W4/deepOF_L2/h30
Epoch 1/50
2108/2108 - 50s - loss: 2.8574 - accuracy30: 0.5342 - val_loss: 3.2836 - val_accuracy30: 0.5733 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 47s - loss: 2.6210 - accuracy30: 0.5896 - val_loss: 3.0758 - val_accuracy30: 0.5885 - 47s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 47s - loss: 2.5671 - accuracy30: 0.5978 - val_loss: 2.9865 - val_accuracy30: 0.5961 - 47s/epoch - 22ms/step
Epoch 4/50
2108/2108 - 47s - loss: 2.5409 - accuracy30: 0.6024 - val_loss: 2.9439 - val_accuracy30: 0.5966 - 47s/epoch - 22ms/step
Epoch 5/50
2108/2108 - 48s - loss: 2.5247 - accuracy30: 0.6056 - val_loss: 2.9385 - val_accuracy30: 0.5947 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.5116 - accuracy30: 0.6077 - val_loss: 2.9342 - val_accuracy30: 0.5955 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 47s - loss: 2.5015 - accuracy30: 0.6097 - val_loss: 2.9113 - val_accuracy30: 0.5958 - 47s/epoch - 22ms/step
Epoch 8/50
2108/2108 - 48s - loss: 2.4941 - accuracy30: 0.6109 - val_loss: 2.9099 - val_accuracy30: 0.5956 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 49s - loss: 2.4859 - accuracy30: 0.6125 - val_loss: 2.9054 - val_accuracy30: 0.5953 - 49s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 49s - loss: 2.4790 - accuracy30: 0.6142 - val_loss: 2.9157 - val_accuracy30: 0.5967 - 49s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.4726 - accuracy30: 0.6148 - val_loss: 2.8889 - val_accuracy30: 0.5994 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 2.4674 - accuracy30: 0.6157 - val_loss: 2.9069 - val_accuracy30: 0.5992 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 2.4619 - accuracy30: 0.6165 - val_loss: 2.9170 - val_accuracy30: 0.5993 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 47s - loss: 2.4571 - accuracy30: 0.6167 - val_loss: 2.9264 - val_accuracy30: 0.5962 - 47s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 48s - loss: 2.4523 - accuracy30: 0.6173 - val_loss: 2.8957 - val_accuracy30: 0.5994 - 48s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 48s - loss: 2.4484 - accuracy30: 0.6188 - val_loss: 2.8905 - val_accuracy30: 0.5976 - 48s/epoch - 23ms/step
Epoch 17/50
2108/2108 - 48s - loss: 2.4443 - accuracy30: 0.6193 - val_loss: 2.8895 - val_accuracy30: 0.6003 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 47s - loss: 2.4389 - accuracy30: 0.6197 - val_loss: 2.9258 - val_accuracy30: 0.5982 - 47s/epoch - 22ms/step
Epoch 19/50
2108/2108 - 48s - loss: 2.4350 - accuracy30: 0.6204 - val_loss: 2.9072 - val_accuracy30: 0.5986 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 47s - loss: 2.4308 - accuracy30: 0.6213 - val_loss: 2.9072 - val_accuracy30: 0.6015 - 47s/epoch - 22ms/step
Epoch 21/50
2108/2108 - 47s - loss: 2.4281 - accuracy30: 0.6209 - val_loss: 2.9204 - val_accuracy30: 0.5928 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L2/h30
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93111473
{'0': {'precision': 0.4932582157102376, 'recall': 0.500896686691533, 'f1-score': 0.4970481065591241, 'support': 293302}, '1': {'precision': 0.6796238355625872, 'recall': 0.6929847762267975, 'f1-score': 0.6862392783500962, 'support': 608719}, '2': {'precision': 0.4859492557145679, 'recall': 0.4587508984147218, 'f1-score': 0.471958550379391, 'support': 294964}, 'accuracy': 0.5881961762261014, 'macro avg': {'precision': 0.5529437689957976, 'recall': 0.550877453777684, 'f1-score': 0.5517486450962038, 'support': 1196985}, 'weighted avg': {'precision': 0.5862321574678533, 'recall': 0.5881961762261014, 'f1-score': 0.5870774261014994, 'support': 1196985}}
[[146914  95244  51144]
 [ 94890 421833  91996]
 [ 56040 103609 135315]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.84398687
{'0': {'precision': 0.5275405033355688, 'recall': 0.451407084123017, 'f1-score': 0.48651331985140034, 'support': 132437}, '1': {'precision': 0.6929395957732679, 'recall': 0.7882727523561958, 'f1-score': 0.7375382781092524, 'support': 275444}, '2': {'precision': 0.5357801745547435, 'recall': 0.45927041041315025, 'f1-score': 0.49458386211978556, 'support': 131526}, 'accuracy': 0.6253422740157247, 'macro avg': {'precision': 0.5854200912211934, 'recall': 0.566316748964121, 'f1-score': 0.5728784866934794, 'support': 539407}, 'weighted avg': {'precision': 0.6140093823345116, 'recall': 0.6253422740157247, 'f1-score': 0.6166651435110255, 'support': 539407}}
[[ 59783  48725  23929]
 [ 29910 217125  28409]
 [ 23631  47489  60406]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89646053
{'0': {'precision': 0.5157182314617639, 'recall': 0.4557735666238098, 'f1-score': 0.48389649442114424, 'support': 53667}, '1': {'precision': 0.6720490289360274, 'recall': 0.742035822063837, 'f1-score': 0.7053105099048915, 'support': 97091}, '2': {'precision': 0.522396190629918, 'recall': 0.4845326097127351, 'f1-score': 0.5027525073545832, 'support': 53435}, 'accuracy': 0.5994133001621016, 'macro avg': {'precision': 0.5700544836759032, 'recall': 0.5607806661334607, 'f1-score': 0.5639865038935397, 'support': 204193}, 'weighted avg': {'precision': 0.5917989502215845, 'recall': 0.5994133001621016, 'f1-score': 0.5941102589891305, 'support': 204193}}
[[24460 17756 11451]
 [12826 72045 12220]
 [10143 17401 25891]]
training model: results/WBA/W4/deepOF_L2/h50
Epoch 1/50
2108/2108 - 51s - loss: 2.9643 - accuracy50: 0.5067 - val_loss: 3.3974 - val_accuracy50: 0.4876 - 51s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 2.7828 - accuracy50: 0.5520 - val_loss: 3.2311 - val_accuracy50: 0.5101 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 2.7335 - accuracy50: 0.5616 - val_loss: 3.1309 - val_accuracy50: 0.5227 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 47s - loss: 2.7104 - accuracy50: 0.5652 - val_loss: 3.0851 - val_accuracy50: 0.5311 - 47s/epoch - 22ms/step
Epoch 5/50
2108/2108 - 48s - loss: 2.6956 - accuracy50: 0.5681 - val_loss: 3.1056 - val_accuracy50: 0.5310 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.6842 - accuracy50: 0.5706 - val_loss: 3.0560 - val_accuracy50: 0.5355 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 47s - loss: 2.6756 - accuracy50: 0.5725 - val_loss: 3.0788 - val_accuracy50: 0.5342 - 47s/epoch - 22ms/step
Epoch 8/50
2108/2108 - 47s - loss: 2.6689 - accuracy50: 0.5740 - val_loss: 3.0838 - val_accuracy50: 0.5368 - 47s/epoch - 22ms/step
Epoch 9/50
2108/2108 - 48s - loss: 2.6625 - accuracy50: 0.5757 - val_loss: 3.0629 - val_accuracy50: 0.5366 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 47s - loss: 2.6567 - accuracy50: 0.5767 - val_loss: 3.0821 - val_accuracy50: 0.5354 - 47s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.6519 - accuracy50: 0.5773 - val_loss: 3.0787 - val_accuracy50: 0.5361 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 47s - loss: 2.6473 - accuracy50: 0.5785 - val_loss: 3.0738 - val_accuracy50: 0.5381 - 47s/epoch - 22ms/step
Epoch 13/50
2108/2108 - 47s - loss: 2.6413 - accuracy50: 0.5795 - val_loss: 3.0694 - val_accuracy50: 0.5364 - 47s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 47s - loss: 2.6369 - accuracy50: 0.5812 - val_loss: 3.0733 - val_accuracy50: 0.5368 - 47s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 47s - loss: 2.6323 - accuracy50: 0.5814 - val_loss: 3.0763 - val_accuracy50: 0.5377 - 47s/epoch - 22ms/step
Epoch 16/50
2108/2108 - 47s - loss: 2.6279 - accuracy50: 0.5821 - val_loss: 3.0765 - val_accuracy50: 0.5373 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L2/h50
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9735476
{'0': {'precision': 0.5285335175221754, 'recall': 0.41076256748853646, 'f1-score': 0.4622648558333558, 'support': 353949}, '1': {'precision': 0.5414420224052034, 'recall': 0.7581347922587408, 'f1-score': 0.6317226200783959, 'support': 488396}, '2': {'precision': 0.523512262335851, 'recall': 0.3513986013986014, 'f1-score': 0.42052621455543066, 'support': 354640}, 'accuracy': 0.5349097941912389, 'macro avg': {'precision': 0.5311626007544099, 'recall': 0.5067653203819595, 'f1-score': 0.5048378968223941, 'support': 1196985}, 'weighted avg': {'precision': 0.5323127831032589, 'recall': 0.5349097941912389, 'f1-score': 0.5190410915283873, 'support': 1196985}}
[[145389 152888  55672]
 [ 60372 370270  57754]
 [ 69319 160701 124620]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.93806005
{'0': {'precision': 0.5547615954267897, 'recall': 0.37566533233625127, 'f1-score': 0.447976499593464, 'support': 159131}, '1': {'precision': 0.5538317100317969, 'recall': 0.8424612316936798, 'f1-score': 0.6683149798176644, 'support': 222669}, '2': {'precision': 0.5722755444607042, 'recall': 0.33745328570431515, 'f1-score': 0.42455786032736903, 'support': 157607}, 'accuracy': 0.5571952162281913, 'macro avg': {'precision': 0.5602896166397636, 'recall': 0.5185266165780821, 'f1-score': 0.5136164465794991, 'support': 539407}, 'weighted avg': {'precision': 0.5594950607217719, 'recall': 0.5571952162281913, 'f1-score': 0.5320903645863749, 'support': 539407}}
[[ 59780  75535  23816]
 [ 19144 187590  15935]
 [ 28834  75588  53185]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97102946
{'0': {'precision': 0.5391729657625611, 'recall': 0.38186112423240437, 'f1-score': 0.44708268043137617, 'support': 63510}, '1': {'precision': 0.5268247382277015, 'recall': 0.8032605871654975, 'f1-score': 0.6363163933667091, 'support': 76980}, '2': {'precision': 0.5568833652007649, 'recall': 0.3657598543239722, 'f1-score': 0.4415262025904134, 'support': 63703}, 'accuracy': 0.5357039663455653, 'macro avg': {'precision': 0.5409603563970092, 'recall': 0.5169605219072914, 'f1-score': 0.5083084254628328, 'support': 204193}, 'weighted avg': {'precision': 0.5400429222242341, 'recall': 0.5357039663455653, 'f1-score': 0.5166896058101065, 'support': 204193}}
[[24252 27780 11478]
 [ 8083 61835  7062]
 [12645 27758 23300]]
training model: results/WBA/W4/deepOF_L2/h100
Epoch 1/50
2108/2108 - 51s - loss: 3.1435 - accuracy100: 0.4453 - val_loss: 3.4555 - val_accuracy100: 0.3806 - 51s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 47s - loss: 3.0586 - accuracy100: 0.4748 - val_loss: 3.3802 - val_accuracy100: 0.4002 - 47s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 47s - loss: 3.0292 - accuracy100: 0.4826 - val_loss: 3.3467 - val_accuracy100: 0.4092 - 47s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 48s - loss: 3.0104 - accuracy100: 0.4871 - val_loss: 3.3091 - val_accuracy100: 0.4193 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 48s - loss: 2.9988 - accuracy100: 0.4894 - val_loss: 3.2897 - val_accuracy100: 0.4227 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.9896 - accuracy100: 0.4930 - val_loss: 3.2752 - val_accuracy100: 0.4260 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 47s - loss: 2.9828 - accuracy100: 0.4949 - val_loss: 3.2767 - val_accuracy100: 0.4285 - 47s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 48s - loss: 2.9761 - accuracy100: 0.4964 - val_loss: 3.2597 - val_accuracy100: 0.4323 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 48s - loss: 2.9706 - accuracy100: 0.4986 - val_loss: 3.2443 - val_accuracy100: 0.4337 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 48s - loss: 2.9656 - accuracy100: 0.5001 - val_loss: 3.2585 - val_accuracy100: 0.4363 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.9611 - accuracy100: 0.5017 - val_loss: 3.2461 - val_accuracy100: 0.4394 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 2.9571 - accuracy100: 0.5025 - val_loss: 3.2350 - val_accuracy100: 0.4412 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 2.9523 - accuracy100: 0.5038 - val_loss: 3.2541 - val_accuracy100: 0.4411 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 48s - loss: 2.9483 - accuracy100: 0.5049 - val_loss: 3.2554 - val_accuracy100: 0.4401 - 48s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 48s - loss: 2.9437 - accuracy100: 0.5063 - val_loss: 3.2331 - val_accuracy100: 0.4435 - 48s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 47s - loss: 2.9388 - accuracy100: 0.5074 - val_loss: 3.2422 - val_accuracy100: 0.4450 - 47s/epoch - 22ms/step
Epoch 17/50
2108/2108 - 47s - loss: 2.9350 - accuracy100: 0.5084 - val_loss: 3.2589 - val_accuracy100: 0.4441 - 47s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 48s - loss: 2.9302 - accuracy100: 0.5098 - val_loss: 3.2775 - val_accuracy100: 0.4444 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 2.9243 - accuracy100: 0.5121 - val_loss: 3.2851 - val_accuracy100: 0.4435 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 48s - loss: 2.9209 - accuracy100: 0.5129 - val_loss: 3.2802 - val_accuracy100: 0.4450 - 48s/epoch - 23ms/step
Epoch 21/50
2108/2108 - 48s - loss: 2.9138 - accuracy100: 0.5143 - val_loss: 3.2686 - val_accuracy100: 0.4479 - 48s/epoch - 23ms/step
Epoch 22/50
2108/2108 - 48s - loss: 2.9094 - accuracy100: 0.5156 - val_loss: 3.2596 - val_accuracy100: 0.4478 - 48s/epoch - 23ms/step
Epoch 23/50
2108/2108 - 48s - loss: 2.9045 - accuracy100: 0.5172 - val_loss: 3.2884 - val_accuracy100: 0.4473 - 48s/epoch - 23ms/step
Epoch 24/50
2108/2108 - 47s - loss: 2.8985 - accuracy100: 0.5186 - val_loss: 3.2841 - val_accuracy100: 0.4468 - 47s/epoch - 22ms/step
Epoch 25/50
2108/2108 - 47s - loss: 2.8940 - accuracy100: 0.5197 - val_loss: 3.3189 - val_accuracy100: 0.4464 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L2/h100
Evaluating performance on  test set...
4676/4676 - 35s - 35s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0670923
{'0': {'precision': 0.49954596890236236, 'recall': 0.35499827504473713, 'f1-score': 0.4150468709420471, 'support': 402909}, '1': {'precision': 0.4106525768264977, 'recall': 0.6971420886630009, 'f1-score': 0.5168524529718127, 'support': 394099}, '2': {'precision': 0.4924778889252176, 'recall': 0.29749960622735805, 'f1-score': 0.37092696672994613, 'support': 399977}, 'accuracy': 0.4484333554722908, 'macro avg': {'precision': 0.4675588115513592, 'recall': 0.44987998997836537, 'f1-score': 0.43427543021460197, 'support': 1196985}, 'weighted avg': {'precision': 0.46791661151799696, 'recall': 0.4484333554722908, 'f1-score': 0.43382282147217494, 'support': 1196985}}
[[143032 194028  65849]
 [ 62577 274743  56779]
 [ 80715 200269 118993]]
Evaluating performance on  train set...
2108/2108 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0523989
{'0': {'precision': 0.5365723438334223, 'recall': 0.3141193307999803, 'f1-score': 0.396260479787499, 'support': 182367}, '1': {'precision': 0.42123637850945106, 'recall': 0.8087785724302342, 'f1-score': 0.5539557980271435, 'support': 178275}, '2': {'precision': 0.5337332329895081, 'recall': 0.26977316588817724, 'f1-score': 0.3583964090502042, 'support': 178765}, 'accuracy': 0.46290834193846203, 'macro avg': {'precision': 0.49718065177746046, 'recall': 0.46422368970613054, 'f1-score': 0.43620422895494887, 'support': 539407}, 'weighted avg': {'precision': 0.49751268597183856, 'recall': 0.46290834193846203, 'f1-score': 0.43583053033155955, 'support': 539407}}
[[ 57285  98498  26584]
 [ 18544 144185  15546]
 [ 30932  99607  48226]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0795765
{'0': {'precision': 0.5082307341541268, 'recall': 0.3142099995771253, 'f1-score': 0.38833479961325057, 'support': 70943}, '1': {'precision': 0.39418147032415607, 'recall': 0.757184996534438, 'f1-score': 0.5184592461784671, 'support': 62039}, '2': {'precision': 0.5179777464651864, 'recall': 0.29940599064751233, 'f1-score': 0.3794683776351971, 'support': 71211}, 'accuracy': 0.44363420881225113, 'macro avg': {'precision': 0.4734633169811564, 'recall': 0.4569336622530253, 'f1-score': 0.42875414114230487, 'support': 204193}, 'weighted avg': {'precision': 0.47697889013858913, 'recall': 0.44363420881225113, 'f1-score': 0.42477779112118813, 'support': 204193}}
[[22291 35999 12653]
 [ 7876 46975  7188]
 [13693 36197 21321]]
training model: results/WBA/W4/deepOF_L2/h200
Epoch 1/50
2108/2108 - 50s - loss: 3.2584 - accuracy200: 0.3880 - val_loss: 3.3794 - val_accuracy200: 0.3296 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 3.2246 - accuracy200: 0.4044 - val_loss: 3.3628 - val_accuracy200: 0.3354 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 3.2120 - accuracy200: 0.4103 - val_loss: 3.3560 - val_accuracy200: 0.3374 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 47s - loss: 3.2025 - accuracy200: 0.4146 - val_loss: 3.3493 - val_accuracy200: 0.3402 - 47s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 47s - loss: 3.1942 - accuracy200: 0.4185 - val_loss: 3.3453 - val_accuracy200: 0.3472 - 47s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 3.1882 - accuracy200: 0.4220 - val_loss: 3.3441 - val_accuracy200: 0.3490 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 48s - loss: 3.1833 - accuracy200: 0.4244 - val_loss: 3.3564 - val_accuracy200: 0.3558 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 48s - loss: 3.1784 - accuracy200: 0.4270 - val_loss: 3.3451 - val_accuracy200: 0.3557 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 48s - loss: 3.1738 - accuracy200: 0.4285 - val_loss: 3.3387 - val_accuracy200: 0.3646 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 47s - loss: 3.1688 - accuracy200: 0.4311 - val_loss: 3.3616 - val_accuracy200: 0.3613 - 47s/epoch - 22ms/step
Epoch 11/50
2108/2108 - 47s - loss: 3.1660 - accuracy200: 0.4331 - val_loss: 3.3548 - val_accuracy200: 0.3627 - 47s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 3.1610 - accuracy200: 0.4347 - val_loss: 3.3667 - val_accuracy200: 0.3667 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 3.1572 - accuracy200: 0.4367 - val_loss: 3.3493 - val_accuracy200: 0.3676 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 48s - loss: 3.1528 - accuracy200: 0.4383 - val_loss: 3.3586 - val_accuracy200: 0.3648 - 48s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 47s - loss: 3.1476 - accuracy200: 0.4404 - val_loss: 3.3532 - val_accuracy200: 0.3690 - 47s/epoch - 22ms/step
Epoch 16/50
2108/2108 - 48s - loss: 3.1440 - accuracy200: 0.4414 - val_loss: 3.3652 - val_accuracy200: 0.3667 - 48s/epoch - 23ms/step
Epoch 17/50
2108/2108 - 48s - loss: 3.1382 - accuracy200: 0.4445 - val_loss: 3.3763 - val_accuracy200: 0.3678 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 48s - loss: 3.1349 - accuracy200: 0.4451 - val_loss: 3.3795 - val_accuracy200: 0.3713 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 47s - loss: 3.1292 - accuracy200: 0.4481 - val_loss: 3.3898 - val_accuracy200: 0.3709 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepOF_L2/h200
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0869169
{'0': {'precision': 0.44213563748327506, 'recall': 0.27944603926223477, 'f1-score': 0.3424506377951158, 'support': 392591}, '1': {'precision': 0.36011050309809917, 'recall': 0.751839120303503, 'f1-score': 0.48697379478951786, 'support': 415416}, '2': {'precision': 0.44419782456742735, 'recall': 0.09312351855374854, 'f1-score': 0.15396843950905903, 'support': 388978}, 'accuracy': 0.3828427256816084, 'macro avg': {'precision': 0.41548132171626717, 'recall': 0.3748028927064954, 'f1-score': 0.32779762403123086, 'support': 1196985}, 'weighted avg': {'precision': 0.41433879139236096, 'recall': 0.3828427256816084, 'f1-score': 0.33135760259506963, 'support': 1196985}}
[[109708 262469  20414]
 [ 78180 312326  24910]
 [ 60244 292511  36223]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0927482
{'0': {'precision': 0.45592335472764356, 'recall': 0.2706154794497726, 'f1-score': 0.3396375016117622, 'support': 180071}, '1': {'precision': 0.3557491906110886, 'recall': 0.768330255984442, 'f1-score': 0.4863230397394272, 'support': 183058}, '2': {'precision': 0.4482174088524149, 'recall': 0.09449846265557812, 'f1-score': 0.1560885107499426, 'support': 176278}, 'accuracy': 0.3819694590541094, 'macro avg': {'precision': 0.4199633180637157, 'recall': 0.37781473269659754, 'f1-score': 0.3273496840337107, 'support': 539407}, 'weighted avg': {'precision': 0.41940905131326095, 'recall': 0.3819694590541094, 'f1-score': 0.32943428257202834, 'support': 539407}}
[[ 48730 121764   9577]
 [ 31479 140649  10930]
 [ 26673 132947  16658]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093767
{'0': {'precision': 0.43768196663206665, 'recall': 0.2494516911000808, 'f1-score': 0.3177853551832211, 'support': 69304}, '1': {'precision': 0.33501979168073925, 'recall': 0.7566285278413425, 'f1-score': 0.46440877935503194, 'support': 65550}, '2': {'precision': 0.44535190968051885, 'recall': 0.10695279712715787, 'f1-score': 0.1724831668430417, 'support': 69339}, 'accuracy': 0.36387633268525366, 'macro avg': {'precision': 0.40601788933110833, 'recall': 0.3710110053561937, 'f1-score': 0.31822576712709827, 'support': 204193}, 'weighted avg': {'precision': 0.40732990075800196, 'recall': 0.36387633268525366, 'f1-score': 0.31551327444168004, 'support': 204193}}
[[17288 47147  4869]
 [11586 49597  4367]
 [10625 51298  7416]]
training model: results/WBA/W4/deepOF_L2/h300
Epoch 1/50
2108/2108 - 50s - loss: 3.2809 - accuracy300: 0.3748 - val_loss: 3.3153 - val_accuracy300: 0.3231 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 47s - loss: 3.2571 - accuracy300: 0.3880 - val_loss: 3.3157 - val_accuracy300: 0.3191 - 47s/epoch - 22ms/step
Epoch 3/50
2108/2108 - 47s - loss: 3.2482 - accuracy300: 0.3937 - val_loss: 3.3130 - val_accuracy300: 0.3208 - 47s/epoch - 22ms/step
Epoch 4/50
2108/2108 - 47s - loss: 3.2432 - accuracy300: 0.3964 - val_loss: 3.3139 - val_accuracy300: 0.3222 - 47s/epoch - 22ms/step
Epoch 5/50
2108/2108 - 47s - loss: 3.2389 - accuracy300: 0.3993 - val_loss: 3.3137 - val_accuracy300: 0.3242 - 47s/epoch - 22ms/step
Epoch 6/50
2108/2108 - 47s - loss: 3.2355 - accuracy300: 0.4013 - val_loss: 3.3191 - val_accuracy300: 0.3256 - 47s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 47s - loss: 3.2317 - accuracy300: 0.4042 - val_loss: 3.3139 - val_accuracy300: 0.3316 - 47s/epoch - 22ms/step
Epoch 8/50
2108/2108 - 47s - loss: 3.2282 - accuracy300: 0.4064 - val_loss: 3.3126 - val_accuracy300: 0.3339 - 47s/epoch - 22ms/step
Epoch 9/50
2108/2108 - 48s - loss: 3.2251 - accuracy300: 0.4085 - val_loss: 3.3114 - val_accuracy300: 0.3396 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 48s - loss: 3.2216 - accuracy300: 0.4107 - val_loss: 3.3138 - val_accuracy300: 0.3417 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 3.2190 - accuracy300: 0.4124 - val_loss: 3.3112 - val_accuracy300: 0.3438 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 3.2163 - accuracy300: 0.4131 - val_loss: 3.3080 - val_accuracy300: 0.3483 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 48s - loss: 3.2137 - accuracy300: 0.4148 - val_loss: 3.3070 - val_accuracy300: 0.3516 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 47s - loss: 3.2108 - accuracy300: 0.4167 - val_loss: 3.3171 - val_accuracy300: 0.3488 - 47s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 47s - loss: 3.2072 - accuracy300: 0.4183 - val_loss: 3.3196 - val_accuracy300: 0.3487 - 47s/epoch - 22ms/step
Epoch 16/50
2108/2108 - 47s - loss: 3.2039 - accuracy300: 0.4200 - val_loss: 3.3182 - val_accuracy300: 0.3524 - 47s/epoch - 22ms/step
Epoch 17/50
2108/2108 - 47s - loss: 3.2017 - accuracy300: 0.4218 - val_loss: 3.3248 - val_accuracy300: 0.3519 - 47s/epoch - 22ms/step
Epoch 18/50
2108/2108 - 48s - loss: 3.1993 - accuracy300: 0.4229 - val_loss: 3.3387 - val_accuracy300: 0.3507 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 3.1940 - accuracy300: 0.4260 - val_loss: 3.3373 - val_accuracy300: 0.3511 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 48s - loss: 3.1908 - accuracy300: 0.4271 - val_loss: 3.3391 - val_accuracy300: 0.3515 - 48s/epoch - 23ms/step
Epoch 21/50
2108/2108 - 47s - loss: 3.1859 - accuracy300: 0.4293 - val_loss: 3.3451 - val_accuracy300: 0.3489 - 47s/epoch - 22ms/step
Epoch 22/50
2108/2108 - 47s - loss: 3.1827 - accuracy300: 0.4311 - val_loss: 3.3441 - val_accuracy300: 0.3560 - 47s/epoch - 22ms/step
Epoch 23/50
2108/2108 - 48s - loss: 3.1781 - accuracy300: 0.4335 - val_loss: 3.3629 - val_accuracy300: 0.3514 - 48s/epoch - 23ms/step
testing model: results/WBA/W4/deepOF_L2/h300
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094272
{'0': {'precision': 0.4349940611858367, 'recall': 0.2669490377630299, 'f1-score': 0.33085657866023294, 'support': 406085}, '1': {'precision': 0.3388295063241834, 'recall': 0.7248917450141358, 'f1-score': 0.46180277359805627, 'support': 391206}, '2': {'precision': 0.4209291624184569, 'recall': 0.11671929025704664, 'f1-score': 0.1827608834043387, 'support': 399694}, 'accuracy': 0.3664523782670627, 'macro avg': {'precision': 0.39825090997615903, 'recall': 0.3695200243447374, 'f1-score': 0.3251400785542093, 'support': 1196985}, 'weighted avg': {'precision': 0.3988684568573472, 'recall': 0.3664523782670627, 'f1-score': 0.32420150471798365, 'support': 1196985}}
[[108404 265537  32144]
 [ 75589 283582  32035]
 [ 65215 287827  46652]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0952991
{'0': {'precision': 0.43616177636796194, 'recall': 0.2878462517939809, 'f1-score': 0.3468125424577211, 'support': 185342}, '1': {'precision': 0.332714105535021, 'recall': 0.705341244569725, 'f1-score': 0.4521473373463067, 'support': 172413}, '2': {'precision': 0.425912642251992, 'recall': 0.12094003919582498, 'f1-score': 0.1883867205755618, 'support': 181652}, 'accuracy': 0.36508424992630795, 'macro avg': {'precision': 0.39826284138499163, 'recall': 0.37137584518651034, 'f1-score': 0.3291155334598632, 'support': 539407}, 'weighted avg': {'precision': 0.39964482537964696, 'recall': 0.36508424992630795, 'f1-score': 0.3271292988116203, 'support': 539407}}
[[ 53350 116851  15141]
 [ 36332 121610  14471]
 [ 32635 127048  21969]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1074249
{'0': {'precision': 0.4211963645897055, 'recall': 0.27017671707050467, 'f1-score': 0.32919259961239317, 'support': 71357}, '1': {'precision': 0.3172328379334749, 'recall': 0.6882256981095864, 'f1-score': 0.43428502225317145, 'support': 62526}, '2': {'precision': 0.4169850261274316, 'recall': 0.13505902432086475, 'f1-score': 0.20403295983154818, 'support': 70310}, 'accuracy': 0.3516623978295044, 'macro avg': {'precision': 0.38513807621687074, 'recall': 0.3644871465003186, 'f1-score': 0.3225035272323709, 'support': 204193}, 'weighted avg': {'precision': 0.38791156699630147, 'recall': 0.3516623978295044, 'f1-score': 0.3182766257300666, 'support': 204193}}
[[19279 44806  7272]
 [13489 43032  6005]
 [13004 47810  9496]]
training model: results/WBA/W4/deepOF_L2/h500
Epoch 1/50
2108/2108 - 50s - loss: 3.2395 - accuracy500: 0.3995 - val_loss: 3.6325 - val_accuracy500: 0.3469 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 48s - loss: 3.2301 - accuracy500: 0.4037 - val_loss: 3.4303 - val_accuracy500: 0.3480 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 3.2244 - accuracy500: 0.4053 - val_loss: 3.3802 - val_accuracy500: 0.3494 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 48s - loss: 3.2250 - accuracy500: 0.4039 - val_loss: 3.3596 - val_accuracy500: 0.3498 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 48s - loss: 3.2239 - accuracy500: 0.4055 - val_loss: 3.3742 - val_accuracy500: 0.3504 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 53s - loss: 3.2230 - accuracy500: 0.4053 - val_loss: 3.3789 - val_accuracy500: 0.3508 - 53s/epoch - 25ms/step
Epoch 7/50
2108/2108 - 49s - loss: 3.2209 - accuracy500: 0.4067 - val_loss: 3.3793 - val_accuracy500: 0.3520 - 49s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 49s - loss: 3.2216 - accuracy500: 0.4057 - val_loss: 3.3710 - val_accuracy500: 0.3494 - 49s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 48s - loss: 3.2216 - accuracy500: 0.4052 - val_loss: 3.3691 - val_accuracy500: 0.3504 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 48s - loss: 3.2188 - accuracy500: 0.4064 - val_loss: 3.3808 - val_accuracy500: 0.3503 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 3.2159 - accuracy500: 0.4074 - val_loss: 3.3774 - val_accuracy500: 0.3502 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 47s - loss: 3.2145 - accuracy500: 0.4087 - val_loss: 3.3886 - val_accuracy500: 0.3499 - 47s/epoch - 22ms/step
Epoch 13/50
2108/2108 - 48s - loss: 3.2150 - accuracy500: 0.4087 - val_loss: 3.3766 - val_accuracy500: 0.3490 - 48s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 48s - loss: 3.2143 - accuracy500: 0.4092 - val_loss: 3.3776 - val_accuracy500: 0.3477 - 48s/epoch - 23ms/step
testing model: results/WBA/W4/deepOF_L2/h500
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0588502
{'0': {'precision': 0.3559914712153518, 'recall': 0.012670446956542855, 'f1-score': 0.024469959226505408, 'support': 329428}, '1': {'precision': 0.4617702682866048, 'recall': 0.9837851302480595, 'f1-score': 0.6285234367240685, 'support': 549989}, '2': {'precision': 0.32998225901833234, 'recall': 0.01405683192261185, 'f1-score': 0.026964989006209677, 'support': 317568}, 'accuracy': 0.4592446856059182, 'macro avg': {'precision': 0.38258133284009627, 'recall': 0.3368374697090714, 'f1-score': 0.22665279498559454, 'support': 1196985}, 'weighted avg': {'precision': 0.39769415029941574, 'recall': 0.4592446856059182, 'f1-score': 0.30268155724359697, 'support': 1196985}}
[[  4174 320772   4482]
 [  4336 541071   4582]
 [  3215 309889   4464]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1285084
{'0': {'precision': 0.39003776299226756, 'recall': 0.011973634817938924, 'f1-score': 0.02323401657124188, 'support': 181148}, '1': {'precision': 0.33450877698277953, 'recall': 0.9826990197224496, 'f1-score': 0.4991185871382991, 'support': 179643}, '2': {'precision': 0.38839724680432647, 'recall': 0.013268688135441393, 'f1-score': 0.02566073690706915, 'support': 178616}, 'accuracy': 0.3356908605190515, 'macro avg': {'precision': 0.37098126225979117, 'recall': 0.33598044755860995, 'f1-score': 0.18267111353887003, 'support': 539407}, 'weighted avg': {'precision': 0.3710012727851925, 'recall': 0.3356908605190515, 'f1-score': 0.1825252066927679, 'support': 539407}}
[[  2169 176810   2169]
 [  1545 176535   1563]
 [  1847 174399   2370]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1203008
{'0': {'precision': 0.3724756918474196, 'recall': 0.014850820820970074, 'f1-score': 0.02856282531079279, 'support': 67067}, '1': {'precision': 0.3479974962393111, 'recall': 0.9780107534508931, 'f1-score': 0.5133381237643854, 'support': 70489}, '2': {'precision': 0.4073748902546093, 'recall': 0.020889295736602788, 'f1-score': 0.039740771404916206, 'support': 66637}, 'accuracy': 0.3493116806158879, 'macro avg': {'precision': 0.37594935944711333, 'recall': 0.3379169566694886, 'f1-score': 0.19388057349336477, 'support': 204193}, 'weighted avg': {'precision': 0.3754147463401786, 'recall': 0.3493116806158879, 'f1-score': 0.19955884773354668, 'support': 204193}}
[[  996 64832  1239]
 [  764 68939   786]
 [  914 64331  1392]]
training model: results/WBA/W4/deepOF_L2/h1000
Epoch 1/50
2108/2108 - 52s - loss: 3.2567 - accuracy1000: 0.3930 - val_loss: 3.4184 - val_accuracy1000: 0.3208 - 52s/epoch - 25ms/step
Epoch 2/50
2108/2108 - 48s - loss: 3.2227 - accuracy1000: 0.4089 - val_loss: 3.4322 - val_accuracy1000: 0.3213 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 47s - loss: 3.2189 - accuracy1000: 0.4104 - val_loss: 3.4238 - val_accuracy1000: 0.3234 - 47s/epoch - 22ms/step
Epoch 4/50
2108/2108 - 48s - loss: 3.2150 - accuracy1000: 0.4123 - val_loss: 3.4243 - val_accuracy1000: 0.3228 - 48s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 48s - loss: 3.2138 - accuracy1000: 0.4134 - val_loss: 3.4127 - val_accuracy1000: 0.3256 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 47s - loss: 3.2122 - accuracy1000: 0.4146 - val_loss: 3.4102 - val_accuracy1000: 0.3252 - 47s/epoch - 22ms/step
Epoch 7/50
2108/2108 - 48s - loss: 3.2108 - accuracy1000: 0.4153 - val_loss: 3.4098 - val_accuracy1000: 0.3256 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 48s - loss: 3.2086 - accuracy1000: 0.4160 - val_loss: 3.4078 - val_accuracy1000: 0.3252 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 48s - loss: 3.2074 - accuracy1000: 0.4165 - val_loss: 3.4075 - val_accuracy1000: 0.3284 - 48s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 50s - loss: 3.2077 - accuracy1000: 0.4165 - val_loss: 3.4098 - val_accuracy1000: 0.3291 - 50s/epoch - 24ms/step
Epoch 11/50
2108/2108 - 48s - loss: 3.2071 - accuracy1000: 0.4174 - val_loss: 3.4097 - val_accuracy1000: 0.3282 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 48s - loss: 3.2057 - accuracy1000: 0.4184 - val_loss: 3.4100 - val_accuracy1000: 0.3256 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 47s - loss: 3.2030 - accuracy1000: 0.4198 - val_loss: 3.4088 - val_accuracy1000: 0.3246 - 47s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 48s - loss: 3.2009 - accuracy1000: 0.4207 - val_loss: 3.4119 - val_accuracy1000: 0.3223 - 48s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 48s - loss: 3.1984 - accuracy1000: 0.4221 - val_loss: 3.4109 - val_accuracy1000: 0.3231 - 48s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 47s - loss: 3.1958 - accuracy1000: 0.4234 - val_loss: 3.4074 - val_accuracy1000: 0.3239 - 47s/epoch - 22ms/step
Epoch 17/50
2108/2108 - 47s - loss: 3.1944 - accuracy1000: 0.4248 - val_loss: 3.4059 - val_accuracy1000: 0.3234 - 47s/epoch - 22ms/step
Epoch 18/50
2108/2108 - 48s - loss: 3.1928 - accuracy1000: 0.4253 - val_loss: 3.4090 - val_accuracy1000: 0.3213 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 3.1913 - accuracy1000: 0.4263 - val_loss: 3.4118 - val_accuracy1000: 0.3224 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 47s - loss: 3.1891 - accuracy1000: 0.4271 - val_loss: 3.4150 - val_accuracy1000: 0.3212 - 47s/epoch - 22ms/step
Epoch 21/50
2108/2108 - 47s - loss: 3.1867 - accuracy1000: 0.4285 - val_loss: 3.4124 - val_accuracy1000: 0.3223 - 47s/epoch - 22ms/step
Epoch 22/50
2108/2108 - 48s - loss: 3.1855 - accuracy1000: 0.4289 - val_loss: 3.4078 - val_accuracy1000: 0.3237 - 48s/epoch - 23ms/step
Epoch 23/50
2108/2108 - 48s - loss: 3.1832 - accuracy1000: 0.4304 - val_loss: 3.4195 - val_accuracy1000: 0.3199 - 48s/epoch - 23ms/step
Epoch 24/50
2108/2108 - 48s - loss: 3.1816 - accuracy1000: 0.4301 - val_loss: 3.4245 - val_accuracy1000: 0.3173 - 48s/epoch - 23ms/step
Epoch 25/50
2108/2108 - 47s - loss: 3.1795 - accuracy1000: 0.4317 - val_loss: 3.4285 - val_accuracy1000: 0.3172 - 47s/epoch - 22ms/step
Epoch 26/50
2108/2108 - 48s - loss: 3.1766 - accuracy1000: 0.4332 - val_loss: 3.4365 - val_accuracy1000: 0.3142 - 48s/epoch - 23ms/step
Epoch 27/50
2108/2108 - 48s - loss: 3.1750 - accuracy1000: 0.4331 - val_loss: 3.4529 - val_accuracy1000: 0.3117 - 48s/epoch - 23ms/step
testing model: results/WBA/W4/deepOF_L2/h1000
Evaluating performance on  test set...
4676/4676 - 36s - 36s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.115814
{'0': {'precision': 0.386684599865501, 'recall': 0.012741033267022512, 'f1-score': 0.02466922972415749, 'support': 406168}, '1': {'precision': 0.35022005694516173, 'recall': 0.9360262862168368, 'f1-score': 0.5097237881433441, 'support': 409340}, '2': {'precision': 0.38533165116616613, 'recall': 0.09047203370059008, 'f1-score': 0.14653832762969066, 'support': 381477}, 'accuracy': 0.35325505332147017, 'macro avg': {'precision': 0.37407876932560963, 'recall': 0.34641311772814976, 'f1-score': 0.22697711516573074, 'support': 1196985}, 'weighted avg': {'precision': 0.3737834233177683, 'recall': 0.35325505332147017, 'f1-score': 0.22938565541455372, 'support': 1196985}}
[[  5175 368193  32800]
 [  3933 383153  22254]
 [  4275 342689  34513]]
Evaluating performance on  train set...
2108/2108 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1141975
{'0': {'precision': 0.4265476696415923, 'recall': 0.016671557580824663, 'f1-score': 0.032088923939339035, 'support': 180607}, '1': {'precision': 0.3476368725138677, 'recall': 0.9464567882882139, 'f1-score': 0.5084999452761483, 'support': 181629}, '2': {'precision': 0.42071060626073176, 'recall': 0.0898905577097832, 'f1-score': 0.14813092370224998, 'support': 177171}, 'accuracy': 0.3537977816379839, 'macro avg': {'precision': 0.39829838280539726, 'recall': 0.3510063011929406, 'f1-score': 0.22957326430591243, 'support': 539407}, 'weighted avg': {'precision': 0.3980596308735342, 'recall': 0.3537977816379839, 'f1-score': 0.23062052351883658, 'support': 539407}}
[[  3011 163617  13979]
 [  1775 171904   7950]
 [  2273 158972  15926]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1334707
{'0': {'precision': 0.38929618768328444, 'recall': 0.014835302992205179, 'f1-score': 0.028581424765185562, 'support': 71586}, '1': {'precision': 0.3109866596799197, 'recall': 0.928641283087756, 'f1-score': 0.46593827180686637, 'support': 61352}, '2': {'precision': 0.43398499534527135, 'recall': 0.11122026524454424, 'f1-score': 0.17706331828946784, 'support': 71255}, 'accuracy': 0.3230326210986665, 'macro avg': {'precision': 0.3780892809028251, 'recall': 0.35156561710816847, 'f1-score': 0.2238610049538399, 'support': 204193}, 'weighted avg': {'precision': 0.38136180613196996, 'recall': 0.3230326210986665, 'f1-score': 0.21180413368651946, 'support': 204193}}
[[ 1062 63828  6696]
 [  738 56974  3640]
 [  928 62402  7925]]
training model: results/WBA/W4/deepVOL_L2/h10
Epoch 1/50
2108/2108 - 55s - loss: 2.6299 - accuracy10: 0.5543 - val_loss: 2.8531 - val_accuracy10: 0.6284 - 55s/epoch - 26ms/step
Epoch 2/50
2108/2108 - 50s - loss: 2.4392 - accuracy10: 0.6021 - val_loss: 2.7689 - val_accuracy10: 0.6480 - 50s/epoch - 24ms/step
Epoch 3/50
2108/2108 - 50s - loss: 2.3719 - accuracy10: 0.6213 - val_loss: 2.7946 - val_accuracy10: 0.6514 - 50s/epoch - 24ms/step
Epoch 4/50
2108/2108 - 50s - loss: 2.3454 - accuracy10: 0.6251 - val_loss: 2.8514 - val_accuracy10: 0.6686 - 50s/epoch - 24ms/step
Epoch 5/50
2108/2108 - 47s - loss: 2.3309 - accuracy10: 0.6280 - val_loss: 2.7639 - val_accuracy10: 0.6627 - 47s/epoch - 22ms/step
Epoch 6/50
2108/2108 - 51s - loss: 2.3167 - accuracy10: 0.6294 - val_loss: 2.7663 - val_accuracy10: 0.6619 - 51s/epoch - 24ms/step
Epoch 7/50
2108/2108 - 46s - loss: 2.3030 - accuracy10: 0.6314 - val_loss: 2.7617 - val_accuracy10: 0.6640 - 46s/epoch - 22ms/step
Epoch 8/50
2108/2108 - 47s - loss: 2.2929 - accuracy10: 0.6324 - val_loss: 2.7212 - val_accuracy10: 0.6595 - 47s/epoch - 22ms/step
Epoch 9/50
2108/2108 - 53s - loss: 2.2840 - accuracy10: 0.6340 - val_loss: 2.7035 - val_accuracy10: 0.6512 - 53s/epoch - 25ms/step
Epoch 10/50
2108/2108 - 52s - loss: 2.2755 - accuracy10: 0.6349 - val_loss: 2.6765 - val_accuracy10: 0.6471 - 52s/epoch - 25ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.2684 - accuracy10: 0.6368 - val_loss: 2.6641 - val_accuracy10: 0.6484 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 53s - loss: 2.2617 - accuracy10: 0.6376 - val_loss: 2.6591 - val_accuracy10: 0.6491 - 53s/epoch - 25ms/step
Epoch 13/50
2108/2108 - 46s - loss: 2.2553 - accuracy10: 0.6380 - val_loss: 2.6667 - val_accuracy10: 0.6582 - 46s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 50s - loss: 2.2504 - accuracy10: 0.6387 - val_loss: 2.6570 - val_accuracy10: 0.6432 - 50s/epoch - 24ms/step
Epoch 15/50
2108/2108 - 50s - loss: 2.2446 - accuracy10: 0.6398 - val_loss: 2.6710 - val_accuracy10: 0.6505 - 50s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 52s - loss: 2.2382 - accuracy10: 0.6401 - val_loss: 2.6413 - val_accuracy10: 0.6342 - 52s/epoch - 25ms/step
Epoch 17/50
2108/2108 - 47s - loss: 2.2328 - accuracy10: 0.6416 - val_loss: 2.6531 - val_accuracy10: 0.6522 - 47s/epoch - 22ms/step
Epoch 18/50
2108/2108 - 46s - loss: 2.2292 - accuracy10: 0.6421 - val_loss: 2.6511 - val_accuracy10: 0.6469 - 46s/epoch - 22ms/step
Epoch 19/50
2108/2108 - 52s - loss: 2.2244 - accuracy10: 0.6429 - val_loss: 2.6579 - val_accuracy10: 0.6445 - 52s/epoch - 24ms/step
Epoch 20/50
2108/2108 - 53s - loss: 2.2209 - accuracy10: 0.6434 - val_loss: 2.6834 - val_accuracy10: 0.6616 - 53s/epoch - 25ms/step
Epoch 21/50
2108/2108 - 49s - loss: 2.2163 - accuracy10: 0.6447 - val_loss: 2.6682 - val_accuracy10: 0.6530 - 49s/epoch - 23ms/step
Epoch 22/50
2108/2108 - 52s - loss: 2.2122 - accuracy10: 0.6444 - val_loss: 2.6845 - val_accuracy10: 0.6530 - 52s/epoch - 25ms/step
Epoch 23/50
2108/2108 - 49s - loss: 2.2088 - accuracy10: 0.6452 - val_loss: 2.6691 - val_accuracy10: 0.6511 - 49s/epoch - 23ms/step
Epoch 24/50
2108/2108 - 51s - loss: 2.2051 - accuracy10: 0.6455 - val_loss: 2.6791 - val_accuracy10: 0.6531 - 51s/epoch - 24ms/step
Epoch 25/50
2108/2108 - 51s - loss: 2.2019 - accuracy10: 0.6459 - val_loss: 2.6510 - val_accuracy10: 0.6530 - 51s/epoch - 24ms/step
Epoch 26/50
2108/2108 - 50s - loss: 2.1980 - accuracy10: 0.6461 - val_loss: 2.6739 - val_accuracy10: 0.6606 - 50s/epoch - 24ms/step
testing model: results/WBA/W4/deepVOL_L2/h10
Evaluating performance on  test set...
4676/4676 - 39s - 39s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7689425
{'0': {'precision': 0.3810657299574463, 'recall': 0.6706128133704735, 'f1-score': 0.4859803651354992, 'support': 186680}, '1': {'precision': 0.8584898445267517, 'recall': 0.6698546237962955, 'f1-score': 0.75253112600903, 'support': 821111}, '2': {'precision': 0.43834239202016034, 'recall': 0.5277169948942377, 'f1-score': 0.4788954654029527, 'support': 189198}, 'accuracy': 0.6475063680618619, 'macro avg': {'precision': 0.5592993221681194, 'recall': 0.6227281440203355, 'f1-score': 0.5724689855158273, 'support': 1196989}, 'weighted avg': {'precision': 0.7176225588397988, 'recall': 0.6475063680618619, 'f1-score': 0.6677091136469955, 'support': 1196989}}
[[125190  40016  21474]
 [164629 550025 106457]
 [ 38707  50648  99843]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.74704224
{'0': {'precision': 0.3882400062017106, 'recall': 0.6978321199242926, 'f1-score': 0.4989104131298332, 'support': 86121}, '1': {'precision': 0.8746316203092986, 'recall': 0.6779800221371908, 'f1-score': 0.7638520143579594, 'support': 367707}, '2': {'precision': 0.4658017091613862, 'recall': 0.5420011451139856, 'f1-score': 0.50102072779512, 'support': 85581}, 'accuracy': 0.6595755725247446, 'macro avg': {'precision': 0.5762244452241319, 'recall': 0.6392710957251563, 'f1-score': 0.5879277184276376, 'support': 539409}, 'weighted avg': {'precision': 0.7321115570094481, 'recall': 0.6595755725247446, 'f1-score': 0.6798519328341031, 'support': 539409}}
[[ 60098  15892  10131]
 [ 75344 249298  43065]
 [ 19354  19842  46385]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79775876
{'0': {'precision': 0.3838100901352028, 'recall': 0.6830891772962736, 'f1-score': 0.49147380022041887, 'support': 35906}, '1': {'precision': 0.8627527566625605, 'recall': 0.647254175651612, 'f1-score': 0.7396261730387822, 'support': 133093}, '2': {'precision': 0.47161226508407517, 'recall': 0.5419105529351594, 'f1-score': 0.5043234524155803, 'support': 35194}, 'accuracy': 0.6353988628405479, 'macro avg': {'precision': 0.5727250372939462, 'recall': 0.6240846352943484, 'f1-score': 0.5784744752249272, 'support': 204193}, 'weighted avg': {'precision': 0.7111182057967399, 'recall': 0.6353988628405479, 'f1-score': 0.6554342416404036, 'support': 204193}}
[[24527  6361  5018]
 [30598 86145 16350]
 [ 8779  7343 19072]]
training model: results/WBA/W4/deepVOL_L2/h20
Epoch 1/50
2108/2108 - 48s - loss: 2.7359 - accuracy20: 0.5515 - val_loss: 3.0743 - val_accuracy20: 0.6222 - 48s/epoch - 23ms/step
Epoch 2/50
2108/2108 - 49s - loss: 2.5631 - accuracy20: 0.5946 - val_loss: 2.9018 - val_accuracy20: 0.6168 - 49s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 52s - loss: 2.4914 - accuracy20: 0.6133 - val_loss: 2.9255 - val_accuracy20: 0.6285 - 52s/epoch - 25ms/step
Epoch 4/50
2108/2108 - 52s - loss: 2.4639 - accuracy20: 0.6184 - val_loss: 2.8303 - val_accuracy20: 0.6338 - 52s/epoch - 25ms/step
Epoch 5/50
2108/2108 - 47s - loss: 2.4468 - accuracy20: 0.6220 - val_loss: 2.8294 - val_accuracy20: 0.6363 - 47s/epoch - 22ms/step
Epoch 6/50
2108/2108 - 47s - loss: 2.4330 - accuracy20: 0.6231 - val_loss: 2.8410 - val_accuracy20: 0.6400 - 47s/epoch - 22ms/step
Epoch 7/50
2108/2108 - 48s - loss: 2.4232 - accuracy20: 0.6246 - val_loss: 2.8472 - val_accuracy20: 0.6342 - 48s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 50s - loss: 2.4146 - accuracy20: 0.6265 - val_loss: 2.8180 - val_accuracy20: 0.6389 - 50s/epoch - 24ms/step
Epoch 9/50
2108/2108 - 49s - loss: 2.4059 - accuracy20: 0.6281 - val_loss: 2.8098 - val_accuracy20: 0.6371 - 49s/epoch - 23ms/step
Epoch 10/50
2108/2108 - 50s - loss: 2.3995 - accuracy20: 0.6288 - val_loss: 2.8042 - val_accuracy20: 0.6343 - 50s/epoch - 24ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.3922 - accuracy20: 0.6298 - val_loss: 2.8012 - val_accuracy20: 0.6353 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 53s - loss: 2.3869 - accuracy20: 0.6301 - val_loss: 2.8068 - val_accuracy20: 0.6363 - 53s/epoch - 25ms/step
Epoch 13/50
2108/2108 - 47s - loss: 2.3817 - accuracy20: 0.6320 - val_loss: 2.7828 - val_accuracy20: 0.6410 - 47s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 47s - loss: 2.3764 - accuracy20: 0.6321 - val_loss: 2.8191 - val_accuracy20: 0.6412 - 47s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 47s - loss: 2.3714 - accuracy20: 0.6323 - val_loss: 2.8005 - val_accuracy20: 0.6403 - 47s/epoch - 22ms/step
Epoch 16/50
2108/2108 - 47s - loss: 2.3668 - accuracy20: 0.6336 - val_loss: 2.7913 - val_accuracy20: 0.6408 - 47s/epoch - 22ms/step
Epoch 17/50
2108/2108 - 48s - loss: 2.3621 - accuracy20: 0.6345 - val_loss: 2.7921 - val_accuracy20: 0.6418 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 49s - loss: 2.3580 - accuracy20: 0.6349 - val_loss: 2.8083 - val_accuracy20: 0.6379 - 49s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 50s - loss: 2.3537 - accuracy20: 0.6352 - val_loss: 2.8233 - val_accuracy20: 0.6389 - 50s/epoch - 24ms/step
Epoch 20/50
2108/2108 - 52s - loss: 2.3500 - accuracy20: 0.6361 - val_loss: 2.8026 - val_accuracy20: 0.6410 - 52s/epoch - 25ms/step
Epoch 21/50
2108/2108 - 50s - loss: 2.3470 - accuracy20: 0.6360 - val_loss: 2.8245 - val_accuracy20: 0.6377 - 50s/epoch - 24ms/step
Epoch 22/50
2108/2108 - 50s - loss: 2.3441 - accuracy20: 0.6366 - val_loss: 2.8009 - val_accuracy20: 0.6418 - 50s/epoch - 24ms/step
Epoch 23/50
2108/2108 - 50s - loss: 2.3415 - accuracy20: 0.6370 - val_loss: 2.8162 - val_accuracy20: 0.6361 - 50s/epoch - 24ms/step
testing model: results/WBA/W4/deepVOL_L2/h20
Evaluating performance on  test set...
4676/4676 - 37s - 37s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.79246813
{'0': {'precision': 0.5003735196537253, 'recall': 0.5476768794189794, 'f1-score': 0.5229576898788679, 'support': 249492}, '1': {'precision': 0.7390293836432008, 'recall': 0.7789745631980816, 'f1-score': 0.7584764091185878, 'support': 695567}, '2': {'precision': 0.5336307589070397, 'recall': 0.40403683562894455, 'f1-score': 0.4598782862486955, 'support': 251930}, 'accuracy': 0.6518514372312527, 'macro avg': {'precision': 0.5910112207346553, 'recall': 0.5768960927486685, 'f1-score': 0.580437461748717, 'support': 1196989}, 'weighted avg': {'precision': 0.6460554261981087, 'recall': 0.6518514372312527, 'f1-score': 0.6465406591700351, 'support': 1196989}}
[[136641  88593  24258]
 [ 89037 541829  64701]
 [ 47400 102741 101789]]
Evaluating performance on  train set...
2108/2108 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7688818
{'0': {'precision': 0.49532211046839947, 'recall': 0.5707602750567172, 'f1-score': 0.5303721135461098, 'support': 113722}, '1': {'precision': 0.7583180975853538, 'recall': 0.7813242588902783, 'f1-score': 0.7696492930413086, 'support': 312673}, '2': {'precision': 0.5504477542687454, 'recall': 0.41988603181906664, 'f1-score': 0.4763831303771672, 'support': 113014}, 'accuracy': 0.6612051337667707, 'macro avg': {'precision': 0.6013626541074996, 'recall': 0.590656855255354, 'f1-score': 0.5921348456548619, 'support': 539409}, 'weighted avg': {'precision': 0.6593195850902017, 'recall': 0.6612051337667707, 'f1-score': 0.6577596851299126, 'support': 539409}}
[[ 64908  36699  12115]
 [ 41734 244299  26640]
 [ 24400  41161  47453]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81081855
{'0': {'precision': 0.4922506043966341, 'recall': 0.5641201864221129, 'f1-score': 0.5257405924739792, 'support': 46561}, '1': {'precision': 0.7388524475768465, 'recall': 0.7591074069095308, 'f1-score': 0.7488429865313464, 'support': 111585}, '2': {'precision': 0.5514506769825919, 'recall': 0.43340499923990705, 'f1-score': 0.48535330812164845, 'support': 46047}, 'accuracy': 0.6411972986341353, 'macro avg': {'precision': 0.5941845763186908, 'recall': 0.5855441975238502, 'f1-score': 0.5866456290423248, 'support': 204193}, 'weighted avg': {'precision': 0.6403607375237717, 'recall': 0.6411972986341353, 'f1-score': 0.6385513516984362, 'support': 204193}}
[[26266 14289  6006]
 [16653 84705 10227]
 [10440 15650 19957]]
training model: results/WBA/W4/deepVOL_L2/h30
Epoch 1/50
2108/2108 - 50s - loss: 2.8159 - accuracy30: 0.5394 - val_loss: 3.1323 - val_accuracy30: 0.5712 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 51s - loss: 2.6502 - accuracy30: 0.5819 - val_loss: 3.0839 - val_accuracy30: 0.5836 - 51s/epoch - 24ms/step
Epoch 3/50
2108/2108 - 52s - loss: 2.5887 - accuracy30: 0.5965 - val_loss: 3.0294 - val_accuracy30: 0.5894 - 52s/epoch - 25ms/step
Epoch 4/50
2108/2108 - 50s - loss: 2.5656 - accuracy30: 0.6009 - val_loss: 2.9414 - val_accuracy30: 0.6016 - 50s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 52s - loss: 2.5520 - accuracy30: 0.6031 - val_loss: 2.9380 - val_accuracy30: 0.5984 - 52s/epoch - 25ms/step
Epoch 6/50
2108/2108 - 48s - loss: 2.5402 - accuracy30: 0.6059 - val_loss: 2.9425 - val_accuracy30: 0.5994 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 52s - loss: 2.5317 - accuracy30: 0.6068 - val_loss: 2.9353 - val_accuracy30: 0.5983 - 52s/epoch - 25ms/step
Epoch 8/50
2108/2108 - 47s - loss: 2.5243 - accuracy30: 0.6082 - val_loss: 2.9173 - val_accuracy30: 0.6000 - 47s/epoch - 22ms/step
Epoch 9/50
2108/2108 - 53s - loss: 2.5184 - accuracy30: 0.6095 - val_loss: 2.8887 - val_accuracy30: 0.6031 - 53s/epoch - 25ms/step
Epoch 10/50
2108/2108 - 47s - loss: 2.5113 - accuracy30: 0.6104 - val_loss: 2.9042 - val_accuracy30: 0.6016 - 47s/epoch - 22ms/step
Epoch 11/50
2108/2108 - 46s - loss: 2.5059 - accuracy30: 0.6108 - val_loss: 2.9038 - val_accuracy30: 0.5993 - 46s/epoch - 22ms/step
Epoch 12/50
2108/2108 - 47s - loss: 2.5003 - accuracy30: 0.6123 - val_loss: 2.8779 - val_accuracy30: 0.6049 - 47s/epoch - 22ms/step
Epoch 13/50
2108/2108 - 49s - loss: 2.4942 - accuracy30: 0.6125 - val_loss: 2.8632 - val_accuracy30: 0.6018 - 49s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 46s - loss: 2.4903 - accuracy30: 0.6135 - val_loss: 2.8976 - val_accuracy30: 0.5991 - 46s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 49s - loss: 2.4862 - accuracy30: 0.6143 - val_loss: 2.8776 - val_accuracy30: 0.6014 - 49s/epoch - 23ms/step
Epoch 16/50
2108/2108 - 49s - loss: 2.4819 - accuracy30: 0.6146 - val_loss: 2.8723 - val_accuracy30: 0.6001 - 49s/epoch - 23ms/step
Epoch 17/50
2108/2108 - 48s - loss: 2.4780 - accuracy30: 0.6154 - val_loss: 2.8785 - val_accuracy30: 0.6020 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 49s - loss: 2.4745 - accuracy30: 0.6158 - val_loss: 2.8795 - val_accuracy30: 0.6015 - 49s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 49s - loss: 2.4720 - accuracy30: 0.6160 - val_loss: 2.9165 - val_accuracy30: 0.5986 - 49s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 49s - loss: 2.4685 - accuracy30: 0.6171 - val_loss: 2.8918 - val_accuracy30: 0.6016 - 49s/epoch - 23ms/step
Epoch 21/50
2108/2108 - 53s - loss: 2.4656 - accuracy30: 0.6167 - val_loss: 2.8705 - val_accuracy30: 0.6040 - 53s/epoch - 25ms/step
Epoch 22/50
2108/2108 - 52s - loss: 2.4626 - accuracy30: 0.6176 - val_loss: 2.8933 - val_accuracy30: 0.5991 - 52s/epoch - 25ms/step
Epoch 23/50
2108/2108 - 47s - loss: 2.4587 - accuracy30: 0.6178 - val_loss: 2.8923 - val_accuracy30: 0.5998 - 47s/epoch - 22ms/step
testing model: results/WBA/W4/deepVOL_L2/h30
Evaluating performance on  test set...
4676/4676 - 43s - 43s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8602179
{'0': {'precision': 0.5239670673805434, 'recall': 0.4951466903053136, 'f1-score': 0.5091493609733608, 'support': 293305}, '1': {'precision': 0.6514562855770369, 'recall': 0.786441691486548, 'f1-score': 0.7126129827444536, 'support': 608719}, '2': {'precision': 0.5509061026772198, 'recall': 0.34546471615276386, 'f1-score': 0.4246426063638049, 'support': 294965}, 'accuracy': 0.6063973854396323, 'macro avg': {'precision': 0.5754431518782668, 'recall': 0.5423510326482085, 'f1-score': 0.5488016500272065, 'support': 1196989}, 'weighted avg': {'precision': 0.5954390541386804, 'recall': 0.6063973854396323, 'f1-score': 0.5917947633183032, 'support': 1196989}}
[[145229 120191  27885]
 [ 74814 478722  55183]
 [ 57129 135936 101900]]
Evaluating performance on  train set...
2108/2108 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8255402
{'0': {'precision': 0.5224866702727764, 'recall': 0.5105639120454271, 'f1-score': 0.5164564890277342, 'support': 132432}, '1': {'precision': 0.6723486408095669, 'recall': 0.8009104516654072, 'f1-score': 0.7310201665652508, 'support': 275248}, '2': {'precision': 0.5757062834875791, 'recall': 0.3588959150984218, 'f1-score': 0.4421531080341736, 'support': 131729}, 'accuracy': 0.6216822485349707, 'macro avg': {'precision': 0.5901805315233074, 'recall': 0.5567900929364188, 'f1-score': 0.5632099212090529, 'support': 539409}, 'weighted avg': {'precision': 0.6119545399143347, 'recall': 0.6216822485349707, 'f1-score': 0.6077977774377267, 'support': 539409}}
[[ 67615  51708  13109]
 [ 33065 220449  21734]
 [ 28730  55722  47277]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8678704
{'0': {'precision': 0.5076598935828304, 'recall': 0.5303686017012387, 'f1-score': 0.5187658510774171, 'support': 53608}, '1': {'precision': 0.6527456534733231, 'recall': 0.7754713485921291, 'f1-score': 0.7088356341572398, 'support': 97168}, '2': {'precision': 0.5865343511450382, 'recall': 0.3596046202519797, 'f1-score': 0.44585514175960633, 'support': 53417}, 'accuracy': 0.6023321073690088, 'macro avg': {'precision': 0.5823132994003973, 'recall': 0.5551481901817824, 'f1-score': 0.5578188756647544, 'support': 204193}, 'weighted avg': {'precision': 0.5973345152233364, 'recall': 0.6023321073690088, 'f1-score': 0.5901396460785715, 'support': 204193}}
[[28432 19467  5709]
 [13985 75351  7832]
 [13589 20619 19209]]
training model: results/WBA/W4/deepVOL_L2/h50
Epoch 1/50
2108/2108 - 48s - loss: 2.9454 - accuracy50: 0.5110 - val_loss: 3.3517 - val_accuracy50: 0.4900 - 48s/epoch - 23ms/step
Epoch 2/50
2108/2108 - 51s - loss: 2.7958 - accuracy50: 0.5479 - val_loss: 3.2757 - val_accuracy50: 0.4970 - 51s/epoch - 24ms/step
Epoch 3/50
2108/2108 - 52s - loss: 2.7569 - accuracy50: 0.5564 - val_loss: 3.1859 - val_accuracy50: 0.5103 - 52s/epoch - 24ms/step
Epoch 4/50
2108/2108 - 49s - loss: 2.7373 - accuracy50: 0.5612 - val_loss: 3.0948 - val_accuracy50: 0.5272 - 49s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 49s - loss: 2.7219 - accuracy50: 0.5643 - val_loss: 3.1086 - val_accuracy50: 0.5216 - 49s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 53s - loss: 2.7106 - accuracy50: 0.5674 - val_loss: 3.0895 - val_accuracy50: 0.5291 - 53s/epoch - 25ms/step
Epoch 7/50
2108/2108 - 50s - loss: 2.7015 - accuracy50: 0.5684 - val_loss: 3.1095 - val_accuracy50: 0.5238 - 50s/epoch - 24ms/step
Epoch 8/50
2108/2108 - 50s - loss: 2.6954 - accuracy50: 0.5699 - val_loss: 3.1209 - val_accuracy50: 0.5259 - 50s/epoch - 24ms/step
Epoch 9/50
2108/2108 - 50s - loss: 2.6885 - accuracy50: 0.5715 - val_loss: 3.1103 - val_accuracy50: 0.5273 - 50s/epoch - 24ms/step
Epoch 10/50
2108/2108 - 50s - loss: 2.6850 - accuracy50: 0.5716 - val_loss: 3.1166 - val_accuracy50: 0.5260 - 50s/epoch - 24ms/step
Epoch 11/50
2108/2108 - 49s - loss: 2.6804 - accuracy50: 0.5732 - val_loss: 3.1143 - val_accuracy50: 0.5242 - 49s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 53s - loss: 2.6765 - accuracy50: 0.5735 - val_loss: 3.1269 - val_accuracy50: 0.5235 - 53s/epoch - 25ms/step
Epoch 13/50
2108/2108 - 49s - loss: 2.6724 - accuracy50: 0.5735 - val_loss: 3.0999 - val_accuracy50: 0.5249 - 49s/epoch - 23ms/step
Epoch 14/50
2108/2108 - 46s - loss: 2.6693 - accuracy50: 0.5748 - val_loss: 3.1015 - val_accuracy50: 0.5261 - 46s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 50s - loss: 2.6661 - accuracy50: 0.5756 - val_loss: 3.1495 - val_accuracy50: 0.5219 - 50s/epoch - 24ms/step
Epoch 16/50
2108/2108 - 49s - loss: 2.6622 - accuracy50: 0.5757 - val_loss: 3.0935 - val_accuracy50: 0.5293 - 49s/epoch - 23ms/step
testing model: results/WBA/W4/deepVOL_L2/h50
Evaluating performance on  test set...
4676/4676 - 42s - 42s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97724605
{'0': {'precision': 0.5259227623336957, 'recall': 0.45923870818277107, 'f1-score': 0.49032386508461995, 'support': 353951}, '1': {'precision': 0.5266458864645319, 'recall': 0.7991302140066667, 'f1-score': 0.6348864484833499, 'support': 488396}, '2': {'precision': 0.5838435710053328, 'recall': 0.24171981885958235, 'f1-score': 0.3418915227062889, 'support': 354642}, 'accuracy': 0.5334752449688343, 'macro avg': {'precision': 0.5454707399345201, 'recall': 0.5000295803496734, 'f1-score': 0.4890339454247529, 'support': 1196989}, 'weighted avg': {'precision': 0.5433784969828284, 'recall': 0.5334752449688343, 'f1-score': 0.505331057895807, 'support': 1196989}}
[[162548 161587  29816]
 [ 66817 390292  31287]
 [ 79707 189211  85724]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9449484
{'0': {'precision': 0.5271924986210701, 'recall': 0.4805460064480043, 'f1-score': 0.5027896593557976, 'support': 159119}, '1': {'precision': 0.5483265495497396, 'recall': 0.8173567043459126, 'f1-score': 0.6563430871205291, 'support': 222669}, '2': {'precision': 0.6143955164131305, 'recall': 0.2434256856637123, 'f1-score': 0.3486965570202344, 'support': 157621}, 'accuracy': 0.550293005863825, 'macro avg': {'precision': 0.5633048548613134, 'recall': 0.513776132152543, 'f1-score': 0.5026097678321869, 'support': 539409}, 'weighted avg': {'precision': 0.5613983143446458, 'recall': 0.550293005863825, 'f1-score': 0.5211491589631664, 'support': 539409}}
[[ 76464  70003  12652]
 [ 29240 182000  11429]
 [ 39336  79916  38369]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98269165
{'0': {'precision': 0.5074529227606187, 'recall': 0.5135075497273272, 'f1-score': 0.5104622832924661, 'support': 63446}, '1': {'precision': 0.5227561039186723, 'recall': 0.78147243726295, 'f1-score': 0.6264538364622706, 'support': 76988}, '2': {'precision': 0.6181526104417671, 'recall': 0.24140905597641119, 'f1-score': 0.34721799253318897, 'support': 63759}, 'accuracy': 0.5295774096075772, 'macro avg': {'precision': 0.5494538790403527, 'recall': 0.5121296809888961, 'f1-score': 0.4947113707626419, 'support': 204193}, 'weighted avg': {'precision': 0.54778859880171, 'recall': 0.5295774096075772, 'f1-score': 0.5032223924094101, 'support': 204193}}
[[32580 25511  5355]
 [12671 60164  4153]
 [18952 29415 15392]]
training model: results/WBA/W4/deepVOL_L2/h100
Epoch 1/50
2108/2108 - 50s - loss: 3.1322 - accuracy100: 0.4487 - val_loss: 3.3023 - val_accuracy100: 0.4140 - 50s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 50s - loss: 3.0541 - accuracy100: 0.4736 - val_loss: 3.3082 - val_accuracy100: 0.4253 - 50s/epoch - 24ms/step
Epoch 3/50
2108/2108 - 51s - loss: 3.0299 - accuracy100: 0.4801 - val_loss: 3.2719 - val_accuracy100: 0.4310 - 51s/epoch - 24ms/step
Epoch 4/50
2108/2108 - 49s - loss: 3.0161 - accuracy100: 0.4850 - val_loss: 3.2904 - val_accuracy100: 0.4276 - 49s/epoch - 23ms/step
Epoch 5/50
2108/2108 - 49s - loss: 3.0081 - accuracy100: 0.4874 - val_loss: 3.2223 - val_accuracy100: 0.4370 - 49s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 53s - loss: 3.0014 - accuracy100: 0.4895 - val_loss: 3.2608 - val_accuracy100: 0.4378 - 53s/epoch - 25ms/step
Epoch 7/50
2108/2108 - 50s - loss: 2.9965 - accuracy100: 0.4907 - val_loss: 3.2572 - val_accuracy100: 0.4401 - 50s/epoch - 24ms/step
Epoch 8/50
2108/2108 - 48s - loss: 2.9924 - accuracy100: 0.4928 - val_loss: 3.2425 - val_accuracy100: 0.4416 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 50s - loss: 2.9883 - accuracy100: 0.4941 - val_loss: 3.2565 - val_accuracy100: 0.4403 - 50s/epoch - 24ms/step
Epoch 10/50
2108/2108 - 48s - loss: 2.9850 - accuracy100: 0.4946 - val_loss: 3.2683 - val_accuracy100: 0.4419 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 48s - loss: 2.9818 - accuracy100: 0.4956 - val_loss: 3.2456 - val_accuracy100: 0.4428 - 48s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 49s - loss: 2.9784 - accuracy100: 0.4967 - val_loss: 3.2814 - val_accuracy100: 0.4424 - 49s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 51s - loss: 2.9747 - accuracy100: 0.4975 - val_loss: 3.2620 - val_accuracy100: 0.4422 - 51s/epoch - 24ms/step
Epoch 14/50
2108/2108 - 52s - loss: 2.9728 - accuracy100: 0.4987 - val_loss: 3.2996 - val_accuracy100: 0.4405 - 52s/epoch - 25ms/step
Epoch 15/50
2108/2108 - 50s - loss: 2.9704 - accuracy100: 0.4990 - val_loss: 3.2811 - val_accuracy100: 0.4418 - 50s/epoch - 24ms/step
testing model: results/WBA/W4/deepVOL_L2/h100
Evaluating performance on  test set...
4676/4676 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0714583
{'0': {'precision': 0.48720113275438326, 'recall': 0.40393784235228125, 'f1-score': 0.44167964785254094, 'support': 402911}, '1': {'precision': 0.40600092451217973, 'recall': 0.7354478558741436, 'f1-score': 0.5231816171626097, 'support': 394100}, '2': {'precision': 0.5056224252915208, 'recall': 0.18841286270744892, 'f1-score': 0.2745271609255697, 'support': 399978}, 'accuracy': 0.4410667098862229, 'macro avg': {'precision': 0.4662748275193613, 'recall': 0.4425995203112913, 'f1-score': 0.41312947531357347, 'support': 1196989}, 'weighted avg': {'precision': 0.4666220878994738, 'recall': 0.4410667098862229, 'f1-score': 0.4126590041281809, 'support': 1196989}}
[[162751 193330  46830]
 [ 77405 289840  26855]
 [ 93897 230720  75361]]
Evaluating performance on  train set...
2108/2108 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0514314
{'0': {'precision': 0.49348089270886814, 'recall': 0.4268717273898621, 'f1-score': 0.457765939932736, 'support': 182385}, '1': {'precision': 0.4205424156417534, 'recall': 0.7478772923560092, 'f1-score': 0.5383581276114733, 'support': 178310}, '2': {'precision': 0.5262774627374422, 'recall': 0.19006345333885427, 'f1-score': 0.27926957608445424, 'support': 178714}, 'accuracy': 0.4545270842718605, 'macro avg': {'precision': 0.4801002570293546, 'recall': 0.45493749102824194, 'f1-score': 0.4251312145428878, 'support': 539409}, 'weighted avg': {'precision': 0.4802359271451666, 'recall': 0.4545270842718605, 'f1-score': 0.42526850999777716, 'support': 539409}}
[[ 77855  84544  19986]
 [ 34367 133354  10589]
 [ 45545  99202  33967]]
Evaluating performance on  val set...
798/798 - 8s - 8s/epoch - 11ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0741538
{'0': {'precision': 0.46799593250151156, 'recall': 0.48007499189467306, 'f1-score': 0.4739585145393944, 'support': 70941}, '1': {'precision': 0.39484176774013663, 'recall': 0.6840842484944124, 'f1-score': 0.500692410590641, 'support': 62102}, '2': {'precision': 0.5274909762444389, 'recall': 0.1766408995080815, 'f1-score': 0.2646563342318059, 'support': 71150}, 'accuracy': 0.4363910613977952, 'macro avg': {'precision': 0.463442892162029, 'recall': 0.4469333799657223, 'f1-score': 0.4131024197872804, 'support': 204193}, 'weighted avg': {'precision': 0.46647801769688246, 'recall': 0.4363910613977952, 'f1-score': 0.40915892926315867, 'support': 204193}}
[[34057 29604  7280]
 [15641 42483  3978]
 [23074 35508 12568]]
training model: results/WBA/W4/deepVOL_L2/h200
Epoch 1/50
2108/2108 - 49s - loss: 3.2698 - accuracy200: 0.3859 - val_loss: 3.3137 - val_accuracy200: 0.3439 - 49s/epoch - 23ms/step
Epoch 2/50
2108/2108 - 48s - loss: 3.2337 - accuracy200: 0.4032 - val_loss: 3.3700 - val_accuracy200: 0.3338 - 48s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 48s - loss: 3.2172 - accuracy200: 0.4106 - val_loss: 3.4372 - val_accuracy200: 0.3353 - 48s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 51s - loss: 3.2071 - accuracy200: 0.4157 - val_loss: 3.4661 - val_accuracy200: 0.3371 - 51s/epoch - 24ms/step
Epoch 5/50
2108/2108 - 49s - loss: 3.1997 - accuracy200: 0.4198 - val_loss: 3.4735 - val_accuracy200: 0.3348 - 49s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 50s - loss: 3.1945 - accuracy200: 0.4213 - val_loss: 3.4677 - val_accuracy200: 0.3375 - 50s/epoch - 24ms/step
Epoch 7/50
2108/2108 - 53s - loss: 3.1902 - accuracy200: 0.4240 - val_loss: 3.4437 - val_accuracy200: 0.3420 - 53s/epoch - 25ms/step
Epoch 8/50
2108/2108 - 48s - loss: 3.1853 - accuracy200: 0.4248 - val_loss: 3.4330 - val_accuracy200: 0.3468 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 52s - loss: 3.1820 - accuracy200: 0.4269 - val_loss: 3.4105 - val_accuracy200: 0.3477 - 52s/epoch - 25ms/step
Epoch 10/50
2108/2108 - 50s - loss: 3.1787 - accuracy200: 0.4279 - val_loss: 3.4216 - val_accuracy200: 0.3505 - 50s/epoch - 24ms/step
Epoch 11/50
2108/2108 - 48s - loss: 3.1769 - accuracy200: 0.4284 - val_loss: 3.4079 - val_accuracy200: 0.3469 - 48s/epoch - 23ms/step
testing model: results/WBA/W4/deepVOL_L2/h200
Evaluating performance on  test set...
4676/4676 - 44s - 44s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0929952
{'0': {'precision': 0.442415365897257, 'recall': 0.1954318987651302, 'f1-score': 0.2711058894198917, 'support': 392592}, '1': {'precision': 0.3535545971153104, 'recall': 0.8599672136672307, 'f1-score': 0.5010958337278334, 'support': 415417}, '2': {'precision': 0.3963284582571603, 'recall': 0.013376009049308447, 'f1-score': 0.02587861967431635, 'support': 388980}, 'accuracy': 0.36689810850392107, 'macro avg': {'precision': 0.3974328070899092, 'recall': 0.35625837382722314, 'f1-score': 0.2660267809406805, 'support': 1196989}, 'weighted avg': {'precision': 0.39659944000409114, 'recall': 0.36689810850392107, 'f1-score': 0.271233901714857, 'support': 1196989}}
[[ 76725 312503   3364]
 [ 53611 357245   4561]
 [ 43087 340690   5203]]
Evaluating performance on  train set...
2108/2108 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956905
{'0': {'precision': 0.43993707627413586, 'recall': 0.17563106472373202, 'f1-score': 0.2510416377047031, 'support': 179934}, '1': {'precision': 0.34374925818905333, 'recall': 0.8694116812304535, 'f1-score': 0.492695751689581, 'support': 183217}, '2': {'precision': 0.40545063351661487, 'recall': 0.009622258280475212, 'f1-score': 0.018798388392881882, 'support': 176258}, 'accuracy': 0.3570370535159777, 'macro avg': {'precision': 0.39637898932660137, 'recall': 0.3515550014115536, 'f1-score': 0.254178592595722, 'support': 539409}, 'weighted avg': {'precision': 0.39599684744285996, 'recall': 0.3570370535159777, 'f1-score': 0.25723436189870874, 'support': 539409}}
[[ 31602 147293   1039]
 [ 22478 159291   1448]
 [ 17753 156809   1696]]
Evaluating performance on  val set...
798/798 - 9s - 9s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024247
{'0': {'precision': 0.42976995138147756, 'recall': 0.2091587193951898, 'f1-score': 0.2813776772803587, 'support': 69311}, '1': {'precision': 0.32577666822820617, 'recall': 0.8389786506215449, 'f1-score': 0.4693168858571923, 'support': 65482}, '2': {'precision': 0.40131578947368424, 'recall': 0.010547550432276656, 'f1-score': 0.02055486914523194, 'support': 69400}, 'accuracy': 0.3436307806829813, 'macro avg': {'precision': 0.3856208030277893, 'recall': 0.3528949734830038, 'f1-score': 0.257083144094261, 'support': 204193}, 'weighted avg': {'precision': 0.38674983314116873, 'recall': 0.3436307806829813, 'f1-score': 0.25300027145082693, 'support': 204193}}
[[14497 54282   532]
 [ 9984 54938   560]
 [ 9251 59417   732]]
training model: results/WBA/W4/deepVOL_L2/h300
Epoch 1/50
2108/2108 - 49s - loss: 3.2864 - accuracy300: 0.3750 - val_loss: 3.3034 - val_accuracy300: 0.3303 - 49s/epoch - 23ms/step
Epoch 2/50
2108/2108 - 50s - loss: 3.2602 - accuracy300: 0.3906 - val_loss: 3.3181 - val_accuracy300: 0.3287 - 50s/epoch - 24ms/step
Epoch 3/50
2108/2108 - 47s - loss: 3.2474 - accuracy300: 0.3984 - val_loss: 3.3261 - val_accuracy300: 0.3329 - 47s/epoch - 23ms/step
Epoch 4/50
2108/2108 - 50s - loss: 3.2393 - accuracy300: 0.4033 - val_loss: 3.3738 - val_accuracy300: 0.3273 - 50s/epoch - 24ms/step
Epoch 5/50
2108/2108 - 48s - loss: 3.2347 - accuracy300: 0.4049 - val_loss: 3.3677 - val_accuracy300: 0.3318 - 48s/epoch - 23ms/step
Epoch 6/50
2108/2108 - 48s - loss: 3.2302 - accuracy300: 0.4076 - val_loss: 3.3610 - val_accuracy300: 0.3317 - 48s/epoch - 23ms/step
Epoch 7/50
2108/2108 - 46s - loss: 3.2274 - accuracy300: 0.4092 - val_loss: 3.3871 - val_accuracy300: 0.3336 - 46s/epoch - 22ms/step
Epoch 8/50
2108/2108 - 48s - loss: 3.2241 - accuracy300: 0.4112 - val_loss: 3.3894 - val_accuracy300: 0.3315 - 48s/epoch - 23ms/step
Epoch 9/50
2108/2108 - 52s - loss: 3.2205 - accuracy300: 0.4131 - val_loss: 3.3848 - val_accuracy300: 0.3335 - 52s/epoch - 25ms/step
Epoch 10/50
2108/2108 - 57s - loss: 3.2178 - accuracy300: 0.4150 - val_loss: 3.3669 - val_accuracy300: 0.3353 - 57s/epoch - 27ms/step
Epoch 11/50
2108/2108 - 53s - loss: 3.2163 - accuracy300: 0.4151 - val_loss: 3.3766 - val_accuracy300: 0.3366 - 53s/epoch - 25ms/step
testing model: results/WBA/W4/deepVOL_L2/h300
Evaluating performance on  test set...
4676/4676 - 47s - 47s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008883
{'0': {'precision': 0.42120330609040957, 'recall': 0.13477933245667173, 'f1-score': 0.2042132127426179, 'support': 406086}, '1': {'precision': 0.329797429297709, 'recall': 0.8453529717004041, 'f1-score': 0.4744843497124755, 'support': 391207}, '2': {'precision': 0.3772672121457238, 'recall': 0.060678615747968456, 'f1-score': 0.10454284864499053, 'support': 399696}, 'accuracy': 0.34226964491737183, 'macro avg': {'precision': 0.3760893158446141, 'recall': 0.34693697330168144, 'f1-score': 0.2610801370333613, 'support': 1196989}, 'weighted avg': {'precision': 0.3766584524219488, 'recall': 0.34226964491737183, 'f1-score': 0.2592631044560771, 'support': 1196989}}
[[ 54732 331428  19926]
 [ 40392 330708  20107]
 [ 34818 340625  24253]]
Evaluating performance on  train set...
2108/2108 - 22s - 22s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1006663
{'0': {'precision': 0.4231350088334188, 'recall': 0.16023890969127344, 'f1-score': 0.23245020154189333, 'support': 185342}, '1': {'precision': 0.32257963352896374, 'recall': 0.834870629431442, 'f1-score': 0.46535435742572817, 'support': 172489}, '2': {'precision': 0.4041927985614666, 'recall': 0.0507550474176387, 'f1-score': 0.09018539086696774, 'support': 181578}, 'accuracy': 0.33911373373451315, 'macro avg': {'precision': 0.3833024803079497, 'recall': 0.34862152884678466, 'f1-score': 0.26266331661152975, 'support': 539409}, 'weighted avg': {'precision': 0.38460360726679554, 'recall': 0.33911373373451315, 'f1-score': 0.2590371608835342, 'support': 539409}}
[[ 29699 148811   6832]
 [ 21730 144006   6753]
 [ 18759 153603   9216]]
Evaluating performance on  val set...
798/798 - 8s - 8s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1045425
{'0': {'precision': 0.4113187915722195, 'recall': 0.15515622152759284, 'f1-score': 0.22531856857875662, 'support': 71341}, '1': {'precision': 0.308635582792188, 'recall': 0.8110292940611493, 'f1-score': 0.4471203911255449, 'support': 62470}, '2': {'precision': 0.40399268515696435, 'recall': 0.0753317609616095, 'f1-score': 0.12698488731348645, 'support': 70382}, 'accuracy': 0.3282972481916618, 'macro avg': {'precision': 0.3746490198404573, 'recall': 0.3471724255167839, 'f1-score': 0.266474615672596, 'support': 204193}, 'weighted avg': {'precision': 0.37737910669464264, 'recall': 0.3282972481916618, 'f1-score': 0.25928172451302284, 'support': 204193}}
[[11069 56050  4222]
 [ 8205 50665  3600]
 [ 7637 57443  5302]]
training model: results/WBA/W4/deepVOL_L2/h500
Epoch 1/50
2108/2108 - 51s - loss: 3.2341 - accuracy500: 0.4036 - val_loss: 3.7417 - val_accuracy500: 0.3450 - 51s/epoch - 24ms/step
Epoch 2/50
2108/2108 - 49s - loss: 3.2223 - accuracy500: 0.4088 - val_loss: 3.4340 - val_accuracy500: 0.3451 - 49s/epoch - 23ms/step
Epoch 3/50
2108/2108 - 46s - loss: 3.2207 - accuracy500: 0.4091 - val_loss: 3.5504 - val_accuracy500: 0.3451 - 46s/epoch - 22ms/step
Epoch 4/50
2108/2108 - 51s - loss: 3.2202 - accuracy500: 0.4112 - val_loss: 3.5828 - val_accuracy500: 0.3451 - 51s/epoch - 24ms/step
Epoch 5/50
2108/2108 - 52s - loss: 3.2108 - accuracy500: 0.4151 - val_loss: 3.5175 - val_accuracy500: 0.3451 - 52s/epoch - 25ms/step
Epoch 6/50
2108/2108 - 51s - loss: 3.2122 - accuracy500: 0.4157 - val_loss: 3.4351 - val_accuracy500: 0.3451 - 51s/epoch - 24ms/step
Epoch 7/50
2108/2108 - 49s - loss: 3.2137 - accuracy500: 0.4142 - val_loss: 3.4332 - val_accuracy500: 0.3452 - 49s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 50s - loss: 3.2163 - accuracy500: 0.4129 - val_loss: 3.4608 - val_accuracy500: 0.3451 - 50s/epoch - 24ms/step
Epoch 9/50
2108/2108 - 46s - loss: 3.2117 - accuracy500: 0.4138 - val_loss: 3.4921 - val_accuracy500: 0.3451 - 46s/epoch - 22ms/step
Epoch 10/50
2108/2108 - 48s - loss: 3.2022 - accuracy500: 0.4174 - val_loss: 3.5241 - val_accuracy500: 0.3451 - 48s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 52s - loss: 3.2029 - accuracy500: 0.4182 - val_loss: 3.5099 - val_accuracy500: 0.3451 - 52s/epoch - 24ms/step
Epoch 12/50
2108/2108 - 48s - loss: 3.1966 - accuracy500: 0.4193 - val_loss: 3.5934 - val_accuracy500: 0.3451 - 48s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 46s - loss: 3.1932 - accuracy500: 0.4220 - val_loss: 3.5696 - val_accuracy500: 0.3451 - 46s/epoch - 22ms/step
Epoch 14/50
2108/2108 - 49s - loss: 3.1955 - accuracy500: 0.4204 - val_loss: 3.5020 - val_accuracy500: 0.3463 - 49s/epoch - 23ms/step
Epoch 15/50
2108/2108 - 50s - loss: 3.1920 - accuracy500: 0.4230 - val_loss: 3.5628 - val_accuracy500: 0.3452 - 50s/epoch - 24ms/step
Epoch 16/50
2108/2108 - 51s - loss: 3.1879 - accuracy500: 0.4260 - val_loss: 3.5458 - val_accuracy500: 0.3453 - 51s/epoch - 24ms/step
Epoch 17/50
2108/2108 - 46s - loss: 3.1842 - accuracy500: 0.4265 - val_loss: 3.6014 - val_accuracy500: 0.3453 - 46s/epoch - 22ms/step
testing model: results/WBA/W4/deepVOL_L2/h500
Evaluating performance on  test set...
4676/4676 - 38s - 38s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0654701
{'0': {'precision': 0.3959731543624161, 'recall': 0.00017909831586871789, 'f1-score': 0.00035803469295490886, 'support': 329428}, '1': {'precision': 0.4595182521157846, 'recall': 0.9997636320660376, 'f1-score': 0.6296379633239837, 'support': 549990}, '2': {'precision': 0.36401673640167365, 'recall': 0.0002739544857685368, 'f1-score': 0.0005474969321292596, 'support': 317571}, 'accuracy': 0.45949127352047514, 'macro avg': {'precision': 0.4065027142932915, 'recall': 0.33340556162255824, 'f1-score': 0.21018116498302264, 'support': 1196989}, 'weighted avg': {'precision': 0.4166924230483975, 'recall': 0.45949127352047514, 'f1-score': 0.28954852488170046, 'support': 1196989}}
[[    59 329302     67]
 [    45 549860     85]
 [    45 317439     87]]
Evaluating performance on  train set...
2108/2108 - 21s - 21s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1580619
{'0': {'precision': 0.5217391304347826, 'recall': 0.0002648962765517127, 'f1-score': 0.0005295237044595824, 'support': 181203}, '1': {'precision': 0.33290182346919095, 'recall': 0.9997437953927728, 'f1-score': 0.499482424701142, 'support': 179544}, '2': {'precision': 0.4, 'recall': 0.0002798580559939998, 'f1-score': 0.0005593247831218153, 'support': 178662}, 'accuracy': 0.3329495800032999, 'macro avg': {'precision': 0.41821365130132454, 'recall': 0.33342951657510617, 'f1-score': 0.1668570910629078, 'support': 539409}, 'weighted avg': {'precision': 0.41856183460996454, 'recall': 0.3329495800032999, 'f1-score': 0.16661745322892857, 'support': 539409}}
[[    48 181114     41]
 [    12 179498     34]
 [    32 178580     50]]
Evaluating performance on  val set...
798/798 - 7s - 7s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.145035
{'0': {'precision': 0.3269230769230769, 'recall': 0.000253561041091804, 'f1-score': 0.0005067290638925734, 'support': 67045}, '1': {'precision': 0.345118430918973, 'recall': 0.9994606639510624, 'f1-score': 0.5130710382513662, 'support': 70457}, '2': {'precision': 0.3979591836734694, 'recall': 0.0005847865529081885, 'f1-score': 0.0011678569824372278, 'support': 66691}, 'accuracy': 0.3451391575617186, 'macro avg': {'precision': 0.3566668971718398, 'recall': 0.3334330038483541, 'f1-score': 0.1715818747658987, 'support': 204193}, 'weighted avg': {'precision': 0.3564023394432381, 'recall': 0.3451391575617186, 'f1-score': 0.17758348886681188, 'support': 204193}}
[[   17 66997    31]
 [   10 70419    28]
 [   25 66627    39]]
training model: results/WBA/W4/deepVOL_L2/h1000
Epoch 1/50
2108/2108 - 49s - loss: 3.2539 - accuracy1000: 0.3950 - val_loss: 3.3521 - val_accuracy1000: 0.3047 - 49s/epoch - 23ms/step
Epoch 2/50
2108/2108 - 53s - loss: 3.2299 - accuracy1000: 0.4053 - val_loss: 3.4102 - val_accuracy1000: 0.3006 - 53s/epoch - 25ms/step
Epoch 3/50
2108/2108 - 50s - loss: 3.2199 - accuracy1000: 0.4115 - val_loss: 3.4247 - val_accuracy1000: 0.3005 - 50s/epoch - 24ms/step
Epoch 4/50
2108/2108 - 50s - loss: 3.2139 - accuracy1000: 0.4135 - val_loss: 3.4500 - val_accuracy1000: 0.3004 - 50s/epoch - 24ms/step
Epoch 5/50
2108/2108 - 47s - loss: 3.2180 - accuracy1000: 0.4123 - val_loss: 3.3759 - val_accuracy1000: 0.3037 - 47s/epoch - 22ms/step
Epoch 6/50
2108/2108 - 50s - loss: 3.2155 - accuracy1000: 0.4126 - val_loss: 3.3958 - val_accuracy1000: 0.3205 - 50s/epoch - 24ms/step
Epoch 7/50
2108/2108 - 49s - loss: 3.2113 - accuracy1000: 0.4144 - val_loss: 3.4022 - val_accuracy1000: 0.3188 - 49s/epoch - 23ms/step
Epoch 8/50
2108/2108 - 50s - loss: 3.2034 - accuracy1000: 0.4181 - val_loss: 3.3591 - val_accuracy1000: 0.3311 - 50s/epoch - 24ms/step
Epoch 9/50
2108/2108 - 50s - loss: 3.1986 - accuracy1000: 0.4224 - val_loss: 3.3659 - val_accuracy1000: 0.3347 - 50s/epoch - 24ms/step
Epoch 10/50
2108/2108 - 49s - loss: 3.1918 - accuracy1000: 0.4243 - val_loss: 3.3436 - val_accuracy1000: 0.3463 - 49s/epoch - 23ms/step
Epoch 11/50
2108/2108 - 49s - loss: 3.1870 - accuracy1000: 0.4263 - val_loss: 3.3702 - val_accuracy1000: 0.3317 - 49s/epoch - 23ms/step
Epoch 12/50
2108/2108 - 49s - loss: 3.1815 - accuracy1000: 0.4308 - val_loss: 3.3842 - val_accuracy1000: 0.3318 - 49s/epoch - 23ms/step
Epoch 13/50
2108/2108 - 52s - loss: 3.1771 - accuracy1000: 0.4325 - val_loss: 3.3863 - val_accuracy1000: 0.3285 - 52s/epoch - 25ms/step
Epoch 14/50
2108/2108 - 47s - loss: 3.1717 - accuracy1000: 0.4342 - val_loss: 3.3855 - val_accuracy1000: 0.3341 - 47s/epoch - 22ms/step
Epoch 15/50
2108/2108 - 51s - loss: 3.1685 - accuracy1000: 0.4345 - val_loss: 3.3860 - val_accuracy1000: 0.3257 - 51s/epoch - 24ms/step
Epoch 16/50
2108/2108 - 51s - loss: 3.1615 - accuracy1000: 0.4375 - val_loss: 3.3820 - val_accuracy1000: 0.3291 - 51s/epoch - 24ms/step
Epoch 17/50
2108/2108 - 48s - loss: 3.1548 - accuracy1000: 0.4403 - val_loss: 3.3836 - val_accuracy1000: 0.3339 - 48s/epoch - 23ms/step
Epoch 18/50
2108/2108 - 48s - loss: 3.1482 - accuracy1000: 0.4421 - val_loss: 3.3661 - val_accuracy1000: 0.3456 - 48s/epoch - 23ms/step
Epoch 19/50
2108/2108 - 48s - loss: 3.1422 - accuracy1000: 0.4447 - val_loss: 3.3827 - val_accuracy1000: 0.3434 - 48s/epoch - 23ms/step
Epoch 20/50
2108/2108 - 53s - loss: 3.1389 - accuracy1000: 0.4461 - val_loss: 3.3922 - val_accuracy1000: 0.3370 - 53s/epoch - 25ms/step
testing model: results/WBA/W4/deepVOL_L2/h1000
Evaluating performance on  test set...
4676/4676 - 46s - 46s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1074363
{'0': {'precision': 0.37401525572089533, 'recall': 0.07363947923026924, 'f1-score': 0.12305147920960713, 'support': 406168}, '1': {'precision': 0.36203167093439875, 'recall': 0.7163440749888235, 'f1-score': 0.4809812227557728, 'support': 409341}, '2': {'precision': 0.33764512399654795, 'recall': 0.27178095837265387, 'f1-score': 0.3011538824622937, 'support': 381480}, 'accuracy': 0.35657637622400873, 'macro avg': {'precision': 0.35789735021728064, 'recall': 0.3539215041972488, 'f1-score': 0.30172886147589123, 'support': 1196989}, 'weighted avg': {'precision': 0.35832601343855747, 'recall': 0.35657637622400873, 'f1-score': 0.30221588585475245, 'support': 1196989}}
[[ 29910 263068 113190]
 [ 25916 293229  90196]
 [ 24144 253657 103679]]
Evaluating performance on  train set...
2108/2108 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1013519
{'0': {'precision': 0.36773520401367493, 'recall': 0.09171035803856652, 'f1-score': 0.14680793551617635, 'support': 180623}, '1': {'precision': 0.3555924487883251, 'recall': 0.7312595333674745, 'f1-score': 0.4785018980306243, 'support': 181599}, '2': {'precision': 0.3824237261502072, 'recall': 0.2609672267152782, 'f1-score': 0.3102314659510232, 'support': 177187}, 'accuracy': 0.3626209425500872, 'macro avg': {'precision': 0.3685837929840691, 'recall': 0.3613123727071064, 'f1-score': 0.31184709983260794, 'support': 539409}, 'weighted avg': {'precision': 0.36847212713812677, 'recall': 0.3626209425500872, 'f1-score': 0.31215893445356974, 'support': 539409}}
[[ 16565 122484  41574]
 [ 15704 132796  33099]
 [ 12777 118170  46240]]
Evaluating performance on  val set...
798/798 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1140361
{'0': {'precision': 0.3802928133163234, 'recall': 0.08743871607559399, 'f1-score': 0.14218547709360166, 'support': 71593}, '1': {'precision': 0.3200822092938578, 'recall': 0.6449393504630233, 'f1-score': 0.4278321247221817, 'support': 61336}, '2': {'precision': 0.38840127835372984, 'recall': 0.34960148181409967, 'f1-score': 0.3679814487958703, 'support': 71264}, 'accuracy': 0.34639777073650907, 'macro avg': {'precision': 0.36292543365463703, 'recall': 0.3606598494509057, 'f1-score': 0.3126663502038845, 'support': 204193}, 'weighted avg': {'precision': 0.3650364825121518, 'recall': 0.34639777073650907, 'f1-score': 0.3067922310290307, 'support': 204193}}
[[ 6260 43108 22225]
 [ 4772 39558 17006]
 [ 5429 40921 24914]]
training model: results/WBA/W4/deepVOL_L3/h10
Epoch 1/50
2108/2108 - 76s - loss: 2.7611 - accuracy10: 0.5415 - val_loss: 2.7537 - val_accuracy10: 0.5623 - 76s/epoch - 36ms/step
Epoch 2/50
2108/2108 - 73s - loss: 2.3972 - accuracy10: 0.6119 - val_loss: 2.7744 - val_accuracy10: 0.5809 - 73s/epoch - 35ms/step
Epoch 3/50
2108/2108 - 73s - loss: 2.3408 - accuracy10: 0.6247 - val_loss: 2.6503 - val_accuracy10: 0.5951 - 73s/epoch - 34ms/step
Epoch 4/50
2108/2108 - 74s - loss: 2.3117 - accuracy10: 0.6309 - val_loss: 2.5854 - val_accuracy10: 0.5846 - 74s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 73s - loss: 2.2935 - accuracy10: 0.6348 - val_loss: 2.6131 - val_accuracy10: 0.5620 - 73s/epoch - 35ms/step
Epoch 6/50
2108/2108 - 72s - loss: 2.2817 - accuracy10: 0.6377 - val_loss: 2.5821 - val_accuracy10: 0.5659 - 72s/epoch - 34ms/step
Epoch 7/50
2108/2108 - 73s - loss: 2.2728 - accuracy10: 0.6388 - val_loss: 2.6315 - val_accuracy10: 0.5519 - 73s/epoch - 35ms/step
Epoch 8/50
2108/2108 - 73s - loss: 2.2640 - accuracy10: 0.6403 - val_loss: 2.6309 - val_accuracy10: 0.5627 - 73s/epoch - 35ms/step
Epoch 9/50
2108/2108 - 72s - loss: 2.2572 - accuracy10: 0.6412 - val_loss: 2.6539 - val_accuracy10: 0.5475 - 72s/epoch - 34ms/step
Epoch 10/50
2108/2108 - 72s - loss: 2.2500 - accuracy10: 0.6417 - val_loss: 2.6535 - val_accuracy10: 0.5529 - 72s/epoch - 34ms/step
Epoch 11/50
2108/2108 - 72s - loss: 2.2441 - accuracy10: 0.6425 - val_loss: 2.6054 - val_accuracy10: 0.5714 - 72s/epoch - 34ms/step
Epoch 12/50
2108/2108 - 72s - loss: 2.2390 - accuracy10: 0.6434 - val_loss: 2.6172 - val_accuracy10: 0.5751 - 72s/epoch - 34ms/step
Epoch 13/50
2108/2108 - 72s - loss: 2.2329 - accuracy10: 0.6445 - val_loss: 2.6035 - val_accuracy10: 0.5898 - 72s/epoch - 34ms/step
Epoch 14/50
2108/2108 - 73s - loss: 2.2280 - accuracy10: 0.6443 - val_loss: 2.6122 - val_accuracy10: 0.5737 - 73s/epoch - 34ms/step
Epoch 15/50
2108/2108 - 73s - loss: 2.2227 - accuracy10: 0.6455 - val_loss: 2.5740 - val_accuracy10: 0.5849 - 73s/epoch - 35ms/step
Epoch 16/50
2108/2108 - 72s - loss: 2.2179 - accuracy10: 0.6460 - val_loss: 2.5893 - val_accuracy10: 0.5878 - 72s/epoch - 34ms/step
Epoch 17/50
2108/2108 - 72s - loss: 2.2134 - accuracy10: 0.6462 - val_loss: 2.5686 - val_accuracy10: 0.5905 - 72s/epoch - 34ms/step
Epoch 18/50
2108/2108 - 72s - loss: 2.2103 - accuracy10: 0.6464 - val_loss: 2.5926 - val_accuracy10: 0.5786 - 72s/epoch - 34ms/step
Epoch 19/50
2108/2108 - 73s - loss: 2.2045 - accuracy10: 0.6464 - val_loss: 2.5742 - val_accuracy10: 0.5918 - 73s/epoch - 34ms/step
Epoch 20/50
2108/2108 - 73s - loss: 2.2006 - accuracy10: 0.6476 - val_loss: 2.5573 - val_accuracy10: 0.5949 - 73s/epoch - 34ms/step
Epoch 21/50
2108/2108 - 73s - loss: 2.1980 - accuracy10: 0.6478 - val_loss: 2.5690 - val_accuracy10: 0.5973 - 73s/epoch - 34ms/step
Epoch 22/50
2108/2108 - 74s - loss: 2.1944 - accuracy10: 0.6480 - val_loss: 2.5613 - val_accuracy10: 0.5971 - 74s/epoch - 35ms/step
Epoch 23/50
2108/2108 - 73s - loss: 2.1909 - accuracy10: 0.6477 - val_loss: 2.5531 - val_accuracy10: 0.6024 - 73s/epoch - 34ms/step
Epoch 24/50
2108/2108 - 73s - loss: 2.1877 - accuracy10: 0.6488 - val_loss: 2.5573 - val_accuracy10: 0.6008 - 73s/epoch - 35ms/step
Epoch 25/50
2108/2108 - 73s - loss: 2.1834 - accuracy10: 0.6493 - val_loss: 2.5637 - val_accuracy10: 0.5934 - 73s/epoch - 35ms/step
Epoch 26/50
2108/2108 - 73s - loss: 2.1816 - accuracy10: 0.6494 - val_loss: 2.5639 - val_accuracy10: 0.5984 - 73s/epoch - 35ms/step
Epoch 27/50
2108/2108 - 73s - loss: 2.1776 - accuracy10: 0.6497 - val_loss: 2.5727 - val_accuracy10: 0.5943 - 73s/epoch - 35ms/step
Epoch 28/50
2108/2108 - 75s - loss: 2.1753 - accuracy10: 0.6498 - val_loss: 2.5610 - val_accuracy10: 0.5962 - 75s/epoch - 36ms/step
Epoch 29/50
2108/2108 - 73s - loss: 2.1728 - accuracy10: 0.6501 - val_loss: 2.5727 - val_accuracy10: 0.6003 - 73s/epoch - 34ms/step
Epoch 30/50
2108/2108 - 73s - loss: 2.1696 - accuracy10: 0.6511 - val_loss: 2.5736 - val_accuracy10: 0.5934 - 73s/epoch - 34ms/step
Epoch 31/50
2108/2108 - 72s - loss: 2.1668 - accuracy10: 0.6516 - val_loss: 2.5748 - val_accuracy10: 0.5972 - 72s/epoch - 34ms/step
Epoch 32/50
2108/2108 - 74s - loss: 2.1649 - accuracy10: 0.6520 - val_loss: 2.5591 - val_accuracy10: 0.6019 - 74s/epoch - 35ms/step
Epoch 33/50
2108/2108 - 73s - loss: 2.1613 - accuracy10: 0.6515 - val_loss: 2.5637 - val_accuracy10: 0.5892 - 73s/epoch - 35ms/step
testing model: results/WBA/W4/deepVOL_L3/h10
Evaluating performance on  test set...
4676/4676 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.93321615
{'0': {'precision': 0.36040971164225993, 'recall': 0.6957038782944075, 'f1-score': 0.4748323221170282, 'support': 186680}, '1': {'precision': 0.8914732531745884, 'recall': 0.5247049424499246, 'f1-score': 0.6605954299364767, 'support': 821111}, '2': {'precision': 0.34974967949352903, 'recall': 0.6531940083933234, 'f1-score': 0.4555677409247159, 'support': 189198}, 'accuracy': 0.5716827807105996, 'macro avg': {'precision': 0.5338775481034591, 'recall': 0.6245342763792184, 'f1-score': 0.5303318309927402, 'support': 1196989}, 'weighted avg': {'precision': 0.723023953618315, 'recall': 0.5716827807105996, 'f1-score': 0.5992171836256236, 'support': 1196989}}
[[129874  24213  32593]
 [193099 430841 197171]
 [ 37378  28237 123583]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8294645
{'0': {'precision': 0.3819026705566926, 'recall': 0.7128574912042359, 'f1-score': 0.4973549259946369, 'support': 86121}, '1': {'precision': 0.9067353475534484, 'recall': 0.6012722085791132, 'f1-score': 0.7230663570657684, 'support': 367707}, '2': {'precision': 0.40202339363461725, 'recall': 0.6333415127189447, 'f1-score': 0.4918422533166367, 'support': 85581}, 'accuracy': 0.6241757182397772, 'macro avg': {'precision': 0.5635538039149194, 'recall': 0.6491570708340979, 'f1-score': 0.5707545121256806, 'support': 539409}, 'weighted avg': {'precision': 0.7428655035130911, 'recall': 0.6241757182397772, 'f1-score': 0.6503443888037791, 'support': 539409}}
[[ 61392  10149  14580]
 [ 80574 221092  66041]
 [ 18787  12592  54202]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.895395
{'0': {'precision': 0.38648136047049075, 'recall': 0.6753467387066229, 'f1-score': 0.4916218106620442, 'support': 35906}, '1': {'precision': 0.896732196020982, 'recall': 0.5703004665910303, 'f1-score': 0.6971989142865016, 'support': 133093}, '2': {'precision': 0.39738759990141886, 'recall': 0.6414161504801955, 'f1-score': 0.4907391304347826, 'support': 35194}, 'accuracy': 0.6010294182464629, 'macro avg': {'precision': 0.5602003854642973, 'recall': 0.6290211185926161, 'f1-score': 0.5598532851277761, 'support': 204193}, 'weighted avg': {'precision': 0.7209426233269728, 'recall': 0.6010294182464629, 'f1-score': 0.6254648337077493, 'support': 204193}}
[[24249  4192  7465]
 [30423 75903 26767]
 [ 8071  4549 22574]]
training model: results/WBA/W4/deepVOL_L3/h20
Epoch 1/50
2108/2108 - 76s - loss: 2.8903 - accuracy20: 0.5213 - val_loss: 3.0968 - val_accuracy20: 0.5654 - 76s/epoch - 36ms/step
Epoch 2/50
2108/2108 - 78s - loss: 2.5427 - accuracy20: 0.5995 - val_loss: 2.9502 - val_accuracy20: 0.5824 - 78s/epoch - 37ms/step
Epoch 3/50
2108/2108 - 78s - loss: 2.4670 - accuracy20: 0.6161 - val_loss: 2.8561 - val_accuracy20: 0.5787 - 78s/epoch - 37ms/step
Epoch 4/50
2108/2108 - 80s - loss: 2.4401 - accuracy20: 0.6227 - val_loss: 2.7044 - val_accuracy20: 0.5978 - 80s/epoch - 38ms/step
Epoch 5/50
2108/2108 - 73s - loss: 2.4203 - accuracy20: 0.6266 - val_loss: 2.6976 - val_accuracy20: 0.6115 - 73s/epoch - 34ms/step
Epoch 6/50
2108/2108 - 78s - loss: 2.4086 - accuracy20: 0.6282 - val_loss: 2.6793 - val_accuracy20: 0.5984 - 78s/epoch - 37ms/step
Epoch 7/50
2108/2108 - 73s - loss: 2.3982 - accuracy20: 0.6303 - val_loss: 2.6515 - val_accuracy20: 0.5914 - 73s/epoch - 35ms/step
Epoch 8/50
2108/2108 - 72s - loss: 2.3903 - accuracy20: 0.6313 - val_loss: 2.6555 - val_accuracy20: 0.5784 - 72s/epoch - 34ms/step
Epoch 9/50
2108/2108 - 73s - loss: 2.3813 - accuracy20: 0.6320 - val_loss: 2.6505 - val_accuracy20: 0.5730 - 73s/epoch - 35ms/step
Epoch 10/50
2108/2108 - 74s - loss: 2.3755 - accuracy20: 0.6330 - val_loss: 2.6636 - val_accuracy20: 0.5739 - 74s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 73s - loss: 2.3694 - accuracy20: 0.6338 - val_loss: 2.6770 - val_accuracy20: 0.5695 - 73s/epoch - 34ms/step
Epoch 12/50
2108/2108 - 73s - loss: 2.3618 - accuracy20: 0.6344 - val_loss: 2.7049 - val_accuracy20: 0.5576 - 73s/epoch - 35ms/step
Epoch 13/50
2108/2108 - 74s - loss: 2.3579 - accuracy20: 0.6352 - val_loss: 2.7054 - val_accuracy20: 0.5664 - 74s/epoch - 35ms/step
Epoch 14/50
2108/2108 - 73s - loss: 2.3523 - accuracy20: 0.6355 - val_loss: 2.7040 - val_accuracy20: 0.5656 - 73s/epoch - 35ms/step
Epoch 15/50
2108/2108 - 75s - loss: 2.3477 - accuracy20: 0.6364 - val_loss: 2.7083 - val_accuracy20: 0.5545 - 75s/epoch - 36ms/step
Epoch 16/50
2108/2108 - 73s - loss: 2.3432 - accuracy20: 0.6366 - val_loss: 2.6998 - val_accuracy20: 0.5653 - 73s/epoch - 35ms/step
Epoch 17/50
2108/2108 - 72s - loss: 2.3402 - accuracy20: 0.6375 - val_loss: 2.6974 - val_accuracy20: 0.5599 - 72s/epoch - 34ms/step
Epoch 18/50
2108/2108 - 74s - loss: 2.3364 - accuracy20: 0.6378 - val_loss: 2.6887 - val_accuracy20: 0.5682 - 74s/epoch - 35ms/step
Epoch 19/50
2108/2108 - 73s - loss: 2.3320 - accuracy20: 0.6384 - val_loss: 2.7023 - val_accuracy20: 0.5550 - 73s/epoch - 35ms/step
testing model: results/WBA/W4/deepVOL_L3/h20
Evaluating performance on  test set...
4676/4676 - 69s - 69s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9559948
{'0': {'precision': 0.39620517837739555, 'recall': 0.7336748272489699, 'f1-score': 0.5145427202068897, 'support': 249492}, '1': {'precision': 0.815782997322413, 'recall': 0.4765637242709904, 'f1-score': 0.6016536845802216, 'support': 695567}, '2': {'precision': 0.4132661909905524, 'recall': 0.5391259476838804, 'f1-score': 0.4678798108804051, 'support': 251930}, 'accuracy': 0.5433216178260619, 'macro avg': {'precision': 0.5417514555634536, 'recall': 0.5831214997346136, 'f1-score': 0.5280254052225054, 'support': 1196989}, 'weighted avg': {'precision': 0.6436115168631806, 'recall': 0.5433216178260619, 'f1-score': 0.5553415290594723, 'support': 1196989}}
[[183046  33936  32510]
 [203762 331482 160323]
 [ 75190  40918 135822]]
Evaluating performance on  train set...
2108/2108 - 32s - 32s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8718542
{'0': {'precision': 0.4213143657981585, 'recall': 0.7375353933275883, 'f1-score': 0.5362804868302009, 'support': 113722}, '1': {'precision': 0.8464561164874298, 'recall': 0.5731898820812799, 'f1-score': 0.683522627592467, 'support': 312673}, '2': {'precision': 0.4496154773291032, 'recall': 0.5116268780859009, 'f1-score': 0.4786209465471929, 'support': 113014}, 'accuracy': 0.594940017686023, 'macro avg': {'precision': 0.5724619865382305, 'recall': 0.6074507178315898, 'f1-score': 0.5661413536566203, 'support': 539409}, 'weighted avg': {'precision': 0.6736808788371044, 'recall': 0.594940017686023, 'f1-score': 0.6095501330411766, 'support': 539409}}
[[ 83874  15114  14734]
 [ 77406 179221  56046]
 [ 37797  17396  57821]]
Evaluating performance on  val set...
798/798 - 12s - 12s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.914505
{'0': {'precision': 0.41785162569485834, 'recall': 0.7377848413908636, 'f1-score': 0.5335321343149132, 'support': 46561}, '1': {'precision': 0.826041038020519, 'recall': 0.5397230810592821, 'f1-score': 0.652870298602115, 'support': 111585}, '2': {'precision': 0.4566369156783633, 'recall': 0.48665493951831823, 'f1-score': 0.471168301426604, 'support': 46047}, 'accuracy': 0.5729187582336319, 'macro avg': {'precision': 0.5668431931312469, 'recall': 0.5880542873228213, 'f1-score': 0.552523578114544, 'support': 204193}, 'weighted avg': {'precision': 0.6496605604880652, 'recall': 0.5729187582336319, 'f1-score': 0.5846831612794978, 'support': 204193}}
[[34352  6004  6205]
 [30900 60225 20460]
 [16959  6679 22409]]
training model: results/WBA/W4/deepVOL_L3/h30
Epoch 1/50
2108/2108 - 77s - loss: 3.0598 - accuracy30: 0.4634 - val_loss: 3.2460 - val_accuracy30: 0.5210 - 77s/epoch - 36ms/step
Epoch 2/50
2108/2108 - 74s - loss: 2.7838 - accuracy30: 0.5432 - val_loss: 3.0904 - val_accuracy30: 0.5586 - 74s/epoch - 35ms/step
Epoch 3/50
2108/2108 - 74s - loss: 2.6102 - accuracy30: 0.5880 - val_loss: 3.0310 - val_accuracy30: 0.5745 - 74s/epoch - 35ms/step
Epoch 4/50
2108/2108 - 73s - loss: 2.5553 - accuracy30: 0.6014 - val_loss: 2.8062 - val_accuracy30: 0.5776 - 73s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 75s - loss: 2.5311 - accuracy30: 0.6059 - val_loss: 2.8198 - val_accuracy30: 0.5790 - 75s/epoch - 36ms/step
Epoch 6/50
2108/2108 - 74s - loss: 2.5180 - accuracy30: 0.6092 - val_loss: 2.7900 - val_accuracy30: 0.5803 - 74s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 75s - loss: 2.5094 - accuracy30: 0.6100 - val_loss: 2.7484 - val_accuracy30: 0.5789 - 75s/epoch - 36ms/step
Epoch 8/50
2108/2108 - 78s - loss: 2.5011 - accuracy30: 0.6119 - val_loss: 2.7296 - val_accuracy30: 0.5758 - 78s/epoch - 37ms/step
Epoch 9/50
2108/2108 - 74s - loss: 2.4957 - accuracy30: 0.6125 - val_loss: 2.7253 - val_accuracy30: 0.5698 - 74s/epoch - 35ms/step
Epoch 10/50
2108/2108 - 74s - loss: 2.4890 - accuracy30: 0.6136 - val_loss: 2.7091 - val_accuracy30: 0.5752 - 74s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 76s - loss: 2.4850 - accuracy30: 0.6137 - val_loss: 2.6948 - val_accuracy30: 0.5816 - 76s/epoch - 36ms/step
Epoch 12/50
2108/2108 - 73s - loss: 2.4790 - accuracy30: 0.6145 - val_loss: 2.7064 - val_accuracy30: 0.5715 - 73s/epoch - 35ms/step
Epoch 13/50
2108/2108 - 74s - loss: 2.4745 - accuracy30: 0.6156 - val_loss: 2.7193 - val_accuracy30: 0.5723 - 74s/epoch - 35ms/step
Epoch 14/50
2108/2108 - 73s - loss: 2.4712 - accuracy30: 0.6160 - val_loss: 2.6961 - val_accuracy30: 0.5698 - 73s/epoch - 35ms/step
Epoch 15/50
2108/2108 - 73s - loss: 2.4673 - accuracy30: 0.6158 - val_loss: 2.6929 - val_accuracy30: 0.5757 - 73s/epoch - 35ms/step
Epoch 16/50
2108/2108 - 73s - loss: 2.4638 - accuracy30: 0.6170 - val_loss: 2.6894 - val_accuracy30: 0.5745 - 73s/epoch - 34ms/step
Epoch 17/50
2108/2108 - 76s - loss: 2.4624 - accuracy30: 0.6168 - val_loss: 2.6873 - val_accuracy30: 0.5823 - 76s/epoch - 36ms/step
Epoch 18/50
2108/2108 - 73s - loss: 2.4588 - accuracy30: 0.6174 - val_loss: 2.6871 - val_accuracy30: 0.5775 - 73s/epoch - 35ms/step
Epoch 19/50
2108/2108 - 72s - loss: 2.4557 - accuracy30: 0.6185 - val_loss: 2.6841 - val_accuracy30: 0.5790 - 72s/epoch - 34ms/step
Epoch 20/50
2108/2108 - 73s - loss: 2.4535 - accuracy30: 0.6183 - val_loss: 2.6835 - val_accuracy30: 0.5743 - 73s/epoch - 35ms/step
Epoch 21/50
2108/2108 - 72s - loss: 2.4500 - accuracy30: 0.6189 - val_loss: 2.6924 - val_accuracy30: 0.5717 - 72s/epoch - 34ms/step
Epoch 22/50
2108/2108 - 73s - loss: 2.4476 - accuracy30: 0.6193 - val_loss: 2.6759 - val_accuracy30: 0.5906 - 73s/epoch - 35ms/step
Epoch 23/50
2108/2108 - 75s - loss: 2.4440 - accuracy30: 0.6198 - val_loss: 2.6767 - val_accuracy30: 0.5809 - 75s/epoch - 36ms/step
Epoch 24/50
2108/2108 - 73s - loss: 2.4410 - accuracy30: 0.6200 - val_loss: 2.6746 - val_accuracy30: 0.5845 - 73s/epoch - 35ms/step
Epoch 25/50
2108/2108 - 73s - loss: 2.4395 - accuracy30: 0.6202 - val_loss: 2.6813 - val_accuracy30: 0.5788 - 73s/epoch - 34ms/step
Epoch 26/50
2108/2108 - 73s - loss: 2.4372 - accuracy30: 0.6207 - val_loss: 2.6746 - val_accuracy30: 0.5795 - 73s/epoch - 35ms/step
Epoch 27/50
2108/2108 - 73s - loss: 2.4349 - accuracy30: 0.6207 - val_loss: 2.6927 - val_accuracy30: 0.5764 - 73s/epoch - 34ms/step
Epoch 28/50
2108/2108 - 75s - loss: 2.4328 - accuracy30: 0.6213 - val_loss: 2.7008 - val_accuracy30: 0.5690 - 75s/epoch - 35ms/step
Epoch 29/50
2108/2108 - 75s - loss: 2.4298 - accuracy30: 0.6221 - val_loss: 2.7046 - val_accuracy30: 0.5689 - 75s/epoch - 35ms/step
Epoch 30/50
2108/2108 - 72s - loss: 2.4272 - accuracy30: 0.6220 - val_loss: 2.6987 - val_accuracy30: 0.5759 - 72s/epoch - 34ms/step
Epoch 31/50
2108/2108 - 74s - loss: 2.4257 - accuracy30: 0.6221 - val_loss: 2.7284 - val_accuracy30: 0.5619 - 74s/epoch - 35ms/step
Epoch 32/50
2108/2108 - 73s - loss: 2.4227 - accuracy30: 0.6230 - val_loss: 2.7079 - val_accuracy30: 0.5727 - 73s/epoch - 34ms/step
Epoch 33/50
2108/2108 - 75s - loss: 2.4216 - accuracy30: 0.6229 - val_loss: 2.6977 - val_accuracy30: 0.5755 - 75s/epoch - 35ms/step
Epoch 34/50
2108/2108 - 73s - loss: 2.4186 - accuracy30: 0.6234 - val_loss: 2.7038 - val_accuracy30: 0.5776 - 73s/epoch - 35ms/step
Epoch 35/50
2108/2108 - 73s - loss: 2.4175 - accuracy30: 0.6233 - val_loss: 2.7027 - val_accuracy30: 0.5764 - 73s/epoch - 35ms/step
Epoch 36/50
2108/2108 - 73s - loss: 2.4154 - accuracy30: 0.6237 - val_loss: 2.6963 - val_accuracy30: 0.5764 - 73s/epoch - 35ms/step
testing model: results/WBA/W4/deepVOL_L3/h30
Evaluating performance on  test set...
4676/4676 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.928188
{'0': {'precision': 0.4544816460936682, 'recall': 0.651250404868652, 'f1-score': 0.5353581923690822, 'support': 293305}, '1': {'precision': 0.7349157771031241, 'recall': 0.493115871198369, 'f1-score': 0.5902105767141617, 'support': 608719}, '2': {'precision': 0.4301995617191255, 'recall': 0.5370942315189938, 'f1-score': 0.4777404850864416, 'support': 294965}, 'accuracy': 0.5427017290885714, 'macro avg': {'precision': 0.5398656616386392, 'recall': 0.560486835862005, 'f1-score': 0.5344364180565618, 'support': 1196989}, 'weighted avg': {'precision': 0.591110486272156, 'recall': 0.5427017290885714, 'f1-score': 0.5490546269374268, 'support': 1196989}}
[[191015  52867  49423]
 [148140 300169 160410]
 [ 81137  55404 158424]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8500057
{'0': {'precision': 0.47573874712032604, 'recall': 0.6486876283677661, 'f1-score': 0.5489124878597352, 'support': 132432}, '1': {'precision': 0.774713109283153, 'recall': 0.6114522176364587, 'f1-score': 0.683468327339992, 'support': 275248}, '2': {'precision': 0.47706052687336675, 'recall': 0.5127724343159061, 'f1-score': 0.4942722606185446, 'support': 131729}, 'accuracy': 0.5964954236951924, 'macro avg': {'precision': 0.575837461092282, 'recall': 0.5909707601067103, 'f1-score': 0.5755510252727573, 'support': 539409}, 'weighted avg': {'precision': 0.6286212758910401, 'recall': 0.5964954236951924, 'f1-score': 0.6042295537800423, 'support': 539409}}
[[ 85907  23659  22866]
 [ 55770 168301  51177]
 [ 38899  25283  67547]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8863557
{'0': {'precision': 0.47427394089921254, 'recall': 0.6269213550216386, 'f1-score': 0.5400176749417531, 'support': 53608}, '1': {'precision': 0.7492963730019648, 'recall': 0.5808496624403096, 'f1-score': 0.6544071609118104, 'support': 97168}, '2': {'precision': 0.4883203751271398, 'recall': 0.530280622273808, 'f1-score': 0.5084362435381964, 'support': 53417}, 'accuracy': 0.5797162488430063, 'macro avg': {'precision': 0.5706302296761058, 'recall': 0.5793505465785853, 'f1-score': 0.5676203597972532, 'support': 204193}, 'weighted avg': {'precision': 0.6088216387131112, 'recall': 0.5797162488430063, 'f1-score': 0.5861897388785909, 'support': 204193}}
[[33608  9357 10643]
 [21690 56440 19038]
 [15564  9527 28326]]
training model: results/WBA/W4/deepVOL_L3/h50
Epoch 1/50
2108/2108 - 77s - loss: 3.1386 - accuracy50: 0.4427 - val_loss: 3.3374 - val_accuracy50: 0.4128 - 77s/epoch - 37ms/step
Epoch 2/50
2108/2108 - 73s - loss: 2.9022 - accuracy50: 0.5171 - val_loss: 2.9763 - val_accuracy50: 0.5186 - 73s/epoch - 35ms/step
Epoch 3/50
2108/2108 - 76s - loss: 2.7651 - accuracy50: 0.5539 - val_loss: 2.9944 - val_accuracy50: 0.5155 - 76s/epoch - 36ms/step
Epoch 4/50
2108/2108 - 73s - loss: 2.7230 - accuracy50: 0.5638 - val_loss: 3.0171 - val_accuracy50: 0.5196 - 73s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 73s - loss: 2.7049 - accuracy50: 0.5678 - val_loss: 3.0058 - val_accuracy50: 0.5240 - 73s/epoch - 35ms/step
Epoch 6/50
2108/2108 - 74s - loss: 2.6926 - accuracy50: 0.5701 - val_loss: 2.9302 - val_accuracy50: 0.5299 - 74s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 74s - loss: 2.6848 - accuracy50: 0.5722 - val_loss: 2.8778 - val_accuracy50: 0.5343 - 74s/epoch - 35ms/step
Epoch 8/50
2108/2108 - 73s - loss: 2.6786 - accuracy50: 0.5728 - val_loss: 2.8633 - val_accuracy50: 0.5325 - 73s/epoch - 35ms/step
Epoch 9/50
2108/2108 - 74s - loss: 2.6736 - accuracy50: 0.5736 - val_loss: 2.8328 - val_accuracy50: 0.5397 - 74s/epoch - 35ms/step
Epoch 10/50
2108/2108 - 73s - loss: 2.6695 - accuracy50: 0.5747 - val_loss: 2.8315 - val_accuracy50: 0.5401 - 73s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 74s - loss: 2.6652 - accuracy50: 0.5759 - val_loss: 2.8395 - val_accuracy50: 0.5410 - 74s/epoch - 35ms/step
Epoch 12/50
2108/2108 - 73s - loss: 2.6621 - accuracy50: 0.5767 - val_loss: 2.8394 - val_accuracy50: 0.5382 - 73s/epoch - 35ms/step
Epoch 13/50
2108/2108 - 73s - loss: 2.6576 - accuracy50: 0.5773 - val_loss: 2.8205 - val_accuracy50: 0.5427 - 73s/epoch - 35ms/step
Epoch 14/50
2108/2108 - 73s - loss: 2.6548 - accuracy50: 0.5781 - val_loss: 2.8323 - val_accuracy50: 0.5398 - 73s/epoch - 35ms/step
Epoch 15/50
2108/2108 - 74s - loss: 2.6524 - accuracy50: 0.5786 - val_loss: 2.8512 - val_accuracy50: 0.5367 - 74s/epoch - 35ms/step
Epoch 16/50
2108/2108 - 72s - loss: 2.6495 - accuracy50: 0.5790 - val_loss: 2.8573 - val_accuracy50: 0.5354 - 72s/epoch - 34ms/step
Epoch 17/50
2108/2108 - 73s - loss: 2.6461 - accuracy50: 0.5795 - val_loss: 2.8435 - val_accuracy50: 0.5355 - 73s/epoch - 35ms/step
Epoch 18/50
2108/2108 - 73s - loss: 2.6439 - accuracy50: 0.5798 - val_loss: 2.8548 - val_accuracy50: 0.5362 - 73s/epoch - 35ms/step
Epoch 19/50
2108/2108 - 73s - loss: 2.6410 - accuracy50: 0.5805 - val_loss: 2.8649 - val_accuracy50: 0.5368 - 73s/epoch - 35ms/step
Epoch 20/50
2108/2108 - 73s - loss: 2.6389 - accuracy50: 0.5813 - val_loss: 2.8603 - val_accuracy50: 0.5391 - 73s/epoch - 35ms/step
Epoch 21/50
2108/2108 - 76s - loss: 2.6359 - accuracy50: 0.5813 - val_loss: 2.8818 - val_accuracy50: 0.5344 - 76s/epoch - 36ms/step
Epoch 22/50
2108/2108 - 73s - loss: 2.6346 - accuracy50: 0.5818 - val_loss: 2.8606 - val_accuracy50: 0.5412 - 73s/epoch - 35ms/step
Epoch 23/50
2108/2108 - 75s - loss: 2.6329 - accuracy50: 0.5821 - val_loss: 2.8587 - val_accuracy50: 0.5418 - 75s/epoch - 36ms/step
testing model: results/WBA/W4/deepVOL_L3/h50
Evaluating performance on  test set...
4676/4676 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.96080804
{'0': {'precision': 0.4859632749836049, 'recall': 0.544326757093496, 'f1-score': 0.5134919397503501, 'support': 353951}, '1': {'precision': 0.5969683524508484, 'recall': 0.5041380355285465, 'f1-score': 0.546640099018144, 'support': 488396}, '2': {'precision': 0.4734461966604824, 'recall': 0.51808584431624, 'f1-score': 0.494761162319145, 'support': 354642}, 'accuracy': 0.5201543205493117, 'macro avg': {'precision': 0.5187926080316453, 'recall': 0.5221835456460941, 'f1-score': 0.5182977336958797, 'support': 1196989}, 'weighted avg': {'precision': 0.5275470774446326, 'recall': 0.5201543205493117, 'f1-score': 0.5214675418853706, 'support': 1196989}}
[[192665  78398  82888]
 [120720 246219 121457]
 [ 83075  87832 183735]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.90509164
{'0': {'precision': 0.504188740048398, 'recall': 0.5329281858231889, 'f1-score': 0.5181602649492221, 'support': 159119}, '1': {'precision': 0.6384005886522913, 'recall': 0.6390112678459956, 'f1-score': 0.638705782278572, 'support': 222669}, '2': {'precision': 0.51315913656649, 'recall': 0.48293691830403307, 'f1-score': 0.4975895463117607, 'support': 157621}, 'accuracy': 0.5621114961003617, 'macro avg': {'precision': 0.5519161550890598, 'recall': 0.5516254573244058, 'f1-score': 0.5514851978465183, 'support': 539409}, 'weighted avg': {'precision': 0.5622128756975223, 'recall': 0.5621114961003617, 'f1-score': 0.5619106891280061, 'support': 539409}}
[[ 84799  37243  37077]
 [ 45241 142288  35140]
 [ 38149  43351  76121]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9309823
{'0': {'precision': 0.497175989905666, 'recall': 0.5216719730164234, 'f1-score': 0.5091295051454414, 'support': 63446}, '1': {'precision': 0.6097301281788771, 'recall': 0.5801813269600458, 'f1-score': 0.5945888382308895, 'support': 76988}, '2': {'precision': 0.5147908768877012, 'recall': 0.5196756536332126, 'f1-score': 0.517221732241674, 'support': 63759}, 'accuracy': 0.5431087255684572, 'macro avg': {'precision': 0.5405656649907481, 'recall': 0.5405096512032272, 'f1-score': 0.5403133585393349, 'support': 204193}, 'weighted avg': {'precision': 0.5451131159406699, 'recall': 0.5431087255684572, 'f1-score': 0.5438774908404025, 'support': 204193}}
[[33098 13323 17025]
 [18116 44667 14205]
 [15358 15267 33134]]
training model: results/WBA/W4/deepVOL_L3/h100
Epoch 1/50
2108/2108 - 76s - loss: 3.2418 - accuracy100: 0.4049 - val_loss: 3.3801 - val_accuracy100: 0.3305 - 76s/epoch - 36ms/step
Epoch 2/50
2108/2108 - 79s - loss: 3.1762 - accuracy100: 0.4299 - val_loss: 3.4194 - val_accuracy100: 0.3460 - 79s/epoch - 37ms/step
Epoch 3/50
2108/2108 - 79s - loss: 3.0848 - accuracy100: 0.4659 - val_loss: 3.1883 - val_accuracy100: 0.4334 - 79s/epoch - 38ms/step
Epoch 4/50
2108/2108 - 78s - loss: 3.0346 - accuracy100: 0.4805 - val_loss: 3.1774 - val_accuracy100: 0.4383 - 78s/epoch - 37ms/step
Epoch 5/50
2108/2108 - 73s - loss: 3.0087 - accuracy100: 0.4874 - val_loss: 3.1456 - val_accuracy100: 0.4386 - 73s/epoch - 35ms/step
Epoch 6/50
2108/2108 - 74s - loss: 2.9968 - accuracy100: 0.4906 - val_loss: 3.1382 - val_accuracy100: 0.4390 - 74s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 74s - loss: 2.9884 - accuracy100: 0.4922 - val_loss: 3.1185 - val_accuracy100: 0.4413 - 74s/epoch - 35ms/step
Epoch 8/50
2108/2108 - 73s - loss: 2.9822 - accuracy100: 0.4947 - val_loss: 3.1145 - val_accuracy100: 0.4403 - 73s/epoch - 34ms/step
Epoch 9/50
2108/2108 - 73s - loss: 2.9764 - accuracy100: 0.4958 - val_loss: 3.0909 - val_accuracy100: 0.4516 - 73s/epoch - 34ms/step
Epoch 10/50
2108/2108 - 75s - loss: 2.9722 - accuracy100: 0.4975 - val_loss: 3.0832 - val_accuracy100: 0.4555 - 75s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 75s - loss: 2.9682 - accuracy100: 0.4988 - val_loss: 3.0820 - val_accuracy100: 0.4607 - 75s/epoch - 35ms/step
Epoch 12/50
2108/2108 - 75s - loss: 2.9651 - accuracy100: 0.4994 - val_loss: 3.0897 - val_accuracy100: 0.4615 - 75s/epoch - 36ms/step
Epoch 13/50
2108/2108 - 75s - loss: 2.9620 - accuracy100: 0.5004 - val_loss: 3.1083 - val_accuracy100: 0.4593 - 75s/epoch - 35ms/step
Epoch 14/50
2108/2108 - 75s - loss: 2.9594 - accuracy100: 0.5017 - val_loss: 3.1139 - val_accuracy100: 0.4589 - 75s/epoch - 36ms/step
Epoch 15/50
2108/2108 - 73s - loss: 2.9560 - accuracy100: 0.5022 - val_loss: 3.0863 - val_accuracy100: 0.4606 - 73s/epoch - 34ms/step
Epoch 16/50
2108/2108 - 73s - loss: 2.9524 - accuracy100: 0.5032 - val_loss: 3.1047 - val_accuracy100: 0.4604 - 73s/epoch - 35ms/step
Epoch 17/50
2108/2108 - 74s - loss: 2.9494 - accuracy100: 0.5038 - val_loss: 3.1002 - val_accuracy100: 0.4603 - 74s/epoch - 35ms/step
Epoch 18/50
2108/2108 - 74s - loss: 2.9459 - accuracy100: 0.5055 - val_loss: 3.1106 - val_accuracy100: 0.4595 - 74s/epoch - 35ms/step
Epoch 19/50
2108/2108 - 72s - loss: 2.9446 - accuracy100: 0.5055 - val_loss: 3.1053 - val_accuracy100: 0.4606 - 72s/epoch - 34ms/step
Epoch 20/50
2108/2108 - 74s - loss: 2.9419 - accuracy100: 0.5065 - val_loss: 3.1056 - val_accuracy100: 0.4611 - 74s/epoch - 35ms/step
Epoch 21/50
2108/2108 - 73s - loss: 2.9391 - accuracy100: 0.5076 - val_loss: 3.1007 - val_accuracy100: 0.4589 - 73s/epoch - 35ms/step
testing model: results/WBA/W4/deepVOL_L3/h100
Evaluating performance on  test set...
4676/4676 - 64s - 64s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0389344
{'0': {'precision': 0.4774991124939963, 'recall': 0.39726391188128396, 'f1-score': 0.43370183709965865, 'support': 402911}, '1': {'precision': 0.4430531617648755, 'recall': 0.487249429078914, 'f1-score': 0.46410147030922777, 'support': 394100}, '2': {'precision': 0.44468177987566737, 'recall': 0.47624369340313716, 'f1-score': 0.45992189244819487, 'support': 399978}, 'accuracy': 0.45328236099078606, 'macro avg': {'precision': 0.4550780180448464, 'recall': 0.45358567812111167, 'f1-score': 0.45257506661902713, 'support': 1196989}, 'weighted avg': {'precision': 0.4551920067074264, 'recall': 0.45328236099078606, 'f1-score': 0.4524722190714964, 'support': 1196989}}
[[160062 111693 131156]
 [ 95351 192025 106724]
 [ 79796 129695 190487]]
Evaluating performance on  train set...
2108/2108 - 30s - 30s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0117168
{'0': {'precision': 0.4969008703035449, 'recall': 0.3850481125092524, 'f1-score': 0.4338816551596312, 'support': 182385}, '1': {'precision': 0.47515743128277993, 'recall': 0.6076664236442151, 'f1-score': 0.5333041299779006, 'support': 178310}, '2': {'precision': 0.4670877366313227, 'recall': 0.4444251709435187, 'f1-score': 0.4554747288226473, 'support': 178714}, 'accuracy': 0.47831052132982577, 'macro avg': {'precision': 0.4797153460725492, 'recall': 0.47904656903232873, 'f1-score': 0.4742201713200596, 'support': 539409}, 'weighted avg': {'precision': 0.47983571754767673, 'recall': 0.47831052132982577, 'f1-score': 0.47390139167025275, 'support': 539409}}
[[ 70227  55560  56598]
 [ 35937 108353  34020]
 [ 35166  64123  79425]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0272851
{'0': {'precision': 0.4799144069625261, 'recall': 0.37621403701667583, 'f1-score': 0.42178375858336037, 'support': 70941}, '1': {'precision': 0.4413111992956578, 'recall': 0.5569224823677176, 'f1-score': 0.49242203128003237, 'support': 62102}, '2': {'precision': 0.46893604899586955, 'recall': 0.4627406886858749, 'f1-score': 0.46581777023203164, 'support': 71150}, 'accuracy': 0.46132335584471557, 'macro avg': {'precision': 0.46338721841801783, 'recall': 0.4652924026900895, 'f1-score': 0.46000785336514144, 'support': 204193}, 'weighted avg': {'precision': 0.46434851306873215, 'recall': 0.46132335584471557, 'f1-score': 0.45861067204176337, 'support': 204193}}
[[26689 20517 23735]
 [13965 34586 13551]
 [14958 23268 32924]]
training model: results/WBA/W4/deepVOL_L3/h200
Epoch 1/50
2108/2108 - 78s - loss: 3.2889 - accuracy200: 0.3705 - val_loss: 3.3549 - val_accuracy200: 0.3259 - 78s/epoch - 37ms/step
Epoch 2/50
2108/2108 - 79s - loss: 3.2558 - accuracy200: 0.3869 - val_loss: 3.3190 - val_accuracy200: 0.3403 - 79s/epoch - 37ms/step
Epoch 3/50
2108/2108 - 81s - loss: 3.2332 - accuracy200: 0.4036 - val_loss: 3.3334 - val_accuracy200: 0.3544 - 81s/epoch - 38ms/step
Epoch 4/50
2108/2108 - 80s - loss: 3.2210 - accuracy200: 0.4101 - val_loss: 3.3181 - val_accuracy200: 0.3527 - 80s/epoch - 38ms/step
Epoch 5/50
2108/2108 - 79s - loss: 3.2114 - accuracy200: 0.4148 - val_loss: 3.3314 - val_accuracy200: 0.3554 - 79s/epoch - 37ms/step
Epoch 6/50
2108/2108 - 84s - loss: 3.2011 - accuracy200: 0.4190 - val_loss: 3.3193 - val_accuracy200: 0.3499 - 84s/epoch - 40ms/step
Epoch 7/50
2108/2108 - 79s - loss: 3.1932 - accuracy200: 0.4219 - val_loss: 3.3348 - val_accuracy200: 0.3426 - 79s/epoch - 37ms/step
Epoch 8/50
2108/2108 - 78s - loss: 3.1859 - accuracy200: 0.4241 - val_loss: 3.3240 - val_accuracy200: 0.3476 - 78s/epoch - 37ms/step
Epoch 9/50
2108/2108 - 78s - loss: 3.1811 - accuracy200: 0.4264 - val_loss: 3.3423 - val_accuracy200: 0.3461 - 78s/epoch - 37ms/step
Epoch 10/50
2108/2108 - 78s - loss: 3.1765 - accuracy200: 0.4288 - val_loss: 3.4182 - val_accuracy200: 0.3383 - 78s/epoch - 37ms/step
Epoch 11/50
2108/2108 - 78s - loss: 3.1717 - accuracy200: 0.4306 - val_loss: 3.3888 - val_accuracy200: 0.3449 - 78s/epoch - 37ms/step
Epoch 12/50
2108/2108 - 81s - loss: 3.1674 - accuracy200: 0.4324 - val_loss: 3.3810 - val_accuracy200: 0.3505 - 81s/epoch - 39ms/step
Epoch 13/50
2108/2108 - 79s - loss: 3.1631 - accuracy200: 0.4344 - val_loss: 3.3855 - val_accuracy200: 0.3546 - 79s/epoch - 38ms/step
Epoch 14/50
2108/2108 - 78s - loss: 3.1595 - accuracy200: 0.4361 - val_loss: 3.3802 - val_accuracy200: 0.3534 - 78s/epoch - 37ms/step
testing model: results/WBA/W4/deepVOL_L3/h200
Evaluating performance on  test set...
4676/4676 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0919367
{'0': {'precision': 0.4041571271475185, 'recall': 0.34263051717813914, 'f1-score': 0.3708592838887373, 'support': 392592}, '1': {'precision': 0.36128289492908194, 'recall': 0.7440740268212422, 'f1-score': 0.4863971322961301, 'support': 415417}, '2': {'precision': 0.42370318678762503, 'recall': 0.009365520078153118, 'f1-score': 0.01832596371026566, 'support': 388980}, 'accuracy': 0.3736525565397844, 'macro avg': {'precision': 0.3963810696214085, 'recall': 0.3653566880258448, 'f1-score': 0.29186079329837766, 'support': 1196989}, 'weighted avg': {'precision': 0.3956293473210726, 'recall': 0.3736525565397844, 'f1-score': 0.2963957553925122, 'support': 1196989}}
[[134514 255944   2134]
 [103495 309101   2821]
 [ 94817 290520   3643]]
Evaluating performance on  train set...
2108/2108 - 37s - 37s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0972153
{'0': {'precision': 0.40514996753659666, 'recall': 0.3363955672635522, 'f1-score': 0.3675853922929072, 'support': 179934}, '1': {'precision': 0.3523452864568547, 'recall': 0.7451219046267541, 'f1-score': 0.47844745257808735, 'support': 183217}, '2': {'precision': 0.4141849529780564, 'recall': 0.005996890921263149, 'f1-score': 0.011822604999720375, 'support': 176258}, 'accuracy': 0.3672630601269167, 'macro avg': {'precision': 0.3905600689905026, 'recall': 0.36250478760385646, 'f1-score': 0.28595181662357166, 'support': 539409}, 'weighted avg': {'precision': 0.3901664822972954, 'recall': 0.3672630601269167, 'f1-score': 0.28899155484590006, 'support': 539409}}
[[ 60529 118749    656]
 [ 45859 136519    839]
 [ 43011 132190   1057]]
Evaluating performance on  val set...
798/798 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027777
{'0': {'precision': 0.399884998722208, 'recall': 0.3612125059514363, 'f1-score': 0.37956624898612024, 'support': 69311}, '1': {'precision': 0.3324309537512701, 'recall': 0.7144864237500381, 'f1-score': 0.45374622371145523, 'support': 65482}, '2': {'precision': 0.44089834515366433, 'recall': 0.005374639769452449, 'f1-score': 0.01061982176921106, 'support': 69400}, 'accuracy': 0.35356256091051114, 'macro avg': {'precision': 0.3910714325423808, 'recall': 0.360357856490309, 'f1-score': 0.2813107648222622, 'support': 204193}, 'weighted avg': {'precision': 0.3921927686729708, 'recall': 0.35356256091051114, 'f1-score': 0.27795929407635783, 'support': 204193}}
[[25036 44054   221]
 [18444 46786   252]
 [19128 49899   373]]
training model: results/WBA/W4/deepVOL_L3/h300
Epoch 1/50
2108/2108 - 79s - loss: 3.3012 - accuracy300: 0.3580 - val_loss: 3.3150 - val_accuracy300: 0.3113 - 79s/epoch - 37ms/step
Epoch 2/50
2108/2108 - 81s - loss: 3.2765 - accuracy300: 0.3746 - val_loss: 3.3038 - val_accuracy300: 0.3173 - 81s/epoch - 39ms/step
Epoch 3/50
2108/2108 - 79s - loss: 3.2638 - accuracy300: 0.3848 - val_loss: 3.3049 - val_accuracy300: 0.3184 - 79s/epoch - 37ms/step
Epoch 4/50
2108/2108 - 73s - loss: 3.2543 - accuracy300: 0.3930 - val_loss: 3.3049 - val_accuracy300: 0.3353 - 73s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 74s - loss: 3.2436 - accuracy300: 0.3997 - val_loss: 3.2934 - val_accuracy300: 0.3485 - 74s/epoch - 35ms/step
Epoch 6/50
2108/2108 - 73s - loss: 3.2383 - accuracy300: 0.4033 - val_loss: 3.3082 - val_accuracy300: 0.3417 - 73s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 72s - loss: 3.2335 - accuracy300: 0.4065 - val_loss: 3.2956 - val_accuracy300: 0.3477 - 72s/epoch - 34ms/step
Epoch 8/50
2108/2108 - 73s - loss: 3.2269 - accuracy300: 0.4105 - val_loss: 3.2824 - val_accuracy300: 0.3582 - 73s/epoch - 35ms/step
Epoch 9/50
2108/2108 - 73s - loss: 3.2213 - accuracy300: 0.4131 - val_loss: 3.2836 - val_accuracy300: 0.3596 - 73s/epoch - 34ms/step
Epoch 10/50
2108/2108 - 74s - loss: 3.2146 - accuracy300: 0.4174 - val_loss: 3.2932 - val_accuracy300: 0.3570 - 74s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 73s - loss: 3.2098 - accuracy300: 0.4189 - val_loss: 3.2961 - val_accuracy300: 0.3608 - 73s/epoch - 35ms/step
Epoch 12/50
2108/2108 - 73s - loss: 3.2043 - accuracy300: 0.4219 - val_loss: 3.3070 - val_accuracy300: 0.3608 - 73s/epoch - 34ms/step
Epoch 13/50
2108/2108 - 72s - loss: 3.1993 - accuracy300: 0.4244 - val_loss: 3.3030 - val_accuracy300: 0.3569 - 72s/epoch - 34ms/step
Epoch 14/50
2108/2108 - 73s - loss: 3.1946 - accuracy300: 0.4260 - val_loss: 3.3086 - val_accuracy300: 0.3573 - 73s/epoch - 35ms/step
Epoch 15/50
2108/2108 - 73s - loss: 3.1920 - accuracy300: 0.4268 - val_loss: 3.3077 - val_accuracy300: 0.3514 - 73s/epoch - 34ms/step
Epoch 16/50
2108/2108 - 72s - loss: 3.1866 - accuracy300: 0.4288 - val_loss: 3.3000 - val_accuracy300: 0.3635 - 72s/epoch - 34ms/step
Epoch 17/50
2108/2108 - 73s - loss: 3.1815 - accuracy300: 0.4311 - val_loss: 3.2992 - val_accuracy300: 0.3644 - 73s/epoch - 35ms/step
Epoch 18/50
2108/2108 - 73s - loss: 3.1766 - accuracy300: 0.4333 - val_loss: 3.3037 - val_accuracy300: 0.3600 - 73s/epoch - 34ms/step
testing model: results/WBA/W4/deepVOL_L3/h300
Evaluating performance on  test set...
4676/4676 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0915493
{'0': {'precision': 0.3908714976257575, 'recall': 0.36101466191890386, 'f1-score': 0.3753502834911983, 'support': 406086}, '1': {'precision': 0.3519517569747767, 'recall': 0.4572592003721815, 'f1-score': 0.3977533361424044, 'support': 391207}, '2': {'precision': 0.381758070789576, 'recall': 0.2995851847404027, 'f1-score': 0.3357164284973323, 'support': 399696}, 'accuracy': 0.3719574699516871, 'macro avg': {'precision': 0.3748604417967034, 'recall': 0.3726196823438293, 'f1-score': 0.36960668271031166, 'support': 1196989}, 'weighted avg': {'precision': 0.3751083826484581, 'recall': 0.3719574699516871, 'f1-score': 0.36943772933480434, 'support': 1196989}}
[[146603 159970  99513]
 [117918 178883  94406]
 [110546 169407 119743]]
Evaluating performance on  train set...
2108/2108 - 31s - 31s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0915989
{'0': {'precision': 0.40180889861415026, 'recall': 0.3715293889134681, 'f1-score': 0.38607635744862173, 'support': 185342}, '1': {'precision': 0.33849687410745455, 'recall': 0.4947040101107897, 'f1-score': 0.4019577132063207, 'support': 172489}, '2': {'precision': 0.3843082124437238, 'recall': 0.24539867164524337, 'f1-score': 0.2995321385837781, 'support': 181578}, 'accuracy': 0.36845881325673097, 'macro avg': {'precision': 0.37487132838844284, 'recall': 0.37054402355650035, 'f1-score': 0.3625220697462402, 'support': 539409}, 'weighted avg': {'precision': 0.3756722056991467, 'recall': 0.36845881325673097, 'f1-score': 0.36202194419309425, 'support': 539409}}
[[68860 78980 37502]
 [53273 85331 33885]
 [49242 87777 44559]]
Evaluating performance on  val set...
798/798 - 13s - 13s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961978
{'0': {'precision': 0.39047913925226413, 'recall': 0.35355545899272506, 'f1-score': 0.37110110640301314, 'support': 71341}, '1': {'precision': 0.3158209417939037, 'recall': 0.45660316952137026, 'f1-score': 0.37338255218048655, 'support': 62470}, '2': {'precision': 0.38710659280452914, 'recall': 0.27104941604387484, 'f1-score': 0.31884542423305445, 'support': 70382}, 'accuracy': 0.3566429799258545, 'macro avg': {'precision': 0.36446889128356563, 'recall': 0.36040268151932336, 'f1-score': 0.3544430276055181, 'support': 204193}, 'weighted avg': {'precision': 0.36647604336108147, 'recall': 0.3566429799258545, 'f1-score': 0.35378740071884535, 'support': 204193}}
[[25223 29862 16256]
 [19998 28524 13948]
 [19374 31931 19077]]
training model: results/WBA/W4/deepVOL_L3/h500
Epoch 1/50
2108/2108 - 77s - loss: 3.2448 - accuracy500: 0.3956 - val_loss: 3.5835 - val_accuracy500: 0.3451 - 77s/epoch - 37ms/step
Epoch 2/50
2108/2108 - 74s - loss: 3.2510 - accuracy500: 0.3957 - val_loss: 3.4728 - val_accuracy500: 0.3450 - 74s/epoch - 35ms/step
Epoch 3/50
2108/2108 - 73s - loss: 3.2464 - accuracy500: 0.4033 - val_loss: 3.4962 - val_accuracy500: 0.3451 - 73s/epoch - 34ms/step
Epoch 4/50
2108/2108 - 74s - loss: 3.2359 - accuracy500: 0.4090 - val_loss: 3.4925 - val_accuracy500: 0.3451 - 74s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 74s - loss: 3.2219 - accuracy500: 0.4142 - val_loss: 3.4339 - val_accuracy500: 0.3451 - 74s/epoch - 35ms/step
Epoch 6/50
2108/2108 - 73s - loss: 3.2243 - accuracy500: 0.4138 - val_loss: 3.5838 - val_accuracy500: 0.3451 - 73s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 73s - loss: 3.2091 - accuracy500: 0.4152 - val_loss: 3.6685 - val_accuracy500: 0.3449 - 73s/epoch - 34ms/step
Epoch 8/50
2108/2108 - 73s - loss: 3.2061 - accuracy500: 0.4167 - val_loss: 3.4992 - val_accuracy500: 0.3450 - 73s/epoch - 35ms/step
Epoch 9/50
2108/2108 - 73s - loss: 3.1950 - accuracy500: 0.4230 - val_loss: 3.7159 - val_accuracy500: 0.3452 - 73s/epoch - 35ms/step
Epoch 10/50
2108/2108 - 73s - loss: 3.1903 - accuracy500: 0.4257 - val_loss: 3.6836 - val_accuracy500: 0.3451 - 73s/epoch - 35ms/step
Epoch 11/50
2108/2108 - 74s - loss: 3.1895 - accuracy500: 0.4257 - val_loss: 3.6882 - val_accuracy500: 0.3454 - 74s/epoch - 35ms/step
Epoch 12/50
2108/2108 - 73s - loss: 3.1840 - accuracy500: 0.4294 - val_loss: 3.7245 - val_accuracy500: 0.3455 - 73s/epoch - 35ms/step
Epoch 13/50
2108/2108 - 73s - loss: 3.1775 - accuracy500: 0.4328 - val_loss: 3.7132 - val_accuracy500: 0.3458 - 73s/epoch - 35ms/step
Epoch 14/50
2108/2108 - 73s - loss: 3.1720 - accuracy500: 0.4358 - val_loss: 3.7634 - val_accuracy500: 0.3451 - 73s/epoch - 35ms/step
Epoch 15/50
2108/2108 - 73s - loss: 3.1646 - accuracy500: 0.4390 - val_loss: 3.8742 - val_accuracy500: 0.3451 - 73s/epoch - 35ms/step
testing model: results/WBA/W4/deepVOL_L3/h500
Evaluating performance on  test set...
4676/4676 - 65s - 65s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0712122
{'0': {'precision': 0.125, 'recall': 3.0355646757409815e-06, 'f1-score': 6.070981920615841e-06, 'support': 329428}, '1': {'precision': 0.45948179065772854, 'recall': 0.9999909089256168, 'f1-score': 0.6296487952200339, 'support': 549990}, '2': {'precision': 0.5384615384615384, 'recall': 2.2042314946893767e-05, 'f1-score': 4.408282533125095e-05, 'support': 317571}, 'accuracy': 0.45948041293612557, 'macro avg': {'precision': 0.37431444303975564, 'recall': 0.33333866226841313, 'f1-score': 0.20989964967576194, 'support': 1196989}, 'weighted avg': {'precision': 0.3883817305544273, 'recall': 0.45948041293612557, 'f1-score': 0.2893230767044826, 'support': 1196989}}
[[     1 329422      5]
 [     4 549985      1]
 [     3 317561      7]]
Evaluating performance on  train set...
2108/2108 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1491584
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 181203}, '1': {'precision': 0.3328531675185439, 'recall': 0.9999777213385019, 'f1-score': 0.4994568399910424, 'support': 179544}, '2': {'precision': 0.4, 'recall': 2.2388644479519986e-05, 'f1-score': 4.477478284230321e-05, 'support': 178662}, 'accuracy': 0.3328531782005862, 'macro avg': {'precision': 0.24428438917284798, 'recall': 0.3333333699943271, 'f1-score': 0.16650053825796157, 'support': 539409}, 'weighted avg': {'precision': 0.24327845680911783, 'recall': 0.3328531782005862, 'f1-score': 0.16626062678154035, 'support': 539409}}
[[     0 181199      4]
 [     2 179540      2]
 [     0 178658      4]]
Evaluating performance on  val set...
798/798 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1452699
{'0': {'precision': 1.0, 'recall': 1.4915355358341413e-05, 'f1-score': 2.9830265787668168e-05, 'support': 67045}, '1': {'precision': 0.34504966011714694, 'recall': 0.9999716138921612, 'f1-score': 0.5130623168089715, 'support': 70457}, '2': {'precision': 0.5, 'recall': 2.9989053995291718e-05, 'f1-score': 5.9974510832896015e-05, 'support': 66691}, 'accuracy': 0.34505590299373634, 'macro avg': {'precision': 0.6150165533723823, 'recall': 0.3333388394338383, 'f1-score': 0.17105070719519735, 'support': 204193}, 'weighted avg': {'precision': 0.6107048914648093, 'recall': 0.34505590299373634, 'f1-score': 0.17706205102859252, 'support': 204193}}
[[    1 67044     0]
 [    0 70455     2]
 [    0 66689     2]]
training model: results/WBA/W4/deepVOL_L3/h1000
Epoch 1/50
2108/2108 - 75s - loss: 3.2480 - accuracy1000: 0.3916 - val_loss: 3.3299 - val_accuracy1000: 0.3130 - 75s/epoch - 36ms/step
Epoch 2/50
2108/2108 - 73s - loss: 3.2643 - accuracy1000: 0.3775 - val_loss: 3.3341 - val_accuracy1000: 0.3546 - 73s/epoch - 35ms/step
Epoch 3/50
2108/2108 - 74s - loss: 3.2500 - accuracy1000: 0.3885 - val_loss: 3.3318 - val_accuracy1000: 0.3496 - 74s/epoch - 35ms/step
Epoch 4/50
2108/2108 - 74s - loss: 3.2439 - accuracy1000: 0.3951 - val_loss: 3.3623 - val_accuracy1000: 0.3511 - 74s/epoch - 35ms/step
Epoch 5/50
2108/2108 - 73s - loss: 3.2136 - accuracy1000: 0.4154 - val_loss: 3.3630 - val_accuracy1000: 0.3618 - 73s/epoch - 34ms/step
Epoch 6/50
2108/2108 - 73s - loss: 3.2015 - accuracy1000: 0.4261 - val_loss: 3.3758 - val_accuracy1000: 0.3532 - 73s/epoch - 35ms/step
Epoch 7/50
2108/2108 - 73s - loss: 3.1876 - accuracy1000: 0.4328 - val_loss: 3.4017 - val_accuracy1000: 0.3474 - 73s/epoch - 34ms/step
Epoch 8/50
2108/2108 - 73s - loss: 3.1767 - accuracy1000: 0.4361 - val_loss: 3.4072 - val_accuracy1000: 0.3507 - 73s/epoch - 35ms/step
Epoch 9/50
2108/2108 - 73s - loss: 3.1667 - accuracy1000: 0.4410 - val_loss: 3.4121 - val_accuracy1000: 0.3351 - 73s/epoch - 35ms/step
Epoch 10/50
2108/2108 - 78s - loss: 3.1611 - accuracy1000: 0.4426 - val_loss: 3.4032 - val_accuracy1000: 0.3509 - 78s/epoch - 37ms/step
Epoch 11/50
2108/2108 - 78s - loss: 3.1511 - accuracy1000: 0.4476 - val_loss: 3.4091 - val_accuracy1000: 0.3312 - 78s/epoch - 37ms/step
testing model: results/WBA/W4/deepVOL_L3/h1000
Evaluating performance on  test set...
4676/4676 - 66s - 66s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1018974
{'0': {'precision': 0.39473684210526316, 'recall': 0.00025851371846132633, 'f1-score': 0.0005166890565257828, 'support': 406168}, '1': {'precision': 0.3455128855642055, 'recall': 0.8733476490261176, 'f1-score': 0.4951392841957139, 'support': 409341}, '2': {'precision': 0.3396178674138165, 'recall': 0.14425657963720248, 'f1-score': 0.20249927325313974, 'support': 381480}, 'accuracy': 0.34472580783950396, 'macro avg': {'precision': 0.35995586502776167, 'recall': 0.3392875807939271, 'f1-score': 0.23271841550179315, 'support': 1196989}, 'weighted avg': {'precision': 0.36033705224941137, 'recall': 0.34472580783950396, 'f1-score': 0.23403731784776338, 'support': 1196989}}
[[   105 350828  55235]
 [    72 357497  51772]
 [    89 326360  55031]]
Evaluating performance on  train set...
2108/2108 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1015786
{'0': {'precision': 0.39737991266375544, 'recall': 0.0005038118069127409, 'f1-score': 0.0010063477318470353, 'support': 180623}, '1': {'precision': 0.3408132625658159, 'recall': 0.8875269136944587, 'f1-score': 0.49250354082220416, 'support': 181599}, '2': {'precision': 0.35652633167345704, 'recall': 0.13334499709346623, 'f1-score': 0.1940958773007143, 'support': 177187}, 'accuracy': 0.3427677328335271, 'macro avg': {'precision': 0.36490650230100946, 'recall': 0.34045857419827924, 'f1-score': 0.2292019219515885, 'support': 539409}, 'weighted avg': {'precision': 0.36491628942783666, 'recall': 0.3427677328335271, 'f1-score': 0.22990195986240966, 'support': 539409}}
[[    91 158239  22293]
 [    75 161174  20350]
 [    63 153497  23627]]
Evaluating performance on  val set...
798/798 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1091714
{'0': {'precision': 0.3793103448275862, 'recall': 0.00046093891860936125, 'f1-score': 0.0009207589285714286, 'support': 71593}, '1': {'precision': 0.3023867606923286, 'recall': 0.8508053997652276, 'f1-score': 0.4461915327493555, 'support': 61336}, '2': {'precision': 0.35840020298772557, 'recall': 0.15856533453075886, 'f1-score': 0.21985932894263227, 'support': 71264}, 'accuracy': 0.311068449946864, 'macro avg': {'precision': 0.3466991028358801, 'recall': 0.3366105577381986, 'f1-score': 0.22232387354018637, 'support': 204193}, 'weighted avg': {'precision': 0.348906142408326, 'recall': 0.311068449946864, 'f1-score': 0.21108254917874478, 'support': 204193}}
[[   33 60455 11105]
 [   27 52185  9124]
 [   27 59937 11300]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        25 (peak)  15.97 (ave)

============================================
