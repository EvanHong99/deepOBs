This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-17.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-25.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-23.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-18.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-08.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-02-04.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-31.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-01-30.csv
training model: results/CHTR/W0/deepLOB_L1/h10
Epoch 1/50
486/486 - 40s - loss: 3.3060 - accuracy10: 0.3718 - val_loss: 3.3347 - val_accuracy10: 0.3629 - 40s/epoch - 83ms/step
Epoch 2/50
486/486 - 13s - loss: 3.2659 - accuracy10: 0.3850 - val_loss: 3.3101 - val_accuracy10: 0.3792 - 13s/epoch - 26ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2415 - accuracy10: 0.3995 - val_loss: 3.3117 - val_accuracy10: 0.3880 - 13s/epoch - 26ms/step
Epoch 4/50
486/486 - 13s - loss: 3.2293 - accuracy10: 0.4092 - val_loss: 3.2710 - val_accuracy10: 0.3976 - 13s/epoch - 26ms/step
Epoch 5/50
486/486 - 13s - loss: 3.2190 - accuracy10: 0.4146 - val_loss: 3.2601 - val_accuracy10: 0.4032 - 13s/epoch - 26ms/step
Epoch 6/50
486/486 - 14s - loss: 3.2078 - accuracy10: 0.4222 - val_loss: 3.2599 - val_accuracy10: 0.4052 - 14s/epoch - 28ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2025 - accuracy10: 0.4245 - val_loss: 3.2746 - val_accuracy10: 0.4016 - 12s/epoch - 25ms/step
Epoch 8/50
486/486 - 12s - loss: 3.1998 - accuracy10: 0.4261 - val_loss: 3.2511 - val_accuracy10: 0.4075 - 12s/epoch - 25ms/step
Epoch 9/50
486/486 - 12s - loss: 3.1904 - accuracy10: 0.4298 - val_loss: 3.2630 - val_accuracy10: 0.4077 - 12s/epoch - 25ms/step
Epoch 10/50
486/486 - 12s - loss: 3.1843 - accuracy10: 0.4329 - val_loss: 3.2579 - val_accuracy10: 0.4080 - 12s/epoch - 26ms/step
Epoch 11/50
486/486 - 12s - loss: 3.1807 - accuracy10: 0.4353 - val_loss: 3.2569 - val_accuracy10: 0.4104 - 12s/epoch - 25ms/step
Epoch 12/50
486/486 - 12s - loss: 3.1769 - accuracy10: 0.4359 - val_loss: 3.2500 - val_accuracy10: 0.4131 - 12s/epoch - 26ms/step
Epoch 13/50
486/486 - 13s - loss: 3.1718 - accuracy10: 0.4392 - val_loss: 3.2496 - val_accuracy10: 0.4150 - 13s/epoch - 26ms/step
Epoch 14/50
486/486 - 12s - loss: 3.1681 - accuracy10: 0.4402 - val_loss: 3.2617 - val_accuracy10: 0.4112 - 12s/epoch - 25ms/step
Epoch 15/50
486/486 - 12s - loss: 3.1643 - accuracy10: 0.4414 - val_loss: 3.2506 - val_accuracy10: 0.4143 - 12s/epoch - 25ms/step
Epoch 16/50
486/486 - 13s - loss: 3.1621 - accuracy10: 0.4422 - val_loss: 3.2448 - val_accuracy10: 0.4155 - 13s/epoch - 26ms/step
Epoch 17/50
486/486 - 12s - loss: 3.1568 - accuracy10: 0.4447 - val_loss: 3.2527 - val_accuracy10: 0.4154 - 12s/epoch - 26ms/step
Epoch 18/50
486/486 - 13s - loss: 3.1550 - accuracy10: 0.4454 - val_loss: 3.2489 - val_accuracy10: 0.4146 - 13s/epoch - 26ms/step
Epoch 19/50
486/486 - 12s - loss: 3.1513 - accuracy10: 0.4464 - val_loss: 3.2537 - val_accuracy10: 0.4134 - 12s/epoch - 25ms/step
Epoch 20/50
486/486 - 13s - loss: 3.1496 - accuracy10: 0.4474 - val_loss: 3.2527 - val_accuracy10: 0.4147 - 13s/epoch - 26ms/step
Epoch 21/50
486/486 - 13s - loss: 3.1480 - accuracy10: 0.4488 - val_loss: 3.2516 - val_accuracy10: 0.4142 - 13s/epoch - 26ms/step
Epoch 22/50
486/486 - 13s - loss: 3.1436 - accuracy10: 0.4499 - val_loss: 3.2487 - val_accuracy10: 0.4168 - 13s/epoch - 26ms/step
Epoch 23/50
486/486 - 12s - loss: 3.1398 - accuracy10: 0.4504 - val_loss: 3.2562 - val_accuracy10: 0.4155 - 12s/epoch - 25ms/step
Epoch 24/50
486/486 - 12s - loss: 3.1373 - accuracy10: 0.4529 - val_loss: 3.2508 - val_accuracy10: 0.4169 - 12s/epoch - 24ms/step
Epoch 25/50
486/486 - 13s - loss: 3.1341 - accuracy10: 0.4525 - val_loss: 3.2536 - val_accuracy10: 0.4136 - 13s/epoch - 26ms/step
Epoch 26/50
486/486 - 13s - loss: 3.1313 - accuracy10: 0.4534 - val_loss: 3.2577 - val_accuracy10: 0.4162 - 13s/epoch - 26ms/step
testing model: results/CHTR/W0/deepLOB_L1/h10
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0861434
{'0': {'precision': 0.4200094186594108, 'recall': 0.3558578129294828, 'f1-score': 0.3852814683972045, 'support': 112781}, '1': {'precision': 0.37230430393686337, 'recall': 0.36113583763574864, 'f1-score': 0.36663503682617143, 'support': 101106}, '2': {'precision': 0.4138756710590532, 'recall': 0.489497370960614, 'f1-score': 0.44852136042278723, 'support': 110877}, 'accuracy': 0.4031265780689978, 'macro avg': {'precision': 0.40206313121844245, 'recall': 0.4021636738419485, 'f1-score': 0.4001459552153877, 'support': 324764}, 'weighted avg': {'precision': 0.4030636831042916, 'recall': 0.4031265780689978, 'f1-score': 0.40106703390846704, 'support': 324764}}
[[40134 33031 39616]
 [27347 36513 37246]
 [28074 28529 54274]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0780998
{'0': {'precision': 0.41720666650725713, 'recall': 0.42270513845482954, 'f1-score': 0.419937904642711, 'support': 41277}, '1': {'precision': 0.4348803159794341, 'recall': 0.31147421046213875, 'f1-score': 0.36297496234404747, 'support': 41005}, '2': {'precision': 0.40412701403938567, 'recall': 0.5109236890381912, 'f1-score': 0.4512931669437488, 'support': 41973}, 'accuracy': 0.41579815701581424, 'macro avg': {'precision': 0.41873799884202567, 'recall': 0.4150343459850532, 'f1-score': 0.41140201131016907, 'support': 124255}, 'weighted avg': {'precision': 0.41862082081551555, 'recall': 0.41579815701581424, 'f1-score': 0.41173146607367767, 'support': 124255}}
[[17448  8605 15224]
 [11837 12772 16396]
 [12536  7992 21445]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0811414
{'0': {'precision': 0.4021574689206078, 'recall': 0.413247718823927, 'f1-score': 0.4076271751450097, 'support': 14795}, '1': {'precision': 0.4233024399470399, 'recall': 0.30125185085475836, 'f1-score': 0.35199748348537274, 'support': 14858}, '2': {'precision': 0.4173631160411285, 'recall': 0.5193168210751875, 'f1-score': 0.46279135074417305, 'support': 15867}, 'accuracy': 0.41366432337434095, 'macro avg': {'precision': 0.4142743416362588, 'recall': 0.41127213025129095, 'f1-score': 0.4074720031248518, 'support': 45520}, 'weighted avg': {'precision': 0.4143595774964433, 'recall': 0.41366432337434095, 'f1-score': 0.40869800149722935, 'support': 45520}}
[[6114 3144 5537]
 [4416 4476 5966]
 [4673 2954 8240]]
training model: results/CHTR/W0/deepLOB_L1/h20
Epoch 1/50
486/486 - 15s - loss: 3.3092 - accuracy20: 0.3673 - val_loss: 3.3493 - val_accuracy20: 0.3598 - 15s/epoch - 31ms/step
Epoch 2/50
486/486 - 13s - loss: 3.2765 - accuracy20: 0.3777 - val_loss: 3.3141 - val_accuracy20: 0.3768 - 13s/epoch - 27ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2586 - accuracy20: 0.3872 - val_loss: 3.2956 - val_accuracy20: 0.3814 - 13s/epoch - 26ms/step
Epoch 4/50
486/486 - 13s - loss: 3.2496 - accuracy20: 0.3911 - val_loss: 3.2757 - val_accuracy20: 0.3880 - 13s/epoch - 26ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2384 - accuracy20: 0.3980 - val_loss: 3.2913 - val_accuracy20: 0.3864 - 12s/epoch - 25ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2310 - accuracy20: 0.4055 - val_loss: 3.2937 - val_accuracy20: 0.3909 - 12s/epoch - 25ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2248 - accuracy20: 0.4112 - val_loss: 3.2858 - val_accuracy20: 0.3913 - 12s/epoch - 25ms/step
Epoch 8/50
486/486 - 13s - loss: 3.2209 - accuracy20: 0.4127 - val_loss: 3.2749 - val_accuracy20: 0.3952 - 13s/epoch - 26ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2155 - accuracy20: 0.4160 - val_loss: 3.2806 - val_accuracy20: 0.3944 - 12s/epoch - 26ms/step
Epoch 10/50
486/486 - 13s - loss: 3.2086 - accuracy20: 0.4206 - val_loss: 3.2807 - val_accuracy20: 0.3976 - 13s/epoch - 26ms/step
Epoch 11/50
486/486 - 13s - loss: 3.2053 - accuracy20: 0.4222 - val_loss: 3.2822 - val_accuracy20: 0.3989 - 13s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2016 - accuracy20: 0.4245 - val_loss: 3.2769 - val_accuracy20: 0.4018 - 12s/epoch - 25ms/step
Epoch 13/50
486/486 - 13s - loss: 3.1981 - accuracy20: 0.4251 - val_loss: 3.2820 - val_accuracy20: 0.3964 - 13s/epoch - 26ms/step
Epoch 14/50
486/486 - 13s - loss: 3.1933 - accuracy20: 0.4298 - val_loss: 3.2820 - val_accuracy20: 0.4001 - 13s/epoch - 26ms/step
Epoch 15/50
486/486 - 12s - loss: 3.1892 - accuracy20: 0.4295 - val_loss: 3.2881 - val_accuracy20: 0.4007 - 12s/epoch - 26ms/step
Epoch 16/50
486/486 - 12s - loss: 3.1891 - accuracy20: 0.4308 - val_loss: 3.2885 - val_accuracy20: 0.4017 - 12s/epoch - 25ms/step
Epoch 17/50
486/486 - 12s - loss: 3.1876 - accuracy20: 0.4305 - val_loss: 3.2867 - val_accuracy20: 0.4012 - 12s/epoch - 26ms/step
Epoch 18/50
486/486 - 12s - loss: 3.1838 - accuracy20: 0.4319 - val_loss: 3.2903 - val_accuracy20: 0.4006 - 12s/epoch - 25ms/step
testing model: results/CHTR/W0/deepLOB_L1/h20
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.099745
{'0': {'precision': 0.3966984912896582, 'recall': 0.34622945593652593, 'f1-score': 0.3697497269361527, 'support': 112928}, '1': {'precision': 0.32598394503794476, 'recall': 0.26699324560265786, 'f1-score': 0.29355433184879665, 'support': 100231}, '2': {'precision': 0.38464367497050866, 'recall': 0.4966712960888849, 'f1-score': 0.43353733648788695, 'support': 111605}, 'accuracy': 0.37347427670554617, 'macro avg': {'precision': 0.3691087037660372, 'recall': 0.3699646658760229, 'f1-score': 0.3656137984242787, 'support': 324764}, 'weighted avg': {'precision': 0.37073142763526856, 'recall': 0.37347427670554617, 'f1-score': 0.3681543392670161, 'support': 324764}}
[[39099 29072 44757]
 [29548 26761 43922]
 [29914 26260 55431]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0985821
{'0': {'precision': 0.39531580625525375, 'recall': 0.33063421256788206, 'f1-score': 0.3600934690482791, 'support': 41248}, '1': {'precision': 0.3513618402483771, 'recall': 0.24187594112789623, 'f1-score': 0.2865157225466786, 'support': 41174}, '2': {'precision': 0.37738552725851626, 'recall': 0.5540123825687854, 'f1-score': 0.448951523076178, 'support': 41833}, 'accuracy': 0.3764275079473663, 'macro avg': {'precision': 0.37468772458738236, 'recall': 0.3755075120881879, 'f1-score': 0.3651869048903786, 'support': 124255}, 'weighted avg': {'precision': 0.3747143177224973, 'recall': 0.3764275079473663, 'f1-score': 0.36562812632317504, 'support': 124255}}
[[13638  9606 18004]
 [10983  9959 20232]
 [ 9878  8779 23176]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0909946
{'0': {'precision': 0.38781612059299864, 'recall': 0.4170406591198339, 'f1-score': 0.4018978149307685, 'support': 14929}, '1': {'precision': 0.4155258495732002, 'recall': 0.1716110150325928, 'f1-score': 0.24290354469707667, 'support': 15034}, '2': {'precision': 0.39674076622092275, 'recall': 0.5931092112875233, 'f1-score': 0.47544700365847375, 'support': 15557}, 'accuracy': 0.3961555360281195, 'macro avg': {'precision': 0.4000275787957072, 'recall': 0.39392029514665, 'f1-score': 0.37341612109543965, 'support': 45520}, 'weighted avg': {'precision': 0.40001798301659197, 'recall': 0.3961555360281195, 'f1-score': 0.37452270224060125, 'support': 45520}}
[[6226 2009 6694]
 [5118 2580 7336]
 [4710 1620 9227]]
training model: results/CHTR/W0/deepLOB_L1/h30
Epoch 1/50
486/486 - 15s - loss: 3.3118 - accuracy30: 0.3648 - val_loss: 3.3739 - val_accuracy30: 0.3512 - 15s/epoch - 30ms/step
Epoch 2/50
486/486 - 13s - loss: 3.2834 - accuracy30: 0.3744 - val_loss: 3.3257 - val_accuracy30: 0.3626 - 13s/epoch - 27ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2672 - accuracy30: 0.3791 - val_loss: 3.3086 - val_accuracy30: 0.3647 - 13s/epoch - 27ms/step
Epoch 4/50
486/486 - 13s - loss: 3.2587 - accuracy30: 0.3864 - val_loss: 3.3077 - val_accuracy30: 0.3740 - 13s/epoch - 27ms/step
Epoch 5/50
486/486 - 13s - loss: 3.2508 - accuracy30: 0.3896 - val_loss: 3.3008 - val_accuracy30: 0.3700 - 13s/epoch - 26ms/step
Epoch 6/50
486/486 - 13s - loss: 3.2430 - accuracy30: 0.3959 - val_loss: 3.3046 - val_accuracy30: 0.3713 - 13s/epoch - 26ms/step
Epoch 7/50
486/486 - 13s - loss: 3.2397 - accuracy30: 0.3998 - val_loss: 3.2968 - val_accuracy30: 0.3754 - 13s/epoch - 26ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2342 - accuracy30: 0.4012 - val_loss: 3.2969 - val_accuracy30: 0.3770 - 12s/epoch - 25ms/step
Epoch 9/50
486/486 - 13s - loss: 3.2283 - accuracy30: 0.4057 - val_loss: 3.2938 - val_accuracy30: 0.3761 - 13s/epoch - 27ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2247 - accuracy30: 0.4095 - val_loss: 3.2991 - val_accuracy30: 0.3765 - 12s/epoch - 25ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2208 - accuracy30: 0.4110 - val_loss: 3.3014 - val_accuracy30: 0.3770 - 12s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2185 - accuracy30: 0.4117 - val_loss: 3.2993 - val_accuracy30: 0.3765 - 12s/epoch - 26ms/step
Epoch 13/50
486/486 - 12s - loss: 3.2139 - accuracy30: 0.4146 - val_loss: 3.3047 - val_accuracy30: 0.3752 - 12s/epoch - 25ms/step
Epoch 14/50
486/486 - 12s - loss: 3.2106 - accuracy30: 0.4172 - val_loss: 3.3052 - val_accuracy30: 0.3757 - 12s/epoch - 26ms/step
Epoch 15/50
486/486 - 13s - loss: 3.2083 - accuracy30: 0.4187 - val_loss: 3.3078 - val_accuracy30: 0.3746 - 13s/epoch - 26ms/step
Epoch 16/50
486/486 - 13s - loss: 3.2067 - accuracy30: 0.4174 - val_loss: 3.3106 - val_accuracy30: 0.3737 - 13s/epoch - 26ms/step
Epoch 17/50
486/486 - 13s - loss: 3.2011 - accuracy30: 0.4213 - val_loss: 3.3137 - val_accuracy30: 0.3715 - 13s/epoch - 26ms/step
Epoch 18/50
486/486 - 12s - loss: 3.1984 - accuracy30: 0.4231 - val_loss: 3.3186 - val_accuracy30: 0.3716 - 12s/epoch - 25ms/step
Epoch 19/50
486/486 - 13s - loss: 3.1987 - accuracy30: 0.4246 - val_loss: 3.3160 - val_accuracy30: 0.3754 - 13s/epoch - 26ms/step
testing model: results/CHTR/W0/deepLOB_L1/h30
Evaluating performance on  test set...
1269/1269 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1003472
{'0': {'precision': 0.37974118222515235, 'recall': 0.32232792389479575, 'f1-score': 0.34868700478917386, 'support': 110794}, '1': {'precision': 0.33964776632302407, 'recall': 0.07571651552729605, 'f1-score': 0.12382839110790939, 'support': 104429}, '2': {'precision': 0.36036270554037053, 'recall': 0.6824294099926055, 'f1-score': 0.4716608514048116, 'support': 109541}, 'accuracy': 0.36448929068492814, 'macro avg': {'precision': 0.3599172180295156, 'recall': 0.36015794980489907, 'f1-score': 0.3147254157672983, 'support': 324764}, 'weighted avg': {'precision': 0.36031275714179634, 'recall': 0.36448929068492814, 'f1-score': 0.3178612912371878, 'support': 324764}}
[[35712  8744 66338]
 [30173  7907 66349]
 [28158  6629 74754]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1011761
{'0': {'precision': 0.38615466619286637, 'recall': 0.4211865022649645, 'f1-score': 0.4029105402806262, 'support': 41281}, '1': {'precision': 0.3400336666996732, 'recall': 0.08353605137686095, 'f1-score': 0.1341222879684418, 'support': 41108}, '2': {'precision': 0.3650658180240127, 'recall': 0.6028041847800124, 'f1-score': 0.45473710764351866, 'support': 41866}, 'accuracy': 0.37067321234557965, 'macro avg': {'precision': 0.3637513836388508, 'recall': 0.36917557947394597, 'f1-score': 0.3305899786308622, 'support': 124255}, 'weighted avg': {'precision': 0.3637905942070034, 'recall': 0.37067321234557965, 'f1-score': 0.3314480123595412, 'support': 124255}}
[[17387  3550 20344]
 [14125  3434 23549]
 [13514  3115 25237]]
Evaluating performance on  val set...
178/178 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.097245
{'0': {'precision': 0.37572970104369363, 'recall': 0.42565130260521045, 'f1-score': 0.39913558207272387, 'support': 14970}, '1': {'precision': 0.4230769230769231, 'recall': 0.05933039531671381, 'f1-score': 0.10406691664263053, 'support': 15203}, '2': {'precision': 0.37292368231866513, 'recall': 0.6422102039486545, 'f1-score': 0.47184986595174266, 'support': 15347}, 'accuracy': 0.3763181019332162, 'macro avg': {'precision': 0.3905767688130939, 'recall': 0.37573063395685957, 'f1-score': 0.32501745488903233, 'support': 45520}, 'weighted avg': {'precision': 0.39059692088548126, 'recall': 0.3763181019332162, 'f1-score': 0.3251025678846218, 'support': 45520}}
[[6372  656 7942]
 [5670  902 8631]
 [4917  574 9856]]
training model: results/CHTR/W0/deepLOB_L1/h50
Epoch 1/50
486/486 - 15s - loss: 3.3132 - accuracy50: 0.3622 - val_loss: 3.3438 - val_accuracy50: 0.3488 - 15s/epoch - 30ms/step
Epoch 2/50
486/486 - 12s - loss: 3.2817 - accuracy50: 0.3699 - val_loss: 3.3212 - val_accuracy50: 0.3607 - 12s/epoch - 26ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2694 - accuracy50: 0.3747 - val_loss: 3.3103 - val_accuracy50: 0.3630 - 13s/epoch - 26ms/step
Epoch 4/50
486/486 - 13s - loss: 3.2632 - accuracy50: 0.3802 - val_loss: 3.3323 - val_accuracy50: 0.3540 - 13s/epoch - 26ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2587 - accuracy50: 0.3815 - val_loss: 3.3184 - val_accuracy50: 0.3586 - 12s/epoch - 25ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2565 - accuracy50: 0.3859 - val_loss: 3.3158 - val_accuracy50: 0.3585 - 12s/epoch - 25ms/step
Epoch 7/50
486/486 - 13s - loss: 3.2540 - accuracy50: 0.3854 - val_loss: 3.3179 - val_accuracy50: 0.3592 - 13s/epoch - 26ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2511 - accuracy50: 0.3874 - val_loss: 3.3160 - val_accuracy50: 0.3574 - 12s/epoch - 25ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2468 - accuracy50: 0.3909 - val_loss: 3.3218 - val_accuracy50: 0.3610 - 12s/epoch - 25ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2453 - accuracy50: 0.3913 - val_loss: 3.3115 - val_accuracy50: 0.3615 - 12s/epoch - 24ms/step
Epoch 11/50
486/486 - 13s - loss: 3.2415 - accuracy50: 0.3937 - val_loss: 3.3271 - val_accuracy50: 0.3600 - 13s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2396 - accuracy50: 0.3950 - val_loss: 3.3206 - val_accuracy50: 0.3625 - 12s/epoch - 26ms/step
Epoch 13/50
486/486 - 13s - loss: 3.2368 - accuracy50: 0.3970 - val_loss: 3.3298 - val_accuracy50: 0.3600 - 13s/epoch - 26ms/step
testing model: results/CHTR/W0/deepLOB_L1/h50
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1061718
{'0': {'precision': 0.3521127715089289, 'recall': 0.4816672383583487, 'f1-score': 0.406824784082812, 'support': 107867}, '1': {'precision': 0.34327485380116957, 'recall': 0.005355937152137813, 'f1-score': 0.010547310166385165, 'support': 109598}, '2': {'precision': 0.3501729354583217, 'recall': 0.5727453191548849, 'f1-score': 0.434621178367598, 'support': 107299}, 'accuracy': 0.3510179699720412, 'macro avg': {'precision': 0.34852018692280673, 'recall': 0.3532561648884571, 'f1-score': 0.2839977575389317, 'support': 324764}, 'weighted avg': {'precision': 0.34848933857507813, 'recall': 0.3510179699720412, 'f1-score': 0.28227682533144394, 'support': 324764}}
[[51956   603 55308]
 [50275   587 58736]
 [45324   520 61455]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1038082
{'0': {'precision': 0.36927593881706683, 'recall': 0.3778833107191316, 'f1-score': 0.3735300457452159, 'support': 41272}, '1': {'precision': 0.2493283181085438, 'recall': 0.011288713719193245, 'f1-score': 0.02159947863327437, 'support': 41103}, '2': {'precision': 0.3582959081836327, 'recall': 0.685792741165234, 'f1-score': 0.4706817436905932, 'support': 41880}, 'accuracy': 0.36039595992112994, 'macro avg': {'precision': 0.32563338836974776, 'recall': 0.3583215885345196, 'f1-score': 0.28860375602302785, 'support': 124255}, 'weighted avg': {'precision': 0.32589699441313424, 'recall': 0.36039595992112994, 'f1-score': 0.28985784752341615, 'support': 124255}}
[[15596   714 24962]
 [14162   464 26477]
 [12476   683 28721]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1030905
{'0': {'precision': 0.35893231301812883, 'recall': 0.5268788446108585, 'f1-score': 0.42698455703061505, 'support': 14956}, '1': {'precision': 0.45555555555555555, 'recall': 0.0054247155332098436, 'f1-score': 0.01072175732217573, 'support': 15116}, '2': {'precision': 0.36714273496963995, 'recall': 0.5558001035732781, 'f1-score': 0.4421898336509244, 'support': 15448}, 'accuracy': 0.3635325131810193, 'macro avg': {'precision': 0.3938768678477748, 'recall': 0.3627012212391156, 'f1-score': 0.2932987160012384, 'support': 45520}, 'weighted avg': {'precision': 0.3938047104808416, 'recall': 0.3635325131810193, 'f1-score': 0.2939147554672972, 'support': 45520}}
[[7880   53 7023]
 [7257   82 7777]
 [6817   45 8586]]
training model: results/CHTR/W0/deepLOB_L1/h100
Epoch 1/50
486/486 - 15s - loss: 3.3231 - accuracy100: 0.3608 - val_loss: 3.3514 - val_accuracy100: 0.3387 - 15s/epoch - 30ms/step
Epoch 2/50
486/486 - 12s - loss: 3.2928 - accuracy100: 0.3639 - val_loss: 3.3319 - val_accuracy100: 0.3352 - 12s/epoch - 25ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2819 - accuracy100: 0.3690 - val_loss: 3.3439 - val_accuracy100: 0.3370 - 12s/epoch - 26ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2767 - accuracy100: 0.3716 - val_loss: 3.3507 - val_accuracy100: 0.3393 - 12s/epoch - 25ms/step
Epoch 5/50
486/486 - 13s - loss: 3.2707 - accuracy100: 0.3749 - val_loss: 3.3519 - val_accuracy100: 0.3353 - 13s/epoch - 26ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2652 - accuracy100: 0.3795 - val_loss: 3.3478 - val_accuracy100: 0.3415 - 12s/epoch - 25ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2637 - accuracy100: 0.3802 - val_loss: 3.3370 - val_accuracy100: 0.3467 - 12s/epoch - 25ms/step
Epoch 8/50
486/486 - 13s - loss: 3.2625 - accuracy100: 0.3802 - val_loss: 3.3366 - val_accuracy100: 0.3446 - 13s/epoch - 26ms/step
Epoch 9/50
486/486 - 13s - loss: 3.2576 - accuracy100: 0.3862 - val_loss: 3.3392 - val_accuracy100: 0.3428 - 13s/epoch - 26ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2540 - accuracy100: 0.3878 - val_loss: 3.3378 - val_accuracy100: 0.3424 - 12s/epoch - 26ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2519 - accuracy100: 0.3884 - val_loss: 3.3493 - val_accuracy100: 0.3419 - 12s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2478 - accuracy100: 0.3913 - val_loss: 3.3378 - val_accuracy100: 0.3448 - 12s/epoch - 24ms/step
testing model: results/CHTR/W0/deepLOB_L1/h100
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1155033
{'0': {'precision': 0.3213780511875781, 'recall': 0.3799749127293589, 'f1-score': 0.3482286473023129, 'support': 102841}, '1': {'precision': 0.35264441267972757, 'recall': 0.03568632789898234, 'f1-score': 0.06481374162590695, 'support': 117524}, '2': {'precision': 0.32051087678208273, 'recall': 0.5872374256458395, 'f1-score': 0.41468759934793925, 'support': 104399}, 'accuracy': 0.3220122920028082, 'macro avg': {'precision': 0.3315111135497961, 'recall': 0.33429955542472695, 'f1-score': 0.275909996092053, 'support': 324764}, 'weighted avg': {'precision': 0.33241380554226047, 'recall': 0.3220122920028082, 'f1-score': 0.2670318236392758, 'support': 324764}}
[[39077  3695 60069]
 [43427  4194 69903]
 [39088  4004 61307]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1136506
{'0': {'precision': 0.3489691065590178, 'recall': 0.38232857351722793, 'f1-score': 0.3648879638135327, 'support': 41038}, '1': {'precision': 0.25475586556753327, 'recall': 0.03911879259980526, 'f1-score': 0.0678230775723812, 'support': 41080}, '2': {'precision': 0.3415860576000877, 'recall': 0.5916652822934713, 'f1-score': 0.4331193592939726, 'support': 42137}, 'accuracy': 0.3398495030381071, 'macro avg': {'precision': 0.3151036765755462, 'recall': 0.3377042161368348, 'f1-score': 0.2886101335599622, 'support': 124255}, 'weighted avg': {'precision': 0.31531750723575014, 'recall': 0.3398495030381071, 'f1-score': 0.28981364716287716, 'support': 124255}}
[[15690  2200 23148]
 [14566  1607 24907]
 [14705  2501 24931]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1104679
{'0': {'precision': 0.3303117116346688, 'recall': 0.5259753523524205, 'f1-score': 0.4057887272154226, 'support': 14687}, '1': {'precision': 0.36434977578475336, 'recall': 0.021241830065359478, 'f1-score': 0.04014328063241107, 'support': 15300}, '2': {'precision': 0.33816675297773174, 'recall': 0.4624348161977725, 'f1-score': 0.39065644205144945, 'support': 15533}, 'accuracy': 0.3346441124780316, 'macro avg': {'precision': 0.3442760801323846, 'recall': 0.3365506662051842, 'f1-score': 0.27886281663309437, 'support': 45520}, 'weighted avg': {'precision': 0.3444328614298817, 'recall': 0.3346441124780316, 'f1-score': 0.27772578525206426, 'support': 45520}}
[[7725  286 6676]
 [7593  325 7382]
 [8069  281 7183]]
training model: results/CHTR/W0/deepLOB_L1/h200
Epoch 1/50
486/486 - 15s - loss: 3.3246 - accuracy200: 0.3616 - val_loss: 3.3300 - val_accuracy200: 0.3464 - 15s/epoch - 30ms/step
Epoch 2/50
486/486 - 14s - loss: 3.2944 - accuracy200: 0.3671 - val_loss: 3.3188 - val_accuracy200: 0.3380 - 14s/epoch - 28ms/step
Epoch 3/50
486/486 - 14s - loss: 3.2799 - accuracy200: 0.3724 - val_loss: 3.3287 - val_accuracy200: 0.3378 - 14s/epoch - 28ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2735 - accuracy200: 0.3720 - val_loss: 3.3195 - val_accuracy200: 0.3409 - 12s/epoch - 26ms/step
Epoch 5/50
486/486 - 13s - loss: 3.2675 - accuracy200: 0.3768 - val_loss: 3.3471 - val_accuracy200: 0.3338 - 13s/epoch - 26ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2622 - accuracy200: 0.3808 - val_loss: 3.3241 - val_accuracy200: 0.3374 - 12s/epoch - 25ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2570 - accuracy200: 0.3819 - val_loss: 3.3443 - val_accuracy200: 0.3346 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2562 - accuracy200: 0.3849 - val_loss: 3.3388 - val_accuracy200: 0.3342 - 12s/epoch - 26ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2532 - accuracy200: 0.3871 - val_loss: 3.3370 - val_accuracy200: 0.3355 - 12s/epoch - 26ms/step
Epoch 10/50
486/486 - 13s - loss: 3.2481 - accuracy200: 0.3925 - val_loss: 3.3862 - val_accuracy200: 0.3340 - 13s/epoch - 26ms/step
Epoch 11/50
486/486 - 13s - loss: 3.2479 - accuracy200: 0.3922 - val_loss: 3.4046 - val_accuracy200: 0.3344 - 13s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2455 - accuracy200: 0.3946 - val_loss: 3.3958 - val_accuracy200: 0.3335 - 12s/epoch - 25ms/step
testing model: results/CHTR/W0/deepLOB_L1/h200
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109633
{'0': {'precision': 0.3054900880495445, 'recall': 0.29335632476706475, 'f1-score': 0.2993002798880448, 'support': 102067}, '1': {'precision': 0.3879607939834792, 'recall': 0.10808652417713584, 'f1-score': 0.16906989395353836, 'support': 116453}, '2': {'precision': 0.3238637825708801, 'recall': 0.5923063890666767, 'f1-score': 0.4187575486356725, 'support': 106244}, 'accuracy': 0.32472195194048603, 'macro avg': {'precision': 0.33910488820130125, 'recall': 0.3312497460036257, 'f1-score': 0.2957092408257519, 'support': 324764}, 'weighted avg': {'precision': 0.3410730218687156, 'recall': 0.32472195194048603, 'f1-score': 0.2916821292543289, 'support': 324764}}
[[29942  9689 62436]
 [34924 12587 68942]
 [33147 10168 62929]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.109772
{'0': {'precision': 0.35381327634566584, 'recall': 0.2577161619846771, 'f1-score': 0.2982142605856775, 'support': 41115}, '1': {'precision': 0.2880535383739143, 'recall': 0.09882513861410322, 'f1-score': 0.14716205648607852, 'support': 40941}, '2': {'precision': 0.3398911052690597, 'recall': 0.6464608166070286, 'f1-score': 0.44553323534215256, 'support': 42199}, 'accuracy': 0.33738682547986, 'macro avg': {'precision': 0.32725263999621323, 'recall': 0.334334039068603, 'f1-score': 0.29696985080463617, 'support': 124255}, 'weighted avg': {'precision': 0.32741779021180256, 'recall': 0.33738682547986, 'f1-score': 0.2984756997849597, 'support': 124255}}
[[10596  4771 25748]
 [ 9662  4046 27233]
 [ 9690  5229 27280]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057606
{'0': {'precision': 0.32538705707067433, 'recall': 0.3433356117566644, 'f1-score': 0.33412046429640474, 'support': 14630}, '1': {'precision': 0.3434640522875817, 'recall': 0.07031981801150809, 'f1-score': 0.11673886482283682, 'support': 14946}, '2': {'precision': 0.34770380786737226, 'recall': 0.5893125940792775, 'f1-score': 0.4373589033444271, 'support': 15944}, 'accuracy': 0.3398506151142355, 'macro avg': {'precision': 0.33885163907520943, 'recall': 0.3343226746158166, 'f1-score': 0.29607274415455626, 'support': 45520}, 'weighted avg': {'precision': 0.3391391889954206, 'recall': 0.3398506151142355, 'f1-score': 0.29890623508835823, 'support': 45520}}
[[5023  972 8635]
 [4903 1051 8992]
 [5511 1037 9396]]
training model: results/CHTR/W0/deepLOB_L1/h300
Epoch 1/50
486/486 - 15s - loss: 3.3195 - accuracy300: 0.3669 - val_loss: 3.3869 - val_accuracy300: 0.3329 - 15s/epoch - 30ms/step
Epoch 2/50
486/486 - 13s - loss: 3.2932 - accuracy300: 0.3717 - val_loss: 3.3387 - val_accuracy300: 0.3349 - 13s/epoch - 26ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2831 - accuracy300: 0.3716 - val_loss: 3.3323 - val_accuracy300: 0.3331 - 13s/epoch - 26ms/step
Epoch 4/50
486/486 - 13s - loss: 3.2770 - accuracy300: 0.3737 - val_loss: 3.3404 - val_accuracy300: 0.3368 - 13s/epoch - 26ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2691 - accuracy300: 0.3791 - val_loss: 3.3581 - val_accuracy300: 0.3384 - 12s/epoch - 26ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2644 - accuracy300: 0.3826 - val_loss: 3.3611 - val_accuracy300: 0.3378 - 12s/epoch - 25ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2599 - accuracy300: 0.3842 - val_loss: 3.3753 - val_accuracy300: 0.3352 - 12s/epoch - 25ms/step
Epoch 8/50
486/486 - 13s - loss: 3.2570 - accuracy300: 0.3873 - val_loss: 3.3937 - val_accuracy300: 0.3355 - 13s/epoch - 26ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2520 - accuracy300: 0.3896 - val_loss: 3.3810 - val_accuracy300: 0.3366 - 12s/epoch - 25ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2492 - accuracy300: 0.3915 - val_loss: 3.4064 - val_accuracy300: 0.3371 - 12s/epoch - 25ms/step
Epoch 11/50
486/486 - 13s - loss: 3.2465 - accuracy300: 0.3936 - val_loss: 3.3934 - val_accuracy300: 0.3379 - 13s/epoch - 26ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2428 - accuracy300: 0.3962 - val_loss: 3.4098 - val_accuracy300: 0.3373 - 12s/epoch - 25ms/step
Epoch 13/50
486/486 - 12s - loss: 3.2431 - accuracy300: 0.3951 - val_loss: 3.4146 - val_accuracy300: 0.3386 - 12s/epoch - 25ms/step
testing model: results/CHTR/W0/deepLOB_L1/h300
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1159182
{'0': {'precision': 0.3362396863479431, 'recall': 0.17078994560640437, 'f1-score': 0.22652071643516997, 'support': 100931}, '1': {'precision': 0.3544465770953295, 'recall': 0.0520961564765422, 'f1-score': 0.09084065618734583, 'support': 116976}, '2': {'precision': 0.32259738435607715, 'recall': 0.773772424829445, 'f1-score': 0.45535175858641214, 'support': 106857}, 'accuracy': 0.3264370435146753, 'macro avg': {'precision': 0.33776121593311664, 'recall': 0.33221950897079716, 'f1-score': 0.2575710437363093, 'support': 324764}, 'weighted avg': {'precision': 0.3383088620820807, 'recall': 0.3264370435146753, 'f1-score': 0.25294263494709185, 'support': 324764}}
[[17238  5542 78151]
 [15412  6094 95470]
 [18617  5557 82683]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1053873
{'0': {'precision': 0.3597206479213134, 'recall': 0.23867633858172202, 'f1-score': 0.28695601446739005, 'support': 41219}, '1': {'precision': 0.34415735567970207, 'recall': 0.07208327239042465, 'f1-score': 0.11920022574273391, 'support': 41022}, '2': {'precision': 0.34692121294472, 'recall': 0.7292331127719331, 'f1-score': 0.47016757718985946, 'support': 42014}, 'accuracy': 0.34954730191943983, 'macro avg': {'precision': 0.3502664055152452, 'recall': 0.3466642412480266, 'f1-score': 0.29210793913332783, 'support': 124255}, 'weighted avg': {'precision': 0.35025468811734595, 'recall': 0.34954730191943983, 'f1-score': 0.2935213247660419, 'support': 124255}}
[[ 9838  2839 28542]
 [ 8931  2957 29134]
 [ 8580  2796 30638]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1101286
{'0': {'precision': 0.3297106109324759, 'recall': 0.3497271487039563, 'f1-score': 0.33942403177755703, 'support': 14660}, '1': {'precision': 0.35344827586206895, 'recall': 0.06077348066298342, 'f1-score': 0.10371392434172702, 'support': 14842}, '2': {'precision': 0.34094390546356407, 'recall': 0.5835934573604695, 'f1-score': 0.4304263744359517, 'support': 16018}, 'accuracy': 0.33780755711775046, 'macro avg': {'precision': 0.3413675974193697, 'recall': 0.3313646955758031, 'f1-score': 0.2911881101850786, 'support': 45520}, 'weighted avg': {'precision': 0.3414032588824757, 'recall': 0.33780755711775046, 'f1-score': 0.29459244368747745, 'support': 45520}}
[[5127  791 8742]
 [4612  902 9328]
 [5811  859 9348]]
training model: results/CHTR/W0/deepLOB_L1/h500
Epoch 1/50
486/486 - 15s - loss: 3.3103 - accuracy500: 0.3737 - val_loss: 3.3504 - val_accuracy500: 0.3298 - 15s/epoch - 32ms/step
Epoch 2/50
486/486 - 12s - loss: 3.2856 - accuracy500: 0.3798 - val_loss: 3.3580 - val_accuracy500: 0.3322 - 12s/epoch - 25ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2687 - accuracy500: 0.3856 - val_loss: 3.3599 - val_accuracy500: 0.3293 - 12s/epoch - 25ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2634 - accuracy500: 0.3863 - val_loss: 3.3690 - val_accuracy500: 0.3362 - 12s/epoch - 24ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2536 - accuracy500: 0.3885 - val_loss: 3.3937 - val_accuracy500: 0.3348 - 12s/epoch - 25ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2494 - accuracy500: 0.3943 - val_loss: 3.3697 - val_accuracy500: 0.3363 - 12s/epoch - 26ms/step
Epoch 7/50
486/486 - 13s - loss: 3.2383 - accuracy500: 0.3985 - val_loss: 3.4543 - val_accuracy500: 0.3362 - 13s/epoch - 26ms/step
Epoch 8/50
486/486 - 13s - loss: 3.2304 - accuracy500: 0.4026 - val_loss: 3.5371 - val_accuracy500: 0.3352 - 13s/epoch - 26ms/step
Epoch 9/50
486/486 - 13s - loss: 3.2280 - accuracy500: 0.4044 - val_loss: 3.4872 - val_accuracy500: 0.3391 - 13s/epoch - 26ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2185 - accuracy500: 0.4105 - val_loss: 3.5185 - val_accuracy500: 0.3347 - 12s/epoch - 25ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2151 - accuracy500: 0.4115 - val_loss: 3.5650 - val_accuracy500: 0.3365 - 12s/epoch - 25ms/step
testing model: results/CHTR/W0/deepLOB_L1/h500
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1158977
{'0': {'precision': 0.32382272706945125, 'recall': 0.2881244653124565, 'f1-score': 0.3049323577406959, 'support': 100526}, '1': {'precision': 0.3692354600198186, 'recall': 0.12344965850011894, 'f1-score': 0.185034983733678, 'support': 117716}, '2': {'precision': 0.323948908722565, 'recall': 0.5959520099134451, 'f1-score': 0.4197365158602906, 'support': 106522}, 'accuracy': 0.3294022736510204, 'macro avg': {'precision': 0.3390023652706116, 'recall': 0.3358420445753401, 'f1-score': 0.30323461911155486, 'support': 324764}, 'weighted avg': {'precision': 0.34032469894453105, 'recall': 0.3294022736510204, 'f1-score': 0.29912915680895885, 'support': 324764}}
[[28964 11218 60344]
 [31047 14532 72137]
 [29433 13607 63482]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1186076
{'0': {'precision': 0.34891838317676466, 'recall': 0.38969101934738665, 'f1-score': 0.3681793379410695, 'support': 41556}, '1': {'precision': 0.3174946004319654, 'recall': 0.10029484149223909, 'f1-score': 0.1524359757791234, 'support': 41039}, '2': {'precision': 0.35062192697174743, 'recall': 0.5460393662986078, 'f1-score': 0.4270361088427712, 'support': 41660}, 'accuracy': 0.3465293147157056, 'macro avg': {'precision': 0.33901163686015917, 'recall': 0.3453417423794112, 'f1-score': 0.31588380752098805, 'support': 124255}, 'weighted avg': {'precision': 0.3391108825887414, 'recall': 0.3465293147157056, 'f1-score': 0.3166569141834806, 'support': 124255}}
[[16194  4336 21026]
 [15818  4116 21105]
 [14400  4512 22748]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1162578
{'0': {'precision': 0.326020206022187, 'recall': 0.45522439665306685, 'f1-score': 0.3799382448850027, 'support': 14461}, '1': {'precision': 0.34335487496487777, 'recall': 0.08079873049457816, 'f1-score': 0.1308141090831237, 'support': 15124}, '2': {'precision': 0.3410813542193027, 'recall': 0.4659554439912143, 'f1-score': 0.3938574156588161, 'support': 15935}, 'accuracy': 0.33457820738137084, 'macro avg': {'precision': 0.3368188117354558, 'recall': 0.33399285704628645, 'f1-score': 0.3015365898756475, 'support': 45520}, 'weighted avg': {'precision': 0.33705203663752736, 'recall': 0.33457820738137084, 'f1-score': 0.30203948733696007, 'support': 45520}}
[[6583 1103 6775]
 [6333 1222 7569]
 [7276 1234 7425]]
training model: results/CHTR/W0/deepLOB_L1/h1000
Epoch 1/50
486/486 - 16s - loss: 3.3085 - accuracy1000: 0.3818 - val_loss: 3.4055 - val_accuracy1000: 0.3123 - 16s/epoch - 32ms/step
Epoch 2/50
486/486 - 13s - loss: 3.2669 - accuracy1000: 0.3933 - val_loss: 3.4230 - val_accuracy1000: 0.3319 - 13s/epoch - 26ms/step
Epoch 3/50
486/486 - 13s - loss: 3.2405 - accuracy1000: 0.4057 - val_loss: 3.4013 - val_accuracy1000: 0.3329 - 13s/epoch - 26ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2176 - accuracy1000: 0.4140 - val_loss: 3.4281 - val_accuracy1000: 0.3310 - 12s/epoch - 25ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2108 - accuracy1000: 0.4196 - val_loss: 3.4310 - val_accuracy1000: 0.3322 - 12s/epoch - 25ms/step
Epoch 6/50
486/486 - 13s - loss: 3.2025 - accuracy1000: 0.4214 - val_loss: 3.4438 - val_accuracy1000: 0.3328 - 13s/epoch - 28ms/step
Epoch 7/50
486/486 - 14s - loss: 3.1859 - accuracy1000: 0.4266 - val_loss: 3.4806 - val_accuracy1000: 0.3336 - 14s/epoch - 28ms/step
Epoch 8/50
486/486 - 13s - loss: 3.1735 - accuracy1000: 0.4326 - val_loss: 3.4927 - val_accuracy1000: 0.3340 - 13s/epoch - 27ms/step
Epoch 9/50
486/486 - 14s - loss: 3.1604 - accuracy1000: 0.4388 - val_loss: 3.5093 - val_accuracy1000: 0.3313 - 14s/epoch - 29ms/step
Epoch 10/50
486/486 - 13s - loss: 3.1533 - accuracy1000: 0.4420 - val_loss: 3.5162 - val_accuracy1000: 0.3345 - 13s/epoch - 26ms/step
Epoch 11/50
486/486 - 13s - loss: 3.1414 - accuracy1000: 0.4454 - val_loss: 3.5379 - val_accuracy1000: 0.3367 - 13s/epoch - 26ms/step
Epoch 12/50
486/486 - 13s - loss: 3.1319 - accuracy1000: 0.4522 - val_loss: 3.5336 - val_accuracy1000: 0.3344 - 13s/epoch - 26ms/step
Epoch 13/50
486/486 - 13s - loss: 3.1315 - accuracy1000: 0.4521 - val_loss: 3.4962 - val_accuracy1000: 0.3313 - 13s/epoch - 26ms/step
testing model: results/CHTR/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1408511
{'0': {'precision': 0.29030305013745256, 'recall': 0.18265587678115477, 'f1-score': 0.2242290192113246, 'support': 97128}, '1': {'precision': 0.34730094466936573, 'recall': 0.04104334789958853, 'f1-score': 0.07341111364673665, 'support': 125404}, '2': {'precision': 0.2951147762345679, 'recall': 0.7183073792941544, 'f1-score': 0.41835106989039034, 'support': 102232}, 'accuracy': 0.2965907551329581, 'macro avg': {'precision': 0.31090625701379543, 'recall': 0.3140022013249659, 'f1-score': 0.23866373424948387, 'support': 324764}, 'weighted avg': {'precision': 0.3138268284756931, 'recall': 0.2965907551329581, 'f1-score': 0.22709977106682788, 'support': 324764}}
[[ 17741   4439  74948]
 [ 19807   5147 100450]
 [ 23564   5234  73434]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1110551
{'0': {'precision': 0.37845648604269294, 'recall': 0.2771258176221624, 'f1-score': 0.31996001887997333, 'support': 41584}, '1': {'precision': 0.27823315118397085, 'recall': 0.05953714981729598, 'f1-score': 0.09808564433920616, 'support': 41050}, '2': {'precision': 0.3487020853671446, 'recall': 0.7123086903245958, 'f1-score': 0.4682017024367903, 'support': 41621}, 'accuracy': 0.35101203170898554, 'macro avg': {'precision': 0.33513057419793607, 'recall': 0.34965721925468474, 'f1-score': 0.2954157885519899, 'support': 124255}, 'weighted avg': {'precision': 0.33537913860019536, 'recall': 0.35101203170898554, 'f1-score': 0.2963152885787362, 'support': 124255}}
[[11524  3381 26679]
 [ 9911  2444 28695]
 [ 9015  2959 29647]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1336596
{'0': {'precision': 0.3279216331004247, 'recall': 0.3404936339711217, 'f1-score': 0.3340894022402903, 'support': 14059}, '1': {'precision': 0.2857142857142857, 'recall': 0.052006710543295906, 'f1-score': 0.08799606965445711, 'support': 15498}, '2': {'precision': 0.34002348670865806, 'recall': 0.5985716970494268, 'f1-score': 0.4336873638344227, 'support': 15963}, 'accuracy': 0.3327768014059754, 'macro avg': {'precision': 0.3178864685077895, 'recall': 0.3303573471879481, 'f1-score': 0.2852576119097234, 'support': 45520}, 'weighted avg': {'precision': 0.31779536814782916, 'recall': 0.3327768014059754, 'f1-score': 0.28523017096858316, 'support': 45520}}
[[ 4787   862  8410]
 [ 4556   806 10136]
 [ 5255  1153  9555]]
training model: results/CHTR/W0/deepOF_L1/h10
Epoch 1/50
486/486 - 14s - loss: 3.2844 - accuracy10: 0.3834 - val_loss: 3.2910 - val_accuracy10: 0.3745 - 14s/epoch - 29ms/step
Epoch 2/50
486/486 - 12s - loss: 3.2481 - accuracy10: 0.3992 - val_loss: 3.2859 - val_accuracy10: 0.3804 - 12s/epoch - 24ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2342 - accuracy10: 0.4061 - val_loss: 3.2755 - val_accuracy10: 0.3890 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 11s - loss: 3.2239 - accuracy10: 0.4130 - val_loss: 3.2643 - val_accuracy10: 0.3960 - 11s/epoch - 23ms/step
Epoch 5/50
486/486 - 11s - loss: 3.2160 - accuracy10: 0.4172 - val_loss: 3.2637 - val_accuracy10: 0.3963 - 11s/epoch - 23ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2084 - accuracy10: 0.4204 - val_loss: 3.2614 - val_accuracy10: 0.3983 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 11s - loss: 3.2021 - accuracy10: 0.4232 - val_loss: 3.2667 - val_accuracy10: 0.3926 - 11s/epoch - 24ms/step
Epoch 8/50
486/486 - 11s - loss: 3.1952 - accuracy10: 0.4253 - val_loss: 3.2540 - val_accuracy10: 0.3996 - 11s/epoch - 24ms/step
Epoch 9/50
486/486 - 11s - loss: 3.1900 - accuracy10: 0.4284 - val_loss: 3.2537 - val_accuracy10: 0.4043 - 11s/epoch - 24ms/step
Epoch 10/50
486/486 - 11s - loss: 3.1865 - accuracy10: 0.4315 - val_loss: 3.2559 - val_accuracy10: 0.3987 - 11s/epoch - 23ms/step
Epoch 11/50
486/486 - 11s - loss: 3.1816 - accuracy10: 0.4326 - val_loss: 3.2576 - val_accuracy10: 0.3990 - 11s/epoch - 23ms/step
Epoch 12/50
486/486 - 11s - loss: 3.1763 - accuracy10: 0.4368 - val_loss: 3.2609 - val_accuracy10: 0.3958 - 11s/epoch - 23ms/step
Epoch 13/50
486/486 - 11s - loss: 3.1744 - accuracy10: 0.4360 - val_loss: 3.2565 - val_accuracy10: 0.3991 - 11s/epoch - 23ms/step
Epoch 14/50
486/486 - 11s - loss: 3.1705 - accuracy10: 0.4376 - val_loss: 3.2565 - val_accuracy10: 0.4002 - 11s/epoch - 23ms/step
Epoch 15/50
486/486 - 11s - loss: 3.1670 - accuracy10: 0.4396 - val_loss: 3.2512 - val_accuracy10: 0.4032 - 11s/epoch - 24ms/step
Epoch 16/50
486/486 - 11s - loss: 3.1650 - accuracy10: 0.4398 - val_loss: 3.2507 - val_accuracy10: 0.4057 - 11s/epoch - 24ms/step
Epoch 17/50
486/486 - 12s - loss: 3.1604 - accuracy10: 0.4427 - val_loss: 3.2467 - val_accuracy10: 0.4075 - 12s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 3.1581 - accuracy10: 0.4432 - val_loss: 3.2489 - val_accuracy10: 0.4051 - 12s/epoch - 24ms/step
Epoch 19/50
486/486 - 12s - loss: 3.1551 - accuracy10: 0.4442 - val_loss: 3.2497 - val_accuracy10: 0.4047 - 12s/epoch - 24ms/step
Epoch 20/50
486/486 - 12s - loss: 3.1509 - accuracy10: 0.4456 - val_loss: 3.2487 - val_accuracy10: 0.4049 - 12s/epoch - 24ms/step
Epoch 21/50
486/486 - 11s - loss: 3.1496 - accuracy10: 0.4473 - val_loss: 3.2429 - val_accuracy10: 0.4091 - 11s/epoch - 23ms/step
Epoch 22/50
486/486 - 12s - loss: 3.1481 - accuracy10: 0.4487 - val_loss: 3.2424 - val_accuracy10: 0.4118 - 12s/epoch - 24ms/step
Epoch 23/50
486/486 - 11s - loss: 3.1447 - accuracy10: 0.4483 - val_loss: 3.2450 - val_accuracy10: 0.4082 - 11s/epoch - 23ms/step
Epoch 24/50
486/486 - 12s - loss: 3.1407 - accuracy10: 0.4506 - val_loss: 3.2455 - val_accuracy10: 0.4111 - 12s/epoch - 24ms/step
Epoch 25/50
486/486 - 12s - loss: 3.1384 - accuracy10: 0.4509 - val_loss: 3.2485 - val_accuracy10: 0.4081 - 12s/epoch - 25ms/step
Epoch 26/50
486/486 - 12s - loss: 3.1356 - accuracy10: 0.4536 - val_loss: 3.2503 - val_accuracy10: 0.4056 - 12s/epoch - 24ms/step
Epoch 27/50
486/486 - 12s - loss: 3.1338 - accuracy10: 0.4539 - val_loss: 3.2541 - val_accuracy10: 0.4062 - 12s/epoch - 24ms/step
Epoch 28/50
486/486 - 11s - loss: 3.1284 - accuracy10: 0.4565 - val_loss: 3.2469 - val_accuracy10: 0.4101 - 11s/epoch - 23ms/step
Epoch 29/50
486/486 - 11s - loss: 3.1276 - accuracy10: 0.4568 - val_loss: 3.2443 - val_accuracy10: 0.4095 - 11s/epoch - 22ms/step
Epoch 30/50
486/486 - 12s - loss: 3.1240 - accuracy10: 0.4578 - val_loss: 3.2519 - val_accuracy10: 0.4081 - 12s/epoch - 24ms/step
Epoch 31/50
486/486 - 11s - loss: 3.1212 - accuracy10: 0.4594 - val_loss: 3.2434 - val_accuracy10: 0.4098 - 11s/epoch - 24ms/step
Epoch 32/50
486/486 - 11s - loss: 3.1181 - accuracy10: 0.4606 - val_loss: 3.2472 - val_accuracy10: 0.4112 - 11s/epoch - 24ms/step
testing model: results/CHTR/W0/deepOF_L1/h10
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0783292
{'0': {'precision': 0.40497469306577255, 'recall': 0.5633190870559861, 'f1-score': 0.47119991692996904, 'support': 112778}, '1': {'precision': 0.4112961622013034, 'recall': 0.27527545348446186, 'f1-score': 0.3298118797215227, 'support': 101106}, '2': {'precision': 0.4234453580266624, 'recall': 0.38273731679819617, 'f1-score': 0.4020635650027713, 'support': 110875}, 'accuracy': 0.4119916615089959, 'macro avg': {'precision': 0.4132387377645794, 'recall': 0.40711061911288143, 'f1-score': 0.40102512055142103, 'support': 324759}, 'weighted avg': {'precision': 0.41324874685937224, 'recall': 0.4119916615089959, 'f1-score': 0.4035784748454534, 'support': 324759}}
[[63530 19828 29420]
 [44914 27832 28360]
 [48430 20009 42436]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0639597
{'0': {'precision': 0.4085243553008596, 'recall': 0.5530852224512062, 'f1-score': 0.4699387134984807, 'support': 41245}, '1': {'precision': 0.4919736041559414, 'recall': 0.2556482404727741, 'f1-score': 0.3364593668981852, 'support': 41119}, '2': {'precision': 0.4166471826046294, 'recall': 0.4679398424444975, 'f1-score': 0.4408064135286776, 'support': 41890}, 'accuracy': 0.4259500700178666, 'macro avg': {'precision': 0.43904838068714347, 'recall': 0.4255577684561593, 'f1-score': 0.41573483130844785, 'support': 124254}, 'weighted avg': {'precision': 0.4388784275997556, 'recall': 0.4259500700178666, 'f1-score': 0.41594536681674327, 'support': 124254}}
[[22812  5334 13099]
 [16261 10512 14346]
 [16767  5521 19602]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0812414
{'0': {'precision': 0.38661179698216736, 'recall': 0.4771772992008669, 'f1-score': 0.4271467976114698, 'support': 14766}, '1': {'precision': 0.46914660831509847, 'recall': 0.2159983880717308, 'f1-score': 0.2958057395143488, 'support': 14889}, '2': {'precision': 0.40554821664464996, 'recall': 0.5225037821482602, 'f1-score': 0.4566564746715148, 'support': 15864}, 'accuracy': 0.4075441024627079, 'macro avg': {'precision': 0.42043554064730526, 'recall': 0.40522648980695264, 'f1-score': 0.3932030039324445, 'support': 45519}, 'weighted avg': {'precision': 0.42020805716937787, 'recall': 0.4075441024627079, 'f1-score': 0.39447043176144053, 'support': 45519}}
[[7046 1826 5894]
 [5417 3216 6256]
 [5762 1813 8289]]
training model: results/CHTR/W0/deepOF_L1/h20
Epoch 1/50
486/486 - 13s - loss: 3.2925 - accuracy20: 0.3751 - val_loss: 3.3143 - val_accuracy20: 0.3681 - 13s/epoch - 27ms/step
Epoch 2/50
486/486 - 11s - loss: 3.2642 - accuracy20: 0.3887 - val_loss: 3.3004 - val_accuracy20: 0.3770 - 11s/epoch - 23ms/step
Epoch 3/50
486/486 - 11s - loss: 3.2475 - accuracy20: 0.3987 - val_loss: 3.2859 - val_accuracy20: 0.3884 - 11s/epoch - 23ms/step
Epoch 4/50
486/486 - 11s - loss: 3.2389 - accuracy20: 0.4029 - val_loss: 3.2790 - val_accuracy20: 0.3921 - 11s/epoch - 23ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2327 - accuracy20: 0.4070 - val_loss: 3.2704 - val_accuracy20: 0.3950 - 12s/epoch - 24ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2248 - accuracy20: 0.4102 - val_loss: 3.2732 - val_accuracy20: 0.3972 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2200 - accuracy20: 0.4123 - val_loss: 3.2650 - val_accuracy20: 0.3997 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2137 - accuracy20: 0.4160 - val_loss: 3.2659 - val_accuracy20: 0.3956 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2097 - accuracy20: 0.4181 - val_loss: 3.2618 - val_accuracy20: 0.4012 - 12s/epoch - 24ms/step
Epoch 10/50
486/486 - 11s - loss: 3.2065 - accuracy20: 0.4176 - val_loss: 3.2621 - val_accuracy20: 0.3951 - 11s/epoch - 23ms/step
Epoch 11/50
486/486 - 11s - loss: 3.2020 - accuracy20: 0.4198 - val_loss: 3.2606 - val_accuracy20: 0.3998 - 11s/epoch - 24ms/step
Epoch 12/50
486/486 - 12s - loss: 3.1978 - accuracy20: 0.4243 - val_loss: 3.2586 - val_accuracy20: 0.4005 - 12s/epoch - 24ms/step
Epoch 13/50
486/486 - 11s - loss: 3.1941 - accuracy20: 0.4244 - val_loss: 3.2594 - val_accuracy20: 0.3998 - 11s/epoch - 23ms/step
Epoch 14/50
486/486 - 12s - loss: 3.1919 - accuracy20: 0.4256 - val_loss: 3.2523 - val_accuracy20: 0.4029 - 12s/epoch - 24ms/step
Epoch 15/50
486/486 - 11s - loss: 3.1903 - accuracy20: 0.4271 - val_loss: 3.2564 - val_accuracy20: 0.4026 - 11s/epoch - 23ms/step
Epoch 16/50
486/486 - 12s - loss: 3.1866 - accuracy20: 0.4285 - val_loss: 3.2607 - val_accuracy20: 0.3989 - 12s/epoch - 24ms/step
Epoch 17/50
486/486 - 11s - loss: 3.1832 - accuracy20: 0.4299 - val_loss: 3.2591 - val_accuracy20: 0.3992 - 11s/epoch - 23ms/step
Epoch 18/50
486/486 - 11s - loss: 3.1802 - accuracy20: 0.4310 - val_loss: 3.2571 - val_accuracy20: 0.4027 - 11s/epoch - 24ms/step
Epoch 19/50
486/486 - 12s - loss: 3.1779 - accuracy20: 0.4316 - val_loss: 3.2552 - val_accuracy20: 0.4020 - 12s/epoch - 24ms/step
Epoch 20/50
486/486 - 11s - loss: 3.1750 - accuracy20: 0.4342 - val_loss: 3.2588 - val_accuracy20: 0.4012 - 11s/epoch - 23ms/step
Epoch 21/50
486/486 - 11s - loss: 3.1715 - accuracy20: 0.4352 - val_loss: 3.2580 - val_accuracy20: 0.4020 - 11s/epoch - 23ms/step
Epoch 22/50
486/486 - 11s - loss: 3.1709 - accuracy20: 0.4356 - val_loss: 3.2573 - val_accuracy20: 0.4003 - 11s/epoch - 23ms/step
Epoch 23/50
486/486 - 12s - loss: 3.1673 - accuracy20: 0.4372 - val_loss: 3.2543 - val_accuracy20: 0.4045 - 12s/epoch - 24ms/step
Epoch 24/50
486/486 - 11s - loss: 3.1659 - accuracy20: 0.4390 - val_loss: 3.2590 - val_accuracy20: 0.4027 - 11s/epoch - 23ms/step
testing model: results/CHTR/W0/deepOF_L1/h20
Evaluating performance on  test set...
1269/1269 - 21s - 21s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0800581
{'0': {'precision': 0.397407322626893, 'recall': 0.5842055859589466, 'f1-score': 0.4730328538855348, 'support': 112926}, '1': {'precision': 0.4014787503186962, 'recall': 0.2042402474309089, 'f1-score': 0.2707464009152289, 'support': 100230}, '2': {'precision': 0.4212909691548198, 'recall': 0.4067991003826062, 'f1-score': 0.41391822835704545, 'support': 111603}, 'accuracy': 0.40597181294436796, 'macro avg': {'precision': 0.4067256807001363, 'recall': 0.39841497792415387, 'f1-score': 0.385899161052603, 'support': 324759}, 'weighted avg': {'precision': 0.40687146619491, 'recall': 0.40597181294436796, 'f1-score': 0.390286753749527, 'support': 324759}}
[[65972 15051 31903]
 [49298 20471 30461]
 [50736 15467 45400]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0735763
{'0': {'precision': 0.39362451264964016, 'recall': 0.5553051779700031, 'f1-score': 0.46069109695056987, 'support': 41271}, '1': {'precision': 0.4868694747789912, 'recall': 0.18169027750824762, 'f1-score': 0.2646269078575466, 'support': 41224}, '2': {'precision': 0.40685529251485775, 'recall': 0.4934505136617256, 'f1-score': 0.4459883557344761, 'support': 41759}, 'accuracy': 0.41056223542099246, 'macro avg': {'precision': 0.42911642664782973, 'recall': 0.4101486563799921, 'f1-score': 0.39043545351419756, 'support': 124254}, 'weighted avg': {'precision': 0.42900715188227645, 'recall': 0.41056223542099246, 'f1-score': 0.39070122216494, 'support': 124254}}
[[22918  3893 14460]
 [18153  7490 15581]
 [17152  4001 20606]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0841323
{'0': {'precision': 0.3872554377527599, 'recall': 0.4757620518329529, 'f1-score': 0.42697035430224156, 'support': 14894}, '1': {'precision': 0.4726377952755906, 'recall': 0.16023758675920982, 'f1-score': 0.23933413078149918, 'support': 14984}, '2': {'precision': 0.3945621245652861, 'recall': 0.5585320631673166, 'f1-score': 0.4624424329045577, 'support': 15641}, 'accuracy': 0.40033832026186866, 'macro avg': {'precision': 0.41815178586454554, 'recall': 0.39817723391982646, 'f1-score': 0.3762489726627662, 'support': 45519}, 'weighted avg': {'precision': 0.4178723918500999, 'recall': 0.40033832026186866, 'f1-score': 0.37739276270717187, 'support': 45519}}
[[7086 1369 6439]
 [5617 2401 6966]
 [5595 1310 8736]]
training model: results/CHTR/W0/deepOF_L1/h30
Epoch 1/50
486/486 - 14s - loss: 3.2981 - accuracy30: 0.3712 - val_loss: 3.3173 - val_accuracy30: 0.3660 - 14s/epoch - 28ms/step
Epoch 2/50
486/486 - 12s - loss: 3.2713 - accuracy30: 0.3852 - val_loss: 3.3070 - val_accuracy30: 0.3741 - 12s/epoch - 25ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2567 - accuracy30: 0.3912 - val_loss: 3.3001 - val_accuracy30: 0.3851 - 12s/epoch - 25ms/step
Epoch 4/50
486/486 - 11s - loss: 3.2511 - accuracy30: 0.3961 - val_loss: 3.2949 - val_accuracy30: 0.3861 - 11s/epoch - 24ms/step
Epoch 5/50
486/486 - 11s - loss: 3.2470 - accuracy30: 0.3984 - val_loss: 3.2885 - val_accuracy30: 0.3859 - 11s/epoch - 23ms/step
Epoch 6/50
486/486 - 11s - loss: 3.2426 - accuracy30: 0.3993 - val_loss: 3.2876 - val_accuracy30: 0.3926 - 11s/epoch - 23ms/step
Epoch 7/50
486/486 - 11s - loss: 3.2379 - accuracy30: 0.4025 - val_loss: 3.2843 - val_accuracy30: 0.3937 - 11s/epoch - 23ms/step
Epoch 8/50
486/486 - 11s - loss: 3.2324 - accuracy30: 0.4054 - val_loss: 3.2855 - val_accuracy30: 0.3916 - 11s/epoch - 23ms/step
Epoch 9/50
486/486 - 11s - loss: 3.2283 - accuracy30: 0.4083 - val_loss: 3.2847 - val_accuracy30: 0.3916 - 11s/epoch - 23ms/step
Epoch 10/50
486/486 - 11s - loss: 3.2260 - accuracy30: 0.4086 - val_loss: 3.2835 - val_accuracy30: 0.3900 - 11s/epoch - 24ms/step
Epoch 11/50
486/486 - 11s - loss: 3.2236 - accuracy30: 0.4095 - val_loss: 3.2831 - val_accuracy30: 0.3913 - 11s/epoch - 23ms/step
Epoch 12/50
486/486 - 11s - loss: 3.2194 - accuracy30: 0.4120 - val_loss: 3.2829 - val_accuracy30: 0.3924 - 11s/epoch - 23ms/step
Epoch 13/50
486/486 - 11s - loss: 3.2158 - accuracy30: 0.4129 - val_loss: 3.2805 - val_accuracy30: 0.3933 - 11s/epoch - 23ms/step
Epoch 14/50
486/486 - 12s - loss: 3.2135 - accuracy30: 0.4150 - val_loss: 3.2812 - val_accuracy30: 0.3932 - 12s/epoch - 24ms/step
Epoch 15/50
486/486 - 11s - loss: 3.2105 - accuracy30: 0.4178 - val_loss: 3.2795 - val_accuracy30: 0.3932 - 11s/epoch - 24ms/step
Epoch 16/50
486/486 - 11s - loss: 3.2077 - accuracy30: 0.4189 - val_loss: 3.2786 - val_accuracy30: 0.3935 - 11s/epoch - 23ms/step
Epoch 17/50
486/486 - 12s - loss: 3.2043 - accuracy30: 0.4195 - val_loss: 3.2789 - val_accuracy30: 0.3940 - 12s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 3.2020 - accuracy30: 0.4203 - val_loss: 3.2783 - val_accuracy30: 0.3938 - 12s/epoch - 24ms/step
Epoch 19/50
486/486 - 12s - loss: 3.2003 - accuracy30: 0.4215 - val_loss: 3.2801 - val_accuracy30: 0.3927 - 12s/epoch - 24ms/step
Epoch 20/50
486/486 - 11s - loss: 3.1972 - accuracy30: 0.4235 - val_loss: 3.2837 - val_accuracy30: 0.3915 - 11s/epoch - 23ms/step
Epoch 21/50
486/486 - 11s - loss: 3.1939 - accuracy30: 0.4250 - val_loss: 3.2847 - val_accuracy30: 0.3906 - 11s/epoch - 23ms/step
Epoch 22/50
486/486 - 11s - loss: 3.1928 - accuracy30: 0.4249 - val_loss: 3.2845 - val_accuracy30: 0.3941 - 11s/epoch - 23ms/step
Epoch 23/50
486/486 - 12s - loss: 3.1893 - accuracy30: 0.4270 - val_loss: 3.2880 - val_accuracy30: 0.3908 - 12s/epoch - 24ms/step
Epoch 24/50
486/486 - 12s - loss: 3.1857 - accuracy30: 0.4292 - val_loss: 3.2907 - val_accuracy30: 0.3923 - 12s/epoch - 24ms/step
Epoch 25/50
486/486 - 12s - loss: 3.1841 - accuracy30: 0.4286 - val_loss: 3.2895 - val_accuracy30: 0.3908 - 12s/epoch - 24ms/step
Epoch 26/50
486/486 - 12s - loss: 3.1795 - accuracy30: 0.4313 - val_loss: 3.2877 - val_accuracy30: 0.3945 - 12s/epoch - 24ms/step
Epoch 27/50
486/486 - 12s - loss: 3.1782 - accuracy30: 0.4340 - val_loss: 3.2909 - val_accuracy30: 0.3914 - 12s/epoch - 24ms/step
Epoch 28/50
486/486 - 11s - loss: 3.1766 - accuracy30: 0.4319 - val_loss: 3.2905 - val_accuracy30: 0.3908 - 11s/epoch - 24ms/step
testing model: results/CHTR/W0/deepOF_L1/h30
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0881331
{'0': {'precision': 0.38928360143110685, 'recall': 0.6236190338652611, 'f1-score': 0.4793445193338352, 'support': 110792}, '1': {'precision': 0.41288587773179025, 'recall': 0.14997893285325775, 'f1-score': 0.2200321717324267, 'support': 104428}, '2': {'precision': 0.4101480688854135, 'recall': 0.4094066953322561, 'f1-score': 0.40977704678362575, 'support': 109539}, 'accuracy': 0.3990651529287872, 'macro avg': {'precision': 0.4041058493494369, 'recall': 0.39433488735025835, 'f1-score': 0.36971791261662923, 'support': 324759}, 'weighted avg': {'precision': 0.4039104829340216, 'recall': 0.3990651529287872, 'f1-score': 0.3724966068479694, 'support': 324759}}
[[69092 10367 31333]
 [55604 15662 33162]
 [52789 11904 44846]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0804116
{'0': {'precision': 0.39229475370444533, 'recall': 0.5928248081531869, 'f1-score': 0.4721499219156689, 'support': 41309}, '1': {'precision': 0.4861656551231703, 'recall': 0.13235651455508576, 'f1-score': 0.20806753504717523, 'support': 41154}, '2': {'precision': 0.40600493827160494, 'recall': 0.4918283841018401, 'f1-score': 0.44481475069252074, 'support': 41791}, 'accuracy': 0.40634506736201653, 'macro avg': {'precision': 0.42815511569974013, 'recall': 0.40566990227003763, 'f1-score': 0.3750107358851216, 'support': 124254}, 'weighted avg': {'precision': 0.4279968268790101, 'recall': 0.40634506736201653, 'f1-score': 0.37548976860251543, 'support': 124254}}
[[24489  2809 14011]
 [19647  5447 16060]
 [18289  2948 20554]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916119
{'0': {'precision': 0.38668289467011513, 'recall': 0.5094541324246676, 'f1-score': 0.43965865190566794, 'support': 14967}, '1': {'precision': 0.48023348368267443, 'recall': 0.11992314317895714, 'f1-score': 0.19192026296257023, 'support': 15093}, '2': {'precision': 0.3872270891017203, 'recall': 0.5518468206222912, 'f1-score': 0.4551080288076821, 'support': 15459}, 'accuracy': 0.39469232628133305, 'macro avg': {'precision': 0.4180478224848366, 'recall': 0.39374136540863863, 'f1-score': 0.3622289812253068, 'support': 45519}, 'weighted avg': {'precision': 0.4178868258128191, 'recall': 0.39469232628133305, 'f1-score': 0.36276145322401987, 'support': 45519}}
[[7625  996 6346]
 [6129 1810 7154]
 [5965  963 8531]]
training model: results/CHTR/W0/deepOF_L1/h50
Epoch 1/50
486/486 - 13s - loss: 3.3057 - accuracy50: 0.3671 - val_loss: 3.3242 - val_accuracy50: 0.3591 - 13s/epoch - 27ms/step
Epoch 2/50
486/486 - 11s - loss: 3.2769 - accuracy50: 0.3808 - val_loss: 3.3127 - val_accuracy50: 0.3661 - 11s/epoch - 23ms/step
Epoch 3/50
486/486 - 11s - loss: 3.2637 - accuracy50: 0.3868 - val_loss: 3.3069 - val_accuracy50: 0.3756 - 11s/epoch - 24ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2570 - accuracy50: 0.3920 - val_loss: 3.3007 - val_accuracy50: 0.3828 - 12s/epoch - 24ms/step
Epoch 5/50
486/486 - 11s - loss: 3.2540 - accuracy50: 0.3940 - val_loss: 3.2987 - val_accuracy50: 0.3860 - 11s/epoch - 24ms/step
Epoch 6/50
486/486 - 11s - loss: 3.2501 - accuracy50: 0.3962 - val_loss: 3.2977 - val_accuracy50: 0.3872 - 11s/epoch - 24ms/step
Epoch 7/50
486/486 - 11s - loss: 3.2469 - accuracy50: 0.3987 - val_loss: 3.2984 - val_accuracy50: 0.3875 - 11s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2441 - accuracy50: 0.3984 - val_loss: 3.2941 - val_accuracy50: 0.3888 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2403 - accuracy50: 0.4004 - val_loss: 3.2967 - val_accuracy50: 0.3867 - 12s/epoch - 24ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2379 - accuracy50: 0.4027 - val_loss: 3.2956 - val_accuracy50: 0.3852 - 12s/epoch - 24ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2363 - accuracy50: 0.4019 - val_loss: 3.2971 - val_accuracy50: 0.3847 - 12s/epoch - 24ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2344 - accuracy50: 0.4037 - val_loss: 3.2941 - val_accuracy50: 0.3894 - 12s/epoch - 24ms/step
Epoch 13/50
486/486 - 11s - loss: 3.2312 - accuracy50: 0.4061 - val_loss: 3.2974 - val_accuracy50: 0.3876 - 11s/epoch - 22ms/step
Epoch 14/50
486/486 - 11s - loss: 3.2287 - accuracy50: 0.4060 - val_loss: 3.2972 - val_accuracy50: 0.3885 - 11s/epoch - 23ms/step
Epoch 15/50
486/486 - 11s - loss: 3.2276 - accuracy50: 0.4084 - val_loss: 3.2948 - val_accuracy50: 0.3893 - 11s/epoch - 23ms/step
Epoch 16/50
486/486 - 11s - loss: 3.2245 - accuracy50: 0.4086 - val_loss: 3.2988 - val_accuracy50: 0.3867 - 11s/epoch - 24ms/step
Epoch 17/50
486/486 - 11s - loss: 3.2222 - accuracy50: 0.4103 - val_loss: 3.2950 - val_accuracy50: 0.3888 - 11s/epoch - 23ms/step
Epoch 18/50
486/486 - 11s - loss: 3.2201 - accuracy50: 0.4114 - val_loss: 3.2974 - val_accuracy50: 0.3894 - 11s/epoch - 23ms/step
testing model: results/CHTR/W0/deepOF_L1/h50
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0953037
{'0': {'precision': 0.3839816387178943, 'recall': 0.5366622474806004, 'f1-score': 0.44766158188813493, 'support': 107863}, '1': {'precision': 0.3909602327837051, 'recall': 0.18389021697476232, 'f1-score': 0.25013031498994714, 'support': 109598}, '2': {'precision': 0.3939586957054313, 'recall': 0.4496169546496673, 'f1-score': 0.41995168766729774, 'support': 107298}, 'accuracy': 0.3888514252106947, 'macro avg': {'precision': 0.38963352240234356, 'recall': 0.39005647303501, 'f1-score': 0.3725811948484599, 'support': 324759}, 'weighted avg': {'precision': 0.3896330855232899, 'recall': 0.3888514252106947, 'f1-score': 0.3718445975409268, 'support': 324759}}
[[57886 15044 34933]
 [50163 20154 39281]
 [42703 16352 48243]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910443
{'0': {'precision': 0.3901700569273723, 'recall': 0.5207113476893298, 'f1-score': 0.44608655998673413, 'support': 41330}, '1': {'precision': 0.42139952320852614, 'recall': 0.14662112710417174, 'f1-score': 0.21754868602041555, 'support': 40990}, '2': {'precision': 0.39473684210526316, 'recall': 0.5161682644155101, 'f1-score': 0.447358630952381, 'support': 41934}, 'accuracy': 0.395769955091989, 'macro avg': {'precision': 0.4021021407470539, 'recall': 0.3945002464030039, 'f1-score': 0.3703312923198436, 'support': 124254}, 'weighted avg': {'precision': 0.4020135339382868, 'recall': 0.395769955091989, 'f1-score': 0.37112378671580554, 'support': 124254}}
[[21521  4155 15654]
 [17445  6010 17535]
 [16192  4097 21645]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0974814
{'0': {'precision': 0.3845800562604053, 'recall': 0.4492053912693623, 'f1-score': 0.4143882221947297, 'support': 14913}, '1': {'precision': 0.4215163934426229, 'recall': 0.1362341876945493, 'f1-score': 0.20591621202262375, 'support': 15099}, '2': {'precision': 0.3828165374677003, 'recall': 0.5732249951634746, 'f1-score': 0.4590595708420482, 'support': 15507}, 'accuracy': 0.38764032601770687, 'macro avg': {'precision': 0.3963043290569095, 'recall': 0.38622152470912874, 'f1-score': 0.35978800168646724, 'support': 45519}, 'weighted avg': {'precision': 0.3962313418597337, 'recall': 0.38764032601770687, 'f1-score': 0.36045469381944334, 'support': 45519}}
[[6699 1466 6748]
 [5459 2057 7583]
 [5261 1357 8889]]
training model: results/CHTR/W0/deepOF_L1/h100
Epoch 1/50
486/486 - 14s - loss: 3.3155 - accuracy100: 0.3605 - val_loss: 3.3216 - val_accuracy100: 0.3554 - 14s/epoch - 28ms/step
Epoch 2/50
486/486 - 11s - loss: 3.2901 - accuracy100: 0.3698 - val_loss: 3.3157 - val_accuracy100: 0.3579 - 11s/epoch - 23ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2787 - accuracy100: 0.3757 - val_loss: 3.3111 - val_accuracy100: 0.3686 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 11s - loss: 3.2744 - accuracy100: 0.3774 - val_loss: 3.3122 - val_accuracy100: 0.3657 - 11s/epoch - 24ms/step
Epoch 5/50
486/486 - 11s - loss: 3.2715 - accuracy100: 0.3783 - val_loss: 3.3119 - val_accuracy100: 0.3661 - 11s/epoch - 24ms/step
Epoch 6/50
486/486 - 11s - loss: 3.2688 - accuracy100: 0.3821 - val_loss: 3.3123 - val_accuracy100: 0.3664 - 11s/epoch - 23ms/step
Epoch 7/50
486/486 - 11s - loss: 3.2668 - accuracy100: 0.3838 - val_loss: 3.3104 - val_accuracy100: 0.3700 - 11s/epoch - 24ms/step
Epoch 8/50
486/486 - 11s - loss: 3.2642 - accuracy100: 0.3851 - val_loss: 3.3108 - val_accuracy100: 0.3698 - 11s/epoch - 23ms/step
Epoch 9/50
486/486 - 11s - loss: 3.2609 - accuracy100: 0.3884 - val_loss: 3.3104 - val_accuracy100: 0.3687 - 11s/epoch - 24ms/step
Epoch 10/50
486/486 - 11s - loss: 3.2600 - accuracy100: 0.3886 - val_loss: 3.3095 - val_accuracy100: 0.3709 - 11s/epoch - 23ms/step
Epoch 11/50
486/486 - 11s - loss: 3.2578 - accuracy100: 0.3873 - val_loss: 3.3074 - val_accuracy100: 0.3719 - 11s/epoch - 24ms/step
Epoch 12/50
486/486 - 11s - loss: 3.2565 - accuracy100: 0.3903 - val_loss: 3.3057 - val_accuracy100: 0.3748 - 11s/epoch - 24ms/step
Epoch 13/50
486/486 - 11s - loss: 3.2538 - accuracy100: 0.3922 - val_loss: 3.3069 - val_accuracy100: 0.3731 - 11s/epoch - 23ms/step
Epoch 14/50
486/486 - 11s - loss: 3.2522 - accuracy100: 0.3921 - val_loss: 3.3069 - val_accuracy100: 0.3745 - 11s/epoch - 23ms/step
Epoch 15/50
486/486 - 11s - loss: 3.2515 - accuracy100: 0.3931 - val_loss: 3.3042 - val_accuracy100: 0.3763 - 11s/epoch - 23ms/step
Epoch 16/50
486/486 - 12s - loss: 3.2488 - accuracy100: 0.3953 - val_loss: 3.3085 - val_accuracy100: 0.3746 - 12s/epoch - 25ms/step
Epoch 17/50
486/486 - 11s - loss: 3.2474 - accuracy100: 0.3970 - val_loss: 3.3051 - val_accuracy100: 0.3772 - 11s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 3.2450 - accuracy100: 0.3983 - val_loss: 3.3055 - val_accuracy100: 0.3754 - 12s/epoch - 24ms/step
Epoch 19/50
486/486 - 11s - loss: 3.2441 - accuracy100: 0.3996 - val_loss: 3.3048 - val_accuracy100: 0.3763 - 11s/epoch - 24ms/step
Epoch 20/50
486/486 - 12s - loss: 3.2416 - accuracy100: 0.3988 - val_loss: 3.3070 - val_accuracy100: 0.3747 - 12s/epoch - 24ms/step
Epoch 21/50
486/486 - 11s - loss: 3.2396 - accuracy100: 0.4011 - val_loss: 3.3045 - val_accuracy100: 0.3780 - 11s/epoch - 23ms/step
Epoch 22/50
486/486 - 11s - loss: 3.2368 - accuracy100: 0.4014 - val_loss: 3.3078 - val_accuracy100: 0.3759 - 11s/epoch - 23ms/step
Epoch 23/50
486/486 - 11s - loss: 3.2348 - accuracy100: 0.4015 - val_loss: 3.3083 - val_accuracy100: 0.3762 - 11s/epoch - 23ms/step
Epoch 24/50
486/486 - 11s - loss: 3.2336 - accuracy100: 0.4039 - val_loss: 3.3119 - val_accuracy100: 0.3758 - 11s/epoch - 23ms/step
Epoch 25/50
486/486 - 11s - loss: 3.2303 - accuracy100: 0.4069 - val_loss: 3.3103 - val_accuracy100: 0.3761 - 11s/epoch - 23ms/step
testing model: results/CHTR/W0/deepOF_L1/h100
Evaluating performance on  test set...
1269/1269 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1047987
{'0': {'precision': 0.35132218631445833, 'recall': 0.6078454252846738, 'f1-score': 0.44528105655323724, 'support': 102837}, '1': {'precision': 0.4426789150270002, 'recall': 0.06068547700895136, 'f1-score': 0.10673850413439594, 'support': 117524}, '2': {'precision': 0.3719314887204241, 'recall': 0.465717734056208, 'f1-score': 0.4135742872818676, 'support': 104398}, 'accuracy': 0.36415003125394524, 'macro avg': {'precision': 0.3886441966872942, 'recall': 0.37808287878327773, 'f1-score': 0.32186461598983357, 'support': 324759}, 'weighted avg': {'precision': 0.3910075472676291, 'recall': 0.36415003125394524, 'f1-score': 0.31257650262597314, 'support': 324759}}
[[62509  4032 36296]
 [64585  7132 45807]
 [50831  4947 48620]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0928262
{'0': {'precision': 0.38169895971996254, 'recall': 0.5653158086893026, 'f1-score': 0.4557066337041616, 'support': 41085}, '1': {'precision': 0.43914438502673797, 'recall': 0.050037778156913404, 'f1-score': 0.08983896376684754, 'support': 41029}, '2': {'precision': 0.39298484590498894, 'recall': 0.5476981490270527, 'f1-score': 0.4576187171607019, 'support': 42140}, 'accuracy': 0.3891947140534711, 'macro avg': {'precision': 0.40460939688389647, 'recall': 0.38768391195775626, 'f1-score': 0.334388104877237, 'support': 124254}, 'weighted avg': {'precision': 0.40449513206651644, 'recall': 0.3891947140534711, 'f1-score': 0.3355446314104773, 'support': 124254}}
[[23226  1273 16586]
 [19912  2053 19064]
 [17711  1349 23080]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1006879
{'0': {'precision': 0.36656080319639384, 'recall': 0.48591023290554763, 'f1-score': 0.41788081403836613, 'support': 14727}, '1': {'precision': 0.42473454091193, 'recall': 0.044584316810910046, 'f1-score': 0.08069779861152318, 'support': 15252}, '2': {'precision': 0.37842269224463027, 'recall': 0.594079794079794, 'f1-score': 0.46233974358974356, 'support': 15540}, 'accuracy': 0.3749643006217184, 'macro avg': {'precision': 0.3899060121176514, 'recall': 0.3748581145987506, 'f1-score': 0.3203061187465443, 'support': 45519}, 'weighted avg': {'precision': 0.390102612187078, 'recall': 0.3749643006217184, 'f1-score': 0.3200793775819017, 'support': 45519}}
[[7156  459 7112]
 [6520  680 8052]
 [5846  462 9232]]
training model: results/CHTR/W0/deepOF_L1/h200
Epoch 1/50
486/486 - 13s - loss: 3.3272 - accuracy200: 0.3513 - val_loss: 3.3190 - val_accuracy200: 0.3495 - 13s/epoch - 28ms/step
Epoch 2/50
486/486 - 11s - loss: 3.3017 - accuracy200: 0.3592 - val_loss: 3.3121 - val_accuracy200: 0.3565 - 11s/epoch - 23ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2928 - accuracy200: 0.3615 - val_loss: 3.3091 - val_accuracy200: 0.3582 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 11s - loss: 3.2888 - accuracy200: 0.3643 - val_loss: 3.3106 - val_accuracy200: 0.3569 - 11s/epoch - 23ms/step
Epoch 5/50
486/486 - 11s - loss: 3.2843 - accuracy200: 0.3647 - val_loss: 3.3097 - val_accuracy200: 0.3594 - 11s/epoch - 23ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2821 - accuracy200: 0.3663 - val_loss: 3.3096 - val_accuracy200: 0.3600 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 11s - loss: 3.2789 - accuracy200: 0.3693 - val_loss: 3.3098 - val_accuracy200: 0.3632 - 11s/epoch - 23ms/step
Epoch 8/50
486/486 - 11s - loss: 3.2755 - accuracy200: 0.3720 - val_loss: 3.3082 - val_accuracy200: 0.3645 - 11s/epoch - 23ms/step
Epoch 9/50
486/486 - 11s - loss: 3.2740 - accuracy200: 0.3734 - val_loss: 3.3076 - val_accuracy200: 0.3642 - 11s/epoch - 23ms/step
Epoch 10/50
486/486 - 11s - loss: 3.2737 - accuracy200: 0.3733 - val_loss: 3.3081 - val_accuracy200: 0.3658 - 11s/epoch - 23ms/step
Epoch 11/50
486/486 - 11s - loss: 3.2711 - accuracy200: 0.3738 - val_loss: 3.3100 - val_accuracy200: 0.3661 - 11s/epoch - 23ms/step
Epoch 12/50
486/486 - 11s - loss: 3.2703 - accuracy200: 0.3746 - val_loss: 3.3058 - val_accuracy200: 0.3667 - 11s/epoch - 24ms/step
Epoch 13/50
486/486 - 11s - loss: 3.2685 - accuracy200: 0.3776 - val_loss: 3.3051 - val_accuracy200: 0.3671 - 11s/epoch - 24ms/step
Epoch 14/50
486/486 - 11s - loss: 3.2683 - accuracy200: 0.3773 - val_loss: 3.3061 - val_accuracy200: 0.3679 - 11s/epoch - 24ms/step
Epoch 15/50
486/486 - 11s - loss: 3.2668 - accuracy200: 0.3781 - val_loss: 3.3052 - val_accuracy200: 0.3672 - 11s/epoch - 23ms/step
Epoch 16/50
486/486 - 12s - loss: 3.2655 - accuracy200: 0.3791 - val_loss: 3.3077 - val_accuracy200: 0.3680 - 12s/epoch - 24ms/step
Epoch 17/50
486/486 - 12s - loss: 3.2647 - accuracy200: 0.3787 - val_loss: 3.3056 - val_accuracy200: 0.3681 - 12s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 3.2626 - accuracy200: 0.3806 - val_loss: 3.3063 - val_accuracy200: 0.3666 - 12s/epoch - 24ms/step
Epoch 19/50
486/486 - 11s - loss: 3.2606 - accuracy200: 0.3829 - val_loss: 3.3071 - val_accuracy200: 0.3672 - 11s/epoch - 23ms/step
Epoch 20/50
486/486 - 11s - loss: 3.2598 - accuracy200: 0.3845 - val_loss: 3.3083 - val_accuracy200: 0.3647 - 11s/epoch - 23ms/step
Epoch 21/50
486/486 - 11s - loss: 3.2578 - accuracy200: 0.3851 - val_loss: 3.3088 - val_accuracy200: 0.3668 - 11s/epoch - 23ms/step
Epoch 22/50
486/486 - 11s - loss: 3.2553 - accuracy200: 0.3870 - val_loss: 3.3114 - val_accuracy200: 0.3663 - 11s/epoch - 24ms/step
Epoch 23/50
486/486 - 11s - loss: 3.2540 - accuracy200: 0.3878 - val_loss: 3.3129 - val_accuracy200: 0.3646 - 11s/epoch - 24ms/step
testing model: results/CHTR/W0/deepOF_L1/h200
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083858
{'0': {'precision': 0.3315500545737068, 'recall': 0.6041699325913152, 'f1-score': 0.42814640462973574, 'support': 102064}, '1': {'precision': 0.3296, 'recall': 0.005306907567066259, 'f1-score': 0.010445629484394939, 'support': 116452}, '2': {'precision': 0.3580429081718372, 'recall': 0.46134804175333904, 'f1-score': 0.40318335115571274, 'support': 106243}, 'accuracy': 0.34270643769687675, 'macro avg': {'precision': 0.339730987581848, 'recall': 0.3569416273039068, 'f1-score': 0.2805917950899478, 'support': 324759}, 'weighted avg': {'precision': 0.33951778599795945, 'recall': 0.34270643769687675, 'f1-score': 0.27020085005706534, 'support': 324759}}
[[61664   541 39859]
 [67811   618 48023]
 [56512   716 49015]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0965867
{'0': {'precision': 0.3666719069328722, 'recall': 0.5674110835401158, 'f1-score': 0.4454715611749876, 'support': 41106}, '1': {'precision': 0.404099560761347, 'recall': 0.006734992679355783, 'f1-score': 0.01324916592660154, 'support': 40980}, '2': {'precision': 0.3776454695552109, 'recall': 0.5369948776323278, 'f1-score': 0.44343917986076437, 'support': 42168}, 'accuracy': 0.3721731292352761, 'macro avg': {'precision': 0.3828056457498101, 'recall': 0.3703803179505998, 'f1-score': 0.3007199689874512, 'support': 124254}, 'weighted avg': {'precision': 0.38273994854561444, 'recall': 0.3721731292352761, 'f1-score': 0.3022313016055812, 'support': 124254}}
[[23324   187 17595]
 [20982   276 19722]
 [19304   220 22644]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019392
{'0': {'precision': 0.3498404149212049, 'recall': 0.47955974842767296, 'f1-score': 0.40455594002306805, 'support': 14628}, '1': {'precision': 0.272, 'recall': 0.004546670232682536, 'f1-score': 0.008943837958700513, 'support': 14956}, '2': {'precision': 0.3801800372764405, 'recall': 0.6016316284907437, 'f1-score': 0.46593118195956457, 'support': 15935}, 'accuracy': 0.3662206990487489, 'macro avg': {'precision': 0.3340068173992152, 'recall': 0.3619126823836997, 'f1-score': 0.29314365331377773, 'support': 45519}, 'weighted avg': {'precision': 0.33488579457957035, 'recall': 0.3662206990487489, 'f1-score': 0.29605706882166627, 'support': 45519}}
[[7015   87 7526]
 [6784   68 8104]
 [6253   95 9587]]
training model: results/CHTR/W0/deepOF_L1/h300
Epoch 1/50
486/486 - 14s - loss: 3.3323 - accuracy300: 0.3467 - val_loss: 3.3204 - val_accuracy300: 0.3461 - 14s/epoch - 29ms/step
Epoch 2/50
486/486 - 12s - loss: 3.3080 - accuracy300: 0.3539 - val_loss: 3.3187 - val_accuracy300: 0.3475 - 12s/epoch - 24ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2975 - accuracy300: 0.3568 - val_loss: 3.3139 - val_accuracy300: 0.3518 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2933 - accuracy300: 0.3566 - val_loss: 3.3121 - val_accuracy300: 0.3537 - 12s/epoch - 24ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2907 - accuracy300: 0.3582 - val_loss: 3.3140 - val_accuracy300: 0.3520 - 12s/epoch - 24ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2874 - accuracy300: 0.3600 - val_loss: 3.3136 - val_accuracy300: 0.3523 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2851 - accuracy300: 0.3633 - val_loss: 3.3108 - val_accuracy300: 0.3558 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2838 - accuracy300: 0.3636 - val_loss: 3.3107 - val_accuracy300: 0.3558 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2814 - accuracy300: 0.3658 - val_loss: 3.3097 - val_accuracy300: 0.3556 - 12s/epoch - 24ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2810 - accuracy300: 0.3661 - val_loss: 3.3085 - val_accuracy300: 0.3579 - 12s/epoch - 25ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2794 - accuracy300: 0.3673 - val_loss: 3.3098 - val_accuracy300: 0.3567 - 12s/epoch - 24ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2784 - accuracy300: 0.3698 - val_loss: 3.3091 - val_accuracy300: 0.3560 - 12s/epoch - 25ms/step
Epoch 13/50
486/486 - 12s - loss: 3.2771 - accuracy300: 0.3689 - val_loss: 3.3083 - val_accuracy300: 0.3580 - 12s/epoch - 25ms/step
Epoch 14/50
486/486 - 12s - loss: 3.2769 - accuracy300: 0.3688 - val_loss: 3.3087 - val_accuracy300: 0.3571 - 12s/epoch - 25ms/step
Epoch 15/50
486/486 - 12s - loss: 3.2760 - accuracy300: 0.3714 - val_loss: 3.3077 - val_accuracy300: 0.3591 - 12s/epoch - 25ms/step
Epoch 16/50
486/486 - 12s - loss: 3.2743 - accuracy300: 0.3718 - val_loss: 3.3090 - val_accuracy300: 0.3565 - 12s/epoch - 25ms/step
Epoch 17/50
486/486 - 12s - loss: 3.2733 - accuracy300: 0.3717 - val_loss: 3.3102 - val_accuracy300: 0.3569 - 12s/epoch - 25ms/step
Epoch 18/50
486/486 - 11s - loss: 3.2726 - accuracy300: 0.3729 - val_loss: 3.3087 - val_accuracy300: 0.3614 - 11s/epoch - 23ms/step
Epoch 19/50
486/486 - 11s - loss: 3.2704 - accuracy300: 0.3761 - val_loss: 3.3099 - val_accuracy300: 0.3554 - 11s/epoch - 23ms/step
Epoch 20/50
486/486 - 12s - loss: 3.2700 - accuracy300: 0.3763 - val_loss: 3.3103 - val_accuracy300: 0.3546 - 12s/epoch - 24ms/step
Epoch 21/50
486/486 - 11s - loss: 3.2681 - accuracy300: 0.3777 - val_loss: 3.3119 - val_accuracy300: 0.3568 - 11s/epoch - 24ms/step
Epoch 22/50
486/486 - 12s - loss: 3.2673 - accuracy300: 0.3774 - val_loss: 3.3112 - val_accuracy300: 0.3566 - 12s/epoch - 24ms/step
Epoch 23/50
486/486 - 12s - loss: 3.2667 - accuracy300: 0.3781 - val_loss: 3.3099 - val_accuracy300: 0.3587 - 12s/epoch - 24ms/step
Epoch 24/50
486/486 - 12s - loss: 3.2662 - accuracy300: 0.3778 - val_loss: 3.3118 - val_accuracy300: 0.3568 - 12s/epoch - 24ms/step
Epoch 25/50
486/486 - 11s - loss: 3.2643 - accuracy300: 0.3787 - val_loss: 3.3142 - val_accuracy300: 0.3528 - 11s/epoch - 24ms/step
testing model: results/CHTR/W0/deepOF_L1/h300
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091791
{'0': {'precision': 0.32230608287964596, 'recall': 0.5830377489349053, 'f1-score': 0.41512761544647775, 'support': 100930}, '1': {'precision': 0.34367945823927765, 'recall': 0.0052062406497114765, 'f1-score': 0.010257101232031125, 'support': 116975}, '2': {'precision': 0.34703615865079873, 'recall': 0.4560147490968986, 'f1-score': 0.394130945592345, 'support': 106854}, 'accuracy': 0.33311470967702206, 'macro avg': {'precision': 0.33767389992324076, 'recall': 0.3480862462271718, 'f1-score': 0.273171887423618, 'support': 324759}, 'weighted avg': {'precision': 0.33814138874997957, 'recall': 0.33311470967702206, 'f1-score': 0.26238879508790913, 'support': 324759}}
[[58846   536 41548]
 [66232   609 50134]
 [57500   627 48727]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982103
{'0': {'precision': 0.3592580998591329, 'recall': 0.5571116504854369, 'f1-score': 0.43682557807593486, 'support': 41200}, '1': {'precision': 0.3801916932907348, 'recall': 0.005802189229381506, 'f1-score': 0.011429943570656742, 'support': 41019}, '2': {'precision': 0.36817436137801735, 'recall': 0.5232306411323897, 'f1-score': 0.43221679620331527, 'support': 42035}, 'accuracy': 0.3636502647802083, 'macro avg': {'precision': 0.36920805150929503, 'recall': 0.36204816028240266, 'f1-score': 0.29349077261663564, 'support': 124254}, 'weighted avg': {'precision': 0.36918510520235875, 'recall': 0.3636502647802083, 'f1-score': 0.29483390233279927, 'support': 124254}}
[[22953   200 18047]
 [21084   238 19697]
 [19853   188 21994]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1024082
{'0': {'precision': 0.3404896055954925, 'recall': 0.4784982935153584, 'f1-score': 0.39786594017821675, 'support': 14650}, '1': {'precision': 0.334841628959276, 'recall': 0.004982158486501044, 'f1-score': 0.009818230065012605, 'support': 14853}, '2': {'precision': 0.3703763658437879, 'recall': 0.5714285714285714, 'f1-score': 0.4494426165103373, 'support': 16016}, 'accuracy': 0.3566862189415409, 'macro avg': {'precision': 0.34856920013285214, 'recall': 0.3516363411434769, 'f1-score': 0.28570892891785554, 'support': 45519}, 'weighted avg': {'precision': 0.34916240058569387, 'recall': 0.3566862189415409, 'f1-score': 0.28939210309532437, 'support': 45519}}
[[7010   71 7569]
 [6790   74 7989]
 [6788   76 9152]]
training model: results/CHTR/W0/deepOF_L1/h500
Epoch 1/50
486/486 - 14s - loss: 3.3312 - accuracy500: 0.3509 - val_loss: 3.3250 - val_accuracy500: 0.3418 - 14s/epoch - 29ms/step
Epoch 2/50
486/486 - 12s - loss: 3.3073 - accuracy500: 0.3547 - val_loss: 3.3211 - val_accuracy500: 0.3426 - 12s/epoch - 24ms/step
Epoch 3/50
486/486 - 12s - loss: 3.2975 - accuracy500: 0.3597 - val_loss: 3.3198 - val_accuracy500: 0.3428 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2927 - accuracy500: 0.3588 - val_loss: 3.3213 - val_accuracy500: 0.3421 - 12s/epoch - 24ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2903 - accuracy500: 0.3590 - val_loss: 3.3211 - val_accuracy500: 0.3438 - 12s/epoch - 24ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2881 - accuracy500: 0.3611 - val_loss: 3.3225 - val_accuracy500: 0.3436 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2869 - accuracy500: 0.3611 - val_loss: 3.3213 - val_accuracy500: 0.3448 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2859 - accuracy500: 0.3601 - val_loss: 3.3227 - val_accuracy500: 0.3451 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2843 - accuracy500: 0.3626 - val_loss: 3.3224 - val_accuracy500: 0.3431 - 12s/epoch - 24ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2831 - accuracy500: 0.3638 - val_loss: 3.3222 - val_accuracy500: 0.3434 - 12s/epoch - 24ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2816 - accuracy500: 0.3644 - val_loss: 3.3237 - val_accuracy500: 0.3442 - 12s/epoch - 25ms/step
Epoch 12/50
486/486 - 12s - loss: 3.2808 - accuracy500: 0.3667 - val_loss: 3.3231 - val_accuracy500: 0.3446 - 12s/epoch - 24ms/step
Epoch 13/50
486/486 - 12s - loss: 3.2798 - accuracy500: 0.3660 - val_loss: 3.3232 - val_accuracy500: 0.3420 - 12s/epoch - 25ms/step
testing model: results/CHTR/W0/deepOF_L1/h500
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1102203
{'0': {'precision': 0.31509724959300833, 'recall': 0.6584994628148502, 'f1-score': 0.4262367917785462, 'support': 100524}, '1': {'precision': 0.35233853006681515, 'recall': 0.020158858259355223, 'f1-score': 0.03813579750903978, 'support': 117715}, '2': {'precision': 0.3479702814370148, 'recall': 0.352628614344724, 'f1-score': 0.3502839610940662, 'support': 106520}, 'accuracy': 0.3267961780889829, 'macro avg': {'precision': 0.33846868703227945, 'recall': 0.3437623118063098, 'f1-score': 0.2715521834605507, 'support': 324759}, 'weighted avg': {'precision': 0.33937830934192287, 'recall': 0.3267961780889829, 'f1-score': 0.26064999028899316, 'support': 324759}}
[[66195  2105 32224]
 [77182  2373 38160]
 [66701  2257 37562]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019862
{'0': {'precision': 0.34502821822090834, 'recall': 0.6181717504875172, 'f1-score': 0.4428710642738256, 'support': 41537}, '1': {'precision': 0.3674046161092793, 'recall': 0.0189873417721519, 'f1-score': 0.03610860356919659, 'support': 41080}, '2': {'precision': 0.35476095659281925, 'recall': 0.4065134375675481, 'f1-score': 0.3788780946411783, 'support': 41637}, 'accuracy': 0.3491477135544932, 'macro avg': {'precision': 0.3557312636410023, 'recall': 0.34789084327573905, 'f1-score': 0.2859525874947335, 'support': 124254}, 'weighted avg': {'precision': 0.3556875487281398, 'recall': 0.3491477135544932, 'f1-score': 0.2869462879097593, 'support': 124254}}
[[25677   654 15206]
 [24721   780 15579]
 [24022   689 16926]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064559
{'0': {'precision': 0.32793151503085805, 'recall': 0.5690989496959646, 'f1-score': 0.4160961931947356, 'support': 14472}, '1': {'precision': 0.33858267716535434, 'recall': 0.017096282552514743, 'f1-score': 0.03254904434491895, 'support': 15091}, '2': {'precision': 0.35648101008043986, 'recall': 0.4388317874153923, 'f1-score': 0.39339288724085625, 'support': 15956}, 'accuracy': 0.3404292712933061, 'macro avg': {'precision': 0.34099840075888405, 'recall': 0.3416756732212905, 'f1-score': 0.280679374926837, 'support': 45519}, 'weighted avg': {'precision': 0.34147031049611015, 'recall': 0.3404292712933061, 'f1-score': 0.28097978085938813, 'support': 45519}}
[[8236  250 5986]
 [8179  258 6654]
 [8700  254 7002]]
training model: results/CHTR/W0/deepOF_L1/h1000
Epoch 1/50
486/486 - 14s - loss: 3.3344 - accuracy1000: 0.3495 - val_loss: 3.3355 - val_accuracy1000: 0.3300 - 14s/epoch - 29ms/step
Epoch 2/50
486/486 - 12s - loss: 3.3108 - accuracy1000: 0.3522 - val_loss: 3.3317 - val_accuracy1000: 0.3279 - 12s/epoch - 24ms/step
Epoch 3/50
486/486 - 12s - loss: 3.3006 - accuracy1000: 0.3545 - val_loss: 3.3369 - val_accuracy1000: 0.3289 - 12s/epoch - 24ms/step
Epoch 4/50
486/486 - 12s - loss: 3.2954 - accuracy1000: 0.3550 - val_loss: 3.3351 - val_accuracy1000: 0.3278 - 12s/epoch - 25ms/step
Epoch 5/50
486/486 - 12s - loss: 3.2919 - accuracy1000: 0.3580 - val_loss: 3.3346 - val_accuracy1000: 0.3302 - 12s/epoch - 24ms/step
Epoch 6/50
486/486 - 12s - loss: 3.2894 - accuracy1000: 0.3590 - val_loss: 3.3327 - val_accuracy1000: 0.3351 - 12s/epoch - 24ms/step
Epoch 7/50
486/486 - 12s - loss: 3.2882 - accuracy1000: 0.3598 - val_loss: 3.3337 - val_accuracy1000: 0.3370 - 12s/epoch - 24ms/step
Epoch 8/50
486/486 - 12s - loss: 3.2867 - accuracy1000: 0.3599 - val_loss: 3.3306 - val_accuracy1000: 0.3405 - 12s/epoch - 24ms/step
Epoch 9/50
486/486 - 12s - loss: 3.2854 - accuracy1000: 0.3599 - val_loss: 3.3313 - val_accuracy1000: 0.3387 - 12s/epoch - 25ms/step
Epoch 10/50
486/486 - 12s - loss: 3.2835 - accuracy1000: 0.3620 - val_loss: 3.3302 - val_accuracy1000: 0.3395 - 12s/epoch - 25ms/step
Epoch 11/50
486/486 - 12s - loss: 3.2827 - accuracy1000: 0.3629 - val_loss: 3.3277 - val_accuracy1000: 0.3445 - 12s/epoch - 24ms/step
Epoch 12/50
486/486 - 11s - loss: 3.2815 - accuracy1000: 0.3623 - val_loss: 3.3297 - val_accuracy1000: 0.3410 - 11s/epoch - 23ms/step
Epoch 13/50
486/486 - 12s - loss: 3.2801 - accuracy1000: 0.3651 - val_loss: 3.3284 - val_accuracy1000: 0.3412 - 12s/epoch - 25ms/step
Epoch 14/50
486/486 - 12s - loss: 3.2794 - accuracy1000: 0.3643 - val_loss: 3.3278 - val_accuracy1000: 0.3409 - 12s/epoch - 24ms/step
Epoch 15/50
486/486 - 12s - loss: 3.2781 - accuracy1000: 0.3656 - val_loss: 3.3276 - val_accuracy1000: 0.3444 - 12s/epoch - 25ms/step
Epoch 16/50
486/486 - 12s - loss: 3.2762 - accuracy1000: 0.3689 - val_loss: 3.3274 - val_accuracy1000: 0.3450 - 12s/epoch - 24ms/step
Epoch 17/50
486/486 - 12s - loss: 3.2753 - accuracy1000: 0.3684 - val_loss: 3.3281 - val_accuracy1000: 0.3415 - 12s/epoch - 24ms/step
Epoch 18/50
486/486 - 12s - loss: 3.2733 - accuracy1000: 0.3704 - val_loss: 3.3271 - val_accuracy1000: 0.3437 - 12s/epoch - 24ms/step
Epoch 19/50
486/486 - 12s - loss: 3.2727 - accuracy1000: 0.3722 - val_loss: 3.3278 - val_accuracy1000: 0.3406 - 12s/epoch - 24ms/step
Epoch 20/50
486/486 - 12s - loss: 3.2714 - accuracy1000: 0.3721 - val_loss: 3.3264 - val_accuracy1000: 0.3440 - 12s/epoch - 25ms/step
Epoch 21/50
486/486 - 12s - loss: 3.2706 - accuracy1000: 0.3730 - val_loss: 3.3257 - val_accuracy1000: 0.3426 - 12s/epoch - 25ms/step
Epoch 22/50
486/486 - 12s - loss: 3.2694 - accuracy1000: 0.3742 - val_loss: 3.3273 - val_accuracy1000: 0.3434 - 12s/epoch - 25ms/step
Epoch 23/50
486/486 - 12s - loss: 3.2682 - accuracy1000: 0.3745 - val_loss: 3.3282 - val_accuracy1000: 0.3426 - 12s/epoch - 24ms/step
Epoch 24/50
486/486 - 12s - loss: 3.2678 - accuracy1000: 0.3748 - val_loss: 3.3276 - val_accuracy1000: 0.3424 - 12s/epoch - 24ms/step
Epoch 25/50
486/486 - 12s - loss: 3.2659 - accuracy1000: 0.3762 - val_loss: 3.3270 - val_accuracy1000: 0.3413 - 12s/epoch - 25ms/step
Epoch 26/50
486/486 - 12s - loss: 3.2647 - accuracy1000: 0.3779 - val_loss: 3.3282 - val_accuracy1000: 0.3413 - 12s/epoch - 24ms/step
Epoch 27/50
486/486 - 12s - loss: 3.2643 - accuracy1000: 0.3772 - val_loss: 3.3269 - val_accuracy1000: 0.3410 - 12s/epoch - 24ms/step
Epoch 28/50
486/486 - 11s - loss: 3.2629 - accuracy1000: 0.3789 - val_loss: 3.3277 - val_accuracy1000: 0.3448 - 11s/epoch - 22ms/step
Epoch 29/50
486/486 - 11s - loss: 3.2615 - accuracy1000: 0.3801 - val_loss: 3.3272 - val_accuracy1000: 0.3450 - 11s/epoch - 23ms/step
Epoch 30/50
486/486 - 11s - loss: 3.2594 - accuracy1000: 0.3811 - val_loss: 3.3288 - val_accuracy1000: 0.3427 - 11s/epoch - 23ms/step
Epoch 31/50
486/486 - 11s - loss: 3.2588 - accuracy1000: 0.3815 - val_loss: 3.3301 - val_accuracy1000: 0.3440 - 11s/epoch - 23ms/step
testing model: results/CHTR/W0/deepOF_L1/h1000
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1186628
{'0': {'precision': 0.3064495743652652, 'recall': 0.4243781401861461, 'f1-score': 0.3558992026179344, 'support': 97128}, '1': {'precision': 0.3921428571428571, 'recall': 0.008755911037392046, 'f1-score': 0.017129351565120396, 'support': 125401}, '2': {'precision': 0.3231299412122441, 'recall': 0.5925070918517069, 'f1-score': 0.4181936178732688, 'support': 102230}, 'accuracy': 0.31681647005933633, 'macro avg': {'precision': 0.3405741242401221, 'recall': 0.34188038102508167, 'f1-score': 0.2637407240187745, 'support': 324759}, 'weighted avg': {'precision': 0.34478956573227715, 'recall': 0.31681647005933633, 'f1-score': 0.24469760383138467, 'support': 324759}}
[[41219   598 55311]
 [52732  1098 71571]
 [40554  1104 60572]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016004
{'0': {'precision': 0.3568248151856665, 'recall': 0.40277510580992687, 'f1-score': 0.37841013070049595, 'support': 41584}, '1': {'precision': 0.4097345132743363, 'recall': 0.011273710097640556, 'f1-score': 0.02194364795374298, 'support': 41069}, '2': {'precision': 0.3471418258187307, 'recall': 0.6357299103386937, 'f1-score': 0.44906864992443923, 'support': 41601}, 'accuracy': 0.3513689700130378, 'macro avg': {'precision': 0.3712337180929111, 'recall': 0.34992624208208706, 'f1-score': 0.28314080952622606, 'support': 124254}, 'weighted avg': {'precision': 0.37107084630055764, 'recall': 0.3513689700130378, 'f1-score': 0.28424610441811365, 'support': 124254}}
[[16749   321 24514]
 [15382   463 25224]
 [14808   346 26447]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1078165
{'0': {'precision': 0.3218872870249017, 'recall': 0.34938473575645496, 'f1-score': 0.3350728196732494, 'support': 14059}, '1': {'precision': 0.3541666666666667, 'recall': 0.009875427612470148, 'f1-score': 0.019215070643642074, 'support': 15493}, '2': {'precision': 0.35430985348845007, 'recall': 0.6618650967620717, 'f1-score': 0.46154518059134386, 'support': 15967}, 'accuracy': 0.34343900349304685, 'macro avg': {'precision': 0.3434546023933395, 'recall': 0.3403750867103323, 'f1-score': 0.27194435696941177, 'support': 45519}, 'weighted avg': {'precision': 0.34424708287967315, 'recall': 0.34343900349304685, 'f1-score': 0.2719299580344504, 'support': 45519}}
[[ 4912   137  9010]
 [ 5091   153 10249]
 [ 5257   142 10568]]
training model: results/CHTR/W0/deepLOB_L2/h10
Epoch 1/50
486/486 - 27s - loss: 3.3228 - accuracy10: 0.3582 - val_loss: 3.3281 - val_accuracy10: 0.3457 - 27s/epoch - 55ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2887 - accuracy10: 0.3629 - val_loss: 3.3145 - val_accuracy10: 0.3560 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2724 - accuracy10: 0.3736 - val_loss: 3.3106 - val_accuracy10: 0.3638 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2585 - accuracy10: 0.3818 - val_loss: 3.2893 - val_accuracy10: 0.3797 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 24s - loss: 3.2433 - accuracy10: 0.3936 - val_loss: 3.2864 - val_accuracy10: 0.3833 - 24s/epoch - 49ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2288 - accuracy10: 0.4040 - val_loss: 3.2742 - val_accuracy10: 0.3924 - 24s/epoch - 49ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2183 - accuracy10: 0.4115 - val_loss: 3.2564 - val_accuracy10: 0.3990 - 24s/epoch - 49ms/step
Epoch 8/50
486/486 - 24s - loss: 3.2043 - accuracy10: 0.4208 - val_loss: 3.2471 - val_accuracy10: 0.4041 - 24s/epoch - 49ms/step
Epoch 9/50
486/486 - 24s - loss: 3.1955 - accuracy10: 0.4269 - val_loss: 3.2477 - val_accuracy10: 0.4053 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 24s - loss: 3.1848 - accuracy10: 0.4322 - val_loss: 3.2610 - val_accuracy10: 0.4025 - 24s/epoch - 48ms/step
Epoch 11/50
486/486 - 24s - loss: 3.1753 - accuracy10: 0.4364 - val_loss: 3.2624 - val_accuracy10: 0.4028 - 24s/epoch - 49ms/step
Epoch 12/50
486/486 - 24s - loss: 3.1706 - accuracy10: 0.4391 - val_loss: 3.2480 - val_accuracy10: 0.4118 - 24s/epoch - 49ms/step
Epoch 13/50
486/486 - 24s - loss: 3.1626 - accuracy10: 0.4418 - val_loss: 3.2386 - val_accuracy10: 0.4145 - 24s/epoch - 50ms/step
Epoch 14/50
486/486 - 24s - loss: 3.1545 - accuracy10: 0.4462 - val_loss: 3.2507 - val_accuracy10: 0.4143 - 24s/epoch - 49ms/step
Epoch 15/50
486/486 - 24s - loss: 3.1497 - accuracy10: 0.4491 - val_loss: 3.2320 - val_accuracy10: 0.4187 - 24s/epoch - 49ms/step
Epoch 16/50
486/486 - 24s - loss: 3.1418 - accuracy10: 0.4518 - val_loss: 3.2307 - val_accuracy10: 0.4189 - 24s/epoch - 48ms/step
Epoch 17/50
486/486 - 24s - loss: 3.1356 - accuracy10: 0.4538 - val_loss: 3.2280 - val_accuracy10: 0.4208 - 24s/epoch - 49ms/step
Epoch 18/50
486/486 - 24s - loss: 3.1305 - accuracy10: 0.4555 - val_loss: 3.2295 - val_accuracy10: 0.4187 - 24s/epoch - 50ms/step
Epoch 19/50
486/486 - 24s - loss: 3.1209 - accuracy10: 0.4586 - val_loss: 3.2411 - val_accuracy10: 0.4186 - 24s/epoch - 50ms/step
Epoch 20/50
486/486 - 24s - loss: 3.1175 - accuracy10: 0.4592 - val_loss: 3.2468 - val_accuracy10: 0.4195 - 24s/epoch - 50ms/step
Epoch 21/50
486/486 - 24s - loss: 3.1117 - accuracy10: 0.4618 - val_loss: 3.2365 - val_accuracy10: 0.4201 - 24s/epoch - 49ms/step
Epoch 22/50
486/486 - 24s - loss: 3.1027 - accuracy10: 0.4644 - val_loss: 3.2346 - val_accuracy10: 0.4225 - 24s/epoch - 49ms/step
Epoch 23/50
486/486 - 24s - loss: 3.0980 - accuracy10: 0.4676 - val_loss: 3.2481 - val_accuracy10: 0.4217 - 24s/epoch - 49ms/step
Epoch 24/50
486/486 - 24s - loss: 3.0916 - accuracy10: 0.4687 - val_loss: 3.2436 - val_accuracy10: 0.4218 - 24s/epoch - 49ms/step
Epoch 25/50
486/486 - 24s - loss: 3.0857 - accuracy10: 0.4711 - val_loss: 3.2473 - val_accuracy10: 0.4213 - 24s/epoch - 49ms/step
Epoch 26/50
486/486 - 24s - loss: 3.0782 - accuracy10: 0.4757 - val_loss: 3.2510 - val_accuracy10: 0.4205 - 24s/epoch - 49ms/step
Epoch 27/50
486/486 - 24s - loss: 3.0712 - accuracy10: 0.4764 - val_loss: 3.2570 - val_accuracy10: 0.4205 - 24s/epoch - 48ms/step
testing model: results/CHTR/W0/deepLOB_L2/h10
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0860909
{'0': {'precision': 0.42563403103239633, 'recall': 0.36800524911110916, 'f1-score': 0.3947273315199818, 'support': 112781}, '1': {'precision': 0.3733608368940622, 'recall': 0.3258164698435306, 'f1-score': 0.3479721343424687, 'support': 101106}, '2': {'precision': 0.4067054135316712, 'recall': 0.509943450850943, 'f1-score': 0.4525108143690051, 'support': 110877}, 'accuracy': 0.40332980256432366, 'macro avg': {'precision': 0.4019000938193766, 'recall': 0.4012550566018609, 'f1-score': 0.39840342674381857, 'support': 324764}, 'weighted avg': {'precision': 0.4028978845100653, 'recall': 0.40332980256432366, 'f1-score': 0.3998991740333808, 'support': 324764}}
[[41504 29793 41484]
 [27167 32942 40997]
 [28840 25496 56541]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0727727
{'0': {'precision': 0.44829225770663284, 'recall': 0.2740993773772319, 'f1-score': 0.340193941216267, 'support': 41277}, '1': {'precision': 0.4104263851379, 'recall': 0.4892086330935252, 'f1-score': 0.44636797543418516, 'support': 41005}, '2': {'precision': 0.4131947906902535, 'recall': 0.49360303051961973, 'f1-score': 0.4498339014699177, 'support': 41973}, 'accuracy': 0.419234638445133, 'macro avg': {'precision': 0.42397114451159545, 'recall': 0.41897034699679225, 'f1-score': 0.4121319393734566, 'support': 124255}, 'weighted avg': {'precision': 0.4239404321240858, 'recall': 0.419234638445133, 'f1-score': 0.41226817826775153, 'support': 124255}}
[[11314 14693 15270]
 [ 6792 20060 14153]
 [ 7132 14123 20718]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0753722
{'0': {'precision': 0.4172923600897902, 'recall': 0.36437985806015544, 'f1-score': 0.38904524788915346, 'support': 14795}, '1': {'precision': 0.4110842760899962, 'recall': 0.43532103917081705, 'f1-score': 0.42285564853556484, 'support': 14858}, '2': {'precision': 0.4338649433805656, 'recall': 0.46120879813449295, 'f1-score': 0.44711920327488236, 'support': 15867}, 'accuracy': 0.42128734622144115, 'macro avg': {'precision': 0.42074719318678405, 'recall': 0.4203032317884885, 'f1-score': 0.41967336656653353, 'support': 45520}, 'weighted avg': {'precision': 0.42104274381135864, 'recall': 0.42128734622144115, 'f1-score': 0.42032412273339204, 'support': 45520}}
[[5391 4778 4626]
 [3467 6468 4923]
 [4061 4488 7318]]
training model: results/CHTR/W0/deepLOB_L2/h20
Epoch 1/50
486/486 - 27s - loss: 3.3197 - accuracy20: 0.3593 - val_loss: 3.3509 - val_accuracy20: 0.3404 - 27s/epoch - 56ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2871 - accuracy20: 0.3638 - val_loss: 3.3220 - val_accuracy20: 0.3517 - 24s/epoch - 50ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2680 - accuracy20: 0.3773 - val_loss: 3.3022 - val_accuracy20: 0.3701 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2572 - accuracy20: 0.3833 - val_loss: 3.2860 - val_accuracy20: 0.3820 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 24s - loss: 3.2456 - accuracy20: 0.3940 - val_loss: 3.2814 - val_accuracy20: 0.3858 - 24s/epoch - 49ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2340 - accuracy20: 0.4009 - val_loss: 3.2831 - val_accuracy20: 0.3853 - 24s/epoch - 49ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2253 - accuracy20: 0.4081 - val_loss: 3.2740 - val_accuracy20: 0.3881 - 24s/epoch - 49ms/step
Epoch 8/50
486/486 - 24s - loss: 3.2156 - accuracy20: 0.4143 - val_loss: 3.2713 - val_accuracy20: 0.3942 - 24s/epoch - 49ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2065 - accuracy20: 0.4194 - val_loss: 3.2686 - val_accuracy20: 0.4013 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 24s - loss: 3.1999 - accuracy20: 0.4226 - val_loss: 3.2933 - val_accuracy20: 0.3965 - 24s/epoch - 50ms/step
Epoch 11/50
486/486 - 24s - loss: 3.1904 - accuracy20: 0.4293 - val_loss: 3.2965 - val_accuracy20: 0.3976 - 24s/epoch - 50ms/step
Epoch 12/50
486/486 - 24s - loss: 3.1851 - accuracy20: 0.4319 - val_loss: 3.3072 - val_accuracy20: 0.3966 - 24s/epoch - 50ms/step
Epoch 13/50
486/486 - 24s - loss: 3.1793 - accuracy20: 0.4354 - val_loss: 3.2857 - val_accuracy20: 0.4013 - 24s/epoch - 49ms/step
Epoch 14/50
486/486 - 24s - loss: 3.1722 - accuracy20: 0.4385 - val_loss: 3.2968 - val_accuracy20: 0.4043 - 24s/epoch - 49ms/step
Epoch 15/50
486/486 - 24s - loss: 3.1645 - accuracy20: 0.4418 - val_loss: 3.2909 - val_accuracy20: 0.3969 - 24s/epoch - 49ms/step
Epoch 16/50
486/486 - 24s - loss: 3.1560 - accuracy20: 0.4442 - val_loss: 3.3005 - val_accuracy20: 0.3963 - 24s/epoch - 49ms/step
Epoch 17/50
486/486 - 24s - loss: 3.1505 - accuracy20: 0.4469 - val_loss: 3.3188 - val_accuracy20: 0.3946 - 24s/epoch - 49ms/step
Epoch 18/50
486/486 - 24s - loss: 3.1439 - accuracy20: 0.4494 - val_loss: 3.3393 - val_accuracy20: 0.3914 - 24s/epoch - 49ms/step
Epoch 19/50
486/486 - 24s - loss: 3.1365 - accuracy20: 0.4525 - val_loss: 3.3121 - val_accuracy20: 0.3996 - 24s/epoch - 49ms/step
testing model: results/CHTR/W0/deepLOB_L2/h20
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1009508
{'0': {'precision': 0.3994211711053293, 'recall': 0.36296578350807596, 'f1-score': 0.38032187576838683, 'support': 112928}, '1': {'precision': 0.3403558200639463, 'recall': 0.2145344254771478, 'f1-score': 0.26318011859811885, 'support': 100231}, '2': {'precision': 0.3911615764476457, 'recall': 0.5571524573271807, 'f1-score': 0.45962967069519906, 'support': 111605}, 'accuracy': 0.38388799251148525, 'macro avg': {'precision': 0.3769795225389738, 'recall': 0.3782175554374681, 'f1-score': 0.3677105550205682, 'support': 324764}, 'weighted avg': {'precision': 0.3783535919955769, 'recall': 0.38388799251148525, 'f1-score': 0.3714228321239981, 'support': 324764}}
[[40989 22971 48968]
 [30912 21503 47816]
 [30720 18704 62181]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0942624
{'0': {'precision': 0.41026124326158253, 'recall': 0.26384309542280837, 'f1-score': 0.32115086683880484, 'support': 41248}, '1': {'precision': 0.38036649214659685, 'recall': 0.28231408170204497, 'f1-score': 0.32408620737725485, 'support': 41174}, '2': {'precision': 0.38092544068604095, 'recall': 0.6116224033657639, 'f1-score': 0.4694635829029091, 'support': 41833}, 'accuracy': 0.38705082290451087, 'macro avg': {'precision': 0.3905177253647401, 'recall': 0.38592652683020573, 'f1-score': 0.37156688570632296, 'support': 124255}, 'weighted avg': {'precision': 0.39047860987418526, 'recall': 0.38705082290451087, 'f1-score': 0.3720560663272746, 'support': 124255}}
[[10883 10007 20358]
 [ 8326 11624 21224]
 [ 7318  8929 25586]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0895386
{'0': {'precision': 0.40326875401707835, 'recall': 0.2941925112197736, 'f1-score': 0.34020139426800927, 'support': 14929}, '1': {'precision': 0.4122173665209956, 'recall': 0.2886124783823334, 'f1-score': 0.3395148669796557, 'support': 15034}, '2': {'precision': 0.39870555532506324, 'recall': 0.617728353795719, 'f1-score': 0.48461926374180525, 'support': 15557}, 'accuracy': 0.40292179261862915, 'macro avg': {'precision': 0.4047305586210457, 'recall': 0.40017778113260866, 'f1-score': 0.38811184166315676, 'support': 45520}, 'weighted avg': {'precision': 0.40466470652877023, 'recall': 0.40292179261862915, 'f1-score': 0.38933117335743667, 'support': 45520}}
[[4392 3352 7185]
 [3387 4339 7308]
 [3112 2835 9610]]
training model: results/CHTR/W0/deepLOB_L2/h30
Epoch 1/50
486/486 - 26s - loss: 3.3202 - accuracy30: 0.3578 - val_loss: 3.3511 - val_accuracy30: 0.3396 - 26s/epoch - 54ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2874 - accuracy30: 0.3649 - val_loss: 3.3362 - val_accuracy30: 0.3483 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2704 - accuracy30: 0.3770 - val_loss: 3.3194 - val_accuracy30: 0.3614 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2603 - accuracy30: 0.3837 - val_loss: 3.3103 - val_accuracy30: 0.3633 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 24s - loss: 3.2516 - accuracy30: 0.3899 - val_loss: 3.2979 - val_accuracy30: 0.3737 - 24s/epoch - 49ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2407 - accuracy30: 0.3965 - val_loss: 3.2955 - val_accuracy30: 0.3785 - 24s/epoch - 49ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2335 - accuracy30: 0.4008 - val_loss: 3.2894 - val_accuracy30: 0.3812 - 24s/epoch - 50ms/step
Epoch 8/50
486/486 - 24s - loss: 3.2276 - accuracy30: 0.4056 - val_loss: 3.2747 - val_accuracy30: 0.3854 - 24s/epoch - 50ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2212 - accuracy30: 0.4118 - val_loss: 3.2802 - val_accuracy30: 0.3895 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 24s - loss: 3.2164 - accuracy30: 0.4138 - val_loss: 3.2771 - val_accuracy30: 0.3880 - 24s/epoch - 49ms/step
Epoch 11/50
486/486 - 24s - loss: 3.2079 - accuracy30: 0.4178 - val_loss: 3.2727 - val_accuracy30: 0.3925 - 24s/epoch - 49ms/step
Epoch 12/50
486/486 - 24s - loss: 3.1986 - accuracy30: 0.4234 - val_loss: 3.2712 - val_accuracy30: 0.3943 - 24s/epoch - 49ms/step
Epoch 13/50
486/486 - 24s - loss: 3.1920 - accuracy30: 0.4269 - val_loss: 3.2705 - val_accuracy30: 0.3932 - 24s/epoch - 49ms/step
Epoch 14/50
486/486 - 24s - loss: 3.1842 - accuracy30: 0.4305 - val_loss: 3.2694 - val_accuracy30: 0.3907 - 24s/epoch - 49ms/step
Epoch 15/50
486/486 - 24s - loss: 3.1768 - accuracy30: 0.4349 - val_loss: 3.2742 - val_accuracy30: 0.3908 - 24s/epoch - 49ms/step
Epoch 16/50
486/486 - 24s - loss: 3.1718 - accuracy30: 0.4367 - val_loss: 3.2852 - val_accuracy30: 0.3878 - 24s/epoch - 49ms/step
Epoch 17/50
486/486 - 24s - loss: 3.1662 - accuracy30: 0.4398 - val_loss: 3.2920 - val_accuracy30: 0.3880 - 24s/epoch - 49ms/step
Epoch 18/50
486/486 - 24s - loss: 3.1609 - accuracy30: 0.4418 - val_loss: 3.2904 - val_accuracy30: 0.3901 - 24s/epoch - 49ms/step
Epoch 19/50
486/486 - 24s - loss: 3.1535 - accuracy30: 0.4446 - val_loss: 3.2953 - val_accuracy30: 0.3885 - 24s/epoch - 49ms/step
Epoch 20/50
486/486 - 24s - loss: 3.1484 - accuracy30: 0.4468 - val_loss: 3.3085 - val_accuracy30: 0.3834 - 24s/epoch - 49ms/step
Epoch 21/50
486/486 - 24s - loss: 3.1431 - accuracy30: 0.4489 - val_loss: 3.3036 - val_accuracy30: 0.3880 - 24s/epoch - 49ms/step
Epoch 22/50
486/486 - 24s - loss: 3.1350 - accuracy30: 0.4526 - val_loss: 3.3341 - val_accuracy30: 0.3776 - 24s/epoch - 49ms/step
Epoch 23/50
486/486 - 24s - loss: 3.1301 - accuracy30: 0.4541 - val_loss: 3.3174 - val_accuracy30: 0.3880 - 24s/epoch - 49ms/step
Epoch 24/50
486/486 - 24s - loss: 3.1241 - accuracy30: 0.4558 - val_loss: 3.3383 - val_accuracy30: 0.3859 - 24s/epoch - 50ms/step
testing model: results/CHTR/W0/deepLOB_L2/h30
Evaluating performance on  test set...
1269/1269 - 25s - 25s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0954785
{'0': {'precision': 0.39337218404801255, 'recall': 0.40819899994584546, 'f1-score': 0.4006484647685194, 'support': 110794}, '1': {'precision': 0.3692586035834484, 'recall': 0.18175985597870323, 'f1-score': 0.2436085014631141, 'support': 104429}, '2': {'precision': 0.38057717925892254, 'recall': 0.5502962361125058, 'f1-score': 0.44996491647134346, 'support': 109541}, 'accuracy': 0.3833152689337488, 'macro avg': {'precision': 0.3810693222967945, 'recall': 0.38008503067901817, 'f1-score': 0.364740627567659, 'support': 324764}, 'weighted avg': {'precision': 0.3813026975472438, 'recall': 0.3833152689337488, 'f1-score': 0.36678586641389543, 'support': 324764}}
[[45226 17270 48298]
 [35635 18981 49813]
 [34109 15152 60280]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0823402
{'0': {'precision': 0.4113726724063957, 'recall': 0.34839272304449986, 'f1-score': 0.3772723695600849, 'support': 41281}, '1': {'precision': 0.4131949125881983, 'recall': 0.2236547630631507, 'f1-score': 0.2902192269448697, 'support': 41108}, '2': {'precision': 0.3837387945050192, 'recall': 0.614508192805618, 'f1-score': 0.47244947616817706, 'support': 41866}, 'accuracy': 0.39678886161522675, 'macro avg': {'precision': 0.40276879316653774, 'recall': 0.3955185596377562, 'f1-score': 0.37998035755771054, 'support': 124255}, 'weighted avg': {'precision': 0.4026646825240932, 'recall': 0.39678886161522675, 'f1-score': 0.38054068197107943, 'support': 124255}}
[[14382  6582 20317]
 [10915  9194 20999]
 [ 9664  6475 25727]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0890656
{'0': {'precision': 0.381275953189883, 'recall': 0.40480961923847697, 'f1-score': 0.3926905132192846, 'support': 14970}, '1': {'precision': 0.4187747272509291, 'recall': 0.22975728474643162, 'f1-score': 0.29672103295956503, 'support': 15203}, '2': {'precision': 0.3930467465351186, 'recall': 0.5451228253078778, 'f1-score': 0.4567591177112907, 'support': 15347}, 'accuracy': 0.3936511423550088, 'macro avg': {'precision': 0.39769914232531023, 'recall': 0.39322990976426214, 'f1-score': 0.3820568879633801, 'support': 45520}, 'weighted avg': {'precision': 0.39776848894382444, 'recall': 0.3936511423550088, 'f1-score': 0.382238774747191, 'support': 45520}}
[[6060 2578 6332]
 [5123 3493 6587]
 [4711 2270 8366]]
training model: results/CHTR/W0/deepLOB_L2/h50
Epoch 1/50
486/486 - 26s - loss: 3.3216 - accuracy50: 0.3574 - val_loss: 3.3501 - val_accuracy50: 0.3379 - 26s/epoch - 54ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2889 - accuracy50: 0.3658 - val_loss: 3.3331 - val_accuracy50: 0.3410 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2736 - accuracy50: 0.3736 - val_loss: 3.3246 - val_accuracy50: 0.3482 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2626 - accuracy50: 0.3803 - val_loss: 3.3198 - val_accuracy50: 0.3522 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 24s - loss: 3.2522 - accuracy50: 0.3872 - val_loss: 3.3264 - val_accuracy50: 0.3532 - 24s/epoch - 49ms/step
Epoch 6/50
486/486 - 23s - loss: 3.2435 - accuracy50: 0.3925 - val_loss: 3.3583 - val_accuracy50: 0.3496 - 23s/epoch - 48ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2379 - accuracy50: 0.3996 - val_loss: 3.3386 - val_accuracy50: 0.3561 - 24s/epoch - 48ms/step
Epoch 8/50
486/486 - 23s - loss: 3.2314 - accuracy50: 0.4001 - val_loss: 3.3830 - val_accuracy50: 0.3514 - 23s/epoch - 48ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2264 - accuracy50: 0.4045 - val_loss: 3.3465 - val_accuracy50: 0.3580 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 23s - loss: 3.2212 - accuracy50: 0.4090 - val_loss: 3.3807 - val_accuracy50: 0.3537 - 23s/epoch - 48ms/step
Epoch 11/50
486/486 - 24s - loss: 3.2151 - accuracy50: 0.4116 - val_loss: 3.3771 - val_accuracy50: 0.3592 - 24s/epoch - 49ms/step
Epoch 12/50
486/486 - 23s - loss: 3.2102 - accuracy50: 0.4146 - val_loss: 3.3622 - val_accuracy50: 0.3614 - 23s/epoch - 48ms/step
Epoch 13/50
486/486 - 24s - loss: 3.2053 - accuracy50: 0.4187 - val_loss: 3.3851 - val_accuracy50: 0.3583 - 24s/epoch - 48ms/step
Epoch 14/50
486/486 - 24s - loss: 3.2011 - accuracy50: 0.4210 - val_loss: 3.3931 - val_accuracy50: 0.3577 - 24s/epoch - 49ms/step
testing model: results/CHTR/W0/deepLOB_L2/h50
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1052334
{'0': {'precision': 0.3557548686288177, 'recall': 0.4636913977398092, 'f1-score': 0.4026144948301746, 'support': 107867}, '1': {'precision': 0.3169487485101311, 'recall': 0.06065804120513148, 'f1-score': 0.10182809616076831, 'support': 109598}, '2': {'precision': 0.35491283433928733, 'recall': 0.5397999981360497, 'f1-score': 0.4282534917595215, 'support': 107299}, 'accuracy': 0.35282543631683316, 'macro avg': {'precision': 0.3425388171594121, 'recall': 0.3547164790269968, 'f1-score': 0.3108986942501548, 'support': 324764}, 'weighted avg': {'precision': 0.3423807797827629, 'recall': 0.35282543631683316, 'f1-score': 0.3095790937701815, 'support': 324764}}
[[50017  7364 50486]
 [48161  6648 54789]
 [42416  6963 57920]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1021501
{'0': {'precision': 0.36491077090316154, 'recall': 0.3904099631711572, 'f1-score': 0.37722994802640825, 'support': 41272}, '1': {'precision': 0.3252561912894962, 'recall': 0.0741308420309953, 'f1-score': 0.12074260466406453, 'support': 41103}, '2': {'precision': 0.36169430659823837, 'recall': 0.6108643744030563, 'f1-score': 0.4543605864435978, 'support': 41880}, 'accuracy': 0.3600901372178182, 'macro avg': {'precision': 0.3506204229302987, 'recall': 0.3584683932017363, 'f1-score': 0.31744437971135686, 'support': 124255}, 'weighted avg': {'precision': 0.3507091073004842, 'recall': 0.3600901372178182, 'f1-score': 0.31838186837319093, 'support': 124255}}
[[16113  3339 21820]
 [14728  3047 23328]
 [13315  2982 25583]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1063349
{'0': {'precision': 0.3472978972434112, 'recall': 0.5753543728269591, 'f1-score': 0.43314121762766467, 'support': 14956}, '1': {'precision': 0.3596757852077001, 'recall': 0.023485048954749933, 'f1-score': 0.04409116313730361, 'support': 15116}, '2': {'precision': 0.3528042113788216, 'recall': 0.4511910926980839, 'f1-score': 0.39597772980343143, 'support': 15448}, 'accuracy': 0.3499560632688928, 'macro avg': {'precision': 0.35325929794331096, 'recall': 0.35001017149326435, 'f1-score': 0.29107003685613325, 'support': 45520}, 'weighted avg': {'precision': 0.3532769327274185, 'recall': 0.3499560632688928, 'f1-score': 0.2913358093766749, 'support': 45520}}
[[8605  351 6000]
 [7975  355 6786]
 [8197  281 6970]]
training model: results/CHTR/W0/deepLOB_L2/h100
Epoch 1/50
486/486 - 27s - loss: 3.3221 - accuracy100: 0.3599 - val_loss: 3.3357 - val_accuracy100: 0.3376 - 27s/epoch - 56ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2908 - accuracy100: 0.3674 - val_loss: 3.3361 - val_accuracy100: 0.3371 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2795 - accuracy100: 0.3685 - val_loss: 3.3207 - val_accuracy100: 0.3465 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2705 - accuracy100: 0.3729 - val_loss: 3.3276 - val_accuracy100: 0.3451 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 24s - loss: 3.2625 - accuracy100: 0.3810 - val_loss: 3.3425 - val_accuracy100: 0.3392 - 24s/epoch - 49ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2581 - accuracy100: 0.3834 - val_loss: 3.3474 - val_accuracy100: 0.3404 - 24s/epoch - 49ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2537 - accuracy100: 0.3886 - val_loss: 3.3474 - val_accuracy100: 0.3462 - 24s/epoch - 49ms/step
Epoch 8/50
486/486 - 25s - loss: 3.2478 - accuracy100: 0.3938 - val_loss: 3.3506 - val_accuracy100: 0.3434 - 25s/epoch - 51ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2443 - accuracy100: 0.3958 - val_loss: 3.3661 - val_accuracy100: 0.3455 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 23s - loss: 3.2403 - accuracy100: 0.3989 - val_loss: 3.3701 - val_accuracy100: 0.3442 - 23s/epoch - 48ms/step
Epoch 11/50
486/486 - 24s - loss: 3.2339 - accuracy100: 0.4020 - val_loss: 3.3799 - val_accuracy100: 0.3466 - 24s/epoch - 48ms/step
Epoch 12/50
486/486 - 23s - loss: 3.2283 - accuracy100: 0.4063 - val_loss: 3.3805 - val_accuracy100: 0.3456 - 23s/epoch - 48ms/step
Epoch 13/50
486/486 - 23s - loss: 3.2214 - accuracy100: 0.4097 - val_loss: 3.3802 - val_accuracy100: 0.3503 - 23s/epoch - 48ms/step
testing model: results/CHTR/W0/deepLOB_L2/h100
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1124513
{'0': {'precision': 0.3407169088465324, 'recall': 0.3130463531081962, 'f1-score': 0.3262960522981807, 'support': 102841}, '1': {'precision': 0.3802672147995889, 'recall': 0.006296586229195739, 'f1-score': 0.012388047208504229, 'support': 117524}, '2': {'precision': 0.3213389451186665, 'recall': 0.7027940880659777, 'f1-score': 0.4410269048592244, 'support': 104399}, 'accuracy': 0.3273299996305009, 'macro avg': {'precision': 0.3474410229215959, 'recall': 0.34071234246778986, 'f1-score': 0.2599036681219698, 'support': 324764}, 'weighted avg': {'precision': 0.34879991718982645, 'recall': 0.3273299996305009, 'f1-score': 0.24958207502964497, 'support': 324764}}
[[32194   602 70045]
 [31871   740 84913]
 [30424   604 73371]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1121447
{'0': {'precision': 0.358431214106375, 'recall': 0.3026463277937521, 'f1-score': 0.3281850731281956, 'support': 41038}, '1': {'precision': 0.2276614567974049, 'recall': 0.018792599805258034, 'f1-score': 0.034719255244991115, 'support': 41080}, '2': {'precision': 0.3528238200735388, 'recall': 0.7218833804020219, 'f1-score': 0.4739851967276977, 'support': 42137}, 'accuracy': 0.3509717918796024, 'macro avg': {'precision': 0.31297216365910624, 'recall': 0.3477741026670107, 'f1-score': 0.27896317503362816, 'support': 124255}, 'weighted avg': {'precision': 0.3132958039207558, 'recall': 0.3509717918796024, 'f1-score': 0.2806055311336697, 'support': 124255}}
[[12420  1243 27375]
 [11888   772 28420]
 [10343  1376 30418]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1057262
{'0': {'precision': 0.33615776844631073, 'recall': 0.30523592292503576, 'f1-score': 0.31995146843664135, 'support': 14687}, '1': {'precision': 0.30097087378640774, 'recall': 0.0020261437908496733, 'f1-score': 0.004025189898071804, 'support': 15300}, '2': {'precision': 0.34986440572301364, 'recall': 0.7225906135324792, 'f1-score': 0.4714579745453018, 'support': 15533}, 'accuracy': 0.34573813708260104, 'macro avg': {'precision': 0.3289976826519107, 'recall': 0.3432842267494549, 'f1-score': 0.26514487762667166, 'support': 45520}, 'weighted avg': {'precision': 0.3290080696001444, 'recall': 0.34573813708260104, 'f1-score': 0.26546285898465777, 'support': 45520}}
[[ 4483    30 10174]
 [ 4586    31 10683]
 [ 4267    42 11224]]
training model: results/CHTR/W0/deepLOB_L2/h200
Epoch 1/50
486/486 - 27s - loss: 3.3258 - accuracy200: 0.3606 - val_loss: 3.3249 - val_accuracy200: 0.3410 - 27s/epoch - 55ms/step
Epoch 2/50
486/486 - 23s - loss: 3.2935 - accuracy200: 0.3667 - val_loss: 3.3437 - val_accuracy200: 0.3393 - 23s/epoch - 48ms/step
Epoch 3/50
486/486 - 23s - loss: 3.2863 - accuracy200: 0.3687 - val_loss: 3.3447 - val_accuracy200: 0.3349 - 23s/epoch - 48ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2763 - accuracy200: 0.3723 - val_loss: 3.3292 - val_accuracy200: 0.3394 - 24s/epoch - 49ms/step
Epoch 5/50
486/486 - 23s - loss: 3.2677 - accuracy200: 0.3751 - val_loss: 3.3382 - val_accuracy200: 0.3395 - 23s/epoch - 48ms/step
Epoch 6/50
486/486 - 23s - loss: 3.2577 - accuracy200: 0.3848 - val_loss: 3.3673 - val_accuracy200: 0.3400 - 23s/epoch - 48ms/step
Epoch 7/50
486/486 - 23s - loss: 3.2507 - accuracy200: 0.3901 - val_loss: 3.3413 - val_accuracy200: 0.3442 - 23s/epoch - 48ms/step
Epoch 8/50
486/486 - 24s - loss: 3.2434 - accuracy200: 0.3938 - val_loss: 3.3467 - val_accuracy200: 0.3461 - 24s/epoch - 48ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2373 - accuracy200: 0.3986 - val_loss: 3.3920 - val_accuracy200: 0.3395 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 23s - loss: 3.2287 - accuracy200: 0.4038 - val_loss: 3.3479 - val_accuracy200: 0.3411 - 23s/epoch - 48ms/step
Epoch 11/50
486/486 - 23s - loss: 3.2229 - accuracy200: 0.4090 - val_loss: 3.3709 - val_accuracy200: 0.3388 - 23s/epoch - 48ms/step
testing model: results/CHTR/W0/deepLOB_L2/h200
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1153024
{'0': {'precision': 0.32081140284158327, 'recall': 0.4132481605220101, 'f1-score': 0.3612097129864736, 'support': 102067}, '1': {'precision': 0.37499440840975173, 'recall': 0.14397224631396358, 'f1-score': 0.20806264465168806, 'support': 116453}, '2': {'precision': 0.3238702903525421, 'recall': 0.45291969428861867, 'f1-score': 0.37767539694374896, 'support': 106244}, 'accuracy': 0.32967016048576814, 'macro avg': {'precision': 0.339892033867959, 'recall': 0.33671336704153076, 'f1-score': 0.31564925152730355, 'support': 324764}, 'weighted avg': {'precision': 0.3412408900758341, 'recall': 0.32967016048576814, 'f1-score': 0.31168126949386354, 'support': 324764}}
[[42179 13790 46098]
 [45327 16766 54360]
 [43970 14154 48120]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1109518
{'0': {'precision': 0.345868052572803, 'recall': 0.3917061899550043, 'f1-score': 0.3673627664549094, 'support': 41115}, '1': {'precision': 0.33807276076444853, 'recall': 0.14345033096407026, 'f1-score': 0.20143021281703907, 'support': 40941}, '2': {'precision': 0.3465574694540692, 'recall': 0.49536718879594305, 'f1-score': 0.4078113111843774, 'support': 42199}, 'accuracy': 0.34511287272141966, 'macro avg': {'precision': 0.3434994275971069, 'recall': 0.3435079032383392, 'f1-score': 0.32553476348544197, 'support': 124255}, 'weighted avg': {'precision': 0.34353370515054, 'recall': 0.34511287272141966, 'f1-score': 0.3264263329958999, 'support': 124255}}
[[16105  5589 19421]
 [15074  5873 19994]
 [15385  5910 20904]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1083549
{'0': {'precision': 0.3242206951498855, 'recall': 0.4450444292549556, 'f1-score': 0.37514404240608434, 'support': 14630}, '1': {'precision': 0.3709891779001329, 'recall': 0.1307373210223471, 'f1-score': 0.19334091921040916, 'support': 14946}, '2': {'precision': 0.35764215953596745, 'recall': 0.4524586051179127, 'f1-score': 0.3995015921362315, 'support': 15944}, 'accuracy': 0.3444420035149385, 'macro avg': {'precision': 0.350950677528662, 'recall': 0.34274678513173845, 'f1-score': 0.3226621845842417, 'support': 45520}, 'weighted avg': {'precision': 0.35128294408127586, 'recall': 0.3444420035149385, 'f1-score': 0.32398251546440826, 'support': 45520}}
[[6511 1637 6482]
 [6517 1954 6475]
 [7054 1676 7214]]
training model: results/CHTR/W0/deepLOB_L2/h300
Epoch 1/50
486/486 - 27s - loss: 3.3226 - accuracy300: 0.3606 - val_loss: 3.3652 - val_accuracy300: 0.3289 - 27s/epoch - 56ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2880 - accuracy300: 0.3733 - val_loss: 3.3461 - val_accuracy300: 0.3256 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2774 - accuracy300: 0.3774 - val_loss: 3.3702 - val_accuracy300: 0.3254 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 24s - loss: 3.2676 - accuracy300: 0.3813 - val_loss: 3.3739 - val_accuracy300: 0.3388 - 24s/epoch - 48ms/step
Epoch 5/50
486/486 - 23s - loss: 3.2566 - accuracy300: 0.3930 - val_loss: 3.3720 - val_accuracy300: 0.3380 - 23s/epoch - 48ms/step
Epoch 6/50
486/486 - 23s - loss: 3.2522 - accuracy300: 0.3961 - val_loss: 3.3839 - val_accuracy300: 0.3395 - 23s/epoch - 48ms/step
Epoch 7/50
486/486 - 23s - loss: 3.2480 - accuracy300: 0.3943 - val_loss: 3.3589 - val_accuracy300: 0.3381 - 23s/epoch - 48ms/step
Epoch 8/50
486/486 - 23s - loss: 3.2382 - accuracy300: 0.4012 - val_loss: 3.4083 - val_accuracy300: 0.3345 - 23s/epoch - 48ms/step
Epoch 9/50
486/486 - 24s - loss: 3.2274 - accuracy300: 0.4077 - val_loss: 3.3830 - val_accuracy300: 0.3362 - 24s/epoch - 48ms/step
Epoch 10/50
486/486 - 23s - loss: 3.2213 - accuracy300: 0.4124 - val_loss: 3.4152 - val_accuracy300: 0.3366 - 23s/epoch - 48ms/step
Epoch 11/50
486/486 - 24s - loss: 3.2080 - accuracy300: 0.4204 - val_loss: 3.4097 - val_accuracy300: 0.3403 - 24s/epoch - 49ms/step
Epoch 12/50
486/486 - 24s - loss: 3.1991 - accuracy300: 0.4252 - val_loss: 3.4170 - val_accuracy300: 0.3371 - 24s/epoch - 49ms/step
testing model: results/CHTR/W0/deepLOB_L2/h300
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1195707
{'0': {'precision': 0.31707139210967694, 'recall': 0.6031050915972298, 'f1-score': 0.4156319453216484, 'support': 100931}, '1': {'precision': 0.3488372093023256, 'recall': 0.038982355354944605, 'f1-score': 0.07012795275590551, 'support': 116976}, '2': {'precision': 0.3479241500292373, 'recall': 0.3897732483599577, 'f1-score': 0.36766166299593495, 'support': 106857}, 'accuracy': 0.32972250618910964, 'macro avg': {'precision': 0.3379442504804133, 'recall': 0.343953565104044, 'f1-score': 0.2844738536911629, 'support': 324764}, 'weighted avg': {'precision': 0.33866452245952405, 'recall': 0.32972250618910964, 'f1-score': 0.27540200760426253, 'support': 324764}}
[[60872  3874 36185]
 [70541  4560 41875]
 [60569  4638 41650]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1163013
{'0': {'precision': 0.3381713313161876, 'recall': 0.5206094276911133, 'f1-score': 0.410011941724385, 'support': 41219}, '1': {'precision': 0.3438584316446912, 'recall': 0.048315538003997856, 'f1-score': 0.08472620014534263, 'support': 41022}, '2': {'precision': 0.3426001635322976, 'recall': 0.44877897843575953, 'f1-score': 0.3885666003771291, 'support': 42014}, 'accuracy': 0.34039676471771757, 'macro avg': {'precision': 0.3415433088310588, 'recall': 0.33923464804362363, 'f1-score': 0.29443491408228556, 'support': 124255}, 'weighted avg': {'precision': 0.341546400218071, 'recall': 0.34039676471771757, 'f1-score': 0.2953696636476953, 'support': 124255}}
[[21459  1835 17925]
 [20785  1982 18255]
 [21212  1947 18855]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151398
{'0': {'precision': 0.3237308868501529, 'recall': 0.7221009549795362, 'f1-score': 0.4470439189189189, 'support': 14660}, '1': {'precision': 0.3446993180409175, 'recall': 0.037461258590486456, 'f1-score': 0.06757824369492556, 'support': 14842}, '2': {'precision': 0.3302400285535826, 'recall': 0.23105256586340367, 'f1-score': 0.2718824609733701, 'support': 16018}, 'accuracy': 0.32607644991212653, 'macro avg': {'precision': 0.33289007781488433, 'recall': 0.3302049264778088, 'f1-score': 0.26216820786240486, 'support': 45520}, 'weighted avg': {'precision': 0.3328582349946798, 'recall': 0.32607644991212653, 'f1-score': 0.2616799956973392, 'support': 45520}}
[[10586   517  3557]
 [10337   556  3949]
 [11777   540  3701]]
training model: results/CHTR/W0/deepLOB_L2/h500
Epoch 1/50
486/486 - 26s - loss: 3.3201 - accuracy500: 0.3673 - val_loss: 3.4342 - val_accuracy500: 0.3283 - 26s/epoch - 53ms/step
Epoch 2/50
486/486 - 24s - loss: 3.2874 - accuracy500: 0.3785 - val_loss: 3.3547 - val_accuracy500: 0.3281 - 24s/epoch - 49ms/step
Epoch 3/50
486/486 - 24s - loss: 3.2714 - accuracy500: 0.3833 - val_loss: 3.3665 - val_accuracy500: 0.3276 - 24s/epoch - 49ms/step
Epoch 4/50
486/486 - 23s - loss: 3.2590 - accuracy500: 0.3868 - val_loss: 3.4604 - val_accuracy500: 0.3331 - 23s/epoch - 48ms/step
Epoch 5/50
486/486 - 23s - loss: 3.2447 - accuracy500: 0.3992 - val_loss: 3.4493 - val_accuracy500: 0.3358 - 23s/epoch - 48ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2282 - accuracy500: 0.4073 - val_loss: 3.4969 - val_accuracy500: 0.3342 - 24s/epoch - 48ms/step
Epoch 7/50
486/486 - 24s - loss: 3.2132 - accuracy500: 0.4161 - val_loss: 3.4931 - val_accuracy500: 0.3339 - 24s/epoch - 49ms/step
Epoch 8/50
486/486 - 24s - loss: 3.2066 - accuracy500: 0.4209 - val_loss: 3.4900 - val_accuracy500: 0.3348 - 24s/epoch - 50ms/step
Epoch 9/50
486/486 - 23s - loss: 3.1965 - accuracy500: 0.4263 - val_loss: 3.4987 - val_accuracy500: 0.3331 - 23s/epoch - 48ms/step
Epoch 10/50
486/486 - 23s - loss: 3.1908 - accuracy500: 0.4279 - val_loss: 3.5934 - val_accuracy500: 0.3307 - 23s/epoch - 48ms/step
Epoch 11/50
486/486 - 23s - loss: 3.1791 - accuracy500: 0.4308 - val_loss: 3.6067 - val_accuracy500: 0.3294 - 23s/epoch - 48ms/step
Epoch 12/50
486/486 - 23s - loss: 3.1637 - accuracy500: 0.4397 - val_loss: 3.6393 - val_accuracy500: 0.3214 - 23s/epoch - 48ms/step
testing model: results/CHTR/W0/deepLOB_L2/h500
Evaluating performance on  test set...
1269/1269 - 23s - 23s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1344886
{'0': {'precision': 0.3071551450948436, 'recall': 0.26996995802081053, 'f1-score': 0.287364598002986, 'support': 100526}, '1': {'precision': 0.3261044896496102, 'recall': 0.030913384756532672, 'f1-score': 0.0564733268671193, 'support': 117716}, '2': {'precision': 0.3195663465764554, 'recall': 0.6757477328626951, 'f1-score': 0.4339258102727484, 'support': 106522}, 'accuracy': 0.3164143809042874, 'macro avg': {'precision': 0.31760866044030306, 'recall': 0.32554369188001275, 'f1-score': 0.25925457838095123, 'support': 324764}, 'weighted avg': {'precision': 0.31809449504691084, 'recall': 0.3164143809042874, 'f1-score': 0.25174610759262633, 'support': 324764}}
[[27139  2935 70452]
 [31262  3639 82815]
 [29955  4585 71982]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1160315
{'0': {'precision': 0.35469020320792893, 'recall': 0.2910771007796708, 'f1-score': 0.3197504592976381, 'support': 41556}, '1': {'precision': 0.28983228511530396, 'recall': 0.040424961621871876, 'f1-score': 0.07095353163826101, 'support': 41039}, '2': {'precision': 0.33443881176860757, 'recall': 0.6777724435909745, 'f1-score': 0.4478776727365015, 'support': 41660}, 'accuracy': 0.33794213512534704, 'macro avg': {'precision': 0.32632043336394684, 'recall': 0.33642483533083906, 'f1-score': 0.27952722122413354, 'support': 124255}, 'weighted avg': {'precision': 0.326479048180241, 'recall': 0.33794213512534704, 'f1-score': 0.2805359616729942, 'support': 124255}}
[[12096  2168 27292]
 [10480  1659 28900]
 [11527  1897 28236]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1173537
{'0': {'precision': 0.32634691195795007, 'recall': 0.34347555494087545, 'f1-score': 0.3346922273508305, 'support': 14461}, '1': {'precision': 0.2835085413929041, 'recall': 0.057061623909018776, 'f1-score': 0.0950022016732717, 'support': 15124}, '2': {'precision': 0.33460522453771646, 'recall': 0.5723250705993097, 'f1-score': 0.4223102035146211, 'support': 15935}, 'accuracy': 0.32842706502636204, 'macro avg': {'precision': 0.3148202259628569, 'recall': 0.32428741648306797, 'f1-score': 0.2840015441795744, 'support': 45520}, 'weighted avg': {'precision': 0.3150048358273003, 'recall': 0.32842706502636204, 'f1-score': 0.28572738775993867, 'support': 45520}}
[[4967  962 8532]
 [4657  863 9604]
 [5596 1219 9120]]
training model: results/CHTR/W0/deepLOB_L2/h1000
Epoch 1/50
486/486 - 26s - loss: 3.3176 - accuracy1000: 0.3799 - val_loss: 3.3902 - val_accuracy1000: 0.3293 - 26s/epoch - 54ms/step
Epoch 2/50
486/486 - 23s - loss: 3.2723 - accuracy1000: 0.3838 - val_loss: 3.4321 - val_accuracy1000: 0.3305 - 23s/epoch - 48ms/step
Epoch 3/50
486/486 - 23s - loss: 3.2511 - accuracy1000: 0.3966 - val_loss: 3.4819 - val_accuracy1000: 0.3342 - 23s/epoch - 48ms/step
Epoch 4/50
486/486 - 23s - loss: 3.2377 - accuracy1000: 0.4071 - val_loss: 3.3994 - val_accuracy1000: 0.3300 - 23s/epoch - 48ms/step
Epoch 5/50
486/486 - 23s - loss: 3.2155 - accuracy1000: 0.4143 - val_loss: 3.4770 - val_accuracy1000: 0.3310 - 23s/epoch - 48ms/step
Epoch 6/50
486/486 - 24s - loss: 3.2001 - accuracy1000: 0.4175 - val_loss: 3.5737 - val_accuracy1000: 0.3369 - 24s/epoch - 49ms/step
Epoch 7/50
486/486 - 23s - loss: 3.1887 - accuracy1000: 0.4224 - val_loss: 3.6345 - val_accuracy1000: 0.3330 - 23s/epoch - 48ms/step
Epoch 8/50
486/486 - 24s - loss: 3.1709 - accuracy1000: 0.4284 - val_loss: 3.6078 - val_accuracy1000: 0.3320 - 24s/epoch - 49ms/step
Epoch 9/50
486/486 - 24s - loss: 3.1527 - accuracy1000: 0.4380 - val_loss: 3.6760 - val_accuracy1000: 0.3347 - 24s/epoch - 49ms/step
Epoch 10/50
486/486 - 24s - loss: 3.1435 - accuracy1000: 0.4419 - val_loss: 3.6899 - val_accuracy1000: 0.3332 - 24s/epoch - 49ms/step
Epoch 11/50
486/486 - 24s - loss: 3.1307 - accuracy1000: 0.4485 - val_loss: 3.6794 - val_accuracy1000: 0.3227 - 24s/epoch - 49ms/step
testing model: results/CHTR/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
1269/1269 - 24s - 24s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1472411
{'0': {'precision': 0.31839702401082176, 'recall': 0.31018861708261264, 'f1-score': 0.3142392256664859, 'support': 97128}, '1': {'precision': 0.3475322481073529, 'recall': 0.08529233517272176, 'f1-score': 0.1369692856365371, 'support': 125404}, '2': {'precision': 0.2885891564633357, 'recall': 0.5627787776821348, 'f1-score': 0.38153152406372787, 'support': 102232}, 'accuracy': 0.3028599228978581, 'macro avg': {'precision': 0.31817280952717014, 'recall': 0.3194199099791564, 'f1-score': 0.27758001178891695, 'support': 324764}, 'weighted avg': {'precision': 0.320264089718495, 'recall': 0.3028599228978581, 'f1-score': 0.26697126089893514, 'support': 324764}}
[[30128  7999 59001]
 [31880 10696 82828]
 [32616 12082 57534]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.11335
{'0': {'precision': 0.35866099893730075, 'recall': 0.40580511735282804, 'f1-score': 0.3807793848861611, 'support': 41584}, '1': {'precision': 0.32832012891097084, 'recall': 0.11912302070645554, 'f1-score': 0.17481767481767482, 'support': 41050}, '2': {'precision': 0.3662916659979779, 'recall': 0.5483770212152519, 'f1-score': 0.4392102528576377, 'support': 41621}, 'accuracy': 0.358850750472818, 'macro avg': {'precision': 0.35109093128208313, 'recall': 0.35776838642484515, 'f1-score': 0.3316024375204912, 'support': 124255}, 'weighted avg': {'precision': 0.3511933177908809, 'recall': 0.358850750472818, 'f1-score': 0.33230828076583974, 'support': 124255}}
[[16875  4883 19826]
 [16499  4890 19661]
 [13676  5121 22824]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1302205
{'0': {'precision': 0.3153708566426913, 'recall': 0.5894444839604523, 'f1-score': 0.41089845299484334, 'support': 14059}, '1': {'precision': 0.3325377883850438, 'recall': 0.08091366627951994, 'f1-score': 0.13015724739218434, 'support': 15498}, '2': {'precision': 0.3516675284384695, 'recall': 0.3408507172837186, 'f1-score': 0.34617464609511683, 'support': 15963}, 'accuracy': 0.3291300527240773, 'macro avg': {'precision': 0.33319205782206823, 'recall': 0.3370696225078969, 'f1-score': 0.2957434488273815, 'support': 45520}, 'weighted avg': {'precision': 0.3339441624427569, 'recall': 0.3291300527240773, 'f1-score': 0.29261828309215565, 'support': 45520}}
[[8287 1267 4505]
 [8718 1254 5526]
 [9272 1250 5441]]
training model: results/CHTR/W0/deepOF_L2/h10
Epoch 1/50
486/486 - 18s - loss: 3.2960 - accuracy10: 0.3740 - val_loss: 3.2708 - val_accuracy10: 0.3926 - 18s/epoch - 37ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2426 - accuracy10: 0.4042 - val_loss: 3.2475 - val_accuracy10: 0.4064 - 15s/epoch - 32ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2146 - accuracy10: 0.4179 - val_loss: 3.2333 - val_accuracy10: 0.4131 - 15s/epoch - 32ms/step
Epoch 4/50
486/486 - 15s - loss: 3.1990 - accuracy10: 0.4273 - val_loss: 3.2262 - val_accuracy10: 0.4155 - 15s/epoch - 32ms/step
Epoch 5/50
486/486 - 15s - loss: 3.1873 - accuracy10: 0.4311 - val_loss: 3.2215 - val_accuracy10: 0.4195 - 15s/epoch - 32ms/step
Epoch 6/50
486/486 - 15s - loss: 3.1746 - accuracy10: 0.4371 - val_loss: 3.2173 - val_accuracy10: 0.4205 - 15s/epoch - 32ms/step
Epoch 7/50
486/486 - 15s - loss: 3.1647 - accuracy10: 0.4412 - val_loss: 3.2137 - val_accuracy10: 0.4218 - 15s/epoch - 32ms/step
Epoch 8/50
486/486 - 15s - loss: 3.1567 - accuracy10: 0.4453 - val_loss: 3.2130 - val_accuracy10: 0.4220 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.1459 - accuracy10: 0.4482 - val_loss: 3.2069 - val_accuracy10: 0.4263 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.1392 - accuracy10: 0.4517 - val_loss: 3.2105 - val_accuracy10: 0.4239 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.1312 - accuracy10: 0.4543 - val_loss: 3.2074 - val_accuracy10: 0.4236 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.1228 - accuracy10: 0.4575 - val_loss: 3.2056 - val_accuracy10: 0.4252 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.1141 - accuracy10: 0.4605 - val_loss: 3.2077 - val_accuracy10: 0.4254 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.1073 - accuracy10: 0.4634 - val_loss: 3.2077 - val_accuracy10: 0.4248 - 15s/epoch - 32ms/step
Epoch 15/50
486/486 - 15s - loss: 3.0976 - accuracy10: 0.4677 - val_loss: 3.2116 - val_accuracy10: 0.4241 - 15s/epoch - 32ms/step
Epoch 16/50
486/486 - 15s - loss: 3.0912 - accuracy10: 0.4693 - val_loss: 3.2100 - val_accuracy10: 0.4244 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.0829 - accuracy10: 0.4725 - val_loss: 3.2132 - val_accuracy10: 0.4243 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 16s - loss: 3.0746 - accuracy10: 0.4746 - val_loss: 3.2180 - val_accuracy10: 0.4228 - 16s/epoch - 32ms/step
Epoch 19/50
486/486 - 16s - loss: 3.0675 - accuracy10: 0.4775 - val_loss: 3.2192 - val_accuracy10: 0.4224 - 16s/epoch - 32ms/step
Epoch 20/50
486/486 - 16s - loss: 3.0596 - accuracy10: 0.4808 - val_loss: 3.2229 - val_accuracy10: 0.4207 - 16s/epoch - 32ms/step
Epoch 21/50
486/486 - 15s - loss: 3.0524 - accuracy10: 0.4837 - val_loss: 3.2271 - val_accuracy10: 0.4240 - 15s/epoch - 32ms/step
Epoch 22/50
486/486 - 15s - loss: 3.0451 - accuracy10: 0.4870 - val_loss: 3.2350 - val_accuracy10: 0.4193 - 15s/epoch - 30ms/step
testing model: results/CHTR/W0/deepOF_L2/h10
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.080396
{'0': {'precision': 0.4072277597143009, 'recall': 0.5419496710351309, 'f1-score': 0.4650278088455715, 'support': 112778}, '1': {'precision': 0.41776578228174704, 'recall': 0.24341779914149506, 'f1-score': 0.30760481698819503, 'support': 101106}, '2': {'precision': 0.4116534208707671, 'recall': 0.4297903043968433, 'f1-score': 0.42052639707017897, 'support': 110875}, 'accuracy': 0.41071687004825114, 'macro avg': {'precision': 0.41221565428893836, 'recall': 0.4050525915244898, 'f1-score': 0.39771967430131516, 'support': 324759}, 'weighted avg': {'precision': 0.412019474464092, 'recall': 0.41071687004825114, 'f1-score': 0.400824805863888, 'support': 324759}}
[[61120 16952 34706]
 [43094 24611 33401]
 [45874 17348 47653]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.047752
{'0': {'precision': 0.4284793102177678, 'recall': 0.5638744090192751, 'f1-score': 0.4869403180385876, 'support': 41245}, '1': {'precision': 0.5132523001603781, 'recall': 0.29575135582091006, 'f1-score': 0.37526422168392143, 'support': 41119}, '2': {'precision': 0.4389179378592109, 'recall': 0.484936739078539, 'f1-score': 0.46078120038107334, 'support': 41890}, 'accuracy': 0.44853284401307, 'macro avg': {'precision': 0.46021651607911895, 'recall': 0.44818750130624135, 'f1-score': 0.44099524670119417, 'support': 124254}, 'weighted avg': {'precision': 0.46005217455493397, 'recall': 0.44853284401307, 'f1-score': 0.44116460985469985, 'support': 124254}}
[[23257  5461 12527]
 [15517 12161 13441]
 [15504  6072 20314]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0676526
{'0': {'precision': 0.400066035659256, 'recall': 0.4923472843017743, 'f1-score': 0.441435424130184, 'support': 14766}, '1': {'precision': 0.48110587951225403, 'recall': 0.26764725636375847, 'f1-score': 0.3439495943379941, 'support': 14889}, '2': {'precision': 0.428713806126731, 'recall': 0.5151916288451841, 'f1-score': 0.46799129638112685, 'support': 15864}, 'accuracy': 0.4268107823106835, 'macro avg': {'precision': 0.4366285737660804, 'recall': 0.4250620565035723, 'f1-score': 0.4177921049497683, 'support': 45519}, 'weighted avg': {'precision': 0.4365578405280649, 'recall': 0.4268107823106835, 'f1-score': 0.4188034646761767, 'support': 45519}}
[[7270 2132 5364]
 [5377 3985 5527]
 [5525 2166 8173]]
training model: results/CHTR/W0/deepOF_L2/h20
Epoch 1/50
486/486 - 17s - loss: 3.3062 - accuracy20: 0.3648 - val_loss: 3.3085 - val_accuracy20: 0.3689 - 17s/epoch - 35ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2629 - accuracy20: 0.3896 - val_loss: 3.2795 - val_accuracy20: 0.3881 - 15s/epoch - 32ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2400 - accuracy20: 0.4029 - val_loss: 3.2619 - val_accuracy20: 0.3975 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2236 - accuracy20: 0.4129 - val_loss: 3.2513 - val_accuracy20: 0.4049 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2109 - accuracy20: 0.4198 - val_loss: 3.2439 - val_accuracy20: 0.4094 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2005 - accuracy20: 0.4239 - val_loss: 3.2399 - val_accuracy20: 0.4127 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.1909 - accuracy20: 0.4293 - val_loss: 3.2337 - val_accuracy20: 0.4153 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.1834 - accuracy20: 0.4318 - val_loss: 3.2328 - val_accuracy20: 0.4157 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.1759 - accuracy20: 0.4370 - val_loss: 3.2285 - val_accuracy20: 0.4182 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.1685 - accuracy20: 0.4396 - val_loss: 3.2299 - val_accuracy20: 0.4175 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.1604 - accuracy20: 0.4433 - val_loss: 3.2314 - val_accuracy20: 0.4196 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.1560 - accuracy20: 0.4453 - val_loss: 3.2316 - val_accuracy20: 0.4187 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.1463 - accuracy20: 0.4489 - val_loss: 3.2351 - val_accuracy20: 0.4164 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.1421 - accuracy20: 0.4507 - val_loss: 3.2313 - val_accuracy20: 0.4209 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.1343 - accuracy20: 0.4534 - val_loss: 3.2341 - val_accuracy20: 0.4195 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.1267 - accuracy20: 0.4574 - val_loss: 3.2346 - val_accuracy20: 0.4204 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1197 - accuracy20: 0.4592 - val_loss: 3.2391 - val_accuracy20: 0.4159 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1123 - accuracy20: 0.4617 - val_loss: 3.2386 - val_accuracy20: 0.4180 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1046 - accuracy20: 0.4661 - val_loss: 3.2395 - val_accuracy20: 0.4191 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h20
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0852178
{'0': {'precision': 0.40702230589059385, 'recall': 0.49396950215185165, 'f1-score': 0.4463006300630063, 'support': 112926}, '1': {'precision': 0.3897750763629632, 'recall': 0.25208021550434, 'f1-score': 0.306158059278288, 'support': 100230}, '2': {'precision': 0.4033591563049281, 'recall': 0.4441457666908596, 'f1-score': 0.4227710231949201, 'support': 111603}, 'accuracy': 0.4021936266585376, 'macro avg': {'precision': 0.40005217951949507, 'recall': 0.39673182811568375, 'f1-score': 0.39174323751207146, 'support': 324759}, 'weighted avg': {'precision': 0.40044047659944726, 'recall': 0.4021936266585376, 'f1-score': 0.39496266996012586, 'support': 324759}}
[[55782 19687 37457]
 [39101 25266 35863]
 [42166 19869 49568]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0617307
{'0': {'precision': 0.4230825328693768, 'recall': 0.4919919556104771, 'f1-score': 0.45494264205054674, 'support': 41271}, '1': {'precision': 0.4725018504811251, 'recall': 0.3096982340384242, 'f1-score': 0.3741574350858683, 'support': 41224}, '2': {'precision': 0.42464612822647796, 'recall': 0.5007303814746522, 'f1-score': 0.45956043956043957, 'support': 41759}, 'accuracy': 0.43444879038099377, 'macro avg': {'precision': 0.44007683719232665, 'recall': 0.43414019037451784, 'f1-score': 0.42955350556561817, 'support': 124254}, 'weighted avg': {'precision': 0.44000396902228855, 'recall': 0.43444879038099377, 'f1-score': 0.4296923099429583, 'support': 124254}}
[[20305  7120 13846]
 [13972 12767 14485]
 [13716  7133 20910]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0766189
{'0': {'precision': 0.40670469841676815, 'recall': 0.4260104740163824, 'f1-score': 0.4161337924249877, 'support': 14894}, '1': {'precision': 0.4406493780307822, 'recall': 0.2789642285104111, 'f1-score': 0.34164282795259493, 'support': 14984}, '2': {'precision': 0.41170712607674237, 'recall': 0.5378172751102871, 'f1-score': 0.46638760291630865, 'support': 15641}, 'accuracy': 0.41602407785759793, 'macro avg': {'precision': 0.41968706750809753, 'recall': 0.4142639925456935, 'f1-score': 0.4080547410979638, 'support': 45519}, 'weighted avg': {'precision': 0.419597557450711, 'recall': 0.41602407785759793, 'f1-score': 0.4088807165278989, 'support': 45519}}
[[6345 2724 5825]
 [4609 4180 6195]
 [4647 2582 8412]]
training model: results/CHTR/W0/deepOF_L2/h30
Epoch 1/50
486/486 - 17s - loss: 3.3098 - accuracy30: 0.3614 - val_loss: 3.3158 - val_accuracy30: 0.3626 - 17s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2712 - accuracy30: 0.3837 - val_loss: 3.2965 - val_accuracy30: 0.3751 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2503 - accuracy30: 0.3962 - val_loss: 3.2838 - val_accuracy30: 0.3841 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2370 - accuracy30: 0.4020 - val_loss: 3.2747 - val_accuracy30: 0.3871 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2278 - accuracy30: 0.4091 - val_loss: 3.2705 - val_accuracy30: 0.3943 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2191 - accuracy30: 0.4133 - val_loss: 3.2671 - val_accuracy30: 0.3974 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2108 - accuracy30: 0.4156 - val_loss: 3.2641 - val_accuracy30: 0.4000 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2029 - accuracy30: 0.4199 - val_loss: 3.2628 - val_accuracy30: 0.4029 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.1975 - accuracy30: 0.4232 - val_loss: 3.2637 - val_accuracy30: 0.4006 - 15s/epoch - 30ms/step
Epoch 10/50
486/486 - 15s - loss: 3.1913 - accuracy30: 0.4270 - val_loss: 3.2605 - val_accuracy30: 0.4021 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.1835 - accuracy30: 0.4296 - val_loss: 3.2638 - val_accuracy30: 0.4010 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.1781 - accuracy30: 0.4330 - val_loss: 3.2614 - val_accuracy30: 0.4018 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.1703 - accuracy30: 0.4362 - val_loss: 3.2647 - val_accuracy30: 0.4012 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.1661 - accuracy30: 0.4393 - val_loss: 3.2653 - val_accuracy30: 0.4006 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.1574 - accuracy30: 0.4416 - val_loss: 3.2718 - val_accuracy30: 0.3983 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.1507 - accuracy30: 0.4457 - val_loss: 3.2677 - val_accuracy30: 0.4004 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1430 - accuracy30: 0.4474 - val_loss: 3.2678 - val_accuracy30: 0.3993 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1365 - accuracy30: 0.4502 - val_loss: 3.2708 - val_accuracy30: 0.3997 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1287 - accuracy30: 0.4534 - val_loss: 3.2768 - val_accuracy30: 0.3986 - 15s/epoch - 31ms/step
Epoch 20/50
486/486 - 15s - loss: 3.1218 - accuracy30: 0.4570 - val_loss: 3.2766 - val_accuracy30: 0.4006 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h30
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0929872
{'0': {'precision': 0.38972235596212484, 'recall': 0.5479547259729944, 'f1-score': 0.4554877385422802, 'support': 110792}, '1': {'precision': 0.39681959422409063, 'recall': 0.1455261041100088, 'f1-score': 0.21295498335960764, 'support': 104428}, '2': {'precision': 0.38799574556000216, 'recall': 0.46290362336701996, 'f1-score': 0.42215247308784226, 'support': 109539}, 'accuracy': 0.3898644841251513, 'macro avg': {'precision': 0.3915125652487392, 'recall': 0.38546148448334105, 'f1-score': 0.3635317316632434, 'support': 324759}, 'weighted avg': {'precision': 0.3914221370933097, 'recall': 0.3898644841251513, 'f1-score': 0.3662562708975658, 'support': 324759}}
[[60709 11342 38741]
 [47991 15197 41240]
 [47075 11758 50706]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706297
{'0': {'precision': 0.4105721660572166, 'recall': 0.5544796533443075, 'f1-score': 0.47179624499212125, 'support': 41309}, '1': {'precision': 0.47828136971768725, 'recall': 0.19718617874325703, 'f1-score': 0.2792450233134323, 'support': 41154}, '2': {'precision': 0.4163187634711354, 'recall': 0.5130291211026298, 'f1-score': 0.45964197663200773, 'support': 41791}, 'accuracy': 0.4221996877364109, 'macro avg': {'precision': 0.4350574330820131, 'recall': 0.42156498439673146, 'f1-score': 0.40356108164585375, 'support': 124254}, 'weighted avg': {'precision': 0.43493082348448725, 'recall': 0.4221996877364109, 'f1-score': 0.40393370530726386, 'support': 124254}}
[[22905  4337 14067]
 [17047  8115 15992]
 [15836  4515 21440]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0856389
{'0': {'precision': 0.39502357255107384, 'recall': 0.5038417852609073, 'f1-score': 0.4428458173062806, 'support': 14967}, '1': {'precision': 0.4396186440677966, 'recall': 0.16497714172132777, 'f1-score': 0.2399190634484752, 'support': 15093}, '2': {'precision': 0.39739947026246086, 'recall': 0.5337990814412317, 'f1-score': 0.4556095406360424, 'support': 15459}, 'accuracy': 0.4016564511522661, 'macro avg': {'precision': 0.4106805622937771, 'recall': 0.4008726694744889, 'f1-score': 0.3794581404635993, 'support': 45519}, 'weighted avg': {'precision': 0.4106171140858665, 'recall': 0.4016564511522661, 'f1-score': 0.37989498145705125, 'support': 45519}}
[[7541 1619 5807]
 [5897 2490 6706]
 [5652 1555 8252]]
training model: results/CHTR/W0/deepOF_L2/h50
Epoch 1/50
486/486 - 18s - loss: 3.3146 - accuracy50: 0.3587 - val_loss: 3.3225 - val_accuracy50: 0.3600 - 18s/epoch - 37ms/step
Epoch 2/50
486/486 - 16s - loss: 3.2780 - accuracy50: 0.3764 - val_loss: 3.3067 - val_accuracy50: 0.3719 - 16s/epoch - 32ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2585 - accuracy50: 0.3886 - val_loss: 3.2996 - val_accuracy50: 0.3778 - 15s/epoch - 32ms/step
Epoch 4/50
486/486 - 16s - loss: 3.2484 - accuracy50: 0.3941 - val_loss: 3.2958 - val_accuracy50: 0.3806 - 16s/epoch - 32ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2418 - accuracy50: 0.3993 - val_loss: 3.2911 - val_accuracy50: 0.3855 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2348 - accuracy50: 0.4021 - val_loss: 3.2927 - val_accuracy50: 0.3829 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2289 - accuracy50: 0.4058 - val_loss: 3.2911 - val_accuracy50: 0.3856 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2236 - accuracy50: 0.4093 - val_loss: 3.2897 - val_accuracy50: 0.3857 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2198 - accuracy50: 0.4102 - val_loss: 3.2891 - val_accuracy50: 0.3866 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2128 - accuracy50: 0.4154 - val_loss: 3.2909 - val_accuracy50: 0.3855 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2063 - accuracy50: 0.4180 - val_loss: 3.2929 - val_accuracy50: 0.3853 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2026 - accuracy50: 0.4200 - val_loss: 3.2920 - val_accuracy50: 0.3857 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.1961 - accuracy50: 0.4234 - val_loss: 3.2926 - val_accuracy50: 0.3861 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.1916 - accuracy50: 0.4257 - val_loss: 3.2951 - val_accuracy50: 0.3853 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.1854 - accuracy50: 0.4291 - val_loss: 3.2966 - val_accuracy50: 0.3848 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 16s - loss: 3.1796 - accuracy50: 0.4328 - val_loss: 3.3001 - val_accuracy50: 0.3831 - 16s/epoch - 32ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1721 - accuracy50: 0.4356 - val_loss: 3.3042 - val_accuracy50: 0.3840 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1658 - accuracy50: 0.4381 - val_loss: 3.3035 - val_accuracy50: 0.3852 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1607 - accuracy50: 0.4388 - val_loss: 3.3100 - val_accuracy50: 0.3826 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h50
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.103358
{'0': {'precision': 0.37614697523345514, 'recall': 0.5153481731455642, 'f1-score': 0.4348798910981329, 'support': 107863}, '1': {'precision': 0.37495392554367857, 'recall': 0.03712658990127557, 'f1-score': 0.06756330427563303, 'support': 109598}, '2': {'precision': 0.3663402095986805, 'recall': 0.5671960334768589, 'f1-score': 0.44516046447837615, 'support': 107298}, 'accuracy': 0.37109056254022216, 'macro avg': {'precision': 0.3724803701252714, 'recall': 0.3732235988412329, 'f1-score': 0.3158678866173807, 'support': 324759}, 'weighted avg': {'precision': 0.37250426725929536, 'recall': 0.37109056254022216, 'f1-score': 0.3143164014950149, 'support': 324759}}
[[55587  3340 48936]
 [49197  4069 56332]
 [42996  3443 60859]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0839121
{'0': {'precision': 0.4024263888627244, 'recall': 0.516864263247036, 'f1-score': 0.45252242805545845, 'support': 41330}, '1': {'precision': 0.49462561486609585, 'recall': 0.06623566723591119, 'f1-score': 0.11682695410830697, 'support': 40990}, '2': {'precision': 0.3938978715629853, 'recall': 0.6169695235369866, 'f1-score': 0.4808206958073148, 'support': 41934}, 'accuracy': 0.4019910827820432, 'macro avg': {'precision': 0.43031662509726853, 'recall': 0.40002315133997796, 'f1-score': 0.35005669265702677, 'support': 124254}, 'weighted avg': {'precision': 0.4299636225085703, 'recall': 0.4019910827820432, 'f1-score': 0.3513305314791921, 'support': 124254}}
[[21362  1402 18566]
 [17031  2715 21244]
 [14690  1372 25872]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.095403
{'0': {'precision': 0.39192046168790357, 'recall': 0.4599342855226983, 'f1-score': 0.42321219226260254, 'support': 14913}, '1': {'precision': 0.437855402112104, 'recall': 0.03569772832637923, 'f1-score': 0.06601347213717085, 'support': 15099}, '2': {'precision': 0.37936312390338595, 'recall': 0.6553169536338428, 'f1-score': 0.48054097507920746, 'support': 15507}, 'accuracy': 0.3857729739229772, 'macro avg': {'precision': 0.40304632923446454, 'recall': 0.3836496558276401, 'f1-score': 0.3232555464929936, 'support': 45519}, 'weighted avg': {'precision': 0.4028795123797133, 'recall': 0.3857729739229772, 'f1-score': 0.3242568979890728, 'support': 45519}}
[[ 6859   337  7717]
 [ 5652   539  8908]
 [ 4990   355 10162]]
training model: results/CHTR/W0/deepOF_L2/h100
Epoch 1/50
486/486 - 17s - loss: 3.3210 - accuracy100: 0.3538 - val_loss: 3.3273 - val_accuracy100: 0.3542 - 17s/epoch - 35ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2874 - accuracy100: 0.3698 - val_loss: 3.3203 - val_accuracy100: 0.3640 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2743 - accuracy100: 0.3767 - val_loss: 3.3156 - val_accuracy100: 0.3696 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2647 - accuracy100: 0.3822 - val_loss: 3.3146 - val_accuracy100: 0.3709 - 15s/epoch - 32ms/step
Epoch 5/50
486/486 - 16s - loss: 3.2585 - accuracy100: 0.3864 - val_loss: 3.3128 - val_accuracy100: 0.3724 - 16s/epoch - 32ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2527 - accuracy100: 0.3895 - val_loss: 3.3119 - val_accuracy100: 0.3709 - 15s/epoch - 32ms/step
Epoch 7/50
486/486 - 16s - loss: 3.2472 - accuracy100: 0.3935 - val_loss: 3.3095 - val_accuracy100: 0.3747 - 16s/epoch - 32ms/step
Epoch 8/50
486/486 - 16s - loss: 3.2421 - accuracy100: 0.3958 - val_loss: 3.3100 - val_accuracy100: 0.3734 - 16s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2374 - accuracy100: 0.3991 - val_loss: 3.3113 - val_accuracy100: 0.3720 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2331 - accuracy100: 0.4009 - val_loss: 3.3074 - val_accuracy100: 0.3716 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2272 - accuracy100: 0.4045 - val_loss: 3.3107 - val_accuracy100: 0.3728 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2223 - accuracy100: 0.4093 - val_loss: 3.3080 - val_accuracy100: 0.3725 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2187 - accuracy100: 0.4096 - val_loss: 3.3100 - val_accuracy100: 0.3702 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2135 - accuracy100: 0.4126 - val_loss: 3.3103 - val_accuracy100: 0.3732 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2082 - accuracy100: 0.4155 - val_loss: 3.3126 - val_accuracy100: 0.3712 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2028 - accuracy100: 0.4195 - val_loss: 3.3124 - val_accuracy100: 0.3715 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1971 - accuracy100: 0.4206 - val_loss: 3.3187 - val_accuracy100: 0.3708 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1932 - accuracy100: 0.4233 - val_loss: 3.3221 - val_accuracy100: 0.3683 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1854 - accuracy100: 0.4282 - val_loss: 3.3279 - val_accuracy100: 0.3693 - 15s/epoch - 31ms/step
Epoch 20/50
486/486 - 15s - loss: 3.1790 - accuracy100: 0.4333 - val_loss: 3.3302 - val_accuracy100: 0.3691 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h100
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1114228
{'0': {'precision': 0.3498495409068697, 'recall': 0.5290897245154954, 'f1-score': 0.42119360120141974, 'support': 102837}, '1': {'precision': 0.3624867162592986, 'recall': 0.029023858956468467, 'f1-score': 0.05374446562780658, 'support': 117524}, '2': {'precision': 0.35310495854841234, 'recall': 0.5405754899519147, 'f1-score': 0.4271770436335973, 'support': 104398}, 'accuracy': 0.351817809514132, 'macro avg': {'precision': 0.3551470719048602, 'recall': 0.36622969114129283, 'f1-score': 0.30070503682094124, 'support': 324759}, 'weighted avg': {'precision': 0.3554691865119511, 'recall': 0.351817809514132, 'f1-score': 0.2901443222403476, 'support': 324759}}
[[54410  2948 45479]
 [56202  3411 57911]
 [44912  3051 56435]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0858392
{'0': {'precision': 0.3949391532463747, 'recall': 0.5276621638067421, 'f1-score': 0.45175406607833124, 'support': 41085}, '1': {'precision': 0.48601319081191724, 'recall': 0.052085110531575225, 'f1-score': 0.0940870866904416, 'support': 41029}, '2': {'precision': 0.39462787654891096, 'recall': 0.6083768391077361, 'f1-score': 0.478726483357453, 'support': 42140}, 'accuracy': 0.3979992595811805, 'macro avg': {'precision': 0.42519340686906765, 'recall': 0.39604137114868454, 'f1-score': 0.34152254537540866, 'support': 124254}, 'weighted avg': {'precision': 0.42490647411528454, 'recall': 0.3979992595811805, 'f1-score': 0.34279901567219917, 'support': 124254}}
[[21679  1094 18312]
 [17876  2137 21016]
 [15337  1166 25637]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1017245
{'0': {'precision': 0.3697206335239771, 'recall': 0.4565084538602567, 'f1-score': 0.40855640971103885, 'support': 14727}, '1': {'precision': 0.3930942895086321, 'recall': 0.01940729084710202, 'f1-score': 0.03698844111215246, 'support': 15252}, '2': {'precision': 0.3724700925438266, 'recall': 0.6371299871299871, 'f1-score': 0.47011063102416784, 'support': 15540}, 'accuracy': 0.37171291109207144, 'macro avg': {'precision': 0.3784283385254786, 'recall': 0.37101524394578195, 'f1-score': 0.3052184939491197, 'support': 45519}, 'weighted avg': {'precision': 0.37849107211547556, 'recall': 0.37171291109207144, 'f1-score': 0.30506990829703173, 'support': 45519}}
[[6723  197 7807]
 [6082  296 8874]
 [5379  260 9901]]
training model: results/CHTR/W0/deepOF_L2/h200
Epoch 1/50
486/486 - 18s - loss: 3.3293 - accuracy200: 0.3488 - val_loss: 3.3235 - val_accuracy200: 0.3448 - 18s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2980 - accuracy200: 0.3603 - val_loss: 3.3137 - val_accuracy200: 0.3507 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2850 - accuracy200: 0.3662 - val_loss: 3.3081 - val_accuracy200: 0.3573 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2769 - accuracy200: 0.3710 - val_loss: 3.3096 - val_accuracy200: 0.3581 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 16s - loss: 3.2705 - accuracy200: 0.3745 - val_loss: 3.3059 - val_accuracy200: 0.3622 - 16s/epoch - 32ms/step
Epoch 6/50
486/486 - 16s - loss: 3.2653 - accuracy200: 0.3795 - val_loss: 3.3032 - val_accuracy200: 0.3625 - 16s/epoch - 33ms/step
Epoch 7/50
486/486 - 16s - loss: 3.2612 - accuracy200: 0.3810 - val_loss: 3.3021 - val_accuracy200: 0.3657 - 16s/epoch - 33ms/step
Epoch 8/50
486/486 - 16s - loss: 3.2547 - accuracy200: 0.3873 - val_loss: 3.3016 - val_accuracy200: 0.3659 - 16s/epoch - 33ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2505 - accuracy200: 0.3898 - val_loss: 3.3006 - val_accuracy200: 0.3663 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2462 - accuracy200: 0.3912 - val_loss: 3.3034 - val_accuracy200: 0.3636 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2420 - accuracy200: 0.3944 - val_loss: 3.3056 - val_accuracy200: 0.3650 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2382 - accuracy200: 0.3970 - val_loss: 3.3035 - val_accuracy200: 0.3623 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2339 - accuracy200: 0.3993 - val_loss: 3.3054 - val_accuracy200: 0.3644 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2295 - accuracy200: 0.4027 - val_loss: 3.3074 - val_accuracy200: 0.3638 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2255 - accuracy200: 0.4049 - val_loss: 3.3095 - val_accuracy200: 0.3642 - 15s/epoch - 32ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2179 - accuracy200: 0.4095 - val_loss: 3.3111 - val_accuracy200: 0.3624 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2132 - accuracy200: 0.4123 - val_loss: 3.3109 - val_accuracy200: 0.3624 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2080 - accuracy200: 0.4132 - val_loss: 3.3139 - val_accuracy200: 0.3624 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2021 - accuracy200: 0.4164 - val_loss: 3.3190 - val_accuracy200: 0.3593 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h200
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1070192
{'0': {'precision': 0.335111943019666, 'recall': 0.5402688509170717, 'f1-score': 0.41364979820863274, 'support': 102064}, '1': {'precision': 0.36817530641481405, 'recall': 0.059586782537010954, 'f1-score': 0.10257282019822762, 'support': 116452}, '2': {'precision': 0.351171443931977, 'recall': 0.4672590194177499, 'f1-score': 0.4009822016340411, 'support': 106243}, 'accuracy': 0.34402125884117146, 'macro avg': {'precision': 0.3514862311221523, 'recall': 0.3557048842906108, 'f1-score': 0.3057349400136338, 'support': 324759}, 'weighted avg': {'precision': 0.3522215669239102, 'recall': 0.34402125884117146, 'f1-score': 0.29795976434924154, 'support': 324759}}
[[55142  5512 41410]
 [59202  6939 50311]
 [50204  6396 49643]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0891373
{'0': {'precision': 0.3765280372300331, 'recall': 0.5589938208534034, 'f1-score': 0.449966709748169, 'support': 41106}, '1': {'precision': 0.4202631951323051, 'recall': 0.07247437774524158, 'f1-score': 0.12362894665639895, 'support': 40980}, '2': {'precision': 0.39160627481704385, 'recall': 0.5215566306203756, 'f1-score': 0.44733496730364386, 'support': 42168}, 'accuracy': 0.3858306372430666, 'macro avg': {'precision': 0.3961325023931273, 'recall': 0.3843416097396735, 'f1-score': 0.3403102079027372, 'support': 124254}, 'weighted avg': {'precision': 0.3960693469134572, 'recall': 0.3858306372430666, 'f1-score': 0.3414446754723994, 'support': 124254}}
[[22978  1996 16132]
 [19974  2970 18036]
 [18074  2101 21993]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001989
{'0': {'precision': 0.35031875332034706, 'recall': 0.5409488651900465, 'f1-score': 0.42524720550300943, 'support': 14628}, '1': {'precision': 0.37959442332065907, 'recall': 0.04005081572612998, 'f1-score': 0.07245675577597677, 'support': 14956}, '2': {'precision': 0.3766215520067438, 'recall': 0.5046752431754, 'f1-score': 0.4313452048916542, 'support': 15935}, 'accuracy': 0.3636723126606472, 'macro avg': {'precision': 0.3688449095492499, 'recall': 0.3618916413638589, 'f1-score': 0.30968305539021346, 'support': 45519}, 'weighted avg': {'precision': 0.3691456611520745, 'recall': 0.3636723126606472, 'f1-score': 0.3114669742620013, 'support': 45519}}
[[7913  436 6279]
 [7325  599 7032]
 [7350  543 8042]]
training model: results/CHTR/W0/deepOF_L2/h300
Epoch 1/50
486/486 - 17s - loss: 3.3335 - accuracy300: 0.3461 - val_loss: 3.3242 - val_accuracy300: 0.3410 - 17s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3021 - accuracy300: 0.3558 - val_loss: 3.3190 - val_accuracy300: 0.3451 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2904 - accuracy300: 0.3618 - val_loss: 3.3155 - val_accuracy300: 0.3463 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 16s - loss: 3.2829 - accuracy300: 0.3649 - val_loss: 3.3129 - val_accuracy300: 0.3502 - 16s/epoch - 32ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2766 - accuracy300: 0.3692 - val_loss: 3.3101 - val_accuracy300: 0.3527 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 16s - loss: 3.2716 - accuracy300: 0.3741 - val_loss: 3.3106 - val_accuracy300: 0.3523 - 16s/epoch - 32ms/step
Epoch 7/50
486/486 - 16s - loss: 3.2687 - accuracy300: 0.3769 - val_loss: 3.3068 - val_accuracy300: 0.3548 - 16s/epoch - 32ms/step
Epoch 8/50
486/486 - 16s - loss: 3.2636 - accuracy300: 0.3789 - val_loss: 3.3077 - val_accuracy300: 0.3520 - 16s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2597 - accuracy300: 0.3816 - val_loss: 3.3055 - val_accuracy300: 0.3568 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2555 - accuracy300: 0.3839 - val_loss: 3.3057 - val_accuracy300: 0.3553 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2509 - accuracy300: 0.3885 - val_loss: 3.3082 - val_accuracy300: 0.3536 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2478 - accuracy300: 0.3894 - val_loss: 3.3117 - val_accuracy300: 0.3495 - 15s/epoch - 32ms/step
Epoch 13/50
486/486 - 16s - loss: 3.2437 - accuracy300: 0.3934 - val_loss: 3.3109 - val_accuracy300: 0.3540 - 16s/epoch - 32ms/step
Epoch 14/50
486/486 - 16s - loss: 3.2397 - accuracy300: 0.3946 - val_loss: 3.3140 - val_accuracy300: 0.3515 - 16s/epoch - 32ms/step
Epoch 15/50
486/486 - 16s - loss: 3.2337 - accuracy300: 0.3982 - val_loss: 3.3159 - val_accuracy300: 0.3501 - 16s/epoch - 32ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2306 - accuracy300: 0.4010 - val_loss: 3.3168 - val_accuracy300: 0.3514 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2252 - accuracy300: 0.4029 - val_loss: 3.3214 - val_accuracy300: 0.3512 - 15s/epoch - 32ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2191 - accuracy300: 0.4068 - val_loss: 3.3231 - val_accuracy300: 0.3504 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2147 - accuracy300: 0.4086 - val_loss: 3.3239 - val_accuracy300: 0.3536 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h300
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.105598
{'0': {'precision': 0.3302011684461968, 'recall': 0.4547111859704746, 'f1-score': 0.38258071507765157, 'support': 100930}, '1': {'precision': 0.35695846045529217, 'recall': 0.06501389185723445, 'f1-score': 0.10999421463696848, 'support': 116975}, '2': {'precision': 0.3437062979582406, 'recall': 0.529020907032025, 'f1-score': 0.41668878077546806, 'support': 106854}, 'accuracy': 0.3387958455346888, 'macro avg': {'precision': 0.34362197561990987, 'recall': 0.34958199495324466, 'f1-score': 0.303087903496696, 'support': 324759}, 'weighted avg': {'precision': 0.3442824143597631, 'recall': 0.3387958455346888, 'f1-score': 0.29562016082981113, 'support': 324759}}
[[45894  6685 48351]
 [49783  7605 59587]
 [43311  7015 56528]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0918744
{'0': {'precision': 0.3730587069060469, 'recall': 0.49325242718446605, 'f1-score': 0.42481760979994565, 'support': 41200}, '1': {'precision': 0.4037380734544504, 'recall': 0.07530656525024988, 'f1-score': 0.12693651119786317, 'support': 41019}, '2': {'precision': 0.37447890679070966, 'recall': 0.5534911383371001, 'f1-score': 0.4467186359970816, 'support': 42035}, 'accuracy': 0.37565792650538415, 'macro avg': {'precision': 0.3837585623837357, 'recall': 0.374016710257272, 'f1-score': 0.33282425233163015, 'support': 124254}, 'weighted avg': {'precision': 0.3836670980934595, 'recall': 0.37565792650538415, 'f1-score': 0.3338895499599227, 'support': 124254}}
[[20322  2270 18608]
 [17675  3089 20255]
 [16477  2292 23266]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.102129
{'0': {'precision': 0.3425206124852768, 'recall': 0.4962457337883959, 'f1-score': 0.4052961672473868, 'support': 14650}, '1': {'precision': 0.3371900826446281, 'recall': 0.04120379721268431, 'f1-score': 0.0734341252699784, 'support': 14853}, '2': {'precision': 0.3671426664887228, 'recall': 0.5152972027972028, 'f1-score': 0.4287829588258215, 'support': 16016}, 'accuracy': 0.35446736527603856, 'macro avg': {'precision': 0.3489511205395426, 'recall': 0.350915577932761, 'f1-score': 0.3025044171143956, 'support': 45519}, 'weighted avg': {'precision': 0.3494445883458193, 'recall': 0.35446736527603856, 'f1-score': 0.30527238694530995, 'support': 45519}}
[[7270  610 6770]
 [6785  612 7456]
 [7170  593 8253]]
training model: results/CHTR/W0/deepOF_L2/h500
Epoch 1/50
486/486 - 18s - loss: 3.3313 - accuracy500: 0.3489 - val_loss: 3.3368 - val_accuracy500: 0.3342 - 18s/epoch - 37ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3039 - accuracy500: 0.3565 - val_loss: 3.3282 - val_accuracy500: 0.3357 - 15s/epoch - 32ms/step
Epoch 3/50
486/486 - 16s - loss: 3.2908 - accuracy500: 0.3626 - val_loss: 3.3242 - val_accuracy500: 0.3374 - 16s/epoch - 32ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2834 - accuracy500: 0.3641 - val_loss: 3.3232 - val_accuracy500: 0.3372 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2778 - accuracy500: 0.3695 - val_loss: 3.3212 - val_accuracy500: 0.3411 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2731 - accuracy500: 0.3720 - val_loss: 3.3204 - val_accuracy500: 0.3411 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2695 - accuracy500: 0.3754 - val_loss: 3.3207 - val_accuracy500: 0.3412 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2637 - accuracy500: 0.3803 - val_loss: 3.3226 - val_accuracy500: 0.3393 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2605 - accuracy500: 0.3819 - val_loss: 3.3213 - val_accuracy500: 0.3391 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2567 - accuracy500: 0.3841 - val_loss: 3.3203 - val_accuracy500: 0.3415 - 15s/epoch - 32ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2523 - accuracy500: 0.3874 - val_loss: 3.3232 - val_accuracy500: 0.3419 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2467 - accuracy500: 0.3902 - val_loss: 3.3241 - val_accuracy500: 0.3386 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2428 - accuracy500: 0.3956 - val_loss: 3.3244 - val_accuracy500: 0.3371 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2394 - accuracy500: 0.3968 - val_loss: 3.3260 - val_accuracy500: 0.3376 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2347 - accuracy500: 0.3999 - val_loss: 3.3306 - val_accuracy500: 0.3367 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2300 - accuracy500: 0.4039 - val_loss: 3.3325 - val_accuracy500: 0.3360 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2257 - accuracy500: 0.4045 - val_loss: 3.3348 - val_accuracy500: 0.3367 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2191 - accuracy500: 0.4100 - val_loss: 3.3381 - val_accuracy500: 0.3342 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2135 - accuracy500: 0.4132 - val_loss: 3.3417 - val_accuracy500: 0.3348 - 15s/epoch - 32ms/step
Epoch 20/50
486/486 - 15s - loss: 3.2088 - accuracy500: 0.4146 - val_loss: 3.3441 - val_accuracy500: 0.3350 - 15s/epoch - 32ms/step
testing model: results/CHTR/W0/deepOF_L2/h500
Evaluating performance on  test set...
1269/1269 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1080322
{'0': {'precision': 0.3190609387620786, 'recall': 0.42438621622697065, 'f1-score': 0.3642627821988456, 'support': 100524}, '1': {'precision': 0.3505918384239715, 'recall': 0.07196194197850742, 'f1-score': 0.11941329461434906, 'support': 117715}, '2': {'precision': 0.339159561145432, 'recall': 0.5313743897859556, 'f1-score': 0.4140463554601348, 'support': 106520}, 'accuracy': 0.33173522519776205, 'macro avg': {'precision': 0.3362707794438274, 'recall': 0.3425741826638113, 'f1-score': 0.2992408107577765, 'support': 324759}, 'weighted avg': {'precision': 0.33708219486267793, 'recall': 0.33173522519776205, 'f1-score': 0.29184135213157575, 'support': 324759}}
[[42661  7604 50259]
 [49216  8471 60028]
 [41831  8087 56602]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0923563
{'0': {'precision': 0.3745481247175779, 'recall': 0.4789224065291186, 'f1-score': 0.42035309406332866, 'support': 41537}, '1': {'precision': 0.3838755882954778, 'recall': 0.09133398247322298, 'f1-score': 0.14755968065442246, 'support': 41080}, '2': {'precision': 0.3717083822187459, 'recall': 0.5478540720993347, 'f1-score': 0.44291053832338234, 'support': 41637}, 'accuracy': 0.37387931173241906, 'macro avg': {'precision': 0.37671069841060056, 'recall': 0.37270348703389206, 'f1-score': 0.3369411043470445, 'support': 124254}, 'weighted avg': {'precision': 0.37668032042440636, 'recall': 0.37387931173241906, 'f1-score': 0.3377229242806093, 'support': 124254}}
[[19893  3101 18543]
 [17314  3752 20014]
 [15905  2921 22811]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1067502
{'0': {'precision': 0.3320096440221245, 'recall': 0.48528192371475953, 'f1-score': 0.39427368421052633, 'support': 14472}, '1': {'precision': 0.3272543059777102, 'recall': 0.06421045656351468, 'f1-score': 0.10735652559273212, 'support': 15091}, '2': {'precision': 0.3515533753795842, 'recall': 0.4716094259212835, 'f1-score': 0.402826476807366, 'support': 15956}, 'accuracy': 0.34089061710494517, 'macro avg': {'precision': 0.3369391084598063, 'recall': 0.34036726873318585, 'f1-score': 0.3014855622035415, 'support': 45519}, 'weighted avg': {'precision': 0.3372838585503736, 'recall': 0.34089061710494517, 'f1-score': 0.30214954962879215, 'support': 45519}}
[[7023  969 6480]
 [6722  969 7400]
 [7408 1023 7525]]
training model: results/CHTR/W0/deepOF_L2/h1000
Epoch 1/50
486/486 - 18s - loss: 3.3364 - accuracy1000: 0.3491 - val_loss: 3.3557 - val_accuracy1000: 0.3251 - 18s/epoch - 38ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3083 - accuracy1000: 0.3562 - val_loss: 3.3501 - val_accuracy1000: 0.3231 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2936 - accuracy1000: 0.3611 - val_loss: 3.3489 - val_accuracy1000: 0.3202 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2866 - accuracy1000: 0.3633 - val_loss: 3.3458 - val_accuracy1000: 0.3242 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2814 - accuracy1000: 0.3659 - val_loss: 3.3424 - val_accuracy1000: 0.3247 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2764 - accuracy1000: 0.3679 - val_loss: 3.3372 - val_accuracy1000: 0.3236 - 15s/epoch - 32ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2727 - accuracy1000: 0.3721 - val_loss: 3.3309 - val_accuracy1000: 0.3287 - 15s/epoch - 32ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2691 - accuracy1000: 0.3760 - val_loss: 3.3334 - val_accuracy1000: 0.3279 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2648 - accuracy1000: 0.3792 - val_loss: 3.3318 - val_accuracy1000: 0.3280 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2605 - accuracy1000: 0.3816 - val_loss: 3.3349 - val_accuracy1000: 0.3266 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2554 - accuracy1000: 0.3855 - val_loss: 3.3355 - val_accuracy1000: 0.3286 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2518 - accuracy1000: 0.3889 - val_loss: 3.3356 - val_accuracy1000: 0.3259 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2488 - accuracy1000: 0.3899 - val_loss: 3.3396 - val_accuracy1000: 0.3295 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2433 - accuracy1000: 0.3942 - val_loss: 3.3404 - val_accuracy1000: 0.3295 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2409 - accuracy1000: 0.3961 - val_loss: 3.3440 - val_accuracy1000: 0.3270 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2353 - accuracy1000: 0.4007 - val_loss: 3.3514 - val_accuracy1000: 0.3252 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2306 - accuracy1000: 0.4022 - val_loss: 3.3533 - val_accuracy1000: 0.3238 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepOF_L2/h1000
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1188622
{'0': {'precision': 0.3078989950858924, 'recall': 0.5309076682316118, 'f1-score': 0.38975831900379815, 'support': 97128}, '1': {'precision': 0.38923808063774334, 'recall': 0.02024704747171075, 'f1-score': 0.0384918589490919, 'support': 125401}, '2': {'precision': 0.325605768146512, 'recall': 0.4801721608138511, 'f1-score': 0.38806430319104784, 'support': 102230}, 'accuracy': 0.3177525488131199, 'macro avg': {'precision': 0.3409142812900492, 'recall': 0.34377562550572455, 'f1-score': 0.2721048270479793, 'support': 324759}, 'weighted avg': {'precision': 0.3448807756594094, 'recall': 0.3177525488131199, 'f1-score': 0.253588591316936, 'support': 324759}}
[[51566  1703 43859]
 [65050  2539 57812]
 [50861  2281 49088]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0999254
{'0': {'precision': 0.35630262226439535, 'recall': 0.5688726433243555, 'f1-score': 0.43816738749918965, 'support': 41584}, '1': {'precision': 0.4072413793103448, 'recall': 0.02875648299203779, 'f1-score': 0.053719666128408644, 'support': 41069}, '2': {'precision': 0.35567038445443133, 'recall': 0.4698925506598399, 'f1-score': 0.40487976636772227, 'support': 41601}, 'accuracy': 0.3572118402626877, 'macro avg': {'precision': 0.3730714620097238, 'recall': 0.3558405589920777, 'f1-score': 0.2989222733317735, 'support': 124254}, 'weighted avg': {'precision': 0.37292745597588783, 'recall': 0.3572118402626877, 'f1-score': 0.2999530700875427, 'support': 124254}}
[[23656   843 17085]
 [21560  1181 18328]
 [21177   876 19548]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1101034
{'0': {'precision': 0.31607639011008337, 'recall': 0.6392346539583185, 'f1-score': 0.42299727007436694, 'support': 14059}, '1': {'precision': 0.3602693602693603, 'recall': 0.020719034402633448, 'f1-score': 0.0391845703125, 'support': 15493}, '2': {'precision': 0.34127817227539364, 'recall': 0.34615143733951276, 'f1-score': 0.34369753124805674, 'support': 15967}, 'accuracy': 0.3259078626507612, 'macro avg': {'precision': 0.33920797421827914, 'recall': 0.3353683752334882, 'f1-score': 0.26862645721164125, 'support': 45519}, 'weighted avg': {'precision': 0.33995825356295334, 'recall': 0.3259078626507612, 'f1-score': 0.26454499548023486, 'support': 45519}}
[[ 8987   249  4823]
 [ 9327   321  5845]
 [10119   321  5527]]
training model: results/CHTR/W0/deepVOL_L2/h10
Epoch 1/50
486/486 - 18s - loss: 3.3134 - accuracy10: 0.3622 - val_loss: 3.3680 - val_accuracy10: 0.3549 - 18s/epoch - 37ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2801 - accuracy10: 0.3724 - val_loss: 3.3811 - val_accuracy10: 0.3542 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2611 - accuracy10: 0.3846 - val_loss: 3.3150 - val_accuracy10: 0.3652 - 15s/epoch - 30ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2497 - accuracy10: 0.3922 - val_loss: 3.3248 - val_accuracy10: 0.3695 - 15s/epoch - 30ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2370 - accuracy10: 0.4006 - val_loss: 3.2972 - val_accuracy10: 0.3746 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2286 - accuracy10: 0.4068 - val_loss: 3.2880 - val_accuracy10: 0.3777 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2215 - accuracy10: 0.4094 - val_loss: 3.2868 - val_accuracy10: 0.3780 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2138 - accuracy10: 0.4156 - val_loss: 3.2879 - val_accuracy10: 0.3762 - 15s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2085 - accuracy10: 0.4177 - val_loss: 3.3025 - val_accuracy10: 0.3801 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2038 - accuracy10: 0.4186 - val_loss: 3.2832 - val_accuracy10: 0.3810 - 15s/epoch - 30ms/step
Epoch 11/50
486/486 - 15s - loss: 3.1981 - accuracy10: 0.4227 - val_loss: 3.3089 - val_accuracy10: 0.3818 - 15s/epoch - 30ms/step
Epoch 12/50
486/486 - 15s - loss: 3.1942 - accuracy10: 0.4245 - val_loss: 3.2877 - val_accuracy10: 0.3857 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.1891 - accuracy10: 0.4258 - val_loss: 3.2958 - val_accuracy10: 0.3850 - 15s/epoch - 30ms/step
Epoch 14/50
486/486 - 15s - loss: 3.1865 - accuracy10: 0.4293 - val_loss: 3.2813 - val_accuracy10: 0.3861 - 15s/epoch - 30ms/step
Epoch 15/50
486/486 - 15s - loss: 3.1825 - accuracy10: 0.4294 - val_loss: 3.2972 - val_accuracy10: 0.3885 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.1794 - accuracy10: 0.4300 - val_loss: 3.2863 - val_accuracy10: 0.3875 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1749 - accuracy10: 0.4332 - val_loss: 3.3009 - val_accuracy10: 0.3882 - 15s/epoch - 30ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1721 - accuracy10: 0.4337 - val_loss: 3.3155 - val_accuracy10: 0.3849 - 15s/epoch - 30ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1689 - accuracy10: 0.4339 - val_loss: 3.2859 - val_accuracy10: 0.3871 - 15s/epoch - 30ms/step
Epoch 20/50
486/486 - 15s - loss: 3.1654 - accuracy10: 0.4371 - val_loss: 3.2898 - val_accuracy10: 0.3892 - 15s/epoch - 30ms/step
Epoch 21/50
486/486 - 15s - loss: 3.1630 - accuracy10: 0.4383 - val_loss: 3.3199 - val_accuracy10: 0.3864 - 15s/epoch - 30ms/step
Epoch 22/50
486/486 - 15s - loss: 3.1607 - accuracy10: 0.4392 - val_loss: 3.2895 - val_accuracy10: 0.3896 - 15s/epoch - 30ms/step
Epoch 23/50
486/486 - 15s - loss: 3.1577 - accuracy10: 0.4408 - val_loss: 3.3098 - val_accuracy10: 0.3889 - 15s/epoch - 30ms/step
Epoch 24/50
486/486 - 15s - loss: 3.1545 - accuracy10: 0.4405 - val_loss: 3.2823 - val_accuracy10: 0.3884 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepVOL_L2/h10
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0927234
{'0': {'precision': 0.4080790064737746, 'recall': 0.3286457825342921, 'f1-score': 0.36408017327328357, 'support': 112781}, '1': {'precision': 0.4219568109133105, 'recall': 0.14745910232824955, 'f1-score': 0.21854455104478923, 'support': 101106}, '2': {'precision': 0.36737612221366245, 'recall': 0.6580444997609964, 'f1-score': 0.4715135065270777, 'support': 110877}, 'accuracy': 0.3846978113337685, 'macro avg': {'precision': 0.3991373132002492, 'recall': 0.37804979487451273, 'f1-score': 0.3513794102817169, 'support': 324764}, 'weighted avg': {'precision': 0.3985031778645546, 'recall': 0.3846978113337685, 'f1-score': 0.355450402332375, 'support': 324764}}
[[37065 10532 65184]
 [25740 14909 60457]
 [28023  9892 72962]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0793576
{'0': {'precision': 0.42224922930993597, 'recall': 0.34510744482399397, 'f1-score': 0.3798008345220162, 'support': 41277}, '1': {'precision': 0.49933468325137403, 'recall': 0.21048652603341056, 'f1-score': 0.2961399897066392, 'support': 41005}, '2': {'precision': 0.37442990960482836, 'recall': 0.6533009315512354, 'f1-score': 0.47603010233753157, 'support': 41973}, 'accuracy': 0.4047885396965917, 'macro avg': {'precision': 0.43200460738871277, 'recall': 0.4029649674695466, 'f1-score': 0.3839903088553956, 'support': 124255}, 'weighted avg': {'precision': 0.4315347207017205, 'recall': 0.4047885396965917, 'f1-score': 0.3846981675578385, 'support': 124255}}
[[14245  4235 22797]
 [ 9358  8631 23016]
 [10133  4419 27421]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0936496
{'0': {'precision': 0.39077958053027306, 'recall': 0.2669820885434268, 'f1-score': 0.3172308557201944, 'support': 14795}, '1': {'precision': 0.46134020618556704, 'recall': 0.14456858258177413, 'f1-score': 0.22014963615865535, 'support': 14858}, '2': {'precision': 0.3724801664715828, 'recall': 0.7220016386210374, 'f1-score': 0.491431267829183, 'support': 15867}, 'accuracy': 0.3856326889279438, 'macro avg': {'precision': 0.40819998439580757, 'recall': 0.3778507699154128, 'f1-score': 0.3429372532360109, 'support': 45520}, 'weighted avg': {'precision': 0.4074323259853943, 'recall': 0.3856326889279438, 'f1-score': 0.3462643614031464, 'support': 45520}}
[[ 3950  1249  9596]
 [ 3006  2148  9704]
 [ 3152  1259 11456]]
training model: results/CHTR/W0/deepVOL_L2/h20
Epoch 1/50
486/486 - 17s - loss: 3.3183 - accuracy20: 0.3582 - val_loss: 3.3364 - val_accuracy20: 0.3512 - 17s/epoch - 35ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2819 - accuracy20: 0.3702 - val_loss: 3.3273 - val_accuracy20: 0.3514 - 15s/epoch - 30ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2682 - accuracy20: 0.3778 - val_loss: 3.3273 - val_accuracy20: 0.3588 - 15s/epoch - 30ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2584 - accuracy20: 0.3849 - val_loss: 3.3100 - val_accuracy20: 0.3611 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 16s - loss: 3.2528 - accuracy20: 0.3905 - val_loss: 3.3042 - val_accuracy20: 0.3656 - 16s/epoch - 32ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2452 - accuracy20: 0.3946 - val_loss: 3.3042 - val_accuracy20: 0.3661 - 15s/epoch - 32ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2394 - accuracy20: 0.3992 - val_loss: 3.2937 - val_accuracy20: 0.3673 - 15s/epoch - 32ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2314 - accuracy20: 0.4052 - val_loss: 3.3021 - val_accuracy20: 0.3684 - 15s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2285 - accuracy20: 0.4081 - val_loss: 3.3011 - val_accuracy20: 0.3704 - 15s/epoch - 30ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2209 - accuracy20: 0.4123 - val_loss: 3.3082 - val_accuracy20: 0.3728 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2180 - accuracy20: 0.4146 - val_loss: 3.3045 - val_accuracy20: 0.3744 - 15s/epoch - 32ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2134 - accuracy20: 0.4151 - val_loss: 3.2923 - val_accuracy20: 0.3754 - 15s/epoch - 30ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2112 - accuracy20: 0.4168 - val_loss: 3.2958 - val_accuracy20: 0.3753 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2080 - accuracy20: 0.4178 - val_loss: 3.2937 - val_accuracy20: 0.3780 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2033 - accuracy20: 0.4201 - val_loss: 3.2840 - val_accuracy20: 0.3778 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2018 - accuracy20: 0.4195 - val_loss: 3.2885 - val_accuracy20: 0.3770 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.1965 - accuracy20: 0.4226 - val_loss: 3.2882 - val_accuracy20: 0.3785 - 15s/epoch - 31ms/step
Epoch 18/50
486/486 - 15s - loss: 3.1924 - accuracy20: 0.4247 - val_loss: 3.2860 - val_accuracy20: 0.3781 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.1898 - accuracy20: 0.4271 - val_loss: 3.2814 - val_accuracy20: 0.3785 - 15s/epoch - 31ms/step
Epoch 20/50
486/486 - 15s - loss: 3.1864 - accuracy20: 0.4269 - val_loss: 3.2872 - val_accuracy20: 0.3790 - 15s/epoch - 31ms/step
Epoch 21/50
486/486 - 15s - loss: 3.1825 - accuracy20: 0.4281 - val_loss: 3.3022 - val_accuracy20: 0.3794 - 15s/epoch - 31ms/step
Epoch 22/50
486/486 - 15s - loss: 3.1798 - accuracy20: 0.4293 - val_loss: 3.2859 - val_accuracy20: 0.3783 - 15s/epoch - 31ms/step
Epoch 23/50
486/486 - 15s - loss: 3.1776 - accuracy20: 0.4327 - val_loss: 3.2894 - val_accuracy20: 0.3809 - 15s/epoch - 31ms/step
Epoch 24/50
486/486 - 15s - loss: 3.1744 - accuracy20: 0.4321 - val_loss: 3.2963 - val_accuracy20: 0.3800 - 15s/epoch - 31ms/step
Epoch 25/50
486/486 - 15s - loss: 3.1727 - accuracy20: 0.4328 - val_loss: 3.2921 - val_accuracy20: 0.3823 - 15s/epoch - 31ms/step
Epoch 26/50
486/486 - 15s - loss: 3.1697 - accuracy20: 0.4340 - val_loss: 3.2961 - val_accuracy20: 0.3809 - 15s/epoch - 31ms/step
Epoch 27/50
486/486 - 15s - loss: 3.1682 - accuracy20: 0.4342 - val_loss: 3.3018 - val_accuracy20: 0.3787 - 15s/epoch - 31ms/step
Epoch 28/50
486/486 - 15s - loss: 3.1635 - accuracy20: 0.4361 - val_loss: 3.3041 - val_accuracy20: 0.3783 - 15s/epoch - 31ms/step
Epoch 29/50
486/486 - 15s - loss: 3.1611 - accuracy20: 0.4377 - val_loss: 3.2997 - val_accuracy20: 0.3797 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepVOL_L2/h20
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0911133
{'0': {'precision': 0.4212771030079869, 'recall': 0.2816484839897988, 'f1-score': 0.33759493066280305, 'support': 112928}, '1': {'precision': 0.3916812083416769, 'recall': 0.13660444373497221, 'f1-score': 0.20256235760570462, 'support': 100231}, '2': {'precision': 0.364970043115516, 'recall': 0.7008288159132655, 'f1-score': 0.47998085378613314, 'support': 111605}, 'accuracy': 0.3809350790112205, 'macro avg': {'precision': 0.3926427848217266, 'recall': 0.3730272478793455, 'f1-score': 0.340046047351547, 'support': 324764}, 'weighted avg': {'precision': 0.3927931099003822, 'recall': 0.3809350790112205, 'f1-score': 0.34485106471735716, 'support': 324764}}
[[31806 11063 70059]
 [20506 13692 66033]
 [23187 10202 78216]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0752801
{'0': {'precision': 0.4399037635332531, 'recall': 0.31029383242823894, 'f1-score': 0.3639025915869383, 'support': 41248}, '1': {'precision': 0.49327091866588646, 'recall': 0.20474085587992422, 'f1-score': 0.28937251132774955, 'support': 41174}, '2': {'precision': 0.3719994876392981, 'recall': 0.6942366074630076, 'f1-score': 0.484424910135693, 'support': 41833}, 'accuracy': 0.40457929258379943, 'macro avg': {'precision': 0.43505805661281255, 'recall': 0.4030904319237236, 'f1-score': 0.3792333376834603, 'support': 124255}, 'weighted avg': {'precision': 0.43472650444475947, 'recall': 0.40457929258379943, 'f1-score': 0.3797821024899861, 'support': 124255}}
[[12799  4330 24119]
 [ 7835  8430 24909]
 [ 8461  4330 29042]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0929109
{'0': {'precision': 0.4093877048170506, 'recall': 0.22258691138053452, 'f1-score': 0.288379762214701, 'support': 14929}, '1': {'precision': 0.44243070362473347, 'recall': 0.13802048689636823, 'f1-score': 0.21040356925572906, 'support': 15034}, '2': {'precision': 0.3621190352459267, 'recall': 0.761457864626856, 'f1-score': 0.49082245701263716, 'support': 15557}, 'accuracy': 0.3788224956063269, 'macro avg': {'precision': 0.40464581456257026, 'recall': 0.37402175430125295, 'f1-score': 0.32986859616102243, 'support': 45520}, 'weighted avg': {'precision': 0.40414626702172396, 'recall': 0.3788224956063269, 'f1-score': 0.33181356972846, 'support': 45520}}
[[ 3323  1348 10258]
 [ 2350  2075 10609]
 [ 2444  1267 11846]]
training model: results/CHTR/W0/deepVOL_L2/h30
Epoch 1/50
486/486 - 18s - loss: 3.3182 - accuracy30: 0.3573 - val_loss: 3.3601 - val_accuracy30: 0.3440 - 18s/epoch - 37ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2872 - accuracy30: 0.3633 - val_loss: 3.3545 - val_accuracy30: 0.3446 - 15s/epoch - 32ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2805 - accuracy30: 0.3679 - val_loss: 3.3321 - val_accuracy30: 0.3500 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2739 - accuracy30: 0.3715 - val_loss: 3.3106 - val_accuracy30: 0.3514 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2677 - accuracy30: 0.3793 - val_loss: 3.3166 - val_accuracy30: 0.3508 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2631 - accuracy30: 0.3833 - val_loss: 3.3136 - val_accuracy30: 0.3562 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2604 - accuracy30: 0.3865 - val_loss: 3.3021 - val_accuracy30: 0.3579 - 15s/epoch - 32ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2536 - accuracy30: 0.3906 - val_loss: 3.3359 - val_accuracy30: 0.3597 - 15s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2522 - accuracy30: 0.3887 - val_loss: 3.3152 - val_accuracy30: 0.3600 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2458 - accuracy30: 0.3948 - val_loss: 3.3069 - val_accuracy30: 0.3616 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2422 - accuracy30: 0.3965 - val_loss: 3.3049 - val_accuracy30: 0.3615 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2414 - accuracy30: 0.3968 - val_loss: 3.3431 - val_accuracy30: 0.3639 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2418 - accuracy30: 0.3988 - val_loss: 3.3118 - val_accuracy30: 0.3621 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2347 - accuracy30: 0.3995 - val_loss: 3.3134 - val_accuracy30: 0.3648 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2323 - accuracy30: 0.4022 - val_loss: 3.3113 - val_accuracy30: 0.3651 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2312 - accuracy30: 0.4034 - val_loss: 3.3341 - val_accuracy30: 0.3650 - 15s/epoch - 32ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2288 - accuracy30: 0.4039 - val_loss: 3.3157 - val_accuracy30: 0.3641 - 15s/epoch - 32ms/step
testing model: results/CHTR/W0/deepVOL_L2/h30
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995296
{'0': {'precision': 0.3813338803891294, 'recall': 0.31877177464483636, 'f1-score': 0.34725752294615336, 'support': 110794}, '1': {'precision': 0.38087924745632556, 'recall': 0.037997108083003765, 'f1-score': 0.06910062953320505, 'support': 104429}, '2': {'precision': 0.35118996612982517, 'recall': 0.710866250992779, 'f1-score': 0.47012406798080114, 'support': 109541}, 'accuracy': 0.3607388749984604, 'macro avg': {'precision': 0.3711343646584267, 'recall': 0.35587837790687304, 'f1-score': 0.29549407348671985, 'support': 324764}, 'weighted avg': {'precision': 0.3710203253940615, 'recall': 0.3607388749984604, 'f1-score': 0.29925736894946525, 'support': 324764}}
[[35318  3355 72121]
 [28722  3968 71739]
 [28577  3095 77869]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0947316
{'0': {'precision': 0.3806693859909776, 'recall': 0.341367699425886, 'f1-score': 0.35994891443167304, 'support': 41281}, '1': {'precision': 0.4686123348017621, 'recall': 0.062104699815121144, 'f1-score': 0.10967437065039952, 'support': 41108}, '2': {'precision': 0.3575341125837531, 'recall': 0.698466536091339, 'f1-score': 0.4729648858912773, 'support': 41866}, 'accuracy': 0.36929701018067684, 'macro avg': {'precision': 0.40227194445883097, 'recall': 0.36731297844411537, 'f1-score': 0.31419605699111663, 'support': 124255}, 'weighted avg': {'precision': 0.40196895046119513, 'recall': 0.36929701018067684, 'f1-score': 0.3152283053243308, 'support': 124255}}
[[14092  1418 25771]
 [11780  2553 26775]
 [11147  1477 29242]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1001222
{'0': {'precision': 0.3690946734424995, 'recall': 0.26199064796259186, 'f1-score': 0.3064541334583529, 'support': 14970}, '1': {'precision': 0.41515341264871636, 'recall': 0.04360981385252911, 'f1-score': 0.07892857142857143, 'support': 15203}, '2': {'precision': 0.34919061777337296, 'recall': 0.7576073499706784, 'f1-score': 0.47804456870323164, 'support': 15347}, 'accuracy': 0.3561511423550088, 'macro avg': {'precision': 0.3778129012881963, 'recall': 0.35440260392859974, 'f1-score': 0.28780909119671866, 'support': 45520}, 'weighted avg': {'precision': 0.37776698165423134, 'recall': 0.3561511423550088, 'f1-score': 0.2883154535410503, 'support': 45520}}
[[ 3922   494 10554]
 [ 3424   663 11116]
 [ 3280   440 11627]]
training model: results/CHTR/W0/deepVOL_L2/h50
Epoch 1/50
486/486 - 18s - loss: 3.3217 - accuracy50: 0.3570 - val_loss: 3.3873 - val_accuracy50: 0.3368 - 18s/epoch - 38ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2952 - accuracy50: 0.3583 - val_loss: 3.3253 - val_accuracy50: 0.3463 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2818 - accuracy50: 0.3628 - val_loss: 3.3240 - val_accuracy50: 0.3498 - 15s/epoch - 32ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2774 - accuracy50: 0.3672 - val_loss: 3.3119 - val_accuracy50: 0.3488 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2741 - accuracy50: 0.3676 - val_loss: 3.3124 - val_accuracy50: 0.3480 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2711 - accuracy50: 0.3742 - val_loss: 3.3181 - val_accuracy50: 0.3508 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2692 - accuracy50: 0.3757 - val_loss: 3.3089 - val_accuracy50: 0.3520 - 15s/epoch - 30ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2656 - accuracy50: 0.3775 - val_loss: 3.3137 - val_accuracy50: 0.3516 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2633 - accuracy50: 0.3765 - val_loss: 3.3138 - val_accuracy50: 0.3531 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2603 - accuracy50: 0.3807 - val_loss: 3.3046 - val_accuracy50: 0.3550 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2582 - accuracy50: 0.3840 - val_loss: 3.3100 - val_accuracy50: 0.3553 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2560 - accuracy50: 0.3863 - val_loss: 3.3045 - val_accuracy50: 0.3547 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2530 - accuracy50: 0.3875 - val_loss: 3.3215 - val_accuracy50: 0.3551 - 15s/epoch - 30ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2502 - accuracy50: 0.3879 - val_loss: 3.3067 - val_accuracy50: 0.3534 - 15s/epoch - 30ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2475 - accuracy50: 0.3909 - val_loss: 3.3157 - val_accuracy50: 0.3536 - 15s/epoch - 30ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2445 - accuracy50: 0.3925 - val_loss: 3.3119 - val_accuracy50: 0.3534 - 15s/epoch - 30ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2459 - accuracy50: 0.3905 - val_loss: 3.3114 - val_accuracy50: 0.3558 - 15s/epoch - 30ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2437 - accuracy50: 0.3950 - val_loss: 3.3121 - val_accuracy50: 0.3537 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2413 - accuracy50: 0.3950 - val_loss: 3.3223 - val_accuracy50: 0.3545 - 15s/epoch - 31ms/step
Epoch 20/50
486/486 - 15s - loss: 3.2388 - accuracy50: 0.3958 - val_loss: 3.3166 - val_accuracy50: 0.3562 - 15s/epoch - 31ms/step
Epoch 21/50
486/486 - 15s - loss: 3.2364 - accuracy50: 0.3982 - val_loss: 3.3281 - val_accuracy50: 0.3540 - 15s/epoch - 31ms/step
Epoch 22/50
486/486 - 15s - loss: 3.2364 - accuracy50: 0.3972 - val_loss: 3.3227 - val_accuracy50: 0.3566 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepVOL_L2/h50
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1029431
{'0': {'precision': 0.37272960181227327, 'recall': 0.2562600239183439, 'f1-score': 0.3037115169094865, 'support': 107867}, '1': {'precision': 0.3898408812729498, 'recall': 0.03487289914049527, 'f1-score': 0.0640190281569823, 'support': 109598}, '2': {'precision': 0.3428544138472336, 'recall': 0.7694293516248987, 'f1-score': 0.4743434320220168, 'support': 107299}, 'accuracy': 0.35109494894754345, 'macro avg': {'precision': 0.3684749656441522, 'recall': 0.3535207582279127, 'f1-score': 0.28069132569616184, 'support': 324764}, 'weighted avg': {'precision': 0.3686336558726692, 'recall': 0.35109494894754345, 'f1-score': 0.2791977668551776, 'support': 324764}}
[[27642  3415 76810]
 [24346  3822 81430]
 [22173  2567 82559]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0943049
{'0': {'precision': 0.3891646952987039, 'recall': 0.2830005815080442, 'f1-score': 0.3276986743354142, 'support': 41272}, '1': {'precision': 0.48160969277369103, 'recall': 0.0541566309028538, 'f1-score': 0.09736468015308912, 'support': 41103}, '2': {'precision': 0.35621513055121623, 'recall': 0.7622731614135626, 'f1-score': 0.48553612167300386, 'support': 41880}, 'accuracy': 0.36883827612570924, 'macro avg': {'precision': 0.4089965062078704, 'recall': 0.3664767912748202, 'f1-score': 0.3035331587205024, 'support': 124255}, 'weighted avg': {'precision': 0.40863947667240813, 'recall': 0.36883827612570924, 'f1-score': 0.304704139963535, 'support': 124255}}
[[11680  1307 28285]
 [ 9466  2226 29411]
 [ 8867  1089 31924]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007421
{'0': {'precision': 0.37605497950325534, 'recall': 0.20854506552554158, 'f1-score': 0.2683010752688172, 'support': 14956}, '1': {'precision': 0.42857142857142855, 'recall': 0.03572373643821117, 'f1-score': 0.06595017098192477, 'support': 15116}, '2': {'precision': 0.3491074904076072, 'recall': 0.81279129984464, 'f1-score': 0.48842727661726376, 'support': 15448}, 'accuracy': 0.3562170474516696, 'macro avg': {'precision': 0.38457796616076373, 'recall': 0.35235336726946426, 'f1-score': 0.27422617428933527, 'support': 45520}, 'weighted avg': {'precision': 0.38434922011320555, 'recall': 0.3562170474516696, 'f1-score': 0.27580927582308207, 'support': 45520}}
[[ 3119   401 11436]
 [ 2602   540 11974]
 [ 2573   319 12556]]
training model: results/CHTR/W0/deepVOL_L2/h100
Epoch 1/50
486/486 - 17s - loss: 3.3267 - accuracy100: 0.3530 - val_loss: 3.3724 - val_accuracy100: 0.3333 - 17s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3012 - accuracy100: 0.3550 - val_loss: 3.3291 - val_accuracy100: 0.3385 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2953 - accuracy100: 0.3565 - val_loss: 3.3151 - val_accuracy100: 0.3426 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2892 - accuracy100: 0.3565 - val_loss: 3.3203 - val_accuracy100: 0.3426 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2880 - accuracy100: 0.3567 - val_loss: 3.3232 - val_accuracy100: 0.3435 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2843 - accuracy100: 0.3593 - val_loss: 3.3135 - val_accuracy100: 0.3373 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 16s - loss: 3.2860 - accuracy100: 0.3566 - val_loss: 3.3091 - val_accuracy100: 0.3427 - 16s/epoch - 33ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2850 - accuracy100: 0.3608 - val_loss: 3.3111 - val_accuracy100: 0.3451 - 15s/epoch - 32ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2808 - accuracy100: 0.3640 - val_loss: 3.3059 - val_accuracy100: 0.3427 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2772 - accuracy100: 0.3666 - val_loss: 3.3047 - val_accuracy100: 0.3450 - 15s/epoch - 31ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2783 - accuracy100: 0.3649 - val_loss: 3.3008 - val_accuracy100: 0.3443 - 15s/epoch - 30ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2745 - accuracy100: 0.3671 - val_loss: 3.3054 - val_accuracy100: 0.3433 - 15s/epoch - 31ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2720 - accuracy100: 0.3673 - val_loss: 3.3038 - val_accuracy100: 0.3452 - 15s/epoch - 31ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2701 - accuracy100: 0.3723 - val_loss: 3.3055 - val_accuracy100: 0.3449 - 15s/epoch - 31ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2691 - accuracy100: 0.3731 - val_loss: 3.3071 - val_accuracy100: 0.3442 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2685 - accuracy100: 0.3736 - val_loss: 3.3090 - val_accuracy100: 0.3423 - 15s/epoch - 31ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2669 - accuracy100: 0.3745 - val_loss: 3.3118 - val_accuracy100: 0.3432 - 15s/epoch - 30ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2630 - accuracy100: 0.3768 - val_loss: 3.3143 - val_accuracy100: 0.3446 - 15s/epoch - 31ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2602 - accuracy100: 0.3786 - val_loss: 3.3148 - val_accuracy100: 0.3419 - 15s/epoch - 30ms/step
Epoch 20/50
486/486 - 15s - loss: 3.2588 - accuracy100: 0.3799 - val_loss: 3.3145 - val_accuracy100: 0.3462 - 15s/epoch - 31ms/step
Epoch 21/50
486/486 - 15s - loss: 3.2566 - accuracy100: 0.3820 - val_loss: 3.3215 - val_accuracy100: 0.3435 - 15s/epoch - 31ms/step
testing model: results/CHTR/W0/deepVOL_L2/h100
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1024506
{'0': {'precision': 0.33872549019607845, 'recall': 0.18813508231152945, 'f1-score': 0.2419089653102944, 'support': 102841}, '1': {'precision': 0.3939733931719827, 'recall': 0.02091487696130152, 'f1-score': 0.03972107980575778, 'support': 117524}, '2': {'precision': 0.32567854478682506, 'recall': 0.8154675811070987, 'f1-score': 0.46546237876021046, 'support': 104399}, 'accuracy': 0.32928526560825705, 'macro avg': {'precision': 0.3527924760516288, 'recall': 0.34150584679330986, 'f1-score': 0.2490308079587542, 'support': 324764}, 'weighted avg': {'precision': 0.35452424404675015, 'recall': 0.32928526560825705, 'f1-score': 0.24060593835756144, 'support': 324764}}
[[19348  1891 81602]
 [20397  2458 94669]
 [17375  1890 85134]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0978079
{'0': {'precision': 0.3619166630757961, 'recall': 0.20466396997904382, 'f1-score': 0.2614678185072768, 'support': 41038}, '1': {'precision': 0.4094283593170007, 'recall': 0.026850048685491724, 'f1-score': 0.05039521176954357, 'support': 41080}, '2': {'precision': 0.3490249506883299, 'recall': 0.8146759380117237, 'f1-score': 0.4886861080069186, 'support': 42137}, 'accuracy': 0.3527423443724599, 'macro avg': {'precision': 0.3734566576937089, 'recall': 0.34872998555875306, 'f1-score': 0.2668497127612463, 'support': 124255}, 'weighted avg': {'precision': 0.37325272517967945, 'recall': 0.3527423443724599, 'f1-score': 0.2687386275681623, 'support': 124255}}
[[ 8399   830 31809]
 [ 7760  1103 32217]
 [ 7048   761 34328]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0994104
{'0': {'precision': 0.3396992481203008, 'recall': 0.15380949138694083, 'f1-score': 0.21174485635281437, 'support': 14687}, '1': {'precision': 0.3681592039800995, 'recall': 0.01934640522875817, 'f1-score': 0.03676105315449577, 'support': 15300}, '2': {'precision': 0.3442967477539011, 'recall': 0.8437520118457478, 'f1-score': 0.48903897460773516, 'support': 15533}, 'accuracy': 0.34404657293497365, 'macro avg': {'precision': 0.35071839995143383, 'recall': 0.33896930282048227, 'f1-score': 0.2458482947050151, 'support': 45520}, 'weighted avg': {'precision': 0.35083392049428225, 'recall': 0.34404657293497365, 'f1-score': 0.24755235525262564, 'support': 45520}}
[[ 2259   260 12168]
 [ 2212   296 12792]
 [ 2179   248 13106]]
training model: results/CHTR/W0/deepVOL_L2/h200
Epoch 1/50
486/486 - 17s - loss: 3.3291 - accuracy200: 0.3559 - val_loss: 3.3357 - val_accuracy200: 0.3430 - 17s/epoch - 34ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2983 - accuracy200: 0.3586 - val_loss: 3.3087 - val_accuracy200: 0.3430 - 15s/epoch - 30ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2911 - accuracy200: 0.3575 - val_loss: 3.3104 - val_accuracy200: 0.3480 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 16s - loss: 3.2862 - accuracy200: 0.3610 - val_loss: 3.3129 - val_accuracy200: 0.3476 - 16s/epoch - 32ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2814 - accuracy200: 0.3666 - val_loss: 3.3011 - val_accuracy200: 0.3478 - 15s/epoch - 30ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2776 - accuracy200: 0.3685 - val_loss: 3.3022 - val_accuracy200: 0.3499 - 15s/epoch - 30ms/step
Epoch 7/50
486/486 - 14s - loss: 3.2769 - accuracy200: 0.3688 - val_loss: 3.3012 - val_accuracy200: 0.3504 - 14s/epoch - 29ms/step
Epoch 8/50
486/486 - 14s - loss: 3.2744 - accuracy200: 0.3707 - val_loss: 3.2995 - val_accuracy200: 0.3533 - 14s/epoch - 29ms/step
Epoch 9/50
486/486 - 14s - loss: 3.2705 - accuracy200: 0.3745 - val_loss: 3.2997 - val_accuracy200: 0.3476 - 14s/epoch - 30ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2695 - accuracy200: 0.3753 - val_loss: 3.3024 - val_accuracy200: 0.3480 - 15s/epoch - 30ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2682 - accuracy200: 0.3772 - val_loss: 3.3005 - val_accuracy200: 0.3501 - 15s/epoch - 31ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2663 - accuracy200: 0.3768 - val_loss: 3.3018 - val_accuracy200: 0.3439 - 15s/epoch - 30ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2639 - accuracy200: 0.3812 - val_loss: 3.3014 - val_accuracy200: 0.3484 - 15s/epoch - 30ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2624 - accuracy200: 0.3805 - val_loss: 3.3000 - val_accuracy200: 0.3515 - 15s/epoch - 30ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2617 - accuracy200: 0.3825 - val_loss: 3.3020 - val_accuracy200: 0.3470 - 15s/epoch - 31ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2589 - accuracy200: 0.3828 - val_loss: 3.3009 - val_accuracy200: 0.3480 - 15s/epoch - 30ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2554 - accuracy200: 0.3858 - val_loss: 3.3027 - val_accuracy200: 0.3451 - 15s/epoch - 30ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2547 - accuracy200: 0.3854 - val_loss: 3.3037 - val_accuracy200: 0.3493 - 15s/epoch - 30ms/step
testing model: results/CHTR/W0/deepVOL_L2/h200
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019478
{'0': {'precision': 0.3365540963101939, 'recall': 0.10545034144238588, 'f1-score': 0.1605854662916738, 'support': 102067}, '1': {'precision': 0.3755245652293427, 'recall': 0.17596798708491837, 'f1-score': 0.23964168352609605, 'support': 116453}, '2': {'precision': 0.33063409105220076, 'recall': 0.7413312751778924, 'f1-score': 0.4573084169668959, 'support': 106244}, 'accuracy': 0.3387598379130692, 'macro avg': {'precision': 0.34757091753057906, 'recall': 0.3409165345683989, 'f1-score': 0.2858451889282219, 'support': 324764}, 'weighted avg': {'precision': 0.34859133867206715, 'recall': 0.3387598379130692, 'f1-score': 0.2860038218887796, 'support': 324764}}
[[10763 16763 74541]
 [11049 20492 84912]
 [10168 17314 78762]]
Evaluating performance on  train set...
486/486 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096161
{'0': {'precision': 0.3578874750881496, 'recall': 0.11355952815274231, 'f1-score': 0.1724118830893078, 'support': 41115}, '1': {'precision': 0.37809602576938145, 'recall': 0.2121589604552893, 'f1-score': 0.2718027349250556, 'support': 40941}, '2': {'precision': 0.3533478398839476, 'recall': 0.7388326737600417, 'f1-score': 0.47806186989688354, 'support': 42199}, 'accuracy': 0.358400064383727, 'macro avg': {'precision': 0.3631104469138262, 'recall': 0.3548503874560245, 'f1-score': 0.30742549597041563, 'support': 124255}, 'weighted avg': {'precision': 0.3630042929824652, 'recall': 0.358400064383727, 'f1-score': 0.30896401103828564, 'support': 124255}}
[[ 4669  7261 29185]
 [ 4382  8686 27873]
 [ 3995  7026 31178]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0995364
{'0': {'precision': 0.3266871165644172, 'recall': 0.08735475051264525, 'f1-score': 0.13784920720526372, 'support': 14630}, '1': {'precision': 0.34453376205787783, 'recall': 0.14338284490833667, 'f1-score': 0.20249456675800812, 'support': 14946}, '2': {'precision': 0.3536226969594213, 'recall': 0.7848720521826392, 'f1-score': 0.4875711057430064, 'support': 15944}, 'accuracy': 0.3500659050966608, 'macro avg': {'precision': 0.3416145251939054, 'recall': 0.33853654920120707, 'f1-score': 0.27597162656875945, 'support': 45520}, 'weighted avg': {'precision': 0.34198142362424155, 'recall': 0.3500659050966608, 'f1-score': 0.28156967060950555, 'support': 45520}}
[[ 1278  2019 11333]
 [ 1262  2143 11541]
 [ 1372  2058 12514]]
training model: results/CHTR/W0/deepVOL_L2/h300
Epoch 1/50
486/486 - 17s - loss: 3.3233 - accuracy300: 0.3598 - val_loss: 3.3626 - val_accuracy300: 0.3366 - 17s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3004 - accuracy300: 0.3595 - val_loss: 3.3226 - val_accuracy300: 0.3337 - 15s/epoch - 30ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2929 - accuracy300: 0.3579 - val_loss: 3.3090 - val_accuracy300: 0.3404 - 15s/epoch - 30ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2810 - accuracy300: 0.3683 - val_loss: 3.3091 - val_accuracy300: 0.3483 - 15s/epoch - 30ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2776 - accuracy300: 0.3708 - val_loss: 3.3097 - val_accuracy300: 0.3475 - 15s/epoch - 30ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2748 - accuracy300: 0.3720 - val_loss: 3.3075 - val_accuracy300: 0.3491 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2731 - accuracy300: 0.3747 - val_loss: 3.3087 - val_accuracy300: 0.3454 - 15s/epoch - 31ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2710 - accuracy300: 0.3747 - val_loss: 3.3066 - val_accuracy300: 0.3463 - 15s/epoch - 31ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2700 - accuracy300: 0.3758 - val_loss: 3.3098 - val_accuracy300: 0.3496 - 15s/epoch - 31ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2672 - accuracy300: 0.3785 - val_loss: 3.3111 - val_accuracy300: 0.3483 - 15s/epoch - 30ms/step
Epoch 11/50
486/486 - 14s - loss: 3.2666 - accuracy300: 0.3795 - val_loss: 3.3098 - val_accuracy300: 0.3495 - 14s/epoch - 29ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2658 - accuracy300: 0.3795 - val_loss: 3.3100 - val_accuracy300: 0.3475 - 15s/epoch - 30ms/step
Epoch 13/50
486/486 - 14s - loss: 3.2625 - accuracy300: 0.3818 - val_loss: 3.3118 - val_accuracy300: 0.3483 - 14s/epoch - 30ms/step
Epoch 14/50
486/486 - 14s - loss: 3.2622 - accuracy300: 0.3828 - val_loss: 3.3139 - val_accuracy300: 0.3484 - 14s/epoch - 30ms/step
Epoch 15/50
486/486 - 14s - loss: 3.2611 - accuracy300: 0.3843 - val_loss: 3.3165 - val_accuracy300: 0.3489 - 14s/epoch - 30ms/step
Epoch 16/50
486/486 - 14s - loss: 3.2616 - accuracy300: 0.3826 - val_loss: 3.3141 - val_accuracy300: 0.3497 - 14s/epoch - 30ms/step
Epoch 17/50
486/486 - 14s - loss: 3.2597 - accuracy300: 0.3841 - val_loss: 3.3220 - val_accuracy300: 0.3496 - 14s/epoch - 30ms/step
Epoch 18/50
486/486 - 14s - loss: 3.2575 - accuracy300: 0.3865 - val_loss: 3.3223 - val_accuracy300: 0.3504 - 14s/epoch - 30ms/step
testing model: results/CHTR/W0/deepVOL_L2/h300
Evaluating performance on  test set...
1269/1269 - 21s - 21s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1057059
{'0': {'precision': 0.328420602953741, 'recall': 0.21327441519453885, 'f1-score': 0.2586094008109326, 'support': 100931}, '1': {'precision': 0.3888571624368961, 'recall': 0.14552557789632062, 'f1-score': 0.2117907597369878, 'support': 116976}, '2': {'precision': 0.33037044601124194, 'recall': 0.6660864519872353, 'f1-score': 0.4416754576481539, 'support': 106857}, 'accuracy': 0.3378607234792034, 'macro avg': {'precision': 0.349216070467293, 'recall': 0.3416288150260316, 'f1-score': 0.3040252060653581, 'support': 324764}, 'weighted avg': {'precision': 0.35083066491164566, 'recall': 0.3378607234792034, 'f1-score': 0.30198007082728046, 'support': 324764}}
[[21526 12667 66738]
 [22424 17023 77529]
 [21594 14087 71176]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971397
{'0': {'precision': 0.3443938154768859, 'recall': 0.21453698537082413, 'f1-score': 0.2643805309734513, 'support': 41219}, '1': {'precision': 0.3903932584269663, 'recall': 0.16939690897567158, 'f1-score': 0.23627214307571998, 'support': 41022}, '2': {'precision': 0.3479536507464904, 'recall': 0.6689912886180797, 'f1-score': 0.4577985536517037, 'support': 42014}, 'accuracy': 0.35329765401794694, 'macro avg': {'precision': 0.36091357488344755, 'recall': 0.3509750609881918, 'f1-score': 0.31948374256695833, 'support': 124255}, 'weighted avg': {'precision': 0.36078391702382856, 'recall': 0.35329765401794694, 'f1-score': 0.32050062687674186, 'support': 124255}}
[[ 8843  5384 26992]
 [ 8394  6949 25679]
 [ 8440  5467 28107]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014799
{'0': {'precision': 0.327742088984059, 'recall': 0.1879263301500682, 'f1-score': 0.23887973640856672, 'support': 14660}, '1': {'precision': 0.34241941902109035, 'recall': 0.11595472308314243, 'f1-score': 0.1732434064827864, 'support': 14842}, '2': {'precision': 0.3556158065320369, 'recall': 0.7123860656761144, 'f1-score': 0.4744106764228994, 'support': 16018}, 'accuracy': 0.34901142355008785, 'macro avg': {'precision': 0.3419257715123954, 'recall': 0.33875570630310836, 'f1-score': 0.29551127310475084, 'support': 45520}, 'weighted avg': {'precision': 0.34233616060297656, 'recall': 0.34901142355008785, 'f1-score': 0.30035952965090307, 'support': 45520}}
[[ 2755  1595 10310]
 [ 2754  1721 10367]
 [ 2897  1710 11411]]
training model: results/CHTR/W0/deepVOL_L2/h500
Epoch 1/50
486/486 - 17s - loss: 3.3252 - accuracy500: 0.3612 - val_loss: 3.3294 - val_accuracy500: 0.3337 - 17s/epoch - 35ms/step
Epoch 2/50
486/486 - 15s - loss: 3.2932 - accuracy500: 0.3673 - val_loss: 3.3257 - val_accuracy500: 0.3319 - 15s/epoch - 31ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2875 - accuracy500: 0.3637 - val_loss: 3.3071 - val_accuracy500: 0.3430 - 15s/epoch - 32ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2810 - accuracy500: 0.3665 - val_loss: 3.3192 - val_accuracy500: 0.3407 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2784 - accuracy500: 0.3695 - val_loss: 3.3132 - val_accuracy500: 0.3488 - 15s/epoch - 31ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2726 - accuracy500: 0.3727 - val_loss: 3.3101 - val_accuracy500: 0.3474 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 14s - loss: 3.2725 - accuracy500: 0.3744 - val_loss: 3.3097 - val_accuracy500: 0.3478 - 14s/epoch - 30ms/step
Epoch 8/50
486/486 - 14s - loss: 3.2662 - accuracy500: 0.3792 - val_loss: 3.3064 - val_accuracy500: 0.3512 - 14s/epoch - 30ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2633 - accuracy500: 0.3798 - val_loss: 3.3029 - val_accuracy500: 0.3500 - 15s/epoch - 30ms/step
Epoch 10/50
486/486 - 14s - loss: 3.2605 - accuracy500: 0.3833 - val_loss: 3.3068 - val_accuracy500: 0.3497 - 14s/epoch - 30ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2588 - accuracy500: 0.3835 - val_loss: 3.3025 - val_accuracy500: 0.3512 - 15s/epoch - 30ms/step
Epoch 12/50
486/486 - 14s - loss: 3.2581 - accuracy500: 0.3833 - val_loss: 3.3029 - val_accuracy500: 0.3494 - 14s/epoch - 30ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2553 - accuracy500: 0.3860 - val_loss: 3.3032 - val_accuracy500: 0.3524 - 15s/epoch - 30ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2542 - accuracy500: 0.3876 - val_loss: 3.3029 - val_accuracy500: 0.3518 - 15s/epoch - 30ms/step
Epoch 15/50
486/486 - 14s - loss: 3.2511 - accuracy500: 0.3884 - val_loss: 3.3053 - val_accuracy500: 0.3529 - 14s/epoch - 30ms/step
Epoch 16/50
486/486 - 14s - loss: 3.2508 - accuracy500: 0.3880 - val_loss: 3.3050 - val_accuracy500: 0.3506 - 14s/epoch - 30ms/step
Epoch 17/50
486/486 - 14s - loss: 3.2484 - accuracy500: 0.3905 - val_loss: 3.3036 - val_accuracy500: 0.3507 - 14s/epoch - 30ms/step
Epoch 18/50
486/486 - 14s - loss: 3.2475 - accuracy500: 0.3916 - val_loss: 3.3049 - val_accuracy500: 0.3518 - 14s/epoch - 30ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2458 - accuracy500: 0.3909 - val_loss: 3.3073 - val_accuracy500: 0.3519 - 15s/epoch - 30ms/step
Epoch 20/50
486/486 - 14s - loss: 3.2449 - accuracy500: 0.3916 - val_loss: 3.3054 - val_accuracy500: 0.3506 - 14s/epoch - 30ms/step
Epoch 21/50
486/486 - 15s - loss: 3.2421 - accuracy500: 0.3921 - val_loss: 3.3042 - val_accuracy500: 0.3535 - 15s/epoch - 30ms/step
testing model: results/CHTR/W0/deepVOL_L2/h500
Evaluating performance on  test set...
1269/1269 - 20s - 20s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994169
{'0': {'precision': 0.34733792104310035, 'recall': 0.11447784652726657, 'f1-score': 0.17220069131664395, 'support': 100526}, '1': {'precision': 0.3964998516886309, 'recall': 0.3179516803153352, 'f1-score': 0.352907897714415, 'support': 117716}, '2': {'precision': 0.32960007300898414, 'recall': 0.6102870768479751, 'f1-score': 0.42803152509563536, 'support': 106522}, 'accuracy': 0.35085477454397657, 'macro avg': {'precision': 0.35781261524690516, 'recall': 0.3475722012301923, 'f1-score': 0.31771337137556477, 'support': 324764}, 'weighted avg': {'precision': 0.35933948149801265, 'recall': 0.35085477454397657, 'f1-score': 0.3216130079038449, 'support': 324764}}
[[11508 26517 62501]
 [10562 37428 69726]
 [11062 30451 65009]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0938109
{'0': {'precision': 0.368539145764885, 'recall': 0.11066993935893733, 'f1-score': 0.17022300360877207, 'support': 41556}, '1': {'precision': 0.3904471491285718, 'recall': 0.36192402348985114, 'f1-score': 0.3756449165402124, 'support': 41039}, '2': {'precision': 0.3532243846206008, 'recall': 0.6251800288046088, 'f1-score': 0.45140604012305563, 'support': 41660}, 'accuracy': 0.3661583034887932, 'macro avg': {'precision': 0.37073689317135256, 'recall': 0.36592466388446576, 'f1-score': 0.33242465342401334, 'support': 124255}, 'weighted avg': {'precision': 0.3706402250033178, 'recall': 0.3661583034887932, 'f1-score': 0.3323444086707691, 'support': 124255}}
[[ 4599 11585 25372]
 [ 3868 14853 22318]
 [ 4012 11603 26045]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1006905
{'0': {'precision': 0.312198649951784, 'recall': 0.08955120669386626, 'f1-score': 0.1391799666827879, 'support': 14461}, '1': {'precision': 0.34666422622860804, 'recall': 0.25046284051838136, 'f1-score': 0.29081417220068323, 'support': 15124}, '2': {'precision': 0.35624897355887664, 'recall': 0.6806401004079071, 'f1-score': 0.4677015955153083, 'support': 15935}, 'accuracy': 0.3499340949033392, 'macro avg': {'precision': 0.33837061657975626, 'recall': 0.3402180492067182, 'f1-score': 0.2992319114662598, 'support': 45520}, 'weighted avg': {'precision': 0.33907033893002886, 'recall': 0.3499340949033392, 'f1-score': 0.304564586184081, 'support': 45520}}
[[ 1295  3594  9572]
 [ 1309  3788 10027]
 [ 1544  3545 10846]]
training model: results/CHTR/W0/deepVOL_L2/h1000
Epoch 1/50
486/486 - 18s - loss: 3.3159 - accuracy1000: 0.3625 - val_loss: 3.3284 - val_accuracy1000: 0.3313 - 18s/epoch - 36ms/step
Epoch 2/50
486/486 - 15s - loss: 3.3008 - accuracy1000: 0.3598 - val_loss: 3.3117 - val_accuracy1000: 0.3279 - 15s/epoch - 30ms/step
Epoch 3/50
486/486 - 15s - loss: 3.2898 - accuracy1000: 0.3600 - val_loss: 3.3240 - val_accuracy1000: 0.3389 - 15s/epoch - 31ms/step
Epoch 4/50
486/486 - 15s - loss: 3.2942 - accuracy1000: 0.3605 - val_loss: 3.3096 - val_accuracy1000: 0.3348 - 15s/epoch - 31ms/step
Epoch 5/50
486/486 - 15s - loss: 3.2877 - accuracy1000: 0.3614 - val_loss: 3.3133 - val_accuracy1000: 0.3479 - 15s/epoch - 30ms/step
Epoch 6/50
486/486 - 15s - loss: 3.2830 - accuracy1000: 0.3654 - val_loss: 3.3042 - val_accuracy1000: 0.3419 - 15s/epoch - 31ms/step
Epoch 7/50
486/486 - 15s - loss: 3.2806 - accuracy1000: 0.3690 - val_loss: 3.3077 - val_accuracy1000: 0.3467 - 15s/epoch - 30ms/step
Epoch 8/50
486/486 - 15s - loss: 3.2738 - accuracy1000: 0.3752 - val_loss: 3.3052 - val_accuracy1000: 0.3406 - 15s/epoch - 30ms/step
Epoch 9/50
486/486 - 15s - loss: 3.2707 - accuracy1000: 0.3756 - val_loss: 3.3080 - val_accuracy1000: 0.3384 - 15s/epoch - 30ms/step
Epoch 10/50
486/486 - 15s - loss: 3.2693 - accuracy1000: 0.3782 - val_loss: 3.3029 - val_accuracy1000: 0.3402 - 15s/epoch - 30ms/step
Epoch 11/50
486/486 - 15s - loss: 3.2659 - accuracy1000: 0.3807 - val_loss: 3.2979 - val_accuracy1000: 0.3433 - 15s/epoch - 30ms/step
Epoch 12/50
486/486 - 15s - loss: 3.2658 - accuracy1000: 0.3811 - val_loss: 3.2975 - val_accuracy1000: 0.3454 - 15s/epoch - 30ms/step
Epoch 13/50
486/486 - 15s - loss: 3.2628 - accuracy1000: 0.3842 - val_loss: 3.2978 - val_accuracy1000: 0.3459 - 15s/epoch - 30ms/step
Epoch 14/50
486/486 - 15s - loss: 3.2616 - accuracy1000: 0.3853 - val_loss: 3.2980 - val_accuracy1000: 0.3448 - 15s/epoch - 30ms/step
Epoch 15/50
486/486 - 15s - loss: 3.2595 - accuracy1000: 0.3861 - val_loss: 3.3019 - val_accuracy1000: 0.3389 - 15s/epoch - 30ms/step
Epoch 16/50
486/486 - 15s - loss: 3.2587 - accuracy1000: 0.3856 - val_loss: 3.3026 - val_accuracy1000: 0.3426 - 15s/epoch - 30ms/step
Epoch 17/50
486/486 - 15s - loss: 3.2581 - accuracy1000: 0.3845 - val_loss: 3.3005 - val_accuracy1000: 0.3456 - 15s/epoch - 30ms/step
Epoch 18/50
486/486 - 15s - loss: 3.2575 - accuracy1000: 0.3838 - val_loss: 3.3002 - val_accuracy1000: 0.3435 - 15s/epoch - 32ms/step
Epoch 19/50
486/486 - 15s - loss: 3.2552 - accuracy1000: 0.3861 - val_loss: 3.3037 - val_accuracy1000: 0.3410 - 15s/epoch - 31ms/step
Epoch 20/50
486/486 - 15s - loss: 3.2550 - accuracy1000: 0.3861 - val_loss: 3.3026 - val_accuracy1000: 0.3421 - 15s/epoch - 31ms/step
Epoch 21/50
486/486 - 15s - loss: 3.2527 - accuracy1000: 0.3864 - val_loss: 3.3008 - val_accuracy1000: 0.3444 - 15s/epoch - 31ms/step
Epoch 22/50
486/486 - 14s - loss: 3.2501 - accuracy1000: 0.3897 - val_loss: 3.3028 - val_accuracy1000: 0.3461 - 14s/epoch - 30ms/step
testing model: results/CHTR/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
1269/1269 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0994759
{'0': {'precision': 0.2993104554201411, 'recall': 0.15373527716003624, 'f1-score': 0.20313435272351307, 'support': 97128}, '1': {'precision': 0.39813239303798764, 'recall': 0.3097269624573379, 'f1-score': 0.34840914595312206, 'support': 125404}, '2': {'precision': 0.3241069716554439, 'recall': 0.5621527506064637, 'f1-score': 0.41116079413342876, 'support': 102232}, 'accuracy': 0.3425348868716976, 'macro avg': {'precision': 0.3405166067045242, 'recall': 0.34187166340794595, 'f1-score': 0.32090143093668794, 'support': 324764}, 'weighted avg': {'precision': 0.34527510579024345, 'recall': 0.3425348868716976, 'f1-score': 0.32471494456369365, 'support': 324764}}
[[14932 29100 53096]
 [19811 38841 66752]
 [15145 29617 57470]]
Evaluating performance on  train set...
486/486 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976754
{'0': {'precision': 0.3452786968694324, 'recall': 0.1631156213928434, 'f1-score': 0.2215616782896993, 'support': 41584}, '1': {'precision': 0.3484466151132818, 'recall': 0.3128380024360536, 'f1-score': 0.32968358898658623, 'support': 41050}, '2': {'precision': 0.3441812412368091, 'recall': 0.5602940823142164, 'f1-score': 0.42641895845523703, 'support': 41621}, 'accuracy': 0.345619894571647, 'macro avg': {'precision': 0.34596885107317443, 'recall': 0.3454159020477045, 'f1-score': 0.32588807524384084, 'support': 124255}, 'weighted avg': {'precision': 0.3459576702952471, 'recall': 0.345619894571647, 'f1-score': 0.3259016991490373, 'support': 124255}}
[[ 6783 11907 22894]
 [ 6667 12842 21541]
 [ 6195 12106 23320]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991071
{'0': {'precision': 0.3076798444588464, 'recall': 0.13507361832278256, 'f1-score': 0.18773169887795954, 'support': 14059}, '1': {'precision': 0.34306351924938566, 'recall': 0.29726416311782167, 'f1-score': 0.3185259446192139, 'support': 15498}, '2': {'precision': 0.35337011458775414, 'recall': 0.5737643300131554, 'f1-score': 0.43737166324435317, 'support': 15963}, 'accuracy': 0.34413444639718804, 'macro avg': {'precision': 0.3347044927653287, 'recall': 0.33536737048458654, 'f1-score': 0.3145431022471756, 'support': 45520}, 'weighted avg': {'precision': 0.33574948360584844, 'recall': 0.34413444639718804, 'f1-score': 0.3198066543190558, 'support': 45520}}
[[1899 4178 7982]
 [2113 4607 8778]
 [2160 4644 9159]]
training model: results/CHTR/W0/deepVOL_L3/h10
Epoch 1/50
486/486 - 23s - loss: 3.3150 - accuracy10: 0.3538 - val_loss: 3.4519 - val_accuracy10: 0.3361 - 23s/epoch - 48ms/step
Epoch 2/50
486/486 - 21s - loss: 3.2909 - accuracy10: 0.3563 - val_loss: 3.4199 - val_accuracy10: 0.3375 - 21s/epoch - 42ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2855 - accuracy10: 0.3599 - val_loss: 3.3703 - val_accuracy10: 0.3434 - 21s/epoch - 43ms/step
Epoch 4/50
486/486 - 20s - loss: 3.2767 - accuracy10: 0.3690 - val_loss: 3.3946 - val_accuracy10: 0.3527 - 20s/epoch - 42ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2648 - accuracy10: 0.3799 - val_loss: 3.3811 - val_accuracy10: 0.3520 - 21s/epoch - 44ms/step
Epoch 6/50
486/486 - 20s - loss: 3.2537 - accuracy10: 0.3886 - val_loss: 3.3346 - val_accuracy10: 0.3508 - 20s/epoch - 42ms/step
Epoch 7/50
486/486 - 21s - loss: 3.2405 - accuracy10: 0.3978 - val_loss: 3.3144 - val_accuracy10: 0.3596 - 21s/epoch - 42ms/step
Epoch 8/50
486/486 - 21s - loss: 3.2305 - accuracy10: 0.4057 - val_loss: 3.2983 - val_accuracy10: 0.3719 - 21s/epoch - 42ms/step
Epoch 9/50
486/486 - 21s - loss: 3.2206 - accuracy10: 0.4111 - val_loss: 3.2910 - val_accuracy10: 0.3728 - 21s/epoch - 42ms/step
Epoch 10/50
486/486 - 20s - loss: 3.2169 - accuracy10: 0.4124 - val_loss: 3.2944 - val_accuracy10: 0.3746 - 20s/epoch - 42ms/step
Epoch 11/50
486/486 - 20s - loss: 3.2092 - accuracy10: 0.4161 - val_loss: 3.2898 - val_accuracy10: 0.3792 - 20s/epoch - 42ms/step
Epoch 12/50
486/486 - 21s - loss: 3.2061 - accuracy10: 0.4184 - val_loss: 3.3236 - val_accuracy10: 0.3765 - 21s/epoch - 44ms/step
Epoch 13/50
486/486 - 21s - loss: 3.2023 - accuracy10: 0.4205 - val_loss: 3.3191 - val_accuracy10: 0.3781 - 21s/epoch - 43ms/step
Epoch 14/50
486/486 - 20s - loss: 3.1990 - accuracy10: 0.4214 - val_loss: 3.3095 - val_accuracy10: 0.3812 - 20s/epoch - 42ms/step
Epoch 15/50
486/486 - 20s - loss: 3.1950 - accuracy10: 0.4236 - val_loss: 3.2882 - val_accuracy10: 0.3810 - 20s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 3.1917 - accuracy10: 0.4245 - val_loss: 3.2698 - val_accuracy10: 0.3863 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 21s - loss: 3.1868 - accuracy10: 0.4272 - val_loss: 3.2767 - val_accuracy10: 0.3863 - 21s/epoch - 42ms/step
Epoch 18/50
486/486 - 20s - loss: 3.1848 - accuracy10: 0.4279 - val_loss: 3.2868 - val_accuracy10: 0.3862 - 20s/epoch - 42ms/step
Epoch 19/50
486/486 - 20s - loss: 3.1835 - accuracy10: 0.4281 - val_loss: 3.2980 - val_accuracy10: 0.3822 - 20s/epoch - 42ms/step
Epoch 20/50
486/486 - 20s - loss: 3.1801 - accuracy10: 0.4289 - val_loss: 3.2880 - val_accuracy10: 0.3865 - 20s/epoch - 42ms/step
Epoch 21/50
486/486 - 22s - loss: 3.1763 - accuracy10: 0.4321 - val_loss: 3.3033 - val_accuracy10: 0.3821 - 22s/epoch - 45ms/step
Epoch 22/50
486/486 - 22s - loss: 3.1749 - accuracy10: 0.4313 - val_loss: 3.2757 - val_accuracy10: 0.3874 - 22s/epoch - 45ms/step
Epoch 23/50
486/486 - 21s - loss: 3.1714 - accuracy10: 0.4334 - val_loss: 3.2844 - val_accuracy10: 0.3867 - 21s/epoch - 42ms/step
Epoch 24/50
486/486 - 21s - loss: 3.1683 - accuracy10: 0.4347 - val_loss: 3.2824 - val_accuracy10: 0.3855 - 21s/epoch - 43ms/step
Epoch 25/50
486/486 - 20s - loss: 3.1660 - accuracy10: 0.4355 - val_loss: 3.2911 - val_accuracy10: 0.3869 - 20s/epoch - 42ms/step
Epoch 26/50
486/486 - 20s - loss: 3.1639 - accuracy10: 0.4359 - val_loss: 3.2757 - val_accuracy10: 0.3870 - 20s/epoch - 42ms/step
testing model: results/CHTR/W0/deepVOL_L3/h10
Evaluating performance on  test set...
1269/1269 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0888838
{'0': {'precision': 0.42582788710796304, 'recall': 0.31023842668534596, 'f1-score': 0.35895726039764453, 'support': 112781}, '1': {'precision': 0.4294508648689478, 'recall': 0.11246612466124661, 'f1-score': 0.17825119137195886, 'support': 101106}, '2': {'precision': 0.3659743011951749, 'recall': 0.7133490263986219, 'f1-score': 0.48376126925099994, 'support': 110877}, 'accuracy': 0.38629281570617435, 'macro avg': {'precision': 0.4070843510573619, 'recall': 0.37868452591507146, 'f1-score': 0.34032324034020106, 'support': 324764}, 'weighted avg': {'precision': 0.40652130985263274, 'recall': 0.38629281570617435, 'f1-score': 0.3453086610292494, 'support': 324764}}
[[34989  7933 69859]
 [22569 11371 67166]
 [24609  7174 79094]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.079905
{'0': {'precision': 0.42468731293910084, 'recall': 0.3265741211812874, 'f1-score': 0.3692240269522583, 'support': 41277}, '1': {'precision': 0.5066964285714286, 'recall': 0.1605413973905621, 'f1-score': 0.24382836083486117, 'support': 41005}, '2': {'precision': 0.3694575086139685, 'recall': 0.6999737926762443, 'f1-score': 0.483641302111198, 'support': 41973}, 'accuracy': 0.3979155768379542, 'macro avg': {'precision': 0.4336137500414993, 'recall': 0.3956964370826979, 'f1-score': 0.36556456329943915, 'support': 124255}, 'weighted avg': {'precision': 0.4330944048836087, 'recall': 0.3979155768379542, 'f1-score': 0.3664924427190468, 'support': 124255}}
[[13480  3219 24578]
 [ 8858  6583 25564]
 [ 9403  3190 29380]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0887042
{'0': {'precision': 0.40172808661253384, 'recall': 0.26083136194660356, 'f1-score': 0.316298512356051, 'support': 14795}, '1': {'precision': 0.48783314020857477, 'recall': 0.11333961502221025, 'f1-score': 0.1839432004369197, 'support': 14858}, '2': {'precision': 0.3699402378165239, 'recall': 0.7568538476082435, 'f1-score': 0.4969686937449564, 'support': 15867}, 'accuracy': 0.3855887521968366, 'macro avg': {'precision': 0.4198338215458775, 'recall': 0.3770082748590191, 'f1-score': 0.33240346884597566, 'support': 45520}, 'weighted avg': {'precision': 0.41875293479978526, 'recall': 0.3855887521968366, 'f1-score': 0.3360735242981272, 'support': 45520}}
[[ 3859   878 10058]
 [ 2779  1684 10395]
 [ 2968   890 12009]]
training model: results/CHTR/W0/deepVOL_L3/h20
Epoch 1/50
486/486 - 24s - loss: 3.3149 - accuracy20: 0.3590 - val_loss: 3.3995 - val_accuracy20: 0.3344 - 24s/epoch - 50ms/step
Epoch 2/50
486/486 - 22s - loss: 3.2960 - accuracy20: 0.3581 - val_loss: 3.3459 - val_accuracy20: 0.3436 - 22s/epoch - 45ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2846 - accuracy20: 0.3596 - val_loss: 3.3914 - val_accuracy20: 0.3433 - 21s/epoch - 44ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2816 - accuracy20: 0.3649 - val_loss: 3.4157 - val_accuracy20: 0.3451 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2756 - accuracy20: 0.3674 - val_loss: 3.4243 - val_accuracy20: 0.3453 - 21s/epoch - 43ms/step
Epoch 6/50
486/486 - 22s - loss: 3.2706 - accuracy20: 0.3721 - val_loss: 3.3702 - val_accuracy20: 0.3523 - 22s/epoch - 44ms/step
Epoch 7/50
486/486 - 21s - loss: 3.2650 - accuracy20: 0.3799 - val_loss: 3.3045 - val_accuracy20: 0.3573 - 21s/epoch - 44ms/step
Epoch 8/50
486/486 - 23s - loss: 3.2529 - accuracy20: 0.3878 - val_loss: 3.3058 - val_accuracy20: 0.3597 - 23s/epoch - 47ms/step
Epoch 9/50
486/486 - 22s - loss: 3.2473 - accuracy20: 0.3910 - val_loss: 3.3163 - val_accuracy20: 0.3606 - 22s/epoch - 45ms/step
Epoch 10/50
486/486 - 21s - loss: 3.2441 - accuracy20: 0.3935 - val_loss: 3.3117 - val_accuracy20: 0.3603 - 21s/epoch - 43ms/step
Epoch 11/50
486/486 - 20s - loss: 3.2366 - accuracy20: 0.3990 - val_loss: 3.3655 - val_accuracy20: 0.3556 - 20s/epoch - 42ms/step
Epoch 12/50
486/486 - 20s - loss: 3.2374 - accuracy20: 0.4008 - val_loss: 3.3024 - val_accuracy20: 0.3635 - 20s/epoch - 42ms/step
Epoch 13/50
486/486 - 20s - loss: 3.2301 - accuracy20: 0.4027 - val_loss: 3.2947 - val_accuracy20: 0.3650 - 20s/epoch - 42ms/step
Epoch 14/50
486/486 - 20s - loss: 3.2253 - accuracy20: 0.4045 - val_loss: 3.2970 - val_accuracy20: 0.3628 - 20s/epoch - 41ms/step
Epoch 15/50
486/486 - 21s - loss: 3.2229 - accuracy20: 0.4071 - val_loss: 3.3076 - val_accuracy20: 0.3681 - 21s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 3.2187 - accuracy20: 0.4082 - val_loss: 3.3163 - val_accuracy20: 0.3683 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 21s - loss: 3.2130 - accuracy20: 0.4127 - val_loss: 3.3066 - val_accuracy20: 0.3687 - 21s/epoch - 43ms/step
Epoch 18/50
486/486 - 20s - loss: 3.2119 - accuracy20: 0.4141 - val_loss: 3.3134 - val_accuracy20: 0.3702 - 20s/epoch - 42ms/step
Epoch 19/50
486/486 - 20s - loss: 3.2101 - accuracy20: 0.4154 - val_loss: 3.3117 - val_accuracy20: 0.3708 - 20s/epoch - 42ms/step
Epoch 20/50
486/486 - 21s - loss: 3.2063 - accuracy20: 0.4169 - val_loss: 3.3133 - val_accuracy20: 0.3714 - 21s/epoch - 42ms/step
Epoch 21/50
486/486 - 20s - loss: 3.2015 - accuracy20: 0.4172 - val_loss: 3.2954 - val_accuracy20: 0.3723 - 20s/epoch - 42ms/step
Epoch 22/50
486/486 - 20s - loss: 3.1982 - accuracy20: 0.4205 - val_loss: 3.3095 - val_accuracy20: 0.3717 - 20s/epoch - 42ms/step
Epoch 23/50
486/486 - 20s - loss: 3.1964 - accuracy20: 0.4202 - val_loss: 3.2982 - val_accuracy20: 0.3743 - 20s/epoch - 41ms/step
testing model: results/CHTR/W0/deepVOL_L3/h20
Evaluating performance on  test set...
1269/1269 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0930723
{'0': {'precision': 0.4091102510587425, 'recall': 0.17878648342306602, 'f1-score': 0.2488307174680643, 'support': 112928}, '1': {'precision': 0.4091285994271069, 'recall': 0.10829982739870898, 'f1-score': 0.17126448569377498, 'support': 100231}, '2': {'precision': 0.35937656952519476, 'recall': 0.8014157071815778, 'f1-score': 0.4962300893793378, 'support': 111605}, 'accuracy': 0.37099863285339507, 'macro avg': {'precision': 0.3925384733370147, 'recall': 0.36283400600111765, 'f1-score': 0.30544176418039237, 'support': 324764}, 'weighted avg': {'precision': 0.39202495696136086, 'recall': 0.37099863285339507, 'f1-score': 0.3099103504482865, 'support': 324764}}
[[20190  8350 84388]
 [14325 10855 75051]
 [14836  7327 89442]]
Evaluating performance on  train set...
486/486 - 11s - 11s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0900077
{'0': {'precision': 0.39960799311597667, 'recall': 0.2026522498060512, 'f1-score': 0.2689251359263906, 'support': 41248}, '1': {'precision': 0.47285520108739104, 'recall': 0.14363433234565504, 'f1-score': 0.22033866731245697, 'support': 41174}, '2': {'precision': 0.35615985907739733, 'recall': 0.7733129347644204, 'f1-score': 0.48770192140988816, 'support': 41833}, 'accuracy': 0.3752203130658726, 'macro avg': {'precision': 0.409541017760255, 'recall': 0.3731998389720423, 'f1-score': 0.3256552415495786, 'support': 124255}, 'weighted avg': {'precision': 0.4092519893316551, 'recall': 0.3752203130658726, 'f1-score': 0.3264808882777733, 'support': 124255}}
[[ 8359  3197 29692]
 [ 6472  5914 28788]
 [ 6087  3396 32350]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.096627
{'0': {'precision': 0.38436159683272847, 'recall': 0.15607207448589994, 'f1-score': 0.22199990472107095, 'support': 14929}, '1': {'precision': 0.43916083916083914, 'recall': 0.10442995876014367, 'f1-score': 0.1687355580633027, 'support': 15034}, '2': {'precision': 0.3564361954128696, 'recall': 0.8221379443337404, 'f1-score': 0.49727838258164847, 'support': 15557}, 'accuracy': 0.3666520210896309, 'macro avg': {'precision': 0.39331954380214573, 'recall': 0.3608799925265947, 'f1-score': 0.2960046151220074, 'support': 45520}, 'weighted avg': {'precision': 0.39291643732640313, 'recall': 0.3666520210896309, 'f1-score': 0.2984878461187888, 'support': 45520}}
[[ 2330  1010 11589]
 [ 1960  1570 11504]
 [ 1772   995 12790]]
training model: results/CHTR/W0/deepVOL_L3/h30
Epoch 1/50
486/486 - 23s - loss: 3.3166 - accuracy30: 0.3578 - val_loss: 3.4564 - val_accuracy30: 0.3276 - 23s/epoch - 48ms/step
Epoch 2/50
486/486 - 21s - loss: 3.2932 - accuracy30: 0.3588 - val_loss: 3.3728 - val_accuracy30: 0.3385 - 21s/epoch - 44ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2870 - accuracy30: 0.3565 - val_loss: 3.3330 - val_accuracy30: 0.3404 - 21s/epoch - 42ms/step
Epoch 4/50
486/486 - 23s - loss: 3.2830 - accuracy30: 0.3575 - val_loss: 3.3338 - val_accuracy30: 0.3379 - 23s/epoch - 47ms/step
Epoch 5/50
486/486 - 22s - loss: 3.2789 - accuracy30: 0.3642 - val_loss: 3.3299 - val_accuracy30: 0.3430 - 22s/epoch - 46ms/step
Epoch 6/50
486/486 - 21s - loss: 3.2745 - accuracy30: 0.3687 - val_loss: 3.3315 - val_accuracy30: 0.3509 - 21s/epoch - 43ms/step
Epoch 7/50
486/486 - 20s - loss: 3.2695 - accuracy30: 0.3727 - val_loss: 3.3258 - val_accuracy30: 0.3536 - 20s/epoch - 42ms/step
Epoch 8/50
486/486 - 20s - loss: 3.2632 - accuracy30: 0.3781 - val_loss: 3.3887 - val_accuracy30: 0.3451 - 20s/epoch - 42ms/step
Epoch 9/50
486/486 - 20s - loss: 3.2703 - accuracy30: 0.3761 - val_loss: 3.3350 - val_accuracy30: 0.3501 - 20s/epoch - 42ms/step
Epoch 10/50
486/486 - 20s - loss: 3.2610 - accuracy30: 0.3828 - val_loss: 3.3165 - val_accuracy30: 0.3565 - 20s/epoch - 42ms/step
Epoch 11/50
486/486 - 21s - loss: 3.2553 - accuracy30: 0.3859 - val_loss: 3.3379 - val_accuracy30: 0.3518 - 21s/epoch - 43ms/step
Epoch 12/50
486/486 - 21s - loss: 3.2517 - accuracy30: 0.3896 - val_loss: 3.3495 - val_accuracy30: 0.3531 - 21s/epoch - 43ms/step
Epoch 13/50
486/486 - 20s - loss: 3.2518 - accuracy30: 0.3905 - val_loss: 3.3106 - val_accuracy30: 0.3583 - 20s/epoch - 42ms/step
Epoch 14/50
486/486 - 21s - loss: 3.2466 - accuracy30: 0.3943 - val_loss: 3.3192 - val_accuracy30: 0.3583 - 21s/epoch - 43ms/step
Epoch 15/50
486/486 - 20s - loss: 3.2463 - accuracy30: 0.3940 - val_loss: 3.3845 - val_accuracy30: 0.3539 - 20s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 3.2428 - accuracy30: 0.3949 - val_loss: 3.3246 - val_accuracy30: 0.3596 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 20s - loss: 3.2379 - accuracy30: 0.3988 - val_loss: 3.3811 - val_accuracy30: 0.3570 - 20s/epoch - 42ms/step
Epoch 18/50
486/486 - 20s - loss: 3.2373 - accuracy30: 0.3988 - val_loss: 3.3616 - val_accuracy30: 0.3558 - 20s/epoch - 42ms/step
Epoch 19/50
486/486 - 21s - loss: 3.2339 - accuracy30: 0.4013 - val_loss: 3.3425 - val_accuracy30: 0.3607 - 21s/epoch - 43ms/step
Epoch 20/50
486/486 - 21s - loss: 3.2327 - accuracy30: 0.4012 - val_loss: 3.3367 - val_accuracy30: 0.3601 - 21s/epoch - 42ms/step
Epoch 21/50
486/486 - 20s - loss: 3.2281 - accuracy30: 0.4051 - val_loss: 3.3256 - val_accuracy30: 0.3603 - 20s/epoch - 42ms/step
Epoch 22/50
486/486 - 20s - loss: 3.2245 - accuracy30: 0.4057 - val_loss: 3.3205 - val_accuracy30: 0.3588 - 20s/epoch - 42ms/step
Epoch 23/50
486/486 - 20s - loss: 3.2206 - accuracy30: 0.4094 - val_loss: 3.3317 - val_accuracy30: 0.3618 - 20s/epoch - 42ms/step
testing model: results/CHTR/W0/deepVOL_L3/h30
Evaluating performance on  test set...
1269/1269 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0991539
{'0': {'precision': 0.3982021703187062, 'recall': 0.18911673917360144, 'f1-score': 0.2564422659151964, 'support': 110794}, '1': {'precision': 0.3837696335078534, 'recall': 0.06317210736481246, 'f1-score': 0.1084863384832962, 'support': 104429}, '2': {'precision': 0.3515247788825479, 'recall': 0.8181685396335618, 'f1-score': 0.4917639699749791, 'support': 109541}, 'accuracy': 0.360794299860822, 'macro avg': {'precision': 0.37783219423636916, 'recall': 0.3568191287239919, 'f1-score': 0.2855641914578239, 'support': 324764}, 'weighted avg': {'precision': 0.3778173261797968, 'recall': 0.360794299860822, 'f1-score': 0.288239156083524, 'support': 324764}}
[[20953  6161 83680]
 [16180  6597 81652]
 [15486  4432 89623]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0941463
{'0': {'precision': 0.4005078485687904, 'recall': 0.21014510307405343, 'f1-score': 0.27565497847190223, 'support': 41281}, '1': {'precision': 0.4513613861386139, 'recall': 0.08871752456942687, 'f1-score': 0.14828820037407497, 'support': 41108}, '2': {'precision': 0.3560281436808972, 'recall': 0.8037548368604596, 'f1-score': 0.49347049808990984, 'support': 41866}, 'accuracy': 0.3699810872801899, 'macro avg': {'precision': 0.4026324594627672, 'recall': 0.36753915483464666, 'f1-score': 0.305804558978629, 'support': 124255}, 'weighted avg': {'precision': 0.4023451983541814, 'recall': 0.3699810872801899, 'f1-score': 0.3069074112132971, 'support': 124255}}
[[ 8675  2367 30239]
 [ 6835  3647 30626]
 [ 6150  2066 33650]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1022868
{'0': {'precision': 0.38350286077558804, 'recall': 0.161189044756179, 'f1-score': 0.22697770670680087, 'support': 14970}, '1': {'precision': 0.4144620811287478, 'recall': 0.061829901993027694, 'f1-score': 0.10760689142006755, 'support': 15203}, '2': {'precision': 0.349512987012987, 'recall': 0.8417280250211768, 'f1-score': 0.4939300667214713, 'support': 15347}, 'accuracy': 0.35744727592267134, 'macro avg': {'precision': 0.3824926429724409, 'recall': 0.35491565725679447, 'f1-score': 0.27617155494944656, 'support': 45520}, 'weighted avg': {'precision': 0.382383142726257, 'recall': 0.35744727592267134, 'f1-score': 0.27711222701306054, 'support': 45520}}
[[ 2413   750 11807]
 [ 2028   940 12235]
 [ 1851   578 12918]]
training model: results/CHTR/W0/deepVOL_L3/h50
Epoch 1/50
486/486 - 23s - loss: 3.3107 - accuracy50: 0.3623 - val_loss: 3.4162 - val_accuracy50: 0.3372 - 23s/epoch - 48ms/step
Epoch 2/50
486/486 - 20s - loss: 3.2935 - accuracy50: 0.3591 - val_loss: 3.3688 - val_accuracy50: 0.3334 - 20s/epoch - 42ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2890 - accuracy50: 0.3591 - val_loss: 3.3638 - val_accuracy50: 0.3327 - 21s/epoch - 43ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2858 - accuracy50: 0.3597 - val_loss: 3.3233 - val_accuracy50: 0.3382 - 21s/epoch - 44ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2818 - accuracy50: 0.3631 - val_loss: 3.3132 - val_accuracy50: 0.3396 - 21s/epoch - 44ms/step
Epoch 6/50
486/486 - 22s - loss: 3.2798 - accuracy50: 0.3645 - val_loss: 3.3181 - val_accuracy50: 0.3461 - 22s/epoch - 46ms/step
Epoch 7/50
486/486 - 20s - loss: 3.2789 - accuracy50: 0.3667 - val_loss: 3.3144 - val_accuracy50: 0.3479 - 20s/epoch - 42ms/step
Epoch 8/50
486/486 - 21s - loss: 3.2759 - accuracy50: 0.3669 - val_loss: 3.3171 - val_accuracy50: 0.3487 - 21s/epoch - 42ms/step
Epoch 9/50
486/486 - 21s - loss: 3.2744 - accuracy50: 0.3687 - val_loss: 3.3042 - val_accuracy50: 0.3473 - 21s/epoch - 43ms/step
Epoch 10/50
486/486 - 22s - loss: 3.2724 - accuracy50: 0.3699 - val_loss: 3.3091 - val_accuracy50: 0.3460 - 22s/epoch - 46ms/step
Epoch 11/50
486/486 - 21s - loss: 3.2717 - accuracy50: 0.3714 - val_loss: 3.3097 - val_accuracy50: 0.3459 - 21s/epoch - 43ms/step
Epoch 12/50
486/486 - 20s - loss: 3.2694 - accuracy50: 0.3729 - val_loss: 3.3061 - val_accuracy50: 0.3476 - 20s/epoch - 42ms/step
Epoch 13/50
486/486 - 21s - loss: 3.2661 - accuracy50: 0.3769 - val_loss: 3.3001 - val_accuracy50: 0.3492 - 21s/epoch - 42ms/step
Epoch 14/50
486/486 - 20s - loss: 3.2694 - accuracy50: 0.3735 - val_loss: 3.3060 - val_accuracy50: 0.3476 - 20s/epoch - 42ms/step
Epoch 15/50
486/486 - 20s - loss: 3.2661 - accuracy50: 0.3757 - val_loss: 3.3079 - val_accuracy50: 0.3499 - 20s/epoch - 42ms/step
Epoch 16/50
486/486 - 21s - loss: 3.2629 - accuracy50: 0.3826 - val_loss: 3.3074 - val_accuracy50: 0.3490 - 21s/epoch - 43ms/step
Epoch 17/50
486/486 - 21s - loss: 3.2628 - accuracy50: 0.3808 - val_loss: 3.3184 - val_accuracy50: 0.3518 - 21s/epoch - 42ms/step
Epoch 18/50
486/486 - 20s - loss: 3.2616 - accuracy50: 0.3797 - val_loss: 3.3067 - val_accuracy50: 0.3520 - 20s/epoch - 42ms/step
Epoch 19/50
486/486 - 21s - loss: 3.2574 - accuracy50: 0.3847 - val_loss: 3.3322 - val_accuracy50: 0.3501 - 21s/epoch - 43ms/step
Epoch 20/50
486/486 - 21s - loss: 3.2555 - accuracy50: 0.3860 - val_loss: 3.3246 - val_accuracy50: 0.3513 - 21s/epoch - 44ms/step
Epoch 21/50
486/486 - 20s - loss: 3.2563 - accuracy50: 0.3842 - val_loss: 3.3061 - val_accuracy50: 0.3513 - 20s/epoch - 42ms/step
Epoch 22/50
486/486 - 20s - loss: 3.2517 - accuracy50: 0.3863 - val_loss: 3.3051 - val_accuracy50: 0.3540 - 20s/epoch - 42ms/step
Epoch 23/50
486/486 - 20s - loss: 3.2509 - accuracy50: 0.3881 - val_loss: 3.3463 - val_accuracy50: 0.3502 - 20s/epoch - 42ms/step
testing model: results/CHTR/W0/deepVOL_L3/h50
Evaluating performance on  test set...
1269/1269 - 26s - 26s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.101601
{'0': {'precision': 0.35969291947420745, 'recall': 0.30188102014517876, 'f1-score': 0.3282610120112703, 'support': 107867}, '1': {'precision': 0.40793780687397707, 'recall': 0.009096881329951276, 'f1-score': 0.017796897591974437, 'support': 109598}, '2': {'precision': 0.34157211268820914, 'recall': 0.7378726735570695, 'f1-score': 0.4669747470428117, 'support': 107299}, 'accuracy': 0.3471228338116294, 'macro avg': {'precision': 0.3697342796787979, 'recall': 0.3496168583440665, 'f1-score': 0.27101088554868547, 'support': 324764}, 'weighted avg': {'precision': 0.36998715997472204, 'recall': 0.3471228338116294, 'f1-score': 0.26931851543844626, 'support': 324764}}
[[32563   791 74513]
 [30497   997 78104]
 [27470   656 79173]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969201
{'0': {'precision': 0.37028871948790143, 'recall': 0.3377834851715449, 'f1-score': 0.35328999885961915, 'support': 41272}, '1': {'precision': 0.4332797427652733, 'recall': 0.013113398048804223, 'f1-score': 0.02545634873780905, 'support': 41103}, '2': {'precision': 0.3534476699233851, 'recall': 0.7204154727793697, 'f1-score': 0.4742302070071203, 'support': 41880}, 'accuracy': 0.3593497243571687, 'macro avg': {'precision': 0.38567204405885325, 'recall': 0.35710411866657293, 'f1-score': 0.28432551820151614, 'support': 124255}, 'weighted avg': {'precision': 0.3854496134077266, 'recall': 0.3593497243571687, 'f1-score': 0.2856068424173077, 'support': 124255}}
[[13941   363 26968]
 [12341   539 28223]
 [11367   342 30171]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997119
{'0': {'precision': 0.3561235549132948, 'recall': 0.2636400106980476, 'f1-score': 0.3029814046411557, 'support': 14956}, '1': {'precision': 0.4050632911392405, 'recall': 0.010584810796507013, 'f1-score': 0.02063052027593321, 'support': 15116}, '2': {'precision': 0.34402255307902385, 'recall': 0.7583505955463491, 'f1-score': 0.47332377123694475, 'support': 15448}, 'accuracy': 0.3474956063268893, 'macro avg': {'precision': 0.3684031330438531, 'recall': 0.3441918056803012, 'f1-score': 0.26564523205134455, 'support': 45520}, 'weighted avg': {'precision': 0.36826847530994633, 'recall': 0.3474956063268893, 'f1-score': 0.2670287005793597, 'support': 45520}}
[[ 3943   111 10902]
 [ 3520   160 11436]
 [ 3609   124 11715]]
training model: results/CHTR/W0/deepVOL_L3/h100
Epoch 1/50
486/486 - 24s - loss: 3.3173 - accuracy100: 0.3610 - val_loss: 3.4185 - val_accuracy100: 0.3278 - 24s/epoch - 49ms/step
Epoch 2/50
486/486 - 21s - loss: 3.3006 - accuracy100: 0.3568 - val_loss: 3.3319 - val_accuracy100: 0.3374 - 21s/epoch - 43ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2960 - accuracy100: 0.3558 - val_loss: 3.3223 - val_accuracy100: 0.3384 - 21s/epoch - 43ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2922 - accuracy100: 0.3534 - val_loss: 3.3283 - val_accuracy100: 0.3370 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2925 - accuracy100: 0.3503 - val_loss: 3.3252 - val_accuracy100: 0.3376 - 21s/epoch - 42ms/step
Epoch 6/50
486/486 - 21s - loss: 3.2905 - accuracy100: 0.3522 - val_loss: 3.3183 - val_accuracy100: 0.3379 - 21s/epoch - 43ms/step
Epoch 7/50
486/486 - 21s - loss: 3.2881 - accuracy100: 0.3557 - val_loss: 3.3207 - val_accuracy100: 0.3399 - 21s/epoch - 42ms/step
Epoch 8/50
486/486 - 20s - loss: 3.2886 - accuracy100: 0.3578 - val_loss: 3.3213 - val_accuracy100: 0.3396 - 20s/epoch - 41ms/step
Epoch 9/50
486/486 - 22s - loss: 3.2873 - accuracy100: 0.3584 - val_loss: 3.3249 - val_accuracy100: 0.3391 - 22s/epoch - 44ms/step
Epoch 10/50
486/486 - 21s - loss: 3.2868 - accuracy100: 0.3578 - val_loss: 3.3159 - val_accuracy100: 0.3408 - 21s/epoch - 42ms/step
Epoch 11/50
486/486 - 21s - loss: 3.2853 - accuracy100: 0.3596 - val_loss: 3.3195 - val_accuracy100: 0.3393 - 21s/epoch - 43ms/step
Epoch 12/50
486/486 - 21s - loss: 3.2838 - accuracy100: 0.3616 - val_loss: 3.3200 - val_accuracy100: 0.3398 - 21s/epoch - 43ms/step
Epoch 13/50
486/486 - 20s - loss: 3.2823 - accuracy100: 0.3630 - val_loss: 3.3225 - val_accuracy100: 0.3403 - 20s/epoch - 42ms/step
Epoch 14/50
486/486 - 21s - loss: 3.2812 - accuracy100: 0.3648 - val_loss: 3.3202 - val_accuracy100: 0.3398 - 21s/epoch - 44ms/step
Epoch 15/50
486/486 - 21s - loss: 3.2777 - accuracy100: 0.3677 - val_loss: 3.3223 - val_accuracy100: 0.3397 - 21s/epoch - 43ms/step
Epoch 16/50
486/486 - 20s - loss: 3.2791 - accuracy100: 0.3672 - val_loss: 3.3197 - val_accuracy100: 0.3417 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 21s - loss: 3.2769 - accuracy100: 0.3682 - val_loss: 3.3209 - val_accuracy100: 0.3386 - 21s/epoch - 43ms/step
Epoch 18/50
486/486 - 21s - loss: 3.2747 - accuracy100: 0.3706 - val_loss: 3.3135 - val_accuracy100: 0.3408 - 21s/epoch - 43ms/step
Epoch 19/50
486/486 - 21s - loss: 3.2734 - accuracy100: 0.3701 - val_loss: 3.3174 - val_accuracy100: 0.3400 - 21s/epoch - 44ms/step
Epoch 20/50
486/486 - 21s - loss: 3.2718 - accuracy100: 0.3708 - val_loss: 3.3185 - val_accuracy100: 0.3399 - 21s/epoch - 43ms/step
Epoch 21/50
486/486 - 21s - loss: 3.2713 - accuracy100: 0.3706 - val_loss: 3.3185 - val_accuracy100: 0.3421 - 21s/epoch - 44ms/step
Epoch 22/50
486/486 - 21s - loss: 3.2700 - accuracy100: 0.3738 - val_loss: 3.3138 - val_accuracy100: 0.3418 - 21s/epoch - 43ms/step
Epoch 23/50
486/486 - 21s - loss: 3.2674 - accuracy100: 0.3753 - val_loss: 3.3150 - val_accuracy100: 0.3425 - 21s/epoch - 43ms/step
Epoch 24/50
486/486 - 21s - loss: 3.2646 - accuracy100: 0.3786 - val_loss: 3.3156 - val_accuracy100: 0.3426 - 21s/epoch - 43ms/step
Epoch 25/50
486/486 - 21s - loss: 3.2644 - accuracy100: 0.3776 - val_loss: 3.3188 - val_accuracy100: 0.3419 - 21s/epoch - 42ms/step
Epoch 26/50
486/486 - 21s - loss: 3.2638 - accuracy100: 0.3775 - val_loss: 3.3172 - val_accuracy100: 0.3427 - 21s/epoch - 43ms/step
Epoch 27/50
486/486 - 21s - loss: 3.2622 - accuracy100: 0.3805 - val_loss: 3.3213 - val_accuracy100: 0.3425 - 21s/epoch - 43ms/step
Epoch 28/50
486/486 - 20s - loss: 3.2591 - accuracy100: 0.3814 - val_loss: 3.3221 - val_accuracy100: 0.3423 - 20s/epoch - 42ms/step
testing model: results/CHTR/W0/deepVOL_L3/h100
Evaluating performance on  test set...
1269/1269 - 31s - 31s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1086277
{'0': {'precision': 0.3193829608104071, 'recall': 0.11435128013146507, 'f1-score': 0.1684065816041586, 'support': 102841}, '1': {'precision': 0.4347646573080099, 'recall': 0.008959872026139341, 'f1-score': 0.017557901055474962, 'support': 117524}, '2': {'precision': 0.32265577663289213, 'recall': 0.8824318240596174, 'f1-score': 0.4725328272466147, 'support': 104399}, 'accuracy': 0.32312078925004, 'macro avg': {'precision': 0.35893446491710307, 'recall': 0.335247658739074, 'f1-score': 0.21949910330208278, 'support': 324764}, 'weighted avg': {'precision': 0.36218880504879525, 'recall': 0.32312078925004, 'f1-score': 0.2115829668747652, 'support': 324764}}
[[ 11760    750  90331]
 [ 13406   1053 103065]
 [ 11655    619  92125]]
Evaluating performance on  train set...
486/486 - 11s - 11s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004586
{'0': {'precision': 0.3672810773909266, 'recall': 0.14420780739802136, 'f1-score': 0.2071004881804343, 'support': 41038}, '1': {'precision': 0.44933920704845814, 'recall': 0.012414800389483933, 'f1-score': 0.02416202771526708, 'support': 41080}, '2': {'precision': 0.34695861018438046, 'recall': 0.8811021192775945, 'f1-score': 0.4978678324304028, 'support': 42137}, 'accuracy': 0.35052915375638805, 'macro avg': {'precision': 0.387859631541255, 'recall': 0.34590824235503326, 'f1-score': 0.2430434494420347, 'support': 124255}, 'weighted avg': {'precision': 0.38751865467674335, 'recall': 0.35052915375638805, 'f1-score': 0.24522331324785093, 'support': 124255}}
[[ 5918   337 34783]
 [ 5473   510 35097]
 [ 4722   288 37127]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1034805
{'0': {'precision': 0.3285878300803674, 'recall': 0.09743310410567169, 'f1-score': 0.1502993383047999, 'support': 14687}, '1': {'precision': 0.3443708609271523, 'recall': 0.0067973856209150325, 'f1-score': 0.013331624150749902, 'support': 15300}, '2': {'precision': 0.34131121063064385, 'recall': 0.897894804609541, 'f1-score': 0.49460954677636704, 'support': 15533}, 'accuracy': 0.3401142355008787, 'macro avg': {'precision': 0.33808996721272117, 'recall': 0.3340417647787092, 'f1-score': 0.2194135030773056, 'support': 45520}, 'weighted avg': {'precision': 0.3382344171199819, 'recall': 0.3401142355008787, 'f1-score': 0.2217528629452192, 'support': 45520}}
[[ 1431   102 13154]
 [ 1434   104 13762]
 [ 1490    96 13947]]
training model: results/CHTR/W0/deepVOL_L3/h200
Epoch 1/50
486/486 - 23s - loss: 3.3166 - accuracy200: 0.3613 - val_loss: 3.3350 - val_accuracy200: 0.3353 - 23s/epoch - 48ms/step
Epoch 2/50
486/486 - 22s - loss: 3.2969 - accuracy200: 0.3596 - val_loss: 3.3112 - val_accuracy200: 0.3414 - 22s/epoch - 46ms/step
Epoch 3/50
486/486 - 22s - loss: 3.2920 - accuracy200: 0.3559 - val_loss: 3.3050 - val_accuracy200: 0.3466 - 22s/epoch - 46ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2876 - accuracy200: 0.3575 - val_loss: 3.3134 - val_accuracy200: 0.3478 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2873 - accuracy200: 0.3573 - val_loss: 3.3104 - val_accuracy200: 0.3448 - 21s/epoch - 43ms/step
Epoch 6/50
486/486 - 21s - loss: 3.2851 - accuracy200: 0.3598 - val_loss: 3.3057 - val_accuracy200: 0.3466 - 21s/epoch - 44ms/step
Epoch 7/50
486/486 - 21s - loss: 3.2808 - accuracy200: 0.3640 - val_loss: 3.3005 - val_accuracy200: 0.3479 - 21s/epoch - 43ms/step
Epoch 8/50
486/486 - 21s - loss: 3.2792 - accuracy200: 0.3630 - val_loss: 3.3038 - val_accuracy200: 0.3440 - 21s/epoch - 43ms/step
Epoch 9/50
486/486 - 21s - loss: 3.2775 - accuracy200: 0.3670 - val_loss: 3.3086 - val_accuracy200: 0.3451 - 21s/epoch - 42ms/step
Epoch 10/50
486/486 - 21s - loss: 3.2761 - accuracy200: 0.3657 - val_loss: 3.3027 - val_accuracy200: 0.3476 - 21s/epoch - 43ms/step
Epoch 11/50
486/486 - 21s - loss: 3.2740 - accuracy200: 0.3711 - val_loss: 3.3051 - val_accuracy200: 0.3435 - 21s/epoch - 43ms/step
Epoch 12/50
486/486 - 21s - loss: 3.2738 - accuracy200: 0.3701 - val_loss: 3.3025 - val_accuracy200: 0.3453 - 21s/epoch - 43ms/step
Epoch 13/50
486/486 - 21s - loss: 3.2735 - accuracy200: 0.3708 - val_loss: 3.3016 - val_accuracy200: 0.3465 - 21s/epoch - 42ms/step
Epoch 14/50
486/486 - 20s - loss: 3.2719 - accuracy200: 0.3739 - val_loss: 3.3028 - val_accuracy200: 0.3446 - 20s/epoch - 42ms/step
Epoch 15/50
486/486 - 21s - loss: 3.2714 - accuracy200: 0.3729 - val_loss: 3.3019 - val_accuracy200: 0.3480 - 21s/epoch - 43ms/step
Epoch 16/50
486/486 - 21s - loss: 3.2705 - accuracy200: 0.3744 - val_loss: 3.3029 - val_accuracy200: 0.3461 - 21s/epoch - 44ms/step
Epoch 17/50
486/486 - 21s - loss: 3.2679 - accuracy200: 0.3758 - val_loss: 3.3038 - val_accuracy200: 0.3444 - 21s/epoch - 44ms/step
testing model: results/CHTR/W0/deepVOL_L3/h200
Evaluating performance on  test set...
1269/1269 - 26s - 26s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1028671
{'0': {'precision': 0.3074735418900648, 'recall': 0.06461441993984343, 'f1-score': 0.10678778457851615, 'support': 102067}, '1': {'precision': 0.47936094349972574, 'recall': 0.060032802933372265, 'f1-score': 0.10670268702732817, 'support': 116453}, '2': {'precision': 0.33205994506997866, 'recall': 0.9024133127517789, 'f1-score': 0.48547882777390977, 'support': 106244}, 'accuracy': 0.3370509046569201, 'macro avg': {'precision': 0.3729648101532564, 'recall': 0.34235351187499824, 'f1-score': 0.232989766459918, 'support': 324764}, 'weighted avg': {'precision': 0.3771517124973261, 'recall': 0.3370509046569201, 'f1-score': 0.2306430805107097, 'support': 324764}}
[[  6595   3925  91547]
 [  8154   6991 101308]
 [  6700   3668  95876]]
Evaluating performance on  train set...
486/486 - 11s - 11s/epoch - 24ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994679
{'0': {'precision': 0.3332208726945569, 'recall': 0.07206615590417123, 'f1-score': 0.11850340952266684, 'support': 41115}, '1': {'precision': 0.3841965862271925, 'recall': 0.06377470017830536, 'f1-score': 0.10939103839788843, 'support': 40941}, '2': {'precision': 0.3431613657925521, 'recall': 0.8828645228559918, 'f1-score': 0.49422283538728884, 'support': 42199}, 'accuracy': 0.3446943784958352, 'macro avg': {'precision': 0.3535262749047672, 'recall': 0.3395684596461561, 'f1-score': 0.24070576110261468, 'support': 124255}, 'weighted avg': {'precision': 0.35339290243969335, 'recall': 0.3446943784958352, 'f1-score': 0.24310132884858235, 'support': 124255}}
[[ 2963  2109 36043]
 [ 3062  2611 35268]
 [ 2867  2076 37256]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1002612
{'0': {'precision': 0.31778875849289684, 'recall': 0.07033492822966507, 'f1-score': 0.11517797179314976, 'support': 14630}, '1': {'precision': 0.35054997608799615, 'recall': 0.049043222266827245, 'f1-score': 0.08604801314785467, 'support': 14946}, '2': {'precision': 0.3500783757557662, 'recall': 0.8824636226793778, 'f1-score': 0.5012915293488911, 'support': 15944}, 'accuracy': 0.34780316344463974, 'macro avg': {'precision': 0.33947237011221976, 'recall': 0.33394725772529005, 'f1-score': 0.2341725047632985, 'support': 45520}, 'weighted avg': {'precision': 0.33985542843612054, 'recall': 0.34780316344463974, 'f1-score': 0.24085499727109705, 'support': 45520}}
[[ 1029   638 12963]
 [ 1055   733 13158]
 [ 1154   720 14070]]
training model: results/CHTR/W0/deepVOL_L3/h300
Epoch 1/50
486/486 - 23s - loss: 3.3124 - accuracy300: 0.3605 - val_loss: 3.3744 - val_accuracy300: 0.3358 - 23s/epoch - 47ms/step
Epoch 2/50
486/486 - 22s - loss: 3.3000 - accuracy300: 0.3582 - val_loss: 3.3074 - val_accuracy300: 0.3453 - 22s/epoch - 46ms/step
Epoch 3/50
486/486 - 20s - loss: 3.2923 - accuracy300: 0.3546 - val_loss: 3.3097 - val_accuracy300: 0.3457 - 20s/epoch - 42ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2855 - accuracy300: 0.3610 - val_loss: 3.3139 - val_accuracy300: 0.3429 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 21s - loss: 3.2820 - accuracy300: 0.3635 - val_loss: 3.3037 - val_accuracy300: 0.3502 - 21s/epoch - 42ms/step
Epoch 6/50
486/486 - 21s - loss: 3.2759 - accuracy300: 0.3675 - val_loss: 3.3018 - val_accuracy300: 0.3481 - 21s/epoch - 42ms/step
Epoch 7/50
486/486 - 20s - loss: 3.2728 - accuracy300: 0.3698 - val_loss: 3.2993 - val_accuracy300: 0.3462 - 20s/epoch - 41ms/step
Epoch 8/50
486/486 - 20s - loss: 3.2700 - accuracy300: 0.3732 - val_loss: 3.2993 - val_accuracy300: 0.3495 - 20s/epoch - 42ms/step
Epoch 9/50
486/486 - 20s - loss: 3.2693 - accuracy300: 0.3750 - val_loss: 3.3026 - val_accuracy300: 0.3473 - 20s/epoch - 42ms/step
Epoch 10/50
486/486 - 20s - loss: 3.2675 - accuracy300: 0.3752 - val_loss: 3.3024 - val_accuracy300: 0.3461 - 20s/epoch - 42ms/step
Epoch 11/50
486/486 - 20s - loss: 3.2661 - accuracy300: 0.3782 - val_loss: 3.3052 - val_accuracy300: 0.3404 - 20s/epoch - 42ms/step
Epoch 12/50
486/486 - 20s - loss: 3.2645 - accuracy300: 0.3786 - val_loss: 3.3020 - val_accuracy300: 0.3481 - 20s/epoch - 42ms/step
Epoch 13/50
486/486 - 21s - loss: 3.2662 - accuracy300: 0.3765 - val_loss: 3.3062 - val_accuracy300: 0.3467 - 21s/epoch - 42ms/step
Epoch 14/50
486/486 - 20s - loss: 3.2625 - accuracy300: 0.3802 - val_loss: 3.3046 - val_accuracy300: 0.3431 - 20s/epoch - 42ms/step
Epoch 15/50
486/486 - 20s - loss: 3.2603 - accuracy300: 0.3827 - val_loss: 3.3076 - val_accuracy300: 0.3422 - 20s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 3.2594 - accuracy300: 0.3840 - val_loss: 3.3054 - val_accuracy300: 0.3453 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 20s - loss: 3.2562 - accuracy300: 0.3850 - val_loss: 3.3088 - val_accuracy300: 0.3445 - 20s/epoch - 42ms/step
Epoch 18/50
486/486 - 21s - loss: 3.2557 - accuracy300: 0.3856 - val_loss: 3.3046 - val_accuracy300: 0.3493 - 21s/epoch - 43ms/step
testing model: results/CHTR/W0/deepVOL_L3/h300
Evaluating performance on  test set...
1269/1269 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1014425
{'0': {'precision': 0.3056606392947628, 'recall': 0.08725763145118942, 'f1-score': 0.13575964977185842, 'support': 100931}, '1': {'precision': 0.4179675360378666, 'recall': 0.1494665572425113, 'f1-score': 0.2201918051471283, 'support': 116976}, '2': {'precision': 0.33551471745631983, 'recall': 0.7978981255322534, 'f1-score': 0.47239020768636225, 'support': 106857}, 'accuracy': 0.3434863470089049, 'macro avg': {'precision': 0.35304763092964975, 'recall': 0.3448741047419847, 'f1-score': 0.27611388753511634, 'support': 324764}, 'weighted avg': {'precision': 0.3559350809925212, 'recall': 0.3434863470089049, 'f1-score': 0.2769325240259251, 'support': 324764}}
[[ 8807 12164 79960]
 [10593 17484 88899]
 [ 9413 12183 85261]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.097191
{'0': {'precision': 0.3474853599724423, 'recall': 0.09789174895072661, 'f1-score': 0.1527512256061782, 'support': 41219}, '1': {'precision': 0.39521815193765575, 'recall': 0.18173175369314026, 'f1-score': 0.2489772063120982, 'support': 41022}, '2': {'precision': 0.3472275538494348, 'recall': 0.7750511734183844, 'f1-score': 0.4795940910496782, 'support': 42014}, 'accuracy': 0.3545370407629472, 'macro avg': {'precision': 0.3633103552531776, 'recall': 0.3515582253540837, 'f1-score': 0.29377417432265157, 'support': 124255}, 'weighted avg': {'precision': 0.36315686715963763, 'recall': 0.3545370407629472, 'f1-score': 0.2950340981606948, 'support': 124255}}
[[ 4035  5627 31557]
 [ 3907  7455 29660]
 [ 3670  5781 32563]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997498
{'0': {'precision': 0.30214723926380366, 'recall': 0.0806275579809004, 'f1-score': 0.12728839112642687, 'support': 14660}, '1': {'precision': 0.33962606643673987, 'recall': 0.1260611777388492, 'f1-score': 0.1838730283524151, 'support': 14842}, '2': {'precision': 0.3539156209313277, 'recall': 0.7976026969659133, 'f1-score': 0.4902814820500028, 'support': 16018}, 'accuracy': 0.3477372583479789, 'macro avg': {'precision': 0.3318963088772904, 'recall': 0.33476381089522095, 'f1-score': 0.26714763384294826, 'support': 45520}, 'weighted avg': {'precision': 0.33258411734928517, 'recall': 0.3477372583479789, 'f1-score': 0.2734714428865753, 'support': 45520}}
[[ 1182  1804 11674]
 [ 1322  1871 11649]
 [ 1408  1834 12776]]
training model: results/CHTR/W0/deepVOL_L3/h500
Epoch 1/50
486/486 - 23s - loss: 3.3117 - accuracy500: 0.3694 - val_loss: 3.3283 - val_accuracy500: 0.3254 - 23s/epoch - 47ms/step
Epoch 2/50
486/486 - 21s - loss: 3.2997 - accuracy500: 0.3559 - val_loss: 3.3183 - val_accuracy500: 0.3292 - 21s/epoch - 43ms/step
Epoch 3/50
486/486 - 20s - loss: 3.2915 - accuracy500: 0.3575 - val_loss: 3.3203 - val_accuracy500: 0.3325 - 20s/epoch - 42ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2874 - accuracy500: 0.3576 - val_loss: 3.3234 - val_accuracy500: 0.3412 - 21s/epoch - 43ms/step
Epoch 5/50
486/486 - 20s - loss: 3.2852 - accuracy500: 0.3580 - val_loss: 3.3173 - val_accuracy500: 0.3382 - 20s/epoch - 42ms/step
Epoch 6/50
486/486 - 21s - loss: 3.2813 - accuracy500: 0.3607 - val_loss: 3.3191 - val_accuracy500: 0.3486 - 21s/epoch - 42ms/step
Epoch 7/50
486/486 - 20s - loss: 3.2760 - accuracy500: 0.3651 - val_loss: 3.3207 - val_accuracy500: 0.3505 - 20s/epoch - 42ms/step
Epoch 8/50
486/486 - 21s - loss: 3.2731 - accuracy500: 0.3674 - val_loss: 3.3147 - val_accuracy500: 0.3513 - 21s/epoch - 42ms/step
Epoch 9/50
486/486 - 22s - loss: 3.2718 - accuracy500: 0.3680 - val_loss: 3.3132 - val_accuracy500: 0.3501 - 22s/epoch - 45ms/step
Epoch 10/50
486/486 - 20s - loss: 3.2708 - accuracy500: 0.3697 - val_loss: 3.3067 - val_accuracy500: 0.3516 - 20s/epoch - 42ms/step
Epoch 11/50
486/486 - 21s - loss: 3.2743 - accuracy500: 0.3692 - val_loss: 3.3152 - val_accuracy500: 0.3446 - 21s/epoch - 42ms/step
Epoch 12/50
486/486 - 21s - loss: 3.2755 - accuracy500: 0.3688 - val_loss: 3.3106 - val_accuracy500: 0.3537 - 21s/epoch - 43ms/step
Epoch 13/50
486/486 - 22s - loss: 3.2689 - accuracy500: 0.3737 - val_loss: 3.3192 - val_accuracy500: 0.3509 - 22s/epoch - 45ms/step
Epoch 14/50
486/486 - 21s - loss: 3.2676 - accuracy500: 0.3740 - val_loss: 3.3064 - val_accuracy500: 0.3513 - 21s/epoch - 43ms/step
Epoch 15/50
486/486 - 20s - loss: 3.2663 - accuracy500: 0.3730 - val_loss: 3.3074 - val_accuracy500: 0.3520 - 20s/epoch - 42ms/step
Epoch 16/50
486/486 - 20s - loss: 3.2668 - accuracy500: 0.3720 - val_loss: 3.3073 - val_accuracy500: 0.3553 - 20s/epoch - 42ms/step
Epoch 17/50
486/486 - 21s - loss: 3.2636 - accuracy500: 0.3769 - val_loss: 3.3084 - val_accuracy500: 0.3517 - 21s/epoch - 44ms/step
Epoch 18/50
486/486 - 21s - loss: 3.2629 - accuracy500: 0.3774 - val_loss: 3.3050 - val_accuracy500: 0.3535 - 21s/epoch - 43ms/step
Epoch 19/50
486/486 - 21s - loss: 3.2623 - accuracy500: 0.3791 - val_loss: 3.3074 - val_accuracy500: 0.3534 - 21s/epoch - 44ms/step
Epoch 20/50
486/486 - 20s - loss: 3.2609 - accuracy500: 0.3782 - val_loss: 3.3073 - val_accuracy500: 0.3521 - 20s/epoch - 42ms/step
Epoch 21/50
486/486 - 21s - loss: 3.2605 - accuracy500: 0.3796 - val_loss: 3.3064 - val_accuracy500: 0.3550 - 21s/epoch - 42ms/step
Epoch 22/50
486/486 - 21s - loss: 3.2587 - accuracy500: 0.3820 - val_loss: 3.3119 - val_accuracy500: 0.3555 - 21s/epoch - 42ms/step
Epoch 23/50
486/486 - 22s - loss: 3.2611 - accuracy500: 0.3822 - val_loss: 3.3084 - val_accuracy500: 0.3534 - 22s/epoch - 45ms/step
Epoch 24/50
486/486 - 21s - loss: 3.2597 - accuracy500: 0.3804 - val_loss: 3.3022 - val_accuracy500: 0.3514 - 21s/epoch - 42ms/step
Epoch 25/50
486/486 - 22s - loss: 3.2566 - accuracy500: 0.3834 - val_loss: 3.3040 - val_accuracy500: 0.3543 - 22s/epoch - 46ms/step
Epoch 26/50
486/486 - 21s - loss: 3.2558 - accuracy500: 0.3821 - val_loss: 3.3052 - val_accuracy500: 0.3493 - 21s/epoch - 43ms/step
Epoch 27/50
486/486 - 21s - loss: 3.2537 - accuracy500: 0.3852 - val_loss: 3.3053 - val_accuracy500: 0.3532 - 21s/epoch - 42ms/step
Epoch 28/50
486/486 - 20s - loss: 3.2535 - accuracy500: 0.3817 - val_loss: 3.3063 - val_accuracy500: 0.3499 - 20s/epoch - 42ms/step
Epoch 29/50
486/486 - 21s - loss: 3.2499 - accuracy500: 0.3868 - val_loss: 3.3051 - val_accuracy500: 0.3536 - 21s/epoch - 42ms/step
Epoch 30/50
486/486 - 21s - loss: 3.2505 - accuracy500: 0.3849 - val_loss: 3.3106 - val_accuracy500: 0.3499 - 21s/epoch - 43ms/step
Epoch 31/50
486/486 - 21s - loss: 3.2485 - accuracy500: 0.3877 - val_loss: 3.3073 - val_accuracy500: 0.3518 - 21s/epoch - 42ms/step
Epoch 32/50
486/486 - 21s - loss: 3.2454 - accuracy500: 0.3904 - val_loss: 3.3099 - val_accuracy500: 0.3509 - 21s/epoch - 42ms/step
Epoch 33/50
486/486 - 23s - loss: 3.2455 - accuracy500: 0.3867 - val_loss: 3.3090 - val_accuracy500: 0.3516 - 23s/epoch - 47ms/step
Epoch 34/50
486/486 - 22s - loss: 3.2419 - accuracy500: 0.3883 - val_loss: 3.3086 - val_accuracy500: 0.3484 - 22s/epoch - 46ms/step
testing model: results/CHTR/W0/deepVOL_L3/h500
Evaluating performance on  test set...
1269/1269 - 27s - 27s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994012
{'0': {'precision': 0.3097432521395655, 'recall': 0.046803811949147484, 'f1-score': 0.0813197829167963, 'support': 100526}, '1': {'precision': 0.39411947816736, 'recall': 0.3549305107207177, 'f1-score': 0.3734998457942045, 'support': 117716}, '2': {'precision': 0.3358763626002761, 'recall': 0.6418580199395431, 'f1-score': 0.4409887611461374, 'support': 106522}, 'accuracy': 0.3536660467293173, 'macro avg': {'precision': 0.3465796976357338, 'recall': 0.34786411420313607, 'f1-score': 0.29860279661904604, 'support': 324764}, 'weighted avg': {'precision': 0.3488984017730953, 'recall': 0.3536660467293173, 'f1-score': 0.305195973567924, 'support': 324764}}
[[ 4705 30609 65212]
 [ 5956 41781 69979]
 [ 4529 33621 68372]]
Evaluating performance on  train set...
486/486 - 10s - 10s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0937777
{'0': {'precision': 0.35589551161783806, 'recall': 0.05934161131966503, 'f1-score': 0.10172218211818089, 'support': 41556}, '1': {'precision': 0.3840359031896137, 'recall': 0.4086844221350423, 'f1-score': 0.39597695721975634, 'support': 41039}, '2': {'precision': 0.3512552102426242, 'recall': 0.621003360537686, 'f1-score': 0.44870916548871326, 'support': 41660}, 'accuracy': 0.3630356927286628, 'macro avg': {'precision': 0.36372887501669204, 'recall': 0.36300979799746447, 'f1-score': 0.31546943494221685, 'support': 124255}, 'weighted avg': {'precision': 0.36363394125385023, 'recall': 0.3630356927286628, 'f1-score': 0.3152459794914048, 'support': 124255}}
[[ 2466 13243 25847]
 [ 2332 16772 21935]
 [ 2131 13658 25871]]
Evaluating performance on  val set...
178/178 - 4s - 4s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1007553
{'0': {'precision': 0.3201927288655278, 'recall': 0.05054975451213609, 'f1-score': 0.08731485905398949, 'support': 14461}, '1': {'precision': 0.34328477669281254, 'recall': 0.2835889976196773, 'f1-score': 0.31059453979288865, 'support': 15124}, '2': {'precision': 0.35855316657450476, 'recall': 0.6917477251333543, 'f1-score': 0.47229958438664893, 'support': 15935}, 'accuracy': 0.35243848857644994, 'macro avg': {'precision': 0.34067689071094837, 'recall': 0.34196215908838923, 'f1-score': 0.2900696610778424, 'support': 45520}, 'weighted avg': {'precision': 0.34129373295674925, 'recall': 0.35243848857644994, 'f1-score': 0.2962694611996626, 'support': 45520}}
[[  731  4048  9682]
 [  797  4289 10038]
 [  755  4157 11023]]
training model: results/CHTR/W0/deepVOL_L3/h1000
Epoch 1/50
486/486 - 24s - loss: 3.3081 - accuracy1000: 0.3806 - val_loss: 3.4009 - val_accuracy1000: 0.3098 - 24s/epoch - 49ms/step
Epoch 2/50
486/486 - 21s - loss: 3.3084 - accuracy1000: 0.3534 - val_loss: 3.3310 - val_accuracy1000: 0.3180 - 21s/epoch - 42ms/step
Epoch 3/50
486/486 - 21s - loss: 3.2969 - accuracy1000: 0.3534 - val_loss: 3.3328 - val_accuracy1000: 0.3198 - 21s/epoch - 43ms/step
Epoch 4/50
486/486 - 21s - loss: 3.2936 - accuracy1000: 0.3557 - val_loss: 3.3398 - val_accuracy1000: 0.3218 - 21s/epoch - 44ms/step
Epoch 5/50
486/486 - 22s - loss: 3.2930 - accuracy1000: 0.3560 - val_loss: 3.3443 - val_accuracy1000: 0.3209 - 22s/epoch - 45ms/step
Epoch 6/50
486/486 - 22s - loss: 3.2904 - accuracy1000: 0.3594 - val_loss: 3.3460 - val_accuracy1000: 0.3335 - 22s/epoch - 44ms/step
Epoch 7/50
486/486 - 21s - loss: 3.2889 - accuracy1000: 0.3596 - val_loss: 3.3438 - val_accuracy1000: 0.3361 - 21s/epoch - 42ms/step
Epoch 8/50
486/486 - 20s - loss: 3.2883 - accuracy1000: 0.3596 - val_loss: 3.3478 - val_accuracy1000: 0.3325 - 20s/epoch - 41ms/step
Epoch 9/50
486/486 - 20s - loss: 3.2860 - accuracy1000: 0.3625 - val_loss: 3.3394 - val_accuracy1000: 0.3408 - 20s/epoch - 41ms/step
Epoch 10/50
486/486 - 20s - loss: 3.2875 - accuracy1000: 0.3594 - val_loss: 3.3450 - val_accuracy1000: 0.3417 - 20s/epoch - 41ms/step
Epoch 11/50
486/486 - 20s - loss: 3.2885 - accuracy1000: 0.3605 - val_loss: 3.3405 - val_accuracy1000: 0.3408 - 20s/epoch - 41ms/step
Epoch 12/50
486/486 - 20s - loss: 3.2875 - accuracy1000: 0.3586 - val_loss: 3.3452 - val_accuracy1000: 0.3395 - 20s/epoch - 41ms/step
testing model: results/CHTR/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
1269/1269 - 25s - 25s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1201525
{'0': {'precision': 0.29744116587061253, 'recall': 0.7392512972572276, 'f1-score': 0.42420250083449773, 'support': 97128}, '1': {'precision': 0.3333333333333333, 'recall': 0.00015948454594749768, 'f1-score': 0.0003188165529554294, 'support': 125404}, '2': {'precision': 0.3077246263729668, 'recall': 0.2507531888254167, 'f1-score': 0.2763330225238092, 'support': 102232}, 'accuracy': 0.30008560062075845, 'macro avg': {'precision': 0.31283304185897093, 'recall': 0.3300546568761973, 'f1-score': 0.23361811330375412, 'support': 324764}, 'weighted avg': {'precision': 0.3145376423968646, 'recall': 0.30008560062075845, 'f1-score': 0.21397691533148372, 'support': 324764}}
[[71802    16 25310]
 [93024    20 32360]
 [76573    24 25635]]
Evaluating performance on  train set...
486/486 - 9s - 9s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048799
{'0': {'precision': 0.337095095615975, 'recall': 0.7477635629088111, 'f1-score': 0.46470095944047574, 'support': 41584}, '1': {'precision': 0.46153846153846156, 'recall': 0.000292326431181486, 'f1-score': 0.0005842827928717499, 'support': 41050}, '2': {'precision': 0.3340941066124746, 'recall': 0.25674539295067395, 'f1-score': 0.290356764394207, 'support': 41621}, 'accuracy': 0.3363486378817754, 'macro avg': {'precision': 0.3775758879223037, 'recall': 0.33493376076355547, 'f1-score': 0.2518806688758515, 'support': 124255}, 'weighted avg': {'precision': 0.377202101433072, 'recall': 0.3363486378817754, 'f1-score': 0.2529721008963134, 'support': 124255}}
[[31095     7 10482]
 [30221    12 10817]
 [30928     7 10686]]
Evaluating performance on  val set...
178/178 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1095498
{'0': {'precision': 0.30700037966180893, 'recall': 0.7477060957393841, 'f1-score': 0.43527950310559005, 'support': 14059}, '1': {'precision': 0.3333333333333333, 'recall': 6.45244547683572e-05, 'f1-score': 0.00012902393393974583, 'support': 15498}, '2': {'precision': 0.3519865200425683, 'recall': 0.24863747415899268, 'f1-score': 0.2914203898821543, 'support': 15963}, 'accuracy': 0.31814586994727595, 'macro avg': {'precision': 0.3307734110125702, 'recall': 0.33213603145104836, 'f1-score': 0.24227630564056138, 'support': 45520}, 'weighted avg': {'precision': 0.3317416335040617, 'recall': 0.31814586994727595, 'f1-score': 0.23667701737211155, 'support': 45520}}
[[10512     0  3547]
 [11737     1  3760]
 [11992     2  3969]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  13.49 (ave)

============================================
