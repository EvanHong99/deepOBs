This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-22.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-14.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-01.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-02.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-10.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-06.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-08.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-03.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-24.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-07.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-20.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-09.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-04-30.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-05-15.csv
training model: results/CHTR/W3/deepLOB_L1/h10
Epoch 1/50
385/385 - 48s - loss: 3.3151 - accuracy10: 0.3677 - val_loss: 3.3450 - val_accuracy10: 0.3600 - 48s/epoch - 125ms/step
Epoch 2/50
385/385 - 8s - loss: 3.2718 - accuracy10: 0.3863 - val_loss: 3.3533 - val_accuracy10: 0.3631 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2464 - accuracy10: 0.4017 - val_loss: 3.3276 - val_accuracy10: 0.3886 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2263 - accuracy10: 0.4156 - val_loss: 3.2827 - val_accuracy10: 0.3913 - 8s/epoch - 20ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2123 - accuracy10: 0.4238 - val_loss: 3.2627 - val_accuracy10: 0.3994 - 8s/epoch - 20ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2012 - accuracy10: 0.4300 - val_loss: 3.2900 - val_accuracy10: 0.4013 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.1895 - accuracy10: 0.4348 - val_loss: 3.2741 - val_accuracy10: 0.4045 - 8s/epoch - 21ms/step
Epoch 8/50
385/385 - 8s - loss: 3.1790 - accuracy10: 0.4404 - val_loss: 3.2734 - val_accuracy10: 0.4028 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.1757 - accuracy10: 0.4415 - val_loss: 3.2876 - val_accuracy10: 0.4045 - 8s/epoch - 21ms/step
Epoch 10/50
385/385 - 8s - loss: 3.1658 - accuracy10: 0.4447 - val_loss: 3.2568 - val_accuracy10: 0.4083 - 8s/epoch - 21ms/step
Epoch 11/50
385/385 - 8s - loss: 3.1619 - accuracy10: 0.4486 - val_loss: 3.2710 - val_accuracy10: 0.4054 - 8s/epoch - 21ms/step
Epoch 12/50
385/385 - 8s - loss: 3.1532 - accuracy10: 0.4505 - val_loss: 3.2592 - val_accuracy10: 0.4086 - 8s/epoch - 21ms/step
Epoch 13/50
385/385 - 8s - loss: 3.1497 - accuracy10: 0.4510 - val_loss: 3.2802 - val_accuracy10: 0.4061 - 8s/epoch - 22ms/step
Epoch 14/50
385/385 - 8s - loss: 3.1457 - accuracy10: 0.4532 - val_loss: 3.2731 - val_accuracy10: 0.4056 - 8s/epoch - 20ms/step
Epoch 15/50
385/385 - 8s - loss: 3.1394 - accuracy10: 0.4552 - val_loss: 3.2604 - val_accuracy10: 0.4108 - 8s/epoch - 20ms/step
Epoch 16/50
385/385 - 8s - loss: 3.1353 - accuracy10: 0.4549 - val_loss: 3.2915 - val_accuracy10: 0.4089 - 8s/epoch - 20ms/step
Epoch 17/50
385/385 - 8s - loss: 3.1311 - accuracy10: 0.4564 - val_loss: 3.3018 - val_accuracy10: 0.4109 - 8s/epoch - 20ms/step
Epoch 18/50
385/385 - 8s - loss: 3.1266 - accuracy10: 0.4603 - val_loss: 3.2724 - val_accuracy10: 0.4056 - 8s/epoch - 21ms/step
Epoch 19/50
385/385 - 8s - loss: 3.1250 - accuracy10: 0.4601 - val_loss: 3.3192 - val_accuracy10: 0.4071 - 8s/epoch - 20ms/step
Epoch 20/50
385/385 - 8s - loss: 3.1205 - accuracy10: 0.4617 - val_loss: 3.3049 - val_accuracy10: 0.4088 - 8s/epoch - 21ms/step
testing model: results/CHTR/W3/deepLOB_L1/h10
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0873215
{'0': {'precision': 0.3972681901759916, 'recall': 0.512981034800221, 'f1-score': 0.447769779304161, 'support': 103189}, '1': {'precision': 0.40614578370652693, 'recall': 0.14533675720024294, 'f1-score': 0.21406991799741046, 'support': 93851}, '2': {'precision': 0.40449285118933126, 'recall': 0.5337175487759742, 'f1-score': 0.46020579827756775, 'support': 94565}, 'accuracy': 0.40138200648137035, 'macro avg': {'precision': 0.4026356083572833, 'recall': 0.397345113592146, 'f1-score': 0.3740151651930464, 'support': 291605}, 'weighted avg': {'precision': 0.40246827624845516, 'recall': 0.40138200648137035, 'f1-score': 0.37658803156568044, 'support': 291605}}
[[52934 11430 38825]
 [44731 13640 35480]
 [35580  8514 50471]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0712434
{'0': {'precision': 0.4141804245283019, 'recall': 0.424800435413643, 'f1-score': 0.41942321471220445, 'support': 33072}, '1': {'precision': 0.4626565051714752, 'recall': 0.26194292054490537, 'f1-score': 0.33450094458438284, 'support': 32446}, '2': {'precision': 0.40841986602787833, 'recall': 0.5726269718245646, 'f1-score': 0.4767809692521827, 'support': 32901}, 'accuracy': 0.42052855647791587, 'macro avg': {'precision': 0.4284189319092185, 'recall': 0.4197901092610376, 'f1-score': 0.41023504284959, 'support': 98419}, 'weighted avg': {'precision': 0.4282359095192687, 'recall': 0.42052855647791587, 'f1-score': 0.41060113265033144, 'support': 98419}}
[[14049  5184 13839]
 [10497  8499 13450]
 [ 9374  4687 18840]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0852515
{'0': {'precision': 0.4049596798641848, 'recall': 0.5316828530488775, 'f1-score': 0.45974875236620205, 'support': 12562}, '1': {'precision': 0.43990665110851807, 'recall': 0.1968497084674963, 'f1-score': 0.27198941862562376, 'support': 11491}, '2': {'precision': 0.4002620850320326, 'recall': 0.4857748718854921, 'f1-score': 0.4388919932944839, 'support': 11318}, 'accuracy': 0.4082157699810579, 'macro avg': {'precision': 0.41504280533491184, 'recall': 0.4047691444672887, 'f1-score': 0.39021005476210324, 'support': 35371}, 'weighted avg': {'precision': 0.41480979064019724, 'recall': 0.4082157699810579, 'f1-score': 0.3920775159525668, 'support': 35371}}
[[6679 1543 4340]
 [5331 2262 3898]
 [4483 1337 5498]]
training model: results/CHTR/W3/deepLOB_L1/h20
Epoch 1/50
385/385 - 10s - loss: 3.3248 - accuracy20: 0.3581 - val_loss: 3.3404 - val_accuracy20: 0.3524 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.2873 - accuracy20: 0.3722 - val_loss: 3.3344 - val_accuracy20: 0.3566 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2721 - accuracy20: 0.3832 - val_loss: 3.3266 - val_accuracy20: 0.3672 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2538 - accuracy20: 0.3957 - val_loss: 3.2821 - val_accuracy20: 0.3809 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2453 - accuracy20: 0.4036 - val_loss: 3.2975 - val_accuracy20: 0.3836 - 8s/epoch - 21ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2350 - accuracy20: 0.4104 - val_loss: 3.2789 - val_accuracy20: 0.3851 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2294 - accuracy20: 0.4119 - val_loss: 3.2729 - val_accuracy20: 0.3929 - 8s/epoch - 21ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2202 - accuracy20: 0.4180 - val_loss: 3.2676 - val_accuracy20: 0.3937 - 8s/epoch - 20ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2106 - accuracy20: 0.4232 - val_loss: 3.2663 - val_accuracy20: 0.3911 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2038 - accuracy20: 0.4280 - val_loss: 3.2694 - val_accuracy20: 0.3940 - 8s/epoch - 21ms/step
Epoch 11/50
385/385 - 8s - loss: 3.1989 - accuracy20: 0.4294 - val_loss: 3.2694 - val_accuracy20: 0.3874 - 8s/epoch - 20ms/step
Epoch 12/50
385/385 - 8s - loss: 3.1920 - accuracy20: 0.4331 - val_loss: 3.2694 - val_accuracy20: 0.3907 - 8s/epoch - 21ms/step
Epoch 13/50
385/385 - 8s - loss: 3.1865 - accuracy20: 0.4334 - val_loss: 3.2638 - val_accuracy20: 0.3908 - 8s/epoch - 20ms/step
Epoch 14/50
385/385 - 8s - loss: 3.1829 - accuracy20: 0.4376 - val_loss: 3.2750 - val_accuracy20: 0.3875 - 8s/epoch - 21ms/step
Epoch 15/50
385/385 - 8s - loss: 3.1794 - accuracy20: 0.4375 - val_loss: 3.2670 - val_accuracy20: 0.3933 - 8s/epoch - 21ms/step
Epoch 16/50
385/385 - 8s - loss: 3.1761 - accuracy20: 0.4408 - val_loss: 3.2764 - val_accuracy20: 0.3892 - 8s/epoch - 20ms/step
Epoch 17/50
385/385 - 8s - loss: 3.1728 - accuracy20: 0.4405 - val_loss: 3.2809 - val_accuracy20: 0.3904 - 8s/epoch - 21ms/step
Epoch 18/50
385/385 - 8s - loss: 3.1654 - accuracy20: 0.4438 - val_loss: 3.2662 - val_accuracy20: 0.3929 - 8s/epoch - 20ms/step
Epoch 19/50
385/385 - 8s - loss: 3.1618 - accuracy20: 0.4454 - val_loss: 3.2833 - val_accuracy20: 0.3911 - 8s/epoch - 21ms/step
Epoch 20/50
385/385 - 8s - loss: 3.1571 - accuracy20: 0.4458 - val_loss: 3.2866 - val_accuracy20: 0.3897 - 8s/epoch - 20ms/step
Epoch 21/50
385/385 - 8s - loss: 3.1532 - accuracy20: 0.4477 - val_loss: 3.2869 - val_accuracy20: 0.3878 - 8s/epoch - 21ms/step
Epoch 22/50
385/385 - 8s - loss: 3.1519 - accuracy20: 0.4486 - val_loss: 3.2816 - val_accuracy20: 0.3869 - 8s/epoch - 21ms/step
Epoch 23/50
385/385 - 8s - loss: 3.1474 - accuracy20: 0.4512 - val_loss: 3.2845 - val_accuracy20: 0.3867 - 8s/epoch - 20ms/step
testing model: results/CHTR/W3/deepLOB_L1/h20
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0997075
{'0': {'precision': 0.38367335093879684, 'recall': 0.2684085510688836, 'f1-score': 0.3158536002675713, 'support': 98514}, '1': {'precision': 0.37645071650411377, 'recall': 0.21226458570155765, 'f1-score': 0.271462810891517, 'support': 97647}, '2': {'precision': 0.3808313646884769, 'recall': 0.6688529399438414, 'f1-score': 0.4853272108016057, 'support': 95444}, 'accuracy': 0.3806759143361739, 'macro avg': {'precision': 0.38031847737712915, 'recall': 0.3831753589047609, 'f1-score': 0.35754787398689797, 'support': 291605}, 'weighted avg': {'precision': 0.38032457735700287, 'recall': 0.3806759143361739, 'f1-score': 0.3564585688847309, 'support': 291605}}
[[26442 19891 52181]
 [25311 20727 51609]
 [17165 14441 63838]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0829772
{'0': {'precision': 0.44933141059255377, 'recall': 0.20441939524065128, 'f1-score': 0.2810002049600328, 'support': 33534}, '1': {'precision': 0.41871380445891215, 'recall': 0.3409672348426471, 'f1-score': 0.37586218613027084, 'support': 32443}, '2': {'precision': 0.3865783166502185, 'recall': 0.6761605326428703, 'f1-score': 0.49191577153364874, 'support': 32442}, 'accuracy': 0.4049319745171156, 'macro avg': {'precision': 0.4182078439005615, 'recall': 0.40718238757538955, 'f1-score': 0.38292605420798415, 'support': 98419}, 'weighted avg': {'precision': 0.41855317804120723, 'recall': 0.4049319745171156, 'f1-score': 0.3817950724743063, 'support': 98419}}
[[ 6855  8757 17922]
 [ 4495 11062 16886]
 [ 3906  6600 21936]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0883251
{'0': {'precision': 0.4010804199368056, 'recall': 0.31695529601288763, 'f1-score': 0.3540898047331953, 'support': 12415}, '1': {'precision': 0.3951035031847134, 'recall': 0.33853500469003156, 'f1-score': 0.36463834672789897, 'support': 11727}, '2': {'precision': 0.3795126353790614, 'recall': 0.5242675215958679, 'f1-score': 0.44029767024419425, 'support': 11229}, 'accuracy': 0.38992394899776656, 'macro avg': {'precision': 0.39189885283352677, 'recall': 0.393252607432929, 'f1-score': 0.38634194056842946, 'support': 35371}, 'weighted avg': {'precision': 0.3922518328018449, 'recall': 0.38992394899776656, 'f1-score': 0.38495494492699517, 'support': 35371}}
[[3935 3305 5175]
 [3307 3970 4450]
 [2569 2773 5887]]
training model: results/CHTR/W3/deepLOB_L1/h30
Epoch 1/50
385/385 - 10s - loss: 3.3316 - accuracy30: 0.3514 - val_loss: 3.3306 - val_accuracy30: 0.3527 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.2957 - accuracy30: 0.3673 - val_loss: 3.3117 - val_accuracy30: 0.3545 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2843 - accuracy30: 0.3755 - val_loss: 3.3072 - val_accuracy30: 0.3652 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2675 - accuracy30: 0.3869 - val_loss: 3.3426 - val_accuracy30: 0.3494 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2607 - accuracy30: 0.3919 - val_loss: 3.3553 - val_accuracy30: 0.3479 - 8s/epoch - 22ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2525 - accuracy30: 0.3985 - val_loss: 3.3356 - val_accuracy30: 0.3545 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2458 - accuracy30: 0.4008 - val_loss: 3.3397 - val_accuracy30: 0.3566 - 8s/epoch - 20ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2398 - accuracy30: 0.4045 - val_loss: 3.3556 - val_accuracy30: 0.3532 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2356 - accuracy30: 0.4070 - val_loss: 3.3209 - val_accuracy30: 0.3576 - 8s/epoch - 21ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2301 - accuracy30: 0.4109 - val_loss: 3.3406 - val_accuracy30: 0.3551 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2264 - accuracy30: 0.4139 - val_loss: 3.3756 - val_accuracy30: 0.3573 - 8s/epoch - 20ms/step
Epoch 12/50
385/385 - 8s - loss: 3.2227 - accuracy30: 0.4155 - val_loss: 3.3521 - val_accuracy30: 0.3563 - 8s/epoch - 20ms/step
Epoch 13/50
385/385 - 8s - loss: 3.2184 - accuracy30: 0.4170 - val_loss: 3.3756 - val_accuracy30: 0.3548 - 8s/epoch - 22ms/step
testing model: results/CHTR/W3/deepLOB_L1/h30
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1063175
{'0': {'precision': 0.3682179037599844, 'recall': 0.31432283546408896, 'f1-score': 0.33914252711144005, 'support': 96210}, '1': {'precision': 0.3713694191070571, 'recall': 0.12450457700432552, 'f1-score': 0.18648766743509773, 'support': 99410}, '2': {'precision': 0.36086494955974774, 'recall': 0.6622493097879877, 'f1-score': 0.4671669104191318, 'support': 95985}, 'accuracy': 0.3641364174139675, 'macro avg': {'precision': 0.3668174241422631, 'recall': 0.3670255740854674, 'f1-score': 0.3309323683218899, 'support': 291605}, 'weighted avg': {'precision': 0.3668719694712815, 'recall': 0.3641364174139675, 'f1-score': 0.3292421510251713, 'support': 291605}}
[[30241 11184 54785]
 [29235 12377 57798]
 [22652  9767 63566]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0950421
{'0': {'precision': 0.388756171364867, 'recall': 0.3624565675763965, 'f1-score': 0.3751460011065347, 'support': 33673}, '1': {'precision': 0.3955025450125351, 'recall': 0.16084283375042482, 'f1-score': 0.22868438392268833, 'support': 32367}, '2': {'precision': 0.36378826980561074, 'recall': 0.6051453102319404, 'f1-score': 0.45440630797773657, 'support': 32379}, 'accuracy': 0.37599447261199564, 'macro avg': {'precision': 0.382682328727671, 'recall': 0.3761482371862539, 'f1-score': 0.3527455643356532, 'support': 98419}, 'weighted avg': {'precision': 0.38276062366845587, 'recall': 0.37599447261199564, 'f1-score': 0.3530552088082294, 'support': 98419}}
[[12205  4274 17194]
 [10088  5206 17073]
 [ 9102  3683 19594]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1029396
{'0': {'precision': 0.36837177632138907, 'recall': 0.35164120896977574, 'f1-score': 0.35981211289853265, 'support': 12308}, '1': {'precision': 0.4166666666666667, 'recall': 0.1309164149043303, 'f1-score': 0.1992337164750958, 'support': 11916}, '2': {'precision': 0.34731864372673305, 'recall': 0.6193594689154033, 'f1-score': 0.4450604351329573, 'support': 11147}, 'accuracy': 0.3616522009555851, 'macro avg': {'precision': 0.3774523622382629, 'recall': 0.36730569759650306, 'f1-score': 0.3347020881688619, 'support': 35371}, 'weighted avg': {'precision': 0.3780068628137613, 'recall': 0.3616522009555851, 'f1-score': 0.332581072672513, 'support': 35371}}
[[4328 1182 6798]
 [4180 1560 6176]
 [3241 1002 6904]]
training model: results/CHTR/W3/deepLOB_L1/h50
Epoch 1/50
385/385 - 10s - loss: 3.3413 - accuracy50: 0.3491 - val_loss: 3.3212 - val_accuracy50: 0.3472 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3038 - accuracy50: 0.3583 - val_loss: 3.3217 - val_accuracy50: 0.3404 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2910 - accuracy50: 0.3629 - val_loss: 3.3281 - val_accuracy50: 0.3351 - 8s/epoch - 20ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2832 - accuracy50: 0.3717 - val_loss: 3.3418 - val_accuracy50: 0.3313 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2773 - accuracy50: 0.3752 - val_loss: 3.3483 - val_accuracy50: 0.3276 - 8s/epoch - 21ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2679 - accuracy50: 0.3822 - val_loss: 3.3328 - val_accuracy50: 0.3304 - 8s/epoch - 22ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2644 - accuracy50: 0.3841 - val_loss: 3.3217 - val_accuracy50: 0.3396 - 8s/epoch - 20ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2578 - accuracy50: 0.3884 - val_loss: 3.3411 - val_accuracy50: 0.3335 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2516 - accuracy50: 0.3929 - val_loss: 3.3405 - val_accuracy50: 0.3412 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2454 - accuracy50: 0.3971 - val_loss: 3.3194 - val_accuracy50: 0.3486 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2437 - accuracy50: 0.3991 - val_loss: 3.3185 - val_accuracy50: 0.3482 - 8s/epoch - 21ms/step
Epoch 12/50
385/385 - 8s - loss: 3.2390 - accuracy50: 0.4024 - val_loss: 3.3214 - val_accuracy50: 0.3463 - 8s/epoch - 21ms/step
Epoch 13/50
385/385 - 8s - loss: 3.2341 - accuracy50: 0.4049 - val_loss: 3.3243 - val_accuracy50: 0.3505 - 8s/epoch - 21ms/step
Epoch 14/50
385/385 - 8s - loss: 3.2316 - accuracy50: 0.4061 - val_loss: 3.3490 - val_accuracy50: 0.3436 - 8s/epoch - 21ms/step
Epoch 15/50
385/385 - 8s - loss: 3.2264 - accuracy50: 0.4085 - val_loss: 3.3260 - val_accuracy50: 0.3585 - 8s/epoch - 21ms/step
Epoch 16/50
385/385 - 8s - loss: 3.2236 - accuracy50: 0.4106 - val_loss: 3.3222 - val_accuracy50: 0.3510 - 8s/epoch - 21ms/step
Epoch 17/50
385/385 - 8s - loss: 3.2212 - accuracy50: 0.4156 - val_loss: 3.3219 - val_accuracy50: 0.3582 - 8s/epoch - 20ms/step
Epoch 18/50
385/385 - 8s - loss: 3.2158 - accuracy50: 0.4165 - val_loss: 3.3252 - val_accuracy50: 0.3524 - 8s/epoch - 21ms/step
Epoch 19/50
385/385 - 8s - loss: 3.2126 - accuracy50: 0.4174 - val_loss: 3.3345 - val_accuracy50: 0.3456 - 8s/epoch - 21ms/step
Epoch 20/50
385/385 - 8s - loss: 3.2092 - accuracy50: 0.4189 - val_loss: 3.3269 - val_accuracy50: 0.3528 - 8s/epoch - 20ms/step
Epoch 21/50
385/385 - 8s - loss: 3.2045 - accuracy50: 0.4196 - val_loss: 3.3147 - val_accuracy50: 0.3572 - 8s/epoch - 21ms/step
Epoch 22/50
385/385 - 8s - loss: 3.2026 - accuracy50: 0.4220 - val_loss: 3.3345 - val_accuracy50: 0.3526 - 8s/epoch - 21ms/step
Epoch 23/50
385/385 - 8s - loss: 3.2007 - accuracy50: 0.4230 - val_loss: 3.3359 - val_accuracy50: 0.3501 - 8s/epoch - 20ms/step
Epoch 24/50
385/385 - 8s - loss: 3.1956 - accuracy50: 0.4258 - val_loss: 3.3482 - val_accuracy50: 0.3503 - 8s/epoch - 21ms/step
Epoch 25/50
385/385 - 8s - loss: 3.1926 - accuracy50: 0.4274 - val_loss: 3.3468 - val_accuracy50: 0.3547 - 8s/epoch - 21ms/step
Epoch 26/50
385/385 - 8s - loss: 3.1898 - accuracy50: 0.4292 - val_loss: 3.3361 - val_accuracy50: 0.3586 - 8s/epoch - 22ms/step
Epoch 27/50
385/385 - 8s - loss: 3.1872 - accuracy50: 0.4303 - val_loss: 3.3647 - val_accuracy50: 0.3509 - 8s/epoch - 21ms/step
Epoch 28/50
385/385 - 8s - loss: 3.1837 - accuracy50: 0.4310 - val_loss: 3.3673 - val_accuracy50: 0.3503 - 8s/epoch - 21ms/step
Epoch 29/50
385/385 - 8s - loss: 3.1805 - accuracy50: 0.4335 - val_loss: 3.3771 - val_accuracy50: 0.3486 - 8s/epoch - 20ms/step
Epoch 30/50
385/385 - 8s - loss: 3.1781 - accuracy50: 0.4346 - val_loss: 3.3574 - val_accuracy50: 0.3527 - 8s/epoch - 20ms/step
Epoch 31/50
385/385 - 8s - loss: 3.1737 - accuracy50: 0.4376 - val_loss: 3.3639 - val_accuracy50: 0.3476 - 8s/epoch - 20ms/step
testing model: results/CHTR/W3/deepLOB_L1/h50
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1071196
{'0': {'precision': 0.3612653578767872, 'recall': 0.17555694844309405, 'f1-score': 0.23628915214733576, 'support': 94129}, '1': {'precision': 0.374105453648104, 'recall': 0.22462587049933325, 'f1-score': 0.28070608566843597, 'support': 101235}, '2': {'precision': 0.35878926722787147, 'recall': 0.6899762055672738, 'f1-score': 0.4720904027100907, 'support': 96241}, 'accuracy': 0.3623703297268565, 'macro avg': {'precision': 0.36472002625092087, 'recall': 0.3633863415032337, 'f1-score': 0.3296952135086208, 'support': 291605}, 'weighted avg': {'precision': 0.36490578124149964, 'recall': 0.3623703297268565, 'f1-score': 0.3295327399473347, 'support': 291605}}
[[16525 20793 56811]
 [16632 22740 61863]
 [12585 17252 66404]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026056
{'0': {'precision': 0.41474336892869446, 'recall': 0.1788685524126456, 'f1-score': 0.2499429117103652, 'support': 33656}, '1': {'precision': 0.3746269411705195, 'recall': 0.22834767058243147, 'f1-score': 0.2837439178575533, 'support': 32433}, '2': {'precision': 0.3557807749278865, 'recall': 0.7057841014537581, 'f1-score': 0.47308350178821335, 'support': 32330}, 'accuracy': 0.3682622257897357, 'macro avg': {'precision': 0.3817170283423668, 'recall': 0.37100010814961176, 'f1-score': 0.33559011045204395, 'support': 98419}, 'weighted avg': {'precision': 0.38215457240031064, 'recall': 0.3682622257897357, 'f1-score': 0.3343819256161007, 'support': 98419}}
[[ 6020  6802 20834]
 [ 4544  7406 20483]
 [ 3951  5561 22818]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1064906
{'0': {'precision': 0.3654962275101567, 'recall': 0.20737630690705525, 'f1-score': 0.2646147381690215, 'support': 12147}, '1': {'precision': 0.3727427904051747, 'recall': 0.34008196721311473, 'f1-score': 0.3556641378423556, 'support': 12200}, '2': {'precision': 0.3378487433709938, 'recall': 0.5316582002902758, 'f1-score': 0.4131538136190611, 'support': 11024}, 'accuracy': 0.35421673122049135, 'macro avg': {'precision': 0.35869592042877513, 'recall': 0.3597054914701486, 'f1-score': 0.34447756321014605, 'support': 35371}, 'weighted avg': {'precision': 0.359378848927959, 'recall': 0.35421673122049135, 'f1-score': 0.34231391104442543, 'support': 35371}}
[[2519 3808 5820]
 [2384 4149 5667]
 [1989 3174 5861]]
training model: results/CHTR/W3/deepLOB_L1/h100
Epoch 1/50
385/385 - 10s - loss: 3.3463 - accuracy100: 0.3408 - val_loss: 3.3459 - val_accuracy100: 0.3389 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3131 - accuracy100: 0.3504 - val_loss: 3.3344 - val_accuracy100: 0.3433 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.3087 - accuracy100: 0.3516 - val_loss: 3.3274 - val_accuracy100: 0.3344 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2985 - accuracy100: 0.3565 - val_loss: 3.3419 - val_accuracy100: 0.3340 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2904 - accuracy100: 0.3619 - val_loss: 3.3489 - val_accuracy100: 0.3202 - 8s/epoch - 21ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2863 - accuracy100: 0.3634 - val_loss: 3.3505 - val_accuracy100: 0.3205 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2793 - accuracy100: 0.3684 - val_loss: 3.3437 - val_accuracy100: 0.3210 - 8s/epoch - 20ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2741 - accuracy100: 0.3759 - val_loss: 3.3712 - val_accuracy100: 0.3220 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2708 - accuracy100: 0.3759 - val_loss: 3.3560 - val_accuracy100: 0.3239 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2628 - accuracy100: 0.3841 - val_loss: 3.3525 - val_accuracy100: 0.3276 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2585 - accuracy100: 0.3860 - val_loss: 3.3850 - val_accuracy100: 0.3275 - 8s/epoch - 20ms/step
Epoch 12/50
385/385 - 8s - loss: 3.2532 - accuracy100: 0.3911 - val_loss: 3.4114 - val_accuracy100: 0.3257 - 8s/epoch - 20ms/step
Epoch 13/50
385/385 - 8s - loss: 3.2498 - accuracy100: 0.3930 - val_loss: 3.4013 - val_accuracy100: 0.3346 - 8s/epoch - 20ms/step
testing model: results/CHTR/W3/deepLOB_L1/h100
Evaluating performance on  test set...
1140/1140 - 7s - 7s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1091806
{'0': {'precision': 0.3215868794326241, 'recall': 0.2796599280452287, 'f1-score': 0.2991615504444241, 'support': 93392}, '1': {'precision': 0.35240984945734627, 'recall': 0.1475852092232203, 'f1-score': 0.20804398148148145, 'support': 102307}, '2': {'precision': 0.328033233061166, 'recall': 0.5730611223489667, 'f1-score': 0.41723287151262095, 'support': 95906}, 'accuracy': 0.3298194475403371, 'macro avg': {'precision': 0.33400998731704545, 'recall': 0.3334354198724719, 'f1-score': 0.30814613447950884, 'support': 291605}, 'weighted avg': {'precision': 0.3345209840790403, 'recall': 0.3298194475403371, 'f1-score': 0.30602625780703696, 'support': 291605}}
[[26118 13653 53621]
 [28245 15099 58963]
 [26853 14093 54960]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1060306
{'0': {'precision': 0.34060461836770667, 'recall': 0.23224856516121278, 'f1-score': 0.276178735416555, 'support': 33279}, '1': {'precision': 0.33127193715527326, 'recall': 0.12172204139286372, 'f1-score': 0.17802928231384174, 'support': 32566}, '2': {'precision': 0.3326171170464704, 'recall': 0.6510714066433352, 'f1-score': 0.4402968806768049, 'support': 32574}, 'accuracy': 0.33429520722624695, 'macro avg': {'precision': 0.3348312241898168, 'recall': 0.3350140043991372, 'f1-score': 0.29816829946906726, 'support': 98419}, 'weighted avg': {'precision': 0.33487286977849057, 'recall': 0.33429520722624695, 'f1-score': 0.2980205482165674, 'support': 98419}}
[[ 7729  4132 21418]
 [ 7467  3964 21135]
 [ 7496  3870 21208]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1101335
{'0': {'precision': 0.33265001863585536, 'recall': 0.30395913154533843, 'f1-score': 0.3176580504515727, 'support': 11745}, '1': {'precision': 0.3634707948484454, 'recall': 0.2187940485512921, 'f1-score': 0.27315833211125773, 'support': 12770}, '2': {'precision': 0.31329636621047663, 'recall': 0.4892225497420781, 'f1-score': 0.38197640966628305, 'support': 10856}, 'accuracy': 0.3300726583924684, 'macro avg': {'precision': 0.33647239323159245, 'recall': 0.33732524327956953, 'f1-score': 0.32426426407637116, 'support': 35371}, 'weighted avg': {'precision': 0.33783726416198867, 'recall': 0.3300726583924684, 'f1-score': 0.3213327756340406, 'support': 35371}}
[[3570 2567 5608]
 [3943 2794 6033]
 [3219 2326 5311]]
training model: results/CHTR/W3/deepLOB_L1/h200
Epoch 1/50
385/385 - 10s - loss: 3.3456 - accuracy200: 0.3417 - val_loss: 3.3671 - val_accuracy200: 0.3344 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3192 - accuracy200: 0.3452 - val_loss: 3.3442 - val_accuracy200: 0.3344 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.3034 - accuracy200: 0.3558 - val_loss: 3.3993 - val_accuracy200: 0.3100 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2970 - accuracy200: 0.3573 - val_loss: 3.4617 - val_accuracy200: 0.3121 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2936 - accuracy200: 0.3597 - val_loss: 3.4001 - val_accuracy200: 0.3064 - 8s/epoch - 21ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2859 - accuracy200: 0.3677 - val_loss: 3.3718 - val_accuracy200: 0.3174 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2814 - accuracy200: 0.3694 - val_loss: 3.3894 - val_accuracy200: 0.3078 - 8s/epoch - 21ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2735 - accuracy200: 0.3764 - val_loss: 3.4031 - val_accuracy200: 0.3089 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2692 - accuracy200: 0.3803 - val_loss: 3.4251 - val_accuracy200: 0.3045 - 8s/epoch - 21ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2639 - accuracy200: 0.3845 - val_loss: 3.4488 - val_accuracy200: 0.3064 - 8s/epoch - 21ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2598 - accuracy200: 0.3859 - val_loss: 3.4499 - val_accuracy200: 0.3054 - 8s/epoch - 21ms/step
Epoch 12/50
385/385 - 8s - loss: 3.2545 - accuracy200: 0.3900 - val_loss: 3.4047 - val_accuracy200: 0.3100 - 8s/epoch - 21ms/step
testing model: results/CHTR/W3/deepLOB_L1/h200
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1093655
{'0': {'precision': 0.3117320035312925, 'recall': 0.14359983293398695, 'f1-score': 0.19662435192222316, 'support': 90982}, '1': {'precision': 0.35674954113131985, 'recall': 0.28076692180699386, 'f1-score': 0.31423022413521606, 'support': 106608}, '2': {'precision': 0.3272956475583864, 'recall': 0.5771738552358666, 'f1-score': 0.4177177674196615, 'support': 94015}, 'accuracy': 0.3335333756279899, 'macro avg': {'precision': 0.33192573074033294, 'recall': 0.3338468699922825, 'f1-score': 0.3095241144923669, 'support': 291605}, 'weighted avg': {'precision': 0.3332077863253836, 'recall': 0.3335333756279899, 'f1-score': 0.3109016252298633, 'support': 291605}}
[[13065 28002 49915]
 [15062 29932 61614]
 [13784 25968 54263]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1082081
{'0': {'precision': 0.3251133363224232, 'recall': 0.19916987120795948, 'f1-score': 0.24701451579325875, 'support': 32766}, '1': {'precision': 0.3316541795586468, 'recall': 0.3996056320670425, 'f1-score': 0.36247275166284726, 'support': 32457}, '2': {'precision': 0.3444532225591886, 'recall': 0.4071574888540788, 'f1-score': 0.37318975633326434, 'support': 33196}, 'accuracy': 0.33542303823448727, 'macro avg': {'precision': 0.33374024614675285, 'recall': 0.3353109973763602, 'f1-score': 0.32755900792979015, 'support': 98419}, 'weighted avg': {'precision': 0.33379360143824205, 'recall': 0.33542303823448727, 'f1-score': 0.32764875559030265, 'support': 98419}}
[[ 6526 13157 13083]
 [ 6847 12970 12640]
 [ 6700 12980 13516]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119751
{'0': {'precision': 0.3376556682500963, 'recall': 0.22881503393074648, 'f1-score': 0.2727791318778198, 'support': 11494}, '1': {'precision': 0.38732848328575376, 'recall': 0.3187571049640015, 'f1-score': 0.34971314542279874, 'support': 13195}, '2': {'precision': 0.29922860730730133, 'recall': 0.46845160082381576, 'f1-score': 0.3651888341543514, 'support': 10682}, 'accuracy': 0.3347374968194283, 'macro avg': {'precision': 0.3414042529477171, 'recall': 0.33867457990618793, 'f1-score': 0.32922703715165663, 'support': 35371}, 'weighted avg': {'precision': 0.34458097229591245, 'recall': 0.3347374968194283, 'f1-score': 0.3293866563595678, 'support': 35371}}
[[2630 3341 5523]
 [2793 4206 6196]
 [2366 3312 5004]]
training model: results/CHTR/W3/deepLOB_L1/h300
Epoch 1/50
385/385 - 10s - loss: 3.3485 - accuracy300: 0.3430 - val_loss: 3.3563 - val_accuracy300: 0.3471 - 10s/epoch - 26ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3174 - accuracy300: 0.3519 - val_loss: 3.3685 - val_accuracy300: 0.3319 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.3020 - accuracy300: 0.3559 - val_loss: 3.3771 - val_accuracy300: 0.3235 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2929 - accuracy300: 0.3647 - val_loss: 3.4486 - val_accuracy300: 0.3103 - 8s/epoch - 20ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2835 - accuracy300: 0.3705 - val_loss: 3.3726 - val_accuracy300: 0.3141 - 8s/epoch - 20ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2739 - accuracy300: 0.3774 - val_loss: 3.3965 - val_accuracy300: 0.3281 - 8s/epoch - 20ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2672 - accuracy300: 0.3854 - val_loss: 3.4045 - val_accuracy300: 0.3198 - 8s/epoch - 20ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2586 - accuracy300: 0.3904 - val_loss: 3.4010 - val_accuracy300: 0.3282 - 8s/epoch - 20ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2546 - accuracy300: 0.3925 - val_loss: 3.4276 - val_accuracy300: 0.3283 - 8s/epoch - 21ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2493 - accuracy300: 0.3949 - val_loss: 3.4675 - val_accuracy300: 0.3271 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2454 - accuracy300: 0.3986 - val_loss: 3.5334 - val_accuracy300: 0.3345 - 8s/epoch - 21ms/step
testing model: results/CHTR/W3/deepLOB_L1/h300
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1299276
{'0': {'precision': 0.2898216290382936, 'recall': 0.21096835701638897, 'f1-score': 0.24418696303302592, 'support': 88108}, '1': {'precision': 0.3755362458413588, 'recall': 0.3100351460503609, 'f1-score': 0.33965663154456416, 'support': 110681}, '2': {'precision': 0.3178267802164696, 'recall': 0.46601878986381656, 'f1-score': 0.3779143677181762, 'support': 92816}, 'accuracy': 0.3297508616107406, 'macro avg': {'precision': 0.327728218365374, 'recall': 0.32900743097685553, 'f1-score': 0.32058598743192207, 'support': 291605}, 'weighted avg': {'precision': 0.33126915433495735, 'recall': 0.3297508616107406, 'f1-score': 0.32298781066520804, 'support': 291605}}
[[18588 29090 40430]
 [23957 34315 52409]
 [21591 27971 43254]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1188871
{'0': {'precision': 0.3305672166357512, 'recall': 0.20827951036476594, 'f1-score': 0.25554716981132075, 'support': 32514}, '1': {'precision': 0.33266198148782994, 'recall': 0.47675489774611557, 'f1-score': 0.3918826825513011, 'support': 32566}, '2': {'precision': 0.34400690956783214, 'recall': 0.32256516392213325, 'f1-score': 0.33294117647058824, 'support': 33339}, 'accuracy': 0.3358294638230423, 'macro avg': {'precision': 0.3357453692304711, 'recall': 0.33586652401100486, 'f1-score': 0.3267903429444034, 'support': 98419}, 'weighted avg': {'precision': 0.33581299270374054, 'recall': 0.3358294638230423, 'f1-score': 0.32687629422737374, 'support': 98419}}
[[ 6772 15646 10096]
 [ 6629 15526 10411]
 [ 7085 15500 10754]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.117793
{'0': {'precision': 0.3225255972696246, 'recall': 0.2540322580645161, 'f1-score': 0.28421052631578947, 'support': 11160}, '1': {'precision': 0.39628074385122974, 'recall': 0.4826125073056692, 'f1-score': 0.43520653534488435, 'support': 13688}, '2': {'precision': 0.2849359297749975, 'recall': 0.26836453482847095, 'f1-score': 0.276402074973084, 'support': 10523}, 'accuracy': 0.34675298973735547, 'macro avg': {'precision': 0.33458075696528394, 'recall': 0.33500310006621875, 'f1-score': 0.3319397122112526, 'support': 35371}, 'weighted avg': {'precision': 0.3398845742666857, 'recall': 0.34675298973735547, 'f1-score': 0.340320476221389, 'support': 35371}}
[[2835 5053 3272]
 [3267 6606 3815]
 [2688 5011 2824]]
training model: results/CHTR/W3/deepLOB_L1/h500
Epoch 1/50
385/385 - 11s - loss: 3.3433 - accuracy500: 0.3486 - val_loss: 3.3714 - val_accuracy500: 0.3272 - 11s/epoch - 27ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3132 - accuracy500: 0.3596 - val_loss: 3.3661 - val_accuracy500: 0.3318 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2974 - accuracy500: 0.3637 - val_loss: 3.3590 - val_accuracy500: 0.3249 - 8s/epoch - 21ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2838 - accuracy500: 0.3751 - val_loss: 3.4487 - val_accuracy500: 0.2978 - 8s/epoch - 21ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2636 - accuracy500: 0.3837 - val_loss: 3.5154 - val_accuracy500: 0.2986 - 8s/epoch - 21ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2544 - accuracy500: 0.3880 - val_loss: 3.5320 - val_accuracy500: 0.2952 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.2406 - accuracy500: 0.3989 - val_loss: 3.5828 - val_accuracy500: 0.2889 - 8s/epoch - 20ms/step
Epoch 8/50
385/385 - 8s - loss: 3.2364 - accuracy500: 0.3994 - val_loss: 3.6757 - val_accuracy500: 0.2880 - 8s/epoch - 20ms/step
Epoch 9/50
385/385 - 7s - loss: 3.2269 - accuracy500: 0.4080 - val_loss: 3.6870 - val_accuracy500: 0.2967 - 7s/epoch - 19ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2179 - accuracy500: 0.4103 - val_loss: 3.6529 - val_accuracy500: 0.2873 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2147 - accuracy500: 0.4110 - val_loss: 3.6916 - val_accuracy500: 0.2968 - 8s/epoch - 20ms/step
Epoch 12/50
385/385 - 8s - loss: 3.2065 - accuracy500: 0.4142 - val_loss: 3.6484 - val_accuracy500: 0.2908 - 8s/epoch - 22ms/step
Epoch 13/50
385/385 - 8s - loss: 3.1991 - accuracy500: 0.4167 - val_loss: 3.6797 - val_accuracy500: 0.2873 - 8s/epoch - 21ms/step
testing model: results/CHTR/W3/deepLOB_L1/h500
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1153436
{'0': {'precision': 0.26056161986501125, 'recall': 0.03727144866385373, 'f1-score': 0.0652144443633406, 'support': 83898}, '1': {'precision': 0.4032976635580959, 'recall': 0.23803202732637774, 'f1-score': 0.2993710156794147, 'support': 118274}, '2': {'precision': 0.3068776007283231, 'recall': 0.7198908680241074, 'f1-score': 0.43031781572703265, 'support': 89433}, 'accuracy': 0.3280533598532261, 'macro avg': {'precision': 0.3235789613838101, 'recall': 0.33173144800477966, 'f1-score': 0.2649677585899293, 'support': 291605}, 'weighted avg': {'precision': 0.3326596289811254, 'recall': 0.3280533598532261, 'f1-score': 0.2721619388404806, 'support': 291605}}
[[ 3127 20530 60241]
 [ 4947 28153 85174]
 [ 3927 21124 64382]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1119505
{'0': {'precision': 0.3463922089420097, 'recall': 0.0487934152272869, 'f1-score': 0.08553782247485787, 'support': 32074}, '1': {'precision': 0.33586897902415486, 'recall': 0.364025103057897, 'f1-score': 0.34938069297429764, 'support': 32506}, '2': {'precision': 0.3501789671041418, 'recall': 0.6071396908892107, 'f1-score': 0.4441729993838437, 'support': 33839}, 'accuracy': 0.34488259380810615, 'macro avg': {'precision': 0.3441467183567688, 'recall': 0.3399860697247982, 'f1-score': 0.2930305049443331, 'support': 98419}, 'weighted avg': {'precision': 0.34421856358632225, 'recall': 0.34488259380810615, 'f1-score': 0.2959883665758745, 'support': 98419}}
[[ 1565 11639 18870]
 [ 1418 11833 19255]
 [ 1535 11759 20545]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1145561
{'0': {'precision': 0.32133115111838517, 'recall': 0.105697622252131, 'f1-score': 0.1590709607723989, 'support': 11145}, '1': {'precision': 0.3894778170396545, 'recall': 0.3603865436314757, 'f1-score': 0.3743678768208922, 'support': 13763}, '2': {'precision': 0.2881391671059568, 'recall': 0.5224123100449202, 'f1-score': 0.3714198348792172, 'support': 10463}, 'accuracy': 0.32806536428147354, 'macro avg': {'precision': 0.3329827117546655, 'recall': 0.32949882530950897, 'f1-score': 0.3016195574908361, 'support': 35371}, 'weighted avg': {'precision': 0.3380288649051707, 'recall': 0.32806536428147354, 'f1-score': 0.30565821375803837, 'support': 35371}}
[[1178 3918 6049]
 [1348 4960 7455]
 [1140 3857 5466]]
training model: results/CHTR/W3/deepLOB_L1/h1000
Epoch 1/50
385/385 - 10s - loss: 3.3313 - accuracy1000: 0.3618 - val_loss: 3.4813 - val_accuracy1000: 0.3164 - 10s/epoch - 25ms/step
Epoch 2/50
385/385 - 8s - loss: 3.2829 - accuracy1000: 0.3883 - val_loss: 3.4624 - val_accuracy1000: 0.3110 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 8s - loss: 3.2498 - accuracy1000: 0.4008 - val_loss: 3.4266 - val_accuracy1000: 0.3335 - 8s/epoch - 20ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2331 - accuracy1000: 0.4086 - val_loss: 3.4609 - val_accuracy1000: 0.3285 - 8s/epoch - 20ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2114 - accuracy1000: 0.4152 - val_loss: 3.5703 - val_accuracy1000: 0.3117 - 8s/epoch - 20ms/step
Epoch 6/50
385/385 - 8s - loss: 3.1930 - accuracy1000: 0.4234 - val_loss: 3.6479 - val_accuracy1000: 0.2962 - 8s/epoch - 21ms/step
Epoch 7/50
385/385 - 8s - loss: 3.1725 - accuracy1000: 0.4343 - val_loss: 3.5972 - val_accuracy1000: 0.2994 - 8s/epoch - 21ms/step
Epoch 8/50
385/385 - 8s - loss: 3.1575 - accuracy1000: 0.4376 - val_loss: 3.6560 - val_accuracy1000: 0.2982 - 8s/epoch - 21ms/step
Epoch 9/50
385/385 - 8s - loss: 3.1482 - accuracy1000: 0.4398 - val_loss: 3.5996 - val_accuracy1000: 0.3012 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 8s - loss: 3.1367 - accuracy1000: 0.4459 - val_loss: 3.6579 - val_accuracy1000: 0.2993 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 8s - loss: 3.1247 - accuracy1000: 0.4526 - val_loss: 3.6771 - val_accuracy1000: 0.2998 - 8s/epoch - 21ms/step
Epoch 12/50
385/385 - 8s - loss: 3.1225 - accuracy1000: 0.4519 - val_loss: 3.5881 - val_accuracy1000: 0.3056 - 8s/epoch - 21ms/step
Epoch 13/50
385/385 - 8s - loss: 3.1226 - accuracy1000: 0.4525 - val_loss: 3.7296 - val_accuracy1000: 0.2997 - 8s/epoch - 21ms/step
testing model: results/CHTR/W3/deepLOB_L1/h1000
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.144862
{'0': {'precision': 0.21881714928885707, 'recall': 0.10377415715342901, 'f1-score': 0.14078225162729077, 'support': 82429}, '1': {'precision': 0.4189550663819971, 'recall': 0.14815586218866614, 'f1-score': 0.2189012623494188, 'support': 115230}, '2': {'precision': 0.32421469182675056, 'recall': 0.730813446022183, 'f1-score': 0.4491642406201956, 'support': 93946}, 'accuracy': 0.32332436000754444, 'macro avg': {'precision': 0.3206623024992016, 'recall': 0.32758115512142605, 'f1-score': 0.2696159181989684, 'support': 291605}, 'weighted avg': {'precision': 0.3318590028850144, 'recall': 0.32332436000754444, 'f1-score': 0.27100261116652447, 'support': 291605}}
[[ 8554 12355 61520]
 [16571 17072 81587]
 [13967 11322 68657]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1531334
{'0': {'precision': 0.3277878125297081, 'recall': 0.1094811710167016, 'f1-score': 0.1641396710541975, 'support': 31494}, '1': {'precision': 0.3148008204685307, 'recall': 0.1803785723122603, 'f1-score': 0.22934444925085531, 'support': 32332}, '2': {'precision': 0.3528987805229625, 'recall': 0.7077154337582748, 'f1-score': 0.4709571306279877, 'support': 34593}, 'accuracy': 0.3430435180198945, 'macro avg': {'precision': 0.3318291378404004, 'recall': 0.3325250590290789, 'f1-score': 0.2881470836443469, 'support': 98419}, 'weighted avg': {'precision': 0.3323475854238511, 'recall': 0.3430435180198945, 'f1-score': 0.29340269209373726, 'support': 98419}}
[[ 3448  6584 21462]
 [ 3070  5832 23430]
 [ 4001  6110 24482]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.138832
{'0': {'precision': 0.3209785632466045, 'recall': 0.33708540986423785, 'f1-score': 0.3288348700754401, 'support': 11638}, '1': {'precision': 0.4064126833885471, 'recall': 0.26213369963369965, 'f1-score': 0.31870476897383565, 'support': 13104}, '2': {'precision': 0.2957066067905015, 'recall': 0.4088813623106595, 'f1-score': 0.3432046118613283, 'support': 10629}, 'accuracy': 0.33089253908569166, 'macro avg': {'precision': 0.341032617808551, 'recall': 0.3360334906028657, 'f1-score': 0.33024808363686803, 'support': 35371}, 'weighted avg': {'precision': 0.3450353635962722, 'recall': 0.33089253908569166, 'f1-score': 0.32940005456575083, 'support': 35371}}
[[3923 2506 5209]
 [4527 3435 5142]
 [3772 2511 4346]]
training model: results/CHTR/W3/deepOF_L1/h10
Epoch 1/50
385/385 - 9s - loss: 3.2792 - accuracy10: 0.3915 - val_loss: 3.2526 - val_accuracy10: 0.4125 - 9s/epoch - 25ms/step
Epoch 2/50
385/385 - 7s - loss: 3.2272 - accuracy10: 0.4221 - val_loss: 3.2250 - val_accuracy10: 0.4225 - 7s/epoch - 18ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2033 - accuracy10: 0.4322 - val_loss: 3.2071 - val_accuracy10: 0.4300 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.1881 - accuracy10: 0.4366 - val_loss: 3.2083 - val_accuracy10: 0.4280 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.1785 - accuracy10: 0.4407 - val_loss: 3.1888 - val_accuracy10: 0.4332 - 7s/epoch - 19ms/step
Epoch 6/50
385/385 - 7s - loss: 3.1659 - accuracy10: 0.4441 - val_loss: 3.1808 - val_accuracy10: 0.4384 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.1606 - accuracy10: 0.4447 - val_loss: 3.1717 - val_accuracy10: 0.4405 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.1542 - accuracy10: 0.4484 - val_loss: 3.1767 - val_accuracy10: 0.4361 - 7s/epoch - 19ms/step
Epoch 9/50
385/385 - 7s - loss: 3.1488 - accuracy10: 0.4505 - val_loss: 3.1661 - val_accuracy10: 0.4421 - 7s/epoch - 18ms/step
Epoch 10/50
385/385 - 7s - loss: 3.1404 - accuracy10: 0.4538 - val_loss: 3.1660 - val_accuracy10: 0.4456 - 7s/epoch - 19ms/step
Epoch 11/50
385/385 - 7s - loss: 3.1386 - accuracy10: 0.4536 - val_loss: 3.1674 - val_accuracy10: 0.4423 - 7s/epoch - 18ms/step
Epoch 12/50
385/385 - 8s - loss: 3.1319 - accuracy10: 0.4555 - val_loss: 3.1603 - val_accuracy10: 0.4453 - 8s/epoch - 20ms/step
Epoch 13/50
385/385 - 7s - loss: 3.1306 - accuracy10: 0.4569 - val_loss: 3.1576 - val_accuracy10: 0.4459 - 7s/epoch - 18ms/step
Epoch 14/50
385/385 - 8s - loss: 3.1237 - accuracy10: 0.4605 - val_loss: 3.1597 - val_accuracy10: 0.4435 - 8s/epoch - 20ms/step
Epoch 15/50
385/385 - 7s - loss: 3.1212 - accuracy10: 0.4604 - val_loss: 3.1582 - val_accuracy10: 0.4473 - 7s/epoch - 19ms/step
Epoch 16/50
385/385 - 7s - loss: 3.1180 - accuracy10: 0.4617 - val_loss: 3.1584 - val_accuracy10: 0.4481 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 7s - loss: 3.1133 - accuracy10: 0.4622 - val_loss: 3.1605 - val_accuracy10: 0.4442 - 7s/epoch - 19ms/step
Epoch 18/50
385/385 - 7s - loss: 3.1093 - accuracy10: 0.4646 - val_loss: 3.1546 - val_accuracy10: 0.4476 - 7s/epoch - 19ms/step
Epoch 19/50
385/385 - 7s - loss: 3.1075 - accuracy10: 0.4661 - val_loss: 3.1589 - val_accuracy10: 0.4456 - 7s/epoch - 19ms/step
Epoch 20/50
385/385 - 7s - loss: 3.1041 - accuracy10: 0.4663 - val_loss: 3.1581 - val_accuracy10: 0.4482 - 7s/epoch - 19ms/step
Epoch 21/50
385/385 - 7s - loss: 3.1015 - accuracy10: 0.4676 - val_loss: 3.1614 - val_accuracy10: 0.4477 - 7s/epoch - 19ms/step
Epoch 22/50
385/385 - 7s - loss: 3.0971 - accuracy10: 0.4701 - val_loss: 3.1592 - val_accuracy10: 0.4496 - 7s/epoch - 19ms/step
Epoch 23/50
385/385 - 8s - loss: 3.0923 - accuracy10: 0.4710 - val_loss: 3.1609 - val_accuracy10: 0.4462 - 8s/epoch - 20ms/step
Epoch 24/50
385/385 - 7s - loss: 3.0907 - accuracy10: 0.4709 - val_loss: 3.1629 - val_accuracy10: 0.4481 - 7s/epoch - 19ms/step
Epoch 25/50
385/385 - 7s - loss: 3.0873 - accuracy10: 0.4729 - val_loss: 3.1645 - val_accuracy10: 0.4460 - 7s/epoch - 19ms/step
Epoch 26/50
385/385 - 7s - loss: 3.0834 - accuracy10: 0.4732 - val_loss: 3.1653 - val_accuracy10: 0.4467 - 7s/epoch - 19ms/step
Epoch 27/50
385/385 - 8s - loss: 3.0828 - accuracy10: 0.4752 - val_loss: 3.1632 - val_accuracy10: 0.4468 - 8s/epoch - 20ms/step
Epoch 28/50
385/385 - 8s - loss: 3.0776 - accuracy10: 0.4757 - val_loss: 3.1621 - val_accuracy10: 0.4482 - 8s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h10
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0670415
{'0': {'precision': 0.4268935349429959, 'recall': 0.48044346241811065, 'f1-score': 0.45208827284333397, 'support': 103188}, '1': {'precision': 0.422184018162968, 'recall': 0.3427810335641982, 'f1-score': 0.37836153108809817, 'support': 93850}, '2': {'precision': 0.4370806890299184, 'recall': 0.45883696583230227, 'f1-score': 0.44769466499512467, 'support': 94563}, 'accuracy': 0.4291309014715313, 'macro avg': {'precision': 0.4287194140452941, 'recall': 0.42735382060487037, 'f1-score': 0.4260481563088523, 'support': 291601}, 'weighted avg': {'precision': 0.42868138787256765, 'recall': 0.4291309014715313, 'f1-score': 0.42693497277687636, 'support': 291601}}
[[49576 24531 29081]
 [34880 32170 26800]
 [31676 19498 43389]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0414368
{'0': {'precision': 0.45341496684960186, 'recall': 0.4311353764478765, 'f1-score': 0.4419945883262466, 'support': 33152}, '1': {'precision': 0.4661262824155774, 'recall': 0.48017254660298875, 'f1-score': 0.47304516755706655, 'support': 32455}, '2': {'precision': 0.4557109557109557, 'recall': 0.4647526744079729, 'f1-score': 0.4601874066361867, 'support': 32811}, 'accuracy': 0.4585136865207584, 'macro avg': {'precision': 0.4584174016587117, 'recall': 0.45868686581961265, 'f1-score': 0.45840905417316663, 'support': 98418}, 'weighted avg': {'precision': 0.4583721844035413, 'recall': 0.4585136865207584, 'f1-score': 0.4582992390050219, 'support': 98418}}
[[14293  9233  9626]
 [ 8284 15584  8587]
 [ 8946  8616 15249]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0522571
{'0': {'precision': 0.44885777450257924, 'recall': 0.4824936628643853, 'f1-score': 0.4650683362602123, 'support': 12624}, '1': {'precision': 0.45147679324894513, 'recall': 0.42266502808988765, 'f1-score': 0.43659609194360066, 'support': 11392}, '2': {'precision': 0.44405531609195403, 'recall': 0.43549097313958607, 'f1-score': 0.43973144813480947, 'support': 11355}, 'accuracy': 0.44813547821661814, 'macro avg': {'precision': 0.4481299612811595, 'recall': 0.44688322136461966, 'f1-score': 0.4471319587795408, 'support': 35371}, 'weighted avg': {'precision': 0.4481595738949049, 'recall': 0.44813547821661814, 'f1-score': 0.4477644383800622, 'support': 35371}}
[[6091 3123 3410]
 [3796 4815 2781]
 [3683 2727 4945]]
training model: results/CHTR/W3/deepOF_L1/h20
Epoch 1/50
385/385 - 10s - loss: 3.2873 - accuracy20: 0.3855 - val_loss: 3.2670 - val_accuracy20: 0.4027 - 10s/epoch - 25ms/step
Epoch 2/50
385/385 - 7s - loss: 3.2392 - accuracy20: 0.4147 - val_loss: 3.2409 - val_accuracy20: 0.4131 - 7s/epoch - 19ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2175 - accuracy20: 0.4248 - val_loss: 3.2209 - val_accuracy20: 0.4249 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.2031 - accuracy20: 0.4301 - val_loss: 3.2220 - val_accuracy20: 0.4215 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.1925 - accuracy20: 0.4370 - val_loss: 3.2163 - val_accuracy20: 0.4237 - 7s/epoch - 19ms/step
Epoch 6/50
385/385 - 7s - loss: 3.1841 - accuracy20: 0.4387 - val_loss: 3.2057 - val_accuracy20: 0.4312 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.1780 - accuracy20: 0.4409 - val_loss: 3.1911 - val_accuracy20: 0.4369 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.1700 - accuracy20: 0.4441 - val_loss: 3.1927 - val_accuracy20: 0.4366 - 7s/epoch - 18ms/step
Epoch 9/50
385/385 - 8s - loss: 3.1676 - accuracy20: 0.4448 - val_loss: 3.1956 - val_accuracy20: 0.4361 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 7s - loss: 3.1605 - accuracy20: 0.4461 - val_loss: 3.1851 - val_accuracy20: 0.4427 - 7s/epoch - 19ms/step
Epoch 11/50
385/385 - 7s - loss: 3.1568 - accuracy20: 0.4497 - val_loss: 3.1962 - val_accuracy20: 0.4337 - 7s/epoch - 19ms/step
Epoch 12/50
385/385 - 7s - loss: 3.1519 - accuracy20: 0.4513 - val_loss: 3.1792 - val_accuracy20: 0.4450 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 7s - loss: 3.1474 - accuracy20: 0.4540 - val_loss: 3.1755 - val_accuracy20: 0.4453 - 7s/epoch - 19ms/step
Epoch 14/50
385/385 - 7s - loss: 3.1467 - accuracy20: 0.4549 - val_loss: 3.1775 - val_accuracy20: 0.4472 - 7s/epoch - 19ms/step
Epoch 15/50
385/385 - 8s - loss: 3.1431 - accuracy20: 0.4558 - val_loss: 3.1766 - val_accuracy20: 0.4466 - 8s/epoch - 20ms/step
Epoch 16/50
385/385 - 8s - loss: 3.1380 - accuracy20: 0.4578 - val_loss: 3.1753 - val_accuracy20: 0.4481 - 8s/epoch - 20ms/step
Epoch 17/50
385/385 - 7s - loss: 3.1330 - accuracy20: 0.4582 - val_loss: 3.1753 - val_accuracy20: 0.4467 - 7s/epoch - 19ms/step
Epoch 18/50
385/385 - 8s - loss: 3.1306 - accuracy20: 0.4609 - val_loss: 3.1755 - val_accuracy20: 0.4457 - 8s/epoch - 20ms/step
Epoch 19/50
385/385 - 7s - loss: 3.1268 - accuracy20: 0.4614 - val_loss: 3.1856 - val_accuracy20: 0.4415 - 7s/epoch - 19ms/step
Epoch 20/50
385/385 - 7s - loss: 3.1224 - accuracy20: 0.4634 - val_loss: 3.1740 - val_accuracy20: 0.4486 - 7s/epoch - 19ms/step
Epoch 21/50
385/385 - 7s - loss: 3.1178 - accuracy20: 0.4650 - val_loss: 3.1768 - val_accuracy20: 0.4472 - 7s/epoch - 19ms/step
Epoch 22/50
385/385 - 7s - loss: 3.1151 - accuracy20: 0.4652 - val_loss: 3.1794 - val_accuracy20: 0.4472 - 7s/epoch - 19ms/step
Epoch 23/50
385/385 - 7s - loss: 3.1108 - accuracy20: 0.4670 - val_loss: 3.1839 - val_accuracy20: 0.4459 - 7s/epoch - 18ms/step
Epoch 24/50
385/385 - 7s - loss: 3.1088 - accuracy20: 0.4685 - val_loss: 3.1788 - val_accuracy20: 0.4488 - 7s/epoch - 19ms/step
Epoch 25/50
385/385 - 7s - loss: 3.1046 - accuracy20: 0.4698 - val_loss: 3.1768 - val_accuracy20: 0.4481 - 7s/epoch - 18ms/step
Epoch 26/50
385/385 - 8s - loss: 3.0999 - accuracy20: 0.4717 - val_loss: 3.1738 - val_accuracy20: 0.4486 - 8s/epoch - 19ms/step
Epoch 27/50
385/385 - 7s - loss: 3.0990 - accuracy20: 0.4719 - val_loss: 3.1768 - val_accuracy20: 0.4466 - 7s/epoch - 19ms/step
Epoch 28/50
385/385 - 7s - loss: 3.0952 - accuracy20: 0.4735 - val_loss: 3.1809 - val_accuracy20: 0.4473 - 7s/epoch - 19ms/step
Epoch 29/50
385/385 - 7s - loss: 3.0893 - accuracy20: 0.4745 - val_loss: 3.1842 - val_accuracy20: 0.4442 - 7s/epoch - 19ms/step
Epoch 30/50
385/385 - 7s - loss: 3.0870 - accuracy20: 0.4768 - val_loss: 3.1801 - val_accuracy20: 0.4462 - 7s/epoch - 19ms/step
Epoch 31/50
385/385 - 7s - loss: 3.0836 - accuracy20: 0.4787 - val_loss: 3.1867 - val_accuracy20: 0.4437 - 7s/epoch - 19ms/step
Epoch 32/50
385/385 - 7s - loss: 3.0784 - accuracy20: 0.4784 - val_loss: 3.1897 - val_accuracy20: 0.4424 - 7s/epoch - 19ms/step
Epoch 33/50
385/385 - 7s - loss: 3.0721 - accuracy20: 0.4811 - val_loss: 3.1894 - val_accuracy20: 0.4487 - 7s/epoch - 18ms/step
Epoch 34/50
385/385 - 7s - loss: 3.0725 - accuracy20: 0.4803 - val_loss: 3.1898 - val_accuracy20: 0.4456 - 7s/epoch - 19ms/step
Epoch 35/50
385/385 - 7s - loss: 3.0691 - accuracy20: 0.4809 - val_loss: 3.1923 - val_accuracy20: 0.4441 - 7s/epoch - 19ms/step
Epoch 36/50
385/385 - 7s - loss: 3.0641 - accuracy20: 0.4837 - val_loss: 3.1968 - val_accuracy20: 0.4395 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h20
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0700135
{'0': {'precision': 0.42281999106655416, 'recall': 0.43239978479997565, 'f1-score': 0.4275562336267552, 'support': 98513}, '1': {'precision': 0.45725807507495714, 'recall': 0.35765929992011963, 'f1-score': 0.4013722324060613, 'support': 97646}, '2': {'precision': 0.43635950698381365, 'recall': 0.5233964082898515, 'f1-score': 0.4759314218205897, 'support': 95442}, 'accuracy': 0.43715556531013267, 'macro avg': {'precision': 0.43881252437510837, 'recall': 0.4378184976699822, 'f1-score': 0.43495329595113535, 'support': 291601}, 'weighted avg': {'precision': 0.43878351529747106, 'recall': 0.43715556531013267, 'f1-score': 0.434621578836134, 'support': 291601}}
[[42597 23714 32202]
 [30399 34924 32323]
 [27749 17739 49954]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0451218
{'0': {'precision': 0.46753079669357694, 'recall': 0.432825154835636, 'f1-score': 0.4495090838809431, 'support': 33584}, '1': {'precision': 0.4839281672074247, 'recall': 0.39589506172839506, 'f1-score': 0.43550741859912406, 'support': 32400}, '2': {'precision': 0.43769138433649346, 'recall': 0.5508725411605105, 'f1-score': 0.4878028803494642, 'support': 32434}, 'accuracy': 0.45957040378792496, 'macro avg': {'precision': 0.4630501160791651, 'recall': 0.45986425257484714, 'f1-score': 0.45760646094317714, 'support': 98418}, 'weighted avg': {'precision': 0.4630952595383719, 'recall': 0.45957040378792496, 'f1-score': 0.4575194787226293, 'support': 98418}}
[[14536  7442 11606]
 [ 8225 12827 11348]
 [ 8330  6237 17867]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0594796
{'0': {'precision': 0.4465014119861939, 'recall': 0.458699331130631, 'f1-score': 0.45251818579321856, 'support': 12409}, '1': {'precision': 0.47531585093959017, 'recall': 0.38160586430276167, 'f1-score': 0.4233369580634485, 'support': 11732}, '2': {'precision': 0.4287337170554377, 'recall': 0.5040961709706144, 'f1-score': 0.46337071294098386, 'support': 11230}, 'accuracy': 0.44754177150773233, 'macro avg': {'precision': 0.4501836599937406, 'recall': 0.4481337888013357, 'f1-score': 0.4464086189325503, 'support': 35371}, 'weighted avg': {'precision': 0.45041760841063355, 'recall': 0.44754177150773233, 'f1-score': 0.4462848227597658, 'support': 35371}}
[[5692 2755 3962]
 [3674 4477 3581]
 [3382 2187 5661]]
training model: results/CHTR/W3/deepOF_L1/h30
Epoch 1/50
385/385 - 9s - loss: 3.2938 - accuracy30: 0.3806 - val_loss: 3.2736 - val_accuracy30: 0.4002 - 9s/epoch - 24ms/step
Epoch 2/50
385/385 - 8s - loss: 3.2483 - accuracy30: 0.4075 - val_loss: 3.2473 - val_accuracy30: 0.4117 - 8s/epoch - 21ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2280 - accuracy30: 0.4187 - val_loss: 3.2286 - val_accuracy30: 0.4183 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.2180 - accuracy30: 0.4244 - val_loss: 3.2261 - val_accuracy30: 0.4229 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.2093 - accuracy30: 0.4277 - val_loss: 3.2202 - val_accuracy30: 0.4225 - 7s/epoch - 18ms/step
Epoch 6/50
385/385 - 7s - loss: 3.2027 - accuracy30: 0.4291 - val_loss: 3.2106 - val_accuracy30: 0.4296 - 7s/epoch - 18ms/step
Epoch 7/50
385/385 - 7s - loss: 3.1972 - accuracy30: 0.4325 - val_loss: 3.2082 - val_accuracy30: 0.4311 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 8s - loss: 3.1914 - accuracy30: 0.4362 - val_loss: 3.2065 - val_accuracy30: 0.4334 - 8s/epoch - 20ms/step
Epoch 9/50
385/385 - 8s - loss: 3.1875 - accuracy30: 0.4367 - val_loss: 3.2042 - val_accuracy30: 0.4334 - 8s/epoch - 21ms/step
Epoch 10/50
385/385 - 8s - loss: 3.1842 - accuracy30: 0.4377 - val_loss: 3.2137 - val_accuracy30: 0.4272 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 7s - loss: 3.1795 - accuracy30: 0.4418 - val_loss: 3.2045 - val_accuracy30: 0.4324 - 7s/epoch - 18ms/step
Epoch 12/50
385/385 - 7s - loss: 3.1756 - accuracy30: 0.4434 - val_loss: 3.1995 - val_accuracy30: 0.4352 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 7s - loss: 3.1708 - accuracy30: 0.4435 - val_loss: 3.2054 - val_accuracy30: 0.4299 - 7s/epoch - 19ms/step
Epoch 14/50
385/385 - 7s - loss: 3.1677 - accuracy30: 0.4455 - val_loss: 3.2123 - val_accuracy30: 0.4267 - 7s/epoch - 18ms/step
Epoch 15/50
385/385 - 7s - loss: 3.1657 - accuracy30: 0.4474 - val_loss: 3.1980 - val_accuracy30: 0.4346 - 7s/epoch - 19ms/step
Epoch 16/50
385/385 - 7s - loss: 3.1615 - accuracy30: 0.4483 - val_loss: 3.1980 - val_accuracy30: 0.4350 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 8s - loss: 3.1576 - accuracy30: 0.4497 - val_loss: 3.1937 - val_accuracy30: 0.4357 - 8s/epoch - 20ms/step
Epoch 18/50
385/385 - 8s - loss: 3.1538 - accuracy30: 0.4522 - val_loss: 3.1992 - val_accuracy30: 0.4351 - 8s/epoch - 20ms/step
Epoch 19/50
385/385 - 7s - loss: 3.1533 - accuracy30: 0.4517 - val_loss: 3.1975 - val_accuracy30: 0.4368 - 7s/epoch - 19ms/step
Epoch 20/50
385/385 - 7s - loss: 3.1472 - accuracy30: 0.4551 - val_loss: 3.2080 - val_accuracy30: 0.4303 - 7s/epoch - 19ms/step
Epoch 21/50
385/385 - 7s - loss: 3.1438 - accuracy30: 0.4565 - val_loss: 3.2025 - val_accuracy30: 0.4363 - 7s/epoch - 19ms/step
Epoch 22/50
385/385 - 7s - loss: 3.1410 - accuracy30: 0.4562 - val_loss: 3.2012 - val_accuracy30: 0.4354 - 7s/epoch - 19ms/step
Epoch 23/50
385/385 - 7s - loss: 3.1367 - accuracy30: 0.4583 - val_loss: 3.2159 - val_accuracy30: 0.4277 - 7s/epoch - 18ms/step
Epoch 24/50
385/385 - 7s - loss: 3.1344 - accuracy30: 0.4591 - val_loss: 3.2047 - val_accuracy30: 0.4350 - 7s/epoch - 19ms/step
Epoch 25/50
385/385 - 7s - loss: 3.1299 - accuracy30: 0.4615 - val_loss: 3.2047 - val_accuracy30: 0.4348 - 7s/epoch - 19ms/step
Epoch 26/50
385/385 - 7s - loss: 3.1262 - accuracy30: 0.4619 - val_loss: 3.2077 - val_accuracy30: 0.4351 - 7s/epoch - 19ms/step
Epoch 27/50
385/385 - 7s - loss: 3.1241 - accuracy30: 0.4640 - val_loss: 3.2107 - val_accuracy30: 0.4318 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h30
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0681168
{'0': {'precision': 0.4228718790836446, 'recall': 0.380078786807887, 'f1-score': 0.40033500837520936, 'support': 96209}, '1': {'precision': 0.4411473224964972, 'recall': 0.3895723727227917, 'f1-score': 0.41375884100087607, 'support': 99409}, '2': {'precision': 0.43549995312806267, 'recall': 0.5324067803673567, 'f1-score': 0.4791022107217191, 'support': 95983}, 'accuracy': 0.43345530365122203, 'macro avg': {'precision': 0.4331730515694015, 'recall': 0.4340193132993451, 'f1-score': 0.4310653533659348, 'support': 291601}, 'weighted avg': {'precision': 0.43325875699295785, 'recall': 0.43345530365122203, 'f1-score': 0.43083820335845685, 'support': 291601}}
[[36567 27425 32217]
 [26660 38727 34022]
 [23246 21635 51102]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0595151
{'0': {'precision': 0.47303820678816, 'recall': 0.3741047647232909, 'f1-score': 0.41779452349082014, 'support': 33790}, '1': {'precision': 0.4421673424253594, 'recall': 0.3715197125956208, 'f1-score': 0.4037765697840758, 'support': 32289}, '2': {'precision': 0.4193874116459105, 'recall': 0.5779399486687901, 'f1-score': 0.48606054301466767, 'support': 32339}, 'accuracy': 0.44023450994736735, 'macro avg': {'precision': 0.4448643202864766, 'recall': 0.44118814199590056, 'f1-score': 0.43587721209652114, 'support': 98418}, 'weighted avg': {'precision': 0.4452810647662161, 'recall': 0.44023450994736735, 'f1-score': 0.43562692303302414, 'support': 98418}}
[[12641  8355 12794]
 [ 7212 11996 13081]
 [ 6870  6779 18690]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0656383
{'0': {'precision': 0.445460138876681, 'recall': 0.4102979274611399, 'f1-score': 0.4271566437692276, 'support': 12352}, '1': {'precision': 0.4526326489123806, 'recall': 0.37581230483585115, 'f1-score': 0.41066076451330297, 'support': 11849}, '2': {'precision': 0.41318168974286523, 'recall': 0.5236347358997314, 'f1-score': 0.4618968648819396, 'support': 11170}, 'accuracy': 0.43453676740832886, 'macro avg': {'precision': 0.43709149251064233, 'recall': 0.4365816560655742, 'f1-score': 0.4332380910548233, 'support': 35371}, 'weighted avg': {'precision': 0.4376694853635851, 'recall': 0.43453676740832886, 'f1-score': 0.4326014600459951, 'support': 35371}}
[[5068 3011 4273]
 [3362 4453 4034]
 [2947 2374 5849]]
training model: results/CHTR/W3/deepOF_L1/h50
Epoch 1/50
385/385 - 9s - loss: 3.3048 - accuracy50: 0.3717 - val_loss: 3.3006 - val_accuracy50: 0.3798 - 9s/epoch - 23ms/step
Epoch 2/50
385/385 - 7s - loss: 3.2640 - accuracy50: 0.3960 - val_loss: 3.2764 - val_accuracy50: 0.3925 - 7s/epoch - 19ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2451 - accuracy50: 0.4099 - val_loss: 3.2674 - val_accuracy50: 0.3991 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 8s - loss: 3.2364 - accuracy50: 0.4149 - val_loss: 3.2635 - val_accuracy50: 0.4004 - 8s/epoch - 19ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2265 - accuracy50: 0.4203 - val_loss: 3.2561 - val_accuracy50: 0.4031 - 8s/epoch - 20ms/step
Epoch 6/50
385/385 - 7s - loss: 3.2220 - accuracy50: 0.4220 - val_loss: 3.2580 - val_accuracy50: 0.4030 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2188 - accuracy50: 0.4230 - val_loss: 3.2487 - val_accuracy50: 0.4094 - 7s/epoch - 18ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2137 - accuracy50: 0.4242 - val_loss: 3.2442 - val_accuracy50: 0.4131 - 7s/epoch - 18ms/step
Epoch 9/50
385/385 - 7s - loss: 3.2104 - accuracy50: 0.4259 - val_loss: 3.2394 - val_accuracy50: 0.4149 - 7s/epoch - 19ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2062 - accuracy50: 0.4301 - val_loss: 3.2400 - val_accuracy50: 0.4154 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 7s - loss: 3.2020 - accuracy50: 0.4318 - val_loss: 3.2367 - val_accuracy50: 0.4182 - 7s/epoch - 19ms/step
Epoch 12/50
385/385 - 7s - loss: 3.1985 - accuracy50: 0.4330 - val_loss: 3.2383 - val_accuracy50: 0.4200 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 8s - loss: 3.1954 - accuracy50: 0.4342 - val_loss: 3.2430 - val_accuracy50: 0.4138 - 8s/epoch - 20ms/step
Epoch 14/50
385/385 - 7s - loss: 3.1918 - accuracy50: 0.4356 - val_loss: 3.2376 - val_accuracy50: 0.4211 - 7s/epoch - 19ms/step
Epoch 15/50
385/385 - 7s - loss: 3.1906 - accuracy50: 0.4364 - val_loss: 3.2373 - val_accuracy50: 0.4194 - 7s/epoch - 19ms/step
Epoch 16/50
385/385 - 7s - loss: 3.1859 - accuracy50: 0.4374 - val_loss: 3.2366 - val_accuracy50: 0.4197 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 7s - loss: 3.1812 - accuracy50: 0.4405 - val_loss: 3.2394 - val_accuracy50: 0.4192 - 7s/epoch - 19ms/step
Epoch 18/50
385/385 - 8s - loss: 3.1765 - accuracy50: 0.4417 - val_loss: 3.2398 - val_accuracy50: 0.4186 - 8s/epoch - 20ms/step
Epoch 19/50
385/385 - 7s - loss: 3.1747 - accuracy50: 0.4429 - val_loss: 3.2408 - val_accuracy50: 0.4213 - 7s/epoch - 19ms/step
Epoch 20/50
385/385 - 7s - loss: 3.1696 - accuracy50: 0.4455 - val_loss: 3.2416 - val_accuracy50: 0.4193 - 7s/epoch - 19ms/step
Epoch 21/50
385/385 - 7s - loss: 3.1672 - accuracy50: 0.4458 - val_loss: 3.2451 - val_accuracy50: 0.4168 - 7s/epoch - 19ms/step
Epoch 22/50
385/385 - 7s - loss: 3.1636 - accuracy50: 0.4489 - val_loss: 3.2479 - val_accuracy50: 0.4149 - 7s/epoch - 19ms/step
Epoch 23/50
385/385 - 7s - loss: 3.1609 - accuracy50: 0.4475 - val_loss: 3.2527 - val_accuracy50: 0.4149 - 7s/epoch - 19ms/step
Epoch 24/50
385/385 - 7s - loss: 3.1572 - accuracy50: 0.4507 - val_loss: 3.2470 - val_accuracy50: 0.4204 - 7s/epoch - 19ms/step
Epoch 25/50
385/385 - 7s - loss: 3.1539 - accuracy50: 0.4524 - val_loss: 3.2583 - val_accuracy50: 0.4126 - 7s/epoch - 18ms/step
Epoch 26/50
385/385 - 7s - loss: 3.1480 - accuracy50: 0.4537 - val_loss: 3.2525 - val_accuracy50: 0.4179 - 7s/epoch - 18ms/step
testing model: results/CHTR/W3/deepOF_L1/h50
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0777208
{'0': {'precision': 0.40446142226989634, 'recall': 0.392571817100119, 'f1-score': 0.39842793912307467, 'support': 94128}, '1': {'precision': 0.4408519873676595, 'recall': 0.3130173657071735, 'f1-score': 0.3660961337392339, 'support': 101234}, '2': {'precision': 0.4204626015690124, 'recall': 0.5608017539666871, 'f1-score': 0.48059661620658944, 'support': 96239}, 'accuracy': 0.42047523842510826, 'macro avg': {'precision': 0.4219253370688561, 'recall': 0.4221303122579932, 'f1-score': 0.41504022968963267, 'support': 291601}, 'weighted avg': {'precision': 0.42237596975661484, 'recall': 0.42047523842510826, 'f1-score': 0.4143221004174894, 'support': 291601}}
[[36952 22304 34872]
 [30028 31688 39518]
 [24381 17887 53971]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0686656
{'0': {'precision': 0.46179401993355484, 'recall': 0.3683270312918689, 'f1-score': 0.40979859546839803, 'support': 33587}, '1': {'precision': 0.43671962500518524, 'recall': 0.32356014506115927, 'f1-score': 0.3717185982875805, 'support': 32538}, '2': {'precision': 0.4097260216320862, 'recall': 0.6029480073080854, 'f1-score': 0.48790327632650504, 'support': 32293}, 'accuracy': 0.43051067894084416, 'macro avg': {'precision': 0.4360798888569421, 'recall': 0.4316117278870378, 'f1-score': 0.4231401566941612, 'support': 98418}, 'weighted avg': {'precision': 0.43641957083553806, 'recall': 0.43051067894084416, 'f1-score': 0.42283673392560517, 'support': 98418}}
[[12371  7409 13807]
 [ 7766 10528 14244]
 [ 6652  6170 19471]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.080935
{'0': {'precision': 0.43101343101343104, 'recall': 0.4079577348522371, 'f1-score': 0.41916878710771843, 'support': 12114}, '1': {'precision': 0.4411294010059442, 'recall': 0.3159747809710964, 'f1-score': 0.36820762368207627, 'support': 12213}, '2': {'precision': 0.3938774163752721, 'recall': 0.5405650126765664, 'f1-score': 0.4557077974123125, 'support': 11044}, 'accuracy': 0.41760199033106216, 'macro avg': {'precision': 0.4220067494648825, 'recall': 0.4214991761666333, 'f1-score': 0.4143614027340357, 'support': 35371}, 'weighted avg': {'precision': 0.4229112059096663, 'recall': 0.41760199033106216, 'f1-score': 0.41298146248830053, 'support': 35371}}
[[4942 2739 4433]
 [3600 3859 4754]
 [2924 2150 5970]]
training model: results/CHTR/W3/deepOF_L1/h100
Epoch 1/50
385/385 - 10s - loss: 3.3238 - accuracy100: 0.3574 - val_loss: 3.3324 - val_accuracy100: 0.3535 - 10s/epoch - 25ms/step
Epoch 2/50
385/385 - 7s - loss: 3.2863 - accuracy100: 0.3785 - val_loss: 3.3118 - val_accuracy100: 0.3658 - 7s/epoch - 18ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2772 - accuracy100: 0.3853 - val_loss: 3.2962 - val_accuracy100: 0.3727 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.2665 - accuracy100: 0.3917 - val_loss: 3.2967 - val_accuracy100: 0.3718 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.2614 - accuracy100: 0.3939 - val_loss: 3.2968 - val_accuracy100: 0.3666 - 7s/epoch - 18ms/step
Epoch 6/50
385/385 - 7s - loss: 3.2571 - accuracy100: 0.3982 - val_loss: 3.2939 - val_accuracy100: 0.3713 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2525 - accuracy100: 0.4013 - val_loss: 3.2874 - val_accuracy100: 0.3773 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2489 - accuracy100: 0.4029 - val_loss: 3.2881 - val_accuracy100: 0.3751 - 7s/epoch - 19ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2453 - accuracy100: 0.4049 - val_loss: 3.2819 - val_accuracy100: 0.3821 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 7s - loss: 3.2423 - accuracy100: 0.4063 - val_loss: 3.2806 - val_accuracy100: 0.3825 - 7s/epoch - 19ms/step
Epoch 11/50
385/385 - 7s - loss: 3.2397 - accuracy100: 0.4081 - val_loss: 3.2799 - val_accuracy100: 0.3869 - 7s/epoch - 18ms/step
Epoch 12/50
385/385 - 7s - loss: 3.2369 - accuracy100: 0.4108 - val_loss: 3.2832 - val_accuracy100: 0.3804 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 7s - loss: 3.2352 - accuracy100: 0.4106 - val_loss: 3.2833 - val_accuracy100: 0.3803 - 7s/epoch - 18ms/step
Epoch 14/50
385/385 - 7s - loss: 3.2330 - accuracy100: 0.4114 - val_loss: 3.2833 - val_accuracy100: 0.3820 - 7s/epoch - 19ms/step
Epoch 15/50
385/385 - 7s - loss: 3.2303 - accuracy100: 0.4132 - val_loss: 3.2838 - val_accuracy100: 0.3818 - 7s/epoch - 19ms/step
Epoch 16/50
385/385 - 7s - loss: 3.2278 - accuracy100: 0.4163 - val_loss: 3.2862 - val_accuracy100: 0.3800 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 8s - loss: 3.2238 - accuracy100: 0.4182 - val_loss: 3.2935 - val_accuracy100: 0.3771 - 8s/epoch - 20ms/step
Epoch 18/50
385/385 - 8s - loss: 3.2225 - accuracy100: 0.4176 - val_loss: 3.2890 - val_accuracy100: 0.3814 - 8s/epoch - 20ms/step
Epoch 19/50
385/385 - 8s - loss: 3.2188 - accuracy100: 0.4205 - val_loss: 3.2899 - val_accuracy100: 0.3804 - 8s/epoch - 20ms/step
Epoch 20/50
385/385 - 7s - loss: 3.2178 - accuracy100: 0.4210 - val_loss: 3.2878 - val_accuracy100: 0.3827 - 7s/epoch - 18ms/step
Epoch 21/50
385/385 - 7s - loss: 3.2144 - accuracy100: 0.4234 - val_loss: 3.2934 - val_accuracy100: 0.3815 - 7s/epoch - 18ms/step
testing model: results/CHTR/W3/deepOF_L1/h100
Evaluating performance on  test set...
1140/1140 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0968871
{'0': {'precision': 0.36698966712137604, 'recall': 0.5012367358739065, 'f1-score': 0.42373441354183167, 'support': 93391}, '1': {'precision': 0.40778588807785887, 'recall': 0.10648342733146314, 'f1-score': 0.16887042519880333, 'support': 102307}, '2': {'precision': 0.38136778026971135, 'recall': 0.5461143029936498, 'f1-score': 0.44910926747700813, 'support': 95903}, 'accuracy': 0.37749870542282093, 'macro avg': {'precision': 0.3853811118229821, 'recall': 0.3846114887330065, 'f1-score': 0.34723803540588105, 'support': 291601}, 'weighted avg': {'precision': 0.38603158797438986, 'recall': 0.37749870542282093, 'f1-score': 0.3426618334119111, 'support': 291601}}
[[46811  8546 38034]
 [44489 10894 46924]
 [36254  7275 52374]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.083719
{'0': {'precision': 0.418515139419513, 'recall': 0.44028194361127776, 'f1-score': 0.4291226941854007, 'support': 33340}, '1': {'precision': 0.4126047068209015, 'recall': 0.15910908755306713, 'f1-score': 0.22965742323660665, 'support': 32506}, '2': {'precision': 0.3886516168395363, 'recall': 0.6062569077735478, 'f1-score': 0.4736570681570142, 'support': 32572}, 'accuracy': 0.40234509947367353, 'macro avg': {'precision': 0.406590487693317, 'recall': 0.4018826463126309, 'f1-score': 0.3774790618596739, 'support': 98418}, 'weighted avg': {'precision': 0.40667950793416013, 'recall': 0.40234509947367353, 'f1-score': 0.3779811909191475, 'support': 98418}}
[[14679  3778 14883]
 [11155  5172 16179]
 [ 9240  3585 19747]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0931424
{'0': {'precision': 0.3768952099825574, 'recall': 0.48045839391088685, 'f1-score': 0.4224218955599835, 'support': 11693}, '1': {'precision': 0.4794847328244275, 'recall': 0.15724008448720958, 'f1-score': 0.23681885125184096, 'support': 12783}, '2': {'precision': 0.36797148651139927, 'recall': 0.5496099128040386, 'f1-score': 0.4408127208480566, 'support': 10895}, 'accuracy': 0.3849481213423426, 'macro avg': {'precision': 0.40811714310612807, 'recall': 0.395769463734045, 'f1-score': 0.36668448921996033, 'support': 35371}, 'weighted avg': {'precision': 0.4112221417421728, 'recall': 0.3849481213423426, 'f1-score': 0.36101012676980426, 'support': 35371}}
[[5618 1196 4879]
 [5367 2010 5406]
 [3921  986 5988]]
training model: results/CHTR/W3/deepOF_L1/h200
Epoch 1/50
385/385 - 10s - loss: 3.3340 - accuracy200: 0.3461 - val_loss: 3.3451 - val_accuracy200: 0.3486 - 10s/epoch - 25ms/step
Epoch 2/50
385/385 - 7s - loss: 3.3029 - accuracy200: 0.3599 - val_loss: 3.3313 - val_accuracy200: 0.3534 - 7s/epoch - 19ms/step
Epoch 3/50
385/385 - 7s - loss: 3.2930 - accuracy200: 0.3667 - val_loss: 3.3222 - val_accuracy200: 0.3501 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.2863 - accuracy200: 0.3707 - val_loss: 3.3160 - val_accuracy200: 0.3499 - 7s/epoch - 18ms/step
Epoch 5/50
385/385 - 8s - loss: 3.2817 - accuracy200: 0.3757 - val_loss: 3.3161 - val_accuracy200: 0.3469 - 8s/epoch - 20ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2761 - accuracy200: 0.3773 - val_loss: 3.3106 - val_accuracy200: 0.3486 - 8s/epoch - 20ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2742 - accuracy200: 0.3798 - val_loss: 3.3107 - val_accuracy200: 0.3514 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2714 - accuracy200: 0.3815 - val_loss: 3.3071 - val_accuracy200: 0.3525 - 7s/epoch - 19ms/step
Epoch 9/50
385/385 - 7s - loss: 3.2679 - accuracy200: 0.3854 - val_loss: 3.3071 - val_accuracy200: 0.3547 - 7s/epoch - 19ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2666 - accuracy200: 0.3846 - val_loss: 3.2995 - val_accuracy200: 0.3622 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 7s - loss: 3.2639 - accuracy200: 0.3861 - val_loss: 3.3023 - val_accuracy200: 0.3627 - 7s/epoch - 19ms/step
Epoch 12/50
385/385 - 7s - loss: 3.2605 - accuracy200: 0.3900 - val_loss: 3.3037 - val_accuracy200: 0.3581 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 7s - loss: 3.2589 - accuracy200: 0.3915 - val_loss: 3.3014 - val_accuracy200: 0.3637 - 7s/epoch - 19ms/step
Epoch 14/50
385/385 - 8s - loss: 3.2571 - accuracy200: 0.3929 - val_loss: 3.3028 - val_accuracy200: 0.3658 - 8s/epoch - 20ms/step
Epoch 15/50
385/385 - 8s - loss: 3.2564 - accuracy200: 0.3950 - val_loss: 3.3021 - val_accuracy200: 0.3663 - 8s/epoch - 20ms/step
Epoch 16/50
385/385 - 7s - loss: 3.2537 - accuracy200: 0.3956 - val_loss: 3.3038 - val_accuracy200: 0.3655 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 7s - loss: 3.2505 - accuracy200: 0.3980 - val_loss: 3.3048 - val_accuracy200: 0.3641 - 7s/epoch - 19ms/step
Epoch 18/50
385/385 - 7s - loss: 3.2490 - accuracy200: 0.3990 - val_loss: 3.3053 - val_accuracy200: 0.3696 - 7s/epoch - 18ms/step
Epoch 19/50
385/385 - 7s - loss: 3.2468 - accuracy200: 0.3999 - val_loss: 3.3052 - val_accuracy200: 0.3687 - 7s/epoch - 19ms/step
Epoch 20/50
385/385 - 7s - loss: 3.2466 - accuracy200: 0.4001 - val_loss: 3.3039 - val_accuracy200: 0.3693 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h200
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033609
{'0': {'precision': 0.3449170124481328, 'recall': 0.3873885756366714, 'f1-score': 0.3649211813734372, 'support': 90981}, '1': {'precision': 0.3864713039426338, 'recall': 0.14003639501725948, 'f1-score': 0.2055812224157756, 'support': 106608}, '2': {'precision': 0.3461349709525957, 'recall': 0.5551738075990299, 'f1-score': 0.4264133986928105, 'support': 94012}, 'accuracy': 0.35105160819064407, 'macro avg': {'precision': 0.3591744291144541, 'recall': 0.36086625941765355, 'f1-score': 0.33230526749400774, 'support': 291601}, 'weighted avg': {'precision': 0.360501741658826, 'recall': 0.35105160819064407, 'f1-score': 0.32649227334524294, 'support': 291601}}
[[35245 11995 43741]
 [36825 14929 54854]
 [30114 11705 52193]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0911846
{'0': {'precision': 0.3997835497835498, 'recall': 0.33844368433911554, 'f1-score': 0.3665652288965335, 'support': 32744}, '1': {'precision': 0.37548426150121067, 'recall': 0.19111439751055243, 'f1-score': 0.2533025705943606, 'support': 32457}, '2': {'precision': 0.37458008785854036, 'recall': 0.6109522232591745, 'f1-score': 0.46442016133646086, 'support': 33217}, 'accuracy': 0.38183055945050703, 'macro avg': {'precision': 0.38328263304776694, 'recall': 0.3801701017029475, 'f1-score': 0.361429320275785, 'support': 98418}, 'weighted avg': {'precision': 0.3832635494325681, 'recall': 0.38183055945050703, 'f1-score': 0.3622396095011327, 'support': 98418}}
[[11082  5314 16348]
 [ 8718  6203 17536]
 [ 7920  5003 20294]]
Evaluating performance on  val set...
139/139 - 1s - 985ms/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999259
{'0': {'precision': 0.3614053216223198, 'recall': 0.3655604912464071, 'f1-score': 0.3634710314367368, 'support': 11481}, '1': {'precision': 0.4382450331125828, 'recall': 0.20054549587089932, 'f1-score': 0.2751702271427829, 'support': 13199}, '2': {'precision': 0.3333333333333333, 'recall': 0.5524272752782714, 'f1-score': 0.4157837305079376, 'support': 10691}, 'accuracy': 0.36046478753781347, 'macro avg': {'precision': 0.3776612293560786, 'recall': 0.372844420798526, 'f1-score': 0.35147499636248575, 'support': 35371}, 'weighted avg': {'precision': 0.3815938864116225, 'recall': 0.36046478753781347, 'f1-score': 0.34633249280040507, 'support': 35371}}
[[4197 1833 5451]
 [4191 2647 6361]
 [3225 1560 5906]]
training model: results/CHTR/W3/deepOF_L1/h300
Epoch 1/50
385/385 - 9s - loss: 3.3371 - accuracy300: 0.3412 - val_loss: 3.3237 - val_accuracy300: 0.3551 - 9s/epoch - 24ms/step
Epoch 2/50
385/385 - 7s - loss: 3.3137 - accuracy300: 0.3500 - val_loss: 3.3181 - val_accuracy300: 0.3544 - 7s/epoch - 19ms/step
Epoch 3/50
385/385 - 7s - loss: 3.3051 - accuracy300: 0.3541 - val_loss: 3.3099 - val_accuracy300: 0.3569 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.2973 - accuracy300: 0.3574 - val_loss: 3.3052 - val_accuracy300: 0.3579 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.2928 - accuracy300: 0.3595 - val_loss: 3.3041 - val_accuracy300: 0.3580 - 7s/epoch - 19ms/step
Epoch 6/50
385/385 - 7s - loss: 3.2893 - accuracy300: 0.3624 - val_loss: 3.3058 - val_accuracy300: 0.3563 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2865 - accuracy300: 0.3641 - val_loss: 3.3011 - val_accuracy300: 0.3576 - 7s/epoch - 18ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2844 - accuracy300: 0.3664 - val_loss: 3.3022 - val_accuracy300: 0.3595 - 7s/epoch - 18ms/step
Epoch 9/50
385/385 - 7s - loss: 3.2818 - accuracy300: 0.3695 - val_loss: 3.3014 - val_accuracy300: 0.3614 - 7s/epoch - 19ms/step
Epoch 10/50
385/385 - 8s - loss: 3.2802 - accuracy300: 0.3729 - val_loss: 3.2986 - val_accuracy300: 0.3610 - 8s/epoch - 20ms/step
Epoch 11/50
385/385 - 7s - loss: 3.2781 - accuracy300: 0.3727 - val_loss: 3.2985 - val_accuracy300: 0.3641 - 7s/epoch - 18ms/step
Epoch 12/50
385/385 - 7s - loss: 3.2764 - accuracy300: 0.3729 - val_loss: 3.2975 - val_accuracy300: 0.3661 - 7s/epoch - 19ms/step
Epoch 13/50
385/385 - 8s - loss: 3.2744 - accuracy300: 0.3762 - val_loss: 3.2985 - val_accuracy300: 0.3637 - 8s/epoch - 21ms/step
Epoch 14/50
385/385 - 8s - loss: 3.2743 - accuracy300: 0.3767 - val_loss: 3.2999 - val_accuracy300: 0.3633 - 8s/epoch - 20ms/step
Epoch 15/50
385/385 - 8s - loss: 3.2717 - accuracy300: 0.3768 - val_loss: 3.2982 - val_accuracy300: 0.3642 - 8s/epoch - 20ms/step
Epoch 16/50
385/385 - 7s - loss: 3.2712 - accuracy300: 0.3785 - val_loss: 3.2994 - val_accuracy300: 0.3648 - 7s/epoch - 19ms/step
Epoch 17/50
385/385 - 8s - loss: 3.2684 - accuracy300: 0.3804 - val_loss: 3.2991 - val_accuracy300: 0.3651 - 8s/epoch - 19ms/step
Epoch 18/50
385/385 - 7s - loss: 3.2669 - accuracy300: 0.3801 - val_loss: 3.2971 - val_accuracy300: 0.3664 - 7s/epoch - 19ms/step
Epoch 19/50
385/385 - 7s - loss: 3.2658 - accuracy300: 0.3825 - val_loss: 3.2980 - val_accuracy300: 0.3692 - 7s/epoch - 18ms/step
Epoch 20/50
385/385 - 7s - loss: 3.2652 - accuracy300: 0.3816 - val_loss: 3.2966 - val_accuracy300: 0.3676 - 7s/epoch - 18ms/step
Epoch 21/50
385/385 - 7s - loss: 3.2625 - accuracy300: 0.3844 - val_loss: 3.3041 - val_accuracy300: 0.3661 - 7s/epoch - 18ms/step
Epoch 22/50
385/385 - 8s - loss: 3.2605 - accuracy300: 0.3873 - val_loss: 3.3020 - val_accuracy300: 0.3672 - 8s/epoch - 20ms/step
Epoch 23/50
385/385 - 8s - loss: 3.2578 - accuracy300: 0.3888 - val_loss: 3.3044 - val_accuracy300: 0.3674 - 8s/epoch - 20ms/step
Epoch 24/50
385/385 - 7s - loss: 3.2573 - accuracy300: 0.3885 - val_loss: 3.3030 - val_accuracy300: 0.3669 - 7s/epoch - 19ms/step
Epoch 25/50
385/385 - 7s - loss: 3.2545 - accuracy300: 0.3899 - val_loss: 3.3020 - val_accuracy300: 0.3690 - 7s/epoch - 19ms/step
Epoch 26/50
385/385 - 8s - loss: 3.2521 - accuracy300: 0.3893 - val_loss: 3.3073 - val_accuracy300: 0.3684 - 8s/epoch - 20ms/step
Epoch 27/50
385/385 - 7s - loss: 3.2515 - accuracy300: 0.3923 - val_loss: 3.3092 - val_accuracy300: 0.3671 - 7s/epoch - 19ms/step
Epoch 28/50
385/385 - 8s - loss: 3.2491 - accuracy300: 0.3951 - val_loss: 3.3076 - val_accuracy300: 0.3677 - 8s/epoch - 20ms/step
Epoch 29/50
385/385 - 7s - loss: 3.2476 - accuracy300: 0.3930 - val_loss: 3.3138 - val_accuracy300: 0.3663 - 7s/epoch - 19ms/step
Epoch 30/50
385/385 - 7s - loss: 3.2463 - accuracy300: 0.3961 - val_loss: 3.3115 - val_accuracy300: 0.3665 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h300
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1066003
{'0': {'precision': 0.3198560094921117, 'recall': 0.3610382829968107, 'f1-score': 0.3392017402616791, 'support': 88107}, '1': {'precision': 0.38405055892452694, 'recall': 0.28495663173111674, 'f1-score': 0.32716465596829913, 'support': 110680}, '2': {'precision': 0.3371141891154979, 'recall': 0.3996379856487168, 'f1-score': 0.36572307510278934, 'support': 92814}, 'accuracy': 0.3444466925696414, 'macro avg': {'precision': 0.3470069191773788, 'recall': 0.3485443001255481, 'f1-score': 0.34402982377758917, 'support': 291601}, 'weighted avg': {'precision': 0.34971480083625894, 'recall': 0.3444466925696414, 'f1-score': 0.3430744522288929, 'support': 291601}}
[[31810 25035 31262]
 [37467 31539 41674]
 [30174 25548 37092]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940391
{'0': {'precision': 0.3782159086842953, 'recall': 0.3250907301470136, 'f1-score': 0.3496468798068176, 'support': 32514}, '1': {'precision': 0.3623644734887866, 'recall': 0.37445515378476274, 'f1-score': 0.3683106139516628, 'support': 32578}, '2': {'precision': 0.38012823996087597, 'recall': 0.4198223609194023, 'f1-score': 0.39899047510408947, 'support': 33326}, 'accuracy': 0.37350891097157024, 'macro avg': {'precision': 0.37356954071131926, 'recall': 0.3731227482837262, 'f1-score': 0.3723159896208566, 'support': 98418}, 'weighted avg': {'precision': 0.373616366896452, 'recall': 0.37350891097157024, 'f1-score': 0.3725334634383448, 'support': 98418}}
[[10570 10717 11227]
 [ 8791 12199 11588]
 [ 8586 10749 13991]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0978
{'0': {'precision': 0.3464949127228601, 'recall': 0.332586685780844, 'f1-score': 0.3393983724970284, 'support': 11161}, '1': {'precision': 0.43224319016309454, 'recall': 0.3700562906645223, 'f1-score': 0.3987396612839701, 'support': 13679}, '2': {'precision': 0.3335135552637677, 'recall': 0.41002753774570316, 'f1-score': 0.367833716670926, 'support': 10531}, 'accuracy': 0.3701337253682395, 'macro avg': {'precision': 0.37075055271657414, 'recall': 0.3708901713970232, 'f1-score': 0.3686572501506415, 'support': 35371}, 'weighted avg': {'precision': 0.37579134233195416, 'recall': 0.3701337253682395, 'f1-score': 0.37081343282362056, 'support': 35371}}
[[3712 3477 3972]
 [3960 5062 4657]
 [3041 3172 4318]]
training model: results/CHTR/W3/deepOF_L1/h500
Epoch 1/50
385/385 - 9s - loss: 3.3448 - accuracy500: 0.3343 - val_loss: 3.3325 - val_accuracy500: 0.3483 - 9s/epoch - 24ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3203 - accuracy500: 0.3424 - val_loss: 3.3213 - val_accuracy500: 0.3537 - 8s/epoch - 20ms/step
Epoch 3/50
385/385 - 7s - loss: 3.3093 - accuracy500: 0.3458 - val_loss: 3.3161 - val_accuracy500: 0.3527 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.3051 - accuracy500: 0.3447 - val_loss: 3.3201 - val_accuracy500: 0.3366 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.3007 - accuracy500: 0.3478 - val_loss: 3.3155 - val_accuracy500: 0.3431 - 7s/epoch - 19ms/step
Epoch 6/50
385/385 - 8s - loss: 3.2971 - accuracy500: 0.3501 - val_loss: 3.3190 - val_accuracy500: 0.3363 - 8s/epoch - 20ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2950 - accuracy500: 0.3511 - val_loss: 3.3162 - val_accuracy500: 0.3324 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2931 - accuracy500: 0.3541 - val_loss: 3.3179 - val_accuracy500: 0.3341 - 7s/epoch - 19ms/step
Epoch 9/50
385/385 - 8s - loss: 3.2908 - accuracy500: 0.3554 - val_loss: 3.3213 - val_accuracy500: 0.3327 - 8s/epoch - 20ms/step
Epoch 10/50
385/385 - 7s - loss: 3.2898 - accuracy500: 0.3550 - val_loss: 3.3196 - val_accuracy500: 0.3308 - 7s/epoch - 19ms/step
Epoch 11/50
385/385 - 8s - loss: 3.2885 - accuracy500: 0.3575 - val_loss: 3.3174 - val_accuracy500: 0.3351 - 8s/epoch - 20ms/step
Epoch 12/50
385/385 - 7s - loss: 3.2858 - accuracy500: 0.3596 - val_loss: 3.3170 - val_accuracy500: 0.3389 - 7s/epoch - 18ms/step
Epoch 13/50
385/385 - 7s - loss: 3.2848 - accuracy500: 0.3617 - val_loss: 3.3175 - val_accuracy500: 0.3388 - 7s/epoch - 19ms/step
Epoch 14/50
385/385 - 8s - loss: 3.2831 - accuracy500: 0.3635 - val_loss: 3.3192 - val_accuracy500: 0.3380 - 8s/epoch - 20ms/step
Epoch 15/50
385/385 - 7s - loss: 3.2824 - accuracy500: 0.3655 - val_loss: 3.3164 - val_accuracy500: 0.3431 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h500
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1089787
{'0': {'precision': 0.29369992889310265, 'recall': 0.3692384709822759, 'f1-score': 0.3271655788606552, 'support': 83897}, '1': {'precision': 0.40268244409820186, 'recall': 0.1617021636383621, 'f1-score': 0.23074556455748127, 'support': 118273}, '2': {'precision': 0.3120130994287033, 'recall': 0.4836689738457582, 'f1-score': 0.3793250110715022, 'support': 89431}, 'accuracy': 0.3201566524120288, 'macro avg': {'precision': 0.33613182414000264, 'recall': 0.33820320282213207, 'f1-score': 0.3124120514965462, 'support': 291601}, 'weighted avg': {'precision': 0.34351955974149484, 'recall': 0.3201566524120288, 'f1-score': 0.30405449841295085, 'support': 291601}}
[[30978 13977 38942]
 [42713 19125 56435]
 [31784 14392 43255]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983827
{'0': {'precision': 0.34931828866948755, 'recall': 0.30085656439806885, 'f1-score': 0.32328134413280674, 'support': 32105}, '1': {'precision': 0.3465186103035791, 'recall': 0.2242751388032079, 'f1-score': 0.2723067992434882, 'support': 32420}, '2': {'precision': 0.357604852964808, 'recall': 0.5252707048653115, 'f1-score': 0.4255171672024571, 'support': 33893}, 'accuracy': 0.35291308500477553, 'macro avg': {'precision': 0.35114725064595825, 'recall': 0.35013413602219606, 'f1-score': 0.340368436859584, 'support': 98418}, 'weighted avg': {'precision': 0.3512497539607813, 'recall': 0.35291308500477553, 'f1-score': 0.34169752822502514, 'support': 98418}}
[[ 9659  6720 15726]
 [ 8894  7271 16255]
 [ 9098  6992 17803]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034253
{'0': {'precision': 0.3322884012539185, 'recall': 0.3340536646857554, 'f1-score': 0.33316869471510036, 'support': 11106}, '1': {'precision': 0.4197222222222222, 'recall': 0.21844730374439786, 'f1-score': 0.28734429970523917, 'support': 13834}, '2': {'precision': 0.30483358814536043, 'recall': 0.4969801553062985, 'f1-score': 0.3778838794328826, 'support': 10431}, 'accuracy': 0.3368861496706341, 'macro avg': {'precision': 0.3522814038738337, 'recall': 0.34982704124548397, 'f1-score': 0.33279895795107406, 'support': 35371}, 'weighted avg': {'precision': 0.3583882662207033, 'recall': 0.3368861496706341, 'f1-score': 0.3284328775548495, 'support': 35371}}
[[3710 2152 5244]
 [4234 3022 6578]
 [3221 2026 5184]]
training model: results/CHTR/W3/deepOF_L1/h1000
Epoch 1/50
385/385 - 9s - loss: 3.3420 - accuracy1000: 0.3419 - val_loss: 3.3602 - val_accuracy1000: 0.3457 - 9s/epoch - 24ms/step
Epoch 2/50
385/385 - 8s - loss: 3.3150 - accuracy1000: 0.3503 - val_loss: 3.3429 - val_accuracy1000: 0.3451 - 8s/epoch - 20ms/step
Epoch 3/50
385/385 - 7s - loss: 3.3074 - accuracy1000: 0.3524 - val_loss: 3.3314 - val_accuracy1000: 0.3443 - 7s/epoch - 19ms/step
Epoch 4/50
385/385 - 7s - loss: 3.3005 - accuracy1000: 0.3564 - val_loss: 3.3329 - val_accuracy1000: 0.3369 - 7s/epoch - 19ms/step
Epoch 5/50
385/385 - 7s - loss: 3.2976 - accuracy1000: 0.3565 - val_loss: 3.3280 - val_accuracy1000: 0.3363 - 7s/epoch - 19ms/step
Epoch 6/50
385/385 - 7s - loss: 3.2957 - accuracy1000: 0.3560 - val_loss: 3.3263 - val_accuracy1000: 0.3323 - 7s/epoch - 19ms/step
Epoch 7/50
385/385 - 7s - loss: 3.2943 - accuracy1000: 0.3553 - val_loss: 3.3275 - val_accuracy1000: 0.3282 - 7s/epoch - 19ms/step
Epoch 8/50
385/385 - 7s - loss: 3.2922 - accuracy1000: 0.3572 - val_loss: 3.3239 - val_accuracy1000: 0.3280 - 7s/epoch - 18ms/step
Epoch 9/50
385/385 - 7s - loss: 3.2902 - accuracy1000: 0.3593 - val_loss: 3.3276 - val_accuracy1000: 0.3227 - 7s/epoch - 19ms/step
Epoch 10/50
385/385 - 7s - loss: 3.2898 - accuracy1000: 0.3586 - val_loss: 3.3266 - val_accuracy1000: 0.3269 - 7s/epoch - 19ms/step
Epoch 11/50
385/385 - 7s - loss: 3.2883 - accuracy1000: 0.3609 - val_loss: 3.3287 - val_accuracy1000: 0.3232 - 7s/epoch - 19ms/step
Epoch 12/50
385/385 - 7s - loss: 3.2876 - accuracy1000: 0.3603 - val_loss: 3.3293 - val_accuracy1000: 0.3213 - 7s/epoch - 18ms/step
Epoch 13/50
385/385 - 7s - loss: 3.2860 - accuracy1000: 0.3625 - val_loss: 3.3294 - val_accuracy1000: 0.3233 - 7s/epoch - 18ms/step
Epoch 14/50
385/385 - 7s - loss: 3.2851 - accuracy1000: 0.3647 - val_loss: 3.3280 - val_accuracy1000: 0.3271 - 7s/epoch - 19ms/step
Epoch 15/50
385/385 - 7s - loss: 3.2844 - accuracy1000: 0.3650 - val_loss: 3.3295 - val_accuracy1000: 0.3223 - 7s/epoch - 18ms/step
Epoch 16/50
385/385 - 7s - loss: 3.2825 - accuracy1000: 0.3662 - val_loss: 3.3306 - val_accuracy1000: 0.3215 - 7s/epoch - 18ms/step
Epoch 17/50
385/385 - 7s - loss: 3.2812 - accuracy1000: 0.3665 - val_loss: 3.3307 - val_accuracy1000: 0.3224 - 7s/epoch - 18ms/step
Epoch 18/50
385/385 - 7s - loss: 3.2806 - accuracy1000: 0.3677 - val_loss: 3.3342 - val_accuracy1000: 0.3203 - 7s/epoch - 19ms/step
testing model: results/CHTR/W3/deepOF_L1/h1000
Evaluating performance on  test set...
1140/1140 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003785
{'0': {'precision': 0.29343504308871415, 'recall': 0.19786965594215558, 'f1-score': 0.2363579714660426, 'support': 82428}, '1': {'precision': 0.39823020004790055, 'recall': 0.2741647140501606, 'f1-score': 0.3247516203144515, 'support': 115230}, '2': {'precision': 0.3263895536962224, 'recall': 0.5443832962541115, 'f1-score': 0.4080995890356302, 'support': 93943}, 'accuracy': 0.3396524703276052, 'macro avg': {'precision': 0.339351598944279, 'recall': 0.33880588874880924, 'f1-score': 0.3230697269387081, 'support': 291601}, 'weighted avg': {'precision': 0.3454629563208642, 'recall': 0.3396524703276052, 'f1-score': 0.32661665691685354, 'support': 291601}}
[[16310 22547 43571]
 [21663 31592 61975]
 [17610 25192 51141]]
Evaluating performance on  train set...
385/385 - 3s - 3s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968128
{'0': {'precision': 0.3507798733929387, 'recall': 0.17075417752080818, 'f1-score': 0.2296959466678062, 'support': 31478}, '1': {'precision': 0.3461257731166686, 'recall': 0.2781293409476771, 'f1-score': 0.30842433163317695, 'support': 32395}, '2': {'precision': 0.36261040235525027, 'recall': 0.5989868287740628, 'f1-score': 0.45174600748834726, 'support': 34545}, 'accuracy': 0.35640838058078805, 'macro avg': {'precision': 0.3531720162882859, 'recall': 0.34929011574751606, 'f1-score': 0.3299554285964435, 'support': 98418}, 'weighted avg': {'precision': 0.3534004920252345, 'recall': 0.35640838058078805, 'f1-score': 0.3335501743700433, 'support': 98418}}
[[ 5375  8250 17853]
 [ 4866  9010 18519]
 [ 5082  8771 20692]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033171
{'0': {'precision': 0.3328921244209133, 'recall': 0.17301573652076704, 'f1-score': 0.22769195948622192, 'support': 11629}, '1': {'precision': 0.37743662256337746, 'recall': 0.28526717557251907, 'f1-score': 0.32494239380896484, 'support': 13100}, '2': {'precision': 0.3016060949243282, 'recall': 0.550554407066341, 'f1-score': 0.3897166422775043, 'support': 10642}, 'accuracy': 0.32817845127364226, 'macro avg': {'precision': 0.3373116139695396, 'recall': 0.3362791063865423, 'f1-score': 0.3141169985242303, 'support': 35371}, 'weighted avg': {'precision': 0.3399766569408766, 'recall': 0.32817845127364226, 'f1-score': 0.31245765352633276, 'support': 35371}}
[[2012 3223 6394]
 [2190 3737 7173]
 [1842 2941 5859]]
training model: results/CHTR/W3/deepLOB_L2/h10
Epoch 1/50
385/385 - 20s - loss: 3.3393 - accuracy10: 0.3479 - val_loss: 3.3390 - val_accuracy10: 0.3480 - 20s/epoch - 52ms/step
Epoch 2/50
385/385 - 18s - loss: 3.2975 - accuracy10: 0.3648 - val_loss: 3.3217 - val_accuracy10: 0.3553 - 18s/epoch - 46ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2660 - accuracy10: 0.3863 - val_loss: 3.2888 - val_accuracy10: 0.3764 - 18s/epoch - 46ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2292 - accuracy10: 0.4116 - val_loss: 3.3188 - val_accuracy10: 0.3822 - 18s/epoch - 46ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2033 - accuracy10: 0.4241 - val_loss: 3.3190 - val_accuracy10: 0.3911 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.1838 - accuracy10: 0.4329 - val_loss: 3.3793 - val_accuracy10: 0.3909 - 18s/epoch - 46ms/step
Epoch 7/50
385/385 - 18s - loss: 3.1727 - accuracy10: 0.4372 - val_loss: 3.3462 - val_accuracy10: 0.3928 - 18s/epoch - 46ms/step
Epoch 8/50
385/385 - 18s - loss: 3.1552 - accuracy10: 0.4442 - val_loss: 3.2954 - val_accuracy10: 0.3994 - 18s/epoch - 47ms/step
Epoch 9/50
385/385 - 18s - loss: 3.1424 - accuracy10: 0.4501 - val_loss: 3.3415 - val_accuracy10: 0.4063 - 18s/epoch - 46ms/step
Epoch 10/50
385/385 - 18s - loss: 3.1320 - accuracy10: 0.4551 - val_loss: 3.3479 - val_accuracy10: 0.3979 - 18s/epoch - 47ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1225 - accuracy10: 0.4588 - val_loss: 3.3637 - val_accuracy10: 0.4041 - 18s/epoch - 46ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1132 - accuracy10: 0.4615 - val_loss: 3.3530 - val_accuracy10: 0.4019 - 18s/epoch - 47ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1035 - accuracy10: 0.4639 - val_loss: 3.3755 - val_accuracy10: 0.4021 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h10
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0961199
{'0': {'precision': 0.39463057950452907, 'recall': 0.3153824535560961, 'f1-score': 0.35058387555478954, 'support': 103189}, '1': {'precision': 0.37894343312340034, 'recall': 0.28080681079583597, 'f1-score': 0.3225763018904876, 'support': 93851}, '2': {'precision': 0.35538569545532694, 'recall': 0.5246021255221276, 'f1-score': 0.423724253385549, 'support': 94565}, 'accuracy': 0.372102673136606, 'macro avg': {'precision': 0.3763199026944188, 'recall': 0.3735971299580199, 'f1-score': 0.36562814361027535, 'support': 291605}, 'weighted avg': {'precision': 0.376855003519453, 'recall': 0.372102673136606, 'f1-score': 0.3652886338188706, 'support': 291605}}
[[32544 22341 48304]
 [25818 26354 41679]
 [24105 20851 49609]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0852764
{'0': {'precision': 0.38722290441414076, 'recall': 0.3623306724721819, 'f1-score': 0.37436346027679723, 'support': 33072}, '1': {'precision': 0.43358234799386536, 'recall': 0.2701103371756149, 'f1-score': 0.33285858067946605, 'support': 32446}, '2': {'precision': 0.37721117223867967, 'recall': 0.5418376341144646, 'f1-score': 0.4447798804905128, 'support': 32901}, 'accuracy': 0.3919365163230677, 'macro avg': {'precision': 0.39933880821556195, 'recall': 0.3914262145874205, 'f1-score': 0.3840006404822587, 'support': 98419}, 'weighted avg': {'precision': 0.39915944620061383, 'recall': 0.3919365163230677, 'f1-score': 0.38422033057660165, 'support': 98419}}
[[11983  5848 15241]
 [ 9490  8764 14192]
 [ 9473  5601 17827]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0962788
{'0': {'precision': 0.39396760379817536, 'recall': 0.3368890304091705, 'f1-score': 0.36319945073807064, 'support': 12562}, '1': {'precision': 0.41230862513263605, 'recall': 0.23670698807762597, 'f1-score': 0.3007518796992481, 'support': 11491}, '2': {'precision': 0.3542036379769299, 'recall': 0.5643223184308181, 'f1-score': 0.4352299829642248, 'support': 11318}, 'accuracy': 0.3771168471346583, 'macro avg': {'precision': 0.3868266223025804, 'recall': 0.3793061123058716, 'f1-score': 0.36639377113384786, 'support': 35371}, 'weighted avg': {'precision': 0.3872024038035309, 'recall': 0.3771168471346583, 'f1-score': 0.36596037140552434, 'support': 35371}}
[[4232 2048 6282]
 [3408 2720 5363]
 [3102 1829 6387]]
training model: results/CHTR/W3/deepLOB_L2/h20
Epoch 1/50
385/385 - 20s - loss: 3.3390 - accuracy20: 0.3490 - val_loss: 3.3459 - val_accuracy20: 0.3382 - 20s/epoch - 51ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3043 - accuracy20: 0.3569 - val_loss: 3.2991 - val_accuracy20: 0.3590 - 18s/epoch - 47ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2813 - accuracy20: 0.3735 - val_loss: 3.2968 - val_accuracy20: 0.3615 - 18s/epoch - 46ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2619 - accuracy20: 0.3881 - val_loss: 3.2921 - val_accuracy20: 0.3752 - 18s/epoch - 46ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2399 - accuracy20: 0.4067 - val_loss: 3.3042 - val_accuracy20: 0.3795 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2204 - accuracy20: 0.4171 - val_loss: 3.3007 - val_accuracy20: 0.3873 - 18s/epoch - 46ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2027 - accuracy20: 0.4264 - val_loss: 3.2806 - val_accuracy20: 0.3917 - 18s/epoch - 46ms/step
Epoch 8/50
385/385 - 18s - loss: 3.1893 - accuracy20: 0.4331 - val_loss: 3.3095 - val_accuracy20: 0.3838 - 18s/epoch - 46ms/step
Epoch 9/50
385/385 - 18s - loss: 3.1762 - accuracy20: 0.4402 - val_loss: 3.2893 - val_accuracy20: 0.3987 - 18s/epoch - 47ms/step
Epoch 10/50
385/385 - 18s - loss: 3.1659 - accuracy20: 0.4431 - val_loss: 3.2871 - val_accuracy20: 0.3957 - 18s/epoch - 46ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1536 - accuracy20: 0.4493 - val_loss: 3.3009 - val_accuracy20: 0.3940 - 18s/epoch - 46ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1443 - accuracy20: 0.4525 - val_loss: 3.2786 - val_accuracy20: 0.3996 - 18s/epoch - 46ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1354 - accuracy20: 0.4565 - val_loss: 3.2689 - val_accuracy20: 0.4008 - 18s/epoch - 46ms/step
Epoch 14/50
385/385 - 18s - loss: 3.1244 - accuracy20: 0.4588 - val_loss: 3.2878 - val_accuracy20: 0.3985 - 18s/epoch - 47ms/step
Epoch 15/50
385/385 - 18s - loss: 3.1175 - accuracy20: 0.4613 - val_loss: 3.2791 - val_accuracy20: 0.4010 - 18s/epoch - 46ms/step
Epoch 16/50
385/385 - 18s - loss: 3.1072 - accuracy20: 0.4669 - val_loss: 3.3004 - val_accuracy20: 0.3991 - 18s/epoch - 46ms/step
Epoch 17/50
385/385 - 18s - loss: 3.0971 - accuracy20: 0.4697 - val_loss: 3.3396 - val_accuracy20: 0.3932 - 18s/epoch - 46ms/step
Epoch 18/50
385/385 - 17s - loss: 3.0899 - accuracy20: 0.4719 - val_loss: 3.3197 - val_accuracy20: 0.3994 - 17s/epoch - 45ms/step
Epoch 19/50
385/385 - 18s - loss: 3.0795 - accuracy20: 0.4759 - val_loss: 3.3154 - val_accuracy20: 0.4003 - 18s/epoch - 47ms/step
Epoch 20/50
385/385 - 18s - loss: 3.0713 - accuracy20: 0.4780 - val_loss: 3.3544 - val_accuracy20: 0.3981 - 18s/epoch - 47ms/step
Epoch 21/50
385/385 - 18s - loss: 3.0608 - accuracy20: 0.4820 - val_loss: 3.3396 - val_accuracy20: 0.3998 - 18s/epoch - 46ms/step
Epoch 22/50
385/385 - 18s - loss: 3.0547 - accuracy20: 0.4851 - val_loss: 3.3642 - val_accuracy20: 0.3987 - 18s/epoch - 46ms/step
Epoch 23/50
385/385 - 18s - loss: 3.0432 - accuracy20: 0.4882 - val_loss: 3.3519 - val_accuracy20: 0.4045 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h20
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0923226
{'0': {'precision': 0.40586391296330443, 'recall': 0.3574720344316544, 'f1-score': 0.3801340659103421, 'support': 98514}, '1': {'precision': 0.43967846837356295, 'recall': 0.19661638350384547, 'f1-score': 0.2717230544960478, 'support': 97647}, '2': {'precision': 0.38398347097182495, 'recall': 0.6484116340471899, 'f1-score': 0.4823334567347972, 'support': 95444}, 'accuracy': 0.3988340391968588, 'macro avg': {'precision': 0.4098419507695641, 'recall': 0.4008333506608966, 'f1-score': 0.37806352571372903, 'support': 291605}, 'weighted avg': {'precision': 0.4100254773627857, 'recall': 0.3988340391968588, 'f1-score': 0.37728194961013356, 'support': 291605}}
[[35216 13568 49730]
 [28894 19199 49554]
 [22658 10899 61887]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0616983
{'0': {'precision': 0.4482, 'recall': 0.33413848631239934, 'f1-score': 0.38285440940308196, 'support': 33534}, '1': {'precision': 0.48167059439643883, 'recall': 0.34019665259069753, 'f1-score': 0.39875715808298856, 'support': 32443}, '2': {'precision': 0.4073260073260073, 'recall': 0.6341162690339683, 'f1-score': 0.4960275838788624, 'support': 32442}, 'accuracy': 0.43501762870990357, 'macro avg': {'precision': 0.4457322005741487, 'recall': 0.43615046931235507, 'f1-score': 0.42587971712164435, 'support': 98419}, 'weighted avg': {'precision': 0.44575994699879085, 'recall': 0.43501762870990357, 'f1-score': 0.42540205774095863, 'support': 98419}}
[[11205  6727 15602]
 [ 7075 11037 14331]
 [ 6720  5150 20572]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0895232
{'0': {'precision': 0.41369758334129336, 'recall': 0.34885219492549335, 'f1-score': 0.37851774165355706, 'support': 12415}, '1': {'precision': 0.4507969001315982, 'recall': 0.26289758676558367, 'f1-score': 0.3321124636432188, 'support': 11727}, '2': {'precision': 0.3744671427780546, 'recall': 0.6023688663282571, 'f1-score': 0.4618325822750239, 'support': 11229}, 'accuracy': 0.4008368437420486, 'macro avg': {'precision': 0.4129872087503154, 'recall': 0.40470621600644474, 'f1-score': 0.3908209291905999, 'support': 35371}, 'weighted avg': {'precision': 0.4135433629606226, 'recall': 0.4008368437420486, 'f1-score': 0.38958182381440104, 'support': 35371}}
[[4331 2017 6067]
 [3412 3083 5232]
 [2726 1739 6764]]
training model: results/CHTR/W3/deepLOB_L2/h30
Epoch 1/50
385/385 - 20s - loss: 3.3398 - accuracy30: 0.3497 - val_loss: 3.3751 - val_accuracy30: 0.3400 - 20s/epoch - 52ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3082 - accuracy30: 0.3577 - val_loss: 3.3560 - val_accuracy30: 0.3395 - 18s/epoch - 47ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2850 - accuracy30: 0.3739 - val_loss: 3.3366 - val_accuracy30: 0.3444 - 18s/epoch - 47ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2656 - accuracy30: 0.3858 - val_loss: 3.3518 - val_accuracy30: 0.3474 - 18s/epoch - 46ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2470 - accuracy30: 0.3996 - val_loss: 3.3247 - val_accuracy30: 0.3638 - 18s/epoch - 47ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2297 - accuracy30: 0.4102 - val_loss: 3.3137 - val_accuracy30: 0.3657 - 18s/epoch - 47ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2166 - accuracy30: 0.4183 - val_loss: 3.3262 - val_accuracy30: 0.3660 - 18s/epoch - 47ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2014 - accuracy30: 0.4249 - val_loss: 3.3254 - val_accuracy30: 0.3671 - 18s/epoch - 46ms/step
Epoch 9/50
385/385 - 17s - loss: 3.1892 - accuracy30: 0.4310 - val_loss: 3.3048 - val_accuracy30: 0.3779 - 17s/epoch - 45ms/step
Epoch 10/50
385/385 - 18s - loss: 3.1775 - accuracy30: 0.4374 - val_loss: 3.3041 - val_accuracy30: 0.3800 - 18s/epoch - 46ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1645 - accuracy30: 0.4432 - val_loss: 3.2987 - val_accuracy30: 0.3806 - 18s/epoch - 46ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1541 - accuracy30: 0.4474 - val_loss: 3.2925 - val_accuracy30: 0.3853 - 18s/epoch - 46ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1451 - accuracy30: 0.4507 - val_loss: 3.3082 - val_accuracy30: 0.3749 - 18s/epoch - 47ms/step
Epoch 14/50
385/385 - 18s - loss: 3.1367 - accuracy30: 0.4525 - val_loss: 3.3090 - val_accuracy30: 0.3803 - 18s/epoch - 47ms/step
Epoch 15/50
385/385 - 18s - loss: 3.1275 - accuracy30: 0.4568 - val_loss: 3.3085 - val_accuracy30: 0.3808 - 18s/epoch - 48ms/step
Epoch 16/50
385/385 - 18s - loss: 3.1171 - accuracy30: 0.4605 - val_loss: 3.3090 - val_accuracy30: 0.3816 - 18s/epoch - 47ms/step
Epoch 17/50
385/385 - 18s - loss: 3.1094 - accuracy30: 0.4649 - val_loss: 3.3291 - val_accuracy30: 0.3801 - 18s/epoch - 47ms/step
Epoch 18/50
385/385 - 18s - loss: 3.0986 - accuracy30: 0.4690 - val_loss: 3.3290 - val_accuracy30: 0.3795 - 18s/epoch - 47ms/step
Epoch 19/50
385/385 - 18s - loss: 3.0886 - accuracy30: 0.4718 - val_loss: 3.3389 - val_accuracy30: 0.3770 - 18s/epoch - 46ms/step
Epoch 20/50
385/385 - 18s - loss: 3.0808 - accuracy30: 0.4758 - val_loss: 3.3368 - val_accuracy30: 0.3782 - 18s/epoch - 47ms/step
Epoch 21/50
385/385 - 18s - loss: 3.0705 - accuracy30: 0.4791 - val_loss: 3.3613 - val_accuracy30: 0.3755 - 18s/epoch - 46ms/step
Epoch 22/50
385/385 - 18s - loss: 3.0598 - accuracy30: 0.4814 - val_loss: 3.3780 - val_accuracy30: 0.3741 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h30
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.099854
{'0': {'precision': 0.38885398099585805, 'recall': 0.3151855316495167, 'f1-score': 0.3481655405211461, 'support': 96210}, '1': {'precision': 0.4113699943267406, 'recall': 0.21152801529021226, 'f1-score': 0.27939173703056597, 'support': 99410}, '2': {'precision': 0.3700501523030061, 'recall': 0.6265041412720738, 'f1-score': 0.4652791210491702, 'support': 95985}, 'accuracy': 0.382321976646491, 'macro avg': {'precision': 0.3900913758752016, 'recall': 0.38440589607060094, 'f1-score': 0.3642787995336274, 'support': 291605}, 'weighted avg': {'precision': 0.39034034572945187, 'recall': 0.382321976646491, 'f1-score': 0.36326933922824584, 'support': 291605}}
[[30324 15836 50050]
 [26062 21028 52320]
 [21597 14253 60135]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0768743
{'0': {'precision': 0.44230290353105234, 'recall': 0.26374246428889614, 'f1-score': 0.3304435183807114, 'support': 33673}, '1': {'precision': 0.451804890671497, 'recall': 0.32366299008249144, 'f1-score': 0.3771465601036829, 'support': 32367}, '2': {'precision': 0.3879752687977082, 'recall': 0.660860434232064, 'f1-score': 0.4889183384362291, 'support': 32379}, 'accuracy': 0.4140968715390321, 'macro avg': {'precision': 0.42736102100008583, 'recall': 0.4160886295344839, 'f1-score': 0.39883613897354114, 'support': 98419}, 'weighted avg': {'precision': 0.4275544945118977, 'recall': 0.4140968715390321, 'f1-score': 0.397939566400149, 'support': 98419}}
[[ 8881  7005 17787]
 [ 5923 10476 15968]
 [ 5275  5706 21398]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0995479
{'0': {'precision': 0.3997602237911283, 'recall': 0.24382515437114072, 'f1-score': 0.30290184203885945, 'support': 12308}, '1': {'precision': 0.4073788546255507, 'recall': 0.3104229607250755, 'f1-score': 0.35235282911030674, 'support': 11916}, '2': {'precision': 0.3605195911413969, 'recall': 0.6075177177715977, 'f1-score': 0.4525074337643246, 'support': 11147}, 'accuracy': 0.38087698962426847, 'macro avg': {'precision': 0.38921955651935863, 'recall': 0.3872552776226046, 'f1-score': 0.36925403497116366, 'support': 35371}, 'weighted avg': {'precision': 0.3899603389384643, 'recall': 0.38087698962426847, 'f1-score': 0.3667086751198333, 'support': 35371}}
[[3001 2898 6409]
 [2614 3699 5603]
 [1892 2483 6772]]
training model: results/CHTR/W3/deepLOB_L2/h50
Epoch 1/50
385/385 - 20s - loss: 3.3392 - accuracy50: 0.3487 - val_loss: 3.3599 - val_accuracy50: 0.3341 - 20s/epoch - 51ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3020 - accuracy50: 0.3603 - val_loss: 3.3483 - val_accuracy50: 0.3394 - 18s/epoch - 47ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2865 - accuracy50: 0.3725 - val_loss: 3.3336 - val_accuracy50: 0.3393 - 18s/epoch - 47ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2694 - accuracy50: 0.3857 - val_loss: 3.3342 - val_accuracy50: 0.3413 - 18s/epoch - 47ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2587 - accuracy50: 0.3932 - val_loss: 3.3751 - val_accuracy50: 0.3397 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2471 - accuracy50: 0.4002 - val_loss: 3.4057 - val_accuracy50: 0.3404 - 18s/epoch - 47ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2377 - accuracy50: 0.4064 - val_loss: 3.3948 - val_accuracy50: 0.3460 - 18s/epoch - 46ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2270 - accuracy50: 0.4140 - val_loss: 3.4464 - val_accuracy50: 0.3464 - 18s/epoch - 46ms/step
Epoch 9/50
385/385 - 18s - loss: 3.2156 - accuracy50: 0.4172 - val_loss: 3.4076 - val_accuracy50: 0.3493 - 18s/epoch - 46ms/step
Epoch 10/50
385/385 - 17s - loss: 3.2062 - accuracy50: 0.4225 - val_loss: 3.4355 - val_accuracy50: 0.3528 - 17s/epoch - 45ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1964 - accuracy50: 0.4281 - val_loss: 3.4357 - val_accuracy50: 0.3555 - 18s/epoch - 47ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1865 - accuracy50: 0.4315 - val_loss: 3.4514 - val_accuracy50: 0.3536 - 18s/epoch - 46ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1777 - accuracy50: 0.4358 - val_loss: 3.4516 - val_accuracy50: 0.3559 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h50
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1136808
{'0': {'precision': 0.3615598885793872, 'recall': 0.199949006151133, 'f1-score': 0.25749740053631043, 'support': 94129}, '1': {'precision': 0.364534846649238, 'recall': 0.05647256383661777, 'f1-score': 0.0977950358370824, 'support': 101235}, '2': {'precision': 0.3391165290105286, 'recall': 0.788821811909685, 'f1-score': 0.4743211666062703, 'support': 96241}, 'accuracy': 0.3444899778810377, 'macro avg': {'precision': 0.3550704214130513, 'recall': 0.3484144606324786, 'f1-score': 0.2765378676598877, 'support': 291605}, 'weighted avg': {'precision': 0.3551855071796678, 'recall': 0.3444899778810377, 'f1-score': 0.27361463851238305, 'support': 291605}}
[[18821  4830 70478]
 [18046  5717 77472]
 [15188  5136 75917]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1033863
{'0': {'precision': 0.3985068692847992, 'recall': 0.26803541716187307, 'f1-score': 0.32050166095251625, 'support': 33656}, '1': {'precision': 0.36794208893485003, 'recall': 0.05485154009804828, 'f1-score': 0.09547064505742192, 'support': 32433}, '2': {'precision': 0.3471323664143657, 'recall': 0.761769254562326, 'f1-score': 0.4769309720460509, 'support': 32330}, 'accuracy': 0.3599711437832126, 'macro avg': {'precision': 0.371193774878005, 'recall': 0.3615520706074158, 'f1-score': 0.297634426018663, 'support': 98419}, 'weighted avg': {'precision': 0.37155836138600923, 'recall': 0.3599711437832126, 'f1-score': 0.29773094278964507, 'support': 98419}}
[[ 9021  1589 23046]
 [ 7381  1779 23273]
 [ 6235  1467 24628]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1125546
{'0': {'precision': 0.35076626299432, 'recall': 0.2694492467275871, 'f1-score': 0.3047769810969364, 'support': 12147}, '1': {'precision': 0.37141735374950924, 'recall': 0.07754098360655738, 'f1-score': 0.12829728080287517, 'support': 12200}, '2': {'precision': 0.3312050397990891, 'recall': 0.7058236574746009, 'f1-score': 0.45085030564649303, 'support': 11024}, 'accuracy': 0.33926097650617737, 'macro avg': {'precision': 0.35112955218097275, 'recall': 0.35093796260291504, 'f1-score': 0.29464152251543485, 'support': 35371}, 'weighted avg': {'precision': 0.35179253826810597, 'recall': 0.33926097650617737, 'f1-score': 0.28943277217569485, 'support': 35371}}
[[3273  862 8012]
 [3554  946 7700]
 [2504  739 7781]]
training model: results/CHTR/W3/deepLOB_L2/h100
Epoch 1/50
385/385 - 20s - loss: 3.3395 - accuracy100: 0.3470 - val_loss: 3.3446 - val_accuracy100: 0.3408 - 20s/epoch - 51ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3143 - accuracy100: 0.3519 - val_loss: 3.3486 - val_accuracy100: 0.3323 - 18s/epoch - 48ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2942 - accuracy100: 0.3642 - val_loss: 3.3382 - val_accuracy100: 0.3395 - 18s/epoch - 47ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2806 - accuracy100: 0.3709 - val_loss: 3.3481 - val_accuracy100: 0.3363 - 18s/epoch - 47ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2732 - accuracy100: 0.3773 - val_loss: 3.3849 - val_accuracy100: 0.3293 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2622 - accuracy100: 0.3865 - val_loss: 3.3824 - val_accuracy100: 0.3294 - 18s/epoch - 46ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2533 - accuracy100: 0.3932 - val_loss: 3.3951 - val_accuracy100: 0.3369 - 18s/epoch - 46ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2436 - accuracy100: 0.3982 - val_loss: 3.3702 - val_accuracy100: 0.3400 - 18s/epoch - 47ms/step
Epoch 9/50
385/385 - 18s - loss: 3.2345 - accuracy100: 0.4041 - val_loss: 3.3804 - val_accuracy100: 0.3403 - 18s/epoch - 46ms/step
Epoch 10/50
385/385 - 17s - loss: 3.2238 - accuracy100: 0.4097 - val_loss: 3.3859 - val_accuracy100: 0.3397 - 17s/epoch - 45ms/step
Epoch 11/50
385/385 - 18s - loss: 3.2134 - accuracy100: 0.4180 - val_loss: 3.3919 - val_accuracy100: 0.3414 - 18s/epoch - 47ms/step
Epoch 12/50
385/385 - 18s - loss: 3.2041 - accuracy100: 0.4220 - val_loss: 3.3995 - val_accuracy100: 0.3438 - 18s/epoch - 46ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1931 - accuracy100: 0.4276 - val_loss: 3.3855 - val_accuracy100: 0.3477 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h100
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1096879
{'0': {'precision': 0.34197294009956236, 'recall': 0.2920164468048655, 'f1-score': 0.3150264813071427, 'support': 93392}, '1': {'precision': 0.3587182688306284, 'recall': 0.14323555572932448, 'f1-score': 0.20472484946702246, 'support': 102307}, '2': {'precision': 0.33379725739013477, 'recall': 0.5951765270160365, 'f1-score': 0.4277156055763906, 'support': 95906}, 'accuracy': 0.339524356578248, 'macro avg': {'precision': 0.34482948877344183, 'recall': 0.34347617651674217, 'f1-score': 0.31582231211685197, 'support': 291605}, 'weighted avg': {'precision': 0.34515898739147716, 'recall': 0.339524356578248, 'f1-score': 0.31339048090762733, 'support': 291605}}
[[27272 12889 53231]
 [26960 14654 60693]
 [25517 13308 57081]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032552
{'0': {'precision': 0.3594382289930969, 'recall': 0.3629916764325851, 'f1-score': 0.3612062134644999, 'support': 33279}, '1': {'precision': 0.34906256583105116, 'recall': 0.1526438616962476, 'f1-score': 0.21240412758775393, 'support': 32566}, '2': {'precision': 0.3449475973897568, 'recall': 0.5355191256830601, 'f1-score': 0.41960935244876363, 'support': 32574}, 'accuracy': 0.3504912669301659, 'macro avg': {'precision': 0.3511494640713016, 'recall': 0.35038488793729766, 'f1-score': 0.3310732311670058, 'support': 98419}, 'weighted avg': {'precision': 0.35120900820867135, 'recall': 0.3504912669301659, 'f1-score': 0.3312987273145827, 'support': 98419}}
[[12080  4740 16459]
 [10928  4971 16667]
 [10600  4530 17444]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1125059
{'0': {'precision': 0.3398508825319537, 'recall': 0.38033205619412513, 'f1-score': 0.3589537546707381, 'support': 11745}, '1': {'precision': 0.38603988603988604, 'recall': 0.1485512920908379, 'f1-score': 0.2145442207645329, 'support': 12770}, '2': {'precision': 0.31987523826026687, 'recall': 0.510132645541636, 'f1-score': 0.3931981965990983, 'support': 10856}, 'accuracy': 0.3364903451980436, 'macro avg': {'precision': 0.34858866894403556, 'recall': 0.34633866460886636, 'f1-score': 0.3222320573447897, 'support': 35371}, 'weighted avg': {'precision': 0.3503956220242741, 'recall': 0.3364903451980436, 'f1-score': 0.31732778745443196, 'support': 35371}}
[[4467 1564 5714]
 [4812 1897 6061]
 [3865 1453 5538]]
training model: results/CHTR/W3/deepLOB_L2/h200
Epoch 1/50
385/385 - 20s - loss: 3.3430 - accuracy200: 0.3437 - val_loss: 3.3864 - val_accuracy200: 0.3295 - 20s/epoch - 53ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3098 - accuracy200: 0.3548 - val_loss: 3.3900 - val_accuracy200: 0.3116 - 18s/epoch - 46ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2977 - accuracy200: 0.3606 - val_loss: 3.3508 - val_accuracy200: 0.3140 - 18s/epoch - 46ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2818 - accuracy200: 0.3713 - val_loss: 3.3494 - val_accuracy200: 0.3191 - 18s/epoch - 46ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2705 - accuracy200: 0.3797 - val_loss: 3.3642 - val_accuracy200: 0.3096 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2594 - accuracy200: 0.3898 - val_loss: 3.3389 - val_accuracy200: 0.3360 - 18s/epoch - 46ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2525 - accuracy200: 0.3943 - val_loss: 3.3649 - val_accuracy200: 0.3222 - 18s/epoch - 46ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2407 - accuracy200: 0.4027 - val_loss: 3.3808 - val_accuracy200: 0.3254 - 18s/epoch - 46ms/step
Epoch 9/50
385/385 - 18s - loss: 3.2314 - accuracy200: 0.4078 - val_loss: 3.4045 - val_accuracy200: 0.3222 - 18s/epoch - 46ms/step
Epoch 10/50
385/385 - 18s - loss: 3.2245 - accuracy200: 0.4125 - val_loss: 3.3772 - val_accuracy200: 0.3265 - 18s/epoch - 46ms/step
Epoch 11/50
385/385 - 18s - loss: 3.2140 - accuracy200: 0.4195 - val_loss: 3.3943 - val_accuracy200: 0.3246 - 18s/epoch - 47ms/step
Epoch 12/50
385/385 - 18s - loss: 3.2075 - accuracy200: 0.4233 - val_loss: 3.3965 - val_accuracy200: 0.3285 - 18s/epoch - 47ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1927 - accuracy200: 0.4289 - val_loss: 3.3951 - val_accuracy200: 0.3328 - 18s/epoch - 47ms/step
Epoch 14/50
385/385 - 18s - loss: 3.1816 - accuracy200: 0.4336 - val_loss: 3.4244 - val_accuracy200: 0.3356 - 18s/epoch - 47ms/step
Epoch 15/50
385/385 - 18s - loss: 3.1676 - accuracy200: 0.4422 - val_loss: 3.4410 - val_accuracy200: 0.3281 - 18s/epoch - 47ms/step
Epoch 16/50
385/385 - 18s - loss: 3.1610 - accuracy200: 0.4435 - val_loss: 3.4151 - val_accuracy200: 0.3352 - 18s/epoch - 46ms/step
testing model: results/CHTR/W3/deepLOB_L2/h200
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1166089
{'0': {'precision': 0.31129961035826353, 'recall': 0.09922841880811589, 'f1-score': 0.15048798579798806, 'support': 90982}, '1': {'precision': 0.3579756475953176, 'recall': 0.14285044274350894, 'f1-score': 0.20421052631578948, 'support': 106608}, '2': {'precision': 0.3232907089820142, 'recall': 0.7567303089932458, 'f1-score': 0.4530354021466074, 'support': 94015}, 'accuracy': 0.3271583134719912, 'macro avg': {'precision': 0.3308553223118651, 'recall': 0.3329363901816235, 'f1-score': 0.269244638086795, 'support': 291605}, 'weighted avg': {'precision': 0.33222991715986083, 'recall': 0.3271583134719912, 'f1-score': 0.26767132609577865, 'support': 291605}}
[[ 9028 14087 67867]
 [10328 15229 81051]
 [ 9645 13226 71144]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105864
{'0': {'precision': 0.3729223995597138, 'recall': 0.10339986571446011, 'f1-score': 0.16190772024563332, 'support': 32766}, '1': {'precision': 0.3527719812757318, 'recall': 0.19271651723819208, 'f1-score': 0.24926277197736513, 'support': 32457}, '2': {'precision': 0.3422901275086239, 'recall': 0.7383118448005784, 'f1-score': 0.46773347073922455, 'support': 33196}, 'accuracy': 0.3470061675083063, 'macro avg': {'precision': 0.35599483611468985, 'recall': 0.3448094092510769, 'f1-score': 0.29296798765407434, 'support': 98419}, 'weighted avg': {'precision': 0.35594507781034446, 'recall': 0.3470061675083063, 'f1-score': 0.29386876971211917, 'support': 98419}}
[[ 3388  5822 23556]
 [ 2664  6255 23538]
 [ 3033  5654 24509]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1126441
{'0': {'precision': 0.32464020090794937, 'recall': 0.2924134330955281, 'f1-score': 0.3076852657115393, 'support': 11494}, '1': {'precision': 0.4342129889575145, 'recall': 0.17582417582417584, 'f1-score': 0.25029668788434567, 'support': 13195}, '2': {'precision': 0.3050571791613723, 'recall': 0.5618797977906759, 'f1-score': 0.39542774318937973, 'support': 10682}, 'accuracy': 0.33029883237680585, 'macro avg': {'precision': 0.354636789675612, 'recall': 0.3433724689034599, 'f1-score': 0.31780323226175494, 'support': 35371}, 'weighted avg': {'precision': 0.35960181070176567, 'recall': 0.33029883237680585, 'f1-score': 0.31277482665096623, 'support': 35371}}
[[3361 1564 6569]
 [3771 2320 7104]
 [3221 1459 6002]]
training model: results/CHTR/W3/deepLOB_L2/h300
Epoch 1/50
385/385 - 20s - loss: 3.3477 - accuracy300: 0.3429 - val_loss: 3.3757 - val_accuracy300: 0.3320 - 20s/epoch - 52ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3140 - accuracy300: 0.3519 - val_loss: 3.3739 - val_accuracy300: 0.3216 - 18s/epoch - 47ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2976 - accuracy300: 0.3624 - val_loss: 3.3689 - val_accuracy300: 0.3152 - 18s/epoch - 47ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2850 - accuracy300: 0.3705 - val_loss: 3.3675 - val_accuracy300: 0.3114 - 18s/epoch - 47ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2715 - accuracy300: 0.3795 - val_loss: 3.3772 - val_accuracy300: 0.3207 - 18s/epoch - 46ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2641 - accuracy300: 0.3839 - val_loss: 3.4396 - val_accuracy300: 0.3138 - 18s/epoch - 47ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2504 - accuracy300: 0.3921 - val_loss: 3.3891 - val_accuracy300: 0.3311 - 18s/epoch - 48ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2408 - accuracy300: 0.3990 - val_loss: 3.4239 - val_accuracy300: 0.3242 - 18s/epoch - 47ms/step
Epoch 9/50
385/385 - 18s - loss: 3.2297 - accuracy300: 0.4051 - val_loss: 3.4573 - val_accuracy300: 0.3238 - 18s/epoch - 47ms/step
Epoch 10/50
385/385 - 18s - loss: 3.2203 - accuracy300: 0.4110 - val_loss: 3.4080 - val_accuracy300: 0.3385 - 18s/epoch - 47ms/step
Epoch 11/50
385/385 - 18s - loss: 3.2090 - accuracy300: 0.4169 - val_loss: 3.4386 - val_accuracy300: 0.3290 - 18s/epoch - 47ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1992 - accuracy300: 0.4233 - val_loss: 3.4493 - val_accuracy300: 0.3336 - 18s/epoch - 46ms/step
Epoch 13/50
385/385 - 18s - loss: 3.1936 - accuracy300: 0.4253 - val_loss: 3.4431 - val_accuracy300: 0.3372 - 18s/epoch - 46ms/step
Epoch 14/50
385/385 - 18s - loss: 3.1846 - accuracy300: 0.4299 - val_loss: 3.4501 - val_accuracy300: 0.3365 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h300
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1241232
{'0': {'precision': 0.2805581231568291, 'recall': 0.14468606709946882, 'f1-score': 0.19091548979377893, 'support': 88108}, '1': {'precision': 0.3739987285441831, 'recall': 0.053152754311941525, 'f1-score': 0.09307734295274937, 'support': 110681}, '2': {'precision': 0.31934975720044956, 'recall': 0.7928589898293398, 'f1-score': 0.45530899945244124, 'support': 92816}, 'accuracy': 0.31625315066614085, 'macro avg': {'precision': 0.32463553630048725, 'recall': 0.3302326037469167, 'f1-score': 0.24643394406632316, 'support': 291605}, 'weighted avg': {'precision': 0.3283713772171861, 'recall': 0.31625315066614085, 'f1-score': 0.2379349992739539, 'support': 291605}}
[[12748  5085 70275]
 [18226  5883 86572]
 [14464  4762 73590]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1137003
{'0': {'precision': 0.33869212090764467, 'recall': 0.12440794734575875, 'f1-score': 0.18197359246013, 'support': 32514}, '1': {'precision': 0.33548033438399344, 'recall': 0.07517042314069888, 'f1-score': 0.12282066076311367, 'support': 32566}, '2': {'precision': 0.3399891385342073, 'recall': 0.8074627313356729, 'f1-score': 0.47850121758296443, 'support': 33339}, 'accuracy': 0.3394974547597517, 'macro avg': {'precision': 0.33805386460861514, 'recall': 0.33568036727404355, 'f1-score': 0.26109849026873605, 'support': 98419}, 'weighted avg': {'precision': 0.33806872736293014, 'recall': 0.3394974547597517, 'f1-score': 0.2628478151236924, 'support': 98419}}
[[ 4045  2444 26025]
 [ 3884  2448 26234]
 [ 4014  2405 26920]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1199645
{'0': {'precision': 0.30794107078692057, 'recall': 0.307168458781362, 'f1-score': 0.3075542795621748, 'support': 11160}, '1': {'precision': 0.434597776324395, 'recall': 0.09709234365867914, 'f1-score': 0.15872447151558583, 'support': 13688}, '2': {'precision': 0.2930928662480525, 'recall': 0.5899458329373752, 'f1-score': 0.39162250820085787, 'support': 10523}, 'accuracy': 0.30999971728251957, 'macro avg': {'precision': 0.3452105711197893, 'recall': 0.33140221179247215, 'f1-score': 0.28596708642620616, 'support': 35371}, 'weighted avg': {'precision': 0.35253775533172965, 'recall': 0.30999971728251957, 'f1-score': 0.2749701727352022, 'support': 35371}}
[[3428  919 6813]
 [4199 1329 8160]
 [3505  810 6208]]
training model: results/CHTR/W3/deepLOB_L2/h500
Epoch 1/50
385/385 - 19s - loss: 3.3449 - accuracy500: 0.3488 - val_loss: 3.4520 - val_accuracy500: 0.3373 - 19s/epoch - 51ms/step
Epoch 2/50
385/385 - 18s - loss: 3.3070 - accuracy500: 0.3663 - val_loss: 3.3916 - val_accuracy500: 0.3149 - 18s/epoch - 48ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2825 - accuracy500: 0.3746 - val_loss: 3.4084 - val_accuracy500: 0.3040 - 18s/epoch - 47ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2620 - accuracy500: 0.3853 - val_loss: 3.4215 - val_accuracy500: 0.2956 - 18s/epoch - 47ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2460 - accuracy500: 0.3963 - val_loss: 3.5034 - val_accuracy500: 0.2911 - 18s/epoch - 47ms/step
Epoch 6/50
385/385 - 18s - loss: 3.2368 - accuracy500: 0.3988 - val_loss: 3.5421 - val_accuracy500: 0.2857 - 18s/epoch - 47ms/step
Epoch 7/50
385/385 - 18s - loss: 3.2219 - accuracy500: 0.4099 - val_loss: 3.5084 - val_accuracy500: 0.2902 - 18s/epoch - 47ms/step
Epoch 8/50
385/385 - 18s - loss: 3.2068 - accuracy500: 0.4156 - val_loss: 3.5964 - val_accuracy500: 0.2870 - 18s/epoch - 47ms/step
Epoch 9/50
385/385 - 18s - loss: 3.1990 - accuracy500: 0.4183 - val_loss: 3.5372 - val_accuracy500: 0.2914 - 18s/epoch - 47ms/step
Epoch 10/50
385/385 - 18s - loss: 3.1891 - accuracy500: 0.4244 - val_loss: 3.5894 - val_accuracy500: 0.2925 - 18s/epoch - 47ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1754 - accuracy500: 0.4291 - val_loss: 3.5446 - val_accuracy500: 0.3046 - 18s/epoch - 47ms/step
Epoch 12/50
385/385 - 18s - loss: 3.1697 - accuracy500: 0.4326 - val_loss: 3.5259 - val_accuracy500: 0.3107 - 18s/epoch - 47ms/step
testing model: results/CHTR/W3/deepLOB_L2/h500
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1207509
{'0': {'precision': 0.26113062195536424, 'recall': 0.027473837278600206, 'f1-score': 0.04971690482609868, 'support': 83898}, '1': {'precision': 0.4145837698685904, 'recall': 0.1171009689365372, 'f1-score': 0.18262010403412426, 'support': 118274}, '2': {'precision': 0.30783451163126424, 'recall': 0.8583520624378026, 'f1-score': 0.4531528553381896, 'support': 89433}, 'accuracy': 0.31865022890554, 'macro avg': {'precision': 0.327849634485073, 'recall': 0.33430895621764667, 'f1-score': 0.22849662139947088, 'support': 291605}, 'weighted avg': {'precision': 0.3376944208671582, 'recall': 0.31865022890554, 'f1-score': 0.22735268043103635, 'support': 291605}}
[[  2305   9651  71942]
 [  3760  13850 100664]
 [  2762   9906  76765]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1177833
{'0': {'precision': 0.34399841017488075, 'recall': 0.05396894681050072, 'f1-score': 0.09330027488815826, 'support': 32074}, '1': {'precision': 0.32273695420660276, 'recall': 0.18645788469820956, 'f1-score': 0.23636080021838318, 'support': 32506}, '2': {'precision': 0.3453295267200129, 'recall': 0.7613700168444694, 'f1-score': 0.47514892204415105, 'support': 33839}, 'accuracy': 0.340950426238836, 'macro avg': {'precision': 0.33735496370049883, 'recall': 0.3339322827843932, 'f1-score': 0.2682699990502308, 'support': 98419}, 'weighted avg': {'precision': 0.33743381152081886, 'recall': 0.340950426238836, 'f1-score': 0.2718400061137949, 'support': 98419}}
[[ 1731  6375 23968]
 [ 1570  6061 24875]
 [ 1731  6344 25764]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1266515
{'0': {'precision': 0.2997241033358415, 'recall': 0.10722296994167788, 'f1-score': 0.15794343113930742, 'support': 11145}, '1': {'precision': 0.3893578677795694, 'recall': 0.29826346000145315, 'f1-score': 0.33777668065498223, 'support': 13763}, '2': {'precision': 0.2826639796554868, 'recall': 0.5630316352862468, 'f1-score': 0.37637362637362637, 'support': 10463}, 'accuracy': 0.31638913234005256, 'macro avg': {'precision': 0.32391531692363257, 'recall': 0.3228393550764593, 'f1-score': 0.2906979127226387, 'support': 35371}, 'weighted avg': {'precision': 0.3295544566187986, 'recall': 0.31638913234005256, 'f1-score': 0.2925305263817634, 'support': 35371}}
[[1195 3213 6737]
 [1445 4105 8213]
 [1347 3225 5891]]
training model: results/CHTR/W3/deepLOB_L2/h1000
Epoch 1/50
385/385 - 20s - loss: 3.3308 - accuracy1000: 0.3595 - val_loss: 3.4151 - val_accuracy1000: 0.3262 - 20s/epoch - 52ms/step
Epoch 2/50
385/385 - 18s - loss: 3.2835 - accuracy1000: 0.3847 - val_loss: 3.5692 - val_accuracy1000: 0.3331 - 18s/epoch - 47ms/step
Epoch 3/50
385/385 - 18s - loss: 3.2563 - accuracy1000: 0.3956 - val_loss: 3.5289 - val_accuracy1000: 0.3144 - 18s/epoch - 46ms/step
Epoch 4/50
385/385 - 18s - loss: 3.2249 - accuracy1000: 0.4107 - val_loss: 3.6344 - val_accuracy1000: 0.3044 - 18s/epoch - 47ms/step
Epoch 5/50
385/385 - 18s - loss: 3.2066 - accuracy1000: 0.4152 - val_loss: 3.5459 - val_accuracy1000: 0.2957 - 18s/epoch - 47ms/step
Epoch 6/50
385/385 - 18s - loss: 3.1859 - accuracy1000: 0.4235 - val_loss: 3.5448 - val_accuracy1000: 0.3169 - 18s/epoch - 47ms/step
Epoch 7/50
385/385 - 18s - loss: 3.1786 - accuracy1000: 0.4248 - val_loss: 3.6332 - val_accuracy1000: 0.3097 - 18s/epoch - 48ms/step
Epoch 8/50
385/385 - 18s - loss: 3.1628 - accuracy1000: 0.4311 - val_loss: 3.5909 - val_accuracy1000: 0.3219 - 18s/epoch - 47ms/step
Epoch 9/50
385/385 - 18s - loss: 3.1516 - accuracy1000: 0.4371 - val_loss: 3.6332 - val_accuracy1000: 0.3134 - 18s/epoch - 46ms/step
Epoch 10/50
385/385 - 18s - loss: 3.1380 - accuracy1000: 0.4415 - val_loss: 3.6953 - val_accuracy1000: 0.3213 - 18s/epoch - 46ms/step
Epoch 11/50
385/385 - 18s - loss: 3.1308 - accuracy1000: 0.4431 - val_loss: 3.6549 - val_accuracy1000: 0.3198 - 18s/epoch - 46ms/step
testing model: results/CHTR/W3/deepLOB_L2/h1000
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127863
{'0': {'precision': 0.24949775593075443, 'recall': 0.07081245678098727, 'f1-score': 0.1103152403991533, 'support': 82429}, '1': {'precision': 0.4025449070923302, 'recall': 0.1693916514796494, 'f1-score': 0.23844514075947204, 'support': 115230}, '2': {'precision': 0.3209843392302056, 'recall': 0.7507184978604731, 'f1-score': 0.44969346472532973, 'support': 93946}, 'accuracy': 0.32881123437526794, 'macro avg': {'precision': 0.3243423340844301, 'recall': 0.3303075353737032, 'f1-score': 0.2661512819613184, 'support': 291605}, 'weighted avg': {'precision': 0.3330062752736965, 'recall': 0.32881123437526794, 'f1-score': 0.2702838111749168, 'support': 291605}}
[[ 5837 13582 63010]
 [ 9527 19519 86184]
 [ 8031 15388 70527]]
Evaluating performance on  train set...
385/385 - 6s - 6s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1223269
{'0': {'precision': 0.3428376800311405, 'recall': 0.11186257699879341, 'f1-score': 0.16868565956428058, 'support': 31494}, '1': {'precision': 0.32276607854297096, 'recall': 0.1753989855251763, 'f1-score': 0.2272854795398982, 'support': 32332}, '2': {'precision': 0.3561843764612529, 'recall': 0.7266499002688405, 'f1-score': 0.478044234828747, 'support': 34593}, 'accuracy': 0.3488249220170902, 'macro avg': {'precision': 0.34059604501178814, 'recall': 0.33797048759760334, 'f1-score': 0.2913384579776419, 'support': 98419}, 'weighted avg': {'precision': 0.3409350723059185, 'recall': 0.3488249220170902, 'f1-score': 0.2966720298136771, 'support': 98419}}
[[ 3523  5988 21983]
 [ 3208  5671 23453]
 [ 3545  5911 25137]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1297662
{'0': {'precision': 0.3133369041242635, 'recall': 0.15079910637566593, 'f1-score': 0.2036080979175126, 'support': 11638}, '1': {'precision': 0.4041208147974713, 'recall': 0.26343101343101344, 'f1-score': 0.31895038344266846, 'support': 13104}, '2': {'precision': 0.30323158093084607, 'recall': 0.6056073007808825, 'f1-score': 0.40411840411840416, 'support': 10629}, 'accuracy': 0.3291962342031608, 'macro avg': {'precision': 0.34022976661752696, 'recall': 0.3399458068625207, 'f1-score': 0.30889229515952843, 'support': 35371}, 'weighted avg': {'precision': 0.3439332368612198, 'recall': 0.3291962342031608, 'f1-score': 0.3065927280984778, 'support': 35371}}
[[1755 2624 7259]
 [2120 3452 7532]
 [1726 2466 6437]]
training model: results/CHTR/W3/deepOF_L2/h10
Epoch 1/50
385/385 - 14s - loss: 3.2965 - accuracy10: 0.3742 - val_loss: 3.2611 - val_accuracy10: 0.3952 - 14s/epoch - 36ms/step
Epoch 2/50
385/385 - 11s - loss: 3.2290 - accuracy10: 0.4137 - val_loss: 3.2302 - val_accuracy10: 0.4129 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.1877 - accuracy10: 0.4333 - val_loss: 3.2102 - val_accuracy10: 0.4231 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 11s - loss: 3.1616 - accuracy10: 0.4425 - val_loss: 3.1881 - val_accuracy10: 0.4290 - 11s/epoch - 28ms/step
Epoch 5/50
385/385 - 11s - loss: 3.1442 - accuracy10: 0.4507 - val_loss: 3.1805 - val_accuracy10: 0.4346 - 11s/epoch - 28ms/step
Epoch 6/50
385/385 - 11s - loss: 3.1253 - accuracy10: 0.4559 - val_loss: 3.1739 - val_accuracy10: 0.4389 - 11s/epoch - 28ms/step
Epoch 7/50
385/385 - 11s - loss: 3.1110 - accuracy10: 0.4626 - val_loss: 3.1675 - val_accuracy10: 0.4424 - 11s/epoch - 28ms/step
Epoch 8/50
385/385 - 11s - loss: 3.0991 - accuracy10: 0.4674 - val_loss: 3.1641 - val_accuracy10: 0.4422 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 11s - loss: 3.0878 - accuracy10: 0.4711 - val_loss: 3.1589 - val_accuracy10: 0.4484 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.0764 - accuracy10: 0.4763 - val_loss: 3.1585 - val_accuracy10: 0.4455 - 11s/epoch - 27ms/step
Epoch 11/50
385/385 - 11s - loss: 3.0691 - accuracy10: 0.4792 - val_loss: 3.1615 - val_accuracy10: 0.4475 - 11s/epoch - 28ms/step
Epoch 12/50
385/385 - 11s - loss: 3.0581 - accuracy10: 0.4833 - val_loss: 3.1619 - val_accuracy10: 0.4470 - 11s/epoch - 27ms/step
Epoch 13/50
385/385 - 11s - loss: 3.0491 - accuracy10: 0.4878 - val_loss: 3.1611 - val_accuracy10: 0.4460 - 11s/epoch - 28ms/step
Epoch 14/50
385/385 - 11s - loss: 3.0389 - accuracy10: 0.4897 - val_loss: 3.1516 - val_accuracy10: 0.4537 - 11s/epoch - 28ms/step
Epoch 15/50
385/385 - 11s - loss: 3.0309 - accuracy10: 0.4936 - val_loss: 3.1594 - val_accuracy10: 0.4508 - 11s/epoch - 28ms/step
Epoch 16/50
385/385 - 11s - loss: 3.0200 - accuracy10: 0.4984 - val_loss: 3.1571 - val_accuracy10: 0.4516 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 11s - loss: 3.0131 - accuracy10: 0.4994 - val_loss: 3.1533 - val_accuracy10: 0.4551 - 11s/epoch - 28ms/step
Epoch 18/50
385/385 - 10s - loss: 3.0020 - accuracy10: 0.5031 - val_loss: 3.1659 - val_accuracy10: 0.4500 - 10s/epoch - 27ms/step
Epoch 19/50
385/385 - 10s - loss: 2.9936 - accuracy10: 0.5068 - val_loss: 3.1619 - val_accuracy10: 0.4518 - 10s/epoch - 26ms/step
Epoch 20/50
385/385 - 10s - loss: 2.9845 - accuracy10: 0.5084 - val_loss: 3.1668 - val_accuracy10: 0.4527 - 10s/epoch - 27ms/step
Epoch 21/50
385/385 - 11s - loss: 2.9744 - accuracy10: 0.5125 - val_loss: 3.1679 - val_accuracy10: 0.4510 - 11s/epoch - 28ms/step
Epoch 22/50
385/385 - 11s - loss: 2.9656 - accuracy10: 0.5136 - val_loss: 3.1767 - val_accuracy10: 0.4497 - 11s/epoch - 28ms/step
Epoch 23/50
385/385 - 10s - loss: 2.9535 - accuracy10: 0.5180 - val_loss: 3.1849 - val_accuracy10: 0.4468 - 10s/epoch - 27ms/step
Epoch 24/50
385/385 - 11s - loss: 2.9479 - accuracy10: 0.5207 - val_loss: 3.1948 - val_accuracy10: 0.4456 - 11s/epoch - 28ms/step
testing model: results/CHTR/W3/deepOF_L2/h10
Evaluating performance on  test set...
1140/1140 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0703797
{'0': {'precision': 0.44301396244583535, 'recall': 0.44585610729929837, 'f1-score': 0.44443049102097204, 'support': 103188}, '1': {'precision': 0.4470272370791677, 'recall': 0.269664358018114, 'f1-score': 0.3363994045087197, 'support': 93850}, '2': {'precision': 0.41236264364748315, 'recall': 0.5718515698529023, 'f1-score': 0.47918475852902076, 'support': 94563}, 'accuracy': 0.43000881341284836, 'macro avg': {'precision': 0.43413461439082873, 'recall': 0.4291240117234382, 'f1-score': 0.4200048846862375, 'support': 291601}, 'weighted avg': {'precision': 0.43436572449332367, 'recall': 0.43000881341284836, 'f1-score': 0.4209317730096783, 'support': 291601}}
[[46007 17853 39328]
 [30809 25308 37733]
 [27034 13453 54076]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0179889
{'0': {'precision': 0.5056909943859109, 'recall': 0.3966879826254826, 'f1-score': 0.4446059704520099, 'support': 33152}, '1': {'precision': 0.5307932590335891, 'recall': 0.4240949006316438, 'f1-score': 0.4714828897338403, 'support': 32455}, '2': {'precision': 0.44940943611368084, 'recall': 0.6366462466855628, 'f1-score': 0.5268879584321243, 'support': 32811}, 'accuracy': 0.48572415615029774, 'macro avg': {'precision': 0.4952978965110603, 'recall': 0.48580970998089645, 'f1-score': 0.48099227287265817, 'support': 98418}, 'weighted avg': {'precision': 0.4952055119606458, 'recall': 0.48572415615029774, 'f1-score': 0.4809005986999659, 'support': 98418}}
[[13151  6741 13260]
 [ 6359 13764 12332]
 [ 6496  5426 20889]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0503178
{'0': {'precision': 0.46118050453098214, 'recall': 0.4474809885931559, 'f1-score': 0.45422747557592574, 'support': 12624}, '1': {'precision': 0.5008827238335435, 'recall': 0.34866573033707865, 'f1-score': 0.411137563399234, 'support': 11392}, '2': {'precision': 0.4198920484465508, 'recall': 0.5617789520035227, 'f1-score': 0.48058160997476174, 'support': 11355}, 'accuracy': 0.4523479686749032, 'macro avg': {'precision': 0.4606517589370254, 'recall': 0.4526418903112524, 'f1-score': 0.44864888298330713, 'support': 35371}, 'weighted avg': {'precision': 0.4607128124514837, 'recall': 0.4523479686749032, 'f1-score': 0.44880978641197533, 'support': 35371}}
[[5649 2186 4789]
 [3396 3972 4024]
 [3204 1772 6379]]
training model: results/CHTR/W3/deepOF_L2/h20
Epoch 1/50
385/385 - 12s - loss: 3.3067 - accuracy20: 0.3713 - val_loss: 3.2760 - val_accuracy20: 0.3889 - 12s/epoch - 32ms/step
Epoch 2/50
385/385 - 11s - loss: 3.2463 - accuracy20: 0.4053 - val_loss: 3.2524 - val_accuracy20: 0.4032 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.2146 - accuracy20: 0.4193 - val_loss: 3.2365 - val_accuracy20: 0.4090 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 11s - loss: 3.1943 - accuracy20: 0.4306 - val_loss: 3.2166 - val_accuracy20: 0.4178 - 11s/epoch - 28ms/step
Epoch 5/50
385/385 - 10s - loss: 3.1767 - accuracy20: 0.4392 - val_loss: 3.2119 - val_accuracy20: 0.4199 - 10s/epoch - 26ms/step
Epoch 6/50
385/385 - 10s - loss: 3.1599 - accuracy20: 0.4456 - val_loss: 3.2001 - val_accuracy20: 0.4247 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 11s - loss: 3.1486 - accuracy20: 0.4503 - val_loss: 3.1986 - val_accuracy20: 0.4289 - 11s/epoch - 28ms/step
Epoch 8/50
385/385 - 11s - loss: 3.1385 - accuracy20: 0.4550 - val_loss: 3.1882 - val_accuracy20: 0.4320 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 10s - loss: 3.1281 - accuracy20: 0.4593 - val_loss: 3.1865 - val_accuracy20: 0.4359 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.1196 - accuracy20: 0.4642 - val_loss: 3.1779 - val_accuracy20: 0.4413 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.1104 - accuracy20: 0.4663 - val_loss: 3.1799 - val_accuracy20: 0.4397 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.1004 - accuracy20: 0.4703 - val_loss: 3.1780 - val_accuracy20: 0.4432 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 10s - loss: 3.0937 - accuracy20: 0.4732 - val_loss: 3.1703 - val_accuracy20: 0.4446 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.0847 - accuracy20: 0.4752 - val_loss: 3.1757 - val_accuracy20: 0.4444 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 10s - loss: 3.0748 - accuracy20: 0.4800 - val_loss: 3.1810 - val_accuracy20: 0.4415 - 10s/epoch - 26ms/step
Epoch 16/50
385/385 - 11s - loss: 3.0668 - accuracy20: 0.4826 - val_loss: 3.1778 - val_accuracy20: 0.4456 - 11s/epoch - 27ms/step
Epoch 17/50
385/385 - 10s - loss: 3.0608 - accuracy20: 0.4853 - val_loss: 3.1753 - val_accuracy20: 0.4493 - 10s/epoch - 27ms/step
Epoch 18/50
385/385 - 10s - loss: 3.0489 - accuracy20: 0.4895 - val_loss: 3.1790 - val_accuracy20: 0.4453 - 10s/epoch - 27ms/step
Epoch 19/50
385/385 - 10s - loss: 3.0367 - accuracy20: 0.4941 - val_loss: 3.1870 - val_accuracy20: 0.4403 - 10s/epoch - 27ms/step
Epoch 20/50
385/385 - 11s - loss: 3.0295 - accuracy20: 0.4964 - val_loss: 3.1881 - val_accuracy20: 0.4445 - 11s/epoch - 28ms/step
Epoch 21/50
385/385 - 11s - loss: 3.0201 - accuracy20: 0.4998 - val_loss: 3.1886 - val_accuracy20: 0.4468 - 11s/epoch - 28ms/step
Epoch 22/50
385/385 - 10s - loss: 3.0097 - accuracy20: 0.5036 - val_loss: 3.1989 - val_accuracy20: 0.4425 - 10s/epoch - 26ms/step
Epoch 23/50
385/385 - 10s - loss: 2.9996 - accuracy20: 0.5063 - val_loss: 3.2019 - val_accuracy20: 0.4430 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepOF_L2/h20
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0717964
{'0': {'precision': 0.4134742626916496, 'recall': 0.4979545846741039, 'f1-score': 0.4517991839892427, 'support': 98513}, '1': {'precision': 0.4705357142857143, 'recall': 0.23207299838191017, 'f1-score': 0.31083768843531817, 'support': 97646}, '2': {'precision': 0.4225801282051282, 'recall': 0.5525659562875883, 'f1-score': 0.47890956311693506, 'support': 95442}, 'accuracy': 0.42679551853388703, 'macro avg': {'precision': 0.4355300350608307, 'recall': 0.42753117978120087, 'f1-score': 0.4138488118471653, 'support': 291601}, 'weighted avg': {'precision': 0.4355623368707212, 'recall': 0.42679551853388703, 'f1-score': 0.41346990051575216, 'support': 291601}}
[[49055 13851 35607]
 [38530 22661 36455]
 [31056 11648 52738]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0326234
{'0': {'precision': 0.48116215512753774, 'recall': 0.4403585040495474, 'f1-score': 0.45985696517412933, 'support': 33584}, '1': {'precision': 0.5231543325318372, 'recall': 0.3626234567901235, 'f1-score': 0.4283422654854351, 'support': 32400}, '2': {'precision': 0.4378206262161684, 'recall': 0.610470493926127, 'f1-score': 0.5099281464884494, 'support': 32434}, 'accuracy': 0.4708285069804304, 'macro avg': {'precision': 0.48071237129184774, 'recall': 0.47115081825526595, 'f1-score': 0.46604245904933794, 'support': 98418}, 'weighted avg': {'precision': 0.48070296472728524, 'recall': 0.4708285069804304, 'f1-score': 0.46598320656122283, 'support': 98418}}
[[14789  5858 12937]
 [ 8164 11749 12487]
 [ 7783  4851 19800]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0574175
{'0': {'precision': 0.43686229104855634, 'recall': 0.4865017326134257, 'f1-score': 0.4603477199938996, 'support': 12409}, '1': {'precision': 0.509674582233949, 'recall': 0.2963689055574497, 'f1-score': 0.3747978872480328, 'support': 11732}, '2': {'precision': 0.4172437202987101, 'recall': 0.5472840605520926, 'f1-score': 0.473497688751926, 'support': 11230}, 'accuracy': 0.4427355743405615, 'macro avg': {'precision': 0.4545935311937385, 'recall': 0.44338489957432264, 'f1-score': 0.4362144319979528, 'support': 35371}, 'weighted avg': {'precision': 0.454784239838985, 'recall': 0.4427355743405615, 'f1-score': 0.43614720294258996, 'support': 35371}}
[[6037 1847 4525]
 [4196 3477 4059]
 [3586 1498 6146]]
training model: results/CHTR/W3/deepOF_L2/h30
Epoch 1/50
385/385 - 12s - loss: 3.3146 - accuracy30: 0.3646 - val_loss: 3.2856 - val_accuracy30: 0.3831 - 12s/epoch - 32ms/step
Epoch 2/50
385/385 - 10s - loss: 3.2587 - accuracy30: 0.3988 - val_loss: 3.2673 - val_accuracy30: 0.3962 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 10s - loss: 3.2325 - accuracy30: 0.4138 - val_loss: 3.2575 - val_accuracy30: 0.4032 - 10s/epoch - 27ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2140 - accuracy30: 0.4224 - val_loss: 3.2480 - val_accuracy30: 0.4044 - 10s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2000 - accuracy30: 0.4299 - val_loss: 3.2398 - val_accuracy30: 0.4112 - 10s/epoch - 26ms/step
Epoch 6/50
385/385 - 10s - loss: 3.1847 - accuracy30: 0.4362 - val_loss: 3.2375 - val_accuracy30: 0.4153 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 11s - loss: 3.1752 - accuracy30: 0.4416 - val_loss: 3.2283 - val_accuracy30: 0.4202 - 11s/epoch - 27ms/step
Epoch 8/50
385/385 - 10s - loss: 3.1654 - accuracy30: 0.4456 - val_loss: 3.2282 - val_accuracy30: 0.4201 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 10s - loss: 3.1547 - accuracy30: 0.4496 - val_loss: 3.2235 - val_accuracy30: 0.4246 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.1450 - accuracy30: 0.4556 - val_loss: 3.2237 - val_accuracy30: 0.4259 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.1377 - accuracy30: 0.4599 - val_loss: 3.2235 - val_accuracy30: 0.4270 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.1269 - accuracy30: 0.4620 - val_loss: 3.2252 - val_accuracy30: 0.4274 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 10s - loss: 3.1207 - accuracy30: 0.4648 - val_loss: 3.2247 - val_accuracy30: 0.4289 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.1135 - accuracy30: 0.4676 - val_loss: 3.2169 - val_accuracy30: 0.4311 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 10s - loss: 3.1029 - accuracy30: 0.4721 - val_loss: 3.2185 - val_accuracy30: 0.4326 - 10s/epoch - 26ms/step
Epoch 16/50
385/385 - 10s - loss: 3.0928 - accuracy30: 0.4755 - val_loss: 3.2183 - val_accuracy30: 0.4348 - 10s/epoch - 26ms/step
Epoch 17/50
385/385 - 10s - loss: 3.0821 - accuracy30: 0.4796 - val_loss: 3.2297 - val_accuracy30: 0.4312 - 10s/epoch - 26ms/step
Epoch 18/50
385/385 - 10s - loss: 3.0751 - accuracy30: 0.4824 - val_loss: 3.2194 - val_accuracy30: 0.4356 - 10s/epoch - 27ms/step
Epoch 19/50
385/385 - 10s - loss: 3.0643 - accuracy30: 0.4866 - val_loss: 3.2287 - val_accuracy30: 0.4315 - 10s/epoch - 26ms/step
Epoch 20/50
385/385 - 10s - loss: 3.0558 - accuracy30: 0.4870 - val_loss: 3.2275 - val_accuracy30: 0.4331 - 10s/epoch - 27ms/step
Epoch 21/50
385/385 - 10s - loss: 3.0441 - accuracy30: 0.4935 - val_loss: 3.2275 - val_accuracy30: 0.4375 - 10s/epoch - 27ms/step
Epoch 22/50
385/385 - 10s - loss: 3.0324 - accuracy30: 0.4966 - val_loss: 3.2333 - val_accuracy30: 0.4325 - 10s/epoch - 26ms/step
Epoch 23/50
385/385 - 10s - loss: 3.0220 - accuracy30: 0.5011 - val_loss: 3.2327 - val_accuracy30: 0.4348 - 10s/epoch - 27ms/step
Epoch 24/50
385/385 - 10s - loss: 3.0117 - accuracy30: 0.5041 - val_loss: 3.2396 - val_accuracy30: 0.4327 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepOF_L2/h30
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081586
{'0': {'precision': 0.4060907775671037, 'recall': 0.46971697034580967, 'f1-score': 0.4355926975497851, 'support': 96209}, '1': {'precision': 0.4813209444896786, 'recall': 0.20218491283485399, 'f1-score': 0.2847549356435994, 'support': 99409}, '2': {'precision': 0.4156683025404157, 'recall': 0.6000541762603795, 'f1-score': 0.4911252947220765, 'support': 95983}, 'accuracy': 0.4214148785497992, 'macro avg': {'precision': 0.434360008199066, 'recall': 0.42398535314701435, 'f1-score': 0.4038243093051537, 'support': 291601}, 'weighted avg': {'precision': 0.43488983944658854, 'recall': 0.4214148785497992, 'f1-score': 0.4024499929673455, 'support': 291601}}
[[45191 11861 39157]
 [37502 20099 41808]
 [28590  9798 57595]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0442599
{'0': {'precision': 0.48515017994685683, 'recall': 0.42687185557857354, 'f1-score': 0.45414902158341336, 'support': 33790}, '1': {'precision': 0.5183983250457995, 'recall': 0.30672984607761156, 'f1-score': 0.3854146398412266, 'support': 32289}, '2': {'precision': 0.42339962083014, 'recall': 0.6491542719317233, 'f1-score': 0.5125181577373323, 'support': 32339}, 'accuracy': 0.46049503139669573, 'macro avg': {'precision': 0.4756493752742655, 'recall': 0.46091865786263614, 'f1-score': 0.45069393972065747, 'support': 98418}, 'weighted avg': {'precision': 0.4757677298444797, 'recall': 0.46049503139669573, 'f1-score': 0.45077804312427094, 'support': 98418}}
[[14424  5143 14223]
 [ 8019  9904 14366]
 [ 7288  4058 20993]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0729069
{'0': {'precision': 0.43232738911751256, 'recall': 0.45927784974093266, 'f1-score': 0.44539530501687996, 'support': 12352}, '1': {'precision': 0.5021221025138752, 'recall': 0.259599966241877, 'f1-score': 0.34225312934631436, 'support': 11849}, '2': {'precision': 0.39949140978726044, 'recall': 0.5766338406445837, 'f1-score': 0.47198915472831865, 'support': 11170}, 'accuracy': 0.4294478527607362, 'macro avg': {'precision': 0.44464696713954943, 'recall': 0.43183721887579773, 'f1-score': 0.4198791963638377, 'support': 35371}, 'weighted avg': {'precision': 0.44533860366939365, 'recall': 0.4294478527607362, 'f1-score': 0.41924172331877246, 'support': 35371}}
[[5673 1699 4980]
 [4071 3076 4702]
 [3378 1351 6441]]
training model: results/CHTR/W3/deepOF_L2/h50
Epoch 1/50
385/385 - 13s - loss: 3.3215 - accuracy50: 0.3581 - val_loss: 3.3156 - val_accuracy50: 0.3669 - 13s/epoch - 33ms/step
Epoch 2/50
385/385 - 10s - loss: 3.2731 - accuracy50: 0.3898 - val_loss: 3.2992 - val_accuracy50: 0.3793 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 10s - loss: 3.2475 - accuracy50: 0.4048 - val_loss: 3.2867 - val_accuracy50: 0.3890 - 10s/epoch - 27ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2322 - accuracy50: 0.4142 - val_loss: 3.2827 - val_accuracy50: 0.3909 - 10s/epoch - 26ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2216 - accuracy50: 0.4196 - val_loss: 3.2808 - val_accuracy50: 0.3913 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2093 - accuracy50: 0.4261 - val_loss: 3.2806 - val_accuracy50: 0.3931 - 11s/epoch - 28ms/step
Epoch 7/50
385/385 - 10s - loss: 3.1999 - accuracy50: 0.4310 - val_loss: 3.2773 - val_accuracy50: 0.3969 - 10s/epoch - 27ms/step
Epoch 8/50
385/385 - 10s - loss: 3.1929 - accuracy50: 0.4349 - val_loss: 3.2757 - val_accuracy50: 0.3976 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 10s - loss: 3.1810 - accuracy50: 0.4401 - val_loss: 3.2764 - val_accuracy50: 0.4024 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.1744 - accuracy50: 0.4435 - val_loss: 3.2711 - val_accuracy50: 0.4028 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.1674 - accuracy50: 0.4465 - val_loss: 3.2728 - val_accuracy50: 0.4022 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.1586 - accuracy50: 0.4514 - val_loss: 3.2787 - val_accuracy50: 0.4036 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 10s - loss: 3.1508 - accuracy50: 0.4550 - val_loss: 3.2830 - val_accuracy50: 0.4033 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.1436 - accuracy50: 0.4573 - val_loss: 3.2873 - val_accuracy50: 0.4038 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 10s - loss: 3.1331 - accuracy50: 0.4613 - val_loss: 3.2865 - val_accuracy50: 0.4036 - 10s/epoch - 27ms/step
Epoch 16/50
385/385 - 10s - loss: 3.1234 - accuracy50: 0.4660 - val_loss: 3.2890 - val_accuracy50: 0.4071 - 10s/epoch - 27ms/step
Epoch 17/50
385/385 - 10s - loss: 3.1168 - accuracy50: 0.4675 - val_loss: 3.3002 - val_accuracy50: 0.4054 - 10s/epoch - 27ms/step
Epoch 18/50
385/385 - 10s - loss: 3.1076 - accuracy50: 0.4719 - val_loss: 3.3020 - val_accuracy50: 0.4048 - 10s/epoch - 26ms/step
Epoch 19/50
385/385 - 10s - loss: 3.0956 - accuracy50: 0.4750 - val_loss: 3.3041 - val_accuracy50: 0.4052 - 10s/epoch - 27ms/step
Epoch 20/50
385/385 - 10s - loss: 3.0845 - accuracy50: 0.4801 - val_loss: 3.3054 - val_accuracy50: 0.4086 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepOF_L2/h50
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0902786
{'0': {'precision': 0.3963945178473262, 'recall': 0.4443098759136495, 'f1-score': 0.4189867457447128, 'support': 94128}, '1': {'precision': 0.4493537721671175, 'recall': 0.14767765770393346, 'f1-score': 0.2222982216142271, 'support': 101234}, '2': {'precision': 0.3985997055455586, 'recall': 0.6329658454472719, 'f1-score': 0.4891594128416792, 'support': 96239}, 'accuracy': 0.40359258027235845, 'macro avg': {'precision': 0.41478266518666745, 'recall': 0.40831779302161825, 'f1-score': 0.3768147934002064, 'support': 291601}, 'weighted avg': {'precision': 0.4155079715415863, 'recall': 0.40359258027235845, 'f1-score': 0.3738626935532572, 'support': 291601}}
[[41822  9619 42687]
 [37062 14950 49222]
 [26622  8701 60916]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0667872
{'0': {'precision': 0.4688130221838087, 'recall': 0.38759043677613364, 'f1-score': 0.42435009371689353, 'support': 33587}, '1': {'precision': 0.4789803220035778, 'recall': 0.2304075235109718, 'f1-score': 0.3111433907449679, 'support': 32538}, '2': {'precision': 0.40096003491036036, 'recall': 0.682872449137584, 'f1-score': 0.5052525460814975, 'support': 32293}, 'accuracy': 0.4325123453026885, 'macro avg': {'precision': 0.44958445969924893, 'recall': 0.4336234698082298, 'f1-score': 0.4135820101811197, 'support': 98418}, 'weighted avg': {'precision': 0.44991045439655614, 'recall': 0.4325123453026885, 'f1-score': 0.41346858010057985, 'support': 98418}}
[[13018  4460 16109]
 [ 8204  7497 16837]
 [ 6546  3695 22052]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922008
{'0': {'precision': 0.4163855421686747, 'recall': 0.4279346210995542, 'f1-score': 0.42208109428431845, 'support': 12114}, '1': {'precision': 0.4531850353892821, 'recall': 0.18349299926308033, 'f1-score': 0.26121925632358084, 'support': 12213}, '2': {'precision': 0.3763907432131731, 'recall': 0.6126403477001087, 'f1-score': 0.46629910406616126, 'support': 11044}, 'accuracy': 0.40120437646659696, 'macro avg': {'precision': 0.41532044025704334, 'recall': 0.40802265602091436, 'f1-score': 0.3831998182246868, 'support': 35371}, 'weighted avg': {'precision': 0.41660407291529533, 'recall': 0.40120437646659696, 'f1-score': 0.38034458904036667, 'support': 35371}}
[[5184 1447 5483]
 [4245 2241 5727]
 [3021 1257 6766]]
training model: results/CHTR/W3/deepOF_L2/h100
Epoch 1/50
385/385 - 12s - loss: 3.3345 - accuracy100: 0.3492 - val_loss: 3.3369 - val_accuracy100: 0.3487 - 12s/epoch - 32ms/step
Epoch 2/50
385/385 - 11s - loss: 3.2925 - accuracy100: 0.3729 - val_loss: 3.3152 - val_accuracy100: 0.3582 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.2719 - accuracy100: 0.3872 - val_loss: 3.3121 - val_accuracy100: 0.3628 - 11s/epoch - 27ms/step
Epoch 4/50
385/385 - 11s - loss: 3.2600 - accuracy100: 0.3952 - val_loss: 3.3101 - val_accuracy100: 0.3642 - 11s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2512 - accuracy100: 0.4031 - val_loss: 3.3121 - val_accuracy100: 0.3635 - 10s/epoch - 26ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2414 - accuracy100: 0.4068 - val_loss: 3.3065 - val_accuracy100: 0.3707 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2354 - accuracy100: 0.4106 - val_loss: 3.3047 - val_accuracy100: 0.3708 - 11s/epoch - 27ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2275 - accuracy100: 0.4163 - val_loss: 3.3062 - val_accuracy100: 0.3711 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2222 - accuracy100: 0.4180 - val_loss: 3.3049 - val_accuracy100: 0.3738 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2141 - accuracy100: 0.4236 - val_loss: 3.3046 - val_accuracy100: 0.3768 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2060 - accuracy100: 0.4268 - val_loss: 3.3060 - val_accuracy100: 0.3781 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2002 - accuracy100: 0.4292 - val_loss: 3.3094 - val_accuracy100: 0.3777 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 10s - loss: 3.1920 - accuracy100: 0.4344 - val_loss: 3.3123 - val_accuracy100: 0.3803 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.1848 - accuracy100: 0.4378 - val_loss: 3.3124 - val_accuracy100: 0.3793 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 10s - loss: 3.1735 - accuracy100: 0.4414 - val_loss: 3.3177 - val_accuracy100: 0.3786 - 10s/epoch - 27ms/step
Epoch 16/50
385/385 - 10s - loss: 3.1646 - accuracy100: 0.4474 - val_loss: 3.3265 - val_accuracy100: 0.3796 - 10s/epoch - 26ms/step
Epoch 17/50
385/385 - 11s - loss: 3.1565 - accuracy100: 0.4504 - val_loss: 3.3285 - val_accuracy100: 0.3794 - 11s/epoch - 27ms/step
Epoch 18/50
385/385 - 11s - loss: 3.1446 - accuracy100: 0.4542 - val_loss: 3.3408 - val_accuracy100: 0.3777 - 11s/epoch - 28ms/step
Epoch 19/50
385/385 - 11s - loss: 3.1391 - accuracy100: 0.4574 - val_loss: 3.3433 - val_accuracy100: 0.3790 - 11s/epoch - 27ms/step
Epoch 20/50
385/385 - 11s - loss: 3.1217 - accuracy100: 0.4636 - val_loss: 3.3626 - val_accuracy100: 0.3786 - 11s/epoch - 28ms/step
testing model: results/CHTR/W3/deepOF_L2/h100
Evaluating performance on  test set...
1140/1140 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1050098
{'0': {'precision': 0.3725317163527068, 'recall': 0.45654292169481, 'f1-score': 0.41028083697791123, 'support': 93391}, '1': {'precision': 0.40315101696701444, 'recall': 0.07478471658830774, 'f1-score': 0.12616564290720206, 'support': 102307}, '2': {'precision': 0.3714334486094164, 'recall': 0.612598146043398, 'f1-score': 0.4624636916803766, 'support': 95903}, 'accuracy': 0.37392875881769955, 'macro avg': {'precision': 0.38237206064304585, 'recall': 0.3813085947755052, 'f1-score': 0.33297005718849665, 'support': 291601}, 'weighted avg': {'precision': 0.38291316777627254, 'recall': 0.37392875881769955, 'f1-score': 0.3277623241975658, 'support': 291601}}
[[42637  5789 44965]
 [40200  7651 54456]
 [31615  5538 58750]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0770425
{'0': {'precision': 0.44919895234531787, 'recall': 0.3961007798440312, 'f1-score': 0.4209821642040836, 'support': 33340}, '1': {'precision': 0.45436644678546817, 'recall': 0.1419737894542546, 'f1-score': 0.21634671729601762, 'support': 32506}, '2': {'precision': 0.3886887975264177, 'recall': 0.7024131155593761, 'f1-score': 0.5004484108756042, 'support': 32572}, 'accuracy': 0.4135422382084578, 'macro avg': {'precision': 0.43075139888573455, 'recall': 0.413495894952554, 'f1-score': 0.3792590974585685, 'support': 98418}, 'weighted avg': {'precision': 0.43087951699314964, 'recall': 0.4135422382084578, 'f1-score': 0.3796939318623491, 'support': 98418}}
[[13206  2939 17195]
 [ 9103  4615 18788]
 [ 7090  2603 22879]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010779
{'0': {'precision': 0.37932557797084376, 'recall': 0.4406054904643804, 'f1-score': 0.407675568743818, 'support': 11693}, '1': {'precision': 0.4805318138651472, 'recall': 0.1187514667918329, 'f1-score': 0.190440346255175, 'support': 12783}, '2': {'precision': 0.35979602791196996, 'recall': 0.6152363469481413, 'f1-score': 0.4540558848433531, 'support': 10895}, 'accuracy': 0.3780780865680925, 'macro avg': {'precision': 0.40655113991598696, 'recall': 0.3915311014014516, 'f1-score': 0.35072393328078205, 'support': 35371}, 'weighted avg': {'precision': 0.4098857788570344, 'recall': 0.3780780865680925, 'f1-score': 0.3434533441765768, 'support': 35371}}
[[5152  871 5670]
 [5008 1518 6257]
 [3422  770 6703]]
training model: results/CHTR/W3/deepOF_L2/h200
Epoch 1/50
385/385 - 12s - loss: 3.3397 - accuracy200: 0.3413 - val_loss: 3.3412 - val_accuracy200: 0.3363 - 12s/epoch - 31ms/step
Epoch 2/50
385/385 - 10s - loss: 3.3067 - accuracy200: 0.3572 - val_loss: 3.3221 - val_accuracy200: 0.3439 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 10s - loss: 3.2918 - accuracy200: 0.3689 - val_loss: 3.3205 - val_accuracy200: 0.3470 - 10s/epoch - 26ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2799 - accuracy200: 0.3767 - val_loss: 3.3228 - val_accuracy200: 0.3418 - 10s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2727 - accuracy200: 0.3811 - val_loss: 3.3233 - val_accuracy200: 0.3412 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2656 - accuracy200: 0.3887 - val_loss: 3.3230 - val_accuracy200: 0.3453 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2593 - accuracy200: 0.3916 - val_loss: 3.3225 - val_accuracy200: 0.3451 - 10s/epoch - 27ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2539 - accuracy200: 0.3966 - val_loss: 3.3217 - val_accuracy200: 0.3499 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2472 - accuracy200: 0.3986 - val_loss: 3.3256 - val_accuracy200: 0.3504 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2412 - accuracy200: 0.4028 - val_loss: 3.3267 - val_accuracy200: 0.3498 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2350 - accuracy200: 0.4070 - val_loss: 3.3255 - val_accuracy200: 0.3501 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2272 - accuracy200: 0.4117 - val_loss: 3.3312 - val_accuracy200: 0.3507 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 10s - loss: 3.2225 - accuracy200: 0.4139 - val_loss: 3.3381 - val_accuracy200: 0.3462 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepOF_L2/h200
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.105138
{'0': {'precision': 0.3392065204362939, 'recall': 0.31105395632055044, 'f1-score': 0.3245208157742344, 'support': 90981}, '1': {'precision': 0.38486134169587405, 'recall': 0.11742083145730152, 'f1-score': 0.17994163899550075, 'support': 106608}, '2': {'precision': 0.3395029747502064, 'recall': 0.6343020039994894, 'f1-score': 0.4422803784066425, 'support': 94012}, 'accuracy': 0.34447755666132834, 'macro avg': {'precision': 0.3545236122941248, 'recall': 0.3542589305924471, 'f1-score': 0.31558094439212586, 'support': 291601}, 'weighted avg': {'precision': 0.3559932922505225, 'recall': 0.34447755666132834, 'f1-score': 0.3096289434012683, 'support': 291601}}
[[28300  9926 52755]
 [30832 12518 63258]
 [24298 10082 59632]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0944582
{'0': {'precision': 0.4032097713392984, 'recall': 0.2601087222086489, 'f1-score': 0.3162232906974586, 'support': 32744}, '1': {'precision': 0.37169473307058404, 'recall': 0.15981144283205473, 'f1-score': 0.223519779367405, 'support': 32457}, '2': {'precision': 0.3631828228607515, 'recall': 0.692536953969353, 'f1-score': 0.47648539204822016, 'support': 33217}, 'accuracy': 0.37298055233798694, 'macro avg': {'precision': 0.37936244242354467, 'recall': 0.37081903967001884, 'f1-score': 0.33874282070436124, 'support': 98418}, 'weighted avg': {'precision': 0.37930704272563465, 'recall': 0.37298055233798694, 'f1-score': 0.33974082156913543, 'support': 98418}}
[[ 8517  4552 19675]
 [ 6609  5187 20661]
 [ 5997  4216 23004]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 11ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057613
{'0': {'precision': 0.3554974348657077, 'recall': 0.3078129082832506, 'f1-score': 0.3299411819624685, 'support': 11481}, '1': {'precision': 0.4040468583599574, 'recall': 0.1437230093188878, 'f1-score': 0.21202637755672293, 'support': 13199}, '2': {'precision': 0.3211478176995418, 'recall': 0.6228603498269573, 'f1-score': 0.42378921911792783, 'support': 10691}, 'accuracy': 0.3418054338299737, 'macro avg': {'precision': 0.3602307036417356, 'recall': 0.3581320891430319, 'f1-score': 0.3219189262123731, 'support': 35371}, 'weighted avg': {'precision': 0.3632317958839747, 'recall': 0.3418054338299737, 'f1-score': 0.31430610978123474, 'support': 35371}}
[[3534 1465 6482]
 [3708 1897 7594]
 [2699 1333 6659]]
training model: results/CHTR/W3/deepOF_L2/h300
Epoch 1/50
385/385 - 13s - loss: 3.3439 - accuracy300: 0.3376 - val_loss: 3.3178 - val_accuracy300: 0.3512 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 11s - loss: 3.3134 - accuracy300: 0.3490 - val_loss: 3.3072 - val_accuracy300: 0.3550 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 10s - loss: 3.3002 - accuracy300: 0.3574 - val_loss: 3.3098 - val_accuracy300: 0.3496 - 10s/epoch - 27ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2917 - accuracy300: 0.3630 - val_loss: 3.3076 - val_accuracy300: 0.3487 - 10s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2858 - accuracy300: 0.3691 - val_loss: 3.3101 - val_accuracy300: 0.3457 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2812 - accuracy300: 0.3729 - val_loss: 3.3098 - val_accuracy300: 0.3475 - 10s/epoch - 26ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2754 - accuracy300: 0.3746 - val_loss: 3.3127 - val_accuracy300: 0.3435 - 10s/epoch - 27ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2705 - accuracy300: 0.3788 - val_loss: 3.3114 - val_accuracy300: 0.3450 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2662 - accuracy300: 0.3811 - val_loss: 3.3118 - val_accuracy300: 0.3479 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2619 - accuracy300: 0.3861 - val_loss: 3.3149 - val_accuracy300: 0.3466 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2564 - accuracy300: 0.3906 - val_loss: 3.3147 - val_accuracy300: 0.3476 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2527 - accuracy300: 0.3919 - val_loss: 3.3209 - val_accuracy300: 0.3417 - 10s/epoch - 26ms/step
testing model: results/CHTR/W3/deepOF_L2/h300
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1037624
{'0': {'precision': 0.3128738951744712, 'recall': 0.2237847163108493, 'f1-score': 0.26093458438653844, 'support': 88107}, '1': {'precision': 0.3866120218579235, 'recall': 0.3656396819660282, 'f1-score': 0.3758335035940489, 'support': 110680}, '2': {'precision': 0.33287330718447855, 'recall': 0.44438339043678754, 'f1-score': 0.3806293835363603, 'support': 92814}, 'accuracy': 0.3478417426552035, 'macro avg': {'precision': 0.34411974140562435, 'recall': 0.3446025962378883, 'f1-score': 0.3391324905056492, 'support': 291601}, 'weighted avg': {'precision': 0.3472275540700899, 'recall': 0.3478417426552035, 'f1-score': 0.3426433764214726, 'support': 291601}}
[[19717 32171 36219]
 [23769 40469 46442]
 [19533 32036 41245]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1002319
{'0': {'precision': 0.3657776238309664, 'recall': 0.1948699021959771, 'f1-score': 0.25427401878160366, 'support': 32514}, '1': {'precision': 0.3461038311493448, 'recall': 0.4248265700779667, 'f1-score': 0.3814458561860926, 'support': 32578}, '2': {'precision': 0.3627031234796147, 'recall': 0.4473984276540839, 'f1-score': 0.400623371040116, 'support': 33326}, 'accuracy': 0.3564998272673698, 'macro avg': {'precision': 0.358194859486642, 'recall': 0.3556982999760092, 'f1-score': 0.3454477486692708, 'support': 98418}, 'weighted avg': {'precision': 0.35822419237847786, 'recall': 0.3564998272673698, 'f1-score': 0.34592638554714067, 'support': 98418}}
[[ 6336 13134 13044]
 [ 5584 13840 13154]
 [ 5402 13014 14910]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.101793
{'0': {'precision': 0.3323302368180034, 'recall': 0.22757817399874564, 'f1-score': 0.2701552861093384, 'support': 11161}, '1': {'precision': 0.409398468287605, 'recall': 0.4025148037137218, 'f1-score': 0.40592745502801536, 'support': 13679}, '2': {'precision': 0.30730443308354927, 'recall': 0.4166745798119837, 'f1-score': 0.3537283353486497, 'support': 10531}, 'accuracy': 0.3515309151564841, 'macro avg': {'precision': 0.3496777127297192, 'recall': 0.34892251917481704, 'f1-score': 0.34327035882866785, 'support': 35371}, 'weighted avg': {'precision': 0.35468384850964757, 'recall': 0.3515309151564841, 'f1-score': 0.3475445394574985, 'support': 35371}}
[[2540 4104 4517]
 [2799 5506 5374]
 [2304 3839 4388]]
training model: results/CHTR/W3/deepOF_L2/h500
Epoch 1/50
385/385 - 12s - loss: 3.3470 - accuracy500: 0.3344 - val_loss: 3.3302 - val_accuracy500: 0.3470 - 12s/epoch - 31ms/step
Epoch 2/50
385/385 - 10s - loss: 3.3196 - accuracy500: 0.3421 - val_loss: 3.3231 - val_accuracy500: 0.3429 - 10s/epoch - 26ms/step
Epoch 3/50
385/385 - 10s - loss: 3.3067 - accuracy500: 0.3475 - val_loss: 3.3252 - val_accuracy500: 0.3315 - 10s/epoch - 27ms/step
Epoch 4/50
385/385 - 11s - loss: 3.2999 - accuracy500: 0.3515 - val_loss: 3.3252 - val_accuracy500: 0.3306 - 11s/epoch - 27ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2924 - accuracy500: 0.3563 - val_loss: 3.3227 - val_accuracy500: 0.3306 - 11s/epoch - 27ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2872 - accuracy500: 0.3632 - val_loss: 3.3279 - val_accuracy500: 0.3238 - 11s/epoch - 27ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2827 - accuracy500: 0.3645 - val_loss: 3.3290 - val_accuracy500: 0.3226 - 11s/epoch - 27ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2775 - accuracy500: 0.3705 - val_loss: 3.3313 - val_accuracy500: 0.3242 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2737 - accuracy500: 0.3733 - val_loss: 3.3310 - val_accuracy500: 0.3227 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2701 - accuracy500: 0.3777 - val_loss: 3.3341 - val_accuracy500: 0.3229 - 10s/epoch - 26ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2657 - accuracy500: 0.3807 - val_loss: 3.3358 - val_accuracy500: 0.3231 - 10s/epoch - 26ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2605 - accuracy500: 0.3854 - val_loss: 3.3377 - val_accuracy500: 0.3249 - 10s/epoch - 26ms/step
Epoch 13/50
385/385 - 10s - loss: 3.2552 - accuracy500: 0.3888 - val_loss: 3.3456 - val_accuracy500: 0.3213 - 10s/epoch - 26ms/step
Epoch 14/50
385/385 - 10s - loss: 3.2514 - accuracy500: 0.3909 - val_loss: 3.3510 - val_accuracy500: 0.3212 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 10s - loss: 3.2447 - accuracy500: 0.3953 - val_loss: 3.3489 - val_accuracy500: 0.3272 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepOF_L2/h500
Evaluating performance on  test set...
1140/1140 - 11s - 11s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1064066
{'0': {'precision': 0.2890568997930671, 'recall': 0.2547409323336949, 'f1-score': 0.27081617395491464, 'support': 83897}, '1': {'precision': 0.4042706680132737, 'recall': 0.18952761830679868, 'f1-score': 0.25806897266306317, 'support': 118273}, '2': {'precision': 0.308976919662672, 'recall': 0.5604432467488902, 'f1-score': 0.39834371162779614, 'support': 89431}, 'accuracy': 0.3220462206919729, 'macro avg': {'precision': 0.33410149582300425, 'recall': 0.33490393246312794, 'f1-score': 0.30907628608192467, 'support': 291601}, 'weighted avg': {'precision': 0.34189672306413654, 'recall': 0.3220462206919729, 'f1-score': 0.3047572972131761, 'support': 291601}}
[[21372 16101 46424]
 [30186 22416 65671]
 [22379 16931 50121]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0936406
{'0': {'precision': 0.3741248817407758, 'recall': 0.24634792088459742, 'f1-score': 0.2970795379847873, 'support': 32105}, '1': {'precision': 0.36403598446125535, 'recall': 0.21967921036397287, 'f1-score': 0.27400738688827336, 'support': 32420}, '2': {'precision': 0.36634092247981426, 'recall': 0.6238161272239106, 'f1-score': 0.46160227930180003, 'support': 33893}, 'accuracy': 0.3675547156008047, 'macro avg': {'precision': 0.36816726289394847, 'recall': 0.3632810861574936, 'f1-score': 0.3442297347249536, 'support': 98418}, 'weighted avg': {'precision': 0.3681208603114252, 'recall': 0.3675547156008047, 'f1-score': 0.3461373336411564, 'support': 98418}}
[[ 7909  6257 17939]
 [ 6666  7122 18632]
 [ 6565  6185 21143]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106287
{'0': {'precision': 0.326439045743051, 'recall': 0.2685935530343958, 'f1-score': 0.29470460383323455, 'support': 11106}, '1': {'precision': 0.4025102159953298, 'recall': 0.19936388607777938, 'f1-score': 0.2666537755003384, 'support': 13834}, '2': {'precision': 0.29910737320055725, 'recall': 0.5557472917265842, 'f1-score': 0.38890379712867307, 'support': 10431}, 'accuracy': 0.32619942891068954, 'macro avg': {'precision': 0.34268554497964604, 'recall': 0.34123491027958647, 'f1-score': 0.3167540588207487, 'support': 35371}, 'weighted avg': {'precision': 0.34813116338120864, 'recall': 0.32619942891068954, 'f1-score': 0.3115131935283926, 'support': 35371}}
[[2983 2173 5950]
 [3442 2758 7634]
 [2713 1921 5797]]
training model: results/CHTR/W3/deepOF_L2/h1000
Epoch 1/50
385/385 - 12s - loss: 3.3464 - accuracy1000: 0.3398 - val_loss: 3.3487 - val_accuracy1000: 0.3470 - 12s/epoch - 31ms/step
Epoch 2/50
385/385 - 10s - loss: 3.3171 - accuracy1000: 0.3485 - val_loss: 3.3344 - val_accuracy1000: 0.3440 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 10s - loss: 3.3021 - accuracy1000: 0.3540 - val_loss: 3.3326 - val_accuracy1000: 0.3399 - 10s/epoch - 26ms/step
Epoch 4/50
385/385 - 11s - loss: 3.2951 - accuracy1000: 0.3593 - val_loss: 3.3298 - val_accuracy1000: 0.3404 - 11s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2906 - accuracy1000: 0.3641 - val_loss: 3.3307 - val_accuracy1000: 0.3339 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2851 - accuracy1000: 0.3655 - val_loss: 3.3343 - val_accuracy1000: 0.3315 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2820 - accuracy1000: 0.3685 - val_loss: 3.3301 - val_accuracy1000: 0.3362 - 10s/epoch - 27ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2774 - accuracy1000: 0.3727 - val_loss: 3.3351 - val_accuracy1000: 0.3283 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2739 - accuracy1000: 0.3743 - val_loss: 3.3348 - val_accuracy1000: 0.3352 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2699 - accuracy1000: 0.3781 - val_loss: 3.3382 - val_accuracy1000: 0.3267 - 10s/epoch - 27ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2646 - accuracy1000: 0.3816 - val_loss: 3.3409 - val_accuracy1000: 0.3265 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2608 - accuracy1000: 0.3855 - val_loss: 3.3454 - val_accuracy1000: 0.3296 - 10s/epoch - 26ms/step
Epoch 13/50
385/385 - 10s - loss: 3.2546 - accuracy1000: 0.3916 - val_loss: 3.3464 - val_accuracy1000: 0.3296 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.2513 - accuracy1000: 0.3925 - val_loss: 3.3492 - val_accuracy1000: 0.3353 - 10s/epoch - 26ms/step
testing model: results/CHTR/W3/deepOF_L2/h1000
Evaluating performance on  test set...
1140/1140 - 12s - 12s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1004902
{'0': {'precision': 0.2600771800110257, 'recall': 0.09729703498811083, 'f1-score': 0.14161479715710945, 'support': 82428}, '1': {'precision': 0.39672200678623365, 'recall': 0.4545691226243166, 'f1-score': 0.4236801449474646, 'support': 115230}, '2': {'precision': 0.3240530714973744, 'recall': 0.444056502347168, 'f1-score': 0.374680588301336, 'support': 93943}, 'accuracy': 0.3501908429669308, 'macro avg': {'precision': 0.3269507527648779, 'recall': 0.3319742199865318, 'f1-score': 0.31332517680197003, 'support': 291601}, 'weighted avg': {'precision': 0.33468484789697006, 'recall': 0.3501908429669308, 'f1-score': 0.3281617899429528, 'support': 291601}}
[[ 8020 37954 36454]
 [12288 52380 50562]
 [10529 41698 41716]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0963304
{'0': {'precision': 0.36860976173953275, 'recall': 0.10124531418768663, 'f1-score': 0.15885754162097496, 'support': 31478}, '1': {'precision': 0.3471193024679629, 'recall': 0.5075474610279365, 'f1-score': 0.41227652265489834, 'support': 32395}, '2': {'precision': 0.3746727980191015, 'recall': 0.4599218410768563, 'f1-score': 0.41294346978557506, 'support': 34545}, 'accuracy': 0.36087910748033897, 'macro avg': {'precision': 0.36346728740886575, 'recall': 0.35623820543082646, 'f1-score': 0.32802584468714946, 'support': 98418}, 'weighted avg': {'precision': 0.3636641639848049, 'recall': 0.36087910748033897, 'f1-score': 0.33145712989791676, 'support': 98418}}
[[ 3187 15119 13172]
 [ 2608 16442 13345]
 [ 2851 15806 15888]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1050823
{'0': {'precision': 0.3243172268907563, 'recall': 0.10620001719838335, 'f1-score': 0.16000518235408434, 'support': 11629}, '1': {'precision': 0.37654247034862826, 'recall': 0.4798473282442748, 'f1-score': 0.4219641538564812, 'support': 13100}, '2': {'precision': 0.30237406685049434, 'recall': 0.42247697801165196, 'f1-score': 0.35247540276743367, 'support': 10642}, 'accuracy': 0.33974159622289446, 'macro avg': {'precision': 0.3344112546966263, 'recall': 0.33617477448477, 'f1-score': 0.3114815796593331, 'support': 35371}, 'weighted avg': {'precision': 0.33705736938459746, 'recall': 0.33974159622289446, 'f1-score': 0.31493239991423994, 'support': 35371}}
[[1235 5450 4944]
 [1385 6286 5429]
 [1188 4958 4496]]
training model: results/CHTR/W3/deepVOL_L2/h10
Epoch 1/50
385/385 - 13s - loss: 3.3239 - accuracy10: 0.3598 - val_loss: 3.3385 - val_accuracy10: 0.3382 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 11s - loss: 3.2918 - accuracy10: 0.3679 - val_loss: 3.3227 - val_accuracy10: 0.3460 - 11s/epoch - 29ms/step
Epoch 3/50
385/385 - 12s - loss: 3.2749 - accuracy10: 0.3761 - val_loss: 3.2994 - val_accuracy10: 0.3552 - 12s/epoch - 30ms/step
Epoch 4/50
385/385 - 12s - loss: 3.2617 - accuracy10: 0.3810 - val_loss: 3.2922 - val_accuracy10: 0.3587 - 12s/epoch - 30ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2494 - accuracy10: 0.3894 - val_loss: 3.2690 - val_accuracy10: 0.3726 - 11s/epoch - 28ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2383 - accuracy10: 0.3948 - val_loss: 3.2679 - val_accuracy10: 0.3736 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2303 - accuracy10: 0.3964 - val_loss: 3.2583 - val_accuracy10: 0.3811 - 10s/epoch - 27ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2246 - accuracy10: 0.4010 - val_loss: 3.2603 - val_accuracy10: 0.3786 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 12s - loss: 3.2156 - accuracy10: 0.4028 - val_loss: 3.2499 - val_accuracy10: 0.3829 - 12s/epoch - 30ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2133 - accuracy10: 0.4055 - val_loss: 3.2519 - val_accuracy10: 0.3795 - 10s/epoch - 26ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2066 - accuracy10: 0.4084 - val_loss: 3.2551 - val_accuracy10: 0.3828 - 11s/epoch - 29ms/step
Epoch 12/50
385/385 - 11s - loss: 3.2036 - accuracy10: 0.4126 - val_loss: 3.2482 - val_accuracy10: 0.3868 - 11s/epoch - 28ms/step
Epoch 13/50
385/385 - 11s - loss: 3.1991 - accuracy10: 0.4134 - val_loss: 3.2450 - val_accuracy10: 0.3882 - 11s/epoch - 29ms/step
Epoch 14/50
385/385 - 11s - loss: 3.1946 - accuracy10: 0.4152 - val_loss: 3.2463 - val_accuracy10: 0.3858 - 11s/epoch - 28ms/step
Epoch 15/50
385/385 - 12s - loss: 3.1912 - accuracy10: 0.4180 - val_loss: 3.2560 - val_accuracy10: 0.3871 - 12s/epoch - 31ms/step
Epoch 16/50
385/385 - 10s - loss: 3.1863 - accuracy10: 0.4188 - val_loss: 3.2546 - val_accuracy10: 0.3871 - 10s/epoch - 26ms/step
Epoch 17/50
385/385 - 11s - loss: 3.1841 - accuracy10: 0.4195 - val_loss: 3.2488 - val_accuracy10: 0.3872 - 11s/epoch - 28ms/step
Epoch 18/50
385/385 - 11s - loss: 3.1813 - accuracy10: 0.4221 - val_loss: 3.2519 - val_accuracy10: 0.3899 - 11s/epoch - 28ms/step
Epoch 19/50
385/385 - 11s - loss: 3.1775 - accuracy10: 0.4230 - val_loss: 3.2559 - val_accuracy10: 0.3879 - 11s/epoch - 28ms/step
Epoch 20/50
385/385 - 10s - loss: 3.1733 - accuracy10: 0.4250 - val_loss: 3.2507 - val_accuracy10: 0.3888 - 10s/epoch - 27ms/step
Epoch 21/50
385/385 - 11s - loss: 3.1709 - accuracy10: 0.4262 - val_loss: 3.2573 - val_accuracy10: 0.3895 - 11s/epoch - 29ms/step
Epoch 22/50
385/385 - 10s - loss: 3.1682 - accuracy10: 0.4277 - val_loss: 3.2516 - val_accuracy10: 0.3896 - 10s/epoch - 27ms/step
Epoch 23/50
385/385 - 11s - loss: 3.1647 - accuracy10: 0.4281 - val_loss: 3.2585 - val_accuracy10: 0.3901 - 11s/epoch - 29ms/step
testing model: results/CHTR/W3/deepVOL_L2/h10
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0886432
{'0': {'precision': 0.4236401279879541, 'recall': 0.10906201242380487, 'f1-score': 0.17346671393560126, 'support': 103189}, '1': {'precision': 0.37949894869927303, 'recall': 0.5884860044112477, 'f1-score': 0.46143242057773043, 'support': 93851}, '2': {'precision': 0.38019848375813764, 'recall': 0.48047374821551314, 'f1-score': 0.42449467699968696, 'support': 94565}, 'accuracy': 0.3838068620222561, 'macro avg': {'precision': 0.39444585348178823, 'recall': 0.39267392168352194, 'f1-score': 0.3531312705043395, 'support': 291605}, 'weighted avg': {'precision': 0.39534585009829304, 'recall': 0.3838068620222561, 'f1-score': 0.34755264820019116, 'support': 291605}}
[[11254 49424 42511]
 [ 7062 55230 31559]
 [ 8249 40880 45436]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0698674
{'0': {'precision': 0.44283076923076925, 'recall': 0.10879293662312531, 'f1-score': 0.1746729130761949, 'support': 33072}, '1': {'precision': 0.4111108921427586, 'recall': 0.642945201257474, 'f1-score': 0.5015326545576939, 'support': 32446}, '2': {'precision': 0.3976132082627494, 'recall': 0.47797939272362544, 'f1-score': 0.4341080991553028, 'support': 32901}, 'accuracy': 0.4083053069021226, 'macro avg': {'precision': 0.41718495654542576, 'recall': 0.4099058435347416, 'f1-score': 0.37010455559639716, 'support': 98419}, 'weighted avg': {'precision': 0.4172575963128732, 'recall': 0.4083053069021226, 'f1-score': 0.36915739502884076, 'support': 98419}}
[[ 3598 15250 14224]
 [ 1984 20861  9601]
 [ 2543 14632 15726]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0825429
{'0': {'precision': 0.4124372559955382, 'recall': 0.1177360292946983, 'f1-score': 0.1831805796383453, 'support': 12562}, '1': {'precision': 0.3877238721378372, 'recall': 0.5953354799408233, 'f1-score': 0.46960700188776383, 'support': 11491}, '2': {'precision': 0.37253376706032104, 'recall': 0.46545326029333806, 'f1-score': 0.41384186338819273, 'support': 11318}, 'accuracy': 0.38415651239716153, 'macro avg': {'precision': 0.3908982983978988, 'recall': 0.3928415898429532, 'f1-score': 0.3555431483047673, 'support': 35371}, 'weighted avg': {'precision': 0.39164029855363297, 'recall': 0.38415651239716153, 'f1-score': 0.35003903508345124, 'support': 35371}}
[[1479 5835 5248]
 [1025 6841 3625]
 [1082 4968 5268]]
training model: results/CHTR/W3/deepVOL_L2/h20
Epoch 1/50
385/385 - 13s - loss: 3.3312 - accuracy20: 0.3524 - val_loss: 3.3338 - val_accuracy20: 0.3343 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 11s - loss: 3.3019 - accuracy20: 0.3611 - val_loss: 3.3221 - val_accuracy20: 0.3480 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.2850 - accuracy20: 0.3676 - val_loss: 3.3089 - val_accuracy20: 0.3501 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2754 - accuracy20: 0.3774 - val_loss: 3.2967 - val_accuracy20: 0.3557 - 10s/epoch - 26ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2702 - accuracy20: 0.3785 - val_loss: 3.2888 - val_accuracy20: 0.3617 - 11s/epoch - 28ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2621 - accuracy20: 0.3840 - val_loss: 3.2940 - val_accuracy20: 0.3649 - 11s/epoch - 28ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2542 - accuracy20: 0.3876 - val_loss: 3.2802 - val_accuracy20: 0.3720 - 10s/epoch - 26ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2463 - accuracy20: 0.3924 - val_loss: 3.2762 - val_accuracy20: 0.3738 - 10s/epoch - 27ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2424 - accuracy20: 0.3945 - val_loss: 3.2718 - val_accuracy20: 0.3760 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2355 - accuracy20: 0.3962 - val_loss: 3.2750 - val_accuracy20: 0.3757 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2293 - accuracy20: 0.4012 - val_loss: 3.2689 - val_accuracy20: 0.3782 - 11s/epoch - 30ms/step
Epoch 12/50
385/385 - 11s - loss: 3.2267 - accuracy20: 0.4024 - val_loss: 3.2711 - val_accuracy20: 0.3801 - 11s/epoch - 30ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2230 - accuracy20: 0.4051 - val_loss: 3.2717 - val_accuracy20: 0.3824 - 11s/epoch - 28ms/step
Epoch 14/50
385/385 - 11s - loss: 3.2177 - accuracy20: 0.4070 - val_loss: 3.2663 - val_accuracy20: 0.3841 - 11s/epoch - 29ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2122 - accuracy20: 0.4106 - val_loss: 3.2688 - val_accuracy20: 0.3824 - 11s/epoch - 28ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2102 - accuracy20: 0.4106 - val_loss: 3.2678 - val_accuracy20: 0.3853 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 10s - loss: 3.2064 - accuracy20: 0.4115 - val_loss: 3.2689 - val_accuracy20: 0.3848 - 10s/epoch - 27ms/step
Epoch 18/50
385/385 - 11s - loss: 3.2017 - accuracy20: 0.4149 - val_loss: 3.2667 - val_accuracy20: 0.3868 - 11s/epoch - 29ms/step
Epoch 19/50
385/385 - 10s - loss: 3.1986 - accuracy20: 0.4176 - val_loss: 3.2716 - val_accuracy20: 0.3851 - 10s/epoch - 26ms/step
Epoch 20/50
385/385 - 11s - loss: 3.1939 - accuracy20: 0.4184 - val_loss: 3.2690 - val_accuracy20: 0.3851 - 11s/epoch - 29ms/step
Epoch 21/50
385/385 - 10s - loss: 3.1918 - accuracy20: 0.4194 - val_loss: 3.2707 - val_accuracy20: 0.3851 - 10s/epoch - 27ms/step
Epoch 22/50
385/385 - 11s - loss: 3.1890 - accuracy20: 0.4187 - val_loss: 3.2699 - val_accuracy20: 0.3850 - 11s/epoch - 27ms/step
Epoch 23/50
385/385 - 11s - loss: 3.1850 - accuracy20: 0.4228 - val_loss: 3.2717 - val_accuracy20: 0.3859 - 11s/epoch - 27ms/step
Epoch 24/50
385/385 - 11s - loss: 3.1811 - accuracy20: 0.4235 - val_loss: 3.2765 - val_accuracy20: 0.3864 - 11s/epoch - 28ms/step
testing model: results/CHTR/W3/deepVOL_L2/h20
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0874753
{'0': {'precision': 0.4181360201511335, 'recall': 0.13648821487301296, 'f1-score': 0.20579929747227768, 'support': 98514}, '1': {'precision': 0.39249437515017804, 'recall': 0.5520292482103905, 'f1-score': 0.458788683484833, 'support': 97647}, '2': {'precision': 0.38595212552513697, 'recall': 0.4937869326516072, 'f1-score': 0.43326055480223397, 'support': 95444}, 'accuracy': 0.3925824317141339, 'macro avg': {'precision': 0.3988608402754828, 'recall': 0.3941014652450036, 'f1-score': 0.36594951191978153, 'support': 291605}, 'weighted avg': {'precision': 0.39901567122676007, 'recall': 0.3925824317141339, 'f1-score': 0.36496483585662753, 'support': 291605}}
[[13446 44702 40366]
 [ 9127 53904 34616]
 [ 9584 38731 47129]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0776545
{'0': {'precision': 0.45488257107540175, 'recall': 0.13168724279835392, 'f1-score': 0.20424587206882203, 'support': 33534}, '1': {'precision': 0.4027269910133251, 'recall': 0.6008692167801991, 'f1-score': 0.48223827429249955, 'support': 32443}, '2': {'precision': 0.3873368729221456, 'recall': 0.48122803772886996, 'f1-score': 0.42920767581239344, 'support': 32442}, 'accuracy': 0.4015688027718225, 'macro avg': {'precision': 0.4149821450036241, 'recall': 0.4045948324358077, 'f1-score': 0.371897274057905, 'support': 98419}, 'weighted avg': {'precision': 0.4154247324117099, 'recall': 0.4015688027718225, 'f1-score': 0.37003823271454805, 'support': 98419}}
[[ 4416 14927 14191]
 [ 2446 19494 10503]
 [ 2846 13984 15612]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0905832
{'0': {'precision': 0.4147940074906367, 'recall': 0.1427305678614579, 'f1-score': 0.21238089530772455, 'support': 12415}, '1': {'precision': 0.38746403102714877, 'recall': 0.5281828259571928, 'f1-score': 0.4470104283188396, 'support': 11727}, '2': {'precision': 0.36908621716403095, 'recall': 0.49674948793303053, 'f1-score': 0.42350618783691435, 'support': 11229}, 'accuracy': 0.38291255548330555, 'macro avg': {'precision': 0.3904480852272722, 'recall': 0.3892209605838937, 'f1-score': 0.3609658371544928, 'support': 35371}, 'weighted avg': {'precision': 0.39122239765306416, 'recall': 0.38291255548330555, 'f1-score': 0.3571951907314224, 'support': 35371}}
[[1772 5362 5281]
 [1279 6194 4254]
 [1221 4430 5578]]
training model: results/CHTR/W3/deepVOL_L2/h30
Epoch 1/50
385/385 - 14s - loss: 3.3336 - accuracy30: 0.3502 - val_loss: 3.3652 - val_accuracy30: 0.3292 - 14s/epoch - 35ms/step
Epoch 2/50
385/385 - 12s - loss: 3.3071 - accuracy30: 0.3554 - val_loss: 3.3470 - val_accuracy30: 0.3370 - 12s/epoch - 30ms/step
Epoch 3/50
385/385 - 11s - loss: 3.2937 - accuracy30: 0.3625 - val_loss: 3.3278 - val_accuracy30: 0.3415 - 11s/epoch - 29ms/step
Epoch 4/50
385/385 - 11s - loss: 3.2822 - accuracy30: 0.3697 - val_loss: 3.3114 - val_accuracy30: 0.3490 - 11s/epoch - 28ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2751 - accuracy30: 0.3727 - val_loss: 3.3048 - val_accuracy30: 0.3499 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2665 - accuracy30: 0.3810 - val_loss: 3.3026 - val_accuracy30: 0.3574 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2617 - accuracy30: 0.3819 - val_loss: 3.3002 - val_accuracy30: 0.3585 - 10s/epoch - 26ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2589 - accuracy30: 0.3866 - val_loss: 3.2942 - val_accuracy30: 0.3617 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2553 - accuracy30: 0.3855 - val_loss: 3.2954 - val_accuracy30: 0.3640 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2501 - accuracy30: 0.3880 - val_loss: 3.2899 - val_accuracy30: 0.3629 - 11s/epoch - 29ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2454 - accuracy30: 0.3915 - val_loss: 3.2875 - val_accuracy30: 0.3679 - 11s/epoch - 28ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2420 - accuracy30: 0.3922 - val_loss: 3.2856 - val_accuracy30: 0.3729 - 10s/epoch - 26ms/step
Epoch 13/50
385/385 - 10s - loss: 3.2384 - accuracy30: 0.3931 - val_loss: 3.2824 - val_accuracy30: 0.3731 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.2350 - accuracy30: 0.3957 - val_loss: 3.2837 - val_accuracy30: 0.3720 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2294 - accuracy30: 0.3997 - val_loss: 3.2816 - val_accuracy30: 0.3730 - 11s/epoch - 29ms/step
Epoch 16/50
385/385 - 10s - loss: 3.2260 - accuracy30: 0.4007 - val_loss: 3.2888 - val_accuracy30: 0.3756 - 10s/epoch - 26ms/step
Epoch 17/50
385/385 - 11s - loss: 3.2251 - accuracy30: 0.4014 - val_loss: 3.2759 - val_accuracy30: 0.3794 - 11s/epoch - 29ms/step
Epoch 18/50
385/385 - 11s - loss: 3.2231 - accuracy30: 0.4029 - val_loss: 3.2853 - val_accuracy30: 0.3769 - 11s/epoch - 28ms/step
Epoch 19/50
385/385 - 10s - loss: 3.2157 - accuracy30: 0.4071 - val_loss: 3.2802 - val_accuracy30: 0.3776 - 10s/epoch - 26ms/step
Epoch 20/50
385/385 - 11s - loss: 3.2139 - accuracy30: 0.4056 - val_loss: 3.2897 - val_accuracy30: 0.3757 - 11s/epoch - 29ms/step
Epoch 21/50
385/385 - 10s - loss: 3.2099 - accuracy30: 0.4092 - val_loss: 3.2865 - val_accuracy30: 0.3754 - 10s/epoch - 26ms/step
Epoch 22/50
385/385 - 11s - loss: 3.2083 - accuracy30: 0.4103 - val_loss: 3.2812 - val_accuracy30: 0.3792 - 11s/epoch - 28ms/step
Epoch 23/50
385/385 - 10s - loss: 3.2035 - accuracy30: 0.4126 - val_loss: 3.2894 - val_accuracy30: 0.3795 - 10s/epoch - 27ms/step
Epoch 24/50
385/385 - 11s - loss: 3.1998 - accuracy30: 0.4133 - val_loss: 3.2895 - val_accuracy30: 0.3800 - 11s/epoch - 28ms/step
Epoch 25/50
385/385 - 11s - loss: 3.1959 - accuracy30: 0.4162 - val_loss: 3.3054 - val_accuracy30: 0.3711 - 11s/epoch - 29ms/step
Epoch 26/50
385/385 - 10s - loss: 3.1915 - accuracy30: 0.4175 - val_loss: 3.2983 - val_accuracy30: 0.3819 - 10s/epoch - 26ms/step
Epoch 27/50
385/385 - 11s - loss: 3.1887 - accuracy30: 0.4169 - val_loss: 3.3023 - val_accuracy30: 0.3775 - 11s/epoch - 28ms/step
testing model: results/CHTR/W3/deepVOL_L2/h30
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0905184
{'0': {'precision': 0.3887566587328573, 'recall': 0.14260471884419498, 'f1-score': 0.2086660278931119, 'support': 96210}, '1': {'precision': 0.3904440821289413, 'recall': 0.5685142339804848, 'f1-score': 0.46294612505017246, 'support': 99410}, '2': {'precision': 0.38665352036929146, 'recall': 0.44941397093295826, 'f1-score': 0.4156781498434113, 'support': 95985}, 'accuracy': 0.388789629807445, 'macro avg': {'precision': 0.38861808707703, 'recall': 0.3868443079192127, 'f1-score': 0.36243010092889855, 'support': 291605}, 'weighted avg': {'precision': 0.38863964093130327, 'recall': 0.388789629807445, 'f1-score': 0.363492052768484, 'support': 291605}}
[[13720 46499 35991]
 [10457 56516 32437]
 [11115 41733 43137]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0817442
{'0': {'precision': 0.44835425521399624, 'recall': 0.1347073322840258, 'f1-score': 0.20717058689198448, 'support': 33673}, '1': {'precision': 0.391271498160851, 'recall': 0.607995798189514, 'f1-score': 0.47613171711306285, 'support': 32367}, '2': {'precision': 0.38300839319072805, 'recall': 0.44958151888569753, 'f1-score': 0.4136333930042907, 'support': 32379}, 'accuracy': 0.39394832298641524, 'macro avg': {'precision': 0.4075447155218584, 'recall': 0.39742821645307913, 'f1-score': 0.365645232336446, 'support': 98419}, 'weighted avg': {'precision': 0.4080832581098745, 'recall': 0.39394832298641524, 'f1-score': 0.36354815728973294, 'support': 98419}}
[[ 4536 15769 13368]
 [ 2606 19679 10082]
 [ 2975 14847 14557]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0942708
{'0': {'precision': 0.3962421711899791, 'recall': 0.1542086447838804, 'f1-score': 0.2220142706749328, 'support': 12308}, '1': {'precision': 0.3796807136987909, 'recall': 0.5428835179590467, 'f1-score': 0.44684672238723494, 'support': 11916}, '2': {'precision': 0.3675699623421694, 'recall': 0.44657755449896835, 'f1-score': 0.4032401782098015, 'support': 11147}, 'accuracy': 0.3772864776229114, 'macro avg': {'precision': 0.38116428241031314, 'recall': 0.3812232390806318, 'f1-score': 0.3573670570906564, 'support': 35371}, 'weighted avg': {'precision': 0.38162693725563934, 'recall': 0.3772864776229114, 'f1-score': 0.3548696800751469, 'support': 35371}}
[[1898 5762 4648]
 [1530 6469 3917]
 [1362 4807 4978]]
training model: results/CHTR/W3/deepVOL_L2/h50
Epoch 1/50
385/385 - 13s - loss: 3.3396 - accuracy50: 0.3433 - val_loss: 3.3593 - val_accuracy50: 0.3315 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 11s - loss: 3.3143 - accuracy50: 0.3503 - val_loss: 3.3455 - val_accuracy50: 0.3322 - 11s/epoch - 27ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3008 - accuracy50: 0.3539 - val_loss: 3.3142 - val_accuracy50: 0.3358 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 10s - loss: 3.2936 - accuracy50: 0.3562 - val_loss: 3.3195 - val_accuracy50: 0.3381 - 10s/epoch - 27ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2880 - accuracy50: 0.3595 - val_loss: 3.3190 - val_accuracy50: 0.3334 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2842 - accuracy50: 0.3640 - val_loss: 3.3144 - val_accuracy50: 0.3368 - 11s/epoch - 28ms/step
Epoch 7/50
385/385 - 10s - loss: 3.2802 - accuracy50: 0.3662 - val_loss: 3.3184 - val_accuracy50: 0.3379 - 10s/epoch - 26ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2786 - accuracy50: 0.3662 - val_loss: 3.3172 - val_accuracy50: 0.3425 - 10s/epoch - 25ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2760 - accuracy50: 0.3688 - val_loss: 3.3110 - val_accuracy50: 0.3464 - 11s/epoch - 29ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2717 - accuracy50: 0.3726 - val_loss: 3.3137 - val_accuracy50: 0.3493 - 11s/epoch - 29ms/step
Epoch 11/50
385/385 - 12s - loss: 3.2677 - accuracy50: 0.3771 - val_loss: 3.3192 - val_accuracy50: 0.3444 - 12s/epoch - 30ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2637 - accuracy50: 0.3784 - val_loss: 3.3206 - val_accuracy50: 0.3498 - 10s/epoch - 26ms/step
Epoch 13/50
385/385 - 10s - loss: 3.2623 - accuracy50: 0.3782 - val_loss: 3.3097 - val_accuracy50: 0.3555 - 10s/epoch - 27ms/step
Epoch 14/50
385/385 - 11s - loss: 3.2582 - accuracy50: 0.3826 - val_loss: 3.3154 - val_accuracy50: 0.3557 - 11s/epoch - 28ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2557 - accuracy50: 0.3838 - val_loss: 3.3139 - val_accuracy50: 0.3566 - 11s/epoch - 29ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2518 - accuracy50: 0.3873 - val_loss: 3.3206 - val_accuracy50: 0.3551 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 10s - loss: 3.2492 - accuracy50: 0.3901 - val_loss: 3.3101 - val_accuracy50: 0.3585 - 10s/epoch - 26ms/step
Epoch 18/50
385/385 - 11s - loss: 3.2475 - accuracy50: 0.3884 - val_loss: 3.3145 - val_accuracy50: 0.3575 - 11s/epoch - 27ms/step
Epoch 19/50
385/385 - 10s - loss: 3.2437 - accuracy50: 0.3930 - val_loss: 3.3139 - val_accuracy50: 0.3656 - 10s/epoch - 26ms/step
Epoch 20/50
385/385 - 11s - loss: 3.2406 - accuracy50: 0.3945 - val_loss: 3.3171 - val_accuracy50: 0.3604 - 11s/epoch - 27ms/step
Epoch 21/50
385/385 - 11s - loss: 3.2375 - accuracy50: 0.3967 - val_loss: 3.3151 - val_accuracy50: 0.3630 - 11s/epoch - 29ms/step
Epoch 22/50
385/385 - 10s - loss: 3.2342 - accuracy50: 0.3979 - val_loss: 3.3264 - val_accuracy50: 0.3592 - 10s/epoch - 27ms/step
Epoch 23/50
385/385 - 12s - loss: 3.2304 - accuracy50: 0.3999 - val_loss: 3.3293 - val_accuracy50: 0.3607 - 12s/epoch - 31ms/step
testing model: results/CHTR/W3/deepVOL_L2/h50
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.097355
{'0': {'precision': 0.37090764720254094, 'recall': 0.12902506135197442, 'f1-score': 0.19145129381349854, 'support': 94129}, '1': {'precision': 0.3839527761586218, 'recall': 0.40991751864473747, 'f1-score': 0.39651053908922396, 'support': 101235}, '2': {'precision': 0.35921209709510543, 'recall': 0.5627747010110036, 'f1-score': 0.43852142125568266, 'support': 96241}, 'accuracy': 0.36969530700776737, 'macro avg': {'precision': 0.371357506818756, 'recall': 0.3672390936692385, 'f1-score': 0.34216108471946843, 'support': 291605}, 'weighted avg': {'precision': 0.37157647041194797, 'recall': 0.36969530700776737, 'f1-score': 0.3441834103089335, 'support': 291605}}
[[12145 34773 47211]
 [10330 41498 49407]
 [10269 31810 54162]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0934281
{'0': {'precision': 0.43029989658738366, 'recall': 0.12363323033040172, 'f1-score': 0.192078659465448, 'support': 33656}, '1': {'precision': 0.3758602978941962, 'recall': 0.45126876946320105, 'f1-score': 0.41012707886735883, 'support': 32433}, '2': {'precision': 0.35290810897628944, 'recall': 0.5437055366532633, 'f1-score': 0.4280061846382352, 'support': 32330}, 'accuracy': 0.3695932695922535, 'macro avg': {'precision': 0.38635610115262314, 'recall': 0.372869178815622, 'f1-score': 0.3434039743236807, 'support': 98419}, 'weighted avg': {'precision': 0.38693717193174987, 'recall': 0.3695932695922535, 'f1-score': 0.3414349958974213, 'support': 98419}}
[[ 4161 12470 17025]
 [ 2591 14636 15206]
 [ 2918 11834 17578]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043117
{'0': {'precision': 0.35968552085608213, 'recall': 0.13558903432946406, 'f1-score': 0.19693889752481167, 'support': 12147}, '1': {'precision': 0.3733758832915432, 'recall': 0.4027868852459016, 'f1-score': 0.3875241512558653, 'support': 12200}, '2': {'precision': 0.3369633032726448, 'recall': 0.5389150943396226, 'f1-score': 0.41465712790088993, 'support': 11024}, 'accuracy': 0.35345339402335246, 'macro avg': {'precision': 0.3566749024734233, 'recall': 0.35909700463832944, 'f1-score': 0.33304005889385563, 'support': 35371}, 'weighted avg': {'precision': 0.35732575424142077, 'recall': 0.35345339402335246, 'f1-score': 0.33053042355417867, 'support': 35371}}
[[1647 4473 6027]
 [1623 4914 5663]
 [1309 3774 5941]]
training model: results/CHTR/W3/deepVOL_L2/h100
Epoch 1/50
385/385 - 13s - loss: 3.3419 - accuracy100: 0.3431 - val_loss: 3.3631 - val_accuracy100: 0.3340 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 10s - loss: 3.3146 - accuracy100: 0.3482 - val_loss: 3.3452 - val_accuracy100: 0.3398 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3101 - accuracy100: 0.3476 - val_loss: 3.3184 - val_accuracy100: 0.3378 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 11s - loss: 3.3008 - accuracy100: 0.3506 - val_loss: 3.3207 - val_accuracy100: 0.3310 - 11s/epoch - 30ms/step
Epoch 5/50
385/385 - 12s - loss: 3.2972 - accuracy100: 0.3523 - val_loss: 3.3175 - val_accuracy100: 0.3318 - 12s/epoch - 30ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2909 - accuracy100: 0.3568 - val_loss: 3.3126 - val_accuracy100: 0.3358 - 11s/epoch - 29ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2891 - accuracy100: 0.3590 - val_loss: 3.3151 - val_accuracy100: 0.3269 - 11s/epoch - 29ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2873 - accuracy100: 0.3604 - val_loss: 3.3121 - val_accuracy100: 0.3317 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2818 - accuracy100: 0.3635 - val_loss: 3.3099 - val_accuracy100: 0.3355 - 11s/epoch - 29ms/step
Epoch 10/50
385/385 - 10s - loss: 3.2817 - accuracy100: 0.3644 - val_loss: 3.3154 - val_accuracy100: 0.3321 - 10s/epoch - 26ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2774 - accuracy100: 0.3674 - val_loss: 3.3138 - val_accuracy100: 0.3356 - 11s/epoch - 28ms/step
Epoch 12/50
385/385 - 11s - loss: 3.2749 - accuracy100: 0.3692 - val_loss: 3.3107 - val_accuracy100: 0.3364 - 11s/epoch - 29ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2744 - accuracy100: 0.3688 - val_loss: 3.3099 - val_accuracy100: 0.3387 - 11s/epoch - 27ms/step
Epoch 14/50
385/385 - 10s - loss: 3.2706 - accuracy100: 0.3742 - val_loss: 3.3106 - val_accuracy100: 0.3429 - 10s/epoch - 26ms/step
Epoch 15/50
385/385 - 10s - loss: 3.2670 - accuracy100: 0.3753 - val_loss: 3.3064 - val_accuracy100: 0.3395 - 10s/epoch - 26ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2669 - accuracy100: 0.3766 - val_loss: 3.3124 - val_accuracy100: 0.3382 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 11s - loss: 3.2631 - accuracy100: 0.3781 - val_loss: 3.3103 - val_accuracy100: 0.3440 - 11s/epoch - 28ms/step
Epoch 18/50
385/385 - 11s - loss: 3.2619 - accuracy100: 0.3782 - val_loss: 3.3158 - val_accuracy100: 0.3444 - 11s/epoch - 28ms/step
Epoch 19/50
385/385 - 11s - loss: 3.2581 - accuracy100: 0.3820 - val_loss: 3.3152 - val_accuracy100: 0.3396 - 11s/epoch - 28ms/step
Epoch 20/50
385/385 - 11s - loss: 3.2568 - accuracy100: 0.3834 - val_loss: 3.3134 - val_accuracy100: 0.3445 - 11s/epoch - 27ms/step
Epoch 21/50
385/385 - 10s - loss: 3.2530 - accuracy100: 0.3835 - val_loss: 3.3152 - val_accuracy100: 0.3441 - 10s/epoch - 27ms/step
Epoch 22/50
385/385 - 11s - loss: 3.2529 - accuracy100: 0.3848 - val_loss: 3.3186 - val_accuracy100: 0.3451 - 11s/epoch - 29ms/step
Epoch 23/50
385/385 - 11s - loss: 3.2489 - accuracy100: 0.3868 - val_loss: 3.3240 - val_accuracy100: 0.3450 - 11s/epoch - 27ms/step
Epoch 24/50
385/385 - 11s - loss: 3.2458 - accuracy100: 0.3887 - val_loss: 3.3203 - val_accuracy100: 0.3505 - 11s/epoch - 28ms/step
Epoch 25/50
385/385 - 11s - loss: 3.2426 - accuracy100: 0.3895 - val_loss: 3.3265 - val_accuracy100: 0.3494 - 11s/epoch - 28ms/step
testing model: results/CHTR/W3/deepVOL_L2/h100
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1008408
{'0': {'precision': 0.33562489929641764, 'recall': 0.13382302552681172, 'f1-score': 0.1913496134119268, 'support': 93392}, '1': {'precision': 0.3539123841205391, 'recall': 0.4242818184483955, 'f1-score': 0.3859154679137254, 'support': 102307}, '2': {'precision': 0.33654473951927605, 'recall': 0.46221300022939127, 'f1-score': 0.3894931993111447, 'support': 95906}, 'accuracy': 0.3437321033589959, 'macro avg': {'precision': 0.34202734097874427, 'recall': 0.34010594806819955, 'f1-score': 0.3222527602122656, 'support': 291605}, 'weighted avg': {'precision': 0.34234342574937576, 'recall': 0.3437321033589959, 'f1-score': 0.32477876457794214, 'support': 291605}}
[[12498 39702 41192]
 [12703 43407 46197]
 [12037 39540 44329]]
Evaluating performance on  train set...
385/385 - 5s - 5s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0933293
{'0': {'precision': 0.41080086941982946, 'recall': 0.14766068691967907, 'f1-score': 0.21723657744081692, 'support': 33279}, '1': {'precision': 0.35617356341095663, 'recall': 0.4569796720506049, 'f1-score': 0.4003281819526826, 'support': 32566}, '2': {'precision': 0.35241975198101805, 'recall': 0.48333026340025786, 'f1-score': 0.4076222038111019, 'support': 32574}, 'accuracy': 0.36110913543116674, 'macro avg': {'precision': 0.3731313949372681, 'recall': 0.36265687412351394, 'f1-score': 0.3417289877348672, 'support': 98419}, 'weighted avg': {'precision': 0.3734026092572918, 'recall': 0.36110913543116674, 'f1-score': 0.34083245411014984, 'support': 98419}}
[[ 4914 13635 14730]
 [ 3484 14882 14200]
 [ 3564 13266 15744]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1022881
{'0': {'precision': 0.32766553310662133, 'recall': 0.13946360153256704, 'f1-score': 0.1956521739130435, 'support': 11745}, '1': {'precision': 0.36882561326114566, 'recall': 0.4321064996084573, 'f1-score': 0.3979661750387653, 'support': 12770}, '2': {'precision': 0.31957692557264294, 'recall': 0.4536661753868828, 'f1-score': 0.37499524117714245, 'support': 10856}, 'accuracy': 0.3415509880975941, 'macro avg': {'precision': 0.33868935731346994, 'recall': 0.3417454255093024, 'f1-score': 0.3228711967096504, 'support': 35371}, 'weighted avg': {'precision': 0.34004302597321845, 'recall': 0.3415509880975941, 'f1-score': 0.3237372756233295, 'support': 35371}}
[[1638 4965 5142]
 [1908 5518 5344]
 [1453 4478 4925]]
training model: results/CHTR/W3/deepVOL_L2/h200
Epoch 1/50
385/385 - 12s - loss: 3.3460 - accuracy200: 0.3430 - val_loss: 3.3836 - val_accuracy200: 0.3549 - 12s/epoch - 32ms/step
Epoch 2/50
385/385 - 12s - loss: 3.3175 - accuracy200: 0.3460 - val_loss: 3.3546 - val_accuracy200: 0.3563 - 12s/epoch - 30ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3054 - accuracy200: 0.3449 - val_loss: 3.3565 - val_accuracy200: 0.3545 - 11s/epoch - 27ms/step
Epoch 4/50
385/385 - 11s - loss: 3.3016 - accuracy200: 0.3485 - val_loss: 3.3177 - val_accuracy200: 0.3367 - 11s/epoch - 29ms/step
Epoch 5/50
385/385 - 10s - loss: 3.2968 - accuracy200: 0.3484 - val_loss: 3.3175 - val_accuracy200: 0.3387 - 10s/epoch - 27ms/step
Epoch 6/50
385/385 - 11s - loss: 3.2930 - accuracy200: 0.3536 - val_loss: 3.3133 - val_accuracy200: 0.3463 - 11s/epoch - 29ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2909 - accuracy200: 0.3561 - val_loss: 3.3143 - val_accuracy200: 0.3323 - 11s/epoch - 27ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2888 - accuracy200: 0.3596 - val_loss: 3.3118 - val_accuracy200: 0.3395 - 11s/epoch - 28ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2861 - accuracy200: 0.3605 - val_loss: 3.3089 - val_accuracy200: 0.3381 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2849 - accuracy200: 0.3622 - val_loss: 3.3055 - val_accuracy200: 0.3440 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 10s - loss: 3.2819 - accuracy200: 0.3657 - val_loss: 3.3107 - val_accuracy200: 0.3476 - 10s/epoch - 27ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2798 - accuracy200: 0.3664 - val_loss: 3.3094 - val_accuracy200: 0.3450 - 10s/epoch - 26ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2768 - accuracy200: 0.3697 - val_loss: 3.3050 - val_accuracy200: 0.3474 - 11s/epoch - 28ms/step
Epoch 14/50
385/385 - 11s - loss: 3.2745 - accuracy200: 0.3729 - val_loss: 3.3094 - val_accuracy200: 0.3502 - 11s/epoch - 28ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2722 - accuracy200: 0.3740 - val_loss: 3.3100 - val_accuracy200: 0.3538 - 11s/epoch - 27ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2696 - accuracy200: 0.3760 - val_loss: 3.3132 - val_accuracy200: 0.3509 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 10s - loss: 3.2691 - accuracy200: 0.3761 - val_loss: 3.3106 - val_accuracy200: 0.3564 - 10s/epoch - 27ms/step
Epoch 18/50
385/385 - 10s - loss: 3.2659 - accuracy200: 0.3802 - val_loss: 3.3163 - val_accuracy200: 0.3516 - 10s/epoch - 26ms/step
Epoch 19/50
385/385 - 11s - loss: 3.2634 - accuracy200: 0.3787 - val_loss: 3.3282 - val_accuracy200: 0.3501 - 11s/epoch - 28ms/step
Epoch 20/50
385/385 - 10s - loss: 3.2629 - accuracy200: 0.3801 - val_loss: 3.3266 - val_accuracy200: 0.3526 - 10s/epoch - 25ms/step
Epoch 21/50
385/385 - 10s - loss: 3.2605 - accuracy200: 0.3815 - val_loss: 3.3221 - val_accuracy200: 0.3515 - 10s/epoch - 27ms/step
Epoch 22/50
385/385 - 10s - loss: 3.2600 - accuracy200: 0.3816 - val_loss: 3.3237 - val_accuracy200: 0.3533 - 10s/epoch - 26ms/step
Epoch 23/50
385/385 - 10s - loss: 3.2550 - accuracy200: 0.3830 - val_loss: 3.3320 - val_accuracy200: 0.3523 - 10s/epoch - 26ms/step
testing model: results/CHTR/W3/deepVOL_L2/h200
Evaluating performance on  test set...
1140/1140 - 17s - 17s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1008936
{'0': {'precision': 0.31095523155459254, 'recall': 0.09306236398408477, 'f1-score': 0.14325232000406052, 'support': 90982}, '1': {'precision': 0.3661407923923964, 'recall': 0.6905391715443494, 'f1-score': 0.47854519452660316, 'support': 106608}, '2': {'precision': 0.3253940676627602, 'recall': 0.21913524437589746, 'f1-score': 0.26189704377451073, 'support': 94015}, 'accuracy': 0.3521407383275321, 'macro avg': {'precision': 0.3341633638699164, 'recall': 0.3342455933014439, 'f1-score': 0.29456485276839145, 'support': 291605}, 'weighted avg': {'precision': 0.3357857023850172, 'recall': 0.3521407383275321, 'f1-score': 0.30408387801019243, 'support': 291605}}
[[ 8467 63062 19453]
 [ 9732 73617 23259]
 [ 9030 64383 20602]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955868
{'0': {'precision': 0.3983235020180068, 'recall': 0.11746932796191174, 'f1-score': 0.18143251078271935, 'support': 32766}, '1': {'precision': 0.34071956159161304, 'recall': 0.7049326801614444, 'f1-score': 0.459396239295646, 'support': 32457}, '2': {'precision': 0.3639140899833364, 'recall': 0.23683576334498133, 'f1-score': 0.28693430656934305, 'support': 33196}, 'accuracy': 0.35146668834269806, 'macro avg': {'precision': 0.3676523845309854, 'recall': 0.3530792571561125, 'f1-score': 0.3092543522159028, 'support': 98419}, 'weighted avg': {'precision': 0.36772061094694963, 'recall': 0.35146668834269806, 'f1-score': 0.30868544313599283, 'support': 98419}}
[[ 3849 21991  6926]
 [ 2761 22880  6816]
 [ 3053 22281  7862]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009828
{'0': {'precision': 0.31075150850246847, 'recall': 0.09857316860970941, 'f1-score': 0.149669749009247, 'support': 11494}, '1': {'precision': 0.3711530398322851, 'recall': 0.6708601743084501, 'f1-score': 0.4779052503711702, 'support': 13195}, '2': {'precision': 0.2948571428571429, 'recall': 0.21737502340385695, 'f1-score': 0.2502559680982917, 'support': 10682}, 'accuracy': 0.3479404031551271, 'macro avg': {'precision': 0.3255872303972988, 'recall': 0.32893612210733886, 'f1-score': 0.2926103224929029, 'support': 35371}, 'weighted avg': {'precision': 0.32848396141795183, 'recall': 0.3479404031551271, 'f1-score': 0.30249351516739215, 'support': 35371}}
[[1133 7738 2623]
 [1413 8852 2930]
 [1100 7260 2322]]
training model: results/CHTR/W3/deepVOL_L2/h300
Epoch 1/50
385/385 - 13s - loss: 3.3398 - accuracy300: 0.3425 - val_loss: 3.3492 - val_accuracy300: 0.3574 - 13s/epoch - 35ms/step
Epoch 2/50
385/385 - 10s - loss: 3.3177 - accuracy300: 0.3481 - val_loss: 3.3101 - val_accuracy300: 0.3723 - 10s/epoch - 27ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3070 - accuracy300: 0.3474 - val_loss: 3.3021 - val_accuracy300: 0.3615 - 11s/epoch - 28ms/step
Epoch 4/50
385/385 - 11s - loss: 3.3000 - accuracy300: 0.3508 - val_loss: 3.3077 - val_accuracy300: 0.3605 - 11s/epoch - 28ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2950 - accuracy300: 0.3525 - val_loss: 3.3032 - val_accuracy300: 0.3600 - 11s/epoch - 28ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2930 - accuracy300: 0.3563 - val_loss: 3.3032 - val_accuracy300: 0.3583 - 10s/epoch - 26ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2904 - accuracy300: 0.3553 - val_loss: 3.2994 - val_accuracy300: 0.3644 - 11s/epoch - 28ms/step
Epoch 8/50
385/385 - 10s - loss: 3.2874 - accuracy300: 0.3608 - val_loss: 3.2942 - val_accuracy300: 0.3660 - 10s/epoch - 26ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2843 - accuracy300: 0.3637 - val_loss: 3.2906 - val_accuracy300: 0.3690 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2825 - accuracy300: 0.3637 - val_loss: 3.2947 - val_accuracy300: 0.3700 - 11s/epoch - 27ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2803 - accuracy300: 0.3654 - val_loss: 3.3001 - val_accuracy300: 0.3662 - 11s/epoch - 28ms/step
Epoch 12/50
385/385 - 11s - loss: 3.2767 - accuracy300: 0.3704 - val_loss: 3.2965 - val_accuracy300: 0.3707 - 11s/epoch - 28ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2755 - accuracy300: 0.3709 - val_loss: 3.2968 - val_accuracy300: 0.3699 - 11s/epoch - 28ms/step
Epoch 14/50
385/385 - 11s - loss: 3.2746 - accuracy300: 0.3699 - val_loss: 3.2998 - val_accuracy300: 0.3679 - 11s/epoch - 30ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2714 - accuracy300: 0.3750 - val_loss: 3.2962 - val_accuracy300: 0.3724 - 11s/epoch - 28ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2694 - accuracy300: 0.3750 - val_loss: 3.3008 - val_accuracy300: 0.3680 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 10s - loss: 3.2671 - accuracy300: 0.3770 - val_loss: 3.2987 - val_accuracy300: 0.3704 - 10s/epoch - 27ms/step
Epoch 18/50
385/385 - 10s - loss: 3.2654 - accuracy300: 0.3775 - val_loss: 3.3001 - val_accuracy300: 0.3736 - 10s/epoch - 27ms/step
Epoch 19/50
385/385 - 10s - loss: 3.2619 - accuracy300: 0.3792 - val_loss: 3.3003 - val_accuracy300: 0.3706 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepVOL_L2/h300
Evaluating performance on  test set...
1140/1140 - 13s - 13s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.09623
{'0': {'precision': 0.3275118743149434, 'recall': 0.0508693875698007, 'f1-score': 0.08806106510270845, 'support': 88108}, '1': {'precision': 0.3824364825143978, 'recall': 0.8381565038263117, 'f1-score': 0.5252227871321323, 'support': 110681}, '2': {'precision': 0.3193583976915896, 'recall': 0.12162773659713842, 'f1-score': 0.17616353918776576, 'support': 92816}, 'accuracy': 0.3722124106239605, 'macro avg': {'precision': 0.3431022515069769, 'recall': 0.3368845426644169, 'f1-score': 0.26314913047420213, 'support': 291605}, 'weighted avg': {'precision': 0.3457637474784715, 'recall': 0.3722124106239605, 'f1-score': 0.2820317301825848, 'support': 291605}}
[[ 4482 72671 10955]
 [ 4808 92768 13105]
 [ 4395 77132 11289]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0982813
{'0': {'precision': 0.3828613460831188, 'recall': 0.06403395460417051, 'f1-score': 0.10971753794266442, 'support': 32514}, '1': {'precision': 0.3370339520369979, 'recall': 0.8324633052877234, 'f1-score': 0.4798102705237914, 'support': 32566}, '2': {'precision': 0.3744419642857143, 'recall': 0.14088604937160681, 'f1-score': 0.20473813830830592, 'support': 33339}, 'accuracy': 0.34433391926355683, 'macro avg': {'precision': 0.3647790874686103, 'recall': 0.3457944364211669, 'f1-score': 0.2647553155915872, 'support': 98419}, 'weighted avg': {'precision': 0.3648454275689128, 'recall': 0.34433391926355683, 'f1-score': 0.26436584492431536, 'support': 98419}}
[[ 2082 26419  4013]
 [ 1622 27110  3834]
 [ 1734 26908  4697]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096904
{'0': {'precision': 0.2846828261990717, 'recall': 0.04946236559139785, 'f1-score': 0.0842812428429651, 'support': 11160}, '1': {'precision': 0.38666942661974746, 'recall': 0.8188194038573934, 'f1-score': 0.5252847166893191, 'support': 13688}, '2': {'precision': 0.29622132253711203, 'recall': 0.1251544236434477, 'f1-score': 0.1759636582270025, 'support': 10523}, 'accuracy': 0.3697096491476068, 'macro avg': {'precision': 0.3225245251186437, 'recall': 0.33114539769741297, 'f1-score': 0.26184320591976223, 'support': 35371}, 'weighted avg': {'precision': 0.3275827211277819, 'recall': 0.3697096491476068, 'f1-score': 0.2822182422802193, 'support': 35371}}
[[  552  9175  1433]
 [  784 11208  1696]
 [  603  8603  1317]]
training model: results/CHTR/W3/deepVOL_L2/h500
Epoch 1/50
385/385 - 12s - loss: 3.3451 - accuracy500: 0.3405 - val_loss: 3.3931 - val_accuracy500: 0.3684 - 12s/epoch - 32ms/step
Epoch 2/50
385/385 - 11s - loss: 3.3271 - accuracy500: 0.3479 - val_loss: 3.3199 - val_accuracy500: 0.3711 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3097 - accuracy500: 0.3445 - val_loss: 3.3051 - val_accuracy500: 0.3575 - 11s/epoch - 27ms/step
Epoch 4/50
385/385 - 11s - loss: 3.3030 - accuracy500: 0.3460 - val_loss: 3.3098 - val_accuracy500: 0.3366 - 11s/epoch - 28ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2972 - accuracy500: 0.3494 - val_loss: 3.3048 - val_accuracy500: 0.3521 - 11s/epoch - 27ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2948 - accuracy500: 0.3532 - val_loss: 3.2994 - val_accuracy500: 0.3594 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 11s - loss: 3.2920 - accuracy500: 0.3528 - val_loss: 3.3016 - val_accuracy500: 0.3607 - 11s/epoch - 27ms/step
Epoch 8/50
385/385 - 11s - loss: 3.2887 - accuracy500: 0.3571 - val_loss: 3.3010 - val_accuracy500: 0.3722 - 11s/epoch - 29ms/step
Epoch 9/50
385/385 - 11s - loss: 3.2866 - accuracy500: 0.3593 - val_loss: 3.2993 - val_accuracy500: 0.3674 - 11s/epoch - 28ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2871 - accuracy500: 0.3597 - val_loss: 3.3032 - val_accuracy500: 0.3577 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 12s - loss: 3.2830 - accuracy500: 0.3646 - val_loss: 3.3008 - val_accuracy500: 0.3689 - 12s/epoch - 31ms/step
Epoch 12/50
385/385 - 11s - loss: 3.2792 - accuracy500: 0.3679 - val_loss: 3.3019 - val_accuracy500: 0.3726 - 11s/epoch - 27ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2779 - accuracy500: 0.3708 - val_loss: 3.3017 - val_accuracy500: 0.3702 - 11s/epoch - 28ms/step
Epoch 14/50
385/385 - 10s - loss: 3.2749 - accuracy500: 0.3727 - val_loss: 3.3010 - val_accuracy500: 0.3769 - 10s/epoch - 27ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2728 - accuracy500: 0.3724 - val_loss: 3.3003 - val_accuracy500: 0.3784 - 11s/epoch - 28ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2705 - accuracy500: 0.3757 - val_loss: 3.3083 - val_accuracy500: 0.3753 - 11s/epoch - 28ms/step
Epoch 17/50
385/385 - 11s - loss: 3.2690 - accuracy500: 0.3759 - val_loss: 3.3188 - val_accuracy500: 0.3756 - 11s/epoch - 28ms/step
Epoch 18/50
385/385 - 11s - loss: 3.2672 - accuracy500: 0.3779 - val_loss: 3.3173 - val_accuracy500: 0.3775 - 11s/epoch - 29ms/step
Epoch 19/50
385/385 - 10s - loss: 3.2643 - accuracy500: 0.3810 - val_loss: 3.3259 - val_accuracy500: 0.3792 - 10s/epoch - 27ms/step
testing model: results/CHTR/W3/deepVOL_L2/h500
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0917118
{'0': {'precision': 0.30624620982413586, 'recall': 0.042134496650694894, 'f1-score': 0.07407717857105438, 'support': 83898}, '1': {'precision': 0.4088723275808231, 'recall': 0.8303177367806956, 'f1-score': 0.5479287728861599, 'support': 118274}, '2': {'precision': 0.3012011936705369, 'recall': 0.13430165598828173, 'f1-score': 0.1857706287216766, 'support': 89433}, 'accuracy': 0.3900859038768197, 'macro avg': {'precision': 0.338773243691832, 'recall': 0.33558462980655746, 'f1-score': 0.2692588600596303, 'support': 291605}, 'weighted avg': {'precision': 0.34632374800725896, 'recall': 0.3900859038768197, 'f1-score': 0.3005252977505794, 'support': 291605}}
[[ 3535 68310 12053]
 [ 4256 98205 15813]
 [ 3752 73670 12011]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983633
{'0': {'precision': 0.3907843137254902, 'recall': 0.062137556899669516, 'f1-score': 0.10722548017431537, 'support': 32074}, '1': {'precision': 0.3367418316863164, 'recall': 0.8145265489448101, 'f1-score': 0.476492131050183, 'support': 32506}, '2': {'precision': 0.36087666757419, 'recall': 0.15668311711338986, 'f1-score': 0.21849951577342314, 'support': 33839}, 'accuracy': 0.3431451244170333, 'macro avg': {'precision': 0.3628009376619989, 'recall': 0.34444907431928984, 'f1-score': 0.26740570899930716, 'support': 98419}, 'weighted avg': {'precision': 0.362652044963572, 'recall': 0.3431451244170333, 'f1-score': 0.26744641153928717, 'support': 98419}}
[[ 1993 25291  4790]
 [ 1429 26477  4600]
 [ 1678 26859  5302]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0972944
{'0': {'precision': 0.28588304784406376, 'recall': 0.043427545984746525, 'f1-score': 0.07540115282754323, 'support': 11145}, '1': {'precision': 0.3886555351129934, 'recall': 0.8134854319552424, 'f1-score': 0.5260042283298098, 'support': 13763}, '2': {'precision': 0.2972695545062615, 'recall': 0.1383924304692727, 'f1-score': 0.18886135385418026, 'support': 10463}, 'accuracy': 0.37115150829775806, 'macro avg': {'precision': 0.32393604582110624, 'recall': 0.33176846946975386, 'f1-score': 0.2634222450038444, 'support': 35371}, 'weighted avg': {'precision': 0.329240452539686, 'recall': 0.37115150829775806, 'f1-score': 0.2842949983925371, 'support': 35371}}
[[  484  9140  1521]
 [  665 11196  1902]
 [  544  8471  1448]]
training model: results/CHTR/W3/deepVOL_L2/h1000
Epoch 1/50
385/385 - 13s - loss: 3.3362 - accuracy1000: 0.3564 - val_loss: 3.5456 - val_accuracy1000: 0.3534 - 13s/epoch - 34ms/step
Epoch 2/50
385/385 - 11s - loss: 3.3138 - accuracy1000: 0.3577 - val_loss: 3.3595 - val_accuracy1000: 0.3642 - 11s/epoch - 28ms/step
Epoch 3/50
385/385 - 11s - loss: 3.3028 - accuracy1000: 0.3504 - val_loss: 3.3286 - val_accuracy1000: 0.3495 - 11s/epoch - 29ms/step
Epoch 4/50
385/385 - 11s - loss: 3.3013 - accuracy1000: 0.3472 - val_loss: 3.3117 - val_accuracy1000: 0.3443 - 11s/epoch - 29ms/step
Epoch 5/50
385/385 - 11s - loss: 3.2983 - accuracy1000: 0.3470 - val_loss: 3.3137 - val_accuracy1000: 0.3324 - 11s/epoch - 28ms/step
Epoch 6/50
385/385 - 10s - loss: 3.2955 - accuracy1000: 0.3491 - val_loss: 3.3103 - val_accuracy1000: 0.3351 - 10s/epoch - 27ms/step
Epoch 7/50
385/385 - 12s - loss: 3.2943 - accuracy1000: 0.3473 - val_loss: 3.3128 - val_accuracy1000: 0.3312 - 12s/epoch - 32ms/step
Epoch 8/50
385/385 - 12s - loss: 3.2933 - accuracy1000: 0.3547 - val_loss: 3.3152 - val_accuracy1000: 0.3260 - 12s/epoch - 30ms/step
Epoch 9/50
385/385 - 10s - loss: 3.2898 - accuracy1000: 0.3607 - val_loss: 3.3133 - val_accuracy1000: 0.3297 - 10s/epoch - 27ms/step
Epoch 10/50
385/385 - 11s - loss: 3.2886 - accuracy1000: 0.3592 - val_loss: 3.3162 - val_accuracy1000: 0.3309 - 11s/epoch - 28ms/step
Epoch 11/50
385/385 - 11s - loss: 3.2898 - accuracy1000: 0.3571 - val_loss: 3.3178 - val_accuracy1000: 0.3243 - 11s/epoch - 29ms/step
Epoch 12/50
385/385 - 10s - loss: 3.2874 - accuracy1000: 0.3616 - val_loss: 3.3184 - val_accuracy1000: 0.3274 - 10s/epoch - 27ms/step
Epoch 13/50
385/385 - 11s - loss: 3.2871 - accuracy1000: 0.3630 - val_loss: 3.3145 - val_accuracy1000: 0.3353 - 11s/epoch - 27ms/step
Epoch 14/50
385/385 - 11s - loss: 3.2844 - accuracy1000: 0.3643 - val_loss: 3.3143 - val_accuracy1000: 0.3298 - 11s/epoch - 27ms/step
Epoch 15/50
385/385 - 11s - loss: 3.2840 - accuracy1000: 0.3636 - val_loss: 3.3124 - val_accuracy1000: 0.3415 - 11s/epoch - 28ms/step
Epoch 16/50
385/385 - 11s - loss: 3.2796 - accuracy1000: 0.3706 - val_loss: 3.3157 - val_accuracy1000: 0.3479 - 11s/epoch - 27ms/step
testing model: results/CHTR/W3/deepVOL_L2/h1000
Evaluating performance on  test set...
1140/1140 - 15s - 15s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974162
{'0': {'precision': 0.285996339181046, 'recall': 0.16870276237731865, 'f1-score': 0.21222110307358907, 'support': 82429}, '1': {'precision': 0.41424276235658863, 'recall': 0.422068905666927, 'f1-score': 0.418119215773931, 'support': 115230}, '2': {'precision': 0.3296516026279116, 'recall': 0.44063611010580545, 'f1-score': 0.3771484277130661, 'support': 93946}, 'accuracy': 0.35643078822379587, 'macro avg': {'precision': 0.34329690138851543, 'recall': 0.3438025927166837, 'f1-score': 0.33582958218686204, 'support': 291605}, 'weighted avg': {'precision': 0.3507382768100202, 'recall': 0.35643078822379587, 'f1-score': 0.3467177748283282, 'support': 291605}}
[[13906 32311 36212]
 [18628 48635 47967]
 [16089 36461 41396]]
Evaluating performance on  train set...
385/385 - 4s - 4s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0968562
{'0': {'precision': 0.3409902130109384, 'recall': 0.18806756842573188, 'f1-score': 0.24242796332678457, 'support': 31494}, '1': {'precision': 0.34856213295100497, 'recall': 0.39100581467277, 'f1-score': 0.3685660558883981, 'support': 32332}, '2': {'precision': 0.36723983921393477, 'recall': 0.47538519353626457, 'f1-score': 0.4143726456099681, 'support': 34593}, 'accuracy': 0.35572399638281227, 'macro avg': {'precision': 0.35226406172529273, 'recall': 0.35148619221158883, 'f1-score': 0.3417888882750502, 'support': 98419}, 'weighted avg': {'precision': 0.3527040958459854, 'recall': 0.35572399638281227, 'f1-score': 0.34430239004240104, 'support': 98419}}
[[ 5923 11326 14245]
 [ 5600 12642 14090]
 [ 5847 12301 16445]]
Evaluating performance on  val set...
139/139 - 1s - 1s/epoch - 11ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0992235
{'0': {'precision': 0.3273301737756714, 'recall': 0.17803746348169788, 'f1-score': 0.23063223508459482, 'support': 11638}, '1': {'precision': 0.3790849673202614, 'recall': 0.4204822954822955, 'f1-score': 0.39871196497702516, 'support': 13104}, '2': {'precision': 0.2981524886253964, 'recall': 0.4069056355254492, 'f1-score': 0.34414163517008156, 'support': 10629}, 'accuracy': 0.3366317039382545, 'macro avg': {'precision': 0.3348558765737764, 'recall': 0.33514179816314754, 'f1-score': 0.3244952784105672, 'support': 35371}, 'weighted avg': {'precision': 0.33773602034902345, 'recall': 0.3366317039382545, 'f1-score': 0.3270108558196333, 'support': 35371}}
[[2072 4661 4905]
 [2318 5510 5276]
 [1940 4364 4325]]
training model: results/CHTR/W3/deepVOL_L3/h10
Epoch 1/50
385/385 - 18s - loss: 3.3273 - accuracy10: 0.3564 - val_loss: 3.3790 - val_accuracy10: 0.3228 - 18s/epoch - 47ms/step
Epoch 2/50
385/385 - 15s - loss: 3.3024 - accuracy10: 0.3609 - val_loss: 3.3737 - val_accuracy10: 0.3259 - 15s/epoch - 40ms/step
Epoch 3/50
385/385 - 15s - loss: 3.2970 - accuracy10: 0.3603 - val_loss: 3.3137 - val_accuracy10: 0.3360 - 15s/epoch - 40ms/step
Epoch 4/50
385/385 - 15s - loss: 3.2810 - accuracy10: 0.3666 - val_loss: 3.3107 - val_accuracy10: 0.3438 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 16s - loss: 3.2683 - accuracy10: 0.3752 - val_loss: 3.2810 - val_accuracy10: 0.3560 - 16s/epoch - 42ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2582 - accuracy10: 0.3812 - val_loss: 3.2813 - val_accuracy10: 0.3604 - 15s/epoch - 40ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2481 - accuracy10: 0.3872 - val_loss: 3.2903 - val_accuracy10: 0.3570 - 15s/epoch - 40ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2400 - accuracy10: 0.3901 - val_loss: 3.2907 - val_accuracy10: 0.3652 - 15s/epoch - 39ms/step
Epoch 9/50
385/385 - 15s - loss: 3.2353 - accuracy10: 0.3896 - val_loss: 3.2729 - val_accuracy10: 0.3693 - 15s/epoch - 39ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2270 - accuracy10: 0.3963 - val_loss: 3.2670 - val_accuracy10: 0.3683 - 15s/epoch - 39ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2237 - accuracy10: 0.3961 - val_loss: 3.2600 - val_accuracy10: 0.3734 - 15s/epoch - 39ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2216 - accuracy10: 0.3989 - val_loss: 3.2567 - val_accuracy10: 0.3754 - 15s/epoch - 38ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2154 - accuracy10: 0.4008 - val_loss: 3.2626 - val_accuracy10: 0.3725 - 15s/epoch - 40ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2124 - accuracy10: 0.4034 - val_loss: 3.2611 - val_accuracy10: 0.3749 - 15s/epoch - 40ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2089 - accuracy10: 0.4047 - val_loss: 3.2603 - val_accuracy10: 0.3774 - 15s/epoch - 39ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2044 - accuracy10: 0.4068 - val_loss: 3.2586 - val_accuracy10: 0.3767 - 15s/epoch - 40ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2016 - accuracy10: 0.4074 - val_loss: 3.2551 - val_accuracy10: 0.3803 - 15s/epoch - 39ms/step
Epoch 18/50
385/385 - 15s - loss: 3.1987 - accuracy10: 0.4100 - val_loss: 3.2523 - val_accuracy10: 0.3779 - 15s/epoch - 39ms/step
Epoch 19/50
385/385 - 15s - loss: 3.1953 - accuracy10: 0.4116 - val_loss: 3.2472 - val_accuracy10: 0.3864 - 15s/epoch - 39ms/step
Epoch 20/50
385/385 - 16s - loss: 3.1918 - accuracy10: 0.4138 - val_loss: 3.2512 - val_accuracy10: 0.3835 - 16s/epoch - 40ms/step
Epoch 21/50
385/385 - 15s - loss: 3.1866 - accuracy10: 0.4167 - val_loss: 3.2490 - val_accuracy10: 0.3857 - 15s/epoch - 39ms/step
Epoch 22/50
385/385 - 15s - loss: 3.1843 - accuracy10: 0.4175 - val_loss: 3.2518 - val_accuracy10: 0.3807 - 15s/epoch - 40ms/step
Epoch 23/50
385/385 - 15s - loss: 3.1780 - accuracy10: 0.4195 - val_loss: 3.2509 - val_accuracy10: 0.3826 - 15s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.1754 - accuracy10: 0.4211 - val_loss: 3.2563 - val_accuracy10: 0.3834 - 15s/epoch - 38ms/step
Epoch 25/50
385/385 - 15s - loss: 3.1733 - accuracy10: 0.4214 - val_loss: 3.2516 - val_accuracy10: 0.3836 - 15s/epoch - 40ms/step
Epoch 26/50
385/385 - 15s - loss: 3.1713 - accuracy10: 0.4205 - val_loss: 3.2535 - val_accuracy10: 0.3870 - 15s/epoch - 40ms/step
Epoch 27/50
385/385 - 15s - loss: 3.1674 - accuracy10: 0.4232 - val_loss: 3.2618 - val_accuracy10: 0.3859 - 15s/epoch - 40ms/step
Epoch 28/50
385/385 - 16s - loss: 3.1659 - accuracy10: 0.4235 - val_loss: 3.2532 - val_accuracy10: 0.3874 - 16s/epoch - 40ms/step
Epoch 29/50
385/385 - 16s - loss: 3.1627 - accuracy10: 0.4239 - val_loss: 3.2574 - val_accuracy10: 0.3889 - 16s/epoch - 41ms/step
testing model: results/CHTR/W3/deepVOL_L3/h10
Evaluating performance on  test set...
1140/1140 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0870478
{'0': {'precision': 0.40454434200864814, 'recall': 0.09610520501216215, 'f1-score': 0.1553135008574583, 'support': 103189}, '1': {'precision': 0.38388115007205104, 'recall': 0.5960831530830785, 'f1-score': 0.4670069830245303, 'support': 93851}, '2': {'precision': 0.3732994948953947, 'recall': 0.4790778829376619, 'f1-score': 0.41962524198104906, 'support': 94565}, 'accuracy': 0.3812143138835068, 'macro avg': {'precision': 0.38724166232536467, 'recall': 0.3904220803443008, 'f1-score': 0.3473152419543459, 'support': 291605}, 'weighted avg': {'precision': 0.38776160442285096, 'recall': 0.3812143138835068, 'f1-score': 0.34134386657208676, 'support': 291605}}
[[ 9917 48702 44570]
 [ 6421 55943 31487]
 [ 8176 41085 45304]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067419
{'0': {'precision': 0.426431718061674, 'recall': 0.08780841799709724, 'f1-score': 0.14562960734165786, 'support': 33072}, '1': {'precision': 0.41775825554945484, 'recall': 0.656598656228811, 'f1-score': 0.5106301382996572, 'support': 32446}, '2': {'precision': 0.3962031861719154, 'recall': 0.48907328044740284, 'f1-score': 0.437766955953968, 'support': 32901}, 'accuracy': 0.40946361982950447, 'macro avg': {'precision': 0.4134643865943481, 'recall': 0.41116011822443704, 'f1-score': 0.3646755671984277, 'support': 98419}, 'weighted avg': {'precision': 0.4134670659886352, 'recall': 0.40946361982950447, 'f1-score': 0.36362022027368174, 'support': 98419}}
[[ 2904 15157 15011]
 [ 1631 21304  9511]
 [ 2275 14535 16091]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0829529
{'0': {'precision': 0.4056379821958457, 'recall': 0.10882025155230059, 'f1-score': 0.17160431835300025, 'support': 12562}, '1': {'precision': 0.393315896541703, 'recall': 0.5888956574710643, 'f1-score': 0.47163367716754945, 'support': 11491}, '2': {'precision': 0.3686131386861314, 'recall': 0.48188725923308007, 'f1-score': 0.41770697710040594, 'support': 11318}, 'accuracy': 0.38415651239716153, 'macro avg': {'precision': 0.38918900580789334, 'recall': 0.39320105608548167, 'f1-score': 0.3536483242069852, 'support': 35371}, 'weighted avg': {'precision': 0.3897877018787865, 'recall': 0.38415651239716153, 'f1-score': 0.3478228944136466, 'support': 35371}}
[[1367 5650 5545]
 [ 927 6767 3797]
 [1076 4788 5454]]
training model: results/CHTR/W3/deepVOL_L3/h20
Epoch 1/50
385/385 - 18s - loss: 3.3331 - accuracy20: 0.3529 - val_loss: 3.3974 - val_accuracy20: 0.3279 - 18s/epoch - 46ms/step
Epoch 2/50
385/385 - 15s - loss: 3.3057 - accuracy20: 0.3557 - val_loss: 3.3199 - val_accuracy20: 0.3326 - 15s/epoch - 40ms/step
Epoch 3/50
385/385 - 16s - loss: 3.2939 - accuracy20: 0.3617 - val_loss: 3.3128 - val_accuracy20: 0.3410 - 16s/epoch - 41ms/step
Epoch 4/50
385/385 - 15s - loss: 3.2848 - accuracy20: 0.3644 - val_loss: 3.3032 - val_accuracy20: 0.3451 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 15s - loss: 3.2784 - accuracy20: 0.3689 - val_loss: 3.3073 - val_accuracy20: 0.3393 - 15s/epoch - 40ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2704 - accuracy20: 0.3724 - val_loss: 3.2933 - val_accuracy20: 0.3551 - 15s/epoch - 39ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2642 - accuracy20: 0.3796 - val_loss: 3.2841 - val_accuracy20: 0.3621 - 15s/epoch - 40ms/step
Epoch 8/50
385/385 - 16s - loss: 3.2553 - accuracy20: 0.3856 - val_loss: 3.2875 - val_accuracy20: 0.3660 - 16s/epoch - 41ms/step
Epoch 9/50
385/385 - 16s - loss: 3.2530 - accuracy20: 0.3876 - val_loss: 3.2771 - val_accuracy20: 0.3666 - 16s/epoch - 41ms/step
Epoch 10/50
385/385 - 16s - loss: 3.2464 - accuracy20: 0.3894 - val_loss: 3.2716 - val_accuracy20: 0.3720 - 16s/epoch - 41ms/step
Epoch 11/50
385/385 - 16s - loss: 3.2437 - accuracy20: 0.3913 - val_loss: 3.2838 - val_accuracy20: 0.3688 - 16s/epoch - 41ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2389 - accuracy20: 0.3958 - val_loss: 3.2731 - val_accuracy20: 0.3697 - 15s/epoch - 39ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2336 - accuracy20: 0.3971 - val_loss: 3.2698 - val_accuracy20: 0.3730 - 15s/epoch - 40ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2286 - accuracy20: 0.3988 - val_loss: 3.2675 - val_accuracy20: 0.3718 - 15s/epoch - 39ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2230 - accuracy20: 0.4017 - val_loss: 3.2614 - val_accuracy20: 0.3799 - 15s/epoch - 39ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2195 - accuracy20: 0.4054 - val_loss: 3.2625 - val_accuracy20: 0.3792 - 15s/epoch - 40ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2165 - accuracy20: 0.4057 - val_loss: 3.2644 - val_accuracy20: 0.3773 - 15s/epoch - 39ms/step
Epoch 18/50
385/385 - 16s - loss: 3.2139 - accuracy20: 0.4072 - val_loss: 3.2580 - val_accuracy20: 0.3827 - 16s/epoch - 41ms/step
Epoch 19/50
385/385 - 16s - loss: 3.2080 - accuracy20: 0.4088 - val_loss: 3.2627 - val_accuracy20: 0.3780 - 16s/epoch - 41ms/step
Epoch 20/50
385/385 - 16s - loss: 3.2042 - accuracy20: 0.4100 - val_loss: 3.2560 - val_accuracy20: 0.3835 - 16s/epoch - 42ms/step
Epoch 21/50
385/385 - 15s - loss: 3.2019 - accuracy20: 0.4138 - val_loss: 3.2637 - val_accuracy20: 0.3794 - 15s/epoch - 40ms/step
Epoch 22/50
385/385 - 15s - loss: 3.1978 - accuracy20: 0.4149 - val_loss: 3.2639 - val_accuracy20: 0.3777 - 15s/epoch - 39ms/step
Epoch 23/50
385/385 - 16s - loss: 3.1935 - accuracy20: 0.4159 - val_loss: 3.2586 - val_accuracy20: 0.3833 - 16s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.1899 - accuracy20: 0.4179 - val_loss: 3.2662 - val_accuracy20: 0.3828 - 15s/epoch - 39ms/step
Epoch 25/50
385/385 - 15s - loss: 3.1863 - accuracy20: 0.4199 - val_loss: 3.2611 - val_accuracy20: 0.3849 - 15s/epoch - 39ms/step
Epoch 26/50
385/385 - 15s - loss: 3.1838 - accuracy20: 0.4217 - val_loss: 3.2598 - val_accuracy20: 0.3842 - 15s/epoch - 40ms/step
Epoch 27/50
385/385 - 15s - loss: 3.1797 - accuracy20: 0.4236 - val_loss: 3.2598 - val_accuracy20: 0.3875 - 15s/epoch - 39ms/step
Epoch 28/50
385/385 - 15s - loss: 3.1756 - accuracy20: 0.4263 - val_loss: 3.2605 - val_accuracy20: 0.3852 - 15s/epoch - 39ms/step
Epoch 29/50
385/385 - 15s - loss: 3.1734 - accuracy20: 0.4251 - val_loss: 3.2612 - val_accuracy20: 0.3875 - 15s/epoch - 39ms/step
Epoch 30/50
385/385 - 15s - loss: 3.1689 - accuracy20: 0.4276 - val_loss: 3.2615 - val_accuracy20: 0.3883 - 15s/epoch - 39ms/step
testing model: results/CHTR/W3/deepVOL_L3/h20
Evaluating performance on  test set...
1140/1140 - 22s - 22s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.086109
{'0': {'precision': 0.3968953528230743, 'recall': 0.16454514079217167, 'f1-score': 0.23264157983868655, 'support': 98514}, '1': {'precision': 0.39231919370915935, 'recall': 0.5804172171188055, 'f1-score': 0.46818194960162896, 'support': 97647}, '2': {'precision': 0.38981552037178147, 'recall': 0.43414986798541555, 'f1-score': 0.41078996545109375, 'support': 95444}, 'accuracy': 0.3920474614632808, 'macro avg': {'precision': 0.3930100223013384, 'recall': 0.3930374086321309, 'f1-score': 0.37053783163046977, 'support': 291605}, 'weighted avg': {'precision': 0.3930457077982028, 'recall': 0.3920474614632808, 'f1-score': 0.369823744076723, 'support': 291605}}
[[16210 46826 35478]
 [11587 56676 29384]
 [13045 40962 41437]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.074208
{'0': {'precision': 0.44001380977041255, 'recall': 0.15202481063994752, 'f1-score': 0.22597517730496453, 'support': 33534}, '1': {'precision': 0.4016635205285512, 'recall': 0.6296273464229571, 'f1-score': 0.49045006542695585, 'support': 32443}, '2': {'precision': 0.3908886232871001, 'recall': 0.43348128968620925, 'f1-score': 0.4110846402315147, 'support': 32442}, 'accuracy': 0.40223940499293837, 'macro avg': {'precision': 0.4108553178620213, 'recall': 0.40504448224970463, 'f1-score': 0.3758366276544784, 'support': 98419}, 'weighted avg': {'precision': 0.41117875014000244, 'recall': 0.40223940499293837, 'f1-score': 0.3741750166815575, 'support': 98419}}
[[ 5098 15564 12872]
 [ 2974 20427  9042]
 [ 3514 14865 14063]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0870833
{'0': {'precision': 0.3976497346474602, 'recall': 0.16898912605718888, 'f1-score': 0.237182748290091, 'support': 12415}, '1': {'precision': 0.387142603445214, 'recall': 0.5576873880787925, 'f1-score': 0.45702306079664573, 'support': 11727}, '2': {'precision': 0.3709286471746705, 'recall': 0.43610294772464153, 'f1-score': 0.4008841226310834, 'support': 11229}, 'accuracy': 0.3826581097509259, 'macro avg': {'precision': 0.3852403284224482, 'recall': 0.38759315395354094, 'f1-score': 0.36502997723927333, 'support': 35371}, 'weighted avg': {'precision': 0.38568320221013314, 'recall': 0.3826581097509259, 'f1-score': 0.36203842320002766, 'support': 35371}}
[[2098 5611 4706]
 [1588 6540 3599]
 [1590 4742 4897]]
training model: results/CHTR/W3/deepVOL_L3/h30
Epoch 1/50
385/385 - 17s - loss: 3.3311 - accuracy30: 0.3484 - val_loss: 3.3723 - val_accuracy30: 0.3355 - 17s/epoch - 45ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3095 - accuracy30: 0.3492 - val_loss: 3.3157 - val_accuracy30: 0.3289 - 16s/epoch - 40ms/step
Epoch 3/50
385/385 - 15s - loss: 3.3020 - accuracy30: 0.3459 - val_loss: 3.3098 - val_accuracy30: 0.3335 - 15s/epoch - 40ms/step
Epoch 4/50
385/385 - 15s - loss: 3.2943 - accuracy30: 0.3534 - val_loss: 3.3064 - val_accuracy30: 0.3319 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 16s - loss: 3.2897 - accuracy30: 0.3565 - val_loss: 3.3033 - val_accuracy30: 0.3391 - 16s/epoch - 41ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2854 - accuracy30: 0.3635 - val_loss: 3.3039 - val_accuracy30: 0.3396 - 15s/epoch - 39ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2812 - accuracy30: 0.3672 - val_loss: 3.3011 - val_accuracy30: 0.3459 - 15s/epoch - 40ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2772 - accuracy30: 0.3674 - val_loss: 3.2959 - val_accuracy30: 0.3518 - 15s/epoch - 40ms/step
Epoch 9/50
385/385 - 15s - loss: 3.2770 - accuracy30: 0.3678 - val_loss: 3.2959 - val_accuracy30: 0.3518 - 15s/epoch - 39ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2730 - accuracy30: 0.3720 - val_loss: 3.2907 - val_accuracy30: 0.3560 - 15s/epoch - 39ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2677 - accuracy30: 0.3766 - val_loss: 3.2869 - val_accuracy30: 0.3592 - 15s/epoch - 39ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2646 - accuracy30: 0.3798 - val_loss: 3.2909 - val_accuracy30: 0.3573 - 15s/epoch - 40ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2618 - accuracy30: 0.3809 - val_loss: 3.2889 - val_accuracy30: 0.3613 - 15s/epoch - 40ms/step
Epoch 14/50
385/385 - 16s - loss: 3.2579 - accuracy30: 0.3826 - val_loss: 3.2918 - val_accuracy30: 0.3605 - 16s/epoch - 40ms/step
Epoch 15/50
385/385 - 16s - loss: 3.2536 - accuracy30: 0.3851 - val_loss: 3.2866 - val_accuracy30: 0.3617 - 16s/epoch - 40ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2503 - accuracy30: 0.3885 - val_loss: 3.2862 - val_accuracy30: 0.3622 - 15s/epoch - 40ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2481 - accuracy30: 0.3879 - val_loss: 3.2798 - val_accuracy30: 0.3682 - 15s/epoch - 40ms/step
Epoch 18/50
385/385 - 15s - loss: 3.2451 - accuracy30: 0.3906 - val_loss: 3.2791 - val_accuracy30: 0.3697 - 15s/epoch - 40ms/step
Epoch 19/50
385/385 - 15s - loss: 3.2419 - accuracy30: 0.3933 - val_loss: 3.2797 - val_accuracy30: 0.3675 - 15s/epoch - 40ms/step
Epoch 20/50
385/385 - 15s - loss: 3.2369 - accuracy30: 0.3953 - val_loss: 3.2927 - val_accuracy30: 0.3646 - 15s/epoch - 40ms/step
Epoch 21/50
385/385 - 15s - loss: 3.2345 - accuracy30: 0.3960 - val_loss: 3.2778 - val_accuracy30: 0.3691 - 15s/epoch - 40ms/step
Epoch 22/50
385/385 - 16s - loss: 3.2313 - accuracy30: 0.3962 - val_loss: 3.2872 - val_accuracy30: 0.3678 - 16s/epoch - 40ms/step
Epoch 23/50
385/385 - 15s - loss: 3.2263 - accuracy30: 0.3991 - val_loss: 3.2817 - val_accuracy30: 0.3687 - 15s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.2241 - accuracy30: 0.4028 - val_loss: 3.2849 - val_accuracy30: 0.3708 - 15s/epoch - 40ms/step
Epoch 25/50
385/385 - 15s - loss: 3.2202 - accuracy30: 0.4023 - val_loss: 3.2802 - val_accuracy30: 0.3757 - 15s/epoch - 40ms/step
Epoch 26/50
385/385 - 15s - loss: 3.2171 - accuracy30: 0.4044 - val_loss: 3.2814 - val_accuracy30: 0.3714 - 15s/epoch - 39ms/step
Epoch 27/50
385/385 - 15s - loss: 3.2120 - accuracy30: 0.4067 - val_loss: 3.2881 - val_accuracy30: 0.3695 - 15s/epoch - 39ms/step
Epoch 28/50
385/385 - 15s - loss: 3.2081 - accuracy30: 0.4086 - val_loss: 3.2846 - val_accuracy30: 0.3759 - 15s/epoch - 40ms/step
Epoch 29/50
385/385 - 16s - loss: 3.2044 - accuracy30: 0.4113 - val_loss: 3.2876 - val_accuracy30: 0.3731 - 16s/epoch - 41ms/step
Epoch 30/50
385/385 - 15s - loss: 3.2012 - accuracy30: 0.4122 - val_loss: 3.2873 - val_accuracy30: 0.3738 - 15s/epoch - 39ms/step
Epoch 31/50
385/385 - 15s - loss: 3.1981 - accuracy30: 0.4138 - val_loss: 3.3029 - val_accuracy30: 0.3719 - 15s/epoch - 39ms/step
testing model: results/CHTR/W3/deepVOL_L3/h30
Evaluating performance on  test set...
1140/1140 - 20s - 20s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0890845
{'0': {'precision': 0.3769761636728501, 'recall': 0.08005404843571354, 'f1-score': 0.1320633396490085, 'support': 96210}, '1': {'precision': 0.3823325829886983, 'recall': 0.6612111457599839, 'f1-score': 0.4845078520331256, 'support': 99410}, '2': {'precision': 0.38604374678851017, 'recall': 0.3991873730270355, 'f1-score': 0.3925055573197841, 'support': 95985}, 'accuracy': 0.3832204523242057, 'macro avg': {'precision': 0.38178416448335284, 'recall': 0.38015085574091095, 'f1-score': 0.3363589163339727, 'support': 291605}, 'weighted avg': {'precision': 0.3817868960318463, 'recall': 0.3832204523242057, 'f1-score': 0.3379413432471446, 'support': 291605}}
[[ 7702 54862 33646]
 [ 6388 65731 27291]
 [ 6341 51328 38316]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0833155
{'0': {'precision': 0.419257165926524, 'recall': 0.061681465862857485, 'f1-score': 0.10754135708183395, 'support': 33673}, '1': {'precision': 0.3800009793839675, 'recall': 0.7192510890722031, 'f1-score': 0.4972765139378404, 'support': 32367}, '2': {'precision': 0.38084591019191355, 'recall': 0.3787640137125915, 'f1-score': 0.3798021089794212, 'support': 32379}, 'accuracy': 0.3822534266757435, 'macro avg': {'precision': 0.39336801850080166, 'recall': 0.3865655228825507, 'f1-score': 0.3282066599996985, 'support': 98419}, 'weighted avg': {'precision': 0.39371003540036664, 'recall': 0.3822534266757435, 'f1-score': 0.32528476747667984, 'support': 98419}}
[[ 2077 19405 12191]
 [ 1340 23280  7747]
 [ 1537 18578 12264]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0939813
{'0': {'precision': 0.3684030157642221, 'recall': 0.08734156646083847, 'f1-score': 0.1412058321292526, 'support': 12308}, '1': {'precision': 0.36868662127075885, 'recall': 0.6315877811346089, 'f1-score': 0.4655881716106282, 'support': 11916}, '2': {'precision': 0.3611295681063123, 'recall': 0.39006010585807843, 'f1-score': 0.3750377366627852, 'support': 11147}, 'accuracy': 0.36609086539820757, 'macro avg': {'precision': 0.366073068380431, 'recall': 0.36966315115117526, 'f1-score': 0.32727724680088865, 'support': 35371}, 'weighted avg': {'precision': 0.36620636659323935, 'recall': 0.36609086539820757, 'f1-score': 0.32417674607274755, 'support': 35371}}
[[1075 6912 4321]
 [1019 7526 3371]
 [ 824 5975 4348]]
training model: results/CHTR/W3/deepVOL_L3/h50
Epoch 1/50
385/385 - 17s - loss: 3.3367 - accuracy50: 0.3494 - val_loss: 3.4119 - val_accuracy50: 0.3376 - 17s/epoch - 45ms/step
Epoch 2/50
385/385 - 15s - loss: 3.3143 - accuracy50: 0.3487 - val_loss: 3.3234 - val_accuracy50: 0.3325 - 15s/epoch - 40ms/step
Epoch 3/50
385/385 - 16s - loss: 3.3028 - accuracy50: 0.3488 - val_loss: 3.3303 - val_accuracy50: 0.3264 - 16s/epoch - 40ms/step
Epoch 4/50
385/385 - 15s - loss: 3.3035 - accuracy50: 0.3513 - val_loss: 3.3228 - val_accuracy50: 0.3191 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 15s - loss: 3.2978 - accuracy50: 0.3484 - val_loss: 3.3194 - val_accuracy50: 0.3268 - 15s/epoch - 40ms/step
Epoch 6/50
385/385 - 16s - loss: 3.2939 - accuracy50: 0.3514 - val_loss: 3.3102 - val_accuracy50: 0.3259 - 16s/epoch - 41ms/step
Epoch 7/50
385/385 - 16s - loss: 3.2921 - accuracy50: 0.3534 - val_loss: 3.3047 - val_accuracy50: 0.3289 - 16s/epoch - 41ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2897 - accuracy50: 0.3560 - val_loss: 3.3073 - val_accuracy50: 0.3311 - 15s/epoch - 40ms/step
Epoch 9/50
385/385 - 16s - loss: 3.2873 - accuracy50: 0.3581 - val_loss: 3.3018 - val_accuracy50: 0.3384 - 16s/epoch - 41ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2846 - accuracy50: 0.3611 - val_loss: 3.3054 - val_accuracy50: 0.3341 - 15s/epoch - 40ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2818 - accuracy50: 0.3641 - val_loss: 3.3060 - val_accuracy50: 0.3351 - 15s/epoch - 40ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2800 - accuracy50: 0.3652 - val_loss: 3.3050 - val_accuracy50: 0.3409 - 15s/epoch - 40ms/step
Epoch 13/50
385/385 - 16s - loss: 3.2773 - accuracy50: 0.3685 - val_loss: 3.3060 - val_accuracy50: 0.3395 - 16s/epoch - 42ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2754 - accuracy50: 0.3691 - val_loss: 3.3046 - val_accuracy50: 0.3373 - 15s/epoch - 39ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2725 - accuracy50: 0.3699 - val_loss: 3.3104 - val_accuracy50: 0.3428 - 15s/epoch - 39ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2695 - accuracy50: 0.3732 - val_loss: 3.3118 - val_accuracy50: 0.3494 - 15s/epoch - 39ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2664 - accuracy50: 0.3767 - val_loss: 3.3074 - val_accuracy50: 0.3497 - 15s/epoch - 40ms/step
Epoch 18/50
385/385 - 16s - loss: 3.2638 - accuracy50: 0.3763 - val_loss: 3.3065 - val_accuracy50: 0.3484 - 16s/epoch - 40ms/step
Epoch 19/50
385/385 - 15s - loss: 3.2622 - accuracy50: 0.3792 - val_loss: 3.3009 - val_accuracy50: 0.3606 - 15s/epoch - 39ms/step
Epoch 20/50
385/385 - 16s - loss: 3.2582 - accuracy50: 0.3808 - val_loss: 3.3030 - val_accuracy50: 0.3530 - 16s/epoch - 40ms/step
Epoch 21/50
385/385 - 15s - loss: 3.2558 - accuracy50: 0.3835 - val_loss: 3.3076 - val_accuracy50: 0.3536 - 15s/epoch - 39ms/step
Epoch 22/50
385/385 - 15s - loss: 3.2514 - accuracy50: 0.3852 - val_loss: 3.3015 - val_accuracy50: 0.3567 - 15s/epoch - 39ms/step
Epoch 23/50
385/385 - 15s - loss: 3.2486 - accuracy50: 0.3873 - val_loss: 3.3004 - val_accuracy50: 0.3578 - 15s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.2462 - accuracy50: 0.3890 - val_loss: 3.3015 - val_accuracy50: 0.3598 - 15s/epoch - 40ms/step
Epoch 25/50
385/385 - 15s - loss: 3.2431 - accuracy50: 0.3891 - val_loss: 3.3016 - val_accuracy50: 0.3576 - 15s/epoch - 40ms/step
Epoch 26/50
385/385 - 15s - loss: 3.2410 - accuracy50: 0.3914 - val_loss: 3.3066 - val_accuracy50: 0.3561 - 15s/epoch - 39ms/step
Epoch 27/50
385/385 - 15s - loss: 3.2384 - accuracy50: 0.3941 - val_loss: 3.3101 - val_accuracy50: 0.3578 - 15s/epoch - 40ms/step
Epoch 28/50
385/385 - 15s - loss: 3.2352 - accuracy50: 0.3956 - val_loss: 3.3039 - val_accuracy50: 0.3591 - 15s/epoch - 40ms/step
Epoch 29/50
385/385 - 15s - loss: 3.2303 - accuracy50: 0.3961 - val_loss: 3.3018 - val_accuracy50: 0.3607 - 15s/epoch - 39ms/step
Epoch 30/50
385/385 - 16s - loss: 3.2299 - accuracy50: 0.3964 - val_loss: 3.3113 - val_accuracy50: 0.3585 - 16s/epoch - 41ms/step
Epoch 31/50
385/385 - 15s - loss: 3.2260 - accuracy50: 0.3991 - val_loss: 3.3162 - val_accuracy50: 0.3584 - 15s/epoch - 40ms/step
Epoch 32/50
385/385 - 15s - loss: 3.2234 - accuracy50: 0.4004 - val_loss: 3.3165 - val_accuracy50: 0.3584 - 15s/epoch - 39ms/step
Epoch 33/50
385/385 - 15s - loss: 3.2203 - accuracy50: 0.4037 - val_loss: 3.3192 - val_accuracy50: 0.3577 - 15s/epoch - 39ms/step
testing model: results/CHTR/W3/deepVOL_L3/h50
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0960314
{'0': {'precision': 0.35710860704866937, 'recall': 0.12659222981227888, 'f1-score': 0.18692204522459352, 'support': 94129}, '1': {'precision': 0.3806781955974471, 'recall': 0.572094631303403, 'f1-score': 0.45715819302690885, 'support': 101235}, '2': {'precision': 0.3732681106147147, 'recall': 0.41149821801519104, 'f1-score': 0.39145196921997244, 'support': 96241}, 'accuracy': 0.3752850602698856, 'macro avg': {'precision': 0.3703516377536104, 'recall': 0.3700616930436243, 'f1-score': 0.3451774024904916, 'support': 291605}, 'weighted avg': {'precision': 0.3706244043753108, 'recall': 0.3752850602698856, 'f1-score': 0.3482413670400859, 'support': 291605}}
[[11916 48527 33686]
 [10510 57916 32809]
 [10942 45696 39603]]
Evaluating performance on  train set...
385/385 - 8s - 8s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892895
{'0': {'precision': 0.4422528222304925, 'recall': 0.10592464939386736, 'f1-score': 0.17091353644797083, 'support': 33656}, '1': {'precision': 0.36807344175436013, 'recall': 0.616871704745167, 'f1-score': 0.4610492113055802, 'support': 32433}, '2': {'precision': 0.363090939392256, 'recall': 0.40433034333436435, 'f1-score': 0.38260258736755837, 'support': 32330}, 'accuracy': 0.37232648167528626, 'macro avg': {'precision': 0.39113906779236957, 'recall': 0.37570889915779954, 'f1-score': 0.33818844504036977, 'support': 98419}, 'weighted avg': {'precision': 0.39180358459200215, 'recall': 0.37232648167528626, 'f1-score': 0.33606332824515545, 'support': 98419}}
[[ 3565 17381 12710]
 [ 2206 20007 10220]
 [ 2290 16968 13072]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1008855
{'0': {'precision': 0.3581928231733679, 'recall': 0.1364122828681979, 'f1-score': 0.19757944315268586, 'support': 12147}, '1': {'precision': 0.3688940346234425, 'recall': 0.5484426229508197, 'f1-score': 0.44109697409189796, 'support': 12200}, '2': {'precision': 0.3438565876100579, 'recall': 0.39323294629898403, 'f1-score': 0.3668909483305827, 'support': 11024}, 'accuracy': 0.3585705804189873, 'macro avg': {'precision': 0.35698114846895607, 'recall': 0.3593626173726672, 'f1-score': 0.33518912185838884, 'support': 35371}, 'weighted avg': {'precision': 0.3574156927230267, 'recall': 0.3585705804189873, 'f1-score': 0.3343413076897225, 'support': 35371}}
[[1657 6113 4377]
 [1614 6691 3895]
 [1355 5334 4335]]
training model: results/CHTR/W3/deepVOL_L3/h100
Epoch 1/50
385/385 - 19s - loss: 3.3387 - accuracy100: 0.3500 - val_loss: 3.3773 - val_accuracy100: 0.3492 - 19s/epoch - 50ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3173 - accuracy100: 0.3353 - val_loss: 3.3206 - val_accuracy100: 0.3123 - 16s/epoch - 42ms/step
Epoch 3/50
385/385 - 16s - loss: 3.3040 - accuracy100: 0.3380 - val_loss: 3.3238 - val_accuracy100: 0.3094 - 16s/epoch - 41ms/step
Epoch 4/50
385/385 - 17s - loss: 3.3024 - accuracy100: 0.3354 - val_loss: 3.3216 - val_accuracy100: 0.3101 - 17s/epoch - 43ms/step
Epoch 5/50
385/385 - 16s - loss: 3.3016 - accuracy100: 0.3359 - val_loss: 3.3214 - val_accuracy100: 0.3111 - 16s/epoch - 40ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2999 - accuracy100: 0.3387 - val_loss: 3.3205 - val_accuracy100: 0.3095 - 15s/epoch - 39ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2998 - accuracy100: 0.3358 - val_loss: 3.3192 - val_accuracy100: 0.3105 - 15s/epoch - 40ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2994 - accuracy100: 0.3377 - val_loss: 3.3205 - val_accuracy100: 0.3103 - 15s/epoch - 40ms/step
Epoch 9/50
385/385 - 15s - loss: 3.2983 - accuracy100: 0.3403 - val_loss: 3.3174 - val_accuracy100: 0.3138 - 15s/epoch - 40ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2974 - accuracy100: 0.3418 - val_loss: 3.3164 - val_accuracy100: 0.3133 - 15s/epoch - 40ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2966 - accuracy100: 0.3437 - val_loss: 3.3146 - val_accuracy100: 0.3181 - 15s/epoch - 40ms/step
Epoch 12/50
385/385 - 16s - loss: 3.2950 - accuracy100: 0.3457 - val_loss: 3.3152 - val_accuracy100: 0.3167 - 16s/epoch - 41ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2940 - accuracy100: 0.3477 - val_loss: 3.3140 - val_accuracy100: 0.3213 - 15s/epoch - 39ms/step
Epoch 14/50
385/385 - 16s - loss: 3.2937 - accuracy100: 0.3467 - val_loss: 3.3129 - val_accuracy100: 0.3195 - 16s/epoch - 41ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2910 - accuracy100: 0.3525 - val_loss: 3.3130 - val_accuracy100: 0.3214 - 15s/epoch - 40ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2902 - accuracy100: 0.3515 - val_loss: 3.3128 - val_accuracy100: 0.3272 - 15s/epoch - 40ms/step
Epoch 17/50
385/385 - 16s - loss: 3.2887 - accuracy100: 0.3534 - val_loss: 3.3133 - val_accuracy100: 0.3240 - 16s/epoch - 41ms/step
Epoch 18/50
385/385 - 15s - loss: 3.2874 - accuracy100: 0.3570 - val_loss: 3.3113 - val_accuracy100: 0.3244 - 15s/epoch - 40ms/step
Epoch 19/50
385/385 - 15s - loss: 3.2851 - accuracy100: 0.3591 - val_loss: 3.3122 - val_accuracy100: 0.3308 - 15s/epoch - 40ms/step
Epoch 20/50
385/385 - 15s - loss: 3.2836 - accuracy100: 0.3587 - val_loss: 3.3070 - val_accuracy100: 0.3349 - 15s/epoch - 40ms/step
Epoch 21/50
385/385 - 15s - loss: 3.2805 - accuracy100: 0.3610 - val_loss: 3.3087 - val_accuracy100: 0.3343 - 15s/epoch - 39ms/step
Epoch 22/50
385/385 - 16s - loss: 3.2783 - accuracy100: 0.3630 - val_loss: 3.3054 - val_accuracy100: 0.3384 - 16s/epoch - 41ms/step
Epoch 23/50
385/385 - 15s - loss: 3.2768 - accuracy100: 0.3664 - val_loss: 3.3063 - val_accuracy100: 0.3383 - 15s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.2748 - accuracy100: 0.3679 - val_loss: 3.3109 - val_accuracy100: 0.3381 - 15s/epoch - 40ms/step
Epoch 25/50
385/385 - 16s - loss: 3.2734 - accuracy100: 0.3704 - val_loss: 3.3085 - val_accuracy100: 0.3412 - 16s/epoch - 40ms/step
Epoch 26/50
385/385 - 15s - loss: 3.2705 - accuracy100: 0.3729 - val_loss: 3.3052 - val_accuracy100: 0.3509 - 15s/epoch - 40ms/step
Epoch 27/50
385/385 - 15s - loss: 3.2698 - accuracy100: 0.3716 - val_loss: 3.3035 - val_accuracy100: 0.3480 - 15s/epoch - 39ms/step
Epoch 28/50
385/385 - 15s - loss: 3.2666 - accuracy100: 0.3739 - val_loss: 3.3024 - val_accuracy100: 0.3484 - 15s/epoch - 40ms/step
Epoch 29/50
385/385 - 16s - loss: 3.2654 - accuracy100: 0.3754 - val_loss: 3.3037 - val_accuracy100: 0.3490 - 16s/epoch - 40ms/step
Epoch 30/50
385/385 - 15s - loss: 3.2628 - accuracy100: 0.3782 - val_loss: 3.3048 - val_accuracy100: 0.3502 - 15s/epoch - 39ms/step
Epoch 31/50
385/385 - 16s - loss: 3.2602 - accuracy100: 0.3802 - val_loss: 3.3093 - val_accuracy100: 0.3512 - 16s/epoch - 41ms/step
Epoch 32/50
385/385 - 15s - loss: 3.2572 - accuracy100: 0.3821 - val_loss: 3.3108 - val_accuracy100: 0.3505 - 15s/epoch - 40ms/step
Epoch 33/50
385/385 - 15s - loss: 3.2534 - accuracy100: 0.3836 - val_loss: 3.3073 - val_accuracy100: 0.3537 - 15s/epoch - 40ms/step
Epoch 34/50
385/385 - 16s - loss: 3.2547 - accuracy100: 0.3821 - val_loss: 3.3040 - val_accuracy100: 0.3550 - 16s/epoch - 41ms/step
Epoch 35/50
385/385 - 16s - loss: 3.2501 - accuracy100: 0.3867 - val_loss: 3.3055 - val_accuracy100: 0.3557 - 16s/epoch - 40ms/step
Epoch 36/50
385/385 - 16s - loss: 3.2489 - accuracy100: 0.3850 - val_loss: 3.3109 - val_accuracy100: 0.3539 - 16s/epoch - 41ms/step
Epoch 37/50
385/385 - 15s - loss: 3.2444 - accuracy100: 0.3883 - val_loss: 3.3133 - val_accuracy100: 0.3524 - 15s/epoch - 39ms/step
Epoch 38/50
385/385 - 16s - loss: 3.2408 - accuracy100: 0.3916 - val_loss: 3.3227 - val_accuracy100: 0.3498 - 16s/epoch - 41ms/step
testing model: results/CHTR/W3/deepVOL_L3/h100
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1026745
{'0': {'precision': 0.32060627097072775, 'recall': 0.2076944492033579, 'f1-score': 0.2520842403488137, 'support': 93392}, '1': {'precision': 0.3595689548801053, 'recall': 0.42725326712737155, 'f1-score': 0.3904999285305889, 'support': 102307}, '2': {'precision': 0.3378614009622144, 'recall': 0.3858882655933935, 'f1-score': 0.360281340504758, 'support': 95906}, 'accuracy': 0.34333087567085613, 'macro avg': {'precision': 0.3393455422710159, 'recall': 0.3402786606413743, 'f1-score': 0.3342885031280535, 'support': 291605}, 'weighted avg': {'precision': 0.3399510208881853, 'recall': 0.34333087567085613, 'f1-score': 0.336231099622039, 'support': 291605}}
[[19397 39407 34588]
 [20654 43711 37942]
 [20450 38447 37009]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0914258
{'0': {'precision': 0.4115147050490168, 'recall': 0.21821569157727094, 'f1-score': 0.28519813062090094, 'support': 33279}, '1': {'precision': 0.36442757279755567, 'recall': 0.4834489958852791, 'f1-score': 0.41558441558441556, 'support': 32566}, '2': {'precision': 0.3448762310354006, 'recall': 0.3977712285872168, 'f1-score': 0.3694400091240876, 'support': 32574}, 'accuracy': 0.36540708603013644, 'macro avg': {'precision': 0.37360616962732435, 'recall': 0.36647863868325564, 'f1-score': 0.356740851776468, 'support': 98419}, 'weighted avg': {'precision': 0.373878464064851, 'recall': 0.36540708603013644, 'f1-score': 0.35622359020171984, 'support': 98419}}
[[ 7262 13385 12632]
 [ 4841 15744 11981]
 [ 5544 14073 12957]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011207
{'0': {'precision': 0.3432253026161656, 'recall': 0.22452107279693487, 'f1-score': 0.2714638665843113, 'support': 11745}, '1': {'precision': 0.3787059226292366, 'recall': 0.4331245105716523, 'f1-score': 0.4040913242009132, 'support': 12770}, '2': {'precision': 0.31697622869372466, 'recall': 0.38200073691967573, 'f1-score': 0.3464639291532645, 'support': 10856}, 'accuracy': 0.34816657713946453, 'macro avg': {'precision': 0.3463024846463756, 'recall': 0.346548773429421, 'f1-score': 0.3406730399794964, 'support': 35371}, 'weighted avg': {'precision': 0.3479785629442564, 'recall': 0.34816657713946453, 'f1-score': 0.3423652635765525, 'support': 35371}}
[[2637 4746 4362]
 [2665 5531 4574]
 [2381 4328 4147]]
training model: results/CHTR/W3/deepVOL_L3/h200
Epoch 1/50
385/385 - 19s - loss: 3.3395 - accuracy200: 0.3516 - val_loss: 3.4407 - val_accuracy200: 0.3647 - 19s/epoch - 50ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3161 - accuracy200: 0.3467 - val_loss: 3.3373 - val_accuracy200: 0.3661 - 16s/epoch - 42ms/step
Epoch 3/50
385/385 - 17s - loss: 3.3030 - accuracy200: 0.3417 - val_loss: 3.3224 - val_accuracy200: 0.3115 - 17s/epoch - 43ms/step
Epoch 4/50
385/385 - 15s - loss: 3.3001 - accuracy200: 0.3401 - val_loss: 3.3130 - val_accuracy200: 0.3160 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 15s - loss: 3.2972 - accuracy200: 0.3410 - val_loss: 3.3134 - val_accuracy200: 0.3146 - 15s/epoch - 39ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2955 - accuracy200: 0.3434 - val_loss: 3.3120 - val_accuracy200: 0.3177 - 15s/epoch - 40ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2941 - accuracy200: 0.3453 - val_loss: 3.3105 - val_accuracy200: 0.3164 - 15s/epoch - 40ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2925 - accuracy200: 0.3477 - val_loss: 3.3101 - val_accuracy200: 0.3187 - 15s/epoch - 39ms/step
Epoch 9/50
385/385 - 16s - loss: 3.2924 - accuracy200: 0.3514 - val_loss: 3.3051 - val_accuracy200: 0.3236 - 16s/epoch - 40ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2899 - accuracy200: 0.3544 - val_loss: 3.3048 - val_accuracy200: 0.3268 - 15s/epoch - 40ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2891 - accuracy200: 0.3558 - val_loss: 3.3031 - val_accuracy200: 0.3287 - 15s/epoch - 40ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2864 - accuracy200: 0.3595 - val_loss: 3.3013 - val_accuracy200: 0.3330 - 15s/epoch - 40ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2852 - accuracy200: 0.3620 - val_loss: 3.3011 - val_accuracy200: 0.3304 - 15s/epoch - 40ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2836 - accuracy200: 0.3621 - val_loss: 3.2983 - val_accuracy200: 0.3361 - 15s/epoch - 40ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2833 - accuracy200: 0.3639 - val_loss: 3.2994 - val_accuracy200: 0.3327 - 15s/epoch - 39ms/step
Epoch 16/50
385/385 - 16s - loss: 3.2817 - accuracy200: 0.3629 - val_loss: 3.2988 - val_accuracy200: 0.3432 - 16s/epoch - 40ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2781 - accuracy200: 0.3686 - val_loss: 3.2990 - val_accuracy200: 0.3567 - 15s/epoch - 40ms/step
Epoch 18/50
385/385 - 16s - loss: 3.2762 - accuracy200: 0.3685 - val_loss: 3.2989 - val_accuracy200: 0.3539 - 16s/epoch - 41ms/step
Epoch 19/50
385/385 - 15s - loss: 3.2747 - accuracy200: 0.3702 - val_loss: 3.3009 - val_accuracy200: 0.3551 - 15s/epoch - 39ms/step
Epoch 20/50
385/385 - 15s - loss: 3.2733 - accuracy200: 0.3730 - val_loss: 3.3028 - val_accuracy200: 0.3554 - 15s/epoch - 40ms/step
Epoch 21/50
385/385 - 16s - loss: 3.2696 - accuracy200: 0.3725 - val_loss: 3.3063 - val_accuracy200: 0.3565 - 16s/epoch - 42ms/step
Epoch 22/50
385/385 - 16s - loss: 3.2690 - accuracy200: 0.3759 - val_loss: 3.3078 - val_accuracy200: 0.3581 - 16s/epoch - 40ms/step
Epoch 23/50
385/385 - 16s - loss: 3.2661 - accuracy200: 0.3784 - val_loss: 3.3144 - val_accuracy200: 0.3615 - 16s/epoch - 40ms/step
Epoch 24/50
385/385 - 15s - loss: 3.2650 - accuracy200: 0.3768 - val_loss: 3.3183 - val_accuracy200: 0.3560 - 15s/epoch - 40ms/step
testing model: results/CHTR/W3/deepVOL_L3/h200
Evaluating performance on  test set...
1140/1140 - 21s - 21s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001351
{'0': {'precision': 0.31743609935361095, 'recall': 0.21266843991119122, 'f1-score': 0.2546993470935131, 'support': 90982}, '1': {'precision': 0.37297304360324574, 'recall': 0.26774726099354645, 'f1-score': 0.31171951359350003, 'support': 106608}, '2': {'precision': 0.32296911497534386, 'recall': 0.5294474286018188, 'f1-score': 0.40120095915529846, 'support': 94015}, 'accuracy': 0.3349359578882392, 'macro avg': {'precision': 0.3377927526440668, 'recall': 0.33662104316885216, 'f1-score': 0.3225399399474372, 'support': 291605}, 'weighted avg': {'precision': 0.3395237487980385, 'recall': 0.3349359578882392, 'f1-score': 0.3227782722430111, 'support': 291605}}
[[19349 23144 48489]
 [22209 28544 55855]
 [19396 24843 49776]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956699
{'0': {'precision': 0.36815607300188796, 'recall': 0.2142464750045779, 'f1-score': 0.270864683412432, 'support': 32766}, '1': {'precision': 0.3624036160595586, 'recall': 0.25196413716609667, 'f1-score': 0.29725751049561094, 'support': 32457}, '2': {'precision': 0.3498811305802589, 'recall': 0.5985058440775997, 'f1-score': 0.4416043386937242, 'support': 33196}, 'accuracy': 0.35629299220678934, 'macro avg': {'precision': 0.3601469398805685, 'recall': 0.3549054854160914, 'f1-score': 0.33657551086725573, 'support': 98419}, 'weighted avg': {'precision': 0.3600950026434655, 'recall': 0.35629299220678934, 'f1-score': 0.3371578339764137, 'support': 98419}}
[[ 7020  7042 18704]
 [ 6066  8178 18213]
 [ 5982  7346 19868]]
Evaluating performance on  val set...
139/139 - 2s - 2s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0986779
{'0': {'precision': 0.30755395683453235, 'recall': 0.20828258221680876, 'f1-score': 0.24836601307189546, 'support': 11494}, '1': {'precision': 0.40188638334778837, 'recall': 0.28093974990526716, 'f1-score': 0.3307016370043267, 'support': 13195}, '2': {'precision': 0.3110602842672766, 'recall': 0.5347313237221494, 'f1-score': 0.39332070924427615, 'support': 10682}, 'accuracy': 0.33397415962228943, 'macro avg': {'precision': 0.34016687481653246, 'recall': 0.34131788528140844, 'f1-score': 0.3241294531068328, 'support': 35371}, 'weighted avg': {'precision': 0.3438031710913808, 'recall': 0.33397415962228943, 'f1-score': 0.32285711092894787, 'support': 35371}}
[[2394 2952 6148]
 [2985 3707 6503]
 [2405 2565 5712]]
training model: results/CHTR/W3/deepVOL_L3/h300
Epoch 1/50
385/385 - 18s - loss: 3.3332 - accuracy300: 0.3467 - val_loss: 3.3154 - val_accuracy300: 0.3798 - 18s/epoch - 47ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3114 - accuracy300: 0.3410 - val_loss: 3.3045 - val_accuracy300: 0.3423 - 16s/epoch - 42ms/step
Epoch 3/50
385/385 - 15s - loss: 3.3050 - accuracy300: 0.3319 - val_loss: 3.3052 - val_accuracy300: 0.3205 - 15s/epoch - 39ms/step
Epoch 4/50
385/385 - 15s - loss: 3.3024 - accuracy300: 0.3319 - val_loss: 3.3084 - val_accuracy300: 0.3078 - 15s/epoch - 40ms/step
Epoch 5/50
385/385 - 15s - loss: 3.3004 - accuracy300: 0.3311 - val_loss: 3.3064 - val_accuracy300: 0.3221 - 15s/epoch - 39ms/step
Epoch 6/50
385/385 - 15s - loss: 3.2991 - accuracy300: 0.3353 - val_loss: 3.3063 - val_accuracy300: 0.3246 - 15s/epoch - 39ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2986 - accuracy300: 0.3360 - val_loss: 3.3057 - val_accuracy300: 0.3194 - 15s/epoch - 39ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2979 - accuracy300: 0.3373 - val_loss: 3.3061 - val_accuracy300: 0.3280 - 15s/epoch - 40ms/step
Epoch 9/50
385/385 - 15s - loss: 3.2968 - accuracy300: 0.3410 - val_loss: 3.3034 - val_accuracy300: 0.3367 - 15s/epoch - 39ms/step
Epoch 10/50
385/385 - 16s - loss: 3.2957 - accuracy300: 0.3423 - val_loss: 3.3025 - val_accuracy300: 0.3410 - 16s/epoch - 41ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2956 - accuracy300: 0.3430 - val_loss: 3.3027 - val_accuracy300: 0.3406 - 15s/epoch - 40ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2952 - accuracy300: 0.3438 - val_loss: 3.3022 - val_accuracy300: 0.3490 - 15s/epoch - 39ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2934 - accuracy300: 0.3461 - val_loss: 3.3017 - val_accuracy300: 0.3470 - 15s/epoch - 40ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2924 - accuracy300: 0.3468 - val_loss: 3.3026 - val_accuracy300: 0.3423 - 15s/epoch - 40ms/step
Epoch 15/50
385/385 - 16s - loss: 3.2915 - accuracy300: 0.3472 - val_loss: 3.3034 - val_accuracy300: 0.3440 - 16s/epoch - 41ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2910 - accuracy300: 0.3476 - val_loss: 3.3007 - val_accuracy300: 0.3481 - 15s/epoch - 40ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2897 - accuracy300: 0.3494 - val_loss: 3.2967 - val_accuracy300: 0.3525 - 15s/epoch - 39ms/step
Epoch 18/50
385/385 - 16s - loss: 3.2882 - accuracy300: 0.3516 - val_loss: 3.2959 - val_accuracy300: 0.3581 - 16s/epoch - 42ms/step
Epoch 19/50
385/385 - 16s - loss: 3.2848 - accuracy300: 0.3566 - val_loss: 3.2927 - val_accuracy300: 0.3583 - 16s/epoch - 41ms/step
Epoch 20/50
385/385 - 16s - loss: 3.2821 - accuracy300: 0.3579 - val_loss: 3.2982 - val_accuracy300: 0.3503 - 16s/epoch - 40ms/step
Epoch 21/50
385/385 - 15s - loss: 3.2830 - accuracy300: 0.3567 - val_loss: 3.2949 - val_accuracy300: 0.3542 - 15s/epoch - 39ms/step
Epoch 22/50
385/385 - 16s - loss: 3.2816 - accuracy300: 0.3575 - val_loss: 3.2981 - val_accuracy300: 0.3483 - 16s/epoch - 40ms/step
Epoch 23/50
385/385 - 15s - loss: 3.2802 - accuracy300: 0.3587 - val_loss: 3.3002 - val_accuracy300: 0.3448 - 15s/epoch - 39ms/step
Epoch 24/50
385/385 - 16s - loss: 3.2776 - accuracy300: 0.3617 - val_loss: 3.2968 - val_accuracy300: 0.3496 - 16s/epoch - 41ms/step
Epoch 25/50
385/385 - 16s - loss: 3.2758 - accuracy300: 0.3625 - val_loss: 3.2942 - val_accuracy300: 0.3519 - 16s/epoch - 41ms/step
Epoch 26/50
385/385 - 15s - loss: 3.2719 - accuracy300: 0.3660 - val_loss: 3.2962 - val_accuracy300: 0.3506 - 15s/epoch - 40ms/step
Epoch 27/50
385/385 - 16s - loss: 3.2703 - accuracy300: 0.3664 - val_loss: 3.2990 - val_accuracy300: 0.3548 - 16s/epoch - 41ms/step
Epoch 28/50
385/385 - 16s - loss: 3.2673 - accuracy300: 0.3692 - val_loss: 3.2992 - val_accuracy300: 0.3564 - 16s/epoch - 41ms/step
Epoch 29/50
385/385 - 16s - loss: 3.2628 - accuracy300: 0.3750 - val_loss: 3.2979 - val_accuracy300: 0.3585 - 16s/epoch - 41ms/step
testing model: results/CHTR/W3/deepVOL_L3/h300
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995986
{'0': {'precision': 0.3061381497964208, 'recall': 0.2935601761474554, 'f1-score': 0.29971725880089917, 'support': 88108}, '1': {'precision': 0.3945938340866323, 'recall': 0.40543544059052594, 'f1-score': 0.3999411772569885, 'support': 110681}, '2': {'precision': 0.32376465549547623, 'recall': 0.3257843475262886, 'f1-score': 0.3247713615199962, 'support': 92816}, 'accuracy': 0.34628007064350746, 'macro avg': {'precision': 0.3414988797928431, 'recall': 0.3415933214214233, 'f1-score': 0.3414765991926279, 'support': 291605}, 'weighted avg': {'precision': 0.34532261284022464, 'recall': 0.34628007064350746, 'f1-score': 0.34573260530255084, 'support': 291605}}
[[25865 33587 28656]
 [31306 44874 34501]
 [27317 35261 30238]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946661
{'0': {'precision': 0.3438940466142959, 'recall': 0.3258288737159378, 'f1-score': 0.3346178142766898, 'support': 32514}, '1': {'precision': 0.3657606654920424, 'recall': 0.38884112264324755, 'f1-score': 0.37694792147290396, 'support': 32566}, '2': {'precision': 0.35487390882638215, 'recall': 0.35118029934911066, 'f1-score': 0.353017442824622, 'support': 33339}, 'accuracy': 0.3552667675956878, 'macro avg': {'precision': 0.35484287364424016, 'recall': 0.35528343190276535, 'f1-score': 0.35486105952473856, 'support': 98419}, 'weighted avg': {'precision': 0.3548489022484868, 'recall': 0.3552667675956878, 'f1-score': 0.35485727502219033, 'support': 98419}}
[[10594 10906 11014]
 [ 9633 12663 10270]
 [10579 11052 11708]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965257
{'0': {'precision': 0.3248791078653903, 'recall': 0.2949820788530466, 'f1-score': 0.3092095993988635, 'support': 11160}, '1': {'precision': 0.4165131354486523, 'recall': 0.44593804792518993, 'f1-score': 0.43072363546554704, 'support': 13688}, '2': {'precision': 0.30860814513842955, 'recall': 0.31036776584624154, 'f1-score': 0.309485454373164, 'support': 10523}, 'accuracy': 0.3579768737101015, 'macro avg': {'precision': 0.35000012948415743, 'recall': 0.3504292975414927, 'f1-score': 0.3498062297458582, 'support': 35371}, 'weighted avg': {'precision': 0.3554993116703119, 'recall': 0.3579768737101015, 'f1-score': 0.3563156169718845, 'support': 35371}}
[[3292 4467 3401]
 [3668 6104 3916]
 [3173 4084 3266]]
training model: results/CHTR/W3/deepVOL_L3/h500
Epoch 1/50
385/385 - 19s - loss: 3.3330 - accuracy500: 0.3529 - val_loss: 3.3458 - val_accuracy500: 0.3693 - 19s/epoch - 49ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3148 - accuracy500: 0.3414 - val_loss: 3.3219 - val_accuracy500: 0.3424 - 16s/epoch - 42ms/step
Epoch 3/50
385/385 - 16s - loss: 3.3063 - accuracy500: 0.3339 - val_loss: 3.3154 - val_accuracy500: 0.3110 - 16s/epoch - 42ms/step
Epoch 4/50
385/385 - 16s - loss: 3.3036 - accuracy500: 0.3333 - val_loss: 3.3162 - val_accuracy500: 0.3041 - 16s/epoch - 42ms/step
Epoch 5/50
385/385 - 16s - loss: 3.3021 - accuracy500: 0.3319 - val_loss: 3.3179 - val_accuracy500: 0.3049 - 16s/epoch - 42ms/step
Epoch 6/50
385/385 - 16s - loss: 3.3009 - accuracy500: 0.3320 - val_loss: 3.3172 - val_accuracy500: 0.3073 - 16s/epoch - 42ms/step
Epoch 7/50
385/385 - 16s - loss: 3.2996 - accuracy500: 0.3347 - val_loss: 3.3164 - val_accuracy500: 0.3015 - 16s/epoch - 41ms/step
Epoch 8/50
385/385 - 16s - loss: 3.2995 - accuracy500: 0.3352 - val_loss: 3.3146 - val_accuracy500: 0.3079 - 16s/epoch - 42ms/step
Epoch 9/50
385/385 - 17s - loss: 3.2989 - accuracy500: 0.3366 - val_loss: 3.3143 - val_accuracy500: 0.3083 - 17s/epoch - 44ms/step
Epoch 10/50
385/385 - 16s - loss: 3.2979 - accuracy500: 0.3389 - val_loss: 3.3093 - val_accuracy500: 0.3214 - 16s/epoch - 42ms/step
Epoch 11/50
385/385 - 16s - loss: 3.2976 - accuracy500: 0.3394 - val_loss: 3.3142 - val_accuracy500: 0.3110 - 16s/epoch - 42ms/step
Epoch 12/50
385/385 - 17s - loss: 3.2962 - accuracy500: 0.3413 - val_loss: 3.3060 - val_accuracy500: 0.3327 - 17s/epoch - 43ms/step
Epoch 13/50
385/385 - 16s - loss: 3.2954 - accuracy500: 0.3425 - val_loss: 3.3089 - val_accuracy500: 0.3249 - 16s/epoch - 41ms/step
Epoch 14/50
385/385 - 16s - loss: 3.2937 - accuracy500: 0.3458 - val_loss: 3.2989 - val_accuracy500: 0.3537 - 16s/epoch - 43ms/step
Epoch 15/50
385/385 - 16s - loss: 3.2918 - accuracy500: 0.3500 - val_loss: 3.3034 - val_accuracy500: 0.3444 - 16s/epoch - 42ms/step
Epoch 16/50
385/385 - 16s - loss: 3.2913 - accuracy500: 0.3515 - val_loss: 3.2995 - val_accuracy500: 0.3512 - 16s/epoch - 42ms/step
Epoch 17/50
385/385 - 16s - loss: 3.2918 - accuracy500: 0.3484 - val_loss: 3.3019 - val_accuracy500: 0.3451 - 16s/epoch - 42ms/step
Epoch 18/50
385/385 - 16s - loss: 3.2885 - accuracy500: 0.3519 - val_loss: 3.2936 - val_accuracy500: 0.3728 - 16s/epoch - 42ms/step
Epoch 19/50
385/385 - 16s - loss: 3.2869 - accuracy500: 0.3551 - val_loss: 3.2910 - val_accuracy500: 0.3794 - 16s/epoch - 42ms/step
Epoch 20/50
385/385 - 16s - loss: 3.2843 - accuracy500: 0.3562 - val_loss: 3.2958 - val_accuracy500: 0.3626 - 16s/epoch - 42ms/step
Epoch 21/50
385/385 - 16s - loss: 3.2851 - accuracy500: 0.3571 - val_loss: 3.2940 - val_accuracy500: 0.3749 - 16s/epoch - 43ms/step
Epoch 22/50
385/385 - 16s - loss: 3.2840 - accuracy500: 0.3564 - val_loss: 3.2969 - val_accuracy500: 0.3777 - 16s/epoch - 42ms/step
Epoch 23/50
385/385 - 16s - loss: 3.2798 - accuracy500: 0.3619 - val_loss: 3.2955 - val_accuracy500: 0.3765 - 16s/epoch - 42ms/step
Epoch 24/50
385/385 - 16s - loss: 3.2782 - accuracy500: 0.3647 - val_loss: 3.2995 - val_accuracy500: 0.3739 - 16s/epoch - 41ms/step
Epoch 25/50
385/385 - 16s - loss: 3.2772 - accuracy500: 0.3659 - val_loss: 3.2956 - val_accuracy500: 0.3767 - 16s/epoch - 41ms/step
Epoch 26/50
385/385 - 17s - loss: 3.2758 - accuracy500: 0.3662 - val_loss: 3.2985 - val_accuracy500: 0.3779 - 17s/epoch - 43ms/step
Epoch 27/50
385/385 - 16s - loss: 3.2738 - accuracy500: 0.3696 - val_loss: 3.2986 - val_accuracy500: 0.3797 - 16s/epoch - 41ms/step
Epoch 28/50
385/385 - 16s - loss: 3.2720 - accuracy500: 0.3710 - val_loss: 3.2982 - val_accuracy500: 0.3790 - 16s/epoch - 42ms/step
Epoch 29/50
385/385 - 16s - loss: 3.2694 - accuracy500: 0.3711 - val_loss: 3.3052 - val_accuracy500: 0.3788 - 16s/epoch - 42ms/step
testing model: results/CHTR/W3/deepVOL_L3/h500
Evaluating performance on  test set...
1140/1140 - 19s - 19s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0905821
{'0': {'precision': 0.2606316836607809, 'recall': 0.012491358554435148, 'f1-score': 0.023840125570127046, 'support': 83898}, '1': {'precision': 0.4061023516528957, 'recall': 0.8967735935201312, 'f1-score': 0.5590430410170456, 'support': 118274}, '2': {'precision': 0.3034537605089752, 'recall': 0.0895977994699943, 'f1-score': 0.1383471887706213, 'support': 89433}, 'accuracy': 0.394801186536582, 'macro avg': {'precision': 0.32339593194088395, 'recall': 0.33295425051485356, 'f1-score': 0.24041011845259797, 'support': 291605}, 'weighted avg': {'precision': 0.33276729376645103, 'recall': 0.394801186536582, 'f1-score': 0.27603504611256857, 'support': 291605}}
[[  1048  75056   7794]
 [  1610 106065  10599]
 [  1363  80057   8013]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986571
{'0': {'precision': 0.4241573033707865, 'recall': 0.018831452266633412, 'f1-score': 0.03606185443907099, 'support': 32074}, '1': {'precision': 0.3334172032434782, 'recall': 0.8968498123423368, 'f1-score': 0.48611423759619155, 'support': 32506}, '2': {'precision': 0.3626281648880519, 'recall': 0.10242619462750081, 'f1-score': 0.15973454386247898, 'support': 33839}, 'accuracy': 0.3375669332141152, 'macro avg': {'precision': 0.3734008905007722, 'recall': 0.3393691530788237, 'f1-score': 0.22730354529924715, 'support': 98419}, 'weighted avg': {'precision': 0.3730321932614018, 'recall': 0.3375669332141152, 'f1-score': 0.22722781735582553, 'support': 98419}}
[[  604 28323  3147]
 [  408 29153  2945]
 [  412 29961  3466]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0944519
{'0': {'precision': 0.32116788321167883, 'recall': 0.01579183490354419, 'f1-score': 0.030103480714957664, 'support': 11145}, '1': {'precision': 0.388322871652525, 'recall': 0.8944997456949793, 'f1-score': 0.5415475300224344, 'support': 13763}, '2': {'precision': 0.29615384615384616, 'recall': 0.08831119181879002, 'f1-score': 0.13605241846425678, 'support': 10463}, 'accuracy': 0.3791524129936954, 'macro avg': {'precision': 0.33521486700601666, 'recall': 0.33286759080577116, 'f1-score': 0.23590114306721624, 'support': 35371}, 'weighted avg': {'precision': 0.3398988276626489, 'recall': 0.3791524129936954, 'f1-score': 0.260448910199273, 'support': 35371}}
[[  176 10019   950]
 [  206 12311  1246]
 [  166  9373   924]]
training model: results/CHTR/W3/deepVOL_L3/h1000
Epoch 1/50
385/385 - 17s - loss: 3.3299 - accuracy1000: 0.3512 - val_loss: 3.4022 - val_accuracy1000: 0.3650 - 17s/epoch - 45ms/step
Epoch 2/50
385/385 - 16s - loss: 3.3038 - accuracy1000: 0.3458 - val_loss: 3.3240 - val_accuracy1000: 0.3568 - 16s/epoch - 41ms/step
Epoch 3/50
385/385 - 15s - loss: 3.2998 - accuracy1000: 0.3481 - val_loss: 3.3137 - val_accuracy1000: 0.3517 - 15s/epoch - 39ms/step
Epoch 4/50
385/385 - 15s - loss: 3.2997 - accuracy1000: 0.3446 - val_loss: 3.3167 - val_accuracy1000: 0.3318 - 15s/epoch - 39ms/step
Epoch 5/50
385/385 - 15s - loss: 3.3004 - accuracy1000: 0.3429 - val_loss: 3.3159 - val_accuracy1000: 0.3306 - 15s/epoch - 39ms/step
Epoch 6/50
385/385 - 17s - loss: 3.2991 - accuracy1000: 0.3431 - val_loss: 3.3151 - val_accuracy1000: 0.3342 - 17s/epoch - 43ms/step
Epoch 7/50
385/385 - 15s - loss: 3.2979 - accuracy1000: 0.3448 - val_loss: 3.3150 - val_accuracy1000: 0.3348 - 15s/epoch - 39ms/step
Epoch 8/50
385/385 - 15s - loss: 3.2976 - accuracy1000: 0.3447 - val_loss: 3.3155 - val_accuracy1000: 0.3340 - 15s/epoch - 40ms/step
Epoch 9/50
385/385 - 15s - loss: 3.2972 - accuracy1000: 0.3469 - val_loss: 3.3141 - val_accuracy1000: 0.3413 - 15s/epoch - 40ms/step
Epoch 10/50
385/385 - 15s - loss: 3.2969 - accuracy1000: 0.3486 - val_loss: 3.3131 - val_accuracy1000: 0.3435 - 15s/epoch - 39ms/step
Epoch 11/50
385/385 - 15s - loss: 3.2965 - accuracy1000: 0.3466 - val_loss: 3.3152 - val_accuracy1000: 0.3391 - 15s/epoch - 39ms/step
Epoch 12/50
385/385 - 15s - loss: 3.2948 - accuracy1000: 0.3512 - val_loss: 3.3116 - val_accuracy1000: 0.3450 - 15s/epoch - 39ms/step
Epoch 13/50
385/385 - 15s - loss: 3.2938 - accuracy1000: 0.3518 - val_loss: 3.3114 - val_accuracy1000: 0.3442 - 15s/epoch - 39ms/step
Epoch 14/50
385/385 - 15s - loss: 3.2935 - accuracy1000: 0.3509 - val_loss: 3.3126 - val_accuracy1000: 0.3418 - 15s/epoch - 40ms/step
Epoch 15/50
385/385 - 15s - loss: 3.2925 - accuracy1000: 0.3532 - val_loss: 3.3107 - val_accuracy1000: 0.3480 - 15s/epoch - 39ms/step
Epoch 16/50
385/385 - 15s - loss: 3.2915 - accuracy1000: 0.3550 - val_loss: 3.3119 - val_accuracy1000: 0.3452 - 15s/epoch - 39ms/step
Epoch 17/50
385/385 - 15s - loss: 3.2901 - accuracy1000: 0.3564 - val_loss: 3.3143 - val_accuracy1000: 0.3443 - 15s/epoch - 40ms/step
Epoch 18/50
385/385 - 15s - loss: 3.2890 - accuracy1000: 0.3558 - val_loss: 3.3112 - val_accuracy1000: 0.3441 - 15s/epoch - 40ms/step
Epoch 19/50
385/385 - 16s - loss: 3.2871 - accuracy1000: 0.3595 - val_loss: 3.3091 - val_accuracy1000: 0.3502 - 16s/epoch - 41ms/step
Epoch 20/50
385/385 - 15s - loss: 3.2857 - accuracy1000: 0.3618 - val_loss: 3.3105 - val_accuracy1000: 0.3442 - 15s/epoch - 39ms/step
Epoch 21/50
385/385 - 16s - loss: 3.2843 - accuracy1000: 0.3621 - val_loss: 3.3097 - val_accuracy1000: 0.3490 - 16s/epoch - 41ms/step
Epoch 22/50
385/385 - 15s - loss: 3.2800 - accuracy1000: 0.3663 - val_loss: 3.3066 - val_accuracy1000: 0.3581 - 15s/epoch - 40ms/step
Epoch 23/50
385/385 - 16s - loss: 3.2807 - accuracy1000: 0.3646 - val_loss: 3.3166 - val_accuracy1000: 0.3425 - 16s/epoch - 41ms/step
Epoch 24/50
385/385 - 15s - loss: 3.2801 - accuracy1000: 0.3639 - val_loss: 3.3146 - val_accuracy1000: 0.3460 - 15s/epoch - 40ms/step
Epoch 25/50
385/385 - 16s - loss: 3.2778 - accuracy1000: 0.3661 - val_loss: 3.3112 - val_accuracy1000: 0.3526 - 16s/epoch - 41ms/step
Epoch 26/50
385/385 - 15s - loss: 3.2740 - accuracy1000: 0.3691 - val_loss: 3.3112 - val_accuracy1000: 0.3578 - 15s/epoch - 40ms/step
Epoch 27/50
385/385 - 15s - loss: 3.2719 - accuracy1000: 0.3732 - val_loss: 3.3115 - val_accuracy1000: 0.3557 - 15s/epoch - 39ms/step
Epoch 28/50
385/385 - 15s - loss: 3.2701 - accuracy1000: 0.3754 - val_loss: 3.3144 - val_accuracy1000: 0.3546 - 15s/epoch - 40ms/step
Epoch 29/50
385/385 - 15s - loss: 3.2675 - accuracy1000: 0.3779 - val_loss: 3.3133 - val_accuracy1000: 0.3547 - 15s/epoch - 39ms/step
Epoch 30/50
385/385 - 15s - loss: 3.2629 - accuracy1000: 0.3806 - val_loss: 3.3197 - val_accuracy1000: 0.3506 - 15s/epoch - 39ms/step
Epoch 31/50
385/385 - 15s - loss: 3.2630 - accuracy1000: 0.3788 - val_loss: 3.3214 - val_accuracy1000: 0.3534 - 15s/epoch - 40ms/step
Epoch 32/50
385/385 - 15s - loss: 3.2555 - accuracy1000: 0.3872 - val_loss: 3.3132 - val_accuracy1000: 0.3600 - 15s/epoch - 39ms/step
testing model: results/CHTR/W3/deepVOL_L3/h1000
Evaluating performance on  test set...
1140/1140 - 18s - 18s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0920143
{'0': {'precision': 0.26835043409629045, 'recall': 0.028873333414211017, 'f1-score': 0.05213695809327696, 'support': 82429}, '1': {'precision': 0.3953256904214435, 'recall': 0.8444936214527466, 'f1-score': 0.538546255506608, 'support': 115230}, '2': {'precision': 0.33882783882783885, 'recall': 0.13193749600834523, 'f1-score': 0.1899209365040451, 'support': 93946}, 'accuracy': 0.38437612523790743, 'macro avg': {'precision': 0.3341679877818576, 'recall': 0.33510148362510095, 'f1-score': 0.26020138336797666, 'support': 291605}, 'weighted avg': {'precision': 0.3412313142295441, 'recall': 0.38437612523790743, 'f1-score': 0.28873508561755173, 'support': 291605}}
[[ 2380 70162  9887]
 [ 3619 97311 14300]
 [ 2870 78681 12395]]
Evaluating performance on  train set...
385/385 - 7s - 7s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977323
{'0': {'precision': 0.36039360393603936, 'recall': 0.03721343748015495, 'f1-score': 0.06746100270534738, 'support': 31494}, '1': {'precision': 0.3353751181403807, 'recall': 0.8670357540517135, 'f1-score': 0.4836653180237925, 'support': 32332}, '2': {'precision': 0.3787564766839378, 'recall': 0.12678865666464315, 'f1-score': 0.1899811578195049, 'support': 34593}, 'accuracy': 0.3413060486288217, 'macro avg': {'precision': 0.35817506625345263, 'recall': 0.3436792827321706, 'f1-score': 0.24703582618288158, 'support': 98419}, 'weighted avg': {'precision': 0.358628997246506, 'recall': 0.3413060486288217, 'f1-score': 0.2472541081904673, 'support': 98419}}
[[ 1172 26541  3781]
 [  886 28033  3413]
 [ 1194 29013  4386]]
Evaluating performance on  val set...
139/139 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0980648
{'0': {'precision': 0.32437275985663083, 'recall': 0.03110500085925417, 'f1-score': 0.056766504625999685, 'support': 11638}, '1': {'precision': 0.3680632677099108, 'recall': 0.8346306471306472, 'f1-score': 0.5108479880426914, 'support': 13104}, '2': {'precision': 0.3, 'recall': 0.12813999435506632, 'f1-score': 0.17957676840925568, 'support': 10629}, 'accuracy': 0.3579486019620593, 'macro avg': {'precision': 0.3308120091888472, 'recall': 0.3312918807816559, 'f1-score': 0.2490637536926489, 'support': 35371}, 'weighted avg': {'precision': 0.3332348884476588, 'recall': 0.3579486019620593, 'f1-score': 0.26189596244298413, 'support': 35371}}
[[  362  9824  1452]
 [  441 10937  1726]
 [  313  8954  1362]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        15 (peak)  13.78 (ave)

============================================
