This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-09.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-01.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-18.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-19.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-27.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-23.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-25.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-20.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-11.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-24.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-07.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-26.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-09-17.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-03.csv
data/LILAK_orderbooks/LILAK_orderbooks_2019-10-02.csv
training model: results/LILAK/W7/deepLOB_L1/h10
Epoch 1/50
282/282 - 17s - loss: 3.3405 - accuracy10: 0.3568 - val_loss: 3.4432 - val_accuracy10: 0.3415 - 17s/epoch - 60ms/step
Epoch 2/50
282/282 - 8s - loss: 3.2879 - accuracy10: 0.3650 - val_loss: 3.4097 - val_accuracy10: 0.3482 - 8s/epoch - 28ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2681 - accuracy10: 0.3755 - val_loss: 3.4190 - val_accuracy10: 0.3537 - 8s/epoch - 28ms/step
Epoch 4/50
282/282 - 8s - loss: 3.2441 - accuracy10: 0.3893 - val_loss: 3.2937 - val_accuracy10: 0.3728 - 8s/epoch - 29ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2246 - accuracy10: 0.4052 - val_loss: 3.2854 - val_accuracy10: 0.3914 - 8s/epoch - 27ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2080 - accuracy10: 0.4154 - val_loss: 3.3068 - val_accuracy10: 0.3873 - 8s/epoch - 28ms/step
Epoch 7/50
282/282 - 8s - loss: 3.1862 - accuracy10: 0.4285 - val_loss: 3.2811 - val_accuracy10: 0.3981 - 8s/epoch - 28ms/step
Epoch 8/50
282/282 - 8s - loss: 3.1748 - accuracy10: 0.4344 - val_loss: 3.2801 - val_accuracy10: 0.3930 - 8s/epoch - 28ms/step
Epoch 9/50
282/282 - 8s - loss: 3.1610 - accuracy10: 0.4445 - val_loss: 3.2586 - val_accuracy10: 0.4053 - 8s/epoch - 27ms/step
Epoch 10/50
282/282 - 8s - loss: 3.1526 - accuracy10: 0.4495 - val_loss: 3.2686 - val_accuracy10: 0.3987 - 8s/epoch - 27ms/step
Epoch 11/50
282/282 - 8s - loss: 3.1414 - accuracy10: 0.4524 - val_loss: 3.2485 - val_accuracy10: 0.4164 - 8s/epoch - 27ms/step
Epoch 12/50
282/282 - 8s - loss: 3.1335 - accuracy10: 0.4564 - val_loss: 3.2530 - val_accuracy10: 0.4159 - 8s/epoch - 28ms/step
Epoch 13/50
282/282 - 8s - loss: 3.1286 - accuracy10: 0.4598 - val_loss: 3.2318 - val_accuracy10: 0.4184 - 8s/epoch - 29ms/step
Epoch 14/50
282/282 - 8s - loss: 3.1184 - accuracy10: 0.4625 - val_loss: 3.2389 - val_accuracy10: 0.4216 - 8s/epoch - 27ms/step
Epoch 15/50
282/282 - 8s - loss: 3.1170 - accuracy10: 0.4637 - val_loss: 3.2370 - val_accuracy10: 0.4121 - 8s/epoch - 27ms/step
Epoch 16/50
282/282 - 7s - loss: 3.1075 - accuracy10: 0.4678 - val_loss: 3.2438 - val_accuracy10: 0.4183 - 7s/epoch - 26ms/step
Epoch 17/50
282/282 - 7s - loss: 3.1005 - accuracy10: 0.4710 - val_loss: 3.2462 - val_accuracy10: 0.4210 - 7s/epoch - 26ms/step
Epoch 18/50
282/282 - 7s - loss: 3.0954 - accuracy10: 0.4738 - val_loss: 3.2229 - val_accuracy10: 0.4247 - 7s/epoch - 26ms/step
Epoch 19/50
282/282 - 7s - loss: 3.0894 - accuracy10: 0.4756 - val_loss: 3.2232 - val_accuracy10: 0.4274 - 7s/epoch - 26ms/step
Epoch 20/50
282/282 - 7s - loss: 3.0825 - accuracy10: 0.4764 - val_loss: 3.2562 - val_accuracy10: 0.4143 - 7s/epoch - 26ms/step
Epoch 21/50
282/282 - 7s - loss: 3.0797 - accuracy10: 0.4766 - val_loss: 3.2242 - val_accuracy10: 0.4239 - 7s/epoch - 25ms/step
Epoch 22/50
282/282 - 7s - loss: 3.0746 - accuracy10: 0.4797 - val_loss: 3.2427 - val_accuracy10: 0.4221 - 7s/epoch - 25ms/step
Epoch 23/50
282/282 - 8s - loss: 3.0676 - accuracy10: 0.4802 - val_loss: 3.2508 - val_accuracy10: 0.4142 - 8s/epoch - 27ms/step
Epoch 24/50
282/282 - 7s - loss: 3.0677 - accuracy10: 0.4814 - val_loss: 3.2738 - val_accuracy10: 0.4136 - 7s/epoch - 26ms/step
Epoch 25/50
282/282 - 8s - loss: 3.0620 - accuracy10: 0.4822 - val_loss: 3.2758 - val_accuracy10: 0.4127 - 8s/epoch - 27ms/step
Epoch 26/50
282/282 - 8s - loss: 3.0552 - accuracy10: 0.4852 - val_loss: 3.2911 - val_accuracy10: 0.4079 - 8s/epoch - 27ms/step
Epoch 27/50
282/282 - 7s - loss: 3.0538 - accuracy10: 0.4842 - val_loss: 3.2975 - val_accuracy10: 0.4145 - 7s/epoch - 26ms/step
Epoch 28/50
282/282 - 7s - loss: 3.0475 - accuracy10: 0.4867 - val_loss: 3.3149 - val_accuracy10: 0.4113 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepLOB_L1/h10
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.063554
{'0': {'precision': 0.4583146571044375, 'recall': 0.15484212917392293, 'f1-score': 0.2314788612824721, 'support': 52828}, '1': {'precision': 0.47283480224249186, 'recall': 0.5067159767381113, 'f1-score': 0.4891894402930597, 'support': 72737}, '2': {'precision': 0.3784382724317216, 'recall': 0.5935942244886266, 'f1-score': 0.46220424430795776, 'support': 52359}, 'accuracy': 0.42780625435579234, 'macro avg': {'precision': 0.436529243926217, 'recall': 0.41838411013355364, 'f1-score': 0.39429084862782987, 'support': 177924}, 'weighted avg': {'precision': 0.4407448192625945, 'recall': 0.42780625435579234, 'f1-score': 0.4047306132401872, 'support': 177924}}
[[ 8180 23902 20746]
 [ 5579 36857 30301]
 [ 4089 17190 31080]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0549647
{'0': {'precision': 0.458981178396072, 'recall': 0.3841774048546599, 'f1-score': 0.4182610519447228, 'support': 23359}, '1': {'precision': 0.43195621704598547, 'recall': 0.5048361934477379, 'f1-score': 0.46556127036650724, 'support': 25640}, '2': {'precision': 0.44132040217101165, 'recall': 0.43136061225377226, 'f1-score': 0.4362836723474437, 'support': 22997}, 'accuracy': 0.4422190121673426, 'macro avg': {'precision': 0.44408593253768974, 'recall': 0.44012473685205666, 'f1-score': 0.44003533155289126, 'support': 71996}, 'weighted avg': {'precision': 0.44371554030695687, 'recall': 0.4422190121673426, 'f1-score': 0.44086291596127825, 'support': 71996}}
[[ 8974  8658  5727]
 [ 5865 12944  6831]
 [ 4713  8364  9920]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.071546
{'0': {'precision': 0.4228593719524088, 'recall': 0.3693985346737093, 'f1-score': 0.3943252091669698, 'support': 5869}, '1': {'precision': 0.41302681992337165, 'recall': 0.5020959478341872, 'f1-score': 0.45322682362833716, 'support': 6441}, '2': {'precision': 0.44064132588722754, 'recall': 0.3946434333656018, 'f1-score': 0.41637586177547026, 'support': 6198}, 'accuracy': 0.4240328506591744, 'macro avg': {'precision': 0.42550917258766935, 'recall': 0.42204597195783283, 'f1-score': 0.4213092981902591, 'support': 18508}, 'weighted avg': {'precision': 0.42539238918111955, 'recall': 0.4240328506591744, 'f1-score': 0.42220802976417926, 'support': 18508}}
[[2168 2301 1400]
 [1502 3234 1705]
 [1457 2295 2446]]
training model: results/LILAK/W7/deepLOB_L1/h20
Epoch 1/50
282/282 - 9s - loss: 3.3388 - accuracy20: 0.3557 - val_loss: 3.4975 - val_accuracy20: 0.3325 - 9s/epoch - 34ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3110 - accuracy20: 0.3594 - val_loss: 3.4463 - val_accuracy20: 0.3375 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2828 - accuracy20: 0.3686 - val_loss: 3.4010 - val_accuracy20: 0.3545 - 8s/epoch - 27ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2604 - accuracy20: 0.3849 - val_loss: 3.3221 - val_accuracy20: 0.3690 - 7s/epoch - 27ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2456 - accuracy20: 0.3978 - val_loss: 3.2922 - val_accuracy20: 0.3833 - 8s/epoch - 27ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2332 - accuracy20: 0.4045 - val_loss: 3.3316 - val_accuracy20: 0.3608 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2257 - accuracy20: 0.4084 - val_loss: 3.3577 - val_accuracy20: 0.3602 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2177 - accuracy20: 0.4144 - val_loss: 3.3448 - val_accuracy20: 0.3640 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 8s - loss: 3.2083 - accuracy20: 0.4202 - val_loss: 3.3228 - val_accuracy20: 0.3670 - 8s/epoch - 27ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2021 - accuracy20: 0.4237 - val_loss: 3.3174 - val_accuracy20: 0.3788 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.1957 - accuracy20: 0.4282 - val_loss: 3.3431 - val_accuracy20: 0.3625 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 8s - loss: 3.1914 - accuracy20: 0.4279 - val_loss: 3.3086 - val_accuracy20: 0.3742 - 8s/epoch - 27ms/step
Epoch 13/50
282/282 - 8s - loss: 3.1871 - accuracy20: 0.4306 - val_loss: 3.3384 - val_accuracy20: 0.3690 - 8s/epoch - 27ms/step
Epoch 14/50
282/282 - 8s - loss: 3.1812 - accuracy20: 0.4326 - val_loss: 3.3585 - val_accuracy20: 0.3662 - 8s/epoch - 27ms/step
Epoch 15/50
282/282 - 7s - loss: 3.1794 - accuracy20: 0.4348 - val_loss: 3.3421 - val_accuracy20: 0.3698 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepLOB_L1/h20
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0886825
{'0': {'precision': 0.3435026622535617, 'recall': 0.5234649122807018, 'f1-score': 0.41480580415327134, 'support': 54720}, '1': {'precision': 0.3716433941997852, 'recall': 0.33537964458804526, 'f1-score': 0.35258152173913043, 'support': 68090}, '2': {'precision': 0.41776971894832277, 'recall': 0.25082556156330515, 'f1-score': 0.3134551721010385, 'support': 55114}, 'accuracy': 0.36703311526269644, 'macro avg': {'precision': 0.37763859180055653, 'recall': 0.3698900394773507, 'f1-score': 0.36028083266448013, 'support': 177924}, 'weighted avg': {'precision': 0.37727695352901314, 'recall': 0.36703311526269644, 'f1-score': 0.35959858014467433, 'support': 177924}}
[[28644 18340  7736]
 [33724 22836 11530]
 [21020 20270 13824]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0857
{'0': {'precision': 0.40178182670730483, 'recall': 0.4950478705843513, 'f1-score': 0.4435652350755237, 'support': 24232}, '1': {'precision': 0.35773855205935023, 'recall': 0.29011244346707604, 'f1-score': 0.3203959125693076, 'support': 24101}, '2': {'precision': 0.4052845888288926, 'recall': 0.38697544690022395, 'f1-score': 0.3959184555851007, 'support': 23663}, 'accuracy': 0.3909244958053225, 'macro avg': {'precision': 0.3882683225318493, 'recall': 0.39071192031721713, 'f1-score': 0.38662653440997735, 'support': 71996}, 'weighted avg': {'precision': 0.3881893895968095, 'recall': 0.3909244958053225, 'f1-score': 0.38667360797395983, 'support': 71996}}
[[11996  6252  5984]
 [ 9656  6992  7453]
 [ 8205  6301  9157]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0956982
{'0': {'precision': 0.3946003176283748, 'recall': 0.6010320915981293, 'f1-score': 0.476415697302825, 'support': 6201}, '1': {'precision': 0.3438674410659378, 'recall': 0.3405515141262054, 'f1-score': 0.34220144496387594, 'support': 5911}, '2': {'precision': 0.4297288875038953, 'recall': 0.21560350218886803, 'f1-score': 0.28714211348256113, 'support': 6396}, 'accuracy': 0.3846444780635401, 'macro avg': {'precision': 0.38939888206606926, 'recall': 0.3857290359710676, 'f1-score': 0.3685864185830874, 'support': 18508}, 'weighted avg': {'precision': 0.39053722596872836, 'recall': 0.3846444780635401, 'f1-score': 0.3681417461633213, 'support': 18508}}
[[3727 1749  725]
 [2793 2013 1105]
 [2925 2092 1379]]
training model: results/LILAK/W7/deepLOB_L1/h30
Epoch 1/50
282/282 - 9s - loss: 3.3423 - accuracy30: 0.3494 - val_loss: 3.5249 - val_accuracy30: 0.3181 - 9s/epoch - 33ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3045 - accuracy30: 0.3623 - val_loss: 3.3683 - val_accuracy30: 0.3585 - 7s/epoch - 25ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2905 - accuracy30: 0.3675 - val_loss: 3.3772 - val_accuracy30: 0.3537 - 7s/epoch - 25ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2726 - accuracy30: 0.3773 - val_loss: 3.3455 - val_accuracy30: 0.3516 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2675 - accuracy30: 0.3827 - val_loss: 3.3261 - val_accuracy30: 0.3607 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2479 - accuracy30: 0.3965 - val_loss: 3.3415 - val_accuracy30: 0.3742 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2427 - accuracy30: 0.3970 - val_loss: 3.3444 - val_accuracy30: 0.3767 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2356 - accuracy30: 0.4039 - val_loss: 3.3048 - val_accuracy30: 0.3831 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2271 - accuracy30: 0.4079 - val_loss: 3.3302 - val_accuracy30: 0.3762 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2255 - accuracy30: 0.4090 - val_loss: 3.3242 - val_accuracy30: 0.3798 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2221 - accuracy30: 0.4117 - val_loss: 3.3118 - val_accuracy30: 0.3842 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2159 - accuracy30: 0.4158 - val_loss: 3.3620 - val_accuracy30: 0.3693 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2113 - accuracy30: 0.4156 - val_loss: 3.3173 - val_accuracy30: 0.3753 - 7s/epoch - 25ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2049 - accuracy30: 0.4191 - val_loss: 3.3163 - val_accuracy30: 0.3765 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 7s - loss: 3.1987 - accuracy30: 0.4219 - val_loss: 3.3227 - val_accuracy30: 0.3731 - 7s/epoch - 26ms/step
Epoch 16/50
282/282 - 8s - loss: 3.1978 - accuracy30: 0.4228 - val_loss: 3.3271 - val_accuracy30: 0.3677 - 8s/epoch - 27ms/step
Epoch 17/50
282/282 - 7s - loss: 3.1964 - accuracy30: 0.4258 - val_loss: 3.3345 - val_accuracy30: 0.3643 - 7s/epoch - 25ms/step
Epoch 18/50
282/282 - 7s - loss: 3.1934 - accuracy30: 0.4275 - val_loss: 3.3532 - val_accuracy30: 0.3670 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepLOB_L1/h30
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1027452
{'0': {'precision': 0.3206662693106948, 'recall': 0.7381614565950977, 'f1-score': 0.44710480212030007, 'support': 53934}, '1': {'precision': 0.37932359723289777, 'recall': 0.08567088607594937, 'f1-score': 0.1397736525956784, 'support': 69125}, '2': {'precision': 0.3950940824990828, 'recall': 0.27478355964640483, 'f1-score': 0.3241348913709513, 'support': 54865}, 'accuracy': 0.3417751399473933, 'macro avg': {'precision': 0.3650279830142251, 'recall': 0.366205300772484, 'f1-score': 0.3036711153623099, 'support': 177924}, 'weighted avg': {'precision': 0.3664058534207822, 'recall': 0.3417751399473933, 'f1-score': 0.28978476736303016, 'support': 177924}}
[[39812  4024 10098]
 [50219  5922 12984]
 [34123  5666 15076]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0918798
{'0': {'precision': 0.37748723366789927, 'recall': 0.7002858309514087, 'f1-score': 0.49054660907868763, 'support': 24490}, '1': {'precision': 0.36038403233956545, 'recall': 0.1505530693236511, 'f1-score': 0.21238200172716715, 'support': 23686}, '2': {'precision': 0.4152618633391325, 'recall': 0.2905961376994123, 'f1-score': 0.3419200276618341, 'support': 23820}, 'accuracy': 0.3838824379132174, 'macro avg': {'precision': 0.38437770978219904, 'recall': 0.38047834599149066, 'f1-score': 0.34828287948922965, 'support': 71996}, 'weighted avg': {'precision': 0.38435824389215983, 'recall': 0.3838824379132174, 'f1-score': 0.3498597367652596, 'support': 71996}}
[[17150  2966  4374]
 [14747  3566  5373]
 [13535  3363  6922]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0989547
{'0': {'precision': 0.37652018809794063, 'recall': 0.730188679245283, 'f1-score': 0.4968439071359794, 'support': 6360}, '1': {'precision': 0.35551470588235295, 'recall': 0.17185000888572952, 'f1-score': 0.23170001198035223, 'support': 5627}, '2': {'precision': 0.4180660104226983, 'recall': 0.22143842968869806, 'f1-score': 0.2895238095238095, 'support': 6521}, 'accuracy': 0.38118651393991787, 'macro avg': {'precision': 0.38336696813433063, 'recall': 0.37449237260657015, 'f1-score': 0.33935590954671374, 'support': 18508}, 'weighted avg': {'precision': 0.3847718878468402, 'recall': 0.38118651393991787, 'f1-score': 0.34318608054371263, 'support': 18508}}
[[4644  770  946]
 [3596  967 1064]
 [4094  983 1444]]
training model: results/LILAK/W7/deepLOB_L1/h50
Epoch 1/50
282/282 - 9s - loss: 3.3442 - accuracy50: 0.3524 - val_loss: 3.5296 - val_accuracy50: 0.3166 - 9s/epoch - 33ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3249 - accuracy50: 0.3528 - val_loss: 3.4401 - val_accuracy50: 0.3317 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3034 - accuracy50: 0.3571 - val_loss: 3.3896 - val_accuracy50: 0.3209 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2918 - accuracy50: 0.3604 - val_loss: 3.3616 - val_accuracy50: 0.3487 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2771 - accuracy50: 0.3709 - val_loss: 3.3226 - val_accuracy50: 0.3651 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2692 - accuracy50: 0.3800 - val_loss: 3.3653 - val_accuracy50: 0.3576 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2658 - accuracy50: 0.3841 - val_loss: 3.3333 - val_accuracy50: 0.3598 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 8s - loss: 3.2594 - accuracy50: 0.3896 - val_loss: 3.3535 - val_accuracy50: 0.3575 - 8s/epoch - 27ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2535 - accuracy50: 0.3921 - val_loss: 3.3687 - val_accuracy50: 0.3578 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2497 - accuracy50: 0.3949 - val_loss: 3.3550 - val_accuracy50: 0.3578 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2441 - accuracy50: 0.3979 - val_loss: 3.3423 - val_accuracy50: 0.3629 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2395 - accuracy50: 0.4014 - val_loss: 3.3531 - val_accuracy50: 0.3653 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2394 - accuracy50: 0.4013 - val_loss: 3.3655 - val_accuracy50: 0.3600 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2370 - accuracy50: 0.4030 - val_loss: 3.3702 - val_accuracy50: 0.3617 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2335 - accuracy50: 0.4047 - val_loss: 3.3650 - val_accuracy50: 0.3581 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepLOB_L1/h50
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1145167
{'0': {'precision': 0.3122209663746821, 'recall': 0.8184511684752417, 'f1-score': 0.45201010421247484, 'support': 54002}, '1': {'precision': 0.39425880242206773, 'recall': 0.07712555935772572, 'f1-score': 0.12901331963453563, 'support': 68382}, '2': {'precision': 0.3601165876364902, 'recall': 0.14904573280518546, 'f1-score': 0.21083194315331033, 'support': 55540}, 'accuracy': 0.32457678559384906, 'macro avg': {'precision': 0.35553211881108004, 'recall': 0.3482074868793843, 'f1-score': 0.2639517890001069, 'support': 177924}, 'weighted avg': {'precision': 0.35870167785527574, 'recall': 0.32457678559384906, 'f1-score': 0.2525867482389432, 'support': 177924}}
[[44198  3644  6160]
 [54559  5274  8549]
 [42803  4459  8278]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1016289
{'0': {'precision': 0.3648862052949373, 'recall': 0.6376364595592712, 'f1-score': 0.464158579636933, 'support': 24641}, '1': {'precision': 0.3336448598130841, 'recall': 0.08984522461306153, 'f1-score': 0.14156835530881332, 'support': 23841}, '2': {'precision': 0.36169834784153493, 'recall': 0.3463468571914604, 'f1-score': 0.35385618075168374, 'support': 23514}, 'accuracy': 0.36110339463303515, 'macro avg': {'precision': 0.3534098043165188, 'recall': 0.3579428471212644, 'f1-score': 0.31986103856581005, 'support': 71996}, 'weighted avg': {'precision': 0.35349968107425606, 'recall': 0.36110339463303515, 'f1-score': 0.3213100304731676, 'support': 71996}}
[[15712  2127  6802]
 [14129  2142  7570]
 [13219  2151  8144]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059878
{'0': {'precision': 0.36201912386035134, 'recall': 0.767200754005655, 'f1-score': 0.49191720803746797, 'support': 6366}, '1': {'precision': 0.32489451476793246, 'recall': 0.09582222222222223, 'f1-score': 0.14799560680944537, 'support': 5625}, '2': {'precision': 0.37998808814770696, 'recall': 0.19579561147767377, 'f1-score': 0.25843037974683547, 'support': 6517}, 'accuracy': 0.3619515885022693, 'macro avg': {'precision': 0.35563390892533026, 'recall': 0.3529395292351836, 'f1-score': 0.2994477315312496, 'support': 18508}, 'weighted avg': {'precision': 0.35706331092085714, 'recall': 0.3619515885022693, 'f1-score': 0.30517673543763657, 'support': 18508}}
[[4884  528  954]
 [3958  539 1128]
 [4649  592 1276]]
training model: results/LILAK/W7/deepLOB_L1/h100
Epoch 1/50
282/282 - 10s - loss: 3.3395 - accuracy100: 0.3640 - val_loss: 3.4244 - val_accuracy100: 0.3492 - 10s/epoch - 34ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3143 - accuracy100: 0.3652 - val_loss: 3.3850 - val_accuracy100: 0.3314 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2948 - accuracy100: 0.3674 - val_loss: 3.3392 - val_accuracy100: 0.3544 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2930 - accuracy100: 0.3740 - val_loss: 3.3543 - val_accuracy100: 0.3473 - 7s/epoch - 25ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2770 - accuracy100: 0.3803 - val_loss: 3.3351 - val_accuracy100: 0.3485 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2709 - accuracy100: 0.3779 - val_loss: 3.3572 - val_accuracy100: 0.3466 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2629 - accuracy100: 0.3864 - val_loss: 3.3982 - val_accuracy100: 0.3309 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2561 - accuracy100: 0.3909 - val_loss: 3.4068 - val_accuracy100: 0.3400 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2507 - accuracy100: 0.3935 - val_loss: 3.3996 - val_accuracy100: 0.3337 - 7s/epoch - 27ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2477 - accuracy100: 0.3974 - val_loss: 3.4078 - val_accuracy100: 0.3423 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2420 - accuracy100: 0.4007 - val_loss: 3.4289 - val_accuracy100: 0.3276 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2382 - accuracy100: 0.4058 - val_loss: 3.4184 - val_accuracy100: 0.3262 - 7s/epoch - 26ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2332 - accuracy100: 0.4083 - val_loss: 3.4097 - val_accuracy100: 0.3372 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2303 - accuracy100: 0.4099 - val_loss: 3.4248 - val_accuracy100: 0.3316 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2222 - accuracy100: 0.4146 - val_loss: 3.4481 - val_accuracy100: 0.3329 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepLOB_L1/h100
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.108701
{'0': {'precision': 0.306383589155071, 'recall': 0.6039930621017306, 'f1-score': 0.4065428565990089, 'support': 53042}, '1': {'precision': 0.41316241041687696, 'recall': 0.2867993273542601, 'f1-score': 0.33857479631084825, 'support': 71360}, '2': {'precision': 0.31044325050369376, 'recall': 0.13818616643623183, 'f1-score': 0.1912445375326455, 'support': 53522}, 'accuracy': 0.336654976282008, 'macro avg': {'precision': 0.34332975002521393, 'recall': 0.3429928519640742, 'f1-score': 0.31212073014750086, 'support': 177924}, 'weighted avg': {'precision': 0.3504305860747865, 'recall': 0.336654976282008, 'f1-score': 0.31451818642953744, 'support': 177924}}
[[32037 14286  6719]
 [41185 20466  9709]
 [31343 14783  7396]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1080225
{'0': {'precision': 0.3513022113022113, 'recall': 0.5807001868247909, 'f1-score': 0.4377698172131901, 'support': 24622}, '1': {'precision': 0.3325782092772384, 'recall': 0.12926082763825417, 'f1-score': 0.18616587663415962, 'support': 23851}, '2': {'precision': 0.3551257604649051, 'recall': 0.33252561322960505, 'f1-score': 0.343454301960526, 'support': 23523}, 'accuracy': 0.35006111450636146, 'macro avg': {'precision': 0.34633539368145166, 'recall': 0.3474955425642167, 'f1-score': 0.3224633319359586, 'support': 71996}, 'weighted avg': {'precision': 0.3463485357460196, 'recall': 0.35006111450636146, 'f1-score': 0.32360250997335904, 'support': 71996}}
[[14298  3113  7211]
 [13775  3083  6993]
 [12627  3074  7822]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.112265
{'0': {'precision': 0.35486542443064184, 'recall': 0.6537992065913946, 'f1-score': 0.46003542863277685, 'support': 6554}, '1': {'precision': 0.2893048128342246, 'recall': 0.20908212560386474, 'f1-score': 0.2427369601794728, 'support': 5175}, '2': {'precision': 0.37616041589305604, 'recall': 0.14943206962678862, 'f1-score': 0.2138935810810811, 'support': 6779}, 'accuracy': 0.3447157985735898, 'macro avg': {'precision': 0.34011021771930744, 'recall': 0.3374378006073493, 'f1-score': 0.30555532329777696, 'support': 18508}, 'weighted avg': {'precision': 0.3443339019599398, 'recall': 0.3447157985735898, 'f1-score': 0.3091214909410331, 'support': 18508}}
[[4285 1354  915]
 [3328 1082  765]
 [4462 1304 1013]]
training model: results/LILAK/W7/deepLOB_L1/h200
Epoch 1/50
282/282 - 9s - loss: 3.3515 - accuracy200: 0.3525 - val_loss: 3.3980 - val_accuracy200: 0.3241 - 9s/epoch - 33ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3348 - accuracy200: 0.3426 - val_loss: 3.5242 - val_accuracy200: 0.3086 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3114 - accuracy200: 0.3524 - val_loss: 3.3613 - val_accuracy200: 0.3304 - 7s/epoch - 25ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2975 - accuracy200: 0.3583 - val_loss: 3.3327 - val_accuracy200: 0.3255 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2966 - accuracy200: 0.3589 - val_loss: 3.3343 - val_accuracy200: 0.3233 - 7s/epoch - 25ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2859 - accuracy200: 0.3626 - val_loss: 3.3367 - val_accuracy200: 0.3268 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2756 - accuracy200: 0.3753 - val_loss: 3.3483 - val_accuracy200: 0.3267 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2729 - accuracy200: 0.3803 - val_loss: 3.3455 - val_accuracy200: 0.3269 - 7s/epoch - 25ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2677 - accuracy200: 0.3834 - val_loss: 3.3470 - val_accuracy200: 0.3253 - 7s/epoch - 25ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2621 - accuracy200: 0.3888 - val_loss: 3.3574 - val_accuracy200: 0.3218 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2572 - accuracy200: 0.3892 - val_loss: 3.3603 - val_accuracy200: 0.3254 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2535 - accuracy200: 0.3921 - val_loss: 3.3622 - val_accuracy200: 0.3235 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2427 - accuracy200: 0.4013 - val_loss: 3.3636 - val_accuracy200: 0.3325 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2380 - accuracy200: 0.4036 - val_loss: 3.3729 - val_accuracy200: 0.3307 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepLOB_L1/h200
Evaluating performance on  test set...
696/696 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1073828
{'0': {'precision': 0.3211897035046702, 'recall': 0.48806051929229194, 'f1-score': 0.38742037769733706, 'support': 56577}, '1': {'precision': 0.3511008667675094, 'recall': 0.23668706095626557, 'f1-score': 0.2827585540118533, 'support': 61782}, '2': {'precision': 0.3435114503816794, 'recall': 0.29010324855200204, 'f1-score': 0.3145564262894902, 'support': 59565}, 'accuracy': 0.3345023717991952, 'macro avg': {'precision': 0.3386006735512863, 'recall': 0.3382836096001865, 'f1-score': 0.3282451193328935, 'support': 177924}, 'weighted avg': {'precision': 0.339048825047766, 'recall': 0.3345023717991952, 'f1-score': 0.3266845688320634, 'support': 177924}}
[[27613 12995 15969]
 [30104 14623 17055]
 [28254 14031 17280]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1095569
{'0': {'precision': 0.34467936063172644, 'recall': 0.4400406504065041, 'f1-score': 0.3865657251008821, 'support': 24600}, '1': {'precision': 0.3489453687933971, 'recall': 0.22355113517142977, 'f1-score': 0.27251566696508506, 'support': 23829}, '2': {'precision': 0.3368741115147686, 'recall': 0.3619892222175075, 'f1-score': 0.34898038493792316, 'support': 23567}, 'accuracy': 0.3428384910272793, 'macro avg': {'precision': 0.3434996136466307, 'recall': 0.3418603359318138, 'f1-score': 0.33602059233463005, 'support': 71996}, 'weighted avg': {'precision': 0.3435363582780555, 'recall': 0.3428384910272793, 'f1-score': 0.3365147146706032, 'support': 71996}}
[[10825  5237  8538]
 [10247  5327  8255]
 [10334  4702  8531]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119297
{'0': {'precision': 0.3379256563556018, 'recall': 0.40803515379786565, 'f1-score': 0.36968576709796674, 'support': 6372}, '1': {'precision': 0.29895138226882745, 'recall': 0.2754259617073599, 'f1-score': 0.28670689339915884, 'support': 5693}, '2': {'precision': 0.32842521098940564, 'recall': 0.2838739717522893, 'f1-score': 0.30452880452880454, 'support': 6443}, 'accuracy': 0.3240220445212881, 'macro avg': {'precision': 0.32176741653794494, 'recall': 0.3224450290858383, 'f1-score': 0.3203071550086434, 'support': 18508}, 'weighted avg': {'precision': 0.3226300051847347, 'recall': 0.3240220445212881, 'f1-score': 0.32147931379126554, 'support': 18508}}
[[2600 1830 1942]
 [2327 1568 1798]
 [2767 1847 1829]]
training model: results/LILAK/W7/deepLOB_L1/h300
Epoch 1/50
282/282 - 9s - loss: 3.3561 - accuracy300: 0.3479 - val_loss: 3.4627 - val_accuracy300: 0.3364 - 9s/epoch - 34ms/step
Epoch 2/50
282/282 - 8s - loss: 3.3177 - accuracy300: 0.3605 - val_loss: 3.3894 - val_accuracy300: 0.3303 - 8s/epoch - 27ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3063 - accuracy300: 0.3654 - val_loss: 3.4328 - val_accuracy300: 0.3171 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2960 - accuracy300: 0.3675 - val_loss: 3.3623 - val_accuracy300: 0.3303 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2887 - accuracy300: 0.3686 - val_loss: 3.3656 - val_accuracy300: 0.3350 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2709 - accuracy300: 0.3834 - val_loss: 3.3913 - val_accuracy300: 0.3287 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2609 - accuracy300: 0.3914 - val_loss: 3.3887 - val_accuracy300: 0.3309 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2521 - accuracy300: 0.3968 - val_loss: 3.3912 - val_accuracy300: 0.3226 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2559 - accuracy300: 0.3924 - val_loss: 3.3448 - val_accuracy300: 0.3347 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2468 - accuracy300: 0.3963 - val_loss: 3.3490 - val_accuracy300: 0.3212 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2345 - accuracy300: 0.4081 - val_loss: 3.3429 - val_accuracy300: 0.3310 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2191 - accuracy300: 0.4146 - val_loss: 3.3680 - val_accuracy300: 0.3216 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2107 - accuracy300: 0.4231 - val_loss: 3.4136 - val_accuracy300: 0.3216 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2070 - accuracy300: 0.4221 - val_loss: 3.4277 - val_accuracy300: 0.3193 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 8s - loss: 3.2081 - accuracy300: 0.4220 - val_loss: 3.3630 - val_accuracy300: 0.3310 - 8s/epoch - 27ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2077 - accuracy300: 0.4207 - val_loss: 3.4182 - val_accuracy300: 0.3182 - 7s/epoch - 26ms/step
Epoch 17/50
282/282 - 7s - loss: 3.1917 - accuracy300: 0.4311 - val_loss: 3.4466 - val_accuracy300: 0.3283 - 7s/epoch - 26ms/step
Epoch 18/50
282/282 - 7s - loss: 3.1890 - accuracy300: 0.4312 - val_loss: 3.4181 - val_accuracy300: 0.3267 - 7s/epoch - 26ms/step
Epoch 19/50
282/282 - 7s - loss: 3.1880 - accuracy300: 0.4308 - val_loss: 3.4131 - val_accuracy300: 0.3272 - 7s/epoch - 26ms/step
Epoch 20/50
282/282 - 7s - loss: 3.1778 - accuracy300: 0.4365 - val_loss: 3.3822 - val_accuracy300: 0.3393 - 7s/epoch - 26ms/step
Epoch 21/50
282/282 - 7s - loss: 3.1761 - accuracy300: 0.4337 - val_loss: 3.3975 - val_accuracy300: 0.3339 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepLOB_L1/h300
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103547
{'0': {'precision': 0.30226746110559416, 'recall': 0.3445329006942348, 'f1-score': 0.32201925450506047, 'support': 53008}, '1': {'precision': 0.37608573040045123, 'recall': 0.19451858982773962, 'f1-score': 0.2564146934694623, 'support': 68559}, '2': {'precision': 0.3275681341719078, 'recall': 0.47687066380396403, 'f1-score': 0.3883642459230786, 'support': 56357}, 'accuracy': 0.3286459387154066, 'macro avg': {'precision': 0.3353071085593178, 'recall': 0.33864071810864615, 'f1-score': 0.32226606463253377, 'support': 177924}, 'weighted avg': {'precision': 0.33872559354744763, 'recall': 0.3286459387154066, 'f1-score': 0.31775463355063993, 'support': 177924}}
[[18263 10536 24209]
 [24263 13336 30960]
 [17894 11588 26875]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1218714
{'0': {'precision': 0.3490987320316829, 'recall': 0.4350651988463257, 'f1-score': 0.3873697916666667, 'support': 24617}, '1': {'precision': 0.34271644862560635, 'recall': 0.19536618066029832, 'f1-score': 0.24886588034370496, 'support': 23868}, '2': {'precision': 0.3393237342571542, 'recall': 0.39994045340478923, 'f1-score': 0.3671469290539221, 'support': 23511}, 'accuracy': 0.34413022945719207, 'macro avg': {'precision': 0.3437129716381478, 'recall': 0.3434572776371378, 'f1-score': 0.33446086702143124, 'support': 71996}, 'weighted avg': {'precision': 0.3437907661306165, 'recall': 0.34413022945719207, 'f1-score': 0.33484921999123074, 'support': 71996}}
[[10710  4706  9201]
 [10098  4663  9107]
 [ 9871  4237  9403]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.113731
{'0': {'precision': 0.3302891933028919, 'recall': 0.3453764125417794, 'f1-score': 0.3376643585155217, 'support': 6283}, '1': {'precision': 0.2972404730617608, 'recall': 0.19459738472126634, 'f1-score': 0.2352084849745243, 'support': 5812}, '2': {'precision': 0.3376367883929669, 'recall': 0.4281927335100577, 'f1-score': 0.3775608414684449, 'support': 6413}, 'accuracy': 0.32672357899286797, 'macro avg': {'precision': 0.32172215158587325, 'recall': 0.32272217692436783, 'f1-score': 0.316811228319497, 'support': 18508}, 'weighted avg': {'precision': 0.32245695671715585, 'recall': 0.32672357899286797, 'f1-score': 0.31931459669127377, 'support': 18508}}
[[2170 1337 2776]
 [2070 1131 2611]
 [2330 1337 2746]]
training model: results/LILAK/W7/deepLOB_L1/h500
Epoch 1/50
282/282 - 10s - loss: 3.3411 - accuracy500: 0.3566 - val_loss: 3.5931 - val_accuracy500: 0.3319 - 10s/epoch - 36ms/step
Epoch 2/50
282/282 - 8s - loss: 3.3262 - accuracy500: 0.3552 - val_loss: 3.4807 - val_accuracy500: 0.3390 - 8s/epoch - 28ms/step
Epoch 3/50
282/282 - 8s - loss: 3.3006 - accuracy500: 0.3651 - val_loss: 3.4028 - val_accuracy500: 0.3387 - 8s/epoch - 28ms/step
Epoch 4/50
282/282 - 8s - loss: 3.2927 - accuracy500: 0.3672 - val_loss: 3.3728 - val_accuracy500: 0.3401 - 8s/epoch - 28ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2738 - accuracy500: 0.3749 - val_loss: 3.4323 - val_accuracy500: 0.3372 - 8s/epoch - 27ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2624 - accuracy500: 0.3812 - val_loss: 3.3432 - val_accuracy500: 0.3355 - 8s/epoch - 27ms/step
Epoch 7/50
282/282 - 8s - loss: 3.2479 - accuracy500: 0.3936 - val_loss: 3.3506 - val_accuracy500: 0.3323 - 8s/epoch - 27ms/step
Epoch 8/50
282/282 - 8s - loss: 3.2297 - accuracy500: 0.4034 - val_loss: 3.3453 - val_accuracy500: 0.3354 - 8s/epoch - 27ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2203 - accuracy500: 0.4106 - val_loss: 3.3688 - val_accuracy500: 0.3269 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2082 - accuracy500: 0.4179 - val_loss: 3.3593 - val_accuracy500: 0.3348 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 8s - loss: 3.2037 - accuracy500: 0.4178 - val_loss: 3.3866 - val_accuracy500: 0.3361 - 8s/epoch - 27ms/step
Epoch 12/50
282/282 - 8s - loss: 3.2025 - accuracy500: 0.4186 - val_loss: 3.4391 - val_accuracy500: 0.3226 - 8s/epoch - 27ms/step
Epoch 13/50
282/282 - 8s - loss: 3.1827 - accuracy500: 0.4301 - val_loss: 3.4240 - val_accuracy500: 0.3328 - 8s/epoch - 27ms/step
Epoch 14/50
282/282 - 8s - loss: 3.1842 - accuracy500: 0.4305 - val_loss: 3.4305 - val_accuracy500: 0.3346 - 8s/epoch - 30ms/step
Epoch 15/50
282/282 - 8s - loss: 3.1794 - accuracy500: 0.4285 - val_loss: 3.4689 - val_accuracy500: 0.3308 - 8s/epoch - 28ms/step
Epoch 16/50
282/282 - 8s - loss: 3.1667 - accuracy500: 0.4375 - val_loss: 3.5003 - val_accuracy500: 0.3315 - 8s/epoch - 27ms/step
testing model: results/LILAK/W7/deepLOB_L1/h500
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1037818
{'0': {'precision': 0.27840959181874286, 'recall': 0.12736695638145556, 'f1-score': 0.1747768938083708, 'support': 49589}, '1': {'precision': 0.4023622950990724, 'recall': 0.5395022174965374, 'f1-score': 0.46094814602309403, 'support': 71477}, '2': {'precision': 0.3179009747638849, 'recall': 0.33210805867248233, 'f1-score': 0.3248492563888626, 'support': 56858}, 'accuracy': 0.358360873181808, 'macro avg': {'precision': 0.33289095389390005, 'recall': 0.33299241085015846, 'f1-score': 0.3201914320734425, 'support': 177924}, 'weighted avg': {'precision': 0.34082482767148337, 'recall': 0.358360873181808, 'f1-score': 0.3376974496982641, 'support': 177924}}
[[ 6316 26707 16566]
 [ 8965 38562 23950]
 [ 7405 30570 18883]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1245258
{'0': {'precision': 0.34261220028690487, 'recall': 0.4098802762227761, 'f1-score': 0.37323956763595095, 'support': 24473}, '1': {'precision': 0.33245670301475305, 'recall': 0.21309925170627417, 'f1-score': 0.2597213870515133, 'support': 24322}, '2': {'precision': 0.33625774107932765, 'recall': 0.39317270807292787, 'f1-score': 0.36249478431917975, 'support': 23201}, 'accuracy': 0.33801877882104564, 'macro avg': {'precision': 0.3371088814603285, 'recall': 0.33871741200065936, 'f1-score': 0.33181857966888134, 'support': 71996}, 'weighted avg': {'precision': 0.33713367630323526, 'recall': 0.33801877882104564, 'f1-score': 0.33142781551212325, 'support': 71996}}
[[10031  5523  8919]
 [10052  5183  9087]
 [ 9195  4884  9122]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1117297
{'0': {'precision': 0.3137190624487789, 'recall': 0.32429684852592344, 'f1-score': 0.3189202699325169, 'support': 5902}, '1': {'precision': 0.3454231433506045, 'recall': 0.3828361780188228, 'f1-score': 0.3631686464401907, 'support': 6269}, '2': {'precision': 0.35702509617146, 'recall': 0.3075587817579296, 'f1-score': 0.330451000339098, 'support': 6337}, 'accuracy': 0.33839420791009295, 'macro avg': {'precision': 0.3387224339902812, 'recall': 0.3382306027675586, 'f1-score': 0.33751330557060183, 'support': 18508}, 'weighted avg': {'precision': 0.3392854779920129, 'recall': 0.33839420791009295, 'f1-score': 0.33785604424163246, 'support': 18508}}
[[1914 2274 1714]
 [2073 2400 1796]
 [2114 2274 1949]]
training model: results/LILAK/W7/deepLOB_L1/h1000
Epoch 1/50
282/282 - 10s - loss: 3.3191 - accuracy1000: 0.3671 - val_loss: 3.6545 - val_accuracy1000: 0.3517 - 10s/epoch - 34ms/step
Epoch 2/50
282/282 - 7s - loss: 3.2988 - accuracy1000: 0.3745 - val_loss: 3.6187 - val_accuracy1000: 0.3329 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2558 - accuracy1000: 0.3932 - val_loss: 3.6227 - val_accuracy1000: 0.3354 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2176 - accuracy1000: 0.4083 - val_loss: 3.5602 - val_accuracy1000: 0.3236 - 7s/epoch - 25ms/step
Epoch 5/50
282/282 - 7s - loss: 3.1768 - accuracy1000: 0.4275 - val_loss: 3.6288 - val_accuracy1000: 0.3112 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.1511 - accuracy1000: 0.4422 - val_loss: 3.7031 - val_accuracy1000: 0.3042 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.1299 - accuracy1000: 0.4481 - val_loss: 3.7846 - val_accuracy1000: 0.3045 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.1139 - accuracy1000: 0.4524 - val_loss: 3.8611 - val_accuracy1000: 0.3023 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.1007 - accuracy1000: 0.4616 - val_loss: 3.8362 - val_accuracy1000: 0.3080 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.0848 - accuracy1000: 0.4636 - val_loss: 3.9315 - val_accuracy1000: 0.3052 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.0674 - accuracy1000: 0.4703 - val_loss: 4.0049 - val_accuracy1000: 0.3139 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 8s - loss: 3.0528 - accuracy1000: 0.4744 - val_loss: 3.9752 - val_accuracy1000: 0.3213 - 8s/epoch - 27ms/step
Epoch 13/50
282/282 - 7s - loss: 3.0422 - accuracy1000: 0.4774 - val_loss: 4.0158 - val_accuracy1000: 0.3351 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.0338 - accuracy1000: 0.4788 - val_loss: 4.1836 - val_accuracy1000: 0.3188 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1645159
{'0': {'precision': 0.2839292502042104, 'recall': 0.6967610050410828, 'f1-score': 0.4034522188320606, 'support': 50386}, '1': {'precision': 0.38456242207707625, 'recall': 0.29943347291247085, 'f1-score': 0.33670044641402463, 'support': 69017}, '2': {'precision': 0.32342007434944237, 'recall': 0.002973291638898857, 'f1-score': 0.005892412672073689, 'support': 58521}, 'accuracy': 0.3144432454306333, 'macro avg': {'precision': 0.33063724887690965, 'recall': 0.33305592319748417, 'f1-score': 0.24868169263938633, 'support': 177924}, 'weighted avg': {'precision': 0.3359539469452499, 'recall': 0.3144432454306333, 'f1-score': 0.246797666926392, 'support': 177924}}
[[35107 15116   163]
 [48150 20666   201]
 [40390 17957   174]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1650013
{'0': {'precision': 0.35234360234360235, 'recall': 0.6027806967908819, 'f1-score': 0.44472938720739524, 'support': 24742}, '1': {'precision': 0.343786597267404, 'recall': 0.21341734318833555, 'f1-score': 0.2633506940118119, 'support': 24759}, '2': {'precision': 0.35340607077912994, 'recall': 0.22462769504334296, 'f1-score': 0.27467181257304374, 'support': 22495}, 'accuracy': 0.3507278182121229, 'macro avg': {'precision': 0.34984542346337877, 'recall': 0.3469419116741868, 'f1-score': 0.32758396459741695, 'support': 71996}, 'weighted avg': {'precision': 0.3497328647856213, 'recall': 0.3507278182121229, 'f1-score': 0.3292201893876666, 'support': 71996}}
[[14914  5378  4450]
 [14680  5284  4795]
 [12734  4708  5053]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1680269
{'0': {'precision': 0.3055731475617479, 'recall': 0.6741180579811387, 'f1-score': 0.42052511166793766, 'support': 5726}, '1': {'precision': 0.36084487042953495, 'recall': 0.30659025787965616, 'f1-score': 0.3315124337545862, 'support': 6631}, '2': {'precision': 0.4256198347107438, 'recall': 0.016745244675662494, 'f1-score': 0.03222274362584076, 'support': 6151}, 'accuracy': 0.32396801383185647, 'macro avg': {'precision': 0.3640126175673422, 'recall': 0.3324845201788191, 'f1-score': 0.2614200963494549, 'support': 18508}, 'weighted avg': {'precision': 0.36527241096080615, 'recall': 0.32396801383185647, 'f1-score': 0.25958438695049807, 'support': 18508}}
[[3860 1776   90]
 [4549 2033   49]
 [4223 1825  103]]
training model: results/LILAK/W7/deepOF_L1/h10
Epoch 1/50
282/282 - 9s - loss: 3.2990 - accuracy10: 0.3773 - val_loss: 3.2976 - val_accuracy10: 0.3811 - 9s/epoch - 32ms/step
Epoch 2/50
282/282 - 7s - loss: 3.2645 - accuracy10: 0.3970 - val_loss: 3.2848 - val_accuracy10: 0.3843 - 7s/epoch - 25ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2471 - accuracy10: 0.4074 - val_loss: 3.2755 - val_accuracy10: 0.3888 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2381 - accuracy10: 0.4099 - val_loss: 3.2705 - val_accuracy10: 0.3933 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2280 - accuracy10: 0.4169 - val_loss: 3.2673 - val_accuracy10: 0.3929 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2222 - accuracy10: 0.4201 - val_loss: 3.2716 - val_accuracy10: 0.3939 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2137 - accuracy10: 0.4234 - val_loss: 3.2671 - val_accuracy10: 0.3957 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2069 - accuracy10: 0.4260 - val_loss: 3.2646 - val_accuracy10: 0.3946 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2042 - accuracy10: 0.4288 - val_loss: 3.2606 - val_accuracy10: 0.3987 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.1993 - accuracy10: 0.4290 - val_loss: 3.2597 - val_accuracy10: 0.3978 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.1934 - accuracy10: 0.4341 - val_loss: 3.2615 - val_accuracy10: 0.3988 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.1889 - accuracy10: 0.4352 - val_loss: 3.2603 - val_accuracy10: 0.4009 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.1857 - accuracy10: 0.4359 - val_loss: 3.2606 - val_accuracy10: 0.3992 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.1800 - accuracy10: 0.4379 - val_loss: 3.2691 - val_accuracy10: 0.3985 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 7s - loss: 3.1781 - accuracy10: 0.4378 - val_loss: 3.2680 - val_accuracy10: 0.3987 - 7s/epoch - 26ms/step
Epoch 16/50
282/282 - 7s - loss: 3.1746 - accuracy10: 0.4418 - val_loss: 3.2626 - val_accuracy10: 0.3992 - 7s/epoch - 26ms/step
Epoch 17/50
282/282 - 7s - loss: 3.1682 - accuracy10: 0.4433 - val_loss: 3.2603 - val_accuracy10: 0.4033 - 7s/epoch - 26ms/step
Epoch 18/50
282/282 - 7s - loss: 3.1652 - accuracy10: 0.4457 - val_loss: 3.2611 - val_accuracy10: 0.4025 - 7s/epoch - 26ms/step
Epoch 19/50
282/282 - 7s - loss: 3.1634 - accuracy10: 0.4454 - val_loss: 3.2596 - val_accuracy10: 0.4032 - 7s/epoch - 26ms/step
Epoch 20/50
282/282 - 7s - loss: 3.1565 - accuracy10: 0.4505 - val_loss: 3.2673 - val_accuracy10: 0.3997 - 7s/epoch - 25ms/step
Epoch 21/50
282/282 - 7s - loss: 3.1546 - accuracy10: 0.4494 - val_loss: 3.2647 - val_accuracy10: 0.4004 - 7s/epoch - 25ms/step
Epoch 22/50
282/282 - 7s - loss: 3.1517 - accuracy10: 0.4512 - val_loss: 3.2615 - val_accuracy10: 0.4018 - 7s/epoch - 26ms/step
Epoch 23/50
282/282 - 7s - loss: 3.1481 - accuracy10: 0.4526 - val_loss: 3.2700 - val_accuracy10: 0.4029 - 7s/epoch - 26ms/step
Epoch 24/50
282/282 - 7s - loss: 3.1442 - accuracy10: 0.4555 - val_loss: 3.2682 - val_accuracy10: 0.4014 - 7s/epoch - 25ms/step
Epoch 25/50
282/282 - 7s - loss: 3.1407 - accuracy10: 0.4550 - val_loss: 3.2645 - val_accuracy10: 0.4043 - 7s/epoch - 25ms/step
Epoch 26/50
282/282 - 7s - loss: 3.1362 - accuracy10: 0.4563 - val_loss: 3.2687 - val_accuracy10: 0.4037 - 7s/epoch - 25ms/step
Epoch 27/50
282/282 - 7s - loss: 3.1315 - accuracy10: 0.4575 - val_loss: 3.2687 - val_accuracy10: 0.4063 - 7s/epoch - 25ms/step
Epoch 28/50
282/282 - 7s - loss: 3.1305 - accuracy10: 0.4601 - val_loss: 3.2715 - val_accuracy10: 0.4017 - 7s/epoch - 26ms/step
Epoch 29/50
282/282 - 7s - loss: 3.1273 - accuracy10: 0.4605 - val_loss: 3.2722 - val_accuracy10: 0.4053 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepOF_L1/h10
Evaluating performance on  test set...
695/695 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0599341
{'0': {'precision': 0.39885666770605965, 'recall': 0.3632112974671563, 'f1-score': 0.38020033488224625, 'support': 52826}, '1': {'precision': 0.5026566168293587, 'recall': 0.5592751969424089, 'f1-score': 0.5294565521549843, 'support': 72737}, '2': {'precision': 0.3969192373782833, 'recall': 0.3705974482389793, 'f1-score': 0.3833069932832872, 'support': 52356}, 'accuracy': 0.44553982430207006, 'macro avg': {'precision': 0.43281084063790054, 'recall': 0.43102798088284816, 'f1-score': 0.4309879601068392, 'support': 177919}, 'weighted avg': {'precision': 0.4407221278151, 'recall': 0.44553982430207006, 'f1-score': 0.4421335836247192, 'support': 177919}}
[[19187 20473 13166]
 [15742 40680 16315]
 [13176 19777 19403]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0568688
{'0': {'precision': 0.44281118535016084, 'recall': 0.3816002729676704, 'f1-score': 0.4099333348605988, 'support': 23446}, '1': {'precision': 0.4517023219410384, 'recall': 0.5403370523523445, 'f1-score': 0.49206010870723654, 'support': 25634}, '2': {'precision': 0.4234319526627219, 'recall': 0.3903726979139391, 'f1-score': 0.4062308408456141, 'support': 22914}, 'accuracy': 0.44091174264522043, 'macro avg': {'precision': 0.4393151533179737, 'recall': 0.437436674411318, 'f1-score': 0.4360747614711498, 'support': 71994}, 'weighted avg': {'precision': 0.4398089859664702, 'recall': 0.44091174264522043, 'f1-score': 0.4379967675483971, 'support': 71994}}
[[ 8947  8521  5978]
 [ 5581 13851  6202]
 [ 5677  8292  8945]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0872543
{'0': {'precision': 0.3808997050147493, 'recall': 0.3529210796036898, 'f1-score': 0.3663770172016315, 'support': 5854}, '1': {'precision': 0.41390816871329417, 'recall': 0.4803283767038414, 'f1-score': 0.44465156294809294, 'support': 6456}, '2': {'precision': 0.3987839771101574, 'recall': 0.3597934817683124, 'f1-score': 0.3782866836301952, 'support': 6198}, 'accuracy': 0.3996650097255241, 'macro avg': {'precision': 0.3978639502794003, 'recall': 0.3976809793586145, 'f1-score': 0.3964384212599732, 'support': 18508}, 'weighted avg': {'precision': 0.3984029122810744, 'recall': 0.3996650097255241, 'f1-score': 0.39766924650049645, 'support': 18508}}
[[2066 2155 1633]
 [1626 3101 1729]
 [1732 2236 2230]]
training model: results/LILAK/W7/deepOF_L1/h20
Epoch 1/50
282/282 - 9s - loss: 3.3202 - accuracy20: 0.3534 - val_loss: 3.3216 - val_accuracy20: 0.3553 - 9s/epoch - 34ms/step
Epoch 2/50
282/282 - 7s - loss: 3.2936 - accuracy20: 0.3688 - val_loss: 3.2986 - val_accuracy20: 0.3679 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2830 - accuracy20: 0.3748 - val_loss: 3.2921 - val_accuracy20: 0.3719 - 8s/epoch - 27ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2753 - accuracy20: 0.3777 - val_loss: 3.2874 - val_accuracy20: 0.3749 - 7s/epoch - 25ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2683 - accuracy20: 0.3839 - val_loss: 3.2881 - val_accuracy20: 0.3724 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2673 - accuracy20: 0.3823 - val_loss: 3.2893 - val_accuracy20: 0.3701 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2602 - accuracy20: 0.3880 - val_loss: 3.2909 - val_accuracy20: 0.3701 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2593 - accuracy20: 0.3898 - val_loss: 3.2864 - val_accuracy20: 0.3715 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2554 - accuracy20: 0.3920 - val_loss: 3.2920 - val_accuracy20: 0.3738 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2505 - accuracy20: 0.3968 - val_loss: 3.2897 - val_accuracy20: 0.3721 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2472 - accuracy20: 0.3970 - val_loss: 3.2876 - val_accuracy20: 0.3715 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2430 - accuracy20: 0.3995 - val_loss: 3.2900 - val_accuracy20: 0.3754 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2407 - accuracy20: 0.4014 - val_loss: 3.2876 - val_accuracy20: 0.3728 - 7s/epoch - 25ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2356 - accuracy20: 0.4045 - val_loss: 3.2909 - val_accuracy20: 0.3783 - 7s/epoch - 25ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2351 - accuracy20: 0.4045 - val_loss: 3.2878 - val_accuracy20: 0.3777 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2304 - accuracy20: 0.4061 - val_loss: 3.2895 - val_accuracy20: 0.3758 - 7s/epoch - 26ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2279 - accuracy20: 0.4076 - val_loss: 3.2883 - val_accuracy20: 0.3775 - 7s/epoch - 27ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2246 - accuracy20: 0.4103 - val_loss: 3.2924 - val_accuracy20: 0.3747 - 7s/epoch - 26ms/step
testing model: results/LILAK/W7/deepOF_L1/h20
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0875875
{'0': {'precision': 0.36972899445432666, 'recall': 0.2583062246427135, 'f1-score': 0.3041335829406322, 'support': 54718}, '1': {'precision': 0.431379760802567, 'recall': 0.4995373702066413, 'f1-score': 0.46296346708771163, 'support': 68089}, '2': {'precision': 0.3641936756294787, 'recall': 0.40207214399767743, 'f1-score': 0.38219669529821654, 'support': 55112}, 'accuracy': 0.39515734688257015, 'macro avg': {'precision': 0.3884341436287908, 'recall': 0.38663857961567744, 'f1-score': 0.38309791510885344, 'support': 177919}, 'weighted avg': {'precision': 0.3916079199137229, 'recall': 0.39515734688257015, 'f1-score': 0.38909798938368595, 'support': 177919}}
[[14134 22823 17761]
 [13152 34013 20924]
 [10942 22011 22159]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0865823
{'0': {'precision': 0.4101273319514362, 'recall': 0.2854375334899633, 'f1-score': 0.3366062314684295, 'support': 24261}, '1': {'precision': 0.3884337683976673, 'recall': 0.4635075801507746, 'f1-score': 0.4226628895184136, 'support': 24142}, '2': {'precision': 0.38355956047298584, 'recall': 0.42762070281039377, 'f1-score': 0.4043934899382667, 'support': 23591}, 'accuracy': 0.3917409784148679, 'macro avg': {'precision': 0.3940402202740298, 'recall': 0.39218860548371054, 'f1-score': 0.3878875369750366, 'support': 71994}, 'weighted avg': {'precision': 0.3941470237554308, 'recall': 0.3917409784148679, 'f1-score': 0.38767644639195986, 'support': 71994}}
[[ 6925  9062  8274]
 [ 5013 11190  7939]
 [ 4947  8556 10088]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0958478
{'0': {'precision': 0.3800637232589895, 'recall': 0.2711479136223413, 'f1-score': 0.3164976783852933, 'support': 6159}, '1': {'precision': 0.35630087005332584, 'recall': 0.4282341035587789, 'f1-score': 0.3889697433933359, 'support': 5929}, '2': {'precision': 0.3836576989124213, 'recall': 0.417601246105919, 'f1-score': 0.3999105011933174, 'support': 6420}, 'accuracy': 0.37227145018370433, 'macro avg': {'precision': 0.3733407640749122, 'recall': 0.37232775442901306, 'f1-score': 0.36845930765731555, 'support': 18508}, 'weighted avg': {'precision': 0.37369800935357844, 'recall': 0.37227145018370433, 'f1-score': 0.36864794831506414, 'support': 18508}}
[[1670 2282 2207]
 [1290 2539 2100]
 [1434 2305 2681]]
training model: results/LILAK/W7/deepOF_L1/h30
Epoch 1/50
282/282 - 9s - loss: 3.3287 - accuracy30: 0.3429 - val_loss: 3.3190 - val_accuracy30: 0.3509 - 9s/epoch - 32ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3051 - accuracy30: 0.3545 - val_loss: 3.3077 - val_accuracy30: 0.3648 - 7s/epoch - 23ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2947 - accuracy30: 0.3594 - val_loss: 3.2979 - val_accuracy30: 0.3620 - 7s/epoch - 24ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2892 - accuracy30: 0.3658 - val_loss: 3.2980 - val_accuracy30: 0.3611 - 7s/epoch - 24ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2842 - accuracy30: 0.3689 - val_loss: 3.2909 - val_accuracy30: 0.3689 - 7s/epoch - 24ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2795 - accuracy30: 0.3728 - val_loss: 3.2928 - val_accuracy30: 0.3639 - 7s/epoch - 24ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2746 - accuracy30: 0.3741 - val_loss: 3.2928 - val_accuracy30: 0.3674 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2733 - accuracy30: 0.3753 - val_loss: 3.2901 - val_accuracy30: 0.3663 - 7s/epoch - 25ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2695 - accuracy30: 0.3793 - val_loss: 3.2927 - val_accuracy30: 0.3645 - 7s/epoch - 24ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2665 - accuracy30: 0.3787 - val_loss: 3.2896 - val_accuracy30: 0.3667 - 7s/epoch - 24ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2645 - accuracy30: 0.3827 - val_loss: 3.2906 - val_accuracy30: 0.3671 - 7s/epoch - 24ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2609 - accuracy30: 0.3839 - val_loss: 3.2898 - val_accuracy30: 0.3683 - 7s/epoch - 24ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2587 - accuracy30: 0.3876 - val_loss: 3.2927 - val_accuracy30: 0.3689 - 7s/epoch - 24ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2555 - accuracy30: 0.3868 - val_loss: 3.2946 - val_accuracy30: 0.3656 - 7s/epoch - 24ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2524 - accuracy30: 0.3902 - val_loss: 3.2886 - val_accuracy30: 0.3684 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2527 - accuracy30: 0.3909 - val_loss: 3.2961 - val_accuracy30: 0.3662 - 7s/epoch - 24ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2467 - accuracy30: 0.3929 - val_loss: 3.2962 - val_accuracy30: 0.3686 - 7s/epoch - 25ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2463 - accuracy30: 0.3944 - val_loss: 3.2999 - val_accuracy30: 0.3673 - 7s/epoch - 24ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2426 - accuracy30: 0.3951 - val_loss: 3.2988 - val_accuracy30: 0.3696 - 7s/epoch - 24ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2403 - accuracy30: 0.3986 - val_loss: 3.3013 - val_accuracy30: 0.3643 - 7s/epoch - 24ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2378 - accuracy30: 0.3987 - val_loss: 3.2996 - val_accuracy30: 0.3701 - 7s/epoch - 24ms/step
Epoch 22/50
282/282 - 7s - loss: 3.2372 - accuracy30: 0.3998 - val_loss: 3.2978 - val_accuracy30: 0.3708 - 7s/epoch - 25ms/step
Epoch 23/50
282/282 - 7s - loss: 3.2325 - accuracy30: 0.4031 - val_loss: 3.3053 - val_accuracy30: 0.3657 - 7s/epoch - 24ms/step
Epoch 24/50
282/282 - 7s - loss: 3.2301 - accuracy30: 0.4036 - val_loss: 3.3095 - val_accuracy30: 0.3684 - 7s/epoch - 25ms/step
Epoch 25/50
282/282 - 7s - loss: 3.2287 - accuracy30: 0.4051 - val_loss: 3.3138 - val_accuracy30: 0.3650 - 7s/epoch - 24ms/step
testing model: results/LILAK/W7/deepOF_L1/h30
Evaluating performance on  test set...
695/695 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0916903
{'0': {'precision': 0.34825367647058825, 'recall': 0.3512756804865386, 'f1-score': 0.3497581508695492, 'support': 53932}, '1': {'precision': 0.4284171576490019, 'recall': 0.3902696603205833, 'f1-score': 0.40845464937581855, 'support': 69124}, '2': {'precision': 0.35734104046242776, 'recall': 0.3943823706323023, 'f1-score': 0.37494909585575287, 'support': 54863}, 'accuracy': 0.3797177367228908, 'macro avg': {'precision': 0.378003958194006, 'recall': 0.37864257047980815, 'f1-score': 0.3777206320337069, 'support': 177919}, 'weighted avg': {'precision': 0.3822004754277595, 'recall': 0.3797177367228908, 'f1-score': 0.3803304201467228, 'support': 177919}}
[[18945 17873 17114]
 [20348 26977 21799]
 [15107 18119 21637]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0860614
{'0': {'precision': 0.40320206109679796, 'recall': 0.35783112853176546, 'f1-score': 0.3791641429436705, 'support': 24492}, '1': {'precision': 0.3730600539811066, 'recall': 0.37282420870737976, 'f1-score': 0.3729420940576319, 'support': 23727}, '2': {'precision': 0.3883824304980035, 'recall': 0.4336487907465825, 'f1-score': 0.4097692812146023, 'support': 23775}, 'accuracy': 0.38781009528571825, 'macro avg': {'precision': 0.3882148485253027, 'recall': 0.3881013759952426, 'f1-score': 0.38729183940530154, 'support': 71994}, 'weighted avg': {'precision': 0.3883742126605345, 'recall': 0.38781009528571825, 'f1-score': 0.3872204616434561, 'support': 71994}}
[[ 8764  7683  8045]
 [ 6690  8846  8191]
 [ 6282  7183 10310]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0954516
{'0': {'precision': 0.39102681014043406, 'recall': 0.3368421052631579, 'f1-score': 0.36191762322754895, 'support': 6365}, '1': {'precision': 0.3347487615003539, 'recall': 0.33870390261367705, 'f1-score': 0.3367147179213383, 'support': 5586}, '2': {'precision': 0.39169944391699446, 'recall': 0.44044532560622235, 'f1-score': 0.4146446518305815, 'support': 6557}, 'accuracy': 0.37410849362437865, 'macro avg': {'precision': 0.37249167185259413, 'recall': 0.37199711116101913, 'f1-score': 0.37109233099315625, 'support': 18508}, 'weighted avg': {'precision': 0.37427952680184634, 'recall': 0.37410849362437865, 'f1-score': 0.3729910886214106, 'support': 18508}}
[[2144 1864 2357]
 [1566 1892 2128]
 [1773 1896 2888]]
training model: results/LILAK/W7/deepOF_L1/h50
Epoch 1/50
282/282 - 9s - loss: 3.3336 - accuracy50: 0.3412 - val_loss: 3.3220 - val_accuracy50: 0.3540 - 9s/epoch - 32ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3105 - accuracy50: 0.3474 - val_loss: 3.3096 - val_accuracy50: 0.3578 - 7s/epoch - 24ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3007 - accuracy50: 0.3509 - val_loss: 3.3014 - val_accuracy50: 0.3590 - 7s/epoch - 24ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2942 - accuracy50: 0.3583 - val_loss: 3.2995 - val_accuracy50: 0.3620 - 7s/epoch - 24ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2902 - accuracy50: 0.3561 - val_loss: 3.2993 - val_accuracy50: 0.3629 - 7s/epoch - 25ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2883 - accuracy50: 0.3590 - val_loss: 3.2987 - val_accuracy50: 0.3636 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2838 - accuracy50: 0.3659 - val_loss: 3.3008 - val_accuracy50: 0.3638 - 7s/epoch - 24ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2797 - accuracy50: 0.3690 - val_loss: 3.2994 - val_accuracy50: 0.3622 - 7s/epoch - 25ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2770 - accuracy50: 0.3698 - val_loss: 3.2986 - val_accuracy50: 0.3649 - 7s/epoch - 25ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2758 - accuracy50: 0.3715 - val_loss: 3.2982 - val_accuracy50: 0.3644 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2721 - accuracy50: 0.3754 - val_loss: 3.2928 - val_accuracy50: 0.3656 - 7s/epoch - 24ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2697 - accuracy50: 0.3741 - val_loss: 3.2971 - val_accuracy50: 0.3640 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2700 - accuracy50: 0.3728 - val_loss: 3.2963 - val_accuracy50: 0.3672 - 7s/epoch - 25ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2667 - accuracy50: 0.3775 - val_loss: 3.3025 - val_accuracy50: 0.3627 - 7s/epoch - 24ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2642 - accuracy50: 0.3815 - val_loss: 3.2973 - val_accuracy50: 0.3649 - 7s/epoch - 24ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2625 - accuracy50: 0.3814 - val_loss: 3.3009 - val_accuracy50: 0.3649 - 7s/epoch - 24ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2614 - accuracy50: 0.3798 - val_loss: 3.3015 - val_accuracy50: 0.3657 - 7s/epoch - 24ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2599 - accuracy50: 0.3822 - val_loss: 3.3045 - val_accuracy50: 0.3623 - 7s/epoch - 24ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2557 - accuracy50: 0.3846 - val_loss: 3.3079 - val_accuracy50: 0.3612 - 7s/epoch - 24ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2551 - accuracy50: 0.3859 - val_loss: 3.3104 - val_accuracy50: 0.3592 - 7s/epoch - 25ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2529 - accuracy50: 0.3849 - val_loss: 3.3065 - val_accuracy50: 0.3629 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepOF_L1/h50
Evaluating performance on  test set...
695/695 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026884
{'0': {'precision': 0.32518441390840164, 'recall': 0.41061442168808565, 'f1-score': 0.36293998739678046, 'support': 54002}, '1': {'precision': 0.40951886241153174, 'recall': 0.0922359203849135, 'f1-score': 0.15056099307710671, 'support': 68379}, '2': {'precision': 0.3318279638287271, 'recall': 0.5635960963664518, 'f1-score': 0.4177170424443006, 'support': 55538}, 'accuracy': 0.33600683457078784, 'macro avg': {'precision': 0.3555104133828868, 'recall': 0.35548214614648366, 'f1-score': 0.3104060076393959, 'support': 177919}, 'weighted avg': {'precision': 0.3596701896247139, 'recall': 0.33600683457078784, 'f1-score': 0.2984159333645759, 'support': 177919}}
[[22174  4278 27550]
 [26594  6307 35478]
 [19421  4816 31301]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0928868
{'0': {'precision': 0.38401882861331893, 'recall': 0.4045606048288757, 'f1-score': 0.3940221694378464, 'support': 24602}, '1': {'precision': 0.3804018717313515, 'recall': 0.11561950974650716, 'f1-score': 0.17733863723854743, 'support': 23906}, '2': {'precision': 0.3545735635145581, 'recall': 0.5859235289108405, 'f1-score': 0.4417940156671376, 'support': 23486}, 'accuracy': 0.3677806483873656, 'macro avg': {'precision': 0.37299808795307615, 'recall': 0.3687012144954078, 'f1-score': 0.33771827411451044, 'support': 71994}, 'weighted avg': {'precision': 0.3732121160076878, 'recall': 0.3677806483873656, 'f1-score': 0.3376554313733506, 'support': 71994}}
[[ 9953  2295 12354]
 [ 8447  2764 12695]
 [ 7518  2207 13761]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0973178
{'0': {'precision': 0.37587301587301586, 'recall': 0.37350157728706623, 'f1-score': 0.3746835443037974, 'support': 6340}, '1': {'precision': 0.3385012919896641, 'recall': 0.11605244507441531, 'f1-score': 0.17284602190262568, 'support': 5644}, '2': {'precision': 0.375547551834907, 'recall': 0.5913549969343961, 'f1-score': 0.4593677442400429, 'support': 6524}, 'accuracy': 0.37178517397882, 'macro avg': {'precision': 0.36330728656586236, 'recall': 0.3603030064319592, 'f1-score': 0.33563243681548866, 'support': 18508}, 'weighted avg': {'precision': 0.36436181331291967, 'recall': 0.37178517397882, 'f1-score': 0.3429842112560263, 'support': 18508}}
[[2368  613 3359]
 [1933  655 3056]
 [1999  667 3858]]
training model: results/LILAK/W7/deepOF_L1/h100
Epoch 1/50
282/282 - 9s - loss: 3.3233 - accuracy100: 0.3535 - val_loss: 3.3103 - val_accuracy100: 0.3654 - 9s/epoch - 32ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3000 - accuracy100: 0.3635 - val_loss: 3.3045 - val_accuracy100: 0.3691 - 7s/epoch - 24ms/step
Epoch 3/50
282/282 - 7s - loss: 3.2952 - accuracy100: 0.3624 - val_loss: 3.2973 - val_accuracy100: 0.3673 - 7s/epoch - 24ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2883 - accuracy100: 0.3646 - val_loss: 3.2864 - val_accuracy100: 0.3748 - 7s/epoch - 24ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2847 - accuracy100: 0.3694 - val_loss: 3.2869 - val_accuracy100: 0.3755 - 7s/epoch - 24ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2805 - accuracy100: 0.3677 - val_loss: 3.2904 - val_accuracy100: 0.3703 - 7s/epoch - 24ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2790 - accuracy100: 0.3683 - val_loss: 3.2927 - val_accuracy100: 0.3710 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2757 - accuracy100: 0.3714 - val_loss: 3.2886 - val_accuracy100: 0.3768 - 7s/epoch - 24ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2734 - accuracy100: 0.3739 - val_loss: 3.2889 - val_accuracy100: 0.3746 - 7s/epoch - 24ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2732 - accuracy100: 0.3712 - val_loss: 3.2918 - val_accuracy100: 0.3694 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2708 - accuracy100: 0.3746 - val_loss: 3.2828 - val_accuracy100: 0.3781 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2680 - accuracy100: 0.3777 - val_loss: 3.2884 - val_accuracy100: 0.3758 - 7s/epoch - 24ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2678 - accuracy100: 0.3767 - val_loss: 3.2902 - val_accuracy100: 0.3757 - 7s/epoch - 24ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2656 - accuracy100: 0.3778 - val_loss: 3.2853 - val_accuracy100: 0.3769 - 7s/epoch - 25ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2626 - accuracy100: 0.3791 - val_loss: 3.2903 - val_accuracy100: 0.3774 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2613 - accuracy100: 0.3823 - val_loss: 3.2864 - val_accuracy100: 0.3743 - 7s/epoch - 25ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2574 - accuracy100: 0.3839 - val_loss: 3.2942 - val_accuracy100: 0.3719 - 7s/epoch - 25ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2560 - accuracy100: 0.3855 - val_loss: 3.2915 - val_accuracy100: 0.3742 - 7s/epoch - 25ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2542 - accuracy100: 0.3869 - val_loss: 3.2973 - val_accuracy100: 0.3724 - 7s/epoch - 25ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2500 - accuracy100: 0.3894 - val_loss: 3.2921 - val_accuracy100: 0.3759 - 7s/epoch - 25ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2489 - accuracy100: 0.3887 - val_loss: 3.2947 - val_accuracy100: 0.3715 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepOF_L1/h100
Evaluating performance on  test set...
695/695 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1238649
{'0': {'precision': 0.31193087404453307, 'recall': 0.35391489602383064, 'f1-score': 0.33159926162107733, 'support': 53041}, '1': {'precision': 0.41952344350499615, 'recall': 0.038243784859441125, 'f1-score': 0.07009747890525667, 'support': 71358}, '2': {'precision': 0.3132495460021216, 'recall': 0.6510463378176383, 'f1-score': 0.42298214307391624, 'support': 53520}, 'accuracy': 0.31668905513182966, 'macro avg': {'precision': 0.3482346211838836, 'recall': 0.3477350062336367, 'f1-score': 0.2748929612000834, 'support': 177919}, 'weighted avg': {'precision': 0.3554797130933692, 'recall': 0.31668905513182966, 'f1-score': 0.2542076823311781, 'support': 177919}}
[[18772  1697 32572]
 [24811  2729 43818]
 [16597  2079 34844]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.100864
{'0': {'precision': 0.3777562001861067, 'recall': 0.378921310011769, 'f1-score': 0.378337858097978, 'support': 24641}, '1': {'precision': 0.3803372016641121, 'recall': 0.07286685124590989, 'f1-score': 0.12230241154726282, 'support': 23838}, '2': {'precision': 0.3490283306017326, 'recall': 0.6339357856687221, 'f1-score': 0.45019252548131367, 'support': 23515}, 'accuracy': 0.3608772953301664, 'macro avg': {'precision': 0.3690405774839838, 'recall': 0.36190798230880034, 'f1-score': 0.3169442650421848, 'support': 71994}, 'weighted avg': {'precision': 0.3692275736332848, 'recall': 0.3608772953301664, 'f1-score': 0.3170312148866436, 'support': 71994}}
[[ 9337  1460 13844]
 [ 8142  1737 13959]
 [ 7238  1370 14907]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0952964
{'0': {'precision': 0.3784, 'recall': 0.36068323928625895, 'f1-score': 0.3693292730537987, 'support': 6557}, '1': {'precision': 0.2825278810408922, 'recall': 0.05876667311038082, 'f1-score': 0.09729556729076652, 'support': 5173}, '2': {'precision': 0.38231085673403686, 'recall': 0.6307170256712895, 'f1-score': 0.4760579064587974, 'support': 6778}, 'accuracy': 0.3751891074130106, 'macro avg': {'precision': 0.34774624592497644, 'recall': 0.3500556460226431, 'f1-score': 0.3142275822677875, 'support': 18508}, 'weighted avg': {'precision': 0.3530359042342682, 'recall': 0.3751891074130106, 'f1-score': 0.33238180802823764, 'support': 18508}}
[[2365  382 3810]
 [1772  304 3097]
 [2113  390 4275]]
training model: results/LILAK/W7/deepOF_L1/h200
Epoch 1/50
282/282 - 9s - loss: 3.3327 - accuracy200: 0.3414 - val_loss: 3.3358 - val_accuracy200: 0.3356 - 9s/epoch - 34ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3106 - accuracy200: 0.3469 - val_loss: 3.3216 - val_accuracy200: 0.3453 - 7s/epoch - 26ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3043 - accuracy200: 0.3523 - val_loss: 3.3146 - val_accuracy200: 0.3480 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2964 - accuracy200: 0.3543 - val_loss: 3.3169 - val_accuracy200: 0.3466 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2926 - accuracy200: 0.3556 - val_loss: 3.3119 - val_accuracy200: 0.3493 - 7s/epoch - 26ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2895 - accuracy200: 0.3600 - val_loss: 3.3131 - val_accuracy200: 0.3436 - 7s/epoch - 26ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2861 - accuracy200: 0.3628 - val_loss: 3.3099 - val_accuracy200: 0.3496 - 7s/epoch - 26ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2833 - accuracy200: 0.3643 - val_loss: 3.3103 - val_accuracy200: 0.3508 - 7s/epoch - 26ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2807 - accuracy200: 0.3651 - val_loss: 3.3087 - val_accuracy200: 0.3508 - 7s/epoch - 26ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2795 - accuracy200: 0.3650 - val_loss: 3.3092 - val_accuracy200: 0.3530 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2765 - accuracy200: 0.3696 - val_loss: 3.3084 - val_accuracy200: 0.3507 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2746 - accuracy200: 0.3716 - val_loss: 3.3082 - val_accuracy200: 0.3496 - 7s/epoch - 26ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2718 - accuracy200: 0.3753 - val_loss: 3.3094 - val_accuracy200: 0.3489 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2688 - accuracy200: 0.3769 - val_loss: 3.3067 - val_accuracy200: 0.3510 - 7s/epoch - 26ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2690 - accuracy200: 0.3740 - val_loss: 3.3089 - val_accuracy200: 0.3513 - 7s/epoch - 26ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2680 - accuracy200: 0.3763 - val_loss: 3.3077 - val_accuracy200: 0.3538 - 7s/epoch - 26ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2659 - accuracy200: 0.3763 - val_loss: 3.3099 - val_accuracy200: 0.3532 - 7s/epoch - 26ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2630 - accuracy200: 0.3777 - val_loss: 3.3128 - val_accuracy200: 0.3531 - 7s/epoch - 26ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2602 - accuracy200: 0.3838 - val_loss: 3.3151 - val_accuracy200: 0.3466 - 7s/epoch - 25ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2594 - accuracy200: 0.3826 - val_loss: 3.3183 - val_accuracy200: 0.3523 - 7s/epoch - 26ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2568 - accuracy200: 0.3853 - val_loss: 3.3141 - val_accuracy200: 0.3549 - 7s/epoch - 26ms/step
Epoch 22/50
282/282 - 7s - loss: 3.2541 - accuracy200: 0.3859 - val_loss: 3.3187 - val_accuracy200: 0.3513 - 7s/epoch - 26ms/step
Epoch 23/50
282/282 - 7s - loss: 3.2524 - accuracy200: 0.3873 - val_loss: 3.3165 - val_accuracy200: 0.3508 - 7s/epoch - 25ms/step
Epoch 24/50
282/282 - 7s - loss: 3.2485 - accuracy200: 0.3905 - val_loss: 3.3233 - val_accuracy200: 0.3476 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepOF_L1/h200
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1027181
{'0': {'precision': 0.33188812679910445, 'recall': 0.16507291206363234, 'f1-score': 0.22048303704228342, 'support': 56575}, '1': {'precision': 0.34970401691331926, 'recall': 0.2677317017901654, 'f1-score': 0.30327643424212974, 'support': 61782}, '2': {'precision': 0.3406030444964871, 'recall': 0.5860280044323563, 'f1-score': 0.43081423334691, 'support': 59562}, 'accuracy': 0.34164423136371047, 'macro avg': {'precision': 0.3407317294029703, 'recall': 0.3396108727620513, 'f1-score': 0.3181912348771077, 'support': 177919}, 'weighted avg': {'precision': 0.3409921530747014, 'recall': 0.34164423136371047, 'f1-score': 0.3196455119892934, 'support': 177919}}
[[ 9339 15243 31993]
 [ 9659 16541 35582]
 [ 9141 15516 34905]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0956022
{'0': {'precision': 0.4034132171387073, 'recall': 0.18050365556458164, 'f1-score': 0.24941070827253342, 'support': 24620}, '1': {'precision': 0.36594168030025986, 'recall': 0.31902844198338787, 'f1-score': 0.34087852980726135, 'support': 23838}, '2': {'precision': 0.35110458752114637, 'recall': 0.5996346023113528, 'f1-score': 0.44288583443168267, 'support': 23536}, 'accuracy': 0.36339139372725504, 'macro avg': {'precision': 0.37348649498670455, 'recall': 0.36638889995310747, 'f1-score': 0.34439169083715915, 'support': 71994}, 'weighted avg': {'precision': 0.37390544702128325, 'recall': 0.36339139372725504, 'f1-score': 0.34294684321470337, 'support': 71994}}
[[ 4444  6945 13231]
 [ 3381  7605 12852]
 [ 3191  6232 14113]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1033092
{'0': {'precision': 0.3628620102214651, 'recall': 0.16755821271239774, 'f1-score': 0.22925411688731032, 'support': 6356}, '1': {'precision': 0.3225194460254221, 'recall': 0.2972547648190243, 'f1-score': 0.3093721565059145, 'support': 5719}, '2': {'precision': 0.3659483595418365, 'recall': 0.5860407274988342, 'f1-score': 0.45055273379145505, 'support': 6433}, 'accuracy': 0.35309055543548734, 'macro avg': {'precision': 0.35044327192957453, 'recall': 0.35028456834341876, 'f1-score': 0.32972633572822657, 'support': 18508}, 'weighted avg': {'precision': 0.3514688483747383, 'recall': 0.35309055543548734, 'f1-score': 0.33092955837872806, 'support': 18508}}
[[1065 1865 3426]
 [ 913 1700 3106]
 [ 957 1706 3770]]
training model: results/LILAK/W7/deepOF_L1/h300
Epoch 1/50
282/282 - 9s - loss: 3.3309 - accuracy300: 0.3429 - val_loss: 3.3327 - val_accuracy300: 0.3421 - 9s/epoch - 31ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3133 - accuracy300: 0.3443 - val_loss: 3.3216 - val_accuracy300: 0.3482 - 7s/epoch - 24ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3053 - accuracy300: 0.3468 - val_loss: 3.3216 - val_accuracy300: 0.3496 - 7s/epoch - 24ms/step
Epoch 4/50
282/282 - 7s - loss: 3.2998 - accuracy300: 0.3483 - val_loss: 3.3193 - val_accuracy300: 0.3446 - 7s/epoch - 24ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2966 - accuracy300: 0.3509 - val_loss: 3.3134 - val_accuracy300: 0.3443 - 7s/epoch - 24ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2944 - accuracy300: 0.3522 - val_loss: 3.3109 - val_accuracy300: 0.3457 - 7s/epoch - 24ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2894 - accuracy300: 0.3584 - val_loss: 3.3087 - val_accuracy300: 0.3486 - 7s/epoch - 24ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2882 - accuracy300: 0.3577 - val_loss: 3.3082 - val_accuracy300: 0.3519 - 7s/epoch - 24ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2849 - accuracy300: 0.3600 - val_loss: 3.3097 - val_accuracy300: 0.3510 - 7s/epoch - 24ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2852 - accuracy300: 0.3604 - val_loss: 3.3117 - val_accuracy300: 0.3476 - 7s/epoch - 24ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2811 - accuracy300: 0.3637 - val_loss: 3.3117 - val_accuracy300: 0.3495 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2789 - accuracy300: 0.3666 - val_loss: 3.3069 - val_accuracy300: 0.3514 - 7s/epoch - 25ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2779 - accuracy300: 0.3650 - val_loss: 3.3125 - val_accuracy300: 0.3494 - 7s/epoch - 25ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2771 - accuracy300: 0.3675 - val_loss: 3.3114 - val_accuracy300: 0.3461 - 7s/epoch - 25ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2740 - accuracy300: 0.3698 - val_loss: 3.3098 - val_accuracy300: 0.3471 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2747 - accuracy300: 0.3691 - val_loss: 3.3131 - val_accuracy300: 0.3466 - 7s/epoch - 25ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2708 - accuracy300: 0.3717 - val_loss: 3.3079 - val_accuracy300: 0.3498 - 7s/epoch - 25ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2704 - accuracy300: 0.3722 - val_loss: 3.3171 - val_accuracy300: 0.3461 - 7s/epoch - 25ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2680 - accuracy300: 0.3756 - val_loss: 3.3167 - val_accuracy300: 0.3464 - 7s/epoch - 24ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2659 - accuracy300: 0.3771 - val_loss: 3.3163 - val_accuracy300: 0.3504 - 7s/epoch - 26ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2641 - accuracy300: 0.3784 - val_loss: 3.3150 - val_accuracy300: 0.3494 - 7s/epoch - 25ms/step
Epoch 22/50
282/282 - 7s - loss: 3.2635 - accuracy300: 0.3797 - val_loss: 3.3230 - val_accuracy300: 0.3436 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepOF_L1/h300
Evaluating performance on  test set...
695/695 - 10s - 10s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035267
{'0': {'precision': 0.3064858622359647, 'recall': 0.15520884428177942, 'f1-score': 0.20606394569750403, 'support': 53006}, '1': {'precision': 0.38977331083559535, 'recall': 0.1549905920448081, 'f1-score': 0.22178854322121455, 'support': 68559}, '2': {'precision': 0.31985074385772205, 'recall': 0.7027362742662455, 'f1-score': 0.43961191776564096, 'support': 56354}, 'accuracy': 0.3285483843771604, 'macro avg': {'precision': 0.338703305643094, 'recall': 0.3376452368642777, 'f1-score': 0.28915480222811984, 'support': 177919}, 'weighted avg': {'precision': 0.3428128915439902, 'recall': 0.3285483843771604, 'f1-score': 0.2860971355173426, 'support': 177919}}
[[ 8227  8098 36681]
 [10402 10626 47531]
 [ 8214  8538 39602]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0963645
{'0': {'precision': 0.3900564312122981, 'recall': 0.1630934461576014, 'f1-score': 0.2300123354083594, 'support': 24581}, '1': {'precision': 0.37129680293910733, 'recall': 0.19894454682526386, 'f1-score': 0.2590744225367476, 'support': 23876}, '2': {'precision': 0.3445618625186518, 'recall': 0.7161915282321452, 'f1-score': 0.46527739442451016, 'support': 23537}, 'accuracy': 0.35580742839681084, 'macro avg': {'precision': 0.3686383655566858, 'recall': 0.35940984040500346, 'f1-score': 0.31812138412320573, 'support': 71994}, 'weighted avg': {'precision': 0.3689614712435083, 'recall': 0.35580742839681084, 'f1-score': 0.31656566049573526, 'support': 71994}}
[[ 4009  4349 16223]
 [ 3283  4750 15843]
 [ 2986  3694 16857]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1033375
{'0': {'precision': 0.36439752457226066, 'recall': 0.1590909090909091, 'f1-score': 0.22148467750857395, 'support': 6292}, '1': {'precision': 0.3060509554140127, 'recall': 0.16520543235344679, 'f1-score': 0.21458077481299542, 'support': 5817}, '2': {'precision': 0.35314158941446794, 'recall': 0.6965150804813252, 'f1-score': 0.46866456361724496, 'support': 6399}, 'accuracy': 0.3468229954614221, 'macro avg': {'precision': 0.34119668980024703, 'recall': 0.340270473975227, 'f1-score': 0.30157667197960475, 'support': 18508}, 'weighted avg': {'precision': 0.3421677470777586, 'recall': 0.3468229954614221, 'f1-score': 0.30477536743883143, 'support': 18508}}
[[1001 1127 4164]
 [ 856  961 4000]
 [ 890 1052 4457]]
training model: results/LILAK/W7/deepOF_L1/h500
Epoch 1/50
282/282 - 9s - loss: 3.3352 - accuracy500: 0.3403 - val_loss: 3.3286 - val_accuracy500: 0.3427 - 9s/epoch - 33ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3195 - accuracy500: 0.3408 - val_loss: 3.3234 - val_accuracy500: 0.3404 - 7s/epoch - 25ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3110 - accuracy500: 0.3442 - val_loss: 3.3144 - val_accuracy500: 0.3481 - 7s/epoch - 25ms/step
Epoch 4/50
282/282 - 7s - loss: 3.3048 - accuracy500: 0.3471 - val_loss: 3.3116 - val_accuracy500: 0.3466 - 7s/epoch - 26ms/step
Epoch 5/50
282/282 - 7s - loss: 3.2996 - accuracy500: 0.3524 - val_loss: 3.3139 - val_accuracy500: 0.3433 - 7s/epoch - 25ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2977 - accuracy500: 0.3511 - val_loss: 3.3116 - val_accuracy500: 0.3443 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2949 - accuracy500: 0.3544 - val_loss: 3.3118 - val_accuracy500: 0.3475 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2909 - accuracy500: 0.3556 - val_loss: 3.3115 - val_accuracy500: 0.3446 - 7s/epoch - 25ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2895 - accuracy500: 0.3580 - val_loss: 3.3094 - val_accuracy500: 0.3507 - 7s/epoch - 25ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2877 - accuracy500: 0.3602 - val_loss: 3.3125 - val_accuracy500: 0.3465 - 7s/epoch - 25ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2857 - accuracy500: 0.3598 - val_loss: 3.3102 - val_accuracy500: 0.3478 - 7s/epoch - 26ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2840 - accuracy500: 0.3622 - val_loss: 3.3079 - val_accuracy500: 0.3481 - 7s/epoch - 26ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2817 - accuracy500: 0.3624 - val_loss: 3.3085 - val_accuracy500: 0.3435 - 7s/epoch - 26ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2812 - accuracy500: 0.3635 - val_loss: 3.3070 - val_accuracy500: 0.3458 - 7s/epoch - 25ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2793 - accuracy500: 0.3656 - val_loss: 3.3133 - val_accuracy500: 0.3481 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2792 - accuracy500: 0.3657 - val_loss: 3.3106 - val_accuracy500: 0.3462 - 7s/epoch - 25ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2763 - accuracy500: 0.3669 - val_loss: 3.3118 - val_accuracy500: 0.3440 - 7s/epoch - 25ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2750 - accuracy500: 0.3679 - val_loss: 3.3122 - val_accuracy500: 0.3464 - 7s/epoch - 26ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2730 - accuracy500: 0.3698 - val_loss: 3.3113 - val_accuracy500: 0.3482 - 7s/epoch - 26ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2727 - accuracy500: 0.3700 - val_loss: 3.3145 - val_accuracy500: 0.3456 - 7s/epoch - 25ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2695 - accuracy500: 0.3746 - val_loss: 3.3173 - val_accuracy500: 0.3433 - 7s/epoch - 25ms/step
Epoch 22/50
282/282 - 7s - loss: 3.2679 - accuracy500: 0.3741 - val_loss: 3.3181 - val_accuracy500: 0.3439 - 7s/epoch - 25ms/step
Epoch 23/50
282/282 - 7s - loss: 3.2678 - accuracy500: 0.3764 - val_loss: 3.3137 - val_accuracy500: 0.3485 - 7s/epoch - 25ms/step
Epoch 24/50
282/282 - 7s - loss: 3.2647 - accuracy500: 0.3775 - val_loss: 3.3175 - val_accuracy500: 0.3463 - 7s/epoch - 24ms/step
testing model: results/LILAK/W7/deepOF_L1/h500
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1011505
{'0': {'precision': 0.283388124101089, 'recall': 0.11125899933450299, 'f1-score': 0.1597856780826877, 'support': 49587}, '1': {'precision': 0.4062884636902764, 'recall': 0.2539977894987199, 'f1-score': 0.31258070625505757, 'support': 71477}, '2': {'precision': 0.3211152716980469, 'recall': 0.6425468296543839, 'f1-score': 0.42822395836385907, 'support': 56855}, 'accuracy': 0.33837870041985396, 'macro avg': {'precision': 0.3369306198298041, 'recall': 0.335934539495869, 'f1-score': 0.30019678090053475, 'support': 177919}, 'weighted avg': {'precision': 0.3448179014123452, 'recall': 0.33837870041985396, 'f1-score': 0.30695033533718263, 'support': 177919}}
[[ 5517 12527 31543]
 [ 7631 18155 45691]
 [ 6320 14003 36532]]
Evaluating performance on  train set...
282/282 - 4s - 4s/epoch - 16ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09807
{'0': {'precision': 0.4006282469493778, 'recall': 0.13507128309572303, 'f1-score': 0.2020288177414933, 'support': 24550}, '1': {'precision': 0.3620511706230648, 'recall': 0.27478870336013195, 'f1-score': 0.31244140258766173, 'support': 24255}, '2': {'precision': 0.3382625584885671, 'recall': 0.660916814006641, 'f1-score': 0.44749405083434307, 'support': 23189}, 'accuracy': 0.35151540406144954, 'macro avg': {'precision': 0.36698065868700325, 'recall': 0.35692560015416536, 'f1-score': 0.32065475705449936, 'support': 71994}, 'weighted avg': {'precision': 0.3675437546859606, 'recall': 0.35151540406144954, 'f1-score': 0.31829059699579104, 'support': 71994}}
[[ 3316  6237 14997]
 [ 2605  6665 14985]
 [ 2356  5507 15326]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1024791
{'0': {'precision': 0.31675392670157065, 'recall': 0.1225523295070898, 'f1-score': 0.17672833495618306, 'support': 5924}, '1': {'precision': 0.3520203088639729, 'recall': 0.26735218508997427, 'f1-score': 0.3038991872888321, 'support': 6224}, '2': {'precision': 0.35172773957698666, 'recall': 0.6353773584905661, 'f1-score': 0.4527984761051039, 'support': 6360}, 'accuracy': 0.34747136373460125, 'macro avg': {'precision': 0.34016732504751007, 'recall': 0.34176062436254345, 'f1-score': 0.3111419994500397, 'support': 18508}, 'weighted avg': {'precision': 0.34063178559861185, 'recall': 0.34747136373460125, 'f1-score': 0.31436165474360167, 'support': 18508}}
[[ 726 1515 3683]
 [ 795 1664 3765]
 [ 771 1548 4041]]
training model: results/LILAK/W7/deepOF_L1/h1000
Epoch 1/50
282/282 - 9s - loss: 3.3356 - accuracy1000: 0.3425 - val_loss: 3.3359 - val_accuracy1000: 0.3441 - 9s/epoch - 32ms/step
Epoch 2/50
282/282 - 7s - loss: 3.3241 - accuracy1000: 0.3446 - val_loss: 3.3221 - val_accuracy1000: 0.3545 - 7s/epoch - 25ms/step
Epoch 3/50
282/282 - 7s - loss: 3.3161 - accuracy1000: 0.3451 - val_loss: 3.3144 - val_accuracy1000: 0.3490 - 7s/epoch - 26ms/step
Epoch 4/50
282/282 - 7s - loss: 3.3079 - accuracy1000: 0.3502 - val_loss: 3.3124 - val_accuracy1000: 0.3476 - 7s/epoch - 25ms/step
Epoch 5/50
282/282 - 7s - loss: 3.3030 - accuracy1000: 0.3535 - val_loss: 3.3124 - val_accuracy1000: 0.3481 - 7s/epoch - 25ms/step
Epoch 6/50
282/282 - 7s - loss: 3.2989 - accuracy1000: 0.3547 - val_loss: 3.3137 - val_accuracy1000: 0.3436 - 7s/epoch - 25ms/step
Epoch 7/50
282/282 - 7s - loss: 3.2959 - accuracy1000: 0.3586 - val_loss: 3.3115 - val_accuracy1000: 0.3460 - 7s/epoch - 25ms/step
Epoch 8/50
282/282 - 7s - loss: 3.2924 - accuracy1000: 0.3579 - val_loss: 3.3120 - val_accuracy1000: 0.3434 - 7s/epoch - 25ms/step
Epoch 9/50
282/282 - 7s - loss: 3.2907 - accuracy1000: 0.3607 - val_loss: 3.3108 - val_accuracy1000: 0.3491 - 7s/epoch - 25ms/step
Epoch 10/50
282/282 - 7s - loss: 3.2888 - accuracy1000: 0.3617 - val_loss: 3.3107 - val_accuracy1000: 0.3467 - 7s/epoch - 26ms/step
Epoch 11/50
282/282 - 7s - loss: 3.2869 - accuracy1000: 0.3607 - val_loss: 3.3082 - val_accuracy1000: 0.3489 - 7s/epoch - 25ms/step
Epoch 12/50
282/282 - 7s - loss: 3.2841 - accuracy1000: 0.3653 - val_loss: 3.3147 - val_accuracy1000: 0.3459 - 7s/epoch - 24ms/step
Epoch 13/50
282/282 - 7s - loss: 3.2822 - accuracy1000: 0.3674 - val_loss: 3.3109 - val_accuracy1000: 0.3467 - 7s/epoch - 24ms/step
Epoch 14/50
282/282 - 7s - loss: 3.2789 - accuracy1000: 0.3696 - val_loss: 3.3143 - val_accuracy1000: 0.3444 - 7s/epoch - 24ms/step
Epoch 15/50
282/282 - 7s - loss: 3.2780 - accuracy1000: 0.3716 - val_loss: 3.3146 - val_accuracy1000: 0.3481 - 7s/epoch - 25ms/step
Epoch 16/50
282/282 - 7s - loss: 3.2767 - accuracy1000: 0.3707 - val_loss: 3.3151 - val_accuracy1000: 0.3457 - 7s/epoch - 25ms/step
Epoch 17/50
282/282 - 7s - loss: 3.2757 - accuracy1000: 0.3724 - val_loss: 3.3178 - val_accuracy1000: 0.3491 - 7s/epoch - 26ms/step
Epoch 18/50
282/282 - 7s - loss: 3.2738 - accuracy1000: 0.3736 - val_loss: 3.3187 - val_accuracy1000: 0.3461 - 7s/epoch - 25ms/step
Epoch 19/50
282/282 - 7s - loss: 3.2713 - accuracy1000: 0.3753 - val_loss: 3.3164 - val_accuracy1000: 0.3491 - 7s/epoch - 24ms/step
Epoch 20/50
282/282 - 7s - loss: 3.2698 - accuracy1000: 0.3773 - val_loss: 3.3183 - val_accuracy1000: 0.3466 - 7s/epoch - 25ms/step
Epoch 21/50
282/282 - 7s - loss: 3.2673 - accuracy1000: 0.3774 - val_loss: 3.3207 - val_accuracy1000: 0.3437 - 7s/epoch - 25ms/step
testing model: results/LILAK/W7/deepOF_L1/h1000
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0984687
{'0': {'precision': 0.2759297520661157, 'recall': 0.05301180907015977, 'f1-score': 0.08893698493298925, 'support': 50385}, '1': {'precision': 0.3870323497057661, 'recall': 0.525081140605077, 'f1-score': 0.44560987156391985, 'support': 69016}, '2': {'precision': 0.33435648607350615, 'recall': 0.4262790936122219, 'f1-score': 0.37476337850425173, 'support': 58518}, 'accuracy': 0.3588992743889073, 'macro avg': {'precision': 0.33243952928179604, 'recall': 0.3347906810958196, 'f1-score': 0.3031034116670536, 'support': 177919}, 'weighted avg': {'precision': 0.33824390906645063, 'recall': 0.3588992743889073, 'f1-score': 0.3213018523317687, 'support': 177919}}
[[ 2671 26997 20717]
 [ 3833 36239 28944]
 [ 3176 30397 24945]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1046118
{'0': {'precision': 0.4032828282828283, 'recall': 0.06451482588672537, 'f1-score': 0.11123493766107125, 'support': 24754}, '1': {'precision': 0.3538863976083707, 'recall': 0.5740553647201455, 'f1-score': 0.4378515835709332, 'support': 24745}, '2': {'precision': 0.3288520828852083, 'recall': 0.40777950655701267, 'f1-score': 0.36408740002778384, 'support': 22495}, 'accuracy': 0.3469039086590549, 'macro avg': {'precision': 0.36200710292546906, 'recall': 0.3487832323879612, 'f1-score': 0.30439130708659606, 'support': 71994}, 'weighted avg': {'precision': 0.3630484435457819, 'recall': 0.3469039086590549, 'f1-score': 0.3025015021522613, 'support': 71994}}
[[ 1597 13753  9404]
 [ 1223 14205  9317]
 [ 1140 12182  9173]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1030204
{'0': {'precision': 0.3541507996953541, 'recall': 0.08147888557911337, 'f1-score': 0.13247863247863248, 'support': 5707}, '1': {'precision': 0.357120822622108, 'recall': 0.5234363225320271, 'f1-score': 0.4245721271393643, 'support': 6635}, '2': {'precision': 0.33360107095046854, 'recall': 0.4041518001946156, 'f1-score': 0.3655030800821355, 'support': 6166}, 'accuracy': 0.34741733304516964, 'macro avg': {'precision': 0.3482908977559769, 'recall': 0.336355669435252, 'f1-score': 0.3075179465667108, 'support': 18508}, 'weighted avg': {'precision': 0.3483693254505976, 'recall': 0.34741733304516964, 'f1-score': 0.31482513566628945, 'support': 18508}}
[[ 465 2981 2261]
 [ 445 3473 2717]
 [ 403 3271 2492]]
training model: results/LILAK/W7/deepLOB_L2/h10
Epoch 1/50
282/282 - 17s - loss: 3.3564 - accuracy10: 0.3431 - val_loss: 3.4274 - val_accuracy10: 0.3380 - 17s/epoch - 59ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3147 - accuracy10: 0.3513 - val_loss: 3.3336 - val_accuracy10: 0.3430 - 14s/epoch - 49ms/step
Epoch 3/50
282/282 - 14s - loss: 3.2985 - accuracy10: 0.3558 - val_loss: 3.3333 - val_accuracy10: 0.3418 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2855 - accuracy10: 0.3706 - val_loss: 3.3171 - val_accuracy10: 0.3607 - 14s/epoch - 50ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2512 - accuracy10: 0.3917 - val_loss: 3.3289 - val_accuracy10: 0.3694 - 14s/epoch - 50ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2128 - accuracy10: 0.4145 - val_loss: 3.3777 - val_accuracy10: 0.3717 - 14s/epoch - 49ms/step
Epoch 7/50
282/282 - 14s - loss: 3.1810 - accuracy10: 0.4292 - val_loss: 3.4036 - val_accuracy10: 0.3706 - 14s/epoch - 50ms/step
Epoch 8/50
282/282 - 14s - loss: 3.1546 - accuracy10: 0.4436 - val_loss: 3.4709 - val_accuracy10: 0.3751 - 14s/epoch - 50ms/step
Epoch 9/50
282/282 - 14s - loss: 3.1278 - accuracy10: 0.4560 - val_loss: 3.3777 - val_accuracy10: 0.3948 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 14s - loss: 3.1091 - accuracy10: 0.4641 - val_loss: 3.3151 - val_accuracy10: 0.4084 - 14s/epoch - 51ms/step
Epoch 11/50
282/282 - 14s - loss: 3.0900 - accuracy10: 0.4706 - val_loss: 3.3725 - val_accuracy10: 0.4057 - 14s/epoch - 50ms/step
Epoch 12/50
282/282 - 14s - loss: 3.0747 - accuracy10: 0.4760 - val_loss: 3.2758 - val_accuracy10: 0.4224 - 14s/epoch - 50ms/step
Epoch 13/50
282/282 - 14s - loss: 3.0579 - accuracy10: 0.4827 - val_loss: 3.2997 - val_accuracy10: 0.4213 - 14s/epoch - 50ms/step
Epoch 14/50
282/282 - 14s - loss: 3.0421 - accuracy10: 0.4876 - val_loss: 3.3304 - val_accuracy10: 0.4091 - 14s/epoch - 50ms/step
Epoch 15/50
282/282 - 14s - loss: 3.0302 - accuracy10: 0.4904 - val_loss: 3.3152 - val_accuracy10: 0.4132 - 14s/epoch - 50ms/step
Epoch 16/50
282/282 - 14s - loss: 3.0157 - accuracy10: 0.4968 - val_loss: 3.3317 - val_accuracy10: 0.4104 - 14s/epoch - 51ms/step
Epoch 17/50
282/282 - 14s - loss: 3.0067 - accuracy10: 0.4992 - val_loss: 3.3398 - val_accuracy10: 0.4088 - 14s/epoch - 50ms/step
Epoch 18/50
282/282 - 14s - loss: 2.9933 - accuracy10: 0.5027 - val_loss: 3.3828 - val_accuracy10: 0.4065 - 14s/epoch - 50ms/step
Epoch 19/50
282/282 - 14s - loss: 2.9790 - accuracy10: 0.5088 - val_loss: 3.3611 - val_accuracy10: 0.4056 - 14s/epoch - 49ms/step
Epoch 20/50
282/282 - 14s - loss: 2.9719 - accuracy10: 0.5098 - val_loss: 3.3763 - val_accuracy10: 0.4021 - 14s/epoch - 51ms/step
Epoch 21/50
282/282 - 14s - loss: 2.9534 - accuracy10: 0.5153 - val_loss: 3.3309 - val_accuracy10: 0.4093 - 14s/epoch - 50ms/step
Epoch 22/50
282/282 - 14s - loss: 2.9407 - accuracy10: 0.5184 - val_loss: 3.3646 - val_accuracy10: 0.4043 - 14s/epoch - 50ms/step
testing model: results/LILAK/W7/deepLOB_L2/h10
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.053437
{'0': {'precision': 0.4053403451596178, 'recall': 0.41436359506322407, 'f1-score': 0.4098023064250412, 'support': 52828}, '1': {'precision': 0.48492424432774694, 'recall': 0.5306652735196667, 'f1-score': 0.5067646962287065, 'support': 72737}, '2': {'precision': 0.4337123776002888, 'recall': 0.367138409824481, 'f1-score': 0.39765827825529315, 'support': 52359}, 'accuracy': 0.4480115105325869, 'macro avg': {'precision': 0.4413256556958845, 'recall': 0.4373890928024573, 'f1-score': 0.4380750936363469, 'support': 177924}, 'weighted avg': {'precision': 0.4462242355867288, 'recall': 0.4480115105325869, 'f1-score': 0.4458677286064746, 'support': 177924}}
[[21890 19636 11302]
 [20341 38599 13797]
 [11773 21363 19223]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.049823
{'0': {'precision': 0.4628333562051141, 'recall': 0.433152104114046, 'f1-score': 0.44750110570544005, 'support': 23359}, '1': {'precision': 0.4327651515151515, 'recall': 0.5525351014040562, 'f1-score': 0.4853707002877895, 'support': 25640}, '2': {'precision': 0.4733605379619518, 'recall': 0.35813366960907944, 'f1-score': 0.4077631448658283, 'support': 22997}, 'accuracy': 0.4517056503139063, 'macro avg': {'precision': 0.45631968189407246, 'recall': 0.44794029170906047, 'f1-score': 0.4468783169530193, 'support': 71996}, 'weighted avg': {'precision': 0.45548773742922866, 'recall': 0.4517056503139063, 'f1-score': 0.4482945181125583, 'support': 71996}}
[[10118  9016  4225]
 [ 6535 14167  4938]
 [ 5208  9553  8236]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0875213
{'0': {'precision': 0.3990200764818356, 'recall': 0.5689214516953485, 'f1-score': 0.4690594928706891, 'support': 5869}, '1': {'precision': 0.42955271565495207, 'recall': 0.4174817574910728, 'f1-score': 0.42343122588772536, 'support': 6441}, '2': {'precision': 0.4639175257731959, 'recall': 0.2904162633107454, 'f1-score': 0.35721373288350866, 'support': 6198}, 'accuracy': 0.42295223687054245, 'macro avg': {'precision': 0.43083010596999455, 'recall': 0.4256064908323889, 'f1-score': 0.4165681505473077, 'support': 18508}, 'weighted avg': {'precision': 0.4313787926922254, 'recall': 0.42295223687054245, 'f1-score': 0.41572516782001845, 'support': 18508}}
[[3339 1567  963]
 [2635 2689 1117]
 [2394 2004 1800]]
training model: results/LILAK/W7/deepLOB_L2/h20
Epoch 1/50
282/282 - 17s - loss: 3.3589 - accuracy20: 0.3396 - val_loss: 3.3573 - val_accuracy20: 0.3376 - 17s/epoch - 59ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3200 - accuracy20: 0.3446 - val_loss: 3.3601 - val_accuracy20: 0.3317 - 14s/epoch - 51ms/step
Epoch 3/50
282/282 - 15s - loss: 3.3013 - accuracy20: 0.3542 - val_loss: 3.3240 - val_accuracy20: 0.3401 - 15s/epoch - 51ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2787 - accuracy20: 0.3751 - val_loss: 3.3322 - val_accuracy20: 0.3456 - 14s/epoch - 51ms/step
Epoch 5/50
282/282 - 15s - loss: 3.2572 - accuracy20: 0.3919 - val_loss: 3.3195 - val_accuracy20: 0.3527 - 15s/epoch - 53ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2377 - accuracy20: 0.4026 - val_loss: 3.3326 - val_accuracy20: 0.3671 - 14s/epoch - 50ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2237 - accuracy20: 0.4148 - val_loss: 3.3034 - val_accuracy20: 0.3719 - 14s/epoch - 51ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2006 - accuracy20: 0.4265 - val_loss: 3.3470 - val_accuracy20: 0.3696 - 14s/epoch - 51ms/step
Epoch 9/50
282/282 - 14s - loss: 3.1871 - accuracy20: 0.4317 - val_loss: 3.2885 - val_accuracy20: 0.3899 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 14s - loss: 3.1740 - accuracy20: 0.4382 - val_loss: 3.3590 - val_accuracy20: 0.3821 - 14s/epoch - 49ms/step
Epoch 11/50
282/282 - 14s - loss: 3.1607 - accuracy20: 0.4448 - val_loss: 3.3403 - val_accuracy20: 0.3908 - 14s/epoch - 49ms/step
Epoch 12/50
282/282 - 14s - loss: 3.1489 - accuracy20: 0.4501 - val_loss: 3.2938 - val_accuracy20: 0.4010 - 14s/epoch - 50ms/step
Epoch 13/50
282/282 - 14s - loss: 3.1348 - accuracy20: 0.4546 - val_loss: 3.3211 - val_accuracy20: 0.3960 - 14s/epoch - 50ms/step
Epoch 14/50
282/282 - 14s - loss: 3.1230 - accuracy20: 0.4604 - val_loss: 3.3166 - val_accuracy20: 0.3959 - 14s/epoch - 50ms/step
Epoch 15/50
282/282 - 14s - loss: 3.1151 - accuracy20: 0.4651 - val_loss: 3.2818 - val_accuracy20: 0.3956 - 14s/epoch - 50ms/step
Epoch 16/50
282/282 - 14s - loss: 3.1102 - accuracy20: 0.4666 - val_loss: 3.3100 - val_accuracy20: 0.3990 - 14s/epoch - 50ms/step
Epoch 17/50
282/282 - 14s - loss: 3.0953 - accuracy20: 0.4713 - val_loss: 3.3120 - val_accuracy20: 0.4016 - 14s/epoch - 50ms/step
Epoch 18/50
282/282 - 14s - loss: 3.0800 - accuracy20: 0.4754 - val_loss: 3.3153 - val_accuracy20: 0.4006 - 14s/epoch - 50ms/step
Epoch 19/50
282/282 - 13s - loss: 3.0711 - accuracy20: 0.4784 - val_loss: 3.3324 - val_accuracy20: 0.4035 - 13s/epoch - 48ms/step
Epoch 20/50
282/282 - 14s - loss: 3.0538 - accuracy20: 0.4845 - val_loss: 3.3860 - val_accuracy20: 0.3969 - 14s/epoch - 48ms/step
Epoch 21/50
282/282 - 14s - loss: 3.0479 - accuracy20: 0.4880 - val_loss: 3.3884 - val_accuracy20: 0.3962 - 14s/epoch - 48ms/step
Epoch 22/50
282/282 - 14s - loss: 3.0334 - accuracy20: 0.4912 - val_loss: 3.4108 - val_accuracy20: 0.3985 - 14s/epoch - 49ms/step
Epoch 23/50
282/282 - 14s - loss: 3.0265 - accuracy20: 0.4934 - val_loss: 3.4646 - val_accuracy20: 0.3809 - 14s/epoch - 49ms/step
Epoch 24/50
282/282 - 14s - loss: 3.0174 - accuracy20: 0.4976 - val_loss: 3.4276 - val_accuracy20: 0.3898 - 14s/epoch - 50ms/step
Epoch 25/50
282/282 - 14s - loss: 3.0025 - accuracy20: 0.5012 - val_loss: 3.4877 - val_accuracy20: 0.3898 - 14s/epoch - 49ms/step
testing model: results/LILAK/W7/deepLOB_L2/h20
Evaluating performance on  test set...
696/696 - 13s - 13s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0923989
{'0': {'precision': 0.3625547563679628, 'recall': 0.3675438596491228, 'f1-score': 0.36503226157741414, 'support': 54720}, '1': {'precision': 0.4153345047786397, 'recall': 0.28465266558966074, 'f1-score': 0.3377949736832932, 'support': 68090}, '2': {'precision': 0.37532493237448045, 'recall': 0.5160939144319048, 'f1-score': 0.43459461111238434, 'support': 55114}, 'accuracy': 0.38183718891211976, 'macro avg': {'precision': 0.3844047311736943, 'recall': 0.3894301465568961, 'f1-score': 0.3791406154576972, 'support': 177924}, 'weighted avg': {'precision': 0.38670882523841427, 'recall': 0.38183718891211976, 'f1-score': 0.3761565191231058, 'support': 177924}}
[[20112 13825 20783]
 [22150 19382 26558]
 [13211 13459 28444]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0817066
{'0': {'precision': 0.43822217137627273, 'recall': 0.31615219544404094, 'f1-score': 0.36731073500503425, 'support': 24232}, '1': {'precision': 0.38036469099996917, 'recall': 0.5115140450603709, 'f1-score': 0.4362967157417894, 'support': 24101}, '2': {'precision': 0.427272315975207, 'recall': 0.39910408654862023, 'f1-score': 0.4127081239347988, 'support': 23663}, 'accuracy': 0.4088143785765876, 'macro avg': {'precision': 0.41528639278381635, 'recall': 0.4089234423510107, 'f1-score': 0.4054385248938741, 'support': 71996}, 'weighted avg': {'precision': 0.4152552070601342, 'recall': 0.4088143785765876, 'f1-score': 0.405324923793044, 'support': 71996}}
[[ 7661 10392  6179]
 [ 5293 12328  6480]
 [ 4528  9691  9444]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0916944
{'0': {'precision': 0.4093119198467659, 'recall': 0.447992259313014, 'f1-score': 0.4277794887588543, 'support': 6201}, '1': {'precision': 0.36980373976201514, 'recall': 0.404838436812722, 'f1-score': 0.386528832175739, 'support': 5911}, '2': {'precision': 0.41904761904761906, 'recall': 0.3439649781113196, 'f1-score': 0.3778121243345355, 'support': 6396}, 'accuracy': 0.3982602118003026, 'macro avg': {'precision': 0.39938775955213335, 'recall': 0.39893189141235186, 'f1-score': 0.39737348175637627, 'support': 18508}, 'weighted avg': {'precision': 0.4000584445716252, 'recall': 0.3982602118003026, 'f1-score': 0.39733730732808176, 'support': 18508}}
[[2778 1951 1472]
 [1940 2393 1578]
 [2069 2127 2200]]
training model: results/LILAK/W7/deepLOB_L2/h30
Epoch 1/50
282/282 - 17s - loss: 3.3621 - accuracy30: 0.3369 - val_loss: 3.4138 - val_accuracy30: 0.3443 - 17s/epoch - 60ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3240 - accuracy30: 0.3456 - val_loss: 3.3624 - val_accuracy30: 0.3346 - 14s/epoch - 50ms/step
Epoch 3/50
282/282 - 14s - loss: 3.3090 - accuracy30: 0.3495 - val_loss: 3.3495 - val_accuracy30: 0.3522 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2981 - accuracy30: 0.3561 - val_loss: 3.3168 - val_accuracy30: 0.3504 - 14s/epoch - 50ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2869 - accuracy30: 0.3663 - val_loss: 3.3234 - val_accuracy30: 0.3493 - 14s/epoch - 49ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2761 - accuracy30: 0.3749 - val_loss: 3.3181 - val_accuracy30: 0.3648 - 14s/epoch - 49ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2585 - accuracy30: 0.3895 - val_loss: 3.3265 - val_accuracy30: 0.3577 - 14s/epoch - 50ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2447 - accuracy30: 0.3973 - val_loss: 3.3163 - val_accuracy30: 0.3694 - 14s/epoch - 49ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2324 - accuracy30: 0.4058 - val_loss: 3.3196 - val_accuracy30: 0.3637 - 14s/epoch - 49ms/step
Epoch 10/50
282/282 - 14s - loss: 3.2166 - accuracy30: 0.4160 - val_loss: 3.3120 - val_accuracy30: 0.3729 - 14s/epoch - 50ms/step
Epoch 11/50
282/282 - 14s - loss: 3.2067 - accuracy30: 0.4190 - val_loss: 3.3509 - val_accuracy30: 0.3666 - 14s/epoch - 49ms/step
Epoch 12/50
282/282 - 14s - loss: 3.1975 - accuracy30: 0.4249 - val_loss: 3.3186 - val_accuracy30: 0.3822 - 14s/epoch - 49ms/step
Epoch 13/50
282/282 - 14s - loss: 3.1847 - accuracy30: 0.4284 - val_loss: 3.3342 - val_accuracy30: 0.3746 - 14s/epoch - 49ms/step
Epoch 14/50
282/282 - 14s - loss: 3.1811 - accuracy30: 0.4318 - val_loss: 3.2732 - val_accuracy30: 0.3913 - 14s/epoch - 49ms/step
Epoch 15/50
282/282 - 14s - loss: 3.1650 - accuracy30: 0.4399 - val_loss: 3.3362 - val_accuracy30: 0.3793 - 14s/epoch - 50ms/step
Epoch 16/50
282/282 - 14s - loss: 3.1538 - accuracy30: 0.4453 - val_loss: 3.3457 - val_accuracy30: 0.3823 - 14s/epoch - 49ms/step
Epoch 17/50
282/282 - 14s - loss: 3.1438 - accuracy30: 0.4486 - val_loss: 3.3380 - val_accuracy30: 0.3866 - 14s/epoch - 49ms/step
Epoch 18/50
282/282 - 14s - loss: 3.1343 - accuracy30: 0.4538 - val_loss: 3.3420 - val_accuracy30: 0.3843 - 14s/epoch - 50ms/step
Epoch 19/50
282/282 - 14s - loss: 3.1208 - accuracy30: 0.4573 - val_loss: 3.3623 - val_accuracy30: 0.3776 - 14s/epoch - 49ms/step
Epoch 20/50
282/282 - 14s - loss: 3.1161 - accuracy30: 0.4598 - val_loss: 3.3347 - val_accuracy30: 0.3927 - 14s/epoch - 49ms/step
Epoch 21/50
282/282 - 14s - loss: 3.1012 - accuracy30: 0.4652 - val_loss: 3.3518 - val_accuracy30: 0.3896 - 14s/epoch - 49ms/step
Epoch 22/50
282/282 - 14s - loss: 3.0915 - accuracy30: 0.4695 - val_loss: 3.3489 - val_accuracy30: 0.3942 - 14s/epoch - 50ms/step
Epoch 23/50
282/282 - 14s - loss: 3.0863 - accuracy30: 0.4716 - val_loss: 3.3610 - val_accuracy30: 0.3867 - 14s/epoch - 49ms/step
Epoch 24/50
282/282 - 14s - loss: 3.0737 - accuracy30: 0.4767 - val_loss: 3.3923 - val_accuracy30: 0.3915 - 14s/epoch - 49ms/step
testing model: results/LILAK/W7/deepLOB_L2/h30
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0897634
{'0': {'precision': 0.3839509759898571, 'recall': 0.2695145919086291, 'f1-score': 0.3167126033575545, 'support': 53934}, '1': {'precision': 0.4158112044342637, 'recall': 0.4254177215189873, 'f1-score': 0.4205596115755075, 'support': 69125}, '2': {'precision': 0.3550754942820472, 'recall': 0.4487742641027978, 'f1-score': 0.3964639958778823, 'support': 54865}, 'accuracy': 0.3853611654414244, 'macro avg': {'precision': 0.38494589156872266, 'recall': 0.3812355258434714, 'f1-score': 0.3779120702703147, 'support': 177924}, 'weighted avg': {'precision': 0.38742484678480676, 'recall': 0.3853611654414244, 'f1-score': 0.38165035539603037, 'support': 177924}}
[[14536 20808 18590]
 [13587 29407 26131]
 [ 9736 20507 24622]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0804832
{'0': {'precision': 0.435404514329191, 'recall': 0.3505104124132299, 'f1-score': 0.3883723560683181, 'support': 24490}, '1': {'precision': 0.3855165069222577, 'recall': 0.35151566326099803, 'f1-score': 0.3677318198882583, 'support': 23686}, '2': {'precision': 0.38968191891539566, 'recall': 0.5019731318219983, 'f1-score': 0.4387567884925877, 'support': 23820}, 'accuracy': 0.4009528307128174, 'macro avg': {'precision': 0.40353431338894813, 'recall': 0.40133306916540873, 'f1-score': 0.39828698814972135, 'support': 71996}, 'weighted avg': {'precision': 0.4038644347942553, 'recall': 0.4009528307128174, 'f1-score': 0.39825159158675255, 'support': 71996}}
[[ 8584  6760  9146]
 [ 5779  8326  9581]
 [ 5352  6511 11957]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0917048
{'0': {'precision': 0.4081418253447144, 'recall': 0.48867924528301887, 'f1-score': 0.4447942754919499, 'support': 6360}, '1': {'precision': 0.3487903225806452, 'recall': 0.3689354896036965, 'f1-score': 0.3585801882718715, 'support': 5627}, '2': {'precision': 0.4116575591985428, 'recall': 0.3119153504063794, 'f1-score': 0.3549118827429768, 'support': 6521}, 'accuracy': 0.3899935163172682, 'macro avg': {'precision': 0.38952990237463414, 'recall': 0.3898433617643649, 'f1-score': 0.38609544883559943, 'support': 18508}, 'weighted avg': {'precision': 0.391335860054429, 'recall': 0.3899935163172682, 'f1-score': 0.3869139128431799, 'support': 18508}}
[[3108 1857 1395]
 [2039 2076 1512]
 [2468 2019 2034]]
training model: results/LILAK/W7/deepLOB_L2/h50
Epoch 1/50
282/282 - 16s - loss: 3.3630 - accuracy50: 0.3361 - val_loss: 3.4308 - val_accuracy50: 0.3443 - 16s/epoch - 57ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3163 - accuracy50: 0.3468 - val_loss: 3.3713 - val_accuracy50: 0.3381 - 14s/epoch - 49ms/step
Epoch 3/50
282/282 - 14s - loss: 3.3014 - accuracy50: 0.3500 - val_loss: 3.3536 - val_accuracy50: 0.3387 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2877 - accuracy50: 0.3604 - val_loss: 3.3773 - val_accuracy50: 0.3515 - 14s/epoch - 49ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2781 - accuracy50: 0.3701 - val_loss: 3.3299 - val_accuracy50: 0.3575 - 14s/epoch - 50ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2674 - accuracy50: 0.3811 - val_loss: 3.3414 - val_accuracy50: 0.3591 - 14s/epoch - 50ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2546 - accuracy50: 0.3917 - val_loss: 3.3478 - val_accuracy50: 0.3593 - 14s/epoch - 50ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2456 - accuracy50: 0.3973 - val_loss: 3.3594 - val_accuracy50: 0.3613 - 14s/epoch - 49ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2344 - accuracy50: 0.4036 - val_loss: 3.3661 - val_accuracy50: 0.3642 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 14s - loss: 3.2284 - accuracy50: 0.4086 - val_loss: 3.3555 - val_accuracy50: 0.3667 - 14s/epoch - 49ms/step
Epoch 11/50
282/282 - 14s - loss: 3.2214 - accuracy50: 0.4121 - val_loss: 3.3598 - val_accuracy50: 0.3683 - 14s/epoch - 50ms/step
Epoch 12/50
282/282 - 14s - loss: 3.2142 - accuracy50: 0.4163 - val_loss: 3.4045 - val_accuracy50: 0.3661 - 14s/epoch - 49ms/step
Epoch 13/50
282/282 - 14s - loss: 3.2088 - accuracy50: 0.4209 - val_loss: 3.4110 - val_accuracy50: 0.3685 - 14s/epoch - 50ms/step
Epoch 14/50
282/282 - 14s - loss: 3.1992 - accuracy50: 0.4231 - val_loss: 3.4428 - val_accuracy50: 0.3678 - 14s/epoch - 50ms/step
Epoch 15/50
282/282 - 14s - loss: 3.1863 - accuracy50: 0.4301 - val_loss: 3.4396 - val_accuracy50: 0.3612 - 14s/epoch - 49ms/step
testing model: results/LILAK/W7/deepLOB_L2/h50
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1176515
{'0': {'precision': 0.30872138825247, 'recall': 0.7909892226213844, 'f1-score': 0.4441082744602652, 'support': 54002}, '1': {'precision': 0.4202684477554428, 'recall': 0.09569769822467901, 'f1-score': 0.15589675175395756, 'support': 68382}, '2': {'precision': 0.34078026008669554, 'recall': 0.14720921858120273, 'f1-score': 0.2056027762410099, 'support': 55540}, 'accuracy': 0.3228063667633372, 'macro avg': {'precision': 0.3565900320315361, 'recall': 0.34463204647575535, 'f1-score': 0.2685359341517442, 'support': 177924}, 'weighted avg': {'precision': 0.36159992495693466, 'recall': 0.3228063667633372, 'f1-score': 0.25888831696830134, 'support': 177924}}
[[42715  4504  6783]
 [52805  6544  9033]
 [42841  4523  8176]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.10356
{'0': {'precision': 0.36150783707786965, 'recall': 0.5269672497057749, 'f1-score': 0.42883091149273445, 'support': 24641}, '1': {'precision': 0.3646322378716745, 'recall': 0.06841155991778869, 'f1-score': 0.1152080242989334, 'support': 23841}, '2': {'precision': 0.3450829008986204, 'recall': 0.4638087947605682, 'f1-score': 0.39573279146558293, 'support': 23514}, 'accuracy': 0.35449191621756765, 'macro avg': {'precision': 0.35707432528272154, 'recall': 0.35306253479471056, 'f1-score': 0.3132572424190836, 'support': 71996}, 'weighted avg': {'precision': 0.3571780533399709, 'recall': 0.35449191621756765, 'f1-score': 0.31416686838053576, 'support': 71996}}
[[12985  1430 10226]
 [11738  1631 10472]
 [11196  1412 10906]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1085305
{'0': {'precision': 0.3527334369261195, 'recall': 0.7844800502670437, 'f1-score': 0.4866497758721497, 'support': 6366}, '1': {'precision': 0.32274678111587984, 'recall': 0.06684444444444444, 'f1-score': 0.11075110456553756, 'support': 5625}, '2': {'precision': 0.37205651491365777, 'recall': 0.18183213134878012, 'f1-score': 0.24427952999381572, 'support': 6517}, 'accuracy': 0.3541711692241193, 'macro avg': {'precision': 0.349178910985219, 'recall': 0.3443855420200894, 'f1-score': 0.280560136810501, 'support': 18508}, 'weighted avg': {'precision': 0.3504238173190409, 'recall': 0.3541711692241193, 'f1-score': 0.287062736835582, 'support': 18508}}
[[4994  388  984]
 [4233  376 1016]
 [4931  401 1185]]
training model: results/LILAK/W7/deepLOB_L2/h100
Epoch 1/50
282/282 - 16s - loss: 3.3506 - accuracy100: 0.3516 - val_loss: 3.3700 - val_accuracy100: 0.3568 - 16s/epoch - 57ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3130 - accuracy100: 0.3634 - val_loss: 3.3959 - val_accuracy100: 0.3353 - 14s/epoch - 49ms/step
Epoch 3/50
282/282 - 14s - loss: 3.3030 - accuracy100: 0.3633 - val_loss: 3.3794 - val_accuracy100: 0.3337 - 14s/epoch - 49ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2867 - accuracy100: 0.3674 - val_loss: 3.5639 - val_accuracy100: 0.3100 - 14s/epoch - 49ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2789 - accuracy100: 0.3751 - val_loss: 3.5040 - val_accuracy100: 0.3028 - 14s/epoch - 49ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2610 - accuracy100: 0.3874 - val_loss: 3.4510 - val_accuracy100: 0.3085 - 14s/epoch - 49ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2537 - accuracy100: 0.3957 - val_loss: 3.4412 - val_accuracy100: 0.3112 - 14s/epoch - 49ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2329 - accuracy100: 0.4098 - val_loss: 3.4623 - val_accuracy100: 0.3108 - 14s/epoch - 50ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2183 - accuracy100: 0.4160 - val_loss: 3.4984 - val_accuracy100: 0.3048 - 14s/epoch - 49ms/step
Epoch 10/50
282/282 - 14s - loss: 3.2039 - accuracy100: 0.4249 - val_loss: 3.4613 - val_accuracy100: 0.3105 - 14s/epoch - 50ms/step
Epoch 11/50
282/282 - 14s - loss: 3.1963 - accuracy100: 0.4262 - val_loss: 3.4789 - val_accuracy100: 0.3157 - 14s/epoch - 50ms/step
testing model: results/LILAK/W7/deepLOB_L2/h100
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1630027
{'0': {'precision': 0.30205311176681193, 'recall': 0.46125711700162136, 'f1-score': 0.36505248394148065, 'support': 53042}, '1': {'precision': 0.42097205127435383, 'recall': 0.19651065022421524, 'f1-score': 0.26794432077652836, 'support': 71360}, '2': {'precision': 0.29463640079227843, 'recall': 0.3501924442285415, 'f1-score': 0.3200211719710422, 'support': 53522}, 'accuracy': 0.32166543018367394, 'macro avg': {'precision': 0.3392205212778147, 'recall': 0.3359867371514594, 'f1-score': 0.3176726588963504, 'support': 177924}, 'weighted avg': {'precision': 0.3475168958458525, 'recall': 0.32166543018367394, 'f1-score': 0.3125592598529215, 'support': 177924}}
[[24466  9402 19174]
 [31640 14023 25697]
 [24893  9886 18743]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 23ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1311635
{'0': {'precision': 0.3470513246868418, 'recall': 0.5086101860125092, 'f1-score': 0.41257865779329883, 'support': 24622}, '1': {'precision': 0.3422606495149726, 'recall': 0.06804746132237642, 'f1-score': 0.11352428916168292, 'support': 23851}, '2': {'precision': 0.32880975296759707, 'recall': 0.4357012285847894, 'f1-score': 0.37478287897902834, 'support': 23523}, 'accuracy': 0.33883826879271073, 'macro avg': {'precision': 0.33937390905647047, 'recall': 0.3374529586398916, 'f1-score': 0.30029527531133665, 'support': 71996}, 'weighted avg': {'precision': 0.33950425422353764, 'recall': 0.33883826879271073, 'f1-score': 0.3011583587311182, 'support': 71996}}
[[12523  1533 10566]
 [11873  1623 10355]
 [11688  1586 10249]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1257776
{'0': {'precision': 0.35091298582066716, 'recall': 0.5248703082087275, 'f1-score': 0.4206150272054778, 'support': 6554}, '1': {'precision': 0.2866741321388578, 'recall': 0.09893719806763285, 'f1-score': 0.14710530096250538, 'support': 5175}, '2': {'precision': 0.3642144818615407, 'recall': 0.3717362442838177, 'f1-score': 0.3679369250985545, 'support': 6779}, 'accuracy': 0.34968662200129674, 'macro avg': {'precision': 0.3339338666070219, 'recall': 0.3318479168533927, 'f1-score': 0.3118857510888459, 'support': 18508}, 'weighted avg': {'precision': 0.3378232286268979, 'recall': 0.34968662200129674, 'f1-score': 0.3248446745206812, 'support': 18508}}
[[3440  648 2466]
 [2730  512 1933]
 [3633  626 2520]]
training model: results/LILAK/W7/deepLOB_L2/h200
Epoch 1/50
282/282 - 17s - loss: 3.3622 - accuracy200: 0.3412 - val_loss: 3.5562 - val_accuracy200: 0.3242 - 17s/epoch - 60ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3249 - accuracy200: 0.3455 - val_loss: 3.5150 - val_accuracy200: 0.3200 - 14s/epoch - 51ms/step
Epoch 3/50
282/282 - 14s - loss: 3.3046 - accuracy200: 0.3545 - val_loss: 3.4667 - val_accuracy200: 0.3145 - 14s/epoch - 51ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2907 - accuracy200: 0.3629 - val_loss: 3.4434 - val_accuracy200: 0.3212 - 14s/epoch - 50ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2911 - accuracy200: 0.3650 - val_loss: 3.3558 - val_accuracy200: 0.3248 - 14s/epoch - 51ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2766 - accuracy200: 0.3742 - val_loss: 3.3916 - val_accuracy200: 0.3278 - 14s/epoch - 51ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2613 - accuracy200: 0.3866 - val_loss: 3.4084 - val_accuracy200: 0.3243 - 14s/epoch - 51ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2529 - accuracy200: 0.3899 - val_loss: 3.4165 - val_accuracy200: 0.3278 - 14s/epoch - 51ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2433 - accuracy200: 0.3954 - val_loss: 3.4776 - val_accuracy200: 0.3234 - 14s/epoch - 51ms/step
Epoch 10/50
282/282 - 14s - loss: 3.2287 - accuracy200: 0.4065 - val_loss: 3.4492 - val_accuracy200: 0.3261 - 14s/epoch - 50ms/step
Epoch 11/50
282/282 - 14s - loss: 3.2139 - accuracy200: 0.4183 - val_loss: 3.4928 - val_accuracy200: 0.3274 - 14s/epoch - 50ms/step
Epoch 12/50
282/282 - 14s - loss: 3.2022 - accuracy200: 0.4216 - val_loss: 3.5274 - val_accuracy200: 0.3326 - 14s/epoch - 50ms/step
Epoch 13/50
282/282 - 14s - loss: 3.1889 - accuracy200: 0.4315 - val_loss: 3.4546 - val_accuracy200: 0.3369 - 14s/epoch - 51ms/step
Epoch 14/50
282/282 - 14s - loss: 3.1868 - accuracy200: 0.4307 - val_loss: 3.5775 - val_accuracy200: 0.3345 - 14s/epoch - 50ms/step
Epoch 15/50
282/282 - 14s - loss: 3.1677 - accuracy200: 0.4384 - val_loss: 3.6424 - val_accuracy200: 0.3260 - 14s/epoch - 50ms/step
testing model: results/LILAK/W7/deepLOB_L2/h200
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1233463
{'0': {'precision': 0.32172848962663353, 'recall': 0.6087632783639995, 'f1-score': 0.42097414899468305, 'support': 56577}, '1': {'precision': 0.3498044509737746, 'recall': 0.2851963355022498, 'f1-score': 0.3142136188956158, 'support': 61782}, '2': {'precision': 0.3164390243902439, 'recall': 0.10890623688407622, 'f1-score': 0.16204333978642352, 'support': 59565}, 'accuracy': 0.32906746700838563, 'macro avg': {'precision': 0.3293239883302173, 'recall': 0.3342886169167752, 'f1-score': 0.2990770358922408, 'support': 177924}, 'weighted avg': {'precision': 0.3297067390316802, 'recall': 0.32906746700838563, 'f1-score': 0.2972185414258865, 'support': 177924}}
[[34442 15358  6777]
 [36926 17620  7236]
 [35685 17393  6487]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1096563
{'0': {'precision': 0.35585911784068464, 'recall': 0.43947154471544714, 'f1-score': 0.39327028010185516, 'support': 24600}, '1': {'precision': 0.3353350948834975, 'recall': 0.23433631289605103, 'f1-score': 0.2758825127837751, 'support': 23829}, '2': {'precision': 0.33792661432462745, 'recall': 0.3579581618364662, 'f1-score': 0.3476540767756692, 'support': 23567}, 'accuracy': 0.34489416078671037, 'macro avg': {'precision': 0.34304027568293655, 'recall': 0.34392200648265475, 'f1-score': 0.3389356232204331, 'support': 71996}, 'weighted avg': {'precision': 0.34319616082349297, 'recall': 0.34489416078671037, 'f1-score': 0.33948576191736224, 'support': 71996}}
[[10811  5711  8078]
 [ 9795  5584  8450]
 [ 9774  5357  8436]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1162912
{'0': {'precision': 0.34888641425389755, 'recall': 0.49168236032642815, 'f1-score': 0.4081552892131319, 'support': 6372}, '1': {'precision': 0.31425048441078035, 'recall': 0.31336729316704726, 'f1-score': 0.3138082673702727, 'support': 5693}, '2': {'precision': 0.31420410283043365, 'recall': 0.18780071395312742, 'f1-score': 0.23508840101029724, 'support': 6443}, 'accuracy': 0.3310460341473957, 'macro avg': {'precision': 0.32578033383170385, 'recall': 0.33095012248220096, 'f1-score': 0.3190173191979006, 'support': 18508}, 'weighted avg': {'precision': 0.3261589190573207, 'recall': 0.3310460341473957, 'f1-score': 0.31888645648986297, 'support': 18508}}
[[3133 1876 1363]
 [2631 1784 1278]
 [3216 2017 1210]]
training model: results/LILAK/W7/deepLOB_L2/h300
Epoch 1/50
282/282 - 16s - loss: 3.3616 - accuracy300: 0.3439 - val_loss: 3.3760 - val_accuracy300: 0.3343 - 16s/epoch - 58ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3239 - accuracy300: 0.3498 - val_loss: 3.3720 - val_accuracy300: 0.3384 - 14s/epoch - 50ms/step
Epoch 3/50
282/282 - 14s - loss: 3.2982 - accuracy300: 0.3618 - val_loss: 3.3539 - val_accuracy300: 0.3376 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2857 - accuracy300: 0.3725 - val_loss: 3.4026 - val_accuracy300: 0.3380 - 14s/epoch - 49ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2674 - accuracy300: 0.3844 - val_loss: 3.4190 - val_accuracy300: 0.3329 - 14s/epoch - 49ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2521 - accuracy300: 0.3971 - val_loss: 3.4614 - val_accuracy300: 0.3264 - 14s/epoch - 50ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2400 - accuracy300: 0.4025 - val_loss: 3.4841 - val_accuracy300: 0.3218 - 14s/epoch - 50ms/step
Epoch 8/50
282/282 - 14s - loss: 3.2233 - accuracy300: 0.4128 - val_loss: 3.5768 - val_accuracy300: 0.3142 - 14s/epoch - 50ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2038 - accuracy300: 0.4237 - val_loss: 3.5253 - val_accuracy300: 0.3195 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 14s - loss: 3.1796 - accuracy300: 0.4344 - val_loss: 3.6494 - val_accuracy300: 0.3154 - 14s/epoch - 50ms/step
Epoch 11/50
282/282 - 14s - loss: 3.1641 - accuracy300: 0.4440 - val_loss: 3.6979 - val_accuracy300: 0.3292 - 14s/epoch - 50ms/step
Epoch 12/50
282/282 - 14s - loss: 3.1499 - accuracy300: 0.4477 - val_loss: 3.6191 - val_accuracy300: 0.3280 - 14s/epoch - 49ms/step
Epoch 13/50
282/282 - 14s - loss: 3.1320 - accuracy300: 0.4590 - val_loss: 3.6893 - val_accuracy300: 0.3228 - 14s/epoch - 49ms/step
testing model: results/LILAK/W7/deepLOB_L2/h300
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1401024
{'0': {'precision': 0.2962009542704422, 'recall': 0.34079761545427106, 'f1-score': 0.31693816503943084, 'support': 53008}, '1': {'precision': 0.3830103829111831, 'recall': 0.16894937207368835, 'f1-score': 0.23447131101911922, 'support': 68559}, '2': {'precision': 0.30868697588040556, 'recall': 0.4748478449882002, 'f1-score': 0.3741488989863684, 'support': 56357}, 'accuracy': 0.3170398597153841, 'macro avg': {'precision': 0.32929943768734365, 'recall': 0.32819827750538655, 'f1-score': 0.30851945834830613, 'support': 177924}, 'weighted avg': {'precision': 0.33360592683205986, 'recall': 0.3170398597153841, 'f1-score': 0.30328278571044215, 'support': 177924}}
[[18065  9106 25837]
 [22881 11583 34095]
 [20043  9553 26761]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1229429
{'0': {'precision': 0.34542123476895337, 'recall': 0.4825120851444124, 'f1-score': 0.4026167717442885, 'support': 24617}, '1': {'precision': 0.3417733522996681, 'recall': 0.150997150997151, 'f1-score': 0.2094557289396449, 'support': 23868}, '2': {'precision': 0.34625332545078336, 'recall': 0.3985793883714006, 'f1-score': 0.3705783489866535, 'support': 23511}, 'accuracy': 0.3451997333185177, 'macro avg': {'precision': 0.34448263750646824, 'recall': 0.3440295415043213, 'f1-score': 0.3275502832235289, 'support': 71996}, 'weighted avg': {'precision': 0.3444836219188451, 'recall': 0.3451997333185177, 'f1-score': 0.3281178672618729, 'support': 71996}}
[[11878  3654  9085]
 [11656  3604  8608]
 [10853  3287  9371]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 24ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1170728
{'0': {'precision': 0.3360392864301463, 'recall': 0.5336622632500397, 'f1-score': 0.4123977615152819, 'support': 6283}, '1': {'precision': 0.3307823129251701, 'recall': 0.20079146593255334, 'f1-score': 0.2498929336188437, 'support': 5812}, '2': {'precision': 0.3442622950819672, 'recall': 0.2685170746920318, 'f1-score': 0.3017082785808147, 'support': 6413}, 'accuracy': 0.3372595634320294, 'macro avg': {'precision': 0.33702796481242786, 'recall': 0.33432360129154165, 'f1-score': 0.32133299123831344, 'support': 18508}, 'weighted avg': {'precision': 0.337237720862457, 'recall': 0.3372595634320294, 'f1-score': 0.3230131865318781, 'support': 18508}}
[[3353 1179 1751]
 [3116 1167 1529]
 [3509 1182 1722]]
training model: results/LILAK/W7/deepLOB_L2/h500
Epoch 1/50
282/282 - 16s - loss: 3.3653 - accuracy500: 0.3399 - val_loss: 3.4909 - val_accuracy500: 0.3376 - 16s/epoch - 58ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3201 - accuracy500: 0.3569 - val_loss: 3.4464 - val_accuracy500: 0.3307 - 14s/epoch - 51ms/step
Epoch 3/50
282/282 - 14s - loss: 3.2914 - accuracy500: 0.3692 - val_loss: 3.5664 - val_accuracy500: 0.3244 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2819 - accuracy500: 0.3739 - val_loss: 3.4718 - val_accuracy500: 0.3391 - 14s/epoch - 50ms/step
Epoch 5/50
282/282 - 14s - loss: 3.2498 - accuracy500: 0.3911 - val_loss: 3.5551 - val_accuracy500: 0.3315 - 14s/epoch - 50ms/step
Epoch 6/50
282/282 - 14s - loss: 3.2346 - accuracy500: 0.4023 - val_loss: 3.7118 - val_accuracy500: 0.3288 - 14s/epoch - 50ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2163 - accuracy500: 0.4110 - val_loss: 3.6296 - val_accuracy500: 0.3347 - 14s/epoch - 50ms/step
Epoch 8/50
282/282 - 14s - loss: 3.1921 - accuracy500: 0.4251 - val_loss: 3.7999 - val_accuracy500: 0.3318 - 14s/epoch - 50ms/step
Epoch 9/50
282/282 - 14s - loss: 3.1648 - accuracy500: 0.4381 - val_loss: 3.7655 - val_accuracy500: 0.3307 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 14s - loss: 3.1428 - accuracy500: 0.4447 - val_loss: 3.6367 - val_accuracy500: 0.3356 - 14s/epoch - 51ms/step
Epoch 11/50
282/282 - 14s - loss: 3.1257 - accuracy500: 0.4539 - val_loss: 3.6130 - val_accuracy500: 0.3378 - 14s/epoch - 50ms/step
Epoch 12/50
282/282 - 16s - loss: 3.1051 - accuracy500: 0.4620 - val_loss: 3.6399 - val_accuracy500: 0.3308 - 16s/epoch - 55ms/step
testing model: results/LILAK/W7/deepLOB_L2/h500
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1499301
{'0': {'precision': 0.2697751455531018, 'recall': 0.32517292141402326, 'f1-score': 0.29489488940298647, 'support': 49589}, '1': {'precision': 0.4021766708953729, 'recall': 0.4213523231249213, 'f1-score': 0.411541247044998, 'support': 71477}, '2': {'precision': 0.31169251392516234, 'recall': 0.23718737908473742, 'f1-score': 0.2693832709113608, 'support': 56858}, 'accuracy': 0.3356938917740159, 'macro avg': {'precision': 0.327881443457879, 'recall': 0.32790420787456065, 'f1-score': 0.32527313578644845, 'support': 177924}, 'weighted avg': {'precision': 0.33635976346742547, 'recall': 0.3356938917740159, 'f1-score': 0.3336023830574749, 'support': 177924}}
[[16125 21151 12313]
 [23892 30117 17468]
 [19755 23617 13486]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 23ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1358361
{'0': {'precision': 0.35300252020509254, 'recall': 0.3319576676337188, 'f1-score': 0.34215680080864236, 'support': 24473}, '1': {'precision': 0.3447440040823269, 'recall': 0.3333196283200395, 'f1-score': 0.3389355742296919, 'support': 24322}, '2': {'precision': 0.3379015157464855, 'recall': 0.3708891858109564, 'f1-score': 0.3536277148786652, 'support': 23201}, 'accuracy': 0.34496360908939383, 'macro avg': {'precision': 0.345216013344635, 'recall': 0.3453888272549049, 'f1-score': 0.34490669663899975, 'support': 71996}, 'weighted avg': {'precision': 0.34534623327829045, 'recall': 0.34496360908939383, 'f1-score': 0.3447651402231288, 'support': 71996}}
[[8124 7986 8363]
 [7717 8107 8498]
 [7173 7423 8605]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.14476
{'0': {'precision': 0.3152346570397112, 'recall': 0.3698746187732972, 'f1-score': 0.3403757698604506, 'support': 5902}, '1': {'precision': 0.33984528648223417, 'recall': 0.4134630722603286, 'f1-score': 0.37305699481865284, 'support': 6269}, '2': {'precision': 0.3437815975733064, 'recall': 0.214612592709484, 'f1-score': 0.2642572622170407, 'support': 6337}, 'accuracy': 0.3314782796628485, 'macro avg': {'precision': 0.3329538470317506, 'recall': 0.3326500945810366, 'f1-score': 0.32589667563204805, 'support': 18508}, 'weighted avg': {'precision': 0.33334498760684805, 'recall': 0.3314782796628485, 'f1-score': 0.3253830973040794, 'support': 18508}}
[[2183 2481 1238]
 [2319 2592 1358]
 [2423 2554 1360]]
training model: results/LILAK/W7/deepLOB_L2/h1000
Epoch 1/50
282/282 - 17s - loss: 3.3325 - accuracy1000: 0.3622 - val_loss: 3.6779 - val_accuracy1000: 0.3295 - 17s/epoch - 60ms/step
Epoch 2/50
282/282 - 14s - loss: 3.3046 - accuracy1000: 0.3693 - val_loss: 3.5521 - val_accuracy1000: 0.3395 - 14s/epoch - 51ms/step
Epoch 3/50
282/282 - 14s - loss: 3.2575 - accuracy1000: 0.3911 - val_loss: 3.6963 - val_accuracy1000: 0.3373 - 14s/epoch - 50ms/step
Epoch 4/50
282/282 - 14s - loss: 3.2185 - accuracy1000: 0.4073 - val_loss: 3.5895 - val_accuracy1000: 0.3368 - 14s/epoch - 50ms/step
Epoch 5/50
282/282 - 14s - loss: 3.1794 - accuracy1000: 0.4271 - val_loss: 3.5736 - val_accuracy1000: 0.3477 - 14s/epoch - 50ms/step
Epoch 6/50
282/282 - 14s - loss: 3.1577 - accuracy1000: 0.4383 - val_loss: 3.7585 - val_accuracy1000: 0.3302 - 14s/epoch - 50ms/step
Epoch 7/50
282/282 - 14s - loss: 3.1200 - accuracy1000: 0.4540 - val_loss: 3.9162 - val_accuracy1000: 0.3356 - 14s/epoch - 51ms/step
Epoch 8/50
282/282 - 14s - loss: 3.0810 - accuracy1000: 0.4657 - val_loss: 3.7432 - val_accuracy1000: 0.3476 - 14s/epoch - 51ms/step
Epoch 9/50
282/282 - 14s - loss: 3.0595 - accuracy1000: 0.4752 - val_loss: 3.9570 - val_accuracy1000: 0.3428 - 14s/epoch - 49ms/step
Epoch 10/50
282/282 - 14s - loss: 3.0414 - accuracy1000: 0.4803 - val_loss: 4.0457 - val_accuracy1000: 0.3349 - 14s/epoch - 49ms/step
Epoch 11/50
282/282 - 14s - loss: 3.0188 - accuracy1000: 0.4880 - val_loss: 4.0307 - val_accuracy1000: 0.3397 - 14s/epoch - 49ms/step
Epoch 12/50
282/282 - 14s - loss: 2.9764 - accuracy1000: 0.4980 - val_loss: 3.9725 - val_accuracy1000: 0.3509 - 14s/epoch - 49ms/step
testing model: results/LILAK/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1626917
{'0': {'precision': 0.27384615384615385, 'recall': 0.21902909538363832, 'f1-score': 0.24338927728646098, 'support': 50386}, '1': {'precision': 0.38772965254640646, 'recall': 0.5901589463465523, 'f1-score': 0.4679922098961894, 'support': 69017}, '2': {'precision': 0.3287284337201449, 'recall': 0.18297705097315495, 'f1-score': 0.23509523025413032, 'support': 58521}, 'accuracy': 0.3511330680515276, 'macro avg': {'precision': 0.3301014133709017, 'recall': 0.33072169756778186, 'f1-score': 0.3154922391455936, 'support': 177924}, 'weighted avg': {'precision': 0.33607307843362466, 'recall': 0.3511330680515276, 'f1-score': 0.327785113000286, 'support': 177924}}
[[11036 30040  9310]
 [15730 40731 12556]
 [13534 34279 10708]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1488568
{'0': {'precision': 0.34622327131352404, 'recall': 0.2015601002344192, 'f1-score': 0.2547897614060185, 'support': 24742}, '1': {'precision': 0.348743462176298, 'recall': 0.5520820711660406, 'f1-score': 0.427463489382994, 'support': 24759}, '2': {'precision': 0.35348154590422354, 'recall': 0.2890864636585908, 'f1-score': 0.3180573217255209, 'support': 22495}, 'accuracy': 0.3494499694427468, 'macro avg': {'precision': 0.3494827597980152, 'recall': 0.34757621168635017, 'f1-score': 0.3334368575048445, 'support': 71996}, 'weighted avg': {'precision': 0.3493577828487372, 'recall': 0.3494499694427468, 'f1-score': 0.3339390558163905, 'support': 71996}}
[[ 4987 13950  5805]
 [ 5001 13669  6089]
 [ 4416 11576  6503]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1736487
{'0': {'precision': 0.297814823158369, 'recall': 0.23087670275934336, 'f1-score': 0.2601082144613871, 'support': 5726}, '1': {'precision': 0.3536616483796887, 'recall': 0.6270547428743779, 'f1-score': 0.4522514683489232, 'support': 6631}, '2': {'precision': 0.314878892733564, 'recall': 0.1183547390668184, 'f1-score': 0.17204301075268816, 'support': 6151}, 'accuracy': 0.3354225199913551, 'macro avg': {'precision': 0.3221184547572072, 'recall': 0.3254287282335132, 'f1-score': 0.2948008978543328, 'support': 18508}, 'weighted avg': {'precision': 0.3234946043340549, 'recall': 0.3354225199913551, 'f1-score': 0.29968098561526896, 'support': 18508}}
[[1322 3696  708]
 [1597 4158  876]
 [1520 3903  728]]
training model: results/LILAK/W7/deepOF_L2/h10
Epoch 1/50
282/282 - 12s - loss: 3.2886 - accuracy10: 0.3875 - val_loss: 3.2387 - val_accuracy10: 0.4186 - 12s/epoch - 41ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2029 - accuracy10: 0.4359 - val_loss: 3.2109 - val_accuracy10: 0.4360 - 9s/epoch - 32ms/step
Epoch 3/50
282/282 - 9s - loss: 3.1597 - accuracy10: 0.4537 - val_loss: 3.1807 - val_accuracy10: 0.4492 - 9s/epoch - 32ms/step
Epoch 4/50
282/282 - 9s - loss: 3.1226 - accuracy10: 0.4676 - val_loss: 3.1640 - val_accuracy10: 0.4553 - 9s/epoch - 32ms/step
Epoch 5/50
282/282 - 9s - loss: 3.0929 - accuracy10: 0.4782 - val_loss: 3.1424 - val_accuracy10: 0.4664 - 9s/epoch - 32ms/step
Epoch 6/50
282/282 - 9s - loss: 3.0669 - accuracy10: 0.4872 - val_loss: 3.1210 - val_accuracy10: 0.4702 - 9s/epoch - 33ms/step
Epoch 7/50
282/282 - 9s - loss: 3.0426 - accuracy10: 0.4953 - val_loss: 3.1145 - val_accuracy10: 0.4740 - 9s/epoch - 32ms/step
Epoch 8/50
282/282 - 9s - loss: 3.0254 - accuracy10: 0.5000 - val_loss: 3.1014 - val_accuracy10: 0.4746 - 9s/epoch - 32ms/step
Epoch 9/50
282/282 - 9s - loss: 3.0067 - accuracy10: 0.5036 - val_loss: 3.0990 - val_accuracy10: 0.4807 - 9s/epoch - 32ms/step
Epoch 10/50
282/282 - 9s - loss: 2.9922 - accuracy10: 0.5091 - val_loss: 3.0887 - val_accuracy10: 0.4783 - 9s/epoch - 32ms/step
Epoch 11/50
282/282 - 9s - loss: 2.9758 - accuracy10: 0.5126 - val_loss: 3.0910 - val_accuracy10: 0.4794 - 9s/epoch - 32ms/step
Epoch 12/50
282/282 - 9s - loss: 2.9622 - accuracy10: 0.5162 - val_loss: 3.0892 - val_accuracy10: 0.4795 - 9s/epoch - 32ms/step
Epoch 13/50
282/282 - 9s - loss: 2.9447 - accuracy10: 0.5215 - val_loss: 3.0887 - val_accuracy10: 0.4834 - 9s/epoch - 32ms/step
Epoch 14/50
282/282 - 9s - loss: 2.9323 - accuracy10: 0.5250 - val_loss: 3.0897 - val_accuracy10: 0.4818 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 2.9173 - accuracy10: 0.5283 - val_loss: 3.1003 - val_accuracy10: 0.4826 - 9s/epoch - 32ms/step
Epoch 16/50
282/282 - 9s - loss: 2.9064 - accuracy10: 0.5331 - val_loss: 3.0978 - val_accuracy10: 0.4780 - 9s/epoch - 32ms/step
Epoch 17/50
282/282 - 9s - loss: 2.8919 - accuracy10: 0.5349 - val_loss: 3.1020 - val_accuracy10: 0.4787 - 9s/epoch - 32ms/step
Epoch 18/50
282/282 - 9s - loss: 2.8778 - accuracy10: 0.5393 - val_loss: 3.1112 - val_accuracy10: 0.4780 - 9s/epoch - 32ms/step
Epoch 19/50
282/282 - 9s - loss: 2.8667 - accuracy10: 0.5414 - val_loss: 3.1211 - val_accuracy10: 0.4757 - 9s/epoch - 32ms/step
Epoch 20/50
282/282 - 9s - loss: 2.8555 - accuracy10: 0.5453 - val_loss: 3.1203 - val_accuracy10: 0.4743 - 9s/epoch - 32ms/step
Epoch 21/50
282/282 - 9s - loss: 2.8422 - accuracy10: 0.5485 - val_loss: 3.1282 - val_accuracy10: 0.4767 - 9s/epoch - 32ms/step
Epoch 22/50
282/282 - 9s - loss: 2.8323 - accuracy10: 0.5511 - val_loss: 3.1263 - val_accuracy10: 0.4768 - 9s/epoch - 32ms/step
Epoch 23/50
282/282 - 9s - loss: 2.8200 - accuracy10: 0.5531 - val_loss: 3.1382 - val_accuracy10: 0.4769 - 9s/epoch - 31ms/step
testing model: results/LILAK/W7/deepOF_L2/h10
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9840175
{'0': {'precision': 0.4792207792207792, 'recall': 0.4819785711581418, 'f1-score': 0.4805957189776888, 'support': 52826}, '1': {'precision': 0.5633340913715305, 'recall': 0.6470709542598677, 'f1-score': 0.6023060286909896, 'support': 72737}, '2': {'precision': 0.5202230843840931, 'recall': 0.40977156390862557, 'f1-score': 0.45843839480319676, 'support': 52356}, 'accuracy': 0.528223517443331, 'macro avg': {'precision': 0.5209259849921343, 'recall': 0.5129403631088784, 'f1-score': 0.513780047490625, 'support': 177919}, 'weighted avg': {'precision': 0.5256737531866832, 'recall': 0.528223517443331, 'f1-score': 0.5238332255572933, 'support': 177919}}
[[25461 18288  9077]
 [14962 47066 10709]
 [12707 18195 21454]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9814025
{'0': {'precision': 0.5276166009655845, 'recall': 0.5080610765162501, 'f1-score': 0.5176542163700759, 'support': 23446}, '1': {'precision': 0.509963439939396, 'recall': 0.6040024966840914, 'f1-score': 0.5530136619341013, 'support': 25634}, '2': {'precision': 0.5372586062132662, 'recall': 0.44680108230775945, 'f1-score': 0.4878722897307601, 'support': 22914}, 'accuracy': 0.5227241158985471, 'macro avg': {'precision': 0.5249462157060822, 'recall': 0.5196215518360336, 'f1-score': 0.5195133893449791, 'support': 71994}, 'weighted avg': {'precision': 0.5243998853851203, 'recall': 0.5227241158985471, 'f1-score': 0.5207653223035558, 'support': 71994}}
[[11912  7390  4144]
 [ 5477 15483  4674]
 [ 5188  7488 10238]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0265534
{'0': {'precision': 0.4573112456196241, 'recall': 0.4904338913563375, 'f1-score': 0.47329376854599403, 'support': 5854}, '1': {'precision': 0.4815332960268607, 'recall': 0.5331474597273854, 'f1-score': 0.5060276389297266, 'support': 6456}, '2': {'precision': 0.5098386462022826, 'recall': 0.41803807679896743, 'f1-score': 0.4593971631205674, 'support': 6198}, 'accuracy': 0.481089258698941, 'macro avg': {'precision': 0.4828943959495891, 'recall': 0.4805398092942301, 'f1-score': 0.47957285686542933, 'support': 18508}, 'weighted avg': {'precision': 0.48335092501450394, 'recall': 0.481089258698941, 'f1-score': 0.480058340988753, 'support': 18508}}
[[2871 1781 1202]
 [1725 3442 1289]
 [1682 1925 2591]]
training model: results/LILAK/W7/deepOF_L2/h20
Epoch 1/50
282/282 - 11s - loss: 3.3166 - accuracy20: 0.3664 - val_loss: 3.2813 - val_accuracy20: 0.3893 - 11s/epoch - 39ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2575 - accuracy20: 0.4001 - val_loss: 3.2605 - val_accuracy20: 0.4033 - 9s/epoch - 33ms/step
Epoch 3/50
282/282 - 10s - loss: 3.2304 - accuracy20: 0.4173 - val_loss: 3.2391 - val_accuracy20: 0.4156 - 10s/epoch - 34ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2077 - accuracy20: 0.4275 - val_loss: 3.2304 - val_accuracy20: 0.4208 - 9s/epoch - 32ms/step
Epoch 5/50
282/282 - 9s - loss: 3.1884 - accuracy20: 0.4349 - val_loss: 3.2202 - val_accuracy20: 0.4274 - 9s/epoch - 32ms/step
Epoch 6/50
282/282 - 9s - loss: 3.1720 - accuracy20: 0.4419 - val_loss: 3.2121 - val_accuracy20: 0.4269 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.1548 - accuracy20: 0.4502 - val_loss: 3.2121 - val_accuracy20: 0.4275 - 9s/epoch - 32ms/step
Epoch 8/50
282/282 - 9s - loss: 3.1411 - accuracy20: 0.4552 - val_loss: 3.2071 - val_accuracy20: 0.4354 - 9s/epoch - 34ms/step
Epoch 9/50
282/282 - 9s - loss: 3.1303 - accuracy20: 0.4593 - val_loss: 3.2083 - val_accuracy20: 0.4362 - 9s/epoch - 33ms/step
Epoch 10/50
282/282 - 9s - loss: 3.1194 - accuracy20: 0.4628 - val_loss: 3.2060 - val_accuracy20: 0.4362 - 9s/epoch - 33ms/step
Epoch 11/50
282/282 - 9s - loss: 3.1049 - accuracy20: 0.4693 - val_loss: 3.2020 - val_accuracy20: 0.4360 - 9s/epoch - 33ms/step
Epoch 12/50
282/282 - 9s - loss: 3.0931 - accuracy20: 0.4716 - val_loss: 3.2095 - val_accuracy20: 0.4360 - 9s/epoch - 33ms/step
Epoch 13/50
282/282 - 9s - loss: 3.0812 - accuracy20: 0.4761 - val_loss: 3.2143 - val_accuracy20: 0.4354 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.0719 - accuracy20: 0.4799 - val_loss: 3.2122 - val_accuracy20: 0.4331 - 9s/epoch - 33ms/step
Epoch 15/50
282/282 - 9s - loss: 3.0585 - accuracy20: 0.4845 - val_loss: 3.2174 - val_accuracy20: 0.4367 - 9s/epoch - 33ms/step
Epoch 16/50
282/282 - 9s - loss: 3.0464 - accuracy20: 0.4906 - val_loss: 3.2249 - val_accuracy20: 0.4324 - 9s/epoch - 33ms/step
Epoch 17/50
282/282 - 9s - loss: 3.0328 - accuracy20: 0.4932 - val_loss: 3.2266 - val_accuracy20: 0.4354 - 9s/epoch - 33ms/step
Epoch 18/50
282/282 - 9s - loss: 3.0225 - accuracy20: 0.4970 - val_loss: 3.2390 - val_accuracy20: 0.4353 - 9s/epoch - 33ms/step
Epoch 19/50
282/282 - 9s - loss: 3.0153 - accuracy20: 0.4983 - val_loss: 3.2366 - val_accuracy20: 0.4335 - 9s/epoch - 33ms/step
Epoch 20/50
282/282 - 9s - loss: 3.0045 - accuracy20: 0.5001 - val_loss: 3.2361 - val_accuracy20: 0.4360 - 9s/epoch - 33ms/step
Epoch 21/50
282/282 - 9s - loss: 2.9904 - accuracy20: 0.5059 - val_loss: 3.2528 - val_accuracy20: 0.4361 - 9s/epoch - 32ms/step
testing model: results/LILAK/W7/deepOF_L2/h20
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0417807
{'0': {'precision': 0.4422044524533544, 'recall': 0.43053474176687745, 'f1-score': 0.43629157715386324, 'support': 54718}, '1': {'precision': 0.5028590649175917, 'recall': 0.5269573646257105, 'f1-score': 0.5146262577003895, 'support': 68089}, '2': {'precision': 0.4497401159626968, 'recall': 0.4348962113514298, 'f1-score': 0.4421936257552696, 'support': 55112}, 'accuracy': 0.46878635783699324, 'macro avg': {'precision': 0.4649345444445476, 'recall': 0.4641294392480059, 'f1-score': 0.4643704868698408, 'support': 177919}, 'weighted avg': {'precision': 0.4677510067584277, 'recall': 0.46878635783699324, 'f1-score': 0.4680982069474948, 'support': 177919}}
[[23558 17820 13340]
 [16224 35880 15985]
 [13492 17652 23968]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0353571
{'0': {'precision': 0.49066727814721395, 'recall': 0.44099583693994476, 'f1-score': 0.4645074458385794, 'support': 24261}, '1': {'precision': 0.4442530242313022, 'recall': 0.49134288791318037, 'f1-score': 0.4666129063981276, 'support': 24142}, '2': {'precision': 0.4733480926430518, 'recall': 0.4712814208808444, 'f1-score': 0.47231249601733255, 'support': 23591}, 'accuracy': 0.467802872461594, 'macro avg': {'precision': 0.46942279834052264, 'recall': 0.4678733819113232, 'f1-score': 0.46781094941801316, 'support': 71994}, 'weighted avg': {'precision': 0.46942787176242307, 'recall': 0.467802872461594, 'f1-score': 0.4677710367988758, 'support': 71994}}
[[10699  7626  5936]
 [ 5846 11862  6434]
 [ 5260  7213 11118]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0673089
{'0': {'precision': 0.44141176470588234, 'recall': 0.4568923526546517, 'f1-score': 0.44901866921972233, 'support': 6159}, '1': {'precision': 0.4197054698457223, 'recall': 0.4037780401416765, 'f1-score': 0.41158772457663545, 'support': 5929}, '2': {'precision': 0.4485923160678177, 'recall': 0.44922118380062304, 'f1-score': 0.44890652969102657, 'support': 6420}, 'accuracy': 0.4372163388804841, 'macro avg': {'precision': 0.4365698502064741, 'recall': 0.43663052553231707, 'f1-score': 0.43650430782912814, 'support': 18508}, 'weighted avg': {'precision': 0.43694896578205134, 'recall': 0.4372163388804841, 'f1-score': 0.43698884392454784, 'support': 18508}}
[[2814 1621 1724]
 [1714 2394 1821]
 [1847 1689 2884]]
training model: results/LILAK/W7/deepOF_L2/h30
Epoch 1/50
282/282 - 12s - loss: 3.3349 - accuracy30: 0.3469 - val_loss: 3.2988 - val_accuracy30: 0.3699 - 12s/epoch - 41ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2883 - accuracy30: 0.3734 - val_loss: 3.2885 - val_accuracy30: 0.3776 - 9s/epoch - 33ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2656 - accuracy30: 0.3883 - val_loss: 3.2745 - val_accuracy30: 0.3913 - 9s/epoch - 33ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2504 - accuracy30: 0.3990 - val_loss: 3.2688 - val_accuracy30: 0.3916 - 9s/epoch - 32ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2372 - accuracy30: 0.4041 - val_loss: 3.2620 - val_accuracy30: 0.4000 - 9s/epoch - 33ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2274 - accuracy30: 0.4091 - val_loss: 3.2598 - val_accuracy30: 0.4021 - 9s/epoch - 33ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2174 - accuracy30: 0.4170 - val_loss: 3.2600 - val_accuracy30: 0.4004 - 9s/epoch - 33ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2068 - accuracy30: 0.4232 - val_loss: 3.2553 - val_accuracy30: 0.4074 - 9s/epoch - 32ms/step
Epoch 9/50
282/282 - 9s - loss: 3.1975 - accuracy30: 0.4264 - val_loss: 3.2592 - val_accuracy30: 0.4043 - 9s/epoch - 33ms/step
Epoch 10/50
282/282 - 9s - loss: 3.1892 - accuracy30: 0.4303 - val_loss: 3.2548 - val_accuracy30: 0.4084 - 9s/epoch - 33ms/step
Epoch 11/50
282/282 - 9s - loss: 3.1794 - accuracy30: 0.4337 - val_loss: 3.2571 - val_accuracy30: 0.4059 - 9s/epoch - 33ms/step
Epoch 12/50
282/282 - 9s - loss: 3.1694 - accuracy30: 0.4376 - val_loss: 3.2631 - val_accuracy30: 0.4080 - 9s/epoch - 32ms/step
Epoch 13/50
282/282 - 9s - loss: 3.1600 - accuracy30: 0.4408 - val_loss: 3.2631 - val_accuracy30: 0.4079 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.1534 - accuracy30: 0.4450 - val_loss: 3.2638 - val_accuracy30: 0.4086 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 3.1415 - accuracy30: 0.4493 - val_loss: 3.2706 - val_accuracy30: 0.4065 - 9s/epoch - 32ms/step
Epoch 16/50
282/282 - 9s - loss: 3.1312 - accuracy30: 0.4513 - val_loss: 3.2784 - val_accuracy30: 0.4092 - 9s/epoch - 30ms/step
Epoch 17/50
282/282 - 9s - loss: 3.1223 - accuracy30: 0.4552 - val_loss: 3.2829 - val_accuracy30: 0.4040 - 9s/epoch - 31ms/step
Epoch 18/50
282/282 - 9s - loss: 3.1092 - accuracy30: 0.4622 - val_loss: 3.2986 - val_accuracy30: 0.4022 - 9s/epoch - 31ms/step
Epoch 19/50
282/282 - 9s - loss: 3.1043 - accuracy30: 0.4622 - val_loss: 3.2892 - val_accuracy30: 0.4096 - 9s/epoch - 33ms/step
Epoch 20/50
282/282 - 9s - loss: 3.0921 - accuracy30: 0.4662 - val_loss: 3.2956 - val_accuracy30: 0.4083 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h30
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0770391
{'0': {'precision': 0.3788503592627304, 'recall': 0.44971445523993175, 'f1-score': 0.41125203472599026, 'support': 53932}, '1': {'precision': 0.4847495024660379, 'recall': 0.3241855216711996, 'f1-score': 0.38853249185102984, 'support': 69124}, '2': {'precision': 0.3907877820632176, 'recall': 0.4820188469460292, 'f1-score': 0.4316353012225178, 'support': 54863}, 'accuracy': 0.4109060864775544, 'macro avg': {'precision': 0.4181292145973286, 'recall': 0.41863960795238686, 'f1-score': 0.4104732759331793, 'support': 177919}, 'weighted avg': {'precision': 0.4236746624674953, 'recall': 0.4109060864775544, 'f1-score': 0.4087105493765348, 'support': 177919}}
[[24254 11574 18104]
 [23593 22409 23122]
 [16173 12245 26445]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.062275
{'0': {'precision': 0.4442911877394636, 'recall': 0.4734607218683652, 'f1-score': 0.45841239721695126, 'support': 24492}, '1': {'precision': 0.4167008016852946, 'recall': 0.3001222236270915, 'f1-score': 0.3489317914543316, 'support': 23727}, '2': {'precision': 0.42385002603714633, 'recall': 0.5135226077812829, 'f1-score': 0.4643971091669837, 'support': 23775}, 'accuracy': 0.42956357474233964, 'macro avg': {'precision': 0.42828067182063484, 'recall': 0.4290351844255798, 'f1-score': 0.4239137659460888, 'support': 71994}, 'weighted avg': {'precision': 0.4284478437194083, 'recall': 0.42956357474233964, 'f1-score': 0.42430733559629324, 'support': 71994}}
[[11596  4929  7967]
 [ 7977  7121  8629]
 [ 6527  5039 12209]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.083462
{'0': {'precision': 0.4214234363767074, 'recall': 0.46048703849175177, 'f1-score': 0.4400900900900901, 'support': 6365}, '1': {'precision': 0.37687604224569204, 'recall': 0.24274973147153597, 'f1-score': 0.2952961672473868, 'support': 5586}, '2': {'precision': 0.4152105593966059, 'recall': 0.5037364648467287, 'f1-score': 0.4552094818081588, 'support': 6557}, 'accuracy': 0.4100929327858224, 'macro avg': {'precision': 0.40450334600633514, 'recall': 0.4023244116033388, 'f1-score': 0.39686524638187853, 'support': 18508}, 'weighted avg': {'precision': 0.40577725213344085, 'recall': 0.4100929327858224, 'f1-score': 0.4017455363023246, 'support': 18508}}
[[2931 1074 2360]
 [1938 1356 2292]
 [2086 1168 3303]]
training model: results/LILAK/W7/deepOF_L2/h50
Epoch 1/50
282/282 - 11s - loss: 3.3435 - accuracy50: 0.3372 - val_loss: 3.3133 - val_accuracy50: 0.3608 - 11s/epoch - 40ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3079 - accuracy50: 0.3522 - val_loss: 3.3058 - val_accuracy50: 0.3618 - 9s/epoch - 34ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2910 - accuracy50: 0.3648 - val_loss: 3.3000 - val_accuracy50: 0.3620 - 9s/epoch - 33ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2779 - accuracy50: 0.3736 - val_loss: 3.2943 - val_accuracy50: 0.3707 - 9s/epoch - 33ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2697 - accuracy50: 0.3811 - val_loss: 3.2953 - val_accuracy50: 0.3732 - 9s/epoch - 32ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2602 - accuracy50: 0.3875 - val_loss: 3.2932 - val_accuracy50: 0.3770 - 9s/epoch - 33ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2534 - accuracy50: 0.3923 - val_loss: 3.2917 - val_accuracy50: 0.3770 - 9s/epoch - 33ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2446 - accuracy50: 0.3983 - val_loss: 3.2932 - val_accuracy50: 0.3785 - 9s/epoch - 32ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2404 - accuracy50: 0.3986 - val_loss: 3.2914 - val_accuracy50: 0.3774 - 9s/epoch - 32ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2330 - accuracy50: 0.4049 - val_loss: 3.2921 - val_accuracy50: 0.3797 - 9s/epoch - 32ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2275 - accuracy50: 0.4085 - val_loss: 3.2980 - val_accuracy50: 0.3758 - 9s/epoch - 32ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2193 - accuracy50: 0.4110 - val_loss: 3.2964 - val_accuracy50: 0.3808 - 9s/epoch - 33ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2103 - accuracy50: 0.4170 - val_loss: 3.2988 - val_accuracy50: 0.3823 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.2029 - accuracy50: 0.4198 - val_loss: 3.3081 - val_accuracy50: 0.3815 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 3.1934 - accuracy50: 0.4254 - val_loss: 3.3097 - val_accuracy50: 0.3803 - 9s/epoch - 33ms/step
Epoch 16/50
282/282 - 9s - loss: 3.1850 - accuracy50: 0.4259 - val_loss: 3.3227 - val_accuracy50: 0.3757 - 9s/epoch - 34ms/step
Epoch 17/50
282/282 - 9s - loss: 3.1753 - accuracy50: 0.4355 - val_loss: 3.3233 - val_accuracy50: 0.3788 - 9s/epoch - 32ms/step
Epoch 18/50
282/282 - 9s - loss: 3.1647 - accuracy50: 0.4374 - val_loss: 3.3369 - val_accuracy50: 0.3734 - 9s/epoch - 33ms/step
Epoch 19/50
282/282 - 9s - loss: 3.1560 - accuracy50: 0.4413 - val_loss: 3.3374 - val_accuracy50: 0.3752 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h50
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0995955
{'0': {'precision': 0.3385607644072858, 'recall': 0.524906484945002, 'f1-score': 0.41162589760903817, 'support': 54002}, '1': {'precision': 0.4297952881406585, 'recall': 0.1261937144444932, 'f1-score': 0.19510264990503753, 'support': 68379}, '2': {'precision': 0.3606190212771699, 'recall': 0.4812560769203068, 'f1-score': 0.41229416528479423, 'support': 55538}, 'accuracy': 0.3580449530404285, 'macro avg': {'precision': 0.37632502460837136, 'recall': 0.37745209210326736, 'f1-score': 0.3396742375996233, 'support': 177919}, 'weighted avg': {'precision': 0.3805101737924774, 'recall': 0.3580449530404285, 'f1-score': 0.3286188612353191, 'support': 177919}}
[[28346  5505 20151]
 [32512  8629 27238]
 [22867  5943 26728]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0809108
{'0': {'precision': 0.4070664195611885, 'recall': 0.5535322331517762, 'f1-score': 0.4691332506545404, 'support': 24602}, '1': {'precision': 0.40319024769809364, 'recall': 0.13005103321341924, 'f1-score': 0.1966663503811241, 'support': 23906}, '2': {'precision': 0.39073599532907327, 'recall': 0.5129013029038576, 'f1-score': 0.44356071066924424, 'support': 23486}, 'accuracy': 0.3996583048587382, 'macro avg': {'precision': 0.4003308875294518, 'recall': 0.39882818975635104, 'f1-score': 0.3697867705683029, 'support': 71994}, 'weighted avg': {'precision': 0.40045197796779736, 'recall': 0.3996583048587382, 'f1-score': 0.37031681606233885, 'support': 71994}}
[[13618  2280  8704]
 [10718  3109 10079]
 [ 9118  2322 12046]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0957333
{'0': {'precision': 0.3816374269005848, 'recall': 0.5146687697160883, 'f1-score': 0.438280725319006, 'support': 6340}, '1': {'precision': 0.33235581622678395, 'recall': 0.12048192771084337, 'f1-score': 0.17685305591677503, 'support': 5644}, '2': {'precision': 0.39408493427704755, 'recall': 0.4779276517473942, 'f1-score': 0.43197561651426986, 'support': 6524}, 'accuracy': 0.38151069807650745, 'macro avg': {'precision': 0.3693593924681388, 'recall': 0.37102611639144195, 'f1-score': 0.34903646591668364, 'support': 18508}, 'weighted avg': {'precision': 0.3709967378731972, 'recall': 0.38151069807650745, 'f1-score': 0.3563360367546938, 'support': 18508}}
[[3263  654 2423]
 [2593  680 2371]
 [2694  712 3118]]
training model: results/LILAK/W7/deepOF_L2/h100
Epoch 1/50
282/282 - 11s - loss: 3.3383 - accuracy100: 0.3491 - val_loss: 3.3209 - val_accuracy100: 0.3596 - 11s/epoch - 40ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3069 - accuracy100: 0.3586 - val_loss: 3.3069 - val_accuracy100: 0.3602 - 9s/epoch - 32ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2922 - accuracy100: 0.3657 - val_loss: 3.2990 - val_accuracy100: 0.3664 - 9s/epoch - 33ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2810 - accuracy100: 0.3735 - val_loss: 3.2970 - val_accuracy100: 0.3695 - 9s/epoch - 33ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2742 - accuracy100: 0.3772 - val_loss: 3.2949 - val_accuracy100: 0.3723 - 9s/epoch - 33ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2704 - accuracy100: 0.3803 - val_loss: 3.2932 - val_accuracy100: 0.3726 - 9s/epoch - 33ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2645 - accuracy100: 0.3834 - val_loss: 3.2943 - val_accuracy100: 0.3743 - 9s/epoch - 33ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2576 - accuracy100: 0.3874 - val_loss: 3.2936 - val_accuracy100: 0.3816 - 9s/epoch - 33ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2528 - accuracy100: 0.3929 - val_loss: 3.2989 - val_accuracy100: 0.3773 - 9s/epoch - 33ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2482 - accuracy100: 0.3961 - val_loss: 3.2983 - val_accuracy100: 0.3819 - 9s/epoch - 32ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2416 - accuracy100: 0.3992 - val_loss: 3.2971 - val_accuracy100: 0.3829 - 9s/epoch - 33ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2364 - accuracy100: 0.4021 - val_loss: 3.3003 - val_accuracy100: 0.3777 - 9s/epoch - 33ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2307 - accuracy100: 0.4063 - val_loss: 3.3032 - val_accuracy100: 0.3807 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.2251 - accuracy100: 0.4089 - val_loss: 3.3078 - val_accuracy100: 0.3767 - 9s/epoch - 33ms/step
Epoch 15/50
282/282 - 9s - loss: 3.2176 - accuracy100: 0.4142 - val_loss: 3.3101 - val_accuracy100: 0.3782 - 9s/epoch - 33ms/step
Epoch 16/50
282/282 - 9s - loss: 3.2115 - accuracy100: 0.4165 - val_loss: 3.3176 - val_accuracy100: 0.3785 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h100
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1301289
{'0': {'precision': 0.31733514615907543, 'recall': 0.5280443430553723, 'f1-score': 0.3964303154259347, 'support': 53041}, '1': {'precision': 0.42875920084121977, 'recall': 0.022856582303315675, 'f1-score': 0.04339959021846145, 'support': 71358}, '2': {'precision': 0.31755867450934716, 'recall': 0.5094170403587444, 'f1-score': 0.39123228699551565, 'support': 53520}, 'accuracy': 0.31982531376637685, 'macro avg': {'precision': 0.3545510071698808, 'recall': 0.35343932190581073, 'f1-score': 0.2770207308799706, 'support': 177919}, 'weighted avg': {'precision': 0.36209124826910866, 'recall': 0.31982531376637685, 'f1-score': 0.25327660519290224, 'support': 177919}}
[[28008   935 24098]
 [35234  1631 34493]
 [25018  1238 27264]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010284
{'0': {'precision': 0.37780408071243377, 'recall': 0.5440525952680492, 'f1-score': 0.4459376299376299, 'support': 24641}, '1': {'precision': 0.39887352790578595, 'recall': 0.032678916016444334, 'f1-score': 0.060408669690977475, 'support': 23838}, '2': {'precision': 0.362242092774257, 'recall': 0.5323410588985754, 'f1-score': 0.43111998897919823, 'support': 23515}, 'accuracy': 0.3709059088257355, 'macro avg': {'precision': 0.37963990046415885, 'recall': 0.3696908567276897, 'f1-score': 0.3124887628692686, 'support': 71994}, 'weighted avg': {'precision': 0.3796974792710484, 'recall': 0.3709059088257355, 'f1-score': 0.3134449752511668, 'support': 71994}}
[[13406   597 10638]
 [11658   779 11401]
 [10420   577 12518]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095664
{'0': {'precision': 0.37689009252990296, 'recall': 0.5093792893091352, 'f1-score': 0.433231727089954, 'support': 6557}, '1': {'precision': 0.2954856361149111, 'recall': 0.041755267736323216, 'f1-score': 0.07317073170731707, 'support': 5173}, '2': {'precision': 0.3847448121144139, 'recall': 0.5060489820005901, 'f1-score': 0.43713757726374813, 'support': 6778}, 'accuracy': 0.3774583963691377, 'macro avg': {'precision': 0.3523735135864093, 'recall': 0.35239451301534946, 'f1-score': 0.3145133453536731, 'support': 18508}, 'weighted avg': {'precision': 0.3570140408932627, 'recall': 0.3774583963691377, 'f1-score': 0.334024807020989, 'support': 18508}}
[[3340  242 2975]
 [2447  216 2510]
 [3075  273 3430]]
training model: results/LILAK/W7/deepOF_L2/h200
Epoch 1/50
282/282 - 12s - loss: 3.3439 - accuracy200: 0.3381 - val_loss: 3.3327 - val_accuracy200: 0.3404 - 12s/epoch - 41ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3160 - accuracy200: 0.3476 - val_loss: 3.3230 - val_accuracy200: 0.3382 - 9s/epoch - 32ms/step
Epoch 3/50
282/282 - 9s - loss: 3.3009 - accuracy200: 0.3551 - val_loss: 3.3194 - val_accuracy200: 0.3414 - 9s/epoch - 32ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2950 - accuracy200: 0.3569 - val_loss: 3.3167 - val_accuracy200: 0.3405 - 9s/epoch - 33ms/step
Epoch 5/50
282/282 - 10s - loss: 3.2864 - accuracy200: 0.3635 - val_loss: 3.3114 - val_accuracy200: 0.3449 - 10s/epoch - 34ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2812 - accuracy200: 0.3680 - val_loss: 3.3099 - val_accuracy200: 0.3443 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2765 - accuracy200: 0.3699 - val_loss: 3.3106 - val_accuracy200: 0.3513 - 9s/epoch - 31ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2711 - accuracy200: 0.3756 - val_loss: 3.3101 - val_accuracy200: 0.3532 - 9s/epoch - 31ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2657 - accuracy200: 0.3796 - val_loss: 3.3147 - val_accuracy200: 0.3515 - 9s/epoch - 31ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2590 - accuracy200: 0.3841 - val_loss: 3.3138 - val_accuracy200: 0.3558 - 9s/epoch - 32ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2551 - accuracy200: 0.3883 - val_loss: 3.3129 - val_accuracy200: 0.3549 - 9s/epoch - 32ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2493 - accuracy200: 0.3929 - val_loss: 3.3172 - val_accuracy200: 0.3578 - 9s/epoch - 32ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2438 - accuracy200: 0.3952 - val_loss: 3.3208 - val_accuracy200: 0.3565 - 9s/epoch - 31ms/step
Epoch 14/50
282/282 - 9s - loss: 3.2387 - accuracy200: 0.3975 - val_loss: 3.3236 - val_accuracy200: 0.3544 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 3.2315 - accuracy200: 0.4033 - val_loss: 3.3296 - val_accuracy200: 0.3541 - 9s/epoch - 32ms/step
Epoch 16/50
282/282 - 9s - loss: 3.2258 - accuracy200: 0.4061 - val_loss: 3.3296 - val_accuracy200: 0.3584 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h200
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1029958
{'0': {'precision': 0.3241071192534433, 'recall': 0.21670349094122845, 'f1-score': 0.25974025974025977, 'support': 56575}, '1': {'precision': 0.3499707355140795, 'recall': 0.348418633258878, 'f1-score': 0.34919295968853925, 'support': 61782}, '2': {'precision': 0.34171078082052325, 'recall': 0.4508411403243679, 'f1-score': 0.3887626134669118, 'support': 59562}, 'accuracy': 0.34082363322635584, 'macro avg': {'precision': 0.338596211862682, 'recall': 0.3386544215081581, 'f1-score': 0.33256527763190363, 'support': 177919}, 'weighted avg': {'precision': 0.3389813891744357, 'recall': 0.34082363322635584, 'f1-score': 0.33399537662418705, 'support': 177919}}
[[12260 19493 24822]
 [13347 21526 26909]
 [12220 20489 26853]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0938156
{'0': {'precision': 0.3924490182461014, 'recall': 0.25247766043866776, 'f1-score': 0.3072740305000124, 'support': 24620}, '1': {'precision': 0.3597800803552548, 'recall': 0.35686718684453395, 'f1-score': 0.358317713708064, 'support': 23838}, '2': {'precision': 0.3575207628422024, 'recall': 0.49383922501699523, 'f1-score': 0.4147664418513364, 'support': 23536}, 'accuracy': 0.365947162263522, 'macro avg': {'precision': 0.3699166204811862, 'recall': 0.3677280241000656, 'f1-score': 0.3601193953531376, 'support': 71994}, 'weighted avg': {'precision': 0.370213365821897, 'recall': 0.365947162263522, 'f1-score': 0.35931615503647785, 'support': 71994}}
[[ 6216  7878 10526]
 [ 4970  8507 10361]
 [ 4653  7260 11623]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1031537
{'0': {'precision': 0.3573962027957438, 'recall': 0.26950912523599746, 'f1-score': 0.30729213382366133, 'support': 6356}, '1': {'precision': 0.31761565836298933, 'recall': 0.31211750305997554, 'f1-score': 0.3148425787106447, 'support': 5719}, '2': {'precision': 0.3598517603458925, 'recall': 0.45282138970931135, 'f1-score': 0.4010187224669604, 'support': 6433}, 'accuracy': 0.3463907499459693, 'macro avg': {'precision': 0.3449545405015419, 'recall': 0.3448160060017615, 'f1-score': 0.3410511450004221, 'support': 18508}, 'weighted avg': {'precision': 0.34595745566526964, 'recall': 0.3463907499459693, 'f1-score': 0.342202666514984, 'support': 18508}}
[[1713 1909 2734]
 [1486 1785 2448]
 [1594 1926 2913]]
training model: results/LILAK/W7/deepOF_L2/h300
Epoch 1/50
282/282 - 11s - loss: 3.3445 - accuracy300: 0.3392 - val_loss: 3.3439 - val_accuracy300: 0.3360 - 11s/epoch - 39ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3146 - accuracy300: 0.3519 - val_loss: 3.3248 - val_accuracy300: 0.3409 - 9s/epoch - 33ms/step
Epoch 3/50
282/282 - 9s - loss: 3.3013 - accuracy300: 0.3580 - val_loss: 3.3166 - val_accuracy300: 0.3461 - 9s/epoch - 32ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2918 - accuracy300: 0.3633 - val_loss: 3.3150 - val_accuracy300: 0.3448 - 9s/epoch - 32ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2847 - accuracy300: 0.3679 - val_loss: 3.3130 - val_accuracy300: 0.3479 - 9s/epoch - 32ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2781 - accuracy300: 0.3723 - val_loss: 3.3117 - val_accuracy300: 0.3542 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2742 - accuracy300: 0.3761 - val_loss: 3.3154 - val_accuracy300: 0.3513 - 9s/epoch - 32ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2679 - accuracy300: 0.3804 - val_loss: 3.3118 - val_accuracy300: 0.3528 - 9s/epoch - 32ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2633 - accuracy300: 0.3848 - val_loss: 3.3136 - val_accuracy300: 0.3549 - 9s/epoch - 33ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2587 - accuracy300: 0.3855 - val_loss: 3.3160 - val_accuracy300: 0.3540 - 9s/epoch - 32ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2531 - accuracy300: 0.3908 - val_loss: 3.3135 - val_accuracy300: 0.3561 - 9s/epoch - 34ms/step
Epoch 12/50
282/282 - 10s - loss: 3.2482 - accuracy300: 0.3924 - val_loss: 3.3208 - val_accuracy300: 0.3544 - 10s/epoch - 34ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2432 - accuracy300: 0.3976 - val_loss: 3.3197 - val_accuracy300: 0.3549 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.2397 - accuracy300: 0.3974 - val_loss: 3.3213 - val_accuracy300: 0.3571 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 3.2298 - accuracy300: 0.4038 - val_loss: 3.3340 - val_accuracy300: 0.3516 - 9s/epoch - 32ms/step
Epoch 16/50
282/282 - 9s - loss: 3.2257 - accuracy300: 0.4072 - val_loss: 3.3311 - val_accuracy300: 0.3580 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h300
Evaluating performance on  test set...
695/695 - 11s - 11s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1077378
{'0': {'precision': 0.29627448881276097, 'recall': 0.2088442817794212, 'f1-score': 0.24499280734757112, 'support': 53006}, '1': {'precision': 0.4000378143316317, 'recall': 0.15430505112384954, 'f1-score': 0.22270641236158478, 'support': 68559}, '2': {'precision': 0.32170712470423274, 'recall': 0.6514178230471661, 'f1-score': 0.430706776797447, 'support': 56354}, 'accuracy': 0.3280088129991738, 'macro avg': {'precision': 0.33933980928287516, 'recall': 0.3381890519834789, 'f1-score': 0.29946866550220097, 'support': 177919}, 'weighted avg': {'precision': 0.34431399329107, 'recall': 0.3280088129991738, 'f1-score': 0.2952279822335252, 'support': 177919}}
[[11070  7777 34159]
 [14739 10579 43241]
 [11555  8089 36710]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.094385
{'0': {'precision': 0.40048466296792296, 'recall': 0.255481876245881, 'f1-score': 0.31195668372162344, 'support': 24581}, '1': {'precision': 0.3773565883657627, 'recall': 0.15676830289830793, 'f1-score': 0.2215120579967451, 'support': 23876}, '2': {'precision': 0.34978661033754366, 'recall': 0.6894676466839444, 'f1-score': 0.46411462727545716, 'support': 23537}, 'accuracy': 0.36462760785621023, 'macro avg': {'precision': 0.3758759538904098, 'recall': 0.36723927527604444, 'f1-score': 0.33252778966460855, 'support': 71994}, 'weighted avg': {'precision': 0.3762397818116819, 'recall': 0.36462760785621023, 'f1-score': 0.33170674113778853, 'support': 71994}}
[[ 6280  3293 15008]
 [ 4975  3743 15158]
 [ 4426  2883 16228]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1035715
{'0': {'precision': 0.3524590163934426, 'recall': 0.24602670057215512, 'f1-score': 0.2897791089479596, 'support': 6292}, '1': {'precision': 0.32308936514355036, 'recall': 0.13735602544266803, 'f1-score': 0.19276236429433055, 'support': 5817}, '2': {'precision': 0.3534312462423774, 'recall': 0.6430692295671199, 'f1-score': 0.45615785389646374, 'support': 6399}, 'accuracy': 0.34914631510698074, 'macro avg': {'precision': 0.3429932092597901, 'recall': 0.3421506518606477, 'f1-score': 0.31289977571291794, 'support': 18508}, 'weighted avg': {'precision': 0.3435643782630509, 'recall': 0.34914631510698074, 'f1-score': 0.31681126721872455, 'support': 18508}}
[[1548  838 3906]
 [1396  799 3622]
 [1448  836 4115]]
training model: results/LILAK/W7/deepOF_L2/h500
Epoch 1/50
282/282 - 11s - loss: 3.3430 - accuracy500: 0.3389 - val_loss: 3.3377 - val_accuracy500: 0.3383 - 11s/epoch - 40ms/step
Epoch 2/50
282/282 - 10s - loss: 3.3186 - accuracy500: 0.3475 - val_loss: 3.3218 - val_accuracy500: 0.3437 - 10s/epoch - 34ms/step
Epoch 3/50
282/282 - 9s - loss: 3.3035 - accuracy500: 0.3520 - val_loss: 3.3172 - val_accuracy500: 0.3472 - 9s/epoch - 33ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2947 - accuracy500: 0.3564 - val_loss: 3.3149 - val_accuracy500: 0.3488 - 9s/epoch - 33ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2871 - accuracy500: 0.3647 - val_loss: 3.3135 - val_accuracy500: 0.3491 - 9s/epoch - 33ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2838 - accuracy500: 0.3655 - val_loss: 3.3153 - val_accuracy500: 0.3462 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2794 - accuracy500: 0.3702 - val_loss: 3.3116 - val_accuracy500: 0.3568 - 9s/epoch - 33ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2740 - accuracy500: 0.3748 - val_loss: 3.3149 - val_accuracy500: 0.3532 - 9s/epoch - 33ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2680 - accuracy500: 0.3793 - val_loss: 3.3146 - val_accuracy500: 0.3525 - 9s/epoch - 32ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2639 - accuracy500: 0.3833 - val_loss: 3.3133 - val_accuracy500: 0.3543 - 9s/epoch - 33ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2586 - accuracy500: 0.3853 - val_loss: 3.3217 - val_accuracy500: 0.3489 - 9s/epoch - 33ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2533 - accuracy500: 0.3899 - val_loss: 3.3223 - val_accuracy500: 0.3519 - 9s/epoch - 32ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2489 - accuracy500: 0.3922 - val_loss: 3.3208 - val_accuracy500: 0.3551 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 10s - loss: 3.2425 - accuracy500: 0.3979 - val_loss: 3.3255 - val_accuracy500: 0.3520 - 10s/epoch - 34ms/step
Epoch 15/50
282/282 - 9s - loss: 3.2341 - accuracy500: 0.4020 - val_loss: 3.3359 - val_accuracy500: 0.3544 - 9s/epoch - 33ms/step
Epoch 16/50
282/282 - 9s - loss: 3.2297 - accuracy500: 0.4034 - val_loss: 3.3386 - val_accuracy500: 0.3531 - 9s/epoch - 33ms/step
Epoch 17/50
282/282 - 10s - loss: 3.2242 - accuracy500: 0.4060 - val_loss: 3.3509 - val_accuracy500: 0.3574 - 10s/epoch - 34ms/step
testing model: results/LILAK/W7/deepOF_L2/h500
Evaluating performance on  test set...
695/695 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.106607
{'0': {'precision': 0.27351611194850695, 'recall': 0.13539839070724183, 'f1-score': 0.1811314646451021, 'support': 49587}, '1': {'precision': 0.424162432081656, 'recall': 0.26976509926269987, 'f1-score': 0.3297872340425532, 'support': 71477}, '2': {'precision': 0.3218703955964527, 'recall': 0.6109225222056107, 'f1-score': 0.4216109924257137, 'support': 56855}, 'accuracy': 0.3413351019284056, 'macro avg': {'precision': 0.3398496465422052, 'recall': 0.3386953373918508, 'f1-score': 0.310843230371123, 'support': 177919}, 'weighted avg': {'precision': 0.34948849163230156, 'recall': 0.3413351019284056, 'f1-score': 0.3176988463254639, 'support': 177919}}
[[ 6714 12270 30603]
 [ 9619 19282 42576]
 [ 8214 13907 34734]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942137
{'0': {'precision': 0.4152361510624478, 'recall': 0.18228105906313646, 'f1-score': 0.2533472981006029, 'support': 24550}, '1': {'precision': 0.3771213073538655, 'recall': 0.272108843537415, 'f1-score': 0.3161222339304531, 'support': 24255}, '2': {'precision': 0.34650928721749474, 'recall': 0.653240760705507, 'f1-score': 0.4528211643374934, 'support': 23189}, 'accuracy': 0.3642386865572131, 'macro avg': {'precision': 0.37962224854460275, 'recall': 0.36921022110201945, 'f1-score': 0.34076356545618314, 'support': 71994}, 'weighted avg': {'precision': 0.380258475424863, 'recall': 0.3642386865572131, 'f1-score': 0.3387461584600811, 'support': 71994}}
[[ 4475  5863 14212]
 [ 3299  6600 14356]
 [ 3003  5038 15148]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1035339
{'0': {'precision': 0.3389270976616231, 'recall': 0.20796758946657665, 'f1-score': 0.25776754890678943, 'support': 5924}, '1': {'precision': 0.35410484668644904, 'recall': 0.2300771208226221, 'f1-score': 0.2789248149590962, 'support': 6224}, '2': {'precision': 0.35404931203250534, 'recall': 0.6028301886792453, 'f1-score': 0.44609924952004193, 'support': 6360}, 'accuracy': 0.35109141992651827, 'macro avg': {'precision': 0.3490270854601925, 'recall': 0.34695829965614805, 'f1-score': 0.3275972044619759, 'support': 18508}, 'weighted avg': {'precision': 0.34922770244492374, 'recall': 0.35109141992651827, 'f1-score': 0.32959986141002284, 'support': 18508}}
[[1232 1285 3407]
 [1204 1432 3588]
 [1199 1327 3834]]
training model: results/LILAK/W7/deepOF_L2/h1000
Epoch 1/50
282/282 - 13s - loss: 3.3503 - accuracy1000: 0.3398 - val_loss: 3.3406 - val_accuracy1000: 0.3431 - 13s/epoch - 45ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3301 - accuracy1000: 0.3425 - val_loss: 3.3238 - val_accuracy1000: 0.3444 - 9s/epoch - 33ms/step
Epoch 3/50
282/282 - 9s - loss: 3.3157 - accuracy1000: 0.3490 - val_loss: 3.3162 - val_accuracy1000: 0.3480 - 9s/epoch - 32ms/step
Epoch 4/50
282/282 - 9s - loss: 3.3056 - accuracy1000: 0.3549 - val_loss: 3.3110 - val_accuracy1000: 0.3529 - 9s/epoch - 32ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2974 - accuracy1000: 0.3578 - val_loss: 3.3126 - val_accuracy1000: 0.3456 - 9s/epoch - 32ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2923 - accuracy1000: 0.3619 - val_loss: 3.3156 - val_accuracy1000: 0.3453 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2870 - accuracy1000: 0.3645 - val_loss: 3.3142 - val_accuracy1000: 0.3444 - 9s/epoch - 33ms/step
Epoch 8/50
282/282 - 10s - loss: 3.2823 - accuracy1000: 0.3693 - val_loss: 3.3121 - val_accuracy1000: 0.3484 - 10s/epoch - 34ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2790 - accuracy1000: 0.3708 - val_loss: 3.3139 - val_accuracy1000: 0.3508 - 9s/epoch - 34ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2745 - accuracy1000: 0.3737 - val_loss: 3.3150 - val_accuracy1000: 0.3547 - 9s/epoch - 33ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2693 - accuracy1000: 0.3768 - val_loss: 3.3146 - val_accuracy1000: 0.3555 - 9s/epoch - 33ms/step
Epoch 12/50
282/282 - 10s - loss: 3.2647 - accuracy1000: 0.3803 - val_loss: 3.3203 - val_accuracy1000: 0.3485 - 10s/epoch - 34ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2603 - accuracy1000: 0.3823 - val_loss: 3.3201 - val_accuracy1000: 0.3548 - 9s/epoch - 33ms/step
Epoch 14/50
282/282 - 9s - loss: 3.2553 - accuracy1000: 0.3861 - val_loss: 3.3248 - val_accuracy1000: 0.3536 - 9s/epoch - 33ms/step
testing model: results/LILAK/W7/deepOF_L2/h1000
Evaluating performance on  test set...
695/695 - 12s - 12s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989462
{'0': {'precision': 0.2692497706260145, 'recall': 0.0757169792597003, 'f1-score': 0.11819561917154629, 'support': 50385}, '1': {'precision': 0.39285151590177586, 'recall': 0.505795757505506, 'f1-score': 0.44222607902504524, 'support': 69016}, '2': {'precision': 0.3356967366340864, 'recall': 0.42962849037902867, 'f1-score': 0.376898283486995, 'support': 58518}, 'accuracy': 0.3589498592055936, 'macro avg': {'precision': 0.33259934105395894, 'recall': 0.337047075714745, 'f1-score': 0.3124399938945288, 'support': 177919}, 'weighted avg': {'precision': 0.3390503068746012, 'recall': 0.3589498592055936, 'f1-score': 0.32897720364347177, 'support': 177919}}
[[ 3815 25409 21161]
 [ 5518 34908 28590]
 [ 4836 28541 25141]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1016477
{'0': {'precision': 0.40046838407494145, 'recall': 0.10361961703159085, 'f1-score': 0.16463943002021889, 'support': 24754}, '1': {'precision': 0.3602040218092279, 'recall': 0.4965851687209537, 'f1-score': 0.417540223245383, 'support': 24745}, '2': {'precision': 0.33842732327243846, 'recall': 0.47352745054456546, 'f1-score': 0.39473781730591073, 'support': 22495}, 'accuracy': 0.35426563324721505, 'macro avg': {'precision': 0.36636657638553594, 'recall': 0.35791074543237, 'f1-score': 0.3256391568571709, 'support': 71994}, 'weighted avg': {'precision': 0.36724401389107353, 'recall': 0.35426563324721505, 'f1-score': 0.323459517115648, 'support': 71994}}
[[ 2565 11832 10357]
 [ 1991 12288 10466]
 [ 1849  9994 10652]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1043235
{'0': {'precision': 0.310683585755219, 'recall': 0.13299456807429472, 'f1-score': 0.18625766871165644, 'support': 5707}, '1': {'precision': 0.3685430890119799, 'recall': 0.4311981914091937, 'f1-score': 0.39741630782053056, 'support': 6635}, '2': {'precision': 0.33582269332690917, 'recall': 0.4521569899448589, 'f1-score': 0.38540226707215924, 'support': 6166}, 'accuracy': 0.34622865787767454, 'macro avg': {'precision': 0.33834978936470267, 'recall': 0.3387832498094491, 'f1-score': 0.3230254145347821, 'support': 18508}, 'weighted avg': {'precision': 0.33980102369533405, 'recall': 0.34622865787767454, 'f1-score': 0.3283023609516737, 'support': 18508}}
[[ 759 2351 2597]
 [ 857 2861 2917]
 [ 827 2551 2788]]
training model: results/LILAK/W7/deepVOL_L2/h10
Epoch 1/50
282/282 - 12s - loss: 3.3464 - accuracy10: 0.3479 - val_loss: 3.3188 - val_accuracy10: 0.3744 - 12s/epoch - 42ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2902 - accuracy10: 0.3737 - val_loss: 3.2840 - val_accuracy10: 0.3806 - 9s/epoch - 31ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2552 - accuracy10: 0.3934 - val_loss: 3.2657 - val_accuracy10: 0.3824 - 9s/epoch - 31ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2275 - accuracy10: 0.4092 - val_loss: 3.2224 - val_accuracy10: 0.4092 - 9s/epoch - 31ms/step
Epoch 5/50
282/282 - 9s - loss: 3.1984 - accuracy10: 0.4258 - val_loss: 3.2238 - val_accuracy10: 0.4166 - 9s/epoch - 30ms/step
Epoch 6/50
282/282 - 8s - loss: 3.1789 - accuracy10: 0.4372 - val_loss: 3.2144 - val_accuracy10: 0.4227 - 8s/epoch - 29ms/step
Epoch 7/50
282/282 - 8s - loss: 3.1535 - accuracy10: 0.4481 - val_loss: 3.1935 - val_accuracy10: 0.4309 - 8s/epoch - 29ms/step
Epoch 8/50
282/282 - 8s - loss: 3.1324 - accuracy10: 0.4584 - val_loss: 3.1951 - val_accuracy10: 0.4360 - 8s/epoch - 29ms/step
Epoch 9/50
282/282 - 9s - loss: 3.1110 - accuracy10: 0.4669 - val_loss: 3.1680 - val_accuracy10: 0.4495 - 9s/epoch - 30ms/step
Epoch 10/50
282/282 - 8s - loss: 3.0980 - accuracy10: 0.4721 - val_loss: 3.2141 - val_accuracy10: 0.4481 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 8s - loss: 3.0830 - accuracy10: 0.4783 - val_loss: 3.1927 - val_accuracy10: 0.4481 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.0667 - accuracy10: 0.4812 - val_loss: 3.2024 - val_accuracy10: 0.4457 - 8s/epoch - 30ms/step
Epoch 13/50
282/282 - 9s - loss: 3.0550 - accuracy10: 0.4855 - val_loss: 3.1779 - val_accuracy10: 0.4550 - 9s/epoch - 30ms/step
Epoch 14/50
282/282 - 9s - loss: 3.0400 - accuracy10: 0.4921 - val_loss: 3.1620 - val_accuracy10: 0.4616 - 9s/epoch - 31ms/step
Epoch 15/50
282/282 - 8s - loss: 3.0266 - accuracy10: 0.4957 - val_loss: 3.1525 - val_accuracy10: 0.4627 - 8s/epoch - 30ms/step
Epoch 16/50
282/282 - 8s - loss: 3.0169 - accuracy10: 0.4982 - val_loss: 3.1608 - val_accuracy10: 0.4641 - 8s/epoch - 29ms/step
Epoch 17/50
282/282 - 8s - loss: 3.0050 - accuracy10: 0.5026 - val_loss: 3.1585 - val_accuracy10: 0.4654 - 8s/epoch - 29ms/step
Epoch 18/50
282/282 - 8s - loss: 2.9954 - accuracy10: 0.5067 - val_loss: 3.1781 - val_accuracy10: 0.4686 - 8s/epoch - 30ms/step
Epoch 19/50
282/282 - 8s - loss: 2.9844 - accuracy10: 0.5097 - val_loss: 3.1956 - val_accuracy10: 0.4635 - 8s/epoch - 30ms/step
Epoch 20/50
282/282 - 9s - loss: 2.9789 - accuracy10: 0.5109 - val_loss: 3.1747 - val_accuracy10: 0.4666 - 9s/epoch - 31ms/step
Epoch 21/50
282/282 - 8s - loss: 2.9685 - accuracy10: 0.5135 - val_loss: 3.1864 - val_accuracy10: 0.4614 - 8s/epoch - 29ms/step
Epoch 22/50
282/282 - 8s - loss: 2.9632 - accuracy10: 0.5145 - val_loss: 3.1731 - val_accuracy10: 0.4681 - 8s/epoch - 30ms/step
Epoch 23/50
282/282 - 8s - loss: 2.9568 - accuracy10: 0.5160 - val_loss: 3.1738 - val_accuracy10: 0.4667 - 8s/epoch - 30ms/step
Epoch 24/50
282/282 - 8s - loss: 2.9487 - accuracy10: 0.5178 - val_loss: 3.1647 - val_accuracy10: 0.4659 - 8s/epoch - 30ms/step
Epoch 25/50
282/282 - 9s - loss: 2.9401 - accuracy10: 0.5202 - val_loss: 3.1739 - val_accuracy10: 0.4627 - 9s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h10
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0015663
{'0': {'precision': 0.4349789283564118, 'recall': 0.5470583781328083, 'f1-score': 0.4846228661501828, 'support': 52828}, '1': {'precision': 0.584351516462129, 'recall': 0.5944017487661025, 'f1-score': 0.5893337876980747, 'support': 72737}, '2': {'precision': 0.4873853211009174, 'recall': 0.34903264004278156, 'f1-score': 0.4067664570697234, 'support': 52359}, 'accuracy': 0.5081383062431151, 'macro avg': {'precision': 0.5022385886398194, 'recall': 0.4968309223138975, 'f1-score': 0.4935743703059936, 'support': 177924}, 'weighted avg': {'precision': 0.5114658568132536, 'recall': 0.5081383062431151, 'f1-score': 0.5045182966575075, 'support': 177924}}
[[28900 14403  9525]
 [19806 43235  9696]
 [17734 16350 18275]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0230315
{'0': {'precision': 0.44778761061946903, 'recall': 0.5523780983774991, 'f1-score': 0.49461417564304055, 'support': 23359}, '1': {'precision': 0.5072509833525368, 'recall': 0.49793291731669265, 'f1-score': 0.5025487610462712, 'support': 25640}, '2': {'precision': 0.4875638463246724, 'recall': 0.3818758968561117, 'f1-score': 0.4282962276573435, 'support': 22997}, 'accuracy': 0.4785265848102672, 'macro avg': {'precision': 0.48086748009889274, 'recall': 0.47739563751676783, 'f1-score': 0.4751530547822184, 'support': 71996}, 'weighted avg': {'precision': 0.4816697008659886, 'recall': 0.4785265848102672, 'f1-score': 0.4762566129994459, 'support': 71996}}
[[12903  5796  4660]
 [ 8303 12767  4570]
 [ 7609  6606  8782]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0482887
{'0': {'precision': 0.41362367392518146, 'recall': 0.6311126256602487, 'f1-score': 0.49973016729627634, 'support': 5869}, '1': {'precision': 0.5209656925031766, 'recall': 0.4455829840086943, 'f1-score': 0.4803347280334727, 'support': 6441}, '2': {'precision': 0.49010880316518296, 'recall': 0.3197805743788319, 'f1-score': 0.38703378246436243, 'support': 6198}, 'accuracy': 0.46228657877674517, 'macro avg': {'precision': 0.4748993898645137, 'recall': 0.46549206134925836, 'f1-score': 0.4556995592647038, 'support': 18508}, 'weighted avg': {'precision': 0.47659345848809453, 'recall': 0.46228657877674517, 'f1-score': 0.45524031331529946, 'support': 18508}}
[[3704 1119 1046]
 [2555 2870 1016]
 [2696 1520 1982]]
training model: results/LILAK/W7/deepVOL_L2/h20
Epoch 1/50
282/282 - 11s - loss: 3.3437 - accuracy20: 0.3480 - val_loss: 3.3213 - val_accuracy20: 0.3623 - 11s/epoch - 41ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2892 - accuracy20: 0.3731 - val_loss: 3.2908 - val_accuracy20: 0.3799 - 9s/epoch - 31ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2580 - accuracy20: 0.3913 - val_loss: 3.2896 - val_accuracy20: 0.3862 - 8s/epoch - 30ms/step
Epoch 4/50
282/282 - 8s - loss: 3.2407 - accuracy20: 0.4038 - val_loss: 3.2504 - val_accuracy20: 0.4016 - 8s/epoch - 30ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2252 - accuracy20: 0.4111 - val_loss: 3.2578 - val_accuracy20: 0.4074 - 8s/epoch - 30ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2088 - accuracy20: 0.4231 - val_loss: 3.2525 - val_accuracy20: 0.4114 - 9s/epoch - 31ms/step
Epoch 7/50
282/282 - 9s - loss: 3.1986 - accuracy20: 0.4284 - val_loss: 3.2486 - val_accuracy20: 0.4204 - 9s/epoch - 31ms/step
Epoch 8/50
282/282 - 9s - loss: 3.1824 - accuracy20: 0.4377 - val_loss: 3.2322 - val_accuracy20: 0.4249 - 9s/epoch - 31ms/step
Epoch 9/50
282/282 - 8s - loss: 3.1674 - accuracy20: 0.4439 - val_loss: 3.2448 - val_accuracy20: 0.4296 - 8s/epoch - 29ms/step
Epoch 10/50
282/282 - 8s - loss: 3.1550 - accuracy20: 0.4481 - val_loss: 3.2480 - val_accuracy20: 0.4264 - 8s/epoch - 29ms/step
Epoch 11/50
282/282 - 8s - loss: 3.1427 - accuracy20: 0.4558 - val_loss: 3.2717 - val_accuracy20: 0.4258 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.1302 - accuracy20: 0.4595 - val_loss: 3.3063 - val_accuracy20: 0.4248 - 8s/epoch - 29ms/step
Epoch 13/50
282/282 - 8s - loss: 3.1193 - accuracy20: 0.4623 - val_loss: 3.2770 - val_accuracy20: 0.4286 - 8s/epoch - 29ms/step
Epoch 14/50
282/282 - 9s - loss: 3.1104 - accuracy20: 0.4641 - val_loss: 3.2874 - val_accuracy20: 0.4253 - 9s/epoch - 31ms/step
Epoch 15/50
282/282 - 8s - loss: 3.1011 - accuracy20: 0.4659 - val_loss: 3.2960 - val_accuracy20: 0.4297 - 8s/epoch - 29ms/step
Epoch 16/50
282/282 - 9s - loss: 3.0910 - accuracy20: 0.4711 - val_loss: 3.2913 - val_accuracy20: 0.4268 - 9s/epoch - 30ms/step
Epoch 17/50
282/282 - 8s - loss: 3.0881 - accuracy20: 0.4713 - val_loss: 3.2921 - val_accuracy20: 0.4279 - 8s/epoch - 30ms/step
Epoch 18/50
282/282 - 8s - loss: 3.0843 - accuracy20: 0.4743 - val_loss: 3.2934 - val_accuracy20: 0.4249 - 8s/epoch - 29ms/step
testing model: results/LILAK/W7/deepVOL_L2/h20
Evaluating performance on  test set...
696/696 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0406584
{'0': {'precision': 0.435447097921014, 'recall': 0.4118603801169591, 'f1-score': 0.42332544423156393, 'support': 54720}, '1': {'precision': 0.5220382940997447, 'recall': 0.5794096049346453, 'f1-score': 0.5492297947279398, 'support': 68090}, '2': {'precision': 0.42905425437296174, 'recall': 0.3938745146423776, 'f1-score': 0.4107124275132676, 'support': 55114}, 'accuracy': 0.47040871383287247, 'macro avg': {'precision': 0.4621798821312401, 'recall': 0.4617148332313274, 'f1-score': 0.4610892221575904, 'support': 177924}, 'weighted avg': {'precision': 0.46660455486050734, 'recall': 0.47040871383287247, 'f1-score': 0.467600940633882, 'support': 177924}}
[[22537 17854 14329]
 [14080 39452 14558]
 [15139 18267 21708]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0662507
{'0': {'precision': 0.42207454261579724, 'recall': 0.43508583690987124, 'f1-score': 0.42848143707707625, 'support': 24232}, '1': {'precision': 0.452755905511811, 'recall': 0.4151280029874279, 'f1-score': 0.43312625814411565, 'support': 24101}, '2': {'precision': 0.417914041494442, 'recall': 0.4400963529560918, 'f1-score': 0.4287184553950023, 'support': 23663}, 'accuracy': 0.43005166953719653, 'macro avg': {'precision': 0.4309148298740168, 'recall': 0.430103397617797, 'f1-score': 0.43010871687206476, 'support': 71996}, 'weighted avg': {'precision': 0.43097783709218757, 'recall': 0.43005166953719653, 'f1-score': 0.4301142138562557, 'support': 71996}}
[[10543  6093  7596]
 [ 7187 10005  6909]
 [ 7249  6000 10414]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0763937
{'0': {'precision': 0.3981805458362491, 'recall': 0.5505563618771165, 'f1-score': 0.4621319796954315, 'support': 6201}, '1': {'precision': 0.45377218934911245, 'recall': 0.4151581796650313, 'f1-score': 0.43360720911741324, 'support': 5911}, '2': {'precision': 0.43305346884666374, 'recall': 0.3064415259537211, 'f1-score': 0.3589086247939938, 'support': 6396}, 'accuracy': 0.42295223687054245, 'macro avg': {'precision': 0.4283354013440084, 'recall': 0.424052022498623, 'f1-score': 0.41821593786894623, 'support': 18508}, 'weighted avg': {'precision': 0.4279865443438754, 'recall': 0.42295223687054245, 'f1-score': 0.41734991265219284, 'support': 18508}}
[[3414 1395 1392]
 [2283 2454 1174]
 [2877 1559 1960]]
training model: results/LILAK/W7/deepVOL_L2/h30
Epoch 1/50
282/282 - 11s - loss: 3.3470 - accuracy30: 0.3506 - val_loss: 3.3301 - val_accuracy30: 0.3577 - 11s/epoch - 38ms/step
Epoch 2/50
282/282 - 8s - loss: 3.3109 - accuracy30: 0.3558 - val_loss: 3.3200 - val_accuracy30: 0.3549 - 8s/epoch - 30ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2837 - accuracy30: 0.3696 - val_loss: 3.2912 - val_accuracy30: 0.3764 - 9s/epoch - 31ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2645 - accuracy30: 0.3830 - val_loss: 3.2819 - val_accuracy30: 0.3889 - 9s/epoch - 30ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2536 - accuracy30: 0.3941 - val_loss: 3.2741 - val_accuracy30: 0.3911 - 9s/epoch - 30ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2394 - accuracy30: 0.4022 - val_loss: 3.2693 - val_accuracy30: 0.3960 - 8s/epoch - 29ms/step
Epoch 7/50
282/282 - 8s - loss: 3.2237 - accuracy30: 0.4091 - val_loss: 3.2732 - val_accuracy30: 0.3990 - 8s/epoch - 30ms/step
Epoch 8/50
282/282 - 8s - loss: 3.2135 - accuracy30: 0.4166 - val_loss: 3.2721 - val_accuracy30: 0.3985 - 8s/epoch - 30ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2024 - accuracy30: 0.4220 - val_loss: 3.2525 - val_accuracy30: 0.4092 - 9s/epoch - 30ms/step
Epoch 10/50
282/282 - 8s - loss: 3.1935 - accuracy30: 0.4273 - val_loss: 3.2674 - val_accuracy30: 0.4056 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 8s - loss: 3.1812 - accuracy30: 0.4320 - val_loss: 3.2588 - val_accuracy30: 0.4083 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.1748 - accuracy30: 0.4356 - val_loss: 3.2595 - val_accuracy30: 0.4079 - 8s/epoch - 29ms/step
Epoch 13/50
282/282 - 8s - loss: 3.1670 - accuracy30: 0.4405 - val_loss: 3.2557 - val_accuracy30: 0.4124 - 8s/epoch - 29ms/step
Epoch 14/50
282/282 - 8s - loss: 3.1592 - accuracy30: 0.4421 - val_loss: 3.2535 - val_accuracy30: 0.4154 - 8s/epoch - 30ms/step
Epoch 15/50
282/282 - 9s - loss: 3.1486 - accuracy30: 0.4467 - val_loss: 3.2501 - val_accuracy30: 0.4171 - 9s/epoch - 31ms/step
Epoch 16/50
282/282 - 9s - loss: 3.1399 - accuracy30: 0.4512 - val_loss: 3.2744 - val_accuracy30: 0.4114 - 9s/epoch - 32ms/step
Epoch 17/50
282/282 - 9s - loss: 3.1330 - accuracy30: 0.4547 - val_loss: 3.2515 - val_accuracy30: 0.4201 - 9s/epoch - 30ms/step
Epoch 18/50
282/282 - 9s - loss: 3.1264 - accuracy30: 0.4577 - val_loss: 3.2710 - val_accuracy30: 0.4186 - 9s/epoch - 30ms/step
Epoch 19/50
282/282 - 8s - loss: 3.1202 - accuracy30: 0.4593 - val_loss: 3.2590 - val_accuracy30: 0.4189 - 8s/epoch - 30ms/step
Epoch 20/50
282/282 - 8s - loss: 3.1115 - accuracy30: 0.4611 - val_loss: 3.2710 - val_accuracy30: 0.4158 - 8s/epoch - 30ms/step
Epoch 21/50
282/282 - 9s - loss: 3.1049 - accuracy30: 0.4625 - val_loss: 3.2849 - val_accuracy30: 0.4127 - 9s/epoch - 30ms/step
Epoch 22/50
282/282 - 9s - loss: 3.0961 - accuracy30: 0.4679 - val_loss: 3.2783 - val_accuracy30: 0.4170 - 9s/epoch - 30ms/step
Epoch 23/50
282/282 - 8s - loss: 3.0876 - accuracy30: 0.4704 - val_loss: 3.2604 - val_accuracy30: 0.4192 - 8s/epoch - 30ms/step
Epoch 24/50
282/282 - 9s - loss: 3.0825 - accuracy30: 0.4711 - val_loss: 3.2782 - val_accuracy30: 0.4207 - 9s/epoch - 30ms/step
Epoch 25/50
282/282 - 8s - loss: 3.0770 - accuracy30: 0.4748 - val_loss: 3.2859 - val_accuracy30: 0.4168 - 8s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h30
Evaluating performance on  test set...
696/696 - 13s - 13s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701714
{'0': {'precision': 0.37526392342701637, 'recall': 0.4448770719768606, 'f1-score': 0.40711613346567915, 'support': 53934}, '1': {'precision': 0.49872763651197577, 'recall': 0.3714141048824593, 'f1-score': 0.42575702298431234, 'support': 69125}, '2': {'precision': 0.4050331168207852, 'recall': 0.4614417205868951, 'f1-score': 0.43140128311081954, 'support': 54865}, 'accuracy': 0.4214439873204289, 'macro avg': {'precision': 0.42634155891992576, 'recall': 0.425910965815405, 'f1-score': 0.421424813186937, 'support': 177924}, 'weighted avg': {'precision': 0.4324103228028563, 'recall': 0.4214439873204289, 'f1-score': 0.4218468961691713, 'support': 177924}}
[[23994 12445 17495]
 [23757 25674 19694]
 [16188 13360 25317]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0637748
{'0': {'precision': 0.4301847623001868, 'recall': 0.423070641077991, 'f1-score': 0.42659804426145137, 'support': 24490}, '1': {'precision': 0.4522277674222837, 'recall': 0.31752934222747614, 'f1-score': 0.3730932361038768, 'support': 23686}, '2': {'precision': 0.41419437340153453, 'recall': 0.5439126784214945, 'f1-score': 0.4702722323049002, 'support': 23820}, 'accuracy': 0.42832935163064617, 'macro avg': {'precision': 0.432202301041335, 'recall': 0.4281708872423205, 'f1-score': 0.42332117089007615, 'support': 71996}, 'weighted avg': {'precision': 0.43214625399078205, 'recall': 0.42832935163064617, 'f1-score': 0.42344515067256644, 'support': 71996}}
[[10361  4542  9587]
 [ 7428  7521  8737]
 [ 6296  4568 12956]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0839251
{'0': {'precision': 0.4019917415593879, 'recall': 0.5204402515723271, 'f1-score': 0.4536110730437166, 'support': 6360}, '1': {'precision': 0.43064596895343016, 'recall': 0.305669095432735, 'f1-score': 0.35755119010497877, 'support': 5627}, '2': {'precision': 0.42547770700636944, 'recall': 0.4097531053519399, 'f1-score': 0.41746738536051875, 'support': 6521}, 'accuracy': 0.4161443700021612, 'macro avg': {'precision': 0.4193718058397291, 'recall': 0.4119541507856674, 'f1-score': 0.40954321616973804, 'support': 18508}, 'weighted avg': {'precision': 0.4189784131730707, 'recall': 0.4161443700021612, 'f1-score': 0.41167126600468423, 'support': 18508}}
[[3310 1067 1983]
 [2282 1720 1625]
 [2642 1207 2672]]
training model: results/LILAK/W7/deepVOL_L2/h50
Epoch 1/50
282/282 - 12s - loss: 3.3506 - accuracy50: 0.3444 - val_loss: 3.3304 - val_accuracy50: 0.3538 - 12s/epoch - 41ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3039 - accuracy50: 0.3565 - val_loss: 3.3339 - val_accuracy50: 0.3542 - 9s/epoch - 31ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2856 - accuracy50: 0.3697 - val_loss: 3.3244 - val_accuracy50: 0.3590 - 9s/epoch - 31ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2717 - accuracy50: 0.3784 - val_loss: 3.3142 - val_accuracy50: 0.3638 - 9s/epoch - 31ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2649 - accuracy50: 0.3844 - val_loss: 3.3135 - val_accuracy50: 0.3677 - 9s/epoch - 31ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2551 - accuracy50: 0.3923 - val_loss: 3.3034 - val_accuracy50: 0.3682 - 9s/epoch - 30ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2464 - accuracy50: 0.3986 - val_loss: 3.3130 - val_accuracy50: 0.3744 - 9s/epoch - 31ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2365 - accuracy50: 0.4049 - val_loss: 3.3113 - val_accuracy50: 0.3750 - 9s/epoch - 31ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2299 - accuracy50: 0.4074 - val_loss: 3.3346 - val_accuracy50: 0.3708 - 9s/epoch - 30ms/step
Epoch 10/50
282/282 - 8s - loss: 3.2204 - accuracy50: 0.4146 - val_loss: 3.3423 - val_accuracy50: 0.3762 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2135 - accuracy50: 0.4193 - val_loss: 3.3440 - val_accuracy50: 0.3735 - 9s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.2068 - accuracy50: 0.4196 - val_loss: 3.3729 - val_accuracy50: 0.3800 - 8s/epoch - 30ms/step
Epoch 13/50
282/282 - 9s - loss: 3.1979 - accuracy50: 0.4252 - val_loss: 3.3677 - val_accuracy50: 0.3800 - 9s/epoch - 31ms/step
Epoch 14/50
282/282 - 9s - loss: 3.1886 - accuracy50: 0.4302 - val_loss: 3.3912 - val_accuracy50: 0.3770 - 9s/epoch - 32ms/step
Epoch 15/50
282/282 - 9s - loss: 3.1857 - accuracy50: 0.4307 - val_loss: 3.3736 - val_accuracy50: 0.3814 - 9s/epoch - 31ms/step
Epoch 16/50
282/282 - 9s - loss: 3.1724 - accuracy50: 0.4387 - val_loss: 3.3842 - val_accuracy50: 0.3761 - 9s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h50
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0954379
{'0': {'precision': 0.3287712400295513, 'recall': 0.4862042146587163, 'f1-score': 0.39228166110127516, 'support': 54002}, '1': {'precision': 0.45266459266003994, 'recall': 0.2617209207101284, 'f1-score': 0.331674681937379, 'support': 68382}, '2': {'precision': 0.37275740696442605, 'recall': 0.3927979834353619, 'f1-score': 0.3825153858292567, 'support': 55540}, 'accuracy': 0.37077066612711046, 'macro avg': {'precision': 0.3847310798846724, 'recall': 0.3802410396014022, 'f1-score': 0.36882390962263695, 'support': 177924}, 'weighted avg': {'precision': 0.39011803389176786, 'recall': 0.37077066612711046, 'f1-score': 0.3659398220138364, 'support': 177924}}
[[26256 10350 17396]
 [31171 17897 19314]
 [22434 11290 21816]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0900464
{'0': {'precision': 0.3796513406055663, 'recall': 0.45339069031289314, 'f1-score': 0.41325737959606423, 'support': 24641}, '1': {'precision': 0.39753571698541085, 'recall': 0.22058638479929532, 'f1-score': 0.2837334772052873, 'support': 23841}, '2': {'precision': 0.3762099522835719, 'recall': 0.46942247171897594, 'f1-score': 0.4176788890150225, 'support': 23514}, 'accuracy': 0.3815350852825157, 'macro avg': {'precision': 0.38446566995818304, 'recall': 0.3811331822770548, 'f1-score': 0.3715565819387914, 'support': 71996}, 'weighted avg': {'precision': 0.3844496712387751, 'recall': 0.3815350852825157, 'f1-score': 0.3718104660950207, 'support': 71996}}
[[11172  4009  9460]
 [ 9740  5259  8842]
 [ 8515  3961 11038]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1007261
{'0': {'precision': 0.3632016632016632, 'recall': 0.5488532830662897, 'f1-score': 0.4371324909295634, 'support': 6366}, '1': {'precision': 0.37220630372492836, 'recall': 0.23093333333333332, 'f1-score': 0.2850246845858475, 'support': 5625}, '2': {'precision': 0.3747684327528714, 'recall': 0.3104189044038668, 'f1-score': 0.33957196810742757, 'support': 6517}, 'accuracy': 0.36827317916576613, 'macro avg': {'precision': 0.3700587998931543, 'recall': 0.3634018402678299, 'f1-score': 0.35390971454094616, 'support': 18508}, 'weighted avg': {'precision': 0.3700112450099942, 'recall': 0.36827317916576613, 'f1-score': 0.35655067020796943, 'support': 18508}}
[[3494 1078 1794]
 [2745 1299 1581]
 [3381 1113 2023]]
training model: results/LILAK/W7/deepVOL_L2/h100
Epoch 1/50
282/282 - 11s - loss: 3.3382 - accuracy100: 0.3586 - val_loss: 3.3439 - val_accuracy100: 0.3552 - 11s/epoch - 39ms/step
Epoch 2/50
282/282 - 9s - loss: 3.2878 - accuracy100: 0.3720 - val_loss: 3.3052 - val_accuracy100: 0.3645 - 9s/epoch - 30ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2760 - accuracy100: 0.3753 - val_loss: 3.3054 - val_accuracy100: 0.3599 - 8s/epoch - 30ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2690 - accuracy100: 0.3811 - val_loss: 3.3087 - val_accuracy100: 0.3567 - 9s/epoch - 31ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2630 - accuracy100: 0.3886 - val_loss: 3.3075 - val_accuracy100: 0.3600 - 9s/epoch - 31ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2562 - accuracy100: 0.3901 - val_loss: 3.3100 - val_accuracy100: 0.3611 - 9s/epoch - 32ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2514 - accuracy100: 0.3939 - val_loss: 3.3075 - val_accuracy100: 0.3677 - 9s/epoch - 31ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2434 - accuracy100: 0.3937 - val_loss: 3.3174 - val_accuracy100: 0.3648 - 9s/epoch - 31ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2351 - accuracy100: 0.4000 - val_loss: 3.3230 - val_accuracy100: 0.3600 - 9s/epoch - 31ms/step
Epoch 10/50
282/282 - 8s - loss: 3.2268 - accuracy100: 0.4070 - val_loss: 3.3106 - val_accuracy100: 0.3723 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 8s - loss: 3.2191 - accuracy100: 0.4128 - val_loss: 3.3307 - val_accuracy100: 0.3663 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2126 - accuracy100: 0.4157 - val_loss: 3.3234 - val_accuracy100: 0.3643 - 9s/epoch - 31ms/step
testing model: results/LILAK/W7/deepVOL_L2/h100
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1317581
{'0': {'precision': 0.3042370072350299, 'recall': 0.5018287394894612, 'f1-score': 0.378814940263141, 'support': 53042}, '1': {'precision': 0.46472851646002566, 'recall': 0.0304652466367713, 'f1-score': 0.057181935348115415, 'support': 71360}, '2': {'precision': 0.3221969564456883, 'recall': 0.5162363140390868, 'f1-score': 0.3967632846772978, 'support': 53522}, 'accuracy': 0.31711292461950047, 'macro avg': {'precision': 0.36372082671358125, 'recall': 0.3495101000551064, 'f1-score': 0.27758672009618474, 'support': 177924}, 'weighted avg': {'precision': 0.3740079571909019, 'recall': 0.31711292461950047, 'f1-score': 0.25521666267831983, 'support': 177924}}
[[26618  1266 25158]
 [36219  2174 32967]
 [24654  1238 27630]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1122253
{'0': {'precision': 0.34972286787055246, 'recall': 0.4766469011453172, 'f1-score': 0.403437607425232, 'support': 24622}, '1': {'precision': 0.371571072319202, 'recall': 0.018741352563833802, 'f1-score': 0.03568292488225433, 'support': 23851}, '2': {'precision': 0.3469047938767289, 'recall': 0.5491221357820006, 'f1-score': 0.42519503604463615, 'support': 23523}, 'accuracy': 0.3486304794710817, 'macro avg': {'precision': 0.3560662446888278, 'recall': 0.34817012983038387, 'f1-score': 0.28810518945070746, 'support': 71996}, 'weighted avg': {'precision': 0.3560400517383788, 'recall': 0.3486304794710817, 'f1-score': 0.28871572093267245, 'support': 71996}}
[[11736   415 12471]
 [11557   447 11847]
 [10265   341 12917]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1007197
{'0': {'precision': 0.35338773960903397, 'recall': 0.568202624351541, 'f1-score': 0.43575941961151415, 'support': 6554}, '1': {'precision': 0.3002832861189802, 'recall': 0.020483091787439612, 'f1-score': 0.03835021707670043, 'support': 5175}, '2': {'precision': 0.370749638965472, 'recall': 0.41658061661011947, 'f1-score': 0.39233120311197556, 'support': 6779}, 'accuracy': 0.3595202074778474, 'macro avg': {'precision': 0.3414735548978287, 'recall': 0.33508877758303335, 'f1-score': 0.28881361326673005, 'support': 18508}, 'weighted avg': {'precision': 0.34489847923115763, 'recall': 0.3595202074778474, 'f1-score': 0.3087336738384413, 'support': 18508}}
[[3724  130 2700]
 [2976  106 2093]
 [3838  117 2824]]
training model: results/LILAK/W7/deepVOL_L2/h200
Epoch 1/50
282/282 - 12s - loss: 3.3471 - accuracy200: 0.3482 - val_loss: 3.3523 - val_accuracy200: 0.3317 - 12s/epoch - 44ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3102 - accuracy200: 0.3523 - val_loss: 3.3404 - val_accuracy200: 0.3319 - 9s/epoch - 32ms/step
Epoch 3/50
282/282 - 9s - loss: 3.2941 - accuracy200: 0.3642 - val_loss: 3.3262 - val_accuracy200: 0.3379 - 9s/epoch - 31ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2831 - accuracy200: 0.3715 - val_loss: 3.3529 - val_accuracy200: 0.3188 - 9s/epoch - 31ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2764 - accuracy200: 0.3780 - val_loss: 3.3486 - val_accuracy200: 0.3220 - 9s/epoch - 30ms/step
Epoch 6/50
282/282 - 9s - loss: 3.2724 - accuracy200: 0.3800 - val_loss: 3.3366 - val_accuracy200: 0.3348 - 9s/epoch - 31ms/step
Epoch 7/50
282/282 - 10s - loss: 3.2648 - accuracy200: 0.3829 - val_loss: 3.3610 - val_accuracy200: 0.3336 - 10s/epoch - 35ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2594 - accuracy200: 0.3888 - val_loss: 3.3640 - val_accuracy200: 0.3275 - 9s/epoch - 31ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2508 - accuracy200: 0.3933 - val_loss: 3.3708 - val_accuracy200: 0.3358 - 9s/epoch - 30ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2484 - accuracy200: 0.3955 - val_loss: 3.3867 - val_accuracy200: 0.3333 - 9s/epoch - 30ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2352 - accuracy200: 0.4056 - val_loss: 3.3935 - val_accuracy200: 0.3370 - 9s/epoch - 30ms/step
Epoch 12/50
282/282 - 9s - loss: 3.2309 - accuracy200: 0.4062 - val_loss: 3.3991 - val_accuracy200: 0.3399 - 9s/epoch - 31ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2290 - accuracy200: 0.4076 - val_loss: 3.4261 - val_accuracy200: 0.3374 - 9s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h200
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1036363
{'0': {'precision': 0.321556849145405, 'recall': 0.18355515492161126, 'f1-score': 0.2337042746390917, 'support': 56577}, '1': {'precision': 0.3652772743747735, 'recall': 0.5709268071606617, 'f1-score': 0.4455152292117944, 'support': 61782}, '2': {'precision': 0.34604488107127573, 'recall': 0.28503315705531773, 'f1-score': 0.3125897558640498, 'support': 59565}, 'accuracy': 0.3520379487871226, 'macro avg': {'precision': 0.34429300153048475, 'recall': 0.3465050397125302, 'f1-score': 0.33060308657164533, 'support': 177924}, 'weighted avg': {'precision': 0.3449362972984666, 'recall': 0.3520379487871226, 'f1-score': 0.3336622234519295, 'support': 177924}}
[[10385 30103 16089]
 [10513 35273 15996]
 [11398 31189 16978]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0975413
{'0': {'precision': 0.37113650998068254, 'recall': 0.1874390243902439, 'f1-score': 0.24908167675021609, 'support': 24600}, '1': {'precision': 0.35504231016281734, 'recall': 0.5335095891560704, 'f1-score': 0.4263532094707895, 'support': 23829}, '2': {'precision': 0.363265306122449, 'recall': 0.36631730810030977, 'f1-score': 0.36478492351897235, 'support': 23567}, 'accuracy': 0.3605339185510306, 'macro avg': {'precision': 0.36314804208864965, 'recall': 0.36242197388220804, 'f1-score': 0.34673993657999264, 'support': 71996}, 'weighted avg': {'precision': 0.3632331632838257, 'recall': 0.3605339185510306, 'f1-score': 0.3456284539294736, 'support': 71996}}
[[ 4611 12041  7948]
 [ 3932 12713  7184]
 [ 3881 11053  8633]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1100909
{'0': {'precision': 0.3474202748249935, 'recall': 0.21029504080351538, 'f1-score': 0.262000195522534, 'support': 6372}, '1': {'precision': 0.31450488145048816, 'recall': 0.5545406639733006, 'f1-score': 0.40137308499141827, 'support': 5693}, '2': {'precision': 0.35833513982224147, 'recall': 0.25655750426819807, 'f1-score': 0.2990231548480463, 'support': 6443}, 'accuracy': 0.33228874000432246, 'macro avg': {'precision': 0.3400867653659077, 'recall': 0.34046440301500464, 'f1-score': 0.3207988117873329, 'support': 18508}, 'weighted avg': {'precision': 0.3410952878299757, 'recall': 0.33228874000432246, 'f1-score': 0.3177592611525661, 'support': 18508}}
[[1340 3441 1591]
 [1167 3157 1369]
 [1350 3440 1653]]
training model: results/LILAK/W7/deepVOL_L2/h300
Epoch 1/50
282/282 - 11s - loss: 3.3469 - accuracy300: 0.3515 - val_loss: 3.3670 - val_accuracy300: 0.3455 - 11s/epoch - 38ms/step
Epoch 2/50
282/282 - 8s - loss: 3.3156 - accuracy300: 0.3546 - val_loss: 3.3500 - val_accuracy300: 0.3315 - 8s/epoch - 29ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2964 - accuracy300: 0.3630 - val_loss: 3.3420 - val_accuracy300: 0.3373 - 8s/epoch - 28ms/step
Epoch 4/50
282/282 - 9s - loss: 3.2819 - accuracy300: 0.3721 - val_loss: 3.3274 - val_accuracy300: 0.3442 - 9s/epoch - 30ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2753 - accuracy300: 0.3786 - val_loss: 3.3306 - val_accuracy300: 0.3431 - 8s/epoch - 29ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2727 - accuracy300: 0.3782 - val_loss: 3.3425 - val_accuracy300: 0.3382 - 8s/epoch - 29ms/step
Epoch 7/50
282/282 - 8s - loss: 3.2634 - accuracy300: 0.3850 - val_loss: 3.3314 - val_accuracy300: 0.3438 - 8s/epoch - 29ms/step
Epoch 8/50
282/282 - 8s - loss: 3.2570 - accuracy300: 0.3885 - val_loss: 3.3344 - val_accuracy300: 0.3401 - 8s/epoch - 29ms/step
Epoch 9/50
282/282 - 9s - loss: 3.2465 - accuracy300: 0.3966 - val_loss: 3.3338 - val_accuracy300: 0.3435 - 9s/epoch - 30ms/step
Epoch 10/50
282/282 - 8s - loss: 3.2374 - accuracy300: 0.4009 - val_loss: 3.3419 - val_accuracy300: 0.3469 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 8s - loss: 3.2329 - accuracy300: 0.4038 - val_loss: 3.3393 - val_accuracy300: 0.3491 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.2210 - accuracy300: 0.4096 - val_loss: 3.3541 - val_accuracy300: 0.3449 - 8s/epoch - 29ms/step
Epoch 13/50
282/282 - 8s - loss: 3.2118 - accuracy300: 0.4139 - val_loss: 3.3596 - val_accuracy300: 0.3447 - 8s/epoch - 30ms/step
Epoch 14/50
282/282 - 8s - loss: 3.2021 - accuracy300: 0.4196 - val_loss: 3.3855 - val_accuracy300: 0.3505 - 8s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h300
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1038498
{'0': {'precision': 0.2977093231805167, 'recall': 0.3569838514941141, 'f1-score': 0.3246632924423094, 'support': 53008}, '1': {'precision': 0.40501830222208723, 'recall': 0.3889496637932292, 'f1-score': 0.3968213812705546, 'support': 68559}, '2': {'precision': 0.34565051625002574, 'recall': 0.2976027822630729, 'f1-score': 0.3198321891685736, 'support': 56357}, 'accuracy': 0.3504923450461995, 'macro avg': {'precision': 0.34945938055087655, 'recall': 0.34784543251680544, 'f1-score': 0.3471056209604792, 'support': 177924}, 'weighted avg': {'precision': 0.35424367555529107, 'recall': 0.3504923450461995, 'f1-score': 0.3509375439473213, 'support': 177924}}
[[18923 18894 15191]
 [25333 26666 16560]
 [19306 20279 16772]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0941672
{'0': {'precision': 0.36488357457520454, 'recall': 0.35329244018361294, 'f1-score': 0.3589944687525799, 'support': 24617}, '1': {'precision': 0.36599197347757806, 'recall': 0.3515166750460868, 'f1-score': 0.35860830911266883, 'support': 23868}, '2': {'precision': 0.37227087213218685, 'recall': 0.3996001871464421, 'f1-score': 0.3854517108394191, 'support': 23511}, 'accuracy': 0.3678259903327963, 'macro avg': {'precision': 0.36771547339498983, 'recall': 0.3681364341253806, 'f1-score': 0.3676848295682226, 'support': 71996}, 'weighted avg': {'precision': 0.36766342370382366, 'recall': 0.3678259903327963, 'f1-score': 0.3675063216391053, 'support': 71996}}
[[8697 7649 8271]
 [7907 8390 7571]
 [7231 6885 9395]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1086344
{'0': {'precision': 0.3352914595571622, 'recall': 0.35428935222027697, 'f1-score': 0.34452871072589386, 'support': 6283}, '1': {'precision': 0.322541316716337, 'recall': 0.4096696490020647, 'f1-score': 0.36092163104441416, 'support': 5812}, '2': {'precision': 0.35970581680410074, 'recall': 0.25167628255106816, 'f1-score': 0.29614678899082575, 'support': 6413}, 'accuracy': 0.33612491895396585, 'macro avg': {'precision': 0.3391795310258667, 'recall': 0.3385450945911366, 'f1-score': 0.33386571025371126, 'support': 18508}, 'weighted avg': {'precision': 0.33974712428775117, 'recall': 0.33612491895396585, 'f1-score': 0.33291224156684096, 'support': 18508}}
[[2226 2467 1590]
 [2148 2381 1283]
 [2265 2534 1614]]
training model: results/LILAK/W7/deepVOL_L2/h500
Epoch 1/50
282/282 - 11s - loss: 3.3515 - accuracy500: 0.3487 - val_loss: 3.3553 - val_accuracy500: 0.3252 - 11s/epoch - 38ms/step
Epoch 2/50
282/282 - 9s - loss: 3.3074 - accuracy500: 0.3576 - val_loss: 3.3387 - val_accuracy500: 0.3305 - 9s/epoch - 31ms/step
Epoch 3/50
282/282 - 8s - loss: 3.2958 - accuracy500: 0.3585 - val_loss: 3.3255 - val_accuracy500: 0.3328 - 8s/epoch - 29ms/step
Epoch 4/50
282/282 - 8s - loss: 3.2849 - accuracy500: 0.3699 - val_loss: 3.3169 - val_accuracy500: 0.3502 - 8s/epoch - 30ms/step
Epoch 5/50
282/282 - 8s - loss: 3.2740 - accuracy500: 0.3743 - val_loss: 3.3234 - val_accuracy500: 0.3402 - 8s/epoch - 30ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2710 - accuracy500: 0.3797 - val_loss: 3.3238 - val_accuracy500: 0.3431 - 8s/epoch - 30ms/step
Epoch 7/50
282/282 - 8s - loss: 3.2582 - accuracy500: 0.3885 - val_loss: 3.3422 - val_accuracy500: 0.3393 - 8s/epoch - 30ms/step
Epoch 8/50
282/282 - 8s - loss: 3.2508 - accuracy500: 0.3944 - val_loss: 3.3387 - val_accuracy500: 0.3411 - 8s/epoch - 30ms/step
Epoch 9/50
282/282 - 8s - loss: 3.2415 - accuracy500: 0.4001 - val_loss: 3.3443 - val_accuracy500: 0.3388 - 8s/epoch - 30ms/step
Epoch 10/50
282/282 - 8s - loss: 3.2339 - accuracy500: 0.4029 - val_loss: 3.3712 - val_accuracy500: 0.3373 - 8s/epoch - 30ms/step
Epoch 11/50
282/282 - 8s - loss: 3.2217 - accuracy500: 0.4103 - val_loss: 3.3829 - val_accuracy500: 0.3344 - 8s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.2135 - accuracy500: 0.4147 - val_loss: 3.3727 - val_accuracy500: 0.3475 - 8s/epoch - 30ms/step
Epoch 13/50
282/282 - 8s - loss: 3.2113 - accuracy500: 0.4161 - val_loss: 3.3556 - val_accuracy500: 0.3580 - 8s/epoch - 29ms/step
Epoch 14/50
282/282 - 9s - loss: 3.1973 - accuracy500: 0.4218 - val_loss: 3.3571 - val_accuracy500: 0.3577 - 9s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h500
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.096482
{'0': {'precision': 0.25772370127393396, 'recall': 0.13626005767408095, 'f1-score': 0.1782684976321448, 'support': 49589}, '1': {'precision': 0.43194705953600016, 'recall': 0.5488338906221581, 'f1-score': 0.4834253462808695, 'support': 71477}, '2': {'precision': 0.33778967595710085, 'recall': 0.36172570262759857, 'f1-score': 0.349348167650431, 'support': 56858}, 'accuracy': 0.3740529664351071, 'macro avg': {'precision': 0.34248681225567834, 'recall': 0.3489398836412792, 'f1-score': 0.3370140038544817, 'support': 177924}, 'weighted avg': {'precision': 0.3533002067877107, 'recall': 0.3740529664351071, 'f1-score': 0.35552926036659666, 'support': 177924}}
[[ 6757 24238 18594]
 [10522 39229 21726]
 [ 8939 27352 20567]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0951582
{'0': {'precision': 0.3783448703378448, 'recall': 0.14963429085114208, 'f1-score': 0.21445303349730616, 'support': 24473}, '1': {'precision': 0.36886066337624684, 'recall': 0.43939643121453825, 'f1-score': 0.4010507552303218, 'support': 24322}, '2': {'precision': 0.35826535508637236, 'recall': 0.5148915995000215, 'f1-score': 0.42253072773896894, 'support': 23201}, 'accuracy': 0.36522862381243404, 'macro avg': {'precision': 0.36849029626682134, 'recall': 0.3679741071885673, 'f1-score': 0.34601150548886567, 'support': 71996}, 'weighted avg': {'precision': 0.36867017014520365, 'recall': 0.36522862381243404, 'f1-score': 0.3445441548386477, 'support': 71996}}
[[ 3662  9878 10933]
 [ 3170 10687 10465]
 [ 2847  8408 11946]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1053429
{'0': {'precision': 0.30917254650416937, 'recall': 0.16333446289393425, 'f1-score': 0.2137472283813747, 'support': 5902}, '1': {'precision': 0.36295562162757405, 'recall': 0.5257616844791833, 'f1-score': 0.42944625407166126, 'support': 6269}, '2': {'precision': 0.3536218101125376, 'recall': 0.3520593340697491, 'f1-score': 0.3528388423216827, 'support': 6337}, 'accuracy': 0.3507132051004971, 'macro avg': {'precision': 0.3419166594147604, 'recall': 0.3470518271476222, 'f1-score': 0.3320107749249062, 'support': 18508}, 'weighted avg': {'precision': 0.34260895678268966, 'recall': 0.3507132051004971, 'f1-score': 0.33443237802434733, 'support': 18508}}
[[ 964 2770 2168]
 [1063 3296 1910]
 [1091 3015 2231]]
training model: results/LILAK/W7/deepVOL_L2/h1000
Epoch 1/50
282/282 - 11s - loss: 3.3545 - accuracy1000: 0.3541 - val_loss: 3.3825 - val_accuracy1000: 0.3334 - 11s/epoch - 38ms/step
Epoch 2/50
282/282 - 8s - loss: 3.3305 - accuracy1000: 0.3546 - val_loss: 3.3660 - val_accuracy1000: 0.3430 - 8s/epoch - 30ms/step
Epoch 3/50
282/282 - 9s - loss: 3.3134 - accuracy1000: 0.3600 - val_loss: 3.3464 - val_accuracy1000: 0.3301 - 9s/epoch - 30ms/step
Epoch 4/50
282/282 - 8s - loss: 3.3076 - accuracy1000: 0.3535 - val_loss: 3.3223 - val_accuracy1000: 0.3593 - 8s/epoch - 30ms/step
Epoch 5/50
282/282 - 9s - loss: 3.2879 - accuracy1000: 0.3680 - val_loss: 3.3306 - val_accuracy1000: 0.3460 - 9s/epoch - 31ms/step
Epoch 6/50
282/282 - 8s - loss: 3.2772 - accuracy1000: 0.3741 - val_loss: 3.3359 - val_accuracy1000: 0.3428 - 8s/epoch - 30ms/step
Epoch 7/50
282/282 - 9s - loss: 3.2744 - accuracy1000: 0.3784 - val_loss: 3.3367 - val_accuracy1000: 0.3430 - 9s/epoch - 31ms/step
Epoch 8/50
282/282 - 9s - loss: 3.2701 - accuracy1000: 0.3784 - val_loss: 3.3418 - val_accuracy1000: 0.3306 - 9s/epoch - 30ms/step
Epoch 9/50
282/282 - 8s - loss: 3.2611 - accuracy1000: 0.3865 - val_loss: 3.3489 - val_accuracy1000: 0.3243 - 8s/epoch - 30ms/step
Epoch 10/50
282/282 - 9s - loss: 3.2507 - accuracy1000: 0.3935 - val_loss: 3.3648 - val_accuracy1000: 0.3197 - 9s/epoch - 31ms/step
Epoch 11/50
282/282 - 9s - loss: 3.2452 - accuracy1000: 0.3967 - val_loss: 3.3809 - val_accuracy1000: 0.3199 - 9s/epoch - 30ms/step
Epoch 12/50
282/282 - 8s - loss: 3.2332 - accuracy1000: 0.4046 - val_loss: 3.3830 - val_accuracy1000: 0.3254 - 8s/epoch - 30ms/step
Epoch 13/50
282/282 - 9s - loss: 3.2299 - accuracy1000: 0.4065 - val_loss: 3.4009 - val_accuracy1000: 0.3186 - 9s/epoch - 31ms/step
Epoch 14/50
282/282 - 8s - loss: 3.2241 - accuracy1000: 0.4110 - val_loss: 3.4040 - val_accuracy1000: 0.3283 - 8s/epoch - 30ms/step
testing model: results/LILAK/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
696/696 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985677
{'0': {'precision': 0.2766482794851589, 'recall': 0.10451315841702061, 'f1-score': 0.15171201797726913, 'support': 50386}, '1': {'precision': 0.39411571488902447, 'recall': 0.7301679296405233, 'f1-score': 0.5119182458617555, 'support': 69017}, '2': {'precision': 0.3470650807465429, 'recall': 0.1839852360691034, 'f1-score': 0.24048512463146612, 'support': 58521}, 'accuracy': 0.37334479890290234, 'macro avg': {'precision': 0.33927635837357545, 'recall': 0.3395554413755491, 'f1-score': 0.30137179615683024, 'support': 177924}, 'weighted avg': {'precision': 0.3453748796958446, 'recall': 0.37334479890290234, 'f1-score': 0.32063495251344104, 'support': 177924}}
[[ 5266 35587  9533]
 [ 7900 50394 10723]
 [ 5869 41885 10767]]
Evaluating performance on  train set...
282/282 - 5s - 5s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1017945
{'0': {'precision': 0.3595927766331354, 'recall': 0.11991754910678198, 'f1-score': 0.17985633316157973, 'support': 24742}, '1': {'precision': 0.3522136659666094, 'recall': 0.6705844339432125, 'f1-score': 0.46184873014548383, 'support': 24759}, '2': {'precision': 0.35788269300252923, 'recall': 0.26419204267615026, 'f1-score': 0.3039819953453876, 'support': 22495}, 'accuracy': 0.3543669092727374, 'macro avg': {'precision': 0.356563045200758, 'recall': 0.35156467524204826, 'f1-score': 0.31522901955081706, 'support': 71996}, 'weighted avg': {'precision': 0.3565208319103313, 'recall': 0.3543669092727374, 'f1-score': 0.315614660398499, 'support': 71996}}
[[ 2967 16423  5352]
 [ 2845 16603  5311]
 [ 2439 14113  5943]]
Evaluating performance on  val set...
73/73 - 1s - 1s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022013
{'0': {'precision': 0.3088, 'recall': 0.13482361159622774, 'f1-score': 0.18769754437150502, 'support': 5726}, '1': {'precision': 0.3753252716975356, 'recall': 0.7395566279595838, 'f1-score': 0.49794384931715485, 'support': 6631}, '2': {'precision': 0.3470428280081577, 'recall': 0.1659892700373923, 'f1-score': 0.22456834927966568, 'support': 6151}, 'accuracy': 0.3618435271234061, 'macro avg': {'precision': 0.3437226999018978, 'recall': 0.346789836531068, 'f1-score': 0.30340324765610854, 'support': 18508}, 'weighted avg': {'precision': 0.3453442355578418, 'recall': 0.3618435271234061, 'f1-score': 0.3111055608554417, 'support': 18508}}
[[ 772 3911 1043]
 [ 849 4904  878]
 [ 879 4251 1021]]
training model: results/LILAK/W7/deepVOL_L3/h10
Epoch 1/50
282/282 - 15s - loss: 3.3517 - accuracy10: 0.3475 - val_loss: 3.3290 - val_accuracy10: 0.3427 - 15s/epoch - 53ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3132 - accuracy10: 0.3478 - val_loss: 3.3123 - val_accuracy10: 0.3461 - 12s/epoch - 42ms/step
Epoch 3/50
282/282 - 12s - loss: 3.2967 - accuracy10: 0.3590 - val_loss: 3.3046 - val_accuracy10: 0.3629 - 12s/epoch - 44ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2858 - accuracy10: 0.3663 - val_loss: 3.2830 - val_accuracy10: 0.3795 - 12s/epoch - 44ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2690 - accuracy10: 0.3792 - val_loss: 3.2629 - val_accuracy10: 0.3873 - 12s/epoch - 44ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2609 - accuracy10: 0.3848 - val_loss: 3.2571 - val_accuracy10: 0.3967 - 12s/epoch - 44ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2380 - accuracy10: 0.3988 - val_loss: 3.2271 - val_accuracy10: 0.4026 - 12s/epoch - 44ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2159 - accuracy10: 0.4108 - val_loss: 3.2092 - val_accuracy10: 0.4104 - 12s/epoch - 44ms/step
Epoch 9/50
282/282 - 13s - loss: 3.2005 - accuracy10: 0.4188 - val_loss: 3.2095 - val_accuracy10: 0.4084 - 13s/epoch - 44ms/step
Epoch 10/50
282/282 - 12s - loss: 3.1917 - accuracy10: 0.4237 - val_loss: 3.2082 - val_accuracy10: 0.4096 - 12s/epoch - 44ms/step
Epoch 11/50
282/282 - 12s - loss: 3.1805 - accuracy10: 0.4279 - val_loss: 3.2092 - val_accuracy10: 0.4109 - 12s/epoch - 44ms/step
Epoch 12/50
282/282 - 12s - loss: 3.1664 - accuracy10: 0.4361 - val_loss: 3.2174 - val_accuracy10: 0.4117 - 12s/epoch - 44ms/step
Epoch 13/50
282/282 - 13s - loss: 3.1544 - accuracy10: 0.4437 - val_loss: 3.2015 - val_accuracy10: 0.4170 - 13s/epoch - 44ms/step
Epoch 14/50
282/282 - 12s - loss: 3.1443 - accuracy10: 0.4453 - val_loss: 3.2007 - val_accuracy10: 0.4206 - 12s/epoch - 44ms/step
Epoch 15/50
282/282 - 12s - loss: 3.1279 - accuracy10: 0.4549 - val_loss: 3.1961 - val_accuracy10: 0.4233 - 12s/epoch - 44ms/step
Epoch 16/50
282/282 - 12s - loss: 3.1167 - accuracy10: 0.4608 - val_loss: 3.1882 - val_accuracy10: 0.4317 - 12s/epoch - 44ms/step
Epoch 17/50
282/282 - 13s - loss: 3.1039 - accuracy10: 0.4653 - val_loss: 3.1845 - val_accuracy10: 0.4354 - 13s/epoch - 45ms/step
Epoch 18/50
282/282 - 12s - loss: 3.0890 - accuracy10: 0.4707 - val_loss: 3.1895 - val_accuracy10: 0.4388 - 12s/epoch - 43ms/step
Epoch 19/50
282/282 - 12s - loss: 3.0773 - accuracy10: 0.4755 - val_loss: 3.2011 - val_accuracy10: 0.4423 - 12s/epoch - 42ms/step
Epoch 20/50
282/282 - 12s - loss: 3.0601 - accuracy10: 0.4825 - val_loss: 3.1916 - val_accuracy10: 0.4474 - 12s/epoch - 42ms/step
Epoch 21/50
282/282 - 12s - loss: 3.0504 - accuracy10: 0.4849 - val_loss: 3.1962 - val_accuracy10: 0.4469 - 12s/epoch - 44ms/step
Epoch 22/50
282/282 - 12s - loss: 3.0399 - accuracy10: 0.4890 - val_loss: 3.1932 - val_accuracy10: 0.4438 - 12s/epoch - 44ms/step
Epoch 23/50
282/282 - 12s - loss: 3.0235 - accuracy10: 0.4953 - val_loss: 3.1936 - val_accuracy10: 0.4516 - 12s/epoch - 43ms/step
Epoch 24/50
282/282 - 12s - loss: 3.0103 - accuracy10: 0.4995 - val_loss: 3.1956 - val_accuracy10: 0.4518 - 12s/epoch - 43ms/step
Epoch 25/50
282/282 - 12s - loss: 3.0008 - accuracy10: 0.5032 - val_loss: 3.2187 - val_accuracy10: 0.4509 - 12s/epoch - 44ms/step
Epoch 26/50
282/282 - 12s - loss: 2.9905 - accuracy10: 0.5043 - val_loss: 3.1945 - val_accuracy10: 0.4552 - 12s/epoch - 44ms/step
Epoch 27/50
282/282 - 12s - loss: 2.9817 - accuracy10: 0.5085 - val_loss: 3.2092 - val_accuracy10: 0.4499 - 12s/epoch - 43ms/step
testing model: results/LILAK/W7/deepVOL_L3/h10
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0191977
{'0': {'precision': 0.40904758058001456, 'recall': 0.4792534262133717, 'f1-score': 0.4413761843745369, 'support': 52828}, '1': {'precision': 0.5863593603010349, 'recall': 0.5998460205947455, 'f1-score': 0.5930260215974501, 'support': 72737}, '2': {'precision': 0.41336889401475285, 'recall': 0.32857770392864644, 'f1-score': 0.36612824278022515, 'support': 52359}, 'accuracy': 0.4842123603336256, 'macro avg': {'precision': 0.4695919449652674, 'recall': 0.4692257169122545, 'f1-score': 0.466843482917404, 'support': 177924}, 'weighted avg': {'precision': 0.4828059637756336, 'recall': 0.4842123603336256, 'f1-score': 0.48122829671546036, 'support': 177924}}
[[25318 15299 12211]
 [16902 43631 12204]
 [19675 15480 17204]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.03787
{'0': {'precision': 0.42171896685961885, 'recall': 0.5333276253264266, 'f1-score': 0.47100189035916823, 'support': 23359}, '1': {'precision': 0.5319564156773459, 'recall': 0.5102964118564742, 'f1-score': 0.520901345648539, 'support': 25640}, '2': {'precision': 0.43395486869365585, 'recall': 0.3370004783232596, 'f1-score': 0.3793812414333268, 'support': 22997}, 'accuracy': 0.4624145785876993, 'macro avg': {'precision': 0.46254341707687346, 'recall': 0.4602081718353868, 'f1-score': 0.457094825813678, 'support': 71996}, 'weighted avg': {'precision': 0.4648863264652063, 'recall': 0.4624145785876993, 'f1-score': 0.4595071124586167, 'support': 71996}}
[[12458  5683  5218]
 [ 7665 13084  4891]
 [ 9418  5829  7750]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0605315
{'0': {'precision': 0.38704195432819966, 'recall': 0.6208894189810871, 'f1-score': 0.4768385239466108, 'support': 5869}, '1': {'precision': 0.521677579189524, 'recall': 0.45769290482844277, 'f1-score': 0.48759510420112473, 'support': 6441}, '2': {'precision': 0.4238814642649622, 'recall': 0.23539851565020975, 'f1-score': 0.3026970954356847, 'support': 6198}, 'accuracy': 0.4350010806137886, 'macro avg': {'precision': 0.4442003325942286, 'recall': 0.4379936131532465, 'f1-score': 0.42237690786114007, 'support': 18508}, 'weighted avg': {'precision': 0.44623361967939074, 'recall': 0.4350010806137886, 'f1-score': 0.4222650724396194, 'support': 18508}}
[[3644 1213 1012]
 [2522 2948  971]
 [3249 1490 1459]]
training model: results/LILAK/W7/deepVOL_L3/h20
Epoch 1/50
282/282 - 14s - loss: 3.3498 - accuracy20: 0.3397 - val_loss: 3.3327 - val_accuracy20: 0.3417 - 14s/epoch - 51ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3131 - accuracy20: 0.3477 - val_loss: 3.3099 - val_accuracy20: 0.3504 - 12s/epoch - 41ms/step
Epoch 3/50
282/282 - 12s - loss: 3.2919 - accuracy20: 0.3617 - val_loss: 3.2942 - val_accuracy20: 0.3607 - 12s/epoch - 42ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2749 - accuracy20: 0.3726 - val_loss: 3.2845 - val_accuracy20: 0.3716 - 12s/epoch - 42ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2600 - accuracy20: 0.3827 - val_loss: 3.2665 - val_accuracy20: 0.3810 - 12s/epoch - 41ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2506 - accuracy20: 0.3890 - val_loss: 3.2601 - val_accuracy20: 0.3951 - 12s/epoch - 41ms/step
Epoch 7/50
282/282 - 14s - loss: 3.2410 - accuracy20: 0.3948 - val_loss: 3.2482 - val_accuracy20: 0.3895 - 14s/epoch - 48ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2317 - accuracy20: 0.3989 - val_loss: 3.2508 - val_accuracy20: 0.3991 - 12s/epoch - 43ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2270 - accuracy20: 0.4069 - val_loss: 3.2535 - val_accuracy20: 0.3974 - 12s/epoch - 43ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2185 - accuracy20: 0.4120 - val_loss: 3.2601 - val_accuracy20: 0.3956 - 12s/epoch - 42ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2077 - accuracy20: 0.4192 - val_loss: 3.2548 - val_accuracy20: 0.3999 - 12s/epoch - 42ms/step
Epoch 12/50
282/282 - 12s - loss: 3.1932 - accuracy20: 0.4257 - val_loss: 3.2577 - val_accuracy20: 0.4045 - 12s/epoch - 42ms/step
Epoch 13/50
282/282 - 12s - loss: 3.1865 - accuracy20: 0.4305 - val_loss: 3.2728 - val_accuracy20: 0.4010 - 12s/epoch - 42ms/step
Epoch 14/50
282/282 - 12s - loss: 3.1765 - accuracy20: 0.4343 - val_loss: 3.2747 - val_accuracy20: 0.4022 - 12s/epoch - 42ms/step
Epoch 15/50
282/282 - 12s - loss: 3.1604 - accuracy20: 0.4444 - val_loss: 3.3271 - val_accuracy20: 0.3995 - 12s/epoch - 42ms/step
Epoch 16/50
282/282 - 12s - loss: 3.1492 - accuracy20: 0.4483 - val_loss: 3.2835 - val_accuracy20: 0.4067 - 12s/epoch - 42ms/step
Epoch 17/50
282/282 - 12s - loss: 3.1393 - accuracy20: 0.4524 - val_loss: 3.3108 - val_accuracy20: 0.4061 - 12s/epoch - 42ms/step
testing model: results/LILAK/W7/deepVOL_L3/h20
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0666803
{'0': {'precision': 0.3741193767740091, 'recall': 0.33481359649122805, 'f1-score': 0.3533768600939329, 'support': 54720}, '1': {'precision': 0.47856200905911356, 'recall': 0.6129093846379792, 'f1-score': 0.5374674007534047, 'support': 68090}, '2': {'precision': 0.3849525725783271, 'recall': 0.29159560184345173, 'f1-score': 0.3318329169333691, 'support': 55114}, 'accuracy': 0.4278512173737101, 'macro avg': {'precision': 0.4125446528038166, 'recall': 0.41310619432421963, 'f1-score': 0.40755905926023556, 'support': 177924}, 'weighted avg': {'precision': 0.4174443896213594, 'recall': 0.4278512173737101, 'f1-score': 0.41715325917529417, 'support': 177924}}
[[18321 22463 13936]
 [14616 41733 11741]
 [16034 23009 16071]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0821999
{'0': {'precision': 0.36531925663460846, 'recall': 0.41696929679762296, 'f1-score': 0.38943919830410484, 'support': 24232}, '1': {'precision': 0.4351016277304546, 'recall': 0.4281150159744409, 'f1-score': 0.43158004810206, 'support': 24101}, '2': {'precision': 0.3786365399534523, 'recall': 0.3300088746143769, 'f1-score': 0.35265427777903224, 'support': 23663}, 'accuracy': 0.3921190066114784, 'macro avg': {'precision': 0.39301914143950517, 'recall': 0.39169772912881357, 'f1-score': 0.3912245080617323, 'support': 71996}, 'weighted avg': {'precision': 0.39305623925801514, 'recall': 0.3921190066114784, 'f1-score': 0.3914559082129293, 'support': 71996}}
[[10104  6894  7234]
 [ 8202 10318  5581]
 [ 9352  6502  7809]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0820868
{'0': {'precision': 0.36995341614906835, 'recall': 0.4610546686018384, 'f1-score': 0.41051044583243596, 'support': 6201}, '1': {'precision': 0.42169390787518574, 'recall': 0.48012180680087974, 'f1-score': 0.4490151095641167, 'support': 5911}, '2': {'precision': 0.3923456790123457, 'recall': 0.24843652282676673, 'f1-score': 0.3042312847022784, 'support': 6396}, 'accuracy': 0.3936676031986168, 'macro avg': {'precision': 0.3946643343455332, 'recall': 0.39653766607649493, 'f1-score': 0.3879189466996103, 'support': 18508}, 'weighted avg': {'precision': 0.39421638134609677, 'recall': 0.3936676031986168, 'f1-score': 0.38607990513271023, 'support': 18508}}
[[2859 1874 1468]
 [2080 2838  993]
 [2789 2018 1589]]
training model: results/LILAK/W7/deepVOL_L3/h30
Epoch 1/50
282/282 - 14s - loss: 3.3526 - accuracy30: 0.3395 - val_loss: 3.3486 - val_accuracy30: 0.3342 - 14s/epoch - 51ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3116 - accuracy30: 0.3459 - val_loss: 3.3087 - val_accuracy30: 0.3474 - 12s/epoch - 42ms/step
Epoch 3/50
282/282 - 12s - loss: 3.2972 - accuracy30: 0.3537 - val_loss: 3.3052 - val_accuracy30: 0.3585 - 12s/epoch - 41ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2822 - accuracy30: 0.3665 - val_loss: 3.2854 - val_accuracy30: 0.3654 - 12s/epoch - 42ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2744 - accuracy30: 0.3702 - val_loss: 3.2869 - val_accuracy30: 0.3642 - 12s/epoch - 44ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2666 - accuracy30: 0.3795 - val_loss: 3.2600 - val_accuracy30: 0.3853 - 12s/epoch - 43ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2594 - accuracy30: 0.3845 - val_loss: 3.2499 - val_accuracy30: 0.3850 - 12s/epoch - 43ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2515 - accuracy30: 0.3899 - val_loss: 3.2565 - val_accuracy30: 0.3883 - 12s/epoch - 43ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2495 - accuracy30: 0.3909 - val_loss: 3.2537 - val_accuracy30: 0.3907 - 12s/epoch - 44ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2404 - accuracy30: 0.3968 - val_loss: 3.2747 - val_accuracy30: 0.3849 - 12s/epoch - 43ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2304 - accuracy30: 0.4070 - val_loss: 3.2508 - val_accuracy30: 0.4000 - 12s/epoch - 43ms/step
Epoch 12/50
282/282 - 12s - loss: 3.2234 - accuracy30: 0.4094 - val_loss: 3.2548 - val_accuracy30: 0.3969 - 12s/epoch - 43ms/step
Epoch 13/50
282/282 - 11s - loss: 3.2152 - accuracy30: 0.4121 - val_loss: 3.2707 - val_accuracy30: 0.3953 - 11s/epoch - 40ms/step
Epoch 14/50
282/282 - 13s - loss: 3.2091 - accuracy30: 0.4182 - val_loss: 3.2545 - val_accuracy30: 0.4011 - 13s/epoch - 46ms/step
Epoch 15/50
282/282 - 12s - loss: 3.2021 - accuracy30: 0.4227 - val_loss: 3.2751 - val_accuracy30: 0.3949 - 12s/epoch - 41ms/step
Epoch 16/50
282/282 - 12s - loss: 3.1927 - accuracy30: 0.4278 - val_loss: 3.2528 - val_accuracy30: 0.4107 - 12s/epoch - 42ms/step
Epoch 17/50
282/282 - 12s - loss: 3.1821 - accuracy30: 0.4330 - val_loss: 3.2711 - val_accuracy30: 0.4019 - 12s/epoch - 42ms/step
testing model: results/LILAK/W7/deepVOL_L3/h30
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0850143
{'0': {'precision': 0.34078070223239426, 'recall': 0.3478510772425557, 'f1-score': 0.3442795929789792, 'support': 53934}, '1': {'precision': 0.5152278008590945, 'recall': 0.4233924050632911, 'f1-score': 0.4648174765145439, 'support': 69125}, '2': {'precision': 0.34801035312637174, 'recall': 0.4190649776724688, 'f1-score': 0.38024675023980425, 'support': 54865}, 'accuracy': 0.39915919156493784, 'macro avg': {'precision': 0.40133961873928686, 'recall': 0.3967694866594385, 'f1-score': 0.39644793991110916, 'support': 177924}, 'weighted avg': {'precision': 0.4107842458176819, 'recall': 0.39915919156493784, 'f1-score': 0.40220049899790344, 'support': 177924}}
[[18761 13766 21407]
 [18190 29267 21668]
 [18102 13771 22992]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0867227
{'0': {'precision': 0.3657614300446889, 'recall': 0.39101674152715393, 'f1-score': 0.37796767381737084, 'support': 24490}, '1': {'precision': 0.4434084594010497, 'recall': 0.30317487123195136, 'f1-score': 0.3601213610491211, 'support': 23686}, '2': {'precision': 0.36438217420661717, 'recall': 0.45310663308144417, 'f1-score': 0.4039296407185629, 'support': 23820}, 'accuracy': 0.3826601477859881, 'macro avg': {'precision': 0.39118402121745194, 'recall': 0.38243274861351645, 'f1-score': 0.3806728918616849, 'support': 71996}, 'weighted avg': {'precision': 0.3908502358571214, 'recall': 0.3826601477859881, 'f1-score': 0.38068596771366553, 'support': 71996}}
[[ 9576  4730 10184]
 [ 7862  7181  8643]
 [ 8743  4284 10793]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 23ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0818877
{'0': {'precision': 0.36919917864476387, 'recall': 0.4240566037735849, 'f1-score': 0.3947310647639956, 'support': 6360}, '1': {'precision': 0.42877846790890267, 'recall': 0.3680469166518571, 'f1-score': 0.3960983073539256, 'support': 5627}, '2': {'precision': 0.39024007531774674, 'recall': 0.38138322343198894, 'f1-score': 0.3857608189855747, 'support': 6521}, 'accuracy': 0.3919926518262373, 'macro avg': {'precision': 0.39607257395713774, 'recall': 0.391162247952477, 'f1-score': 0.3921967303678319, 'support': 18508}, 'weighted avg': {'precision': 0.39472653697055976, 'recall': 0.3919926518262373, 'f1-score': 0.39198622476682965, 'support': 18508}}
[[2697 1365 2298]
 [1968 2071 1588]
 [2640 1394 2487]]
training model: results/LILAK/W7/deepVOL_L3/h50
Epoch 1/50
282/282 - 14s - loss: 3.3532 - accuracy50: 0.3432 - val_loss: 3.3656 - val_accuracy50: 0.3347 - 14s/epoch - 49ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3221 - accuracy50: 0.3477 - val_loss: 3.3202 - val_accuracy50: 0.3441 - 12s/epoch - 41ms/step
Epoch 3/50
282/282 - 12s - loss: 3.3080 - accuracy50: 0.3485 - val_loss: 3.3070 - val_accuracy50: 0.3468 - 12s/epoch - 43ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2986 - accuracy50: 0.3485 - val_loss: 3.2929 - val_accuracy50: 0.3569 - 12s/epoch - 41ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2912 - accuracy50: 0.3559 - val_loss: 3.2902 - val_accuracy50: 0.3554 - 12s/epoch - 42ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2825 - accuracy50: 0.3639 - val_loss: 3.2947 - val_accuracy50: 0.3533 - 12s/epoch - 41ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2753 - accuracy50: 0.3714 - val_loss: 3.2893 - val_accuracy50: 0.3619 - 12s/epoch - 41ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2711 - accuracy50: 0.3723 - val_loss: 3.2871 - val_accuracy50: 0.3629 - 12s/epoch - 41ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2628 - accuracy50: 0.3790 - val_loss: 3.2946 - val_accuracy50: 0.3526 - 12s/epoch - 42ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2574 - accuracy50: 0.3843 - val_loss: 3.2898 - val_accuracy50: 0.3669 - 12s/epoch - 41ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2543 - accuracy50: 0.3858 - val_loss: 3.2939 - val_accuracy50: 0.3589 - 12s/epoch - 41ms/step
Epoch 12/50
282/282 - 11s - loss: 3.2468 - accuracy50: 0.3907 - val_loss: 3.2982 - val_accuracy50: 0.3609 - 11s/epoch - 40ms/step
Epoch 13/50
282/282 - 11s - loss: 3.2416 - accuracy50: 0.3954 - val_loss: 3.3023 - val_accuracy50: 0.3598 - 11s/epoch - 41ms/step
Epoch 14/50
282/282 - 12s - loss: 3.2355 - accuracy50: 0.4002 - val_loss: 3.3142 - val_accuracy50: 0.3541 - 12s/epoch - 41ms/step
Epoch 15/50
282/282 - 12s - loss: 3.2270 - accuracy50: 0.4058 - val_loss: 3.3062 - val_accuracy50: 0.3621 - 12s/epoch - 41ms/step
Epoch 16/50
282/282 - 12s - loss: 3.2227 - accuracy50: 0.4053 - val_loss: 3.3110 - val_accuracy50: 0.3662 - 12s/epoch - 41ms/step
Epoch 17/50
282/282 - 12s - loss: 3.2127 - accuracy50: 0.4121 - val_loss: 3.3075 - val_accuracy50: 0.3646 - 12s/epoch - 41ms/step
Epoch 18/50
282/282 - 11s - loss: 3.2105 - accuracy50: 0.4141 - val_loss: 3.3083 - val_accuracy50: 0.3665 - 11s/epoch - 41ms/step
testing model: results/LILAK/W7/deepVOL_L3/h50
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026207
{'0': {'precision': 0.30947220648720536, 'recall': 0.46537165290174437, 'f1-score': 0.37173835867700133, 'support': 54002}, '1': {'precision': 0.44379854428215526, 'recall': 0.2657131993799538, 'f1-score': 0.3324064249387143, 'support': 68382}, '2': {'precision': 0.33501864601262193, 'recall': 0.3364422038170688, 'f1-score': 0.3357289158791189, 'support': 55540}, 'accuracy': 0.3483903239585441, 'macro avg': {'precision': 0.3627631322606608, 'recall': 0.35584235203292236, 'f1-score': 0.34662456649827816, 'support': 177924}, 'weighted avg': {'precision': 0.36907267006904876, 'recall': 0.3483903239585441, 'f1-score': 0.34538125819653814, 'support': 177924}}
[[25131 11332 17539]
 [30661 18170 19551]
 [25414 11440 18686]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 24ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0924678
{'0': {'precision': 0.36159370623118875, 'recall': 0.49243131366421816, 'f1-score': 0.4169902745798825, 'support': 24641}, '1': {'precision': 0.40920829336678227, 'recall': 0.232624470450065, 'f1-score': 0.2966251270257261, 'support': 23841}, '2': {'precision': 0.361850036164912, 'recall': 0.3829633409883474, 'f1-score': 0.37210743801652896, 'support': 23514}, 'accuracy': 0.37064559142174563, 'macro avg': {'precision': 0.3775506785876277, 'recall': 0.36933970836754354, 'f1-score': 0.36190761320737924, 'support': 71996}, 'weighted avg': {'precision': 0.3774446800903094, 'recall': 0.37064559142174563, 'f1-score': 0.36247335000366526, 'support': 71996}}
[[12134  4135  8372]
 [10786  5546  7509]
 [10637  3872  9005]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0951116
{'0': {'precision': 0.34663286674749255, 'recall': 0.4940307885642476, 'f1-score': 0.40740980633460716, 'support': 6366}, '1': {'precision': 0.37768817204301075, 'recall': 0.24977777777777777, 'f1-score': 0.3006955591225254, 'support': 5625}, '2': {'precision': 0.37707786526684167, 'recall': 0.33067362283259166, 'f1-score': 0.3523544800523218, 'support': 6517}, 'accuracy': 0.36227577263885885, 'macro avg': {'precision': 0.36713296801911494, 'recall': 0.35816072972487234, 'f1-score': 0.3534866151698181, 'support': 18508}, 'weighted avg': {'precision': 0.3667915088286406, 'recall': 0.36227577263885885, 'f1-score': 0.3555909603247944, 'support': 18508}}
[[3145 1167 2054]
 [2714 1405 1506]
 [3214 1148 2155]]
training model: results/LILAK/W7/deepVOL_L3/h100
Epoch 1/50
282/282 - 14s - loss: 3.3336 - accuracy100: 0.3586 - val_loss: 3.3120 - val_accuracy100: 0.3583 - 14s/epoch - 51ms/step
Epoch 2/50
282/282 - 12s - loss: 3.2958 - accuracy100: 0.3648 - val_loss: 3.2958 - val_accuracy100: 0.3649 - 12s/epoch - 41ms/step
Epoch 3/50
282/282 - 11s - loss: 3.2851 - accuracy100: 0.3611 - val_loss: 3.2810 - val_accuracy100: 0.3687 - 11s/epoch - 41ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2814 - accuracy100: 0.3667 - val_loss: 3.2836 - val_accuracy100: 0.3605 - 12s/epoch - 41ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2827 - accuracy100: 0.3648 - val_loss: 3.2803 - val_accuracy100: 0.3700 - 12s/epoch - 42ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2793 - accuracy100: 0.3650 - val_loss: 3.2904 - val_accuracy100: 0.3593 - 12s/epoch - 42ms/step
Epoch 7/50
282/282 - 11s - loss: 3.2779 - accuracy100: 0.3646 - val_loss: 3.2876 - val_accuracy100: 0.3620 - 11s/epoch - 41ms/step
Epoch 8/50
282/282 - 11s - loss: 3.2750 - accuracy100: 0.3689 - val_loss: 3.2861 - val_accuracy100: 0.3607 - 11s/epoch - 41ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2708 - accuracy100: 0.3750 - val_loss: 3.2879 - val_accuracy100: 0.3619 - 12s/epoch - 41ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2673 - accuracy100: 0.3771 - val_loss: 3.2867 - val_accuracy100: 0.3574 - 12s/epoch - 41ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2632 - accuracy100: 0.3806 - val_loss: 3.2872 - val_accuracy100: 0.3625 - 12s/epoch - 41ms/step
Epoch 12/50
282/282 - 11s - loss: 3.2547 - accuracy100: 0.3876 - val_loss: 3.2988 - val_accuracy100: 0.3554 - 11s/epoch - 41ms/step
Epoch 13/50
282/282 - 12s - loss: 3.2511 - accuracy100: 0.3901 - val_loss: 3.2997 - val_accuracy100: 0.3651 - 12s/epoch - 41ms/step
Epoch 14/50
282/282 - 12s - loss: 3.2556 - accuracy100: 0.3887 - val_loss: 3.3066 - val_accuracy100: 0.3591 - 12s/epoch - 41ms/step
Epoch 15/50
282/282 - 11s - loss: 3.2570 - accuracy100: 0.3890 - val_loss: 3.2967 - val_accuracy100: 0.3670 - 11s/epoch - 41ms/step
testing model: results/LILAK/W7/deepVOL_L3/h100
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1268518
{'0': {'precision': 0.30046422029937475, 'recall': 0.35875344066965803, 'f1-score': 0.3270318112293124, 'support': 53042}, '1': {'precision': 0.35333333333333333, 'recall': 0.00148542600896861, 'f1-score': 0.002958414736254535, 'support': 71360}, '2': {'precision': 0.3079393133377664, 'recall': 0.6575800605358544, 'f1-score': 0.41945248906527466, 'support': 53522}, 'accuracy': 0.3053550954340055, 'macro avg': {'precision': 0.3205789556568248, 'recall': 0.33927297573816034, 'f1-score': 0.24981423834361385, 'support': 177924}, 'weighted avg': {'precision': 0.323917053170174, 'recall': 0.3053550954340055, 'f1-score': 0.22485707339401062, 'support': 177924}}
[[19029    83 33930]
 [26087   106 45167]
 [18216   111 35195]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1048216
{'0': {'precision': 0.3460595572860336, 'recall': 0.3898546015758265, 'f1-score': 0.36665393430099313, 'support': 24622}, '1': {'precision': 0.4180790960451977, 'recall': 0.0031025952790239403, 'f1-score': 0.006159480605959713, 'support': 23851}, '2': {'precision': 0.3420748168145006, 'recall': 0.6410321812693959, 'f1-score': 0.4460978640317141, 'support': 23523}, 'accuracy': 0.3437968776043113, 'macro avg': {'precision': 0.3687378233819107, 'recall': 0.34466312604141547, 'f1-score': 0.272970426312889, 'support': 71996}, 'weighted avg': {'precision': 0.3686164350130316, 'recall': 0.3437968776043113, 'f1-score': 0.2731849408010141, 'support': 71996}}
[[ 9599    60 14963]
 [ 9738    74 14039]
 [ 8401    43 15079]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093506
{'0': {'precision': 0.35845079699644317, 'recall': 0.4151663106499847, 'f1-score': 0.384729586426299, 'support': 6554}, '1': {'precision': 0.35714285714285715, 'recall': 0.002898550724637681, 'f1-score': 0.005750431282346176, 'support': 5175}, '2': {'precision': 0.3724137931034483, 'recall': 0.5974332497418499, 'f1-score': 0.4588195309844795, 'support': 6779}, 'accuracy': 0.36665225848281824, 'macro avg': {'precision': 0.3626691490809162, 'recall': 0.33849937037215744, 'f1-score': 0.2830998495643749, 'support': 18508}, 'weighted avg': {'precision': 0.3631993685258942, 'recall': 0.36665225848281824, 'f1-score': 0.30590089647006113, 'support': 18508}}
[[2721   16 3817]
 [2152   15 3008]
 [2718   11 4050]]
training model: results/LILAK/W7/deepVOL_L3/h200
Epoch 1/50
282/282 - 15s - loss: 3.3541 - accuracy200: 0.3432 - val_loss: 3.3467 - val_accuracy200: 0.3300 - 15s/epoch - 52ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3202 - accuracy200: 0.3534 - val_loss: 3.3166 - val_accuracy200: 0.3477 - 12s/epoch - 44ms/step
Epoch 3/50
282/282 - 12s - loss: 3.3132 - accuracy200: 0.3543 - val_loss: 3.3079 - val_accuracy200: 0.3553 - 12s/epoch - 43ms/step
Epoch 4/50
282/282 - 12s - loss: 3.3013 - accuracy200: 0.3493 - val_loss: 3.3014 - val_accuracy200: 0.3533 - 12s/epoch - 43ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2899 - accuracy200: 0.3566 - val_loss: 3.2936 - val_accuracy200: 0.3519 - 12s/epoch - 43ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2833 - accuracy200: 0.3676 - val_loss: 3.2933 - val_accuracy200: 0.3604 - 12s/epoch - 44ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2782 - accuracy200: 0.3690 - val_loss: 3.2944 - val_accuracy200: 0.3574 - 12s/epoch - 44ms/step
Epoch 8/50
282/282 - 13s - loss: 3.2702 - accuracy200: 0.3764 - val_loss: 3.2989 - val_accuracy200: 0.3576 - 13s/epoch - 44ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2665 - accuracy200: 0.3797 - val_loss: 3.3006 - val_accuracy200: 0.3553 - 12s/epoch - 43ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2569 - accuracy200: 0.3862 - val_loss: 3.3040 - val_accuracy200: 0.3557 - 12s/epoch - 44ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2514 - accuracy200: 0.3897 - val_loss: 3.3166 - val_accuracy200: 0.3517 - 12s/epoch - 44ms/step
Epoch 12/50
282/282 - 13s - loss: 3.2427 - accuracy200: 0.3981 - val_loss: 3.3329 - val_accuracy200: 0.3577 - 13s/epoch - 45ms/step
Epoch 13/50
282/282 - 12s - loss: 3.2346 - accuracy200: 0.4034 - val_loss: 3.3364 - val_accuracy200: 0.3545 - 12s/epoch - 44ms/step
Epoch 14/50
282/282 - 12s - loss: 3.2208 - accuracy200: 0.4128 - val_loss: 3.3693 - val_accuracy200: 0.3580 - 12s/epoch - 43ms/step
Epoch 15/50
282/282 - 12s - loss: 3.2090 - accuracy200: 0.4179 - val_loss: 3.3761 - val_accuracy200: 0.3509 - 12s/epoch - 44ms/step
Epoch 16/50
282/282 - 12s - loss: 3.2002 - accuracy200: 0.4228 - val_loss: 3.4054 - val_accuracy200: 0.3614 - 12s/epoch - 44ms/step
testing model: results/LILAK/W7/deepVOL_L3/h200
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012892
{'0': {'precision': 0.31406349611118195, 'recall': 0.21768563197058877, 'f1-score': 0.2571404710205445, 'support': 56577}, '1': {'precision': 0.38450337691306774, 'recall': 0.2008837525492862, 'f1-score': 0.2638953859238784, 'support': 61782}, '2': {'precision': 0.34967255780740575, 'recall': 0.6247964408629229, 'f1-score': 0.4483963468999253, 'support': 59565}, 'accuracy': 0.3481430273599964, 'macro avg': {'precision': 0.3494131436105518, 'recall': 0.34778860846093257, 'f1-score': 0.32314406794811606, 'support': 177924}, 'weighted avg': {'precision': 0.35044403204583763, 'recall': 0.3481430273599964, 'f1-score': 0.32351425083278507, 'support': 177924}}
[[12316  9460 34801]
 [14957 12411 34414]
 [11942 10407 37216]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0935807
{'0': {'precision': 0.3850089536965976, 'recall': 0.18353658536585366, 'f1-score': 0.24857543975555374, 'support': 24600}, '1': {'precision': 0.40275302648558964, 'recall': 0.27504301481388227, 'f1-score': 0.3268664904493542, 'support': 23829}, '2': {'precision': 0.35080461860169104, 'recall': 0.6548987991683286, 'f1-score': 0.4568772849044595, 'support': 23567}, 'accuracy': 0.3681176732040669, 'macro avg': {'precision': 0.3795221995946261, 'recall': 0.3711594664493549, 'f1-score': 0.3441064050364558, 'support': 71996}, 'weighted avg': {'precision': 0.3796854627430339, 'recall': 0.3681176732040669, 'f1-score': 0.3426729872805111, 'support': 71996}}
[[ 4515  5022 15063]
 [ 3776  6554 13499]
 [ 3436  4697 15434]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0976938
{'0': {'precision': 0.3513002364066194, 'recall': 0.23320778405524167, 'f1-score': 0.2803244670816827, 'support': 6372}, '1': {'precision': 0.3719676549865229, 'recall': 0.2181626558932022, 'f1-score': 0.275022143489814, 'support': 5693}, '2': {'precision': 0.361458999908584, 'recall': 0.6136892751823685, 'f1-score': 0.45495340006903695, 'support': 6443}, 'accuracy': 0.36103306678193214, 'macro avg': {'precision': 0.3615756304339088, 'recall': 0.3550199050436041, 'f1-score': 0.33676667021351125, 'support': 18508}, 'weighted avg': {'precision': 0.3611939324957997, 'recall': 0.36103306678193214, 'f1-score': 0.3394852671156688, 'support': 18508}}
[[1486 1042 3844]
 [1310 1242 3141]
 [1434 1055 3954]]
training model: results/LILAK/W7/deepVOL_L3/h300
Epoch 1/50
282/282 - 14s - loss: 3.3506 - accuracy300: 0.3483 - val_loss: 3.3459 - val_accuracy300: 0.3405 - 14s/epoch - 50ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3120 - accuracy300: 0.3517 - val_loss: 3.3283 - val_accuracy300: 0.3486 - 12s/epoch - 42ms/step
Epoch 3/50
282/282 - 12s - loss: 3.3007 - accuracy300: 0.3565 - val_loss: 3.3135 - val_accuracy300: 0.3430 - 12s/epoch - 43ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2943 - accuracy300: 0.3578 - val_loss: 3.3096 - val_accuracy300: 0.3549 - 12s/epoch - 42ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2806 - accuracy300: 0.3655 - val_loss: 3.3041 - val_accuracy300: 0.3557 - 12s/epoch - 43ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2896 - accuracy300: 0.3630 - val_loss: 3.3098 - val_accuracy300: 0.3526 - 12s/epoch - 42ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2790 - accuracy300: 0.3705 - val_loss: 3.3104 - val_accuracy300: 0.3567 - 12s/epoch - 42ms/step
Epoch 8/50
282/282 - 13s - loss: 3.2748 - accuracy300: 0.3726 - val_loss: 3.3094 - val_accuracy300: 0.3605 - 13s/epoch - 47ms/step
Epoch 9/50
282/282 - 14s - loss: 3.2618 - accuracy300: 0.3817 - val_loss: 3.3111 - val_accuracy300: 0.3583 - 14s/epoch - 50ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2609 - accuracy300: 0.3846 - val_loss: 3.3182 - val_accuracy300: 0.3631 - 12s/epoch - 42ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2535 - accuracy300: 0.3911 - val_loss: 3.3254 - val_accuracy300: 0.3595 - 12s/epoch - 42ms/step
Epoch 12/50
282/282 - 12s - loss: 3.2467 - accuracy300: 0.3948 - val_loss: 3.3372 - val_accuracy300: 0.3548 - 12s/epoch - 42ms/step
Epoch 13/50
282/282 - 12s - loss: 3.2403 - accuracy300: 0.3999 - val_loss: 3.3346 - val_accuracy300: 0.3621 - 12s/epoch - 42ms/step
Epoch 14/50
282/282 - 12s - loss: 3.2297 - accuracy300: 0.4045 - val_loss: 3.3455 - val_accuracy300: 0.3627 - 12s/epoch - 42ms/step
Epoch 15/50
282/282 - 11s - loss: 3.2206 - accuracy300: 0.4092 - val_loss: 3.3506 - val_accuracy300: 0.3594 - 11s/epoch - 40ms/step
testing model: results/LILAK/W7/deepVOL_L3/h300
Evaluating performance on  test set...
696/696 - 14s - 14s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1032529
{'0': {'precision': 0.29196866105226094, 'recall': 0.18770751584666465, 'f1-score': 0.22850712505884918, 'support': 53008}, '1': {'precision': 0.4150817366848304, 'recall': 0.3444332618620458, 'f1-score': 0.3764717136047318, 'support': 68559}, '2': {'precision': 0.33175780576160085, 'recall': 0.5118796245364373, 'f1-score': 0.40259015295299766, 'support': 56357}, 'accuracy': 0.35077898428542525, 'macro avg': {'precision': 0.3462694011662307, 'recall': 0.3480068007483826, 'f1-score': 0.33585633053885955, 'support': 177924}, 'weighted avg': {'precision': 0.35201062380420894, 'recall': 0.35077898428542525, 'f1-score': 0.3406623229475415, 'support': 177924}}
[[ 9950 16503 26555]
 [13393 23614 31552]
 [10736 16773 28848]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934726
{'0': {'precision': 0.3652703396669357, 'recall': 0.20225860177925822, 'f1-score': 0.2603534825350345, 'support': 24617}, '1': {'precision': 0.3846333053769453, 'recall': 0.34586056644880175, 'f1-score': 0.36421795720273553, 'support': 23868}, '2': {'precision': 0.36514646505704146, 'recall': 0.573135978903492, 'f1-score': 0.4460886549475287, 'support': 23511}, 'accuracy': 0.3709789432746264, 'macro avg': {'precision': 0.3716833700336408, 'recall': 0.3737517157105173, 'f1-score': 0.3568866982284329, 'support': 71996}, 'weighted avg': {'precision': 0.37164906695196936, 'recall': 0.3709789432746264, 'f1-score': 0.35544011123605734, 'support': 71996}}
[[ 4979  7164 12474]
 [ 4659  8255 10954]
 [ 3993  6043 13475]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 22ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1017706
{'0': {'precision': 0.3428191489361702, 'recall': 0.2051567722425593, 'f1-score': 0.2566962063128547, 'support': 6283}, '1': {'precision': 0.35489541219898046, 'recall': 0.3473847212663455, 'f1-score': 0.35109990435614297, 'support': 5812}, '2': {'precision': 0.36494094270890826, 'recall': 0.5155153594261656, 'f1-score': 0.4273526370217166, 'support': 6413}, 'accuracy': 0.3573589799005835, 'macro avg': {'precision': 0.354218501281353, 'recall': 0.35601895097835684, 'f1-score': 0.3450495825635715, 'support': 18508}, 'weighted avg': {'precision': 0.3542765892618684, 'recall': 0.3573589799005835, 'f1-score': 0.3454737070240889, 'support': 18508}}
[[1289 1845 3149]
 [1189 2019 2604]
 [1282 1825 3306]]
training model: results/LILAK/W7/deepVOL_L3/h500
Epoch 1/50
282/282 - 14s - loss: 3.3549 - accuracy500: 0.3411 - val_loss: 3.3476 - val_accuracy500: 0.3417 - 14s/epoch - 50ms/step
Epoch 2/50
282/282 - 12s - loss: 3.3159 - accuracy500: 0.3524 - val_loss: 3.3092 - val_accuracy500: 0.3509 - 12s/epoch - 43ms/step
Epoch 3/50
282/282 - 13s - loss: 3.3058 - accuracy500: 0.3498 - val_loss: 3.2997 - val_accuracy500: 0.3508 - 13s/epoch - 45ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2990 - accuracy500: 0.3516 - val_loss: 3.2933 - val_accuracy500: 0.3522 - 12s/epoch - 42ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2919 - accuracy500: 0.3547 - val_loss: 3.2968 - val_accuracy500: 0.3492 - 12s/epoch - 41ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2867 - accuracy500: 0.3632 - val_loss: 3.3003 - val_accuracy500: 0.3587 - 12s/epoch - 42ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2768 - accuracy500: 0.3681 - val_loss: 3.3083 - val_accuracy500: 0.3537 - 12s/epoch - 42ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2702 - accuracy500: 0.3749 - val_loss: 3.3012 - val_accuracy500: 0.3647 - 12s/epoch - 43ms/step
Epoch 9/50
282/282 - 12s - loss: 3.2642 - accuracy500: 0.3799 - val_loss: 3.3175 - val_accuracy500: 0.3636 - 12s/epoch - 41ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2538 - accuracy500: 0.3888 - val_loss: 3.3108 - val_accuracy500: 0.3688 - 12s/epoch - 43ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2493 - accuracy500: 0.3920 - val_loss: 3.3073 - val_accuracy500: 0.3681 - 12s/epoch - 41ms/step
Epoch 12/50
282/282 - 12s - loss: 3.2380 - accuracy500: 0.4005 - val_loss: 3.3090 - val_accuracy500: 0.3687 - 12s/epoch - 42ms/step
Epoch 13/50
282/282 - 12s - loss: 3.2283 - accuracy500: 0.4040 - val_loss: 3.3220 - val_accuracy500: 0.3668 - 12s/epoch - 42ms/step
Epoch 14/50
282/282 - 12s - loss: 3.2152 - accuracy500: 0.4116 - val_loss: 3.3386 - val_accuracy500: 0.3598 - 12s/epoch - 41ms/step
testing model: results/LILAK/W7/deepVOL_L3/h500
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0967923
{'0': {'precision': 0.28335604234356987, 'recall': 0.10903627820686039, 'f1-score': 0.15747549911898762, 'support': 49589}, '1': {'precision': 0.43631164507799663, 'recall': 0.2860500580606349, 'f1-score': 0.34555256975781234, 'support': 71477}, '2': {'precision': 0.3331725917789625, 'recall': 0.6561785500721095, 'f1-score': 0.4419476542741902, 'support': 56858}, 'accuracy': 0.3549942672152155, 'macro avg': {'precision': 0.3509467597335097, 'recall': 0.35042162877986827, 'f1-score': 0.3149919077169967, 'support': 177924}, 'weighted avg': {'precision': 0.3607220918053972, 'recall': 0.3549942672152155, 'f1-score': 0.32393816056918984, 'support': 177924}}
[[ 5407 12534 31648]
 [ 8007 20446 43024]
 [ 5668 13881 37309]]
Evaluating performance on  train set...
282/282 - 6s - 6s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0978147
{'0': {'precision': 0.36544141778798817, 'recall': 0.09099824296163118, 'f1-score': 0.14571269669905454, 'support': 24473}, '1': {'precision': 0.3711136890951276, 'recall': 0.2630540251624044, 'f1-score': 0.30787738799865266, 'support': 24322}, '2': {'precision': 0.3397312071020509, 'recall': 0.7125554932977027, 'f1-score': 0.4600976858745113, 'support': 23201}, 'accuracy': 0.3494221901216734, 'macro avg': {'precision': 0.3587621046617222, 'recall': 0.3555359204739128, 'f1-score': 0.3045625901907395, 'support': 71996}, 'weighted avg': {'precision': 0.3590724304082423, 'recall': 0.3494221901216734, 'f1-score': 0.30180769858316747, 'support': 71996}}
[[ 2227  5889 16357]
 [ 2151  6398 15773]
 [ 1716  4953 16532]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 25ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0973357
{'0': {'precision': 0.30348004094165815, 'recall': 0.10047441545238903, 'f1-score': 0.15096741344195522, 'support': 5902}, '1': {'precision': 0.390093537414966, 'recall': 0.2927101611102249, 'f1-score': 0.334457304292354, 'support': 6269}, '2': {'precision': 0.3482700421940928, 'recall': 0.6512545368470886, 'f1-score': 0.45384065541320723, 'support': 6337}, 'accuracy': 0.3541711692241193, 'macro avg': {'precision': 0.34728120685023894, 'recall': 0.34814637113656755, 'f1-score': 0.3130884577158388, 'support': 18508}, 'weighted avg': {'precision': 0.3481533847566487, 'recall': 0.3541711692241193, 'f1-score': 0.3168203343471299, 'support': 18508}}
[[ 593 1320 3989]
 [ 700 1835 3734]
 [ 661 1549 4127]]
training model: results/LILAK/W7/deepVOL_L3/h1000
Epoch 1/50
282/282 - 14s - loss: 3.3612 - accuracy1000: 0.3516 - val_loss: 3.3495 - val_accuracy1000: 0.3370 - 14s/epoch - 50ms/step
Epoch 2/50
282/282 - 13s - loss: 3.3128 - accuracy1000: 0.3540 - val_loss: 3.3100 - val_accuracy1000: 0.3469 - 13s/epoch - 44ms/step
Epoch 3/50
282/282 - 12s - loss: 3.3030 - accuracy1000: 0.3542 - val_loss: 3.3003 - val_accuracy1000: 0.3554 - 12s/epoch - 42ms/step
Epoch 4/50
282/282 - 12s - loss: 3.2931 - accuracy1000: 0.3545 - val_loss: 3.3015 - val_accuracy1000: 0.3577 - 12s/epoch - 42ms/step
Epoch 5/50
282/282 - 12s - loss: 3.2820 - accuracy1000: 0.3622 - val_loss: 3.3117 - val_accuracy1000: 0.3618 - 12s/epoch - 42ms/step
Epoch 6/50
282/282 - 12s - loss: 3.2725 - accuracy1000: 0.3716 - val_loss: 3.3181 - val_accuracy1000: 0.3547 - 12s/epoch - 42ms/step
Epoch 7/50
282/282 - 12s - loss: 3.2650 - accuracy1000: 0.3776 - val_loss: 3.3165 - val_accuracy1000: 0.3617 - 12s/epoch - 42ms/step
Epoch 8/50
282/282 - 12s - loss: 3.2692 - accuracy1000: 0.3816 - val_loss: 3.3226 - val_accuracy1000: 0.3616 - 12s/epoch - 44ms/step
Epoch 9/50
282/282 - 13s - loss: 3.2527 - accuracy1000: 0.3914 - val_loss: 3.3325 - val_accuracy1000: 0.3633 - 13s/epoch - 45ms/step
Epoch 10/50
282/282 - 12s - loss: 3.2432 - accuracy1000: 0.3953 - val_loss: 3.3420 - val_accuracy1000: 0.3573 - 12s/epoch - 43ms/step
Epoch 11/50
282/282 - 12s - loss: 3.2300 - accuracy1000: 0.4041 - val_loss: 3.3467 - val_accuracy1000: 0.3621 - 12s/epoch - 41ms/step
Epoch 12/50
282/282 - 11s - loss: 3.2211 - accuracy1000: 0.4112 - val_loss: 3.3603 - val_accuracy1000: 0.3599 - 11s/epoch - 40ms/step
Epoch 13/50
282/282 - 11s - loss: 3.2157 - accuracy1000: 0.4160 - val_loss: 3.3710 - val_accuracy1000: 0.3608 - 11s/epoch - 40ms/step
testing model: results/LILAK/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
696/696 - 15s - 15s/epoch - 21ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0924718
{'0': {'precision': 0.2757295124934475, 'recall': 0.031318223316000475, 'f1-score': 0.05624766080307971, 'support': 50386}, '1': {'precision': 0.4010406039583758, 'recall': 0.6834837793587087, 'f1-score': 0.5054837897353743, 'support': 69017}, '2': {'precision': 0.3412243252652216, 'recall': 0.3182276447770886, 'f1-score': 0.3293250101681727, 'support': 58521}, 'accuracy': 0.3786616757716778, 'macro avg': {'precision': 0.33933148057234835, 'recall': 0.3443432158172659, 'f1-score': 0.29701882023554227, 'support': 177924}, 'weighted avg': {'precision': 0.34587978754263676, 'recall': 0.3786616757716778, 'f1-score': 0.32032496050809306, 'support': 177924}}
[[ 1578 32327 16481]
 [ 2372 47172 19473]
 [ 1773 38125 18623]]
Evaluating performance on  train set...
282/282 - 7s - 7s/epoch - 24ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1014555
{'0': {'precision': 0.3888677087304613, 'recall': 0.04122544660900493, 'f1-score': 0.07454778001096289, 'support': 24742}, '1': {'precision': 0.35360206667966465, 'recall': 0.5860091279938608, 'f1-score': 0.44106336732987794, 'support': 24759}, '2': {'precision': 0.35009350411065243, 'recall': 0.4410757946210269, 'f1-score': 0.3903532929420096, 'support': 22495}, 'accuracy': 0.3535057503194622, 'macro avg': {'precision': 0.3641877598402594, 'recall': 0.3561034564079642, 'f1-score': 0.30198814676095015, 'support': 71996}, 'weighted avg': {'precision': 0.364625142970443, 'recall': 0.3535057503194622, 'f1-score': 0.29926310363745484, 'support': 71996}}
[[ 1020 14626  9096]
 [  927 14509  9323]
 [  676 11897  9922]]
Evaluating performance on  val set...
73/73 - 2s - 2s/epoch - 26ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0983161
{'0': {'precision': 0.28466076696165193, 'recall': 0.033705902899056936, 'f1-score': 0.060274828232354784, 'support': 5726}, '1': {'precision': 0.3672428901457819, 'recall': 0.6952194239179611, 'f1-score': 0.4806088407005838, 'support': 6631}, '2': {'precision': 0.3435664203145727, 'recall': 0.2947488213298651, 'f1-score': 0.3172908645432272, 'support': 6151}, 'accuracy': 0.35746704127944673, 'macro avg': {'precision': 0.3318233591406688, 'recall': 0.34122471604896104, 'f1-score': 0.2860581778253886, 'support': 18508}, 'weighted avg': {'precision': 0.3338249517794486, 'recall': 0.35746704127944673, 'f1-score': 0.29628846968605066, 'support': 18508}}
[[ 193 3846 1687]
 [ 244 4610 1777]
 [ 241 4097 1813]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  13.31 (ave)

============================================
