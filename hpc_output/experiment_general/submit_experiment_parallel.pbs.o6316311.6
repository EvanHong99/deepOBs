This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAL_orderbooks/AAL_orderbooks_2019-02-06.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-29.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-16.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-17.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-25.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-23.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-18.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-08.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-22.csv
data/AAL_orderbooks/AAL_orderbooks_2019-02-04.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-24.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-15.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-31.csv
data/AAL_orderbooks/AAL_orderbooks_2019-01-30.csv
training model: results/AAL/W0/deepLOB_L1/h10
Epoch 1/50
2262/2262 - 194s - loss: 2.9491 - accuracy10: 0.4571 - val_loss: 3.0273 - val_accuracy10: 0.5351 - 194s/epoch - 86ms/step
Epoch 2/50
2262/2262 - 172s - loss: 2.9289 - accuracy10: 0.4491 - val_loss: 3.0900 - val_accuracy10: 0.4958 - 172s/epoch - 76ms/step
Epoch 3/50
2262/2262 - 171s - loss: 2.8678 - accuracy10: 0.4744 - val_loss: 3.2852 - val_accuracy10: 0.4325 - 171s/epoch - 76ms/step
Epoch 4/50
2262/2262 - 171s - loss: 2.7886 - accuracy10: 0.5106 - val_loss: 3.0749 - val_accuracy10: 0.5794 - 171s/epoch - 76ms/step
Epoch 5/50
2262/2262 - 174s - loss: 2.7215 - accuracy10: 0.5356 - val_loss: 3.1032 - val_accuracy10: 0.5862 - 174s/epoch - 77ms/step
Epoch 6/50
2262/2262 - 171s - loss: 2.6793 - accuracy10: 0.5520 - val_loss: 3.2535 - val_accuracy10: 0.6158 - 171s/epoch - 76ms/step
Epoch 7/50
2262/2262 - 172s - loss: 2.6522 - accuracy10: 0.5609 - val_loss: 3.2526 - val_accuracy10: 0.6032 - 172s/epoch - 76ms/step
Epoch 8/50
2262/2262 - 177s - loss: 2.6321 - accuracy10: 0.5684 - val_loss: 3.4005 - val_accuracy10: 0.6266 - 177s/epoch - 78ms/step
Epoch 9/50
2262/2262 - 167s - loss: 2.6131 - accuracy10: 0.5720 - val_loss: 3.4340 - val_accuracy10: 0.5852 - 167s/epoch - 74ms/step
Epoch 10/50
2262/2262 - 165s - loss: 2.5966 - accuracy10: 0.5764 - val_loss: 3.4376 - val_accuracy10: 0.5919 - 165s/epoch - 73ms/step
Epoch 11/50
2262/2262 - 161s - loss: 2.5837 - accuracy10: 0.5784 - val_loss: 3.5418 - val_accuracy10: 0.6048 - 161s/epoch - 71ms/step
testing model: results/AAL/W0/deepLOB_L1/h10
Evaluating performance on  test set...
6677/6677 - 202s - 202s/epoch - 30ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.82961833
{'0': {'precision': 0.25444230539891305, 'recall': 0.1676658134626611, 'f1-score': 0.20213435471973903, 'support': 178152}, '1': {'precision': 0.802310061078598, 'recall': 0.7609274161776752, 'f1-score': 0.7810709897019782, 'support': 1345286}, '2': {'precision': 0.22166173515403725, 'recall': 0.3768886401790711, 'f1-score': 0.27914706392238214, 'support': 185848}, 'accuracy': 0.6573382102234501, 'macro avg': {'precision': 0.4261380338771828, 'recall': 0.4351606232731358, 'f1-score': 0.4207841361146998, 'support': 1709286}, 'weighted avg': {'precision': 0.6820750234744317, 'recall': 0.6573382102234501, 'f1-score': 0.6661573490627626, 'support': 1709286}}
[[  29870  140300    7982]
 [  83652 1023665  237969]
 [   3872  111932   70044]]
Evaluating performance on  train set...
2262/2262 - 73s - 73s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.96441007
{'0': {'precision': 0.2628391793514229, 'recall': 0.22933228110022522, 'f1-score': 0.24494515999712183, 'support': 103906}, '1': {'precision': 0.6383882983889809, 'recall': 0.66009163603989, 'f1-score': 0.6490585878751404, 'support': 368414}, '2': {'precision': 0.29055150418710485, 'recall': 0.2925182841531081, 'f1-score': 0.29153157705137384, 'support': 106513}, 'accuracy': 0.5151278520747781, 'macro avg': {'precision': 0.39725966064250295, 'recall': 0.39398073376440773, 'f1-score': 0.395178441641212, 'support': 578833}, 'weighted avg': {'precision': 0.5069670642445198, 'recall': 0.5151278520747781, 'f1-score': 0.5107266608064258, 'support': 578833}}
[[ 23829  69103  10974]
 [ 60124 243187  65103]
 [  6707  68649  31157]]
Evaluating performance on  val set...
827/827 - 26s - 26s/epoch - 32ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.94189066
{'0': {'precision': 0.26301043219076004, 'recall': 0.25879109599084965, 'f1-score': 0.26088370511626524, 'support': 34097}, '1': {'precision': 0.6788932020655235, 'recall': 0.663725849152256, 'f1-score': 0.6712238540275924, 'support': 142024}, '2': {'precision': 0.2661185302453847, 'recall': 0.2940496007674294, 'f1-score': 0.27938771680561886, 'support': 35443}, 'accuracy': 0.5365326804182186, 'macro avg': {'precision': 0.4026740548338894, 'recall': 0.40552218197017836, 'f1-score': 0.4038317586498255, 'support': 211564}, 'weighted avg': {'precision': 0.5427153670002903, 'recall': 0.5365326804182186, 'f1-score': 0.5394471043490653, 'support': 211564}}
[[ 8824 22236  3037]
 [22055 94265 25704]
 [ 2671 22350 10422]]
training model: results/AAL/W0/deepLOB_L1/h20
Epoch 1/50
2262/2262 - 171s - loss: 3.0244 - accuracy20: 0.4598 - val_loss: 3.0918 - val_accuracy20: 0.4811 - 171s/epoch - 76ms/step
Epoch 2/50
2262/2262 - 169s - loss: 2.9617 - accuracy20: 0.4775 - val_loss: 3.0865 - val_accuracy20: 0.5433 - 169s/epoch - 75ms/step
Epoch 3/50
2262/2262 - 167s - loss: 2.9057 - accuracy20: 0.5005 - val_loss: 3.0016 - val_accuracy20: 0.5475 - 167s/epoch - 74ms/step
Epoch 4/50
2262/2262 - 164s - loss: 2.8404 - accuracy20: 0.5246 - val_loss: 2.9727 - val_accuracy20: 0.5565 - 164s/epoch - 72ms/step
Epoch 5/50
2262/2262 - 159s - loss: 2.8006 - accuracy20: 0.5380 - val_loss: 2.9579 - val_accuracy20: 0.5561 - 159s/epoch - 70ms/step
Epoch 6/50
2262/2262 - 163s - loss: 2.7640 - accuracy20: 0.5490 - val_loss: 2.9790 - val_accuracy20: 0.5695 - 163s/epoch - 72ms/step
Epoch 7/50
2262/2262 - 171s - loss: 2.7465 - accuracy20: 0.5521 - val_loss: 2.9838 - val_accuracy20: 0.5706 - 171s/epoch - 76ms/step
Epoch 8/50
2262/2262 - 174s - loss: 2.7192 - accuracy20: 0.5607 - val_loss: 3.0143 - val_accuracy20: 0.5763 - 174s/epoch - 77ms/step
Epoch 9/50
2262/2262 - 167s - loss: 2.7043 - accuracy20: 0.5636 - val_loss: 3.0493 - val_accuracy20: 0.5803 - 167s/epoch - 74ms/step
Epoch 10/50
2262/2262 - 164s - loss: 2.6871 - accuracy20: 0.5672 - val_loss: 3.0452 - val_accuracy20: 0.5852 - 164s/epoch - 73ms/step
Epoch 11/50
2262/2262 - 167s - loss: 2.6727 - accuracy20: 0.5701 - val_loss: 3.0513 - val_accuracy20: 0.5830 - 167s/epoch - 74ms/step
Epoch 12/50
2262/2262 - 165s - loss: 2.6600 - accuracy20: 0.5732 - val_loss: 3.0387 - val_accuracy20: 0.5821 - 165s/epoch - 73ms/step
Epoch 13/50
2262/2262 - 66s - loss: 2.6486 - accuracy20: 0.5763 - val_loss: 3.0537 - val_accuracy20: 0.5815 - 66s/epoch - 29ms/step
Epoch 14/50
2262/2262 - 49s - loss: 2.6415 - accuracy20: 0.5779 - val_loss: 3.0450 - val_accuracy20: 0.5851 - 49s/epoch - 22ms/step
Epoch 15/50
2262/2262 - 50s - loss: 2.6314 - accuracy20: 0.5806 - val_loss: 3.0385 - val_accuracy20: 0.5836 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h20
Evaluating performance on  test set...
6677/6677 - 82s - 82s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.77474755
{'0': {'precision': 0.3760835030332754, 'recall': 0.4308274809160305, 'f1-score': 0.40159846984083614, 'support': 245625}, '1': {'precision': 0.7903626650665639, 'recall': 0.7273621146797724, 'f1-score': 0.7575548177092276, 'support': 1213309}, '2': {'precision': 0.35673536516420823, 'recall': 0.4435994120278648, 'f1-score': 0.3954535095715588, 'support': 250352}, 'accuracy': 0.6431884424256678, 'macro avg': {'precision': 0.5077271777546826, 'recall': 0.5339296692078893, 'f1-score': 0.5182022657072075, 'support': 1709286}, 'weighted avg': {'precision': 0.6673190193808326, 'recall': 0.6431884424256678, 'f1-score': 0.6533682950090737, 'support': 1709286}}
[[105822 119024  20779]
 [151317 882515 179477]
 [ 24240 115056 111056]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9496638
{'0': {'precision': 0.4510056351706926, 'recall': 0.29441208993733875, 'f1-score': 0.35626067680340406, 'support': 135650}, '1': {'precision': 0.5836166355034279, 'recall': 0.8094101468493689, 'f1-score': 0.6782141343308765, 'support': 305415}, '2': {'precision': 0.49643210505801577, 'recall': 0.24036786481621275, 'f1-score': 0.32390426166652, 'support': 137768}, 'accuracy': 0.5532822074760768, 'macro avg': {'precision': 0.5103514585773788, 'recall': 0.4480633672009735, 'f1-score': 0.4527930242669335, 'support': 578833}, 'weighted avg': {'precision': 0.5317883524139374, 'recall': 0.5532822074760768, 'f1-score': 0.5184348041081271, 'support': 578833}}
[[ 39937  87173   8540]
 [ 33158 247206  25051]
 [ 15456  89197  33115]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.91264516
{'0': {'precision': 0.4077827320632347, 'recall': 0.4620229633679606, 'f1-score': 0.4332116638641677, 'support': 45725}, '1': {'precision': 0.6428735951709622, 'recall': 0.6790067530724382, 'f1-score': 0.6604463302190852, 'support': 119205}, '2': {'precision': 0.46416755287723027, 'recall': 0.3369430029592143, 'f1-score': 0.3904529980369257, 'support': 46634}, 'accuracy': 0.5567109716208807, 'macro avg': {'precision': 0.5049412933704757, 'recall': 0.49265757313320435, 'f1-score': 0.49470366404005955, 'support': 211564}, 'weighted avg': {'precision': 0.552672486797483, 'recall': 0.5567109716208807, 'f1-score': 0.5518211663345801, 'support': 211564}}
[[21126 21162  3437]
 [23562 80941 14702]
 [ 7119 23802 15713]]
training model: results/AAL/W0/deepLOB_L1/h30
Epoch 1/50
2262/2262 - 54s - loss: 3.0586 - accuracy30: 0.4655 - val_loss: 3.1942 - val_accuracy30: 0.4550 - 54s/epoch - 24ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.0674 - accuracy30: 0.4549 - val_loss: 3.1991 - val_accuracy30: 0.4903 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.0340 - accuracy30: 0.4746 - val_loss: 3.2811 - val_accuracy30: 0.4634 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 49s - loss: 2.9400 - accuracy30: 0.5114 - val_loss: 3.3778 - val_accuracy30: 0.5033 - 49s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 2.8767 - accuracy30: 0.5297 - val_loss: 3.5971 - val_accuracy30: 0.5044 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 2.8419 - accuracy30: 0.5384 - val_loss: 3.6864 - val_accuracy30: 0.5021 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 50s - loss: 2.8173 - accuracy30: 0.5430 - val_loss: 3.7835 - val_accuracy30: 0.4977 - 50s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 51s - loss: 2.7925 - accuracy30: 0.5494 - val_loss: 3.7477 - val_accuracy30: 0.4970 - 51s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 50s - loss: 2.7766 - accuracy30: 0.5538 - val_loss: 3.7262 - val_accuracy30: 0.4946 - 50s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 2.7589 - accuracy30: 0.5575 - val_loss: 3.6447 - val_accuracy30: 0.4936 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 2.7461 - accuracy30: 0.5601 - val_loss: 3.6851 - val_accuracy30: 0.4959 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h30
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9603497
{'0': {'precision': 0.35529693261753503, 'recall': 0.315750161498708, 'f1-score': 0.33435824352008553, 'support': 297216}, '1': {'precision': 0.6707024340741935, 'recall': 0.6341107375028021, 'f1-score': 0.6518935038059047, 'support': 1115250}, '2': {'precision': 0.2762785126949151, 'recall': 0.3637052759248029, 'f1-score': 0.31402030638468686, 'support': 296820}, 'accuracy': 0.5317969023323189, 'macro avg': {'precision': 0.4340926264622145, 'recall': 0.43785539164210435, 'f1-score': 0.43342401790355906, 'support': 1709286}, 'weighted avg': {'precision': 0.5473664505905987, 'recall': 0.5317969023323189, 'f1-score': 0.5380073066571094, 'support': 1709286}}
[[ 93846 175248  28122]
 [153388 707192 254670]
 [ 16900 171965 107955]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0490968
{'0': {'precision': 0.4109292593441871, 'recall': 0.18321522821232084, 'f1-score': 0.25343497956026956, 'support': 156499}, '1': {'precision': 0.4618234146846629, 'recall': 0.8096963690627045, 'f1-score': 0.5881729042646292, 'support': 264367}, '2': {'precision': 0.4258555967773802, 'recall': 0.12280412997651408, 'f1-score': 0.19063482704402515, 'support': 157967}, 'accuracy': 0.4528577327139261, 'macro avg': {'precision': 0.43286942360207675, 'recall': 0.3719052424171798, 'f1-score': 0.34408090362297467, 'support': 578833}, 'weighted avg': {'precision': 0.4382473353871992, 'recall': 0.4528577327139261, 'f1-score': 0.3891793293948226, 'support': 578833}}
[[ 28673 121715   6111]
 [ 30267 214057  20043]
 [ 10836 127732  19399]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0329626
{'0': {'precision': 0.3782891084711891, 'recall': 0.2545145567610973, 'f1-score': 0.3042968619176798, 'support': 53549}, '1': {'precision': 0.4885780505542755, 'recall': 0.6908933634485078, 'f1-score': 0.5723840843399397, 'support': 104045}, '2': {'precision': 0.38423627979019254, 'recall': 0.2022419862886789, 'f1-score': 0.26500115323451934, 'support': 53970}, 'accuracy': 0.4557864286929723, 'macro avg': {'precision': 0.41703447960521906, 'recall': 0.3825499688327613, 'f1-score': 0.38056069983071295, 'support': 211564}, 'weighted avg': {'precision': 0.4340452003163108, 'recall': 0.4557864286929723, 'f1-score': 0.426115061891654, 'support': 211564}}
[[13629 36398  3522]
 [18191 71884 13970]
 [ 4208 38847 10915]]
training model: results/AAL/W0/deepLOB_L1/h50
Epoch 1/50
2262/2262 - 53s - loss: 3.0893 - accuracy50: 0.4612 - val_loss: 3.3336 - val_accuracy50: 0.3993 - 53s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.0950 - accuracy50: 0.4606 - val_loss: 3.3699 - val_accuracy50: 0.3979 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.0718 - accuracy50: 0.4691 - val_loss: 3.6557 - val_accuracy50: 0.3953 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.0697 - accuracy50: 0.4709 - val_loss: 3.5999 - val_accuracy50: 0.3973 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 3.0352 - accuracy50: 0.4837 - val_loss: 3.6717 - val_accuracy50: 0.3968 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 3.0030 - accuracy50: 0.4944 - val_loss: 3.7008 - val_accuracy50: 0.3955 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 50s - loss: 2.9534 - accuracy50: 0.5091 - val_loss: 3.7383 - val_accuracy50: 0.3897 - 50s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 2.9299 - accuracy50: 0.5156 - val_loss: 3.9206 - val_accuracy50: 0.3880 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 50s - loss: 2.9094 - accuracy50: 0.5208 - val_loss: 3.9936 - val_accuracy50: 0.3934 - 50s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 2.8969 - accuracy50: 0.5227 - val_loss: 4.0851 - val_accuracy50: 0.3931 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 2.8836 - accuracy50: 0.5255 - val_loss: 4.1158 - val_accuracy50: 0.3920 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h50
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0065376
{'0': {'precision': 0.5639105058365759, 'recall': 0.030514702011854255, 'f1-score': 0.057896471481218854, 'support': 379948}, '1': {'precision': 0.5698528783491704, 'recall': 0.7996757342897955, 'f1-score': 0.6654808300104599, 'support': 959090}, '2': {'precision': 0.2992010687419239, 'recall': 0.27704673624165427, 'f1-score': 0.2876980314999278, 'support': 370248}, 'accuracy': 0.5154965289600453, 'macro avg': {'precision': 0.4776548176425568, 'recall': 0.3690790575144347, 'f1-score': 0.3370251109972022, 'support': 1709286}, 'weighted avg': {'precision': 0.5099061615593067, 'recall': 0.5154965289600453, 'f1-score': 0.44859273320431065, 'support': 1709286}}
[[ 11594 312364  55990]
 [  7862 766961 184267]
 [  1104 266568 102576]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1262003
{'0': {'precision': 0.4741516966067864, 'recall': 0.05148070692513572, 'f1-score': 0.09287732022246767, 'support': 184574}, '1': {'precision': 0.3625329373208519, 'recall': 0.8685195185006427, 'f1-score': 0.5115410487563925, 'support': 209263}, '2': {'precision': 0.40301416588354044, 'recall': 0.12518108499643235, 'f1-score': 0.19102689950424404, 'support': 184996}, 'accuracy': 0.37041599217736376, 'macro avg': {'precision': 0.41323293327039295, 'recall': 0.3483937701407369, 'f1-score': 0.2651484228277014, 'support': 578833}, 'weighted avg': {'precision': 0.41106297316128465, 'recall': 0.37041599217736376, 'f1-score': 0.2756037843200678, 'support': 578833}}
[[  9502 161012  14060]
 [  7270 181749  20244]
 [  3268 158570  23158]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0999862
{'0': {'precision': 0.4328851412944394, 'recall': 0.059239045688445346, 'f1-score': 0.10421638822593476, 'support': 64130}, '1': {'precision': 0.39811071309060786, 'recall': 0.8690945235500521, 'f1-score': 0.5460770371039225, 'support': 83503}, '2': {'precision': 0.40498609552617454, 'recall': 0.12984311210523847, 'f1-score': 0.1966409248116739, 'support': 63931}, 'accuracy': 0.40021931897676355, 'macro avg': {'precision': 0.41199398330374065, 'recall': 0.35272556044791203, 'f1-score': 0.28231145004717706, 'support': 211564}, 'weighted avg': {'precision': 0.4107292784193024, 'recall': 0.40021931897676355, 'f1-score': 0.3065451530995498, 'support': 211564}}
[[ 3799 55632  4699]
 [ 3434 72572  7497]
 [ 1543 54087  8301]]
training model: results/AAL/W0/deepLOB_L1/h100
Epoch 1/50
2262/2262 - 52s - loss: 3.1952 - accuracy100: 0.4246 - val_loss: 3.4067 - val_accuracy100: 0.3671 - 52s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.1733 - accuracy100: 0.4306 - val_loss: 3.5481 - val_accuracy100: 0.3693 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.1620 - accuracy100: 0.4356 - val_loss: 3.5743 - val_accuracy100: 0.3531 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.1450 - accuracy100: 0.4428 - val_loss: 3.5399 - val_accuracy100: 0.3529 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 3.1366 - accuracy100: 0.4481 - val_loss: 3.5540 - val_accuracy100: 0.3452 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 3.1253 - accuracy100: 0.4514 - val_loss: 3.5440 - val_accuracy100: 0.3447 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 49s - loss: 3.1195 - accuracy100: 0.4545 - val_loss: 3.5667 - val_accuracy100: 0.3513 - 49s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 3.1130 - accuracy100: 0.4564 - val_loss: 3.5638 - val_accuracy100: 0.3502 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 49s - loss: 3.1080 - accuracy100: 0.4587 - val_loss: 3.6098 - val_accuracy100: 0.3523 - 49s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 3.1023 - accuracy100: 0.4600 - val_loss: 3.6394 - val_accuracy100: 0.3531 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 3.0992 - accuracy100: 0.4623 - val_loss: 3.6621 - val_accuracy100: 0.3540 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h100
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0844977
{'0': {'precision': 0.5231795971874628, 'recall': 0.029308610544868656, 'f1-score': 0.05550767181773927, 'support': 449356}, '1': {'precision': 0.49106527066659345, 'recall': 0.6373621329081047, 'f1-score': 0.554730250821026, 'support': 827790}, '2': {'precision': 0.32055731413294847, 'recall': 0.45227703984819734, 'f1-score': 0.3751922061717138, 'support': 432140}, 'accuracy': 0.43071727025202333, 'macro avg': {'precision': 0.44493406066233493, 'recall': 0.37298259443372356, 'f1-score': 0.328476709603493, 'support': 1709286}, 'weighted avg': {'precision': 0.45640018651546976, 'recall': 0.43071727025202333, 'f1-score': 0.3780984689978819, 'support': 1709286}}
[[ 13170 312345 123841]
 [  9766 527602 290422]
 [  2237 234456 195447]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1383065
{'0': {'precision': 0.4361360718870347, 'recall': 0.076776506358239, 'f1-score': 0.13056807462530134, 'support': 194708}, '1': {'precision': 0.33054813830580076, 'recall': 0.813011621634361, 'f1-score': 0.47000513198589694, 'support': 190937}, '2': {'precision': 0.3885307816524536, 'recall': 0.1506977659067851, 'f1-score': 0.2171647663910428, 'support': 193188}, 'accuracy': 0.3443065616507697, 'macro avg': {'precision': 0.3850716639484297, 'recall': 0.346828631299795, 'f1-score': 0.27257932433408033, 'support': 578833}, 'weighted avg': {'precision': 0.3854177920307751, 'recall': 0.3443065616507697, 'f1-score': 0.27143864542914303, 'support': 578833}}
[[ 14949 158247  21512]
 [ 11397 155234  24306]
 [  7930 156145  29113]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1373526
{'0': {'precision': 0.37902357890617355, 'recall': 0.0572975211500917, 'f1-score': 0.09954646486708722, 'support': 67612}, '1': {'precision': 0.3610421989360783, 'recall': 0.7716271646948654, 'f1-score': 0.4919175484841987, 'support': 75819}, '2': {'precision': 0.386682272715707, 'recall': 0.22304903644342683, 'f1-score': 0.28290857642831874, 'support': 68133}, 'accuracy': 0.36667391427653095, 'macro avg': {'precision': 0.3755826835193196, 'recall': 0.3506579074294613, 'f1-score': 0.2914575299265349, 'support': 211564}, 'weighted avg': {'precision': 0.3750459623805467, 'recall': 0.36667391427653095, 'f1-score': 0.29921273103603446, 'support': 211564}}
[[ 3874 53189 10549]
 [ 3760 58504 13555]
 [ 2587 50349 15197]]
training model: results/AAL/W0/deepLOB_L1/h200
Epoch 1/50
2262/2262 - 53s - loss: 3.2574 - accuracy200: 0.3912 - val_loss: 3.3908 - val_accuracy200: 0.3475 - 53s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 51s - loss: 3.2331 - accuracy200: 0.4053 - val_loss: 3.3555 - val_accuracy200: 0.3552 - 51s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.2236 - accuracy200: 0.4084 - val_loss: 3.3687 - val_accuracy200: 0.3552 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.2182 - accuracy200: 0.4107 - val_loss: 3.3963 - val_accuracy200: 0.3492 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 3.2130 - accuracy200: 0.4137 - val_loss: 3.3716 - val_accuracy200: 0.3562 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 49s - loss: 3.2099 - accuracy200: 0.4162 - val_loss: 3.3690 - val_accuracy200: 0.3645 - 49s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 49s - loss: 3.2070 - accuracy200: 0.4168 - val_loss: 3.4025 - val_accuracy200: 0.3501 - 49s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 3.2046 - accuracy200: 0.4185 - val_loss: 3.3918 - val_accuracy200: 0.3496 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 49s - loss: 3.2021 - accuracy200: 0.4205 - val_loss: 3.4514 - val_accuracy200: 0.3535 - 49s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 3.2003 - accuracy200: 0.4212 - val_loss: 3.4259 - val_accuracy200: 0.3494 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 3.1972 - accuracy200: 0.4232 - val_loss: 3.4495 - val_accuracy200: 0.3490 - 50s/epoch - 22ms/step
Epoch 12/50
2262/2262 - 49s - loss: 3.1945 - accuracy200: 0.4237 - val_loss: 3.4576 - val_accuracy200: 0.3452 - 49s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h200
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951554
{'0': {'precision': 0.39645854892491666, 'recall': 0.04139603568126973, 'f1-score': 0.074964670072834, 'support': 499758}, '1': {'precision': 0.4412264286087848, 'recall': 0.7788293657960963, 'f1-score': 0.5633186631984765, 'support': 747441}, '2': {'precision': 0.28295747584830694, 'recall': 0.2068268529519333, 'f1-score': 0.2389754053270121, 'support': 462087}, 'accuracy': 0.40858522213368625, 'macro avg': {'precision': 0.37354748446066943, 'recall': 0.34235075147643307, 'f1-score': 0.2924195795327742, 'support': 1709286}, 'weighted avg': {'precision': 0.385350974419561, 'recall': 0.40858522213368625, 'f1-score': 0.3328518964335605, 'support': 1709286}}
[[ 20688 383950  95120]
 [ 18243 582129 147069]
 [ 13251 353264  95572]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1198213
{'0': {'precision': 0.3387691097471355, 'recall': 0.34034555011932555, 'f1-score': 0.3395555002243507, 'support': 192331}, '1': {'precision': 0.3358345348577463, 'recall': 0.5037850517112699, 'f1-score': 0.4030120812238408, 'support': 196959}, '2': {'precision': 0.3707972356875839, 'recall': 0.17635576096189257, 'f1-score': 0.23902721565150237, 'support': 189543}, 'accuracy': 0.34225933904943223, 'macro avg': {'precision': 0.34846696009748857, 'recall': 0.34016212093082937, 'f1-score': 0.32719826569989796, 'support': 578833}, 'weighted avg': {'precision': 0.34825840310029815, 'recall': 0.34225933904943223, 'f1-score': 0.328229110910485, 'support': 578833}}
[[65459 98748 28124]
 [69136 99225 28598]
 [58631 97485 33427]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.116914
{'0': {'precision': 0.3227129944227194, 'recall': 0.15157628496582456, 'f1-score': 0.20626920712968655, 'support': 66422}, '1': {'precision': 0.36777146945616673, 'recall': 0.7161895423993395, 'f1-score': 0.48598441740348425, 'support': 77513}, '2': {'precision': 0.3366871749549611, 'recall': 0.14646083780626654, 'f1-score': 0.2041257934218119, 'support': 67629}, 'accuracy': 0.356804560322172, 'macro avg': {'precision': 0.34239054627794907, 'recall': 0.33807555505714354, 'f1-score': 0.29879313931832757, 'support': 211564}, 'weighted avg': {'precision': 0.3436885735878069, 'recall': 0.356804560322172, 'f1-score': 0.3080663378716985, 'support': 211564}}
[[10068 47058  9296]
 [11781 55514 10218]
 [ 9349 48375  9905]]
training model: results/AAL/W0/deepLOB_L1/h300
Epoch 1/50
2262/2262 - 51s - loss: 3.2742 - accuracy300: 0.3825 - val_loss: 3.4441 - val_accuracy300: 0.3263 - 51s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.2476 - accuracy300: 0.3951 - val_loss: 3.4012 - val_accuracy300: 0.3320 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.2381 - accuracy300: 0.4007 - val_loss: 3.3925 - val_accuracy300: 0.3301 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.2295 - accuracy300: 0.4060 - val_loss: 3.3920 - val_accuracy300: 0.3329 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 49s - loss: 3.2263 - accuracy300: 0.4082 - val_loss: 3.4016 - val_accuracy300: 0.3319 - 49s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 3.2218 - accuracy300: 0.4110 - val_loss: 3.4121 - val_accuracy300: 0.3328 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 50s - loss: 3.2169 - accuracy300: 0.4138 - val_loss: 3.3976 - val_accuracy300: 0.3337 - 50s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 3.2133 - accuracy300: 0.4155 - val_loss: 3.4491 - val_accuracy300: 0.3338 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 51s - loss: 3.2111 - accuracy300: 0.4174 - val_loss: 3.4500 - val_accuracy300: 0.3320 - 51s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 3.2081 - accuracy300: 0.4188 - val_loss: 3.4192 - val_accuracy300: 0.3339 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 3.2045 - accuracy300: 0.4206 - val_loss: 3.3958 - val_accuracy300: 0.3371 - 50s/epoch - 22ms/step
Epoch 12/50
2262/2262 - 50s - loss: 3.2023 - accuracy300: 0.4220 - val_loss: 3.4199 - val_accuracy300: 0.3364 - 50s/epoch - 22ms/step
Epoch 13/50
2262/2262 - 50s - loss: 3.1990 - accuracy300: 0.4227 - val_loss: 3.4420 - val_accuracy300: 0.3312 - 50s/epoch - 22ms/step
Epoch 14/50
2262/2262 - 50s - loss: 3.1959 - accuracy300: 0.4247 - val_loss: 3.4557 - val_accuracy300: 0.3342 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h300
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1107223
{'0': {'precision': 0.37480867346938773, 'recall': 0.03254086757190238, 'f1-score': 0.0598827207561845, 'support': 541811}, '1': {'precision': 0.4000791383584681, 'recall': 0.7774528261740447, 'f1-score': 0.52829590393931, 'support': 681469}, '2': {'precision': 0.2878044161984479, 'recall': 0.20014773480162795, 'f1-score': 0.23610266641909056, 'support': 486006}, 'accuracy': 0.3771832215322655, 'macro avg': {'precision': 0.3542307426754346, 'recall': 0.33671380951585833, 'f1-score': 0.27476043037152836, 'support': 1709286}, 'weighted avg': {'precision': 0.3601455026356457, 'recall': 0.3771832215322655, 'f1-score': 0.2967377669231031, 'support': 1709286}}
[[ 17631 417940 106240]
 [ 17189 529810 134470]
 [ 12220 376513  97273]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.129241
{'0': {'precision': 0.3460989868280956, 'recall': 0.261269139971388, 'f1-score': 0.29776005899433106, 'support': 197819}, '1': {'precision': 0.32127699351240835, 'recall': 0.4316642884246418, 'f1-score': 0.36837880487827124, 'support': 187113}, '2': {'precision': 0.34773185398967976, 'recall': 0.31938979169782516, 'f1-score': 0.33295877934827606, 'support': 193901}, 'accuracy': 0.335820521635774, 'macro avg': {'precision': 0.3383692781100612, 'recall': 0.3374410733646183, 'f1-score': 0.33303254774029273, 'support': 578833}, 'weighted avg': {'precision': 0.3386220408699697, 'recall': 0.335820521635774, 'f1-score': 0.3323792885025519, 'support': 578833}}
[[51684 85707 60428]
 [50604 80770 55739]
 [47045 84926 61930]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1308848
{'0': {'precision': 0.3107837241932251, 'recall': 0.13594914511179307, 'f1-score': 0.18915456874466266, 'support': 68430}, '1': {'precision': 0.3396626221865989, 'recall': 0.5062547202197047, 'f1-score': 0.4065546292620529, 'support': 72825}, '2': {'precision': 0.33341086650156665, 'recall': 0.3465843633105292, 'f1-score': 0.3398700103210689, 'support': 70309}, 'accuracy': 0.3334168384035091, 'macro avg': {'precision': 0.3279524042937969, 'recall': 0.32959607621400905, 'f1-score': 0.3118597361092615, 'support': 211564}, 'weighted avg': {'precision': 0.3282441498560251, 'recall': 0.3334168384035091, 'f1-score': 0.3140756866521256, 'support': 211564}}
[[ 9303 35689 23438]
 [10676 36868 25281]
 [ 9955 35986 24368]]
training model: results/AAL/W0/deepLOB_L1/h500
Epoch 1/50
2262/2262 - 52s - loss: 3.1734 - accuracy500: 0.4358 - val_loss: 3.3617 - val_accuracy500: 0.4311 - 52s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.1581 - accuracy500: 0.4489 - val_loss: 3.3643 - val_accuracy500: 0.4311 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 49s - loss: 3.1409 - accuracy500: 0.4525 - val_loss: 3.4428 - val_accuracy500: 0.4311 - 49s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.1230 - accuracy500: 0.4606 - val_loss: 3.4861 - val_accuracy500: 0.4312 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 3.1251 - accuracy500: 0.4596 - val_loss: 3.5024 - val_accuracy500: 0.4303 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 3.1141 - accuracy500: 0.4650 - val_loss: 3.5391 - val_accuracy500: 0.4306 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 50s - loss: 3.1136 - accuracy500: 0.4659 - val_loss: 3.5662 - val_accuracy500: 0.4303 - 50s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 3.1108 - accuracy500: 0.4675 - val_loss: 3.5657 - val_accuracy500: 0.4229 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 50s - loss: 3.1046 - accuracy500: 0.4713 - val_loss: 3.5704 - val_accuracy500: 0.4166 - 50s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 3.0995 - accuracy500: 0.4732 - val_loss: 3.6447 - val_accuracy500: 0.4191 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 3.0974 - accuracy500: 0.4718 - val_loss: 3.7340 - val_accuracy500: 0.4219 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h500
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0739919
{'0': {'precision': 0.34573947110675807, 'recall': 0.0007458649920976344, 'f1-score': 0.0014885187972936789, 'support': 473276}, '1': {'precision': 0.4687055363669542, 'recall': 0.995511244980421, 'f1-score': 0.6373395496922455, 'support': 801113}, '2': {'precision': 0.24517374517374518, 'recall': 0.0037963011931560807, 'f1-score': 0.007476830204401412, 'support': 434897}, 'accuracy': 0.4677514470954539, 'macro avg': {'precision': 0.3532062508824858, 'recall': 0.3333511370552249, 'f1-score': 0.21543496623131353, 'support': 1709286}, 'weighted avg': {'precision': 0.3777844190719915, 'recall': 0.4677514470954539, 'f1-score': 0.3010245973583797, 'support': 1709286}}
[[   353 471056   1867]
 [   380 797517   3216]
 [   288 432958   1651]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.2009194
{'0': {'precision': 0.49074074074074076, 'recall': 0.00027476800248846494, 'f1-score': 0.0005492284894143981, 'support': 192890}, '1': {'precision': 0.33996599492518365, 'recall': 0.9991053592033631, 'f1-score': 0.5073095566258343, 'support': 196727}, '2': {'precision': 0.3836805555555556, 'recall': 0.0011679773380686622, 'f1-score': 0.0023288652841004886, 'support': 189216}, 'accuracy': 0.3400376274331284, 'macro avg': {'precision': 0.4047957637404933, 'recall': 0.3335160348479734, 'f1-score': 0.1700625501331164, 'support': 578833}, 'weighted avg': {'precision': 0.4045000401931612, 'recall': 0.3400376274331284, 'f1-score': 0.17336275990354733, 'support': 578833}}
[[    53 192638    199]
 [    20 196551    156]
 [    35 188960    221]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1167697
{'0': {'precision': 0.18518518518518517, 'recall': 0.00017080294464276563, 'f1-score': 0.00034129110424736776, 'support': 58547}, '1': {'precision': 0.4311787576422006, 'recall': 0.9981582380477323, 'f1-score': 0.602215755010252, 'support': 91217}, '2': {'precision': 0.30835734870317005, 'recall': 0.0017313915857605179, 'f1-score': 0.0034434485976796952, 'support': 61800}, 'accuracy': 0.43091452231948724, 'macro avg': {'precision': 0.3082404305101853, 'recall': 0.33335347752604516, 'f1-score': 0.2020001649040597, 'support': 211564}, 'weighted avg': {'precision': 0.32722653155896825, 'recall': 0.43091452231948724, 'f1-score': 0.2607489989714088, 'support': 211564}}
[[   10 58439    98]
 [   26 91049   142]
 [   18 61675   107]]
training model: results/AAL/W0/deepLOB_L1/h1000
Epoch 1/50
2262/2262 - 52s - loss: 3.1958 - accuracy1000: 0.4306 - val_loss: 3.4240 - val_accuracy1000: 0.3480 - 52s/epoch - 23ms/step
Epoch 2/50
2262/2262 - 50s - loss: 3.1308 - accuracy1000: 0.4535 - val_loss: 3.4640 - val_accuracy1000: 0.3263 - 50s/epoch - 22ms/step
Epoch 3/50
2262/2262 - 50s - loss: 3.1150 - accuracy1000: 0.4587 - val_loss: 3.6294 - val_accuracy1000: 0.3338 - 50s/epoch - 22ms/step
Epoch 4/50
2262/2262 - 50s - loss: 3.1119 - accuracy1000: 0.4587 - val_loss: 3.7117 - val_accuracy1000: 0.3382 - 50s/epoch - 22ms/step
Epoch 5/50
2262/2262 - 50s - loss: 3.1047 - accuracy1000: 0.4618 - val_loss: 3.5082 - val_accuracy1000: 0.3438 - 50s/epoch - 22ms/step
Epoch 6/50
2262/2262 - 50s - loss: 3.0998 - accuracy1000: 0.4647 - val_loss: 3.5948 - val_accuracy1000: 0.3456 - 50s/epoch - 22ms/step
Epoch 7/50
2262/2262 - 50s - loss: 3.0897 - accuracy1000: 0.4687 - val_loss: 3.4447 - val_accuracy1000: 0.3488 - 50s/epoch - 22ms/step
Epoch 8/50
2262/2262 - 50s - loss: 3.0824 - accuracy1000: 0.4709 - val_loss: 3.6703 - val_accuracy1000: 0.3343 - 50s/epoch - 22ms/step
Epoch 9/50
2262/2262 - 50s - loss: 3.0761 - accuracy1000: 0.4738 - val_loss: 3.6498 - val_accuracy1000: 0.3367 - 50s/epoch - 22ms/step
Epoch 10/50
2262/2262 - 50s - loss: 3.0746 - accuracy1000: 0.4740 - val_loss: 3.7769 - val_accuracy1000: 0.3247 - 50s/epoch - 22ms/step
Epoch 11/50
2262/2262 - 50s - loss: 3.0655 - accuracy1000: 0.4774 - val_loss: 3.9306 - val_accuracy1000: 0.3245 - 50s/epoch - 22ms/step
testing model: results/AAL/W0/deepLOB_L1/h1000
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0855021
{'0': {'precision': 0.29528678606001935, 'recall': 0.06391895697044706, 'f1-score': 0.10508976394907545, 'support': 458127}, '1': {'precision': 0.49196527391468586, 'recall': 0.7074494449733808, 'f1-score': 0.5803506568600015, 'support': 841311}, '2': {'precision': 0.23783745974964215, 'recall': 0.2323007554020027, 'f1-score': 0.2350365053600854, 'support': 409848}, 'accuracy': 0.42103896012721104, 'macro avg': {'precision': 0.3416965065747825, 'recall': 0.3345563857819435, 'f1-score': 0.30682564205638746, 'support': 1709286}, 'weighted avg': {'precision': 0.37831694239771935, 'recall': 0.42103896012721104, 'f1-score': 0.3701715753894101, 'support': 1709286}}
[[ 29283 324677 104167]
 [ 45194 595185 200932]
 [ 24691 289949  95208]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.154883
{'0': {'precision': 0.31443936652046334, 'recall': 0.1590186396422016, 'f1-score': 0.21121924083320168, 'support': 193405}, '1': {'precision': 0.33292036189208785, 'recall': 0.6873993950889424, 'f1-score': 0.4485834049799111, 'support': 195070}, '2': {'precision': 0.346048663292951, 'recall': 0.14225301799766754, 'f1-score': 0.20162317114031492, 'support': 190358}, 'accuracy': 0.3315723187862475, 'macro avg': {'precision': 0.3311361305685007, 'recall': 0.32955701757627054, 'f1-score': 0.2871419389844759, 'support': 578833}, 'weighted avg': {'precision': 0.33106276270236723, 'recall': 0.3315723187862475, 'f1-score': 0.2880564959059084, 'support': 578833}}
[[ 30755 135393  27257]
 [ 37063 134091  23916]
 [ 29991 133288  27079]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.139591
{'0': {'precision': 0.2843574448369723, 'recall': 0.07467112767089955, 'f1-score': 0.118281901182819, 'support': 65755}, '1': {'precision': 0.35920754904642316, 'recall': 0.7618827872634979, 'f1-score': 0.48822836092652283, 'support': 75845}, '2': {'precision': 0.3220557001405965, 'recall': 0.1538791378423189, 'f1-score': 0.20825394369057867, 'support': 69964}, 'accuracy': 0.34722826189710915, 'macro avg': {'precision': 0.32187356467466394, 'recall': 0.3301443509255721, 'f1-score': 0.27158806859997353, 'support': 211564}, 'weighted avg': {'precision': 0.32365773641696016, 'recall': 0.34722826189710915, 'f1-score': 0.28066015656310167, 'support': 211564}}
[[ 4910 49863 10982]
 [ 6379 57785 11681]
 [ 5978 53220 10766]]
training model: results/AAL/W0/deepOF_L1/h10
Epoch 1/50
2262/2262 - 49s - loss: 3.1214 - accuracy10: 0.4143 - val_loss: 2.9999 - val_accuracy10: 0.5870 - 49s/epoch - 22ms/step
Epoch 2/50
2262/2262 - 46s - loss: 3.1095 - accuracy10: 0.3918 - val_loss: 2.9899 - val_accuracy10: 0.5832 - 46s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 46s - loss: 3.0924 - accuracy10: 0.4058 - val_loss: 2.9859 - val_accuracy10: 0.5817 - 46s/epoch - 20ms/step
Epoch 4/50
2262/2262 - 46s - loss: 3.0797 - accuracy10: 0.4149 - val_loss: 2.9782 - val_accuracy10: 0.5924 - 46s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 46s - loss: 3.0648 - accuracy10: 0.4262 - val_loss: 2.9614 - val_accuracy10: 0.5961 - 46s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 47s - loss: 3.0517 - accuracy10: 0.4428 - val_loss: 2.9516 - val_accuracy10: 0.6016 - 47s/epoch - 21ms/step
Epoch 7/50
2262/2262 - 46s - loss: 3.0414 - accuracy10: 0.4527 - val_loss: 2.9444 - val_accuracy10: 0.6052 - 46s/epoch - 21ms/step
Epoch 8/50
2262/2262 - 46s - loss: 3.0282 - accuracy10: 0.4595 - val_loss: 2.9337 - val_accuracy10: 0.6000 - 46s/epoch - 20ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.0174 - accuracy10: 0.4634 - val_loss: 2.9309 - val_accuracy10: 0.6013 - 46s/epoch - 20ms/step
Epoch 10/50
2262/2262 - 46s - loss: 3.0038 - accuracy10: 0.4661 - val_loss: 2.9285 - val_accuracy10: 0.6038 - 46s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 46s - loss: 2.9910 - accuracy10: 0.4686 - val_loss: 2.9241 - val_accuracy10: 0.6121 - 46s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 46s - loss: 2.9800 - accuracy10: 0.4710 - val_loss: 2.9229 - val_accuracy10: 0.6120 - 46s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 46s - loss: 2.9724 - accuracy10: 0.4723 - val_loss: 2.9175 - val_accuracy10: 0.6095 - 46s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 45s - loss: 2.9598 - accuracy10: 0.4762 - val_loss: 2.9217 - val_accuracy10: 0.6122 - 45s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 46s - loss: 2.9499 - accuracy10: 0.4786 - val_loss: 2.9162 - val_accuracy10: 0.6093 - 46s/epoch - 20ms/step
Epoch 16/50
2262/2262 - 46s - loss: 2.9387 - accuracy10: 0.4816 - val_loss: 2.9118 - val_accuracy10: 0.6102 - 46s/epoch - 21ms/step
Epoch 17/50
2262/2262 - 46s - loss: 2.9304 - accuracy10: 0.4845 - val_loss: 2.9115 - val_accuracy10: 0.6147 - 46s/epoch - 20ms/step
Epoch 18/50
2262/2262 - 46s - loss: 2.9241 - accuracy10: 0.4863 - val_loss: 2.8943 - val_accuracy10: 0.6054 - 46s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 46s - loss: 2.9152 - accuracy10: 0.4887 - val_loss: 2.8918 - val_accuracy10: 0.6075 - 46s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 46s - loss: 2.9068 - accuracy10: 0.4918 - val_loss: 2.8974 - val_accuracy10: 0.6130 - 46s/epoch - 20ms/step
Epoch 21/50
2262/2262 - 46s - loss: 2.8990 - accuracy10: 0.4949 - val_loss: 2.8859 - val_accuracy10: 0.6055 - 46s/epoch - 20ms/step
Epoch 22/50
2262/2262 - 46s - loss: 2.8909 - accuracy10: 0.4974 - val_loss: 2.8907 - val_accuracy10: 0.6090 - 46s/epoch - 20ms/step
Epoch 23/50
2262/2262 - 46s - loss: 2.8818 - accuracy10: 0.4994 - val_loss: 2.8730 - val_accuracy10: 0.6027 - 46s/epoch - 20ms/step
Epoch 24/50
2262/2262 - 46s - loss: 2.8761 - accuracy10: 0.5004 - val_loss: 2.8838 - val_accuracy10: 0.6028 - 46s/epoch - 20ms/step
Epoch 25/50
2262/2262 - 46s - loss: 2.8687 - accuracy10: 0.5031 - val_loss: 2.8807 - val_accuracy10: 0.6065 - 46s/epoch - 20ms/step
Epoch 26/50
2262/2262 - 46s - loss: 2.8625 - accuracy10: 0.5046 - val_loss: 2.8945 - val_accuracy10: 0.6065 - 46s/epoch - 20ms/step
Epoch 27/50
2262/2262 - 46s - loss: 2.8564 - accuracy10: 0.5059 - val_loss: 2.8815 - val_accuracy10: 0.6037 - 46s/epoch - 20ms/step
Epoch 28/50
2262/2262 - 46s - loss: 2.8514 - accuracy10: 0.5071 - val_loss: 2.8859 - val_accuracy10: 0.6069 - 46s/epoch - 20ms/step
Epoch 29/50
2262/2262 - 46s - loss: 2.8453 - accuracy10: 0.5091 - val_loss: 2.8926 - val_accuracy10: 0.6060 - 46s/epoch - 20ms/step
Epoch 30/50
2262/2262 - 46s - loss: 2.8388 - accuracy10: 0.5115 - val_loss: 2.9002 - val_accuracy10: 0.6077 - 46s/epoch - 20ms/step
Epoch 31/50
2262/2262 - 46s - loss: 2.8327 - accuracy10: 0.5132 - val_loss: 2.9063 - val_accuracy10: 0.6074 - 46s/epoch - 20ms/step
Epoch 32/50
2262/2262 - 47s - loss: 2.8291 - accuracy10: 0.5139 - val_loss: 2.9165 - val_accuracy10: 0.6107 - 47s/epoch - 21ms/step
Epoch 33/50
2262/2262 - 46s - loss: 2.8244 - accuracy10: 0.5149 - val_loss: 2.9116 - val_accuracy10: 0.6091 - 46s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h10
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8026624
{'0': {'precision': 0.2587255434881744, 'recall': 0.3980858826831322, 'f1-score': 0.31362117724578176, 'support': 178150}, '1': {'precision': 0.8558784771390119, 'recall': 0.7251494851644709, 'f1-score': 0.7851092477282475, 'support': 1345284}, '2': {'precision': 0.2688424687679859, 'recall': 0.42727620031531316, 'f1-score': 0.33002990334921667, 'support': 185847}, 'accuracy': 0.6586740272664354, 'macro avg': {'precision': 0.4611488297983907, 'recall': 0.5168371893876388, 'f1-score': 0.47625344277441534, 'support': 1709281}, 'weighted avg': {'precision': 0.7298127944469168, 'recall': 0.6586740272664354, 'f1-score': 0.6864884061748336, 'support': 1709281}}
[[ 70919  84391  22840]
 [176630 975532 193122]
 [ 26560  79879  79408]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.87715334
{'0': {'precision': 0.3659773210190815, 'recall': 0.3342588411617205, 'f1-score': 0.34939970776237367, 'support': 104087}, '1': {'precision': 0.7197945045957526, 'recall': 0.721854970124932, 'f1-score': 0.7208232649087265, 'support': 368200}, '2': {'precision': 0.3698858624935596, 'recall': 0.3975446763778345, 'f1-score': 0.38321684648616866, 'support': 106544}, 'accuracy': 0.5924613574601222, 'macro avg': {'precision': 0.4852192293694646, 'recall': 0.48455282922149573, 'f1-score': 0.4844799397190896, 'support': 578831}, 'weighted avg': {'precision': 0.5917632907335354, 'recall': 0.5924613574601222, 'f1-score': 0.5918904640789412, 'support': 578831}}
[[ 34792  53458  15837]
 [ 46095 265787  56318]
 [ 14179  50009  42356]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8608388
{'0': {'precision': 0.33759976352349985, 'recall': 0.3352019253345856, 'f1-score': 0.3363965715295573, 'support': 34072}, '1': {'precision': 0.7456159563128769, 'recall': 0.7187849697720411, 'f1-score': 0.7319546622423055, 'support': 142087}, '2': {'precision': 0.34268891069676155, 'recall': 0.39452054794520547, 'f1-score': 0.3667826429462351, 'support': 35405}, 'accuracy': 0.6027443232307954, 'macro avg': {'precision': 0.4753015435110461, 'recall': 0.4828358143506107, 'f1-score': 0.47837795890603263, 'support': 211564}, 'weighted avg': {'precision': 0.6124762928032145, 'recall': 0.6027443232307954, 'f1-score': 0.6071396152118933, 'support': 211564}}
[[ 11421  17980   4671]
 [ 17836 102130  22121]
 [  4573  16864  13968]]
training model: results/AAL/W0/deepOF_L1/h20
Epoch 1/50
2262/2262 - 49s - loss: 3.1485 - accuracy20: 0.4315 - val_loss: 3.1086 - val_accuracy20: 0.5344 - 49s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 47s - loss: 3.1365 - accuracy20: 0.4176 - val_loss: 3.0872 - val_accuracy20: 0.5382 - 47s/epoch - 21ms/step
Epoch 3/50
2262/2262 - 47s - loss: 3.1194 - accuracy20: 0.4366 - val_loss: 3.0777 - val_accuracy20: 0.5523 - 47s/epoch - 21ms/step
Epoch 4/50
2262/2262 - 47s - loss: 3.1032 - accuracy20: 0.4529 - val_loss: 3.0708 - val_accuracy20: 0.5504 - 47s/epoch - 21ms/step
Epoch 5/50
2262/2262 - 47s - loss: 3.0908 - accuracy20: 0.4598 - val_loss: 3.0598 - val_accuracy20: 0.5494 - 47s/epoch - 21ms/step
Epoch 6/50
2262/2262 - 46s - loss: 3.0810 - accuracy20: 0.4636 - val_loss: 3.0520 - val_accuracy20: 0.5519 - 46s/epoch - 21ms/step
Epoch 7/50
2262/2262 - 47s - loss: 3.0738 - accuracy20: 0.4667 - val_loss: 3.0457 - val_accuracy20: 0.5550 - 47s/epoch - 21ms/step
Epoch 8/50
2262/2262 - 46s - loss: 3.0639 - accuracy20: 0.4699 - val_loss: 3.0435 - val_accuracy20: 0.5547 - 46s/epoch - 21ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.0539 - accuracy20: 0.4733 - val_loss: 3.0395 - val_accuracy20: 0.5573 - 46s/epoch - 20ms/step
Epoch 10/50
2262/2262 - 46s - loss: 3.0439 - accuracy20: 0.4768 - val_loss: 3.0330 - val_accuracy20: 0.5557 - 46s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 46s - loss: 3.0361 - accuracy20: 0.4792 - val_loss: 3.0292 - val_accuracy20: 0.5585 - 46s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 46s - loss: 3.0267 - accuracy20: 0.4822 - val_loss: 3.0234 - val_accuracy20: 0.5568 - 46s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 46s - loss: 3.0171 - accuracy20: 0.4856 - val_loss: 3.0197 - val_accuracy20: 0.5575 - 46s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 46s - loss: 3.0073 - accuracy20: 0.4873 - val_loss: 3.0154 - val_accuracy20: 0.5589 - 46s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 47s - loss: 3.0007 - accuracy20: 0.4894 - val_loss: 3.0134 - val_accuracy20: 0.5608 - 47s/epoch - 21ms/step
Epoch 16/50
2262/2262 - 46s - loss: 2.9931 - accuracy20: 0.4903 - val_loss: 3.0094 - val_accuracy20: 0.5616 - 46s/epoch - 20ms/step
Epoch 17/50
2262/2262 - 47s - loss: 2.9827 - accuracy20: 0.4926 - val_loss: 3.0024 - val_accuracy20: 0.5596 - 47s/epoch - 21ms/step
Epoch 18/50
2262/2262 - 46s - loss: 2.9733 - accuracy20: 0.4954 - val_loss: 2.9987 - val_accuracy20: 0.5607 - 46s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 46s - loss: 2.9657 - accuracy20: 0.4965 - val_loss: 2.9985 - val_accuracy20: 0.5612 - 46s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 46s - loss: 2.9579 - accuracy20: 0.4986 - val_loss: 2.9898 - val_accuracy20: 0.5632 - 46s/epoch - 20ms/step
Epoch 21/50
2262/2262 - 46s - loss: 2.9508 - accuracy20: 0.5010 - val_loss: 3.0021 - val_accuracy20: 0.5643 - 46s/epoch - 20ms/step
Epoch 22/50
2262/2262 - 47s - loss: 2.9424 - accuracy20: 0.5025 - val_loss: 2.9950 - val_accuracy20: 0.5642 - 47s/epoch - 21ms/step
Epoch 23/50
2262/2262 - 47s - loss: 2.9362 - accuracy20: 0.5041 - val_loss: 2.9902 - val_accuracy20: 0.5635 - 47s/epoch - 21ms/step
Epoch 24/50
2262/2262 - 47s - loss: 2.9280 - accuracy20: 0.5061 - val_loss: 2.9905 - val_accuracy20: 0.5647 - 47s/epoch - 21ms/step
Epoch 25/50
2262/2262 - 47s - loss: 2.9215 - accuracy20: 0.5073 - val_loss: 2.9974 - val_accuracy20: 0.5657 - 47s/epoch - 21ms/step
Epoch 26/50
2262/2262 - 48s - loss: 2.9150 - accuracy20: 0.5086 - val_loss: 2.9976 - val_accuracy20: 0.5669 - 48s/epoch - 21ms/step
Epoch 27/50
2262/2262 - 47s - loss: 2.9087 - accuracy20: 0.5104 - val_loss: 3.0080 - val_accuracy20: 0.5671 - 47s/epoch - 21ms/step
Epoch 28/50
2262/2262 - 47s - loss: 2.9009 - accuracy20: 0.5128 - val_loss: 3.0129 - val_accuracy20: 0.5665 - 47s/epoch - 21ms/step
Epoch 29/50
2262/2262 - 46s - loss: 2.8942 - accuracy20: 0.5146 - val_loss: 3.0095 - val_accuracy20: 0.5670 - 46s/epoch - 20ms/step
Epoch 30/50
2262/2262 - 46s - loss: 2.8891 - accuracy20: 0.5156 - val_loss: 3.0228 - val_accuracy20: 0.5672 - 46s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h20
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8469081
{'0': {'precision': 0.3275546752872255, 'recall': 0.3514695285050667, 'f1-score': 0.3390909680092855, 'support': 245623}, '1': {'precision': 0.7776676356161875, 'recall': 0.7558600124617987, 'f1-score': 0.7666087657235333, 'support': 1213308}, '2': {'precision': 0.34348317263484224, 'recall': 0.3655602156980228, 'f1-score': 0.35417799458581894, 'support': 250350}, 'accuracy': 0.6405839648366769, 'macro avg': {'precision': 0.48290182784608504, 'recall': 0.49096325222162934, 'f1-score': 0.486625909439546, 'support': 1709281}, 'weighted avg': {'precision': 0.6493937146153337, 'recall': 0.6405839648366769, 'f1-score': 0.6447679170963657, 'support': 1709281}}
[[ 86329 132125  27169]
 [148463 917091 147754]
 [ 28764 130068  91518]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.94611263
{'0': {'precision': 0.4397480640650521, 'recall': 0.27560887592703065, 'f1-score': 0.3388475398851886, 'support': 135783}, '1': {'precision': 0.5970297358884322, 'recall': 0.7648359713125898, 'f1-score': 0.6705944874538586, 'support': 305221}, '2': {'precision': 0.43738865470546434, 'recall': 0.3259811212607109, 'f1-score': 0.3735553818780451, 'support': 137827}, 'accuracy': 0.5455754788530677, 'macro avg': {'precision': 0.4913888182196496, 'recall': 0.45547532283344383, 'f1-score': 0.4609991364056974, 'support': 578831}, 'weighted avg': {'precision': 0.5221218119151154, 'recall': 0.5455754788530677, 'f1-score': 0.5220440390744278, 'support': 578831}}
[[ 37423  80011  18349]
 [ 32334 233444  39443]
 [ 15344  77554  44929]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9279155
{'0': {'precision': 0.42104925808415855, 'recall': 0.28716312211754935, 'f1-score': 0.34145073680380483, 'support': 45751}, '1': {'precision': 0.6302105490734864, 'recall': 0.7579600738131186, 'f1-score': 0.6882070927279165, 'support': 119220}, '2': {'precision': 0.41521068859198357, 'recall': 0.3294915545253579, 'f1-score': 0.36741776059927966, 'support': 46593}, 'accuracy': 0.5617874496606228, 'macro avg': {'precision': 0.48882349858320945, 'recall': 0.45820491681867526, 'f1-score': 0.46569186337700036, 'support': 211564}, 'weighted avg': {'precision': 0.5376294543528941, 'recall': 0.5617874496606228, 'f1-score': 0.5425727343694358, 'support': 211564}}
[[13138 26832  5781]
 [13015 90364 15841]
 [ 5050 26191 15352]]
training model: results/AAL/W0/deepOF_L1/h30
Epoch 1/50
2262/2262 - 48s - loss: 3.1598 - accuracy30: 0.4378 - val_loss: 3.1830 - val_accuracy30: 0.4843 - 48s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 47s - loss: 3.1665 - accuracy30: 0.4246 - val_loss: 3.1735 - val_accuracy30: 0.4873 - 47s/epoch - 21ms/step
Epoch 3/50
2262/2262 - 47s - loss: 3.1571 - accuracy30: 0.4315 - val_loss: 3.1664 - val_accuracy30: 0.4918 - 47s/epoch - 21ms/step
Epoch 4/50
2262/2262 - 46s - loss: 3.1460 - accuracy30: 0.4382 - val_loss: 3.1557 - val_accuracy30: 0.4932 - 46s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 47s - loss: 3.1386 - accuracy30: 0.4425 - val_loss: 3.1521 - val_accuracy30: 0.4953 - 47s/epoch - 21ms/step
Epoch 6/50
2262/2262 - 47s - loss: 3.1294 - accuracy30: 0.4476 - val_loss: 3.1490 - val_accuracy30: 0.4969 - 47s/epoch - 21ms/step
Epoch 7/50
2262/2262 - 47s - loss: 3.1219 - accuracy30: 0.4526 - val_loss: 3.1345 - val_accuracy30: 0.5017 - 47s/epoch - 21ms/step
Epoch 8/50
2262/2262 - 47s - loss: 3.1132 - accuracy30: 0.4580 - val_loss: 3.1302 - val_accuracy30: 0.5036 - 47s/epoch - 21ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.1039 - accuracy30: 0.4634 - val_loss: 3.1305 - val_accuracy30: 0.5060 - 46s/epoch - 21ms/step
Epoch 10/50
2262/2262 - 47s - loss: 3.0943 - accuracy30: 0.4665 - val_loss: 3.1189 - val_accuracy30: 0.5077 - 47s/epoch - 21ms/step
Epoch 11/50
2262/2262 - 47s - loss: 3.0850 - accuracy30: 0.4705 - val_loss: 3.1178 - val_accuracy30: 0.5083 - 47s/epoch - 21ms/step
Epoch 12/50
2262/2262 - 47s - loss: 3.0776 - accuracy30: 0.4737 - val_loss: 3.1126 - val_accuracy30: 0.5093 - 47s/epoch - 21ms/step
Epoch 13/50
2262/2262 - 47s - loss: 3.0683 - accuracy30: 0.4761 - val_loss: 3.1107 - val_accuracy30: 0.5106 - 47s/epoch - 21ms/step
Epoch 14/50
2262/2262 - 46s - loss: 3.0592 - accuracy30: 0.4784 - val_loss: 3.1080 - val_accuracy30: 0.5125 - 46s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 47s - loss: 3.0503 - accuracy30: 0.4809 - val_loss: 3.1027 - val_accuracy30: 0.5128 - 47s/epoch - 21ms/step
Epoch 16/50
2262/2262 - 47s - loss: 3.0417 - accuracy30: 0.4838 - val_loss: 3.1021 - val_accuracy30: 0.5139 - 47s/epoch - 21ms/step
Epoch 17/50
2262/2262 - 46s - loss: 3.0331 - accuracy30: 0.4861 - val_loss: 3.0945 - val_accuracy30: 0.5142 - 46s/epoch - 21ms/step
Epoch 18/50
2262/2262 - 47s - loss: 3.0239 - accuracy30: 0.4890 - val_loss: 3.0972 - val_accuracy30: 0.5160 - 47s/epoch - 21ms/step
Epoch 19/50
2262/2262 - 46s - loss: 3.0156 - accuracy30: 0.4912 - val_loss: 3.1006 - val_accuracy30: 0.5163 - 46s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 46s - loss: 3.0084 - accuracy30: 0.4927 - val_loss: 3.0946 - val_accuracy30: 0.5171 - 46s/epoch - 21ms/step
Epoch 21/50
2262/2262 - 47s - loss: 2.9989 - accuracy30: 0.4959 - val_loss: 3.0940 - val_accuracy30: 0.5180 - 47s/epoch - 21ms/step
Epoch 22/50
2262/2262 - 46s - loss: 2.9907 - accuracy30: 0.4980 - val_loss: 3.1089 - val_accuracy30: 0.5199 - 46s/epoch - 21ms/step
Epoch 23/50
2262/2262 - 47s - loss: 2.9825 - accuracy30: 0.4999 - val_loss: 3.1117 - val_accuracy30: 0.5188 - 47s/epoch - 21ms/step
Epoch 24/50
2262/2262 - 47s - loss: 2.9740 - accuracy30: 0.5020 - val_loss: 3.0984 - val_accuracy30: 0.5200 - 47s/epoch - 21ms/step
Epoch 25/50
2262/2262 - 46s - loss: 2.9680 - accuracy30: 0.5042 - val_loss: 3.1085 - val_accuracy30: 0.5213 - 46s/epoch - 21ms/step
Epoch 26/50
2262/2262 - 47s - loss: 2.9612 - accuracy30: 0.5058 - val_loss: 3.1100 - val_accuracy30: 0.5213 - 47s/epoch - 21ms/step
Epoch 27/50
2262/2262 - 47s - loss: 2.9538 - accuracy30: 0.5081 - val_loss: 3.1142 - val_accuracy30: 0.5233 - 47s/epoch - 21ms/step
Epoch 28/50
2262/2262 - 47s - loss: 2.9463 - accuracy30: 0.5096 - val_loss: 3.1039 - val_accuracy30: 0.5213 - 47s/epoch - 21ms/step
Epoch 29/50
2262/2262 - 47s - loss: 2.9408 - accuracy30: 0.5113 - val_loss: 3.1143 - val_accuracy30: 0.5238 - 47s/epoch - 21ms/step
Epoch 30/50
2262/2262 - 47s - loss: 2.9355 - accuracy30: 0.5125 - val_loss: 3.1186 - val_accuracy30: 0.5226 - 47s/epoch - 21ms/step
Epoch 31/50
2262/2262 - 48s - loss: 2.9296 - accuracy30: 0.5139 - val_loss: 3.1311 - val_accuracy30: 0.5235 - 48s/epoch - 21ms/step
testing model: results/AAL/W0/deepOF_L1/h30
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8835698
{'0': {'precision': 0.37147510902558006, 'recall': 0.30923846117612225, 'f1-score': 0.33751168217864136, 'support': 297214}, '1': {'precision': 0.7072504924971843, 'recall': 0.8012399024791773, 'f1-score': 0.7513171015526076, 'support': 1115249}, '2': {'precision': 0.4024485516852064, 'recall': 0.26900996570288865, 'f1-score': 0.3224701698837489, 'support': 296818}, 'accuracy': 0.6232673270222977, 'macro avg': {'precision': 0.49372471773599025, 'recall': 0.45982944311939605, 'f1-score': 0.4704329845383326, 'support': 1709281}, 'weighted avg': {'precision': 0.5959359413548858, 'recall': 0.6232673270222977, 'f1-score': 0.6048939841846023, 'support': 1709281}}
[[ 91910 181821  23483]
 [126594 893582  95073]
 [ 28915 188056  79847]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0018958
{'0': {'precision': 0.4717063009894116, 'recall': 0.2430307134096484, 'f1-score': 0.3207868531775141, 'support': 156544}, '1': {'precision': 0.5078129441864873, 'recall': 0.8106938766248255, 'f1-score': 0.6244652478467895, 'support': 264413}, '2': {'precision': 0.48688483637272045, 'recall': 0.23456047227535884, 'f1-score': 0.3165976292154524, 'support': 157874}, 'accuracy': 0.5000319609696094, 'macro avg': {'precision': 0.48880136051620643, 'recall': 0.42942835410327757, 'f1-score': 0.4206165767465853, 'support': 578831}, 'weighted avg': {'precision': 0.49233989169684234, 'recall': 0.5000319609696094, 'f1-score': 0.4583661221280378, 'support': 578831}}
[[ 38045 103233  15266]
 [ 26295 214358  23760]
 [ 16314 104529  37031]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.98206055
{'0': {'precision': 0.4552562395438561, 'recall': 0.24905674474205236, 'f1-score': 0.3219723037173869, 'support': 53538}, '1': {'precision': 0.5397735360724685, 'recall': 0.8013101904771053, 'f1-score': 0.6450395697777366, 'support': 104107}, '2': {'precision': 0.4608115419296664, 'recall': 0.23694801461451437, 'f1-score': 0.31296849737886434, 'support': 53919}, 'accuracy': 0.5177251328203286, 'macro avg': {'precision': 0.485280439181997, 'recall': 0.42910498327789065, 'f1-score': 0.42666012362466255, 'support': 211564}, 'weighted avg': {'precision': 0.4982615643583082, 'recall': 0.5177251328203286, 'f1-score': 0.4786534386636822, 'support': 211564}}
[[13334 35274  4930]
 [10666 83422 10019]
 [ 5289 35854 12776]]
training model: results/AAL/W0/deepOF_L1/h50
Epoch 1/50
2262/2262 - 48s - loss: 3.1996 - accuracy50: 0.4272 - val_loss: 3.2629 - val_accuracy50: 0.4015 - 48s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 46s - loss: 3.2050 - accuracy50: 0.4191 - val_loss: 3.2543 - val_accuracy50: 0.4049 - 46s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 47s - loss: 3.1928 - accuracy50: 0.4271 - val_loss: 3.2522 - val_accuracy50: 0.4086 - 47s/epoch - 21ms/step
Epoch 4/50
2262/2262 - 47s - loss: 3.1836 - accuracy50: 0.4321 - val_loss: 3.2472 - val_accuracy50: 0.4110 - 47s/epoch - 21ms/step
Epoch 5/50
2262/2262 - 47s - loss: 3.1764 - accuracy50: 0.4366 - val_loss: 3.2409 - val_accuracy50: 0.4177 - 47s/epoch - 21ms/step
Epoch 6/50
2262/2262 - 47s - loss: 3.1658 - accuracy50: 0.4416 - val_loss: 3.2363 - val_accuracy50: 0.4226 - 47s/epoch - 21ms/step
Epoch 7/50
2262/2262 - 46s - loss: 3.1593 - accuracy50: 0.4458 - val_loss: 3.2350 - val_accuracy50: 0.4234 - 46s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 46s - loss: 3.1534 - accuracy50: 0.4475 - val_loss: 3.2294 - val_accuracy50: 0.4260 - 46s/epoch - 20ms/step
Epoch 9/50
2262/2262 - 47s - loss: 3.1466 - accuracy50: 0.4502 - val_loss: 3.2239 - val_accuracy50: 0.4276 - 47s/epoch - 21ms/step
Epoch 10/50
2262/2262 - 47s - loss: 3.1398 - accuracy50: 0.4525 - val_loss: 3.2246 - val_accuracy50: 0.4295 - 47s/epoch - 21ms/step
Epoch 11/50
2262/2262 - 46s - loss: 3.1321 - accuracy50: 0.4559 - val_loss: 3.2254 - val_accuracy50: 0.4297 - 46s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 46s - loss: 3.1268 - accuracy50: 0.4579 - val_loss: 3.2210 - val_accuracy50: 0.4317 - 46s/epoch - 21ms/step
Epoch 13/50
2262/2262 - 47s - loss: 3.1201 - accuracy50: 0.4599 - val_loss: 3.2221 - val_accuracy50: 0.4323 - 47s/epoch - 21ms/step
Epoch 14/50
2262/2262 - 47s - loss: 3.1103 - accuracy50: 0.4628 - val_loss: 3.2162 - val_accuracy50: 0.4358 - 47s/epoch - 21ms/step
Epoch 15/50
2262/2262 - 46s - loss: 3.1034 - accuracy50: 0.4654 - val_loss: 3.2183 - val_accuracy50: 0.4354 - 46s/epoch - 20ms/step
Epoch 16/50
2262/2262 - 47s - loss: 3.0975 - accuracy50: 0.4674 - val_loss: 3.2155 - val_accuracy50: 0.4374 - 47s/epoch - 21ms/step
Epoch 17/50
2262/2262 - 46s - loss: 3.0904 - accuracy50: 0.4693 - val_loss: 3.2104 - val_accuracy50: 0.4398 - 46s/epoch - 20ms/step
Epoch 18/50
2262/2262 - 46s - loss: 3.0830 - accuracy50: 0.4715 - val_loss: 3.2169 - val_accuracy50: 0.4374 - 46s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 47s - loss: 3.0763 - accuracy50: 0.4735 - val_loss: 3.2162 - val_accuracy50: 0.4392 - 47s/epoch - 21ms/step
Epoch 20/50
2262/2262 - 47s - loss: 3.0687 - accuracy50: 0.4758 - val_loss: 3.2158 - val_accuracy50: 0.4397 - 47s/epoch - 21ms/step
Epoch 21/50
2262/2262 - 47s - loss: 3.0628 - accuracy50: 0.4779 - val_loss: 3.2133 - val_accuracy50: 0.4408 - 47s/epoch - 21ms/step
Epoch 22/50
2262/2262 - 46s - loss: 3.0560 - accuracy50: 0.4798 - val_loss: 3.2194 - val_accuracy50: 0.4411 - 46s/epoch - 21ms/step
Epoch 23/50
2262/2262 - 47s - loss: 3.0503 - accuracy50: 0.4814 - val_loss: 3.2148 - val_accuracy50: 0.4424 - 47s/epoch - 21ms/step
Epoch 24/50
2262/2262 - 47s - loss: 3.0432 - accuracy50: 0.4832 - val_loss: 3.2252 - val_accuracy50: 0.4427 - 47s/epoch - 21ms/step
Epoch 25/50
2262/2262 - 47s - loss: 3.0367 - accuracy50: 0.4853 - val_loss: 3.2162 - val_accuracy50: 0.4450 - 47s/epoch - 21ms/step
Epoch 26/50
2262/2262 - 47s - loss: 3.0300 - accuracy50: 0.4873 - val_loss: 3.2230 - val_accuracy50: 0.4455 - 47s/epoch - 21ms/step
Epoch 27/50
2262/2262 - 46s - loss: 3.0228 - accuracy50: 0.4891 - val_loss: 3.2267 - val_accuracy50: 0.4464 - 46s/epoch - 21ms/step
testing model: results/AAL/W0/deepOF_L1/h50
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9613469
{'0': {'precision': 0.4427458837511372, 'recall': 0.2215920157074953, 'f1-score': 0.29535859058036473, 'support': 379946}, '1': {'precision': 0.5988865490209, 'recall': 0.8338091315726366, 'f1-score': 0.69708742772614, 'support': 959090}, '2': {'precision': 0.4358529366961896, 'recall': 0.21638374589798648, 'f1-score': 0.2891940720900557, 'support': 370245}, 'accuracy': 0.5639833356832493, 'macro avg': {'precision': 0.49249512315607563, 'recall': 0.42392829772603946, 'f1-score': 0.42721336346552014, 'support': 1709281}, 'weighted avg': {'precision': 0.5288644748261083, 'recall': 0.5639833356832493, 'f1-score': 0.5194362748638133, 'support': 1709281}}
[[ 84193 270488  25265]
 [ 80960 799698  78432]
 [ 25008 265122  80115]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0762758
{'0': {'precision': 0.5211392887614138, 'recall': 0.1554775676436819, 'f1-score': 0.2395017749060405, 'support': 184644}, '1': {'precision': 0.3900326173972684, 'recall': 0.8454323820450308, 'f1-score': 0.5338009655478404, 'support': 209190}, '2': {'precision': 0.5097219258943176, 'recall': 0.19371124937161144, 'f1-score': 0.2807341893130489, 'support': 184997}, 'accuracy': 0.41704746290368, 'macro avg': {'precision': 0.4736312773509999, 'recall': 0.39820706635344133, 'f1-score': 0.35134564325564327, 'support': 578831}, 'weighted avg': {'precision': 0.4701081890777587, 'recall': 0.41704746290368, 'f1-score': 0.3590398104611705, 'support': 578831}}
[[ 28708 139899  16037]
 [ 13902 176856  18432]
 [ 12477 136684  35836]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0602688
{'0': {'precision': 0.5075589883671643, 'recall': 0.16789219504595732, 'f1-score': 0.25232080353066505, 'support': 64190}, '1': {'precision': 0.4226432860095137, 'recall': 0.8281021635479311, 'f1-score': 0.5596531567271725, 'support': 83474}, '2': {'precision': 0.48392276954102403, 'recall': 0.20278560250391237, 'f1-score': 0.2858056618547151, 'support': 63900}, 'accuracy': 0.4389215556521904, 'macro avg': {'precision': 0.471375014639234, 'recall': 0.3995933203659336, 'f1-score': 0.36592654070418423, 'support': 211564}, 'weighted avg': {'precision': 0.4669159313177944, 'recall': 0.4389215556521904, 'f1-score': 0.3836944932776544, 'support': 211564}}
[[10777 47892  5521]
 [ 6051 69125  8298]
 [ 4405 46537 12958]]
training model: results/AAL/W0/deepOF_L1/h100
Epoch 1/50
2262/2262 - 49s - loss: 3.2440 - accuracy100: 0.4042 - val_loss: 3.3025 - val_accuracy100: 0.3629 - 49s/epoch - 22ms/step
Epoch 2/50
2262/2262 - 46s - loss: 3.2382 - accuracy100: 0.4053 - val_loss: 3.2933 - val_accuracy100: 0.3639 - 46s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 47s - loss: 3.2360 - accuracy100: 0.4043 - val_loss: 3.2872 - val_accuracy100: 0.3647 - 47s/epoch - 21ms/step
Epoch 4/50
2262/2262 - 47s - loss: 3.2323 - accuracy100: 0.4051 - val_loss: 3.2850 - val_accuracy100: 0.3653 - 47s/epoch - 21ms/step
Epoch 5/50
2262/2262 - 46s - loss: 3.2288 - accuracy100: 0.4076 - val_loss: 3.2844 - val_accuracy100: 0.3674 - 46s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 47s - loss: 3.2253 - accuracy100: 0.4092 - val_loss: 3.2822 - val_accuracy100: 0.3672 - 47s/epoch - 21ms/step
Epoch 7/50
2262/2262 - 46s - loss: 3.2226 - accuracy100: 0.4106 - val_loss: 3.2815 - val_accuracy100: 0.3689 - 46s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 46s - loss: 3.2189 - accuracy100: 0.4138 - val_loss: 3.2817 - val_accuracy100: 0.3713 - 46s/epoch - 21ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.2155 - accuracy100: 0.4153 - val_loss: 3.2808 - val_accuracy100: 0.3740 - 46s/epoch - 21ms/step
Epoch 10/50
2262/2262 - 47s - loss: 3.2130 - accuracy100: 0.4171 - val_loss: 3.2814 - val_accuracy100: 0.3760 - 47s/epoch - 21ms/step
Epoch 11/50
2262/2262 - 47s - loss: 3.2101 - accuracy100: 0.4185 - val_loss: 3.2832 - val_accuracy100: 0.3765 - 47s/epoch - 21ms/step
Epoch 12/50
2262/2262 - 47s - loss: 3.2067 - accuracy100: 0.4204 - val_loss: 3.2816 - val_accuracy100: 0.3789 - 47s/epoch - 21ms/step
Epoch 13/50
2262/2262 - 46s - loss: 3.2039 - accuracy100: 0.4223 - val_loss: 3.2812 - val_accuracy100: 0.3801 - 46s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 47s - loss: 3.2002 - accuracy100: 0.4233 - val_loss: 3.2822 - val_accuracy100: 0.3811 - 47s/epoch - 21ms/step
Epoch 15/50
2262/2262 - 47s - loss: 3.1969 - accuracy100: 0.4246 - val_loss: 3.2798 - val_accuracy100: 0.3837 - 47s/epoch - 21ms/step
Epoch 16/50
2262/2262 - 46s - loss: 3.1942 - accuracy100: 0.4262 - val_loss: 3.2814 - val_accuracy100: 0.3844 - 46s/epoch - 20ms/step
Epoch 17/50
2262/2262 - 46s - loss: 3.1911 - accuracy100: 0.4275 - val_loss: 3.2823 - val_accuracy100: 0.3855 - 46s/epoch - 21ms/step
Epoch 18/50
2262/2262 - 46s - loss: 3.1881 - accuracy100: 0.4286 - val_loss: 3.2824 - val_accuracy100: 0.3874 - 46s/epoch - 21ms/step
Epoch 19/50
2262/2262 - 46s - loss: 3.1846 - accuracy100: 0.4297 - val_loss: 3.2842 - val_accuracy100: 0.3859 - 46s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 46s - loss: 3.1812 - accuracy100: 0.4319 - val_loss: 3.2852 - val_accuracy100: 0.3877 - 46s/epoch - 20ms/step
Epoch 21/50
2262/2262 - 46s - loss: 3.1791 - accuracy100: 0.4327 - val_loss: 3.2831 - val_accuracy100: 0.3857 - 46s/epoch - 20ms/step
Epoch 22/50
2262/2262 - 46s - loss: 3.1757 - accuracy100: 0.4342 - val_loss: 3.2820 - val_accuracy100: 0.3891 - 46s/epoch - 20ms/step
Epoch 23/50
2262/2262 - 46s - loss: 3.1732 - accuracy100: 0.4353 - val_loss: 3.2821 - val_accuracy100: 0.3891 - 46s/epoch - 20ms/step
Epoch 24/50
2262/2262 - 46s - loss: 3.1699 - accuracy100: 0.4364 - val_loss: 3.2854 - val_accuracy100: 0.3879 - 46s/epoch - 20ms/step
Epoch 25/50
2262/2262 - 46s - loss: 3.1674 - accuracy100: 0.4370 - val_loss: 3.2846 - val_accuracy100: 0.3886 - 46s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h100
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0261118
{'0': {'precision': 0.4353816084282786, 'recall': 0.18292259554827597, 'f1-score': 0.2576114907693682, 'support': 449354}, '1': {'precision': 0.5005295324903732, 'recall': 0.8546912317027648, 'f1-score': 0.6313336010351135, 'support': 827789}, '2': {'precision': 0.4335511371603242, 'recall': 0.10732682615275675, 'f1-score': 0.17205976461422887, 'support': 432138}, 'accuracy': 0.4891419257570873, 'macro avg': {'precision': 0.45648742602632536, 'recall': 0.38164688446793255, 'f1-score': 0.35366828547290347, 'support': 1709281}, 'weighted avg': {'precision': 0.46646936914090914, 'recall': 0.4891419257570873, 'f1-score': 0.4169725906104952, 'support': 1709281}}
[[ 82197 349575  17582]
 [ 77270 707504  43015]
 [ 29326 356432  46380]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1093868
{'0': {'precision': 0.4693918757686448, 'recall': 0.13134794467073127, 'f1-score': 0.20525910229242922, 'support': 194689}, '1': {'precision': 0.3375442173910341, 'recall': 0.8533148230610054, 'f1-score': 0.4837373263404233, 'support': 190885}, '2': {'precision': 0.48168353552030246, 'recall': 0.10416699007021737, 'f1-score': 0.17129121463518399, 'support': 193257}, 'accuracy': 0.36036079615639105, 'macro avg': {'precision': 0.42953987622666046, 'recall': 0.36294325260065136, 'f1-score': 0.2867625477560121, 'support': 578831}, 'weighted avg': {'precision': 0.43001545850560235, 'recall': 0.36036079615639105, 'f1-score': 0.2857537263405972, 'support': 578831}}
[[ 25572 159155   9962]
 [ 16300 162885  11700]
 [ 12607 160519  20131]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094133
{'0': {'precision': 0.4572362364205487, 'recall': 0.1469509128029115, 'f1-score': 0.22241877337154883, 'support': 67594}, '1': {'precision': 0.36587826929286404, 'recall': 0.8375018147742421, 'f1-score': 0.509271706547779, 'support': 75767}, '2': {'precision': 0.4704412481716236, 'recall': 0.1131768397284577, 'f1-score': 0.18245854557918, 'support': 68203}, 'accuracy': 0.3833686260422378, 'macro avg': {'precision': 0.4311852512950121, 'recall': 0.3658765224352038, 'f1-score': 0.30471634183283597, 'support': 211564}, 'weighted avg': {'precision': 0.42877535612472933, 'recall': 0.3833686260422378, 'f1-score': 0.31226666229329586, 'support': 211564}}
[[ 9933 54271  3390]
 [ 7013 63455  5299]
 [ 4778 55706  7719]]
training model: results/AAL/W0/deepOF_L1/h200
Epoch 1/50
2262/2262 - 49s - loss: 3.2813 - accuracy200: 0.3740 - val_loss: 3.2721 - val_accuracy200: 0.3668 - 49s/epoch - 22ms/step
Epoch 2/50
2262/2262 - 46s - loss: 3.2692 - accuracy200: 0.3778 - val_loss: 3.2704 - val_accuracy200: 0.3669 - 46s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 45s - loss: 3.2678 - accuracy200: 0.3769 - val_loss: 3.2695 - val_accuracy200: 0.3678 - 45s/epoch - 20ms/step
Epoch 4/50
2262/2262 - 45s - loss: 3.2664 - accuracy200: 0.3776 - val_loss: 3.2682 - val_accuracy200: 0.3680 - 45s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 45s - loss: 3.2648 - accuracy200: 0.3785 - val_loss: 3.2679 - val_accuracy200: 0.3681 - 45s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 45s - loss: 3.2631 - accuracy200: 0.3797 - val_loss: 3.2676 - val_accuracy200: 0.3687 - 45s/epoch - 20ms/step
Epoch 7/50
2262/2262 - 45s - loss: 3.2619 - accuracy200: 0.3802 - val_loss: 3.2666 - val_accuracy200: 0.3690 - 45s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 45s - loss: 3.2603 - accuracy200: 0.3811 - val_loss: 3.2666 - val_accuracy200: 0.3696 - 45s/epoch - 20ms/step
Epoch 9/50
2262/2262 - 45s - loss: 3.2590 - accuracy200: 0.3827 - val_loss: 3.2667 - val_accuracy200: 0.3701 - 45s/epoch - 20ms/step
Epoch 10/50
2262/2262 - 45s - loss: 3.2576 - accuracy200: 0.3833 - val_loss: 3.2667 - val_accuracy200: 0.3713 - 45s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 45s - loss: 3.2561 - accuracy200: 0.3846 - val_loss: 3.2667 - val_accuracy200: 0.3726 - 45s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 45s - loss: 3.2547 - accuracy200: 0.3851 - val_loss: 3.2663 - val_accuracy200: 0.3721 - 45s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 45s - loss: 3.2530 - accuracy200: 0.3863 - val_loss: 3.2666 - val_accuracy200: 0.3727 - 45s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 46s - loss: 3.2520 - accuracy200: 0.3872 - val_loss: 3.2658 - val_accuracy200: 0.3741 - 46s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 45s - loss: 3.2505 - accuracy200: 0.3875 - val_loss: 3.2664 - val_accuracy200: 0.3742 - 45s/epoch - 20ms/step
Epoch 16/50
2262/2262 - 45s - loss: 3.2492 - accuracy200: 0.3887 - val_loss: 3.2664 - val_accuracy200: 0.3732 - 45s/epoch - 20ms/step
Epoch 17/50
2262/2262 - 45s - loss: 3.2479 - accuracy200: 0.3901 - val_loss: 3.2664 - val_accuracy200: 0.3742 - 45s/epoch - 20ms/step
Epoch 18/50
2262/2262 - 45s - loss: 3.2462 - accuracy200: 0.3907 - val_loss: 3.2675 - val_accuracy200: 0.3745 - 45s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 47s - loss: 3.2456 - accuracy200: 0.3918 - val_loss: 3.2672 - val_accuracy200: 0.3738 - 47s/epoch - 21ms/step
Epoch 20/50
2262/2262 - 46s - loss: 3.2446 - accuracy200: 0.3926 - val_loss: 3.2691 - val_accuracy200: 0.3735 - 46s/epoch - 20ms/step
Epoch 21/50
2262/2262 - 46s - loss: 3.2428 - accuracy200: 0.3931 - val_loss: 3.2688 - val_accuracy200: 0.3752 - 46s/epoch - 20ms/step
Epoch 22/50
2262/2262 - 46s - loss: 3.2419 - accuracy200: 0.3940 - val_loss: 3.2701 - val_accuracy200: 0.3731 - 46s/epoch - 20ms/step
Epoch 23/50
2262/2262 - 45s - loss: 3.2406 - accuracy200: 0.3946 - val_loss: 3.2731 - val_accuracy200: 0.3722 - 45s/epoch - 20ms/step
Epoch 24/50
2262/2262 - 45s - loss: 3.2391 - accuracy200: 0.3954 - val_loss: 3.2738 - val_accuracy200: 0.3718 - 45s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h200
Evaluating performance on  test set...
6677/6677 - 81s - 81s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0713116
{'0': {'precision': 0.344149349125246, 'recall': 0.3814133668963116, 'f1-score': 0.36182444071763536, 'support': 499757}, '1': {'precision': 0.4444599626681866, 'recall': 0.6301348603232366, 'f1-score': 0.5212564038146759, 'support': 747440}, '2': {'precision': 0.35677200313397756, 'recall': 0.07390863998753473, 'f1-score': 0.12245051621612416, 'support': 462084}, 'accuracy': 0.4070448334709155, 'macro avg': {'precision': 0.38179377164247, 'recall': 0.36181895573569434, 'f1-score': 0.3351771202494785, 'support': 1709281}, 'weighted avg': {'precision': 0.391425889051394, 'recall': 0.4070448334709155, 'f1-score': 0.36682944923753097, 'support': 1709281}}
[[190614 289533  19610]
 [234489 470988  41963]
 [128767 299165  34152]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951099
{'0': {'precision': 0.3853588057816873, 'recall': 0.3299530116223465, 'f1-score': 0.35551012979012364, 'support': 192388}, '1': {'precision': 0.34272410398318387, 'recall': 0.6543324646560088, 'f1-score': 0.44983507397661177, 'support': 196851}, '2': {'precision': 0.4008465276689136, 'recall': 0.08092113591290771, 'f1-score': 0.13465808852571248, 'support': 189592}, 'accuracy': 0.3587005533566792, 'macro avg': {'precision': 0.3763098124779282, 'recall': 0.355068870730421, 'f1-score': 0.3133344307641493, 'support': 578831}, 'weighted avg': {'precision': 0.3759323315332552, 'recall': 0.3587005533566792, 'f1-score': 0.3152499837037049, 'support': 578831}}
[[ 63479 119017   9892]
 [ 55005 128806  13040]
 [ 46243 128007  15342]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0876524
{'0': {'precision': 0.37760586040461436, 'recall': 0.3325344788605019, 'f1-score': 0.35363986823861315, 'support': 66345}, '1': {'precision': 0.37177199737064515, 'recall': 0.6636621534493875, 'f1-score': 0.47657497904966506, 'support': 77550}, '2': {'precision': 0.3894973131079518, 'recall': 0.08461777180097238, 'f1-score': 0.13903120067985916, 'support': 67669}, 'accuracy': 0.3746147737800382, 'macro avg': {'precision': 0.3796250569610704, 'recall': 0.3602714680369539, 'f1-score': 0.32308201598937913, 'support': 211564}, 'weighted avg': {'precision': 0.37927091984146477, 'recall': 0.3746147737800382, 'f1-score': 0.33005959899792836, 'support': 211564}}
[[22062 40792  3491]
 [20599 51467  5484]
 [15765 46178  5726]]
training model: results/AAL/W0/deepOF_L1/h300
Epoch 1/50
2262/2262 - 48s - loss: 3.2939 - accuracy300: 0.3647 - val_loss: 3.2905 - val_accuracy300: 0.3487 - 48s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 45s - loss: 3.2809 - accuracy300: 0.3679 - val_loss: 3.2869 - val_accuracy300: 0.3504 - 45s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 45s - loss: 3.2791 - accuracy300: 0.3684 - val_loss: 3.2855 - val_accuracy300: 0.3487 - 45s/epoch - 20ms/step
Epoch 4/50
2262/2262 - 45s - loss: 3.2782 - accuracy300: 0.3684 - val_loss: 3.2845 - val_accuracy300: 0.3486 - 45s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 44s - loss: 3.2771 - accuracy300: 0.3698 - val_loss: 3.2840 - val_accuracy300: 0.3496 - 44s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 45s - loss: 3.2762 - accuracy300: 0.3711 - val_loss: 3.2834 - val_accuracy300: 0.3491 - 45s/epoch - 20ms/step
Epoch 7/50
2262/2262 - 45s - loss: 3.2756 - accuracy300: 0.3711 - val_loss: 3.2834 - val_accuracy300: 0.3509 - 45s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 45s - loss: 3.2748 - accuracy300: 0.3719 - val_loss: 3.2829 - val_accuracy300: 0.3527 - 45s/epoch - 20ms/step
Epoch 9/50
2262/2262 - 45s - loss: 3.2740 - accuracy300: 0.3733 - val_loss: 3.2824 - val_accuracy300: 0.3531 - 45s/epoch - 20ms/step
Epoch 10/50
2262/2262 - 45s - loss: 3.2730 - accuracy300: 0.3735 - val_loss: 3.2825 - val_accuracy300: 0.3538 - 45s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 45s - loss: 3.2722 - accuracy300: 0.3744 - val_loss: 3.2819 - val_accuracy300: 0.3551 - 45s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 46s - loss: 3.2713 - accuracy300: 0.3750 - val_loss: 3.2825 - val_accuracy300: 0.3555 - 46s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 46s - loss: 3.2705 - accuracy300: 0.3757 - val_loss: 3.2825 - val_accuracy300: 0.3567 - 46s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 46s - loss: 3.2695 - accuracy300: 0.3769 - val_loss: 3.2828 - val_accuracy300: 0.3583 - 46s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 46s - loss: 3.2687 - accuracy300: 0.3773 - val_loss: 3.2827 - val_accuracy300: 0.3584 - 46s/epoch - 20ms/step
Epoch 16/50
2262/2262 - 45s - loss: 3.2682 - accuracy300: 0.3778 - val_loss: 3.2822 - val_accuracy300: 0.3588 - 45s/epoch - 20ms/step
Epoch 17/50
2262/2262 - 45s - loss: 3.2674 - accuracy300: 0.3785 - val_loss: 3.2824 - val_accuracy300: 0.3583 - 45s/epoch - 20ms/step
Epoch 18/50
2262/2262 - 45s - loss: 3.2666 - accuracy300: 0.3787 - val_loss: 3.2827 - val_accuracy300: 0.3603 - 45s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 45s - loss: 3.2659 - accuracy300: 0.3793 - val_loss: 3.2830 - val_accuracy300: 0.3607 - 45s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 45s - loss: 3.2651 - accuracy300: 0.3802 - val_loss: 3.2843 - val_accuracy300: 0.3608 - 45s/epoch - 20ms/step
Epoch 21/50
2262/2262 - 45s - loss: 3.2642 - accuracy300: 0.3806 - val_loss: 3.2841 - val_accuracy300: 0.3605 - 45s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h300
Evaluating performance on  test set...
6677/6677 - 82s - 82s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0834607
{'0': {'precision': 0.3617691061735722, 'recall': 0.2700097820269098, 'f1-score': 0.3092258995238825, 'support': 541810}, '1': {'precision': 0.40006377252124076, 'recall': 0.7014625757004354, 'f1-score': 0.5095289182510002, 'support': 681469}, '2': {'precision': 0.35315931069584816, 'recall': 0.07995028827041864, 'f1-score': 0.13038357387093852, 'support': 486002}, 'accuracy': 0.38798477254471325, 'macro avg': {'precision': 0.3716640631302204, 'recall': 0.35047421533258794, 'f1-score': 0.3163794638819404, 'support': 1709281}, 'weighted avg': {'precision': 0.3745886777709365, 'recall': 0.38798477254471325, 'f1-score': 0.3382337513147631, 'support': 1709281}}
[[146294 368864  26652]
 [158928 478025  44516]
 [ 99163 347983  38856]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0986539
{'0': {'precision': 0.3861070527294461, 'recall': 0.249857171025689, 'f1-score': 0.30338692745455553, 'support': 197789}, '1': {'precision': 0.3246537965027579, 'recall': 0.7094898935118644, 'f1-score': 0.4454672783541469, 'support': 187157}, '2': {'precision': 0.39074826679416685, 'recall': 0.08430255048095521, 'f1-score': 0.13868442822900537, 'support': 193885}, 'accuracy': 0.34301894680830847, 'macro avg': {'precision': 0.3671697053421236, 'recall': 0.34788320500616954, 'f1-score': 0.2958462113459026, 'support': 578831}, 'weighted avg': {'precision': 0.36779161128508686, 'recall': 0.34301894680830847, 'f1-score': 0.29415796109126296, 'support': 578831}}
[[ 49419 136442  11928]
 [ 40814 132786  13557]
 [ 37760 139780  16345]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0943617
{'0': {'precision': 0.37234251753446806, 'recall': 0.24903548255100252, 'f1-score': 0.29845439817855424, 'support': 68428}, '1': {'precision': 0.3457452830816978, 'recall': 0.7135552684388488, 'f1-score': 0.46579484533769994, 'support': 72754}, '2': {'precision': 0.38527419148664194, 'recall': 0.08564689835469295, 'f1-score': 0.1401404193983354, 'support': 70382}, 'accuracy': 0.35442230247111983, 'macro avg': {'precision': 0.3677873307009359, 'recall': 0.34941254978151476, 'f1-score': 0.3014632209715299, 'support': 211564}, 'weighted avg': {'precision': 0.36749812945674715, 'recall': 0.35442230247111983, 'f1-score': 0.30333345339639434, 'support': 211564}}
[[17041 47177  4210]
 [15432 51914  5408]
 [13294 51060  6028]]
training model: results/AAL/W0/deepOF_L1/h500
Epoch 1/50
2262/2262 - 47s - loss: 3.2074 - accuracy500: 0.4188 - val_loss: 3.3573 - val_accuracy500: 0.4312 - 47s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 46s - loss: 3.2123 - accuracy500: 0.4183 - val_loss: 3.3344 - val_accuracy500: 0.4312 - 46s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 45s - loss: 3.2255 - accuracy500: 0.4125 - val_loss: 3.3194 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 4/50
2262/2262 - 45s - loss: 3.2258 - accuracy500: 0.4121 - val_loss: 3.3185 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 45s - loss: 3.2213 - accuracy500: 0.4142 - val_loss: 3.3192 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 45s - loss: 3.2203 - accuracy500: 0.4150 - val_loss: 3.3184 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 7/50
2262/2262 - 45s - loss: 3.2173 - accuracy500: 0.4160 - val_loss: 3.3220 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 45s - loss: 3.2151 - accuracy500: 0.4162 - val_loss: 3.3163 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.2131 - accuracy500: 0.4174 - val_loss: 3.3178 - val_accuracy500: 0.4313 - 46s/epoch - 21ms/step
Epoch 10/50
2262/2262 - 46s - loss: 3.2071 - accuracy500: 0.4194 - val_loss: 3.3157 - val_accuracy500: 0.4313 - 46s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 47s - loss: 3.2061 - accuracy500: 0.4186 - val_loss: 3.3190 - val_accuracy500: 0.4313 - 47s/epoch - 21ms/step
Epoch 12/50
2262/2262 - 46s - loss: 3.1976 - accuracy500: 0.4212 - val_loss: 3.3183 - val_accuracy500: 0.4313 - 46s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 47s - loss: 3.1987 - accuracy500: 0.4215 - val_loss: 3.3204 - val_accuracy500: 0.4313 - 47s/epoch - 21ms/step
Epoch 14/50
2262/2262 - 45s - loss: 3.1956 - accuracy500: 0.4225 - val_loss: 3.3219 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 45s - loss: 3.1935 - accuracy500: 0.4238 - val_loss: 3.3279 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 16/50
2262/2262 - 45s - loss: 3.1969 - accuracy500: 0.4226 - val_loss: 3.3189 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 17/50
2262/2262 - 45s - loss: 3.1946 - accuracy500: 0.4233 - val_loss: 3.3253 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 18/50
2262/2262 - 45s - loss: 3.1958 - accuracy500: 0.4225 - val_loss: 3.3232 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 19/50
2262/2262 - 45s - loss: 3.1909 - accuracy500: 0.4234 - val_loss: 3.3243 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
Epoch 20/50
2262/2262 - 45s - loss: 3.1902 - accuracy500: 0.4245 - val_loss: 3.3267 - val_accuracy500: 0.4313 - 45s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h500
Evaluating performance on  test set...
6677/6677 - 82s - 82s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0680807
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 473274}, '1': {'precision': 0.46868577305763687, 'recall': 0.9999975034732927, 'f1-score': 0.6382378154099133, 'support': 801113}, '2': {'precision': 0.4, 'recall': 9.197643563718976e-06, 'f1-score': 1.8394864153928225e-05, 'support': 434894}, 'accuracy': 0.46868537121748854, 'macro avg': {'precision': 0.28956192435254563, 'recall': 0.3333355670389522, 'f1-score': 0.21275207009135574, 'support': 1709281}, 'weighted avg': {'precision': 0.3214379997855956, 'recall': 0.46868537121748854, 'f1-score': 0.2991366608723394, 'support': 1709281}}
[[     0 473270      4]
 [     0 801111      2]
 [     0 434890      4]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1823325
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 192948}, '1': {'precision': 0.33973881660668903, 'recall': 0.999994914849149, 'f1-score': 0.5071710609456361, 'support': 196651}, '2': {'precision': 0.6666666666666666, 'recall': 1.0569036949353176e-05, 'f1-score': 2.1137738790392897e-05, 'support': 189232}, 'accuracy': 0.3397399240883781, 'macro avg': {'precision': 0.33546849442445187, 'recall': 0.3333351612953661, 'f1-score': 0.16906406622814218, 'support': 578831}, 'weighted avg': {'precision': 0.33336957538761514, 'recall': 0.3397399240883781, 'f1-score': 0.17231229191699665, 'support': 578831}}
[[     0 192948      0]
 [     0 196650      1]
 [     1 189229      2]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1016337
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58521}, '1': {'precision': 0.4312757901901561, 'recall': 1.0, 'f1-score': 0.602645266755833, 'support': 91242}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61801}, 'accuracy': 0.43127375167797927, 'macro avg': {'precision': 0.14375859673005204, 'recall': 0.3333333333333333, 'f1-score': 0.20088175558527765, 'support': 211564}, 'weighted avg': {'precision': 0.18599792804319368, 'recall': 0.43127375167797927, 'f1-score': 0.2599050851247647, 'support': 211564}}
[[    0 58521     0]
 [    0 91242     0]
 [    1 61800     0]]
training model: results/AAL/W0/deepOF_L1/h1000
Epoch 1/50
2262/2262 - 47s - loss: 3.2666 - accuracy1000: 0.3886 - val_loss: 3.3393 - val_accuracy1000: 0.3582 - 47s/epoch - 21ms/step
Epoch 2/50
2262/2262 - 45s - loss: 3.2688 - accuracy1000: 0.3762 - val_loss: 3.3332 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 3/50
2262/2262 - 45s - loss: 3.2718 - accuracy1000: 0.3720 - val_loss: 3.3298 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 4/50
2262/2262 - 45s - loss: 3.2716 - accuracy1000: 0.3719 - val_loss: 3.3268 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 5/50
2262/2262 - 45s - loss: 3.2709 - accuracy1000: 0.3730 - val_loss: 3.3262 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 6/50
2262/2262 - 45s - loss: 3.2700 - accuracy1000: 0.3736 - val_loss: 3.3285 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 7/50
2262/2262 - 46s - loss: 3.2676 - accuracy1000: 0.3748 - val_loss: 3.3302 - val_accuracy1000: 0.3586 - 46s/epoch - 20ms/step
Epoch 8/50
2262/2262 - 47s - loss: 3.2654 - accuracy1000: 0.3766 - val_loss: 3.3299 - val_accuracy1000: 0.3586 - 47s/epoch - 21ms/step
Epoch 9/50
2262/2262 - 46s - loss: 3.2633 - accuracy1000: 0.3777 - val_loss: 3.3326 - val_accuracy1000: 0.3586 - 46s/epoch - 20ms/step
Epoch 10/50
2262/2262 - 46s - loss: 3.2616 - accuracy1000: 0.3789 - val_loss: 3.3324 - val_accuracy1000: 0.3586 - 46s/epoch - 20ms/step
Epoch 11/50
2262/2262 - 46s - loss: 3.2595 - accuracy1000: 0.3799 - val_loss: 3.3339 - val_accuracy1000: 0.3586 - 46s/epoch - 20ms/step
Epoch 12/50
2262/2262 - 45s - loss: 3.2580 - accuracy1000: 0.3807 - val_loss: 3.3323 - val_accuracy1000: 0.3585 - 45s/epoch - 20ms/step
Epoch 13/50
2262/2262 - 45s - loss: 3.2552 - accuracy1000: 0.3828 - val_loss: 3.3306 - val_accuracy1000: 0.3585 - 45s/epoch - 20ms/step
Epoch 14/50
2262/2262 - 45s - loss: 3.2541 - accuracy1000: 0.3824 - val_loss: 3.3302 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
Epoch 15/50
2262/2262 - 45s - loss: 3.2515 - accuracy1000: 0.3850 - val_loss: 3.3282 - val_accuracy1000: 0.3586 - 45s/epoch - 20ms/step
testing model: results/AAL/W0/deepOF_L1/h1000
Evaluating performance on  test set...
6677/6677 - 80s - 80s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0515299
{'0': {'precision': 0.34108527131782945, 'recall': 9.604365620736698e-05, 'f1-score': 0.0001920332392079502, 'support': 458125}, '1': {'precision': 0.49220628377330666, 'recall': 0.9998490449418169, 'f1-score': 0.6596698839163005, 'support': 841310}, '2': {'precision': 0.2925170068027211, 'recall': 0.00010491745680084715, 'f1-score': 0.0002097596788237848, 'support': 409846}, 'accuracy': 0.49217770512864767, 'macro avg': {'precision': 0.37526952063128577, 'recall': 0.3333500020182751, 'f1-score': 0.22002389227811073, 'support': 1709281}, 'weighted avg': {'precision': 0.40382165582713975, 'recall': 0.49217770512864767, 'f1-score': 0.3247920116298387, 'support': 1709281}}
[[    44 458046     35]
 [    58 841183     69]
 [    27 409776     43]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1150836
{'0': {'precision': 0.37777777777777777, 'recall': 8.793027646313394e-05, 'f1-score': 0.00017581962974454443, 'support': 193335}, '1': {'precision': 0.3371035993772668, 'recall': 0.9998360042433903, 'f1-score': 0.5042087389806504, 'support': 195127}, '2': {'precision': 0.3617021276595745, 'recall': 8.930025371777968e-05, 'f1-score': 0.0001785564238299303, 'support': 190369}, 'accuracy': 0.337108758860531, 'macro avg': {'precision': 0.3588611682715397, 'recall': 0.33333774492452367, 'f1-score': 0.1681877050114083, 'support': 578831}, 'weighted avg': {'precision': 0.35877925170348535, 'recall': 0.337108758860531, 'f1-score': 0.17008889003360586, 'support': 578831}}
[[    17 193304     14]
 [    16 195095     16]
 [    12 190340     17]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1072531
{'0': {'precision': 0.42857142857142855, 'recall': 0.00018262060569167554, 'f1-score': 0.00036508564300708873, 'support': 65710}, '1': {'precision': 0.3586226786187072, 'recall': 0.9998022881847419, 'f1-score': 0.5278933815853574, 'support': 75868}, '2': {'precision': 0.2916666666666667, 'recall': 0.00010002000400080016, 'f1-score': 0.00019997143265247823, 'support': 69986}, 'accuracy': 0.3586243406250591, 'macro avg': {'precision': 0.35962025795226754, 'recall': 0.33336164293147813, 'f1-score': 0.17615281288700566, 'support': 211564}, 'weighted avg': {'precision': 0.3581989246100754, 'recall': 0.3586243406250591, 'f1-score': 0.18948497878847773, 'support': 211564}}
[[   12 65687    11]
 [    9 75853     6]
 [    7 69972     7]]
training model: results/AAL/W0/deepLOB_L2/h10
Epoch 1/50
2262/2262 - 106s - loss: 2.9671 - accuracy10: 0.4543 - val_loss: 3.3093 - val_accuracy10: 0.5538 - 106s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 103s - loss: 2.8165 - accuracy10: 0.4958 - val_loss: 2.9636 - val_accuracy10: 0.4516 - 103s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 103s - loss: 2.7055 - accuracy10: 0.5408 - val_loss: 2.9083 - val_accuracy10: 0.4961 - 103s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 104s - loss: 2.6006 - accuracy10: 0.5796 - val_loss: 2.7576 - val_accuracy10: 0.5183 - 104s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 104s - loss: 2.5409 - accuracy10: 0.5942 - val_loss: 2.7041 - val_accuracy10: 0.5775 - 104s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 2.5040 - accuracy10: 0.6031 - val_loss: 2.7312 - val_accuracy10: 0.5854 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 2.4780 - accuracy10: 0.6094 - val_loss: 2.7240 - val_accuracy10: 0.5674 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 103s - loss: 2.4606 - accuracy10: 0.6131 - val_loss: 2.7799 - val_accuracy10: 0.5761 - 103s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 103s - loss: 2.4450 - accuracy10: 0.6156 - val_loss: 2.8605 - val_accuracy10: 0.5820 - 103s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 2.4322 - accuracy10: 0.6185 - val_loss: 2.9708 - val_accuracy10: 0.5763 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 103s - loss: 2.4205 - accuracy10: 0.6200 - val_loss: 2.8426 - val_accuracy10: 0.5817 - 103s/epoch - 46ms/step
Epoch 12/50
2262/2262 - 103s - loss: 2.4107 - accuracy10: 0.6216 - val_loss: 2.8500 - val_accuracy10: 0.5718 - 103s/epoch - 45ms/step
Epoch 13/50
2262/2262 - 103s - loss: 2.4021 - accuracy10: 0.6229 - val_loss: 2.8990 - val_accuracy10: 0.5734 - 103s/epoch - 45ms/step
Epoch 14/50
2262/2262 - 103s - loss: 2.3947 - accuracy10: 0.6236 - val_loss: 2.8276 - val_accuracy10: 0.5728 - 103s/epoch - 45ms/step
Epoch 15/50
2262/2262 - 102s - loss: 2.3871 - accuracy10: 0.6241 - val_loss: 2.8096 - val_accuracy10: 0.5673 - 102s/epoch - 45ms/step
testing model: results/AAL/W0/deepLOB_L2/h10
Evaluating performance on  test set...
6677/6677 - 117s - 117s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0612749
{'0': {'precision': 0.1969230717827406, 'recall': 0.6616540931339531, 'f1-score': 0.3035136777489391, 'support': 178152}, '1': {'precision': 0.9019690190188627, 'recall': 0.42944845928672415, 'f1-score': 0.5818598776921032, 'support': 1345286}, '2': {'precision': 0.21294823259177337, 'recall': 0.538741337006586, 'f1-score': 0.30524306889340086, 'support': 185848}, 'accuracy': 0.4655335619668095, 'macro avg': {'precision': 0.4372801077977922, 'recall': 0.5432812964757544, 'f1-score': 0.39687220811148105, 'support': 1709286}, 'weighted avg': {'precision': 0.753568762591377, 'recall': 0.4655335619668095, 'f1-score': 0.5227728595489161, 'support': 1709286}}
[[117875  35661  24616]
 [422115 577731 345440]
 [ 58594  27130 100124]]
Evaluating performance on  train set...
2262/2262 - 41s - 41s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9018656
{'0': {'precision': 0.3461364610300031, 'recall': 0.5674744480588224, 'f1-score': 0.4299939837012999, 'support': 103906}, '1': {'precision': 0.7981275960304746, 'recall': 0.597710727605357, 'f1-score': 0.6835310623979538, 'support': 368414}, '2': {'precision': 0.3692054728394503, 'recall': 0.459568315604668, 'f1-score': 0.40946067462724023, 'support': 106513}, 'accuracy': 0.5668629812052872, 'macro avg': {'precision': 0.5044898432999759, 'recall': 0.5415844970896158, 'f1-score': 0.5076619069088313, 'support': 578833}, 'weighted avg': {'precision': 0.6380635136771801, 'recall': 0.5668629812052872, 'f1-score': 0.5875861475232378, 'support': 578833}}
[[ 58964  28542  16400]
 [ 80977 220205  67232]
 [ 30408  27155  48950]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.86120784
{'0': {'precision': 0.33549107565347414, 'recall': 0.5198404551720093, 'f1-score': 0.4077993788105372, 'support': 34097}, '1': {'precision': 0.7936726272352133, 'recall': 0.6094040443868642, 'f1-score': 0.6894381736061879, 'support': 142024}, '2': {'precision': 0.3566554618465812, 'recall': 0.49992946421014023, 'f1-score': 0.4163103237629811, 'support': 35443}, 'accuracy': 0.5766292942088446, 'macro avg': {'precision': 0.49527305491175616, 'recall': 0.5430579879230045, 'f1-score': 0.5045159587265687, 'support': 211564}, 'weighted avg': {'precision': 0.646616342814651, 'recall': 0.5766292942088446, 'f1-score': 0.5982907743882676, 'support': 211564}}
[[17725 11515  4857]
 [28369 86550 27105]
 [ 6739 10985 17719]]
training model: results/AAL/W0/deepLOB_L2/h20
Epoch 1/50
2262/2262 - 106s - loss: 3.0203 - accuracy20: 0.4655 - val_loss: 3.3450 - val_accuracy20: 0.5293 - 106s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 105s - loss: 2.9115 - accuracy20: 0.4974 - val_loss: 3.0170 - val_accuracy20: 0.5288 - 105s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 104s - loss: 2.8220 - accuracy20: 0.5330 - val_loss: 3.0124 - val_accuracy20: 0.5443 - 104s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 104s - loss: 2.7205 - accuracy20: 0.5657 - val_loss: 2.9142 - val_accuracy20: 0.5365 - 104s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 104s - loss: 2.6529 - accuracy20: 0.5822 - val_loss: 2.8806 - val_accuracy20: 0.5384 - 104s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 2.6137 - accuracy20: 0.5919 - val_loss: 2.8198 - val_accuracy20: 0.5396 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 2.5866 - accuracy20: 0.5980 - val_loss: 2.8620 - val_accuracy20: 0.5374 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 104s - loss: 2.5657 - accuracy20: 0.6026 - val_loss: 2.8918 - val_accuracy20: 0.5413 - 104s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 104s - loss: 2.5487 - accuracy20: 0.6059 - val_loss: 2.9104 - val_accuracy20: 0.5471 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 2.5336 - accuracy20: 0.6083 - val_loss: 2.9093 - val_accuracy20: 0.5491 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 103s - loss: 2.5224 - accuracy20: 0.6102 - val_loss: 2.8662 - val_accuracy20: 0.5498 - 103s/epoch - 46ms/step
Epoch 12/50
2262/2262 - 103s - loss: 2.5118 - accuracy20: 0.6125 - val_loss: 2.8817 - val_accuracy20: 0.5522 - 103s/epoch - 46ms/step
Epoch 13/50
2262/2262 - 103s - loss: 2.5010 - accuracy20: 0.6145 - val_loss: 2.8453 - val_accuracy20: 0.5486 - 103s/epoch - 46ms/step
Epoch 14/50
2262/2262 - 104s - loss: 2.4921 - accuracy20: 0.6154 - val_loss: 2.8441 - val_accuracy20: 0.5528 - 104s/epoch - 46ms/step
Epoch 15/50
2262/2262 - 104s - loss: 2.4844 - accuracy20: 0.6172 - val_loss: 2.8486 - val_accuracy20: 0.5492 - 104s/epoch - 46ms/step
Epoch 16/50
2262/2262 - 104s - loss: 2.4777 - accuracy20: 0.6177 - val_loss: 2.8690 - val_accuracy20: 0.5443 - 104s/epoch - 46ms/step
testing model: results/AAL/W0/deepLOB_L2/h20
Evaluating performance on  test set...
6677/6677 - 116s - 116s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9547138
{'0': {'precision': 0.3048978144988151, 'recall': 0.556787786259542, 'f1-score': 0.39402626438404315, 'support': 245625}, '1': {'precision': 0.8321165230977662, 'recall': 0.5284919175576873, 'f1-score': 0.6464267658247405, 'support': 1213309}, '2': {'precision': 0.2861438961939834, 'recall': 0.5602192113504186, 'f1-score': 0.37880504580032054, 'support': 250352}, 'accuracy': 0.5372050084070191, 'macro avg': {'precision': 0.4743860779301882, 'recall': 0.5484996383892159, 'f1-score': 0.473086025336368, 'support': 1709286}, 'weighted avg': {'precision': 0.6763886727612906, 'recall': 0.5372050084070191, 'f1-score': 0.5709592864105728, 'support': 1709286}}
[[136761  67010  41854]
 [264046 641224 308039]
 [ 47740  62360 140252]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.95410335
{'0': {'precision': 0.4178364018287409, 'recall': 0.49856984887578326, 'f1-score': 0.45464690262512186, 'support': 135650}, '1': {'precision': 0.6912237821442506, 'recall': 0.6148421000933156, 'f1-score': 0.6507994544959892, 'support': 305415}, '2': {'precision': 0.431341917457521, 'recall': 0.45494599616746995, 'f1-score': 0.442829638788307, 'support': 137768}, 'accuracy': 0.5495367403033344, 'macro avg': {'precision': 0.5134673671435042, 'recall': 0.5227859817121897, 'f1-score': 0.5160919986364727, 'support': 578833}, 'weighted avg': {'precision': 0.5653007562041948, 'recall': 0.5495367403033344, 'f1-score': 0.5553320584910981, 'support': 578833}}
[[ 67631  42307  25712]
 [ 60715 187782  56918]
 [ 33514  41577  62677]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9456169
{'0': {'precision': 0.38516117363903224, 'recall': 0.6054674685620558, 'f1-score': 0.4708173191388048, 'support': 45725}, '1': {'precision': 0.7209141737019135, 'recall': 0.5429973574933937, 'f1-score': 0.6194333727289693, 'support': 119205}, '2': {'precision': 0.43157177498547067, 'recall': 0.4617875369901788, 'f1-score': 0.44616866770948793, 'support': 46634}, 'accuracy': 0.5385982492295476, 'macro avg': {'precision': 0.5125490407754721, 'recall': 0.5367507876818761, 'f1-score': 0.5121397865257541, 'support': 211564}, 'weighted avg': {'precision': 0.5845700917710659, 'recall': 0.5385982492295476, 'f1-score': 0.5491213380525178, 'support': 211564}}
[[27685 11380  6660]
 [32773 64728 21704]
 [11421 13678 21535]]
training model: results/AAL/W0/deepLOB_L2/h30
Epoch 1/50
2262/2262 - 108s - loss: 3.0669 - accuracy30: 0.4629 - val_loss: 3.4224 - val_accuracy30: 0.4831 - 108s/epoch - 48ms/step
Epoch 2/50
2262/2262 - 104s - loss: 2.9686 - accuracy30: 0.4921 - val_loss: 3.2101 - val_accuracy30: 0.4863 - 104s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 107s - loss: 2.9172 - accuracy30: 0.5100 - val_loss: 3.1481 - val_accuracy30: 0.4918 - 107s/epoch - 47ms/step
Epoch 4/50
2262/2262 - 104s - loss: 2.8644 - accuracy30: 0.5288 - val_loss: 3.0528 - val_accuracy30: 0.5064 - 104s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 105s - loss: 2.8160 - accuracy30: 0.5447 - val_loss: 2.9948 - val_accuracy30: 0.5187 - 105s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 106s - loss: 2.7538 - accuracy30: 0.5614 - val_loss: 2.9082 - val_accuracy30: 0.5240 - 106s/epoch - 47ms/step
Epoch 7/50
2262/2262 - 105s - loss: 2.7083 - accuracy30: 0.5722 - val_loss: 2.9122 - val_accuracy30: 0.5406 - 105s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 104s - loss: 2.6765 - accuracy30: 0.5787 - val_loss: 2.8908 - val_accuracy30: 0.5364 - 104s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 104s - loss: 2.6520 - accuracy30: 0.5832 - val_loss: 2.8873 - val_accuracy30: 0.5453 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 2.6354 - accuracy30: 0.5868 - val_loss: 2.9052 - val_accuracy30: 0.5390 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 104s - loss: 2.6208 - accuracy30: 0.5890 - val_loss: 2.9059 - val_accuracy30: 0.5447 - 104s/epoch - 46ms/step
Epoch 12/50
2262/2262 - 103s - loss: 2.6079 - accuracy30: 0.5914 - val_loss: 2.8677 - val_accuracy30: 0.5525 - 103s/epoch - 46ms/step
Epoch 13/50
2262/2262 - 104s - loss: 2.5979 - accuracy30: 0.5928 - val_loss: 2.8886 - val_accuracy30: 0.5494 - 104s/epoch - 46ms/step
Epoch 14/50
2262/2262 - 104s - loss: 2.5895 - accuracy30: 0.5942 - val_loss: 2.9249 - val_accuracy30: 0.5474 - 104s/epoch - 46ms/step
Epoch 15/50
2262/2262 - 104s - loss: 2.5817 - accuracy30: 0.5955 - val_loss: 2.8678 - val_accuracy30: 0.5402 - 104s/epoch - 46ms/step
Epoch 16/50
2262/2262 - 104s - loss: 2.5755 - accuracy30: 0.5964 - val_loss: 2.9676 - val_accuracy30: 0.5333 - 104s/epoch - 46ms/step
Epoch 17/50
2262/2262 - 103s - loss: 2.5697 - accuracy30: 0.5970 - val_loss: 3.0176 - val_accuracy30: 0.5331 - 103s/epoch - 46ms/step
Epoch 18/50
2262/2262 - 103s - loss: 2.5647 - accuracy30: 0.5982 - val_loss: 3.0440 - val_accuracy30: 0.5307 - 103s/epoch - 46ms/step
Epoch 19/50
2262/2262 - 104s - loss: 2.5592 - accuracy30: 0.5988 - val_loss: 2.9574 - val_accuracy30: 0.5307 - 104s/epoch - 46ms/step
Epoch 20/50
2262/2262 - 104s - loss: 2.5537 - accuracy30: 0.5988 - val_loss: 2.9886 - val_accuracy30: 0.5353 - 104s/epoch - 46ms/step
Epoch 21/50
2262/2262 - 103s - loss: 2.5502 - accuracy30: 0.5999 - val_loss: 3.0266 - val_accuracy30: 0.5346 - 103s/epoch - 46ms/step
Epoch 22/50
2262/2262 - 103s - loss: 2.5453 - accuracy30: 0.6008 - val_loss: 2.9821 - val_accuracy30: 0.5360 - 103s/epoch - 45ms/step
testing model: results/AAL/W0/deepLOB_L2/h30
Evaluating performance on  test set...
6677/6677 - 113s - 113s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.96873784
{'0': {'precision': 0.311458331462319, 'recall': 0.5834174472437554, 'f1-score': 0.4061127342775674, 'support': 297216}, '1': {'precision': 0.7918758540363805, 'recall': 0.5596341627437794, 'f1-score': 0.6558009560690526, 'support': 1115250}, '2': {'precision': 0.38735873186635855, 'recall': 0.4755238865305572, 'f1-score': 0.42693716556916383, 'support': 296820}, 'accuracy': 0.5491638028978182, 'macro avg': {'precision': 0.496897639121686, 'recall': 0.5395251655060308, 'f1-score': 0.4962836186385946, 'support': 1709286}, 'weighted avg': {'precision': 0.6380943648111261, 'recall': 0.5491638028978182, 'f1-score': 0.5726418564074659, 'support': 1709286}}
[[173401  85319  38496]
 [306381 624132 184737]
 [ 76957  78718 141145]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9558435
{'0': {'precision': 0.46401475669768355, 'recall': 0.4693576316781577, 'f1-score': 0.46667090216010165, 'support': 156499}, '1': {'precision': 0.6083437854625814, 'recall': 0.6935018364621908, 'f1-score': 0.6481375753215693, 'support': 264367}, '2': {'precision': 0.5068984037999966, 'recall': 0.38236467110219224, 'f1-score': 0.43591159224176823, 'support': 157967}, 'accuracy': 0.547988798150762, 'macro avg': {'precision': 0.5264189819867539, 'recall': 0.5150747130808468, 'f1-score': 0.5169066899078131, 'support': 578833}, 'weighted avg': {'precision': 0.541636511900481, 'recall': 0.547988798150762, 'f1-score': 0.5411567108023324, 'support': 578833}}
[[ 73454  59376  23669]
 [ 45940 183339  35088]
 [ 38907  58659  60401]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9307575
{'0': {'precision': 0.46023242828226424, 'recall': 0.49253954322209564, 'f1-score': 0.47583824205959024, 'support': 53549}, '1': {'precision': 0.625882026113529, 'recall': 0.6496131481570474, 'f1-score': 0.6375268234017969, 'support': 104045}, '2': {'precision': 0.4938615830199282, 'recall': 0.42336483231424865, 'f1-score': 0.45590406640328823, 'support': 53970}, 'accuracy': 0.5521402507042786, 'macro avg': {'precision': 0.5266586791385738, 'recall': 0.5218391745644639, 'f1-score': 0.5230897106215585, 'support': 211564}, 'weighted avg': {'precision': 0.5502759984905495, 'recall': 0.5521402507042786, 'f1-score': 0.5502698135253371, 'support': 211564}}
[[26375 19563  7611]
 [20650 67589 15806]
 [10283 20838 22849]]
training model: results/AAL/W0/deepLOB_L2/h50
Epoch 1/50
2262/2262 - 106s - loss: 3.0741 - accuracy50: 0.4617 - val_loss: 3.4777 - val_accuracy50: 0.3911 - 106s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 104s - loss: 3.0061 - accuracy50: 0.4850 - val_loss: 3.4548 - val_accuracy50: 0.4155 - 104s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 104s - loss: 2.9817 - accuracy50: 0.4927 - val_loss: 3.3914 - val_accuracy50: 0.4394 - 104s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 105s - loss: 2.9554 - accuracy50: 0.5008 - val_loss: 3.5258 - val_accuracy50: 0.4044 - 105s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 105s - loss: 2.9358 - accuracy50: 0.5066 - val_loss: 3.5530 - val_accuracy50: 0.4139 - 105s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 2.9141 - accuracy50: 0.5140 - val_loss: 3.8254 - val_accuracy50: 0.3943 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 2.8882 - accuracy50: 0.5210 - val_loss: 3.7035 - val_accuracy50: 0.4072 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 104s - loss: 2.8584 - accuracy50: 0.5294 - val_loss: 3.7879 - val_accuracy50: 0.4035 - 104s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 103s - loss: 2.8279 - accuracy50: 0.5367 - val_loss: 3.6871 - val_accuracy50: 0.4194 - 103s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 103s - loss: 2.8066 - accuracy50: 0.5410 - val_loss: 3.5686 - val_accuracy50: 0.4331 - 103s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 103s - loss: 2.7873 - accuracy50: 0.5450 - val_loss: 3.6513 - val_accuracy50: 0.4312 - 103s/epoch - 46ms/step
Epoch 12/50
2262/2262 - 104s - loss: 2.7732 - accuracy50: 0.5477 - val_loss: 3.7617 - val_accuracy50: 0.4247 - 104s/epoch - 46ms/step
Epoch 13/50
2262/2262 - 104s - loss: 2.7612 - accuracy50: 0.5503 - val_loss: 3.7027 - val_accuracy50: 0.4336 - 104s/epoch - 46ms/step
testing model: results/AAL/W0/deepLOB_L2/h50
Evaluating performance on  test set...
6677/6677 - 114s - 114s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98581856
{'0': {'precision': 0.36659287769661264, 'recall': 0.39532514975733524, 'f1-score': 0.38041726026529904, 'support': 379948}, '1': {'precision': 0.6218466657214015, 'recall': 0.5990324161444702, 'f1-score': 0.6102263789615787, 'support': 959090}, '2': {'precision': 0.3187437442766787, 'recall': 0.3233994511786694, 'f1-score': 0.32105472017846803, 'support': 370248}, 'accuracy': 0.4940466370168597, 'macro avg': {'precision': 0.4357277625648976, 'recall': 0.439252339026825, 'f1-score': 0.4372327864684486, 'support': 1709286}, 'weighted avg': {'precision': 0.4994526270926944, 'recall': 0.4940466370168597, 'f1-score': 0.4965059463648434, 'support': 1709286}}
[[150203 176416  53329]
 [181975 574526 202589]
 [ 77549 172961 119738]]
Evaluating performance on  train set...
2262/2262 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0910889
{'0': {'precision': 0.42825987586670267, 'recall': 0.42131069381386327, 'f1-score': 0.42475686393392925, 'support': 184574}, '1': {'precision': 0.4455330449337465, 'recall': 0.6245442338110416, 'f1-score': 0.5200654190359845, 'support': 209263}, '2': {'precision': 0.46442628788097506, 'recall': 0.2608650997859413, 'f1-score': 0.3340798249955868, 'support': 184996}, 'accuracy': 0.4435061580801371, 'macro avg': {'precision': 0.4460730695604747, 'recall': 0.4355733424702821, 'f1-score': 0.42630070265516684, 'support': 578833}, 'weighted avg': {'precision': 0.44606341632736946, 'recall': 0.4435061580801371, 'f1-score': 0.43023282102497934, 'support': 578833}}
[[ 77763  81597  25214]
 [ 48131 130694  30438]
 [ 55685  81052  48259]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1142826
{'0': {'precision': 0.43557076757304936, 'recall': 0.3214720099797287, 'f1-score': 0.36992311211993434, 'support': 64130}, '1': {'precision': 0.4365570121197131, 'recall': 0.6975198495862424, 'f1-score': 0.5370133043213691, 'support': 83503}, '2': {'precision': 0.45008762250924905, 'recall': 0.2169370102141371, 'f1-score': 0.2927647896986648, 'support': 63931}, 'accuracy': 0.4383070843810856, 'macro avg': {'precision': 0.4407384674006705, 'recall': 0.4119762899267027, 'f1-score': 0.3999004020466561, 'support': 211564}, 'weighted avg': {'precision': 0.44034677592657945, 'recall': 0.4383070843810856, 'f1-score': 0.4125566585110133, 'support': 211564}}
[[20616 36890  6624]
 [14937 58245 10321]
 [11778 38284 13869]]
training model: results/AAL/W0/deepLOB_L2/h100
Epoch 1/50
2262/2262 - 107s - loss: 3.2069 - accuracy100: 0.4162 - val_loss: 3.5306 - val_accuracy100: 0.3423 - 107s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 105s - loss: 3.1632 - accuracy100: 0.4351 - val_loss: 3.6016 - val_accuracy100: 0.3544 - 105s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 105s - loss: 3.1422 - accuracy100: 0.4440 - val_loss: 3.5990 - val_accuracy100: 0.3460 - 105s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 104s - loss: 3.1261 - accuracy100: 0.4492 - val_loss: 3.6756 - val_accuracy100: 0.3468 - 104s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 103s - loss: 3.1137 - accuracy100: 0.4535 - val_loss: 3.7067 - val_accuracy100: 0.3446 - 103s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 3.1030 - accuracy100: 0.4579 - val_loss: 3.6182 - val_accuracy100: 0.3562 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 3.0939 - accuracy100: 0.4605 - val_loss: 3.6226 - val_accuracy100: 0.3513 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 104s - loss: 3.0854 - accuracy100: 0.4642 - val_loss: 3.6091 - val_accuracy100: 0.3519 - 104s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 104s - loss: 3.0777 - accuracy100: 0.4671 - val_loss: 3.6539 - val_accuracy100: 0.3479 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 3.0696 - accuracy100: 0.4697 - val_loss: 3.6897 - val_accuracy100: 0.3470 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 104s - loss: 3.0624 - accuracy100: 0.4725 - val_loss: 3.6914 - val_accuracy100: 0.3481 - 104s/epoch - 46ms/step
testing model: results/AAL/W0/deepLOB_L2/h100
Evaluating performance on  test set...
6677/6677 - 118s - 118s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0638659
{'0': {'precision': 0.4395266492732016, 'recall': 0.041988979784402566, 'f1-score': 0.07665493901894029, 'support': 449356}, '1': {'precision': 0.4910824949081161, 'recall': 0.928568839923169, 'f1-score': 0.6424167560235451, 'support': 827790}, '2': {'precision': 0.33546607068689305, 'recall': 0.07850002314064887, 'f1-score': 0.12722826678068191, 'support': 432140}, 'accuracy': 0.48058136555263425, 'macro avg': {'precision': 0.42202507162273695, 'recall': 0.34968594761607347, 'f1-score': 0.28209998727438906, 'support': 1709286}, 'weighted avg': {'precision': 0.43818613342496937, 'recall': 0.48058136555263425, 'f1-score': 0.36343358949475346, 'support': 1709286}}
[[ 18868 408810  21678]
 [ 13609 768660  45521]
 [ 10451 387766  33923]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1575596
{'0': {'precision': 0.36766762003345776, 'recall': 0.3849097109517842, 'f1-score': 0.376091151106394, 'support': 194708}, '1': {'precision': 0.33456470877970695, 'recall': 0.5834228043805024, 'f1-score': 0.4252621693535765, 'support': 190937}, '2': {'precision': 0.42849665738824255, 'recall': 0.09323042839099736, 'f1-score': 0.15314108859328038, 'support': 193188}, 'accuracy': 0.3530431056971527, 'macro avg': {'precision': 0.3769096620671357, 'recall': 0.35385431457442795, 'f1-score': 0.3181648030177503, 'support': 578833}, 'weighted avg': {'precision': 0.377050066270004, 'recall': 0.3530431056971527, 'f1-score': 0.3179004294894145, 'support': 578833}}
[[ 74945 108692  11071]
 [ 66589 111397  12951]
 [ 62305 112872  18011]]
Evaluating performance on  val set...
827/827 - 15s - 15s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1776526
{'0': {'precision': 0.3239182610818067, 'recall': 0.35331006330237236, 'f1-score': 0.3379763580670491, 'support': 67612}, '1': {'precision': 0.35044339637040767, 'recall': 0.6056529365990055, 'f1-score': 0.44398679255316575, 'support': 75819}, '2': {'precision': 0.3915671531770603, 'recall': 0.038982578192652606, 'f1-score': 0.07090608147792193, 'support': 68133}, 'accuracy': 0.34251573991794443, 'macro avg': {'precision': 0.3553096035430916, 'recall': 0.3326485260313435, 'f1-score': 0.2842897440327123, 'support': 211564}, 'weighted avg': {'precision': 0.35521012168934085, 'recall': 0.34251573991794443, 'f1-score': 0.2899592378455364, 'support': 211564}}
[[23888 41880  1844]
 [27616 45920  2283]
 [22243 43234  2656]]
training model: results/AAL/W0/deepLOB_L2/h200
Epoch 1/50
2262/2262 - 107s - loss: 3.2674 - accuracy200: 0.3852 - val_loss: 3.3983 - val_accuracy200: 0.3304 - 107s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 104s - loss: 3.2356 - accuracy200: 0.4006 - val_loss: 3.5037 - val_accuracy200: 0.3375 - 104s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 103s - loss: 3.2188 - accuracy200: 0.4109 - val_loss: 3.5784 - val_accuracy200: 0.3338 - 103s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 103s - loss: 3.2062 - accuracy200: 0.4165 - val_loss: 3.5423 - val_accuracy200: 0.3285 - 103s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 103s - loss: 3.1990 - accuracy200: 0.4205 - val_loss: 3.6055 - val_accuracy200: 0.3236 - 103s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 103s - loss: 3.1926 - accuracy200: 0.4240 - val_loss: 3.6131 - val_accuracy200: 0.3180 - 103s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 103s - loss: 3.1865 - accuracy200: 0.4260 - val_loss: 3.6976 - val_accuracy200: 0.3161 - 103s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 103s - loss: 3.1821 - accuracy200: 0.4286 - val_loss: 3.7566 - val_accuracy200: 0.3195 - 103s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 104s - loss: 3.1757 - accuracy200: 0.4316 - val_loss: 3.6617 - val_accuracy200: 0.3222 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 3.1702 - accuracy200: 0.4336 - val_loss: 3.7375 - val_accuracy200: 0.3192 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 104s - loss: 3.1643 - accuracy200: 0.4354 - val_loss: 3.7830 - val_accuracy200: 0.3219 - 104s/epoch - 46ms/step
testing model: results/AAL/W0/deepLOB_L2/h200
Evaluating performance on  test set...
6677/6677 - 115s - 115s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1049446
{'0': {'precision': 0.37809885931558934, 'recall': 0.03979526090627864, 'f1-score': 0.07201126805441399, 'support': 499758}, '1': {'precision': 0.4358964107986875, 'recall': 0.583493546647829, 'f1-score': 0.4990097084046065, 'support': 747441}, '2': {'precision': 0.2745989145890389, 'recall': 0.38992657226885846, 'f1-score': 0.3222552501958428, 'support': 462087}, 'accuracy': 0.37219926916853, 'macro avg': {'precision': 0.3628647282344386, 'recall': 0.3377384599409887, 'f1-score': 0.29775874221828774, 'support': 1709286}, 'weighted avg': {'precision': 0.37539263035169496, 'recall': 0.37219926916853, 'f1-score': 0.32638100619629, 'support': 1709286}}
[[ 19888 295883 183987]
 [ 19324 436127 291990]
 [ 13388 268519 180180]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1231556
{'0': {'precision': 0.34183918903553656, 'recall': 0.4064191419999896, 'f1-score': 0.3713423136031848, 'support': 192331}, '1': {'precision': 0.3414311550192998, 'recall': 0.3853289263247681, 'f1-score': 0.3620542838128904, 'support': 196959}, '2': {'precision': 0.34061852445556556, 'recall': 0.22981592567385764, 'f1-score': 0.2744559396146528, 'support': 189543}, 'accuracy': 0.3414128081847441, 'macro avg': {'precision': 0.3412962895034673, 'recall': 0.3405213313328718, 'f1-score': 0.33595084567690936, 'support': 578833}, 'weighted avg': {'precision': 0.3413006323217946, 'recall': 0.3414128081847441, 'f1-score': 0.3364557486623903, 'support': 578833}}
[[78167 73085 41079]
 [77819 75894 43246]
 [72680 73303 43560]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1329331
{'0': {'precision': 0.3037156050009451, 'recall': 0.3386679112342296, 'f1-score': 0.3202408746654518, 'support': 66422}, '1': {'precision': 0.359974519273503, 'recall': 0.3134828996426406, 'f1-score': 0.33512395269454887, 'support': 77513}, '2': {'precision': 0.3260186296359792, 'recall': 0.3374292093628473, 'f1-score': 0.3316257947320618, 'support': 67629}, 'accuracy': 0.3290446389744947, 'macro avg': {'precision': 0.32990291797014243, 'recall': 0.3298600067465725, 'f1-score': 0.3289968740306875, 'support': 211564}, 'weighted avg': {'precision': 0.33145722680357453, 'recall': 0.3290446389744947, 'f1-score': 0.3293330774336646, 'support': 211564}}
[[22495 21619 22308]
 [28346 24299 24868]
 [23225 21584 22820]]
training model: results/AAL/W0/deepLOB_L2/h300
Epoch 1/50
2262/2262 - 106s - loss: 3.2850 - accuracy300: 0.3736 - val_loss: 3.4820 - val_accuracy300: 0.3267 - 106s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 104s - loss: 3.2582 - accuracy300: 0.3881 - val_loss: 3.4399 - val_accuracy300: 0.3322 - 104s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 103s - loss: 3.2438 - accuracy300: 0.3987 - val_loss: 3.4857 - val_accuracy300: 0.3323 - 103s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 103s - loss: 3.2329 - accuracy300: 0.4053 - val_loss: 3.4914 - val_accuracy300: 0.3322 - 103s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 102s - loss: 3.2232 - accuracy300: 0.4097 - val_loss: 3.4814 - val_accuracy300: 0.3339 - 102s/epoch - 45ms/step
Epoch 6/50
2262/2262 - 103s - loss: 3.2161 - accuracy300: 0.4136 - val_loss: 3.5227 - val_accuracy300: 0.3344 - 103s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 3.2087 - accuracy300: 0.4177 - val_loss: 3.5399 - val_accuracy300: 0.3326 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 106s - loss: 3.1997 - accuracy300: 0.4225 - val_loss: 3.4463 - val_accuracy300: 0.3362 - 106s/epoch - 47ms/step
Epoch 9/50
2262/2262 - 104s - loss: 3.1945 - accuracy300: 0.4251 - val_loss: 3.5379 - val_accuracy300: 0.3302 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 103s - loss: 3.1881 - accuracy300: 0.4275 - val_loss: 3.5382 - val_accuracy300: 0.3276 - 103s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 104s - loss: 3.1821 - accuracy300: 0.4308 - val_loss: 3.5182 - val_accuracy300: 0.3300 - 104s/epoch - 46ms/step
Epoch 12/50
2262/2262 - 103s - loss: 3.1749 - accuracy300: 0.4332 - val_loss: 3.5834 - val_accuracy300: 0.3294 - 103s/epoch - 45ms/step
testing model: results/AAL/W0/deepLOB_L2/h300
Evaluating performance on  test set...
6677/6677 - 115s - 115s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1393872
{'0': {'precision': 0.37121580930744125, 'recall': 0.037998490248444566, 'f1-score': 0.06894011438674506, 'support': 541811}, '1': {'precision': 0.40177184755988293, 'recall': 0.3158382846468438, 'f1-score': 0.3536598090177221, 'support': 681469}, '2': {'precision': 0.28729564900864224, 'recall': 0.6609568606148896, 'f1-score': 0.4005051994272245, 'support': 486006}, 'accuracy': 0.3258968949608199, 'macro avg': {'precision': 0.35342776862532216, 'recall': 0.33826454517005927, 'f1-score': 0.27436837427723054, 'support': 1709286}, 'weighted avg': {'precision': 0.35953683422993815, 'recall': 0.3258968949608199, 'f1-score': 0.2767287853877715, 'support': 1709286}}
[[ 20588 170660 350563]
 [ 19914 215234 446321]
 [ 14959 149818 321229]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1495229
{'0': {'precision': 0.3413457383258344, 'recall': 0.33940622488234196, 'f1-score': 0.3403732186943936, 'support': 197819}, '1': {'precision': 0.3248148354684498, 'recall': 0.34242409666885787, 'f1-score': 0.3333871009704192, 'support': 187113}, '2': {'precision': 0.34779128195974707, 'recall': 0.33161252391684415, 'f1-score': 0.3395092691838577, 'support': 193901}, 'accuracy': 0.3377709978525758, 'macro avg': {'precision': 0.3379839519180104, 'recall': 0.3378142818226813, 'f1-score': 0.3377565296162235, 'support': 578833}, 'weighted avg': {'precision': 0.33816114195659747, 'recall': 0.3377709978525758, 'f1-score': 0.33782548192104367, 'support': 578833}}
[[67141 68377 62301]
 [64761 64072 58280]
 [64793 64808 64300]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1486225
{'0': {'precision': 0.3082289576894576, 'recall': 0.2492181791611866, 'f1-score': 0.2756001583723204, 'support': 68430}, '1': {'precision': 0.34127189464696905, 'recall': 0.36225197391005837, 'f1-score': 0.35144910642322835, 'support': 72825}, '2': {'precision': 0.33223113273282406, 'recall': 0.37298212177672846, 'f1-score': 0.3514292223368757, 'support': 70309}, 'accuracy': 0.32925734056833866, 'macro avg': {'precision': 0.3272439950230836, 'recall': 0.3281507582826578, 'f1-score': 0.32615949571080816, 'support': 211564}, 'weighted avg': {'precision': 0.3275797017151653, 'recall': 0.32925734056833866, 'f1-score': 0.3269092908338511, 'support': 211564}}
[[17054 25354 26022]
 [19757 26381 26687]
 [18518 25567 26224]]
training model: results/AAL/W0/deepLOB_L2/h500
Epoch 1/50
2262/2262 - 106s - loss: 3.1629 - accuracy500: 0.4381 - val_loss: 3.3781 - val_accuracy500: 0.3926 - 106s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 104s - loss: 3.1215 - accuracy500: 0.4589 - val_loss: 3.4537 - val_accuracy500: 0.3535 - 104s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 103s - loss: 3.1151 - accuracy500: 0.4635 - val_loss: 3.4262 - val_accuracy500: 0.3498 - 103s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 103s - loss: 3.1138 - accuracy500: 0.4630 - val_loss: 3.5117 - val_accuracy500: 0.3355 - 103s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 104s - loss: 3.1069 - accuracy500: 0.4655 - val_loss: 3.5404 - val_accuracy500: 0.3300 - 104s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 3.1070 - accuracy500: 0.4659 - val_loss: 3.5059 - val_accuracy500: 0.3464 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 104s - loss: 3.1044 - accuracy500: 0.4672 - val_loss: 3.5181 - val_accuracy500: 0.3556 - 104s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 103s - loss: 3.1047 - accuracy500: 0.4675 - val_loss: 3.5900 - val_accuracy500: 0.3717 - 103s/epoch - 46ms/step
Epoch 9/50
2262/2262 - 104s - loss: 3.0949 - accuracy500: 0.4705 - val_loss: 3.5545 - val_accuracy500: 0.3455 - 104s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 104s - loss: 3.0848 - accuracy500: 0.4735 - val_loss: 3.6326 - val_accuracy500: 0.3494 - 104s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 104s - loss: 3.0767 - accuracy500: 0.4763 - val_loss: 3.5643 - val_accuracy500: 0.3738 - 104s/epoch - 46ms/step
testing model: results/AAL/W0/deepLOB_L2/h500
Evaluating performance on  test set...
6677/6677 - 113s - 113s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.075545
{'0': {'precision': 0.30761316872427985, 'recall': 0.004422366652862178, 'f1-score': 0.008719380103316115, 'support': 473276}, '1': {'precision': 0.46881160861243965, 'recall': 0.9958769861430286, 'f1-score': 0.6375125655044341, 'support': 801113}, '2': {'precision': 0.23628691983122363, 'recall': 0.0003862983649001948, 'f1-score': 0.0007713356963141173, 'support': 434897}, 'accuracy': 0.46807321887618575, 'macro avg': {'precision': 0.3375705657226477, 'recall': 0.33356188372026363, 'f1-score': 0.21566776043468813, 'support': 1709286}, 'weighted avg': {'precision': 0.3650164319050933, 'recall': 0.46807321887618575, 'f1-score': 0.3014017132340935, 'support': 1709286}}
[[  2093 470949    234]
 [  2994 797810    309]
 [  1717 433012    168]]
Evaluating performance on  train set...
2262/2262 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1784047
{'0': {'precision': 0.33567912628826335, 'recall': 0.1357613147389704, 'f1-score': 0.1933319060029088, 'support': 192890}, '1': {'precision': 0.34129683880912604, 'recall': 0.8598667188540464, 'f1-score': 0.4886425184476929, 'support': 196727}, '2': {'precision': 0.3056894889103182, 'recall': 0.008376670049044478, 'f1-score': 0.016306500480964606, 'support': 189216}, 'accuracy': 0.34022075451814254, 'macro avg': {'precision': 0.3275551513359026, 'recall': 0.3346682345473537, 'f1-score': 0.2327603083105221, 'support': 578833}, 'weighted avg': {'precision': 0.32778502989947156, 'recall': 0.34022075451814254, 'f1-score': 0.23583040163668373, 'support': 578833}}
[[ 26187 165054   1649]
 [ 25617 169159   1951]
 [ 26208 161423   1585]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1236234
{'0': {'precision': 0.24763189448441247, 'recall': 0.1411003125693887, 'f1-score': 0.17976867920833017, 'support': 58547}, '1': {'precision': 0.4218576085789673, 'recall': 0.8185425962265805, 'f1-score': 0.5567693730239218, 'support': 91217}, '2': {'precision': 0.281121187139324, 'recall': 0.005517799352750809, 'f1-score': 0.010823163474203734, 'support': 61800}, 'accuracy': 0.3935783025467471, 'macro avg': {'precision': 0.3168702300675679, 'recall': 0.32172023604957334, 'f1-score': 0.24912040523548526, 'support': 211564}, 'weighted avg': {'precision': 0.33253284761744334, 'recall': 0.3935783025467471, 'f1-score': 0.2929639270548816, 'support': 211564}}
[[ 8261 50001   285]
 [15965 74665   587]
 [ 9134 52325   341]]
training model: results/AAL/W0/deepLOB_L2/h1000
Epoch 1/50
2262/2262 - 105s - loss: 3.1896 - accuracy1000: 0.4317 - val_loss: 3.4918 - val_accuracy1000: 0.3460 - 105s/epoch - 47ms/step
Epoch 2/50
2262/2262 - 103s - loss: 3.1229 - accuracy1000: 0.4569 - val_loss: 3.5776 - val_accuracy1000: 0.3249 - 103s/epoch - 46ms/step
Epoch 3/50
2262/2262 - 104s - loss: 3.1096 - accuracy1000: 0.4609 - val_loss: 3.5141 - val_accuracy1000: 0.3276 - 104s/epoch - 46ms/step
Epoch 4/50
2262/2262 - 103s - loss: 3.1034 - accuracy1000: 0.4633 - val_loss: 3.5205 - val_accuracy1000: 0.3194 - 103s/epoch - 46ms/step
Epoch 5/50
2262/2262 - 104s - loss: 3.0927 - accuracy1000: 0.4661 - val_loss: 3.5331 - val_accuracy1000: 0.3161 - 104s/epoch - 46ms/step
Epoch 6/50
2262/2262 - 104s - loss: 3.0822 - accuracy1000: 0.4703 - val_loss: 3.6373 - val_accuracy1000: 0.3119 - 104s/epoch - 46ms/step
Epoch 7/50
2262/2262 - 103s - loss: 3.0753 - accuracy1000: 0.4721 - val_loss: 3.5644 - val_accuracy1000: 0.3159 - 103s/epoch - 46ms/step
Epoch 8/50
2262/2262 - 103s - loss: 3.0633 - accuracy1000: 0.4771 - val_loss: 3.6102 - val_accuracy1000: 0.3136 - 103s/epoch - 45ms/step
Epoch 9/50
2262/2262 - 103s - loss: 3.0598 - accuracy1000: 0.4779 - val_loss: 3.6475 - val_accuracy1000: 0.3111 - 103s/epoch - 46ms/step
Epoch 10/50
2262/2262 - 103s - loss: 3.0521 - accuracy1000: 0.4811 - val_loss: 3.6371 - val_accuracy1000: 0.3112 - 103s/epoch - 46ms/step
Epoch 11/50
2262/2262 - 102s - loss: 3.0444 - accuracy1000: 0.4840 - val_loss: 3.6122 - val_accuracy1000: 0.3122 - 102s/epoch - 45ms/step
testing model: results/AAL/W0/deepLOB_L2/h1000
Evaluating performance on  test set...
6677/6677 - 113s - 113s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0704949
{'0': {'precision': 0.2969413470500915, 'recall': 0.07510144566899571, 'f1-score': 0.11988257737436736, 'support': 458127}, '1': {'precision': 0.49412788869426855, 'recall': 0.838620914263572, 'f1-score': 0.6218515910278773, 'support': 841311}, '2': {'precision': 0.240452505632161, 'recall': 0.09713601139934805, 'f1-score': 0.13837317414387876, 'support': 409848}, 'accuracy': 0.456189309454357, 'macro avg': {'precision': 0.3438405804588403, 'recall': 0.3369527904439719, 'f1-score': 0.29336911418204115, 'support': 1709286}, 'weighted avg': {'precision': 0.3804518700753478, 'recall': 0.456189309454357, 'f1-score': 0.37138547797183247, 'support': 1709286}}
[[ 34406 379912  43809]
 [ 53823 705541  81947]
 [ 27639 342398  39811]]
Evaluating performance on  train set...
2262/2262 - 40s - 40s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1596024
{'0': {'precision': 0.31601384468100774, 'recall': 0.199689770171402, 'f1-score': 0.24473255644481626, 'support': 193405}, '1': {'precision': 0.32625958582313075, 'recall': 0.6756702722099759, 'f1-score': 0.4400385943123468, 'support': 195070}, '2': {'precision': 0.3301037273452639, 'recall': 0.09128063963689469, 'f1-score': 0.14301469983044987, 'support': 190358}, 'accuracy': 0.32444591099678144, 'macro avg': {'precision': 0.3241257192831341, 'recall': 0.3222135606727575, 'f1-score': 0.27592861686253767, 'support': 578833}, 'weighted avg': {'precision': 0.3241003888289682, 'recall': 0.32444591099678144, 'f1-score': 0.27710033965244546, 'support': 578833}}
[[ 38621 137029  17755]
 [ 45760 131803  17507]
 [ 37832 135150  17376]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1610392
{'0': {'precision': 0.29280661951154413, 'recall': 0.10009885179834233, 'f1-score': 0.14919418818142666, 'support': 65755}, '1': {'precision': 0.356930662137676, 'recall': 0.8285055046476366, 'f1-score': 0.4989201892844666, 'support': 75845}, '2': {'precision': 0.3037440540125825, 'recall': 0.056586244354239326, 'f1-score': 0.09539988915395552, 'support': 69964}, 'accuracy': 0.3468406723261046, 'macro avg': {'precision': 0.31782711188726753, 'recall': 0.3283968669334061, 'f1-score': 0.24783808887328293, 'support': 211564}, 'weighted avg': {'precision': 0.3194118769296758, 'recall': 0.3468406723261046, 'f1-score': 0.25678009228846793, 'support': 211564}}
[[ 6582 54720  4453]
 [ 8385 62838  4622]
 [ 7512 58493  3959]]
training model: results/AAL/W0/deepOF_L2/h10
Epoch 1/50
2262/2262 - 65s - loss: 2.8283 - accuracy10: 0.5273 - val_loss: 2.8054 - val_accuracy10: 0.6582 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.5724 - accuracy10: 0.5959 - val_loss: 2.7355 - val_accuracy10: 0.6790 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 2.5094 - accuracy10: 0.6091 - val_loss: 2.7384 - val_accuracy10: 0.6819 - 62s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.4792 - accuracy10: 0.6134 - val_loss: 2.7570 - val_accuracy10: 0.6880 - 62s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 2.4597 - accuracy10: 0.6151 - val_loss: 2.7356 - val_accuracy10: 0.6854 - 62s/epoch - 27ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.4443 - accuracy10: 0.6173 - val_loss: 2.7392 - val_accuracy10: 0.6820 - 62s/epoch - 27ms/step
Epoch 7/50
2262/2262 - 63s - loss: 2.4332 - accuracy10: 0.6181 - val_loss: 2.7472 - val_accuracy10: 0.6824 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 2.4255 - accuracy10: 0.6194 - val_loss: 2.7612 - val_accuracy10: 0.6855 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 64s - loss: 2.4157 - accuracy10: 0.6216 - val_loss: 2.7488 - val_accuracy10: 0.6823 - 64s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 63s - loss: 2.4098 - accuracy10: 0.6214 - val_loss: 2.7585 - val_accuracy10: 0.6843 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 2.4027 - accuracy10: 0.6227 - val_loss: 2.7618 - val_accuracy10: 0.6840 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.3966 - accuracy10: 0.6235 - val_loss: 2.7602 - val_accuracy10: 0.6833 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h10
Evaluating performance on  test set...
6677/6677 - 79s - 79s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63376385
{'0': {'precision': 0.3667901003318781, 'recall': 0.4286780802694359, 'f1-score': 0.39532662627245646, 'support': 178150}, '1': {'precision': 0.8837900688886234, 'recall': 0.824904629803075, 'f1-score': 0.8533326874115221, 'support': 1345284}, '2': {'precision': 0.3554530563682147, 'recall': 0.46939686946789566, 'f1-score': 0.40455492975381957, 'support': 185847}, 'accuracy': 0.7449541649383571, 'macro avg': {'precision': 0.5353444085295721, 'recall': 0.5743265265134688, 'f1-score': 0.551071414479266, 'support': 1709281}, 'weighted avg': {'precision': 0.772460572355131, 'recall': 0.7449541649383571, 'f1-score': 0.7568021697732078, 'support': 1709281}}
[[  76369   82459   19322]
 [  96689 1109731  138864]
 [  35151   63460   87236]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8140839
{'0': {'precision': 0.4336184105299801, 'recall': 0.44278344077550513, 'f1-score': 0.4381530036981756, 'support': 104087}, '1': {'precision': 0.7930046159599466, 'recall': 0.7717300380228137, 'f1-score': 0.7822226993814365, 'support': 368200}, '2': {'precision': 0.43263994677032447, 'recall': 0.4638177654302448, 'f1-score': 0.44768669088537183, 'support': 106544}, 'accuracy': 0.6559012907048862, 'macro avg': {'precision': 0.5530876577534171, 'recall': 0.5594437480761879, 'f1-score': 0.5560207979883279, 'support': 578831}, 'weighted avg': {'precision': 0.6620473498862083, 'recall': 0.6559012907048862, 'f1-score': 0.658773908795258, 'support': 578831}}
[[ 46088  39407  18592]
 [ 37836 284151  46213]
 [ 22363  34764  49417]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.77381754
{'0': {'precision': 0.42265506285398535, 'recall': 0.4489903733270721, 'f1-score': 0.4354248793886176, 'support': 34072}, '1': {'precision': 0.8020975413253804, 'recall': 0.7987782133481599, 'f1-score': 0.8004344361146177, 'support': 142087}, '2': {'precision': 0.4378210806023029, 'recall': 0.41883914701313374, 'f1-score': 0.42811981234211477, 'support': 35405}, 'accuracy': 0.6788631336144145, 'macro avg': {'precision': 0.5541912282605562, 'recall': 0.5555359112294552, 'f1-score': 0.5546597092817834, 'support': 211564}, 'weighted avg': {'precision': 0.6800277552635838, 'recall': 0.6788631336144145, 'f1-score': 0.6793438683836533, 'support': 211564}}
[[ 15298  14644   4130]
 [ 13680 113496  14911]
 [  7217  13359  14829]]
training model: results/AAL/W0/deepOF_L2/h20
Epoch 1/50
2262/2262 - 65s - loss: 2.8742 - accuracy20: 0.5271 - val_loss: 2.8999 - val_accuracy20: 0.6204 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.6446 - accuracy20: 0.5861 - val_loss: 2.8516 - val_accuracy20: 0.6382 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 2.5882 - accuracy20: 0.5978 - val_loss: 2.8750 - val_accuracy20: 0.6431 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.5599 - accuracy20: 0.6019 - val_loss: 2.8790 - val_accuracy20: 0.6443 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 62s - loss: 2.5436 - accuracy20: 0.6044 - val_loss: 2.8743 - val_accuracy20: 0.6441 - 62s/epoch - 27ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.5302 - accuracy20: 0.6063 - val_loss: 2.8742 - val_accuracy20: 0.6458 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 2.5196 - accuracy20: 0.6084 - val_loss: 2.8802 - val_accuracy20: 0.6456 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 2.5120 - accuracy20: 0.6101 - val_loss: 2.8722 - val_accuracy20: 0.6455 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 2.5040 - accuracy20: 0.6109 - val_loss: 2.8761 - val_accuracy20: 0.6467 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 2.4981 - accuracy20: 0.6122 - val_loss: 2.8605 - val_accuracy20: 0.6465 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 2.4909 - accuracy20: 0.6138 - val_loss: 2.8787 - val_accuracy20: 0.6472 - 62s/epoch - 27ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.4860 - accuracy20: 0.6138 - val_loss: 2.8760 - val_accuracy20: 0.6475 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h20
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6744176
{'0': {'precision': 0.4633032189308983, 'recall': 0.38938535886297293, 'f1-score': 0.42314039348933097, 'support': 245623}, '1': {'precision': 0.8146496810401229, 'recall': 0.8753877828218392, 'f1-score': 0.8439273013896675, 'support': 1213308}, '2': {'precision': 0.4932111695474615, 'recall': 0.39219892150988617, 'f1-score': 0.43694304080529206, 'support': 250350}, 'accuracy': 0.7347791264280127, 'macro avg': {'precision': 0.5903880231728276, 'recall': 0.5523240210648994, 'f1-score': 0.5680035785614302, 'support': 1709281}, 'weighted avg': {'precision': 0.7170818127874239, 'recall': 0.7347791264280127, 'f1-score': 0.7238514026249221, 'support': 1709281}}
[[  95642  127373   22608]
 [  72911 1062115   78282]
 [  37882  114281   98187]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8754867
{'0': {'precision': 0.5032041283790408, 'recall': 0.4158031565070738, 'f1-score': 0.45534756554911243, 'support': 135783}, '1': {'precision': 0.6877506521823774, 'recall': 0.8101965461092127, 'f1-score': 0.7439690846486747, 'support': 305221}, '2': {'precision': 0.514915475856916, 'recall': 0.4000087065669281, 'f1-score': 0.45024643013185134, 'support': 137827}, 'accuracy': 0.6200082580234991, 'macro avg': {'precision': 0.5686234188061113, 'recall': 0.5420028030610715, 'f1-score': 0.5498543601098795, 'support': 578831}, 'weighted avg': {'precision': 0.6033052190784182, 'recall': 0.6200082580234991, 'f1-score': 0.6063247497184687, 'support': 578831}}
[[ 56459  57403  21921]
 [ 27915 247289  30017]
 [ 27825  54870  55132]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84669054
{'0': {'precision': 0.5057868830650526, 'recall': 0.41551004349631704, 'f1-score': 0.45622540078717483, 'support': 45751}, '1': {'precision': 0.700751210833251, 'recall': 0.8325197114578091, 'f1-score': 0.7609734031542065, 'support': 119220}, '2': {'precision': 0.5264834111499335, 'recall': 0.36544116068937393, 'f1-score': 0.43142372108343674, 'support': 46593}, 'accuracy': 0.6394755251366017, 'macro avg': {'precision': 0.5776738350160789, 'recall': 0.5378236385478333, 'f1-score': 0.5495408416749393, 'support': 211564}, 'weighted avg': {'precision': 0.620210700394955, 'recall': 0.6394755251366017, 'f1-score': 0.6224941051970048, 'support': 211564}}
[[19010 21423  5318]
 [ 9971 99253  9996]
 [ 8604 20962 17027]]
training model: results/AAL/W0/deepOF_L2/h30
Epoch 1/50
2262/2262 - 66s - loss: 2.9200 - accuracy30: 0.5170 - val_loss: 3.0542 - val_accuracy30: 0.5699 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 65s - loss: 2.7183 - accuracy30: 0.5671 - val_loss: 2.9782 - val_accuracy30: 0.5943 - 65s/epoch - 29ms/step
Epoch 3/50
2262/2262 - 63s - loss: 2.6676 - accuracy30: 0.5776 - val_loss: 2.9967 - val_accuracy30: 0.5988 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 63s - loss: 2.6424 - accuracy30: 0.5825 - val_loss: 3.0070 - val_accuracy30: 0.6012 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 2.6287 - accuracy30: 0.5856 - val_loss: 3.0394 - val_accuracy30: 0.6005 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.6174 - accuracy30: 0.5871 - val_loss: 3.0114 - val_accuracy30: 0.6029 - 62s/epoch - 27ms/step
Epoch 7/50
2262/2262 - 62s - loss: 2.6079 - accuracy30: 0.5894 - val_loss: 3.0106 - val_accuracy30: 0.6034 - 62s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 62s - loss: 2.6005 - accuracy30: 0.5906 - val_loss: 2.9977 - val_accuracy30: 0.6034 - 62s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 2.5938 - accuracy30: 0.5920 - val_loss: 3.0099 - val_accuracy30: 0.6033 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 2.5875 - accuracy30: 0.5937 - val_loss: 3.0027 - val_accuracy30: 0.6017 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 63s - loss: 2.5827 - accuracy30: 0.5948 - val_loss: 2.9994 - val_accuracy30: 0.6041 - 63s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 2.5770 - accuracy30: 0.5956 - val_loss: 3.0101 - val_accuracy30: 0.6038 - 63s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h30
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7464616
{'0': {'precision': 0.5432024416483465, 'recall': 0.3125862173383488, 'f1-score': 0.39682132895956396, 'support': 297214}, '1': {'precision': 0.7489917803275283, 'recall': 0.8857681109779072, 'f1-score': 0.8116580764272492, 'support': 1115249}, '2': {'precision': 0.4989331631257409, 'recall': 0.36869731620049995, 'f1-score': 0.42404070071567235, 'support': 296818}, 'accuracy': 0.6963120750771816, 'macro avg': {'precision': 0.5970424617005387, 'recall': 0.522350548172252, 'f1-score': 0.5441733687008284, 'support': 1709281}, 'weighted avg': {'precision': 0.669785745072474, 'recall': 0.6963120750771816, 'f1-score': 0.6722151742445073, 'support': 1709281}}
[[ 92905 176153  28156]
 [ 45649 987852  81748]
 [ 32478 154904 109436]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.94364667
{'0': {'precision': 0.545080748526019, 'recall': 0.3395786488143908, 'f1-score': 0.41846112670180147, 'support': 156544}, '1': {'precision': 0.5997169650191536, 'recall': 0.8366116643281533, 'f1-score': 0.6986287093065855, 'support': 264413}, '2': {'precision': 0.5317794160804645, 'recall': 0.37876407768220227, 'f1-score': 0.44241475874978264, 'support': 157874}, 'accuracy': 0.5773135854852279, 'macro avg': {'precision': 0.5588590432085457, 'recall': 0.5183181302749155, 'f1-score': 0.5198348649193899, 'support': 578831}, 'weighted avg': {'precision': 0.5664109664187886, 'recall': 0.5773135854852279, 'f1-score': 0.5529763940686525, 'support': 578831}}
[[ 53159  75978  27407]
 [ 17959 221211  25243]
 [ 26407  71670  59797]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.91912436
{'0': {'precision': 0.5566602199927475, 'recall': 0.34407336844857855, 'f1-score': 0.42527992612259025, 'support': 53538}, '1': {'precision': 0.6150735217869217, 'recall': 0.8546111212502522, 'f1-score': 0.7153217182964972, 'support': 104107}, '2': {'precision': 0.5436563082108749, 'recall': 0.3410115172759139, 'f1-score': 0.41912468657396856, 'support': 53919}, 'accuracy': 0.594519861602163, 'macro avg': {'precision': 0.5717966833301813, 'recall': 0.5132320023249148, 'f1-score': 0.5199087769976853, 'support': 211564}, 'weighted avg': {'precision': 0.5820902349788477, 'recall': 0.594519861602163, 'f1-score': 0.5664357772911577, 'support': 211564}}
[[18421 28402  6715]
 [ 6417 88971  8719]
 [ 8254 27278 18387]]
training model: results/AAL/W0/deepOF_L2/h50
Epoch 1/50
2262/2262 - 65s - loss: 3.0027 - accuracy50: 0.4884 - val_loss: 3.1839 - val_accuracy50: 0.4926 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.8374 - accuracy50: 0.5304 - val_loss: 3.1229 - val_accuracy50: 0.5126 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 2.7922 - accuracy50: 0.5398 - val_loss: 3.1270 - val_accuracy50: 0.5158 - 62s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.7727 - accuracy50: 0.5448 - val_loss: 3.1450 - val_accuracy50: 0.5191 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 62s - loss: 2.7612 - accuracy50: 0.5472 - val_loss: 3.1399 - val_accuracy50: 0.5187 - 62s/epoch - 27ms/step
Epoch 6/50
2262/2262 - 63s - loss: 2.7512 - accuracy50: 0.5496 - val_loss: 3.1531 - val_accuracy50: 0.5195 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 2.7440 - accuracy50: 0.5510 - val_loss: 3.1566 - val_accuracy50: 0.5201 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 64s - loss: 2.7376 - accuracy50: 0.5524 - val_loss: 3.1396 - val_accuracy50: 0.5225 - 64s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 2.7314 - accuracy50: 0.5539 - val_loss: 3.1572 - val_accuracy50: 0.5210 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 2.7267 - accuracy50: 0.5553 - val_loss: 3.1696 - val_accuracy50: 0.5218 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 2.7220 - accuracy50: 0.5565 - val_loss: 3.1733 - val_accuracy50: 0.5218 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.7177 - accuracy50: 0.5572 - val_loss: 3.1611 - val_accuracy50: 0.5237 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h50
Evaluating performance on  test set...
6677/6677 - 80s - 80s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84297556
{'0': {'precision': 0.5907398517720615, 'recall': 0.2655877414158854, 'f1-score': 0.36643280969707537, 'support': 379946}, '1': {'precision': 0.642437912977608, 'recall': 0.9125660782616856, 'f1-score': 0.7540392823112432, 'support': 959090}, '2': {'precision': 0.5635061697548566, 'recall': 0.268022525624924, 'f1-score': 0.3632643050374671, 'support': 370245}, 'accuracy': 0.6291393866777902, 'macro avg': {'precision': 0.598894644834842, 'recall': 0.48205878176749833, 'f1-score': 0.4945787990152619, 'support': 1709281}, 'weighted avg': {'precision': 0.6138489595917632, 'recall': 0.6291393866777902, 'f1-score': 0.5832352949594902, 'support': 1709281}}
[[100909 248820  30217]
 [ 37207 875233  46650]
 [ 32702 238309  99234]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0409768
{'0': {'precision': 0.560791374571179, 'recall': 0.285072897034293, 'f1-score': 0.37799544713578875, 'support': 184644}, '1': {'precision': 0.46851401592631187, 'recall': 0.8704766002198958, 'f1-score': 0.6091610842093819, 'support': 209190}, '2': {'precision': 0.5591148861937199, 'recall': 0.29105877392606366, 'f1-score': 0.38282835823548433, 'support': 184997}, 'accuracy': 0.498551390647702, 'macro avg': {'precision': 0.5294734255637369, 'recall': 0.4822027570600842, 'f1-score': 0.45666162986021835, 'support': 578831}, 'weighted avg': {'precision': 0.5269064479254317, 'recall': 0.498551390647702, 'f1-score': 0.46308351891172217, 'support': 578831}}
[[ 52637 103297  28710]
 [ 13346 182095  13749]
 [ 27879 103273  53845]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0221288
{'0': {'precision': 0.5824519306664983, 'recall': 0.2873967907773797, 'f1-score': 0.38488259286690385, 'support': 64190}, '1': {'precision': 0.48655754556596686, 'recall': 0.8845748376740062, 'f1-score': 0.6277972384709563, 'support': 83474}, '2': {'precision': 0.576938115380514, 'recall': 0.2540062597809077, 'f1-score': 0.35272130648789024, 'support': 63900}, 'accuracy': 0.5129322569057118, 'macro avg': {'precision': 0.5486491972043264, 'recall': 0.47532596274409783, 'f1-score': 0.4551337126085835, 'support': 211564}, 'weighted avg': {'precision': 0.542950783502254, 'recall': 0.5129322569057118, 'f1-score': 0.4710123263165158, 'support': 211564}}
[[18448 38745  6997]
 [ 4730 73839  4905]
 [ 8495 39174 16231]]
training model: results/AAL/W0/deepOF_L2/h100
Epoch 1/50
2262/2262 - 68s - loss: 3.1687 - accuracy100: 0.4336 - val_loss: 3.2821 - val_accuracy100: 0.4105 - 68s/epoch - 30ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.0993 - accuracy100: 0.4600 - val_loss: 3.2762 - val_accuracy100: 0.4232 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 3.0730 - accuracy100: 0.4676 - val_loss: 3.2982 - val_accuracy100: 0.4261 - 62s/epoch - 27ms/step
Epoch 4/50
2262/2262 - 63s - loss: 3.0588 - accuracy100: 0.4716 - val_loss: 3.3223 - val_accuracy100: 0.4295 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 63s - loss: 3.0495 - accuracy100: 0.4741 - val_loss: 3.3335 - val_accuracy100: 0.4301 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 64s - loss: 3.0423 - accuracy100: 0.4767 - val_loss: 3.3131 - val_accuracy100: 0.4335 - 64s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.0364 - accuracy100: 0.4784 - val_loss: 3.3303 - val_accuracy100: 0.4337 - 62s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 62s - loss: 3.0312 - accuracy100: 0.4797 - val_loss: 3.3257 - val_accuracy100: 0.4345 - 62s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.0267 - accuracy100: 0.4817 - val_loss: 3.3233 - val_accuracy100: 0.4346 - 62s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 3.0228 - accuracy100: 0.4832 - val_loss: 3.3297 - val_accuracy100: 0.4360 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.0183 - accuracy100: 0.4844 - val_loss: 3.3406 - val_accuracy100: 0.4367 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 3.0146 - accuracy100: 0.4858 - val_loss: 3.3509 - val_accuracy100: 0.4360 - 63s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h100
Evaluating performance on  test set...
6677/6677 - 79s - 79s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.98043054
{'0': {'precision': 0.5322650812064965, 'recall': 0.19604142836160354, 'f1-score': 0.2865442102078854, 'support': 449354}, '1': {'precision': 0.5277008710320813, 'recall': 0.8827817233618712, 'f1-score': 0.6605465196107898, 'support': 827789}, '2': {'precision': 0.4941157230647302, 'recall': 0.18178452253678223, 'f1-score': 0.2657865310148007, 'support': 432138}, 'accuracy': 0.5250189992166296, 'macro avg': {'precision': 0.5180272251011027, 'recall': 0.42020255808675233, 'f1-score': 0.4042924202778253, 'support': 1709281}, 'weighted avg': {'precision': 0.52040980971823, 'recall': 0.5250189992166296, 'f1-score': 0.46242214702879403, 'support': 1709281}}
[[ 88092 329164  32098]
 [ 48703 730757  48329]
 [ 28709 324873  78556]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1072918
{'0': {'precision': 0.5062921664767708, 'recall': 0.2031342294634006, 'f1-score': 0.2899392233194771, 'support': 194689}, '1': {'precision': 0.3742791584496182, 'recall': 0.8391492259737539, 'f1-score': 0.5176672478456251, 'support': 190885}, '2': {'precision': 0.5004673796497402, 'recall': 0.18838644913250233, 'f1-score': 0.2737337548824637, 'support': 193257}, 'accuracy': 0.407953271334811, 'macro avg': {'precision': 0.46034623485870974, 'recall': 0.4102233015232189, 'f1-score': 0.3604467420158553, 'support': 578831}, 'weighted avg': {'precision': 0.4608125984075166, 'recall': 0.407953271334811, 'f1-score': 0.3596280336076991, 'support': 578831}}
[[ 39548 132920  22221]
 [ 16586 160181  14118]
 [ 21979 134871  36407]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0942005
{'0': {'precision': 0.500194848903532, 'recall': 0.20887948634494186, 'f1-score': 0.2946953173104017, 'support': 67594}, '1': {'precision': 0.39704504996247386, 'recall': 0.8448533002494489, 'f1-score': 0.5402130065657333, 'support': 75767}, '2': {'precision': 0.5113492494121903, 'recall': 0.16581382050642934, 'f1-score': 0.2504234989315648, 'support': 68203}, 'accuracy': 0.4227562345200507, 'macro avg': {'precision': 0.4695297160927321, 'recall': 0.4065155357002734, 'f1-score': 0.3617772742692333, 'support': 211564}, 'weighted avg': {'precision': 0.46684991669164755, 'recall': 0.4227562345200507, 'f1-score': 0.3683499463253423, 'support': 211564}}
[[14119 47723  5752]
 [ 6700 64012  5055]
 [ 7408 49486 11309]]
training model: results/AAL/W0/deepOF_L2/h200
Epoch 1/50
2262/2262 - 66s - loss: 3.2569 - accuracy200: 0.3890 - val_loss: 3.2665 - val_accuracy200: 0.3805 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.2222 - accuracy200: 0.4055 - val_loss: 3.2688 - val_accuracy200: 0.3836 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 3.2086 - accuracy200: 0.4112 - val_loss: 3.2730 - val_accuracy200: 0.3860 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 63s - loss: 3.1993 - accuracy200: 0.4153 - val_loss: 3.2737 - val_accuracy200: 0.3897 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.1926 - accuracy200: 0.4183 - val_loss: 3.2805 - val_accuracy200: 0.3907 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 3.1879 - accuracy200: 0.4204 - val_loss: 3.2842 - val_accuracy200: 0.3916 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.1835 - accuracy200: 0.4223 - val_loss: 3.2926 - val_accuracy200: 0.3922 - 62s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 62s - loss: 3.1799 - accuracy200: 0.4240 - val_loss: 3.2930 - val_accuracy200: 0.3926 - 62s/epoch - 27ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.1764 - accuracy200: 0.4255 - val_loss: 3.2946 - val_accuracy200: 0.3929 - 62s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 64s - loss: 3.1726 - accuracy200: 0.4268 - val_loss: 3.3026 - val_accuracy200: 0.3928 - 64s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 64s - loss: 3.1704 - accuracy200: 0.4286 - val_loss: 3.3025 - val_accuracy200: 0.3920 - 64s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h200
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0625293
{'0': {'precision': 0.3742822456278505, 'recall': 0.342376394927935, 'f1-score': 0.35761909141070436, 'support': 499757}, '1': {'precision': 0.4457169703538004, 'recall': 0.5584849620036391, 'f1-score': 0.49576926160268653, 'support': 747440}, '2': {'precision': 0.3449193709380476, 'recall': 0.23556323092771012, 'f1-score': 0.2799405913857509, 'support': 462084}, 'accuracy': 0.40800137601716746, 'macro avg': {'precision': 0.3883061956398995, 'recall': 0.3788081959530947, 'f1-score': 0.3777763147997139, 'support': 1709281}, 'weighted avg': {'precision': 0.39758154870382284, 'recall': 0.40800137601716746, 'f1-score': 0.39703038259264845, 'support': 1709281}}
[[171105 257929  70723]
 [193998 417434 136008]
 [ 92052 261182 108850]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0951989
{'0': {'precision': 0.40039374268383526, 'recall': 0.2737956629311599, 'f1-score': 0.32520852240805564, 'support': 192388}, '1': {'precision': 0.3469938854313881, 'recall': 0.6149067060873452, 'f1-score': 0.44364016199673806, 'support': 196851}, '2': {'precision': 0.3988256090375277, 'recall': 0.20706569897464028, 'f1-score': 0.27260039024254756, 'support': 189592}, 'accuracy': 0.3679450478637115, 'macro avg': {'precision': 0.38207107905091703, 'recall': 0.3652560226643818, 'f1-score': 0.34714969154911374, 'support': 578831}, 'weighted avg': {'precision': 0.3817196894726696, 'recall': 0.36794504786371146, 'f1-score': 0.348253773424585, 'support': 578831}}
[[ 52675 112215  27498]
 [ 44128 121045  31678]
 [ 34755 115579  39258]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0871755
{'0': {'precision': 0.389869037799996, 'recall': 0.292109427990052, 'f1-score': 0.3339824564426904, 'support': 66345}, '1': {'precision': 0.37509808428511415, 'recall': 0.6102514506769826, 'f1-score': 0.46461512784892767, 'support': 77550}, '2': {'precision': 0.39562317865949337, 'recall': 0.2086479776559429, 'f1-score': 0.2732083942064882, 'support': 67669}, 'accuracy': 0.38203096935206365, 'macro avg': {'precision': 0.38686343358153447, 'recall': 0.37033628544099245, 'f1-score': 0.35726865949936876, 'support': 211564}, 'weighted avg': {'precision': 0.3862951287830661, 'recall': 0.38203096935206365, 'f1-score': 0.3624279559137352, 'support': 211564}}
[[19380 37969  8996]
 [17652 47325 12573]
 [12677 40873 14119]]
training model: results/AAL/W0/deepOF_L2/h300
Epoch 1/50
2262/2262 - 65s - loss: 3.2773 - accuracy300: 0.3762 - val_loss: 3.2893 - val_accuracy300: 0.3604 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.2523 - accuracy300: 0.3900 - val_loss: 3.2877 - val_accuracy300: 0.3664 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 3.2429 - accuracy300: 0.3942 - val_loss: 3.2867 - val_accuracy300: 0.3673 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.2370 - accuracy300: 0.3972 - val_loss: 3.2862 - val_accuracy300: 0.3733 - 62s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.2326 - accuracy300: 0.3995 - val_loss: 3.2892 - val_accuracy300: 0.3744 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 3.2289 - accuracy300: 0.4008 - val_loss: 3.2866 - val_accuracy300: 0.3742 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 3.2258 - accuracy300: 0.4035 - val_loss: 3.2940 - val_accuracy300: 0.3734 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 64s - loss: 3.2230 - accuracy300: 0.4050 - val_loss: 3.2925 - val_accuracy300: 0.3736 - 64s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 3.2203 - accuracy300: 0.4064 - val_loss: 3.2936 - val_accuracy300: 0.3729 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 63s - loss: 3.2186 - accuracy300: 0.4070 - val_loss: 3.2926 - val_accuracy300: 0.3745 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.2164 - accuracy300: 0.4084 - val_loss: 3.2966 - val_accuracy300: 0.3732 - 62s/epoch - 27ms/step
Epoch 12/50
2262/2262 - 62s - loss: 3.2137 - accuracy300: 0.4103 - val_loss: 3.3011 - val_accuracy300: 0.3728 - 62s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 63s - loss: 3.2120 - accuracy300: 0.4118 - val_loss: 3.3009 - val_accuracy300: 0.3728 - 63s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 63s - loss: 3.2104 - accuracy300: 0.4126 - val_loss: 3.3052 - val_accuracy300: 0.3751 - 63s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h300
Evaluating performance on  test set...
6677/6677 - 88s - 88s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0736746
{'0': {'precision': 0.3925341711340793, 'recall': 0.3565068935604732, 'f1-score': 0.373654114743126, 'support': 541810}, '1': {'precision': 0.4120508820766506, 'recall': 0.4209567860020045, 'f1-score': 0.4164562263594903, 'support': 681469}, '2': {'precision': 0.3511375218089793, 'recall': 0.3764243768544162, 'f1-score': 0.3633415193400616, 'support': 486002}, 'accuracy': 0.38786542411692404, 'macro avg': {'precision': 0.385240858339903, 'recall': 0.3846293521389646, 'f1-score': 0.3844839534808926, 'support': 1709281}, 'weighted avg': {'precision': 0.38854487921778574, 'recall': 0.38786542411692404, 'f1-score': 0.38778658928067256, 'support': 1709281}}
[[193159 215025 133626]
 [190168 286869 204432]
 [108755 194304 182943]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989963
{'0': {'precision': 0.40727626544542067, 'recall': 0.2814666134112615, 'f1-score': 0.3328808897392968, 'support': 197789}, '1': {'precision': 0.33519163269426255, 'recall': 0.5056556794562853, 'f1-score': 0.40314466212560757, 'support': 187157}, '2': {'precision': 0.3952241196973774, 'recall': 0.3257498001392578, 'f1-score': 0.3571396258849608, 'support': 193885}, 'accuracy': 0.3687881264134091, 'macro avg': {'precision': 0.37923067261235355, 'recall': 0.3709573643356015, 'f1-score': 0.3643883925832884, 'support': 578831}, 'weighted avg': {'precision': 0.3799317142894393, 'recall': 0.3687881264134091, 'f1-score': 0.3637254055066051, 'support': 578831}}
[[55671 94719 47399]
 [43274 94637 49246]
 [37746 92981 63158]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096589
{'0': {'precision': 0.3864136205065979, 'recall': 0.2978459110305723, 'f1-score': 0.3363978476875846, 'support': 68428}, '1': {'precision': 0.35450366577446757, 'recall': 0.5024466008741787, 'f1-score': 0.4157047819412065, 'support': 72754}, '2': {'precision': 0.39596797357460867, 'recall': 0.31338978716149013, 'f1-score': 0.3498723093761401, 'support': 70382}, 'accuracy': 0.3733763778336579, 'macro avg': {'precision': 0.37896175328522475, 'recall': 0.3712274330220804, 'f1-score': 0.36732497966831046, 'support': 211564}, 'weighted avg': {'precision': 0.37861871036617384, 'recall': 0.3733763778336579, 'f1-score': 0.3681530435491297, 'support': 211564}}
[[20381 32753 15294]
 [17846 36555 18353]
 [14517 33808 22057]]
training model: results/AAL/W0/deepOF_L2/h500
Epoch 1/50
2262/2262 - 66s - loss: 3.1886 - accuracy500: 0.4227 - val_loss: 3.3341 - val_accuracy500: 0.4310 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 3.1772 - accuracy500: 0.4284 - val_loss: 3.3328 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 3.1685 - accuracy500: 0.4300 - val_loss: 3.3398 - val_accuracy500: 0.4313 - 62s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.1625 - accuracy500: 0.4315 - val_loss: 3.3319 - val_accuracy500: 0.4312 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.1600 - accuracy500: 0.4325 - val_loss: 3.3357 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 3.1585 - accuracy500: 0.4327 - val_loss: 3.3535 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 3.1561 - accuracy500: 0.4337 - val_loss: 3.3489 - val_accuracy500: 0.4313 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 62s - loss: 3.1557 - accuracy500: 0.4342 - val_loss: 3.3458 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 3.1527 - accuracy500: 0.4348 - val_loss: 3.3171 - val_accuracy500: 0.4313 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 3.1514 - accuracy500: 0.4361 - val_loss: 3.3600 - val_accuracy500: 0.4313 - 62s/epoch - 27ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.1507 - accuracy500: 0.4359 - val_loss: 3.3642 - val_accuracy500: 0.4313 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 3.1500 - accuracy500: 0.4372 - val_loss: 3.3765 - val_accuracy500: 0.4313 - 63s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 62s - loss: 3.1493 - accuracy500: 0.4369 - val_loss: 3.3951 - val_accuracy500: 0.4313 - 62s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 63s - loss: 3.1478 - accuracy500: 0.4379 - val_loss: 3.3854 - val_accuracy500: 0.4314 - 63s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 64s - loss: 3.1485 - accuracy500: 0.4376 - val_loss: 3.4001 - val_accuracy500: 0.4314 - 64s/epoch - 28ms/step
Epoch 16/50
2262/2262 - 63s - loss: 3.1473 - accuracy500: 0.4380 - val_loss: 3.4045 - val_accuracy500: 0.4313 - 63s/epoch - 28ms/step
Epoch 17/50
2262/2262 - 62s - loss: 3.1445 - accuracy500: 0.4391 - val_loss: 3.3980 - val_accuracy500: 0.4313 - 62s/epoch - 28ms/step
Epoch 18/50
2262/2262 - 62s - loss: 3.1428 - accuracy500: 0.4393 - val_loss: 3.3580 - val_accuracy500: 0.4313 - 62s/epoch - 27ms/step
Epoch 19/50
2262/2262 - 62s - loss: 3.1430 - accuracy500: 0.4402 - val_loss: 3.4018 - val_accuracy500: 0.4313 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h500
Evaluating performance on  test set...
6677/6677 - 83s - 83s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.064353
{'0': {'precision': 0.4326750448833034, 'recall': 0.0005092187612249986, 'f1-score': 0.0010172403240817929, 'support': 473274}, '1': {'precision': 0.4687553963109282, 'recall': 0.9996030522535523, 'f1-score': 0.6382219891482457, 'support': 801113}, '2': {'precision': 0.31496062992125984, 'recall': 0.00027592930691156925, 'f1-score': 0.0005513755671701797, 'support': 434894}, 'accuracy': 0.4687093579113089, 'macro avg': {'precision': 0.4054636903718305, 'recall': 0.33346273344056293, 'f1-score': 0.2132635350131659, 'support': 1709281}, 'weighted avg': {'precision': 0.4196351443594784, 'recall': 0.4687093579113089, 'f1-score': 0.29954650857030934, 'support': 1709281}}
[[   241 472902    131]
 [   188 800795    130]
 [   128 434646    120]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1780201
{'0': {'precision': 0.39603960396039606, 'recall': 0.00041461948296950474, 'f1-score': 0.0008283717318146519, 'support': 192948}, '1': {'precision': 0.3398522186223899, 'recall': 0.999628783987877, 'f1-score': 0.5072502848118824, 'support': 196651}, '2': {'precision': 0.43478260869565216, 'recall': 0.00047560666272089287, 'f1-score': 0.0009501739346174758, 'support': 189232}, 'accuracy': 0.33990577560635143, 'macro avg': {'precision': 0.39022481042614604, 'recall': 0.3335063367111892, 'f1-score': 0.16967627682610484, 'support': 578831}, 'weighted avg': {'precision': 0.38961650422654925, 'recall': 0.33990577560635143, 'f1-score': 0.17291905882968808, 'support': 578831}}
[[    80 192782     86]
 [    42 196578     31]
 [    80 189062     90]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1018658
{'0': {'precision': 0.42857142857142855, 'recall': 0.0003588455426257241, 'f1-score': 0.0007170906607478231, 'support': 58521}, '1': {'precision': 0.43130579512785594, 'recall': 0.999715043510664, 'f1-score': 0.6026227991940012, 'support': 91242}, '2': {'precision': 0.37037037037037035, 'recall': 0.000161809679455025, 'f1-score': 0.00032347803584136637, 'support': 61801}, 'accuracy': 0.4312973851884063, 'macro avg': {'precision': 0.41008253135655154, 'recall': 0.3334118995775816, 'f1-score': 0.20122112263019679, 'support': 211564}, 'weighted avg': {'precision': 0.41274929189154896, 'recall': 0.4312973851884063, 'f1-score': 0.2601882436175801, 'support': 211564}}
[[   21 58493     7]
 [   16 91216    10]
 [   12 61779    10]]
training model: results/AAL/W0/deepOF_L2/h1000
Epoch 1/50
2262/2262 - 65s - loss: 3.2480 - accuracy1000: 0.3972 - val_loss: 3.3319 - val_accuracy1000: 0.3621 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 3.2235 - accuracy1000: 0.4063 - val_loss: 3.3263 - val_accuracy1000: 0.3615 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 3.2150 - accuracy1000: 0.4094 - val_loss: 3.3235 - val_accuracy1000: 0.3619 - 62s/epoch - 27ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.2101 - accuracy1000: 0.4121 - val_loss: 3.3325 - val_accuracy1000: 0.3610 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 63s - loss: 3.2084 - accuracy1000: 0.4127 - val_loss: 3.3328 - val_accuracy1000: 0.3614 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 3.2064 - accuracy1000: 0.4134 - val_loss: 3.3370 - val_accuracy1000: 0.3615 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.2056 - accuracy1000: 0.4140 - val_loss: 3.3471 - val_accuracy1000: 0.3605 - 62s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 62s - loss: 3.2048 - accuracy1000: 0.4145 - val_loss: 3.3423 - val_accuracy1000: 0.3617 - 62s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.2043 - accuracy1000: 0.4141 - val_loss: 3.3559 - val_accuracy1000: 0.3611 - 62s/epoch - 27ms/step
Epoch 10/50
2262/2262 - 62s - loss: 3.2036 - accuracy1000: 0.4144 - val_loss: 3.3562 - val_accuracy1000: 0.3611 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.2024 - accuracy1000: 0.4151 - val_loss: 3.3589 - val_accuracy1000: 0.3612 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 3.2016 - accuracy1000: 0.4156 - val_loss: 3.3633 - val_accuracy1000: 0.3607 - 62s/epoch - 27ms/step
Epoch 13/50
2262/2262 - 62s - loss: 3.2011 - accuracy1000: 0.4159 - val_loss: 3.3520 - val_accuracy1000: 0.3621 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepOF_L2/h1000
Evaluating performance on  test set...
6677/6677 - 80s - 80s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0508807
{'0': {'precision': 0.3354237435763435, 'recall': 0.016812005457025922, 'f1-score': 0.032019156618241604, 'support': 458125}, '1': {'precision': 0.4946503207062162, 'recall': 0.9851267665901986, 'f1-score': 0.6586036170088496, 'support': 841310}, '2': {'precision': 0.3763659937025375, 'recall': 0.009915919638107971, 'f1-score': 0.019322752731525946, 'support': 409846}, 'accuracy': 0.4917640809205742, 'macro avg': {'precision': 0.4021466859950324, 'recall': 0.3372848972284442, 'f1-score': 0.23664850878620572, 'support': 1709281}, 'weighted avg': {'precision': 0.42361224450179297, 'recall': 0.4917640809205742, 'f1-score': 0.3373804178876686, 'support': 1709281}}
[[  7702 447185   3238]
 [  9017 828797   3496]
 [  6243 399539   4064]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1102815
{'0': {'precision': 0.3977980497011639, 'recall': 0.03270489047508211, 'f1-score': 0.06044066338479185, 'support': 193335}, '1': {'precision': 0.34155558436133976, 'recall': 0.972264217663368, 'f1-score': 0.5055217960725901, 'support': 195127}, '2': {'precision': 0.4191137213027229, 'recall': 0.01649428215728401, 'f1-score': 0.031739453454697995, 'support': 190369}, 'accuracy': 0.34410389215505044, 'macro avg': {'precision': 0.38615578512174215, 'recall': 0.3404877967652447, 'f1-score': 0.19923397097069329, 'support': 578831}, 'weighted avg': {'precision': 0.3858488271349111, 'recall': 0.34410389215505044, 'f1-score': 0.20104046806835227, 'support': 578831}}
[[  6323 184339   2673]
 [  3733 189715   1679]
 [  5839 181390   3140]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1060376
{'0': {'precision': 0.36123445825932504, 'recall': 0.024760310455029674, 'f1-score': 0.04634403395334264, 'support': 65710}, '1': {'precision': 0.36168432929824473, 'recall': 0.9802156376865081, 'f1-score': 0.5283980091018576, 'support': 75868}, '2': {'precision': 0.4187975120939876, 'recall': 0.00865887463206927, 'f1-score': 0.016966948049220946, 'support': 69986}, 'accuracy': 0.36206537974324554, 'macro avg': {'precision': 0.38057209988385243, 'recall': 0.337878274257869, 'f1-score': 0.1972363303681404, 'support': 211564}, 'weighted avg': {'precision': 0.3804378137529509, 'recall': 0.36206537974324554, 'f1-score': 0.20949318150435164, 'support': 211564}}
[[ 1627 63613   470]
 [ 1130 74367   371]
 [ 1747 67633   606]]
training model: results/AAL/W0/deepVOL_L2/h10
Epoch 1/50
2262/2262 - 66s - loss: 2.8907 - accuracy10: 0.5031 - val_loss: 2.6668 - val_accuracy10: 0.5590 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.7344 - accuracy10: 0.5532 - val_loss: 2.6100 - val_accuracy10: 0.6419 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 2.6427 - accuracy10: 0.5806 - val_loss: 2.5722 - val_accuracy10: 0.6580 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 63s - loss: 2.5969 - accuracy10: 0.5943 - val_loss: 2.5703 - val_accuracy10: 0.6621 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 63s - loss: 2.5757 - accuracy10: 0.6004 - val_loss: 2.5930 - val_accuracy10: 0.6571 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.5572 - accuracy10: 0.6047 - val_loss: 2.5746 - val_accuracy10: 0.6626 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 2.5421 - accuracy10: 0.6076 - val_loss: 2.5535 - val_accuracy10: 0.6627 - 62s/epoch - 27ms/step
Epoch 8/50
2262/2262 - 62s - loss: 2.5277 - accuracy10: 0.6092 - val_loss: 2.5755 - val_accuracy10: 0.6690 - 62s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 2.5140 - accuracy10: 0.6122 - val_loss: 2.5638 - val_accuracy10: 0.6675 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 64s - loss: 2.5027 - accuracy10: 0.6134 - val_loss: 2.5670 - val_accuracy10: 0.6697 - 64s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 64s - loss: 2.4909 - accuracy10: 0.6160 - val_loss: 2.5635 - val_accuracy10: 0.6731 - 64s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.4808 - accuracy10: 0.6170 - val_loss: 2.5654 - val_accuracy10: 0.6754 - 62s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 63s - loss: 2.4710 - accuracy10: 0.6189 - val_loss: 2.5616 - val_accuracy10: 0.6704 - 63s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 64s - loss: 2.4615 - accuracy10: 0.6198 - val_loss: 2.5613 - val_accuracy10: 0.6732 - 64s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 63s - loss: 2.4539 - accuracy10: 0.6206 - val_loss: 2.5479 - val_accuracy10: 0.6732 - 63s/epoch - 28ms/step
Epoch 16/50
2262/2262 - 62s - loss: 2.4442 - accuracy10: 0.6219 - val_loss: 2.5708 - val_accuracy10: 0.6804 - 62s/epoch - 28ms/step
Epoch 17/50
2262/2262 - 63s - loss: 2.4375 - accuracy10: 0.6225 - val_loss: 2.5547 - val_accuracy10: 0.6790 - 63s/epoch - 28ms/step
Epoch 18/50
2262/2262 - 62s - loss: 2.4320 - accuracy10: 0.6231 - val_loss: 2.5443 - val_accuracy10: 0.6792 - 62s/epoch - 28ms/step
Epoch 19/50
2262/2262 - 63s - loss: 2.4235 - accuracy10: 0.6236 - val_loss: 2.5560 - val_accuracy10: 0.6791 - 63s/epoch - 28ms/step
Epoch 20/50
2262/2262 - 62s - loss: 2.4171 - accuracy10: 0.6243 - val_loss: 2.5370 - val_accuracy10: 0.6791 - 62s/epoch - 27ms/step
Epoch 21/50
2262/2262 - 62s - loss: 2.4131 - accuracy10: 0.6251 - val_loss: 2.5480 - val_accuracy10: 0.6789 - 62s/epoch - 27ms/step
Epoch 22/50
2262/2262 - 62s - loss: 2.4077 - accuracy10: 0.6259 - val_loss: 2.5373 - val_accuracy10: 0.6828 - 62s/epoch - 28ms/step
Epoch 23/50
2262/2262 - 62s - loss: 2.4014 - accuracy10: 0.6265 - val_loss: 2.5469 - val_accuracy10: 0.6827 - 62s/epoch - 27ms/step
Epoch 24/50
2262/2262 - 63s - loss: 2.3981 - accuracy10: 0.6266 - val_loss: 2.5273 - val_accuracy10: 0.6804 - 63s/epoch - 28ms/step
Epoch 25/50
2262/2262 - 63s - loss: 2.3937 - accuracy10: 0.6272 - val_loss: 2.5475 - val_accuracy10: 0.6835 - 63s/epoch - 28ms/step
Epoch 26/50
2262/2262 - 63s - loss: 2.3893 - accuracy10: 0.6279 - val_loss: 2.5289 - val_accuracy10: 0.6796 - 63s/epoch - 28ms/step
Epoch 27/50
2262/2262 - 63s - loss: 2.3850 - accuracy10: 0.6287 - val_loss: 2.5361 - val_accuracy10: 0.6730 - 63s/epoch - 28ms/step
Epoch 28/50
2262/2262 - 62s - loss: 2.3838 - accuracy10: 0.6282 - val_loss: 2.5195 - val_accuracy10: 0.6822 - 62s/epoch - 28ms/step
Epoch 29/50
2262/2262 - 62s - loss: 2.3773 - accuracy10: 0.6293 - val_loss: 2.5302 - val_accuracy10: 0.6797 - 62s/epoch - 28ms/step
Epoch 30/50
2262/2262 - 63s - loss: 2.3728 - accuracy10: 0.6296 - val_loss: 2.5258 - val_accuracy10: 0.6793 - 63s/epoch - 28ms/step
Epoch 31/50
2262/2262 - 62s - loss: 2.3708 - accuracy10: 0.6292 - val_loss: 2.5114 - val_accuracy10: 0.6826 - 62s/epoch - 28ms/step
Epoch 32/50
2262/2262 - 62s - loss: 2.3661 - accuracy10: 0.6302 - val_loss: 2.5344 - val_accuracy10: 0.6798 - 62s/epoch - 27ms/step
Epoch 33/50
2262/2262 - 63s - loss: 2.3625 - accuracy10: 0.6309 - val_loss: 2.5334 - val_accuracy10: 0.6817 - 63s/epoch - 28ms/step
Epoch 34/50
2262/2262 - 62s - loss: 2.3597 - accuracy10: 0.6315 - val_loss: 2.5228 - val_accuracy10: 0.6825 - 62s/epoch - 28ms/step
Epoch 35/50
2262/2262 - 62s - loss: 2.3564 - accuracy10: 0.6312 - val_loss: 2.5336 - val_accuracy10: 0.6835 - 62s/epoch - 28ms/step
Epoch 36/50
2262/2262 - 62s - loss: 2.3527 - accuracy10: 0.6317 - val_loss: 2.5185 - val_accuracy10: 0.6782 - 62s/epoch - 27ms/step
Epoch 37/50
2262/2262 - 62s - loss: 2.3498 - accuracy10: 0.6320 - val_loss: 2.5424 - val_accuracy10: 0.6802 - 62s/epoch - 27ms/step
Epoch 38/50
2262/2262 - 62s - loss: 2.3470 - accuracy10: 0.6322 - val_loss: 2.5342 - val_accuracy10: 0.6819 - 62s/epoch - 28ms/step
Epoch 39/50
2262/2262 - 63s - loss: 2.3436 - accuracy10: 0.6334 - val_loss: 2.5408 - val_accuracy10: 0.6831 - 63s/epoch - 28ms/step
Epoch 40/50
2262/2262 - 63s - loss: 2.3413 - accuracy10: 0.6324 - val_loss: 2.5384 - val_accuracy10: 0.6813 - 63s/epoch - 28ms/step
Epoch 41/50
2262/2262 - 62s - loss: 2.3388 - accuracy10: 0.6328 - val_loss: 2.5331 - val_accuracy10: 0.6762 - 62s/epoch - 27ms/step
testing model: results/AAL/W0/deepVOL_L2/h10
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5450535
{'0': {'precision': 0.42922559935800986, 'recall': 0.48037069468768245, 'f1-score': 0.4533602449593677, 'support': 178152}, '1': {'precision': 0.8946542239009676, 'recall': 0.869761522828603, 'f1-score': 0.8820322779678877, 'support': 1345286}, '2': {'precision': 0.45583540789206684, 'recall': 0.4955770306917481, 'f1-score': 0.47487619199843256, 'support': 185848}, 'accuracy': 0.7884923880497471, 'macro avg': {'precision': 0.5932384103836814, 'recall': 0.6152364160693445, 'f1-score': 0.6034229049752293, 'support': 1709286}, 'weighted avg': {'precision': 0.7984323864570294, 'recall': 0.7884923880497471, 'f1-score': 0.7930840713542578, 'support': 1709286}}
[[  85579   72873   19700]
 [  84959 1170078   90249]
 [  28842   64904   92102]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7898958
{'0': {'precision': 0.4550528562977443, 'recall': 0.5108078455527111, 'f1-score': 0.4813211029141709, 'support': 103906}, '1': {'precision': 0.8089626294119882, 'recall': 0.7514480991493265, 'f1-score': 0.7791454122017633, 'support': 368414}, '2': {'precision': 0.4556282558866431, 'recall': 0.5132143494221363, 'f1-score': 0.4827099007452934, 'support': 106513}, 'accuracy': 0.6644127062555175, 'macro avg': {'precision': 0.5732145805321253, 'recall': 0.5918234313747246, 'f1-score': 0.5810588052870759, 'support': 578833}, 'weighted avg': {'precision': 0.6804142346029264, 'recall': 0.6644127062555175, 'f1-score': 0.6711350390671985, 'support': 578833}}
[[ 53076  33541  17289]
 [ 43548 276844  48022]
 [ 20013  31836  54664]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.75284886
{'0': {'precision': 0.4381554975626569, 'recall': 0.521952077895416, 'f1-score': 0.47639697517232144, 'support': 34097}, '1': {'precision': 0.8288942572319736, 'recall': 0.7634343491240917, 'f1-score': 0.7948187895847995, 'support': 142024}, '2': {'precision': 0.45415815436743234, 'recall': 0.5143187653415343, 'f1-score': 0.4823699077810561, 'support': 35443}, 'accuracy': 0.6827815696432286, 'macro avg': {'precision': 0.5737359697206875, 'recall': 0.599901730787014, 'f1-score': 0.5845285575127257, 'support': 211564}, 'weighted avg': {'precision': 0.7031413352685365, 'recall': 0.6827815696432286, 'f1-score': 0.6911558113664241, 'support': 211564}}
[[ 17797  11450   4850]
 [ 16539 108426  17059]
 [  6282  10932  18229]]
training model: results/AAL/W0/deepVOL_L2/h20
Epoch 1/50
2262/2262 - 66s - loss: 2.9288 - accuracy20: 0.5121 - val_loss: 2.7604 - val_accuracy20: 0.5683 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 63s - loss: 2.7804 - accuracy20: 0.5605 - val_loss: 2.7679 - val_accuracy20: 0.6271 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 2.7157 - accuracy20: 0.5751 - val_loss: 2.7708 - val_accuracy20: 0.6365 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.6708 - accuracy20: 0.5860 - val_loss: 2.7832 - val_accuracy20: 0.6327 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 63s - loss: 2.6461 - accuracy20: 0.5923 - val_loss: 2.7309 - val_accuracy20: 0.6371 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.6281 - accuracy20: 0.5955 - val_loss: 2.7120 - val_accuracy20: 0.6384 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 2.6135 - accuracy20: 0.5984 - val_loss: 2.7141 - val_accuracy20: 0.6395 - 62s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 2.6014 - accuracy20: 0.6004 - val_loss: 2.7076 - val_accuracy20: 0.6401 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 62s - loss: 2.5898 - accuracy20: 0.6020 - val_loss: 2.7038 - val_accuracy20: 0.6449 - 62s/epoch - 27ms/step
Epoch 10/50
2262/2262 - 62s - loss: 2.5797 - accuracy20: 0.6039 - val_loss: 2.7336 - val_accuracy20: 0.6405 - 62s/epoch - 27ms/step
Epoch 11/50
2262/2262 - 62s - loss: 2.5707 - accuracy20: 0.6056 - val_loss: 2.7207 - val_accuracy20: 0.6470 - 62s/epoch - 27ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.5609 - accuracy20: 0.6073 - val_loss: 2.7246 - val_accuracy20: 0.6489 - 62s/epoch - 27ms/step
Epoch 13/50
2262/2262 - 62s - loss: 2.5536 - accuracy20: 0.6086 - val_loss: 2.7152 - val_accuracy20: 0.6480 - 62s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 62s - loss: 2.5462 - accuracy20: 0.6097 - val_loss: 2.7276 - val_accuracy20: 0.6495 - 62s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 62s - loss: 2.5401 - accuracy20: 0.6103 - val_loss: 2.7182 - val_accuracy20: 0.6465 - 62s/epoch - 28ms/step
Epoch 16/50
2262/2262 - 62s - loss: 2.5332 - accuracy20: 0.6119 - val_loss: 2.7256 - val_accuracy20: 0.6488 - 62s/epoch - 28ms/step
Epoch 17/50
2262/2262 - 62s - loss: 2.5268 - accuracy20: 0.6120 - val_loss: 2.7210 - val_accuracy20: 0.6491 - 62s/epoch - 27ms/step
Epoch 18/50
2262/2262 - 62s - loss: 2.5212 - accuracy20: 0.6127 - val_loss: 2.7022 - val_accuracy20: 0.6479 - 62s/epoch - 27ms/step
Epoch 19/50
2262/2262 - 62s - loss: 2.5150 - accuracy20: 0.6137 - val_loss: 2.7074 - val_accuracy20: 0.6476 - 62s/epoch - 27ms/step
Epoch 20/50
2262/2262 - 62s - loss: 2.5110 - accuracy20: 0.6141 - val_loss: 2.7365 - val_accuracy20: 0.6454 - 62s/epoch - 27ms/step
Epoch 21/50
2262/2262 - 62s - loss: 2.5054 - accuracy20: 0.6144 - val_loss: 2.7222 - val_accuracy20: 0.6489 - 62s/epoch - 27ms/step
Epoch 22/50
2262/2262 - 63s - loss: 2.5001 - accuracy20: 0.6151 - val_loss: 2.7063 - val_accuracy20: 0.6481 - 63s/epoch - 28ms/step
Epoch 23/50
2262/2262 - 62s - loss: 2.4960 - accuracy20: 0.6159 - val_loss: 2.6974 - val_accuracy20: 0.6469 - 62s/epoch - 27ms/step
Epoch 24/50
2262/2262 - 62s - loss: 2.4914 - accuracy20: 0.6165 - val_loss: 2.6972 - val_accuracy20: 0.6472 - 62s/epoch - 27ms/step
Epoch 25/50
2262/2262 - 63s - loss: 2.4878 - accuracy20: 0.6171 - val_loss: 2.6979 - val_accuracy20: 0.6469 - 63s/epoch - 28ms/step
Epoch 26/50
2262/2262 - 62s - loss: 2.4836 - accuracy20: 0.6174 - val_loss: 2.6895 - val_accuracy20: 0.6482 - 62s/epoch - 28ms/step
Epoch 27/50
2262/2262 - 62s - loss: 2.4806 - accuracy20: 0.6182 - val_loss: 2.6908 - val_accuracy20: 0.6478 - 62s/epoch - 27ms/step
Epoch 28/50
2262/2262 - 62s - loss: 2.4768 - accuracy20: 0.6182 - val_loss: 2.7038 - val_accuracy20: 0.6480 - 62s/epoch - 27ms/step
Epoch 29/50
2262/2262 - 63s - loss: 2.4726 - accuracy20: 0.6193 - val_loss: 2.6874 - val_accuracy20: 0.6493 - 63s/epoch - 28ms/step
Epoch 30/50
2262/2262 - 62s - loss: 2.4702 - accuracy20: 0.6193 - val_loss: 2.6736 - val_accuracy20: 0.6493 - 62s/epoch - 28ms/step
Epoch 31/50
2262/2262 - 62s - loss: 2.4664 - accuracy20: 0.6200 - val_loss: 2.6731 - val_accuracy20: 0.6474 - 62s/epoch - 28ms/step
Epoch 32/50
2262/2262 - 62s - loss: 2.4640 - accuracy20: 0.6198 - val_loss: 2.6903 - val_accuracy20: 0.6486 - 62s/epoch - 28ms/step
Epoch 33/50
2262/2262 - 65s - loss: 2.4611 - accuracy20: 0.6207 - val_loss: 2.7027 - val_accuracy20: 0.6475 - 65s/epoch - 29ms/step
Epoch 34/50
2262/2262 - 63s - loss: 2.4580 - accuracy20: 0.6210 - val_loss: 2.6659 - val_accuracy20: 0.6475 - 63s/epoch - 28ms/step
Epoch 35/50
2262/2262 - 62s - loss: 2.4548 - accuracy20: 0.6219 - val_loss: 2.6827 - val_accuracy20: 0.6468 - 62s/epoch - 27ms/step
Epoch 36/50
2262/2262 - 62s - loss: 2.4520 - accuracy20: 0.6225 - val_loss: 2.6667 - val_accuracy20: 0.6459 - 62s/epoch - 28ms/step
Epoch 37/50
2262/2262 - 63s - loss: 2.4480 - accuracy20: 0.6223 - val_loss: 2.6682 - val_accuracy20: 0.6479 - 63s/epoch - 28ms/step
Epoch 38/50
2262/2262 - 62s - loss: 2.4452 - accuracy20: 0.6228 - val_loss: 2.6732 - val_accuracy20: 0.6474 - 62s/epoch - 27ms/step
Epoch 39/50
2262/2262 - 62s - loss: 2.4430 - accuracy20: 0.6234 - val_loss: 2.6759 - val_accuracy20: 0.6487 - 62s/epoch - 27ms/step
Epoch 40/50
2262/2262 - 62s - loss: 2.4401 - accuracy20: 0.6235 - val_loss: 2.6821 - val_accuracy20: 0.6496 - 62s/epoch - 27ms/step
Epoch 41/50
2262/2262 - 62s - loss: 2.4366 - accuracy20: 0.6235 - val_loss: 2.6703 - val_accuracy20: 0.6484 - 62s/epoch - 27ms/step
Epoch 42/50
2262/2262 - 62s - loss: 2.4336 - accuracy20: 0.6243 - val_loss: 2.6930 - val_accuracy20: 0.6472 - 62s/epoch - 27ms/step
Epoch 43/50
2262/2262 - 63s - loss: 2.4316 - accuracy20: 0.6242 - val_loss: 2.6977 - val_accuracy20: 0.6467 - 63s/epoch - 28ms/step
Epoch 44/50
2262/2262 - 62s - loss: 2.4290 - accuracy20: 0.6241 - val_loss: 2.7007 - val_accuracy20: 0.6486 - 62s/epoch - 27ms/step
testing model: results/AAL/W0/deepVOL_L2/h20
Evaluating performance on  test set...
6677/6677 - 85s - 85s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.61532885
{'0': {'precision': 0.5075003767312514, 'recall': 0.4524661577608142, 'f1-score': 0.478405730348203, 'support': 245625}, '1': {'precision': 0.8287510319594843, 'recall': 0.8794948360228103, 'f1-score': 0.8533692562861168, 'support': 1213309}, '2': {'precision': 0.5355060237397508, 'recall': 0.43357352847191155, 'f1-score': 0.47917889857631607, 'support': 250352}, 'accuracy': 0.7528184282794103, 'macro avg': {'precision': 0.6239191441434956, 'recall': 0.588511507418512, 'f1-score': 0.603651295070212, 'support': 1709286}, 'weighted avg': {'precision': 0.7396368249231772, 'recall': 0.7528184282794103, 'f1-score': 0.7446807626742438, 'support': 1709286}}
[[ 111137  113251   21237]
 [  73295 1067099   72915]
 [  34557  107249  108546]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8416062
{'0': {'precision': 0.523031917927657, 'recall': 0.4731809804644305, 'f1-score': 0.4968591676310422, 'support': 135650}, '1': {'precision': 0.7020585048754063, 'recall': 0.7850302048033004, 'f1-score': 0.7412296634076593, 'support': 305415}, '2': {'precision': 0.5338912060871538, 'recall': 0.4441161953428953, 'f1-score': 0.4848833062566867, 'support': 137768}, 'accuracy': 0.63080715854141, 'macro avg': {'precision': 0.5863272096300723, 'recall': 0.567442460203542, 'f1-score': 0.5743240457651294, 'support': 578833}, 'weighted avg': {'precision': 0.6200779872841111, 'recall': 0.63080715854141, 'f1-score': 0.6229482546350543, 'support': 578833}}
[[ 64187  50846  20617]
 [ 32855 239760  32800]
 [ 25679  50904  61185]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.81586874
{'0': {'precision': 0.5129804883748101, 'recall': 0.4801093493712411, 'f1-score': 0.4960009037505648, 'support': 45725}, '1': {'precision': 0.7226363608646605, 'recall': 0.7953273772073319, 'f1-score': 0.7572413848187508, 'support': 119205}, '2': {'precision': 0.5380991669549943, 'recall': 0.43354633958056354, 'f1-score': 0.48019760827484653, 'support': 46634}, 'accuracy': 0.6474541982567923, 'macro avg': {'precision': 0.5912386720648216, 'recall': 0.5696610220530456, 'f1-score': 0.5778132989480541, 'support': 211564}, 'weighted avg': {'precision': 0.6366471459208054, 'recall': 0.6474541982567923, 'f1-score': 0.6397125024371014, 'support': 211564}}
[[21953 18189  5583]
 [12626 94807 11772]
 [ 8216 18200 20218]]
training model: results/AAL/W0/deepVOL_L2/h30
Epoch 1/50
2262/2262 - 65s - loss: 3.0068 - accuracy30: 0.4915 - val_loss: 2.8866 - val_accuracy30: 0.5556 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.8696 - accuracy30: 0.5369 - val_loss: 2.8937 - val_accuracy30: 0.5762 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 2.7947 - accuracy30: 0.5556 - val_loss: 2.9257 - val_accuracy30: 0.5828 - 62s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.7455 - accuracy30: 0.5676 - val_loss: 2.8882 - val_accuracy30: 0.5960 - 62s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 63s - loss: 2.7195 - accuracy30: 0.5728 - val_loss: 2.8820 - val_accuracy30: 0.5964 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 63s - loss: 2.7061 - accuracy30: 0.5751 - val_loss: 2.9276 - val_accuracy30: 0.5977 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 2.6941 - accuracy30: 0.5775 - val_loss: 2.9182 - val_accuracy30: 0.5985 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 2.6832 - accuracy30: 0.5796 - val_loss: 2.8975 - val_accuracy30: 0.5988 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 2.6741 - accuracy30: 0.5813 - val_loss: 2.8867 - val_accuracy30: 0.5987 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 63s - loss: 2.6643 - accuracy30: 0.5823 - val_loss: 2.9300 - val_accuracy30: 0.6006 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 63s - loss: 2.6550 - accuracy30: 0.5840 - val_loss: 2.8885 - val_accuracy30: 0.6012 - 63s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.6477 - accuracy30: 0.5846 - val_loss: 2.8974 - val_accuracy30: 0.6011 - 62s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 62s - loss: 2.6403 - accuracy30: 0.5864 - val_loss: 2.8830 - val_accuracy30: 0.6030 - 62s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 63s - loss: 2.6347 - accuracy30: 0.5875 - val_loss: 2.8899 - val_accuracy30: 0.6028 - 63s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 62s - loss: 2.6289 - accuracy30: 0.5887 - val_loss: 2.8887 - val_accuracy30: 0.6030 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h30
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70732605
{'0': {'precision': 0.5877751718153638, 'recall': 0.31451200473729546, 'f1-score': 0.4097638810046181, 'support': 297216}, '1': {'precision': 0.757568463222767, 'recall': 0.9086671149966375, 'f1-score': 0.8262667763038543, 'support': 1115250}, '2': {'precision': 0.5399181407602559, 'recall': 0.3866484738225187, 'f1-score': 0.4506066198123208, 'support': 296820}, 'accuracy': 0.7147042683319234, 'macro avg': {'precision': 0.6284205919327955, 'recall': 0.5366091978521506, 'f1-score': 0.5622124257069311, 'support': 1709286}, 'weighted avg': {'precision': 0.6902489791737165, 'recall': 0.7147042683319234, 'f1-score': 0.6886100165930307, 'support': 1709286}}
[[  93478  169667   34071]
 [  38135 1013391   63724]
 [  27424  154631  114765]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9464212
{'0': {'precision': 0.5471513769871156, 'recall': 0.34352935162525, 'f1-score': 0.4220649481662918, 'support': 156499}, '1': {'precision': 0.6041053362485008, 'recall': 0.796408023694334, 'f1-score': 0.6870542626805181, 'support': 264367}, '2': {'precision': 0.5045095529825145, 'recall': 0.4217463141035786, 'f1-score': 0.45943038411144055, 'support': 157967}, 'accuracy': 0.5717158489581624, 'macro avg': {'precision': 0.551922088739377, 'recall': 0.5205612298077209, 'f1-score': 0.5228498649860835, 'support': 578833}, 'weighted avg': {'precision': 0.5615264149264172, 'recall': 0.5717158489581624, 'f1-score': 0.553289214803007, 'support': 578833}}
[[ 53762  69090  33647]
 [ 22039 210544  31784]
 [ 22457  68888  66622]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90692383
{'0': {'precision': 0.5498419038109502, 'recall': 0.3702029916525052, 'f1-score': 0.44248518464783543, 'support': 53549}, '1': {'precision': 0.6348516019725895, 'recall': 0.8067182469123937, 'f1-score': 0.7105397935299272, 'support': 104045}, '2': {'precision': 0.5194928172201949, 'recall': 0.4167685751343339, 'f1-score': 0.46249537360694165, 'support': 53970}, 'accuracy': 0.5967555916885671, 'macro avg': {'precision': 0.5680621076679115, 'recall': 0.5312299378997443, 'f1-score': 0.5385067839282348, 'support': 211564}, 'weighted avg': {'precision': 0.5839067439629831, 'recall': 0.5967555916885671, 'f1-score': 0.5794162867221969, 'support': 211564}}
[[19824 24156  9569]
 [ 8874 83935 11236]
 [ 7356 24121 22493]]
training model: results/AAL/W0/deepVOL_L2/h50
Epoch 1/50
2262/2262 - 65s - loss: 3.1278 - accuracy50: 0.4497 - val_loss: 3.1016 - val_accuracy50: 0.4901 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 2.9631 - accuracy50: 0.5007 - val_loss: 3.0102 - val_accuracy50: 0.5148 - 62s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 62s - loss: 2.8823 - accuracy50: 0.5215 - val_loss: 3.0624 - val_accuracy50: 0.5181 - 62s/epoch - 27ms/step
Epoch 4/50
2262/2262 - 62s - loss: 2.8446 - accuracy50: 0.5306 - val_loss: 3.1043 - val_accuracy50: 0.5197 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 62s - loss: 2.8280 - accuracy50: 0.5345 - val_loss: 3.1192 - val_accuracy50: 0.5182 - 62s/epoch - 27ms/step
Epoch 6/50
2262/2262 - 62s - loss: 2.8179 - accuracy50: 0.5375 - val_loss: 3.0958 - val_accuracy50: 0.5224 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 2.8084 - accuracy50: 0.5396 - val_loss: 3.0921 - val_accuracy50: 0.5234 - 62s/epoch - 27ms/step
Epoch 8/50
2262/2262 - 62s - loss: 2.8024 - accuracy50: 0.5407 - val_loss: 3.0851 - val_accuracy50: 0.5248 - 62s/epoch - 27ms/step
Epoch 9/50
2262/2262 - 65s - loss: 2.7961 - accuracy50: 0.5426 - val_loss: 3.0697 - val_accuracy50: 0.5250 - 65s/epoch - 29ms/step
Epoch 10/50
2262/2262 - 62s - loss: 2.7915 - accuracy50: 0.5437 - val_loss: 3.0655 - val_accuracy50: 0.5265 - 62s/epoch - 27ms/step
Epoch 11/50
2262/2262 - 62s - loss: 2.7869 - accuracy50: 0.5443 - val_loss: 3.0671 - val_accuracy50: 0.5259 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 2.7814 - accuracy50: 0.5454 - val_loss: 3.0674 - val_accuracy50: 0.5263 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h50
Evaluating performance on  test set...
6677/6677 - 87s - 87s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8389954
{'0': {'precision': 0.6075802438244575, 'recall': 0.23007095707833702, 'f1-score': 0.33375841411777285, 'support': 379948}, '1': {'precision': 0.647632739066121, 'recall': 0.9248610662190201, 'f1-score': 0.7618094310551837, 'support': 959090}, '2': {'precision': 0.5623486744649333, 'recall': 0.2973439424385817, 'f1-score': 0.38900176319481, 'support': 370248}, 'accuracy': 0.6344935838706922, 'macro avg': {'precision': 0.6058538857851706, 'recall': 0.48409198857864627, 'f1-score': 0.4948565361225888, 'support': 1709286}, 'weighted avg': {'precision': 0.6202563258663756, 'recall': 0.6344935838706922, 'f1-score': 0.5859064977875484, 'support': 1709286}}
[[ 87415 249356  43177]
 [ 29563 887025  42502]
 [ 26896 233261 110091]]
Evaluating performance on  train set...
2262/2262 - 27s - 27s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0161548
{'0': {'precision': 0.5392625881898134, 'recall': 0.24184337989099222, 'f1-score': 0.33392930615298294, 'support': 184574}, '1': {'precision': 0.4742809559129675, 'recall': 0.8219656604368665, 'f1-score': 0.6014945832721373, 'support': 209263}, '2': {'precision': 0.5072645215461661, 'recall': 0.36575385413738676, 'f1-score': 0.4250402030252777, 'support': 184996}, 'accuracy': 0.4911744838321243, 'macro avg': {'precision': 0.5069360218829823, 'recall': 0.4765209648217485, 'f1-score': 0.4534880308167993, 'support': 578833}, 'weighted avg': {'precision': 0.5055434228140353, 'recall': 0.4911744838321243, 'f1-score': 0.4597802235394703, 'support': 578833}}
[[ 44638  96717  43219]
 [ 14750 172007  22506]
 [ 23388  93945  67663]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99097687
{'0': {'precision': 0.5501736843813915, 'recall': 0.26426009667862155, 'f1-score': 0.3570307480012219, 'support': 64130}, '1': {'precision': 0.5042234934998079, 'recall': 0.832808402093338, 'f1-score': 0.628139931894753, 'support': 83503}, '2': {'precision': 0.524018486531908, 'recall': 0.3511598442070357, 'f1-score': 0.4205182958238506, 'support': 63931}, 'accuracy': 0.5149221984836739, 'macro avg': {'precision': 0.5261385548043691, 'recall': 0.48274278099299844, 'f1-score': 0.4685629919066085, 'support': 211564}, 'weighted avg': {'precision': 0.5241337780509184, 'recall': 0.5149221984836739, 'f1-score': 0.48322070755251606, 'support': 211564}}
[[16947 34694 12489]
 [ 6058 69542  7903]
 [ 7798 33683 22450]]
training model: results/AAL/W0/deepVOL_L2/h100
Epoch 1/50
2262/2262 - 65s - loss: 3.2031 - accuracy100: 0.4159 - val_loss: 3.1950 - val_accuracy100: 0.4331 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 62s - loss: 3.1397 - accuracy100: 0.4454 - val_loss: 3.1937 - val_accuracy100: 0.4458 - 62s/epoch - 27ms/step
Epoch 3/50
2262/2262 - 62s - loss: 3.1042 - accuracy100: 0.4562 - val_loss: 3.2289 - val_accuracy100: 0.4420 - 62s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.0892 - accuracy100: 0.4604 - val_loss: 3.2362 - val_accuracy100: 0.4417 - 62s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.0796 - accuracy100: 0.4634 - val_loss: 3.2282 - val_accuracy100: 0.4396 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 63s - loss: 3.0743 - accuracy100: 0.4651 - val_loss: 3.2392 - val_accuracy100: 0.4442 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 63s - loss: 3.0687 - accuracy100: 0.4678 - val_loss: 3.2349 - val_accuracy100: 0.4437 - 63s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 3.0648 - accuracy100: 0.4691 - val_loss: 3.2385 - val_accuracy100: 0.4431 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 63s - loss: 3.0603 - accuracy100: 0.4708 - val_loss: 3.2352 - val_accuracy100: 0.4446 - 63s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 63s - loss: 3.0576 - accuracy100: 0.4715 - val_loss: 3.2509 - val_accuracy100: 0.4424 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.0545 - accuracy100: 0.4723 - val_loss: 3.2609 - val_accuracy100: 0.4399 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 3.0519 - accuracy100: 0.4733 - val_loss: 3.2537 - val_accuracy100: 0.4415 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h100
Evaluating performance on  test set...
6677/6677 - 87s - 87s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9692645
{'0': {'precision': 0.559426499877484, 'recall': 0.19815024167920312, 'f1-score': 0.29264492973925216, 'support': 449356}, '1': {'precision': 0.5446142322435378, 'recall': 0.8748269488638423, 'f1-score': 0.6713109545402084, 'support': 827790}, '2': {'precision': 0.48376764780604653, 'recall': 0.24675799509418245, 'f1-score': 0.3268154541163779, 'support': 432140}, 'accuracy': 0.5381469221651614, 'macro avg': {'precision': 0.5292694599756894, 'recall': 0.4399117285457426, 'f1-score': 0.4302571127986128, 'support': 1709286}, 'weighted avg': {'precision': 0.5331250714688647, 'recall': 0.5381469221651614, 'f1-score': 0.48466803124146696, 'support': 1709286}}
[[ 89040 309669  50647]
 [ 40474 724173  63143]
 [ 29649 295857 106634]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0828086
{'0': {'precision': 0.47613716822626634, 'recall': 0.25557758284199933, 'f1-score': 0.33261591727880974, 'support': 194708}, '1': {'precision': 0.40094120381129444, 'recall': 0.6867134185621435, 'f1-score': 0.5062851737086482, 'support': 190937}, '2': {'precision': 0.4515890312374823, 'recall': 0.3443019235149181, 'f1-score': 0.3907142584417834, 'support': 193188}, 'accuracy': 0.42740652312497734, 'macro avg': {'precision': 0.4428891344250143, 'recall': 0.42886430830635364, 'f1-score': 0.4098717831430805, 'support': 578833}, 'weighted avg': {'precision': 0.44313957246705654, 'recall': 0.42740652312497734, 'f1-score': 0.40929397320778516, 'support': 578833}}
[[ 49763  98008  46937]
 [ 25979 131119  33839]
 [ 28772  97901  66515]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0657634
{'0': {'precision': 0.46930789298685355, 'recall': 0.27138673608235225, 'f1-score': 0.34390403898416266, 'support': 67612}, '1': {'precision': 0.4297085602958133, 'recall': 0.7127237236049011, 'f1-score': 0.5361604175141635, 'support': 75819}, '2': {'precision': 0.46430177046091925, 'recall': 0.31831858277193137, 'f1-score': 0.3776949601198147, 'support': 68133}, 'accuracy': 0.4446644986859768, 'macro avg': {'precision': 0.45443940791452864, 'recall': 0.43414301415306156, 'f1-score': 0.41925313887271365, 'support': 211564}, 'weighted avg': {'precision': 0.4535043349554235, 'recall': 0.4446644986859768, 'f1-score': 0.4236858695106299, 'support': 211564}}
[[18349 35509 13754]
 [10512 54038 11269]
 [10237 36208 21688]]
training model: results/AAL/W0/deepVOL_L2/h200
Epoch 1/50
2262/2262 - 73s - loss: 3.2767 - accuracy200: 0.3764 - val_loss: 3.2799 - val_accuracy200: 0.3701 - 73s/epoch - 32ms/step
Epoch 2/50
2262/2262 - 67s - loss: 3.2540 - accuracy200: 0.3876 - val_loss: 3.2789 - val_accuracy200: 0.3740 - 67s/epoch - 29ms/step
Epoch 3/50
2262/2262 - 69s - loss: 3.2342 - accuracy200: 0.4007 - val_loss: 3.3260 - val_accuracy200: 0.3741 - 69s/epoch - 30ms/step
Epoch 4/50
2262/2262 - 63s - loss: 3.2181 - accuracy200: 0.4083 - val_loss: 3.3154 - val_accuracy200: 0.3782 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.2088 - accuracy200: 0.4108 - val_loss: 3.3176 - val_accuracy200: 0.3817 - 62s/epoch - 27ms/step
Epoch 6/50
2262/2262 - 62s - loss: 3.2044 - accuracy200: 0.4131 - val_loss: 3.3091 - val_accuracy200: 0.3853 - 62s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.2004 - accuracy200: 0.4150 - val_loss: 3.3094 - val_accuracy200: 0.3880 - 62s/epoch - 27ms/step
Epoch 8/50
2262/2262 - 63s - loss: 3.1971 - accuracy200: 0.4164 - val_loss: 3.3323 - val_accuracy200: 0.3884 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.1934 - accuracy200: 0.4184 - val_loss: 3.3389 - val_accuracy200: 0.3888 - 62s/epoch - 27ms/step
Epoch 10/50
2262/2262 - 62s - loss: 3.1912 - accuracy200: 0.4194 - val_loss: 3.3581 - val_accuracy200: 0.3874 - 62s/epoch - 27ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.1895 - accuracy200: 0.4203 - val_loss: 3.3429 - val_accuracy200: 0.3905 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 62s - loss: 3.1866 - accuracy200: 0.4215 - val_loss: 3.3478 - val_accuracy200: 0.3904 - 62s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h200
Evaluating performance on  test set...
6677/6677 - 84s - 84s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0672476
{'0': {'precision': 0.3869979337801744, 'recall': 0.3841459266284882, 'f1-score': 0.38556665625662134, 'support': 499758}, '1': {'precision': 0.44839286090947167, 'recall': 0.5972578437629191, 'f1-score': 0.5122287051857972, 'support': 747441}, '2': {'precision': 0.3427410831625479, 'recall': 0.1614154910222534, 'f1-score': 0.21947039100556268, 'support': 462087}, 'accuracy': 0.4171232900755052, 'macro avg': {'precision': 0.39271062595073136, 'recall': 0.3809397538045536, 'f1-score': 0.3724219174826604, 'support': 1709286}, 'weighted avg': {'precision': 0.4018805048637156, 'recall': 0.4171232900755052, 'f1-score': 0.3960514338728928, 'support': 1709286}}
[[191980 264456  43322]
 [201314 446415  99712]
 [102781 284718  74588]]
Evaluating performance on  train set...
2262/2262 - 28s - 28s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0999391
{'0': {'precision': 0.39137946657806505, 'recall': 0.336851573589281, 'f1-score': 0.3620740724181677, 'support': 192331}, '1': {'precision': 0.3399486607577405, 'recall': 0.6206113962804441, 'f1-score': 0.4392770893827444, 'support': 196959}, '2': {'precision': 0.3925998994956169, 'recall': 0.11128873131690434, 'f1-score': 0.1734190535696669, 'support': 189543}, 'accuracy': 0.35954411721515533, 'macro avg': {'precision': 0.37464267561047415, 'recall': 0.3562505670622098, 'f1-score': 0.32492340512352635, 'support': 578833}, 'weighted avg': {'precision': 0.3742787906195869, 'recall': 0.35954411721515533, 'f1-score': 0.3265674423205829, 'support': 578833}}
[[ 64787 113626  13918]
 [ 56007 122235  18717]
 [ 44741 123708  21094]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0924958
{'0': {'precision': 0.3769330284613996, 'recall': 0.377239468850682, 'f1-score': 0.37708618639859137, 'support': 66422}, '1': {'precision': 0.36865894927159415, 'recall': 0.5945067279037065, 'f1-score': 0.45510389507782256, 'support': 77513}, '2': {'precision': 0.39623674647817214, 'recall': 0.11770098626328941, 'f1-score': 0.18149068606215368, 'support': 67629}, 'accuracy': 0.3738774082547125, 'macro avg': {'precision': 0.3806095747370553, 'recall': 0.36314906100589267, 'f1-score': 0.33789358917952256, 'support': 211564}, 'weighted avg': {'precision': 0.380072231943641, 'recall': 0.3738774082547125, 'f1-score': 0.34314590620252916, 'support': 211564}}
[[25057 36576  4789]
 [24091 46082  7340]
 [17328 42341  7960]]
training model: results/AAL/W0/deepVOL_L2/h300
Epoch 1/50
2262/2262 - 66s - loss: 3.2890 - accuracy300: 0.3665 - val_loss: 3.2937 - val_accuracy300: 0.3524 - 66s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.2691 - accuracy300: 0.3773 - val_loss: 3.2909 - val_accuracy300: 0.3639 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 3.2566 - accuracy300: 0.3881 - val_loss: 3.3028 - val_accuracy300: 0.3555 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.2467 - accuracy300: 0.3946 - val_loss: 3.3371 - val_accuracy300: 0.3522 - 62s/epoch - 27ms/step
Epoch 5/50
2262/2262 - 63s - loss: 3.2406 - accuracy300: 0.3976 - val_loss: 3.3537 - val_accuracy300: 0.3525 - 63s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 63s - loss: 3.2370 - accuracy300: 0.3992 - val_loss: 3.3477 - val_accuracy300: 0.3583 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.2335 - accuracy300: 0.4016 - val_loss: 3.3175 - val_accuracy300: 0.3618 - 62s/epoch - 27ms/step
Epoch 8/50
2262/2262 - 63s - loss: 3.2313 - accuracy300: 0.4021 - val_loss: 3.3324 - val_accuracy300: 0.3654 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.2292 - accuracy300: 0.4032 - val_loss: 3.3249 - val_accuracy300: 0.3658 - 62s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 62s - loss: 3.2269 - accuracy300: 0.4050 - val_loss: 3.3188 - val_accuracy300: 0.3712 - 62s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 63s - loss: 3.2250 - accuracy300: 0.4050 - val_loss: 3.3246 - val_accuracy300: 0.3705 - 63s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 3.2229 - accuracy300: 0.4071 - val_loss: 3.3301 - val_accuracy300: 0.3714 - 63s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h300
Evaluating performance on  test set...
6677/6677 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.081964
{'0': {'precision': 0.3880285117224401, 'recall': 0.3752692359512819, 'f1-score': 0.38154223188835495, 'support': 541811}, '1': {'precision': 0.4116046919950871, 'recall': 0.5129081440241595, 'f1-score': 0.45670625743143484, 'support': 681469}, '2': {'precision': 0.3445908955667956, 'recall': 0.2383036423418641, 'f1-score': 0.28175685373905557, 'support': 486006}, 'accuracy': 0.3912001853405457, 'macro avg': {'precision': 0.3814080330947742, 'recall': 0.37549367410576856, 'f1-score': 0.3733351143529484, 'support': 1709286}, 'weighted avg': {'precision': 0.3850772758946619, 'recall': 0.3912001853405457, 'f1-score': 0.383136851413694, 'support': 1709286}}
[[203325 252637  85849]
 [197504 349531 134434]
 [123166 247023 115817]]
Evaluating performance on  train set...
2262/2262 - 29s - 29s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1021508
{'0': {'precision': 0.39077700568540746, 'recall': 0.31271010368063734, 'f1-score': 0.3474119606086729, 'support': 197819}, '1': {'precision': 0.32796823846235085, 'recall': 0.5311068712489244, 'f1-score': 0.4055202694844743, 'support': 187113}, '2': {'precision': 0.3772644118272708, 'recall': 0.22866308064424629, 'f1-score': 0.28474180062037213, 'support': 193901}, 'accuracy': 0.35515425001684425, 'macro avg': {'precision': 0.3653365519916763, 'recall': 0.357493351857936, 'f1-score': 0.34589134357117307, 'support': 578833}, 'weighted avg': {'precision': 0.3659469729763284, 'recall': 0.35515425001684425, 'f1-score': 0.34520236527942655, 'support': 578833}}
[[ 61860  99691  36268]
 [ 50817  99377  36919]
 [ 45623 103940  44338]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974005
{'0': {'precision': 0.37204077577906497, 'recall': 0.35573578839690195, 'f1-score': 0.3637056349496866, 'support': 68430}, '1': {'precision': 0.35155726961556233, 'recall': 0.511953312736011, 'f1-score': 0.4168586059616718, 'support': 72825}, '2': {'precision': 0.3831146150391697, 'recall': 0.21840731627529902, 'f1-score': 0.2782110860486815, 'support': 70309}, 'accuracy': 0.3638709799398763, 'macro avg': {'precision': 0.36890422014459906, 'recall': 0.36203213913607063, 'f1-score': 0.35292510898668, 'support': 211564}, 'weighted avg': {'precision': 0.3686700663397541, 'recall': 0.3638709799398763, 'f1-score': 0.3535896836312537, 'support': 211564}}
[[24343 32661 11426]
 [22242 37283 13300]
 [18846 36107 15356]]
training model: results/AAL/W0/deepVOL_L2/h500
Epoch 1/50
2262/2262 - 65s - loss: 3.1975 - accuracy500: 0.4165 - val_loss: 3.3226 - val_accuracy500: 0.4311 - 65s/epoch - 29ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.2053 - accuracy500: 0.4166 - val_loss: 3.3112 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 3.2065 - accuracy500: 0.4167 - val_loss: 3.3338 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 63s - loss: 3.2033 - accuracy500: 0.4176 - val_loss: 3.3276 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.1983 - accuracy500: 0.4181 - val_loss: 3.3330 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 63s - loss: 3.1886 - accuracy500: 0.4205 - val_loss: 3.3229 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 64s - loss: 3.1940 - accuracy500: 0.4204 - val_loss: 3.3008 - val_accuracy500: 0.4312 - 64s/epoch - 28ms/step
Epoch 8/50
2262/2262 - 63s - loss: 3.1846 - accuracy500: 0.4216 - val_loss: 3.3289 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 9/50
2262/2262 - 64s - loss: 3.1903 - accuracy500: 0.4213 - val_loss: 3.3277 - val_accuracy500: 0.4312 - 64s/epoch - 28ms/step
Epoch 10/50
2262/2262 - 63s - loss: 3.1857 - accuracy500: 0.4246 - val_loss: 3.3138 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 62s - loss: 3.1797 - accuracy500: 0.4260 - val_loss: 3.3116 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 3.1715 - accuracy500: 0.4290 - val_loss: 3.3292 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 62s - loss: 3.1739 - accuracy500: 0.4289 - val_loss: 3.3422 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 14/50
2262/2262 - 63s - loss: 3.1739 - accuracy500: 0.4288 - val_loss: 3.3864 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 15/50
2262/2262 - 63s - loss: 3.1666 - accuracy500: 0.4304 - val_loss: 3.3022 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 16/50
2262/2262 - 63s - loss: 3.1687 - accuracy500: 0.4298 - val_loss: 3.3151 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 17/50
2262/2262 - 64s - loss: 3.1608 - accuracy500: 0.4324 - val_loss: 3.2926 - val_accuracy500: 0.4312 - 64s/epoch - 28ms/step
Epoch 18/50
2262/2262 - 64s - loss: 3.1557 - accuracy500: 0.4333 - val_loss: 3.3009 - val_accuracy500: 0.4311 - 64s/epoch - 28ms/step
Epoch 19/50
2262/2262 - 63s - loss: 3.1597 - accuracy500: 0.4328 - val_loss: 3.2975 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 20/50
2262/2262 - 63s - loss: 3.1662 - accuracy500: 0.4324 - val_loss: 3.3056 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 21/50
2262/2262 - 63s - loss: 3.1667 - accuracy500: 0.4315 - val_loss: 3.3234 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 22/50
2262/2262 - 63s - loss: 3.1634 - accuracy500: 0.4331 - val_loss: 3.3230 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 23/50
2262/2262 - 66s - loss: 3.1566 - accuracy500: 0.4360 - val_loss: 3.3377 - val_accuracy500: 0.4312 - 66s/epoch - 29ms/step
Epoch 24/50
2262/2262 - 63s - loss: 3.1571 - accuracy500: 0.4365 - val_loss: 3.3440 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 25/50
2262/2262 - 63s - loss: 3.1503 - accuracy500: 0.4376 - val_loss: 3.3470 - val_accuracy500: 0.4312 - 63s/epoch - 28ms/step
Epoch 26/50
2262/2262 - 62s - loss: 3.1453 - accuracy500: 0.4400 - val_loss: 3.3135 - val_accuracy500: 0.4312 - 62s/epoch - 28ms/step
Epoch 27/50
2262/2262 - 63s - loss: 3.1446 - accuracy500: 0.4401 - val_loss: 3.3084 - val_accuracy500: 0.4311 - 63s/epoch - 28ms/step
testing model: results/AAL/W0/deepVOL_L2/h500
Evaluating performance on  test set...
6677/6677 - 94s - 94s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0665509
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 473276}, '1': {'precision': 0.4686833418944329, 'recall': 0.9999987517366464, 'f1-score': 0.6382358154792374, 'support': 801113}, '2': {'precision': 0.25, 'recall': 2.299395029167826e-06, 'f1-score': 4.598747760984684e-06, 'support': 434897}, 'accuracy': 0.4686828301407722, 'macro avg': {'precision': 0.23956111396481097, 'recall': 0.33333368371055855, 'f1-score': 0.21274680474233276, 'support': 1709286}, 'weighted avg': {'precision': 0.283271826993888, 'recall': 0.4686828301407722, 'f1-score': 0.2991313383644535, 'support': 1709286}}
[[     0 473274      2]
 [     0 801112      1]
 [     0 434896      1]]
Evaluating performance on  train set...
2262/2262 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1668088
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 192890}, '1': {'precision': 0.3398689422955657, 'recall': 0.9999949168136555, 'f1-score': 0.5073160416526983, 'support': 196727}, '2': {'precision': 0.5, 'recall': 1.0569930661254862e-05, 'f1-score': 2.113941443822006e-05, 'support': 189216}, 'accuracy': 0.3398700488742003, 'macro avg': {'precision': 0.2799563140985219, 'recall': 0.33333516224810555, 'f1-score': 0.16911239368904551, 'support': 578833}, 'weighted avg': {'precision': 0.2789567930836351, 'recall': 0.3398700488742003, 'f1-score': 0.17242756173482285, 'support': 578833}}
[[     0 192889      1]
 [     0 196726      1]
 [     0 189214      2]]
Evaluating performance on  val set...
827/827 - 11s - 11s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0942725
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 58547}, '1': {'precision': 0.43115762207947517, 'recall': 1.0, 'f1-score': 0.602529889688883, 'support': 91217}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61800}, 'accuracy': 0.4311555841258437, 'macro avg': {'precision': 0.14371920735982505, 'recall': 0.3333333333333333, 'f1-score': 0.200843296562961, 'support': 211564}, 'weighted avg': {'precision': 0.1858960163979859, 'recall': 0.4311555841258437, 'f1-score': 0.2597841265420905, 'support': 211564}}
[[    0 58546     1]
 [    0 91217     0]
 [    0 61800     0]]
training model: results/AAL/W0/deepVOL_L2/h1000
Epoch 1/50
2262/2262 - 82s - loss: 3.2537 - accuracy1000: 0.3942 - val_loss: 3.3240 - val_accuracy1000: 0.3586 - 82s/epoch - 36ms/step
Epoch 2/50
2262/2262 - 63s - loss: 3.2507 - accuracy1000: 0.3862 - val_loss: 3.3242 - val_accuracy1000: 0.3585 - 63s/epoch - 28ms/step
Epoch 3/50
2262/2262 - 63s - loss: 3.2287 - accuracy1000: 0.4010 - val_loss: 3.3212 - val_accuracy1000: 0.3573 - 63s/epoch - 28ms/step
Epoch 4/50
2262/2262 - 62s - loss: 3.2233 - accuracy1000: 0.4047 - val_loss: 3.3442 - val_accuracy1000: 0.3586 - 62s/epoch - 28ms/step
Epoch 5/50
2262/2262 - 62s - loss: 3.2230 - accuracy1000: 0.4046 - val_loss: 3.3357 - val_accuracy1000: 0.3586 - 62s/epoch - 28ms/step
Epoch 6/50
2262/2262 - 63s - loss: 3.2202 - accuracy1000: 0.4062 - val_loss: 3.3331 - val_accuracy1000: 0.3585 - 63s/epoch - 28ms/step
Epoch 7/50
2262/2262 - 62s - loss: 3.2177 - accuracy1000: 0.4071 - val_loss: 3.3361 - val_accuracy1000: 0.3585 - 62s/epoch - 27ms/step
Epoch 8/50
2262/2262 - 62s - loss: 3.2142 - accuracy1000: 0.4077 - val_loss: 3.3342 - val_accuracy1000: 0.3585 - 62s/epoch - 27ms/step
Epoch 9/50
2262/2262 - 62s - loss: 3.2120 - accuracy1000: 0.4095 - val_loss: 3.3291 - val_accuracy1000: 0.3587 - 62s/epoch - 27ms/step
Epoch 10/50
2262/2262 - 63s - loss: 3.2070 - accuracy1000: 0.4112 - val_loss: 3.3267 - val_accuracy1000: 0.3591 - 63s/epoch - 28ms/step
Epoch 11/50
2262/2262 - 63s - loss: 3.2033 - accuracy1000: 0.4139 - val_loss: 3.3266 - val_accuracy1000: 0.3593 - 63s/epoch - 28ms/step
Epoch 12/50
2262/2262 - 63s - loss: 3.1998 - accuracy1000: 0.4179 - val_loss: 3.3302 - val_accuracy1000: 0.3631 - 63s/epoch - 28ms/step
Epoch 13/50
2262/2262 - 62s - loss: 3.1961 - accuracy1000: 0.4192 - val_loss: 3.3272 - val_accuracy1000: 0.3585 - 62s/epoch - 27ms/step
testing model: results/AAL/W0/deepVOL_L2/h1000
Evaluating performance on  test set...
6677/6677 - 112s - 112s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0568792
{'0': {'precision': 0.22983023902799068, 'recall': 0.008835977796549864, 'f1-score': 0.017017698743010887, 'support': 458127}, '1': {'precision': 0.49218215600184617, 'recall': 0.9886688751246566, 'f1-score': 0.6571966636787315, 'support': 841311}, '2': {'precision': 0.3260484347312463, 'recall': 0.0013468407799964864, 'f1-score': 0.0026826002755497022, 'support': 409848}, 'accuracy': 0.48931425168169634, 'macro avg': {'precision': 0.3493536099203611, 'recall': 0.3329505645670677, 'f1-score': 0.22563232089909735, 'support': 1709286}, 'weighted avg': {'precision': 0.3820308588738089, 'recall': 0.48931425168169634, 'f1-score': 0.32867671527526116, 'support': 1709286}}
[[  4048 453648    431]
 [  8823 831778    710]
 [  4742 404554    552]]
Evaluating performance on  train set...
2262/2262 - 31s - 31s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112585
{'0': {'precision': 0.3563374541502513, 'recall': 0.01356221400687676, 'f1-score': 0.026129922397218654, 'support': 193405}, '1': {'precision': 0.3371449093823635, 'recall': 0.9865381657866407, 'f1-score': 0.5025467602415538, 'support': 195070}, '2': {'precision': 0.3613193403298351, 'recall': 0.0012660355750743336, 'f1-score': 0.0025232299437246432, 'support': 190358}, 'accuracy': 0.3374168369806144, 'macro avg': {'precision': 0.35160056795415, 'recall': 0.33378880512286396, 'f1-score': 0.17706663752749904, 'support': 578833}, 'weighted avg': {'precision': 0.35150782657459706, 'recall': 0.3374168369806144, 'f1-score': 0.1789216771800874, 'support': 578833}}
[[  2623 190550    232]
 [  2432 192444    194]
 [  2306 187811    241]]
Evaluating performance on  val set...
827/827 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1056292
{'0': {'precision': 0.24630832841110456, 'recall': 0.006341723062884952, 'f1-score': 0.012365081247776067, 'support': 65755}, '1': {'precision': 0.3582619893639854, 'recall': 0.9903751071263761, 'f1-score': 0.5261812195719939, 'support': 75845}, '2': {'precision': 0.3883495145631068, 'recall': 0.0011434452003887714, 'f1-score': 0.0022801767136953113, 'support': 69964}, 'accuracy': 0.35739539808284965, 'macro avg': {'precision': 0.3309732774460656, 'recall': 0.33262009179654994, 'f1-score': 0.18027549251115507, 'support': 211564}, 'weighted avg': {'precision': 0.33341622466429477, 'recall': 0.35739539808284965, 'f1-score': 0.19323141365961305, 'support': 211564}}
[[  417 65273    65]
 [  669 75115    61]
 [  607 69277    80]]
training model: results/AAL/W0/deepVOL_L3/h10
Epoch 1/50
2262/2262 - 92s - loss: 3.1533 - accuracy10: 0.4256 - val_loss: 2.9500 - val_accuracy10: 0.5215 - 92s/epoch - 41ms/step
Epoch 2/50
2262/2262 - 89s - loss: 2.8911 - accuracy10: 0.4758 - val_loss: 2.6581 - val_accuracy10: 0.6460 - 89s/epoch - 39ms/step
Epoch 3/50
2262/2262 - 95s - loss: 2.6989 - accuracy10: 0.5567 - val_loss: 2.6224 - val_accuracy10: 0.6382 - 95s/epoch - 42ms/step
Epoch 4/50
2262/2262 - 95s - loss: 2.6349 - accuracy10: 0.5754 - val_loss: 2.5700 - val_accuracy10: 0.6566 - 95s/epoch - 42ms/step
Epoch 5/50
2262/2262 - 88s - loss: 2.5958 - accuracy10: 0.5865 - val_loss: 2.5582 - val_accuracy10: 0.6150 - 88s/epoch - 39ms/step
Epoch 6/50
2262/2262 - 89s - loss: 2.5646 - accuracy10: 0.5940 - val_loss: 2.5031 - val_accuracy10: 0.6456 - 89s/epoch - 39ms/step
Epoch 7/50
2262/2262 - 89s - loss: 2.5299 - accuracy10: 0.6022 - val_loss: 2.4963 - val_accuracy10: 0.6618 - 89s/epoch - 39ms/step
Epoch 8/50
2262/2262 - 89s - loss: 2.5116 - accuracy10: 0.6054 - val_loss: 2.4551 - val_accuracy10: 0.6440 - 89s/epoch - 39ms/step
Epoch 9/50
2262/2262 - 88s - loss: 2.4900 - accuracy10: 0.6091 - val_loss: 2.4540 - val_accuracy10: 0.6420 - 88s/epoch - 39ms/step
Epoch 10/50
2262/2262 - 88s - loss: 2.4744 - accuracy10: 0.6114 - val_loss: 2.4404 - val_accuracy10: 0.6602 - 88s/epoch - 39ms/step
Epoch 11/50
2262/2262 - 88s - loss: 2.4629 - accuracy10: 0.6138 - val_loss: 2.4359 - val_accuracy10: 0.6526 - 88s/epoch - 39ms/step
Epoch 12/50
2262/2262 - 88s - loss: 2.4486 - accuracy10: 0.6158 - val_loss: 2.4312 - val_accuracy10: 0.6673 - 88s/epoch - 39ms/step
Epoch 13/50
2262/2262 - 88s - loss: 2.4379 - accuracy10: 0.6181 - val_loss: 2.4169 - val_accuracy10: 0.6640 - 88s/epoch - 39ms/step
Epoch 14/50
2262/2262 - 87s - loss: 2.4293 - accuracy10: 0.6189 - val_loss: 2.4353 - val_accuracy10: 0.6710 - 87s/epoch - 38ms/step
Epoch 15/50
2262/2262 - 88s - loss: 2.4205 - accuracy10: 0.6198 - val_loss: 2.4315 - val_accuracy10: 0.6793 - 88s/epoch - 39ms/step
Epoch 16/50
2262/2262 - 89s - loss: 2.4140 - accuracy10: 0.6213 - val_loss: 2.4101 - val_accuracy10: 0.6755 - 89s/epoch - 39ms/step
Epoch 17/50
2262/2262 - 90s - loss: 2.4081 - accuracy10: 0.6217 - val_loss: 2.4216 - val_accuracy10: 0.6783 - 90s/epoch - 40ms/step
Epoch 18/50
2262/2262 - 89s - loss: 2.4029 - accuracy10: 0.6219 - val_loss: 2.4139 - val_accuracy10: 0.6771 - 89s/epoch - 39ms/step
Epoch 19/50
2262/2262 - 89s - loss: 2.3970 - accuracy10: 0.6231 - val_loss: 2.4109 - val_accuracy10: 0.6762 - 89s/epoch - 39ms/step
Epoch 20/50
2262/2262 - 89s - loss: 2.3918 - accuracy10: 0.6239 - val_loss: 2.4269 - val_accuracy10: 0.6886 - 89s/epoch - 39ms/step
Epoch 21/50
2262/2262 - 89s - loss: 2.3877 - accuracy10: 0.6245 - val_loss: 2.4183 - val_accuracy10: 0.6846 - 89s/epoch - 39ms/step
Epoch 22/50
2262/2262 - 88s - loss: 2.3833 - accuracy10: 0.6254 - val_loss: 2.4199 - val_accuracy10: 0.6803 - 88s/epoch - 39ms/step
Epoch 23/50
2262/2262 - 89s - loss: 2.3777 - accuracy10: 0.6256 - val_loss: 2.4231 - val_accuracy10: 0.6830 - 89s/epoch - 39ms/step
Epoch 24/50
2262/2262 - 88s - loss: 2.3722 - accuracy10: 0.6264 - val_loss: 2.4286 - val_accuracy10: 0.6860 - 88s/epoch - 39ms/step
Epoch 25/50
2262/2262 - 87s - loss: 2.3701 - accuracy10: 0.6272 - val_loss: 2.4148 - val_accuracy10: 0.6853 - 87s/epoch - 39ms/step
Epoch 26/50
2262/2262 - 89s - loss: 2.3648 - accuracy10: 0.6274 - val_loss: 2.4170 - val_accuracy10: 0.6800 - 89s/epoch - 39ms/step
testing model: results/AAL/W0/deepVOL_L3/h10
Evaluating performance on  test set...
6677/6677 - 115s - 115s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5598717
{'0': {'precision': 0.4039610867466087, 'recall': 0.5330616552157708, 'f1-score': 0.459617799868841, 'support': 178152}, '1': {'precision': 0.8961045947736429, 'recall': 0.8667212771113354, 'f1-score': 0.8811680509057382, 'support': 1345286}, '2': {'precision': 0.4641930356884843, 'recall': 0.43216499504971806, 'f1-score': 0.4476068135524266, 'support': 185848}, 'accuracy': 0.784696651116314, 'macro avg': {'precision': 0.5880862390695786, 'recall': 0.6106493091256081, 'f1-score': 0.5961308881090019, 'support': 1709286}, 'weighted avg': {'precision': 0.7978493878188732, 'recall': 0.784696651116314, 'f1-score': 0.7900911280488473, 'support': 1709286}}
[[  94966   70350   12836]
 [  99426 1165988   79872]
 [  40695   64836   80317]]
Evaluating performance on  train set...
2262/2262 - 39s - 39s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.79359376
{'0': {'precision': 0.421691426352073, 'recall': 0.5851635131753701, 'f1-score': 0.4901568772874579, 'support': 103906}, '1': {'precision': 0.8123438273452946, 'recall': 0.7438859543882698, 'f1-score': 0.7766091748006819, 'support': 368414}, '2': {'precision': 0.47618215460526314, 'recall': 0.4349046595251284, 'f1-score': 0.45460835259307236, 'support': 106513}, 'accuracy': 0.6585370910089784, 'macro avg': {'precision': 0.5700724694342102, 'recall': 0.5879847090295894, 'f1-score': 0.5737914682270707, 'support': 578833}, 'weighted avg': {'precision': 0.6803597894169792, 'recall': 0.6585370910089784, 'f1-score': 0.6659358268726816, 'support': 578833}}
[[ 60802  31472  11632]
 [ 55031 274058  39325]
 [ 28353  31837  46323]]
Evaluating performance on  val set...
827/827 - 14s - 14s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.7602144
{'0': {'precision': 0.4050262414210739, 'recall': 0.5884681936827287, 'f1-score': 0.47981156665112334, 'support': 34097}, '1': {'precision': 0.8297143831000318, 'recall': 0.7541471863910325, 'f1-score': 0.7901281015665055, 'support': 142024}, '2': {'precision': 0.4704114164262942, 'recall': 0.4371243969189967, 'f1-score': 0.45315744830208543, 'support': 35443}, 'accuracy': 0.6743349530165813, 'macro avg': {'precision': 0.5683840136491333, 'recall': 0.5932465923309193, 'f1-score': 0.5743657055065714, 'support': 211564}, 'weighted avg': {'precision': 0.7010754529670946, 'recall': 0.6743349530165813, 'f1-score': 0.6836633261100922, 'support': 211564}}
[[ 20065  10930   3102]
 [ 20577 107107  14340]
 [  8898  11052  15493]]
training model: results/AAL/W0/deepVOL_L3/h20
Epoch 1/50
2262/2262 - 93s - loss: 3.1259 - accuracy20: 0.4472 - val_loss: 3.1277 - val_accuracy20: 0.5518 - 93s/epoch - 41ms/step
Epoch 2/50
2262/2262 - 87s - loss: 2.9661 - accuracy20: 0.4803 - val_loss: 2.7773 - val_accuracy20: 0.6008 - 87s/epoch - 39ms/step
Epoch 3/50
2262/2262 - 88s - loss: 2.7449 - accuracy20: 0.5657 - val_loss: 2.7517 - val_accuracy20: 0.6116 - 88s/epoch - 39ms/step
Epoch 4/50
2262/2262 - 88s - loss: 2.6815 - accuracy20: 0.5825 - val_loss: 2.6988 - val_accuracy20: 0.6231 - 88s/epoch - 39ms/step
Epoch 5/50
2262/2262 - 88s - loss: 2.6415 - accuracy20: 0.5910 - val_loss: 2.6974 - val_accuracy20: 0.6244 - 88s/epoch - 39ms/step
Epoch 6/50
2262/2262 - 94s - loss: 2.6152 - accuracy20: 0.5951 - val_loss: 2.6533 - val_accuracy20: 0.6208 - 94s/epoch - 42ms/step
Epoch 7/50
2262/2262 - 95s - loss: 2.5950 - accuracy20: 0.6000 - val_loss: 2.6327 - val_accuracy20: 0.6315 - 95s/epoch - 42ms/step
Epoch 8/50
2262/2262 - 88s - loss: 2.5799 - accuracy20: 0.6028 - val_loss: 2.6080 - val_accuracy20: 0.6238 - 88s/epoch - 39ms/step
Epoch 9/50
2262/2262 - 88s - loss: 2.5636 - accuracy20: 0.6044 - val_loss: 2.5862 - val_accuracy20: 0.6191 - 88s/epoch - 39ms/step
Epoch 10/50
2262/2262 - 88s - loss: 2.5529 - accuracy20: 0.6048 - val_loss: 2.5813 - val_accuracy20: 0.6263 - 88s/epoch - 39ms/step
Epoch 11/50
2262/2262 - 88s - loss: 2.5381 - accuracy20: 0.6070 - val_loss: 2.5739 - val_accuracy20: 0.6278 - 88s/epoch - 39ms/step
Epoch 12/50
2262/2262 - 88s - loss: 2.5287 - accuracy20: 0.6085 - val_loss: 2.5741 - val_accuracy20: 0.6311 - 88s/epoch - 39ms/step
Epoch 13/50
2262/2262 - 88s - loss: 2.5177 - accuracy20: 0.6100 - val_loss: 2.5909 - val_accuracy20: 0.6387 - 88s/epoch - 39ms/step
Epoch 14/50
2262/2262 - 87s - loss: 2.5088 - accuracy20: 0.6116 - val_loss: 2.5870 - val_accuracy20: 0.6291 - 87s/epoch - 39ms/step
Epoch 15/50
2262/2262 - 88s - loss: 2.5020 - accuracy20: 0.6123 - val_loss: 2.5668 - val_accuracy20: 0.6371 - 88s/epoch - 39ms/step
Epoch 16/50
2262/2262 - 87s - loss: 2.4952 - accuracy20: 0.6134 - val_loss: 2.5573 - val_accuracy20: 0.6377 - 87s/epoch - 39ms/step
Epoch 17/50
2262/2262 - 88s - loss: 2.4896 - accuracy20: 0.6146 - val_loss: 2.5542 - val_accuracy20: 0.6402 - 88s/epoch - 39ms/step
Epoch 18/50
2262/2262 - 88s - loss: 2.4847 - accuracy20: 0.6156 - val_loss: 2.5832 - val_accuracy20: 0.6459 - 88s/epoch - 39ms/step
Epoch 19/50
2262/2262 - 90s - loss: 2.4792 - accuracy20: 0.6163 - val_loss: 2.5616 - val_accuracy20: 0.6450 - 90s/epoch - 40ms/step
Epoch 20/50
2262/2262 - 89s - loss: 2.4745 - accuracy20: 0.6169 - val_loss: 2.5613 - val_accuracy20: 0.6439 - 89s/epoch - 40ms/step
Epoch 21/50
2262/2262 - 90s - loss: 2.4702 - accuracy20: 0.6177 - val_loss: 2.5615 - val_accuracy20: 0.6436 - 90s/epoch - 40ms/step
Epoch 22/50
2262/2262 - 90s - loss: 2.4669 - accuracy20: 0.6178 - val_loss: 2.5551 - val_accuracy20: 0.6442 - 90s/epoch - 40ms/step
Epoch 23/50
2262/2262 - 90s - loss: 2.4631 - accuracy20: 0.6185 - val_loss: 2.5692 - val_accuracy20: 0.6432 - 90s/epoch - 40ms/step
Epoch 24/50
2262/2262 - 90s - loss: 2.4593 - accuracy20: 0.6197 - val_loss: 2.5601 - val_accuracy20: 0.6455 - 90s/epoch - 40ms/step
Epoch 25/50
2262/2262 - 93s - loss: 2.4559 - accuracy20: 0.6195 - val_loss: 2.5515 - val_accuracy20: 0.6395 - 93s/epoch - 41ms/step
Epoch 26/50
2262/2262 - 90s - loss: 2.4523 - accuracy20: 0.6199 - val_loss: 2.5521 - val_accuracy20: 0.6419 - 90s/epoch - 40ms/step
Epoch 27/50
2262/2262 - 89s - loss: 2.4495 - accuracy20: 0.6209 - val_loss: 2.5658 - val_accuracy20: 0.6455 - 89s/epoch - 39ms/step
Epoch 28/50
2262/2262 - 90s - loss: 2.4466 - accuracy20: 0.6204 - val_loss: 2.5745 - val_accuracy20: 0.6457 - 90s/epoch - 40ms/step
Epoch 29/50
2262/2262 - 90s - loss: 2.4506 - accuracy20: 0.6199 - val_loss: 2.5621 - val_accuracy20: 0.6432 - 90s/epoch - 40ms/step
Epoch 30/50
2262/2262 - 89s - loss: 2.4423 - accuracy20: 0.6216 - val_loss: 2.5599 - val_accuracy20: 0.6447 - 89s/epoch - 40ms/step
Epoch 31/50
2262/2262 - 94s - loss: 2.4390 - accuracy20: 0.6224 - val_loss: 2.5465 - val_accuracy20: 0.6450 - 94s/epoch - 41ms/step
Epoch 32/50
2262/2262 - 90s - loss: 2.4348 - accuracy20: 0.6227 - val_loss: 2.5703 - val_accuracy20: 0.6457 - 90s/epoch - 40ms/step
Epoch 33/50
2262/2262 - 95s - loss: 2.4331 - accuracy20: 0.6229 - val_loss: 2.5601 - val_accuracy20: 0.6437 - 95s/epoch - 42ms/step
Epoch 34/50
2262/2262 - 91s - loss: 2.4292 - accuracy20: 0.6240 - val_loss: 2.5587 - val_accuracy20: 0.6443 - 91s/epoch - 40ms/step
Epoch 35/50
2262/2262 - 90s - loss: 2.4266 - accuracy20: 0.6240 - val_loss: 2.5583 - val_accuracy20: 0.6426 - 90s/epoch - 40ms/step
Epoch 36/50
2262/2262 - 91s - loss: 2.4246 - accuracy20: 0.6245 - val_loss: 2.5479 - val_accuracy20: 0.6417 - 91s/epoch - 40ms/step
Epoch 37/50
2262/2262 - 90s - loss: 2.4221 - accuracy20: 0.6245 - val_loss: 2.5504 - val_accuracy20: 0.6430 - 90s/epoch - 40ms/step
Epoch 38/50
2262/2262 - 90s - loss: 2.4190 - accuracy20: 0.6249 - val_loss: 2.5748 - val_accuracy20: 0.6437 - 90s/epoch - 40ms/step
Epoch 39/50
2262/2262 - 90s - loss: 2.4159 - accuracy20: 0.6250 - val_loss: 2.5665 - val_accuracy20: 0.6466 - 90s/epoch - 40ms/step
Epoch 40/50
2262/2262 - 94s - loss: 2.4131 - accuracy20: 0.6255 - val_loss: 2.5741 - val_accuracy20: 0.6430 - 94s/epoch - 41ms/step
Epoch 41/50
2262/2262 - 157s - loss: 2.4118 - accuracy20: 0.6264 - val_loss: 2.5572 - val_accuracy20: 0.6434 - 157s/epoch - 69ms/step
testing model: results/AAL/W0/deepVOL_L3/h20
Evaluating performance on  test set...
6677/6677 - 233s - 233s/epoch - 35ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6066591
{'0': {'precision': 0.47622302212906853, 'recall': 0.5106157760814249, 'f1-score': 0.49282008059113264, 'support': 245625}, '1': {'precision': 0.8345100778240889, 'recall': 0.8783928908464373, 'f1-score': 0.8558893680583998, 'support': 1213309}, '2': {'precision': 0.5606388209299157, 'recall': 0.3780357256982169, 'f1-score': 0.4515761171668301, 'support': 250352}, 'accuracy': 0.7522579603413355, 'macro avg': {'precision': 0.6237906402943577, 'recall': 0.5890147975420265, 'f1-score': 0.6000951886054541, 'support': 1709286}, 'weighted avg': {'precision': 0.7429113196519285, 'recall': 0.7522579603413355, 'f1-score': 0.7444981060218806, 'support': 1709286}}
[[ 125420  104302   15903]
 [  89281 1065762   58266]
 [  48663  107047   94642]]
Evaluating performance on  train set...
2262/2262 - 82s - 82s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8217735
{'0': {'precision': 0.47975406340330756, 'recall': 0.5970807224474751, 'f1-score': 0.532025723050244, 'support': 135650}, '1': {'precision': 0.7268078225910061, 'recall': 0.7594387963917948, 'f1-score': 0.7427650982640078, 'support': 305415}, '2': {'precision': 0.5557976276930525, 'recall': 0.36664537483305265, 'f1-score': 0.4418281215832057, 'support': 137768}, 'accuracy': 0.6279013117773175, 'macro avg': {'precision': 0.5874531712291221, 'recall': 0.5743882978907742, 'f1-score': 0.5722063142991525, 'support': 578833}, 'weighted avg': {'precision': 0.6282084425202213, 'recall': 0.6279013117773175, 'f1-score': 0.6217521607654412, 'support': 578833}}
[[ 80994  42077  12579]
 [ 45680 231944  27791]
 [ 42150  45106  50512]]
Evaluating performance on  val set...
827/827 - 29s - 29s/epoch - 36ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7967635
{'0': {'precision': 0.47610410809830417, 'recall': 0.5740841990158556, 'f1-score': 0.520523497917906, 'support': 45725}, '1': {'precision': 0.7387959070357738, 'recall': 0.7813430644687723, 'f1-score': 0.7594740597288758, 'support': 119205}, '2': {'precision': 0.5637537468296058, 'recall': 0.3670069048333834, 'f1-score': 0.44458587144285844, 'support': 46634}, 'accuracy': 0.6452184681703882, 'macro avg': {'precision': 0.592884587321228, 'recall': 0.5741447227726705, 'f1-score': 0.5748611430298801, 'support': 211564}, 'weighted avg': {'precision': 0.6434370624049754, 'recall': 0.6452184681703882, 'f1-score': 0.6384208077042557, 'support': 211564}}
[[26250 15849  3626]
 [16447 93140  9618]
 [12438 17081 17115]]
training model: results/AAL/W0/deepVOL_L3/h30
Epoch 1/50
2262/2262 - 163s - loss: 3.2359 - accuracy30: 0.4252 - val_loss: 3.2564 - val_accuracy30: 0.4917 - 163s/epoch - 72ms/step
Epoch 2/50
2262/2262 - 168s - loss: 3.1138 - accuracy30: 0.4669 - val_loss: 3.1021 - val_accuracy30: 0.5232 - 168s/epoch - 74ms/step
Epoch 3/50
2262/2262 - 169s - loss: 3.0772 - accuracy30: 0.4818 - val_loss: 3.1062 - val_accuracy30: 0.5334 - 169s/epoch - 75ms/step
Epoch 4/50
2262/2262 - 159s - loss: 2.9685 - accuracy30: 0.5042 - val_loss: 2.8753 - val_accuracy30: 0.5670 - 159s/epoch - 70ms/step
Epoch 5/50
2262/2262 - 160s - loss: 2.8343 - accuracy30: 0.5428 - val_loss: 2.8559 - val_accuracy30: 0.5767 - 160s/epoch - 71ms/step
Epoch 6/50
2262/2262 - 159s - loss: 2.7563 - accuracy30: 0.5617 - val_loss: 2.8483 - val_accuracy30: 0.5917 - 159s/epoch - 70ms/step
Epoch 7/50
2262/2262 - 166s - loss: 2.7185 - accuracy30: 0.5710 - val_loss: 2.8154 - val_accuracy30: 0.5958 - 166s/epoch - 73ms/step
Epoch 8/50
2262/2262 - 156s - loss: 2.6946 - accuracy30: 0.5759 - val_loss: 2.8421 - val_accuracy30: 0.5970 - 156s/epoch - 69ms/step
Epoch 9/50
2262/2262 - 157s - loss: 2.6782 - accuracy30: 0.5783 - val_loss: 2.8148 - val_accuracy30: 0.6000 - 157s/epoch - 69ms/step
Epoch 10/50
2262/2262 - 156s - loss: 2.6614 - accuracy30: 0.5823 - val_loss: 2.8064 - val_accuracy30: 0.5975 - 156s/epoch - 69ms/step
Epoch 11/50
2262/2262 - 157s - loss: 2.6485 - accuracy30: 0.5847 - val_loss: 2.7660 - val_accuracy30: 0.6017 - 157s/epoch - 69ms/step
Epoch 12/50
2262/2262 - 157s - loss: 2.6355 - accuracy30: 0.5856 - val_loss: 2.7651 - val_accuracy30: 0.6032 - 157s/epoch - 70ms/step
Epoch 13/50
2262/2262 - 158s - loss: 2.6233 - accuracy30: 0.5877 - val_loss: 2.7472 - val_accuracy30: 0.6055 - 158s/epoch - 70ms/step
Epoch 14/50
2262/2262 - 156s - loss: 2.6129 - accuracy30: 0.5883 - val_loss: 2.7336 - val_accuracy30: 0.6044 - 156s/epoch - 69ms/step
Epoch 15/50
2262/2262 - 156s - loss: 2.6050 - accuracy30: 0.5907 - val_loss: 2.7192 - val_accuracy30: 0.6058 - 156s/epoch - 69ms/step
Epoch 16/50
2262/2262 - 154s - loss: 2.5951 - accuracy30: 0.5918 - val_loss: 2.7213 - val_accuracy30: 0.6056 - 154s/epoch - 68ms/step
Epoch 17/50
2262/2262 - 154s - loss: 2.5893 - accuracy30: 0.5929 - val_loss: 2.7049 - val_accuracy30: 0.6089 - 154s/epoch - 68ms/step
Epoch 18/50
2262/2262 - 155s - loss: 2.5844 - accuracy30: 0.5939 - val_loss: 2.7124 - val_accuracy30: 0.6089 - 155s/epoch - 68ms/step
Epoch 19/50
2262/2262 - 156s - loss: 2.5797 - accuracy30: 0.5949 - val_loss: 2.6649 - val_accuracy30: 0.6125 - 156s/epoch - 69ms/step
Epoch 20/50
2262/2262 - 155s - loss: 2.5735 - accuracy30: 0.5956 - val_loss: 2.6817 - val_accuracy30: 0.6108 - 155s/epoch - 69ms/step
Epoch 21/50
2262/2262 - 154s - loss: 2.5700 - accuracy30: 0.5965 - val_loss: 2.6791 - val_accuracy30: 0.6120 - 154s/epoch - 68ms/step
Epoch 22/50
2262/2262 - 152s - loss: 2.5647 - accuracy30: 0.5971 - val_loss: 2.6790 - val_accuracy30: 0.6114 - 152s/epoch - 67ms/step
Epoch 23/50
2262/2262 - 156s - loss: 2.5613 - accuracy30: 0.5975 - val_loss: 2.6599 - val_accuracy30: 0.6120 - 156s/epoch - 69ms/step
Epoch 24/50
2262/2262 - 164s - loss: 2.5571 - accuracy30: 0.5982 - val_loss: 2.7024 - val_accuracy30: 0.6109 - 164s/epoch - 72ms/step
Epoch 25/50
2262/2262 - 164s - loss: 2.5533 - accuracy30: 0.5989 - val_loss: 2.6692 - val_accuracy30: 0.6114 - 164s/epoch - 73ms/step
Epoch 26/50
2262/2262 - 166s - loss: 2.5495 - accuracy30: 0.5996 - val_loss: 2.6601 - val_accuracy30: 0.6120 - 166s/epoch - 73ms/step
Epoch 27/50
2262/2262 - 165s - loss: 2.5460 - accuracy30: 0.5999 - val_loss: 2.6668 - val_accuracy30: 0.6117 - 165s/epoch - 73ms/step
Epoch 28/50
2262/2262 - 162s - loss: 2.5437 - accuracy30: 0.6003 - val_loss: 2.6768 - val_accuracy30: 0.6101 - 162s/epoch - 72ms/step
Epoch 29/50
2262/2262 - 164s - loss: 2.5397 - accuracy30: 0.6010 - val_loss: 2.6931 - val_accuracy30: 0.6125 - 164s/epoch - 72ms/step
Epoch 30/50
2262/2262 - 155s - loss: 2.5389 - accuracy30: 0.6016 - val_loss: 2.6696 - val_accuracy30: 0.6123 - 155s/epoch - 68ms/step
Epoch 31/50
2262/2262 - 157s - loss: 2.5344 - accuracy30: 0.6023 - val_loss: 2.6741 - val_accuracy30: 0.6111 - 157s/epoch - 69ms/step
Epoch 32/50
2262/2262 - 154s - loss: 2.5308 - accuracy30: 0.6023 - val_loss: 2.6771 - val_accuracy30: 0.6107 - 154s/epoch - 68ms/step
Epoch 33/50
2262/2262 - 155s - loss: 2.5280 - accuracy30: 0.6031 - val_loss: 2.6784 - val_accuracy30: 0.6124 - 155s/epoch - 68ms/step
testing model: results/AAL/W0/deepVOL_L3/h30
Evaluating performance on  test set...
6677/6677 - 231s - 231s/epoch - 35ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6654796
{'0': {'precision': 0.5418423946042634, 'recall': 0.44436705964685613, 'f1-score': 0.48828757551334284, 'support': 297216}, '1': {'precision': 0.7737863740403507, 'recall': 0.8987751625196144, 'f1-score': 0.8316106270313547, 'support': 1115250}, '2': {'precision': 0.604056587693881, 'recall': 0.3462569907688161, 'f1-score': 0.4401890513809445, 'support': 296820}, 'accuracy': 0.7238156750830463, 'macro avg': {'precision': 0.6398951187794983, 'recall': 0.5631330709784289, 'f1-score': 0.5866957513085473, 'support': 1709286}, 'weighted avg': {'precision': 0.7039814046113404, 'recall': 0.7238156750830463, 'f1-score': 0.703941614259629, 'support': 1709286}}
[[ 132073  145149   19994]
 [  65518 1002359   47373]
 [  46157  147887  102776]]
Evaluating performance on  train set...
2262/2262 - 77s - 77s/epoch - 34ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.8724147
{'0': {'precision': 0.5137987311793651, 'recall': 0.5350960709014115, 'f1-score': 0.5242311845626556, 'support': 156499}, '1': {'precision': 0.6427647094013595, 'recall': 0.7721992533107385, 'f1-score': 0.7015619361822774, 'support': 264367}, '2': {'precision': 0.57377549774032, 'recall': 0.35684668316800344, 'f1-score': 0.44002794571661635, 'support': 157967}, 'accuracy': 0.5947414884776784, 'macro avg': {'precision': 0.5767796461070148, 'recall': 0.5547140024600511, 'f1-score': 0.5552736888205164, 'support': 578833}, 'weighted avg': {'precision': 0.5890686253421864, 'recall': 0.5947414884776784, 'f1-score': 0.5822428490369207, 'support': 578833}}
[[ 83742  54496  18261]
 [ 36610 204144  23613]
 [ 42634  58963  56370]]
Evaluating performance on  val set...
827/827 - 25s - 25s/epoch - 30ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.85121703
{'0': {'precision': 0.5197006920090768, 'recall': 0.5175073297353825, 'f1-score': 0.5186016917433939, 'support': 53549}, '1': {'precision': 0.6586304262620284, 'recall': 0.7913883415829689, 'f1-score': 0.7189319922117156, 'support': 104045}, '2': {'precision': 0.5812364555742836, 'recall': 0.3578098943857699, 'f1-score': 0.44294332178819645, 'support': 53970}, 'accuracy': 0.6114603618763117, 'macro avg': {'precision': 0.5865225246151295, 'recall': 0.5555685219013737, 'f1-score': 0.5601590019144352, 'support': 211564}, 'weighted avg': {'precision': 0.6037226870553161, 'recall': 0.6114603618763117, 'f1-score': 0.5978216151979728, 'support': 211564}}
[[27712 20436  5401]
 [13193 82340  8512]
 [12418 22241 19311]]
training model: results/AAL/W0/deepVOL_L3/h50
Epoch 1/50
2262/2262 - 161s - loss: 3.1826 - accuracy50: 0.4240 - val_loss: 3.2557 - val_accuracy50: 0.3936 - 161s/epoch - 71ms/step
Epoch 2/50
2262/2262 - 166s - loss: 3.1298 - accuracy50: 0.4435 - val_loss: 3.1366 - val_accuracy50: 0.4263 - 166s/epoch - 74ms/step
Epoch 3/50
2262/2262 - 166s - loss: 3.0337 - accuracy50: 0.4829 - val_loss: 3.0642 - val_accuracy50: 0.4975 - 166s/epoch - 74ms/step
Epoch 4/50
2262/2262 - 166s - loss: 2.9347 - accuracy50: 0.5121 - val_loss: 3.0149 - val_accuracy50: 0.5204 - 166s/epoch - 74ms/step
Epoch 5/50
2262/2262 - 166s - loss: 2.8661 - accuracy50: 0.5279 - val_loss: 3.0280 - val_accuracy50: 0.5186 - 166s/epoch - 73ms/step
Epoch 6/50
2262/2262 - 164s - loss: 2.8287 - accuracy50: 0.5350 - val_loss: 3.0799 - val_accuracy50: 0.5160 - 164s/epoch - 72ms/step
Epoch 7/50
2262/2262 - 167s - loss: 2.8106 - accuracy50: 0.5378 - val_loss: 3.1779 - val_accuracy50: 0.4993 - 167s/epoch - 74ms/step
Epoch 8/50
2262/2262 - 167s - loss: 2.7993 - accuracy50: 0.5409 - val_loss: 3.2165 - val_accuracy50: 0.4920 - 167s/epoch - 74ms/step
Epoch 9/50
2262/2262 - 169s - loss: 2.7894 - accuracy50: 0.5426 - val_loss: 3.1418 - val_accuracy50: 0.5019 - 169s/epoch - 75ms/step
Epoch 10/50
2262/2262 - 169s - loss: 2.7815 - accuracy50: 0.5443 - val_loss: 3.1415 - val_accuracy50: 0.5043 - 169s/epoch - 75ms/step
Epoch 11/50
2262/2262 - 169s - loss: 2.7763 - accuracy50: 0.5457 - val_loss: 3.1966 - val_accuracy50: 0.4972 - 169s/epoch - 75ms/step
Epoch 12/50
2262/2262 - 155s - loss: 2.7700 - accuracy50: 0.5471 - val_loss: 3.1210 - val_accuracy50: 0.5107 - 155s/epoch - 68ms/step
Epoch 13/50
2262/2262 - 166s - loss: 2.7648 - accuracy50: 0.5487 - val_loss: 3.1412 - val_accuracy50: 0.5090 - 166s/epoch - 73ms/step
Epoch 14/50
2262/2262 - 167s - loss: 2.7608 - accuracy50: 0.5498 - val_loss: 3.0643 - val_accuracy50: 0.5200 - 167s/epoch - 74ms/step
testing model: results/AAL/W0/deepVOL_L3/h50
Evaluating performance on  test set...
6677/6677 - 231s - 231s/epoch - 35ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.84259135
{'0': {'precision': 0.6157782349417984, 'recall': 0.2489445924179098, 'f1-score': 0.35455213362521365, 'support': 379948}, '1': {'precision': 0.6550435837374721, 'recall': 0.9070942247338623, 'f1-score': 0.7607347425240129, 'support': 959090}, '2': {'precision': 0.53673274767193, 'recall': 0.3298680884164128, 'f1-score': 0.40861028074747785, 'support': 370248}, 'accuracy': 0.6357648749243836, 'macro avg': {'precision': 0.6025181887837334, 'recall': 0.4953023018560616, 'f1-score': 0.5079657189655681, 'support': 1709286}, 'weighted avg': {'precision': 0.6206882206350929, 'recall': 0.6357648749243836, 'f1-score': 0.5941730041082536, 'support': 1709286}}
[[ 94586 237097  48265]
 [ 31954 869985  57151]
 [ 27064 221051 122133]]
Evaluating performance on  train set...
2262/2262 - 80s - 80s/epoch - 35ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0135872
{'0': {'precision': 0.5470294054002067, 'recall': 0.24652984710739323, 'f1-score': 0.3398840735595094, 'support': 184574}, '1': {'precision': 0.48807862880483505, 'recall': 0.7857146270482599, 'f1-score': 0.6021236429687057, 'support': 209263}, '2': {'precision': 0.49671551925026924, 'recall': 0.42631732578001685, 'f1-score': 0.4588318454328874, 'support': 184996}, 'accuracy': 0.49891937743701553, 'macro avg': {'precision': 0.5106078511517703, 'recall': 0.4861872666452233, 'f1-score': 0.46694652065370085, 'support': 578833}, 'weighted avg': {'precision': 0.5096367825800305, 'recall': 0.49891937743701553, 'f1-score': 0.4727063228417101, 'support': 578833}}
[[ 45503  87964  51107]
 [ 16039 164421  28803]
 [ 21640  84489  78867]]
Evaluating performance on  val set...
827/827 - 28s - 28s/epoch - 34ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.99278986
{'0': {'precision': 0.5526307706484013, 'recall': 0.28055512240760955, 'f1-score': 0.3721699918293049, 'support': 64130}, '1': {'precision': 0.514525758601588, 'recall': 0.8008814054584865, 'f1-score': 0.6265346942790626, 'support': 83503}, '2': {'precision': 0.5134710693234892, 'recall': 0.39379956515618403, 'f1-score': 0.44574281616826894, 'support': 63931}, 'accuracy': 0.5201452042880641, 'macro avg': {'precision': 0.5268758661911596, 'recall': 0.49174536434076005, 'f1-score': 0.48148250075887883, 'support': 211564}, 'weighted avg': {'precision': 0.5257575706410843, 'recall': 0.5201452042880641, 'f1-score': 0.4947986053054938, 'support': 211564}}
[[17992 32076 14062]
 [ 6834 66876  9793]
 [ 7731 31024 25176]]
training model: results/AAL/W0/deepVOL_L3/h100
Epoch 1/50
2262/2262 - 168s - loss: 3.2508 - accuracy100: 0.3915 - val_loss: 3.3126 - val_accuracy100: 0.3589 - 168s/epoch - 74ms/step
Epoch 2/50
2262/2262 - 158s - loss: 3.2166 - accuracy100: 0.4101 - val_loss: 3.2985 - val_accuracy100: 0.3660 - 158s/epoch - 70ms/step
Epoch 3/50
2262/2262 - 155s - loss: 3.1958 - accuracy100: 0.4169 - val_loss: 3.2896 - val_accuracy100: 0.3689 - 155s/epoch - 68ms/step
Epoch 4/50
2262/2262 - 165s - loss: 3.1649 - accuracy100: 0.4316 - val_loss: 3.2095 - val_accuracy100: 0.4275 - 165s/epoch - 73ms/step
Epoch 5/50
2262/2262 - 154s - loss: 3.1220 - accuracy100: 0.4518 - val_loss: 3.1812 - val_accuracy100: 0.4442 - 154s/epoch - 68ms/step
Epoch 6/50
2262/2262 - 155s - loss: 3.0972 - accuracy100: 0.4599 - val_loss: 3.2006 - val_accuracy100: 0.4462 - 155s/epoch - 69ms/step
Epoch 7/50
2262/2262 - 156s - loss: 3.0843 - accuracy100: 0.4635 - val_loss: 3.1879 - val_accuracy100: 0.4450 - 156s/epoch - 69ms/step
Epoch 8/50
2262/2262 - 158s - loss: 3.0744 - accuracy100: 0.4658 - val_loss: 3.1899 - val_accuracy100: 0.4422 - 158s/epoch - 70ms/step
Epoch 9/50
2262/2262 - 165s - loss: 3.0657 - accuracy100: 0.4682 - val_loss: 3.2284 - val_accuracy100: 0.4381 - 165s/epoch - 73ms/step
Epoch 10/50
2262/2262 - 167s - loss: 3.0606 - accuracy100: 0.4701 - val_loss: 3.2465 - val_accuracy100: 0.4356 - 167s/epoch - 74ms/step
Epoch 11/50
2262/2262 - 153s - loss: 3.0549 - accuracy100: 0.4719 - val_loss: 3.2633 - val_accuracy100: 0.4368 - 153s/epoch - 68ms/step
Epoch 12/50
2262/2262 - 157s - loss: 3.0512 - accuracy100: 0.4733 - val_loss: 3.2557 - val_accuracy100: 0.4394 - 157s/epoch - 70ms/step
Epoch 13/50
2262/2262 - 150s - loss: 3.0470 - accuracy100: 0.4742 - val_loss: 3.2365 - val_accuracy100: 0.4405 - 150s/epoch - 66ms/step
Epoch 14/50
2262/2262 - 158s - loss: 3.0443 - accuracy100: 0.4752 - val_loss: 3.2478 - val_accuracy100: 0.4365 - 158s/epoch - 70ms/step
Epoch 15/50
2262/2262 - 155s - loss: 3.0410 - accuracy100: 0.4762 - val_loss: 3.2415 - val_accuracy100: 0.4392 - 155s/epoch - 69ms/step
testing model: results/AAL/W0/deepVOL_L3/h100
Evaluating performance on  test set...
6677/6677 - 232s - 232s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.97091234
{'0': {'precision': 0.5138152480975933, 'recall': 0.2695724548019833, 'f1-score': 0.3536191268555414, 'support': 449356}, '1': {'precision': 0.5491030786894375, 'recall': 0.8481390207661363, 'f1-score': 0.6666214074723247, 'support': 827790}, '2': {'precision': 0.4712828825871055, 'recall': 0.21259314111167676, 'f1-score': 0.29301073554082757, 'support': 432140}, 'accuracy': 0.535360963583625, 'macro avg': {'precision': 0.511400403124712, 'recall': 0.44343487222659883, 'f1-score': 0.4377504232895646, 'support': 1709286}, 'weighted avg': {'precision': 0.520151798478232, 'recall': 0.535360963583625, 'f1-score': 0.48988002623050064, 'support': 1709286}}
[[121134 287290  40932]
 [ 63575 702081  62134]
 [ 51045 289225  91870]]
Evaluating performance on  train set...
2262/2262 - 84s - 84s/epoch - 37ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0713556
{'0': {'precision': 0.46181385749880455, 'recall': 0.3769593442488239, 'f1-score': 0.41509444632960074, 'support': 194708}, '1': {'precision': 0.41194939993512814, 'recall': 0.665161807297695, 'f1-score': 0.5087924172286908, 'support': 190937}, '2': {'precision': 0.45720020429924463, 'recall': 0.2641157835890428, 'f1-score': 0.3348152328332059, 'support': 193188}, 'accuracy': 0.4343653523555153, 'macro avg': {'precision': 0.44365448724439244, 'recall': 0.43541231171185396, 'f1-score': 0.4195673654638325, 'support': 578833}, 'weighted avg': {'precision': 0.4438254698841519, 'recall': 0.4343653523555153, 'f1-score': 0.4192086360399629, 'support': 578833}}
[[ 73397  89017  32294]
 [ 35650 127004  28283]
 [ 49885  92279  51024]]
Evaluating performance on  val set...
827/827 - 29s - 29s/epoch - 35ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.060597
{'0': {'precision': 0.4513018322082932, 'recall': 0.36685795420931194, 'f1-score': 0.4047220839826063, 'support': 67612}, '1': {'precision': 0.43287719563519067, 'recall': 0.6796581331856131, 'f1-score': 0.5288973735258798, 'support': 75819}, '2': {'precision': 0.46861022364217253, 'recall': 0.2583329664039452, 'f1-score': 0.3330589537623116, 'support': 68133}, 'accuracy': 0.4440074870961033, 'macro avg': {'precision': 0.4509297504952188, 'recall': 0.4349496845996234, 'f1-score': 0.42222613709026596, 'support': 211564}, 'weighted avg': {'precision': 0.45027299513406716, 'recall': 0.4440074870961033, 'f1-score': 0.4261445482325832, 'support': 211564}}
[[24804 32849  9959]
 [14288 51531 10000]
 [15869 34663 17601]]
training model: results/AAL/W0/deepVOL_L3/h200
Epoch 1/50
2262/2262 - 165s - loss: 3.2871 - accuracy200: 0.3677 - val_loss: 3.2997 - val_accuracy200: 0.3635 - 165s/epoch - 73ms/step
Epoch 2/50
2262/2262 - 165s - loss: 3.2737 - accuracy200: 0.3715 - val_loss: 3.2880 - val_accuracy200: 0.3659 - 165s/epoch - 73ms/step
Epoch 3/50
2262/2262 - 169s - loss: 3.2568 - accuracy200: 0.3870 - val_loss: 3.2820 - val_accuracy200: 0.3707 - 169s/epoch - 75ms/step
Epoch 4/50
2262/2262 - 169s - loss: 3.2375 - accuracy200: 0.3978 - val_loss: 3.2968 - val_accuracy200: 0.3709 - 169s/epoch - 75ms/step
Epoch 5/50
2262/2262 - 168s - loss: 3.2293 - accuracy200: 0.4026 - val_loss: 3.2815 - val_accuracy200: 0.3731 - 168s/epoch - 74ms/step
Epoch 6/50
2262/2262 - 166s - loss: 3.2246 - accuracy200: 0.4053 - val_loss: 3.3022 - val_accuracy200: 0.3738 - 166s/epoch - 73ms/step
Epoch 7/50
2262/2262 - 168s - loss: 3.2175 - accuracy200: 0.4083 - val_loss: 3.2896 - val_accuracy200: 0.3768 - 168s/epoch - 74ms/step
Epoch 8/50
2262/2262 - 169s - loss: 3.2081 - accuracy200: 0.4133 - val_loss: 3.2808 - val_accuracy200: 0.3779 - 169s/epoch - 75ms/step
Epoch 9/50
2262/2262 - 167s - loss: 3.2017 - accuracy200: 0.4153 - val_loss: 3.2915 - val_accuracy200: 0.3758 - 167s/epoch - 74ms/step
Epoch 10/50
2262/2262 - 163s - loss: 3.1961 - accuracy200: 0.4177 - val_loss: 3.2839 - val_accuracy200: 0.3778 - 163s/epoch - 72ms/step
Epoch 11/50
2262/2262 - 169s - loss: 3.1899 - accuracy200: 0.4202 - val_loss: 3.2978 - val_accuracy200: 0.3814 - 169s/epoch - 75ms/step
Epoch 12/50
2262/2262 - 168s - loss: 3.1864 - accuracy200: 0.4215 - val_loss: 3.2877 - val_accuracy200: 0.3814 - 168s/epoch - 74ms/step
Epoch 13/50
2262/2262 - 167s - loss: 3.1819 - accuracy200: 0.4236 - val_loss: 3.2851 - val_accuracy200: 0.3830 - 167s/epoch - 74ms/step
Epoch 14/50
2262/2262 - 165s - loss: 3.1777 - accuracy200: 0.4255 - val_loss: 3.2957 - val_accuracy200: 0.3838 - 165s/epoch - 73ms/step
Epoch 15/50
2262/2262 - 165s - loss: 3.1732 - accuracy200: 0.4267 - val_loss: 3.2944 - val_accuracy200: 0.3839 - 165s/epoch - 73ms/step
Epoch 16/50
2262/2262 - 164s - loss: 3.1690 - accuracy200: 0.4289 - val_loss: 3.3182 - val_accuracy200: 0.3851 - 164s/epoch - 73ms/step
Epoch 17/50
2262/2262 - 157s - loss: 3.1660 - accuracy200: 0.4299 - val_loss: 3.3202 - val_accuracy200: 0.3840 - 157s/epoch - 70ms/step
Epoch 18/50
2262/2262 - 162s - loss: 3.1615 - accuracy200: 0.4326 - val_loss: 3.3298 - val_accuracy200: 0.3835 - 162s/epoch - 71ms/step
testing model: results/AAL/W0/deepVOL_L3/h200
Evaluating performance on  test set...
6677/6677 - 236s - 236s/epoch - 35ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0564878
{'0': {'precision': 0.4087102007018115, 'recall': 0.2409826355956283, 'f1-score': 0.3031957745486038, 'support': 499758}, '1': {'precision': 0.4470841211294672, 'recall': 0.7719284866631614, 'f1-score': 0.5662237893659398, 'support': 747441}, '2': {'precision': 0.35551974214343274, 'recall': 0.09547985552504182, 'f1-score': 0.15053216806241013, 'support': 462087}, 'accuracy': 0.4338209053370823, 'macro avg': {'precision': 0.40377135465823716, 'recall': 0.36946365926127717, 'f1-score': 0.3399839106589846, 'support': 1709286}, 'weighted avg': {'precision': 0.41111098210088803, 'recall': 0.4338209053370823, 'f1-score': 0.37694238833511967, 'support': 1709286}}
[[120433 353827  25498]
 [115988 576971  54482]
 [ 58245 359722  44120]]
Evaluating performance on  train set...
2262/2262 - 89s - 89s/epoch - 39ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0983417
{'0': {'precision': 0.40341692676199464, 'recall': 0.2311795810347786, 'f1-score': 0.29392458031314145, 'support': 192331}, '1': {'precision': 0.34643112600233406, 'recall': 0.747546443676095, 'f1-score': 0.4734527716100693, 'support': 196959}, '2': {'precision': 0.41259831686119836, 'recall': 0.09492832760903858, 'f1-score': 0.15434566291517982, 'support': 189543}, 'accuracy': 0.3622668368942337, 'macro avg': {'precision': 0.38748212320850905, 'recall': 0.35788478410663743, 'f1-score': 0.3072410049461302, 'support': 578833}, 'weighted avg': {'precision': 0.3870329298090762, 'recall': 0.3622668368942337, 'f1-score': 0.30930636796051086, 'support': 578833}}
[[ 44463 136240  11628]
 [ 35735 147236  13988]
 [ 30018 141532  17993]]
Evaluating performance on  val set...
827/827 - 33s - 33s/epoch - 40ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0918064
{'0': {'precision': 0.3871329047288367, 'recall': 0.2601848785041101, 'f1-score': 0.3112107542565931, 'support': 66422}, '1': {'precision': 0.3707712946114306, 'recall': 0.7202662779146723, 'f1-score': 0.4895414549456138, 'support': 77513}, '2': {'precision': 0.41945549097583357, 'recall': 0.10137662836948647, 'f1-score': 0.16328863695905876, 'support': 67629}, 'accuracy': 0.3779849123669433, 'macro avg': {'precision': 0.3924532301053669, 'recall': 0.36060926159608964, 'f1-score': 0.3213469487204219, 'support': 211564}, 'weighted avg': {'precision': 0.3914706309027966, 'recall': 0.3779849123669433, 'f1-score': 0.3292626096374382, 'support': 211564}}
[[17282 45280  3860]
 [16054 55830  5629]
 [11305 49468  6856]]
training model: results/AAL/W0/deepVOL_L3/h300
Epoch 1/50
2262/2262 - 164s - loss: 3.2951 - accuracy300: 0.3600 - val_loss: 3.3029 - val_accuracy300: 0.3413 - 164s/epoch - 72ms/step
Epoch 2/50
2262/2262 - 155s - loss: 3.2850 - accuracy300: 0.3626 - val_loss: 3.2943 - val_accuracy300: 0.3456 - 155s/epoch - 69ms/step
Epoch 3/50
2262/2262 - 158s - loss: 3.2783 - accuracy300: 0.3687 - val_loss: 3.2901 - val_accuracy300: 0.3516 - 158s/epoch - 70ms/step
Epoch 4/50
2262/2262 - 168s - loss: 3.2693 - accuracy300: 0.3777 - val_loss: 3.2918 - val_accuracy300: 0.3570 - 168s/epoch - 74ms/step
Epoch 5/50
2262/2262 - 167s - loss: 3.2645 - accuracy300: 0.3827 - val_loss: 3.2879 - val_accuracy300: 0.3557 - 167s/epoch - 74ms/step
Epoch 6/50
2262/2262 - 157s - loss: 3.2595 - accuracy300: 0.3874 - val_loss: 3.2849 - val_accuracy300: 0.3589 - 157s/epoch - 69ms/step
Epoch 7/50
2262/2262 - 157s - loss: 3.2539 - accuracy300: 0.3922 - val_loss: 3.2859 - val_accuracy300: 0.3576 - 157s/epoch - 69ms/step
Epoch 8/50
2262/2262 - 158s - loss: 3.2483 - accuracy300: 0.3956 - val_loss: 3.2870 - val_accuracy300: 0.3588 - 158s/epoch - 70ms/step
Epoch 9/50
2262/2262 - 158s - loss: 3.2429 - accuracy300: 0.3990 - val_loss: 3.3007 - val_accuracy300: 0.3561 - 158s/epoch - 70ms/step
Epoch 10/50
2262/2262 - 156s - loss: 3.2376 - accuracy300: 0.4013 - val_loss: 3.3181 - val_accuracy300: 0.3547 - 156s/epoch - 69ms/step
Epoch 11/50
2262/2262 - 156s - loss: 3.2357 - accuracy300: 0.4032 - val_loss: 3.3062 - val_accuracy300: 0.3574 - 156s/epoch - 69ms/step
Epoch 12/50
2262/2262 - 157s - loss: 3.2291 - accuracy300: 0.4070 - val_loss: 3.3025 - val_accuracy300: 0.3564 - 157s/epoch - 69ms/step
Epoch 13/50
2262/2262 - 156s - loss: 3.2241 - accuracy300: 0.4090 - val_loss: 3.2981 - val_accuracy300: 0.3559 - 156s/epoch - 69ms/step
Epoch 14/50
2262/2262 - 155s - loss: 3.2179 - accuracy300: 0.4119 - val_loss: 3.3064 - val_accuracy300: 0.3563 - 155s/epoch - 69ms/step
Epoch 15/50
2262/2262 - 154s - loss: 3.2119 - accuracy300: 0.4152 - val_loss: 3.3194 - val_accuracy300: 0.3549 - 154s/epoch - 68ms/step
Epoch 16/50
2262/2262 - 155s - loss: 3.2072 - accuracy300: 0.4163 - val_loss: 3.3249 - val_accuracy300: 0.3529 - 155s/epoch - 68ms/step
testing model: results/AAL/W0/deepVOL_L3/h300
Evaluating performance on  test set...
6677/6677 - 238s - 238s/epoch - 36ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0837151
{'0': {'precision': 0.41104186185452224, 'recall': 0.2234875260930472, 'f1-score': 0.28954601810858216, 'support': 541811}, '1': {'precision': 0.39905573036138675, 'recall': 0.5521747871143075, 'f1-score': 0.4632915132785856, 'support': 681469}, '2': {'precision': 0.32626810557353836, 'recall': 0.316695678654173, 'f1-score': 0.32141063510111684, 'support': 486006}, 'accuracy': 0.381032782109021, 'macro avg': {'precision': 0.3787885659298158, 'recall': 0.3641193306205092, 'f1-score': 0.35808272216276155, 'support': 1709286}, 'weighted avg': {'precision': 0.3821591990130835, 'recall': 0.381032782109021, 'f1-score': 0.36787613015190374, 'support': 1709286}}
[[121088 301115 119608]
 [106956 376290 198223]
 [ 66544 265546 153916]]
Evaluating performance on  train set...
2262/2262 - 82s - 82s/epoch - 36ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977045
{'0': {'precision': 0.4047550432276657, 'recall': 0.18459804164412924, 'f1-score': 0.25355594207728815, 'support': 197819}, '1': {'precision': 0.3205662397969744, 'recall': 0.5711147809077937, 'f1-score': 0.4106403827309931, 'support': 187113}, '2': {'precision': 0.3775441850878549, 'recall': 0.3022985956751126, 'f1-score': 0.335757266788293, 'support': 193901}, 'accuracy': 0.3489711194766021, 'macro avg': {'precision': 0.367621822704165, 'recall': 0.35267047274234514, 'f1-score': 0.33331786386552475, 'support': 578833}, 'weighted avg': {'precision': 0.3684249926249972, 'recall': 0.3489711194766021, 'f1-score': 0.33187120745922943, 'support': 578833}}
[[ 36517 115832  45470]
 [ 29080 106863  51170]
 [ 24623 110662  58616]]
Evaluating performance on  val set...
827/827 - 30s - 30s/epoch - 36ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0950569
{'0': {'precision': 0.3846944693414878, 'recall': 0.21325442057577085, 'f1-score': 0.27439735248768377, 'support': 68430}, '1': {'precision': 0.3418797691540955, 'recall': 0.5604668726398901, 'f1-score': 0.4246977295902441, 'support': 72825}, '2': {'precision': 0.37608539350699627, 'recall': 0.290147776244862, 'f1-score': 0.32757402530669927, 'support': 70309}, 'accuracy': 0.35832655839367755, 'macro avg': {'precision': 0.36755321066752655, 'recall': 0.3546230231535077, 'f1-score': 0.3422230357948757, 'support': 211564}, 'weighted avg': {'precision': 0.3670956526524759, 'recall': 0.35832655839367755, 'f1-score': 0.34380624838550244, 'support': 211564}}
[[14593 38735 15102]
 [13268 40816 18741]
 [10073 39836 20400]]
training model: results/AAL/W0/deepVOL_L3/h500
Epoch 1/50
2262/2262 - 164s - loss: 3.1893 - accuracy500: 0.4238 - val_loss: 3.3362 - val_accuracy500: 0.4312 - 164s/epoch - 73ms/step
Epoch 2/50
2262/2262 - 159s - loss: 3.2070 - accuracy500: 0.4158 - val_loss: 3.3320 - val_accuracy500: 0.4312 - 159s/epoch - 70ms/step
Epoch 3/50
2262/2262 - 157s - loss: 3.2209 - accuracy500: 0.4126 - val_loss: 3.3497 - val_accuracy500: 0.4312 - 157s/epoch - 69ms/step
Epoch 4/50
2262/2262 - 161s - loss: 3.1960 - accuracy500: 0.4247 - val_loss: 3.3233 - val_accuracy500: 0.4312 - 161s/epoch - 71ms/step
Epoch 5/50
2262/2262 - 159s - loss: 3.2101 - accuracy500: 0.4200 - val_loss: 3.3213 - val_accuracy500: 0.4312 - 159s/epoch - 70ms/step
Epoch 6/50
2262/2262 - 157s - loss: 3.2297 - accuracy500: 0.4130 - val_loss: 3.3322 - val_accuracy500: 0.4312 - 157s/epoch - 70ms/step
Epoch 7/50
2262/2262 - 158s - loss: 3.2249 - accuracy500: 0.4174 - val_loss: 3.3311 - val_accuracy500: 0.4312 - 158s/epoch - 70ms/step
Epoch 8/50
2262/2262 - 158s - loss: 3.2213 - accuracy500: 0.4131 - val_loss: 3.3526 - val_accuracy500: 0.4312 - 158s/epoch - 70ms/step
Epoch 9/50
2262/2262 - 156s - loss: 3.2093 - accuracy500: 0.4235 - val_loss: 3.3362 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 10/50
2262/2262 - 158s - loss: 3.2100 - accuracy500: 0.4239 - val_loss: 3.3238 - val_accuracy500: 0.4312 - 158s/epoch - 70ms/step
Epoch 11/50
2262/2262 - 157s - loss: 3.2128 - accuracy500: 0.4241 - val_loss: 3.3269 - val_accuracy500: 0.4312 - 157s/epoch - 70ms/step
Epoch 12/50
2262/2262 - 155s - loss: 3.2092 - accuracy500: 0.4264 - val_loss: 3.3169 - val_accuracy500: 0.4312 - 155s/epoch - 69ms/step
Epoch 13/50
2262/2262 - 156s - loss: 3.1918 - accuracy500: 0.4286 - val_loss: 3.3236 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 14/50
2262/2262 - 156s - loss: 3.1868 - accuracy500: 0.4313 - val_loss: 3.3257 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 15/50
2262/2262 - 157s - loss: 3.1851 - accuracy500: 0.4320 - val_loss: 3.3376 - val_accuracy500: 0.4312 - 157s/epoch - 69ms/step
Epoch 16/50
2262/2262 - 156s - loss: 3.1839 - accuracy500: 0.4332 - val_loss: 3.3297 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 17/50
2262/2262 - 154s - loss: 3.1799 - accuracy500: 0.4349 - val_loss: 3.3306 - val_accuracy500: 0.4312 - 154s/epoch - 68ms/step
Epoch 18/50
2262/2262 - 156s - loss: 3.1735 - accuracy500: 0.4370 - val_loss: 3.3332 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 19/50
2262/2262 - 159s - loss: 3.1685 - accuracy500: 0.4387 - val_loss: 3.3400 - val_accuracy500: 0.4312 - 159s/epoch - 70ms/step
Epoch 20/50
2262/2262 - 156s - loss: 3.1563 - accuracy500: 0.4428 - val_loss: 3.3513 - val_accuracy500: 0.4312 - 156s/epoch - 69ms/step
Epoch 21/50
2262/2262 - 157s - loss: 3.1516 - accuracy500: 0.4448 - val_loss: 3.3485 - val_accuracy500: 0.4311 - 157s/epoch - 70ms/step
Epoch 22/50
2262/2262 - 157s - loss: 3.1485 - accuracy500: 0.4468 - val_loss: 3.3220 - val_accuracy500: 0.4312 - 157s/epoch - 69ms/step
testing model: results/AAL/W0/deepVOL_L3/h500
Evaluating performance on  test set...
6677/6677 - 239s - 239s/epoch - 36ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0757486
{'0': {'precision': 0.23655913978494625, 'recall': 4.648450375679308e-05, 'f1-score': 9.295074244405527e-05, 'support': 473276}, '1': {'precision': 0.468687269372154, 'recall': 0.99995506251927, 'f1-score': 0.6382305583462732, 'support': 801113}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 434897}, 'accuracy': 0.4686746395863536, 'macro avg': {'precision': 0.23508213638570008, 'recall': 0.3333338490076756, 'f1-score': 0.21277450302957243, 'support': 1709286}, 'weighted avg': {'precision': 0.28516540114959965, 'recall': 0.4686746395863536, 'f1-score': 0.29915344105318764, 'support': 1709286}}
[[    22 473254      0]
 [    36 801077      0]
 [    35 434862      0]]
Evaluating performance on  train set...
2262/2262 - 80s - 80s/epoch - 35ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1775453
{'0': {'precision': 0.5, 'recall': 8.294883093991394e-05, 'f1-score': 0.00016587014441069446, 'support': 192890}, '1': {'precision': 0.33987214927436077, 'recall': 0.9999542513228993, 'f1-score': 0.5073143810595893, 'support': 196727}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 189216}, 'accuracy': 0.33988041455825774, 'macro avg': {'precision': 0.2799573830914536, 'recall': 0.33334573338461304, 'f1-score': 0.16916008373466665, 'support': 578833}, 'weighted avg': {'precision': 0.28213150996971004, 'recall': 0.33988041455825774, 'f1-score': 0.17247536152027473, 'support': 578833}}
[[    16 192873      1]
 [     9 196718      0]
 [     7 189209      0]]
Evaluating performance on  val set...
827/827 - 27s - 27s/epoch - 32ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1025348
{'0': {'precision': 0.3333333333333333, 'recall': 1.7080294464276563e-05, 'f1-score': 3.4158838599487615e-05, 'support': 58547}, '1': {'precision': 0.43115697127542413, 'recall': 0.9999890371312365, 'f1-score': 0.6025272642001731, 'support': 91217}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 61800}, 'accuracy': 0.4311555841258437, 'macro avg': {'precision': 0.25483010153625246, 'recall': 0.33333537247523365, 'f1-score': 0.20085380767959085, 'support': 211564}, 'weighted avg': {'precision': 0.27814047813189874, 'recall': 0.4311555841258437, 'f1-score': 0.2597924474677671, 'support': 211564}}
[[    1 58546     0]
 [    1 91216     0]
 [    1 61799     0]]
training model: results/AAL/W0/deepVOL_L3/h1000
Epoch 1/50
2262/2262 - 161s - loss: 3.2462 - accuracy1000: 0.4007 - val_loss: 3.3280 - val_accuracy1000: 0.3580 - 161s/epoch - 71ms/step
Epoch 2/50
2262/2262 - 157s - loss: 3.2515 - accuracy1000: 0.3929 - val_loss: 3.3364 - val_accuracy1000: 0.3560 - 157s/epoch - 69ms/step
Epoch 3/50
2262/2262 - 162s - loss: 3.2372 - accuracy1000: 0.4038 - val_loss: 3.3461 - val_accuracy1000: 0.3580 - 162s/epoch - 72ms/step
Epoch 4/50
2262/2262 - 156s - loss: 3.2416 - accuracy1000: 0.4027 - val_loss: 3.3409 - val_accuracy1000: 0.3554 - 156s/epoch - 69ms/step
Epoch 5/50
2262/2262 - 156s - loss: 3.2494 - accuracy1000: 0.3903 - val_loss: 3.3391 - val_accuracy1000: 0.3515 - 156s/epoch - 69ms/step
Epoch 6/50
2262/2262 - 157s - loss: 3.2402 - accuracy1000: 0.4005 - val_loss: 3.3346 - val_accuracy1000: 0.3572 - 157s/epoch - 69ms/step
Epoch 7/50
2262/2262 - 161s - loss: 3.2284 - accuracy1000: 0.4076 - val_loss: 3.3464 - val_accuracy1000: 0.3581 - 161s/epoch - 71ms/step
Epoch 8/50
2262/2262 - 159s - loss: 3.2176 - accuracy1000: 0.4119 - val_loss: 3.3401 - val_accuracy1000: 0.3558 - 159s/epoch - 70ms/step
Epoch 9/50
2262/2262 - 158s - loss: 3.1893 - accuracy1000: 0.4244 - val_loss: 3.3502 - val_accuracy1000: 0.3510 - 158s/epoch - 70ms/step
Epoch 10/50
2262/2262 - 158s - loss: 3.1708 - accuracy1000: 0.4317 - val_loss: 3.3705 - val_accuracy1000: 0.3423 - 158s/epoch - 70ms/step
Epoch 11/50
2262/2262 - 156s - loss: 3.1620 - accuracy1000: 0.4368 - val_loss: 3.3719 - val_accuracy1000: 0.3428 - 156s/epoch - 69ms/step
testing model: results/AAL/W0/deepVOL_L3/h1000
Evaluating performance on  test set...
6677/6677 - 236s - 236s/epoch - 35ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0617425
{'0': {'precision': 0.3454692556634304, 'recall': 0.0009320559582823104, 'f1-score': 0.0018590961831928127, 'support': 458127}, '1': {'precision': 0.4914461286207216, 'recall': 0.9519274085326354, 'f1-score': 0.6482328068366328, 'support': 841311}, '2': {'precision': 0.2210053928630621, 'recall': 0.04229616833557807, 'f1-score': 0.07100361469223916, 'support': 409848}, 'accuracy': 0.47893038379767927, 'macro avg': {'precision': 0.35264025904907137, 'recall': 0.3317185442754986, 'f1-score': 0.24036517257068823, 'support': 1709286}, 'weighted avg': {'precision': 0.3874754990443311, 'recall': 0.47893038379767927, 'f1-score': 0.3365836861613778, 'support': 1709286}}
[[   427 436474  21226]
 [   568 800867  39876]
 [   241 392272  17335]]
Evaluating performance on  train set...
2262/2262 - 82s - 82s/epoch - 36ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1166404
{'0': {'precision': 0.3333333333333333, 'recall': 0.0007962565600682505, 'f1-score': 0.0015887180386553667, 'support': 193405}, '1': {'precision': 0.33722495005678044, 'recall': 0.9544830061003742, 'f1-score': 0.49837191530479924, 'support': 195070}, '2': {'precision': 0.34766041761926536, 'recall': 0.04793074102480589, 'f1-score': 0.08424668285611399, 'support': 190358}, 'accuracy': 0.3376949828361548, 'macro avg': {'precision': 0.339406233669793, 'recall': 0.3344033345617494, 'f1-score': 0.19473577206652284, 'support': 578833}, 'weighted avg': {'precision': 0.33935650890339286, 'recall': 0.3376949828361548, 'f1-score': 0.19619079352057933, 'support': 578833}}
[[   154 184865   8386]
 [   145 186191   8734]
 [   163 181071   9124]]
Evaluating performance on  val set...
827/827 - 28s - 28s/epoch - 34ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1079789
{'0': {'precision': 0.20930232558139536, 'recall': 0.0005474868831267584, 'f1-score': 0.0010921170385426303, 'support': 65755}, '1': {'precision': 0.3597290986904133, 'recall': 0.9608411892675852, 'f1-score': 0.5234746505380206, 'support': 75845}, '2': {'precision': 0.34680440458621864, 'recall': 0.043665313589846204, 'f1-score': 0.0775646477854087, 'support': 69964}, 'accuracy': 0.35906865062108867, 'macro avg': {'precision': 0.30527860961934244, 'recall': 0.33501799658018605, 'f1-score': 0.20071047178732396, 'support': 211564}, 'weighted avg': {'precision': 0.3087016282129722, 'recall': 0.35906865062108867, 'f1-score': 0.2136539299861218, 'support': 211564}}
[[   36 62854  2865]
 [   81 72875  2889]
 [   55 66854  3055]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        33 (peak)  20.61 (ave)

============================================
