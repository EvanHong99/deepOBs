This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-13.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-05.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-20.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-21.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-01.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-25.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-27.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-22.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-15.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-26.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-11.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-28.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-02-19.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-07.csv
data/PCAR_orderbooks/PCAR_orderbooks_2019-03-06.csv
training model: results/PCAR/W1/deepLOB_L1/h10
Epoch 1/50
722/722 - 38s - loss: 3.1736 - accuracy10: 0.4345 - val_loss: 3.3275 - val_accuracy10: 0.4023 - 38s/epoch - 53ms/step
Epoch 2/50
722/722 - 11s - loss: 3.0949 - accuracy10: 0.4624 - val_loss: 3.2350 - val_accuracy10: 0.4282 - 11s/epoch - 16ms/step
Epoch 3/50
722/722 - 11s - loss: 3.0304 - accuracy10: 0.4828 - val_loss: 3.2384 - val_accuracy10: 0.4370 - 11s/epoch - 16ms/step
Epoch 4/50
722/722 - 11s - loss: 3.0014 - accuracy10: 0.4913 - val_loss: 3.2717 - val_accuracy10: 0.4292 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 2.9777 - accuracy10: 0.4974 - val_loss: 3.3476 - val_accuracy10: 0.4275 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 2.9606 - accuracy10: 0.5029 - val_loss: 3.3413 - val_accuracy10: 0.4282 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 2.9498 - accuracy10: 0.5051 - val_loss: 3.3683 - val_accuracy10: 0.4259 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 2.9396 - accuracy10: 0.5074 - val_loss: 3.3817 - val_accuracy10: 0.4291 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 2.9293 - accuracy10: 0.5111 - val_loss: 3.3643 - val_accuracy10: 0.4359 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 2.9226 - accuracy10: 0.5133 - val_loss: 3.3479 - val_accuracy10: 0.4360 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 2.9164 - accuracy10: 0.5149 - val_loss: 3.3494 - val_accuracy10: 0.4392 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 2.9093 - accuracy10: 0.5160 - val_loss: 3.3555 - val_accuracy10: 0.4415 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h10
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067254
{'0': {'precision': 0.46040380623770116, 'recall': 0.3709891828489509, 'f1-score': 0.4108883141877669, 'support': 230190}, '1': {'precision': 0.43285826359832635, 'recall': 0.24527559237426663, 'f1-score': 0.3131227443759034, 'support': 215953}, '2': {'precision': 0.4065971362519787, 'recall': 0.6608295014219895, 'f1-score': 0.5034376571574227, 'support': 221169}, 'accuracy': 0.426368775025775, 'macro avg': {'precision': 0.43328640202933544, 'recall': 0.42569809221506905, 'f1-score': 0.409149571907031, 'support': 667312}, 'weighted avg': {'precision': 0.4336563328464342, 'recall': 0.426368775025775, 'f1-score': 0.4099236642753937, 'support': 667312}}
[[ 85398  35644 109148]
 [ 58829  52968 104156]
 [ 41258  33756 146155]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.056283
{'0': {'precision': 0.4281017898453671, 'recall': 0.32124257651895843, 'f1-score': 0.36705292828061387, 'support': 54725}, '1': {'precision': 0.46449153293731715, 'recall': 0.41577715170032936, 'f1-score': 0.43878640675056013, 'support': 75603}, '2': {'precision': 0.37207832396202317, 'recall': 0.5198704739476008, 'f1-score': 0.43373013131941085, 'support': 54352}, 'accuracy': 0.41839939354559236, 'macro avg': {'precision': 0.42155721558156917, 'recall': 0.4189634007222962, 'f1-score': 0.41318982211686156, 'support': 184680}, 'weighted avg': {'precision': 0.42651085595587823, 'recall': 0.41839939354559236, 'f1-score': 0.41604202029018744, 'support': 184680}}
[[17580 19876 17269]
 [13753 31434 30416]
 [ 9732 16364 28256]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0562536
{'0': {'precision': 0.4583878491381762, 'recall': 0.42911918202151456, 'f1-score': 0.4432708969386913, 'support': 18778}, '1': {'precision': 0.4268061417997186, 'recall': 0.33878799650383606, 'f1-score': 0.37773747326818435, 'support': 20594}, '2': {'precision': 0.4096848895872963, 'recall': 0.528768146883006, 'f1-score': 0.4616710937135934, 'support': 18736}, 'accuracy': 0.4292352171817994, 'macro avg': {'precision': 0.43162629350839704, 'recall': 0.4322251084694522, 'f1-score': 0.427559821306823, 'support': 58108}, 'weighted avg': {'precision': 0.43149151247070394, 'recall': 0.4292352171817994, 'f1-score': 0.425978110398183, 'support': 58108}}
[[8058 4688 6032]
 [5374 6977 8243]
 [4147 4682 9907]]
training model: results/PCAR/W1/deepLOB_L1/h20
Epoch 1/50
722/722 - 13s - loss: 3.2115 - accuracy20: 0.4226 - val_loss: 3.2684 - val_accuracy20: 0.3864 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.1304 - accuracy20: 0.4563 - val_loss: 3.2969 - val_accuracy20: 0.3580 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.0861 - accuracy20: 0.4735 - val_loss: 3.3158 - val_accuracy20: 0.3697 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.0669 - accuracy20: 0.4786 - val_loss: 3.3697 - val_accuracy20: 0.3570 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.0481 - accuracy20: 0.4850 - val_loss: 3.3308 - val_accuracy20: 0.3766 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.0382 - accuracy20: 0.4871 - val_loss: 3.2703 - val_accuracy20: 0.3974 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.0264 - accuracy20: 0.4905 - val_loss: 3.3263 - val_accuracy20: 0.3741 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.0193 - accuracy20: 0.4926 - val_loss: 3.2758 - val_accuracy20: 0.3977 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.0137 - accuracy20: 0.4939 - val_loss: 3.2386 - val_accuracy20: 0.4170 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.0070 - accuracy20: 0.4950 - val_loss: 3.2085 - val_accuracy20: 0.4323 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.0004 - accuracy20: 0.4972 - val_loss: 3.2410 - val_accuracy20: 0.4166 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 2.9957 - accuracy20: 0.4987 - val_loss: 3.2296 - val_accuracy20: 0.4146 - 11s/epoch - 15ms/step
Epoch 13/50
722/722 - 11s - loss: 2.9903 - accuracy20: 0.5004 - val_loss: 3.2222 - val_accuracy20: 0.4239 - 11s/epoch - 15ms/step
Epoch 14/50
722/722 - 11s - loss: 2.9865 - accuracy20: 0.5013 - val_loss: 3.2203 - val_accuracy20: 0.4246 - 11s/epoch - 15ms/step
Epoch 15/50
722/722 - 11s - loss: 2.9810 - accuracy20: 0.5032 - val_loss: 3.2229 - val_accuracy20: 0.4242 - 11s/epoch - 15ms/step
Epoch 16/50
722/722 - 11s - loss: 2.9769 - accuracy20: 0.5039 - val_loss: 3.2100 - val_accuracy20: 0.4332 - 11s/epoch - 15ms/step
Epoch 17/50
722/722 - 11s - loss: 2.9733 - accuracy20: 0.5041 - val_loss: 3.2082 - val_accuracy20: 0.4333 - 11s/epoch - 15ms/step
Epoch 18/50
722/722 - 11s - loss: 2.9698 - accuracy20: 0.5059 - val_loss: 3.2338 - val_accuracy20: 0.4180 - 11s/epoch - 15ms/step
Epoch 19/50
722/722 - 11s - loss: 2.9667 - accuracy20: 0.5066 - val_loss: 3.2380 - val_accuracy20: 0.4201 - 11s/epoch - 15ms/step
Epoch 20/50
722/722 - 11s - loss: 2.9616 - accuracy20: 0.5087 - val_loss: 3.2278 - val_accuracy20: 0.4254 - 11s/epoch - 15ms/step
Epoch 21/50
722/722 - 11s - loss: 2.9579 - accuracy20: 0.5095 - val_loss: 3.2246 - val_accuracy20: 0.4300 - 11s/epoch - 15ms/step
Epoch 22/50
722/722 - 11s - loss: 2.9534 - accuracy20: 0.5101 - val_loss: 3.2386 - val_accuracy20: 0.4175 - 11s/epoch - 16ms/step
Epoch 23/50
722/722 - 11s - loss: 2.9506 - accuracy20: 0.5101 - val_loss: 3.2473 - val_accuracy20: 0.4159 - 11s/epoch - 15ms/step
Epoch 24/50
722/722 - 11s - loss: 2.9474 - accuracy20: 0.5110 - val_loss: 3.2371 - val_accuracy20: 0.4254 - 11s/epoch - 15ms/step
Epoch 25/50
722/722 - 11s - loss: 2.9444 - accuracy20: 0.5124 - val_loss: 3.2510 - val_accuracy20: 0.4182 - 11s/epoch - 15ms/step
Epoch 26/50
722/722 - 11s - loss: 2.9416 - accuracy20: 0.5127 - val_loss: 3.2556 - val_accuracy20: 0.4206 - 11s/epoch - 15ms/step
Epoch 27/50
722/722 - 11s - loss: 2.9368 - accuracy20: 0.5137 - val_loss: 3.2646 - val_accuracy20: 0.4155 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h20
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0825486
{'0': {'precision': 0.49546699324726573, 'recall': 0.45892315569734926, 'f1-score': 0.4764954381315765, 'support': 253890}, '1': {'precision': 0.3185836544589052, 'recall': 0.44982910008816746, 'f1-score': 0.3729979694897686, 'support': 165594}, '2': {'precision': 0.4982983336274485, 'recall': 0.3987846409606663, 'f1-score': 0.4430219448945789, 'support': 247828}, 'accuracy': 0.43433206655957035, 'macro avg': {'precision': 0.43744966044453976, 'recall': 0.4358456322487277, 'f1-score': 0.43083845083864136, 'support': 667312}, 'weighted avg': {'precision': 0.45262476325652706, 'recall': 0.43433206655957035, 'f1-score': 0.43838098986118695, 'support': 667312}}
[[116516  76303  61071]
 [ 52671  74489  38434]
 [ 65977  83021  98830]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0489857
{'0': {'precision': 0.4865811398658114, 'recall': 0.42540368066522705, 'f1-score': 0.453940467387753, 'support': 62054}, '1': {'precision': 0.40627013601696405, 'recall': 0.5732658863982014, 'f1-score': 0.4755329141783626, 'support': 60492}, '2': {'precision': 0.4892502939806084, 'recall': 0.35489426079119324, 'f1-score': 0.4113800662282543, 'support': 62134}, 'accuracy': 0.4501137102014295, 'macro avg': {'precision': 0.4607005232877946, 'recall': 0.4511879426182072, 'f1-score': 0.44695114926478996, 'support': 184680}, 'weighted avg': {'precision': 0.461173255833671, 'recall': 0.4501137102014295, 'f1-score': 0.4466939995818902, 'support': 184680}}
[[26398 24162 11494]
 [14288 34678 11526]
 [13566 26517 22051]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0719825
{'0': {'precision': 0.5040086090933549, 'recall': 0.44009584664536744, 'f1-score': 0.469888886101984, 'support': 21284}, '1': {'precision': 0.33578792341678937, 'recall': 0.49426166794185156, 'f1-score': 0.3998968274438999, 'support': 15684}, '2': {'precision': 0.49078298959664174, 'recall': 0.3815988647114475, 'f1-score': 0.42935838411794447, 'support': 21140}, 'accuracy': 0.4334342947614786, 'macro avg': {'precision': 0.4435265073689287, 'recall': 0.4386521264328888, 'f1-score': 0.4330480325546095, 'support': 58108}, 'weighted avg': {'precision': 0.45379241114622587, 'recall': 0.4334342947614786, 'f1-score': 0.4362520330019636, 'support': 58108}}
[[9367 7215 4702]
 [4264 7752 3668]
 [4954 8119 8067]]
training model: results/PCAR/W1/deepLOB_L1/h30
Epoch 1/50
722/722 - 13s - loss: 3.2468 - accuracy30: 0.4085 - val_loss: 3.3016 - val_accuracy30: 0.3658 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.1979 - accuracy30: 0.4296 - val_loss: 3.4089 - val_accuracy30: 0.3364 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.1631 - accuracy30: 0.4427 - val_loss: 3.4379 - val_accuracy30: 0.3183 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.1394 - accuracy30: 0.4502 - val_loss: 3.3917 - val_accuracy30: 0.3254 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.1249 - accuracy30: 0.4561 - val_loss: 3.4279 - val_accuracy30: 0.3289 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.1131 - accuracy30: 0.4611 - val_loss: 3.4287 - val_accuracy30: 0.3191 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.1070 - accuracy30: 0.4622 - val_loss: 3.4037 - val_accuracy30: 0.3286 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.0983 - accuracy30: 0.4647 - val_loss: 3.4004 - val_accuracy30: 0.3448 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.0928 - accuracy30: 0.4677 - val_loss: 3.3889 - val_accuracy30: 0.3484 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.0866 - accuracy30: 0.4686 - val_loss: 3.3863 - val_accuracy30: 0.3505 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.0840 - accuracy30: 0.4692 - val_loss: 3.3866 - val_accuracy30: 0.3496 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h30
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1089933
{'0': {'precision': 0.4103277071055089, 'recall': 0.31588118457982833, 'f1-score': 0.3569628619820713, 'support': 246197}, '1': {'precision': 0.2860281118929599, 'recall': 0.3689526045159848, 'f1-score': 0.32224098879212715, 'support': 178920}, '2': {'precision': 0.40097817329376373, 'recall': 0.40891843349367246, 'f1-score': 0.40490938007220156, 'support': 242195}, 'accuracy': 0.3638777663222001, 'macro avg': {'precision': 0.36577799743074424, 'recall': 0.3645840741964952, 'f1-score': 0.36137107694880005, 'support': 667312}, 'weighted avg': {'precision': 0.3736071117663499, 'recall': 0.3638777663222001, 'f1-score': 0.36505498290555877, 'support': 667312}}
[[77769 82786 85642]
 [50596 66013 62311]
 [61164 81993 99038]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1135862
{'0': {'precision': 0.3941419304108512, 'recall': 0.29155625929037676, 'f1-score': 0.335175296029719, 'support': 61892}, '1': {'precision': 0.3373158913692227, 'recall': 0.5208257638315442, 'f1-score': 0.4094494322939996, 'support': 60550}, '2': {'precision': 0.3643351098973704, 'recall': 0.2658022430026672, 'f1-score': 0.30736501802237004, 'support': 62238}, 'accuracy': 0.3580463504440113, 'macro avg': {'precision': 0.36526431055914815, 'recall': 0.3593947553748627, 'f1-score': 0.3506632487820296, 'support': 184680}, 'weighted avg': {'precision': 0.36546566032698385, 'recall': 0.3580463504440113, 'f1-score': 0.35015495201943536, 'support': 184680}}
[[18045 30967 12880]
 [13031 31536 15983]
 [14707 30988 16543]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1024066
{'0': {'precision': 0.42237838372841097, 'recall': 0.40360334799262304, 'f1-score': 0.4127774822266286, 'support': 21147}, '1': {'precision': 0.28650733112975674, 'recall': 0.4209838107098381, 'f1-score': 0.340965252912401, 'support': 16060}, '2': {'precision': 0.4141788435992449, 'recall': 0.2834314147648438, 'f1-score': 0.3365526644699466, 'support': 20901}, 'accuracy': 0.3651820747573484, 'macro avg': {'precision': 0.37435485281913755, 'recall': 0.3693395244891016, 'f1-score': 0.36343179986965873, 'support': 58108}, 'weighted avg': {'precision': 0.38187677133469433, 'recall': 0.3651820747573484, 'f1-score': 0.3655124013648039, 'support': 58108}}
[[8535 8293 4319]
 [5239 6761 4060]
 [6433 8544 5924]]
training model: results/PCAR/W1/deepLOB_L1/h50
Epoch 1/50
722/722 - 13s - loss: 3.2788 - accuracy50: 0.3867 - val_loss: 3.4010 - val_accuracy50: 0.3331 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2259 - accuracy50: 0.4082 - val_loss: 3.3783 - val_accuracy50: 0.3329 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2077 - accuracy50: 0.4182 - val_loss: 3.3973 - val_accuracy50: 0.3175 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.1954 - accuracy50: 0.4247 - val_loss: 3.4001 - val_accuracy50: 0.3187 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.1881 - accuracy50: 0.4275 - val_loss: 3.4277 - val_accuracy50: 0.3273 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.1822 - accuracy50: 0.4310 - val_loss: 3.4198 - val_accuracy50: 0.3307 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.1780 - accuracy50: 0.4323 - val_loss: 3.3946 - val_accuracy50: 0.3468 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.1743 - accuracy50: 0.4330 - val_loss: 3.4397 - val_accuracy50: 0.3355 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.1697 - accuracy50: 0.4354 - val_loss: 3.3913 - val_accuracy50: 0.3358 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.1674 - accuracy50: 0.4368 - val_loss: 3.4017 - val_accuracy50: 0.3486 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.1634 - accuracy50: 0.4390 - val_loss: 3.3838 - val_accuracy50: 0.3427 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 3.1607 - accuracy50: 0.4404 - val_loss: 3.3708 - val_accuracy50: 0.3445 - 11s/epoch - 15ms/step
Epoch 13/50
722/722 - 11s - loss: 3.1586 - accuracy50: 0.4403 - val_loss: 3.3865 - val_accuracy50: 0.3393 - 11s/epoch - 15ms/step
Epoch 14/50
722/722 - 11s - loss: 3.1566 - accuracy50: 0.4407 - val_loss: 3.3828 - val_accuracy50: 0.3458 - 11s/epoch - 15ms/step
Epoch 15/50
722/722 - 11s - loss: 3.1546 - accuracy50: 0.4425 - val_loss: 3.3695 - val_accuracy50: 0.3512 - 11s/epoch - 15ms/step
Epoch 16/50
722/722 - 11s - loss: 3.1525 - accuracy50: 0.4433 - val_loss: 3.3684 - val_accuracy50: 0.3493 - 11s/epoch - 15ms/step
Epoch 17/50
722/722 - 11s - loss: 3.1505 - accuracy50: 0.4442 - val_loss: 3.3757 - val_accuracy50: 0.3435 - 11s/epoch - 15ms/step
Epoch 18/50
722/722 - 11s - loss: 3.1490 - accuracy50: 0.4444 - val_loss: 3.3888 - val_accuracy50: 0.3396 - 11s/epoch - 15ms/step
Epoch 19/50
722/722 - 11s - loss: 3.1453 - accuracy50: 0.4459 - val_loss: 3.3671 - val_accuracy50: 0.3497 - 11s/epoch - 15ms/step
Epoch 20/50
722/722 - 11s - loss: 3.1437 - accuracy50: 0.4462 - val_loss: 3.3857 - val_accuracy50: 0.3410 - 11s/epoch - 15ms/step
Epoch 21/50
722/722 - 11s - loss: 3.1425 - accuracy50: 0.4463 - val_loss: 3.3879 - val_accuracy50: 0.3417 - 11s/epoch - 15ms/step
Epoch 22/50
722/722 - 11s - loss: 3.1414 - accuracy50: 0.4464 - val_loss: 3.3673 - val_accuracy50: 0.3505 - 11s/epoch - 15ms/step
Epoch 23/50
722/722 - 11s - loss: 3.1388 - accuracy50: 0.4483 - val_loss: 3.3644 - val_accuracy50: 0.3527 - 11s/epoch - 15ms/step
Epoch 24/50
722/722 - 11s - loss: 3.1368 - accuracy50: 0.4485 - val_loss: 3.3837 - val_accuracy50: 0.3467 - 11s/epoch - 15ms/step
Epoch 25/50
722/722 - 11s - loss: 3.1340 - accuracy50: 0.4494 - val_loss: 3.3848 - val_accuracy50: 0.3458 - 11s/epoch - 15ms/step
Epoch 26/50
722/722 - 11s - loss: 3.1337 - accuracy50: 0.4496 - val_loss: 3.3815 - val_accuracy50: 0.3540 - 11s/epoch - 15ms/step
Epoch 27/50
722/722 - 11s - loss: 3.1308 - accuracy50: 0.4515 - val_loss: 3.3783 - val_accuracy50: 0.3551 - 11s/epoch - 15ms/step
Epoch 28/50
722/722 - 11s - loss: 3.1307 - accuracy50: 0.4507 - val_loss: 3.3943 - val_accuracy50: 0.3528 - 11s/epoch - 15ms/step
Epoch 29/50
722/722 - 11s - loss: 3.1279 - accuracy50: 0.4513 - val_loss: 3.3773 - val_accuracy50: 0.3582 - 11s/epoch - 15ms/step
Epoch 30/50
722/722 - 11s - loss: 3.1263 - accuracy50: 0.4519 - val_loss: 3.3690 - val_accuracy50: 0.3611 - 11s/epoch - 15ms/step
Epoch 31/50
722/722 - 11s - loss: 3.1237 - accuracy50: 0.4528 - val_loss: 3.3913 - val_accuracy50: 0.3590 - 11s/epoch - 15ms/step
Epoch 32/50
722/722 - 11s - loss: 3.1224 - accuracy50: 0.4538 - val_loss: 3.4000 - val_accuracy50: 0.3547 - 11s/epoch - 15ms/step
Epoch 33/50
722/722 - 11s - loss: 3.1214 - accuracy50: 0.4541 - val_loss: 3.3881 - val_accuracy50: 0.3562 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h50
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1326929
{'0': {'precision': 0.40511473862018604, 'recall': 0.235034578383375, 'f1-score': 0.2974805073109433, 'support': 233672}, '1': {'precision': 0.314198301302053, 'recall': 0.5840936350944806, 'f1-score': 0.4086004126547455, 'support': 203428}, '2': {'precision': 0.4081109063560177, 'recall': 0.27224471356836305, 'f1-score': 0.3266116529392912, 'support': 230212}, 'accuracy': 0.35428105593785214, 'macro avg': {'precision': 0.37580798209275224, 'recall': 0.3637909756820729, 'f1-score': 0.3442308576349933, 'support': 667312}, 'weighted avg': {'precision': 0.37843277389611113, 'recall': 0.35428105593785214, 'f1-score': 0.3414048476520014, 'support': 667312}}
[[ 54921 131904  46847]
 [ 40557 118821  44050]
 [ 40091 127447  62674]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.11474
{'0': {'precision': 0.40016496609030366, 'recall': 0.21226361588695694, 'f1-score': 0.2773889565355498, 'support': 61711}, '1': {'precision': 0.33798286237209174, 'recall': 0.6034559588057632, 'f1-score': 0.4332894877173024, 'support': 60591}, '2': {'precision': 0.39556246144002927, 'recall': 0.27751771457885793, 'f1-score': 0.32618874892831234, 'support': 62378}, 'accuracy': 0.3626489062161577, 'macro avg': {'precision': 0.3779034299674749, 'recall': 0.3644124297571927, 'f1-score': 0.3456223977270549, 'support': 184680}, 'weighted avg': {'precision': 0.37820930829592964, 'recall': 0.3626489062161577, 'f1-score': 0.34502054920779, 'support': 184680}}
[[13099 36500 12112]
 [ 9687 36564 14340]
 [ 9948 35119 17311]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1236342
{'0': {'precision': 0.44734779200418084, 'recall': 0.16798312319089437, 'f1-score': 0.24424867139850912, 'support': 20383}, '1': {'precision': 0.3109554750745633, 'recall': 0.6674478422406401, 'f1-score': 0.42425563609279343, 'support': 17495}, '2': {'precision': 0.42326771043249106, 'recall': 0.2699456253089471, 'f1-score': 0.32965109259929976, 'support': 20230}, 'accuracy': 0.35385833275968887, 'macro avg': {'precision': 0.3938569925037451, 'recall': 0.3684588635801605, 'f1-score': 0.33271846669686744, 'support': 58108}, 'weighted avg': {'precision': 0.3978998048960555, 'recall': 0.35385833275968887, 'f1-score': 0.3281770948207315, 'support': 58108}}
[[ 3424 13344  3615]
 [ 1992 11677  3826]
 [ 2238 12531  5461]]
training model: results/PCAR/W1/deepLOB_L1/h100
Epoch 1/50
722/722 - 13s - loss: 3.3072 - accuracy100: 0.3670 - val_loss: 3.3341 - val_accuracy100: 0.3411 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2716 - accuracy100: 0.3780 - val_loss: 3.3664 - val_accuracy100: 0.3357 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2553 - accuracy100: 0.3919 - val_loss: 3.3661 - val_accuracy100: 0.3386 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.2452 - accuracy100: 0.3969 - val_loss: 3.3833 - val_accuracy100: 0.3471 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.2386 - accuracy100: 0.4008 - val_loss: 3.3541 - val_accuracy100: 0.3433 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.2331 - accuracy100: 0.4030 - val_loss: 3.3853 - val_accuracy100: 0.3402 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.2305 - accuracy100: 0.4055 - val_loss: 3.3908 - val_accuracy100: 0.3454 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.2259 - accuracy100: 0.4074 - val_loss: 3.4410 - val_accuracy100: 0.3528 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.2237 - accuracy100: 0.4083 - val_loss: 3.3917 - val_accuracy100: 0.3476 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.2218 - accuracy100: 0.4101 - val_loss: 3.4129 - val_accuracy100: 0.3592 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.2184 - accuracy100: 0.4106 - val_loss: 3.4143 - val_accuracy100: 0.3559 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h100
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1177086
{'0': {'precision': 0.3606223168954725, 'recall': 0.23986057750812717, 'f1-score': 0.2880983888101521, 'support': 230092}, '1': {'precision': 0.3097858600213696, 'recall': 0.5674078540018853, 'f1-score': 0.4007665062456065, 'support': 208989}, '2': {'precision': 0.36411274375589425, 'recall': 0.20976554455792595, 'f1-score': 0.2661829503912819, 'support': 228231}, 'accuracy': 0.33214897978756563, 'macro avg': {'precision': 0.3448403068909121, 'recall': 0.3390113253559795, 'f1-score': 0.3183492818156802, 'support': 667312}, 'weighted avg': {'precision': 0.34589511781486104, 'recall': 0.33214897978756563, 'f1-score': 0.31588841022283615, 'support': 667312}}
[[ 55190 133575  41327]
 [ 48125 118582  42282]
 [ 49726 130630  47875]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1308447
{'0': {'precision': 0.3524871737675664, 'recall': 0.25654679762967775, 'f1-score': 0.2969603006812309, 'support': 61595}, '1': {'precision': 0.32398069781907973, 'recall': 0.5643850460538198, 'f1-score': 0.41165446173559506, 'support': 60907}, '2': {'precision': 0.34565011259926515, 'recall': 0.1876065489401396, 'f1-score': 0.24320830640285218, 'support': 62178}, 'accuracy': 0.3348602988953866, 'macro avg': {'precision': 0.34070599472863705, 'recall': 0.33617946420787903, 'f1-score': 0.31727435627322603, 'support': 184680}, 'weighted avg': {'precision': 0.34078391017693876, 'recall': 0.3348602988953866, 'f1-score': 0.3166889435613323, 'support': 184680}}
[[15802 36254  9539]
 [13988 34375 12544]
 [15040 35473 11665]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1126927
{'0': {'precision': 0.3642802583153948, 'recall': 0.26151545363908274, 'f1-score': 0.3044601143321436, 'support': 20060}, '1': {'precision': 0.3118087982305235, 'recall': 0.5571107086009112, 'f1-score': 0.3998345512201848, 'support': 18219}, '2': {'precision': 0.3739130434782609, 'recall': 0.21034847949972263, 'f1-score': 0.2692357345726827, 'support': 19829}, 'accuracy': 0.336735045088456, 'macro avg': {'precision': 0.3500007000080598, 'recall': 0.34299154724657216, 'f1-score': 0.3245101333750037, 'support': 58108}, 'weighted avg': {'precision': 0.35111565044226545, 'recall': 0.336735045088456, 'f1-score': 0.3223434116304997, 'support': 58108}}
[[ 5246 11538  3276]
 [ 4361 10150  3708]
 [ 4794 10864  4171]]
training model: results/PCAR/W1/deepLOB_L1/h200
Epoch 1/50
722/722 - 13s - loss: 3.3250 - accuracy200: 0.3579 - val_loss: 3.3683 - val_accuracy200: 0.3371 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2911 - accuracy200: 0.3626 - val_loss: 3.3692 - val_accuracy200: 0.3402 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2769 - accuracy200: 0.3751 - val_loss: 3.3606 - val_accuracy200: 0.3500 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.2659 - accuracy200: 0.3841 - val_loss: 3.3388 - val_accuracy200: 0.3454 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.2591 - accuracy200: 0.3903 - val_loss: 3.3466 - val_accuracy200: 0.3569 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.2515 - accuracy200: 0.3952 - val_loss: 3.3501 - val_accuracy200: 0.3601 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.2469 - accuracy200: 0.3984 - val_loss: 3.3197 - val_accuracy200: 0.3631 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.2451 - accuracy200: 0.3986 - val_loss: 3.3520 - val_accuracy200: 0.3583 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.2420 - accuracy200: 0.4002 - val_loss: 3.3461 - val_accuracy200: 0.3593 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.2384 - accuracy200: 0.4039 - val_loss: 3.3458 - val_accuracy200: 0.3582 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.2370 - accuracy200: 0.4059 - val_loss: 3.3418 - val_accuracy200: 0.3620 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 3.2355 - accuracy200: 0.4047 - val_loss: 3.3724 - val_accuracy200: 0.3585 - 11s/epoch - 15ms/step
Epoch 13/50
722/722 - 11s - loss: 3.2310 - accuracy200: 0.4094 - val_loss: 3.3560 - val_accuracy200: 0.3643 - 11s/epoch - 15ms/step
Epoch 14/50
722/722 - 11s - loss: 3.2292 - accuracy200: 0.4087 - val_loss: 3.3572 - val_accuracy200: 0.3601 - 11s/epoch - 15ms/step
Epoch 15/50
722/722 - 11s - loss: 3.2263 - accuracy200: 0.4123 - val_loss: 3.3568 - val_accuracy200: 0.3607 - 11s/epoch - 15ms/step
Epoch 16/50
722/722 - 11s - loss: 3.2221 - accuracy200: 0.4139 - val_loss: 3.3592 - val_accuracy200: 0.3607 - 11s/epoch - 15ms/step
Epoch 17/50
722/722 - 11s - loss: 3.2218 - accuracy200: 0.4139 - val_loss: 3.3600 - val_accuracy200: 0.3573 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h200
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1196021
{'0': {'precision': 0.34974069507982924, 'recall': 0.44687942092883987, 'f1-score': 0.3923875788515067, 'support': 230438}, '1': {'precision': 0.3138253991362158, 'recall': 0.06200175449529498, 'f1-score': 0.10354613903554945, 'support': 208607}, '2': {'precision': 0.3476965660305677, 'recall': 0.5051803370614237, 'f1-score': 0.4118987576885435, 'support': 228267}, 'accuracy': 0.3465065816289831, 'macro avg': {'precision': 0.3370875534155376, 'recall': 0.33802050416185286, 'f1-score': 0.30261082519186655, 'support': 667312}, 'weighted avg': {'precision': 0.33781405604651776, 'recall': 0.3465065816289831, 'f1-score': 0.3087676409872191, 'support': 667312}}
[[102978  14301 113159]
 [ 92491  12934 103182]
 [ 98972  13979 115316]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1172924
{'0': {'precision': 0.33342852641115533, 'recall': 0.5496234010778521, 'f1-score': 0.4150608021967246, 'support': 61604}, '1': {'precision': 0.3407204116638079, 'recall': 0.08137381814606649, 'f1-score': 0.13137218592100738, 'support': 61027}, '2': {'precision': 0.3463687150837989, 'recall': 0.38269754548824314, 'f1-score': 0.3636280109642743, 'support': 62049}, 'accuracy': 0.33880766731643924, 'macro avg': {'precision': 0.3401725510529207, 'recall': 0.3378982549040539, 'f1-score': 0.3033536663606688, 'support': 184680}, 'weighted avg': {'precision': 0.34018576947083956, 'recall': 0.33880766731643924, 'f1-score': 0.304036227534387, 'support': 184680}}
[[33859  4856 22889]
 [34139  4966 21922]
 [33550  4753 23746]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1084208
{'0': {'precision': 0.36429510502338946, 'recall': 0.5813329430132709, 'f1-score': 0.4479070729094224, 'support': 20496}, '1': {'precision': 0.3077148723965972, 'recall': 0.12199802291097285, 'f1-score': 0.17472413075161358, 'support': 17197}, '2': {'precision': 0.37512780498304904, 'recall': 0.3414646093558658, 'f1-score': 0.3575055131032361, 'support': 20415}, 'accuracy': 0.36112067185241276, 'macro avg': {'precision': 0.34904592746767854, 'recall': 0.3482651917600365, 'f1-score': 0.32671223892142404, 'support': 58108}, 'weighted avg': {'precision': 0.35135608301598087, 'recall': 0.36112067185241276, 'f1-score': 0.33529822559526373, 'support': 58108}}
[[11915  2327  6254]
 [ 9741  2098  5358]
 [11051  2393  6971]]
training model: results/PCAR/W1/deepLOB_L1/h300
Epoch 1/50
722/722 - 13s - loss: 3.3012 - accuracy300: 0.3754 - val_loss: 3.3370 - val_accuracy300: 0.3628 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2691 - accuracy300: 0.3893 - val_loss: 3.3231 - val_accuracy300: 0.3642 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2586 - accuracy300: 0.3946 - val_loss: 3.3136 - val_accuracy300: 0.3723 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.2477 - accuracy300: 0.3993 - val_loss: 3.3854 - val_accuracy300: 0.3686 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.2362 - accuracy300: 0.4059 - val_loss: 3.3590 - val_accuracy300: 0.3640 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.2255 - accuracy300: 0.4135 - val_loss: 3.3375 - val_accuracy300: 0.3723 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.2185 - accuracy300: 0.4174 - val_loss: 3.3563 - val_accuracy300: 0.3665 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.2142 - accuracy300: 0.4191 - val_loss: 3.3494 - val_accuracy300: 0.3731 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.2109 - accuracy300: 0.4222 - val_loss: 3.3639 - val_accuracy300: 0.3670 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.2075 - accuracy300: 0.4246 - val_loss: 3.3659 - val_accuracy300: 0.3664 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.2059 - accuracy300: 0.4253 - val_loss: 3.3830 - val_accuracy300: 0.3682 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 3.2039 - accuracy300: 0.4265 - val_loss: 3.4072 - val_accuracy300: 0.3704 - 11s/epoch - 15ms/step
Epoch 13/50
722/722 - 11s - loss: 3.1976 - accuracy300: 0.4285 - val_loss: 3.3801 - val_accuracy300: 0.3697 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h300
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.118212
{'0': {'precision': 0.3301653015194682, 'recall': 0.3833087848953892, 'f1-score': 0.3547578333951157, 'support': 232194}, '1': {'precision': 0.3649112555693521, 'recall': 0.09739503375003046, 'f1-score': 0.15375323621171846, 'support': 205185}, '2': {'precision': 0.36885532684121525, 'recall': 0.5502037550068933, 'f1-score': 0.44163773557241676, 'support': 229933}, 'accuracy': 0.3529023904860095, 'macro avg': {'precision': 0.35464396131001186, 'recall': 0.34363585788410433, 'f1-score': 0.3167162683930836, 'support': 667312}, 'weighted avg': {'precision': 0.3541802483120191, 'recall': 0.3529023904860095, 'f1-score': 0.3228888250066228, 'support': 667312}}
[[ 89002  18264 124928]
 [ 93659  19984  91542]
 [ 86907  16516 126510]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.126406
{'0': {'precision': 0.3357229369210121, 'recall': 0.4985982595731579, 'f1-score': 0.40126242207673646, 'support': 61709}, '1': {'precision': 0.34578743673712414, 'recall': 0.15221807221020903, 'f1-score': 0.21138359343009233, 'support': 61044}, '2': {'precision': 0.3452487114765496, 'recall': 0.3688536502656353, 'f1-score': 0.35666104553119726, 'support': 61927}, 'accuracy': 0.340599956681828, 'macro avg': {'precision': 0.34225302837822863, 'recall': 0.3398899940163341, 'f1-score': 0.323102353679342, 'support': 184680}, 'weighted avg': {'precision': 0.34224383776395945, 'recall': 0.340599956681828, 'f1-score': 0.3235442465231229, 'support': 184680}}
[[30768  8702 22239]
 [30672  9292 21080]
 [30207  8878 22842]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1050298
{'0': {'precision': 0.3645356070030646, 'recall': 0.5830340677472581, 'f1-score': 0.4485932453372664, 'support': 20606}, '1': {'precision': 0.3311592419394536, 'recall': 0.16104129263913824, 'f1-score': 0.2167015622483492, 'support': 16710}, '2': {'precision': 0.4025844346549192, 'recall': 0.32964601769911506, 'f1-score': 0.3624824814236984, 'support': 20792}, 'accuracy': 0.3710160390996076, 'macro avg': {'precision': 0.3660930945324791, 'recall': 0.3579071260285038, 'f1-score': 0.3425924296697713, 'support': 58108}, 'weighted avg': {'precision': 0.3685521307919477, 'recall': 0.3710160390996076, 'f1-score': 0.35109677277399265, 'support': 58108}}
[[12014  2730  5862]
 [ 9710  2691  4309]
 [11233  2705  6854]]
training model: results/PCAR/W1/deepLOB_L1/h500
Epoch 1/50
722/722 - 13s - loss: 3.3117 - accuracy500: 0.3728 - val_loss: 3.3645 - val_accuracy500: 0.3606 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2843 - accuracy500: 0.3802 - val_loss: 3.3533 - val_accuracy500: 0.3348 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2632 - accuracy500: 0.3917 - val_loss: 3.4423 - val_accuracy500: 0.3596 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.2405 - accuracy500: 0.4095 - val_loss: 3.3979 - val_accuracy500: 0.3611 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.2271 - accuracy500: 0.4170 - val_loss: 3.4331 - val_accuracy500: 0.3581 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.2171 - accuracy500: 0.4224 - val_loss: 3.4291 - val_accuracy500: 0.3582 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.2105 - accuracy500: 0.4233 - val_loss: 3.4495 - val_accuracy500: 0.3575 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.2011 - accuracy500: 0.4279 - val_loss: 3.4157 - val_accuracy500: 0.3587 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.1934 - accuracy500: 0.4309 - val_loss: 3.4782 - val_accuracy500: 0.3594 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.1877 - accuracy500: 0.4337 - val_loss: 3.4292 - val_accuracy500: 0.3595 - 11s/epoch - 15ms/step
Epoch 11/50
722/722 - 11s - loss: 3.1838 - accuracy500: 0.4353 - val_loss: 3.4657 - val_accuracy500: 0.3580 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 3.1821 - accuracy500: 0.4363 - val_loss: 3.4456 - val_accuracy500: 0.3616 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h500
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1218284
{'0': {'precision': 0.35457503372748195, 'recall': 0.27264208099237675, 'f1-score': 0.3082571339163174, 'support': 229429}, '1': {'precision': 0.31769173090632397, 'recall': 0.4108481215218897, 'f1-score': 0.3583141002674577, 'support': 209345}, '2': {'precision': 0.35756493934149985, 'recall': 0.34446787842722, 'f1-score': 0.35089424009092834, 'support': 228538}, 'accuracy': 0.3405978013283142, 'macro avg': {'precision': 0.34327723465843524, 'recall': 0.3426526936471621, 'f1-score': 0.33915515809156777, 'support': 667312}, 'weighted avg': {'precision': 0.34402820109165505, 'recall': 0.3405978013283142, 'f1-score': 0.3385628598611718, 'support': 667312}}
[[62552 93606 73271]
 [55164 86009 68172]
 [58698 91116 78724]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1182766
{'0': {'precision': 0.3445328002148388, 'recall': 0.3697719848843912, 'f1-score': 0.3567064929448019, 'support': 62452}, '1': {'precision': 0.3397735717095773, 'recall': 0.25698841188236654, 'f1-score': 0.2926388509793218, 'support': 60493}, '2': {'precision': 0.3382800873447475, 'recall': 0.3939742447558111, 'f1-score': 0.3640091593456755, 'support': 61735}, 'accuracy': 0.34091942820012994, 'macro avg': {'precision': 0.3408621530897212, 'recall': 0.34024488050752294, 'f1-score': 0.3377848344232664, 'support': 184680}, 'weighted avg': {'precision': 0.3408837248466134, 'recall': 0.34091942820012994, 'f1-score': 0.338161909042052, 'support': 184680}}
[[23093 15668 23691]
 [21061 15546 23886]
 [22873 14540 24322]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1188265
{'0': {'precision': 0.3360249658669787, 'recall': 0.4363949541516794, 'f1-score': 0.37968880856878384, 'support': 19739}, '1': {'precision': 0.31110247776914446, 'recall': 0.3951422775371457, 'f1-score': 0.3481222074628668, 'support': 18239}, '2': {'precision': 0.38497904802836574, 'recall': 0.17799304520615997, 'f1-score': 0.243435132656181, 'support': 20130}, 'accuracy': 0.3339299235905555, 'macro avg': {'precision': 0.3440354972214963, 'recall': 0.33651009229832834, 'f1-score': 0.3237487162292772, 'support': 58108}, 'weighted avg': {'precision': 0.34516113323622777, 'recall': 0.3339299235905555, 'f1-score': 0.32257912085467366, 'support': 58108}}
[[8614 8047 3078]
 [8386 7207 2646]
 [8635 7912 3583]]
training model: results/PCAR/W1/deepLOB_L1/h1000
Epoch 1/50
722/722 - 13s - loss: 3.3188 - accuracy1000: 0.3682 - val_loss: 3.3831 - val_accuracy1000: 0.3551 - 13s/epoch - 18ms/step
Epoch 2/50
722/722 - 11s - loss: 3.2755 - accuracy1000: 0.3848 - val_loss: 3.4138 - val_accuracy1000: 0.3480 - 11s/epoch - 15ms/step
Epoch 3/50
722/722 - 11s - loss: 3.2522 - accuracy1000: 0.3990 - val_loss: 3.3496 - val_accuracy1000: 0.3548 - 11s/epoch - 15ms/step
Epoch 4/50
722/722 - 11s - loss: 3.2307 - accuracy1000: 0.4095 - val_loss: 3.4168 - val_accuracy1000: 0.3558 - 11s/epoch - 15ms/step
Epoch 5/50
722/722 - 11s - loss: 3.2173 - accuracy1000: 0.4185 - val_loss: 3.4304 - val_accuracy1000: 0.3524 - 11s/epoch - 15ms/step
Epoch 6/50
722/722 - 11s - loss: 3.2030 - accuracy1000: 0.4237 - val_loss: 3.4601 - val_accuracy1000: 0.3493 - 11s/epoch - 15ms/step
Epoch 7/50
722/722 - 11s - loss: 3.1837 - accuracy1000: 0.4329 - val_loss: 3.4662 - val_accuracy1000: 0.3597 - 11s/epoch - 15ms/step
Epoch 8/50
722/722 - 11s - loss: 3.1768 - accuracy1000: 0.4332 - val_loss: 3.4835 - val_accuracy1000: 0.3561 - 11s/epoch - 15ms/step
Epoch 9/50
722/722 - 11s - loss: 3.1679 - accuracy1000: 0.4371 - val_loss: 3.4708 - val_accuracy1000: 0.3583 - 11s/epoch - 15ms/step
Epoch 10/50
722/722 - 11s - loss: 3.1557 - accuracy1000: 0.4423 - val_loss: 3.5124 - val_accuracy1000: 0.3558 - 11s/epoch - 16ms/step
Epoch 11/50
722/722 - 11s - loss: 3.1496 - accuracy1000: 0.4445 - val_loss: 3.4835 - val_accuracy1000: 0.3540 - 11s/epoch - 15ms/step
Epoch 12/50
722/722 - 11s - loss: 3.1441 - accuracy1000: 0.4471 - val_loss: 3.5437 - val_accuracy1000: 0.3541 - 11s/epoch - 15ms/step
Epoch 13/50
722/722 - 11s - loss: 3.1364 - accuracy1000: 0.4471 - val_loss: 3.5510 - val_accuracy1000: 0.3549 - 11s/epoch - 15ms/step
testing model: results/PCAR/W1/deepLOB_L1/h1000
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1355847
{'0': {'precision': 0.3491441646883637, 'recall': 0.38056613073184, 'f1-score': 0.3641786189861451, 'support': 235352}, '1': {'precision': 0.26755071244474715, 'recall': 0.10037575150300601, 'f1-score': 0.14598353996422364, 'support': 199600}, '2': {'precision': 0.36776264081739585, 'recall': 0.5316319504217594, 'f1-score': 0.43476883658069604, 'support': 232360}, 'accuracy': 0.34935981969453567, 'macro avg': {'precision': 0.32815250598350226, 'recall': 0.33752461088553515, 'f1-score': 0.31497699851035493, 'support': 667312}, 'weighted avg': {'precision': 0.3312217176853367, 'recall': 0.34935981969453567, 'f1-score': 0.32349390956610524, 'support': 667312}}
[[ 89567  30975 114810]
 [ 82009  20035  97556]
 [ 84957  23873 123530]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1293144
{'0': {'precision': 0.3413702476370819, 'recall': 0.33234270457543347, 'f1-score': 0.33679599297804835, 'support': 62923}, '1': {'precision': 0.3198846742949815, 'recall': 0.29579764721564966, 'f1-score': 0.30736998848574565, 'support': 60014}, '2': {'precision': 0.33639548920884493, 'recall': 0.37008243849505207, 'f1-score': 0.35243581735033047, 'support': 61743}, 'accuracy': 0.33308425384448775, 'macro avg': {'precision': 0.33255013704696945, 'recall': 0.33274093009537836, 'f1-score': 0.33220059960470816, 'support': 184680}, 'weighted avg': {'precision': 0.3327250683638122, 'recall': 0.33308425384448775, 'f1-score': 0.3324624292062093, 'support': 184680}}
[[20912 18520 23491]
 [20677 17752 21585]
 [19670 19223 22850]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1169817
{'0': {'precision': 0.3536913585358784, 'recall': 0.4359720308273363, 'f1-score': 0.3905449890270665, 'support': 19593}, '1': {'precision': 0.32793629727936296, 'recall': 0.2639393292031617, 'f1-score': 0.29247795466650883, 'support': 18724}, '2': {'precision': 0.3810028061629692, 'recall': 0.3635996159870648, 'f1-score': 0.3720978333936605, 'support': 19791}, 'accuracy': 0.3558890342121567, 'macro avg': {'precision': 0.3542101539927369, 'recall': 0.3545036586725209, 'f1-score': 0.35170692569574524, 'support': 58108}, 'weighted avg': {'precision': 0.35469437177021373, 'recall': 0.3558890342121567, 'f1-score': 0.35266217068006056, 'support': 58108}}
[[8542 5039 6012]
 [8103 4942 5679]
 [7506 5089 7196]]
training model: results/PCAR/W1/deepOF_L1/h10
Epoch 1/50
722/722 - 13s - loss: 3.2736 - accuracy10: 0.3864 - val_loss: 3.3173 - val_accuracy10: 0.3856 - 13s/epoch - 17ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2372 - accuracy10: 0.3972 - val_loss: 3.3014 - val_accuracy10: 0.3861 - 10s/epoch - 14ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2251 - accuracy10: 0.4000 - val_loss: 3.2916 - val_accuracy10: 0.3922 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2181 - accuracy10: 0.4031 - val_loss: 3.2838 - val_accuracy10: 0.3902 - 10s/epoch - 13ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2110 - accuracy10: 0.4061 - val_loss: 3.2806 - val_accuracy10: 0.3990 - 10s/epoch - 13ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2070 - accuracy10: 0.4091 - val_loss: 3.2797 - val_accuracy10: 0.4002 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2021 - accuracy10: 0.4112 - val_loss: 3.2824 - val_accuracy10: 0.4050 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 10s - loss: 3.1948 - accuracy10: 0.4162 - val_loss: 3.2795 - val_accuracy10: 0.4035 - 10s/epoch - 13ms/step
Epoch 9/50
722/722 - 10s - loss: 3.1912 - accuracy10: 0.4195 - val_loss: 3.2801 - val_accuracy10: 0.4070 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 9s - loss: 3.1857 - accuracy10: 0.4213 - val_loss: 3.2856 - val_accuracy10: 0.4070 - 9s/epoch - 13ms/step
Epoch 11/50
722/722 - 10s - loss: 3.1807 - accuracy10: 0.4248 - val_loss: 3.2864 - val_accuracy10: 0.4093 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.1776 - accuracy10: 0.4269 - val_loss: 3.2855 - val_accuracy10: 0.4108 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.1725 - accuracy10: 0.4296 - val_loss: 3.2906 - val_accuracy10: 0.4102 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.1693 - accuracy10: 0.4319 - val_loss: 3.2901 - val_accuracy10: 0.4126 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.1640 - accuracy10: 0.4343 - val_loss: 3.2968 - val_accuracy10: 0.4113 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.1591 - accuracy10: 0.4374 - val_loss: 3.2983 - val_accuracy10: 0.4120 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.1557 - accuracy10: 0.4393 - val_loss: 3.3049 - val_accuracy10: 0.4103 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 10s - loss: 3.1513 - accuracy10: 0.4410 - val_loss: 3.3036 - val_accuracy10: 0.4107 - 10s/epoch - 14ms/step
testing model: results/PCAR/W1/deepOF_L1/h10
Evaluating performance on  test set...
2607/2607 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0774994
{'0': {'precision': 0.4090445219563462, 'recall': 0.5833275409665143, 'f1-score': 0.480882007975604, 'support': 230188}, '1': {'precision': 0.3754124784242055, 'recall': 0.2739451359561384, 'f1-score': 0.3167512635997601, 'support': 215952}, '2': {'precision': 0.43028689834562267, 'recall': 0.35303187184344864, 'f1-score': 0.3878497361067991, 'support': 221167}, 'accuracy': 0.40687869301535873, 'macro avg': {'precision': 0.4049146329087248, 'recall': 0.4034348495887004, 'f1-score': 0.39516100256072106, 'support': 667307}, 'weighted avg': {'precision': 0.4052010220290778, 'recall': 0.40687869301535873, 'f1-score': 0.3969325949140593, 'support': 667307}}
[[134275  47081  48832]
 [102246  59159  54547]
 [ 91744  51344  78079]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0719874
{'0': {'precision': 0.3628618953425643, 'recall': 0.5904967444582633, 'f1-score': 0.4495029654999583, 'support': 54676}, '1': {'precision': 0.46716306189181733, 'recall': 0.31384900416859657, 'f1-score': 0.3754581219178191, 'support': 75565}, '2': {'precision': 0.40556779491287803, 'recall': 0.33478452551526505, 'f1-score': 0.3667924528301887, 'support': 54438}, 'accuracy': 0.4019244202102026, 'macro avg': {'precision': 0.4118642507157532, 'recall': 0.4130434247140416, 'f1-score': 0.3972511800826553, 'support': 184679}, 'weighted avg': {'precision': 0.4181272011494132, 'recall': 0.4019244202102026, 'f1-score': 0.3948254250432671, 'support': 184679}}
[[32286 12439  9951]
 [35088 23716 16761]
 [21602 14611 18225]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0749876
{'0': {'precision': 0.392491230507415, 'recall': 0.6018853855986366, 'f1-score': 0.4751413735836364, 'support': 18776}, '1': {'precision': 0.4057649667405765, 'recall': 0.284811050046204, 'f1-score': 0.3346955105306776, 'support': 20561}, '2': {'precision': 0.4286386238408816, 'recall': 0.3398508257858284, 'f1-score': 0.3791156543444668, 'support': 18770}, 'accuracy': 0.4050458636653071, 'macro avg': {'precision': 0.40896494036295766, 'recall': 0.40884908714355633, 'f1-score': 0.39631751281959354, 'support': 58107}, 'weighted avg': {'precision': 0.4088646083028476, 'recall': 0.4050458636653071, 'f1-score': 0.3944263110205873, 'support': 58107}}
[[11301  3909  3566]
 [ 9768  5856  4937]
 [ 7724  4667  6379]]
training model: results/PCAR/W1/deepOF_L1/h20
Epoch 1/50
722/722 - 12s - loss: 3.2934 - accuracy20: 0.3822 - val_loss: 3.2604 - val_accuracy20: 0.3980 - 12s/epoch - 17ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2614 - accuracy20: 0.3933 - val_loss: 3.2408 - val_accuracy20: 0.4173 - 10s/epoch - 14ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2499 - accuracy20: 0.3980 - val_loss: 3.2349 - val_accuracy20: 0.4206 - 10s/epoch - 14ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2424 - accuracy20: 0.4012 - val_loss: 3.2304 - val_accuracy20: 0.4227 - 10s/epoch - 13ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2375 - accuracy20: 0.4025 - val_loss: 3.2303 - val_accuracy20: 0.4234 - 10s/epoch - 14ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2337 - accuracy20: 0.4063 - val_loss: 3.2283 - val_accuracy20: 0.4237 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2297 - accuracy20: 0.4065 - val_loss: 3.2296 - val_accuracy20: 0.4233 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2238 - accuracy20: 0.4109 - val_loss: 3.2306 - val_accuracy20: 0.4233 - 10s/epoch - 13ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2206 - accuracy20: 0.4130 - val_loss: 3.2344 - val_accuracy20: 0.4182 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2165 - accuracy20: 0.4156 - val_loss: 3.2347 - val_accuracy20: 0.4167 - 10s/epoch - 13ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2136 - accuracy20: 0.4167 - val_loss: 3.2321 - val_accuracy20: 0.4197 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2095 - accuracy20: 0.4194 - val_loss: 3.2383 - val_accuracy20: 0.4092 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2052 - accuracy20: 0.4210 - val_loss: 3.2392 - val_accuracy20: 0.4121 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2009 - accuracy20: 0.4239 - val_loss: 3.2398 - val_accuracy20: 0.4076 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.1970 - accuracy20: 0.4259 - val_loss: 3.2438 - val_accuracy20: 0.4049 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.1940 - accuracy20: 0.4269 - val_loss: 3.2508 - val_accuracy20: 0.3920 - 10s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h20
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0801637
{'0': {'precision': 0.4225048219107625, 'recall': 0.6471002961935972, 'f1-score': 0.511222302088876, 'support': 253888}, '1': {'precision': 0.34366812227074234, 'recall': 0.057031740663800186, 'f1-score': 0.0978287892599652, 'support': 165592}, '2': {'precision': 0.44034712344159027, 'recall': 0.44594414652156544, 'f1-score': 0.443127962085308, 'support': 247827}, 'accuracy': 0.4259688569129351, 'macro avg': {'precision': 0.40217335587436503, 'recall': 0.3833587277929877, 'f1-score': 0.35072635114471645, 'support': 667307}, 'weighted avg': {'precision': 0.40956786380106225, 'recall': 0.4259688569129351, 'f1-score': 0.3833497118471593, 'support': 667307}}
[[164291   9273  80324]
 [ 96012   9444  60136]
 [128547   8763 110517]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0798942
{'0': {'precision': 0.3838888735467123, 'recall': 0.6716432333188385, 'f1-score': 0.48854291136571304, 'support': 62091}, '1': {'precision': 0.4677739475608482, 'recall': 0.07423616982477081, 'f1-score': 0.12813689300941428, 'support': 60321}, '2': {'precision': 0.41719194259323333, 'recall': 0.44537234811376814, 'f1-score': 0.4308218114028274, 'support': 62267}, 'accuracy': 0.40022417275380523, 'macro avg': {'precision': 0.4229515879002646, 'recall': 0.3970839170857925, 'f1-score': 0.34916720525931827, 'support': 184679}, 'weighted avg': {'precision': 0.42251651258486184, 'recall': 0.40022417275380523, 'f1-score': 0.35136342065664866, 'support': 184679}}
[[41703  2574 17814]
 [34916  4478 20927]
 [32014  2521 27732]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0777593
{'0': {'precision': 0.420372178337919, 'recall': 0.6659324178656794, 'f1-score': 0.5153977293336718, 'support': 21337}, '1': {'precision': 0.3668046928916494, 'recall': 0.06817598768599281, 'f1-score': 0.11498107084910762, 'support': 15592}, '2': {'precision': 0.43899476831091183, 'recall': 0.44376239493814335, 'f1-score': 0.4413657070398722, 'support': 21178}, 'accuracy': 0.42456158466277727, 'macro avg': {'precision': 0.40872387984682673, 'recall': 0.39262360016327186, 'f1-score': 0.35724816907421725, 'support': 58107}, 'weighted avg': {'precision': 0.412785570482924, 'recall': 0.42456158466277727, 'f1-score': 0.3809707806488419, 'support': 58107}}
[[14209   870  6258]
 [ 8777  1063  5752]
 [10815   965  9398]]
training model: results/PCAR/W1/deepOF_L1/h30
Epoch 1/50
722/722 - 12s - loss: 3.2992 - accuracy30: 0.3774 - val_loss: 3.2737 - val_accuracy30: 0.3808 - 12s/epoch - 16ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2702 - accuracy30: 0.3870 - val_loss: 3.2552 - val_accuracy30: 0.4055 - 10s/epoch - 13ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2608 - accuracy30: 0.3904 - val_loss: 3.2468 - val_accuracy30: 0.4109 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2544 - accuracy30: 0.3930 - val_loss: 3.2422 - val_accuracy30: 0.4123 - 10s/epoch - 13ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2494 - accuracy30: 0.3960 - val_loss: 3.2425 - val_accuracy30: 0.4121 - 10s/epoch - 14ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2461 - accuracy30: 0.3979 - val_loss: 3.2421 - val_accuracy30: 0.4139 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2434 - accuracy30: 0.3991 - val_loss: 3.2420 - val_accuracy30: 0.4132 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2390 - accuracy30: 0.4028 - val_loss: 3.2418 - val_accuracy30: 0.4145 - 10s/epoch - 13ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2362 - accuracy30: 0.4033 - val_loss: 3.2419 - val_accuracy30: 0.4139 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2332 - accuracy30: 0.4049 - val_loss: 3.2433 - val_accuracy30: 0.4128 - 10s/epoch - 14ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2314 - accuracy30: 0.4064 - val_loss: 3.2465 - val_accuracy30: 0.4125 - 10s/epoch - 14ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2287 - accuracy30: 0.4086 - val_loss: 3.2448 - val_accuracy30: 0.4119 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2272 - accuracy30: 0.4091 - val_loss: 3.2439 - val_accuracy30: 0.4119 - 10s/epoch - 14ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2244 - accuracy30: 0.4110 - val_loss: 3.2466 - val_accuracy30: 0.4108 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2210 - accuracy30: 0.4142 - val_loss: 3.2496 - val_accuracy30: 0.4076 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2185 - accuracy30: 0.4147 - val_loss: 3.2487 - val_accuracy30: 0.4080 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2163 - accuracy30: 0.4149 - val_loss: 3.2511 - val_accuracy30: 0.4048 - 10s/epoch - 14ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2147 - accuracy30: 0.4162 - val_loss: 3.2523 - val_accuracy30: 0.4028 - 10s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h30
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.084553
{'0': {'precision': 0.40732958619816934, 'recall': 0.6275716403663762, 'f1-score': 0.4940152548252857, 'support': 246195}, '1': {'precision': 0.3452723897317713, 'recall': 0.06028951486697966, 'f1-score': 0.1026541429944519, 'support': 178920}, '2': {'precision': 0.41984709039427, 'recall': 0.4450890202814296, 'f1-score': 0.4320997304312098, 'support': 242192}, 'accuracy': 0.4092404245721984, 'macro avg': {'precision': 0.39081635544140353, 'recall': 0.3776500585049285, 'f1-score': 0.3429230427503158, 'support': 667307}, 'weighted avg': {'precision': 0.39523375292277146, 'recall': 0.4092404245721984, 'f1-score': 0.36661096442697905, 'support': 667307}}
[[154505  10701  80989]
 [100166  10787  67967]
 [124641   9754 107797]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.081462
{'0': {'precision': 0.38470100268269947, 'recall': 0.654310400621319, 'f1-score': 0.484525706617462, 'support': 61804}, '1': {'precision': 0.474216380182002, 'recall': 0.077331486611265, 'f1-score': 0.13297796932150044, 'support': 60648}, '2': {'precision': 0.40798897676221096, 'recall': 0.4567952817908625, 'f1-score': 0.4310148751307829, 'support': 62227}, 'accuracy': 0.39828025926066307, 'macro avg': {'precision': 0.4223021198756374, 'recall': 0.3961457230078154, 'f1-score': 0.34950618368991515, 'support': 184679}, 'weighted avg': {'precision': 0.4219443783649561, 'recall': 0.39828025926066307, 'f1-score': 0.35104823661574525, 'support': 184679}}
[[40439  2637 18728]
 [33440  4690 22518]
 [31239  2563 28425]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0817782
{'0': {'precision': 0.4120662821569166, 'recall': 0.639649455234486, 'f1-score': 0.5012342471092633, 'support': 21110}, '1': {'precision': 0.3685575364667747, 'recall': 0.07048977061376317, 'f1-score': 0.11834504293520687, 'support': 16130}, '2': {'precision': 0.4216060755853143, 'recall': 0.4496094311592467, 'f1-score': 0.4351576994434137, 'support': 20867}, 'accuracy': 0.41340974409279435, 'macro avg': {'precision': 0.4007432980696686, 'recall': 0.3865828856691653, 'f1-score': 0.3515789964959613, 'support': 58107}, 'weighted avg': {'precision': 0.40341449840432886, 'recall': 0.41340974409279435, 'f1-score': 0.3712185487687739, 'support': 58107}}
[[13503   922  6685]
 [ 8807  1137  6186]
 [10459  1026  9382]]
training model: results/PCAR/W1/deepOF_L1/h50
Epoch 1/50
722/722 - 12s - loss: 3.3077 - accuracy50: 0.3666 - val_loss: 3.2952 - val_accuracy50: 0.3522 - 12s/epoch - 16ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2807 - accuracy50: 0.3777 - val_loss: 3.2843 - val_accuracy50: 0.3675 - 10s/epoch - 13ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2729 - accuracy50: 0.3799 - val_loss: 3.2742 - val_accuracy50: 0.3822 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2687 - accuracy50: 0.3814 - val_loss: 3.2706 - val_accuracy50: 0.3877 - 10s/epoch - 14ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2648 - accuracy50: 0.3821 - val_loss: 3.2681 - val_accuracy50: 0.3882 - 10s/epoch - 14ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2618 - accuracy50: 0.3851 - val_loss: 3.2656 - val_accuracy50: 0.3889 - 10s/epoch - 14ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2606 - accuracy50: 0.3862 - val_loss: 3.2657 - val_accuracy50: 0.3903 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2577 - accuracy50: 0.3875 - val_loss: 3.2644 - val_accuracy50: 0.3921 - 10s/epoch - 14ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2562 - accuracy50: 0.3891 - val_loss: 3.2650 - val_accuracy50: 0.3924 - 10s/epoch - 14ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2543 - accuracy50: 0.3895 - val_loss: 3.2648 - val_accuracy50: 0.3938 - 10s/epoch - 14ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2525 - accuracy50: 0.3916 - val_loss: 3.2660 - val_accuracy50: 0.3911 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2514 - accuracy50: 0.3914 - val_loss: 3.2652 - val_accuracy50: 0.3918 - 10s/epoch - 14ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2485 - accuracy50: 0.3943 - val_loss: 3.2669 - val_accuracy50: 0.3902 - 10s/epoch - 14ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2472 - accuracy50: 0.3956 - val_loss: 3.2654 - val_accuracy50: 0.3912 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2449 - accuracy50: 0.3964 - val_loss: 3.2670 - val_accuracy50: 0.3888 - 10s/epoch - 14ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2437 - accuracy50: 0.3975 - val_loss: 3.2689 - val_accuracy50: 0.3891 - 10s/epoch - 14ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2415 - accuracy50: 0.3991 - val_loss: 3.2685 - val_accuracy50: 0.3871 - 10s/epoch - 14ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2406 - accuracy50: 0.4001 - val_loss: 3.2693 - val_accuracy50: 0.3865 - 10s/epoch - 14ms/step
testing model: results/PCAR/W1/deepOF_L1/h50
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922917
{'0': {'precision': 0.3818847127566249, 'recall': 0.620359394190978, 'f1-score': 0.472750635128216, 'support': 233671}, '1': {'precision': 0.3359157027927513, 'recall': 0.06096074248129541, 'f1-score': 0.10319418497730327, 'support': 203426}, '2': {'precision': 0.3914688655058433, 'recall': 0.4264801702793102, 'f1-score': 0.40822520992330696, 'support': 230210}, 'accuracy': 0.38294368259286954, 'macro avg': {'precision': 0.36975642701840655, 'recall': 0.3692667689838612, 'f1-score': 0.3280566766762754, 'support': 667307}, 'weighted avg': {'precision': 0.3711776109031851, 'recall': 0.38294368259286954, 'f1-score': 0.33783254111028777, 'support': 667307}}
[[144960  12126  76585]
 [114991  12401  76034]
 [119640  12390  98180]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0861208
{'0': {'precision': 0.3798108048042825, 'recall': 0.637066450567261, 'f1-score': 0.47589759732673087, 'support': 61700}, '1': {'precision': 0.42105263157894735, 'recall': 0.07546796404716748, 'f1-score': 0.127994629595961, 'support': 60635}, '2': {'precision': 0.3969567690557452, 'recall': 0.447741562941101, 'f1-score': 0.42082252909606227, 'support': 62344}, 'accuracy': 0.3887664542259813, 'macro avg': {'precision': 0.3992734018129917, 'recall': 0.38675865918517643, 'f1-score': 0.3415715853395847, 'support': 184679}, 'weighted avg': {'precision': 0.3991397277558633, 'recall': 0.3887664542259813, 'f1-score': 0.34307959147805267, 'support': 184679}}
[[39307  3074 19319]
 [32972  4576 23087]
 [31212  3218 27914]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0886241
{'0': {'precision': 0.391050763771023, 'recall': 0.6211460222538111, 'f1-score': 0.47994546074309746, 'support': 20401}, '1': {'precision': 0.36104847801578355, 'recall': 0.07321673525377229, 'f1-score': 0.12174491541532029, 'support': 17496}, '2': {'precision': 0.39920556107249255, 'recall': 0.4376051459673429, 'f1-score': 0.41752431309602495, 'support': 20210}, 'accuracy': 0.39232794671898397, 'macro avg': {'precision': 0.3837682676197664, 'recall': 0.3773226344916421, 'f1-score': 0.3397382297514809, 'support': 58107}, 'weighted avg': {'precision': 0.3848533772580216, 'recall': 0.39232794671898397, 'f1-score': 0.3503808964909054, 'support': 58107}}
[[12672  1084  6645]
 [ 9550  1281  6665]
 [10183  1183  8844]]
training model: results/PCAR/W1/deepOF_L1/h100
Epoch 1/50
722/722 - 12s - loss: 3.3166 - accuracy100: 0.3559 - val_loss: 3.3025 - val_accuracy100: 0.3488 - 12s/epoch - 17ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2942 - accuracy100: 0.3642 - val_loss: 3.2946 - val_accuracy100: 0.3510 - 10s/epoch - 14ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2854 - accuracy100: 0.3687 - val_loss: 3.2896 - val_accuracy100: 0.3577 - 10s/epoch - 14ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2819 - accuracy100: 0.3701 - val_loss: 3.2867 - val_accuracy100: 0.3619 - 10s/epoch - 14ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2794 - accuracy100: 0.3716 - val_loss: 3.2863 - val_accuracy100: 0.3650 - 10s/epoch - 13ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2775 - accuracy100: 0.3719 - val_loss: 3.2840 - val_accuracy100: 0.3687 - 10s/epoch - 14ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2770 - accuracy100: 0.3726 - val_loss: 3.2856 - val_accuracy100: 0.3658 - 10s/epoch - 14ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2754 - accuracy100: 0.3733 - val_loss: 3.2827 - val_accuracy100: 0.3707 - 10s/epoch - 14ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2745 - accuracy100: 0.3735 - val_loss: 3.2829 - val_accuracy100: 0.3703 - 10s/epoch - 14ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2730 - accuracy100: 0.3758 - val_loss: 3.2830 - val_accuracy100: 0.3694 - 10s/epoch - 14ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2722 - accuracy100: 0.3759 - val_loss: 3.2831 - val_accuracy100: 0.3690 - 10s/epoch - 14ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2712 - accuracy100: 0.3774 - val_loss: 3.2843 - val_accuracy100: 0.3682 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 9s - loss: 3.2696 - accuracy100: 0.3772 - val_loss: 3.2830 - val_accuracy100: 0.3692 - 9s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2685 - accuracy100: 0.3793 - val_loss: 3.2834 - val_accuracy100: 0.3694 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2675 - accuracy100: 0.3803 - val_loss: 3.2835 - val_accuracy100: 0.3696 - 10s/epoch - 14ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2668 - accuracy100: 0.3807 - val_loss: 3.2833 - val_accuracy100: 0.3698 - 10s/epoch - 14ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2661 - accuracy100: 0.3808 - val_loss: 3.2835 - val_accuracy100: 0.3704 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2646 - accuracy100: 0.3821 - val_loss: 3.2843 - val_accuracy100: 0.3682 - 10s/epoch - 14ms/step
testing model: results/PCAR/W1/deepOF_L1/h100
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0973378
{'0': {'precision': 0.3606689124157844, 'recall': 0.6514581250814898, 'f1-score': 0.46429091359630786, 'support': 230090}, '1': {'precision': 0.33563264611720306, 'recall': 0.1038380010431171, 'f1-score': 0.1586063746592313, 'support': 208989}, '2': {'precision': 0.37141406041165465, 'recall': 0.30440173861226494, 'f1-score': 0.3345855065763176, 'support': 228228}, 'accuracy': 0.36125501455851655, 'macro avg': {'precision': 0.3559052063148807, 'recall': 0.35323262157895724, 'f1-score': 0.3191609316106189, 'support': 667307}, 'weighted avg': {'precision': 0.3565029728697093, 'recall': 0.36125501455851655, 'f1-score': 0.32419480829353264, 'support': 667307}}
[[149894  21396  58800]
 [128511  21701  58777]
 [137195  21560  69473]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925628
{'0': {'precision': 0.36179643136119083, 'recall': 0.6694382642869903, 'f1-score': 0.46972891051426097, 'support': 61577}, '1': {'precision': 0.3847393575636323, 'recall': 0.11362405422705116, 'f1-score': 0.17543681816454013, 'support': 60929}, '2': {'precision': 0.38325623720330626, 'recall': 0.3251572225885835, 'f1-score': 0.3518242966907702, 'support': 62173}, 'accuracy': 0.3701611986203088, 'macro avg': {'precision': 0.37659734204270984, 'recall': 0.369406513700875, 'f1-score': 0.3323300084565238, 'support': 184679}, 'weighted avg': {'precision': 0.37659026314071314, 'recall': 0.3701611986203088, 'f1-score': 0.3329434262414198, 'support': 184679}}
[[41222  5574 14781]
 [36255  6923 17751]
 [36460  5497 20216]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0946574
{'0': {'precision': 0.36866989461691824, 'recall': 0.644428955491387, 'f1-score': 0.46901949416624383, 'support': 20086}, '1': {'precision': 0.3451785118451785, 'recall': 0.11388781857213628, 'f1-score': 0.17126774554033358, 'support': 18167}, '2': {'precision': 0.3829324236899371, 'recall': 0.3279439911352876, 'f1-score': 0.3533114469435928, 'support': 19854}, 'accuracy': 0.3704200870807304, 'macro avg': {'precision': 0.36559361005067786, 'recall': 0.36208692173293694, 'f1-score': 0.3311995622167234, 'support': 58107}, 'weighted avg': {'precision': 0.36619859686280115, 'recall': 0.3704200870807304, 'f1-score': 0.3363930707259454, 'support': 58107}}
[[12944  1998  5144]
 [10750  2069  5348]
 [11416  1927  6511]]
training model: results/PCAR/W1/deepOF_L1/h200
Epoch 1/50
722/722 - 12s - loss: 3.3267 - accuracy200: 0.3445 - val_loss: 3.3099 - val_accuracy200: 0.3456 - 12s/epoch - 16ms/step
Epoch 2/50
722/722 - 10s - loss: 3.3038 - accuracy200: 0.3516 - val_loss: 3.2980 - val_accuracy200: 0.3561 - 10s/epoch - 14ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2967 - accuracy200: 0.3557 - val_loss: 3.2928 - val_accuracy200: 0.3589 - 10s/epoch - 14ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2917 - accuracy200: 0.3577 - val_loss: 3.2901 - val_accuracy200: 0.3638 - 10s/epoch - 14ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2898 - accuracy200: 0.3587 - val_loss: 3.2880 - val_accuracy200: 0.3644 - 10s/epoch - 13ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2880 - accuracy200: 0.3613 - val_loss: 3.2863 - val_accuracy200: 0.3648 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2856 - accuracy200: 0.3624 - val_loss: 3.2852 - val_accuracy200: 0.3674 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2845 - accuracy200: 0.3637 - val_loss: 3.2848 - val_accuracy200: 0.3657 - 10s/epoch - 14ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2838 - accuracy200: 0.3631 - val_loss: 3.2853 - val_accuracy200: 0.3662 - 10s/epoch - 14ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2824 - accuracy200: 0.3655 - val_loss: 3.2847 - val_accuracy200: 0.3686 - 10s/epoch - 14ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2814 - accuracy200: 0.3661 - val_loss: 3.2849 - val_accuracy200: 0.3686 - 10s/epoch - 14ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2806 - accuracy200: 0.3672 - val_loss: 3.2850 - val_accuracy200: 0.3667 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2799 - accuracy200: 0.3687 - val_loss: 3.2858 - val_accuracy200: 0.3670 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2790 - accuracy200: 0.3686 - val_loss: 3.2865 - val_accuracy200: 0.3664 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2781 - accuracy200: 0.3706 - val_loss: 3.2860 - val_accuracy200: 0.3690 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2773 - accuracy200: 0.3710 - val_loss: 3.2868 - val_accuracy200: 0.3663 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2759 - accuracy200: 0.3725 - val_loss: 3.2861 - val_accuracy200: 0.3683 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2758 - accuracy200: 0.3725 - val_loss: 3.2861 - val_accuracy200: 0.3685 - 10s/epoch - 13ms/step
Epoch 19/50
722/722 - 10s - loss: 3.2746 - accuracy200: 0.3731 - val_loss: 3.2872 - val_accuracy200: 0.3656 - 10s/epoch - 14ms/step
Epoch 20/50
722/722 - 10s - loss: 3.2738 - accuracy200: 0.3739 - val_loss: 3.2870 - val_accuracy200: 0.3646 - 10s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h200
Evaluating performance on  test set...
2607/2607 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980365
{'0': {'precision': 0.3539763538063247, 'recall': 0.7588918398166953, 'f1-score': 0.48277013923301065, 'support': 230436}, '1': {'precision': 0.32049508554787043, 'recall': 0.02110208288391937, 'f1-score': 0.03959701358280112, 'support': 208605}, '2': {'precision': 0.3658415810554159, 'recall': 0.2556929196639009, 'f1-score': 0.3010069493688839, 'support': 228266}, 'accuracy': 0.3561239429527938, 'macro avg': {'precision': 0.34677100680320366, 'recall': 0.3452289474548385, 'f1-score': 0.2744580340615652, 'support': 667307}, 'weighted avg': {'precision': 0.34756861044110626, 'recall': 0.3561239429527938, 'f1-score': 0.2820551966746579, 'support': 667307}}
[[174876   4267  51293]
 [154323   4402  49880]
 [164834   5066  58366]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0961882
{'0': {'precision': 0.35143161399667033, 'recall': 0.7594768487755863, 'f1-score': 0.4805151526026793, 'support': 61703}, '1': {'precision': 0.399732364748614, 'recall': 0.03434117820952882, 'f1-score': 0.06324863883847551, 'support': 60889}, '2': {'precision': 0.37503795930762224, 'recall': 0.2784801971427191, 'f1-score': 0.319625839965246, 'support': 62087}, 'accuracy': 0.3586926504908517, 'macro avg': {'precision': 0.37540064601763556, 'recall': 0.3574327413759448, 'f1-score': 0.28779654380213365, 'support': 184679}, 'weighted avg': {'precision': 0.3752926462410304, 'recall': 0.3586926504908517, 'f1-score': 0.28885245402672355, 'support': 184679}}
[[46862  1501 13340]
 [43326  2091 15472]
 [43158  1639 17290]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0955492
{'0': {'precision': 0.36552207089732447, 'recall': 0.738282202604497, 'f1-score': 0.4889606718888799, 'support': 20503}, '1': {'precision': 0.3238815374921235, 'recall': 0.02992547741034001, 'f1-score': 0.05478867984863828, 'support': 17176}, '2': {'precision': 0.3749669049510193, 'recall': 0.2773154493831995, 'f1-score': 0.3188316073840612, 'support': 20428}, 'accuracy': 0.36684048393480995, 'macro avg': {'precision': 0.3547901711134891, 'recall': 0.3485077097993455, 'f1-score': 0.2875269863738598, 'support': 58107}, 'weighted avg': {'precision': 0.35653384690161216, 'recall': 0.36684048393480995, 'f1-score': 0.30081234784895994, 'support': 58107}}
[[15137   495  4871]
 [12090   514  4572]
 [14185   578  5665]]
training model: results/PCAR/W1/deepOF_L1/h300
Epoch 1/50
722/722 - 12s - loss: 3.3218 - accuracy300: 0.3565 - val_loss: 3.2978 - val_accuracy300: 0.3611 - 12s/epoch - 16ms/step
Epoch 2/50
722/722 - 10s - loss: 3.2973 - accuracy300: 0.3633 - val_loss: 3.2942 - val_accuracy300: 0.3648 - 10s/epoch - 13ms/step
Epoch 3/50
722/722 - 10s - loss: 3.2919 - accuracy300: 0.3635 - val_loss: 3.2908 - val_accuracy300: 0.3628 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2889 - accuracy300: 0.3638 - val_loss: 3.2866 - val_accuracy300: 0.3665 - 10s/epoch - 14ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2884 - accuracy300: 0.3633 - val_loss: 3.2853 - val_accuracy300: 0.3661 - 10s/epoch - 13ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2875 - accuracy300: 0.3618 - val_loss: 3.2829 - val_accuracy300: 0.3679 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2860 - accuracy300: 0.3644 - val_loss: 3.2819 - val_accuracy300: 0.3693 - 10s/epoch - 13ms/step
Epoch 8/50
722/722 - 9s - loss: 3.2850 - accuracy300: 0.3646 - val_loss: 3.2820 - val_accuracy300: 0.3657 - 9s/epoch - 13ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2846 - accuracy300: 0.3647 - val_loss: 3.2822 - val_accuracy300: 0.3654 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2827 - accuracy300: 0.3657 - val_loss: 3.2807 - val_accuracy300: 0.3676 - 10s/epoch - 14ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2819 - accuracy300: 0.3671 - val_loss: 3.2806 - val_accuracy300: 0.3676 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2801 - accuracy300: 0.3686 - val_loss: 3.2813 - val_accuracy300: 0.3664 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2788 - accuracy300: 0.3705 - val_loss: 3.2810 - val_accuracy300: 0.3686 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2770 - accuracy300: 0.3716 - val_loss: 3.2811 - val_accuracy300: 0.3684 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2751 - accuracy300: 0.3738 - val_loss: 3.2812 - val_accuracy300: 0.3664 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2738 - accuracy300: 0.3757 - val_loss: 3.2822 - val_accuracy300: 0.3675 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2712 - accuracy300: 0.3775 - val_loss: 3.2823 - val_accuracy300: 0.3671 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2696 - accuracy300: 0.3787 - val_loss: 3.2817 - val_accuracy300: 0.3689 - 10s/epoch - 14ms/step
Epoch 19/50
722/722 - 10s - loss: 3.2680 - accuracy300: 0.3804 - val_loss: 3.2825 - val_accuracy300: 0.3677 - 10s/epoch - 14ms/step
Epoch 20/50
722/722 - 10s - loss: 3.2661 - accuracy300: 0.3812 - val_loss: 3.2833 - val_accuracy300: 0.3655 - 10s/epoch - 13ms/step
Epoch 21/50
722/722 - 10s - loss: 3.2648 - accuracy300: 0.3821 - val_loss: 3.2826 - val_accuracy300: 0.3661 - 10s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h300
Evaluating performance on  test set...
2607/2607 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0997607
{'0': {'precision': 0.35645320377418077, 'recall': 0.6708256169516345, 'f1-score': 0.4655365914528535, 'support': 232190}, '1': {'precision': 0.3790794979079498, 'recall': 0.00441552745083705, 'f1-score': 0.008729374924726002, 'support': 205185}, '2': {'precision': 0.36100338673732607, 'recall': 0.35788841918480246, 'f1-score': 0.3594391543635887, 'support': 229932}, 'accuracy': 0.3580885559420177, 'macro avg': {'precision': 0.3655120294731522, 'recall': 0.34437652119575796, 'f1-score': 0.2779017069137227, 'support': 667307}, 'weighted avg': {'precision': 0.3649782287340858, 'recall': 0.3580885559420177, 'f1-score': 0.2885188400608665, 'support': 667307}}
[[155759    676  75755]
 [134376    906  69903]
 [146834    808  82290]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1026331
{'0': {'precision': 0.3509039388867715, 'recall': 0.6861179062646816, 'f1-score': 0.464332505577757, 'support': 61727}, '1': {'precision': 0.46431199411331864, 'recall': 0.010336298261994857, 'f1-score': 0.020222414511425185, 'support': 61047}, '2': {'precision': 0.36125570849168076, 'recall': 0.36546320975688557, 'f1-score': 0.3633472789907734, 'support': 61905}, 'accuracy': 0.35524883717152467, 'macro avg': {'precision': 0.39215721383059027, 'recall': 0.35397247142785404, 'f1-score': 0.28263406635998517, 'support': 184679}, 'weighted avg': {'precision': 0.39186175133327017, 'recall': 0.35524883717152467, 'f1-score': 0.28367807718474225, 'support': 184679}}
[[42352   385 18990]
 [39404   631 21012]
 [38938   343 22624]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0934117
{'0': {'precision': 0.365187897060407, 'recall': 0.6582880434782609, 'f1-score': 0.4697693746104301, 'support': 20608}, '1': {'precision': 0.34748010610079577, 'recall': 0.007846190704360326, 'f1-score': 0.015345867744391731, 'support': 16696}, '2': {'precision': 0.37367602759692936, 'recall': 0.3697062923616786, 'f1-score': 0.3716805605895856, 'support': 20803}, 'accuracy': 0.36807957733147467, 'macro avg': {'precision': 0.3621146769193773, 'recall': 0.3452801755147666, 'f1-score': 0.2855986009814691, 'support': 58107}, 'weighted avg': {'precision': 0.36313873433800875, 'recall': 0.36807957733147467, 'f1-score': 0.3040819966919176, 'support': 58107}}
[[13566   121  6921]
 [10595   131  5970]
 [12987   125  7691]]
training model: results/PCAR/W1/deepOF_L1/h500
Epoch 1/50
722/722 - 12s - loss: 3.3323 - accuracy500: 0.3469 - val_loss: 3.3139 - val_accuracy500: 0.3385 - 12s/epoch - 16ms/step
Epoch 2/50
722/722 - 10s - loss: 3.3090 - accuracy500: 0.3514 - val_loss: 3.3076 - val_accuracy500: 0.3404 - 10s/epoch - 13ms/step
Epoch 3/50
722/722 - 10s - loss: 3.3017 - accuracy500: 0.3530 - val_loss: 3.3022 - val_accuracy500: 0.3448 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.2977 - accuracy500: 0.3539 - val_loss: 3.2996 - val_accuracy500: 0.3454 - 10s/epoch - 14ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2951 - accuracy500: 0.3554 - val_loss: 3.2987 - val_accuracy500: 0.3469 - 10s/epoch - 14ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2936 - accuracy500: 0.3537 - val_loss: 3.2967 - val_accuracy500: 0.3464 - 10s/epoch - 14ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2922 - accuracy500: 0.3550 - val_loss: 3.2957 - val_accuracy500: 0.3499 - 10s/epoch - 14ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2909 - accuracy500: 0.3551 - val_loss: 3.2951 - val_accuracy500: 0.3468 - 10s/epoch - 13ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2903 - accuracy500: 0.3566 - val_loss: 3.2949 - val_accuracy500: 0.3480 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2892 - accuracy500: 0.3564 - val_loss: 3.2951 - val_accuracy500: 0.3480 - 10s/epoch - 13ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2880 - accuracy500: 0.3578 - val_loss: 3.2953 - val_accuracy500: 0.3477 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2863 - accuracy500: 0.3595 - val_loss: 3.2939 - val_accuracy500: 0.3482 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2859 - accuracy500: 0.3598 - val_loss: 3.2955 - val_accuracy500: 0.3467 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 9s - loss: 3.2844 - accuracy500: 0.3637 - val_loss: 3.2955 - val_accuracy500: 0.3451 - 9s/epoch - 13ms/step
Epoch 15/50
722/722 - 10s - loss: 3.2838 - accuracy500: 0.3630 - val_loss: 3.2958 - val_accuracy500: 0.3456 - 10s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2831 - accuracy500: 0.3639 - val_loss: 3.2968 - val_accuracy500: 0.3462 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2815 - accuracy500: 0.3650 - val_loss: 3.2968 - val_accuracy500: 0.3461 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 9s - loss: 3.2808 - accuracy500: 0.3670 - val_loss: 3.2982 - val_accuracy500: 0.3440 - 9s/epoch - 13ms/step
Epoch 19/50
722/722 - 9s - loss: 3.2792 - accuracy500: 0.3674 - val_loss: 3.2982 - val_accuracy500: 0.3416 - 9s/epoch - 13ms/step
Epoch 20/50
722/722 - 10s - loss: 3.2774 - accuracy500: 0.3700 - val_loss: 3.2988 - val_accuracy500: 0.3409 - 10s/epoch - 13ms/step
Epoch 21/50
722/722 - 10s - loss: 3.2765 - accuracy500: 0.3706 - val_loss: 3.2996 - val_accuracy500: 0.3398 - 10s/epoch - 13ms/step
Epoch 22/50
722/722 - 9s - loss: 3.2756 - accuracy500: 0.3719 - val_loss: 3.2994 - val_accuracy500: 0.3436 - 9s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h500
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984246
{'0': {'precision': 0.35013493006296736, 'recall': 0.4445069194725945, 'f1-score': 0.3917170968355269, 'support': 229425}, '1': {'precision': 0.3188259885705519, 'recall': 0.15883350450213762, 'f1-score': 0.2120349321030363, 'support': 209345}, '2': {'precision': 0.34931721084955825, 'recall': 0.4153725654926773, 'f1-score': 0.37949189470107336, 'support': 228537}, 'accuracy': 0.3449087151790705, 'macro avg': {'precision': 0.33942604316102587, 'recall': 0.3395709964891365, 'f1-score': 0.32774797454654553, 'support': 667307}, 'weighted avg': {'precision': 0.3400327590193479, 'recall': 0.3449087151790705, 'f1-score': 0.33116105022410985, 'support': 667307}}
[[101981  36130  91314]
 [ 90583  33251  85511]
 [ 98698  34911  94928]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09622
{'0': {'precision': 0.3569430405040081, 'recall': 0.4864639733444398, 'f1-score': 0.41175832519796074, 'support': 62426}, '1': {'precision': 0.35890176209812613, 'recall': 0.15927389356390628, 'f1-score': 0.2206343753578381, 'support': 60487}, '2': {'precision': 0.35358311113554525, 'recall': 0.4165074636531425, 'f1-score': 0.38247450269096966, 'support': 61766}, 'accuracy': 0.35590402807032745, 'macro avg': {'precision': 0.35647597124589314, 'recall': 0.3540817768538296, 'f1-score': 0.3382890677489228, 'support': 184679}, 'weighted avg': {'precision': 0.3564608405553996, 'recall': 0.35590402807032745, 'f1-score': 0.3393664510003188, 'support': 184679}}
[[30368  8858 23200]
 [27021  9634 23832]
 [27689  8351 25726]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984123
{'0': {'precision': 0.3463968179691156, 'recall': 0.4501368197020371, 'f1-score': 0.3915113050376835, 'support': 19734}, '1': {'precision': 0.3276017082490447, 'recall': 0.15970852509314049, 'f1-score': 0.2147329650092081, 'support': 18252}, '2': {'precision': 0.35204752811372797, 'recall': 0.41230555141394565, 'f1-score': 0.37980130934395456, 'support': 20121}, 'accuracy': 0.3458103154525272, 'macro avg': {'precision': 0.3420153514439628, 'recall': 0.3407169654030411, 'f1-score': 0.32868185979694875, 'support': 58107}, 'weighted avg': {'precision': 0.34244978226272926, 'recall': 0.3458103154525272, 'f1-score': 0.33192855105704, 'support': 58107}}
[[8883 2998 7853]
 [7921 2915 7416]
 [8840 2985 8296]]
training model: results/PCAR/W1/deepOF_L1/h1000
Epoch 1/50
722/722 - 13s - loss: 3.3375 - accuracy1000: 0.3411 - val_loss: 3.3183 - val_accuracy1000: 0.3350 - 13s/epoch - 17ms/step
Epoch 2/50
722/722 - 10s - loss: 3.3147 - accuracy1000: 0.3446 - val_loss: 3.3092 - val_accuracy1000: 0.3356 - 10s/epoch - 14ms/step
Epoch 3/50
722/722 - 10s - loss: 3.3060 - accuracy1000: 0.3451 - val_loss: 3.3041 - val_accuracy1000: 0.3316 - 10s/epoch - 13ms/step
Epoch 4/50
722/722 - 10s - loss: 3.3007 - accuracy1000: 0.3479 - val_loss: 3.3016 - val_accuracy1000: 0.3313 - 10s/epoch - 13ms/step
Epoch 5/50
722/722 - 10s - loss: 3.2978 - accuracy1000: 0.3492 - val_loss: 3.2985 - val_accuracy1000: 0.3374 - 10s/epoch - 14ms/step
Epoch 6/50
722/722 - 10s - loss: 3.2954 - accuracy1000: 0.3525 - val_loss: 3.2983 - val_accuracy1000: 0.3361 - 10s/epoch - 13ms/step
Epoch 7/50
722/722 - 10s - loss: 3.2943 - accuracy1000: 0.3525 - val_loss: 3.2976 - val_accuracy1000: 0.3355 - 10s/epoch - 14ms/step
Epoch 8/50
722/722 - 10s - loss: 3.2932 - accuracy1000: 0.3535 - val_loss: 3.2974 - val_accuracy1000: 0.3372 - 10s/epoch - 14ms/step
Epoch 9/50
722/722 - 10s - loss: 3.2913 - accuracy1000: 0.3554 - val_loss: 3.2981 - val_accuracy1000: 0.3371 - 10s/epoch - 13ms/step
Epoch 10/50
722/722 - 10s - loss: 3.2913 - accuracy1000: 0.3566 - val_loss: 3.2978 - val_accuracy1000: 0.3343 - 10s/epoch - 13ms/step
Epoch 11/50
722/722 - 10s - loss: 3.2900 - accuracy1000: 0.3578 - val_loss: 3.2987 - val_accuracy1000: 0.3325 - 10s/epoch - 13ms/step
Epoch 12/50
722/722 - 10s - loss: 3.2885 - accuracy1000: 0.3586 - val_loss: 3.2990 - val_accuracy1000: 0.3318 - 10s/epoch - 13ms/step
Epoch 13/50
722/722 - 10s - loss: 3.2880 - accuracy1000: 0.3595 - val_loss: 3.2993 - val_accuracy1000: 0.3318 - 10s/epoch - 13ms/step
Epoch 14/50
722/722 - 10s - loss: 3.2871 - accuracy1000: 0.3615 - val_loss: 3.3002 - val_accuracy1000: 0.3303 - 10s/epoch - 13ms/step
Epoch 15/50
722/722 - 9s - loss: 3.2854 - accuracy1000: 0.3629 - val_loss: 3.3006 - val_accuracy1000: 0.3275 - 9s/epoch - 13ms/step
Epoch 16/50
722/722 - 10s - loss: 3.2856 - accuracy1000: 0.3629 - val_loss: 3.3016 - val_accuracy1000: 0.3300 - 10s/epoch - 13ms/step
Epoch 17/50
722/722 - 10s - loss: 3.2848 - accuracy1000: 0.3632 - val_loss: 3.3022 - val_accuracy1000: 0.3309 - 10s/epoch - 13ms/step
Epoch 18/50
722/722 - 10s - loss: 3.2833 - accuracy1000: 0.3651 - val_loss: 3.3030 - val_accuracy1000: 0.3282 - 10s/epoch - 13ms/step
testing model: results/PCAR/W1/deepOF_L1/h1000
Evaluating performance on  test set...
2607/2607 - 18s - 18s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0995251
{'0': {'precision': 0.35554815061646117, 'recall': 0.2674867219035479, 'f1-score': 0.3052940163769462, 'support': 235350}, '1': {'precision': 0.29850993441246587, 'recall': 0.3883255343239912, 'f1-score': 0.3375452639188592, 'support': 199598}, '2': {'precision': 0.3567336672521087, 'recall': 0.35402545199454294, 'f1-score': 0.35537440004838494, 'support': 232359}, 'accuracy': 0.33376391975507524, 'macro avg': {'precision': 0.33693058409367854, 'recall': 0.3366125694073607, 'f1-score': 0.3327378934480634, 'support': 667307}, 'weighted avg': {'precision': 0.3389002682805309, 'recall': 0.33376391975507524, 'f1-score': 0.3323788699396731, 'support': 667307}}
[[62953 93119 79278]
 [53033 77509 69056]
 [61073 89025 82261]]
Evaluating performance on  train set...
722/722 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0979238
{'0': {'precision': 0.3595557799091368, 'recall': 0.2830326631169038, 'f1-score': 0.31673781572394166, 'support': 62915}, '1': {'precision': 0.3317691749064298, 'recall': 0.39598613148419787, 'f1-score': 0.3610444086446396, 'support': 59992}, '2': {'precision': 0.3479464988198269, 'recall': 0.3579615359709901, 'f1-score': 0.3528829734603661, 'support': 61772}, 'accuracy': 0.34478744199394623, 'macro avg': {'precision': 0.3464238178784645, 'recall': 0.34566011019069726, 'f1-score': 0.34355506594298246, 'support': 184679}, 'weighted avg': {'precision': 0.34664633964375063, 'recall': 0.34478744199394623, 'f1-score': 0.3432205225081073, 'support': 184679}}
[[17807 24238 20870]
 [15668 23756 20568]
 [16050 23610 22112]]
Evaluating performance on  val set...
227/227 - 1s - 1s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0993062
{'0': {'precision': 0.3431971695078804, 'recall': 0.2722772277227723, 'f1-score': 0.3036512137511028, 'support': 19594}, '1': {'precision': 0.32365714285714287, 'recall': 0.37784181876400896, 'f1-score': 0.348656834018664, 'support': 18738}, '2': {'precision': 0.3474645912892155, 'recall': 0.3634892541087231, 'f1-score': 0.35529632741831846, 'support': 19775}, 'accuracy': 0.33736038687249387, 'macro avg': {'precision': 0.3381063012180796, 'recall': 0.3378694335318348, 'f1-score': 0.3358681250626951, 'support': 58107}, 'weighted avg': {'precision': 0.33834830872250826, 'recall': 0.33736038687249387, 'f1-score': 0.33574024666181496, 'support': 58107}}
[[5335 7426 6833]
 [4992 7080 6666]
 [5218 7369 7188]]
training model: results/PCAR/W1/deepLOB_L2/h10
Epoch 1/50
722/722 - 32s - loss: 3.2576 - accuracy10: 0.4031 - val_loss: 3.4778 - val_accuracy10: 0.3519 - 32s/epoch - 44ms/step
Epoch 2/50
722/722 - 30s - loss: 3.1071 - accuracy10: 0.4556 - val_loss: 3.2811 - val_accuracy10: 0.4087 - 30s/epoch - 42ms/step
Epoch 3/50
722/722 - 30s - loss: 3.0230 - accuracy10: 0.4827 - val_loss: 3.1833 - val_accuracy10: 0.4401 - 30s/epoch - 41ms/step
Epoch 4/50
722/722 - 30s - loss: 2.9884 - accuracy10: 0.4925 - val_loss: 3.1272 - val_accuracy10: 0.4553 - 30s/epoch - 41ms/step
Epoch 5/50
722/722 - 30s - loss: 2.9581 - accuracy10: 0.5015 - val_loss: 3.1089 - val_accuracy10: 0.4589 - 30s/epoch - 41ms/step
Epoch 6/50
722/722 - 29s - loss: 2.9326 - accuracy10: 0.5096 - val_loss: 3.0910 - val_accuracy10: 0.4656 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 29s - loss: 2.9111 - accuracy10: 0.5164 - val_loss: 3.0764 - val_accuracy10: 0.4723 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 29s - loss: 2.8980 - accuracy10: 0.5202 - val_loss: 3.0722 - val_accuracy10: 0.4743 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 29s - loss: 2.8809 - accuracy10: 0.5253 - val_loss: 3.0687 - val_accuracy10: 0.4783 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 29s - loss: 2.8694 - accuracy10: 0.5289 - val_loss: 3.0675 - val_accuracy10: 0.4784 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 29s - loss: 2.8591 - accuracy10: 0.5318 - val_loss: 3.0565 - val_accuracy10: 0.4824 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 2.8495 - accuracy10: 0.5339 - val_loss: 3.0519 - val_accuracy10: 0.4865 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 29s - loss: 2.8411 - accuracy10: 0.5368 - val_loss: 3.0483 - val_accuracy10: 0.4872 - 29s/epoch - 40ms/step
Epoch 14/50
722/722 - 29s - loss: 2.8315 - accuracy10: 0.5395 - val_loss: 3.0453 - val_accuracy10: 0.4851 - 29s/epoch - 40ms/step
Epoch 15/50
722/722 - 29s - loss: 2.8226 - accuracy10: 0.5416 - val_loss: 3.0547 - val_accuracy10: 0.4865 - 29s/epoch - 40ms/step
Epoch 16/50
722/722 - 28s - loss: 2.8144 - accuracy10: 0.5434 - val_loss: 3.0537 - val_accuracy10: 0.4885 - 28s/epoch - 39ms/step
Epoch 17/50
722/722 - 29s - loss: 2.8087 - accuracy10: 0.5451 - val_loss: 3.0488 - val_accuracy10: 0.4885 - 29s/epoch - 40ms/step
Epoch 18/50
722/722 - 29s - loss: 2.7984 - accuracy10: 0.5468 - val_loss: 3.0471 - val_accuracy10: 0.4903 - 29s/epoch - 40ms/step
Epoch 19/50
722/722 - 29s - loss: 2.7902 - accuracy10: 0.5501 - val_loss: 3.0496 - val_accuracy10: 0.4912 - 29s/epoch - 40ms/step
Epoch 20/50
722/722 - 28s - loss: 2.7828 - accuracy10: 0.5517 - val_loss: 3.0540 - val_accuracy10: 0.4923 - 28s/epoch - 39ms/step
Epoch 21/50
722/722 - 28s - loss: 2.7749 - accuracy10: 0.5527 - val_loss: 3.0539 - val_accuracy10: 0.4906 - 28s/epoch - 39ms/step
Epoch 22/50
722/722 - 29s - loss: 2.7681 - accuracy10: 0.5548 - val_loss: 3.0649 - val_accuracy10: 0.4897 - 29s/epoch - 40ms/step
Epoch 23/50
722/722 - 29s - loss: 2.7603 - accuracy10: 0.5562 - val_loss: 3.0755 - val_accuracy10: 0.4890 - 29s/epoch - 40ms/step
Epoch 24/50
722/722 - 29s - loss: 2.7544 - accuracy10: 0.5566 - val_loss: 3.0660 - val_accuracy10: 0.4909 - 29s/epoch - 40ms/step
testing model: results/PCAR/W1/deepLOB_L2/h10
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0207533
{'0': {'precision': 0.48083414394059765, 'recall': 0.5390025631000478, 'f1-score': 0.5082594776610061, 'support': 230190}, '1': {'precision': 0.5576559855440995, 'recall': 0.3158233504512556, 'f1-score': 0.4032626176623622, 'support': 215953}, '2': {'precision': 0.46458539509081026, 'recall': 0.6028105204617283, 'f1-score': 0.524748052213854, 'support': 221169}, 'accuracy': 0.4879261874505479, 'macro avg': {'precision': 0.5010251748585025, 'recall': 0.48587881133767724, 'f1-score': 0.4787567158457408, 'support': 667312}, 'weighted avg': {'precision': 0.5003095731632737, 'recall': 0.4879261874505479, 'f1-score': 0.47974564101187, 'support': 667312}}
[[124073  27263  78854]
 [ 72955  68203  74795]
 [ 61009  26837 133323]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9972618
{'0': {'precision': 0.4633370985960949, 'recall': 0.5246779351301964, 'f1-score': 0.49210334633017694, 'support': 54725}, '1': {'precision': 0.6588294886135793, 'recall': 0.4128936682406783, 'f1-score': 0.5076432706693553, 'support': 75603}, '2': {'precision': 0.4424723546044684, 'recall': 0.6132433029143362, 'f1-score': 0.5140460051973689, 'support': 54352}, 'accuracy': 0.5049815897769114, 'macro avg': {'precision': 0.5215463139380475, 'recall': 0.5169383020950703, 'f1-score': 0.5045975407323003, 'support': 184680}, 'weighted avg': {'precision': 0.5372258282747768, 'recall': 0.5049815897769114, 'f1-score': 0.5049227761253064, 'support': 184680}}
[[28713  8334 17678]
 [20067 31216 24320]
 [13190  7831 33331]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0213451
{'0': {'precision': 0.4713809266270056, 'recall': 0.556981574182554, 'f1-score': 0.510618561734121, 'support': 18778}, '1': {'precision': 0.5776906318082788, 'recall': 0.3218898708361659, 'f1-score': 0.41342106083756897, 'support': 20594}, '2': {'precision': 0.45592145633053793, 'recall': 0.5948441502988898, 'f1-score': 0.5161992543016605, 'support': 18736}, 'accuracy': 0.48587113650444, 'macro avg': {'precision': 0.501664338255274, 'recall': 0.49123853177253657, 'f1-score': 0.48007962562445017, 'support': 58108}, 'weighted avg': {'precision': 0.5040733860650954, 'recall': 0.48587113650444, 'f1-score': 0.4779702951009866, 'support': 58108}}
[[10459  2263  6056]
 [ 6721  6629  7244]
 [ 5008  2583 11145]]
training model: results/PCAR/W1/deepLOB_L2/h20
Epoch 1/50
722/722 - 31s - loss: 3.2647 - accuracy20: 0.3956 - val_loss: 3.3356 - val_accuracy20: 0.3680 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.1432 - accuracy20: 0.4445 - val_loss: 3.1897 - val_accuracy20: 0.4367 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.0753 - accuracy20: 0.4704 - val_loss: 3.1375 - val_accuracy20: 0.4576 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 29s - loss: 3.0436 - accuracy20: 0.4825 - val_loss: 3.1218 - val_accuracy20: 0.4631 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.0240 - accuracy20: 0.4887 - val_loss: 3.1051 - val_accuracy20: 0.4678 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.0086 - accuracy20: 0.4935 - val_loss: 3.1160 - val_accuracy20: 0.4642 - 29s/epoch - 39ms/step
Epoch 7/50
722/722 - 28s - loss: 2.9978 - accuracy20: 0.4973 - val_loss: 3.1069 - val_accuracy20: 0.4683 - 28s/epoch - 39ms/step
Epoch 8/50
722/722 - 28s - loss: 2.9884 - accuracy20: 0.4999 - val_loss: 3.1041 - val_accuracy20: 0.4686 - 28s/epoch - 39ms/step
Epoch 9/50
722/722 - 29s - loss: 2.9791 - accuracy20: 0.5033 - val_loss: 3.1003 - val_accuracy20: 0.4693 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 29s - loss: 2.9712 - accuracy20: 0.5054 - val_loss: 3.0985 - val_accuracy20: 0.4683 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 29s - loss: 2.9618 - accuracy20: 0.5074 - val_loss: 3.0968 - val_accuracy20: 0.4705 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 2.9537 - accuracy20: 0.5105 - val_loss: 3.0956 - val_accuracy20: 0.4692 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 29s - loss: 2.9465 - accuracy20: 0.5125 - val_loss: 3.1037 - val_accuracy20: 0.4690 - 29s/epoch - 40ms/step
Epoch 14/50
722/722 - 29s - loss: 2.9395 - accuracy20: 0.5146 - val_loss: 3.1191 - val_accuracy20: 0.4665 - 29s/epoch - 40ms/step
Epoch 15/50
722/722 - 28s - loss: 2.9320 - accuracy20: 0.5154 - val_loss: 3.1167 - val_accuracy20: 0.4670 - 28s/epoch - 39ms/step
Epoch 16/50
722/722 - 29s - loss: 2.9243 - accuracy20: 0.5191 - val_loss: 3.1210 - val_accuracy20: 0.4664 - 29s/epoch - 40ms/step
Epoch 17/50
722/722 - 29s - loss: 2.9183 - accuracy20: 0.5196 - val_loss: 3.1333 - val_accuracy20: 0.4655 - 29s/epoch - 40ms/step
Epoch 18/50
722/722 - 29s - loss: 2.9109 - accuracy20: 0.5222 - val_loss: 3.1351 - val_accuracy20: 0.4667 - 29s/epoch - 40ms/step
Epoch 19/50
722/722 - 28s - loss: 2.9054 - accuracy20: 0.5242 - val_loss: 3.1365 - val_accuracy20: 0.4670 - 28s/epoch - 39ms/step
Epoch 20/50
722/722 - 29s - loss: 2.8967 - accuracy20: 0.5257 - val_loss: 3.1503 - val_accuracy20: 0.4652 - 29s/epoch - 40ms/step
Epoch 21/50
722/722 - 29s - loss: 2.8920 - accuracy20: 0.5266 - val_loss: 3.1531 - val_accuracy20: 0.4648 - 29s/epoch - 40ms/step
Epoch 22/50
722/722 - 28s - loss: 2.8848 - accuracy20: 0.5284 - val_loss: 3.1606 - val_accuracy20: 0.4646 - 28s/epoch - 39ms/step
testing model: results/PCAR/W1/deepLOB_L2/h20
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0364627
{'0': {'precision': 0.4856763153962899, 'recall': 0.4865256607192091, 'f1-score': 0.4861006170507493, 'support': 253890}, '1': {'precision': 0.409010277145381, 'recall': 0.3439194656811237, 'f1-score': 0.37365131956632275, 'support': 165594}, '2': {'precision': 0.47733408344505857, 'recall': 0.5272366318575786, 'f1-score': 0.5010458907326987, 'support': 247828}, 'accuracy': 0.46625716306615195, 'macro avg': {'precision': 0.45734022532890983, 'recall': 0.4525605860859705, 'f1-score': 0.45359927578325693, 'support': 667312}, 'weighted avg': {'precision': 0.4635534184633249, 'recall': 0.46625716306615195, 'f1-score': 0.46374664817024663, 'support': 667312}}
[[123524  41814  88552]
 [ 54122  56951  54521]
 [ 76688  40476 130664]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0270057
{'0': {'precision': 0.4595474082410207, 'recall': 0.5461855803010282, 'f1-score': 0.49913480159343776, 'support': 62054}, '1': {'precision': 0.5065140845070423, 'recall': 0.47560007934933546, 'f1-score': 0.49057054189544047, 'support': 60492}, '2': {'precision': 0.478947660132651, 'recall': 0.41722728296906686, 'f1-score': 0.44596210251073015, 'support': 62134}, 'accuracy': 0.4796783625730994, 'macro avg': {'precision': 0.4816697176269047, 'recall': 0.47967098087314347, 'f1-score': 0.4785558153332028, 'support': 184680}, 'weighted avg': {'precision': 0.48145840797958867, 'recall': 0.4796783625730994, 'f1-score': 0.4784400773003025, 'support': 184680}}
[[33893 13980 14181]
 [17700 28770 14022]
 [22160 14050 25924]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0328768
{'0': {'precision': 0.499312115931395, 'recall': 0.5115579778237174, 'f1-score': 0.5053608725922489, 'support': 21284}, '1': {'precision': 0.42300757302560404, 'recall': 0.37394797245600614, 'f1-score': 0.3969677484855663, 'support': 15684}, '2': {'precision': 0.47528635735615277, 'recall': 0.5044465468306528, 'f1-score': 0.489432498795236, 'support': 21140}, 'accuracy': 0.47182831968059474, 'macro avg': {'precision': 0.465868682104384, 'recall': 0.46331749903679215, 'f1-score': 0.4639203732910171, 'support': 58108}, 'weighted avg': {'precision': 0.46997596622369475, 'recall': 0.47182831968059474, 'f1-score': 0.47030952715688606, 'support': 58108}}
[[10888  3993  6403]
 [ 4449  5865  5370]
 [ 6469  4007 10664]]
training model: results/PCAR/W1/deepLOB_L2/h30
Epoch 1/50
722/722 - 31s - loss: 3.2776 - accuracy30: 0.3846 - val_loss: 3.4086 - val_accuracy30: 0.2953 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.1791 - accuracy30: 0.4292 - val_loss: 3.2887 - val_accuracy30: 0.3813 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.1304 - accuracy30: 0.4519 - val_loss: 3.2468 - val_accuracy30: 0.4127 - 29s/epoch - 41ms/step
Epoch 4/50
722/722 - 29s - loss: 3.1114 - accuracy30: 0.4592 - val_loss: 3.2007 - val_accuracy30: 0.4270 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.0968 - accuracy30: 0.4644 - val_loss: 3.1968 - val_accuracy30: 0.4312 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.0856 - accuracy30: 0.4688 - val_loss: 3.2044 - val_accuracy30: 0.4297 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 28s - loss: 3.0771 - accuracy30: 0.4704 - val_loss: 3.1905 - val_accuracy30: 0.4338 - 28s/epoch - 39ms/step
Epoch 8/50
722/722 - 29s - loss: 3.0673 - accuracy30: 0.4745 - val_loss: 3.2107 - val_accuracy30: 0.4254 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 29s - loss: 3.0597 - accuracy30: 0.4767 - val_loss: 3.2112 - val_accuracy30: 0.4296 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 29s - loss: 3.0549 - accuracy30: 0.4774 - val_loss: 3.2559 - val_accuracy30: 0.4168 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 29s - loss: 3.0464 - accuracy30: 0.4809 - val_loss: 3.2897 - val_accuracy30: 0.4100 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 3.0390 - accuracy30: 0.4829 - val_loss: 3.3149 - val_accuracy30: 0.4068 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 29s - loss: 3.0332 - accuracy30: 0.4857 - val_loss: 3.3076 - val_accuracy30: 0.4109 - 29s/epoch - 40ms/step
Epoch 14/50
722/722 - 29s - loss: 3.0279 - accuracy30: 0.4875 - val_loss: 3.3141 - val_accuracy30: 0.4096 - 29s/epoch - 40ms/step
Epoch 15/50
722/722 - 29s - loss: 3.0204 - accuracy30: 0.4895 - val_loss: 3.3366 - val_accuracy30: 0.4090 - 29s/epoch - 39ms/step
Epoch 16/50
722/722 - 28s - loss: 3.0160 - accuracy30: 0.4902 - val_loss: 3.3253 - val_accuracy30: 0.4153 - 28s/epoch - 39ms/step
Epoch 17/50
722/722 - 29s - loss: 3.0097 - accuracy30: 0.4934 - val_loss: 3.3439 - val_accuracy30: 0.4136 - 29s/epoch - 40ms/step
testing model: results/PCAR/W1/deepLOB_L2/h30
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0892838
{'0': {'precision': 0.45299942037299296, 'recall': 0.30792008026092926, 'f1-score': 0.36662910534740994, 'support': 246197}, '1': {'precision': 0.3510274146529746, 'recall': 0.38630672926447573, 'f1-score': 0.36782306517447094, 'support': 178920}, '2': {'precision': 0.4354832855431745, 'recall': 0.5449245442721774, 'f1-score': 0.48409554411138994, 'support': 242195}, 'accuracy': 0.41495582276356485, 'macro avg': {'precision': 0.41317004018971404, 'recall': 0.4130504512658608, 'f1-score': 0.4061825715444236, 'support': 667312}, 'weighted avg': {'precision': 0.419301312833291, 'recall': 0.41495582276356485, 'f1-score': 0.4095826374713638, 'support': 667312}}
[[ 75809  69869 100519]
 [ 39238  69118  70564]
 [ 52302  57915 131978]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0694928
{'0': {'precision': 0.4405176313253486, 'recall': 0.36190460802688557, 'f1-score': 0.3973602746165923, 'support': 61892}, '1': {'precision': 0.4239923707598776, 'recall': 0.5286705202312139, 'f1-score': 0.4705804526310373, 'support': 60550}, '2': {'precision': 0.4334179037953852, 'recall': 0.4062309200167101, 'f1-score': 0.41938426832100323, 'support': 62238}, 'accuracy': 0.43151938488195796, 'macro avg': {'precision': 0.43264263529353714, 'recall': 0.4322686827582698, 'f1-score': 0.42910833185621094, 'support': 184680}, 'weighted avg': {'precision': 0.432706945981786, 'recall': 0.43151938488195796, 'f1-score': 0.4287887514356835, 'support': 184680}}
[[22399 23363 16130]
 [11618 32011 16921]
 [16830 20125 25283]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0649099
{'0': {'precision': 0.4750233042715359, 'recall': 0.4096562160117274, 'f1-score': 0.43992484257566516, 'support': 21147}, '1': {'precision': 0.3721775848923817, 'recall': 0.3951432129514321, 'f1-score': 0.38331672253933735, 'support': 16060}, '2': {'precision': 0.44539877300613495, 'recall': 0.4862925218889048, 'f1-score': 0.46494819423160494, 'support': 20901}, 'accuracy': 0.4332105734150203, 'macro avg': {'precision': 0.4308665540566842, 'recall': 0.4303639836173548, 'f1-score': 0.42939658644886913, 'support': 58108}, 'weighted avg': {'precision': 0.43594289225929383, 'recall': 0.4332105734150203, 'f1-score': 0.43328008910243215, 'support': 58108}}
[[ 8663  5824  6660]
 [ 3718  6346  5996]
 [ 5856  4881 10164]]
training model: results/PCAR/W1/deepLOB_L2/h50
Epoch 1/50
722/722 - 31s - loss: 3.3031 - accuracy50: 0.3698 - val_loss: 3.5059 - val_accuracy50: 0.3122 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2317 - accuracy50: 0.4021 - val_loss: 3.3887 - val_accuracy50: 0.3279 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.1997 - accuracy50: 0.4177 - val_loss: 3.3677 - val_accuracy50: 0.3406 - 29s/epoch - 39ms/step
Epoch 4/50
722/722 - 29s - loss: 3.1817 - accuracy50: 0.4273 - val_loss: 3.3414 - val_accuracy50: 0.3481 - 29s/epoch - 39ms/step
Epoch 5/50
722/722 - 28s - loss: 3.1706 - accuracy50: 0.4334 - val_loss: 3.3004 - val_accuracy50: 0.3702 - 28s/epoch - 39ms/step
Epoch 6/50
722/722 - 28s - loss: 3.1610 - accuracy50: 0.4377 - val_loss: 3.3222 - val_accuracy50: 0.3598 - 28s/epoch - 39ms/step
Epoch 7/50
722/722 - 29s - loss: 3.1544 - accuracy50: 0.4403 - val_loss: 3.3063 - val_accuracy50: 0.3656 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 29s - loss: 3.1468 - accuracy50: 0.4443 - val_loss: 3.3224 - val_accuracy50: 0.3694 - 29s/epoch - 39ms/step
Epoch 9/50
722/722 - 28s - loss: 3.1417 - accuracy50: 0.4459 - val_loss: 3.3185 - val_accuracy50: 0.3700 - 28s/epoch - 39ms/step
Epoch 10/50
722/722 - 28s - loss: 3.1354 - accuracy50: 0.4479 - val_loss: 3.3259 - val_accuracy50: 0.3662 - 28s/epoch - 39ms/step
Epoch 11/50
722/722 - 29s - loss: 3.1297 - accuracy50: 0.4512 - val_loss: 3.3338 - val_accuracy50: 0.3697 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 3.1237 - accuracy50: 0.4526 - val_loss: 3.3338 - val_accuracy50: 0.3681 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 29s - loss: 3.1187 - accuracy50: 0.4549 - val_loss: 3.3421 - val_accuracy50: 0.3713 - 29s/epoch - 40ms/step
Epoch 14/50
722/722 - 29s - loss: 3.1138 - accuracy50: 0.4568 - val_loss: 3.3330 - val_accuracy50: 0.3791 - 29s/epoch - 39ms/step
Epoch 15/50
722/722 - 28s - loss: 3.1070 - accuracy50: 0.4586 - val_loss: 3.3503 - val_accuracy50: 0.3748 - 28s/epoch - 39ms/step
testing model: results/PCAR/W1/deepLOB_L2/h50
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114561
{'0': {'precision': 0.4304274431783927, 'recall': 0.12221404361669348, 'f1-score': 0.1903739750683288, 'support': 233672}, '1': {'precision': 0.33725788189419764, 'recall': 0.5476188135359931, 'f1-score': 0.41743389128080605, 'support': 203428}, '2': {'precision': 0.39519305375946795, 'recall': 0.4646108804058868, 'f1-score': 0.42709968015141897, 'support': 230212}, 'accuracy': 0.3700188217805165, 'macro avg': {'precision': 0.38762612627735277, 'recall': 0.37814791251952445, 'f1-score': 0.34496918216685124, 'support': 667312}, 'weighted avg': {'precision': 0.3898696879307263, 'recall': 0.3700188217805165, 'f1-score': 0.34125908226535234, 'support': 667312}}
[[ 28558 116980  88134]
 [ 16470 111401  75557]
 [ 21320 101933 106959]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.114425
{'0': {'precision': 0.4095090324725701, 'recall': 0.11975174604203465, 'f1-score': 0.1853128878969871, 'support': 61711}, '1': {'precision': 0.3503101066060432, 'recall': 0.5238896865871169, 'f1-score': 0.4198670678879667, 'support': 60591}, '2': {'precision': 0.38143909497500655, 'recall': 0.46485940555965244, 'f1-score': 0.41903784736773647, 'support': 62378}, 'accuracy': 0.3689083820662768, 'macro avg': {'precision': 0.38041941135120666, 'recall': 0.369500279396268, 'f1-score': 0.3414059343842301, 'support': 184680}, 'weighted avg': {'precision': 0.3806056932999377, 'recall': 0.3689083820662768, 'f1-score': 0.3412104828812835, 'support': 184680}}
[[ 7390 31396 22925]
 [ 4750 31743 24098]
 [ 5906 27475 28997]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017975
{'0': {'precision': 0.4318331503841932, 'recall': 0.19300397389981847, 'f1-score': 0.266775166988777, 'support': 20383}, '1': {'precision': 0.32376761214452127, 'recall': 0.5004286939125464, 'f1-score': 0.39316507993533323, 'support': 17495}, '2': {'precision': 0.39814182265336795, 'recall': 0.4321304992585269, 'f1-score': 0.41444046744257707, 'support': 20230}, 'accuracy': 0.3688132443037103, 'macro avg': {'precision': 0.3845808617273608, 'recall': 0.37518772235696396, 'f1-score': 0.35812690478889575, 'support': 58108}, 'weighted avg': {'precision': 0.3875676077481077, 'recall': 0.3688132443037103, 'f1-score': 0.3562372127515012, 'support': 58108}}
[[3934 9601 6848]
 [2373 8755 6367]
 [2803 8685 8742]]
training model: results/PCAR/W1/deepLOB_L2/h100
Epoch 1/50
722/722 - 31s - loss: 3.3186 - accuracy100: 0.3577 - val_loss: 3.3498 - val_accuracy100: 0.3308 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2787 - accuracy100: 0.3730 - val_loss: 3.3127 - val_accuracy100: 0.3459 - 29s/epoch - 39ms/step
Epoch 3/50
722/722 - 29s - loss: 3.2583 - accuracy100: 0.3872 - val_loss: 3.2875 - val_accuracy100: 0.3650 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 29s - loss: 3.2428 - accuracy100: 0.3942 - val_loss: 3.2826 - val_accuracy100: 0.3730 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.2301 - accuracy100: 0.4012 - val_loss: 3.2930 - val_accuracy100: 0.3680 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.2236 - accuracy100: 0.4053 - val_loss: 3.2983 - val_accuracy100: 0.3654 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 28s - loss: 3.2183 - accuracy100: 0.4075 - val_loss: 3.2974 - val_accuracy100: 0.3710 - 28s/epoch - 39ms/step
Epoch 8/50
722/722 - 29s - loss: 3.2133 - accuracy100: 0.4125 - val_loss: 3.3048 - val_accuracy100: 0.3634 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 28s - loss: 3.2058 - accuracy100: 0.4163 - val_loss: 3.3014 - val_accuracy100: 0.3763 - 28s/epoch - 39ms/step
Epoch 10/50
722/722 - 29s - loss: 3.2011 - accuracy100: 0.4190 - val_loss: 3.3036 - val_accuracy100: 0.3719 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 28s - loss: 3.1947 - accuracy100: 0.4209 - val_loss: 3.3123 - val_accuracy100: 0.3726 - 28s/epoch - 39ms/step
Epoch 12/50
722/722 - 29s - loss: 3.1902 - accuracy100: 0.4237 - val_loss: 3.3246 - val_accuracy100: 0.3691 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 28s - loss: 3.1829 - accuracy100: 0.4276 - val_loss: 3.3321 - val_accuracy100: 0.3673 - 28s/epoch - 39ms/step
Epoch 14/50
722/722 - 28s - loss: 3.1774 - accuracy100: 0.4305 - val_loss: 3.3369 - val_accuracy100: 0.3695 - 28s/epoch - 39ms/step
testing model: results/PCAR/W1/deepLOB_L2/h100
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0986747
{'0': {'precision': 0.3690109504011243, 'recall': 0.2738730594718634, 'f1-score': 0.3144024626928968, 'support': 230092}, '1': {'precision': 0.35272932280957753, 'recall': 0.2544679385039404, 'f1-score': 0.29564791985746014, 'support': 208989}, '2': {'precision': 0.36634545307312333, 'recall': 0.5550166278901639, 'f1-score': 0.44136354688041707, 'support': 228231}, 'accuracy': 0.3639511952430048, 'macro avg': {'precision': 0.3626952420946084, 'recall': 0.36111920862198926, 'f1-score': 0.35047130981025804, 'support': 667312}, 'weighted avg': {'precision': 0.3630002235006688, 'recall': 0.3639511952430048, 'f1-score': 0.35195155824725044, 'support': 667312}}
[[ 63016  51788 115288]
 [ 51996  53181 103812]
 [ 55758  45801 126672]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.099048
{'0': {'precision': 0.3766664759398066, 'recall': 0.21375111616202613, 'f1-score': 0.2727319806523113, 'support': 61595}, '1': {'precision': 0.3476657870724309, 'recall': 0.46291887631963485, 'f1-score': 0.3970986937079681, 'support': 60907}, '2': {'precision': 0.35884770064696625, 'recall': 0.39607256585930717, 'f1-score': 0.3765423604421816, 'support': 62178}, 'accuracy': 0.35730994152046786, 'macro avg': {'precision': 0.3610599878864013, 'recall': 0.35758085278032276, 'f1-score': 0.3487910116008203, 'support': 184680}, 'weighted avg': {'precision': 0.36110290236928744, 'recall': 0.35730994152046786, 'f1-score': 0.34869865374444603, 'support': 184680}}
[[13166 27166 21263]
 [ 9974 28195 22738]
 [11814 25737 24627]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945035
{'0': {'precision': 0.3882613957240823, 'recall': 0.2878863409770688, 'f1-score': 0.33062346138432475, 'support': 20060}, '1': {'precision': 0.3511041421664707, 'recall': 0.29496679290850214, 'f1-score': 0.3205965697240865, 'support': 18219}, '2': {'precision': 0.3735677456316242, 'recall': 0.5261485702758586, 'f1-score': 0.4369202420587558, 'support': 19829}, 'accuracy': 0.3714118537894954, 'macro avg': {'precision': 0.37097776117405906, 'recall': 0.3696672347204765, 'f1-score': 0.36271342438905574, 'support': 58108}, 'weighted avg': {'precision': 0.3715971087025108, 'recall': 0.3714118537894954, 'f1-score': 0.3637527882383795, 'support': 58108}}
[[ 5775  5317  8968]
 [ 4318  5374  8527]
 [ 4781  4615 10433]]
training model: results/PCAR/W1/deepLOB_L2/h200
Epoch 1/50
722/722 - 31s - loss: 3.3289 - accuracy200: 0.3551 - val_loss: 3.3112 - val_accuracy200: 0.3390 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2952 - accuracy200: 0.3601 - val_loss: 3.3089 - val_accuracy200: 0.3338 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.2736 - accuracy200: 0.3788 - val_loss: 3.3250 - val_accuracy200: 0.3453 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 29s - loss: 3.2578 - accuracy200: 0.3916 - val_loss: 3.3351 - val_accuracy200: 0.3406 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.2492 - accuracy200: 0.3980 - val_loss: 3.3647 - val_accuracy200: 0.3413 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.2413 - accuracy200: 0.4021 - val_loss: 3.3237 - val_accuracy200: 0.3604 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 29s - loss: 3.2325 - accuracy200: 0.4068 - val_loss: 3.3049 - val_accuracy200: 0.3659 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 28s - loss: 3.2255 - accuracy200: 0.4103 - val_loss: 3.3320 - val_accuracy200: 0.3591 - 28s/epoch - 39ms/step
Epoch 9/50
722/722 - 28s - loss: 3.2213 - accuracy200: 0.4134 - val_loss: 3.3514 - val_accuracy200: 0.3511 - 28s/epoch - 39ms/step
Epoch 10/50
722/722 - 29s - loss: 3.2131 - accuracy200: 0.4168 - val_loss: 3.3527 - val_accuracy200: 0.3577 - 29s/epoch - 39ms/step
Epoch 11/50
722/722 - 28s - loss: 3.2054 - accuracy200: 0.4200 - val_loss: 3.3850 - val_accuracy200: 0.3467 - 28s/epoch - 39ms/step
Epoch 12/50
722/722 - 28s - loss: 3.1999 - accuracy200: 0.4231 - val_loss: 3.4183 - val_accuracy200: 0.3574 - 28s/epoch - 39ms/step
Epoch 13/50
722/722 - 28s - loss: 3.1933 - accuracy200: 0.4269 - val_loss: 3.4130 - val_accuracy200: 0.3527 - 28s/epoch - 39ms/step
Epoch 14/50
722/722 - 29s - loss: 3.1844 - accuracy200: 0.4313 - val_loss: 3.4449 - val_accuracy200: 0.3496 - 29s/epoch - 40ms/step
Epoch 15/50
722/722 - 28s - loss: 3.1812 - accuracy200: 0.4312 - val_loss: 3.4410 - val_accuracy200: 0.3480 - 28s/epoch - 39ms/step
Epoch 16/50
722/722 - 29s - loss: 3.1688 - accuracy200: 0.4375 - val_loss: 3.3842 - val_accuracy200: 0.3603 - 29s/epoch - 40ms/step
Epoch 17/50
722/722 - 29s - loss: 3.1623 - accuracy200: 0.4390 - val_loss: 3.4637 - val_accuracy200: 0.3514 - 29s/epoch - 40ms/step
testing model: results/PCAR/W1/deepLOB_L2/h200
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1216363
{'0': {'precision': 0.35132317085257797, 'recall': 0.38455463074666507, 'f1-score': 0.367188552083916, 'support': 230438}, '1': {'precision': 0.33816458590253434, 'recall': 0.11699032151365965, 'f1-score': 0.17383964441405245, 'support': 208607}, '2': {'precision': 0.3468918777048071, 'recall': 0.5211090521187907, 'f1-score': 0.4165168293430209, 'support': 228267}, 'accuracy': 0.34762300093509485, 'macro avg': {'precision': 0.3454598781533065, 'recall': 0.3408846681263718, 'f1-score': 0.31918167528032976, 'support': 667312}, 'weighted avg': {'precision': 0.3456938836171679, 'recall': 0.34762300093509485, 'f1-score': 0.3236198500117472, 'support': 667312}}
[[ 88616  23733 118089]
 [ 78335  24405 105867]
 [ 85284  24031 118952]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1144003
{'0': {'precision': 0.3359481582537517, 'recall': 0.43170897993636775, 'f1-score': 0.3778557626733348, 'support': 61604}, '1': {'precision': 0.35022329511164757, 'recall': 0.2377308404476707, 'f1-score': 0.2832155546011791, 'support': 61027}, '2': {'precision': 0.34663213243669155, 'recall': 0.35803961385356736, 'f1-score': 0.35224353892500393, 'support': 62049}, 'accuracy': 0.3428579163959281, 'macro avg': {'precision': 0.34426786193403025, 'recall': 0.3424931447458686, 'f1-score': 0.3377716187331726, 'support': 184680}, 'weighted avg': {'precision': 0.34425495211937895, 'recall': 0.3428579163959281, 'f1-score': 0.3379769406602331, 'support': 184680}}
[[26595 13451 21558]
 [26202 14508 20317]
 [26367 13466 22216]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1024834
{'0': {'precision': 0.37115171091147675, 'recall': 0.5382025761124122, 'f1-score': 0.4393332935061832, 'support': 20496}, '1': {'precision': 0.3416149068322981, 'recall': 0.1663080769901727, 'f1-score': 0.22370839688685518, 'support': 17197}, '2': {'precision': 0.3668748438670997, 'recall': 0.359686505020818, 'f1-score': 0.3632451150136038, 'support': 20415}, 'accuracy': 0.36542300543814965, 'macro avg': {'precision': 0.3598804872036248, 'recall': 0.3547323860411343, 'f1-score': 0.34209560180221404, 'support': 58108}, 'weighted avg': {'precision': 0.360907740021744, 'recall': 0.36542300543814965, 'f1-score': 0.34878738741599613, 'support': 58108}}
[[11031  2679  6786]
 [ 8451  2860  5886]
 [10239  2833  7343]]
training model: results/PCAR/W1/deepLOB_L2/h300
Epoch 1/50
722/722 - 31s - loss: 3.3004 - accuracy300: 0.3787 - val_loss: 3.3076 - val_accuracy300: 0.3703 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2657 - accuracy300: 0.3884 - val_loss: 3.2684 - val_accuracy300: 0.3816 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.2619 - accuracy300: 0.3910 - val_loss: 3.2739 - val_accuracy300: 0.3860 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 28s - loss: 3.2476 - accuracy300: 0.4015 - val_loss: 3.3034 - val_accuracy300: 0.3709 - 28s/epoch - 39ms/step
Epoch 5/50
722/722 - 29s - loss: 3.2260 - accuracy300: 0.4172 - val_loss: 3.3680 - val_accuracy300: 0.3725 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 28s - loss: 3.2174 - accuracy300: 0.4200 - val_loss: 3.3365 - val_accuracy300: 0.3711 - 28s/epoch - 39ms/step
Epoch 7/50
722/722 - 29s - loss: 3.2064 - accuracy300: 0.4240 - val_loss: 3.3751 - val_accuracy300: 0.3718 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 29s - loss: 3.1971 - accuracy300: 0.4289 - val_loss: 3.3644 - val_accuracy300: 0.3740 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 29s - loss: 3.1868 - accuracy300: 0.4347 - val_loss: 3.3796 - val_accuracy300: 0.3732 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 29s - loss: 3.1797 - accuracy300: 0.4366 - val_loss: 3.4097 - val_accuracy300: 0.3750 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 29s - loss: 3.1699 - accuracy300: 0.4410 - val_loss: 3.4002 - val_accuracy300: 0.3747 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 3.1649 - accuracy300: 0.4426 - val_loss: 3.4140 - val_accuracy300: 0.3735 - 29s/epoch - 40ms/step
testing model: results/PCAR/W1/deepLOB_L2/h300
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988349
{'0': {'precision': 0.33721242899008497, 'recall': 0.42667769193002403, 'f1-score': 0.37670606531290457, 'support': 232194}, '1': {'precision': 0.4456961991362893, 'recall': 0.08098057850232716, 'f1-score': 0.13705839169203105, 'support': 205185}, '2': {'precision': 0.3681335022633047, 'recall': 0.538326382033027, 'f1-score': 0.4372526127450028, 'support': 229933}, 'accuracy': 0.3588531301699954, 'macro avg': {'precision': 0.38368071012989297, 'recall': 0.34866155082179273, 'f1-score': 0.3170056899166461, 'support': 667312}, 'weighted avg': {'precision': 0.3812233526935103, 'recall': 0.3588531301699954, 'f1-score': 0.32388151154915645, 'support': 667312}}
[[ 99072  11585 121537]
 [ 97651  16616  90918]
 [ 97074   9080 123779]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1091341
{'0': {'precision': 0.33782696177062377, 'recall': 0.5169586284010436, 'f1-score': 0.40862308584018087, 'support': 61709}, '1': {'precision': 0.4410519741863854, 'recall': 0.10412161719415504, 'f1-score': 0.16847127426943212, 'support': 61044}, '2': {'precision': 0.34492807130895714, 'recall': 0.42241671645647294, 'f1-score': 0.37975988269965016, 'support': 61927}, 'accuracy': 0.3487979207277453, 'macro avg': {'precision': 0.3746023357553221, 'recall': 0.3478323206838905, 'f1-score': 0.31895141426975443, 'support': 184680}, 'weighted avg': {'precision': 0.3743280342651447, 'recall': 0.3487979207277453, 'f1-score': 0.31956504616935333, 'support': 184680}}
[[31901  4226 25582]
 [30590  6356 24098]
 [31939  3829 26159]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.089891
{'0': {'precision': 0.37096824263496103, 'recall': 0.5799281762593419, 'f1-score': 0.4524886877828054, 'support': 20606}, '1': {'precision': 0.4289313769082555, 'recall': 0.1731897067624177, 'f1-score': 0.24674937118983672, 'support': 16710}, '2': {'precision': 0.38787340714434926, 'recall': 0.35720469411312045, 'f1-score': 0.37190786179268903, 'support': 20792}, 'accuracy': 0.3832690851517863, 'macro avg': {'precision': 0.39592434222918865, 'recall': 0.3701075257116267, 'f1-score': 0.35704864025511035, 'support': 58108}, 'weighted avg': {'precision': 0.39368553034381265, 'recall': 0.3832690851517863, 'f1-score': 0.3644915012636513, 'support': 58108}}
[[11950  1880  6776]
 [ 8871  2894  4945]
 [11392  1973  7427]]
training model: results/PCAR/W1/deepLOB_L2/h500
Epoch 1/50
722/722 - 31s - loss: 3.3049 - accuracy500: 0.3756 - val_loss: 3.3797 - val_accuracy500: 0.3486 - 31s/epoch - 43ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2915 - accuracy500: 0.3742 - val_loss: 3.3238 - val_accuracy500: 0.3533 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.2690 - accuracy500: 0.3868 - val_loss: 3.3477 - val_accuracy500: 0.3563 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 29s - loss: 3.2492 - accuracy500: 0.4035 - val_loss: 3.3565 - val_accuracy500: 0.3603 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.2285 - accuracy500: 0.4171 - val_loss: 3.3892 - val_accuracy500: 0.3613 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.2111 - accuracy500: 0.4248 - val_loss: 3.3845 - val_accuracy500: 0.3572 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 29s - loss: 3.1932 - accuracy500: 0.4324 - val_loss: 3.3861 - val_accuracy500: 0.3589 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 29s - loss: 3.1885 - accuracy500: 0.4348 - val_loss: 3.3958 - val_accuracy500: 0.3622 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 29s - loss: 3.1752 - accuracy500: 0.4409 - val_loss: 3.4167 - val_accuracy500: 0.3613 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 28s - loss: 3.1634 - accuracy500: 0.4467 - val_loss: 3.4045 - val_accuracy500: 0.3626 - 28s/epoch - 39ms/step
Epoch 11/50
722/722 - 29s - loss: 3.1516 - accuracy500: 0.4507 - val_loss: 3.4205 - val_accuracy500: 0.3625 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 3.1413 - accuracy500: 0.4552 - val_loss: 3.4076 - val_accuracy500: 0.3589 - 29s/epoch - 39ms/step
testing model: results/PCAR/W1/deepLOB_L2/h500
Evaluating performance on  test set...
2607/2607 - 34s - 34s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1202856
{'0': {'precision': 0.34176337935207085, 'recall': 0.2708288838812879, 'f1-score': 0.3021892378884299, 'support': 229429}, '1': {'precision': 0.3292581480976408, 'recall': 0.23066708065633285, 'f1-score': 0.27128270670355753, 'support': 209345}, '2': {'precision': 0.3478228790999935, 'recall': 0.5156997960951789, 'f1-score': 0.4154429130388805, 'support': 228538}, 'accuracy': 0.3420918550842784, 'macro avg': {'precision': 0.33961480218323503, 'recall': 0.3390652535442665, 'f1-score': 0.3296382858769559, 'support': 667312}, 'weighted avg': {'precision': 0.33991554552985886, 'recall': 0.3420918550842784, 'f1-score': 0.3312800389539533, 'support': 667312}}
[[ 62136  50533 116760]
 [ 56831  48289 104225]
 [ 62843  47838 117857]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1155568
{'0': {'precision': 0.339622363397845, 'recall': 0.36893934541728046, 'f1-score': 0.3536743543497448, 'support': 62452}, '1': {'precision': 0.34301021109025137, 'recall': 0.24766501909311822, 'f1-score': 0.28764243407474255, 'support': 60493}, '2': {'precision': 0.33656829645019753, 'recall': 0.39884992305823275, 'f1-score': 0.36507183418091244, 'support': 61735}, 'accuracy': 0.33921377517868745, 'macro avg': {'precision': 0.33973362364609794, 'recall': 0.3384847625228771, 'f1-score': 0.33546287420179993, 'support': 184680}, 'weighted avg': {'precision': 0.33971115616069814, 'recall': 0.33921377517868745, 'f1-score': 0.33585517774254, 'support': 184680}}
[[23041 14487 24924]
 [21899 14982 23612]
 [22903 14209 24623]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1076725
{'0': {'precision': 0.35470404710638487, 'recall': 0.4089366229292264, 'f1-score': 0.37989457831325296, 'support': 19739}, '1': {'precision': 0.33848326272946255, 'recall': 0.22342233675091835, 'f1-score': 0.26917233634982496, 'support': 18239}, '2': {'precision': 0.36865133836650654, 'recall': 0.4269249875807253, 'f1-score': 0.3956539754154966, 'support': 20130}, 'accuracy': 0.35693880360707647, 'macro avg': {'precision': 0.3539462160674513, 'recall': 0.35309464908695665, 'f1-score': 0.34824029669285816, 'support': 58108}, 'weighted avg': {'precision': 0.3544443253265191, 'recall': 0.35693880360707647, 'f1-score': 0.35060039666007614, 'support': 58108}}
[[8072 3921 7746]
 [7192 4075 6972]
 [7493 4043 8594]]
training model: results/PCAR/W1/deepLOB_L2/h1000
Epoch 1/50
722/722 - 32s - loss: 3.3137 - accuracy1000: 0.3752 - val_loss: 3.4220 - val_accuracy1000: 0.3509 - 32s/epoch - 44ms/step
Epoch 2/50
722/722 - 29s - loss: 3.2680 - accuracy1000: 0.3882 - val_loss: 3.4482 - val_accuracy1000: 0.3553 - 29s/epoch - 40ms/step
Epoch 3/50
722/722 - 29s - loss: 3.2113 - accuracy1000: 0.4208 - val_loss: 3.5037 - val_accuracy1000: 0.3592 - 29s/epoch - 40ms/step
Epoch 4/50
722/722 - 29s - loss: 3.1858 - accuracy1000: 0.4316 - val_loss: 3.4510 - val_accuracy1000: 0.3617 - 29s/epoch - 40ms/step
Epoch 5/50
722/722 - 29s - loss: 3.1653 - accuracy1000: 0.4400 - val_loss: 3.4114 - val_accuracy1000: 0.3621 - 29s/epoch - 40ms/step
Epoch 6/50
722/722 - 29s - loss: 3.1518 - accuracy1000: 0.4439 - val_loss: 3.4527 - val_accuracy1000: 0.3605 - 29s/epoch - 40ms/step
Epoch 7/50
722/722 - 29s - loss: 3.1326 - accuracy1000: 0.4505 - val_loss: 3.4952 - val_accuracy1000: 0.3623 - 29s/epoch - 40ms/step
Epoch 8/50
722/722 - 29s - loss: 3.1258 - accuracy1000: 0.4548 - val_loss: 3.5516 - val_accuracy1000: 0.3586 - 29s/epoch - 40ms/step
Epoch 9/50
722/722 - 29s - loss: 3.1094 - accuracy1000: 0.4605 - val_loss: 3.5439 - val_accuracy1000: 0.3632 - 29s/epoch - 40ms/step
Epoch 10/50
722/722 - 29s - loss: 3.0992 - accuracy1000: 0.4627 - val_loss: 3.5798 - val_accuracy1000: 0.3609 - 29s/epoch - 40ms/step
Epoch 11/50
722/722 - 29s - loss: 3.0849 - accuracy1000: 0.4677 - val_loss: 3.5916 - val_accuracy1000: 0.3640 - 29s/epoch - 40ms/step
Epoch 12/50
722/722 - 29s - loss: 3.0751 - accuracy1000: 0.4707 - val_loss: 3.5696 - val_accuracy1000: 0.3612 - 29s/epoch - 40ms/step
Epoch 13/50
722/722 - 29s - loss: 3.0628 - accuracy1000: 0.4768 - val_loss: 3.5980 - val_accuracy1000: 0.3635 - 29s/epoch - 40ms/step
Epoch 14/50
722/722 - 29s - loss: 3.0523 - accuracy1000: 0.4786 - val_loss: 3.6263 - val_accuracy1000: 0.3607 - 29s/epoch - 40ms/step
Epoch 15/50
722/722 - 29s - loss: 3.0376 - accuracy1000: 0.4844 - val_loss: 3.6809 - val_accuracy1000: 0.3575 - 29s/epoch - 40ms/step
testing model: results/PCAR/W1/deepLOB_L2/h1000
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1501753
{'0': {'precision': 0.34169410775590275, 'recall': 0.2901101329073048, 'f1-score': 0.3137963205522389, 'support': 235352}, '1': {'precision': 0.2929567670332505, 'recall': 0.2617134268537074, 'f1-score': 0.2764551629607873, 'support': 199600}, '2': {'precision': 0.36813785328708715, 'recall': 0.4581554484420726, 'f1-score': 0.4082433269355769, 'support': 232360}, 'accuracy': 0.34013025391421103, 'macro avg': {'precision': 0.3342629093587468, 'recall': 0.33665966940102826, 'f1-score': 0.3328316034828677, 'support': 667312}, 'weighted avg': {'precision': 0.33632404922763504, 'recall': 0.34013025391421103, 'f1-score': 0.33551391494283683, 'support': 667312}}
[[ 68278  68920  98154]
 [ 62796  52238  84566]
 [ 68748  57155 106457]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1391405
{'0': {'precision': 0.3400930454491232, 'recall': 0.27185607806366513, 'f1-score': 0.30217009212071966, 'support': 62923}, '1': {'precision': 0.32927913510437784, 'recall': 0.4628420035325091, 'f1-score': 0.3848002715226742, 'support': 60014}, '2': {'precision': 0.3312143928035982, 'recall': 0.26835430737087607, 'f1-score': 0.2964891561090831, 'support': 61743}, 'accuracy': 0.3327485380116959, 'macro avg': {'precision': 0.3335288577856998, 'recall': 0.33435079632235015, 'f1-score': 0.32781983991749236, 'support': 184680}, 'weighted avg': {'precision': 0.33361058570403873, 'recall': 0.3327485380116959, 'f1-score': 0.32712249386678005, 'support': 184680}}
[[17106 28311 17506]
 [16287 27777 15950]
 [16905 28269 16569]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1386476
{'0': {'precision': 0.3713196254464717, 'recall': 0.3926402286530904, 'f1-score': 0.3816824191907916, 'support': 19593}, '1': {'precision': 0.33949449376606994, 'recall': 0.3737449262977996, 'f1-score': 0.35579734092584586, 'support': 18724}, '2': {'precision': 0.3822495082553496, 'recall': 0.3240361780607347, 'f1-score': 0.35074381973310004, 'support': 19791}, 'accuracy': 0.3631857919735665, 'macro avg': {'precision': 0.3643545424892971, 'recall': 0.3634737776705415, 'f1-score': 0.36274119328324583, 'support': 58108}, 'weighted avg': {'precision': 0.3647872984878198, 'recall': 0.3631857919735665, 'f1-score': 0.3628041575521185, 'support': 58108}}
[[7693 6683 5217]
 [6579 6998 5147]
 [6446 6932 6413]]
training model: results/PCAR/W1/deepOF_L2/h10
Epoch 1/50
722/722 - 18s - loss: 3.1530 - accuracy10: 0.4335 - val_loss: 3.1403 - val_accuracy10: 0.4619 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 2.9908 - accuracy10: 0.4999 - val_loss: 3.1113 - val_accuracy10: 0.4864 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 2.9122 - accuracy10: 0.5264 - val_loss: 3.0771 - val_accuracy10: 0.4965 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 2.8764 - accuracy10: 0.5344 - val_loss: 3.0540 - val_accuracy10: 0.4996 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 2.8532 - accuracy10: 0.5395 - val_loss: 3.0488 - val_accuracy10: 0.5028 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 2.8368 - accuracy10: 0.5435 - val_loss: 3.0327 - val_accuracy10: 0.5058 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 16s - loss: 2.8244 - accuracy10: 0.5471 - val_loss: 3.0357 - val_accuracy10: 0.5070 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 16s - loss: 2.8158 - accuracy10: 0.5488 - val_loss: 3.0314 - val_accuracy10: 0.5068 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 16s - loss: 2.8065 - accuracy10: 0.5510 - val_loss: 3.0298 - val_accuracy10: 0.5089 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 16s - loss: 2.7993 - accuracy10: 0.5518 - val_loss: 3.0289 - val_accuracy10: 0.5110 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 16s - loss: 2.7905 - accuracy10: 0.5545 - val_loss: 3.0294 - val_accuracy10: 0.5102 - 16s/epoch - 22ms/step
Epoch 12/50
722/722 - 16s - loss: 2.7845 - accuracy10: 0.5550 - val_loss: 3.0270 - val_accuracy10: 0.5123 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 16s - loss: 2.7781 - accuracy10: 0.5567 - val_loss: 3.0277 - val_accuracy10: 0.5117 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 16s - loss: 2.7716 - accuracy10: 0.5580 - val_loss: 3.0371 - val_accuracy10: 0.5104 - 16s/epoch - 22ms/step
Epoch 15/50
722/722 - 15s - loss: 2.7675 - accuracy10: 0.5589 - val_loss: 3.0302 - val_accuracy10: 0.5122 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 16s - loss: 2.7623 - accuracy10: 0.5598 - val_loss: 3.0335 - val_accuracy10: 0.5102 - 16s/epoch - 22ms/step
Epoch 17/50
722/722 - 16s - loss: 2.7548 - accuracy10: 0.5618 - val_loss: 3.0331 - val_accuracy10: 0.5114 - 16s/epoch - 22ms/step
Epoch 18/50
722/722 - 16s - loss: 2.7521 - accuracy10: 0.5623 - val_loss: 3.0347 - val_accuracy10: 0.5082 - 16s/epoch - 21ms/step
Epoch 19/50
722/722 - 16s - loss: 2.7424 - accuracy10: 0.5645 - val_loss: 3.0296 - val_accuracy10: 0.5100 - 16s/epoch - 21ms/step
Epoch 20/50
722/722 - 16s - loss: 2.7412 - accuracy10: 0.5650 - val_loss: 3.0296 - val_accuracy10: 0.5095 - 16s/epoch - 22ms/step
Epoch 21/50
722/722 - 16s - loss: 2.7333 - accuracy10: 0.5658 - val_loss: 3.0270 - val_accuracy10: 0.5097 - 16s/epoch - 22ms/step
Epoch 22/50
722/722 - 16s - loss: 2.7285 - accuracy10: 0.5681 - val_loss: 3.0300 - val_accuracy10: 0.5091 - 16s/epoch - 22ms/step
testing model: results/PCAR/W1/deepOF_L2/h10
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9968669
{'0': {'precision': 0.47001323044479815, 'recall': 0.6080638434670791, 'f1-score': 0.5301996643850405, 'support': 230188}, '1': {'precision': 0.5464950698832088, 'recall': 0.4229597317922501, 'f1-score': 0.47685649250302803, 'support': 215952}, '2': {'precision': 0.514446097058402, 'recall': 0.47073026265220397, 'f1-score': 0.4916182650989281, 'support': 221167}, 'accuracy': 0.5026442102360683, 'macro avg': {'precision': 0.5103181324621363, 'recall': 0.5005846126371778, 'f1-score': 0.4995581406623322, 'support': 667307}, 'weighted avg': {'precision': 0.5094905474828849, 'recall': 0.5026442102360683, 'f1-score': 0.500149781811988, 'support': 667307}}
[[139969  38634  51585]
 [ 77935  91339  46678]
 [ 79894  37163 104110]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9540779
{'0': {'precision': 0.4657393096342092, 'recall': 0.5621479259638599, 'f1-score': 0.5094223916466396, 'support': 54676}, '1': {'precision': 0.6345990279465371, 'recall': 0.5529279428306756, 'f1-score': 0.59095505816626, 'support': 75565}, '2': {'precision': 0.49925253098684835, 'recall': 0.48464308020132996, 'f1-score': 0.49183934080888864, 'support': 54438}, 'accuracy': 0.5355292155578057, 'macro avg': {'precision': 0.5331969561891982, 'recall': 0.5332396496652885, 'f1-score': 0.5307389302072628, 'support': 184679}, 'weighted avg': {'precision': 0.5447102665825684, 'recall': 0.5355292155578057, 'f1-score': 0.537600093627101, 'support': 184679}}
[[30736 12211 11729]
 [19050 41782 14733]
 [16208 11847 26383]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9939297
{'0': {'precision': 0.4723361549873462, 'recall': 0.5765338730293992, 'f1-score': 0.5192593658559985, 'support': 18776}, '1': {'precision': 0.5720422616974341, 'recall': 0.4792568454841691, 'f1-score': 0.5215550321539154, 'support': 20561}, '2': {'precision': 0.5002505149473918, 'recall': 0.4787426744805541, 'f1-score': 0.4892603381155909, 'support': 18770}, 'accuracy': 0.510523689056396, 'macro avg': {'precision': 0.5148763105440574, 'recall': 0.5115111309980408, 'f1-score': 0.510024912041835, 'support': 58107}, 'weighted avg': {'precision': 0.5166339125125354, 'recall': 0.510523689056396, 'f1-score': 0.5103812521014425, 'support': 58107}}
[[10825  3540  4411]
 [ 6141  9854  4566]
 [ 5952  3832  8986]]
training model: results/PCAR/W1/deepOF_L2/h20
Epoch 1/50
722/722 - 18s - loss: 3.1958 - accuracy20: 0.4193 - val_loss: 3.1706 - val_accuracy20: 0.4186 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 3.0598 - accuracy20: 0.4754 - val_loss: 3.2013 - val_accuracy20: 0.4253 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.0050 - accuracy20: 0.4947 - val_loss: 3.1527 - val_accuracy20: 0.4467 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 2.9720 - accuracy20: 0.5044 - val_loss: 3.1032 - val_accuracy20: 0.4639 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 2.9518 - accuracy20: 0.5108 - val_loss: 3.0872 - val_accuracy20: 0.4704 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 2.9380 - accuracy20: 0.5155 - val_loss: 3.0761 - val_accuracy20: 0.4771 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 16s - loss: 2.9270 - accuracy20: 0.5182 - val_loss: 3.0750 - val_accuracy20: 0.4751 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 16s - loss: 2.9201 - accuracy20: 0.5209 - val_loss: 3.0729 - val_accuracy20: 0.4768 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 16s - loss: 2.9127 - accuracy20: 0.5226 - val_loss: 3.0735 - val_accuracy20: 0.4779 - 16s/epoch - 21ms/step
Epoch 10/50
722/722 - 16s - loss: 2.9059 - accuracy20: 0.5241 - val_loss: 3.0730 - val_accuracy20: 0.4800 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 16s - loss: 2.9008 - accuracy20: 0.5262 - val_loss: 3.0757 - val_accuracy20: 0.4805 - 16s/epoch - 22ms/step
Epoch 12/50
722/722 - 16s - loss: 2.8940 - accuracy20: 0.5266 - val_loss: 3.0637 - val_accuracy20: 0.4838 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 16s - loss: 2.8885 - accuracy20: 0.5287 - val_loss: 3.0729 - val_accuracy20: 0.4818 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 15s - loss: 2.8818 - accuracy20: 0.5307 - val_loss: 3.0732 - val_accuracy20: 0.4844 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 16s - loss: 2.8773 - accuracy20: 0.5322 - val_loss: 3.0704 - val_accuracy20: 0.4830 - 16s/epoch - 22ms/step
Epoch 16/50
722/722 - 15s - loss: 2.8722 - accuracy20: 0.5340 - val_loss: 3.0706 - val_accuracy20: 0.4858 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 15s - loss: 2.8670 - accuracy20: 0.5365 - val_loss: 3.0668 - val_accuracy20: 0.4854 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 15s - loss: 2.8632 - accuracy20: 0.5360 - val_loss: 3.0705 - val_accuracy20: 0.4834 - 15s/epoch - 21ms/step
Epoch 19/50
722/722 - 15s - loss: 2.8560 - accuracy20: 0.5385 - val_loss: 3.0756 - val_accuracy20: 0.4829 - 15s/epoch - 21ms/step
Epoch 20/50
722/722 - 15s - loss: 2.8541 - accuracy20: 0.5386 - val_loss: 3.0747 - val_accuracy20: 0.4851 - 15s/epoch - 21ms/step
Epoch 21/50
722/722 - 16s - loss: 2.8475 - accuracy20: 0.5410 - val_loss: 3.0828 - val_accuracy20: 0.4846 - 16s/epoch - 22ms/step
Epoch 22/50
722/722 - 16s - loss: 2.8432 - accuracy20: 0.5413 - val_loss: 3.0835 - val_accuracy20: 0.4849 - 16s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h20
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0235436
{'0': {'precision': 0.4772886187607573, 'recall': 0.5592229644567683, 'f1-score': 0.5150174114915845, 'support': 253888}, '1': {'precision': 0.41871967565411966, 'recall': 0.45653775544712305, 'f1-score': 0.43681169469000986, 'support': 165592}, '2': {'precision': 0.5289745201730706, 'recall': 0.40402377464925127, 'f1-score': 0.4581322034984009, 'support': 247827}, 'accuracy': 0.4761032028736399, 'macro avg': {'precision': 0.47499427152931584, 'recall': 0.47326149818438085, 'f1-score': 0.46998710322666515, 'support': 667307}, 'weighted avg': {'precision': 0.4819500616384659, 'recall': 0.4761032028736399, 'f1-score': 0.47448444615788793, 'support': 667307}}
[[141980  54476  57432]
 [ 58266  75599  31727]
 [ 97226  50473 100128]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.99135137
{'0': {'precision': 0.4873112851844442, 'recall': 0.5099772913948881, 'f1-score': 0.49838671598331624, 'support': 62091}, '1': {'precision': 0.5141243717899155, 'recall': 0.6173140365710118, 'f1-score': 0.5610136422873242, 'support': 60321}, '2': {'precision': 0.5297850736165172, 'recall': 0.40220341432861706, 'f1-score': 0.45726179716813187, 'support': 62267}, 'accuracy': 0.5086988775117908, 'macro avg': {'precision': 0.5104069101969589, 'recall': 0.5098315807648389, 'f1-score': 0.5055540518129241, 'support': 184679}, 'weighted avg': {'precision': 0.5103897487965957, 'recall': 0.5086988775117908, 'f1-score': 0.5049764933901626, 'support': 184679}}
[[31665 17725 12701]
 [13557 37237  9527]
 [19757 17466 25044]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0233998
{'0': {'precision': 0.4951012989315955, 'recall': 0.5234100388995642, 'f1-score': 0.5088622590786895, 'support': 21337}, '1': {'precision': 0.4365222778666942, 'recall': 0.5422652642380708, 'f1-score': 0.4836818168816681, 'support': 15592}, '2': {'precision': 0.5263580742846549, 'recall': 0.40216262158844085, 'f1-score': 0.4559543885007629, 'support': 21178}, 'accuracy': 0.4842790025298157, 'macro avg': {'precision': 0.4859938836943149, 'recall': 0.48927930824202526, 'f1-score': 0.48283282148704015, 'support': 58107}, 'weighted avg': {'precision': 0.4907746582856002, 'recall': 0.4842790025298157, 'f1-score': 0.48282243017967064, 'support': 58107}}
[[11168  5350  4819]
 [ 4292  8455  2845]
 [ 7097  5564  8517]]
training model: results/PCAR/W1/deepOF_L2/h30
Epoch 1/50
722/722 - 18s - loss: 3.2470 - accuracy30: 0.3981 - val_loss: 3.2242 - val_accuracy30: 0.4001 - 18s/epoch - 24ms/step
Epoch 2/50
722/722 - 16s - loss: 3.1554 - accuracy30: 0.4410 - val_loss: 3.2583 - val_accuracy30: 0.3929 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.1100 - accuracy30: 0.4606 - val_loss: 3.2840 - val_accuracy30: 0.3958 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 15s - loss: 3.0866 - accuracy30: 0.4687 - val_loss: 3.2734 - val_accuracy30: 0.4052 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 16s - loss: 3.0684 - accuracy30: 0.4744 - val_loss: 3.2409 - val_accuracy30: 0.4154 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 3.0519 - accuracy30: 0.4815 - val_loss: 3.2123 - val_accuracy30: 0.4285 - 16s/epoch - 21ms/step
Epoch 7/50
722/722 - 16s - loss: 3.0395 - accuracy30: 0.4852 - val_loss: 3.1979 - val_accuracy30: 0.4333 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 15s - loss: 3.0316 - accuracy30: 0.4880 - val_loss: 3.1913 - val_accuracy30: 0.4364 - 15s/epoch - 21ms/step
Epoch 9/50
722/722 - 16s - loss: 3.0256 - accuracy30: 0.4894 - val_loss: 3.1799 - val_accuracy30: 0.4421 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 15s - loss: 3.0175 - accuracy30: 0.4927 - val_loss: 3.1861 - val_accuracy30: 0.4381 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 3.0119 - accuracy30: 0.4945 - val_loss: 3.1938 - val_accuracy30: 0.4386 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 16s - loss: 3.0043 - accuracy30: 0.4975 - val_loss: 3.1788 - val_accuracy30: 0.4428 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 16s - loss: 2.9997 - accuracy30: 0.4988 - val_loss: 3.1826 - val_accuracy30: 0.4430 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 15s - loss: 2.9934 - accuracy30: 0.5014 - val_loss: 3.1838 - val_accuracy30: 0.4429 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 2.9883 - accuracy30: 0.5018 - val_loss: 3.1796 - val_accuracy30: 0.4449 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 15s - loss: 2.9840 - accuracy30: 0.5040 - val_loss: 3.1703 - val_accuracy30: 0.4454 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 16s - loss: 2.9763 - accuracy30: 0.5066 - val_loss: 3.1811 - val_accuracy30: 0.4453 - 16s/epoch - 22ms/step
Epoch 18/50
722/722 - 15s - loss: 2.9716 - accuracy30: 0.5067 - val_loss: 3.1716 - val_accuracy30: 0.4471 - 15s/epoch - 21ms/step
Epoch 19/50
722/722 - 16s - loss: 2.9672 - accuracy30: 0.5096 - val_loss: 3.1790 - val_accuracy30: 0.4454 - 16s/epoch - 22ms/step
Epoch 20/50
722/722 - 16s - loss: 2.9631 - accuracy30: 0.5095 - val_loss: 3.1740 - val_accuracy30: 0.4474 - 16s/epoch - 21ms/step
Epoch 21/50
722/722 - 15s - loss: 2.9559 - accuracy30: 0.5127 - val_loss: 3.1819 - val_accuracy30: 0.4473 - 15s/epoch - 21ms/step
Epoch 22/50
722/722 - 15s - loss: 2.9515 - accuracy30: 0.5142 - val_loss: 3.1783 - val_accuracy30: 0.4479 - 15s/epoch - 21ms/step
Epoch 23/50
722/722 - 15s - loss: 2.9464 - accuracy30: 0.5144 - val_loss: 3.1803 - val_accuracy30: 0.4468 - 15s/epoch - 21ms/step
Epoch 24/50
722/722 - 15s - loss: 2.9425 - accuracy30: 0.5166 - val_loss: 3.1882 - val_accuracy30: 0.4453 - 15s/epoch - 21ms/step
Epoch 25/50
722/722 - 16s - loss: 2.9341 - accuracy30: 0.5195 - val_loss: 3.1885 - val_accuracy30: 0.4452 - 16s/epoch - 22ms/step
Epoch 26/50
722/722 - 15s - loss: 2.9287 - accuracy30: 0.5205 - val_loss: 3.1979 - val_accuracy30: 0.4429 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h30
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0624107
{'0': {'precision': 0.45149648077185767, 'recall': 0.5101647068380755, 'f1-score': 0.4790410026297673, 'support': 246195}, '1': {'precision': 0.37544756789700223, 'recall': 0.4407165213503242, 'f1-score': 0.4054722530749928, 'support': 178920}, '2': {'precision': 0.49057773162029517, 'recall': 0.3627741626478166, 'f1-score': 0.4171055973452903, 'support': 242192}, 'accuracy': 0.4380502527322507, 'macro avg': {'precision': 0.4391739267630517, 'recall': 0.4378851302787387, 'f1-score': 0.4338729510166835, 'support': 667307}, 'weighted avg': {'precision': 0.4452901841406454, 'recall': 0.4380502527322507, 'f1-score': 0.4368367692754067, 'support': 667307}}
[[125600  67584  53011]
 [ 61842  78853  38225]
 [ 90744  63587  87861]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0204655
{'0': {'precision': 0.4749725017648121, 'recall': 0.4681250404504563, 'f1-score': 0.47152391274232586, 'support': 61804}, '1': {'precision': 0.4664894505014704, 'recall': 0.5989645165545443, 'f1-score': 0.5244912250305014, 'support': 60648}, '2': {'precision': 0.5090096960453209, 'recall': 0.3754158162855352, 'f1-score': 0.43212297219807255, 'support': 62227}, 'accuracy': 0.4798542335620184, 'macro avg': {'precision': 0.4834905494372011, 'recall': 0.48083512443017856, 'f1-score': 0.4760460366569666, 'support': 184679}, 'weighted avg': {'precision': 0.4836554185852089, 'recall': 0.4798542335620184, 'f1-score': 0.47564218947333486, 'support': 184679}}
[[28932 20910 11962]
 [13750 36326 10572]
 [18231 20635 23361]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0595005
{'0': {'precision': 0.4708639053254438, 'recall': 0.4711984841307437, 'f1-score': 0.4710311353143128, 'support': 21110}, '1': {'precision': 0.3901101454663754, 'recall': 0.5203967761934284, 'f1-score': 0.44593194676866676, 'support': 16130}, '2': {'precision': 0.4929841577756224, 'recall': 0.365361575693679, 'f1-score': 0.41968512605967184, 'support': 20867}, 'accuracy': 0.446848056172234, 'macro avg': {'precision': 0.45131940285581384, 'recall': 0.45231894533928374, 'f1-score': 0.4455494027142171, 'support': 58107}, 'weighted avg': {'precision': 0.45639103908473444, 'recall': 0.446848056172234, 'f1-score': 0.44562478003254186, 'support': 58107}}
[[9947 6522 4641]
 [4536 8394 3200]
 [6642 6601 7624]]
training model: results/PCAR/W1/deepOF_L2/h50
Epoch 1/50
722/722 - 19s - loss: 3.2855 - accuracy50: 0.3772 - val_loss: 3.2832 - val_accuracy50: 0.3615 - 19s/epoch - 26ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2293 - accuracy50: 0.4077 - val_loss: 3.2804 - val_accuracy50: 0.3634 - 16s/epoch - 23ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2050 - accuracy50: 0.4194 - val_loss: 3.3006 - val_accuracy50: 0.3565 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 3.1910 - accuracy50: 0.4272 - val_loss: 3.2928 - val_accuracy50: 0.3608 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 3.1800 - accuracy50: 0.4315 - val_loss: 3.2938 - val_accuracy50: 0.3643 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 3.1717 - accuracy50: 0.4359 - val_loss: 3.2965 - val_accuracy50: 0.3653 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 15s - loss: 3.1643 - accuracy50: 0.4379 - val_loss: 3.2888 - val_accuracy50: 0.3704 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 15s - loss: 3.1583 - accuracy50: 0.4409 - val_loss: 3.2884 - val_accuracy50: 0.3712 - 15s/epoch - 21ms/step
Epoch 9/50
722/722 - 16s - loss: 3.1529 - accuracy50: 0.4444 - val_loss: 3.2886 - val_accuracy50: 0.3716 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 15s - loss: 3.1474 - accuracy50: 0.4464 - val_loss: 3.2869 - val_accuracy50: 0.3781 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 3.1427 - accuracy50: 0.4470 - val_loss: 3.2839 - val_accuracy50: 0.3762 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 16s - loss: 3.1360 - accuracy50: 0.4511 - val_loss: 3.2866 - val_accuracy50: 0.3782 - 16s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h50
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0975775
{'0': {'precision': 0.39327783456410875, 'recall': 0.3079072713344831, 'f1-score': 0.3453955421993289, 'support': 233671}, '1': {'precision': 0.3200740131130744, 'recall': 0.5773844051399526, 'f1-score': 0.41184246512899986, 'support': 203426}, '2': {'precision': 0.41769876829247515, 'recall': 0.21300986056209548, 'f1-score': 0.28213965156152904, 'support': 230210}, 'accuracy': 0.35731829577690627, 'macro avg': {'precision': 0.3770168719898861, 'recall': 0.36610051234551033, 'f1-score': 0.3464592196299526, 'support': 667307}, 'weighted avg': {'precision': 0.3793867508067214, 'recall': 0.35731829577690627, 'f1-score': 0.34382938623238013, 'support': 667307}}
[[ 71949 126299  35423]
 [ 53033 117455  32938]
 [ 57965 123208  49037]]
Evaluating performance on  train set...
722/722 - 7s - 7s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0826854
{'0': {'precision': 0.4132428551577192, 'recall': 0.28918962722852515, 'f1-score': 0.34026201872652034, 'support': 61700}, '1': {'precision': 0.35677610222378087, 'recall': 0.6543415519089635, 'f1-score': 0.4617730240569825, 'support': 60635}, '2': {'precision': 0.44305803129332544, 'recall': 0.21528936224817144, 'f1-score': 0.28977309527407763, 'support': 62344}, 'accuracy': 0.3841313847270128, 'macro avg': {'precision': 0.40435899622494187, 'recall': 0.38627351379522, 'f1-score': 0.36393604601919344, 'support': 184679}, 'weighted avg': {'precision': 0.40476834412424423, 'recall': 0.3841313847270128, 'f1-score': 0.36311322738854196, 'support': 184679}}
[[17843 35766  8091]
 [12178 39676  8781]
 [13157 35765 13422]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0949122
{'0': {'precision': 0.41504447595719995, 'recall': 0.31562178324591933, 'f1-score': 0.3585688431017681, 'support': 20401}, '1': {'precision': 0.31928251121076234, 'recall': 0.5900777320530407, 'f1-score': 0.4143605386205374, 'support': 17496}, '2': {'precision': 0.43624488204328327, 'recall': 0.22142503711034142, 'f1-score': 0.29375082053301826, 'support': 20210}, 'accuracy': 0.36549813275508974, 'macro avg': {'precision': 0.39019062307041513, 'recall': 0.3757081841364338, 'f1-score': 0.3555600674184413, 'support': 58107}, 'weighted avg': {'precision': 0.39358421939251875, 'recall': 0.36549813275508974, 'f1-score': 0.35282356746685245, 'support': 58107}}
[[ 6439 11089  2873]
 [ 4262 10324  2910]
 [ 4813 10922  4475]]
training model: results/PCAR/W1/deepOF_L2/h100
Epoch 1/50
722/722 - 18s - loss: 3.3051 - accuracy100: 0.3628 - val_loss: 3.2937 - val_accuracy100: 0.3578 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 17s - loss: 3.2670 - accuracy100: 0.3842 - val_loss: 3.2823 - val_accuracy100: 0.3642 - 17s/epoch - 23ms/step
Epoch 3/50
722/722 - 17s - loss: 3.2517 - accuracy100: 0.3907 - val_loss: 3.2831 - val_accuracy100: 0.3598 - 17s/epoch - 23ms/step
Epoch 4/50
722/722 - 17s - loss: 3.2428 - accuracy100: 0.3962 - val_loss: 3.2791 - val_accuracy100: 0.3619 - 17s/epoch - 23ms/step
Epoch 5/50
722/722 - 17s - loss: 3.2354 - accuracy100: 0.4005 - val_loss: 3.2765 - val_accuracy100: 0.3679 - 17s/epoch - 23ms/step
Epoch 6/50
722/722 - 17s - loss: 3.2297 - accuracy100: 0.4039 - val_loss: 3.2757 - val_accuracy100: 0.3668 - 17s/epoch - 23ms/step
Epoch 7/50
722/722 - 17s - loss: 3.2258 - accuracy100: 0.4065 - val_loss: 3.2747 - val_accuracy100: 0.3695 - 17s/epoch - 23ms/step
Epoch 8/50
722/722 - 17s - loss: 3.2220 - accuracy100: 0.4091 - val_loss: 3.2730 - val_accuracy100: 0.3713 - 17s/epoch - 23ms/step
Epoch 9/50
722/722 - 17s - loss: 3.2180 - accuracy100: 0.4097 - val_loss: 3.2708 - val_accuracy100: 0.3746 - 17s/epoch - 23ms/step
Epoch 10/50
722/722 - 17s - loss: 3.2145 - accuracy100: 0.4129 - val_loss: 3.2695 - val_accuracy100: 0.3810 - 17s/epoch - 23ms/step
Epoch 11/50
722/722 - 17s - loss: 3.2111 - accuracy100: 0.4157 - val_loss: 3.2705 - val_accuracy100: 0.3809 - 17s/epoch - 23ms/step
Epoch 12/50
722/722 - 17s - loss: 3.2074 - accuracy100: 0.4163 - val_loss: 3.2704 - val_accuracy100: 0.3830 - 17s/epoch - 23ms/step
Epoch 13/50
722/722 - 16s - loss: 3.2043 - accuracy100: 0.4180 - val_loss: 3.2710 - val_accuracy100: 0.3822 - 16s/epoch - 23ms/step
Epoch 14/50
722/722 - 16s - loss: 3.1997 - accuracy100: 0.4205 - val_loss: 3.2712 - val_accuracy100: 0.3851 - 16s/epoch - 23ms/step
Epoch 15/50
722/722 - 16s - loss: 3.1954 - accuracy100: 0.4233 - val_loss: 3.2727 - val_accuracy100: 0.3846 - 16s/epoch - 23ms/step
Epoch 16/50
722/722 - 16s - loss: 3.1926 - accuracy100: 0.4247 - val_loss: 3.2743 - val_accuracy100: 0.3832 - 16s/epoch - 23ms/step
Epoch 17/50
722/722 - 16s - loss: 3.1881 - accuracy100: 0.4269 - val_loss: 3.2809 - val_accuracy100: 0.3828 - 16s/epoch - 23ms/step
Epoch 18/50
722/722 - 16s - loss: 3.1830 - accuracy100: 0.4299 - val_loss: 3.2770 - val_accuracy100: 0.3841 - 16s/epoch - 23ms/step
Epoch 19/50
722/722 - 16s - loss: 3.1785 - accuracy100: 0.4320 - val_loss: 3.2830 - val_accuracy100: 0.3826 - 16s/epoch - 23ms/step
Epoch 20/50
722/722 - 16s - loss: 3.1745 - accuracy100: 0.4339 - val_loss: 3.2865 - val_accuracy100: 0.3843 - 16s/epoch - 23ms/step
testing model: results/PCAR/W1/deepOF_L2/h100
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0942998
{'0': {'precision': 0.3788543140028289, 'recall': 0.465643878482333, 'f1-score': 0.41778938953771766, 'support': 230090}, '1': {'precision': 0.34316048184231107, 'recall': 0.42624252951112257, 'f1-score': 0.3802158027726559, 'support': 208989}, '2': {'precision': 0.41046269612552033, 'recall': 0.22466568519200097, 'f1-score': 0.29038816586813465, 'support': 228228}, 'accuracy': 0.3708862637436742, 'macro avg': {'precision': 0.37749249732355344, 'recall': 0.3721840310618189, 'f1-score': 0.3627977860595027, 'support': 667307}, 'weighted avg': {'precision': 0.3784861169746292, 'recall': 0.3708862637436742, 'f1-score': 0.3624490547291437, 'support': 667307}}
[[107140  86527  36423]
 [ 82687  89080  37222]
 [ 92973  83980  51275]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0785489
{'0': {'precision': 0.400980378104889, 'recall': 0.45432547866898354, 'f1-score': 0.42598937158345135, 'support': 61577}, '1': {'precision': 0.3806647295712902, 'recall': 0.4902427415516421, 'f1-score': 0.4285601555270199, 'support': 60929}, '2': {'precision': 0.4332363756105592, 'recall': 0.2539365962716935, 'f1-score': 0.3201946965471784, 'support': 62173}, 'accuracy': 0.39871344332598724, 'macro avg': {'precision': 0.40496049442891285, 'recall': 0.3995016054974397, 'f1-score': 0.39158140788588325, 'support': 184679}, 'weighted avg': {'precision': 0.40513699571391, 'recall': 0.39871344332598724, 'f1-score': 0.39122127647717225, 'support': 184679}}
[[27976 24054  9547]
 [19952 29870 11107]
 [21841 24544 15788]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0909636
{'0': {'precision': 0.39314507436947616, 'recall': 0.4539978094194962, 'f1-score': 0.4213858274993646, 'support': 20086}, '1': {'precision': 0.3467735132855335, 'recall': 0.45257885176418783, 'f1-score': 0.3926737827447047, 'support': 18167}, '2': {'precision': 0.4198357436172112, 'recall': 0.23687921829354286, 'f1-score': 0.3028722308088614, 'support': 19854}, 'accuracy': 0.3793690949455315, 'macro avg': {'precision': 0.38658477709074024, 'recall': 0.3811519598257423, 'f1-score': 0.37231061368431023, 'support': 58107}, 'weighted avg': {'precision': 0.38776679631403616, 'recall': 0.3793690949455315, 'f1-score': 0.37191535637280226, 'support': 58107}}
[[9119 7774 3193]
 [6639 8222 3306]
 [7437 7714 4703]]
training model: results/PCAR/W1/deepOF_L2/h200
Epoch 1/50
722/722 - 18s - loss: 3.3209 - accuracy200: 0.3499 - val_loss: 3.3037 - val_accuracy200: 0.3451 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2905 - accuracy200: 0.3665 - val_loss: 3.2940 - val_accuracy200: 0.3548 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2783 - accuracy200: 0.3736 - val_loss: 3.2920 - val_accuracy200: 0.3558 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 3.2704 - accuracy200: 0.3797 - val_loss: 3.2918 - val_accuracy200: 0.3542 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 3.2659 - accuracy200: 0.3831 - val_loss: 3.2891 - val_accuracy200: 0.3596 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 3.2618 - accuracy200: 0.3853 - val_loss: 3.2886 - val_accuracy200: 0.3623 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 16s - loss: 3.2580 - accuracy200: 0.3883 - val_loss: 3.2879 - val_accuracy200: 0.3635 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 16s - loss: 3.2559 - accuracy200: 0.3894 - val_loss: 3.2850 - val_accuracy200: 0.3667 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2526 - accuracy200: 0.3916 - val_loss: 3.2868 - val_accuracy200: 0.3651 - 15s/epoch - 21ms/step
Epoch 10/50
722/722 - 16s - loss: 3.2506 - accuracy200: 0.3931 - val_loss: 3.2848 - val_accuracy200: 0.3672 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 16s - loss: 3.2477 - accuracy200: 0.3946 - val_loss: 3.2851 - val_accuracy200: 0.3695 - 16s/epoch - 22ms/step
Epoch 12/50
722/722 - 16s - loss: 3.2447 - accuracy200: 0.3966 - val_loss: 3.2837 - val_accuracy200: 0.3740 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 16s - loss: 3.2419 - accuracy200: 0.3978 - val_loss: 3.2865 - val_accuracy200: 0.3702 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 16s - loss: 3.2393 - accuracy200: 0.4002 - val_loss: 3.2855 - val_accuracy200: 0.3696 - 16s/epoch - 22ms/step
Epoch 15/50
722/722 - 16s - loss: 3.2370 - accuracy200: 0.4018 - val_loss: 3.2864 - val_accuracy200: 0.3754 - 16s/epoch - 22ms/step
Epoch 16/50
722/722 - 16s - loss: 3.2351 - accuracy200: 0.4041 - val_loss: 3.2896 - val_accuracy200: 0.3717 - 16s/epoch - 22ms/step
Epoch 17/50
722/722 - 16s - loss: 3.2318 - accuracy200: 0.4051 - val_loss: 3.2887 - val_accuracy200: 0.3712 - 16s/epoch - 22ms/step
Epoch 18/50
722/722 - 16s - loss: 3.2290 - accuracy200: 0.4069 - val_loss: 3.2905 - val_accuracy200: 0.3719 - 16s/epoch - 22ms/step
Epoch 19/50
722/722 - 16s - loss: 3.2248 - accuracy200: 0.4086 - val_loss: 3.2917 - val_accuracy200: 0.3728 - 16s/epoch - 22ms/step
Epoch 20/50
722/722 - 16s - loss: 3.2221 - accuracy200: 0.4111 - val_loss: 3.2976 - val_accuracy200: 0.3713 - 16s/epoch - 22ms/step
Epoch 21/50
722/722 - 16s - loss: 3.2183 - accuracy200: 0.4136 - val_loss: 3.2971 - val_accuracy200: 0.3715 - 16s/epoch - 22ms/step
Epoch 22/50
722/722 - 16s - loss: 3.2149 - accuracy200: 0.4145 - val_loss: 3.3037 - val_accuracy200: 0.3720 - 16s/epoch - 22ms/step
testing model: results/PCAR/W1/deepOF_L2/h200
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0962634
{'0': {'precision': 0.36650561032818557, 'recall': 0.5770495929455467, 'f1-score': 0.4482873127472613, 'support': 230436}, '1': {'precision': 0.3417011180724261, 'recall': 0.2305984995565782, 'f1-score': 0.2753654299150216, 'support': 208605}, '2': {'precision': 0.386107649832637, 'recall': 0.27692253774105646, 'f1-score': 0.32252501390369964, 'support': 228266}, 'accuracy': 0.3660818783558392, 'macro avg': {'precision': 0.3647714594110829, 'recall': 0.3615235434143938, 'f1-score': 0.34872591885532755, 'support': 667307}, 'weighted avg': {'precision': 0.3654568247504985, 'recall': 0.3660818783558392, 'f1-score': 0.3512111150211115, 'support': 667307}}
[[132973  45742  51721]
 [111718  48104  48783]
 [118122  46932  63212]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0850528
{'0': {'precision': 0.3776282499865425, 'recall': 0.5684650665283698, 'f1-score': 0.4537997774730251, 'support': 61703}, '1': {'precision': 0.38586048454469507, 'recall': 0.3034209791587972, 'f1-score': 0.33971076317700816, 'support': 60889}, '2': {'precision': 0.41043858450608006, 'recall': 0.2903023177154638, 'f1-score': 0.34007226346921254, 'support': 62087}, 'accuracy': 0.38756436844470676, 'macro avg': {'precision': 0.39130910634577254, 'recall': 0.38739612113421024, 'f1-score': 0.37786093470641524, 'support': 184679}, 'weighted avg': {'precision': 0.3913728975605811, 'recall': 0.38756436844470676, 'f1-score': 0.37795051386739104, 'support': 184679}}
[[35076 14096 12531]
 [29055 18475 13359]
 [28754 15309 18024]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0959723
{'0': {'precision': 0.38099594824205985, 'recall': 0.5686972638150515, 'f1-score': 0.4562975717612069, 'support': 20503}, '1': {'precision': 0.32596202807885355, 'recall': 0.26088728458313926, 'f1-score': 0.2898166413349287, 'support': 17176}, '2': {'precision': 0.39473684210526316, 'recall': 0.26581163109457606, 'f1-score': 0.3176924877135502, 'support': 20428}, 'accuracy': 0.3712289397146643, 'macro avg': {'precision': 0.36723160614205885, 'recall': 0.3651320598309223, 'f1-score': 0.3546022336032286, 'support': 58107}, 'weighted avg': {'precision': 0.3695590536702232, 'recall': 0.3712289397146643, 'f1-score': 0.3583592662570975, 'support': 58107}}
[[11660  4510  4333]
 [ 8702  4481  3993]
 [10242  4756  5430]]
training model: results/PCAR/W1/deepOF_L2/h300
Epoch 1/50
722/722 - 18s - loss: 3.3085 - accuracy300: 0.3646 - val_loss: 3.2905 - val_accuracy300: 0.3617 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2717 - accuracy300: 0.3820 - val_loss: 3.2828 - val_accuracy300: 0.3640 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2574 - accuracy300: 0.3923 - val_loss: 3.2803 - val_accuracy300: 0.3664 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 3.2486 - accuracy300: 0.3963 - val_loss: 3.2803 - val_accuracy300: 0.3685 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 3.2456 - accuracy300: 0.3988 - val_loss: 3.2775 - val_accuracy300: 0.3707 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 3.2427 - accuracy300: 0.3991 - val_loss: 3.2771 - val_accuracy300: 0.3742 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 16s - loss: 3.2398 - accuracy300: 0.4025 - val_loss: 3.2783 - val_accuracy300: 0.3719 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 16s - loss: 3.2373 - accuracy300: 0.4022 - val_loss: 3.2789 - val_accuracy300: 0.3708 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 16s - loss: 3.2364 - accuracy300: 0.4031 - val_loss: 3.2782 - val_accuracy300: 0.3700 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 16s - loss: 3.2336 - accuracy300: 0.4038 - val_loss: 3.2766 - val_accuracy300: 0.3738 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 15s - loss: 3.2333 - accuracy300: 0.4047 - val_loss: 3.2772 - val_accuracy300: 0.3723 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 16s - loss: 3.2313 - accuracy300: 0.4049 - val_loss: 3.2761 - val_accuracy300: 0.3732 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 16s - loss: 3.2287 - accuracy300: 0.4059 - val_loss: 3.2769 - val_accuracy300: 0.3731 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 16s - loss: 3.2262 - accuracy300: 0.4075 - val_loss: 3.2766 - val_accuracy300: 0.3736 - 16s/epoch - 22ms/step
Epoch 15/50
722/722 - 16s - loss: 3.2237 - accuracy300: 0.4092 - val_loss: 3.2759 - val_accuracy300: 0.3758 - 16s/epoch - 22ms/step
Epoch 16/50
722/722 - 16s - loss: 3.2223 - accuracy300: 0.4108 - val_loss: 3.2779 - val_accuracy300: 0.3730 - 16s/epoch - 22ms/step
Epoch 17/50
722/722 - 16s - loss: 3.2195 - accuracy300: 0.4121 - val_loss: 3.2777 - val_accuracy300: 0.3745 - 16s/epoch - 22ms/step
Epoch 18/50
722/722 - 16s - loss: 3.2160 - accuracy300: 0.4135 - val_loss: 3.2794 - val_accuracy300: 0.3749 - 16s/epoch - 22ms/step
Epoch 19/50
722/722 - 16s - loss: 3.2135 - accuracy300: 0.4154 - val_loss: 3.2818 - val_accuracy300: 0.3718 - 16s/epoch - 22ms/step
Epoch 20/50
722/722 - 16s - loss: 3.2108 - accuracy300: 0.4164 - val_loss: 3.2808 - val_accuracy300: 0.3732 - 16s/epoch - 21ms/step
Epoch 21/50
722/722 - 15s - loss: 3.2065 - accuracy300: 0.4192 - val_loss: 3.2850 - val_accuracy300: 0.3718 - 15s/epoch - 21ms/step
Epoch 22/50
722/722 - 16s - loss: 3.2028 - accuracy300: 0.4208 - val_loss: 3.2847 - val_accuracy300: 0.3722 - 16s/epoch - 21ms/step
Epoch 23/50
722/722 - 16s - loss: 3.1986 - accuracy300: 0.4237 - val_loss: 3.2901 - val_accuracy300: 0.3706 - 16s/epoch - 22ms/step
Epoch 24/50
722/722 - 16s - loss: 3.1925 - accuracy300: 0.4277 - val_loss: 3.2942 - val_accuracy300: 0.3710 - 16s/epoch - 22ms/step
Epoch 25/50
722/722 - 16s - loss: 3.1872 - accuracy300: 0.4299 - val_loss: 3.2953 - val_accuracy300: 0.3719 - 16s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h300
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0946503
{'0': {'precision': 0.36047422472331286, 'recall': 0.6461087902149102, 'f1-score': 0.46276474326150124, 'support': 232190}, '1': {'precision': 0.3852093973442288, 'recall': 0.045948777932110045, 'f1-score': 0.0821039797962205, 'support': 205185}, '2': {'precision': 0.37262748281551944, 'recall': 0.3673216429205156, 'f1-score': 0.3699555399811647, 'support': 229932}, 'accuracy': 0.36550942819421944, 'macro avg': {'precision': 0.3727703682943537, 'recall': 0.3531264036891786, 'f1-score': 0.3049414210129621, 'support': 667307}, 'weighted avg': {'precision': 0.3722674613203812, 'recall': 0.36550942819421944, 'f1-score': 0.31373935542610015, 'support': 667307}}
[[150020   7388  74782]
 [128340   9428  67417]
 [137814   7659  84459]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0873942
{'0': {'precision': 0.3593633424521263, 'recall': 0.6554668135499863, 'f1-score': 0.46421707827783043, 'support': 61727}, '1': {'precision': 0.4322912205567452, 'recall': 0.08267400527462447, 'f1-score': 0.13880256318583098, 'support': 61047}, '2': {'precision': 0.3890856726694915, 'recall': 0.37972700104999596, 'f1-score': 0.3843493758226306, 'support': 61905}, 'accuracy': 0.3736970635535172, 'macro avg': {'precision': 0.3935800785594543, 'recall': 0.37262260662486885, 'f1-score': 0.32912300576209735, 'support': 184679}, 'weighted avg': {'precision': 0.3934332097719551, 'recall': 0.3736970635535172, 'f1-score': 0.3298770070011263, 'support': 184679}}
[[40460  3228 18039]
 [37130  5047 18870]
 [34998  3400 23507]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0926102
{'0': {'precision': 0.36988647349667153, 'recall': 0.649796195652174, 'f1-score': 0.47142278784038305, 'support': 20608}, '1': {'precision': 0.34865350089766606, 'recall': 0.05815764254911356, 'f1-score': 0.09968687439043171, 'support': 16696}, '2': {'precision': 0.3909723311888697, 'recall': 0.35932317454213336, 'f1-score': 0.3744802364610992, 'support': 20803}, 'accuracy': 0.3758067014301203, 'macro avg': {'precision': 0.36983743519440243, 'recall': 0.35575900424780693, 'f1-score': 0.31519663289730465, 'support': 58107}, 'weighted avg': {'precision': 0.3713345500977317, 'recall': 0.3758067014301203, 'f1-score': 0.32990457648368543, 'support': 58107}}
[[13391   844  6373]
 [10454   971  5271]
 [12358   970  7475]]
training model: results/PCAR/W1/deepOF_L2/h500
Epoch 1/50
722/722 - 19s - loss: 3.3183 - accuracy500: 0.3574 - val_loss: 3.3117 - val_accuracy500: 0.3418 - 19s/epoch - 26ms/step
Epoch 2/50
722/722 - 17s - loss: 3.2829 - accuracy500: 0.3748 - val_loss: 3.3080 - val_accuracy500: 0.3466 - 17s/epoch - 23ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2693 - accuracy500: 0.3826 - val_loss: 3.3079 - val_accuracy500: 0.3437 - 16s/epoch - 23ms/step
Epoch 4/50
722/722 - 16s - loss: 3.2614 - accuracy500: 0.3871 - val_loss: 3.3078 - val_accuracy500: 0.3441 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 3.2561 - accuracy500: 0.3896 - val_loss: 3.3053 - val_accuracy500: 0.3471 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 16s - loss: 3.2523 - accuracy500: 0.3912 - val_loss: 3.3028 - val_accuracy500: 0.3477 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 16s - loss: 3.2499 - accuracy500: 0.3928 - val_loss: 3.3034 - val_accuracy500: 0.3464 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 16s - loss: 3.2466 - accuracy500: 0.3951 - val_loss: 3.3025 - val_accuracy500: 0.3479 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 16s - loss: 3.2449 - accuracy500: 0.3957 - val_loss: 3.3020 - val_accuracy500: 0.3476 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 16s - loss: 3.2422 - accuracy500: 0.3976 - val_loss: 3.3009 - val_accuracy500: 0.3510 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 16s - loss: 3.2399 - accuracy500: 0.3980 - val_loss: 3.3050 - val_accuracy500: 0.3469 - 16s/epoch - 22ms/step
Epoch 12/50
722/722 - 16s - loss: 3.2371 - accuracy500: 0.4004 - val_loss: 3.3032 - val_accuracy500: 0.3496 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 15s - loss: 3.2359 - accuracy500: 0.4004 - val_loss: 3.3043 - val_accuracy500: 0.3473 - 15s/epoch - 21ms/step
Epoch 14/50
722/722 - 16s - loss: 3.2342 - accuracy500: 0.4005 - val_loss: 3.3025 - val_accuracy500: 0.3522 - 16s/epoch - 22ms/step
Epoch 15/50
722/722 - 16s - loss: 3.2314 - accuracy500: 0.4019 - val_loss: 3.3037 - val_accuracy500: 0.3524 - 16s/epoch - 21ms/step
Epoch 16/50
722/722 - 16s - loss: 3.2288 - accuracy500: 0.4047 - val_loss: 3.3100 - val_accuracy500: 0.3501 - 16s/epoch - 22ms/step
Epoch 17/50
722/722 - 15s - loss: 3.2272 - accuracy500: 0.4064 - val_loss: 3.3089 - val_accuracy500: 0.3498 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 16s - loss: 3.2246 - accuracy500: 0.4054 - val_loss: 3.3095 - val_accuracy500: 0.3492 - 16s/epoch - 22ms/step
Epoch 19/50
722/722 - 15s - loss: 3.2222 - accuracy500: 0.4078 - val_loss: 3.3103 - val_accuracy500: 0.3485 - 15s/epoch - 21ms/step
Epoch 20/50
722/722 - 15s - loss: 3.2199 - accuracy500: 0.4093 - val_loss: 3.3113 - val_accuracy500: 0.3494 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h500
Evaluating performance on  test set...
2607/2607 - 19s - 19s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1019019
{'0': {'precision': 0.36012943757333704, 'recall': 0.2153775743707094, 'f1-score': 0.2695494689526885, 'support': 229425}, '1': {'precision': 0.33147706659756415, 'recall': 0.6110344168716711, 'f1-score': 0.4297961343648414, 'support': 209345}, '2': {'precision': 0.3614890636485943, 'recall': 0.22808560539431252, 'f1-score': 0.27969468925644225, 'support': 228537}, 'accuracy': 0.3438537284937817, 'macro avg': {'precision': 0.3510318559398318, 'recall': 0.35149919887889763, 'f1-score': 0.326346764191324, 'support': 667307}, 'weighted avg': {'precision': 0.3516063653778377, 'recall': 0.3438537284937817, 'f1-score': 0.3232959400421063, 'support': 667307}}
[[ 49413 129066  50946]
 [ 40302 127917  41126]
 [ 47494 128917  52126]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0897608
{'0': {'precision': 0.39579661901964625, 'recall': 0.19427802518181528, 'f1-score': 0.26062663858683977, 'support': 62426}, '1': {'precision': 0.36487034874572455, 'recall': 0.7283713855869857, 'f1-score': 0.486189125660748, 'support': 60487}, '2': {'precision': 0.4076899969960949, 'recall': 0.2197325389372794, 'f1-score': 0.2855579868708972, 'support': 61766}, 'accuracy': 0.3777202605602153, 'macro avg': {'precision': 0.38945232158715526, 'recall': 0.3807939832353601, 'f1-score': 0.34412458370616167, 'support': 184679}, 'weighted avg': {'precision': 0.38964523783410066, 'recall': 0.3777202605602153, 'f1-score': 0.34284230909487035, 'support': 184679}}
[[12128 38771 11527]
 [ 8239 44057  8191]
 [10275 37919 13572]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1010545
{'0': {'precision': 0.3746930901438092, 'recall': 0.21652984696462957, 'f1-score': 0.2744556490461815, 'support': 19734}, '1': {'precision': 0.3374562295267141, 'recall': 0.6547227701073854, 'f1-score': 0.44536374478234947, 'support': 18252}, '2': {'precision': 0.3679922061819148, 'recall': 0.20650067094080812, 'f1-score': 0.26454858016044824, 'support': 20121}, 'accuracy': 0.3506978505171494, 'macro avg': {'precision': 0.36004717528414604, 'recall': 0.35925109600427435, 'f1-score': 0.3281226579963264, 'support': 58107}, 'weighted avg': {'precision': 0.36067626487008153, 'recall': 0.3506978505171494, 'f1-score': 0.32470905105156295, 'support': 58107}}
[[ 4273 11428  4033]
 [ 3199 11950  3103]
 [ 3932 12034  4155]]
training model: results/PCAR/W1/deepOF_L2/h1000
Epoch 1/50
722/722 - 18s - loss: 3.3311 - accuracy1000: 0.3461 - val_loss: 3.3189 - val_accuracy1000: 0.3325 - 18s/epoch - 24ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2982 - accuracy1000: 0.3609 - val_loss: 3.3116 - val_accuracy1000: 0.3386 - 16s/epoch - 21ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2857 - accuracy1000: 0.3685 - val_loss: 3.3085 - val_accuracy1000: 0.3386 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 16s - loss: 3.2783 - accuracy1000: 0.3723 - val_loss: 3.3123 - val_accuracy1000: 0.3332 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 16s - loss: 3.2741 - accuracy1000: 0.3737 - val_loss: 3.3068 - val_accuracy1000: 0.3366 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 15s - loss: 3.2701 - accuracy1000: 0.3767 - val_loss: 3.3044 - val_accuracy1000: 0.3358 - 15s/epoch - 21ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2682 - accuracy1000: 0.3774 - val_loss: 3.3041 - val_accuracy1000: 0.3350 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 16s - loss: 3.2649 - accuracy1000: 0.3786 - val_loss: 3.3037 - val_accuracy1000: 0.3364 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 16s - loss: 3.2637 - accuracy1000: 0.3787 - val_loss: 3.3028 - val_accuracy1000: 0.3341 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 16s - loss: 3.2609 - accuracy1000: 0.3815 - val_loss: 3.3016 - val_accuracy1000: 0.3376 - 16s/epoch - 22ms/step
Epoch 11/50
722/722 - 16s - loss: 3.2590 - accuracy1000: 0.3825 - val_loss: 3.3008 - val_accuracy1000: 0.3370 - 16s/epoch - 22ms/step
Epoch 12/50
722/722 - 16s - loss: 3.2567 - accuracy1000: 0.3842 - val_loss: 3.3040 - val_accuracy1000: 0.3368 - 16s/epoch - 22ms/step
Epoch 13/50
722/722 - 15s - loss: 3.2549 - accuracy1000: 0.3845 - val_loss: 3.3026 - val_accuracy1000: 0.3379 - 15s/epoch - 21ms/step
Epoch 14/50
722/722 - 15s - loss: 3.2528 - accuracy1000: 0.3874 - val_loss: 3.3052 - val_accuracy1000: 0.3377 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 3.2504 - accuracy1000: 0.3883 - val_loss: 3.3062 - val_accuracy1000: 0.3374 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 15s - loss: 3.2489 - accuracy1000: 0.3880 - val_loss: 3.3058 - val_accuracy1000: 0.3385 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 15s - loss: 3.2472 - accuracy1000: 0.3902 - val_loss: 3.3071 - val_accuracy1000: 0.3373 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 16s - loss: 3.2454 - accuracy1000: 0.3911 - val_loss: 3.3091 - val_accuracy1000: 0.3351 - 16s/epoch - 22ms/step
Epoch 19/50
722/722 - 16s - loss: 3.2430 - accuracy1000: 0.3921 - val_loss: 3.3083 - val_accuracy1000: 0.3386 - 16s/epoch - 22ms/step
Epoch 20/50
722/722 - 16s - loss: 3.2396 - accuracy1000: 0.3939 - val_loss: 3.3096 - val_accuracy1000: 0.3386 - 16s/epoch - 22ms/step
Epoch 21/50
722/722 - 15s - loss: 3.2380 - accuracy1000: 0.3947 - val_loss: 3.3133 - val_accuracy1000: 0.3372 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepOF_L2/h1000
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1033232
{'0': {'precision': 0.36109731514213095, 'recall': 0.10503505417463352, 'f1-score': 0.1627343585422372, 'support': 235350}, '1': {'precision': 0.3070146564953406, 'recall': 0.6916051263038708, 'f1-score': 0.42525276174163773, 'support': 199598}, '2': {'precision': 0.3573673593845288, 'recall': 0.22949831941091156, 'f1-score': 0.2795024870406575, 'support': 232359}, 'accuracy': 0.3238224685189875, 'macro avg': {'precision': 0.3418264436740001, 'recall': 0.3420461666298053, 'f1-score': 0.2891632024415108, 'support': 667307}, 'weighted avg': {'precision': 0.343621881360584, 'recall': 0.3238224685189875, 'f1-score': 0.2819152959691762, 'support': 667307}}
[[ 24720 156580  54050]
 [ 19712 138043  41843]
 [ 24026 155007  53326]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.093489
{'0': {'precision': 0.4006943053608385, 'recall': 0.09539855360406899, 'f1-score': 0.15410686317303002, 'support': 62915}, '1': {'precision': 0.34820689099157864, 'recall': 0.7919222563008401, 'f1-score': 0.4837220194368506, 'support': 59992}, '2': {'precision': 0.4022428670214365, 'recall': 0.21658680308230266, 'f1-score': 0.2815653509833426, 'support': 61772}, 'accuracy': 0.36219602661916084, 'macro avg': {'precision': 0.38371468779128454, 'recall': 0.3679692043290706, 'f1-score': 0.3064647445310744, 'support': 184679}, 'weighted avg': {'precision': 0.38416201304854436, 'recall': 0.36219602661916084, 'f1-score': 0.30381331687701235, 'support': 184679}}
[[ 6002 45412 11501]
 [ 4102 47509  8381]
 [ 4875 43518 13379]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1011167
{'0': {'precision': 0.36795252225519287, 'recall': 0.10125548637337961, 'f1-score': 0.15880893300248142, 'support': 19594}, '1': {'precision': 0.3322809977105675, 'recall': 0.7358309317963496, 'f1-score': 0.45782212408480394, 'support': 18738}, '2': {'precision': 0.35035650623885917, 'recall': 0.19878634639696588, 'f1-score': 0.2536538151314728, 'support': 19775}, 'accuracy': 0.33908134992341715, 'macro avg': {'precision': 0.3501966754015398, 'recall': 0.34529092152223173, 'f1-score': 0.29009495740625274, 'support': 58107}, 'weighted avg': {'precision': 0.3504610970630441, 'recall': 0.33908134992341715, 'f1-score': 0.2875105820052068, 'support': 58107}}
[[ 1984 13622  3988]
 [ 1649 13788  3301]
 [ 1759 14085  3931]]
training model: results/PCAR/W1/deepVOL_L2/h10
Epoch 1/50
722/722 - 18s - loss: 3.1489 - accuracy10: 0.4426 - val_loss: 3.1938 - val_accuracy10: 0.4631 - 18s/epoch - 24ms/step
Epoch 2/50
722/722 - 16s - loss: 2.9699 - accuracy10: 0.5050 - val_loss: 3.1344 - val_accuracy10: 0.4816 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 15s - loss: 2.9198 - accuracy10: 0.5200 - val_loss: 3.1030 - val_accuracy10: 0.4901 - 15s/epoch - 21ms/step
Epoch 4/50
722/722 - 15s - loss: 2.8940 - accuracy10: 0.5280 - val_loss: 3.1298 - val_accuracy10: 0.4862 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 2.8776 - accuracy10: 0.5329 - val_loss: 3.1073 - val_accuracy10: 0.4909 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 15s - loss: 2.8635 - accuracy10: 0.5380 - val_loss: 3.0900 - val_accuracy10: 0.4978 - 15s/epoch - 21ms/step
Epoch 7/50
722/722 - 15s - loss: 2.8515 - accuracy10: 0.5411 - val_loss: 3.0769 - val_accuracy10: 0.4992 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 15s - loss: 2.8412 - accuracy10: 0.5432 - val_loss: 3.0640 - val_accuracy10: 0.5036 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 16s - loss: 2.8306 - accuracy10: 0.5451 - val_loss: 3.0848 - val_accuracy10: 0.5014 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 15s - loss: 2.8242 - accuracy10: 0.5466 - val_loss: 3.0524 - val_accuracy10: 0.5084 - 15s/epoch - 20ms/step
Epoch 11/50
722/722 - 15s - loss: 2.8153 - accuracy10: 0.5492 - val_loss: 3.0658 - val_accuracy10: 0.5063 - 15s/epoch - 20ms/step
Epoch 12/50
722/722 - 15s - loss: 2.8100 - accuracy10: 0.5494 - val_loss: 3.0667 - val_accuracy10: 0.5043 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 16s - loss: 2.8040 - accuracy10: 0.5512 - val_loss: 3.0647 - val_accuracy10: 0.5066 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 15s - loss: 2.7986 - accuracy10: 0.5520 - val_loss: 3.0666 - val_accuracy10: 0.5069 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 2.7919 - accuracy10: 0.5540 - val_loss: 3.0567 - val_accuracy10: 0.5086 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 15s - loss: 2.7873 - accuracy10: 0.5546 - val_loss: 3.0417 - val_accuracy10: 0.5120 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 15s - loss: 2.7807 - accuracy10: 0.5563 - val_loss: 3.0462 - val_accuracy10: 0.5122 - 15s/epoch - 20ms/step
Epoch 18/50
722/722 - 16s - loss: 2.7782 - accuracy10: 0.5559 - val_loss: 3.0409 - val_accuracy10: 0.5122 - 16s/epoch - 23ms/step
Epoch 19/50
722/722 - 15s - loss: 2.7713 - accuracy10: 0.5577 - val_loss: 3.0493 - val_accuracy10: 0.5115 - 15s/epoch - 21ms/step
Epoch 20/50
722/722 - 15s - loss: 2.7670 - accuracy10: 0.5582 - val_loss: 3.0325 - val_accuracy10: 0.5135 - 15s/epoch - 20ms/step
Epoch 21/50
722/722 - 15s - loss: 2.7624 - accuracy10: 0.5584 - val_loss: 3.0471 - val_accuracy10: 0.5143 - 15s/epoch - 21ms/step
Epoch 22/50
722/722 - 15s - loss: 2.7576 - accuracy10: 0.5599 - val_loss: 3.0489 - val_accuracy10: 0.5124 - 15s/epoch - 21ms/step
Epoch 23/50
722/722 - 15s - loss: 2.7544 - accuracy10: 0.5613 - val_loss: 3.0507 - val_accuracy10: 0.5137 - 15s/epoch - 20ms/step
Epoch 24/50
722/722 - 15s - loss: 2.7490 - accuracy10: 0.5631 - val_loss: 3.0395 - val_accuracy10: 0.5155 - 15s/epoch - 21ms/step
Epoch 25/50
722/722 - 15s - loss: 2.7436 - accuracy10: 0.5631 - val_loss: 3.0488 - val_accuracy10: 0.5141 - 15s/epoch - 21ms/step
Epoch 26/50
722/722 - 15s - loss: 2.7404 - accuracy10: 0.5647 - val_loss: 3.0625 - val_accuracy10: 0.5125 - 15s/epoch - 20ms/step
Epoch 27/50
722/722 - 15s - loss: 2.7356 - accuracy10: 0.5651 - val_loss: 3.0452 - val_accuracy10: 0.5145 - 15s/epoch - 20ms/step
Epoch 28/50
722/722 - 15s - loss: 2.7309 - accuracy10: 0.5657 - val_loss: 3.0367 - val_accuracy10: 0.5162 - 15s/epoch - 21ms/step
Epoch 29/50
722/722 - 15s - loss: 2.7267 - accuracy10: 0.5675 - val_loss: 3.0552 - val_accuracy10: 0.5147 - 15s/epoch - 20ms/step
Epoch 30/50
722/722 - 15s - loss: 2.7239 - accuracy10: 0.5683 - val_loss: 3.0484 - val_accuracy10: 0.5176 - 15s/epoch - 20ms/step
testing model: results/PCAR/W1/deepVOL_L2/h10
Evaluating performance on  test set...
2607/2607 - 25s - 25s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0003979
{'0': {'precision': 0.5375115009680569, 'recall': 0.4136800034753899, 'f1-score': 0.4675352093659246, 'support': 230190}, '1': {'precision': 0.5084932769135638, 'recall': 0.5826128833588791, 'f1-score': 0.5430355817205601, 'support': 215953}, '2': {'precision': 0.49278186567348653, 'recall': 0.5408036388463121, 'f1-score': 0.5156771741637584, 'support': 221169}, 'accuracy': 0.5104823530822165, 'macro avg': {'precision': 0.5129288811850358, 'recall': 0.5123655085601937, 'f1-score': 0.508749321750081, 'support': 667312}, 'weighted avg': {'precision': 0.5132958698274438, 'recall': 0.5104823530822165, 'f1-score': 0.5079241760314015, 'support': 667312}}
[[ 95225  59479  75486]
 [ 42509 125817  47627]
 [ 39425  62135 119609]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9459487
{'0': {'precision': 0.5342234240324488, 'recall': 0.40433074463225216, 'f1-score': 0.46028873356631717, 'support': 54725}, '1': {'precision': 0.6203130828499028, 'recall': 0.6378715130351971, 'f1-score': 0.6289697807572417, 'support': 75603}, '2': {'precision': 0.4736103055648829, 'recall': 0.5709081542537533, 'f1-score': 0.517727538166347, 'support': 54352}, 'accuracy': 0.5489603638726446, 'macro avg': {'precision': 0.5427156041490782, 'recall': 0.5377034706404008, 'f1-score': 0.5356620174966352, 'support': 184680}, 'weighted avg': {'precision': 0.5516275406700211, 'recall': 0.5489603638726446, 'f1-score': 0.5462466451885626, 'support': 184680}}
[[22127 14234 18364]
 [11254 48225 16124]
 [ 8038 15284 31030]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99459493
{'0': {'precision': 0.5302633393078726, 'recall': 0.4096282884226222, 'f1-score': 0.46220406201177744, 'support': 18778}, '1': {'precision': 0.5554170661553212, 'recall': 0.5625910459357094, 'f1-score': 0.5589810392242004, 'support': 20594}, '2': {'precision': 0.4697036320464339, 'recall': 0.570132365499573, 'f1-score': 0.5150682289406432, 'support': 18736}, 'accuracy': 0.5155916569147105, 'macro avg': {'precision': 0.5184613458365425, 'recall': 0.5141172332859681, 'f1-score': 0.512084443392207, 'support': 58108}, 'weighted avg': {'precision': 0.519651533281956, 'recall': 0.5155916569147105, 'f1-score': 0.5135479062379058, 'support': 58108}}
[[ 7692  4274  6812]
 [ 3760 11586  5248]
 [ 3054  5000 10682]]
training model: results/PCAR/W1/deepVOL_L2/h20
Epoch 1/50
722/722 - 17s - loss: 3.1713 - accuracy20: 0.4329 - val_loss: 3.3743 - val_accuracy20: 0.4029 - 17s/epoch - 24ms/step
Epoch 2/50
722/722 - 15s - loss: 3.0407 - accuracy20: 0.4806 - val_loss: 3.1852 - val_accuracy20: 0.4408 - 15s/epoch - 21ms/step
Epoch 3/50
722/722 - 15s - loss: 2.9990 - accuracy20: 0.4956 - val_loss: 3.1494 - val_accuracy20: 0.4526 - 15s/epoch - 20ms/step
Epoch 4/50
722/722 - 15s - loss: 2.9739 - accuracy20: 0.5048 - val_loss: 3.1504 - val_accuracy20: 0.4526 - 15s/epoch - 20ms/step
Epoch 5/50
722/722 - 15s - loss: 2.9597 - accuracy20: 0.5087 - val_loss: 3.1481 - val_accuracy20: 0.4558 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 15s - loss: 2.9479 - accuracy20: 0.5122 - val_loss: 3.1371 - val_accuracy20: 0.4599 - 15s/epoch - 21ms/step
Epoch 7/50
722/722 - 15s - loss: 2.9408 - accuracy20: 0.5146 - val_loss: 3.1136 - val_accuracy20: 0.4612 - 15s/epoch - 20ms/step
Epoch 8/50
722/722 - 15s - loss: 2.9323 - accuracy20: 0.5172 - val_loss: 3.1253 - val_accuracy20: 0.4597 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 15s - loss: 2.9253 - accuracy20: 0.5198 - val_loss: 3.1064 - val_accuracy20: 0.4626 - 15s/epoch - 20ms/step
Epoch 10/50
722/722 - 15s - loss: 2.9190 - accuracy20: 0.5210 - val_loss: 3.1216 - val_accuracy20: 0.4621 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 2.9141 - accuracy20: 0.5233 - val_loss: 3.1106 - val_accuracy20: 0.4626 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 15s - loss: 2.9088 - accuracy20: 0.5255 - val_loss: 3.1055 - val_accuracy20: 0.4627 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 2.9035 - accuracy20: 0.5260 - val_loss: 3.0956 - val_accuracy20: 0.4681 - 15s/epoch - 21ms/step
Epoch 14/50
722/722 - 15s - loss: 2.8997 - accuracy20: 0.5275 - val_loss: 3.0937 - val_accuracy20: 0.4690 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 2.8938 - accuracy20: 0.5285 - val_loss: 3.1178 - val_accuracy20: 0.4633 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 15s - loss: 2.8896 - accuracy20: 0.5293 - val_loss: 3.1338 - val_accuracy20: 0.4575 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 15s - loss: 2.8869 - accuracy20: 0.5301 - val_loss: 3.1236 - val_accuracy20: 0.4612 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 15s - loss: 2.8843 - accuracy20: 0.5311 - val_loss: 3.1187 - val_accuracy20: 0.4636 - 15s/epoch - 21ms/step
Epoch 19/50
722/722 - 15s - loss: 2.8791 - accuracy20: 0.5318 - val_loss: 3.1223 - val_accuracy20: 0.4651 - 15s/epoch - 21ms/step
Epoch 20/50
722/722 - 15s - loss: 2.8756 - accuracy20: 0.5326 - val_loss: 3.1360 - val_accuracy20: 0.4602 - 15s/epoch - 20ms/step
Epoch 21/50
722/722 - 15s - loss: 2.8725 - accuracy20: 0.5334 - val_loss: 3.1352 - val_accuracy20: 0.4620 - 15s/epoch - 20ms/step
Epoch 22/50
722/722 - 15s - loss: 2.8698 - accuracy20: 0.5342 - val_loss: 3.1393 - val_accuracy20: 0.4646 - 15s/epoch - 20ms/step
Epoch 23/50
722/722 - 15s - loss: 2.8671 - accuracy20: 0.5354 - val_loss: 3.1347 - val_accuracy20: 0.4656 - 15s/epoch - 20ms/step
Epoch 24/50
722/722 - 15s - loss: 2.8624 - accuracy20: 0.5353 - val_loss: 3.1511 - val_accuracy20: 0.4612 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepVOL_L2/h20
Evaluating performance on  test set...
2607/2607 - 24s - 24s/epoch - 9ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0575069
{'0': {'precision': 0.5489688446941837, 'recall': 0.29398558430816496, 'f1-score': 0.3829125775290237, 'support': 253890}, '1': {'precision': 0.3700875483123338, 'recall': 0.6672947087454859, 'f1-score': 0.47611661194557187, 'support': 165594}, '2': {'precision': 0.5023800317910384, 'recall': 0.4718554804138354, 'f1-score': 0.48663956154624033, 'support': 247828}, 'accuracy': 0.45268030546431054, 'macro avg': {'precision': 0.47381214159918533, 'recall': 0.47771192448916205, 'f1-score': 0.4485562503402787, 'support': 667312}, 'weighted avg': {'precision': 0.48727703978551024, 'recall': 0.45268030546431054, 'f1-score': 0.4445636191260467, 'support': 667312}}
[[ 74640  95425  83825]
 [ 23088 110500  32006]
 [ 38236  92653 116939]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0036515
{'0': {'precision': 0.5543175487465181, 'recall': 0.2982402423695491, 'f1-score': 0.3878207478966063, 'support': 62054}, '1': {'precision': 0.4835347449100713, 'recall': 0.7070852344111618, 'f1-score': 0.5743230995428027, 'support': 60492}, '2': {'precision': 0.49301333672852277, 'recall': 0.49856761193549426, 'f1-score': 0.49577491837910503, 'support': 62134}, 'accuracy': 0.4995559887372753, 'macro avg': {'precision': 0.510288543461704, 'recall': 0.5012976962387351, 'f1-score': 0.48597292193950475, 'support': 184680}, 'weighted avg': {'precision': 0.5105073403904402, 'recall': 0.4995559887372753, 'f1-score': 0.4852299133966133, 'support': 184680}}
[[18507 22851 20696]
 [ 6559 42773 11160]
 [ 8321 22835 30978]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0339899
{'0': {'precision': 0.5637695946572674, 'recall': 0.2855666228152603, 'f1-score': 0.37910494308435994, 'support': 21284}, '1': {'precision': 0.4099435656943009, 'recall': 0.6576766131089008, 'f1-score': 0.5050678156979875, 'support': 15684}, '2': {'precision': 0.4874351454996616, 'recall': 0.5110690633869441, 'f1-score': 0.4989724050340607, 'support': 21140}, 'accuracy': 0.46804226612514627, 'macro avg': {'precision': 0.4870494352837433, 'recall': 0.4847707664370351, 'f1-score': 0.46104838793880276, 'support': 58108}, 'weighted avg': {'precision': 0.4944793472998131, 'recall': 0.46804226612514627, 'f1-score': 0.4567121544784676, 'support': 58108}}
[[ 6078  7288  7918]
 [ 1926 10315  3443]
 [ 2777  7559 10804]]
training model: results/PCAR/W1/deepVOL_L2/h30
Epoch 1/50
722/722 - 18s - loss: 3.2414 - accuracy30: 0.4035 - val_loss: 3.2688 - val_accuracy30: 0.4032 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 15s - loss: 3.1340 - accuracy30: 0.4481 - val_loss: 3.2224 - val_accuracy30: 0.4236 - 15s/epoch - 21ms/step
Epoch 3/50
722/722 - 16s - loss: 3.1011 - accuracy30: 0.4631 - val_loss: 3.2122 - val_accuracy30: 0.4292 - 16s/epoch - 21ms/step
Epoch 4/50
722/722 - 15s - loss: 3.0815 - accuracy30: 0.4708 - val_loss: 3.2186 - val_accuracy30: 0.4269 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 3.0702 - accuracy30: 0.4747 - val_loss: 3.2400 - val_accuracy30: 0.4281 - 15s/epoch - 20ms/step
Epoch 6/50
722/722 - 15s - loss: 3.0606 - accuracy30: 0.4788 - val_loss: 3.2139 - val_accuracy30: 0.4349 - 15s/epoch - 21ms/step
Epoch 7/50
722/722 - 16s - loss: 3.0535 - accuracy30: 0.4811 - val_loss: 3.2106 - val_accuracy30: 0.4322 - 16s/epoch - 22ms/step
Epoch 8/50
722/722 - 15s - loss: 3.0470 - accuracy30: 0.4833 - val_loss: 3.2088 - val_accuracy30: 0.4327 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 16s - loss: 3.0423 - accuracy30: 0.4853 - val_loss: 3.2017 - val_accuracy30: 0.4337 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 15s - loss: 3.0368 - accuracy30: 0.4876 - val_loss: 3.2033 - val_accuracy30: 0.4383 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 3.0329 - accuracy30: 0.4890 - val_loss: 3.2071 - val_accuracy30: 0.4391 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 15s - loss: 3.0283 - accuracy30: 0.4904 - val_loss: 3.1979 - val_accuracy30: 0.4384 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 3.0248 - accuracy30: 0.4915 - val_loss: 3.2127 - val_accuracy30: 0.4384 - 15s/epoch - 21ms/step
Epoch 14/50
722/722 - 15s - loss: 3.0206 - accuracy30: 0.4930 - val_loss: 3.2217 - val_accuracy30: 0.4361 - 15s/epoch - 20ms/step
Epoch 15/50
722/722 - 15s - loss: 3.0148 - accuracy30: 0.4951 - val_loss: 3.2155 - val_accuracy30: 0.4396 - 15s/epoch - 21ms/step
Epoch 16/50
722/722 - 15s - loss: 3.0128 - accuracy30: 0.4956 - val_loss: 3.2221 - val_accuracy30: 0.4401 - 15s/epoch - 20ms/step
Epoch 17/50
722/722 - 15s - loss: 3.0094 - accuracy30: 0.4961 - val_loss: 3.2290 - val_accuracy30: 0.4387 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 16s - loss: 3.0047 - accuracy30: 0.4973 - val_loss: 3.2177 - val_accuracy30: 0.4379 - 16s/epoch - 22ms/step
Epoch 19/50
722/722 - 15s - loss: 3.0007 - accuracy30: 0.4997 - val_loss: 3.2156 - val_accuracy30: 0.4420 - 15s/epoch - 20ms/step
Epoch 20/50
722/722 - 15s - loss: 2.9980 - accuracy30: 0.5002 - val_loss: 3.2228 - val_accuracy30: 0.4404 - 15s/epoch - 20ms/step
Epoch 21/50
722/722 - 15s - loss: 2.9945 - accuracy30: 0.5003 - val_loss: 3.2142 - val_accuracy30: 0.4403 - 15s/epoch - 20ms/step
Epoch 22/50
722/722 - 15s - loss: 2.9910 - accuracy30: 0.5016 - val_loss: 3.2303 - val_accuracy30: 0.4405 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepVOL_L2/h30
Evaluating performance on  test set...
2607/2607 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0920936
{'0': {'precision': 0.4905875391729307, 'recall': 0.2727815529839925, 'f1-score': 0.350612127698452, 'support': 246197}, '1': {'precision': 0.35278154681139756, 'recall': 0.6146881287726358, 'f1-score': 0.4482840844476238, 'support': 178920}, '2': {'precision': 0.47163736806482887, 'recall': 0.4258221680876979, 'f1-score': 0.44756033788783217, 'support': 242195}, 'accuracy': 0.41999844150861965, 'macro avg': {'precision': 0.43833548468305233, 'recall': 0.43776394994810874, 'f1-score': 0.41548551667796935, 'support': 667312}, 'weighted avg': {'precision': 0.44676113586405536, 'recall': 0.41999844150861965, 'f1-score': 0.4119864747330906, 'support': 667312}}
[[ 67158 107008  72031]
 [ 25435 109980  43505]
 [ 44300  94763 103132]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.044223
{'0': {'precision': 0.49482124004907696, 'recall': 0.2801977638467007, 'f1-score': 0.35779201353428447, 'support': 61892}, '1': {'precision': 0.44399883167071086, 'recall': 0.6527332782824112, 'f1-score': 0.5285024671382533, 'support': 60550}, '2': {'precision': 0.4702641173268225, 'recall': 0.458016003084932, 'f1-score': 0.4640592568475031, 'support': 62238}, 'accuracy': 0.462264457439896, 'macro avg': {'precision': 0.46969472968220344, 'recall': 0.463649015071348, 'f1-score': 0.4501179125066803, 'support': 184680}, 'weighted avg': {'precision': 0.46988251884863436, 'recall': 0.462264457439896, 'f1-score': 0.4495744407329439, 'support': 184680}}
[[17342 26410 18140]
 [ 7056 39523 13971]
 [10649 23083 28506]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0666595
{'0': {'precision': 0.5196821627545894, 'recall': 0.2690688986617487, 'f1-score': 0.35456131605184443, 'support': 21147}, '1': {'precision': 0.3815404100372041, 'recall': 0.6002490660024906, 'f1-score': 0.46653438513284606, 'support': 16060}, '2': {'precision': 0.46909971223678804, 'recall': 0.49136404956700636, 'f1-score': 0.47997382810674394, 'support': 20901}, 'accuracy': 0.4405589591794589, 'macro avg': {'precision': 0.45677409500952715, 'recall': 0.45356067141041523, 'f1-score': 0.43368984309714476, 'support': 58108}, 'weighted avg': {'precision': 0.46330816353049337, 'recall': 0.4405589591794589, 'f1-score': 0.4306185612487251, 'support': 58108}}
[[ 5690  8245  7212]
 [ 2009  9640  4411]
 [ 3250  7381 10270]]
training model: results/PCAR/W1/deepVOL_L2/h50
Epoch 1/50
722/722 - 18s - loss: 3.2939 - accuracy50: 0.3791 - val_loss: 3.3279 - val_accuracy50: 0.3467 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2281 - accuracy50: 0.4056 - val_loss: 3.3651 - val_accuracy50: 0.3370 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 15s - loss: 3.2035 - accuracy50: 0.4180 - val_loss: 3.3322 - val_accuracy50: 0.3555 - 15s/epoch - 20ms/step
Epoch 4/50
722/722 - 15s - loss: 3.1940 - accuracy50: 0.4228 - val_loss: 3.3037 - val_accuracy50: 0.3644 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 16s - loss: 3.1859 - accuracy50: 0.4281 - val_loss: 3.3080 - val_accuracy50: 0.3665 - 16s/epoch - 22ms/step
Epoch 6/50
722/722 - 15s - loss: 3.1789 - accuracy50: 0.4312 - val_loss: 3.2961 - val_accuracy50: 0.3759 - 15s/epoch - 20ms/step
Epoch 7/50
722/722 - 15s - loss: 3.1748 - accuracy50: 0.4343 - val_loss: 3.2839 - val_accuracy50: 0.3805 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 15s - loss: 3.1695 - accuracy50: 0.4359 - val_loss: 3.2950 - val_accuracy50: 0.3748 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 16s - loss: 3.1673 - accuracy50: 0.4365 - val_loss: 3.2816 - val_accuracy50: 0.3878 - 16s/epoch - 22ms/step
Epoch 10/50
722/722 - 15s - loss: 3.1626 - accuracy50: 0.4392 - val_loss: 3.2756 - val_accuracy50: 0.3886 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 3.1591 - accuracy50: 0.4416 - val_loss: 3.2774 - val_accuracy50: 0.3883 - 15s/epoch - 20ms/step
Epoch 12/50
722/722 - 15s - loss: 3.1547 - accuracy50: 0.4425 - val_loss: 3.2761 - val_accuracy50: 0.3907 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 3.1519 - accuracy50: 0.4427 - val_loss: 3.2814 - val_accuracy50: 0.3890 - 15s/epoch - 20ms/step
Epoch 14/50
722/722 - 15s - loss: 3.1483 - accuracy50: 0.4456 - val_loss: 3.2805 - val_accuracy50: 0.3864 - 15s/epoch - 20ms/step
Epoch 15/50
722/722 - 15s - loss: 3.1438 - accuracy50: 0.4474 - val_loss: 3.2882 - val_accuracy50: 0.3892 - 15s/epoch - 20ms/step
Epoch 16/50
722/722 - 15s - loss: 3.1406 - accuracy50: 0.4485 - val_loss: 3.2909 - val_accuracy50: 0.3899 - 15s/epoch - 21ms/step
Epoch 17/50
722/722 - 15s - loss: 3.1357 - accuracy50: 0.4506 - val_loss: 3.2992 - val_accuracy50: 0.3864 - 15s/epoch - 21ms/step
Epoch 18/50
722/722 - 15s - loss: 3.1323 - accuracy50: 0.4527 - val_loss: 3.2984 - val_accuracy50: 0.3858 - 15s/epoch - 20ms/step
Epoch 19/50
722/722 - 16s - loss: 3.1290 - accuracy50: 0.4538 - val_loss: 3.2994 - val_accuracy50: 0.3869 - 16s/epoch - 22ms/step
Epoch 20/50
722/722 - 16s - loss: 3.1264 - accuracy50: 0.4538 - val_loss: 3.3087 - val_accuracy50: 0.3876 - 16s/epoch - 22ms/step
testing model: results/PCAR/W1/deepVOL_L2/h50
Evaluating performance on  test set...
2607/2607 - 23s - 23s/epoch - 9ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1077098
{'0': {'precision': 0.41455348004094167, 'recall': 0.27732462597144714, 'f1-score': 0.3323298939465425, 'support': 233672}, '1': {'precision': 0.3292295021083401, 'recall': 0.6405804510686828, 'f1-score': 0.43492641475743316, 'support': 203428}, '2': {'precision': 0.44235694503529166, 'recall': 0.2213264295518913, 'f1-score': 0.29503611806771957, 'support': 230212}, 'accuracy': 0.36874355623756205, 'macro avg': {'precision': 0.3953799757281911, 'recall': 0.37974383553067376, 'f1-score': 0.35409747559056504, 'support': 667312}, 'weighted avg': {'precision': 0.398134481282349, 'recall': 0.36874355623756205, 'f1-score': 0.3507403680619522, 'support': 667312}}
[[ 64803 137105  31764]
 [ 40649 130312  32467]
 [ 50868 128392  50952]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0821971
{'0': {'precision': 0.42578199052132704, 'recall': 0.2911636499165465, 'f1-score': 0.3458344159906073, 'support': 61711}, '1': {'precision': 0.37212230381119554, 'recall': 0.6682675644897758, 'f1-score': 0.4780463040578033, 'support': 60591}, '2': {'precision': 0.46669042739612104, 'recall': 0.25189970823046587, 'f1-score': 0.32719397794829613, 'support': 62378}, 'accuracy': 0.40162443144899285, 'macro avg': {'precision': 0.4215315739095478, 'recall': 0.4037769742122627, 'f1-score': 0.38369156599890225, 'support': 184680}, 'weighted avg': {'precision': 0.4219943166959118, 'recall': 0.40162443144899285, 'f1-score': 0.3829152978710285, 'support': 184680}}
[[17968 35449  8294]
 [10438 40491  9662]
 [13794 32871 15713]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0935332
{'0': {'precision': 0.44027989469308576, 'recall': 0.3117794240298288, 'f1-score': 0.36505155527472216, 'support': 20383}, '1': {'precision': 0.3372631578947368, 'recall': 0.5951986281794799, 'f1-score': 0.4305561298325408, 'support': 17495}, '2': {'precision': 0.4530041409485116, 'recall': 0.2866040533860603, 'f1-score': 0.35108540979139546, 'support': 20230}, 'accuracy': 0.38834583878295587, 'macro avg': {'precision': 0.4101823978454447, 'recall': 0.397860701865123, 'f1-score': 0.38223103163288613, 'support': 58108}, 'weighted avg': {'precision': 0.41369377387426814, 'recall': 0.38834583878295587, 'f1-score': 0.3799112546063346, 'support': 58108}}
[[ 6355 10625  3403]
 [ 3484 10413  3598]
 [ 4595  9837  5798]]
training model: results/PCAR/W1/deepVOL_L2/h100
Epoch 1/50
722/722 - 18s - loss: 3.3138 - accuracy100: 0.3638 - val_loss: 3.3301 - val_accuracy100: 0.3427 - 18s/epoch - 24ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2722 - accuracy100: 0.3789 - val_loss: 3.3096 - val_accuracy100: 0.3526 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2538 - accuracy100: 0.3905 - val_loss: 3.2907 - val_accuracy100: 0.3651 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 15s - loss: 3.2432 - accuracy100: 0.3975 - val_loss: 3.2838 - val_accuracy100: 0.3706 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 3.2348 - accuracy100: 0.4016 - val_loss: 3.2813 - val_accuracy100: 0.3708 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 15s - loss: 3.2297 - accuracy100: 0.4035 - val_loss: 3.2877 - val_accuracy100: 0.3697 - 15s/epoch - 20ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2239 - accuracy100: 0.4069 - val_loss: 3.2811 - val_accuracy100: 0.3708 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 15s - loss: 3.2182 - accuracy100: 0.4106 - val_loss: 3.2810 - val_accuracy100: 0.3750 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2148 - accuracy100: 0.4110 - val_loss: 3.2867 - val_accuracy100: 0.3742 - 15s/epoch - 21ms/step
Epoch 10/50
722/722 - 15s - loss: 3.2099 - accuracy100: 0.4146 - val_loss: 3.2835 - val_accuracy100: 0.3750 - 15s/epoch - 20ms/step
Epoch 11/50
722/722 - 17s - loss: 3.2066 - accuracy100: 0.4161 - val_loss: 3.2868 - val_accuracy100: 0.3747 - 17s/epoch - 23ms/step
Epoch 12/50
722/722 - 15s - loss: 3.2042 - accuracy100: 0.4195 - val_loss: 3.2893 - val_accuracy100: 0.3774 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 3.1997 - accuracy100: 0.4209 - val_loss: 3.2899 - val_accuracy100: 0.3770 - 15s/epoch - 20ms/step
Epoch 14/50
722/722 - 15s - loss: 3.1956 - accuracy100: 0.4216 - val_loss: 3.2898 - val_accuracy100: 0.3785 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 3.1918 - accuracy100: 0.4232 - val_loss: 3.2930 - val_accuracy100: 0.3760 - 15s/epoch - 20ms/step
Epoch 16/50
722/722 - 15s - loss: 3.1885 - accuracy100: 0.4258 - val_loss: 3.2913 - val_accuracy100: 0.3799 - 15s/epoch - 20ms/step
Epoch 17/50
722/722 - 15s - loss: 3.1844 - accuracy100: 0.4270 - val_loss: 3.2932 - val_accuracy100: 0.3761 - 15s/epoch - 20ms/step
Epoch 18/50
722/722 - 15s - loss: 3.1800 - accuracy100: 0.4290 - val_loss: 3.3003 - val_accuracy100: 0.3751 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepVOL_L2/h100
Evaluating performance on  test set...
2607/2607 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0988688
{'0': {'precision': 0.38267913639050166, 'recall': 0.23918693392208334, 'f1-score': 0.2943780137841763, 'support': 230092}, '1': {'precision': 0.34154526656718215, 'recall': 0.488441975414974, 'f1-score': 0.4019942386037179, 'support': 208989}, '2': {'precision': 0.3844352537362603, 'recall': 0.3783578917850774, 'f1-score': 0.3813723628365875, 'support': 228231}, 'accuracy': 0.3648473277867025, 'macro avg': {'precision': 0.3695532188979814, 'recall': 0.3686622670407116, 'f1-score': 0.3592482050748272, 'support': 667312}, 'weighted avg': {'precision': 0.3703974362224156, 'recall': 0.3648473277867025, 'f1-score': 0.3578347094338754, 'support': 667312}}
[[ 55035 101953  73104]
 [ 41744 102079  65166]
 [ 47036  94842  86353]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0843714
{'0': {'precision': 0.41580642497316045, 'recall': 0.24523094407013557, 'f1-score': 0.30851085557893015, 'support': 61595}, '1': {'precision': 0.37498636214859804, 'recall': 0.5078726583151362, 'f1-score': 0.4314286112777026, 'support': 60907}, '2': {'precision': 0.3962831374692539, 'recall': 0.41976261700279843, 'f1-score': 0.40768509840674794, 'support': 62178}, 'accuracy': 0.3906107862248213, 'macro avg': {'precision': 0.39569197486367075, 'recall': 0.39095540646269006, 'f1-score': 0.38254152175446027, 'support': 184680}, 'weighted avg': {'precision': 0.39577097697189606, 'recall': 0.3906107862248213, 'f1-score': 0.3824387731492853, 'support': 184680}}
[[15105 26537 19953]
 [10165 30933 19809]
 [11057 25021 26100]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0945958
{'0': {'precision': 0.3977731958762887, 'recall': 0.24042871385842474, 'f1-score': 0.2997048314432189, 'support': 20060}, '1': {'precision': 0.3502133105802048, 'recall': 0.4505735770349635, 'f1-score': 0.3941045152308024, 'support': 18219}, '2': {'precision': 0.3861065519229916, 'recall': 0.43895304856523276, 'f1-score': 0.4108373454167846, 'support': 19829}, 'accuracy': 0.37406209127830936, 'macro avg': {'precision': 0.37803101945982837, 'recall': 0.37665177981954034, 'f1-score': 0.36821556403026867, 'support': 58108}, 'weighted avg': {'precision': 0.37888024769085327, 'recall': 0.37406209127830936, 'f1-score': 0.367225903559069, 'support': 58108}}
[[4823 7975 7262]
 [3433 8209 6577]
 [3869 7256 8704]]
training model: results/PCAR/W1/deepVOL_L2/h200
Epoch 1/50
722/722 - 18s - loss: 3.3226 - accuracy200: 0.3581 - val_loss: 3.3178 - val_accuracy200: 0.3356 - 18s/epoch - 24ms/step
Epoch 2/50
722/722 - 15s - loss: 3.2936 - accuracy200: 0.3624 - val_loss: 3.3167 - val_accuracy200: 0.3371 - 15s/epoch - 21ms/step
Epoch 3/50
722/722 - 15s - loss: 3.2826 - accuracy200: 0.3669 - val_loss: 3.2957 - val_accuracy200: 0.3418 - 15s/epoch - 21ms/step
Epoch 4/50
722/722 - 16s - loss: 3.2755 - accuracy200: 0.3728 - val_loss: 3.2858 - val_accuracy200: 0.3553 - 16s/epoch - 22ms/step
Epoch 5/50
722/722 - 15s - loss: 3.2707 - accuracy200: 0.3784 - val_loss: 3.2855 - val_accuracy200: 0.3590 - 15s/epoch - 20ms/step
Epoch 6/50
722/722 - 15s - loss: 3.2659 - accuracy200: 0.3817 - val_loss: 3.2908 - val_accuracy200: 0.3518 - 15s/epoch - 21ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2641 - accuracy200: 0.3821 - val_loss: 3.2948 - val_accuracy200: 0.3490 - 15s/epoch - 20ms/step
Epoch 8/50
722/722 - 15s - loss: 3.2600 - accuracy200: 0.3864 - val_loss: 3.2967 - val_accuracy200: 0.3469 - 15s/epoch - 21ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2567 - accuracy200: 0.3881 - val_loss: 3.3086 - val_accuracy200: 0.3367 - 15s/epoch - 21ms/step
Epoch 10/50
722/722 - 15s - loss: 3.2530 - accuracy200: 0.3916 - val_loss: 3.3123 - val_accuracy200: 0.3408 - 15s/epoch - 20ms/step
Epoch 11/50
722/722 - 15s - loss: 3.2490 - accuracy200: 0.3954 - val_loss: 3.3287 - val_accuracy200: 0.3415 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 15s - loss: 3.2473 - accuracy200: 0.3958 - val_loss: 3.3190 - val_accuracy200: 0.3450 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 3.2431 - accuracy200: 0.3983 - val_loss: 3.3297 - val_accuracy200: 0.3417 - 15s/epoch - 20ms/step
Epoch 14/50
722/722 - 15s - loss: 3.2396 - accuracy200: 0.4018 - val_loss: 3.3253 - val_accuracy200: 0.3430 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 3.2355 - accuracy200: 0.4040 - val_loss: 3.3272 - val_accuracy200: 0.3483 - 15s/epoch - 20ms/step
testing model: results/PCAR/W1/deepVOL_L2/h200
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0964215
{'0': {'precision': 0.3671013880106345, 'recall': 0.4559925012367752, 'f1-score': 0.4067469879518072, 'support': 230438}, '1': {'precision': 0.329525092098966, 'recall': 0.28385912265647845, 'f1-score': 0.30499220973204055, 'support': 208607}, '2': {'precision': 0.36633279868108076, 'recall': 0.32317855844252563, 'f1-score': 0.34340523782480376, 'support': 228267}, 'accuracy': 0.35675066535593547, 'macro avg': {'precision': 0.3543197595968937, 'recall': 0.35434339411192645, 'f1-score': 0.35171481183621717, 'support': 667312}, 'weighted avg': {'precision': 0.35509183034984815, 'recall': 0.35675066535593547, 'f1-score': 0.3532703678755437, 'support': 667312}}
[[105078  59563  65797]
 [ 87583  59215  61809]
 [ 93576  60920  73771]]
Evaluating performance on  train set...
722/722 - 6s - 6s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0942065
{'0': {'precision': 0.35949484263422377, 'recall': 0.4412862801116811, 'f1-score': 0.396213490351542, 'support': 61604}, '1': {'precision': 0.3654323775118537, 'recall': 0.31825257672833335, 'f1-score': 0.3402145828771623, 'support': 61027}, '2': {'precision': 0.3653598511947346, 'recall': 0.32922367806088737, 'f1-score': 0.3463517603275659, 'support': 62049}, 'accuracy': 0.36297920727745286, 'macro avg': {'precision': 0.36342902378027064, 'recall': 0.36292084496696725, 'f1-score': 0.3609266111854234, 'support': 184680}, 'weighted avg': {'precision': 0.36342741712603804, 'recall': 0.36297920727745286, 'f1-score': 0.3609562030833123, 'support': 184680}}
[[27185 16498 17921]
 [24042 19422 17563]
 [24393 17228 20428]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954868
{'0': {'precision': 0.3717225880219217, 'recall': 0.459992193598751, 'f1-score': 0.4111733792712444, 'support': 20496}, '1': {'precision': 0.32084991472427515, 'recall': 0.26254579287084956, 'f1-score': 0.2887844190732035, 'support': 17197}, '2': {'precision': 0.37915707170781343, 'recall': 0.3468038207200588, 'f1-score': 0.3622595169873107, 'support': 20415}, 'accuracy': 0.3617918358917877, 'macro avg': {'precision': 0.3572431914846701, 'recall': 0.3564472690632197, 'f1-score': 0.35407243844391956, 'support': 58108}, 'weighted avg': {'precision': 0.35927882161708674, 'recall': 0.3617918358917877, 'f1-score': 0.3577676615206383, 'support': 58108}}
[[9428 4718 6350]
 [7439 4515 5243]
 [8496 4839 7080]]
training model: results/PCAR/W1/deepVOL_L2/h300
Epoch 1/50
722/722 - 18s - loss: 3.3056 - accuracy300: 0.3743 - val_loss: 3.3057 - val_accuracy300: 0.3519 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 16s - loss: 3.2711 - accuracy300: 0.3783 - val_loss: 3.2880 - val_accuracy300: 0.3560 - 16s/epoch - 22ms/step
Epoch 3/50
722/722 - 16s - loss: 3.2613 - accuracy300: 0.3861 - val_loss: 3.2849 - val_accuracy300: 0.3527 - 16s/epoch - 22ms/step
Epoch 4/50
722/722 - 15s - loss: 3.2607 - accuracy300: 0.3855 - val_loss: 3.2837 - val_accuracy300: 0.3544 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 3.2583 - accuracy300: 0.3873 - val_loss: 3.2818 - val_accuracy300: 0.3592 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 16s - loss: 3.2552 - accuracy300: 0.3895 - val_loss: 3.2836 - val_accuracy300: 0.3559 - 16s/epoch - 22ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2522 - accuracy300: 0.3918 - val_loss: 3.2866 - val_accuracy300: 0.3534 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 16s - loss: 3.2464 - accuracy300: 0.3956 - val_loss: 3.2909 - val_accuracy300: 0.3570 - 16s/epoch - 22ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2434 - accuracy300: 0.3954 - val_loss: 3.2867 - val_accuracy300: 0.3604 - 15s/epoch - 20ms/step
Epoch 10/50
722/722 - 15s - loss: 3.2417 - accuracy300: 0.3973 - val_loss: 3.2941 - val_accuracy300: 0.3619 - 15s/epoch - 21ms/step
Epoch 11/50
722/722 - 15s - loss: 3.2366 - accuracy300: 0.3990 - val_loss: 3.2922 - val_accuracy300: 0.3619 - 15s/epoch - 21ms/step
Epoch 12/50
722/722 - 15s - loss: 3.2318 - accuracy300: 0.4032 - val_loss: 3.2915 - val_accuracy300: 0.3631 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 16s - loss: 3.2249 - accuracy300: 0.4067 - val_loss: 3.3008 - val_accuracy300: 0.3596 - 16s/epoch - 22ms/step
Epoch 14/50
722/722 - 15s - loss: 3.2212 - accuracy300: 0.4094 - val_loss: 3.2978 - val_accuracy300: 0.3574 - 15s/epoch - 21ms/step
Epoch 15/50
722/722 - 15s - loss: 3.2189 - accuracy300: 0.4100 - val_loss: 3.2967 - val_accuracy300: 0.3568 - 15s/epoch - 20ms/step
testing model: results/PCAR/W1/deepVOL_L2/h300
Evaluating performance on  test set...
2607/2607 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976493
{'0': {'precision': 0.35050757127146603, 'recall': 0.7137738270584081, 'f1-score': 0.4701447022413103, 'support': 232194}, '1': {'precision': 0.3741967375185368, 'recall': 0.011068060530740552, 'f1-score': 0.021500184611889003, 'support': 205185}, '2': {'precision': 0.34335971295573847, 'recall': 0.28134282595364735, 'f1-score': 0.30927292893750474, 'support': 229933}, 'accuracy': 0.34870495360491044, 'macro avg': {'precision': 0.35602134058191376, 'recall': 0.3353949045142653, 'f1-score': 0.266972605263568, 'support': 667312}, 'weighted avg': {'precision': 0.355328604117114, 'recall': 0.34870495360491044, 'f1-score': 0.2767646119674103, 'support': 667312}}
[[165734   2110  64350]
 [143551   2271  59363]
 [163555   1688  64690]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.098492
{'0': {'precision': 0.33841436050860135, 'recall': 0.7332155763340842, 'f1-score': 0.4630902363760113, 'support': 61709}, '1': {'precision': 0.4146243471273604, 'recall': 0.016905838411637508, 'f1-score': 0.032487053971951584, 'support': 61044}, '2': {'precision': 0.3439401125982141, 'recall': 0.26931709916514607, 'f1-score': 0.3020884276114402, 'support': 61927}, 'accuracy': 0.34089235434264675, 'macro avg': {'precision': 0.36565960674472525, 'recall': 0.3398128379702892, 'f1-score': 0.26588857265313437, 'support': 184680}, 'weighted avg': {'precision': 0.3654576552498238, 'recall': 0.34089235434264675, 'f1-score': 0.26677174125993475, 'support': 184680}}
[[45246   783 15680]
 [43879  1032 16133]
 [44575   674 16678]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0938919
{'0': {'precision': 0.3579552171754191, 'recall': 0.7346889255556635, 'f1-score': 0.4813749026216633, 'support': 20606}, '1': {'precision': 0.2945054945054945, 'recall': 0.008019150209455416, 'f1-score': 0.015613166326827846, 'support': 16710}, '2': {'precision': 0.35592447916666664, 'recall': 0.2629376683339746, 'f1-score': 0.3024452312458508, 'support': 20792}, 'accuracy': 0.3569215942727335, 'macro avg': {'precision': 0.33612839694919344, 'recall': 0.3352152480330311, 'f1-score': 0.26647776673144735, 'support': 58108}, 'weighted avg': {'precision': 0.33898247726882413, 'recall': 0.3569215942727335, 'f1-score': 0.2834127572934367, 'support': 58108}}
[[15139   147  5320]
 [12003   134  4573]
 [15151   174  5467]]
training model: results/PCAR/W1/deepVOL_L2/h500
Epoch 1/50
722/722 - 17s - loss: 3.3202 - accuracy500: 0.3634 - val_loss: 3.3114 - val_accuracy500: 0.3386 - 17s/epoch - 24ms/step
Epoch 2/50
722/722 - 15s - loss: 3.2747 - accuracy500: 0.3777 - val_loss: 3.2929 - val_accuracy500: 0.3481 - 15s/epoch - 21ms/step
Epoch 3/50
722/722 - 15s - loss: 3.2644 - accuracy500: 0.3828 - val_loss: 3.2912 - val_accuracy500: 0.3507 - 15s/epoch - 21ms/step
Epoch 4/50
722/722 - 15s - loss: 3.2580 - accuracy500: 0.3859 - val_loss: 3.2875 - val_accuracy500: 0.3544 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 3.2536 - accuracy500: 0.3894 - val_loss: 3.2892 - val_accuracy500: 0.3534 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 15s - loss: 3.2505 - accuracy500: 0.3911 - val_loss: 3.2907 - val_accuracy500: 0.3516 - 15s/epoch - 20ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2473 - accuracy500: 0.3924 - val_loss: 3.2898 - val_accuracy500: 0.3532 - 15s/epoch - 20ms/step
Epoch 8/50
722/722 - 15s - loss: 3.2446 - accuracy500: 0.3949 - val_loss: 3.2968 - val_accuracy500: 0.3517 - 15s/epoch - 20ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2418 - accuracy500: 0.3976 - val_loss: 3.2996 - val_accuracy500: 0.3517 - 15s/epoch - 20ms/step
Epoch 10/50
722/722 - 15s - loss: 3.2390 - accuracy500: 0.4004 - val_loss: 3.3074 - val_accuracy500: 0.3517 - 15s/epoch - 20ms/step
Epoch 11/50
722/722 - 15s - loss: 3.2365 - accuracy500: 0.4018 - val_loss: 3.3092 - val_accuracy500: 0.3489 - 15s/epoch - 20ms/step
Epoch 12/50
722/722 - 15s - loss: 3.2325 - accuracy500: 0.4040 - val_loss: 3.3088 - val_accuracy500: 0.3481 - 15s/epoch - 20ms/step
Epoch 13/50
722/722 - 15s - loss: 3.2303 - accuracy500: 0.4045 - val_loss: 3.3097 - val_accuracy500: 0.3490 - 15s/epoch - 21ms/step
Epoch 14/50
722/722 - 15s - loss: 3.2263 - accuracy500: 0.4079 - val_loss: 3.3177 - val_accuracy500: 0.3469 - 15s/epoch - 20ms/step
testing model: results/PCAR/W1/deepVOL_L2/h500
Evaluating performance on  test set...
2607/2607 - 20s - 20s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0960333
{'0': {'precision': 0.3543739573084656, 'recall': 0.18053951331348697, 'f1-score': 0.23921065853531764, 'support': 229429}, '1': {'precision': 0.3493967166467529, 'recall': 0.48331223578303756, 'f1-score': 0.4055863883894838, 'support': 209345}, '2': {'precision': 0.36571910521574114, 'recall': 0.4174185474625664, 'f1-score': 0.38986233686090443, 'support': 228538}, 'accuracy': 0.35664876399645146, 'macro avg': {'precision': 0.35649659305698655, 'recall': 0.3604234321863637, 'f1-score': 0.344886461261902, 'support': 667312}, 'weighted avg': {'precision': 0.35669796312000007, 'recall': 0.35664876399645146, 'f1-score': 0.3429995315474819, 'support': 667312}}
[[ 41421  95527  92481]
 [ 35198 101179  72968]
 [ 40266  92876  95396]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0909072
{'0': {'precision': 0.3672439736818812, 'recall': 0.1993050662909114, 'f1-score': 0.25838393274170945, 'support': 62452}, '1': {'precision': 0.38362865773930294, 'recall': 0.5626105499809896, 'f1-score': 0.4561923208385553, 'support': 60493}, '2': {'precision': 0.3705756311320907, 'recall': 0.3725925325990119, 'f1-score': 0.3715813450075118, 'support': 61735}, 'accuracy': 0.37623456790123455, 'macro avg': {'precision': 0.3738160875177583, 'recall': 0.37816938295697095, 'f1-score': 0.36205253286259215, 'support': 184680}, 'weighted avg': {'precision': 0.3737245810317529, 'recall': 0.37623456790123455, 'f1-score': 0.3610169469683274, 'support': 184680}}
[[12447 27513 22492]
 [ 9882 34034 16577]
 [11564 27169 23002]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0964038
{'0': {'precision': 0.3499819298879653, 'recall': 0.2453011804042758, 'f1-score': 0.28843748138440456, 'support': 19739}, '1': {'precision': 0.3534661498242135, 'recall': 0.42995778277317837, 'f1-score': 0.3879777365491651, 'support': 18239}, '2': {'precision': 0.350930411554308, 'recall': 0.38504719324391457, 'f1-score': 0.3671980481796433, 'support': 20130}, 'accuracy': 0.3516727472981345, 'macro avg': {'precision': 0.3514594970888289, 'recall': 0.35343538547378955, 'f1-score': 0.3478710887044043, 'support': 58108}, 'weighted avg': {'precision': 0.35140413721502367, 'recall': 0.3516727472981345, 'f1-score': 0.34696582384221114, 'support': 58108}}
[[4842 6727 8170]
 [4231 7842 6166]
 [4762 7617 7751]]
training model: results/PCAR/W1/deepVOL_L2/h1000
Epoch 1/50
722/722 - 18s - loss: 3.3340 - accuracy1000: 0.3566 - val_loss: 3.3034 - val_accuracy1000: 0.3405 - 18s/epoch - 25ms/step
Epoch 2/50
722/722 - 15s - loss: 3.2933 - accuracy1000: 0.3607 - val_loss: 3.3008 - val_accuracy1000: 0.3395 - 15s/epoch - 21ms/step
Epoch 3/50
722/722 - 15s - loss: 3.2818 - accuracy1000: 0.3699 - val_loss: 3.2973 - val_accuracy1000: 0.3391 - 15s/epoch - 21ms/step
Epoch 4/50
722/722 - 15s - loss: 3.2777 - accuracy1000: 0.3704 - val_loss: 3.2976 - val_accuracy1000: 0.3394 - 15s/epoch - 21ms/step
Epoch 5/50
722/722 - 15s - loss: 3.2724 - accuracy1000: 0.3749 - val_loss: 3.2987 - val_accuracy1000: 0.3376 - 15s/epoch - 21ms/step
Epoch 6/50
722/722 - 15s - loss: 3.2716 - accuracy1000: 0.3779 - val_loss: 3.3035 - val_accuracy1000: 0.3336 - 15s/epoch - 20ms/step
Epoch 7/50
722/722 - 15s - loss: 3.2710 - accuracy1000: 0.3762 - val_loss: 3.3016 - val_accuracy1000: 0.3356 - 15s/epoch - 21ms/step
Epoch 8/50
722/722 - 15s - loss: 3.2668 - accuracy1000: 0.3797 - val_loss: 3.3013 - val_accuracy1000: 0.3364 - 15s/epoch - 21ms/step
Epoch 9/50
722/722 - 15s - loss: 3.2633 - accuracy1000: 0.3811 - val_loss: 3.3095 - val_accuracy1000: 0.3279 - 15s/epoch - 21ms/step
Epoch 10/50
722/722 - 15s - loss: 3.2607 - accuracy1000: 0.3826 - val_loss: 3.3125 - val_accuracy1000: 0.3250 - 15s/epoch - 20ms/step
Epoch 11/50
722/722 - 15s - loss: 3.2576 - accuracy1000: 0.3858 - val_loss: 3.3102 - val_accuracy1000: 0.3266 - 15s/epoch - 20ms/step
Epoch 12/50
722/722 - 15s - loss: 3.2533 - accuracy1000: 0.3889 - val_loss: 3.3125 - val_accuracy1000: 0.3281 - 15s/epoch - 21ms/step
Epoch 13/50
722/722 - 15s - loss: 3.2505 - accuracy1000: 0.3895 - val_loss: 3.3135 - val_accuracy1000: 0.3306 - 15s/epoch - 21ms/step
testing model: results/PCAR/W1/deepVOL_L2/h1000
Evaluating performance on  test set...
2607/2607 - 21s - 21s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0988977
{'0': {'precision': 0.34718888492536143, 'recall': 0.24399197797341854, 'f1-score': 0.28658337263474143, 'support': 235352}, '1': {'precision': 0.31399028698101494, 'recall': 0.5244188376753507, 'f1-score': 0.3927973026472559, 'support': 199600}, '2': {'precision': 0.3728196122172912, 'recall': 0.2704338096057841, 'f1-score': 0.3134784040228681, 'support': 232360}, 'accuracy': 0.337077708777903, 'macro avg': {'precision': 0.3446662613745559, 'recall': 0.34628154175151776, 'f1-score': 0.3309530264349551, 'support': 667312}, 'weighted avg': {'precision': 0.34618353157319814, 'recall': 0.337077708777903, 'f1-score': 0.32771799920198885, 'support': 667312}}
[[ 57424 116562  61366]
 [ 50582 104674  44344]
 [ 57391 112131  62838]]
Evaluating performance on  train set...
722/722 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964662
{'0': {'precision': 0.34035884624119916, 'recall': 0.2381641053350921, 'f1-score': 0.28023524351818085, 'support': 62923}, '1': {'precision': 0.35183170856849666, 'recall': 0.5713000299930017, 'f1-score': 0.4354773154498806, 'support': 60014}, '2': {'precision': 0.37127314814814816, 'recall': 0.2597703383379492, 'f1-score': 0.30567069742622177, 'support': 61743}, 'accuracy': 0.35364414121724064, 'macro avg': {'precision': 0.354487900985948, 'recall': 0.3564114912220144, 'f1-score': 0.3404610854647611, 'support': 184680}, 'weighted avg': {'precision': 0.354422492019579, 'recall': 0.35364414121724064, 'f1-score': 0.33918672140183476, 'support': 184680}}
[[14986 31891 16046]
 [14613 34286 11115]
 [14431 31273 16039]]
Evaluating performance on  val set...
227/227 - 2s - 2s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0997205
{'0': {'precision': 0.33168712324787564, 'recall': 0.23309345174296942, 'f1-score': 0.27378454529104973, 'support': 19593}, '1': {'precision': 0.33934664369446976, 'recall': 0.5364772484511856, 'f1-score': 0.4157268494568029, 'support': 18724}, '2': {'precision': 0.3413624643777989, 'recall': 0.25420645748067305, 'f1-score': 0.2914072229140723, 'support': 19791}, 'accuracy': 0.33804295449852, 'macro avg': {'precision': 0.3374654104400481, 'recall': 0.341259052558276, 'f1-score': 0.32697287255397495, 'support': 58108}, 'weighted avg': {'precision': 0.3374505557725596, 'recall': 0.33804295449852, 'f1-score': 0.3255243765713692, 'support': 58108}}
[[ 4567  9448  5578]
 [ 4550 10045  4129]
 [ 4652 10108  5031]]
training model: results/PCAR/W1/deepVOL_L3/h10
Epoch 1/50
722/722 - 27s - loss: 3.2525 - accuracy10: 0.4102 - val_loss: 3.3125 - val_accuracy10: 0.4279 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 24s - loss: 3.1065 - accuracy10: 0.4632 - val_loss: 3.1831 - val_accuracy10: 0.4519 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 24s - loss: 2.9701 - accuracy10: 0.5035 - val_loss: 3.1304 - val_accuracy10: 0.4777 - 24s/epoch - 33ms/step
Epoch 4/50
722/722 - 24s - loss: 2.9075 - accuracy10: 0.5231 - val_loss: 3.0494 - val_accuracy10: 0.4958 - 24s/epoch - 33ms/step
Epoch 5/50
722/722 - 24s - loss: 2.8750 - accuracy10: 0.5324 - val_loss: 3.0316 - val_accuracy10: 0.5014 - 24s/epoch - 33ms/step
Epoch 6/50
722/722 - 23s - loss: 2.8559 - accuracy10: 0.5377 - val_loss: 3.0257 - val_accuracy10: 0.5020 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 23s - loss: 2.8410 - accuracy10: 0.5409 - val_loss: 3.0193 - val_accuracy10: 0.5079 - 23s/epoch - 32ms/step
Epoch 8/50
722/722 - 23s - loss: 2.8303 - accuracy10: 0.5430 - val_loss: 3.0360 - val_accuracy10: 0.4983 - 23s/epoch - 32ms/step
Epoch 9/50
722/722 - 23s - loss: 2.8228 - accuracy10: 0.5451 - val_loss: 3.0380 - val_accuracy10: 0.4957 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 2.8126 - accuracy10: 0.5480 - val_loss: 3.0148 - val_accuracy10: 0.5044 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 23s - loss: 2.8051 - accuracy10: 0.5490 - val_loss: 3.0188 - val_accuracy10: 0.5029 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 23s - loss: 2.7983 - accuracy10: 0.5517 - val_loss: 3.0081 - val_accuracy10: 0.5038 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 25s - loss: 2.7913 - accuracy10: 0.5537 - val_loss: 3.0125 - val_accuracy10: 0.5064 - 25s/epoch - 35ms/step
Epoch 14/50
722/722 - 23s - loss: 2.7869 - accuracy10: 0.5545 - val_loss: 3.0267 - val_accuracy10: 0.5029 - 23s/epoch - 32ms/step
Epoch 15/50
722/722 - 23s - loss: 2.7815 - accuracy10: 0.5552 - val_loss: 3.0128 - val_accuracy10: 0.5056 - 23s/epoch - 32ms/step
Epoch 16/50
722/722 - 23s - loss: 2.7761 - accuracy10: 0.5573 - val_loss: 3.0037 - val_accuracy10: 0.5079 - 23s/epoch - 32ms/step
Epoch 17/50
722/722 - 23s - loss: 2.7724 - accuracy10: 0.5579 - val_loss: 2.9989 - val_accuracy10: 0.5079 - 23s/epoch - 32ms/step
Epoch 18/50
722/722 - 23s - loss: 2.7669 - accuracy10: 0.5590 - val_loss: 2.9821 - val_accuracy10: 0.5152 - 23s/epoch - 32ms/step
Epoch 19/50
722/722 - 23s - loss: 2.7631 - accuracy10: 0.5598 - val_loss: 2.9751 - val_accuracy10: 0.5163 - 23s/epoch - 32ms/step
Epoch 20/50
722/722 - 23s - loss: 2.7576 - accuracy10: 0.5601 - val_loss: 2.9950 - val_accuracy10: 0.5114 - 23s/epoch - 32ms/step
Epoch 21/50
722/722 - 23s - loss: 2.7539 - accuracy10: 0.5610 - val_loss: 2.9917 - val_accuracy10: 0.5103 - 23s/epoch - 32ms/step
Epoch 22/50
722/722 - 24s - loss: 2.7502 - accuracy10: 0.5619 - val_loss: 2.9974 - val_accuracy10: 0.5134 - 24s/epoch - 33ms/step
Epoch 23/50
722/722 - 23s - loss: 2.7469 - accuracy10: 0.5635 - val_loss: 2.9934 - val_accuracy10: 0.5150 - 23s/epoch - 32ms/step
Epoch 24/50
722/722 - 23s - loss: 2.7425 - accuracy10: 0.5645 - val_loss: 2.9770 - val_accuracy10: 0.5182 - 23s/epoch - 32ms/step
Epoch 25/50
722/722 - 23s - loss: 2.7402 - accuracy10: 0.5646 - val_loss: 2.9878 - val_accuracy10: 0.5172 - 23s/epoch - 32ms/step
Epoch 26/50
722/722 - 23s - loss: 2.7355 - accuracy10: 0.5658 - val_loss: 3.0128 - val_accuracy10: 0.5138 - 23s/epoch - 33ms/step
Epoch 27/50
722/722 - 23s - loss: 2.7313 - accuracy10: 0.5663 - val_loss: 2.9881 - val_accuracy10: 0.5161 - 23s/epoch - 32ms/step
Epoch 28/50
722/722 - 23s - loss: 2.7285 - accuracy10: 0.5668 - val_loss: 3.0011 - val_accuracy10: 0.5163 - 23s/epoch - 32ms/step
Epoch 29/50
722/722 - 24s - loss: 2.7241 - accuracy10: 0.5676 - val_loss: 3.0242 - val_accuracy10: 0.5078 - 24s/epoch - 33ms/step
testing model: results/PCAR/W1/deepVOL_L3/h10
Evaluating performance on  test set...
2607/2607 - 36s - 36s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.99172574
{'0': {'precision': 0.5017493932284748, 'recall': 0.4840653373300317, 'f1-score': 0.4927487523962615, 'support': 230190}, '1': {'precision': 0.6032473798036933, 'recall': 0.41978115608488886, 'f1-score': 0.495063184682766, 'support': 215953}, '2': {'precision': 0.4763493355031191, 'recall': 0.6352789043672485, 'f1-score': 0.5444530340283146, 'support': 221169}, 'accuracy': 0.51337904908049, 'macro avg': {'precision': 0.5271153695117623, 'recall': 0.5130417992607231, 'f1-score': 0.5107549903691141, 'support': 667312}, 'weighted avg': {'precision': 0.5261773809281101, 'recall': 0.51337904908049, 'f1-score': 0.51063422854512, 'support': 667312}}
[[111427  30937  87826]
 [ 58670  90653  66630]
 [ 51980  28685 140504]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9544381
{'0': {'precision': 0.503166450069105, 'recall': 0.44571950662402926, 'f1-score': 0.4727040173640046, 'support': 54725}, '1': {'precision': 0.6735326052245002, 'recall': 0.5579408224541355, 'f1-score': 0.6103117245769762, 'support': 75603}, '2': {'precision': 0.46469588854909955, 'recall': 0.6290476891374742, 'f1-score': 0.5345235954880517, 'support': 54352}, 'accuracy': 0.5456140350877193, 'macro avg': {'precision': 0.5471316479475682, 'recall': 0.5442360060718796, 'f1-score': 0.5391797791430109, 'support': 184680}, 'weighted avg': {'precision': 0.5615877218282452, 'recall': 0.5456140350877193, 'f1-score': 0.5472306212118523, 'support': 184680}}
[[24392 10838 19495]
 [13531 42182 19890]
 [10554  9608 34190]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9924322
{'0': {'precision': 0.5094442097640456, 'recall': 0.4495686441580573, 'f1-score': 0.4776372740388696, 'support': 18778}, '1': {'precision': 0.6184796854521625, 'recall': 0.4582888219869865, 'f1-score': 0.5264684554024656, 'support': 20594}, '2': {'precision': 0.45990790425086575, 'recall': 0.6450149444918872, 'f1-score': 0.5369559904916357, 'support': 18736}, 'accuracy': 0.5156777035864253, 'macro avg': {'precision': 0.5292772664890246, 'recall': 0.517624136878977, 'f1-score': 0.513687239977657, 'support': 58108}, 'weighted avg': {'precision': 0.5321151735939165, 'recall': 0.5156777035864253, 'f1-score': 0.5140698619865002, 'support': 58108}}
[[ 8442  2861  7475]
 [ 4439  9438  6717]
 [ 3690  2961 12085]]
training model: results/PCAR/W1/deepVOL_L3/h20
Epoch 1/50
722/722 - 27s - loss: 3.2584 - accuracy20: 0.3960 - val_loss: 3.2427 - val_accuracy20: 0.3971 - 27s/epoch - 38ms/step
Epoch 2/50
722/722 - 26s - loss: 3.1350 - accuracy20: 0.4412 - val_loss: 3.1851 - val_accuracy20: 0.4219 - 26s/epoch - 36ms/step
Epoch 3/50
722/722 - 26s - loss: 3.0425 - accuracy20: 0.4782 - val_loss: 3.1223 - val_accuracy20: 0.4450 - 26s/epoch - 36ms/step
Epoch 4/50
722/722 - 23s - loss: 2.9920 - accuracy20: 0.4969 - val_loss: 3.1050 - val_accuracy20: 0.4497 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 23s - loss: 2.9647 - accuracy20: 0.5072 - val_loss: 3.0791 - val_accuracy20: 0.4598 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 2.9498 - accuracy20: 0.5114 - val_loss: 3.0674 - val_accuracy20: 0.4652 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 24s - loss: 2.9377 - accuracy20: 0.5152 - val_loss: 3.0616 - val_accuracy20: 0.4669 - 24s/epoch - 33ms/step
Epoch 8/50
722/722 - 23s - loss: 2.9280 - accuracy20: 0.5184 - val_loss: 3.0740 - val_accuracy20: 0.4620 - 23s/epoch - 32ms/step
Epoch 9/50
722/722 - 23s - loss: 2.9175 - accuracy20: 0.5202 - val_loss: 3.0782 - val_accuracy20: 0.4635 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 2.9108 - accuracy20: 0.5222 - val_loss: 3.0614 - val_accuracy20: 0.4686 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 23s - loss: 2.9064 - accuracy20: 0.5233 - val_loss: 3.0623 - val_accuracy20: 0.4696 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 26s - loss: 2.9021 - accuracy20: 0.5253 - val_loss: 3.0446 - val_accuracy20: 0.4792 - 26s/epoch - 36ms/step
Epoch 13/50
722/722 - 24s - loss: 2.8954 - accuracy20: 0.5261 - val_loss: 3.0701 - val_accuracy20: 0.4716 - 24s/epoch - 33ms/step
Epoch 14/50
722/722 - 24s - loss: 2.8907 - accuracy20: 0.5269 - val_loss: 3.0563 - val_accuracy20: 0.4801 - 24s/epoch - 33ms/step
Epoch 15/50
722/722 - 24s - loss: 2.8852 - accuracy20: 0.5294 - val_loss: 3.0388 - val_accuracy20: 0.4852 - 24s/epoch - 33ms/step
Epoch 16/50
722/722 - 24s - loss: 2.8790 - accuracy20: 0.5308 - val_loss: 3.0556 - val_accuracy20: 0.4810 - 24s/epoch - 33ms/step
Epoch 17/50
722/722 - 23s - loss: 2.8751 - accuracy20: 0.5317 - val_loss: 3.0636 - val_accuracy20: 0.4781 - 23s/epoch - 32ms/step
Epoch 18/50
722/722 - 23s - loss: 2.8713 - accuracy20: 0.5319 - val_loss: 3.0521 - val_accuracy20: 0.4814 - 23s/epoch - 32ms/step
Epoch 19/50
722/722 - 23s - loss: 2.8673 - accuracy20: 0.5344 - val_loss: 3.0648 - val_accuracy20: 0.4816 - 23s/epoch - 32ms/step
Epoch 20/50
722/722 - 25s - loss: 2.8640 - accuracy20: 0.5352 - val_loss: 3.1019 - val_accuracy20: 0.4778 - 25s/epoch - 35ms/step
Epoch 21/50
722/722 - 24s - loss: 2.8600 - accuracy20: 0.5362 - val_loss: 3.0664 - val_accuracy20: 0.4819 - 24s/epoch - 33ms/step
Epoch 22/50
722/722 - 23s - loss: 2.8559 - accuracy20: 0.5379 - val_loss: 3.0484 - val_accuracy20: 0.4849 - 23s/epoch - 32ms/step
Epoch 23/50
722/722 - 25s - loss: 2.8511 - accuracy20: 0.5387 - val_loss: 3.0645 - val_accuracy20: 0.4823 - 25s/epoch - 35ms/step
Epoch 24/50
722/722 - 25s - loss: 2.8499 - accuracy20: 0.5391 - val_loss: 3.0838 - val_accuracy20: 0.4797 - 25s/epoch - 35ms/step
Epoch 25/50
722/722 - 23s - loss: 2.8447 - accuracy20: 0.5391 - val_loss: 3.0791 - val_accuracy20: 0.4819 - 23s/epoch - 32ms/step
testing model: results/PCAR/W1/deepVOL_L3/h20
Evaluating performance on  test set...
2607/2607 - 38s - 38s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0152979
{'0': {'precision': 0.5236937065827333, 'recall': 0.3892709441096538, 'f1-score': 0.44658628005178364, 'support': 253890}, '1': {'precision': 0.42944564958919934, 'recall': 0.5343913426814981, 'f1-score': 0.4762050826707565, 'support': 165594}, '2': {'precision': 0.494815249697281, 'recall': 0.5441354487789919, 'f1-score': 0.5183047056065248, 'support': 247828}, 'accuracy': 0.48279665284005086, 'macro avg': {'precision': 0.48265153528973787, 'recall': 0.48926591185671464, 'f1-score': 0.48036535610968834, 'support': 667312}, 'weighted avg': {'precision': 0.4895810232160395, 'recall': 0.48279665284005086, 'f1-score': 0.4805711776248328, 'support': 667312}}
[[ 98832  60221  94837]
 [ 34261  88492  42841]
 [ 55628  57348 134852]]
Evaluating performance on  train set...
722/722 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.98943
{'0': {'precision': 0.531902396044935, 'recall': 0.3502272214522835, 'f1-score': 0.4223567479327199, 'support': 62054}, '1': {'precision': 0.526060606060606, 'recall': 0.652879719632348, 'f1-score': 0.5826491697832068, 'support': 60492}, '2': {'precision': 0.4902976173159166, 'recall': 0.5424727202497828, 'f1-score': 0.5150672371638142, 'support': 62134}, 'accuracy': 0.5140405024907949, 'macro avg': {'precision': 0.5160868731404858, 'recall': 0.5151932204448048, 'f1-score': 0.5066910516265803, 'support': 184680}, 'weighted avg': {'precision': 0.5159913451391474, 'recall': 0.5140405024907949, 'f1-score': 0.5060522359144422, 'support': 184680}}
[[21733 18206 22115]
 [ 8073 39494 12925]
 [11053 17375 33706]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0144224
{'0': {'precision': 0.5450556101989862, 'recall': 0.3384702123660966, 'f1-score': 0.4176110837367033, 'support': 21284}, '1': {'precision': 0.45340555722740494, 'recall': 0.5763835756184646, 'f1-score': 0.507551513109876, 'support': 15684}, '2': {'precision': 0.4808239490241654, 'recall': 0.5675496688741721, 'f1-score': 0.5205996572147614, 'support': 21140}, 'accuracy': 0.48602602051352656, 'macro avg': {'precision': 0.4930950388168522, 'recall': 0.4941344856195778, 'f1-score': 0.4819207513537802, 'support': 58108}, 'weighted avg': {'precision': 0.4969504138741773, 'recall': 0.48602602051352656, 'f1-score': 0.47935480469793057, 'support': 58108}}
[[ 7204  5411  8669]
 [ 2358  9040  4286]
 [ 3655  5487 11998]]
training model: results/PCAR/W1/deepVOL_L3/h30
Epoch 1/50
722/722 - 27s - loss: 3.2923 - accuracy30: 0.3777 - val_loss: 3.2983 - val_accuracy30: 0.3534 - 27s/epoch - 38ms/step
Epoch 2/50
722/722 - 24s - loss: 3.1961 - accuracy30: 0.4192 - val_loss: 3.2680 - val_accuracy30: 0.3854 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 24s - loss: 3.1279 - accuracy30: 0.4482 - val_loss: 3.2516 - val_accuracy30: 0.4131 - 24s/epoch - 34ms/step
Epoch 4/50
722/722 - 24s - loss: 3.0968 - accuracy30: 0.4639 - val_loss: 3.2262 - val_accuracy30: 0.4188 - 24s/epoch - 33ms/step
Epoch 5/50
722/722 - 24s - loss: 3.0795 - accuracy30: 0.4719 - val_loss: 3.2325 - val_accuracy30: 0.4203 - 24s/epoch - 33ms/step
Epoch 6/50
722/722 - 25s - loss: 3.0649 - accuracy30: 0.4767 - val_loss: 3.2215 - val_accuracy30: 0.4196 - 25s/epoch - 35ms/step
Epoch 7/50
722/722 - 24s - loss: 3.0512 - accuracy30: 0.4827 - val_loss: 3.2119 - val_accuracy30: 0.4249 - 24s/epoch - 33ms/step
Epoch 8/50
722/722 - 24s - loss: 3.0409 - accuracy30: 0.4854 - val_loss: 3.2211 - val_accuracy30: 0.4222 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 25s - loss: 3.0332 - accuracy30: 0.4894 - val_loss: 3.2143 - val_accuracy30: 0.4256 - 25s/epoch - 34ms/step
Epoch 10/50
722/722 - 24s - loss: 3.0266 - accuracy30: 0.4916 - val_loss: 3.2407 - val_accuracy30: 0.4233 - 24s/epoch - 34ms/step
Epoch 11/50
722/722 - 24s - loss: 3.0204 - accuracy30: 0.4917 - val_loss: 3.2296 - val_accuracy30: 0.4301 - 24s/epoch - 34ms/step
Epoch 12/50
722/722 - 25s - loss: 3.0136 - accuracy30: 0.4942 - val_loss: 3.2241 - val_accuracy30: 0.4289 - 25s/epoch - 34ms/step
Epoch 13/50
722/722 - 24s - loss: 3.0096 - accuracy30: 0.4952 - val_loss: 3.2325 - val_accuracy30: 0.4326 - 24s/epoch - 33ms/step
Epoch 14/50
722/722 - 24s - loss: 3.0036 - accuracy30: 0.4968 - val_loss: 3.2275 - val_accuracy30: 0.4309 - 24s/epoch - 33ms/step
Epoch 15/50
722/722 - 24s - loss: 2.9988 - accuracy30: 0.4987 - val_loss: 3.2429 - val_accuracy30: 0.4269 - 24s/epoch - 34ms/step
Epoch 16/50
722/722 - 24s - loss: 2.9954 - accuracy30: 0.5000 - val_loss: 3.2352 - val_accuracy30: 0.4267 - 24s/epoch - 33ms/step
Epoch 17/50
722/722 - 24s - loss: 2.9915 - accuracy30: 0.5004 - val_loss: 3.2653 - val_accuracy30: 0.4209 - 24s/epoch - 33ms/step
testing model: results/PCAR/W1/deepVOL_L3/h30
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0822797
{'0': {'precision': 0.4939039349753064, 'recall': 0.18807296595815545, 'f1-score': 0.2724138539650415, 'support': 246197}, '1': {'precision': 0.36400853654376114, 'recall': 0.5367091437513972, 'f1-score': 0.4338023206174459, 'support': 178920}, '2': {'precision': 0.4423675409031625, 'recall': 0.5657672536592415, 'f1-score': 0.4965150892017589, 'support': 242195}, 'accuracy': 0.41863026590260627, 'macro avg': {'precision': 0.43342667080741, 'recall': 0.4301831211229314, 'f1-score': 0.4009104212614154, 'support': 667312}, 'weighted avg': {'precision': 0.44037164176062576, 'recall': 0.41863026590260627, 'f1-score': 0.3970209689601336, 'support': 667312}}
[[ 46303  91271 108623]
 [ 18785  96028  64107]
 [ 28661  76508 137026]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0475781
{'0': {'precision': 0.49621932550911535, 'recall': 0.172833322561882, 'f1-score': 0.2563721554482379, 'support': 61892}, '1': {'precision': 0.45198121161026134, 'recall': 0.6197853014037985, 'f1-score': 0.5227469006825464, 'support': 60550}, '2': {'precision': 0.44053787472063727, 'recall': 0.5669205308653877, 'f1-score': 0.49580203890930297, 'support': 62238}, 'accuracy': 0.45218215291314706, 'macro avg': {'precision': 0.4629128039466713, 'recall': 0.45317971827702275, 'f1-score': 0.4249736983466958, 'support': 184680}, 'weighted avg': {'precision': 0.462950320036141, 'recall': 0.45218215291314706, 'f1-score': 0.4243959149824979, 'support': 184680}}
[[10697 24768 26427]
 [ 4640 37528 18382]
 [ 6220 20734 35284]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0726662
{'0': {'precision': 0.5308134757600658, 'recall': 0.1527403414195867, 'f1-score': 0.23722091656874267, 'support': 21147}, '1': {'precision': 0.38451110722406856, 'recall': 0.5475093399750934, 'f1-score': 0.4517570900123305, 'support': 16060}, '2': {'precision': 0.4362202023666609, 'recall': 0.6084876321707096, 'f1-score': 0.5081508710244526, 'support': 20901}, 'accuracy': 0.42577614097886696, 'macro avg': {'precision': 0.45051492845026503, 'recall': 0.43624577118846325, 'f1-score': 0.3990429592018419, 'support': 58108}, 'weighted avg': {'precision': 0.45635367597546345, 'recall': 0.42577614097886696, 'f1-score': 0.39396625152404685, 'support': 58108}}
[[ 3230  7562 10355]
 [ 1185  8793  6082]
 [ 1670  6513 12718]]
training model: results/PCAR/W1/deepVOL_L3/h50
Epoch 1/50
722/722 - 26s - loss: 3.3150 - accuracy50: 0.3608 - val_loss: 3.3160 - val_accuracy50: 0.3110 - 26s/epoch - 36ms/step
Epoch 2/50
722/722 - 24s - loss: 3.2926 - accuracy50: 0.3556 - val_loss: 3.3088 - val_accuracy50: 0.3151 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 24s - loss: 3.2720 - accuracy50: 0.3737 - val_loss: 3.2932 - val_accuracy50: 0.3443 - 24s/epoch - 33ms/step
Epoch 4/50
722/722 - 23s - loss: 3.2433 - accuracy50: 0.3939 - val_loss: 3.3320 - val_accuracy50: 0.3243 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 23s - loss: 3.2171 - accuracy50: 0.4096 - val_loss: 3.3761 - val_accuracy50: 0.3200 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 3.1993 - accuracy50: 0.4184 - val_loss: 3.4142 - val_accuracy50: 0.3193 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 23s - loss: 3.1861 - accuracy50: 0.4248 - val_loss: 3.3298 - val_accuracy50: 0.3404 - 23s/epoch - 32ms/step
Epoch 8/50
722/722 - 24s - loss: 3.1769 - accuracy50: 0.4303 - val_loss: 3.3089 - val_accuracy50: 0.3557 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 23s - loss: 3.1716 - accuracy50: 0.4339 - val_loss: 3.2950 - val_accuracy50: 0.3526 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 24s - loss: 3.1636 - accuracy50: 0.4377 - val_loss: 3.2792 - val_accuracy50: 0.3772 - 24s/epoch - 33ms/step
Epoch 11/50
722/722 - 23s - loss: 3.1593 - accuracy50: 0.4393 - val_loss: 3.2789 - val_accuracy50: 0.3777 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 23s - loss: 3.1553 - accuracy50: 0.4413 - val_loss: 3.2693 - val_accuracy50: 0.3798 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 23s - loss: 3.1499 - accuracy50: 0.4429 - val_loss: 3.2869 - val_accuracy50: 0.3652 - 23s/epoch - 32ms/step
Epoch 14/50
722/722 - 23s - loss: 3.1461 - accuracy50: 0.4445 - val_loss: 3.2972 - val_accuracy50: 0.3681 - 23s/epoch - 33ms/step
Epoch 15/50
722/722 - 23s - loss: 3.1411 - accuracy50: 0.4475 - val_loss: 3.2759 - val_accuracy50: 0.3735 - 23s/epoch - 32ms/step
Epoch 16/50
722/722 - 24s - loss: 3.1365 - accuracy50: 0.4500 - val_loss: 3.2842 - val_accuracy50: 0.3680 - 24s/epoch - 33ms/step
Epoch 17/50
722/722 - 23s - loss: 3.1333 - accuracy50: 0.4516 - val_loss: 3.3088 - val_accuracy50: 0.3612 - 23s/epoch - 33ms/step
Epoch 18/50
722/722 - 23s - loss: 3.1302 - accuracy50: 0.4514 - val_loss: 3.2861 - val_accuracy50: 0.3731 - 23s/epoch - 32ms/step
Epoch 19/50
722/722 - 23s - loss: 3.1252 - accuracy50: 0.4550 - val_loss: 3.2979 - val_accuracy50: 0.3711 - 23s/epoch - 32ms/step
Epoch 20/50
722/722 - 24s - loss: 3.1219 - accuracy50: 0.4555 - val_loss: 3.3145 - val_accuracy50: 0.3652 - 24s/epoch - 33ms/step
Epoch 21/50
722/722 - 23s - loss: 3.1185 - accuracy50: 0.4574 - val_loss: 3.2958 - val_accuracy50: 0.3757 - 23s/epoch - 32ms/step
Epoch 22/50
722/722 - 23s - loss: 3.1136 - accuracy50: 0.4581 - val_loss: 3.3358 - val_accuracy50: 0.3603 - 23s/epoch - 32ms/step
testing model: results/PCAR/W1/deepVOL_L3/h50
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0966934
{'0': {'precision': 0.4094125949548278, 'recall': 0.26316803040158854, 'f1-score': 0.3203907521979811, 'support': 233672}, '1': {'precision': 0.32849250835399374, 'recall': 0.5992144640855733, 'f1-score': 0.42435266349641787, 'support': 203428}, '2': {'precision': 0.43629689993083565, 'recall': 0.2767536010286171, 'f1-score': 0.338676539771051, 'support': 230212}, 'accuracy': 0.37029755196969333, 'macro avg': {'precision': 0.3914006677465524, 'recall': 0.379712031838593, 'f1-score': 0.36113998515515, 'support': 667312}, 'weighted avg': {'precision': 0.3940190133020211, 'recall': 0.37029755196969333, 'f1-score': 0.3583915245808994, 'support': 667312}}
[[ 61495 132319  39858]
 [ 39072 121897  42459]
 [ 49636 116864  63712]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0771006
{'0': {'precision': 0.4261876383449685, 'recall': 0.24336017889841358, 'f1-score': 0.3098123755789126, 'support': 61711}, '1': {'precision': 0.368273254533441, 'recall': 0.662309583931607, 'f1-score': 0.4733455611321133, 'support': 60591}, '2': {'precision': 0.4569600237189307, 'recall': 0.29649876559043253, 'f1-score': 0.3596429821491075, 'support': 62378}, 'accuracy': 0.3987600173272688, 'macro avg': {'precision': 0.41714030553244674, 'recall': 0.4007228428068177, 'f1-score': 0.3809336396200445, 'support': 184680}, 'weighted avg': {'precision': 0.41758047690535804, 'recall': 0.3987600173272688, 'f1-score': 0.3802963089907038, 'support': 184680}}
[[15018 36709  9984]
 [ 8466 40130 11995]
 [11754 32129 18495]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0913913
{'0': {'precision': 0.43303935979095215, 'recall': 0.26016778688122455, 'f1-score': 0.3250482699439149, 'support': 20383}, '1': {'precision': 0.3286598864256152, 'recall': 0.5855387253501, 'f1-score': 0.42100937037645897, 'support': 17495}, '2': {'precision': 0.442523650718029, 'recall': 0.32140385565991103, 'f1-score': 0.37236205366091113, 'support': 20230}, 'accuracy': 0.379448612927652, 'macro avg': {'precision': 0.40140763231153215, 'recall': 0.3890367892970785, 'f1-score': 0.37280656466042833, 'support': 58108}, 'weighted avg': {'precision': 0.4049149762108633, 'recall': 0.379448612927652, 'f1-score': 0.37041202874928064, 'support': 58108}}
[[ 5303 11163  3917]
 [ 2977 10244  4274]
 [ 3966  9762  6502]]
training model: results/PCAR/W1/deepVOL_L3/h100
Epoch 1/50
722/722 - 27s - loss: 3.3149 - accuracy100: 0.3609 - val_loss: 3.3206 - val_accuracy100: 0.3276 - 27s/epoch - 38ms/step
Epoch 2/50
722/722 - 24s - loss: 3.2827 - accuracy100: 0.3678 - val_loss: 3.3016 - val_accuracy100: 0.3420 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 23s - loss: 3.2707 - accuracy100: 0.3763 - val_loss: 3.2863 - val_accuracy100: 0.3629 - 23s/epoch - 32ms/step
Epoch 4/50
722/722 - 23s - loss: 3.2605 - accuracy100: 0.3850 - val_loss: 3.2838 - val_accuracy100: 0.3656 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 24s - loss: 3.2508 - accuracy100: 0.3912 - val_loss: 3.2790 - val_accuracy100: 0.3689 - 24s/epoch - 33ms/step
Epoch 6/50
722/722 - 24s - loss: 3.2446 - accuracy100: 0.3961 - val_loss: 3.2767 - val_accuracy100: 0.3723 - 24s/epoch - 34ms/step
Epoch 7/50
722/722 - 24s - loss: 3.2380 - accuracy100: 0.3981 - val_loss: 3.2776 - val_accuracy100: 0.3713 - 24s/epoch - 34ms/step
Epoch 8/50
722/722 - 24s - loss: 3.2321 - accuracy100: 0.4029 - val_loss: 3.2789 - val_accuracy100: 0.3687 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 24s - loss: 3.2277 - accuracy100: 0.4039 - val_loss: 3.2844 - val_accuracy100: 0.3671 - 24s/epoch - 33ms/step
Epoch 10/50
722/722 - 25s - loss: 3.2235 - accuracy100: 0.4068 - val_loss: 3.2844 - val_accuracy100: 0.3673 - 25s/epoch - 34ms/step
Epoch 11/50
722/722 - 24s - loss: 3.2186 - accuracy100: 0.4085 - val_loss: 3.2836 - val_accuracy100: 0.3726 - 24s/epoch - 33ms/step
Epoch 12/50
722/722 - 24s - loss: 3.2145 - accuracy100: 0.4122 - val_loss: 3.2852 - val_accuracy100: 0.3693 - 24s/epoch - 33ms/step
Epoch 13/50
722/722 - 24s - loss: 3.2101 - accuracy100: 0.4143 - val_loss: 3.2987 - val_accuracy100: 0.3655 - 24s/epoch - 34ms/step
Epoch 14/50
722/722 - 24s - loss: 3.2058 - accuracy100: 0.4186 - val_loss: 3.2940 - val_accuracy100: 0.3693 - 24s/epoch - 33ms/step
Epoch 15/50
722/722 - 24s - loss: 3.2013 - accuracy100: 0.4184 - val_loss: 3.2907 - val_accuracy100: 0.3704 - 24s/epoch - 33ms/step
Epoch 16/50
722/722 - 24s - loss: 3.1970 - accuracy100: 0.4220 - val_loss: 3.3070 - val_accuracy100: 0.3691 - 24s/epoch - 34ms/step
testing model: results/PCAR/W1/deepVOL_L3/h100
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.095499
{'0': {'precision': 0.3769695800373014, 'recall': 0.35664429880221826, 'f1-score': 0.3665253764142053, 'support': 230092}, '1': {'precision': 0.357017945061745, 'recall': 0.2539846594796855, 'f1-score': 0.29681405784742704, 'support': 208989}, '2': {'precision': 0.35652433959129426, 'recall': 0.4701201852509081, 'f1-score': 0.40551720488830856, 'support': 228231}, 'accuracy': 0.3633038219004004, 'macro avg': {'precision': 0.3635039548967802, 'recall': 0.3602497145109373, 'f1-score': 0.3562855463833136, 'support': 667312}, 'weighted avg': {'precision': 0.36372853250010856, 'recall': 0.3633038219004004, 'f1-score': 0.35802896880954754, 'support': 667312}}
[[ 82061  48092  99939]
 [ 62194  53080  93715]
 [ 73431  47504 107296]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0897647
{'0': {'precision': 0.3856913551937629, 'recall': 0.30038152447438915, 'f1-score': 0.3377325082598616, 'support': 61595}, '1': {'precision': 0.3894820435895173, 'recall': 0.36235572265913607, 'f1-score': 0.37542952403633517, 'support': 60907}, '2': {'precision': 0.3696591874469042, 'recall': 0.47587571166650583, 'f1-score': 0.41609596264994164, 'support': 62178}, 'accuracy': 0.3799057829759584, 'macro avg': {'precision': 0.3816108620767282, 'recall': 0.3795376529333437, 'f1-score': 0.3764193316487128, 'support': 184680}, 'weighted avg': {'precision': 0.3815438098827169, 'recall': 0.3799057829759584, 'f1-score': 0.3765482706973972, 'support': 184680}}
[[18502 17734 25359]
 [13741 22070 25096]
 [15728 16861 29589]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0925072
{'0': {'precision': 0.3927801040477097, 'recall': 0.3086241276171486, 'f1-score': 0.3456535090168053, 'support': 20060}, '1': {'precision': 0.3613657691474771, 'recall': 0.2747680992370602, 'f1-score': 0.31217261162384635, 'support': 18219}, '2': {'precision': 0.36486154494086265, 'recall': 0.5242826163699632, 'f1-score': 0.4302802036339555, 'support': 19829}, 'accuracy': 0.3716011564672678, 'macro avg': {'precision': 0.3730024727120165, 'recall': 0.3692249477413907, 'f1-score': 0.36270210809153575, 'support': 58108}, 'weighted avg': {'precision': 0.37340351431691515, 'recall': 0.3716011564672678, 'f1-score': 0.36403435602515444, 'support': 58108}}
[[ 6191  4446  9423]
 [ 4539  5006  8674]
 [ 5032  4401 10396]]
training model: results/PCAR/W1/deepVOL_L3/h200
Epoch 1/50
722/722 - 27s - loss: 3.3265 - accuracy200: 0.3521 - val_loss: 3.3236 - val_accuracy200: 0.3083 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 24s - loss: 3.2955 - accuracy200: 0.3570 - val_loss: 3.3168 - val_accuracy200: 0.3096 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 24s - loss: 3.2873 - accuracy200: 0.3656 - val_loss: 3.3098 - val_accuracy200: 0.3181 - 24s/epoch - 33ms/step
Epoch 4/50
722/722 - 23s - loss: 3.2823 - accuracy200: 0.3679 - val_loss: 3.3162 - val_accuracy200: 0.3106 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 23s - loss: 3.2781 - accuracy200: 0.3713 - val_loss: 3.3214 - val_accuracy200: 0.3031 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 3.2754 - accuracy200: 0.3731 - val_loss: 3.3128 - val_accuracy200: 0.3117 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 23s - loss: 3.2738 - accuracy200: 0.3756 - val_loss: 3.3100 - val_accuracy200: 0.3275 - 23s/epoch - 32ms/step
Epoch 8/50
722/722 - 24s - loss: 3.2678 - accuracy200: 0.3789 - val_loss: 3.3144 - val_accuracy200: 0.3259 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 23s - loss: 3.2651 - accuracy200: 0.3834 - val_loss: 3.3072 - val_accuracy200: 0.3482 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 3.2599 - accuracy200: 0.3884 - val_loss: 3.3054 - val_accuracy200: 0.3518 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 23s - loss: 3.2533 - accuracy200: 0.3934 - val_loss: 3.3050 - val_accuracy200: 0.3495 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 23s - loss: 3.2493 - accuracy200: 0.3946 - val_loss: 3.3006 - val_accuracy200: 0.3519 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 23s - loss: 3.2446 - accuracy200: 0.3973 - val_loss: 3.3304 - val_accuracy200: 0.3395 - 23s/epoch - 32ms/step
Epoch 14/50
722/722 - 23s - loss: 3.2390 - accuracy200: 0.4014 - val_loss: 3.3400 - val_accuracy200: 0.3400 - 23s/epoch - 32ms/step
Epoch 15/50
722/722 - 23s - loss: 3.2305 - accuracy200: 0.4070 - val_loss: 3.3281 - val_accuracy200: 0.3491 - 23s/epoch - 32ms/step
Epoch 16/50
722/722 - 23s - loss: 3.2254 - accuracy200: 0.4109 - val_loss: 3.3119 - val_accuracy200: 0.3552 - 23s/epoch - 32ms/step
Epoch 17/50
722/722 - 23s - loss: 3.2204 - accuracy200: 0.4115 - val_loss: 3.3233 - val_accuracy200: 0.3532 - 23s/epoch - 32ms/step
Epoch 18/50
722/722 - 23s - loss: 3.2167 - accuracy200: 0.4138 - val_loss: 3.3296 - val_accuracy200: 0.3519 - 23s/epoch - 32ms/step
Epoch 19/50
722/722 - 23s - loss: 3.2109 - accuracy200: 0.4162 - val_loss: 3.3323 - val_accuracy200: 0.3522 - 23s/epoch - 32ms/step
Epoch 20/50
722/722 - 23s - loss: 3.2063 - accuracy200: 0.4203 - val_loss: 3.3372 - val_accuracy200: 0.3548 - 23s/epoch - 32ms/step
Epoch 21/50
722/722 - 23s - loss: 3.2047 - accuracy200: 0.4209 - val_loss: 3.3480 - val_accuracy200: 0.3570 - 23s/epoch - 32ms/step
Epoch 22/50
722/722 - 23s - loss: 3.1972 - accuracy200: 0.4249 - val_loss: 3.3582 - val_accuracy200: 0.3558 - 23s/epoch - 32ms/step
testing model: results/PCAR/W1/deepVOL_L3/h200
Evaluating performance on  test set...
2607/2607 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021103
{'0': {'precision': 0.35938316085798006, 'recall': 0.17617320060059538, 'f1-score': 0.23644077914741074, 'support': 230438}, '1': {'precision': 0.3275872472163044, 'recall': 0.33833476345472585, 'f1-score': 0.33287427663197017, 'support': 208607}, '2': {'precision': 0.3505331987795738, 'recall': 0.5204212610670838, 'f1-score': 0.41890807789620305, 'support': 228267}, 'accuracy': 0.34462290502793297, 'macro avg': {'precision': 0.3458345356179528, 'recall': 0.34497640837413496, 'f1-score': 0.3294077112251947, 'support': 667312}, 'weighted avg': {'precision': 0.34641620619389396, 'recall': 0.34462290502793297, 'f1-score': 0.3290031270345341, 'support': 667312}}
[[ 40597  74158 115683]
 [ 33608  70579 104420]
 [ 38758  70714 118795]]
Evaluating performance on  train set...
722/722 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09445
{'0': {'precision': 0.37239097234006446, 'recall': 0.21373612103110187, 'f1-score': 0.27159093253026956, 'support': 61604}, '1': {'precision': 0.37192289353586266, 'recall': 0.44735936552673405, 'f1-score': 0.4061681742442275, 'support': 61027}, '2': {'precision': 0.36267239221781683, 'recall': 0.44372995535786236, 'f1-score': 0.3991273212240697, 'support': 62049}, 'accuracy': 0.36820987654320986, 'macro avg': {'precision': 0.3689954193645813, 'recall': 0.36827514730523275, 'f1-score': 0.3589621426661889, 'support': 184680}, 'weighted avg': {'precision': 0.36897103719175733, 'recall': 0.36820987654320986, 'f1-score': 0.35891143671122755, 'support': 184680}}
[[13167 23010 25427]
 [10769 27301 22957]
 [11422 23094 27533]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1009762
{'0': {'precision': 0.35876117231344834, 'recall': 0.1684231069476971, 'f1-score': 0.22923168869114816, 'support': 20496}, '1': {'precision': 0.3281076801266825, 'recall': 0.36145839390591383, 'f1-score': 0.34397653699297215, 'support': 17197}, '2': {'precision': 0.36329169628651703, 'recall': 0.5256918932157727, 'f1-score': 0.42965809912723196, 'support': 20415}, 'accuracy': 0.35107042059613136, 'macro avg': {'precision': 0.350053516242216, 'recall': 0.3518577980231279, 'f1-score': 0.33428877493711745, 'support': 58108}, 'weighted avg': {'precision': 0.3512810067901879, 'recall': 0.35107042059613136, 'f1-score': 0.33360582521794513, 'support': 58108}}
[[ 3452  6441 10603]
 [ 2775  6216  8206]
 [ 3395  6288 10732]]
training model: results/PCAR/W1/deepVOL_L3/h300
Epoch 1/50
722/722 - 27s - loss: 3.3070 - accuracy300: 0.3688 - val_loss: 3.2874 - val_accuracy300: 0.3581 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 24s - loss: 3.2865 - accuracy300: 0.3646 - val_loss: 3.2965 - val_accuracy300: 0.3589 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 24s - loss: 3.2828 - accuracy300: 0.3683 - val_loss: 3.2839 - val_accuracy300: 0.3551 - 24s/epoch - 33ms/step
Epoch 4/50
722/722 - 23s - loss: 3.2682 - accuracy300: 0.3813 - val_loss: 3.2812 - val_accuracy300: 0.3603 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 23s - loss: 3.2564 - accuracy300: 0.3902 - val_loss: 3.2823 - val_accuracy300: 0.3511 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 3.2547 - accuracy300: 0.3888 - val_loss: 3.2762 - val_accuracy300: 0.3560 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 23s - loss: 3.2500 - accuracy300: 0.3933 - val_loss: 3.2783 - val_accuracy300: 0.3561 - 23s/epoch - 32ms/step
Epoch 8/50
722/722 - 24s - loss: 3.2469 - accuracy300: 0.3938 - val_loss: 3.2822 - val_accuracy300: 0.3529 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 23s - loss: 3.2431 - accuracy300: 0.3970 - val_loss: 3.2848 - val_accuracy300: 0.3567 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 3.2390 - accuracy300: 0.4005 - val_loss: 3.2842 - val_accuracy300: 0.3579 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 23s - loss: 3.2357 - accuracy300: 0.4026 - val_loss: 3.2827 - val_accuracy300: 0.3571 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 23s - loss: 3.2292 - accuracy300: 0.4069 - val_loss: 3.2866 - val_accuracy300: 0.3582 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 23s - loss: 3.2243 - accuracy300: 0.4083 - val_loss: 3.2874 - val_accuracy300: 0.3590 - 23s/epoch - 32ms/step
Epoch 14/50
722/722 - 23s - loss: 3.2214 - accuracy300: 0.4107 - val_loss: 3.2885 - val_accuracy300: 0.3581 - 23s/epoch - 32ms/step
Epoch 15/50
722/722 - 23s - loss: 3.2144 - accuracy300: 0.4142 - val_loss: 3.2950 - val_accuracy300: 0.3567 - 23s/epoch - 32ms/step
Epoch 16/50
722/722 - 23s - loss: 3.2093 - accuracy300: 0.4175 - val_loss: 3.2988 - val_accuracy300: 0.3574 - 23s/epoch - 32ms/step
testing model: results/PCAR/W1/deepVOL_L3/h300
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0965285
{'0': {'precision': 0.3487574717250754, 'recall': 0.3447591238361026, 'f1-score': 0.34674677189502, 'support': 232194}, '1': {'precision': 0.3731997079710626, 'recall': 0.027404537368716037, 'f1-score': 0.05105969525815884, 'support': 205185}, '2': {'precision': 0.35522446671855373, 'recall': 0.6530511061918037, 'f1-score': 0.4601514450406499, 'support': 229933}, 'accuracy': 0.35340590308581293, 'macro avg': {'precision': 0.35906054880489724, 'recall': 0.3417382557988741, 'f1-score': 0.28598597073127624, 'support': 667312}, 'weighted avg': {'precision': 0.3585012734309766, 'recall': 0.35340590308581293, 'f1-score': 0.2949043412039187, 'support': 667312}}
[[ 80051   4939 147204]
 [ 74211   5623 125351]
 [ 75270   4505 150158]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974405
{'0': {'precision': 0.32528954898487533, 'recall': 0.3868641527167836, 'f1-score': 0.35341490314510104, 'support': 61709}, '1': {'precision': 0.42487286176606565, 'recall': 0.06021885852827469, 'f1-score': 0.10548668503213958, 'support': 61044}, '2': {'precision': 0.35057191293672907, 'recall': 0.5810389652332585, 'f1-score': 0.4372983319660924, 'support': 61927}, 'accuracy': 0.34400584795321637, 'macro avg': {'precision': 0.36691144122922337, 'recall': 0.3427073254927722, 'f1-score': 0.29873330671444437, 'support': 184680}, 'weighted avg': {'precision': 0.36668344490138727, 'recall': 0.34400584795321637, 'f1-score': 0.2995927185561359, 'support': 184680}}
[[23873  2672 35164]
 [25876  3676 31492]
 [23641  2304 35982]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0924143
{'0': {'precision': 0.3411252377615377, 'recall': 0.33072891390857034, 'f1-score': 0.3358466390695841, 'support': 20606}, '1': {'precision': 0.34186351706036744, 'recall': 0.031178934769599043, 'f1-score': 0.057145991005813315, 'support': 16710}, '2': {'precision': 0.363710867070972, 'recall': 0.6403424393997691, 'f1-score': 0.46391860343565977, 'support': 20792}, 'accuracy': 0.35537275418186826, 'macro avg': {'precision': 0.34889987396429234, 'recall': 0.33408342935931284, 'f1-score': 0.285637077837019, 'support': 58108}, 'weighted avg': {'precision': 0.34941905361624276, 'recall': 0.35537275418186826, 'f1-score': 0.30152751698577185, 'support': 58108}}
[[ 6815   472 13319]
 [ 6216   521  9973]
 [ 6947   531 13314]]
training model: results/PCAR/W1/deepVOL_L3/h500
Epoch 1/50
722/722 - 27s - loss: 3.3100 - accuracy500: 0.3670 - val_loss: 3.2995 - val_accuracy500: 0.3391 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 24s - loss: 3.2875 - accuracy500: 0.3640 - val_loss: 3.2907 - val_accuracy500: 0.3467 - 24s/epoch - 33ms/step
Epoch 3/50
722/722 - 26s - loss: 3.2727 - accuracy500: 0.3775 - val_loss: 3.2902 - val_accuracy500: 0.3503 - 26s/epoch - 36ms/step
Epoch 4/50
722/722 - 26s - loss: 3.2634 - accuracy500: 0.3845 - val_loss: 3.2892 - val_accuracy500: 0.3538 - 26s/epoch - 36ms/step
Epoch 5/50
722/722 - 23s - loss: 3.2574 - accuracy500: 0.3891 - val_loss: 3.2936 - val_accuracy500: 0.3484 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 3.2540 - accuracy500: 0.3907 - val_loss: 3.2927 - val_accuracy500: 0.3468 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 23s - loss: 3.2480 - accuracy500: 0.3956 - val_loss: 3.2954 - val_accuracy500: 0.3470 - 23s/epoch - 32ms/step
Epoch 8/50
722/722 - 24s - loss: 3.2433 - accuracy500: 0.3983 - val_loss: 3.2975 - val_accuracy500: 0.3523 - 24s/epoch - 33ms/step
Epoch 9/50
722/722 - 23s - loss: 3.2404 - accuracy500: 0.4006 - val_loss: 3.2977 - val_accuracy500: 0.3498 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 3.2364 - accuracy500: 0.4027 - val_loss: 3.3014 - val_accuracy500: 0.3492 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 23s - loss: 3.2313 - accuracy500: 0.4065 - val_loss: 3.3037 - val_accuracy500: 0.3495 - 23s/epoch - 32ms/step
Epoch 12/50
722/722 - 23s - loss: 3.2240 - accuracy500: 0.4120 - val_loss: 3.3045 - val_accuracy500: 0.3508 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 23s - loss: 3.2230 - accuracy500: 0.4118 - val_loss: 3.3050 - val_accuracy500: 0.3477 - 23s/epoch - 32ms/step
Epoch 14/50
722/722 - 24s - loss: 3.2179 - accuracy500: 0.4143 - val_loss: 3.3055 - val_accuracy500: 0.3546 - 24s/epoch - 33ms/step
testing model: results/PCAR/W1/deepVOL_L3/h500
Evaluating performance on  test set...
2607/2607 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0984011
{'0': {'precision': 0.3542138570394414, 'recall': 0.13222827105553353, 'f1-score': 0.19257002301039436, 'support': 229429}, '1': {'precision': 0.3430707786967228, 'recall': 0.4751582316272182, 'f1-score': 0.3984530063630227, 'support': 209345}, '2': {'precision': 0.3572706705059646, 'recall': 0.45604232118947396, 'f1-score': 0.40065890385155056, 'support': 228538}, 'accuracy': 0.3507085141582948, 'macro avg': {'precision': 0.3515184354140429, 'recall': 0.3544762746240752, 'f1-score': 0.33056064440832256, 'support': 667312}, 'weighted avg': {'precision': 0.351765002980704, 'recall': 0.3507085141582948, 'f1-score': 0.3284237013492106, 'support': 667312}}
[[ 30337  96208 102884]
 [ 25260  99472  84613]
 [ 30049  94266 104223]]
Evaluating performance on  train set...
722/722 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.092117
{'0': {'precision': 0.369254707947654, 'recall': 0.14819381284826746, 'f1-score': 0.2115041820924174, 'support': 62452}, '1': {'precision': 0.3816776059628435, 'recall': 0.567156530507662, 'f1-score': 0.4562882772653824, 'support': 60493}, '2': {'precision': 0.368700341336087, 'recall': 0.4164250425204503, 'f1-score': 0.3911121929697781, 'support': 61735}, 'accuracy': 0.3750920511154429, 'macro avg': {'precision': 0.37321088508219485, 'recall': 0.3772584619587933, 'f1-score': 0.35296821744252593, 'support': 184680}, 'weighted avg': {'precision': 0.37313858571930103, 'recall': 0.3750920511154429, 'f1-score': 0.35172415621420666, 'support': 184680}}
[[ 9255 28311 24886]
 [ 7052 34309 19132]
 [ 8757 27270 25708]]
Evaluating performance on  val set...
227/227 - 4s - 4s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0969615
{'0': {'precision': 0.3686440677966102, 'recall': 0.1498556157860074, 'f1-score': 0.21308936354140404, 'support': 19739}, '1': {'precision': 0.3434800161485668, 'recall': 0.466472942595537, 'f1-score': 0.3956381222534818, 'support': 18239}, '2': {'precision': 0.3599589160148534, 'recall': 0.45265772478887234, 'f1-score': 0.40102103688055624, 'support': 20130}, 'accuracy': 0.354133682109176, 'macro avg': {'precision': 0.35736099998667675, 'recall': 0.35632876105680555, 'f1-score': 0.33658284089181406, 'support': 58108}, 'weighted avg': {'precision': 0.3577368047110553, 'recall': 0.354133682109176, 'f1-score': 0.335491982706867, 'support': 58108}}
[[2958 7913 8868]
 [2397 8508 7334]
 [2669 8349 9112]]
training model: results/PCAR/W1/deepVOL_L3/h1000
Epoch 1/50
722/722 - 27s - loss: 3.3311 - accuracy1000: 0.3613 - val_loss: 3.3093 - val_accuracy1000: 0.3332 - 27s/epoch - 37ms/step
Epoch 2/50
722/722 - 23s - loss: 3.2980 - accuracy1000: 0.3525 - val_loss: 3.3006 - val_accuracy1000: 0.3370 - 23s/epoch - 32ms/step
Epoch 3/50
722/722 - 24s - loss: 3.2888 - accuracy1000: 0.3717 - val_loss: 3.3037 - val_accuracy1000: 0.3333 - 24s/epoch - 33ms/step
Epoch 4/50
722/722 - 23s - loss: 3.2780 - accuracy1000: 0.3743 - val_loss: 3.3047 - val_accuracy1000: 0.3305 - 23s/epoch - 32ms/step
Epoch 5/50
722/722 - 23s - loss: 3.2722 - accuracy1000: 0.3773 - val_loss: 3.3074 - val_accuracy1000: 0.3324 - 23s/epoch - 32ms/step
Epoch 6/50
722/722 - 23s - loss: 3.2694 - accuracy1000: 0.3774 - val_loss: 3.3060 - val_accuracy1000: 0.3336 - 23s/epoch - 32ms/step
Epoch 7/50
722/722 - 24s - loss: 3.2663 - accuracy1000: 0.3809 - val_loss: 3.2997 - val_accuracy1000: 0.3382 - 24s/epoch - 33ms/step
Epoch 8/50
722/722 - 23s - loss: 3.2607 - accuracy1000: 0.3833 - val_loss: 3.2985 - val_accuracy1000: 0.3458 - 23s/epoch - 32ms/step
Epoch 9/50
722/722 - 23s - loss: 3.2584 - accuracy1000: 0.3873 - val_loss: 3.3016 - val_accuracy1000: 0.3479 - 23s/epoch - 32ms/step
Epoch 10/50
722/722 - 23s - loss: 3.2558 - accuracy1000: 0.3870 - val_loss: 3.3100 - val_accuracy1000: 0.3418 - 23s/epoch - 32ms/step
Epoch 11/50
722/722 - 24s - loss: 3.2503 - accuracy1000: 0.3906 - val_loss: 3.3109 - val_accuracy1000: 0.3438 - 24s/epoch - 33ms/step
Epoch 12/50
722/722 - 23s - loss: 3.2450 - accuracy1000: 0.3967 - val_loss: 3.3097 - val_accuracy1000: 0.3460 - 23s/epoch - 32ms/step
Epoch 13/50
722/722 - 23s - loss: 3.2388 - accuracy1000: 0.4008 - val_loss: 3.3168 - val_accuracy1000: 0.3413 - 23s/epoch - 32ms/step
Epoch 14/50
722/722 - 23s - loss: 3.2349 - accuracy1000: 0.4014 - val_loss: 3.3326 - val_accuracy1000: 0.3400 - 23s/epoch - 32ms/step
Epoch 15/50
722/722 - 23s - loss: 3.2297 - accuracy1000: 0.4040 - val_loss: 3.3444 - val_accuracy1000: 0.3350 - 23s/epoch - 32ms/step
Epoch 16/50
722/722 - 23s - loss: 3.2230 - accuracy1000: 0.4077 - val_loss: 3.3607 - val_accuracy1000: 0.3375 - 23s/epoch - 32ms/step
Epoch 17/50
722/722 - 23s - loss: 3.2126 - accuracy1000: 0.4145 - val_loss: 3.3811 - val_accuracy1000: 0.3382 - 23s/epoch - 32ms/step
Epoch 18/50
722/722 - 23s - loss: 3.2156 - accuracy1000: 0.4157 - val_loss: 3.3999 - val_accuracy1000: 0.3400 - 23s/epoch - 32ms/step
testing model: results/PCAR/W1/deepVOL_L3/h1000
Evaluating performance on  test set...
2607/2607 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019521
{'0': {'precision': 0.35380501851090085, 'recall': 0.14618103946429178, 'f1-score': 0.20688411026122097, 'support': 235352}, '1': {'precision': 0.31121175803543843, 'recall': 0.4592384769539078, 'f1-score': 0.37100491966835236, 'support': 199600}, '2': {'precision': 0.34594404300029397, 'recall': 0.4102212084696161, 'f1-score': 0.3753507136345648, 'support': 232360}, 'accuracy': 0.33175935694247966, 'macro avg': {'precision': 0.3369869398488778, 'recall': 0.33854690829593853, 'f1-score': 0.31774658118804605, 'support': 667312}, 'weighted avg': {'precision': 0.33832771395089456, 'recall': 0.33175935694247966, 'f1-score': 0.31463492774613594, 'support': 667312}}
[[ 34404 100598 100350]
 [ 28072  91664  79864]
 [ 34764 102277  95319]]
Evaluating performance on  train set...
722/722 - 10s - 10s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0966339
{'0': {'precision': 0.35221317872672536, 'recall': 0.15061265356070117, 'f1-score': 0.21099855282199712, 'support': 62923}, '1': {'precision': 0.36191518007404916, 'recall': 0.5733328889925684, 'f1-score': 0.4437279960795945, 'support': 60014}, '2': {'precision': 0.3678888693960224, 'recall': 0.37359700694815606, 'f1-score': 0.37072096686059586, 'support': 61743}, 'accuracy': 0.36252978124323154, 'macro avg': {'precision': 0.36067240939893236, 'recall': 0.36584751650047526, 'f1-score': 0.3418158385873958, 'support': 184680}, 'weighted avg': {'precision': 0.3606067247406559, 'recall': 0.36252978124323154, 'f1-score': 0.3400258747715674, 'support': 184680}}
[[ 9477 31175 22271]
 [ 8243 34408 17363]
 [ 9187 29489 23067]]
Evaluating performance on  val set...
227/227 - 3s - 3s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1000229
{'0': {'precision': 0.34807269359879617, 'recall': 0.15347317919665188, 'f1-score': 0.21302068574667044, 'support': 19593}, '1': {'precision': 0.34441813877253685, 'recall': 0.5050202948088015, 'f1-score': 0.40953680244266877, 'support': 18724}, '2': {'precision': 0.3416916507676933, 'recall': 0.38007174978525593, 'f1-score': 0.35986126061475904, 'support': 19791}, 'accuracy': 0.3439285468438081, 'macro avg': {'precision': 0.3447274943796754, 'recall': 0.3461884079302364, 'f1-score': 0.32747291626803277, 'support': 58108}, 'weighted avg': {'precision': 0.344721776285565, 'recall': 0.3439285468438081, 'f1-score': 0.3263560197149745, 'support': 58108}}
[[3007 8692 7894]
 [2670 9456 6598]
 [2962 9307 7522]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        17 (peak)  11.43 (ave)

============================================
