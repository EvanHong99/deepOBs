This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-09.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-01.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-18.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-19.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-27.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-23.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-25.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-20.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-11.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-24.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-07.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-26.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-09-17.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-03.csv
data/AAPL_orderbooks/AAPL_orderbooks_2019-10-02.csv
training model: results/AAPL/W7/deepLOB_L1/h10
Epoch 1/50
9052/9052 - 166s - loss: 3.1462 - accuracy10: 0.4447 - val_loss: 3.2540 - val_accuracy10: 0.4185 - 166s/epoch - 18ms/step
Epoch 2/50
9052/9052 - 135s - loss: 3.1096 - accuracy10: 0.4601 - val_loss: 3.2571 - val_accuracy10: 0.4153 - 135s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 135s - loss: 3.0925 - accuracy10: 0.4671 - val_loss: 3.2472 - val_accuracy10: 0.4191 - 135s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 137s - loss: 3.0838 - accuracy10: 0.4701 - val_loss: 3.2641 - val_accuracy10: 0.4221 - 137s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 137s - loss: 3.0757 - accuracy10: 0.4729 - val_loss: 3.2046 - val_accuracy10: 0.4313 - 137s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 134s - loss: 3.0677 - accuracy10: 0.4753 - val_loss: 3.1860 - val_accuracy10: 0.4364 - 134s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 133s - loss: 3.0622 - accuracy10: 0.4771 - val_loss: 3.2094 - val_accuracy10: 0.4407 - 133s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 135s - loss: 3.0562 - accuracy10: 0.4787 - val_loss: 3.1591 - val_accuracy10: 0.4475 - 135s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 135s - loss: 3.0538 - accuracy10: 0.4792 - val_loss: 3.1915 - val_accuracy10: 0.4417 - 135s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 135s - loss: 3.0506 - accuracy10: 0.4805 - val_loss: 3.1715 - val_accuracy10: 0.4432 - 135s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 135s - loss: 3.0481 - accuracy10: 0.4813 - val_loss: 3.1797 - val_accuracy10: 0.4402 - 135s/epoch - 15ms/step
Epoch 12/50
9052/9052 - 133s - loss: 3.0452 - accuracy10: 0.4822 - val_loss: 3.1768 - val_accuracy10: 0.4394 - 133s/epoch - 15ms/step
Epoch 13/50
9052/9052 - 133s - loss: 3.0426 - accuracy10: 0.4832 - val_loss: 3.1526 - val_accuracy10: 0.4469 - 133s/epoch - 15ms/step
Epoch 14/50
9052/9052 - 132s - loss: 3.0399 - accuracy10: 0.4839 - val_loss: 3.1905 - val_accuracy10: 0.4356 - 132s/epoch - 15ms/step
Epoch 15/50
9052/9052 - 133s - loss: 3.0377 - accuracy10: 0.4847 - val_loss: 3.1498 - val_accuracy10: 0.4480 - 133s/epoch - 15ms/step
Epoch 16/50
9052/9052 - 135s - loss: 3.0353 - accuracy10: 0.4855 - val_loss: 3.1585 - val_accuracy10: 0.4456 - 135s/epoch - 15ms/step
Epoch 17/50
9052/9052 - 136s - loss: 3.0324 - accuracy10: 0.4868 - val_loss: 3.1722 - val_accuracy10: 0.4415 - 136s/epoch - 15ms/step
Epoch 18/50
9052/9052 - 133s - loss: 3.0327 - accuracy10: 0.4863 - val_loss: 3.1448 - val_accuracy10: 0.4488 - 133s/epoch - 15ms/step
Epoch 19/50
9052/9052 - 136s - loss: 3.0302 - accuracy10: 0.4873 - val_loss: 3.1779 - val_accuracy10: 0.4400 - 136s/epoch - 15ms/step
Epoch 20/50
9052/9052 - 135s - loss: 3.0285 - accuracy10: 0.4878 - val_loss: 3.1727 - val_accuracy10: 0.4429 - 135s/epoch - 15ms/step
Epoch 21/50
9052/9052 - 134s - loss: 3.0263 - accuracy10: 0.4884 - val_loss: 3.1349 - val_accuracy10: 0.4513 - 134s/epoch - 15ms/step
Epoch 22/50
9052/9052 - 135s - loss: 3.0238 - accuracy10: 0.4892 - val_loss: 3.1518 - val_accuracy10: 0.4471 - 135s/epoch - 15ms/step
Epoch 23/50
9052/9052 - 135s - loss: 3.0226 - accuracy10: 0.4895 - val_loss: 3.1476 - val_accuracy10: 0.4479 - 135s/epoch - 15ms/step
Epoch 24/50
9052/9052 - 136s - loss: 3.0222 - accuracy10: 0.4897 - val_loss: 3.1355 - val_accuracy10: 0.4516 - 136s/epoch - 15ms/step
Epoch 25/50
9052/9052 - 134s - loss: 3.0198 - accuracy10: 0.4907 - val_loss: 3.1654 - val_accuracy10: 0.4446 - 134s/epoch - 15ms/step
Epoch 26/50
9052/9052 - 135s - loss: 3.0180 - accuracy10: 0.4909 - val_loss: 3.1490 - val_accuracy10: 0.4481 - 135s/epoch - 15ms/step
Epoch 27/50
9052/9052 - 131s - loss: 3.0162 - accuracy10: 0.4916 - val_loss: 3.1445 - val_accuracy10: 0.4491 - 131s/epoch - 15ms/step
Epoch 28/50
9052/9052 - 134s - loss: 3.0146 - accuracy10: 0.4920 - val_loss: 3.1470 - val_accuracy10: 0.4490 - 134s/epoch - 15ms/step
Epoch 29/50
9052/9052 - 136s - loss: 3.0132 - accuracy10: 0.4924 - val_loss: 3.1411 - val_accuracy10: 0.4513 - 136s/epoch - 15ms/step
Epoch 30/50
9052/9052 - 135s - loss: 3.0117 - accuracy10: 0.4928 - val_loss: 3.1354 - val_accuracy10: 0.4523 - 135s/epoch - 15ms/step
Epoch 31/50
9052/9052 - 137s - loss: 3.0103 - accuracy10: 0.4934 - val_loss: 3.1317 - val_accuracy10: 0.4539 - 137s/epoch - 15ms/step
Epoch 32/50
9052/9052 - 136s - loss: 3.0088 - accuracy10: 0.4939 - val_loss: 3.1236 - val_accuracy10: 0.4557 - 136s/epoch - 15ms/step
Epoch 33/50
9052/9052 - 134s - loss: 3.0075 - accuracy10: 0.4943 - val_loss: 3.1324 - val_accuracy10: 0.4537 - 134s/epoch - 15ms/step
Epoch 34/50
9052/9052 - 134s - loss: 3.0066 - accuracy10: 0.4943 - val_loss: 3.1413 - val_accuracy10: 0.4506 - 134s/epoch - 15ms/step
Epoch 35/50
9052/9052 - 134s - loss: 3.0055 - accuracy10: 0.4948 - val_loss: 3.1392 - val_accuracy10: 0.4517 - 134s/epoch - 15ms/step
Epoch 36/50
9052/9052 - 132s - loss: 3.0046 - accuracy10: 0.4952 - val_loss: 3.1457 - val_accuracy10: 0.4502 - 132s/epoch - 15ms/step
Epoch 37/50
9052/9052 - 132s - loss: 3.0044 - accuracy10: 0.4950 - val_loss: 3.1450 - val_accuracy10: 0.4507 - 132s/epoch - 15ms/step
Epoch 38/50
9052/9052 - 134s - loss: 3.0018 - accuracy10: 0.4958 - val_loss: 3.1299 - val_accuracy10: 0.4547 - 134s/epoch - 15ms/step
Epoch 39/50
9052/9052 - 134s - loss: 3.0010 - accuracy10: 0.4961 - val_loss: 3.1385 - val_accuracy10: 0.4517 - 134s/epoch - 15ms/step
Epoch 40/50
9052/9052 - 135s - loss: 3.0000 - accuracy10: 0.4967 - val_loss: 3.1409 - val_accuracy10: 0.4513 - 135s/epoch - 15ms/step
Epoch 41/50
9052/9052 - 133s - loss: 2.9989 - accuracy10: 0.4968 - val_loss: 3.1345 - val_accuracy10: 0.4530 - 133s/epoch - 15ms/step
Epoch 42/50
9052/9052 - 137s - loss: 2.9976 - accuracy10: 0.4972 - val_loss: 3.1359 - val_accuracy10: 0.4524 - 137s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h10
Evaluating performance on  test set...
23942/23942 - 128s - 128s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.042427
{'0': {'precision': 0.4231660821370682, 'recall': 0.5898483592880535, 'f1-score': 0.4927941972944778, 'support': 1878849}, '1': {'precision': 0.48314977147341936, 'recall': 0.28114697464889005, 'f1-score': 0.3554538135644942, 'support': 2382302}, '2': {'precision': 0.44241733396048827, 'recall': 0.5030427005968693, 'f1-score': 0.47078628885788076, 'support': 1867913}, 'accuracy': 0.44340424573801157, 'macro avg': {'precision': 0.4495777291903253, 'recall': 0.4580126781779376, 'f1-score': 0.4396780999056176, 'support': 6129064}, 'weighted avg': {'precision': 0.4523481769268449, 'recall': 0.44340424573801157, 'f1-score': 0.4327042505893632, 'support': 6129064}}
[[1108236  345092  425521]
 [ 953809  669777  758716]
 [ 556870  371403  939640]]
Evaluating performance on  train set...
9052/9052 - 45s - 45s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0447031
{'0': {'precision': 0.4448352919429493, 'recall': 0.6198752108828964, 'f1-score': 0.5179668457659492, 'support': 784203}, '1': {'precision': 0.5130221463344363, 'recall': 0.16066983360314216, 'f1-score': 0.2447028771039195, 'support': 753620}, '2': {'precision': 0.4574486707674063, 'recall': 0.580150066024431, 'f1-score': 0.5115443323862511, 'support': 779257}, 'accuracy': 0.4571607367894074, 'macro avg': {'precision': 0.4717687030149307, 'recall': 0.45356503683682314, 'f1-score': 0.4247380184187066, 'support': 2317080}, 'weighted avg': {'precision': 0.4712547685899025, 'recall': 0.4571607367894074, 'f1-score': 0.4269289961570439, 'support': 2317080}}
[[486108  54782 243313]
 [339658 121084 292878]
 [267016  60155 452086]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0390556
{'0': {'precision': 0.4345726571491245, 'recall': 0.6209148362499786, 'f1-score': 0.5112947561007946, 'support': 232916}, '1': {'precision': 0.5068807339449541, 'recall': 0.23236957705270944, 'f1-score': 0.3186570502865252, 'support': 240621}, '2': {'precision': 0.4609186353692784, 'recall': 0.5209343907467768, 'f1-score': 0.48909228186571785, 'support': 233778}, 'accuracy': 0.4556908873698423, 'macro avg': {'precision': 0.46745734215445234, 'recall': 0.4580729346831549, 'f1-score': 0.43968136275101255, 'support': 707315}, 'weighted avg': {'precision': 0.4678788246177071, 'recall': 0.4556908873698423, 'f1-score': 0.4384232244176504, 'support': 707315}}
[[144621  24853  63442]
 [105715  55913  78993]
 [ 82453  29542 121783]]
training model: results/AAPL/W7/deepLOB_L1/h20
Epoch 1/50
9052/9052 - 135s - loss: 3.2097 - accuracy20: 0.4146 - val_loss: 3.4375 - val_accuracy20: 0.3508 - 135s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 134s - loss: 3.1823 - accuracy20: 0.4287 - val_loss: 3.3065 - val_accuracy20: 0.3800 - 134s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 134s - loss: 3.1713 - accuracy20: 0.4332 - val_loss: 3.3875 - val_accuracy20: 0.3682 - 134s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 134s - loss: 3.1625 - accuracy20: 0.4372 - val_loss: 3.3814 - val_accuracy20: 0.3770 - 134s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 136s - loss: 3.1554 - accuracy20: 0.4403 - val_loss: 3.3376 - val_accuracy20: 0.3827 - 136s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 131s - loss: 3.1504 - accuracy20: 0.4420 - val_loss: 3.3460 - val_accuracy20: 0.3797 - 131s/epoch - 14ms/step
Epoch 7/50
9052/9052 - 132s - loss: 3.1463 - accuracy20: 0.4434 - val_loss: 3.3324 - val_accuracy20: 0.3830 - 132s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 134s - loss: 3.1417 - accuracy20: 0.4452 - val_loss: 3.3822 - val_accuracy20: 0.3753 - 134s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 135s - loss: 3.1401 - accuracy20: 0.4459 - val_loss: 3.3816 - val_accuracy20: 0.3766 - 135s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 131s - loss: 3.1369 - accuracy20: 0.4472 - val_loss: 3.3526 - val_accuracy20: 0.3802 - 131s/epoch - 14ms/step
Epoch 11/50
9052/9052 - 133s - loss: 3.1341 - accuracy20: 0.4484 - val_loss: 3.3384 - val_accuracy20: 0.3846 - 133s/epoch - 15ms/step
Epoch 12/50
9052/9052 - 135s - loss: 3.1312 - accuracy20: 0.4492 - val_loss: 3.3589 - val_accuracy20: 0.3813 - 135s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h20
Evaluating performance on  test set...
23942/23942 - 152s - 152s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1011492
{'0': {'precision': 0.352275569071922, 'recall': 0.7838394885841244, 'f1-score': 0.48609073533749975, 'support': 1876203}, '1': {'precision': 0.4837985747470373, 'recall': 0.005139093875034869, 'f1-score': 0.010170156450575672, 'support': 2391083}, '2': {'precision': 0.4084147367537026, 'recall': 0.42315517747013875, 'f1-score': 0.4156543122985393, 'support': 1861778}, 'accuracy': 0.37048903388837184, 'macro avg': {'precision': 0.414829626857554, 'recall': 0.40404458664309933, 'f1-score': 0.30397173469553823, 'support': 6129064}, 'weighted avg': {'precision': 0.4206385508105564, 'recall': 0.37048903388837184, 'f1-score': 0.27902770118753606, 'support': 6129064}}
[[1470642    7202  398359]
 [1636002   12288  742793]
 [1068048    5909  787821]]
Evaluating performance on  train set...
9052/9052 - 51s - 51s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0933063
{'0': {'precision': 0.37423916405322444, 'recall': 0.7225784578003177, 'f1-score': 0.49309411632733186, 'support': 778667}, '1': {'precision': 0.5369561086832605, 'recall': 0.003705899014907523, 'f1-score': 0.0073609948022416395, 'support': 762568}, '2': {'precision': 0.41935148669177064, 'recall': 0.4369326347401865, 'f1-score': 0.427961573446062, 'support': 775845}, 'accuracy': 0.3903473337131217, 'macro avg': {'precision': 0.4435155864760852, 'recall': 0.38773899718513727, 'f1-score': 0.30947222819187853, 'support': 2317080}, 'weighted avg': {'precision': 0.44289579437679555, 'recall': 0.3903473337131217, 'f1-score': 0.31142697805551395, 'support': 2317080}}
[[562648   1148 214871]
 [505233   2826 254509]
 [435564   1289 338992]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1003541
{'0': {'precision': 0.3615023295833341, 'recall': 0.8218131730528425, 'f1-score': 0.5021270757951306, 'support': 231594}, '1': {'precision': 0.5350701402805611, 'recall': 0.005501162043218118, 'f1-score': 0.01089035815818347, 'support': 242676}, '2': {'precision': 0.43179256551020295, 'recall': 0.33041687227788624, 'f1-score': 0.3743631130644471, 'support': 233045}, 'accuracy': 0.37983642365848314, 'macro avg': {'precision': 0.4427883451246994, 'recall': 0.3859104024579823, 'f1-score': 0.29579351567258705, 'support': 707315}, 'weighted avg': {'precision': 0.4442116317476279, 'recall': 0.37983642365848314, 'f1-score': 0.29149091738786376, 'support': 707315}}
[[190327    583  40684]
 [180696   1335  60645]
 [155466    577  77002]]
training model: results/AAPL/W7/deepLOB_L1/h30
Epoch 1/50
9052/9052 - 138s - loss: 3.2483 - accuracy30: 0.3934 - val_loss: 3.3436 - val_accuracy30: 0.3369 - 138s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 135s - loss: 3.2269 - accuracy30: 0.4058 - val_loss: 3.5057 - val_accuracy30: 0.3346 - 135s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 133s - loss: 3.2172 - accuracy30: 0.4099 - val_loss: 3.4350 - val_accuracy30: 0.3353 - 133s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 135s - loss: 3.2118 - accuracy30: 0.4128 - val_loss: 3.3365 - val_accuracy30: 0.3408 - 135s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 135s - loss: 3.2071 - accuracy30: 0.4151 - val_loss: 3.3314 - val_accuracy30: 0.3434 - 135s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 131s - loss: 3.2040 - accuracy30: 0.4166 - val_loss: 3.3083 - val_accuracy30: 0.3505 - 131s/epoch - 14ms/step
Epoch 7/50
9052/9052 - 133s - loss: 3.2011 - accuracy30: 0.4177 - val_loss: 3.3183 - val_accuracy30: 0.3487 - 133s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 130s - loss: 3.1990 - accuracy30: 0.4186 - val_loss: 3.3214 - val_accuracy30: 0.3496 - 130s/epoch - 14ms/step
Epoch 9/50
9052/9052 - 133s - loss: 3.1961 - accuracy30: 0.4202 - val_loss: 3.3174 - val_accuracy30: 0.3498 - 133s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 134s - loss: 3.1949 - accuracy30: 0.4204 - val_loss: 3.3104 - val_accuracy30: 0.3564 - 134s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 134s - loss: 3.1939 - accuracy30: 0.4209 - val_loss: 3.3337 - val_accuracy30: 0.3524 - 134s/epoch - 15ms/step
Epoch 12/50
9052/9052 - 134s - loss: 3.1918 - accuracy30: 0.4219 - val_loss: 3.3201 - val_accuracy30: 0.3574 - 134s/epoch - 15ms/step
Epoch 13/50
9052/9052 - 132s - loss: 3.1897 - accuracy30: 0.4230 - val_loss: 3.3000 - val_accuracy30: 0.3664 - 132s/epoch - 15ms/step
Epoch 14/50
9052/9052 - 134s - loss: 3.1878 - accuracy30: 0.4239 - val_loss: 3.2966 - val_accuracy30: 0.3654 - 134s/epoch - 15ms/step
Epoch 15/50
9052/9052 - 134s - loss: 3.1861 - accuracy30: 0.4246 - val_loss: 3.2841 - val_accuracy30: 0.3732 - 134s/epoch - 15ms/step
Epoch 16/50
9052/9052 - 136s - loss: 3.1846 - accuracy30: 0.4254 - val_loss: 3.2902 - val_accuracy30: 0.3711 - 136s/epoch - 15ms/step
Epoch 17/50
9052/9052 - 134s - loss: 3.1831 - accuracy30: 0.4260 - val_loss: 3.2864 - val_accuracy30: 0.3751 - 134s/epoch - 15ms/step
Epoch 18/50
9052/9052 - 130s - loss: 3.1820 - accuracy30: 0.4264 - val_loss: 3.2900 - val_accuracy30: 0.3705 - 130s/epoch - 14ms/step
Epoch 19/50
9052/9052 - 135s - loss: 3.1806 - accuracy30: 0.4271 - val_loss: 3.3060 - val_accuracy30: 0.3640 - 135s/epoch - 15ms/step
Epoch 20/50
9052/9052 - 133s - loss: 3.1798 - accuracy30: 0.4275 - val_loss: 3.2893 - val_accuracy30: 0.3748 - 133s/epoch - 15ms/step
Epoch 21/50
9052/9052 - 132s - loss: 3.1785 - accuracy30: 0.4284 - val_loss: 3.2841 - val_accuracy30: 0.3784 - 132s/epoch - 15ms/step
Epoch 22/50
9052/9052 - 137s - loss: 3.1775 - accuracy30: 0.4286 - val_loss: 3.2938 - val_accuracy30: 0.3727 - 137s/epoch - 15ms/step
Epoch 23/50
9052/9052 - 132s - loss: 3.1761 - accuracy30: 0.4293 - val_loss: 3.2938 - val_accuracy30: 0.3725 - 132s/epoch - 15ms/step
Epoch 24/50
9052/9052 - 135s - loss: 3.1745 - accuracy30: 0.4299 - val_loss: 3.3031 - val_accuracy30: 0.3724 - 135s/epoch - 15ms/step
Epoch 25/50
9052/9052 - 133s - loss: 3.1732 - accuracy30: 0.4307 - val_loss: 3.2881 - val_accuracy30: 0.3781 - 133s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h30
Evaluating performance on  test set...
23942/23942 - 131s - 131s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0939956
{'0': {'precision': 0.3466400966616027, 'recall': 0.8252022272939668, 'f1-score': 0.4882025064071607, 'support': 1923949}, '1': {'precision': 0.40680605432016015, 'recall': 0.061314662586250894, 'f1-score': 0.10656728086516808, 'support': 2296498}, '2': {'precision': 0.4245790548781248, 'recall': 0.26757385059443567, 'f1-score': 0.32826923559014043, 'support': 1908617}, 'accuracy': 0.36533343427316145, 'macro avg': {'precision': 0.39267506861996254, 'recall': 0.38469691349155105, 'f1-score': 0.3076796742874897, 'support': 6129064}, 'weighted avg': {'precision': 0.3934541978107024, 'recall': 0.36533343427316145, 'f1-score': 0.29540375414519965, 'support': 6129064}}
[[1587647   86943  249359]
 [1712915  140809  442774]
 [1279540  118381  510696]]
Evaluating performance on  train set...
9052/9052 - 48s - 48s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0932151
{'0': {'precision': 0.3634656731838214, 'recall': 0.7307363085764753, 'f1-score': 0.4854635044424419, 'support': 772217}, '1': {'precision': 0.41797671423972527, 'recall': 0.0400808279332282, 'f1-score': 0.07314737220160421, 'support': 777454}, '2': {'precision': 0.41178533644439935, 'recall': 0.37025367177085494, 'f1-score': 0.38991669519884126, 'support': 767409}, 'accuracy': 0.37960881799506274, 'macro avg': {'precision': 0.39774257462264867, 'recall': 0.3803569360935195, 'f1-score': 0.3161758572809625, 'support': 2317080}, 'weighted avg': {'precision': 0.39775916817588625, 'recall': 0.37960881799506274, 'f1-score': 0.3154735569179755, 'support': 2317080}}
[[564287  17925 190005]
 [530424  31161 215869]
 [457807  25466 284136]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0945672
{'0': {'precision': 0.35797825058423777, 'recall': 0.8547569226029244, 'f1-score': 0.5046186415522375, 'support': 233691}, '1': {'precision': 0.39388523047977425, 'recall': 0.07052888239430985, 'f1-score': 0.11963583503284128, 'support': 237463}, '2': {'precision': 0.44619533159180924, 'recall': 0.20179030407222193, 'f1-score': 0.2779008875567115, 'support': 236161}, 'accuracy': 0.3734573704784997, 'macro avg': {'precision': 0.39935293755194046, 'recall': 0.37569203635648535, 'f1-score': 0.30071845471393005, 'support': 707315}, 'weighted avg': {'precision': 0.39948735647731637, 'recall': 0.3734573704784997, 'f1-score': 0.29967308874217014, 'support': 707315}}
[[199749  10319  23623]
 [185190  16748  35525]
 [173053  15453  47655]]
training model: results/AAPL/W7/deepLOB_L1/h50
Epoch 1/50
9052/9052 - 136s - loss: 3.2580 - accuracy50: 0.3869 - val_loss: 3.3172 - val_accuracy50: 0.3260 - 136s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 134s - loss: 3.2441 - accuracy50: 0.3965 - val_loss: 3.3200 - val_accuracy50: 0.3249 - 134s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 134s - loss: 3.2338 - accuracy50: 0.4023 - val_loss: 3.3280 - val_accuracy50: 0.3312 - 134s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 134s - loss: 3.2277 - accuracy50: 0.4061 - val_loss: 3.3050 - val_accuracy50: 0.3415 - 134s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 132s - loss: 3.2236 - accuracy50: 0.4079 - val_loss: 3.3239 - val_accuracy50: 0.3334 - 132s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 131s - loss: 3.2202 - accuracy50: 0.4098 - val_loss: 3.3410 - val_accuracy50: 0.3263 - 131s/epoch - 14ms/step
Epoch 7/50
9052/9052 - 134s - loss: 3.2180 - accuracy50: 0.4115 - val_loss: 3.3567 - val_accuracy50: 0.3239 - 134s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 132s - loss: 3.2155 - accuracy50: 0.4125 - val_loss: 3.3531 - val_accuracy50: 0.3266 - 132s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 136s - loss: 3.2137 - accuracy50: 0.4133 - val_loss: 3.3815 - val_accuracy50: 0.3219 - 136s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 137s - loss: 3.2128 - accuracy50: 0.4138 - val_loss: 3.3921 - val_accuracy50: 0.3233 - 137s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 131s - loss: 3.2110 - accuracy50: 0.4147 - val_loss: 3.4427 - val_accuracy50: 0.3207 - 131s/epoch - 14ms/step
Epoch 12/50
9052/9052 - 134s - loss: 3.2097 - accuracy50: 0.4156 - val_loss: 3.4841 - val_accuracy50: 0.3199 - 134s/epoch - 15ms/step
Epoch 13/50
9052/9052 - 133s - loss: 3.2082 - accuracy50: 0.4159 - val_loss: 3.4714 - val_accuracy50: 0.3209 - 133s/epoch - 15ms/step
Epoch 14/50
9052/9052 - 134s - loss: 3.2070 - accuracy50: 0.4165 - val_loss: 3.4537 - val_accuracy50: 0.3203 - 134s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h50
Evaluating performance on  test set...
23942/23942 - 129s - 129s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0922616
{'0': {'precision': 0.26665324339742946, 'recall': 0.49708886758187715, 'f1-score': 0.34710763461111366, 'support': 1614492}, '1': {'precision': 0.46893684029230126, 'recall': 0.473033843039748, 'f1-score': 0.4709764319240286, 'support': 2900951}, '2': {'precision': 0.2851053250392347, 'recall': 0.034112719157720434, 'f1-score': 0.06093463737553206, 'support': 1613621}, 'accuracy': 0.3638139526687925, 'macro avg': {'precision': 0.3402318029096551, 'recall': 0.3347451432597819, 'f1-score': 0.29300623463689146, 'support': 6129064}, 'weighted avg': {'precision': 0.3672541620901869, 'recall': 0.3638139526687925, 'f1-score': 0.3303942430494366, 'support': 6129064}}
[[ 802546  763742   48204]
 [1438883 1372248   89820]
 [ 768270  790306   55045]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0996343
{'0': {'precision': 0.3507068741487686, 'recall': 0.5039035396547205, 'f1-score': 0.4135742612316049, 'support': 778268}, '1': {'precision': 0.372556842588076, 'recall': 0.33183966424221045, 'f1-score': 0.35102143851304396, 'support': 771032}, '2': {'precision': 0.37282700817447206, 'recall': 0.2486623772434812, 'f1-score': 0.2983415399472755, 'support': 767780}, 'accuracy': 0.3620716591572151, 'macro avg': {'precision': 0.36536357497043886, 'recall': 0.36146852704680404, 'f1-score': 0.35431241323064144, 'support': 2317080}, 'weighted avg': {'precision': 0.36530732875886, 'recall': 0.3620716591572151, 'f1-score': 0.3545760364167432, 'support': 2317080}}
[[392172 212017 174079]
 [368088 255859 147085]
 [357973 218889 190918]]
Evaluating performance on  val set...
2763/2763 - 17s - 17s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1011392
{'0': {'precision': 0.3252272407941809, 'recall': 0.39981132827551386, 'f1-score': 0.35868308440513513, 'support': 225789}, '1': {'precision': 0.3525990117374724, 'recall': 0.5666748809590054, 'f1-score': 0.4347104918132756, 'support': 251594}, '2': {'precision': 0.34811023622047244, 'recall': 0.038454847520136386, 'f1-score': 0.06925884730468566, 'support': 229932}, 'accuracy': 0.3416964153170794, 'macro avg': {'precision': 0.34197882958404185, 'recall': 0.3349803522515518, 'f1-score': 0.28755080784103215, 'support': 707315}, 'weighted avg': {'precision': 0.3424021999609801, 'recall': 0.3416964153170794, 'f1-score': 0.2916410251450645, 'support': 707315}}
[[ 90273 127872   7644]
 [100108 142572   8914]
 [ 87188 133902   8842]]
training model: results/AAPL/W7/deepLOB_L1/h100
Epoch 1/50
9052/9052 - 138s - loss: 3.2742 - accuracy100: 0.3754 - val_loss: 3.3361 - val_accuracy100: 0.3307 - 138s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 132s - loss: 3.2598 - accuracy100: 0.3867 - val_loss: 3.5133 - val_accuracy100: 0.3267 - 132s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 133s - loss: 3.2542 - accuracy100: 0.3905 - val_loss: 3.4652 - val_accuracy100: 0.3261 - 133s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 136s - loss: 3.2512 - accuracy100: 0.3925 - val_loss: 3.5137 - val_accuracy100: 0.3256 - 136s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 137s - loss: 3.2485 - accuracy100: 0.3945 - val_loss: 3.5406 - val_accuracy100: 0.3256 - 137s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 132s - loss: 3.2465 - accuracy100: 0.3953 - val_loss: 3.4946 - val_accuracy100: 0.3257 - 132s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 132s - loss: 3.2446 - accuracy100: 0.3967 - val_loss: 3.4886 - val_accuracy100: 0.3259 - 132s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 131s - loss: 3.2428 - accuracy100: 0.3979 - val_loss: 3.4780 - val_accuracy100: 0.3264 - 131s/epoch - 14ms/step
Epoch 9/50
9052/9052 - 136s - loss: 3.2415 - accuracy100: 0.3987 - val_loss: 3.4625 - val_accuracy100: 0.3268 - 136s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 132s - loss: 3.2398 - accuracy100: 0.3997 - val_loss: 3.4807 - val_accuracy100: 0.3267 - 132s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 133s - loss: 3.2384 - accuracy100: 0.4003 - val_loss: 3.4097 - val_accuracy100: 0.3281 - 133s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h100
Evaluating performance on  test set...
23942/23942 - 132s - 132s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1032336
{'0': {'precision': 0.2962135116429136, 'recall': 0.7729076605327743, 'f1-score': 0.42828764084095705, 'support': 1800162}, '1': {'precision': 0.42036156363490396, 'recall': 0.2355956841420995, 'f1-score': 0.30195678302887063, 'support': 2533633}, '2': {'precision': 0.2939744880832494, 'recall': 0.00195123961924369, 'f1-score': 0.0038767475382985137, 'support': 1795269}, 'accuracy': 0.3249721327759018, 'macro avg': {'precision': 0.3368498544536889, 'recall': 0.33681819476470576, 'f1-score': 0.24470705713604204, 'support': 6129064}, 'weighted avg': {'precision': 0.34687800981517736, 'recall': 0.3249721327759018, 'f1-score': 0.25175044849322165, 'support': 6129064}}
[[1391359  405105    3698]
 [1932005  596913    4715]
 [1373785  417981    3503]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1076368
{'0': {'precision': 0.3341131798962284, 'recall': 0.6993358118765235, 'f1-score': 0.452189346124507, 'support': 781104}, '1': {'precision': 0.34014286595342524, 'recall': 0.12267365181711606, 'f1-score': 0.18031580941427844, 'support': 764288}, '2': {'precision': 0.3599630996309963, 'recall': 0.18961678813199118, 'f1-score': 0.24838990042336198, 'support': 771688}, 'accuracy': 0.3393654945017004, 'macro avg': {'precision': 0.3447397151602167, 'recall': 0.33720875060854355, 'f1-score': 0.2936316853207158, 'support': 2317080}, 'weighted avg': {'precision': 0.3447112125742397, 'recall': 0.3393654945017004, 'f1-score': 0.29463791575550274, 'support': 2317080}}
[[546254  90201 144649]
 [555004  93758 115526]
 [533679  91684 146325]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1113021
{'0': {'precision': 0.3267254743009927, 'recall': 0.7986502811552133, 'f1-score': 0.46373736175839037, 'support': 230122}, '1': {'precision': 0.34657163201764796, 'recall': 0.2068429626728552, 'f1-score': 0.2590676278965399, 'support': 240013}, '2': {'precision': 0.3352601156069364, 'recall': 0.0022008601062484187, 'f1-score': 0.0043730129808115204, 'support': 237180}, 'accuracy': 0.3307635212034242, 'macro avg': {'precision': 0.33618574064185897, 'recall': 0.33589803464477236, 'f1-score': 0.24239266754524724, 'support': 707315}, 'weighted avg': {'precision': 0.3363217391575153, 'recall': 0.3307635212034242, 'f1-score': 0.2402507496033386, 'support': 707315}}
[[183787  45831    504]
 [189837  49645    531]
 [188888  47770    522]]
training model: results/AAPL/W7/deepLOB_L1/h200
Epoch 1/50
9052/9052 - 140s - loss: 3.2551 - accuracy200: 0.3934 - val_loss: 3.3739 - val_accuracy200: 0.3262 - 140s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 135s - loss: 3.2366 - accuracy200: 0.4038 - val_loss: 3.3832 - val_accuracy200: 0.3234 - 135s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 136s - loss: 3.2302 - accuracy200: 0.4081 - val_loss: 3.3444 - val_accuracy200: 0.3265 - 136s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 134s - loss: 3.2246 - accuracy200: 0.4109 - val_loss: 3.3235 - val_accuracy200: 0.3306 - 134s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 133s - loss: 3.2208 - accuracy200: 0.4132 - val_loss: 3.3243 - val_accuracy200: 0.3301 - 133s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 133s - loss: 3.2184 - accuracy200: 0.4142 - val_loss: 3.3467 - val_accuracy200: 0.3270 - 133s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 133s - loss: 3.2154 - accuracy200: 0.4155 - val_loss: 3.4035 - val_accuracy200: 0.3236 - 133s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 135s - loss: 3.2134 - accuracy200: 0.4161 - val_loss: 3.3611 - val_accuracy200: 0.3259 - 135s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 134s - loss: 3.2110 - accuracy200: 0.4176 - val_loss: 3.3716 - val_accuracy200: 0.3271 - 134s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 135s - loss: 3.2089 - accuracy200: 0.4182 - val_loss: 3.3866 - val_accuracy200: 0.3265 - 135s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 134s - loss: 3.2072 - accuracy200: 0.4191 - val_loss: 3.4187 - val_accuracy200: 0.3232 - 134s/epoch - 15ms/step
Epoch 12/50
9052/9052 - 136s - loss: 3.2050 - accuracy200: 0.4204 - val_loss: 3.4146 - val_accuracy200: 0.3237 - 136s/epoch - 15ms/step
Epoch 13/50
9052/9052 - 134s - loss: 3.2035 - accuracy200: 0.4210 - val_loss: 3.3767 - val_accuracy200: 0.3258 - 134s/epoch - 15ms/step
Epoch 14/50
9052/9052 - 132s - loss: 3.2018 - accuracy200: 0.4217 - val_loss: 3.4132 - val_accuracy200: 0.3223 - 132s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h200
Evaluating performance on  test set...
23942/23942 - 128s - 128s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1128583
{'0': {'precision': 0.2787014813901719, 'recall': 0.5830193632698781, 'f1-score': 0.3771252865226248, 'support': 1714070}, '1': {'precision': 0.44009840439217673, 'recall': 0.16387891097704596, 'f1-score': 0.23882634462996494, 'support': 2713772}, '2': {'precision': 0.2777009421640939, 'recall': 0.2502171968149953, 'f1-score': 0.2632436590853153, 'support': 1701222}, 'accuracy': 0.30506142536609177, 'macro avg': {'precision': 0.3321669426488142, 'recall': 0.3323718236873065, 'f1-score': 0.2930650967459683, 'support': 6129064}, 'weighted avg': {'precision': 0.34988564771405584, 'recall': 0.30506142536609177, 'f1-score': 0.28428081204331085, 'support': 6129064}}
[[ 999336  285053  429681]
 [1591544  444730  677498]
 [ 994806  280741  425675]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1114511
{'0': {'precision': 0.3385241122920122, 'recall': 0.5320398033942787, 'f1-score': 0.4137738743882585, 'support': 787973}, '1': {'precision': 0.3526777041861693, 'recall': 0.12833405800774111, 'f1-score': 0.18818899870818087, 'support': 749762}, '2': {'precision': 0.3474788388251251, 'recall': 0.35929145628701026, 'f1-score': 0.3532864323636878, 'support': 779345}, 'accuracy': 0.3433049355222953, 'macro avg': {'precision': 0.34622688510110217, 'recall': 0.33988843922967665, 'f1-score': 0.31841643515337575, 'support': 2317080}, 'weighted avg': {'precision': 0.3461158427094755, 'recall': 0.3433049355222953, 'f1-score': 0.32043417396173657, 'support': 2317080}}
[[419233  88410 280330]
 [408045  96220 245497]
 [411136  88197 280012]]
Evaluating performance on  val set...
2763/2763 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1059846
{'0': {'precision': 0.32220443749067157, 'recall': 0.5504834008203965, 'f1-score': 0.40648714631466, 'support': 227451}, '1': {'precision': 0.34493947708802175, 'recall': 0.18995936147698592, 'f1-score': 0.24499766345214327, 'support': 242873}, '2': {'precision': 0.33672134338202697, 'recall': 0.26280322881459633, 'f1-score': 0.295205435624957, 'support': 236991}, 'accuracy': 0.33029979570629775, 'macro avg': {'precision': 0.33462175265357336, 'recall': 0.33441533037065957, 'f1-score': 0.3155634151305868, 'support': 707315}, 'weighted avg': {'precision': 0.33487503448949874, 'recall': 0.33029979570629775, 'f1-score': 0.3137502482291798, 'support': 707315}}
[[125208  42829  59414]
 [133467  46136  63270]
 [129923  44786  62282]]
training model: results/AAPL/W7/deepLOB_L1/h300
Epoch 1/50
9052/9052 - 140s - loss: 3.2537 - accuracy300: 0.3918 - val_loss: 3.3035 - val_accuracy300: 0.3349 - 140s/epoch - 16ms/step
Epoch 2/50
9052/9052 - 134s - loss: 3.2315 - accuracy300: 0.4048 - val_loss: 3.3823 - val_accuracy300: 0.3333 - 134s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 134s - loss: 3.2241 - accuracy300: 0.4085 - val_loss: 3.4771 - val_accuracy300: 0.3415 - 134s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 133s - loss: 3.2178 - accuracy300: 0.4118 - val_loss: 3.4012 - val_accuracy300: 0.3393 - 133s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 137s - loss: 3.2122 - accuracy300: 0.4148 - val_loss: 3.3881 - val_accuracy300: 0.3372 - 137s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 133s - loss: 3.2077 - accuracy300: 0.4163 - val_loss: 3.4221 - val_accuracy300: 0.3257 - 133s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 137s - loss: 3.2023 - accuracy300: 0.4189 - val_loss: 3.3383 - val_accuracy300: 0.3350 - 137s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 136s - loss: 3.1983 - accuracy300: 0.4206 - val_loss: 3.4697 - val_accuracy300: 0.3225 - 136s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 132s - loss: 3.1949 - accuracy300: 0.4221 - val_loss: 3.3904 - val_accuracy300: 0.3263 - 132s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 134s - loss: 3.1917 - accuracy300: 0.4234 - val_loss: 3.3544 - val_accuracy300: 0.3323 - 134s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 132s - loss: 3.1888 - accuracy300: 0.4243 - val_loss: 3.3524 - val_accuracy300: 0.3350 - 132s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h300
Evaluating performance on  test set...
23942/23942 - 140s - 140s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1015338
{'0': {'precision': 0.2927153809272434, 'recall': 0.26812327129399816, 'f1-score': 0.2798801586924887, 'support': 1803372}, '1': {'precision': 0.41416604309612287, 'recall': 0.3085176988537728, 'f1-score': 0.3536195631428699, 'support': 2540334}, '2': {'precision': 0.2915869721982365, 'recall': 0.4221646302870349, 'f1-score': 0.3449315024609689, 'support': 1785358}, 'accuracy': 0.32973697125694884, 'macro avg': {'precision': 0.3328227987405343, 'recall': 0.3329352001449353, 'f1-score': 0.32614374143210917, 'support': 6129064}, 'weighted avg': {'precision': 0.34272475150626097, 'recall': 0.32973697125694884, 'f1-score': 0.32939222991133404, 'support': 6129064}}
[[ 483526  557823  762023]
 [ 687462  783738 1069134]
 [ 480876  550767  753715]]
Evaluating performance on  train set...
9052/9052 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1068503
{'0': {'precision': 0.34079258556730735, 'recall': 0.3649103953249511, 'f1-score': 0.3524393703593114, 'support': 777917}, '1': {'precision': 0.33210018830758353, 'recall': 0.25973495714153405, 'f1-score': 0.2914934296823762, 'support': 766593}, '2': {'precision': 0.3314306903213918, 'recall': 0.3794737046481225, 'f1-score': 0.3538288208099671, 'support': 772570}, 'accuracy': 0.33496944430058523, 'macro avg': {'precision': 0.33477448806542753, 'recall': 0.3347063523715359, 'f1-score': 0.33258720695055155, 'support': 2317080}, 'weighted avg': {'precision': 0.3347952741656033, 'recall': 0.33496944430058523, 'f1-score': 0.3327390217452408, 'support': 2317080}}
[[283870 200196 293851]
 [269944 199111 297538]
 [279156 200244 293170]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1008767
{'0': {'precision': 0.318703747761736, 'recall': 0.2261445167595904, 'f1-score': 0.26456211653851053, 'support': 225095}, '1': {'precision': 0.34909935229464106, 'recall': 0.3276120220574809, 'f1-score': 0.3380145481186875, 'support': 246447}, '2': {'precision': 0.33430915384980164, 'recall': 0.44851191612271124, 'f1-score': 0.38308023358595006, 'support': 235773}, 'accuracy': 0.3356213285452733, 'macro avg': {'precision': 0.3340374179687262, 'recall': 0.3340894849799276, 'f1-score': 0.32855229941438263, 'support': 707315}, 'weighted avg': {'precision': 0.334496200855368, 'recall': 0.3356213285452733, 'f1-score': 0.32966112252066254, 'support': 707315}}
[[ 50904  73467 100724]
 [ 55864  80739 109844]
 [ 52954  77072 105747]]
training model: results/AAPL/W7/deepLOB_L1/h500
Epoch 1/50
9052/9052 - 137s - loss: 3.2327 - accuracy500: 0.4039 - val_loss: 3.4014 - val_accuracy500: 0.3238 - 137s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 136s - loss: 3.1997 - accuracy500: 0.4217 - val_loss: 3.4655 - val_accuracy500: 0.3310 - 136s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 136s - loss: 3.1832 - accuracy500: 0.4295 - val_loss: 3.6301 - val_accuracy500: 0.3282 - 136s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 135s - loss: 3.1718 - accuracy500: 0.4334 - val_loss: 3.4348 - val_accuracy500: 0.3447 - 135s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 135s - loss: 3.1645 - accuracy500: 0.4361 - val_loss: 3.6040 - val_accuracy500: 0.3201 - 135s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 134s - loss: 3.1577 - accuracy500: 0.4383 - val_loss: 3.5250 - val_accuracy500: 0.3234 - 134s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 134s - loss: 3.1524 - accuracy500: 0.4404 - val_loss: 3.6833 - val_accuracy500: 0.3169 - 134s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 133s - loss: 3.1471 - accuracy500: 0.4426 - val_loss: 3.7176 - val_accuracy500: 0.3166 - 133s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 134s - loss: 3.1437 - accuracy500: 0.4438 - val_loss: 3.6326 - val_accuracy500: 0.3208 - 134s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 132s - loss: 3.1406 - accuracy500: 0.4449 - val_loss: 3.6908 - val_accuracy500: 0.3184 - 132s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 134s - loss: 3.1369 - accuracy500: 0.4461 - val_loss: 3.6141 - val_accuracy500: 0.3218 - 134s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h500
Evaluating performance on  test set...
23942/23942 - 130s - 130s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1250141
{'0': {'precision': 0.2872512725837488, 'recall': 0.759191443576944, 'f1-score': 0.4168000884028937, 'support': 1768683}, '1': {'precision': 0.4184955342280645, 'recall': 0.1798898379181768, 'f1-score': 0.2516207692435659, 'support': 2606523}, '2': {'precision': 0.2868383875872472, 'recall': 0.05464239408207506, 'f1-score': 0.09179747179791241, 'support': 1753858}, 'accuracy': 0.31122060399434565, 'macro avg': {'precision': 0.3308617314663535, 'recall': 0.3312412251923986, 'f1-score': 0.25340610981479067, 'support': 6129064}, 'weighted avg': {'precision': 0.3429477125197215, 'recall': 0.31122060399434565, 'f1-score': 0.2535529541476946, 'support': 6129064}}
[[1342769  329482   96432]
 [1995795  468887  141841]
 [1335981  322042   95835]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1273875
{'0': {'precision': 0.3297852557124072, 'recall': 0.6452754498461666, 'f1-score': 0.43649042161031515, 'support': 772264}, '1': {'precision': 0.31488574848587714, 'recall': 0.22669726151261843, 'f1-score': 0.26361143371649637, 'support': 777473}, '2': {'precision': 0.3457086363211895, 'recall': 0.11096341531753075, 'f1-score': 0.16800244662799418, 'support': 767343}, 'accuracy': 0.32787862309458454, 'macro avg': {'precision': 0.3301265468398246, 'recall': 0.3276453755587719, 'f1-score': 0.28936810065160185, 'support': 2317080}, 'weighted avg': {'precision': 0.3300591910381417, 'recall': 0.32787862309458454, 'f1-score': 0.2895679530112033, 'support': 2317080}}
[[498323 190479  83462]
 [523534 176251  77688]
 [489196 193000  85147]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1328558
{'0': {'precision': 0.31528167553201897, 'recall': 0.7223397959000664, 'f1-score': 0.43896643896643894, 'support': 223028}, '1': {'precision': 0.34831735252316737, 'recall': 0.2194522102021798, 'f1-score': 0.26926069265166824, 'support': 246810}, '2': {'precision': 0.33481071551006414, 'recall': 0.05757610210673034, 'f1-score': 0.09825557372042469, 'support': 237477}, 'accuracy': 0.323671914210783, 'macro avg': {'precision': 0.3328032478550835, 'recall': 0.33312270273632555, 'f1-score': 0.26882756844617733, 'support': 707315}, 'weighted avg': {'precision': 0.3333658859121912, 'recall': 0.323671914210783, 'f1-score': 0.2653576940734616, 'support': 707315}}
[[161102  48926  13000]
 [178482  54163  14165]
 [171394  52410  13673]]
training model: results/AAPL/W7/deepLOB_L1/h1000
Epoch 1/50
9052/9052 - 137s - loss: 3.1869 - accuracy1000: 0.4266 - val_loss: 3.4885 - val_accuracy1000: 0.3213 - 137s/epoch - 15ms/step
Epoch 2/50
9052/9052 - 135s - loss: 3.1299 - accuracy1000: 0.4535 - val_loss: 3.6006 - val_accuracy1000: 0.3184 - 135s/epoch - 15ms/step
Epoch 3/50
9052/9052 - 135s - loss: 3.1076 - accuracy1000: 0.4616 - val_loss: 3.5304 - val_accuracy1000: 0.3227 - 135s/epoch - 15ms/step
Epoch 4/50
9052/9052 - 134s - loss: 3.0921 - accuracy1000: 0.4667 - val_loss: 3.4756 - val_accuracy1000: 0.3260 - 134s/epoch - 15ms/step
Epoch 5/50
9052/9052 - 136s - loss: 3.0813 - accuracy1000: 0.4693 - val_loss: 3.4926 - val_accuracy1000: 0.3213 - 136s/epoch - 15ms/step
Epoch 6/50
9052/9052 - 136s - loss: 3.0722 - accuracy1000: 0.4720 - val_loss: 3.5629 - val_accuracy1000: 0.3262 - 136s/epoch - 15ms/step
Epoch 7/50
9052/9052 - 134s - loss: 3.0662 - accuracy1000: 0.4732 - val_loss: 3.5561 - val_accuracy1000: 0.3222 - 134s/epoch - 15ms/step
Epoch 8/50
9052/9052 - 135s - loss: 3.0612 - accuracy1000: 0.4747 - val_loss: 3.6085 - val_accuracy1000: 0.3192 - 135s/epoch - 15ms/step
Epoch 9/50
9052/9052 - 134s - loss: 3.0555 - accuracy1000: 0.4767 - val_loss: 3.5517 - val_accuracy1000: 0.3196 - 134s/epoch - 15ms/step
Epoch 10/50
9052/9052 - 133s - loss: 3.0510 - accuracy1000: 0.4777 - val_loss: 3.5313 - val_accuracy1000: 0.3191 - 133s/epoch - 15ms/step
Epoch 11/50
9052/9052 - 136s - loss: 3.0518 - accuracy1000: 0.4773 - val_loss: 3.6137 - val_accuracy1000: 0.3181 - 136s/epoch - 15ms/step
Epoch 12/50
9052/9052 - 136s - loss: 3.0451 - accuracy1000: 0.4792 - val_loss: 3.4041 - val_accuracy1000: 0.3237 - 136s/epoch - 15ms/step
Epoch 13/50
9052/9052 - 134s - loss: 3.0416 - accuracy1000: 0.4799 - val_loss: 3.4322 - val_accuracy1000: 0.3282 - 134s/epoch - 15ms/step
Epoch 14/50
9052/9052 - 133s - loss: 3.0386 - accuracy1000: 0.4811 - val_loss: 3.5104 - val_accuracy1000: 0.3249 - 133s/epoch - 15ms/step
Epoch 15/50
9052/9052 - 132s - loss: 3.0349 - accuracy1000: 0.4821 - val_loss: 3.5158 - val_accuracy1000: 0.3244 - 132s/epoch - 15ms/step
Epoch 16/50
9052/9052 - 135s - loss: 3.0322 - accuracy1000: 0.4826 - val_loss: 3.4670 - val_accuracy1000: 0.3202 - 135s/epoch - 15ms/step
Epoch 17/50
9052/9052 - 136s - loss: 3.0317 - accuracy1000: 0.4829 - val_loss: 3.4494 - val_accuracy1000: 0.3199 - 136s/epoch - 15ms/step
Epoch 18/50
9052/9052 - 134s - loss: 3.0290 - accuracy1000: 0.4834 - val_loss: 3.4955 - val_accuracy1000: 0.3230 - 134s/epoch - 15ms/step
Epoch 19/50
9052/9052 - 132s - loss: 3.0271 - accuracy1000: 0.4838 - val_loss: 3.5143 - val_accuracy1000: 0.3313 - 132s/epoch - 15ms/step
Epoch 20/50
9052/9052 - 133s - loss: 3.0252 - accuracy1000: 0.4844 - val_loss: 3.4323 - val_accuracy1000: 0.3201 - 133s/epoch - 15ms/step
Epoch 21/50
9052/9052 - 133s - loss: 3.0238 - accuracy1000: 0.4846 - val_loss: 3.3844 - val_accuracy1000: 0.3177 - 133s/epoch - 15ms/step
Epoch 22/50
9052/9052 - 136s - loss: 3.0231 - accuracy1000: 0.4849 - val_loss: 3.3836 - val_accuracy1000: 0.3191 - 136s/epoch - 15ms/step
Epoch 23/50
9052/9052 - 136s - loss: 3.0222 - accuracy1000: 0.4849 - val_loss: 3.4142 - val_accuracy1000: 0.3238 - 136s/epoch - 15ms/step
Epoch 24/50
9052/9052 - 135s - loss: 3.0196 - accuracy1000: 0.4859 - val_loss: 3.3964 - val_accuracy1000: 0.3210 - 135s/epoch - 15ms/step
Epoch 25/50
9052/9052 - 135s - loss: 3.0179 - accuracy1000: 0.4863 - val_loss: 3.3981 - val_accuracy1000: 0.3214 - 135s/epoch - 15ms/step
Epoch 26/50
9052/9052 - 135s - loss: 3.0168 - accuracy1000: 0.4866 - val_loss: 3.4480 - val_accuracy1000: 0.3219 - 135s/epoch - 15ms/step
Epoch 27/50
9052/9052 - 134s - loss: 3.0157 - accuracy1000: 0.4867 - val_loss: 3.3987 - val_accuracy1000: 0.3174 - 134s/epoch - 15ms/step
Epoch 28/50
9052/9052 - 133s - loss: 3.0136 - accuracy1000: 0.4873 - val_loss: 3.4202 - val_accuracy1000: 0.3194 - 133s/epoch - 15ms/step
Epoch 29/50
9052/9052 - 134s - loss: 3.0128 - accuracy1000: 0.4872 - val_loss: 3.3989 - val_accuracy1000: 0.3228 - 134s/epoch - 15ms/step
Epoch 30/50
9052/9052 - 136s - loss: 3.0118 - accuracy1000: 0.4877 - val_loss: 3.4092 - val_accuracy1000: 0.3179 - 136s/epoch - 15ms/step
Epoch 31/50
9052/9052 - 135s - loss: 3.0110 - accuracy1000: 0.4879 - val_loss: 3.3899 - val_accuracy1000: 0.3227 - 135s/epoch - 15ms/step
Epoch 32/50
9052/9052 - 133s - loss: 3.0099 - accuracy1000: 0.4880 - val_loss: 3.4101 - val_accuracy1000: 0.3201 - 133s/epoch - 15ms/step
testing model: results/AAPL/W7/deepLOB_L1/h1000
Evaluating performance on  test set...
23942/23942 - 130s - 130s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1319965
{'0': {'precision': 0.29272435249429013, 'recall': 0.8307681251952029, 'f1-score': 0.43291088520820886, 'support': 1809015}, '1': {'precision': 0.3970441731039051, 'recall': 0.12081781067762964, 'f1-score': 0.18526174633031275, 'support': 2520241}, '2': {'precision': 0.29395491174381594, 'recall': 0.03725230691273736, 'f1-score': 0.0661247580001716, 'support': 1799808}, 'accuracy': 0.30582304247434844, 'macro avg': {'precision': 0.3279078124473371, 'recall': 0.32961274759519, 'f1-score': 0.22809912984623107, 'support': 6129064}, 'weighted avg': {'precision': 0.3359815055269175, 'recall': 0.30582304247434844, 'f1-score': 0.2233715298592011, 'support': 6129064}}
[[1502872  236403   69740]
 [2124452  304490   91299]
 [1506762  225999   67047]]
Evaluating performance on  train set...
9052/9052 - 50s - 50s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1511387
{'0': {'precision': 0.33366079711149577, 'recall': 0.7201994346269784, 'f1-score': 0.4560421015991418, 'support': 778601}, '1': {'precision': 0.3416677359631918, 'recall': 0.09750139276494574, 'f1-score': 0.1517095712794467, 'support': 764666}, '2': {'precision': 0.36114517960671805, 'recall': 0.19521253842982736, 'f1-score': 0.25343431021870866, 'support': 773813}, 'accuracy': 0.33937628394358416, 'macro avg': {'precision': 0.34549123756046857, 'recall': 0.3376377886072505, 'f1-score': 0.28706199436576574, 'support': 2317080}, 'weighted avg': {'precision': 0.34548188502203253, 'recall': 0.33937628394358416, 'f1-score': 0.28794549660453345, 'support': 2317080}}
[[560748  71963 145890]
 [568783  74556 121327]
 [551062  71693 151058]]
Evaluating performance on  val set...
2763/2763 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1269039
{'0': {'precision': 0.31449065319016345, 'recall': 0.7871539920706985, 'f1-score': 0.44942363981434313, 'support': 222466}, '1': {'precision': 0.33547343324250684, 'recall': 0.16306646744506575, 'f1-score': 0.21945873381479306, 'support': 241607}, '2': {'precision': 0.3512434198584135, 'recall': 0.04773024395458021, 'f1-score': 0.08404030460086284, 'support': 243242}, 'accuracy': 0.31969207495953006, 'macro avg': {'precision': 0.3337358354303613, 'recall': 0.3326502344901148, 'f1-score': 0.25097422607666636, 'support': 707315}, 'weighted avg': {'precision': 0.3342971086025681, 'recall': 0.31969207495953006, 'f1-score': 0.2452180111088432, 'support': 707315}}
[[175115  37075  10276]
 [191041  39398  11168]
 [190665  40967  11610]]
training model: results/AAPL/W7/deepOF_L1/h10
Epoch 1/50
9052/9052 - 124s - loss: 3.2273 - accuracy10: 0.4046 - val_loss: 3.2773 - val_accuracy10: 0.3699 - 124s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 118s - loss: 3.2192 - accuracy10: 0.4096 - val_loss: 3.2730 - val_accuracy10: 0.3757 - 118s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 117s - loss: 3.2136 - accuracy10: 0.4133 - val_loss: 3.2674 - val_accuracy10: 0.3774 - 117s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 118s - loss: 3.2092 - accuracy10: 0.4155 - val_loss: 3.2683 - val_accuracy10: 0.3768 - 118s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 116s - loss: 3.2054 - accuracy10: 0.4178 - val_loss: 3.2682 - val_accuracy10: 0.3783 - 116s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 117s - loss: 3.2019 - accuracy10: 0.4194 - val_loss: 3.2707 - val_accuracy10: 0.3787 - 117s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 117s - loss: 3.1981 - accuracy10: 0.4215 - val_loss: 3.2701 - val_accuracy10: 0.3805 - 117s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 119s - loss: 3.1935 - accuracy10: 0.4237 - val_loss: 3.2695 - val_accuracy10: 0.3826 - 119s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 117s - loss: 3.1892 - accuracy10: 0.4261 - val_loss: 3.2663 - val_accuracy10: 0.3851 - 117s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 120s - loss: 3.1844 - accuracy10: 0.4283 - val_loss: 3.2710 - val_accuracy10: 0.3861 - 120s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 119s - loss: 3.1805 - accuracy10: 0.4304 - val_loss: 3.2672 - val_accuracy10: 0.3879 - 119s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 119s - loss: 3.1776 - accuracy10: 0.4317 - val_loss: 3.2683 - val_accuracy10: 0.3893 - 119s/epoch - 13ms/step
Epoch 13/50
9052/9052 - 120s - loss: 3.1742 - accuracy10: 0.4333 - val_loss: 3.2707 - val_accuracy10: 0.3899 - 120s/epoch - 13ms/step
Epoch 14/50
9052/9052 - 116s - loss: 3.1709 - accuracy10: 0.4351 - val_loss: 3.2617 - val_accuracy10: 0.3926 - 116s/epoch - 13ms/step
Epoch 15/50
9052/9052 - 115s - loss: 3.1683 - accuracy10: 0.4362 - val_loss: 3.2676 - val_accuracy10: 0.3913 - 115s/epoch - 13ms/step
Epoch 16/50
9052/9052 - 119s - loss: 3.1656 - accuracy10: 0.4375 - val_loss: 3.2625 - val_accuracy10: 0.3934 - 119s/epoch - 13ms/step
Epoch 17/50
9052/9052 - 118s - loss: 3.1622 - accuracy10: 0.4389 - val_loss: 3.2615 - val_accuracy10: 0.3945 - 118s/epoch - 13ms/step
Epoch 18/50
9052/9052 - 117s - loss: 3.1595 - accuracy10: 0.4401 - val_loss: 3.2587 - val_accuracy10: 0.3955 - 117s/epoch - 13ms/step
Epoch 19/50
9052/9052 - 118s - loss: 3.1573 - accuracy10: 0.4414 - val_loss: 3.2592 - val_accuracy10: 0.3962 - 118s/epoch - 13ms/step
Epoch 20/50
9052/9052 - 117s - loss: 3.1544 - accuracy10: 0.4425 - val_loss: 3.2547 - val_accuracy10: 0.3978 - 117s/epoch - 13ms/step
Epoch 21/50
9052/9052 - 116s - loss: 3.1521 - accuracy10: 0.4434 - val_loss: 3.2539 - val_accuracy10: 0.3981 - 116s/epoch - 13ms/step
Epoch 22/50
9052/9052 - 115s - loss: 3.1498 - accuracy10: 0.4443 - val_loss: 3.2577 - val_accuracy10: 0.3973 - 115s/epoch - 13ms/step
Epoch 23/50
9052/9052 - 119s - loss: 3.1476 - accuracy10: 0.4454 - val_loss: 3.2516 - val_accuracy10: 0.3995 - 119s/epoch - 13ms/step
Epoch 24/50
9052/9052 - 118s - loss: 3.1459 - accuracy10: 0.4463 - val_loss: 3.2539 - val_accuracy10: 0.3990 - 118s/epoch - 13ms/step
Epoch 25/50
9052/9052 - 119s - loss: 3.1443 - accuracy10: 0.4469 - val_loss: 3.2523 - val_accuracy10: 0.3994 - 119s/epoch - 13ms/step
Epoch 26/50
9052/9052 - 117s - loss: 3.1424 - accuracy10: 0.4475 - val_loss: 3.2519 - val_accuracy10: 0.4003 - 117s/epoch - 13ms/step
Epoch 27/50
9052/9052 - 119s - loss: 3.1402 - accuracy10: 0.4484 - val_loss: 3.2510 - val_accuracy10: 0.4003 - 119s/epoch - 13ms/step
Epoch 28/50
9052/9052 - 119s - loss: 3.1388 - accuracy10: 0.4494 - val_loss: 3.2507 - val_accuracy10: 0.4008 - 119s/epoch - 13ms/step
Epoch 29/50
9052/9052 - 117s - loss: 3.1371 - accuracy10: 0.4499 - val_loss: 3.2527 - val_accuracy10: 0.4000 - 117s/epoch - 13ms/step
Epoch 30/50
9052/9052 - 117s - loss: 3.1358 - accuracy10: 0.4506 - val_loss: 3.2461 - val_accuracy10: 0.4025 - 117s/epoch - 13ms/step
Epoch 31/50
9052/9052 - 115s - loss: 3.1345 - accuracy10: 0.4505 - val_loss: 3.2519 - val_accuracy10: 0.4003 - 115s/epoch - 13ms/step
Epoch 32/50
9052/9052 - 117s - loss: 3.1328 - accuracy10: 0.4518 - val_loss: 3.2507 - val_accuracy10: 0.4020 - 117s/epoch - 13ms/step
Epoch 33/50
9052/9052 - 120s - loss: 3.1312 - accuracy10: 0.4521 - val_loss: 3.2473 - val_accuracy10: 0.4027 - 120s/epoch - 13ms/step
Epoch 34/50
9052/9052 - 119s - loss: 3.1296 - accuracy10: 0.4527 - val_loss: 3.2498 - val_accuracy10: 0.4021 - 119s/epoch - 13ms/step
Epoch 35/50
9052/9052 - 119s - loss: 3.1284 - accuracy10: 0.4530 - val_loss: 3.2501 - val_accuracy10: 0.4020 - 119s/epoch - 13ms/step
Epoch 36/50
9052/9052 - 122s - loss: 3.1268 - accuracy10: 0.4538 - val_loss: 3.2503 - val_accuracy10: 0.4015 - 122s/epoch - 13ms/step
Epoch 37/50
9052/9052 - 117s - loss: 3.1258 - accuracy10: 0.4544 - val_loss: 3.2465 - val_accuracy10: 0.4030 - 117s/epoch - 13ms/step
Epoch 38/50
9052/9052 - 120s - loss: 3.1243 - accuracy10: 0.4548 - val_loss: 3.2469 - val_accuracy10: 0.4039 - 120s/epoch - 13ms/step
Epoch 39/50
9052/9052 - 119s - loss: 3.1230 - accuracy10: 0.4554 - val_loss: 3.2486 - val_accuracy10: 0.4030 - 119s/epoch - 13ms/step
Epoch 40/50
9052/9052 - 118s - loss: 3.1218 - accuracy10: 0.4558 - val_loss: 3.2483 - val_accuracy10: 0.4033 - 118s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h10
Evaluating performance on  test set...
23942/23942 - 130s - 130s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0984061
{'0': {'precision': 0.3549718767070698, 'recall': 0.5841591061747476, 'f1-score': 0.4415998577281936, 'support': 1878846}, '1': {'precision': 0.4474894236107123, 'recall': 0.14718794980147346, 'f1-score': 0.22151524091518143, 'support': 2382301}, '2': {'precision': 0.37166643074292016, 'recall': 0.448399068050315, 'f1-score': 0.4064428546645428, 'support': 1867912}, 'accuracy': 0.37293832544278005, 'macro avg': {'precision': 0.3913759103535674, 'recall': 0.39324870800884537, 'f1-score': 0.35651931776930595, 'support': 6129059}, 'weighted avg': {'precision': 0.39602036430105575, 'recall': 0.37293832544278005, 'f1-score': 0.34534071083062157, 'support': 6129059}}
[[1097545  208735  572566]
 [1188238  350646  843417]
 [ 806138  224204  837570]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0671104
{'0': {'precision': 0.41050655953124665, 'recall': 0.5831767049120543, 'f1-score': 0.48183937739222416, 'support': 784234}, '1': {'precision': 0.4435366022077267, 'recall': 0.18334860131968508, 'f1-score': 0.25944723273506415, 'support': 753210}, '2': {'precision': 0.4269015817400599, 'recall': 0.4882175482341714, 'f1-score': 0.4555053801143697, 'support': 779634}, 'accuracy': 0.4212538378077907, 'macro avg': {'precision': 0.42698158115967777, 'recall': 0.4182476181553036, 'f1-score': 0.39893066341388606, 'support': 2317078}, 'weighted avg': {'precision': 0.42676008021078243, 'recall': 0.4212538378077907, 'f1-score': 0.4006859302873178, 'support': 2317078}}
[[457347  82116 244771]
 [348899 138100 266211]
 [307858  91145 380631]]
Evaluating performance on  val set...
2763/2763 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0800964
{'0': {'precision': 0.3886926800670493, 'recall': 0.5866737684919503, 'f1-score': 0.467590001146893, 'support': 232804}, '1': {'precision': 0.43417378841764426, 'recall': 0.170081012742456, 'f1-score': 0.2444158242467526, 'support': 240456}, '2': {'precision': 0.4105358070727756, 'recall': 0.4590906372033804, 'f1-score': 0.43345771395147137, 'support': 234054}, 'accuracy': 0.40283240540976145, 'macro avg': {'precision': 0.4111340918524897, 'recall': 0.4052818061459289, 'f1-score': 0.38182117978170566, 'support': 707314}, 'weighted avg': {'precision': 0.4113822869994003, 'recall': 0.40283240540976145, 'f1-score': 0.3804259294221182, 'support': 707314}}
[[136580  24737  71487]
 [116762  40897  82797]
 [ 98041  28561 107452]]
training model: results/AAPL/W7/deepOF_L1/h20
Epoch 1/50
9052/9052 - 125s - loss: 3.2331 - accuracy20: 0.4054 - val_loss: 3.2734 - val_accuracy20: 0.3731 - 125s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 119s - loss: 3.2221 - accuracy20: 0.4109 - val_loss: 3.2723 - val_accuracy20: 0.3768 - 119s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 118s - loss: 3.2179 - accuracy20: 0.4133 - val_loss: 3.2746 - val_accuracy20: 0.3776 - 118s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 116s - loss: 3.2151 - accuracy20: 0.4145 - val_loss: 3.2731 - val_accuracy20: 0.3823 - 116s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 118s - loss: 3.2129 - accuracy20: 0.4154 - val_loss: 3.2730 - val_accuracy20: 0.3819 - 118s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 119s - loss: 3.2110 - accuracy20: 0.4167 - val_loss: 3.2725 - val_accuracy20: 0.3821 - 119s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 121s - loss: 3.2093 - accuracy20: 0.4172 - val_loss: 3.2745 - val_accuracy20: 0.3824 - 121s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 119s - loss: 3.2070 - accuracy20: 0.4185 - val_loss: 3.2725 - val_accuracy20: 0.3832 - 119s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 123s - loss: 3.2055 - accuracy20: 0.4193 - val_loss: 3.2725 - val_accuracy20: 0.3828 - 123s/epoch - 14ms/step
Epoch 10/50
9052/9052 - 123s - loss: 3.2040 - accuracy20: 0.4197 - val_loss: 3.2766 - val_accuracy20: 0.3819 - 123s/epoch - 14ms/step
Epoch 11/50
9052/9052 - 121s - loss: 3.2026 - accuracy20: 0.4207 - val_loss: 3.2770 - val_accuracy20: 0.3818 - 121s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 117s - loss: 3.2014 - accuracy20: 0.4211 - val_loss: 3.2768 - val_accuracy20: 0.3828 - 117s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h20
Evaluating performance on  test set...
23942/23942 - 141s - 141s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.100808
{'0': {'precision': 0.33406321792495886, 'recall': 0.6414177593007142, 'f1-score': 0.43931985494093745, 'support': 1876200}, '1': {'precision': 0.431986858511291, 'recall': 0.01825700666058295, 'f1-score': 0.03503340106639445, 'support': 2391082}, '2': {'precision': 0.3529414674830115, 'recall': 0.4598284327285169, 'f1-score': 0.3993566242927509, 'support': 1861777}, 'accuracy': 0.3431489238396955, 'macro avg': {'precision': 0.3729971813064205, 'recall': 0.3731677328966047, 'f1-score': 0.29123662676669426, 'support': 6129059}, 'weighted avg': {'precision': 0.37799990465091315, 'recall': 0.3431489238396955, 'f1-score': 0.2694594103980249, 'support': 6129059}}
[[1203428   29332  643440]
 [1421357   43654  926071]
 [ 977611   28068  856098]]
Evaluating performance on  train set...
9052/9052 - 46s - 46s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.085273
{'0': {'precision': 0.3770467949271771, 'recall': 0.6393458423128375, 'f1-score': 0.4743507417540377, 'support': 778161}, '1': {'precision': 0.4144338692047242, 'recall': 0.02037494085434506, 'f1-score': 0.0388403609942333, 'support': 762947}, '2': {'precision': 0.39718477981224226, 'recall': 0.4914159052540691, 'f1-score': 0.4393040010091951, 'support': 775970}, 'accuracy': 0.38599606918714, 'macro avg': {'precision': 0.39622181464804784, 'recall': 0.38371222947375055, 'f1-score': 0.31749836791915537, 'support': 2317078}, 'weighted avg': {'precision': 0.39610132321241204, 'recall': 0.38599606918714, 'f1-score': 0.3192128664277319, 'support': 2317078}}
[[497514  10777 269870]
 [438529  15545 308873]
 [383459  11187 381324]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0896733
{'0': {'precision': 0.3647627062650562, 'recall': 0.6525880738931983, 'f1-score': 0.46796011081360767, 'support': 231794}, '1': {'precision': 0.43894086201135984, 'recall': 0.021703127645778524, 'f1-score': 0.04136118030877242, 'support': 242131}, '2': {'precision': 0.3922214897824654, 'recall': 0.4716374807724443, 'f1-score': 0.4282790632526253, 'support': 233389}, 'accuracy': 0.376913223829869, 'macro avg': {'precision': 0.39864168601962713, 'recall': 0.3819762274371404, 'f1-score': 0.31253345145833517, 'support': 707314}, 'weighted avg': {'precision': 0.3992161584169334, 'recall': 0.376913223829869, 'f1-score': 0.3088314272992472, 'support': 707314}}
[[151266   3313  77215]
 [143521   5255  93355]
 [119910   3404 110075]]
training model: results/AAPL/W7/deepOF_L1/h30
Epoch 1/50
9052/9052 - 125s - loss: 3.2497 - accuracy30: 0.3960 - val_loss: 3.2696 - val_accuracy30: 0.3782 - 125s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 117s - loss: 3.2393 - accuracy30: 0.4018 - val_loss: 3.2668 - val_accuracy30: 0.3837 - 117s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 121s - loss: 3.2356 - accuracy30: 0.4040 - val_loss: 3.2647 - val_accuracy30: 0.3847 - 121s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 120s - loss: 3.2329 - accuracy30: 0.4056 - val_loss: 3.2615 - val_accuracy30: 0.3885 - 120s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 120s - loss: 3.2309 - accuracy30: 0.4070 - val_loss: 3.2627 - val_accuracy30: 0.3879 - 120s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 120s - loss: 3.2290 - accuracy30: 0.4078 - val_loss: 3.2608 - val_accuracy30: 0.3890 - 120s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 118s - loss: 3.2276 - accuracy30: 0.4084 - val_loss: 3.2594 - val_accuracy30: 0.3912 - 118s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 117s - loss: 3.2263 - accuracy30: 0.4091 - val_loss: 3.2599 - val_accuracy30: 0.3905 - 117s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 118s - loss: 3.2253 - accuracy30: 0.4096 - val_loss: 3.2609 - val_accuracy30: 0.3896 - 118s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 118s - loss: 3.2239 - accuracy30: 0.4101 - val_loss: 3.2603 - val_accuracy30: 0.3899 - 118s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 117s - loss: 3.2231 - accuracy30: 0.4106 - val_loss: 3.2600 - val_accuracy30: 0.3904 - 117s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 121s - loss: 3.2220 - accuracy30: 0.4109 - val_loss: 3.2588 - val_accuracy30: 0.3918 - 121s/epoch - 13ms/step
Epoch 13/50
9052/9052 - 118s - loss: 3.2213 - accuracy30: 0.4114 - val_loss: 3.2590 - val_accuracy30: 0.3916 - 118s/epoch - 13ms/step
Epoch 14/50
9052/9052 - 118s - loss: 3.2205 - accuracy30: 0.4117 - val_loss: 3.2593 - val_accuracy30: 0.3911 - 118s/epoch - 13ms/step
Epoch 15/50
9052/9052 - 118s - loss: 3.2199 - accuracy30: 0.4120 - val_loss: 3.2586 - val_accuracy30: 0.3910 - 118s/epoch - 13ms/step
Epoch 16/50
9052/9052 - 120s - loss: 3.2186 - accuracy30: 0.4130 - val_loss: 3.2595 - val_accuracy30: 0.3908 - 120s/epoch - 13ms/step
Epoch 17/50
9052/9052 - 117s - loss: 3.2180 - accuracy30: 0.4130 - val_loss: 3.2593 - val_accuracy30: 0.3913 - 117s/epoch - 13ms/step
Epoch 18/50
9052/9052 - 117s - loss: 3.2172 - accuracy30: 0.4133 - val_loss: 3.2591 - val_accuracy30: 0.3908 - 117s/epoch - 13ms/step
Epoch 19/50
9052/9052 - 119s - loss: 3.2162 - accuracy30: 0.4141 - val_loss: 3.2637 - val_accuracy30: 0.3880 - 119s/epoch - 13ms/step
Epoch 20/50
9052/9052 - 122s - loss: 3.2153 - accuracy30: 0.4144 - val_loss: 3.2621 - val_accuracy30: 0.3889 - 122s/epoch - 13ms/step
Epoch 21/50
9052/9052 - 120s - loss: 3.2148 - accuracy30: 0.4144 - val_loss: 3.2618 - val_accuracy30: 0.3893 - 120s/epoch - 13ms/step
Epoch 22/50
9052/9052 - 118s - loss: 3.2138 - accuracy30: 0.4150 - val_loss: 3.2635 - val_accuracy30: 0.3882 - 118s/epoch - 13ms/step
Epoch 23/50
9052/9052 - 118s - loss: 3.2131 - accuracy30: 0.4153 - val_loss: 3.2623 - val_accuracy30: 0.3890 - 118s/epoch - 13ms/step
Epoch 24/50
9052/9052 - 117s - loss: 3.2123 - accuracy30: 0.4158 - val_loss: 3.2646 - val_accuracy30: 0.3871 - 117s/epoch - 13ms/step
Epoch 25/50
9052/9052 - 120s - loss: 3.2118 - accuracy30: 0.4160 - val_loss: 3.2618 - val_accuracy30: 0.3884 - 120s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h30
Evaluating performance on  test set...
23942/23942 - 133s - 133s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0953956
{'0': {'precision': 0.3492589554245958, 'recall': 0.5926034306576172, 'f1-score': 0.43949531955179943, 'support': 1923946}, '1': {'precision': 0.41822565723661376, 'recall': 0.16948995338986003, 'f1-score': 0.2412222710093323, 'support': 2296496}, '2': {'precision': 0.3708690463386586, 'recall': 0.3757888565385303, 'f1-score': 0.37331274285611676, 'support': 1908617}, 'accuracy': 0.3665500691052248, 'macro avg': {'precision': 0.3794512196666227, 'recall': 0.3792940801953359, 'f1-score': 0.35134344447241617, 'support': 6129059}, 'weighted avg': {'precision': 0.38182955749166964, 'recall': 0.3665500691052248, 'f1-score': 0.3445948700911619, 'support': 6129059}}
[[1140137  261465  522344]
 [1212908  389233  694355]
 [ 911401  279979  717237]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0826117
{'0': {'precision': 0.38629289699520597, 'recall': 0.5773732641880241, 'f1-score': 0.46288891289265194, 'support': 771901}, '1': {'precision': 0.3863005348259813, 'recall': 0.22322625764757456, 'f1-score': 0.28294875231494115, 'support': 777861}, '2': {'precision': 0.4175885288913979, 'recall': 0.3884983500930516, 'f1-score': 0.4025185342217247, 'support': 767316}, 'accuracy': 0.39593617478565674, 'macro avg': {'precision': 0.3967273202375284, 'recall': 0.3963659573095501, 'f1-score': 0.38278539980977255, 'support': 2317078}, 'weighted avg': {'precision': 0.39665922055217867, 'recall': 0.39593617478565674, 'f1-score': 0.3824895518321266, 'support': 2317078}}
[[445675 134554 191672]
 [380132 173639 224090]
 [327916 141299 298101]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0862772
{'0': {'precision': 0.37816396020249343, 'recall': 0.6091608801495724, 'f1-score': 0.46664011969080965, 'support': 233733}, '1': {'precision': 0.3968949044585987, 'recall': 0.19757141351322863, 'f1-score': 0.2638167543541109, 'support': 237175}, '2': {'precision': 0.41134415071635394, 'recall': 0.3701724998519496, 'f1-score': 0.3896738283424246, 'support': 236406}, 'accuracy': 0.39127035517464664, 'macro avg': {'precision': 0.39546767179248205, 'recall': 0.3923015978382502, 'f1-score': 0.37337690079578173, 'support': 707314}, 'weighted avg': {'precision': 0.3955346156999973, 'recall': 0.39127035517464664, 'f1-score': 0.3729053360639652, 'support': 707314}}
[[142381  33520  57832]
 [122915  46859  67401]
 [111210  37685  87511]]
training model: results/AAPL/W7/deepOF_L1/h50
Epoch 1/50
9052/9052 - 124s - loss: 3.2513 - accuracy50: 0.3962 - val_loss: 3.2902 - val_accuracy50: 0.3562 - 124s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 120s - loss: 3.2436 - accuracy50: 0.4005 - val_loss: 3.2904 - val_accuracy50: 0.3583 - 120s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 119s - loss: 3.2420 - accuracy50: 0.4012 - val_loss: 3.2884 - val_accuracy50: 0.3598 - 119s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 120s - loss: 3.2406 - accuracy50: 0.4021 - val_loss: 3.2867 - val_accuracy50: 0.3604 - 120s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 118s - loss: 3.2390 - accuracy50: 0.4028 - val_loss: 3.2856 - val_accuracy50: 0.3607 - 118s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 117s - loss: 3.2383 - accuracy50: 0.4031 - val_loss: 3.2866 - val_accuracy50: 0.3601 - 117s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 117s - loss: 3.2373 - accuracy50: 0.4039 - val_loss: 3.2871 - val_accuracy50: 0.3601 - 117s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 119s - loss: 3.2363 - accuracy50: 0.4043 - val_loss: 3.2874 - val_accuracy50: 0.3612 - 119s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 119s - loss: 3.2356 - accuracy50: 0.4045 - val_loss: 3.2884 - val_accuracy50: 0.3611 - 119s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 122s - loss: 3.2348 - accuracy50: 0.4052 - val_loss: 3.2908 - val_accuracy50: 0.3601 - 122s/epoch - 14ms/step
Epoch 11/50
9052/9052 - 118s - loss: 3.2342 - accuracy50: 0.4055 - val_loss: 3.2902 - val_accuracy50: 0.3608 - 118s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 120s - loss: 3.2333 - accuracy50: 0.4062 - val_loss: 3.2925 - val_accuracy50: 0.3608 - 120s/epoch - 13ms/step
Epoch 13/50
9052/9052 - 119s - loss: 3.2324 - accuracy50: 0.4066 - val_loss: 3.2921 - val_accuracy50: 0.3619 - 119s/epoch - 13ms/step
Epoch 14/50
9052/9052 - 120s - loss: 3.2320 - accuracy50: 0.4071 - val_loss: 3.2908 - val_accuracy50: 0.3639 - 120s/epoch - 13ms/step
Epoch 15/50
9052/9052 - 119s - loss: 3.2312 - accuracy50: 0.4073 - val_loss: 3.2923 - val_accuracy50: 0.3645 - 119s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h50
Evaluating performance on  test set...
23942/23942 - 141s - 141s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1092987
{'0': {'precision': 0.28731776831960953, 'recall': 0.6559988950064076, 'f1-score': 0.39961159568370896, 'support': 1614489}, '1': {'precision': 0.4908710801393728, 'recall': 0.013354940055823111, 'f1-score': 0.02600244171397851, 'support': 2900949}, '2': {'precision': 0.30330491915898783, 'recall': 0.4443428785321956, 'f1-score': 0.3605210401696307, 'support': 1613621}, 'accuracy': 0.29610516067800946, 'macro avg': {'precision': 0.3604979225393234, 'recall': 0.3712322378648088, 'f1-score': 0.2620450258557727, 'support': 6129059}, 'weighted avg': {'precision': 0.3878707208519344, 'recall': 0.29610516067800946, 'f1-score': 0.21248687672138242, 'support': 6129059}}
[[1059103   18199  537187]
 [1752434   38742 1109773]
 [ 874636   21984  717001]]
Evaluating performance on  train set...
9052/9052 - 47s - 47s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0892777
{'0': {'precision': 0.3723678632897687, 'recall': 0.6559848641617643, 'f1-score': 0.47506594906144756, 'support': 778021}, '1': {'precision': 0.34028358800475583, 'recall': 0.020026330315886045, 'f1-score': 0.037826499843358403, 'support': 771734}, '2': {'precision': 0.39139762033975806, 'recall': 0.45961088094583374, 'f1-score': 0.4227704066709183, 'support': 767323}, 'accuracy': 0.37913915716259877, 'macro avg': {'precision': 0.3680163572114275, 'recall': 0.378540691807828, 'f1-score': 0.31188761852524144, 'support': 2317078}, 'weighted avg': {'precision': 0.3679836535937917, 'recall': 0.37913915716259877, 'f1-score': 0.31211928883826956, 'support': 2317078}}
[[510370  14396 253255]
 [461151  15455 295128]
 [399086  15567 352670]]
Evaluating performance on  val set...
2763/2763 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0948637
{'0': {'precision': 0.34998445122092725, 'recall': 0.6678076580745438, 'f1-score': 0.4592731552893203, 'support': 225827}, '1': {'precision': 0.3688018522091453, 'recall': 0.01518147883408784, 'f1-score': 0.029162502955916794, 'support': 251820}, '2': {'precision': 0.37723927441119204, 'recall': 0.43699356024156716, 'f1-score': 0.40492381680528855, 'support': 229667}, 'accuracy': 0.36051173877514087, 'macro avg': {'precision': 0.36534185928042157, 'recall': 0.3733275657167329, 'f1-score': 0.2977864916835085, 'support': 707314}, 'weighted avg': {'precision': 0.36553360109565275, 'recall': 0.36051173877514087, 'f1-score': 0.2884965073052428, 'support': 707314}}
[[150809   3017  72001]
 [154315   3823  93682]
 [125778   3526 100363]]
training model: results/AAPL/W7/deepOF_L1/h100
Epoch 1/50
9052/9052 - 126s - loss: 3.2734 - accuracy100: 0.3787 - val_loss: 3.2924 - val_accuracy100: 0.3537 - 126s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 122s - loss: 3.2677 - accuracy100: 0.3821 - val_loss: 3.2912 - val_accuracy100: 0.3551 - 122s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 120s - loss: 3.2667 - accuracy100: 0.3831 - val_loss: 3.2910 - val_accuracy100: 0.3543 - 120s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 120s - loss: 3.2659 - accuracy100: 0.3836 - val_loss: 3.2898 - val_accuracy100: 0.3555 - 120s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 120s - loss: 3.2647 - accuracy100: 0.3846 - val_loss: 3.2912 - val_accuracy100: 0.3544 - 120s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 117s - loss: 3.2642 - accuracy100: 0.3845 - val_loss: 3.2908 - val_accuracy100: 0.3542 - 117s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 118s - loss: 3.2635 - accuracy100: 0.3848 - val_loss: 3.2913 - val_accuracy100: 0.3539 - 118s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 117s - loss: 3.2628 - accuracy100: 0.3856 - val_loss: 3.2918 - val_accuracy100: 0.3535 - 117s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 117s - loss: 3.2623 - accuracy100: 0.3859 - val_loss: 3.2922 - val_accuracy100: 0.3533 - 117s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 121s - loss: 3.2618 - accuracy100: 0.3859 - val_loss: 3.2916 - val_accuracy100: 0.3537 - 121s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 119s - loss: 3.2613 - accuracy100: 0.3864 - val_loss: 3.2915 - val_accuracy100: 0.3533 - 119s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 120s - loss: 3.2609 - accuracy100: 0.3868 - val_loss: 3.2914 - val_accuracy100: 0.3536 - 120s/epoch - 13ms/step
Epoch 13/50
9052/9052 - 117s - loss: 3.2604 - accuracy100: 0.3868 - val_loss: 3.2916 - val_accuracy100: 0.3536 - 117s/epoch - 13ms/step
Epoch 14/50
9052/9052 - 116s - loss: 3.2601 - accuracy100: 0.3872 - val_loss: 3.2919 - val_accuracy100: 0.3534 - 116s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h100
Evaluating performance on  test set...
23942/23942 - 124s - 124s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.097859
{'0': {'precision': 0.31189188472091794, 'recall': 0.6138205646393261, 'f1-score': 0.41361797158096936, 'support': 1800158}, '1': {'precision': 0.4185083466486438, 'recall': 0.08456315496364311, 'f1-score': 0.14069724107927076, 'support': 2533633}, '2': {'precision': 0.32254884284189506, 'recall': 0.3726825187102984, 'f1-score': 0.3458080915366911, 'support': 1795268}, 'accuracy': 0.324403958258519, 'macro avg': {'precision': 0.3509830247371522, 'recall': 0.3570220794377559, 'f1-score': 0.30004110139897705, 'support': 6129059}, 'weighted avg': {'precision': 0.3590865816842299, 'recall': 0.324403958258519, 'f1-score': 0.28093563373587094, 'support': 6129059}}
[[1104974  143887  551297]
 [1465437  214252  853944]
 [ 972400  153803  669065]]
Evaluating performance on  train set...
9052/9052 - 49s - 49s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0934979
{'0': {'precision': 0.36618112240475226, 'recall': 0.5952690238278248, 'f1-score': 0.4534323077118241, 'support': 780600}, '1': {'precision': 0.3278924860579971, 'recall': 0.1062245712267298, 'f1-score': 0.1604647325209012, 'support': 764390}, '2': {'precision': 0.3787225590293957, 'recall': 0.3926547232957901, 'f1-score': 0.38556282387085156, 'support': 772088}, 'accuracy': 0.36642184682604556, 'macro avg': {'precision': 0.3575987224973817, 'recall': 0.36471610611678157, 'f1-score': 0.3331532880345256, 'support': 2317078}, 'weighted avg': {'precision': 0.35772894340324757, 'recall': 0.36642184682604556, 'f1-score': 0.33416886520363126, 'support': 2317078}}
[[464667  81346 234587]
 [420453  81197 262740]
 [383834  85090 303164]]
Evaluating performance on  val set...
2763/2763 - 14s - 14s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0961416
{'0': {'precision': 0.3494026393965393, 'recall': 0.6119679129985364, 'f1-score': 0.4448299430328496, 'support': 230249}, '1': {'precision': 0.3354785919969788, 'recall': 0.08890593985087822, 'f1-score': 0.140561388472252, 'support': 239804}, '2': {'precision': 0.37148060826066887, 'recall': 0.3765347022898833, 'f1-score': 0.37399058084772374, 'support': 237261}, 'accuracy': 0.35565816596306593, 'macro avg': {'precision': 0.3521206132180623, 'recall': 0.3591361850464326, 'f1-score': 0.31979397078427513, 'support': 707314}, 'weighted avg': {'precision': 0.3520877250983182, 'recall': 0.35565816596306593, 'f1-score': 0.31791002575529725, 'support': 707314}}
[[140905  19752  69592]
 [136924  21320  81560]
 [125445  22479  89337]]
training model: results/AAPL/W7/deepOF_L1/h200
Epoch 1/50
9052/9052 - 125s - loss: 3.2697 - accuracy200: 0.3795 - val_loss: 3.3075 - val_accuracy200: 0.3393 - 125s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 120s - loss: 3.2663 - accuracy200: 0.3819 - val_loss: 3.3105 - val_accuracy200: 0.3412 - 120s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 118s - loss: 3.2661 - accuracy200: 0.3829 - val_loss: 3.3082 - val_accuracy200: 0.3417 - 118s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 121s - loss: 3.2660 - accuracy200: 0.3830 - val_loss: 3.3057 - val_accuracy200: 0.3424 - 121s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 120s - loss: 3.2658 - accuracy200: 0.3833 - val_loss: 3.3050 - val_accuracy200: 0.3418 - 120s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 121s - loss: 3.2653 - accuracy200: 0.3840 - val_loss: 3.3043 - val_accuracy200: 0.3425 - 121s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 118s - loss: 3.2647 - accuracy200: 0.3844 - val_loss: 3.3041 - val_accuracy200: 0.3419 - 118s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 117s - loss: 3.2641 - accuracy200: 0.3848 - val_loss: 3.3053 - val_accuracy200: 0.3401 - 117s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 120s - loss: 3.2632 - accuracy200: 0.3854 - val_loss: 3.3052 - val_accuracy200: 0.3412 - 120s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 119s - loss: 3.2628 - accuracy200: 0.3856 - val_loss: 3.3072 - val_accuracy200: 0.3396 - 119s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 117s - loss: 3.2623 - accuracy200: 0.3862 - val_loss: 3.3090 - val_accuracy200: 0.3390 - 117s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 119s - loss: 3.2616 - accuracy200: 0.3864 - val_loss: 3.3097 - val_accuracy200: 0.3382 - 119s/epoch - 13ms/step
Epoch 13/50
9052/9052 - 116s - loss: 3.2613 - accuracy200: 0.3872 - val_loss: 3.3089 - val_accuracy200: 0.3387 - 116s/epoch - 13ms/step
Epoch 14/50
9052/9052 - 120s - loss: 3.2617 - accuracy200: 0.3864 - val_loss: 3.3100 - val_accuracy200: 0.3382 - 120s/epoch - 13ms/step
Epoch 15/50
9052/9052 - 121s - loss: 3.2604 - accuracy200: 0.3875 - val_loss: 3.3099 - val_accuracy200: 0.3374 - 121s/epoch - 13ms/step
Epoch 16/50
9052/9052 - 119s - loss: 3.2599 - accuracy200: 0.3878 - val_loss: 3.3118 - val_accuracy200: 0.3378 - 119s/epoch - 13ms/step
Epoch 17/50
9052/9052 - 118s - loss: 3.2598 - accuracy200: 0.3881 - val_loss: 3.3105 - val_accuracy200: 0.3385 - 118s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h200
Evaluating performance on  test set...
23942/23942 - 127s - 127s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1071208
{'0': {'precision': 0.2892960735689511, 'recall': 0.6562349407782431, 'f1-score': 0.40156523440316955, 'support': 1714066}, '1': {'precision': 0.3161764705882353, 'recall': 4.7535312472823805e-05, 'f1-score': 9.505633377299959e-05, 'support': 2713772}, '2': {'precision': 0.2941165968679159, 'recall': 0.3873482633943503, 'f1-score': 0.33435488658475643, 'support': 1701221}, 'accuracy': 0.2910600142697272, 'macro avg': {'precision': 0.29986304700836747, 'recall': 0.34787691316168873, 'f1-score': 0.24533839244056632, 'support': 6129059}, 'weighted avg': {'precision': 0.30253595986259013, 'recall': 0.2910600142697272, 'f1-score': 0.20515038781648617, 'support': 6129059}}
[[1124830     112  589124]
 [1721243     129  992400]
 [1042089     167  658965]]
Evaluating performance on  train set...
9052/9052 - 50s - 50s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0963477
{'0': {'precision': 0.35695516941951494, 'recall': 0.6813664210009303, 'f1-score': 0.4684815735107081, 'support': 787927}, '1': {'precision': 0.36990595611285265, 'recall': 0.00015742421958277246, 'f1-score': 0.0003147145032711639, 'support': 749567}, '2': {'precision': 0.366537433204428, 'recall': 0.38212687792463673, 'f1-score': 0.374169845979935, 'support': 779584}, 'accuracy': 0.3603180384950356, 'macro avg': {'precision': 0.3644661862455985, 'recall': 0.35455024104838323, 'f1-score': 0.28098871133130476, 'support': 2317078}, 'weighted avg': {'precision': 0.36436867119194677, 'recall': 0.3603180384950356, 'f1-score': 0.2852998498911417, 'support': 2317078}}
[[536867     70 250990]
 [485598    118 263851]
 [481553    131 297900]]
Evaluating performance on  val set...
2763/2763 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0993594
{'0': {'precision': 0.3340077754150826, 'recall': 0.6834799883965225, 'f1-score': 0.44872801145020547, 'support': 227518}, '1': {'precision': 0.4146341463414634, 'recall': 0.00013993497139564554, 'f1-score': 0.0002797755212876257, 'support': 242970}, '2': {'precision': 0.3580041545629847, 'recall': 0.36531461917188146, 'f1-score': 0.3616224440320343, 'support': 236826}, 'accuracy': 0.3422157627305553, 'macro avg': {'precision': 0.36888202543984355, 'recall': 0.3496448475132665, 'f1-score': 0.2702100770011758, 'support': 707314}, 'weighted avg': {'precision': 0.3697383785588968, 'recall': 0.3422157627305553, 'f1-score': 0.2655161267808437, 'support': 707314}}
[[155504     23  71991]
 [159781     34  83155]
 [150285     25  86516]]
training model: results/AAPL/W7/deepOF_L1/h300
Epoch 1/50
9052/9052 - 124s - loss: 3.2799 - accuracy300: 0.3703 - val_loss: 3.3034 - val_accuracy300: 0.3312 - 124s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 120s - loss: 3.2749 - accuracy300: 0.3725 - val_loss: 3.2966 - val_accuracy300: 0.3355 - 120s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 120s - loss: 3.2750 - accuracy300: 0.3730 - val_loss: 3.2995 - val_accuracy300: 0.3318 - 120s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 119s - loss: 3.2746 - accuracy300: 0.3734 - val_loss: 3.3001 - val_accuracy300: 0.3294 - 119s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 118s - loss: 3.2738 - accuracy300: 0.3743 - val_loss: 3.2994 - val_accuracy300: 0.3299 - 118s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 120s - loss: 3.2736 - accuracy300: 0.3747 - val_loss: 3.2992 - val_accuracy300: 0.3314 - 120s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 119s - loss: 3.2725 - accuracy300: 0.3758 - val_loss: 3.3003 - val_accuracy300: 0.3300 - 119s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 117s - loss: 3.2720 - accuracy300: 0.3757 - val_loss: 3.3017 - val_accuracy300: 0.3285 - 117s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 117s - loss: 3.2718 - accuracy300: 0.3761 - val_loss: 3.3015 - val_accuracy300: 0.3285 - 117s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 121s - loss: 3.2715 - accuracy300: 0.3763 - val_loss: 3.3018 - val_accuracy300: 0.3299 - 121s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 118s - loss: 3.2714 - accuracy300: 0.3767 - val_loss: 3.3028 - val_accuracy300: 0.3286 - 118s/epoch - 13ms/step
Epoch 12/50
9052/9052 - 122s - loss: 3.2706 - accuracy300: 0.3773 - val_loss: 3.3028 - val_accuracy300: 0.3284 - 122s/epoch - 14ms/step
testing model: results/AAPL/W7/deepOF_L1/h300
Evaluating performance on  test set...
23942/23942 - 141s - 141s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977645
{'0': {'precision': 0.30141031559378917, 'recall': 0.6430144673583347, 'f1-score': 0.4104322483618536, 'support': 1803370}, '1': {'precision': 0.41473448268171376, 'recall': 0.146401672536632, 'f1-score': 0.21641030027584512, 'support': 2540333}, '2': {'precision': 0.3106739970904523, 'recall': 0.24102363898292553, 'f1-score': 0.2714522318748973, 'support': 1785356}, 'accuracy': 0.3200842086852158, 'macro avg': {'precision': 0.34227293178865176, 'recall': 0.3434799262926307, 'f1-score': 0.2994315935041987, 'support': 6129059}, 'weighted avg': {'precision': 0.35107863999613637, 'recall': 0.3200842086852158, 'f1-score': 0.2895312807317067, 'support': 6129059}}
[[1159593  259552  384225]
 [1597867  371909  570557]
 [1089764  265279  430313]]
Evaluating performance on  train set...
9052/9052 - 48s - 48s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977037
{'0': {'precision': 0.3469788166121427, 'recall': 0.6308694808208243, 'f1-score': 0.44771432637675024, 'support': 777901}, '1': {'precision': 0.3242391726774327, 'recall': 0.17305956207731485, 'f1-score': 0.22566994568984952, 'support': 766528}, '2': {'precision': 0.36156065382464725, 'recall': 0.23097421985921163, 'f1-score': 0.28187772115330695, 'support': 772649}, 'accuracy': 0.34606992082269133, 'macro avg': {'precision': 0.3442595477047408, 'recall': 0.3449677542524503, 'f1-score': 0.3184206644066356, 'support': 2317078}, 'weighted avg': {'precision': 0.3443185989390299, 'recall': 0.34606992082269133, 'f1-score': 0.31895874618978337, 'support': 2317078}}
[[490754 136070 151077]
 [469824 132655 164049]
 [453785 140402 178462]]
Evaluating performance on  val set...
2763/2763 - 15s - 15s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985426
{'0': {'precision': 0.326806626357077, 'recall': 0.6458753498289725, 'f1-score': 0.4340089552238806, 'support': 225110}, '1': {'precision': 0.34080629850912947, 'recall': 0.14867789095899087, 'f1-score': 0.20703574406738937, 'support': 246311}, '2': {'precision': 0.35722397883461315, 'recall': 0.2346784347140441, 'f1-score': 0.2832654920010336, 'support': 235893}, 'accuracy': 0.33559776845926986, 'macro avg': {'precision': 0.34161230123360653, 'recall': 0.3430772251673358, 'f1-score': 0.3081033970974345, 'support': 707314}, 'weighted avg': {'precision': 0.34182614212437085, 'recall': 0.33559776845926986, 'f1-score': 0.3046953457333382, 'support': 707314}}
[[145393  33767  45950]
 [156029  36621  53661]
 [143468  37066  55359]]
training model: results/AAPL/W7/deepOF_L1/h500
Epoch 1/50
9052/9052 - 122s - loss: 3.2815 - accuracy500: 0.3693 - val_loss: 3.2981 - val_accuracy500: 0.3293 - 122s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 119s - loss: 3.2780 - accuracy500: 0.3704 - val_loss: 3.3011 - val_accuracy500: 0.3252 - 119s/epoch - 13ms/step
Epoch 3/50
9052/9052 - 118s - loss: 3.2772 - accuracy500: 0.3715 - val_loss: 3.3022 - val_accuracy500: 0.3249 - 118s/epoch - 13ms/step
Epoch 4/50
9052/9052 - 118s - loss: 3.2764 - accuracy500: 0.3723 - val_loss: 3.3031 - val_accuracy500: 0.3217 - 118s/epoch - 13ms/step
Epoch 5/50
9052/9052 - 122s - loss: 3.2757 - accuracy500: 0.3728 - val_loss: 3.3035 - val_accuracy500: 0.3207 - 122s/epoch - 13ms/step
Epoch 6/50
9052/9052 - 117s - loss: 3.2752 - accuracy500: 0.3739 - val_loss: 3.3054 - val_accuracy500: 0.3193 - 117s/epoch - 13ms/step
Epoch 7/50
9052/9052 - 120s - loss: 3.2741 - accuracy500: 0.3748 - val_loss: 3.3059 - val_accuracy500: 0.3190 - 120s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 119s - loss: 3.2729 - accuracy500: 0.3759 - val_loss: 3.3054 - val_accuracy500: 0.3194 - 119s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 117s - loss: 3.2724 - accuracy500: 0.3764 - val_loss: 3.3065 - val_accuracy500: 0.3180 - 117s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 119s - loss: 3.2721 - accuracy500: 0.3767 - val_loss: 3.3079 - val_accuracy500: 0.3183 - 119s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 119s - loss: 3.2717 - accuracy500: 0.3770 - val_loss: 3.3071 - val_accuracy500: 0.3183 - 119s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h500
Evaluating performance on  test set...
23942/23942 - 137s - 137s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1003534
{'0': {'precision': 0.29354468087135926, 'recall': 0.6611680335978994, 'f1-score': 0.40657751066556874, 'support': 1768682}, '1': {'precision': 0.42470810473798887, 'recall': 0.12257032364992404, 'f1-score': 0.19023812068683704, 'support': 2606520}, '2': {'precision': 0.2974073172815127, 'recall': 0.23623476714464178, 'f1-score': 0.26331487113000757, 'support': 1753857}, 'accuracy': 0.31052075041209426, 'macro avg': {'precision': 0.3385533676302869, 'recall': 0.3399910414641551, 'f1-score': 0.28671016749413775, 'support': 6129059}, 'weighted avg': {'precision': 0.35043018311293495, 'recall': 0.31052075041209426, 'f1-score': 0.2735790960712102, 'support': 6129059}}
[[1169396  215457  383829]
 [1692076  319482  594962]
 [1122235  217300  414322]]
Evaluating performance on  train set...
9052/9052 - 60s - 60s/epoch - 7ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0986422
{'0': {'precision': 0.33913869126658697, 'recall': 0.6766533982166582, 'f1-score': 0.45182345932429374, 'support': 772258}, '1': {'precision': 0.32920066226153366, 'recall': 0.14193695263794906, 'f1-score': 0.19835282656327796, 'support': 777479}, '2': {'precision': 0.3467718713509959, 'recall': 0.19931425533107183, 'f1-score': 0.2531343461443611, 'support': 767341}, 'accuracy': 0.33915388260559204, 'macro avg': {'precision': 0.3383704082930388, 'recall': 0.3393015353952264, 'f1-score': 0.30110354401064426, 'support': 2317078}, 'weighted avg': {'precision': 0.3383319179021731, 'recall': 0.33915388260559204, 'f1-score': 0.3009738129658179, 'support': 2317078}}
[[522551 111605 138102]
 [517125 110353 150001]
 [501142 113257 152942]]
Evaluating performance on  val set...
2763/2763 - 16s - 16s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994037
{'0': {'precision': 0.32084298256909977, 'recall': 0.681189884991529, 'f1-score': 0.4362232047909554, 'support': 223114}, '1': {'precision': 0.3420940938326423, 'recall': 0.12742359813368248, 'f1-score': 0.1856835688294504, 'support': 246689}, '2': {'precision': 0.3522239783246783, 'recall': 0.21017973904366535, 'f1-score': 0.2632640630314921, 'support': 237511}, 'accuracy': 0.32989167470175906, 'macro avg': {'precision': 0.33838701824214007, 'recall': 0.3395977407229589, 'f1-score': 0.2950569455506326, 'support': 707314}, 'weighted avg': {'precision': 0.3387922202052772, 'recall': 0.32989167470175906, 'f1-score': 0.29076436900636804, 'support': 707314}}
[[151983  28883  42248]
 [165695  31434  49560]
 [156021  31570  49920]]
training model: results/AAPL/W7/deepOF_L1/h1000
Epoch 1/50
9052/9052 - 126s - loss: 3.2827 - accuracy1000: 0.3688 - val_loss: 3.2999 - val_accuracy1000: 0.3248 - 126s/epoch - 14ms/step
Epoch 2/50
9052/9052 - 124s - loss: 3.2776 - accuracy1000: 0.3703 - val_loss: 3.3018 - val_accuracy1000: 0.3192 - 124s/epoch - 14ms/step
Epoch 3/50
9052/9052 - 126s - loss: 3.2766 - accuracy1000: 0.3719 - val_loss: 3.3048 - val_accuracy1000: 0.3177 - 126s/epoch - 14ms/step
Epoch 4/50
9052/9052 - 123s - loss: 3.2755 - accuracy1000: 0.3732 - val_loss: 3.3068 - val_accuracy1000: 0.3172 - 123s/epoch - 14ms/step
Epoch 5/50
9052/9052 - 125s - loss: 3.2749 - accuracy1000: 0.3738 - val_loss: 3.3078 - val_accuracy1000: 0.3169 - 125s/epoch - 14ms/step
Epoch 6/50
9052/9052 - 122s - loss: 3.2741 - accuracy1000: 0.3749 - val_loss: 3.3094 - val_accuracy1000: 0.3159 - 122s/epoch - 14ms/step
Epoch 7/50
9052/9052 - 121s - loss: 3.2734 - accuracy1000: 0.3755 - val_loss: 3.3129 - val_accuracy1000: 0.3155 - 121s/epoch - 13ms/step
Epoch 8/50
9052/9052 - 121s - loss: 3.2728 - accuracy1000: 0.3762 - val_loss: 3.3160 - val_accuracy1000: 0.3154 - 121s/epoch - 13ms/step
Epoch 9/50
9052/9052 - 122s - loss: 3.2721 - accuracy1000: 0.3768 - val_loss: 3.3187 - val_accuracy1000: 0.3148 - 122s/epoch - 13ms/step
Epoch 10/50
9052/9052 - 121s - loss: 3.2714 - accuracy1000: 0.3773 - val_loss: 3.3202 - val_accuracy1000: 0.3149 - 121s/epoch - 13ms/step
Epoch 11/50
9052/9052 - 118s - loss: 3.2706 - accuracy1000: 0.3782 - val_loss: 3.3229 - val_accuracy1000: 0.3149 - 118s/epoch - 13ms/step
testing model: results/AAPL/W7/deepOF_L1/h1000
Evaluating performance on  test set...
23942/23942 - 170s - 170s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0985897
{'0': {'precision': 0.29569296637823655, 'recall': 0.6212243914222839, 'f1-score': 0.40067227765609126, 'support': 1809013}, '1': {'precision': 0.4126744278413755, 'recall': 0.27828075035740657, 'f1-score': 0.33240752238772014, 'support': 2520239}, '2': {'precision': 0.3057790143084261, 'recall': 0.10686423599863763, 'f1-score': 0.15837816672959193, 'support': 1799807}, 'accuracy': 0.3291650480114484, 'macro avg': {'precision': 0.33804880284267935, 'recall': 0.3354564592594427, 'f1-score': 0.29715265559113446, 'support': 6129059}, 'weighted avg': {'precision': 0.3467569520771, 'recall': 0.3291650480114484, 'f1-score': 0.3014521305736282, 'support': 6129059}}
[[1123803  505087  180123]
 [1562363  701334  256542]
 [1114408  493064  192335]]
Evaluating performance on  train set...
9052/9052 - 62s - 62s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0989629
{'0': {'precision': 0.3376287131102881, 'recall': 0.6287324479104457, 'f1-score': 0.4393349729711053, 'support': 778611}, '1': {'precision': 0.32418008971236223, 'recall': 0.277979184485929, 'f1-score': 0.2993072458604789, 'support': 764622}, '2': {'precision': 0.3439103155127496, 'recall': 0.09399298309092906, 'f1-score': 0.14763604920931006, 'support': 773845}, 'accuracy': 0.33439659778393305, 'macro avg': {'precision': 0.3352397061118, 'recall': 0.3335682051624345, 'f1-score': 0.29542608934696474, 'support': 2317078}, 'weighted avg': {'precision': 0.33528864225007704, 'recall': 0.33439659778393305, 'f1-score': 0.29570664694270754, 'support': 2317078}}
[[489538 221444  67629]
 [480941 212549  71132]
 [479451 221658  72736]]
Evaluating performance on  val set...
2763/2763 - 20s - 20s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0996231
{'0': {'precision': 0.3152160496548319, 'recall': 0.6429136583918504, 'f1-score': 0.4230256132660094, 'support': 222442}, '1': {'precision': 0.33861211321947443, 'recall': 0.2570822145082479, 'f1-score': 0.29226785575695147, 'support': 241697}, '2': {'precision': 0.35507701083856247, 'recall': 0.10238716973373085, 'f1-score': 0.15894284939114892, 'support': 243175}, 'accuracy': 0.32523744758339296, 'macro avg': {'precision': 0.3363017245709563, 'recall': 0.33412768087794303, 'f1-score': 0.2914121061380366, 'support': 707314}, 'weighted avg': {'precision': 0.3369149664177365, 'recall': 0.32523744758339296, 'f1-score': 0.28755242339286113, 'support': 707314}}
[[143011  58198  21233]
 [155572  62136  23989]
 [155109  63168  24898]]
training model: results/AAPL/W7/deepLOB_L2/h10
Epoch 1/50
9052/9052 - 370s - loss: 3.1252 - accuracy10: 0.4556 - val_loss: 3.4393 - val_accuracy10: 0.3663 - 370s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 370s - loss: 3.0470 - accuracy10: 0.4846 - val_loss: 3.4078 - val_accuracy10: 0.3822 - 370s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 372s - loss: 3.0101 - accuracy10: 0.4957 - val_loss: 3.3099 - val_accuracy10: 0.4173 - 372s/epoch - 41ms/step
Epoch 4/50
9052/9052 - 375s - loss: 2.9847 - accuracy10: 0.5026 - val_loss: 3.3250 - val_accuracy10: 0.4189 - 375s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 373s - loss: 2.9678 - accuracy10: 0.5074 - val_loss: 3.3087 - val_accuracy10: 0.4249 - 373s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 374s - loss: 2.9560 - accuracy10: 0.5104 - val_loss: 3.4037 - val_accuracy10: 0.4055 - 374s/epoch - 41ms/step
Epoch 7/50
9052/9052 - 376s - loss: 2.9468 - accuracy10: 0.5130 - val_loss: 3.2893 - val_accuracy10: 0.4265 - 376s/epoch - 42ms/step
Epoch 8/50
9052/9052 - 374s - loss: 2.9397 - accuracy10: 0.5150 - val_loss: 3.3250 - val_accuracy10: 0.4190 - 374s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 375s - loss: 2.9338 - accuracy10: 0.5167 - val_loss: 3.2583 - val_accuracy10: 0.4350 - 375s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 374s - loss: 2.9286 - accuracy10: 0.5182 - val_loss: 3.2688 - val_accuracy10: 0.4347 - 374s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 371s - loss: 2.9240 - accuracy10: 0.5194 - val_loss: 3.3454 - val_accuracy10: 0.4203 - 371s/epoch - 41ms/step
Epoch 12/50
9052/9052 - 375s - loss: 2.9202 - accuracy10: 0.5202 - val_loss: 3.3839 - val_accuracy10: 0.4145 - 375s/epoch - 41ms/step
Epoch 13/50
9052/9052 - 369s - loss: 2.9166 - accuracy10: 0.5213 - val_loss: 3.2942 - val_accuracy10: 0.4257 - 369s/epoch - 41ms/step
Epoch 14/50
9052/9052 - 372s - loss: 2.9131 - accuracy10: 0.5221 - val_loss: 3.3023 - val_accuracy10: 0.4284 - 372s/epoch - 41ms/step
Epoch 15/50
9052/9052 - 371s - loss: 2.9097 - accuracy10: 0.5231 - val_loss: 3.2925 - val_accuracy10: 0.4285 - 371s/epoch - 41ms/step
Epoch 16/50
9052/9052 - 371s - loss: 2.9066 - accuracy10: 0.5241 - val_loss: 3.4532 - val_accuracy10: 0.4052 - 371s/epoch - 41ms/step
Epoch 17/50
9052/9052 - 373s - loss: 2.9043 - accuracy10: 0.5247 - val_loss: 3.3468 - val_accuracy10: 0.4213 - 373s/epoch - 41ms/step
Epoch 18/50
9052/9052 - 374s - loss: 2.9016 - accuracy10: 0.5252 - val_loss: 3.3432 - val_accuracy10: 0.4225 - 374s/epoch - 41ms/step
Epoch 19/50
9052/9052 - 373s - loss: 2.8991 - accuracy10: 0.5259 - val_loss: 3.3580 - val_accuracy10: 0.4195 - 373s/epoch - 41ms/step
testing model: results/AAPL/W7/deepLOB_L2/h10
Evaluating performance on  test set...
23942/23942 - 323s - 323s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.1292583
{'0': {'precision': 0.36289891617255304, 'recall': 0.8631098081857563, 'f1-score': 0.5109614763833769, 'support': 1878849}, '1': {'precision': 0.5814979468558048, 'recall': 0.057540983468930475, 'f1-score': 0.10471964119695744, 'support': 2382302}, '2': {'precision': 0.4964800101072491, 'recall': 0.3786819835827472, 'f1-score': 0.4296531074067471, 'support': 1867913}, 'accuracy': 0.40235801094588014, 'macro avg': {'precision': 0.4802922910452023, 'recall': 0.43311092507914467, 'f1-score': 0.34844474166236045, 'support': 6129064}, 'weighted avg': {'precision': 0.48857663301636667, 'recall': 0.40235801094588014, 'f1-score': 0.32827979841941357, 'support': 6129064}}
[[1621653   26795  230401]
 [1758248  137080  486974]
 [1088707   71861  707345]]
Evaluating performance on  train set...
9052/9052 - 128s - 128s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0605434
{'0': {'precision': 0.4229075922667108, 'recall': 0.7590827885126683, 'f1-score': 0.5431886411957405, 'support': 784203}, '1': {'precision': 0.6060531957384719, 'recall': 0.09865714816485761, 'f1-score': 0.16969093882339248, 'support': 753620}, '2': {'precision': 0.491639807631694, 'recall': 0.49641389169426775, 'f1-score': 0.49401531593831993, 'support': 779257}, 'accuracy': 0.45594411932259565, 'macro avg': {'precision': 0.5068668652122922, 'recall': 0.4513846094572645, 'f1-score': 0.4022982986524843, 'support': 2317080}, 'weighted avg': {'precision': 0.5055902142033981, 'recall': 0.45594411932259565, 'f1-score': 0.4051726916463202, 'support': 2317080}}
[[595275  19038 169890]
 [449170  74350 230100]
 [363132  29291 386834]]
Evaluating performance on  val set...
2763/2763 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0804343
{'0': {'precision': 0.3959699554934913, 'recall': 0.8132330969104742, 'f1-score': 0.5326084358607737, 'support': 232916}, '1': {'precision': 0.5739953928845661, 'recall': 0.09320051034614601, 'f1-score': 0.1603626859641533, 'support': 240621}, '2': {'precision': 0.5048765588136165, 'recall': 0.41008991436319925, 'f1-score': 0.4525734894940826, 'support': 233778}, 'accuracy': 0.43504096477524157, 'macro avg': {'precision': 0.49161396906389127, 'recall': 0.43884117387327315, 'f1-score': 0.38184820377300316, 'support': 707315}, 'weighted avg': {'precision': 0.49252753829811163, 'recall': 0.43504096477524157, 'f1-score': 0.3795216862830226, 'support': 707315}}
[[189415   5243  38258]
 [162435  22426  55760]
 [126507  11401  95870]]
training model: results/AAPL/W7/deepLOB_L2/h20
Epoch 1/50
9052/9052 - 374s - loss: 3.2075 - accuracy20: 0.4162 - val_loss: 3.5506 - val_accuracy20: 0.3278 - 374s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 370s - loss: 3.1525 - accuracy20: 0.4416 - val_loss: 3.8663 - val_accuracy20: 0.3290 - 370s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 372s - loss: 3.1258 - accuracy20: 0.4518 - val_loss: 3.6484 - val_accuracy20: 0.3398 - 372s/epoch - 41ms/step
Epoch 4/50
9052/9052 - 370s - loss: 3.1099 - accuracy20: 0.4578 - val_loss: 3.9176 - val_accuracy20: 0.3354 - 370s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 374s - loss: 3.0983 - accuracy20: 0.4616 - val_loss: 3.9909 - val_accuracy20: 0.3356 - 374s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 371s - loss: 3.0891 - accuracy20: 0.4652 - val_loss: 3.9676 - val_accuracy20: 0.3356 - 371s/epoch - 41ms/step
Epoch 7/50
9052/9052 - 373s - loss: 3.0806 - accuracy20: 0.4679 - val_loss: 4.1042 - val_accuracy20: 0.3373 - 373s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 373s - loss: 3.0739 - accuracy20: 0.4699 - val_loss: 4.0142 - val_accuracy20: 0.3509 - 373s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 371s - loss: 3.0685 - accuracy20: 0.4717 - val_loss: 3.8017 - val_accuracy20: 0.3639 - 371s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 372s - loss: 3.0641 - accuracy20: 0.4732 - val_loss: 3.7750 - val_accuracy20: 0.3706 - 372s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 372s - loss: 3.0596 - accuracy20: 0.4748 - val_loss: 3.6513 - val_accuracy20: 0.3787 - 372s/epoch - 41ms/step
testing model: results/AAPL/W7/deepLOB_L2/h20
Evaluating performance on  test set...
23942/23942 - 322s - 322s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1904354
{'0': {'precision': 0.30689917717592735, 'recall': 0.9951359207932191, 'f1-score': 0.4691216016311794, 'support': 1876203}, '1': {'precision': 0.40350877192982454, 'recall': 7.695257755586067e-05, 'f1-score': 0.00015387580967736675, 'support': 2391083}, '2': {'precision': 0.43571651159684816, 'recall': 0.010514142932186329, 'f1-score': 0.020532814742088963, 'support': 1861778}, 'accuracy': 0.3078505951316547, 'macro avg': {'precision': 0.38204148690086664, 'recall': 0.33524233876765375, 'f1-score': 0.16326943072764857, 'support': 6129064}, 'weighted avg': {'precision': 0.38371854778397546, 'recall': 0.3078505951316547, 'f1-score': 0.1499026325949201, 'support': 6129064}}
[[1867077      86    9040]
 [2374588     184   16311]
 [1842017     186   19575]]
Evaluating performance on  train set...
9052/9052 - 129s - 129s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1392217
{'0': {'precision': 0.3407646607473132, 'recall': 0.7739624255297836, 'f1-score': 0.4731903380003894, 'support': 778667}, '1': {'precision': 0.4286979627989371, 'recall': 0.0006346974958298801, 'f1-score': 0.0012675184006222364, 'support': 762568}, '2': {'precision': 0.40844753946825185, 'recall': 0.28818256223859146, 'f1-score': 0.33793388535927155, 'support': 775845}, 'accuracy': 0.35679734838676264, 'macro avg': {'precision': 0.39263672100483404, 'recall': 0.35425989508806827, 'f1-score': 0.27079724725342774, 'support': 2317080}, 'weighted avg': {'precision': 0.39236691242621485, 'recall': 0.35679734838676264, 'f1-score': 0.2725881649222465, 'support': 2317080}}
[[602659    263 175745]
 [614012    484 148072]
 [551878    382 223585]]
Evaluating performance on  val set...
2763/2763 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1816573
{'0': {'precision': 0.3275799307948675, 'recall': 0.9986312253339896, 'f1-score': 0.4933325227626382, 'support': 231594}, '1': {'precision': 0.3225806451612903, 'recall': 4.120720631624058e-05, 'f1-score': 8.240388616727165e-05, 'support': 242676}, '2': {'precision': 0.44277821625887925, 'recall': 0.0024072604003518632, 'f1-score': 0.004788487145344669, 'support': 233045}, 'accuracy': 0.327786064200533, 'macro avg': {'precision': 0.3643129307383457, 'recall': 0.33369323098021925, 'f1-score': 0.16606780459805007, 'support': 707315}, 'weighted avg': {'precision': 0.3638200470027051, 'recall': 0.327786064200533, 'f1-score': 0.1631363433674626, 'support': 707315}}
[[231277      7    310]
 [242270     10    396]
 [232470     14    561]]
training model: results/AAPL/W7/deepLOB_L2/h30
Epoch 1/50
9052/9052 - 373s - loss: 3.2461 - accuracy30: 0.3934 - val_loss: 3.5398 - val_accuracy30: 0.3308 - 373s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 371s - loss: 3.2167 - accuracy30: 0.4102 - val_loss: 3.7069 - val_accuracy30: 0.3309 - 371s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 368s - loss: 3.1948 - accuracy30: 0.4199 - val_loss: 3.8175 - val_accuracy30: 0.3309 - 368s/epoch - 41ms/step
Epoch 4/50
9052/9052 - 370s - loss: 3.1819 - accuracy30: 0.4257 - val_loss: 3.8821 - val_accuracy30: 0.3314 - 370s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 370s - loss: 3.1724 - accuracy30: 0.4297 - val_loss: 3.5613 - val_accuracy30: 0.3434 - 370s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 366s - loss: 3.1656 - accuracy30: 0.4326 - val_loss: 3.4037 - val_accuracy30: 0.3445 - 366s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 366s - loss: 3.1603 - accuracy30: 0.4348 - val_loss: 3.4039 - val_accuracy30: 0.3484 - 366s/epoch - 40ms/step
Epoch 8/50
9052/9052 - 372s - loss: 3.1552 - accuracy30: 0.4371 - val_loss: 3.3885 - val_accuracy30: 0.3551 - 372s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 367s - loss: 3.1510 - accuracy30: 0.4388 - val_loss: 3.4579 - val_accuracy30: 0.3522 - 367s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 364s - loss: 3.1471 - accuracy30: 0.4403 - val_loss: 3.4167 - val_accuracy30: 0.3555 - 364s/epoch - 40ms/step
Epoch 11/50
9052/9052 - 363s - loss: 3.1438 - accuracy30: 0.4421 - val_loss: 3.3515 - val_accuracy30: 0.3619 - 363s/epoch - 40ms/step
Epoch 12/50
9052/9052 - 364s - loss: 3.1407 - accuracy30: 0.4438 - val_loss: 3.3588 - val_accuracy30: 0.3618 - 364s/epoch - 40ms/step
Epoch 13/50
9052/9052 - 365s - loss: 3.1381 - accuracy30: 0.4446 - val_loss: 3.3654 - val_accuracy30: 0.3637 - 365s/epoch - 40ms/step
Epoch 14/50
9052/9052 - 365s - loss: 3.1355 - accuracy30: 0.4457 - val_loss: 3.3314 - val_accuracy30: 0.3736 - 365s/epoch - 40ms/step
Epoch 15/50
9052/9052 - 371s - loss: 3.1333 - accuracy30: 0.4466 - val_loss: 3.3200 - val_accuracy30: 0.3759 - 371s/epoch - 41ms/step
Epoch 16/50
9052/9052 - 372s - loss: 3.1311 - accuracy30: 0.4477 - val_loss: 3.3459 - val_accuracy30: 0.3762 - 372s/epoch - 41ms/step
Epoch 17/50
9052/9052 - 371s - loss: 3.1289 - accuracy30: 0.4484 - val_loss: 3.3406 - val_accuracy30: 0.3768 - 371s/epoch - 41ms/step
Epoch 18/50
9052/9052 - 363s - loss: 3.1272 - accuracy30: 0.4490 - val_loss: 3.3411 - val_accuracy30: 0.3849 - 363s/epoch - 40ms/step
Epoch 19/50
9052/9052 - 364s - loss: 3.1253 - accuracy30: 0.4496 - val_loss: 3.3546 - val_accuracy30: 0.3851 - 364s/epoch - 40ms/step
Epoch 20/50
9052/9052 - 359s - loss: 3.1237 - accuracy30: 0.4505 - val_loss: 3.3737 - val_accuracy30: 0.3816 - 359s/epoch - 40ms/step
Epoch 21/50
9052/9052 - 364s - loss: 3.1222 - accuracy30: 0.4510 - val_loss: 3.3292 - val_accuracy30: 0.3871 - 364s/epoch - 40ms/step
Epoch 22/50
9052/9052 - 367s - loss: 3.1205 - accuracy30: 0.4518 - val_loss: 3.3552 - val_accuracy30: 0.3835 - 367s/epoch - 41ms/step
Epoch 23/50
9052/9052 - 367s - loss: 3.1192 - accuracy30: 0.4524 - val_loss: 3.3566 - val_accuracy30: 0.3849 - 367s/epoch - 41ms/step
Epoch 24/50
9052/9052 - 368s - loss: 3.1175 - accuracy30: 0.4529 - val_loss: 3.3832 - val_accuracy30: 0.3844 - 368s/epoch - 41ms/step
Epoch 25/50
9052/9052 - 363s - loss: 3.1166 - accuracy30: 0.4532 - val_loss: 3.3379 - val_accuracy30: 0.3882 - 363s/epoch - 40ms/step
testing model: results/AAPL/W7/deepLOB_L2/h30
Evaluating performance on  test set...
23942/23942 - 338s - 338s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1062448
{'0': {'precision': 0.3394342882156448, 'recall': 0.9044215829005863, 'f1-score': 0.4936129713537216, 'support': 1923949}, '1': {'precision': 0.42208608749527987, 'recall': 0.05013372535051196, 'f1-score': 0.0896224487373247, 'support': 2296498}, '2': {'precision': 0.4622783547666312, 'recall': 0.17679555405825265, 'f1-score': 0.2557724755510211, 'support': 1908617}, 'accuracy': 0.35774271569035665, 'macro avg': {'precision': 0.4079329101591853, 'recall': 0.37711695410311696, 'f1-score': 0.27966929854735584, 'support': 6129064}, 'weighted avg': {'precision': 0.4086572504021104, 'recall': 0.35774271569035665, 'f1-score': 0.2681772701136998, 'support': 6129064}}
[[1740061   54597  129291]
 [1918153  115132  263213]
 [1468142  103040  337435]]
Evaluating performance on  train set...
9052/9052 - 121s - 121s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0948553
{'0': {'precision': 0.3722182910838428, 'recall': 0.7186542124817247, 'f1-score': 0.49042622666870506, 'support': 772217}, '1': {'precision': 0.42650000961852913, 'recall': 0.11406848508078934, 'f1-score': 0.1799964683890374, 'support': 777454}, '2': {'precision': 0.4221817105384477, 'recall': 0.34009765327224467, 'f1-score': 0.3767201785203939, 'support': 767409}, 'accuracy': 0.39041983876258046, 'macro avg': {'precision': 0.40696667041360657, 'recall': 0.3909401169449196, 'f1-score': 0.34904762452604543, 'support': 2317080}, 'weighted avg': {'precision': 0.4069792475298459, 'recall': 0.39041983876258046, 'f1-score': 0.348608118533894, 'support': 2317080}}
[[554957  45602 171658]
 [503220  88683 185551]
 [432768  73647 260994]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1061802
{'0': {'precision': 0.36174548570598974, 'recall': 0.8743169398907104, 'f1-score': 0.5117544219970245, 'support': 233691}, '1': {'precision': 0.3953668209586726, 'recall': 0.1507140059714566, 'f1-score': 0.21823625542709402, 'support': 237463}, '2': {'precision': 0.49544991053735304, 'recall': 0.1090442537082753, 'f1-score': 0.17874768340170338, 'support': 236161}, 'accuracy': 0.3758735499741982, 'macro avg': {'precision': 0.4175207390673385, 'recall': 0.3780250665234807, 'f1-score': 0.3029127869419406, 'support': 707315}, 'weighted avg': {'precision': 0.41767473053425924, 'recall': 0.3758735499741982, 'f1-score': 0.3020276258996633, 'support': 707315}}
[[204320  19536   9835]
 [185284  35789  16390]
 [175213  35196  25752]]
training model: results/AAPL/W7/deepLOB_L2/h50
Epoch 1/50
9052/9052 - 369s - loss: 3.2547 - accuracy50: 0.3892 - val_loss: 3.3619 - val_accuracy50: 0.3194 - 369s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 366s - loss: 3.2365 - accuracy50: 0.4010 - val_loss: 3.4790 - val_accuracy50: 0.3198 - 366s/epoch - 40ms/step
Epoch 3/50
9052/9052 - 366s - loss: 3.2198 - accuracy50: 0.4102 - val_loss: 3.4655 - val_accuracy50: 0.3228 - 366s/epoch - 40ms/step
Epoch 4/50
9052/9052 - 365s - loss: 3.2100 - accuracy50: 0.4150 - val_loss: 3.4612 - val_accuracy50: 0.3274 - 365s/epoch - 40ms/step
Epoch 5/50
9052/9052 - 365s - loss: 3.2032 - accuracy50: 0.4184 - val_loss: 3.4330 - val_accuracy50: 0.3301 - 365s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 362s - loss: 3.1983 - accuracy50: 0.4208 - val_loss: 3.4719 - val_accuracy50: 0.3304 - 362s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 367s - loss: 3.1943 - accuracy50: 0.4226 - val_loss: 3.5003 - val_accuracy50: 0.3402 - 367s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 364s - loss: 3.1914 - accuracy50: 0.4237 - val_loss: 3.5169 - val_accuracy50: 0.3482 - 364s/epoch - 40ms/step
Epoch 9/50
9052/9052 - 362s - loss: 3.1889 - accuracy50: 0.4248 - val_loss: 3.4753 - val_accuracy50: 0.3565 - 362s/epoch - 40ms/step
Epoch 10/50
9052/9052 - 368s - loss: 3.1864 - accuracy50: 0.4259 - val_loss: 3.4558 - val_accuracy50: 0.3540 - 368s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 368s - loss: 3.1843 - accuracy50: 0.4271 - val_loss: 3.4286 - val_accuracy50: 0.3525 - 368s/epoch - 41ms/step
testing model: results/AAPL/W7/deepLOB_L2/h50
Evaluating performance on  test set...
23942/23942 - 322s - 322s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1238188
{'0': {'precision': 0.26367000999114903, 'recall': 0.9969377364520853, 'f1-score': 0.4170410402007023, 'support': 1614492}, '1': {'precision': 0.4974588938714499, 'recall': 0.0005736050005670554, 'f1-score': 0.001145888711068018, 'support': 2900951}, '2': {'precision': 0.3429817977106399, 'recall': 0.004530803701736653, 'f1-score': 0.00894346387658974, 'support': 1613621}, 'accuracy': 0.26407343764072294, 'macro avg': {'precision': 0.368036900524413, 'recall': 0.33401404838479637, 'f1-score': 0.14237679759612, 'support': 6129064}, 'weighted avg': {'precision': 0.39520547163637826, 'recall': 0.26407343764072294, 'f1-score': 0.11275211862724559, 'support': 6129064}}
[[1609548     777    4167]
 [2889449    1664    9838]
 [1605406     904    7311]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.109637
{'0': {'precision': 0.3358480530892023, 'recall': 0.8535517328221127, 'f1-score': 0.48203083786429396, 'support': 778268}, '1': {'precision': 0.3565700185070944, 'recall': 0.0007496446321294058, 'f1-score': 0.0014961438058222773, 'support': 771032}, '2': {'precision': 0.38572465593102323, 'recall': 0.16955898825184298, 'f1-score': 0.23556639237843635, 'support': 767780}, 'accuracy': 0.34312755709772647, 'macro avg': {'precision': 0.3593809091757733, 'recall': 0.34128678856869504, 'f1-score': 0.23969779134951752, 'support': 2317080}, 'weighted avg': {'precision': 0.3592704453113014, 'recall': 0.34312755709772647, 'f1-score': 0.24046037064502518, 'support': 2317080}}
[[664292    550 113426]
 [676559    578  93895]
 [637103    493 130184]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1193321
{'0': {'precision': 0.3192784312836562, 'recall': 0.9981132827551387, 'f1-score': 0.4837984629255936, 'support': 225789}, '1': {'precision': 0.3961352657004831, 'recall': 0.0009777657654793039, 'f1-score': 0.0019507166504767754, 'support': 251594}, '2': {'precision': 0.37841043890865955, 'recall': 0.0013873666997199171, 'f1-score': 0.0027645975517278736, 'support': 229932}, 'accuracy': 0.3194163844962994, 'macro avg': {'precision': 0.36460804529759966, 'recall': 0.333492805073446, 'f1-score': 0.16283792570926608, 'support': 707315}, 'weighted avg': {'precision': 0.3658390996923559, 'recall': 0.3194163844962994, 'f1-score': 0.15603066412380737, 'support': 707315}}
[[225363    172    254]
 [251078    246    270]
 [229410    203    319]]
training model: results/AAPL/W7/deepLOB_L2/h100
Epoch 1/50
9052/9052 - 374s - loss: 3.2758 - accuracy100: 0.3745 - val_loss: 3.3628 - val_accuracy100: 0.3266 - 374s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 367s - loss: 3.2622 - accuracy100: 0.3837 - val_loss: 3.3883 - val_accuracy100: 0.3287 - 367s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 367s - loss: 3.2511 - accuracy100: 0.3920 - val_loss: 3.4124 - val_accuracy100: 0.3260 - 367s/epoch - 41ms/step
Epoch 4/50
9052/9052 - 366s - loss: 3.2443 - accuracy100: 0.3968 - val_loss: 3.4864 - val_accuracy100: 0.3254 - 366s/epoch - 40ms/step
Epoch 5/50
9052/9052 - 365s - loss: 3.2396 - accuracy100: 0.3999 - val_loss: 3.4365 - val_accuracy100: 0.3281 - 365s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 365s - loss: 3.2363 - accuracy100: 0.4021 - val_loss: 3.4923 - val_accuracy100: 0.3265 - 365s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 370s - loss: 3.2331 - accuracy100: 0.4037 - val_loss: 3.4927 - val_accuracy100: 0.3268 - 370s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 368s - loss: 3.2304 - accuracy100: 0.4056 - val_loss: 3.4730 - val_accuracy100: 0.3280 - 368s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 368s - loss: 3.2276 - accuracy100: 0.4071 - val_loss: 3.4420 - val_accuracy100: 0.3304 - 368s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 367s - loss: 3.2256 - accuracy100: 0.4078 - val_loss: 3.4531 - val_accuracy100: 0.3289 - 367s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 364s - loss: 3.2236 - accuracy100: 0.4092 - val_loss: 3.4242 - val_accuracy100: 0.3299 - 364s/epoch - 40ms/step
testing model: results/AAPL/W7/deepLOB_L2/h100
Evaluating performance on  test set...
23942/23942 - 328s - 328s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1145058
{'0': {'precision': 0.29352625878770905, 'recall': 0.9646020747021657, 'f1-score': 0.45009087017507754, 'support': 1800162}, '1': {'precision': 0.40848300130759174, 'recall': 0.033537217110765453, 'f1-score': 0.06198532343126346, 'support': 2533633}, '2': {'precision': 0.33365037093399275, 'recall': 0.0009770123585936146, 'f1-score': 0.0019483195466213762, 'support': 1795269}, 'accuracy': 0.2974622226166997, 'macro avg': {'precision': 0.34521987700976453, 'recall': 0.3330387680571749, 'f1-score': 0.1713415043843208, 'support': 6129064}, 'weighted avg': {'precision': 0.352799872362249, 'recall': 0.2974622226166997, 'f1-score': 0.15838997597045384, 'support': 6129064}}
[[1736440   62071    1651]
 [2446810   84971    1852]
 [1732541   60974    1754]]
Evaluating performance on  train set...
9052/9052 - 137s - 137s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1098505
{'0': {'precision': 0.33155445838804737, 'recall': 0.7269851389827731, 'f1-score': 0.45541076519059087, 'support': 781104}, '1': {'precision': 0.34776133628803585, 'recall': 0.038191100736894995, 'f1-score': 0.06882396353784741, 'support': 764288}, '2': {'precision': 0.36028037113822, 'recall': 0.24298550709613212, 'f1-score': 0.2902299362066524, 'support': 771688}, 'accuracy': 0.3385938336181746, 'macro avg': {'precision': 0.3465320552714344, 'recall': 0.3360539156052667, 'f1-score': 0.2714882216450302, 'support': 2317080}, 'weighted avg': {'precision': 0.3464672643571039, 'recall': 0.3385938336181746, 'f1-score': 0.27288287792794585, 'support': 2317080}}
[[567851  27161 186092]
 [588247  29189 146852]
 [556595  27584 187509]]
Evaluating performance on  val set...
2763/2763 - 40s - 40s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1199343
{'0': {'precision': 0.32589364071476506, 'recall': 0.9601472262539001, 'f1-score': 0.4866188676004039, 'support': 230122}, '1': {'precision': 0.3485903237034459, 'recall': 0.04172690645923346, 'f1-score': 0.07453217386127267, 'support': 240013}, '2': {'precision': 0.36833333333333335, 'recall': 0.0009317817691204992, 'f1-score': 0.0018588611321389518, 'support': 237180}, 'accuracy': 0.3268515442200434, 'macro avg': {'precision': 0.34760576591718145, 'recall': 0.33426863816075136, 'f1-score': 0.18766996753127185, 'support': 707315}, 'weighted avg': {'precision': 0.34782636555367596, 'recall': 0.3268515442200434, 'f1-score': 0.1842337323232598, 'support': 707315}}
[[220951   8979    192]
 [229811  10015    187]
 [227223   9736    221]]
training model: results/AAPL/W7/deepLOB_L2/h200
Epoch 1/50
9052/9052 - 373s - loss: 3.2562 - accuracy200: 0.3929 - val_loss: 3.3988 - val_accuracy200: 0.3231 - 373s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 365s - loss: 3.2382 - accuracy200: 0.4037 - val_loss: 3.3888 - val_accuracy200: 0.3228 - 365s/epoch - 40ms/step
Epoch 3/50
9052/9052 - 366s - loss: 3.2319 - accuracy200: 0.4075 - val_loss: 3.3479 - val_accuracy200: 0.3284 - 366s/epoch - 40ms/step
Epoch 4/50
9052/9052 - 366s - loss: 3.2259 - accuracy200: 0.4106 - val_loss: 3.3651 - val_accuracy200: 0.3298 - 366s/epoch - 40ms/step
Epoch 5/50
9052/9052 - 368s - loss: 3.2206 - accuracy200: 0.4133 - val_loss: 3.3612 - val_accuracy200: 0.3288 - 368s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 372s - loss: 3.2166 - accuracy200: 0.4154 - val_loss: 3.3445 - val_accuracy200: 0.3295 - 372s/epoch - 41ms/step
Epoch 7/50
9052/9052 - 375s - loss: 3.2126 - accuracy200: 0.4173 - val_loss: 3.3167 - val_accuracy200: 0.3314 - 375s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 372s - loss: 3.2090 - accuracy200: 0.4190 - val_loss: 3.3156 - val_accuracy200: 0.3291 - 372s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 372s - loss: 3.2053 - accuracy200: 0.4207 - val_loss: 3.3177 - val_accuracy200: 0.3324 - 372s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 371s - loss: 3.2023 - accuracy200: 0.4217 - val_loss: 3.3139 - val_accuracy200: 0.3341 - 371s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 375s - loss: 3.1999 - accuracy200: 0.4227 - val_loss: 3.3187 - val_accuracy200: 0.3337 - 375s/epoch - 41ms/step
Epoch 12/50
9052/9052 - 368s - loss: 3.1974 - accuracy200: 0.4241 - val_loss: 3.3205 - val_accuracy200: 0.3317 - 368s/epoch - 41ms/step
Epoch 13/50
9052/9052 - 374s - loss: 3.1950 - accuracy200: 0.4253 - val_loss: 3.3190 - val_accuracy200: 0.3321 - 374s/epoch - 41ms/step
Epoch 14/50
9052/9052 - 373s - loss: 3.1928 - accuracy200: 0.4261 - val_loss: 3.3475 - val_accuracy200: 0.3294 - 373s/epoch - 41ms/step
Epoch 15/50
9052/9052 - 372s - loss: 3.1910 - accuracy200: 0.4266 - val_loss: 3.3279 - val_accuracy200: 0.3300 - 372s/epoch - 41ms/step
Epoch 16/50
9052/9052 - 368s - loss: 3.1887 - accuracy200: 0.4278 - val_loss: 3.3249 - val_accuracy200: 0.3322 - 368s/epoch - 41ms/step
Epoch 17/50
9052/9052 - 366s - loss: 3.1868 - accuracy200: 0.4281 - val_loss: 3.3169 - val_accuracy200: 0.3314 - 366s/epoch - 40ms/step
Epoch 18/50
9052/9052 - 365s - loss: 3.1850 - accuracy200: 0.4293 - val_loss: 3.3182 - val_accuracy200: 0.3305 - 365s/epoch - 40ms/step
Epoch 19/50
9052/9052 - 367s - loss: 3.1832 - accuracy200: 0.4301 - val_loss: 3.3817 - val_accuracy200: 0.3263 - 367s/epoch - 41ms/step
Epoch 20/50
9052/9052 - 366s - loss: 3.1819 - accuracy200: 0.4305 - val_loss: 3.3285 - val_accuracy200: 0.3282 - 366s/epoch - 40ms/step
testing model: results/AAPL/W7/deepLOB_L2/h200
Evaluating performance on  test set...
23942/23942 - 325s - 325s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1003689
{'0': {'precision': 0.2771911148468698, 'recall': 0.42018645679581346, 'f1-score': 0.33402838616801567, 'support': 1714070}, '1': {'precision': 0.44052868579843807, 'recall': 0.4448848318871298, 'f1-score': 0.4426960429409104, 'support': 2713772}, '2': {'precision': 0.27854760835036607, 'recall': 0.1293734738911206, 'f1-score': 0.1766845270086663, 'support': 1701222}, 'accuracy': 0.3504022800218761, 'macro avg': {'precision': 0.3320891363318913, 'recall': 0.331481587524688, 'f1-score': 0.3178029853725308, 'support': 6129064}, 'weighted avg': {'precision': 0.34988877686955133, 'recall': 0.3504022800218761, 'f1-score': 0.3384699141874825, 'support': 6129064}}
[[ 720229  771312  222529]
 [1158933 1207316  347523]
 [ 719150  761979  220093]]
Evaluating performance on  train set...
9052/9052 - 128s - 128s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1175617
{'0': {'precision': 0.34173532306609206, 'recall': 0.4410709504005848, 'f1-score': 0.3851004490873654, 'support': 787973}, '1': {'precision': 0.3491375745554707, 'recall': 0.3322027523400759, 'f1-score': 0.34045970459766106, 'support': 749762}, '2': {'precision': 0.35416354165246205, 'recall': 0.26660208251801193, 'f1-score': 0.3042073661300914, 'support': 779345}, 'accuracy': 0.34716108205154766, 'macro avg': {'precision': 0.3483454797580083, 'recall': 0.3466252617528909, 'f1-score': 0.34325583993837266, 'support': 2317080}, 'weighted avg': {'precision': 0.34831075287230245, 'recall': 0.34716108205154766, 'f1-score': 0.3434473539817038, 'support': 2317080}}
[[347552 233826 206595]
 [328395 249073 172294]
 [341074 230496 207775]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1042156
{'0': {'precision': 0.3213491312351994, 'recall': 0.35379048674219943, 'f1-score': 0.33679038387491, 'support': 227451}, '1': {'precision': 0.34159834978800135, 'recall': 0.5038847463489149, 'f1-score': 0.407166503085855, 'support': 242873}, '2': {'precision': 0.33324547620254447, 'recall': 0.13870990881510267, 'f1-score': 0.19588482761086415, 'support': 236991}, 'accuracy': 0.33326452853396293, 'macro avg': {'precision': 0.3320643190752484, 'recall': 0.3321283806354057, 'f1-score': 0.3132805715238764, 'support': 707315}, 'weighted avg': {'precision': 0.3322881260928382, 'recall': 0.33326452853396293, 'f1-score': 0.3137442311940639, 'support': 707315}}
[[ 80470 115510  31471]
 [ 86192 122380  34301]
 [ 83751 120367  32873]]
training model: results/AAPL/W7/deepLOB_L2/h300
Epoch 1/50
9052/9052 - 373s - loss: 3.2540 - accuracy300: 0.3921 - val_loss: 3.4648 - val_accuracy300: 0.3238 - 373s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 363s - loss: 3.2285 - accuracy300: 0.4074 - val_loss: 3.3989 - val_accuracy300: 0.3238 - 363s/epoch - 40ms/step
Epoch 3/50
9052/9052 - 366s - loss: 3.2176 - accuracy300: 0.4125 - val_loss: 3.4071 - val_accuracy300: 0.3246 - 366s/epoch - 40ms/step
Epoch 4/50
9052/9052 - 368s - loss: 3.2096 - accuracy300: 0.4163 - val_loss: 3.4476 - val_accuracy300: 0.3241 - 368s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 365s - loss: 3.2040 - accuracy300: 0.4189 - val_loss: 3.4214 - val_accuracy300: 0.3256 - 365s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 365s - loss: 3.1986 - accuracy300: 0.4212 - val_loss: 3.4631 - val_accuracy300: 0.3246 - 365s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 372s - loss: 3.1942 - accuracy300: 0.4227 - val_loss: 3.4180 - val_accuracy300: 0.3276 - 372s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 365s - loss: 3.1912 - accuracy300: 0.4244 - val_loss: 3.4500 - val_accuracy300: 0.3258 - 365s/epoch - 40ms/step
Epoch 9/50
9052/9052 - 367s - loss: 3.1876 - accuracy300: 0.4259 - val_loss: 3.4264 - val_accuracy300: 0.3264 - 367s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 365s - loss: 3.1843 - accuracy300: 0.4271 - val_loss: 3.4679 - val_accuracy300: 0.3224 - 365s/epoch - 40ms/step
Epoch 11/50
9052/9052 - 364s - loss: 3.1819 - accuracy300: 0.4281 - val_loss: 3.4886 - val_accuracy300: 0.3227 - 364s/epoch - 40ms/step
Epoch 12/50
9052/9052 - 364s - loss: 3.1789 - accuracy300: 0.4298 - val_loss: 3.4490 - val_accuracy300: 0.3262 - 364s/epoch - 40ms/step
testing model: results/AAPL/W7/deepLOB_L2/h300
Evaluating performance on  test set...
23942/23942 - 336s - 336s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1436728
{'0': {'precision': 0.2936692610998587, 'recall': 0.7486835772098047, 'f1-score': 0.4218635856037924, 'support': 1803372}, '1': {'precision': 0.4124417233658204, 'recall': 0.07504721820044136, 'f1-score': 0.12698792267554884, 'support': 2540334}, '2': {'precision': 0.2918984787144403, 'recall': 0.17482488106026914, 'f1-score': 0.2186782202097559, 'support': 1785358}, 'accuracy': 0.30231777641741053, 'macro avg': {'precision': 0.3326698210600398, 'recall': 0.3328518921568384, 'f1-score': 0.25584324282969906, 'support': 6129064}, 'weighted avg': {'precision': 0.3423814696295582, 'recall': 0.30231777641741053, 'f1-score': 0.24045884094811204, 'support': 6129064}}
[[1350155  136430  316787]
 [1909308  190645  440381]
 [1338073  135160  312125]]
Evaluating performance on  train set...
9052/9052 - 130s - 130s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1266375
{'0': {'precision': 0.3328905924374403, 'recall': 0.6488687096438309, 'f1-score': 0.44003105182612545, 'support': 777917}, '1': {'precision': 0.29761498557077837, 'recall': 0.13426029196718467, 'f1-score': 0.18504358519586592, 'support': 766593}, '2': {'precision': 0.33673083601865733, 'recall': 0.1982901225778894, 'f1-score': 0.24959918925436167, 'support': 772570}, 'accuracy': 0.3283796847756659, 'macro avg': {'precision': 0.3224121380089587, 'recall': 0.3271397080629683, 'f1-score': 0.29155794209211766, 'support': 2317080}, 'weighted avg': {'precision': 0.3225002838114135, 'recall': 0.3283796847756659, 'f1-score': 0.29217532346389447, 'support': 2317080}}
[[504766 120768 152383]
 [514304 102923 149366]
 [497242 122135 153193]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.13152
{'0': {'precision': 0.3183691749323365, 'recall': 0.7295186476820897, 'f1-score': 0.4432845671988695, 'support': 225095}, '1': {'precision': 0.34679600944225236, 'recall': 0.08166867521211457, 'f1-score': 0.13220399101430616, 'support': 246447}, '2': {'precision': 0.33400254700726645, 'recall': 0.1891056227812345, 'f1-score': 0.2414864202478992, 'support': 235773}, 'accuracy': 0.32365212104932034, 'macro avg': {'precision': 0.3330559104606185, 'recall': 0.3334309818918129, 'f1-score': 0.2723249928203583, 'support': 707315}, 'weighted avg': {'precision': 0.3334849792326662, 'recall': 0.32365212104932034, 'f1-score': 0.26762954891136226, 'support': 707315}}
[[164211  18539  42345]
 [179761  20127  46559]
 [171816  19371  44586]]
training model: results/AAPL/W7/deepLOB_L2/h500
Epoch 1/50
9052/9052 - 373s - loss: 3.2313 - accuracy500: 0.4056 - val_loss: 3.3163 - val_accuracy500: 0.3434 - 373s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 370s - loss: 3.1931 - accuracy500: 0.4252 - val_loss: 3.3022 - val_accuracy500: 0.3486 - 370s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 368s - loss: 3.1783 - accuracy500: 0.4328 - val_loss: 3.2991 - val_accuracy500: 0.3459 - 368s/epoch - 41ms/step
Epoch 4/50
9052/9052 - 371s - loss: 3.1707 - accuracy500: 0.4355 - val_loss: 3.3146 - val_accuracy500: 0.3452 - 371s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 365s - loss: 3.1627 - accuracy500: 0.4384 - val_loss: 3.3157 - val_accuracy500: 0.3431 - 365s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 368s - loss: 3.1584 - accuracy500: 0.4399 - val_loss: 3.3145 - val_accuracy500: 0.3372 - 368s/epoch - 41ms/step
Epoch 7/50
9052/9052 - 375s - loss: 3.1526 - accuracy500: 0.4414 - val_loss: 3.3716 - val_accuracy500: 0.3327 - 375s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 374s - loss: 3.1488 - accuracy500: 0.4430 - val_loss: 3.4259 - val_accuracy500: 0.3284 - 374s/epoch - 41ms/step
Epoch 9/50
9052/9052 - 367s - loss: 3.1470 - accuracy500: 0.4439 - val_loss: 3.4380 - val_accuracy500: 0.3236 - 367s/epoch - 41ms/step
Epoch 10/50
9052/9052 - 368s - loss: 3.1428 - accuracy500: 0.4453 - val_loss: 3.4516 - val_accuracy500: 0.3211 - 368s/epoch - 41ms/step
Epoch 11/50
9052/9052 - 372s - loss: 3.1388 - accuracy500: 0.4464 - val_loss: 3.4163 - val_accuracy500: 0.3246 - 372s/epoch - 41ms/step
Epoch 12/50
9052/9052 - 375s - loss: 3.1351 - accuracy500: 0.4475 - val_loss: 3.4414 - val_accuracy500: 0.3241 - 375s/epoch - 41ms/step
Epoch 13/50
9052/9052 - 371s - loss: 3.1326 - accuracy500: 0.4481 - val_loss: 3.4461 - val_accuracy500: 0.3228 - 371s/epoch - 41ms/step
testing model: results/AAPL/W7/deepLOB_L2/h500
Evaluating performance on  test set...
23942/23942 - 338s - 338s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0943198
{'0': {'precision': 0.2888543559268012, 'recall': 0.11119064298124649, 'f1-score': 0.16057144396806874, 'support': 1768683}, '1': {'precision': 0.4253267220621057, 'recall': 0.8803490320246551, 'f1-score': 0.5735512310611741, 'support': 2606523}, '2': {'precision': 0.28990301481091646, 'recall': 0.008794326564636362, 'f1-score': 0.017070803326061864, 'support': 1753858}, 'accuracy': 0.408991487117772, 'macro avg': {'precision': 0.33469469759994114, 'recall': 0.33344466719017934, 'f1-score': 0.2503978261184349, 'support': 6129064}, 'weighted avg': {'precision': 0.3471923925290082, 'recall': 0.408991487117772, 'f1-score': 0.29513710799085807, 'support': 6129064}}
[[ 196661 1556397   15625]
 [ 289718 2294650   22155]
 [ 194452 1543982   15424]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1118319
{'0': {'precision': 0.34369590643274855, 'recall': 0.2283105259341365, 'f1-score': 0.27436542220119753, 'support': 772264}, '1': {'precision': 0.35302327325346444, 'recall': 0.6539416802898621, 'f1-score': 0.45851969660007563, 'support': 777473}, '2': {'precision': 0.3615720308008552, 'recall': 0.17146308756318882, 'f1-score': 0.23261603088322522, 'support': 767343}, 'accuracy': 0.3523007405872909, 'macro avg': {'precision': 0.3527637368290228, 'recall': 0.3512384312623958, 'f1-score': 0.32183371656149945, 'support': 2317080}, 'weighted avg': {'precision': 0.3527456132901719, 'recall': 0.3523007405872909, 'f1-score': 0.32233047865052694, 'support': 2317080}}
[[176316 467482 128466]
 [165202 508422 103849]
 [171482 464290 131571]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0994117
{'0': {'precision': 0.3143212991201878, 'recall': 0.08826246031888373, 'f1-score': 0.1378235983966673, 'support': 223028}, '1': {'precision': 0.34884537436579055, 'recall': 0.9017584376646003, 'f1-score': 0.5030758050607532, 'support': 246810}, '2': {'precision': 0.3390641351472567, 'recall': 0.009550398564913656, 'f1-score': 0.01857752512634847, 'support': 237477}, 'accuracy': 0.34569604772979506, 'macro avg': {'precision': 0.3340769362110783, 'recall': 0.33319043218279926, 'f1-score': 0.2198256428612563, 'support': 707315}, 'weighted avg': {'precision': 0.3346753725988606, 'recall': 0.34569604772979506, 'f1-score': 0.2252382543628882, 'support': 707315}}
[[ 19685 201280   2063]
 [ 21889 222563   2358]
 [ 21053 214156   2268]]
training model: results/AAPL/W7/deepLOB_L2/h1000
Epoch 1/50
9052/9052 - 374s - loss: 3.1813 - accuracy1000: 0.4314 - val_loss: 3.5604 - val_accuracy1000: 0.3175 - 374s/epoch - 41ms/step
Epoch 2/50
9052/9052 - 369s - loss: 3.1301 - accuracy1000: 0.4533 - val_loss: 3.3450 - val_accuracy1000: 0.3373 - 369s/epoch - 41ms/step
Epoch 3/50
9052/9052 - 366s - loss: 3.1103 - accuracy1000: 0.4609 - val_loss: 3.4215 - val_accuracy1000: 0.3288 - 366s/epoch - 40ms/step
Epoch 4/50
9052/9052 - 368s - loss: 3.0955 - accuracy1000: 0.4658 - val_loss: 3.3510 - val_accuracy1000: 0.3360 - 368s/epoch - 41ms/step
Epoch 5/50
9052/9052 - 371s - loss: 3.0853 - accuracy1000: 0.4693 - val_loss: 3.3729 - val_accuracy1000: 0.3351 - 371s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 366s - loss: 3.0773 - accuracy1000: 0.4714 - val_loss: 3.4400 - val_accuracy1000: 0.3290 - 366s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 367s - loss: 3.0701 - accuracy1000: 0.4735 - val_loss: 3.4914 - val_accuracy1000: 0.3237 - 367s/epoch - 41ms/step
Epoch 8/50
9052/9052 - 365s - loss: 3.0640 - accuracy1000: 0.4749 - val_loss: 3.4927 - val_accuracy1000: 0.3239 - 365s/epoch - 40ms/step
Epoch 9/50
9052/9052 - 365s - loss: 3.0581 - accuracy1000: 0.4765 - val_loss: 3.5478 - val_accuracy1000: 0.3229 - 365s/epoch - 40ms/step
Epoch 10/50
9052/9052 - 363s - loss: 3.0537 - accuracy1000: 0.4777 - val_loss: 3.5704 - val_accuracy1000: 0.3220 - 363s/epoch - 40ms/step
Epoch 11/50
9052/9052 - 362s - loss: 3.0504 - accuracy1000: 0.4788 - val_loss: 3.6795 - val_accuracy1000: 0.3172 - 362s/epoch - 40ms/step
Epoch 12/50
9052/9052 - 363s - loss: 3.0518 - accuracy1000: 0.4779 - val_loss: 3.6386 - val_accuracy1000: 0.3182 - 363s/epoch - 40ms/step
testing model: results/AAPL/W7/deepLOB_L2/h1000
Evaluating performance on  test set...
23942/23942 - 330s - 330s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1119572
{'0': {'precision': 0.29075621564809867, 'recall': 0.23320978543572055, 'f1-score': 0.25882287982478475, 'support': 1809015}, '1': {'precision': 0.4096711168519084, 'recall': 0.4399567342964423, 'f1-score': 0.4242741488809108, 'support': 2520241}, '2': {'precision': 0.29302294912339877, 'recall': 0.3209814602446483, 'f1-score': 0.3063656633724379, 'support': 1799808}, 'accuracy': 0.3439973868766911, 'macro avg': {'precision': 0.3311500938744686, 'recall': 0.3313826599922704, 'f1-score': 0.32982089735937786, 'support': 6129064}, 'weighted avg': {'precision': 0.34031906807833984, 'recall': 0.3439973868766911, 'f1-score': 0.34081663188033756, 'support': 6129064}}
[[ 421880  804223  582912]
 [ 600526 1108797  810918]
 [ 428569  793534  577705]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1263772
{'0': {'precision': 0.3442172223995105, 'recall': 0.3352590094284492, 'f1-score': 0.3396790633850791, 'support': 778601}, '1': {'precision': 0.3286612421730568, 'recall': 0.4061590289093539, 'f1-score': 0.36332348525039493, 'support': 764666}, '2': {'precision': 0.3291059014059035, 'recall': 0.26103851964234254, 'f1-score': 0.29114675745289287, 'support': 773813}, 'accuracy': 0.33387021596146876, 'macro avg': {'precision': 0.3339947886594903, 'recall': 0.33415218599338187, 'f1-score': 0.33138310202945565, 'support': 2317080}, 'weighted avg': {'precision': 0.3340369671610779, 'recall': 0.33387021596146876, 'f1-score': 0.3312741555872304, 'support': 2317080}}
[[261033 315818 201750]
 [244066 310576 210024]
 [253239 318579 201995]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1149973
{'0': {'precision': 0.31527738796894006, 'recall': 0.19692896892109357, 'f1-score': 0.24243061454307002, 'support': 222466}, '1': {'precision': 0.3419299248147295, 'recall': 0.47302851324671885, 'f1-score': 0.3969346077437102, 'support': 241607}, '2': {'precision': 0.34434492155631585, 'recall': 0.3314271384053741, 'f1-score': 0.3377625644431131, 'support': 243242}, 'accuracy': 0.3374931961007472, 'macro avg': {'precision': 0.33385074477999516, 'recall': 0.33379487352439546, 'f1-score': 0.32570926224329777, 'support': 707315}, 'weighted avg': {'precision': 0.33437762545091215, 'recall': 0.3374931961007472, 'f1-score': 0.3279907687074994, 'support': 707315}}
[[ 43810 104978  73678]
 [ 47498 114287  79822]
 [ 47649 114976  80617]]
training model: results/AAPL/W7/deepOF_L2/h10
Epoch 1/50
9052/9052 - 252s - loss: 3.0410 - accuracy10: 0.4857 - val_loss: 3.2016 - val_accuracy10: 0.4336 - 252s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 239s - loss: 2.9765 - accuracy10: 0.5058 - val_loss: 3.2025 - val_accuracy10: 0.4333 - 239s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 241s - loss: 2.9570 - accuracy10: 0.5106 - val_loss: 3.1743 - val_accuracy10: 0.4436 - 241s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 239s - loss: 2.9440 - accuracy10: 0.5142 - val_loss: 3.0950 - val_accuracy10: 0.4683 - 239s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 240s - loss: 2.9353 - accuracy10: 0.5168 - val_loss: 3.1214 - val_accuracy10: 0.4591 - 240s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 239s - loss: 2.9279 - accuracy10: 0.5186 - val_loss: 3.0562 - val_accuracy10: 0.4806 - 239s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 239s - loss: 2.9208 - accuracy10: 0.5206 - val_loss: 3.0791 - val_accuracy10: 0.4732 - 239s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 238s - loss: 2.9145 - accuracy10: 0.5224 - val_loss: 3.0271 - val_accuracy10: 0.4893 - 238s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 239s - loss: 2.9093 - accuracy10: 0.5237 - val_loss: 3.0243 - val_accuracy10: 0.4907 - 239s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 239s - loss: 2.9041 - accuracy10: 0.5252 - val_loss: 3.0266 - val_accuracy10: 0.4888 - 239s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 242s - loss: 2.8998 - accuracy10: 0.5261 - val_loss: 3.0157 - val_accuracy10: 0.4923 - 242s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 240s - loss: 2.8957 - accuracy10: 0.5273 - val_loss: 3.0161 - val_accuracy10: 0.4926 - 240s/epoch - 26ms/step
Epoch 13/50
9052/9052 - 241s - loss: 2.8922 - accuracy10: 0.5282 - val_loss: 3.0178 - val_accuracy10: 0.4923 - 241s/epoch - 27ms/step
Epoch 14/50
9052/9052 - 242s - loss: 2.8886 - accuracy10: 0.5293 - val_loss: 3.0190 - val_accuracy10: 0.4911 - 242s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 239s - loss: 2.8855 - accuracy10: 0.5302 - val_loss: 3.0170 - val_accuracy10: 0.4919 - 239s/epoch - 26ms/step
Epoch 16/50
9052/9052 - 242s - loss: 2.8828 - accuracy10: 0.5307 - val_loss: 3.0160 - val_accuracy10: 0.4913 - 242s/epoch - 27ms/step
Epoch 17/50
9052/9052 - 242s - loss: 2.8804 - accuracy10: 0.5314 - val_loss: 3.0118 - val_accuracy10: 0.4934 - 242s/epoch - 27ms/step
Epoch 18/50
9052/9052 - 239s - loss: 2.8775 - accuracy10: 0.5321 - val_loss: 3.0166 - val_accuracy10: 0.4901 - 239s/epoch - 26ms/step
Epoch 19/50
9052/9052 - 244s - loss: 2.8750 - accuracy10: 0.5327 - val_loss: 3.0101 - val_accuracy10: 0.4940 - 244s/epoch - 27ms/step
Epoch 20/50
9052/9052 - 247s - loss: 2.8731 - accuracy10: 0.5332 - val_loss: 3.0109 - val_accuracy10: 0.4934 - 247s/epoch - 27ms/step
Epoch 21/50
9052/9052 - 240s - loss: 2.8707 - accuracy10: 0.5338 - val_loss: 3.0093 - val_accuracy10: 0.4931 - 240s/epoch - 26ms/step
Epoch 22/50
9052/9052 - 244s - loss: 2.8684 - accuracy10: 0.5345 - val_loss: 3.0108 - val_accuracy10: 0.4940 - 244s/epoch - 27ms/step
Epoch 23/50
9052/9052 - 243s - loss: 2.8662 - accuracy10: 0.5350 - val_loss: 3.0100 - val_accuracy10: 0.4926 - 243s/epoch - 27ms/step
Epoch 24/50
9052/9052 - 240s - loss: 2.8645 - accuracy10: 0.5355 - val_loss: 3.0025 - val_accuracy10: 0.4956 - 240s/epoch - 27ms/step
Epoch 25/50
9052/9052 - 242s - loss: 2.8624 - accuracy10: 0.5360 - val_loss: 2.9924 - val_accuracy10: 0.4988 - 242s/epoch - 27ms/step
Epoch 26/50
9052/9052 - 239s - loss: 2.8608 - accuracy10: 0.5363 - val_loss: 2.9981 - val_accuracy10: 0.4961 - 239s/epoch - 26ms/step
Epoch 27/50
9052/9052 - 238s - loss: 2.8590 - accuracy10: 0.5369 - val_loss: 2.9960 - val_accuracy10: 0.4979 - 238s/epoch - 26ms/step
Epoch 28/50
9052/9052 - 240s - loss: 2.8574 - accuracy10: 0.5371 - val_loss: 2.9921 - val_accuracy10: 0.4982 - 240s/epoch - 27ms/step
Epoch 29/50
9052/9052 - 242s - loss: 2.8559 - accuracy10: 0.5377 - val_loss: 2.9917 - val_accuracy10: 0.4985 - 242s/epoch - 27ms/step
Epoch 30/50
9052/9052 - 239s - loss: 2.8545 - accuracy10: 0.5378 - val_loss: 2.9944 - val_accuracy10: 0.4973 - 239s/epoch - 26ms/step
Epoch 31/50
9052/9052 - 242s - loss: 2.8529 - accuracy10: 0.5382 - val_loss: 2.9921 - val_accuracy10: 0.4984 - 242s/epoch - 27ms/step
Epoch 32/50
9052/9052 - 243s - loss: 2.8516 - accuracy10: 0.5385 - val_loss: 2.9925 - val_accuracy10: 0.4985 - 243s/epoch - 27ms/step
Epoch 33/50
9052/9052 - 242s - loss: 2.8500 - accuracy10: 0.5387 - val_loss: 3.0044 - val_accuracy10: 0.4966 - 242s/epoch - 27ms/step
Epoch 34/50
9052/9052 - 246s - loss: 2.8487 - accuracy10: 0.5392 - val_loss: 3.0007 - val_accuracy10: 0.4979 - 246s/epoch - 27ms/step
Epoch 35/50
9052/9052 - 244s - loss: 2.8471 - accuracy10: 0.5396 - val_loss: 2.9976 - val_accuracy10: 0.4987 - 244s/epoch - 27ms/step
Epoch 36/50
9052/9052 - 239s - loss: 2.8461 - accuracy10: 0.5398 - val_loss: 2.9927 - val_accuracy10: 0.4997 - 239s/epoch - 26ms/step
Epoch 37/50
9052/9052 - 238s - loss: 2.8448 - accuracy10: 0.5401 - val_loss: 2.9867 - val_accuracy10: 0.5000 - 238s/epoch - 26ms/step
Epoch 38/50
9052/9052 - 242s - loss: 2.8438 - accuracy10: 0.5406 - val_loss: 2.9848 - val_accuracy10: 0.5003 - 242s/epoch - 27ms/step
Epoch 39/50
9052/9052 - 240s - loss: 2.8425 - accuracy10: 0.5408 - val_loss: 2.9924 - val_accuracy10: 0.4995 - 240s/epoch - 27ms/step
Epoch 40/50
9052/9052 - 239s - loss: 2.8416 - accuracy10: 0.5411 - val_loss: 2.9909 - val_accuracy10: 0.4999 - 239s/epoch - 26ms/step
Epoch 41/50
9052/9052 - 248s - loss: 2.8408 - accuracy10: 0.5410 - val_loss: 2.9927 - val_accuracy10: 0.5001 - 248s/epoch - 27ms/step
Epoch 42/50
9052/9052 - 249s - loss: 2.8392 - accuracy10: 0.5418 - val_loss: 2.9913 - val_accuracy10: 0.4990 - 249s/epoch - 27ms/step
Epoch 43/50
9052/9052 - 241s - loss: 2.8379 - accuracy10: 0.5417 - val_loss: 2.9879 - val_accuracy10: 0.5000 - 241s/epoch - 27ms/step
Epoch 44/50
9052/9052 - 239s - loss: 2.8367 - accuracy10: 0.5422 - val_loss: 2.9916 - val_accuracy10: 0.5002 - 239s/epoch - 26ms/step
Epoch 45/50
9052/9052 - 240s - loss: 2.8362 - accuracy10: 0.5422 - val_loss: 2.9864 - val_accuracy10: 0.5008 - 240s/epoch - 27ms/step
Epoch 46/50
9052/9052 - 241s - loss: 2.8351 - accuracy10: 0.5427 - val_loss: 2.9974 - val_accuracy10: 0.4991 - 241s/epoch - 27ms/step
Epoch 47/50
9052/9052 - 243s - loss: 2.8343 - accuracy10: 0.5427 - val_loss: 2.9943 - val_accuracy10: 0.4987 - 243s/epoch - 27ms/step
Epoch 48/50
9052/9052 - 255s - loss: 2.8335 - accuracy10: 0.5428 - val_loss: 3.0243 - val_accuracy10: 0.4921 - 255s/epoch - 28ms/step
testing model: results/AAPL/W7/deepOF_L2/h10
Evaluating performance on  test set...
23942/23942 - 294s - 294s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.022536
{'0': {'precision': 0.45975259063829127, 'recall': 0.6288359982670213, 'f1-score': 0.531162979727002, 'support': 1878846}, '1': {'precision': 0.5974604336060455, 'recall': 0.1987910008013261, 'f1-score': 0.29832224446575006, 'support': 2382301}, '2': {'precision': 0.44852767357750056, 'recall': 0.6643166273357631, 'f1-score': 0.5355005927302403, 'support': 1867912}, 'accuracy': 0.4724952068498606, 'macro avg': {'precision': 0.5019135659406124, 'recall': 0.49731454213470344, 'f1-score': 0.45499527230766407, 'support': 6129059}, 'weighted avg': {'precision': 0.509857243690753, 'recall': 0.4724952068498606, 'f1-score': 0.4419821712091674, 'support': 6129059}}
[[1181486  165985  531375]
 [ 914407  473580  994314]
 [ 473937  153090 1240885]]
Evaluating performance on  train set...
9052/9052 - 112s - 112s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9740107
{'0': {'precision': 0.5152790406817384, 'recall': 0.6004751132952665, 'f1-score': 0.5546244022111342, 'support': 784234}, '1': {'precision': 0.5732192197874442, 'recall': 0.3137146346968309, 'f1-score': 0.4055032001036527, 'support': 753210}, '2': {'precision': 0.5010030697567405, 'recall': 0.636802653552821, 'f1-score': 0.5607988740489057, 'support': 779634}, 'accuracy': 0.5194814330808026, 'macro avg': {'precision': 0.5298337767419744, 'recall': 0.5169974671816394, 'f1-score': 0.5069754921212309, 'support': 2317078}, 'weighted avg': {'precision': 0.5293101134328796, 'recall': 0.5194814330808026, 'f1-score': 0.5082272794286439, 'support': 2317078}}
[[470913  89388 223933]
 [246365 236293 270552]
 [196621  86540 496473]]
Evaluating performance on  val set...
2763/2763 - 36s - 36s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.991745
{'0': {'precision': 0.4888057678755353, 'recall': 0.6197144378962561, 'f1-score': 0.5465303926842389, 'support': 232804}, '1': {'precision': 0.5807473084230526, 'recall': 0.26695112619356554, 'f1-score': 0.36576957485483746, 'support': 240456}, '2': {'precision': 0.4820741831105453, 'recall': 0.6212626146103036, 'f1-score': 0.5428889312022341, 'support': 234054}, 'accuracy': 0.5003025530386788, 'macro avg': {'precision': 0.5172090864697111, 'recall': 0.5026427262333751, 'f1-score': 0.4850629662471035, 'support': 707314}, 'weighted avg': {'precision': 0.5178343757262336, 'recall': 0.5003025530386788, 'f1-score': 0.48387459647817527, 'support': 707314}}
[[144272  22642  65890]
 [ 85933  64190  90333]
 [ 64947  23698 145409]]
training model: results/AAPL/W7/deepOF_L2/h20
Epoch 1/50
9052/9052 - 245s - loss: 3.1405 - accuracy20: 0.4466 - val_loss: 3.2046 - val_accuracy20: 0.4231 - 245s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 253s - loss: 3.0903 - accuracy20: 0.4649 - val_loss: 3.1966 - val_accuracy20: 0.4284 - 253s/epoch - 28ms/step
Epoch 3/50
9052/9052 - 246s - loss: 3.0735 - accuracy20: 0.4705 - val_loss: 3.2054 - val_accuracy20: 0.4270 - 246s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 239s - loss: 3.0642 - accuracy20: 0.4734 - val_loss: 3.2008 - val_accuracy20: 0.4280 - 239s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 238s - loss: 3.0565 - accuracy20: 0.4761 - val_loss: 3.1967 - val_accuracy20: 0.4299 - 238s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 239s - loss: 3.0512 - accuracy20: 0.4779 - val_loss: 3.1890 - val_accuracy20: 0.4313 - 239s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 239s - loss: 3.0466 - accuracy20: 0.4793 - val_loss: 3.1956 - val_accuracy20: 0.4301 - 239s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 249s - loss: 3.0431 - accuracy20: 0.4806 - val_loss: 3.2025 - val_accuracy20: 0.4289 - 249s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 250s - loss: 3.0394 - accuracy20: 0.4818 - val_loss: 3.1931 - val_accuracy20: 0.4315 - 250s/epoch - 28ms/step
Epoch 10/50
9052/9052 - 243s - loss: 3.0360 - accuracy20: 0.4829 - val_loss: 3.1899 - val_accuracy20: 0.4333 - 243s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 241s - loss: 3.0334 - accuracy20: 0.4836 - val_loss: 3.1955 - val_accuracy20: 0.4324 - 241s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 240s - loss: 3.0307 - accuracy20: 0.4848 - val_loss: 3.1866 - val_accuracy20: 0.4348 - 240s/epoch - 26ms/step
Epoch 13/50
9052/9052 - 241s - loss: 3.0281 - accuracy20: 0.4856 - val_loss: 3.1896 - val_accuracy20: 0.4344 - 241s/epoch - 27ms/step
Epoch 14/50
9052/9052 - 243s - loss: 3.0260 - accuracy20: 0.4866 - val_loss: 3.1969 - val_accuracy20: 0.4333 - 243s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 247s - loss: 3.0238 - accuracy20: 0.4872 - val_loss: 3.1869 - val_accuracy20: 0.4366 - 247s/epoch - 27ms/step
Epoch 16/50
9052/9052 - 247s - loss: 3.0213 - accuracy20: 0.4877 - val_loss: 3.1846 - val_accuracy20: 0.4373 - 247s/epoch - 27ms/step
Epoch 17/50
9052/9052 - 243s - loss: 3.0199 - accuracy20: 0.4881 - val_loss: 3.1939 - val_accuracy20: 0.4345 - 243s/epoch - 27ms/step
Epoch 18/50
9052/9052 - 240s - loss: 3.0178 - accuracy20: 0.4890 - val_loss: 3.1824 - val_accuracy20: 0.4381 - 240s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 240s - loss: 3.0162 - accuracy20: 0.4896 - val_loss: 3.1971 - val_accuracy20: 0.4338 - 240s/epoch - 27ms/step
Epoch 20/50
9052/9052 - 241s - loss: 3.0148 - accuracy20: 0.4901 - val_loss: 3.1825 - val_accuracy20: 0.4388 - 241s/epoch - 27ms/step
Epoch 21/50
9052/9052 - 245s - loss: 3.0130 - accuracy20: 0.4906 - val_loss: 3.1943 - val_accuracy20: 0.4362 - 245s/epoch - 27ms/step
Epoch 22/50
9052/9052 - 243s - loss: 3.0114 - accuracy20: 0.4911 - val_loss: 3.1873 - val_accuracy20: 0.4380 - 243s/epoch - 27ms/step
Epoch 23/50
9052/9052 - 245s - loss: 3.0102 - accuracy20: 0.4915 - val_loss: 3.1927 - val_accuracy20: 0.4369 - 245s/epoch - 27ms/step
Epoch 24/50
9052/9052 - 244s - loss: 3.0085 - accuracy20: 0.4921 - val_loss: 3.1887 - val_accuracy20: 0.4381 - 244s/epoch - 27ms/step
Epoch 25/50
9052/9052 - 239s - loss: 3.0075 - accuracy20: 0.4921 - val_loss: 3.1840 - val_accuracy20: 0.4393 - 239s/epoch - 26ms/step
Epoch 26/50
9052/9052 - 239s - loss: 3.0060 - accuracy20: 0.4928 - val_loss: 3.1880 - val_accuracy20: 0.4389 - 239s/epoch - 26ms/step
Epoch 27/50
9052/9052 - 240s - loss: 3.0047 - accuracy20: 0.4929 - val_loss: 3.1860 - val_accuracy20: 0.4394 - 240s/epoch - 27ms/step
Epoch 28/50
9052/9052 - 244s - loss: 3.0034 - accuracy20: 0.4936 - val_loss: 3.1937 - val_accuracy20: 0.4378 - 244s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h20
Evaluating performance on  test set...
23942/23942 - 307s - 307s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0934585
{'0': {'precision': 0.4160633126111164, 'recall': 0.5871191770600149, 'f1-score': 0.4870076027447072, 'support': 1876200}, '1': {'precision': 0.5747139224411951, 'recall': 0.060493115668973294, 'f1-score': 0.10946426503786569, 'support': 2391082}, '2': {'precision': 0.39346117954633975, 'recall': 0.6825779886635188, 'f1-score': 0.4991787445780742, 'support': 1861777}, 'accuracy': 0.41066744503520036, 'macro avg': {'precision': 0.4614128048662171, 'recall': 0.44339676046416904, 'f1-score': 0.36521687078688236, 'support': 6129059}, 'weighted avg': {'precision': 0.47109076233264513, 'recall': 0.41066744503520036, 'f1-score': 0.3434166979938067, 'support': 6129059}}
[[1101553   59129  715518]
 [1002946  144644 1243492]
 [ 543062   47907 1270808]]
Evaluating performance on  train set...
9052/9052 - 113s - 113s/epoch - 12ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0447937
{'0': {'precision': 0.45848131667213476, 'recall': 0.5549121582808699, 'f1-score': 0.5021087331903094, 'support': 778161}, '1': {'precision': 0.55901033917634, 'recall': 0.09701591329410825, 'f1-score': 0.16533758639021798, 'support': 762947}, '2': {'precision': 0.4317031959061504, 'recall': 0.6914416794463704, 'f1-score': 0.5315388768631024, 'support': 775970}, 'accuracy': 0.4498627150229729, 'macro avg': {'precision': 0.48306495058487503, 'recall': 0.44778991700711623, 'f1-score': 0.3996617321478766, 'support': 2317078}, 'weighted avg': {'precision': 0.4826148580383447, 'recall': 0.4498627150229729, 'f1-score': 0.4010756097685203, 'support': 2317078}}
[[431811  30538 315812]
 [298439  74018 390490]
 [211579  27853 536538]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0587872
{'0': {'precision': 0.44247373782921656, 'recall': 0.5714988308584347, 'f1-score': 0.49877724834754383, 'support': 231794}, '1': {'precision': 0.5668299510146956, 'recall': 0.08028711730426917, 'f1-score': 0.1406519623625767, 'support': 242131}, '2': {'precision': 0.4217320204585783, 'recall': 0.6751517852169554, 'f1-score': 0.5191673448408789, 'support': 233389}, 'accuracy': 0.43754683210002915, 'macro avg': {'precision': 0.4770119031008302, 'recall': 0.44231257779321975, 'f1-score': 0.38619885185033315, 'support': 707314}, 'weighted avg': {'precision': 0.47819988714818573, 'recall': 0.43754683210002915, 'f1-score': 0.38291016613180495, 'support': 707314}}
[[132470   7652  91672]
 [ 98303  19440 124388]
 [ 68612   7204 157573]]
training model: results/AAPL/W7/deepOF_L2/h30
Epoch 1/50
9052/9052 - 247s - loss: 3.1997 - accuracy30: 0.4196 - val_loss: 3.2186 - val_accuracy30: 0.4076 - 247s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 241s - loss: 3.1645 - accuracy30: 0.4355 - val_loss: 3.2182 - val_accuracy30: 0.4088 - 241s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 243s - loss: 3.1511 - accuracy30: 0.4406 - val_loss: 3.2245 - val_accuracy30: 0.4081 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 242s - loss: 3.1426 - accuracy30: 0.4440 - val_loss: 3.2168 - val_accuracy30: 0.4108 - 242s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 242s - loss: 3.1363 - accuracy30: 0.4463 - val_loss: 3.2126 - val_accuracy30: 0.4128 - 242s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 241s - loss: 3.1318 - accuracy30: 0.4482 - val_loss: 3.2109 - val_accuracy30: 0.4135 - 241s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 243s - loss: 3.1280 - accuracy30: 0.4495 - val_loss: 3.2094 - val_accuracy30: 0.4147 - 243s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 240s - loss: 3.1248 - accuracy30: 0.4510 - val_loss: 3.2057 - val_accuracy30: 0.4160 - 240s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 243s - loss: 3.1218 - accuracy30: 0.4520 - val_loss: 3.2049 - val_accuracy30: 0.4164 - 243s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 241s - loss: 3.1192 - accuracy30: 0.4528 - val_loss: 3.2078 - val_accuracy30: 0.4163 - 241s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 241s - loss: 3.1169 - accuracy30: 0.4538 - val_loss: 3.2053 - val_accuracy30: 0.4170 - 241s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 241s - loss: 3.1145 - accuracy30: 0.4548 - val_loss: 3.2086 - val_accuracy30: 0.4161 - 241s/epoch - 27ms/step
Epoch 13/50
9052/9052 - 243s - loss: 3.1127 - accuracy30: 0.4555 - val_loss: 3.2062 - val_accuracy30: 0.4169 - 243s/epoch - 27ms/step
Epoch 14/50
9052/9052 - 242s - loss: 3.1107 - accuracy30: 0.4561 - val_loss: 3.2055 - val_accuracy30: 0.4180 - 242s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 243s - loss: 3.1089 - accuracy30: 0.4567 - val_loss: 3.2025 - val_accuracy30: 0.4179 - 243s/epoch - 27ms/step
Epoch 16/50
9052/9052 - 244s - loss: 3.1074 - accuracy30: 0.4573 - val_loss: 3.2068 - val_accuracy30: 0.4166 - 244s/epoch - 27ms/step
Epoch 17/50
9052/9052 - 250s - loss: 3.1060 - accuracy30: 0.4581 - val_loss: 3.2072 - val_accuracy30: 0.4167 - 250s/epoch - 28ms/step
Epoch 18/50
9052/9052 - 244s - loss: 3.1041 - accuracy30: 0.4586 - val_loss: 3.2117 - val_accuracy30: 0.4157 - 244s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 244s - loss: 3.1029 - accuracy30: 0.4593 - val_loss: 3.2059 - val_accuracy30: 0.4176 - 244s/epoch - 27ms/step
Epoch 20/50
9052/9052 - 249s - loss: 3.1013 - accuracy30: 0.4596 - val_loss: 3.2073 - val_accuracy30: 0.4173 - 249s/epoch - 28ms/step
Epoch 21/50
9052/9052 - 252s - loss: 3.1001 - accuracy30: 0.4601 - val_loss: 3.2087 - val_accuracy30: 0.4173 - 252s/epoch - 28ms/step
Epoch 22/50
9052/9052 - 240s - loss: 3.0985 - accuracy30: 0.4606 - val_loss: 3.2039 - val_accuracy30: 0.4185 - 240s/epoch - 27ms/step
Epoch 23/50
9052/9052 - 240s - loss: 3.0977 - accuracy30: 0.4611 - val_loss: 3.2016 - val_accuracy30: 0.4197 - 240s/epoch - 27ms/step
Epoch 24/50
9052/9052 - 243s - loss: 3.0958 - accuracy30: 0.4616 - val_loss: 3.2019 - val_accuracy30: 0.4196 - 243s/epoch - 27ms/step
Epoch 25/50
9052/9052 - 243s - loss: 3.0949 - accuracy30: 0.4621 - val_loss: 3.2048 - val_accuracy30: 0.4191 - 243s/epoch - 27ms/step
Epoch 26/50
9052/9052 - 242s - loss: 3.0936 - accuracy30: 0.4625 - val_loss: 3.1999 - val_accuracy30: 0.4207 - 242s/epoch - 27ms/step
Epoch 27/50
9052/9052 - 247s - loss: 3.0924 - accuracy30: 0.4629 - val_loss: 3.2000 - val_accuracy30: 0.4205 - 247s/epoch - 27ms/step
Epoch 28/50
9052/9052 - 243s - loss: 3.0910 - accuracy30: 0.4633 - val_loss: 3.1966 - val_accuracy30: 0.4210 - 243s/epoch - 27ms/step
Epoch 29/50
9052/9052 - 241s - loss: 3.0901 - accuracy30: 0.4637 - val_loss: 3.2012 - val_accuracy30: 0.4208 - 241s/epoch - 27ms/step
Epoch 30/50
9052/9052 - 242s - loss: 3.0895 - accuracy30: 0.4640 - val_loss: 3.1993 - val_accuracy30: 0.4212 - 242s/epoch - 27ms/step
Epoch 31/50
9052/9052 - 243s - loss: 3.0881 - accuracy30: 0.4645 - val_loss: 3.2005 - val_accuracy30: 0.4213 - 243s/epoch - 27ms/step
Epoch 32/50
9052/9052 - 241s - loss: 3.0871 - accuracy30: 0.4650 - val_loss: 3.2012 - val_accuracy30: 0.4207 - 241s/epoch - 27ms/step
Epoch 33/50
9052/9052 - 244s - loss: 3.0854 - accuracy30: 0.4656 - val_loss: 3.1993 - val_accuracy30: 0.4218 - 244s/epoch - 27ms/step
Epoch 34/50
9052/9052 - 243s - loss: 3.0845 - accuracy30: 0.4660 - val_loss: 3.1985 - val_accuracy30: 0.4225 - 243s/epoch - 27ms/step
Epoch 35/50
9052/9052 - 241s - loss: 3.0837 - accuracy30: 0.4662 - val_loss: 3.2012 - val_accuracy30: 0.4206 - 241s/epoch - 27ms/step
Epoch 36/50
9052/9052 - 245s - loss: 3.0826 - accuracy30: 0.4666 - val_loss: 3.1987 - val_accuracy30: 0.4224 - 245s/epoch - 27ms/step
Epoch 37/50
9052/9052 - 241s - loss: 3.0816 - accuracy30: 0.4668 - val_loss: 3.2014 - val_accuracy30: 0.4212 - 241s/epoch - 27ms/step
Epoch 38/50
9052/9052 - 246s - loss: 3.0803 - accuracy30: 0.4674 - val_loss: 3.2024 - val_accuracy30: 0.4219 - 246s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h30
Evaluating performance on  test set...
23942/23942 - 336s - 336s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0825994
{'0': {'precision': 0.40286472402274476, 'recall': 0.5778982362290833, 'f1-score': 0.47476265496788606, 'support': 1923946}, '1': {'precision': 0.4839189680019684, 'recall': 0.053954372226208976, 'f1-score': 0.09708435861805267, 'support': 2296496}, '2': {'precision': 0.390994695109318, 'recall': 0.6377555056881501, 'f1-score': 0.48478050222012825, 'support': 1908617}, 'accuracy': 0.40022163271719197, 'macro avg': {'precision': 0.425926129044677, 'recall': 0.42320270471448085, 'f1-score': 0.35220917193535567, 'support': 6129059}, 'weighted avg': {'precision': 0.42953854264753744, 'recall': 0.40022163271719197, 'f1-score': 0.33637004636594986, 'support': 6129059}}
[[1111845   66916  745185]
 [1021841  123906 1150749]
 [ 626161   65225 1217231]]
Evaluating performance on  train set...
9052/9052 - 121s - 121s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0566435
{'0': {'precision': 0.42683226805021024, 'recall': 0.5844790977081258, 'f1-score': 0.49336840729685705, 'support': 771901}, '1': {'precision': 0.4806129782802012, 'recall': 0.1014422885322699, 'f1-score': 0.16752526158572378, 'support': 777861}, '2': {'precision': 0.42700793868053655, 'recall': 0.6098634721548879, 'f1-score': 0.5023121312826854, 'support': 767316}, 'accuracy': 0.4307261128024175, 'macro avg': {'precision': 0.4448177283369827, 'recall': 0.4319282861317612, 'f1-score': 0.38773526672175535, 'support': 2317078}, 'weighted avg': {'precision': 0.44494504281462927, 'recall': 0.4307261128024175, 'f1-score': 0.38694211838811166, 'support': 2317078}}
[[451160  40886 279855]
 [350866  78908 348087]
 [254970  44388 467958]]
Evaluating performance on  val set...
2763/2763 - 37s - 37s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661311
{'0': {'precision': 0.4162136294596547, 'recall': 0.599093837840613, 'f1-score': 0.49118326943381396, 'support': 233733}, '1': {'precision': 0.46936704695041687, 'recall': 0.07216190576578475, 'f1-score': 0.12509181805225134, 'support': 237175}, '2': {'precision': 0.42159040957846045, 'recall': 0.59637657250662, 'f1-score': 0.4939779931782707, 'support': 236406}, 'accuracy': 0.4214959692583492, 'macro avg': {'precision': 0.43572369532951066, 'recall': 0.42254410537100595, 'f1-score': 0.37008436022144536, 'support': 707314}, 'weighted avg': {'precision': 0.4358340029771277, 'recall': 0.4214959692583492, 'f1-score': 0.3693603583647696, 'support': 707314}}
[[140028   9024  84681]
 [111311  17115 108749]
 [ 85094  10325 140987]]
training model: results/AAPL/W7/deepOF_L2/h50
Epoch 1/50
9052/9052 - 245s - loss: 3.2286 - accuracy50: 0.4073 - val_loss: 3.2791 - val_accuracy50: 0.3761 - 245s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 244s - loss: 3.2058 - accuracy50: 0.4182 - val_loss: 3.2827 - val_accuracy50: 0.3765 - 244s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 243s - loss: 3.1965 - accuracy50: 0.4225 - val_loss: 3.2800 - val_accuracy50: 0.3789 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 242s - loss: 3.1900 - accuracy50: 0.4252 - val_loss: 3.2812 - val_accuracy50: 0.3798 - 242s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 241s - loss: 3.1854 - accuracy50: 0.4275 - val_loss: 3.2796 - val_accuracy50: 0.3806 - 241s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 244s - loss: 3.1818 - accuracy50: 0.4286 - val_loss: 3.2784 - val_accuracy50: 0.3807 - 244s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 243s - loss: 3.1791 - accuracy50: 0.4301 - val_loss: 3.2797 - val_accuracy50: 0.3814 - 243s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 243s - loss: 3.1766 - accuracy50: 0.4312 - val_loss: 3.2847 - val_accuracy50: 0.3819 - 243s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 242s - loss: 3.1744 - accuracy50: 0.4323 - val_loss: 3.2828 - val_accuracy50: 0.3819 - 242s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 241s - loss: 3.1724 - accuracy50: 0.4332 - val_loss: 3.2825 - val_accuracy50: 0.3821 - 241s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 244s - loss: 3.1707 - accuracy50: 0.4339 - val_loss: 3.2827 - val_accuracy50: 0.3824 - 244s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 242s - loss: 3.1692 - accuracy50: 0.4344 - val_loss: 3.2824 - val_accuracy50: 0.3831 - 242s/epoch - 27ms/step
Epoch 13/50
9052/9052 - 242s - loss: 3.1675 - accuracy50: 0.4352 - val_loss: 3.2857 - val_accuracy50: 0.3825 - 242s/epoch - 27ms/step
Epoch 14/50
9052/9052 - 245s - loss: 3.1661 - accuracy50: 0.4356 - val_loss: 3.2802 - val_accuracy50: 0.3835 - 245s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 257s - loss: 3.1645 - accuracy50: 0.4363 - val_loss: 3.2833 - val_accuracy50: 0.3832 - 257s/epoch - 28ms/step
Epoch 16/50
9052/9052 - 253s - loss: 3.1633 - accuracy50: 0.4368 - val_loss: 3.2836 - val_accuracy50: 0.3829 - 253s/epoch - 28ms/step
testing model: results/AAPL/W7/deepOF_L2/h50
Evaluating performance on  test set...
23942/23942 - 310s - 310s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1241459
{'0': {'precision': 0.3159910666291995, 'recall': 0.5996956312492684, 'f1-score': 0.41389366605493294, 'support': 1614489}, '1': {'precision': 0.5488146294972599, 'recall': 0.0063520592743960685, 'f1-score': 0.012558761639447611, 'support': 2900949}, '2': {'precision': 0.31377854806882216, 'recall': 0.5894872463856135, 'f1-score': 0.40955486947822506, 'support': 1613621}, 'accuracy': 0.3161721889118705, 'macro avg': {'precision': 0.39286141473176056, 'recall': 0.398511645636426, 'f1-score': 0.2786690990575352, 'support': 6129059}, 'weighted avg': {'precision': 0.4256064440413964, 'recall': 0.3161721889118705, 'f1-score': 0.22279528326891282, 'support': 6129059}}
[[ 968202    7527  638760]
 [1441025   18427 1441497]
 [ 654790    7622  951209]]
Evaluating performance on  train set...
9052/9052 - 121s - 121s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0818247
{'0': {'precision': 0.40077196387037856, 'recall': 0.5775988051736393, 'f1-score': 0.4732058945399847, 'support': 778021}, '1': {'precision': 0.4184165171819493, 'recall': 0.015414637686042083, 'f1-score': 0.029733867389850847, 'support': 771734}, '2': {'precision': 0.3967932524150834, 'recall': 0.6036532203517945, 'f1-score': 0.47883726147144173, 'support': 767323}, 'accuracy': 0.398983978959707, 'macro avg': {'precision': 0.4053272444891371, 'recall': 0.39888888773715864, 'f1-score': 0.32725900780042577, 'support': 2317078}, 'weighted avg': {'precision': 0.40533113058610426, 'recall': 0.398983978959707, 'f1-score': 0.3273664519175373, 'support': 2317078}}
[[449384   7881 320756]
 [376440  11896 383398]
 [295472   8654 463197]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0925816
{'0': {'precision': 0.37620699591500034, 'recall': 0.5896947663476909, 'f1-score': 0.459357887565647, 'support': 225827}, '1': {'precision': 0.4026271574767069, 'recall': 0.010467794456357716, 'f1-score': 0.020405082692449117, 'support': 251820}, '2': {'precision': 0.38479594220116553, 'recall': 0.5810281842842028, 'f1-score': 0.462977226362463, 'support': 229667}, 'accuracy': 0.3806626194306913, 'macro avg': {'precision': 0.3878766985309576, 'recall': 0.3937302483627505, 'f1-score': 0.314246732206853, 'support': 707314}, 'weighted avg': {'precision': 0.3884020360402823, 'recall': 0.3806626194306913, 'f1-score': 0.3042558358040244, 'support': 707314}}
[[133169   1785  90873]
 [126711   2636 122473]
 [ 94098   2126 133443]]
training model: results/AAPL/W7/deepOF_L2/h100
Epoch 1/50
9052/9052 - 245s - loss: 3.2638 - accuracy100: 0.3854 - val_loss: 3.2858 - val_accuracy100: 0.3646 - 245s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 245s - loss: 3.2489 - accuracy100: 0.3941 - val_loss: 3.2874 - val_accuracy100: 0.3658 - 245s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 258s - loss: 3.2424 - accuracy100: 0.3984 - val_loss: 3.2907 - val_accuracy100: 0.3657 - 258s/epoch - 29ms/step
Epoch 4/50
9052/9052 - 251s - loss: 3.2379 - accuracy100: 0.4010 - val_loss: 3.2927 - val_accuracy100: 0.3653 - 251s/epoch - 28ms/step
Epoch 5/50
9052/9052 - 241s - loss: 3.2347 - accuracy100: 0.4027 - val_loss: 3.2937 - val_accuracy100: 0.3656 - 241s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 242s - loss: 3.2322 - accuracy100: 0.4039 - val_loss: 3.2898 - val_accuracy100: 0.3670 - 242s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 242s - loss: 3.2302 - accuracy100: 0.4053 - val_loss: 3.2925 - val_accuracy100: 0.3659 - 242s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 243s - loss: 3.2283 - accuracy100: 0.4059 - val_loss: 3.2932 - val_accuracy100: 0.3673 - 243s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 249s - loss: 3.2263 - accuracy100: 0.4072 - val_loss: 3.2941 - val_accuracy100: 0.3671 - 249s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 261s - loss: 3.2249 - accuracy100: 0.4079 - val_loss: 3.2965 - val_accuracy100: 0.3647 - 261s/epoch - 29ms/step
Epoch 11/50
9052/9052 - 245s - loss: 3.2234 - accuracy100: 0.4088 - val_loss: 3.2965 - val_accuracy100: 0.3648 - 245s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h100
Evaluating performance on  test set...
23942/23942 - 322s - 322s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1011024
{'0': {'precision': 0.32131368929381127, 'recall': 0.6357391962261091, 'f1-score': 0.4268765282644176, 'support': 1800158}, '1': {'precision': 0.4479036651516222, 'recall': 0.022520230830589908, 'f1-score': 0.04288427528971952, 'support': 2533633}, '2': {'precision': 0.3306746668469986, 'recall': 0.44941925105332464, 'f1-score': 0.3810094084996434, 'support': 1795268}, 'accuracy': 0.32767134400239906, 'macro avg': {'precision': 0.36663067376414404, 'recall': 0.36922622603667454, 'f1-score': 0.28359007068459346, 'support': 6129059}, 'weighted avg': {'precision': 0.3763854390930069, 'recall': 0.32767134400239906, 'f1-score': 0.2547066705020906, 'support': 6129059}}
[[1144431   32852  622875]
 [1466333   57058 1010242]
 [ 950961   37479  806828]]
Evaluating performance on  train set...
9052/9052 - 117s - 117s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0913051
{'0': {'precision': 0.3714576162503025, 'recall': 0.617431462977197, 'f1-score': 0.46385307362198774, 'support': 780600}, '1': {'precision': 0.38693191599242555, 'recall': 0.047047972893418284, 'f1-score': 0.08389495809101238, 'support': 764390}, '2': {'precision': 0.38190781237859256, 'recall': 0.4583518977111417, 'f1-score': 0.41665253838184046, 'support': 772088}, 'accuracy': 0.37625751053697803, 'macro avg': {'precision': 0.38009911487377357, 'recall': 0.374277111193919, 'f1-score': 0.3214668566982802, 'support': 2317078}, 'weighted avg': {'precision': 0.38004466899871264, 'recall': 0.37625751053697803, 'f1-score': 0.3227792078379196, 'support': 2317078}}
[[481967  28779 269854]
 [425537  35963 302890]
 [389998  28202 353888]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09452
{'0': {'precision': 0.35525108836505004, 'recall': 0.6358073216387476, 'f1-score': 0.45581822569220115, 'support': 230249}, '1': {'precision': 0.38351852734989744, 'recall': 0.033535720838684925, 'f1-score': 0.06167816453390496, 'support': 239804}, '2': {'precision': 0.3780842196609774, 'recall': 0.4370419074352717, 'f1-score': 0.4054308726931498, 'support': 237261}, 'accuracy': 0.36494258561261333, 'macro avg': {'precision': 0.3722846117919749, 'recall': 0.36879498330423477, 'f1-score': 0.3076424209730853, 'support': 707314}, 'weighted avg': {'precision': 0.37249386385475525, 'recall': 0.36494258561261333, 'f1-score': 0.3052891579996177, 'support': 707314}}
[[146394   6294  77561]
 [138757   8042  93005]
 [126935   6633 103693]]
training model: results/AAPL/W7/deepOF_L2/h200
Epoch 1/50
9052/9052 - 254s - loss: 3.2664 - accuracy200: 0.3824 - val_loss: 3.3081 - val_accuracy200: 0.3492 - 254s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 251s - loss: 3.2573 - accuracy200: 0.3882 - val_loss: 3.3224 - val_accuracy200: 0.3492 - 251s/epoch - 28ms/step
Epoch 3/50
9052/9052 - 243s - loss: 3.2516 - accuracy200: 0.3919 - val_loss: 3.3273 - val_accuracy200: 0.3508 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 244s - loss: 3.2477 - accuracy200: 0.3941 - val_loss: 3.3288 - val_accuracy200: 0.3517 - 244s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 244s - loss: 3.2444 - accuracy200: 0.3959 - val_loss: 3.3306 - val_accuracy200: 0.3510 - 244s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 242s - loss: 3.2423 - accuracy200: 0.3971 - val_loss: 3.3330 - val_accuracy200: 0.3508 - 242s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 245s - loss: 3.2409 - accuracy200: 0.3977 - val_loss: 3.3251 - val_accuracy200: 0.3508 - 245s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 250s - loss: 3.2394 - accuracy200: 0.3988 - val_loss: 3.3301 - val_accuracy200: 0.3496 - 250s/epoch - 28ms/step
Epoch 9/50
9052/9052 - 248s - loss: 3.2376 - accuracy200: 0.3998 - val_loss: 3.3320 - val_accuracy200: 0.3504 - 248s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 249s - loss: 3.2365 - accuracy200: 0.4009 - val_loss: 3.3316 - val_accuracy200: 0.3499 - 249s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 246s - loss: 3.2352 - accuracy200: 0.4014 - val_loss: 3.3325 - val_accuracy200: 0.3495 - 246s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h200
Evaluating performance on  test set...
23942/23942 - 298s - 298s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.115339
{'0': {'precision': 0.298362786287368, 'recall': 0.5646719554556242, 'f1-score': 0.39042946898712055, 'support': 1714066}, '1': {'precision': 0.4601285865080127, 'recall': 0.0017669133589704661, 'f1-score': 0.003520308583129022, 'support': 2713772}, '2': {'precision': 0.2959980185420769, 'recall': 0.5001648815762326, 'f1-score': 0.37190332247055863, 'support': 1701221}, 'accuracy': 0.2975287070984306, 'macro avg': {'precision': 0.3514964637791525, 'recall': 0.35553458346360917, 'f1-score': 0.2552843666802694, 'support': 6129059}, 'weighted avg': {'precision': 0.36933167509198994, 'recall': 0.2975287070984306, 'f1-score': 0.21397492424364317, 'support': 6129059}}
[[ 967885    2605  743576]
 [1428793    4795 1280184]
 [ 847309    3021  850891]]
Evaluating performance on  train set...
9052/9052 - 117s - 117s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.096288
{'0': {'precision': 0.36401133478323155, 'recall': 0.5707787650378778, 'f1-score': 0.44452747235368306, 'support': 787927}, '1': {'precision': 0.38779527559055116, 'recall': 0.004205094407838126, 'f1-score': 0.008319970436653272, 'support': 749567}, '2': {'precision': 0.3634496269543095, 'recall': 0.500457936540514, 'f1-score': 0.42108961196301226, 'support': 779584}, 'accuracy': 0.36383453642907143, 'macro avg': {'precision': 0.3717520791093641, 'recall': 0.35848059866207665, 'f1-score': 0.2913123515844495, 'support': 2317078}, 'weighted avg': {'precision': 0.3715163729058229, 'recall': 0.36383453642907143, 'f1-score': 0.2955301017238455, 'support': 2317078}}
[[449732   2554 335641]
 [398744   3152 347671]
 [387013   2422 390149]]
Evaluating performance on  val set...
2763/2763 - 38s - 38s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1000384
{'0': {'precision': 0.3427875582060289, 'recall': 0.5901686899498062, 'f1-score': 0.43368053873358847, 'support': 227518}, '1': {'precision': 0.38842315369261476, 'recall': 0.00400460962258715, 'f1-score': 0.007927487524187798, 'support': 242970}, '2': {'precision': 0.35848315378301293, 'recall': 0.47393444976480625, 'f1-score': 0.4082026029098619, 'support': 236826}, 'accuracy': 0.34989693403495475, 'macro avg': {'precision': 0.3632312885605522, 'recall': 0.35603591644573324, 'f1-score': 0.2832702097225461, 'support': 707314}, 'weighted avg': {'precision': 0.3637191469395908, 'recall': 0.34989693403495475, 'f1-score': 0.2788991312091538, 'support': 707314}}
[[134274    750  92494]
 [133634    973 108363]
 [123804    782 112240]]
training model: results/AAPL/W7/deepOF_L2/h300
Epoch 1/50
9052/9052 - 253s - loss: 3.2771 - accuracy300: 0.3714 - val_loss: 3.3020 - val_accuracy300: 0.3385 - 253s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 248s - loss: 3.2681 - accuracy300: 0.3778 - val_loss: 3.3075 - val_accuracy300: 0.3396 - 248s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 243s - loss: 3.2627 - accuracy300: 0.3823 - val_loss: 3.3130 - val_accuracy300: 0.3406 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 242s - loss: 3.2589 - accuracy300: 0.3848 - val_loss: 3.3210 - val_accuracy300: 0.3402 - 242s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 241s - loss: 3.2559 - accuracy300: 0.3864 - val_loss: 3.3264 - val_accuracy300: 0.3395 - 241s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 244s - loss: 3.2538 - accuracy300: 0.3878 - val_loss: 3.3239 - val_accuracy300: 0.3386 - 244s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 253s - loss: 3.2520 - accuracy300: 0.3892 - val_loss: 3.3276 - val_accuracy300: 0.3392 - 253s/epoch - 28ms/step
Epoch 8/50
9052/9052 - 251s - loss: 3.2504 - accuracy300: 0.3901 - val_loss: 3.3286 - val_accuracy300: 0.3400 - 251s/epoch - 28ms/step
Epoch 9/50
9052/9052 - 248s - loss: 3.2489 - accuracy300: 0.3911 - val_loss: 3.3284 - val_accuracy300: 0.3394 - 248s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 242s - loss: 3.2478 - accuracy300: 0.3920 - val_loss: 3.3305 - val_accuracy300: 0.3375 - 242s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 246s - loss: 3.2466 - accuracy300: 0.3929 - val_loss: 3.3327 - val_accuracy300: 0.3399 - 246s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h300
Evaluating performance on  test set...
23942/23942 - 301s - 301s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1056569
{'0': {'precision': 0.30491316046499484, 'recall': 0.6638903830051515, 'f1-score': 0.417894662439691, 'support': 1803370}, '1': {'precision': 0.42690803374743375, 'recall': 0.011214277813184334, 'f1-score': 0.02185446924202858, 'support': 2540333}, '2': {'precision': 0.30948252976707447, 'recall': 0.3702359641438458, 'f1-score': 0.3371441672411098, 'support': 1785356}, 'accuracy': 0.307833714767634, 'macro avg': {'precision': 0.34710124132650105, 'recall': 0.34844687498739385, 'f1-score': 0.25896443297427646, 'support': 6129059}, 'weighted avg': {'precision': 0.3568078401099259, 'recall': 0.307833714767634, 'f1-score': 0.23022436048760417, 'support': 6129059}}
[[1197240   18624  587506]
 [1624521   28488  887324]
 [1104734   19619  661003]]
Evaluating performance on  train set...
9052/9052 - 115s - 115s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0977197
{'0': {'precision': 0.3482839131599148, 'recall': 0.7004965927540908, 'f1-score': 0.46524833957885625, 'support': 777901}, '1': {'precision': 0.36821834858300495, 'recall': 0.021577815813642817, 'f1-score': 0.04076667977082915, 'support': 766528}, '2': {'precision': 0.35886582756486174, 'recall': 0.3286447015397677, 'f1-score': 0.3430910445734483, 'support': 772649}, 'accuracy': 0.35190183498354394, 'macro avg': {'precision': 0.3584560297692605, 'recall': 0.3502397033691671, 'f1-score': 0.28303535464104457, 'support': 2317078}, 'weighted avg': {'precision': 0.3584071841499541, 'recall': 0.35190183498354394, 'f1-score': 0.28408836587147096, 'support': 2317078}}
[[544917  14320 218664]
 [514997  16540 234991]
 [504663  14059 253927]]
Evaluating performance on  val set...
2763/2763 - 36s - 36s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1000919
{'0': {'precision': 0.3302897372250278, 'recall': 0.6856692283772378, 'f1-score': 0.44582412662651816, 'support': 225110}, '1': {'precision': 0.35882437897169267, 'recall': 0.020173682864346294, 'f1-score': 0.038199716327322907, 'support': 246311}, '2': {'precision': 0.35333810900922413, 'recall': 0.3387383262750484, 'f1-score': 0.34588422189468854, 'support': 235893}, 'accuracy': 0.3382175384624085, 'macro avg': {'precision': 0.34748407506864815, 'recall': 0.3481937458388775, 'f1-score': 0.2766360216161765, 'support': 707314}, 'weighted avg': {'precision': 0.3479132335909306, 'recall': 0.3382175384624085, 'f1-score': 0.27054483048348893, 'support': 707314}}
[[154351   4174  66585]
 [161687   4969  79655]
 [151282   4705  79906]]
training model: results/AAPL/W7/deepOF_L2/h500
Epoch 1/50
9052/9052 - 246s - loss: 3.2803 - accuracy500: 0.3698 - val_loss: 3.2990 - val_accuracy500: 0.3351 - 246s/epoch - 27ms/step
Epoch 2/50
9052/9052 - 248s - loss: 3.2716 - accuracy500: 0.3742 - val_loss: 3.3138 - val_accuracy500: 0.3326 - 248s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 243s - loss: 3.2657 - accuracy500: 0.3797 - val_loss: 3.3223 - val_accuracy500: 0.3332 - 243s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 244s - loss: 3.2622 - accuracy500: 0.3823 - val_loss: 3.3265 - val_accuracy500: 0.3304 - 244s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 243s - loss: 3.2597 - accuracy500: 0.3839 - val_loss: 3.3271 - val_accuracy500: 0.3313 - 243s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 244s - loss: 3.2580 - accuracy500: 0.3850 - val_loss: 3.3309 - val_accuracy500: 0.3304 - 244s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 244s - loss: 3.2561 - accuracy500: 0.3863 - val_loss: 3.3330 - val_accuracy500: 0.3279 - 244s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 243s - loss: 3.2549 - accuracy500: 0.3871 - val_loss: 3.3297 - val_accuracy500: 0.3292 - 243s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 242s - loss: 3.2535 - accuracy500: 0.3880 - val_loss: 3.3288 - val_accuracy500: 0.3280 - 242s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 243s - loss: 3.2523 - accuracy500: 0.3890 - val_loss: 3.3273 - val_accuracy500: 0.3296 - 243s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 246s - loss: 3.2513 - accuracy500: 0.3896 - val_loss: 3.3284 - val_accuracy500: 0.3302 - 246s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h500
Evaluating performance on  test set...
23942/23942 - 288s - 288s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1044008
{'0': {'precision': 0.29759212535271473, 'recall': 0.5093515962733832, 'f1-score': 0.37568673012621573, 'support': 1768682}, '1': {'precision': 0.43550996083773197, 'recall': 0.015700627656799103, 'f1-score': 0.030308596075968492, 'support': 2606520}, '2': {'precision': 0.29272269260141026, 'recall': 0.5020181234844118, 'f1-score': 0.3698113746436682, 'support': 1753857}, 'accuracy': 0.2973169290750831, 'macro avg': {'precision': 0.34194159293061893, 'recall': 0.3423567824715314, 'f1-score': 0.25860223361528417, 'support': 6129059}, 'weighted avg': {'precision': 0.35485137311513676, 'recall': 0.2973169290750831, 'f1-score': 0.22712566270865545, 'support': 6129059}}
[[ 900881   26307  841494]
 [1279701   40924 1285895]
 [ 846652   26737  880468]]
Evaluating performance on  train set...
9052/9052 - 111s - 111s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985587
{'0': {'precision': 0.34352505753307655, 'recall': 0.5624855941926143, 'f1-score': 0.42654663218031874, 'support': 772258}, '1': {'precision': 0.3609629221802442, 'recall': 0.024454679804856466, 'f1-score': 0.04580606924996868, 'support': 777479}, '2': {'precision': 0.34422725931704196, 'recall': 0.44855937581857347, 'f1-score': 0.3895281724888754, 'support': 767341}, 'accuracy': 0.34422449309000386, 'macro avg': {'precision': 0.3495717463434542, 'recall': 0.3451665499386814, 'f1-score': 0.2872936246397209, 'support': 2317078}, 'weighted avg': {'precision': 0.34960875509833983, 'recall': 0.34422449309000386, 'f1-score': 0.28653253942875084, 'support': 2317078}}
[[434384  17017 320857]
 [423606  19013 334860]
 [406500  16643 344198]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0999022
{'0': {'precision': 0.3246390545004672, 'recall': 0.5527757110714702, 'f1-score': 0.40904847110953385, 'support': 223114}, '1': {'precision': 0.3570718781053329, 'recall': 0.02184937309730065, 'f1-score': 0.041178987256669616, 'support': 246689}, '2': {'precision': 0.3441632459639978, 'recall': 0.45255588162232485, 'f1-score': 0.3909862228891011, 'support': 237511}, 'accuracy': 0.333952106136737, 'macro avg': {'precision': 0.341958059523266, 'recall': 0.3423936552636985, 'f1-score': 0.28040456041843487, 'support': 707314}, 'weighted avg': {'precision': 0.34250669328742084, 'recall': 0.333952106136737, 'f1-score': 0.2746819270580059, 'support': 707314}}
[[123332   4563  95219]
 [131691   5390 109608]
 [124882   5142 107487]]
training model: results/AAPL/W7/deepOF_L2/h1000
Epoch 1/50
9052/9052 - 258s - loss: 3.2816 - accuracy1000: 0.3680 - val_loss: 3.3092 - val_accuracy1000: 0.3291 - 258s/epoch - 29ms/step
Epoch 2/50
9052/9052 - 246s - loss: 3.2711 - accuracy1000: 0.3732 - val_loss: 3.3186 - val_accuracy1000: 0.3307 - 246s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 244s - loss: 3.2658 - accuracy1000: 0.3777 - val_loss: 3.3207 - val_accuracy1000: 0.3325 - 244s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 246s - loss: 3.2624 - accuracy1000: 0.3809 - val_loss: 3.3218 - val_accuracy1000: 0.3323 - 246s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 250s - loss: 3.2596 - accuracy1000: 0.3832 - val_loss: 3.3240 - val_accuracy1000: 0.3317 - 250s/epoch - 28ms/step
Epoch 6/50
9052/9052 - 241s - loss: 3.2568 - accuracy1000: 0.3853 - val_loss: 3.3239 - val_accuracy1000: 0.3308 - 241s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 245s - loss: 3.2546 - accuracy1000: 0.3872 - val_loss: 3.3227 - val_accuracy1000: 0.3294 - 245s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 247s - loss: 3.2527 - accuracy1000: 0.3885 - val_loss: 3.3242 - val_accuracy1000: 0.3292 - 247s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 255s - loss: 3.2509 - accuracy1000: 0.3895 - val_loss: 3.3244 - val_accuracy1000: 0.3285 - 255s/epoch - 28ms/step
Epoch 10/50
9052/9052 - 251s - loss: 3.2496 - accuracy1000: 0.3904 - val_loss: 3.3239 - val_accuracy1000: 0.3283 - 251s/epoch - 28ms/step
Epoch 11/50
9052/9052 - 243s - loss: 3.2480 - accuracy1000: 0.3917 - val_loss: 3.3238 - val_accuracy1000: 0.3280 - 243s/epoch - 27ms/step
testing model: results/AAPL/W7/deepOF_L2/h1000
Evaluating performance on  test set...
23942/23942 - 297s - 297s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1108377
{'0': {'precision': 0.29820693067568843, 'recall': 0.40378593188661444, 'f1-score': 0.3430569449336621, 'support': 1809013}, '1': {'precision': 0.4137952443037189, 'recall': 0.0026445904535244476, 'f1-score': 0.005255592099816035, 'support': 2520239}, '2': {'precision': 0.29068900617311755, 'recall': 0.5916906646101499, 'f1-score': 0.3898502582335275, 'support': 1799807}, 'accuracy': 0.2940170750518146, 'macro avg': {'precision': 0.33423039371750835, 'recall': 0.3327070623167629, 'f1-score': 0.24605426508900186, 'support': 6129059}, 'weighted avg': {'precision': 0.34352862896646935, 'recall': 0.2940170750518146, 'f1-score': 0.2178956092646257, 'support': 6129059}}
[[ 730454    4955 1073604]
 [ 988642    6665 1524932]
 [ 730391    4487 1064929]]
Evaluating performance on  train set...
9052/9052 - 110s - 110s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1003596
{'0': {'precision': 0.3394273856101359, 'recall': 0.5260226223364427, 'f1-score': 0.41260958306552525, 'support': 778611}, '1': {'precision': 0.36156615661566155, 'recall': 0.005253576276905451, 'f1-score': 0.010356669571449933, 'support': 764622}, '2': {'precision': 0.3355825882562695, 'recall': 0.4767298360782844, 'f1-score': 0.3938933530930422, 'support': 773845}, 'accuracy': 0.3377093908793748, 'macro avg': {'precision': 0.3455253768273557, 'recall': 0.33600201156387755, 'f1-score': 0.2722865352433391, 'support': 2317078}, 'weighted avg': {'precision': 0.34544898443222316, 'recall': 0.3377093908793748, 'f1-score': 0.2736177631074906, 'support': 2317078}}
[[409567   3864 365180]
 [395373   4017 365232]
 [401701   3229 368915]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1022831
{'0': {'precision': 0.3184651343981301, 'recall': 0.4924654516683, 'f1-score': 0.386797782564175, 'support': 222442}, '1': {'precision': 0.33033642691415316, 'recall': 0.004712511946776335, 'f1-score': 0.009292459564747394, 'support': 241697}, '2': {'precision': 0.33912772862668383, 'recall': 0.5018936979541483, 'f1-score': 0.4047603650033247, 'support': 243175}, 'accuracy': 0.3290363261578309, 'macro avg': {'precision': 0.32930976331298906, 'recall': 0.3330238871897416, 'f1-score': 0.2669502023774157, 'support': 707314}, 'weighted avg': {'precision': 0.32962549901522203, 'recall': 0.3290363261578309, 'f1-score': 0.263975594584929, 'support': 707314}}
[[109545   1084 111813]
 [114531   1139 126027]
 [119902   1225 122048]]
training model: results/AAPL/W7/deepVOL_L2/h10
Epoch 1/50
9052/9052 - 250s - loss: 3.1087 - accuracy10: 0.4608 - val_loss: 3.1223 - val_accuracy10: 0.4669 - 250s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 248s - loss: 3.0246 - accuracy10: 0.4925 - val_loss: 3.0788 - val_accuracy10: 0.4792 - 248s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 245s - loss: 2.9985 - accuracy10: 0.4996 - val_loss: 3.0790 - val_accuracy10: 0.4759 - 245s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 247s - loss: 2.9826 - accuracy10: 0.5042 - val_loss: 3.0629 - val_accuracy10: 0.4818 - 247s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 246s - loss: 2.9698 - accuracy10: 0.5075 - val_loss: 3.0596 - val_accuracy10: 0.4827 - 246s/epoch - 27ms/step
Epoch 6/50
9052/9052 - 247s - loss: 2.9603 - accuracy10: 0.5102 - val_loss: 3.0492 - val_accuracy10: 0.4843 - 247s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 249s - loss: 2.9532 - accuracy10: 0.5118 - val_loss: 3.0396 - val_accuracy10: 0.4887 - 249s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 247s - loss: 2.9476 - accuracy10: 0.5134 - val_loss: 3.0432 - val_accuracy10: 0.4886 - 247s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 249s - loss: 2.9423 - accuracy10: 0.5147 - val_loss: 3.0328 - val_accuracy10: 0.4897 - 249s/epoch - 28ms/step
Epoch 10/50
9052/9052 - 246s - loss: 2.9383 - accuracy10: 0.5158 - val_loss: 3.0325 - val_accuracy10: 0.4896 - 246s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 246s - loss: 2.9345 - accuracy10: 0.5169 - val_loss: 3.0271 - val_accuracy10: 0.4928 - 246s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 247s - loss: 2.9307 - accuracy10: 0.5178 - val_loss: 3.0273 - val_accuracy10: 0.4918 - 247s/epoch - 27ms/step
Epoch 13/50
9052/9052 - 248s - loss: 2.9277 - accuracy10: 0.5184 - val_loss: 3.0237 - val_accuracy10: 0.4934 - 248s/epoch - 27ms/step
Epoch 14/50
9052/9052 - 251s - loss: 2.9249 - accuracy10: 0.5193 - val_loss: 3.0120 - val_accuracy10: 0.4964 - 251s/epoch - 28ms/step
Epoch 15/50
9052/9052 - 254s - loss: 2.9220 - accuracy10: 0.5199 - val_loss: 3.0114 - val_accuracy10: 0.4957 - 254s/epoch - 28ms/step
Epoch 16/50
9052/9052 - 247s - loss: 2.9194 - accuracy10: 0.5206 - val_loss: 3.0134 - val_accuracy10: 0.4960 - 247s/epoch - 27ms/step
Epoch 17/50
9052/9052 - 249s - loss: 2.9164 - accuracy10: 0.5211 - val_loss: 3.0069 - val_accuracy10: 0.4970 - 249s/epoch - 28ms/step
Epoch 18/50
9052/9052 - 245s - loss: 2.9145 - accuracy10: 0.5218 - val_loss: 3.0052 - val_accuracy10: 0.4979 - 245s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 248s - loss: 2.9120 - accuracy10: 0.5223 - val_loss: 3.0013 - val_accuracy10: 0.4984 - 248s/epoch - 27ms/step
Epoch 20/50
9052/9052 - 248s - loss: 2.9099 - accuracy10: 0.5230 - val_loss: 3.0031 - val_accuracy10: 0.4976 - 248s/epoch - 27ms/step
Epoch 21/50
9052/9052 - 246s - loss: 2.9078 - accuracy10: 0.5235 - val_loss: 2.9998 - val_accuracy10: 0.4990 - 246s/epoch - 27ms/step
Epoch 22/50
9052/9052 - 248s - loss: 2.9061 - accuracy10: 0.5239 - val_loss: 2.9979 - val_accuracy10: 0.4992 - 248s/epoch - 27ms/step
Epoch 23/50
9052/9052 - 252s - loss: 2.9039 - accuracy10: 0.5246 - val_loss: 2.9967 - val_accuracy10: 0.4993 - 252s/epoch - 28ms/step
Epoch 24/50
9052/9052 - 252s - loss: 2.9017 - accuracy10: 0.5249 - val_loss: 2.9951 - val_accuracy10: 0.5001 - 252s/epoch - 28ms/step
Epoch 25/50
9052/9052 - 245s - loss: 2.9002 - accuracy10: 0.5253 - val_loss: 2.9964 - val_accuracy10: 0.4999 - 245s/epoch - 27ms/step
Epoch 26/50
9052/9052 - 247s - loss: 2.8987 - accuracy10: 0.5259 - val_loss: 2.9943 - val_accuracy10: 0.4991 - 247s/epoch - 27ms/step
Epoch 27/50
9052/9052 - 248s - loss: 2.8971 - accuracy10: 0.5262 - val_loss: 2.9931 - val_accuracy10: 0.5001 - 248s/epoch - 27ms/step
Epoch 28/50
9052/9052 - 247s - loss: 2.8953 - accuracy10: 0.5268 - val_loss: 2.9890 - val_accuracy10: 0.5009 - 247s/epoch - 27ms/step
Epoch 29/50
9052/9052 - 246s - loss: 2.8939 - accuracy10: 0.5271 - val_loss: 2.9934 - val_accuracy10: 0.5001 - 246s/epoch - 27ms/step
Epoch 30/50
9052/9052 - 249s - loss: 2.8921 - accuracy10: 0.5275 - val_loss: 2.9912 - val_accuracy10: 0.5008 - 249s/epoch - 28ms/step
Epoch 31/50
9052/9052 - 250s - loss: 2.8909 - accuracy10: 0.5277 - val_loss: 2.9860 - val_accuracy10: 0.5018 - 250s/epoch - 28ms/step
Epoch 32/50
9052/9052 - 248s - loss: 2.8894 - accuracy10: 0.5282 - val_loss: 2.9886 - val_accuracy10: 0.5013 - 248s/epoch - 27ms/step
Epoch 33/50
9052/9052 - 247s - loss: 2.8880 - accuracy10: 0.5287 - val_loss: 2.9871 - val_accuracy10: 0.5016 - 247s/epoch - 27ms/step
Epoch 34/50
9052/9052 - 249s - loss: 2.8875 - accuracy10: 0.5283 - val_loss: 2.9860 - val_accuracy10: 0.5027 - 249s/epoch - 27ms/step
Epoch 35/50
9052/9052 - 249s - loss: 2.8860 - accuracy10: 0.5288 - val_loss: 2.9851 - val_accuracy10: 0.5030 - 249s/epoch - 27ms/step
Epoch 36/50
9052/9052 - 249s - loss: 2.8843 - accuracy10: 0.5297 - val_loss: 2.9859 - val_accuracy10: 0.5019 - 249s/epoch - 28ms/step
Epoch 37/50
9052/9052 - 247s - loss: 2.8832 - accuracy10: 0.5296 - val_loss: 2.9866 - val_accuracy10: 0.5013 - 247s/epoch - 27ms/step
Epoch 38/50
9052/9052 - 251s - loss: 2.8819 - accuracy10: 0.5301 - val_loss: 2.9829 - val_accuracy10: 0.5023 - 251s/epoch - 28ms/step
Epoch 39/50
9052/9052 - 252s - loss: 2.8809 - accuracy10: 0.5303 - val_loss: 2.9836 - val_accuracy10: 0.5020 - 252s/epoch - 28ms/step
Epoch 40/50
9052/9052 - 248s - loss: 2.8797 - accuracy10: 0.5306 - val_loss: 2.9824 - val_accuracy10: 0.5029 - 248s/epoch - 27ms/step
Epoch 41/50
9052/9052 - 243s - loss: 2.8785 - accuracy10: 0.5308 - val_loss: 2.9822 - val_accuracy10: 0.5033 - 243s/epoch - 27ms/step
Epoch 42/50
9052/9052 - 250s - loss: 2.8772 - accuracy10: 0.5311 - val_loss: 2.9835 - val_accuracy10: 0.5022 - 250s/epoch - 28ms/step
Epoch 43/50
9052/9052 - 251s - loss: 2.8761 - accuracy10: 0.5317 - val_loss: 2.9765 - val_accuracy10: 0.5047 - 251s/epoch - 28ms/step
Epoch 44/50
9052/9052 - 253s - loss: 2.8752 - accuracy10: 0.5317 - val_loss: 2.9823 - val_accuracy10: 0.5027 - 253s/epoch - 28ms/step
Epoch 45/50
9052/9052 - 251s - loss: 2.8746 - accuracy10: 0.5319 - val_loss: 2.9812 - val_accuracy10: 0.5036 - 251s/epoch - 28ms/step
Epoch 46/50
9052/9052 - 256s - loss: 2.8730 - accuracy10: 0.5323 - val_loss: 2.9809 - val_accuracy10: 0.5032 - 256s/epoch - 28ms/step
Epoch 47/50
9052/9052 - 250s - loss: 2.8725 - accuracy10: 0.5324 - val_loss: 2.9785 - val_accuracy10: 0.5043 - 250s/epoch - 28ms/step
Epoch 48/50
9052/9052 - 249s - loss: 2.8714 - accuracy10: 0.5327 - val_loss: 2.9775 - val_accuracy10: 0.5050 - 249s/epoch - 28ms/step
Epoch 49/50
9052/9052 - 251s - loss: 2.8702 - accuracy10: 0.5331 - val_loss: 2.9809 - val_accuracy10: 0.5034 - 251s/epoch - 28ms/step
Epoch 50/50
9052/9052 - 256s - loss: 2.8694 - accuracy10: 0.5331 - val_loss: 2.9847 - val_accuracy10: 0.5023 - 256s/epoch - 28ms/step
testing model: results/AAPL/W7/deepVOL_L2/h10
Evaluating performance on  test set...
23942/23942 - 321s - 321s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0068287
{'0': {'precision': 0.4562476730599467, 'recall': 0.6222314832112639, 'f1-score': 0.5264666723858068, 'support': 1878849}, '1': {'precision': 0.5660387502494695, 'recall': 0.2916809035966053, 'f1-score': 0.38498055490072186, 'support': 2382302}, '2': {'precision': 0.46975756718129896, 'recall': 0.5882506305165176, 'f1-score': 0.5223687031643021, 'support': 1867913}, 'accuracy': 0.4833938754759291, 'macro avg': {'precision': 0.4973479968302384, 'recall': 0.5007210057747956, 'f1-score': 0.4779386434836102, 'support': 6129064}, 'weighted avg': {'precision': 0.5030396154558251, 'recall': 0.4833938754759291, 'f1-score': 0.4702236129823805, 'support': 6129064}}
[[1169079  263870  445900]
 [ 893050  694872  794380]
 [ 500249  268863 1098801]]
Evaluating performance on  train set...
9052/9052 - 112s - 112s/epoch - 12ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97886735
{'0': {'precision': 0.502107224889508, 'recall': 0.6177239821831847, 'f1-score': 0.5539471886169015, 'support': 784203}, '1': {'precision': 0.5742717212466002, 'recall': 0.31771715188025795, 'f1-score': 0.409099219007622, 'support': 753620}, '2': {'precision': 0.5042945939646896, 'recall': 0.6053176294855227, 'f1-score': 0.5502073638516778, 'support': 779257}, 'accuracy': 0.5159757108084313, 'macro avg': {'precision': 0.5268911800335992, 'recall': 0.5135862545163218, 'f1-score': 0.5044179238254004, 'support': 2317080}, 'weighted avg': {'precision': 0.526314041403418, 'recall': 0.5159757108084313, 'f1-score': 0.505578288326873, 'support': 2317080}}
[[484421  88137 211645]
 [262163 239438 252019]
 [218192  89367 471698]]
Evaluating performance on  val set...
2763/2763 - 36s - 36s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9897258
{'0': {'precision': 0.4855657766808765, 'recall': 0.6132468357691184, 'f1-score': 0.5419880928439434, 'support': 232916}, '1': {'precision': 0.5797566338363302, 'recall': 0.31998038408950175, 'f1-score': 0.41236660641360384, 'support': 240621}, '2': {'precision': 0.4887836232695676, 'recall': 0.5861543857848044, 'f1-score': 0.5330589523600201, 'support': 233778}, 'accuracy': 0.5045262718873487, 'macro avg': {'precision': 0.5180353445955914, 'recall': 0.5064605352144749, 'f1-score': 0.4958045505391892, 'support': 707315}, 'weighted avg': {'precision': 0.5186720447218675, 'recall': 0.5045262718873487, 'f1-score': 0.494941037019586, 'support': 707315}}
[[142835  26465  63616]
 [ 83924  76994  79703]
 [ 67403  29345 137030]]
training model: results/AAPL/W7/deepVOL_L2/h20
Epoch 1/50
9052/9052 - 254s - loss: 3.2169 - accuracy20: 0.4108 - val_loss: 3.2400 - val_accuracy20: 0.4076 - 254s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 250s - loss: 3.1535 - accuracy20: 0.4430 - val_loss: 3.1994 - val_accuracy20: 0.4302 - 250s/epoch - 28ms/step
Epoch 3/50
9052/9052 - 249s - loss: 3.1243 - accuracy20: 0.4547 - val_loss: 3.2061 - val_accuracy20: 0.4270 - 249s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 251s - loss: 3.1075 - accuracy20: 0.4606 - val_loss: 3.2038 - val_accuracy20: 0.4255 - 251s/epoch - 28ms/step
Epoch 5/50
9052/9052 - 250s - loss: 3.0958 - accuracy20: 0.4650 - val_loss: 3.2033 - val_accuracy20: 0.4269 - 250s/epoch - 28ms/step
Epoch 6/50
9052/9052 - 258s - loss: 3.0866 - accuracy20: 0.4677 - val_loss: 3.2016 - val_accuracy20: 0.4257 - 258s/epoch - 29ms/step
Epoch 7/50
9052/9052 - 258s - loss: 3.0798 - accuracy20: 0.4699 - val_loss: 3.1949 - val_accuracy20: 0.4284 - 258s/epoch - 29ms/step
Epoch 8/50
9052/9052 - 245s - loss: 3.0745 - accuracy20: 0.4715 - val_loss: 3.1972 - val_accuracy20: 0.4271 - 245s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 246s - loss: 3.0697 - accuracy20: 0.4731 - val_loss: 3.1890 - val_accuracy20: 0.4292 - 246s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 247s - loss: 3.0659 - accuracy20: 0.4742 - val_loss: 3.1881 - val_accuracy20: 0.4302 - 247s/epoch - 27ms/step
Epoch 11/50
9052/9052 - 246s - loss: 3.0625 - accuracy20: 0.4752 - val_loss: 3.1852 - val_accuracy20: 0.4310 - 246s/epoch - 27ms/step
Epoch 12/50
9052/9052 - 246s - loss: 3.0597 - accuracy20: 0.4760 - val_loss: 3.1872 - val_accuracy20: 0.4296 - 246s/epoch - 27ms/step
Epoch 13/50
9052/9052 - 249s - loss: 3.0568 - accuracy20: 0.4769 - val_loss: 3.1802 - val_accuracy20: 0.4328 - 249s/epoch - 28ms/step
Epoch 14/50
9052/9052 - 248s - loss: 3.0544 - accuracy20: 0.4778 - val_loss: 3.1886 - val_accuracy20: 0.4306 - 248s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 249s - loss: 3.0523 - accuracy20: 0.4784 - val_loss: 3.1824 - val_accuracy20: 0.4312 - 249s/epoch - 28ms/step
Epoch 16/50
9052/9052 - 250s - loss: 3.0498 - accuracy20: 0.4791 - val_loss: 3.1815 - val_accuracy20: 0.4322 - 250s/epoch - 28ms/step
Epoch 17/50
9052/9052 - 258s - loss: 3.0477 - accuracy20: 0.4798 - val_loss: 3.1814 - val_accuracy20: 0.4326 - 258s/epoch - 29ms/step
Epoch 18/50
9052/9052 - 248s - loss: 3.0460 - accuracy20: 0.4803 - val_loss: 3.1919 - val_accuracy20: 0.4292 - 248s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 250s - loss: 3.0442 - accuracy20: 0.4810 - val_loss: 3.1892 - val_accuracy20: 0.4307 - 250s/epoch - 28ms/step
Epoch 20/50
9052/9052 - 251s - loss: 3.0425 - accuracy20: 0.4816 - val_loss: 3.1915 - val_accuracy20: 0.4312 - 251s/epoch - 28ms/step
Epoch 21/50
9052/9052 - 254s - loss: 3.0408 - accuracy20: 0.4821 - val_loss: 3.1927 - val_accuracy20: 0.4321 - 254s/epoch - 28ms/step
Epoch 22/50
9052/9052 - 250s - loss: 3.0393 - accuracy20: 0.4823 - val_loss: 3.1882 - val_accuracy20: 0.4309 - 250s/epoch - 28ms/step
Epoch 23/50
9052/9052 - 246s - loss: 3.0377 - accuracy20: 0.4828 - val_loss: 3.1784 - val_accuracy20: 0.4335 - 246s/epoch - 27ms/step
Epoch 24/50
9052/9052 - 247s - loss: 3.0361 - accuracy20: 0.4835 - val_loss: 3.1799 - val_accuracy20: 0.4340 - 247s/epoch - 27ms/step
Epoch 25/50
9052/9052 - 248s - loss: 3.0347 - accuracy20: 0.4839 - val_loss: 3.1739 - val_accuracy20: 0.4353 - 248s/epoch - 27ms/step
Epoch 26/50
9052/9052 - 249s - loss: 3.0332 - accuracy20: 0.4840 - val_loss: 3.1827 - val_accuracy20: 0.4334 - 249s/epoch - 28ms/step
Epoch 27/50
9052/9052 - 248s - loss: 3.0318 - accuracy20: 0.4845 - val_loss: 3.1797 - val_accuracy20: 0.4346 - 248s/epoch - 27ms/step
Epoch 28/50
9052/9052 - 253s - loss: 3.0302 - accuracy20: 0.4852 - val_loss: 3.1694 - val_accuracy20: 0.4360 - 253s/epoch - 28ms/step
Epoch 29/50
9052/9052 - 247s - loss: 3.0290 - accuracy20: 0.4854 - val_loss: 3.1786 - val_accuracy20: 0.4340 - 247s/epoch - 27ms/step
Epoch 30/50
9052/9052 - 254s - loss: 3.0278 - accuracy20: 0.4858 - val_loss: 3.1667 - val_accuracy20: 0.4382 - 254s/epoch - 28ms/step
Epoch 31/50
9052/9052 - 259s - loss: 3.0267 - accuracy20: 0.4859 - val_loss: 3.1748 - val_accuracy20: 0.4356 - 259s/epoch - 29ms/step
Epoch 32/50
9052/9052 - 258s - loss: 3.0252 - accuracy20: 0.4868 - val_loss: 3.1938 - val_accuracy20: 0.4326 - 258s/epoch - 29ms/step
Epoch 33/50
9052/9052 - 250s - loss: 3.0241 - accuracy20: 0.4870 - val_loss: 3.1767 - val_accuracy20: 0.4354 - 250s/epoch - 28ms/step
Epoch 34/50
9052/9052 - 247s - loss: 3.0231 - accuracy20: 0.4873 - val_loss: 3.1767 - val_accuracy20: 0.4348 - 247s/epoch - 27ms/step
Epoch 35/50
9052/9052 - 247s - loss: 3.0221 - accuracy20: 0.4876 - val_loss: 3.1709 - val_accuracy20: 0.4373 - 247s/epoch - 27ms/step
Epoch 36/50
9052/9052 - 249s - loss: 3.0209 - accuracy20: 0.4879 - val_loss: 3.1812 - val_accuracy20: 0.4339 - 249s/epoch - 28ms/step
Epoch 37/50
9052/9052 - 245s - loss: 3.0199 - accuracy20: 0.4882 - val_loss: 3.1670 - val_accuracy20: 0.4383 - 245s/epoch - 27ms/step
Epoch 38/50
9052/9052 - 245s - loss: 3.0186 - accuracy20: 0.4889 - val_loss: 3.1745 - val_accuracy20: 0.4367 - 245s/epoch - 27ms/step
Epoch 39/50
9052/9052 - 245s - loss: 3.0179 - accuracy20: 0.4888 - val_loss: 3.1860 - val_accuracy20: 0.4335 - 245s/epoch - 27ms/step
Epoch 40/50
9052/9052 - 252s - loss: 3.0168 - accuracy20: 0.4893 - val_loss: 3.1802 - val_accuracy20: 0.4354 - 252s/epoch - 28ms/step
testing model: results/AAPL/W7/deepVOL_L2/h20
Evaluating performance on  test set...
23942/23942 - 316s - 316s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0747588
{'0': {'precision': 0.39687832767022485, 'recall': 0.6825594032202272, 'f1-score': 0.5019150743640669, 'support': 1876203}, '1': {'precision': 0.5378491856746511, 'recall': 0.08496777401704583, 'f1-score': 0.1467520989996096, 'support': 2391083}, '2': {'precision': 0.4206815664763788, 'recall': 0.5704498602948365, 'f1-score': 0.4842500890256964, 'support': 1861778}, 'accuracy': 0.41537109092024493, 'macro avg': {'precision': 0.45180302660708493, 'recall': 0.44599234584403646, 'f1-score': 0.3776390874631243, 'support': 6129064}, 'weighted avg': {'precision': 0.45910469182759717, 'recall': 0.41537109092024493, 'f1-score': 0.35799221212985405, 'support': 6129064}}
[[1280620   79220  516363]
 [1241736  203165  946182]
 [ 704376   95351 1062051]]
Evaluating performance on  train set...
9052/9052 - 127s - 127s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0417107
{'0': {'precision': 0.43125421565578437, 'recall': 0.685619141430162, 'f1-score': 0.529471212112196, 'support': 778667}, '1': {'precision': 0.551774784081406, 'recall': 0.10296393239684855, 'f1-score': 0.17354373626179317, 'support': 762568}, '2': {'precision': 0.4599321546140413, 'recall': 0.5553699514722658, 'f1-score': 0.5031655048429918, 'support': 775845}, 'accuracy': 0.45025074662937836, 'macro avg': {'precision': 0.4809870514504106, 'recall': 0.4479843417664255, 'f1-score': 0.402060151072327, 'support': 2317080}, 'weighted avg': {'precision': 0.4805208634945548, 'recall': 0.45025074662937836, 'f1-score': 0.403524738593558, 'support': 2317080}}
[[533869  27715 217083]
 [395179  78517 288872]
 [308897  36067 430881]]
Evaluating performance on  val set...
2763/2763 - 36s - 36s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0538751
{'0': {'precision': 0.4169054026680557, 'recall': 0.6842880212786169, 'f1-score': 0.5181349013684343, 'support': 231594}, '1': {'precision': 0.5465674251956749, 'recall': 0.10560582834726137, 'f1-score': 0.17701034310085817, 'support': 242676}, '2': {'precision': 0.4473044855671979, 'recall': 0.5380033899032376, 'f1-score': 0.4884794601670615, 'support': 233045}, 'accuracy': 0.43754762729476965, 'macro avg': {'precision': 0.47025910447697616, 'recall': 0.4426324131763719, 'f1-score': 0.394541568212118, 'support': 707315}, 'weighted avg': {'precision': 0.47140759087718903, 'recall': 0.43754762729476965, 'f1-score': 0.3913260600503282, 'support': 707315}}
[[158477   8693  64424]
 [126552  25628  90496]
 [ 95098  12568 125379]]
training model: results/AAPL/W7/deepVOL_L2/h30
Epoch 1/50
9052/9052 - 252s - loss: 3.2552 - accuracy30: 0.3883 - val_loss: 3.2531 - val_accuracy30: 0.3904 - 252s/epoch - 28ms/step
Epoch 2/50
9052/9052 - 246s - loss: 3.2211 - accuracy30: 0.4087 - val_loss: 3.2259 - val_accuracy30: 0.4049 - 246s/epoch - 27ms/step
Epoch 3/50
9052/9052 - 247s - loss: 3.1983 - accuracy30: 0.4192 - val_loss: 3.2155 - val_accuracy30: 0.4125 - 247s/epoch - 27ms/step
Epoch 4/50
9052/9052 - 245s - loss: 3.1848 - accuracy30: 0.4261 - val_loss: 3.2144 - val_accuracy30: 0.4136 - 245s/epoch - 27ms/step
Epoch 5/50
9052/9052 - 252s - loss: 3.1746 - accuracy30: 0.4306 - val_loss: 3.2059 - val_accuracy30: 0.4155 - 252s/epoch - 28ms/step
Epoch 6/50
9052/9052 - 247s - loss: 3.1668 - accuracy30: 0.4342 - val_loss: 3.2099 - val_accuracy30: 0.4145 - 247s/epoch - 27ms/step
Epoch 7/50
9052/9052 - 247s - loss: 3.1613 - accuracy30: 0.4367 - val_loss: 3.2064 - val_accuracy30: 0.4170 - 247s/epoch - 27ms/step
Epoch 8/50
9052/9052 - 246s - loss: 3.1569 - accuracy30: 0.4381 - val_loss: 3.2185 - val_accuracy30: 0.4120 - 246s/epoch - 27ms/step
Epoch 9/50
9052/9052 - 248s - loss: 3.1530 - accuracy30: 0.4398 - val_loss: 3.2052 - val_accuracy30: 0.4182 - 248s/epoch - 27ms/step
Epoch 10/50
9052/9052 - 256s - loss: 3.1492 - accuracy30: 0.4410 - val_loss: 3.2132 - val_accuracy30: 0.4139 - 256s/epoch - 28ms/step
Epoch 11/50
9052/9052 - 256s - loss: 3.1462 - accuracy30: 0.4424 - val_loss: 3.2119 - val_accuracy30: 0.4137 - 256s/epoch - 28ms/step
Epoch 12/50
9052/9052 - 256s - loss: 3.1437 - accuracy30: 0.4437 - val_loss: 3.2075 - val_accuracy30: 0.4159 - 256s/epoch - 28ms/step
Epoch 13/50
9052/9052 - 254s - loss: 3.1415 - accuracy30: 0.4444 - val_loss: 3.1980 - val_accuracy30: 0.4197 - 254s/epoch - 28ms/step
Epoch 14/50
9052/9052 - 247s - loss: 3.1392 - accuracy30: 0.4453 - val_loss: 3.2075 - val_accuracy30: 0.4156 - 247s/epoch - 27ms/step
Epoch 15/50
9052/9052 - 245s - loss: 3.1370 - accuracy30: 0.4463 - val_loss: 3.2052 - val_accuracy30: 0.4162 - 245s/epoch - 27ms/step
Epoch 16/50
9052/9052 - 251s - loss: 3.1352 - accuracy30: 0.4470 - val_loss: 3.2012 - val_accuracy30: 0.4170 - 251s/epoch - 28ms/step
Epoch 17/50
9052/9052 - 250s - loss: 3.1336 - accuracy30: 0.4472 - val_loss: 3.2014 - val_accuracy30: 0.4177 - 250s/epoch - 28ms/step
Epoch 18/50
9052/9052 - 248s - loss: 3.1318 - accuracy30: 0.4481 - val_loss: 3.2079 - val_accuracy30: 0.4155 - 248s/epoch - 27ms/step
Epoch 19/50
9052/9052 - 249s - loss: 3.1301 - accuracy30: 0.4488 - val_loss: 3.2078 - val_accuracy30: 0.4159 - 249s/epoch - 27ms/step
Epoch 20/50
9052/9052 - 254s - loss: 3.1283 - accuracy30: 0.4494 - val_loss: 3.2013 - val_accuracy30: 0.4185 - 254s/epoch - 28ms/step
Epoch 21/50
9052/9052 - 260s - loss: 3.1270 - accuracy30: 0.4500 - val_loss: 3.2133 - val_accuracy30: 0.4141 - 260s/epoch - 29ms/step
Epoch 22/50
9052/9052 - 250s - loss: 3.1257 - accuracy30: 0.4506 - val_loss: 3.2164 - val_accuracy30: 0.4127 - 250s/epoch - 28ms/step
Epoch 23/50
9052/9052 - 233s - loss: 3.1244 - accuracy30: 0.4511 - val_loss: 3.2062 - val_accuracy30: 0.4156 - 233s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h30
Evaluating performance on  test set...
23942/23942 - 309s - 309s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.074553
{'0': {'precision': 0.3919710792494681, 'recall': 0.6113509245827202, 'f1-score': 0.47767691886268826, 'support': 1923949}, '1': {'precision': 0.41432896739766817, 'recall': 0.14021218394268142, 'f1-score': 0.20952085972024803, 'support': 2296498}, '2': {'precision': 0.41102834814659495, 'recall': 0.5063315479218722, 'f1-score': 0.45372949187938516, 'support': 1908617}, 'accuracy': 0.40211653851224266, 'macro avg': {'precision': 0.4057761315979104, 'recall': 0.4192982188157579, 'f1-score': 0.38030909015410713, 'support': 6129064}, 'weighted avg': {'precision': 0.40628286858748, 'recall': 0.40211653851224266, 'f1-score': 0.3697442361961201, 'support': 6129064}}
[[1176208  224530  523211]
 [1112946  321997  861555]
 [ 711598  230626  966393]]
Evaluating performance on  train set...
9052/9052 - 115s - 115s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0612755
{'0': {'precision': 0.4127227654190111, 'recall': 0.6211298119570017, 'f1-score': 0.49592063565915523, 'support': 772217}, '1': {'precision': 0.4201057934226526, 'recall': 0.1928667162301564, 'f1-score': 0.26436560717081464, 'support': 777454}, '2': {'precision': 0.44324910244923277, 'recall': 0.4609210994398033, 'f1-score': 0.45191240144779593, 'support': 767409}, 'accuracy': 0.42437334921539177, 'macro avg': {'precision': 0.4253592204302989, 'recall': 0.4249725425423205, 'f1-score': 0.4040662147592553, 'support': 2317080}, 'weighted avg': {'precision': 0.42531022481944974, 'recall': 0.42437334921539177, 'f1-score': 0.40365118526198324, 'support': 2317080}}
[[479647  98796 193774]
 [376993 149945 250516]
 [305513 108181 353715]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0661259
{'0': {'precision': 0.4066599478598379, 'recall': 0.6267763841996482, 'f1-score': 0.4932763515493184, 'support': 233691}, '1': {'precision': 0.41909212674638013, 'recall': 0.18051654362995498, 'f1-score': 0.2523414550870356, 'support': 237463}, '2': {'precision': 0.4399609555276926, 'recall': 0.45614644246933234, 'f1-score': 0.44790752791002264, 'support': 236161}, 'accuracy': 0.4199854378883524, 'macro avg': {'precision': 0.42190434337797017, 'recall': 0.42114645676631185, 'f1-score': 0.3978417781821255, 'support': 707315}, 'weighted avg': {'precision': 0.42195240138730894, 'recall': 0.4199854378883524, 'f1-score': 0.3972406813343466, 'support': 707315}}
[[146472  27396  59823]
 [117295  42866  77302]
 [ 96416  32021 107724]]
training model: results/AAPL/W7/deepVOL_L2/h50
Epoch 1/50
9052/9052 - 238s - loss: 3.2620 - accuracy50: 0.3850 - val_loss: 3.2821 - val_accuracy50: 0.3600 - 238s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 234s - loss: 3.2433 - accuracy50: 0.3972 - val_loss: 3.2702 - val_accuracy50: 0.3692 - 234s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 236s - loss: 3.2301 - accuracy50: 0.4050 - val_loss: 3.2661 - val_accuracy50: 0.3723 - 236s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 235s - loss: 3.2213 - accuracy50: 0.4096 - val_loss: 3.2618 - val_accuracy50: 0.3750 - 235s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 236s - loss: 3.2142 - accuracy50: 0.4130 - val_loss: 3.2684 - val_accuracy50: 0.3732 - 236s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 236s - loss: 3.2094 - accuracy50: 0.4158 - val_loss: 3.2622 - val_accuracy50: 0.3765 - 236s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 235s - loss: 3.2053 - accuracy50: 0.4180 - val_loss: 3.2563 - val_accuracy50: 0.3806 - 235s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 233s - loss: 3.2017 - accuracy50: 0.4196 - val_loss: 3.2570 - val_accuracy50: 0.3806 - 233s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 235s - loss: 3.1991 - accuracy50: 0.4207 - val_loss: 3.2542 - val_accuracy50: 0.3821 - 235s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 235s - loss: 3.1970 - accuracy50: 0.4219 - val_loss: 3.2525 - val_accuracy50: 0.3827 - 235s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 234s - loss: 3.1949 - accuracy50: 0.4230 - val_loss: 3.2527 - val_accuracy50: 0.3835 - 234s/epoch - 26ms/step
Epoch 12/50
9052/9052 - 235s - loss: 3.1928 - accuracy50: 0.4236 - val_loss: 3.2529 - val_accuracy50: 0.3835 - 235s/epoch - 26ms/step
Epoch 13/50
9052/9052 - 235s - loss: 3.1915 - accuracy50: 0.4244 - val_loss: 3.2539 - val_accuracy50: 0.3834 - 235s/epoch - 26ms/step
Epoch 14/50
9052/9052 - 234s - loss: 3.1896 - accuracy50: 0.4252 - val_loss: 3.2557 - val_accuracy50: 0.3831 - 234s/epoch - 26ms/step
Epoch 15/50
9052/9052 - 234s - loss: 3.1883 - accuracy50: 0.4261 - val_loss: 3.2535 - val_accuracy50: 0.3841 - 234s/epoch - 26ms/step
Epoch 16/50
9052/9052 - 234s - loss: 3.1870 - accuracy50: 0.4265 - val_loss: 3.2545 - val_accuracy50: 0.3841 - 234s/epoch - 26ms/step
Epoch 17/50
9052/9052 - 239s - loss: 3.1859 - accuracy50: 0.4273 - val_loss: 3.2580 - val_accuracy50: 0.3829 - 239s/epoch - 26ms/step
Epoch 18/50
9052/9052 - 235s - loss: 3.1845 - accuracy50: 0.4278 - val_loss: 3.2529 - val_accuracy50: 0.3849 - 235s/epoch - 26ms/step
Epoch 19/50
9052/9052 - 235s - loss: 3.1832 - accuracy50: 0.4280 - val_loss: 3.2579 - val_accuracy50: 0.3831 - 235s/epoch - 26ms/step
Epoch 20/50
9052/9052 - 235s - loss: 3.1821 - accuracy50: 0.4287 - val_loss: 3.2568 - val_accuracy50: 0.3837 - 235s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h50
Evaluating performance on  test set...
23942/23942 - 309s - 309s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0980527
{'0': {'precision': 0.31436489562904885, 'recall': 0.6469527256870892, 'f1-score': 0.4231259712250034, 'support': 1614492}, '1': {'precision': 0.5056659527117124, 'recall': 0.03751735206833897, 'f1-score': 0.06985210115962344, 'support': 2900951}, '2': {'precision': 0.3305223445437141, 'recall': 0.5307745746987675, 'f1-score': 0.40736905690531006, 'support': 1613621}, 'accuracy': 0.3279138543829857, 'macro avg': {'precision': 0.38351773096149183, 'recall': 0.40508155081806524, 'f1-score': 0.3001157097633123, 'support': 6129064}, 'weighted avg': {'precision': 0.4091635454261698, 'recall': 0.3279138543829857, 'f1-score': 0.25176932125667345, 'support': 6129064}}
[[1044500   52003  517989]
 [1575314  108836 1216801]
 [ 702758   54394  856469]]
Evaluating performance on  train set...
9052/9052 - 115s - 115s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0787151
{'0': {'precision': 0.3911167928461531, 'recall': 0.6258306907132247, 'f1-score': 0.4813874788494077, 'support': 778268}, '1': {'precision': 0.38756083213006043, 'recall': 0.05639454652984571, 'f1-score': 0.09846177535534506, 'support': 771032}, '2': {'precision': 0.4067405191908876, 'recall': 0.5083435359087238, 'f1-score': 0.4519014675659247, 'support': 767780}, 'accuracy': 0.39741484972465346, 'macro avg': {'precision': 0.39513938138903376, 'recall': 0.39685625771726474, 'f1-score': 0.34391690725689245, 'support': 2317080}, 'weighted avg': {'precision': 0.39511053717526984, 'recall': 0.39741484972465346, 'f1-score': 0.34419465824775963, 'support': 2317080}}
[[487064  33353 257851]
 [416127  43482 311423]
 [342125  35359 390296]]
Evaluating performance on  val set...
2763/2763 - 34s - 34s/epoch - 12ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0836941
{'0': {'precision': 0.3696930834324799, 'recall': 0.6358015669496743, 'f1-score': 0.4675339478882207, 'support': 225789}, '1': {'precision': 0.40331491712707185, 'recall': 0.05222700064389453, 'f1-score': 0.09247855187314816, 'support': 251594}, '2': {'precision': 0.398818522384881, 'recall': 0.4967990536332481, 'f1-score': 0.4424492546765489, 'support': 229932}, 'accuracy': 0.3830358468292062, 'macro avg': {'precision': 0.39060884098147763, 'recall': 0.394942540408939, 'f1-score': 0.33415391814597256, 'support': 707315}, 'weighted avg': {'precision': 0.39112048431576485, 'recall': 0.3830358468292062, 'f1-score': 0.32597119157093307, 'support': 707315}}
[[143557   9087  73145]
 [139408  13140  99046]
 [105349  10353 114230]]
training model: results/AAPL/W7/deepVOL_L2/h100
Epoch 1/50
9052/9052 - 239s - loss: 3.2797 - accuracy100: 0.3686 - val_loss: 3.2951 - val_accuracy100: 0.3437 - 239s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 233s - loss: 3.2738 - accuracy100: 0.3730 - val_loss: 3.2936 - val_accuracy100: 0.3467 - 233s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 236s - loss: 3.2685 - accuracy100: 0.3778 - val_loss: 3.2923 - val_accuracy100: 0.3509 - 236s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 230s - loss: 3.2646 - accuracy100: 0.3815 - val_loss: 3.2921 - val_accuracy100: 0.3525 - 230s/epoch - 25ms/step
Epoch 5/50
9052/9052 - 233s - loss: 3.2610 - accuracy100: 0.3846 - val_loss: 3.2933 - val_accuracy100: 0.3545 - 233s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 234s - loss: 3.2574 - accuracy100: 0.3876 - val_loss: 3.2912 - val_accuracy100: 0.3565 - 234s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 232s - loss: 3.2542 - accuracy100: 0.3897 - val_loss: 3.2917 - val_accuracy100: 0.3572 - 232s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 232s - loss: 3.2513 - accuracy100: 0.3917 - val_loss: 3.2902 - val_accuracy100: 0.3592 - 232s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 233s - loss: 3.2484 - accuracy100: 0.3934 - val_loss: 3.2915 - val_accuracy100: 0.3588 - 233s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 234s - loss: 3.2459 - accuracy100: 0.3949 - val_loss: 3.2902 - val_accuracy100: 0.3597 - 234s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 231s - loss: 3.2436 - accuracy100: 0.3964 - val_loss: 3.2898 - val_accuracy100: 0.3595 - 231s/epoch - 26ms/step
Epoch 12/50
9052/9052 - 235s - loss: 3.2414 - accuracy100: 0.3978 - val_loss: 3.2916 - val_accuracy100: 0.3594 - 235s/epoch - 26ms/step
Epoch 13/50
9052/9052 - 232s - loss: 3.2398 - accuracy100: 0.3985 - val_loss: 3.2913 - val_accuracy100: 0.3599 - 232s/epoch - 26ms/step
Epoch 14/50
9052/9052 - 233s - loss: 3.2379 - accuracy100: 0.4000 - val_loss: 3.2890 - val_accuracy100: 0.3615 - 233s/epoch - 26ms/step
Epoch 15/50
9052/9052 - 232s - loss: 3.2363 - accuracy100: 0.4005 - val_loss: 3.2905 - val_accuracy100: 0.3604 - 232s/epoch - 26ms/step
Epoch 16/50
9052/9052 - 232s - loss: 3.2350 - accuracy100: 0.4010 - val_loss: 3.2890 - val_accuracy100: 0.3617 - 232s/epoch - 26ms/step
Epoch 17/50
9052/9052 - 231s - loss: 3.2337 - accuracy100: 0.4023 - val_loss: 3.2900 - val_accuracy100: 0.3608 - 231s/epoch - 26ms/step
Epoch 18/50
9052/9052 - 236s - loss: 3.2323 - accuracy100: 0.4029 - val_loss: 3.2890 - val_accuracy100: 0.3627 - 236s/epoch - 26ms/step
Epoch 19/50
9052/9052 - 231s - loss: 3.2311 - accuracy100: 0.4040 - val_loss: 3.2901 - val_accuracy100: 0.3620 - 231s/epoch - 26ms/step
Epoch 20/50
9052/9052 - 232s - loss: 3.2300 - accuracy100: 0.4044 - val_loss: 3.2902 - val_accuracy100: 0.3618 - 232s/epoch - 26ms/step
Epoch 21/50
9052/9052 - 231s - loss: 3.2288 - accuracy100: 0.4053 - val_loss: 3.2915 - val_accuracy100: 0.3614 - 231s/epoch - 25ms/step
Epoch 22/50
9052/9052 - 230s - loss: 3.2276 - accuracy100: 0.4057 - val_loss: 3.2923 - val_accuracy100: 0.3606 - 230s/epoch - 25ms/step
Epoch 23/50
9052/9052 - 231s - loss: 3.2268 - accuracy100: 0.4066 - val_loss: 3.2931 - val_accuracy100: 0.3609 - 231s/epoch - 26ms/step
Epoch 24/50
9052/9052 - 232s - loss: 3.2256 - accuracy100: 0.4068 - val_loss: 3.2935 - val_accuracy100: 0.3608 - 232s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h100
Evaluating performance on  test set...
23942/23942 - 309s - 309s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.094824
{'0': {'precision': 0.3216942655162633, 'recall': 0.6489043763839032, 'f1-score': 0.4301444649508999, 'support': 1800162}, '1': {'precision': 0.41781432665137314, 'recall': 0.14887475810427162, 'f1-score': 0.21952780982024275, 'support': 2533633}, '2': {'precision': 0.3555894789965488, 'recall': 0.3159409536955186, 'f1-score': 0.3345947514780124, 'support': 1795269}, 'accuracy': 0.3446735096908761, 'macro avg': {'precision': 0.3650326903880618, 'recall': 0.3712400293945645, 'f1-score': 0.32808900874971836, 'support': 6129064}, 'weighted avg': {'precision': 0.37135665847927857, 'recall': 0.3446735096908761, 'f1-score': 0.3150921916600011, 'support': 6129064}}
[[1168133  250144  381885]
 [1510428  377194  646011]
 [ 952629  275441  567199]]
Evaluating performance on  train set...
9052/9052 - 110s - 110s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0926628
{'0': {'precision': 0.3654835213687901, 'recall': 0.6178268194760237, 'f1-score': 0.4592762065009415, 'support': 781104}, '1': {'precision': 0.3460704453465447, 'recall': 0.15180926561714955, 'f1-score': 0.2110417396128434, 'support': 764288}, '2': {'precision': 0.39244578972673366, 'recall': 0.33636132737583063, 'f1-score': 0.3622456028704328, 'support': 771688}, 'accuracy': 0.3703708978541958, 'macro avg': {'precision': 0.36799991881402283, 'recall': 0.36866580415633465, 'f1-score': 0.3441878496614059, 'support': 2317080}, 'weighted avg': {'precision': 0.36805972844740403, 'recall': 0.3703708978541958, 'f1-score': 0.345080763666257, 'support': 2317080}}
[[482587 107591 190926]
 [437348 116026 210914]
 [400472 111650 259566]]
Evaluating performance on  val set...
2763/2763 - 33s - 33s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0958213
{'0': {'precision': 0.35046291354094894, 'recall': 0.627714864289377, 'f1-score': 0.4497971333999695, 'support': 230122}, '1': {'precision': 0.3461348077443939, 'recall': 0.15441246932457825, 'f1-score': 0.21355637252077306, 'support': 240013}, '2': {'precision': 0.39534858990173977, 'recall': 0.31349186272029683, 'f1-score': 0.3496938286004534, 'support': 237180}, 'accuracy': 0.3617426464870673, 'macro avg': {'precision': 0.36398210372902756, 'recall': 0.36520639877808403, 'f1-score': 0.3376824448403986, 'support': 707315}, 'weighted avg': {'precision': 0.36404552250965994, 'recall': 0.3617426464870673, 'f1-score': 0.33606653872397957, 'support': 707315}}
[[144451  33750  51921]
 [141155  37061  61797]
 [126566  36260  74354]]
training model: results/AAPL/W7/deepVOL_L2/h200
Epoch 1/50
9052/9052 - 238s - loss: 3.2713 - accuracy200: 0.3731 - val_loss: 3.3025 - val_accuracy200: 0.3371 - 238s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 233s - loss: 3.2676 - accuracy200: 0.3768 - val_loss: 3.3035 - val_accuracy200: 0.3375 - 233s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 232s - loss: 3.2640 - accuracy200: 0.3803 - val_loss: 3.3053 - val_accuracy200: 0.3380 - 232s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 234s - loss: 3.2607 - accuracy200: 0.3826 - val_loss: 3.3046 - val_accuracy200: 0.3378 - 234s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 233s - loss: 3.2578 - accuracy200: 0.3848 - val_loss: 3.3055 - val_accuracy200: 0.3387 - 233s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 233s - loss: 3.2557 - accuracy200: 0.3865 - val_loss: 3.3054 - val_accuracy200: 0.3387 - 233s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 231s - loss: 3.2538 - accuracy200: 0.3879 - val_loss: 3.3069 - val_accuracy200: 0.3400 - 231s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 233s - loss: 3.2519 - accuracy200: 0.3890 - val_loss: 3.3091 - val_accuracy200: 0.3385 - 233s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 235s - loss: 3.2500 - accuracy200: 0.3900 - val_loss: 3.3107 - val_accuracy200: 0.3409 - 235s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 230s - loss: 3.2481 - accuracy200: 0.3915 - val_loss: 3.3106 - val_accuracy200: 0.3397 - 230s/epoch - 25ms/step
Epoch 11/50
9052/9052 - 234s - loss: 3.2463 - accuracy200: 0.3924 - val_loss: 3.3131 - val_accuracy200: 0.3399 - 234s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h200
Evaluating performance on  test set...
23942/23942 - 306s - 306s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1041348
{'0': {'precision': 0.2881944238224162, 'recall': 0.3963338720122282, 'f1-score': 0.3337223971044224, 'support': 1714070}, '1': {'precision': 0.4301214129752662, 'recall': 0.06112009409780925, 'f1-score': 0.10703110733116558, 'support': 2713772}, '2': {'precision': 0.2873463319902333, 'recall': 0.5719482818820824, 'f1-score': 0.3825166322091088, 'support': 1701222}, 'accuracy': 0.29665557416271066, 'macro avg': {'precision': 0.3352207229293052, 'recall': 0.34313408266403994, 'f1-score': 0.2744233788815656, 'support': 6129064}, 'weighted avg': {'precision': 0.35080018168762667, 'recall': 0.29665557416271066, 'f1-score': 0.24689369885664986, 'support': 6129064}}
[[ 679344  109851  924875]
 [1059596  165866 1488310]
 [ 618302  109909  973011]]
Evaluating performance on  train set...
9052/9052 - 115s - 115s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0991862
{'0': {'precision': 0.3478890988519264, 'recall': 0.3619058013409089, 'f1-score': 0.35475905240673905, 'support': 787973}, '1': {'precision': 0.30428359671381555, 'recall': 0.08076829713962565, 'f1-score': 0.12765275718108682, 'support': 749762}, '2': {'precision': 0.34405519646565164, 'recall': 0.5731761928285932, 'f1-score': 0.4299989074399489, 'support': 779345}, 'accuracy': 0.3419955288552834, 'macro avg': {'precision': 0.3320759640104645, 'recall': 0.3386167637697093, 'f1-score': 0.30413690567592494, 'support': 2317080}, 'weighted avg': {'precision': 0.33248968184892885, 'recall': 0.3419955288552834, 'f1-score': 0.3065786420194764, 'support': 2317080}}
[[285172  69486 433315]
 [270878  60557 418327]
 [263671  68972 446702]]
Evaluating performance on  val set...
2763/2763 - 33s - 33s/epoch - 12ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0994937
{'0': {'precision': 0.3264814582580279, 'recall': 0.3891607423137291, 'f1-score': 0.3550762281650083, 'support': 227451}, '1': {'precision': 0.3295979120789495, 'recall': 0.08319574427787362, 'f1-score': 0.1328564195964205, 'support': 242873}, '2': {'precision': 0.34535279493827553, 'recall': 0.5463076656919461, 'f1-score': 0.42318547826953845, 'support': 236991}, 'accuracy': 0.3367537801403901, 'macro avg': {'precision': 0.33381072175841764, 'recall': 0.33955471742784965, 'f1-score': 0.3037060420103224, 'support': 707315}, 'weighted avg': {'precision': 0.3338745425840174, 'recall': 0.3367537801403901, 'f1-score': 0.30159240232368456, 'support': 707315}}
[[ 88515  20183 118753]
 [ 95998  20206 126669]
 [ 86605  20916 129470]]
training model: results/AAPL/W7/deepVOL_L2/h300
Epoch 1/50
9052/9052 - 236s - loss: 3.2803 - accuracy300: 0.3669 - val_loss: 3.2983 - val_accuracy300: 0.3320 - 236s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 235s - loss: 3.2752 - accuracy300: 0.3710 - val_loss: 3.2989 - val_accuracy300: 0.3354 - 235s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 234s - loss: 3.2717 - accuracy300: 0.3752 - val_loss: 3.3037 - val_accuracy300: 0.3309 - 234s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 235s - loss: 3.2680 - accuracy300: 0.3782 - val_loss: 3.3077 - val_accuracy300: 0.3295 - 235s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 236s - loss: 3.2644 - accuracy300: 0.3804 - val_loss: 3.3129 - val_accuracy300: 0.3260 - 236s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 233s - loss: 3.2612 - accuracy300: 0.3826 - val_loss: 3.3143 - val_accuracy300: 0.3255 - 233s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 234s - loss: 3.2587 - accuracy300: 0.3839 - val_loss: 3.3166 - val_accuracy300: 0.3232 - 234s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 235s - loss: 3.2559 - accuracy300: 0.3858 - val_loss: 3.3189 - val_accuracy300: 0.3236 - 235s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 236s - loss: 3.2535 - accuracy300: 0.3871 - val_loss: 3.3215 - val_accuracy300: 0.3236 - 236s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 235s - loss: 3.2517 - accuracy300: 0.3881 - val_loss: 3.3221 - val_accuracy300: 0.3241 - 235s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 233s - loss: 3.2496 - accuracy300: 0.3895 - val_loss: 3.3247 - val_accuracy300: 0.3251 - 233s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h300
Evaluating performance on  test set...
23942/23942 - 296s - 296s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0974914
{'0': {'precision': 0.2926098427125122, 'recall': 0.40449890538391414, 'f1-score': 0.33957502729659755, 'support': 1803372}, '1': {'precision': 0.40804717754865444, 'recall': 0.4167676376413495, 'f1-score': 0.4123613085053471, 'support': 2540334}, '2': {'precision': 0.30226723469955036, 'recall': 0.17632766089490176, 'f1-score': 0.22272730006257854, 'support': 1785358}, 'accuracy': 0.3431191124778596, 'macro avg': {'precision': 0.3343080849869056, 'recall': 0.3325314013067218, 'f1-score': 0.32488787862150775, 'support': 6129064}, 'weighted avg': {'precision': 0.3432686853346208, 'recall': 0.3431191124778596, 'f1-score': 0.33570599285497216, 'support': 6129064}}
[[ 729462  766013  307897]
 [1062821 1058729  418784]
 [ 700668  769882  314808]]
Evaluating performance on  train set...
9052/9052 - 113s - 113s/epoch - 12ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0994121
{'0': {'precision': 0.33516744713587665, 'recall': 0.3217489783614447, 'f1-score': 0.3283211669257357, 'support': 777917}, '1': {'precision': 0.3237513871512684, 'recall': 0.47799418987650555, 'f1-score': 0.38603588583914217, 'support': 766593}, '2': {'precision': 0.34302870526419016, 'recall': 0.19469433190519952, 'f1-score': 0.2484020210377512, 'support': 772570}, 'accuracy': 0.33107877155730486, 'macro avg': {'precision': 0.33398251318377836, 'recall': 0.33147916671438327, 'f1-score': 0.32091969126754305, 'support': 2317080}, 'weighted avg': {'precision': 0.33401163918811927, 'recall': 0.33107877155730486, 'f1-score': 0.3207688014387024, 'support': 2317080}}
[[250294 383512 144111]
 [256201 366427 143965]
 [240278 381877 150415]]
Evaluating performance on  val set...
2763/2763 - 35s - 35s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991623
{'0': {'precision': 0.3165115938014307, 'recall': 0.34516981718829826, 'f1-score': 0.33022009431095417, 'support': 225095}, '1': {'precision': 0.3391534840448097, 'recall': 0.4703769978940705, 'f1-score': 0.3941296867987652, 'support': 246447}, '2': {'precision': 0.3427747879838051, 'recall': 0.17451531769965178, 'f1-score': 0.2312800897105486, 'support': 235773}, 'accuracy': 0.33191011077101434, 'macro avg': {'precision': 0.3328132886100152, 'recall': 0.3300207109273402, 'f1-score': 0.31854329027342265, 'support': 707315}, 'weighted avg': {'precision': 0.33315506666256184, 'recall': 0.33191011077101434, 'f1-score': 0.31950767570706784, 'support': 707315}}
[[ 77696 110053  37346]
 [ 88978 115923  41546]
 [ 78802 115825  41146]]
training model: results/AAPL/W7/deepVOL_L2/h500
Epoch 1/50
9052/9052 - 236s - loss: 3.2809 - accuracy500: 0.3671 - val_loss: 3.3010 - val_accuracy500: 0.3301 - 236s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 233s - loss: 3.2759 - accuracy500: 0.3699 - val_loss: 3.3025 - val_accuracy500: 0.3198 - 233s/epoch - 26ms/step
Epoch 3/50
9052/9052 - 238s - loss: 3.2745 - accuracy500: 0.3730 - val_loss: 3.3097 - val_accuracy500: 0.3215 - 238s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 234s - loss: 3.2701 - accuracy500: 0.3765 - val_loss: 3.3105 - val_accuracy500: 0.3203 - 234s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 232s - loss: 3.2666 - accuracy500: 0.3795 - val_loss: 3.3192 - val_accuracy500: 0.3173 - 232s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 233s - loss: 3.2622 - accuracy500: 0.3828 - val_loss: 3.3206 - val_accuracy500: 0.3174 - 233s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 232s - loss: 3.2592 - accuracy500: 0.3847 - val_loss: 3.3210 - val_accuracy500: 0.3204 - 232s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 232s - loss: 3.2560 - accuracy500: 0.3869 - val_loss: 3.3274 - val_accuracy500: 0.3177 - 232s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 234s - loss: 3.2531 - accuracy500: 0.3881 - val_loss: 3.3310 - val_accuracy500: 0.3190 - 234s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 234s - loss: 3.2501 - accuracy500: 0.3899 - val_loss: 3.3368 - val_accuracy500: 0.3191 - 234s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 231s - loss: 3.2477 - accuracy500: 0.3912 - val_loss: 3.3376 - val_accuracy500: 0.3202 - 231s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h500
Evaluating performance on  test set...
23942/23942 - 306s - 306s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985953
{'0': {'precision': 0.28539996186082833, 'recall': 0.35539551180171913, 'f1-score': 0.31657485011242353, 'support': 1768683}, '1': {'precision': 0.41844714824084506, 'recall': 0.4413688273612011, 'f1-score': 0.42960245534488983, 'support': 2606523}, '2': {'precision': 0.29216147782088014, 'recall': 0.19611735955818543, 'f1-score': 0.23469351202033054, 'support': 1753858}, 'accuracy': 0.3463794798031151, 'macro avg': {'precision': 0.33200286264085116, 'recall': 0.33096056624036857, 'f1-score': 0.3269569391592146, 'support': 6129064}, 'weighted avg': {'precision': 0.3439161219537013, 'recall': 0.3463794798031151, 'f1-score': 0.3412116972410914, 'support': 6129064}}
[[ 628582  802558  337543]
 [ 960289 1150438  495796]
 [ 613589  796307  343962]]
Evaluating performance on  train set...
9052/9052 - 117s - 117s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002804
{'0': {'precision': 0.33112626864910644, 'recall': 0.3027423264583096, 'f1-score': 0.3162987966150994, 'support': 772264}, '1': {'precision': 0.3270702858995159, 'recall': 0.5022463802601506, 'f1-score': 0.3961571589881878, 'support': 777473}, '2': {'precision': 0.33510415143371536, 'recall': 0.18216495100626448, 'f1-score': 0.23602504398569496, 'support': 767343}, 'accuracy': 0.3297525333609543, 'macro avg': {'precision': 0.3311002353274459, 'recall': 0.32905121924157493, 'f1-score': 0.3161603331963274, 'support': 2317080}, 'weighted avg': {'precision': 0.3310826721540859, 'recall': 0.32975253336095434, 'f1-score': 0.31651036393491017, 'support': 2317080}}
[[233797 404035 134432]
 [244072 390483 142918]
 [228197 399363 139783]]
Evaluating performance on  val set...
2763/2763 - 33s - 33s/epoch - 12ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1002624
{'0': {'precision': 0.31167382354243217, 'recall': 0.3156733683663038, 'f1-score': 0.31366084674706746, 'support': 223028}, '1': {'precision': 0.33919556389943567, 'recall': 0.48973704469024754, 'f1-score': 0.400796473235084, 'support': 246810}, '2': {'precision': 0.34063289519971857, 'recall': 0.17940684782105215, 'f1-score': 0.23502770629397632, 'support': 237477}, 'accuracy': 0.3306603140043686, 'macro avg': {'precision': 0.3305007608805288, 'recall': 0.3282724202925345, 'f1-score': 0.31649500875870923, 'support': 707315}, 'weighted avg': {'precision': 0.3310000843985846, 'recall': 0.3306603140043686, 'f1-score': 0.3176652601670128, 'support': 707315}}
[[ 70404 114449  38175]
 [ 81642 120872  44296]
 [ 73844 121028  42605]]
training model: results/AAPL/W7/deepVOL_L2/h1000
Epoch 1/50
9052/9052 - 238s - loss: 3.2818 - accuracy1000: 0.3672 - val_loss: 3.3005 - val_accuracy1000: 0.3319 - 238s/epoch - 26ms/step
Epoch 2/50
9052/9052 - 230s - loss: 3.2753 - accuracy1000: 0.3710 - val_loss: 3.3072 - val_accuracy1000: 0.3243 - 230s/epoch - 25ms/step
Epoch 3/50
9052/9052 - 233s - loss: 3.2686 - accuracy1000: 0.3776 - val_loss: 3.3174 - val_accuracy1000: 0.3191 - 233s/epoch - 26ms/step
Epoch 4/50
9052/9052 - 233s - loss: 3.2603 - accuracy1000: 0.3843 - val_loss: 3.3269 - val_accuracy1000: 0.3225 - 233s/epoch - 26ms/step
Epoch 5/50
9052/9052 - 233s - loss: 3.2549 - accuracy1000: 0.3874 - val_loss: 3.3347 - val_accuracy1000: 0.3199 - 233s/epoch - 26ms/step
Epoch 6/50
9052/9052 - 234s - loss: 3.2497 - accuracy1000: 0.3907 - val_loss: 3.3434 - val_accuracy1000: 0.3184 - 234s/epoch - 26ms/step
Epoch 7/50
9052/9052 - 233s - loss: 3.2452 - accuracy1000: 0.3938 - val_loss: 3.3504 - val_accuracy1000: 0.3174 - 233s/epoch - 26ms/step
Epoch 8/50
9052/9052 - 234s - loss: 3.2416 - accuracy1000: 0.3957 - val_loss: 3.3606 - val_accuracy1000: 0.3169 - 234s/epoch - 26ms/step
Epoch 9/50
9052/9052 - 231s - loss: 3.2382 - accuracy1000: 0.3976 - val_loss: 3.3581 - val_accuracy1000: 0.3165 - 231s/epoch - 26ms/step
Epoch 10/50
9052/9052 - 234s - loss: 3.2354 - accuracy1000: 0.3993 - val_loss: 3.3626 - val_accuracy1000: 0.3171 - 234s/epoch - 26ms/step
Epoch 11/50
9052/9052 - 233s - loss: 3.2322 - accuracy1000: 0.4010 - val_loss: 3.3577 - val_accuracy1000: 0.3177 - 233s/epoch - 26ms/step
testing model: results/AAPL/W7/deepVOL_L2/h1000
Evaluating performance on  test set...
23942/23942 - 305s - 305s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0964632
{'0': {'precision': 0.29087684047919976, 'recall': 0.3721190813785403, 'f1-score': 0.32652032721443314, 'support': 1809015}, '1': {'precision': 0.4116160653271047, 'recall': 0.4925790827147086, 'f1-score': 0.44847279777724874, 'support': 2520241}, '2': {'precision': 0.29841092200073105, 'recall': 0.1324469054476922, 'f1-score': 0.18346470994783415, 'support': 1799808}, 'accuracy': 0.3512715807829711, 'macro avg': {'precision': 0.33363460926901184, 'recall': 0.3323816898469804, 'f1-score': 0.3194859449798387, 'support': 6129064}, 'weighted avg': {'precision': 0.3427366097628967, 'recall': 0.3512715807829711, 'f1-score': 0.3346581068105245, 'support': 6129064}}
[[ 673169  894461  241385]
 [ 959759 1241418  319064]
 [ 681347  880082  238379]]
Evaluating performance on  train set...
9052/9052 - 117s - 117s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0998284
{'0': {'precision': 0.3422497482759276, 'recall': 0.3702024528609647, 'f1-score': 0.3556777453999369, 'support': 778601}, '1': {'precision': 0.3329573865015017, 'recall': 0.48452134657484447, 'f1-score': 0.3946890719778077, 'support': 764666}, '2': {'precision': 0.34372704629675654, 'recall': 0.16086315427629155, 'f1-score': 0.21916008996835265, 'support': 773813}, 'accuracy': 0.33801810899925766, 'macro avg': {'precision': 0.33964472702472864, 'recall': 0.33852898457070024, 'f1-score': 0.32317563578203246, 'support': 2317080}, 'weighted avg': {'precision': 0.339676509244383, 'recall': 0.33801810899925766, 'f1-score': 0.3229604885708734, 'support': 2317080}}
[[288240 369026 121335]
 [277840 370497 116329]
 [276112 373223 124478]]
Evaluating performance on  val set...
2763/2763 - 33s - 33s/epoch - 12ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.100025
{'0': {'precision': 0.3129409672830725, 'recall': 0.39556156895885214, 'f1-score': 0.3494339502765722, 'support': 222466}, '1': {'precision': 0.3385527684591424, 'recall': 0.4674036762179904, 'f1-score': 0.3926783131189496, 'support': 241607}, '2': {'precision': 0.36374440866953345, 'recall': 0.13840537407191192, 'f1-score': 0.2005145981488761, 'support': 243242}, 'accuracy': 0.3316669376444724, 'macro avg': {'precision': 0.33841271480391616, 'recall': 0.3337902064162515, 'f1-score': 0.3142089538481326, 'support': 707315}, 'weighted avg': {'precision': 0.33916057401624267, 'recall': 0.3316669376444724, 'f1-score': 0.3129929016956899, 'support': 707315}}
[[ 87999 105372  29095]
 [ 98886 112928  29793]
 [ 94315 115261  33666]]
training model: results/AAPL/W7/deepVOL_L3/h10
Epoch 1/50
9052/9052 - 347s - loss: 3.2105 - accuracy10: 0.4020 - val_loss: 3.2600 - val_accuracy10: 0.3938 - 347s/epoch - 38ms/step
Epoch 2/50
9052/9052 - 335s - loss: 3.1707 - accuracy10: 0.4193 - val_loss: 3.2219 - val_accuracy10: 0.3948 - 335s/epoch - 37ms/step
Epoch 3/50
9052/9052 - 348s - loss: 3.0856 - accuracy10: 0.4633 - val_loss: 3.1162 - val_accuracy10: 0.4636 - 348s/epoch - 38ms/step
Epoch 4/50
9052/9052 - 339s - loss: 3.0176 - accuracy10: 0.4916 - val_loss: 3.0943 - val_accuracy10: 0.4690 - 339s/epoch - 37ms/step
Epoch 5/50
9052/9052 - 363s - loss: 2.9949 - accuracy10: 0.4989 - val_loss: 3.0751 - val_accuracy10: 0.4747 - 363s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 335s - loss: 2.9820 - accuracy10: 0.5029 - val_loss: 3.0618 - val_accuracy10: 0.4808 - 335s/epoch - 37ms/step
Epoch 7/50
9052/9052 - 338s - loss: 2.9719 - accuracy10: 0.5057 - val_loss: 3.0603 - val_accuracy10: 0.4811 - 338s/epoch - 37ms/step
Epoch 8/50
9052/9052 - 338s - loss: 2.9638 - accuracy10: 0.5080 - val_loss: 3.0453 - val_accuracy10: 0.4845 - 338s/epoch - 37ms/step
Epoch 9/50
9052/9052 - 338s - loss: 2.9573 - accuracy10: 0.5099 - val_loss: 3.0385 - val_accuracy10: 0.4873 - 338s/epoch - 37ms/step
Epoch 10/50
9052/9052 - 336s - loss: 2.9520 - accuracy10: 0.5113 - val_loss: 3.0231 - val_accuracy10: 0.4914 - 336s/epoch - 37ms/step
Epoch 11/50
9052/9052 - 338s - loss: 2.9462 - accuracy10: 0.5129 - val_loss: 3.0364 - val_accuracy10: 0.4880 - 338s/epoch - 37ms/step
Epoch 12/50
9052/9052 - 335s - loss: 2.9419 - accuracy10: 0.5141 - val_loss: 3.0325 - val_accuracy10: 0.4898 - 335s/epoch - 37ms/step
Epoch 13/50
9052/9052 - 348s - loss: 2.9380 - accuracy10: 0.5152 - val_loss: 3.0281 - val_accuracy10: 0.4910 - 348s/epoch - 38ms/step
Epoch 14/50
9052/9052 - 347s - loss: 2.9334 - accuracy10: 0.5167 - val_loss: 3.0299 - val_accuracy10: 0.4927 - 347s/epoch - 38ms/step
Epoch 15/50
9052/9052 - 344s - loss: 2.9304 - accuracy10: 0.5172 - val_loss: 3.0276 - val_accuracy10: 0.4922 - 344s/epoch - 38ms/step
Epoch 16/50
9052/9052 - 346s - loss: 2.9269 - accuracy10: 0.5182 - val_loss: 3.0236 - val_accuracy10: 0.4934 - 346s/epoch - 38ms/step
Epoch 17/50
9052/9052 - 349s - loss: 2.9237 - accuracy10: 0.5191 - val_loss: 3.0160 - val_accuracy10: 0.4950 - 349s/epoch - 39ms/step
Epoch 18/50
9052/9052 - 347s - loss: 2.9207 - accuracy10: 0.5200 - val_loss: 3.0094 - val_accuracy10: 0.4977 - 347s/epoch - 38ms/step
Epoch 19/50
9052/9052 - 348s - loss: 2.9184 - accuracy10: 0.5204 - val_loss: 3.0008 - val_accuracy10: 0.4991 - 348s/epoch - 38ms/step
Epoch 20/50
9052/9052 - 349s - loss: 2.9158 - accuracy10: 0.5213 - val_loss: 3.0049 - val_accuracy10: 0.4985 - 349s/epoch - 39ms/step
Epoch 21/50
9052/9052 - 403s - loss: 2.9134 - accuracy10: 0.5220 - val_loss: 3.0002 - val_accuracy10: 0.4992 - 403s/epoch - 45ms/step
Epoch 22/50
9052/9052 - 339s - loss: 2.9115 - accuracy10: 0.5225 - val_loss: 2.9949 - val_accuracy10: 0.5003 - 339s/epoch - 37ms/step
Epoch 23/50
9052/9052 - 336s - loss: 2.9090 - accuracy10: 0.5229 - val_loss: 2.9922 - val_accuracy10: 0.5011 - 336s/epoch - 37ms/step
Epoch 24/50
9052/9052 - 333s - loss: 2.9071 - accuracy10: 0.5235 - val_loss: 2.9900 - val_accuracy10: 0.5006 - 333s/epoch - 37ms/step
Epoch 25/50
9052/9052 - 339s - loss: 2.9053 - accuracy10: 0.5241 - val_loss: 2.9888 - val_accuracy10: 0.5019 - 339s/epoch - 37ms/step
Epoch 26/50
9052/9052 - 334s - loss: 2.9035 - accuracy10: 0.5244 - val_loss: 2.9913 - val_accuracy10: 0.5017 - 334s/epoch - 37ms/step
Epoch 27/50
9052/9052 - 346s - loss: 2.9016 - accuracy10: 0.5249 - val_loss: 2.9989 - val_accuracy10: 0.4986 - 346s/epoch - 38ms/step
Epoch 28/50
9052/9052 - 345s - loss: 2.8998 - accuracy10: 0.5257 - val_loss: 2.9882 - val_accuracy10: 0.5011 - 345s/epoch - 38ms/step
Epoch 29/50
9052/9052 - 333s - loss: 2.8985 - accuracy10: 0.5258 - val_loss: 2.9855 - val_accuracy10: 0.5017 - 333s/epoch - 37ms/step
Epoch 30/50
9052/9052 - 336s - loss: 2.8966 - accuracy10: 0.5262 - val_loss: 2.9875 - val_accuracy10: 0.5014 - 336s/epoch - 37ms/step
Epoch 31/50
9052/9052 - 363s - loss: 2.8950 - accuracy10: 0.5267 - val_loss: 2.9910 - val_accuracy10: 0.5000 - 363s/epoch - 40ms/step
Epoch 32/50
9052/9052 - 330s - loss: 2.8934 - accuracy10: 0.5271 - val_loss: 2.9871 - val_accuracy10: 0.4998 - 330s/epoch - 36ms/step
Epoch 33/50
9052/9052 - 338s - loss: 2.8921 - accuracy10: 0.5275 - val_loss: 2.9710 - val_accuracy10: 0.5048 - 338s/epoch - 37ms/step
Epoch 34/50
9052/9052 - 336s - loss: 2.8905 - accuracy10: 0.5280 - val_loss: 2.9870 - val_accuracy10: 0.5012 - 336s/epoch - 37ms/step
Epoch 35/50
9052/9052 - 332s - loss: 2.8889 - accuracy10: 0.5282 - val_loss: 2.9740 - val_accuracy10: 0.5050 - 332s/epoch - 37ms/step
Epoch 36/50
9052/9052 - 344s - loss: 2.8878 - accuracy10: 0.5289 - val_loss: 2.9798 - val_accuracy10: 0.5033 - 344s/epoch - 38ms/step
Epoch 37/50
9052/9052 - 334s - loss: 2.8863 - accuracy10: 0.5289 - val_loss: 2.9724 - val_accuracy10: 0.5052 - 334s/epoch - 37ms/step
Epoch 38/50
9052/9052 - 337s - loss: 2.8850 - accuracy10: 0.5294 - val_loss: 2.9739 - val_accuracy10: 0.5053 - 337s/epoch - 37ms/step
Epoch 39/50
9052/9052 - 359s - loss: 2.8834 - accuracy10: 0.5297 - val_loss: 2.9766 - val_accuracy10: 0.5040 - 359s/epoch - 40ms/step
Epoch 40/50
9052/9052 - 361s - loss: 2.8823 - accuracy10: 0.5300 - val_loss: 2.9795 - val_accuracy10: 0.5040 - 361s/epoch - 40ms/step
Epoch 41/50
9052/9052 - 361s - loss: 2.8812 - accuracy10: 0.5303 - val_loss: 2.9744 - val_accuracy10: 0.5055 - 361s/epoch - 40ms/step
Epoch 42/50
9052/9052 - 336s - loss: 2.8800 - accuracy10: 0.5307 - val_loss: 2.9738 - val_accuracy10: 0.5053 - 336s/epoch - 37ms/step
Epoch 43/50
9052/9052 - 335s - loss: 2.8789 - accuracy10: 0.5308 - val_loss: 2.9696 - val_accuracy10: 0.5061 - 335s/epoch - 37ms/step
Epoch 44/50
9052/9052 - 339s - loss: 2.8778 - accuracy10: 0.5312 - val_loss: 2.9707 - val_accuracy10: 0.5059 - 339s/epoch - 37ms/step
Epoch 45/50
9052/9052 - 360s - loss: 2.8763 - accuracy10: 0.5315 - val_loss: 2.9702 - val_accuracy10: 0.5057 - 360s/epoch - 40ms/step
Epoch 46/50
9052/9052 - 335s - loss: 2.8756 - accuracy10: 0.5317 - val_loss: 2.9688 - val_accuracy10: 0.5064 - 335s/epoch - 37ms/step
Epoch 47/50
9052/9052 - 360s - loss: 2.8746 - accuracy10: 0.5319 - val_loss: 2.9724 - val_accuracy10: 0.5059 - 360s/epoch - 40ms/step
Epoch 48/50
9052/9052 - 360s - loss: 2.8735 - accuracy10: 0.5323 - val_loss: 2.9722 - val_accuracy10: 0.5061 - 360s/epoch - 40ms/step
Epoch 49/50
9052/9052 - 340s - loss: 2.8726 - accuracy10: 0.5326 - val_loss: 2.9640 - val_accuracy10: 0.5079 - 340s/epoch - 38ms/step
Epoch 50/50
9052/9052 - 334s - loss: 2.8714 - accuracy10: 0.5327 - val_loss: 2.9683 - val_accuracy10: 0.5064 - 334s/epoch - 37ms/step
testing model: results/AAPL/W7/deepVOL_L3/h10
Evaluating performance on  test set...
23942/23942 - 415s - 415s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0021466
{'0': {'precision': 0.4636297116562257, 'recall': 0.630633967923979, 'f1-score': 0.5343879179493238, 'support': 1878849}, '1': {'precision': 0.5691237712239203, 'recall': 0.2757580692960003, 'f1-score': 0.3715086887098658, 'support': 2382302}, '2': {'precision': 0.4707062648425987, 'recall': 0.609611903766396, 'f1-score': 0.5312289482179812, 'support': 1867913}, 'accuracy': 0.48629072889433034, 'macro avg': {'precision': 0.501153249240915, 'recall': 0.5053346469954584, 'f1-score': 0.4790418516257236, 'support': 6129064}, 'weighted avg': {'precision': 0.5067908035926544, 'recall': 0.48629072889433034, 'f1-score': 0.47011575596775523, 'support': 6129064}}
[[1184866  247935  446048]
 [ 890978  656939  834385]
 [ 479786  249425 1138702]]
Evaluating performance on  train set...
9052/9052 - 156s - 156s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.97468203
{'0': {'precision': 0.50325147116995, 'recall': 0.6310840432898115, 'f1-score': 0.5599647884933503, 'support': 784203}, '1': {'precision': 0.5812426258315552, 'recall': 0.3072344152225259, 'f1-score': 0.4019861628341016, 'support': 753620}, '2': {'precision': 0.5080297948636255, 'recall': 0.6097795720795578, 'f1-score': 0.5542737430493425, 'support': 779257}, 'accuracy': 0.5185884820550003, 'macro avg': {'precision': 0.5308412972883768, 'recall': 0.516032676863965, 'f1-score': 0.5054082314589315, 'support': 2317080}, 'weighted avg': {'precision': 0.530224746224174, 'recall': 0.5185884820550003, 'f1-score': 0.5066689856428297, 'support': 2317080}}
[[494898  83285 206020]
 [267948 231538 254134]
 [220555  83527 475175]]
Evaluating performance on  val set...
2763/2763 - 48s - 48s/epoch - 17ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.98545957
{'0': {'precision': 0.48715050191544285, 'recall': 0.6327731886173557, 'f1-score': 0.5504942507054721, 'support': 232916}, '1': {'precision': 0.5898545342998757, 'recall': 0.3036725805312088, 'f1-score': 0.40093388459227597, 'support': 240621}, '2': {'precision': 0.4930401287309182, 'recall': 0.5924124596839737, 'f1-score': 0.538177564827444, 'support': 233778}, 'accuracy': 0.5074768667425404, 'macro avg': {'precision': 0.5233483883154122, 'recall': 0.5096194096108461, 'f1-score': 0.49653523337506406, 'support': 707315}, 'weighted avg': {'precision': 0.5240359237629122, 'recall': 0.5074768667425404, 'f1-score': 0.49554456768487026, 'support': 707315}}
[[147383  24048  61485]
 [ 86633  73070  80918]
 [ 68525  26760 138493]]
training model: results/AAPL/W7/deepVOL_L3/h20
Epoch 1/50
9052/9052 - 340s - loss: 3.2340 - accuracy20: 0.3986 - val_loss: 3.2754 - val_accuracy20: 0.3853 - 340s/epoch - 38ms/step
Epoch 2/50
9052/9052 - 333s - loss: 3.1513 - accuracy20: 0.4417 - val_loss: 3.2199 - val_accuracy20: 0.4200 - 333s/epoch - 37ms/step
Epoch 3/50
9052/9052 - 332s - loss: 3.1178 - accuracy20: 0.4563 - val_loss: 3.2301 - val_accuracy20: 0.4250 - 332s/epoch - 37ms/step
Epoch 4/50
9052/9052 - 332s - loss: 3.0982 - accuracy20: 0.4634 - val_loss: 3.2179 - val_accuracy20: 0.4232 - 332s/epoch - 37ms/step
Epoch 5/50
9052/9052 - 366s - loss: 3.0872 - accuracy20: 0.4669 - val_loss: 3.2325 - val_accuracy20: 0.4194 - 366s/epoch - 40ms/step
Epoch 6/50
9052/9052 - 363s - loss: 3.0784 - accuracy20: 0.4702 - val_loss: 3.2193 - val_accuracy20: 0.4205 - 363s/epoch - 40ms/step
Epoch 7/50
9052/9052 - 342s - loss: 3.0726 - accuracy20: 0.4715 - val_loss: 3.1942 - val_accuracy20: 0.4244 - 342s/epoch - 38ms/step
Epoch 8/50
9052/9052 - 333s - loss: 3.0653 - accuracy20: 0.4743 - val_loss: 3.1610 - val_accuracy20: 0.4354 - 333s/epoch - 37ms/step
Epoch 9/50
9052/9052 - 329s - loss: 3.0610 - accuracy20: 0.4759 - val_loss: 3.1601 - val_accuracy20: 0.4349 - 329s/epoch - 36ms/step
Epoch 10/50
9052/9052 - 338s - loss: 3.0563 - accuracy20: 0.4772 - val_loss: 3.1551 - val_accuracy20: 0.4384 - 338s/epoch - 37ms/step
Epoch 11/50
9052/9052 - 334s - loss: 3.0530 - accuracy20: 0.4784 - val_loss: 3.1765 - val_accuracy20: 0.4326 - 334s/epoch - 37ms/step
Epoch 12/50
9052/9052 - 333s - loss: 3.0493 - accuracy20: 0.4794 - val_loss: 3.1707 - val_accuracy20: 0.4368 - 333s/epoch - 37ms/step
Epoch 13/50
9052/9052 - 332s - loss: 3.0456 - accuracy20: 0.4808 - val_loss: 3.2031 - val_accuracy20: 0.4328 - 332s/epoch - 37ms/step
Epoch 14/50
9052/9052 - 335s - loss: 3.0451 - accuracy20: 0.4807 - val_loss: 3.1572 - val_accuracy20: 0.4413 - 335s/epoch - 37ms/step
Epoch 15/50
9052/9052 - 329s - loss: 3.0419 - accuracy20: 0.4817 - val_loss: 3.1746 - val_accuracy20: 0.4388 - 329s/epoch - 36ms/step
Epoch 16/50
9052/9052 - 335s - loss: 3.0387 - accuracy20: 0.4826 - val_loss: 3.1580 - val_accuracy20: 0.4443 - 335s/epoch - 37ms/step
Epoch 17/50
9052/9052 - 335s - loss: 3.0364 - accuracy20: 0.4833 - val_loss: 3.1483 - val_accuracy20: 0.4476 - 335s/epoch - 37ms/step
Epoch 18/50
9052/9052 - 333s - loss: 3.0343 - accuracy20: 0.4840 - val_loss: 3.1622 - val_accuracy20: 0.4454 - 333s/epoch - 37ms/step
Epoch 19/50
9052/9052 - 337s - loss: 3.0317 - accuracy20: 0.4849 - val_loss: 3.1542 - val_accuracy20: 0.4488 - 337s/epoch - 37ms/step
Epoch 20/50
9052/9052 - 337s - loss: 3.0300 - accuracy20: 0.4853 - val_loss: 3.1563 - val_accuracy20: 0.4461 - 337s/epoch - 37ms/step
Epoch 21/50
9052/9052 - 332s - loss: 3.0284 - accuracy20: 0.4857 - val_loss: 3.1523 - val_accuracy20: 0.4494 - 332s/epoch - 37ms/step
Epoch 22/50
9052/9052 - 336s - loss: 3.0266 - accuracy20: 0.4863 - val_loss: 3.1467 - val_accuracy20: 0.4499 - 336s/epoch - 37ms/step
Epoch 23/50
9052/9052 - 330s - loss: 3.0252 - accuracy20: 0.4869 - val_loss: 3.1608 - val_accuracy20: 0.4481 - 330s/epoch - 36ms/step
Epoch 24/50
9052/9052 - 335s - loss: 3.0244 - accuracy20: 0.4870 - val_loss: 3.1650 - val_accuracy20: 0.4454 - 335s/epoch - 37ms/step
Epoch 25/50
9052/9052 - 334s - loss: 3.0239 - accuracy20: 0.4870 - val_loss: 3.1538 - val_accuracy20: 0.4505 - 334s/epoch - 37ms/step
Epoch 26/50
9052/9052 - 335s - loss: 3.0213 - accuracy20: 0.4880 - val_loss: 3.1497 - val_accuracy20: 0.4490 - 335s/epoch - 37ms/step
Epoch 27/50
9052/9052 - 338s - loss: 3.0205 - accuracy20: 0.4882 - val_loss: 3.1819 - val_accuracy20: 0.4439 - 338s/epoch - 37ms/step
Epoch 28/50
9052/9052 - 332s - loss: 3.0186 - accuracy20: 0.4890 - val_loss: 3.1693 - val_accuracy20: 0.4455 - 332s/epoch - 37ms/step
Epoch 29/50
9052/9052 - 334s - loss: 3.0176 - accuracy20: 0.4892 - val_loss: 3.1785 - val_accuracy20: 0.4436 - 334s/epoch - 37ms/step
Epoch 30/50
9052/9052 - 337s - loss: 3.0163 - accuracy20: 0.4897 - val_loss: 3.1519 - val_accuracy20: 0.4486 - 337s/epoch - 37ms/step
Epoch 31/50
9052/9052 - 333s - loss: 3.0153 - accuracy20: 0.4899 - val_loss: 3.1524 - val_accuracy20: 0.4504 - 333s/epoch - 37ms/step
Epoch 32/50
9052/9052 - 344s - loss: 3.0147 - accuracy20: 0.4902 - val_loss: 3.1487 - val_accuracy20: 0.4509 - 344s/epoch - 38ms/step
testing model: results/AAPL/W7/deepVOL_L3/h20
Evaluating performance on  test set...
23942/23942 - 420s - 420s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0791621
{'0': {'precision': 0.4017868937415533, 'recall': 0.6743875795955981, 'f1-score': 0.5035616389289911, 'support': 1876203}, '1': {'precision': 0.5314875190015201, 'recall': 0.08890448386777038, 'f1-score': 0.15232828063693568, 'support': 2391083}, '2': {'precision': 0.42185528057973354, 'recall': 0.5845825871827898, 'f1-score': 0.4900635384204595, 'support': 1861778}, 'accuracy': 0.41869835263590005, 'macro avg': {'precision': 0.451709897774269, 'recall': 0.4492915502153861, 'f1-score': 0.38198448599546214, 'support': 6129064}, 'weighted avg': {'precision': 0.4584819847471767, 'recall': 0.41869835263590005, 'f1-score': 0.36243754908205594, 'support': 6129064}}
[[1265288   89146  521769]
 [1208693  212578  969812]
 [ 675171   98244 1088363]]
Evaluating performance on  train set...
9052/9052 - 158s - 158s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.034252
{'0': {'precision': 0.4409681611710352, 'recall': 0.670616579359341, 'f1-score': 0.5320702040400438, 'support': 778667}, '1': {'precision': 0.5505505708590528, 'recall': 0.14234271566601273, 'f1-score': 0.22620182614430975, 'support': 762568}, '2': {'precision': 0.4667812998937737, 'recall': 0.5629797188871488, 'f1-score': 0.5103871679024622, 'support': 775845}, 'accuracy': 0.46071693683429144, 'macro avg': {'precision': 0.4861000106412872, 'recall': 0.45864633797083415, 'f1-score': 0.42288639936227196, 'support': 2317080}, 'weighted avg': {'precision': 0.48567573864065877, 'recall': 0.46071693683429144, 'f1-score': 0.42414638942537525, 'support': 2317080}}
[[522187  40241 216239]
 [371308 108546 282714]
 [290688  48372 436785]]
Evaluating performance on  val set...
2763/2763 - 47s - 47s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0469711
{'0': {'precision': 0.42748972675627445, 'recall': 0.6764812559910879, 'f1-score': 0.5239065008025683, 'support': 231594}, '1': {'precision': 0.5651850096482616, 'recall': 0.1375908618899273, 'f1-score': 0.2213060970194264, 'support': 242676}, '2': {'precision': 0.45453964670932845, 'recall': 0.5495376429444957, 'f1-score': 0.49754465846665474, 'support': 233045}, 'accuracy': 0.44976566310625393, 'macro avg': {'precision': 0.48240479437128814, 'recall': 0.45453658694183696, 'f1-score': 0.41425241876288316, 'support': 707315}, 'weighted avg': {'precision': 0.4836446069250187, 'recall': 0.44976566310625393, 'f1-score': 0.41140026081663456, 'support': 707315}}
[[156669  11168  63757]
 [119359  33390  89927]
 [ 90458  14520 128067]]
training model: results/AAPL/W7/deepVOL_L3/h30
Epoch 1/50
9052/9052 - 347s - loss: 3.2661 - accuracy30: 0.3801 - val_loss: 3.2551 - val_accuracy30: 0.3819 - 347s/epoch - 38ms/step
Epoch 2/50
9052/9052 - 337s - loss: 3.2254 - accuracy30: 0.4039 - val_loss: 3.2439 - val_accuracy30: 0.3942 - 337s/epoch - 37ms/step
Epoch 3/50
9052/9052 - 341s - loss: 3.2043 - accuracy30: 0.4152 - val_loss: 3.2170 - val_accuracy30: 0.4084 - 341s/epoch - 38ms/step
Epoch 4/50
9052/9052 - 341s - loss: 3.1864 - accuracy30: 0.4245 - val_loss: 3.2019 - val_accuracy30: 0.4164 - 341s/epoch - 38ms/step
Epoch 5/50
9052/9052 - 349s - loss: 3.1753 - accuracy30: 0.4297 - val_loss: 3.1963 - val_accuracy30: 0.4192 - 349s/epoch - 39ms/step
Epoch 6/50
9052/9052 - 342s - loss: 3.1679 - accuracy30: 0.4337 - val_loss: 3.1913 - val_accuracy30: 0.4228 - 342s/epoch - 38ms/step
Epoch 7/50
9052/9052 - 363s - loss: 3.1620 - accuracy30: 0.4364 - val_loss: 3.1988 - val_accuracy30: 0.4206 - 363s/epoch - 40ms/step
Epoch 8/50
9052/9052 - 366s - loss: 3.1573 - accuracy30: 0.4381 - val_loss: 3.2087 - val_accuracy30: 0.4181 - 366s/epoch - 40ms/step
Epoch 9/50
9052/9052 - 333s - loss: 3.1533 - accuracy30: 0.4402 - val_loss: 3.1933 - val_accuracy30: 0.4246 - 333s/epoch - 37ms/step
Epoch 10/50
9052/9052 - 332s - loss: 3.1499 - accuracy30: 0.4414 - val_loss: 3.1973 - val_accuracy30: 0.4239 - 332s/epoch - 37ms/step
Epoch 11/50
9052/9052 - 339s - loss: 3.1469 - accuracy30: 0.4424 - val_loss: 3.1989 - val_accuracy30: 0.4240 - 339s/epoch - 37ms/step
Epoch 12/50
9052/9052 - 330s - loss: 3.1440 - accuracy30: 0.4436 - val_loss: 3.1918 - val_accuracy30: 0.4256 - 330s/epoch - 36ms/step
Epoch 13/50
9052/9052 - 363s - loss: 3.1415 - accuracy30: 0.4444 - val_loss: 3.1855 - val_accuracy30: 0.4267 - 363s/epoch - 40ms/step
Epoch 14/50
9052/9052 - 331s - loss: 3.1392 - accuracy30: 0.4452 - val_loss: 3.1929 - val_accuracy30: 0.4239 - 331s/epoch - 37ms/step
Epoch 15/50
9052/9052 - 335s - loss: 3.1370 - accuracy30: 0.4460 - val_loss: 3.1921 - val_accuracy30: 0.4229 - 335s/epoch - 37ms/step
Epoch 16/50
9052/9052 - 361s - loss: 3.1347 - accuracy30: 0.4470 - val_loss: 3.1957 - val_accuracy30: 0.4236 - 361s/epoch - 40ms/step
Epoch 17/50
9052/9052 - 338s - loss: 3.1332 - accuracy30: 0.4474 - val_loss: 3.1920 - val_accuracy30: 0.4234 - 338s/epoch - 37ms/step
Epoch 18/50
9052/9052 - 336s - loss: 3.1316 - accuracy30: 0.4482 - val_loss: 3.1942 - val_accuracy30: 0.4231 - 336s/epoch - 37ms/step
Epoch 19/50
9052/9052 - 335s - loss: 3.1299 - accuracy30: 0.4488 - val_loss: 3.1932 - val_accuracy30: 0.4218 - 335s/epoch - 37ms/step
Epoch 20/50
9052/9052 - 332s - loss: 3.1283 - accuracy30: 0.4494 - val_loss: 3.2003 - val_accuracy30: 0.4209 - 332s/epoch - 37ms/step
Epoch 21/50
9052/9052 - 334s - loss: 3.1267 - accuracy30: 0.4500 - val_loss: 3.1907 - val_accuracy30: 0.4209 - 334s/epoch - 37ms/step
Epoch 22/50
9052/9052 - 340s - loss: 3.1252 - accuracy30: 0.4509 - val_loss: 3.1954 - val_accuracy30: 0.4193 - 340s/epoch - 38ms/step
Epoch 23/50
9052/9052 - 351s - loss: 3.1241 - accuracy30: 0.4514 - val_loss: 3.1908 - val_accuracy30: 0.4211 - 351s/epoch - 39ms/step
testing model: results/AAPL/W7/deepVOL_L3/h30
Evaluating performance on  test set...
23942/23942 - 420s - 420s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0701132
{'0': {'precision': 0.39615775878421167, 'recall': 0.6220066124413901, 'f1-score': 0.4840333299762292, 'support': 1923949}, '1': {'precision': 0.41741817456873803, 'recall': 0.154994691917868, 'f1-score': 0.2260522261328808, 'support': 2296498}, '2': {'precision': 0.4201117689959633, 'recall': 0.4964751964380491, 'f1-score': 0.4551124572002722, 'support': 1908617}, 'accuracy': 0.40793096629436404, 'macro avg': {'precision': 0.41122923411630435, 'recall': 0.42449216693243574, 'f1-score': 0.3883993377697941, 'support': 6129064}, 'weighted avg': {'precision': 0.41158320277315613, 'recall': 0.40793096629436404, 'f1-score': 0.37836434716758655, 'support': 6129064}}
[[1196709  239592  487648]
 [1120237  355945  820316]
 [ 703843  257193  947581]]
Evaluating performance on  train set...
9052/9052 - 159s - 159s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0585499
{'0': {'precision': 0.41647473987298783, 'recall': 0.6177421631484414, 'f1-score': 0.49752427359136514, 'support': 772217}, '1': {'precision': 0.43409331638597604, 'recall': 0.21085620499733745, 'f1-score': 0.2838401030565478, 'support': 777454}, '2': {'precision': 0.4461209665028626, 'recall': 0.461601310383381, 'f1-score': 0.45372913714010144, 'support': 767409}, 'accuracy': 0.4295056709306541, 'macro avg': {'precision': 0.43222967425394215, 'recall': 0.43006655950971995, 'f1-score': 0.4116978379293381, 'support': 2317080}, 'weighted avg': {'precision': 0.432205061621108, 'recall': 0.4295056709306541, 'f1-score': 0.41132164140434363, 'support': 2317080}}
[[477031 100690 194496]
 [368218 163931 245305]
 [300153 113019 354237]]
Evaluating performance on  val set...
2763/2763 - 47s - 47s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0620099
{'0': {'precision': 0.4105513707105338, 'recall': 0.6318043912688123, 'f1-score': 0.4976960234071887, 'support': 233691}, '1': {'precision': 0.4423050487991674, 'recall': 0.18970113238694028, 'f1-score': 0.26552198733307986, 'support': 237463}, '2': {'precision': 0.44360513834313653, 'recall': 0.46178242808931197, 'f1-score': 0.4525113122641334, 'support': 236161}, 'accuracy': 0.4266119055866198, 'macro avg': {'precision': 0.4321538526176126, 'recall': 0.4277626505816882, 'f1-score': 0.405243107668134, 'support': 707315}, 'weighted avg': {'precision': 0.4322479761520193, 'recall': 0.4266119055866198, 'f1-score': 0.40466306115342454, 'support': 707315}}
[[147647  25900  60144]
 [115777  45047  76639]
 [ 96207  30899 109055]]
training model: results/AAPL/W7/deepVOL_L3/h50
Epoch 1/50
9052/9052 - 347s - loss: 3.2724 - accuracy50: 0.3729 - val_loss: 3.2938 - val_accuracy50: 0.3459 - 347s/epoch - 38ms/step
Epoch 2/50
9052/9052 - 365s - loss: 3.2491 - accuracy50: 0.3926 - val_loss: 3.2779 - val_accuracy50: 0.3634 - 365s/epoch - 40ms/step
Epoch 3/50
9052/9052 - 338s - loss: 3.2342 - accuracy50: 0.4022 - val_loss: 3.2595 - val_accuracy50: 0.3739 - 338s/epoch - 37ms/step
Epoch 4/50
9052/9052 - 366s - loss: 3.2252 - accuracy50: 0.4073 - val_loss: 3.2564 - val_accuracy50: 0.3761 - 366s/epoch - 40ms/step
Epoch 5/50
9052/9052 - 344s - loss: 3.2177 - accuracy50: 0.4111 - val_loss: 3.2600 - val_accuracy50: 0.3747 - 344s/epoch - 38ms/step
Epoch 6/50
9052/9052 - 341s - loss: 3.2119 - accuracy50: 0.4140 - val_loss: 3.2521 - val_accuracy50: 0.3801 - 341s/epoch - 38ms/step
Epoch 7/50
9052/9052 - 342s - loss: 3.2061 - accuracy50: 0.4172 - val_loss: 3.2540 - val_accuracy50: 0.3804 - 342s/epoch - 38ms/step
Epoch 8/50
9052/9052 - 339s - loss: 3.2009 - accuracy50: 0.4196 - val_loss: 3.2541 - val_accuracy50: 0.3821 - 339s/epoch - 37ms/step
Epoch 9/50
9052/9052 - 345s - loss: 3.1976 - accuracy50: 0.4213 - val_loss: 3.2537 - val_accuracy50: 0.3836 - 345s/epoch - 38ms/step
Epoch 10/50
9052/9052 - 335s - loss: 3.1941 - accuracy50: 0.4224 - val_loss: 3.2476 - val_accuracy50: 0.3862 - 335s/epoch - 37ms/step
Epoch 11/50
9052/9052 - 344s - loss: 3.1918 - accuracy50: 0.4236 - val_loss: 3.2533 - val_accuracy50: 0.3851 - 344s/epoch - 38ms/step
Epoch 12/50
9052/9052 - 334s - loss: 3.1898 - accuracy50: 0.4245 - val_loss: 3.2517 - val_accuracy50: 0.3859 - 334s/epoch - 37ms/step
Epoch 13/50
9052/9052 - 333s - loss: 3.1880 - accuracy50: 0.4254 - val_loss: 3.2510 - val_accuracy50: 0.3860 - 333s/epoch - 37ms/step
Epoch 14/50
9052/9052 - 345s - loss: 3.1864 - accuracy50: 0.4263 - val_loss: 3.2479 - val_accuracy50: 0.3872 - 345s/epoch - 38ms/step
Epoch 15/50
9052/9052 - 345s - loss: 3.1851 - accuracy50: 0.4268 - val_loss: 3.2493 - val_accuracy50: 0.3869 - 345s/epoch - 38ms/step
Epoch 16/50
9052/9052 - 348s - loss: 3.1836 - accuracy50: 0.4276 - val_loss: 3.2492 - val_accuracy50: 0.3869 - 348s/epoch - 38ms/step
Epoch 17/50
9052/9052 - 346s - loss: 3.1822 - accuracy50: 0.4281 - val_loss: 3.2500 - val_accuracy50: 0.3872 - 346s/epoch - 38ms/step
Epoch 18/50
9052/9052 - 345s - loss: 3.1810 - accuracy50: 0.4287 - val_loss: 3.2518 - val_accuracy50: 0.3875 - 345s/epoch - 38ms/step
Epoch 19/50
9052/9052 - 344s - loss: 3.1800 - accuracy50: 0.4293 - val_loss: 3.2509 - val_accuracy50: 0.3877 - 344s/epoch - 38ms/step
Epoch 20/50
9052/9052 - 343s - loss: 3.1787 - accuracy50: 0.4298 - val_loss: 3.2506 - val_accuracy50: 0.3881 - 343s/epoch - 38ms/step
testing model: results/AAPL/W7/deepVOL_L3/h50
Evaluating performance on  test set...
23942/23942 - 407s - 407s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0949631
{'0': {'precision': 0.31903080346504165, 'recall': 0.6384856660794851, 'f1-score': 0.4254685982521955, 'support': 1614492}, '1': {'precision': 0.5423297841768491, 'recall': 0.051392457163185454, 'f1-score': 0.09388787638718682, 'support': 2900951}, '2': {'precision': 0.33424703387262, 'recall': 0.5433376238906162, 'f1-score': 0.4138836921778366, 'support': 1613621}, 'accuracy': 0.33555825163515995, 'macro avg': {'precision': 0.3985358738381703, 'recall': 0.4110719157110956, 'f1-score': 0.31108005560573965, 'support': 6129064}, 'weighted avg': {'precision': 0.42872661188234734, 'recall': 0.33555825163515995, 'f1-score': 0.2654779252228991, 'support': 6129064}}
[[1030830   60925  522737]
 [1528309  149087 1223555]
 [ 671991   64889  876741]]
Evaluating performance on  train set...
9052/9052 - 157s - 157s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0773505
{'0': {'precision': 0.39355209210872644, 'recall': 0.612859580504402, 'f1-score': 0.4793111539537952, 'support': 778268}, '1': {'precision': 0.4038275682621948, 'recall': 0.04931572230465143, 'f1-score': 0.08789735445699275, 'support': 771032}, '2': {'precision': 0.40463044110461127, 'recall': 0.5327906431529865, 'f1-score': 0.4599497847355041, 'support': 767780}, 'accuracy': 0.39880323510625443, 'macro avg': {'precision': 0.40067003382517746, 'recall': 0.3983219819873467, 'f1-score': 0.3423860977154307, 'support': 2317080}, 'weighted avg': {'precision': 0.4006422468386544, 'recall': 0.39880323510625443, 'f1-score': 0.34264870090425087, 'support': 2317080}}
[[476969  27033 274266]
 [405378  38024 327630]
 [329612  29102 409066]]
Evaluating performance on  val set...
2763/2763 - 47s - 47s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0822119
{'0': {'precision': 0.37374398784025076, 'recall': 0.6294549335884387, 'f1-score': 0.46900966900966895, 'support': 225789}, '1': {'precision': 0.4228135899754554, 'recall': 0.039027162809923924, 'f1-score': 0.07145846144889144, 'support': 251594}, '2': {'precision': 0.39838589169280597, 'recall': 0.5264078075257033, 'f1-score': 0.45353562415574245, 'support': 229932}, 'accuracy': 0.3859397863752359, 'macro avg': {'precision': 0.39831448983617074, 'recall': 0.3982966346413553, 'f1-score': 0.33133458487143425, 'support': 707315}, 'weighted avg': {'precision': 0.3992087096632439, 'recall': 0.3859397863752359, 'f1-score': 0.32256929011709734, 'support': 707315}}
[[142124   6354  77311]
 [136303   9819 105472]
 [101844   7050 121038]]
training model: results/AAPL/W7/deepVOL_L3/h100
Epoch 1/50
9052/9052 - 347s - loss: 3.2823 - accuracy100: 0.3644 - val_loss: 3.2955 - val_accuracy100: 0.3450 - 347s/epoch - 38ms/step
Epoch 2/50
9052/9052 - 340s - loss: 3.2773 - accuracy100: 0.3683 - val_loss: 3.2942 - val_accuracy100: 0.3438 - 340s/epoch - 38ms/step
Epoch 3/50
9052/9052 - 335s - loss: 3.2711 - accuracy100: 0.3741 - val_loss: 3.3011 - val_accuracy100: 0.3478 - 335s/epoch - 37ms/step
Epoch 4/50
9052/9052 - 366s - loss: 3.2609 - accuracy100: 0.3829 - val_loss: 3.2984 - val_accuracy100: 0.3526 - 366s/epoch - 40ms/step
Epoch 5/50
9052/9052 - 372s - loss: 3.2528 - accuracy100: 0.3896 - val_loss: 3.2957 - val_accuracy100: 0.3591 - 372s/epoch - 41ms/step
Epoch 6/50
9052/9052 - 342s - loss: 3.2473 - accuracy100: 0.3940 - val_loss: 3.2939 - val_accuracy100: 0.3608 - 342s/epoch - 38ms/step
Epoch 7/50
9052/9052 - 345s - loss: 3.2436 - accuracy100: 0.3966 - val_loss: 3.2931 - val_accuracy100: 0.3618 - 345s/epoch - 38ms/step
Epoch 8/50
9052/9052 - 342s - loss: 3.2406 - accuracy100: 0.3989 - val_loss: 3.2908 - val_accuracy100: 0.3634 - 342s/epoch - 38ms/step
Epoch 9/50
9052/9052 - 341s - loss: 3.2380 - accuracy100: 0.4004 - val_loss: 3.2881 - val_accuracy100: 0.3641 - 341s/epoch - 38ms/step
Epoch 10/50
9052/9052 - 341s - loss: 3.2361 - accuracy100: 0.4014 - val_loss: 3.2940 - val_accuracy100: 0.3626 - 341s/epoch - 38ms/step
Epoch 11/50
9052/9052 - 338s - loss: 3.2344 - accuracy100: 0.4024 - val_loss: 3.2919 - val_accuracy100: 0.3639 - 338s/epoch - 37ms/step
Epoch 12/50
9052/9052 - 345s - loss: 3.2327 - accuracy100: 0.4033 - val_loss: 3.2917 - val_accuracy100: 0.3637 - 345s/epoch - 38ms/step
Epoch 13/50
9052/9052 - 356s - loss: 3.2316 - accuracy100: 0.4037 - val_loss: 3.2926 - val_accuracy100: 0.3637 - 356s/epoch - 39ms/step
Epoch 14/50
9052/9052 - 353s - loss: 3.2304 - accuracy100: 0.4045 - val_loss: 3.2926 - val_accuracy100: 0.3645 - 353s/epoch - 39ms/step
Epoch 15/50
9052/9052 - 372s - loss: 3.2290 - accuracy100: 0.4055 - val_loss: 3.2951 - val_accuracy100: 0.3642 - 372s/epoch - 41ms/step
Epoch 16/50
9052/9052 - 360s - loss: 3.2276 - accuracy100: 0.4063 - val_loss: 3.2908 - val_accuracy100: 0.3644 - 360s/epoch - 40ms/step
Epoch 17/50
9052/9052 - 351s - loss: 3.2266 - accuracy100: 0.4067 - val_loss: 3.2935 - val_accuracy100: 0.3638 - 351s/epoch - 39ms/step
Epoch 18/50
9052/9052 - 353s - loss: 3.2254 - accuracy100: 0.4072 - val_loss: 3.2932 - val_accuracy100: 0.3636 - 353s/epoch - 39ms/step
Epoch 19/50
9052/9052 - 350s - loss: 3.2242 - accuracy100: 0.4080 - val_loss: 3.2897 - val_accuracy100: 0.3648 - 350s/epoch - 39ms/step
testing model: results/AAPL/W7/deepVOL_L3/h100
Evaluating performance on  test set...
23942/23942 - 427s - 427s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1046498
{'0': {'precision': 0.32642291664891304, 'recall': 0.5957980448426309, 'f1-score': 0.42176906327678326, 'support': 1800162}, '1': {'precision': 0.4738561264021472, 'recall': 0.00738623154971537, 'f1-score': 0.014545731534328286, 'support': 2533633}, '2': {'precision': 0.33372553145579925, 'recall': 0.5212132555065564, 'f1-score': 0.4069114031280739, 'support': 1795269}, 'accuracy': 0.3307136293567827, 'macro avg': {'precision': 0.37800152483561983, 'recall': 0.37479917729963425, 'f1-score': 0.28107539931306186, 'support': 6129064}, 'weighted avg': {'precision': 0.3895078841918298, 'recall': 0.3307136293567827, 'f1-score': 0.24907907858252246, 'support': 6129064}}
[[1072533    8666  718963]
 [1365745   18714 1149174]
 [ 847438   12113  935718]]
Evaluating performance on  train set...
9052/9052 - 162s - 162s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0923944
{'0': {'precision': 0.3699777235490725, 'recall': 0.55240787398349, 'f1-score': 0.4431522093010119, 'support': 781104}, '1': {'precision': 0.4157502329916123, 'recall': 0.005836804974041199, 'f1-score': 0.011511990689248507, 'support': 764288}, '2': {'precision': 0.37117137504210174, 'recall': 0.5483705850032655, 'f1-score': 0.4426975013913706, 'support': 771688}, 'accuracy': 0.37077701244670014, 'macro avg': {'precision': 0.38563311052759547, 'recall': 0.3688717546535989, 'f1-score': 0.29912056712721036, 'support': 2317080}, 'weighted avg': {'precision': 0.3854733068824803, 'recall': 0.37077701244670014, 'f1-score': 0.3006244018710903, 'support': 2317080}}
[[431488   3029 346587]
 [389489   4461 370338]
 [345277   3240 423171]]
Evaluating performance on  val set...
2763/2763 - 51s - 51s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0952876
{'0': {'precision': 0.3549242546247088, 'recall': 0.5746169423175533, 'f1-score': 0.4388089320143491, 'support': 230122}, '1': {'precision': 0.43164134864764725, 'recall': 0.0048539037468803775, 'f1-score': 0.009599854972148061, 'support': 240013}, '2': {'precision': 0.373817956223724, 'recall': 0.5233451387132136, 'f1-score': 0.436120948927678, 'support': 237180}, 'accuracy': 0.36408672232315165, 'macro avg': {'precision': 0.3867945198320267, 'recall': 0.36760532825921577, 'f1-score': 0.29484324530472505, 'support': 707315}, 'weighted avg': {'precision': 0.38729216430141855, 'recall': 0.36408672232315165, 'f1-score': 0.2922641902279789, 'support': 707315}}
[[132232    692  97198]
 [128121   1165 110727]
 [112211    842 124127]]
training model: results/AAPL/W7/deepVOL_L3/h200
Epoch 1/50
9052/9052 - 354s - loss: 3.2682 - accuracy200: 0.3737 - val_loss: 3.3028 - val_accuracy200: 0.3359 - 354s/epoch - 39ms/step
Epoch 2/50
9052/9052 - 349s - loss: 3.2606 - accuracy200: 0.3774 - val_loss: 3.3114 - val_accuracy200: 0.3345 - 349s/epoch - 39ms/step
Epoch 3/50
9052/9052 - 346s - loss: 3.2553 - accuracy200: 0.3822 - val_loss: 3.3222 - val_accuracy200: 0.3332 - 346s/epoch - 38ms/step
Epoch 4/50
9052/9052 - 348s - loss: 3.2518 - accuracy200: 0.3864 - val_loss: 3.3220 - val_accuracy200: 0.3301 - 348s/epoch - 38ms/step
Epoch 5/50
9052/9052 - 351s - loss: 3.2483 - accuracy200: 0.3903 - val_loss: 3.3283 - val_accuracy200: 0.3304 - 351s/epoch - 39ms/step
Epoch 6/50
9052/9052 - 352s - loss: 3.2446 - accuracy200: 0.3933 - val_loss: 3.3289 - val_accuracy200: 0.3318 - 352s/epoch - 39ms/step
Epoch 7/50
9052/9052 - 350s - loss: 3.2420 - accuracy200: 0.3950 - val_loss: 3.3251 - val_accuracy200: 0.3359 - 350s/epoch - 39ms/step
Epoch 8/50
9052/9052 - 354s - loss: 3.2397 - accuracy200: 0.3969 - val_loss: 3.3267 - val_accuracy200: 0.3388 - 354s/epoch - 39ms/step
Epoch 9/50
9052/9052 - 351s - loss: 3.2377 - accuracy200: 0.3981 - val_loss: 3.3312 - val_accuracy200: 0.3401 - 351s/epoch - 39ms/step
Epoch 10/50
9052/9052 - 350s - loss: 3.2356 - accuracy200: 0.3998 - val_loss: 3.3336 - val_accuracy200: 0.3415 - 350s/epoch - 39ms/step
Epoch 11/50
9052/9052 - 343s - loss: 3.2339 - accuracy200: 0.4006 - val_loss: 3.3348 - val_accuracy200: 0.3415 - 343s/epoch - 38ms/step
testing model: results/AAPL/W7/deepVOL_L3/h200
Evaluating performance on  test set...
23942/23942 - 500s - 500s/epoch - 21ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1057426
{'0': {'precision': 0.27647503376712473, 'recall': 0.06018715688390789, 'f1-score': 0.09885426218873579, 'support': 1714070}, '1': {'precision': 0.4600860032814669, 'recall': 0.037612223871423246, 'f1-score': 0.06953955956212376, 'support': 2713772}, '2': {'precision': 0.27844200685643905, 'recall': 0.9057706754321305, 'f1-score': 0.42594477899296357, 'support': 1701222}, 'accuracy': 0.28489717190096236, 'macro avg': {'precision': 0.3383343479683436, 'recall': 0.33452335206248723, 'f1-score': 0.19811286691460772, 'support': 6129064}, 'weighted avg': {'precision': 0.358318618016502, 'recall': 0.28489717190096236, 'f1-score': 0.17666388597505875, 'support': 6129064}}
[[ 103165   59886 1551019]
 [ 169569  102071 2442132]
 [ 100410   59895 1540917]]
Evaluating performance on  train set...
9052/9052 - 196s - 196s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0981673
{'0': {'precision': 0.33667256663165857, 'recall': 0.05817585120302345, 'f1-score': 0.09920877104136638, 'support': 787973}, '1': {'precision': 0.3464941116762979, 'recall': 0.040066047625779914, 'f1-score': 0.071826592815667, 'support': 749762}, '2': {'precision': 0.3373946626530877, 'recall': 0.9066331342345174, 'f1-score': 0.4917786905412745, 'support': 779345}, 'accuracy': 0.3376926994320438, 'macro avg': {'precision': 0.34018711365368137, 'recall': 0.3349583443544402, 'f1-score': 0.22093801813276928, 'support': 2317080}, 'weighted avg': {'precision': 0.34009350297377, 'recall': 0.3376926994320438, 'f1-score': 0.22238850035662483, 'support': 2317080}}
[[ 45841  28642 713490]
 [ 45568  30040 674154]
 [ 44750  28015 706580]]
Evaluating performance on  val set...
2763/2763 - 61s - 61s/epoch - 22ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0992519
{'0': {'precision': 0.3192718579575167, 'recall': 0.05636818479584614, 'f1-score': 0.09581925801919225, 'support': 227451}, '1': {'precision': 0.3690831825640594, 'recall': 0.03611764173045172, 'f1-score': 0.0657965796579658, 'support': 242873}, '2': {'precision': 0.33598853574265103, 'recall': 0.9121527821731626, 'f1-score': 0.49108682367426865, 'support': 236991}, 'accuracy': 0.3361515025130246, 'macro avg': {'precision': 0.34144785875474243, 'recall': 0.33487953623315353, 'f1-score': 0.21756755378380888, 'support': 707315}, 'weighted avg': {'precision': 0.3419767744744033, 'recall': 0.3361515025130246, 'f1-score': 0.21794752857832939, 'support': 707315}}
[[ 12821   7307 207323]
 [ 14205   8772 219896]
 [ 13131   7688 216172]]
training model: results/AAPL/W7/deepVOL_L3/h300
Epoch 1/50
9052/9052 - 353s - loss: 3.2786 - accuracy300: 0.3682 - val_loss: 3.2977 - val_accuracy300: 0.3284 - 353s/epoch - 39ms/step
Epoch 2/50
9052/9052 - 347s - loss: 3.2764 - accuracy300: 0.3703 - val_loss: 3.3026 - val_accuracy300: 0.3207 - 347s/epoch - 38ms/step
Epoch 3/50
9052/9052 - 348s - loss: 3.2683 - accuracy300: 0.3771 - val_loss: 3.3182 - val_accuracy300: 0.3196 - 348s/epoch - 38ms/step
Epoch 4/50
9052/9052 - 351s - loss: 3.2585 - accuracy300: 0.3831 - val_loss: 3.3218 - val_accuracy300: 0.3193 - 351s/epoch - 39ms/step
Epoch 5/50
9052/9052 - 349s - loss: 3.2504 - accuracy300: 0.3888 - val_loss: 3.3174 - val_accuracy300: 0.3225 - 349s/epoch - 39ms/step
Epoch 6/50
9052/9052 - 349s - loss: 3.2462 - accuracy300: 0.3921 - val_loss: 3.3218 - val_accuracy300: 0.3249 - 349s/epoch - 39ms/step
Epoch 7/50
9052/9052 - 349s - loss: 3.2432 - accuracy300: 0.3942 - val_loss: 3.3214 - val_accuracy300: 0.3280 - 349s/epoch - 39ms/step
Epoch 8/50
9052/9052 - 346s - loss: 3.2407 - accuracy300: 0.3958 - val_loss: 3.3297 - val_accuracy300: 0.3272 - 346s/epoch - 38ms/step
Epoch 9/50
9052/9052 - 352s - loss: 3.2387 - accuracy300: 0.3973 - val_loss: 3.3299 - val_accuracy300: 0.3281 - 352s/epoch - 39ms/step
Epoch 10/50
9052/9052 - 349s - loss: 3.2370 - accuracy300: 0.3988 - val_loss: 3.3384 - val_accuracy300: 0.3258 - 349s/epoch - 39ms/step
Epoch 11/50
9052/9052 - 347s - loss: 3.2350 - accuracy300: 0.3997 - val_loss: 3.3381 - val_accuracy300: 0.3268 - 347s/epoch - 38ms/step
testing model: results/AAPL/W7/deepVOL_L3/h300
Evaluating performance on  test set...
23942/23942 - 419s - 419s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0976143
{'0': {'precision': 0.29197250220900434, 'recall': 0.37067726459099953, 'f1-score': 0.3266508912461075, 'support': 1803372}, '1': {'precision': 0.4102263878598562, 'recall': 0.5385720932759236, 'f1-score': 0.4657184614423642, 'support': 2540334}, '2': {'precision': 0.3042378492389792, 'recall': 0.08596259125620744, 'f1-score': 0.1340494328792058, 'support': 1785358}, 'accuracy': 0.3573296020403768, 'macro avg': {'precision': 0.33547891310261324, 'recall': 0.33173731637437687, 'f1-score': 0.3088062618558925, 'support': 6129064}, 'weighted avg': {'precision': 0.3445584112146393, 'recall': 0.3573296020403768, 'f1-score': 0.32818710009625535, 'support': 6129064}}
[[ 668469  984539  150364]
 [ 971565 1368153  200616]
 [ 649459  982425  153474]]
Evaluating performance on  train set...
9052/9052 - 168s - 168s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991049
{'0': {'precision': 0.3285917676304057, 'recall': 0.3340664878129672, 'f1-score': 0.3313065123231525, 'support': 777917}, '1': {'precision': 0.3252889002961622, 'recall': 0.5521874058333431, 'f1-score': 0.40940235706924927, 'support': 766593}, '2': {'precision': 0.3436821884671481, 'recall': 0.10004271457602547, 'f1-score': 0.15497394376505075, 'support': 772570}, 'accuracy': 0.32820144319574635, 'macro avg': {'precision': 0.33252095213123867, 'recall': 0.3287655360741119, 'f1-score': 0.2985609377191509, 'support': 2317080}, 'weighted avg': {'precision': 0.3325305403303049, 'recall': 0.32820144319574635, 'f1-score': 0.29835058305895434, 'support': 2317080}}
[[259876 440080  77961]
 [273653 423303  69637]
 [257349 437931  77290]]
Evaluating performance on  val set...
2763/2763 - 51s - 51s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989461
{'0': {'precision': 0.30875965590947696, 'recall': 0.3407583464759324, 'f1-score': 0.3239707888612471, 'support': 225095}, '1': {'precision': 0.33993371444963527, 'recall': 0.5385376977605733, 'f1-score': 0.4167856060570375, 'support': 246447}, '2': {'precision': 0.33910312591294184, 'recall': 0.09846335246190191, 'f1-score': 0.1526132931010114, 'support': 235773}, 'accuracy': 0.3289043778231764, 'macro avg': {'precision': 0.32926549875735134, 'recall': 0.32591979889946915, 'f1-score': 0.297789896006432, 'support': 707315}, 'weighted avg': {'precision': 0.32973605844324666, 'recall': 0.3289043778231764, 'f1-score': 0.29919040445765455, 'support': 707315}}
[[ 76703 125873  22519]
 [ 91000 132721  22726]
 [ 80720 131838  23215]]
training model: results/AAPL/W7/deepVOL_L3/h500
Epoch 1/50
9052/9052 - 359s - loss: 3.2773 - accuracy500: 0.3702 - val_loss: 3.2949 - val_accuracy500: 0.3443 - 359s/epoch - 40ms/step
Epoch 2/50
9052/9052 - 362s - loss: 3.2731 - accuracy500: 0.3723 - val_loss: 3.2985 - val_accuracy500: 0.3264 - 362s/epoch - 40ms/step
Epoch 3/50
9052/9052 - 353s - loss: 3.2718 - accuracy500: 0.3741 - val_loss: 3.3210 - val_accuracy500: 0.3160 - 353s/epoch - 39ms/step
Epoch 4/50
9052/9052 - 354s - loss: 3.2604 - accuracy500: 0.3852 - val_loss: 3.3308 - val_accuracy500: 0.3154 - 354s/epoch - 39ms/step
Epoch 5/50
9052/9052 - 351s - loss: 3.2487 - accuracy500: 0.3933 - val_loss: 3.3368 - val_accuracy500: 0.3158 - 351s/epoch - 39ms/step
Epoch 6/50
9052/9052 - 352s - loss: 3.2405 - accuracy500: 0.3984 - val_loss: 3.3340 - val_accuracy500: 0.3169 - 352s/epoch - 39ms/step
Epoch 7/50
9052/9052 - 354s - loss: 3.2356 - accuracy500: 0.4012 - val_loss: 3.3431 - val_accuracy500: 0.3176 - 354s/epoch - 39ms/step
Epoch 8/50
9052/9052 - 352s - loss: 3.2320 - accuracy500: 0.4036 - val_loss: 3.3512 - val_accuracy500: 0.3177 - 352s/epoch - 39ms/step
Epoch 9/50
9052/9052 - 361s - loss: 3.2290 - accuracy500: 0.4046 - val_loss: 3.3522 - val_accuracy500: 0.3186 - 361s/epoch - 40ms/step
Epoch 10/50
9052/9052 - 363s - loss: 3.2268 - accuracy500: 0.4060 - val_loss: 3.3524 - val_accuracy500: 0.3183 - 363s/epoch - 40ms/step
Epoch 11/50
9052/9052 - 363s - loss: 3.2248 - accuracy500: 0.4069 - val_loss: 3.3583 - val_accuracy500: 0.3185 - 363s/epoch - 40ms/step
testing model: results/AAPL/W7/deepVOL_L3/h500
Evaluating performance on  test set...
23942/23942 - 427s - 427s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0961746
{'0': {'precision': 0.2880578988246623, 'recall': 0.1390266090644847, 'f1-score': 0.1875399933646289, 'support': 1768683}, '1': {'precision': 0.42857901090144374, 'recall': 0.6877357307033163, 'f1-score': 0.5280752609298913, 'support': 2606523}, '2': {'precision': 0.2960870440527828, 'recall': 0.1844835784881102, 'f1-score': 0.22732641101538023, 'support': 1753858}, 'accuracy': 0.3853852725310096, 'macro avg': {'precision': 0.3375746512596296, 'recall': 0.33708197275197044, 'f1-score': 0.3143138884366335, 'support': 6129064}, 'weighted avg': {'precision': 0.35011525231374474, 'recall': 0.3853852725310096, 'f1-score': 0.34374536731864896, 'support': 6129064}}
[[ 245894 1202492  320297]
 [ 364999 1792599  448925]
 [ 242734 1187566  323558]]
Evaluating performance on  train set...
9052/9052 - 169s - 169s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.098583
{'0': {'precision': 0.33274884251998144, 'recall': 0.13736105787658107, 'f1-score': 0.19445126757465217, 'support': 772264}, '1': {'precision': 0.339606808696667, 'recall': 0.7074187785299296, 'f1-score': 0.45890804717583306, 'support': 777473}, '2': {'precision': 0.3398210509363276, 'recall': 0.16773854716860648, 'f1-score': 0.22460845817591676, 'support': 767343}, 'accuracy': 0.3386982754156093, 'macro avg': {'precision': 0.337392234050992, 'recall': 0.33750612785837236, 'f1-score': 0.29265592430880066, 'support': 2317080}, 'weighted avg': {'precision': 0.33739205430382596, 'recall': 0.3386982754156093, 'f1-score': 0.2931741925122526, 'support': 2317080}}
[[106079 536652 129533]
 [106953 549999 120521]
 [105764 532866 128713]]
Evaluating performance on  val set...
2763/2763 - 50s - 50s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983132
{'0': {'precision': 0.31317757996523876, 'recall': 0.1462327600121958, 'f1-score': 0.19937218607011098, 'support': 223028}, '1': {'precision': 0.35255223979684985, 'recall': 0.6885174830841538, 'f1-score': 0.4663249261132409, 'support': 246810}, '2': {'precision': 0.34002376865178924, 'recall': 0.17349048539437503, 'f1-score': 0.2297536561223494, 'support': 237477}, 'accuracy': 0.3446088376465931, 'macro avg': {'precision': 0.33525119613795934, 'recall': 0.33608024283024157, 'f1-score': 0.2984835894352338, 'support': 707315}, 'weighted avg': {'precision': 0.3359304017543368, 'recall': 0.3446088376465931, 'f1-score': 0.3027228942180229, 'support': 707315}}
[[ 32614 150661  39753]
 [ 36662 169933  40215]
 [ 34863 161414  41200]]
training model: results/AAPL/W7/deepVOL_L3/h1000
Epoch 1/50
9052/9052 - 350s - loss: 3.2789 - accuracy1000: 0.3689 - val_loss: 3.2962 - val_accuracy1000: 0.3406 - 350s/epoch - 39ms/step
Epoch 2/50
9052/9052 - 348s - loss: 3.2821 - accuracy1000: 0.3628 - val_loss: 3.2980 - val_accuracy1000: 0.3303 - 348s/epoch - 38ms/step
Epoch 3/50
9052/9052 - 349s - loss: 3.2792 - accuracy1000: 0.3662 - val_loss: 3.2980 - val_accuracy1000: 0.3322 - 349s/epoch - 39ms/step
Epoch 4/50
9052/9052 - 351s - loss: 3.2770 - accuracy1000: 0.3691 - val_loss: 3.3185 - val_accuracy1000: 0.3133 - 351s/epoch - 39ms/step
Epoch 5/50
9052/9052 - 349s - loss: 3.2592 - accuracy1000: 0.3859 - val_loss: 3.3819 - val_accuracy1000: 0.3148 - 349s/epoch - 39ms/step
Epoch 6/50
9052/9052 - 343s - loss: 3.2397 - accuracy1000: 0.4017 - val_loss: 3.3457 - val_accuracy1000: 0.3137 - 343s/epoch - 38ms/step
Epoch 7/50
9052/9052 - 348s - loss: 3.2241 - accuracy1000: 0.4100 - val_loss: 3.3285 - val_accuracy1000: 0.3215 - 348s/epoch - 38ms/step
Epoch 8/50
9052/9052 - 345s - loss: 3.2167 - accuracy1000: 0.4135 - val_loss: 3.3245 - val_accuracy1000: 0.3246 - 345s/epoch - 38ms/step
Epoch 9/50
9052/9052 - 350s - loss: 3.2121 - accuracy1000: 0.4157 - val_loss: 3.3447 - val_accuracy1000: 0.3166 - 350s/epoch - 39ms/step
Epoch 10/50
9052/9052 - 351s - loss: 3.2086 - accuracy1000: 0.4172 - val_loss: 3.3427 - val_accuracy1000: 0.3167 - 351s/epoch - 39ms/step
Epoch 11/50
9052/9052 - 351s - loss: 3.2056 - accuracy1000: 0.4187 - val_loss: 3.3471 - val_accuracy1000: 0.3221 - 351s/epoch - 39ms/step
testing model: results/AAPL/W7/deepVOL_L3/h1000
Evaluating performance on  test set...
23942/23942 - 438s - 438s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.095247
{'0': {'precision': 0.2924638032782206, 'recall': 0.04531195153163462, 'f1-score': 0.07846688514609515, 'support': 1809015}, '1': {'precision': 0.4116624591464653, 'recall': 0.9175475678714853, 'f1-score': 0.5683374041666523, 'support': 2520241}, '2': {'precision': 0.2939339085053161, 'recall': 0.03780180997084134, 'f1-score': 0.06698846783424205, 'support': 1799808}, 'accuracy': 0.4017655876982195, 'macro avg': {'precision': 0.332686723643334, 'recall': 0.33355377645798706, 'f1-score': 0.23793091904899652, 'support': 6129064}, 'weighted avg': {'precision': 0.34190940326096003, 'recall': 0.4017655876982195, 'f1-score': 0.2765285825637883, 'support': 6129064}}
[[  81970 1658150   68895]
 [ 113264 2312441   94536]
 [  85040 1646732   68036]]
Evaluating performance on  train set...
9052/9052 - 160s - 160s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0991527
{'0': {'precision': 0.33628968728148206, 'recall': 0.04879649525238216, 'f1-score': 0.08522641877659609, 'support': 778601}, '1': {'precision': 0.3301181638509152, 'recall': 0.9145888531724963, 'f1-score': 0.4851300567258551, 'support': 764666}, '2': {'precision': 0.33250782673706836, 'recall': 0.03678408090843653, 'f1-score': 0.06624025356724383, 'support': 773813}, 'accuracy': 0.3305073627151415, 'macro avg': {'precision': 0.3329718926231552, 'recall': 0.33338980977777166, 'f1-score': 0.21219890968989832, 'support': 2317080}, 'weighted avg': {'precision': 0.33299001399052436, 'recall': 0.3305073627151415, 'f1-score': 0.21085910032275054, 'support': 2317080}}
[[ 37993 711922  28686]
 [ 36857 699355  28454]
 [ 38127 707222  28464]]
Evaluating performance on  val set...
2763/2763 - 48s - 48s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0986469
{'0': {'precision': 0.31390717486308567, 'recall': 0.05101453705285302, 'f1-score': 0.08776583404222411, 'support': 222466}, '1': {'precision': 0.34178233475157516, 'recall': 0.9126639542728481, 'f1-score': 0.49732287442544415, 'support': 241607}, '2': {'precision': 0.34397599630712417, 'recall': 0.03676174344891096, 'f1-score': 0.06642450174195322, 'support': 243242}, 'accuracy': 0.34043813576694965, 'macro avg': {'precision': 0.3332218353072617, 'recall': 0.33348007825820397, 'f1-score': 0.21717107006987382, 'support': 707315}, 'weighted avg': {'precision': 0.3337693777300814, 'recall': 0.34043813576694965, 'f1-score': 0.22032450946192558, 'support': 707315}}
[[ 11349 202978   8139]
 [ 12186 220506   8915]
 [ 12619 221681   8942]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :       256            32
 Used       :        70 (peak)  21.31 (ave)

============================================
