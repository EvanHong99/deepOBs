This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/EXC_orderbooks/EXC_orderbooks_2019-12-18.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-10.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-27.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-06.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-02.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-04.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-29.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-20.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-03.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-16.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-05.csv
data/EXC_orderbooks/EXC_orderbooks_2019-11-26.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-12.csv
data/EXC_orderbooks/EXC_orderbooks_2019-12-11.csv
training model: results/EXC/W9/deepLOB_L1/h10
Epoch 1/50
1250/1250 - 27s - loss: 2.5085 - accuracy10: 0.4930 - val_loss: 3.5089 - val_accuracy10: 0.6872 - 27s/epoch - 22ms/step
Epoch 2/50
1250/1250 - 21s - loss: 2.2911 - accuracy10: 0.5709 - val_loss: 3.0536 - val_accuracy10: 0.6938 - 21s/epoch - 17ms/step
Epoch 3/50
1250/1250 - 21s - loss: 2.1387 - accuracy10: 0.6407 - val_loss: 3.0870 - val_accuracy10: 0.7729 - 21s/epoch - 17ms/step
Epoch 4/50
1250/1250 - 21s - loss: 2.0521 - accuracy10: 0.6629 - val_loss: 2.9222 - val_accuracy10: 0.7675 - 21s/epoch - 17ms/step
Epoch 5/50
1250/1250 - 21s - loss: 2.0080 - accuracy10: 0.6736 - val_loss: 2.9703 - val_accuracy10: 0.7837 - 21s/epoch - 17ms/step
Epoch 6/50
1250/1250 - 21s - loss: 1.9792 - accuracy10: 0.6789 - val_loss: 2.7795 - val_accuracy10: 0.7431 - 21s/epoch - 17ms/step
Epoch 7/50
1250/1250 - 21s - loss: 1.9578 - accuracy10: 0.6827 - val_loss: 2.7869 - val_accuracy10: 0.7758 - 21s/epoch - 17ms/step
Epoch 8/50
1250/1250 - 21s - loss: 1.9399 - accuracy10: 0.6852 - val_loss: 2.7405 - val_accuracy10: 0.7600 - 21s/epoch - 17ms/step
Epoch 9/50
1250/1250 - 21s - loss: 1.9242 - accuracy10: 0.6853 - val_loss: 2.8362 - val_accuracy10: 0.7680 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 21s - loss: 1.9106 - accuracy10: 0.6867 - val_loss: 2.7903 - val_accuracy10: 0.7799 - 21s/epoch - 17ms/step
Epoch 11/50
1250/1250 - 21s - loss: 1.9008 - accuracy10: 0.6853 - val_loss: 2.8492 - val_accuracy10: 0.7878 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 21s - loss: 1.8900 - accuracy10: 0.6876 - val_loss: 2.7418 - val_accuracy10: 0.7588 - 21s/epoch - 17ms/step
Epoch 13/50
1250/1250 - 21s - loss: 1.8812 - accuracy10: 0.6873 - val_loss: 2.6339 - val_accuracy10: 0.7884 - 21s/epoch - 17ms/step
Epoch 14/50
1250/1250 - 21s - loss: 1.8738 - accuracy10: 0.6876 - val_loss: 2.8310 - val_accuracy10: 0.7900 - 21s/epoch - 17ms/step
Epoch 15/50
1250/1250 - 21s - loss: 1.8676 - accuracy10: 0.6887 - val_loss: 2.8757 - val_accuracy10: 0.7927 - 21s/epoch - 17ms/step
Epoch 16/50
1250/1250 - 21s - loss: 1.8584 - accuracy10: 0.6881 - val_loss: 2.7476 - val_accuracy10: 0.7825 - 21s/epoch - 17ms/step
Epoch 17/50
1250/1250 - 21s - loss: 1.8506 - accuracy10: 0.6898 - val_loss: 2.8499 - val_accuracy10: 0.7798 - 21s/epoch - 17ms/step
Epoch 18/50
1250/1250 - 21s - loss: 1.8432 - accuracy10: 0.6885 - val_loss: 2.7352 - val_accuracy10: 0.7933 - 21s/epoch - 17ms/step
Epoch 19/50
1250/1250 - 21s - loss: 1.8346 - accuracy10: 0.6908 - val_loss: 2.6977 - val_accuracy10: 0.7918 - 21s/epoch - 17ms/step
Epoch 20/50
1250/1250 - 22s - loss: 1.8306 - accuracy10: 0.6901 - val_loss: 2.6599 - val_accuracy10: 0.7845 - 22s/epoch - 18ms/step
Epoch 21/50
1250/1250 - 22s - loss: 1.8301 - accuracy10: 0.6896 - val_loss: 2.7070 - val_accuracy10: 0.7783 - 22s/epoch - 18ms/step
Epoch 22/50
1250/1250 - 22s - loss: 1.8191 - accuracy10: 0.6917 - val_loss: 2.7136 - val_accuracy10: 0.7820 - 22s/epoch - 17ms/step
Epoch 23/50
1250/1250 - 22s - loss: 1.8166 - accuracy10: 0.6906 - val_loss: 2.5834 - val_accuracy10: 0.7732 - 22s/epoch - 17ms/step
Epoch 24/50
1250/1250 - 21s - loss: 1.8116 - accuracy10: 0.6907 - val_loss: 2.8364 - val_accuracy10: 0.7777 - 21s/epoch - 17ms/step
Epoch 25/50
1250/1250 - 22s - loss: 1.8059 - accuracy10: 0.6915 - val_loss: 2.6602 - val_accuracy10: 0.7701 - 22s/epoch - 17ms/step
Epoch 26/50
1250/1250 - 21s - loss: 1.8034 - accuracy10: 0.6911 - val_loss: 2.5381 - val_accuracy10: 0.7534 - 21s/epoch - 17ms/step
Epoch 27/50
1250/1250 - 21s - loss: 1.7982 - accuracy10: 0.6918 - val_loss: 2.5904 - val_accuracy10: 0.7603 - 21s/epoch - 17ms/step
Epoch 28/50
1250/1250 - 21s - loss: 1.7923 - accuracy10: 0.6915 - val_loss: 2.7024 - val_accuracy10: 0.7737 - 21s/epoch - 17ms/step
Epoch 29/50
1250/1250 - 21s - loss: 1.7860 - accuracy10: 0.6930 - val_loss: 2.6160 - val_accuracy10: 0.7651 - 21s/epoch - 17ms/step
Epoch 30/50
1250/1250 - 21s - loss: 1.7807 - accuracy10: 0.6925 - val_loss: 2.6025 - val_accuracy10: 0.7712 - 21s/epoch - 17ms/step
Epoch 31/50
1250/1250 - 21s - loss: 1.7746 - accuracy10: 0.6923 - val_loss: 2.6208 - val_accuracy10: 0.7597 - 21s/epoch - 17ms/step
Epoch 32/50
1250/1250 - 22s - loss: 1.7702 - accuracy10: 0.6931 - val_loss: 2.6543 - val_accuracy10: 0.7719 - 22s/epoch - 17ms/step
Epoch 33/50
1250/1250 - 21s - loss: 1.7665 - accuracy10: 0.6927 - val_loss: 2.5920 - val_accuracy10: 0.7656 - 21s/epoch - 17ms/step
Epoch 34/50
1250/1250 - 21s - loss: 1.7613 - accuracy10: 0.6928 - val_loss: 2.5907 - val_accuracy10: 0.7624 - 21s/epoch - 17ms/step
Epoch 35/50
1250/1250 - 21s - loss: 1.7563 - accuracy10: 0.6927 - val_loss: 2.6493 - val_accuracy10: 0.7515 - 21s/epoch - 17ms/step
Epoch 36/50
1250/1250 - 21s - loss: 1.7556 - accuracy10: 0.6908 - val_loss: 2.6285 - val_accuracy10: 0.7648 - 21s/epoch - 17ms/step
testing model: results/EXC/W9/deepLOB_L1/h10
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55673105
{'0': {'precision': 0.35948420570730966, 'recall': 0.5178386933679189, 'f1-score': 0.42437016420316875, 'support': 45491}, '1': {'precision': 0.9293318559556787, 'recall': 0.8175331751660464, 'f1-score': 0.8698549795739305, 'support': 512959}, '2': {'precision': 0.2961262587322726, 'recall': 0.5770053719384504, 'f1-score': 0.3913875893587784, 'support': 43932}, 'accuracy': 0.7773588852256541, 'macro avg': {'precision': 0.5283141067984203, 'recall': 0.6374590801574719, 'f1-score': 0.5618709110452925, 'support': 602382}, 'weighted avg': {'precision': 0.8401178227430873, 'recall': 0.7773588852256541, 'f1-score': 0.8013177737428079, 'support': 602382}}
[[ 23557  16524   5410]
 [ 38755 419361  54843]
 [  3218  15365  25349]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.55626076
{'0': {'precision': 0.32527606065409204, 'recall': 0.5514847494065481, 'f1-score': 0.40919891660158525, 'support': 22327}, '1': {'precision': 0.9408989557237187, 'recall': 0.7959072951371821, 'f1-score': 0.8623510451741694, 'support': 274635}, '2': {'precision': 0.2914614286575926, 'recall': 0.6318152102854653, 'f1-score': 0.3989048483847889, 'support': 22945}, 'accuracy': 0.7670791823873814, 'macro avg': {'precision': 0.5192121483451344, 'recall': 0.6597357516097319, 'f1-score': 0.5568182700535145, 'support': 319907}, 'weighted avg': {'precision': 0.8513530675851292, 'recall': 0.7670791823873814, 'f1-score': 0.7974843790494132, 'support': 319907}}
[[ 12313   7070   2944]
 [ 23753 218584  32298]
 [  1788   6660  14497]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5801968
{'0': {'precision': 0.29167929216411126, 'recall': 0.5204368512110726, 'f1-score': 0.37383976076740844, 'support': 9248}, '1': {'precision': 0.9398070539649411, 'recall': 0.7828205768394966, 'f1-score': 0.8541605706848016, 'support': 108141}, '2': {'precision': 0.29754004291203034, 'recall': 0.6460455037919827, 'f1-score': 0.40743397902360695, 'support': 9230}, 'accuracy': 0.7536862556172454, 'macro avg': {'precision': 0.5096754630136943, 'recall': 0.6497676439475173, 'f1-score': 0.5451447701586056, 'support': 126619}, 'weighted avg': {'precision': 0.8456504893644274, 'recall': 0.7536862556172454, 'f1-score': 0.7865143778452682, 'support': 126619}}
[[ 4813  2870  1565]
 [10973 84655 12513]
 [  715  2552  5963]]
training model: results/EXC/W9/deepLOB_L1/h20
Epoch 1/50
1250/1250 - 24s - loss: 2.5123 - accuracy20: 0.5023 - val_loss: 2.9832 - val_accuracy20: 0.5427 - 24s/epoch - 19ms/step
Epoch 2/50
1250/1250 - 21s - loss: 2.3180 - accuracy20: 0.5567 - val_loss: 3.0084 - val_accuracy20: 0.6301 - 21s/epoch - 17ms/step
Epoch 3/50
1250/1250 - 21s - loss: 2.1940 - accuracy20: 0.6140 - val_loss: 2.9497 - val_accuracy20: 0.6523 - 21s/epoch - 17ms/step
Epoch 4/50
1250/1250 - 21s - loss: 2.1109 - accuracy20: 0.6411 - val_loss: 2.9146 - val_accuracy20: 0.6400 - 21s/epoch - 16ms/step
Epoch 5/50
1250/1250 - 21s - loss: 2.0619 - accuracy20: 0.6510 - val_loss: 2.8978 - val_accuracy20: 0.6888 - 21s/epoch - 17ms/step
Epoch 6/50
1250/1250 - 20s - loss: 2.0324 - accuracy20: 0.6556 - val_loss: 2.8829 - val_accuracy20: 0.6582 - 20s/epoch - 16ms/step
Epoch 7/50
1250/1250 - 21s - loss: 2.0082 - accuracy20: 0.6589 - val_loss: 2.9701 - val_accuracy20: 0.6250 - 21s/epoch - 17ms/step
Epoch 8/50
1250/1250 - 21s - loss: 1.9910 - accuracy20: 0.6620 - val_loss: 2.8400 - val_accuracy20: 0.6448 - 21s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 21s - loss: 1.9758 - accuracy20: 0.6639 - val_loss: 2.8494 - val_accuracy20: 0.6684 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 21s - loss: 1.9623 - accuracy20: 0.6644 - val_loss: 2.8653 - val_accuracy20: 0.6764 - 21s/epoch - 17ms/step
Epoch 11/50
1250/1250 - 21s - loss: 1.9487 - accuracy20: 0.6660 - val_loss: 2.8830 - val_accuracy20: 0.6771 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 21s - loss: 1.9396 - accuracy20: 0.6659 - val_loss: 2.9801 - val_accuracy20: 0.6605 - 21s/epoch - 16ms/step
Epoch 13/50
1250/1250 - 21s - loss: 1.9316 - accuracy20: 0.6656 - val_loss: 3.2153 - val_accuracy20: 0.5694 - 21s/epoch - 17ms/step
Epoch 14/50
1250/1250 - 21s - loss: 1.9253 - accuracy20: 0.6665 - val_loss: 3.0182 - val_accuracy20: 0.5981 - 21s/epoch - 17ms/step
Epoch 15/50
1250/1250 - 21s - loss: 1.9177 - accuracy20: 0.6670 - val_loss: 3.1212 - val_accuracy20: 0.5835 - 21s/epoch - 17ms/step
Epoch 16/50
1250/1250 - 20s - loss: 1.9088 - accuracy20: 0.6671 - val_loss: 3.0452 - val_accuracy20: 0.5707 - 20s/epoch - 16ms/step
Epoch 17/50
1250/1250 - 21s - loss: 1.9018 - accuracy20: 0.6672 - val_loss: 3.2248 - val_accuracy20: 0.5980 - 21s/epoch - 17ms/step
Epoch 18/50
1250/1250 - 20s - loss: 1.8985 - accuracy20: 0.6663 - val_loss: 3.3542 - val_accuracy20: 0.5970 - 20s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h20
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.727699
{'0': {'precision': 0.24838406468891636, 'recall': 0.6118335500650195, 'f1-score': 0.3533285100693268, 'support': 63058}, '1': {'precision': 0.8524322485542578, 'recall': 0.7082928545107366, 'f1-score': 0.7737066180582318, 'support': 477616}, '2': {'precision': 0.3828363114803084, 'recall': 0.3114344979581254, 'f1-score': 0.3434637690224919, 'support': 61708}, 'accuracy': 0.6575412279915402, 'macro avg': {'precision': 0.4945508749078275, 'recall': 0.5438536341779605, 'f1-score': 0.49016629905001685, 'support': 602382}, 'weighted avg': {'precision': 0.7410944322464332, 'recall': 0.6575412279915402, 'f1-score': 0.6856269137147059, 'support': 602382}}
[[ 38581  22785   1692]
 [110035 338292  29289]
 [  6712  35778  19218]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7240371
{'0': {'precision': 0.2756133373248371, 'recall': 0.6112164896307537, 'f1-score': 0.37991373635550846, 'support': 31632}, '1': {'precision': 0.8774400678448655, 'recall': 0.6798820317450384, 'f1-score': 0.7661301874775487, 'support': 255662}, '2': {'precision': 0.31433051356007663, 'recall': 0.49789961058473614, 'f1-score': 0.3853711790393013, 'support': 32613}, 'accuracy': 0.6545402257531096, 'macro avg': {'precision': 0.48912797290992643, 'recall': 0.5963327106535095, 'f1-score': 0.5104717009574528, 'support': 319907}, 'weighted avg': {'precision': 0.7605258551714968, 'recall': 0.6545402257531096, 'f1-score': 0.6891250193377801, 'support': 319907}}
[[ 19334  10637   1661]
 [ 48082 173820  33760]
 [  2733  13642  16238]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7314447
{'0': {'precision': 0.24075049374588545, 'recall': 0.5664936875532491, 'f1-score': 0.33789933242475345, 'support': 12911}, '1': {'precision': 0.8691744128063827, 'recall': 0.6750779558680411, 'f1-score': 0.7599282316708494, 'support': 100698}, '2': {'precision': 0.3568892833370313, 'recall': 0.49454265949269793, 'f1-score': 0.4145885688510858, 'support': 13010}, 'accuracy': 0.6454560531989669, 'macro avg': {'precision': 0.48893806329643325, 'recall': 0.578704767637996, 'f1-score': 0.5041387109822295, 'support': 126619}, 'weighted avg': {'precision': 0.7524588270460596, 'recall': 0.6454560531989669, 'f1-score': 0.6814117046768637, 'support': 126619}}
[[ 7314  4693   904]
 [22029 67979 10690]
 [ 1037  5539  6434]]
training model: results/EXC/W9/deepLOB_L1/h30
Epoch 1/50
1250/1250 - 22s - loss: 2.5716 - accuracy30: 0.4899 - val_loss: 2.8642 - val_accuracy30: 0.5601 - 22s/epoch - 18ms/step
Epoch 2/50
1250/1250 - 21s - loss: 2.4491 - accuracy30: 0.5253 - val_loss: 3.1413 - val_accuracy30: 0.7151 - 21s/epoch - 17ms/step
Epoch 3/50
1250/1250 - 21s - loss: 2.3208 - accuracy30: 0.5764 - val_loss: 2.9409 - val_accuracy30: 0.7200 - 21s/epoch - 17ms/step
Epoch 4/50
1250/1250 - 21s - loss: 2.2310 - accuracy30: 0.6066 - val_loss: 2.9253 - val_accuracy30: 0.7276 - 21s/epoch - 17ms/step
Epoch 5/50
1250/1250 - 21s - loss: 2.1814 - accuracy30: 0.6185 - val_loss: 2.8012 - val_accuracy30: 0.7077 - 21s/epoch - 17ms/step
Epoch 6/50
1250/1250 - 21s - loss: 2.1507 - accuracy30: 0.6250 - val_loss: 2.7534 - val_accuracy30: 0.7199 - 21s/epoch - 17ms/step
Epoch 7/50
1250/1250 - 20s - loss: 2.1213 - accuracy30: 0.6279 - val_loss: 2.8765 - val_accuracy30: 0.7339 - 20s/epoch - 16ms/step
Epoch 8/50
1250/1250 - 21s - loss: 2.0940 - accuracy30: 0.6305 - val_loss: 2.8173 - val_accuracy30: 0.7279 - 21s/epoch - 17ms/step
Epoch 9/50
1250/1250 - 21s - loss: 2.0734 - accuracy30: 0.6323 - val_loss: 2.7505 - val_accuracy30: 0.7059 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 21s - loss: 2.0598 - accuracy30: 0.6341 - val_loss: 2.6854 - val_accuracy30: 0.7222 - 21s/epoch - 17ms/step
Epoch 11/50
1250/1250 - 21s - loss: 2.0451 - accuracy30: 0.6364 - val_loss: 2.7676 - val_accuracy30: 0.7247 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 21s - loss: 2.0350 - accuracy30: 0.6363 - val_loss: 2.7485 - val_accuracy30: 0.7310 - 21s/epoch - 17ms/step
Epoch 13/50
1250/1250 - 21s - loss: 2.0259 - accuracy30: 0.6386 - val_loss: 2.6780 - val_accuracy30: 0.6881 - 21s/epoch - 17ms/step
Epoch 14/50
1250/1250 - 22s - loss: 2.0197 - accuracy30: 0.6410 - val_loss: 2.7460 - val_accuracy30: 0.6924 - 22s/epoch - 18ms/step
Epoch 15/50
1250/1250 - 21s - loss: 2.0109 - accuracy30: 0.6410 - val_loss: 2.7564 - val_accuracy30: 0.7028 - 21s/epoch - 17ms/step
Epoch 16/50
1250/1250 - 21s - loss: 2.0046 - accuracy30: 0.6410 - val_loss: 2.9197 - val_accuracy30: 0.7069 - 21s/epoch - 17ms/step
Epoch 17/50
1250/1250 - 20s - loss: 1.9962 - accuracy30: 0.6429 - val_loss: 2.9048 - val_accuracy30: 0.7231 - 20s/epoch - 16ms/step
Epoch 18/50
1250/1250 - 20s - loss: 1.9905 - accuracy30: 0.6418 - val_loss: 2.8379 - val_accuracy30: 0.7094 - 20s/epoch - 16ms/step
Epoch 19/50
1250/1250 - 21s - loss: 1.9856 - accuracy30: 0.6442 - val_loss: 2.7596 - val_accuracy30: 0.7007 - 21s/epoch - 17ms/step
Epoch 20/50
1250/1250 - 21s - loss: 1.9792 - accuracy30: 0.6433 - val_loss: 2.8683 - val_accuracy30: 0.7158 - 21s/epoch - 17ms/step
Epoch 21/50
1250/1250 - 21s - loss: 1.9747 - accuracy30: 0.6452 - val_loss: 2.9196 - val_accuracy30: 0.7173 - 21s/epoch - 17ms/step
Epoch 22/50
1250/1250 - 20s - loss: 1.9715 - accuracy30: 0.6434 - val_loss: 2.9619 - val_accuracy30: 0.7209 - 20s/epoch - 16ms/step
Epoch 23/50
1250/1250 - 21s - loss: 1.9618 - accuracy30: 0.6445 - val_loss: 2.9313 - val_accuracy30: 0.7207 - 21s/epoch - 17ms/step
testing model: results/EXC/W9/deepLOB_L1/h30
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.79157335
{'0': {'precision': 0.35879650481938563, 'recall': 0.5187008386727093, 'f1-score': 0.4241791712371804, 'support': 76788}, '1': {'precision': 0.8479629144189512, 'recall': 0.682276044430334, 'f1-score': 0.7561495931438528, 'support': 450413}, '2': {'precision': 0.34291718036396907, 'recall': 0.5882470304997274, 'f1-score': 0.4332641025138625, 'support': 75181}, 'accuracy': 0.6496890677344277, 'macro avg': {'precision': 0.516558866534102, 'recall': 0.5964079712009236, 'f1-score': 0.5378642889649652, 'support': 602382}, 'weighted avg': {'precision': 0.7225741186177502, 'recall': 0.6496890677344277, 'f1-score': 0.6735339126812512, 'support': 602382}}
[[ 39830  29963   6995]
 [ 65360 307306  77747]
 [  5820  25136  44225]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7081014
{'0': {'precision': 0.40076924578769596, 'recall': 0.525511379636978, 'f1-score': 0.45474080638015063, 'support': 39061}, '1': {'precision': 0.8572117911232143, 'recall': 0.7459640370023906, 'f1-score': 0.7977280558426978, 'support': 240525}, '2': {'precision': 0.40196705850651754, 'recall': 0.5919496044244934, 'f1-score': 0.47880119158667583, 'support': 40321}, 'accuracy': 0.6996345813001904, 'macro avg': {'precision': 0.5533160318058093, 'recall': 0.6211416736879539, 'f1-score': 0.577090017936508, 'support': 319907}, 'weighted avg': {'precision': 0.744100714694163, 'recall': 0.6996345813001904, 'f1-score': 0.7156514678189172, 'support': 319907}}
[[ 20527  15635   2899]
 [ 28491 179423  32611]
 [  2201  14252  23868]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.73227733
{'0': {'precision': 0.3557097735664398, 'recall': 0.5099164594094764, 'f1-score': 0.4190775681341719, 'support': 15681}, '1': {'precision': 0.857414869048204, 'recall': 0.734172022425817, 'f1-score': 0.7910218560346343, 'support': 95069}, '2': {'precision': 0.4089109781843772, 'recall': 0.5858592223832629, 'f1-score': 0.48164745499287653, 'support': 15869}, 'accuracy': 0.6878114658937442, 'macro avg': {'precision': 0.5406785402663403, 'recall': 0.6099825680728522, 'f1-score': 0.5639156263872276, 'support': 126619}, 'weighted avg': {'precision': 0.739071288334665, 'recall': 0.6878114658937442, 'f1-score': 0.70618529320679, 'support': 126619}}
[[ 7996  5988  1697]
 [13530 69797 11742]
 [  953  5619  9297]]
training model: results/EXC/W9/deepLOB_L1/h50
Epoch 1/50
1250/1250 - 23s - loss: 2.6599 - accuracy50: 0.4981 - val_loss: 3.1706 - val_accuracy50: 0.6666 - 23s/epoch - 18ms/step
Epoch 2/50
1250/1250 - 20s - loss: 2.6039 - accuracy50: 0.5079 - val_loss: 3.3467 - val_accuracy50: 0.6554 - 20s/epoch - 16ms/step
Epoch 3/50
1250/1250 - 20s - loss: 2.5198 - accuracy50: 0.5395 - val_loss: 3.2858 - val_accuracy50: 0.6765 - 20s/epoch - 16ms/step
Epoch 4/50
1250/1250 - 21s - loss: 2.4553 - accuracy50: 0.5650 - val_loss: 3.2927 - val_accuracy50: 0.6859 - 21s/epoch - 17ms/step
Epoch 5/50
1250/1250 - 21s - loss: 2.3971 - accuracy50: 0.5858 - val_loss: 3.4544 - val_accuracy50: 0.6778 - 21s/epoch - 17ms/step
Epoch 6/50
1250/1250 - 21s - loss: 2.3560 - accuracy50: 0.5956 - val_loss: 3.4359 - val_accuracy50: 0.6797 - 21s/epoch - 17ms/step
Epoch 7/50
1250/1250 - 21s - loss: 2.3288 - accuracy50: 0.6000 - val_loss: 3.5895 - val_accuracy50: 0.6826 - 21s/epoch - 16ms/step
Epoch 8/50
1250/1250 - 20s - loss: 2.3065 - accuracy50: 0.6035 - val_loss: 3.5588 - val_accuracy50: 0.6809 - 20s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 21s - loss: 2.2860 - accuracy50: 0.6062 - val_loss: 3.7857 - val_accuracy50: 0.6822 - 21s/epoch - 16ms/step
Epoch 10/50
1250/1250 - 20s - loss: 2.2686 - accuracy50: 0.6064 - val_loss: 4.0088 - val_accuracy50: 0.6827 - 20s/epoch - 16ms/step
Epoch 11/50
1250/1250 - 20s - loss: 2.2569 - accuracy50: 0.6086 - val_loss: 3.9768 - val_accuracy50: 0.6802 - 20s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h50
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8294149
{'0': {'precision': 0.37407646048109966, 'recall': 0.3463140627330119, 'f1-score': 0.3596603082006143, 'support': 100585}, '1': {'precision': 0.6912714244598605, 'recall': 0.8630635676281154, 'f1-score': 0.7676738731748607, 'support': 403523}, '2': {'precision': 0.5583654022356607, 'recall': 0.031005148869487353, 'f1-score': 0.058748108087264175, 'support': 98274}, 'accuracy': 0.6410334306137966, 'macro avg': {'precision': 0.5412377623922069, 'recall': 0.4134609264102049, 'f1-score': 0.3953607631542464, 'support': 602382}, 'weighted avg': {'precision': 0.6166240049156764, 'recall': 0.6410334306137966, 'f1-score': 0.5838884760827281, 'support': 602382}}
[[ 34834  65686     65]
 [ 52912 348266   2345]
 [  5374  89853   3047]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8067673
{'0': {'precision': 0.4222331101311993, 'recall': 0.2985373364126251, 'f1-score': 0.349771133509211, 'support': 51960}, '1': {'precision': 0.6964785004361798, 'recall': 0.8721889457933977, 'f1-score': 0.77449283533394, 'support': 214199}, '2': {'precision': 0.4802759359721385, 'recall': 0.1334189179132247, 'f1-score': 0.20882656998500268, 'support': 53748}, 'accuracy': 0.6548934534098972, 'macro avg': {'precision': 0.5329958488465059, 'recall': 0.43471506670641585, 'f1-score': 0.4443635129427179, 'support': 319907}, 'weighted avg': {'precision': 0.6156104796830857, 'recall': 0.6548934534098972, 'f1-score': 0.6104702598454774, 'support': 319907}}
[[ 15512  36029    419]
 [ 20036 186822   7341]
 [  1190  45387   7171]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 7ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7930704
{'0': {'precision': 0.43789859693877553, 'recall': 0.2675857365549493, 'f1-score': 0.33218432510885343, 'support': 20528}, '1': {'precision': 0.7005539024948501, 'recall': 0.8962471889055472, 'f1-score': 0.7864091140333298, 'support': 85376}, '2': {'precision': 0.5177319587628866, 'recall': 0.12121650977552498, 'f1-score': 0.1964404459221592, 'support': 20715}, 'accuracy': 0.667530149503629, 'macro avg': {'precision': 0.5520614860655041, 'recall': 0.4283498117453404, 'f1-score': 0.4383446283547808, 'support': 126619}, 'weighted avg': {'precision': 0.6280612696604198, 'recall': 0.667530149503629, 'f1-score': 0.6162488108642592, 'support': 126619}}
[[ 5493 14828   207]
 [ 6726 76518  2132]
 [  325 17879  2511]]
training model: results/EXC/W9/deepLOB_L1/h100
Epoch 1/50
1250/1250 - 23s - loss: 2.9205 - accuracy100: 0.4869 - val_loss: 3.4694 - val_accuracy100: 0.5401 - 23s/epoch - 19ms/step
Epoch 2/50
1250/1250 - 20s - loss: 2.8625 - accuracy100: 0.4981 - val_loss: 3.4644 - val_accuracy100: 0.4943 - 20s/epoch - 16ms/step
Epoch 3/50
1250/1250 - 21s - loss: 2.8244 - accuracy100: 0.5099 - val_loss: 3.1859 - val_accuracy100: 0.5148 - 21s/epoch - 17ms/step
Epoch 4/50
1250/1250 - 21s - loss: 2.7826 - accuracy100: 0.5290 - val_loss: 3.1560 - val_accuracy100: 0.5251 - 21s/epoch - 17ms/step
Epoch 5/50
1250/1250 - 21s - loss: 2.7598 - accuracy100: 0.5386 - val_loss: 3.0964 - val_accuracy100: 0.5270 - 21s/epoch - 17ms/step
Epoch 6/50
1250/1250 - 20s - loss: 2.7387 - accuracy100: 0.5465 - val_loss: 3.1348 - val_accuracy100: 0.5200 - 20s/epoch - 16ms/step
Epoch 7/50
1250/1250 - 21s - loss: 2.7165 - accuracy100: 0.5513 - val_loss: 3.1965 - val_accuracy100: 0.5076 - 21s/epoch - 17ms/step
Epoch 8/50
1250/1250 - 21s - loss: 2.7014 - accuracy100: 0.5547 - val_loss: 3.3016 - val_accuracy100: 0.5048 - 21s/epoch - 17ms/step
Epoch 9/50
1250/1250 - 21s - loss: 2.6833 - accuracy100: 0.5583 - val_loss: 3.2289 - val_accuracy100: 0.5610 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 21s - loss: 2.6678 - accuracy100: 0.5605 - val_loss: 3.2855 - val_accuracy100: 0.5574 - 21s/epoch - 16ms/step
Epoch 11/50
1250/1250 - 21s - loss: 2.6541 - accuracy100: 0.5626 - val_loss: 3.2245 - val_accuracy100: 0.5636 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 22s - loss: 2.6430 - accuracy100: 0.5636 - val_loss: 3.3932 - val_accuracy100: 0.5586 - 22s/epoch - 17ms/step
Epoch 13/50
1250/1250 - 21s - loss: 2.6324 - accuracy100: 0.5652 - val_loss: 3.3770 - val_accuracy100: 0.5519 - 21s/epoch - 17ms/step
Epoch 14/50
1250/1250 - 21s - loss: 2.6241 - accuracy100: 0.5664 - val_loss: 3.4470 - val_accuracy100: 0.5447 - 21s/epoch - 17ms/step
Epoch 15/50
1250/1250 - 21s - loss: 2.6162 - accuracy100: 0.5679 - val_loss: 3.3614 - val_accuracy100: 0.5513 - 21s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h100
Evaluating performance on  test set...
2354/2354 - 17s - 17s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0163424
{'0': {'precision': 0.3701272306892136, 'recall': 0.5808947606700415, 'f1-score': 0.45215562004276805, 'support': 145782}, '1': {'precision': 0.5662520787951186, 'recall': 0.5407879893775785, 'f1-score': 0.5532271721256542, 'support': 312923}, '2': {'precision': 0.5027029196884952, 'recall': 0.26148235277741044, 'f1-score': 0.3440211344666706, 'support': 143677}, 'accuracy': 0.4838756802162083, 'macro avg': {'precision': 0.47969407639094247, 'recall': 0.46105503427501016, 'f1-score': 0.4498013088783643, 'support': 602382}, 'weighted avg': {'precision': 0.5036306439920578, 'recall': 0.4838756802162083, 'f1-score': 0.47886819579754825, 'support': 602382}}
[[ 84684  55479   5619]
 [112152 169225  31546]
 [ 31961  74147  37569]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9847275
{'0': {'precision': 0.40922348320771607, 'recall': 0.550365719464043, 'f1-score': 0.4694145705894044, 'support': 77245}, '1': {'precision': 0.5712251681925962, 'recall': 0.6173421531783935, 'f1-score': 0.5933889800620502, 'support': 163117}, '2': {'precision': 0.5402426133789702, 'recall': 0.2698598277704444, 'f1-score': 0.35992924152616973, 'support': 79545}, 'accuracy': 0.5147683545530419, 'macro avg': {'precision': 0.5068970882597608, 'recall': 0.4791892334709604, 'f1-score': 0.4742442640592081, 'support': 319907}, 'weighted avg': {'precision': 0.5244042875013112, 'recall': 0.5147683545530419, 'f1-score': 0.5054041652203896, 'support': 319907}}
[[ 42513  31816   2916]
 [ 47066 100699  15352]
 [ 14308  43771  21466]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9692178
{'0': {'precision': 0.4051435156086319, 'recall': 0.5130671265587688, 'f1-score': 0.45276281901194093, 'support': 30152}, '1': {'precision': 0.5788891085194703, 'recall': 0.6617407809110629, 'f1-score': 0.6175484469561183, 'support': 66384}, '2': {'precision': 0.5714741035856574, 'recall': 0.23840707376259015, 'f1-score': 0.33645298243144983, 'support': 30083}, 'accuracy': 0.5257583774946888, 'macro avg': {'precision': 0.5185022425712532, 'recall': 0.4710716604108072, 'f1-score': 0.4689214161331698, 'support': 126619}, 'weighted avg': {'precision': 0.5357530648698483, 'recall': 0.5257583774946888, 'f1-score': 0.5115231970878644, 'support': 126619}}
[[15470 13558  1124]
 [18201 43929  4254]
 [ 4513 18398  7172]]
training model: results/EXC/W9/deepLOB_L1/h200
Epoch 1/50
1250/1250 - 24s - loss: 3.1396 - accuracy200: 0.4471 - val_loss: 3.4480 - val_accuracy200: 0.3845 - 24s/epoch - 19ms/step
Epoch 2/50
1250/1250 - 21s - loss: 3.1090 - accuracy200: 0.4570 - val_loss: 3.3604 - val_accuracy200: 0.3946 - 21s/epoch - 17ms/step
Epoch 3/50
1250/1250 - 21s - loss: 3.0883 - accuracy200: 0.4631 - val_loss: 3.6831 - val_accuracy200: 0.3767 - 21s/epoch - 17ms/step
Epoch 4/50
1250/1250 - 20s - loss: 3.0740 - accuracy200: 0.4668 - val_loss: 3.6415 - val_accuracy200: 0.3795 - 20s/epoch - 16ms/step
Epoch 5/50
1250/1250 - 20s - loss: 3.0593 - accuracy200: 0.4724 - val_loss: 3.5069 - val_accuracy200: 0.3727 - 20s/epoch - 16ms/step
Epoch 6/50
1250/1250 - 21s - loss: 3.0493 - accuracy200: 0.4762 - val_loss: 3.5526 - val_accuracy200: 0.3786 - 21s/epoch - 17ms/step
Epoch 7/50
1250/1250 - 21s - loss: 3.0397 - accuracy200: 0.4803 - val_loss: 3.7829 - val_accuracy200: 0.3736 - 21s/epoch - 17ms/step
Epoch 8/50
1250/1250 - 20s - loss: 3.0320 - accuracy200: 0.4833 - val_loss: 3.7329 - val_accuracy200: 0.3715 - 20s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 21s - loss: 3.0247 - accuracy200: 0.4848 - val_loss: 3.7739 - val_accuracy200: 0.3745 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 21s - loss: 3.0186 - accuracy200: 0.4868 - val_loss: 3.8748 - val_accuracy200: 0.3725 - 21s/epoch - 17ms/step
Epoch 11/50
1250/1250 - 21s - loss: 3.0149 - accuracy200: 0.4875 - val_loss: 3.6919 - val_accuracy200: 0.3793 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 20s - loss: 3.0083 - accuracy200: 0.4894 - val_loss: 3.8690 - val_accuracy200: 0.3685 - 20s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h200
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1393349
{'0': {'precision': 0.3886635611597462, 'recall': 0.40818607397410483, 'f1-score': 0.39818567049966064, 'support': 189688}, '1': {'precision': 0.3675462835393098, 'recall': 0.6352109165680104, 'f1-score': 0.4656549195023157, 'support': 224686}, '2': {'precision': 0.4933010166296371, 'recall': 0.038971745883153906, 'f1-score': 0.07223665465515797, 'support': 188008}, 'accuracy': 0.3776308057013656, 'macro avg': {'precision': 0.41650362044289774, 'recall': 0.36078957880842305, 'f1-score': 0.3120257482190448, 'support': 602382}, 'weighted avg': {'precision': 0.41344504880140526, 'recall': 0.3776308057013656, 'f1-score': 0.3216202570419499, 'support': 602382}}
[[ 77428 109900   2360]
 [ 76797 142723   5166]
 [ 44991 135690   7327]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1205314
{'0': {'precision': 0.42725914861837194, 'recall': 0.4493402450518379, 'f1-score': 0.4380215909960952, 'support': 101856}, '1': {'precision': 0.3614934716601826, 'recall': 0.6071606644564771, 'f1-score': 0.4531743751795461, 'support': 114319}, '2': {'precision': 0.4997112330349408, 'recall': 0.1000944742220337, 'f1-score': 0.1667817845956148, 'support': 103732}, 'accuracy': 0.3924921930436033, 'macro avg': {'precision': 0.42948795110449844, 'recall': 0.38553179457678294, 'f1-score': 0.3526592502570854, 'support': 319907}, 'weighted avg': {'precision': 0.4272508124347819, 'recall': 0.3924921930436033, 'f1-score': 0.35548511488751766, 'support': 319907}}
[[45768 52771  3317]
 [37831 69410  7078]
 [23521 69828 10383]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1115866
{'0': {'precision': 0.42178854493793927, 'recall': 0.42187266291070447, 'f1-score': 0.4218305997307942, 'support': 40114}, '1': {'precision': 0.3748769806121445, 'recall': 0.6480583556633065, 'f1-score': 0.47499025796898137, 'support': 47022}, '2': {'precision': 0.523325014398157, 'recall': 0.06904237266671732, 'f1-score': 0.12199051284346192, 'support': 39483}, 'accuracy': 0.3958489642154811, 'macro avg': {'precision': 0.4399968466494136, 'recall': 0.3796577970802428, 'f1-score': 0.33960379018107917, 'support': 126619}, 'weighted avg': {'precision': 0.43602881571855084, 'recall': 0.3958489642154811, 'f1-score': 0.3480745860132913, 'support': 126619}}
[[16923 22358   833]
 [14899 30473  1650]
 [ 8300 28457  2726]]
training model: results/EXC/W9/deepLOB_L1/h300
Epoch 1/50
1250/1250 - 22s - loss: 3.2129 - accuracy300: 0.4209 - val_loss: 3.4079 - val_accuracy300: 0.3550 - 22s/epoch - 18ms/step
Epoch 2/50
1250/1250 - 20s - loss: 3.1961 - accuracy300: 0.4277 - val_loss: 3.3119 - val_accuracy300: 0.3718 - 20s/epoch - 16ms/step
Epoch 3/50
1250/1250 - 21s - loss: 3.1864 - accuracy300: 0.4320 - val_loss: 3.3553 - val_accuracy300: 0.3641 - 21s/epoch - 16ms/step
Epoch 4/50
1250/1250 - 20s - loss: 3.1682 - accuracy300: 0.4409 - val_loss: 3.3237 - val_accuracy300: 0.3662 - 20s/epoch - 16ms/step
Epoch 5/50
1250/1250 - 21s - loss: 3.1559 - accuracy300: 0.4439 - val_loss: 3.3757 - val_accuracy300: 0.3624 - 21s/epoch - 16ms/step
Epoch 6/50
1250/1250 - 20s - loss: 3.1467 - accuracy300: 0.4474 - val_loss: 3.4171 - val_accuracy300: 0.3568 - 20s/epoch - 16ms/step
Epoch 7/50
1250/1250 - 20s - loss: 3.1376 - accuracy300: 0.4499 - val_loss: 3.4939 - val_accuracy300: 0.3433 - 20s/epoch - 16ms/step
Epoch 8/50
1250/1250 - 21s - loss: 3.1346 - accuracy300: 0.4507 - val_loss: 3.4575 - val_accuracy300: 0.3499 - 21s/epoch - 17ms/step
Epoch 9/50
1250/1250 - 21s - loss: 3.1251 - accuracy300: 0.4546 - val_loss: 3.4033 - val_accuracy300: 0.3563 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 20s - loss: 3.1167 - accuracy300: 0.4571 - val_loss: 3.5597 - val_accuracy300: 0.3537 - 20s/epoch - 16ms/step
Epoch 11/50
1250/1250 - 21s - loss: 3.1138 - accuracy300: 0.4577 - val_loss: 3.5666 - val_accuracy300: 0.3544 - 21s/epoch - 17ms/step
Epoch 12/50
1250/1250 - 20s - loss: 3.1059 - accuracy300: 0.4606 - val_loss: 3.5785 - val_accuracy300: 0.3540 - 20s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h300
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1227915
{'0': {'precision': 0.3530289055442403, 'recall': 0.7564062182483235, 'f1-score': 0.48138598399917226, 'support': 196840}, '1': {'precision': 0.3676068747839083, 'recall': 0.3142040038131554, 'f1-score': 0.3388140480363485, 'support': 209800}, '2': {'precision': 0.6128538638102525, 'recall': 0.004092121261660758, 'f1-score': 0.008129957523255637, 'support': 195742}, 'accuracy': 0.357932341935848, 'macro avg': {'precision': 0.44449654804613375, 'recall': 0.3582341144410465, 'f1-score': 0.2761099965195921, 'support': 602382}, 'weighted avg': {'precision': 0.4425354228827201, 'recall': 0.357932341935848, 'f1-score': 0.277947512565017, 'support': 602382}}
[[148891  47833    116]
 [143490  65920    390]
 [129372  65569    801]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1126125
{'0': {'precision': 0.3809249559367475, 'recall': 0.7212122351525634, 'f1-score': 0.49853637299908704, 'support': 106382}, '1': {'precision': 0.34025804769972634, 'recall': 0.37239333225564125, 'f1-score': 0.35560115864122993, 'support': 105163}, '2': {'precision': 0.5955254636443921, 'recall': 0.01866890607408501, 'f1-score': 0.036202900884939916, 'support': 108362}, 'accuracy': 0.3685727414529848, 'macro avg': {'precision': 0.43890282242695533, 'recall': 0.3707581578274299, 'f1-score': 0.29678014417508564, 'support': 319907}, 'weighted avg': {'precision': 0.44024809092687256, 'recall': 0.3685727414529848, 'f1-score': 0.29494321732337964, 'support': 319907}}
[[76724 29239   419]
 [65046 39162   955]
 [59645 46694  2023]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1055404
{'0': {'precision': 0.3868885156414025, 'recall': 0.6897164779638814, 'f1-score': 0.4957127004943004, 'support': 42748}, '1': {'precision': 0.34265190430387, 'recall': 0.394008565915188, 'f1-score': 0.3665400571384787, 'support': 42494}, '2': {'precision': 0.5723514211886305, 'recall': 0.021412862218140514, 'f1-score': 0.04128130460104834, 'support': 41377}, 'accuracy': 0.37208475821164283, 'macro avg': {'precision': 0.4339639470446343, 'recall': 0.36837930203240327, 'f1-score': 0.30117802074460914, 'support': 126619}, 'weighted avg': {'precision': 0.4326486944506692, 'recall': 0.37208475821164283, 'f1-score': 0.3038610022923135, 'support': 126619}}
[[29484 13007   257]
 [25346 16743   405]
 [21378 19113   886]]
training model: results/EXC/W9/deepLOB_L1/h500
Epoch 1/50
1250/1250 - 23s - loss: 3.2624 - accuracy500: 0.3951 - val_loss: 3.4246 - val_accuracy500: 0.3420 - 23s/epoch - 18ms/step
Epoch 2/50
1250/1250 - 20s - loss: 3.2319 - accuracy500: 0.4067 - val_loss: 3.4447 - val_accuracy500: 0.3411 - 20s/epoch - 16ms/step
Epoch 3/50
1250/1250 - 20s - loss: 3.2140 - accuracy500: 0.4170 - val_loss: 3.3807 - val_accuracy500: 0.3421 - 20s/epoch - 16ms/step
Epoch 4/50
1250/1250 - 20s - loss: 3.2041 - accuracy500: 0.4204 - val_loss: 3.3995 - val_accuracy500: 0.3421 - 20s/epoch - 16ms/step
Epoch 5/50
1250/1250 - 20s - loss: 3.1907 - accuracy500: 0.4270 - val_loss: 3.4099 - val_accuracy500: 0.3392 - 20s/epoch - 16ms/step
Epoch 6/50
1250/1250 - 20s - loss: 3.1805 - accuracy500: 0.4308 - val_loss: 3.3842 - val_accuracy500: 0.3342 - 20s/epoch - 16ms/step
Epoch 7/50
1250/1250 - 21s - loss: 3.1721 - accuracy500: 0.4335 - val_loss: 3.4326 - val_accuracy500: 0.3405 - 21s/epoch - 16ms/step
Epoch 8/50
1250/1250 - 20s - loss: 3.1645 - accuracy500: 0.4379 - val_loss: 3.4342 - val_accuracy500: 0.3417 - 20s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 20s - loss: 3.1596 - accuracy500: 0.4403 - val_loss: 3.4447 - val_accuracy500: 0.3410 - 20s/epoch - 16ms/step
Epoch 10/50
1250/1250 - 20s - loss: 3.1536 - accuracy500: 0.4430 - val_loss: 3.4172 - val_accuracy500: 0.3411 - 20s/epoch - 16ms/step
Epoch 11/50
1250/1250 - 20s - loss: 3.1513 - accuracy500: 0.4436 - val_loss: 3.3921 - val_accuracy500: 0.3414 - 20s/epoch - 16ms/step
Epoch 12/50
1250/1250 - 20s - loss: 3.1461 - accuracy500: 0.4463 - val_loss: 3.3987 - val_accuracy500: 0.3404 - 20s/epoch - 16ms/step
Epoch 13/50
1250/1250 - 20s - loss: 3.1421 - accuracy500: 0.4482 - val_loss: 3.4069 - val_accuracy500: 0.3426 - 20s/epoch - 16ms/step
testing model: results/EXC/W9/deepLOB_L1/h500
Evaluating performance on  test set...
2354/2354 - 15s - 15s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1065153
{'0': {'precision': 0.3353028244200718, 'recall': 0.5638765621015047, 'f1-score': 0.4205376740859655, 'support': 196050}, '1': {'precision': 0.34423262036941743, 'recall': 0.27256603230909354, 'f1-score': 0.30423581218280904, 'support': 208610}, '2': {'precision': 0.3503864864613467, 'recall': 0.1905149654565501, 'f1-score': 0.24682451536387434, 'support': 197722}, 'accuracy': 0.34044343954500633, 'macro avg': {'precision': 0.3433073104169453, 'recall': 0.34231918662238275, 'f1-score': 0.32386600054421627, 'support': 602382}, 'weighted avg': {'precision': 0.3433462529407081, 'recall': 0.34044343954500633, 'f1-score': 0.32324286019632936, 'support': 602382}}
[[110548  52011  33491]
 [115403  56860  36347]
 [103745  56308  37669]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1248394
{'0': {'precision': 0.34061854614347403, 'recall': 0.7557348026546243, 'f1-score': 0.4695881852916176, 'support': 105627}, '1': {'precision': 0.32811761077413387, 'recall': 0.1512348604029644, 'f1-score': 0.2070410566125862, 'support': 105518}, '2': {'precision': 0.37674720988189403, 'recall': 0.12787554476747393, 'f1-score': 0.1909416658658136, 'support': 108762}, 'accuracy': 0.3428871515784275, 'macro avg': {'precision': 0.34849445559983394, 'recall': 0.34494840260835424, 'f1-score': 0.28919030259000583, 'support': 319907}, 'weighted avg': {'precision': 0.3487782676475862, 'recall': 0.3428871515784275, 'f1-score': 0.28825548338217727, 'support': 319907}}
[[79826 14675 11126]
 [77678 15958 11882]
 [76852 18002 13908]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1287694
{'0': {'precision': 0.3437000328261169, 'recall': 0.7586303611078649, 'f1-score': 0.4730728308871755, 'support': 42785}, '1': {'precision': 0.3213437393959959, 'recall': 0.13285634118967452, 'f1-score': 0.18799007444168736, 'support': 42768}, '2': {'precision': 0.3647586206896552, 'recall': 0.12879267520576632, 'f1-score': 0.19036821077637403, 'support': 41066}, 'accuracy': 0.3429895987174121, 'macro avg': {'precision': 0.34326746430392263, 'recall': 0.34009312583443524, 'f1-score': 0.2838103720350789, 'support': 126619}, 'weighted avg': {'precision': 0.3429786403951598, 'recall': 0.3429895987174121, 'f1-score': 0.28509182284627477, 'support': 126619}}
[[32458  5647  4680]
 [32555  5682  4531]
 [29424  6353  5289]]
training model: results/EXC/W9/deepLOB_L1/h1000
Epoch 1/50
1250/1250 - 23s - loss: 3.1782 - accuracy1000: 0.4464 - val_loss: 3.4281 - val_accuracy1000: 0.3406 - 23s/epoch - 18ms/step
Epoch 2/50
1250/1250 - 20s - loss: 3.1405 - accuracy1000: 0.4602 - val_loss: 3.2913 - val_accuracy1000: 0.4353 - 20s/epoch - 16ms/step
Epoch 3/50
1250/1250 - 20s - loss: 3.1277 - accuracy1000: 0.4677 - val_loss: 3.4280 - val_accuracy1000: 0.4269 - 20s/epoch - 16ms/step
Epoch 4/50
1250/1250 - 20s - loss: 3.1296 - accuracy1000: 0.4693 - val_loss: 3.4143 - val_accuracy1000: 0.4472 - 20s/epoch - 16ms/step
Epoch 5/50
1250/1250 - 20s - loss: 3.1161 - accuracy1000: 0.4704 - val_loss: 3.7447 - val_accuracy1000: 0.3260 - 20s/epoch - 16ms/step
Epoch 6/50
1250/1250 - 20s - loss: 3.0972 - accuracy1000: 0.4773 - val_loss: 3.4697 - val_accuracy1000: 0.4398 - 20s/epoch - 16ms/step
Epoch 7/50
1250/1250 - 20s - loss: 3.0916 - accuracy1000: 0.4786 - val_loss: 3.7176 - val_accuracy1000: 0.3808 - 20s/epoch - 16ms/step
Epoch 8/50
1250/1250 - 20s - loss: 3.0738 - accuracy1000: 0.4855 - val_loss: 3.6837 - val_accuracy1000: 0.4066 - 20s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 21s - loss: 3.0681 - accuracy1000: 0.4879 - val_loss: 3.6912 - val_accuracy1000: 0.4070 - 21s/epoch - 17ms/step
Epoch 10/50
1250/1250 - 20s - loss: 3.0565 - accuracy1000: 0.4914 - val_loss: 3.5923 - val_accuracy1000: 0.4325 - 20s/epoch - 16ms/step
Epoch 11/50
1250/1250 - 20s - loss: 3.0507 - accuracy1000: 0.4930 - val_loss: 3.6742 - val_accuracy1000: 0.3821 - 20s/epoch - 16ms/step
Epoch 12/50
1250/1250 - 21s - loss: 3.0384 - accuracy1000: 0.4960 - val_loss: 3.6733 - val_accuracy1000: 0.3797 - 21s/epoch - 17ms/step
testing model: results/EXC/W9/deepLOB_L1/h1000
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0817482
{'0': {'precision': 0.21671777399204997, 'recall': 0.26288816025128814, 'f1-score': 0.23758061704723726, 'support': 145172}, '1': {'precision': 0.5164177953624879, 'recall': 0.6863634907926341, 'f1-score': 0.5893844954397138, 'support': 312250}, '2': {'precision': 0.2541019955654102, 'recall': 0.01976407284768212, 'f1-score': 0.0366755208500016, 'support': 144960}, 'accuracy': 0.4238938082479224, 'macro avg': {'precision': 0.32907918830664934, 'recall': 0.3230052412972015, 'f1-score': 0.28788021111231754, 'support': 602382}, 'weighted avg': {'precision': 0.3810662246964095, 'recall': 0.4238938082479224, 'f1-score': 0.37159451235503116, 'support': 602382}}
[[ 38164 104655   2353]
 [ 91876 214317   6057]
 [ 46060  96035   2865]]
Evaluating performance on  train set...
1250/1250 - 8s - 8s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1307241
{'0': {'precision': 0.36386672778495976, 'recall': 0.6595343453014433, 'f1-score': 0.4689903311570416, 'support': 107118}, '1': {'precision': 0.4067768066151333, 'recall': 0.4622952074720563, 'f1-score': 0.43276268286346486, 'support': 104496}, '2': {'precision': 0.36351931330472104, 'recall': 0.02346412048793551, 'f1-score': 0.04408282227214768, 'support': 108293}, 'accuracy': 0.37978850103311274, 'macro avg': {'precision': 0.37805428256827134, 'recall': 0.38176455775381174, 'f1-score': 0.31527861209755137, 'support': 319907}, 'weighted avg': {'precision': 0.3777654828641838, 'recall': 0.37978850103311274, 'f1-score': 0.3133196106171427, 'support': 319907}}
[[70648 34371  2099]
 [53838 48308  2350]
 [69673 36079  2541]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0974467
{'0': {'precision': 0.37880807993921406, 'recall': 0.6519046679167078, 'f1-score': 0.47917667860543134, 'support': 40532}, '1': {'precision': 0.5085052212095494, 'recall': 0.5647487910826982, 'f1-score': 0.5351532920412403, 'support': 48804}, '2': {'precision': 0.4508258258258258, 'recall': 0.032213072982324384, 'f1-score': 0.06012967181515508, 'support': 37283}, 'accuracy': 0.43584296195673633, 'macro avg': {'precision': 0.44604637565819644, 'recall': 0.41628884399391014, 'f1-score': 0.35815321415394225, 'support': 126619}, 'weighted avg': {'precision': 0.45000416348471667, 'recall': 0.43584296195673633, 'f1-score': 0.3773637839210581, 'support': 126619}}
[[26423 13528   581]
 [20360 27562   882]
 [22970 13112  1201]]
training model: results/EXC/W9/deepOF_L1/h10
Epoch 1/50
1250/1250 - 21s - loss: 2.8328 - accuracy10: 0.4751 - val_loss: 3.2032 - val_accuracy10: 0.7258 - 21s/epoch - 17ms/step
Epoch 2/50
1250/1250 - 18s - loss: 2.6949 - accuracy10: 0.5068 - val_loss: 3.1120 - val_accuracy10: 0.7322 - 18s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 18s - loss: 2.6208 - accuracy10: 0.5210 - val_loss: 3.0188 - val_accuracy10: 0.7238 - 18s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 2.5713 - accuracy10: 0.5348 - val_loss: 2.9937 - val_accuracy10: 0.7374 - 18s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 19s - loss: 2.5394 - accuracy10: 0.5424 - val_loss: 2.9391 - val_accuracy10: 0.7329 - 19s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 18s - loss: 2.5100 - accuracy10: 0.5507 - val_loss: 2.9259 - val_accuracy10: 0.7364 - 18s/epoch - 14ms/step
Epoch 7/50
1250/1250 - 18s - loss: 2.4859 - accuracy10: 0.5582 - val_loss: 2.8956 - val_accuracy10: 0.7300 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 19s - loss: 2.4619 - accuracy10: 0.5599 - val_loss: 2.8836 - val_accuracy10: 0.7211 - 19s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 18s - loss: 2.4455 - accuracy10: 0.5690 - val_loss: 2.9060 - val_accuracy10: 0.7336 - 18s/epoch - 14ms/step
Epoch 10/50
1250/1250 - 18s - loss: 2.4290 - accuracy10: 0.5724 - val_loss: 2.9251 - val_accuracy10: 0.7426 - 18s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 2.4161 - accuracy10: 0.5718 - val_loss: 2.8698 - val_accuracy10: 0.7273 - 18s/epoch - 15ms/step
Epoch 12/50
1250/1250 - 18s - loss: 2.3997 - accuracy10: 0.5750 - val_loss: 2.8430 - val_accuracy10: 0.7295 - 18s/epoch - 15ms/step
Epoch 13/50
1250/1250 - 18s - loss: 2.3867 - accuracy10: 0.5777 - val_loss: 2.8581 - val_accuracy10: 0.7339 - 18s/epoch - 14ms/step
Epoch 14/50
1250/1250 - 18s - loss: 2.3745 - accuracy10: 0.5790 - val_loss: 2.8563 - val_accuracy10: 0.7342 - 18s/epoch - 15ms/step
Epoch 15/50
1250/1250 - 18s - loss: 2.3600 - accuracy10: 0.5816 - val_loss: 2.8456 - val_accuracy10: 0.7244 - 18s/epoch - 14ms/step
Epoch 16/50
1250/1250 - 18s - loss: 2.3476 - accuracy10: 0.5855 - val_loss: 2.8647 - val_accuracy10: 0.7303 - 18s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 18s - loss: 2.3335 - accuracy10: 0.5849 - val_loss: 2.8497 - val_accuracy10: 0.7252 - 18s/epoch - 15ms/step
Epoch 18/50
1250/1250 - 18s - loss: 2.3196 - accuracy10: 0.5870 - val_loss: 2.8410 - val_accuracy10: 0.7220 - 18s/epoch - 14ms/step
Epoch 19/50
1250/1250 - 18s - loss: 2.3068 - accuracy10: 0.5899 - val_loss: 2.8548 - val_accuracy10: 0.7225 - 18s/epoch - 14ms/step
Epoch 20/50
1250/1250 - 18s - loss: 2.2998 - accuracy10: 0.5882 - val_loss: 2.8576 - val_accuracy10: 0.7267 - 18s/epoch - 15ms/step
Epoch 21/50
1250/1250 - 18s - loss: 2.2885 - accuracy10: 0.5914 - val_loss: 2.8739 - val_accuracy10: 0.7303 - 18s/epoch - 15ms/step
Epoch 22/50
1250/1250 - 18s - loss: 2.2772 - accuracy10: 0.5936 - val_loss: 2.8555 - val_accuracy10: 0.7230 - 18s/epoch - 14ms/step
Epoch 23/50
1250/1250 - 18s - loss: 2.2612 - accuracy10: 0.5938 - val_loss: 2.8736 - val_accuracy10: 0.7277 - 18s/epoch - 15ms/step
Epoch 24/50
1250/1250 - 19s - loss: 2.2498 - accuracy10: 0.5961 - val_loss: 2.9013 - val_accuracy10: 0.7303 - 19s/epoch - 15ms/step
Epoch 25/50
1250/1250 - 18s - loss: 2.2389 - accuracy10: 0.5976 - val_loss: 2.8428 - val_accuracy10: 0.7222 - 18s/epoch - 14ms/step
Epoch 26/50
1250/1250 - 18s - loss: 2.2263 - accuracy10: 0.5996 - val_loss: 2.8740 - val_accuracy10: 0.7217 - 18s/epoch - 14ms/step
Epoch 27/50
1250/1250 - 18s - loss: 2.2171 - accuracy10: 0.6002 - val_loss: 2.8980 - val_accuracy10: 0.7278 - 18s/epoch - 15ms/step
Epoch 28/50
1250/1250 - 18s - loss: 2.2066 - accuracy10: 0.5993 - val_loss: 2.9584 - val_accuracy10: 0.7303 - 18s/epoch - 14ms/step
testing model: results/EXC/W9/deepOF_L1/h10
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6680234
{'0': {'precision': 0.2782102068709894, 'recall': 0.5280061551989448, 'f1-score': 0.3644101225876927, 'support': 45490}, '1': {'precision': 0.9178900864496347, 'recall': 0.7784843563885472, 'f1-score': 0.8424591353659463, 'support': 512957}, '2': {'precision': 0.25861494203202745, 'recall': 0.47679315289886415, 'f1-score': 0.33533988665108383, 'support': 43931}, 'accuracy': 0.7375667770071284, 'macro avg': {'precision': 0.4849050784508839, 'recall': 0.5944278881621187, 'f1-score': 0.514069714868241, 'support': 602378}, 'weighted avg': {'precision': 0.8215026783911689, 'recall': 0.7375667770071284, 'f1-score': 0.7693742861407499, 'support': 602378}}
[[ 24019  17752   3719]
 [ 57300 399329  56328]
 [  5015  17970  20946]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6645098
{'0': {'precision': 0.2505065541909606, 'recall': 0.5425398531255597, 'f1-score': 0.34275368468697837, 'support': 22332}, '1': {'precision': 0.9270105930026314, 'recall': 0.7554761003174973, 'f1-score': 0.8324991223230853, 'support': 274648}, '2': {'precision': 0.2662377129922663, 'recall': 0.5540870627235454, 'f1-score': 0.35965967808151306, 'support': 22926}, 'accuracy': 0.7261789400636437, 'macro avg': {'precision': 0.48125162006195277, 'recall': 0.6173676720555341, 'f1-score': 0.5116374950305256, 'support': 319906}, 'weighted avg': {'precision': 0.832431037627428, 'recall': 0.7261789400636437, 'f1-score': 0.7644250248945538, 'support': 319906}}
[[ 12116   7986   2230]
 [ 34378 207490  32780]
 [  1872   8351  12703]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6679222
{'0': {'precision': 0.22712664457165813, 'recall': 0.4901918283299014, 'f1-score': 0.31042174256202604, 'support': 9227}, '1': {'precision': 0.9171514543630893, 'recall': 0.7603806707936801, 'f1-score': 0.8314406950899171, 'support': 108230}, '2': {'precision': 0.26868924889543444, 'recall': 0.49781707050862256, 'f1-score': 0.3490071546084095, 'support': 9162}, 'accuracy': 0.7216926369660162, 'macro avg': {'precision': 0.47098911594339393, 'recall': 0.5827965232107347, 'f1-score': 0.4969565307534509, 'support': 126619}, 'weighted avg': {'precision': 0.8199459034865211, 'recall': 0.7216926369660162, 'f1-score': 0.7585646024587448, 'support': 126619}}
[[ 4523  3588  1116]
 [14636 82296 11298]
 [  755  3846  4561]]
training model: results/EXC/W9/deepOF_L1/h20
Epoch 1/50
1250/1250 - 21s - loss: 2.8240 - accuracy20: 0.4650 - val_loss: 3.1454 - val_accuracy20: 0.7135 - 21s/epoch - 16ms/step
Epoch 2/50
1250/1250 - 18s - loss: 2.6660 - accuracy20: 0.4954 - val_loss: 3.0747 - val_accuracy20: 0.7253 - 18s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 18s - loss: 2.5883 - accuracy20: 0.5146 - val_loss: 3.0221 - val_accuracy20: 0.7357 - 18s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 2.5463 - accuracy20: 0.5302 - val_loss: 3.0428 - val_accuracy20: 0.7394 - 18s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 18s - loss: 2.5183 - accuracy20: 0.5381 - val_loss: 2.9740 - val_accuracy20: 0.7376 - 18s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 18s - loss: 2.4940 - accuracy20: 0.5479 - val_loss: 2.9816 - val_accuracy20: 0.7316 - 18s/epoch - 15ms/step
Epoch 7/50
1250/1250 - 18s - loss: 2.4746 - accuracy20: 0.5497 - val_loss: 2.9525 - val_accuracy20: 0.7236 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 18s - loss: 2.4593 - accuracy20: 0.5533 - val_loss: 2.9371 - val_accuracy20: 0.7198 - 18s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 19s - loss: 2.4427 - accuracy20: 0.5566 - val_loss: 2.9154 - val_accuracy20: 0.7199 - 19s/epoch - 15ms/step
Epoch 10/50
1250/1250 - 19s - loss: 2.4336 - accuracy20: 0.5607 - val_loss: 2.9463 - val_accuracy20: 0.7202 - 19s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 2.4189 - accuracy20: 0.5623 - val_loss: 2.9324 - val_accuracy20: 0.7166 - 18s/epoch - 15ms/step
Epoch 12/50
1250/1250 - 18s - loss: 2.4066 - accuracy20: 0.5639 - val_loss: 2.9415 - val_accuracy20: 0.7192 - 18s/epoch - 15ms/step
Epoch 13/50
1250/1250 - 18s - loss: 2.3978 - accuracy20: 0.5668 - val_loss: 2.9553 - val_accuracy20: 0.7249 - 18s/epoch - 15ms/step
Epoch 14/50
1250/1250 - 18s - loss: 2.3863 - accuracy20: 0.5687 - val_loss: 2.9486 - val_accuracy20: 0.7232 - 18s/epoch - 14ms/step
Epoch 15/50
1250/1250 - 18s - loss: 2.3745 - accuracy20: 0.5681 - val_loss: 2.9679 - val_accuracy20: 0.7276 - 18s/epoch - 15ms/step
Epoch 16/50
1250/1250 - 18s - loss: 2.3628 - accuracy20: 0.5719 - val_loss: 2.9599 - val_accuracy20: 0.7232 - 18s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 18s - loss: 2.3479 - accuracy20: 0.5735 - val_loss: 2.9614 - val_accuracy20: 0.7267 - 18s/epoch - 15ms/step
Epoch 18/50
1250/1250 - 18s - loss: 2.3398 - accuracy20: 0.5739 - val_loss: 3.0156 - val_accuracy20: 0.7161 - 18s/epoch - 14ms/step
Epoch 19/50
1250/1250 - 19s - loss: 2.3241 - accuracy20: 0.5767 - val_loss: 3.0390 - val_accuracy20: 0.7265 - 19s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h20
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69655436
{'0': {'precision': 0.368968532609405, 'recall': 0.44832453177284043, 'f1-score': 0.40479395171683036, 'support': 63057}, '1': {'precision': 0.8619431129711185, 'recall': 0.8158750963116813, 'f1-score': 0.8382766576494695, 'support': 477616}, '2': {'precision': 0.34767205103841453, 'recall': 0.4150879183210437, 'f1-score': 0.37840073868882734, 'support': 61705}, 'accuracy': 0.736344952836923, 'macro avg': {'precision': 0.526194565539646, 'recall': 0.5597625154685218, 'f1-score': 0.540490449351709, 'support': 602378}, 'weighted avg': {'precision': 0.7576587699333148, 'recall': 0.736344952836923, 'f1-score': 0.745791934489824, 'support': 602378}}
[[ 28270  31352   3435]
 [ 43319 389675  44622]
 [  5030  31062  25613]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.69345975
{'0': {'precision': 0.3439275329903825, 'recall': 0.4863061353573688, 'f1-score': 0.40290842394864407, 'support': 31620}, '1': {'precision': 0.8754396414178083, 'recall': 0.787530358672314, 'f1-score': 0.8291614337773568, 'support': 255693}, '2': {'precision': 0.3588392837380199, 'recall': 0.4974074187709017, 'f1-score': 0.4169109705292393, 'support': 32593}, 'accuracy': 0.7281982832457035, 'macro avg': {'precision': 0.5260688193820702, 'recall': 0.5904146376001947, 'f1-score': 0.5496602760850801, 'support': 319906}, 'weighted avg': {'precision': 0.7702713472115961, 'recall': 0.7281982832457035, 'f1-score': 0.7450285962581176, 'support': 319906}}
[[ 15377  14078   2165]
 [ 27525 201366  26802]
 [  1808  14573  16212]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7050118
{'0': {'precision': 0.3126193463909651, 'recall': 0.4441171911331577, 'f1-score': 0.3669431014056546, 'support': 12902}, '1': {'precision': 0.8636152139804144, 'recall': 0.791862207185308, 'f1-score': 0.8261837229042877, 'support': 100789}, '2': {'precision': 0.35748031496062993, 'recall': 0.4389696782178218, 'f1-score': 0.39405617470402393, 'support': 12928}, 'accuracy': 0.7203974127105727, 'macro avg': {'precision': 0.5112382917773365, 'recall': 0.5583163588454292, 'f1-score': 0.529060999671322, 'support': 126619}, 'weighted avg': {'precision': 0.7557936338213004, 'recall': 0.7203974127105727, 'f1-score': 0.735267924787825, 'support': 126619}}
[[ 5730  6074  1098]
 [11876 79811  9102]
 [  723  6530  5675]]
training model: results/EXC/W9/deepOF_L1/h30
Epoch 1/50
1250/1250 - 21s - loss: 2.8506 - accuracy30: 0.4538 - val_loss: 3.1168 - val_accuracy30: 0.6905 - 21s/epoch - 17ms/step
Epoch 2/50
1250/1250 - 18s - loss: 2.6951 - accuracy30: 0.4870 - val_loss: 3.0262 - val_accuracy30: 0.7086 - 18s/epoch - 14ms/step
Epoch 3/50
1250/1250 - 18s - loss: 2.6227 - accuracy30: 0.5042 - val_loss: 2.9993 - val_accuracy30: 0.7137 - 18s/epoch - 14ms/step
Epoch 4/50
1250/1250 - 18s - loss: 2.5798 - accuracy30: 0.5163 - val_loss: 2.9829 - val_accuracy30: 0.7129 - 18s/epoch - 14ms/step
Epoch 5/50
1250/1250 - 18s - loss: 2.5548 - accuracy30: 0.5227 - val_loss: 2.9393 - val_accuracy30: 0.7071 - 18s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 18s - loss: 2.5332 - accuracy30: 0.5273 - val_loss: 2.9336 - val_accuracy30: 0.7025 - 18s/epoch - 14ms/step
Epoch 7/50
1250/1250 - 18s - loss: 2.5150 - accuracy30: 0.5332 - val_loss: 2.9205 - val_accuracy30: 0.6999 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 19s - loss: 2.5012 - accuracy30: 0.5362 - val_loss: 2.8970 - val_accuracy30: 0.7024 - 19s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 18s - loss: 2.4867 - accuracy30: 0.5398 - val_loss: 2.8928 - val_accuracy30: 0.6981 - 18s/epoch - 15ms/step
Epoch 10/50
1250/1250 - 18s - loss: 2.4755 - accuracy30: 0.5400 - val_loss: 2.8776 - val_accuracy30: 0.7017 - 18s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 2.4605 - accuracy30: 0.5448 - val_loss: 2.8816 - val_accuracy30: 0.7007 - 18s/epoch - 14ms/step
Epoch 12/50
1250/1250 - 18s - loss: 2.4468 - accuracy30: 0.5470 - val_loss: 2.8865 - val_accuracy30: 0.6972 - 18s/epoch - 14ms/step
Epoch 13/50
1250/1250 - 18s - loss: 2.4384 - accuracy30: 0.5489 - val_loss: 2.8721 - val_accuracy30: 0.6964 - 18s/epoch - 15ms/step
Epoch 14/50
1250/1250 - 19s - loss: 2.4296 - accuracy30: 0.5510 - val_loss: 2.9071 - val_accuracy30: 0.7016 - 19s/epoch - 15ms/step
Epoch 15/50
1250/1250 - 19s - loss: 2.4143 - accuracy30: 0.5539 - val_loss: 2.9097 - val_accuracy30: 0.7003 - 19s/epoch - 15ms/step
Epoch 16/50
1250/1250 - 18s - loss: 2.4065 - accuracy30: 0.5555 - val_loss: 2.9173 - val_accuracy30: 0.6980 - 18s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 18s - loss: 2.3941 - accuracy30: 0.5566 - val_loss: 2.9540 - val_accuracy30: 0.7048 - 18s/epoch - 15ms/step
Epoch 18/50
1250/1250 - 18s - loss: 2.3844 - accuracy30: 0.5581 - val_loss: 2.9452 - val_accuracy30: 0.6986 - 18s/epoch - 15ms/step
Epoch 19/50
1250/1250 - 18s - loss: 2.3717 - accuracy30: 0.5602 - val_loss: 2.9608 - val_accuracy30: 0.6996 - 18s/epoch - 14ms/step
Epoch 20/50
1250/1250 - 18s - loss: 2.3635 - accuracy30: 0.5613 - val_loss: 2.8937 - val_accuracy30: 0.7037 - 18s/epoch - 14ms/step
Epoch 21/50
1250/1250 - 18s - loss: 2.3513 - accuracy30: 0.5643 - val_loss: 2.9447 - val_accuracy30: 0.6974 - 18s/epoch - 14ms/step
Epoch 22/50
1250/1250 - 18s - loss: 2.3401 - accuracy30: 0.5648 - val_loss: 2.8906 - val_accuracy30: 0.6957 - 18s/epoch - 15ms/step
Epoch 23/50
1250/1250 - 18s - loss: 2.3278 - accuracy30: 0.5672 - val_loss: 2.9708 - val_accuracy30: 0.6850 - 18s/epoch - 14ms/step
testing model: results/EXC/W9/deepOF_L1/h30
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.71857923
{'0': {'precision': 0.4071185281790901, 'recall': 0.41872973289749565, 'f1-score': 0.41284250532857397, 'support': 76787}, '1': {'precision': 0.8178640682674085, 'recall': 0.8249784087048997, 'f1-score': 0.8214058341365071, 'support': 450413}, '2': {'precision': 0.4163602142753728, 'recall': 0.38253212375961054, 'f1-score': 0.39872996506017416, 'support': 75178}, 'accuracy': 0.7179744280169594, 'macro avg': {'precision': 0.5471142702406239, 'recall': 0.5420800884540019, 'f1-score': 0.5443261015084184, 'support': 602378}, 'weighted avg': {'precision': 0.7153965569669045, 'recall': 0.7179744280169594, 'f1-score': 0.716574185546095, 'support': 602378}}
[[ 32153  41607   3027]
 [ 41547 371581  37285]
 [  5277  41143  28758]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.70987785
{'0': {'precision': 0.3824601882944315, 'recall': 0.47575726513248934, 'f1-score': 0.42403755010678024, 'support': 39022}, '1': {'precision': 0.8320929539437928, 'recall': 0.7890827625191195, 'f1-score': 0.810017322740577, 'support': 240592}, '2': {'precision': 0.43072045175773566, 'recall': 0.4619031073165889, 'f1-score': 0.44576711656147827, 'support': 40292}, 'accuracy': 0.7096553362550249, 'macro avg': {'precision': 0.5484245313319867, 'recall': 0.5755810449893992, 'f1-score': 0.5599406631362785, 'support': 319906}, 'weighted avg': {'precision': 0.7266942723334135, 'recall': 0.7096553362550249, 'f1-score': 0.7170585411138358, 'support': 319906}}
[[ 18565  18478   1979]
 [ 28126 189847  22619]
 [  1850  19831  18611]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.72900355
{'0': {'precision': 0.34585537047105924, 'recall': 0.4466930541368744, 'f1-score': 0.38985931188187767, 'support': 15664}, '1': {'precision': 0.8211208079477469, 'recall': 0.7861271676300579, 'f1-score': 0.8032430400816128, 'support': 95150}, '2': {'precision': 0.42241548420846137, 'recall': 0.408731414109459, 'f1-score': 0.4154608013377066, 'support': 15805}, 'accuracy': 0.6970280921504671, 'macro avg': {'precision': 0.5297972208757559, 'recall': 0.5471838786254638, 'f1-score': 0.5361877177670656, 'support': 126619}, 'weighted avg': {'precision': 0.7125581478861903, 'recall': 0.6970280921504671, 'f1-score': 0.7036992038337504, 'support': 126619}}
[[ 6997  7723   944]
 [12461 74800  7889]
 [  773  8572  6460]]
training model: results/EXC/W9/deepOF_L1/h50
Epoch 1/50
1250/1250 - 20s - loss: 2.9267 - accuracy50: 0.4447 - val_loss: 3.1167 - val_accuracy50: 0.6412 - 20s/epoch - 16ms/step
Epoch 2/50
1250/1250 - 19s - loss: 2.7902 - accuracy50: 0.4711 - val_loss: 3.0602 - val_accuracy50: 0.6552 - 19s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 18s - loss: 2.7269 - accuracy50: 0.4855 - val_loss: 3.0216 - val_accuracy50: 0.6552 - 18s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 2.6923 - accuracy50: 0.4940 - val_loss: 3.0191 - val_accuracy50: 0.6530 - 18s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 18s - loss: 2.6687 - accuracy50: 0.5002 - val_loss: 3.0325 - val_accuracy50: 0.6568 - 18s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 18s - loss: 2.6462 - accuracy50: 0.5074 - val_loss: 2.9801 - val_accuracy50: 0.6513 - 18s/epoch - 15ms/step
Epoch 7/50
1250/1250 - 18s - loss: 2.6319 - accuracy50: 0.5129 - val_loss: 2.9648 - val_accuracy50: 0.6553 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 18s - loss: 2.6152 - accuracy50: 0.5174 - val_loss: 2.9440 - val_accuracy50: 0.6521 - 18s/epoch - 14ms/step
Epoch 9/50
1250/1250 - 18s - loss: 2.6021 - accuracy50: 0.5208 - val_loss: 2.9628 - val_accuracy50: 0.6565 - 18s/epoch - 15ms/step
Epoch 10/50
1250/1250 - 19s - loss: 2.5920 - accuracy50: 0.5240 - val_loss: 3.0017 - val_accuracy50: 0.6539 - 19s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 2.5790 - accuracy50: 0.5279 - val_loss: 2.9959 - val_accuracy50: 0.6545 - 18s/epoch - 15ms/step
Epoch 12/50
1250/1250 - 18s - loss: 2.5670 - accuracy50: 0.5296 - val_loss: 2.9755 - val_accuracy50: 0.6526 - 18s/epoch - 14ms/step
Epoch 13/50
1250/1250 - 18s - loss: 2.5594 - accuracy50: 0.5330 - val_loss: 3.0136 - val_accuracy50: 0.6583 - 18s/epoch - 14ms/step
Epoch 14/50
1250/1250 - 18s - loss: 2.5480 - accuracy50: 0.5356 - val_loss: 3.0086 - val_accuracy50: 0.6534 - 18s/epoch - 14ms/step
Epoch 15/50
1250/1250 - 18s - loss: 2.5371 - accuracy50: 0.5368 - val_loss: 3.0148 - val_accuracy50: 0.6577 - 18s/epoch - 14ms/step
Epoch 16/50
1250/1250 - 18s - loss: 2.5282 - accuracy50: 0.5374 - val_loss: 2.9918 - val_accuracy50: 0.6522 - 18s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 19s - loss: 2.5196 - accuracy50: 0.5398 - val_loss: 3.0129 - val_accuracy50: 0.6507 - 19s/epoch - 15ms/step
Epoch 18/50
1250/1250 - 19s - loss: 2.5091 - accuracy50: 0.5410 - val_loss: 3.0397 - val_accuracy50: 0.6572 - 19s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h50
Evaluating performance on  test set...
2354/2354 - 12s - 12s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8057478
{'0': {'precision': 0.45939348287021536, 'recall': 0.3274211347842081, 'f1-score': 0.38233945353541804, 'support': 100583}, '1': {'precision': 0.7254949113239146, 'recall': 0.8373549958738411, 'f1-score': 0.7774217929441377, 'support': 403523}, '2': {'precision': 0.46715935334872977, 'recall': 0.3087552914360143, 'f1-score': 0.37178811679798063, 'support': 98272}, 'accuracy': 0.665972196859779, 'macro avg': {'precision': 0.5506825825142866, 'recall': 0.49117714069802115, 'f1-score': 0.5105164544258455, 'support': 602378}, 'weighted avg': {'precision': 0.6389173272629167, 'recall': 0.665972196859779, 'f1-score': 0.6452771934285804, 'support': 602378}}
[[ 32933  64816   2834]
 [ 33857 337892  31774]
 [  4898  63032  30342]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.79270965
{'0': {'precision': 0.44323313120887625, 'recall': 0.3970452269050004, 'f1-score': 0.41886976488996364, 'support': 51916}, '1': {'precision': 0.7387011440186081, 'recall': 0.7990151002403902, 'f1-score': 0.7676752727810889, 'support': 214235}, '2': {'precision': 0.4939649173325654, 'recall': 0.3829411217561157, 'f1-score': 0.43142473907029383, 'support': 53755}, 'accuracy': 0.6638668858977325, 'macro avg': {'precision': 0.5586330641866833, 'recall': 0.5263338163005021, 'f1-score': 0.5393232589137822, 'support': 319906}, 'weighted avg': {'precision': 0.6496271247175064, 'recall': 0.6638668858977325, 'f1-score': 0.6545678781486048, 'support': 319906}}
[[ 20613  29316   1987]
 [ 23957 171177  19101]
 [  1936  31234  20585]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.807892
{'0': {'precision': 0.3976073187895848, 'recall': 0.38574075880230174, 'f1-score': 0.39158415841584154, 'support': 20506}, '1': {'precision': 0.7323555180582146, 'recall': 0.7924786684925734, 'f1-score': 0.7612317862924987, 'support': 85437}, '2': {'precision': 0.4854280510018215, 'recall': 0.3351228477461791, 'f1-score': 0.3965092989985694, 'support': 20676}, 'accuracy': 0.6519242767673098, 'macro avg': {'precision': 0.538463629283207, 'recall': 0.5044474250136848, 'f1-score': 0.5164417479023032, 'support': 126619}, 'weighted avg': {'precision': 0.6378213732374491, 'recall': 0.6519242767673098, 'f1-score': 0.6418105587948245, 'support': 126619}}
[[ 7910 11764   832]
 [11217 67707  6513]
 [  767 12980  6929]]
training model: results/EXC/W9/deepOF_L1/h100
Epoch 1/50
1250/1250 - 21s - loss: 3.1004 - accuracy100: 0.4373 - val_loss: 3.2087 - val_accuracy100: 0.5296 - 21s/epoch - 17ms/step
Epoch 2/50
1250/1250 - 18s - loss: 3.0147 - accuracy100: 0.4640 - val_loss: 3.1434 - val_accuracy100: 0.5396 - 18s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 19s - loss: 2.9694 - accuracy100: 0.4731 - val_loss: 3.1365 - val_accuracy100: 0.5403 - 19s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 2.9421 - accuracy100: 0.4786 - val_loss: 3.1364 - val_accuracy100: 0.5407 - 18s/epoch - 14ms/step
Epoch 5/50
1250/1250 - 18s - loss: 2.9203 - accuracy100: 0.4849 - val_loss: 3.1604 - val_accuracy100: 0.5410 - 18s/epoch - 14ms/step
Epoch 6/50
1250/1250 - 18s - loss: 2.9037 - accuracy100: 0.4877 - val_loss: 3.1520 - val_accuracy100: 0.5436 - 18s/epoch - 14ms/step
Epoch 7/50
1250/1250 - 18s - loss: 2.8901 - accuracy100: 0.4924 - val_loss: 3.1315 - val_accuracy100: 0.5446 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 18s - loss: 2.8792 - accuracy100: 0.4970 - val_loss: 3.1302 - val_accuracy100: 0.5436 - 18s/epoch - 14ms/step
Epoch 9/50
1250/1250 - 19s - loss: 2.8701 - accuracy100: 0.4969 - val_loss: 3.1406 - val_accuracy100: 0.5440 - 19s/epoch - 15ms/step
Epoch 10/50
1250/1250 - 18s - loss: 2.8601 - accuracy100: 0.5000 - val_loss: 3.1593 - val_accuracy100: 0.5446 - 18s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 2.8517 - accuracy100: 0.5025 - val_loss: 3.1886 - val_accuracy100: 0.5427 - 18s/epoch - 14ms/step
Epoch 12/50
1250/1250 - 18s - loss: 2.8429 - accuracy100: 0.5045 - val_loss: 3.1910 - val_accuracy100: 0.5449 - 18s/epoch - 15ms/step
Epoch 13/50
1250/1250 - 18s - loss: 2.8372 - accuracy100: 0.5069 - val_loss: 3.1792 - val_accuracy100: 0.5422 - 18s/epoch - 14ms/step
Epoch 14/50
1250/1250 - 18s - loss: 2.8258 - accuracy100: 0.5097 - val_loss: 3.1952 - val_accuracy100: 0.5444 - 18s/epoch - 14ms/step
Epoch 15/50
1250/1250 - 18s - loss: 2.8192 - accuracy100: 0.5109 - val_loss: 3.2134 - val_accuracy100: 0.5453 - 18s/epoch - 14ms/step
Epoch 16/50
1250/1250 - 18s - loss: 2.8096 - accuracy100: 0.5127 - val_loss: 3.2458 - val_accuracy100: 0.5463 - 18s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 18s - loss: 2.8006 - accuracy100: 0.5152 - val_loss: 3.2420 - val_accuracy100: 0.5444 - 18s/epoch - 14ms/step
Epoch 18/50
1250/1250 - 18s - loss: 2.7906 - accuracy100: 0.5168 - val_loss: 3.2706 - val_accuracy100: 0.5468 - 18s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h100
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96806115
{'0': {'precision': 0.5217703140033237, 'recall': 0.20460282617643025, 'f1-score': 0.2939417083446254, 'support': 145780}, '1': {'precision': 0.5450905400096911, 'recall': 0.8735631449270268, 'f1-score': 0.6712998548649705, 'support': 312923}, '2': {'precision': 0.5264626503819587, 'recall': 0.16020880459370107, 'f1-score': 0.24566028271530493, 'support': 143675}, 'accuracy': 0.5415254209151065, 'macro avg': {'precision': 0.5311078347983246, 'recall': 0.41279159189905273, 'f1-score': 0.4036339486416336, 'support': 602378}, 'weighted avg': {'precision': 0.5350038758395642, 'recall': 0.5415254209151065, 'f1-score': 0.47845576672041823, 'support': 602378}}
[[ 29827 113730   2223]
 [ 21084 273358  18481]
 [  6254 114403  23018]]
Evaluating performance on  train set...
1250/1250 - 8s - 8s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9498155
{'0': {'precision': 0.5302822621585948, 'recall': 0.2705387205387205, 'f1-score': 0.35828702750908964, 'support': 77220}, '1': {'precision': 0.5489881221354335, 'recall': 0.8340995745828582, 'f1-score': 0.6621572301029222, 'support': 163134}, '2': {'precision': 0.5653518711337049, 'recall': 0.23206204746580852, 'f1-score': 0.3290554872288469, 'support': 79552}, 'accuracy': 0.5483548292310866, 'macro avg': {'precision': 0.548207418475911, 'recall': 0.44556678086246243, 'f1-score': 0.44983324828028626, 'support': 319906}, 'weighted avg': {'precision': 0.5485420612703638, 'recall': 0.5483548292310866, 'f1-score': 0.5059745799075079, 'support': 319906}}
[[ 20891  54010   2319]
 [ 15190 136070  11874]
 [  3315  57776  18461]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95578086
{'0': {'precision': 0.4823635272945411, 'recall': 0.2667883211678832, 'f1-score': 0.3435590685750908, 'support': 30140}, '1': {'precision': 0.553514473737333, 'recall': 0.8257046494820525, 'f1-score': 0.6627510695381047, 'support': 66416}, '2': {'precision': 0.5451117446886784, 'recall': 0.19715264610983602, 'f1-score': 0.28957396912253275, 'support': 30063}, 'accuracy': 0.543425552247293, 'macro avg': {'precision': 0.5269965819068508, 'recall': 0.4298818722532572, 'f1-score': 0.43196136907857613, 'support': 126619}, 'weighted avg': {'precision': 0.5345828697191725, 'recall': 0.543425552247293, 'f1-score': 0.49816858129527714, 'support': 126619}}
[[ 8041 21306   793]
 [ 7423 54840  4153]
 [ 1206 22930  5927]]
training model: results/EXC/W9/deepOF_L1/h200
Epoch 1/50
1250/1250 - 20s - loss: 3.2373 - accuracy200: 0.4087 - val_loss: 3.2822 - val_accuracy200: 0.3953 - 20s/epoch - 16ms/step
Epoch 2/50
1250/1250 - 18s - loss: 3.1937 - accuracy200: 0.4266 - val_loss: 3.2402 - val_accuracy200: 0.4106 - 18s/epoch - 14ms/step
Epoch 3/50
1250/1250 - 18s - loss: 3.1735 - accuracy200: 0.4329 - val_loss: 3.2263 - val_accuracy200: 0.4129 - 18s/epoch - 14ms/step
Epoch 4/50
1250/1250 - 18s - loss: 3.1601 - accuracy200: 0.4384 - val_loss: 3.2273 - val_accuracy200: 0.4138 - 18s/epoch - 14ms/step
Epoch 5/50
1250/1250 - 18s - loss: 3.1483 - accuracy200: 0.4434 - val_loss: 3.2300 - val_accuracy200: 0.4119 - 18s/epoch - 14ms/step
Epoch 6/50
1250/1250 - 19s - loss: 3.1386 - accuracy200: 0.4468 - val_loss: 3.2387 - val_accuracy200: 0.4132 - 19s/epoch - 15ms/step
Epoch 7/50
1250/1250 - 18s - loss: 3.1294 - accuracy200: 0.4502 - val_loss: 3.2445 - val_accuracy200: 0.4148 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 18s - loss: 3.1208 - accuracy200: 0.4538 - val_loss: 3.2647 - val_accuracy200: 0.4131 - 18s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 18s - loss: 3.1129 - accuracy200: 0.4567 - val_loss: 3.2588 - val_accuracy200: 0.4135 - 18s/epoch - 14ms/step
Epoch 10/50
1250/1250 - 18s - loss: 3.1060 - accuracy200: 0.4591 - val_loss: 3.2759 - val_accuracy200: 0.4138 - 18s/epoch - 14ms/step
Epoch 11/50
1250/1250 - 18s - loss: 3.0996 - accuracy200: 0.4619 - val_loss: 3.2829 - val_accuracy200: 0.4129 - 18s/epoch - 14ms/step
Epoch 12/50
1250/1250 - 18s - loss: 3.0933 - accuracy200: 0.4628 - val_loss: 3.3137 - val_accuracy200: 0.4113 - 18s/epoch - 14ms/step
Epoch 13/50
1250/1250 - 18s - loss: 3.0878 - accuracy200: 0.4651 - val_loss: 3.3091 - val_accuracy200: 0.4118 - 18s/epoch - 14ms/step
testing model: results/EXC/W9/deepOF_L1/h200
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0788021
{'0': {'precision': 0.47558739255014326, 'recall': 0.13125444816406148, 'f1-score': 0.20573057615634102, 'support': 189685}, '1': {'precision': 0.3861268796728174, 'recall': 0.8555228185111667, 'f1-score': 0.5320991208450517, 'support': 224686}, '2': {'precision': 0.5200950155166468, 'recall': 0.1444095166669326, 'f1-score': 0.2260531453858931, 'support': 188007}, 'accuracy': 0.4055111574459891, 'macro avg': {'precision': 0.46060309591320253, 'recall': 0.37706226111405367, 'f1-score': 0.32129428079576194, 'support': 602378}, 'weighted avg': {'precision': 0.4561099545871177, 'recall': 0.4055111574459891, 'f1-score': 0.3338083414549875, 'support': 602378}}
[[ 24897 156306   8482]
 [ 15892 192224  16570]
 [ 11561 149296  27150]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0720701
{'0': {'precision': 0.4981917265296012, 'recall': 0.19752310427122108, 'f1-score': 0.2828871025592337, 'support': 101821}, '1': {'precision': 0.375733749349974, 'recall': 0.7899676375404531, 'f1-score': 0.5092513497131419, 'support': 114330}, '2': {'precision': 0.5342560200199178, 'recall': 0.20164811334393523, 'f1-score': 0.29278737160289964, 'support': 103755}, 'accuracy': 0.41059248654292196, 'macro avg': {'precision': 0.46939383196649764, 'recall': 0.39637961838520314, 'f1-score': 0.3616419412917584, 'support': 319906}, 'weighted avg': {'precision': 0.46612365103286474, 'recall': 0.41059248654292196, 'f1-score': 0.3669975187181425, 'support': 319906}}
[[20112 74935  6774]
 [12548 90317 11465]
 [ 7710 75123 20922]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0695843
{'0': {'precision': 0.4840716631142347, 'recall': 0.2094623227060847, 'f1-score': 0.2924003062147679, 'support': 40117}, '1': {'precision': 0.3848220000209844, 'recall': 0.7801791070175066, 'f1-score': 0.515415964024733, 'support': 47011}, '2': {'precision': 0.5170238692566841, 'recall': 0.18264921121268138, 'f1-score': 0.26993750233898434, 'support': 39491}, 'accuracy': 0.4129948901823581, 'macro avg': {'precision': 0.461972510797301, 'recall': 0.39076354697875754, 'f1-score': 0.3592512575261617, 'support': 126619}, 'weighted avg': {'precision': 0.4574997399517921, 'recall': 0.4129948901823581, 'f1-score': 0.3681954909930848, 'support': 126619}}
[[ 8403 29295  2419]
 [ 6015 36677  4319]
 [ 2941 29337  7213]]
training model: results/EXC/W9/deepOF_L1/h300
Epoch 1/50
1250/1250 - 22s - loss: 3.2748 - accuracy300: 0.3879 - val_loss: 3.2807 - val_accuracy300: 0.3717 - 22s/epoch - 17ms/step
Epoch 2/50
1250/1250 - 19s - loss: 3.2424 - accuracy300: 0.4067 - val_loss: 3.2555 - val_accuracy300: 0.3855 - 19s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 19s - loss: 3.2285 - accuracy300: 0.4126 - val_loss: 3.2512 - val_accuracy300: 0.3874 - 19s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 19s - loss: 3.2203 - accuracy300: 0.4155 - val_loss: 3.2477 - val_accuracy300: 0.3896 - 19s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 19s - loss: 3.2141 - accuracy300: 0.4176 - val_loss: 3.2497 - val_accuracy300: 0.3870 - 19s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 19s - loss: 3.2082 - accuracy300: 0.4206 - val_loss: 3.2478 - val_accuracy300: 0.3860 - 19s/epoch - 15ms/step
Epoch 7/50
1250/1250 - 19s - loss: 3.2034 - accuracy300: 0.4230 - val_loss: 3.2506 - val_accuracy300: 0.3873 - 19s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 18s - loss: 3.1987 - accuracy300: 0.4241 - val_loss: 3.2536 - val_accuracy300: 0.3847 - 18s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 18s - loss: 3.1922 - accuracy300: 0.4271 - val_loss: 3.2593 - val_accuracy300: 0.3834 - 18s/epoch - 14ms/step
Epoch 10/50
1250/1250 - 18s - loss: 3.1877 - accuracy300: 0.4292 - val_loss: 3.2636 - val_accuracy300: 0.3849 - 18s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 18s - loss: 3.1826 - accuracy300: 0.4314 - val_loss: 3.2717 - val_accuracy300: 0.3827 - 18s/epoch - 15ms/step
Epoch 12/50
1250/1250 - 19s - loss: 3.1787 - accuracy300: 0.4333 - val_loss: 3.2766 - val_accuracy300: 0.3836 - 19s/epoch - 15ms/step
Epoch 13/50
1250/1250 - 18s - loss: 3.1741 - accuracy300: 0.4347 - val_loss: 3.2815 - val_accuracy300: 0.3824 - 18s/epoch - 15ms/step
Epoch 14/50
1250/1250 - 19s - loss: 3.1699 - accuracy300: 0.4361 - val_loss: 3.2898 - val_accuracy300: 0.3835 - 19s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h300
Evaluating performance on  test set...
2354/2354 - 13s - 13s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0864229
{'0': {'precision': 0.44767214691473056, 'recall': 0.15133841706589715, 'f1-score': 0.2262063414319289, 'support': 196837}, '1': {'precision': 0.36320552357379177, 'recall': 0.7707626310772164, 'f1-score': 0.4937444562676807, 'support': 209800}, '2': {'precision': 0.4720195989714954, 'recall': 0.2185183482254612, 'f1-score': 0.2987379434134894, 'support': 195741}, 'accuracy': 0.3889053053066347, 'macro avg': {'precision': 0.42763242315333927, 'recall': 0.3802064654561916, 'f1-score': 0.3395629137043663, 'support': 602378}, 'weighted avg': {'precision': 0.4261652144505872, 'recall': 0.3889053053066347, 'f1-score': 0.34295513503995134, 'support': 602378}}
[[ 29789 146917  20131]
 [ 20381 161706  27713]
 [ 16372 136596  42773]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.084209
{'0': {'precision': 0.46966115051221435, 'recall': 0.21280714117923422, 'f1-score': 0.29289931262811436, 'support': 106425}, '1': {'precision': 0.3462683328380106, 'recall': 0.6986303977462001, 'f1-score': 0.4630373758082321, 'support': 105067}, '2': {'precision': 0.4838947421316226, 'recall': 0.2664692751858616, 'f1-score': 0.343681408559617, 'support': 108414}, 'accuracy': 0.3905522247160103, 'macro avg': {'precision': 0.4332747418272825, 'recall': 0.3926356047037653, 'f1-score': 0.36653936566532114, 'support': 319906}, 'weighted avg': {'precision': 0.433958811160189, 'recall': 0.3905522247160103, 'f1-score': 0.36598761366799276, 'support': 319906}}
[[22648 70258 13519]
 [14371 73403 17293]
 [11203 68322 28889]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0837653
{'0': {'precision': 0.46258503401360546, 'recall': 0.2260511283828074, 'f1-score': 0.30369554961471934, 'support': 42716}, '1': {'precision': 0.3482766442616492, 'recall': 0.6857545839210155, 'f1-score': 0.4619440859533971, 'support': 42540}, '2': {'precision': 0.46929585152838427, 'recall': 0.24942581534221406, 'f1-score': 0.32572971095710923, 'support': 41363}, 'accuracy': 0.3881329026449427, 'macro avg': {'precision': 0.426719176601213, 'recall': 0.38707717588201235, 'f1-score': 0.36378978217507524, 'support': 126619}, 'weighted avg': {'precision': 0.4263732541449884, 'recall': 0.3881329026449427, 'f1-score': 0.36406004271174763, 'support': 126619}}
[[ 9656 27930  5130]
 [ 6831 29172  6537]
 [ 4387 26659 10317]]
training model: results/EXC/W9/deepOF_L1/h500
Epoch 1/50
1250/1250 - 21s - loss: 3.3004 - accuracy500: 0.3658 - val_loss: 3.2846 - val_accuracy500: 0.3640 - 21s/epoch - 16ms/step
Epoch 2/50
1250/1250 - 19s - loss: 3.2767 - accuracy500: 0.3760 - val_loss: 3.2739 - val_accuracy500: 0.3718 - 19s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 18s - loss: 3.2672 - accuracy500: 0.3813 - val_loss: 3.2704 - val_accuracy500: 0.3734 - 18s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 3.2611 - accuracy500: 0.3846 - val_loss: 3.2679 - val_accuracy500: 0.3768 - 18s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 18s - loss: 3.2574 - accuracy500: 0.3872 - val_loss: 3.2659 - val_accuracy500: 0.3770 - 18s/epoch - 15ms/step
Epoch 6/50
1250/1250 - 18s - loss: 3.2538 - accuracy500: 0.3894 - val_loss: 3.2654 - val_accuracy500: 0.3778 - 18s/epoch - 14ms/step
Epoch 7/50
1250/1250 - 18s - loss: 3.2515 - accuracy500: 0.3903 - val_loss: 3.2649 - val_accuracy500: 0.3788 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 19s - loss: 3.2490 - accuracy500: 0.3915 - val_loss: 3.2651 - val_accuracy500: 0.3791 - 19s/epoch - 16ms/step
Epoch 9/50
1250/1250 - 18s - loss: 3.2458 - accuracy500: 0.3941 - val_loss: 3.2672 - val_accuracy500: 0.3785 - 18s/epoch - 15ms/step
Epoch 10/50
1250/1250 - 18s - loss: 3.2426 - accuracy500: 0.3964 - val_loss: 3.2686 - val_accuracy500: 0.3805 - 18s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 19s - loss: 3.2409 - accuracy500: 0.3979 - val_loss: 3.2697 - val_accuracy500: 0.3784 - 19s/epoch - 15ms/step
Epoch 12/50
1250/1250 - 18s - loss: 3.2380 - accuracy500: 0.3986 - val_loss: 3.2687 - val_accuracy500: 0.3791 - 18s/epoch - 15ms/step
Epoch 13/50
1250/1250 - 19s - loss: 3.2362 - accuracy500: 0.4007 - val_loss: 3.2689 - val_accuracy500: 0.3790 - 19s/epoch - 15ms/step
Epoch 14/50
1250/1250 - 19s - loss: 3.2336 - accuracy500: 0.4026 - val_loss: 3.2723 - val_accuracy500: 0.3796 - 19s/epoch - 15ms/step
Epoch 15/50
1250/1250 - 18s - loss: 3.2314 - accuracy500: 0.4035 - val_loss: 3.2742 - val_accuracy500: 0.3793 - 18s/epoch - 14ms/step
Epoch 16/50
1250/1250 - 19s - loss: 3.2290 - accuracy500: 0.4047 - val_loss: 3.2753 - val_accuracy500: 0.3804 - 19s/epoch - 15ms/step
Epoch 17/50
1250/1250 - 19s - loss: 3.2265 - accuracy500: 0.4057 - val_loss: 3.2750 - val_accuracy500: 0.3809 - 19s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h500
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0914358
{'0': {'precision': 0.3581202127027048, 'recall': 0.7066264722234974, 'f1-score': 0.4753378923205199, 'support': 196047}, '1': {'precision': 0.34340593973740563, 'recall': 0.15220819811225786, 'f1-score': 0.21092699064340306, 'support': 208609}, '2': {'precision': 0.41104927489133525, 'recall': 0.2558845247367516, 'f1-score': 0.3154170576078452, 'support': 197722}, 'accuracy': 0.3666767378622725, 'macro avg': {'precision': 0.37085847577714853, 'recall': 0.3715730650241689, 'f1-score': 0.33389398019058936, 'support': 602378}, 'weighted avg': {'precision': 0.3703977365582279, 'recall': 0.3666767378622725, 'f1-score': 0.3312782469333691, 'support': 602378}}
[[138532  28452  29063]
 [133429  31752  43428]
 [114870  32258  50594]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0896326
{'0': {'precision': 0.3715284746944424, 'recall': 0.6661237168074549, 'f1-score': 0.47700747994384957, 'support': 105596}, '1': {'precision': 0.3325135637449077, 'recall': 0.1678464818763326, 'f1-score': 0.22308428636203334, 'support': 105525}, '2': {'precision': 0.42651300557474164, 'recall': 0.30312083467389805, 'f1-score': 0.35438317445646916, 'support': 108785}, 'accuracy': 0.3783205066488281, 'macro avg': {'precision': 0.37685168133803054, 'recall': 0.37903034445256184, 'f1-score': 0.351491646920784, 'support': 319906}, 'weighted avg': {'precision': 0.37735657330423306, 'recall': 0.3783205066488281, 'f1-score': 0.3515489700216667, 'support': 319906}}
[[70340 16349 18907]
 [62382 17712 25431]
 [56604 19206 32975]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0889107
{'0': {'precision': 0.37883625128733267, 'recall': 0.6877629241843507, 'f1-score': 0.4885612776837002, 'support': 42788}, '1': {'precision': 0.34485208301618714, 'recall': 0.15883329048542782, 'f1-score': 0.21749287931641442, 'support': 42787}, '2': {'precision': 0.40212780514504654, 'recall': 0.2863999610174447, 'f1-score': 0.3345381068928226, 'support': 41044}, 'accuracy': 0.37892417409709445, 'macro avg': {'precision': 0.37527204648285545, 'recall': 0.3776653918957411, 'f1-score': 0.3468640879643124, 'support': 126619}, 'weighted avg': {'precision': 0.3749023861384885, 'recall': 0.37892417409709445, 'f1-score': 0.3470348828860645, 'support': 126619}}
[[29428  6059  7301]
 [25815  6796 10176]
 [22437  6852 11755]]
training model: results/EXC/W9/deepOF_L1/h1000
Epoch 1/50
1250/1250 - 20s - loss: 3.2740 - accuracy1000: 0.3989 - val_loss: 3.3714 - val_accuracy1000: 0.3259 - 20s/epoch - 16ms/step
Epoch 2/50
1250/1250 - 18s - loss: 3.2606 - accuracy1000: 0.3986 - val_loss: 3.3864 - val_accuracy1000: 0.3293 - 18s/epoch - 15ms/step
Epoch 3/50
1250/1250 - 18s - loss: 3.2744 - accuracy1000: 0.3819 - val_loss: 3.3915 - val_accuracy1000: 0.3307 - 18s/epoch - 15ms/step
Epoch 4/50
1250/1250 - 18s - loss: 3.2781 - accuracy1000: 0.3782 - val_loss: 3.3870 - val_accuracy1000: 0.3328 - 18s/epoch - 15ms/step
Epoch 5/50
1250/1250 - 18s - loss: 3.2773 - accuracy1000: 0.3795 - val_loss: 3.3871 - val_accuracy1000: 0.3339 - 18s/epoch - 14ms/step
Epoch 6/50
1250/1250 - 18s - loss: 3.2757 - accuracy1000: 0.3802 - val_loss: 3.3906 - val_accuracy1000: 0.3340 - 18s/epoch - 15ms/step
Epoch 7/50
1250/1250 - 18s - loss: 3.2737 - accuracy1000: 0.3819 - val_loss: 3.3867 - val_accuracy1000: 0.3344 - 18s/epoch - 15ms/step
Epoch 8/50
1250/1250 - 19s - loss: 3.2722 - accuracy1000: 0.3833 - val_loss: 3.3887 - val_accuracy1000: 0.3351 - 19s/epoch - 15ms/step
Epoch 9/50
1250/1250 - 18s - loss: 3.2707 - accuracy1000: 0.3839 - val_loss: 3.3882 - val_accuracy1000: 0.3356 - 18s/epoch - 14ms/step
Epoch 10/50
1250/1250 - 19s - loss: 3.2698 - accuracy1000: 0.3848 - val_loss: 3.3877 - val_accuracy1000: 0.3352 - 19s/epoch - 15ms/step
Epoch 11/50
1250/1250 - 19s - loss: 3.2681 - accuracy1000: 0.3856 - val_loss: 3.3869 - val_accuracy1000: 0.3361 - 19s/epoch - 15ms/step
testing model: results/EXC/W9/deepOF_L1/h1000
Evaluating performance on  test set...
2354/2354 - 14s - 14s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1582749
{'0': {'precision': 0.2445224817009411, 'recall': 0.9665013432527382, 'f1-score': 0.3903000125179075, 'support': 145170}, '1': {'precision': 0.5511618426416632, 'recall': 0.004329891624606083, 'f1-score': 0.008592282833546764, 'support': 312248}, '2': {'precision': 0.2837511961722488, 'recall': 0.05113824503311258, 'f1-score': 0.0866586784346962, 'support': 144960}, 'accuracy': 0.24747251725660632, 'macro avg': {'precision': 0.3598118401716177, 'recall': 0.34065649330348563, 'f1-score': 0.16185032459538348, 'support': 602378}, 'weighted avg': {'precision': 0.4129119674138645, 'recall': 0.24747251725660632, 'f1-score': 0.1193682670571095, 'support': 602378}}
[[140307    422   4441]
 [296625   1352  14271]
 [136868    679   7413]]
Evaluating performance on  train set...
1250/1250 - 7s - 7s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1097009
{'0': {'precision': 0.33950547098638273, 'recall': 0.9479271708683473, 'f1-score': 0.4999507549269695, 'support': 107100}, '1': {'precision': 0.35359116022099446, 'recall': 0.006733749091326472, 'f1-score': 0.01321581768178789, 'support': 104548}, '2': {'precision': 0.38939787110099033, 'recall': 0.06792107742614864, 'f1-score': 0.11566685805523003, 'support': 108258}, 'accuracy': 0.34253812057291827, 'macro avg': {'precision': 0.3608315007694558, 'recall': 0.3408606657952742, 'f1-score': 0.20961114355466248, 'support': 319906}, 'weighted avg': {'precision': 0.36099266437977756, 'recall': 0.34253812057291827, 'f1-score': 0.21083779572442246, 'support': 319906}}
[[101523    581   4996]
 [ 97310    704   6534]
 [100199    706   7353]]
Evaluating performance on  val set...
495/495 - 3s - 3s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204083
{'0': {'precision': 0.32499012762668145, 'recall': 0.9544961010759057, 'f1-score': 0.4848849526459951, 'support': 40524}, '1': {'precision': 0.44780635400907715, 'recall': 0.006061474822353736, 'f1-score': 0.011961045783327271, 'support': 48833}, '2': {'precision': 0.34284479031560744, 'recall': 0.06384520422950996, 'f1-score': 0.1076446234248094, 'support': 37262}, 'accuracy': 0.32660975051137664, 'macro avg': {'precision': 0.3718804239837887, 'recall': 0.3414675933759231, 'f1-score': 0.20149687395137728, 'support': 126619}, 'weighted avg': {'precision': 0.37761086562055507, 'recall': 0.32660975051137664, 'f1-score': 0.19147699419375272, 'support': 126619}}
[[38680   168  1676]
 [45653   296  2884]
 [34686   197  2379]]
training model: results/EXC/W9/deepLOB_L2/h10
Epoch 1/50
1250/1250 - 55s - loss: 2.5750 - accuracy10: 0.4604 - val_loss: 3.3057 - val_accuracy10: 0.7465 - 55s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 53s - loss: 2.2490 - accuracy10: 0.5849 - val_loss: 2.7566 - val_accuracy10: 0.7275 - 53s/epoch - 42ms/step
Epoch 3/50
1250/1250 - 52s - loss: 2.0886 - accuracy10: 0.6462 - val_loss: 2.5626 - val_accuracy10: 0.6946 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 52s - loss: 1.9825 - accuracy10: 0.6831 - val_loss: 2.4531 - val_accuracy10: 0.7357 - 52s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 52s - loss: 1.9278 - accuracy10: 0.6952 - val_loss: 2.2947 - val_accuracy10: 0.7515 - 52s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 53s - loss: 1.8921 - accuracy10: 0.6990 - val_loss: 2.3403 - val_accuracy10: 0.7007 - 53s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 52s - loss: 1.8656 - accuracy10: 0.7020 - val_loss: 2.3968 - val_accuracy10: 0.7396 - 52s/epoch - 42ms/step
Epoch 8/50
1250/1250 - 52s - loss: 1.8445 - accuracy10: 0.7011 - val_loss: 2.4554 - val_accuracy10: 0.7504 - 52s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 53s - loss: 1.8299 - accuracy10: 0.7012 - val_loss: 2.4000 - val_accuracy10: 0.7419 - 53s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 53s - loss: 1.8127 - accuracy10: 0.7013 - val_loss: 2.4558 - val_accuracy10: 0.7456 - 53s/epoch - 42ms/step
Epoch 11/50
1250/1250 - 52s - loss: 1.8001 - accuracy10: 0.7011 - val_loss: 2.5604 - val_accuracy10: 0.6988 - 52s/epoch - 42ms/step
Epoch 12/50
1250/1250 - 52s - loss: 1.7890 - accuracy10: 0.7007 - val_loss: 2.5496 - val_accuracy10: 0.7197 - 52s/epoch - 42ms/step
Epoch 13/50
1250/1250 - 52s - loss: 1.7770 - accuracy10: 0.7008 - val_loss: 2.6169 - val_accuracy10: 0.7640 - 52s/epoch - 42ms/step
Epoch 14/50
1250/1250 - 52s - loss: 1.7629 - accuracy10: 0.7014 - val_loss: 2.7807 - val_accuracy10: 0.7090 - 52s/epoch - 42ms/step
Epoch 15/50
1250/1250 - 53s - loss: 1.7552 - accuracy10: 0.6996 - val_loss: 2.5923 - val_accuracy10: 0.7378 - 53s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h10
Evaluating performance on  test set...
2354/2354 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57592654
{'0': {'precision': 0.36184437157912197, 'recall': 0.6234419995163879, 'f1-score': 0.4579155566319529, 'support': 45491}, '1': {'precision': 0.9482241270898062, 'recall': 0.7996331090788933, 'f1-score': 0.8676125156657343, 'support': 512959}, '2': {'precision': 0.3063099522023035, 'recall': 0.6374624419557497, 'f1-score': 0.41378851794117866, 'support': 43932}, 'accuracy': 0.7745002340707392, 'macro avg': {'precision': 0.5387928169570771, 'recall': 0.6868458501836768, 'f1-score': 0.5797721967462887, 'support': 602382}, 'weighted avg': {'precision': 0.8571264930484598, 'recall': 0.7745002340707392, 'f1-score': 0.8035752100499607, 'support': 602382}}
[[ 28361  12103   5027]
 [ 44385 410179  58395]
 [  5633  10294  28005]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.57987106
{'0': {'precision': 0.3390876675273577, 'recall': 0.6175930487750257, 'f1-score': 0.43780162560325125, 'support': 22327}, '1': {'precision': 0.9485396687962708, 'recall': 0.7898228557904128, 'f1-score': 0.8619356428168388, 'support': 274635}, '2': {'precision': 0.2973042463558869, 'recall': 0.6551318370015254, 'f1-score': 0.40900062579925445, 'support': 22945}, 'accuracy': 0.7681419912662117, 'macro avg': {'precision': 0.5283105275598384, 'recall': 0.6875159138556546, 'f1-score': 0.5695792980731148, 'support': 319907}, 'weighted avg': {'precision': 0.8592955084614684, 'recall': 0.7681419912662117, 'f1-score': 0.7998481168552428, 'support': 319907}}
[[ 13789   5910   2628]
 [ 24821 216913  32901]
 [  2055   5858  15032]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6078791
{'0': {'precision': 0.29874161538887967, 'recall': 0.5827205882352942, 'f1-score': 0.39498662366694764, 'support': 9248}, '1': {'precision': 0.9479047284033271, 'recall': 0.7724729750973266, 'f1-score': 0.8512442170909165, 'support': 108141}, '2': {'precision': 0.3018139148291204, 'recall': 0.6687973997833153, 'f1-score': 0.41592830913317386, 'support': 9230}, 'accuracy': 0.7510563185619852, 'macro avg': {'precision': 0.5161534195404424, 'recall': 0.6746636543719787, 'f1-score': 0.5540530499636793, 'support': 126619}, 'weighted avg': {'precision': 0.8533938044626268, 'recall': 0.7510563185619852, 'f1-score': 0.7861873452593997, 'support': 126619}}
[[ 5389  2397  1462]
 [11787 83536 12818]
 [  863  2194  6173]]
training model: results/EXC/W9/deepLOB_L2/h20
Epoch 1/50
1250/1250 - 55s - loss: 2.5842 - accuracy20: 0.4629 - val_loss: 3.0792 - val_accuracy20: 0.7175 - 55s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 52s - loss: 2.3489 - accuracy20: 0.5531 - val_loss: 2.7486 - val_accuracy20: 0.6654 - 52s/epoch - 42ms/step
Epoch 3/50
1250/1250 - 52s - loss: 2.2140 - accuracy20: 0.5995 - val_loss: 2.8662 - val_accuracy20: 0.7415 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 52s - loss: 2.1176 - accuracy20: 0.6304 - val_loss: 2.5364 - val_accuracy20: 0.7005 - 52s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 52s - loss: 2.0435 - accuracy20: 0.6528 - val_loss: 2.4277 - val_accuracy20: 0.6712 - 52s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 52s - loss: 1.9924 - accuracy20: 0.6636 - val_loss: 2.3660 - val_accuracy20: 0.6488 - 52s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 52s - loss: 1.9562 - accuracy20: 0.6686 - val_loss: 2.3252 - val_accuracy20: 0.7025 - 52s/epoch - 42ms/step
Epoch 8/50
1250/1250 - 52s - loss: 1.9349 - accuracy20: 0.6717 - val_loss: 2.3228 - val_accuracy20: 0.6954 - 52s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 52s - loss: 1.9148 - accuracy20: 0.6741 - val_loss: 2.4771 - val_accuracy20: 0.7185 - 52s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 52s - loss: 1.8979 - accuracy20: 0.6746 - val_loss: 2.3419 - val_accuracy20: 0.6790 - 52s/epoch - 42ms/step
Epoch 11/50
1250/1250 - 53s - loss: 1.8821 - accuracy20: 0.6766 - val_loss: 2.3759 - val_accuracy20: 0.6987 - 53s/epoch - 42ms/step
Epoch 12/50
1250/1250 - 52s - loss: 1.8685 - accuracy20: 0.6767 - val_loss: 2.4093 - val_accuracy20: 0.6886 - 52s/epoch - 42ms/step
Epoch 13/50
1250/1250 - 53s - loss: 1.8554 - accuracy20: 0.6783 - val_loss: 2.5087 - val_accuracy20: 0.6845 - 53s/epoch - 42ms/step
Epoch 14/50
1250/1250 - 52s - loss: 1.8459 - accuracy20: 0.6783 - val_loss: 2.6460 - val_accuracy20: 0.7288 - 52s/epoch - 42ms/step
Epoch 15/50
1250/1250 - 52s - loss: 1.8318 - accuracy20: 0.6785 - val_loss: 2.5285 - val_accuracy20: 0.6994 - 52s/epoch - 42ms/step
Epoch 16/50
1250/1250 - 52s - loss: 1.8222 - accuracy20: 0.6793 - val_loss: 2.5438 - val_accuracy20: 0.6998 - 52s/epoch - 42ms/step
Epoch 17/50
1250/1250 - 52s - loss: 1.8128 - accuracy20: 0.6808 - val_loss: 2.5673 - val_accuracy20: 0.7152 - 52s/epoch - 42ms/step
Epoch 18/50
1250/1250 - 52s - loss: 1.8027 - accuracy20: 0.6802 - val_loss: 2.5569 - val_accuracy20: 0.7190 - 52s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h20
Evaluating performance on  test set...
2354/2354 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6617757
{'0': {'precision': 0.3553105421538158, 'recall': 0.6853214500935647, 'f1-score': 0.467988564250287, 'support': 63058}, '1': {'precision': 0.9171679678016305, 'recall': 0.7118605741851194, 'f1-score': 0.801576767202865, 'support': 477616}, '2': {'precision': 0.3467570465407891, 'recall': 0.6184287288520127, 'f1-score': 0.444359054971414, 'support': 61708}, 'accuracy': 0.6995112735772318, 'macro avg': {'precision': 0.5397451854987452, 'recall': 0.6718702510435657, 'f1-score': 0.5713081288081887, 'support': 602382}, 'weighted avg': {'precision': 0.7999192407884331, 'recall': 0.6995112735772318, 'f1-score': 0.7300630176416861, 'support': 602382}}
[[ 43215  14637   5206]
 [ 70934 339996  66686]
 [  7477  16069  38162]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6480732
{'0': {'precision': 0.37046742967162266, 'recall': 0.6569613050075872, 'f1-score': 0.47377060392586, 'support': 31632}, '1': {'precision': 0.9198948512499052, 'recall': 0.7117561467875555, 'f1-score': 0.8025500742044249, 'support': 255662}, '2': {'precision': 0.3379950907603261, 'recall': 0.6839910465151934, 'f1-score': 0.45242417174554567, 'support': 32613}, 'accuracy': 0.703507581890987, 'macro avg': {'precision': 0.542785790560618, 'recall': 0.6842361661034454, 'f1-score': 0.5762482832919436, 'support': 319907}, 'weighted avg': {'precision': 0.8062462437226836, 'recall': 0.703507581890987, 'f1-score': 0.7343471019007772, 'support': 319907}}
[[ 20781   8117   2734]
 [ 32736 181969  40957]
 [  2577   7729  22307]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.66976863
{'0': {'precision': 0.33293727209407137, 'recall': 0.6293857950584772, 'f1-score': 0.4355002947639209, 'support': 12911}, '1': {'precision': 0.9184155502207079, 'recall': 0.7066376690698921, 'f1-score': 0.7987271012931034, 'support': 100698}, '2': {'precision': 0.35311716665318993, 'recall': 0.6713297463489624, 'f1-score': 0.46280203476049175, 'support': 13010}, 'accuracy': 0.6951326420205498, 'macro avg': {'precision': 0.5348233296559898, 'recall': 0.6691177368257772, 'f1-score': 0.565676476939172, 'support': 126619}, 'weighted avg': {'precision': 0.8006319472929766, 'recall': 0.6951326420205498, 'f1-score': 0.7271738082273901, 'support': 126619}}
[[ 8126  3225  1560]
 [15101 71157 14440]
 [ 1180  3096  8734]]
training model: results/EXC/W9/deepLOB_L2/h30
Epoch 1/50
1250/1250 - 55s - loss: 2.5994 - accuracy30: 0.4795 - val_loss: 2.6822 - val_accuracy30: 0.5290 - 55s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 53s - loss: 2.3839 - accuracy30: 0.5554 - val_loss: 2.5746 - val_accuracy30: 0.5698 - 53s/epoch - 42ms/step
Epoch 3/50
1250/1250 - 53s - loss: 2.2731 - accuracy30: 0.5906 - val_loss: 2.5724 - val_accuracy30: 0.6744 - 53s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 53s - loss: 2.1933 - accuracy30: 0.6168 - val_loss: 2.5591 - val_accuracy30: 0.6706 - 53s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 2.1245 - accuracy30: 0.6352 - val_loss: 2.5001 - val_accuracy30: 0.7045 - 53s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 52s - loss: 2.0775 - accuracy30: 0.6468 - val_loss: 2.4504 - val_accuracy30: 0.6711 - 52s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 52s - loss: 2.0422 - accuracy30: 0.6518 - val_loss: 2.5245 - val_accuracy30: 0.6750 - 52s/epoch - 41ms/step
Epoch 8/50
1250/1250 - 52s - loss: 2.0241 - accuracy30: 0.6528 - val_loss: 2.4631 - val_accuracy30: 0.6661 - 52s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 53s - loss: 2.0048 - accuracy30: 0.6550 - val_loss: 2.4094 - val_accuracy30: 0.6450 - 53s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 53s - loss: 1.9868 - accuracy30: 0.6560 - val_loss: 2.4824 - val_accuracy30: 0.6045 - 53s/epoch - 42ms/step
Epoch 11/50
1250/1250 - 53s - loss: 1.9696 - accuracy30: 0.6586 - val_loss: 2.4402 - val_accuracy30: 0.6211 - 53s/epoch - 43ms/step
Epoch 12/50
1250/1250 - 53s - loss: 1.9560 - accuracy30: 0.6598 - val_loss: 2.4714 - val_accuracy30: 0.5979 - 53s/epoch - 42ms/step
Epoch 13/50
1250/1250 - 53s - loss: 1.9468 - accuracy30: 0.6606 - val_loss: 2.5319 - val_accuracy30: 0.5662 - 53s/epoch - 42ms/step
Epoch 14/50
1250/1250 - 53s - loss: 1.9336 - accuracy30: 0.6605 - val_loss: 2.5006 - val_accuracy30: 0.6367 - 53s/epoch - 42ms/step
Epoch 15/50
1250/1250 - 52s - loss: 1.9236 - accuracy30: 0.6608 - val_loss: 2.5586 - val_accuracy30: 0.6237 - 52s/epoch - 42ms/step
Epoch 16/50
1250/1250 - 52s - loss: 1.9072 - accuracy30: 0.6636 - val_loss: 2.5619 - val_accuracy30: 0.6136 - 52s/epoch - 42ms/step
Epoch 17/50
1250/1250 - 52s - loss: 1.8966 - accuracy30: 0.6638 - val_loss: 2.5003 - val_accuracy30: 0.6367 - 52s/epoch - 42ms/step
Epoch 18/50
1250/1250 - 52s - loss: 1.8886 - accuracy30: 0.6635 - val_loss: 2.4830 - val_accuracy30: 0.6156 - 52s/epoch - 41ms/step
Epoch 19/50
1250/1250 - 52s - loss: 1.8785 - accuracy30: 0.6643 - val_loss: 2.5066 - val_accuracy30: 0.6363 - 52s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h30
Evaluating performance on  test set...
2354/2354 - 32s - 32s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7840805
{'0': {'precision': 0.33629876217260707, 'recall': 0.6867479293639631, 'f1-score': 0.4514993899698196, 'support': 76788}, '1': {'precision': 0.8758099551979067, 'recall': 0.6301838534855788, 'f1-score': 0.7329662171322328, 'support': 450413}, '2': {'precision': 0.3600750722323288, 'recall': 0.5818358361820141, 'f1-score': 0.4448500996623683, 'support': 75181}, 'accuracy': 0.631360166804453, 'macro avg': {'precision': 0.5240612632009475, 'recall': 0.6329225396771854, 'f1-score': 0.5431052355881402, 'support': 602382}, 'weighted avg': {'precision': 0.7426694401654824, 'recall': 0.631360166804453, 'f1-score': 0.6611278611527227, 'support': 602382}}
[[ 52734  17257   6797]
 [ 95627 283843  70943]
 [  8446  22992  43743]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7230087
{'0': {'precision': 0.3665236418582771, 'recall': 0.6582524768951128, 'f1-score': 0.4708640076182104, 'support': 39061}, '1': {'precision': 0.8749087011124014, 'recall': 0.6922482070470845, 'f1-score': 0.7729334267954711, 'support': 240525}, '2': {'precision': 0.4019042172018773, 'recall': 0.592544827757248, 'f1-score': 0.47895116670675963, 'support': 40321}, 'accuracy': 0.6755307011100101, 'macro avg': {'precision': 0.547778853390852, 'recall': 0.6476818372331484, 'f1-score': 0.5742495337068138, 'support': 319907}, 'weighted avg': {'precision': 0.7532169513373681, 'recall': 0.6755307011100101, 'f1-score': 0.6989969630997097, 'support': 319907}}
[[ 25712  10445   2904]
 [ 41371 166503  32651]
 [  3068  13361  23892]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7673153
{'0': {'precision': 0.32598430325332983, 'recall': 0.638352145909062, 'f1-score': 0.4315771320169009, 'support': 15681}, '1': {'precision': 0.8809561251769146, 'recall': 0.6481818468691161, 'f1-score': 0.746851858585124, 'support': 95069}, '2': {'precision': 0.38277548819473867, 'recall': 0.6262524418677925, 'f1-score': 0.475138649837445, 'support': 15869}, 'accuracy': 0.6442161129056461, 'macro avg': {'precision': 0.529905305541661, 'recall': 0.6375954782153235, 'f1-score': 0.5511892134798233, 'support': 126619}, 'weighted avg': {'precision': 0.7497898573351699, 'recall': 0.6442161129056461, 'f1-score': 0.6737535092304994, 'support': 126619}}
[[10010  3754  1917]
 [19339 61622 14108]
 [ 1358  4573  9938]]
training model: results/EXC/W9/deepLOB_L2/h50
Epoch 1/50
1250/1250 - 55s - loss: 2.7223 - accuracy50: 0.4743 - val_loss: 3.2024 - val_accuracy50: 0.6150 - 55s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 52s - loss: 2.5560 - accuracy50: 0.5326 - val_loss: 2.8363 - val_accuracy50: 0.5859 - 52s/epoch - 41ms/step
Epoch 3/50
1250/1250 - 52s - loss: 2.4918 - accuracy50: 0.5581 - val_loss: 2.7985 - val_accuracy50: 0.4597 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 52s - loss: 2.4472 - accuracy50: 0.5721 - val_loss: 2.7288 - val_accuracy50: 0.5424 - 52s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 52s - loss: 2.4055 - accuracy50: 0.5841 - val_loss: 2.6913 - val_accuracy50: 0.5978 - 52s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 52s - loss: 2.3639 - accuracy50: 0.5954 - val_loss: 2.8907 - val_accuracy50: 0.4460 - 52s/epoch - 41ms/step
Epoch 7/50
1250/1250 - 52s - loss: 2.3272 - accuracy50: 0.6041 - val_loss: 3.0793 - val_accuracy50: 0.4109 - 52s/epoch - 41ms/step
Epoch 8/50
1250/1250 - 51s - loss: 2.2997 - accuracy50: 0.6114 - val_loss: 2.9583 - val_accuracy50: 0.4507 - 51s/epoch - 41ms/step
Epoch 9/50
1250/1250 - 52s - loss: 2.2752 - accuracy50: 0.6167 - val_loss: 2.9290 - val_accuracy50: 0.4801 - 52s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 52s - loss: 2.2563 - accuracy50: 0.6218 - val_loss: 3.0237 - val_accuracy50: 0.4412 - 52s/epoch - 41ms/step
Epoch 11/50
1250/1250 - 52s - loss: 2.2349 - accuracy50: 0.6246 - val_loss: 2.9388 - val_accuracy50: 0.4729 - 52s/epoch - 41ms/step
Epoch 12/50
1250/1250 - 52s - loss: 2.2183 - accuracy50: 0.6263 - val_loss: 2.9654 - val_accuracy50: 0.4756 - 52s/epoch - 41ms/step
Epoch 13/50
1250/1250 - 52s - loss: 2.2045 - accuracy50: 0.6278 - val_loss: 2.9257 - val_accuracy50: 0.4670 - 52s/epoch - 42ms/step
Epoch 14/50
1250/1250 - 53s - loss: 2.1860 - accuracy50: 0.6303 - val_loss: 2.8625 - val_accuracy50: 0.5324 - 53s/epoch - 42ms/step
Epoch 15/50
1250/1250 - 52s - loss: 2.1738 - accuracy50: 0.6320 - val_loss: 2.8237 - val_accuracy50: 0.5548 - 52s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h50
Evaluating performance on  test set...
2354/2354 - 31s - 31s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9195303
{'0': {'precision': 0.32656112168624357, 'recall': 0.6992891584232241, 'f1-score': 0.4452124376928554, 'support': 100585}, '1': {'precision': 0.7861290029937403, 'recall': 0.515390696441095, 'f1-score': 0.6226007559031546, 'support': 403523}, '2': {'precision': 0.377703364913427, 'recall': 0.47058224962858947, 'f1-score': 0.4190581476480876, 'support': 98274}, 'accuracy': 0.5387876795787391, 'macro avg': {'precision': 0.49679782986447024, 'recall': 0.5617540348309695, 'f1-score': 0.49562378041469923, 'support': 602382}, 'weighted avg': {'precision': 0.6427594194105336, 'recall': 0.5387876795787391, 'f1-score': 0.5597742599739247, 'support': 602382}}
[[ 70338  22219   8028]
 [127385 207972  68166]
 [ 17667  34361  46246]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8277515
{'0': {'precision': 0.3883192317610797, 'recall': 0.6085835257890685, 'f1-score': 0.4741178322700592, 'support': 51960}, '1': {'precision': 0.7830292661259809, 'recall': 0.6666417677019968, 'f1-score': 0.720163405285455, 'support': 214199}, '2': {'precision': 0.46039242243330425, 'recall': 0.4806504428071742, 'f1-score': 0.4703033833662537, 'support': 53748}, 'accuracy': 0.62596317054644, 'macro avg': {'precision': 0.5439136401067882, 'recall': 0.5852919120994132, 'f1-score': 0.554861540307256, 'support': 319907}, 'weighted avg': {'precision': 0.664712947757223, 'recall': 0.62596317054644, 'f1-score': 0.6382208268736252, 'support': 319907}}
[[ 31622  16864   3474]
 [ 44600 142794  26805]
 [  5211  22703  25834]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.86763996
{'0': {'precision': 0.34668419433334263, 'recall': 0.6038094310210445, 'f1-score': 0.4404683641015618, 'support': 20528}, '1': {'precision': 0.7901858469267228, 'recall': 0.619026424287856, 'f1-score': 0.694211836410327, 'support': 85376}, '2': {'precision': 0.43476629279072676, 'recall': 0.503355056722182, 'f1-score': 0.46655331334735334, 'support': 20715}, 'accuracy': 0.5976354259629282, 'macro avg': {'precision': 0.5238787780169307, 'recall': 0.5753969706770276, 'f1-score': 0.5337445046197474, 'support': 126619}, 'weighted avg': {'precision': 0.6601365021335712, 'recall': 0.5976354259629282, 'f1-score': 0.6158287161455656, 'support': 126619}}
[[12395  6085  2048]
 [21018 52850 11508]
 [ 2340  7948 10427]]
training model: results/EXC/W9/deepLOB_L2/h100
Epoch 1/50
1250/1250 - 54s - loss: 2.9597 - accuracy100: 0.4701 - val_loss: 3.2910 - val_accuracy100: 0.5122 - 54s/epoch - 43ms/step
Epoch 2/50
1250/1250 - 52s - loss: 2.8375 - accuracy100: 0.5087 - val_loss: 3.1666 - val_accuracy100: 0.5538 - 52s/epoch - 41ms/step
Epoch 3/50
1250/1250 - 52s - loss: 2.7871 - accuracy100: 0.5291 - val_loss: 3.1494 - val_accuracy100: 0.5524 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 52s - loss: 2.7614 - accuracy100: 0.5363 - val_loss: 3.2529 - val_accuracy100: 0.5559 - 52s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 2.7362 - accuracy100: 0.5431 - val_loss: 3.2459 - val_accuracy100: 0.5552 - 53s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 53s - loss: 2.7149 - accuracy100: 0.5493 - val_loss: 3.1886 - val_accuracy100: 0.5559 - 53s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 53s - loss: 2.6997 - accuracy100: 0.5536 - val_loss: 3.0705 - val_accuracy100: 0.5569 - 53s/epoch - 43ms/step
Epoch 8/50
1250/1250 - 54s - loss: 2.6737 - accuracy100: 0.5599 - val_loss: 3.1597 - val_accuracy100: 0.5532 - 54s/epoch - 43ms/step
Epoch 9/50
1250/1250 - 53s - loss: 2.6541 - accuracy100: 0.5640 - val_loss: 3.1777 - val_accuracy100: 0.5490 - 53s/epoch - 43ms/step
Epoch 10/50
1250/1250 - 53s - loss: 2.6279 - accuracy100: 0.5691 - val_loss: 3.0995 - val_accuracy100: 0.5532 - 53s/epoch - 43ms/step
Epoch 11/50
1250/1250 - 53s - loss: 2.6102 - accuracy100: 0.5724 - val_loss: 3.0124 - val_accuracy100: 0.5466 - 53s/epoch - 42ms/step
Epoch 12/50
1250/1250 - 53s - loss: 2.5990 - accuracy100: 0.5732 - val_loss: 2.9985 - val_accuracy100: 0.5319 - 53s/epoch - 42ms/step
Epoch 13/50
1250/1250 - 54s - loss: 2.5775 - accuracy100: 0.5773 - val_loss: 2.9909 - val_accuracy100: 0.5308 - 54s/epoch - 43ms/step
Epoch 14/50
1250/1250 - 53s - loss: 2.5566 - accuracy100: 0.5820 - val_loss: 3.0345 - val_accuracy100: 0.5205 - 53s/epoch - 43ms/step
Epoch 15/50
1250/1250 - 54s - loss: 2.5392 - accuracy100: 0.5857 - val_loss: 3.0454 - val_accuracy100: 0.5251 - 54s/epoch - 43ms/step
Epoch 16/50
1250/1250 - 53s - loss: 2.5226 - accuracy100: 0.5885 - val_loss: 3.0688 - val_accuracy100: 0.5330 - 53s/epoch - 42ms/step
Epoch 17/50
1250/1250 - 52s - loss: 2.5018 - accuracy100: 0.5933 - val_loss: 3.0849 - val_accuracy100: 0.5101 - 52s/epoch - 42ms/step
Epoch 18/50
1250/1250 - 53s - loss: 2.4857 - accuracy100: 0.5953 - val_loss: 3.0683 - val_accuracy100: 0.5365 - 53s/epoch - 42ms/step
Epoch 19/50
1250/1250 - 53s - loss: 2.4684 - accuracy100: 0.5981 - val_loss: 3.1241 - val_accuracy100: 0.5060 - 53s/epoch - 42ms/step
Epoch 20/50
1250/1250 - 52s - loss: 2.4494 - accuracy100: 0.6017 - val_loss: 3.1399 - val_accuracy100: 0.4984 - 52s/epoch - 42ms/step
Epoch 21/50
1250/1250 - 53s - loss: 2.4338 - accuracy100: 0.6043 - val_loss: 3.1702 - val_accuracy100: 0.5043 - 53s/epoch - 42ms/step
Epoch 22/50
1250/1250 - 54s - loss: 2.4206 - accuracy100: 0.6068 - val_loss: 3.2046 - val_accuracy100: 0.5095 - 54s/epoch - 43ms/step
Epoch 23/50
1250/1250 - 53s - loss: 2.4061 - accuracy100: 0.6098 - val_loss: 3.2142 - val_accuracy100: 0.5143 - 53s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h100
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.99928874
{'0': {'precision': 0.3881244368423464, 'recall': 0.5229863769189612, 'f1-score': 0.4455743252128023, 'support': 145782}, '1': {'precision': 0.5992058335574607, 'recall': 0.6336542855590672, 'f1-score': 0.6159487819879598, 'support': 312923}, '2': {'precision': 0.48380690905213775, 'recall': 0.25265700146857184, 'f1-score': 0.33195707538327185, 'support': 143677}, 'accuracy': 0.5159981539953054, 'macro avg': {'precision': 0.49037905981731494, 'recall': 0.46976588798220004, 'f1-score': 0.464493394194678, 'support': 602382}, 'weighted avg': {'precision': 0.5205978415323436, 'recall': 0.5159981539953054, 'f1-score': 0.506980377408411, 'support': 602382}}
[[ 76242  58278  11262]
 [ 87169 198285  27469]
 [ 33026  74350  36301]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9421459
{'0': {'precision': 0.4689691023966303, 'recall': 0.45547284613890865, 'f1-score': 0.4621224559490894, 'support': 77245}, '1': {'precision': 0.5970774222075425, 'recall': 0.687101896184947, 'f1-score': 0.6389341785718358, 'support': 163117}, '2': {'precision': 0.49590723055934516, 'recall': 0.35643975108429193, 'f1-score': 0.41476312729028153, 'support': 79545}, 'accuracy': 0.5489532895497754, 'macro avg': {'precision': 0.5206512517211727, 'recall': 0.49967149780271586, 'f1-score': 0.5052732539370689, 'support': 319907}, 'weighted avg': {'precision': 0.5409882773671677, 'recall': 0.5489532895497754, 'f1-score': 0.5405008595504162, 'support': 319907}}
[[ 35183  34370   7692]
 [ 29910 112078  21129]
 [  9929  41263  28353]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.96374214
{'0': {'precision': 0.43562276832598196, 'recall': 0.4814937649243831, 'f1-score': 0.4574111123363632, 'support': 30152}, '1': {'precision': 0.6232578195986632, 'recall': 0.6096348517715112, 'f1-score': 0.6163710715292003, 'support': 66384}, '2': {'precision': 0.4298106421241934, 'recall': 0.40517900475351526, 'f1-score': 0.41713151500633106, 'support': 30083}, 'accuracy': 0.53054438907273, 'macro avg': {'precision': 0.49623041001627954, 'recall': 0.49876920714980316, 'f1-score': 0.4969712329572982, 'support': 126619}, 'weighted avg': {'precision': 0.532615471247007, 'recall': 0.53054438907273, 'f1-score': 0.5311809794540782, 'support': 126619}}
[[14518 10656  4978]
 [14722 40470 11192]
 [ 4087 13807 12189]]
training model: results/EXC/W9/deepLOB_L2/h200
Epoch 1/50
1250/1250 - 56s - loss: 3.1680 - accuracy200: 0.4336 - val_loss: 3.2995 - val_accuracy200: 0.3945 - 56s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 54s - loss: 3.1104 - accuracy200: 0.4541 - val_loss: 3.3060 - val_accuracy200: 0.4009 - 54s/epoch - 44ms/step
Epoch 3/50
1250/1250 - 52s - loss: 3.0791 - accuracy200: 0.4669 - val_loss: 3.3450 - val_accuracy200: 0.4122 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 53s - loss: 3.0462 - accuracy200: 0.4786 - val_loss: 3.3680 - val_accuracy200: 0.4070 - 53s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 3.0203 - accuracy200: 0.4864 - val_loss: 3.4002 - val_accuracy200: 0.3937 - 53s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 53s - loss: 3.0004 - accuracy200: 0.4931 - val_loss: 3.3005 - val_accuracy200: 0.4151 - 53s/epoch - 43ms/step
Epoch 7/50
1250/1250 - 54s - loss: 2.9824 - accuracy200: 0.4991 - val_loss: 3.2945 - val_accuracy200: 0.4131 - 54s/epoch - 43ms/step
Epoch 8/50
1250/1250 - 53s - loss: 2.9642 - accuracy200: 0.5036 - val_loss: 3.4422 - val_accuracy200: 0.4041 - 53s/epoch - 43ms/step
Epoch 9/50
1250/1250 - 52s - loss: 2.9446 - accuracy200: 0.5086 - val_loss: 3.3928 - val_accuracy200: 0.4156 - 52s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 53s - loss: 2.9252 - accuracy200: 0.5150 - val_loss: 3.4197 - val_accuracy200: 0.4070 - 53s/epoch - 42ms/step
Epoch 11/50
1250/1250 - 52s - loss: 2.9064 - accuracy200: 0.5184 - val_loss: 3.4421 - val_accuracy200: 0.4069 - 52s/epoch - 42ms/step
Epoch 12/50
1250/1250 - 53s - loss: 2.8850 - accuracy200: 0.5245 - val_loss: 3.4939 - val_accuracy200: 0.4014 - 53s/epoch - 42ms/step
Epoch 13/50
1250/1250 - 53s - loss: 2.8672 - accuracy200: 0.5295 - val_loss: 3.4439 - val_accuracy200: 0.4024 - 53s/epoch - 43ms/step
Epoch 14/50
1250/1250 - 53s - loss: 2.8491 - accuracy200: 0.5340 - val_loss: 3.5844 - val_accuracy200: 0.3906 - 53s/epoch - 42ms/step
Epoch 15/50
1250/1250 - 53s - loss: 2.8391 - accuracy200: 0.5363 - val_loss: 3.7242 - val_accuracy200: 0.3869 - 53s/epoch - 43ms/step
Epoch 16/50
1250/1250 - 53s - loss: 2.8175 - accuracy200: 0.5429 - val_loss: 3.9215 - val_accuracy200: 0.3740 - 53s/epoch - 42ms/step
Epoch 17/50
1250/1250 - 54s - loss: 2.8001 - accuracy200: 0.5468 - val_loss: 3.8464 - val_accuracy200: 0.3746 - 54s/epoch - 43ms/step
testing model: results/EXC/W9/deepLOB_L2/h200
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1665269
{'0': {'precision': 0.3514081361043119, 'recall': 0.7962074564548101, 'f1-score': 0.48760888234572447, 'support': 189688}, '1': {'precision': 0.42805870580386923, 'recall': 0.2855807660468387, 'f1-score': 0.34259689363724216, 'support': 224686}, '2': {'precision': 0.4323609764695514, 'recall': 0.05218926854176418, 'f1-score': 0.09313627777619576, 'support': 188008}, 'accuracy': 0.37353207765172264, 'macro avg': {'precision': 0.4039426061259109, 'recall': 0.37799249701447096, 'f1-score': 0.30778068458638747, 'support': 602382}, 'weighted avg': {'precision': 0.40526447894806006, 'recall': 0.37353207765172264, 'f1-score': 0.31040211133519957, 'support': 602382}}
[[151031  34172   4485]
 [152123  64166   8397]
 [126634  51562   9812]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0912865
{'0': {'precision': 0.41356838766092435, 'recall': 0.6361431825322024, 'f1-score': 0.5012590463739077, 'support': 101856}, '1': {'precision': 0.4244311299356947, 'recall': 0.4566869899141875, 'f1-score': 0.43996865071673563, 'support': 114319}, '2': {'precision': 0.4753275163447436, 'recall': 0.1843307754598388, 'f1-score': 0.2656450795018026, 'support': 103732}, 'accuracy': 0.4255111641820904, 'macro avg': {'precision': 0.43777567798045425, 'recall': 0.4257203159687429, 'f1-score': 0.40229092553081536, 'support': 319907}, 'weighted avg': {'precision': 0.4374760100972556, 'recall': 0.4255111641820904, 'f1-score': 0.4029574626239133, 'support': 319907}}
[[64795 28774  8287]
 [49292 52208 12819]
 [42586 42025 19121]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1011821
{'0': {'precision': 0.39222449989397046, 'recall': 0.6916288577553971, 'f1-score': 0.5005728513563497, 'support': 40114}, '1': {'precision': 0.42871177389289133, 'recall': 0.3619369656756412, 'f1-score': 0.39250461254612545, 'support': 47022}, '2': {'precision': 0.47096256023724203, 'recall': 0.19307043537725097, 'f1-score': 0.2738687599920961, 'support': 39483}, 'accuracy': 0.4137293771077011, 'macro avg': {'precision': 0.43063294467470126, 'recall': 0.4155454196027631, 'f1-score': 0.38898207463152373, 'support': 126619}, 'weighted avg': {'precision': 0.43032714984785303, 'recall': 0.4137293771077011, 'f1-score': 0.3897479169889231, 'support': 126619}}
[[27744  9078  3292]
 [24732 17019  5271]
 [18259 13601  7623]]
training model: results/EXC/W9/deepLOB_L2/h300
Epoch 1/50
1250/1250 - 56s - loss: 3.2285 - accuracy300: 0.4100 - val_loss: 3.2854 - val_accuracy300: 0.3857 - 56s/epoch - 44ms/step
Epoch 2/50
1250/1250 - 53s - loss: 3.1745 - accuracy300: 0.4347 - val_loss: 3.3790 - val_accuracy300: 0.3582 - 53s/epoch - 42ms/step
Epoch 3/50
1250/1250 - 53s - loss: 3.1493 - accuracy300: 0.4459 - val_loss: 3.3364 - val_accuracy300: 0.3712 - 53s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 53s - loss: 3.1276 - accuracy300: 0.4521 - val_loss: 3.3272 - val_accuracy300: 0.3791 - 53s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 3.1077 - accuracy300: 0.4607 - val_loss: 3.3605 - val_accuracy300: 0.3786 - 53s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 53s - loss: 3.0892 - accuracy300: 0.4667 - val_loss: 3.3861 - val_accuracy300: 0.3697 - 53s/epoch - 43ms/step
Epoch 7/50
1250/1250 - 53s - loss: 3.0687 - accuracy300: 0.4748 - val_loss: 3.5129 - val_accuracy300: 0.3648 - 53s/epoch - 42ms/step
Epoch 8/50
1250/1250 - 52s - loss: 3.0506 - accuracy300: 0.4795 - val_loss: 3.5357 - val_accuracy300: 0.3624 - 52s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 53s - loss: 3.0295 - accuracy300: 0.4862 - val_loss: 3.5735 - val_accuracy300: 0.3663 - 53s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 53s - loss: 3.0088 - accuracy300: 0.4918 - val_loss: 3.5779 - val_accuracy300: 0.3572 - 53s/epoch - 43ms/step
Epoch 11/50
1250/1250 - 53s - loss: 2.9915 - accuracy300: 0.4983 - val_loss: 3.5243 - val_accuracy300: 0.3722 - 53s/epoch - 43ms/step
testing model: results/EXC/W9/deepLOB_L2/h300
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1151804
{'0': {'precision': 0.37884383724720455, 'recall': 0.6790184921763869, 'f1-score': 0.48634300321116364, 'support': 196840}, '1': {'precision': 0.3561968261630363, 'recall': 0.33765014299332696, 'f1-score': 0.34667560610361264, 'support': 209800}, '2': {'precision': 0.4453363838977535, 'recall': 0.1153508189351289, 'f1-score': 0.18323912628883757, 'support': 195742}, 'accuracy': 0.37696345508331924, 'macro avg': {'precision': 0.39345901576933145, 'recall': 0.3773398180349476, 'f1-score': 0.33875257853453794, 'support': 602382}, 'weighted avg': {'precision': 0.39256277496614905, 'recall': 0.37696345508331924, 'f1-score': 0.33920650346566306, 'support': 602382}}
[[133658  52356  10826]
 [121665  70839  17296]
 [ 97482  75681  22579]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052103
{'0': {'precision': 0.40858294973031917, 'recall': 0.5248068282228197, 'f1-score': 0.4594589034049995, 'support': 106382}, '1': {'precision': 0.3402054007667926, 'recall': 0.4674552837024429, 'f1-score': 0.3938060009372709, 'support': 105163}, '2': {'precision': 0.46053242532115773, 'recall': 0.16475332681198207, 'f1-score': 0.24268664020444783, 'support': 108362}, 'accuracy': 0.3839928479214272, 'macro avg': {'precision': 0.40310692527275654, 'recall': 0.38567181291241487, 'f1-score': 0.36531718151557274, 'support': 319907}, 'weighted avg': {'precision': 0.4037020340026955, 'recall': 0.3839928479214272, 'f1-score': 0.36444962831207584, 'support': 319907}}
[[55830 41646  8906]
 [43997 49159 12007]
 [36816 53693 17853]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0961412
{'0': {'precision': 0.3992047910514246, 'recall': 0.5660381772246654, 'f1-score': 0.4682036745000532, 'support': 42748}, '1': {'precision': 0.33714438837032734, 'recall': 0.3552972184308373, 'f1-score': 0.3459828589761217, 'support': 42494}, '2': {'precision': 0.4558047493403694, 'recall': 0.23380138724412114, 'f1-score': 0.3090685452309069, 'support': 41377}, 'accuracy': 0.38674290588300336, 'macro avg': {'precision': 0.3973846429207071, 'recall': 0.38504559429987467, 'f1-score': 0.3744183595690272, 'support': 126619}, 'weighted avg': {'precision': 0.39687292713361705, 'recall': 0.38674290588300336, 'f1-score': 0.3751829937282622, 'support': 126619}}
[[24197 13767  4784]
 [20630 15098  6766]
 [15786 15917  9674]]
training model: results/EXC/W9/deepLOB_L2/h500
Epoch 1/50
1250/1250 - 54s - loss: 3.2773 - accuracy500: 0.3859 - val_loss: 3.3645 - val_accuracy500: 0.3598 - 54s/epoch - 43ms/step
Epoch 2/50
1250/1250 - 53s - loss: 3.2314 - accuracy500: 0.4050 - val_loss: 3.5513 - val_accuracy500: 0.3561 - 53s/epoch - 42ms/step
Epoch 3/50
1250/1250 - 52s - loss: 3.2040 - accuracy500: 0.4200 - val_loss: 3.5625 - val_accuracy500: 0.3419 - 52s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 52s - loss: 3.1842 - accuracy500: 0.4294 - val_loss: 3.5902 - val_accuracy500: 0.3419 - 52s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 3.1641 - accuracy500: 0.4383 - val_loss: 3.5866 - val_accuracy500: 0.3449 - 53s/epoch - 42ms/step
Epoch 6/50
1250/1250 - 52s - loss: 3.1466 - accuracy500: 0.4448 - val_loss: 3.5822 - val_accuracy500: 0.3388 - 52s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 53s - loss: 3.1283 - accuracy500: 0.4510 - val_loss: 3.5454 - val_accuracy500: 0.3388 - 53s/epoch - 42ms/step
Epoch 8/50
1250/1250 - 53s - loss: 3.1133 - accuracy500: 0.4565 - val_loss: 3.6468 - val_accuracy500: 0.3385 - 53s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 53s - loss: 3.0955 - accuracy500: 0.4647 - val_loss: 3.6810 - val_accuracy500: 0.3419 - 53s/epoch - 43ms/step
Epoch 10/50
1250/1250 - 53s - loss: 3.0722 - accuracy500: 0.4733 - val_loss: 3.6385 - val_accuracy500: 0.3395 - 53s/epoch - 42ms/step
Epoch 11/50
1250/1250 - 53s - loss: 3.0486 - accuracy500: 0.4809 - val_loss: 3.6565 - val_accuracy500: 0.3450 - 53s/epoch - 42ms/step
testing model: results/EXC/W9/deepLOB_L2/h500
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1424264
{'0': {'precision': 0.33702326801959415, 'recall': 0.7860953838306555, 'f1-score': 0.47177995806101053, 'support': 196050}, '1': {'precision': 0.3537614899008832, 'recall': 0.11309141460140933, 'f1-score': 0.17139183215340412, 'support': 208610}, '2': {'precision': 0.35123002563350464, 'recall': 0.13929153053276824, 'f1-score': 0.1994748945262281, 'support': 197722}, 'accuracy': 0.34072565249293635, 'macro avg': {'precision': 0.34733826118466066, 'recall': 0.3461594429882777, 'f1-score': 0.2808822282468809, 'support': 602382}, 'weighted avg': {'precision': 0.3474829912443806, 'recall': 0.34072565249293635, 'f1-score': 0.2783733344935566, 'support': 602382}}
[[154114  19092  22844]
 [156990  23592  28028]
 [146176  24005  27541]]
Evaluating performance on  train set...
1250/1250 - 18s - 18s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1260128
{'0': {'precision': 0.3579501553316317, 'recall': 0.6359548221572136, 'f1-score': 0.4580722152136111, 'support': 105627}, '1': {'precision': 0.34396098177794837, 'recall': 0.14436399476866507, 'f1-score': 0.2033710490304062, 'support': 105518}, '2': {'precision': 0.3789920074581898, 'recall': 0.3064949155035766, 'f1-score': 0.3389098155236657, 'support': 108762}, 'accuracy': 0.3617988978046745, 'macro avg': {'precision': 0.3603010481892566, 'recall': 0.3622712441431517, 'f1-score': 0.3334510265892277, 'support': 319907}, 'weighted avg': {'precision': 0.3604897818666908, 'recall': 0.3617988978046745, 'f1-score': 0.33354884258219863, 'support': 319907}}
[[67174 12602 25851]
 [61514 15233 28771]
 [58975 16452 33335]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1216831
{'0': {'precision': 0.3653870500358705, 'recall': 0.6071052939114175, 'f1-score': 0.4562059820503363, 'support': 42785}, '1': {'precision': 0.3639334521687463, 'recall': 0.1718574635241302, 'f1-score': 0.23346674290070518, 'support': 42768}, '2': {'precision': 0.3559461142242599, 'recall': 0.30626308868650465, 'f1-score': 0.3292408376963351, 'support': 41066}, 'accuracy': 0.362520632764435, 'macro avg': {'precision': 0.3617555388096256, 'recall': 0.36174194870735077, 'f1-score': 0.33963785421579223, 'support': 126619}, 'weighted avg': {'precision': 0.36183411608740496, 'recall': 0.362520632764435, 'f1-score': 0.339793260436733, 'support': 126619}}
[[25975  6084 10726]
 [23387  7350 12031]
 [21727  6762 12577]]
training model: results/EXC/W9/deepLOB_L2/h1000
Epoch 1/50
1250/1250 - 87s - loss: 3.1759 - accuracy1000: 0.4468 - val_loss: 3.4094 - val_accuracy1000: 0.4349 - 87s/epoch - 69ms/step
Epoch 2/50
1250/1250 - 53s - loss: 3.1366 - accuracy1000: 0.4630 - val_loss: 3.3726 - val_accuracy1000: 0.4266 - 53s/epoch - 43ms/step
Epoch 3/50
1250/1250 - 53s - loss: 3.1110 - accuracy1000: 0.4713 - val_loss: 3.3520 - val_accuracy1000: 0.3938 - 53s/epoch - 42ms/step
Epoch 4/50
1250/1250 - 53s - loss: 3.0981 - accuracy1000: 0.4755 - val_loss: 3.3792 - val_accuracy1000: 0.3979 - 53s/epoch - 42ms/step
Epoch 5/50
1250/1250 - 53s - loss: 3.0893 - accuracy1000: 0.4824 - val_loss: 3.4563 - val_accuracy1000: 0.3345 - 53s/epoch - 43ms/step
Epoch 6/50
1250/1250 - 53s - loss: 3.0761 - accuracy1000: 0.4854 - val_loss: 3.4827 - val_accuracy1000: 0.3323 - 53s/epoch - 42ms/step
Epoch 7/50
1250/1250 - 52s - loss: 3.0567 - accuracy1000: 0.4918 - val_loss: 3.4273 - val_accuracy1000: 0.3647 - 52s/epoch - 42ms/step
Epoch 8/50
1250/1250 - 53s - loss: 3.0306 - accuracy1000: 0.4996 - val_loss: 3.4156 - val_accuracy1000: 0.3780 - 53s/epoch - 42ms/step
Epoch 9/50
1250/1250 - 53s - loss: 3.0187 - accuracy1000: 0.5055 - val_loss: 3.4254 - val_accuracy1000: 0.3650 - 53s/epoch - 42ms/step
Epoch 10/50
1250/1250 - 51s - loss: 3.0102 - accuracy1000: 0.5063 - val_loss: 3.4829 - val_accuracy1000: 0.3331 - 51s/epoch - 41ms/step
Epoch 11/50
1250/1250 - 51s - loss: 2.9769 - accuracy1000: 0.5173 - val_loss: 3.4316 - val_accuracy1000: 0.3712 - 51s/epoch - 41ms/step
Epoch 12/50
1250/1250 - 51s - loss: 2.9587 - accuracy1000: 0.5210 - val_loss: 3.4514 - val_accuracy1000: 0.3647 - 51s/epoch - 41ms/step
Epoch 13/50
1250/1250 - 52s - loss: 2.9420 - accuracy1000: 0.5255 - val_loss: 3.4984 - val_accuracy1000: 0.3764 - 52s/epoch - 41ms/step
testing model: results/EXC/W9/deepLOB_L2/h1000
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0917656
{'0': {'precision': 0.23860659477457932, 'recall': 0.5439685338770561, 'f1-score': 0.33171123073271847, 'support': 145172}, '1': {'precision': 0.5158743098528922, 'recall': 0.44585748598879105, 'f1-score': 0.47831718546004265, 'support': 312250}, '2': {'precision': 0.21313586606567933, 'recall': 0.0022833885209713025, 'f1-score': 0.004518370383515456, 'support': 144960}, 'accuracy': 0.3627581833454519, 'macro avg': {'precision': 0.32253892356438363, 'recall': 0.3307031361289395, 'f1-score': 0.27151559552542553, 'support': 602382}, 'weighted avg': {'precision': 0.3762013555734761, 'recall': 0.3627581833454519, 'f1-score': 0.32896850655999504, 'support': 602382}}
[[ 78969  65754    449]
 [172258 139219    773]
 [ 79732  64897    331]]
Evaluating performance on  train set...
1250/1250 - 17s - 17s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1262125
{'0': {'precision': 0.3550042652622209, 'recall': 0.7148471778786012, 'f1-score': 0.47440941223119193, 'support': 107118}, '1': {'precision': 0.3960898671756169, 'recall': 0.3912494258153422, 'f1-score': 0.39365476734949334, 'support': 104496}, '2': {'precision': 0.3064516129032258, 'recall': 0.002807198987930891, 'f1-score': 0.005563435055131079, 'support': 108293}, 'accuracy': 0.3681101069998468, 'macro avg': {'precision': 0.35251524844702115, 'recall': 0.3696346008939581, 'f1-score': 0.29120920487860547, 'support': 319907}, 'weighted avg': {'precision': 0.35198891603769494, 'recall': 0.3681101069998468, 'f1-score': 0.28932038705235824, 'support': 319907}}
[[76573 30211   334]
 [63258 40884   354]
 [75865 32124   304]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1165129
{'0': {'precision': 0.3494943519856212, 'recall': 0.7579936840027632, 'f1-score': 0.47840609160768927, 'support': 40532}, '1': {'precision': 0.4977607665468937, 'recall': 0.3917096959265634, 'f1-score': 0.43841302602912513, 'support': 48804}, '2': {'precision': 0.22549019607843138, 'recall': 0.001850709438618137, 'f1-score': 0.0036712868126313547, 'support': 37283}, 'accuracy': 0.3941667522251795, 'macro avg': {'precision': 0.35758177153698206, 'recall': 0.3838513631226483, 'f1-score': 0.3068301348164819, 'support': 126619}, 'weighted avg': {'precision': 0.370129068351732, 'recall': 0.3941667522251795, 'f1-score': 0.3232053768676393, 'support': 126619}}
[[30723  9734    75]
 [29525 19117   162]
 [27659  9555    69]]
training model: results/EXC/W9/deepOF_L2/h10
Epoch 1/50
1250/1250 - 31s - loss: 2.5657 - accuracy10: 0.5602 - val_loss: 2.8126 - val_accuracy10: 0.8067 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.1792 - accuracy10: 0.6225 - val_loss: 2.9005 - val_accuracy10: 0.7916 - 28s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 29s - loss: 2.0441 - accuracy10: 0.6457 - val_loss: 2.7840 - val_accuracy10: 0.7534 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 29s - loss: 1.9872 - accuracy10: 0.6584 - val_loss: 2.7236 - val_accuracy10: 0.7267 - 29s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 1.9538 - accuracy10: 0.6641 - val_loss: 2.6298 - val_accuracy10: 0.7559 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 1.9297 - accuracy10: 0.6665 - val_loss: 2.5243 - val_accuracy10: 0.7463 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 1.9085 - accuracy10: 0.6687 - val_loss: 2.6109 - val_accuracy10: 0.7415 - 28s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 1.8927 - accuracy10: 0.6694 - val_loss: 2.5794 - val_accuracy10: 0.7513 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 28s - loss: 1.8784 - accuracy10: 0.6714 - val_loss: 2.5814 - val_accuracy10: 0.7388 - 28s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 28s - loss: 1.8652 - accuracy10: 0.6724 - val_loss: 2.5213 - val_accuracy10: 0.7264 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 1.8501 - accuracy10: 0.6739 - val_loss: 2.5077 - val_accuracy10: 0.7318 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 1.8405 - accuracy10: 0.6742 - val_loss: 2.5699 - val_accuracy10: 0.7256 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 28s - loss: 1.8285 - accuracy10: 0.6739 - val_loss: 2.6030 - val_accuracy10: 0.7131 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 1.8178 - accuracy10: 0.6753 - val_loss: 2.5492 - val_accuracy10: 0.6970 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 28s - loss: 1.8074 - accuracy10: 0.6749 - val_loss: 2.4937 - val_accuracy10: 0.7318 - 28s/epoch - 23ms/step
Epoch 16/50
1250/1250 - 28s - loss: 1.7997 - accuracy10: 0.6756 - val_loss: 2.5582 - val_accuracy10: 0.7409 - 28s/epoch - 23ms/step
Epoch 17/50
1250/1250 - 28s - loss: 1.7868 - accuracy10: 0.6772 - val_loss: 2.4920 - val_accuracy10: 0.7354 - 28s/epoch - 22ms/step
Epoch 18/50
1250/1250 - 28s - loss: 1.7784 - accuracy10: 0.6764 - val_loss: 2.6392 - val_accuracy10: 0.7086 - 28s/epoch - 23ms/step
Epoch 19/50
1250/1250 - 28s - loss: 1.7701 - accuracy10: 0.6780 - val_loss: 2.6025 - val_accuracy10: 0.7044 - 28s/epoch - 22ms/step
Epoch 20/50
1250/1250 - 28s - loss: 1.7569 - accuracy10: 0.6796 - val_loss: 2.6491 - val_accuracy10: 0.7116 - 28s/epoch - 23ms/step
Epoch 21/50
1250/1250 - 28s - loss: 1.7472 - accuracy10: 0.6773 - val_loss: 2.5898 - val_accuracy10: 0.7231 - 28s/epoch - 23ms/step
Epoch 22/50
1250/1250 - 28s - loss: 1.7383 - accuracy10: 0.6767 - val_loss: 2.7163 - val_accuracy10: 0.7058 - 28s/epoch - 22ms/step
Epoch 23/50
1250/1250 - 28s - loss: 1.7304 - accuracy10: 0.6780 - val_loss: 2.6116 - val_accuracy10: 0.6993 - 28s/epoch - 22ms/step
Epoch 24/50
1250/1250 - 28s - loss: 1.7194 - accuracy10: 0.6795 - val_loss: 2.6306 - val_accuracy10: 0.7148 - 28s/epoch - 22ms/step
Epoch 25/50
1250/1250 - 28s - loss: 1.7160 - accuracy10: 0.6775 - val_loss: 2.7209 - val_accuracy10: 0.6980 - 28s/epoch - 22ms/step
Epoch 26/50
1250/1250 - 28s - loss: 1.7066 - accuracy10: 0.6799 - val_loss: 2.6242 - val_accuracy10: 0.7001 - 28s/epoch - 23ms/step
Epoch 27/50
1250/1250 - 28s - loss: 1.7035 - accuracy10: 0.6788 - val_loss: 2.6382 - val_accuracy10: 0.7016 - 28s/epoch - 22ms/step
testing model: results/EXC/W9/deepOF_L2/h10
Evaluating performance on  test set...
2354/2354 - 19s - 19s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.626725
{'0': {'precision': 0.24411240926042757, 'recall': 0.6719718619476808, 'f1-score': 0.35812572124819136, 'support': 45490}, '1': {'precision': 0.9414833539504115, 'recall': 0.7507646839793589, 'f1-score': 0.8353768913984011, 'support': 512957}, '2': {'precision': 0.33439532527785526, 'recall': 0.51844938653798, 'f1-score': 0.40656182502989946, 'support': 43931}, 'accuracy': 0.7278718678304985, 'macro avg': {'precision': 0.5066636961628982, 'recall': 0.6470619774883398, 'f1-score': 0.5333548125588307, 'support': 602378}, 'weighted avg': {'precision': 0.8445452379143652, 'recall': 0.7278718678304985, 'f1-score': 0.7680629615889331, 'support': 602378}}
[[ 30568   8187   6735]
 [ 89247 385110  38600]
 [  5406  15749  22776]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5507331
{'0': {'precision': 0.27419138884107036, 'recall': 0.6419039942683146, 'f1-score': 0.3842493935373192, 'support': 22332}, '1': {'precision': 0.9450845891694485, 'recall': 0.7895961376015845, 'f1-score': 0.8603717442621649, 'support': 274648}, '2': {'precision': 0.34745696093074446, 'recall': 0.5783826223501701, 'f1-score': 0.43412070912930323, 'support': 22926}, 'accuracy': 0.7641494689064913, 'macro avg': {'precision': 0.5222443129804212, 'recall': 0.6699609180733564, 'f1-score': 0.559580615642929, 'support': 319906}, 'weighted avg': {'precision': 0.8554220071774451, 'recall': 0.7641494689064913, 'f1-score': 0.796587396460488, 'support': 319906}}
[[ 14335   4829   3168]
 [ 36052 216861  21735]
 [  1894   7772  13260]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.60669214
{'0': {'precision': 0.23659896787081738, 'recall': 0.6161265850222174, 'f1-score': 0.34190347316193054, 'support': 9227}, '1': {'precision': 0.9441390785472489, 'recall': 0.7602051187286335, 'f1-score': 0.8422469609724889, 'support': 108230}, '2': {'precision': 0.3363977728861841, 'recall': 0.5671250818598559, 'f1-score': 0.4223016905071521, 'support': 9162}, 'accuracy': 0.7357347633451535, 'macro avg': {'precision': 0.5057119397680835, 'recall': 0.6478189285369023, 'f1-score': 0.5354840415471905, 'support': 126619}, 'weighted avg': {'precision': 0.8486036656654687, 'recall': 0.7357347633451535, 'f1-score': 0.7753991108865504, 'support': 126619}}
[[ 5685  1816  1726]
 [17429 82277  8524]
 [  914  3052  5196]]
training model: results/EXC/W9/deepOF_L2/h20
Epoch 1/50
1250/1250 - 31s - loss: 2.5721 - accuracy20: 0.5478 - val_loss: 2.8656 - val_accuracy20: 0.7917 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.2158 - accuracy20: 0.6055 - val_loss: 2.8423 - val_accuracy20: 0.7918 - 28s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 28s - loss: 2.0963 - accuracy20: 0.6243 - val_loss: 2.9699 - val_accuracy20: 0.7411 - 28s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.0349 - accuracy20: 0.6357 - val_loss: 2.8294 - val_accuracy20: 0.7621 - 28s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.0033 - accuracy20: 0.6431 - val_loss: 2.9752 - val_accuracy20: 0.7482 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 28s - loss: 1.9772 - accuracy20: 0.6485 - val_loss: 2.8536 - val_accuracy20: 0.7487 - 28s/epoch - 22ms/step
Epoch 7/50
1250/1250 - 28s - loss: 1.9556 - accuracy20: 0.6513 - val_loss: 2.8369 - val_accuracy20: 0.7243 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 1.9387 - accuracy20: 0.6535 - val_loss: 2.7783 - val_accuracy20: 0.7220 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 1.9278 - accuracy20: 0.6529 - val_loss: 2.7880 - val_accuracy20: 0.7197 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 28s - loss: 1.9146 - accuracy20: 0.6531 - val_loss: 2.7016 - val_accuracy20: 0.7217 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 1.8996 - accuracy20: 0.6559 - val_loss: 2.6520 - val_accuracy20: 0.7129 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 28s - loss: 1.8891 - accuracy20: 0.6559 - val_loss: 2.6831 - val_accuracy20: 0.6932 - 28s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 1.8763 - accuracy20: 0.6568 - val_loss: 2.7377 - val_accuracy20: 0.6873 - 28s/epoch - 23ms/step
Epoch 14/50
1250/1250 - 28s - loss: 1.8647 - accuracy20: 0.6569 - val_loss: 2.8670 - val_accuracy20: 0.6921 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 28s - loss: 1.8555 - accuracy20: 0.6583 - val_loss: 2.7887 - val_accuracy20: 0.6952 - 28s/epoch - 23ms/step
Epoch 16/50
1250/1250 - 29s - loss: 1.8470 - accuracy20: 0.6588 - val_loss: 2.7616 - val_accuracy20: 0.6729 - 29s/epoch - 23ms/step
Epoch 17/50
1250/1250 - 28s - loss: 1.8346 - accuracy20: 0.6594 - val_loss: 2.8213 - val_accuracy20: 0.6806 - 28s/epoch - 23ms/step
Epoch 18/50
1250/1250 - 28s - loss: 1.8221 - accuracy20: 0.6613 - val_loss: 2.7802 - val_accuracy20: 0.6834 - 28s/epoch - 23ms/step
Epoch 19/50
1250/1250 - 28s - loss: 1.8144 - accuracy20: 0.6609 - val_loss: 2.8788 - val_accuracy20: 0.6739 - 28s/epoch - 23ms/step
Epoch 20/50
1250/1250 - 28s - loss: 1.8055 - accuracy20: 0.6618 - val_loss: 2.8475 - val_accuracy20: 0.6658 - 28s/epoch - 22ms/step
Epoch 21/50
1250/1250 - 28s - loss: 1.7930 - accuracy20: 0.6646 - val_loss: 2.9071 - val_accuracy20: 0.6913 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h20
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6695489
{'0': {'precision': 0.2925676481896403, 'recall': 0.6999222925289817, 'f1-score': 0.412648250908088, 'support': 63057}, '1': {'precision': 0.8953837225439361, 'recall': 0.7429692472613982, 'f1-score': 0.8120869954264124, 'support': 477616}, '2': {'precision': 0.4673151116665761, 'recall': 0.4181184668989547, 'f1-score': 0.4413500521751031, 'support': 61705}, 'accuracy': 0.705186776409497, 'macro avg': {'precision': 0.5517554941333841, 'recall': 0.6203366688964449, 'f1-score': 0.5553617661698678, 'support': 602378}, 'weighted avg': {'precision': 0.7884313656604736, 'recall': 0.705186776409497, 'f1-score': 0.7322970097423169, 'support': 602378}}
[[ 44135  13890   5032]
 [ 98385 354854  24377]
 [  8334  27571  25800]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6102151
{'0': {'precision': 0.32315256961845773, 'recall': 0.6484819734345351, 'f1-score': 0.43135274999211126, 'support': 31620}, '1': {'precision': 0.8987754371040318, 'recall': 0.7850703773666076, 'f1-score': 0.8380838263352802, 'support': 255693}, '2': {'precision': 0.4749607345656639, 'recall': 0.4824655600895898, 'f1-score': 0.47868373388532903, 'support': 32593}, 'accuracy': 0.7407394672184955, 'macro avg': {'precision': 0.5656295804293845, 'recall': 0.6386726369635775, 'f1-score': 0.5827067700709069, 'support': 319906}, 'weighted avg': {'precision': 0.7987004536097339, 'recall': 0.7407394672184955, 'f1-score': 0.7612651238189403, 'support': 319906}}
[[ 20505   8579   2536]
 [ 40109 200737  14847]
 [  2839  14029  15725]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.65660197
{'0': {'precision': 0.2871057829848103, 'recall': 0.6533870717718183, 'f1-score': 0.3989210675752413, 'support': 12902}, '1': {'precision': 0.8992793817854264, 'recall': 0.75280040480608, 'f1-score': 0.8195462327379957, 'support': 100789}, '2': {'precision': 0.45890570430733413, 'recall': 0.4573793316831683, 'f1-score': 0.4581412466586604, 'support': 12928}, 'accuracy': 0.7125076015447919, 'macro avg': {'precision': 0.5484302896925236, 'recall': 0.6211889360870222, 'f1-score': 0.5588695156572991, 'support': 126619}, 'weighted avg': {'precision': 0.7919383454941721, 'recall': 0.7125076015447919, 'f1-score': 0.7397860897818557, 'support': 126619}}
[[ 8430  3061  1411]
 [19354 75874  5561]
 [ 1578  5437  5913]]
training model: results/EXC/W9/deepOF_L2/h30
Epoch 1/50
1250/1250 - 31s - loss: 2.6214 - accuracy30: 0.5314 - val_loss: 2.8273 - val_accuracy30: 0.7463 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.2882 - accuracy30: 0.5891 - val_loss: 2.8307 - val_accuracy30: 0.7322 - 28s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 28s - loss: 2.1796 - accuracy30: 0.6061 - val_loss: 2.8829 - val_accuracy30: 0.7275 - 28s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.1179 - accuracy30: 0.6149 - val_loss: 2.8435 - val_accuracy30: 0.7289 - 28s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.0793 - accuracy30: 0.6225 - val_loss: 2.7247 - val_accuracy30: 0.7193 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 2.0544 - accuracy30: 0.6278 - val_loss: 2.7357 - val_accuracy30: 0.7245 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 2.0365 - accuracy30: 0.6318 - val_loss: 2.7301 - val_accuracy30: 0.7084 - 28s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.0188 - accuracy30: 0.6336 - val_loss: 2.7431 - val_accuracy30: 0.7111 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 2.0051 - accuracy30: 0.6355 - val_loss: 2.7233 - val_accuracy30: 0.6836 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 28s - loss: 1.9908 - accuracy30: 0.6382 - val_loss: 2.6969 - val_accuracy30: 0.6922 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 1.9787 - accuracy30: 0.6382 - val_loss: 2.6907 - val_accuracy30: 0.6941 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 1.9675 - accuracy30: 0.6399 - val_loss: 2.7204 - val_accuracy30: 0.6891 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 28s - loss: 1.9533 - accuracy30: 0.6414 - val_loss: 2.6946 - val_accuracy30: 0.6746 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 1.9448 - accuracy30: 0.6403 - val_loss: 2.7558 - val_accuracy30: 0.6918 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 28s - loss: 1.9305 - accuracy30: 0.6426 - val_loss: 2.6816 - val_accuracy30: 0.6926 - 28s/epoch - 22ms/step
Epoch 16/50
1250/1250 - 28s - loss: 1.9191 - accuracy30: 0.6435 - val_loss: 2.7220 - val_accuracy30: 0.6914 - 28s/epoch - 22ms/step
Epoch 17/50
1250/1250 - 28s - loss: 1.9092 - accuracy30: 0.6434 - val_loss: 2.6909 - val_accuracy30: 0.6877 - 28s/epoch - 23ms/step
Epoch 18/50
1250/1250 - 28s - loss: 1.8953 - accuracy30: 0.6450 - val_loss: 2.7308 - val_accuracy30: 0.6723 - 28s/epoch - 23ms/step
Epoch 19/50
1250/1250 - 28s - loss: 1.8856 - accuracy30: 0.6439 - val_loss: 2.6333 - val_accuracy30: 0.6889 - 28s/epoch - 23ms/step
Epoch 20/50
1250/1250 - 28s - loss: 1.8792 - accuracy30: 0.6454 - val_loss: 2.6963 - val_accuracy30: 0.6759 - 28s/epoch - 23ms/step
Epoch 21/50
1250/1250 - 28s - loss: 1.8620 - accuracy30: 0.6463 - val_loss: 2.7356 - val_accuracy30: 0.6766 - 28s/epoch - 22ms/step
Epoch 22/50
1250/1250 - 28s - loss: 1.8519 - accuracy30: 0.6482 - val_loss: 2.7857 - val_accuracy30: 0.6734 - 28s/epoch - 22ms/step
Epoch 23/50
1250/1250 - 28s - loss: 1.8449 - accuracy30: 0.6480 - val_loss: 2.7340 - val_accuracy30: 0.6601 - 28s/epoch - 23ms/step
Epoch 24/50
1250/1250 - 28s - loss: 1.8347 - accuracy30: 0.6486 - val_loss: 2.8057 - val_accuracy30: 0.6389 - 28s/epoch - 22ms/step
Epoch 25/50
1250/1250 - 28s - loss: 1.8283 - accuracy30: 0.6494 - val_loss: 2.8131 - val_accuracy30: 0.6848 - 28s/epoch - 22ms/step
Epoch 26/50
1250/1250 - 28s - loss: 1.8187 - accuracy30: 0.6507 - val_loss: 2.8375 - val_accuracy30: 0.6711 - 28s/epoch - 23ms/step
Epoch 27/50
1250/1250 - 28s - loss: 1.8061 - accuracy30: 0.6527 - val_loss: 2.8602 - val_accuracy30: 0.6732 - 28s/epoch - 23ms/step
Epoch 28/50
1250/1250 - 28s - loss: 1.7966 - accuracy30: 0.6548 - val_loss: 2.8706 - val_accuracy30: 0.6679 - 28s/epoch - 22ms/step
Epoch 29/50
1250/1250 - 28s - loss: 1.7847 - accuracy30: 0.6557 - val_loss: 2.8465 - val_accuracy30: 0.6537 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h30
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.696939
{'0': {'precision': 0.33152633822621796, 'recall': 0.6785653821610429, 'f1-score': 0.44542944339485546, 'support': 76787}, '1': {'precision': 0.8611407571750777, 'recall': 0.7273102685757293, 'f1-score': 0.7885877565365593, 'support': 450413}, '2': {'precision': 0.494683395836227, 'recall': 0.4263747372901647, 'f1-score': 0.45799607072691556, 'support': 75178}, 'accuracy': 0.6835392394808575, 'macro avg': {'precision': 0.5624501637458409, 'recall': 0.6107501293423123, 'f1-score': 0.5640044235527767, 'support': 602378}, 'weighted avg': {'precision': 0.7478945332117886, 'recall': 0.6835392394808575, 'f1-score': 0.7035857824488446, 'support': 602378}}
[[ 52105  18248   6434]
 [ 96514 327590  26309]
 [  8548  34576  32054]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.62343687
{'0': {'precision': 0.3799453027677945, 'recall': 0.6800010250627851, 'f1-score': 0.48750241133188194, 'support': 39022}, '1': {'precision': 0.8696587721812177, 'recall': 0.7693772028995145, 'f1-score': 0.8164502107220123, 'support': 240592}, '2': {'precision': 0.5280240743726154, 'recall': 0.4877395016380423, 'f1-score': 0.5070829570378016, 'support': 40292}, 'accuracy': 0.7230030071333454, 'macro avg': {'precision': 0.5925427164405425, 'recall': 0.6457059098667807, 'f1-score': 0.6036785263638986, 'support': 319906}, 'weighted avg': {'precision': 0.7668950095523367, 'recall': 0.7230030071333454, 'f1-score': 0.7373606456208704, 'support': 319906}}
[[ 26535   9799   2688]
 [ 40608 185106  14878]
 [  2696  17944  19652]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.68220526
{'0': {'precision': 0.32380501656412686, 'recall': 0.6551966292134831, 'f1-score': 0.43341286767034776, 'support': 15664}, '1': {'precision': 0.8680533918267134, 'recall': 0.7320021019442985, 'f1-score': 0.7942435870389482, 'support': 95150}, '2': {'precision': 0.501191529924423, 'recall': 0.46573869028788356, 'f1-score': 0.48281516463334645, 'support': 15805}, 'accuracy': 0.6892646443266808, 'macro avg': {'precision': 0.564349979438421, 'recall': 0.617645807148555, 'f1-score': 0.5701572064475474, 'support': 126619}, 'weighted avg': {'precision': 0.7549316780437988, 'recall': 0.6892646443266808, 'f1-score': 0.7107318028334948, 'support': 126619}}
[[10263  3736  1665]
 [19839 69650  5661]
 [ 1593  6851  7361]]
training model: results/EXC/W9/deepOF_L2/h50
Epoch 1/50
1250/1250 - 31s - loss: 2.7501 - accuracy50: 0.5022 - val_loss: 2.9956 - val_accuracy50: 0.6992 - 31s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.4802 - accuracy50: 0.5572 - val_loss: 3.0498 - val_accuracy50: 0.6937 - 28s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 28s - loss: 2.3759 - accuracy50: 0.5737 - val_loss: 2.9634 - val_accuracy50: 0.7059 - 28s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.3164 - accuracy50: 0.5865 - val_loss: 3.0644 - val_accuracy50: 0.7013 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.2802 - accuracy50: 0.5951 - val_loss: 3.0663 - val_accuracy50: 0.7065 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 28s - loss: 2.2556 - accuracy50: 0.5997 - val_loss: 3.1589 - val_accuracy50: 0.6963 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 2.2390 - accuracy50: 0.6029 - val_loss: 3.1153 - val_accuracy50: 0.6818 - 28s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.2233 - accuracy50: 0.6060 - val_loss: 3.0765 - val_accuracy50: 0.6910 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 2.2103 - accuracy50: 0.6092 - val_loss: 3.0985 - val_accuracy50: 0.6838 - 28s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 28s - loss: 2.1988 - accuracy50: 0.6100 - val_loss: 3.0186 - val_accuracy50: 0.6852 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.1837 - accuracy50: 0.6125 - val_loss: 3.0470 - val_accuracy50: 0.6794 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 2.1721 - accuracy50: 0.6151 - val_loss: 3.0372 - val_accuracy50: 0.6717 - 28s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 2.1610 - accuracy50: 0.6151 - val_loss: 3.0687 - val_accuracy50: 0.6546 - 28s/epoch - 22ms/step
testing model: results/EXC/W9/deepOF_L2/h50
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.742313
{'0': {'precision': 0.5196820539208384, 'recall': 0.3815555312527962, 'f1-score': 0.44003393872683905, 'support': 100583}, '1': {'precision': 0.7471530212626356, 'recall': 0.9030315496266632, 'f1-score': 0.8177300436586168, 'support': 403523}, '2': {'precision': 0.6565324971214386, 'recall': 0.27270229566916315, 'f1-score': 0.3853448461798391, 'support': 98272}, 'accuracy': 0.7131253133414567, 'macro avg': {'precision': 0.6411225241016375, 'recall': 0.5190964588495408, 'f1-score': 0.5477029428550982, 'support': 602378}, 'weighted avg': {'precision': 0.6943868637061783, 'recall': 0.7131253133414567, 'f1-score': 0.6841242920392226, 'support': 602378}}
[[ 38378  58220   3985]
 [ 29094 364394  10035]
 [  6377  65096  26799]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7231774
{'0': {'precision': 0.5300254013662482, 'recall': 0.4139764234532707, 'f1-score': 0.46486778781160437, 'support': 51916}, '1': {'precision': 0.7506426128994222, 'recall': 0.891478983359395, 'f1-score': 0.8150213905454855, 'support': 214235}, '2': {'precision': 0.6648613952742006, 'recall': 0.30830620407403964, 'f1-score': 0.42126534658498765, 'support': 53755}, 'accuracy': 0.7159946984426675, 'macro avg': {'precision': 0.648509803179957, 'recall': 0.5379205369622351, 'f1-score': 0.5670515083140258, 'support': 319906}, 'weighted avg': {'precision': 0.7004255725581968, 'recall': 0.7159946984426675, 'f1-score': 0.6920323544454162, 'support': 319906}}
[[ 21492  28592   1832]
 [ 16727 190986   6522]
 [  2330  34852  16573]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.74122465
{'0': {'precision': 0.47777040477770405, 'recall': 0.4213400955817809, 'f1-score': 0.4477844001036538, 'support': 20506}, '1': {'precision': 0.7559047946730353, 'recall': 0.8742933389515082, 'f1-score': 0.8108002496540122, 'support': 85437}, '2': {'precision': 0.6335288669342389, 'recall': 0.2977365060940221, 'f1-score': 0.4050932780574475, 'support': 20676}, 'accuracy': 0.7067896603195413, 'macro avg': {'precision': 0.6224013554616594, 'recall': 0.531123313542437, 'f1-score': 0.5545593092717045, 'support': 126619}, 'weighted avg': {'precision': 0.6908776780387149, 'recall': 0.7067896603195413, 'f1-score': 0.6857605608584111, 'support': 126619}}
[[ 8640 10799  1067]
 [ 8246 74697  2494]
 [ 1198 13322  6156]]
training model: results/EXC/W9/deepOF_L2/h100
Epoch 1/50
1250/1250 - 30s - loss: 2.9929 - accuracy100: 0.4684 - val_loss: 3.0911 - val_accuracy100: 0.5658 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.8148 - accuracy100: 0.5149 - val_loss: 3.1216 - val_accuracy100: 0.5582 - 28s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 28s - loss: 2.7308 - accuracy100: 0.5327 - val_loss: 3.1398 - val_accuracy100: 0.5663 - 28s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.6859 - accuracy100: 0.5460 - val_loss: 3.1525 - val_accuracy100: 0.5613 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.6580 - accuracy100: 0.5544 - val_loss: 3.1738 - val_accuracy100: 0.5667 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 2.6398 - accuracy100: 0.5589 - val_loss: 3.1319 - val_accuracy100: 0.5628 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 2.6257 - accuracy100: 0.5610 - val_loss: 3.0816 - val_accuracy100: 0.5658 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.6100 - accuracy100: 0.5656 - val_loss: 3.1117 - val_accuracy100: 0.5651 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 2.5986 - accuracy100: 0.5672 - val_loss: 3.0967 - val_accuracy100: 0.5667 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 28s - loss: 2.5848 - accuracy100: 0.5691 - val_loss: 3.0882 - val_accuracy100: 0.5657 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.5705 - accuracy100: 0.5723 - val_loss: 3.1408 - val_accuracy100: 0.5535 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 2.5610 - accuracy100: 0.5733 - val_loss: 3.0919 - val_accuracy100: 0.5701 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 28s - loss: 2.5481 - accuracy100: 0.5760 - val_loss: 3.0991 - val_accuracy100: 0.5720 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 2.5376 - accuracy100: 0.5785 - val_loss: 3.1045 - val_accuracy100: 0.5744 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 28s - loss: 2.5216 - accuracy100: 0.5806 - val_loss: 3.2011 - val_accuracy100: 0.5611 - 28s/epoch - 23ms/step
Epoch 16/50
1250/1250 - 28s - loss: 2.5085 - accuracy100: 0.5829 - val_loss: 3.1758 - val_accuracy100: 0.5643 - 28s/epoch - 22ms/step
Epoch 17/50
1250/1250 - 28s - loss: 2.4972 - accuracy100: 0.5849 - val_loss: 3.2641 - val_accuracy100: 0.5556 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h100
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.95069927
{'0': {'precision': 0.4670314785718156, 'recall': 0.47304156948827, 'f1-score': 0.47001731212257525, 'support': 145780}, '1': {'precision': 0.5894399960761714, 'recall': 0.7680899134930957, 'f1-score': 0.6670098572475192, 'support': 312923}, '2': {'precision': 0.6397342249291905, 'recall': 0.20908299982599618, 'f1-score': 0.3151621973225901, 'support': 143675}, 'accuracy': 0.5633555674344016, 'macro avg': {'precision': 0.5654018998590592, 'recall': 0.483404827602454, 'f1-score': 0.4840631222308948, 'support': 602378}, 'weighted avg': {'precision': 0.5718120442729391, 'recall': 0.5633555674344016, 'f1-score': 0.5354159315596146, 'support': 602378}}
[[ 68960  70522   6298]
 [ 61951 240353  10619]
 [ 16745  96890  30040]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.92096174
{'0': {'precision': 0.5234603030258584, 'recall': 0.46217301217301215, 'f1-score': 0.49091121672088534, 'support': 77220}, '1': {'precision': 0.5828795060691485, 'recall': 0.7997719666041414, 'f1-score': 0.6743140958883224, 'support': 163134}, '2': {'precision': 0.6566152742918608, 'recall': 0.2302016291230893, 'f1-score': 0.3408908992758884, 'support': 79552}, 'accuracy': 0.5766443892893538, 'macro avg': {'precision': 0.5876516944622893, 'recall': 0.49738220263341426, 'f1-score': 0.502038737295032, 'support': 319906}, 'weighted avg': {'precision': 0.5868727946434497, 'recall': 0.5766443892893538, 'f1-score': 0.5471303216977107, 'support': 319906}}
[[ 35689  38153   3378]
 [ 26465 130470   6199]
 [  6025  55214  18313]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.93434525
{'0': {'precision': 0.4669448428739079, 'recall': 0.4752488387524884, 'f1-score': 0.47106024730334123, 'support': 30140}, '1': {'precision': 0.5952681127829293, 'recall': 0.7606751385208383, 'f1-score': 0.6678828980679106, 'support': 66416}, '2': {'precision': 0.6192196531791907, 'recall': 0.22805441905332136, 'f1-score': 0.33334143673270933, 'support': 30063}, 'accuracy': 0.5662736240216714, 'macro avg': {'precision': 0.560477536278676, 'recall': 0.4879927987755494, 'f1-score': 0.49076152736798706, 'support': 126619}, 'weighted avg': {'precision': 0.5704092195984539, 'recall': 0.5662736240216714, 'f1-score': 0.5416020504371105, 'support': 126619}}
[[14324 14048  1768]
 [13447 50521  2448]
 [ 2905 20302  6856]]
training model: results/EXC/W9/deepOF_L2/h200
Epoch 1/50
1250/1250 - 30s - loss: 3.1785 - accuracy200: 0.4263 - val_loss: 3.2014 - val_accuracy200: 0.4325 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 28s - loss: 3.0910 - accuracy200: 0.4562 - val_loss: 3.1798 - val_accuracy200: 0.4400 - 28s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 28s - loss: 3.0419 - accuracy200: 0.4706 - val_loss: 3.1789 - val_accuracy200: 0.4456 - 28s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 28s - loss: 3.0101 - accuracy200: 0.4789 - val_loss: 3.1761 - val_accuracy200: 0.4459 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.9915 - accuracy200: 0.4839 - val_loss: 3.1616 - val_accuracy200: 0.4498 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 2.9761 - accuracy200: 0.4880 - val_loss: 3.1684 - val_accuracy200: 0.4493 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 2.9673 - accuracy200: 0.4899 - val_loss: 3.1757 - val_accuracy200: 0.4494 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.9573 - accuracy200: 0.4927 - val_loss: 3.1840 - val_accuracy200: 0.4468 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 28s - loss: 2.9503 - accuracy200: 0.4943 - val_loss: 3.1870 - val_accuracy200: 0.4487 - 28s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 28s - loss: 2.9403 - accuracy200: 0.4970 - val_loss: 3.1878 - val_accuracy200: 0.4455 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.9334 - accuracy200: 0.4977 - val_loss: 3.2151 - val_accuracy200: 0.4439 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 28s - loss: 2.9244 - accuracy200: 0.5008 - val_loss: 3.2539 - val_accuracy200: 0.4410 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 28s - loss: 2.9153 - accuracy200: 0.5031 - val_loss: 3.2476 - val_accuracy200: 0.4393 - 28s/epoch - 23ms/step
Epoch 14/50
1250/1250 - 28s - loss: 2.9044 - accuracy200: 0.5050 - val_loss: 3.3045 - val_accuracy200: 0.4353 - 28s/epoch - 23ms/step
Epoch 15/50
1250/1250 - 28s - loss: 2.8959 - accuracy200: 0.5077 - val_loss: 3.3333 - val_accuracy200: 0.4361 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h200
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0585078
{'0': {'precision': 0.4934086972376698, 'recall': 0.28532567150802646, 'f1-score': 0.36156659707724426, 'support': 189685}, '1': {'precision': 0.4093682102157359, 'recall': 0.794112672796703, 'f1-score': 0.5402403779920459, 'support': 224686}, '2': {'precision': 0.575865284791751, 'recall': 0.17407330578116773, 'f1-score': 0.2673359527524322, 'support': 188007}, 'accuracy': 0.4403796287381013, 'macro avg': {'precision': 0.49288073074838556, 'recall': 0.417837216695299, 'f1-score': 0.3897143092739075, 'support': 602378}, 'weighted avg': {'precision': 0.48779709586655384, 'recall': 0.4403796287381013, 'f1-score': 0.39880148346261723, 'support': 602378}}
[[ 54122 123661  11902]
 [ 34058 178426  12202]
 [ 21510 133770  32727]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0456878
{'0': {'precision': 0.5395496189742273, 'recall': 0.30943518527612185, 'f1-score': 0.3933065361761622, 'support': 101821}, '1': {'precision': 0.39497554488298214, 'recall': 0.7819120090964751, 'f1-score': 0.524835394510117, 'support': 114330}, '2': {'precision': 0.600375234521576, 'recall': 0.20355645511059708, 'f1-score': 0.30403143961477835, 'support': 103755}, 'accuracy': 0.4439522859840078, 'macro avg': {'precision': 0.5116334661262618, 'recall': 0.43163454982773136, 'f1-score': 0.40739112343368583, 'support': 319906}, 'weighted avg': {'precision': 0.5076083857690454, 'recall': 0.4439522859840078, 'f1-score': 0.4113585787436497, 'support': 319906}}
[[31507 64194  6120]
 [16996 89396  7938]
 [ 9892 72743 21120]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0460784
{'0': {'precision': 0.5110238489804741, 'recall': 0.35359074706483534, 'f1-score': 0.41797421731123385, 'support': 40117}, '1': {'precision': 0.41112200588317693, 'recall': 0.7491863606389993, 'f1-score': 0.5309054183405061, 'support': 47011}, '2': {'precision': 0.5769726370044721, 'recall': 0.19275277911422856, 'f1-score': 0.28896818768506566, 'support': 39491}, 'accuracy': 0.4503036669062305, 'macro avg': {'precision': 0.4997061639560411, 'recall': 0.431843295606021, 'f1-score': 0.4126159411122685, 'support': 126619}, 'weighted avg': {'precision': 0.4945010367801619, 'recall': 0.4503036669062305, 'f1-score': 0.4196677354690151, 'support': 126619}}
[[14185 23288  2644]
 [ 8854 35220  2937]
 [ 4719 27160  7612]]
training model: results/EXC/W9/deepOF_L2/h300
Epoch 1/50
1250/1250 - 30s - loss: 3.2356 - accuracy300: 0.4006 - val_loss: 3.2262 - val_accuracy300: 0.3977 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 28s - loss: 3.1808 - accuracy300: 0.4239 - val_loss: 3.2050 - val_accuracy300: 0.4057 - 28s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 28s - loss: 3.1544 - accuracy300: 0.4325 - val_loss: 3.2061 - val_accuracy300: 0.4111 - 28s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 3.1331 - accuracy300: 0.4404 - val_loss: 3.1968 - val_accuracy300: 0.4146 - 28s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.1175 - accuracy300: 0.4445 - val_loss: 3.1931 - val_accuracy300: 0.4176 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 28s - loss: 3.1059 - accuracy300: 0.4478 - val_loss: 3.1806 - val_accuracy300: 0.4187 - 28s/epoch - 22ms/step
Epoch 7/50
1250/1250 - 28s - loss: 3.0965 - accuracy300: 0.4524 - val_loss: 3.1749 - val_accuracy300: 0.4183 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 3.0891 - accuracy300: 0.4538 - val_loss: 3.1759 - val_accuracy300: 0.4190 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 3.0838 - accuracy300: 0.4557 - val_loss: 3.1819 - val_accuracy300: 0.4179 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 28s - loss: 3.0787 - accuracy300: 0.4576 - val_loss: 3.1834 - val_accuracy300: 0.4165 - 28s/epoch - 22ms/step
Epoch 11/50
1250/1250 - 28s - loss: 3.0722 - accuracy300: 0.4595 - val_loss: 3.1844 - val_accuracy300: 0.4168 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 28s - loss: 3.0674 - accuracy300: 0.4612 - val_loss: 3.1863 - val_accuracy300: 0.4164 - 28s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 3.0619 - accuracy300: 0.4637 - val_loss: 3.1870 - val_accuracy300: 0.4152 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 3.0547 - accuracy300: 0.4660 - val_loss: 3.2069 - val_accuracy300: 0.4123 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 28s - loss: 3.0499 - accuracy300: 0.4678 - val_loss: 3.2045 - val_accuracy300: 0.4132 - 28s/epoch - 23ms/step
Epoch 16/50
1250/1250 - 28s - loss: 3.0414 - accuracy300: 0.4710 - val_loss: 3.2108 - val_accuracy300: 0.4132 - 28s/epoch - 23ms/step
Epoch 17/50
1250/1250 - 28s - loss: 3.0333 - accuracy300: 0.4742 - val_loss: 3.2041 - val_accuracy300: 0.4120 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h300
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0686855
{'0': {'precision': 0.43899677291513334, 'recall': 0.39393000299740394, 'f1-score': 0.4152441848945154, 'support': 196837}, '1': {'precision': 0.378085951119659, 'recall': 0.6409151572926597, 'f1-score': 0.4756050112831686, 'support': 209800}, '2': {'precision': 0.5252339381490357, 'recall': 0.1881108199099831, 'f1-score': 0.27701104026782525, 'support': 195741}, 'accuracy': 0.4130711944991351, 'macro avg': {'precision': 0.44743888739460935, 'recall': 0.40765199340001557, 'f1-score': 0.38928674548183645, 'support': 602378}, 'weighted avg': {'precision': 0.4458048876659356, 'recall': 0.4130711944991351, 'f1-score': 0.3913485702040162, 'support': 602378}}
[[ 77540 103962  15335]
 [ 57388 134464  17948]
 [ 41702 117218  36821]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0581843
{'0': {'precision': 0.477384328481732, 'recall': 0.4065022316185107, 'f1-score': 0.4391011327189315, 'support': 106425}, '1': {'precision': 0.36108654247901417, 'recall': 0.6333577621898407, 'f1-score': 0.4599492669979748, 'support': 105067}, '2': {'precision': 0.5478751778093883, 'recall': 0.22736915896470936, 'f1-score': 0.32136943796200934, 'support': 108414}, 'accuracy': 0.4203015885916488, 'macro avg': {'precision': 0.4621153495900449, 'recall': 0.42240971759102025, 'f1-score': 0.40680661255963857, 'support': 319906}, 'weighted avg': {'precision': 0.46307742413189484, 'recall': 0.4203015885916488, 'f1-score': 0.40604982067389106, 'support': 319906}}
[[43262 54141  9022]
 [27202 66545 11320]
 [20159 63605 24650]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0601038
{'0': {'precision': 0.46125317196954907, 'recall': 0.4425508006367637, 'f1-score': 0.45170848267622465, 'support': 42716}, '1': {'precision': 0.36684311003123915, 'recall': 0.596262341325811, 'f1-score': 0.454228000429784, 'support': 42540}, '2': {'precision': 0.5256806743071979, 'recall': 0.20958344414089888, 'f1-score': 0.29968541501019813, 'support': 41363}, 'accuracy': 0.41808891240651086, 'macro avg': {'precision': 0.45125898543599535, 'recall': 0.41613219536782453, 'f1-score': 0.4018739660387356, 'support': 126619}, 'weighted avg': {'precision': 0.4505810828228686, 'recall': 0.41808891240651086, 'f1-score': 0.4028931400923041, 'support': 126619}}
[[18904 20216  3596]
 [12949 25365  4226]
 [ 9131 23563  8669]]
training model: results/EXC/W9/deepOF_L2/h500
Epoch 1/50
1250/1250 - 31s - loss: 3.2777 - accuracy500: 0.3792 - val_loss: 3.2677 - val_accuracy500: 0.3778 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 29s - loss: 3.2502 - accuracy500: 0.3956 - val_loss: 3.2563 - val_accuracy500: 0.3857 - 29s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 29s - loss: 3.2361 - accuracy500: 0.4020 - val_loss: 3.2543 - val_accuracy500: 0.3882 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 3.2261 - accuracy500: 0.4066 - val_loss: 3.2511 - val_accuracy500: 0.3897 - 28s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.2178 - accuracy500: 0.4112 - val_loss: 3.2538 - val_accuracy500: 0.3893 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 3.2108 - accuracy500: 0.4154 - val_loss: 3.2517 - val_accuracy500: 0.3908 - 28s/epoch - 22ms/step
Epoch 7/50
1250/1250 - 28s - loss: 3.2033 - accuracy500: 0.4194 - val_loss: 3.2557 - val_accuracy500: 0.3899 - 28s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 3.1974 - accuracy500: 0.4211 - val_loss: 3.2581 - val_accuracy500: 0.3885 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 28s - loss: 3.1921 - accuracy500: 0.4237 - val_loss: 3.2548 - val_accuracy500: 0.3900 - 28s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 28s - loss: 3.1874 - accuracy500: 0.4266 - val_loss: 3.2628 - val_accuracy500: 0.3868 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 3.1827 - accuracy500: 0.4287 - val_loss: 3.2629 - val_accuracy500: 0.3891 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 3.1783 - accuracy500: 0.4308 - val_loss: 3.2645 - val_accuracy500: 0.3896 - 28s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 3.1739 - accuracy500: 0.4326 - val_loss: 3.2680 - val_accuracy500: 0.3879 - 28s/epoch - 23ms/step
Epoch 14/50
1250/1250 - 28s - loss: 3.1695 - accuracy500: 0.4340 - val_loss: 3.2769 - val_accuracy500: 0.3869 - 28s/epoch - 22ms/step
testing model: results/EXC/W9/deepOF_L2/h500
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0887847
{'0': {'precision': 0.35751097038590085, 'recall': 0.7671476737721057, 'f1-score': 0.4877279176294134, 'support': 196047}, '1': {'precision': 0.4312644347807994, 'recall': 0.09935812932327943, 'f1-score': 0.1615069934156699, 'support': 208609}, '2': {'precision': 0.41854548447683687, 'recall': 0.2828921414915892, 'f1-score': 0.3376015885997447, 'support': 197722}, 'accuracy': 0.37693607668274737, 'macro avg': {'precision': 0.4024402965478457, 'recall': 0.3831326481956581, 'f1-score': 0.3289454998816093, 'support': 602378}, 'weighted avg': {'precision': 0.4030861783932375, 'recall': 0.37693607668274737, 'f1-score': 0.3254778042326609, 'support': 602378}}
[[150397  13350  32300]
 [142477  20727  45405]
 [127804  13984  55934]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0837198
{'0': {'precision': 0.3697507475715533, 'recall': 0.7541100041668245, 'f1-score': 0.49620513459621135, 'support': 105596}, '1': {'precision': 0.42813355674526954, 'recall': 0.09927505330490405, 'f1-score': 0.16117666969244734, 'support': 105525}, '2': {'precision': 0.43938655976421515, 'recall': 0.3234177506089994, 'f1-score': 0.372586811255017, 'support': 108785}, 'accuracy': 0.3916462960994792, 'macro avg': {'precision': 0.412423621360346, 'recall': 0.392267602693576, 'f1-score': 0.34332287184789195, 'support': 319906}, 'weighted avg': {'precision': 0.4126889161818173, 'recall': 0.3916462960994792, 'f1-score': 0.3436550165501555, 'support': 319906}}
[[79631  6721 19244]
 [69403 10476 25646]
 [66330  7272 35183]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0844798
{'0': {'precision': 0.37522706630336056, 'recall': 0.7724128260259886, 'f1-score': 0.5050890974111318, 'support': 42788}, '1': {'precision': 0.42941596167567014, 'recall': 0.09846448687685512, 'f1-score': 0.16019620517890415, 'support': 42787}, '2': {'precision': 0.41920774157616264, 'recall': 0.29341682097261473, 'f1-score': 0.34521011293928794, 'support': 41044}, 'accuracy': 0.3894044337737622, 'macro avg': {'precision': 0.4079502565183977, 'recall': 0.3880980446251528, 'f1-score': 0.33683180517644135, 'support': 126619}, 'weighted avg': {'precision': 0.4077950308441633, 'recall': 0.3894044337737622, 'f1-score': 0.3367178006973473, 'support': 126619}}
[[33050  2804  6934]
 [28823  4213  9751]
 [26207  2794 12043]]
training model: results/EXC/W9/deepOF_L2/h1000
Epoch 1/50
1250/1250 - 31s - loss: 3.2529 - accuracy1000: 0.4080 - val_loss: 3.4191 - val_accuracy1000: 0.3327 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 28s - loss: 3.2411 - accuracy1000: 0.4093 - val_loss: 3.4151 - val_accuracy1000: 0.3324 - 28s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 28s - loss: 3.2596 - accuracy1000: 0.3945 - val_loss: 3.4120 - val_accuracy1000: 0.3353 - 28s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 28s - loss: 3.2640 - accuracy1000: 0.3880 - val_loss: 3.3962 - val_accuracy1000: 0.3397 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.2626 - accuracy1000: 0.3888 - val_loss: 3.3978 - val_accuracy1000: 0.3392 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 3.2602 - accuracy1000: 0.3903 - val_loss: 3.3989 - val_accuracy1000: 0.3401 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 3.2554 - accuracy1000: 0.3936 - val_loss: 3.4005 - val_accuracy1000: 0.3390 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 3.2524 - accuracy1000: 0.3951 - val_loss: 3.4025 - val_accuracy1000: 0.3399 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 28s - loss: 3.2465 - accuracy1000: 0.3985 - val_loss: 3.3976 - val_accuracy1000: 0.3398 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 28s - loss: 3.2404 - accuracy1000: 0.4037 - val_loss: 3.4038 - val_accuracy1000: 0.3404 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 28s - loss: 3.2280 - accuracy1000: 0.4138 - val_loss: 3.4053 - val_accuracy1000: 0.3390 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 28s - loss: 3.2277 - accuracy1000: 0.4119 - val_loss: 3.4046 - val_accuracy1000: 0.3403 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 28s - loss: 3.2211 - accuracy1000: 0.4162 - val_loss: 3.4047 - val_accuracy1000: 0.3397 - 28s/epoch - 23ms/step
Epoch 14/50
1250/1250 - 28s - loss: 3.2177 - accuracy1000: 0.4190 - val_loss: 3.4090 - val_accuracy1000: 0.3391 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepOF_L2/h1000
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1801684
{'0': {'precision': 0.2535774224437054, 'recall': 0.8482537714403803, 'f1-score': 0.39043731223792577, 'support': 145170}, '1': {'precision': 0.4378046196228014, 'recall': 0.0066165355742871055, 'f1-score': 0.013036057381367778, 'support': 312248}, '2': {'precision': 0.29793652493663203, 'recall': 0.23028421633554083, 'f1-score': 0.25977805792905945, 'support': 144960}, 'accuracy': 0.26327156702270005, 'macro avg': {'precision': 0.32977285566771297, 'recall': 0.36171817445006943, 'f1-score': 0.22108380918278434, 'support': 602378}, 'weighted avg': {'precision': 0.3597480816679019, 'recall': 0.26327156702270005, 'f1-score': 0.1633653532170721, 'support': 602378}}
[[123141   1374  20655]
 [252175   2066  58007]
 [110299   1279  33382]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1066957
{'0': {'precision': 0.35441488033382473, 'recall': 0.8215873015873015, 'f1-score': 0.49520786551632934, 'support': 107100}, '1': {'precision': 0.37327935222672065, 'recall': 0.008818915713356544, 'f1-score': 0.017230746229606235, 'support': 104548}, '2': {'precision': 0.40076920852491255, 'recall': 0.25603650538528333, 'f1-score': 0.31245631834066057, 'support': 108258}, 'accuracy': 0.36458209599069724, 'macro avg': {'precision': 0.3761544803618193, 'recall': 0.36214757422864713, 'f1-score': 0.27496497669553205, 'support': 319906}, 'weighted avg': {'precision': 0.3762665169669897, 'recall': 0.36458209599069724, 'f1-score': 0.2771567228014947, 'support': 319906}}
[[87992   756 18352]
 [80534   922 23092]
 [79748   792 27718]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.127567
{'0': {'precision': 0.3364395282280825, 'recall': 0.8383673872273221, 'f1-score': 0.48018091233525306, 'support': 40524}, '1': {'precision': 0.3645640074211503, 'recall': 0.00804783650400344, 'f1-score': 0.015748031496062992, 'support': 48833}, '2': {'precision': 0.3487785016286645, 'recall': 0.2298856744136117, 'f1-score': 0.2771181779948885, 'support': 37262}, 'accuracy': 0.339072335115583, 'macro avg': {'precision': 0.34992734575929907, 'recall': 0.3587669660483124, 'f1-score': 0.25768237394206817, 'support': 126619}, 'weighted avg': {'precision': 0.3509174305909788, 'recall': 0.339072335115583, 'f1-score': 0.24130543174378707, 'support': 126619}}
[[33974   327  6223]
 [38669   393  9771]
 [28338   358  8566]]
training model: results/EXC/W9/deepVOL_L2/h10
Epoch 1/50
1250/1250 - 31s - loss: 2.2533 - accuracy10: 0.5927 - val_loss: 2.3814 - val_accuracy10: 0.7688 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 29s - loss: 2.0367 - accuracy10: 0.6694 - val_loss: 2.2497 - val_accuracy10: 0.7760 - 29s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 28s - loss: 1.9734 - accuracy10: 0.6866 - val_loss: 2.1951 - val_accuracy10: 0.7621 - 28s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 30s - loss: 1.9420 - accuracy10: 0.6957 - val_loss: 2.2065 - val_accuracy10: 0.7628 - 30s/epoch - 24ms/step
Epoch 5/50
1250/1250 - 29s - loss: 1.9201 - accuracy10: 0.6978 - val_loss: 2.1895 - val_accuracy10: 0.7504 - 29s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 29s - loss: 1.9076 - accuracy10: 0.6989 - val_loss: 2.1843 - val_accuracy10: 0.7359 - 29s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 29s - loss: 1.8952 - accuracy10: 0.7017 - val_loss: 2.1649 - val_accuracy10: 0.7431 - 29s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 1.8842 - accuracy10: 0.7005 - val_loss: 2.1838 - val_accuracy10: 0.7420 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 27s - loss: 1.8718 - accuracy10: 0.7018 - val_loss: 2.1782 - val_accuracy10: 0.7395 - 27s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 27s - loss: 1.8656 - accuracy10: 0.7009 - val_loss: 2.2124 - val_accuracy10: 0.7586 - 27s/epoch - 22ms/step
Epoch 11/50
1250/1250 - 27s - loss: 1.8549 - accuracy10: 0.7028 - val_loss: 2.2247 - val_accuracy10: 0.7400 - 27s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 29s - loss: 1.8507 - accuracy10: 0.7034 - val_loss: 2.2223 - val_accuracy10: 0.7429 - 29s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 30s - loss: 1.8420 - accuracy10: 0.7027 - val_loss: 2.2057 - val_accuracy10: 0.7465 - 30s/epoch - 24ms/step
Epoch 14/50
1250/1250 - 30s - loss: 1.8338 - accuracy10: 0.7020 - val_loss: 2.2003 - val_accuracy10: 0.7363 - 30s/epoch - 24ms/step
Epoch 15/50
1250/1250 - 27s - loss: 1.8257 - accuracy10: 0.7018 - val_loss: 2.1874 - val_accuracy10: 0.7475 - 27s/epoch - 22ms/step
Epoch 16/50
1250/1250 - 28s - loss: 1.8213 - accuracy10: 0.7026 - val_loss: 2.1801 - val_accuracy10: 0.7377 - 28s/epoch - 22ms/step
Epoch 17/50
1250/1250 - 31s - loss: 1.8110 - accuracy10: 0.7033 - val_loss: 2.1654 - val_accuracy10: 0.7378 - 31s/epoch - 25ms/step
testing model: results/EXC/W9/deepVOL_L2/h10
Evaluating performance on  test set...
2354/2354 - 25s - 25s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.655764
{'0': {'precision': 0.4089582284851535, 'recall': 0.5358862192521597, 'f1-score': 0.463896632762771, 'support': 45491}, '1': {'precision': 0.9502938192008417, 'recall': 0.7430613362861359, 'f1-score': 0.8339970417567414, 'support': 512959}, '2': {'precision': 0.23041468148932415, 'recall': 0.7430574524264772, 'f1-score': 0.3517539747962091, 'support': 43932}, 'accuracy': 0.7274154938228566, 'macro avg': {'precision': 0.5298889097251065, 'recall': 0.674001669321591, 'f1-score': 0.5498825497719072, 'support': 602382}, 'weighted avg': {'precision': 0.856911832960898, 'recall': 0.7274154938228566, 'f1-score': 0.7708773932226637, 'support': 602382}}
[[ 24378  13705   7408]
 [ 30176 381160 101623]
 [  5056   6232  32644]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6130645
{'0': {'precision': 0.40194161666554307, 'recall': 0.5340618981502218, 'f1-score': 0.4586771296136019, 'support': 22327}, '1': {'precision': 0.9530531934141487, 'recall': 0.7672037431499991, 'f1-score': 0.8500892650010591, 'support': 274635}, '2': {'precision': 0.2525700900796692, 'recall': 0.7612987578993244, 'f1-score': 0.37930210844027534, 'support': 22945}, 'accuracy': 0.7505087416030284, 'macro avg': {'precision': 0.535854966719787, 'recall': 0.6875214663998485, 'f1-score': 0.562689501018312, 'support': 319907}, 'weighted avg': {'precision': 0.8643484980493217, 'recall': 0.7505087416030284, 'f1-score': 0.7890050434801704, 'support': 319907}}
[[ 11924   6853   3550]
 [ 15791 210701  48143]
 [  1951   3526  17468]]
Evaluating performance on  val set...
495/495 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.63754904
{'0': {'precision': 0.36818601786264243, 'recall': 0.5170847750865052, 'f1-score': 0.43011332973556393, 'support': 9248}, '1': {'precision': 0.955818865472101, 'recall': 0.761607530908721, 'f1-score': 0.8477322203294753, 'support': 108141}, '2': {'precision': 0.2582019444343298, 'recall': 0.7682556879739978, 'f1-score': 0.3865042378655329, 'support': 9230}, 'accuracy': 0.7442326980942828, 'macro avg': {'precision': 0.5274022759230245, 'recall': 0.6823159979897414, 'f1-score': 0.554783262643524, 'support': 126619}, 'weighted avg': {'precision': 0.8620459502234346, 'recall': 0.7442326980942828, 'f1-score': 0.7836085597544061, 'support': 126619}}
[[ 4782  2446  2020]
 [ 7428 82361 18352]
 [  778  1361  7091]]
training model: results/EXC/W9/deepVOL_L2/h20
Epoch 1/50
1250/1250 - 31s - loss: 2.3191 - accuracy20: 0.5850 - val_loss: 2.3388 - val_accuracy20: 0.7221 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 28s - loss: 2.1068 - accuracy20: 0.6465 - val_loss: 2.2392 - val_accuracy20: 0.7518 - 28s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 29s - loss: 2.0452 - accuracy20: 0.6587 - val_loss: 2.2386 - val_accuracy20: 0.7318 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 31s - loss: 2.0117 - accuracy20: 0.6637 - val_loss: 2.2173 - val_accuracy20: 0.7428 - 31s/epoch - 24ms/step
Epoch 5/50
1250/1250 - 29s - loss: 1.9896 - accuracy20: 0.6675 - val_loss: 2.2174 - val_accuracy20: 0.7470 - 29s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 29s - loss: 1.9861 - accuracy20: 0.6686 - val_loss: 2.2124 - val_accuracy20: 0.7285 - 29s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 30s - loss: 1.9658 - accuracy20: 0.6728 - val_loss: 2.2327 - val_accuracy20: 0.7539 - 30s/epoch - 24ms/step
Epoch 8/50
1250/1250 - 31s - loss: 1.9560 - accuracy20: 0.6719 - val_loss: 2.2573 - val_accuracy20: 0.7435 - 31s/epoch - 25ms/step
Epoch 9/50
1250/1250 - 30s - loss: 1.9458 - accuracy20: 0.6712 - val_loss: 2.2310 - val_accuracy20: 0.7528 - 30s/epoch - 24ms/step
Epoch 10/50
1250/1250 - 28s - loss: 1.9342 - accuracy20: 0.6735 - val_loss: 2.2357 - val_accuracy20: 0.7643 - 28s/epoch - 22ms/step
Epoch 11/50
1250/1250 - 29s - loss: 1.9254 - accuracy20: 0.6746 - val_loss: 2.2364 - val_accuracy20: 0.7546 - 29s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 29s - loss: 1.9153 - accuracy20: 0.6750 - val_loss: 2.2245 - val_accuracy20: 0.7417 - 29s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 1.9074 - accuracy20: 0.6747 - val_loss: 2.2504 - val_accuracy20: 0.7400 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 1.8994 - accuracy20: 0.6743 - val_loss: 2.2466 - val_accuracy20: 0.7381 - 28s/epoch - 23ms/step
Epoch 15/50
1250/1250 - 27s - loss: 1.8960 - accuracy20: 0.6746 - val_loss: 2.2549 - val_accuracy20: 0.7445 - 27s/epoch - 22ms/step
Epoch 16/50
1250/1250 - 30s - loss: 1.8873 - accuracy20: 0.6750 - val_loss: 2.2470 - val_accuracy20: 0.7418 - 30s/epoch - 24ms/step
testing model: results/EXC/W9/deepVOL_L2/h20
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6931144
{'0': {'precision': 0.43040980961600517, 'recall': 0.5288147419835707, 'f1-score': 0.4745646929902585, 'support': 63058}, '1': {'precision': 0.9122344993416156, 'recall': 0.7339536363940906, 'f1-score': 0.8134402301917878, 'support': 477616}, '2': {'precision': 0.30455156328884403, 'recall': 0.6940753224865496, 'f1-score': 0.4233447497047065, 'support': 61708}, 'accuracy': 0.7083943411323712, 'macro avg': {'precision': 0.5490652907488216, 'recall': 0.6522812336214036, 'f1-score': 0.570449890962251, 'support': 602382}, 'weighted avg': {'precision': 0.7995455413338033, 'recall': 0.7083943411323712, 'f1-score': 0.7380049988356867, 'support': 602382}}
[[ 33346  21214   8498]
 [ 37763 350548  89305]
 [  6366  12512  42830]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.64047235
{'0': {'precision': 0.4437504899783103, 'recall': 0.5368297926150734, 'f1-score': 0.4858724731398161, 'support': 31632}, '1': {'precision': 0.9158918142964341, 'recall': 0.7686359333807918, 'f1-score': 0.8358275612002066, 'support': 255662}, '2': {'precision': 0.3447818374252791, 'recall': 0.7091957194983596, 'f1-score': 0.46399053121489325, 'support': 32613}, 'accuracy': 0.7396555874050896, 'macro avg': {'precision': 0.5681413805666745, 'recall': 0.6715538151647417, 'f1-score': 0.5952301885183053, 'support': 319907}, 'weighted avg': {'precision': 0.8109851256446388, 'recall': 0.7396555874050896, 'f1-score': 0.7633174241777679, 'support': 319907}}
[[ 16981  10967   3684]
 [ 18881 196511  40270]
 [  2405   7079  23129]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6709822
{'0': {'precision': 0.3969022265246854, 'recall': 0.5398497405313298, 'f1-score': 0.45746915200840116, 'support': 12911}, '1': {'precision': 0.9235644768856448, 'recall': 0.7539077240858806, 'f1-score': 0.8301566993624863, 'support': 100698}, '2': {'precision': 0.34764316032467046, 'recall': 0.7176787086856264, 'f1-score': 0.4683957058292364, 'support': 13010}, 'accuracy': 0.7283583032562254, 'macro avg': {'precision': 0.5560366212450002, 'recall': 0.6704787244342789, 'f1-score': 0.5853405190667079, 'support': 126619}, 'weighted avg': {'precision': 0.8106866888532909, 'recall': 0.7283583032562254, 'f1-score': 0.7549840992806961, 'support': 126619}}
[[ 6970  3723  2218]
 [ 9478 75917 15303]
 [ 1113  2560  9337]]
training model: results/EXC/W9/deepVOL_L2/h30
Epoch 1/50
1250/1250 - 30s - loss: 2.4198 - accuracy30: 0.5635 - val_loss: 2.4873 - val_accuracy30: 0.7006 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 29s - loss: 2.2133 - accuracy30: 0.6249 - val_loss: 2.3537 - val_accuracy30: 0.7329 - 29s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 29s - loss: 2.1486 - accuracy30: 0.6336 - val_loss: 2.3531 - val_accuracy30: 0.7436 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.1213 - accuracy30: 0.6378 - val_loss: 2.3809 - val_accuracy30: 0.7516 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.1015 - accuracy30: 0.6408 - val_loss: 2.3768 - val_accuracy30: 0.7381 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 29s - loss: 2.0892 - accuracy30: 0.6419 - val_loss: 2.3433 - val_accuracy30: 0.7279 - 29s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 29s - loss: 2.0713 - accuracy30: 0.6448 - val_loss: 2.2999 - val_accuracy30: 0.7269 - 29s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.0603 - accuracy30: 0.6465 - val_loss: 2.3018 - val_accuracy30: 0.7179 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 27s - loss: 2.0463 - accuracy30: 0.6483 - val_loss: 2.3031 - val_accuracy30: 0.7311 - 27s/epoch - 21ms/step
Epoch 10/50
1250/1250 - 27s - loss: 2.0388 - accuracy30: 0.6487 - val_loss: 2.2927 - val_accuracy30: 0.7192 - 27s/epoch - 22ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.0324 - accuracy30: 0.6506 - val_loss: 2.2935 - val_accuracy30: 0.7138 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 28s - loss: 2.0228 - accuracy30: 0.6498 - val_loss: 2.2890 - val_accuracy30: 0.7130 - 28s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 30s - loss: 2.0141 - accuracy30: 0.6515 - val_loss: 2.2956 - val_accuracy30: 0.7038 - 30s/epoch - 24ms/step
Epoch 14/50
1250/1250 - 30s - loss: 2.0061 - accuracy30: 0.6534 - val_loss: 2.2965 - val_accuracy30: 0.7150 - 30s/epoch - 24ms/step
Epoch 15/50
1250/1250 - 28s - loss: 1.9994 - accuracy30: 0.6535 - val_loss: 2.2783 - val_accuracy30: 0.6995 - 28s/epoch - 22ms/step
Epoch 16/50
1250/1250 - 28s - loss: 1.9881 - accuracy30: 0.6543 - val_loss: 2.2977 - val_accuracy30: 0.7052 - 28s/epoch - 22ms/step
Epoch 17/50
1250/1250 - 30s - loss: 1.9855 - accuracy30: 0.6542 - val_loss: 2.2645 - val_accuracy30: 0.6992 - 30s/epoch - 24ms/step
Epoch 18/50
1250/1250 - 28s - loss: 1.9773 - accuracy30: 0.6541 - val_loss: 2.3359 - val_accuracy30: 0.7014 - 28s/epoch - 22ms/step
Epoch 19/50
1250/1250 - 28s - loss: 1.9751 - accuracy30: 0.6545 - val_loss: 2.2991 - val_accuracy30: 0.6974 - 28s/epoch - 22ms/step
Epoch 20/50
1250/1250 - 27s - loss: 1.9681 - accuracy30: 0.6546 - val_loss: 2.2813 - val_accuracy30: 0.6994 - 27s/epoch - 22ms/step
Epoch 21/50
1250/1250 - 28s - loss: 1.9595 - accuracy30: 0.6568 - val_loss: 2.2917 - val_accuracy30: 0.6981 - 28s/epoch - 22ms/step
Epoch 22/50
1250/1250 - 30s - loss: 1.9556 - accuracy30: 0.6573 - val_loss: 2.3193 - val_accuracy30: 0.7001 - 30s/epoch - 24ms/step
Epoch 23/50
1250/1250 - 28s - loss: 1.9486 - accuracy30: 0.6568 - val_loss: 2.3198 - val_accuracy30: 0.6946 - 28s/epoch - 23ms/step
Epoch 24/50
1250/1250 - 30s - loss: 1.9422 - accuracy30: 0.6570 - val_loss: 2.2838 - val_accuracy30: 0.6885 - 30s/epoch - 24ms/step
Epoch 25/50
1250/1250 - 29s - loss: 1.9358 - accuracy30: 0.6580 - val_loss: 2.2956 - val_accuracy30: 0.6731 - 29s/epoch - 23ms/step
Epoch 26/50
1250/1250 - 29s - loss: 1.9295 - accuracy30: 0.6588 - val_loss: 2.3161 - val_accuracy30: 0.6926 - 29s/epoch - 23ms/step
Epoch 27/50
1250/1250 - 28s - loss: 1.9200 - accuracy30: 0.6588 - val_loss: 2.3459 - val_accuracy30: 0.6978 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepVOL_L2/h30
Evaluating performance on  test set...
2354/2354 - 24s - 24s/epoch - 10ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7055763
{'0': {'precision': 0.4451225450413894, 'recall': 0.5357087044850758, 'f1-score': 0.48623251360791475, 'support': 76788}, '1': {'precision': 0.8791910268308333, 'recall': 0.7088116906039568, 'f1-score': 0.7848612237873982, 'support': 450413}, '2': {'precision': 0.35051757014437485, 'recall': 0.6846144637607906, 'f1-score': 0.4636498349255251, 'support': 75181}, 'accuracy': 0.683725609330956, 'macro avg': {'precision': 0.5582770473388657, 'recall': 0.643044952949941, 'f1-score': 0.5782478574402793, 'support': 602382}, 'weighted avg': {'precision': 0.7578768943919616, 'recall': 0.683725609330956, 'f1-score': 0.7067046805585391, 'support': 602382}}
[[ 41136  25884   9768]
 [ 45553 319258  85602]
 [  5726  17985  51470]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.6491591
{'0': {'precision': 0.4514904042466313, 'recall': 0.5661401397813676, 'f1-score': 0.5023568564646017, 'support': 39061}, '1': {'precision': 0.8845115732440939, 'recall': 0.7384554620101861, 'f1-score': 0.8049114840721179, 'support': 240525}, '2': {'precision': 0.4002481495742951, 'recall': 0.6960392847399618, 'f1-score': 0.5082397681999276, 'support': 40321}, 'accuracy': 0.7120694451825061, 'macro avg': {'precision': 0.5787500423550068, 'recall': 0.6668782955105051, 'f1-score': 0.6051693695788823, 'support': 319907}, 'weighted avg': {'precision': 0.7706027641589541, 'recall': 0.7120694451825061, 'f1-score': 0.7305767975392825, 'support': 319907}}
[[ 22114  12973   3974]
 [ 24828 177617  38080]
 [  2038  10218  28065]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67677945
{'0': {'precision': 0.39920876722295484, 'recall': 0.5598494993941713, 'f1-score': 0.46607559991505626, 'support': 15681}, '1': {'precision': 0.8896024860805386, 'recall': 0.7226751096571964, 'f1-score': 0.7974973737514437, 'support': 95069}, '2': {'precision': 0.39988320315351483, 'recall': 0.6904026718759846, 'f1-score': 0.5064367762960224, 'support': 15869}, 'accuracy': 0.6984654751656545, 'macro avg': {'precision': 0.5628981521523361, 'recall': 0.657642426975784, 'f1-score': 0.5900032499875074, 'support': 126619}, 'weighted avg': {'precision': 0.7674942779429391, 'recall': 0.6984654751656545, 'f1-score': 0.7199745260228368, 'support': 126619}}
[[ 8779  4625  2277]
 [12200 68704 14165]
 [ 1012  3901 10956]]
training model: results/EXC/W9/deepVOL_L2/h50
Epoch 1/50
1250/1250 - 30s - loss: 2.5779 - accuracy50: 0.5464 - val_loss: 2.6352 - val_accuracy50: 0.6690 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 27s - loss: 2.4255 - accuracy50: 0.5842 - val_loss: 2.5183 - val_accuracy50: 0.6727 - 27s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 29s - loss: 2.3668 - accuracy50: 0.5975 - val_loss: 2.5091 - val_accuracy50: 0.6753 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 2.3287 - accuracy50: 0.6054 - val_loss: 2.5183 - val_accuracy50: 0.6905 - 28s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 27s - loss: 2.3047 - accuracy50: 0.6089 - val_loss: 2.4659 - val_accuracy50: 0.6890 - 27s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 29s - loss: 2.2937 - accuracy50: 0.6118 - val_loss: 2.4684 - val_accuracy50: 0.6833 - 29s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 28s - loss: 2.2758 - accuracy50: 0.6139 - val_loss: 2.4778 - val_accuracy50: 0.6847 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 2.2648 - accuracy50: 0.6152 - val_loss: 2.4585 - val_accuracy50: 0.6866 - 28s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 28s - loss: 2.2563 - accuracy50: 0.6164 - val_loss: 2.4928 - val_accuracy50: 0.6688 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 29s - loss: 2.2487 - accuracy50: 0.6176 - val_loss: 2.4608 - val_accuracy50: 0.6882 - 29s/epoch - 24ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.2391 - accuracy50: 0.6186 - val_loss: 2.4582 - val_accuracy50: 0.6770 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 28s - loss: 2.2305 - accuracy50: 0.6192 - val_loss: 2.4513 - val_accuracy50: 0.6759 - 28s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 30s - loss: 2.2202 - accuracy50: 0.6197 - val_loss: 2.4469 - val_accuracy50: 0.6736 - 30s/epoch - 24ms/step
Epoch 14/50
1250/1250 - 27s - loss: 2.2118 - accuracy50: 0.6208 - val_loss: 2.4759 - val_accuracy50: 0.6858 - 27s/epoch - 21ms/step
Epoch 15/50
1250/1250 - 28s - loss: 2.2070 - accuracy50: 0.6201 - val_loss: 2.4588 - val_accuracy50: 0.6759 - 28s/epoch - 22ms/step
Epoch 16/50
1250/1250 - 29s - loss: 2.1977 - accuracy50: 0.6226 - val_loss: 2.4528 - val_accuracy50: 0.6676 - 29s/epoch - 23ms/step
Epoch 17/50
1250/1250 - 29s - loss: 2.1875 - accuracy50: 0.6237 - val_loss: 2.4451 - val_accuracy50: 0.6666 - 29s/epoch - 23ms/step
Epoch 18/50
1250/1250 - 28s - loss: 2.1820 - accuracy50: 0.6247 - val_loss: 2.4623 - val_accuracy50: 0.6644 - 28s/epoch - 23ms/step
Epoch 19/50
1250/1250 - 27s - loss: 2.1789 - accuracy50: 0.6246 - val_loss: 2.4602 - val_accuracy50: 0.6580 - 27s/epoch - 21ms/step
Epoch 20/50
1250/1250 - 28s - loss: 2.1694 - accuracy50: 0.6258 - val_loss: 2.4630 - val_accuracy50: 0.6685 - 28s/epoch - 22ms/step
Epoch 21/50
1250/1250 - 29s - loss: 2.1622 - accuracy50: 0.6264 - val_loss: 2.4797 - val_accuracy50: 0.6681 - 29s/epoch - 23ms/step
Epoch 22/50
1250/1250 - 29s - loss: 2.1573 - accuracy50: 0.6280 - val_loss: 2.4809 - val_accuracy50: 0.6707 - 29s/epoch - 23ms/step
Epoch 23/50
1250/1250 - 29s - loss: 2.1570 - accuracy50: 0.6268 - val_loss: 2.4904 - val_accuracy50: 0.6722 - 29s/epoch - 23ms/step
Epoch 24/50
1250/1250 - 27s - loss: 2.1481 - accuracy50: 0.6283 - val_loss: 2.5070 - val_accuracy50: 0.6757 - 27s/epoch - 22ms/step
Epoch 25/50
1250/1250 - 27s - loss: 2.1379 - accuracy50: 0.6298 - val_loss: 2.5128 - val_accuracy50: 0.6719 - 27s/epoch - 22ms/step
Epoch 26/50
1250/1250 - 29s - loss: 2.1322 - accuracy50: 0.6302 - val_loss: 2.5018 - val_accuracy50: 0.6711 - 29s/epoch - 23ms/step
Epoch 27/50
1250/1250 - 29s - loss: 2.1240 - accuracy50: 0.6317 - val_loss: 2.5252 - val_accuracy50: 0.6726 - 29s/epoch - 23ms/step
testing model: results/EXC/W9/deepVOL_L2/h50
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7958546
{'0': {'precision': 0.5033483462501747, 'recall': 0.46554655266689865, 'f1-score': 0.48371002396496154, 'support': 100585}, '1': {'precision': 0.8026264955864103, 'recall': 0.6796019062110462, 'f1-score': 0.7360086957105186, 'support': 403523}, '2': {'precision': 0.38035174350992074, 'recall': 0.6489712436656695, 'f1-score': 0.4796110590969081, 'support': 98274}, 'accuracy': 0.6388620509908994, 'macro avg': {'precision': 0.5621088617821686, 'recall': 0.5980399008478714, 'f1-score': 0.5664432595907961, 'support': 602382}, 'weighted avg': {'precision': 0.6837625161903623, 'recall': 0.6388620509908994, 'f1-score': 0.6520508695502203, 'support': 602382}}
[[ 46827  40462  13296]
 [ 38682 274235  90606]
 [  7522  26975  63777]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.7353703
{'0': {'precision': 0.5407751740533198, 'recall': 0.4903194765204003, 'f1-score': 0.514312822997416, 'support': 51960}, '1': {'precision': 0.8090097419529799, 'recall': 0.7242143987600316, 'f1-score': 0.7642672565630488, 'support': 214199}, '2': {'precision': 0.43643811615482375, 'recall': 0.6581082086775322, 'f1-score': 0.5248265885233131, 'support': 53748}, 'accuracy': 0.6751180811923465, 'macro avg': {'precision': 0.5954076773870413, 'recall': 0.624214027985988, 'f1-score': 0.601135556027926, 'support': 319907}, 'weighted avg': {'precision': 0.7028462385239659, 'recall': 0.6751180811923465, 'f1-score': 0.683440361890941, 'support': 319907}}
[[ 25477  20756   5727]
 [ 19125 155126  39948]
 [  2510  15866  35372]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.76065737
{'0': {'precision': 0.48488718603661135, 'recall': 0.49936671862821513, 'f1-score': 0.49202044685497615, 'support': 20528}, '1': {'precision': 0.8261995451182419, 'recall': 0.7062991941529235, 'f1-score': 0.7615589598514795, 'support': 85376}, '2': {'precision': 0.4232118675366244, 'recall': 0.6638184890176201, 'f1-score': 0.5168868757870205, 'support': 20715}, 'accuracy': 0.6658005512600794, 'macro avg': {'precision': 0.5780995328971592, 'recall': 0.6231614672662529, 'f1-score': 0.5901554274978253, 'support': 126619}, 'weighted avg': {'precision': 0.704935360056514, 'recall': 0.6658005512600794, 'f1-score': 0.6778316454974923, 'support': 126619}}
[[10251  7066  3211]
 [ 9545 60301 15530]
 [ 1345  5619 13751]]
training model: results/EXC/W9/deepVOL_L2/h100
Epoch 1/50
1250/1250 - 30s - loss: 2.8963 - accuracy100: 0.4997 - val_loss: 2.8800 - val_accuracy100: 0.5774 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 27s - loss: 2.7701 - accuracy100: 0.5345 - val_loss: 2.8746 - val_accuracy100: 0.5791 - 27s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 27s - loss: 2.7188 - accuracy100: 0.5459 - val_loss: 2.8639 - val_accuracy100: 0.5820 - 27s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 29s - loss: 2.6927 - accuracy100: 0.5523 - val_loss: 2.8277 - val_accuracy100: 0.5868 - 29s/epoch - 24ms/step
Epoch 5/50
1250/1250 - 29s - loss: 2.6790 - accuracy100: 0.5568 - val_loss: 2.8298 - val_accuracy100: 0.5898 - 29s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 27s - loss: 2.6676 - accuracy100: 0.5588 - val_loss: 2.8495 - val_accuracy100: 0.5923 - 27s/epoch - 22ms/step
Epoch 7/50
1250/1250 - 29s - loss: 2.6602 - accuracy100: 0.5616 - val_loss: 2.8333 - val_accuracy100: 0.5943 - 29s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 30s - loss: 2.6525 - accuracy100: 0.5622 - val_loss: 2.8187 - val_accuracy100: 0.5904 - 30s/epoch - 24ms/step
Epoch 9/50
1250/1250 - 30s - loss: 2.6450 - accuracy100: 0.5645 - val_loss: 2.8084 - val_accuracy100: 0.5921 - 30s/epoch - 24ms/step
Epoch 10/50
1250/1250 - 28s - loss: 2.6383 - accuracy100: 0.5655 - val_loss: 2.8096 - val_accuracy100: 0.5950 - 28s/epoch - 23ms/step
Epoch 11/50
1250/1250 - 30s - loss: 2.6291 - accuracy100: 0.5672 - val_loss: 2.8046 - val_accuracy100: 0.5890 - 30s/epoch - 24ms/step
Epoch 12/50
1250/1250 - 29s - loss: 2.6218 - accuracy100: 0.5686 - val_loss: 2.8006 - val_accuracy100: 0.5877 - 29s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 27s - loss: 2.6124 - accuracy100: 0.5694 - val_loss: 2.7889 - val_accuracy100: 0.5838 - 27s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 2.6042 - accuracy100: 0.5703 - val_loss: 2.8097 - val_accuracy100: 0.5844 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 30s - loss: 2.5939 - accuracy100: 0.5725 - val_loss: 2.8000 - val_accuracy100: 0.5812 - 30s/epoch - 24ms/step
Epoch 16/50
1250/1250 - 28s - loss: 2.5873 - accuracy100: 0.5741 - val_loss: 2.8089 - val_accuracy100: 0.5824 - 28s/epoch - 23ms/step
Epoch 17/50
1250/1250 - 28s - loss: 2.5783 - accuracy100: 0.5755 - val_loss: 2.8112 - val_accuracy100: 0.5781 - 28s/epoch - 22ms/step
Epoch 18/50
1250/1250 - 27s - loss: 2.5705 - accuracy100: 0.5771 - val_loss: 2.8242 - val_accuracy100: 0.5816 - 27s/epoch - 22ms/step
Epoch 19/50
1250/1250 - 28s - loss: 2.5680 - accuracy100: 0.5768 - val_loss: 2.8456 - val_accuracy100: 0.5796 - 28s/epoch - 23ms/step
Epoch 20/50
1250/1250 - 33s - loss: 2.5642 - accuracy100: 0.5780 - val_loss: 2.8338 - val_accuracy100: 0.5700 - 33s/epoch - 26ms/step
Epoch 21/50
1250/1250 - 29s - loss: 2.5540 - accuracy100: 0.5794 - val_loss: 2.8528 - val_accuracy100: 0.5669 - 29s/epoch - 23ms/step
Epoch 22/50
1250/1250 - 28s - loss: 2.5459 - accuracy100: 0.5809 - val_loss: 2.8346 - val_accuracy100: 0.5707 - 28s/epoch - 22ms/step
Epoch 23/50
1250/1250 - 28s - loss: 2.5383 - accuracy100: 0.5823 - val_loss: 2.8742 - val_accuracy100: 0.5752 - 28s/epoch - 23ms/step
testing model: results/EXC/W9/deepVOL_L2/h100
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9185515
{'0': {'precision': 0.5323009558391627, 'recall': 0.3418940609951846, 'f1-score': 0.4163614112615228, 'support': 145782}, '1': {'precision': 0.6124470801981386, 'recall': 0.6851270120764533, 'f1-score': 0.6467515660328124, 'support': 312923}, '2': {'precision': 0.46492195426274036, 'recall': 0.5134990290721549, 'f1-score': 0.4880046036922141, 'support': 143677}, 'accuracy': 0.5611256644454847, 'macro avg': {'precision': 0.5365566634333473, 'recall': 0.5135067007145976, 'f1-score': 0.5170391936621831, 'support': 602382}, 'weighted avg': {'precision': 0.5578640584273679, 'recall': 0.5611256644454847, 'f1-score': 0.553131529492746, 'support': 602382}}
[[ 49842  76208  19732]
 [ 33352 214392  65179]
 [ 10441  59458  73778]]
Evaluating performance on  train set...
1250/1250 - 9s - 9s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.88289565
{'0': {'precision': 0.578455766192733, 'recall': 0.3792219561136643, 'f1-score': 0.4581147124369551, 'support': 77245}, '1': {'precision': 0.6153862286280534, 'recall': 0.7195571277058799, 'f1-score': 0.6634072449596717, 'support': 163117}, '2': {'precision': 0.5172273294456187, 'recall': 0.5106794895970834, 'f1-score': 0.5139325544176161, 'support': 79545}, 'accuracy': 0.585442019086797, 'macro avg': {'precision': 0.570356441422135, 'recall': 0.5364861911388759, 'f1-score': 0.545151503938081, 'support': 319907}, 'weighted avg': {'precision': 0.5820617211734398, 'recall': 0.585442019086797, 'f1-score': 0.576670205964323, 'support': 319907}}
[[ 29293  39087   8865]
 [ 16694 117372  29051]
 [  4653  34270  40622]]
Evaluating performance on  val set...
495/495 - 5s - 5s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.88776773
{'0': {'precision': 0.5205630570999912, 'recall': 0.39125099495887505, 'f1-score': 0.4467376074525694, 'support': 30152}, '1': {'precision': 0.6362966902589698, 'recall': 0.7028651482284888, 'f1-score': 0.6679263919606622, 'support': 66384}, '2': {'precision': 0.5058116755909625, 'recall': 0.5149752351826613, 'f1-score': 0.5103523249493502, 'support': 30083}, 'accuracy': 0.5840197758630221, 'macro avg': {'precision': 0.5542238076499745, 'recall': 0.5363637927900083, 'f1-score': 0.5416721081208605, 'support': 126619}, 'weighted avg': {'precision': 0.5777353274045232, 'recall': 0.5840197758630221, 'f1-score': 0.577816812131495, 'support': 126619}}
[[11797 14198  4157]
 [ 8746 46659 10979]
 [ 2119 12472 15492]]
training model: results/EXC/W9/deepVOL_L2/h200
Epoch 1/50
1250/1250 - 31s - loss: 3.1375 - accuracy200: 0.4467 - val_loss: 3.1431 - val_accuracy200: 0.4588 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 29s - loss: 3.0669 - accuracy200: 0.4678 - val_loss: 3.0789 - val_accuracy200: 0.4724 - 29s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 30s - loss: 3.0229 - accuracy200: 0.4792 - val_loss: 3.0693 - val_accuracy200: 0.4715 - 30s/epoch - 24ms/step
Epoch 4/50
1250/1250 - 27s - loss: 3.0026 - accuracy200: 0.4839 - val_loss: 3.0737 - val_accuracy200: 0.4698 - 27s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 2.9899 - accuracy200: 0.4867 - val_loss: 3.0763 - val_accuracy200: 0.4688 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 27s - loss: 2.9791 - accuracy200: 0.4893 - val_loss: 3.0686 - val_accuracy200: 0.4691 - 27s/epoch - 21ms/step
Epoch 7/50
1250/1250 - 27s - loss: 2.9722 - accuracy200: 0.4911 - val_loss: 3.0739 - val_accuracy200: 0.4665 - 27s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 29s - loss: 2.9635 - accuracy200: 0.4945 - val_loss: 3.0882 - val_accuracy200: 0.4685 - 29s/epoch - 23ms/step
Epoch 9/50
1250/1250 - 27s - loss: 2.9543 - accuracy200: 0.4975 - val_loss: 3.1053 - val_accuracy200: 0.4667 - 27s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 30s - loss: 2.9493 - accuracy200: 0.4980 - val_loss: 3.1334 - val_accuracy200: 0.4623 - 30s/epoch - 24ms/step
Epoch 11/50
1250/1250 - 28s - loss: 2.9421 - accuracy200: 0.5004 - val_loss: 3.1503 - val_accuracy200: 0.4627 - 28s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 29s - loss: 2.9337 - accuracy200: 0.5021 - val_loss: 3.1504 - val_accuracy200: 0.4646 - 29s/epoch - 23ms/step
Epoch 13/50
1250/1250 - 28s - loss: 2.9272 - accuracy200: 0.5046 - val_loss: 3.1858 - val_accuracy200: 0.4580 - 28s/epoch - 22ms/step
Epoch 14/50
1250/1250 - 28s - loss: 2.9198 - accuracy200: 0.5063 - val_loss: 3.2120 - val_accuracy200: 0.4569 - 28s/epoch - 22ms/step
Epoch 15/50
1250/1250 - 29s - loss: 2.9101 - accuracy200: 0.5091 - val_loss: 3.2051 - val_accuracy200: 0.4569 - 29s/epoch - 23ms/step
Epoch 16/50
1250/1250 - 27s - loss: 2.8999 - accuracy200: 0.5127 - val_loss: 3.2418 - val_accuracy200: 0.4498 - 27s/epoch - 22ms/step
testing model: results/EXC/W9/deepVOL_L2/h200
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0491794
{'0': {'precision': 0.464663690258362, 'recall': 0.3346917042722787, 'f1-score': 0.38911123505292383, 'support': 189688}, '1': {'precision': 0.4259158546983057, 'recall': 0.5402606303908566, 'f1-score': 0.4763220212951718, 'support': 224686}, '2': {'precision': 0.45331267808238124, 'recall': 0.43580060422960726, 'f1-score': 0.4443841812812371, 'support': 188008}, 'accuracy': 0.44292492139539363, 'macro avg': {'precision': 0.4479640743463496, 'recall': 0.43691764629758084, 'f1-score': 0.4366058125431109, 'support': 602382}, 'weighted avg': {'precision': 0.44666817034271283, 'recall': 0.44292492139539363, 'f1-score': 0.4388916049712124, 'support': 602382}}
[[ 63487  84810  41391]
 [ 45877 121389  57420]
 [ 27266  78808  81934]]
Evaluating performance on  train set...
1250/1250 - 11s - 11s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0204128
{'0': {'precision': 0.5147927444175234, 'recall': 0.3859075557650016, 'f1-score': 0.4411287743180836, 'support': 101856}, '1': {'precision': 0.4267799326815195, 'recall': 0.5822916575547372, 'f1-score': 0.4925525538857688, 'support': 114319}, '2': {'precision': 0.5055779485481348, 'recall': 0.42684031928430954, 'f1-score': 0.46288465257776684, 'support': 103732}, 'accuracy': 0.46935828225077914, 'macro avg': {'precision': 0.4823835418823926, 'recall': 0.4650131775346828, 'f1-score': 0.4655219935938731, 'support': 319907}, 'weighted avg': {'precision': 0.4803533422476064, 'recall': 0.46935828225077914, 'f1-score': 0.46655958958636995, 'support': 319907}}
[[39307 44558 17991]
 [22443 66567 25309]
 [14605 44850 44277]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.018741
{'0': {'precision': 0.48540923038386874, 'recall': 0.38647355038141296, 'f1-score': 0.4303280963748404, 'support': 40114}, '1': {'precision': 0.4454353132628153, 'recall': 0.5821105014673983, 'f1-score': 0.5046832362268604, 'support': 47022}, '2': {'precision': 0.49884144323071833, 'recall': 0.41985158169338704, 'f1-score': 0.45595071100475837, 'support': 39483}, 'accuracy': 0.46953458801601655, 'macro avg': {'precision': 0.47656199562580087, 'recall': 0.46281187784739947, 'f1-score': 0.4636540145354864, 'support': 126619}, 'weighted avg': {'precision': 0.47475277699982676, 'recall': 0.46953458801601655, 'f1-score': 0.4659308501444543, 'support': 126619}}
[[15503 17123  7488]
 [10484 27372  9166]
 [ 5951 16955 16577]]
training model: results/EXC/W9/deepVOL_L2/h300
Epoch 1/50
1250/1250 - 30s - loss: 3.2177 - accuracy300: 0.4171 - val_loss: 3.2217 - val_accuracy300: 0.4062 - 30s/epoch - 24ms/step
Epoch 2/50
1250/1250 - 27s - loss: 3.1627 - accuracy300: 0.4324 - val_loss: 3.1717 - val_accuracy300: 0.4263 - 27s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 28s - loss: 3.1352 - accuracy300: 0.4410 - val_loss: 3.1464 - val_accuracy300: 0.4300 - 28s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 29s - loss: 3.1188 - accuracy300: 0.4452 - val_loss: 3.1349 - val_accuracy300: 0.4344 - 29s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.1087 - accuracy300: 0.4482 - val_loss: 3.1338 - val_accuracy300: 0.4340 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 30s - loss: 3.0984 - accuracy300: 0.4522 - val_loss: 3.1433 - val_accuracy300: 0.4300 - 30s/epoch - 24ms/step
Epoch 7/50
1250/1250 - 28s - loss: 3.0925 - accuracy300: 0.4547 - val_loss: 3.1403 - val_accuracy300: 0.4303 - 28s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 27s - loss: 3.0840 - accuracy300: 0.4585 - val_loss: 3.1508 - val_accuracy300: 0.4249 - 27s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 27s - loss: 3.0763 - accuracy300: 0.4619 - val_loss: 3.1650 - val_accuracy300: 0.4229 - 27s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 30s - loss: 3.0678 - accuracy300: 0.4648 - val_loss: 3.1850 - val_accuracy300: 0.4198 - 30s/epoch - 24ms/step
Epoch 11/50
1250/1250 - 28s - loss: 3.0580 - accuracy300: 0.4700 - val_loss: 3.1961 - val_accuracy300: 0.4157 - 28s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 30s - loss: 3.0482 - accuracy300: 0.4735 - val_loss: 3.2090 - val_accuracy300: 0.4156 - 30s/epoch - 24ms/step
Epoch 13/50
1250/1250 - 28s - loss: 3.0419 - accuracy300: 0.4760 - val_loss: 3.2119 - val_accuracy300: 0.4165 - 28s/epoch - 23ms/step
Epoch 14/50
1250/1250 - 29s - loss: 3.0340 - accuracy300: 0.4782 - val_loss: 3.2342 - val_accuracy300: 0.4125 - 29s/epoch - 24ms/step
Epoch 15/50
1250/1250 - 28s - loss: 3.0234 - accuracy300: 0.4827 - val_loss: 3.2383 - val_accuracy300: 0.4114 - 28s/epoch - 22ms/step
testing model: results/EXC/W9/deepVOL_L2/h300
Evaluating performance on  test set...
2354/2354 - 18s - 18s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0583116
{'0': {'precision': 0.4396304260033399, 'recall': 0.4092511684616948, 'f1-score': 0.4238972000484111, 'support': 196840}, '1': {'precision': 0.4033733126718679, 'recall': 0.4292945662535748, 'f1-score': 0.4159304704420872, 'support': 209800}, '2': {'precision': 0.42365543086458834, 'recall': 0.4239151536205822, 'f1-score': 0.42378525244890247, 'support': 195742}, 'accuracy': 0.42099697534122865, 'macro avg': {'precision': 0.42221972317993206, 'recall': 0.42082029611195065, 'f1-score': 0.42120430764646694, 'support': 602382}, 'weighted avg': {'precision': 0.42181163348398787, 'recall': 0.42099697534122865, 'f1-score': 0.42108613876432593, 'support': 602382}}
[[80557 66790 49493]
 [56343 90066 63391]
 [46338 66426 82978]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0439986
{'0': {'precision': 0.46465898126047434, 'recall': 0.4300351563234382, 'f1-score': 0.44667711399795934, 'support': 106382}, '1': {'precision': 0.389153605015674, 'recall': 0.4721812804883847, 'f1-score': 0.42666575014070107, 'support': 105163}, '2': {'precision': 0.47250990921876995, 'recall': 0.4092394012661265, 'f1-score': 0.43860464656255255, 'support': 108362}, 'accuracy': 0.43684570828397, 'macro avg': {'precision': 0.44210749849830605, 'recall': 0.4371519460259831, 'f1-score': 0.4373158369004044, 'support': 319907}, 'weighted avg': {'precision': 0.442497447981693, 'recall': 0.43684570828397, 'f1-score': 0.4373643956968393, 'support': 319907}}
[[45748 39057 21577]
 [27578 49656 27929]
 [25129 38887 44346]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0446136
{'0': {'precision': 0.4510162702141338, 'recall': 0.4266866286142042, 'f1-score': 0.43851424450054094, 'support': 42748}, '1': {'precision': 0.4037858022484408, 'recall': 0.4783969501576693, 'f1-score': 0.437936234381732, 'support': 42494}, '2': {'precision': 0.4591833886857749, 'recall': 0.39763636803054836, 'f1-score': 0.42619935757952543, 'support': 41377}, 'accuracy': 0.43454773770129285, 'macro avg': {'precision': 0.43799515371611647, 'recall': 0.434239982267474, 'f1-score': 0.43421661215393276, 'support': 126619}, 'weighted avg': {'precision': 0.43783435719370983, 'recall': 0.43454773770129285, 'f1-score': 0.4342959594238974, 'support': 126619}}
[[18240 15225  9283]
 [12070 20329 10095]
 [10132 14792 16453]]
training model: results/EXC/W9/deepVOL_L2/h500
Epoch 1/50
1250/1250 - 31s - loss: 3.2809 - accuracy500: 0.3849 - val_loss: 3.2648 - val_accuracy500: 0.3821 - 31s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 27s - loss: 3.2485 - accuracy500: 0.3994 - val_loss: 3.2605 - val_accuracy500: 0.3891 - 27s/epoch - 22ms/step
Epoch 3/50
1250/1250 - 29s - loss: 3.2362 - accuracy500: 0.4059 - val_loss: 3.2496 - val_accuracy500: 0.3931 - 29s/epoch - 23ms/step
Epoch 4/50
1250/1250 - 28s - loss: 3.2236 - accuracy500: 0.4124 - val_loss: 3.2457 - val_accuracy500: 0.3951 - 28s/epoch - 22ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.2128 - accuracy500: 0.4178 - val_loss: 3.2517 - val_accuracy500: 0.3917 - 28s/epoch - 22ms/step
Epoch 6/50
1250/1250 - 28s - loss: 3.2021 - accuracy500: 0.4236 - val_loss: 3.2533 - val_accuracy500: 0.3910 - 28s/epoch - 22ms/step
Epoch 7/50
1250/1250 - 28s - loss: 3.1920 - accuracy500: 0.4287 - val_loss: 3.2590 - val_accuracy500: 0.3910 - 28s/epoch - 23ms/step
Epoch 8/50
1250/1250 - 30s - loss: 3.1846 - accuracy500: 0.4325 - val_loss: 3.2680 - val_accuracy500: 0.3866 - 30s/epoch - 24ms/step
Epoch 9/50
1250/1250 - 28s - loss: 3.1682 - accuracy500: 0.4386 - val_loss: 3.2864 - val_accuracy500: 0.3833 - 28s/epoch - 23ms/step
Epoch 10/50
1250/1250 - 30s - loss: 3.1634 - accuracy500: 0.4415 - val_loss: 3.2920 - val_accuracy500: 0.3841 - 30s/epoch - 24ms/step
Epoch 11/50
1250/1250 - 27s - loss: 3.1530 - accuracy500: 0.4455 - val_loss: 3.3251 - val_accuracy500: 0.3802 - 27s/epoch - 22ms/step
Epoch 12/50
1250/1250 - 27s - loss: 3.1448 - accuracy500: 0.4486 - val_loss: 3.3367 - val_accuracy500: 0.3777 - 27s/epoch - 22ms/step
Epoch 13/50
1250/1250 - 30s - loss: 3.1349 - accuracy500: 0.4532 - val_loss: 3.3623 - val_accuracy500: 0.3766 - 30s/epoch - 24ms/step
Epoch 14/50
1250/1250 - 27s - loss: 3.1256 - accuracy500: 0.4582 - val_loss: 3.3688 - val_accuracy500: 0.3767 - 27s/epoch - 21ms/step
testing model: results/EXC/W9/deepVOL_L2/h500
Evaluating performance on  test set...
2354/2354 - 20s - 20s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0869784
{'0': {'precision': 0.37731647612434194, 'recall': 0.49610813567967355, 'f1-score': 0.4286340709924354, 'support': 196050}, '1': {'precision': 0.38460408276148167, 'recall': 0.2133215090360002, 'f1-score': 0.2744298770335105, 'support': 208610}, '2': {'precision': 0.3841234059841942, 'recall': 0.44470013453232315, 'f1-score': 0.412198066217404, 'support': 197722}, 'accuracy': 0.3813028941767848, 'macro avg': {'precision': 0.3820146549566726, 'recall': 0.384709926415999, 'f1-score': 0.37175400474778336, 'support': 602382}, 'weighted avg': {'precision': 0.3820744991169338, 'recall': 0.3813028941767848, 'f1-score': 0.3698370009639484, 'support': 602382}}
[[97262 35509 63279]
 [86412 44501 77697]
 [74099 35696 87927]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0751041
{'0': {'precision': 0.40597340492470324, 'recall': 0.5497458036297538, 'f1-score': 0.46704549567483444, 'support': 105627}, '1': {'precision': 0.38903320813409004, 'recall': 0.2228245417843401, 'f1-score': 0.2833539212437106, 'support': 105518}, '2': {'precision': 0.42439623484145794, 'recall': 0.4543406704547544, 'f1-score': 0.4388582491851615, 'support': 108762}, 'accuracy': 0.40947837965408695, 'macro avg': {'precision': 0.4064676159667504, 'recall': 0.40897033862294946, 'f1-score': 0.3964192220345688, 'support': 319907}, 'weighted avg': {'precision': 0.40664925178786704, 'recall': 0.40947837965408695, 'f1-score': 0.3968736368110611, 'support': 319907}}
[[58068 18375 29184]
 [44169 23512 37837]
 [40797 18550 49415]]
Evaluating performance on  val set...
495/495 - 5s - 5s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0815796
{'0': {'precision': 0.3934625285346544, 'recall': 0.568026177398621, 'f1-score': 0.464897849873747, 'support': 42785}, '1': {'precision': 0.3906937943180238, 'recall': 0.19710998877665545, 'f1-score': 0.26202502136918177, 'support': 42768}, '2': {'precision': 0.3979202772963605, 'recall': 0.4193249890420299, 'f1-score': 0.4083423246108061, 'support': 41066}, 'accuracy': 0.3945142514156643, 'macro avg': {'precision': 0.39402553338301294, 'recall': 0.39482038507243544, 'f1-score': 0.378421731951245, 'support': 126619}, 'weighted avg': {'precision': 0.393973105033216, 'recall': 0.3945142514156643, 'f1-score': 0.37803115269614196, 'support': 126619}}
[[24303  6724 11758]
 [20041  8430 14297]
 [17423  6423 17220]]
training model: results/EXC/W9/deepVOL_L2/h1000
Epoch 1/50
1250/1250 - 32s - loss: 3.2295 - accuracy1000: 0.4252 - val_loss: 3.4256 - val_accuracy1000: 0.3222 - 32s/epoch - 25ms/step
Epoch 2/50
1250/1250 - 29s - loss: 3.2435 - accuracy1000: 0.4087 - val_loss: 3.3956 - val_accuracy1000: 0.3346 - 29s/epoch - 23ms/step
Epoch 3/50
1250/1250 - 27s - loss: 3.2626 - accuracy1000: 0.3926 - val_loss: 3.4149 - val_accuracy1000: 0.3308 - 27s/epoch - 22ms/step
Epoch 4/50
1250/1250 - 29s - loss: 3.2665 - accuracy1000: 0.3911 - val_loss: 3.4157 - val_accuracy1000: 0.3334 - 29s/epoch - 23ms/step
Epoch 5/50
1250/1250 - 28s - loss: 3.2642 - accuracy1000: 0.3941 - val_loss: 3.4266 - val_accuracy1000: 0.3344 - 28s/epoch - 23ms/step
Epoch 6/50
1250/1250 - 28s - loss: 3.2612 - accuracy1000: 0.3939 - val_loss: 3.4317 - val_accuracy1000: 0.3329 - 28s/epoch - 23ms/step
Epoch 7/50
1250/1250 - 27s - loss: 3.2566 - accuracy1000: 0.3981 - val_loss: 3.4568 - val_accuracy1000: 0.3246 - 27s/epoch - 22ms/step
Epoch 8/50
1250/1250 - 28s - loss: 3.2525 - accuracy1000: 0.4005 - val_loss: 3.4654 - val_accuracy1000: 0.3228 - 28s/epoch - 22ms/step
Epoch 9/50
1250/1250 - 28s - loss: 3.2491 - accuracy1000: 0.4012 - val_loss: 3.4436 - val_accuracy1000: 0.3302 - 28s/epoch - 22ms/step
Epoch 10/50
1250/1250 - 28s - loss: 3.2375 - accuracy1000: 0.4114 - val_loss: 3.4748 - val_accuracy1000: 0.3262 - 28s/epoch - 22ms/step
Epoch 11/50
1250/1250 - 29s - loss: 3.2392 - accuracy1000: 0.4105 - val_loss: 3.4703 - val_accuracy1000: 0.3246 - 29s/epoch - 23ms/step
Epoch 12/50
1250/1250 - 29s - loss: 3.2304 - accuracy1000: 0.4126 - val_loss: 3.4607 - val_accuracy1000: 0.3245 - 29s/epoch - 23ms/step
testing model: results/EXC/W9/deepVOL_L2/h1000
Evaluating performance on  test set...
2354/2354 - 23s - 23s/epoch - 10ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.167009
{'0': {'precision': 0.25378503566960814, 'recall': 0.7755834458435511, 'f1-score': 0.38243151214193644, 'support': 145172}, '1': {'precision': 0.49353049907578556, 'recall': 0.000855084067253803, 'f1-score': 0.0017072102458190932, 'support': 312250}, '2': {'precision': 0.27728749699720584, 'recall': 0.30258692052980135, 'f1-score': 0.2893853126876159, 'support': 144960}, 'accuracy': 0.26017211669671403, 'macro avg': {'precision': 0.34153434391419984, 'recall': 0.35967515014686874, 'f1-score': 0.2245080116917905, 'support': 602382}, 'weighted avg': {'precision': 0.3837149435065413, 'recall': 0.26017211669671403, 'f1-score': 0.1626886573754246, 'support': 602382}}
[[112593    101  32478]
 [230138    267  81845]
 [100924    173  43863]]
Evaluating performance on  train set...
1250/1250 - 10s - 10s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1062813
{'0': {'precision': 0.35455411032515644, 'recall': 0.8099852499113127, 'f1-score': 0.4932140715286601, 'support': 107118}, '1': {'precision': 0.3484848484848485, 'recall': 0.0008804164752717808, 'f1-score': 0.0017563955708285606, 'support': 104496}, '2': {'precision': 0.3836780995595889, 'recall': 0.26547422271060916, 'f1-score': 0.3138143137051571, 'support': 108293}, 'accuracy': 0.3613706483446752, 'macro avg': {'precision': 0.3622390194565313, 'recall': 0.35877996303239784, 'f1-score': 0.2695949269348819, 'support': 319907}, 'weighted avg': {'precision': 0.3624304949647535, 'recall': 0.3613706483446752, 'f1-score': 0.27195258215559176, 'support': 319907}}
[[86764    74 20280]
 [78503    92 25901]
 [79446    98 28749]]
Evaluating performance on  val set...
495/495 - 4s - 4s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1275625
{'0': {'precision': 0.32832995682157695, 'recall': 0.7916954505082404, 'f1-score': 0.464163279475793, 'support': 40532}, '1': {'precision': 0.3707865168539326, 'recall': 0.0006761740840914679, 'f1-score': 0.001349886486818154, 'support': 48804}, '2': {'precision': 0.3600847339908321, 'recall': 0.27811603143523855, 'f1-score': 0.31383646846955915, 'support': 37283}, 'accuracy': 0.33558154779298527, 'macro avg': {'precision': 0.3530670692221139, 'recall': 0.3568292186758568, 'f1-score': 0.2597832114773901, 'support': 126619}, 'weighted avg': {'precision': 0.354044607174371, 'recall': 0.33558154779298527, 'f1-score': 0.24151281369909797, 'support': 126619}}
[[32089    29  8414]
 [38758    33 10013]
 [26887    27 10369]]
training model: results/EXC/W9/deepVOL_L3/h10
Epoch 1/50
1250/1250 - 46s - loss: 2.5808 - accuracy10: 0.4440 - val_loss: 2.3916 - val_accuracy10: 0.6279 - 46s/epoch - 37ms/step
Epoch 2/50
1250/1250 - 46s - loss: 2.0689 - accuracy10: 0.6565 - val_loss: 2.2375 - val_accuracy10: 0.7338 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 47s - loss: 1.9767 - accuracy10: 0.6813 - val_loss: 2.1561 - val_accuracy10: 0.7588 - 47s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 44s - loss: 1.9355 - accuracy10: 0.6955 - val_loss: 2.1450 - val_accuracy10: 0.7322 - 44s/epoch - 35ms/step
Epoch 5/50
1250/1250 - 47s - loss: 1.9042 - accuracy10: 0.7005 - val_loss: 2.1270 - val_accuracy10: 0.7380 - 47s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 47s - loss: 1.8880 - accuracy10: 0.7022 - val_loss: 2.1206 - val_accuracy10: 0.7373 - 47s/epoch - 38ms/step
Epoch 7/50
1250/1250 - 44s - loss: 1.8718 - accuracy10: 0.7045 - val_loss: 2.1942 - val_accuracy10: 0.7161 - 44s/epoch - 35ms/step
Epoch 8/50
1250/1250 - 44s - loss: 1.8607 - accuracy10: 0.7026 - val_loss: 2.1512 - val_accuracy10: 0.7156 - 44s/epoch - 35ms/step
Epoch 9/50
1250/1250 - 45s - loss: 1.8482 - accuracy10: 0.7047 - val_loss: 2.1623 - val_accuracy10: 0.7426 - 45s/epoch - 36ms/step
Epoch 10/50
1250/1250 - 44s - loss: 1.8398 - accuracy10: 0.7049 - val_loss: 2.1767 - val_accuracy10: 0.7370 - 44s/epoch - 35ms/step
Epoch 11/50
1250/1250 - 43s - loss: 1.8323 - accuracy10: 0.7051 - val_loss: 2.1780 - val_accuracy10: 0.7276 - 43s/epoch - 35ms/step
Epoch 12/50
1250/1250 - 44s - loss: 1.8263 - accuracy10: 0.7055 - val_loss: 2.1610 - val_accuracy10: 0.7007 - 44s/epoch - 35ms/step
Epoch 13/50
1250/1250 - 47s - loss: 1.8175 - accuracy10: 0.7049 - val_loss: 2.1190 - val_accuracy10: 0.7309 - 47s/epoch - 37ms/step
Epoch 14/50
1250/1250 - 48s - loss: 1.8133 - accuracy10: 0.7042 - val_loss: 2.1310 - val_accuracy10: 0.7211 - 48s/epoch - 38ms/step
Epoch 15/50
1250/1250 - 47s - loss: 1.8022 - accuracy10: 0.7052 - val_loss: 2.1383 - val_accuracy10: 0.7310 - 47s/epoch - 38ms/step
Epoch 16/50
1250/1250 - 47s - loss: 1.7979 - accuracy10: 0.7060 - val_loss: 2.1318 - val_accuracy10: 0.7432 - 47s/epoch - 38ms/step
Epoch 17/50
1250/1250 - 44s - loss: 1.7905 - accuracy10: 0.7058 - val_loss: 2.1424 - val_accuracy10: 0.7313 - 44s/epoch - 35ms/step
Epoch 18/50
1250/1250 - 43s - loss: 1.7900 - accuracy10: 0.7054 - val_loss: 2.1232 - val_accuracy10: 0.7418 - 43s/epoch - 34ms/step
Epoch 19/50
1250/1250 - 44s - loss: 1.7824 - accuracy10: 0.7056 - val_loss: 2.1358 - val_accuracy10: 0.7419 - 44s/epoch - 35ms/step
Epoch 20/50
1250/1250 - 47s - loss: 1.7735 - accuracy10: 0.7075 - val_loss: 2.1165 - val_accuracy10: 0.7424 - 47s/epoch - 37ms/step
Epoch 21/50
1250/1250 - 43s - loss: 1.7721 - accuracy10: 0.7059 - val_loss: 2.1643 - val_accuracy10: 0.7429 - 43s/epoch - 35ms/step
Epoch 22/50
1250/1250 - 48s - loss: 1.7656 - accuracy10: 0.7059 - val_loss: 2.1586 - val_accuracy10: 0.7397 - 48s/epoch - 38ms/step
Epoch 23/50
1250/1250 - 49s - loss: 1.7587 - accuracy10: 0.7051 - val_loss: 2.1505 - val_accuracy10: 0.7572 - 49s/epoch - 39ms/step
Epoch 24/50
1250/1250 - 46s - loss: 1.7537 - accuracy10: 0.7049 - val_loss: 2.1250 - val_accuracy10: 0.7369 - 46s/epoch - 36ms/step
Epoch 25/50
1250/1250 - 46s - loss: 1.7464 - accuracy10: 0.7053 - val_loss: 2.1344 - val_accuracy10: 0.7538 - 46s/epoch - 37ms/step
Epoch 26/50
1250/1250 - 46s - loss: 1.7425 - accuracy10: 0.7062 - val_loss: 2.1580 - val_accuracy10: 0.7334 - 46s/epoch - 36ms/step
Epoch 27/50
1250/1250 - 46s - loss: 1.7374 - accuracy10: 0.7052 - val_loss: 2.1377 - val_accuracy10: 0.7340 - 46s/epoch - 37ms/step
Epoch 28/50
1250/1250 - 46s - loss: 1.7285 - accuracy10: 0.7070 - val_loss: 2.1640 - val_accuracy10: 0.7347 - 46s/epoch - 37ms/step
Epoch 29/50
1250/1250 - 46s - loss: 1.7281 - accuracy10: 0.7074 - val_loss: 2.1241 - val_accuracy10: 0.7430 - 46s/epoch - 37ms/step
Epoch 30/50
1250/1250 - 46s - loss: 1.7263 - accuracy10: 0.7052 - val_loss: 2.1643 - val_accuracy10: 0.7369 - 46s/epoch - 37ms/step
testing model: results/EXC/W9/deepVOL_L3/h10
Evaluating performance on  test set...
2354/2354 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6389628
{'0': {'precision': 0.392592003815277, 'recall': 0.542876612956409, 'f1-score': 0.45566257057455994, 'support': 45491}, '1': {'precision': 0.9540080260847755, 'recall': 0.7415076058710345, 'f1-score': 0.8344413865271993, 'support': 512959}, '2': {'precision': 0.23818521491436812, 'recall': 0.763247746517345, 'f1-score': 0.3630683940685078, 'support': 43932}, 'accuracy': 0.7280928048978887, 'macro avg': {'precision': 0.5282617482714735, 'recall': 0.6825439884482628, 'f1-score': 0.551057450390089, 'support': 602382}, 'weighted avg': {'precision': 0.8594054250618365, 'recall': 0.7280928048978887, 'f1-score': 0.7714591171014915, 'support': 602382}}
[[ 24696  12220   8575]
 [ 33925 380363  98671]
 [  4284   6117  33531]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.5779435
{'0': {'precision': 0.39102423768569194, 'recall': 0.5599946253415148, 'f1-score': 0.4604986924975139, 'support': 22327}, '1': {'precision': 0.9567233595657333, 'recall': 0.7662461084712436, 'f1-score': 0.8509559394409937, 'support': 274635}, '2': {'precision': 0.2637293122471497, 'recall': 0.7813031161473087, 'f1-score': 0.3943466783985921, 'support': 22945}, 'accuracy': 0.7529313206650683, 'macro avg': {'precision': 0.5371589698328583, 'recall': 0.7025146166533558, 'f1-score': 0.5686004367790333, 'support': 319907}, 'weighted avg': {'precision': 0.8675377127685686, 'recall': 0.7529313206650683, 'f1-score': 0.790955256595276, 'support': 319907}}
[[ 12503   6180   3644]
 [ 17793 210438  46404]
 [  1679   3339  17927]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.6113577
{'0': {'precision': 0.3428792569659443, 'recall': 0.526924740484429, 'f1-score': 0.4154305200341006, 'support': 9248}, '1': {'precision': 0.9579328890447796, 'recall': 0.757640487881562, 'f1-score': 0.8460946656959482, 'support': 108141}, '2': {'precision': 0.2672917364289169, 'recall': 0.7783315276273023, 'f1-score': 0.3979283795385936, 'support': 9230}, 'accuracy': 0.7422977594199922, 'macro avg': {'precision': 0.5227012941465469, 'recall': 0.6876322519977646, 'f1-score': 0.5531511884228807, 'support': 126619}, 'weighted avg': {'precision': 0.8626657188088002, 'recall': 0.7422977594199922, 'f1-score': 0.7819703491217124, 'support': 126619}}
[[ 4873  2242  2133]
 [ 8649 81932 17560]
 [  690  1356  7184]]
training model: results/EXC/W9/deepVOL_L3/h20
Epoch 1/50
1250/1250 - 51s - loss: 2.5807 - accuracy20: 0.4564 - val_loss: 2.4546 - val_accuracy20: 0.7092 - 51s/epoch - 41ms/step
Epoch 2/50
1250/1250 - 48s - loss: 2.1467 - accuracy20: 0.6356 - val_loss: 2.2779 - val_accuracy20: 0.7255 - 48s/epoch - 39ms/step
Epoch 3/50
1250/1250 - 49s - loss: 2.0426 - accuracy20: 0.6578 - val_loss: 2.2410 - val_accuracy20: 0.7324 - 49s/epoch - 39ms/step
Epoch 4/50
1250/1250 - 48s - loss: 1.9972 - accuracy20: 0.6684 - val_loss: 2.2407 - val_accuracy20: 0.7218 - 48s/epoch - 38ms/step
Epoch 5/50
1250/1250 - 47s - loss: 1.9747 - accuracy20: 0.6707 - val_loss: 2.2665 - val_accuracy20: 0.7035 - 47s/epoch - 38ms/step
Epoch 6/50
1250/1250 - 48s - loss: 1.9559 - accuracy20: 0.6728 - val_loss: 2.2213 - val_accuracy20: 0.7119 - 48s/epoch - 38ms/step
Epoch 7/50
1250/1250 - 47s - loss: 1.9403 - accuracy20: 0.6751 - val_loss: 2.2476 - val_accuracy20: 0.6940 - 47s/epoch - 38ms/step
Epoch 8/50
1250/1250 - 47s - loss: 1.9276 - accuracy20: 0.6784 - val_loss: 2.2138 - val_accuracy20: 0.7127 - 47s/epoch - 38ms/step
Epoch 9/50
1250/1250 - 47s - loss: 1.9156 - accuracy20: 0.6789 - val_loss: 2.1640 - val_accuracy20: 0.7107 - 47s/epoch - 38ms/step
Epoch 10/50
1250/1250 - 45s - loss: 1.9053 - accuracy20: 0.6798 - val_loss: 2.1808 - val_accuracy20: 0.6944 - 45s/epoch - 36ms/step
Epoch 11/50
1250/1250 - 45s - loss: 1.8966 - accuracy20: 0.6797 - val_loss: 2.1774 - val_accuracy20: 0.7190 - 45s/epoch - 36ms/step
Epoch 12/50
1250/1250 - 46s - loss: 1.8856 - accuracy20: 0.6807 - val_loss: 2.1602 - val_accuracy20: 0.6886 - 46s/epoch - 37ms/step
Epoch 13/50
1250/1250 - 46s - loss: 1.8767 - accuracy20: 0.6803 - val_loss: 2.1530 - val_accuracy20: 0.7022 - 46s/epoch - 37ms/step
Epoch 14/50
1250/1250 - 46s - loss: 1.8720 - accuracy20: 0.6812 - val_loss: 2.1382 - val_accuracy20: 0.6918 - 46s/epoch - 37ms/step
Epoch 15/50
1250/1250 - 45s - loss: 1.8620 - accuracy20: 0.6830 - val_loss: 2.1264 - val_accuracy20: 0.6499 - 45s/epoch - 36ms/step
Epoch 16/50
1250/1250 - 47s - loss: 1.8547 - accuracy20: 0.6816 - val_loss: 2.1372 - val_accuracy20: 0.6746 - 47s/epoch - 37ms/step
Epoch 17/50
1250/1250 - 47s - loss: 1.8468 - accuracy20: 0.6822 - val_loss: 2.1225 - val_accuracy20: 0.6622 - 47s/epoch - 38ms/step
Epoch 18/50
1250/1250 - 46s - loss: 1.8420 - accuracy20: 0.6821 - val_loss: 2.1279 - val_accuracy20: 0.6483 - 46s/epoch - 36ms/step
Epoch 19/50
1250/1250 - 48s - loss: 1.8372 - accuracy20: 0.6820 - val_loss: 2.1326 - val_accuracy20: 0.6402 - 48s/epoch - 38ms/step
Epoch 20/50
1250/1250 - 45s - loss: 1.8274 - accuracy20: 0.6842 - val_loss: 2.1322 - val_accuracy20: 0.6327 - 45s/epoch - 36ms/step
Epoch 21/50
1250/1250 - 46s - loss: 1.8207 - accuracy20: 0.6843 - val_loss: 2.1093 - val_accuracy20: 0.6344 - 46s/epoch - 37ms/step
Epoch 22/50
1250/1250 - 45s - loss: 1.8155 - accuracy20: 0.6844 - val_loss: 2.1201 - val_accuracy20: 0.6266 - 45s/epoch - 36ms/step
Epoch 23/50
1250/1250 - 48s - loss: 1.8112 - accuracy20: 0.6844 - val_loss: 2.1093 - val_accuracy20: 0.6480 - 48s/epoch - 38ms/step
Epoch 24/50
1250/1250 - 48s - loss: 1.8029 - accuracy20: 0.6855 - val_loss: 2.1320 - val_accuracy20: 0.6244 - 48s/epoch - 38ms/step
Epoch 25/50
1250/1250 - 47s - loss: 1.7945 - accuracy20: 0.6850 - val_loss: 2.1231 - val_accuracy20: 0.6483 - 47s/epoch - 37ms/step
Epoch 26/50
1250/1250 - 48s - loss: 1.7904 - accuracy20: 0.6848 - val_loss: 2.1215 - val_accuracy20: 0.6498 - 48s/epoch - 38ms/step
Epoch 27/50
1250/1250 - 48s - loss: 1.7834 - accuracy20: 0.6861 - val_loss: 2.1458 - val_accuracy20: 0.6260 - 48s/epoch - 38ms/step
Epoch 28/50
1250/1250 - 48s - loss: 1.7797 - accuracy20: 0.6853 - val_loss: 2.1466 - val_accuracy20: 0.6194 - 48s/epoch - 38ms/step
Epoch 29/50
1250/1250 - 49s - loss: 1.7737 - accuracy20: 0.6862 - val_loss: 2.1688 - val_accuracy20: 0.5996 - 49s/epoch - 40ms/step
Epoch 30/50
1250/1250 - 50s - loss: 1.7660 - accuracy20: 0.6856 - val_loss: 2.1616 - val_accuracy20: 0.6393 - 50s/epoch - 40ms/step
Epoch 31/50
1250/1250 - 48s - loss: 1.7573 - accuracy20: 0.6860 - val_loss: 2.1884 - val_accuracy20: 0.6381 - 48s/epoch - 38ms/step
testing model: results/EXC/W9/deepVOL_L3/h20
Evaluating performance on  test set...
2354/2354 - 38s - 38s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7754217
{'0': {'precision': 0.3178886650531167, 'recall': 0.6956769957816613, 'f1-score': 0.436375935062868, 'support': 63058}, '1': {'precision': 0.9375821490711793, 'recall': 0.5720139191316874, 'f1-score': 0.7105344944844456, 'support': 477616}, '2': {'precision': 0.2681380171452024, 'recall': 0.7517015621961496, 'f1-score': 0.39527739549469326, 'support': 61708}, 'accuracy': 0.6033663024459562, 'macro avg': {'precision': 0.5078696104231661, 'recall': 0.6731308257031662, 'f1-score': 0.5140626083473356, 'support': 602382}, 'weighted avg': {'precision': 0.8041341207301944, 'recall': 0.6033663024459562, 'f1-score': 0.6495403487356258, 'support': 602382}}
[[ 43868   9836   9354]
 [ 87160 273203 117253]
 [  6970   8352  46386]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.6910987
{'0': {'precision': 0.3337510001358675, 'recall': 0.6989124936772888, 'f1-score': 0.4517691293819542, 'support': 31632}, '1': {'precision': 0.9398515005927497, 'recall': 0.6480939678168832, 'f1-score': 0.7671700323410324, 'support': 255662}, '2': {'precision': 0.32080032054181906, 'recall': 0.7610462085671358, 'f1-score': 0.45134658398647043, 'support': 32613}, 'accuracy': 0.6646337841935313, 'macro avg': {'precision': 0.5314676070901454, 'recall': 0.7026842233537693, 'f1-score': 0.5567619152364857, 'support': 319907}, 'weighted avg': {'precision': 0.8168117197644056, 'recall': 0.6646337841935313, 'f1-score': 0.7037868882285594, 'support': 319907}}
[[ 22108   5470   4054]
 [ 41474 165693  48495]
 [  2659   5134  24820]]
Evaluating performance on  val set...
495/495 - 9s - 9s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.7356859
{'0': {'precision': 0.2961459765873948, 'recall': 0.6838354891178066, 'f1-score': 0.4133039977530194, 'support': 12911}, '1': {'precision': 0.9457556555545351, 'recall': 0.6136169536634293, 'f1-score': 0.7443143490411488, 'support': 100698}, '2': {'precision': 0.31240467717336046, 'recall': 0.7557263643351269, 'f1-score': 0.4420664538464998, 'support': 13010}, 'accuracy': 0.6353785766749066, 'macro avg': {'precision': 0.5181021031050967, 'recall': 0.6843929357054543, 'f1-score': 0.5332282668802227, 'support': 126619}, 'weighted avg': {'precision': 0.8144403964395222, 'recall': 0.6353785766749066, 'f1-score': 0.6795063837123796, 'support': 126619}}
[[ 8829  1735  2347]
 [19615 61790 19293]
 [ 1369  1809  9832]]
training model: results/EXC/W9/deepVOL_L3/h30
Epoch 1/50
1250/1250 - 48s - loss: 2.6233 - accuracy30: 0.4784 - val_loss: 2.5037 - val_accuracy30: 0.6806 - 48s/epoch - 38ms/step
Epoch 2/50
1250/1250 - 46s - loss: 2.2404 - accuracy30: 0.6161 - val_loss: 2.4712 - val_accuracy30: 0.7034 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 46s - loss: 2.1475 - accuracy30: 0.6348 - val_loss: 2.3825 - val_accuracy30: 0.6824 - 46s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 46s - loss: 2.1033 - accuracy30: 0.6416 - val_loss: 2.2928 - val_accuracy30: 0.6656 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 46s - loss: 2.0749 - accuracy30: 0.6463 - val_loss: 2.3213 - val_accuracy30: 0.6445 - 46s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 45s - loss: 2.0570 - accuracy30: 0.6493 - val_loss: 2.3077 - val_accuracy30: 0.6582 - 45s/epoch - 36ms/step
Epoch 7/50
1250/1250 - 46s - loss: 2.0414 - accuracy30: 0.6529 - val_loss: 2.3038 - val_accuracy30: 0.6654 - 46s/epoch - 37ms/step
Epoch 8/50
1250/1250 - 46s - loss: 2.0281 - accuracy30: 0.6539 - val_loss: 2.2986 - val_accuracy30: 0.6605 - 46s/epoch - 37ms/step
Epoch 9/50
1250/1250 - 46s - loss: 2.0181 - accuracy30: 0.6552 - val_loss: 2.3285 - val_accuracy30: 0.6470 - 46s/epoch - 37ms/step
Epoch 10/50
1250/1250 - 46s - loss: 2.0103 - accuracy30: 0.6562 - val_loss: 2.3822 - val_accuracy30: 0.6536 - 46s/epoch - 37ms/step
Epoch 11/50
1250/1250 - 45s - loss: 2.0021 - accuracy30: 0.6560 - val_loss: 2.3303 - val_accuracy30: 0.6473 - 45s/epoch - 36ms/step
Epoch 12/50
1250/1250 - 45s - loss: 1.9965 - accuracy30: 0.6569 - val_loss: 2.2732 - val_accuracy30: 0.6534 - 45s/epoch - 36ms/step
Epoch 13/50
1250/1250 - 45s - loss: 1.9888 - accuracy30: 0.6561 - val_loss: 2.3571 - val_accuracy30: 0.6586 - 45s/epoch - 36ms/step
Epoch 14/50
1250/1250 - 45s - loss: 1.9787 - accuracy30: 0.6568 - val_loss: 2.3305 - val_accuracy30: 0.6598 - 45s/epoch - 36ms/step
Epoch 15/50
1250/1250 - 45s - loss: 1.9737 - accuracy30: 0.6584 - val_loss: 2.2994 - val_accuracy30: 0.6662 - 45s/epoch - 36ms/step
Epoch 16/50
1250/1250 - 46s - loss: 1.9689 - accuracy30: 0.6571 - val_loss: 2.2907 - val_accuracy30: 0.6829 - 46s/epoch - 37ms/step
Epoch 17/50
1250/1250 - 45s - loss: 1.9622 - accuracy30: 0.6584 - val_loss: 2.3107 - val_accuracy30: 0.6576 - 45s/epoch - 36ms/step
Epoch 18/50
1250/1250 - 45s - loss: 1.9536 - accuracy30: 0.6592 - val_loss: 2.2837 - val_accuracy30: 0.6694 - 45s/epoch - 36ms/step
Epoch 19/50
1250/1250 - 45s - loss: 1.9458 - accuracy30: 0.6607 - val_loss: 2.2855 - val_accuracy30: 0.6647 - 45s/epoch - 36ms/step
Epoch 20/50
1250/1250 - 46s - loss: 1.9438 - accuracy30: 0.6594 - val_loss: 2.2943 - val_accuracy30: 0.6665 - 46s/epoch - 37ms/step
Epoch 21/50
1250/1250 - 47s - loss: 1.9374 - accuracy30: 0.6610 - val_loss: 2.2722 - val_accuracy30: 0.6685 - 47s/epoch - 38ms/step
Epoch 22/50
1250/1250 - 46s - loss: 1.9323 - accuracy30: 0.6613 - val_loss: 2.2679 - val_accuracy30: 0.6813 - 46s/epoch - 37ms/step
Epoch 23/50
1250/1250 - 47s - loss: 1.9339 - accuracy30: 0.6601 - val_loss: 2.2636 - val_accuracy30: 0.6707 - 47s/epoch - 38ms/step
Epoch 24/50
1250/1250 - 46s - loss: 1.9200 - accuracy30: 0.6637 - val_loss: 2.2723 - val_accuracy30: 0.6758 - 46s/epoch - 37ms/step
Epoch 25/50
1250/1250 - 47s - loss: 1.9194 - accuracy30: 0.6615 - val_loss: 2.2833 - val_accuracy30: 0.6889 - 47s/epoch - 37ms/step
Epoch 26/50
1250/1250 - 46s - loss: 1.9120 - accuracy30: 0.6628 - val_loss: 2.2885 - val_accuracy30: 0.6681 - 46s/epoch - 37ms/step
Epoch 27/50
1250/1250 - 46s - loss: 1.9015 - accuracy30: 0.6637 - val_loss: 2.2657 - val_accuracy30: 0.6742 - 46s/epoch - 37ms/step
Epoch 28/50
1250/1250 - 47s - loss: 1.8929 - accuracy30: 0.6641 - val_loss: 2.3075 - val_accuracy30: 0.6923 - 47s/epoch - 38ms/step
Epoch 29/50
1250/1250 - 49s - loss: 1.8881 - accuracy30: 0.6641 - val_loss: 2.3230 - val_accuracy30: 0.6784 - 49s/epoch - 39ms/step
Epoch 30/50
1250/1250 - 43s - loss: 1.8790 - accuracy30: 0.6649 - val_loss: 2.3285 - val_accuracy30: 0.6822 - 43s/epoch - 35ms/step
Epoch 31/50
1250/1250 - 46s - loss: 1.8743 - accuracy30: 0.6660 - val_loss: 2.3338 - val_accuracy30: 0.6897 - 46s/epoch - 36ms/step
Epoch 32/50
1250/1250 - 45s - loss: 1.8668 - accuracy30: 0.6664 - val_loss: 2.3023 - val_accuracy30: 0.6772 - 45s/epoch - 36ms/step
Epoch 33/50
1250/1250 - 46s - loss: 1.8648 - accuracy30: 0.6666 - val_loss: 2.3513 - val_accuracy30: 0.6958 - 46s/epoch - 37ms/step
testing model: results/EXC/W9/deepVOL_L3/h30
Evaluating performance on  test set...
2354/2354 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7510952
{'0': {'precision': 0.41345229396608085, 'recall': 0.5600354222013856, 'f1-score': 0.47570796460176995, 'support': 76788}, '1': {'precision': 0.8897926950840149, 'recall': 0.6579139589665485, 'f1-score': 0.7564831916308529, 'support': 450413}, '2': {'precision': 0.32644223208777384, 'recall': 0.7178941487875926, 'f1-score': 0.44880360892252036, 'support': 75181}, 'accuracy': 0.6529228961024732, 'macro avg': {'precision': 0.5432290737126232, 'recall': 0.6452811766518423, 'f1-score': 0.5603315883850478, 'support': 602382}, 'weighted avg': {'precision': 0.7587620901197825, 'recall': 0.6529228961024732, 'f1-score': 0.6822913551538261, 'support': 602382}}
[[ 43004  21161  12623]
 [ 55341 296333  98739]
 [  5667  15542  53972]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.67077804
{'0': {'precision': 0.4396307086912104, 'recall': 0.5949156447607589, 'f1-score': 0.5056190776662062, 'support': 39061}, '1': {'precision': 0.8958739237005845, 'recall': 0.7111568444028687, 'f1-score': 0.7928994082840236, 'support': 240525}, '2': {'precision': 0.38214853449295166, 'recall': 0.7214106792986285, 'f1-score': 0.49963070475274396, 'support': 40321}, 'accuracy': 0.698256055666178, 'macro avg': {'precision': 0.5725510556282488, 'recall': 0.6758277228207521, 'f1-score': 0.5993830635676579, 'support': 319907}, 'weighted avg': {'precision': 0.7754162980790065, 'recall': 0.698256055666178, 'f1-score': 0.720858645220548, 'support': 319907}}
[[ 23238  10686   5137]
 [ 27582 171051  41892]
 [  2038   9195  29088]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.7213348
{'0': {'precision': 0.3734038054968288, 'recall': 0.5631656144378547, 'f1-score': 0.44906053748951213, 'support': 15681}, '1': {'precision': 0.9028139802124499, 'recall': 0.6776446580904396, 'f1-score': 0.7741892841906662, 'support': 95069}, '2': {'precision': 0.3675619246464838, 'recall': 0.7321822421072531, 'f1-score': 0.4894271272114575, 'support': 15869}, 'accuracy': 0.670302245318633, 'macro avg': {'precision': 0.5479265701185875, 'recall': 0.6576641715451825, 'f1-score': 0.5708923162972119, 'support': 126619}, 'weighted avg': {'precision': 0.7701672540537219, 'recall': 0.670302245318633, 'f1-score': 0.6982351655661008, 'support': 126619}}
[[ 8831  3683  3167]
 [13821 64423 16825]
 [  998  3252 11619]]
training model: results/EXC/W9/deepVOL_L3/h50
Epoch 1/50
1250/1250 - 48s - loss: 2.8228 - accuracy50: 0.4396 - val_loss: 3.0296 - val_accuracy50: 0.6549 - 48s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 49s - loss: 2.5451 - accuracy50: 0.5494 - val_loss: 2.5513 - val_accuracy50: 0.6498 - 49s/epoch - 39ms/step
Epoch 3/50
1250/1250 - 46s - loss: 2.3951 - accuracy50: 0.5937 - val_loss: 2.5012 - val_accuracy50: 0.6565 - 46s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 46s - loss: 2.3373 - accuracy50: 0.6029 - val_loss: 2.5414 - val_accuracy50: 0.6498 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 46s - loss: 2.2987 - accuracy50: 0.6116 - val_loss: 2.4787 - val_accuracy50: 0.6400 - 46s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 46s - loss: 2.2753 - accuracy50: 0.6167 - val_loss: 2.4817 - val_accuracy50: 0.6450 - 46s/epoch - 37ms/step
Epoch 7/50
1250/1250 - 46s - loss: 2.2619 - accuracy50: 0.6193 - val_loss: 2.5331 - val_accuracy50: 0.6332 - 46s/epoch - 37ms/step
Epoch 8/50
1250/1250 - 48s - loss: 2.2480 - accuracy50: 0.6224 - val_loss: 2.5134 - val_accuracy50: 0.6371 - 48s/epoch - 38ms/step
Epoch 9/50
1250/1250 - 48s - loss: 2.2379 - accuracy50: 0.6253 - val_loss: 2.4681 - val_accuracy50: 0.6342 - 48s/epoch - 39ms/step
Epoch 10/50
1250/1250 - 48s - loss: 2.2265 - accuracy50: 0.6260 - val_loss: 2.4972 - val_accuracy50: 0.6351 - 48s/epoch - 38ms/step
Epoch 11/50
1250/1250 - 48s - loss: 2.2163 - accuracy50: 0.6270 - val_loss: 2.4773 - val_accuracy50: 0.6471 - 48s/epoch - 38ms/step
Epoch 12/50
1250/1250 - 46s - loss: 2.2089 - accuracy50: 0.6284 - val_loss: 2.5013 - val_accuracy50: 0.6447 - 46s/epoch - 37ms/step
Epoch 13/50
1250/1250 - 46s - loss: 2.1991 - accuracy50: 0.6286 - val_loss: 2.5233 - val_accuracy50: 0.6262 - 46s/epoch - 37ms/step
Epoch 14/50
1250/1250 - 46s - loss: 2.1913 - accuracy50: 0.6299 - val_loss: 2.5098 - val_accuracy50: 0.6162 - 46s/epoch - 37ms/step
Epoch 15/50
1250/1250 - 47s - loss: 2.1835 - accuracy50: 0.6308 - val_loss: 2.5174 - val_accuracy50: 0.6117 - 47s/epoch - 38ms/step
Epoch 16/50
1250/1250 - 47s - loss: 2.1745 - accuracy50: 0.6315 - val_loss: 2.5480 - val_accuracy50: 0.6097 - 47s/epoch - 37ms/step
Epoch 17/50
1250/1250 - 48s - loss: 2.1652 - accuracy50: 0.6313 - val_loss: 2.5435 - val_accuracy50: 0.5978 - 48s/epoch - 39ms/step
Epoch 18/50
1250/1250 - 49s - loss: 2.1590 - accuracy50: 0.6325 - val_loss: 2.5624 - val_accuracy50: 0.5914 - 49s/epoch - 39ms/step
Epoch 19/50
1250/1250 - 48s - loss: 2.1498 - accuracy50: 0.6332 - val_loss: 2.5333 - val_accuracy50: 0.6190 - 48s/epoch - 39ms/step
testing model: results/EXC/W9/deepVOL_L3/h50
Evaluating performance on  test set...
2354/2354 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8576196
{'0': {'precision': 0.4464938278709752, 'recall': 0.46280260476214147, 'f1-score': 0.4545019624690008, 'support': 100585}, '1': {'precision': 0.8053307664221463, 'recall': 0.6012594077661001, 'f1-score': 0.6884915145297981, 'support': 403523}, '2': {'precision': 0.34756391825372235, 'recall': 0.6962065246148523, 'f1-score': 0.46365801841241233, 'support': 98274}, 'accuracy': 0.5936299557423694, 'macro avg': {'precision': 0.5331295041822813, 'recall': 0.586756179047698, 'f1-score': 0.5355504984704037, 'support': 602382}, 'weighted avg': {'precision': 0.6707314711226964, 'recall': 0.5936299557423694, 'f1-score': 0.6127403697554269, 'support': 602382}}
[[ 46551  35804  18230]
 [ 50697 242622 110204]
 [  7011  22844  68419]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.78464025
{'0': {'precision': 0.49426618568445035, 'recall': 0.5010200153964588, 'f1-score': 0.49762018541527286, 'support': 51960}, '1': {'precision': 0.8171657385548565, 'recall': 0.6754886810862796, 'f1-score': 0.7396034871863029, 'support': 214199}, '2': {'precision': 0.41270862212364845, 'recall': 0.6924164620078886, 'f1-score': 0.5171654287361993, 'support': 53748}, 'accuracy': 0.6499951548418759, 'macro avg': {'precision': 0.5747135154543185, 'recall': 0.6229750528302089, 'f1-score': 0.5847963671125916, 'support': 319907}, 'weighted avg': {'precision': 0.6967663041533246, 'recall': 0.6499951548418759, 'f1-score': 0.6629279123298637, 'support': 319907}}
[[ 26033  18344   7583]
 [ 24134 144689  45376]
 [  2503  14029  37216]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.8126139
{'0': {'precision': 0.43835733882030176, 'recall': 0.4981488698363211, 'f1-score': 0.46634439985406784, 'support': 20528}, '1': {'precision': 0.8355102410183705, 'recall': 0.6488474512743628, 'f1-score': 0.7304421208085549, 'support': 85376}, '2': {'precision': 0.3965232907080483, 'recall': 0.7080376538740043, 'f1-score': 0.5083529737973104, 'support': 20715}, 'accuracy': 0.6340991478372124, 'macro avg': {'precision': 0.5567969568489068, 'recall': 0.6183446583282294, 'f1-score': 0.5683798314866443, 'support': 126619}, 'weighted avg': {'precision': 0.699303435941721, 'recall': 0.6340991478372124, 'f1-score': 0.6512914823096594, 'support': 126619}}
[[10226  5993  4309]
 [11967 55396 18013]
 [ 1135  4913 14667]]
training model: results/EXC/W9/deepVOL_L3/h100
Epoch 1/50
1250/1250 - 49s - loss: 3.0233 - accuracy100: 0.4476 - val_loss: 3.2203 - val_accuracy100: 0.5026 - 49s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 46s - loss: 2.9155 - accuracy100: 0.4767 - val_loss: 3.0145 - val_accuracy100: 0.5679 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 46s - loss: 2.7867 - accuracy100: 0.5306 - val_loss: 2.8718 - val_accuracy100: 0.5824 - 46s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 46s - loss: 2.7100 - accuracy100: 0.5503 - val_loss: 2.8431 - val_accuracy100: 0.5833 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 46s - loss: 2.6746 - accuracy100: 0.5588 - val_loss: 2.8786 - val_accuracy100: 0.5885 - 46s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 46s - loss: 2.6524 - accuracy100: 0.5635 - val_loss: 2.8679 - val_accuracy100: 0.5843 - 46s/epoch - 36ms/step
Epoch 7/50
1250/1250 - 46s - loss: 2.6350 - accuracy100: 0.5676 - val_loss: 2.8528 - val_accuracy100: 0.5834 - 46s/epoch - 37ms/step
Epoch 8/50
1250/1250 - 46s - loss: 2.6251 - accuracy100: 0.5694 - val_loss: 2.8690 - val_accuracy100: 0.5772 - 46s/epoch - 37ms/step
Epoch 9/50
1250/1250 - 45s - loss: 2.6172 - accuracy100: 0.5703 - val_loss: 2.8767 - val_accuracy100: 0.5801 - 45s/epoch - 36ms/step
Epoch 10/50
1250/1250 - 46s - loss: 2.6066 - accuracy100: 0.5723 - val_loss: 2.8754 - val_accuracy100: 0.5799 - 46s/epoch - 37ms/step
Epoch 11/50
1250/1250 - 46s - loss: 2.5985 - accuracy100: 0.5741 - val_loss: 2.8464 - val_accuracy100: 0.5852 - 46s/epoch - 37ms/step
Epoch 12/50
1250/1250 - 46s - loss: 2.5891 - accuracy100: 0.5760 - val_loss: 2.8634 - val_accuracy100: 0.5802 - 46s/epoch - 37ms/step
Epoch 13/50
1250/1250 - 45s - loss: 2.5829 - accuracy100: 0.5779 - val_loss: 2.8472 - val_accuracy100: 0.5749 - 45s/epoch - 36ms/step
Epoch 14/50
1250/1250 - 47s - loss: 2.5753 - accuracy100: 0.5792 - val_loss: 2.8574 - val_accuracy100: 0.5799 - 47s/epoch - 37ms/step
testing model: results/EXC/W9/deepVOL_L3/h100
Evaluating performance on  test set...
2354/2354 - 37s - 37s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9488671
{'0': {'precision': 0.4771013954430722, 'recall': 0.38767474722530904, 'f1-score': 0.42776425887170333, 'support': 145782}, '1': {'precision': 0.6277114644882421, 'recall': 0.6575962776785343, 'f1-score': 0.64230644375913, 'support': 312923}, '2': {'precision': 0.45822656690411523, 'recall': 0.4978597827070443, 'f1-score': 0.47722170517811335, 'support': 143677}, 'accuracy': 0.5541732654694197, 'macro avg': {'precision': 0.5210131422784765, 'recall': 0.514376935870296, 'f1-score': 0.5157641359363155, 'support': 602382}, 'weighted avg': {'precision': 0.5508377884558614, 'recall': 0.5541732654694197, 'f1-score': 0.5510101089045635, 'support': 602382}}
[[ 56516  63865  25401]
 [ 47974 205777  59172]
 [ 13967  58179  71531]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.908566
{'0': {'precision': 0.5387310171249766, 'recall': 0.4101106867758431, 'f1-score': 0.4657032811948725, 'support': 77245}, '1': {'precision': 0.6233790640856982, 'recall': 0.7117283912774266, 'f1-score': 0.6646305159266299, 'support': 163117}, '2': {'precision': 0.5103313788083186, 'recall': 0.4803318876107863, 'f1-score': 0.4948774074889583, 'support': 79545}, 'accuracy': 0.5813627085371686, 'macro avg': {'precision': 0.5574804866729978, 'recall': 0.5340569885546853, 'f1-score': 0.5417370682034869, 'support': 319907}, 'weighted avg': {'precision': 0.5748305280646981, 'recall': 0.5813627085371686, 'f1-score': 0.5743882103267862, 'support': 319907}}
[[ 31679  34770  10796]
 [ 21157 116095  25865]
 [  5967  35370  38208]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 16ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 0.9056582
{'0': {'precision': 0.49829980744807245, 'recall': 0.40338949323427964, 'f1-score': 0.4458495995308004, 'support': 30152}, '1': {'precision': 0.651192895520726, 'recall': 0.704733068209207, 'f1-score': 0.6769059366544644, 'support': 66384}, '2': {'precision': 0.49812302423603794, 'recall': 0.5028421367549779, 'f1-score': 0.5004714562207407, 'support': 30083}, 'accuracy': 0.5850069894723541, 'macro avg': {'precision': 0.5492052424016122, 'recall': 0.5369882327328215, 'f1-score': 0.5410756641353353, 'support': 126619}, 'weighted avg': {'precision': 0.5784168245564638, 'recall': 0.5850069894723541, 'f1-score': 0.579965594748112, 'support': 126619}}
[[12163 12546  5443]
 [ 9803 46783  9798]
 [ 2443 12513 15127]]
training model: results/EXC/W9/deepVOL_L3/h200
Epoch 1/50
1250/1250 - 47s - loss: 3.1837 - accuracy200: 0.4241 - val_loss: 3.2530 - val_accuracy200: 0.3984 - 47s/epoch - 37ms/step
Epoch 2/50
1250/1250 - 46s - loss: 3.1426 - accuracy200: 0.4378 - val_loss: 3.2112 - val_accuracy200: 0.4277 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 45s - loss: 3.1077 - accuracy200: 0.4565 - val_loss: 3.1398 - val_accuracy200: 0.4516 - 45s/epoch - 36ms/step
Epoch 4/50
1250/1250 - 46s - loss: 3.0569 - accuracy200: 0.4754 - val_loss: 3.1257 - val_accuracy200: 0.4668 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 46s - loss: 3.0226 - accuracy200: 0.4832 - val_loss: 3.1072 - val_accuracy200: 0.4682 - 46s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 45s - loss: 2.9953 - accuracy200: 0.4881 - val_loss: 3.0887 - val_accuracy200: 0.4713 - 45s/epoch - 36ms/step
Epoch 7/50
1250/1250 - 45s - loss: 2.9748 - accuracy200: 0.4923 - val_loss: 3.0756 - val_accuracy200: 0.4724 - 45s/epoch - 36ms/step
Epoch 8/50
1250/1250 - 45s - loss: 2.9584 - accuracy200: 0.4954 - val_loss: 3.1001 - val_accuracy200: 0.4710 - 45s/epoch - 36ms/step
Epoch 9/50
1250/1250 - 48s - loss: 2.9478 - accuracy200: 0.4992 - val_loss: 3.1138 - val_accuracy200: 0.4694 - 48s/epoch - 39ms/step
Epoch 10/50
1250/1250 - 46s - loss: 2.9367 - accuracy200: 0.5021 - val_loss: 3.1245 - val_accuracy200: 0.4702 - 46s/epoch - 37ms/step
Epoch 11/50
1250/1250 - 45s - loss: 2.9267 - accuracy200: 0.5042 - val_loss: 3.1390 - val_accuracy200: 0.4693 - 45s/epoch - 36ms/step
Epoch 12/50
1250/1250 - 45s - loss: 2.9165 - accuracy200: 0.5064 - val_loss: 3.1515 - val_accuracy200: 0.4697 - 45s/epoch - 36ms/step
Epoch 13/50
1250/1250 - 46s - loss: 2.9048 - accuracy200: 0.5105 - val_loss: 3.1851 - val_accuracy200: 0.4689 - 46s/epoch - 36ms/step
Epoch 14/50
1250/1250 - 45s - loss: 2.8918 - accuracy200: 0.5141 - val_loss: 3.2316 - val_accuracy200: 0.4664 - 45s/epoch - 36ms/step
Epoch 15/50
1250/1250 - 45s - loss: 2.8849 - accuracy200: 0.5169 - val_loss: 3.2314 - val_accuracy200: 0.4657 - 45s/epoch - 36ms/step
Epoch 16/50
1250/1250 - 45s - loss: 2.8733 - accuracy200: 0.5194 - val_loss: 3.2748 - val_accuracy200: 0.4619 - 45s/epoch - 36ms/step
Epoch 17/50
1250/1250 - 46s - loss: 2.8618 - accuracy200: 0.5230 - val_loss: 3.3026 - val_accuracy200: 0.4607 - 46s/epoch - 36ms/step
testing model: results/EXC/W9/deepVOL_L3/h200
Evaluating performance on  test set...
2354/2354 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0537066
{'0': {'precision': 0.4441465924707129, 'recall': 0.37995550588334526, 'f1-score': 0.4095510582138362, 'support': 189688}, '1': {'precision': 0.44982205174553613, 'recall': 0.4629571935946165, 'f1-score': 0.4562951135364187, 'support': 224686}, '2': {'precision': 0.4346602062605931, 'recall': 0.4828730692310966, 'f1-score': 0.4574999370070804, 'support': 188008}, 'accuracy': 0.44303614649840134, 'macro avg': {'precision': 0.44287628349228075, 'recall': 0.4419285895696861, 'f1-score': 0.4411153695857784, 'support': 602382}, 'weighted avg': {'precision': 0.4433027421299502, 'recall': 0.44303614649840134, 'f1-score': 0.441951607397527, 'support': 602382}}
[[ 72073  64229  53386]
 [ 55974 104020  64692]
 [ 34226  62998  90784]]
Evaluating performance on  train set...
1250/1250 - 20s - 20s/epoch - 16ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0192316
{'0': {'precision': 0.5120645052102222, 'recall': 0.4158714263273641, 'f1-score': 0.4589821105440518, 'support': 101856}, '1': {'precision': 0.4446265663079345, 'recall': 0.5410124301297247, 'f1-score': 0.48810670033935755, 'support': 114319}, '2': {'precision': 0.49113005179234126, 'recall': 0.4643890024293371, 'f1-score': 0.4773853411027867, 'support': 103732}, 'accuracy': 0.4763228063155855, 'macro avg': {'precision': 0.48260704110349933, 'recall': 0.47375761962880863, 'f1-score': 0.47482471732873205, 'support': 319907}, 'weighted avg': {'precision': 0.48117737095147123, 'recall': 0.4763228063155855, 'f1-score': 0.47535717546331974, 'support': 319907}}
[[42359 37496 22001]
 [24560 61848 27911]
 [15803 39757 48172]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0248994
{'0': {'precision': 0.4828643317812419, 'recall': 0.41621379069651493, 'f1-score': 0.44706858925439474, 'support': 40114}, '1': {'precision': 0.468808346005043, 'recall': 0.5179703117689592, 'f1-score': 0.49216468805253855, 'support': 47022}, '2': {'precision': 0.46828307016887427, 'recall': 0.4754704556391358, 'f1-score': 0.4718493942592872, 'support': 39483}, 'accuracy': 0.47248043342626306, 'macro avg': {'precision': 0.4733185826517197, 'recall': 0.4698848527015367, 'f1-score': 0.47036089052207347, 'support': 126619}, 'weighted avg': {'precision': 0.47309761023542696, 'recall': 0.47248043342626306, 'f1-score': 0.471543030544363, 'support': 126619}}
[[16696 13359 10059]
 [11409 24356 11257]
 [ 6472 14238 18773]]
training model: results/EXC/W9/deepVOL_L3/h300
Epoch 1/50
1250/1250 - 49s - loss: 3.2503 - accuracy300: 0.4013 - val_loss: 3.3281 - val_accuracy300: 0.3651 - 49s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 46s - loss: 3.2201 - accuracy300: 0.4099 - val_loss: 3.2365 - val_accuracy300: 0.3814 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 45s - loss: 3.1996 - accuracy300: 0.4187 - val_loss: 3.2408 - val_accuracy300: 0.3877 - 45s/epoch - 36ms/step
Epoch 4/50
1250/1250 - 46s - loss: 3.1791 - accuracy300: 0.4295 - val_loss: 3.3387 - val_accuracy300: 0.3833 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 46s - loss: 3.1611 - accuracy300: 0.4388 - val_loss: 3.2719 - val_accuracy300: 0.4022 - 46s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 46s - loss: 3.1435 - accuracy300: 0.4454 - val_loss: 3.2420 - val_accuracy300: 0.4145 - 46s/epoch - 37ms/step
Epoch 7/50
1250/1250 - 47s - loss: 3.1221 - accuracy300: 0.4522 - val_loss: 3.2346 - val_accuracy300: 0.4228 - 47s/epoch - 37ms/step
Epoch 8/50
1250/1250 - 49s - loss: 3.1033 - accuracy300: 0.4568 - val_loss: 3.1785 - val_accuracy300: 0.4324 - 49s/epoch - 39ms/step
Epoch 9/50
1250/1250 - 43s - loss: 3.0866 - accuracy300: 0.4603 - val_loss: 3.1909 - val_accuracy300: 0.4296 - 43s/epoch - 35ms/step
Epoch 10/50
1250/1250 - 46s - loss: 3.0736 - accuracy300: 0.4631 - val_loss: 3.1985 - val_accuracy300: 0.4333 - 46s/epoch - 37ms/step
Epoch 11/50
1250/1250 - 47s - loss: 3.0644 - accuracy300: 0.4663 - val_loss: 3.2771 - val_accuracy300: 0.4241 - 47s/epoch - 37ms/step
Epoch 12/50
1250/1250 - 45s - loss: 3.0511 - accuracy300: 0.4713 - val_loss: 3.3016 - val_accuracy300: 0.4172 - 45s/epoch - 36ms/step
Epoch 13/50
1250/1250 - 46s - loss: 3.0416 - accuracy300: 0.4750 - val_loss: 3.3418 - val_accuracy300: 0.4140 - 46s/epoch - 36ms/step
Epoch 14/50
1250/1250 - 46s - loss: 3.0301 - accuracy300: 0.4781 - val_loss: 3.3316 - val_accuracy300: 0.4120 - 46s/epoch - 37ms/step
Epoch 15/50
1250/1250 - 46s - loss: 3.0202 - accuracy300: 0.4812 - val_loss: 3.3363 - val_accuracy300: 0.4142 - 46s/epoch - 37ms/step
Epoch 16/50
1250/1250 - 46s - loss: 3.0135 - accuracy300: 0.4830 - val_loss: 3.4008 - val_accuracy300: 0.4066 - 46s/epoch - 37ms/step
Epoch 17/50
1250/1250 - 46s - loss: 3.0044 - accuracy300: 0.4859 - val_loss: 3.4147 - val_accuracy300: 0.4071 - 46s/epoch - 37ms/step
Epoch 18/50
1250/1250 - 46s - loss: 2.9950 - accuracy300: 0.4896 - val_loss: 3.4219 - val_accuracy300: 0.4042 - 46s/epoch - 37ms/step
testing model: results/EXC/W9/deepVOL_L3/h300
Evaluating performance on  test set...
2354/2354 - 35s - 35s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.080483
{'0': {'precision': 0.4125614057045285, 'recall': 0.4688935175777281, 'f1-score': 0.43892742244214217, 'support': 196840}, '1': {'precision': 0.40012956528323473, 'recall': 0.4533746425166826, 'f1-score': 0.4250912812445533, 'support': 209800}, '2': {'precision': 0.4395411041029607, 'recall': 0.3164982476933923, 'f1-score': 0.36800727080480794, 'support': 195742}, 'accuracy': 0.41396821286160607, 'macro avg': {'precision': 0.417410691696908, 'recall': 0.4129221359292677, 'f1-score': 0.4106753248305011, 'support': 602382}, 'weighted avg': {'precision': 0.4169985568868655, 'recall': 0.41396821286160607, 'f1-score': 0.4110632519572186, 'support': 602382}}
[[92297 68641 35902]
 [71589 95118 43093]
 [59831 73959 61952]]
Evaluating performance on  train set...
1250/1250 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0600712
{'0': {'precision': 0.4617412368196067, 'recall': 0.4873756838562915, 'f1-score': 0.4742122833493391, 'support': 106382}, '1': {'precision': 0.3896687334940866, 'recall': 0.5163222806500385, 'f1-score': 0.444142703480882, 'support': 105163}, '2': {'precision': 0.493811790552911, 'recall': 0.31113305402262786, 'f1-score': 0.3817433493548916, 'support': 108362}, 'accuracy': 0.4371926841238235, 'macro avg': {'precision': 0.44840725362220146, 'recall': 0.43827700617631926, 'f1-score': 0.4333661120617043, 'support': 319907}, 'weighted avg': {'precision': 0.44891209796496034, 'recall': 0.4371926841238235, 'f1-score': 0.4330055393480735, 'support': 319907}}
[[51848 39453 15081]
 [31386 54298 19479]
 [29054 45593 33715]]
Evaluating performance on  val set...
495/495 - 8s - 8s/epoch - 17ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0605197
{'0': {'precision': 0.44607681529712356, 'recall': 0.5064330494993918, 'f1-score': 0.47434268185801937, 'support': 42748}, '1': {'precision': 0.4005856107083101, 'recall': 0.4732668141384666, 'f1-score': 0.4339036440915662, 'support': 42494}, '2': {'precision': 0.4676326076821002, 'recall': 0.31512676124416944, 'f1-score': 0.37652324574068724, 'support': 41377}, 'accuracy': 0.4327865486222447, 'macro avg': {'precision': 0.4380983445625113, 'recall': 0.43160887496067596, 'f1-score': 0.42825652389675756, 'support': 126619}, 'weighted avg': {'precision': 0.4378538059045058, 'recall': 0.4327865486222447, 'f1-score': 0.428805351132974, 'support': 126619}}
[[21649 13885  7214]
 [14753 20111  7630]
 [12130 16208 13039]]
training model: results/EXC/W9/deepVOL_L3/h500
Epoch 1/50
1250/1250 - 48s - loss: 3.2726 - accuracy500: 0.3902 - val_loss: 3.3458 - val_accuracy500: 0.3666 - 48s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 46s - loss: 3.2499 - accuracy500: 0.3945 - val_loss: 3.2836 - val_accuracy500: 0.3740 - 46s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 46s - loss: 3.2377 - accuracy500: 0.4006 - val_loss: 3.2926 - val_accuracy500: 0.3701 - 46s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 46s - loss: 3.2301 - accuracy500: 0.4050 - val_loss: 3.3057 - val_accuracy500: 0.3685 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 49s - loss: 3.2159 - accuracy500: 0.4129 - val_loss: 3.3435 - val_accuracy500: 0.3660 - 49s/epoch - 39ms/step
Epoch 6/50
1250/1250 - 47s - loss: 3.2021 - accuracy500: 0.4197 - val_loss: 3.3635 - val_accuracy500: 0.3646 - 47s/epoch - 37ms/step
Epoch 7/50
1250/1250 - 47s - loss: 3.1919 - accuracy500: 0.4246 - val_loss: 3.3902 - val_accuracy500: 0.3580 - 47s/epoch - 38ms/step
Epoch 8/50
1250/1250 - 46s - loss: 3.1797 - accuracy500: 0.4293 - val_loss: 3.3941 - val_accuracy500: 0.3655 - 46s/epoch - 37ms/step
Epoch 9/50
1250/1250 - 45s - loss: 3.1704 - accuracy500: 0.4344 - val_loss: 3.4225 - val_accuracy500: 0.3556 - 45s/epoch - 36ms/step
Epoch 10/50
1250/1250 - 46s - loss: 3.1571 - accuracy500: 0.4403 - val_loss: 3.4271 - val_accuracy500: 0.3561 - 46s/epoch - 37ms/step
Epoch 11/50
1250/1250 - 46s - loss: 3.1450 - accuracy500: 0.4452 - val_loss: 3.4422 - val_accuracy500: 0.3561 - 46s/epoch - 37ms/step
Epoch 12/50
1250/1250 - 48s - loss: 3.1382 - accuracy500: 0.4479 - val_loss: 3.4736 - val_accuracy500: 0.3580 - 48s/epoch - 38ms/step
testing model: results/EXC/W9/deepVOL_L3/h500
Evaluating performance on  test set...
2354/2354 - 33s - 33s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026407
{'0': {'precision': 0.3522512648076935, 'recall': 0.5803009436368274, 'f1-score': 0.4383920589413977, 'support': 196050}, '1': {'precision': 0.3394852234502643, 'recall': 0.32510905517472793, 'f1-score': 0.3321416503014305, 'support': 208610}, '2': {'precision': 0.40223779385171793, 'recall': 0.16200018207382083, 'f1-score': 0.23097557633926322, 'support': 197722}, 'accuracy': 0.35462547021657354, 'macro avg': {'precision': 0.3646580940365585, 'recall': 0.35580339362845875, 'f1-score': 0.3338364285273638, 'support': 602382}, 'weighted avg': {'precision': 0.3642375336671037, 'recall': 0.35462547021657354, 'f1-score': 0.3335155860065444, 'support': 602382}}
[[113768  62840  19442]
 [112630  67821  28159]
 [ 96576  69115  32031]]
Evaluating performance on  train set...
1250/1250 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.094404
{'0': {'precision': 0.38030215158109915, 'recall': 0.6270177132740682, 'f1-score': 0.4734468042519426, 'support': 105627}, '1': {'precision': 0.33936582225446815, 'recall': 0.3147330313311473, 'f1-score': 0.32658560210839965, 'support': 105518}, '2': {'precision': 0.4488798880932, 'recall': 0.19767933653298028, 'f1-score': 0.27448151718062797, 'support': 108762}, 'accuracy': 0.3780473700169112, 'macro avg': {'precision': 0.38951595397625577, 'recall': 0.3798100270460652, 'f1-score': 0.3581713078469901, 'support': 319907}, 'weighted avg': {'precision': 0.3901147914440646, 'recall': 0.3780473700169112, 'f1-score': 0.35736193308553266, 'support': 319907}}
[[66230 29348 10049]
 [55960 33210 16348]
 [51961 35301 21500]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.095818
{'0': {'precision': 0.37303209412804506, 'recall': 0.6313427603131939, 'f1-score': 0.46897054610797156, 'support': 42785}, '1': {'precision': 0.34734423570752804, 'recall': 0.30045828656939766, 'f1-score': 0.32220453092285894, 'support': 42768}, '2': {'precision': 0.43045549616546597, 'recall': 0.18041688988457605, 'f1-score': 0.254264044751021, 'support': 41066}, 'accuracy': 0.37333259621383835, 'macro avg': {'precision': 0.383610608667013, 'recall': 0.37073931225572254, 'f1-score': 0.34847970726061717, 'support': 126619}, 'weighted avg': {'precision': 0.382979504067628, 'recall': 0.37333259621383835, 'f1-score': 0.3497623220486959, 'support': 126619}}
[[27012 11845  3928]
 [24043 12850  5875]
 [21357 12300  7409]]
training model: results/EXC/W9/deepVOL_L3/h1000
Epoch 1/50
1250/1250 - 49s - loss: 3.2188 - accuracy1000: 0.4276 - val_loss: 3.4182 - val_accuracy1000: 0.3191 - 49s/epoch - 39ms/step
Epoch 2/50
1250/1250 - 47s - loss: 3.2469 - accuracy1000: 0.4035 - val_loss: 3.4338 - val_accuracy1000: 0.3201 - 47s/epoch - 37ms/step
Epoch 3/50
1250/1250 - 47s - loss: 3.2261 - accuracy1000: 0.4181 - val_loss: 3.4347 - val_accuracy1000: 0.3210 - 47s/epoch - 37ms/step
Epoch 4/50
1250/1250 - 46s - loss: 3.2531 - accuracy1000: 0.3995 - val_loss: 3.4761 - val_accuracy1000: 0.3251 - 46s/epoch - 37ms/step
Epoch 5/50
1250/1250 - 47s - loss: 3.2583 - accuracy1000: 0.3907 - val_loss: 3.5227 - val_accuracy1000: 0.3264 - 47s/epoch - 37ms/step
Epoch 6/50
1250/1250 - 46s - loss: 3.2515 - accuracy1000: 0.3989 - val_loss: 3.5352 - val_accuracy1000: 0.3238 - 46s/epoch - 37ms/step
Epoch 7/50
1250/1250 - 46s - loss: 3.2259 - accuracy1000: 0.4166 - val_loss: 3.5281 - val_accuracy1000: 0.3226 - 46s/epoch - 37ms/step
Epoch 8/50
1250/1250 - 45s - loss: 3.2212 - accuracy1000: 0.4237 - val_loss: 3.5346 - val_accuracy1000: 0.3250 - 45s/epoch - 36ms/step
Epoch 9/50
1250/1250 - 46s - loss: 3.2330 - accuracy1000: 0.4084 - val_loss: 3.6228 - val_accuracy1000: 0.3220 - 46s/epoch - 37ms/step
Epoch 10/50
1250/1250 - 45s - loss: 3.2148 - accuracy1000: 0.4148 - val_loss: 3.6497 - val_accuracy1000: 0.3236 - 45s/epoch - 36ms/step
Epoch 11/50
1250/1250 - 48s - loss: 3.2067 - accuracy1000: 0.4216 - val_loss: 3.6898 - val_accuracy1000: 0.3248 - 48s/epoch - 38ms/step
testing model: results/EXC/W9/deepVOL_L3/h1000
Evaluating performance on  test set...
2354/2354 - 36s - 36s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1825521
{'0': {'precision': 0.24142649204305264, 'recall': 0.9905766952304852, 'f1-score': 0.3882318797540547, 'support': 145172}, '1': {'precision': 0.5191424196018377, 'recall': 0.0010856685348278623, 'f1-score': 0.0021668056873855477, 'support': 312250}, '2': {'precision': 0.23693723299375616, 'recall': 0.00994757174392936, 'f1-score': 0.01909352117897859, 'support': 144960}, 'accuracy': 0.24168218837880281, 'macro avg': {'precision': 0.33250204821288215, 'recall': 0.3338699785030808, 'f1-score': 0.13649740220680628, 'support': 602382}, 'weighted avg': {'precision': 0.3843026659467294, 'recall': 0.24168218837880281, 'f1-score': 0.09928049037595164, 'support': 602382}}
[[143804    160   1208]
 [308475    339   3436]
 [143364    154   1442]]
Evaluating performance on  train set...
1250/1250 - 19s - 19s/epoch - 15ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1225798
{'0': {'precision': 0.3347369426143416, 'recall': 0.9818237831176833, 'f1-score': 0.49925944914409404, 'support': 107118}, '1': {'precision': 0.2825112107623318, 'recall': 0.0012057877813504824, 'f1-score': 0.002401326446989766, 'support': 104496}, '2': {'precision': 0.35040789224056157, 'recall': 0.017055580693119594, 'f1-score': 0.03252791377549224, 'support': 108293}, 'accuracy': 0.3349223368041337, 'macro avg': {'precision': 0.322552015205745, 'recall': 0.33336171719738444, 'f1-score': 0.17806289645552534, 'support': 319907}, 'weighted avg': {'precision': 0.3229825079575964, 'recall': 0.3349223368041337, 'f1-score': 0.1789681002551088, 'support': 319907}}
[[105171    157   1790]
 [102736    126   1634]
 [106283    163   1847]]
Evaluating performance on  val set...
495/495 - 7s - 7s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1353273
{'0': {'precision': 0.3195424443106562, 'recall': 0.9821128984506069, 'f1-score': 0.48219639385368274, 'support': 40532}, '1': {'precision': 0.4624277456647399, 'recall': 0.001639209900827801, 'f1-score': 0.003266839536925496, 'support': 48804}, '2': {'precision': 0.310529128808124, 'recall': 0.015583509910683153, 'f1-score': 0.029677682995351687, 'support': 37283}, 'accuracy': 0.31960448273955727, 'macro avg': {'precision': 0.36416643959450673, 'recall': 0.33311187275403925, 'f1-score': 0.17171363879531998, 'support': 126619}, 'weighted avg': {'precision': 0.37196215071651784, 'recall': 0.31960448273955727, 'f1-score': 0.16435362881995025, 'support': 126619}}
[[39807    44   681]
 [48115    80   609]
 [36653    49   581]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        21 (peak)  15.39 (ave)

============================================
