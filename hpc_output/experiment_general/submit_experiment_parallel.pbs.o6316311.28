This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-17.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-09.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-27.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-28.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-05.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-01.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-03.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-29.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-02.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-15.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-04.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-03-26.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-11.csv
data/ATVI_orderbooks/ATVI_orderbooks_2019-04-10.csv
training model: results/ATVI/W2/deepLOB_L1/h10
Epoch 1/50
2058/2058 - 42s - loss: 2.9454 - accuracy10: 0.4422 - val_loss: 3.9102 - val_accuracy10: 0.4687 - 42s/epoch - 20ms/step
Epoch 2/50
2058/2058 - 31s - loss: 2.8709 - accuracy10: 0.4614 - val_loss: 3.5075 - val_accuracy10: 0.4690 - 31s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 2.7822 - accuracy10: 0.5046 - val_loss: 3.5526 - val_accuracy10: 0.4769 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 31s - loss: 2.7037 - accuracy10: 0.5401 - val_loss: 3.6154 - val_accuracy10: 0.4865 - 31s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 2.6634 - accuracy10: 0.5544 - val_loss: 3.5466 - val_accuracy10: 0.4934 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 31s - loss: 2.6398 - accuracy10: 0.5609 - val_loss: 3.4555 - val_accuracy10: 0.5184 - 31s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 2.6214 - accuracy10: 0.5660 - val_loss: 3.4329 - val_accuracy10: 0.5177 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 2.6059 - accuracy10: 0.5699 - val_loss: 3.4388 - val_accuracy10: 0.4968 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 31s - loss: 2.5952 - accuracy10: 0.5726 - val_loss: 3.4085 - val_accuracy10: 0.5121 - 31s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 31s - loss: 2.5823 - accuracy10: 0.5751 - val_loss: 3.4392 - val_accuracy10: 0.5147 - 31s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 2.5722 - accuracy10: 0.5767 - val_loss: 3.4608 - val_accuracy10: 0.5209 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 30s - loss: 2.5638 - accuracy10: 0.5785 - val_loss: 3.4013 - val_accuracy10: 0.5205 - 30s/epoch - 15ms/step
Epoch 13/50
2058/2058 - 30s - loss: 2.5555 - accuracy10: 0.5798 - val_loss: 3.4552 - val_accuracy10: 0.5147 - 30s/epoch - 15ms/step
Epoch 14/50
2058/2058 - 30s - loss: 2.5481 - accuracy10: 0.5807 - val_loss: 3.4424 - val_accuracy10: 0.5283 - 30s/epoch - 15ms/step
Epoch 15/50
2058/2058 - 30s - loss: 2.5418 - accuracy10: 0.5819 - val_loss: 3.4981 - val_accuracy10: 0.5329 - 30s/epoch - 15ms/step
Epoch 16/50
2058/2058 - 30s - loss: 2.5368 - accuracy10: 0.5826 - val_loss: 3.5090 - val_accuracy10: 0.5436 - 30s/epoch - 15ms/step
Epoch 17/50
2058/2058 - 30s - loss: 2.5312 - accuracy10: 0.5838 - val_loss: 3.4374 - val_accuracy10: 0.5441 - 30s/epoch - 15ms/step
Epoch 18/50
2058/2058 - 30s - loss: 2.5256 - accuracy10: 0.5847 - val_loss: 3.5246 - val_accuracy10: 0.5493 - 30s/epoch - 15ms/step
Epoch 19/50
2058/2058 - 30s - loss: 2.5225 - accuracy10: 0.5848 - val_loss: 3.4794 - val_accuracy10: 0.5414 - 30s/epoch - 15ms/step
Epoch 20/50
2058/2058 - 31s - loss: 2.5166 - accuracy10: 0.5853 - val_loss: 3.5369 - val_accuracy10: 0.5474 - 31s/epoch - 15ms/step
Epoch 21/50
2058/2058 - 30s - loss: 2.5126 - accuracy10: 0.5870 - val_loss: 3.5260 - val_accuracy10: 0.5444 - 30s/epoch - 15ms/step
Epoch 22/50
2058/2058 - 30s - loss: 2.5090 - accuracy10: 0.5868 - val_loss: 3.6003 - val_accuracy10: 0.5495 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h10
Evaluating performance on  test set...
5497/5497 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8845022
{'0': {'precision': 0.4204634145480101, 'recall': 0.4362281350988913, 'f1-score': 0.428200724709352, 'support': 272926}, '1': {'precision': 0.7651975372286206, 'recall': 0.6015266033076405, 'f1-score': 0.6735619307169058, 'support': 868595}, '2': {'precision': 0.35662256308444046, 'recall': 0.5922688949111713, 'f1-score': 0.4451856944409079, 'support': 265680}, 'accuracy': 0.5677191815525998, 'macro avg': {'precision': 0.5140945049536904, 'recall': 0.5433412111059011, 'f1-score': 0.5156494499557219, 'support': 1407201}, 'weighted avg': {'precision': 0.6211974233164261, 'recall': 0.5677191815525998, 'f1-score': 0.5828567287133366, 'support': 1407201}}
[[119058  92544  61324]
 [123556 522483 222556]
 [ 40545  67781 157354]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.91552836
{'0': {'precision': 0.4550402940760639, 'recall': 0.26903786675583047, 'f1-score': 0.3381487707501576, 'support': 95704}, '1': {'precision': 0.7412391651418282, 'recall': 0.6088575911088756, 'f1-score': 0.6685581465688709, 'support': 333996}, '2': {'precision': 0.32950983695263764, 'recall': 0.6646040113669124, 'f1-score': 0.4405804421571371, 'support': 97124}, 'accuracy': 0.5574024721728699, 'macro avg': {'precision': 0.5085964320568432, 'recall': 0.5141664897438728, 'f1-score': 0.48242911982538855, 'support': 526824}, 'weighted avg': {'precision': 0.6133422279720621, 'recall': 0.5574024721728699, 'f1-score': 0.5665058378915151, 'support': 526824}}
[[ 25748  45550  24406]
 [ 23701 203356 106939]
 [  7135  25440  64549]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9583514
{'0': {'precision': 0.46174328877295945, 'recall': 0.23948028522307713, 'f1-score': 0.3153870422953436, 'support': 35481}, '1': {'precision': 0.7096928219003661, 'recall': 0.559262510974539, 'f1-score': 0.625561167227834, 'support': 103649}, '2': {'precision': 0.326470667493061, 'recall': 0.6889590264153089, 'f1-score': 0.4430142521506211, 'support': 35169}, 'accuracy': 0.5203357448981348, 'macro avg': {'precision': 0.49930225938879547, 'recall': 0.4959006075376417, 'f1-score': 0.4613208205579329, 'support': 174299}, 'weighted avg': {'precision': 0.5818949726112478, 'recall': 0.5203357448981348, 'f1-score': 0.5255876700587154, 'support': 174299}}
[[ 8497 15423 11561]
 [ 7255 57967 38427]
 [ 2650  8289 24230]]
training model: results/ATVI/W2/deepLOB_L1/h20
Epoch 1/50
2058/2058 - 33s - loss: 3.0069 - accuracy20: 0.4561 - val_loss: 3.4514 - val_accuracy20: 0.4222 - 33s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 2.9460 - accuracy20: 0.4759 - val_loss: 3.9521 - val_accuracy20: 0.4440 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 2.8745 - accuracy20: 0.5081 - val_loss: 3.8072 - val_accuracy20: 0.4694 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 2.8153 - accuracy20: 0.5308 - val_loss: 3.6381 - val_accuracy20: 0.4615 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 2.7861 - accuracy20: 0.5419 - val_loss: 3.9075 - val_accuracy20: 0.4480 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 2.7641 - accuracy20: 0.5487 - val_loss: 3.8450 - val_accuracy20: 0.4520 - 30s/epoch - 14ms/step
Epoch 7/50
2058/2058 - 30s - loss: 2.7479 - accuracy20: 0.5526 - val_loss: 3.8881 - val_accuracy20: 0.4504 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 31s - loss: 2.7356 - accuracy20: 0.5555 - val_loss: 3.8021 - val_accuracy20: 0.4616 - 31s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 2.7247 - accuracy20: 0.5587 - val_loss: 3.8979 - val_accuracy20: 0.4685 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 2.7137 - accuracy20: 0.5613 - val_loss: 3.8222 - val_accuracy20: 0.4693 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 2.7058 - accuracy20: 0.5627 - val_loss: 3.8439 - val_accuracy20: 0.4604 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h20
Evaluating performance on  test set...
5497/5497 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.028099
{'0': {'precision': 0.4092937656000487, 'recall': 0.2531593872106731, 'f1-score': 0.31282682691997954, 'support': 345241}, '1': {'precision': 0.5557077515977727, 'recall': 0.44999972235179136, 'f1-score': 0.4972983504749748, 'support': 720336}, '2': {'precision': 0.34105133464843007, 'recall': 0.6093248717888673, 'f1-score': 0.43732378683406653, 'support': 341624}, 'accuracy': 0.4403862703338045, 'macro avg': {'precision': 0.4353509506154172, 'recall': 0.43749466045044394, 'f1-score': 0.41581632140967356, 'support': 1407201}, 'weighted avg': {'precision': 0.467674915688942, 'recall': 0.4403862703338045, 'f1-score': 0.4374803972522925, 'support': 1407201}}
[[ 87401 150790 107050]
 [101047 324151 295138]
 [ 25093 108371 208160]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0527347
{'0': {'precision': 0.44608816309104493, 'recall': 0.16814586535134657, 'f1-score': 0.24423225263551576, 'support': 124279}, '1': {'precision': 0.569110414527374, 'recall': 0.45630436902143884, 'f1-score': 0.5065024861562881, 'support': 276927}, '2': {'precision': 0.3276576608010297, 'recall': 0.6728096291932685, 'f1-score': 0.4406965254548821, 'support': 125618}, 'accuracy': 0.4399514828481618, 'macro avg': {'precision': 0.4476187461398162, 'recall': 0.4324199545220179, 'f1-score': 0.39714375474889535, 'support': 526824}, 'weighted avg': {'precision': 0.48251623050414905, 'recall': 0.4399514828481618, 'f1-score': 0.4289412977458943, 'support': 526824}}
[[ 20897  59250  44132]
 [ 21270 126363 129294]
 [  4678  36423  84517]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0689228
{'0': {'precision': 0.4399975633528265, 'recall': 0.16063605026131436, 'f1-score': 0.23534970104755543, 'support': 44965}, '1': {'precision': 0.5283165013257068, 'recall': 0.41883753336010016, 'f1-score': 0.4672498287400538, 'support': 84682}, '2': {'precision': 0.3380422924770521, 'recall': 0.6870240974648392, 'f1-score': 0.4531281157450831, 'support': 44652}, 'accuracy': 0.42093184699854846, 'macro avg': {'precision': 0.4354521190518618, 'recall': 0.42216589369541796, 'f1-score': 0.38524254851089745, 'support': 174299}, 'weighted avg': {'precision': 0.45678777758397165, 'recall': 0.42093184699854846, 'f1-score': 0.4038073995216152, 'support': 174299}}
[[ 7223 19440 18302]
 [ 7444 35468 41770]
 [ 1749 12226 30677]]
training model: results/ATVI/W2/deepLOB_L1/h30
Epoch 1/50
2058/2058 - 33s - loss: 3.0657 - accuracy30: 0.4569 - val_loss: 3.5076 - val_accuracy30: 0.4154 - 33s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.0233 - accuracy30: 0.4663 - val_loss: 3.6286 - val_accuracy30: 0.3959 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 2.9548 - accuracy30: 0.4976 - val_loss: 3.3941 - val_accuracy30: 0.4250 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 2.9061 - accuracy30: 0.5172 - val_loss: 3.5307 - val_accuracy30: 0.4333 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 30s - loss: 2.8720 - accuracy30: 0.5274 - val_loss: 3.5852 - val_accuracy30: 0.4331 - 30s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 2.8534 - accuracy30: 0.5324 - val_loss: 3.7191 - val_accuracy30: 0.4333 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 2.8385 - accuracy30: 0.5375 - val_loss: 3.6007 - val_accuracy30: 0.4461 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 2.8266 - accuracy30: 0.5403 - val_loss: 3.6754 - val_accuracy30: 0.4429 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 2.8205 - accuracy30: 0.5417 - val_loss: 3.6547 - val_accuracy30: 0.4395 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 2.8097 - accuracy30: 0.5439 - val_loss: 3.6316 - val_accuracy30: 0.4396 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 2.8001 - accuracy30: 0.5457 - val_loss: 3.6928 - val_accuracy30: 0.4330 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 30s - loss: 2.7923 - accuracy30: 0.5474 - val_loss: 3.7449 - val_accuracy30: 0.4302 - 30s/epoch - 15ms/step
Epoch 13/50
2058/2058 - 30s - loss: 2.7864 - accuracy30: 0.5479 - val_loss: 3.6172 - val_accuracy30: 0.4360 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h30
Evaluating performance on  test set...
5497/5497 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0269105
{'0': {'precision': 0.4565307121533544, 'recall': 0.3627488368545496, 'f1-score': 0.40427222923493433, 'support': 393330}, '1': {'precision': 0.5338866973932804, 'recall': 0.5230171488954539, 'f1-score': 0.528396030129614, 'support': 620798}, '2': {'precision': 0.4180460462353369, 'recall': 0.5174204282665053, 'f1-score': 0.4624549787172118, 'support': 393073}, 'accuracy': 0.47665685285897325, 'macro avg': {'precision': 0.4694878185939906, 'recall': 0.46772880467216965, 'f1-score': 0.46504107936058675, 'support': 1407201}, 'weighted avg': {'precision': 0.47990701577919226, 'recall': 0.47665685285897325, 'f1-score': 0.4752826074503155, 'support': 1407201}}
[[142680 149807 100843]
 [113826 324688 182284]
 [ 56025 133664 203384]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0555897
{'0': {'precision': 0.4661204068869574, 'recall': 0.2540874114684069, 'f1-score': 0.3288920908661098, 'support': 143734}, '1': {'precision': 0.5270148603514206, 'recall': 0.45739876403691926, 'f1-score': 0.48974524484788234, 'support': 238033}, '2': {'precision': 0.3815357011447683, 'recall': 0.6362119718455503, 'f1-score': 0.4770093554556262, 'support': 145057}, 'accuracy': 0.4511639560840053, 'macro avg': {'precision': 0.4582236561277154, 'recall': 0.4492327157836255, 'f1-score': 0.43188223038987283, 'support': 526824}, 'weighted avg': {'precision': 0.47034437121026434, 'recall': 0.4511639560840053, 'f1-score': 0.4423527624590986, 'support': 526824}}
[[ 36521  58516  48697]
 [ 28258 108876 100899]
 [ 13572  39198  92287]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0927312
{'0': {'precision': 0.44418649026841367, 'recall': 0.27294223403423745, 'f1-score': 0.3381185242568025, 'support': 51172}, '1': {'precision': 0.5009402574858961, 'recall': 0.33525108219121247, 'f1-score': 0.40168022668146947, 'support': 72307}, '2': {'precision': 0.38248433265582654, 'recall': 0.7109602518693428, 'f1-score': 0.4973844332479832, 'support': 50820}, 'accuracy': 0.4265027338079966, 'macro avg': {'precision': 0.44253702680337875, 'recall': 0.4397178560315975, 'f1-score': 0.41239439472875167, 'support': 174299}, 'weighted avg': {'precision': 0.44974011361864985, 'recall': 0.4265027338079966, 'f1-score': 0.41092358631769904, 'support': 174299}}
[[13967 14863 22342]
 [12075 24241 35991]
 [ 5402  9287 36131]]
training model: results/ATVI/W2/deepLOB_L1/h50
Epoch 1/50
2058/2058 - 32s - loss: 3.1356 - accuracy50: 0.4461 - val_loss: 3.4484 - val_accuracy50: 0.3686 - 32s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.1074 - accuracy50: 0.4590 - val_loss: 3.5182 - val_accuracy50: 0.3682 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 3.0499 - accuracy50: 0.4807 - val_loss: 3.5011 - val_accuracy50: 0.3778 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.0173 - accuracy50: 0.4913 - val_loss: 3.4351 - val_accuracy50: 0.4032 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 30s - loss: 2.9921 - accuracy50: 0.4977 - val_loss: 3.5053 - val_accuracy50: 0.3975 - 30s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 2.9740 - accuracy50: 0.5028 - val_loss: 3.4437 - val_accuracy50: 0.4125 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 2.9610 - accuracy50: 0.5051 - val_loss: 3.4611 - val_accuracy50: 0.4106 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 2.9523 - accuracy50: 0.5071 - val_loss: 3.4478 - val_accuracy50: 0.4079 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 2.9444 - accuracy50: 0.5089 - val_loss: 3.4460 - val_accuracy50: 0.4070 - 30s/epoch - 14ms/step
Epoch 10/50
2058/2058 - 30s - loss: 2.9389 - accuracy50: 0.5105 - val_loss: 3.4188 - val_accuracy50: 0.4067 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 2.9327 - accuracy50: 0.5115 - val_loss: 3.4270 - val_accuracy50: 0.4062 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 31s - loss: 2.9280 - accuracy50: 0.5126 - val_loss: 3.4475 - val_accuracy50: 0.4089 - 31s/epoch - 15ms/step
Epoch 13/50
2058/2058 - 30s - loss: 2.9245 - accuracy50: 0.5134 - val_loss: 3.4435 - val_accuracy50: 0.4018 - 30s/epoch - 15ms/step
Epoch 14/50
2058/2058 - 31s - loss: 2.9192 - accuracy50: 0.5138 - val_loss: 3.4973 - val_accuracy50: 0.3983 - 31s/epoch - 15ms/step
Epoch 15/50
2058/2058 - 30s - loss: 2.9152 - accuracy50: 0.5148 - val_loss: 3.4783 - val_accuracy50: 0.4008 - 30s/epoch - 14ms/step
Epoch 16/50
2058/2058 - 30s - loss: 2.9107 - accuracy50: 0.5167 - val_loss: 3.4383 - val_accuracy50: 0.3995 - 30s/epoch - 15ms/step
Epoch 17/50
2058/2058 - 30s - loss: 2.9064 - accuracy50: 0.5173 - val_loss: 3.4736 - val_accuracy50: 0.3986 - 30s/epoch - 15ms/step
Epoch 18/50
2058/2058 - 30s - loss: 2.9027 - accuracy50: 0.5179 - val_loss: 3.4235 - val_accuracy50: 0.4092 - 30s/epoch - 15ms/step
Epoch 19/50
2058/2058 - 30s - loss: 2.8994 - accuracy50: 0.5186 - val_loss: 3.4157 - val_accuracy50: 0.4098 - 30s/epoch - 15ms/step
Epoch 20/50
2058/2058 - 30s - loss: 2.8951 - accuracy50: 0.5203 - val_loss: 3.4080 - val_accuracy50: 0.4086 - 30s/epoch - 15ms/step
Epoch 21/50
2058/2058 - 30s - loss: 2.8926 - accuracy50: 0.5202 - val_loss: 3.4491 - val_accuracy50: 0.4014 - 30s/epoch - 15ms/step
Epoch 22/50
2058/2058 - 31s - loss: 2.8893 - accuracy50: 0.5205 - val_loss: 3.3968 - val_accuracy50: 0.4084 - 31s/epoch - 15ms/step
Epoch 23/50
2058/2058 - 30s - loss: 2.8864 - accuracy50: 0.5216 - val_loss: 3.4410 - val_accuracy50: 0.4051 - 30s/epoch - 15ms/step
Epoch 24/50
2058/2058 - 30s - loss: 2.8831 - accuracy50: 0.5222 - val_loss: 3.4363 - val_accuracy50: 0.4064 - 30s/epoch - 15ms/step
Epoch 25/50
2058/2058 - 30s - loss: 2.8804 - accuracy50: 0.5227 - val_loss: 3.4332 - val_accuracy50: 0.4088 - 30s/epoch - 15ms/step
Epoch 26/50
2058/2058 - 31s - loss: 2.8774 - accuracy50: 0.5231 - val_loss: 3.4132 - val_accuracy50: 0.4065 - 31s/epoch - 15ms/step
Epoch 27/50
2058/2058 - 30s - loss: 2.8750 - accuracy50: 0.5243 - val_loss: 3.4013 - val_accuracy50: 0.4126 - 30s/epoch - 15ms/step
Epoch 28/50
2058/2058 - 30s - loss: 2.8717 - accuracy50: 0.5242 - val_loss: 3.4205 - val_accuracy50: 0.4053 - 30s/epoch - 15ms/step
Epoch 29/50
2058/2058 - 30s - loss: 2.8693 - accuracy50: 0.5250 - val_loss: 3.4228 - val_accuracy50: 0.4057 - 30s/epoch - 15ms/step
Epoch 30/50
2058/2058 - 30s - loss: 2.8674 - accuracy50: 0.5256 - val_loss: 3.4503 - val_accuracy50: 0.4023 - 30s/epoch - 15ms/step
Epoch 31/50
2058/2058 - 31s - loss: 2.8650 - accuracy50: 0.5259 - val_loss: 3.4180 - val_accuracy50: 0.3990 - 31s/epoch - 15ms/step
Epoch 32/50
2058/2058 - 30s - loss: 2.8629 - accuracy50: 0.5260 - val_loss: 3.4118 - val_accuracy50: 0.4033 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h50
Evaluating performance on  test set...
5497/5497 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0639716
{'0': {'precision': 0.4916298078019197, 'recall': 0.37729291833525436, 'f1-score': 0.42693887349633897, 'support': 457223}, '1': {'precision': 0.42806390350565066, 'recall': 0.6256072143798154, 'f1-score': 0.5083177505826444, 'support': 490354}, '2': {'precision': 0.490614419878117, 'recall': 0.36257245052477677, 'f1-score': 0.4169854896946555, 'support': 459624}, 'accuracy': 0.459012607296328, 'macro avg': {'precision': 0.4701027103952291, 'recall': 0.4551575277466155, 'f1-score': 0.4507473712578796, 'support': 1407201}, 'weighted avg': {'precision': 0.4691479504877317, 'recall': 0.459012607296328, 'f1-score': 0.452045197197298, 'support': 1407201}}
[[172507 205765  78951]
 [ 89513 306769  94072]
 [ 88868 204109 166647]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0772535
{'0': {'precision': 0.53098975142079, 'recall': 0.19975954704823273, 'f1-score': 0.2903055054675968, 'support': 168848}, '1': {'precision': 0.4032005365224105, 'recall': 0.763855820458889, 'f1-score': 0.5278015492438215, 'support': 187322}, '2': {'precision': 0.4965275536084851, 'recall': 0.31546872619452226, 'f1-score': 0.3858119027228849, 'support': 170654}, 'accuracy': 0.43781604482711495, 'macro avg': {'precision': 0.47690594718389523, 'recall': 0.42636136456721463, 'f1-score': 0.4013063191447677, 'support': 526824}, 'weighted avg': {'precision': 0.47438860337389893, 'recall': 0.43781604482711495, 'f1-score': 0.40568897818230587, 'support': 526824}}
[[ 33729 109480  25639]
 [ 15285 143087  28950]
 [ 14507 102311  53836]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1180552
{'0': {'precision': 0.524179104477612, 'recall': 0.16397005144225055, 'f1-score': 0.24979954995732354, 'support': 58901}, '1': {'precision': 0.36500866993512954, 'recall': 0.7248557944415313, 'f1-score': 0.4855257843005251, 'support': 57210}, '2': {'precision': 0.473156188628351, 'recall': 0.34366192342063656, 'f1-score': 0.3981443688962778, 'support': 58188}, 'accuracy': 0.40805741857383004, 'macro avg': {'precision': 0.45411465434703085, 'recall': 0.4108292564348061, 'f1-score': 0.3778232343847088, 'support': 174299}, 'weighted avg': {'precision': 0.45490124294305234, 'recall': 0.40805741857383004, 'f1-score': 0.3766952073689807, 'support': 174299}}
[[ 9658 38094 11149]
 [ 4624 41469 11117]
 [ 4143 34048 19997]]
training model: results/ATVI/W2/deepLOB_L1/h100
Epoch 1/50
2058/2058 - 34s - loss: 3.2285 - accuracy100: 0.4073 - val_loss: 3.3751 - val_accuracy100: 0.3550 - 34s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 31s - loss: 3.2165 - accuracy100: 0.4101 - val_loss: 3.4679 - val_accuracy100: 0.3688 - 31s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 3.1940 - accuracy100: 0.4237 - val_loss: 3.4350 - val_accuracy100: 0.3540 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.1781 - accuracy100: 0.4301 - val_loss: 3.4193 - val_accuracy100: 0.3650 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 3.1715 - accuracy100: 0.4331 - val_loss: 3.4393 - val_accuracy100: 0.3657 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 3.1663 - accuracy100: 0.4353 - val_loss: 3.4852 - val_accuracy100: 0.3663 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 3.1599 - accuracy100: 0.4374 - val_loss: 3.4552 - val_accuracy100: 0.3660 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 3.1551 - accuracy100: 0.4394 - val_loss: 3.4489 - val_accuracy100: 0.3695 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 3.1506 - accuracy100: 0.4411 - val_loss: 3.4621 - val_accuracy100: 0.3726 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 3.1466 - accuracy100: 0.4427 - val_loss: 3.4501 - val_accuracy100: 0.3681 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 3.1430 - accuracy100: 0.4439 - val_loss: 3.4534 - val_accuracy100: 0.3672 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h100
Evaluating performance on  test set...
5497/5497 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1088701
{'0': {'precision': 0.40696741709310025, 'recall': 0.35851293424542074, 'f1-score': 0.3812066046873727, 'support': 469838}, '1': {'precision': 0.31011422526767135, 'recall': 0.44321051899637076, 'f1-score': 0.3649047446684347, 'support': 445822}, '2': {'precision': 0.4188734237282425, 'recall': 0.30349045145776243, 'f1-score': 0.35196689324534436, 'support': 491541}, 'accuracy': 0.3661268006489478, 'macro avg': {'precision': 0.37865168869633803, 'recall': 0.3684046348998513, 'f1-score': 0.3660260808670506, 'support': 1407201}, 'weighted avg': {'precision': 0.38044171587589537, 'recall': 0.3661268006489478, 'f1-score': 0.36582838591174005, 'support': 1407201}}
[[168443 210379  91016]
 [132282 197593 115947]
 [113173 229190 149178]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1097465
{'0': {'precision': 0.4338094689551895, 'recall': 0.2134936562468111, 'f1-score': 0.28615826507195935, 'support': 176394}, '1': {'precision': 0.32649552036158674, 'recall': 0.418204597201405, 'f1-score': 0.3667031181026526, 'support': 174802}, '2': {'precision': 0.3833521507366551, 'recall': 0.4717186325642836, 'f1-score': 0.4229693163833155, 'support': 175628}, 'accuracy': 0.3675022398372132, 'macro avg': {'precision': 0.3812190466844771, 'recall': 0.36780562867083316, 'f1-score': 0.3586102331859758, 'support': 526824}, 'weighted avg': {'precision': 0.381381313202711, 'recall': 0.3675022398372132, 'f1-score': 0.3584921995912336, 'support': 526824}}
[[37659 78701 60034]
 [28468 73103 73231]
 [20683 72098 82847]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.125491
{'0': {'precision': 0.426945460163774, 'recall': 0.1388609715242881, 'f1-score': 0.2095630521885309, 'support': 59700}, '1': {'precision': 0.30933341073683296, 'recall': 0.38397377001927613, 'f1-score': 0.3426357586084943, 'support': 55509}, '2': {'precision': 0.37638260505472265, 'recall': 0.5476561177864275, 'f1-score': 0.4461463165803859, 'support': 59090}, 'accuracy': 0.35550978490983887, 'macro avg': {'precision': 0.3708871586517765, 'recall': 0.3568302864433306, 'f1-score': 0.3327817091258037, 'support': 174299}, 'weighted avg': {'precision': 0.3723479790535329, 'recall': 0.35550978490983887, 'f1-score': 0.33214802372353947, 'support': 174299}}
[[ 8290 25599 25811]
 [ 6388 21314 27807]
 [ 4739 21990 32361]]
training model: results/ATVI/W2/deepLOB_L1/h200
Epoch 1/50
2058/2058 - 33s - loss: 3.2720 - accuracy200: 0.3857 - val_loss: 3.3707 - val_accuracy200: 0.3319 - 33s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.2498 - accuracy200: 0.3970 - val_loss: 3.4142 - val_accuracy200: 0.3334 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 3.2383 - accuracy200: 0.4039 - val_loss: 3.4176 - val_accuracy200: 0.3324 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.2304 - accuracy200: 0.4081 - val_loss: 3.3876 - val_accuracy200: 0.3424 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 3.2244 - accuracy200: 0.4111 - val_loss: 3.4466 - val_accuracy200: 0.3383 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 3.2206 - accuracy200: 0.4137 - val_loss: 3.4410 - val_accuracy200: 0.3366 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 3.2166 - accuracy200: 0.4154 - val_loss: 3.4084 - val_accuracy200: 0.3333 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 3.2130 - accuracy200: 0.4166 - val_loss: 3.4092 - val_accuracy200: 0.3357 - 30s/epoch - 14ms/step
Epoch 9/50
2058/2058 - 30s - loss: 3.2108 - accuracy200: 0.4178 - val_loss: 3.4426 - val_accuracy200: 0.3379 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 3.2080 - accuracy200: 0.4196 - val_loss: 3.3917 - val_accuracy200: 0.3395 - 30s/epoch - 14ms/step
Epoch 11/50
2058/2058 - 30s - loss: 3.2049 - accuracy200: 0.4209 - val_loss: 3.3991 - val_accuracy200: 0.3359 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h200
Evaluating performance on  test set...
5497/5497 - 30s - 30s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1021757
{'0': {'precision': 0.392314977047116, 'recall': 0.3201276004379685, 'f1-score': 0.35256413972703443, 'support': 474920}, '1': {'precision': 0.3325485942277192, 'recall': 0.45184544607094457, 'f1-score': 0.3831252155915833, 'support': 430167}, '2': {'precision': 0.40771625860266325, 'recall': 0.35336995184360526, 'f1-score': 0.37860277243440993, 'support': 502114}, 'accuracy': 0.37225385712488834, 'macro avg': {'precision': 0.37752660995916615, 'recall': 0.3751143327841728, 'f1-score': 0.3714307092510092, 'support': 1407201}, 'weighted avg': {'precision': 0.37954045051445334, 'recall': 0.37225385712488834, 'f1-score': 0.3711973899483294, 'support': 1407201}}
[[152035 186236 136649]
 [114694 194369 121104]
 [120804 203878 177432]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1154363
{'0': {'precision': 0.38999092708677, 'recall': 0.10746755460599586, 'f1-score': 0.16850198677856776, 'support': 175988}, '1': {'precision': 0.34860058700531377, 'recall': 0.5158863540874147, 'f1-score': 0.41605784266812584, 'support': 176126}, '2': {'precision': 0.3595319799892504, 'recall': 0.44796519947341307, 'f1-score': 0.39890619863249344, 'support': 174710}, 'accuracy': 0.35692755075698906, 'macro avg': {'precision': 0.36604116469377806, 'recall': 0.3571063693889412, 'f1-score': 0.327822009359729, 'support': 526824}, 'weighted avg': {'precision': 0.3660523865407922, 'recall': 0.35692755075698906, 'f1-score': 0.3276726823569842, 'support': 526824}}
[[18913 87085 69990]
 [15836 90861 69429]
 [13747 82699 78264]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1235652
{'0': {'precision': 0.4005194218608853, 'recall': 0.06018188604974719, 'f1-score': 0.10464052866035342, 'support': 58938}, '1': {'precision': 0.31696010560731885, 'recall': 0.36122384717654465, 'f1-score': 0.3376474724268463, 'support': 57164}, '2': {'precision': 0.3385279572465502, 'recall': 0.58341495266079, 'f1-score': 0.4284479440732399, 'support': 58197}, 'accuracy': 0.33361637186673476, 'macro avg': {'precision': 0.35200249490491814, 'recall': 0.3349402286290273, 'f1-score': 0.29024531505347984, 'support': 174299}, 'weighted avg': {'precision': 0.35241643779052734, 'recall': 0.33361637186673476, 'f1-score': 0.28917531708858046, 'support': 174299}}
[[ 3547 22657 32734]
 [ 2906 20649 33609]
 [ 2403 21841 33953]]
training model: results/ATVI/W2/deepLOB_L1/h300
Epoch 1/50
2058/2058 - 33s - loss: 3.2860 - accuracy300: 0.3767 - val_loss: 3.3947 - val_accuracy300: 0.3375 - 33s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.2666 - accuracy300: 0.3850 - val_loss: 3.4961 - val_accuracy300: 0.3307 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 3.2566 - accuracy300: 0.3931 - val_loss: 3.4873 - val_accuracy300: 0.3323 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.2474 - accuracy300: 0.3990 - val_loss: 3.4217 - val_accuracy300: 0.3350 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 30s - loss: 3.2405 - accuracy300: 0.4019 - val_loss: 3.4304 - val_accuracy300: 0.3291 - 30s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 3.2363 - accuracy300: 0.4046 - val_loss: 3.3883 - val_accuracy300: 0.3338 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 3.2320 - accuracy300: 0.4075 - val_loss: 3.3688 - val_accuracy300: 0.3337 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 3.2290 - accuracy300: 0.4081 - val_loss: 3.3655 - val_accuracy300: 0.3300 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 3.2252 - accuracy300: 0.4109 - val_loss: 3.3527 - val_accuracy300: 0.3349 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 3.2214 - accuracy300: 0.4129 - val_loss: 3.3618 - val_accuracy300: 0.3366 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 3.2187 - accuracy300: 0.4147 - val_loss: 3.3456 - val_accuracy300: 0.3423 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 30s - loss: 3.2165 - accuracy300: 0.4163 - val_loss: 3.3528 - val_accuracy300: 0.3390 - 30s/epoch - 15ms/step
Epoch 13/50
2058/2058 - 31s - loss: 3.2145 - accuracy300: 0.4165 - val_loss: 3.3832 - val_accuracy300: 0.3372 - 31s/epoch - 15ms/step
Epoch 14/50
2058/2058 - 30s - loss: 3.2112 - accuracy300: 0.4187 - val_loss: 3.3759 - val_accuracy300: 0.3386 - 30s/epoch - 15ms/step
Epoch 15/50
2058/2058 - 31s - loss: 3.2089 - accuracy300: 0.4199 - val_loss: 3.3922 - val_accuracy300: 0.3365 - 31s/epoch - 15ms/step
Epoch 16/50
2058/2058 - 31s - loss: 3.2062 - accuracy300: 0.4210 - val_loss: 3.4093 - val_accuracy300: 0.3387 - 31s/epoch - 15ms/step
Epoch 17/50
2058/2058 - 31s - loss: 3.2044 - accuracy300: 0.4212 - val_loss: 3.3929 - val_accuracy300: 0.3381 - 31s/epoch - 15ms/step
Epoch 18/50
2058/2058 - 30s - loss: 3.2021 - accuracy300: 0.4228 - val_loss: 3.3772 - val_accuracy300: 0.3416 - 30s/epoch - 15ms/step
Epoch 19/50
2058/2058 - 31s - loss: 3.2000 - accuracy300: 0.4239 - val_loss: 3.4513 - val_accuracy300: 0.3398 - 31s/epoch - 15ms/step
Epoch 20/50
2058/2058 - 31s - loss: 3.1978 - accuracy300: 0.4250 - val_loss: 3.4619 - val_accuracy300: 0.3407 - 31s/epoch - 15ms/step
Epoch 21/50
2058/2058 - 31s - loss: 3.1977 - accuracy300: 0.4248 - val_loss: 3.3836 - val_accuracy300: 0.3405 - 31s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h300
Evaluating performance on  test set...
5497/5497 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.14188
{'0': {'precision': 0.35483678125799156, 'recall': 0.6613275946734453, 'f1-score': 0.4618610150270576, 'support': 484666}, '1': {'precision': 0.2992527065436081, 'recall': 0.22835773974455517, 'f1-score': 0.2590421480829278, 'support': 410343}, '2': {'precision': 0.3985606005011165, 'recall': 0.14845019055354242, 'f1-score': 0.2163262519097652, 'support': 512192}, 'accuracy': 0.34839585816098767, 'macro avg': {'precision': 0.35088336276757204, 'recall': 0.3460451749905143, 'f1-score': 0.3124098050065835, 'support': 1407201}, 'weighted avg': {'precision': 0.35454290316612724, 'recall': 0.34839585816098767, 'f1-score': 0.3133490087756214, 'support': 1407201}}
[[320523  99018  65125]
 [267024  93705  49614]
 [315750 120407  76035]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1263252
{'0': {'precision': 0.34236161019664213, 'recall': 0.22065651717748958, 'f1-score': 0.268354842760039, 'support': 179188}, '1': {'precision': 0.32415552788912755, 'recall': 0.279480283567477, 'f1-score': 0.30016469246848676, 'support': 169554}, '2': {'precision': 0.34718592187788755, 'recall': 0.5169304028481262, 'f1-score': 0.41538610792115177, 'support': 178082}, 'accuracy': 0.33973774922934413, 'macro avg': {'precision': 0.33790101998788574, 'recall': 0.3390224011976976, 'f1-score': 0.3279685477165592, 'support': 526824}, 'weighted avg': {'precision': 0.33813289053552426, 'recall': 0.33973774922934413, 'f1-score': 0.32829347315631446, 'support': 526824}}
[[39539 50227 89422]
 [38496 47387 83671]
 [37454 48572 92056]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1152648
{'0': {'precision': 0.3613801132454887, 'recall': 0.1147094888549208, 'f1-score': 0.17414254749458113, 'support': 59533}, '1': {'precision': 0.329851140376935, 'recall': 0.3573190789473684, 'f1-score': 0.34303612803569894, 'support': 55936}, '2': {'precision': 0.3483988692937305, 'recall': 0.5614652388237293, 'f1-score': 0.4299847693929887, 'support': 58830}, 'accuracy': 0.3433582521988078, 'macro avg': {'precision': 0.34654337430538473, 'recall': 0.34449793554200614, 'f1-score': 0.31572114830775627, 'support': 174299}, 'weighted avg': {'precision': 0.3468803673602148, 'recall': 0.3433582521988078, 'f1-score': 0.3146965910371791, 'support': 174299}}
[[ 6829 21263 31441]
 [ 5613 19987 30336]
 [ 6455 19344 33031]]
training model: results/ATVI/W2/deepLOB_L1/h500
Epoch 1/50
2058/2058 - 33s - loss: 3.2148 - accuracy500: 0.4211 - val_loss: 3.5472 - val_accuracy500: 0.3492 - 33s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.2031 - accuracy500: 0.4301 - val_loss: 3.4631 - val_accuracy500: 0.3549 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 30s - loss: 3.1872 - accuracy500: 0.4388 - val_loss: 3.5281 - val_accuracy500: 0.3489 - 30s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.1774 - accuracy500: 0.4416 - val_loss: 3.5584 - val_accuracy500: 0.3490 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 3.1730 - accuracy500: 0.4432 - val_loss: 3.5922 - val_accuracy500: 0.3488 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 3.1571 - accuracy500: 0.4494 - val_loss: 3.6824 - val_accuracy500: 0.3488 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 31s - loss: 3.1489 - accuracy500: 0.4526 - val_loss: 3.6591 - val_accuracy500: 0.3491 - 31s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 3.1436 - accuracy500: 0.4545 - val_loss: 3.6944 - val_accuracy500: 0.3490 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 30s - loss: 3.1412 - accuracy500: 0.4557 - val_loss: 3.6742 - val_accuracy500: 0.3493 - 30s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 3.1376 - accuracy500: 0.4576 - val_loss: 3.6765 - val_accuracy500: 0.3490 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 3.1328 - accuracy500: 0.4593 - val_loss: 3.7162 - val_accuracy500: 0.3489 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 30s - loss: 3.1271 - accuracy500: 0.4618 - val_loss: 3.8086 - val_accuracy500: 0.3488 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h500
Evaluating performance on  test set...
5497/5497 - 34s - 34s/epoch - 6ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1961843
{'0': {'precision': 0.3202614379084967, 'recall': 0.0001056237079957147, 'f1-score': 0.00021117776858364364, 'support': 463911}, '1': {'precision': 0.31226515626845136, 'recall': 0.9992965553979698, 'f1-score': 0.4758380673272307, 'support': 439267}, '2': {'precision': 0.4215686274509804, 'recall': 0.0011090763715147919, 'f1-score': 0.0022123324672651966, 'support': 504023}, 'accuracy': 0.31236902190945004, 'macro avg': {'precision': 0.35136507387597615, 'recall': 0.33350375182582676, 'f1-score': 0.15942052585435987, 'support': 1407201}, 'weighted avg': {'precision': 0.3540509611873982, 'recall': 0.31236902190945004, 'f1-score': 0.1493979854033507, 'support': 1407201}}
[[    49 463370    492]
 [    34 438958    275]
 [    70 503394    559]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1591954
{'0': {'precision': 0.1111111111111111, 'recall': 5.6751112321801505e-06, 'f1-score': 1.1349642769993814e-05, 'support': 176208}, '1': {'precision': 0.34577790665361796, 'recall': 0.9570504960428046, 'f1-score': 0.5080130528296416, 'support': 179420}, '2': {'precision': 0.37056896038129283, 'recall': 0.06539872426925862, 'f1-score': 0.11117675972771822, 'support': 171196}, 'accuracy': 0.34719564788240476, 'macro avg': {'precision': 0.27581932604867393, 'recall': 0.34081829847443174, 'f1-score': 0.20640038740004327, 'support': 526824}, 'weighted avg': {'precision': 0.2753444460007415, 'recall': 0.34719564788240476, 'f1-score': 0.20914521433134017, 'support': 526824}}
[[     1 164892  11315]
 [     4 171714   7702]
 [     4 159996  11196]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1526189
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 57272}, '1': {'precision': 0.3535249403079694, 'recall': 0.9814948843635886, 'f1-score': 0.5198168806108626, 'support': 60794}, '2': {'precision': 0.37744742567077594, 'recall': 0.03702452296694112, 'f1-score': 0.06743429043385318, 'support': 56233}, 'accuracy': 0.35428200965008405, 'macro avg': {'precision': 0.2436574553262484, 'recall': 0.33950646911017657, 'f1-score': 0.1957503903482386, 'support': 174299}, 'weighted avg': {'precision': 0.24507998501900433, 'recall': 0.35428200965008405, 'f1-score': 0.20306358552730452, 'support': 174299}}
[[    0 54963  2309]
 [    0 59669  1125]
 [    0 54151  2082]]
training model: results/ATVI/W2/deepLOB_L1/h1000
Epoch 1/50
2058/2058 - 34s - loss: 3.2595 - accuracy1000: 0.4005 - val_loss: 3.6302 - val_accuracy1000: 0.3123 - 34s/epoch - 16ms/step
Epoch 2/50
2058/2058 - 30s - loss: 3.2097 - accuracy1000: 0.4219 - val_loss: 3.6515 - val_accuracy1000: 0.3180 - 30s/epoch - 15ms/step
Epoch 3/50
2058/2058 - 31s - loss: 3.1876 - accuracy1000: 0.4329 - val_loss: 3.5465 - val_accuracy1000: 0.3304 - 31s/epoch - 15ms/step
Epoch 4/50
2058/2058 - 30s - loss: 3.1699 - accuracy1000: 0.4407 - val_loss: 3.5591 - val_accuracy1000: 0.3284 - 30s/epoch - 15ms/step
Epoch 5/50
2058/2058 - 31s - loss: 3.1530 - accuracy1000: 0.4452 - val_loss: 3.6462 - val_accuracy1000: 0.3349 - 31s/epoch - 15ms/step
Epoch 6/50
2058/2058 - 30s - loss: 3.1406 - accuracy1000: 0.4506 - val_loss: 3.5636 - val_accuracy1000: 0.3336 - 30s/epoch - 15ms/step
Epoch 7/50
2058/2058 - 30s - loss: 3.1287 - accuracy1000: 0.4549 - val_loss: 3.5946 - val_accuracy1000: 0.3268 - 30s/epoch - 15ms/step
Epoch 8/50
2058/2058 - 30s - loss: 3.1173 - accuracy1000: 0.4593 - val_loss: 3.5110 - val_accuracy1000: 0.3275 - 30s/epoch - 15ms/step
Epoch 9/50
2058/2058 - 31s - loss: 3.1097 - accuracy1000: 0.4614 - val_loss: 3.5641 - val_accuracy1000: 0.3321 - 31s/epoch - 15ms/step
Epoch 10/50
2058/2058 - 30s - loss: 3.1004 - accuracy1000: 0.4650 - val_loss: 3.5767 - val_accuracy1000: 0.3332 - 30s/epoch - 15ms/step
Epoch 11/50
2058/2058 - 30s - loss: 3.0950 - accuracy1000: 0.4672 - val_loss: 3.6541 - val_accuracy1000: 0.3335 - 30s/epoch - 15ms/step
Epoch 12/50
2058/2058 - 30s - loss: 3.0891 - accuracy1000: 0.4695 - val_loss: 3.6800 - val_accuracy1000: 0.3346 - 30s/epoch - 15ms/step
Epoch 13/50
2058/2058 - 30s - loss: 3.0821 - accuracy1000: 0.4714 - val_loss: 3.6129 - val_accuracy1000: 0.3340 - 30s/epoch - 15ms/step
Epoch 14/50
2058/2058 - 30s - loss: 3.0753 - accuracy1000: 0.4737 - val_loss: 3.6281 - val_accuracy1000: 0.3343 - 30s/epoch - 15ms/step
Epoch 15/50
2058/2058 - 30s - loss: 3.0705 - accuracy1000: 0.4761 - val_loss: 3.7322 - val_accuracy1000: 0.3328 - 30s/epoch - 15ms/step
Epoch 16/50
2058/2058 - 31s - loss: 3.0648 - accuracy1000: 0.4777 - val_loss: 3.7528 - val_accuracy1000: 0.3322 - 31s/epoch - 15ms/step
Epoch 17/50
2058/2058 - 30s - loss: 3.0605 - accuracy1000: 0.4786 - val_loss: 3.7795 - val_accuracy1000: 0.3296 - 30s/epoch - 15ms/step
Epoch 18/50
2058/2058 - 30s - loss: 3.0566 - accuracy1000: 0.4805 - val_loss: 3.7753 - val_accuracy1000: 0.3300 - 30s/epoch - 15ms/step
testing model: results/ATVI/W2/deepLOB_L1/h1000
Evaluating performance on  test set...
5497/5497 - 35s - 35s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.2328035
{'0': {'precision': 0.3214062601549454, 'recall': 0.5335702584156846, 'f1-score': 0.4011638157595222, 'support': 454152}, '1': {'precision': 0.29145585631166204, 'recall': 0.3090975349105494, 'f1-score': 0.3000175772476635, 'support': 447286}, '2': {'precision': 0.38319042135742154, 'recall': 0.13554174583747725, 'f1-score': 0.20025092710114933, 'support': 505763}, 'accuracy': 0.3191647817191716, 'macro avg': {'precision': 0.33201751260800966, 'recall': 0.32606984638790376, 'f1-score': 0.3004774400361117, 'support': 1407201}, 'weighted avg': {'precision': 0.33409225624846806, 'recall': 0.3191647817191716, 'f1-score': 0.2968037408693396, 'support': 1407201}}
[[242322 155525  56305]
 [254990 138255  54041]
 [256631 180580  68552]]
Evaluating performance on  train set...
2058/2058 - 10s - 10s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1953316
{'0': {'precision': 0.3171058286772242, 'recall': 0.10562628020174879, 'f1-score': 0.15846777857632607, 'support': 181612}, '1': {'precision': 0.33667424829413384, 'recall': 0.23280465954983035, 'f1-score': 0.27526685421960045, 'support': 173579}, '2': {'precision': 0.3333208202065821, 'recall': 0.672539663118398, 'f1-score': 0.4457307466559575, 'support': 171633}, 'accuracy': 0.332222905562389, 'macro avg': {'precision': 0.32903363239264666, 'recall': 0.336990200956659, 'f1-score': 0.29315512648396136, 'support': 526824}, 'weighted avg': {'precision': 0.3288359213644249, 'recall': 0.332222905562389, 'f1-score': 0.2905378280643815, 'support': 526824}}
[[ 19183  41467 120962]
 [ 23258  40410 109911]
 [ 18053  38150 115430]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1782985
{'0': {'precision': 0.36556219445953286, 'recall': 0.011330157073351403, 'f1-score': 0.021979098628347484, 'support': 59399}, '1': {'precision': 0.3045404546565632, 'recall': 0.17653518482438585, 'f1-score': 0.2235079103456782, 'support': 56459}, '2': {'precision': 0.33310670578973733, 'recall': 0.7964442771342037, 'f1-score': 0.4697458255748823, 'support': 58441}, 'accuracy': 0.32808564593026923, 'macro avg': {'precision': 0.33440311830194447, 'recall': 0.3281032063439803, 'f1-score': 0.23841094484963601, 'support': 174299}, 'weighted avg': {'precision': 0.3349139542465231, 'recall': 0.32808564593026923, 'f1-score': 0.23739083633327535, 'support': 174299}}
[[  673 11492 47234]
 [  541  9967 45951]
 [  627 11269 46545]]
training model: results/ATVI/W2/deepOF_L1/h10
Epoch 1/50
2058/2058 - 30s - loss: 3.1530 - accuracy10: 0.4130 - val_loss: 3.4971 - val_accuracy10: 0.5439 - 30s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 27s - loss: 3.1177 - accuracy10: 0.4052 - val_loss: 3.4843 - val_accuracy10: 0.5410 - 27s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.0961 - accuracy10: 0.4105 - val_loss: 3.5004 - val_accuracy10: 0.5504 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 28s - loss: 3.0754 - accuracy10: 0.4235 - val_loss: 3.5178 - val_accuracy10: 0.5528 - 28s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.0617 - accuracy10: 0.4308 - val_loss: 3.5357 - val_accuracy10: 0.5548 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.0485 - accuracy10: 0.4381 - val_loss: 3.5369 - val_accuracy10: 0.5555 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.0381 - accuracy10: 0.4447 - val_loss: 3.5527 - val_accuracy10: 0.5528 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 26s - loss: 3.0294 - accuracy10: 0.4487 - val_loss: 3.5530 - val_accuracy10: 0.5524 - 26s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.0189 - accuracy10: 0.4547 - val_loss: 3.5463 - val_accuracy10: 0.5455 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.0119 - accuracy10: 0.4583 - val_loss: 3.5404 - val_accuracy10: 0.5445 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 28s - loss: 3.0033 - accuracy10: 0.4628 - val_loss: 3.5538 - val_accuracy10: 0.5460 - 28s/epoch - 14ms/step
Epoch 12/50
2058/2058 - 27s - loss: 2.9952 - accuracy10: 0.4672 - val_loss: 3.5605 - val_accuracy10: 0.5505 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h10
Evaluating performance on  test set...
5497/5497 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9813778
{'0': {'precision': 0.34669494453187977, 'recall': 0.26473939727031237, 'f1-score': 0.3002245846430642, 'support': 272925}, '1': {'precision': 0.6471649670779969, 'recall': 0.7011215826957129, 'f1-score': 0.6730636392673323, 'support': 868594}, '2': {'precision': 0.31029265719073923, 'recall': 0.30106482683860475, 'f1-score': 0.30560909957532, 'support': 265677}, 'accuracy': 0.5409552045344075, 'macro avg': {'precision': 0.43471752293353866, 'recall': 0.42230860226821004, 'f1-score': 0.4262991078285721, 'support': 1407196}, 'weighted avg': {'precision': 0.525287840098304, 'recall': 0.5409552045344075, 'f1-score': 0.5313766825640136, 'support': 1407196}}
[[ 72254 169916  30755]
 [112569 608990 147035]
 [ 23585 162106  79986]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9635431
{'0': {'precision': 0.32540183696900116, 'recall': 0.23692542397676095, 'f1-score': 0.27420320351189076, 'support': 95701}, '1': {'precision': 0.6530446886223591, 'recall': 0.7696210640380522, 'f1-score': 0.7065566134309101, 'support': 334067}, '2': {'precision': 0.30728854701932473, 'recall': 0.20086341905703922, 'f1-score': 0.24293137609191393, 'support': 97056}, 'accuracy': 0.568072069609585, 'macro avg': {'precision': 0.42857835753689494, 'recall': 0.4024699690239508, 'f1-score': 0.4078970643449049, 'support': 526824}, 'weighted avg': {'precision': 0.5298280989728706, 'recall': 0.568072069609585, 'f1-score': 0.5426038232811947, 'support': 526824}}
[[ 22674  66040   6987]
 [ 40002 257105  36960]
 [  7004  70557  19495]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9893481
{'0': {'precision': 0.3402606709365342, 'recall': 0.21408442766161304, 'f1-score': 0.26281286215903, 'support': 35486}, '1': {'precision': 0.6109026856384683, 'recall': 0.7734003938680156, 'f1-score': 0.6826140672261748, 'support': 103588}, '2': {'precision': 0.31603456553048487, 'recall': 0.18688431511710432, 'f1-score': 0.23487646061903486, 'support': 35225}, 'accuracy': 0.5409956454139152, 'macro avg': {'precision': 0.4223993073684958, 'recall': 0.3914563788822443, 'f1-score': 0.3934344633347466, 'support': 174299}, 'weighted avg': {'precision': 0.49621050688519636, 'recall': 0.5409956454139152, 'f1-score': 0.5066599725053261, 'support': 174299}}
[[ 7597 25011  2878]
 [12104 80115 11369]
 [ 2626 26016  6583]]
training model: results/ATVI/W2/deepOF_L1/h20
Epoch 1/50
2058/2058 - 30s - loss: 3.1900 - accuracy20: 0.4180 - val_loss: 3.4470 - val_accuracy20: 0.4737 - 30s/epoch - 14ms/step
Epoch 2/50
2058/2058 - 27s - loss: 3.1597 - accuracy20: 0.4124 - val_loss: 3.4463 - val_accuracy20: 0.4755 - 27s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.1386 - accuracy20: 0.4233 - val_loss: 3.4543 - val_accuracy20: 0.4773 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.1227 - accuracy20: 0.4314 - val_loss: 3.4613 - val_accuracy20: 0.4803 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.1094 - accuracy20: 0.4387 - val_loss: 3.4621 - val_accuracy20: 0.4819 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.0986 - accuracy20: 0.4443 - val_loss: 3.4620 - val_accuracy20: 0.4838 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.0895 - accuracy20: 0.4492 - val_loss: 3.4623 - val_accuracy20: 0.4841 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.0795 - accuracy20: 0.4539 - val_loss: 3.4618 - val_accuracy20: 0.4852 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.0711 - accuracy20: 0.4578 - val_loss: 3.4639 - val_accuracy20: 0.4833 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.0632 - accuracy20: 0.4619 - val_loss: 3.4626 - val_accuracy20: 0.4824 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.0541 - accuracy20: 0.4659 - val_loss: 3.4759 - val_accuracy20: 0.4831 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.0477 - accuracy20: 0.4686 - val_loss: 3.4739 - val_accuracy20: 0.4840 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h20
Evaluating performance on  test set...
5497/5497 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0195167
{'0': {'precision': 0.4054424258266893, 'recall': 0.22462924342486387, 'f1-score': 0.28909163769885277, 'support': 345240}, '1': {'precision': 0.5333337211545827, 'recall': 0.7636474695801259, 'f1-score': 0.628041408018779, 'support': 720335}, '2': {'precision': 0.4011857921720374, 'recall': 0.21669042593985732, 'f1-score': 0.28139332001619344, 'support': 341621}, 'accuracy': 0.49862208249597073, 'macro avg': {'precision': 0.4466539797177698, 'recall': 0.4016557129816157, 'f1-score': 0.39950878857794175, 'support': 1407196}, 'weighted avg': {'precision': 0.4698758244252372, 'recall': 0.49862208249597073, 'f1-score': 0.46072904699957296, 'support': 1407196}}
[[ 77551 241608  26081]
 [ 85842 550082  84411]
 [ 27882 239713  74026]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0119509
{'0': {'precision': 0.3855138187729956, 'recall': 0.2174346682538789, 'f1-score': 0.27804720003702765, 'support': 124327}, '1': {'precision': 0.5393651800526984, 'recall': 0.7985717278697289, 'f1-score': 0.643859633794367, 'support': 276838}, '2': {'precision': 0.3855238990218273, 'recall': 0.14365067364852496, 'f1-score': 0.20931001095772866, 'support': 125659}, 'accuracy': 0.5052142651056141, 'macro avg': {'precision': 0.4368009659491738, 'recall': 0.3865523565907109, 'f1-score': 0.37707228159637446, 'support': 526824}, 'weighted avg': {'precision': 0.4663627736952055, 'recall': 0.5052142651056141, 'f1-score': 0.45388075373617326, 'support': 526824}}
[[ 27033  90930   6364]
 [ 33356 221075  22407]
 [  9733  97875  18051]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0379512
{'0': {'precision': 0.39929244155471627, 'recall': 0.18562062451383488, 'f1-score': 0.2534288141764778, 'support': 44995}, '1': {'precision': 0.4970188200650174, 'recall': 0.805785661108682, 'f1-score': 0.6148131117092017, 'support': 84623}, '2': {'precision': 0.4014084507042254, 'recall': 0.1454309438016159, 'f1-score': 0.21350769685718507, 'support': 44681}, 'accuracy': 0.4764112243902719, 'macro avg': {'precision': 0.43257323744131976, 'recall': 0.3789457431413776, 'f1-score': 0.3605832075809549, 'support': 174299}, 'weighted avg': {'precision': 0.44728149905640263, 'recall': 0.4764112243902719, 'f1-score': 0.4186489701565372, 'support': 174299}}
[[ 8352 34104  2539]
 [ 9284 68188  7151]
 [ 3281 34902  6498]]
training model: results/ATVI/W2/deepOF_L1/h30
Epoch 1/50
2058/2058 - 30s - loss: 3.2132 - accuracy30: 0.4187 - val_loss: 3.4105 - val_accuracy30: 0.4193 - 30s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 28s - loss: 3.1886 - accuracy30: 0.4155 - val_loss: 3.3940 - val_accuracy30: 0.4236 - 28s/epoch - 14ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.1726 - accuracy30: 0.4191 - val_loss: 3.4097 - val_accuracy30: 0.4271 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.1580 - accuracy30: 0.4279 - val_loss: 3.4262 - val_accuracy30: 0.4298 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.1463 - accuracy30: 0.4346 - val_loss: 3.4351 - val_accuracy30: 0.4312 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.1358 - accuracy30: 0.4414 - val_loss: 3.4401 - val_accuracy30: 0.4330 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.1276 - accuracy30: 0.4454 - val_loss: 3.4425 - val_accuracy30: 0.4344 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.1199 - accuracy30: 0.4483 - val_loss: 3.4496 - val_accuracy30: 0.4347 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.1126 - accuracy30: 0.4523 - val_loss: 3.4512 - val_accuracy30: 0.4351 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.1069 - accuracy30: 0.4544 - val_loss: 3.4536 - val_accuracy30: 0.4370 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.0996 - accuracy30: 0.4579 - val_loss: 3.4608 - val_accuracy30: 0.4359 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.0936 - accuracy30: 0.4606 - val_loss: 3.4571 - val_accuracy30: 0.4377 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h30
Evaluating performance on  test set...
5497/5497 - 30s - 30s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0527828
{'0': {'precision': 0.44060657118786856, 'recall': 0.17950758403970243, 'f1-score': 0.25508922974650045, 'support': 393326}, '1': {'precision': 0.45608010060946114, 'recall': 0.7442372559189946, 'f1-score': 0.5655700981256243, 'support': 620798}, '2': {'precision': 0.4102639734957786, 'recall': 0.24415628688891602, 'f1-score': 0.30612905643886656, 'support': 393072}, 'accuracy': 0.44670180984027813, 'macro avg': {'precision': 0.4356502150977028, 'recall': 0.38930037561587105, 'f1-score': 0.3755961281036638, 'support': 1407196}, 'weighted avg': {'precision': 0.4389572704208401, 'recall': 0.44670180984027813, 'f1-score': 0.4063177927083374, 'support': 1407196}}
[[ 70605 281330  41391]
 [ 62214 462021  96563]
 [ 27426 269675  95971]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0486008
{'0': {'precision': 0.42603407111053754, 'recall': 0.18377231133224314, 'f1-score': 0.2567807363400797, 'support': 143705}, '1': {'precision': 0.4640130944141614, 'recall': 0.7715051279682158, 'f1-score': 0.5794952681388013, 'support': 238106}, '2': {'precision': 0.40135186098459574, 'recall': 0.19081047906049803, 'f1-score': 0.25865252038980163, 'support': 145013}, 'accuracy': 0.45134428196133813, 'macro avg': {'precision': 0.4304663421697648, 'recall': 0.382029306120319, 'f1-score': 0.36497617495622753, 'support': 526824}, 'weighted avg': {'precision': 0.4364052614620391, 'recall': 0.45134428196133813, 'f1-score': 0.4031516293306586, 'support': 526824}}
[[ 26409 105207  12089]
 [ 25223 183700  29183]
 [ 10356 106987  27670]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0706518
{'0': {'precision': 0.43009440967433965, 'recall': 0.15848414963061408, 'f1-score': 0.23161953727506426, 'support': 51166}, '1': {'precision': 0.424876669975675, 'recall': 0.7753730414459764, 'f1-score': 0.5489489607096352, 'support': 72311}, '2': {'precision': 0.4129971893365131, 'recall': 0.19082287198457362, 'f1-score': 0.261035745047373, 'support': 50822}, 'accuracy': 0.42384064165600494, 'macro avg': {'precision': 0.422656089662176, 'recall': 0.3748933543537214, 'f1-score': 0.34720141434402413, 'support': 174299}, 'weighted avg': {'precision': 0.4229445413024089, 'recall': 0.42384064165600494, 'f1-score': 0.37184637993842734, 'support': 174299}}
[[ 8109 38386  4671]
 [ 7130 56068  9113]
 [ 3615 37509  9698]]
training model: results/ATVI/W2/deepOF_L1/h50
Epoch 1/50
2058/2058 - 30s - loss: 3.2453 - accuracy50: 0.4077 - val_loss: 3.3421 - val_accuracy50: 0.3489 - 30s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 28s - loss: 3.2250 - accuracy50: 0.4107 - val_loss: 3.3406 - val_accuracy50: 0.3532 - 28s/epoch - 14ms/step
Epoch 3/50
2058/2058 - 28s - loss: 3.2120 - accuracy50: 0.4179 - val_loss: 3.3475 - val_accuracy50: 0.3528 - 28s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.1989 - accuracy50: 0.4240 - val_loss: 3.3583 - val_accuracy50: 0.3516 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.1894 - accuracy50: 0.4284 - val_loss: 3.3674 - val_accuracy50: 0.3513 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.1820 - accuracy50: 0.4320 - val_loss: 3.3719 - val_accuracy50: 0.3528 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 28s - loss: 3.1745 - accuracy50: 0.4362 - val_loss: 3.3784 - val_accuracy50: 0.3537 - 28s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.1687 - accuracy50: 0.4386 - val_loss: 3.3819 - val_accuracy50: 0.3547 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.1625 - accuracy50: 0.4410 - val_loss: 3.3821 - val_accuracy50: 0.3571 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 26s - loss: 3.1584 - accuracy50: 0.4427 - val_loss: 3.3851 - val_accuracy50: 0.3581 - 26s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.1533 - accuracy50: 0.4446 - val_loss: 3.3841 - val_accuracy50: 0.3608 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.1494 - accuracy50: 0.4458 - val_loss: 3.3893 - val_accuracy50: 0.3611 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h50
Evaluating performance on  test set...
5497/5497 - 31s - 31s/epoch - 6ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.088664
{'0': {'precision': 0.47044478415956903, 'recall': 0.14134302667637752, 'f1-score': 0.21737631413862638, 'support': 457221}, '1': {'precision': 0.3564183726830422, 'recall': 0.7867132724521468, 'f1-score': 0.49058053029821325, 'support': 490354}, '2': {'precision': 0.4534510347770429, 'recall': 0.1849632632103407, 'f1-score': 0.26275032800134757, 'support': 459621}, 'accuracy': 0.38047720431268994, 'macro avg': {'precision': 0.4267713972065514, 'recall': 0.37100652077962165, 'f1-score': 0.32356905747939574, 'support': 1407196}, 'weighted avg': {'precision': 0.42516040937588084, 'recall': 0.38047720431268994, 'f1-score': 0.3273976827584319, 'support': 1407196}}
[[ 64625 351804  40792]
 [ 42911 385768  61675]
 [ 29834 344774  85013]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0884343
{'0': {'precision': 0.4579732065687122, 'recall': 0.1254676548588748, 'f1-score': 0.19697223151555704, 'support': 168928}, '1': {'precision': 0.36060418837545993, 'recall': 0.8351620188688312, 'f1-score': 0.5037153921087165, 'support': 187293}, '2': {'precision': 0.4418455486188318, 'recall': 0.12113503279543736, 'f1-score': 0.1901414606095457, 'support': 170603}, 'accuracy': 0.37637047666772966, 'macro avg': {'precision': 0.42014098118766796, 'recall': 0.3605882355077144, 'f1-score': 0.29694302807793976, 'support': 526824}, 'weighted avg': {'precision': 0.41813454630704555, 'recall': 0.37637047666772966, 'f1-score': 0.30381151136631623, 'support': 526824}}
[[ 21195 137361  10372]
 [ 15139 156420  15734]
 [  9946 139991  20666]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1035285
{'0': {'precision': 0.4709361764276325, 'recall': 0.10947765121292885, 'f1-score': 0.1776559551521329, 'support': 58907}, '1': {'precision': 0.33274264280001103, 'recall': 0.8437423505962164, 'f1-score': 0.4772675574368763, 'support': 57194}, '2': {'precision': 0.45374590742761767, 'recall': 0.1214474724217327, 'f1-score': 0.19160962385631988, 'support': 58198}, 'accuracy': 0.35441396680416987, 'macro avg': {'precision': 0.41914157555175374, 'recall': 0.35822249141029266, 'f1-score': 0.282177712148443, 'support': 174299}, 'weighted avg': {'precision': 0.41984993819585237, 'recall': 0.35441396680416987, 'f1-score': 0.28062878685122405, 'support': 174299}}
[[ 6449 48779  3679]
 [ 4107 48257  4830]
 [ 3138 47992  7068]]
training model: results/ATVI/W2/deepOF_L1/h100
Epoch 1/50
2058/2058 - 30s - loss: 3.2762 - accuracy100: 0.3845 - val_loss: 3.3049 - val_accuracy100: 0.3457 - 30s/epoch - 14ms/step
Epoch 2/50
2058/2058 - 27s - loss: 3.2572 - accuracy100: 0.3962 - val_loss: 3.3028 - val_accuracy100: 0.3522 - 27s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.2514 - accuracy100: 0.3985 - val_loss: 3.3019 - val_accuracy100: 0.3547 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 26s - loss: 3.2464 - accuracy100: 0.4016 - val_loss: 3.3051 - val_accuracy100: 0.3552 - 26s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.2428 - accuracy100: 0.4034 - val_loss: 3.3056 - val_accuracy100: 0.3550 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.2396 - accuracy100: 0.4060 - val_loss: 3.3050 - val_accuracy100: 0.3565 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.2366 - accuracy100: 0.4078 - val_loss: 3.3073 - val_accuracy100: 0.3578 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.2344 - accuracy100: 0.4083 - val_loss: 3.3054 - val_accuracy100: 0.3591 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.2314 - accuracy100: 0.4101 - val_loss: 3.3077 - val_accuracy100: 0.3596 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.2296 - accuracy100: 0.4111 - val_loss: 3.3089 - val_accuracy100: 0.3607 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.2284 - accuracy100: 0.4116 - val_loss: 3.3102 - val_accuracy100: 0.3617 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 26s - loss: 3.2264 - accuracy100: 0.4125 - val_loss: 3.3091 - val_accuracy100: 0.3635 - 26s/epoch - 13ms/step
Epoch 13/50
2058/2058 - 26s - loss: 3.2246 - accuracy100: 0.4131 - val_loss: 3.3122 - val_accuracy100: 0.3632 - 26s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h100
Evaluating performance on  test set...
5497/5497 - 33s - 33s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.093411
{'0': {'precision': 0.44802037508682563, 'recall': 0.12767220902612827, 'f1-score': 0.19871630295250323, 'support': 469836}, '1': {'precision': 0.32191941819644837, 'recall': 0.6604676305790204, 'f1-score': 0.43285862866089186, 'support': 445822}, '2': {'precision': 0.43903812800794123, 'recall': 0.3203292522653386, 'f1-score': 0.37040504744922204, 'support': 491538}, 'accuracy': 0.3637659572653703, 'macro avg': {'precision': 0.4029926404304051, 'recall': 0.3694896972901624, 'f1-score': 0.3339933263542057, 'support': 1407196}, 'weighted avg': {'precision': 0.404932065734438, 'recall': 0.3637659572653703, 'f1-score': 0.3328677232410724, 'support': 1407196}}
[[ 59985 319308  90543]
 [ 40734 294451 110637]
 [ 33170 300914 157454]]
Evaluating performance on  train set...
2058/2058 - 12s - 12s/epoch - 6ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0944651
{'0': {'precision': 0.4345423659205884, 'recall': 0.13199287812290908, 'f1-score': 0.2024816572216399, 'support': 176358}, '1': {'precision': 0.33783532494728924, 'recall': 0.6752746215911755, 'f1-score': 0.45035905923810027, 'support': 174877}, '2': {'precision': 0.41286598871517954, 'recall': 0.29087243506142185, 'f1-score': 0.3412953774703888, 'support': 175589}, 'accuracy': 0.3652870787967139, 'macro avg': {'precision': 0.39508122652768574, 'recall': 0.36604664492516875, 'f1-score': 0.33137869797670966, 'support': 526824}, 'weighted avg': {'precision': 0.3952161951284298, 'recall': 0.3652870787967139, 'f1-score': 0.3310297468249801, 'support': 526824}}
[[ 23278 120344  32736]
 [ 16891 118090  39896]
 [ 13400 111115  51074]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.101175
{'0': {'precision': 0.42868217054263563, 'recall': 0.11110366997053309, 'f1-score': 0.17647058823529413, 'support': 59728}, '1': {'precision': 0.322611188100915, 'recall': 0.6760095954403622, 'f1-score': 0.436778930194616, 'support': 55443}, '2': {'precision': 0.41355940152900894, 'recall': 0.2982512515221215, 'f1-score': 0.3465657855949691, 'support': 59128}, 'accuracy': 0.35428200965008405, 'macro avg': {'precision': 0.3882842533908532, 'recall': 0.36178817231100563, 'f1-score': 0.31993843467495975, 'support': 174299}, 'weighted avg': {'precision': 0.3898117664338683, 'recall': 0.35428200965008405, 'f1-score': 0.3169743446121726, 'support': 174299}}
[[ 6636 41208 11884]
 [ 4840 37480 13123]
 [ 4004 37489 17635]]
training model: results/ATVI/W2/deepOF_L1/h200
Epoch 1/50
2058/2058 - 31s - loss: 3.2899 - accuracy200: 0.3706 - val_loss: 3.3080 - val_accuracy200: 0.3399 - 31s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 28s - loss: 3.2732 - accuracy200: 0.3785 - val_loss: 3.2977 - val_accuracy200: 0.3488 - 28s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.2687 - accuracy200: 0.3820 - val_loss: 3.2967 - val_accuracy200: 0.3524 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.2667 - accuracy200: 0.3840 - val_loss: 3.2964 - val_accuracy200: 0.3535 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.2645 - accuracy200: 0.3863 - val_loss: 3.2977 - val_accuracy200: 0.3538 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.2630 - accuracy200: 0.3874 - val_loss: 3.2964 - val_accuracy200: 0.3539 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.2612 - accuracy200: 0.3888 - val_loss: 3.2963 - val_accuracy200: 0.3560 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.2605 - accuracy200: 0.3891 - val_loss: 3.2957 - val_accuracy200: 0.3574 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.2595 - accuracy200: 0.3897 - val_loss: 3.2968 - val_accuracy200: 0.3568 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.2584 - accuracy200: 0.3908 - val_loss: 3.2971 - val_accuracy200: 0.3570 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.2575 - accuracy200: 0.3911 - val_loss: 3.2981 - val_accuracy200: 0.3567 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.2566 - accuracy200: 0.3922 - val_loss: 3.2973 - val_accuracy200: 0.3573 - 27s/epoch - 13ms/step
Epoch 13/50
2058/2058 - 27s - loss: 3.2560 - accuracy200: 0.3925 - val_loss: 3.2977 - val_accuracy200: 0.3572 - 27s/epoch - 13ms/step
Epoch 14/50
2058/2058 - 28s - loss: 3.2548 - accuracy200: 0.3933 - val_loss: 3.2971 - val_accuracy200: 0.3573 - 28s/epoch - 14ms/step
Epoch 15/50
2058/2058 - 27s - loss: 3.2538 - accuracy200: 0.3939 - val_loss: 3.3001 - val_accuracy200: 0.3572 - 27s/epoch - 13ms/step
Epoch 16/50
2058/2058 - 27s - loss: 3.2523 - accuracy200: 0.3948 - val_loss: 3.2974 - val_accuracy200: 0.3591 - 27s/epoch - 13ms/step
Epoch 17/50
2058/2058 - 27s - loss: 3.2519 - accuracy200: 0.3949 - val_loss: 3.2999 - val_accuracy200: 0.3564 - 27s/epoch - 13ms/step
Epoch 18/50
2058/2058 - 27s - loss: 3.2506 - accuracy200: 0.3952 - val_loss: 3.2996 - val_accuracy200: 0.3575 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h200
Evaluating performance on  test set...
5497/5497 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0980096
{'0': {'precision': 0.41546850948154457, 'recall': 0.1068434827833799, 'f1-score': 0.16997542923468853, 'support': 474919}, '1': {'precision': 0.31914982217473853, 'recall': 0.5701310656816205, 'f1-score': 0.4092232965159012, 'support': 430166}, '2': {'precision': 0.4025934306724763, 'recall': 0.41422115826978495, 'f1-score': 0.4083245314727051, 'support': 502111}, 'accuracy': 0.35814342849183767, 'macro avg': {'precision': 0.3790705874429198, 'recall': 0.3637319022449285, 'f1-score': 0.3291744190744316, 'support': 1407196}, 'weighted avg': {'precision': 0.3814307896899025, 'recall': 0.35814342849183767, 'f1-score': 0.3281580876210987, 'support': 1407196}}
[[ 50742 264048 160129]
 [ 36416 245251 148499]
 [ 34974 259152 207985]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0954036
{'0': {'precision': 0.3995456881829185, 'recall': 0.13689610507658045, 'f1-score': 0.20392239829056213, 'support': 176024}, '1': {'precision': 0.34672964660096667, 'recall': 0.5016289603033158, 'f1-score': 0.41003799741116537, 'support': 176186}, '2': {'precision': 0.37466744165166316, 'recall': 0.45406439346215083, 'f1-score': 0.4105625907811647, 'support': 174614}, 'accuracy': 0.36399822331556647, 'macro avg': {'precision': 0.3736475921451828, 'recall': 0.36419648628068235, 'f1-score': 0.34150766216096407, 'support': 526824}, 'weighted avg': {'precision': 0.37363658525297155, 'recall': 0.36399822331556647, 'f1-score': 0.34134391575790735, 'support': 526824}}
[[24097 87962 63965]
 [19440 88380 68366]
 [16774 78554 79286]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 6ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0987165
{'0': {'precision': 0.38961534790493463, 'recall': 0.13863840915652012, 'f1-score': 0.20450645658245764, 'support': 58887}, '1': {'precision': 0.33649604765435515, 'recall': 0.46763771001432114, 'f1-score': 0.39137329991010816, 'support': 57258}, '2': {'precision': 0.36625006777639213, 'recall': 0.46461120473226264, 'f1-score': 0.40960841683974347, 'support': 58154}, 'accuracy': 0.35547536130442514, 'macro avg': {'precision': 0.3641204877785606, 'recall': 0.3569624413010346, 'f1-score': 0.33516272444410306, 'support': 174299}, 'weighted avg': {'precision': 0.36436971026878673, 'recall': 0.35547536130442514, 'f1-score': 0.33432430471731106, 'support': 174299}}
[[ 8164 27572 23151]
 [ 6880 26776 23602]
 [ 5910 25225 27019]]
training model: results/ATVI/W2/deepOF_L1/h300
Epoch 1/50
2058/2058 - 30s - loss: 3.2984 - accuracy300: 0.3626 - val_loss: 3.3187 - val_accuracy300: 0.3332 - 30s/epoch - 14ms/step
Epoch 2/50
2058/2058 - 27s - loss: 3.2828 - accuracy300: 0.3682 - val_loss: 3.3079 - val_accuracy300: 0.3395 - 27s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.2802 - accuracy300: 0.3706 - val_loss: 3.3002 - val_accuracy300: 0.3425 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.2781 - accuracy300: 0.3730 - val_loss: 3.2978 - val_accuracy300: 0.3435 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.2768 - accuracy300: 0.3752 - val_loss: 3.2978 - val_accuracy300: 0.3431 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.2755 - accuracy300: 0.3768 - val_loss: 3.2972 - val_accuracy300: 0.3442 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.2744 - accuracy300: 0.3773 - val_loss: 3.2973 - val_accuracy300: 0.3438 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.2734 - accuracy300: 0.3786 - val_loss: 3.2973 - val_accuracy300: 0.3453 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.2727 - accuracy300: 0.3795 - val_loss: 3.2965 - val_accuracy300: 0.3454 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.2720 - accuracy300: 0.3792 - val_loss: 3.2968 - val_accuracy300: 0.3466 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.2715 - accuracy300: 0.3799 - val_loss: 3.2958 - val_accuracy300: 0.3486 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.2707 - accuracy300: 0.3810 - val_loss: 3.2960 - val_accuracy300: 0.3492 - 27s/epoch - 13ms/step
Epoch 13/50
2058/2058 - 27s - loss: 3.2704 - accuracy300: 0.3811 - val_loss: 3.2953 - val_accuracy300: 0.3500 - 27s/epoch - 13ms/step
Epoch 14/50
2058/2058 - 27s - loss: 3.2698 - accuracy300: 0.3814 - val_loss: 3.2950 - val_accuracy300: 0.3504 - 27s/epoch - 13ms/step
Epoch 15/50
2058/2058 - 27s - loss: 3.2689 - accuracy300: 0.3822 - val_loss: 3.2959 - val_accuracy300: 0.3504 - 27s/epoch - 13ms/step
Epoch 16/50
2058/2058 - 27s - loss: 3.2680 - accuracy300: 0.3828 - val_loss: 3.2969 - val_accuracy300: 0.3495 - 27s/epoch - 13ms/step
Epoch 17/50
2058/2058 - 28s - loss: 3.2674 - accuracy300: 0.3831 - val_loss: 3.2967 - val_accuracy300: 0.3478 - 28s/epoch - 14ms/step
Epoch 18/50
2058/2058 - 27s - loss: 3.2672 - accuracy300: 0.3835 - val_loss: 3.2961 - val_accuracy300: 0.3501 - 27s/epoch - 13ms/step
Epoch 19/50
2058/2058 - 27s - loss: 3.2665 - accuracy300: 0.3839 - val_loss: 3.2958 - val_accuracy300: 0.3506 - 27s/epoch - 13ms/step
Epoch 20/50
2058/2058 - 27s - loss: 3.2659 - accuracy300: 0.3841 - val_loss: 3.2960 - val_accuracy300: 0.3508 - 27s/epoch - 13ms/step
Epoch 21/50
2058/2058 - 27s - loss: 3.2653 - accuracy300: 0.3847 - val_loss: 3.2967 - val_accuracy300: 0.3505 - 27s/epoch - 13ms/step
Epoch 22/50
2058/2058 - 27s - loss: 3.2642 - accuracy300: 0.3854 - val_loss: 3.2970 - val_accuracy300: 0.3507 - 27s/epoch - 13ms/step
Epoch 23/50
2058/2058 - 27s - loss: 3.2635 - accuracy300: 0.3862 - val_loss: 3.2966 - val_accuracy300: 0.3515 - 27s/epoch - 13ms/step
Epoch 24/50
2058/2058 - 27s - loss: 3.2633 - accuracy300: 0.3864 - val_loss: 3.2971 - val_accuracy300: 0.3512 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h300
Evaluating performance on  test set...
5497/5497 - 29s - 29s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1012274
{'0': {'precision': 0.4068690063459238, 'recall': 0.08281183910536144, 'f1-score': 0.13761441152318404, 'support': 484665}, '1': {'precision': 0.3015392830816833, 'recall': 0.5752153082063255, 'f1-score': 0.39566376584201446, 'support': 410342}, '2': {'precision': 0.40188632953138465, 'recall': 0.41255278813094387, 'f1-score': 0.407149711167546, 'support': 512189}, 'accuracy': 0.3464165617298514, 'macro avg': {'precision': 0.3700982063196639, 'recall': 0.35685997848087697, 'f1-score': 0.3134759628442481, 'support': 1407196}, 'weighted avg': {'precision': 0.374340999189382, 'recall': 0.3464165617298514, 'f1-score': 0.31096730887326435, 'support': 1407196}}
[[ 40136 277187 167342]
 [ 27171 236035 147136]
 [ 31339 269545 211305]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0980618
{'0': {'precision': 0.39551965535810446, 'recall': 0.10246308717342054, 'f1-score': 0.16276132269058774, 'support': 179206}, '1': {'precision': 0.32997324012096335, 'recall': 0.5366506657860285, 'f1-score': 0.4086671456798994, 'support': 169574}, '2': {'precision': 0.3759585168097824, 'recall': 0.43206173754802185, 'f1-score': 0.40206242143747534, 'support': 178044}, 'accuracy': 0.3536095546140647, 'macro avg': {'precision': 0.36715047076295004, 'recall': 0.35705849683582364, 'f1-score': 0.3244969632693208, 'support': 526824}, 'weighted avg': {'precision': 0.36781075984628187, 'recall': 0.3536095546140647, 'f1-score': 0.3227869837327582, 'support': 526824}}
[[18362 97264 63580]
 [14465 91002 64107]
 [13598 87520 76926]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.100083
{'0': {'precision': 0.3830848835776765, 'recall': 0.10450695704779189, 'f1-score': 0.1642153626785667, 'support': 59508}, '1': {'precision': 0.32643469287028315, 'recall': 0.5204879182987248, 'f1-score': 0.4012298444081374, 'support': 55911}, '2': {'precision': 0.37012638391108144, 'recall': 0.4332201086956522, 'f1-score': 0.3991955992707184, 'support': 58880}, 'accuracy': 0.3489865116839454, 'macro avg': {'precision': 0.359881986786347, 'recall': 0.3527383280140563, 'f1-score': 0.3215469354524742, 'support': 174299}, 'weighted avg': {'precision': 0.36053532636271723, 'recall': 0.3489865116839454, 'f1-score': 0.31962275468040213, 'support': 174299}}
[[ 6219 31369 21920]
 [ 5321 29101 21489]
 [ 4694 28678 25508]]
training model: results/ATVI/W2/deepOF_L1/h500
Epoch 1/50
2058/2058 - 30s - loss: 3.2450 - accuracy500: 0.4026 - val_loss: 3.5666 - val_accuracy500: 0.3493 - 30s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 27s - loss: 3.2357 - accuracy500: 0.4045 - val_loss: 3.6040 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.2482 - accuracy500: 0.3983 - val_loss: 3.4505 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.2499 - accuracy500: 0.3907 - val_loss: 3.5011 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.2427 - accuracy500: 0.3987 - val_loss: 3.4644 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.2457 - accuracy500: 0.3958 - val_loss: 3.4622 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.2436 - accuracy500: 0.3952 - val_loss: 3.4660 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.2424 - accuracy500: 0.3960 - val_loss: 3.4426 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.2423 - accuracy500: 0.3959 - val_loss: 3.4230 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.2421 - accuracy500: 0.3966 - val_loss: 3.3899 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.2406 - accuracy500: 0.3980 - val_loss: 3.4243 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.2379 - accuracy500: 0.4013 - val_loss: 3.3910 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 13/50
2058/2058 - 27s - loss: 3.2369 - accuracy500: 0.4022 - val_loss: 3.3998 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 14/50
2058/2058 - 27s - loss: 3.2358 - accuracy500: 0.4028 - val_loss: 3.4091 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 15/50
2058/2058 - 27s - loss: 3.2336 - accuracy500: 0.4058 - val_loss: 3.4275 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 16/50
2058/2058 - 27s - loss: 3.2338 - accuracy500: 0.4053 - val_loss: 3.4142 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 17/50
2058/2058 - 27s - loss: 3.2327 - accuracy500: 0.4061 - val_loss: 3.4050 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 18/50
2058/2058 - 27s - loss: 3.2318 - accuracy500: 0.4065 - val_loss: 3.4073 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 19/50
2058/2058 - 27s - loss: 3.2296 - accuracy500: 0.4081 - val_loss: 3.4275 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
Epoch 20/50
2058/2058 - 27s - loss: 3.2279 - accuracy500: 0.4095 - val_loss: 3.4045 - val_accuracy500: 0.3491 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h500
Evaluating performance on  test set...
5497/5497 - 28s - 28s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1466023
{'0': {'precision': 0.45454545454545453, 'recall': 7.54458309711603e-05, 'f1-score': 0.00015086662097563288, 'support': 463909}, '1': {'precision': 0.31215239134853323, 'recall': 0.9999294275665032, 'f1-score': 0.4757788081428569, 'support': 439265}, '2': {'precision': 0.4, 'recall': 3.9680807583795945e-06, 'f1-score': 7.936082789215657e-06, 'support': 504022}, 'accuracy': 0.31216049505541515, 'macro avg': {'precision': 0.3888992819646626, 'recall': 0.3333362804927442, 'f1-score': 0.15864587028220725, 'support': 1407196}, 'weighted avg': {'precision': 0.39055977096185657, 'recall': 0.31216049505541515, 'f1-score': 0.14856989822488254, 'support': 1407196}}
[[    35 463872      2]
 [    30 439234      1]
 [    12 504008      2]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1313674
{'0': {'precision': 0.4576271186440678, 'recall': 0.0001533071764792723, 'f1-score': 0.0003065116701480338, 'support': 176117}, '1': {'precision': 0.340742765694499, 'recall': 0.9998774455189625, 'f1-score': 0.5082737128560768, 'support': 179512}, '2': {'precision': 0.5, 'recall': 1.1682584187622302e-05, 'f1-score': 2.3364622456906875e-05, 'support': 171195}, 'accuracy': 0.3407570649780572, 'macro avg': {'precision': 0.432789961446189, 'recall': 0.3333474784265431, 'f1-score': 0.16953452971622726, 'support': 526824}, 'weighted avg': {'precision': 0.43156885527156735, 'recall': 0.3407570649780572, 'f1-score': 0.1733011642684711, 'support': 526824}}
[[    27 176089      1]
 [    21 179490      1]
 [    11 171182      2]]
Evaluating performance on  val set...
681/681 - 3s - 3s/epoch - 5ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1267997
{'0': {'precision': 0.4782608695652174, 'recall': 0.0001922303968683921, 'f1-score': 0.0003843063270796213, 'support': 57223}, '1': {'precision': 0.3491149046047913, 'recall': 0.9999178266800335, 'f1-score': 0.5175355772747765, 'support': 60847}, '2': {'precision': 1.0, 'recall': 1.7784417293567378e-05, 'f1-score': 3.556820202738752e-05, 'support': 56229}, 'accuracy': 0.349135680640738, 'macro avg': {'precision': 0.6091252580566696, 'recall': 0.3333759471647318, 'f1-score': 0.1726518172679612, 'support': 174299}, 'weighted avg': {'precision': 0.6014900621324171, 'recall': 0.349135680640738, 'f1-score': 0.1808069948526647, 'support': 174299}}
[[   11 57212     0]
 [    5 60842     0]
 [    7 56221     1]]
training model: results/ATVI/W2/deepOF_L1/h1000
Epoch 1/50
2058/2058 - 31s - loss: 3.3027 - accuracy1000: 0.3656 - val_loss: 3.3699 - val_accuracy1000: 0.3249 - 31s/epoch - 15ms/step
Epoch 2/50
2058/2058 - 28s - loss: 3.2897 - accuracy1000: 0.3633 - val_loss: 3.3376 - val_accuracy1000: 0.3251 - 28s/epoch - 14ms/step
Epoch 3/50
2058/2058 - 27s - loss: 3.2834 - accuracy1000: 0.3665 - val_loss: 3.3335 - val_accuracy1000: 0.3246 - 27s/epoch - 13ms/step
Epoch 4/50
2058/2058 - 27s - loss: 3.2792 - accuracy1000: 0.3709 - val_loss: 3.3341 - val_accuracy1000: 0.3245 - 27s/epoch - 13ms/step
Epoch 5/50
2058/2058 - 27s - loss: 3.2759 - accuracy1000: 0.3748 - val_loss: 3.3322 - val_accuracy1000: 0.3242 - 27s/epoch - 13ms/step
Epoch 6/50
2058/2058 - 27s - loss: 3.2736 - accuracy1000: 0.3765 - val_loss: 3.3351 - val_accuracy1000: 0.3244 - 27s/epoch - 13ms/step
Epoch 7/50
2058/2058 - 27s - loss: 3.2719 - accuracy1000: 0.3776 - val_loss: 3.3358 - val_accuracy1000: 0.3242 - 27s/epoch - 13ms/step
Epoch 8/50
2058/2058 - 27s - loss: 3.2700 - accuracy1000: 0.3791 - val_loss: 3.3463 - val_accuracy1000: 0.3241 - 27s/epoch - 13ms/step
Epoch 9/50
2058/2058 - 27s - loss: 3.2683 - accuracy1000: 0.3802 - val_loss: 3.3447 - val_accuracy1000: 0.3242 - 27s/epoch - 13ms/step
Epoch 10/50
2058/2058 - 27s - loss: 3.2675 - accuracy1000: 0.3816 - val_loss: 3.3481 - val_accuracy1000: 0.3243 - 27s/epoch - 13ms/step
Epoch 11/50
2058/2058 - 27s - loss: 3.2662 - accuracy1000: 0.3818 - val_loss: 3.3448 - val_accuracy1000: 0.3244 - 27s/epoch - 13ms/step
Epoch 12/50
2058/2058 - 27s - loss: 3.2645 - accuracy1000: 0.3828 - val_loss: 3.3487 - val_accuracy1000: 0.3243 - 27s/epoch - 13ms/step
Epoch 13/50
2058/2058 - 28s - loss: 3.2638 - accuracy1000: 0.3829 - val_loss: 3.3481 - val_accuracy1000: 0.3242 - 28s/epoch - 13ms/step
Epoch 14/50
2058/2058 - 27s - loss: 3.2628 - accuracy1000: 0.3839 - val_loss: 3.3516 - val_accuracy1000: 0.3244 - 27s/epoch - 13ms/step
Epoch 15/50
2058/2058 - 27s - loss: 3.2617 - accuracy1000: 0.3843 - val_loss: 3.3527 - val_accuracy1000: 0.3244 - 27s/epoch - 13ms/step
testing model: results/ATVI/W2/deepOF_L1/h1000
Evaluating performance on  test set...
5497/5497 - 27s - 27s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1112927
{'0': {'precision': 0.30256410256410254, 'recall': 0.0005196532415572862, 'f1-score': 0.0010375245367958516, 'support': 454149}, '1': {'precision': 0.31742340707856465, 'recall': 0.9872788043417507, 'f1-score': 0.4803937619902627, 'support': 447285}, '2': {'precision': 0.3850952068286277, 'recall': 0.011596363506945954, 'f1-score': 0.02251474110926847, 'support': 505762}, 'accuracy': 0.31814757858891013, 'macro avg': {'precision': 0.33502757215709833, 'recall': 0.33313160703008465, 'f1-score': 0.167982009212109, 'support': 1407196}, 'weighted avg': {'precision': 0.3369498174004053, 'recall': 0.31814757858891013, 'f1-score': 0.16112269723306616, 'support': 1407196}}
[[   236 449906   4007]
 [   332 441595   5358]
 [   212 499685   5865]]
Evaluating performance on  train set...
2058/2058 - 11s - 11s/epoch - 6ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1123443
{'0': {'precision': 0.3413333333333333, 'recall': 0.0007046828376697019, 'f1-score': 0.0014064620337660766, 'support': 181642}, '1': {'precision': 0.32922500360351703, 'recall': 0.9875250766712016, 'f1-score': 0.49381876150379145, 'support': 173468}, '2': {'precision': 0.34732201175702154, 'recall': 0.012386875851706908, 'f1-score': 0.023920646880869107, 'support': 171714}, 'accuracy': 0.3294439888843333, 'macro avg': {'precision': 0.339293449564624, 'recall': 0.33353887845352603, 'f1-score': 0.1730486234728089, 'support': 526824}, 'weighted avg': {'precision': 0.33929836944648195, 'recall': 0.3294439888843333, 'f1-score': 0.17088199371285018, 'support': 526824}}
[[   128 179548   1966]
 [   133 171304   2031]
 [   114 169473   2127]]
Evaluating performance on  val set...
681/681 - 4s - 4s/epoch - 5ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.112907
{'0': {'precision': 0.4659090909090909, 'recall': 0.0006905728385912314, 'f1-score': 0.0013791015657848263, 'support': 59371}, '1': {'precision': 0.3242821473158552, 'recall': 0.992798117247359, 'f1-score': 0.488879400860022, 'support': 56513}, '2': {'precision': 0.3523012552301255, 'recall': 0.007207052982966704, 'f1-score': 0.01412514678745177, 'support': 58415}, 'accuracy': 0.32454575184022855, 'macro avg': {'precision': 0.38083083115169053, 'recall': 0.33356524768963897, 'f1-score': 0.1681278830710862, 'support': 174299}, 'weighted avg': {'precision': 0.3819145459921878, 'recall': 0.32454575184022855, 'f1-score': 0.16371316341145747, 'support': 174299}}
[[   41 58937   393]
 [   26 56106   381]
 [   21 57973   421]]
training model: results/ATVI/W2/deepLOB_L2/h10
Epoch 1/50
2058/2058 - 87s - loss: 2.9862 - accuracy10: 0.4373 - val_loss: 3.6184 - val_accuracy10: 0.4290 - 87s/epoch - 42ms/step
Epoch 2/50
2058/2058 - 82s - loss: 2.7918 - accuracy10: 0.4972 - val_loss: 3.4121 - val_accuracy10: 0.4332 - 82s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 82s - loss: 2.6750 - accuracy10: 0.5493 - val_loss: 3.3077 - val_accuracy10: 0.4437 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 82s - loss: 2.6042 - accuracy10: 0.5740 - val_loss: 3.1470 - val_accuracy10: 0.4458 - 82s/epoch - 40ms/step
Epoch 5/50
2058/2058 - 82s - loss: 2.5625 - accuracy10: 0.5853 - val_loss: 3.1325 - val_accuracy10: 0.4729 - 82s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 2.5358 - accuracy10: 0.5925 - val_loss: 3.1896 - val_accuracy10: 0.4638 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 82s - loss: 2.5147 - accuracy10: 0.5970 - val_loss: 3.1834 - val_accuracy10: 0.4578 - 82s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 82s - loss: 2.4997 - accuracy10: 0.5998 - val_loss: 3.1866 - val_accuracy10: 0.4458 - 82s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 82s - loss: 2.4866 - accuracy10: 0.6013 - val_loss: 3.0616 - val_accuracy10: 0.4708 - 82s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 82s - loss: 2.4755 - accuracy10: 0.6031 - val_loss: 3.1068 - val_accuracy10: 0.4623 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 82s - loss: 2.4651 - accuracy10: 0.6047 - val_loss: 3.0610 - val_accuracy10: 0.4757 - 82s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 82s - loss: 2.4559 - accuracy10: 0.6052 - val_loss: 3.1231 - val_accuracy10: 0.4624 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 82s - loss: 2.4475 - accuracy10: 0.6065 - val_loss: 3.0583 - val_accuracy10: 0.4759 - 82s/epoch - 40ms/step
Epoch 14/50
2058/2058 - 82s - loss: 2.4402 - accuracy10: 0.6071 - val_loss: 3.0121 - val_accuracy10: 0.4949 - 82s/epoch - 40ms/step
Epoch 15/50
2058/2058 - 81s - loss: 2.4324 - accuracy10: 0.6080 - val_loss: 2.9674 - val_accuracy10: 0.4999 - 81s/epoch - 39ms/step
Epoch 16/50
2058/2058 - 82s - loss: 2.4270 - accuracy10: 0.6086 - val_loss: 3.0339 - val_accuracy10: 0.4734 - 82s/epoch - 40ms/step
Epoch 17/50
2058/2058 - 81s - loss: 2.4209 - accuracy10: 0.6095 - val_loss: 2.9530 - val_accuracy10: 0.5014 - 81s/epoch - 40ms/step
Epoch 18/50
2058/2058 - 82s - loss: 2.4151 - accuracy10: 0.6102 - val_loss: 3.0636 - val_accuracy10: 0.4723 - 82s/epoch - 40ms/step
Epoch 19/50
2058/2058 - 82s - loss: 2.4096 - accuracy10: 0.6105 - val_loss: 3.0176 - val_accuracy10: 0.4917 - 82s/epoch - 40ms/step
Epoch 20/50
2058/2058 - 81s - loss: 2.4026 - accuracy10: 0.6120 - val_loss: 3.0083 - val_accuracy10: 0.5023 - 81s/epoch - 40ms/step
Epoch 21/50
2058/2058 - 82s - loss: 2.3988 - accuracy10: 0.6119 - val_loss: 3.0118 - val_accuracy10: 0.5207 - 82s/epoch - 40ms/step
Epoch 22/50
2058/2058 - 82s - loss: 2.3929 - accuracy10: 0.6126 - val_loss: 2.9711 - val_accuracy10: 0.5117 - 82s/epoch - 40ms/step
Epoch 23/50
2058/2058 - 81s - loss: 2.3882 - accuracy10: 0.6127 - val_loss: 2.9755 - val_accuracy10: 0.5181 - 81s/epoch - 39ms/step
Epoch 24/50
2058/2058 - 82s - loss: 2.3835 - accuracy10: 0.6138 - val_loss: 2.9614 - val_accuracy10: 0.5174 - 82s/epoch - 40ms/step
Epoch 25/50
2058/2058 - 81s - loss: 2.3796 - accuracy10: 0.6144 - val_loss: 2.9802 - val_accuracy10: 0.5145 - 81s/epoch - 39ms/step
Epoch 26/50
2058/2058 - 82s - loss: 2.3749 - accuracy10: 0.6146 - val_loss: 2.9442 - val_accuracy10: 0.5140 - 82s/epoch - 40ms/step
Epoch 27/50
2058/2058 - 81s - loss: 2.3719 - accuracy10: 0.6152 - val_loss: 2.9434 - val_accuracy10: 0.5184 - 81s/epoch - 39ms/step
Epoch 28/50
2058/2058 - 81s - loss: 2.3671 - accuracy10: 0.6154 - val_loss: 2.9256 - val_accuracy10: 0.5050 - 81s/epoch - 40ms/step
Epoch 29/50
2058/2058 - 82s - loss: 2.3622 - accuracy10: 0.6163 - val_loss: 2.9598 - val_accuracy10: 0.5092 - 82s/epoch - 40ms/step
Epoch 30/50
2058/2058 - 82s - loss: 2.3586 - accuracy10: 0.6160 - val_loss: 3.0883 - val_accuracy10: 0.4998 - 82s/epoch - 40ms/step
Epoch 31/50
2058/2058 - 82s - loss: 2.3546 - accuracy10: 0.6167 - val_loss: 3.0223 - val_accuracy10: 0.5044 - 82s/epoch - 40ms/step
Epoch 32/50
2058/2058 - 82s - loss: 2.3513 - accuracy10: 0.6172 - val_loss: 2.9728 - val_accuracy10: 0.5072 - 82s/epoch - 40ms/step
Epoch 33/50
2058/2058 - 81s - loss: 2.3467 - accuracy10: 0.6175 - val_loss: 2.9599 - val_accuracy10: 0.5128 - 81s/epoch - 40ms/step
Epoch 34/50
2058/2058 - 82s - loss: 2.3428 - accuracy10: 0.6178 - val_loss: 3.0611 - val_accuracy10: 0.4879 - 82s/epoch - 40ms/step
Epoch 35/50
2058/2058 - 82s - loss: 2.3383 - accuracy10: 0.6180 - val_loss: 3.0752 - val_accuracy10: 0.4901 - 82s/epoch - 40ms/step
Epoch 36/50
2058/2058 - 81s - loss: 2.3351 - accuracy10: 0.6189 - val_loss: 3.0288 - val_accuracy10: 0.4991 - 81s/epoch - 39ms/step
Epoch 37/50
2058/2058 - 81s - loss: 2.3319 - accuracy10: 0.6190 - val_loss: 3.1523 - val_accuracy10: 0.4755 - 81s/epoch - 39ms/step
Epoch 38/50
2058/2058 - 81s - loss: 2.3291 - accuracy10: 0.6195 - val_loss: 3.0751 - val_accuracy10: 0.4759 - 81s/epoch - 39ms/step
testing model: results/ATVI/W2/deepLOB_L2/h10
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9157233
{'0': {'precision': 0.4078830015281987, 'recall': 0.5730710888665792, 'f1-score': 0.4765685939937598, 'support': 272926}, '1': {'precision': 0.8314258705802595, 'recall': 0.5012370552443889, 'f1-score': 0.6254266505774866, 'support': 868595}, '2': {'precision': 0.345662250198961, 'recall': 0.6506511592893707, 'f1-score': 0.4514754928974194, 'support': 265680}, 'accuracy': 0.5433786644551845, 'macro avg': {'precision': 0.5283237074358064, 'recall': 0.5749864344667796, 'f1-score': 0.5178235791562219, 'support': 1407201}, 'weighted avg': {'precision': 0.6575675946539306, 'recall': 0.5433786644551845, 'f1-score': 0.5637136632191699, 'support': 1407201}}
[[156406  53873  62647]
 [168637 435372 264586]
 [ 58415  34400 172865]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9170259
{'0': {'precision': 0.43175979956869215, 'recall': 0.5690148792109003, 'f1-score': 0.4909751523675575, 'support': 95704}, '1': {'precision': 0.8407332651885828, 'recall': 0.48513155846177797, 'f1-score': 0.6152455844912791, 'support': 333996}, '2': {'precision': 0.3277026864580779, 'recall': 0.7017009184135744, 'f1-score': 0.44676213482446336, 'support': 97124}, 'accuracy': 0.540296189998937, 'macro avg': {'precision': 0.533398583738451, 'recall': 0.5852824520287508, 'f1-score': 0.5176609572277666, 'support': 526824}, 'weighted avg': {'precision': 0.6718571728269828, 'recall': 0.540296189998937, 'f1-score': 0.5616091442353142, 'support': 526824}}
[[ 54457  19205  22042]
 [ 54189 162032 117775]
 [ 17482  11490  68152]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.9842229
{'0': {'precision': 0.41881178232651023, 'recall': 0.5910769144048927, 'f1-score': 0.4902519986909159, 'support': 35481}, '1': {'precision': 0.8282241215574548, 'recall': 0.4207083522272284, 'f1-score': 0.5579818169022195, 'support': 103649}, '2': {'precision': 0.3264593288065499, 'recall': 0.6643919360800705, 'f1-score': 0.4377991999475376, 'support': 35169}, 'accuracy': 0.5045582590835289, 'macro avg': {'precision': 0.5244984108968384, 'recall': 0.5587257342373972, 'f1-score': 0.4953443385135577, 'support': 174299}, 'weighted avg': {'precision': 0.643639441183444, 'recall': 0.5045582590835289, 'f1-score': 0.5199447419010177, 'support': 174299}}
[[20972  5716  8793]
 [20628 43606 39415]
 [ 8475  3328 23366]]
training model: results/ATVI/W2/deepLOB_L2/h20
Epoch 1/50
2058/2058 - 86s - loss: 3.0459 - accuracy20: 0.4470 - val_loss: 3.4800 - val_accuracy20: 0.4593 - 86s/epoch - 42ms/step
Epoch 2/50
2058/2058 - 84s - loss: 2.9078 - accuracy20: 0.4922 - val_loss: 3.3101 - val_accuracy20: 0.4731 - 84s/epoch - 41ms/step
Epoch 3/50
2058/2058 - 82s - loss: 2.8360 - accuracy20: 0.5214 - val_loss: 3.3281 - val_accuracy20: 0.4782 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 82s - loss: 2.7897 - accuracy20: 0.5389 - val_loss: 3.2912 - val_accuracy20: 0.4880 - 82s/epoch - 40ms/step
Epoch 5/50
2058/2058 - 81s - loss: 2.7463 - accuracy20: 0.5534 - val_loss: 3.1993 - val_accuracy20: 0.4665 - 81s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 81s - loss: 2.7110 - accuracy20: 0.5655 - val_loss: 3.0959 - val_accuracy20: 0.4944 - 81s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 82s - loss: 2.6850 - accuracy20: 0.5721 - val_loss: 3.1368 - val_accuracy20: 0.4837 - 82s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 82s - loss: 2.6655 - accuracy20: 0.5771 - val_loss: 3.1281 - val_accuracy20: 0.4752 - 82s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 81s - loss: 2.6505 - accuracy20: 0.5799 - val_loss: 3.1416 - val_accuracy20: 0.4713 - 81s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 81s - loss: 2.6376 - accuracy20: 0.5823 - val_loss: 3.0995 - val_accuracy20: 0.4719 - 81s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 81s - loss: 2.6247 - accuracy20: 0.5850 - val_loss: 3.0822 - val_accuracy20: 0.4909 - 81s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 81s - loss: 2.6131 - accuracy20: 0.5868 - val_loss: 3.0781 - val_accuracy20: 0.4925 - 81s/epoch - 39ms/step
Epoch 13/50
2058/2058 - 81s - loss: 2.6035 - accuracy20: 0.5882 - val_loss: 3.0471 - val_accuracy20: 0.5041 - 81s/epoch - 40ms/step
Epoch 14/50
2058/2058 - 82s - loss: 2.5940 - accuracy20: 0.5897 - val_loss: 3.0342 - val_accuracy20: 0.5054 - 82s/epoch - 40ms/step
Epoch 15/50
2058/2058 - 81s - loss: 2.5854 - accuracy20: 0.5911 - val_loss: 3.0230 - val_accuracy20: 0.5140 - 81s/epoch - 39ms/step
Epoch 16/50
2058/2058 - 81s - loss: 2.5771 - accuracy20: 0.5926 - val_loss: 3.0293 - val_accuracy20: 0.5029 - 81s/epoch - 39ms/step
Epoch 17/50
2058/2058 - 81s - loss: 2.5710 - accuracy20: 0.5927 - val_loss: 3.0304 - val_accuracy20: 0.5101 - 81s/epoch - 39ms/step
Epoch 18/50
2058/2058 - 82s - loss: 2.5634 - accuracy20: 0.5943 - val_loss: 3.0001 - val_accuracy20: 0.5205 - 82s/epoch - 40ms/step
Epoch 19/50
2058/2058 - 81s - loss: 2.5582 - accuracy20: 0.5947 - val_loss: 3.0063 - val_accuracy20: 0.5207 - 81s/epoch - 40ms/step
Epoch 20/50
2058/2058 - 81s - loss: 2.5529 - accuracy20: 0.5963 - val_loss: 3.0088 - val_accuracy20: 0.5040 - 81s/epoch - 40ms/step
Epoch 21/50
2058/2058 - 82s - loss: 2.5469 - accuracy20: 0.5969 - val_loss: 3.0312 - val_accuracy20: 0.5055 - 82s/epoch - 40ms/step
Epoch 22/50
2058/2058 - 81s - loss: 2.5418 - accuracy20: 0.5980 - val_loss: 3.0372 - val_accuracy20: 0.5066 - 81s/epoch - 40ms/step
Epoch 23/50
2058/2058 - 82s - loss: 2.5371 - accuracy20: 0.5984 - val_loss: 2.9934 - val_accuracy20: 0.5174 - 82s/epoch - 40ms/step
Epoch 24/50
2058/2058 - 82s - loss: 2.5320 - accuracy20: 0.5988 - val_loss: 3.0043 - val_accuracy20: 0.5160 - 82s/epoch - 40ms/step
Epoch 25/50
2058/2058 - 82s - loss: 2.5280 - accuracy20: 0.5998 - val_loss: 2.9846 - val_accuracy20: 0.5208 - 82s/epoch - 40ms/step
Epoch 26/50
2058/2058 - 82s - loss: 2.5225 - accuracy20: 0.6007 - val_loss: 3.0143 - val_accuracy20: 0.5268 - 82s/epoch - 40ms/step
Epoch 27/50
2058/2058 - 82s - loss: 2.5178 - accuracy20: 0.6011 - val_loss: 2.9857 - val_accuracy20: 0.5260 - 82s/epoch - 40ms/step
Epoch 28/50
2058/2058 - 81s - loss: 2.5130 - accuracy20: 0.6019 - val_loss: 2.9982 - val_accuracy20: 0.5294 - 81s/epoch - 40ms/step
Epoch 29/50
2058/2058 - 81s - loss: 2.5087 - accuracy20: 0.6025 - val_loss: 3.0815 - val_accuracy20: 0.5184 - 81s/epoch - 40ms/step
Epoch 30/50
2058/2058 - 81s - loss: 2.5048 - accuracy20: 0.6034 - val_loss: 3.1043 - val_accuracy20: 0.5310 - 81s/epoch - 40ms/step
Epoch 31/50
2058/2058 - 82s - loss: 2.4994 - accuracy20: 0.6046 - val_loss: 3.1265 - val_accuracy20: 0.5317 - 82s/epoch - 40ms/step
Epoch 32/50
2058/2058 - 82s - loss: 2.4960 - accuracy20: 0.6050 - val_loss: 3.0544 - val_accuracy20: 0.5427 - 82s/epoch - 40ms/step
Epoch 33/50
2058/2058 - 82s - loss: 2.4925 - accuracy20: 0.6050 - val_loss: 3.0420 - val_accuracy20: 0.5374 - 82s/epoch - 40ms/step
Epoch 34/50
2058/2058 - 81s - loss: 2.4882 - accuracy20: 0.6056 - val_loss: 3.0866 - val_accuracy20: 0.5434 - 81s/epoch - 40ms/step
Epoch 35/50
2058/2058 - 81s - loss: 2.4843 - accuracy20: 0.6063 - val_loss: 3.1250 - val_accuracy20: 0.5285 - 81s/epoch - 39ms/step
testing model: results/ATVI/W2/deepLOB_L2/h20
Evaluating performance on  test set...
5497/5497 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9444363
{'0': {'precision': 0.44656289150271106, 'recall': 0.5100379155430554, 'f1-score': 0.4761944682951234, 'support': 345241}, '1': {'precision': 0.7268476956932781, 'recall': 0.5080434686035405, 'f1-score': 0.5980611654578912, 'support': 720336}, '2': {'precision': 0.40272872721561853, 'recall': 0.6005081610191322, 'f1-score': 0.4821231958393409, 'support': 341624}, 'accuracy': 0.5309802935046237, 'macro avg': {'precision': 0.5253797714705359, 'recall': 0.5395298483885761, 'f1-score': 0.5187929431974518, 'support': 1407201}, 'weighted avg': {'precision': 0.5793971008096989, 'recall': 0.5309802935046237, 'f1-score': 0.5400164559045731, 'support': 1407201}}
[[176086  76757  92398]
 [142525 365962 211849]
 [ 75703  60773 205148]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9241753
{'0': {'precision': 0.49958478095076686, 'recall': 0.4743842483444508, 'f1-score': 0.48665849460767924, 'support': 124279}, '1': {'precision': 0.7315446751973973, 'recall': 0.52291759200078, 'f1-score': 0.6098829594127334, 'support': 276927}, '2': {'precision': 0.3991786136021967, 'recall': 0.6700632075021096, 'f1-score': 0.5003075953768563, 'support': 125618}, 'accuracy': 0.5465544470259518, 'macro avg': {'precision': 0.5434360232501203, 'recall': 0.5557883492824468, 'f1-score': 0.5322830164657563, 'support': 526824}, 'weighted avg': {'precision': 0.5975741202823919, 'recall': 0.5465544470259518, 'f1-score': 0.5546864396244053, 'support': 526824}}
[[ 58956  31639  33684]
 [ 39110 144810  93007]
 [ 19944  21502  84172]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.96415806
{'0': {'precision': 0.4928919182083739, 'recall': 0.45030579339486265, 'f1-score': 0.4706374571445174, 'support': 44965}, '1': {'precision': 0.6990125688558418, 'recall': 0.4840225785881297, 'f1-score': 0.5719827796733161, 'support': 84682}, '2': {'precision': 0.3956182456893084, 'recall': 0.6607990683508017, 'f1-score': 0.4949259439421642, 'support': 44652}, 'accuracy': 0.5206111337414443, 'macro avg': {'precision': 0.5291742442511748, 'recall': 0.5317091467779314, 'f1-score': 0.5125153935866659, 'support': 174299}, 'weighted avg': {'precision': 0.5681146384351542, 'recall': 0.5206111337414443, 'f1-score': 0.526097638298008, 'support': 174299}}
[[20248 10763 13954]
 [12572 40988 31122]
 [ 8260  6886 29506]]
training model: results/ATVI/W2/deepLOB_L2/h30
Epoch 1/50
2058/2058 - 87s - loss: 3.0929 - accuracy30: 0.4497 - val_loss: 3.6507 - val_accuracy30: 0.4511 - 87s/epoch - 42ms/step
Epoch 2/50
2058/2058 - 83s - loss: 2.9605 - accuracy30: 0.4941 - val_loss: 3.2960 - val_accuracy30: 0.4524 - 83s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 82s - loss: 2.8993 - accuracy30: 0.5150 - val_loss: 3.1748 - val_accuracy30: 0.4857 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 81s - loss: 2.8524 - accuracy30: 0.5300 - val_loss: 3.1609 - val_accuracy30: 0.4789 - 81s/epoch - 39ms/step
Epoch 5/50
2058/2058 - 81s - loss: 2.8156 - accuracy30: 0.5427 - val_loss: 3.1877 - val_accuracy30: 0.4618 - 81s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 2.7869 - accuracy30: 0.5508 - val_loss: 3.2232 - val_accuracy30: 0.4444 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 81s - loss: 2.7643 - accuracy30: 0.5565 - val_loss: 3.2594 - val_accuracy30: 0.4275 - 81s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 81s - loss: 2.7483 - accuracy30: 0.5598 - val_loss: 3.3198 - val_accuracy30: 0.4175 - 81s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 81s - loss: 2.7336 - accuracy30: 0.5627 - val_loss: 3.3082 - val_accuracy30: 0.4255 - 81s/epoch - 39ms/step
Epoch 10/50
2058/2058 - 82s - loss: 2.7216 - accuracy30: 0.5647 - val_loss: 3.3444 - val_accuracy30: 0.4135 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 82s - loss: 2.7112 - accuracy30: 0.5666 - val_loss: 3.4352 - val_accuracy30: 0.4085 - 82s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 82s - loss: 2.7011 - accuracy30: 0.5683 - val_loss: 3.3549 - val_accuracy30: 0.4152 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 82s - loss: 2.6942 - accuracy30: 0.5700 - val_loss: 3.4457 - val_accuracy30: 0.4069 - 82s/epoch - 40ms/step
Epoch 14/50
2058/2058 - 82s - loss: 2.6872 - accuracy30: 0.5705 - val_loss: 3.4866 - val_accuracy30: 0.3975 - 82s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h30
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9848244
{'0': {'precision': 0.4529845829490051, 'recall': 0.43699946609717033, 'f1-score': 0.44484846916328064, 'support': 393330}, '1': {'precision': 0.6018489885201831, 'recall': 0.5110100225838357, 'f1-score': 0.5527220647845582, 'support': 620798}, '2': {'precision': 0.4271390107300081, 'recall': 0.5440414375955611, 'f1-score': 0.4785543651570673, 'support': 393073}, 'accuracy': 0.49954981555584455, 'macro avg': {'precision': 0.4939908607330655, 'recall': 0.4973503087588557, 'f1-score': 0.4920416330349687, 'support': 1407201}, 'weighted avg': {'precision': 0.5114378733040705, 'recall': 0.49954981555584455, 'f1-score': 0.5018528275104276, 'support': 1407201}}
[[171885 116441 105004]
 [121764 317234 181800]
 [ 85801  93424 213848]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0056918
{'0': {'precision': 0.5187886438280912, 'recall': 0.30880654542418634, 'f1-score': 0.38715867609282534, 'support': 143734}, '1': {'precision': 0.6052017872437029, 'recall': 0.49278461389807293, 'f1-score': 0.5432382928371127, 'support': 238033}, '2': {'precision': 0.3968534930430109, 'recall': 0.676982151843758, 'f1-score': 0.5003796120314086, 'support': 145057}, 'accuracy': 0.49330706270025665, 'macro avg': {'precision': 0.5069479747049349, 'recall': 0.49285777038867246, 'f1-score': 0.47692552698711554, 'support': 526824}, 'weighted avg': {'precision': 0.5242584641081409, 'recall': 0.49330706270025665, 'f1-score': 0.48885409755603887, 'support': 526824}}
[[ 44386  47491  51857]
 [ 23343 117299  97391]
 [ 17828  29028  98201]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.02651
{'0': {'precision': 0.534793597304128, 'recall': 0.24810443211131086, 'f1-score': 0.33895771038017936, 'support': 51172}, '1': {'precision': 0.5786018925763028, 'recall': 0.4803131093808345, 'f1-score': 0.5248959049655787, 'support': 72307}, '2': {'precision': 0.39924890926161155, 'recall': 0.7112554112554113, 'f1-score': 0.5114215981040642, 'support': 50820}, 'accuracy': 0.4794749252720899, 'macro avg': {'precision': 0.5042147997140142, 'recall': 0.4798909842491856, 'f1-score': 0.45842507114994074, 'support': 174299}, 'weighted avg': {'precision': 0.5134467471209627, 'recall': 0.4794749252720899, 'f1-score': 0.4663781075712952, 'support': 174299}}
[[12696 16525 21951]
 [ 5139 34730 32438]
 [ 5905  8769 36146]]
training model: results/ATVI/W2/deepLOB_L2/h50
Epoch 1/50
2058/2058 - 85s - loss: 3.1486 - accuracy50: 0.4411 - val_loss: 3.5164 - val_accuracy50: 0.3939 - 85s/epoch - 41ms/step
Epoch 2/50
2058/2058 - 82s - loss: 3.0429 - accuracy50: 0.4750 - val_loss: 3.3487 - val_accuracy50: 0.4049 - 82s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 82s - loss: 3.0020 - accuracy50: 0.4902 - val_loss: 3.2479 - val_accuracy50: 0.4115 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 82s - loss: 2.9711 - accuracy50: 0.4997 - val_loss: 3.2635 - val_accuracy50: 0.4109 - 82s/epoch - 40ms/step
Epoch 5/50
2058/2058 - 81s - loss: 2.9439 - accuracy50: 0.5077 - val_loss: 3.2083 - val_accuracy50: 0.4244 - 81s/epoch - 39ms/step
Epoch 6/50
2058/2058 - 82s - loss: 2.9189 - accuracy50: 0.5134 - val_loss: 3.2188 - val_accuracy50: 0.4208 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 81s - loss: 2.9006 - accuracy50: 0.5176 - val_loss: 3.1733 - val_accuracy50: 0.4330 - 81s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 81s - loss: 2.8872 - accuracy50: 0.5210 - val_loss: 3.1758 - val_accuracy50: 0.4302 - 81s/epoch - 39ms/step
Epoch 9/50
2058/2058 - 82s - loss: 2.8757 - accuracy50: 0.5238 - val_loss: 3.2361 - val_accuracy50: 0.4211 - 82s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 82s - loss: 2.8677 - accuracy50: 0.5250 - val_loss: 3.2133 - val_accuracy50: 0.4281 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 82s - loss: 2.8590 - accuracy50: 0.5275 - val_loss: 3.2534 - val_accuracy50: 0.4185 - 82s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 82s - loss: 2.8519 - accuracy50: 0.5283 - val_loss: 3.2445 - val_accuracy50: 0.4216 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 82s - loss: 2.8438 - accuracy50: 0.5306 - val_loss: 3.2343 - val_accuracy50: 0.4176 - 82s/epoch - 40ms/step
Epoch 14/50
2058/2058 - 82s - loss: 2.8371 - accuracy50: 0.5320 - val_loss: 3.2380 - val_accuracy50: 0.4241 - 82s/epoch - 40ms/step
Epoch 15/50
2058/2058 - 82s - loss: 2.8306 - accuracy50: 0.5339 - val_loss: 3.3115 - val_accuracy50: 0.4154 - 82s/epoch - 40ms/step
Epoch 16/50
2058/2058 - 81s - loss: 2.8249 - accuracy50: 0.5349 - val_loss: 3.3841 - val_accuracy50: 0.4079 - 81s/epoch - 40ms/step
Epoch 17/50
2058/2058 - 81s - loss: 2.8182 - accuracy50: 0.5363 - val_loss: 3.4619 - val_accuracy50: 0.4051 - 81s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h50
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0292532
{'0': {'precision': 0.45179744452030685, 'recall': 0.46601767627612783, 'f1-score': 0.45879739932840746, 'support': 457223}, '1': {'precision': 0.49738269255904743, 'recall': 0.4733906524674011, 'f1-score': 0.4850901985779292, 'support': 490354}, '2': {'precision': 0.4425446697064958, 'recall': 0.45146249978243086, 'f1-score': 0.44695910652550863, 'support': 459624}, 'accuracy': 0.46383281421772726, 'macro avg': {'precision': 0.4639082689286167, 'recall': 0.4636236095086532, 'f1-score': 0.4636155681439484, 'support': 1407201}, 'weighted avg': {'precision': 0.46465993633616365, 'recall': 0.46383281421772726, 'f1-score': 0.46409274504800296, 'support': 1407201}}
[[213074 125605 118544]
 [115386 232129 142839]
 [143154 108967 207503]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0645566
{'0': {'precision': 0.4584488950370365, 'recall': 0.39844120155406043, 'f1-score': 0.4263438901123275, 'support': 168848}, '1': {'precision': 0.5086486018526535, 'recall': 0.3136524273710509, 'f1-score': 0.3880303270460189, 'support': 187322}, '2': {'precision': 0.3958845963404355, 'recall': 0.6137447701196573, 'f1-score': 0.4813094956355507, 'support': 170654}, 'accuracy': 0.438036232214174, 'macro avg': {'precision': 0.45432736441004185, 'recall': 0.44194613301492297, 'f1-score': 0.43189457093129907, 'support': 526824}, 'weighted avg': {'precision': 0.45603188603658334, 'recall': 0.438036232214174, 'f1-score': 0.4305257937162883, 'support': 526824}}
[[ 67276  33782  67790]
 [ 36529  58754  92039]
 [ 42942  22974 104738]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0613793
{'0': {'precision': 0.4673585205175014, 'recall': 0.3998743654606883, 'f1-score': 0.430990786572367, 'support': 58901}, '1': {'precision': 0.5089133415833306, 'recall': 0.2659674882013634, 'f1-score': 0.349355405296812, 'support': 57210}, '2': {'precision': 0.3881536955874218, 'recall': 0.6270708737196673, 'f1-score': 0.4794995794785534, 'support': 58188}, 'accuracy': 0.43176954543629054, 'macro avg': {'precision': 0.45480851922941795, 'recall': 0.4309709091272396, 'f1-score': 0.4199485904492441, 'support': 174299}, 'weighted avg': {'precision': 0.4545562724274068, 'recall': 0.43176954543629054, 'f1-score': 0.42038986217722224, 'support': 174299}}
[[23553  9360 25988]
 [10466 15216 31528]
 [16377  5323 36488]]
training model: results/ATVI/W2/deepLOB_L2/h100
Epoch 1/50
2058/2058 - 86s - loss: 3.2487 - accuracy100: 0.3972 - val_loss: 3.4986 - val_accuracy100: 0.3574 - 86s/epoch - 42ms/step
Epoch 2/50
2058/2058 - 82s - loss: 3.1874 - accuracy100: 0.4237 - val_loss: 3.4684 - val_accuracy100: 0.3663 - 82s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 82s - loss: 3.1708 - accuracy100: 0.4319 - val_loss: 3.3655 - val_accuracy100: 0.3666 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 82s - loss: 3.1591 - accuracy100: 0.4367 - val_loss: 3.3836 - val_accuracy100: 0.3600 - 82s/epoch - 40ms/step
Epoch 5/50
2058/2058 - 82s - loss: 3.1504 - accuracy100: 0.4407 - val_loss: 3.4330 - val_accuracy100: 0.3507 - 82s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 81s - loss: 3.1431 - accuracy100: 0.4436 - val_loss: 3.4494 - val_accuracy100: 0.3485 - 81s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 81s - loss: 3.1363 - accuracy100: 0.4462 - val_loss: 3.4314 - val_accuracy100: 0.3521 - 81s/epoch - 39ms/step
Epoch 8/50
2058/2058 - 81s - loss: 3.1306 - accuracy100: 0.4489 - val_loss: 3.4576 - val_accuracy100: 0.3529 - 81s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 81s - loss: 3.1257 - accuracy100: 0.4503 - val_loss: 3.4593 - val_accuracy100: 0.3508 - 81s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 81s - loss: 3.1197 - accuracy100: 0.4536 - val_loss: 3.4912 - val_accuracy100: 0.3547 - 81s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 81s - loss: 3.1124 - accuracy100: 0.4570 - val_loss: 3.6093 - val_accuracy100: 0.3511 - 81s/epoch - 39ms/step
Epoch 12/50
2058/2058 - 82s - loss: 3.1058 - accuracy100: 0.4591 - val_loss: 3.5432 - val_accuracy100: 0.3555 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 82s - loss: 3.0996 - accuracy100: 0.4612 - val_loss: 3.5691 - val_accuracy100: 0.3539 - 82s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h100
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0878528
{'0': {'precision': 0.3860477056369665, 'recall': 0.38408557843341745, 'f1-score': 0.38506414250475834, 'support': 469838}, '1': {'precision': 0.3801665309220879, 'recall': 0.21567800602033996, 'f1-score': 0.2752179612678677, 'support': 445822}, '2': {'precision': 0.40800786226476904, 'recall': 0.5701050370162407, 'f1-score': 0.47562472101197756, 'support': 491541}, 'accuracy': 0.39570892857523554, 'macro avg': {'precision': 0.3914073662746078, 'recall': 0.38995620715666607, 'f1-score': 0.37863560826153453, 'support': 1407201}, 'weighted avg': {'precision': 0.3918552343945854, 'recall': 0.39570892857523554, 'f1-score': 0.3818964309330809, 'support': 1407201}}
[[180458  72671 216709]
 [159782  96154 189886]
 [127210  84101 280230]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1152042
{'0': {'precision': 0.4311376176276271, 'recall': 0.1368810730523714, 'f1-score': 0.20779097836891186, 'support': 176394}, '1': {'precision': 0.3875422817327327, 'recall': 0.1422294939417169, 'f1-score': 0.2080893892155427, 'support': 174802}, '2': {'precision': 0.3572324353034908, 'recall': 0.8271744824287699, 'f1-score': 0.4989730308983747, 'support': 175628}, 'accuracy': 0.36877970631558166, 'macro avg': {'precision': 0.39197077822128357, 'recall': 0.36876168314095276, 'f1-score': 0.30495113282760977, 'support': 526824}, 'weighted avg': {'precision': 0.3920346700278163, 'recall': 0.36877970631558166, 'f1-score': 0.30496173052609765, 'support': 526824}}
[[ 24145  22137 130112]
 [ 18659  24862 131281]
 [ 13199  17154 145275]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1223652
{'0': {'precision': 0.48139188686267215, 'recall': 0.043333333333333335, 'f1-score': 0.07950948151335402, 'support': 59700}, '1': {'precision': 0.3817761446678502, 'recall': 0.1665855987317372, 'f1-score': 0.23195785776997366, 'support': 55509}, '2': {'precision': 0.3596514263600177, 'recall': 0.8807412421729565, 'f1-score': 0.5107412387018263, 'support': 59090}, 'accuracy': 0.3664794405016667, 'macro avg': {'precision': 0.40760648596351334, 'recall': 0.3635533914126757, 'f1-score': 0.27406952599505136, 'support': 174299}, 'weighted avg': {'precision': 0.40839540355184295, 'recall': 0.3664794405016667, 'f1-score': 0.27425380850258246, 'support': 174299}}
[[ 2587  8955 48158]
 [ 1759  9247 44503]
 [ 1028  6019 52043]]
training model: results/ATVI/W2/deepLOB_L2/h200
Epoch 1/50
2058/2058 - 84s - loss: 3.2888 - accuracy200: 0.3731 - val_loss: 3.4925 - val_accuracy200: 0.3303 - 84s/epoch - 41ms/step
Epoch 2/50
2058/2058 - 81s - loss: 3.2528 - accuracy200: 0.3920 - val_loss: 3.4332 - val_accuracy200: 0.3456 - 81s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 81s - loss: 3.2357 - accuracy200: 0.4044 - val_loss: 3.3872 - val_accuracy200: 0.3357 - 81s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 81s - loss: 3.2259 - accuracy200: 0.4093 - val_loss: 3.3446 - val_accuracy200: 0.3371 - 81s/epoch - 39ms/step
Epoch 5/50
2058/2058 - 81s - loss: 3.2161 - accuracy200: 0.4151 - val_loss: 3.3763 - val_accuracy200: 0.3266 - 81s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 3.2098 - accuracy200: 0.4175 - val_loss: 3.3863 - val_accuracy200: 0.3285 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 82s - loss: 3.2021 - accuracy200: 0.4212 - val_loss: 3.4115 - val_accuracy200: 0.3303 - 82s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 82s - loss: 3.1955 - accuracy200: 0.4244 - val_loss: 3.4187 - val_accuracy200: 0.3327 - 82s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 82s - loss: 3.1883 - accuracy200: 0.4272 - val_loss: 3.3946 - val_accuracy200: 0.3382 - 82s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 82s - loss: 3.1835 - accuracy200: 0.4295 - val_loss: 3.4057 - val_accuracy200: 0.3339 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 82s - loss: 3.1785 - accuracy200: 0.4312 - val_loss: 3.4121 - val_accuracy200: 0.3441 - 82s/epoch - 40ms/step
Epoch 12/50
2058/2058 - 82s - loss: 3.1709 - accuracy200: 0.4348 - val_loss: 3.4218 - val_accuracy200: 0.3430 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 82s - loss: 3.1646 - accuracy200: 0.4381 - val_loss: 3.3950 - val_accuracy200: 0.3470 - 82s/epoch - 40ms/step
Epoch 14/50
2058/2058 - 82s - loss: 3.1567 - accuracy200: 0.4416 - val_loss: 3.3740 - val_accuracy200: 0.3525 - 82s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h200
Evaluating performance on  test set...
5497/5497 - 72s - 72s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.118312
{'0': {'precision': 0.3403501666812746, 'recall': 0.7113534911142929, 'f1-score': 0.4604134966641295, 'support': 474920}, '1': {'precision': 0.3315245637371059, 'recall': 0.08748927742016473, 'f1-score': 0.13844337193390327, 'support': 430167}, '2': {'precision': 0.4031760372275939, 'recall': 0.2417439067622094, 'f1-score': 0.3022556559480366, 'support': 502114}, 'accuracy': 0.35307962401959636, 'macro avg': {'precision': 0.3583502558819915, 'recall': 0.34686222509888903, 'f1-score': 0.3003708415153565, 'support': 1407201}, 'weighted avg': {'precision': 0.3600696424504151, 'recall': 0.35307962401959636, 'f1-score': 0.30555702009955377, 'support': 1407201}}
[[337836  35302 101782]
 [314630  37635  77902]
 [340147  40584 121383]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1133946
{'0': {'precision': 0.3374556351087477, 'recall': 0.15613564561220084, 'f1-score': 0.21349183225530757, 'support': 175988}, '1': {'precision': 0.3455250667710052, 'recall': 0.34596254953839867, 'f1-score': 0.345743669763813, 'support': 176126}, '2': {'precision': 0.3521639261395736, 'recall': 0.5423215614446798, 'f1-score': 0.42703004790899546, 'support': 174710}, 'accuracy': 0.34766829149772976, 'macro avg': {'precision': 0.34504820933977554, 'recall': 0.3481399188650931, 'f1-score': 0.328755183309372, 'support': 526824}, 'weighted avg': {'precision': 0.3450310725355588, 'recall': 0.34766829149772976, 'f1-score': 0.3285212325671363, 'support': 526824}}
[[27478 59512 88998]
 [29892 60933 85301]
 [24057 55904 94749]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1156405
{'0': {'precision': 0.39381270903010035, 'recall': 0.023974345922834164, 'f1-score': 0.04519719796564629, 'support': 58938}, '1': {'precision': 0.3262464520966101, 'recall': 0.31971170666853266, 'f1-score': 0.32294602546318796, 'support': 57164}, '2': {'precision': 0.3410961531754612, 'recall': 0.672216780933725, 'f1-score': 0.45255626442399455, 'support': 58197}, 'accuracy': 0.33740870572980913, 'macro avg': {'precision': 0.3537184381007239, 'recall': 0.3386342778416973, 'f1-score': 0.27356649595094296, 'support': 174299}, 'weighted avg': {'precision': 0.35405170688769866, 'recall': 0.33740870572980913, 'f1-score': 0.2723029734763834, 'support': 174299}}
[[ 1413 19652 37873]
 [ 1190 18276 37698]
 [  985 18091 39121]]
training model: results/ATVI/W2/deepLOB_L2/h300
Epoch 1/50
2058/2058 - 85s - loss: 3.2935 - accuracy300: 0.3661 - val_loss: 3.3428 - val_accuracy300: 0.3442 - 85s/epoch - 41ms/step
Epoch 2/50
2058/2058 - 81s - loss: 3.2680 - accuracy300: 0.3832 - val_loss: 3.3987 - val_accuracy300: 0.3385 - 81s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 81s - loss: 3.2544 - accuracy300: 0.3936 - val_loss: 3.4542 - val_accuracy300: 0.3375 - 81s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 81s - loss: 3.2459 - accuracy300: 0.3997 - val_loss: 3.4656 - val_accuracy300: 0.3381 - 81s/epoch - 39ms/step
Epoch 5/50
2058/2058 - 82s - loss: 3.2377 - accuracy300: 0.4045 - val_loss: 3.5042 - val_accuracy300: 0.3378 - 82s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 3.2301 - accuracy300: 0.4091 - val_loss: 3.5733 - val_accuracy300: 0.3381 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 81s - loss: 3.2223 - accuracy300: 0.4144 - val_loss: 3.6325 - val_accuracy300: 0.3379 - 81s/epoch - 39ms/step
Epoch 8/50
2058/2058 - 81s - loss: 3.2155 - accuracy300: 0.4177 - val_loss: 3.6291 - val_accuracy300: 0.3378 - 81s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 81s - loss: 3.2106 - accuracy300: 0.4203 - val_loss: 3.6346 - val_accuracy300: 0.3377 - 81s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 81s - loss: 3.2036 - accuracy300: 0.4243 - val_loss: 3.6405 - val_accuracy300: 0.3384 - 81s/epoch - 39ms/step
Epoch 11/50
2058/2058 - 81s - loss: 3.1969 - accuracy300: 0.4268 - val_loss: 3.6221 - val_accuracy300: 0.3386 - 81s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h300
Evaluating performance on  test set...
5497/5497 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1105133
{'0': {'precision': 0.3415262239262926, 'recall': 0.09850907635361258, 'f1-score': 0.15291242701717636, 'support': 484666}, '1': {'precision': 0.3014205729751223, 'recall': 0.5726721303884799, 'f1-score': 0.39495847752609753, 'support': 410343}, '2': {'precision': 0.3840382131655016, 'recall': 0.36574175309259027, 'f1-score': 0.374666744001392, 'support': 512192}, 'accuracy': 0.3340432532381657, 'macro avg': {'precision': 0.34232833668897217, 'recall': 0.3456409866115609, 'f1-score': 0.30751254951488866, 'support': 1407201}, 'weighted avg': {'precision': 0.34530480826794163, 'recall': 0.3340432532381657, 'f1-score': 0.3042075793292921, 'support': 1407201}}
[[ 47744 267647 169275]
 [ 44166 234992 131185]
 [ 47886 276976 187330]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1130272
{'0': {'precision': 0.31375126390293223, 'recall': 0.017317007835346118, 'f1-score': 0.03282243306994997, 'support': 179188}, '1': {'precision': 0.3489314719307606, 'recall': 0.2777227314012055, 'f1-score': 0.3092812621097778, 'support': 169554}, '2': {'precision': 0.3469509034457121, 'recall': 0.7442021091407329, 'f1-score': 0.4732637698548738, 'support': 178082}, 'accuracy': 0.34683499612773905, 'macro avg': {'precision': 0.3365445464264683, 'recall': 0.3464139494590948, 'f1-score': 0.27178915501153383, 'support': 526824}, 'weighted avg': {'precision': 0.33629618061327143, 'recall': 0.34683499612773905, 'f1-score': 0.2706805686832701, 'support': 526824}}
[[  3103  45355 130730]
 [  3742  47089 118723]
 [  3045  42508 132529]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1162846
{'0': {'precision': 0.25, 'recall': 6.718962592175769e-05, 'f1-score': 0.000134343145980621, 'support': 59533}, '1': {'precision': 0.3489157314057447, 'recall': 0.13116776315789475, 'f1-score': 0.1906605685775168, 'support': 55936}, '2': {'precision': 0.3414178982741183, 'recall': 0.889410164881863, 'f1-score': 0.49342480609189715, 'support': 58830}, 'accuracy': 0.3423140695012593, 'macro avg': {'precision': 0.313444543226621, 'recall': 0.34021503922189317, 'f1-score': 0.2280732392717982, 'support': 174299}, 'weighted avg': {'precision': 0.31259970113068986, 'recall': 0.3423140695012593, 'f1-score': 0.2277750805044662, 'support': 174299}}
[[    4  7191 52338]
 [    6  7337 48593]
 [    6  6500 52324]]
training model: results/ATVI/W2/deepLOB_L2/h500
Epoch 1/50
2058/2058 - 84s - loss: 3.2206 - accuracy500: 0.4128 - val_loss: 3.5105 - val_accuracy500: 0.3571 - 84s/epoch - 41ms/step
Epoch 2/50
2058/2058 - 82s - loss: 3.2019 - accuracy500: 0.4277 - val_loss: 3.4675 - val_accuracy500: 0.3781 - 82s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 83s - loss: 3.1760 - accuracy500: 0.4430 - val_loss: 3.4277 - val_accuracy500: 0.3755 - 83s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 81s - loss: 3.1597 - accuracy500: 0.4484 - val_loss: 3.5387 - val_accuracy500: 0.3495 - 81s/epoch - 39ms/step
Epoch 5/50
2058/2058 - 81s - loss: 3.1515 - accuracy500: 0.4528 - val_loss: 3.5653 - val_accuracy500: 0.3535 - 81s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 3.1318 - accuracy500: 0.4607 - val_loss: 3.5898 - val_accuracy500: 0.3514 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 82s - loss: 3.1236 - accuracy500: 0.4637 - val_loss: 3.5921 - val_accuracy500: 0.3521 - 82s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 81s - loss: 3.1125 - accuracy500: 0.4678 - val_loss: 3.5854 - val_accuracy500: 0.3496 - 81s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 81s - loss: 3.0973 - accuracy500: 0.4727 - val_loss: 3.6300 - val_accuracy500: 0.3519 - 81s/epoch - 39ms/step
Epoch 10/50
2058/2058 - 82s - loss: 3.0864 - accuracy500: 0.4763 - val_loss: 3.6641 - val_accuracy500: 0.3528 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 81s - loss: 3.0782 - accuracy500: 0.4794 - val_loss: 3.5896 - val_accuracy500: 0.3500 - 81s/epoch - 39ms/step
Epoch 12/50
2058/2058 - 82s - loss: 3.0687 - accuracy500: 0.4831 - val_loss: 3.5742 - val_accuracy500: 0.3502 - 82s/epoch - 40ms/step
Epoch 13/50
2058/2058 - 81s - loss: 3.0578 - accuracy500: 0.4854 - val_loss: 3.5492 - val_accuracy500: 0.3495 - 81s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h500
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1898868
{'0': {'precision': 0.32165986285031534, 'recall': 0.3272955372905579, 'f1-score': 0.32445322933917403, 'support': 463911}, '1': {'precision': 0.2932665382933509, 'recall': 0.6091716427594152, 'f1-score': 0.3959266410694602, 'support': 439267}, '2': {'precision': 0.3730798010475813, 'recall': 0.016816692889014984, 'f1-score': 0.03218273841842875, 'support': 504023}, 'accuracy': 0.3040795167143855, 'macro avg': {'precision': 0.32933540073041584, 'recall': 0.3177612909796627, 'f1-score': 0.25085420294235433, 'support': 1407201}, 'weighted avg': {'precision': 0.33121399265255147, 'recall': 0.3040795167143855, 'f1-score': 0.2420803924133765, 'support': 1407201}}
[[151836 302397   9678]
 [167113 267589   4565]
 [153090 342457   8476]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1512203
{'0': {'precision': 0.2761935191841734, 'recall': 0.0588679288114047, 'f1-score': 0.09705049938016047, 'support': 176208}, '1': {'precision': 0.35099294858842245, 'recall': 0.7551610745736261, 'f1-score': 0.47923925000265283, 'support': 179420}, '2': {'precision': 0.3698290474114969, 'recall': 0.2230367531951681, 'f1-score': 0.27826017249609203, 'support': 171196}, 'accuracy': 0.34935196574187966, 'macro avg': {'precision': 0.33233850506136425, 'recall': 0.3456885855267329, 'f1-score': 0.2848499739596351, 'support': 526824}, 'weighted avg': {'precision': 0.33209556904164994, 'recall': 0.34935196574187966, 'f1-score': 0.28609784125418786, 'support': 526824}}
[[ 10373 127050  38785]
 [ 17652 135491  26277]
 [  9532 123481  38183]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1411828
{'0': {'precision': 0.3969465648854962, 'recall': 0.000907948037435396, 'f1-score': 0.0018117519990244414, 'support': 57272}, '1': {'precision': 0.37438065489013356, 'recall': 0.9147613251307695, 'f1-score': 0.5313129962070909, 'support': 60794}, '2': {'precision': 0.39174211676553233, 'recall': 0.17850728220084291, 'f1-score': 0.24525697252525744, 'support': 56233}, 'accuracy': 0.3769499538149961, 'macro avg': {'precision': 0.3876897788470541, 'recall': 0.3647255184563493, 'f1-score': 0.25946057357712426, 'support': 174299}, 'weighted avg': {'precision': 0.38739668988111864, 'recall': 0.3769499538149961, 'f1-score': 0.2650384700308941, 'support': 174299}}
[[   52 46782 10438]
 [   34 55612  5148]
 [   45 46150 10038]]
training model: results/ATVI/W2/deepLOB_L2/h1000
Epoch 1/50
2058/2058 - 84s - loss: 3.2615 - accuracy1000: 0.4006 - val_loss: 3.3843 - val_accuracy1000: 0.3283 - 84s/epoch - 41ms/step
Epoch 2/50
2058/2058 - 82s - loss: 3.2040 - accuracy1000: 0.4241 - val_loss: 3.4003 - val_accuracy1000: 0.3169 - 82s/epoch - 40ms/step
Epoch 3/50
2058/2058 - 82s - loss: 3.1872 - accuracy1000: 0.4298 - val_loss: 3.5118 - val_accuracy1000: 0.3148 - 82s/epoch - 40ms/step
Epoch 4/50
2058/2058 - 83s - loss: 3.1688 - accuracy1000: 0.4378 - val_loss: 3.5584 - val_accuracy1000: 0.3175 - 83s/epoch - 40ms/step
Epoch 5/50
2058/2058 - 82s - loss: 3.1540 - accuracy1000: 0.4449 - val_loss: 3.6212 - val_accuracy1000: 0.3142 - 82s/epoch - 40ms/step
Epoch 6/50
2058/2058 - 82s - loss: 3.1408 - accuracy1000: 0.4492 - val_loss: 3.5133 - val_accuracy1000: 0.3214 - 82s/epoch - 40ms/step
Epoch 7/50
2058/2058 - 82s - loss: 3.1316 - accuracy1000: 0.4521 - val_loss: 3.5682 - val_accuracy1000: 0.3187 - 82s/epoch - 40ms/step
Epoch 8/50
2058/2058 - 82s - loss: 3.1197 - accuracy1000: 0.4572 - val_loss: 3.5951 - val_accuracy1000: 0.3172 - 82s/epoch - 40ms/step
Epoch 9/50
2058/2058 - 82s - loss: 3.1125 - accuracy1000: 0.4588 - val_loss: 3.5300 - val_accuracy1000: 0.3162 - 82s/epoch - 40ms/step
Epoch 10/50
2058/2058 - 82s - loss: 3.1021 - accuracy1000: 0.4635 - val_loss: 3.5117 - val_accuracy1000: 0.3153 - 82s/epoch - 40ms/step
Epoch 11/50
2058/2058 - 81s - loss: 3.0945 - accuracy1000: 0.4662 - val_loss: 3.4730 - val_accuracy1000: 0.3170 - 81s/epoch - 40ms/step
testing model: results/ATVI/W2/deepLOB_L2/h1000
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1339732
{'0': {'precision': 0.32860480326230873, 'recall': 0.4989452870404622, 'f1-score': 0.396243852324641, 'support': 454152}, '1': {'precision': 0.29687789853170227, 'recall': 0.37926293244143566, 'f1-score': 0.33305127339265095, 'support': 447286}, '2': {'precision': 0.3601608557085995, 'recall': 0.10412386829404287, 'f1-score': 0.16154458488820994, 'support': 505763}, 'accuracy': 0.31900062606550167, 'macro avg': {'precision': 0.3285478525008702, 'recall': 0.3274440292586469, 'f1-score': 0.29694657020183396, 'support': 1407201}, 'weighted avg': {'precision': 0.32986182585116375, 'recall': 0.31900062606550167, 'f1-score': 0.2918043575711368, 'support': 1407201}}
[[226597 183377  44178]
 [228269 169639  49378]
 [234707 218394  52662]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1317424
{'0': {'precision': 0.33999040027105115, 'recall': 0.19891306741845252, 'f1-score': 0.2509857051048234, 'support': 181612}, '1': {'precision': 0.3297846609676273, 'recall': 0.5027278645458264, 'f1-score': 0.39829295845362117, 'support': 173579}, '2': {'precision': 0.3337864264418299, 'recall': 0.3033157959133733, 'f1-score': 0.31782245312852947, 'support': 171633}, 'accuracy': 0.3330277284254324, 'macro avg': {'precision': 0.3345204958935028, 'recall': 0.33498557595921746, 'f1-score': 0.32236703889565804, 'support': 526824}, 'weighted avg': {'precision': 0.33460661239734046, 'recall': 0.3330277284254324, 'f1-score': 0.3212954049335778, 'support': 526824}}
[[36125 90794 54693]
 [37103 87263 49213]
 [33025 86549 52059]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1329436
{'0': {'precision': 0.37524600918434287, 'recall': 0.08666812572602232, 'f1-score': 0.14081347958095133, 'support': 59399}, '1': {'precision': 0.3168945612977071, 'recall': 0.45604775146566534, 'f1-score': 0.3739452472587321, 'support': 56459}, '2': {'precision': 0.32943816258871284, 'recall': 0.4471860508889307, 'f1-score': 0.37938593307686724, 'support': 58441}, 'accuracy': 0.32719636945708236, 'macro avg': {'precision': 0.34052624435692097, 'recall': 0.32996730936020613, 'f1-score': 0.2980482199721836, 'support': 174299}, 'weighted avg': {'precision': 0.3409857967957074, 'recall': 0.32719636945708236, 'f1-score': 0.2963209651435458, 'support': 174299}}
[[ 5148 28120 26131]
 [ 3647 25748 27064]
 [ 4924 27383 26134]]
training model: results/ATVI/W2/deepOF_L2/h10
Epoch 1/50
2058/2058 - 47s - loss: 2.8500 - accuracy10: 0.5166 - val_loss: 3.1066 - val_accuracy10: 0.6082 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 2.6227 - accuracy10: 0.5829 - val_loss: 2.9552 - val_accuracy10: 0.6034 - 44s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 2.5695 - accuracy10: 0.5917 - val_loss: 2.9042 - val_accuracy10: 0.6039 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 44s - loss: 2.5444 - accuracy10: 0.5953 - val_loss: 2.8965 - val_accuracy10: 0.5998 - 44s/epoch - 21ms/step
Epoch 5/50
2058/2058 - 44s - loss: 2.5293 - accuracy10: 0.5977 - val_loss: 2.8933 - val_accuracy10: 0.6009 - 44s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 44s - loss: 2.5155 - accuracy10: 0.5988 - val_loss: 2.8671 - val_accuracy10: 0.6051 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 44s - loss: 2.5049 - accuracy10: 0.5999 - val_loss: 2.8601 - val_accuracy10: 0.6073 - 44s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 44s - loss: 2.4968 - accuracy10: 0.6014 - val_loss: 2.8517 - val_accuracy10: 0.6052 - 44s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 2.4868 - accuracy10: 0.6023 - val_loss: 2.8458 - val_accuracy10: 0.6014 - 44s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 44s - loss: 2.4796 - accuracy10: 0.6038 - val_loss: 2.8345 - val_accuracy10: 0.6017 - 44s/epoch - 21ms/step
Epoch 11/50
2058/2058 - 45s - loss: 2.4731 - accuracy10: 0.6039 - val_loss: 2.8427 - val_accuracy10: 0.6011 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 46s - loss: 2.4655 - accuracy10: 0.6040 - val_loss: 2.8294 - val_accuracy10: 0.6051 - 46s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 45s - loss: 2.4603 - accuracy10: 0.6048 - val_loss: 2.8367 - val_accuracy10: 0.6056 - 45s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 44s - loss: 2.4539 - accuracy10: 0.6060 - val_loss: 2.8208 - val_accuracy10: 0.5959 - 44s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 45s - loss: 2.4481 - accuracy10: 0.6063 - val_loss: 2.8163 - val_accuracy10: 0.6040 - 45s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 44s - loss: 2.4431 - accuracy10: 0.6066 - val_loss: 2.8158 - val_accuracy10: 0.6041 - 44s/epoch - 21ms/step
Epoch 17/50
2058/2058 - 45s - loss: 2.4383 - accuracy10: 0.6081 - val_loss: 2.8057 - val_accuracy10: 0.6002 - 45s/epoch - 22ms/step
Epoch 18/50
2058/2058 - 44s - loss: 2.4335 - accuracy10: 0.6073 - val_loss: 2.8141 - val_accuracy10: 0.5981 - 44s/epoch - 22ms/step
Epoch 19/50
2058/2058 - 44s - loss: 2.4290 - accuracy10: 0.6085 - val_loss: 2.8135 - val_accuracy10: 0.5981 - 44s/epoch - 22ms/step
Epoch 20/50
2058/2058 - 44s - loss: 2.4250 - accuracy10: 0.6085 - val_loss: 2.8167 - val_accuracy10: 0.5973 - 44s/epoch - 21ms/step
Epoch 21/50
2058/2058 - 44s - loss: 2.4198 - accuracy10: 0.6100 - val_loss: 2.8175 - val_accuracy10: 0.6002 - 44s/epoch - 22ms/step
Epoch 22/50
2058/2058 - 44s - loss: 2.4157 - accuracy10: 0.6098 - val_loss: 2.8007 - val_accuracy10: 0.5964 - 44s/epoch - 22ms/step
Epoch 23/50
2058/2058 - 44s - loss: 2.4121 - accuracy10: 0.6104 - val_loss: 2.8063 - val_accuracy10: 0.5958 - 44s/epoch - 22ms/step
Epoch 24/50
2058/2058 - 44s - loss: 2.4085 - accuracy10: 0.6106 - val_loss: 2.8003 - val_accuracy10: 0.5965 - 44s/epoch - 22ms/step
Epoch 25/50
2058/2058 - 45s - loss: 2.4052 - accuracy10: 0.6115 - val_loss: 2.7981 - val_accuracy10: 0.5944 - 45s/epoch - 22ms/step
Epoch 26/50
2058/2058 - 44s - loss: 2.4011 - accuracy10: 0.6118 - val_loss: 2.7979 - val_accuracy10: 0.5953 - 44s/epoch - 22ms/step
Epoch 27/50
2058/2058 - 45s - loss: 2.3971 - accuracy10: 0.6122 - val_loss: 2.7955 - val_accuracy10: 0.5994 - 45s/epoch - 22ms/step
Epoch 28/50
2058/2058 - 44s - loss: 2.3926 - accuracy10: 0.6128 - val_loss: 2.8108 - val_accuracy10: 0.5920 - 44s/epoch - 22ms/step
Epoch 29/50
2058/2058 - 45s - loss: 2.3901 - accuracy10: 0.6131 - val_loss: 2.7995 - val_accuracy10: 0.5956 - 45s/epoch - 22ms/step
Epoch 30/50
2058/2058 - 45s - loss: 2.3861 - accuracy10: 0.6130 - val_loss: 2.7991 - val_accuracy10: 0.5926 - 45s/epoch - 22ms/step
Epoch 31/50
2058/2058 - 44s - loss: 2.3822 - accuracy10: 0.6129 - val_loss: 2.8033 - val_accuracy10: 0.5904 - 44s/epoch - 22ms/step
Epoch 32/50
2058/2058 - 45s - loss: 2.3786 - accuracy10: 0.6144 - val_loss: 2.8066 - val_accuracy10: 0.5935 - 45s/epoch - 22ms/step
Epoch 33/50
2058/2058 - 45s - loss: 2.3770 - accuracy10: 0.6143 - val_loss: 2.8008 - val_accuracy10: 0.5973 - 45s/epoch - 22ms/step
Epoch 34/50
2058/2058 - 44s - loss: 2.3738 - accuracy10: 0.6148 - val_loss: 2.7866 - val_accuracy10: 0.5953 - 44s/epoch - 22ms/step
Epoch 35/50
2058/2058 - 45s - loss: 2.3689 - accuracy10: 0.6148 - val_loss: 2.8197 - val_accuracy10: 0.5966 - 45s/epoch - 22ms/step
Epoch 36/50
2058/2058 - 44s - loss: 2.3661 - accuracy10: 0.6151 - val_loss: 2.8183 - val_accuracy10: 0.5940 - 44s/epoch - 22ms/step
Epoch 37/50
2058/2058 - 44s - loss: 2.3624 - accuracy10: 0.6159 - val_loss: 2.7952 - val_accuracy10: 0.5941 - 44s/epoch - 22ms/step
Epoch 38/50
2058/2058 - 44s - loss: 2.3595 - accuracy10: 0.6156 - val_loss: 2.8137 - val_accuracy10: 0.5953 - 44s/epoch - 21ms/step
Epoch 39/50
2058/2058 - 44s - loss: 2.3581 - accuracy10: 0.6156 - val_loss: 2.8032 - val_accuracy10: 0.5971 - 44s/epoch - 22ms/step
Epoch 40/50
2058/2058 - 45s - loss: 2.3541 - accuracy10: 0.6168 - val_loss: 2.8267 - val_accuracy10: 0.5925 - 45s/epoch - 22ms/step
Epoch 41/50
2058/2058 - 44s - loss: 2.3505 - accuracy10: 0.6161 - val_loss: 2.8328 - val_accuracy10: 0.5948 - 44s/epoch - 22ms/step
Epoch 42/50
2058/2058 - 44s - loss: 2.3466 - accuracy10: 0.6173 - val_loss: 2.8303 - val_accuracy10: 0.5897 - 44s/epoch - 22ms/step
Epoch 43/50
2058/2058 - 44s - loss: 2.3433 - accuracy10: 0.6171 - val_loss: 2.8279 - val_accuracy10: 0.5932 - 44s/epoch - 22ms/step
Epoch 44/50
2058/2058 - 44s - loss: 2.3426 - accuracy10: 0.6178 - val_loss: 2.8236 - val_accuracy10: 0.5903 - 44s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h10
Evaluating performance on  test set...
5497/5497 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8422016
{'0': {'precision': 0.42787949428646316, 'recall': 0.5622313822478703, 'f1-score': 0.4859400804690704, 'support': 272925}, '1': {'precision': 0.8160276771201479, 'recall': 0.6300066544323355, 'f1-score': 0.711052089938565, 'support': 868594}, '2': {'precision': 0.4001703775821199, 'recall': 0.5693304275492421, 'f1-score': 0.4699927446279952, 'support': 265677}, 'accuracy': 0.6054060699433483, 'macro avg': {'precision': 0.5480258496629103, 'recall': 0.5871894880764826, 'f1-score': 0.5556616383452102, 'support': 1407196}, 'weighted avg': {'precision': 0.6622331363672975, 'recall': 0.6054060699433483, 'f1-score': 0.6218799924705947, 'support': 1407196}}
[[153447  71673  47805]
 [142453 547220 178921]
 [ 62722  51697 151258]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8026754
{'0': {'precision': 0.4546933895687694, 'recall': 0.5722615228680996, 'f1-score': 0.506747722614702, 'support': 95701}, '1': {'precision': 0.8275070614792995, 'recall': 0.6550931399988625, 'f1-score': 0.7312749569779293, 'support': 334067}, '2': {'precision': 0.4166437656343586, 'recall': 0.6092152983844379, 'f1-score': 0.4948550242498044, 'support': 97056}, 'accuracy': 0.6315942326089927, 'macro avg': {'precision': 0.5662814055608092, 'recall': 0.6121899870838, 'f1-score': 0.5776259012808119, 'support': 526824}, 'weighted avg': {'precision': 0.6840903051108801, 'recall': 0.6315942326089927, 'f1-score': 0.6469328354218573, 'support': 526824}}
[[ 54766  24898  16037]
 [ 48472 218845  66750]
 [ 17208  20720  59128]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8618752
{'0': {'precision': 0.4374179666487359, 'recall': 0.5728738093896184, 'f1-score': 0.49606520174229213, 'support': 35486}, '1': {'precision': 0.8091707292171827, 'recall': 0.612088272772908, 'f1-score': 0.6969650335813923, 'support': 103588}, '2': {'precision': 0.4020943678486233, 'recall': 0.5646557842441448, 'f1-score': 0.46970752500265667, 'support': 35225}, 'accuracy': 0.5945186145646274, 'macro avg': {'precision': 0.5495610212381806, 'recall': 0.5832059554688903, 'f1-score': 0.5542459201087803, 'support': 174299}, 'weighted avg': {'precision': 0.6512163900545289, 'recall': 0.5945186145646274, 'f1-score': 0.6101356359811292, 'support': 174299}}
[[20329  8175  6982]
 [17589 63405 22594]
 [ 8557  6778 19890]]
training model: results/ATVI/W2/deepOF_L2/h20
Epoch 1/50
2058/2058 - 47s - loss: 2.9314 - accuracy20: 0.5065 - val_loss: 3.1183 - val_accuracy20: 0.5640 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 2.7325 - accuracy20: 0.5647 - val_loss: 2.9875 - val_accuracy20: 0.5701 - 44s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 2.6847 - accuracy20: 0.5765 - val_loss: 2.9464 - val_accuracy20: 0.5729 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 45s - loss: 2.6607 - accuracy20: 0.5803 - val_loss: 2.9285 - val_accuracy20: 0.5754 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 44s - loss: 2.6452 - accuracy20: 0.5834 - val_loss: 2.9270 - val_accuracy20: 0.5765 - 44s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 44s - loss: 2.6348 - accuracy20: 0.5843 - val_loss: 2.9283 - val_accuracy20: 0.5740 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 44s - loss: 2.6244 - accuracy20: 0.5857 - val_loss: 2.9212 - val_accuracy20: 0.5790 - 44s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 44s - loss: 2.6170 - accuracy20: 0.5877 - val_loss: 2.9021 - val_accuracy20: 0.5795 - 44s/epoch - 21ms/step
Epoch 9/50
2058/2058 - 44s - loss: 2.6086 - accuracy20: 0.5884 - val_loss: 2.9166 - val_accuracy20: 0.5765 - 44s/epoch - 21ms/step
Epoch 10/50
2058/2058 - 44s - loss: 2.6025 - accuracy20: 0.5896 - val_loss: 2.9083 - val_accuracy20: 0.5783 - 44s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 44s - loss: 2.5967 - accuracy20: 0.5905 - val_loss: 2.9113 - val_accuracy20: 0.5808 - 44s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 44s - loss: 2.5899 - accuracy20: 0.5913 - val_loss: 2.8996 - val_accuracy20: 0.5778 - 44s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 45s - loss: 2.5848 - accuracy20: 0.5919 - val_loss: 2.8927 - val_accuracy20: 0.5814 - 45s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 44s - loss: 2.5798 - accuracy20: 0.5930 - val_loss: 2.8872 - val_accuracy20: 0.5785 - 44s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 45s - loss: 2.5753 - accuracy20: 0.5930 - val_loss: 2.8885 - val_accuracy20: 0.5776 - 45s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 45s - loss: 2.5690 - accuracy20: 0.5944 - val_loss: 2.8925 - val_accuracy20: 0.5790 - 45s/epoch - 22ms/step
Epoch 17/50
2058/2058 - 44s - loss: 2.5652 - accuracy20: 0.5946 - val_loss: 2.8783 - val_accuracy20: 0.5783 - 44s/epoch - 22ms/step
Epoch 18/50
2058/2058 - 44s - loss: 2.5606 - accuracy20: 0.5957 - val_loss: 2.8777 - val_accuracy20: 0.5764 - 44s/epoch - 22ms/step
Epoch 19/50
2058/2058 - 44s - loss: 2.5546 - accuracy20: 0.5966 - val_loss: 2.8910 - val_accuracy20: 0.5758 - 44s/epoch - 21ms/step
Epoch 20/50
2058/2058 - 44s - loss: 2.5526 - accuracy20: 0.5966 - val_loss: 2.8877 - val_accuracy20: 0.5784 - 44s/epoch - 22ms/step
Epoch 21/50
2058/2058 - 44s - loss: 2.5476 - accuracy20: 0.5977 - val_loss: 2.8800 - val_accuracy20: 0.5776 - 44s/epoch - 21ms/step
Epoch 22/50
2058/2058 - 44s - loss: 2.5430 - accuracy20: 0.5972 - val_loss: 2.8734 - val_accuracy20: 0.5777 - 44s/epoch - 22ms/step
Epoch 23/50
2058/2058 - 44s - loss: 2.5414 - accuracy20: 0.5982 - val_loss: 2.8700 - val_accuracy20: 0.5766 - 44s/epoch - 22ms/step
Epoch 24/50
2058/2058 - 44s - loss: 2.5366 - accuracy20: 0.5984 - val_loss: 2.8719 - val_accuracy20: 0.5799 - 44s/epoch - 21ms/step
Epoch 25/50
2058/2058 - 44s - loss: 2.5335 - accuracy20: 0.5987 - val_loss: 2.8680 - val_accuracy20: 0.5756 - 44s/epoch - 21ms/step
Epoch 26/50
2058/2058 - 44s - loss: 2.5281 - accuracy20: 0.5996 - val_loss: 2.8810 - val_accuracy20: 0.5769 - 44s/epoch - 22ms/step
Epoch 27/50
2058/2058 - 44s - loss: 2.5257 - accuracy20: 0.5999 - val_loss: 2.8856 - val_accuracy20: 0.5766 - 44s/epoch - 22ms/step
Epoch 28/50
2058/2058 - 44s - loss: 2.5212 - accuracy20: 0.6005 - val_loss: 2.8960 - val_accuracy20: 0.5753 - 44s/epoch - 22ms/step
Epoch 29/50
2058/2058 - 44s - loss: 2.5177 - accuracy20: 0.6011 - val_loss: 2.8720 - val_accuracy20: 0.5741 - 44s/epoch - 21ms/step
Epoch 30/50
2058/2058 - 44s - loss: 2.5154 - accuracy20: 0.6009 - val_loss: 2.8906 - val_accuracy20: 0.5742 - 44s/epoch - 22ms/step
Epoch 31/50
2058/2058 - 45s - loss: 2.5098 - accuracy20: 0.6023 - val_loss: 2.8756 - val_accuracy20: 0.5753 - 45s/epoch - 22ms/step
Epoch 32/50
2058/2058 - 45s - loss: 2.5077 - accuracy20: 0.6023 - val_loss: 2.8779 - val_accuracy20: 0.5722 - 45s/epoch - 22ms/step
Epoch 33/50
2058/2058 - 44s - loss: 2.5037 - accuracy20: 0.6029 - val_loss: 2.8953 - val_accuracy20: 0.5775 - 44s/epoch - 22ms/step
Epoch 34/50
2058/2058 - 44s - loss: 2.5004 - accuracy20: 0.6033 - val_loss: 2.8977 - val_accuracy20: 0.5711 - 44s/epoch - 22ms/step
Epoch 35/50
2058/2058 - 44s - loss: 2.4977 - accuracy20: 0.6035 - val_loss: 2.9030 - val_accuracy20: 0.5742 - 44s/epoch - 21ms/step
testing model: results/ATVI/W2/deepOF_L2/h20
Evaluating performance on  test set...
5497/5497 - 40s - 40s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.88515675
{'0': {'precision': 0.4765298098392272, 'recall': 0.4809494844166377, 'f1-score': 0.47872944663404843, 'support': 345240}, '1': {'precision': 0.7055310312867616, 'recall': 0.659419575614124, 'f1-score': 0.6816964231255799, 'support': 720335}, '2': {'precision': 0.4680984077738406, 'recall': 0.5282198693874206, 'f1-score': 0.4963451649592433, 'support': 341621}, 'accuracy': 0.5837829271828515, 'macro avg': {'precision': 0.5500530829666098, 'recall': 0.5561963098060607, 'f1-score': 0.5522570115729573, 'support': 1407196}, 'weighted avg': {'precision': 0.59170726262223, 'recall': 0.5837829271828515, 'f1-score': 0.5869035150090287, 'support': 1407196}}
[[166043 109340  69857]
 [110142 475003 135190]
 [ 72257  88913 180451]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.84989125
{'0': {'precision': 0.5224904241002105, 'recall': 0.4871427767098056, 'f1-score': 0.5041978330273931, 'support': 124327}, '1': {'precision': 0.717134914442837, 'recall': 0.683966796465803, 'f1-score': 0.7001582629531571, 'support': 276838}, '2': {'precision': 0.47527132099622804, 'recall': 0.5555113441934123, 'f1-score': 0.5122682390756348, 'support': 125659}, 'accuracy': 0.6068781984116137, 'macro avg': {'precision': 0.5716322198464252, 'recall': 0.5755403057896736, 'f1-score': 0.572208111685395, 'support': 526824}, 'weighted avg': {'precision': 0.6135103589181548, 'recall': 0.6068781984116137, 'f1-score': 0.609097026407734, 'support': 526824}}
[[ 60565  39174  24588]
 [ 35009 189348  52481]
 [ 20342  35512  69805]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.89754295
{'0': {'precision': 0.5010883660615043, 'recall': 0.4809201022335815, 'f1-score': 0.49079712856802643, 'support': 44995}, '1': {'precision': 0.6928458272606298, 'recall': 0.6460300391146615, 'f1-score': 0.6686194413189179, 'support': 84623}, '2': {'precision': 0.4591840643554875, 'recall': 0.5365591638504063, 'f1-score': 0.49486536417211097, 'support': 44681}, 'accuracy': 0.5753446663492046, 'macro avg': {'precision': 0.5510394192258738, 'recall': 0.5545031017328831, 'f1-score': 0.5514273113530185, 'support': 174299}, 'weighted avg': {'precision': 0.5834454968225933, 'recall': 0.5753446663492046, 'f1-score': 0.5781735931888492, 'support': 174299}}
[[21639 12918 10438]
 [12156 54669 17798]
 [ 9389 11318 23974]]
training model: results/ATVI/W2/deepOF_L2/h30
Epoch 1/50
2058/2058 - 48s - loss: 2.9959 - accuracy30: 0.4914 - val_loss: 3.1098 - val_accuracy30: 0.5164 - 48s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 45s - loss: 2.8202 - accuracy30: 0.5433 - val_loss: 2.9949 - val_accuracy30: 0.5384 - 45s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 44s - loss: 2.7756 - accuracy30: 0.5546 - val_loss: 2.9548 - val_accuracy30: 0.5435 - 44s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 44s - loss: 2.7546 - accuracy30: 0.5594 - val_loss: 2.9239 - val_accuracy30: 0.5454 - 44s/epoch - 21ms/step
Epoch 5/50
2058/2058 - 44s - loss: 2.7410 - accuracy30: 0.5621 - val_loss: 2.9366 - val_accuracy30: 0.5462 - 44s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 2.7306 - accuracy30: 0.5640 - val_loss: 2.9228 - val_accuracy30: 0.5483 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 44s - loss: 2.7222 - accuracy30: 0.5656 - val_loss: 2.9251 - val_accuracy30: 0.5488 - 44s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 44s - loss: 2.7148 - accuracy30: 0.5668 - val_loss: 2.9212 - val_accuracy30: 0.5493 - 44s/epoch - 21ms/step
Epoch 9/50
2058/2058 - 45s - loss: 2.7076 - accuracy30: 0.5681 - val_loss: 2.9176 - val_accuracy30: 0.5489 - 45s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 45s - loss: 2.7020 - accuracy30: 0.5692 - val_loss: 2.9226 - val_accuracy30: 0.5470 - 45s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 45s - loss: 2.6972 - accuracy30: 0.5702 - val_loss: 2.9166 - val_accuracy30: 0.5492 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 45s - loss: 2.6910 - accuracy30: 0.5714 - val_loss: 2.9145 - val_accuracy30: 0.5485 - 45s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 44s - loss: 2.6866 - accuracy30: 0.5718 - val_loss: 2.9106 - val_accuracy30: 0.5481 - 44s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 45s - loss: 2.6808 - accuracy30: 0.5730 - val_loss: 2.9002 - val_accuracy30: 0.5488 - 45s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 45s - loss: 2.6770 - accuracy30: 0.5736 - val_loss: 2.8990 - val_accuracy30: 0.5481 - 45s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 44s - loss: 2.6720 - accuracy30: 0.5743 - val_loss: 2.8958 - val_accuracy30: 0.5482 - 44s/epoch - 22ms/step
Epoch 17/50
2058/2058 - 44s - loss: 2.6684 - accuracy30: 0.5753 - val_loss: 2.8946 - val_accuracy30: 0.5486 - 44s/epoch - 22ms/step
Epoch 18/50
2058/2058 - 44s - loss: 2.6650 - accuracy30: 0.5756 - val_loss: 2.8985 - val_accuracy30: 0.5486 - 44s/epoch - 22ms/step
Epoch 19/50
2058/2058 - 44s - loss: 2.6613 - accuracy30: 0.5767 - val_loss: 2.8896 - val_accuracy30: 0.5455 - 44s/epoch - 21ms/step
Epoch 20/50
2058/2058 - 44s - loss: 2.6564 - accuracy30: 0.5773 - val_loss: 2.8986 - val_accuracy30: 0.5479 - 44s/epoch - 21ms/step
Epoch 21/50
2058/2058 - 45s - loss: 2.6523 - accuracy30: 0.5779 - val_loss: 2.9074 - val_accuracy30: 0.5465 - 45s/epoch - 22ms/step
Epoch 22/50
2058/2058 - 44s - loss: 2.6485 - accuracy30: 0.5785 - val_loss: 2.8997 - val_accuracy30: 0.5484 - 44s/epoch - 21ms/step
Epoch 23/50
2058/2058 - 44s - loss: 2.6449 - accuracy30: 0.5792 - val_loss: 2.8986 - val_accuracy30: 0.5460 - 44s/epoch - 21ms/step
Epoch 24/50
2058/2058 - 45s - loss: 2.6408 - accuracy30: 0.5799 - val_loss: 2.8918 - val_accuracy30: 0.5461 - 45s/epoch - 22ms/step
Epoch 25/50
2058/2058 - 45s - loss: 2.6388 - accuracy30: 0.5809 - val_loss: 2.8976 - val_accuracy30: 0.5454 - 45s/epoch - 22ms/step
Epoch 26/50
2058/2058 - 45s - loss: 2.6348 - accuracy30: 0.5812 - val_loss: 2.9032 - val_accuracy30: 0.5453 - 45s/epoch - 22ms/step
Epoch 27/50
2058/2058 - 45s - loss: 2.6304 - accuracy30: 0.5817 - val_loss: 2.8859 - val_accuracy30: 0.5458 - 45s/epoch - 22ms/step
Epoch 28/50
2058/2058 - 45s - loss: 2.6264 - accuracy30: 0.5826 - val_loss: 2.8995 - val_accuracy30: 0.5465 - 45s/epoch - 22ms/step
Epoch 29/50
2058/2058 - 45s - loss: 2.6235 - accuracy30: 0.5832 - val_loss: 2.8902 - val_accuracy30: 0.5445 - 45s/epoch - 22ms/step
Epoch 30/50
2058/2058 - 45s - loss: 2.6196 - accuracy30: 0.5837 - val_loss: 2.9072 - val_accuracy30: 0.5456 - 45s/epoch - 22ms/step
Epoch 31/50
2058/2058 - 45s - loss: 2.6148 - accuracy30: 0.5840 - val_loss: 2.8987 - val_accuracy30: 0.5452 - 45s/epoch - 22ms/step
Epoch 32/50
2058/2058 - 44s - loss: 2.6132 - accuracy30: 0.5854 - val_loss: 2.8954 - val_accuracy30: 0.5452 - 44s/epoch - 22ms/step
Epoch 33/50
2058/2058 - 45s - loss: 2.6084 - accuracy30: 0.5862 - val_loss: 2.9029 - val_accuracy30: 0.5417 - 45s/epoch - 22ms/step
Epoch 34/50
2058/2058 - 45s - loss: 2.6047 - accuracy30: 0.5863 - val_loss: 2.8864 - val_accuracy30: 0.5397 - 45s/epoch - 22ms/step
Epoch 35/50
2058/2058 - 44s - loss: 2.6012 - accuracy30: 0.5869 - val_loss: 2.8979 - val_accuracy30: 0.5416 - 44s/epoch - 22ms/step
Epoch 36/50
2058/2058 - 44s - loss: 2.5982 - accuracy30: 0.5875 - val_loss: 2.8986 - val_accuracy30: 0.5422 - 44s/epoch - 22ms/step
Epoch 37/50
2058/2058 - 44s - loss: 2.5940 - accuracy30: 0.5891 - val_loss: 2.9107 - val_accuracy30: 0.5374 - 44s/epoch - 21ms/step
testing model: results/ATVI/W2/deepOF_L2/h30
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.92900723
{'0': {'precision': 0.48232724980488684, 'recall': 0.4902269364344081, 'f1-score': 0.4862450100492502, 'support': 393326}, '1': {'precision': 0.62907638090934, 'recall': 0.6323119597679117, 'f1-score': 0.630690020557701, 'support': 620798}, '2': {'precision': 0.49912762722428977, 'recall': 0.4868929865266414, 'f1-score': 0.49293440256326715, 'support': 393072}, 'accuracy': 0.5519778339335814, 'macro avg': {'precision': 0.5368437526461721, 'recall': 0.5364772942429871, 'f1-score': 0.5366231443900727, 'support': 1407196}, 'weighted avg': {'precision': 0.5517598839542036, 'recall': 0.5519778339335814, 'f1-score': 0.5518368583261746, 'support': 1407196}}
[[192819 120197  80310]
 [116517 392538 111743]
 [ 90432 111256 191384]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.89679855
{'0': {'precision': 0.5242735635405985, 'recall': 0.4945548171601545, 'f1-score': 0.5089807493984186, 'support': 143705}, '1': {'precision': 0.6392625142518634, 'recall': 0.6616884916801761, 'f1-score': 0.6502822118807591, 'support': 238106}, '2': {'precision': 0.5102205709708161, 'recall': 0.5094922524187486, 'f1-score': 0.5098561515980664, 'support': 145013}, 'accuracy': 0.5742050476060316, 'macro avg': {'precision': 0.5579188829210927, 'recall': 0.5552451870863597, 'f1-score': 0.556373037625748, 'support': 526824}, 'weighted avg': {'precision': 0.5723763312325308, 'recall': 0.5742050476060316, 'f1-score': 0.5730850246876948, 'support': 526824}}
[[ 71070  44715  27920]
 [ 37551 157552  43003]
 [ 26938  44192  73883]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.93233395
{'0': {'precision': 0.5057167097608274, 'recall': 0.4892897627330649, 'f1-score': 0.49736763683321744, 'support': 51166}, '1': {'precision': 0.6133190118152524, 'recall': 0.623819335923995, 'f1-score': 0.6185246126422597, 'support': 72311}, '2': {'precision': 0.49084806619053195, 'recall': 0.4949431348628547, 'f1-score': 0.4928870948779245, 'support': 50822}, 'accuracy': 0.5467501247855696, 'macro avg': {'precision': 0.5366279292555373, 'recall': 0.5360174111733049, 'f1-score': 0.5362597814511338, 'support': 174299}, 'weighted avg': {'precision': 0.5460220233904407, 'recall': 0.5467501247855696, 'f1-score': 0.5463253013893867, 'support': 174299}}
[[25035 14472 11659]
 [12769 45109 14433]
 [11700 13968 25154]]
training model: results/ATVI/W2/deepOF_L2/h50
Epoch 1/50
2058/2058 - 47s - loss: 3.0808 - accuracy50: 0.4640 - val_loss: 3.1355 - val_accuracy50: 0.4446 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 45s - loss: 2.9495 - accuracy50: 0.5031 - val_loss: 3.0512 - val_accuracy50: 0.4770 - 45s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 2.9120 - accuracy50: 0.5124 - val_loss: 3.0206 - val_accuracy50: 0.4862 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 44s - loss: 2.8916 - accuracy50: 0.5168 - val_loss: 3.0044 - val_accuracy50: 0.4902 - 44s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 44s - loss: 2.8790 - accuracy50: 0.5199 - val_loss: 2.9867 - val_accuracy50: 0.4942 - 44s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 2.8699 - accuracy50: 0.5223 - val_loss: 2.9843 - val_accuracy50: 0.4932 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 45s - loss: 2.8620 - accuracy50: 0.5242 - val_loss: 2.9834 - val_accuracy50: 0.4952 - 45s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 45s - loss: 2.8557 - accuracy50: 0.5263 - val_loss: 2.9782 - val_accuracy50: 0.4957 - 45s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 2.8492 - accuracy50: 0.5278 - val_loss: 3.0001 - val_accuracy50: 0.4935 - 44s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 44s - loss: 2.8442 - accuracy50: 0.5292 - val_loss: 2.9895 - val_accuracy50: 0.4939 - 44s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 44s - loss: 2.8394 - accuracy50: 0.5306 - val_loss: 2.9765 - val_accuracy50: 0.4968 - 44s/epoch - 21ms/step
Epoch 12/50
2058/2058 - 44s - loss: 2.8341 - accuracy50: 0.5317 - val_loss: 2.9863 - val_accuracy50: 0.4944 - 44s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 44s - loss: 2.8308 - accuracy50: 0.5328 - val_loss: 2.9766 - val_accuracy50: 0.4961 - 44s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 45s - loss: 2.8254 - accuracy50: 0.5340 - val_loss: 2.9780 - val_accuracy50: 0.4954 - 45s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 45s - loss: 2.8223 - accuracy50: 0.5354 - val_loss: 2.9784 - val_accuracy50: 0.4961 - 45s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 44s - loss: 2.8174 - accuracy50: 0.5370 - val_loss: 2.9866 - val_accuracy50: 0.4930 - 44s/epoch - 22ms/step
Epoch 17/50
2058/2058 - 45s - loss: 2.8133 - accuracy50: 0.5373 - val_loss: 2.9825 - val_accuracy50: 0.4946 - 45s/epoch - 22ms/step
Epoch 18/50
2058/2058 - 44s - loss: 2.8099 - accuracy50: 0.5382 - val_loss: 2.9920 - val_accuracy50: 0.4938 - 44s/epoch - 21ms/step
Epoch 19/50
2058/2058 - 44s - loss: 2.8056 - accuracy50: 0.5397 - val_loss: 2.9805 - val_accuracy50: 0.4953 - 44s/epoch - 21ms/step
Epoch 20/50
2058/2058 - 44s - loss: 2.8019 - accuracy50: 0.5404 - val_loss: 2.9932 - val_accuracy50: 0.4935 - 44s/epoch - 21ms/step
Epoch 21/50
2058/2058 - 44s - loss: 2.7966 - accuracy50: 0.5419 - val_loss: 2.9929 - val_accuracy50: 0.4918 - 44s/epoch - 21ms/step
testing model: results/ATVI/W2/deepOF_L2/h50
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.98179954
{'0': {'precision': 0.5174876484271369, 'recall': 0.3532449296948303, 'f1-score': 0.4198760735032047, 'support': 457221}, '1': {'precision': 0.4957657312799976, 'recall': 0.6867161275323542, 'f1-score': 0.5758233339660423, 'support': 490354}, '2': {'precision': 0.5105489696299325, 'recall': 0.4619501719895305, 'f1-score': 0.4850352545029018, 'support': 459621}, 'accuracy': 0.5049524017976174, 'macro avg': {'precision': 0.5079341164456891, 'recall': 0.5006370764055716, 'f1-score': 0.49357822065738294, 'support': 1407196}, 'weighted avg': {'precision': 0.5076520665691596, 'recall': 0.5049524017976174, 'f1-score': 0.4955001449809918, 'support': 1407196}}
[[161511 183026 112684]
 [ 62756 336734  90864]
 [ 87839 159460 212322]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.97212344
{'0': {'precision': 0.5552906923846783, 'recall': 0.36129001704868347, 'f1-score': 0.4377595593140103, 'support': 168928}, '1': {'precision': 0.4976384438667553, 'recall': 0.7031923243260559, 'f1-score': 0.5828223981024409, 'support': 187293}, '2': {'precision': 0.5150468284096731, 'recall': 0.4596636635932545, 'f1-score': 0.4857818070315089, 'support': 170603}, 'accuracy': 0.514697508086192, 'macro avg': {'precision': 0.5226586548870356, 'recall': 0.5080486683226647, 'f1-score': 0.5021212548159867, 'support': 526824}, 'weighted avg': {'precision': 0.5217622530816185, 'recall': 0.514697508086192, 'f1-score': 0.5048825335759078, 'support': 526824}}
[[ 61032  69519  38377]
 [ 20129 131703  35461]
 [ 28749  63434  78420]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9851288
{'0': {'precision': 0.5328177521672101, 'recall': 0.3578861595396133, 'f1-score': 0.4281739342364482, 'support': 58907}, '1': {'precision': 0.47876559686740616, 'recall': 0.6648424659929363, 'f1-score': 0.5566657151013418, 'support': 57194}, '2': {'precision': 0.49691731906199715, 'recall': 0.4722499054950342, 'f1-score': 0.48426969261807645, 'support': 58198}, 'accuracy': 0.49679573606274274, 'macro avg': {'precision': 0.5028335560322045, 'recall': 0.4983261770091946, 'f1-score': 0.4897031139852888, 'support': 174299}, 'weighted avg': {'precision': 0.5030941600865088, 'recall': 0.49679573606274274, 'f1-score': 0.4890671112545649, 'support': 174299}}
[[21082 22145 15680]
 [ 7024 38025 12145]
 [11461 19253 27484]]
training model: results/ATVI/W2/deepOF_L2/h100
Epoch 1/50
2058/2058 - 47s - loss: 3.2176 - accuracy100: 0.4131 - val_loss: 3.2332 - val_accuracy100: 0.3925 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 3.1626 - accuracy100: 0.4379 - val_loss: 3.2156 - val_accuracy100: 0.4026 - 44s/epoch - 21ms/step
Epoch 3/50
2058/2058 - 44s - loss: 3.1430 - accuracy100: 0.4447 - val_loss: 3.1986 - val_accuracy100: 0.4150 - 44s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 45s - loss: 3.1311 - accuracy100: 0.4480 - val_loss: 3.1882 - val_accuracy100: 0.4235 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 45s - loss: 3.1217 - accuracy100: 0.4512 - val_loss: 3.1832 - val_accuracy100: 0.4269 - 45s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.1148 - accuracy100: 0.4535 - val_loss: 3.1779 - val_accuracy100: 0.4307 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 44s - loss: 3.1095 - accuracy100: 0.4553 - val_loss: 3.1776 - val_accuracy100: 0.4318 - 44s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 44s - loss: 3.1050 - accuracy100: 0.4563 - val_loss: 3.1797 - val_accuracy100: 0.4311 - 44s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 3.1012 - accuracy100: 0.4581 - val_loss: 3.1779 - val_accuracy100: 0.4325 - 44s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 45s - loss: 3.0979 - accuracy100: 0.4588 - val_loss: 3.1810 - val_accuracy100: 0.4327 - 45s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 45s - loss: 3.0940 - accuracy100: 0.4610 - val_loss: 3.1773 - val_accuracy100: 0.4328 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 44s - loss: 3.0906 - accuracy100: 0.4622 - val_loss: 3.1844 - val_accuracy100: 0.4323 - 44s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 44s - loss: 3.0880 - accuracy100: 0.4628 - val_loss: 3.1872 - val_accuracy100: 0.4314 - 44s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 44s - loss: 3.0832 - accuracy100: 0.4643 - val_loss: 3.1834 - val_accuracy100: 0.4332 - 44s/epoch - 21ms/step
Epoch 15/50
2058/2058 - 44s - loss: 3.0813 - accuracy100: 0.4657 - val_loss: 3.1845 - val_accuracy100: 0.4328 - 44s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 45s - loss: 3.0771 - accuracy100: 0.4666 - val_loss: 3.1950 - val_accuracy100: 0.4301 - 45s/epoch - 22ms/step
Epoch 17/50
2058/2058 - 44s - loss: 3.0731 - accuracy100: 0.4686 - val_loss: 3.1871 - val_accuracy100: 0.4326 - 44s/epoch - 21ms/step
Epoch 18/50
2058/2058 - 45s - loss: 3.0701 - accuracy100: 0.4702 - val_loss: 3.2096 - val_accuracy100: 0.4289 - 45s/epoch - 22ms/step
Epoch 19/50
2058/2058 - 45s - loss: 3.0668 - accuracy100: 0.4716 - val_loss: 3.2060 - val_accuracy100: 0.4297 - 45s/epoch - 22ms/step
Epoch 20/50
2058/2058 - 45s - loss: 3.0633 - accuracy100: 0.4724 - val_loss: 3.2161 - val_accuracy100: 0.4283 - 45s/epoch - 22ms/step
Epoch 21/50
2058/2058 - 45s - loss: 3.0600 - accuracy100: 0.4740 - val_loss: 3.2188 - val_accuracy100: 0.4275 - 45s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h100
Evaluating performance on  test set...
5497/5497 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0584778
{'0': {'precision': 0.44975948247263076, 'recall': 0.3462633770081475, 'f1-score': 0.39128332908427094, 'support': 469836}, '1': {'precision': 0.3971681063957464, 'recall': 0.5106948513083697, 'f1-score': 0.4468333140348432, 'support': 445822}, '2': {'precision': 0.47251069416797253, 'recall': 0.45394048883300986, 'f1-score': 0.4630394767151089, 'support': 491538}, 'accuracy': 0.43596982936278955, 'macro avg': {'precision': 0.4398127610121166, 'recall': 0.43696623904984233, 'f1-score': 0.4337187066114077, 'support': 1407196}, 'weighted avg': {'precision': 0.4410447708254659, 'recall': 0.43596982936278955, 'f1-score': 0.4339470935384058, 'support': 1407196}}
[[162687 180426 126723]
 [ 95775 227679 122368]
 [103258 165151 223129]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0519165
{'0': {'precision': 0.4760975292376259, 'recall': 0.3319384433935518, 'f1-score': 0.391158508065055, 'support': 176358}, '1': {'precision': 0.409249519571154, 'recall': 0.5553045855086718, 'f1-score': 0.4712190506229301, 'support': 174877}, '2': {'precision': 0.46145349325841345, 'recall': 0.4377722978090883, 'f1-score': 0.4493010722834172, 'support': 175589}, 'accuracy': 0.44135802469135804, 'macro avg': {'precision': 0.4489335140223978, 'recall': 0.4416717755704373, 'f1-score': 0.43722621032380077, 'support': 526824}, 'weighted avg': {'precision': 0.4490267977979087, 'recall': 0.44135802469135804, 'f1-score': 0.4371130245818263, 'support': 526824}}
[[58540 74197 43621]
 [31678 97110 46089]
 [32740 65981 76868]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0593754
{'0': {'precision': 0.4574822062096472, 'recall': 0.3475924189659791, 'f1-score': 0.3950375324662969, 'support': 59728}, '1': {'precision': 0.40238754228521906, 'recall': 0.5191998989953646, 'f1-score': 0.4533906647451194, 'support': 55443}, '2': {'precision': 0.45149878006273964, 'recall': 0.43815112975240156, 'f1-score': 0.4447248257630378, 'support': 59128}, 'accuracy': 0.4328997871473732, 'macro avg': {'precision': 0.43712284285253533, 'recall': 0.43498114923791514, 'f1-score': 0.43105100765815135, 'support': 174299}, 'weighted avg': {'precision': 0.43792729497563887, 'recall': 0.4328997871473732, 'f1-score': 0.4304547350376511, 'support': 174299}}
[[20761 22477 16490]
 [11674 28786 14983]
 [12946 20275 25907]]
training model: results/ATVI/W2/deepOF_L2/h200
Epoch 1/50
2058/2058 - 47s - loss: 3.2694 - accuracy200: 0.3825 - val_loss: 3.2871 - val_accuracy200: 0.3627 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 3.2403 - accuracy200: 0.3991 - val_loss: 3.2776 - val_accuracy200: 0.3721 - 44s/epoch - 21ms/step
Epoch 3/50
2058/2058 - 44s - loss: 3.2286 - accuracy200: 0.4057 - val_loss: 3.2746 - val_accuracy200: 0.3742 - 44s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 44s - loss: 3.2217 - accuracy200: 0.4086 - val_loss: 3.2744 - val_accuracy200: 0.3767 - 44s/epoch - 21ms/step
Epoch 5/50
2058/2058 - 45s - loss: 3.2163 - accuracy200: 0.4119 - val_loss: 3.2758 - val_accuracy200: 0.3790 - 45s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.2119 - accuracy200: 0.4137 - val_loss: 3.2729 - val_accuracy200: 0.3829 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 44s - loss: 3.2080 - accuracy200: 0.4159 - val_loss: 3.2749 - val_accuracy200: 0.3866 - 44s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 45s - loss: 3.2048 - accuracy200: 0.4166 - val_loss: 3.2753 - val_accuracy200: 0.3882 - 45s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 45s - loss: 3.2013 - accuracy200: 0.4196 - val_loss: 3.2848 - val_accuracy200: 0.3876 - 45s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 45s - loss: 3.1983 - accuracy200: 0.4208 - val_loss: 3.2837 - val_accuracy200: 0.3917 - 45s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 44s - loss: 3.1954 - accuracy200: 0.4212 - val_loss: 3.2897 - val_accuracy200: 0.3905 - 44s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 45s - loss: 3.1923 - accuracy200: 0.4237 - val_loss: 3.2921 - val_accuracy200: 0.3907 - 45s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 45s - loss: 3.1897 - accuracy200: 0.4246 - val_loss: 3.3068 - val_accuracy200: 0.3903 - 45s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 44s - loss: 3.1865 - accuracy200: 0.4257 - val_loss: 3.3060 - val_accuracy200: 0.3891 - 44s/epoch - 21ms/step
Epoch 15/50
2058/2058 - 45s - loss: 3.1840 - accuracy200: 0.4273 - val_loss: 3.3083 - val_accuracy200: 0.3879 - 45s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 45s - loss: 3.1811 - accuracy200: 0.4290 - val_loss: 3.3139 - val_accuracy200: 0.3893 - 45s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h200
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.094686
{'0': {'precision': 0.4301310140015974, 'recall': 0.20524552607918403, 'f1-score': 0.27789022943940156, 'support': 474919}, '1': {'precision': 0.3310083425846833, 'recall': 0.5170771283643989, 'f1-score': 0.4036311176438565, 'support': 430166}, '2': {'precision': 0.4241366089598018, 'recall': 0.4296221353445752, 'f1-score': 0.42686174949243905, 'support': 502111}, 'accuracy': 0.3806307010537267, 'macro avg': {'precision': 0.3950919885153608, 'recall': 0.3839815965960527, 'f1-score': 0.369461032191899, 'support': 1407196}, 'weighted avg': {'precision': 0.3976912829458885, 'recall': 0.3806307010537267, 'f1-score': 0.36948350700749316, 'support': 1407196}}
[[ 97475 224999 152445]
 [ 67295 222429 140442]
 [ 61847 224546 215718]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0878711
{'0': {'precision': 0.44017347268613294, 'recall': 0.18566786347316275, 'f1-score': 0.26117184503260454, 'support': 176024}, '1': {'precision': 0.3617529786201919, 'recall': 0.5206145777757597, 'f1-score': 0.4268830440519101, 'support': 176186}, '2': {'precision': 0.4018862520663856, 'recall': 0.4580560550700402, 'f1-score': 0.4281367009873325, 'support': 174614}, 'accuracy': 0.38796637966379666, 'macro avg': {'precision': 0.4012709011242368, 'recall': 0.3881128321063209, 'f1-score': 0.37206386335728237, 'support': 526824}, 'weighted avg': {'precision': 0.4012571023066543, 'recall': 0.38796637966379666, 'f1-score': 0.3719306462035729, 'support': 526824}}
[[32682 85609 57733]
 [23158 91725 61303]
 [18408 76223 79983]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0906764
{'0': {'precision': 0.4403760710885433, 'recall': 0.188513593832255, 'f1-score': 0.26401094000832387, 'support': 58887}, '1': {'precision': 0.3579061371841155, 'recall': 0.5194383317615006, 'f1-score': 0.4238019920489035, 'support': 57258}, '2': {'precision': 0.3990089557666955, 'recall': 0.45278054819960795, 'f1-score': 0.42419751097506947, 'support': 58154}, 'accuracy': 0.38539521167648694, 'macro avg': {'precision': 0.3990970546797848, 'recall': 0.38691082459778786, 'f1-score': 0.3706701476774323, 'support': 174299}, 'weighted avg': {'precision': 0.3994823958527332, 'recall': 0.38539521167648694, 'f1-score': 0.3699484720982362, 'support': 174299}}
[[11101 27918 19868]
 [ 7724 29742 19792]
 [ 6383 25440 26331]]
training model: results/ATVI/W2/deepOF_L2/h300
Epoch 1/50
2058/2058 - 47s - loss: 3.2854 - accuracy300: 0.3711 - val_loss: 3.3061 - val_accuracy300: 0.3426 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 3.2631 - accuracy300: 0.3840 - val_loss: 3.2944 - val_accuracy300: 0.3530 - 44s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 3.2559 - accuracy300: 0.3899 - val_loss: 3.2909 - val_accuracy300: 0.3548 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 45s - loss: 3.2519 - accuracy300: 0.3928 - val_loss: 3.2881 - val_accuracy300: 0.3564 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 44s - loss: 3.2488 - accuracy300: 0.3949 - val_loss: 3.2890 - val_accuracy300: 0.3554 - 44s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.2458 - accuracy300: 0.3972 - val_loss: 3.2879 - val_accuracy300: 0.3562 - 44s/epoch - 21ms/step
Epoch 7/50
2058/2058 - 44s - loss: 3.2434 - accuracy300: 0.3987 - val_loss: 3.2878 - val_accuracy300: 0.3570 - 44s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 44s - loss: 3.2413 - accuracy300: 0.4001 - val_loss: 3.2887 - val_accuracy300: 0.3576 - 44s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 3.2393 - accuracy300: 0.4016 - val_loss: 3.2892 - val_accuracy300: 0.3608 - 44s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 44s - loss: 3.2378 - accuracy300: 0.4026 - val_loss: 3.2916 - val_accuracy300: 0.3608 - 44s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 45s - loss: 3.2356 - accuracy300: 0.4029 - val_loss: 3.2898 - val_accuracy300: 0.3628 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 44s - loss: 3.2335 - accuracy300: 0.4054 - val_loss: 3.2928 - val_accuracy300: 0.3631 - 44s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 45s - loss: 3.2320 - accuracy300: 0.4057 - val_loss: 3.2910 - val_accuracy300: 0.3642 - 45s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 44s - loss: 3.2298 - accuracy300: 0.4068 - val_loss: 3.2949 - val_accuracy300: 0.3645 - 44s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 44s - loss: 3.2281 - accuracy300: 0.4077 - val_loss: 3.2944 - val_accuracy300: 0.3683 - 44s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 45s - loss: 3.2260 - accuracy300: 0.4096 - val_loss: 3.2991 - val_accuracy300: 0.3664 - 45s/epoch - 22ms/step
Epoch 17/50
2058/2058 - 45s - loss: 3.2241 - accuracy300: 0.4103 - val_loss: 3.3016 - val_accuracy300: 0.3695 - 45s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h300
Evaluating performance on  test set...
5497/5497 - 42s - 42s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1052815
{'0': {'precision': 0.416088976917803, 'recall': 0.06761783912599424, 'f1-score': 0.11633095325570127, 'support': 484665}, '1': {'precision': 0.3035204088476345, 'recall': 0.6617236354065633, 'f1-score': 0.41615719787823935, 'support': 410342}, '2': {'precision': 0.42223077667799236, 'recall': 0.35762775069359165, 'f1-score': 0.38725342517158895, 'support': 512189}, 'accuracy': 0.34641798299597215, 'macro avg': {'precision': 0.3806133874811433, 'recall': 0.362323075075383, 'f1-score': 0.30658052543517655, 'support': 1407196}, 'weighted avg': {'precision': 0.38549917344929013, 'recall': 0.34641798299597215, 'f1-score': 0.30237100086742563, 'support': 1407196}}
[[ 32772 319360 132533]
 [ 20693 271533 118116]
 [ 25297 303719 183173]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0971781
{'0': {'precision': 0.4361237147733422, 'recall': 0.05846344430432017, 'f1-score': 0.10310536389983714, 'support': 179206}, '1': {'precision': 0.33514443864730825, 'recall': 0.6591222711028814, 'f1-score': 0.44434991412760005, 'support': 169574}, '2': {'precision': 0.40161131226262975, 'recall': 0.3818943631911213, 'f1-score': 0.39150474885345204, 'support': 178044}, 'accuracy': 0.3611092129439813, 'macro avg': {'precision': 0.39095982189442674, 'recall': 0.36649335953277423, 'f1-score': 0.3129866756269631, 'support': 526824}, 'weighted avg': {'precision': 0.3919568090089629, 'recall': 0.3611092129439813, 'f1-score': 0.31041175741077076, 'support': 526824}}
[[ 10477 118503  50226]
 [  6721 111770  51083]
 [  6825 103225  67994]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0989777
{'0': {'precision': 0.41457394290620303, 'recall': 0.06491564159440748, 'f1-score': 0.1122540900241188, 'support': 59508}, '1': {'precision': 0.33454778469425117, 'recall': 0.6536459730643344, 'f1-score': 0.44257679335880495, 'support': 55911}, '2': {'precision': 0.3964406810067993, 'recall': 0.3753057065217391, 'f1-score': 0.38558379354568534, 'support': 58880}, 'accuracy': 0.35861938393220844, 'macro avg': {'precision': 0.38185413620241787, 'recall': 0.3646224403934936, 'f1-score': 0.313471558976203, 'support': 174299}, 'weighted avg': {'precision': 0.3827778397017938, 'recall': 0.35861938393220844, 'f1-score': 0.31054739985088475, 'support': 174299}}
[[ 3863 38667 16978]
 [ 2700 36546 16665]
 [ 2755 34027 22098]]
training model: results/ATVI/W2/deepOF_L2/h500
Epoch 1/50
2058/2058 - 47s - loss: 3.2386 - accuracy500: 0.4050 - val_loss: 3.5301 - val_accuracy500: 0.3493 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 44s - loss: 3.2386 - accuracy500: 0.4024 - val_loss: 3.4851 - val_accuracy500: 0.3504 - 44s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 3.2409 - accuracy500: 0.4010 - val_loss: 3.4239 - val_accuracy500: 0.3513 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 45s - loss: 3.2443 - accuracy500: 0.3985 - val_loss: 3.4331 - val_accuracy500: 0.3502 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 45s - loss: 3.2353 - accuracy500: 0.4017 - val_loss: 3.4739 - val_accuracy500: 0.3498 - 45s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.2287 - accuracy500: 0.4051 - val_loss: 3.5013 - val_accuracy500: 0.3495 - 44s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 45s - loss: 3.2303 - accuracy500: 0.4038 - val_loss: 3.4846 - val_accuracy500: 0.3497 - 45s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 44s - loss: 3.2263 - accuracy500: 0.4057 - val_loss: 3.5369 - val_accuracy500: 0.3499 - 44s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 3.2229 - accuracy500: 0.4079 - val_loss: 3.5610 - val_accuracy500: 0.3500 - 44s/epoch - 21ms/step
Epoch 10/50
2058/2058 - 44s - loss: 3.2188 - accuracy500: 0.4096 - val_loss: 3.5976 - val_accuracy500: 0.3500 - 44s/epoch - 21ms/step
Epoch 11/50
2058/2058 - 44s - loss: 3.2179 - accuracy500: 0.4099 - val_loss: 3.6094 - val_accuracy500: 0.3497 - 44s/epoch - 21ms/step
Epoch 12/50
2058/2058 - 44s - loss: 3.2144 - accuracy500: 0.4129 - val_loss: 3.5998 - val_accuracy500: 0.3498 - 44s/epoch - 21ms/step
Epoch 13/50
2058/2058 - 44s - loss: 3.2143 - accuracy500: 0.4129 - val_loss: 3.6072 - val_accuracy500: 0.3496 - 44s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h500
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1642901
{'0': {'precision': 0.3789373814041746, 'recall': 0.008609447111394691, 'f1-score': 0.016836372297127825, 'support': 463909}, '1': {'precision': 0.3136521005480067, 'recall': 0.9893481156021992, 'f1-score': 0.4763024760635499, 'support': 439265}, '2': {'precision': 0.4019298403823609, 'recall': 0.008842867970048926, 'f1-score': 0.017305008046809327, 'support': 504022}, 'accuracy': 0.3148367391607139, 'macro avg': {'precision': 0.3648397741115141, 'recall': 0.3356001435612142, 'f1-score': 0.170147952135829, 'support': 1407196}, 'weighted avg': {'precision': 0.3667934911883261, 'recall': 0.3148367391607139, 'f1-score': 0.16042943310655547, 'support': 1407196}}
[[  3994 455544   4371]
 [  2418 434586   2261]
 [  4128 495437   4457]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.148143
{'0': {'precision': 0.4079110012360939, 'recall': 0.005621263137573318, 'f1-score': 0.011089703378438929, 'support': 176117}, '1': {'precision': 0.3417386653580062, 'recall': 0.9930756718213825, 'f1-score': 0.5084937211640627, 'support': 179512}, '2': {'precision': 0.36588921282798836, 'recall': 0.0058646572621863955, 'f1-score': 0.011544277016655264, 'support': 171195}, 'accuracy': 0.34216930132264284, 'macro avg': {'precision': 0.3718462931406961, 'recall': 0.33485386407371404, 'f1-score': 0.17704256718638564, 'support': 526824}, 'weighted avg': {'precision': 0.37170792691777715, 'recall': 0.34216930132264284, 'f1-score': 0.1807247442549505, 'support': 526824}}
[[   990 174070   1057]
 [   560 178269    683]
 [   877 169314   1004]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1371987
{'0': {'precision': 0.3812070282658518, 'recall': 0.008720269821575241, 'f1-score': 0.017050502289346, 'support': 57223}, '1': {'precision': 0.35101619617308566, 'recall': 0.9894818150442914, 'f1-score': 0.5182016534047141, 'support': 60847}, '2': {'precision': 0.38283378746594005, 'recall': 0.009994842518984866, 'f1-score': 0.019481082205313967, 'support': 56229}, 'accuracy': 0.35151090941428237, 'macro avg': {'precision': 0.37168567063495916, 'recall': 0.33606564246161724, 'f1-score': 0.18491107929979136, 'support': 174299}, 'weighted avg': {'precision': 0.3711923378930626, 'recall': 0.35151090941428237, 'f1-score': 0.1927842309396066, 'support': 174299}}
[[  499 56147   577]
 [  311 60207   329]
 [  499 55168   562]]
training model: results/ATVI/W2/deepOF_L2/h1000
Epoch 1/50
2058/2058 - 47s - loss: 3.2904 - accuracy1000: 0.3742 - val_loss: 3.3562 - val_accuracy1000: 0.3391 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 45s - loss: 3.2620 - accuracy1000: 0.3830 - val_loss: 3.3457 - val_accuracy1000: 0.3406 - 45s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 3.2532 - accuracy1000: 0.3885 - val_loss: 3.3430 - val_accuracy1000: 0.3411 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 44s - loss: 3.2499 - accuracy1000: 0.3904 - val_loss: 3.3458 - val_accuracy1000: 0.3396 - 44s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 44s - loss: 3.2483 - accuracy1000: 0.3917 - val_loss: 3.3454 - val_accuracy1000: 0.3395 - 44s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.2466 - accuracy1000: 0.3916 - val_loss: 3.3476 - val_accuracy1000: 0.3371 - 44s/epoch - 21ms/step
Epoch 7/50
2058/2058 - 44s - loss: 3.2453 - accuracy1000: 0.3932 - val_loss: 3.3476 - val_accuracy1000: 0.3372 - 44s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 44s - loss: 3.2440 - accuracy1000: 0.3937 - val_loss: 3.3509 - val_accuracy1000: 0.3367 - 44s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 44s - loss: 3.2431 - accuracy1000: 0.3944 - val_loss: 3.3492 - val_accuracy1000: 0.3369 - 44s/epoch - 21ms/step
Epoch 10/50
2058/2058 - 44s - loss: 3.2422 - accuracy1000: 0.3949 - val_loss: 3.3498 - val_accuracy1000: 0.3388 - 44s/epoch - 21ms/step
Epoch 11/50
2058/2058 - 44s - loss: 3.2413 - accuracy1000: 0.3955 - val_loss: 3.3531 - val_accuracy1000: 0.3379 - 44s/epoch - 21ms/step
Epoch 12/50
2058/2058 - 44s - loss: 3.2401 - accuracy1000: 0.3966 - val_loss: 3.3547 - val_accuracy1000: 0.3374 - 44s/epoch - 22ms/step
Epoch 13/50
2058/2058 - 45s - loss: 3.2392 - accuracy1000: 0.3973 - val_loss: 3.3549 - val_accuracy1000: 0.3367 - 45s/epoch - 22ms/step
testing model: results/ATVI/W2/deepOF_L2/h1000
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1154933
{'0': {'precision': 0.381575259273101, 'recall': 0.02697793015067742, 'f1-score': 0.05039300124625199, 'support': 454149}, '1': {'precision': 0.3290196667406959, 'recall': 0.9207842874230077, 'f1-score': 0.48480585835673373, 'support': 447285}, '2': {'precision': 0.4043006916459227, 'recall': 0.09858787334754292, 'f1-score': 0.15852078634092684, 'support': 505762}, 'accuracy': 0.33681661971750915, 'macro avg': {'precision': 0.3716318725532399, 'recall': 0.34878336364040935, 'f1-score': 0.23123988198130419, 'support': 1407196}, 'weighted avg': {'precision': 0.37303794956065595, 'recall': 0.33681661971750915, 'f1-score': 0.22733585756315083, 'support': 1407196}}
[[ 12252 396379  45518]
 [  7483 411853  27949]
 [ 12374 443526  49862]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1182282
{'0': {'precision': 0.40459079695377026, 'recall': 0.020766122372579028, 'f1-score': 0.039504621265676956, 'support': 181642}, '1': {'precision': 0.338375749321092, 'recall': 0.9280501302833952, 'f1-score': 0.4959305764349263, 'support': 173468}, '2': {'precision': 0.3713731221697774, 'recall': 0.09026637315536298, 'f1-score': 0.14523239525699108, 'support': 171714}, 'accuracy': 0.3421617086541236, 'macro avg': {'precision': 0.3714465561482132, 'recall': 0.34636087527044573, 'f1-score': 0.22688919765253143, 'support': 526824}, 'weighted avg': {'precision': 0.3719610540213982, 'recall': 0.3421617086541236, 'f1-score': 0.22425367706883673, 'support': 526824}}
[[  3772 161811  16059]
 [  2303 160987  10178]
 [  3248 152966  15500]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1173174
{'0': {'precision': 0.4015884834946637, 'recall': 0.02725236226440518, 'f1-score': 0.05104100946372239, 'support': 59371}, '1': {'precision': 0.3344524255673537, 'recall': 0.9095960221541947, 'f1-score': 0.4890751585326984, 'support': 56513}, '2': {'precision': 0.3824061783516351, 'recall': 0.10849952923050586, 'f1-score': 0.16903812559175346, 'support': 58415}, 'accuracy': 0.3405642028927303, 'macro avg': {'precision': 0.3728156958045508, 'recall': 0.3484493045497019, 'f1-score': 0.23638476452939142, 'support': 174299}, 'weighted avg': {'precision': 0.3733921404486561, 'recall': 0.3405642028927303, 'f1-score': 0.23261075688025362, 'support': 174299}}
[[ 1618 51640  6113]
 [  986 51404  4123]
 [ 1425 50652  6338]]
training model: results/ATVI/W2/deepVOL_L2/h10
Epoch 1/50
2058/2058 - 46s - loss: 2.8813 - accuracy10: 0.4987 - val_loss: 3.0622 - val_accuracy10: 0.5751 - 46s/epoch - 22ms/step
Epoch 2/50
2058/2058 - 50s - loss: 2.6766 - accuracy10: 0.5560 - val_loss: 3.0168 - val_accuracy10: 0.5738 - 50s/epoch - 24ms/step
Epoch 3/50
2058/2058 - 47s - loss: 2.6234 - accuracy10: 0.5751 - val_loss: 3.0025 - val_accuracy10: 0.5792 - 47s/epoch - 23ms/step
Epoch 4/50
2058/2058 - 45s - loss: 2.5942 - accuracy10: 0.5841 - val_loss: 2.9768 - val_accuracy10: 0.5760 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 43s - loss: 2.5733 - accuracy10: 0.5898 - val_loss: 2.9767 - val_accuracy10: 0.5914 - 43s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 45s - loss: 2.5568 - accuracy10: 0.5930 - val_loss: 3.0086 - val_accuracy10: 0.5883 - 45s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 43s - loss: 2.5448 - accuracy10: 0.5963 - val_loss: 2.9960 - val_accuracy10: 0.5911 - 43s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 48s - loss: 2.5326 - accuracy10: 0.5979 - val_loss: 2.9765 - val_accuracy10: 0.5825 - 48s/epoch - 24ms/step
Epoch 9/50
2058/2058 - 49s - loss: 2.5211 - accuracy10: 0.6010 - val_loss: 2.9678 - val_accuracy10: 0.5918 - 49s/epoch - 24ms/step
Epoch 10/50
2058/2058 - 49s - loss: 2.5100 - accuracy10: 0.6021 - val_loss: 2.9814 - val_accuracy10: 0.5838 - 49s/epoch - 24ms/step
Epoch 11/50
2058/2058 - 44s - loss: 2.5024 - accuracy10: 0.6029 - val_loss: 2.9563 - val_accuracy10: 0.5812 - 44s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 47s - loss: 2.4945 - accuracy10: 0.6040 - val_loss: 2.9614 - val_accuracy10: 0.5866 - 47s/epoch - 23ms/step
Epoch 13/50
2058/2058 - 47s - loss: 2.4877 - accuracy10: 0.6054 - val_loss: 2.9630 - val_accuracy10: 0.5783 - 47s/epoch - 23ms/step
Epoch 14/50
2058/2058 - 46s - loss: 2.4816 - accuracy10: 0.6061 - val_loss: 2.9349 - val_accuracy10: 0.5841 - 46s/epoch - 22ms/step
Epoch 15/50
2058/2058 - 46s - loss: 2.4749 - accuracy10: 0.6066 - val_loss: 2.9411 - val_accuracy10: 0.5860 - 46s/epoch - 23ms/step
Epoch 16/50
2058/2058 - 49s - loss: 2.4703 - accuracy10: 0.6073 - val_loss: 2.9194 - val_accuracy10: 0.5811 - 49s/epoch - 24ms/step
Epoch 17/50
2058/2058 - 48s - loss: 2.4637 - accuracy10: 0.6083 - val_loss: 2.9549 - val_accuracy10: 0.5775 - 48s/epoch - 23ms/step
Epoch 18/50
2058/2058 - 49s - loss: 2.4589 - accuracy10: 0.6091 - val_loss: 2.9397 - val_accuracy10: 0.5822 - 49s/epoch - 24ms/step
Epoch 19/50
2058/2058 - 51s - loss: 2.4541 - accuracy10: 0.6090 - val_loss: 2.9543 - val_accuracy10: 0.5780 - 51s/epoch - 25ms/step
Epoch 20/50
2058/2058 - 49s - loss: 2.4496 - accuracy10: 0.6100 - val_loss: 2.9695 - val_accuracy10: 0.5836 - 49s/epoch - 24ms/step
Epoch 21/50
2058/2058 - 47s - loss: 2.4441 - accuracy10: 0.6115 - val_loss: 2.9217 - val_accuracy10: 0.5851 - 47s/epoch - 23ms/step
Epoch 22/50
2058/2058 - 49s - loss: 2.4411 - accuracy10: 0.6105 - val_loss: 2.9321 - val_accuracy10: 0.5820 - 49s/epoch - 24ms/step
Epoch 23/50
2058/2058 - 46s - loss: 2.4365 - accuracy10: 0.6117 - val_loss: 2.9187 - val_accuracy10: 0.5838 - 46s/epoch - 22ms/step
Epoch 24/50
2058/2058 - 44s - loss: 2.4324 - accuracy10: 0.6125 - val_loss: 2.9185 - val_accuracy10: 0.5842 - 44s/epoch - 21ms/step
Epoch 25/50
2058/2058 - 46s - loss: 2.4273 - accuracy10: 0.6122 - val_loss: 2.9060 - val_accuracy10: 0.5873 - 46s/epoch - 22ms/step
Epoch 26/50
2058/2058 - 45s - loss: 2.4258 - accuracy10: 0.6137 - val_loss: 2.9223 - val_accuracy10: 0.5904 - 45s/epoch - 22ms/step
Epoch 27/50
2058/2058 - 49s - loss: 2.4218 - accuracy10: 0.6130 - val_loss: 2.9032 - val_accuracy10: 0.5840 - 49s/epoch - 24ms/step
Epoch 28/50
2058/2058 - 44s - loss: 2.4175 - accuracy10: 0.6137 - val_loss: 2.9088 - val_accuracy10: 0.5870 - 44s/epoch - 22ms/step
Epoch 29/50
2058/2058 - 49s - loss: 2.4139 - accuracy10: 0.6138 - val_loss: 2.9098 - val_accuracy10: 0.5848 - 49s/epoch - 24ms/step
Epoch 30/50
2058/2058 - 48s - loss: 2.4106 - accuracy10: 0.6137 - val_loss: 2.8932 - val_accuracy10: 0.5860 - 48s/epoch - 23ms/step
Epoch 31/50
2058/2058 - 44s - loss: 2.4067 - accuracy10: 0.6141 - val_loss: 2.9135 - val_accuracy10: 0.5818 - 44s/epoch - 21ms/step
Epoch 32/50
2058/2058 - 49s - loss: 2.4043 - accuracy10: 0.6145 - val_loss: 2.8856 - val_accuracy10: 0.5836 - 49s/epoch - 24ms/step
Epoch 33/50
2058/2058 - 45s - loss: 2.4001 - accuracy10: 0.6151 - val_loss: 2.9401 - val_accuracy10: 0.5841 - 45s/epoch - 22ms/step
Epoch 34/50
2058/2058 - 45s - loss: 2.3989 - accuracy10: 0.6149 - val_loss: 2.9192 - val_accuracy10: 0.5882 - 45s/epoch - 22ms/step
Epoch 35/50
2058/2058 - 43s - loss: 2.3952 - accuracy10: 0.6159 - val_loss: 2.9142 - val_accuracy10: 0.5858 - 43s/epoch - 21ms/step
Epoch 36/50
2058/2058 - 47s - loss: 2.3911 - accuracy10: 0.6160 - val_loss: 2.9310 - val_accuracy10: 0.5847 - 47s/epoch - 23ms/step
Epoch 37/50
2058/2058 - 46s - loss: 2.3899 - accuracy10: 0.6162 - val_loss: 2.9049 - val_accuracy10: 0.5847 - 46s/epoch - 22ms/step
Epoch 38/50
2058/2058 - 48s - loss: 2.3853 - accuracy10: 0.6164 - val_loss: 2.9144 - val_accuracy10: 0.5825 - 48s/epoch - 24ms/step
Epoch 39/50
2058/2058 - 48s - loss: 2.3831 - accuracy10: 0.6170 - val_loss: 2.9406 - val_accuracy10: 0.5801 - 48s/epoch - 23ms/step
Epoch 40/50
2058/2058 - 47s - loss: 2.3780 - accuracy10: 0.6174 - val_loss: 2.9325 - val_accuracy10: 0.5785 - 47s/epoch - 23ms/step
Epoch 41/50
2058/2058 - 48s - loss: 2.3765 - accuracy10: 0.6178 - val_loss: 2.9358 - val_accuracy10: 0.5800 - 48s/epoch - 23ms/step
Epoch 42/50
2058/2058 - 46s - loss: 2.3740 - accuracy10: 0.6178 - val_loss: 2.9506 - val_accuracy10: 0.5840 - 46s/epoch - 22ms/step
testing model: results/ATVI/W2/deepVOL_L2/h10
Evaluating performance on  test set...
5497/5497 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8643103
{'0': {'precision': 0.44160745639224824, 'recall': 0.49302741402431427, 'f1-score': 0.46590297265901587, 'support': 272926}, '1': {'precision': 0.8056460303885216, 'recall': 0.6171000293577559, 'f1-score': 0.6988797271290661, 'support': 868595}, '2': {'precision': 0.37833930724028375, 'recall': 0.6225609756097561, 'f1-score': 0.4706548539607517, 'support': 265680}, 'accuracy': 0.594067229912429, 'macro avg': {'precision': 0.5418642646736845, 'recall': 0.5775628063306087, 'f1-score': 0.5451458512496111, 'support': 1407201}, 'weighted avg': {'precision': 0.6543652666223426, 'recall': 0.594067229912429, 'f1-score': 0.610605061325211, 'support': 1407201}}
[[134560  82655  55711]
 [116519 536010 216066]
 [ 53626  46652 165402]]
Evaluating performance on  train set...
2058/2058 - 18s - 18s/epoch - 9ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.83292216
{'0': {'precision': 0.46675957802246487, 'recall': 0.5284209646409763, 'f1-score': 0.49568000156823533, 'support': 95704}, '1': {'precision': 0.8213577141785915, 'recall': 0.6296692175954203, 'f1-score': 0.7128519229074441, 'support': 333996}, '2': {'precision': 0.3882681048334965, 'recall': 0.6493348708867015, 'f1-score': 0.48595855181793307, 'support': 97124}, 'accuracy': 0.6149017508693605, 'macro avg': {'precision': 0.558795132344851, 'recall': 0.6024750177076994, 'f1-score': 0.5648301587645375, 'support': 526824}, 'weighted avg': {'precision': 0.6770972870896226, 'recall': 0.6149017508693605, 'f1-score': 0.6315704829321482, 'support': 526824}}
[[ 50572  27229  17903]
 [ 42229 210307  81460]
 [ 15546  18512  63066]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8845202
{'0': {'precision': 0.462425222727156, 'recall': 0.5076237986528, 'f1-score': 0.48397151686148054, 'support': 35481}, '1': {'precision': 0.7940331206907661, 'recall': 0.5944389236750958, 'f1-score': 0.6798900929134206, 'support': 103649}, '2': {'precision': 0.3818543849017401, 'recall': 0.6270863544598937, 'f1-score': 0.47466747019069344, 'support': 35169}, 'accuracy': 0.5833538918754554, 'macro avg': {'precision': 0.5461042427732208, 'recall': 0.5763830255959298, 'f1-score': 0.5461763599885315, 'support': 174299}, 'weighted avg': {'precision': 0.6433627566232092, 'recall': 0.5833538918754554, 'f1-score': 0.5985995438257353, 'support': 174299}}
[[18011  9934  7536]
 [13871 61613 28165]
 [ 7067  6048 22054]]
training model: results/ATVI/W2/deepVOL_L2/h20
Epoch 1/50
2058/2058 - 45s - loss: 2.9465 - accuracy20: 0.5020 - val_loss: 3.0485 - val_accuracy20: 0.5516 - 45s/epoch - 22ms/step
Epoch 2/50
2058/2058 - 46s - loss: 2.7744 - accuracy20: 0.5495 - val_loss: 3.0163 - val_accuracy20: 0.5522 - 46s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 45s - loss: 2.7287 - accuracy20: 0.5632 - val_loss: 2.9917 - val_accuracy20: 0.5464 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 43s - loss: 2.7031 - accuracy20: 0.5707 - val_loss: 3.0008 - val_accuracy20: 0.5477 - 43s/epoch - 21ms/step
Epoch 5/50
2058/2058 - 43s - loss: 2.6884 - accuracy20: 0.5752 - val_loss: 2.9902 - val_accuracy20: 0.5406 - 43s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 47s - loss: 2.6765 - accuracy20: 0.5784 - val_loss: 2.9774 - val_accuracy20: 0.5444 - 47s/epoch - 23ms/step
Epoch 7/50
2058/2058 - 43s - loss: 2.6662 - accuracy20: 0.5801 - val_loss: 2.9973 - val_accuracy20: 0.5449 - 43s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 46s - loss: 2.6567 - accuracy20: 0.5821 - val_loss: 2.9721 - val_accuracy20: 0.5420 - 46s/epoch - 22ms/step
Epoch 9/50
2058/2058 - 46s - loss: 2.6482 - accuracy20: 0.5831 - val_loss: 2.9748 - val_accuracy20: 0.5451 - 46s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 48s - loss: 2.6395 - accuracy20: 0.5846 - val_loss: 2.9831 - val_accuracy20: 0.5423 - 48s/epoch - 23ms/step
Epoch 11/50
2058/2058 - 43s - loss: 2.6318 - accuracy20: 0.5858 - val_loss: 2.9663 - val_accuracy20: 0.5459 - 43s/epoch - 21ms/step
Epoch 12/50
2058/2058 - 43s - loss: 2.6264 - accuracy20: 0.5870 - val_loss: 2.9623 - val_accuracy20: 0.5457 - 43s/epoch - 21ms/step
Epoch 13/50
2058/2058 - 48s - loss: 2.6209 - accuracy20: 0.5874 - val_loss: 2.9481 - val_accuracy20: 0.5461 - 48s/epoch - 23ms/step
Epoch 14/50
2058/2058 - 47s - loss: 2.6159 - accuracy20: 0.5885 - val_loss: 2.9540 - val_accuracy20: 0.5416 - 47s/epoch - 23ms/step
Epoch 15/50
2058/2058 - 48s - loss: 2.6106 - accuracy20: 0.5894 - val_loss: 2.9224 - val_accuracy20: 0.5502 - 48s/epoch - 23ms/step
Epoch 16/50
2058/2058 - 47s - loss: 2.6041 - accuracy20: 0.5900 - val_loss: 2.9455 - val_accuracy20: 0.5452 - 47s/epoch - 23ms/step
Epoch 17/50
2058/2058 - 44s - loss: 2.6000 - accuracy20: 0.5912 - val_loss: 2.9238 - val_accuracy20: 0.5468 - 44s/epoch - 22ms/step
Epoch 18/50
2058/2058 - 49s - loss: 2.5961 - accuracy20: 0.5914 - val_loss: 2.9370 - val_accuracy20: 0.5424 - 49s/epoch - 24ms/step
Epoch 19/50
2058/2058 - 47s - loss: 2.5907 - accuracy20: 0.5929 - val_loss: 2.9542 - val_accuracy20: 0.5363 - 47s/epoch - 23ms/step
Epoch 20/50
2058/2058 - 48s - loss: 2.5870 - accuracy20: 0.5930 - val_loss: 2.9439 - val_accuracy20: 0.5419 - 48s/epoch - 23ms/step
Epoch 21/50
2058/2058 - 48s - loss: 2.5835 - accuracy20: 0.5935 - val_loss: 2.9314 - val_accuracy20: 0.5444 - 48s/epoch - 23ms/step
Epoch 22/50
2058/2058 - 48s - loss: 2.5799 - accuracy20: 0.5940 - val_loss: 2.9346 - val_accuracy20: 0.5388 - 48s/epoch - 23ms/step
Epoch 23/50
2058/2058 - 44s - loss: 2.5755 - accuracy20: 0.5947 - val_loss: 2.9237 - val_accuracy20: 0.5438 - 44s/epoch - 21ms/step
Epoch 24/50
2058/2058 - 44s - loss: 2.5721 - accuracy20: 0.5949 - val_loss: 2.9109 - val_accuracy20: 0.5460 - 44s/epoch - 21ms/step
Epoch 25/50
2058/2058 - 46s - loss: 2.5672 - accuracy20: 0.5958 - val_loss: 2.9191 - val_accuracy20: 0.5466 - 46s/epoch - 23ms/step
Epoch 26/50
2058/2058 - 47s - loss: 2.5650 - accuracy20: 0.5963 - val_loss: 2.9224 - val_accuracy20: 0.5437 - 47s/epoch - 23ms/step
Epoch 27/50
2058/2058 - 48s - loss: 2.5613 - accuracy20: 0.5960 - val_loss: 2.9228 - val_accuracy20: 0.5470 - 48s/epoch - 23ms/step
Epoch 28/50
2058/2058 - 47s - loss: 2.5572 - accuracy20: 0.5968 - val_loss: 2.8986 - val_accuracy20: 0.5487 - 47s/epoch - 23ms/step
Epoch 29/50
2058/2058 - 48s - loss: 2.5541 - accuracy20: 0.5976 - val_loss: 2.9190 - val_accuracy20: 0.5469 - 48s/epoch - 23ms/step
Epoch 30/50
2058/2058 - 48s - loss: 2.5516 - accuracy20: 0.5972 - val_loss: 2.9144 - val_accuracy20: 0.5485 - 48s/epoch - 23ms/step
Epoch 31/50
2058/2058 - 45s - loss: 2.5477 - accuracy20: 0.5982 - val_loss: 2.9040 - val_accuracy20: 0.5448 - 45s/epoch - 22ms/step
Epoch 32/50
2058/2058 - 49s - loss: 2.5460 - accuracy20: 0.5981 - val_loss: 2.9291 - val_accuracy20: 0.5478 - 49s/epoch - 24ms/step
Epoch 33/50
2058/2058 - 48s - loss: 2.5433 - accuracy20: 0.5993 - val_loss: 2.9127 - val_accuracy20: 0.5518 - 48s/epoch - 23ms/step
Epoch 34/50
2058/2058 - 45s - loss: 2.5393 - accuracy20: 0.5996 - val_loss: 2.9415 - val_accuracy20: 0.5403 - 45s/epoch - 22ms/step
Epoch 35/50
2058/2058 - 45s - loss: 2.5374 - accuracy20: 0.5996 - val_loss: 2.9164 - val_accuracy20: 0.5548 - 45s/epoch - 22ms/step
Epoch 36/50
2058/2058 - 43s - loss: 2.5342 - accuracy20: 0.6004 - val_loss: 2.9265 - val_accuracy20: 0.5446 - 43s/epoch - 21ms/step
Epoch 37/50
2058/2058 - 47s - loss: 2.5313 - accuracy20: 0.6002 - val_loss: 2.9249 - val_accuracy20: 0.5504 - 47s/epoch - 23ms/step
Epoch 38/50
2058/2058 - 48s - loss: 2.5277 - accuracy20: 0.6006 - val_loss: 2.9240 - val_accuracy20: 0.5467 - 48s/epoch - 24ms/step
testing model: results/ATVI/W2/deepVOL_L2/h20
Evaluating performance on  test set...
5497/5497 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9181348
{'0': {'precision': 0.4862436665200202, 'recall': 0.470604592154466, 'f1-score': 0.4782963239904736, 'support': 345241}, '1': {'precision': 0.7293768631825192, 'recall': 0.5600955665134049, 'f1-score': 0.6336246328001263, 'support': 720336}, '2': {'precision': 0.4057540617528769, 'recall': 0.6175093084794979, 'f1-score': 0.4897212533443215, 'support': 341624}, 'accuracy': 0.5520782034691561, 'macro avg': {'precision': 0.5404581971518054, 'recall': 0.5494031557157896, 'f1-score': 0.5338807367116405, 'support': 1407201}, 'weighted avg': {'precision': 0.5911614526871046, 'recall': 0.5520782034691561, 'f1-score': 0.5605813726226795, 'support': 1407201}}
[[162472  89910  92859]
 [100783 403457 216096]
 [ 70882  59786 210956]]
Evaluating performance on  train set...
2058/2058 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8860143
{'0': {'precision': 0.5207482409473142, 'recall': 0.4883206334135292, 'f1-score': 0.5040133876479846, 'support': 124279}, '1': {'precision': 0.736962283749418, 'recall': 0.5943876906188273, 'f1-score': 0.6580408132262198, 'support': 276927}, '2': {'precision': 0.427133931055143, 'recall': 0.6356175070451687, 'f1-score': 0.510926251799712, 'support': 125618}, 'accuracy': 0.5791972271574568, 'macro avg': {'precision': 0.5616148185839583, 'recall': 0.5727752770258417, 'f1-score': 0.5576601508913054, 'support': 526824}, 'weighted avg': {'precision': 0.6120801921321946, 'recall': 0.5791972271574568, 'f1-score': 0.5866268089274169, 'support': 526824}}
[[ 60688  33949  29642]
 [ 34880 164602  77445]
 [ 20972  24801  79845]]
Evaluating performance on  val set...
681/681 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.9271476
{'0': {'precision': 0.5060610348568464, 'recall': 0.4772156121427777, 'f1-score': 0.4912152185607838, 'support': 44965}, '1': {'precision': 0.7130159709898928, 'recall': 0.5456531494296308, 'f1-score': 0.6182076033367451, 'support': 84682}, '2': {'precision': 0.4140881178083825, 'recall': 0.6221893756158738, 'f1-score': 0.4972436998854525, 'support': 44652}, 'accuracy': 0.5476049776533428, 'macro avg': {'precision': 0.5443883745517072, 'recall': 0.5483527123960942, 'f1-score': 0.5355555072609938, 'support': 174299}, 'weighted avg': {'precision': 0.583047037126341, 'recall': 0.5476049776533428, 'f1-score': 0.5544579960621295, 'support': 174299}}
[[21458 11130 12377]
 [11542 46207 26933]
 [ 9402  7468 27782]]
training model: results/ATVI/W2/deepVOL_L2/h30
Epoch 1/50
2058/2058 - 47s - loss: 3.0236 - accuracy30: 0.4858 - val_loss: 3.0812 - val_accuracy30: 0.5210 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 49s - loss: 2.8574 - accuracy30: 0.5327 - val_loss: 3.0101 - val_accuracy30: 0.5233 - 49s/epoch - 24ms/step
Epoch 3/50
2058/2058 - 47s - loss: 2.8151 - accuracy30: 0.5454 - val_loss: 2.9938 - val_accuracy30: 0.5205 - 47s/epoch - 23ms/step
Epoch 4/50
2058/2058 - 45s - loss: 2.7940 - accuracy30: 0.5516 - val_loss: 2.9948 - val_accuracy30: 0.5240 - 45s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 44s - loss: 2.7830 - accuracy30: 0.5541 - val_loss: 3.0045 - val_accuracy30: 0.5220 - 44s/epoch - 21ms/step
Epoch 6/50
2058/2058 - 48s - loss: 2.7737 - accuracy30: 0.5561 - val_loss: 3.0163 - val_accuracy30: 0.5258 - 48s/epoch - 23ms/step
Epoch 7/50
2058/2058 - 51s - loss: 2.7648 - accuracy30: 0.5582 - val_loss: 2.9878 - val_accuracy30: 0.5307 - 51s/epoch - 25ms/step
Epoch 8/50
2058/2058 - 49s - loss: 2.7579 - accuracy30: 0.5598 - val_loss: 2.9821 - val_accuracy30: 0.5286 - 49s/epoch - 24ms/step
Epoch 9/50
2058/2058 - 49s - loss: 2.7502 - accuracy30: 0.5612 - val_loss: 2.9860 - val_accuracy30: 0.5287 - 49s/epoch - 24ms/step
Epoch 10/50
2058/2058 - 47s - loss: 2.7422 - accuracy30: 0.5631 - val_loss: 2.9739 - val_accuracy30: 0.5263 - 47s/epoch - 23ms/step
Epoch 11/50
2058/2058 - 47s - loss: 2.7351 - accuracy30: 0.5636 - val_loss: 2.9671 - val_accuracy30: 0.5295 - 47s/epoch - 23ms/step
Epoch 12/50
2058/2058 - 49s - loss: 2.7300 - accuracy30: 0.5652 - val_loss: 2.9573 - val_accuracy30: 0.5288 - 49s/epoch - 24ms/step
Epoch 13/50
2058/2058 - 46s - loss: 2.7251 - accuracy30: 0.5659 - val_loss: 2.9579 - val_accuracy30: 0.5338 - 46s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 49s - loss: 2.7190 - accuracy30: 0.5672 - val_loss: 2.9578 - val_accuracy30: 0.5356 - 49s/epoch - 24ms/step
Epoch 15/50
2058/2058 - 46s - loss: 2.7139 - accuracy30: 0.5672 - val_loss: 2.9656 - val_accuracy30: 0.5326 - 46s/epoch - 22ms/step
Epoch 16/50
2058/2058 - 43s - loss: 2.7099 - accuracy30: 0.5686 - val_loss: 2.9551 - val_accuracy30: 0.5333 - 43s/epoch - 21ms/step
Epoch 17/50
2058/2058 - 49s - loss: 2.7056 - accuracy30: 0.5693 - val_loss: 2.9478 - val_accuracy30: 0.5351 - 49s/epoch - 24ms/step
Epoch 18/50
2058/2058 - 47s - loss: 2.7016 - accuracy30: 0.5691 - val_loss: 2.9568 - val_accuracy30: 0.5371 - 47s/epoch - 23ms/step
Epoch 19/50
2058/2058 - 50s - loss: 2.6974 - accuracy30: 0.5709 - val_loss: 2.9386 - val_accuracy30: 0.5385 - 50s/epoch - 24ms/step
Epoch 20/50
2058/2058 - 46s - loss: 2.6937 - accuracy30: 0.5710 - val_loss: 2.9327 - val_accuracy30: 0.5392 - 46s/epoch - 22ms/step
Epoch 21/50
2058/2058 - 44s - loss: 2.6911 - accuracy30: 0.5714 - val_loss: 2.9525 - val_accuracy30: 0.5332 - 44s/epoch - 21ms/step
Epoch 22/50
2058/2058 - 47s - loss: 2.6870 - accuracy30: 0.5725 - val_loss: 2.9435 - val_accuracy30: 0.5381 - 47s/epoch - 23ms/step
Epoch 23/50
2058/2058 - 47s - loss: 2.6829 - accuracy30: 0.5729 - val_loss: 2.9411 - val_accuracy30: 0.5353 - 47s/epoch - 23ms/step
Epoch 24/50
2058/2058 - 45s - loss: 2.6807 - accuracy30: 0.5741 - val_loss: 2.9565 - val_accuracy30: 0.5371 - 45s/epoch - 22ms/step
Epoch 25/50
2058/2058 - 48s - loss: 2.6782 - accuracy30: 0.5738 - val_loss: 2.9727 - val_accuracy30: 0.5360 - 48s/epoch - 23ms/step
Epoch 26/50
2058/2058 - 46s - loss: 2.6748 - accuracy30: 0.5746 - val_loss: 2.9522 - val_accuracy30: 0.5368 - 46s/epoch - 22ms/step
Epoch 27/50
2058/2058 - 49s - loss: 2.6719 - accuracy30: 0.5749 - val_loss: 2.9785 - val_accuracy30: 0.5336 - 49s/epoch - 24ms/step
Epoch 28/50
2058/2058 - 46s - loss: 2.6693 - accuracy30: 0.5756 - val_loss: 2.9493 - val_accuracy30: 0.5363 - 46s/epoch - 22ms/step
Epoch 29/50
2058/2058 - 46s - loss: 2.6670 - accuracy30: 0.5754 - val_loss: 2.9545 - val_accuracy30: 0.5371 - 46s/epoch - 22ms/step
Epoch 30/50
2058/2058 - 49s - loss: 2.6646 - accuracy30: 0.5758 - val_loss: 2.9482 - val_accuracy30: 0.5402 - 49s/epoch - 24ms/step
testing model: results/ATVI/W2/deepVOL_L2/h30
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9433793
{'0': {'precision': 0.5124340641780607, 'recall': 0.41172298070322627, 'f1-score': 0.4565909690043236, 'support': 393330}, '1': {'precision': 0.6333702647040909, 'recall': 0.6197345996604371, 'f1-score': 0.6264782439134007, 'support': 620798}, '2': {'precision': 0.4599775499699219, 'recall': 0.5660780567477288, 'f1-score': 0.5075420784795863, 'support': 393073}, 'accuracy': 0.5466049270857539, 'macro avg': {'precision': 0.5352606262840245, 'recall': 0.5325118790371307, 'f1-score': 0.5302037637991036, 'support': 1407201}, 'weighted avg': {'precision': 0.5511333772149494, 'recall': 0.5466049270857539, 'f1-score': 0.5457702589165502, 'support': 1407201}}
[[161943 126524 104863]
 [ 79700 384730 156368]
 [ 74384  96179 222510]]
Evaluating performance on  train set...
2058/2058 - 19s - 19s/epoch - 9ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9265343
{'0': {'precision': 0.5509928132177521, 'recall': 0.4139173751513212, 'f1-score': 0.4727186047435541, 'support': 143734}, '1': {'precision': 0.6330862199914143, 'recall': 0.6443392302747938, 'f1-score': 0.6386631605027723, 'support': 238033}, '2': {'precision': 0.47395573777918726, 'recall': 0.5769662960077763, 'f1-score': 0.5204125095992116, 'support': 145057}, 'accuracy': 0.5629223421863848, 'macro avg': {'precision': 0.5526782569961178, 'recall': 0.5450743004779638, 'f1-score': 0.5439314249485127, 'support': 526824}, 'weighted avg': {'precision': 0.5668732075100836, 'recall': 0.5629223421863848, 'f1-score': 0.5608288943235298, 'support': 526824}}
[[ 59494  49281  34959]
 [ 26727 153374  57932]
 [ 21755  39609  83693]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 8ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.95363355
{'0': {'precision': 0.5372082214418509, 'recall': 0.40656999921832254, 'f1-score': 0.4628476084538376, 'support': 51172}, '1': {'precision': 0.6097748889853895, 'recall': 0.6020164022847028, 'f1-score': 0.6058708088020376, 'support': 72307}, '2': {'precision': 0.4647575719805559, 'recall': 0.5869736324281779, 'f1-score': 0.5187645647107927, 'support': 50820}, 'accuracy': 0.540249800629952, 'macro avg': {'precision': 0.5372468941359321, 'recall': 0.5318533446437343, 'f1-score': 0.5291609939888894, 'support': 174299}, 'weighted avg': {'precision': 0.5461878255959058, 'recall': 0.540249800629952, 'f1-score': 0.5384836032934853, 'support': 174299}}
[[20805 16216 14151]
 [ 8574 43530 20203]
 [ 9349 11641 29830]]
training model: results/ATVI/W2/deepVOL_L2/h50
Epoch 1/50
2058/2058 - 46s - loss: 3.1073 - accuracy50: 0.4561 - val_loss: 3.1074 - val_accuracy50: 0.4729 - 46s/epoch - 22ms/step
Epoch 2/50
2058/2058 - 44s - loss: 2.9732 - accuracy50: 0.4974 - val_loss: 3.0463 - val_accuracy50: 0.4836 - 44s/epoch - 21ms/step
Epoch 3/50
2058/2058 - 44s - loss: 2.9363 - accuracy50: 0.5061 - val_loss: 3.0476 - val_accuracy50: 0.4783 - 44s/epoch - 21ms/step
Epoch 4/50
2058/2058 - 48s - loss: 2.9212 - accuracy50: 0.5102 - val_loss: 3.0643 - val_accuracy50: 0.4778 - 48s/epoch - 23ms/step
Epoch 5/50
2058/2058 - 46s - loss: 2.9099 - accuracy50: 0.5131 - val_loss: 3.0627 - val_accuracy50: 0.4759 - 46s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 45s - loss: 2.9014 - accuracy50: 0.5155 - val_loss: 3.0551 - val_accuracy50: 0.4792 - 45s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 45s - loss: 2.8946 - accuracy50: 0.5167 - val_loss: 3.0635 - val_accuracy50: 0.4802 - 45s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 47s - loss: 2.8886 - accuracy50: 0.5186 - val_loss: 3.0770 - val_accuracy50: 0.4797 - 47s/epoch - 23ms/step
Epoch 9/50
2058/2058 - 43s - loss: 2.8825 - accuracy50: 0.5203 - val_loss: 3.0753 - val_accuracy50: 0.4800 - 43s/epoch - 21ms/step
Epoch 10/50
2058/2058 - 43s - loss: 2.8766 - accuracy50: 0.5216 - val_loss: 3.0801 - val_accuracy50: 0.4809 - 43s/epoch - 21ms/step
Epoch 11/50
2058/2058 - 46s - loss: 2.8719 - accuracy50: 0.5224 - val_loss: 3.0775 - val_accuracy50: 0.4790 - 46s/epoch - 23ms/step
Epoch 12/50
2058/2058 - 46s - loss: 2.8671 - accuracy50: 0.5238 - val_loss: 3.0762 - val_accuracy50: 0.4800 - 46s/epoch - 22ms/step
testing model: results/ATVI/W2/deepVOL_L2/h50
Evaluating performance on  test set...
5497/5497 - 54s - 54s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0021751
{'0': {'precision': 0.5039325187123876, 'recall': 0.3305761083760003, 'f1-score': 0.39924824145026533, 'support': 457223}, '1': {'precision': 0.48865381183248496, 'recall': 0.6756302589557748, 'f1-score': 0.5671284349095079, 'support': 490354}, '2': {'precision': 0.4878414107178215, 'recall': 0.4556398273371277, 'f1-score': 0.4711910893016045, 'support': 459624}, 'accuracy': 0.49166252724379816, 'macro avg': {'precision': 0.49347591375423133, 'recall': 0.48728206488963427, 'f1-score': 0.47918925522045924, 'support': 1407201}, 'weighted avg': {'precision': 0.49335276894367497, 'recall': 0.49166252724379816, 'f1-score': 0.4812460398346734, 'support': 1407201}}
[[151147 181605 124471]
 [ 63665 331298  95391]
 [ 85123 165078 209423]]
Evaluating performance on  train set...
2058/2058 - 16s - 16s/epoch - 8ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0030283
{'0': {'precision': 0.5339549665697239, 'recall': 0.3164206860608358, 'f1-score': 0.39736414448117746, 'support': 168848}, '1': {'precision': 0.4788168775280011, 'recall': 0.7115768569628768, 'f1-score': 0.5724408637245976, 'support': 187322}, '2': {'precision': 0.49246207449640456, 'recall': 0.4281938893902282, 'f1-score': 0.45808479894181553, 'support': 170654}, 'accuracy': 0.4931324313243132, 'macro avg': {'precision': 0.5017446395313765, 'recall': 0.48539714413798024, 'f1-score': 0.47596326904919684, 'support': 526824}, 'weighted avg': {'precision': 0.5009088162057431, 'recall': 0.4931324313243132, 'f1-score': 0.4792851347330294, 'support': 526824}}
[[ 53427  74253  41168]
 [ 19886 133294  34142]
 [ 26746  70835  73073]]
Evaluating performance on  val set...
681/681 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0077075
{'0': {'precision': 0.5185307107782624, 'recall': 0.32091135973922347, 'f1-score': 0.39645950877781744, 'support': 58901}, '1': {'precision': 0.46962552358975646, 'recall': 0.6545533997552876, 'f1-score': 0.5468791073984286, 'support': 57210}, '2': {'precision': 0.4822915949611069, 'recall': 0.48162851447033755, 'f1-score': 0.48195982664923986, 'support': 58188}, 'accuracy': 0.4840762138623859, 'macro avg': {'precision': 0.4901492764430419, 'recall': 0.48569775798828285, 'f1-score': 0.4750994809418286, 'support': 174299}, 'weighted avg': {'precision': 0.49038053533134035, 'recall': 0.4840762138623859, 'f1-score': 0.47437503172050494, 'support': 174299}}
[[18902 22646 17353]
 [ 7033 37447 12730]
 [10518 19645 28025]]
training model: results/ATVI/W2/deepVOL_L2/h100
Epoch 1/50
2058/2058 - 48s - loss: 3.2385 - accuracy100: 0.4010 - val_loss: 3.2353 - val_accuracy100: 0.4114 - 48s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 45s - loss: 3.1754 - accuracy100: 0.4323 - val_loss: 3.1949 - val_accuracy100: 0.4245 - 45s/epoch - 22ms/step
Epoch 3/50
2058/2058 - 44s - loss: 3.1528 - accuracy100: 0.4394 - val_loss: 3.2069 - val_accuracy100: 0.4252 - 44s/epoch - 21ms/step
Epoch 4/50
2058/2058 - 44s - loss: 3.1416 - accuracy100: 0.4428 - val_loss: 3.2002 - val_accuracy100: 0.4262 - 44s/epoch - 22ms/step
Epoch 5/50
2058/2058 - 47s - loss: 3.1351 - accuracy100: 0.4453 - val_loss: 3.1942 - val_accuracy100: 0.4253 - 47s/epoch - 23ms/step
Epoch 6/50
2058/2058 - 46s - loss: 3.1297 - accuracy100: 0.4473 - val_loss: 3.1967 - val_accuracy100: 0.4268 - 46s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 48s - loss: 3.1263 - accuracy100: 0.4491 - val_loss: 3.2051 - val_accuracy100: 0.4281 - 48s/epoch - 23ms/step
Epoch 8/50
2058/2058 - 47s - loss: 3.1230 - accuracy100: 0.4499 - val_loss: 3.2033 - val_accuracy100: 0.4263 - 47s/epoch - 23ms/step
Epoch 9/50
2058/2058 - 46s - loss: 3.1205 - accuracy100: 0.4515 - val_loss: 3.2120 - val_accuracy100: 0.4270 - 46s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 48s - loss: 3.1176 - accuracy100: 0.4523 - val_loss: 3.2036 - val_accuracy100: 0.4278 - 48s/epoch - 23ms/step
Epoch 11/50
2058/2058 - 45s - loss: 3.1139 - accuracy100: 0.4543 - val_loss: 3.2003 - val_accuracy100: 0.4294 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 43s - loss: 3.1117 - accuracy100: 0.4548 - val_loss: 3.2120 - val_accuracy100: 0.4262 - 43s/epoch - 21ms/step
Epoch 13/50
2058/2058 - 47s - loss: 3.1087 - accuracy100: 0.4561 - val_loss: 3.2133 - val_accuracy100: 0.4262 - 47s/epoch - 23ms/step
Epoch 14/50
2058/2058 - 44s - loss: 3.1061 - accuracy100: 0.4570 - val_loss: 3.2098 - val_accuracy100: 0.4297 - 44s/epoch - 21ms/step
Epoch 15/50
2058/2058 - 48s - loss: 3.1042 - accuracy100: 0.4580 - val_loss: 3.2166 - val_accuracy100: 0.4277 - 48s/epoch - 23ms/step
testing model: results/ATVI/W2/deepVOL_L2/h100
Evaluating performance on  test set...
5497/5497 - 51s - 51s/epoch - 9ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0645818
{'0': {'precision': 0.43981135970274865, 'recall': 0.29476117300005533, 'f1-score': 0.35296531387508717, 'support': 469838}, '1': {'precision': 0.4086131897130706, 'recall': 0.5008344137346296, 'f1-score': 0.4500480215426757, 'support': 445822}, '2': {'precision': 0.43854911838790933, 'recall': 0.4870254973644111, 'f1-score': 0.46151784819204644, 'support': 491541}, 'accuracy': 0.4272069164248746, 'macro avg': {'precision': 0.42899122260124284, 'recall': 0.4275403613663653, 'f1-score': 0.42151039453660316, 'support': 1407201}, 'weighted avg': {'precision': 0.429486414013202, 'recall': 0.4272069164248746, 'f1-score': 0.42164038457818653, 'support': 1407201}}
[[138490 160573 170775]
 [ 86832 223283 135707]
 [ 89563 162585 239393]]
Evaluating performance on  train set...
2058/2058 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0607439
{'0': {'precision': 0.45982761008031015, 'recall': 0.3012233976212343, 'f1-score': 0.3639988216999034, 'support': 176394}, '1': {'precision': 0.4145004840801564, 'recall': 0.5192389103099507, 'f1-score': 0.4609953932966626, 'support': 174802}, '2': {'precision': 0.432402496099844, 'recall': 0.4734495638508666, 'f1-score': 0.45199604270400734, 'support': 175628}, 'accuracy': 0.4309769486583755, 'macro avg': {'precision': 0.43557686342010354, 'recall': 0.4313039572606839, 'f1-score': 0.42566341923352446, 'support': 526824}, 'weighted avg': {'precision': 0.43564516927039987, 'recall': 0.4309769486583755, 'f1-score': 0.42551836264482135, 'support': 526824}}
[[53134 66813 56447]
 [31336 90764 52702]
 [31082 61395 83151]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0649035
{'0': {'precision': 0.4498871704551709, 'recall': 0.2738358458961474, 'f1-score': 0.3404485724400758, 'support': 59700}, '1': {'precision': 0.41084115023835155, 'recall': 0.48130933722459424, 'f1-score': 0.4432922124789488, 'support': 55509}, '2': {'precision': 0.427499965721024, 'recall': 0.527635809781689, 'f1-score': 0.4723187977670219, 'support': 59090}, 'accuracy': 0.42595195612137765, 'macro avg': {'precision': 0.42940942880484884, 'recall': 0.42759366430081025, 'f1-score': 0.4186865275620155, 'support': 174299}, 'weighted avg': {'precision': 0.4298625836017973, 'recall': 0.42595195612137765, 'f1-score': 0.4179071879770958, 'support': 174299}}
[[16348 20239 23113]
 [10152 26717 18640]
 [ 9838 18074 31178]]
training model: results/ATVI/W2/deepVOL_L2/h200
Epoch 1/50
2058/2058 - 48s - loss: 3.2811 - accuracy200: 0.3765 - val_loss: 3.3209 - val_accuracy200: 0.3461 - 48s/epoch - 24ms/step
Epoch 2/50
2058/2058 - 47s - loss: 3.2472 - accuracy200: 0.3972 - val_loss: 3.3835 - val_accuracy200: 0.3458 - 47s/epoch - 23ms/step
Epoch 3/50
2058/2058 - 49s - loss: 3.2338 - accuracy200: 0.4027 - val_loss: 3.3540 - val_accuracy200: 0.3546 - 49s/epoch - 24ms/step
Epoch 4/50
2058/2058 - 44s - loss: 3.2268 - accuracy200: 0.4051 - val_loss: 3.3861 - val_accuracy200: 0.3585 - 44s/epoch - 21ms/step
Epoch 5/50
2058/2058 - 44s - loss: 3.2218 - accuracy200: 0.4083 - val_loss: 3.3779 - val_accuracy200: 0.3568 - 44s/epoch - 22ms/step
Epoch 6/50
2058/2058 - 45s - loss: 3.2181 - accuracy200: 0.4100 - val_loss: 3.3662 - val_accuracy200: 0.3625 - 45s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 46s - loss: 3.2144 - accuracy200: 0.4113 - val_loss: 3.3653 - val_accuracy200: 0.3630 - 46s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 48s - loss: 3.2116 - accuracy200: 0.4135 - val_loss: 3.3518 - val_accuracy200: 0.3652 - 48s/epoch - 23ms/step
Epoch 9/50
2058/2058 - 47s - loss: 3.2083 - accuracy200: 0.4149 - val_loss: 3.3544 - val_accuracy200: 0.3686 - 47s/epoch - 23ms/step
Epoch 10/50
2058/2058 - 44s - loss: 3.2057 - accuracy200: 0.4164 - val_loss: 3.3516 - val_accuracy200: 0.3691 - 44s/epoch - 21ms/step
Epoch 11/50
2058/2058 - 46s - loss: 3.2025 - accuracy200: 0.4186 - val_loss: 3.3484 - val_accuracy200: 0.3709 - 46s/epoch - 22ms/step
testing model: results/ATVI/W2/deepVOL_L2/h200
Evaluating performance on  test set...
5497/5497 - 41s - 41s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1124742
{'0': {'precision': 0.40209951149979956, 'recall': 0.05702223532384402, 'f1-score': 0.09988031770209987, 'support': 474920}, '1': {'precision': 0.3070685118815152, 'recall': 0.8060567175073866, 'f1-score': 0.44472019895367193, 'support': 430167}, '2': {'precision': 0.42296390883932006, 'recall': 0.17745372564796041, 'f1-score': 0.25001438041457685, 'support': 502114}, 'accuracy': 0.32896650869349864, 'macro avg': {'precision': 0.3773773107402116, 'recall': 0.3468442261597304, 'f1-score': 0.26487163235678285, 'support': 1407201}, 'weighted avg': {'precision': 0.3804942866548325, 'recall': 0.32896650869349864, 'f1-score': 0.25886482095583385, 'support': 1407201}}
[[ 27081 388310  59529]
 [ 21398 346739  62030]
 [ 18870 394142  89102]]
Evaluating performance on  train set...
2058/2058 - 15s - 15s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1040912
{'0': {'precision': 0.4095976400370459, 'recall': 0.06785121712844057, 'f1-score': 0.11641748845915735, 'support': 175988}, '1': {'precision': 0.33471417138770576, 'recall': 0.781270226996582, 'f1-score': 0.4686485170180627, 'support': 176126}, '2': {'precision': 0.39694806394972737, 'recall': 0.19668593669509474, 'f1-score': 0.26303783709305795, 'support': 174710}, 'accuracy': 0.3490843241765751, 'macro avg': {'precision': 0.3804199584581596, 'recall': 0.34860246027337244, 'f1-score': 0.28270128085675933, 'support': 526824}, 'weighted avg': {'precision': 0.380367891131246, 'recall': 0.3490843241765751, 'f1-score': 0.28279768990365217, 'support': 526824}}
[[ 11941 140499  23548]
 [  9867 137602  28657]
 [  7345 133002  34363]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069889
{'0': {'precision': 0.41951837769328265, 'recall': 0.05054464013030643, 'f1-score': 0.0902194157997547, 'support': 58938}, '1': {'precision': 0.33096434434676314, 'recall': 0.814656077251417, 'f1-score': 0.4707006079718605, 'support': 57164}, '2': {'precision': 0.4063266769846363, 'recall': 0.18495798752513015, 'f1-score': 0.25420366521821275, 'support': 58197}, 'accuracy': 0.34602608161836845, 'macro avg': {'precision': 0.3856031330082274, 'recall': 0.3500529016356178, 'f1-score': 0.27170789632994263, 'support': 174299}, 'weighted avg': {'precision': 0.3860711395085453, 'recall': 0.34602608161836845, 'f1-score': 0.2697569818944096, 'support': 174299}}
[[ 2979 48509  7450]
 [ 2318 46569  8277]
 [ 1804 45629 10764]]
training model: results/ATVI/W2/deepVOL_L2/h300
Epoch 1/50
2058/2058 - 47s - loss: 3.2998 - accuracy300: 0.3604 - val_loss: 3.3147 - val_accuracy300: 0.3233 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 47s - loss: 3.2803 - accuracy300: 0.3675 - val_loss: 3.3151 - val_accuracy300: 0.3311 - 47s/epoch - 23ms/step
Epoch 3/50
2058/2058 - 45s - loss: 3.2678 - accuracy300: 0.3810 - val_loss: 3.3265 - val_accuracy300: 0.3333 - 45s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 50s - loss: 3.2615 - accuracy300: 0.3863 - val_loss: 3.3519 - val_accuracy300: 0.3372 - 50s/epoch - 24ms/step
Epoch 5/50
2058/2058 - 48s - loss: 3.2563 - accuracy300: 0.3894 - val_loss: 3.3377 - val_accuracy300: 0.3472 - 48s/epoch - 23ms/step
Epoch 6/50
2058/2058 - 44s - loss: 3.2523 - accuracy300: 0.3923 - val_loss: 3.3679 - val_accuracy300: 0.3433 - 44s/epoch - 21ms/step
Epoch 7/50
2058/2058 - 46s - loss: 3.2489 - accuracy300: 0.3944 - val_loss: 3.3661 - val_accuracy300: 0.3447 - 46s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 46s - loss: 3.2459 - accuracy300: 0.3966 - val_loss: 3.3657 - val_accuracy300: 0.3488 - 46s/epoch - 23ms/step
Epoch 9/50
2058/2058 - 46s - loss: 3.2421 - accuracy300: 0.3992 - val_loss: 3.3830 - val_accuracy300: 0.3504 - 46s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 45s - loss: 3.2396 - accuracy300: 0.4013 - val_loss: 3.3737 - val_accuracy300: 0.3511 - 45s/epoch - 22ms/step
Epoch 11/50
2058/2058 - 47s - loss: 3.2372 - accuracy300: 0.4021 - val_loss: 3.3857 - val_accuracy300: 0.3512 - 47s/epoch - 23ms/step
testing model: results/ATVI/W2/deepVOL_L2/h300
Evaluating performance on  test set...
5497/5497 - 53s - 53s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1113498
{'0': {'precision': 0.38070175438596493, 'recall': 0.0008954620295213611, 'f1-score': 0.0017867214484794344, 'support': 484666}, '1': {'precision': 0.29267541371591, 'recall': 0.9354418133122778, 'f1-score': 0.44585453846426354, 'support': 410343}, '2': {'precision': 0.37403869548200097, 'recall': 0.06903465887792078, 'f1-score': 0.11655692447154807, 'support': 512192}, 'accuracy': 0.29821255101438954, 'macro avg': {'precision': 0.3491386211946253, 'recall': 0.33512397807324, 'f1-score': 0.18806606146143034, 'support': 1407201}, 'weighted avg': {'precision': 0.35260785864846084, 'recall': 0.29821255101438954, 'f1-score': 0.17305187835534597, 'support': 1407201}}
[[   434 451246  32986]
 [   303 383852  26188]
 [   403 476430  35359]]
Evaluating performance on  train set...
2058/2058 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1070161
{'0': {'precision': 0.3804878048780488, 'recall': 0.0008705940129919414, 'f1-score': 0.001737213109277386, 'support': 179188}, '1': {'precision': 0.32281048481576186, 'recall': 0.9344338676763745, 'f1-score': 0.4798511112894653, 'support': 169554}, '2': {'precision': 0.3505012777668567, 'recall': 0.07008569086151324, 'f1-score': 0.11681352981641718, 'support': 178082}, 'accuracy': 0.324727043566732, 'macro avg': {'precision': 0.35126652248688917, 'recall': 0.33513005085029324, 'f1-score': 0.19946728473838662, 'support': 526824}, 'weighted avg': {'precision': 0.3517885029349781, 'recall': 0.324727043566732, 'f1-score': 0.19451344297709747, 'support': 526824}}
[[   156 166890  12142]
 [   131 158437  10986]
 [   123 165478  12481]]
Evaluating performance on  val set...
681/681 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1071739
{'0': {'precision': 0.3007518796992481, 'recall': 0.0006718962592175768, 'f1-score': 0.0013407971038782555, 'support': 59533}, '1': {'precision': 0.3217821782178218, 'recall': 0.9342820366132724, 'f1-score': 0.47869417066647124, 'support': 55936}, '2': {'precision': 0.3534614730396326, 'recall': 0.07064422913479518, 'f1-score': 0.11775372584575282, 'support': 58830}, 'accuracy': 0.32390317787250644, 'macro avg': {'precision': 0.32533184365223417, 'recall': 0.3351993873357617, 'f1-score': 0.1992628978720341, 'support': 174299}, 'weighted avg': {'precision': 0.3252916427165331, 'recall': 0.32390317787250644, 'f1-score': 0.19382503913327417, 'support': 174299}}
[[   40 55524  3969]
 [   43 52260  3633]
 [   50 54624  4156]]
training model: results/ATVI/W2/deepVOL_L2/h500
Epoch 1/50
2058/2058 - 50s - loss: 3.2305 - accuracy500: 0.4113 - val_loss: 3.6508 - val_accuracy500: 0.3488 - 50s/epoch - 24ms/step
Epoch 2/50
2058/2058 - 47s - loss: 3.2393 - accuracy500: 0.4002 - val_loss: 3.4439 - val_accuracy500: 0.3490 - 47s/epoch - 23ms/step
Epoch 3/50
2058/2058 - 46s - loss: 3.2335 - accuracy500: 0.4010 - val_loss: 3.4102 - val_accuracy500: 0.3491 - 46s/epoch - 22ms/step
Epoch 4/50
2058/2058 - 49s - loss: 3.2397 - accuracy500: 0.3914 - val_loss: 3.4232 - val_accuracy500: 0.3489 - 49s/epoch - 24ms/step
Epoch 5/50
2058/2058 - 49s - loss: 3.2508 - accuracy500: 0.3800 - val_loss: 3.3793 - val_accuracy500: 0.3489 - 49s/epoch - 24ms/step
Epoch 6/50
2058/2058 - 48s - loss: 3.2520 - accuracy500: 0.3829 - val_loss: 3.5488 - val_accuracy500: 0.3488 - 48s/epoch - 23ms/step
Epoch 7/50
2058/2058 - 45s - loss: 3.2529 - accuracy500: 0.3833 - val_loss: 3.5677 - val_accuracy500: 0.3488 - 45s/epoch - 22ms/step
Epoch 8/50
2058/2058 - 48s - loss: 3.2573 - accuracy500: 0.3774 - val_loss: 3.3886 - val_accuracy500: 0.3488 - 48s/epoch - 23ms/step
Epoch 9/50
2058/2058 - 44s - loss: 3.2536 - accuracy500: 0.3783 - val_loss: 3.6268 - val_accuracy500: 0.3488 - 44s/epoch - 22ms/step
Epoch 10/50
2058/2058 - 48s - loss: 3.2511 - accuracy500: 0.3822 - val_loss: 3.4009 - val_accuracy500: 0.3488 - 48s/epoch - 23ms/step
Epoch 11/50
2058/2058 - 45s - loss: 3.2507 - accuracy500: 0.3829 - val_loss: 3.5664 - val_accuracy500: 0.3489 - 45s/epoch - 22ms/step
Epoch 12/50
2058/2058 - 49s - loss: 3.2440 - accuracy500: 0.3888 - val_loss: 3.6111 - val_accuracy500: 0.3488 - 49s/epoch - 24ms/step
Epoch 13/50
2058/2058 - 45s - loss: 3.2495 - accuracy500: 0.3833 - val_loss: 3.4009 - val_accuracy500: 0.3489 - 45s/epoch - 22ms/step
Epoch 14/50
2058/2058 - 47s - loss: 3.2442 - accuracy500: 0.3869 - val_loss: 3.5552 - val_accuracy500: 0.3490 - 47s/epoch - 23ms/step
Epoch 15/50
2058/2058 - 47s - loss: 3.2368 - accuracy500: 0.3923 - val_loss: 3.5396 - val_accuracy500: 0.3489 - 47s/epoch - 23ms/step
testing model: results/ATVI/W2/deepVOL_L2/h500
Evaluating performance on  test set...
5497/5497 - 48s - 48s/epoch - 9ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1422709
{'0': {'precision': 0.3713151927437642, 'recall': 0.0014119087497386352, 'f1-score': 0.0028131207387126216, 'support': 463911}, '1': {'precision': 0.31231170030526995, 'recall': 0.9977576280485445, 'f1-score': 0.47571739077343883, 'support': 439267}, '2': {'precision': 0.3757778841550981, 'recall': 0.001557468607583384, 'f1-score': 0.0031020801719777442, 'support': 504023}, 'accuracy': 0.3124798802729674, 'macro avg': {'precision': 0.3531349257347107, 'recall': 0.3335756684686222, 'f1-score': 0.16054419722804306, 'support': 1407201}, 'weighted avg': {'precision': 0.3544952871298787, 'recall': 0.3124798802729674, 'f1-score': 0.15053678081696487, 'support': 1407201}}
[[   655 462462    794]
 [   475 438282    510]
 [   634 502604    785]]
Evaluating performance on  train set...
2058/2058 - 20s - 20s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1281291
{'0': {'precision': 0.3746958637469586, 'recall': 0.0008739671297557432, 'f1-score': 0.0017438667414038126, 'support': 176208}, '1': {'precision': 0.3407436987174002, 'recall': 0.9987292386578976, 'f1-score': 0.5081262716129901, 'support': 179420}, '2': {'precision': 0.32954545454545453, 'recall': 0.0010163788873571813, 'f1-score': 0.002026507651813375, 'support': 171196}, 'accuracy': 0.340758963145187, 'macro avg': {'precision': 0.34832833900327115, 'recall': 0.33353986155833687, 'f1-score': 0.1706322153354024, 'support': 526824}, 'weighted avg': {'precision': 0.34846078921872137, 'recall': 0.340758963145187, 'f1-score': 0.1742939367369972, 'support': 526824}}
[[   154 175833    221]
 [    95 179192    133]
 [   162 170860    174]]
Evaluating performance on  val set...
681/681 - 7s - 7s/epoch - 10ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1227628
{'0': {'precision': 0.40609137055837563, 'recall': 0.0013968431345159939, 'f1-score': 0.0027841096939219406, 'support': 57272}, '1': {'precision': 0.3490059138918931, 'recall': 0.9979109780570451, 'f1-score': 0.5171467296331972, 'support': 60794}, '2': {'precision': 0.3357664233576642, 'recall': 0.0016360500062241033, 'f1-score': 0.0032562337409524486, 'support': 56233}, 'accuracy': 0.3490496216272038, 'macro avg': {'precision': 0.36362123593597767, 'recall': 0.33364795706592837, 'f1-score': 0.1743956910226905, 'support': 174299}, 'weighted avg': {'precision': 0.36349195226842707, 'recall': 0.3490496216272038, 'f1-score': 0.18234170938253158, 'support': 174299}}
[[   80 57081   111]
 [   56 60667    71]
 [   61 56080    92]]
training model: results/ATVI/W2/deepVOL_L2/h1000
Epoch 1/50
2058/2058 - 47s - loss: 3.2909 - accuracy1000: 0.3745 - val_loss: 3.3516 - val_accuracy1000: 0.3243 - 47s/epoch - 23ms/step
Epoch 2/50
2058/2058 - 43s - loss: 3.2688 - accuracy1000: 0.3765 - val_loss: 3.3645 - val_accuracy1000: 0.3251 - 43s/epoch - 21ms/step
Epoch 3/50
2058/2058 - 48s - loss: 3.2617 - accuracy1000: 0.3800 - val_loss: 3.3715 - val_accuracy1000: 0.3265 - 48s/epoch - 23ms/step
Epoch 4/50
2058/2058 - 48s - loss: 3.2565 - accuracy1000: 0.3832 - val_loss: 3.3629 - val_accuracy1000: 0.3312 - 48s/epoch - 24ms/step
Epoch 5/50
2058/2058 - 49s - loss: 3.2545 - accuracy1000: 0.3863 - val_loss: 3.3660 - val_accuracy1000: 0.3339 - 49s/epoch - 24ms/step
Epoch 6/50
2058/2058 - 45s - loss: 3.2501 - accuracy1000: 0.3896 - val_loss: 3.3575 - val_accuracy1000: 0.3371 - 45s/epoch - 22ms/step
Epoch 7/50
2058/2058 - 43s - loss: 3.2466 - accuracy1000: 0.3923 - val_loss: 3.3738 - val_accuracy1000: 0.3321 - 43s/epoch - 21ms/step
Epoch 8/50
2058/2058 - 49s - loss: 3.2408 - accuracy1000: 0.3967 - val_loss: 3.3615 - val_accuracy1000: 0.3372 - 49s/epoch - 24ms/step
Epoch 9/50
2058/2058 - 49s - loss: 3.2372 - accuracy1000: 0.3992 - val_loss: 3.3618 - val_accuracy1000: 0.3463 - 49s/epoch - 24ms/step
Epoch 10/50
2058/2058 - 48s - loss: 3.2330 - accuracy1000: 0.4018 - val_loss: 3.3560 - val_accuracy1000: 0.3433 - 48s/epoch - 24ms/step
Epoch 11/50
2058/2058 - 48s - loss: 3.2280 - accuracy1000: 0.4050 - val_loss: 3.3607 - val_accuracy1000: 0.3509 - 48s/epoch - 23ms/step
testing model: results/ATVI/W2/deepVOL_L2/h1000
Evaluating performance on  test set...
5497/5497 - 47s - 47s/epoch - 9ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1156116
{'0': {'precision': 0.27586206896551724, 'recall': 1.7615247758459724e-05, 'f1-score': 3.522824600764893e-05, 'support': 454152}, '1': {'precision': 0.3181426111057251, 'recall': 0.9977799439284932, 'f1-score': 0.48245440501942066, 'support': 447286}, '2': {'precision': 0.37557286892758934, 'recall': 0.0032406482878344204, 'f1-score': 0.006425850817541513, 'support': 505763}, 'accuracy': 0.31831984201261937, 'macro avg': {'precision': 0.32319251633294394, 'recall': 0.3336794024880287, 'f1-score': 0.1629718280276566, 'support': 1407201}, 'weighted avg': {'precision': 0.3251382760552951, 'recall': 0.31831984201261937, 'f1-score': 0.15567147661842887, 'support': 1407201}}
[[     8 452405   1739]
 [     7 446293    986]
 [    14 504110   1639]]
Evaluating performance on  train set...
2058/2058 - 17s - 17s/epoch - 8ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1208671
{'0': {'precision': 0.45454545454545453, 'recall': 2.7531220403938066e-05, 'f1-score': 5.505910595023758e-05, 'support': 181612}, '1': {'precision': 0.32964819528502864, 'recall': 0.9975400250030245, 'f1-score': 0.49553976435302977, 'support': 173579}, '2': {'precision': 0.30838709677419357, 'recall': 0.0027850122062773475, 'f1-score': 0.005520172303286119, 'support': 171633}, 'accuracy': 0.3295882495861996, 'macro avg': {'precision': 0.3641935822015589, 'recall': 0.3334508561432352, 'f1-score': 0.16703833192075537, 'support': 526824}, 'weighted avg': {'precision': 0.3657774052832336, 'recall': 0.3295882495861996, 'f1-score': 0.1650887960379829, 'support': 526824}}
[[     5 180959    648]
 [     3 173152    424]
 [     3 171152    478]]
Evaluating performance on  val set...
681/681 - 5s - 5s/epoch - 7ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1209997
{'0': {'precision': 0.3333333333333333, 'recall': 1.6835300257580095e-05, 'f1-score': 3.366890003703579e-05, 'support': 59399}, '1': {'precision': 0.3241985492490264, 'recall': 0.9982288032023238, 'f1-score': 0.4894398610508033, 'support': 56459}, '2': {'precision': 0.38461538461538464, 'recall': 0.0029944730582981125, 'f1-score': 0.005942678619940234, 'support': 58441}, 'accuracy': 0.3243564220104533, 'macro avg': {'precision': 0.3473824223992481, 'recall': 0.3337467038536264, 'f1-score': 0.16513873619026018, 'support': 174299}, 'weighted avg': {'precision': 0.34756883430785684, 'recall': 0.3243564220104533, 'f1-score': 0.16054355501344544, 'support': 174299}}
[[    1 59217   181]
 [    1 56359    99]
 [    1 58265   175]]
training model: results/ATVI/W2/deepVOL_L3/h10
Epoch 1/50
2058/2058 - 72s - loss: 3.1897 - accuracy10: 0.4106 - val_loss: 3.3766 - val_accuracy10: 0.4472 - 72s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 70s - loss: 2.8478 - accuracy10: 0.4612 - val_loss: 3.1639 - val_accuracy10: 0.5532 - 70s/epoch - 34ms/step
Epoch 3/50
2058/2058 - 70s - loss: 2.6755 - accuracy10: 0.5495 - val_loss: 3.0609 - val_accuracy10: 0.5457 - 70s/epoch - 34ms/step
Epoch 4/50
2058/2058 - 68s - loss: 2.6194 - accuracy10: 0.5710 - val_loss: 2.9792 - val_accuracy10: 0.5673 - 68s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 69s - loss: 2.5951 - accuracy10: 0.5790 - val_loss: 2.9331 - val_accuracy10: 0.5644 - 69s/epoch - 33ms/step
Epoch 6/50
2058/2058 - 68s - loss: 2.5768 - accuracy10: 0.5829 - val_loss: 2.9184 - val_accuracy10: 0.5455 - 68s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 67s - loss: 2.5596 - accuracy10: 0.5864 - val_loss: 2.9023 - val_accuracy10: 0.5463 - 67s/epoch - 33ms/step
Epoch 8/50
2058/2058 - 68s - loss: 2.5465 - accuracy10: 0.5896 - val_loss: 2.9006 - val_accuracy10: 0.5564 - 68s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 2.5384 - accuracy10: 0.5915 - val_loss: 2.8797 - val_accuracy10: 0.5603 - 67s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 68s - loss: 2.5278 - accuracy10: 0.5930 - val_loss: 2.8671 - val_accuracy10: 0.5614 - 68s/epoch - 33ms/step
Epoch 11/50
2058/2058 - 70s - loss: 2.5208 - accuracy10: 0.5946 - val_loss: 2.8512 - val_accuracy10: 0.5631 - 70s/epoch - 34ms/step
Epoch 12/50
2058/2058 - 68s - loss: 2.5134 - accuracy10: 0.5964 - val_loss: 2.8473 - val_accuracy10: 0.5648 - 68s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 68s - loss: 2.5065 - accuracy10: 0.5979 - val_loss: 2.8429 - val_accuracy10: 0.5671 - 68s/epoch - 33ms/step
Epoch 14/50
2058/2058 - 68s - loss: 2.4989 - accuracy10: 0.5990 - val_loss: 2.8571 - val_accuracy10: 0.5624 - 68s/epoch - 33ms/step
Epoch 15/50
2058/2058 - 68s - loss: 2.4920 - accuracy10: 0.6003 - val_loss: 2.8436 - val_accuracy10: 0.5779 - 68s/epoch - 33ms/step
Epoch 16/50
2058/2058 - 70s - loss: 2.4860 - accuracy10: 0.6021 - val_loss: 2.8385 - val_accuracy10: 0.5651 - 70s/epoch - 34ms/step
Epoch 17/50
2058/2058 - 68s - loss: 2.4786 - accuracy10: 0.6023 - val_loss: 2.8426 - val_accuracy10: 0.5687 - 68s/epoch - 33ms/step
Epoch 18/50
2058/2058 - 68s - loss: 2.4722 - accuracy10: 0.6034 - val_loss: 2.8253 - val_accuracy10: 0.5731 - 68s/epoch - 33ms/step
Epoch 19/50
2058/2058 - 69s - loss: 2.4663 - accuracy10: 0.6054 - val_loss: 2.8239 - val_accuracy10: 0.5723 - 69s/epoch - 34ms/step
Epoch 20/50
2058/2058 - 68s - loss: 2.4607 - accuracy10: 0.6050 - val_loss: 2.8269 - val_accuracy10: 0.5716 - 68s/epoch - 33ms/step
Epoch 21/50
2058/2058 - 69s - loss: 2.4551 - accuracy10: 0.6059 - val_loss: 2.8165 - val_accuracy10: 0.5677 - 69s/epoch - 34ms/step
Epoch 22/50
2058/2058 - 68s - loss: 2.4501 - accuracy10: 0.6069 - val_loss: 2.8213 - val_accuracy10: 0.5753 - 68s/epoch - 33ms/step
Epoch 23/50
2058/2058 - 67s - loss: 2.4456 - accuracy10: 0.6079 - val_loss: 2.7996 - val_accuracy10: 0.5758 - 67s/epoch - 33ms/step
Epoch 24/50
2058/2058 - 67s - loss: 2.4412 - accuracy10: 0.6080 - val_loss: 2.8004 - val_accuracy10: 0.5772 - 67s/epoch - 33ms/step
Epoch 25/50
2058/2058 - 70s - loss: 2.4386 - accuracy10: 0.6079 - val_loss: 2.7969 - val_accuracy10: 0.5798 - 70s/epoch - 34ms/step
Epoch 26/50
2058/2058 - 68s - loss: 2.4326 - accuracy10: 0.6095 - val_loss: 2.7933 - val_accuracy10: 0.5783 - 68s/epoch - 33ms/step
Epoch 27/50
2058/2058 - 67s - loss: 2.4299 - accuracy10: 0.6094 - val_loss: 2.7933 - val_accuracy10: 0.5722 - 67s/epoch - 33ms/step
Epoch 28/50
2058/2058 - 69s - loss: 2.4251 - accuracy10: 0.6109 - val_loss: 2.8089 - val_accuracy10: 0.5731 - 69s/epoch - 34ms/step
Epoch 29/50
2058/2058 - 67s - loss: 2.4226 - accuracy10: 0.6101 - val_loss: 2.8044 - val_accuracy10: 0.5807 - 67s/epoch - 33ms/step
Epoch 30/50
2058/2058 - 69s - loss: 2.4181 - accuracy10: 0.6105 - val_loss: 2.8017 - val_accuracy10: 0.5752 - 69s/epoch - 34ms/step
Epoch 31/50
2058/2058 - 68s - loss: 2.4163 - accuracy10: 0.6115 - val_loss: 2.7939 - val_accuracy10: 0.5676 - 68s/epoch - 33ms/step
Epoch 32/50
2058/2058 - 70s - loss: 2.4116 - accuracy10: 0.6118 - val_loss: 2.7983 - val_accuracy10: 0.5795 - 70s/epoch - 34ms/step
Epoch 33/50
2058/2058 - 67s - loss: 2.4093 - accuracy10: 0.6125 - val_loss: 2.7877 - val_accuracy10: 0.5710 - 67s/epoch - 32ms/step
Epoch 34/50
2058/2058 - 68s - loss: 2.4050 - accuracy10: 0.6126 - val_loss: 2.7987 - val_accuracy10: 0.5786 - 68s/epoch - 33ms/step
Epoch 35/50
2058/2058 - 67s - loss: 2.4034 - accuracy10: 0.6129 - val_loss: 2.8060 - val_accuracy10: 0.5735 - 67s/epoch - 32ms/step
Epoch 36/50
2058/2058 - 68s - loss: 2.4005 - accuracy10: 0.6129 - val_loss: 2.7839 - val_accuracy10: 0.5760 - 68s/epoch - 33ms/step
Epoch 37/50
2058/2058 - 67s - loss: 2.3967 - accuracy10: 0.6138 - val_loss: 2.7961 - val_accuracy10: 0.5816 - 67s/epoch - 33ms/step
Epoch 38/50
2058/2058 - 67s - loss: 2.3945 - accuracy10: 0.6136 - val_loss: 2.8116 - val_accuracy10: 0.5739 - 67s/epoch - 32ms/step
Epoch 39/50
2058/2058 - 68s - loss: 2.3905 - accuracy10: 0.6139 - val_loss: 2.8032 - val_accuracy10: 0.5744 - 68s/epoch - 33ms/step
Epoch 40/50
2058/2058 - 67s - loss: 2.3886 - accuracy10: 0.6152 - val_loss: 2.8160 - val_accuracy10: 0.5782 - 67s/epoch - 33ms/step
Epoch 41/50
2058/2058 - 67s - loss: 2.3844 - accuracy10: 0.6155 - val_loss: 2.8074 - val_accuracy10: 0.5759 - 67s/epoch - 32ms/step
Epoch 42/50
2058/2058 - 67s - loss: 2.3823 - accuracy10: 0.6161 - val_loss: 2.8141 - val_accuracy10: 0.5747 - 67s/epoch - 33ms/step
Epoch 43/50
2058/2058 - 68s - loss: 2.3803 - accuracy10: 0.6157 - val_loss: 2.8055 - val_accuracy10: 0.5814 - 68s/epoch - 33ms/step
Epoch 44/50
2058/2058 - 68s - loss: 2.3772 - accuracy10: 0.6165 - val_loss: 2.8157 - val_accuracy10: 0.5747 - 68s/epoch - 33ms/step
Epoch 45/50
2058/2058 - 68s - loss: 2.3752 - accuracy10: 0.6162 - val_loss: 2.7966 - val_accuracy10: 0.5723 - 68s/epoch - 33ms/step
Epoch 46/50
2058/2058 - 67s - loss: 2.3709 - accuracy10: 0.6172 - val_loss: 2.8048 - val_accuracy10: 0.5799 - 67s/epoch - 33ms/step
testing model: results/ATVI/W2/deepVOL_L3/h10
Evaluating performance on  test set...
5497/5497 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.860146
{'0': {'precision': 0.40518231829024876, 'recall': 0.6098979210481962, 'f1-score': 0.4868971811169645, 'support': 272926}, '1': {'precision': 0.8310424447667117, 'recall': 0.5904731203840685, 'f1-score': 0.6904014807336362, 'support': 868595}, '2': {'precision': 0.3850316170304779, 'recall': 0.5495859680819031, 'f1-score': 0.45282258189565616, 'support': 265680}, 'accuracy': 0.5865210442573591, 'macro avg': {'precision': 0.5404187933624794, 'recall': 0.5833190031713893, 'f1-score': 0.5433737479154189, 'support': 1407201}, 'weighted avg': {'precision': 0.6642400778044385, 'recall': 0.5865210442573591, 'f1-score': 0.6060769412254535, 'support': 1407201}}
[[166457  60983  45486]
 [167987 512882 187726]
 [ 76376  43290 146014]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8197235
{'0': {'precision': 0.4358517540965578, 'recall': 0.62116525955028, 'f1-score': 0.512264163137282, 'support': 95704}, '1': {'precision': 0.8414401175606172, 'recall': 0.6171810440843603, 'f1-score': 0.7120709666721936, 'support': 333996}, '2': {'precision': 0.39994087274577345, 'recall': 0.5989353815740702, 'f1-score': 0.4796164453587167, 'support': 97124}, 'accuracy': 0.6145410991146949, 'macro avg': {'precision': 0.5590775814676495, 'recall': 0.6124272284029035, 'f1-score': 0.5679838583893974, 'support': 526824}, 'weighted avg': {'precision': 0.6863663141834718, 'recall': 0.6145410991146949, 'f1-score': 0.6329188717532922, 'support': 526824}}
[[ 59448  21635  14621]
 [ 55203 206136  72657]
 [ 21744  17209  58171]]
Evaluating performance on  val set...
681/681 - 10s - 10s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 0.8774539
{'0': {'precision': 0.4241101736010086, 'recall': 0.6162453143936191, 'f1-score': 0.5024357737028355, 'support': 35481}, '1': {'precision': 0.8237058525319664, 'recall': 0.5643373307991394, 'f1-score': 0.6697889053652504, 'support': 103649}, '2': {'precision': 0.3865499110801825, 'recall': 0.5685973442520401, 'f1-score': 0.4602248535690038, 'support': 35169}, 'accuracy': 0.5757634868817377, 'macro avg': {'precision': 0.5447886457377191, 'recall': 0.5830599964815996, 'f1-score': 0.5441498442123632, 'support': 174299}, 'weighted avg': {'precision': 0.6541558746831716, 'recall': 0.5757634868817377, 'f1-score': 0.5934372647813322, 'support': 174299}}
[[21865  7273  6343]
 [19764 58493 25392]
 [ 9926  5246 19997]]
training model: results/ATVI/W2/deepVOL_L3/h20
Epoch 1/50
2058/2058 - 74s - loss: 3.2359 - accuracy20: 0.4156 - val_loss: 3.3302 - val_accuracy20: 0.4222 - 74s/epoch - 36ms/step
Epoch 2/50
2058/2058 - 70s - loss: 3.0170 - accuracy20: 0.4217 - val_loss: 3.1051 - val_accuracy20: 0.4674 - 70s/epoch - 34ms/step
Epoch 3/50
2058/2058 - 70s - loss: 2.8278 - accuracy20: 0.5238 - val_loss: 3.0177 - val_accuracy20: 0.5270 - 70s/epoch - 34ms/step
Epoch 4/50
2058/2058 - 69s - loss: 2.7464 - accuracy20: 0.5533 - val_loss: 2.9273 - val_accuracy20: 0.5347 - 69s/epoch - 34ms/step
Epoch 5/50
2058/2058 - 69s - loss: 2.7046 - accuracy20: 0.5653 - val_loss: 2.9090 - val_accuracy20: 0.5376 - 69s/epoch - 34ms/step
Epoch 6/50
2058/2058 - 70s - loss: 2.6784 - accuracy20: 0.5723 - val_loss: 2.9069 - val_accuracy20: 0.5373 - 70s/epoch - 34ms/step
Epoch 7/50
2058/2058 - 69s - loss: 2.6604 - accuracy20: 0.5780 - val_loss: 2.8733 - val_accuracy20: 0.5555 - 69s/epoch - 34ms/step
Epoch 8/50
2058/2058 - 72s - loss: 2.6461 - accuracy20: 0.5809 - val_loss: 2.8417 - val_accuracy20: 0.5539 - 72s/epoch - 35ms/step
Epoch 9/50
2058/2058 - 70s - loss: 2.6343 - accuracy20: 0.5828 - val_loss: 2.8391 - val_accuracy20: 0.5636 - 70s/epoch - 34ms/step
Epoch 10/50
2058/2058 - 71s - loss: 2.6224 - accuracy20: 0.5849 - val_loss: 2.8283 - val_accuracy20: 0.5669 - 71s/epoch - 35ms/step
Epoch 11/50
2058/2058 - 73s - loss: 2.6130 - accuracy20: 0.5862 - val_loss: 2.8107 - val_accuracy20: 0.5627 - 73s/epoch - 35ms/step
Epoch 12/50
2058/2058 - 72s - loss: 2.6046 - accuracy20: 0.5885 - val_loss: 2.8336 - val_accuracy20: 0.5694 - 72s/epoch - 35ms/step
Epoch 13/50
2058/2058 - 72s - loss: 2.5970 - accuracy20: 0.5897 - val_loss: 2.8278 - val_accuracy20: 0.5660 - 72s/epoch - 35ms/step
Epoch 14/50
2058/2058 - 70s - loss: 2.5919 - accuracy20: 0.5903 - val_loss: 2.8249 - val_accuracy20: 0.5722 - 70s/epoch - 34ms/step
Epoch 15/50
2058/2058 - 70s - loss: 2.5858 - accuracy20: 0.5922 - val_loss: 2.8123 - val_accuracy20: 0.5699 - 70s/epoch - 34ms/step
Epoch 16/50
2058/2058 - 72s - loss: 2.5812 - accuracy20: 0.5926 - val_loss: 2.8093 - val_accuracy20: 0.5651 - 72s/epoch - 35ms/step
Epoch 17/50
2058/2058 - 70s - loss: 2.5756 - accuracy20: 0.5937 - val_loss: 2.8083 - val_accuracy20: 0.5683 - 70s/epoch - 34ms/step
Epoch 18/50
2058/2058 - 70s - loss: 2.5711 - accuracy20: 0.5944 - val_loss: 2.7993 - val_accuracy20: 0.5698 - 70s/epoch - 34ms/step
Epoch 19/50
2058/2058 - 70s - loss: 2.5678 - accuracy20: 0.5952 - val_loss: 2.7978 - val_accuracy20: 0.5602 - 70s/epoch - 34ms/step
Epoch 20/50
2058/2058 - 70s - loss: 2.5625 - accuracy20: 0.5959 - val_loss: 2.7988 - val_accuracy20: 0.5704 - 70s/epoch - 34ms/step
Epoch 21/50
2058/2058 - 71s - loss: 2.5598 - accuracy20: 0.5968 - val_loss: 2.7940 - val_accuracy20: 0.5698 - 71s/epoch - 34ms/step
Epoch 22/50
2058/2058 - 71s - loss: 2.5561 - accuracy20: 0.5973 - val_loss: 2.7929 - val_accuracy20: 0.5705 - 71s/epoch - 35ms/step
Epoch 23/50
2058/2058 - 69s - loss: 2.5532 - accuracy20: 0.5972 - val_loss: 2.7833 - val_accuracy20: 0.5703 - 69s/epoch - 34ms/step
Epoch 24/50
2058/2058 - 70s - loss: 2.5490 - accuracy20: 0.5986 - val_loss: 2.7884 - val_accuracy20: 0.5714 - 70s/epoch - 34ms/step
Epoch 25/50
2058/2058 - 69s - loss: 2.5465 - accuracy20: 0.5995 - val_loss: 2.7815 - val_accuracy20: 0.5697 - 69s/epoch - 33ms/step
Epoch 26/50
2058/2058 - 70s - loss: 2.5413 - accuracy20: 0.5996 - val_loss: 2.7815 - val_accuracy20: 0.5623 - 70s/epoch - 34ms/step
Epoch 27/50
2058/2058 - 73s - loss: 2.5391 - accuracy20: 0.6004 - val_loss: 2.7832 - val_accuracy20: 0.5717 - 73s/epoch - 35ms/step
Epoch 28/50
2058/2058 - 72s - loss: 2.5364 - accuracy20: 0.6004 - val_loss: 2.7891 - val_accuracy20: 0.5736 - 72s/epoch - 35ms/step
Epoch 29/50
2058/2058 - 73s - loss: 2.5339 - accuracy20: 0.6006 - val_loss: 2.7892 - val_accuracy20: 0.5681 - 73s/epoch - 35ms/step
Epoch 30/50
2058/2058 - 70s - loss: 2.5304 - accuracy20: 0.6015 - val_loss: 2.7829 - val_accuracy20: 0.5671 - 70s/epoch - 34ms/step
Epoch 31/50
2058/2058 - 72s - loss: 2.5277 - accuracy20: 0.6018 - val_loss: 2.7893 - val_accuracy20: 0.5704 - 72s/epoch - 35ms/step
Epoch 32/50
2058/2058 - 70s - loss: 2.5263 - accuracy20: 0.6017 - val_loss: 2.7842 - val_accuracy20: 0.5652 - 70s/epoch - 34ms/step
Epoch 33/50
2058/2058 - 70s - loss: 2.5238 - accuracy20: 0.6021 - val_loss: 2.7817 - val_accuracy20: 0.5647 - 70s/epoch - 34ms/step
Epoch 34/50
2058/2058 - 69s - loss: 2.5208 - accuracy20: 0.6027 - val_loss: 2.7717 - val_accuracy20: 0.5628 - 69s/epoch - 34ms/step
Epoch 35/50
2058/2058 - 70s - loss: 2.5176 - accuracy20: 0.6031 - val_loss: 2.7835 - val_accuracy20: 0.5667 - 70s/epoch - 34ms/step
Epoch 36/50
2058/2058 - 69s - loss: 2.5153 - accuracy20: 0.6034 - val_loss: 2.7975 - val_accuracy20: 0.5648 - 69s/epoch - 33ms/step
Epoch 37/50
2058/2058 - 70s - loss: 2.5137 - accuracy20: 0.6038 - val_loss: 2.7856 - val_accuracy20: 0.5679 - 70s/epoch - 34ms/step
Epoch 38/50
2058/2058 - 69s - loss: 2.5109 - accuracy20: 0.6039 - val_loss: 2.7889 - val_accuracy20: 0.5610 - 69s/epoch - 34ms/step
Epoch 39/50
2058/2058 - 69s - loss: 2.5091 - accuracy20: 0.6043 - val_loss: 2.7837 - val_accuracy20: 0.5657 - 69s/epoch - 33ms/step
Epoch 40/50
2058/2058 - 68s - loss: 2.5060 - accuracy20: 0.6050 - val_loss: 2.7811 - val_accuracy20: 0.5672 - 68s/epoch - 33ms/step
Epoch 41/50
2058/2058 - 68s - loss: 2.5036 - accuracy20: 0.6045 - val_loss: 2.7806 - val_accuracy20: 0.5599 - 68s/epoch - 33ms/step
Epoch 42/50
2058/2058 - 68s - loss: 2.5017 - accuracy20: 0.6051 - val_loss: 2.7892 - val_accuracy20: 0.5676 - 68s/epoch - 33ms/step
Epoch 43/50
2058/2058 - 67s - loss: 2.4990 - accuracy20: 0.6048 - val_loss: 2.7886 - val_accuracy20: 0.5613 - 67s/epoch - 33ms/step
Epoch 44/50
2058/2058 - 67s - loss: 2.4981 - accuracy20: 0.6051 - val_loss: 2.7895 - val_accuracy20: 0.5614 - 67s/epoch - 32ms/step
testing model: results/ATVI/W2/deepVOL_L3/h20
Evaluating performance on  test set...
5497/5497 - 76s - 76s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.8932699
{'0': {'precision': 0.4566426568824542, 'recall': 0.5868827862275917, 'f1-score': 0.5136352286396206, 'support': 345241}, '1': {'precision': 0.7416352890495872, 'recall': 0.5712056595810844, 'f1-score': 0.645358106619132, 'support': 720336}, '2': {'precision': 0.44802442915447327, 'recall': 0.5359810786127438, 'f1-score': 0.4880716924602434, 'support': 341624}, 'accuracy': 0.5665004501844442, 'macro avg': {'precision': 0.5487674583621716, 'recall': 0.5646898414738066, 'f1-score': 0.549021675906332, 'support': 1407201}, 'weighted avg': {'precision': 0.600436087426776, 'recall': 0.5665004501844442, 'f1-score': 0.5748571958983887, 'support': 1407201}}
[[202616  78526  64099]
 [147387 411460 161489]
 [ 93705  64815 183104]]
Evaluating performance on  train set...
2058/2058 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.85799384
{'0': {'precision': 0.49587676135858144, 'recall': 0.5830349455660249, 'f1-score': 0.5359353850933054, 'support': 124279}, '1': {'precision': 0.7506698701345099, 'recall': 0.6069939009197369, 'f1-score': 0.6712295672764955, 'support': 276927}, '2': {'precision': 0.4622616837929033, 'recall': 0.5769236892801987, 'f1-score': 0.5132668779546379, 'support': 125618}, 'accuracy': 0.5941718676446024, 'macro avg': {'precision': 0.5696027717619981, 'recall': 0.5889841785886535, 'f1-score': 0.573477276774813, 'support': 526824}, 'weighted avg': {'precision': 0.6217943968883716, 'recall': 0.5941718676446024, 'f1-score': 0.6016481078616287, 'support': 526824}}
[[ 72459  30115  21705]
 [ 46234 168093  62600]
 [ 27430  25716  72472]]
Evaluating performance on  val set...
681/681 - 11s - 11s/epoch - 16ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 0.90048474
{'0': {'precision': 0.47977128061279534, 'recall': 0.5933948626709663, 'f1-score': 0.5305680112150648, 'support': 44965}, '1': {'precision': 0.7320968974714939, 'recall': 0.5542382088283224, 'f1-score': 0.6308714908831851, 'support': 84682}, '2': {'precision': 0.44926341248900614, 'recall': 0.5491131416285945, 'f1-score': 0.4941951868424235, 'support': 44652}, 'accuracy': 0.563026752878674, 'macro avg': {'precision': 0.5537105301910984, 'recall': 0.5655820710426277, 'f1-score': 0.551878229646891, 'support': 174299}, 'weighted avg': {'precision': 0.5945464689923321, 'recall': 0.563026752878674, 'f1-score': 0.5699817767063675, 'support': 174299}}
[[26682  9499  8784]
 [16475 46934 21273]
 [12457  7676 24519]]
training model: results/ATVI/W2/deepVOL_L3/h30
Epoch 1/50
2058/2058 - 71s - loss: 3.1869 - accuracy30: 0.4180 - val_loss: 3.3162 - val_accuracy30: 0.4131 - 71s/epoch - 34ms/step
Epoch 2/50
2058/2058 - 67s - loss: 3.0624 - accuracy30: 0.4415 - val_loss: 3.1633 - val_accuracy30: 0.4856 - 67s/epoch - 33ms/step
Epoch 3/50
2058/2058 - 66s - loss: 2.8959 - accuracy30: 0.5197 - val_loss: 3.0332 - val_accuracy30: 0.5198 - 66s/epoch - 32ms/step
Epoch 4/50
2058/2058 - 67s - loss: 2.8256 - accuracy30: 0.5418 - val_loss: 3.0053 - val_accuracy30: 0.5273 - 67s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 73s - loss: 2.7957 - accuracy30: 0.5496 - val_loss: 2.9767 - val_accuracy30: 0.5272 - 73s/epoch - 35ms/step
Epoch 6/50
2058/2058 - 68s - loss: 2.7760 - accuracy30: 0.5550 - val_loss: 2.9540 - val_accuracy30: 0.5318 - 68s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 68s - loss: 2.7628 - accuracy30: 0.5570 - val_loss: 2.9446 - val_accuracy30: 0.5285 - 68s/epoch - 33ms/step
Epoch 8/50
2058/2058 - 67s - loss: 2.7524 - accuracy30: 0.5597 - val_loss: 2.9408 - val_accuracy30: 0.5319 - 67s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 2.7444 - accuracy30: 0.5614 - val_loss: 2.9167 - val_accuracy30: 0.5314 - 67s/epoch - 32ms/step
Epoch 10/50
2058/2058 - 67s - loss: 2.7352 - accuracy30: 0.5635 - val_loss: 2.9264 - val_accuracy30: 0.5326 - 67s/epoch - 32ms/step
Epoch 11/50
2058/2058 - 67s - loss: 2.7275 - accuracy30: 0.5644 - val_loss: 2.9099 - val_accuracy30: 0.5322 - 67s/epoch - 33ms/step
Epoch 12/50
2058/2058 - 67s - loss: 2.7208 - accuracy30: 0.5650 - val_loss: 2.9274 - val_accuracy30: 0.5343 - 67s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 73s - loss: 2.7147 - accuracy30: 0.5664 - val_loss: 2.9050 - val_accuracy30: 0.5314 - 73s/epoch - 35ms/step
Epoch 14/50
2058/2058 - 66s - loss: 2.7086 - accuracy30: 0.5669 - val_loss: 2.9051 - val_accuracy30: 0.5374 - 66s/epoch - 32ms/step
Epoch 15/50
2058/2058 - 67s - loss: 2.7037 - accuracy30: 0.5680 - val_loss: 2.8884 - val_accuracy30: 0.5399 - 67s/epoch - 33ms/step
Epoch 16/50
2058/2058 - 67s - loss: 2.6989 - accuracy30: 0.5693 - val_loss: 2.8880 - val_accuracy30: 0.5379 - 67s/epoch - 33ms/step
Epoch 17/50
2058/2058 - 73s - loss: 2.6941 - accuracy30: 0.5699 - val_loss: 2.8820 - val_accuracy30: 0.5404 - 73s/epoch - 35ms/step
Epoch 18/50
2058/2058 - 74s - loss: 2.6899 - accuracy30: 0.5700 - val_loss: 2.8774 - val_accuracy30: 0.5428 - 74s/epoch - 36ms/step
Epoch 19/50
2058/2058 - 74s - loss: 2.6864 - accuracy30: 0.5711 - val_loss: 2.8828 - val_accuracy30: 0.5400 - 74s/epoch - 36ms/step
Epoch 20/50
2058/2058 - 74s - loss: 2.6829 - accuracy30: 0.5716 - val_loss: 2.8818 - val_accuracy30: 0.5413 - 74s/epoch - 36ms/step
Epoch 21/50
2058/2058 - 67s - loss: 2.6788 - accuracy30: 0.5727 - val_loss: 2.8600 - val_accuracy30: 0.5426 - 67s/epoch - 32ms/step
Epoch 22/50
2058/2058 - 67s - loss: 2.6744 - accuracy30: 0.5730 - val_loss: 2.8818 - val_accuracy30: 0.5430 - 67s/epoch - 32ms/step
Epoch 23/50
2058/2058 - 68s - loss: 2.6721 - accuracy30: 0.5735 - val_loss: 2.8816 - val_accuracy30: 0.5393 - 68s/epoch - 33ms/step
Epoch 24/50
2058/2058 - 68s - loss: 2.6685 - accuracy30: 0.5746 - val_loss: 2.8791 - val_accuracy30: 0.5342 - 68s/epoch - 33ms/step
Epoch 25/50
2058/2058 - 68s - loss: 2.6655 - accuracy30: 0.5746 - val_loss: 2.8695 - val_accuracy30: 0.5406 - 68s/epoch - 33ms/step
Epoch 26/50
2058/2058 - 67s - loss: 2.6618 - accuracy30: 0.5758 - val_loss: 2.8745 - val_accuracy30: 0.5395 - 67s/epoch - 33ms/step
Epoch 27/50
2058/2058 - 67s - loss: 2.6591 - accuracy30: 0.5762 - val_loss: 2.8612 - val_accuracy30: 0.5402 - 67s/epoch - 32ms/step
Epoch 28/50
2058/2058 - 73s - loss: 2.6561 - accuracy30: 0.5768 - val_loss: 2.8754 - val_accuracy30: 0.5389 - 73s/epoch - 35ms/step
Epoch 29/50
2058/2058 - 73s - loss: 2.6530 - accuracy30: 0.5777 - val_loss: 2.8846 - val_accuracy30: 0.5388 - 73s/epoch - 36ms/step
Epoch 30/50
2058/2058 - 70s - loss: 2.6489 - accuracy30: 0.5782 - val_loss: 2.8845 - val_accuracy30: 0.5408 - 70s/epoch - 34ms/step
Epoch 31/50
2058/2058 - 66s - loss: 2.6463 - accuracy30: 0.5784 - val_loss: 2.8955 - val_accuracy30: 0.5403 - 66s/epoch - 32ms/step
testing model: results/ATVI/W2/deepVOL_L3/h30
Evaluating performance on  test set...
5497/5497 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9258138
{'0': {'precision': 0.5011523041735153, 'recall': 0.4395240637632522, 'f1-score': 0.4683194025120176, 'support': 393330}, '1': {'precision': 0.6394485361765198, 'recall': 0.6101839889948099, 'f1-score': 0.6244735963599946, 'support': 620798}, '2': {'precision': 0.4674866394382924, 'recall': 0.5588020545801925, 'f1-score': 0.5090818911470972, 'support': 393073}, 'accuracy': 0.5481299402146531, 'macro avg': {'precision': 0.5360291599294424, 'recall': 0.5361700357794182, 'f1-score': 0.5339582966730365, 'support': 1407201}, 'weighted avg': {'precision': 0.5527589761418645, 'recall': 0.5481299402146531, 'f1-score': 0.5485942494796455, 'support': 1407201}}
[[172878 117916 102536]
 [ 94330 378801 147667]
 [ 77753  95670 219650]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.90422326
{'0': {'precision': 0.5455906677113258, 'recall': 0.43602766220935896, 'f1-score': 0.4846947456342516, 'support': 143734}, '1': {'precision': 0.6442956418273187, 'recall': 0.6415076901101948, 'f1-score': 0.6428986434712317, 'support': 238033}, '2': {'precision': 0.47781950374676335, 'recall': 0.5762906995181205, 'f1-score': 0.5224556886077848, 'support': 145057}, 'accuracy': 0.5674893323007304, 'macro avg': {'precision': 0.5559019377618026, 'recall': 0.5512753506125581, 'f1-score': 0.5500163592377559, 'support': 526824}, 'weighted avg': {'precision': 0.5715279055223302, 'recall': 0.5674893323007304, 'f1-score': 0.5665726356292816, 'support': 526824}}
[[ 62672  46164  34898]
 [ 28875 152700  56458]
 [ 23323  38139  83595]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 0.9298472
{'0': {'precision': 0.525035394053799, 'recall': 0.43482764011568825, 'f1-score': 0.4756926629040534, 'support': 51172}, '1': {'precision': 0.6230210602759623, 'recall': 0.5932344033081168, 'f1-score': 0.6077629873120003, 'support': 72307}, '2': {'precision': 0.4669964641900141, 'recall': 0.5795552931916568, 'f1-score': 0.5172229100264292, 'support': 50820}, 'accuracy': 0.5427397747548752, 'macro avg': {'precision': 0.5383509728399252, 'recall': 0.5358724455384872, 'f1-score': 0.5335595200808276, 'support': 174299}, 'weighted avg': {'precision': 0.5487619280663202, 'recall': 0.5427397747548752, 'f1-score': 0.5425902131236447, 'support': 174299}}
[[22251 14597 14324]
 [10120 42895 19292]
 [10009 11358 29453]]
training model: results/ATVI/W2/deepVOL_L3/h50
Epoch 1/50
2058/2058 - 71s - loss: 3.2715 - accuracy50: 0.3844 - val_loss: 3.3467 - val_accuracy50: 0.3358 - 71s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 69s - loss: 3.1682 - accuracy50: 0.4206 - val_loss: 3.2847 - val_accuracy50: 0.3836 - 69s/epoch - 33ms/step
Epoch 3/50
2058/2058 - 74s - loss: 3.0258 - accuracy50: 0.4819 - val_loss: 3.0854 - val_accuracy50: 0.4745 - 74s/epoch - 36ms/step
Epoch 4/50
2058/2058 - 67s - loss: 2.9544 - accuracy50: 0.5040 - val_loss: 3.0787 - val_accuracy50: 0.4755 - 67s/epoch - 32ms/step
Epoch 5/50
2058/2058 - 67s - loss: 2.9251 - accuracy50: 0.5104 - val_loss: 3.0435 - val_accuracy50: 0.4831 - 67s/epoch - 32ms/step
Epoch 6/50
2058/2058 - 67s - loss: 2.9099 - accuracy50: 0.5141 - val_loss: 3.0273 - val_accuracy50: 0.4874 - 67s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 66s - loss: 2.8977 - accuracy50: 0.5177 - val_loss: 3.0381 - val_accuracy50: 0.4871 - 66s/epoch - 32ms/step
Epoch 8/50
2058/2058 - 67s - loss: 2.8887 - accuracy50: 0.5194 - val_loss: 3.0285 - val_accuracy50: 0.4907 - 67s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 2.8814 - accuracy50: 0.5209 - val_loss: 3.0402 - val_accuracy50: 0.4909 - 67s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 68s - loss: 2.8753 - accuracy50: 0.5223 - val_loss: 3.0255 - val_accuracy50: 0.4928 - 68s/epoch - 33ms/step
Epoch 11/50
2058/2058 - 66s - loss: 2.8694 - accuracy50: 0.5233 - val_loss: 3.0382 - val_accuracy50: 0.4898 - 66s/epoch - 32ms/step
Epoch 12/50
2058/2058 - 67s - loss: 2.8645 - accuracy50: 0.5248 - val_loss: 3.0416 - val_accuracy50: 0.4904 - 67s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 67s - loss: 2.8582 - accuracy50: 0.5261 - val_loss: 3.0437 - val_accuracy50: 0.4893 - 67s/epoch - 33ms/step
Epoch 14/50
2058/2058 - 67s - loss: 2.8535 - accuracy50: 0.5267 - val_loss: 3.0462 - val_accuracy50: 0.4914 - 67s/epoch - 32ms/step
Epoch 15/50
2058/2058 - 67s - loss: 2.8494 - accuracy50: 0.5275 - val_loss: 3.0410 - val_accuracy50: 0.4918 - 67s/epoch - 33ms/step
Epoch 16/50
2058/2058 - 67s - loss: 2.8437 - accuracy50: 0.5289 - val_loss: 3.0504 - val_accuracy50: 0.4917 - 67s/epoch - 32ms/step
Epoch 17/50
2058/2058 - 67s - loss: 2.8400 - accuracy50: 0.5295 - val_loss: 3.0486 - val_accuracy50: 0.4905 - 67s/epoch - 32ms/step
Epoch 18/50
2058/2058 - 67s - loss: 2.8363 - accuracy50: 0.5308 - val_loss: 3.0400 - val_accuracy50: 0.4919 - 67s/epoch - 33ms/step
Epoch 19/50
2058/2058 - 66s - loss: 2.8327 - accuracy50: 0.5316 - val_loss: 3.0424 - val_accuracy50: 0.4901 - 66s/epoch - 32ms/step
Epoch 20/50
2058/2058 - 68s - loss: 2.8290 - accuracy50: 0.5326 - val_loss: 3.0425 - val_accuracy50: 0.4923 - 68s/epoch - 33ms/step
testing model: results/ATVI/W2/deepVOL_L3/h50
Evaluating performance on  test set...
5497/5497 - 74s - 74s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9973806
{'0': {'precision': 0.5104337378997102, 'recall': 0.3726168631061867, 'f1-score': 0.43077082564260755, 'support': 457223}, '1': {'precision': 0.49988275247982605, 'recall': 0.6216712823796685, 'f1-score': 0.5541645647283386, 'support': 490354}, '2': {'precision': 0.4856807597814528, 'recall': 0.4898895619027727, 'f1-score': 0.48777608204230577, 'support': 459624}, 'accuracy': 0.4977064399471007, 'macro avg': {'precision': 0.49866575005366304, 'recall': 0.494725902462876, 'f1-score': 0.49090382413775063, 'support': 1407201}, 'weighted avg': {'precision': 0.49867224773646573, 'recall': 0.4977064399471007, 'f1-score': 0.4923878920766845, 'support': 1407201}}
[[170369 156267 130587]
 [ 77660 304839 107855]
 [ 85744 148715 225165]]
Evaluating performance on  train set...
2058/2058 - 28s - 28s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 0.9906898
{'0': {'precision': 0.5508500971016086, 'recall': 0.3561368805079124, 'f1-score': 0.4325928377192352, 'support': 168848}, '1': {'precision': 0.4935431440885604, 'recall': 0.6516586412701124, 'f1-score': 0.5616855628358978, 'support': 187322}, '2': {'precision': 0.49351831194297996, 'recall': 0.49256976103695194, 'f1-score': 0.4930435802686374, 'support': 170654}, 'accuracy': 0.5054097763199854, 'macro avg': {'precision': 0.5126371843777163, 'recall': 0.5001217609383256, 'f1-score': 0.49577399360792346, 'support': 526824}, 'weighted avg': {'precision': 0.5119020774275412, 'recall': 0.5054097763199854, 'f1-score': 0.4980759373375691, 'support': 526824}}
[[ 60133  64273  44442]
 [ 23427 122070  41825]
 [ 25604  60991  84059]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.003703
{'0': {'precision': 0.5282290041185951, 'recall': 0.35057129760105943, 'f1-score': 0.4214425667401421, 'support': 58901}, '1': {'precision': 0.4819672131147541, 'recall': 0.5986890403775563, 'f1-score': 0.5340245566166438, 'support': 57210}, '2': {'precision': 0.48105015356313235, 'recall': 0.5302811576270021, 'f1-score': 0.5044673876613449, 'support': 58188}, 'accuracy': 0.4920051176426715, 'macro avg': {'precision': 0.4970821235988272, 'recall': 0.49318049853520596, 'f1-score': 0.48664483700604366, 'support': 174299}, 'weighted avg': {'precision': 0.49729434574734216, 'recall': 0.4920051176426715, 'f1-score': 0.48611226605337743, 'support': 174299}}
[[20649 19664 18588]
 [ 8260 34251 14699]
 [10182 17150 30856]]
training model: results/ATVI/W2/deepVOL_L3/h100
Epoch 1/50
2058/2058 - 72s - loss: 3.2927 - accuracy100: 0.3648 - val_loss: 3.3121 - val_accuracy100: 0.3197 - 72s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 70s - loss: 3.2873 - accuracy100: 0.3582 - val_loss: 3.3038 - val_accuracy100: 0.3465 - 70s/epoch - 34ms/step
Epoch 3/50
2058/2058 - 66s - loss: 3.2348 - accuracy100: 0.4004 - val_loss: 3.2445 - val_accuracy100: 0.3985 - 66s/epoch - 32ms/step
Epoch 4/50
2058/2058 - 67s - loss: 3.1876 - accuracy100: 0.4241 - val_loss: 3.2213 - val_accuracy100: 0.4099 - 67s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 68s - loss: 3.1649 - accuracy100: 0.4366 - val_loss: 3.2315 - val_accuracy100: 0.4106 - 68s/epoch - 33ms/step
Epoch 6/50
2058/2058 - 68s - loss: 3.1495 - accuracy100: 0.4428 - val_loss: 3.2285 - val_accuracy100: 0.4147 - 68s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 67s - loss: 3.1365 - accuracy100: 0.4471 - val_loss: 3.2185 - val_accuracy100: 0.4208 - 67s/epoch - 32ms/step
Epoch 8/50
2058/2058 - 67s - loss: 3.1282 - accuracy100: 0.4489 - val_loss: 3.2023 - val_accuracy100: 0.4238 - 67s/epoch - 32ms/step
Epoch 9/50
2058/2058 - 66s - loss: 3.1207 - accuracy100: 0.4513 - val_loss: 3.1989 - val_accuracy100: 0.4228 - 66s/epoch - 32ms/step
Epoch 10/50
2058/2058 - 67s - loss: 3.1152 - accuracy100: 0.4537 - val_loss: 3.1955 - val_accuracy100: 0.4228 - 67s/epoch - 32ms/step
Epoch 11/50
2058/2058 - 67s - loss: 3.1105 - accuracy100: 0.4551 - val_loss: 3.1891 - val_accuracy100: 0.4229 - 67s/epoch - 32ms/step
Epoch 12/50
2058/2058 - 67s - loss: 3.1068 - accuracy100: 0.4567 - val_loss: 3.1915 - val_accuracy100: 0.4216 - 67s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 68s - loss: 3.1028 - accuracy100: 0.4587 - val_loss: 3.1965 - val_accuracy100: 0.4184 - 68s/epoch - 33ms/step
Epoch 14/50
2058/2058 - 68s - loss: 3.0996 - accuracy100: 0.4596 - val_loss: 3.2001 - val_accuracy100: 0.4204 - 68s/epoch - 33ms/step
Epoch 15/50
2058/2058 - 67s - loss: 3.0967 - accuracy100: 0.4603 - val_loss: 3.2028 - val_accuracy100: 0.4209 - 67s/epoch - 33ms/step
Epoch 16/50
2058/2058 - 67s - loss: 3.0930 - accuracy100: 0.4626 - val_loss: 3.2111 - val_accuracy100: 0.4163 - 67s/epoch - 33ms/step
Epoch 17/50
2058/2058 - 67s - loss: 3.0911 - accuracy100: 0.4628 - val_loss: 3.2106 - val_accuracy100: 0.4156 - 67s/epoch - 32ms/step
Epoch 18/50
2058/2058 - 68s - loss: 3.0877 - accuracy100: 0.4639 - val_loss: 3.2193 - val_accuracy100: 0.4147 - 68s/epoch - 33ms/step
Epoch 19/50
2058/2058 - 67s - loss: 3.0855 - accuracy100: 0.4650 - val_loss: 3.2395 - val_accuracy100: 0.4134 - 67s/epoch - 32ms/step
Epoch 20/50
2058/2058 - 67s - loss: 3.0829 - accuracy100: 0.4659 - val_loss: 3.2292 - val_accuracy100: 0.4128 - 67s/epoch - 33ms/step
Epoch 21/50
2058/2058 - 67s - loss: 3.0793 - accuracy100: 0.4669 - val_loss: 3.2321 - val_accuracy100: 0.4152 - 67s/epoch - 33ms/step
testing model: results/ATVI/W2/deepVOL_L3/h100
Evaluating performance on  test set...
5497/5497 - 73s - 73s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0617115
{'0': {'precision': 0.44240696952139347, 'recall': 0.36078392978005186, 'f1-score': 0.3974480417166867, 'support': 469838}, '1': {'precision': 0.3939468163278346, 'recall': 0.5808237368277025, 'f1-score': 0.4694718387423411, 'support': 445822}, '2': {'precision': 0.45792932322626384, 'recall': 0.3416622418068889, 'f1-score': 0.3913426954575483, 'support': 491541}, 'accuracy': 0.4238164981406352, 'macro avg': {'precision': 0.4314277030251639, 'recall': 0.4277566361382144, 'f1-score': 0.41942085863885864, 'support': 1407201}, 'weighted avg': {'precision': 0.43247610026063177, 'recall': 0.4238164981406352, 'f1-score': 0.4181336191374021, 'support': 1407201}}
[[169510 189319 111009]
 [ 99088 258944  87790]
 [114556 209044 167941]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0551975
{'0': {'precision': 0.47050713443298287, 'recall': 0.32115604839166867, 'f1-score': 0.38174368926804947, 'support': 176394}, '1': {'precision': 0.40394075720819844, 'recall': 0.6153648127595794, 'f1-score': 0.48772602789415453, 'support': 174802}, '2': {'precision': 0.44873258734870974, 'recall': 0.35802947138269525, 'f1-score': 0.39828221791509894, 'support': 175628}, 'accuracy': 0.4310680606806068, 'macro avg': {'precision': 0.44106015966329704, 'recall': 0.43151677751131445, 'f1-score': 0.422583978359101, 'support': 526824}, 'weighted avg': {'precision': 0.4411611744407207, 'recall': 0.4310680606806068, 'f1-score': 0.42242246143056367, 'support': 526824}}
[[ 56650  79183  40561]
 [ 30548 107567  36687]
 [ 33204  79544  62880]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0635737
{'0': {'precision': 0.4481090693538826, 'recall': 0.3165661641541039, 'f1-score': 0.37102331288343565, 'support': 59700}, '1': {'precision': 0.39779025804793894, 'recall': 0.5856888072204507, 'f1-score': 0.4737900581471604, 'support': 55509}, '2': {'precision': 0.4388332175811092, 'recall': 0.3742596039939076, 'f1-score': 0.4039822806777184, 'support': 59090}, 'accuracy': 0.4218325980068732, 'macro avg': {'precision': 0.42824418166097694, 'recall': 0.42550485845615404, 'f1-score': 0.4162652172361048, 'support': 174299}, 'weighted avg': {'precision': 0.4289393840542836, 'recall': 0.4218325980068732, 'f1-score': 0.4149250258583137, 'support': 174299}}
[[18899 24945 15856]
 [10574 32511 12424]
 [12702 24273 22115]]
training model: results/ATVI/W2/deepVOL_L3/h200
Epoch 1/50
2058/2058 - 72s - loss: 3.2966 - accuracy200: 0.3612 - val_loss: 3.3077 - val_accuracy200: 0.3289 - 72s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 67s - loss: 3.2862 - accuracy200: 0.3630 - val_loss: 3.3038 - val_accuracy200: 0.3339 - 67s/epoch - 32ms/step
Epoch 3/50
2058/2058 - 67s - loss: 3.2716 - accuracy200: 0.3765 - val_loss: 3.3467 - val_accuracy200: 0.3362 - 67s/epoch - 32ms/step
Epoch 4/50
2058/2058 - 67s - loss: 3.2577 - accuracy200: 0.3877 - val_loss: 3.3483 - val_accuracy200: 0.3400 - 67s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 67s - loss: 3.2460 - accuracy200: 0.3976 - val_loss: 3.3304 - val_accuracy200: 0.3480 - 67s/epoch - 33ms/step
Epoch 6/50
2058/2058 - 67s - loss: 3.2365 - accuracy200: 0.4033 - val_loss: 3.3403 - val_accuracy200: 0.3484 - 67s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 67s - loss: 3.2287 - accuracy200: 0.4079 - val_loss: 3.3582 - val_accuracy200: 0.3473 - 67s/epoch - 33ms/step
Epoch 8/50
2058/2058 - 68s - loss: 3.2233 - accuracy200: 0.4108 - val_loss: 3.3460 - val_accuracy200: 0.3526 - 68s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 3.2167 - accuracy200: 0.4144 - val_loss: 3.3548 - val_accuracy200: 0.3543 - 67s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 66s - loss: 3.2108 - accuracy200: 0.4173 - val_loss: 3.3674 - val_accuracy200: 0.3561 - 66s/epoch - 32ms/step
Epoch 11/50
2058/2058 - 67s - loss: 3.2050 - accuracy200: 0.4196 - val_loss: 3.3989 - val_accuracy200: 0.3520 - 67s/epoch - 33ms/step
Epoch 12/50
2058/2058 - 67s - loss: 3.2001 - accuracy200: 0.4223 - val_loss: 3.3826 - val_accuracy200: 0.3567 - 67s/epoch - 32ms/step
testing model: results/ATVI/W2/deepVOL_L3/h200
Evaluating performance on  test set...
5497/5497 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1044749
{'0': {'precision': 0.36825143692481477, 'recall': 0.02333866756506359, 'f1-score': 0.04389537819369172, 'support': 474920}, '1': {'precision': 0.30618772194837546, 'recall': 0.8594755060244045, 'f1-score': 0.4515212300515066, 'support': 430167}, '2': {'precision': 0.39083448300258233, 'recall': 0.13202380335939648, 'f1-score': 0.19737453254888881, 'support': 502114}, 'accuracy': 0.3177179379491629, 'macro avg': {'precision': 0.35509121395859083, 'recall': 0.33827932564962154, 'f1-score': 0.2309303802646957, 'support': 1407201}, 'weighted avg': {'precision': 0.3573372189261225, 'recall': 0.3177179379491629, 'f1-score': 0.22326649996380563, 'support': 1407201}}
[[ 11084 411643  52193]
 [  9319 369718  51130]
 [  9696 426127  66291]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990238
{'0': {'precision': 0.3573610262675626, 'recall': 0.023268631952178556, 'f1-score': 0.04369235037103822, 'support': 175988}, '1': {'precision': 0.335175998528822, 'recall': 0.8589191828577268, 'f1-score': 0.4821878511152016, 'support': 176126}, '2': {'precision': 0.37733108424702466, 'recall': 0.138280579245607, 'f1-score': 0.20239092554118354, 'support': 174710}, 'accuracy': 0.34078174115074483, 'macro avg': {'precision': 0.3566227030144698, 'recall': 0.3401561313518375, 'f1-score': 0.24275704234247444, 'support': 526824}, 'weighted avg': {'precision': 0.35656684952936996, 'recall': 0.34078174115074483, 'f1-score': 0.2429176829907416, 'support': 526824}}
[[  4095 152864  19029]
 [  4010 151278  20838]
 [  3354 147197  24159]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1012238
{'0': {'precision': 0.3653144451599056, 'recall': 0.02887780379381723, 'f1-score': 0.05352453732094282, 'support': 58938}, '1': {'precision': 0.3277560456397497, 'recall': 0.8457245819046952, 'f1-score': 0.47242594067436366, 'support': 57164}, '2': {'precision': 0.37042056285856256, 'recall': 0.1409007337147963, 'f1-score': 0.20414768342171435, 'support': 58197}, 'accuracy': 0.33417862408849164, 'macro avg': {'precision': 0.35449701788607263, 'recall': 0.3385010398044363, 'f1-score': 0.24336605380567358, 'support': 174299}, 'weighted avg': {'precision': 0.3547014891563631, 'recall': 0.33417862408849164, 'f1-score': 0.24120143193836202, 'support': 174299}}
[[ 1702 50520  6716]
 [ 1598 48345  7221]
 [ 1359 48638  8200]]
training model: results/ATVI/W2/deepVOL_L3/h300
Epoch 1/50
2058/2058 - 72s - loss: 3.2972 - accuracy300: 0.3643 - val_loss: 3.3185 - val_accuracy300: 0.3278 - 72s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 73s - loss: 3.2800 - accuracy300: 0.3709 - val_loss: 3.2972 - val_accuracy300: 0.3353 - 73s/epoch - 36ms/step
Epoch 3/50
2058/2058 - 67s - loss: 3.2666 - accuracy300: 0.3834 - val_loss: 3.3002 - val_accuracy300: 0.3408 - 67s/epoch - 33ms/step
Epoch 4/50
2058/2058 - 68s - loss: 3.2547 - accuracy300: 0.3913 - val_loss: 3.3044 - val_accuracy300: 0.3435 - 68s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 67s - loss: 3.2458 - accuracy300: 0.3981 - val_loss: 3.3191 - val_accuracy300: 0.3433 - 67s/epoch - 33ms/step
Epoch 6/50
2058/2058 - 67s - loss: 3.2384 - accuracy300: 0.4023 - val_loss: 3.3292 - val_accuracy300: 0.3413 - 67s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 67s - loss: 3.2328 - accuracy300: 0.4057 - val_loss: 3.3366 - val_accuracy300: 0.3437 - 67s/epoch - 33ms/step
Epoch 8/50
2058/2058 - 68s - loss: 3.2281 - accuracy300: 0.4090 - val_loss: 3.3389 - val_accuracy300: 0.3431 - 68s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 3.2250 - accuracy300: 0.4107 - val_loss: 3.3481 - val_accuracy300: 0.3458 - 67s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 67s - loss: 3.2197 - accuracy300: 0.4136 - val_loss: 3.3554 - val_accuracy300: 0.3475 - 67s/epoch - 33ms/step
Epoch 11/50
2058/2058 - 68s - loss: 3.2153 - accuracy300: 0.4151 - val_loss: 3.3843 - val_accuracy300: 0.3423 - 68s/epoch - 33ms/step
Epoch 12/50
2058/2058 - 67s - loss: 3.2118 - accuracy300: 0.4170 - val_loss: 3.3973 - val_accuracy300: 0.3433 - 67s/epoch - 33ms/step
testing model: results/ATVI/W2/deepVOL_L3/h300
Evaluating performance on  test set...
5497/5497 - 74s - 74s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1040146
{'0': {'precision': 0.3591578524568215, 'recall': 0.2213937020546108, 'f1-score': 0.2739301478378302, 'support': 484666}, '1': {'precision': 0.2874742241334646, 'recall': 0.6760856161796351, 'f1-score': 0.4034148785110874, 'support': 410343}, '2': {'precision': 0.39154479709326245, 'recall': 0.10961514432087967, 'f1-score': 0.17127960914178675, 'support': 512192}, 'accuracy': 0.31329781601917567, 'macro avg': {'precision': 0.3460589578945162, 'recall': 0.3356981541850419, 'f1-score': 0.28287487849690146, 'support': 1407201}, 'weighted avg': {'precision': 0.35004292065257797, 'recall': 0.31329781601917567, 'f1-score': 0.2743255200148344, 'support': 1407201}}
[[107302 331584  45780]
 [ 91449 277427  41467]
 [100009 356039  56144]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0988743
{'0': {'precision': 0.37039442269124245, 'recall': 0.21644306538384267, 'f1-score': 0.27322489062973326, 'support': 179188}, '1': {'precision': 0.3210424726191675, 'recall': 0.6955011382804298, 'f1-score': 0.4393031499069612, 'support': 169554}, '2': {'precision': 0.3737019801076741, 'recall': 0.11498635460068957, 'f1-score': 0.17586107687749328, 'support': 178082}, 'accuracy': 0.3363286410641884, 'macro avg': {'precision': 0.355046291806028, 'recall': 0.34231018608832064, 'f1-score': 0.29612970580472925, 'support': 526824}, 'weighted avg': {'precision': 0.35562895243421616, 'recall': 0.3363286410641884, 'f1-score': 0.29376399001181286, 'support': 526824}}
[[ 38784 123082  17322]
 [ 34633 117925  16996]
 [ 31293 126312  20477]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1005158
{'0': {'precision': 0.36704599618684464, 'recall': 0.2069608452454941, 'f1-score': 0.2646802934447536, 'support': 59533}, '1': {'precision': 0.3213396115556806, 'recall': 0.694204090389016, 'f1-score': 0.43932185748145963, 'support': 55936}, '2': {'precision': 0.3643036701860231, 'recall': 0.12316845147033827, 'f1-score': 0.18409552845528457, 'support': 58830}, 'accuracy': 0.33504495149140273, 'macro avg': {'precision': 0.3508964259761828, 'recall': 0.3414444623682828, 'f1-score': 0.2960325597938326, 'support': 174299}, 'weighted avg': {'precision': 0.35145231309424446, 'recall': 0.33504495149140273, 'f1-score': 0.29352698104265557, 'support': 174299}}
[[12321 40889  6323]
 [10784 38831  6321]
 [10463 41121  7246]]
training model: results/ATVI/W2/deepVOL_L3/h500
Epoch 1/50
2058/2058 - 71s - loss: 3.2430 - accuracy500: 0.4038 - val_loss: 3.5500 - val_accuracy500: 0.3488 - 71s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 68s - loss: 3.2565 - accuracy500: 0.3915 - val_loss: 3.4421 - val_accuracy500: 0.3488 - 68s/epoch - 33ms/step
Epoch 3/50
2058/2058 - 67s - loss: 3.2603 - accuracy500: 0.3901 - val_loss: 3.5251 - val_accuracy500: 0.3488 - 67s/epoch - 33ms/step
Epoch 4/50
2058/2058 - 67s - loss: 3.2707 - accuracy500: 0.3858 - val_loss: 3.4967 - val_accuracy500: 0.3488 - 67s/epoch - 33ms/step
Epoch 5/50
2058/2058 - 73s - loss: 3.2680 - accuracy500: 0.3817 - val_loss: 3.4188 - val_accuracy500: 0.3488 - 73s/epoch - 36ms/step
Epoch 6/50
2058/2058 - 67s - loss: 3.2735 - accuracy500: 0.3809 - val_loss: 3.3812 - val_accuracy500: 0.3488 - 67s/epoch - 33ms/step
Epoch 7/50
2058/2058 - 73s - loss: 3.2726 - accuracy500: 0.3745 - val_loss: 3.4453 - val_accuracy500: 0.3488 - 73s/epoch - 35ms/step
Epoch 8/50
2058/2058 - 74s - loss: 3.2468 - accuracy500: 0.4018 - val_loss: 3.4682 - val_accuracy500: 0.3488 - 74s/epoch - 36ms/step
Epoch 9/50
2058/2058 - 68s - loss: 3.2310 - accuracy500: 0.4064 - val_loss: 3.4757 - val_accuracy500: 0.3497 - 68s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 68s - loss: 3.2195 - accuracy500: 0.4154 - val_loss: 3.4350 - val_accuracy500: 0.3492 - 68s/epoch - 33ms/step
Epoch 11/50
2058/2058 - 68s - loss: 3.2160 - accuracy500: 0.4123 - val_loss: 3.4862 - val_accuracy500: 0.3487 - 68s/epoch - 33ms/step
Epoch 12/50
2058/2058 - 67s - loss: 3.2106 - accuracy500: 0.4194 - val_loss: 3.5268 - val_accuracy500: 0.3488 - 67s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 69s - loss: 3.1960 - accuracy500: 0.4262 - val_loss: 3.5331 - val_accuracy500: 0.3489 - 69s/epoch - 34ms/step
Epoch 14/50
2058/2058 - 70s - loss: 3.1863 - accuracy500: 0.4319 - val_loss: 3.5690 - val_accuracy500: 0.3487 - 70s/epoch - 34ms/step
Epoch 15/50
2058/2058 - 69s - loss: 3.1794 - accuracy500: 0.4350 - val_loss: 3.5581 - val_accuracy500: 0.3489 - 69s/epoch - 34ms/step
Epoch 16/50
2058/2058 - 68s - loss: 3.1713 - accuracy500: 0.4389 - val_loss: 3.5411 - val_accuracy500: 0.3485 - 68s/epoch - 33ms/step
testing model: results/ATVI/W2/deepVOL_L3/h500
Evaluating performance on  test set...
5497/5497 - 75s - 75s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1408879
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 463911}, '1': {'precision': 0.3121565433793751, 'recall': 1.0, 'f1-score': 0.475791619459422, 'support': 439267}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 504023}, 'accuracy': 0.3121565433793751, 'macro avg': {'precision': 0.10405218112645837, 'recall': 0.3333333333333333, 'f1-score': 0.158597206486474, 'support': 1407201}, 'weighted avg': {'precision': 0.0974417075745597, 'recall': 0.3121565433793751, 'f1-score': 0.1485214672993282, 'support': 1407201}}
[[     0 463911      0]
 [     0 439267      0]
 [     0 504023      0]]
Evaluating performance on  train set...
2058/2058 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1286095
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 176208}, '1': {'precision': 0.34056914643220504, 'recall': 1.0, 'f1-score': 0.5080963519690079, 'support': 179420}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 171196}, 'accuracy': 0.34056914643220504, 'macro avg': {'precision': 0.11352304881073501, 'recall': 0.3333333333333333, 'f1-score': 0.169365450656336, 'support': 526824}, 'weighted avg': {'precision': 0.11598734350156073, 'recall': 0.34056914643220504, 'f1-score': 0.17304194089540229, 'support': 526824}}
[[     0 176208      0]
 [     0 179420      0]
 [     0 171196      0]]
Evaluating performance on  val set...
681/681 - 9s - 9s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.123857
{'0': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 57272}, '1': {'precision': 0.34879144458660116, 'recall': 1.0, 'f1-score': 0.5171910690662844, 'support': 60794}, '2': {'precision': 0.0, 'recall': 0.0, 'f1-score': 0.0, 'support': 56233}, 'accuracy': 0.34879144458660116, 'macro avg': {'precision': 0.11626381486220039, 'recall': 0.3333333333333333, 'f1-score': 0.1723970230220948, 'support': 174299}, 'weighted avg': {'precision': 0.12165547181680808, 'recall': 0.34879144458660116, 'f1-score': 0.18039182010691798, 'support': 174299}}
[[    0 57272     0]
 [    0 60794     0]
 [    0 56233     0]]
training model: results/ATVI/W2/deepVOL_L3/h1000
Epoch 1/50
2058/2058 - 72s - loss: 3.2951 - accuracy1000: 0.3701 - val_loss: 3.3530 - val_accuracy1000: 0.3239 - 72s/epoch - 35ms/step
Epoch 2/50
2058/2058 - 67s - loss: 3.2898 - accuracy1000: 0.3634 - val_loss: 3.4339 - val_accuracy1000: 0.3226 - 67s/epoch - 33ms/step
Epoch 3/50
2058/2058 - 67s - loss: 3.2804 - accuracy1000: 0.3760 - val_loss: 3.3246 - val_accuracy1000: 0.3246 - 67s/epoch - 33ms/step
Epoch 4/50
2058/2058 - 66s - loss: 3.2659 - accuracy1000: 0.3855 - val_loss: 3.3398 - val_accuracy1000: 0.3351 - 66s/epoch - 32ms/step
Epoch 5/50
2058/2058 - 67s - loss: 3.2428 - accuracy1000: 0.4034 - val_loss: 3.4444 - val_accuracy1000: 0.3176 - 67s/epoch - 33ms/step
Epoch 6/50
2058/2058 - 66s - loss: 3.2283 - accuracy1000: 0.4116 - val_loss: 3.4565 - val_accuracy1000: 0.3180 - 66s/epoch - 32ms/step
Epoch 7/50
2058/2058 - 66s - loss: 3.2062 - accuracy1000: 0.4250 - val_loss: 3.4877 - val_accuracy1000: 0.3157 - 66s/epoch - 32ms/step
Epoch 8/50
2058/2058 - 68s - loss: 3.1946 - accuracy1000: 0.4297 - val_loss: 3.4708 - val_accuracy1000: 0.3142 - 68s/epoch - 33ms/step
Epoch 9/50
2058/2058 - 67s - loss: 3.1851 - accuracy1000: 0.4343 - val_loss: 3.4634 - val_accuracy1000: 0.3182 - 67s/epoch - 33ms/step
Epoch 10/50
2058/2058 - 68s - loss: 3.1753 - accuracy1000: 0.4367 - val_loss: 3.5047 - val_accuracy1000: 0.3159 - 68s/epoch - 33ms/step
Epoch 11/50
2058/2058 - 66s - loss: 3.1668 - accuracy1000: 0.4403 - val_loss: 3.5581 - val_accuracy1000: 0.3173 - 66s/epoch - 32ms/step
Epoch 12/50
2058/2058 - 67s - loss: 3.1587 - accuracy1000: 0.4434 - val_loss: 3.5757 - val_accuracy1000: 0.3168 - 67s/epoch - 33ms/step
Epoch 13/50
2058/2058 - 66s - loss: 3.1520 - accuracy1000: 0.4460 - val_loss: 3.6088 - val_accuracy1000: 0.3165 - 66s/epoch - 32ms/step
testing model: results/ATVI/W2/deepVOL_L3/h1000
Evaluating performance on  test set...
5497/5497 - 77s - 77s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1093079
{'0': {'precision': 0.31774389076756204, 'recall': 0.010965491729641178, 'f1-score': 0.021199382748895868, 'support': 454152}, '1': {'precision': 0.3183740254692693, 'recall': 0.9596455064544832, 'f1-score': 0.47812446567778644, 'support': 447286}, '2': {'precision': 0.3880641809996537, 'recall': 0.03323493414899864, 'f1-score': 0.06122627386272988, 'support': 505763}, 'accuracy': 0.32051213721422883, 'macro avg': {'precision': 0.34139403241216165, 'recall': 0.3346153107777077, 'f1-score': 0.18685004076313738, 'support': 1407201}, 'weighted avg': {'precision': 0.3432180422063694, 'recall': 0.32051213721422883, 'f1-score': 0.18082143615373128, 'support': 1407201}}
[[  4980 436033  13139]
 [  4683 429236  13367]
 [  6010 482944  16809]]
Evaluating performance on  train set...
2058/2058 - 34s - 34s/epoch - 16ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1048471
{'0': {'precision': 0.35348837209302325, 'recall': 0.011298812853776182, 'f1-score': 0.021897693378935743, 'support': 181612}, '1': {'precision': 0.32986281088438624, 'recall': 0.954965750465206, 'f1-score': 0.4903497575052101, 'support': 173579}, '2': {'precision': 0.36111561537214204, 'recall': 0.03892608064882627, 'f1-score': 0.0702767521853009, 'support': 171633}, 'accuracy': 0.33122067331784427, 'macro avg': {'precision': 0.3481555994498505, 'recall': 0.33506354798926946, 'f1-score': 0.19417473435648225, 'support': 526824}, 'weighted avg': {'precision': 0.34818904130454553, 'recall': 0.33122067331784427, 'f1-score': 0.1920055165591391, 'support': 526824}}
[[  2052 173654   5906]
 [  1903 165762   5914]
 [  1850 163102   6681]]
Evaluating performance on  val set...
681/681 - 12s - 12s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1081082
{'0': {'precision': 0.35453251067869007, 'recall': 0.01257596929241233, 'f1-score': 0.024290313140181444, 'support': 59399}, '1': {'precision': 0.3238031594663584, 'recall': 0.9526381976301387, 'f1-score': 0.48332382291755593, 'support': 56459}, '2': {'precision': 0.3513469119579501, 'recall': 0.03660101640971236, 'f1-score': 0.06629577399308838, 'support': 58441}, 'accuracy': 0.3251366903998302, 'macro avg': {'precision': 0.34322752736766615, 'recall': 0.33393839444408774, 'f1-score': 0.19130330335027526, 'support': 174299}, 'weighted avg': {'precision': 0.34351054259547786, 'recall': 0.3251366903998302, 'f1-score': 0.18706470694752123, 'support': 174299}}
[[  747 56689  1963]
 [  688 53785  1986]
 [  672 55630  2139]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        28 (peak)  15.85 (ave)

============================================
