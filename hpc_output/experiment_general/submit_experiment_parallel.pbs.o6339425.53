This machine has 1 visible gpus.
This machine has 1 physical gpus.
getting alphas...
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-31.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-23.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-10.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-11.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-19.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-15.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-17.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-12.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-08-02.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-16.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-29.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-18.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-09.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-25.csv
data/CHTR_orderbooks/CHTR_orderbooks_2019-07-24.csv
training model: results/CHTR/W5/deepLOB_L1/h10
Epoch 1/50
331/331 - 31s - loss: 3.3203 - accuracy10: 0.3640 - val_loss: 3.3445 - val_accuracy10: 0.3558 - 31s/epoch - 95ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2798 - accuracy10: 0.3836 - val_loss: 3.3322 - val_accuracy10: 0.3598 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2541 - accuracy10: 0.3975 - val_loss: 3.3405 - val_accuracy10: 0.3752 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2358 - accuracy10: 0.4053 - val_loss: 3.3121 - val_accuracy10: 0.3718 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2286 - accuracy10: 0.4113 - val_loss: 3.2898 - val_accuracy10: 0.3814 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2177 - accuracy10: 0.4164 - val_loss: 3.2967 - val_accuracy10: 0.3800 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2069 - accuracy10: 0.4216 - val_loss: 3.2706 - val_accuracy10: 0.3884 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.1981 - accuracy10: 0.4266 - val_loss: 3.2607 - val_accuracy10: 0.3933 - 8s/epoch - 25ms/step
Epoch 9/50
331/331 - 8s - loss: 3.1931 - accuracy10: 0.4293 - val_loss: 3.2594 - val_accuracy10: 0.3920 - 8s/epoch - 25ms/step
Epoch 10/50
331/331 - 8s - loss: 3.1863 - accuracy10: 0.4332 - val_loss: 3.2561 - val_accuracy10: 0.4053 - 8s/epoch - 26ms/step
Epoch 11/50
331/331 - 8s - loss: 3.1782 - accuracy10: 0.4338 - val_loss: 3.2448 - val_accuracy10: 0.4016 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.1736 - accuracy10: 0.4374 - val_loss: 3.2493 - val_accuracy10: 0.4060 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.1698 - accuracy10: 0.4405 - val_loss: 3.2599 - val_accuracy10: 0.4031 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1667 - accuracy10: 0.4417 - val_loss: 3.2745 - val_accuracy10: 0.3987 - 8s/epoch - 25ms/step
Epoch 15/50
331/331 - 8s - loss: 3.1604 - accuracy10: 0.4447 - val_loss: 3.2621 - val_accuracy10: 0.4006 - 8s/epoch - 25ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1547 - accuracy10: 0.4453 - val_loss: 3.2740 - val_accuracy10: 0.4005 - 8s/epoch - 25ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1502 - accuracy10: 0.4476 - val_loss: 3.2607 - val_accuracy10: 0.4038 - 8s/epoch - 25ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1464 - accuracy10: 0.4486 - val_loss: 3.2644 - val_accuracy10: 0.4001 - 8s/epoch - 25ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1433 - accuracy10: 0.4498 - val_loss: 3.2605 - val_accuracy10: 0.4024 - 8s/epoch - 25ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1367 - accuracy10: 0.4520 - val_loss: 3.2598 - val_accuracy10: 0.4023 - 8s/epoch - 25ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1337 - accuracy10: 0.4531 - val_loss: 3.2608 - val_accuracy10: 0.4070 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h10
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0815133
{'0': {'precision': 0.4519214427343971, 'recall': 0.2554191792518277, 'f1-score': 0.3263757245141493, 'support': 187390}, '1': {'precision': 0.3733055058636454, 'recall': 0.3816474859616205, 'f1-score': 0.37743040785635096, 'support': 147631}, '2': {'precision': 0.40459553421845007, 'recall': 0.5766415020450788, 'f1-score': 0.4755356105612782, 'support': 183856}, 'accuracy': 0.4051538225822305, 'macro avg': {'precision': 0.4099408276054975, 'recall': 0.4045693890861757, 'f1-score': 0.39311391431059284, 'support': 518877}, 'weighted avg': {'precision': 0.4127844187146894, 'recall': 0.4051538225822305, 'f1-score': 0.3937543016443237, 'support': 518877}}
[[ 47863  49883  89644]
 [ 24914  56343  66374]
 [ 33133  44704 106019]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0714214
{'0': {'precision': 0.4155723775683609, 'recall': 0.38362806617227607, 'f1-score': 0.3989618094178717, 'support': 28048}, '1': {'precision': 0.4291306850892343, 'recall': 0.3946281720961423, 'f1-score': 0.41115687283959695, 'support': 28333}, '2': {'precision': 0.41033752034642673, 'recall': 0.4750239982934547, 'f1-score': 0.4403176904824677, 'support': 28127}, 'accuracy': 0.4177355989965447, 'macro avg': {'precision': 0.4183468610013406, 'recall': 0.4177600788539577, 'f1-score': 0.41681212424664543, 'support': 84508}, 'weighted avg': {'precision': 0.41837574172214, 'recall': 0.4177355989965447, 'f1-score': 0.4168150256652286, 'support': 84508}}
[[10760  7819  9469]
 [ 7421 11181  9731]
 [ 7711  7055 13361]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.081412
{'0': {'precision': 0.43262583383869013, 'recall': 0.29047231270358304, 'f1-score': 0.3475761266747868, 'support': 12280}, '1': {'precision': 0.3912474729456535, 'recall': 0.3109053109053109, 'f1-score': 0.3464799115370439, 'support': 10582}, '2': {'precision': 0.39504736579690874, 'recall': 0.6021278392299249, 'f1-score': 0.47708570281661866, 'support': 11843}, 'accuracy': 0.4030543149402103, 'macro avg': {'precision': 0.40630689086041744, 'recall': 0.40116848761293955, 'f1-score': 0.3903805803428164, 'support': 34705}, 'weighted avg': {'precision': 0.4071854761960182, 'recall': 0.4030543149402103, 'f1-score': 0.391436716263034, 'support': 34705}}
[[3567 2838 5875]
 [2247 3290 5045]
 [2431 2281 7131]]
training model: results/CHTR/W5/deepLOB_L1/h20
Epoch 1/50
331/331 - 10s - loss: 3.3273 - accuracy20: 0.3584 - val_loss: 3.3927 - val_accuracy20: 0.3472 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2883 - accuracy20: 0.3780 - val_loss: 3.3130 - val_accuracy20: 0.3652 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2752 - accuracy20: 0.3850 - val_loss: 3.3328 - val_accuracy20: 0.3653 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2628 - accuracy20: 0.3942 - val_loss: 3.3278 - val_accuracy20: 0.3583 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2468 - accuracy20: 0.4033 - val_loss: 3.3346 - val_accuracy20: 0.3573 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2402 - accuracy20: 0.4052 - val_loss: 3.2925 - val_accuracy20: 0.3835 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2331 - accuracy20: 0.4087 - val_loss: 3.2810 - val_accuracy20: 0.3853 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2236 - accuracy20: 0.4157 - val_loss: 3.2747 - val_accuracy20: 0.3940 - 8s/epoch - 25ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2216 - accuracy20: 0.4160 - val_loss: 3.2670 - val_accuracy20: 0.3916 - 8s/epoch - 25ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2159 - accuracy20: 0.4191 - val_loss: 3.2765 - val_accuracy20: 0.3868 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2115 - accuracy20: 0.4218 - val_loss: 3.2656 - val_accuracy20: 0.3911 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2043 - accuracy20: 0.4243 - val_loss: 3.2626 - val_accuracy20: 0.3933 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2012 - accuracy20: 0.4257 - val_loss: 3.2615 - val_accuracy20: 0.3956 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1970 - accuracy20: 0.4270 - val_loss: 3.2559 - val_accuracy20: 0.3953 - 8s/epoch - 25ms/step
Epoch 15/50
331/331 - 8s - loss: 3.1940 - accuracy20: 0.4296 - val_loss: 3.2644 - val_accuracy20: 0.3919 - 8s/epoch - 25ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1933 - accuracy20: 0.4295 - val_loss: 3.2633 - val_accuracy20: 0.3906 - 8s/epoch - 25ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1892 - accuracy20: 0.4319 - val_loss: 3.2701 - val_accuracy20: 0.3939 - 8s/epoch - 25ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1842 - accuracy20: 0.4345 - val_loss: 3.2569 - val_accuracy20: 0.3999 - 8s/epoch - 25ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1791 - accuracy20: 0.4363 - val_loss: 3.2629 - val_accuracy20: 0.3944 - 8s/epoch - 25ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1779 - accuracy20: 0.4365 - val_loss: 3.2572 - val_accuracy20: 0.3972 - 8s/epoch - 25ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1727 - accuracy20: 0.4397 - val_loss: 3.2556 - val_accuracy20: 0.3988 - 8s/epoch - 25ms/step
Epoch 22/50
331/331 - 8s - loss: 3.1684 - accuracy20: 0.4418 - val_loss: 3.2578 - val_accuracy20: 0.3960 - 8s/epoch - 25ms/step
Epoch 23/50
331/331 - 8s - loss: 3.1641 - accuracy20: 0.4441 - val_loss: 3.2621 - val_accuracy20: 0.3982 - 8s/epoch - 25ms/step
Epoch 24/50
331/331 - 8s - loss: 3.1639 - accuracy20: 0.4425 - val_loss: 3.2631 - val_accuracy20: 0.3966 - 8s/epoch - 25ms/step
Epoch 25/50
331/331 - 8s - loss: 3.1583 - accuracy20: 0.4453 - val_loss: 3.2677 - val_accuracy20: 0.3939 - 8s/epoch - 25ms/step
Epoch 26/50
331/331 - 8s - loss: 3.1560 - accuracy20: 0.4471 - val_loss: 3.2684 - val_accuracy20: 0.3922 - 8s/epoch - 25ms/step
Epoch 27/50
331/331 - 8s - loss: 3.1494 - accuracy20: 0.4501 - val_loss: 3.2752 - val_accuracy20: 0.3896 - 8s/epoch - 25ms/step
Epoch 28/50
331/331 - 8s - loss: 3.1484 - accuracy20: 0.4492 - val_loss: 3.2765 - val_accuracy20: 0.3869 - 8s/epoch - 24ms/step
Epoch 29/50
331/331 - 8s - loss: 3.1448 - accuracy20: 0.4495 - val_loss: 3.2759 - val_accuracy20: 0.3917 - 8s/epoch - 24ms/step
Epoch 30/50
331/331 - 8s - loss: 3.1419 - accuracy20: 0.4524 - val_loss: 3.2791 - val_accuracy20: 0.3918 - 8s/epoch - 25ms/step
Epoch 31/50
331/331 - 8s - loss: 3.1419 - accuracy20: 0.4511 - val_loss: 3.2837 - val_accuracy20: 0.3898 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h20
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0882267
{'0': {'precision': 0.44376065036414747, 'recall': 0.21617863223459494, 'f1-score': 0.29072847446659483, 'support': 189126}, '1': {'precision': 0.3583142108496684, 'recall': 0.4584587476484816, 'f1-score': 0.4022471181534961, 'support': 148840}, '2': {'precision': 0.40288186877129134, 'recall': 0.5262421853839734, 'f1-score': 0.45637271820831415, 'support': 180911}, 'accuracy': 0.3937831123753799, 'macro avg': {'precision': 0.4016522433283691, 'recall': 0.40029318842234995, 'f1-score': 0.38311610360946835, 'support': 518877}, 'weighted avg': {'precision': 0.40499757296029215, 'recall': 0.3937831123753799, 'f1-score': 0.3804709388770747, 'support': 518877}}
[[40885 66151 82090]
 [21591 68237 59012]
 [29657 56051 95203]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0856582
{'0': {'precision': 0.40727743660441995, 'recall': 0.3434439512435708, 'f1-score': 0.37264682835464324, 'support': 28386}, '1': {'precision': 0.39709031578231757, 'recall': 0.42051835853131747, 'f1-score': 0.4084686795223693, 'support': 27780}, '2': {'precision': 0.4102144324601952, 'recall': 0.450885611460024, 'f1-score': 0.4295895384408512, 'support': 28342}, 'accuracy': 0.4048137454442183, 'macro avg': {'precision': 0.4048607282823109, 'recall': 0.40494930707830407, 'f1-score': 0.4035683487726212, 'support': 84508}, 'weighted avg': {'precision': 0.40491366181512634, 'recall': 0.4048137454442183, 'f1-score': 0.4035196606865259, 'support': 84508}}
[[ 9749  9452  9185]
 [ 6910 11682  9188]
 [ 7278  8285 12779]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0861548
{'0': {'precision': 0.4265281173594132, 'recall': 0.2802859897172236, 'f1-score': 0.3382780686445608, 'support': 12448}, '1': {'precision': 0.3765819302299989, 'recall': 0.32999035679845706, 'f1-score': 0.35175001284884616, 'support': 10370}, '2': {'precision': 0.39459800435829795, 'recall': 0.5788676705644822, 'f1-score': 0.4692924126172208, 'support': 11887}, 'accuracy': 0.3974067137300101, 'macro avg': {'precision': 0.39923601731590336, 'recall': 0.39638133902672096, 'f1-score': 0.38644016470354264, 'support': 34705}, 'weighted avg': {'precision': 0.40066742830088325, 'recall': 0.3974067137300101, 'f1-score': 0.38717798416686156, 'support': 34705}}
[[3489 3165 5794]
 [2185 3422 4763]
 [2506 2500 6881]]
training model: results/CHTR/W5/deepLOB_L1/h30
Epoch 1/50
331/331 - 10s - loss: 3.3304 - accuracy30: 0.3573 - val_loss: 3.4563 - val_accuracy30: 0.3269 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2976 - accuracy30: 0.3686 - val_loss: 3.3598 - val_accuracy30: 0.3440 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2758 - accuracy30: 0.3800 - val_loss: 3.3638 - val_accuracy30: 0.3436 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2599 - accuracy30: 0.3917 - val_loss: 3.3226 - val_accuracy30: 0.3538 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2557 - accuracy30: 0.3953 - val_loss: 3.3122 - val_accuracy30: 0.3708 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2513 - accuracy30: 0.3974 - val_loss: 3.3198 - val_accuracy30: 0.3665 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2501 - accuracy30: 0.3991 - val_loss: 3.3112 - val_accuracy30: 0.3661 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2421 - accuracy30: 0.4026 - val_loss: 3.3176 - val_accuracy30: 0.3757 - 8s/epoch - 25ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2359 - accuracy30: 0.4099 - val_loss: 3.3064 - val_accuracy30: 0.3695 - 8s/epoch - 25ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2309 - accuracy30: 0.4124 - val_loss: 3.3024 - val_accuracy30: 0.3758 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2265 - accuracy30: 0.4137 - val_loss: 3.2929 - val_accuracy30: 0.3730 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2236 - accuracy30: 0.4168 - val_loss: 3.2999 - val_accuracy30: 0.3819 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2197 - accuracy30: 0.4161 - val_loss: 3.2998 - val_accuracy30: 0.3801 - 8s/epoch - 24ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2167 - accuracy30: 0.4192 - val_loss: 3.2945 - val_accuracy30: 0.3750 - 8s/epoch - 24ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2141 - accuracy30: 0.4216 - val_loss: 3.2997 - val_accuracy30: 0.3831 - 8s/epoch - 24ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2099 - accuracy30: 0.4224 - val_loss: 3.2973 - val_accuracy30: 0.3845 - 8s/epoch - 24ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2038 - accuracy30: 0.4261 - val_loss: 3.2985 - val_accuracy30: 0.3844 - 8s/epoch - 25ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2039 - accuracy30: 0.4270 - val_loss: 3.2956 - val_accuracy30: 0.3900 - 8s/epoch - 25ms/step
Epoch 19/50
331/331 - 8s - loss: 3.2036 - accuracy30: 0.4255 - val_loss: 3.3174 - val_accuracy30: 0.3814 - 8s/epoch - 25ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1980 - accuracy30: 0.4277 - val_loss: 3.3117 - val_accuracy30: 0.3791 - 8s/epoch - 25ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1943 - accuracy30: 0.4309 - val_loss: 3.3127 - val_accuracy30: 0.3851 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h30
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0948484
{'0': {'precision': 0.4234203050774629, 'recall': 0.18707384341167846, 'f1-score': 0.2594975366935734, 'support': 189631}, '1': {'precision': 0.3400212831995743, 'recall': 0.40697890407323867, 'f1-score': 0.3704992088512037, 'support': 150740}, '2': {'precision': 0.38446858888526764, 'recall': 0.5485137754473239, 'f1-score': 0.4520692465204754, 'support': 178506}, 'accuracy': 0.3753028174307206, 'macro avg': {'precision': 0.3826367257207683, 'recall': 0.3808555076440803, 'f1-score': 0.3606886640217508, 'support': 518877}, 'weighted avg': {'precision': 0.38579157301094824, 'recall': 0.3753028174307206, 'f1-score': 0.3579940930940347, 'support': 518877}}
[[35475 65159 88997]
 [21631 61348 67761]
 [26676 53917 97913]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0862424
{'0': {'precision': 0.4019052271617001, 'recall': 0.2908917332579026, 'f1-score': 0.33750410239579914, 'support': 28282}, '1': {'precision': 0.38058072426063816, 'recall': 0.4547630958336311, 'f1-score': 0.4143780422289873, 'support': 27986}, '2': {'precision': 0.40566068568813934, 'recall': 0.4395184135977337, 'f1-score': 0.4219113822934548, 'support': 28240}, 'accuracy': 0.39482652529937995, 'macro avg': {'precision': 0.3960488790368259, 'recall': 0.39505774756308915, 'f1-score': 0.3912645089727471, 'support': 84508}, 'weighted avg': {'precision': 0.39609828119915835, 'recall': 0.39482652529937995, 'f1-score': 0.39116831956436776, 'support': 84508}}
[[ 8227 10916  9139]
 [ 6213 12727  9046]
 [ 6030  9798 12412]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0992785
{'0': {'precision': 0.41087835354649027, 'recall': 0.1792241102917602, 'f1-score': 0.24958142649849313, 'support': 12476}, '1': {'precision': 0.32866164893156846, 'recall': 0.3697683472844072, 'f1-score': 0.34800531305821464, 'support': 10274}, '2': {'precision': 0.38742657026660643, 'recall': 0.5737348389795065, 'f1-score': 0.4625240230621397, 'support': 11955}, 'accuracy': 0.3715314796138885, 'macro avg': {'precision': 0.37565552424822174, 'recall': 0.3742424321852247, 'f1-score': 0.3533702542062825, 'support': 34705}, 'weighted avg': {'precision': 0.3784605321281149, 'recall': 0.3715314796138885, 'f1-score': 0.35207201149872286, 'support': 34705}}
[[2236 4285 5955]
 [1585 3799 4890]
 [1621 3475 6859]]
training model: results/CHTR/W5/deepLOB_L1/h50
Epoch 1/50
331/331 - 11s - loss: 3.3409 - accuracy50: 0.3513 - val_loss: 3.3607 - val_accuracy50: 0.3305 - 11s/epoch - 32ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3087 - accuracy50: 0.3545 - val_loss: 3.3116 - val_accuracy50: 0.3549 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2945 - accuracy50: 0.3632 - val_loss: 3.3033 - val_accuracy50: 0.3590 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2838 - accuracy50: 0.3728 - val_loss: 3.3105 - val_accuracy50: 0.3586 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2779 - accuracy50: 0.3791 - val_loss: 3.3076 - val_accuracy50: 0.3566 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2717 - accuracy50: 0.3818 - val_loss: 3.3050 - val_accuracy50: 0.3553 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2639 - accuracy50: 0.3886 - val_loss: 3.3017 - val_accuracy50: 0.3586 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2614 - accuracy50: 0.3911 - val_loss: 3.3047 - val_accuracy50: 0.3606 - 8s/epoch - 24ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2579 - accuracy50: 0.3910 - val_loss: 3.3201 - val_accuracy50: 0.3546 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2563 - accuracy50: 0.3920 - val_loss: 3.3206 - val_accuracy50: 0.3502 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2519 - accuracy50: 0.3945 - val_loss: 3.3178 - val_accuracy50: 0.3502 - 8s/epoch - 24ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2489 - accuracy50: 0.3973 - val_loss: 3.3176 - val_accuracy50: 0.3603 - 8s/epoch - 24ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2468 - accuracy50: 0.3972 - val_loss: 3.3224 - val_accuracy50: 0.3574 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2423 - accuracy50: 0.4016 - val_loss: 3.3198 - val_accuracy50: 0.3514 - 8s/epoch - 24ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2414 - accuracy50: 0.4023 - val_loss: 3.3185 - val_accuracy50: 0.3525 - 8s/epoch - 25ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2376 - accuracy50: 0.4052 - val_loss: 3.3222 - val_accuracy50: 0.3521 - 8s/epoch - 25ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2325 - accuracy50: 0.4063 - val_loss: 3.3251 - val_accuracy50: 0.3508 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h50
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1044557
{'0': {'precision': 0.3780125321336761, 'recall': 0.10044828690361832, 'f1-score': 0.15872025365557485, 'support': 187380}, '1': {'precision': 0.3263424528127142, 'recall': 0.4451413628439324, 'f1-score': 0.3765951307098732, 'support': 158316}, '2': {'precision': 0.3557520236077697, 'recall': 0.5199993070833405, 'f1-score': 0.4224733649529224, 'support': 173181}, 'accuracy': 0.34564839065905795, 'macro avg': {'precision': 0.35336900285138667, 'recall': 0.35519631894363046, 'f1-score': 0.31926291643945687, 'support': 518877}, 'weighted avg': {'precision': 0.3548176373805797, 'recall': 0.34564839065905795, 'f1-score': 0.31322721118754143, 'support': 518877}}
[[18822 78752 89806]
 [14566 70473 73277]
 [16404 66723 90054]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0969684
{'0': {'precision': 0.3742391965916007, 'recall': 0.1738223965511149, 'f1-score': 0.23738628960258668, 'support': 28299}, '1': {'precision': 0.35258205846441143, 'recall': 0.5305688655114025, 'f1-score': 0.4236400770934614, 'support': 27757}, '2': {'precision': 0.3831052542659233, 'recall': 0.39849571207647966, 'f1-score': 0.39064895687976986, 'support': 28452}, 'accuracy': 0.3666398447484262, 'macro avg': {'precision': 0.3699755031073118, 'recall': 0.3676289913796657, 'f1-score': 0.35055844119193935, 'support': 84508}, 'weighted avg': {'precision': 0.3701108287442186, 'recall': 0.3666398447484262, 'f1-score': 0.35016230830797107, 'support': 84508}}
[[ 4919 13887  9493]
 [ 4266 14727  8764]
 [ 3959 13155 11338]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1026748
{'0': {'precision': 0.37592968221771467, 'recall': 0.13402973081558858, 'f1-score': 0.1976069186115389, 'support': 12445}, '1': {'precision': 0.3315941563653877, 'recall': 0.39897624106625457, 'f1-score': 0.36217780115728565, 'support': 10354}, '2': {'precision': 0.36984839977540707, 'recall': 0.553250461951957, 'f1-score': 0.4433301924888949, 'support': 11906}, 'accuracy': 0.35689381933438985, 'macro avg': {'precision': 0.3591240794528365, 'recall': 0.36208547794460005, 'f1-score': 0.3343716374192398, 'support': 34705}, 'weighted avg': {'precision': 0.36061621777647834, 'recall': 0.35689381933438985, 'f1-score': 0.33100407223961736, 'support': 34705}}
[[1668 4503 6274]
 [1274 4131 4949]
 [1495 3824 6587]]
training model: results/CHTR/W5/deepLOB_L1/h100
Epoch 1/50
331/331 - 10s - loss: 3.3492 - accuracy100: 0.3450 - val_loss: 3.4214 - val_accuracy100: 0.3292 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3221 - accuracy100: 0.3471 - val_loss: 3.3561 - val_accuracy100: 0.3325 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3033 - accuracy100: 0.3534 - val_loss: 3.3367 - val_accuracy100: 0.3400 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2922 - accuracy100: 0.3598 - val_loss: 3.3685 - val_accuracy100: 0.3295 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2873 - accuracy100: 0.3615 - val_loss: 3.3519 - val_accuracy100: 0.3306 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2820 - accuracy100: 0.3688 - val_loss: 3.3541 - val_accuracy100: 0.3296 - 8s/epoch - 24ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2796 - accuracy100: 0.3718 - val_loss: 3.3322 - val_accuracy100: 0.3399 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2753 - accuracy100: 0.3752 - val_loss: 3.3324 - val_accuracy100: 0.3441 - 8s/epoch - 24ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2727 - accuracy100: 0.3769 - val_loss: 3.3188 - val_accuracy100: 0.3519 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2709 - accuracy100: 0.3795 - val_loss: 3.3229 - val_accuracy100: 0.3472 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2681 - accuracy100: 0.3822 - val_loss: 3.3373 - val_accuracy100: 0.3458 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2666 - accuracy100: 0.3826 - val_loss: 3.3248 - val_accuracy100: 0.3489 - 8s/epoch - 24ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2627 - accuracy100: 0.3837 - val_loss: 3.3308 - val_accuracy100: 0.3527 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2606 - accuracy100: 0.3884 - val_loss: 3.3403 - val_accuracy100: 0.3438 - 8s/epoch - 25ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2570 - accuracy100: 0.3902 - val_loss: 3.3346 - val_accuracy100: 0.3562 - 8s/epoch - 24ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2541 - accuracy100: 0.3898 - val_loss: 3.3345 - val_accuracy100: 0.3516 - 8s/epoch - 25ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2504 - accuracy100: 0.3938 - val_loss: 3.3312 - val_accuracy100: 0.3480 - 8s/epoch - 25ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2522 - accuracy100: 0.3955 - val_loss: 3.3318 - val_accuracy100: 0.3501 - 8s/epoch - 25ms/step
Epoch 19/50
331/331 - 8s - loss: 3.2464 - accuracy100: 0.3960 - val_loss: 3.3361 - val_accuracy100: 0.3487 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h100
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1085479
{'0': {'precision': 0.3379964507726315, 'recall': 0.1833179484870317, 'f1-score': 0.23770997325042062, 'support': 177664}, '1': {'precision': 0.34678216324143357, 'recall': 0.3915137301334305, 'f1-score': 0.36779285783039756, 'support': 175672}, '2': {'precision': 0.3300161473062546, 'recall': 0.44692855546360116, 'f1-score': 0.37967602963099817, 'support': 165541}, 'accuracy': 0.337906671523309, 'macro avg': {'precision': 0.33826492044010653, 'recall': 0.34058674469468775, 'f1-score': 0.32839295357060544, 'support': 518877}, 'weighted avg': {'precision': 0.3384249458970866, 'recall': 0.337906671523309, 'f1-score': 0.32704352135378784, 'support': 518877}}
[[32569 67760 77335]
 [34028 68778 72866]
 [29762 61794 73985]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.107279
{'0': {'precision': 0.3458534507242261, 'recall': 0.17339456072903317, 'f1-score': 0.23098444613050076, 'support': 28092}, '1': {'precision': 0.3462972456540989, 'recall': 0.5327478042659974, 'f1-score': 0.41974890197573755, 'support': 27895}, '2': {'precision': 0.3629952744456561, 'recall': 0.35012797587742367, 'f1-score': 0.35644553907658266, 'support': 28521}, 'accuracy': 0.35165901453116866, 'macro avg': {'precision': 0.35171532360799374, 'recall': 0.35209011362415144, 'f1-score': 0.335726295727607, 'support': 84508}, 'weighted avg': {'precision': 0.3517852159290316, 'recall': 0.35165901453116866, 'f1-score': 0.3356356072953382, 'support': 84508}}
[[ 4871 14064  9157]
 [ 4667 14861  8367]
 [ 4546 13989  9986]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1066786
{'0': {'precision': 0.36172901921132455, 'recall': 0.11555232558139535, 'f1-score': 0.1751529987760098, 'support': 12384}, '1': {'precision': 0.3274544385655497, 'recall': 0.42273029124371503, 'f1-score': 0.36904219636423863, 'support': 10541}, '2': {'precision': 0.36258094626917914, 'recall': 0.5275891341256367, 'f1-score': 0.42979150098544305, 'support': 11780}, 'accuracy': 0.3487105604379772, 'macro avg': {'precision': 0.3505881346820178, 'recall': 0.35529058365024896, 'f1-score': 0.32466223204189715, 'support': 34705}, 'weighted avg': {'precision': 0.3516079227167103, 'recall': 0.3487105604379772, 'f1-score': 0.3204757934109224, 'support': 34705}}
[[1431 4882 6071]
 [1230 4456 4855]
 [1295 4270 6215]]
training model: results/CHTR/W5/deepLOB_L1/h200
Epoch 1/50
331/331 - 10s - loss: 3.3521 - accuracy200: 0.3460 - val_loss: 3.4980 - val_accuracy200: 0.3208 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3280 - accuracy200: 0.3474 - val_loss: 3.3711 - val_accuracy200: 0.3280 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3173 - accuracy200: 0.3485 - val_loss: 3.3526 - val_accuracy200: 0.3449 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.3043 - accuracy200: 0.3545 - val_loss: 3.3573 - val_accuracy200: 0.3401 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2964 - accuracy200: 0.3579 - val_loss: 3.3675 - val_accuracy200: 0.3436 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2902 - accuracy200: 0.3657 - val_loss: 3.3643 - val_accuracy200: 0.3461 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2833 - accuracy200: 0.3714 - val_loss: 3.3449 - val_accuracy200: 0.3441 - 8s/epoch - 24ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2829 - accuracy200: 0.3716 - val_loss: 3.3419 - val_accuracy200: 0.3424 - 8s/epoch - 24ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2763 - accuracy200: 0.3770 - val_loss: 3.3570 - val_accuracy200: 0.3419 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2707 - accuracy200: 0.3832 - val_loss: 3.3542 - val_accuracy200: 0.3497 - 8s/epoch - 24ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2679 - accuracy200: 0.3856 - val_loss: 3.3823 - val_accuracy200: 0.3407 - 8s/epoch - 24ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2612 - accuracy200: 0.3889 - val_loss: 3.3561 - val_accuracy200: 0.3480 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2571 - accuracy200: 0.3937 - val_loss: 3.3648 - val_accuracy200: 0.3460 - 8s/epoch - 24ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2521 - accuracy200: 0.3983 - val_loss: 3.3571 - val_accuracy200: 0.3506 - 8s/epoch - 25ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2499 - accuracy200: 0.3977 - val_loss: 3.3510 - val_accuracy200: 0.3412 - 8s/epoch - 25ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2438 - accuracy200: 0.4028 - val_loss: 3.3767 - val_accuracy200: 0.3393 - 8s/epoch - 25ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2421 - accuracy200: 0.4022 - val_loss: 3.3638 - val_accuracy200: 0.3463 - 8s/epoch - 25ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2375 - accuracy200: 0.4029 - val_loss: 3.3871 - val_accuracy200: 0.3431 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h200
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1152924
{'0': {'precision': 0.2994168768373199, 'recall': 0.1126502638115787, 'f1-score': 0.16370822537437965, 'support': 165459}, '1': {'precision': 0.3653603109146468, 'recall': 0.633455581674065, 'f1-score': 0.46342780484041823, 'support': 194413}, '2': {'precision': 0.3091772893037572, 'recall': 0.23247067702273513, 'f1-score': 0.2653924993089485, 'support': 159005}, 'accuracy': 0.34450361068230045, 'macro avg': {'precision': 0.324651492351908, 'recall': 0.3261921741694596, 'f1-score': 0.2975095098412488, 'support': 518877}, 'weighted avg': {'precision': 0.3271155708120022, 'recall': 0.34450361068230045, 'f1-score': 0.3071674470775908, 'support': 518877}}
[[ 18639 108642  38178]
 [ 26847 123152  44414]
 [ 16765 105276  36964]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1223471
{'0': {'precision': 0.3318996415770609, 'recall': 0.13314162473040977, 'f1-score': 0.1900461775269369, 'support': 27820}, '1': {'precision': 0.3331213407904828, 'recall': 0.6387045870243517, 'f1-score': 0.4378688040912667, 'support': 27883}, '2': {'precision': 0.3485694172072208, 'recall': 0.24065266446797431, 'f1-score': 0.28472849749445495, 'support': 28805}, 'accuracy': 0.3365953519193449, 'macro avg': {'precision': 0.33786346652492155, 'recall': 0.3374996254075786, 'f1-score': 0.3042144930375528, 'support': 84508}, 'weighted avg': {'precision': 0.33798471667284585, 'recall': 0.3365953519193449, 'f1-score': 0.30408700825488655, 'support': 84508}}
[[ 3704 17292  6824]
 [ 3943 17809  6131]
 [ 3513 18360  6932]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1119521
{'0': {'precision': 0.36599940244995516, 'recall': 0.10167662682602922, 'f1-score': 0.15914257875933743, 'support': 12048}, '1': {'precision': 0.3426012934608369, 'recall': 0.5705606186136426, 'f1-score': 0.4281273744560337, 'support': 10863}, '2': {'precision': 0.35230270596216173, 'recall': 0.39630320501950145, 'f1-score': 0.37300985595147834, 'support': 11794}, 'accuracy': 0.3485664889785334, 'macro avg': {'precision': 0.3536344672909846, 'recall': 0.3561801501530577, 'f1-score': 0.32009326972228314, 'support': 34705}, 'weighted avg': {'precision': 0.3540209412390107, 'recall': 0.3485664889785334, 'f1-score': 0.3160171646362232, 'support': 34705}}
[[1225 6002 4821]
 [ 893 6198 3772]
 [1229 5891 4674]]
training model: results/CHTR/W5/deepLOB_L1/h300
Epoch 1/50
331/331 - 10s - loss: 3.3540 - accuracy300: 0.3441 - val_loss: 3.4539 - val_accuracy300: 0.3354 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3170 - accuracy300: 0.3558 - val_loss: 3.3805 - val_accuracy300: 0.3362 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3027 - accuracy300: 0.3609 - val_loss: 3.3458 - val_accuracy300: 0.3504 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2916 - accuracy300: 0.3679 - val_loss: 3.3917 - val_accuracy300: 0.3380 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2836 - accuracy300: 0.3736 - val_loss: 3.3927 - val_accuracy300: 0.3310 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2767 - accuracy300: 0.3759 - val_loss: 3.3825 - val_accuracy300: 0.3304 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2730 - accuracy300: 0.3814 - val_loss: 3.4093 - val_accuracy300: 0.3271 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2654 - accuracy300: 0.3860 - val_loss: 3.3776 - val_accuracy300: 0.3363 - 8s/epoch - 24ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2611 - accuracy300: 0.3890 - val_loss: 3.3629 - val_accuracy300: 0.3422 - 8s/epoch - 25ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2558 - accuracy300: 0.3924 - val_loss: 3.3718 - val_accuracy300: 0.3432 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2486 - accuracy300: 0.3954 - val_loss: 3.4031 - val_accuracy300: 0.3446 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2460 - accuracy300: 0.3988 - val_loss: 3.4014 - val_accuracy300: 0.3388 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2430 - accuracy300: 0.3990 - val_loss: 3.3986 - val_accuracy300: 0.3289 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h300
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1287915
{'0': {'precision': 0.284342458065723, 'recall': 0.11375329753596887, 'f1-score': 0.1624980511815408, 'support': 160347}, '1': {'precision': 0.4065062848243991, 'recall': 0.19827173768292503, 'f1-score': 0.2665398029412935, 'support': 202747}, '2': {'precision': 0.3052860836330935, 'recall': 0.6973353960316594, 'f1-score': 0.42466034560604193, 'support': 155783}, 'accuracy': 0.3219876772337182, 'macro avg': {'precision': 0.3320449421744052, 'recall': 0.33645347708351775, 'f1-score': 0.2845660665762921, 'support': 518877}, 'weighted avg': {'precision': 0.33836491465100815, 'recall': 0.3219876772337182, 'f1-score': 0.2818607937127507, 'support': 518877}}
[[ 18240  30771 111336]
 [ 26677  40199 135871]
 [ 19231  27919 108633]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1210638
{'0': {'precision': 0.3191621149839518, 'recall': 0.20479838126896951, 'f1-score': 0.24949928469241778, 'support': 27676}, '1': {'precision': 0.35391450896277005, 'recall': 0.3314441495085731, 'f1-score': 0.34231096951061385, 'support': 27878}, '2': {'precision': 0.35948918579759354, 'recall': 0.5045934931270291, 'f1-score': 0.4198577484014656, 'support': 28954}, 'accuracy': 0.3492923746864202, 'macro avg': {'precision': 0.34418860324810513, 'recall': 0.34694534130152394, 'f1-score': 0.33722266753483243, 'support': 84508}, 'weighted avg': {'precision': 0.3444432392287532, 'recall': 0.3492923746864202, 'f1-score': 0.33848450629976196, 'support': 84508}}
[[ 5668  8280 13728]
 [ 6335  9240 12303]
 [ 5756  8588 14610]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1130905
{'0': {'precision': 0.33948685857321653, 'recall': 0.09096244131455399, 'f1-score': 0.14348056069822798, 'support': 11928}, '1': {'precision': 0.35282673380636304, 'recall': 0.2792572463768116, 'f1-score': 0.31176054201638187, 'support': 11040}, '2': {'precision': 0.3498309252997233, 'recall': 0.6787083581835222, 'f1-score': 0.46169004288860555, 'support': 11737}, 'accuracy': 0.3496326177784181, 'macro avg': {'precision': 0.34738150589310096, 'recall': 0.3496426819582959, 'f1-score': 0.3056437152010718, 'support': 34705}, 'weighted avg': {'precision': 0.3472286978973182, 'recall': 0.3496326177784181, 'f1-score': 0.30462839778858614, 'support': 34705}}
[[1085 2872 7971]
 [1123 3083 6834]
 [ 988 2783 7966]]
training model: results/CHTR/W5/deepLOB_L1/h500
Epoch 1/50
331/331 - 10s - loss: 3.3493 - accuracy500: 0.3488 - val_loss: 3.4300 - val_accuracy500: 0.3304 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3247 - accuracy500: 0.3530 - val_loss: 3.4581 - val_accuracy500: 0.3244 - 8s/epoch - 25ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3046 - accuracy500: 0.3569 - val_loss: 3.4245 - val_accuracy500: 0.3325 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.3015 - accuracy500: 0.3601 - val_loss: 3.4082 - val_accuracy500: 0.3291 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2912 - accuracy500: 0.3682 - val_loss: 3.3845 - val_accuracy500: 0.3403 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2835 - accuracy500: 0.3714 - val_loss: 3.3836 - val_accuracy500: 0.3400 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2757 - accuracy500: 0.3787 - val_loss: 3.4369 - val_accuracy500: 0.3311 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2663 - accuracy500: 0.3853 - val_loss: 3.4354 - val_accuracy500: 0.3394 - 8s/epoch - 25ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2569 - accuracy500: 0.3921 - val_loss: 3.4604 - val_accuracy500: 0.3332 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2550 - accuracy500: 0.3925 - val_loss: 3.4649 - val_accuracy500: 0.3454 - 8s/epoch - 25ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2412 - accuracy500: 0.4002 - val_loss: 3.5117 - val_accuracy500: 0.3358 - 8s/epoch - 24ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2378 - accuracy500: 0.4025 - val_loss: 3.5156 - val_accuracy500: 0.3413 - 8s/epoch - 24ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2280 - accuracy500: 0.4108 - val_loss: 3.5185 - val_accuracy500: 0.3365 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2238 - accuracy500: 0.4115 - val_loss: 3.5537 - val_accuracy500: 0.3345 - 8s/epoch - 25ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2141 - accuracy500: 0.4155 - val_loss: 3.5330 - val_accuracy500: 0.3274 - 8s/epoch - 24ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2099 - accuracy500: 0.4195 - val_loss: 3.5444 - val_accuracy500: 0.3440 - 8s/epoch - 25ms/step
testing model: results/CHTR/W5/deepLOB_L1/h500
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1090807
{'0': {'precision': 0.273281661304475, 'recall': 0.11940651377964076, 'f1-score': 0.16619604320545714, 'support': 156499}, '1': {'precision': 0.39338665669635503, 'recall': 0.4256781489615844, 'f1-score': 0.4088958595020483, 'support': 207624}, '2': {'precision': 0.30928574591506885, 'recall': 0.451335668221823, 'f1-score': 0.36704643390158287, 'support': 154754}, 'accuracy': 0.34095556364995944, 'macro avg': {'precision': 0.32531802130529963, 'recall': 0.33214011032101604, 'f1-score': 0.3140461122030294, 'support': 518877}, 'weighted avg': {'precision': 0.33207874745990595, 'recall': 0.34095556364995944, 'f1-score': 0.3232134250137695, 'support': 518877}}
[[18687 68030 69782]
 [33041 88381 86202]
 [16652 68256 69846]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1204432
{'0': {'precision': 0.3159593351621752, 'recall': 0.0720806950375497, 'f1-score': 0.11738257246485416, 'support': 27164}, '1': {'precision': 0.34573670243452176, 'recall': 0.6470059018281272, 'f1-score': 0.45065797719012407, 'support': 27788}, '2': {'precision': 0.36584438785206586, 'recall': 0.32565299769928274, 'f1-score': 0.3445806855813121, 'support': 29556}, 'accuracy': 0.3498130354522649, 'macro avg': {'precision': 0.3425134751495876, 'recall': 0.3482465315216532, 'f1-score': 0.30420707841209677, 'support': 84508}, 'weighted avg': {'precision': 0.34319765696681354, 'recall': 0.3498130354522649, 'f1-score': 0.30643123505035885, 'support': 84508}}
[[ 1958 16169  9037]
 [ 2162 17979  7647]
 [ 2077 17854  9625]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1268371
{'0': {'precision': 0.33636363636363636, 'recall': 0.12728645745930525, 'f1-score': 0.18468468468468466, 'support': 11918}, '1': {'precision': 0.3590077384826788, 'recall': 0.45553822152886114, 'f1-score': 0.40155314674000975, 'support': 10897}, '2': {'precision': 0.32783479960899314, 'recall': 0.45130361648444073, 'f1-score': 0.3797862552197608, 'support': 11890}, 'accuracy': 0.34136291600633917, 'macro avg': {'precision': 0.3410687248184361, 'recall': 0.3447094318242024, 'f1-score': 0.32200802888148505, 'support': 34705}, 'weighted avg': {'precision': 0.34055164707617047, 'recall': 0.34136291600633917, 'f1-score': 0.3196212443930533, 'support': 34705}}
[[1517 4254 6147]
 [1078 4964 4855]
 [1915 4609 5366]]
training model: results/CHTR/W5/deepLOB_L1/h1000
Epoch 1/50
331/331 - 11s - loss: 3.3452 - accuracy1000: 0.3544 - val_loss: 3.5868 - val_accuracy1000: 0.3443 - 11s/epoch - 32ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3037 - accuracy1000: 0.3714 - val_loss: 3.8161 - val_accuracy1000: 0.3400 - 8s/epoch - 24ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2930 - accuracy1000: 0.3717 - val_loss: 3.4391 - val_accuracy1000: 0.3303 - 8s/epoch - 25ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2685 - accuracy1000: 0.3824 - val_loss: 3.4184 - val_accuracy1000: 0.3234 - 8s/epoch - 25ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2580 - accuracy1000: 0.3894 - val_loss: 3.5659 - val_accuracy1000: 0.3185 - 8s/epoch - 25ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2538 - accuracy1000: 0.3978 - val_loss: 3.5699 - val_accuracy1000: 0.3163 - 8s/epoch - 25ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2441 - accuracy1000: 0.3967 - val_loss: 3.5264 - val_accuracy1000: 0.3166 - 8s/epoch - 25ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2237 - accuracy1000: 0.4038 - val_loss: 3.5737 - val_accuracy1000: 0.3174 - 8s/epoch - 25ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2133 - accuracy1000: 0.4139 - val_loss: 3.5247 - val_accuracy1000: 0.3105 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2000 - accuracy1000: 0.4236 - val_loss: 3.6001 - val_accuracy1000: 0.3111 - 8s/epoch - 24ms/step
Epoch 11/50
331/331 - 8s - loss: 3.1839 - accuracy1000: 0.4303 - val_loss: 3.6460 - val_accuracy1000: 0.3113 - 8s/epoch - 25ms/step
Epoch 12/50
331/331 - 8s - loss: 3.1698 - accuracy1000: 0.4360 - val_loss: 3.6591 - val_accuracy1000: 0.3122 - 8s/epoch - 25ms/step
Epoch 13/50
331/331 - 8s - loss: 3.1595 - accuracy1000: 0.4373 - val_loss: 3.6796 - val_accuracy1000: 0.3108 - 8s/epoch - 25ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1472 - accuracy1000: 0.4450 - val_loss: 3.6472 - val_accuracy1000: 0.3152 - 8s/epoch - 24ms/step
testing model: results/CHTR/W5/deepLOB_L1/h1000
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1204959
{'0': {'precision': 0.2999054141833141, 'recall': 0.340543093575916, 'f1-score': 0.31893498474524407, 'support': 154559}, '1': {'precision': 0.43589443273209966, 'recall': 0.15941042652223988, 'f1-score': 0.23344717033732926, 'support': 210118}, '2': {'precision': 0.3067687678448823, 'recall': 0.5302464332036316, 'f1-score': 0.38867405218986867, 'support': 154200}, 'accuracy': 0.32356994046758675, 'macro avg': {'precision': 0.34752287158676537, 'recall': 0.3433999844339291, 'f1-score': 0.31368540242414733, 'support': 518877}, 'weighted avg': {'precision': 0.35701349516213476, 'recall': 0.32356994046758675, 'f1-score': 0.30504197274470995, 'support': 518877}}
[[ 52634  22267  79658]
 [ 71512  33495 105111]
 [ 51356  21080  81764]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1525177
{'0': {'precision': 0.3064974991969899, 'recall': 0.49011263161756613, 'f1-score': 0.3771438250779894, 'support': 27257}, '1': {'precision': 0.3538652335675899, 'recall': 0.0919342712920202, 'f1-score': 0.14595055413469735, 'support': 27933}, '2': {'precision': 0.3558294965097282, 'recall': 0.408588580394297, 'f1-score': 0.3803883587634759, 'support': 29318}, 'accuracy': 0.3302172575377479, 'macro avg': {'precision': 0.33873074309143597, 'recall': 0.3302118277679611, 'f1-score': 0.30116091265872086, 'support': 84508}, 'weighted avg': {'precision': 0.3392688157751699, 'recall': 0.3302172575377479, 'f1-score': 0.3018515640060449, 'support': 84508}}
[[13359  2299 11599]
 [15278  2568 10087]
 [14949  2390 11979]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1368779
{'0': {'precision': 0.3096911987185192, 'recall': 0.28930085626402857, 'f1-score': 0.29914897274993546, 'support': 12029}, '1': {'precision': 0.31756756756756754, 'recall': 0.06538069182973198, 'f1-score': 0.10843651465046526, 'support': 10783}, '2': {'precision': 0.33499623493975905, 'recall': 0.598503321281426, 'f1-score': 0.42955855284994415, 'support': 11893}, 'accuracy': 0.32568794121884453, 'macro avg': {'precision': 0.3207516670752819, 'recall': 0.31772828979172885, 'f1-score': 0.27904801341678165, 'support': 34705}, 'weighted avg': {'precision': 0.3208101637402306, 'recall': 0.32568794121884453, 'f1-score': 0.28458359889725765, 'support': 34705}}
[[3480  650 7899]
 [3847  705 6231]
 [3910  865 7118]]
training model: results/CHTR/W5/deepOF_L1/h10
Epoch 1/50
331/331 - 10s - loss: 3.2859 - accuracy10: 0.3883 - val_loss: 3.2703 - val_accuracy10: 0.4033 - 10s/epoch - 30ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2390 - accuracy10: 0.4146 - val_loss: 3.2479 - val_accuracy10: 0.4137 - 8s/epoch - 24ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2196 - accuracy10: 0.4228 - val_loss: 3.2364 - val_accuracy10: 0.4173 - 8s/epoch - 24ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2010 - accuracy10: 0.4327 - val_loss: 3.2293 - val_accuracy10: 0.4214 - 8s/epoch - 24ms/step
Epoch 5/50
331/331 - 8s - loss: 3.1917 - accuracy10: 0.4342 - val_loss: 3.2207 - val_accuracy10: 0.4250 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.1822 - accuracy10: 0.4353 - val_loss: 3.2151 - val_accuracy10: 0.4261 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.1779 - accuracy10: 0.4367 - val_loss: 3.2101 - val_accuracy10: 0.4256 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.1706 - accuracy10: 0.4401 - val_loss: 3.2071 - val_accuracy10: 0.4256 - 8s/epoch - 24ms/step
Epoch 9/50
331/331 - 8s - loss: 3.1637 - accuracy10: 0.4442 - val_loss: 3.2080 - val_accuracy10: 0.4267 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.1580 - accuracy10: 0.4460 - val_loss: 3.2064 - val_accuracy10: 0.4256 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.1552 - accuracy10: 0.4478 - val_loss: 3.2058 - val_accuracy10: 0.4257 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.1487 - accuracy10: 0.4495 - val_loss: 3.2032 - val_accuracy10: 0.4275 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.1469 - accuracy10: 0.4508 - val_loss: 3.2026 - val_accuracy10: 0.4258 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1435 - accuracy10: 0.4519 - val_loss: 3.2066 - val_accuracy10: 0.4280 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.1391 - accuracy10: 0.4532 - val_loss: 3.2082 - val_accuracy10: 0.4246 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1374 - accuracy10: 0.4557 - val_loss: 3.2118 - val_accuracy10: 0.4248 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1332 - accuracy10: 0.4558 - val_loss: 3.2103 - val_accuracy10: 0.4217 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1283 - accuracy10: 0.4571 - val_loss: 3.2127 - val_accuracy10: 0.4226 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1269 - accuracy10: 0.4594 - val_loss: 3.2075 - val_accuracy10: 0.4228 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1244 - accuracy10: 0.4606 - val_loss: 3.2083 - val_accuracy10: 0.4229 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1195 - accuracy10: 0.4623 - val_loss: 3.2096 - val_accuracy10: 0.4260 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 8s - loss: 3.1183 - accuracy10: 0.4618 - val_loss: 3.2086 - val_accuracy10: 0.4228 - 8s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.1121 - accuracy10: 0.4638 - val_loss: 3.2075 - val_accuracy10: 0.4237 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h10
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0755539
{'0': {'precision': 0.4647054760048553, 'recall': 0.25129543356333617, 'f1-score': 0.32619613330470143, 'support': 187389}, '1': {'precision': 0.37524786426729084, 'recall': 0.5114645496481044, 'f1-score': 0.43289340916387653, 'support': 147629}, '2': {'precision': 0.43472633136094674, 'recall': 0.5114928149509937, 'f1-score': 0.4699955519349083, 'support': 183854}, 'accuracy': 0.41751530242526097, 'macro avg': {'precision': 0.4248932238776977, 'recall': 0.42475093272081144, 'f1-score': 0.40969503146782876, 'support': 518872}, 'weighted avg': {'precision': 0.4286304451252433, 'recall': 0.41751530242526097, 'f1-score': 0.4075065729712323, 'support': 518872}}
[[47090 68554 71745]
 [21587 75507 50535]
 [32656 57158 94040]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0523294
{'0': {'precision': 0.48830709559662333, 'recall': 0.3038725020409612, 'f1-score': 0.3746198446559458, 'support': 28173}, '1': {'precision': 0.4291079812206573, 'recall': 0.517957073032514, 'f1-score': 0.4693648297332863, 'support': 28234}, '2': {'precision': 0.4369622716079409, 'recall': 0.511531069827034, 'f1-score': 0.4713154399829483, 'support': 28098}, 'accuracy': 0.444447074137625, 'macro avg': {'precision': 0.4514591161417405, 'recall': 0.44445354830016975, 'f1-score': 0.4384333714573934, 'support': 84505}, 'weighted avg': {'precision': 0.4514558482180655, 'recall': 0.444447074137625, 'f1-score': 0.4384265158135311, 'support': 84505}}
[[ 8561 10288  9324]
 [ 4414 14624  9196]
 [ 4557  9168 14373]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0673842
{'0': {'precision': 0.47860929601775365, 'recall': 0.31463770465229374, 'f1-score': 0.3796762677881559, 'support': 12338}, '1': {'precision': 0.38356685957965275, 'recall': 0.4781205505457997, 'f1-score': 0.42565597667638483, 'support': 10535}, '2': {'precision': 0.4343336799881147, 'recall': 0.4941683569979716, 'f1-score': 0.46232308057246774, 'support': 11832}, 'accuracy': 0.4254718340296787, 'macro avg': {'precision': 0.4321699451951737, 'recall': 0.4289755373986883, 'f1-score': 0.42255177501233615, 'support': 34705}, 'weighted avg': {'precision': 0.43466343355591586, 'recall': 0.4254718340296787, 'f1-score': 0.4218106381094776, 'support': 34705}}
[[3882 4416 4040]
 [1923 5037 3575]
 [2306 3679 5847]]
training model: results/CHTR/W5/deepOF_L1/h20
Epoch 1/50
331/331 - 9s - loss: 3.2940 - accuracy20: 0.3782 - val_loss: 3.2816 - val_accuracy20: 0.3856 - 9s/epoch - 29ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2508 - accuracy20: 0.4071 - val_loss: 3.2718 - val_accuracy20: 0.3954 - 8s/epoch - 23ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2345 - accuracy20: 0.4157 - val_loss: 3.2547 - val_accuracy20: 0.4056 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2165 - accuracy20: 0.4228 - val_loss: 3.2529 - val_accuracy20: 0.4070 - 8s/epoch - 23ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2091 - accuracy20: 0.4256 - val_loss: 3.2437 - val_accuracy20: 0.4099 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2015 - accuracy20: 0.4288 - val_loss: 3.2435 - val_accuracy20: 0.4068 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.1964 - accuracy20: 0.4318 - val_loss: 3.2434 - val_accuracy20: 0.4074 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.1913 - accuracy20: 0.4328 - val_loss: 3.2341 - val_accuracy20: 0.4102 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.1854 - accuracy20: 0.4354 - val_loss: 3.2328 - val_accuracy20: 0.4119 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.1806 - accuracy20: 0.4370 - val_loss: 3.2296 - val_accuracy20: 0.4147 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.1778 - accuracy20: 0.4379 - val_loss: 3.2292 - val_accuracy20: 0.4149 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.1715 - accuracy20: 0.4404 - val_loss: 3.2309 - val_accuracy20: 0.4133 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.1700 - accuracy20: 0.4422 - val_loss: 3.2336 - val_accuracy20: 0.4101 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1660 - accuracy20: 0.4438 - val_loss: 3.2315 - val_accuracy20: 0.4142 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.1611 - accuracy20: 0.4450 - val_loss: 3.2290 - val_accuracy20: 0.4123 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1581 - accuracy20: 0.4450 - val_loss: 3.2339 - val_accuracy20: 0.4107 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1546 - accuracy20: 0.4491 - val_loss: 3.2309 - val_accuracy20: 0.4136 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1524 - accuracy20: 0.4487 - val_loss: 3.2328 - val_accuracy20: 0.4117 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1483 - accuracy20: 0.4493 - val_loss: 3.2305 - val_accuracy20: 0.4101 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1459 - accuracy20: 0.4500 - val_loss: 3.2311 - val_accuracy20: 0.4127 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1432 - accuracy20: 0.4525 - val_loss: 3.2296 - val_accuracy20: 0.4142 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 8s - loss: 3.1418 - accuracy20: 0.4530 - val_loss: 3.2362 - val_accuracy20: 0.4103 - 8s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.1371 - accuracy20: 0.4531 - val_loss: 3.2388 - val_accuracy20: 0.4101 - 8s/epoch - 23ms/step
Epoch 24/50
331/331 - 8s - loss: 3.1338 - accuracy20: 0.4564 - val_loss: 3.2362 - val_accuracy20: 0.4103 - 8s/epoch - 23ms/step
Epoch 25/50
331/331 - 8s - loss: 3.1302 - accuracy20: 0.4566 - val_loss: 3.2378 - val_accuracy20: 0.4108 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h20
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0905751
{'0': {'precision': 0.46943531025998914, 'recall': 0.20984644994818213, 'f1-score': 0.29003968340970376, 'support': 189124}, '1': {'precision': 0.34711606732656725, 'recall': 0.5583885943872238, 'f1-score': 0.4281052569223915, 'support': 148839}, '2': {'precision': 0.4304617752693689, 'recall': 0.4637524943479871, 'f1-score': 0.44648744441990473, 'support': 180909}, 'accuracy': 0.3983525802124609, 'macro avg': {'precision': 0.41567105095197504, 'recall': 0.4106625128944643, 'f1-score': 0.3882107949173333, 'support': 518872}, 'weighted avg': {'precision': 0.4207594575630125, 'recall': 0.3983525802124609, 'f1-score': 0.38419074550719484, 'support': 518872}}
[[39687 85820 63617]
 [18343 83110 47386]
 [26512 70500 83897]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0601766
{'0': {'precision': 0.5025370929411009, 'recall': 0.2749024981553705, 'f1-score': 0.35539404951169656, 'support': 28461}, '1': {'precision': 0.39859094249727567, 'recall': 0.5677363462440891, 'f1-score': 0.46836008457163275, 'support': 27703}, '2': {'precision': 0.44902805577229704, 'recall': 0.4670265692812533, 'f1-score': 0.45785049638520875, 'support': 28341}, 'accuracy': 0.43533518726702564, 'macro avg': {'precision': 0.45005203040355785, 'recall': 0.436555137893571, 'f1-score': 0.42720154348951267, 'support': 84505}, 'weighted avg': {'precision': 0.45051508444283034, 'recall': 0.43533518726702564, 'f1-score': 0.42678883360858577, 'support': 84505}}
[[ 7824 12588  8049]
 [ 3783 15728  8192]
 [ 3962 11143 13236]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0781544
{'0': {'precision': 0.4802077484559236, 'recall': 0.27575366758020314, 'f1-score': 0.35033282130056326, 'support': 12406}, '1': {'precision': 0.35930985825155537, 'recall': 0.5357689364957919, 'f1-score': 0.4301455062003302, 'support': 10456}, '2': {'precision': 0.4443703085904921, 'recall': 0.4498860086126826, 'f1-score': 0.44711114840767, 'support': 11843}, 'accuracy': 0.41351390289583634, 'macro avg': {'precision': 0.4279626384326571, 'recall': 0.42046953756289257, 'f1-score': 0.4091964919695212, 'support': 34705}, 'weighted avg': {'precision': 0.4315539193159386, 'recall': 0.41351390289583634, 'f1-score': 0.4074043430190888, 'support': 34705}}
[[3421 5460 3525]
 [1717 5602 3137]
 [1986 4529 5328]]
training model: results/CHTR/W5/deepOF_L1/h30
Epoch 1/50
331/331 - 10s - loss: 3.2992 - accuracy30: 0.3736 - val_loss: 3.2825 - val_accuracy30: 0.3849 - 10s/epoch - 29ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2561 - accuracy30: 0.3998 - val_loss: 3.2717 - val_accuracy30: 0.3918 - 8s/epoch - 24ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2417 - accuracy30: 0.4073 - val_loss: 3.2627 - val_accuracy30: 0.4004 - 8s/epoch - 24ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2279 - accuracy30: 0.4134 - val_loss: 3.2547 - val_accuracy30: 0.4032 - 8s/epoch - 24ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2195 - accuracy30: 0.4186 - val_loss: 3.2476 - val_accuracy30: 0.4048 - 8s/epoch - 24ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2134 - accuracy30: 0.4218 - val_loss: 3.2441 - val_accuracy30: 0.4053 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2083 - accuracy30: 0.4237 - val_loss: 3.2456 - val_accuracy30: 0.4052 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2034 - accuracy30: 0.4261 - val_loss: 3.2389 - val_accuracy30: 0.4086 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.1971 - accuracy30: 0.4295 - val_loss: 3.2376 - val_accuracy30: 0.4061 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.1940 - accuracy30: 0.4306 - val_loss: 3.2363 - val_accuracy30: 0.4095 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.1908 - accuracy30: 0.4311 - val_loss: 3.2370 - val_accuracy30: 0.4084 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.1864 - accuracy30: 0.4343 - val_loss: 3.2331 - val_accuracy30: 0.4091 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 7s - loss: 3.1820 - accuracy30: 0.4370 - val_loss: 3.2370 - val_accuracy30: 0.4078 - 7s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.1781 - accuracy30: 0.4376 - val_loss: 3.2340 - val_accuracy30: 0.4113 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.1762 - accuracy30: 0.4398 - val_loss: 3.2350 - val_accuracy30: 0.4091 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1737 - accuracy30: 0.4395 - val_loss: 3.2334 - val_accuracy30: 0.4104 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1711 - accuracy30: 0.4408 - val_loss: 3.2308 - val_accuracy30: 0.4124 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1656 - accuracy30: 0.4431 - val_loss: 3.2357 - val_accuracy30: 0.4092 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1640 - accuracy30: 0.4439 - val_loss: 3.2330 - val_accuracy30: 0.4122 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1605 - accuracy30: 0.4458 - val_loss: 3.2363 - val_accuracy30: 0.4116 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1573 - accuracy30: 0.4474 - val_loss: 3.2374 - val_accuracy30: 0.4094 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 8s - loss: 3.1548 - accuracy30: 0.4479 - val_loss: 3.2337 - val_accuracy30: 0.4142 - 8s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.1509 - accuracy30: 0.4496 - val_loss: 3.2370 - val_accuracy30: 0.4126 - 8s/epoch - 23ms/step
Epoch 24/50
331/331 - 8s - loss: 3.1473 - accuracy30: 0.4499 - val_loss: 3.2346 - val_accuracy30: 0.4133 - 8s/epoch - 23ms/step
Epoch 25/50
331/331 - 8s - loss: 3.1434 - accuracy30: 0.4521 - val_loss: 3.2393 - val_accuracy30: 0.4127 - 8s/epoch - 23ms/step
Epoch 26/50
331/331 - 8s - loss: 3.1423 - accuracy30: 0.4537 - val_loss: 3.2373 - val_accuracy30: 0.4146 - 8s/epoch - 23ms/step
Epoch 27/50
331/331 - 8s - loss: 3.1392 - accuracy30: 0.4538 - val_loss: 3.2442 - val_accuracy30: 0.4099 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h30
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0960733
{'0': {'precision': 0.46462667503734334, 'recall': 0.22636186257448715, 'f1-score': 0.3044153523204357, 'support': 189630}, '1': {'precision': 0.3370099368749272, 'recall': 0.5564054425198522, 'f1-score': 0.4197692750431671, 'support': 150739}, '2': {'precision': 0.4260507276975481, 'recall': 0.42393125045517444, 'f1-score': 0.42498834655928663, 'support': 178503}, 'accuracy': 0.39021184415424226, 'macro avg': {'precision': 0.4092291132032729, 'recall': 0.4022328518498379, 'f1-score': 0.38305765797429653, 'support': 518872}, 'weighted avg': {'precision': 0.41428142260155976, 'recall': 0.39021184415424226, 'f1-score': 0.3794068264179384, 'support': 518872}}
[[42925 89755 56950]
 [21875 83872 44992]
 [27586 75244 75673]]
Evaluating performance on  train set...
331/331 - 10s - 10s/epoch - 31ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.063702
{'0': {'precision': 0.493785447085797, 'recall': 0.28880968345272967, 'f1-score': 0.3644541426376611, 'support': 28337}, '1': {'precision': 0.3886449184441656, 'recall': 0.5772083855939796, 'f1-score': 0.46452003633794287, 'support': 27905}, '2': {'precision': 0.4551289311737834, 'recall': 0.426529384707922, 'f1-score': 0.44036529680365294, 'support': 28263}, 'accuracy': 0.43010472753091533, 'macro avg': {'precision': 0.44585309890124863, 'recall': 0.4308491512515437, 'f1-score': 0.4231131585930856, 'support': 84505}, 'weighted avg': {'precision': 0.44613743145398865, 'recall': 0.43010472753091533, 'f1-score': 0.4228863740310673, 'support': 84505}}
[[ 8184 13188  6965]
 [ 4331 16107  7467]
 [ 4059 12149 12055]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0795791
{'0': {'precision': 0.47648072081621834, 'recall': 0.2885109114249037, 'f1-score': 0.3594023287192044, 'support': 12464}, '1': {'precision': 0.34148578416386427, 'recall': 0.5396135265700484, 'f1-score': 0.418273731510953, 'support': 10350}, '2': {'precision': 0.45755808571693046, 'recall': 0.4156925405769069, 'f1-score': 0.43562175024235483, 'support': 11891}, 'accuracy': 0.406973058637084, 'macro avg': {'precision': 0.42517486356567097, 'recall': 0.41460565952395295, 'f1-score': 0.4044326034908374, 'support': 34705}, 'weighted avg': {'precision': 0.4297379849476836, 'recall': 0.406973058637084, 'f1-score': 0.40307454195148734, 'support': 34705}}
[[3596 5861 3007]
 [1912 5585 2853]
 [2039 4909 4943]]
training model: results/CHTR/W5/deepOF_L1/h50
Epoch 1/50
331/331 - 10s - loss: 3.3069 - accuracy50: 0.3646 - val_loss: 3.2863 - val_accuracy50: 0.3767 - 10s/epoch - 29ms/step
Epoch 2/50
331/331 - 7s - loss: 3.2719 - accuracy50: 0.3889 - val_loss: 3.2699 - val_accuracy50: 0.3865 - 7s/epoch - 22ms/step
Epoch 3/50
331/331 - 7s - loss: 3.2585 - accuracy50: 0.3947 - val_loss: 3.2627 - val_accuracy50: 0.3937 - 7s/epoch - 23ms/step
Epoch 4/50
331/331 - 7s - loss: 3.2456 - accuracy50: 0.4027 - val_loss: 3.2524 - val_accuracy50: 0.3986 - 7s/epoch - 22ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2396 - accuracy50: 0.4083 - val_loss: 3.2463 - val_accuracy50: 0.4029 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2344 - accuracy50: 0.4088 - val_loss: 3.2429 - val_accuracy50: 0.4056 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2317 - accuracy50: 0.4103 - val_loss: 3.2437 - val_accuracy50: 0.4055 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2255 - accuracy50: 0.4147 - val_loss: 3.2412 - val_accuracy50: 0.4067 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2204 - accuracy50: 0.4179 - val_loss: 3.2393 - val_accuracy50: 0.4081 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2184 - accuracy50: 0.4177 - val_loss: 3.2364 - val_accuracy50: 0.4088 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2144 - accuracy50: 0.4198 - val_loss: 3.2369 - val_accuracy50: 0.4113 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2103 - accuracy50: 0.4227 - val_loss: 3.2371 - val_accuracy50: 0.4090 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2074 - accuracy50: 0.4250 - val_loss: 3.2348 - val_accuracy50: 0.4100 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2054 - accuracy50: 0.4249 - val_loss: 3.2386 - val_accuracy50: 0.4071 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2013 - accuracy50: 0.4289 - val_loss: 3.2376 - val_accuracy50: 0.4092 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.1992 - accuracy50: 0.4272 - val_loss: 3.2366 - val_accuracy50: 0.4110 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.1943 - accuracy50: 0.4297 - val_loss: 3.2396 - val_accuracy50: 0.4084 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.1917 - accuracy50: 0.4327 - val_loss: 3.2373 - val_accuracy50: 0.4116 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.1885 - accuracy50: 0.4344 - val_loss: 3.2371 - val_accuracy50: 0.4116 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 8s - loss: 3.1853 - accuracy50: 0.4344 - val_loss: 3.2379 - val_accuracy50: 0.4089 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.1820 - accuracy50: 0.4368 - val_loss: 3.2416 - val_accuracy50: 0.4123 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 8s - loss: 3.1778 - accuracy50: 0.4371 - val_loss: 3.2434 - val_accuracy50: 0.4090 - 8s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.1757 - accuracy50: 0.4387 - val_loss: 3.2448 - val_accuracy50: 0.4088 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h50
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0967293
{'0': {'precision': 0.43344056595534075, 'recall': 0.3178211005502217, 'f1-score': 0.3667338926949426, 'support': 187379}, '1': {'precision': 0.3389302097715227, 'recall': 0.48068723746960174, 'f1-score': 0.3975499222923115, 'support': 158315}, '2': {'precision': 0.40691702878697134, 'recall': 0.36877663444548386, 'f1-score': 0.38690916140601717, 'support': 173178}, 'accuracy': 0.38452065249232953, 'macro avg': {'precision': 0.39309593483794486, 'recall': 0.3890949908217691, 'f1-score': 0.38373099213109046, 'support': 518872}, 'weighted avg': {'precision': 0.3957516944051607, 'recall': 0.38452065249232953, 'f1-score': 0.38286995787200734, 'support': 518872}}
[[59553 78881 48945]
 [38078 76100 44137]
 [39765 69549 63864]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0698403
{'0': {'precision': 0.4574715615305067, 'recall': 0.37543760387566744, 'f1-score': 0.4124147843144871, 'support': 28279}, '1': {'precision': 0.382234076947947, 'recall': 0.5093526729616199, 'f1-score': 0.43673136418907477, 'support': 27853}, '2': {'precision': 0.45242132252595013, 'recall': 0.38557783808550383, 'f1-score': 0.4163336758381855, 'support': 28373}, 'accuracy': 0.4229808887048104, 'macro avg': {'precision': 0.4307089870014679, 'recall': 0.4234560383075971, 'f1-score': 0.42182660811391576, 'support': 84505}, 'weighted avg': {'precision': 0.4309775068668262, 'recall': 0.4229808887048104, 'f1-score': 0.4217453613034083, 'support': 84505}}
[[10617 11448  6214]
 [ 6639 14187  7027]
 [ 5952 11481 10940]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0801175
{'0': {'precision': 0.46082017712745477, 'recall': 0.3838505332371101, 'f1-score': 0.41882847018679736, 'support': 12471}, '1': {'precision': 0.3387498271331766, 'recall': 0.4734248163896405, 'f1-score': 0.39492140266021764, 'support': 10348}, '2': {'precision': 0.45469304921359716, 'recall': 0.37699814908295476, 'f1-score': 0.41221654937675356, 'support': 11886}, 'accuracy': 0.4082120731883014, 'macro avg': {'precision': 0.4180876844914095, 'recall': 0.41142449956990185, 'f1-score': 0.4086554740745895, 'support': 34705}, 'weighted avg': {'precision': 0.42232396551169615, 'recall': 0.4082120731883014, 'f1-score': 0.40943559810746505, 'support': 34705}}
[[4787 4974 2710]
 [2785 4899 2664]
 [2816 4589 4481]]
training model: results/CHTR/W5/deepOF_L1/h100
Epoch 1/50
331/331 - 10s - loss: 3.3235 - accuracy100: 0.3539 - val_loss: 3.3021 - val_accuracy100: 0.3655 - 10s/epoch - 30ms/step
Epoch 2/50
331/331 - 8s - loss: 3.2928 - accuracy100: 0.3705 - val_loss: 3.2898 - val_accuracy100: 0.3672 - 8s/epoch - 23ms/step
Epoch 3/50
331/331 - 8s - loss: 3.2819 - accuracy100: 0.3749 - val_loss: 3.2822 - val_accuracy100: 0.3740 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2702 - accuracy100: 0.3821 - val_loss: 3.2770 - val_accuracy100: 0.3788 - 8s/epoch - 24ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2668 - accuracy100: 0.3856 - val_loss: 3.2707 - val_accuracy100: 0.3872 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2621 - accuracy100: 0.3878 - val_loss: 3.2729 - val_accuracy100: 0.3829 - 8s/epoch - 24ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2592 - accuracy100: 0.3908 - val_loss: 3.2687 - val_accuracy100: 0.3849 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2561 - accuracy100: 0.3933 - val_loss: 3.2678 - val_accuracy100: 0.3875 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2515 - accuracy100: 0.3950 - val_loss: 3.2675 - val_accuracy100: 0.3864 - 8s/epoch - 24ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2475 - accuracy100: 0.3996 - val_loss: 3.2673 - val_accuracy100: 0.3868 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2463 - accuracy100: 0.4019 - val_loss: 3.2682 - val_accuracy100: 0.3888 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2437 - accuracy100: 0.4013 - val_loss: 3.2674 - val_accuracy100: 0.3894 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2407 - accuracy100: 0.4047 - val_loss: 3.2662 - val_accuracy100: 0.3883 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2390 - accuracy100: 0.4063 - val_loss: 3.2666 - val_accuracy100: 0.3923 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2363 - accuracy100: 0.4060 - val_loss: 3.2678 - val_accuracy100: 0.3888 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2328 - accuracy100: 0.4089 - val_loss: 3.2672 - val_accuracy100: 0.3876 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2291 - accuracy100: 0.4113 - val_loss: 3.2674 - val_accuracy100: 0.3899 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 7s - loss: 3.2280 - accuracy100: 0.4120 - val_loss: 3.2662 - val_accuracy100: 0.3881 - 7s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.2252 - accuracy100: 0.4139 - val_loss: 3.2716 - val_accuracy100: 0.3884 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 8s - loss: 3.2211 - accuracy100: 0.4160 - val_loss: 3.2754 - val_accuracy100: 0.3855 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.2201 - accuracy100: 0.4171 - val_loss: 3.2735 - val_accuracy100: 0.3866 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 7s - loss: 3.2152 - accuracy100: 0.4171 - val_loss: 3.2786 - val_accuracy100: 0.3855 - 7s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.2125 - accuracy100: 0.4188 - val_loss: 3.2811 - val_accuracy100: 0.3877 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h100
Evaluating performance on  test set...
2027/2027 - 25s - 25s/epoch - 12ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.09917
{'0': {'precision': 0.3890511140925473, 'recall': 0.3329712204704465, 'f1-score': 0.3588332883447119, 'support': 177661}, '1': {'precision': 0.35729185398309654, 'recall': 0.4524113119905278, 'f1-score': 0.3992645285748734, 'support': 175672}, '2': {'precision': 0.3581520986286189, 'recall': 0.3123735192311177, 'f1-score': 0.3337000958314914, 'support': 165539}, 'accuracy': 0.36683806410829645, 'macro avg': {'precision': 0.3681650222347543, 'recall': 0.36591868389736404, 'f1-score': 0.3639326375836922, 'support': 518872}, 'weighted avg': {'precision': 0.3684406266065572, 'recall': 0.36683806410829645, 'f1-score': 0.36450349848953933, 'support': 518872}}
[[59156 74280 44225]
 [47751 79476 48445]
 [45145 68684 51710]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0805957
{'0': {'precision': 0.42200838700014975, 'recall': 0.40144607493945006, 'f1-score': 0.4114705023364486, 'support': 28076}, '1': {'precision': 0.367108142993434, 'recall': 0.46850492390331244, 'f1-score': 0.41165457892169977, 'support': 27925}, '2': {'precision': 0.43485716864479446, 'recall': 0.3380578164468145, 'f1-score': 0.38039594970688667, 'support': 28504}, 'accuracy': 0.40222472043074375, 'macro avg': {'precision': 0.40799123287945943, 'recall': 0.40266960509652566, 'f1-score': 0.401173676988345, 'support': 84505}, 'weighted avg': {'precision': 0.4082003562103908, 'recall': 0.40222472043074375, 'f1-score': 0.40104971410486595, 'support': 84505}}
[[11271 11037  5768]
 [ 8087 13083  6755]
 [ 7350 11518  9636]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0904399
{'0': {'precision': 0.42233307079723464, 'recall': 0.38963345712901665, 'f1-score': 0.4053248225759039, 'support': 12386}, '1': {'precision': 0.3293015451303922, 'recall': 0.4478463440144528, 'f1-score': 0.3795326349717969, 'support': 10517}, '2': {'precision': 0.4354317548746518, 'recall': 0.3311303168954414, 'f1-score': 0.37618520479376233, 'support': 11802}, 'accuracy': 0.38737934015271575, 'macro avg': {'precision': 0.3956887902674262, 'recall': 0.38953670601297025, 'f1-score': 0.3870142207804877, 'support': 34705}, 'weighted avg': {'precision': 0.3985952265109213, 'recall': 0.38737934015271575, 'f1-score': 0.3875993592104745, 'support': 34705}}
[[4826 5007 2553]
 [3293 4710 2514]
 [3308 4586 3908]]
training model: results/CHTR/W5/deepOF_L1/h200
Epoch 1/50
331/331 - 10s - loss: 3.3377 - accuracy200: 0.3432 - val_loss: 3.3210 - val_accuracy200: 0.3429 - 10s/epoch - 29ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3088 - accuracy200: 0.3528 - val_loss: 3.3072 - val_accuracy200: 0.3511 - 8s/epoch - 23ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3012 - accuracy200: 0.3558 - val_loss: 3.3053 - val_accuracy200: 0.3492 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 7s - loss: 3.2895 - accuracy200: 0.3627 - val_loss: 3.3014 - val_accuracy200: 0.3505 - 7s/epoch - 23ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2870 - accuracy200: 0.3646 - val_loss: 3.2998 - val_accuracy200: 0.3516 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2836 - accuracy200: 0.3689 - val_loss: 3.2982 - val_accuracy200: 0.3565 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2801 - accuracy200: 0.3703 - val_loss: 3.2978 - val_accuracy200: 0.3546 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2758 - accuracy200: 0.3743 - val_loss: 3.2956 - val_accuracy200: 0.3606 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 7s - loss: 3.2735 - accuracy200: 0.3742 - val_loss: 3.2967 - val_accuracy200: 0.3572 - 7s/epoch - 23ms/step
Epoch 10/50
331/331 - 7s - loss: 3.2717 - accuracy200: 0.3772 - val_loss: 3.2974 - val_accuracy200: 0.3562 - 7s/epoch - 23ms/step
Epoch 11/50
331/331 - 7s - loss: 3.2693 - accuracy200: 0.3801 - val_loss: 3.2992 - val_accuracy200: 0.3607 - 7s/epoch - 22ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2671 - accuracy200: 0.3803 - val_loss: 3.2954 - val_accuracy200: 0.3638 - 8s/epoch - 24ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2650 - accuracy200: 0.3809 - val_loss: 3.2972 - val_accuracy200: 0.3619 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2614 - accuracy200: 0.3853 - val_loss: 3.2979 - val_accuracy200: 0.3617 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2605 - accuracy200: 0.3855 - val_loss: 3.2991 - val_accuracy200: 0.3607 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2600 - accuracy200: 0.3859 - val_loss: 3.3001 - val_accuracy200: 0.3625 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2581 - accuracy200: 0.3880 - val_loss: 3.2996 - val_accuracy200: 0.3638 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2560 - accuracy200: 0.3889 - val_loss: 3.2969 - val_accuracy200: 0.3637 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 7s - loss: 3.2524 - accuracy200: 0.3928 - val_loss: 3.3005 - val_accuracy200: 0.3655 - 7s/epoch - 22ms/step
Epoch 20/50
331/331 - 8s - loss: 3.2499 - accuracy200: 0.3925 - val_loss: 3.3024 - val_accuracy200: 0.3620 - 8s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.2482 - accuracy200: 0.3934 - val_loss: 3.3016 - val_accuracy200: 0.3626 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 7s - loss: 3.2463 - accuracy200: 0.3945 - val_loss: 3.3038 - val_accuracy200: 0.3615 - 7s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h200
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1001624
{'0': {'precision': 0.3388971423577733, 'recall': 0.35157383231795764, 'f1-score': 0.34511911860243666, 'support': 165456}, '1': {'precision': 0.3814952521552117, 'recall': 0.4306605010981776, 'f1-score': 0.4045897250659006, 'support': 194413}, '2': {'precision': 0.3216681407963431, 'recall': 0.2584605321912165, 'f1-score': 0.2866209609362467, 'support': 159003}, 'accuracy': 0.3526727208251746, 'macro avg': {'precision': 0.3473535117697761, 'recall': 0.3468982885357839, 'f1-score': 0.345443268201528, 'support': 518872}, 'weighted avg': {'precision': 0.34957831880355816, 'recall': 0.3526727208251746, 'f1-score': 0.34947563899857326, 'support': 518872}}
[[58170 69354 37932]
 [61956 83726 48731]
 [51519 66388 41096]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0896782
{'0': {'precision': 0.3889609946034565, 'recall': 0.40933108083821573, 'f1-score': 0.3988861451163768, 'support': 27821}, '1': {'precision': 0.35123770009251215, 'recall': 0.4494224836788866, 'f1-score': 0.39430990259484816, 'support': 27878}, '2': {'precision': 0.40565555328287994, 'recall': 0.27539401513573564, 'f1-score': 0.3280674910053348, 'support': 28806}, 'accuracy': 0.376900775102065, 'macro avg': {'precision': 0.3819514159929495, 'recall': 0.37804919321761266, 'f1-score': 0.3737545129055199, 'support': 84505}, 'weighted avg': {'precision': 0.38220699724168344, 'recall': 0.376900775102065, 'f1-score': 0.3732358446686181, 'support': 84505}}
[[11388 11053  5380]
 [ 9106 12529  6243]
 [ 8784 12089  7933]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0990394
{'0': {'precision': 0.38932218380638417, 'recall': 0.4019925280199253, 'f1-score': 0.3955559186340985, 'support': 12045}, '1': {'precision': 0.32271643047565596, 'recall': 0.4234557672834392, 'f1-score': 0.3662857825377234, 'support': 10863}, '2': {'precision': 0.3822061392563015, 'recall': 0.25964228193608546, 'f1-score': 0.30922214931098885, 'support': 11797}, 'accuracy': 0.3603227200691543, 'macro avg': {'precision': 0.36474825117944715, 'recall': 0.36169685907981663, 'f1-score': 0.35702128349427026, 'support': 34705}, 'weighted avg': {'precision': 0.36605503855385496, 'recall': 0.3603227200691543, 'f1-score': 0.35704731857302235, 'support': 34705}}
[[4842 4775 2428]
 [3740 4600 2523]
 [3855 4879 3063]]
training model: results/CHTR/W5/deepOF_L1/h300
Epoch 1/50
331/331 - 10s - loss: 3.3410 - accuracy300: 0.3417 - val_loss: 3.3249 - val_accuracy300: 0.3407 - 10s/epoch - 29ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3159 - accuracy300: 0.3467 - val_loss: 3.3144 - val_accuracy300: 0.3474 - 8s/epoch - 24ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3070 - accuracy300: 0.3511 - val_loss: 3.3084 - val_accuracy300: 0.3455 - 8s/epoch - 24ms/step
Epoch 4/50
331/331 - 8s - loss: 3.2996 - accuracy300: 0.3546 - val_loss: 3.3058 - val_accuracy300: 0.3444 - 8s/epoch - 24ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2960 - accuracy300: 0.3558 - val_loss: 3.3020 - val_accuracy300: 0.3518 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2928 - accuracy300: 0.3581 - val_loss: 3.3018 - val_accuracy300: 0.3510 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2883 - accuracy300: 0.3600 - val_loss: 3.3007 - val_accuracy300: 0.3544 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2871 - accuracy300: 0.3627 - val_loss: 3.3002 - val_accuracy300: 0.3539 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2843 - accuracy300: 0.3670 - val_loss: 3.2989 - val_accuracy300: 0.3539 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2820 - accuracy300: 0.3683 - val_loss: 3.2987 - val_accuracy300: 0.3541 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2807 - accuracy300: 0.3689 - val_loss: 3.3007 - val_accuracy300: 0.3509 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 7s - loss: 3.2781 - accuracy300: 0.3698 - val_loss: 3.3000 - val_accuracy300: 0.3537 - 7s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2755 - accuracy300: 0.3718 - val_loss: 3.3014 - val_accuracy300: 0.3524 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2736 - accuracy300: 0.3721 - val_loss: 3.3013 - val_accuracy300: 0.3484 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 7s - loss: 3.2721 - accuracy300: 0.3731 - val_loss: 3.2994 - val_accuracy300: 0.3525 - 7s/epoch - 23ms/step
Epoch 16/50
331/331 - 7s - loss: 3.2715 - accuracy300: 0.3760 - val_loss: 3.3018 - val_accuracy300: 0.3566 - 7s/epoch - 22ms/step
Epoch 17/50
331/331 - 7s - loss: 3.2701 - accuracy300: 0.3766 - val_loss: 3.3012 - val_accuracy300: 0.3548 - 7s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2672 - accuracy300: 0.3785 - val_loss: 3.3051 - val_accuracy300: 0.3513 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 7s - loss: 3.2668 - accuracy300: 0.3788 - val_loss: 3.3042 - val_accuracy300: 0.3544 - 7s/epoch - 22ms/step
Epoch 20/50
331/331 - 7s - loss: 3.2645 - accuracy300: 0.3810 - val_loss: 3.3067 - val_accuracy300: 0.3502 - 7s/epoch - 22ms/step
testing model: results/CHTR/W5/deepOF_L1/h300
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0985541
{'0': {'precision': 0.3283540971563256, 'recall': 0.4013994910941476, 'f1-score': 0.36122101931204015, 'support': 160344}, '1': {'precision': 0.40066582505294024, 'recall': 0.3882197429295769, 'f1-score': 0.3943446043778214, 'support': 202746}, '2': {'precision': 0.30560082271972155, 'recall': 0.24798115314991462, 'f1-score': 0.273792311617622, 'support': 155782}, 'accuracy': 0.35018848579225703, 'macro avg': {'precision': 0.34487358164299575, 'recall': 0.3458667957245463, 'f1-score': 0.34311931176916116, 'support': 518872}, 'weighted avg': {'precision': 0.3497781920888792, 'recall': 0.35018848579225703, 'f1-score': 0.3479149543011994, 'support': 518872}}
[[64362 59235 36747]
 [73004 78710 51032]
 [58648 58503 38631]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0935907
{'0': {'precision': 0.36545285974615555, 'recall': 0.41352241073689544, 'f1-score': 0.38800448049964353, 'support': 27643}, '1': {'precision': 0.3503366288591011, 'recall': 0.413220775504364, 'f1-score': 0.3791892335466929, 'support': 27956}, '2': {'precision': 0.38904799525972744, 'recall': 0.27257316820037364, 'f1-score': 0.3205582000895073, 'support': 28906}, 'accuracy': 0.36520915922134783, 'macro avg': {'precision': 0.36827916128832805, 'recall': 0.3664387848138777, 'f1-score': 0.3625839713786146, 'support': 84505}, 'weighted avg': {'precision': 0.3685231116422187, 'recall': 0.36520915922134783, 'f1-score': 0.36201736464434403, 'support': 84505}}
[[11431 10345  5867]
 [ 9898 11552  6506]
 [ 9950 11077  7879]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0995727
{'0': {'precision': 0.36591162272558486, 'recall': 0.4143121426168853, 'f1-score': 0.388610640059944, 'support': 11892}, '1': {'precision': 0.32453006058723005, 'recall': 0.3765320836337419, 'f1-score': 0.3486024196912808, 'support': 11096}, '2': {'precision': 0.3643318192684676, 'recall': 0.26013484680378934, 'f1-score': 0.30354030772294976, 'support': 11717}, 'accuracy': 0.35018008932430483, 'macro avg': {'precision': 0.35159116752709413, 'recall': 0.3503263576848055, 'f1-score': 0.34691778915805815, 'support': 34705}, 'weighted avg': {'precision': 0.35214760109774373, 'recall': 0.35018008932430483, 'f1-score': 0.3470978811720821, 'support': 34705}}
[[4927 4335 2630]
 [4230 4178 2688]
 [4308 4361 3048]]
training model: results/CHTR/W5/deepOF_L1/h500
Epoch 1/50
331/331 - 10s - loss: 3.3451 - accuracy500: 0.3380 - val_loss: 3.3216 - val_accuracy500: 0.3376 - 10s/epoch - 29ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3200 - accuracy500: 0.3416 - val_loss: 3.3156 - val_accuracy500: 0.3408 - 8s/epoch - 23ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3122 - accuracy500: 0.3428 - val_loss: 3.3108 - val_accuracy500: 0.3410 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 8s - loss: 3.3042 - accuracy500: 0.3461 - val_loss: 3.3068 - val_accuracy500: 0.3377 - 8s/epoch - 23ms/step
Epoch 5/50
331/331 - 8s - loss: 3.2996 - accuracy500: 0.3489 - val_loss: 3.3058 - val_accuracy500: 0.3393 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.2970 - accuracy500: 0.3491 - val_loss: 3.3041 - val_accuracy500: 0.3454 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2943 - accuracy500: 0.3528 - val_loss: 3.3027 - val_accuracy500: 0.3400 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2925 - accuracy500: 0.3535 - val_loss: 3.3036 - val_accuracy500: 0.3427 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2902 - accuracy500: 0.3562 - val_loss: 3.3022 - val_accuracy500: 0.3455 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 7s - loss: 3.2885 - accuracy500: 0.3585 - val_loss: 3.3024 - val_accuracy500: 0.3457 - 7s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2861 - accuracy500: 0.3620 - val_loss: 3.3035 - val_accuracy500: 0.3444 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2838 - accuracy500: 0.3608 - val_loss: 3.3026 - val_accuracy500: 0.3454 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 7s - loss: 3.2835 - accuracy500: 0.3632 - val_loss: 3.3037 - val_accuracy500: 0.3429 - 7s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2793 - accuracy500: 0.3691 - val_loss: 3.3023 - val_accuracy500: 0.3451 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2793 - accuracy500: 0.3680 - val_loss: 3.3043 - val_accuracy500: 0.3450 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 7s - loss: 3.2790 - accuracy500: 0.3664 - val_loss: 3.3042 - val_accuracy500: 0.3467 - 7s/epoch - 22ms/step
Epoch 17/50
331/331 - 7s - loss: 3.2767 - accuracy500: 0.3690 - val_loss: 3.3023 - val_accuracy500: 0.3461 - 7s/epoch - 22ms/step
Epoch 18/50
331/331 - 7s - loss: 3.2767 - accuracy500: 0.3708 - val_loss: 3.3056 - val_accuracy500: 0.3457 - 7s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.2729 - accuracy500: 0.3731 - val_loss: 3.3057 - val_accuracy500: 0.3463 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h500
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0983682
{'0': {'precision': 0.3180525635501939, 'recall': 0.3537790103261425, 'f1-score': 0.3349658620992162, 'support': 156496}, '1': {'precision': 0.40531608301714667, 'recall': 0.47077635907389837, 'f1-score': 0.4356006756124409, 'support': 207623}, '2': {'precision': 0.29710928002161285, 'recall': 0.19898160294146156, 'f1-score': 0.23834052516496063, 'support': 154753}, 'accuracy': 0.35442652523165635, 'macro avg': {'precision': 0.34015930886298446, 'recall': 0.3411789907805008, 'f1-score': 0.3363023542922059, 'support': 518872}, 'weighted avg': {'precision': 0.3467241390955859, 'recall': 0.35442652523165635, 'f1-score': 0.3464157786864851, 'support': 518872}}
[[55365 71681 29450]
 [66480 97744 43399]
 [52230 71730 30793]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.09689
{'0': {'precision': 0.3500432152117545, 'recall': 0.3430307494015835, 'f1-score': 0.34650150652828926, 'support': 27155}, '1': {'precision': 0.33952404317958784, 'recall': 0.4975373000179759, 'f1-score': 0.40361647830842146, 'support': 27815}, '2': {'precision': 0.3867164701762577, 'recall': 0.2243439986456746, 'f1-score': 0.28395723070989304, 'support': 29535}, 'accuracy': 0.35240518312525887, 'macro avg': {'precision': 0.3587612428558667, 'recall': 0.35497068268841137, 'f1-score': 0.3446917385155346, 'support': 84505}, 'weighted avg': {'precision': 0.3593983281080552, 'recall': 0.35240518312525887, 'f1-score': 0.34344142432922464, 'support': 84505}}
[[ 9315 12840  5000]
 [ 8468 13839  5508]
 [ 8828 14081  6626]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0998735
{'0': {'precision': 0.3657851239669421, 'recall': 0.37059365318596665, 'f1-score': 0.36817368880755313, 'support': 11943}, '1': {'precision': 0.3242204724409449, 'recall': 0.47346150308159324, 'f1-score': 0.38487998205339113, 'support': 10871}, '2': {'precision': 0.3707280832095097, 'recall': 0.20982255487343368, 'f1-score': 0.26797701519789485, 'support': 11891}, 'accuracy': 0.34773087451375884, 'macro avg': {'precision': 0.3535778932057989, 'recall': 0.3512925703803312, 'f1-score': 0.3403435620196131, 'support': 34705}, 'weighted avg': {'precision': 0.3544590153835753, 'recall': 0.34773087451375884, 'f1-score': 0.33907630998556954, 'support': 34705}}
[[4426 5393 2124]
 [3613 5147 2111]
 [4061 5335 2495]]
training model: results/CHTR/W5/deepOF_L1/h1000
Epoch 1/50
331/331 - 10s - loss: 3.3471 - accuracy1000: 0.3366 - val_loss: 3.3375 - val_accuracy1000: 0.3383 - 10s/epoch - 31ms/step
Epoch 2/50
331/331 - 8s - loss: 3.3275 - accuracy1000: 0.3402 - val_loss: 3.3200 - val_accuracy1000: 0.3384 - 8s/epoch - 24ms/step
Epoch 3/50
331/331 - 8s - loss: 3.3200 - accuracy1000: 0.3371 - val_loss: 3.3094 - val_accuracy1000: 0.3435 - 8s/epoch - 23ms/step
Epoch 4/50
331/331 - 8s - loss: 3.3101 - accuracy1000: 0.3414 - val_loss: 3.3062 - val_accuracy1000: 0.3417 - 8s/epoch - 23ms/step
Epoch 5/50
331/331 - 8s - loss: 3.3066 - accuracy1000: 0.3433 - val_loss: 3.3045 - val_accuracy1000: 0.3413 - 8s/epoch - 23ms/step
Epoch 6/50
331/331 - 8s - loss: 3.3033 - accuracy1000: 0.3423 - val_loss: 3.3035 - val_accuracy1000: 0.3388 - 8s/epoch - 23ms/step
Epoch 7/50
331/331 - 8s - loss: 3.2999 - accuracy1000: 0.3446 - val_loss: 3.3035 - val_accuracy1000: 0.3388 - 8s/epoch - 23ms/step
Epoch 8/50
331/331 - 8s - loss: 3.2978 - accuracy1000: 0.3475 - val_loss: 3.3038 - val_accuracy1000: 0.3366 - 8s/epoch - 23ms/step
Epoch 9/50
331/331 - 8s - loss: 3.2959 - accuracy1000: 0.3492 - val_loss: 3.3016 - val_accuracy1000: 0.3423 - 8s/epoch - 23ms/step
Epoch 10/50
331/331 - 8s - loss: 3.2942 - accuracy1000: 0.3513 - val_loss: 3.3009 - val_accuracy1000: 0.3408 - 8s/epoch - 23ms/step
Epoch 11/50
331/331 - 8s - loss: 3.2920 - accuracy1000: 0.3523 - val_loss: 3.3028 - val_accuracy1000: 0.3399 - 8s/epoch - 23ms/step
Epoch 12/50
331/331 - 8s - loss: 3.2897 - accuracy1000: 0.3540 - val_loss: 3.3031 - val_accuracy1000: 0.3427 - 8s/epoch - 23ms/step
Epoch 13/50
331/331 - 8s - loss: 3.2890 - accuracy1000: 0.3563 - val_loss: 3.3019 - val_accuracy1000: 0.3435 - 8s/epoch - 23ms/step
Epoch 14/50
331/331 - 8s - loss: 3.2867 - accuracy1000: 0.3578 - val_loss: 3.3027 - val_accuracy1000: 0.3396 - 8s/epoch - 23ms/step
Epoch 15/50
331/331 - 8s - loss: 3.2866 - accuracy1000: 0.3572 - val_loss: 3.3008 - val_accuracy1000: 0.3458 - 8s/epoch - 23ms/step
Epoch 16/50
331/331 - 8s - loss: 3.2847 - accuracy1000: 0.3598 - val_loss: 3.3046 - val_accuracy1000: 0.3399 - 8s/epoch - 23ms/step
Epoch 17/50
331/331 - 8s - loss: 3.2844 - accuracy1000: 0.3604 - val_loss: 3.3014 - val_accuracy1000: 0.3423 - 8s/epoch - 23ms/step
Epoch 18/50
331/331 - 8s - loss: 3.2835 - accuracy1000: 0.3620 - val_loss: 3.3039 - val_accuracy1000: 0.3388 - 8s/epoch - 23ms/step
Epoch 19/50
331/331 - 8s - loss: 3.2816 - accuracy1000: 0.3637 - val_loss: 3.3040 - val_accuracy1000: 0.3441 - 8s/epoch - 23ms/step
Epoch 20/50
331/331 - 7s - loss: 3.2804 - accuracy1000: 0.3650 - val_loss: 3.3039 - val_accuracy1000: 0.3429 - 7s/epoch - 23ms/step
Epoch 21/50
331/331 - 8s - loss: 3.2787 - accuracy1000: 0.3659 - val_loss: 3.3062 - val_accuracy1000: 0.3418 - 8s/epoch - 23ms/step
Epoch 22/50
331/331 - 8s - loss: 3.2769 - accuracy1000: 0.3677 - val_loss: 3.3059 - val_accuracy1000: 0.3413 - 8s/epoch - 23ms/step
Epoch 23/50
331/331 - 8s - loss: 3.2755 - accuracy1000: 0.3691 - val_loss: 3.3081 - val_accuracy1000: 0.3398 - 8s/epoch - 23ms/step
Epoch 24/50
331/331 - 8s - loss: 3.2746 - accuracy1000: 0.3724 - val_loss: 3.3069 - val_accuracy1000: 0.3430 - 8s/epoch - 23ms/step
Epoch 25/50
331/331 - 8s - loss: 3.2746 - accuracy1000: 0.3705 - val_loss: 3.3074 - val_accuracy1000: 0.3444 - 8s/epoch - 23ms/step
testing model: results/CHTR/W5/deepOF_L1/h1000
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1019965
{'0': {'precision': 0.3115543898398675, 'recall': 0.2920513732975316, 'f1-score': 0.30148780202715114, 'support': 154555}, '1': {'precision': 0.4102575086284973, 'recall': 0.3190635738013878, 'f1-score': 0.35895911974941774, 'support': 210118}, '2': {'precision': 0.2960964953936746, 'recall': 0.40436059896627086, 'f1-score': 0.34186178480669116, 'support': 154199}, 'accuracy': 0.33636619436007337, 'macro avg': {'precision': 0.33930279795401314, 'recall': 0.33849184868839677, 'f1-score': 0.33410290219442, 'support': 518872}, 'weighted avg': {'precision': 0.3469305713411256, 'recall': 0.33636619436007337, 'f1-score': 0.33675928730249743, 'support': 518872}}
[[45138 48025 61392]
 [56241 67041 86836]
 [43501 48346 62352]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0943979
{'0': {'precision': 0.35587803403299645, 'recall': 0.30242971445349776, 'f1-score': 0.326984126984127, 'support': 27246}, '1': {'precision': 0.3503505302894122, 'recall': 0.34854608533924675, 'f1-score': 0.3494459784128806, 'support': 27959}, '2': {'precision': 0.37177958015267176, 'recall': 0.4255290102389078, 'f1-score': 0.3968425743204532, 'support': 29300}, 'accuracy': 0.360369208922549, 'macro avg': {'precision': 0.3593360481583601, 'recall': 0.35883493667721744, 'f1-score': 0.35775755990582025, 'support': 84505}, 'weighted avg': {'precision': 0.35956268966449295, 'recall': 0.360369208922549, 'f1-score': 0.3586374423033493, 'support': 84505}}
[[ 8240  8788 10218]
 [ 7364  9745 10850]
 [ 7550  9282 12468]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.099734
{'0': {'precision': 0.3585754818510909, 'recall': 0.30452845866223516, 'f1-score': 0.32934938892882815, 'support': 12035}, '1': {'precision': 0.32252085264133457, 'recall': 0.32276015581524764, 'f1-score': 0.3226404598553681, 'support': 10782}, '2': {'precision': 0.3533664378559953, 'recall': 0.4070491251682369, 'f1-score': 0.37831287624110704, 'support': 11888}, 'accuracy': 0.34531047399510156, 'macro avg': {'precision': 0.34482092411614024, 'recall': 0.3447792465485732, 'f1-score': 0.34343424167510106, 'support': 34705}, 'weighted avg': {'precision': 0.34558985651891144, 'recall': 0.34531047399510156, 'f1-score': 0.34403725130884044, 'support': 34705}}
[[3665 3708 4662]
 [3109 3480 4193]
 [3447 3602 4839]]
training model: results/CHTR/W5/deepLOB_L2/h10
Epoch 1/50
331/331 - 19s - loss: 3.3419 - accuracy10: 0.3459 - val_loss: 3.3621 - val_accuracy10: 0.3416 - 19s/epoch - 58ms/step
Epoch 2/50
331/331 - 17s - loss: 3.3008 - accuracy10: 0.3611 - val_loss: 3.3323 - val_accuracy10: 0.3509 - 17s/epoch - 51ms/step
Epoch 3/50
331/331 - 17s - loss: 3.2805 - accuracy10: 0.3733 - val_loss: 3.3271 - val_accuracy10: 0.3657 - 17s/epoch - 50ms/step
Epoch 4/50
331/331 - 17s - loss: 3.2577 - accuracy10: 0.3887 - val_loss: 3.3089 - val_accuracy10: 0.3741 - 17s/epoch - 50ms/step
Epoch 5/50
331/331 - 17s - loss: 3.2398 - accuracy10: 0.4062 - val_loss: 3.2929 - val_accuracy10: 0.3813 - 17s/epoch - 51ms/step
Epoch 6/50
331/331 - 17s - loss: 3.2221 - accuracy10: 0.4148 - val_loss: 3.3071 - val_accuracy10: 0.3755 - 17s/epoch - 50ms/step
Epoch 7/50
331/331 - 17s - loss: 3.2090 - accuracy10: 0.4205 - val_loss: 3.2821 - val_accuracy10: 0.3880 - 17s/epoch - 51ms/step
Epoch 8/50
331/331 - 17s - loss: 3.1961 - accuracy10: 0.4257 - val_loss: 3.2796 - val_accuracy10: 0.3877 - 17s/epoch - 50ms/step
Epoch 9/50
331/331 - 17s - loss: 3.1856 - accuracy10: 0.4332 - val_loss: 3.2875 - val_accuracy10: 0.3892 - 17s/epoch - 51ms/step
Epoch 10/50
331/331 - 17s - loss: 3.1733 - accuracy10: 0.4362 - val_loss: 3.2925 - val_accuracy10: 0.3912 - 17s/epoch - 50ms/step
Epoch 11/50
331/331 - 17s - loss: 3.1633 - accuracy10: 0.4404 - val_loss: 3.2887 - val_accuracy10: 0.3875 - 17s/epoch - 51ms/step
Epoch 12/50
331/331 - 17s - loss: 3.1536 - accuracy10: 0.4431 - val_loss: 3.2901 - val_accuracy10: 0.3912 - 17s/epoch - 50ms/step
Epoch 13/50
331/331 - 17s - loss: 3.1430 - accuracy10: 0.4483 - val_loss: 3.2861 - val_accuracy10: 0.3960 - 17s/epoch - 50ms/step
Epoch 14/50
331/331 - 16s - loss: 3.1376 - accuracy10: 0.4500 - val_loss: 3.2971 - val_accuracy10: 0.3942 - 16s/epoch - 50ms/step
Epoch 15/50
331/331 - 17s - loss: 3.1267 - accuracy10: 0.4550 - val_loss: 3.2903 - val_accuracy10: 0.3990 - 17s/epoch - 50ms/step
Epoch 16/50
331/331 - 16s - loss: 3.1200 - accuracy10: 0.4561 - val_loss: 3.2917 - val_accuracy10: 0.3961 - 16s/epoch - 50ms/step
Epoch 17/50
331/331 - 16s - loss: 3.1097 - accuracy10: 0.4602 - val_loss: 3.2805 - val_accuracy10: 0.4042 - 16s/epoch - 49ms/step
Epoch 18/50
331/331 - 16s - loss: 3.1032 - accuracy10: 0.4626 - val_loss: 3.2931 - val_accuracy10: 0.4009 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h10
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.09322
{'0': {'precision': 0.4391745263333612, 'recall': 0.11231655904797481, 'f1-score': 0.17888438426952924, 'support': 187390}, '1': {'precision': 0.37186634349030473, 'recall': 0.4364733694142829, 'f1-score': 0.4015879792216534, 'support': 147631}, '2': {'precision': 0.40077198805400555, 'recall': 0.6488719432599426, 'f1-score': 0.495500790191245, 'support': 183856}, 'accuracy': 0.3946657878456744, 'macro avg': {'precision': 0.40393761929255717, 'recall': 0.3992206239074001, 'f1-score': 0.3586577178941425, 'support': 518877}, 'weighted avg': {'precision': 0.4064166445633223, 'recall': 0.3946657878456744, 'f1-score': 0.3544361631179268, 'support': 518877}}
[[ 21047  58943 107400]
 [ 12220  64437  70974]
 [ 14657  49900 119299]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.076628
{'0': {'precision': 0.4053555400418869, 'recall': 0.2898245864232744, 'f1-score': 0.337990104361565, 'support': 28048}, '1': {'precision': 0.42066520344420055, 'recall': 0.43969929057988916, 'f1-score': 0.42997169876440944, 'support': 28333}, '2': {'precision': 0.4073021613708775, 'recall': 0.5044974579585452, 'f1-score': 0.45071943588603375, 'support': 28127}, 'accuracy': 0.41152316940408007, 'macro avg': {'precision': 0.41110763495232167, 'recall': 0.41134044498723626, 'f1-score': 0.40622707967066946, 'support': 84508}, 'weighted avg': {'precision': 0.41113631004352313, 'recall': 0.41152316940408007, 'f1-score': 0.4063487499573018, 'support': 84508}}
[[ 8129  9195 10724]
 [ 5950 12458  9925]
 [ 5975  7962 14190]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0941653
{'0': {'precision': 0.41439588688946016, 'recall': 0.19690553745928338, 'f1-score': 0.2669610819762628, 'support': 12280}, '1': {'precision': 0.3794162826420891, 'recall': 0.3968058968058968, 'f1-score': 0.3879163009838792, 'support': 10582}, '2': {'precision': 0.3861708700780767, 'recall': 0.5805116946719581, 'f1-score': 0.4638062470485057, 'support': 11843}, 'accuracy': 0.38876242616337703, 'macro avg': {'precision': 0.39332767986987527, 'recall': 0.39140770964571275, 'f1-score': 0.3728945433362159, 'support': 34705}, 'weighted avg': {'precision': 0.39409843562183605, 'recall': 0.38876242616337703, 'f1-score': 0.3710148326602901, 'support': 34705}}
[[2418 3770 6092]
 [1547 4199 4836]
 [1870 3098 6875]]
training model: results/CHTR/W5/deepLOB_L2/h20
Epoch 1/50
331/331 - 19s - loss: 3.3421 - accuracy20: 0.3476 - val_loss: 3.3620 - val_accuracy20: 0.3276 - 19s/epoch - 56ms/step
Epoch 2/50
331/331 - 17s - loss: 3.3033 - accuracy20: 0.3581 - val_loss: 3.3482 - val_accuracy20: 0.3338 - 17s/epoch - 50ms/step
Epoch 3/50
331/331 - 16s - loss: 3.2826 - accuracy20: 0.3734 - val_loss: 3.3288 - val_accuracy20: 0.3475 - 16s/epoch - 50ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2650 - accuracy20: 0.3890 - val_loss: 3.3205 - val_accuracy20: 0.3578 - 16s/epoch - 50ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2517 - accuracy20: 0.3982 - val_loss: 3.3149 - val_accuracy20: 0.3668 - 16s/epoch - 50ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2373 - accuracy20: 0.4074 - val_loss: 3.2940 - val_accuracy20: 0.3800 - 16s/epoch - 50ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2269 - accuracy20: 0.4138 - val_loss: 3.2886 - val_accuracy20: 0.3855 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2160 - accuracy20: 0.4203 - val_loss: 3.2992 - val_accuracy20: 0.3853 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2060 - accuracy20: 0.4251 - val_loss: 3.2847 - val_accuracy20: 0.3869 - 16s/epoch - 50ms/step
Epoch 10/50
331/331 - 16s - loss: 3.1929 - accuracy20: 0.4317 - val_loss: 3.2954 - val_accuracy20: 0.3836 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.1831 - accuracy20: 0.4353 - val_loss: 3.3063 - val_accuracy20: 0.3848 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.1725 - accuracy20: 0.4393 - val_loss: 3.3092 - val_accuracy20: 0.3822 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.1657 - accuracy20: 0.4434 - val_loss: 3.3140 - val_accuracy20: 0.3817 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.1546 - accuracy20: 0.4466 - val_loss: 3.3150 - val_accuracy20: 0.3844 - 16s/epoch - 49ms/step
Epoch 15/50
331/331 - 16s - loss: 3.1466 - accuracy20: 0.4512 - val_loss: 3.3272 - val_accuracy20: 0.3831 - 16s/epoch - 49ms/step
Epoch 16/50
331/331 - 16s - loss: 3.1379 - accuracy20: 0.4542 - val_loss: 3.3263 - val_accuracy20: 0.3831 - 16s/epoch - 49ms/step
Epoch 17/50
331/331 - 16s - loss: 3.1300 - accuracy20: 0.4569 - val_loss: 3.3543 - val_accuracy20: 0.3779 - 16s/epoch - 49ms/step
Epoch 18/50
331/331 - 16s - loss: 3.1197 - accuracy20: 0.4602 - val_loss: 3.3609 - val_accuracy20: 0.3797 - 16s/epoch - 49ms/step
Epoch 19/50
331/331 - 16s - loss: 3.1086 - accuracy20: 0.4674 - val_loss: 3.4060 - val_accuracy20: 0.3712 - 16s/epoch - 48ms/step
testing model: results/CHTR/W5/deepLOB_L2/h20
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.1000044
{'0': {'precision': 0.4250555712478662, 'recall': 0.1830049808064465, 'f1-score': 0.2558537513906702, 'support': 189126}, '1': {'precision': 0.3418052429017501, 'recall': 0.3794947594732599, 'f1-score': 0.35966532098875487, 'support': 148840}, '2': {'precision': 0.38708954511054455, 'recall': 0.5824134519183466, 'f1-score': 0.46507573232930716, 'support': 180911}, 'accuracy': 0.3786253774979427, 'macro avg': {'precision': 0.3846501197533869, 'recall': 0.3816377307326843, 'f1-score': 0.36019826823624407, 'support': 518877}, 'weighted avg': {'precision': 0.38793800653490934, 'recall': 0.3786253774979427, 'f1-score': 0.35857919848616426, 'support': 518877}}
[[ 34611  58401  96114]
 [ 21637  56484  70719]
 [ 25179  50367 105365]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0831969
{'0': {'precision': 0.4006267281105991, 'recall': 0.38282956386951317, 'f1-score': 0.39152600385509184, 'support': 28386}, '1': {'precision': 0.4114391143911439, 'recall': 0.3772858171346292, 'f1-score': 0.3936230142336726, 'support': 27780}, '2': {'precision': 0.40443135165627253, 'recall': 0.45533131042269426, 'f1-score': 0.4283746327861778, 'support': 28342}, 'accuracy': 0.40532257301083924, 'macro avg': {'precision': 0.40549906471933844, 'recall': 0.4051488971422789, 'f1-score': 0.40450788362498075, 'support': 84508}, 'weighted avg': {'precision': 0.4054570250221934, 'recall': 0.40532257301083924, 'f1-score': 0.4045735116588715, 'support': 84508}}
[[10867  7809  9710]
 [ 8005 10481  9294]
 [ 8253  7184 12905]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0963687
{'0': {'precision': 0.4037442599788061, 'recall': 0.1836439588688946, 'f1-score': 0.25245720596355603, 'support': 12448}, '1': {'precision': 0.3669765878794668, 'recall': 0.3159112825458052, 'f1-score': 0.33953464269057365, 'support': 10370}, '2': {'precision': 0.38904354742493535, 'recall': 0.6583662824934803, 'f1-score': 0.4890791488297972, 'support': 11887}, 'accuracy': 0.38576573980694423, 'macro avg': {'precision': 0.3865881317610694, 'recall': 0.38597384130272666, 'f1-score': 0.360356999161309, 'support': 34705}, 'weighted avg': {'precision': 0.38772270314843554, 'recall': 0.38576573980694423, 'f1-score': 0.35952299053955894, 'support': 34705}}
[[2286 3157 7005]
 [1809 3276 5285]
 [1567 2494 7826]]
training model: results/CHTR/W5/deepLOB_L2/h30
Epoch 1/50
331/331 - 19s - loss: 3.3450 - accuracy30: 0.3459 - val_loss: 3.3716 - val_accuracy30: 0.3399 - 19s/epoch - 56ms/step
Epoch 2/50
331/331 - 17s - loss: 3.3104 - accuracy30: 0.3528 - val_loss: 3.3327 - val_accuracy30: 0.3360 - 17s/epoch - 50ms/step
Epoch 3/50
331/331 - 16s - loss: 3.2848 - accuracy30: 0.3718 - val_loss: 3.3213 - val_accuracy30: 0.3474 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2678 - accuracy30: 0.3866 - val_loss: 3.3023 - val_accuracy30: 0.3652 - 16s/epoch - 49ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2548 - accuracy30: 0.3963 - val_loss: 3.2985 - val_accuracy30: 0.3647 - 16s/epoch - 49ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2446 - accuracy30: 0.4029 - val_loss: 3.2989 - val_accuracy30: 0.3712 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2336 - accuracy30: 0.4120 - val_loss: 3.2951 - val_accuracy30: 0.3740 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2225 - accuracy30: 0.4155 - val_loss: 3.2967 - val_accuracy30: 0.3749 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2159 - accuracy30: 0.4195 - val_loss: 3.2991 - val_accuracy30: 0.3753 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2096 - accuracy30: 0.4239 - val_loss: 3.3037 - val_accuracy30: 0.3752 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2008 - accuracy30: 0.4286 - val_loss: 3.3002 - val_accuracy30: 0.3789 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.1904 - accuracy30: 0.4323 - val_loss: 3.3105 - val_accuracy30: 0.3727 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.1816 - accuracy30: 0.4355 - val_loss: 3.3297 - val_accuracy30: 0.3707 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.1785 - accuracy30: 0.4376 - val_loss: 3.3439 - val_accuracy30: 0.3707 - 16s/epoch - 49ms/step
Epoch 15/50
331/331 - 16s - loss: 3.1681 - accuracy30: 0.4428 - val_loss: 3.3447 - val_accuracy30: 0.3654 - 16s/epoch - 49ms/step
Epoch 16/50
331/331 - 16s - loss: 3.1591 - accuracy30: 0.4456 - val_loss: 3.3651 - val_accuracy30: 0.3703 - 16s/epoch - 49ms/step
Epoch 17/50
331/331 - 16s - loss: 3.1494 - accuracy30: 0.4486 - val_loss: 3.3571 - val_accuracy30: 0.3701 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h30
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1065753
{'0': {'precision': 0.41411931468014296, 'recall': 0.1417384288433853, 'f1-score': 0.21119295971084528, 'support': 189631}, '1': {'precision': 0.321501373066361, 'recall': 0.5545376144354518, 'f1-score': 0.4070243607909588, 'support': 150740}, '2': {'precision': 0.38419145129942106, 'recall': 0.4174761632662207, 'f1-score': 0.40014282761083236, 'support': 178506}, 'accuracy': 0.35652187319923606, 'macro avg': {'precision': 0.37327071301530834, 'recall': 0.37125073551501925, 'f1-score': 0.3394533827042121, 'support': 518877}, 'weighted avg': {'precision': 0.376916795201537, 'recall': 0.35652187319923606, 'f1-score': 0.33308757157101904, 'support': 518877}}
[[26878 93654 69099]
 [16799 83591 50350]
 [21227 82757 74522]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0914747
{'0': {'precision': 0.39802687531893177, 'recall': 0.2482144119934941, 'f1-score': 0.3057557873647074, 'support': 28282}, '1': {'precision': 0.37072377206400076, 'recall': 0.5455942256842707, 'f1-score': 0.44147282899397167, 'support': 27986}, '2': {'precision': 0.40211805014795204, 'recall': 0.36572237960339943, 'f1-score': 0.3830576366738373, 'support': 28240}, 'accuracy': 0.3859634590807971, 'macro avg': {'precision': 0.39028956584362823, 'recall': 0.38651033909372146, 'f1-score': 0.3767620843441721, 'support': 84508}, 'weighted avg': {'precision': 0.39035221883054055, 'recall': 0.3859634590807971, 'f1-score': 0.37653229789065074, 'support': 84508}}
[[ 7020 13249  8013]
 [ 5374 15269  7343]
 [ 5243 12669 10328]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1000643
{'0': {'precision': 0.3989241714384869, 'recall': 0.18427380570695737, 'f1-score': 0.25209715444925707, 'support': 12476}, '1': {'precision': 0.33856127143454623, 'recall': 0.47274673934202843, 'f1-score': 0.3945572705117791, 'support': 10274}, '2': {'precision': 0.3904494382022472, 'recall': 0.4767043078209954, 'f1-score': 0.4292870325034838, 'support': 11955}, 'accuracy': 0.37040772223022617, 'macro avg': {'precision': 0.3759782936917601, 'recall': 0.37790828428999373, 'f1-score': 0.35864715248817336, 'support': 34705}, 'weighted avg': {'precision': 0.3781351246014395, 'recall': 0.37040772223022617, 'f1-score': 0.35530822560801323, 'support': 34705}}
[[2299 5069 5108]
 [1628 4857 3789]
 [1836 4420 5699]]
training model: results/CHTR/W5/deepLOB_L2/h50
Epoch 1/50
331/331 - 19s - loss: 3.3476 - accuracy50: 0.3451 - val_loss: 3.3912 - val_accuracy50: 0.3273 - 19s/epoch - 56ms/step
Epoch 2/50
331/331 - 17s - loss: 3.3093 - accuracy50: 0.3533 - val_loss: 3.3193 - val_accuracy50: 0.3479 - 17s/epoch - 50ms/step
Epoch 3/50
331/331 - 17s - loss: 3.2952 - accuracy50: 0.3616 - val_loss: 3.3300 - val_accuracy50: 0.3431 - 17s/epoch - 51ms/step
Epoch 4/50
331/331 - 17s - loss: 3.2823 - accuracy50: 0.3708 - val_loss: 3.3137 - val_accuracy50: 0.3530 - 17s/epoch - 50ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2676 - accuracy50: 0.3839 - val_loss: 3.3267 - val_accuracy50: 0.3523 - 16s/epoch - 50ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2621 - accuracy50: 0.3901 - val_loss: 3.3183 - val_accuracy50: 0.3621 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2548 - accuracy50: 0.3932 - val_loss: 3.3212 - val_accuracy50: 0.3532 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2481 - accuracy50: 0.3988 - val_loss: 3.3253 - val_accuracy50: 0.3597 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2409 - accuracy50: 0.4044 - val_loss: 3.3443 - val_accuracy50: 0.3553 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2369 - accuracy50: 0.4060 - val_loss: 3.3395 - val_accuracy50: 0.3480 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2278 - accuracy50: 0.4143 - val_loss: 3.3500 - val_accuracy50: 0.3515 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.2207 - accuracy50: 0.4158 - val_loss: 3.3521 - val_accuracy50: 0.3543 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.2130 - accuracy50: 0.4223 - val_loss: 3.3564 - val_accuracy50: 0.3480 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.2064 - accuracy50: 0.4253 - val_loss: 3.3726 - val_accuracy50: 0.3475 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h50
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1121879
{'0': {'precision': 0.3788620979375723, 'recall': 0.1275429608282634, 'f1-score': 0.1908400908724312, 'support': 187380}, '1': {'precision': 0.31097943891696533, 'recall': 0.45980823163798984, 'f1-score': 0.37102541036037295, 'support': 158316}, '2': {'precision': 0.352157969988228, 'recall': 0.45084622447035183, 'f1-score': 0.3954377630452729, 'support': 173181}, 'accuracy': 0.33682741767316726, 'macro avg': {'precision': 0.34733316894758853, 'recall': 0.346065805645535, 'f1-score': 0.3191010880926924, 'support': 518877}, 'weighted avg': {'precision': 0.3492374303807105, 'recall': 0.33682741767316726, 'f1-score': 0.3141036938161305, 'support': 518877}}
[[23899 85573 77908]
 [19794 72795 65727]
 [19388 75715 78078]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1059364
{'0': {'precision': 0.35310481399405913, 'recall': 0.26463832644263047, 'f1-score': 0.3025369637230347, 'support': 28299}, '1': {'precision': 0.3417967599410898, 'recall': 0.41805670641639947, 'f1-score': 0.37609995624483444, 'support': 27757}, '2': {'precision': 0.3780026576714709, 'recall': 0.38991986503584986, 'f1-score': 0.38386879119738415, 'support': 28452}, 'accuracy': 0.35720878496710373, 'macro avg': {'precision': 0.35763474386887334, 'recall': 0.35753829929829334, 'f1-score': 0.3541685703884177, 'support': 84508}, 'weighted avg': {'precision': 0.3577731979572514, 'recall': 0.35720878496710373, 'f1-score': 0.3540816830244947, 'support': 84508}}
[[ 7489 11410  9400]
 [ 7298 11604  8855]
 [ 6422 10936 11094]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1043276
{'0': {'precision': 0.3737095664143152, 'recall': 0.13089594214543993, 'f1-score': 0.19388240895024988, 'support': 12445}, '1': {'precision': 0.30674660393109204, 'recall': 0.39038052926405253, 'f1-score': 0.3435468105902852, 'support': 10354}, '2': {'precision': 0.37864756246723746, 'recall': 0.5460272131698304, 'f1-score': 0.4471883061049011, 'support': 11906}, 'accuracy': 0.35072756087019163, 'macro avg': {'precision': 0.3530345776042149, 'recall': 0.3557678948597743, 'f1-score': 0.32820584188181207, 'support': 34705}, 'weighted avg': {'precision': 0.35542566690285576, 'recall': 0.35072756087019163, 'f1-score': 0.3254336328691147, 'support': 34705}}
[[1629 4930 5886]
 [1530 4042 4782]
 [1200 4205 6501]]
training model: results/CHTR/W5/deepLOB_L2/h100
Epoch 1/50
331/331 - 19s - loss: 3.3510 - accuracy100: 0.3455 - val_loss: 3.3736 - val_accuracy100: 0.3278 - 19s/epoch - 57ms/step
Epoch 2/50
331/331 - 16s - loss: 3.3186 - accuracy100: 0.3494 - val_loss: 3.3686 - val_accuracy100: 0.3357 - 16s/epoch - 49ms/step
Epoch 3/50
331/331 - 16s - loss: 3.3041 - accuracy100: 0.3557 - val_loss: 3.3423 - val_accuracy100: 0.3306 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2931 - accuracy100: 0.3629 - val_loss: 3.3180 - val_accuracy100: 0.3433 - 16s/epoch - 49ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2788 - accuracy100: 0.3749 - val_loss: 3.3213 - val_accuracy100: 0.3395 - 16s/epoch - 49ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2702 - accuracy100: 0.3813 - val_loss: 3.3332 - val_accuracy100: 0.3357 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2613 - accuracy100: 0.3883 - val_loss: 3.3354 - val_accuracy100: 0.3430 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2511 - accuracy100: 0.3937 - val_loss: 3.3444 - val_accuracy100: 0.3379 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2455 - accuracy100: 0.3996 - val_loss: 3.3417 - val_accuracy100: 0.3494 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2396 - accuracy100: 0.4001 - val_loss: 3.3450 - val_accuracy100: 0.3520 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2310 - accuracy100: 0.4071 - val_loss: 3.3513 - val_accuracy100: 0.3509 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.2221 - accuracy100: 0.4118 - val_loss: 3.3656 - val_accuracy100: 0.3500 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.2168 - accuracy100: 0.4143 - val_loss: 3.3841 - val_accuracy100: 0.3490 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.2097 - accuracy100: 0.4186 - val_loss: 3.3729 - val_accuracy100: 0.3511 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h100
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1066315
{'0': {'precision': 0.3422895670260548, 'recall': 0.19173833753602307, 'f1-score': 0.24579252124032686, 'support': 177664}, '1': {'precision': 0.350382771649182, 'recall': 0.30248417505350883, 'f1-score': 0.3246763959197016, 'support': 175672}, '2': {'precision': 0.329579116843918, 'recall': 0.5329676635999541, 'f1-score': 0.40729387868156225, 'support': 165541}, 'accuracy': 0.3380974681861019, 'macro avg': {'precision': 0.3407504851730516, 'recall': 0.3423967253964953, 'f1-score': 0.3259209319471969, 'support': 518877}, 'weighted avg': {'precision': 0.34097451318661476, 'recall': 0.3380974681861019, 'f1-score': 0.3240245188907424, 'support': 518877}}
[[34065 51631 91968]
 [35031 53138 87503]
 [30425 46888 88228]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1004908
{'0': {'precision': 0.350986691142726, 'recall': 0.2722483269258152, 'f1-score': 0.306643679082635, 'support': 28092}, '1': {'precision': 0.3495258488834506, 'recall': 0.40960745653342895, 'f1-score': 0.377189073202938, 'support': 27895}, '2': {'precision': 0.3699547089383242, 'recall': 0.38950247186283793, 'f1-score': 0.37947701924883437, 'support': 28521}, 'accuracy': 0.3571614521702087, 'macro avg': {'precision': 0.3568224163215003, 'recall': 0.35711941844069406, 'f1-score': 0.3544365905114691, 'support': 84508}, 'weighted avg': {'precision': 0.3569060909714496, 'recall': 0.3571614521702087, 'f1-score': 0.35451066757918, 'support': 84508}}
[[ 7648 10615  9829]
 [ 7379 11426  9090]
 [ 6763 10649 11109]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1043584
{'0': {'precision': 0.3799836155106499, 'recall': 0.22472545219638243, 'f1-score': 0.28242338136797235, 'support': 12384}, '1': {'precision': 0.31804645622394284, 'recall': 0.40527464187458495, 'f1-score': 0.3564009510699537, 'support': 10541}, '2': {'precision': 0.357803426768944, 'recall': 0.4236842105263158, 'f1-score': 0.38796688561545345, 'support': 11780}, 'accuracy': 0.34709696009220575, 'macro avg': {'precision': 0.3519444995011789, 'recall': 0.3512281015324277, 'f1-score': 0.34226373935112653, 'support': 34705}, 'weighted avg': {'precision': 0.3536426784866339, 'recall': 0.34709696009220575, 'f1-score': 0.34071757650596146, 'support': 34705}}
[[2783 4787 4814]
 [2125 4272 4144]
 [2416 4373 4991]]
training model: results/CHTR/W5/deepLOB_L2/h200
Epoch 1/50
331/331 - 19s - loss: 3.3494 - accuracy200: 0.3414 - val_loss: 3.3616 - val_accuracy200: 0.3359 - 19s/epoch - 57ms/step
Epoch 2/50
331/331 - 16s - loss: 3.3197 - accuracy200: 0.3515 - val_loss: 3.3557 - val_accuracy200: 0.3395 - 16s/epoch - 49ms/step
Epoch 3/50
331/331 - 16s - loss: 3.3031 - accuracy200: 0.3590 - val_loss: 3.3708 - val_accuracy200: 0.3301 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2906 - accuracy200: 0.3667 - val_loss: 3.3661 - val_accuracy200: 0.3379 - 16s/epoch - 49ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2790 - accuracy200: 0.3749 - val_loss: 3.3688 - val_accuracy200: 0.3326 - 16s/epoch - 49ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2700 - accuracy200: 0.3816 - val_loss: 3.3639 - val_accuracy200: 0.3440 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2709 - accuracy200: 0.3853 - val_loss: 3.3700 - val_accuracy200: 0.3438 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2591 - accuracy200: 0.3902 - val_loss: 3.4007 - val_accuracy200: 0.3389 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2492 - accuracy200: 0.3961 - val_loss: 3.3853 - val_accuracy200: 0.3385 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2433 - accuracy200: 0.3992 - val_loss: 3.4266 - val_accuracy200: 0.3347 - 16s/epoch - 48ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2370 - accuracy200: 0.4035 - val_loss: 3.4121 - val_accuracy200: 0.3346 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.2260 - accuracy200: 0.4108 - val_loss: 3.4078 - val_accuracy200: 0.3365 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h200
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1069078
{'0': {'precision': 0.3090703330042619, 'recall': 0.07757813113822759, 'f1-score': 0.12402531523261992, 'support': 165459}, '1': {'precision': 0.3732354749175717, 'recall': 0.5153050464732297, 'f1-score': 0.43291244263527706, 'support': 194413}, '2': {'precision': 0.31395053869459294, 'recall': 0.41252790792742366, 'f1-score': 0.3565511393285789, 'support': 159005}, 'accuracy': 0.34422801550271065, 'macro avg': {'precision': 0.33208544887214214, 'recall': 0.3351370285129603, 'f1-score': 0.30449629906549197, 'support': 518877}, 'weighted avg': {'precision': 0.33460724221508337, 'recall': 0.34422801550271065, 'f1-score': 0.31101460510307233, 'support': 518877}}
[[ 12836  86633  65990]
 [ 16884 100182  77347]
 [ 11811  81600  65594]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1200485
{'0': {'precision': 0.3292673451946236, 'recall': 0.15233644859813084, 'f1-score': 0.20830159003219384, 'support': 27820}, '1': {'precision': 0.33161538978645216, 'recall': 0.5307535057203314, 'f1-score': 0.40819197352089365, 'support': 27883}, '2': {'precision': 0.34801925212884116, 'recall': 0.326332233987155, 'f1-score': 0.33682701782674906, 'support': 28805}, 'accuracy': 0.33650068632555497, 'macro avg': {'precision': 0.3363006623699723, 'recall': 0.33647406276853914, 'f1-score': 0.31777352712661217, 'support': 84508}, 'weighted avg': {'precision': 0.33643375791997615, 'recall': 0.33650068632555497, 'f1-score': 0.31806301510955437, 'support': 84508}}
[[ 4238 14615  8967]
 [ 4441 14799  8643]
 [ 4192 15213  9400]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1170857
{'0': {'precision': 0.3628466421650518, 'recall': 0.0901394422310757, 'f1-score': 0.1444052922013164, 'support': 12048}, '1': {'precision': 0.33094642977774774, 'recall': 0.45098039215686275, 'f1-score': 0.38175017532922934, 'support': 10863}, '2': {'precision': 0.3482760660003548, 'recall': 0.49932168899440393, 'f1-score': 0.4103403825384106, 'support': 11794}, 'accuracy': 0.34214090188733615, 'macro avg': {'precision': 0.3473563793143848, 'recall': 0.34681384112744745, 'f1-score': 0.3121652833563188, 'support': 34705}, 'weighted avg': {'precision': 0.3479099649586055, 'recall': 0.34214090188733615, 'f1-score': 0.3090707848062496, 'support': 34705}}
[[1086 4944 6018]
 [ 962 4899 5002]
 [ 945 4960 5889]]
training model: results/CHTR/W5/deepLOB_L2/h300
Epoch 1/50
331/331 - 19s - loss: 3.3429 - accuracy300: 0.3530 - val_loss: 3.4523 - val_accuracy300: 0.3285 - 19s/epoch - 57ms/step
Epoch 2/50
331/331 - 17s - loss: 3.3151 - accuracy300: 0.3588 - val_loss: 3.3698 - val_accuracy300: 0.3518 - 17s/epoch - 50ms/step
Epoch 3/50
331/331 - 16s - loss: 3.2974 - accuracy300: 0.3671 - val_loss: 3.3736 - val_accuracy300: 0.3422 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2884 - accuracy300: 0.3707 - val_loss: 3.3593 - val_accuracy300: 0.3518 - 16s/epoch - 50ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2768 - accuracy300: 0.3825 - val_loss: 3.3662 - val_accuracy300: 0.3455 - 16s/epoch - 49ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2729 - accuracy300: 0.3839 - val_loss: 3.3684 - val_accuracy300: 0.3508 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2667 - accuracy300: 0.3862 - val_loss: 3.3782 - val_accuracy300: 0.3493 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2591 - accuracy300: 0.3933 - val_loss: 3.3959 - val_accuracy300: 0.3527 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2503 - accuracy300: 0.3975 - val_loss: 3.4037 - val_accuracy300: 0.3462 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2466 - accuracy300: 0.3993 - val_loss: 3.3914 - val_accuracy300: 0.3424 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2386 - accuracy300: 0.4008 - val_loss: 3.4105 - val_accuracy300: 0.3380 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.2248 - accuracy300: 0.4110 - val_loss: 3.4440 - val_accuracy300: 0.3349 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.2201 - accuracy300: 0.4130 - val_loss: 3.4485 - val_accuracy300: 0.3314 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.2078 - accuracy300: 0.4211 - val_loss: 3.4413 - val_accuracy300: 0.3382 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h300
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1243385
{'0': {'precision': 0.28467787165523856, 'recall': 0.09813092854870999, 'f1-score': 0.14595121046285134, 'support': 160347}, '1': {'precision': 0.42502816241488967, 'recall': 0.2102867120105353, 'f1-score': 0.2813652832131143, 'support': 202747}, '2': {'precision': 0.30973346582510536, 'recall': 0.7223124474429173, 'f1-score': 0.4335550092857308, 'support': 155783}, 'accuracy': 0.3293535847609356, 'macro avg': {'precision': 0.33981316663174455, 'recall': 0.3435766960007209, 'f1-score': 0.28695716765389884, 'support': 518877}, 'weighted avg': {'precision': 0.3470410830275124, 'recall': 0.3293535847609356, 'f1-score': 0.2852107644610478, 'support': 518877}}
[[ 15735  30006 114606]
 [ 23949  42635 136163]
 [ 15589  27670 112524]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1136825
{'0': {'precision': 0.3295427809583562, 'recall': 0.1518282988871224, 'f1-score': 0.2078808716946595, 'support': 27676}, '1': {'precision': 0.36792785854112514, 'recall': 0.41125618767486904, 'f1-score': 0.38838733718389534, 'support': 27878}, '2': {'precision': 0.3654054586658784, 'recall': 0.5123299026041307, 'f1-score': 0.42657081236520483, 'support': 28954}, 'accuracy': 0.36092440952335875, 'macro avg': {'precision': 0.3542920327217866, 'recall': 0.3584714630553741, 'f1-score': 0.34094634041458655, 'support': 84508}, 'weighted avg': {'precision': 0.3544926929571732, 'recall': 0.36092440952335875, 'f1-score': 0.3423546231393024, 'support': 84508}}
[[ 4202  9612 13862]
 [ 4513 11465 11900]
 [ 4036 10084 14834]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 20ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1180209
{'0': {'precision': 0.3525243578387954, 'recall': 0.10010060362173039, 'f1-score': 0.15592556317335945, 'support': 11928}, '1': {'precision': 0.3753594672317239, 'recall': 0.2246376811594203, 'f1-score': 0.28106760355867855, 'support': 11040}, '2': {'precision': 0.3437335599530573, 'recall': 0.7236943000766806, 'f1-score': 0.46608867427568035, 'support': 11737}, 'accuracy': 0.3506123037026365, 'macro avg': {'precision': 0.3572057950078589, 'recall': 0.34947752828594375, 'f1-score': 0.30102728033590614, 'support': 34705}, 'weighted avg': {'precision': 0.3568154401875354, 'recall': 0.3506123037026365, 'f1-score': 0.30062957011362346, 'support': 34705}}
[[1194 2029 8705]
 [1048 2480 7512]
 [1145 2098 8494]]
training model: results/CHTR/W5/deepLOB_L2/h500
Epoch 1/50
331/331 - 19s - loss: 3.3484 - accuracy500: 0.3469 - val_loss: 3.3922 - val_accuracy500: 0.3481 - 19s/epoch - 57ms/step
Epoch 2/50
331/331 - 16s - loss: 3.3222 - accuracy500: 0.3545 - val_loss: 3.5209 - val_accuracy500: 0.3458 - 16s/epoch - 49ms/step
Epoch 3/50
331/331 - 16s - loss: 3.3065 - accuracy500: 0.3621 - val_loss: 3.5127 - val_accuracy500: 0.3452 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 16s - loss: 3.2846 - accuracy500: 0.3746 - val_loss: 3.4194 - val_accuracy500: 0.3372 - 16s/epoch - 49ms/step
Epoch 5/50
331/331 - 16s - loss: 3.2774 - accuracy500: 0.3752 - val_loss: 3.4249 - val_accuracy500: 0.3364 - 16s/epoch - 49ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2670 - accuracy500: 0.3849 - val_loss: 3.4413 - val_accuracy500: 0.3344 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2546 - accuracy500: 0.3904 - val_loss: 3.4127 - val_accuracy500: 0.3309 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2428 - accuracy500: 0.3956 - val_loss: 3.4366 - val_accuracy500: 0.3236 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.2311 - accuracy500: 0.4059 - val_loss: 3.4396 - val_accuracy500: 0.3251 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.2207 - accuracy500: 0.4102 - val_loss: 3.4169 - val_accuracy500: 0.3312 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.2109 - accuracy500: 0.4156 - val_loss: 3.4261 - val_accuracy500: 0.3343 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h500
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.130515
{'0': {'precision': 0.27234328623252746, 'recall': 0.13719576482916823, 'f1-score': 0.18247024479788557, 'support': 156499}, '1': {'precision': 0.4199414247566543, 'recall': 0.2348042615497245, 'f1-score': 0.30119797104851814, 'support': 207624}, '2': {'precision': 0.31069396726027865, 'recall': 0.6503806040554687, 'f1-score': 0.4205070785017015, 'support': 154754}, 'accuracy': 0.3293092582635191, 'macro avg': {'precision': 0.33432622608315343, 'recall': 0.34079354347812046, 'f1-score': 0.30139176478270174, 'support': 518877}, 'weighted avg': {'precision': 0.34284137576955054, 'recall': 0.3293092582635191, 'f1-score': 0.3009720816456581, 'support': 518877}}
[[ 21471  34255 100773]
 [ 36346  48751 122527]
 [ 21021  33084 100649]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 20ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1259485
{'0': {'precision': 0.3264701525699896, 'recall': 0.16227359740833455, 'f1-score': 0.21679043918752766, 'support': 27164}, '1': {'precision': 0.34640851037123044, 'recall': 0.39725780912624153, 'f1-score': 0.37009471125639093, 'support': 27788}, '2': {'precision': 0.3607654768900585, 'recall': 0.47773717688455813, 'f1-score': 0.4110925103719339, 'support': 29556}, 'accuracy': 0.3498722014483836, 'macro avg': {'precision': 0.3445480466104262, 'recall': 0.34575619447304473, 'f1-score': 0.3326592202719508, 'support': 84508}, 'weighted avg': {'precision': 0.34502081868662754, 'recall': 0.3498722014483836, 'f1-score': 0.3351556960646977, 'support': 84508}}
[[ 4408  9889 12867]
 [ 4597 11039 12152]
 [ 4497 10939 14120]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1239045
{'0': {'precision': 0.35877502944640755, 'recall': 0.12778989763383117, 'f1-score': 0.1884551135309039, 'support': 11918}, '1': {'precision': 0.3265528514347984, 'recall': 0.24749931173717538, 'f1-score': 0.2815827939026937, 'support': 10897}, '2': {'precision': 0.3535876762308004, 'recall': 0.6602186711522288, 'f1-score': 0.4605321052477193, 'support': 11890}, 'accuracy': 0.3477885030975364, 'macro avg': {'precision': 0.3463051857040021, 'recall': 0.34516929350774506, 'f1-score': 0.3101900042271057, 'support': 34705}, 'weighted avg': {'precision': 0.34688041185453106, 'recall': 0.3477885030975364, 'f1-score': 0.31091031492909804, 'support': 34705}}
[[1523 2871 7524]
 [1373 2697 6827]
 [1349 2691 7850]]
training model: results/CHTR/W5/deepLOB_L2/h1000
Epoch 1/50
331/331 - 18s - loss: 3.3532 - accuracy1000: 0.3478 - val_loss: 3.5551 - val_accuracy1000: 0.3362 - 18s/epoch - 55ms/step
Epoch 2/50
331/331 - 16s - loss: 3.3087 - accuracy1000: 0.3647 - val_loss: 3.6500 - val_accuracy1000: 0.3383 - 16s/epoch - 49ms/step
Epoch 3/50
331/331 - 16s - loss: 3.2804 - accuracy1000: 0.3842 - val_loss: 3.4971 - val_accuracy1000: 0.3353 - 16s/epoch - 49ms/step
Epoch 4/50
331/331 - 17s - loss: 3.2624 - accuracy1000: 0.3890 - val_loss: 3.4294 - val_accuracy1000: 0.3406 - 17s/epoch - 50ms/step
Epoch 5/50
331/331 - 17s - loss: 3.2404 - accuracy1000: 0.4040 - val_loss: 3.4356 - val_accuracy1000: 0.3355 - 17s/epoch - 50ms/step
Epoch 6/50
331/331 - 16s - loss: 3.2173 - accuracy1000: 0.4130 - val_loss: 3.4681 - val_accuracy1000: 0.3340 - 16s/epoch - 49ms/step
Epoch 7/50
331/331 - 16s - loss: 3.2086 - accuracy1000: 0.4177 - val_loss: 3.5419 - val_accuracy1000: 0.3443 - 16s/epoch - 49ms/step
Epoch 8/50
331/331 - 16s - loss: 3.2001 - accuracy1000: 0.4212 - val_loss: 3.4597 - val_accuracy1000: 0.3365 - 16s/epoch - 49ms/step
Epoch 9/50
331/331 - 16s - loss: 3.1788 - accuracy1000: 0.4292 - val_loss: 3.4733 - val_accuracy1000: 0.3396 - 16s/epoch - 49ms/step
Epoch 10/50
331/331 - 16s - loss: 3.1625 - accuracy1000: 0.4357 - val_loss: 3.5383 - val_accuracy1000: 0.3334 - 16s/epoch - 49ms/step
Epoch 11/50
331/331 - 16s - loss: 3.1518 - accuracy1000: 0.4419 - val_loss: 3.5676 - val_accuracy1000: 0.3325 - 16s/epoch - 49ms/step
Epoch 12/50
331/331 - 16s - loss: 3.1403 - accuracy1000: 0.4442 - val_loss: 3.5837 - val_accuracy1000: 0.3217 - 16s/epoch - 49ms/step
Epoch 13/50
331/331 - 16s - loss: 3.1176 - accuracy1000: 0.4536 - val_loss: 3.6174 - val_accuracy1000: 0.3250 - 16s/epoch - 49ms/step
Epoch 14/50
331/331 - 16s - loss: 3.1013 - accuracy1000: 0.4612 - val_loss: 3.6416 - val_accuracy1000: 0.3249 - 16s/epoch - 49ms/step
testing model: results/CHTR/W5/deepLOB_L2/h1000
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.136745
{'0': {'precision': 0.29442792047002975, 'recall': 0.13001507514929575, 'f1-score': 0.18037790045330102, 'support': 154559}, '1': {'precision': 0.44929163654263254, 'recall': 0.1390076052503831, 'f1-score': 0.21232376320753688, 'support': 210118}, '2': {'precision': 0.30980999281670674, 'recall': 0.7747600518806744, 'f1-score': 0.44262407445486157, 'support': 154200}, 'accuracy': 0.32526205632548755, 'macro avg': {'precision': 0.3511765166097896, 'recall': 0.34792757742678443, 'f1-score': 0.27844191270523316, 'support': 518877}, 'weighted avg': {'precision': 0.36171086006766223, 'recall': 0.32526205632548755, 'f1-score': 0.27124868644157024, 'support': 518877}}
[[ 20095  19364 115100]
 [ 29861  29208 151049]
 [ 18295  16437 119468]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 20ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1405424
{'0': {'precision': 0.3145352010187375, 'recall': 0.31716623252742415, 'f1-score': 0.3158452376602974, 'support': 27257}, '1': {'precision': 0.3595997034840623, 'recall': 0.17366555686822038, 'f1-score': 0.23421770513965667, 'support': 27933}, '2': {'precision': 0.3635862449176487, 'recall': 0.5398731154921891, 'f1-score': 0.43453075455381535, 'support': 29318}, 'accuracy': 0.34699673403701425, 'macro avg': {'precision': 0.34590704980681614, 'recall': 0.3435683016292779, 'f1-score': 0.32819789911792313, 'support': 84508}, 'weighted avg': {'precision': 0.34644774482988194, 'recall': 0.34699673403701425, 'f1-score': 0.33003939819403505, 'support': 84508}}
[[ 8645  4097 14515]
 [ 9892  4851 13190]
 [ 8948  4542 15828]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1371497
{'0': {'precision': 0.314427600627287, 'recall': 0.1000083132429961, 'f1-score': 0.15175023651844846, 'support': 12029}, '1': {'precision': 0.3403708987161198, 'recall': 0.1106371139757025, 'f1-score': 0.16699328107502798, 'support': 10783}, '2': {'precision': 0.34631402060349237, 'recall': 0.7971075422517447, 'f1-score': 0.4828481931392773, 'support': 11893}, 'accuracy': 0.34219853047111365, 'macro avg': {'precision': 0.3337041733156331, 'recall': 0.3359176564901478, 'f1-score': 0.2671972369109179, 'support': 34705}, 'weighted avg': {'precision': 0.3334154057294018, 'recall': 0.34219853047111365, 'f1-score': 0.26994973940117756, 'support': 34705}}
[[1203 1033 9793]
 [1489 1193 8101]
 [1134 1279 9480]]
training model: results/CHTR/W5/deepOF_L2/h10
Epoch 1/50
331/331 - 13s - loss: 3.3158 - accuracy10: 0.3631 - val_loss: 3.3035 - val_accuracy10: 0.3704 - 13s/epoch - 38ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2495 - accuracy10: 0.4030 - val_loss: 3.2614 - val_accuracy10: 0.3971 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2147 - accuracy10: 0.4216 - val_loss: 3.2483 - val_accuracy10: 0.4032 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 3.1891 - accuracy10: 0.4337 - val_loss: 3.2381 - val_accuracy10: 0.4108 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.1723 - accuracy10: 0.4410 - val_loss: 3.2289 - val_accuracy10: 0.4137 - 10s/epoch - 31ms/step
Epoch 6/50
331/331 - 10s - loss: 3.1569 - accuracy10: 0.4459 - val_loss: 3.2191 - val_accuracy10: 0.4204 - 10s/epoch - 31ms/step
Epoch 7/50
331/331 - 10s - loss: 3.1422 - accuracy10: 0.4532 - val_loss: 3.2051 - val_accuracy10: 0.4257 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.1296 - accuracy10: 0.4567 - val_loss: 3.2174 - val_accuracy10: 0.4236 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 3.1193 - accuracy10: 0.4602 - val_loss: 3.2088 - val_accuracy10: 0.4260 - 10s/epoch - 31ms/step
Epoch 10/50
331/331 - 10s - loss: 3.1075 - accuracy10: 0.4647 - val_loss: 3.2068 - val_accuracy10: 0.4311 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.0978 - accuracy10: 0.4679 - val_loss: 3.2107 - val_accuracy10: 0.4287 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.0908 - accuracy10: 0.4705 - val_loss: 3.2120 - val_accuracy10: 0.4314 - 10s/epoch - 31ms/step
Epoch 13/50
331/331 - 10s - loss: 3.0809 - accuracy10: 0.4755 - val_loss: 3.2010 - val_accuracy10: 0.4320 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 3.0700 - accuracy10: 0.4784 - val_loss: 3.1977 - val_accuracy10: 0.4359 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 3.0606 - accuracy10: 0.4815 - val_loss: 3.2103 - val_accuracy10: 0.4324 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.0504 - accuracy10: 0.4853 - val_loss: 3.2075 - val_accuracy10: 0.4334 - 10s/epoch - 31ms/step
Epoch 17/50
331/331 - 10s - loss: 3.0404 - accuracy10: 0.4886 - val_loss: 3.2056 - val_accuracy10: 0.4342 - 10s/epoch - 31ms/step
Epoch 18/50
331/331 - 10s - loss: 3.0307 - accuracy10: 0.4922 - val_loss: 3.2079 - val_accuracy10: 0.4351 - 10s/epoch - 31ms/step
Epoch 19/50
331/331 - 10s - loss: 3.0210 - accuracy10: 0.4952 - val_loss: 3.2260 - val_accuracy10: 0.4310 - 10s/epoch - 31ms/step
Epoch 20/50
331/331 - 10s - loss: 3.0105 - accuracy10: 0.4991 - val_loss: 3.2304 - val_accuracy10: 0.4311 - 10s/epoch - 30ms/step
Epoch 21/50
331/331 - 10s - loss: 3.0052 - accuracy10: 0.5001 - val_loss: 3.2302 - val_accuracy10: 0.4331 - 10s/epoch - 30ms/step
Epoch 22/50
331/331 - 10s - loss: 2.9932 - accuracy10: 0.5047 - val_loss: 3.2403 - val_accuracy10: 0.4301 - 10s/epoch - 30ms/step
Epoch 23/50
331/331 - 10s - loss: 2.9846 - accuracy10: 0.5058 - val_loss: 3.2402 - val_accuracy10: 0.4309 - 10s/epoch - 31ms/step
Epoch 24/50
331/331 - 10s - loss: 2.9730 - accuracy10: 0.5095 - val_loss: 3.2447 - val_accuracy10: 0.4334 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/h10
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.083437
{'0': {'precision': 0.46128814132364127, 'recall': 0.29123908020214634, 'f1-score': 0.3570505628085142, 'support': 187389}, '1': {'precision': 0.37355024377340246, 'recall': 0.5548029181258425, 'f1-score': 0.4464825969636676, 'support': 147629}, '2': {'precision': 0.4421542076436423, 'recall': 0.4360144462453904, 'f1-score': 0.4390628637154085, 'support': 183854}, 'accuracy': 0.4175268659707982, 'macro avg': {'precision': 0.4256641975802287, 'recall': 0.4273521481911264, 'f1-score': 0.41419867449586345, 'support': 518872}, 'weighted avg': {'precision': 0.42954522915985766, 'recall': 0.4175268659707982, 'f1-score': 0.4115554336460759, 'support': 518872}}
[[54575 73053 59761]
 [24347 81905 41377]
 [39388 64303 80163]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0273397
{'0': {'precision': 0.5138069635120321, 'recall': 0.3493770631455649, 'f1-score': 0.4159306993450243, 'support': 28173}, '1': {'precision': 0.4559815116911365, 'recall': 0.5940001416731601, 'f1-score': 0.5159196480757992, 'support': 28234}, '2': {'precision': 0.47290674880985717, 'recall': 0.4808171400099651, 'f1-score': 0.4768291391663431, 'support': 28098}, 'accuracy': 0.4748121412934146, 'macro avg': {'precision': 0.48089840800434197, 'recall': 0.47473144827623, 'f1-score': 0.46955982886238884, 'support': 84505}, 'weighted avg': {'precision': 0.4808875144922951, 'recall': 0.4748121412934146, 'f1-score': 0.46958684206514867, 'support': 84505}}
[[ 9843 10446  7884]
 [ 4289 16771  7174]
 [ 5025  9563 13510]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.067348
{'0': {'precision': 0.4712510163782089, 'recall': 0.32882152698978767, 'f1-score': 0.38735857163316945, 'support': 12338}, '1': {'precision': 0.4009768177753319, 'recall': 0.5532985287138111, 'f1-score': 0.46498085513720483, 'support': 10535}, '2': {'precision': 0.446491911064971, 'recall': 0.4361899932386748, 'f1-score': 0.4412808345089992, 'support': 11832}, 'accuracy': 0.433568650050425, 'macro avg': {'precision': 0.43957324840617057, 'recall': 0.4394366829807579, 'f1-score': 0.4312067537597912, 'support': 34705}, 'weighted avg': {'precision': 0.4414775423442789, 'recall': 0.433568650050425, 'f1-score': 0.4293052355450505, 'support': 34705}}
[[4057 4718 3563]
 [1871 5829 2835]
 [2681 3990 5161]]
training model: results/CHTR/W5/deepOF_L2/h20
Epoch 1/50
331/331 - 13s - loss: 3.3181 - accuracy20: 0.3580 - val_loss: 3.2988 - val_accuracy20: 0.3671 - 13s/epoch - 39ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2651 - accuracy20: 0.3913 - val_loss: 3.2731 - val_accuracy20: 0.3856 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2386 - accuracy20: 0.4062 - val_loss: 3.2610 - val_accuracy20: 0.3933 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2175 - accuracy20: 0.4206 - val_loss: 3.2514 - val_accuracy20: 0.3947 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2003 - accuracy20: 0.4291 - val_loss: 3.2480 - val_accuracy20: 0.4046 - 10s/epoch - 31ms/step
Epoch 6/50
331/331 - 10s - loss: 3.1874 - accuracy20: 0.4331 - val_loss: 3.2512 - val_accuracy20: 0.4034 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.1765 - accuracy20: 0.4391 - val_loss: 3.2415 - val_accuracy20: 0.4088 - 10s/epoch - 30ms/step
Epoch 8/50
331/331 - 10s - loss: 3.1637 - accuracy20: 0.4457 - val_loss: 3.2384 - val_accuracy20: 0.4124 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 3.1519 - accuracy20: 0.4508 - val_loss: 3.2491 - val_accuracy20: 0.4082 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.1447 - accuracy20: 0.4515 - val_loss: 3.2408 - val_accuracy20: 0.4133 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.1349 - accuracy20: 0.4552 - val_loss: 3.2505 - val_accuracy20: 0.4104 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.1252 - accuracy20: 0.4606 - val_loss: 3.2395 - val_accuracy20: 0.4147 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.1169 - accuracy20: 0.4642 - val_loss: 3.2408 - val_accuracy20: 0.4125 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 3.1060 - accuracy20: 0.4677 - val_loss: 3.2539 - val_accuracy20: 0.4148 - 10s/epoch - 31ms/step
Epoch 15/50
331/331 - 10s - loss: 3.0973 - accuracy20: 0.4710 - val_loss: 3.2555 - val_accuracy20: 0.4143 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.0894 - accuracy20: 0.4740 - val_loss: 3.2486 - val_accuracy20: 0.4165 - 10s/epoch - 30ms/step
Epoch 17/50
331/331 - 10s - loss: 3.0780 - accuracy20: 0.4776 - val_loss: 3.2600 - val_accuracy20: 0.4127 - 10s/epoch - 30ms/step
Epoch 18/50
331/331 - 10s - loss: 3.0685 - accuracy20: 0.4806 - val_loss: 3.2591 - val_accuracy20: 0.4131 - 10s/epoch - 30ms/step
testing model: results/CHTR/W5/deepOF_L2/h20
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0977488
{'0': {'precision': 0.44812980113432405, 'recall': 0.23103360758021194, 'f1-score': 0.30488404790895485, 'support': 189124}, '1': {'precision': 0.33951795215623576, 'recall': 0.5307547081074181, 'f1-score': 0.4141248135712282, 'support': 148839}, '2': {'precision': 0.4175733326267257, 'recall': 0.4355449424848957, 'f1-score': 0.4263698444822026, 'support': 180909}, 'accuracy': 0.388313495428545, 'macro avg': {'precision': 0.4017403619724285, 'recall': 0.3991110860575086, 'f1-score': 0.3817929019874619, 'support': 518872}, 'weighted avg': {'precision': 0.4063206089804002, 'recall': 0.388313495428545, 'f1-score': 0.37857690528548854, 'support': 518872}}
[[43694 84007 61423]
 [21364 78997 48478]
 [32445 69670 78794]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.058493
{'0': {'precision': 0.4970063538611926, 'recall': 0.28582973191384703, 'f1-score': 0.36293470744384215, 'support': 28461}, '1': {'precision': 0.41264349318742627, 'recall': 0.5553550157022705, 'f1-score': 0.4734793112468648, 'support': 27703}, '2': {'precision': 0.4472822740090105, 'recall': 0.48692706679369113, 'f1-score': 0.466263472649255, 'support': 28341}, 'accuracy': 0.4416306727412579, 'macro avg': {'precision': 0.4523107070192098, 'recall': 0.4427039381366029, 'f1-score': 0.43422583044665397, 'support': 84505}, 'weighted avg': {'precision': 0.45267365785106256, 'recall': 0.4416306727412579, 'f1-score': 0.4338282367479276, 'support': 84505}}
[[ 8135 11801  8525]
 [ 3790 15385  8528]
 [ 4443 10098 13800]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0816102
{'0': {'precision': 0.4587375228454942, 'recall': 0.2630178945671449, 'f1-score': 0.3343408986116092, 'support': 12406}, '1': {'precision': 0.36686352131870986, 'recall': 0.5406465187452181, 'f1-score': 0.4371157935433984, 'support': 10456}, '2': {'precision': 0.4383156857916769, 'recall': 0.4508992653888373, 'f1-score': 0.444518438358445, 'support': 11843}, 'accuracy': 0.41077654516640255, 'macro avg': {'precision': 0.4213055766519604, 'recall': 0.4181878929004001, 'f1-score': 0.40532504350448423, 'support': 34705}, 'weighted avg': {'precision': 0.4240886141524408, 'recall': 0.41077654516640255, 'f1-score': 0.4029029762554232, 'support': 34705}}
[[3263 5445 3698]
 [1658 5653 3145]
 [2192 4311 5340]]
training model: results/CHTR/W5/deepOF_L2/h30
Epoch 1/50
331/331 - 12s - loss: 3.3240 - accuracy30: 0.3561 - val_loss: 3.2950 - val_accuracy30: 0.3649 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2709 - accuracy30: 0.3863 - val_loss: 3.2736 - val_accuracy30: 0.3853 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2470 - accuracy30: 0.4016 - val_loss: 3.2684 - val_accuracy30: 0.3899 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2305 - accuracy30: 0.4131 - val_loss: 3.2593 - val_accuracy30: 0.3910 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2143 - accuracy30: 0.4200 - val_loss: 3.2497 - val_accuracy30: 0.4030 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2008 - accuracy30: 0.4270 - val_loss: 3.2502 - val_accuracy30: 0.4025 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.1917 - accuracy30: 0.4322 - val_loss: 3.2476 - val_accuracy30: 0.4046 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.1826 - accuracy30: 0.4344 - val_loss: 3.2420 - val_accuracy30: 0.4081 - 10s/epoch - 30ms/step
Epoch 9/50
331/331 - 10s - loss: 3.1708 - accuracy30: 0.4392 - val_loss: 3.2451 - val_accuracy30: 0.4087 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.1621 - accuracy30: 0.4459 - val_loss: 3.2481 - val_accuracy30: 0.4076 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.1521 - accuracy30: 0.4479 - val_loss: 3.2493 - val_accuracy30: 0.4084 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.1431 - accuracy30: 0.4531 - val_loss: 3.2477 - val_accuracy30: 0.4117 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.1317 - accuracy30: 0.4582 - val_loss: 3.2476 - val_accuracy30: 0.4104 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 3.1242 - accuracy30: 0.4619 - val_loss: 3.2546 - val_accuracy30: 0.4098 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 3.1146 - accuracy30: 0.4642 - val_loss: 3.2618 - val_accuracy30: 0.4084 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.1024 - accuracy30: 0.4675 - val_loss: 3.2671 - val_accuracy30: 0.4111 - 10s/epoch - 31ms/step
Epoch 17/50
331/331 - 10s - loss: 3.0952 - accuracy30: 0.4727 - val_loss: 3.2603 - val_accuracy30: 0.4108 - 10s/epoch - 30ms/step
Epoch 18/50
331/331 - 10s - loss: 3.0813 - accuracy30: 0.4761 - val_loss: 3.2766 - val_accuracy30: 0.4100 - 10s/epoch - 30ms/step
testing model: results/CHTR/W5/deepOF_L2/h30
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.1015073
{'0': {'precision': 0.44181704468112504, 'recall': 0.25331962242261247, 'f1-score': 0.322011288527799, 'support': 189630}, '1': {'precision': 0.3257982341156976, 'recall': 0.5243367675253252, 'f1-score': 0.4018843892133209, 'support': 150739}, '2': {'precision': 0.41358894167641513, 'recall': 0.3882063606774116, 'f1-score': 0.40049588066498876, 'support': 178503}, 'accuracy': 0.37845750011563545, 'macro avg': {'precision': 0.39373474015774595, 'recall': 0.3886209168751164, 'f1-score': 0.37479718613536955, 'support': 518872}, 'weighted avg': {'precision': 0.39840101807635214, 'recall': 0.37845750011563545, 'f1-score': 0.3722158215812297, 'support': 518872}}
[[48037 89016 52577]
 [26026 79038 45675]
 [34663 74544 69296]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0605041
{'0': {'precision': 0.4834797606856034, 'recall': 0.3165472703532484, 'f1-score': 0.38259756877799106, 'support': 28337}, '1': {'precision': 0.40279941830269034, 'recall': 0.5558502060562623, 'f1-score': 0.46710734344179605, 'support': 27905}, '2': {'precision': 0.455035709080309, 'recall': 0.44184976824823974, 'f1-score': 0.4483458093237834, 'support': 28263}, 'accuracy': 0.4374770723625821, 'macro avg': {'precision': 0.44710496268953426, 'recall': 0.4380824148859168, 'f1-score': 0.4326835738478568, 'support': 84505}, 'weighted avg': {'precision': 0.4473245132479888, 'recall': 0.4374770723625821, 'f1-score': 0.43249388005589423, 'support': 84505}}
[[ 8970 12203  7164]
 [ 4602 15511  7792]
 [ 4981 10794 12488]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0822219
{'0': {'precision': 0.4571609632446134, 'recall': 0.28939345314505777, 'f1-score': 0.35442664832465365, 'support': 12464}, '1': {'precision': 0.35459673919781787, 'recall': 0.5526570048309178, 'f1-score': 0.432007854688267, 'support': 10350}, '2': {'precision': 0.45058030700112317, 'recall': 0.4048439996636111, 'f1-score': 0.42648947951273536, 'support': 11891}, 'accuracy': 0.4074629015991932, 'macro avg': {'precision': 0.4207793364811849, 'recall': 0.4156314858798622, 'f1-score': 0.40430799417521873, 'support': 34705}, 'weighted avg': {'precision': 0.4243187127828449, 'recall': 0.4074629015991932, 'f1-score': 0.4022544717368674, 'support': 34705}}
[[3607 5753 3104]
 [1864 5720 2766]
 [2419 4658 4814]]
training model: results/CHTR/W5/deepOF_L2/h50
Epoch 1/50
331/331 - 13s - loss: 3.3276 - accuracy50: 0.3501 - val_loss: 3.2992 - val_accuracy50: 0.3620 - 13s/epoch - 38ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2807 - accuracy50: 0.3780 - val_loss: 3.2816 - val_accuracy50: 0.3733 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2589 - accuracy50: 0.3915 - val_loss: 3.2718 - val_accuracy50: 0.3828 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2439 - accuracy50: 0.4024 - val_loss: 3.2616 - val_accuracy50: 0.3898 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2326 - accuracy50: 0.4079 - val_loss: 3.2564 - val_accuracy50: 0.3961 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2225 - accuracy50: 0.4138 - val_loss: 3.2555 - val_accuracy50: 0.3971 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2154 - accuracy50: 0.4189 - val_loss: 3.2532 - val_accuracy50: 0.3983 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2073 - accuracy50: 0.4237 - val_loss: 3.2515 - val_accuracy50: 0.4018 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 3.1961 - accuracy50: 0.4284 - val_loss: 3.2532 - val_accuracy50: 0.4021 - 10s/epoch - 31ms/step
Epoch 10/50
331/331 - 10s - loss: 3.1887 - accuracy50: 0.4328 - val_loss: 3.2540 - val_accuracy50: 0.4017 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.1813 - accuracy50: 0.4349 - val_loss: 3.2580 - val_accuracy50: 0.3992 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.1720 - accuracy50: 0.4408 - val_loss: 3.2589 - val_accuracy50: 0.4005 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.1612 - accuracy50: 0.4457 - val_loss: 3.2675 - val_accuracy50: 0.4002 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 3.1557 - accuracy50: 0.4482 - val_loss: 3.2674 - val_accuracy50: 0.4006 - 10s/epoch - 31ms/step
Epoch 15/50
331/331 - 10s - loss: 3.1478 - accuracy50: 0.4513 - val_loss: 3.2779 - val_accuracy50: 0.3985 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.1371 - accuracy50: 0.4560 - val_loss: 3.2805 - val_accuracy50: 0.4001 - 10s/epoch - 31ms/step
Epoch 17/50
331/331 - 10s - loss: 3.1258 - accuracy50: 0.4596 - val_loss: 3.2925 - val_accuracy50: 0.3944 - 10s/epoch - 30ms/step
Epoch 18/50
331/331 - 10s - loss: 3.1168 - accuracy50: 0.4630 - val_loss: 3.2947 - val_accuracy50: 0.3961 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/h50
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1022239
{'0': {'precision': 0.4154477345701035, 'recall': 0.33559256907124063, 'f1-score': 0.3712748087772073, 'support': 187379}, '1': {'precision': 0.3269929062084714, 'recall': 0.441404794239333, 'f1-score': 0.3756810734820159, 'support': 158315}, '2': {'precision': 0.39347992873954823, 'recall': 0.3494554735589971, 'f1-score': 0.37016331274084047, 'support': 173178}, 'accuracy': 0.3725042014215452, 'macro avg': {'precision': 0.37864018983937436, 'recall': 0.37548427895652353, 'f1-score': 0.37237306500002126, 'support': 518872}, 'weighted avg': {'precision': 0.38112700261656646, 'recall': 0.3725042014215452, 'f1-score': 0.37224824950277324, 'support': 518872}}
[[62883 76812 47684]
 [42834 69881 45600]
 [45645 67015 60518]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0660368
{'0': {'precision': 0.45493490130197395, 'recall': 0.38304041868524347, 'f1-score': 0.4159035496937933, 'support': 28279}, '1': {'precision': 0.3918280313508529, 'recall': 0.4882059383190321, 'f1-score': 0.43473951755998536, 'support': 27853}, '2': {'precision': 0.4533492362740949, 'recall': 0.41528918337856413, 'f1-score': 0.4334853947465234, 'support': 28373}, 'accuracy': 0.42853085616235725, 'macro avg': {'precision': 0.43337072297564055, 'recall': 0.4288451801276132, 'f1-score': 0.4280428206667673, 'support': 84505}, 'weighted avg': {'precision': 0.4336023680485027, 'recall': 0.42853085616235725, 'f1-score': 0.428015115904765, 'support': 84505}}
[[10832 10869  6578]
 [ 6625 13598  7630]
 [ 6353 10237 11783]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0856555
{'0': {'precision': 0.4395908211224772, 'recall': 0.38248737070002403, 'f1-score': 0.4090558271160278, 'support': 12471}, '1': {'precision': 0.3422278695468022, 'recall': 0.4684963277928102, 'f1-score': 0.39552908542057597, 'support': 10348}, '2': {'precision': 0.45035094962840627, 'recall': 0.36707050311290595, 'f1-score': 0.4044683415222027, 'support': 11886}, 'accuracy': 0.4028526148969889, 'macro avg': {'precision': 0.41072321343256196, 'recall': 0.4060180672019134, 'f1-score': 0.40301775135293544, 'support': 34705}, 'weighted avg': {'precision': 0.41424528199314103, 'recall': 0.4028526148969889, 'f1-score': 0.40345140190834183, 'support': 34705}}
[[4770 4938 2763]
 [2938 4848 2562]
 [3143 4380 4363]]
training model: results/CHTR/W5/deepOF_L2/h100
Epoch 1/50
331/331 - 12s - loss: 3.3370 - accuracy100: 0.3419 - val_loss: 3.3138 - val_accuracy100: 0.3471 - 12s/epoch - 38ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2990 - accuracy100: 0.3626 - val_loss: 3.3015 - val_accuracy100: 0.3562 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2812 - accuracy100: 0.3727 - val_loss: 3.2932 - val_accuracy100: 0.3655 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2688 - accuracy100: 0.3822 - val_loss: 3.2868 - val_accuracy100: 0.3736 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2589 - accuracy100: 0.3869 - val_loss: 3.2831 - val_accuracy100: 0.3772 - 10s/epoch - 31ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2517 - accuracy100: 0.3944 - val_loss: 3.2846 - val_accuracy100: 0.3794 - 10s/epoch - 31ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2428 - accuracy100: 0.3999 - val_loss: 3.2826 - val_accuracy100: 0.3793 - 10s/epoch - 30ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2362 - accuracy100: 0.4035 - val_loss: 3.2852 - val_accuracy100: 0.3790 - 10s/epoch - 30ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2290 - accuracy100: 0.4077 - val_loss: 3.2832 - val_accuracy100: 0.3822 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2205 - accuracy100: 0.4151 - val_loss: 3.2865 - val_accuracy100: 0.3785 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.2149 - accuracy100: 0.4173 - val_loss: 3.2862 - val_accuracy100: 0.3826 - 10s/epoch - 31ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2069 - accuracy100: 0.4206 - val_loss: 3.2906 - val_accuracy100: 0.3845 - 10s/epoch - 31ms/step
Epoch 13/50
331/331 - 10s - loss: 3.1966 - accuracy100: 0.4264 - val_loss: 3.2940 - val_accuracy100: 0.3850 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 3.1890 - accuracy100: 0.4289 - val_loss: 3.3023 - val_accuracy100: 0.3814 - 10s/epoch - 31ms/step
Epoch 15/50
331/331 - 10s - loss: 3.1806 - accuracy100: 0.4356 - val_loss: 3.3083 - val_accuracy100: 0.3815 - 10s/epoch - 31ms/step
Epoch 16/50
331/331 - 10s - loss: 3.1691 - accuracy100: 0.4408 - val_loss: 3.3153 - val_accuracy100: 0.3794 - 10s/epoch - 31ms/step
Epoch 17/50
331/331 - 10s - loss: 3.1584 - accuracy100: 0.4439 - val_loss: 3.3242 - val_accuracy100: 0.3798 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/h100
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1023704
{'0': {'precision': 0.37738987618967407, 'recall': 0.4035325704572191, 'f1-score': 0.3900236379610967, 'support': 177661}, '1': {'precision': 0.35158972823879064, 'recall': 0.3744136800400747, 'f1-score': 0.3626429366943442, 'support': 175672}, '2': {'precision': 0.34787207039512646, 'recall': 0.2980445695576269, 'f1-score': 0.32103641575055225, 'support': 165539}, 'accuracy': 0.36001942675650256, 'macro avg': {'precision': 0.35895055827453043, 'recall': 0.3586636066849736, 'f1-score': 0.3579009968019977, 'support': 518872}, 'weighted avg': {'precision': 0.35923759268959854, 'recall': 0.36001942675650256, 'f1-score': 0.3587440577747612, 'support': 518872}}
[[71692 62887 43082]
 [60490 65774 49408]
 [57786 58415 49338]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0780357
{'0': {'precision': 0.4238700869440253, 'recall': 0.420216555064824, 'f1-score': 0.422035414058308, 'support': 28076}, '1': {'precision': 0.37648758124784126, 'recall': 0.42936436884512086, 'f1-score': 0.4011911932008298, 'support': 27925}, '2': {'precision': 0.4324444086368031, 'recall': 0.3766138085882683, 'f1-score': 0.4026027602760276, 'support': 28504}, 'accuracy': 0.4085320395242885, 'macro avg': {'precision': 0.41093402560955655, 'recall': 0.4087315774994044, 'f1-score': 0.40860978917838847, 'support': 84505}, 'weighted avg': {'precision': 0.41110452270480863, 'recall': 0.4085320395242885, 'f1-score': 0.4085926209590216, 'support': 84505}}
[[11798  9810  6468]
 [ 8314 11990  7621]
 [ 7722 10047 10735]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 15ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0947039
{'0': {'precision': 0.4089556793042948, 'recall': 0.432827385758114, 'f1-score': 0.4205530496175721, 'support': 12386}, '1': {'precision': 0.3248589814888377, 'recall': 0.38879908719216505, 'f1-score': 0.3539646814404432, 'support': 10517}, '2': {'precision': 0.41425241425241427, 'recall': 0.3162175902389425, 'f1-score': 0.358656479746288, 'support': 11802}, 'accuracy': 0.3798299956778562, 'macro avg': {'precision': 0.3826890250151822, 'recall': 0.37928135439640726, 'f1-score': 0.37772473693476777, 'support': 34705}, 'weighted avg': {'precision': 0.3852722646646908, 'recall': 0.3798299956778562, 'f1-score': 0.37932518084535605, 'support': 34705}}
[[5361 4363 2662]
 [3813 4089 2615]
 [3935 4135 3732]]
training model: results/CHTR/W5/deepOF_L2/h200
Epoch 1/50
331/331 - 12s - loss: 3.3418 - accuracy200: 0.3387 - val_loss: 3.3278 - val_accuracy200: 0.3365 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3124 - accuracy200: 0.3485 - val_loss: 3.3129 - val_accuracy200: 0.3458 - 10s/epoch - 31ms/step
Epoch 3/50
331/331 - 10s - loss: 3.2981 - accuracy200: 0.3583 - val_loss: 3.3082 - val_accuracy200: 0.3472 - 10s/epoch - 31ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2861 - accuracy200: 0.3646 - val_loss: 3.3059 - val_accuracy200: 0.3487 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2796 - accuracy200: 0.3707 - val_loss: 3.3057 - val_accuracy200: 0.3520 - 10s/epoch - 31ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2724 - accuracy200: 0.3761 - val_loss: 3.3031 - val_accuracy200: 0.3544 - 10s/epoch - 31ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2678 - accuracy200: 0.3823 - val_loss: 3.3027 - val_accuracy200: 0.3574 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2612 - accuracy200: 0.3854 - val_loss: 3.3037 - val_accuracy200: 0.3588 - 10s/epoch - 30ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2547 - accuracy200: 0.3893 - val_loss: 3.3060 - val_accuracy200: 0.3553 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2503 - accuracy200: 0.3915 - val_loss: 3.3074 - val_accuracy200: 0.3607 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.2430 - accuracy200: 0.3982 - val_loss: 3.3075 - val_accuracy200: 0.3562 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2375 - accuracy200: 0.4013 - val_loss: 3.3149 - val_accuracy200: 0.3579 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2290 - accuracy200: 0.4076 - val_loss: 3.3193 - val_accuracy200: 0.3561 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 3.2217 - accuracy200: 0.4106 - val_loss: 3.3251 - val_accuracy200: 0.3502 - 10s/epoch - 31ms/step
Epoch 15/50
331/331 - 10s - loss: 3.2158 - accuracy200: 0.4144 - val_loss: 3.3282 - val_accuracy200: 0.3536 - 10s/epoch - 31ms/step
Epoch 16/50
331/331 - 10s - loss: 3.2098 - accuracy200: 0.4164 - val_loss: 3.3364 - val_accuracy200: 0.3501 - 10s/epoch - 31ms/step
Epoch 17/50
331/331 - 10s - loss: 3.2000 - accuracy200: 0.4228 - val_loss: 3.3427 - val_accuracy200: 0.3514 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/h200
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1013317
{'0': {'precision': 0.34388416578108394, 'recall': 0.3911553524804178, 'f1-score': 0.36599972854977714, 'support': 165456}, '1': {'precision': 0.38325669214605473, 'recall': 0.323666627231718, 'f1-score': 0.35095008895755136, 'support': 194413}, '2': {'precision': 0.3166853868470211, 'recall': 0.33159122783846845, 'f1-score': 0.3239669421487604, 'support': 159003}, 'accuracy': 0.34761559691022065, 'macro avg': {'precision': 0.34794208159138656, 'recall': 0.3488044025168681, 'f1-score': 0.3469722532186963, 'support': 518872}, 'weighted avg': {'precision': 0.3503016319795688, 'recall': 0.34761559691022065, 'f1-score': 0.34748035437239955, 'support': 518872}}
[[64719 51258 49479]
 [67204 62925 64284]
 [56277 50002 52724]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0857521
{'0': {'precision': 0.39789372577270077, 'recall': 0.4169152798245929, 'f1-score': 0.4071824756020502, 'support': 27821}, '1': {'precision': 0.36907639346663734, 'recall': 0.36150369466963195, 'f1-score': 0.3652507973325601, 'support': 27878}, '2': {'precision': 0.40102681118083283, 'recall': 0.39047420676248, 'f1-score': 0.3956801632251029, 'support': 28806}, 'accuracy': 0.3896219158629667, 'macro avg': {'precision': 0.389332310140057, 'recall': 0.38963106041890166, 'f1-score': 0.3893711453865711, 'support': 84505}, 'weighted avg': {'precision': 0.38945495964333815, 'recall': 0.3896219158629667, 'f1-score': 0.3894284144562341, 'support': 84505}}
[[11599  8336  7886]
 [ 8886 10078  8914]
 [ 8666  8892 11248]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1005828
{'0': {'precision': 0.38227594702802586, 'recall': 0.4122042341220423, 'f1-score': 0.39667638716893705, 'support': 12045}, '1': {'precision': 0.313811266851174, 'recall': 0.32357543956549756, 'f1-score': 0.3186185641769398, 'support': 10863}, '2': {'precision': 0.3693419551160137, 'recall': 0.3292362465033483, 'f1-score': 0.34813785685474835, 'support': 11797}, 'accuracy': 0.35625990491283677, 'macro avg': {'precision': 0.35514305633173787, 'recall': 0.35500530673029607, 'f1-score': 0.35447760273354173, 'support': 34705}, 'weighted avg': {'precision': 0.356449290253868, 'recall': 0.35625990491283677, 'f1-score': 0.35574421101914444, 'support': 34705}}
[[4965 3839 3241]
 [3957 3515 3391]
 [4066 3847 3884]]
training model: results/CHTR/W5/deepOF_L2/h300
Epoch 1/50
331/331 - 12s - loss: 3.3448 - accuracy300: 0.3376 - val_loss: 3.3308 - val_accuracy300: 0.3377 - 12s/epoch - 36ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3178 - accuracy300: 0.3427 - val_loss: 3.3182 - val_accuracy300: 0.3397 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3058 - accuracy300: 0.3500 - val_loss: 3.3175 - val_accuracy300: 0.3384 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2937 - accuracy300: 0.3570 - val_loss: 3.3132 - val_accuracy300: 0.3404 - 10s/epoch - 30ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2869 - accuracy300: 0.3629 - val_loss: 3.3131 - val_accuracy300: 0.3426 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2815 - accuracy300: 0.3690 - val_loss: 3.3132 - val_accuracy300: 0.3413 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2759 - accuracy300: 0.3710 - val_loss: 3.3104 - val_accuracy300: 0.3437 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2710 - accuracy300: 0.3751 - val_loss: 3.3121 - val_accuracy300: 0.3426 - 10s/epoch - 30ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2644 - accuracy300: 0.3809 - val_loss: 3.3165 - val_accuracy300: 0.3439 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2582 - accuracy300: 0.3885 - val_loss: 3.3175 - val_accuracy300: 0.3440 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.2531 - accuracy300: 0.3905 - val_loss: 3.3176 - val_accuracy300: 0.3425 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2448 - accuracy300: 0.3963 - val_loss: 3.3218 - val_accuracy300: 0.3475 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2401 - accuracy300: 0.3999 - val_loss: 3.3278 - val_accuracy300: 0.3425 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 3.2335 - accuracy300: 0.4036 - val_loss: 3.3320 - val_accuracy300: 0.3436 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 3.2259 - accuracy300: 0.4077 - val_loss: 3.3368 - val_accuracy300: 0.3447 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.2186 - accuracy300: 0.4128 - val_loss: 3.3454 - val_accuracy300: 0.3426 - 10s/epoch - 30ms/step
Epoch 17/50
331/331 - 10s - loss: 3.2110 - accuracy300: 0.4152 - val_loss: 3.3562 - val_accuracy300: 0.3398 - 10s/epoch - 30ms/step
testing model: results/CHTR/W5/deepOF_L2/h300
Evaluating performance on  test set...
2027/2027 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1016216
{'0': {'precision': 0.32600745885240057, 'recall': 0.3363705533103827, 'f1-score': 0.33110793928511134, 'support': 160344}, '1': {'precision': 0.41084868329169316, 'recall': 0.26116914760340526, 'f1-score': 0.3193397421206895, 'support': 202746}, '2': {'precision': 0.30688624754507926, 'recall': 0.4423553427225225, 'f1-score': 0.3623738270085794, 'support': 155782}, 'accuracy': 0.3388061024684315, 'macro avg': {'precision': 0.34791412989639103, 'recall': 0.3466316812121035, 'f1-score': 0.33760716947146013, 'support': 518872}, 'weighted avg': {'precision': 0.35341783819507405, 'recall': 0.3388061024684315, 'f1-score': 0.33589661090169387, 'support': 518872}}
[[53935 38554 67855]
 [62012 52951 87783]
 [49494 37377 68911]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0874004
{'0': {'precision': 0.39176041958601915, 'recall': 0.35397749882429547, 'f1-score': 0.3719118206005322, 'support': 27643}, '1': {'precision': 0.37864771863967467, 'recall': 0.30308341679782513, 'f1-score': 0.33667772634255855, 'support': 27956}, '2': {'precision': 0.38036661193507576, 'recall': 0.48886044419843633, 'f1-score': 0.42784262076691343, 'support': 28906}, 'accuracy': 0.3832790959114845, 'macro avg': {'precision': 0.3835915833869232, 'recall': 0.3819737866068523, 'f1-score': 0.3788107225700014, 'support': 84505}, 'weighted avg': {'precision': 0.3835250717176779, 'recall': 0.3832790959114845, 'f1-score': 0.3793874891471685, 'support': 84505}}
[[ 9785  6768 11090]
 [ 7553  8473 11930]
 [ 7639  7136 14131]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.103073
{'0': {'precision': 0.364889466840052, 'recall': 0.35393541876892026, 'f1-score': 0.3593289793827635, 'support': 11892}, '1': {'precision': 0.32410128871806465, 'recall': 0.25838139870223503, 'f1-score': 0.287533848159663, 'support': 11096}, '2': {'precision': 0.34480592013404077, 'recall': 0.4215242809592899, 'f1-score': 0.37932491071771435, 'support': 11717}, 'accuracy': 0.34620371704365366, 'macro avg': {'precision': 0.34459889189738585, 'recall': 0.344613699476815, 'f1-score': 0.3420625794200469, 'support': 34705}, 'weighted avg': {'precision': 0.3450679845984181, 'recall': 0.34620371704365366, 'f1-score': 0.3431253646701888, 'support': 34705}}
[[4209 2963 4720]
 [3564 2867 4665]
 [3762 3016 4939]]
training model: results/CHTR/W5/deepOF_L2/h500
Epoch 1/50
331/331 - 12s - loss: 3.3479 - accuracy500: 0.3348 - val_loss: 3.3304 - val_accuracy500: 0.3383 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3215 - accuracy500: 0.3403 - val_loss: 3.3219 - val_accuracy500: 0.3376 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3103 - accuracy500: 0.3454 - val_loss: 3.3182 - val_accuracy500: 0.3348 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 3.3008 - accuracy500: 0.3514 - val_loss: 3.3119 - val_accuracy500: 0.3396 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2941 - accuracy500: 0.3540 - val_loss: 3.3114 - val_accuracy500: 0.3409 - 10s/epoch - 31ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2874 - accuracy500: 0.3611 - val_loss: 3.3117 - val_accuracy500: 0.3400 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2809 - accuracy500: 0.3659 - val_loss: 3.3100 - val_accuracy500: 0.3409 - 10s/epoch - 31ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2776 - accuracy500: 0.3692 - val_loss: 3.3117 - val_accuracy500: 0.3412 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2717 - accuracy500: 0.3733 - val_loss: 3.3170 - val_accuracy500: 0.3389 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2658 - accuracy500: 0.3783 - val_loss: 3.3177 - val_accuracy500: 0.3407 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.2599 - accuracy500: 0.3843 - val_loss: 3.3203 - val_accuracy500: 0.3415 - 10s/epoch - 31ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2540 - accuracy500: 0.3898 - val_loss: 3.3223 - val_accuracy500: 0.3410 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2464 - accuracy500: 0.3932 - val_loss: 3.3293 - val_accuracy500: 0.3386 - 10s/epoch - 30ms/step
Epoch 14/50
331/331 - 10s - loss: 3.2419 - accuracy500: 0.3976 - val_loss: 3.3311 - val_accuracy500: 0.3394 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 3.2359 - accuracy500: 0.4014 - val_loss: 3.3360 - val_accuracy500: 0.3415 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 10s - loss: 3.2262 - accuracy500: 0.4067 - val_loss: 3.3450 - val_accuracy500: 0.3390 - 10s/epoch - 30ms/step
Epoch 17/50
331/331 - 10s - loss: 3.2200 - accuracy500: 0.4081 - val_loss: 3.3569 - val_accuracy500: 0.3358 - 10s/epoch - 30ms/step
testing model: results/CHTR/W5/deepOF_L2/h500
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1034033
{'0': {'precision': 0.31214157515142044, 'recall': 0.421186483999591, 'f1-score': 0.3585566129852609, 'support': 156496}, '1': {'precision': 0.41107604968156536, 'recall': 0.2748202270461365, 'f1-score': 0.3294142777554867, 'support': 207623}, '2': {'precision': 0.2972273698793968, 'recall': 0.32440081937022225, 'f1-score': 0.3102201733950453, 'support': 154753}, 'accuracy': 0.3337528330686566, 'macro avg': {'precision': 0.3401483315707942, 'recall': 0.3401358434719833, 'f1-score': 0.33273035471193096, 'support': 518872}, 'weighted avg': {'precision': 0.34728136761836953, 'recall': 0.3337528330686566, 'f1-score': 0.3324792218303787, 'support': 518872}}
[[65914 40821 49761]
 [81626 57059 68938]
 [63627 40924 50202]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0894899
{'0': {'precision': 0.36815302842229225, 'recall': 0.4259620696004419, 'f1-score': 0.3949533922900946, 'support': 27155}, '1': {'precision': 0.37210051546391754, 'recall': 0.3321948588890886, 'f1-score': 0.3510171519744715, 'support': 27815}, '2': {'precision': 0.39290012033694344, 'recall': 0.37585915016082616, 'f1-score': 0.38419076294796584, 'support': 29535}, 'accuracy': 0.37758712502218805, 'macro avg': {'precision': 0.3777178880743844, 'recall': 0.37800535955011894, 'f1-score': 0.3767204357375107, 'support': 84505}, 'weighted avg': {'precision': 0.37810160793548114, 'recall': 0.37758712502218805, 'f1-score': 0.3767300826397919, 'support': 84505}}
[[11567  7328  8260]
 [ 9682  9240  8893]
 [10170  8264 11101]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1028776
{'0': {'precision': 0.34972521590179145, 'recall': 0.41028217365820985, 'f1-score': 0.37759112275564466, 'support': 11943}, '1': {'precision': 0.3190980881130507, 'recall': 0.2824947106981878, 'f1-score': 0.2996828494754818, 'support': 10871}, '2': {'precision': 0.34200542005420054, 'recall': 0.3183920612227735, 'f1-score': 0.32977657767518836, 'support': 11891}, 'accuracy': 0.3387696297363492, 'macro avg': {'precision': 0.3369429080230142, 'recall': 0.33705631519305707, 'f1-score': 0.33568351663543833, 'support': 34705}, 'weighted avg': {'precision': 0.3374865298734064, 'recall': 0.3387696297363492, 'f1-score': 0.3368043890175563, 'support': 34705}}
[[4900 3263 3780]
 [4296 3071 3504]
 [4815 3290 3786]]
training model: results/CHTR/W5/deepOF_L2/h1000
Epoch 1/50
331/331 - 12s - loss: 3.3538 - accuracy1000: 0.3348 - val_loss: 3.3335 - val_accuracy1000: 0.3401 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3271 - accuracy1000: 0.3403 - val_loss: 3.3242 - val_accuracy1000: 0.3355 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3112 - accuracy1000: 0.3468 - val_loss: 3.3162 - val_accuracy1000: 0.3372 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 3.3012 - accuracy1000: 0.3537 - val_loss: 3.3155 - val_accuracy1000: 0.3357 - 10s/epoch - 31ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2969 - accuracy1000: 0.3548 - val_loss: 3.3150 - val_accuracy1000: 0.3393 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2898 - accuracy1000: 0.3626 - val_loss: 3.3170 - val_accuracy1000: 0.3368 - 10s/epoch - 30ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2840 - accuracy1000: 0.3642 - val_loss: 3.3181 - val_accuracy1000: 0.3370 - 10s/epoch - 30ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2787 - accuracy1000: 0.3689 - val_loss: 3.3202 - val_accuracy1000: 0.3311 - 10s/epoch - 31ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2730 - accuracy1000: 0.3734 - val_loss: 3.3202 - val_accuracy1000: 0.3364 - 10s/epoch - 30ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2686 - accuracy1000: 0.3771 - val_loss: 3.3219 - val_accuracy1000: 0.3336 - 10s/epoch - 30ms/step
Epoch 11/50
331/331 - 10s - loss: 3.2646 - accuracy1000: 0.3791 - val_loss: 3.3256 - val_accuracy1000: 0.3347 - 10s/epoch - 30ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2592 - accuracy1000: 0.3834 - val_loss: 3.3287 - val_accuracy1000: 0.3336 - 10s/epoch - 30ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2512 - accuracy1000: 0.3900 - val_loss: 3.3302 - val_accuracy1000: 0.3370 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 3.2473 - accuracy1000: 0.3938 - val_loss: 3.3339 - val_accuracy1000: 0.3340 - 10s/epoch - 30ms/step
Epoch 15/50
331/331 - 10s - loss: 3.2429 - accuracy1000: 0.3950 - val_loss: 3.3391 - val_accuracy1000: 0.3358 - 10s/epoch - 31ms/step
testing model: results/CHTR/W5/deepOF_L2/h1000
Evaluating performance on  test set...
2027/2027 - 25s - 25s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1087617
{'0': {'precision': 0.3009068010075567, 'recall': 0.2705250558053767, 'f1-score': 0.2849082639137323, 'support': 154555}, '1': {'precision': 0.4143857731856341, 'recall': 0.15880600424523364, 'f1-score': 0.22961581602108436, 'support': 210118}, '2': {'precision': 0.2970093320596664, 'recall': 0.5766833766755946, 'f1-score': 0.39208372189410423, 'support': 154199}, 'accuracy': 0.3162687522163462, 'macro avg': {'precision': 0.3374339687509524, 'recall': 0.33533814557540165, 'f1-score': 0.30220260060964027, 'support': 518872}, 'weighted avg': {'precision': 0.34570202769509717, 'recall': 0.3162687522163462, 'f1-score': 0.29436803410523993, 'support': 518872}}
[[ 41811  23597  89147]
 [ 55423  33368 121327]
 [ 41716  23559  88924]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0933486
{'0': {'precision': 0.36769054659925593, 'recall': 0.28294061513616675, 'f1-score': 0.31979590143532727, 'support': 27246}, '1': {'precision': 0.3758765778401122, 'recall': 0.1821238241711077, 'f1-score': 0.24536211632053198, 'support': 27959}, '2': {'precision': 0.36483837413986236, 'recall': 0.6224914675767919, 'f1-score': 0.4600464107350048, 'support': 29300}, 'accuracy': 0.36731554345896694, 'macro avg': {'precision': 0.36946849952641014, 'recall': 0.3625186356280221, 'f1-score': 0.34173480949695473, 'support': 84505}, 'weighted avg': {'precision': 0.3694100258537718, 'recall': 0.36731554345896694, 'f1-score': 0.34379738921067776, 'support': 84505}}
[[ 7709  4095 15442]
 [ 6556  5092 16311]
 [ 6701  4360 18239]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1036407
{'0': {'precision': 0.3496690155882981, 'recall': 0.27212297465724966, 'f1-score': 0.3060604644642773, 'support': 12035}, '1': {'precision': 0.3095106186518929, 'recall': 0.15544425895010203, 'f1-score': 0.206951904673705, 'support': 10782}, '2': {'precision': 0.33883758281469584, 'recall': 0.5678835800807537, 'f1-score': 0.42443103231484974, 'support': 11888}, 'accuracy': 0.3371848436824665, 'macro avg': {'precision': 0.3326724056849623, 'recall': 0.3318169378960351, 'f1-score': 0.3124811338176107, 'support': 34705}, 'weighted avg': {'precision': 0.33348253212537043, 'recall': 0.3371848436824665, 'f1-score': 0.31581700729515627, 'support': 34705}}
[[3275 1851 6909]
 [2842 1676 6264]
 [3249 1888 6751]]
training model: results/CHTR/W5/deepVOL_L2/h10
Epoch 1/50
331/331 - 12s - loss: 3.3240 - accuracy10: 0.3595 - val_loss: 3.3196 - val_accuracy10: 0.3541 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2916 - accuracy10: 0.3710 - val_loss: 3.3146 - val_accuracy10: 0.3565 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 9s - loss: 3.2753 - accuracy10: 0.3806 - val_loss: 3.3004 - val_accuracy10: 0.3657 - 9s/epoch - 29ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2612 - accuracy10: 0.3871 - val_loss: 3.2920 - val_accuracy10: 0.3705 - 10s/epoch - 29ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2494 - accuracy10: 0.3942 - val_loss: 3.2860 - val_accuracy10: 0.3720 - 10s/epoch - 30ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2405 - accuracy10: 0.3988 - val_loss: 3.2773 - val_accuracy10: 0.3738 - 10s/epoch - 29ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2307 - accuracy10: 0.4060 - val_loss: 3.2651 - val_accuracy10: 0.3769 - 9s/epoch - 28ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2290 - accuracy10: 0.4075 - val_loss: 3.2695 - val_accuracy10: 0.3769 - 9s/epoch - 28ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2181 - accuracy10: 0.4127 - val_loss: 3.2653 - val_accuracy10: 0.3783 - 9s/epoch - 28ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2106 - accuracy10: 0.4155 - val_loss: 3.2660 - val_accuracy10: 0.3767 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2062 - accuracy10: 0.4180 - val_loss: 3.2541 - val_accuracy10: 0.3853 - 9s/epoch - 29ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2003 - accuracy10: 0.4223 - val_loss: 3.2528 - val_accuracy10: 0.3817 - 9s/epoch - 28ms/step
Epoch 13/50
331/331 - 9s - loss: 3.1964 - accuracy10: 0.4244 - val_loss: 3.2600 - val_accuracy10: 0.3815 - 9s/epoch - 28ms/step
Epoch 14/50
331/331 - 9s - loss: 3.1892 - accuracy10: 0.4281 - val_loss: 3.2531 - val_accuracy10: 0.3853 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.1859 - accuracy10: 0.4298 - val_loss: 3.2564 - val_accuracy10: 0.3848 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.1829 - accuracy10: 0.4301 - val_loss: 3.2583 - val_accuracy10: 0.3844 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.1785 - accuracy10: 0.4322 - val_loss: 3.2469 - val_accuracy10: 0.3859 - 9s/epoch - 29ms/step
Epoch 18/50
331/331 - 10s - loss: 3.1750 - accuracy10: 0.4343 - val_loss: 3.2533 - val_accuracy10: 0.3874 - 10s/epoch - 29ms/step
Epoch 19/50
331/331 - 9s - loss: 3.1676 - accuracy10: 0.4365 - val_loss: 3.2521 - val_accuracy10: 0.3850 - 9s/epoch - 28ms/step
Epoch 20/50
331/331 - 9s - loss: 3.1658 - accuracy10: 0.4371 - val_loss: 3.2557 - val_accuracy10: 0.3834 - 9s/epoch - 28ms/step
Epoch 21/50
331/331 - 9s - loss: 3.1622 - accuracy10: 0.4388 - val_loss: 3.2463 - val_accuracy10: 0.3879 - 9s/epoch - 28ms/step
Epoch 22/50
331/331 - 9s - loss: 3.1609 - accuracy10: 0.4409 - val_loss: 3.2573 - val_accuracy10: 0.3833 - 9s/epoch - 28ms/step
Epoch 23/50
331/331 - 9s - loss: 3.1572 - accuracy10: 0.4423 - val_loss: 3.2561 - val_accuracy10: 0.3884 - 9s/epoch - 28ms/step
Epoch 24/50
331/331 - 10s - loss: 3.1549 - accuracy10: 0.4404 - val_loss: 3.2531 - val_accuracy10: 0.3868 - 10s/epoch - 29ms/step
Epoch 25/50
331/331 - 9s - loss: 3.1467 - accuracy10: 0.4444 - val_loss: 3.2526 - val_accuracy10: 0.3891 - 9s/epoch - 28ms/step
Epoch 26/50
331/331 - 9s - loss: 3.1431 - accuracy10: 0.4474 - val_loss: 3.2568 - val_accuracy10: 0.3903 - 9s/epoch - 28ms/step
Epoch 27/50
331/331 - 10s - loss: 3.1389 - accuracy10: 0.4473 - val_loss: 3.2528 - val_accuracy10: 0.3880 - 10s/epoch - 29ms/step
Epoch 28/50
331/331 - 9s - loss: 3.1355 - accuracy10: 0.4489 - val_loss: 3.2572 - val_accuracy10: 0.3867 - 9s/epoch - 29ms/step
Epoch 29/50
331/331 - 9s - loss: 3.1334 - accuracy10: 0.4483 - val_loss: 3.2587 - val_accuracy10: 0.3859 - 9s/epoch - 28ms/step
Epoch 30/50
331/331 - 9s - loss: 3.1289 - accuracy10: 0.4496 - val_loss: 3.2553 - val_accuracy10: 0.3861 - 9s/epoch - 28ms/step
Epoch 31/50
331/331 - 9s - loss: 3.1281 - accuracy10: 0.4513 - val_loss: 3.2607 - val_accuracy10: 0.3898 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h10
Evaluating performance on  test set...
2027/2027 - 27s - 27s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0844048
{'0': {'precision': 0.4489027992685328, 'recall': 0.1362399274240888, 'f1-score': 0.20903783642154733, 'support': 187390}, '1': {'precision': 0.3467069554026076, 'recall': 0.6715120807960387, 'f1-score': 0.45730417674776913, 'support': 147631}, '2': {'precision': 0.41683658111308636, 'recall': 0.39918196849708465, 'f1-score': 0.40781829547822457, 'support': 183856}, 'accuracy': 0.38170510544888286, 'macro avg': {'precision': 0.40414877859474224, 'recall': 0.40231132557240407, 'f1-score': 0.358053436215847, 'support': 518877}, 'weighted avg': {'precision': 0.40846384893741744, 'recall': 0.38170510544888286, 'f1-score': 0.3501093970592802, 'support': 518877}}
[[25530 96240 65620]
 [11438 99136 37057]
 [19904 90560 73392]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0562793
{'0': {'precision': 0.49682957760218516, 'recall': 0.18158157444381062, 'f1-score': 0.2659599467349017, 'support': 28048}, '1': {'precision': 0.42409998217786493, 'recall': 0.6719020223767338, 'f1-score': 0.5199874352986165, 'support': 28333}, '2': {'precision': 0.42728727569886615, 'recall': 0.44615494009314893, 'f1-score': 0.4365173229442048, 'support': 28127}, 'accuracy': 0.4340299143276376, 'macro avg': {'precision': 0.4494056118263054, 'recall': 0.4332128456378978, 'f1-score': 0.4074882349925743, 'support': 84508}, 'weighted avg': {'precision': 0.4492995928339748, 'recall': 0.4340299143276376, 'f1-score': 0.40789477129724844, 'support': 84508}}
[[ 5093 13274  9681]
 [ 2157 19037  7139]
 [ 3001 12577 12549]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.082286
{'0': {'precision': 0.44387298747763865, 'recall': 0.16164495114006514, 'f1-score': 0.23698662846227314, 'support': 12280}, '1': {'precision': 0.3644424739525604, 'recall': 0.6214326214326215, 'f1-score': 0.45944246489205626, 'support': 10582}, '2': {'precision': 0.4024940520141111, 'recall': 0.4142531453179093, 'f1-score': 0.408288948069241, 'support': 11843}, 'accuracy': 0.3880420688661576, 'macro avg': {'precision': 0.4036031711481034, 'recall': 0.3991102392968653, 'f1-score': 0.36823934714119017, 'support': 34705}, 'weighted avg': {'precision': 0.40553313942067465, 'recall': 0.3880420688661576, 'f1-score': 0.3632727841229931, 'support': 34705}}
[[1985 6009 4286]
 [1009 6576 2997]
 [1478 5459 4906]]
training model: results/CHTR/W5/deepVOL_L2/h20
Epoch 1/50
331/331 - 12s - loss: 3.3270 - accuracy20: 0.3571 - val_loss: 3.3397 - val_accuracy20: 0.3479 - 12s/epoch - 35ms/step
Epoch 2/50
331/331 - 10s - loss: 3.2954 - accuracy20: 0.3687 - val_loss: 3.3232 - val_accuracy20: 0.3511 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 9s - loss: 3.2801 - accuracy20: 0.3756 - val_loss: 3.3138 - val_accuracy20: 0.3519 - 9s/epoch - 28ms/step
Epoch 4/50
331/331 - 9s - loss: 3.2679 - accuracy20: 0.3836 - val_loss: 3.3055 - val_accuracy20: 0.3542 - 9s/epoch - 28ms/step
Epoch 5/50
331/331 - 9s - loss: 3.2607 - accuracy20: 0.3869 - val_loss: 3.3058 - val_accuracy20: 0.3595 - 9s/epoch - 29ms/step
Epoch 6/50
331/331 - 9s - loss: 3.2554 - accuracy20: 0.3909 - val_loss: 3.2997 - val_accuracy20: 0.3608 - 9s/epoch - 28ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2487 - accuracy20: 0.3954 - val_loss: 3.2919 - val_accuracy20: 0.3632 - 9s/epoch - 28ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2432 - accuracy20: 0.3968 - val_loss: 3.2880 - val_accuracy20: 0.3673 - 9s/epoch - 29ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2357 - accuracy20: 0.4051 - val_loss: 3.2888 - val_accuracy20: 0.3665 - 9s/epoch - 29ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2318 - accuracy20: 0.4064 - val_loss: 3.2829 - val_accuracy20: 0.3701 - 9s/epoch - 29ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2253 - accuracy20: 0.4094 - val_loss: 3.2859 - val_accuracy20: 0.3680 - 9s/epoch - 28ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2230 - accuracy20: 0.4091 - val_loss: 3.2818 - val_accuracy20: 0.3734 - 10s/epoch - 29ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2191 - accuracy20: 0.4124 - val_loss: 3.2783 - val_accuracy20: 0.3729 - 10s/epoch - 29ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2131 - accuracy20: 0.4144 - val_loss: 3.2809 - val_accuracy20: 0.3724 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2101 - accuracy20: 0.4155 - val_loss: 3.2797 - val_accuracy20: 0.3729 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2052 - accuracy20: 0.4186 - val_loss: 3.2789 - val_accuracy20: 0.3744 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.1993 - accuracy20: 0.4225 - val_loss: 3.2805 - val_accuracy20: 0.3748 - 9s/epoch - 28ms/step
Epoch 18/50
331/331 - 9s - loss: 3.1963 - accuracy20: 0.4244 - val_loss: 3.2770 - val_accuracy20: 0.3758 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 9s - loss: 3.1925 - accuracy20: 0.4252 - val_loss: 3.2864 - val_accuracy20: 0.3750 - 9s/epoch - 28ms/step
Epoch 20/50
331/331 - 9s - loss: 3.1880 - accuracy20: 0.4264 - val_loss: 3.2873 - val_accuracy20: 0.3727 - 9s/epoch - 28ms/step
Epoch 21/50
331/331 - 10s - loss: 3.1855 - accuracy20: 0.4299 - val_loss: 3.2777 - val_accuracy20: 0.3769 - 10s/epoch - 29ms/step
Epoch 22/50
331/331 - 9s - loss: 3.1819 - accuracy20: 0.4297 - val_loss: 3.2814 - val_accuracy20: 0.3747 - 9s/epoch - 28ms/step
Epoch 23/50
331/331 - 10s - loss: 3.1793 - accuracy20: 0.4301 - val_loss: 3.2764 - val_accuracy20: 0.3767 - 10s/epoch - 29ms/step
Epoch 24/50
331/331 - 9s - loss: 3.1751 - accuracy20: 0.4321 - val_loss: 3.2737 - val_accuracy20: 0.3783 - 9s/epoch - 29ms/step
Epoch 25/50
331/331 - 10s - loss: 3.1731 - accuracy20: 0.4344 - val_loss: 3.2872 - val_accuracy20: 0.3760 - 10s/epoch - 29ms/step
Epoch 26/50
331/331 - 9s - loss: 3.1667 - accuracy20: 0.4365 - val_loss: 3.2861 - val_accuracy20: 0.3745 - 9s/epoch - 28ms/step
Epoch 27/50
331/331 - 9s - loss: 3.1642 - accuracy20: 0.4374 - val_loss: 3.2792 - val_accuracy20: 0.3792 - 9s/epoch - 28ms/step
Epoch 28/50
331/331 - 9s - loss: 3.1598 - accuracy20: 0.4396 - val_loss: 3.2804 - val_accuracy20: 0.3795 - 9s/epoch - 29ms/step
Epoch 29/50
331/331 - 9s - loss: 3.1584 - accuracy20: 0.4393 - val_loss: 3.2809 - val_accuracy20: 0.3794 - 9s/epoch - 28ms/step
Epoch 30/50
331/331 - 9s - loss: 3.1533 - accuracy20: 0.4412 - val_loss: 3.2849 - val_accuracy20: 0.3766 - 9s/epoch - 28ms/step
Epoch 31/50
331/331 - 9s - loss: 3.1494 - accuracy20: 0.4435 - val_loss: 3.2882 - val_accuracy20: 0.3745 - 9s/epoch - 28ms/step
Epoch 32/50
331/331 - 9s - loss: 3.1462 - accuracy20: 0.4426 - val_loss: 3.2899 - val_accuracy20: 0.3786 - 9s/epoch - 28ms/step
Epoch 33/50
331/331 - 9s - loss: 3.1434 - accuracy20: 0.4429 - val_loss: 3.2941 - val_accuracy20: 0.3762 - 9s/epoch - 28ms/step
Epoch 34/50
331/331 - 9s - loss: 3.1398 - accuracy20: 0.4453 - val_loss: 3.2897 - val_accuracy20: 0.3779 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h20
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0972418
{'0': {'precision': 0.4398519233864478, 'recall': 0.14449626175142496, 'f1-score': 0.21753112363485844, 'support': 189126}, '1': {'precision': 0.33327275844333965, 'recall': 0.6530435366836872, 'f1-score': 0.44132216395377877, 'support': 148840}, '2': {'precision': 0.40353852583632654, 'recall': 0.3682639529934609, 'f1-score': 0.3850951423088483, 'support': 180911}, 'accuracy': 0.3683917383117772, 'macro avg': {'precision': 0.39222106922203803, 'recall': 0.38860125047619104, 'f1-score': 0.3479828099658285, 'support': 518877}, 'weighted avg': {'precision': 0.3966186793337682, 'recall': 0.3683917383117772, 'f1-score': 0.34014830000497753, 'support': 518877}}
[[ 27328 100887  60911]
 [ 14078  97199  37563]
 [ 20724  93564  66623]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0655069
{'0': {'precision': 0.4859733150872391, 'recall': 0.2001690974424012, 'f1-score': 0.2835470831877839, 'support': 28386}, '1': {'precision': 0.4050084436938939, 'recall': 0.6561195104391648, 'f1-score': 0.5008518355682567, 'support': 27780}, '2': {'precision': 0.42283906227527684, 'recall': 0.4149319031825559, 'f1-score': 0.418848167539267, 'support': 28342}, 'accuracy': 0.4220783831116581, 'macro avg': {'precision': 0.43794027368547, 'recall': 0.4237401703547073, 'f1-score': 0.40108236209843584, 'support': 84508}, 'weighted avg': {'precision': 0.43818428777025414, 'recall': 0.4220783831116581, 'f1-score': 0.40035767335462336, 'support': 84508}}
[[ 5682 13578  9126]
 [ 2627 18227  6926]
 [ 3383 13199 11760]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0922271
{'0': {'precision': 0.43953858392999207, 'recall': 0.17753856041131105, 'f1-score': 0.2529182879377432, 'support': 12448}, '1': {'precision': 0.34657519088192984, 'recall': 0.6040501446480231, 'f1-score': 0.44044438194346786, 'support': 10370}, '2': {'precision': 0.4034301473756787, 'recall': 0.39379153697316394, 'f1-score': 0.39855257556406987, 'support': 11887}, 'accuracy': 0.37905200979685927, 'macro avg': {'precision': 0.3965146407292002, 'recall': 0.39179341401083273, 'f1-score': 0.3639717484817602, 'support': 34705}, 'weighted avg': {'precision': 0.3993930322449459, 'recall': 0.37905200979685927, 'f1-score': 0.35883387277720463, 'support': 34705}}
[[2210 6188 4050]
 [1234 6264 2872]
 [1584 5622 4681]]
training model: results/CHTR/W5/deepVOL_L2/h30
Epoch 1/50
331/331 - 12s - loss: 3.3359 - accuracy30: 0.3515 - val_loss: 3.3325 - val_accuracy30: 0.3438 - 12s/epoch - 36ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3033 - accuracy30: 0.3617 - val_loss: 3.3159 - val_accuracy30: 0.3423 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 9s - loss: 3.2915 - accuracy30: 0.3677 - val_loss: 3.3102 - val_accuracy30: 0.3502 - 9s/epoch - 28ms/step
Epoch 4/50
331/331 - 9s - loss: 3.2836 - accuracy30: 0.3724 - val_loss: 3.3004 - val_accuracy30: 0.3558 - 9s/epoch - 29ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2739 - accuracy30: 0.3807 - val_loss: 3.2986 - val_accuracy30: 0.3588 - 10s/epoch - 29ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2650 - accuracy30: 0.3845 - val_loss: 3.2939 - val_accuracy30: 0.3588 - 10s/epoch - 29ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2563 - accuracy30: 0.3906 - val_loss: 3.2878 - val_accuracy30: 0.3639 - 9s/epoch - 29ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2535 - accuracy30: 0.3928 - val_loss: 3.2841 - val_accuracy30: 0.3671 - 9s/epoch - 29ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2471 - accuracy30: 0.3988 - val_loss: 3.2838 - val_accuracy30: 0.3647 - 9s/epoch - 29ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2434 - accuracy30: 0.4008 - val_loss: 3.2774 - val_accuracy30: 0.3653 - 10s/epoch - 29ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2381 - accuracy30: 0.4048 - val_loss: 3.2861 - val_accuracy30: 0.3677 - 9s/epoch - 29ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2337 - accuracy30: 0.4083 - val_loss: 3.2770 - val_accuracy30: 0.3706 - 9s/epoch - 29ms/step
Epoch 13/50
331/331 - 9s - loss: 3.2285 - accuracy30: 0.4098 - val_loss: 3.2839 - val_accuracy30: 0.3664 - 9s/epoch - 28ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2250 - accuracy30: 0.4115 - val_loss: 3.2865 - val_accuracy30: 0.3676 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2215 - accuracy30: 0.4131 - val_loss: 3.2835 - val_accuracy30: 0.3699 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2145 - accuracy30: 0.4164 - val_loss: 3.2848 - val_accuracy30: 0.3677 - 9s/epoch - 29ms/step
Epoch 17/50
331/331 - 9s - loss: 3.2136 - accuracy30: 0.4171 - val_loss: 3.2859 - val_accuracy30: 0.3688 - 9s/epoch - 28ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2104 - accuracy30: 0.4163 - val_loss: 3.2841 - val_accuracy30: 0.3711 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 9s - loss: 3.2056 - accuracy30: 0.4197 - val_loss: 3.2884 - val_accuracy30: 0.3686 - 9s/epoch - 28ms/step
Epoch 20/50
331/331 - 9s - loss: 3.2040 - accuracy30: 0.4219 - val_loss: 3.2873 - val_accuracy30: 0.3708 - 9s/epoch - 28ms/step
Epoch 21/50
331/331 - 10s - loss: 3.1986 - accuracy30: 0.4256 - val_loss: 3.2858 - val_accuracy30: 0.3715 - 10s/epoch - 29ms/step
Epoch 22/50
331/331 - 9s - loss: 3.1987 - accuracy30: 0.4252 - val_loss: 3.2785 - val_accuracy30: 0.3745 - 9s/epoch - 29ms/step
testing model: results/CHTR/W5/deepVOL_L2/h30
Evaluating performance on  test set...
2027/2027 - 39s - 39s/epoch - 19ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0977136
{'0': {'precision': 0.4205533596837945, 'recall': 0.17393780552757723, 'f1-score': 0.24609323997149904, 'support': 189631}, '1': {'precision': 0.3284465380631072, 'recall': 0.6225885630887621, 'f1-score': 0.43003051714183593, 'support': 150740}, '2': {'precision': 0.38712179483036113, 'recall': 0.3355181338442405, 'f1-score': 0.3594774576327138, 'support': 178506}, 'accuracy': 0.3598637056566392, 'macro avg': {'precision': 0.3787072308590876, 'recall': 0.37734816748685995, 'f1-score': 0.3452004049153496, 'support': 518877}, 'weighted avg': {'precision': 0.3822939702584984, 'recall': 0.3598637056566392, 'f1-score': 0.33853608927584167, 'support': 518877}}
[[ 32984 100284  56363]
 [ 18435  93849  38456]
 [ 27011  91603  59892]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0791959
{'0': {'precision': 0.4367895758247851, 'recall': 0.22282723994059825, 'f1-score': 0.2951065324280028, 'support': 28282}, '1': {'precision': 0.3944165422379078, 'recall': 0.6229543343100121, 'f1-score': 0.4830165678506123, 'support': 27986}, '2': {'precision': 0.4096143442306206, 'recall': 0.37535410764872523, 'f1-score': 0.39173657563102854, 'support': 28240}, 'accuracy': 0.4063047285464098, 'macro avg': {'precision': 0.41360682076443783, 'recall': 0.4070452272997785, 'f1-score': 0.3899532253032145, 'support': 84508}, 'weighted avg': {'precision': 0.4136760213899203, 'recall': 0.4063047285464098, 'f1-score': 0.3896263728146005, 'support': 84508}}
[[ 6302 13721  8259]
 [ 3533 17434  7019]
 [ 4593 13047 10600]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0928626
{'0': {'precision': 0.4177812745869394, 'recall': 0.21280859249759537, 'f1-score': 0.281981838457862, 'support': 12476}, '1': {'precision': 0.3382486905033022, 'recall': 0.5782557913178898, 'f1-score': 0.4268266398448164, 'support': 10274}, '2': {'precision': 0.3988503615798257, 'recall': 0.35984943538268505, 'f1-score': 0.3783474781232136, 'support': 11955}, 'accuracy': 0.3716467367814436, 'macro avg': {'precision': 0.38496010889002247, 'recall': 0.3836379397327234, 'f1-score': 0.36238531880863073, 'support': 34705}, 'weighted avg': {'precision': 0.3877153810881544, 'recall': 0.3716467367814436, 'f1-score': 0.3580569490081818, 'support': 34705}}
[[2655 6098 3723]
 [1572 5941 2761]
 [2128 5525 4302]]
training model: results/CHTR/W5/deepVOL_L2/h50
Epoch 1/50
331/331 - 12s - loss: 3.3388 - accuracy50: 0.3483 - val_loss: 3.3409 - val_accuracy50: 0.3268 - 12s/epoch - 36ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3112 - accuracy50: 0.3542 - val_loss: 3.3283 - val_accuracy50: 0.3270 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3021 - accuracy50: 0.3540 - val_loss: 3.3163 - val_accuracy50: 0.3316 - 10s/epoch - 29ms/step
Epoch 4/50
331/331 - 10s - loss: 3.2936 - accuracy50: 0.3574 - val_loss: 3.3055 - val_accuracy50: 0.3345 - 10s/epoch - 29ms/step
Epoch 5/50
331/331 - 10s - loss: 3.2896 - accuracy50: 0.3646 - val_loss: 3.3113 - val_accuracy50: 0.3353 - 10s/epoch - 29ms/step
Epoch 6/50
331/331 - 10s - loss: 3.2857 - accuracy50: 0.3659 - val_loss: 3.2996 - val_accuracy50: 0.3409 - 10s/epoch - 29ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2816 - accuracy50: 0.3693 - val_loss: 3.2993 - val_accuracy50: 0.3443 - 9s/epoch - 29ms/step
Epoch 8/50
331/331 - 10s - loss: 3.2760 - accuracy50: 0.3758 - val_loss: 3.2999 - val_accuracy50: 0.3414 - 10s/epoch - 29ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2727 - accuracy50: 0.3788 - val_loss: 3.2997 - val_accuracy50: 0.3451 - 9s/epoch - 29ms/step
Epoch 10/50
331/331 - 10s - loss: 3.2701 - accuracy50: 0.3821 - val_loss: 3.2883 - val_accuracy50: 0.3536 - 10s/epoch - 29ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2664 - accuracy50: 0.3844 - val_loss: 3.2926 - val_accuracy50: 0.3479 - 9s/epoch - 29ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2619 - accuracy50: 0.3869 - val_loss: 3.2927 - val_accuracy50: 0.3502 - 10s/epoch - 29ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2600 - accuracy50: 0.3871 - val_loss: 3.2903 - val_accuracy50: 0.3519 - 10s/epoch - 31ms/step
Epoch 14/50
331/331 - 10s - loss: 3.2579 - accuracy50: 0.3906 - val_loss: 3.2921 - val_accuracy50: 0.3477 - 10s/epoch - 29ms/step
Epoch 15/50
331/331 - 10s - loss: 3.2553 - accuracy50: 0.3920 - val_loss: 3.2892 - val_accuracy50: 0.3537 - 10s/epoch - 30ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2522 - accuracy50: 0.3926 - val_loss: 3.2921 - val_accuracy50: 0.3509 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.2513 - accuracy50: 0.3939 - val_loss: 3.2900 - val_accuracy50: 0.3542 - 9s/epoch - 28ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2446 - accuracy50: 0.3972 - val_loss: 3.2929 - val_accuracy50: 0.3519 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 9s - loss: 3.2428 - accuracy50: 0.3987 - val_loss: 3.2936 - val_accuracy50: 0.3516 - 9s/epoch - 28ms/step
Epoch 20/50
331/331 - 9s - loss: 3.2366 - accuracy50: 0.4041 - val_loss: 3.3013 - val_accuracy50: 0.3481 - 9s/epoch - 29ms/step
testing model: results/CHTR/W5/deepVOL_L2/h50
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0997802
{'0': {'precision': 0.39260333230337746, 'recall': 0.17630483509446046, 'f1-score': 0.24333581314496588, 'support': 187380}, '1': {'precision': 0.3239012071245674, 'recall': 0.5816784153212562, 'f1-score': 0.416101105217022, 'support': 158316}, '2': {'precision': 0.35686316223349446, 'recall': 0.3099589446879277, 'f1-score': 0.331761433868974, 'support': 173181}, 'accuracy': 0.3445980453941878, 'macro avg': {'precision': 0.35778923388714645, 'recall': 0.35598073170121475, 'f1-score': 0.330399450743654, 'support': 518877}, 'weighted avg': {'precision': 0.35971275507085243, 'recall': 0.3445980453941878, 'f1-score': 0.32556174993207354, 'support': 518877}}
[[ 33036 101001  53343]
 [ 22830  92089  43397]
 [ 28280  91222  53679]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0897855
{'0': {'precision': 0.3943901113827764, 'recall': 0.2052015972295841, 'f1-score': 0.2699486321270018, 'support': 28299}, '1': {'precision': 0.3703465392039709, 'recall': 0.5806102965017833, 'f1-score': 0.45223296339427266, 'support': 27757}, '2': {'precision': 0.3849170092888686, 'recall': 0.3553704484746239, 'f1-score': 0.36955409356725144, 'support': 28452}, 'accuracy': 0.3790647039333554, 'macro avg': {'precision': 0.38321788662520534, 'recall': 0.38039411406866375, 'f1-score': 0.363911896362842, 'support': 84508}, 'weighted avg': {'precision': 0.38330351444824984, 'recall': 0.3790647039333554, 'f1-score': 0.3633556559813543, 'support': 84508}}
[[ 5807 13948  8544]
 [ 4028 16116  7613]
 [ 4889 13452 10111]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.097536
{'0': {'precision': 0.3799126637554585, 'recall': 0.19574126155082364, 'f1-score': 0.25836559367874, 'support': 12445}, '1': {'precision': 0.32220510186611884, 'recall': 0.5452965037666603, 'f1-score': 0.4050651074362378, 'support': 10354}, '2': {'precision': 0.3758588672237697, 'recall': 0.3399966403494037, 'f1-score': 0.3570294584582819, 'support': 11906}, 'accuracy': 0.34951736061086297, 'macro avg': {'precision': 0.35932554428178237, 'recall': 0.3603448018889625, 'f1-score': 0.3401533865244199, 'support': 34705}, 'weighted avg': {'precision': 0.3613052989000051, 'recall': 0.349517360610863, 'f1-score': 0.33598031027607056, 'support': 34705}}
[[2436 6256 3753]
 [1739 5646 2969]
 [2237 5621 4048]]
training model: results/CHTR/W5/deepVOL_L2/h100
Epoch 1/50
331/331 - 14s - loss: 3.3468 - accuracy100: 0.3439 - val_loss: 3.3581 - val_accuracy100: 0.3167 - 14s/epoch - 41ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3244 - accuracy100: 0.3421 - val_loss: 3.3360 - val_accuracy100: 0.3236 - 10s/epoch - 32ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3126 - accuracy100: 0.3421 - val_loss: 3.3233 - val_accuracy100: 0.3195 - 10s/epoch - 30ms/step
Epoch 4/50
331/331 - 10s - loss: 3.3056 - accuracy100: 0.3438 - val_loss: 3.3185 - val_accuracy100: 0.3196 - 10s/epoch - 29ms/step
Epoch 5/50
331/331 - 9s - loss: 3.3012 - accuracy100: 0.3432 - val_loss: 3.3144 - val_accuracy100: 0.3235 - 9s/epoch - 29ms/step
Epoch 6/50
331/331 - 9s - loss: 3.2960 - accuracy100: 0.3509 - val_loss: 3.3111 - val_accuracy100: 0.3272 - 9s/epoch - 28ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2925 - accuracy100: 0.3523 - val_loss: 3.3093 - val_accuracy100: 0.3301 - 9s/epoch - 28ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2903 - accuracy100: 0.3539 - val_loss: 3.3084 - val_accuracy100: 0.3316 - 9s/epoch - 29ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2879 - accuracy100: 0.3548 - val_loss: 3.3136 - val_accuracy100: 0.3255 - 9s/epoch - 28ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2849 - accuracy100: 0.3602 - val_loss: 3.3158 - val_accuracy100: 0.3255 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2836 - accuracy100: 0.3613 - val_loss: 3.3143 - val_accuracy100: 0.3267 - 9s/epoch - 28ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2813 - accuracy100: 0.3638 - val_loss: 3.3148 - val_accuracy100: 0.3286 - 9s/epoch - 28ms/step
Epoch 13/50
331/331 - 9s - loss: 3.2781 - accuracy100: 0.3661 - val_loss: 3.3103 - val_accuracy100: 0.3349 - 9s/epoch - 28ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2776 - accuracy100: 0.3687 - val_loss: 3.3184 - val_accuracy100: 0.3270 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2770 - accuracy100: 0.3669 - val_loss: 3.3144 - val_accuracy100: 0.3288 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2742 - accuracy100: 0.3705 - val_loss: 3.3177 - val_accuracy100: 0.3319 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.2722 - accuracy100: 0.3710 - val_loss: 3.3186 - val_accuracy100: 0.3292 - 9s/epoch - 28ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2700 - accuracy100: 0.3742 - val_loss: 3.3185 - val_accuracy100: 0.3300 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h100
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1010482
{'0': {'precision': 0.3492235109101632, 'recall': 0.299976359870317, 'f1-score': 0.3227320346136844, 'support': 177664}, '1': {'precision': 0.3367225276545009, 'recall': 0.5208741290587003, 'f1-score': 0.4090269054888271, 'support': 175672}, '2': {'precision': 0.3313972556363136, 'recall': 0.18922200542463802, 'f1-score': 0.24089640162730425, 'support': 165541}, 'accuracy': 0.3394291903476161, 'macro avg': {'precision': 0.3391144314003259, 'recall': 0.3366908314512185, 'f1-score': 0.3242184472432719, 'support': 518877}, 'weighted avg': {'precision': 0.33930391752911715, 'recall': 0.3394291903476161, 'f1-score': 0.32583959196577306, 'support': 518877}}
[[53295 94029 30340]
 [51312 91503 32857]
 [48003 86214 31324]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0964513
{'0': {'precision': 0.34706678145369574, 'recall': 0.30136693720632207, 'f1-score': 0.3226064589882824, 'support': 28092}, '1': {'precision': 0.34333861170853913, 'recall': 0.5207743323176196, 'f1-score': 0.41383927299660994, 'support': 27895}, '2': {'precision': 0.3703662098404853, 'recall': 0.23119806458399075, 'f1-score': 0.2846842957366433, 'support': 28521}, 'accuracy': 0.3501088654328584, 'macro avg': {'precision': 0.35359053433424004, 'recall': 0.35111311136931084, 'f1-score': 0.3403766759071785, 'support': 84508}, 'weighted avg': {'precision': 0.353699593755235, 'recall': 0.3501088654328584, 'f1-score': 0.33992270512666334, 'support': 84508}}
[[ 8466 13927  5699]
 [ 7857 14527  5511]
 [ 8070 13857  6594]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.104015
{'0': {'precision': 0.3598917618761275, 'recall': 0.28997093023255816, 'f1-score': 0.3211698416957338, 'support': 12384}, '1': {'precision': 0.30577367205542727, 'recall': 0.5024191253201784, 'f1-score': 0.38017300168694595, 'support': 10541}, '2': {'precision': 0.3360334818415013, 'recall': 0.21129032258064517, 'f1-score': 0.2594465002345338, 'support': 11780}, 'accuracy': 0.32779138452672524, 'macro avg': {'precision': 0.3338996385910187, 'recall': 0.33456012604446056, 'f1-score': 0.32026311453907125, 'support': 34705}, 'weighted avg': {'precision': 0.3353561236796746, 'recall': 0.32779138452672524, 'f1-score': 0.3181400577180485, 'support': 34705}}
[[3591 6069 2724]
 [3051 5296 2194]
 [3336 5955 2489]]
training model: results/CHTR/W5/deepVOL_L2/h200
Epoch 1/50
331/331 - 14s - loss: 3.3455 - accuracy200: 0.3461 - val_loss: 3.3594 - val_accuracy200: 0.3300 - 14s/epoch - 42ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3239 - accuracy200: 0.3458 - val_loss: 3.3422 - val_accuracy200: 0.3274 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3145 - accuracy200: 0.3447 - val_loss: 3.3188 - val_accuracy200: 0.3362 - 10s/epoch - 29ms/step
Epoch 4/50
331/331 - 12s - loss: 3.3095 - accuracy200: 0.3487 - val_loss: 3.3135 - val_accuracy200: 0.3402 - 12s/epoch - 35ms/step
Epoch 5/50
331/331 - 10s - loss: 3.3030 - accuracy200: 0.3445 - val_loss: 3.3055 - val_accuracy200: 0.3424 - 10s/epoch - 29ms/step
Epoch 6/50
331/331 - 10s - loss: 3.3008 - accuracy200: 0.3470 - val_loss: 3.3054 - val_accuracy200: 0.3430 - 10s/epoch - 29ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2959 - accuracy200: 0.3497 - val_loss: 3.3058 - val_accuracy200: 0.3438 - 10s/epoch - 29ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2930 - accuracy200: 0.3528 - val_loss: 3.3058 - val_accuracy200: 0.3418 - 9s/epoch - 28ms/step
Epoch 9/50
331/331 - 10s - loss: 3.2900 - accuracy200: 0.3535 - val_loss: 3.3065 - val_accuracy200: 0.3414 - 10s/epoch - 29ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2881 - accuracy200: 0.3571 - val_loss: 3.3063 - val_accuracy200: 0.3451 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2849 - accuracy200: 0.3620 - val_loss: 3.3064 - val_accuracy200: 0.3423 - 9s/epoch - 28ms/step
Epoch 12/50
331/331 - 10s - loss: 3.2830 - accuracy200: 0.3617 - val_loss: 3.3037 - val_accuracy200: 0.3503 - 10s/epoch - 29ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2824 - accuracy200: 0.3632 - val_loss: 3.3090 - val_accuracy200: 0.3453 - 10s/epoch - 29ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2794 - accuracy200: 0.3639 - val_loss: 3.3098 - val_accuracy200: 0.3449 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2762 - accuracy200: 0.3669 - val_loss: 3.3113 - val_accuracy200: 0.3408 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2741 - accuracy200: 0.3692 - val_loss: 3.3119 - val_accuracy200: 0.3442 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 11s - loss: 3.2739 - accuracy200: 0.3695 - val_loss: 3.3142 - val_accuracy200: 0.3397 - 11s/epoch - 33ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2708 - accuracy200: 0.3709 - val_loss: 3.3157 - val_accuracy200: 0.3411 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 9s - loss: 3.2679 - accuracy200: 0.3731 - val_loss: 3.3164 - val_accuracy200: 0.3425 - 9s/epoch - 28ms/step
Epoch 20/50
331/331 - 9s - loss: 3.2687 - accuracy200: 0.3727 - val_loss: 3.3227 - val_accuracy200: 0.3405 - 9s/epoch - 28ms/step
Epoch 21/50
331/331 - 9s - loss: 3.2655 - accuracy200: 0.3773 - val_loss: 3.3234 - val_accuracy200: 0.3397 - 9s/epoch - 28ms/step
Epoch 22/50
331/331 - 9s - loss: 3.2610 - accuracy200: 0.3795 - val_loss: 3.3176 - val_accuracy200: 0.3433 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h200
Evaluating performance on  test set...
2027/2027 - 26s - 26s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0985948
{'0': {'precision': 0.3301684186729965, 'recall': 0.4590019279700711, 'f1-score': 0.38406901975063273, 'support': 165459}, '1': {'precision': 0.40812736921910536, 'recall': 0.34611882950214234, 'f1-score': 0.37457415777871794, 'support': 194413}, '2': {'precision': 0.3120180674302307, 'recall': 0.24328794691990818, 'f1-score': 0.27339965015813555, 'support': 159005}, 'accuracy': 0.3506033221746194, 'macro avg': {'precision': 0.3501046184407775, 'recall': 0.34946956813070723, 'f1-score': 0.3440142758958287, 'support': 518877}, 'weighted avg': {'precision': 0.35381609789787, 'recall': 0.3506033221746194, 'f1-score': 0.3465978893813913, 'support': 518877}}
[[75946 49176 40337]
 [82164 67290 44959]
 [71912 48409 38684]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0946189
{'0': {'precision': 0.3535689087488241, 'recall': 0.43231488138030194, 'f1-score': 0.3889967009509024, 'support': 27820}, '1': {'precision': 0.3600716495684742, 'recall': 0.3965140049492522, 'f1-score': 0.3774151703420496, 'support': 27883}, '2': {'precision': 0.3629150452317178, 'recall': 0.24929699704912342, 'f1-score': 0.29556305564702007, 'support': 28805}, 'accuracy': 0.3581199413073318, 'macro avg': {'precision': 0.358851867849672, 'recall': 0.3593752944595592, 'f1-score': 0.35399164231332403, 'support': 84508}, 'weighted avg': {'precision': 0.35890013636826906, 'recall': 0.3581199413073318, 'f1-score': 0.353328078205778, 'support': 84508}}
[[12027  9431  6362]
 [10583 11056  6244]
 [11406 10218  7181]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.1019887
{'0': {'precision': 0.35627646594416135, 'recall': 0.4120185922974768, 'f1-score': 0.38212539933027984, 'support': 12048}, '1': {'precision': 0.33577630845216283, 'recall': 0.388014360673847, 'f1-score': 0.3600102494021182, 'support': 10863}, '2': {'precision': 0.34432412702275217, 'recall': 0.23995251822960828, 'f1-score': 0.2828161694898316, 'support': 11794}, 'accuracy': 0.346030831292321, 'macro avg': {'precision': 0.34545896713969215, 'recall': 0.346661823733644, 'f1-score': 0.34165060607407655, 'support': 34705}, 'weighted avg': {'precision': 0.34579788660185684, 'recall': 0.346030831292321, 'f1-score': 0.3414543164774383, 'support': 34705}}
[[4964 4188 2896]
 [4155 4215 2493]
 [4814 4150 2830]]
training model: results/CHTR/W5/deepVOL_L2/h300
Epoch 1/50
331/331 - 12s - loss: 3.3454 - accuracy300: 0.3469 - val_loss: 3.3587 - val_accuracy300: 0.3341 - 12s/epoch - 37ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3181 - accuracy300: 0.3507 - val_loss: 3.3465 - val_accuracy300: 0.3378 - 10s/epoch - 29ms/step
Epoch 3/50
331/331 - 9s - loss: 3.3099 - accuracy300: 0.3477 - val_loss: 3.3237 - val_accuracy300: 0.3391 - 9s/epoch - 29ms/step
Epoch 4/50
331/331 - 9s - loss: 3.3051 - accuracy300: 0.3484 - val_loss: 3.3141 - val_accuracy300: 0.3379 - 9s/epoch - 29ms/step
Epoch 5/50
331/331 - 9s - loss: 3.2996 - accuracy300: 0.3504 - val_loss: 3.3062 - val_accuracy300: 0.3443 - 9s/epoch - 29ms/step
Epoch 6/50
331/331 - 9s - loss: 3.2992 - accuracy300: 0.3490 - val_loss: 3.3053 - val_accuracy300: 0.3432 - 9s/epoch - 29ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2934 - accuracy300: 0.3546 - val_loss: 3.3012 - val_accuracy300: 0.3486 - 9s/epoch - 28ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2903 - accuracy300: 0.3578 - val_loss: 3.3029 - val_accuracy300: 0.3465 - 9s/epoch - 28ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2910 - accuracy300: 0.3556 - val_loss: 3.3019 - val_accuracy300: 0.3487 - 9s/epoch - 28ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2892 - accuracy300: 0.3565 - val_loss: 3.3013 - val_accuracy300: 0.3464 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2859 - accuracy300: 0.3585 - val_loss: 3.3028 - val_accuracy300: 0.3476 - 9s/epoch - 29ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2834 - accuracy300: 0.3634 - val_loss: 3.2995 - val_accuracy300: 0.3515 - 9s/epoch - 28ms/step
Epoch 13/50
331/331 - 9s - loss: 3.2810 - accuracy300: 0.3653 - val_loss: 3.3024 - val_accuracy300: 0.3521 - 9s/epoch - 28ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2808 - accuracy300: 0.3645 - val_loss: 3.3037 - val_accuracy300: 0.3497 - 9s/epoch - 29ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2776 - accuracy300: 0.3668 - val_loss: 3.3049 - val_accuracy300: 0.3499 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2762 - accuracy300: 0.3697 - val_loss: 3.3065 - val_accuracy300: 0.3482 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.2749 - accuracy300: 0.3671 - val_loss: 3.3085 - val_accuracy300: 0.3431 - 9s/epoch - 28ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2743 - accuracy300: 0.3703 - val_loss: 3.3119 - val_accuracy300: 0.3418 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 10s - loss: 3.2707 - accuracy300: 0.3729 - val_loss: 3.3095 - val_accuracy300: 0.3425 - 10s/epoch - 29ms/step
Epoch 20/50
331/331 - 10s - loss: 3.2680 - accuracy300: 0.3745 - val_loss: 3.3117 - val_accuracy300: 0.3455 - 10s/epoch - 29ms/step
Epoch 21/50
331/331 - 9s - loss: 3.2657 - accuracy300: 0.3752 - val_loss: 3.3108 - val_accuracy300: 0.3443 - 9s/epoch - 28ms/step
Epoch 22/50
331/331 - 9s - loss: 3.2644 - accuracy300: 0.3767 - val_loss: 3.3124 - val_accuracy300: 0.3458 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h300
Evaluating performance on  test set...
2027/2027 - 28s - 28s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0973831
{'0': {'precision': 0.32261971185245736, 'recall': 0.4651786438162236, 'f1-score': 0.38100054144064077, 'support': 160347}, '1': {'precision': 0.4316125361211215, 'recall': 0.38160860579934597, 'f1-score': 0.4050732320257588, 'support': 202747}, '2': {'precision': 0.301573539449169, 'recall': 0.20988169440824736, 'f1-score': 0.2475085257058073, 'support': 155783}, 'accuracy': 0.3558762481281691, 'macro avg': {'precision': 0.3519352624742493, 'recall': 0.3522229813412723, 'f1-score': 0.34452743305740235, 'support': 518877}, 'weighted avg': {'precision': 0.3588890632912326, 'recall': 0.3558762481281691, 'f1-score': 0.35032829948511246, 'support': 518877}}
[[74590 51974 33783]
 [83438 77370 41939]
 [73173 49914 32696]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 14ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0940316
{'0': {'precision': 0.3543209503370311, 'recall': 0.4235438647203353, 'f1-score': 0.3858523017166181, 'support': 27676}, '1': {'precision': 0.36321488394352713, 'recall': 0.43557644020374486, 'f1-score': 0.39611808840319684, 'support': 27878}, '2': {'precision': 0.3713110654143278, 'recall': 0.2307453201630172, 'f1-score': 0.2846188254840565, 'support': 28954}, 'accuracy': 0.36145690348842713, 'macro avg': {'precision': 0.36294896656496195, 'recall': 0.3632885416956991, 'f1-score': 0.35552973853462383, 'support': 84508}, 'weighted avg': {'precision': 0.3630760607766338, 'recall': 0.36145690348842713, 'f1-score': 0.35455438353621926, 'support': 84508}}
[[11722 10218  5736]
 [10159 12143  5576]
 [11202 11071  6681]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.1004541
{'0': {'precision': 0.35650240829937013, 'recall': 0.403336686787391, 'f1-score': 0.3784761829839122, 'support': 11928}, '1': {'precision': 0.34357421029857205, 'recall': 0.4315217391304348, 'f1-score': 0.38255841965791376, 'support': 11040}, '2': {'precision': 0.3519880174291939, 'recall': 0.22024367385192128, 'f1-score': 0.27095015984487186, 'support': 11737}, 'accuracy': 0.3503817893675263, 'macro avg': {'precision': 0.3506882120090453, 'recall': 0.35170069992324904, 'f1-score': 0.34399492082889926, 'support': 34705}, 'weighted avg': {'precision': 0.3508630851017886, 'recall': 0.3503817893675263, 'f1-score': 0.34341019708268933, 'support': 34705}}
[[4811 4552 2565]
 [4082 4764 2194]
 [4602 4550 2585]]
training model: results/CHTR/W5/deepVOL_L2/h500
Epoch 1/50
331/331 - 12s - loss: 3.3420 - accuracy500: 0.3469 - val_loss: 3.3591 - val_accuracy500: 0.3291 - 12s/epoch - 36ms/step
Epoch 2/50
331/331 - 9s - loss: 3.3194 - accuracy500: 0.3500 - val_loss: 3.3574 - val_accuracy500: 0.3326 - 9s/epoch - 28ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3113 - accuracy500: 0.3516 - val_loss: 3.3213 - val_accuracy500: 0.3427 - 10s/epoch - 29ms/step
Epoch 4/50
331/331 - 9s - loss: 3.3030 - accuracy500: 0.3542 - val_loss: 3.3203 - val_accuracy500: 0.3432 - 9s/epoch - 28ms/step
Epoch 5/50
331/331 - 9s - loss: 3.2977 - accuracy500: 0.3545 - val_loss: 3.3120 - val_accuracy500: 0.3488 - 9s/epoch - 29ms/step
Epoch 6/50
331/331 - 9s - loss: 3.2970 - accuracy500: 0.3585 - val_loss: 3.3126 - val_accuracy500: 0.3454 - 9s/epoch - 28ms/step
Epoch 7/50
331/331 - 10s - loss: 3.2920 - accuracy500: 0.3572 - val_loss: 3.3101 - val_accuracy500: 0.3479 - 10s/epoch - 29ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2899 - accuracy500: 0.3566 - val_loss: 3.3107 - val_accuracy500: 0.3456 - 9s/epoch - 28ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2866 - accuracy500: 0.3584 - val_loss: 3.3071 - val_accuracy500: 0.3491 - 9s/epoch - 28ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2832 - accuracy500: 0.3640 - val_loss: 3.3094 - val_accuracy500: 0.3514 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2798 - accuracy500: 0.3649 - val_loss: 3.3111 - val_accuracy500: 0.3508 - 9s/epoch - 28ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2774 - accuracy500: 0.3687 - val_loss: 3.3142 - val_accuracy500: 0.3506 - 9s/epoch - 29ms/step
Epoch 13/50
331/331 - 9s - loss: 3.2757 - accuracy500: 0.3701 - val_loss: 3.3118 - val_accuracy500: 0.3505 - 9s/epoch - 28ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2729 - accuracy500: 0.3701 - val_loss: 3.3155 - val_accuracy500: 0.3492 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2714 - accuracy500: 0.3711 - val_loss: 3.3186 - val_accuracy500: 0.3501 - 9s/epoch - 28ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2696 - accuracy500: 0.3770 - val_loss: 3.3165 - val_accuracy500: 0.3523 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 10s - loss: 3.2690 - accuracy500: 0.3738 - val_loss: 3.3180 - val_accuracy500: 0.3509 - 10s/epoch - 29ms/step
Epoch 18/50
331/331 - 9s - loss: 3.2668 - accuracy500: 0.3762 - val_loss: 3.3214 - val_accuracy500: 0.3493 - 9s/epoch - 28ms/step
Epoch 19/50
331/331 - 9s - loss: 3.2640 - accuracy500: 0.3801 - val_loss: 3.3212 - val_accuracy500: 0.3529 - 9s/epoch - 28ms/step
testing model: results/CHTR/W5/deepVOL_L2/h500
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 15ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0955428
{'0': {'precision': 0.31402511534985494, 'recall': 0.5062077073974913, 'f1-score': 0.38760198153018166, 'support': 156499}, '1': {'precision': 0.4410261378209564, 'recall': 0.46046218163603436, 'f1-score': 0.4505346396542868, 'support': 207624}, '2': {'precision': 0.29387681377566377, 'recall': 0.09462114064903007, 'f1-score': 0.14315112351586903, 'support': 154754}, 'accuracy': 0.3651481950442976, 'macro avg': {'precision': 0.3496426889821584, 'recall': 0.3537636765608519, 'f1-score': 0.3270959149001125, 'support': 518877}, 'weighted avg': {'precision': 0.3588342512871341, 'recall': 0.3651481950442976, 'f1-score': 0.3398769563878305, 'support': 518877}}
[[79221 62657 14621]
 [91458 95603 20563]
 [81597 58514 14643]]
Evaluating performance on  train set...
331/331 - 5s - 5s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0947944
{'0': {'precision': 0.3537383845604003, 'recall': 0.455455750257694, 'f1-score': 0.3982040264568145, 'support': 27164}, '1': {'precision': 0.3567813267813268, 'recall': 0.5225636965596661, 'f1-score': 0.42404508819063197, 'support': 27788}, '2': {'precision': 0.40665685497565945, 'recall': 0.12153200703748816, 'f1-score': 0.187136940269348, 'support': 29556}, 'accuracy': 0.36073507833577884, 'macro avg': {'precision': 0.37239218877246216, 'recall': 0.36651715128494944, 'f1-score': 0.33646201830559813, 'support': 84508}, 'weighted avg': {'precision': 0.3732467812805748, 'recall': 0.36073507833577884, 'f1-score': 0.33288207615746485, 'support': 84508}}
[[12372 12231  2561]
 [10587 14521  2680]
 [12016 13948  3592]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 14ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.1026404
{'0': {'precision': 0.3590601687234191, 'recall': 0.4321194831347542, 'f1-score': 0.39221659495068734, 'support': 11918}, '1': {'precision': 0.3385789222699094, 'recall': 0.5212443791869322, 'f1-score': 0.4105084378274853, 'support': 10897}, '2': {'precision': 0.3611266034578918, 'recall': 0.10891505466778806, 'f1-score': 0.16735590591884209, 'support': 11890}, 'accuracy': 0.34937328915141913, 'macro avg': {'precision': 0.35292189815040675, 'recall': 0.3540929723298249, 'f1-score': 0.3233603128990049, 'support': 34705}, 'weighted avg': {'precision': 0.35333724022288565, 'recall': 0.34937328915141913, 'f1-score': 0.3209223324305844, 'support': 34705}}
[[5150 5494 1274]
 [4200 5680 1017]
 [4993 5602 1295]]
training model: results/CHTR/W5/deepVOL_L2/h1000
Epoch 1/50
331/331 - 12s - loss: 3.3415 - accuracy1000: 0.3502 - val_loss: 3.3414 - val_accuracy1000: 0.3420 - 12s/epoch - 35ms/step
Epoch 2/50
331/331 - 10s - loss: 3.3217 - accuracy1000: 0.3517 - val_loss: 3.3368 - val_accuracy1000: 0.3487 - 10s/epoch - 30ms/step
Epoch 3/50
331/331 - 10s - loss: 3.3048 - accuracy1000: 0.3507 - val_loss: 3.3065 - val_accuracy1000: 0.3440 - 10s/epoch - 29ms/step
Epoch 4/50
331/331 - 9s - loss: 3.3007 - accuracy1000: 0.3542 - val_loss: 3.3193 - val_accuracy1000: 0.3475 - 9s/epoch - 28ms/step
Epoch 5/50
331/331 - 9s - loss: 3.2950 - accuracy1000: 0.3560 - val_loss: 3.3008 - val_accuracy1000: 0.3403 - 9s/epoch - 28ms/step
Epoch 6/50
331/331 - 9s - loss: 3.2974 - accuracy1000: 0.3499 - val_loss: 3.2983 - val_accuracy1000: 0.3508 - 9s/epoch - 28ms/step
Epoch 7/50
331/331 - 9s - loss: 3.2930 - accuracy1000: 0.3502 - val_loss: 3.2962 - val_accuracy1000: 0.3493 - 9s/epoch - 28ms/step
Epoch 8/50
331/331 - 9s - loss: 3.2886 - accuracy1000: 0.3554 - val_loss: 3.2972 - val_accuracy1000: 0.3505 - 9s/epoch - 29ms/step
Epoch 9/50
331/331 - 9s - loss: 3.2844 - accuracy1000: 0.3588 - val_loss: 3.2994 - val_accuracy1000: 0.3482 - 9s/epoch - 28ms/step
Epoch 10/50
331/331 - 9s - loss: 3.2840 - accuracy1000: 0.3613 - val_loss: 3.3009 - val_accuracy1000: 0.3472 - 9s/epoch - 28ms/step
Epoch 11/50
331/331 - 9s - loss: 3.2790 - accuracy1000: 0.3663 - val_loss: 3.3045 - val_accuracy1000: 0.3491 - 9s/epoch - 28ms/step
Epoch 12/50
331/331 - 9s - loss: 3.2801 - accuracy1000: 0.3661 - val_loss: 3.3025 - val_accuracy1000: 0.3478 - 9s/epoch - 28ms/step
Epoch 13/50
331/331 - 10s - loss: 3.2765 - accuracy1000: 0.3689 - val_loss: 3.3030 - val_accuracy1000: 0.3497 - 10s/epoch - 29ms/step
Epoch 14/50
331/331 - 9s - loss: 3.2749 - accuracy1000: 0.3696 - val_loss: 3.3068 - val_accuracy1000: 0.3468 - 9s/epoch - 28ms/step
Epoch 15/50
331/331 - 9s - loss: 3.2731 - accuracy1000: 0.3730 - val_loss: 3.3071 - val_accuracy1000: 0.3479 - 9s/epoch - 29ms/step
Epoch 16/50
331/331 - 9s - loss: 3.2695 - accuracy1000: 0.3755 - val_loss: 3.3037 - val_accuracy1000: 0.3521 - 9s/epoch - 28ms/step
Epoch 17/50
331/331 - 9s - loss: 3.2677 - accuracy1000: 0.3770 - val_loss: 3.3046 - val_accuracy1000: 0.3495 - 9s/epoch - 29ms/step
testing model: results/CHTR/W5/deepVOL_L2/h1000
Evaluating performance on  test set...
2027/2027 - 29s - 29s/epoch - 14ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1005228
{'0': {'precision': 0.30300129639120865, 'recall': 0.5202026410626363, 'f1-score': 0.3829478151322542, 'support': 154559}, '1': {'precision': 0.4497180721899823, 'recall': 0.2600158006453517, 'f1-score': 0.32951450982047814, 'support': 210118}, '2': {'precision': 0.2900408966979703, 'recall': 0.2483592736705577, 'f1-score': 0.26758664058133036, 'support': 154200}, 'accuracy': 0.3340541207261066, 'macro avg': {'precision': 0.34758675509305376, 'recall': 0.3428592384595152, 'f1-score': 0.32668298851135424, 'support': 518877}, 'weighted avg': {'precision': 0.35856232889908496, 'recall': 0.3340541207261066, 'f1-score': 0.32702706250445956, 'support': 518877}}
[[ 80402  34900  39257]
 [100998  54634  54486]
 [ 83952  31951  38297]]
Evaluating performance on  train set...
331/331 - 4s - 4s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0959727
{'0': {'precision': 0.34655878844458277, 'recall': 0.49029607073412335, 'f1-score': 0.40608334979261307, 'support': 27257}, '1': {'precision': 0.36472784353654913, 'recall': 0.3077721691189632, 'f1-score': 0.33383814849332094, 'support': 27933}, '2': {'precision': 0.36505027932960893, 'recall': 0.278600177365441, 'f1-score': 0.31601957711875883, 'support': 29318}, 'accuracy': 0.3565224594121267, 'macro avg': {'precision': 0.3587789704369136, 'recall': 0.3588894724061758, 'f1-score': 0.351980358468231, 'support': 84508}, 'weighted avg': {'precision': 0.3589795030000224, 'recall': 0.3565224594121267, 'f1-score': 0.35095821495158985, 'support': 84508}}
[[13364  6953  6940]
 [12069  8597  7267]
 [13129  8021  8168]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 13ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0977311
{'0': {'precision': 0.3580356015654589, 'recall': 0.47152714273838225, 'f1-score': 0.40701804743281544, 'support': 12029}, '1': {'precision': 0.3494533221194281, 'recall': 0.30826300658443845, 'f1-score': 0.32756836659275684, 'support': 10783}, '2': {'precision': 0.34937439846005774, 'recall': 0.27469940301017404, 'f1-score': 0.30756919600828464, 'support': 11893}, 'accuracy': 0.3533496614320703, 'macro avg': {'precision': 0.35228777404831485, 'recall': 0.3514965174443316, 'f1-score': 0.347385203344619, 'support': 34705}, 'weighted avg': {'precision': 0.3524009550361667, 'recall': 0.3533496614320703, 'f1-score': 0.3482527081880295, 'support': 34705}}
[[5672 3209 3148]
 [4523 3324 2936]
 [5647 2979 3267]]
training model: results/CHTR/W5/deepVOL_L3/h10
Epoch 1/50
331/331 - 17s - loss: 3.3282 - accuracy10: 0.3569 - val_loss: 3.3195 - val_accuracy10: 0.3451 - 17s/epoch - 50ms/step
Epoch 2/50
331/331 - 14s - loss: 3.3060 - accuracy10: 0.3538 - val_loss: 3.3267 - val_accuracy10: 0.3397 - 14s/epoch - 41ms/step
Epoch 3/50
331/331 - 14s - loss: 3.2891 - accuracy10: 0.3649 - val_loss: 3.3265 - val_accuracy10: 0.3478 - 14s/epoch - 41ms/step
Epoch 4/50
331/331 - 13s - loss: 3.2761 - accuracy10: 0.3758 - val_loss: 3.3180 - val_accuracy10: 0.3519 - 13s/epoch - 40ms/step
Epoch 5/50
331/331 - 13s - loss: 3.2626 - accuracy10: 0.3841 - val_loss: 3.3141 - val_accuracy10: 0.3550 - 13s/epoch - 41ms/step
Epoch 6/50
331/331 - 14s - loss: 3.2530 - accuracy10: 0.3891 - val_loss: 3.2660 - val_accuracy10: 0.3750 - 14s/epoch - 41ms/step
Epoch 7/50
331/331 - 13s - loss: 3.2389 - accuracy10: 0.4015 - val_loss: 3.2867 - val_accuracy10: 0.3710 - 13s/epoch - 40ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2338 - accuracy10: 0.4036 - val_loss: 3.2876 - val_accuracy10: 0.3696 - 14s/epoch - 42ms/step
Epoch 9/50
331/331 - 13s - loss: 3.2250 - accuracy10: 0.4103 - val_loss: 3.2770 - val_accuracy10: 0.3740 - 13s/epoch - 40ms/step
Epoch 10/50
331/331 - 13s - loss: 3.2206 - accuracy10: 0.4090 - val_loss: 3.2696 - val_accuracy10: 0.3802 - 13s/epoch - 40ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2132 - accuracy10: 0.4135 - val_loss: 3.2731 - val_accuracy10: 0.3772 - 13s/epoch - 40ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2088 - accuracy10: 0.4177 - val_loss: 3.2680 - val_accuracy10: 0.3813 - 13s/epoch - 40ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2028 - accuracy10: 0.4196 - val_loss: 3.2682 - val_accuracy10: 0.3811 - 13s/epoch - 40ms/step
Epoch 14/50
331/331 - 13s - loss: 3.1980 - accuracy10: 0.4219 - val_loss: 3.2645 - val_accuracy10: 0.3823 - 13s/epoch - 41ms/step
Epoch 15/50
331/331 - 13s - loss: 3.1945 - accuracy10: 0.4244 - val_loss: 3.2577 - val_accuracy10: 0.3858 - 13s/epoch - 40ms/step
Epoch 16/50
331/331 - 14s - loss: 3.1896 - accuracy10: 0.4287 - val_loss: 3.2615 - val_accuracy10: 0.3844 - 14s/epoch - 43ms/step
Epoch 17/50
331/331 - 14s - loss: 3.1841 - accuracy10: 0.4285 - val_loss: 3.2545 - val_accuracy10: 0.3870 - 14s/epoch - 41ms/step
Epoch 18/50
331/331 - 14s - loss: 3.1805 - accuracy10: 0.4310 - val_loss: 3.2602 - val_accuracy10: 0.3876 - 14s/epoch - 41ms/step
Epoch 19/50
331/331 - 13s - loss: 3.1740 - accuracy10: 0.4314 - val_loss: 3.2590 - val_accuracy10: 0.3869 - 13s/epoch - 40ms/step
Epoch 20/50
331/331 - 13s - loss: 3.1707 - accuracy10: 0.4347 - val_loss: 3.2577 - val_accuracy10: 0.3863 - 13s/epoch - 40ms/step
Epoch 21/50
331/331 - 13s - loss: 3.1667 - accuracy10: 0.4366 - val_loss: 3.2621 - val_accuracy10: 0.3871 - 13s/epoch - 40ms/step
Epoch 22/50
331/331 - 13s - loss: 3.1638 - accuracy10: 0.4365 - val_loss: 3.2587 - val_accuracy10: 0.3907 - 13s/epoch - 40ms/step
Epoch 23/50
331/331 - 14s - loss: 3.1594 - accuracy10: 0.4397 - val_loss: 3.2683 - val_accuracy10: 0.3887 - 14s/epoch - 41ms/step
Epoch 24/50
331/331 - 14s - loss: 3.1557 - accuracy10: 0.4417 - val_loss: 3.2609 - val_accuracy10: 0.3916 - 14s/epoch - 41ms/step
Epoch 25/50
331/331 - 14s - loss: 3.1518 - accuracy10: 0.4418 - val_loss: 3.2619 - val_accuracy10: 0.3851 - 14s/epoch - 41ms/step
Epoch 26/50
331/331 - 14s - loss: 3.1485 - accuracy10: 0.4421 - val_loss: 3.2676 - val_accuracy10: 0.3890 - 14s/epoch - 42ms/step
Epoch 27/50
331/331 - 14s - loss: 3.1425 - accuracy10: 0.4468 - val_loss: 3.2660 - val_accuracy10: 0.3899 - 14s/epoch - 42ms/step
testing model: results/CHTR/W5/deepVOL_L3/h10
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.088791
{'0': {'precision': 0.44640727640222333, 'recall': 0.11786114520518705, 'f1-score': 0.1864859730226078, 'support': 187390}, '1': {'precision': 0.33984918774593387, 'recall': 0.7061186336203101, 'f1-score': 0.4588551180755772, 'support': 147631}, '2': {'precision': 0.41791925637668065, 'recall': 0.3697458880863284, 'f1-score': 0.3923594377220297, 'support': 183856}, 'accuracy': 0.3744837408480237, 'macro avg': {'precision': 0.4013919068416126, 'recall': 0.39790855563727523, 'f1-score': 0.3459001762734049, 'support': 518877}, 'weighted avg': {'precision': 0.4059950580995565, 'recall': 0.3744837408480237, 'f1-score': 0.3369285653500608, 'support': 518877}}
[[ 22086 103822  61482]
 [ 10185 104245  33201]
 [ 17204  98672  67980]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0643615
{'0': {'precision': 0.48167215815486, 'recall': 0.16678551055333712, 'f1-score': 0.24777542372881353, 'support': 28048}, '1': {'precision': 0.4158012495778453, 'recall': 0.6952670031412135, 'f1-score': 0.5203872723190109, 'support': 28333}, '2': {'precision': 0.41998541210795043, 'recall': 0.4094286628506417, 'f1-score': 0.41463985453759883, 'support': 28127}, 'accuracy': 0.4247290197377763, 'macro avg': {'precision': 0.43915293994688526, 'recall': 0.42382705884839744, 'f1-score': 0.3942675168618078, 'support': 84508}, 'weighted avg': {'precision': 0.43905626902277806, 'recall': 0.4247290197377763, 'f1-score': 0.39471189544113383, 'support': 84508}}
[[ 4678 14017  9353]
 [ 2083 19699  6551]
 [ 2951 13660 11516]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 10  orderbook updates
Categorical crossentropy: 1.0854293
{'0': {'precision': 0.44154961486180333, 'recall': 0.15871335504885994, 'f1-score': 0.23349706481370552, 'support': 12280}, '1': {'precision': 0.3591774641976604, 'recall': 0.647042147042147, 'f1-score': 0.4619328723224827, 'support': 10582}, '2': {'precision': 0.40862130388314927, 'recall': 0.38740184074981, 'f1-score': 0.397728750379264, 'support': 11843}, 'accuracy': 0.3856504826393891, 'macro avg': {'precision': 0.4031161276475377, 'recall': 0.3977191142802723, 'f1-score': 0.3643862291718174, 'support': 34705}, 'weighted avg': {'precision': 0.40519657970121664, 'recall': 0.3856504826393891, 'f1-score': 0.3591937531067696, 'support': 34705}}
[[1949 6412 3919]
 [1014 6847 2721]
 [1451 5804 4588]]
training model: results/CHTR/W5/deepVOL_L3/h20
Epoch 1/50
331/331 - 17s - loss: 3.3413 - accuracy20: 0.3514 - val_loss: 3.3336 - val_accuracy20: 0.3334 - 17s/epoch - 50ms/step
Epoch 2/50
331/331 - 13s - loss: 3.3122 - accuracy20: 0.3498 - val_loss: 3.3710 - val_accuracy20: 0.3172 - 13s/epoch - 40ms/step
Epoch 3/50
331/331 - 14s - loss: 3.2951 - accuracy20: 0.3554 - val_loss: 3.3484 - val_accuracy20: 0.3244 - 14s/epoch - 41ms/step
Epoch 4/50
331/331 - 13s - loss: 3.2873 - accuracy20: 0.3649 - val_loss: 3.3356 - val_accuracy20: 0.3327 - 13s/epoch - 40ms/step
Epoch 5/50
331/331 - 13s - loss: 3.2772 - accuracy20: 0.3717 - val_loss: 3.3174 - val_accuracy20: 0.3403 - 13s/epoch - 41ms/step
Epoch 6/50
331/331 - 13s - loss: 3.2687 - accuracy20: 0.3806 - val_loss: 3.3056 - val_accuracy20: 0.3519 - 13s/epoch - 40ms/step
Epoch 7/50
331/331 - 13s - loss: 3.2632 - accuracy20: 0.3842 - val_loss: 3.2962 - val_accuracy20: 0.3567 - 13s/epoch - 41ms/step
Epoch 8/50
331/331 - 13s - loss: 3.2582 - accuracy20: 0.3901 - val_loss: 3.3047 - val_accuracy20: 0.3542 - 13s/epoch - 40ms/step
Epoch 9/50
331/331 - 13s - loss: 3.2534 - accuracy20: 0.3924 - val_loss: 3.2973 - val_accuracy20: 0.3598 - 13s/epoch - 40ms/step
Epoch 10/50
331/331 - 13s - loss: 3.2490 - accuracy20: 0.3964 - val_loss: 3.2927 - val_accuracy20: 0.3612 - 13s/epoch - 40ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2427 - accuracy20: 0.3977 - val_loss: 3.2882 - val_accuracy20: 0.3653 - 13s/epoch - 40ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2433 - accuracy20: 0.3987 - val_loss: 3.3047 - val_accuracy20: 0.3623 - 13s/epoch - 40ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2355 - accuracy20: 0.4036 - val_loss: 3.2788 - val_accuracy20: 0.3669 - 13s/epoch - 40ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2317 - accuracy20: 0.4045 - val_loss: 3.2928 - val_accuracy20: 0.3674 - 13s/epoch - 40ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2282 - accuracy20: 0.4082 - val_loss: 3.2992 - val_accuracy20: 0.3658 - 13s/epoch - 40ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2225 - accuracy20: 0.4119 - val_loss: 3.2746 - val_accuracy20: 0.3723 - 13s/epoch - 40ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2194 - accuracy20: 0.4135 - val_loss: 3.2777 - val_accuracy20: 0.3710 - 13s/epoch - 40ms/step
Epoch 18/50
331/331 - 13s - loss: 3.2173 - accuracy20: 0.4147 - val_loss: 3.2662 - val_accuracy20: 0.3726 - 13s/epoch - 40ms/step
Epoch 19/50
331/331 - 13s - loss: 3.2108 - accuracy20: 0.4169 - val_loss: 3.2750 - val_accuracy20: 0.3738 - 13s/epoch - 40ms/step
Epoch 20/50
331/331 - 13s - loss: 3.2081 - accuracy20: 0.4166 - val_loss: 3.2785 - val_accuracy20: 0.3746 - 13s/epoch - 40ms/step
Epoch 21/50
331/331 - 13s - loss: 3.2025 - accuracy20: 0.4214 - val_loss: 3.2680 - val_accuracy20: 0.3767 - 13s/epoch - 40ms/step
Epoch 22/50
331/331 - 13s - loss: 3.2006 - accuracy20: 0.4206 - val_loss: 3.2723 - val_accuracy20: 0.3746 - 13s/epoch - 40ms/step
Epoch 23/50
331/331 - 13s - loss: 3.1967 - accuracy20: 0.4232 - val_loss: 3.2866 - val_accuracy20: 0.3716 - 13s/epoch - 40ms/step
Epoch 24/50
331/331 - 13s - loss: 3.1952 - accuracy20: 0.4231 - val_loss: 3.2865 - val_accuracy20: 0.3759 - 13s/epoch - 40ms/step
Epoch 25/50
331/331 - 13s - loss: 3.1933 - accuracy20: 0.4249 - val_loss: 3.2815 - val_accuracy20: 0.3753 - 13s/epoch - 40ms/step
Epoch 26/50
331/331 - 13s - loss: 3.1896 - accuracy20: 0.4253 - val_loss: 3.2829 - val_accuracy20: 0.3769 - 13s/epoch - 40ms/step
Epoch 27/50
331/331 - 13s - loss: 3.1837 - accuracy20: 0.4287 - val_loss: 3.2873 - val_accuracy20: 0.3759 - 13s/epoch - 40ms/step
Epoch 28/50
331/331 - 13s - loss: 3.1816 - accuracy20: 0.4297 - val_loss: 3.2894 - val_accuracy20: 0.3750 - 13s/epoch - 40ms/step
testing model: results/CHTR/W5/deepVOL_L3/h20
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0933948
{'0': {'precision': 0.43251744997673336, 'recall': 0.12286517982720514, 'f1-score': 0.19136836990582703, 'support': 189126}, '1': {'precision': 0.32844936790672424, 'recall': 0.6828675087342112, 'f1-score': 0.44355514436336974, 'support': 148840}, '2': {'precision': 0.40528181678055797, 'recall': 0.3488123994671413, 'f1-score': 0.37493278671479285, 'support': 180911}, 'accuracy': 0.3622804633853495, 'macro avg': {'precision': 0.38874954488800517, 'recall': 0.3848483626761859, 'f1-score': 0.3366187669946632, 'support': 518877}, 'weighted avg': {'precision': 0.393169552551229, 'recall': 0.3622804633853495, 'f1-score': 0.3277095484887811, 'support': 518877}}
[[ 23237 107944  57945]
 [ 12547 101638  34655]
 [ 17941  99866  63104]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0750842
{'0': {'precision': 0.4506593906321055, 'recall': 0.17455788064538857, 'f1-score': 0.251644193900612, 'support': 28386}, '1': {'precision': 0.39634542444626053, 'recall': 0.680849532037437, 'f1-score': 0.5010264764705104, 'support': 27780}, '2': {'precision': 0.4153613523573201, 'recall': 0.37799026180227224, 'f1-score': 0.39579561828056303, 'support': 28342}, 'accuracy': 0.4092156955554504, 'macro avg': {'precision': 0.420788722478562, 'recall': 0.4111325581616993, 'f1-score': 0.38282209621722846, 'support': 84508}, 'weighted avg': {'precision': 0.4209668292009186, 'recall': 0.4092156955554504, 'f1-score': 0.3819677074090177, 'support': 84508}}
[[ 4955 14692  8739]
 [ 2526 18914  6340]
 [ 3514 14115 10713]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 20  orderbook updates
Categorical crossentropy: 1.0899566
{'0': {'precision': 0.4280894137494728, 'recall': 0.16307840616966582, 'f1-score': 0.23618382780686448, 'support': 12448}, '1': {'precision': 0.3421202843651082, 'recall': 0.6357762777242044, 'f1-score': 0.4448567862082926, 'support': 10370}, '2': {'precision': 0.40787504676393566, 'recall': 0.36687137208715404, 'f1-score': 0.3862881438504805, 'support': 11887}, 'accuracy': 0.3741247658838784, 'macro avg': {'precision': 0.39269491495950554, 'recall': 0.38857535199367477, 'f1-score': 0.35577625262187923, 'support': 34705}, 'weighted avg': {'precision': 0.39547774246081285, 'recall': 0.3741247658838784, 'f1-score': 0.34994923865352273, 'support': 34705}}
[[2030 6663 3755]
 [1201 6593 2576]
 [1511 6015 4361]]
training model: results/CHTR/W5/deepVOL_L3/h30
Epoch 1/50
331/331 - 16s - loss: 3.3347 - accuracy30: 0.3513 - val_loss: 3.3660 - val_accuracy30: 0.3151 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 14s - loss: 3.3125 - accuracy30: 0.3443 - val_loss: 3.3323 - val_accuracy30: 0.3175 - 14s/epoch - 41ms/step
Epoch 3/50
331/331 - 13s - loss: 3.3002 - accuracy30: 0.3479 - val_loss: 3.3142 - val_accuracy30: 0.3203 - 13s/epoch - 41ms/step
Epoch 4/50
331/331 - 13s - loss: 3.2901 - accuracy30: 0.3582 - val_loss: 3.3100 - val_accuracy30: 0.3287 - 13s/epoch - 41ms/step
Epoch 5/50
331/331 - 13s - loss: 3.2833 - accuracy30: 0.3660 - val_loss: 3.3045 - val_accuracy30: 0.3414 - 13s/epoch - 40ms/step
Epoch 6/50
331/331 - 14s - loss: 3.2792 - accuracy30: 0.3700 - val_loss: 3.3143 - val_accuracy30: 0.3369 - 14s/epoch - 41ms/step
Epoch 7/50
331/331 - 14s - loss: 3.2726 - accuracy30: 0.3779 - val_loss: 3.3004 - val_accuracy30: 0.3446 - 14s/epoch - 41ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2679 - accuracy30: 0.3811 - val_loss: 3.2991 - val_accuracy30: 0.3484 - 14s/epoch - 41ms/step
Epoch 9/50
331/331 - 14s - loss: 3.2625 - accuracy30: 0.3867 - val_loss: 3.3021 - val_accuracy30: 0.3506 - 14s/epoch - 41ms/step
Epoch 10/50
331/331 - 14s - loss: 3.2611 - accuracy30: 0.3871 - val_loss: 3.2949 - val_accuracy30: 0.3561 - 14s/epoch - 41ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2574 - accuracy30: 0.3895 - val_loss: 3.2912 - val_accuracy30: 0.3570 - 13s/epoch - 41ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2534 - accuracy30: 0.3942 - val_loss: 3.2967 - val_accuracy30: 0.3553 - 13s/epoch - 41ms/step
Epoch 13/50
331/331 - 14s - loss: 3.2481 - accuracy30: 0.3968 - val_loss: 3.2907 - val_accuracy30: 0.3554 - 14s/epoch - 41ms/step
Epoch 14/50
331/331 - 14s - loss: 3.2428 - accuracy30: 0.4003 - val_loss: 3.2957 - val_accuracy30: 0.3611 - 14s/epoch - 41ms/step
Epoch 15/50
331/331 - 14s - loss: 3.2418 - accuracy30: 0.4022 - val_loss: 3.2935 - val_accuracy30: 0.3578 - 14s/epoch - 41ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2386 - accuracy30: 0.4032 - val_loss: 3.2817 - val_accuracy30: 0.3644 - 13s/epoch - 41ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2371 - accuracy30: 0.4035 - val_loss: 3.2899 - val_accuracy30: 0.3591 - 13s/epoch - 40ms/step
Epoch 18/50
331/331 - 13s - loss: 3.2348 - accuracy30: 0.4028 - val_loss: 3.2922 - val_accuracy30: 0.3608 - 13s/epoch - 40ms/step
Epoch 19/50
331/331 - 13s - loss: 3.2299 - accuracy30: 0.4062 - val_loss: 3.2893 - val_accuracy30: 0.3625 - 13s/epoch - 40ms/step
Epoch 20/50
331/331 - 13s - loss: 3.2264 - accuracy30: 0.4108 - val_loss: 3.2946 - val_accuracy30: 0.3636 - 13s/epoch - 40ms/step
Epoch 21/50
331/331 - 13s - loss: 3.2230 - accuracy30: 0.4141 - val_loss: 3.2894 - val_accuracy30: 0.3620 - 13s/epoch - 41ms/step
Epoch 22/50
331/331 - 14s - loss: 3.2196 - accuracy30: 0.4130 - val_loss: 3.3014 - val_accuracy30: 0.3583 - 14s/epoch - 41ms/step
Epoch 23/50
331/331 - 13s - loss: 3.2191 - accuracy30: 0.4149 - val_loss: 3.2950 - val_accuracy30: 0.3613 - 13s/epoch - 41ms/step
Epoch 24/50
331/331 - 13s - loss: 3.2135 - accuracy30: 0.4166 - val_loss: 3.3061 - val_accuracy30: 0.3618 - 13s/epoch - 40ms/step
Epoch 25/50
331/331 - 13s - loss: 3.2098 - accuracy30: 0.4165 - val_loss: 3.2999 - val_accuracy30: 0.3617 - 13s/epoch - 40ms/step
Epoch 26/50
331/331 - 13s - loss: 3.2093 - accuracy30: 0.4177 - val_loss: 3.3084 - val_accuracy30: 0.3636 - 13s/epoch - 40ms/step
testing model: results/CHTR/W5/deepVOL_L3/h30
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.097995
{'0': {'precision': 0.41811898205474135, 'recall': 0.11930538783215824, 'f1-score': 0.18564043653072948, 'support': 189631}, '1': {'precision': 0.32644541557879453, 'recall': 0.6204325328379992, 'f1-score': 0.4278003439821422, 'support': 150740}, '2': {'precision': 0.37994458031367095, 'recall': 0.3794550323238435, 'f1-score': 0.37969964852486954, 'support': 178506}, 'accuracy': 0.35438649236716985, 'macro avg': {'precision': 0.3748363259824023, 'recall': 0.373064317664667, 'f1-score': 0.3310468096792471, 'support': 518877}, 'weighted avg': {'precision': 0.3783538100240371, 'recall': 0.35438649236716985, 'f1-score': 0.32275177148188733, 'support': 518877}}
[[ 22624 100646  66361]
 [ 13036  93524  44180]
 [ 18449  92322  67735]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0820873
{'0': {'precision': 0.413478012564249, 'recall': 0.15359592673785447, 'f1-score': 0.22398680004124985, 'support': 28282}, '1': {'precision': 0.3952109412272531, 'recall': 0.6215965125419852, 'f1-score': 0.4832020888018555, 'support': 27986}, '2': {'precision': 0.3906953476738369, 'recall': 0.4148371104815864, 'f1-score': 0.4024044654358093, 'support': 28240}, 'accuracy': 0.395879680030293, 'macro avg': {'precision': 0.399794767155113, 'recall': 0.39667651658714204, 'f1-score': 0.3698644514263049, 'support': 84508}, 'weighted avg': {'precision': 0.39981534494766346, 'recall': 0.395879680030293, 'f1-score': 0.36945129975721364, 'support': 84508}}
[[ 4344 13574 10364]
 [ 2684 17396  7906]
 [ 3478 13047 11715]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 18ms/step
Prediction horizon: 30  orderbook updates
Categorical crossentropy: 1.0948877
{'0': {'precision': 0.4179755671902269, 'recall': 0.1535748637383777, 'f1-score': 0.22461899179366943, 'support': 12476}, '1': {'precision': 0.33424237259246636, 'recall': 0.5726104730387386, 'f1-score': 0.4220986547085202, 'support': 10274}, '2': {'precision': 0.3896964856230032, 'recall': 0.4081137599330824, 'f1-score': 0.39869254341164456, 'support': 11955}, 'accuracy': 0.3653075925659127, 'macro avg': {'precision': 0.38063814180189876, 'recall': 0.37809969890339956, 'f1-score': 0.3484700633046114, 'support': 34705}, 'weighted avg': {'precision': 0.3834459241579966, 'recall': 0.3653075925659127, 'f1-score': 0.3430444453703895, 'support': 34705}}
[[1916 6111 4449]
 [1199 5883 3192]
 [1469 5607 4879]]
training model: results/CHTR/W5/deepVOL_L3/h50
Epoch 1/50
331/331 - 16s - loss: 3.3355 - accuracy50: 0.3498 - val_loss: 3.3535 - val_accuracy50: 0.3130 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 14s - loss: 3.3154 - accuracy50: 0.3517 - val_loss: 3.3497 - val_accuracy50: 0.3121 - 14s/epoch - 41ms/step
Epoch 3/50
331/331 - 14s - loss: 3.3006 - accuracy50: 0.3536 - val_loss: 3.3421 - val_accuracy50: 0.3119 - 14s/epoch - 41ms/step
Epoch 4/50
331/331 - 14s - loss: 3.3008 - accuracy50: 0.3511 - val_loss: 3.3445 - val_accuracy50: 0.3130 - 14s/epoch - 41ms/step
Epoch 5/50
331/331 - 13s - loss: 3.2921 - accuracy50: 0.3549 - val_loss: 3.3161 - val_accuracy50: 0.3268 - 13s/epoch - 41ms/step
Epoch 6/50
331/331 - 15s - loss: 3.2875 - accuracy50: 0.3582 - val_loss: 3.3096 - val_accuracy50: 0.3305 - 15s/epoch - 44ms/step
Epoch 7/50
331/331 - 14s - loss: 3.2825 - accuracy50: 0.3658 - val_loss: 3.3234 - val_accuracy50: 0.3252 - 14s/epoch - 41ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2824 - accuracy50: 0.3667 - val_loss: 3.3071 - val_accuracy50: 0.3337 - 14s/epoch - 41ms/step
Epoch 9/50
331/331 - 14s - loss: 3.2772 - accuracy50: 0.3721 - val_loss: 3.3063 - val_accuracy50: 0.3362 - 14s/epoch - 41ms/step
Epoch 10/50
331/331 - 14s - loss: 3.2717 - accuracy50: 0.3792 - val_loss: 3.3102 - val_accuracy50: 0.3380 - 14s/epoch - 41ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2708 - accuracy50: 0.3778 - val_loss: 3.3078 - val_accuracy50: 0.3388 - 13s/epoch - 41ms/step
Epoch 12/50
331/331 - 14s - loss: 3.2663 - accuracy50: 0.3801 - val_loss: 3.3012 - val_accuracy50: 0.3442 - 14s/epoch - 41ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2619 - accuracy50: 0.3867 - val_loss: 3.3074 - val_accuracy50: 0.3428 - 13s/epoch - 41ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2602 - accuracy50: 0.3875 - val_loss: 3.3079 - val_accuracy50: 0.3445 - 13s/epoch - 40ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2587 - accuracy50: 0.3868 - val_loss: 3.3116 - val_accuracy50: 0.3437 - 13s/epoch - 41ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2540 - accuracy50: 0.3919 - val_loss: 3.3230 - val_accuracy50: 0.3427 - 13s/epoch - 40ms/step
Epoch 17/50
331/331 - 14s - loss: 3.2507 - accuracy50: 0.3949 - val_loss: 3.3140 - val_accuracy50: 0.3461 - 14s/epoch - 42ms/step
Epoch 18/50
331/331 - 14s - loss: 3.2491 - accuracy50: 0.3954 - val_loss: 3.3070 - val_accuracy50: 0.3481 - 14s/epoch - 41ms/step
Epoch 19/50
331/331 - 14s - loss: 3.2429 - accuracy50: 0.4012 - val_loss: 3.3091 - val_accuracy50: 0.3529 - 14s/epoch - 41ms/step
Epoch 20/50
331/331 - 13s - loss: 3.2424 - accuracy50: 0.4008 - val_loss: 3.3136 - val_accuracy50: 0.3468 - 13s/epoch - 40ms/step
Epoch 21/50
331/331 - 13s - loss: 3.2353 - accuracy50: 0.4041 - val_loss: 3.3255 - val_accuracy50: 0.3483 - 13s/epoch - 40ms/step
Epoch 22/50
331/331 - 14s - loss: 3.2353 - accuracy50: 0.4036 - val_loss: 3.3174 - val_accuracy50: 0.3515 - 14s/epoch - 41ms/step
testing model: results/CHTR/W5/deepVOL_L3/h50
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1024514
{'0': {'precision': 0.3922903553536604, 'recall': 0.1792774042053581, 'f1-score': 0.2460908454908741, 'support': 187380}, '1': {'precision': 0.3200420727859196, 'recall': 0.7207294272215063, 'f1-score': 0.44325529629536103, 'support': 158316}, '2': {'precision': 0.3611100248960492, 'recall': 0.15997135944474278, 'f1-score': 0.22172068827531013, 'support': 173181}, 'accuracy': 0.3380377237765405, 'macro avg': {'precision': 0.3578141510118764, 'recall': 0.3533260636238691, 'f1-score': 0.3036889433538484, 'support': 518877}, 'weighted avg': {'precision': 0.35983969766026863, 'recall': 0.3380377237765405, 'f1-score': 0.29811442525412163, 'support': 518877}}
[[ 33593 126750  27037]
 [ 22235 114103  21978]
 [ 29805 115672  27704]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.0908545
{'0': {'precision': 0.399518194497274, 'recall': 0.2226933813915686, 'f1-score': 0.28598007850611484, 'support': 28299}, '1': {'precision': 0.36396724294813465, 'recall': 0.720538963144432, 'f1-score': 0.4836350006649981, 'support': 27757}, '2': {'precision': 0.3966918165989553, 'recall': 0.19218332630395052, 'f1-score': 0.25892603466237335, 'support': 28452}, 'accuracy': 0.3759407393382875, 'macro avg': {'precision': 0.3867257513481213, 'recall': 0.37847189027998374, 'f1-score': 0.34284703794449545, 'support': 84508}, 'weighted avg': {'precision': 0.38688975853721785, 'recall': 0.3759407393382875, 'f1-score': 0.34179214385995105, 'support': 84508}}
[[ 6302 17459  4538]
 [ 3979 20000  3778]
 [ 5493 17491  5468]]
Evaluating performance on  val set...
136/136 - 2s - 2s/epoch - 18ms/step
Prediction horizon: 50  orderbook updates
Categorical crossentropy: 1.1017087
{'0': {'precision': 0.3938007380073801, 'recall': 0.21438328646042587, 'f1-score': 0.27762747138397503, 'support': 12445}, '1': {'precision': 0.3154964009235366, 'recall': 0.6730732084218659, 'f1-score': 0.42961501710692596, 'support': 10354}, '2': {'precision': 0.38281116247217944, 'recall': 0.18780446833529313, 'f1-score': 0.25198625119738544, 'support': 11906}, 'accuracy': 0.34211208759544737, 'macro avg': {'precision': 0.3640361004676987, 'recall': 0.3584203210725283, 'f1-score': 0.31974291322942877, 'support': 34705}, 'weighted avg': {'precision': 0.36666905690989515, 'recall': 0.34211208759544737, 'f1-score': 0.3141753659488475, 'support': 34705}}
[[2668 7799 1978]
 [1758 6969 1627]
 [2349 7321 2236]]
training model: results/CHTR/W5/deepVOL_L3/h100
Epoch 1/50
331/331 - 16s - loss: 3.3449 - accuracy100: 0.3458 - val_loss: 3.3688 - val_accuracy100: 0.3091 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 13s - loss: 3.3178 - accuracy100: 0.3392 - val_loss: 3.3199 - val_accuracy100: 0.3133 - 13s/epoch - 41ms/step
Epoch 3/50
331/331 - 13s - loss: 3.3084 - accuracy100: 0.3336 - val_loss: 3.3106 - val_accuracy100: 0.3106 - 13s/epoch - 41ms/step
Epoch 4/50
331/331 - 14s - loss: 3.3035 - accuracy100: 0.3341 - val_loss: 3.3053 - val_accuracy100: 0.3123 - 14s/epoch - 41ms/step
Epoch 5/50
331/331 - 13s - loss: 3.3017 - accuracy100: 0.3340 - val_loss: 3.3057 - val_accuracy100: 0.3138 - 13s/epoch - 41ms/step
Epoch 6/50
331/331 - 14s - loss: 3.3007 - accuracy100: 0.3337 - val_loss: 3.3045 - val_accuracy100: 0.3102 - 14s/epoch - 41ms/step
Epoch 7/50
331/331 - 13s - loss: 3.2996 - accuracy100: 0.3355 - val_loss: 3.3043 - val_accuracy100: 0.3094 - 13s/epoch - 41ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2982 - accuracy100: 0.3377 - val_loss: 3.3054 - val_accuracy100: 0.3090 - 14s/epoch - 42ms/step
Epoch 9/50
331/331 - 13s - loss: 3.2983 - accuracy100: 0.3402 - val_loss: 3.3067 - val_accuracy100: 0.3091 - 13s/epoch - 41ms/step
Epoch 10/50
331/331 - 14s - loss: 3.2965 - accuracy100: 0.3432 - val_loss: 3.3066 - val_accuracy100: 0.3120 - 14s/epoch - 42ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2966 - accuracy100: 0.3438 - val_loss: 3.3059 - val_accuracy100: 0.3130 - 13s/epoch - 41ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2959 - accuracy100: 0.3461 - val_loss: 3.3072 - val_accuracy100: 0.3162 - 13s/epoch - 41ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2951 - accuracy100: 0.3475 - val_loss: 3.3101 - val_accuracy100: 0.3134 - 13s/epoch - 41ms/step
Epoch 14/50
331/331 - 14s - loss: 3.2950 - accuracy100: 0.3473 - val_loss: 3.3106 - val_accuracy100: 0.3152 - 14s/epoch - 41ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2944 - accuracy100: 0.3494 - val_loss: 3.3066 - val_accuracy100: 0.3171 - 13s/epoch - 41ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2934 - accuracy100: 0.3496 - val_loss: 3.3058 - val_accuracy100: 0.3193 - 13s/epoch - 41ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2917 - accuracy100: 0.3533 - val_loss: 3.3090 - val_accuracy100: 0.3182 - 13s/epoch - 41ms/step
testing model: results/CHTR/W5/deepVOL_L3/h100
Evaluating performance on  test set...
2027/2027 - 35s - 35s/epoch - 17ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992619
{'0': {'precision': 0.33810809087624594, 'recall': 0.0895454340778098, 'f1-score': 0.14159142387981327, 'support': 177664}, '1': {'precision': 0.3368028306075133, 'recall': 0.8550480440821531, 'f1-score': 0.4832527418789231, 'support': 175672}, '2': {'precision': 0.3208343007507159, 'recall': 0.050084269153865206, 'f1-score': 0.08664301426981498, 'support': 165541}, 'accuracy': 0.3361259026705751, 'macro avg': {'precision': 0.3319150740781584, 'recall': 0.3315592491046094, 'f1-score': 0.23716239334285047, 'support': 518877}, 'weighted avg': {'precision': 0.3321551999732012, 'recall': 0.3361259026705751, 'f1-score': 0.23973436022174185, 'support': 518877}}
[[ 15909 153470   8285]
 [ 16198 150208   9266]
 [ 14946 142304   8291]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.0992488
{'0': {'precision': 0.3445416335340225, 'recall': 0.1079666809055959, 'f1-score': 0.1644125220219542, 'support': 28092}, '1': {'precision': 0.333039208709884, 'recall': 0.8388958594730238, 'f1-score': 0.4767929910350449, 'support': 27895}, '2': {'precision': 0.35441176470588237, 'recall': 0.06759931278706918, 'f1-score': 0.1135420040634846, 'support': 28521}, 'accuracy': 0.3356131963837743, 'macro avg': {'precision': 0.34399753564992963, 'recall': 0.3381539510552296, 'f1-score': 0.2515825057068279, 'support': 84508}, 'weighted avg': {'precision': 0.3440759482815408, 'recall': 0.3356131963837743, 'f1-score': 0.25035675381570927, 'support': 84508}}
[[ 3033 23281  1778]
 [ 2760 23401  1734]
 [ 3010 23583  1928]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 21ms/step
Prediction horizon: 100  orderbook updates
Categorical crossentropy: 1.1018479
{'0': {'precision': 0.3597741328314063, 'recall': 0.10804263565891473, 'f1-score': 0.16618021486679502, 'support': 12384}, '1': {'precision': 0.3025353486104339, 'recall': 0.8241153590740916, 'f1-score': 0.44259330021653287, 'support': 10541}, '2': {'precision': 0.3279049295774648, 'recall': 0.0632427843803056, 'f1-score': 0.10603472815257615, 'support': 11780}, 'accuracy': 0.31032992364212647, 'macro avg': {'precision': 0.3300714703397683, 'recall': 0.33180025970443733, 'f1-score': 0.23826941441196803, 'support': 34705}, 'weighted avg': {'precision': 0.33157147503556417, 'recall': 0.31032992364212647, 'f1-score': 0.22972023789454574, 'support': 34705}}
[[ 1338 10247   799]
 [ 1126  8687   728]
 [ 1255  9780   745]]
training model: results/CHTR/W5/deepVOL_L3/h200
Epoch 1/50
331/331 - 16s - loss: 3.3384 - accuracy200: 0.3474 - val_loss: 3.3503 - val_accuracy200: 0.3349 - 16s/epoch - 50ms/step
Epoch 2/50
331/331 - 14s - loss: 3.3177 - accuracy200: 0.3438 - val_loss: 3.3454 - val_accuracy200: 0.3319 - 14s/epoch - 41ms/step
Epoch 3/50
331/331 - 15s - loss: 3.3092 - accuracy200: 0.3404 - val_loss: 3.3050 - val_accuracy200: 0.3325 - 15s/epoch - 44ms/step
Epoch 4/50
331/331 - 13s - loss: 3.3030 - accuracy200: 0.3399 - val_loss: 3.2989 - val_accuracy200: 0.3370 - 13s/epoch - 41ms/step
Epoch 5/50
331/331 - 14s - loss: 3.3005 - accuracy200: 0.3387 - val_loss: 3.2976 - val_accuracy200: 0.3429 - 14s/epoch - 41ms/step
Epoch 6/50
331/331 - 15s - loss: 3.2971 - accuracy200: 0.3442 - val_loss: 3.3008 - val_accuracy200: 0.3403 - 15s/epoch - 44ms/step
Epoch 7/50
331/331 - 14s - loss: 3.2950 - accuracy200: 0.3471 - val_loss: 3.3019 - val_accuracy200: 0.3421 - 14s/epoch - 42ms/step
Epoch 8/50
331/331 - 13s - loss: 3.2940 - accuracy200: 0.3490 - val_loss: 3.3008 - val_accuracy200: 0.3404 - 13s/epoch - 41ms/step
Epoch 9/50
331/331 - 14s - loss: 3.2932 - accuracy200: 0.3441 - val_loss: 3.3018 - val_accuracy200: 0.3424 - 14s/epoch - 44ms/step
Epoch 10/50
331/331 - 13s - loss: 3.2917 - accuracy200: 0.3509 - val_loss: 3.3062 - val_accuracy200: 0.3425 - 13s/epoch - 41ms/step
Epoch 11/50
331/331 - 14s - loss: 3.2909 - accuracy200: 0.3481 - val_loss: 3.3108 - val_accuracy200: 0.3398 - 14s/epoch - 43ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2885 - accuracy200: 0.3518 - val_loss: 3.3089 - val_accuracy200: 0.3380 - 13s/epoch - 40ms/step
Epoch 13/50
331/331 - 14s - loss: 3.2880 - accuracy200: 0.3523 - val_loss: 3.3141 - val_accuracy200: 0.3332 - 14s/epoch - 43ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2869 - accuracy200: 0.3528 - val_loss: 3.3078 - val_accuracy200: 0.3447 - 13s/epoch - 40ms/step
Epoch 15/50
331/331 - 14s - loss: 3.2851 - accuracy200: 0.3546 - val_loss: 3.3078 - val_accuracy200: 0.3410 - 14s/epoch - 43ms/step
testing model: results/CHTR/W5/deepVOL_L3/h200
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0977937
{'0': {'precision': 0.3305360012887708, 'recall': 0.5332257538121227, 'f1-score': 0.408099357047042, 'support': 165459}, '1': {'precision': 0.40214284867242994, 'recall': 0.348860415712941, 'f1-score': 0.3736114821782205, 'support': 194413}, '2': {'precision': 0.29858826918921516, 'recall': 0.15642904311185182, 'f1-score': 0.20530153895677797, 'support': 159005}, 'accuracy': 0.3486818648735635, 'macro avg': {'precision': 0.34375570638347197, 'recall': 0.3461717375456385, 'f1-score': 0.32900412606068014, 'support': 518877}, 'weighted avg': {'precision': 0.34757559425186124, 'recall': 0.3486818648735635, 'f1-score': 0.33303193590038366, 'support': 518877}}
[[88227 50313 26919]
 [95080 67823 31510]
 [83614 50518 24873]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 18ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.09727
{'0': {'precision': 0.3469863831172354, 'recall': 0.45981308411214955, 'f1-score': 0.39551062053612834, 'support': 27820}, '1': {'precision': 0.35114369501466275, 'recall': 0.4294372915396478, 'f1-score': 0.38636400303308976, 'support': 27883}, '2': {'precision': 0.351646728695909, 'recall': 0.16531852109008852, 'f1-score': 0.22490377122346328, 'support': 28805}, 'accuracy': 0.34941070667865765, 'macro avg': {'precision': 0.3499256022759358, 'recall': 0.3515229655806286, 'f1-score': 0.3355927982642271, 'support': 84508}, 'weighted avg': {'precision': 0.34994657128912043, 'recall': 0.34941070667865765, 'f1-score': 0.33434048953919854, 'support': 84508}}
[[12792 10590  4438]
 [11567 11974  4342]
 [12507 11536  4762]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 200  orderbook updates
Categorical crossentropy: 1.0988932
{'0': {'precision': 0.353542830226768, 'recall': 0.4360889774236388, 'f1-score': 0.39050131926121373, 'support': 12048}, '1': {'precision': 0.3335653142181084, 'recall': 0.441222498389027, 'f1-score': 0.37991439441978436, 'support': 10863}, '2': {'precision': 0.3574429223744292, 'recall': 0.1659318297439376, 'f1-score': 0.22664890844866525, 'support': 11794}, 'accuracy': 0.3458867598328771, 'macro avg': {'precision': 0.34818368893976853, 'recall': 0.34774776851886785, 'f1-score': 0.3323548740432211, 'support': 34705}, 'weighted avg': {'precision': 0.3486150656506968, 'recall': 0.3458867598328771, 'f1-score': 0.3315046012760345, 'support': 34705}}
[[5254 4887 1907]
 [4459 4793 1611]
 [5148 4689 1957]]
training model: results/CHTR/W5/deepVOL_L3/h300
Epoch 1/50
331/331 - 16s - loss: 3.3380 - accuracy300: 0.3501 - val_loss: 3.3868 - val_accuracy300: 0.3284 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 13s - loss: 3.3135 - accuracy300: 0.3499 - val_loss: 3.3549 - val_accuracy300: 0.3404 - 13s/epoch - 40ms/step
Epoch 3/50
331/331 - 13s - loss: 3.3070 - accuracy300: 0.3459 - val_loss: 3.3181 - val_accuracy300: 0.3409 - 13s/epoch - 40ms/step
Epoch 4/50
331/331 - 13s - loss: 3.3011 - accuracy300: 0.3437 - val_loss: 3.2995 - val_accuracy300: 0.3457 - 13s/epoch - 41ms/step
Epoch 5/50
331/331 - 13s - loss: 3.2975 - accuracy300: 0.3446 - val_loss: 3.3081 - val_accuracy300: 0.3411 - 13s/epoch - 40ms/step
Epoch 6/50
331/331 - 13s - loss: 3.2959 - accuracy300: 0.3464 - val_loss: 3.3231 - val_accuracy300: 0.3357 - 13s/epoch - 40ms/step
Epoch 7/50
331/331 - 13s - loss: 3.2941 - accuracy300: 0.3448 - val_loss: 3.2987 - val_accuracy300: 0.3496 - 13s/epoch - 41ms/step
Epoch 8/50
331/331 - 13s - loss: 3.2924 - accuracy300: 0.3484 - val_loss: 3.3202 - val_accuracy300: 0.3430 - 13s/epoch - 40ms/step
Epoch 9/50
331/331 - 13s - loss: 3.2905 - accuracy300: 0.3520 - val_loss: 3.3150 - val_accuracy300: 0.3415 - 13s/epoch - 40ms/step
Epoch 10/50
331/331 - 13s - loss: 3.2885 - accuracy300: 0.3545 - val_loss: 3.3293 - val_accuracy300: 0.3419 - 13s/epoch - 40ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2876 - accuracy300: 0.3551 - val_loss: 3.3165 - val_accuracy300: 0.3371 - 13s/epoch - 40ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2898 - accuracy300: 0.3527 - val_loss: 3.3025 - val_accuracy300: 0.3421 - 13s/epoch - 40ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2893 - accuracy300: 0.3527 - val_loss: 3.3017 - val_accuracy300: 0.3424 - 13s/epoch - 40ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2866 - accuracy300: 0.3566 - val_loss: 3.3065 - val_accuracy300: 0.3360 - 13s/epoch - 41ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2839 - accuracy300: 0.3582 - val_loss: 3.3063 - val_accuracy300: 0.3357 - 13s/epoch - 40ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2822 - accuracy300: 0.3610 - val_loss: 3.3056 - val_accuracy300: 0.3427 - 13s/epoch - 40ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2814 - accuracy300: 0.3612 - val_loss: 3.3044 - val_accuracy300: 0.3414 - 13s/epoch - 40ms/step
testing model: results/CHTR/W5/deepVOL_L3/h300
Evaluating performance on  test set...
2027/2027 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0979476
{'0': {'precision': 0.3202312930251086, 'recall': 0.3208603840421087, 'f1-score': 0.32054552987610946, 'support': 160347}, '1': {'precision': 0.42814761510366456, 'recall': 0.31106255579614, 'f1-score': 0.36033241060537236, 'support': 202747}, '2': {'precision': 0.30448573582472394, 'recall': 0.41224010322050547, 'f1-score': 0.35026288805986433, 'support': 155783}, 'accuracy': 0.34446699314095636, 'macro avg': {'precision': 0.3509548813178324, 'recall': 0.3480543476862514, 'f1-score': 0.34371360951378205, 'support': 518877}, 'weighted avg': {'precision': 0.3576714193269363, 'recall': 0.34446699314095636, 'f1-score': 0.34501400683144906, 'support': 518877}}
[[51449 42519 66379]
 [59366 63067 80314]
 [49847 41716 64220]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.096075
{'0': {'precision': 0.34610608479687777, 'recall': 0.2819771643301055, 'f1-score': 0.31076776043325904, 'support': 27676}, '1': {'precision': 0.3546350531373856, 'recall': 0.3626874237750197, 'f1-score': 0.35861604213587756, 'support': 27878}, '2': {'precision': 0.35522736105713176, 'recall': 0.4103750777094702, 'f1-score': 0.3808150249186738, 'support': 28954}, 'accuracy': 0.3525938372698443, 'macro avg': {'precision': 0.3519894996637984, 'recall': 0.3516798886048651, 'f1-score': 0.3500662758292701, 'support': 84508}, 'weighted avg': {'precision': 0.3520447889696907, 'recall': 0.3525938372698443, 'f1-score': 0.3505517204514384, 'support': 84508}}
[[ 7804  8934 10938]
 [ 7138 10111 10629]
 [ 7606  9466 11882]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 300  orderbook updates
Categorical crossentropy: 1.0991147
{'0': {'precision': 0.3570899862535688, 'recall': 0.28311535881958416, 'f1-score': 0.31582885199906474, 'support': 11928}, '1': {'precision': 0.3439313651274287, 'recall': 0.3703804347826087, 'f1-score': 0.3566662305377469, 'support': 11040}, '2': {'precision': 0.3462085485440527, 'recall': 0.3940529948027605, 'f1-score': 0.36858463500159394, 'support': 11737}, 'accuracy': 0.3483936032272007, 'macro avg': {'precision': 0.3490766333083501, 'recall': 0.34918292946831775, 'f1-score': 0.3470265725128019, 'support': 34705}, 'weighted avg': {'precision': 0.34922407034435754, 'recall': 0.3483936032272007, 'f1-score': 0.3466612762655317, 'support': 34705}}
[[3377 3958 4593]
 [2810 4089 4141]
 [3270 3842 4625]]
training model: results/CHTR/W5/deepVOL_L3/h500
Epoch 1/50
331/331 - 16s - loss: 3.3501 - accuracy500: 0.3487 - val_loss: 3.3925 - val_accuracy500: 0.3338 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 14s - loss: 3.3132 - accuracy500: 0.3444 - val_loss: 3.3145 - val_accuracy500: 0.3366 - 14s/epoch - 41ms/step
Epoch 3/50
331/331 - 14s - loss: 3.3056 - accuracy500: 0.3388 - val_loss: 3.3064 - val_accuracy500: 0.3359 - 14s/epoch - 42ms/step
Epoch 4/50
331/331 - 14s - loss: 3.3030 - accuracy500: 0.3384 - val_loss: 3.3014 - val_accuracy500: 0.3391 - 14s/epoch - 41ms/step
Epoch 5/50
331/331 - 14s - loss: 3.2995 - accuracy500: 0.3407 - val_loss: 3.2981 - val_accuracy500: 0.3449 - 14s/epoch - 41ms/step
Epoch 6/50
331/331 - 13s - loss: 3.2979 - accuracy500: 0.3404 - val_loss: 3.2994 - val_accuracy500: 0.3483 - 13s/epoch - 41ms/step
Epoch 7/50
331/331 - 14s - loss: 3.2974 - accuracy500: 0.3432 - val_loss: 3.2979 - val_accuracy500: 0.3488 - 14s/epoch - 41ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2964 - accuracy500: 0.3455 - val_loss: 3.2956 - val_accuracy500: 0.3538 - 14s/epoch - 42ms/step
Epoch 9/50
331/331 - 14s - loss: 3.2949 - accuracy500: 0.3470 - val_loss: 3.2993 - val_accuracy500: 0.3474 - 14s/epoch - 42ms/step
Epoch 10/50
331/331 - 14s - loss: 3.2928 - accuracy500: 0.3487 - val_loss: 3.2975 - val_accuracy500: 0.3552 - 14s/epoch - 42ms/step
Epoch 11/50
331/331 - 13s - loss: 3.2907 - accuracy500: 0.3509 - val_loss: 3.3019 - val_accuracy500: 0.3563 - 13s/epoch - 41ms/step
Epoch 12/50
331/331 - 14s - loss: 3.2899 - accuracy500: 0.3519 - val_loss: 3.3015 - val_accuracy500: 0.3529 - 14s/epoch - 41ms/step
Epoch 13/50
331/331 - 13s - loss: 3.2891 - accuracy500: 0.3538 - val_loss: 3.3015 - val_accuracy500: 0.3544 - 13s/epoch - 41ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2859 - accuracy500: 0.3582 - val_loss: 3.3013 - val_accuracy500: 0.3539 - 13s/epoch - 41ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2847 - accuracy500: 0.3590 - val_loss: 3.2986 - val_accuracy500: 0.3612 - 13s/epoch - 41ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2835 - accuracy500: 0.3583 - val_loss: 3.2998 - val_accuracy500: 0.3580 - 13s/epoch - 40ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2816 - accuracy500: 0.3603 - val_loss: 3.3016 - val_accuracy500: 0.3553 - 13s/epoch - 41ms/step
Epoch 18/50
331/331 - 13s - loss: 3.2787 - accuracy500: 0.3656 - val_loss: 3.3037 - val_accuracy500: 0.3594 - 13s/epoch - 40ms/step
testing model: results/CHTR/W5/deepVOL_L3/h500
Evaluating performance on  test set...
2027/2027 - 37s - 37s/epoch - 18ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0985819
{'0': {'precision': 0.3157216734737947, 'recall': 0.5418564974856069, 'f1-score': 0.39897433484673833, 'support': 156499}, '1': {'precision': 0.4653833400233861, 'recall': 0.25686818479559204, 'f1-score': 0.33102643519064495, 'support': 207624}, '2': {'precision': 0.29292199752373094, 'recall': 0.2568334259534487, 'f1-score': 0.2736931986420697, 'support': 154754}, 'accuracy': 0.34281342206341775, 'macro avg': {'precision': 0.35800900367363725, 'recall': 0.35185270274488256, 'f1-score': 0.33456465622648435, 'support': 518877}, 'weighted avg': {'precision': 0.36880749690346337, 'recall': 0.34281342206341775, 'f1-score': 0.3344207476374112, 'support': 518877}}
[[84800 30741 40958]
 [99308 53332 54984]
 [84483 30525 39746]]
Evaluating performance on  train set...
331/331 - 7s - 7s/epoch - 21ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0954832
{'0': {'precision': 0.3449566857049162, 'recall': 0.4646959210720071, 'f1-score': 0.39597220697335195, 'support': 27164}, '1': {'precision': 0.37104632587859426, 'recall': 0.334352958111415, 'f1-score': 0.35174528659044446, 'support': 27788}, '2': {'precision': 0.3693551912568306, 'recall': 0.2858641223440249, 'f1-score': 0.32229024813564494, 'support': 29556}, 'accuracy': 0.3592914280304823, 'macro avg': {'precision': 0.36178606761344706, 'recall': 0.36163766717581564, 'f1-score': 0.35666924723314714, 'support': 84508}, 'weighted avg': {'precision': 0.3620686887252048, 'recall': 0.3592914280304823, 'f1-score': 0.35565979111914287, 'support': 84508}}
[[12623  7398  7143]
 [11214  9291  7283]
 [12756  8351  8449]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 22ms/step
Prediction horizon: 500  orderbook updates
Categorical crossentropy: 1.0971328
{'0': {'precision': 0.3558448603200434, 'recall': 0.4403423393186776, 'f1-score': 0.3936098402460061, 'support': 11918}, '1': {'precision': 0.3525356502030409, 'recall': 0.34257134991282007, 'f1-score': 0.3474820813553011, 'support': 10897}, '2': {'precision': 0.3478864218616567, 'recall': 0.2740958788898234, 'f1-score': 0.3066139806190611, 'support': 11890}, 'accuracy': 0.35268693271862844, 'macro avg': {'precision': 0.3520889774615803, 'recall': 0.35233652270710697, 'f1-score': 0.34923530074012277, 'support': 34705}, 'weighted avg': {'precision': 0.35207922724367996, 'recall': 0.35268693271862844, 'f1-score': 0.3493212662769415, 'support': 34705}}
[[5248 3457 3213]
 [4268 3733 2896]
 [5232 3399 3259]]
training model: results/CHTR/W5/deepVOL_L3/h1000
Epoch 1/50
331/331 - 16s - loss: 3.3498 - accuracy1000: 0.3547 - val_loss: 3.3879 - val_accuracy1000: 0.3354 - 16s/epoch - 48ms/step
Epoch 2/50
331/331 - 13s - loss: 3.3200 - accuracy1000: 0.3446 - val_loss: 3.3317 - val_accuracy1000: 0.3482 - 13s/epoch - 40ms/step
Epoch 3/50
331/331 - 14s - loss: 3.3092 - accuracy1000: 0.3368 - val_loss: 3.3025 - val_accuracy1000: 0.3457 - 14s/epoch - 41ms/step
Epoch 4/50
331/331 - 14s - loss: 3.3004 - accuracy1000: 0.3454 - val_loss: 3.3008 - val_accuracy1000: 0.3442 - 14s/epoch - 41ms/step
Epoch 5/50
331/331 - 14s - loss: 3.2973 - accuracy1000: 0.3451 - val_loss: 3.3013 - val_accuracy1000: 0.3480 - 14s/epoch - 42ms/step
Epoch 6/50
331/331 - 14s - loss: 3.2958 - accuracy1000: 0.3457 - val_loss: 3.3005 - val_accuracy1000: 0.3510 - 14s/epoch - 42ms/step
Epoch 7/50
331/331 - 14s - loss: 3.2924 - accuracy1000: 0.3488 - val_loss: 3.3022 - val_accuracy1000: 0.3489 - 14s/epoch - 41ms/step
Epoch 8/50
331/331 - 14s - loss: 3.2916 - accuracy1000: 0.3474 - val_loss: 3.2990 - val_accuracy1000: 0.3488 - 14s/epoch - 42ms/step
Epoch 9/50
331/331 - 14s - loss: 3.2904 - accuracy1000: 0.3502 - val_loss: 3.3012 - val_accuracy1000: 0.3464 - 14s/epoch - 41ms/step
Epoch 10/50
331/331 - 13s - loss: 3.2906 - accuracy1000: 0.3505 - val_loss: 3.2999 - val_accuracy1000: 0.3474 - 13s/epoch - 41ms/step
Epoch 11/50
331/331 - 14s - loss: 3.2895 - accuracy1000: 0.3526 - val_loss: 3.2945 - val_accuracy1000: 0.3473 - 14s/epoch - 41ms/step
Epoch 12/50
331/331 - 13s - loss: 3.2881 - accuracy1000: 0.3533 - val_loss: 3.2982 - val_accuracy1000: 0.3480 - 13s/epoch - 40ms/step
Epoch 13/50
331/331 - 14s - loss: 3.2841 - accuracy1000: 0.3597 - val_loss: 3.2998 - val_accuracy1000: 0.3456 - 14s/epoch - 42ms/step
Epoch 14/50
331/331 - 13s - loss: 3.2830 - accuracy1000: 0.3569 - val_loss: 3.3040 - val_accuracy1000: 0.3459 - 13s/epoch - 40ms/step
Epoch 15/50
331/331 - 13s - loss: 3.2808 - accuracy1000: 0.3616 - val_loss: 3.3040 - val_accuracy1000: 0.3434 - 13s/epoch - 40ms/step
Epoch 16/50
331/331 - 13s - loss: 3.2800 - accuracy1000: 0.3626 - val_loss: 3.3060 - val_accuracy1000: 0.3481 - 13s/epoch - 40ms/step
Epoch 17/50
331/331 - 13s - loss: 3.2780 - accuracy1000: 0.3641 - val_loss: 3.3033 - val_accuracy1000: 0.3497 - 13s/epoch - 40ms/step
Epoch 18/50
331/331 - 13s - loss: 3.2754 - accuracy1000: 0.3676 - val_loss: 3.3000 - val_accuracy1000: 0.3490 - 13s/epoch - 40ms/step
Epoch 19/50
331/331 - 13s - loss: 3.2773 - accuracy1000: 0.3676 - val_loss: 3.3020 - val_accuracy1000: 0.3449 - 13s/epoch - 40ms/step
Epoch 20/50
331/331 - 13s - loss: 3.2734 - accuracy1000: 0.3671 - val_loss: 3.3017 - val_accuracy1000: 0.3523 - 13s/epoch - 41ms/step
Epoch 21/50
331/331 - 14s - loss: 3.2698 - accuracy1000: 0.3702 - val_loss: 3.3037 - val_accuracy1000: 0.3523 - 14s/epoch - 42ms/step
testing model: results/CHTR/W5/deepVOL_L3/h1000
Evaluating performance on  test set...
2027/2027 - 36s - 36s/epoch - 18ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.1002774
{'0': {'precision': 0.3044722241206842, 'recall': 0.6341203035733927, 'f1-score': 0.41140753520254714, 'support': 154559}, '1': {'precision': 0.4525747904997612, 'recall': 0.1984265983875727, 'f1-score': 0.27589150415891905, 'support': 210118}, '2': {'precision': 0.3008535596776501, 'recall': 0.20457846952010375, 'f1-score': 0.24354673717936345, 'support': 154200}, 'accuracy': 0.3300358273733467, 'macro avg': {'precision': 0.35263352476603177, 'recall': 0.34570845716035636, 'f1-score': 0.3102819255136099, 'support': 518877}, 'weighted avg': {'precision': 0.3633706084879293, 'recall': 0.3300358273733467, 'f1-score': 0.3066457275564191, 'support': 518877}}
[[ 98009  25481  31069]
 [126185  41693  42240]
 [ 97704  24950  31546]]
Evaluating performance on  train set...
331/331 - 6s - 6s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0950453
{'0': {'precision': 0.3421782427833102, 'recall': 0.597534578273471, 'f1-score': 0.4351613118696146, 'support': 27257}, '1': {'precision': 0.38143405251881013, 'recall': 0.2740486163319371, 'f1-score': 0.3189450439565018, 'support': 27933}, '2': {'precision': 0.36221127011460125, 'recall': 0.20806330581895083, 'f1-score': 0.2643038194068329, 'support': 29318}, 'accuracy': 0.3554929710796611, 'macro avg': {'precision': 0.36194118847224055, 'recall': 0.35988216680811963, 'f1-score': 0.3394700584109831, 'support': 84508}, 'weighted avg': {'precision': 0.3621037034336689, 'recall': 0.3554929710796611, 'f1-score': 0.33747270279543445, 'support': 84508}}
[[16287  5591  5379]
 [14916  7655  5362]
 [16395  6823  6100]]
Evaluating performance on  val set...
136/136 - 3s - 3s/epoch - 19ms/step
Prediction horizon: 1000  orderbook updates
Categorical crossentropy: 1.0976518
{'0': {'precision': 0.3489720884469991, 'recall': 0.5602294455066922, 'f1-score': 0.4300574345883854, 'support': 12029}, '1': {'precision': 0.35447457232631213, 'recall': 0.2824816841324307, 'f1-score': 0.31440957886044596, 'support': 10783}, '2': {'precision': 0.34009704455227174, 'recall': 0.19448415034053645, 'f1-score': 0.24745907777896653, 'support': 11893}, 'accuracy': 0.34859530327042215, 'macro avg': {'precision': 0.3478479017751943, 'recall': 0.34573175999321976, 'f1-score': 0.33064203040926593, 'support': 34705}, 'weighted avg': {'precision': 0.3476403606449717, 'recall': 0.34859530327042215, 'f1-score': 0.3315507904204329, 'support': 34705}}
[[6739 2975 2315]
 [5564 3046 2173]
 [7008 2572 2313]]

============================================

        Job resource usage summary 

                 Memory (GB)    NCPUs
 Requested  :        96            32
 Used       :        16 (peak)  12.58 (ave)

============================================
